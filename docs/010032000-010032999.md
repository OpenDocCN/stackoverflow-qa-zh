# StackOverflow 问答 10032000-10032999

# android - 如何在Android中制作倒数计时器？

> ID：10032003
> 
> 赞同：210
> 
> 时间：2012-04-05T16:02:33.977
> 
> 标签：android, timer, countdown

我在 XML 中有两个 EditText。在一个 EditText 中，用户可以输入一个数字为分钟，而在另一个 EditText 中，一个数字为秒。单击完成按钮后，EditText 的秒数应该开始倒计时并每秒更新其文本。

此外，我怎样才能让它保持更新，直到它达到零分钟和零秒？

* * *

## 回答 #1

> 赞同：491
> 
> 时间：2012-04-05T16:30:20.540

```
new CountDownTimer(30000, 1000) {

    public void onTick(long millisUntilFinished) {
        mTextField.setText("seconds remaining: " + millisUntilFinished / 1000);
       //here you can have your logic to set text to edittext
    }

    public void onFinish() {
        mTextField.setText("done!");
    }

}.start(); 
```

请参阅此[链接](http://developer.android.com/reference/android/os/CountDownTimer.html)。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2016-04-19T08:54:03.447

如果您使用以下代码（如接受的答案中所述），

```
new CountDownTimer(30000, 1000) {

    public void onTick(long millisUntilFinished) {
        mTextField.setText("seconds remaining: " + millisUntilFinished / 1000);
       //here you can have your logic to set text to edittext
    }

    public void onFinish() {
        mTextField.setText("done!");
    }

}.start(); 
```

如果您不仔细清理引用，它将导致您使用此代码的活动实例的内存泄漏。

使用以下代码

```
//Declare timer
CountDownTimer cTimer = null;

//start timer function
void startTimer() {
    cTimer = new CountDownTimer(30000, 1000) {
        public void onTick(long millisUntilFinished) {
        }
        public void onFinish() {
        }
    };
    cTimer.start();
}

//cancel timer
void cancelTimer() {
    if(cTimer!=null)
        cTimer.cancel();
} 
```

每当调用拥有的 Activity/Fragment 中的**onDestroy()/onDestroyView(** ) 时，您都需要调用**cTtimer.cancel() 。**

 *** * *

## 回答 #3

> 赞同：65
> 
> 时间：2015-09-24T12:57:58.850

[![在此处输入图像描述](../Images/ef5e389a4a0015fd358c6ffece956491.png)](https://i.stack.imgur.com/Mbez2.png)

**MainActivity.java**

```
package com.zeustechnocrats.countdown;

import android.os.Bundle;
import android.os.Handler;
import android.support.v7.app.AppCompatActivity;
import android.view.View;
import android.widget.LinearLayout;
import android.widget.TextView;

import java.text.SimpleDateFormat;
import java.util.Date;

public class MainActivity extends AppCompatActivity {

    private String EVENT_DATE_TIME = "2021-12-31 10:30:00";
    private String DATE_FORMAT = "yyyy-MM-dd HH:mm:ss";
    private LinearLayout linear_layout_1, linear_layout_2;
    private TextView tv_days, tv_hour, tv_minute, tv_second;
    private Handler handler = new Handler();
    private Runnable runnable;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.count_down);

        initUI();
        countDownStart();
    }

    private void initUI() {
        linear_layout_1 = findViewById(R.id.linear_layout_1);
        linear_layout_2 = findViewById(R.id.linear_layout_2);
        tv_days = findViewById(R.id.tv_days);
        tv_hour = findViewById(R.id.tv_hour);
        tv_minute = findViewById(R.id.tv_minute);
        tv_second = findViewById(R.id.tv_second);
    }

    private void countDownStart() {
        runnable = new Runnable() {
            @Override
            public void run() {
                try {
                    handler.postDelayed(this, 1000);
                    SimpleDateFormat dateFormat = new SimpleDateFormat(DATE_FORMAT);
                    Date event_date = dateFormat.parse(EVENT_DATE_TIME);
                    Date current_date = new Date();
                    if (!current_date.after(event_date)) {
                        long diff = event_date.getTime() - current_date.getTime();
                        long Days = diff / (24 * 60 * 60 * 1000);
                        long Hours = diff / (60 * 60 * 1000) % 24;
                        long Minutes = diff / (60 * 1000) % 60;
                        long Seconds = diff / 1000 % 60;
                        //
                        tv_days.setText(String.format("%02d", Days));
                        tv_hour.setText(String.format("%02d", Hours));
                        tv_minute.setText(String.format("%02d", Minutes));
                        tv_second.setText(String.format("%02d", Seconds));
                    } else {
                        linear_layout_1.setVisibility(View.VISIBLE);
                        linear_layout_2.setVisibility(View.GONE);
                        handler.removeCallbacks(runnable);
                    }
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        };
        handler.postDelayed(runnable, 0);
    }

    protected void onStop() {
        super.onStop();
        handler.removeCallbacks(runnable);
    }
} 
```

**activity_main.xml**

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@android:color/white"
    android:orientation="horizontal">

    <LinearLayout
        android:id="@+id/linear_layout_1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@android:color/black"
        android:gravity="center_horizontal"
        android:visibility="gone">

        <TextView
            android:id="@+id/tv_event"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="20dp"
            android:text="Android Event Start"
            android:textColor="@android:color/white"
            android:textSize="20dp"
            android:textStyle="normal" />
    </LinearLayout>

    <LinearLayout
        android:id="@+id/linear_layout_2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="@android:color/black"
        android:visibility="visible">

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical">

            <TextView
                android:id="@+id/tv_days"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:text="00"
                android:textColor="@android:color/white"
                android:textSize="20dp"
                android:textStyle="bold" />

            <TextView
                android:id="@+id/tv_days_title"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:text="Days"
                android:textColor="@android:color/white"
                android:textSize="20dp"
                android:textStyle="normal" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical">

            <TextView
                android:id="@+id/tv_hour"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:text="00"
                android:textColor="@android:color/white"
                android:textSize="20dp"
                android:textStyle="bold" />

            <TextView
                android:id="@+id/tv_hour_title"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:text="Hour"
                android:textColor="@android:color/white"
                android:textSize="20dp"
                android:textStyle="normal" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical">

            <TextView
                android:id="@+id/tv_minute"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:text="00"
                android:textColor="@android:color/white"
                android:textSize="20dp"
                android:textStyle="bold" />

            <TextView
                android:id="@+id/tv_minute_title"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:text="Minute"
                android:textColor="@android:color/white"
                android:textSize="20dp"
                android:textStyle="normal" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:orientation="vertical">

            <TextView
                android:id="@+id/tv_second"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:text="00"
                android:textColor="@android:color/white"
                android:textSize="20dp"
                android:textStyle="bold" />

            <TextView
                android:id="@+id/tv_second_title"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:text="Second"
                android:textColor="@android:color/white"
                android:textSize="20dp"
                android:textStyle="normal" />
        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2014-04-05T13:26:26.767

只需复制粘贴以下代码......

**主要活动**

包 com.example.countdowntimer;

```
import java.util.concurrent.TimeUnit;
import android.app.Activity;
import android.os.Bundle;
import android.os.CountDownTimer;
import android.widget.TextView;

public class MainActivity extends Activity {

      TextView text1;

 private static final String FORMAT = "%02d:%02d:%02d";

 int seconds , minutes;

@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    text1=(TextView)findViewById(R.id.textView1);

    new CountDownTimer(16069000, 1000) { // adjust the milli seconds here

        public void onTick(long millisUntilFinished) {

            text1.setText(""+String.format(FORMAT,
                    TimeUnit.MILLISECONDS.toHours(millisUntilFinished),
TimeUnit.MILLISECONDS.toMinutes(millisUntilFinished) - TimeUnit.HOURS.toMinutes(
                    TimeUnit.MILLISECONDS.toHours(millisUntilFinished)),
  TimeUnit.MILLISECONDS.toSeconds(millisUntilFinished) - TimeUnit.MINUTES.toSeconds(
                      TimeUnit.MILLISECONDS.toMinutes(millisUntilFinished))));              
        }

        public void onFinish() {
            text1.setText("done!");
        }
     }.start();             

  }

  } 
```

**activity_main.xml**

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="match_parent"
 android:layout_height="match_parent"
 android:orientation="vertical" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="34dp"
    android:layout_marginTop="58dp"
    android:text="Large Text"
    android:textAppearance="?android:attr/textAppearanceMedium" />

   </RelativeLayout> 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2016-03-04T05:36:07.370

**只需通过传递秒数和 textview 对象来调用下面的函数**

```
public void reverseTimer(int Seconds,final TextView tv){

    new CountDownTimer(Seconds* 1000+1000, 1000) {

        public void onTick(long millisUntilFinished) {
            int seconds = (int) (millisUntilFinished / 1000);
            int minutes = seconds / 60;
            seconds = seconds % 60;
            tv.setText("TIME : " + String.format("%02d", minutes)
                    + ":" + String.format("%02d", seconds));
        }

        public void onFinish() {
            tv.setText("Completed");
        }
    }.start();
} 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-06-24T06:08:55.677

倒计时计时器与小时分钟和秒

```
public void reverseTimer(int Seconds, final TextView tv) {

    new CountDownTimer(Seconds * 1000 + 1000, 1000) {

        public void onTick(long millisUntilFinished) {
            int seconds = (int) (millisUntilFinished / 1000);

            int hours = seconds / (60 * 60);
            int tempMint = (seconds - (hours * 60 * 60));
            int minutes = tempMint / 60;
            seconds = tempMint - (minutes * 60);

            tv.setText("TIME : " + String.format("%02d", hours)
                    + ":" + String.format("%02d", minutes)
                    + ":" + String.format("%02d", seconds));
        }

        public void onFinish() {
            tv.setText("Completed");
        }
    }.start();
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2018-04-06T11:17:19.107

使用 Kotlin：

```
var timer = object: CountDownTimer(30000, 1000) {
        override fun onTick(millisUntilFinished: Long) {
            tvTimer.setText("seconds remaining: " + millisUntilFinished / 1000)
        }

        override fun onFinish() {
            tvTimer.setText("done!")
        }
    }
timer.start() 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2020-02-18T15:01:48.987

输出：01:30

```
new CountDownTimer(90000, 1000) {

            public void onTick(long duration) {
                //tTimer.setText("seconds remaining: " + millisUntilFinished / 1000);
                //here you can have your logic to set text to edittext resource id
                // Duration
                long Mmin = (duration / 1000) / 60;
                long Ssec = (duration / 1000) % 60;
                if (Ssec < 10) {
                    tTimer.setText("" + Mmin + ":0" + Ssec);
                } else tTimer.setText("" + Mmin + ":" + Ssec);
            }

            public void onFinish() {
                tTimer.setText("00:00");
            }

        }.start(); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-06-12T08:42:22.150

接口方式。

```
import android.os.CountDownTimer;

/**
 * Created by saikiran on 07-03-2016.
 */
public class CountDownTimerCustom extends CountDownTimer {

    private TimeTickListener mTickListener;
    private TimeFinishListener mFinishListener;
    private long millisUntilFinished;

    public CountDownTimerCustom(long millisInFuture, long countDownInterval) {
        super(millisInFuture, countDownInterval);

    }

    public void updateTickAndFinishListener(TimeTickListener tickListener) {
        mTickListener = tickListener;
    }

    public void updateFinishListner(TimeFinishListener listener) {
        mFinishListener = listener;
    }

    public long getCurrentMs() {
        return millisUntilFinished;
    }

    public int getCurrentSec() {
        return (int) millisUntilFinished / 1000;
    }

    @Override
    public void onTick(long millisUntilFinished) {
        this.millisUntilFinished = millisUntilFinished;
        if (mTickListener != null)
            mTickListener.onTick(millisUntilFinished);
    }

    @Override
    public void onFinish() {
        if (mTickListener != null)
            mTickListener.onFinished();
        mFinishListener.onFinished();
    }

    public interface TimeTickListener {
        void onTick(long mMillisUntilFinished);

        void onFinished();
    }

    public interface TimeFinishListener {
        void onFinished();
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-02-24T07:30:17.190

这是我在 Kotlin 中使用的解决方案

```
private fun startTimer()
{
    Log.d(TAG, ":startTimer: timeString = '$timeString'")

    object : CountDownTimer(TASK_SWITCH_TIMER, 250)
    {
        override fun onTick(millisUntilFinished: Long)
        {
            val secondsUntilFinished : Long = 
            Math.ceil(millisUntilFinished.toDouble()/1000).toLong()
            val timeString = "${TimeUnit.SECONDS.toMinutes(secondsUntilFinished)}:" +
                    "%02d".format(TimeUnit.SECONDS.toSeconds(secondsUntilFinished))
            Log.d(TAG, ":startTimer::CountDownTimer:millisUntilFinished = $ttlseconds")
            Log.d(TAG, ":startTimer::CountDownTimer:millisUntilFinished = $millisUntilFinished")
        }

        @SuppressLint("SetTextI18n")
        override fun onFinish()
        {
            timerTxtVw.text = "0:00"
            gameStartEndVisibility(true)
        }
    }.start()
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-05-31T09:47:54.917

```
public class Scan extends AppCompatActivity {
int minute;
long min;
TextView tv_timer;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_scan2);
    tv_timer=findViewById(R.id.tv_timer);
    minute=Integer.parseInt("Your time in string form like 10");
    min= minute*60*1000;
    counter(min);
}
private void counter(long min) {
    CountDownTimer timer = new CountDownTimer(min, 1000) {
        public void onTick(long millisUntilFinished) {
            int seconds = (int) (millisUntilFinished / 1000) % 60;
            int minutes = (int) ((millisUntilFinished / (1000 * 60)) % 60);
            int hours = (int) ((millisUntilFinished / (1000 * 60 * 60)) % 24);
            tv_timer.setText(String.format("%d:%d:%d", hours, minutes, seconds));
        }
        public void onFinish() {
            Toast.makeText(getApplicationContext(), "Your time has been completed",
                    Toast.LENGTH_LONG).show();
        }
    };
    timer.start();
} 
```

}

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-08-22T08:25:17.050

```
 var futureMinDate = Date()
    val sdf = SimpleDateFormat("yyyy-MM-dd", Locale.ENGLISH)
    try {
        futureMinDate = sdf.parse("2019-08-22")
    } catch (e: ParseException) {
        e.printStackTrace()
    }

    // Here futureMinDate.time Returns the number of milliseconds since January 1, 1970, 00:00:00 GM
    // So we need to subtract the millis from current millis to get actual millis
    object : CountDownTimer(futureMinDate.time - System.currentTimeMillis(), 1000) {
        override fun onTick(millisUntilFinished: Long) {
            val sec = (millisUntilFinished / 1000) % 60
            val min = (millisUntilFinished / (1000 * 60)) % 60
            val hr = (millisUntilFinished / (1000 * 60 * 60)) % 24
            val day = ((millisUntilFinished / (1000 * 60 * 60)) / 24).toInt()
            val formattedTimeStr = if (day > 1) "$day days $hr : $min : $sec"
            else "$day day $hr : $min : $sec"
            tvFlashDealCountDownTime.text = formattedTimeStr
        }

        override fun onFinish() {
            tvFlashDealCountDownTime.text = "Done!"
        }
    }.start() 
```

传递一个未来日期并将其转换为毫秒。

它会像魅力一样工作。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-12-07T13:01:29.773

试试这个方法：

```
private void startTimer() {
    startTimer = new CountDownTimer(30000, 1000) {

        public void onTick(long millisUntilFinished) {

            long sec = (TimeUnit.MILLISECONDS.toSeconds(millisUntilFinished) -
 TimeUnit.MINUTES.toSeconds(TimeUnit.MILLISECONDS.toMinutes(millisUntilFinished)));

            Log.e(TAG, "onTick: "+sec );
            tv_timer.setText(String.format("( %02d SEC )", sec));
            if(sec == 1)
            {

                new Handler().postDelayed(new Runnable() {
                    @Override
                    public void run() {
                        tv_timer.setText("( 00 SEC )");
                    }
                }, 1000);
            }

        }

        public void onFinish() {
            tv_timer.setText("Timer finish");
        }
    }.start();
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-26T09:19:46.117

```
// the count down timer

 new  CountDownTimer(30000, 1000)
         {
        @Override
        public void onTick(long l) {

        }
        @Override
        public void onFinish() {

                //on finish the count down timer finsih        
                         }

            }
        }

    }.start(); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-12-10T14:35:24.170

我使用 kotlin 流实现了一种很酷的计时器方法，因此您可以在*ViewModel中实现它*

```
 var countDownInit = 30
    fun countDownTimer() = flow<Int> {
    var time = countDownInit
    emit(time)
    while (true){
        time--
        delay(1000L)
        countDownInit = time
        emit(time)
    }
} 
```

然后在您的活动或片段中，只需像这样调用此函数

```
lifecycleScope.launch {
        lifecycle.repeatOnLifecycle(Lifecycle.State.STARTED){
                 viewModel.countDownTimer().collect{time->
                      //and update UI 
                     //and for the finish section you can just use this
                     this.cancel()          
                 }
        }
} 
```

现在在应用程序生命周期暂停时出现崩溃或某事，并且您始终拥有最新的秒数**

# java - 用javascript动态添加输入字段，这些字段的参数名称是什么？

> ID：10032005
> 
> 赞同：0
> 
> 时间：2012-04-05T16:02:52.020
> 
> 标签：java, javascript, html, servlets

我正在使用在 Internet 上找到的以下示例来动态构建输入字段列表。

它似乎工作正常，但是当我提交表单时，我是否使用参数名称来放置来自 HttpServletRequest 的数据？

谢谢，罗伯

```
<HTML> 

<HEAD>     
<TITLE> Add/Remove dynamic rows in HTML table </TITLE>     

<SCRIPT language="javascript">         

function addRow(tableID) {               
    var table = document.getElementById(tableID);               
    var rowCount = table.rows.length;             
    var row = table.insertRow(rowCount);               
    var cell1 = row.insertCell(0);             
    var element1 = document.createElement("input");             
    element1.type = "checkbox";             
    cell1.appendChild(element1);               
    var cell2 = row.insertCell(1);             
    cell2.innerHTML = rowCount + 1;               
    var cell3 = row.insertCell(2);             
    var element2 = document.createElement("input");             
    element2.type = "text";             
    cell3.appendChild(element2);           
}           

function deleteRow(tableID) {             
    try {             
        var table = document.getElementById(tableID);             
        var rowCount = table.rows.length;               
        for(var i=0; i<rowCount; i++) {                 
            var row = table.rows[i];                 
            var chkbox = row.cells[0].childNodes[0];                 
            if(null != chkbox && true == chkbox.checked) {                     
                table.deleteRow(i);                     
                rowCount--;                     
                i--;                 
            }               
        }             
        }catch(e) {                 
            alert(e);             
        }         
    }       
</SCRIPT> 
</HEAD> 

<BODY>

<form name="myform" action="myServlet" method="post">

    <INPUT type="button" value="Add Row" onclick="addRow('dataTable')" />       
    <INPUT type="button" value="Delete Row" onclick="deleteRow('dataTable')" />       
    <TABLE id="dataTable" width="350px" border="1">         
    <TR>             
        <TD><INPUT type="checkbox" name="chk"/></TD>             
        <TD> 1 </TD>             
        <TD> 
            <INPUT type="text" /> 
        </TD>         
    </TR>     
    </TABLE>   

     <input type="submit" value="Go!"/>

</form>

</BODY> 
</HTML> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:07:34.550

您需要为输入对象提供“名称”属性（如果您的 JSP 未使用名称，则为“id”，但我相信名称是首选）

试试这个：

```
function addRow(tableID) {               
    var table = document.getElementById(tableID);               
    var rowCount = table.rows.length;             
    var row = table.insertRow(rowCount);               
    var cell1 = row.insertCell(0);             
    var element1 = document.createElement("input");             
    element1.type = "checkbox";             
    element1.name = "chk_input";      //*** EDIT ***            
    cell1.appendChild(element1);               
    var cell2 = row.insertCell(1);             
    cell2.innerHTML = rowCount + 1;               
    var cell3 = row.insertCell(2);             
    var element2 = document.createElement("input");             
    element2.type = "text";
    element2.name = "text_input";     //*** EDIT ***
    cell3.appendChild(element2);           
} 
```

然后你的参数将被命名为“text_input”和“chk_input”。你当然可以用更有意义的东西来代替它。

我有一段时间没有使用 JSP（我假设这就是 HttpServletRequest 的意义所在……）所以我不记得如何访问它们，但这些将是关键。

编辑：如果您要动态添加行，我想您需要一个唯一的名称。看来您正在跟踪行数，因此您可以执行以下操作：

```
 ...
 element2.name = 'text-input-' + rowCount;
 ... 
```

然后在您的控制器中（无论处理表单），您都可以使用 rowCount 设置一个循环（对于 i .. rowcount），您可以在其中检查表单中每一行的“text-input-”+ CastToString(i) 之类的键.

如果您没有将 rowCount 与表单一起传递，只需添加一个 hidden 类型的输入，其 name='rowCount' 和 rowCount var 的值。您可以在用户单击提交按钮时执行此操作，因此您不必更新每一行）

```
form = document.getElementById('myform');
rc = document.createElement('input');
rc.type = 'hidden'
rc.value = rowCount; // make sure it's in scope!!!
form.appendChild(rc); 
```

# list - 使用 PowerShell 使用随机选择更新 SharePoint 列表选择列

> ID：10032007
> 
> 赞同：0
> 
> 时间：2012-04-05T16:03:02.427
> 
> 标签：list, sharepoint, powershell, sharepoint-2010

我需要使用 PowerShell 更新 SharePoint 列表中的所有项目。我需要更新的列 [在每个列表项中] 是一个包含 5 个不同选项的选项列。我需要为每个列表项随机分配一个选项。

如果可能的话，我想为这些选择中的每一个分配一个概率！（即 - 选择 1 = 30% 机会，选择 2 = 30% 机会，选择 3 = 30% 机会，选择 4 = 5% 机会，选择 5 = 5% 机会）

我已经开始构建我的脚本，但我不确定如何处理 get-random 部分，或者在这种情况下我什至是否使用 get random。

帮助表示赞赏！

```
$web = Get-SPWeb http://weburl
$list = $web.Lists["Project Tasks Backup"] 
foreach ($item in $list.Items) 
{ 
  $item["Task Status"]  = $choices | Get-Random 
  $item.Update(); 
} 
```

非常感谢！

-乔什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:11:04.690

这将为您提供 1 - 5 之间的随机数

```
$rand = New-Object  System.Random
$rand.next(1,6) # gets random number between 1 and 5 
```

[使用 System.Random](http://msdn.microsoft.com/en-us/library/system.random.aspx)

powershell随机性的其他一些例子

[http://poshcode.org/118](http://poshcode.org/118)

[http://tfl09.blogspot.com/2007/01/random-numbers-in-powershell.html](http://tfl09.blogspot.com/2007/01/random-numbers-in-powershell.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T20:21:38.770

假设 Get-Random 满足您的随机性要求，您可以首先使用您指定的权重创建一个选择数组，如下所示：

```
$a = @('c1')*6 + @('c2')*6 + @('c3')*6 + @('c4','c5') 
```

然后您可以使用 Get-Random 从数组中随机选择一个元素：

```
$selected = Get-Random -InputObject $a 
```

或者，您可以对数组进行洗牌：

```
$shuffled = Get-Random -InputObject $a -Count $a.Length 
```

# ios - 如何提高 drawRect 性能以将不同的 UIImage 合并在一起？

> ID：10032010
> 
> 赞同：1
> 
> 时间：2012-04-05T16:03:12.737
> 
> 标签：ios, performance, drawrect

我需要改进我的“drawRect”方法。这太慢了。我有 10 个透明 png，我想将它们与不同的混合模式合并在一起。我读过来自[Apple Developer Lib](http://developer.apple.com/library/ios/#qa/qa1708/_index.html)和[Stackoverflow](https://stackoverflow.com/questions/1663815/how-to-draw-an-uiimage-or-directly-in-drawrect)的帖子。

现在我想知道如何改进我的代码和整体绘图性能。请你帮助我好吗？在 for 循环中加载所有这些图像会很慢，对吧？我如何获得最大的性能？

```
 - (void)drawRect:(CGRect)rect {

        CGContextRef context = UIGraphicsGetCurrentContext();
        CGAffineTransform matrix =CGContextGetCTM(context);
        CGAffineTransformInvert(matrix);
        CGContextConcatCTM(context,matrix);

            CGRect contentRect;

             // load each UIImage
        for (i=0; i< [configurationArray count]; i = i + 1) {   
                    image = [UIImage imageWithContentsOfFile:[[NSBundle mainBundle] pathForResource:imageName ofType:nil]];

    contentRect = CGRectMake(x,y,image.size.width,image.size.height);
    CGContextSetBlendMode (context, kCGBlendModeScreen);
    CGContextSetAlpha (context, [layerData.layerAlpha floatValue]);

    CGContextDrawImage (context,contentRect, image.CGImage);

    }
} 
```

更新：

现在我正在使用 CALayers 将像素直接放在所需的位置。但我需要不同的混合模式、阿尔法和颜色填充每一层。有没有办法避免在每一层上调用昂贵的“CGContextDrawImage”方法？例如，我希望它可以只更新特定层的小尺寸的上下文，对吗？或者我是否需要为每个上下文更改渲染整个 UIView？

我希望有人能把我推向正确的方向。我只需要学习那个主题。谢谢你的帮助。

```
- (void)drawRect:(CGRect)rect {
 // load each UIImage
        for (int i=0; i< [myArray count]; i++) { 

        image = [[ImageCache sharedImageCache] imageForKey:imageName];

       CALayer* sublayer = [CALayer layer] ;

        [sublayer setPosition:CGPointMake(image.size.width/2, image.size.height/2)]; 
        [sublayer setFrame:CGRectMake(x, y, image.size.width, image.size.height)];

        CGImageRef layerImage = [image CGImage];
        [sublayer setContents:(__bridge id) layerImage];
        [sublayer setBackgroundColor:[[UIColor clearColor] CGColor]];
        [self.layer addSublayer:sublayer];

// How can i set the blend mode, color fill & alpha value without 
// calling the expensive "CGContextDrawImage" ? Possible?

}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T12:58:05.073

根据布拉德的评论：

> 您可能不应该在 -drawRect: 中加载您的十幅图像。首先将它们加载并缓存到其他地方。不过，要小心使用这么多图像的内存使用情况。

我已经结束了布拉德的方法。

# php - 服务层：是否应该隐藏领域模型的 API？

> ID：10032012
> 
> 赞同：1
> 
> 时间：2012-04-05T16:03:16.030
> 
> 标签：php, model-view-controller, service-layer

我正在加载 Zend 1.11 并与 Doctrine 1.2 集成，并且已经阅读了很多关于使用服务层的内容。

据我了解，服务层位于业务逻辑之上，在控制器和域模型之间添加了一层。

但是，我被困在如何实际实现服务层上，主要是因为我有点不确定我应该为服务类定义什么类型的 API。

首先，给定一个服务类，`App_Service_Memberships`它将处理业务实体组`App_Model_Group`和用户`App_Model_User`：

服务类的 API 是否应该通过接受或返回所述域模型的实例来公开类的组合？

或者服务类的 API 是否应该通过仅接受或返回诸如整数或数组之类的本机数据类型来隐藏类的组合？

比如说：

```
class App_Service_Memberships
{

    public function addUserToGroup($user_id, $group_id)
    {

        //Create or retrieve domain models here and operate on them; handle persistence.
        $membership = new App_Model_Membership();

        $membership->member->user_id = $user_id;
        $membership->group->group_id = $group_id;
        $membership->join_date = date("Y-m-d H:i:s");

        $membership->save();

        return $membership->toArray();
    }

    public function getMembersOfGroup($group_id)
    {
         $groupMembers = array();

         //Query objects here with Doctrine or the ORM of choice...

         foreach($results as $membership){
             $groupMembers[] = $membership->member->toArray();
         }

         return $groupMembers;
    }
} 
```

控制器只是将整数作为参数（来自表单的数据，或来自其他服务类的输出）传递给服务类，完全忽略了所涉及的域模型。

相对于：

```
class App_Service_Memberships
{
    public function addUserToGroup(App_Model_UserInterface $user, App_Model_Group $group)
    {
        //Create or retrieve domain models here and operate on them; handle persistence.
        $membership = new App_Model_Membership();

        $membership->member = $user;
        $membership->group = $group;
        $membership->join_date = date("Y-m-d H:i:s");

        $membership->save();

        return $membership;
    }

    public function getMembersOfGroup(App_Model_Group $group)
    {
         $groupMembers = array();

         //Query memberships here

         foreach($results as $membership){
             $groupMembers[] = $membership->member;
         }

         return $groupMembers;
    }
} 
```

控制器在哪里可以处理其范围内的域模型，并将它们传递给服务类？

您认为哪种做法更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:56:32.623

> ...服务类的 API 是否应该通过仅接受或返回整数或数组等本机数据类型来隐藏类的组合？

是的，这是理想的。如果您强制服务的客户端（在这种情况下为控制器）传递预先构建的域实体（用户），则强制客户端了解有关域的很多信息。它不应该。

您的服务方法也可以是静态的（但不一定是静态的）。

您实际上并不*需要* ***服务***类的`App_`前缀。不知道这在 ZF 社区是什么时候开始的，但它已经被货物崇拜至死，真的没有必要。我通常将服务（以及特定于应用程序的所有内容）放在`lib`. 更具体地说，我使用`src/main/lib`which 与`src/test/*`and配合得很好`src/vendor/lib`。

至于返回值......我通常让服务方法返回某种集合。数组很好；然而，更丰富的集合对象在许多情况下非常有用（但不是强制性的）。有时我只是使用 Zend Paginator 对象来务实。它不是可用的最丰富的集合对象，但它适用于 OOTB。

# git - Cypress、Pharo 和 Amber 的工作流程

> ID：10032013
> 
> 赞同：4
> 
> 时间：2012-04-05T16:03:19.990
> 
> 标签：git, github, smalltalk, amber-smalltalk

我有一个新的 Pharo 1.4 映像设置，想开始使用 Cypress 并将包导出到 git / GitHub。

开始使用它的最佳方式是什么？文件树？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:14:17.940

是的，[**FileTree**](https://github.com/dalehenrich/filetree)为 Pharo 和 Squeak实现了[Cypress](https://github.com/CampSmalltalk/Cypress)包结构。

[FileTree README](https://github.com/dalehenrich/filetree/blob/master/README.md)提供了安装说明。

密切关注[**amber-cypress**项目](https://github.com/CampSmalltalk/amber-cypress)，了解 Cypress 封装结构的 Amber 实现。

戴尔**[当天晚些时候更新....]**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T19:01:32.123

随着工作的开展，这个问题有一个更好/替代的答案：

使用[琥珀骷髅](http://gemstonesoup.wordpress.com/2012/04/22/amber-skeleton-lookout-kaliningrad/)。

**Amber Skeleton**提供了一个项目模板，其中包含 Pharo 作为 Amber 的 FileServer。[**Amber Skeleton**](https://github.com/dalehenrich/amber-skeleton/blob/master/README.md)有大量的[文档](https://github.com/dalehenrich/amber-skeleton/blob/master/README.md)**。**

# objective-c - RetainCount 可以在这种情况下使用吗？

> ID：10032014
> 
> 赞同：4
> 
> 时间：2012-04-05T16:03:25.023
> 
> 标签：objective-c, ios, nsthread, retaincount

## RetainCount == 坏

`retainCount`是禁忌、不可靠、不可预测的，一般不应该使用。我没有在我的代码中的任何地方使用它，但是我在一个以一种有趣的方式使用的类中看到了它。

我有一个类运行一个无限期运行的线程，直到线程被取消。问题是线程增加了所有者的保留计数，在我的例子中是实例化它的类。所以，即使我用完了那个类，那个实例仍然会挂起，除非管理我的类的人也有聪明的知识来关闭线程。这是一种解决方案，但这是我在代码中找到的。

```
- (oneway void)release
{
    // This override allows allows this object to be dealloced 
    // by shutting down the thread when the thread holds the last reference.
    // Otherwise, the object will never be dealloc'd
    if (self.retainCount == 2)
    {
        [self quitDispatchThread];
    }

    [super release];
} 
```

这是一个聪明的解决方案，但我不知道该怎么想。它覆盖类上的释放并检查保留计数是否为 2。换句话说，**它检查线程是否是唯一使我的对象保持活动状态的线程**（因为保留计数即将从 2 减少到 1 ），如果是，它终止线程（`quitDispatchThread`将阻塞直到线程终止）。

所以...

## 你可以依靠retainCount来看看它是不是一个？

通常人们会说要远离，`retainCount`因为你不知道那里是否有一些自动释放。但是，如果retainCount 是一个，那么我知道只有线程保持它处于活动状态，并且我不必担心retainCount 可能由于某些自动释放等而关闭......

## 这段代码有什么问题？

我正要删除它，但它实际上似乎是有道理的。其他对象不必知道我的类正在运行线程。其他对象甚至可以安全`retain`地拥有线程的对象，而不必担心关闭线程，因为它会照顾自己。`release``autorelease`

这段代码实际上感觉很干净，这让我感到惊讶。

## 编辑 :: NSThread 正在保留我的对象

我使用 NSThread 的事实增加了我的对象的保留计数。我的对象是 the`target`并且`selector`是线程运行的方法。

> **initWithTarget：选择器：对象：**
> 
> 返回使用给定参数初始化的 NSThread 对象。
> 
> *   (id)initWithTarget:(id)目标选择器:(SEL)选择器对象:(id)参数
> 
> **参数**
> 
> *目标*
> 
> 选择器指定的消息发送到的对象。
> 
> *选择器*
> 
> 要发送到目标的消息的选择器。此选择器只能接受一个参数，并且不能有返回值。
> 
> *争论*
> 
> 传递给目标的单个参数。可能为零。
> 
> **返回值**
> 
> 使用给定参数初始化的 NSThread 对象。
> 
> **讨论**
> 
> 对于非垃圾收集的应用程序，方法选择器负责为新分离的线程设置一个自动释放池，并在它退出之前释放该池。垃圾收集应用程序不需要创建自动释放池。
> 
> **对象目标和参数在分离线程的执行过程中被保留**。当线程最终退出时，它们被释放。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T16:47:30.070

> `retainCount`是禁忌、不可靠、不可预测的，一般不应该使用。

您可以依靠`retainCount`IFF 的值，您的对象不会通过任何对您不透明的代码，例如任何 Cocoa 框架。在实践中，这几乎是不可能实现的，因此发出警告。Cocoa 的内部可能会出于多种原因多次传递您的对象、保留、释放并将其放入自动释放池中，您不能在任何给定点依赖它的绝对值。

> 问题是线程增加了所有者的保留计数，在我的例子中是实例化它的类。

那是一个保留周期。这里的答案是想办法打破这个循环，而不是颠覆引用计数机制。当您的线程或拥有对象知道线程正在执行的工作已完成（或需要提前停止）时，在释放*之前*必须有某个时间点。

听起来拥有对象是客户端代码与线程正在执行的工作的接口。*此拥有对象需要一个“立即关闭”方法，该方法需要在其*所有者释放它之前被调用（并记录为“必须调用”） 。在该关闭方法中，您可以通过释放线程来中断循环。

我不确定线程​​保留了它的创建者是怎么回事（这个循环非常清楚地表明*你*的所有权模型有问题）——我猜你正在使用`NSThread`and `initWithTarget:...`，目标是创建/拥有对象。这有点混淆了标准 MVC 模式——线程的所有者是“控制器”，线程本身（及其运行的代码）更像是“模型”。

换句话说，控制器不应该包含线程的代码。我建议您将线程的代码分解为另一个对象以用作目标。然后控制器对象拥有线程本身和“工作”目标对象，它们都不拥有控制器。瞧，没有循环！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:09:24.140

没有。您依赖于一个抽象的实现，该实现在其大门上公开标有“Keep Out”的标志。

只需使用您自己的内存和实现来管理您的依赖项。这可能包括一个 ivar 和/或用于完成/销毁阶段的方法。

另请参阅文档`release`：

> **释放**
> 
> 减少接收者的引用计数。（必需的）
> 
> `- (oneway void)release`
> 
> **讨论**
> 
> 当引用计数达到 0 时，接收方会收到一个 dealloc 消息。
> 
> 您只需实现此方法来定义您自己的引用计数方案。这样的实现不应该调用继承的方法；也就是说，它们不应包含对 super 的发布消息。

如果您想确保您的程序在多个版本中都能正常运行，最好现在就更改它。

# jquery - 如何使用 jquery 捕获第一个克隆列表？

> ID：10032015
> 
> 赞同：1
> 
> 时间：2012-04-05T16:03:30.787
> 
> 标签：jquery

如何使用 jquery 捕获第一个克隆列表？

```
<ul id=testList>
    <li><input type=checkbox" /><p> Test A </p></li>
    <li><input type=checkbox" /><p> Test B </p></li>
    <li><input type=checkbox" /><p> Test C </p></li>
    <li><input type=checkbox" /><p> Test D </p></li>
    <li><input type=checkbox" /><p> Test E </p></li>
</ul> 
```

我的尝试：

```
var firstClonedList = $("#testList li:eq(0)").clone();
alert(firstClonedList.html()); 
```

问题：警报显示：

```
<input type=checkbox" /><p> Test A </p> 
```

正确，但我需要显示警报：

```
<li><input type=checkbox" /><p> Test A </p></li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:09:24.003

尝试这个

```
var firstClonedList = $("#testList li:eq(0)").clone();
alert($('<div/>').append(firstClonedList).html());​​​​​​​​ 
```

这个想法是创建一个`div`作为你的包装器，`li`然后只调用`html()`.`div`

[这里的工作示例](http://jsfiddle.net/cambraca/9wLGV/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T16:11:03.483

你需要一个outerHTML特性..

```
jQuery.fn.outerHTML = function() {
  return $( $('<div></div>').html(this.clone()) ).html();
} 
```

现在您可以在任何地方使用 outerHTML

`alert(firstClonedList.outerHTML());`会显示你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T16:11:52.920

该`html`方法获取`innerHTML`元素的属性。你想要的`outerHTML`财产：

```
firstClonedList.prop('outerHTML'); 
```

但是，此解决方案可能存在一些跨浏览器问题，尤其是涉及 Firefox。有关更多详细信息，请参阅[MDN](https://developer.mozilla.org/en/DOM/element.outerHTML)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T16:19:35.223

您的变量`firstClonedList`列表包含您需要的内容，但通过添加`.html()`您要求提供 firstClonedList 的 html 内容。所以只需使用 firstClonedList[0]

```
var firstClonedList = $("#testList li:first").clone();
console.log(firstClonedList[0]); 
```

​</p>

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T16:09:36.890

您正确获取了`li`其 html 表示为的元素

```
<li><input type=checkbox" /><p> Test A </p></li> 
```

您期望`elem.html()`返回整个 html，但它会在`li`元素内部返回内部 html

来自 jquery[文档](http://api.jquery.com/html/)

> 此方法使用浏览器的 innerHTML 属性。某些浏览器可能不会返回与原始文档中的 HTML 源完全相同的 HTML。例如，如果属性值仅包含字母数字字符，Internet Explorer 有时会省略属性值的引号。

要获取元素的整个源 html，您可以将其插入另一个元素，然后获取该元素的 html，例如

```
alert($("<div>").append(firstClonedList).html())​ 
```

[在这里](http://jsfiddle.net/AsZgz/)看到它的作用

# actionscript-3 - Flash AS3 数组和排序

> ID：10032016
> 
> 赞同：0
> 
> 时间：2012-04-05T16:03:34.927
> 
> 标签：actionscript-3, flash, actionscript

我的问题是我有一个等距网格，仅基于 X，Y 值：每次单击按钮（例如道路）时，都会将此项目推送到数组（）

```
 //
 addChild(roadTiles);
 gameAssets.push(roadTiles);
 arrangeAssets();
 // 
```

我的arrangeAssets方法只是检查数组“没有意义发布，因为它大部分时间都失败了。通常有些项目更新但不是全部。所以我希望有人有一个解决方案来检查X，Y值然后setChildIndex的数组。我看过，继续被推荐给我不感兴趣的第 3 方 as3 引擎，因为我想自己制作并有更好的理解。

![在此处输入图像描述](../Images/9907abdcacfe56bc477a2392831791ca.png)

或者这是不可能的，因为我只使用 X，Y 网格

```
 arrangeAssets();{
var i:int = gameAssets.length;
while(i--){
    if (getChildIndex(sortedItems[i]) != i) {
        gameAssets.sortOn("y", Array.NUMERIC);
        setChildIndex(gameAssets[i], i);
    }
    } 
```

我只将草网格顶部的项目添加到数组中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:48:09.200

假设最左边的点是`x: 0, y:0`瓷砖相互覆盖，从高值`x`和低值`y`到低值`x`和高`y`值。

我会添加一个`weight`变量（你喜欢怎么称呼它），然后计算它`(totalx - x) * y`

这将使最顶角的值为 0，而最底角的值最高。每一行（实际上是对角线）都是一样的。

然后排序`weight`，你有一个相对 z 堆栈中的项目列表。

这并没有真正解决 setchildIndex，因为那里不能有两个项目。一个黑客将删除所有并按顺序添加它们。（您可以有一个临时孩子，将其添加为孩子，这样您就不必删除孩子，因为它是自动完成的）

我发现这张图片显示`weight`了`_y`来自[http://www.kirupa.com/developer/isometric/depth_sorting.htm](http://www.kirupa.com/developer/isometric/depth_sorting.htm)

![在此处输入图像描述](../Images/11b13271c866eec0aec9ffacd52a7d70.png) ![在此处输入图像描述](../Images/a0f0b22c1b96efd1d613b4a2903ac404.png)

_y 是相同的，因为`(totalx - x) * y`水平方向的值相同

# python - 如何扩展 functools.wraps 装饰器的功能？

> ID：10032023
> 
> 赞同：2
> 
> 时间：2012-04-05T16:04:05.373
> 
> 标签：python, decorator, functools

我想创建一个新的装饰器来代替`@wraps(f)`它做任何魔法`@wraps(f)`会做的事情以及其他事情。我该怎么做？

具体来说，我有几个装饰器的形式：

```
def decorator(f):
    @wraps(f)
    def wrapper(*args, **kwargs):
        # does some stuff in here
        return f(*args, **kwargs)
    if not hasattr(wrapper, '_first_line'):
        wrapper._first_line = inspect.getsourcelines(f)[1]
    return wrapper 
```

似乎我应该能够创建`@wraps_with_first_line(f)`一个`@wraps(f)`像`if not hasattr(wrapper, '_first_line'): wrapper._first_line = inspect.getsourcelines(f)[1]`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:08:26.930

您应该遵循添加`__wrapped__`指向包装函数的属性的良好做法，而不是添加该包装函数的单个属性。 [新版本](http://docs.python.org/py3k/library/functools.html#functools.update_wrapper)会`functools.wraps()`自动执行此操作，但如果您使用的是比 3.2 更旧的 Python 版本，您也可以轻松扩展`wraps()`以添加`__wrapped__`：

```
def my_wraps(wrapped, **kwargs):
    def decorator(wrapper):
        functools.update_wrapper(wrapper, wrapped, **kwargs)
        wrapper.__wrapped__ = wrapped
    return decorator 
```

**编辑**：这是一个从可能多重修饰的函数中提取原始函数的函数：

```
def orig_function(f):
    try:
        while True:
            f = f.__wrapped__
    except AttributeError:
        return f 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:12:31.233

如果您要添加*的内容还不*是包装对象的属性，那么您可以使用它：

```
def wraps_with_first_line(f):
    def wrap(wrapper):
        wrapper = wraps(f)(wrapper)
        if not hasattr(wrapper, '_first_line'):
            wrapper._first_line = inspect.getsourcelines(f)[1] 
        return wrapper
    return wrap 
```

如果它已经*是*被包装对象的属性，则使用 Sven 的方法。

# javascript - 如何从给定的 html 字符串中删除前导和尾随空格？

> ID：10032024
> 
> 赞同：197
> 
> 时间：2012-04-05T16:04:07.667
> 
> 标签：javascript, removing-whitespace

我有以下 HTML 字符串。什么是 JavaScript 中用于从该字符串中删除前导和尾随空格的示例代码？

```
<p>&nbsp;&nbsp;</p>
<div>&nbsp;</div>
Trimming using JavaScript<br />
<br />
<br />
<br />
all leading and trailing white spaces
<p>&nbsp;&nbsp;</p>
<div>&nbsp;</div> 
```

* * *

## 回答 #1

> 赞同：273
> 
> 时间：2012-04-05T16:06:42.690

请参阅 String 方法`trim()`- [https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/Trim](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/Trim)

```
var myString = '  bunch    of <br> string data with<p>trailing</p> and leading space   ';
myString = myString.trim();
// or myString = String.trim(myString); 
```

**编辑**

如其他评论中所述，可以使用正则表达式方法。该`trim`方法实际上只是正则表达式的别名：

```
if(!String.prototype.trim) {  
  String.prototype.trim = function () {  
    return this.replace(/^\s+|\s+$/g,'');  
  };  
} 
```

...这会将方法注入到那些仍在池的浅水区游泳的浏览器的本机原型中。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2013-04-02T23:25:03.153

```
var str = "  my awesome string   "
str.trim(); 
```

对于旧浏览器，使用正则表达式

```
str = str.replace(/^[ ]+|[ ]+$/g,'')
//str = "my awesome string" 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-04-05T16:06:36.433

```
string.replace(/^\s+|\s+$/g, ""); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-02-22T20:04:07.830

我知道这是一个非常古老的问题，但它仍然没有一个公认的答案。我看到您希望删除以下内容：“空”的 html 标记和基于 html 字符串的空格。

我根据您对您正在寻找的输出的评论提出了一个解决方案：

```
Trimming using JavaScript<br /><br /><br /><br />all leading and trailing white spaces 
```

```
var str = "<p>&nbsp;&nbsp;</p><div>&nbsp;</div>Trimming using JavaScript<br /><br /><br /><br />all leading and trailing white spaces<p>&nbsp;&nbsp;</p><div>&nbsp;</div>";
console.log(str.trim().replace(/&nbsp;/g, '').replace(/<[^\/>][^>]*><\/[^>]+>/g, ""));
```

`.trim()`删除前导和尾随空格

`.replace(/&nbsp;/g, '')`移除`&nbsp;`

`.replace(/<[^\/>][^>]*><\/[^>]+>/g, ""));`删除空标签

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-03-28T07:22:06.557

如果您使用的是多行字符串，例如代码文件：

```
<html>
    <title>test</title>
    <body>
        <h1>test</h1>
    </body>
</html> 
```

并希望替换所有前导行，以获得此结果：

```
<html>
<title>test</title>
<body>
<h1>test</h1>
</body>
</html> 
```

您必须将`multiline`标志添加到您的正则表达式，`^`并`$`逐行匹配：

```
string.replace(/^\s+|\s+$/gm, ''); 
```

[来自文档的](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/multiline)相关引用：

> “m”标志表示多行输入字符串应被视为多行。例如，如果使用“m”，“^”和“$”将从仅匹配整个字符串的开头或结尾变为字符串中任何行的开头或结尾。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-01-16T08:11:05.717

01)。如果您只需要删除前导和尾随空格，请使用以下命令：

```
var address = "  No.255 Colombo  "
address.replace(/^[ ]+|[ ]+$/g,''); 
```

这将返回字符串“No.255 Colombo”

02)。如果您需要删除所有空白，请使用以下命令：

```
var address = "  No.255 Colombo  "
address.replace(/\s/g,""); 
```

这将返回字符串“No.255Colombo”

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-04-05T16:07:13.250

```
var trim = your_string.replace(/^\s+|\s+$/g, ''); 
```

# svn - 如何SVN提交所有文件，除了一个，只使用命令行？

> ID：10032026
> 
> 赞同：3
> 
> 时间：2012-04-05T16:04:16.217
> 
> 标签：svn, command-line

在我的项目中，有 25 个修改过的文件。我需要将其中的 24 个文件提交到 SVN 存储库。我不想提交的单个文件尚未完成，因此我将在以后提交。

我在 Linux 服务器上使用远程 shell 来执行 SVN 提交。我知道如何执行上述操作的唯一方法是输入：

```
# svn ci file1 file2 file3 file4........... file24 
```

这有点荒谬和低效。有没有更简单的替代方法？我可以*提交所有内容*但选择省略某些文件吗？

是否需要一些花哨的 bash 脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:22:30.987

If you need it in a single transaction try something like this:

```
svn commit `svn status | sed -n -e '/file_you_dont_want/!s/^.......//p'` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:11:32.933

是的。您可以编写一个 bash 脚本来提交某个目录中的所有文件，除了那些您将它作为参数传递的文件。脚本的核心是一个循环：

```
for x in `ls`
do
     svn ci $x
done 
```

您可以选择通过 grep 传递 ls 的输出来组合过滤器，也可以在循环中放置 if 语句。我可能会去第一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-04T12:06:03.077

您可以使用更改列表：

```
svn cl _listName_ -R *
svn --remove 意外文件名
svn commit --cl _listName_

```

# .htaccess - .htaccess 重写在 localhost (mac os x apache) 上不起作用——已修复

> ID：10032029
> 
> 赞同：2
> 
> 时间：2012-04-05T16:04:29.700
> 
> 标签：.htaccess, mod-rewrite, localhost

我在我的 Mac OS X (Snow Leopard) 上使用内置的 Apache 对我的网站进行本地测试。目前我正在尝试为我的 PHP 网站创建干净的 URL，但我似乎无法让它工作。

这是我的.htaccess：

```
Options +FollowSymlinks
RewriteEngine on
RewriteBase /
RewriteRule ^gallery/page/([A-Z0-9._%+-]+) gallery/index.php?page=$1 [NC] 
```

我想要它，这样**http://localhost/gallery/page/TITLE**会自动将我带到**http://localhost/gallery/index.php?page=TITLE**

我的**http://localhost/**指向本地文件夹**/Users/voltm/Sites/localhost/**我正在处理的网站位于**http://localhost/gallery/** - 本地文件夹**/Users/voltm/Sites/本地主机/画廊/**

例如，当我在浏览器中输入**http://localhost/gallery/page/music**时，我收到 404 错误*The requested URL /gallery/page/music is not found on this server*。

我查看了错误日志文件，它说：

```
[Thu Apr 05 23:55:39 2012] [error] [client 127.0.0.1] File does not exist: /Users/voltm/Sites/localhost/gallery/page 
```

我检查了 phpinfo() 和 httpd.conf 以查看 mod_rewrite 已加载。我已经进入 httpd.conf 和用户文件夹中的 conf 文件进行设置：

```
Options Indexes MultiViews FollowSymLinks
AllowOverride All AuthConfig
Order allow,deny
Allow from all 
```

而且我也多次重启了 Apache。

我错过了什么？

* * *

编辑：固定！我不得不删除放在子文件夹中的 .htaccess 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T03:55:27.417

终于想通了！经过数小时的挫折 - 安装了 MAMP，摆弄了 conf 文件并查看了错误日志 - 我终于在[此页面底部看到了评论](http://drupal.org/node/200885)，说我不应该在“MAMP 的 webroot 目录之上和之外”拥有 .htaccess 文件. 我在 gallery/ 文件夹中有另一个 .htaccess 文件，然后我删除了它——现在一切正常。

# email - 通过 imap 使用 Javamail 发送电子邮件

> ID：10032031
> 
> 赞同：5
> 
> 时间：2012-04-05T16:04:31.193
> 
> 标签：email, imap, jakarta-mail

使用 JavaMail 的约定似乎是： -- 使用 smtp 发送电子邮件 -- 使用 imap（或 pop）来阅读电子邮件..

对于我们的应用程序而言，我认为使用电子邮件客户端协议（特别是 imap）发送电子邮件更有用.. 并确保所有已发送邮件的副本进入 gmail 的“已发送”文件夹或使用的任何邮件帐户。

请注意，电子邮件连接的主要目的只是发送邮件，而不是阅读或轮询电子邮件。

希望其他使用 imap 从其 Java 应用程序发送电子邮件的人的意见/建议/示例。所有帖子都表示赞赏。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T18:06:14.170

简单的回答：无法使用 IMAP 发送电子邮件。您必须使用 SMTP 发送电子邮件。

更准确地说，有一些扩展可以结合发送和检索操作。然而，据我所知，这些扩展并没有广泛传播——无论是在客户端还是在服务器端。

另请参阅维基百科上关于 IMAP 的文章（[IMAP#Disadvantages](http://en.wikipedia.org/wiki/Internet_Message_Access_Protocol#Disadvantages)）：

> 与一些结合了发送和检索操作的专有协议不同，使用基本级 IMAP 客户端发送消息并将副本保存在服务器端文件夹中需要将消息内容传输两次，一次到 SMTP 进行传递，第二次到 IMAP存储在已发送的邮件文件夹中。这可以通过一组扩展来解决......

# java - Java 7 下的 JAXB 问题，它说找不到 RI 2.1.0

> ID：10032032
> 
> 赞同：7
> 
> 时间：2012-04-05T16:04:31.613
> 
> 标签：java, linux, jaxb, jersey, jax-rs

我正在使用 Oracle Java 7 Update 3 在 Ubuntu 上运行测试。根据发行说明，它包含 JAXB-2.2.4。

```
/home/ubuntu# update-alternatives --config java
There is only one alternative in link group java: /usr/lib/jvm/java-7-oracle/bin/java
Nothing to configure. 
```

机器说它上面有 JAXB-2.2.4：

```
$ wsimport -version
JAX-WS RI 2.2.4-b01 
```

$ java -版本

```
java version "1.7.0_03"
Java(TM) SE Runtime Environment (build 1.7.0_03-b04)
Java HotSpot(TM) Client VM (build 22.1-b02, mixed mode) 
```

但是，当我运行使用 JAX-RS 并使用 JAXB 编组一些对象的应用程序时，出现以下错误：

```
Apr 05, 2012 10:45:50 AM com.sun.jersey.api.json.JSONConfiguration natural
SEVERE: NATURAL JSON notation configured, but JAXB RI 2.1.10 not found. For the
recent builds to get this working correctly, you need even at least JAXB version
 2.1.12\. Please add it to your classpath!
Apr 05, 2012 10:45:50 AM com.sun.jersey.core.spi.component.ProviderFactory __get
ComponentProvider
SEVERE: The provider class, class com.marketchorus.rest.config.JAXBContextResolv
er, could not be instantiated. Processing will continue but the class will not b
e utilized
java.lang.RuntimeException: NATURAL JSON notation configured, but JAXB RI 2.1.10
 not found. For the recent builds to get this working correctly, you need even a
t least JAXB version 2.1.12\. Please add it to your classpath! 
```

在服务器端，我最初遇到了同样的错误，所以我将 metro-2.2-standalone 安装到了 tomcat 中，从而解决了这个问题。（即使它在 java 7 中运行）。

在 Windows 客户端上，我被迫将 JAXB-2.2.5 api、impl 和 jsr173 jar 添加到我认可的 java 目录中以使其工作（Java 7 update 3 也在那里）。

当我尝试在 ubuntu 下执行 jaxb 技巧时，我将文件放在 /usr/lib/jvm/java-7-oracle/jre/lib/endorsed 下，我得到一个不同的错误：

```
ERROR 10:55:44.694 taskScheduler-1 org.springframework.scheduling.support.TaskUt
ils$LoggingErrorHandler - Unexpected error occurred in scheduled task.
javax.xml.stream.FactoryConfigurationError: Provider com.bea.xml.stream.MXParser
Factory not found 
```

我正在我的班级中初始化 JAX-RS/JAXB 代码，如下所示：

```
config = new DefaultClientConfig();
config.getFeatures().put(JSONConfiguration.FEATURE_POJO_MAPPING, Boolean.TRUE);
config.getClasses().add(JAXBContextResolver.class);
client = Client.create(config);
service = client.resource(UriBuilder.fromUri(proc.getUrl()).build()); 
```

我尝试使用 source=1.7 和 target=1.7 编译它，因为它仍然设置为 1.6，我在想它可能是假设早期 1.6 版本的旧版本太旧了，但这也不能解决问题。

我运行了@andih 的测试程序，但仍然出现错误。我开始认为这是一个虚拟机问题：

```
ubuntu@ip-10-202-155-29:~/test$ java -cp jersey-client-1.12.jar:jersey-core-1.1
2.jar:jersery-fastinfoset-1.12.jar:jersey-json-1.12.jar:. TestNaturalJson
Apr 23, 2012 10:17:21 AM com.sun.jersey.api.json.JSONConfiguration natural
SEVERE: NATURAL JSON notation configured, but JAXB RI 2.1.10 not found. For the
recent builds to get this working correctly, you need even at least JAXB version
 2.1.12\. Please add it to your classpath!
Exception in thread "main" java.lang.RuntimeException: NATURAL JSON notation con
figured, but JAXB RI 2.1.10 not found. For the recent builds to get this working
 correctly, you need even at least JAXB version 2.1.12\. Please add it to your cl
asspath!
        at com.sun.jersey.api.json.JSONConfiguration.natural(JSONConfiguration.j
ava:447)
        at TestNaturalJson.main(TestNaturalJson.java:6)
ubuntu@ip-10-202-155-29:~/test$ java -version
java version "1.7.0_03"
Java(TM) SE Runtime Environment (build 1.7.0_03-b04)
Java HotSpot(TM) Client VM (build 22.1-b02, mixed mode) 
```

回顾 JAXB-2.2.5 RI 认可的解决方案，我安装了文件：

```
jaxb-api.jar
jaxb-impl.jar
jsr173_1.0_api.jar 
```

进入：

```
/usr/lib/jvm/java-7-oracle/jre/lib/endorsed 
```

目录。当我这样做时，我从 Spring MXParser 错误中得到上述错误。这里奇怪的是在 Windows 下可以正常工作，但在 Ubuntu 上不行。当我在下面使用认可的设置运行@andhi 的测试程序时，我得到了 OK 而不是错误。但是由于某种原因，Ubuntu下的Spring似乎没有选择安装在认可目录（即STAX实现）中的JSR173 jar文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T05:01:11.270

在我看来，这就像一个类路径问题。您是否检查过您的类路径中是否有其他`jaxb-impl-x.y.z.jar`或`jaxb-api-k.l.m.jar`s？`JSonConfiguration`查找`com.sun.xml.bind.annotation.OverrideAnnotationOf`属于 JRE7的类`rt.jar`。

您可以使用以下简单程序检查您的*JRE安装：*

```
import com.sun.jersey.api.json.JSONConfiguration;

public class TestNaturalJSon {
    public static void main(String[] args) {
        JSONConfiguration config = JSONConfiguration.natural().build();

        System.out.println("OK");

    }

} 
```

如果您使用 maven，则可以使用具有以下依赖项的 pom：

```
<dependencies>
  <dependency>
    <groupId>com.sun.jersey</groupId>
    <artifactId>jersey-json</artifactId>
    <version>1.12</version>

    <exclusions>
        <exclusion>
        <groupId>javax.xml.bind</groupId>
        <artifactId>jaxb-impl</artifactId>
        </exclusion>
        <exclusion>
        <groupId>javax.xml.bind</groupId>
        <artifactId>jaxb-api</artifactId>
        </exclusion>
    </exclusions>

   </dependency>
</dependencies> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-24T10:11:01.527

要知道从哪里加载类，您应该运行带有`-verbose:class`选项的 JVM 命令行。

这样，您可以通过在`javax.xml.stream.FactoryConfigurationError`抛出异常之前或就在诊断消息之前查看最新的详细行来猜测出了什么问题`JAXB RI 2.1.10 not found`。

所以你可以得到一个实现来自的 jar 并检查该`endorsed`目录是否被使用......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T16:46:03.917

好吧，我很欣赏这里的所有评论，但没有人能解决我的问题，所以我按如下方式解决了它。我将 Metro-2.2 安装到 Tomcat 7 中。然后由于我的应用程序是 Spring 命令行应用程序，因此我用它构建了一个战争，以便它可以在 tomcat 容器中运行。这涉及将我的应用程序的所有库放在 WEB-INF/lib 中，我的配置文件放在 WEB-INF/classes 中。在 WEB-INF 目录中，我放置了一个如下所示的 web.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/j2ee/web-app_3_0.xsd">
    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/classes/remote-scheduler-spring-config.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <session-config>
        <session-timeout>60</session-timeout>
    </session-config>
</web-app> 
```

index.jsp 为空，因为此应用程序没有面向 Web 的组件。spring-config 参数是我将从命令行加载的顶级 spring 配置文件。然后我的 ant build 用这个应用程序构建了一场战争，它运行得很好。所以仍然不确定为什么我在 jvm 中认可的文件没有像建议的那样使用 verbose:class 标志显示它们正在加载，但是通过使用 tomcat 作为容器并在那里加载我需要的类，Jersey 很高兴并且所有问题已经消失。再次感谢您在此问题上的所有帮助。

# iphone - iPhone - OpenGL ES 1.1 - Alpha Blend 使纹理颜色错误

> ID：10032036
> 
> 赞同：1
> 
> 时间：2012-04-05T16:05:09.333
> 
> 标签：iphone, opengl-es, textures, alpha, blend

我是 OpenGL ES 1.1 for iPhone 的新手。今天，我尝试在黑色背景上绘制 png 纹理（纹理包括 alpha chanel），但结果与源 png 文件不同。

iPhone和模拟器上的结果：

![在此处输入图像描述](../Images/4cf8da6746c22aecbc2ab392a8dfad06.png)

关掉这盏灯：

![在此处输入图像描述](../Images/76011c9aae9d8f00b228122f6bcbc532.png)

它应该是（更亮和更模糊）：

![在此处输入图像描述](../Images/589f2d2eea6896caa6f59c1493176c4f.png)

源纹理文件：

![在此处输入图像描述](../Images/ad979ad015e0fb9bc378759d17094197.png)

这是我使用的源代码：

```
//Setup:
glEnable(GL_ALPHA_TEST);
glEnable(GL_BLEND);
glAlphaFunc(GL_GREATER,0.01);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
glEnable(GL_LIGHTING);
glEnable(GL_LIGHT0);
static const GLfloat light0Ambient[] = {1.0, 1.0, 1.0, 1.0};
static const GLfloat light0Diffuse[] = {1.0, 1.0, 1.0, 1.0};
static const GLfloat light0Position[] = {0.0, 0.0, 10.0};
glLightfv(GL_LIGHT0, GL_AMBIENT, (const GLfloat *)light0Ambient);
glLightfv(GL_LIGHT0, GL_DIFFUSE, (const GLfloat *)light0Diffuse);
glLightfv(GL_LIGHT0, GL_POSITION, (const GLfloat *)light0Position);
glEnable(GL_TEXTURE_2D);
glEnableClientState(GL_TEXTURE_COORD_ARRAY);
glEnableClientState(GL_NORMAL_ARRAY); 
```

绘图代码：

```
glBindTexture(GL_TEXTURE_2D, OYTextID);
glVertexPointer(3, GL_FLOAT, 0, GUI_Vertices);
glNormalPointer(GL_FLOAT, 0, GUI_Normals);
glTexCoordPointer(2, GL_FLOAT, 0, GUI_TexCoords);
glDrawArrays(GL_TRIANGLE_STRIP, 0, 4); 
```

是什么问题导致颜色出错？？

感谢您的阅读，感谢您的帮助。最好的问候和对不起我的英语。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T06:24:20.580

看起来您的 PNG 文件已经预乘了 alpha。在这种情况下，您需要设置

```
glBlendFunc(GL_ONE, GL_ONE_MINUS_SRC_ALPHA); // GL_ONE instead of GL_SRC_ALPHA 
```

# facebook - Facebook 标签应用程序。你好 %username 消息

> ID：10032037
> 
> 赞同：0
> 
> 时间：2012-04-05T16:05:09.570
> 
> 标签：facebook, facebook-apps

我们想构建一个带有个性化问候消息的自定义页面。但似乎要获得用户名（或 ID），他们必须授权应用程序。这对我们不利（我们只想说“你好”）。例如，此页面[http://www.facebook.com/modulplan?sk=app_4949752878](http://www.facebook.com/modulplan?sk=app_4949752878)显示用户名和指向用户配置文件的链接，无需任何授权。怎么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:09:28.480

那是使用 FBML，它已被弃用并计划在 6 月删除（请参阅 Facebook 网站上的[路线图](https://developers.facebook.com/roadmap/)）现在要实现这一点，您需要让用户授权您的应用程序并从 API 中提取他们的名称

# excel - 使用过滤和聚合函数查询预先存在的内存 ADODB 记录集（高级 ADODB 库？）

> ID：10032040
> 
> 赞同：3
> 
> 时间：2012-04-05T16:05:20.193
> 
> 标签：excel, vba, ms-access, ado, adodb

我有一些现有代码正在使用不同的参数重复查询 SQL 数据库，我认为如果我将其更改为在开始时将一大块数据选择到 ADODB.Recordset 中，然后在循环中查询它，它可能会执行得更好记录集而不是数据库本身。

另一个警告是，当我执行这些子查询时，我需要使用聚合函数（SUM、MIN、MAX、AVG）。

对此进行编码不会太困难，但是这种显而易见的事情似乎以前已经完成了数千次，这让我想知道那里是否可能存在某种包含此类功能的开源库？我发誓几年前我遇到过一个，但无法在谷歌上找到它。

编辑：
评论中的一个好建议（由 TimW 提出）是在数据库服务器上进行所有聚合并传回客户端，然后在客户端上进行过滤。（尽管在这种情况下它不起作用，因为应用过滤的 2 个列是 DateTime 列）

## 更新

这是我之前遇到的库：
[http ://code.google.com/p/ado-dataset-tools/](http://code.google.com/p/ado-dataset-tools/)

不确定作者是否放弃了它（他的计划似乎是更新它并转换为 c#），但各种库的 VBA 版本似乎在这里可用：
[http ://code.google.com/p /ado-dataset-tools/source/browse/trunk/ado-recordset-unit-tests.xls?spec=svn8&r=8#ado-recordset-unit-tests.xls](http://code.google.com/p/ado-dataset-tools/source/browse/trunk/ado-recordset-unit-tests.xls?spec=svn8&r=8#ado-recordset-unit-tests.xls)

我感兴趣的特定 ADO 库在这里：
[http ://code.google.com/p/ado-dataset-tools/source/browse/trunk/ado-recordset-unit-tests.xls/SharedRecordSet.bas](http://code.google.com/p/ado-dataset-tools/source/browse/trunk/ado-recordset-unit-tests.xls/SharedRecordSet.bas)

具体参见**GroupRecordSet()**函数。
似乎只支持 SUM、MIN、MAX 聚合函数。

## 另一种可能的选择（如果在 Excel 中运行）

**在 Excel VBA 中针对虚拟表编写 SQL 查询**
[http://www.vbaexpress.com/forum/showthread.php?t=260](http://www.vbaexpress.com/forum/showthread.php?t=260)
不确定这将如何执行，但将原始数据（部分预聚合）拉到本地Excel 中的工作表，然后在后续查询中将该工作表用作数据源可能是一个可行的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:21:53.317

我自己的经验是，对数据库进行许多小型调用实际上比将大量数据加载到记录集中然后尝试过滤/查询该数据要高效得多。

我还认为，与对数据库进行单独调用相比，您在现有 ADO 记录集中过滤/查询数据的能力相当有限。当我试图这样做时，我认为它应该像通过使用 SQL 查询第一个 ADO 记录集来创建第二个 ADO 记录集一样简单。我从来没有找到办法做到这一点。我很确定这是不可能的。

**Edit1**
为了帮助您理解差异，我编写了一些代码，这些代码从文本文件中读取新的价格数据，并使用 ADO 和 VFP OLE 驱动程序在 Visual Foxpro 数据库中更新价格。我查询的表有大约 650,000 条记录。我认为最好将所有记录加载到记录集中，然后使用 ADO 的过滤器方法。当我这样做时，我的代码需要三到四个小时才能运行。我将代码更改为只查找每条记录，一次一条，然后我的代码在一分两秒内运行。我在 SO 上发布了这个问题。您可以查看我收到的各种回复：[加快此查找/过滤操作 - (VB6、TextFile、ADO、VFP 6.0 数据库)](https://stackoverflow.com/questions/5127946/speed-up-this-find-filter-operation-vb6-textfile-ado-vfp-6-0-database)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:16:11.387

如果您的性能问题源于连接速度较慢的远程 SQL Server 数据库，那么如果您必须密集处理数据，则本地缓存可能具有一定的意义。

获得大量多功能性的一种方法是使用本地 Jet MDB 作为缓存。

您可以使用 Jet 执行初始“缓存”查询，从远程外部 SQL Server 数据库执行 SELECT 到本地表，然后在其上创建索引。从那里您可以对本地表执行任意数量的后续查询。当您需要使用另一个子集时，只需 DROP 本地表和索引，然后重新查询远程数据库。

但是，除非您的远程连接路径很慢，否则这通常不会给您带来太多收益。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-10T16:13:47.703

根据我对这个主题的研究，没有简单的解决方案或现有的库或商业产品。据我所知，唯一可行的解​​决方案是硬着头皮手动编写解决方案，这对我来说比它的价值要多。

因此，尽管它不是问题的解决方案，但我将其标记为正确答案。:)

# timezone - xpages 和时区

> ID：10032051
> 
> 赞同：0
> 
> 时间：2012-04-05T16:05:53.597
> 
> 标签：timezone, xpages, lotus-notes

我正在构建支持分布在多个国家/时区的用户的应用程序。我对 xpages 中的时区操作有两个问题。请分享您必须的任何提示，以使其更易于编码和维护。

### 时区列表

在 Notes 客户端和传统的 domino 网页设计中，我们有一个标准时区控件，其中列出了详尽的时区选项。使用 xpages，我们没有任何这样的控制，必须自己维护一些基于配置的静态列表。这不是很理想，因为当国家/地区的 DST 规则更改或引入新时区时，它不会更新。这些应用程序也可以通过notes客户端访问，所以我们不能真正使用java tz格式，它应该是notes TZ常量（Z=6$DO..）。

有没有办法显示笔记时区选项的动态列表？

### 时区转换（notes/java）

如何将笔记时区常量转换为其 java 等效项，反之亦然？

*场景：* 如果北美的用户想知道不同时区的当前时间，比如说 X。X 存储在当前的笔记文档中。您可以使用 SSJS 代码进行此转换吗？

目前，我们正在使用`@Texttotimeinzone`和评估它（`@Texttotimeinzone`不是 SSJS 函数）。有没有一种更简单的方法可以将 notes tz 常量转换为 java，以便我们可以使用 java 类执行所有日期转换？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:11:11.600

ExtLib 附带的团队室模板有一个日历，可以选择创建会议和指定时区。

查看自定义控件“controlSectionTimezonePicker”。它可能不是您想要的，但作为一个工作示例应该是一个好的开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-24T21:47:09.903

您可以在日期中包含时区信息。初始化日期变量并使用`.toString()`（[链接到文档](http://docs.oracle.com/javase/6/docs/api/java/util/Date.html#toString%28%29)）

或者您可以使用 JS 在字段中计算它，例如

```
var d=new Date();
d.toString() 
```

而不是`.toString()`，您可以使用`.toUTCString()`.

# r - 如何在 R 中读取多个二进制文件？

> ID：10032052
> 
> 赞同：-3
> 
> 时间：2012-04-05T16:05:56.790
> 
> 标签：r, binary

假设我们在 C:\R\Data 目录中的一个文件夹 file1.bin、file2.bin、... 和 file1460.bin 中有文件，我们想要读取它们并循环从 1 到 4 并取平均然后从 4 到 8 平均等等直到 1460。最后会得到 360 个文件我试图将它们放在一个列表中，但不知道如何制作循环。

如何读取多个文件并对其进行操作？在 R 语言中，
我一直在浪费无数时间来弄清楚它。任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:14:34.853

```
results <- array(dim=360)
for (i in 1:360){
  results <- mean(yourlist[[(i*4):(i*4+3)]])
} 
```

带有 mean(yourList) 调用的 YMMV，但该结构将是您在加载数据后如何循环访问数据的方式。

# java - HashTable 和 Collections.synchronized(HashMap) 的效率

> ID：10032053
> 
> 赞同：0
> 
> 时间：2012-04-05T16:05:59.180
> 
> 标签：java, jakarta-ee

我打算实现一些需要同步数据结构的代码。我想出了`HashTable`和`Collections.synchronized(HashMap)`。我不需要`ConcurrentHashMap`这个。我想知道这两个中哪个更好。

PS：我会调用这个对象的很多吸气剂，他们不会同时出现。所以他们的并发问题也没有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:12:21.977

`ConcurrentHashMap`更具可扩展性：[http ://www.javamex.com/tutorials/concurrenthashmap_scalability.shtml](http://www.javamex.com/tutorials/concurrenthashmap_scalability.shtml)

`HashTable`并`Collections.synchronized(HashMap)`提供相同的性能，但它们是*有条件*的线程安全的（即它们不是完全线程安全的）

如果有很多读操作，我建议用读写锁包装它：

```
public class MyHashMap<K, V> extends HashMap<K, V> {
     private final ReadWriteLock lock = new ReentrantReadWriteLock();

    @Override
    public V put(K key, V value) {
        final Lock w = lock.writeLock();
        w.lock();
        try {
            return super.put(key, value);
        } finally {
            w.unlock();
        }
    }

    @Override
    public V get(Object key) {
        final Lock r = lock.readLock();
        r.lock();
        try {
            return super.get(key);
        } finally {
            r.unlock();
        }
    }
    .... // the same approach distinguishing read and write operations

} 
```

更新：

> 我会调用这个对象的很多吸气剂，他们不会同时出现

它不能保证您不需要同步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:13:35.117

除非您出于某种原因（不太可能）需要在整个地图上获得锁定，否则您应该使用`ConcurrentHashMap`它提供更好的可伸缩性。

`HashTable`同步包装器`Collections.synchronized(HashMap)`（`ConcurrentHashMap`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:29:42.293

尽管 HashTable 是线程安全的，但它并不能保证它使您的整个代码线程安全。HashTable 也存在一些性能问题。所以你应该使用 HashMap 但你必须自己管理所有线程安全。

# c# - 如何设置 Outlook Internet 日历文件夹的地址？

> ID：10032060
> 
> 赞同：0
> 
> 时间：2012-04-05T16:06:55.517
> 
> 标签：c#, .net, outlook, outlook-2010

我想将 Outlook 日历文件夹的地址设置为特定的 URL。我在互联网上找不到任何关于此的注释。我想将`newFolder`URL 地址设置为网站。这是在 Outlook 2010 中：

```
Folder calendarFolder = this._Application.Session.GetDefaultFolder(OlDefaultFolders.olFolderCalendar) as Folder;

NavigationPane pane = this._Application.ActiveExplorer().NavigationPane;
CalendarModule navigation = pane.Modules.GetNavigationModule(OlNavigationModuleType.olModuleCalendar) as CalendarModule;

NavigationGroup group = navigation.NavigationGroups.Create("Appleby Calendars");

Folder newFolder = calendarFolder.Folders.Add("Athletics", Type.Missing) as Folder;
group.NavigationFolders.Add(newFolder); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:19:41.453

我能够通过在应用程序对象中调用此方法来创建文件夹。这将创建一个新文件夹，您可以将其移动到您想要的任何导航文件夹。

```
Folder newFolder = this._Application.GetNamespace("MAPI").OpenSharedFolder("<the .ics usl>") as Folder; 
```

# java - Java - EnumSet.add(enum)，抛出 NullPointerException

> ID：10032062
> 
> 赞同：8
> 
> 时间：2012-04-05T16:06:58.777
> 
> 标签：java, enums, nullpointerexception, enumset

这是在 Java 中，跨平台并在运行 Ubuntu Oneric 的计算机上进行调试，并安装了 OpenJDK 作为我的运行时。

我有一个 EnumSet 用于在我正在开发的游戏中检查一个类的内部。我有这个来自 logcat 的读数，来自我的构造函数中的大量调试：

```
Tile : passability being set...?
Exception in thread "Thread-1" javax.media.opengl.GLException:java.lang.NullPointerException
    ...
Caused by: java.lang.NullPointerException
    at net.darkglass.map.Tile.addPassability(Tile.java:144)
    ... 
```

不好玩。追踪它，我的问题似乎完全是这一行：

```
public void addPassability(Passability type)
{
    this.passability.add(type);
} 
```

我的意思是那个函数的主体。它从构造函数调用为：

```
this.addPassability(Passability.AIR); 
```

当 NullPointerException 发生时。在 Passability Enum Type 的正文中，我有

```
public enum Passability
{
    AIR, ALL, GROUND, NONE, SIGHT, SKILL, STRUCTURE, WATER;
} 
```

因为，从字面上看，整个枚举保存包声明。this.passability 被声明

```
private EnumSet <Passability> passability; 
```

在类定义的开头，我的印象是 add() 方法是作为 Java 标准中 EnumSet 定义的一部分被继承的。

我是自学成才，但我并不疯狂。要么我有问题，要么有更好的方法来做到这一点。有一些有用的知识的人可以伸出援助之手吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-05T16:10:06.187

所以你已经*声明*了这个`passability`变量，但是你没有表现出任何迹象表明它被分配了一个默认值以外的值`null`。也许你的意思是：

```
private EnumSet<Passability> passability = EnumSet.noneOf(Passability.class); 
```

An`EnumSet`是一个对象，就像任何其他对象一样——所以除非你明确地给出你的变量，否则它将具有默认值，`null`当你调用`add`它时，你会得到一个`NullPointerException`——这正是这里发生的事情。

# objective-c - 这个日期是什么格式？

> ID：10032065
> 
> 赞同：0
> 
> 时间：2012-04-05T16:07:15.517
> 
> 标签：objective-c, ios, format, nsdate, nsdateformatter

我正在尝试为此日期编写 NSDateFormatter 格式。我需要使用什么格式将此字符串解析为 NSDate？

> 2007-07-01T00:00:00-04:00

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:10:43.107

这是 RFC 3339 日期。在 Apple 文档中有一个解析这种格式的示例：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html)

```
rfc3339DateFormatter = [[[NSDateFormatter alloc] init] autorelease];
enUSPOSIXLocale = [[[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"] autorelease];
[rfc3339DateFormatter setLocale:enUSPOSIXLocale];
[rfc3339DateFormatter setDateFormat:@"yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'"];
[rfc3339DateFormatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];
date = [rfc3339DateFormatter dateFromString:rfc3339DateTimeString]; 
```

# symfony - Symfony2 自定义最小年龄验证器 - 树枝中没有显示错误消息？

> ID：10032066
> 
> 赞同：4
> 
> 时间：2012-04-05T16:07:16.650
> 
> 标签：symfony, doctrine-orm

我有一个足够简单的最小年龄自定义验证器：

**约束（Minage.php）**

```
namespace MyCompany\VisitBundle\Component\Validator\Constraints;
use Symfony\Component\Validator\Constraint;

/**
 * @Annotation
 */
class Minage extends Constraint
{
    public $message = 'The user must be {{ age }} or over';
    public $age = 18;

    public function validatedBy()
    {
        return get_class($this).'Validator';
    }
} 
```

**验证器 (MinageValidator.php)**

```
namespace MyCompany\VisitBundle\Component\Validator\Constraints;
use Symfony\Component\Validator\Constraint;
use Symfony\Component\Validator\ConstraintValidator;

class MinageValidator extends ConstraintValidator
{
    public function isValid($value, Constraint $constraint)
    {
        $minAge = strtotime(sprintf("-%s YEAR", $constraint->age));
        if(strtotime($value->format("Y-m-d")) > $minAge)
        {
            $this->setMessage($constraint->message,
                              array('{{ age }}' => $constraint->age));
            return false;
        }
        return true;
    }
} 
```

**在我的实体中（剥离不重要的部分）**

```
use MyCompany\VisitBundle\Component\Validator\Constraints as MyCompanyAssert;

/**
 * @ORM\Column(name="birth_date", type="datetime")
 * @MyCompanyAssert\Minage(age="18")
 */
private $birth_date; 
```

**在树枝上：**

```
{{ form_errors(form.birth_date) }}
{{ form_widget(form.birth_date) }} 
```

我确定验证器返回 false，但我的表单拒绝显示错误消息所有其他验证器（开箱即用不是自定义）工作正常并显示它们各自的错误。任何的想法？

翻译被禁用，因此它不会在文件中寻找翻译。

提前致谢。

**更新：`form_errors(form.birth_date)`不起作用，但是`form_errors(form)`呢？为什么它被分配为全局表单错误？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:30:46.037

这种行为的原因是错误冒泡。将字段的`error_bubbling`选项设置为`false`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:33:21.717

您可以尝试添加验证器`$this->context->addViolation($constraint->message);`的方法。`isValid`

# perl - 我怎么能锁定一个目录？

> ID：10032070
> 
> 赞同：0
> 
> 时间：2012-04-05T16:07:38.093
> 
> 标签：perl, locking, directory, rotation

我正在使用`rsnapshot`. 备份路径如下所示：

```
name=$(date +"%Y-%m-%d_%H-%M")
/backup/hourly.0/"$name" 
```

在 perl 脚本中，我从不同的快照中选择对`diffs`我的主目录中的文件进行制作。

```
my $backup = '/backup';

opendir my $dh, $backup or die $!;
my @versions;
while ( defined( my $version = readdir $dh ) ) {
    # ...
    push @versions, $version;
}
# choose from @versions
# do something with the choosen 
```

有没有办法锁定备份目录，以便`rsnapshot`在我运行脚本时不会开始旋转快照？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:41:07.197

您不能使用排他锁锁定目录，因为排他锁要求打开文件进行读写，而无法打开目录进行读写。您可以改为锁定文件，但请记住文件锁定是建议性的。因此，如果`rsnapshot`没有同时锁定目录，那么您将锁定它并且没有其他人关注您的锁定并且它不会完成任何事情。

一些选项：

*   在目录中创建一个锁定文件，并在您的脚本中以独占方式锁定它。还有调用`rsnapshot`锁定它的脚本。
*   使用以时间戳而不是 , 等为文件名后缀的命名方案，`.0`这样`.1`您就不需要旋转它们。
*   使您的扫描脚本对扫描时消失的目录具有鲁棒性。如果目录消失，请忽略它或重新开始扫描。

# c# - 如何将 MySQL 生成的 UUID 转换为 C# 变量

> ID：10032071
> 
> 赞同：1
> 
> 时间：2012-04-05T16:07:40.847
> 
> 标签：c#, mysql, .net-2.0, uuid, varbinary

这是查询：

```
string query = @"INSERT INTO session (PK_Id, user_id, login_time, machine_ip, machine_fingerprint) 
                             VALUES (UUID(), @UId, @LogInTime, @MIp, @MFingerPrint);
                "; 
```

现在我需要返回最后插入的 id，它是 MySQL 生成的 UUID。据我所知，UUID 没有 select_last_insert_id() 函数！我为 php 阅读过，您可以先将 UUID() 函数分配给一个变量，然后返回该值。但是如何在 C# 中实现呢？

像这样，但不完全是：

```
string query = @"INSERT INTO session (PK_Id, user_id, login_time, machine_ip, machine_fingerprint) 
                             VALUES (@UUID = SELECT UUID(), @UId, @LogInTime, @MIp, @MFingerPrint);
                ";                  //how to do this here? 
```

这是我的更多代码：

```
string query = @"INSERT INTO session (PK_Id, user_id, login_time, machine_ip, machine_fingerprint) 
                 VALUES (@UUID = SELECT UUID(), @UId, @LogInTime, @MIp, @MFingerPrint);
                ";

try
{
    if (_conn.State != ConnectionState.Open)
        _conn.Open();
    MySqlCommand cmd = new MySqlCommand(query, _conn);
    cmd.Parameters.AddWithValue("@UId", Utility.usr.Id);
    cmd.Parameters.AddWithValue("@LogInTime", DateTime.Now);
    cmd.Parameters.AddWithValue("@MIp", GetMachineIP());
    cmd.Parameters.AddWithValue("@MFingerPrint", GetHardwareFingerPrint());

    var s= Convert.ToString(cmd.ExecuteScalar()); //this returns an empty string :(
    //I need to get it to any .NET data type, string, or Guid or byte[] or anything. 
```

但是我需要在这样的查询`s`中的另一个`WHERE`子句中使用这种数据类型：

```
string query = @"UPDATE session SET logout_time = @LogOutTime 
                 WHERE user_id = @UId AND PK_Id = @SessionId";

try
{
    if (_conn.State != ConnectionState.Open)
        _conn.Open();
    MySqlCommand cmd = new MySqlCommand(query, _conn);
    cmd.Parameters.AddWithValue("@UId", Utility.usr.Id);
    cmd.Parameters.AddWithValue("@SessionId", s);
    cmd.Parameters.AddWithValue("@LogOutTime", DateTime.Now);
    cmd.ExecuteScalar(); 
```

这`@"SessionId"`是同一张表中的 UUID 字段。所以基本上，我怎样才能在 C# 中获取 MySQL varbinary 字段，以便我可以通过在另一个查询中指定 WHERE 来使用该类型进行更新？

在 MySQL 表中，UUID 字段是 varbinary *（我希望看到一些不是另一个 php 链接或不要求我切换到数据库中的 char 数据类型的解决方案 :)*）。

**编辑：**这里的问题是我们已经将 MySQL 生成的大量 UUID 添加到表中，所以我有点担心将 MySQL UUID 更改为 .NET Guid。如果这是唯一的解决方法，我会考虑的。只是这是我们第一次需要返回插入的 UUID 值，以便我可以在另一个查询中更新另一个时间点。

一个子问题：.NET Guid 与 MySQL UUID 完全一样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:31:36.607

您可以使用`Guid`UUID 的 MS 实现类型。您应该知道，在将数据插入数据库时​​，如果 MySQL 驱动程序不熟悉处理 Guid，您可能需要将 Guid 转换为 ByteArray。有关此示例，请参阅[使用 C# 在 MySQL 中存储 GUID 。](https://stackoverflow.com/questions/742099/store-guid-in-mysql-from-c-sharp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T12:29:21.727

我认为您可以继续您的早期实施，而不必依赖 MS Guid，但我担心我为时已晚 :)

```
string query = @"INSERT INTO session (PK_Id, user_id, login_time, machine_ip, machine_fingerprint) 
                             VALUES (UUID(), @UId, @LogInTime, @MIp, @MFingerPrint); 
                 SELECT PK_Id FROM session WHERE login_time=@LogInTime AND machine_fingerprint=@MFingerPrint; //or something similar which gives you the exact same id - UUID
                ";

try
{
    if (_conn.State != ConnectionState.Open)
        _conn.Open();
    MySqlCommand cmd = new MySqlCommand(query, _conn);
    cmd.Parameters.AddWithValue("@UId", Utility.usr.Id);
    cmd.Parameters.AddWithValue("@LogInTime", DateTime.Now);
    cmd.Parameters.AddWithValue("@MIp", GetMachineIP());
    cmd.Parameters.AddWithValue("@MFingerPrint", GetHardwareFingerPrint());

    MySqlDataReader r = cmd.ExecuteReader();

    if (r.Read()) //ensure if it is read only once, else modify your `WHERE` clause accordingly
    {
        var s = (Guid)r[0];
    }
    //or even (Guid)cmd.ExecuteScalar() would work 
```

现在您可以像这样在更新中查询：

```
string query = @"UPDATE session SET logout_time = @LogOutTime 
                        WHERE user_id = @UId AND PK_Id = @SessionId";

try
{
    if (_conn.State != ConnectionState.Open)
        _conn.Open();
    MySqlCommand cmd = new MySqlCommand(query, _conn);
    cmd.Parameters.AddWithValue("@UId", Utility.usr.Id);
    cmd.Parameters.AddWithValue("@SessionId", s.ToByteArray());
    cmd.Parameters.AddWithValue("@LogOutTime", DateTime.Now);
    cmd.ExecuteNonQuery(); 
```

注意：这里我`s`在查询之前将 Guid 变量转换为字节数组。这很重要，在`WHERE`子句中，无论是它`UPDATE`还是`SELECT`查询中的语句。我会要求你从 varbinary 转移到 MySQL 表中的二进制字段。

**编辑：**如果您的表会变得非常大，那么插入和选择是一个坏主意，因为`SELECT`查询是正在运行的附加查询。在那种情况下，@PinnyM 的选择会更好。我真的不认为 MySQL 或任何其他数据库会有默认方式来返回“自定义”插入的 id，这些 id 不是数据库生成的。所以简而言之，我建议你不要这样做..

**Edit2**：请参阅此[答案](https://stackoverflow.com/a/10681245/661933)以获取 .NET 数据类型的二进制值。根据 MySQL .NET 连接器版本，有时强制转换不起作用。

# android - 试图获取版本号但应用程序崩溃

> ID：10032072
> 
> 赞同：1
> 
> 时间：2012-04-05T16:07:41.410
> 
> 标签：android, eclipse, version, crash-reports

我想获取我的应用程序的版本号，但是当我尝试它时应用程序在加载时崩溃。

```
int currentVersionCode;
try {
    currentVersionCode = this.getPackageManager().getPackageInfo(
            this.getApplicationInfo().packageName, 0).versionCode;
    Toast.makeText(this, currentVersionCode, Toast.LENGTH_SHORT).show();
} catch (NameNotFoundException e) {
    return;
} 
```

日志猫：

```
04-05 16:01:43.108: D/LocationManager(1109): Constructor: service = android.location.ILocationManager$Stub$Proxy@44c0f748
04-05 16:01:43.198: W/ResourceType(1109): No package identifier when getting name for resource number 0x00000001
04-05 16:01:43.208: D/AndroidRuntime(1109): Shutting down VM
04-05 16:01:43.208: W/dalvikvm(1109): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
04-05 16:01:43.208: E/AndroidRuntime(1109): Uncaught handler: thread main exiting due to uncaught exception
04-05 16:01:43.228: E/AndroidRuntime(1109): java.lang.RuntimeException: Unable to start activity ComponentInfo{weather.right.now/weather.right.nowActivity}: android.content.res.Resources$NotFoundException: String resource ID #0x1
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.app.ActivityThread.access$2200(ActivityThread.java:119)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.os.Looper.loop(Looper.java:123)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.app.ActivityThread.main(ActivityThread.java:4363)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at java.lang.reflect.Method.invokeNative(Native Method)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at java.lang.reflect.Method.invoke(Method.java:521)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at dalvik.system.NativeStart.main(Native Method)
04-05 16:01:43.228: E/AndroidRuntime(1109): Caused by: android.content.res.Resources$NotFoundException: String resource ID #0x1
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.content.res.Resources.getText(Resources.java:200)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.widget.Toast.makeText(Toast.java:258)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at weather.right.nowActivity.onCreate(nowActivity.java:58)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-05 16:01:43.228: E/AndroidRuntime(1109):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
04-05 16:01:43.228: E/AndroidRuntime(1109):     ... 11 more
04-05 16:01:43.248: I/dalvikvm(1109): threadid=7: reacting to signal 3
04-05 16:01:43.258: I/dalvikvm(1109): Wrote stack trace to '/data/anr/traces.txt' 
```

我该如何解决我的问题？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:23:09.450

```
float currentVersionCode;
try {
    currentVersionCode = this.getPackageManager().getPackageInfo(
            this.getApplicationInfo().packageName, 0).versionCode;
    Toast.makeText(this, ""+currentVersionCode, Toast.LENGTH_SHORT).show();
} catch (NameNotFoundException e) {
    return;
} 
```

试试这个......一个小的变化

使用以下内容供您参考...

```
String versionName = context.getPackageManager().getPackageInfo(context.getPackageName(), 0 ).versionName; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:10:18.457

问题是您将版本作为 int 传递给 Toast.makeText。如果您将一个 int 传递给 makeText，它假定它是一个字符串资源 ID。这就是您收到未找到字符串资源错误的原因。

将版本代码转换为字符串，然后将其传递给 makeText。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T16:33:11.797

如果你想要 versionName，那么：

```
 String currentVersionName;
    try {
        currentVersionName = this.getPackageManager().getPackageInfo(
                this.getApplicationInfo().packageName, 0).versionName;
        Toast.makeText(this, currentVersionName, Toast.LENGTH_SHORT).show();
    } catch (NameNotFoundException e) {
        e.printStackTrace();
    } 
```

更合适，如果你有

```
 android:versionCode="1"
  android:versionName="Mickey Mouse" 
```

它会显示“米老鼠”。您接受的答案将显示“1”

# python - 在 django 中重现 unicode 错误

> ID：10032077
> 
> 赞同：2
> 
> 时间：2012-04-05T16:07:54.093
> 
> 标签：python, django

有时，当用户提交表单数据时，我会在我的 django 站点中收到如下所示的 unicode 错误。

“'ascii' 编解码器无法对位置 109 中的字符 u'\u2014' 进行编码：序数不在范围内（128）”

如何在我的系统中重现 unicode 错误

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T16:12:09.283

提交导致错误的表单，其中包含 unicode 字符（例如`é`）！

这是 Django 项目中非常常见的错误，它几乎总是意味着您在某处调用 str()。Django 在内部使用 unicode 字符串，但是当您调用 str() 时，您是在要求 Python 返回一个 ascii 字符串，但此消息失败。

如果您向我们提供更多信息，我们将能够为您提供进一步的帮助。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:25:47.617

你有没有在你的视图中留下任何调试打印？这将导致转换为控制台的编码，这可能是导致此错误的 ascii。

# bash - '$?' 是什么意思？在 bash 脚本中是什么意思？

> ID：10032078
> 
> 赞同：18
> 
> 时间：2012-04-05T16:08:00.050
> 
> 标签：bash, syntax

> **可能重复：**
> [“$”是什么意思？给我们一个shell脚本吗？](https://stackoverflow.com/questions/7383144/what-does-give-us-exactly-in-a-shell-script)

bash 脚本中的含义是什么`$?`？下面的例子：

```
#!/bin/bash
# userlist.sh

PASSWORD_FILE=/etc/passwd
n=1           # User number

for name in $(awk 'BEGIN{FS=":"}{print $1}' < "$PASSWORD_FILE" )

do
  echo "USER #$n = $name"
  let "n += 1"
done

exit $? 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-05T16:15:43.730

```
$? 
```

是返回的最后一个错误（或成功）：

```
$?
1: command not found.
echo $?
127

false 
echo $?
1

true 
echo $?
0 
```

最后的出口：

```
exit $? 
```

是多余的，因为 bash 脚本无论如何都会以该状态退出。引用手册页：

> Bash 的退出状态是脚本中执行的最后一个命令的退出状态。

# java - Hibernate Search 是 Lucene 的干净抽象吗？

> ID：10032080
> 
> 赞同：1
> 
> 时间：2012-04-05T16:08:01.487
> 
> 标签：java, hibernate, lucene, hibernate-search

我过去使用过 Hibernate，我和很多人一样对使用 ORM 感到沮丧。由于传统数据库是关系型数据库，因此任何 ORM 都有一个泄漏的抽象。我的大部分时间最终都用于了解抽象的细节，因此我可以获得良好的性能。

然而，Hibernate Search 在 Lucene 之上工作。由于 Lucene 包含相同类型的文档集合，它可能不会像 Hibernate 使用关系数据库那样存在相同的问题。Hibernate Search 是否提供了干净的抽象，或者 Hibernate Search 是否存在与 Hibernate+MySQL 相同的问题？

我正在考虑从原始 Lucene 中的现有实现转移到 Hibernate Search。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T10:24:02.247

一个好的抽象是一种抽象，它解决了底层库没有解决的问题，而对特性集没有或很少妥协。对于 Lucene，这些问题可能是：

*   指数分布，
*   与另一个持久数据源同步，
*   ...

那么，最好的抽象取决于你需要解决的这个问题：

*   如果您只想能够在单个服务器上构建反向索引并对其进行查询，那么请坚持使用纯 Lucene。Lucene 已经是最好的抽象了。任何其他抽象都会增加开销，同时可能会阻止您使用某些功能并且不会使事情变得更容易。

*   如果你想去分布式，那么 Solr 或 Elastic Search 会帮助你很多。

*   如果您想将全文功能与另一个持久数据集集成，那么 Hibernate Search 或 Compass 可能是有趣的候选者。

# c++ - 静态函数中的非静态参数

> ID：10032082
> 
> 赞同：0
> 
> 时间：2012-04-05T16:08:09.380
> 
> 标签：c++, class, variables, static, non-static

我在 MyClass 中有这个静态回调函数，我尝试从中调用另一个静态函数。但是有一个问题，Register() 采用的参数之一是非静态类变量。

我想过使用“this”关键字来解决这个问题，但似乎我无法做到（“this”：只能在非静态成员函数中引用）。这是我的代码：

```
class MyClass
{
...
    static LRESULT CALLBACK klHkProc(int nCode, WPARAM wParam, LPARAM lParam);
    static BOOL Register(DWORD vKey,KEYBLOCK* ptrKEYBLOCK);
    KEYBLOCK *kb;       
...

}
LRESULT CALLBACK MyClass::klHkProc(int nCode, WPARAM wParam, LPARAM lParam)
{
    PKBDLLHOOKSTRUCT p = (PKBDLLHOOKSTRUCT) (lParam);
    if (wParam == WM_KEYDOWN) 
    {
        MyClass::Register(p->vkCode,this->kb);
    }
    return CallNextHookEx(NULL, nCode, wParam, lParam);
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:13:44.253

鉴于您写的内容，如果没有更多信息，很难回答这个问题。

但是，假设`MyClass`应该处理的所有实例，我建议添加一个`static std::list<MyClass *>`，您将每个实例的`this`指针放在构造函数中`MyClass`，然后在析构函数中从这个列表`MyClass`中删除。`this`

然后在您的静态 klHkProc() 中，您将遍历所有实例的静态列表，`MyClass`并为每个调用`MyClass::Register()`的`kb`每个此类注册实例的`MyClass`.

这是执行此操作的代码的粗略轮廓：

```
class MyClass
{
...
public:
    static LRESULT CALLBACK klHkProc(int nCode, WPARAM wParam, LPARAM lParam);
    static BOOL Register(DWORD vKey,KEYBLOCK* ptrKEYBLOCK);
    static std::list<MyClass *> allInstances;
    KEYBLOCK *kb;

    MyClass() {
      ...
      allInstances.push_back(this);
      ...
    }
    ~MyClass() {
      ...
      // Assumes not a huge list of instances as this is O(n) and thus destruction
      // of all instances of MyClass in O(n^2) on the number of instances.
      allInstances.remove(this);
      ...
    }

...
};

LRESULT CALLBACK MyClass::klHkProc(int nCode, WPARAM wParam, LPARAM lParam)
{
    PKBDLLHOOKSTRUCT p = (PKBDLLHOOKSTRUCT) (lParam);
    if (wParam == WM_KEYDOWN)
    {
        std::list<MyClass *> itr = allInstances.begin();
        std::list<MyClass *> end = allInstances.end();
        for (; itr != end; ++itr) {
          MyClass *current = *itr;
          MyClass::Register(p->vkCode, current->kb);
        }
    }
    return CallNextHookEx(NULL, nCode, wParam, lParam);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:13:53.347

静态成员和任何特定对象实例之间没有隐式连接。

`MyClass`您可以将对象的指针或引用传递给`klHkProc()`，然后它可以传递给`Register()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:16:08.993

一般来说，如果 KEYBLOCK *kb 不是静态的，则不能在静态函数中引用它。'this' 指针仅在对象实例中才有意义。因此，如果 KEYBLOCK *kb 仅在实例化对象中有意义，那么您将必须在 Register 或 klHkProc 中实例化 MyClass。如果您为我们提供了关于 Register 应该做什么的更好的上下文，而不仅仅是显示调用者，那么确定后者在 Register 中实例化 MyClass 是否有意义会更容易。

# java - http apache 轴上的 Java soap webservice XML 文档

> ID：10032086
> 
> 赞同：0
> 
> 时间：2012-04-05T16:08:38.967
> 
> 标签：java, web-services

我是网络服务的新手。
我被分配了一个任务，我必须使用 Apache tomcat 客户端创建一个 Java Web 服务将调用这个 Web 服务并发送一个请求 XML 文档

我必须创建一个 web 服务，它将红色这个 XML 并且在一些计算之后 web 服务将返回响应 XML 给客户端。

请指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T12:55:56.190

使用[JAXWS](http://jax-ws.java.net/2.2.6/docs/)。如果您想要更具体的答案，请提出更具体的问题。

# c# - HttpPostedFileBase 返回 null

> ID：10032087
> 
> 赞同：1
> 
> 时间：2012-04-05T16:08:40.353
> 
> 标签：c#, jquery, asp.net, asp.net-mvc

我正在尝试在 ASP.NET MVC 中上传单个 .csv 文件。在我的 .ascx 文件中，我有：

```
 <div>           
            <input type="file" name="file" id="file" />
            &nbsp &nbsp
           <input type="submit" name="btnSubmit" id="btnSubmit" value="Upload" />
        </div> 
```

控制器动作是：

```
 public ActionResult Upload(HttpPostedFileBase file)
        {
            if (file.ContentLength > 0)
            {
                var fileName = Path.GetFileName(file.FileName);
                var path = Path.Combine(Server.MapPath("~/App_Data/uploads"), fileName);
                file.SaveAs(path);
            }
            return View();
        } 
```

问题是我在上传操作中总是将文件设为 Null。关于如何使它工作的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T16:18:35.013

你确定你有一个

```
<form enctype="multipart/form-data" method="post">
<div> bla bla
</div>
</form> 
```

?

编辑：方法=“发布”

+

```
[HttpPost] 
```

关于你的行动

# ios - 在 NSStrings 中自动保存

> ID：10032088
> 
> 赞同：2
> 
> 时间：2012-04-05T16:08:48.553
> 
> 标签：ios, xcode, nsstring, nsuserdefaults

我有三个文本字段：名字、姓氏和年龄，还有一张照片。我该怎么做才能自动保存信息，这样我就不必单击按钮？

这是我的`ViewController.h`：

```
#import <UIKit/UIKit.h>

@interface ContactViewController : UIViewController <UIImagePickerControllerDelegate, UINavigationControllerDelegate> {

    IBOutlet UIImageView *contactImageView;
    IBOutlet UITextField *firstNameTextField;
    IBOutlet UITextField *lastNameTextField;
    IBOutlet UITextField *ageTextField;
}

- (IBAction)save:(id)sender;
- (IBAction)chooseImage:(id)sender;

@end 
```

这是我的`ViewController.m`：

```
- (void)viewDidLoad {
[super viewDidLoad];

    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    NSString *frontName = [defaults objectForKey:@"firstname"];
    NSString *lastName = [defaults objectForKey:@"lastname"];

    int age = [defaults integerForKey:@"age"];
    NSString *ageString = [NSString stringWithFormat:@"%i",age];

    NSData *imageData = [defaults dataForKey:@"image"];
    UIImage *contactImage = [UIImage imageWithData:imageData];

    firstNameTextField.text = frontName;
    lastNameTextField.text = lastName;
    ageTextField.text = ageString;
    contactImageView.image = contactImage;
}

- (void)viewDidUnload {

    [contactImageView release];
    contactImageView = nil;
    [firstNameTextField release];
    firstNameTextField = nil;
    [lastNameTextField release];
    lastNameTextField = nil;
    [ageTextField release];
    ageTextField = nil;
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

- (IBAction)save:(id)sender  {
    [firstNameTextField resignFirstResponder];
    [lastNameTextField resignFirstResponder];
    [ageTextField resignFirstResponder];

    // Create strings and integer to store the text info
    NSString *frontName = [firstNameTextField text];
    NSString *lastName = [lastNameTextField text];
    int age = [[ageTextField text] integerValue];

    UIImage *contactImage = contactImageView.image;
    NSData *imageData = UIImageJPEGRepresentation(contactImage, 100);

    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

    [defaults setObject:frontName forKey:@"firstname"];
    [defaults setObject:lastName forKey:@"lastname"];
    [defaults setInteger:age forKey:@"age"];
    [defaults setObject:imageData forKey:@"image"];

    [defaults synchronize];

    NSLog(@"Data saved");
}

- (IBAction)chooseImage:(id)sender {
    UIImagePickerController *picker = [[[UIImagePickerController alloc] init] autorelease];
    picker.delegate = self;
    picker.allowsEditing = YES;
    picker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
    [self presentModalViewController:picker animated:YES];
}

- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo {
   contactImageView.image = image;

    [picker dismissModalViewControllerAnimated:YES];
}

- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker {

   [picker dismissModalViewControllerAnimated:YES];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:18:55.723

您将不得不使用`<UITextFieldDelegate>`协议

参考：[UITextFieldDelegate 协议](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)

你必须设置

```
textField.delegate = yourViewController 
```

然后可以使用协议函数来处理文本视图的输入和字符更改。

例如你可以使用

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField 
```

当用户按下返回按钮时保存文本字段内容 =)

编辑：可能这种方法更适合您的需求 - 我昨天写帖子时有点累=）

```
- (void)textFieldDidEndEditing:(UITextField *)textField {
    //save your textfied.text string here :)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T06:21:32.647

您需要在您的方法中将委托设置为`UITextfield`视图控制器，例如`viewDidLoad`

```
firstNameTextField.delegate = self;
lastNameTextField.delegate = self;
ageTextField.delegate = self; 
```

你的视图控制器需要实现`UITextFieldDelegate`Protocol 方法：

```
- (void)textFieldDidEndEditing:(UITextField *)textField {
    //Do save Operations here
} 
```

这将仅在文本完成编辑后保存。如果要在用户键入时保存，请使用

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    NSString *stringToSave=[textField.text stringByReplacingCharactersInRange:range withString:string];
    //Identify text field by comparing textField with you text fields and do save operations
    return YES;
} 
```

# mysql - mySQL 限制级联无操作设置

> ID：10032089
> 
> 赞同：0
> 
> 时间：2012-04-05T16:08:53.733
> 
> 标签：mysql, cascade, restrict

在用户发表评论的论坛表上使用的最佳约束是什么？

假设一些用户将在稍后阶段被删除。如果我删除了已发表评论的用户，表格中的用户条目会发生什么？

希望有人能解释一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:19:34.693

这个问题有两个部分：

1.  如何最好地实现这一点？您可以“软删除”用户行。这具有以下优点：

    *   不丢失用户信息
    *   允许取消删除用户
    *   在不丢失与用户相关的数据的情况下保持参照完整性

    软删除可以通过在 users 表中添加另一列来实现`dateDeleted`——如果它是 Null，则不会删除用户。我相信 SO 使用这种机制来删除帖子。

2.  做`restrict cascade no action`什么？MySQL[文档](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)说

> *   RESTRICT：拒绝对父表的删除或更新操作。指定 RESTRICT（或 NO ACTION）与省略 ON DELETE 或 ON UPDATE 子句相同。
>     
>     
> *   NO ACTION：来自标准 SQL 的关键字。在 MySQL 中，相当于 RESTRICT。如果引用的表中有相关​​的外键值，InnoDB 拒绝对父表的删除或更新操作。一些数据库系统有延迟检查，NO ACTION 是延迟检查。在 MySQL 中，立即检查外键约束，因此 NO ACTION 与 RESTRICT 相同。

换句话说，如果你使用它，如果这样做会破坏参照完整性，你将无法删除行。

# java - 如何使用 AspectJ 和 Tomcat 配置加载时编织？

> ID：10032092
> 
> 赞同：8
> 
> 时间：2012-04-05T16:09:04.230
> 
> 标签：java, tomcat, aspectj, load-time-weaving, perf4j

我尝试以以下方式配置加载时编织（用于使用 Perf4J 进行分析）：

1）我添加`aop.xml`到`META-INF`文件夹。部署时，META-INF 被放置在工件根目录（即`MyAppDeployed/META-INF`）中。

2）我把`aspectjrt-1.6.1.jar`, `aspectjweaver-1.6.1.jar`, `commons-jexl-1.1.jar`,`commons-logging.jar`放到`Tomcat/lib`文件夹中（起初我尝试过`MyAppDeployed/WEB-INF/libs`，但也没有用）。

3）我`-javaagent:C:\apache-tomcat-6.0.33\lib\aspectjweaver-1.6.1.jar`在启动Tomcat时添加了VM选项。

4）我的`aop.xml`：

```
<!DOCTYPE aspectj PUBLIC "-//AspectJ//DTD//EN" "http://www.eclipse.org/aspectj/dtd/aspectj.dtd">

<aspectj>

    <aspects>
        <aspect name="org.perf4j.log4j.aop.TimingAspect"/>
    </aspects>

    <weaver options="-verbose -showWeaveInfo">           
        <include within="com.mypackages.MyClass"/>
    </weaver>
</aspectj> 
```

我没有看到任何迹象表明加载时编织发生了。既没有错误报告也没有必要的结果。我唯一的错误信息是：

```
Error occurred during initialization of VM
agent library failed to init: instrument
Error opening zip file: C:\apache-tomcat-6.0.33\lib\wrong-jar.jar 
```

以防我`aspectjweaver-1.6.1.jar`在指定 javaagent 参数时名称错误。如果正确写入 - 不会打印错误消息。

任何想法，我做错了什么？

PS我使用Java 5，我用`1.5.4`aspectj的版本尝试了同样的事情，结果完全相同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T22:39:36.050

如果你想使用加载时间编织，你可以像往常一样首先用*javac编译你的类，然后用**(i)ajc*编译你的方面。您可以使用如下所示的 ant 任务执行此操作

```
<target name="compile-aspect">
    <iajc source="1.6" target="1.6" showweaveinfo="true" verbose="true" outxml="true" debug="true" outjar="${dist.dir}/myaspect.jar">
            <argfiles>
                    <pathelement location="${src.dir}/sources.lst"/>
            </argfiles>
            <classpath>
                    <path refid="master-classpath" />
            </classpath>
    </iajc>
</target> 
```

在编译期间在类路径（*“master-classpath” ）中有***aspectjrt.jar**就足够了。

 *由于我所有的 Java 类都在*${src.dir}*中，我给 iajc 提供了一个源列表。在源列表中只有一行。

*来源.lst*

```
com/xx/yy/zz/LoggingAspect.java 
```

我设置了一些iajc任务的属性如下

```
outxml="true"
outjar="jar_file_name" 
```

当我运行 compile-aspect 任务时，我有一个 jar **jar_file_name.jar**文件包含

```
META-INF/MANIFEST.MF
com/xx/yy/zz/LoggingAspect.class
META-INF/aop-ajc.xml 
```

最后将 *jar_file_name.jar* 添加到您的 Web 应用程序的**WEB-INF/lib**文件夹中。

然后像以前一样使用**-javaagents:/path_to_aspectjweaver.jar**启动 Tomcat 。

**当我将aop.xml（或aop-ajc.xml）直接放在war文件下的META-INF中时，它不起作用。**这种方式（我的意思是将方面类分离到一个 jar 中）对我来说很好。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-12T23:15:42.190

我试图在Tomcat中解决同样的问题。除了 -javaagent 选项，您需要确保 aop.xml 必须在 WEB-INF/classes/META-INF 目录下。这对我来说很重要。*

# java - Android 后端技术 - 语言（Java、Python）和 IDE（CoderBuddy、exo Cloud、Cloud 9）

> ID：10032093
> 
> 赞同：5
> 
> 时间：2012-04-05T16:09:07.630
> 
> 标签：java, android, python, ide, cloud

我已经完成了我的研究并缩小了范围。好的，所以我正在决定用于开发基于云的 Android 应用程序的后端（服务器端）的语言和工具。我已经决定使用 Google App Engine 作为我的框架。由于我要在我的 android 平板电脑上进行开发，所以我想要一个基于云的 IDE。（我将在客户端使用本机 android IDE 应用程序）。

App Engine 支持 Go 编程语言、Java 和 Python。由于似乎没有支持 Go 的稳定云 IDE，我只剩下 Java 和 Python。我已将庞大的 IDE 列表缩小到：

Coderbuddy -（专为 App Engine 设计，但仅限 Python）exo Cloud -（支持 Java 和 Python） Cloud 9 -（支持 Java 和 Python）

我两种语言都不会。无论如何，我都必须学习 Java 才能进行 Android 客户端开发。我知道 Python 的编码速度更快，因此这绝对是一个因素，但我绝对不想牺牲性能或可伸缩性。我会做很多 SQL 数据库的东西。

最后，如果您认为我离得很远，应该朝另一个方向看，请告诉我。谢谢！

编辑：我的背景语言是 Delphi (Object Pascal)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:40:36.980

我的猜测是，使用 Java 您将有很多框架来寻找解决方案，而我真的不认为 Python 会为您提供这些。

关于IDE，我不认为你应该担心Python，你可以使用SublimeText 2或Eclipse（必须安装python编辑器）。两者都工作得很好，Python 很容易部署。

对于 Java，我使用 Eclipse，但一个朋友使用的是 NetBeans，它有一些“快捷方式”来创建诸如服务之类的东西。

同样使用Java，您会因为Android而更加熟悉，所以我认为这是一个加号，更有意义。

你至少需要开始，这样你才能更好地了解什么是最适合你的。

做好准备，这将与 Delphi 有很大不同 ;)

# php - 为什么 PHP 登录脚本使用 GET ID 注销？

> ID：10032094
> 
> 赞同：0
> 
> 时间：2012-04-05T16:09:08.287
> 
> 标签：php, authentication

我目前正在构建自己的登录脚本，并注意到大多数都将会话 ID 或类似于注销页面附加为获取变量。

他们为什么这样做呢？

仅在 logout.php 上销毁会话而不传递任何 ID 不仅安全/更容易吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:13:14.770

我想不出他们`get`只有在注销时才需要添加参数的任何原因。

向 URL 添加一些令牌可用于[防止滥用](http://en.wikipedia.org/wiki/Cross-site_request_forgery)，或者将会话 ID 添加到 url 以在客户端禁用 cookie 时也使会话工作。

**更新**

从[链接的文章](http://blog.ircmaxell.com/2011/08/security-review-creating-secure-php.html)：

> 但是，快速浏览该文件会发现一个相当有趣的问题。它要求将通过登录计算的签名呈现给用户以提交到登录页面。**据推测，这是作为 CSRF 保护的一种形式**。**但是，它也会向用户泄露接管会话所需的数据**。因此，我们来到了迄今为​​止的第 11 个**漏洞：**

**更新2**

我[在聊天中问过 ircmaxell](https://chat.stackoverflow.com/transcript/message/3187855#3187855)。是的，这是因为 CSRF 保护。

# jboss - 在 web.xml 和 jboss-web.xml 中对 SystemProperties 的引用在 JBoss5 中有效，但在 JBoss7 中无效

> ID：10032095
> 
> 赞同：4
> 
> 时间：2012-04-05T16:09:10.947
> 
> 标签：jboss, jboss5.x, web.xml, jboss7.x, staging

在 JBoss 5.1 中，我们曾经使用 SystemProperties 在 web.xml 和 jboss-web.xml 中“暂存”值。在看起来像这样的 web.xml 中：

```
<web-app [...]>

    [...]

    <auth-constraint>
        <role-name>${myRole}</role-name>
    </auth-constraint>

    [...]    

    <login-config>
        <auth-method>${myAuthMethod}</auth-method>
     </login-config>
    <security-role>
        <role-name>${myRole}</role-name>
    </security-role>
</web-app> 
```

此外，我们对 jboss-web.xml 和安全域做了同样的事情。不添加具体值至关重要，因为我们所做的 WAR 模块**是**由我们的代码生成器生成的。JBoss 7 不再替换这些值 - 根据规范这是正确的，但在我们的例子中非常不舒服。

任何想法如何：

*   在运行时进行某种替换？
*   refreign 必须在运行时替换这些值？
*   ... ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:02:13.017

请参阅[https://issues.jboss.org/browse/AS7-3816](https://issues.jboss.org/browse/AS7-3816)。

ejb-jar.xml 的系统属性替换修复将在 JBoss AS 7.1.2 中进行。

您可以检查来源或联系受让人以确保也将针对 web.xml 进行修复。即使还没有，也应该可以说服 Bartosz Baranowski 修复它。

**更新**

[https://issues.jboss.org/browse/AS7-4479](https://issues.jboss.org/browse/AS7-4479) - 我们听说过:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:50:39.953

绝对不是我的强项，但您可能想查看[迁移指南](https://docs.jboss.org/author/display/AS71/How+do+I+migrate+my+application+from+AS5+or+AS6+to+AS7#HowdoImigratemyapplicationfromAS5orAS6toAS7-ChangesyouneedtomakeforSecurity)。[身份验证](https://docs.jboss.org/author/display/AS71/Authentication)文档中也可能有一些有用的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T09:16:45.800

polemoser - 根据哪些规格？在修复任何其他相关问题之前，我正在等待将问题合并到 master 中。

# java - Maven、CDI、JUnit、JPA。想对 HSQLDB 运行测试

> ID：10032097
> 
> 赞同：1
> 
> 时间：2012-04-05T16:09:14.810
> 
> 标签：java, jpa, cdi, guice, jukito

我使用 CDI 和 JPA 编写了一个 JEE6 应用程序。我的测试是用 JUnit 编写的。我想针对内存中的 HSQLDB 数据库运行数据库测试，以确保测试我的 JPQL（我认为是“代码”）。我的动机是使用模拟的 EntityManager 更改 JPQL 语句将导致代码单元的成功测试执行。

我正在使用 Guice 和 Jukito 运行其他（非 jpa）测试。

有没有人有这方面的例子？我试过环顾四周，但我还没有找到一个很好的例子或框架项目来处理这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:31:25.297

Arquillian 的坚持？数据库单元？

# php - XML 验证：“没有可用于验证根的匹配全局声明”错误

> ID：10032101
> 
> 赞同：1
> 
> 时间：2012-04-05T16:09:25.003
> 
> 标签：php, xml, validation, xsd

当我验证以下 xml 时：

```
<?xml version="1.0" encoding="UTF-8"?>
<AvailRateUpdateRQ xmlns="http://www.expediaconnect.com/EQC/AR/2011/06"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xsi:schemaLocation="http://www.expediaconnect.com/EQC/AR/2011/06  ./XSD/AvailRateUpdateRQ.xsd">
  <Authentication username="user" password="ECLPASS"/>
  <Hotel id="111"/>
  <AvailRateUpdate>
    <DateRange from="2012-04-05" to="2012-04-07"/>
    <RoomType id="01">
      <Inventory totalInventoryAvailable="10"/>
      <RatePlan id="52ASD">
        <Rate currency="EUR">
          <PerDay rate="185.00"/>
        </Rate>
        <Restrictions minLOS="2" maxLOS="3" closedToArrival="true"/>
      </RatePlan>
    </RoomType>
  </AvailRateUpdate>
</AvailRateUpdateRQ> 
```

使用此架构：

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 2011 Expedia, Inc. All Rights Reserved -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" 
  xmlns="http://www.expediaconnect.com/EQC/AR/2011/06" 
  targetNamespace="http://www.expediaconnect.com/EQC/AR/2011/06" 
  elementFormDefault="qualified" 
  attributeFormDefault="unqualified" 
  version="2.0.0">

  <xs:element name="AvailRateUpdateRQ">
      <xs:complexType>
         <!-- Definitions of some other element there -->
      </xs:complexType>
  </xs:element> 
```

我收到此错误：

> 错误：1845 元素“AvailRateUpdateRQ”：没有可用于验证根的匹配全局声明。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:48:59.997

我遇到了类似的问题。您是否手动生成 XML？我是，问题是当我添加`xmlns="Shema Info"`时，它实际上并没有像解析器在读取文件时那样在根节点上设置名称空间。所以我生成的根节点不在名称空间中，因此它与验证模式中的根节点不匹配。

我使用的是 libxml2，所以调用不同。但是在节点上设置 xmlns 属性时，我改为：

```
ns = xmlNewNs(par, val, NULL);
xmlSetNs(par, ns); 
```

`par`是父级，`val`是命名空间 url。我不确定`par`第一次调用是否需要该参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T13:49:27.920

真的非常好笑。

`$dom->loadXML($dom->saveXML)`- 这是帮助我解决问题的代码的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-13T11:16:16.287

尝试使用`\XMLReader`for 验证，而不是`\DOMDocument`.

# jquery - jQuery 附加，通常是隐藏的，在模态窗口使用后重新出现 如果我使用了错误的术语，请提前道歉，我对 jQuery 很陌生。我正在一个具有响应式设计的网站上工作。在较小的屏幕尺寸下，菜单通过 jQuery/CSS 替换为选择下拉菜单。（我通过 jQuery 附加 <select>字段，默认为 display:none 通过 CSS，然后通过 CSS 媒体查询以较小的分辨率显示它。）这一切都很好，但似乎与另一个 jQuery 插件有冲突我' m 正在运行，它会在模态窗口中自动显 ID：10032103 赞同：0 时间：2012-04-05T16:09:29.397 标签：jquery, lightbox, media-queries 回答 #1 赞同：0 时间：2012-05-04T19:50:15.240 我通过在其中运行我的 jQuery 来解决这个问题 jQuery(window).load(function($) 代替 jQuery(document).ready(function($) [编辑]：其实我不相信以上是最终的解决方案。我认为发生的事情是在 jQuery 本身（最新版本，1.7.2）中，在模态窗口关闭后，该<select>字段的样式被设置为""（空白，转换为）。inline-block如果我理解正确，这是解决<select>s 在早期版本的 IE 中具有一些高得离谱的 z-index 问题的“修复”，因此可以通过模态窗口显示。jQuery 将它们设置display:none为模态窗口显示，然后在窗口关闭后重置它们。 然而，就我而言，这导致添加display: inline-block到我之前隐藏的<select>元素中。我通过!important在 CSS 两个地方 display: 中添加声明来解决这个问题。哇！</select>

# c# - 为什么 BitmapData.Stride 会忽略传递给 LockBits 的矩形大小？

> ID：10032104
> 
> 赞同：1
> 
> 时间：2012-04-05T16:09:32.577
> 
> 标签：c#, lockbits

我有一张图像，想读取特定区域的像素值。

我假设作为该`LockBits()`方法的第一个参数的矩形在那里允许指定子部分。但是在调试时，我注意到 的值`BitmapData.Stride`是原始位图宽度的 3 倍，而不是矩形宽度的 3 倍。

为什么是这样？我是否误解了矩形参数的用途？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:18:21.357

它为 GDI+ 提供了一种优化像素数据到内存映射的方法。使用较小的矩形需要较少的内存页。步幅相同，原始位图的步幅。在位图中索引扫描线时，无论矩形的大小如何，都必须使用该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T22:11:38.893

它这样做是为了给你一个指向它已经分配的缓冲区的指针，而不是分配一个新的缓冲区并将像素数据复制到它。

# matlab - 为什么打印大量 (.png) 图形时 MATLAB 会变慢？

> ID：10032117
> 
> 赞同：5
> 
> 时间：2012-04-05T16:10:14.240
> 
> 标签：matlab, memory-leaks

我正在将大量数字打印为 .png 文件。每个图都是数据矩阵中一列的图，我将 .png 文件串在一起形成动画。

我的问题是前几百张图像打印得很快，但是创建每个新图形的时间迅速增加，从前几百个 .png 文件的约 0.2 秒到大约第 800 个图形的 2 秒或更多。

在脚本运行期间内存使用量会增加，但每隔几秒左右只会增加 1MB。这是在运行 R2009b 64 位的 Windows 上。

我的代码看起来像：

```
n = 1000;
matrix = rand(n);

f = figure('Visible','off');    % create the figure

for i_ =1:n
    plot(1:n,matrix(:,i_));
    ylim([0 1]);
    set(f,'PaperUnits','inches','PaperPosition',[0 0 6 4]);
    png_name = [ 'img/timestep_' sprintf('%05d',i_) ];
    print('-dpng', png_name);
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T16:57:51.427

尽量不要重新生成绘图，而只在每次迭代时更改`XData`和属性：`YData`

```
set(f,'PaperUnits','inches','PaperPosition',[0 0 6 4]);
h = plot(1, matrix(:,1));
ylim([0 1]);

for i_ = 1:n
    set(h, 'XData', 1:n, 'YData', matrix(:,i_))
    png_name = sprintf('img/timestep_%05d',i_);
    print('-dpng', png_name);
end 
```

另一个建议。如果要创建动画，为什么要生成 png 文件？使用[GETFRAME](http://www.mathworks.com/help/techdoc/ref/getframe.html)并直接在 MATLAB 中制作[MOVIE 。](http://www.mathworks.com/help/techdoc/ref/movie.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-06T15:42:58.430

这似乎是内存泄漏。您可以通过创建和[关闭](http://www.mathworks.com/help/matlab/ref/close.html)循环中的每个图形来帮助 Matlab 释放泄漏的内存。

```
for i = 1:n
    f = figure;
    % plot
    % print
    close(f)
end 
```

**更新：** [这是一个问题和答案](https://stackoverflow.com/q/18661249/1339280)，说明这种技术有效。

# c# - 温莎城堡通用型工厂

> ID：10032118
> 
> 赞同：0
> 
> 时间：2012-04-05T16:10:15.353
> 
> 标签：c#, .net, castle-windsor, castle

在 Kozmic 的博客（日期为 2009 年）上，他推荐使用 Generic Factory 从容器中检索对象。好吧，这对我来说似乎是一个伪服务定位器。所以想在这里问问专家的意见。

```
 public interface IGenericFactory
  {
        T Create<T>();
  } 
```

我可以使用它从 Windsor 容器中获取对象吗？这种方法有什么缺点吗？

**更新：**

实际上，我只想用它来获得一些我不想为其创建多个工厂的瞬态。为所有此类场景拥有一个工厂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T19:34:03.637

我做了一个快速的谷歌搜索，发现你可能指的是这篇文章：http: [//kozmic.pl/2009/12/23/castle-typed-factory-facility-reborn/](http://kozmic.pl/2009/12/23/castle-typed-factory-facility-reborn/)

如果是这样，那么 Krzysztof Koźmic 自己说：

> [...] 您可以毫不费力地使用它来构建*通用服务定位器*。

是的，现在[Service Locator 被认为是一种反模式](http://blog.ploeh.dk/2010/02/03/ServiceLocatorIsAnAntiPattern.aspx)。

但是，这篇文章是关于特殊情况的。作者在第一段中说得很清楚：

> 使用 IoC 容器时的一般经验法则是——当您在组件中（在引导代码之外的任何地方）引用容器时，您做错了。与所有规则一样，也有例外，但很少见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-10T22:03:02.090

相反，请考虑以下事项：

```
public interface IGenericFactory<out T>
{
    T Create();
} 
```

该接口只需要创建一次，但必须为您需要解析的每个服务注入它。这样，它就不是一个通用的服务定位器（这是一个反模式，如 w0lf 之前提到的）。

奖励积分：

正常的依赖注入要求可以解析依赖图中的所有服务。 `IGenericFactory<>`将通过类型化的工厂设施自动解决。但是它的泛型类型参数在执行之前不会被解析`Create()`。

如果这种情况发生在程序深处的边缘情况下，并且您忘记注册服务，那么您可能直到生产时才意识到该错误。

解决方案是编写一个自定义解析器，用于`IGenericFactory<>`检查泛型类型参数是否具有处理程序，并且它没有等待注册任何依赖项。有关自定义解析器的信息在这里： [http ://docs.castleproject.org/Windsor.Resolvers.ash](http://docs.castleproject.org/Windsor.Resolvers.ash)

# jquery - 使用 jquery 对话框在 mvc 视图中编辑表

> ID：10032124
> 
> 赞同：0
> 
> 时间：2012-04-05T16:10:37.747
> 
> 标签：jquery, asp.net-mvc-3, razor

我正在使用 MVC 3 + Razor。我有一个名为 Details 的 MVC 视图。我从 SQL Server 数据库表中检索并显示了详细信息数据。我有一个可点击的`<a/>`列“类型”。单击 Type Anchor 链接将显示一个 Jquery 弹出窗口。

```
| type      |   date   | completed |  
|________________________________ _|  
|           |          |           |  
| sample    | 1/1/2012 |           |  
|(Clickable)| 
```

1.  如何从 SQL Server 的表中检索与 Clicked 元素相关的整个行数据，并在 Jquery Dialog 上显示该数据。每个类型字段都有一个与之关联的 ID。

2.  我在 Jquery Dailog 上有一个复选框。如果选中，则视图中的已完成列必须具有当前日期并且必须更新数据库表（其中包含日期字段）。

寻找代码示例或链接或教程 - 无法找到任何具有编辑和添加功能的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T08:50:31.633

使用部分视图进行弹出，根据您的要求制作 UI，并将行详细信息作为模型传递给此部分视图。

你的表格 html 看起来像，

```
<tr id="@model.rowid">
        <td>
            sample
           (<a onclick="RowDetails(@model.rowid)">Clickable</a>)
        </td>
        <td>
            1/1/2012
        </td>
        <td>
        </td>
    </tr> 
```

单击 Clicktable 时调用 javascript 函数，例如，

```
function RowDetails(RowId) {
        $("#divDetails").load('/yourController/rowdetail', { id: RowId }).dialog({
            modal: true,
            title: "Row Detail",
            height: 400,
            width: 600,
            buttons: {
                "Ok": function () {
                    var isComplete = 0;
                    if ($("#rowComplete").is(":checked")) { isComplete = 1; }
                    $.get("/yourController/RowComplete", { id: RowId, isChk: isComplete }, function (d) {
                        $("#" + RowId).before(d).remove();
                        $("#" + RowId).hide().fadeIn('slow');
                    });
                    $(this).dialog('close');
                }
            }
        });
    } 
```

和控制器一样，

```
public ActionResult rowdetail(int id)
{
// code to get row from databse
// return this row as object to partial view
return("partial view for row details", Object);
}

public ActionResult RowComplete(int id, int chk)
{
// code to update row from databse
// return this row as object 
return("pass updated row", Object);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:34:47.580

I am not familiar with asp.net or razor, but I do know that with jQuery you would first make an ajax request to the server where a script would load the sql data, convert it to a JSON string, and send it back to jQuery. jQuery then can parse the JSON and populate the fields.

Dealing with dates in jQuery (javascript in general) can be tricky because it's based on the client's machine and not the server's. I would suggest running with ajax again, letting the server check against the current date and handling the database update.

# jquery - PUT 请求错误（NetworkError: 415 Unsupported Media Type）

> ID：10032125
> 
> 赞同：0
> 
> 时间：2012-04-05T16:10:42.013
> 
> 标签：jquery, ajax

我正在尝试使用 jquery 发送 PUT 请求，并且服务器不断发送“NetworkError：415 Unsupported Media Type”作为响应。

使用终端，我可以成功地做到：

```
curl -X PUT -d '{"data-1" : 2.00, "data-2" : false}' -H "Content-Type:application/json" http://site.com/api/add/none/1053809 
```

但是 ajax 调用不断失败，如下所述：

```
$.ajax({
    url: "http://site.com/api/add/none/1053809",
    type: "PUT",
    data: '{"data-1" : 2.00, "data-2" : false}',
    success : function(msg) {
        console.log(msg);
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:15:57.340

不幸的是，并非所有浏览器都支持 PUT 方法。试一试最新版本的 Chrome，看看它是否适用。

# .net - 为什么 net.tcp IIS 端口配置在“绑定信息”下而不是“端口”下

> ID：10032128
> 
> 赞同：3
> 
> 时间：2012-04-05T16:10:50.727
> 
> 标签：.net, wcf, iis, port, net.tcp

在 IIS7 中，当您为 WCF 服务配置 http 绑定时，您在端口列中设置端口，在 ip 地址列中设置 ip；但是当您配置 net.tcp 绑定时，您必须将其全部塞入“绑定信息”列中，例如 808:*。为什么不一致？有人问我为什么会这样，我无法回答。

# sencha-touch-2 - Sencha Touch 2 - 在 Ajax.Request 之后更改视图

> ID：10032130
> 
> 赞同：0
> 
> 时间：2012-04-05T16:10:57.077
> 
> 标签：sencha-touch-2

这听起来可能很奇怪，但由于这个问题，我在过去 2 个小时里一直在敲我的脑袋。我有一个功能，一旦我按下登录按钮就会触发，按下它就会启动一个 Ajax 请求。

```
 onEnter: function () {

      Ext.Viewport.mask();

      var email = Ext.getCmp('email').getValue();
      var pass = Ext.getCmp('pw').getValue();
      var consegui = 0;

      Ext.Ajax.request({

       controller: 'AP4.controller.MainCont',

          url: 'myurl',
           method: 'POST',
           callbackKey: 'callback',
          jsonData:{"username":'user', "password":'pass'},

          success: function(result) {
            //Se o webservice nao der erro ele entra aqui, nao quer dizer que tenha 
            //sido correctamente criado session
            // Unmask the viewport
            Ext.Viewport.unmask();
            Ext.Msg.alert("Login Done! Congrats!");
            Ext.Viewport.setActiveItem(this.getRegisto()); **//THIS LINE IS NOT WORKING**

          },         
          failure: function(result){       
            Ext.Msg.alert("Username ou Palavra passe Incorrectas!");        
          },

      });     
 }, 
```

出于某种原因，setActiveItem 不起作用，我不知道为什么。谁能帮我 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:40:14.867

我认为您`this.getRegisto;`在错误的范围内访问函数，`this`您是否在成功回调中检查了指向您想要的对象的关键字？

要更改成功回调的范围，您只需`scope`在调用中添加参数`Ext.Ajax.request`，就像这样

```
Ext.Ajax.request({
   url: 'myurl',
   method: 'POST',

   success: function(result) {
        // this will point to ViewPort object here
   },

   failure: function(result){
        Ext.Msg.alert("Username ou Palavra passe Incorrectas!");        
   },

   scope : Ext.Viewport     // this is used just for illustration, please specify correct scope here
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:21:23.163

如果 Registo 在您的视口中，为什么不使用 setActiveItem(some number) 就像如果 Registro 是您视口中的第一个项目，然后执行 setActiveItem(0);

# asp.net-mvc-3 - LINQ 不想在 ASP.NET MVC 中显示

> ID：10032136
> 
> 赞同：0
> 
> 时间：2012-04-05T16:11:09.947
> 
> 标签：asp.net-mvc-3, sql-server-2008

我想在我的 ASP.NET-MVC 3 + SQL Server 2008 应用程序中显示当前自动用户表中的所有记录。但是我有一些问题：

此代码与 LINQ-request 运行良好：

```
public ActionResult Index(todo obj)
        {
           string u = User.Identity.Name; 
           var th = (from tt in _db.todo select tt);
           return View(th);
        } 
```

但这段代码不起作用：

```
public ActionResult Index(todo obj)
          {
             string u = User.Identity.Name; 
             var th = (from tt in _db.todo where obj.login == u select tt);
             return View(th);
           } 
```

这段代码运行良好

```
if (u == obj.login) { ViewBag.res = "ok"; } else { ViewBag.res = "fail"; } 
```

我做错了什么，请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:15:03.743

您可能希望针对您正在查询的表运行您的 where 条件，而不是针对方法中的参数，即：

`var th = (from tt in _db.todo where tt.login == u select tt);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:16:09.697

而不是`obj.login == u`，尝试

```
obj.Contains(u) 
```

# sql - 有人可以解释这个查询吗

> ID：10032138
> 
> 赞同：1
> 
> 时间：2012-04-05T16:11:18.347
> 
> 标签：sql, oracle

这是查询

```
SELECT * FROM customers  
WHERE 
     NOT EXISTS 
     (     
          SELECT 1 FROM brochure_requests     
          WHERE  brochure_requests.first_name = customers.customer_first_name AND    
          brochure_requests.last_name = customers.customer_last_name
     ) 
```

这个查询工作得很好，但我不确定它为什么工作。在 NOT EXISTS 部分中**1**`SELECT 1`是什么意思。当我运行此查询时

 **```
select 1 from test2 
```

结果如下：

```
1
-----
1
1
1
1
1
1
1
1
1
1
1
.. 
```

不存在查询如何工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:14:13.097

编译器足够聪明，可以忽略`SELECT`. `EXISTS`所以，基本上，如果它会因为过滤器匹配而返回行，那就是它所关心的......永远不会执行的`SELECT`部分。`EXISTS`它仅将 EXISTS 子句用于评估目的

我有这个误解很长一段时间，因为你会看到`SELECT 1`很多。但是，我见过 42、* 等......它从不真正关心结果，只是会有一个 :)。要记住的关键是 SQL 是一种编译语言，因此它会适当地优化它。

你可以放一个 1/0 并且它不会抛出被零除的异常......从而进一步证明结果集没有被评估。这显示在[这个 SQLFiddle](http://sqlfiddle.com/#!4/e038e/2)

小提琴的代码：

```
CREATE TABLE test (i int)
CREATE TABLE test2 (i int)

INSERT INTO test VALUES (1)
INSERT INTO test2 VALUES (1)

SELECT i
FROM test
WHERE EXISTS
(
  SELECT 1/0
  FROM test2
  WHERE test2.i = test.i
) 
```

最后，更重要的是，`NOT`简单地否定 an `EXISTS`，说 IGNORE 任何匹配的行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:15:21.787

子查询是所选字段上的和表之间的[关联子查询](http://en.wikipedia.org/wiki/Correlated_subquery)连接。`customers``brochure_requests`

该`EXISTS`子句只是一个仅返回匹配行（以及`NOT`否定该行）的谓词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:25:22.763

查询：

```
select 1 from test2 
```

显示值 1 作为 test2 表中所有记录的值。

每个`SELECT`查询必须至少有一列。我认为这就是这里使用值为 1 的未命名列的原因。

子查询为您提供表中相关客户的行`brochure_requests`。

`NOT EXISTS`导致主查询返回表中所有`Customers`不在表中的行`brochure_requests`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-10T10:37:21.450

有问题的关系运算符被称为[“反连接”](https://stackoverflow.com/questions/7494586/get-non-existing-data-from-another-table-join/7496263#7496263)（或者“不匹配”或“半差异”）。在自然语言中：使用公共属性 first_name 和 last_name 不匹配 brochure_requests 的客户。

密切相关的运算符是关系差异（或者“减号”或“除外”），例如在 SQL 中

```
SELECT customer_last_name, customer_first_name
  FROM customers  
EXCEPT
SELECT last_name, first_name  
  FROM brochure_requests; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-05T16:16:05.170

如果客户要求提供小册子，则子查询会为此客户返回 1。并且不会将此客户添加到返回结果集中。bcouse of NOT EXISTS 子句。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-04-05T16:16:20.593

注意：我不了解 Oracle，也不是特别擅长 SQL。

但是，`SELECT 1 from`只需为匹配该子句`1`的每一行返回一个。`from`因此内部`select`可以找到`brochure_requests`名称字段与`customer`当前正在考虑的行匹配的行，它将产生`1`结果并失败`NOT EXISTS`。

因此，查询会选择所有姓名`customers`不匹配的人。`brochure_request`

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-04-05T16:17:06.987

对于表`Customers`的每一行，查询在`sub-query`. `NOT EXISTS`不返回任何行。

如果中的子查询`NOT EXISTS`返回行，`Customers`则不返回表的行。**

# jquery - jQuery更改选择列表的值

> ID：10032142
> 
> 赞同：7
> 
> 时间：2012-04-05T16:11:42.140
> 
> 标签：jquery, jquery-selectors

我有以下代码

```
<select id="practice_id" name="practice" column="practice" style="width: 200px">
 <option value="">Default</option>
 <option value="1">Test 1</option>
 <option value="2">Test 2</option>
 <option value="3">Test 3</option>
 ...............
</select> 
```

我需要做的，是根据一个查询字符串号将选中项的值改为一个（我可以得到这个值ok）

我正在尝试使用 jQuery 更改值，但我尝试过的任何方法似乎都不起作用。

```
$('#practice_id').val('QUERY_STRING_NUMBER'); 
```

这似乎不起作用，因为值没有改变。

我这里有什么问题吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T16:18:13.133

您需要选择`option`元素而不是`select`元素：

```
(function($) {
    $('#practice_id').change(function() {
        var val = $(this).val();
        alert(val);
        $('option[value=' + val + ']', this).val('changed');
    });
})(jQuery); 
```

[http://jsfiddle.net/PeeHaa/6yre7/](http://jsfiddle.net/PeeHaa/6yre7/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T16:14:17.973

`$('#practice_id').val('QUERY_STRING_NUMBER');`

这是设置下拉菜单的值，而不是“更改”下划线选项值。

`$(document).ready(function() { $("#practice_id").children().val("-99"); });`

这会将所有选项标签上的值更改为 -99。

[http://jsfiddle.net/MejLX/1/](http://jsfiddle.net/MejLX/1/)

**注意：**是的，您可以通过 jQuery 执行此操作。但是，根据大多数日常常见场景，我认为您的服务器端脚本/页面将生成正确的值。

# php - joomla Jfactory 不在 joomla webapp ( joomla 2.5 ) 中实例化 selft

> ID：10032143
> 
> 赞同：1
> 
> 时间：2012-04-05T16:11:45.110
> 
> 标签：php, joomla, virtuemart

我正在尝试构建一个外部 webApp 来在 Joomla 中上传一些产品！与美德玛特。
一切都按预期工作，但我仍然对`Jfactory::getApplication`.

我已按照本教程进行操作：

[http://docs.joomla.org/How_to_create_a_stand-alone_application_using_the_Joomla!_Platform](http://docs.joomla.org/How_to_create_a_stand-alone_application_using_the_Joomla!_Platform)

但是当我调用`VmModel`on`__construct`方法时，它会调用 a `parent::__construct($config)`：

```
$this->_cidName = $cidName;
// Get the pagination request variables
$mainframe = JFactory::getApplication() ;
$limit = $mainframe->getUserStateFromRequest('global.list.limit', 'limit', $mainframe->getCfg('list_limit'), 'int'); 
```

这会引发以下错误：

> vCall 到未定义的方法 JException::getUserStateFromRequest()

如果可以帮助还有：

> vNotice：尝试在第 201 行的 /home/giuseppe/homeProj/ModaNuovo/libraries/joomla/application/application.php 中获取非对象的属性

提出：

```
public static function getInstance($client, $config = array(), $prefix = 'J')
{
    if (empty(self::$instances[$client]))
    {
        // Load the router object.
        $info = JApplicationHelper::getClientInfo($client, true);

        $path = $info->path . '/includes/application.php';
        if (file_exists($path)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T07:20:00.910

解决方案是将主应用程序与您的应用程序一起实例化，如果需要，还可以通过以下方式登录：

```
$app = JFactory::getApplication('administrator');

// create a form token
$user = JFactory::getUser(42);
$session = JFactory::getSession();
$hash = JApplication::getHash($user->get('id', 0) . $session->getToken(true)); 
```

如果需要，您还必须执行登录以验证此哈希。

# c++ - DirectShow 和 openCV。读取视频文件并处理

> ID：10032145
> 
> 赞同：1
> 
> 时间：2012-04-05T16:11:46.907
> 
> 标签：c++, opencv, directshow

我在 StackOverflow 上使用了搜索，但没有找到答案。我正在开发一个应用程序并使用 OpenCV，但我需要处理不同的视频（主要是 *.avi），所以我决定使用 DirectShow。我能够创建简单的应用程序，但我找不到任何解释如何从 *.avi 获取帧，而无需创建 ActiveWindow。事实上，我只需要使用 DirectShow 读取视频，然后我将使用 OpenCV 处理和显示视频。任何帮助表示赞赏。提前致谢！

请原谅我糟糕的英语。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:40:01.777

创建一个带有 NULL 渲染的图形。另请查看 directshow SDK 中的示例抓取器示例。它显示了如何为图形抓取框架。然后，您可以将帧传递给 openCV 进行处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:18:27.727

基本上你想连接这样的东西：

```
Source -> Sample Grabber -> Null renderer 
```

下载 graphEdit 或 GraphEdit+，您可以直观地表示这些过滤器。作为示例，我继续构建了一个从本地网络摄像头到连接到空渲染器的示例抓取器的图表。GraphEdit+ 生成的 C# 代码是这样的：

```
//Don't forget to add reference to DirectShowLib in your project.
using System;
using System.Collections.Generic;
using System.Runtime.InteropServices.ComTypes;
using System.Runtime.InteropServices;
using DirectShowLib;

namespace graphcode
{
class Program
{
    static void checkHR(int hr, string msg)
    {
        if (hr < 0)
        {
            Console.WriteLine(msg);
            DsError.ThrowExceptionForHR(hr);
        }
    }

    static void BuildGraph(IGraphBuilder pGraph)
    {
        int hr = 0;

        //graph builder
        ICaptureGraphBuilder2 pBuilder = (ICaptureGraphBuilder2)new CaptureGraphBuilder2();
        hr = pBuilder.SetFiltergraph(pGraph);
        checkHR(hr, "Can't SetFiltergraph");

        Guid CLSID_SampleGrabber = new Guid("{C1F400A0-3F08-11D3-9F0B-006008039E37}"); //qedit.dll
        Guid CLSID_NullRenderer = new Guid("{C1F400A4-3F08-11D3-9F0B-006008039E37}"); //qedit.dll

        //add Integrated Camera
        IBaseFilter pIntegratedCamera = CreateFilter(@"@device:pnp:\\?\usb#vid_04f2&pid_b221&mi_00#7&34997cec&0&0000#{65e8773d-8f56-11d0-a3b9-00a0c9223196}\global");
        hr = pGraph.AddFilter(pIntegratedCamera, "Integrated Camera");
        checkHR(hr, "Can't add Integrated Camera to graph");

        //add SampleGrabber
        IBaseFilter pSampleGrabber = (IBaseFilter)Activator.CreateInstance(Type.GetTypeFromCLSID(CLSID_SampleGrabber));
        hr = pGraph.AddFilter(pSampleGrabber, "SampleGrabber");
        checkHR(hr, "Can't add SampleGrabber to graph");

        //add Null Renderer
        IBaseFilter pNullRenderer = (IBaseFilter)Activator.CreateInstance(Type.GetTypeFromCLSID(CLSID_NullRenderer));
        hr = pGraph.AddFilter(pNullRenderer, "Null Renderer");
        checkHR(hr, "Can't add Null Renderer to graph");

        //connect Integrated Camera and SampleGrabber
        hr = pGraph.ConnectDirect(GetPin(pIntegratedCamera, "Capture"), GetPin(pSampleGrabber, "Input"), null);
        checkHR(hr, "Can't connect Integrated Camera and SampleGrabber");

        //connect SampleGrabber and Null Renderer
        hr = pGraph.ConnectDirect(GetPin(pSampleGrabber, "Output"), GetPin(pNullRenderer, "In"), null);
        checkHR(hr, "Can't connect SampleGrabber and Null Renderer");

    }

    static void Main(string[] args)
    {
        try
        {
            IGraphBuilder graph = (IGraphBuilder)new FilterGraph();
            Console.WriteLine("Building graph...");
            BuildGraph(graph);
            Console.WriteLine("Running...");
            IMediaControl mediaControl = (IMediaControl)graph;
            IMediaEvent mediaEvent = (IMediaEvent)graph;
            int hr = mediaControl.Run();
            checkHR(hr, "Can't run the graph");
            bool stop = false;
            int n = 0;
            while (!stop)
            {
                System.Threading.Thread.Sleep(500);
                Console.Write(".");
                EventCode ev;
                IntPtr p1, p2;
                if (mediaEvent.GetEvent(out ev, out p1, out p2, 0) == 0)
                {
                    if (ev == EventCode.Complete || ev == EventCode.UserAbort)
                    {
                        Console.WriteLine("Done!");
                        stop = true;
                    }
                    else
                    if (ev == EventCode.ErrorAbort)
                    {
                        Console.WriteLine("An error occured: HRESULT={0:X}", p1);
                        mediaControl.Stop();
                        stop = true;
                    }
                    mediaEvent.FreeEventParams(ev, p1, p2);
                }
                // stop after 10 seconds
                n++;
                if (n > 20)
                {
                    Console.WriteLine("stopping..");
                    mediaControl.Stop();
                    stop = true;
                }
            }
        }
        catch (COMException ex)
        {
            Console.WriteLine("COM error: " + ex.ToString());
        }
        catch (Exception ex)
        {
            Console.WriteLine("Error: " + ex.ToString());
        }
    }

    public static IBaseFilter CreateFilter(string displayName)
    {
        int hr = 0;
        IBaseFilter filter = null;
        IBindCtx bindCtx = null;
        IMoniker moniker = null;

        try
        {
            hr = CreateBindCtx(0, out bindCtx);
            Marshal.ThrowExceptionForHR(hr);

            int eaten;
            hr = MkParseDisplayName(bindCtx, displayName, out eaten, out moniker);
            Marshal.ThrowExceptionForHR(hr);

            Guid guid = typeof(IBaseFilter).GUID;
            object obj;
            moniker.BindToObject(bindCtx, null, ref guid, out obj);
            filter = (IBaseFilter)obj;
        }
        finally
        {
            if (bindCtx != null) Marshal.ReleaseComObject(bindCtx);
            if (moniker != null) Marshal.ReleaseComObject(moniker);
        }

        return filter;
    }

    [DllImport("ole32.dll")]
    public static extern int CreateBindCtx(int reserved, out IBindCtx ppbc);

    [DllImport("ole32.dll")]
    public static extern int MkParseDisplayName(IBindCtx pcb, [MarshalAs(UnmanagedType.LPWStr)] string szUserName, out int pchEaten, out IMoniker ppmk);

    static IPin GetPin(IBaseFilter filter, string pinname)
    {
        IEnumPins epins;
        int hr = filter.EnumPins(out epins);
        checkHR(hr, "Can't enumerate pins");
        IntPtr fetched = Marshal.AllocCoTaskMem(4);
        IPin[] pins = new IPin[1];
        while (epins.Next(1, pins, fetched) == 0)
        {
            PinInfo pinfo;
            pins[0].QueryPinInfo(out pinfo);
            bool found = (pinfo.name == pinname);
            DsUtils.FreePinInfo(pinfo);
            if (found)
                return pins[0];
        }
        checkHR(-1, "Pin not found");
        return null;
    }

} 
```

}

您仍然需要实际捕获示例帧，但正如上面帖子中提到的，您可以查看 MSDN 上的 sampleGrabber SDK 以了解如何执行此操作。

# objective-c - performSelector:withObject:afterDelay 在 vi ewDidLoad 方法中不起作用

> ID：10032155
> 
> 赞同：0
> 
> 时间：2012-04-05T16:12:22.000
> 
> 标签：objective-c, ios, xcode, ios5, viewdidload

我有一个标签栏应用程序，问题是我需要在第一个视图的 viewDidLoad 延迟后调用一个方法，但它不起作用（没有调用该方法）我添加了以下示例

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [self performSelector:@selector(foo) withObject:nil afterDelay:1];

}

-(void)foo
{
    NSLog(@"foo!");
} 
```

奇怪的是，这适用于所有其他选项卡视图，但由于某种原因，它不适用于第一个选项卡（UITableViewController）任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-09T11:27:57.850

尝试这个....

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    dispatch_async(dispatch_get_main_queue(), ^{
            [self performSelector:@selector(foo) withObject:nil afterDelay:0.5];
        });

} 
```

# php - 奇怪的情况 mod_rewrite 和 PHP

> ID：10032156
> 
> 赞同：1
> 
> 时间：2012-04-05T16:12:22.030
> 
> 标签：php, apache, mod-rewrite

我不明白的东西...

我有我写的 CMS，并且有一些关于“mod_rewrite”隐藏错误的奇怪问题。在 apache2 error.log "mod_rewrite" 中给出：

```
File does not exist: /home/path/to/request, referer: http://IP/request?view=1 
```

我的`$_GET`/`$_POST`请求都是空的

`$_SERVER['REQUEST_URI']`没问题（返回`request?view=1`）

`$_SERVER['QUERY_STRING']`也是空的

我还安装 Drupal CMS 来测试它在 Web 服务器上是否有问题，但 Drupal 工作得很好……然后我将 drupal“.htaccess”文件复制到我的 CMS 以修复 mod_rewrite 首选项。（Drupal 不会像我一样创建 apache 错误）不走运，我又遇到了同样的问题。

还尝试了 Drupal CMS 中 .htaccess 中的所有选项

我尝试打开`RewriteLog`（几次尝试）但没有结果，没有创建一个日志文件。

我是否缺少某些东西或者...只是我的 cms 很糟糕，还有一件事，我的CMS在其他具有完全相同文件的网络服务器上**工作得很好.... ?????**

```
RewriteEngine On
Options -Indexes
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d 
RewriteCond %{REQUEST_URI} !=/favicon.ico 

#tested RewriteRule ^ index.php [L] 
#tested RewriteRule ^ index.php [L,QSA] 
#tested Options FollowSymLinks 
#tested Options -MultiViews 
#tested RewriteBase / 
```

PS对不起我的英语不好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:26:07.420

不确定这是否是您的整个 .htaccess 但您需要启用重写，这是我使用的重写，它从未失败：

```
RewriteEngine On
Options -Indexes

RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?route=$1 [L,QSA] 
```

将`RewriteRule`所有内容传递`(.*)`给 index.php 中的路由参数，然后我的路由器类处理控制器等，QSA 标志还将允许我将额外的 GET/POST 值传递给脚本的任何部分。

希望能帮助到你

ps 我不添加，`RewriteCond %{REQUEST_FILENAME} !-d`因为我不允许文件夹视图并且我不提供文件夹中的内容，所有内容都通过控制器 inc（图像，css，js），所以在大多数情况下不需要这个。它还保护核心和模板等文件夹；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T10:05:30.443

终于我找到了我的问题的解决方案！答案非常非常非常简单……

在 apache2 配置中（在 Ubuntu 上）我发现 `<Directory`标签默认是重复的……我只是删除所有目录标签并创建一个基本标签。

重新加载 apache2 配置，一切都开始正常工作

# c++ - 向量迭代器不可解引用（向量内的向量）

> ID：10032161
> 
> 赞同：0
> 
> 时间：2012-04-05T16:12:45.190
> 
> 标签：c++, vector, struct, dereference, ofstream

我正在尝试将这些向量中的一些数据写入文本文件。当我运行代码时，它会返回运行时错误。`Category`, `Product`, `Cart`,`Customer`和`Address`都`struct`具有每个`get_member`返回的成员。

```
ofstream write_cats;
    write_cats.open("catprd.dat", ios::out, ios::trunc);
    vector<Category>::iterator i;
    write_cats << cats.size() << endl;
    for (i = cats.begin(); i < cats.end(); i++) {
        write_cats << i -> get_catid() << '\t';
        }
    vector<Product>::iterator j;
    write_cats << prods.size() << endl;
    for (j = prods.begin(); j < prods.end(); j++) {
        write_cats << j -> get_prodid() << '\t';
        write_cats << j -> get_prodprice() << endl;
        }
    write_cats.close();

    ofstream write_carts;
    write_carts.open("carts.dat", ios::out, ios::trunc);
    vector<Cart>::iterator k;
    write_carts << carts.size() << endl;
    for (k = carts.begin(); k < carts.end(); k++) {
        write_carts << k -> get_cartid() << '\t';
        write_carts << k -> get_day() << endl;
        }
    vector<Cart_item>::iterator l;
    write_carts << cart_items.size() << endl;
    for (l = cart_items.begin(); l < cart_items.end(); l++) {
        write_carts << l -> get_cartitemid() << '\t';
        write_carts << l -> get_qty() << endl;
        }
    write_carts.close();

    ofstream write_custs;
    write_custs.open("custs.dat", ios::out, ios::trunc);
    vector<Customer>::iterator m;
    vector<Address>::iterator n;
    write_custs << custs.size() << endl;
    for (m = custs.begin(); m < custs.end(); m++) {
        write_custs << m -> get_cust_id() << '\t';
        write_custs << n -> get_zip_code() << endl;
        }
    write_custs.close(); 
```

返回运行时错误“Vector iterator not dereferencable”

这是`struct Address`看起来的样子：

```
using namespace std;
#pragma once
#include <string>

struct Address {

public:

int get_st_number() const{return st_number;} 
int get_zip_code() const{return zip_code;} 
string get_st_name() const{return st_name;} 

Address(){}                                 
Address (int num, string name, int zip) 
    : st_number(num), st_name(name), zip_code(zip) {}

private:
int st_number;
int zip_code;
string st_name;

}; 
```

和`struct Customer`：

```
struct Customer {
public:

Address get_address() const{return addr;} 
int get_cust_id() const{return cust_id;}  customer id
string get_name() const{return cust_name;} 
Customer (int id, string n, Address a)  
    : cust_id(id), cust_name(n), addr(a) {}

string display_addr() const {
    std::cout<<setw(15)<<cust_name<<" ";
    std::cout<<setw(15)<<cust_id<<" ";

    return string();
}

private:

int cust_id;
string cust_name;
Address addr;           
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:15:41.840

你忘记初始化`vector<Address>::iterator n;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:44:38.583

您正在声明一个迭代器`n`，但没有将其初始化为可取消引用的值。从您的更新来看，您似乎想要打印`Address`与客户相关联的信息；因此您可以通过 引用的客户访问`m`，而不是单独的迭代器：

```
write_custs << m -> get_cust_id() << '\t';
write_custs << m -> get_address().get_zip_code() << endl; 
```

此外，将每个迭代器的范围限定在其循环内可能是一个好主意。这比每次在外部范围内声明一个新的更不容易出错：

```
for (vector<Whatever>::const_iterator i = stuff.begin(); i != stuff.end(); ++i) {
    // do stuff with "i"
}
// "i" is no longer available - no danger of accidentally using it again. 
```

还有其他几点：

*   您应该使用`!=`而不是`<`与`end()`迭代器进行比较；`<`不适用于某些类型的迭代器；
*   您应该在文件中写一个换行符，`'\n'`而不是`endl`; `endl`刷新文件缓冲区，强制在该点将文件写入磁盘，这可能非常慢。

# c# - 如果方法参数也是“out”参数，如何使用反射检查方法参数是否为 Nullable<>？

> ID：10032162
> 
> 赞同：2
> 
> 时间：2012-04-05T16:12:53.770
> 
> 标签：c#, reflection, parameters, nullable, out

使用方法签名，例如：

```
public interface TestInterface
{
    void SampleMethodOut(out int? nullableInt);
    void SampleMethod(int? nullableInt);
} 
```

我`typeof(TestInterface).GetMethods()[1].GetParameters()[0].ParameterType`用来获取类型，然后检查`IsGenericType`and `Nullable.GetUnderlyingType`。如何使用带有 out 参数的方法执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:15:04.723

呵呵，忽略我之前的回答。

您使用`Type.IsByRef`, 并调用，`Type.GetElementType()`如果是这样：

```
var type = method.GetParameters()[0].ParameterType;
if (type.IsByRef)
{
    // Remove the ref/out-ness
    type = type.GetElementType();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-14T03:05:43.540

对于刚刚找到此页面的每个人

c# 文档页面显示了一种简洁的方式来做到这一点
[https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/nullable-value-types#how-to-identify-a -可空值类型](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/nullable-value-types#how-to-identify-a-nullable-value-type)

```
Console.WriteLine($"int? is {(IsNullable(typeof(int?)) ? "nullable" : "non nullable")} type");
Console.WriteLine($"int is {(IsNullable(typeof(int)) ? "nullable" : "non-nullable")} type");

bool IsNullable(Type type) => Nullable.GetUnderlyingType(type) != null;

// Output:
// int? is nullable type
// int is non-nullable type 
```

使用反射，这是您获取参数类型的方式：

```
typeof(MyClass).GetMethod("MyMethod").GetParameters()[0].ParameterType; 
```

# batch-file - 如何在计算机桌面（Windows）上为 URL 链接创建批处理文件？

> ID：10032164
> 
> 赞同：-1
> 
> 时间：2012-04-05T16:13:04.573
> 
> 标签：batch-file

如何在计算机桌面（windows）上为 URL 链接创建批处理文件，无论是什么版本的 windows。

如果您已有文件，请分享此文件

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:27:43.940

启动 iexplore.exe YourURL

启动 firefox.exe YourURL

我知道这不会使用默认浏览器，但是，我不知道你想用它做什么 - 以及在哪个环境中。

在这里找到它： [http ://answers.yahoo.com/question/index?qid=20071107002712AAtMW19](http://answers.yahoo.com/question/index?qid=20071107002712AAtMW19)

# javascript - 使用 JavaScript 构建远程托管应用程序

> ID：10032173
> 
> 赞同：0
> 
> 时间：2012-04-05T16:13:30.050
> 
> 标签：javascript, jquery, frameworks, requirejs

我们正在开发一个 JavaScript 应用程序，它将托管在我们客户的服务器上。我们无权访问客户的服务器，而且更不允许向应用程序发送定期更新。为了提供定期维护，建议位于客户服务器上的应用程序只不过是一个由两行组成的 HTML 文件：doctype 和一个 JavaScript，包括返回到我们服务器的源链接。

从这里开始，单个 JavaScript 包含将构建整个应用程序，并根据需要提取额外的资源。它将从构建核心 HTML（主要基于[HTML Boilerplate](http://html5boilerplate.com/)）开始，包括为元、样式表、HTML 等附加标签。一旦 HTML 页面被刷新，它将拉入学习者正在寻找的内容。

**因评论而更新** 该应用程序需要驻留在客户的服务器上，因为此应用程序与客户服务器上的其他应用程序之间存在大量通信（在父框架中）。如果托管在我们的服务器上，由于浏览器安全性，它将被阻止。有一些选项可以解决这个问题，但是通过将它放在客户的服务器上，它消除了类似应用程序常见问题的故障点。

有没有更好的方法来保留在不通过客户的情况下向应用程序提供更新的能力？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:28:58.777

如果您的应用程序是纯 JavaScript，那么您的解决方案就可以了。如果你对你的应用程序建模得很好，你可以在不通过你的客户的情况下使其可更新。我构建的模型的简单概念证明（在线 JavaScript 桌面的开始）：http: [//ilyeskooli.com/desktop/](http://ilyeskooli.com/desktop/)

如果您检查页面源，它​​只是：

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="JDesktop/css/themes/ui-lightness/jquery-ui.css">
        <link rel="stylesheet" type="text/css" href="JDesktop/css/JDesktop.css">
        <script type="text/javascript" src="js/jquery/jquery.js"></script>
        <script type="text/javascript" src="js/jquery/jquery-ui.js"></script>
        <script type="text/javascript" src="JDesktop/jdesktop.php"></script>        
        <script type="text/javascript" src="index.js"></script>
        <title>jDesktop</title>
    </head>
    <body>

    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:28:21.110

根据这个问题：***是否有更好的方法来保留在不通过客户的情况下向应用程序提供更新的能力？***

您是否不能在您的服务器上创建一个 Web 服务，向客户端（客户端是另一家公司，而不是最终用户）提供 JSON 来构建您需要的任何对象？这样你就可以“随时”更新你的 web 服务，只要你构建的 js 具有足够的可扩展性，你就可以远程将对象规范传递给它

# ruby - 在Ruby中将十六进制视为整数

> ID：10032175
> 
> 赞同：0
> 
> 时间：2012-04-05T16:13:37.457
> 
> 标签：ruby

在 Ruby on Rails 应用程序中，我们有一些存储为整数的详细信息，但在我们尝试转换为字符串时被解释为十六进制。

例如

```
> 0123.to_s
=> 83 
```

有没有办法将值视为整数，即使它是 Ruby 视为十六进制的格式。如果没有，我们只需将数据库字段更改为 varchar！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T16:16:34.583

实际上，这不是十六进制，而是八进制。如果您不想要这种行为，请不要在代码中的整数文字上放置前导零：

```
irb(main):001:0> 0123         # octal literal
#=> 83

irb(main):002:0> 0x123        # hex literal
#=> 291

irb(main):003:0> 123          # base-10 literal
#=> 123

irb(main):004:0> "0123".to_i  # Converting string to int defaults to base 10
#=> 123 
```

如果出现前导零是因为您使用 Ruby 使用 printf 创建对齐的 Ruby 代码，如下所示：

```
irb(main):008:0> "%04i" % 123
#=> "0123" 
```

…然后使用空格而不是零填充：

```
irb(main):009:0> "%4i" % 123
#=> "  123" 
```

# c# - 遍历树时使用线程

> ID：10032189
> 
> 赞同：1
> 
> 时间：2012-04-05T16:14:26.503
> 
> 标签：c#, multithreading, performance, parallel-processing, traversal

我想加快遍历树的过程。下面是一个节点示例：

```
 class Node
    {
        public List<Node> Children { get; set; }
        public int SompeProperty { get; set; }
        public String SomeOtherProperty { get; set; }
    } 
```

我遍历尝试的方式是：

```
 static void TraverseTree(Node ParentNode)
    {
        if (ParentNode.Children == null)
            return;

        foreach (var child in ParentNode.Children)
        {
            TraverseTree(child);               
        }
    } 
```

该`ParentNode.Children`方法大约需要 1 毫秒，因为 Node 代表文件或目录。我只是用这个节点的例子来更好地说明我的观点。

因此，如果您考虑一下，如果第一个节点有 4 个子节点，并且每个子节点都有 10000000 个后代，那么如果我们利用并行编程在单独的线程中遍历这 4 个子节点中的每一个，我们可以提高遍历的速度。如果是这种情况，那么我会采取这种方法。但是，如果我事先不知道树的结构，我该怎么做呢？

**我一直在想：**

1) 开始遍历树将前 10 个具有子节点的节点放在堆栈上，然后在单独的线程上开始遍历每个节点。

2）做类似的事情：

```
 static void TraverseTree(Node ParentNode)
    {
        if (ParentNode.Children == null)
            return;

        foreach (var child in ParentNode.Children)
        {
            ThreadPool.QueueUserWorkItem(new WaitCallback((x) =>
            {                    
                TraverseTree(child);   
            }), null);                            
        }
    } 
```

这通常会给我带来奇怪的结果，但速度要快得多。

* * *

## 结果

使用任务将算法的速度提高了大约 40%，结果如下：

使用以下算法扫描我的整个 C:\ 驱动器大约需要**5.81秒：**

```
 //directoryPath  = "C:\"
    var now = DateTime.Now;

        Task<List<ScanItem>> t1 = new Task<List<ScanItem>>(() =>
        {
            return GetAllFilesInDirectory(directoryPath);
        });

        t1.Start();

        t1.Wait();

        var done = DateTime.Now-now;  // done = 5.81 average 
```

使用以下算法扫描我的整个 C:\ 驱动器大约需要**3.01秒：**

```
 //directoryPath  = "C:\"  
        var now = DateTime.Now;

        // get all directories in my c: drive it should only contain directories
        var directories = Directory.GetDirectories(directoryPath);

        // directories = 17 directories:  inetpub, MSOCache, PrefLogs, ProgramFiles, ProgramFiles (x86) etc...

        Task<List<ScanItem>>[] myTasks = new Task<List<ScanItem>>[directories.Length];

        // create a task fore each directory in the c:\ drive
        for (int k = 0; k < myTasks.Length; k++)
        {
            var currentDir = directories[k];
            myTasks[k] = new Task<List<ScanItem>>(() =>
            {
                return GetAllFilesInDirectory(currentDir);
            });                
        }

        // start all the tasks
        for (int k = 0; k < myTasks.Length; k++)
            myTasks[k].Start();

        Task.WaitAll(myTasks); // wait for all tasks to finish

        var done = now - DateTime.Now;  // average about 3.01 seconds 
```

如果我在哪里遍历列表，第一个算法返回 318,222 个文件和目录（这是正确的数字）。第二个算法返回 318,195 非常接近我不明白为什么...

我正在一台有 8 个内核的计算机上对此进行测试。也许如果我在有 2 个内核的计算机上使用一个任务运行它可能比创建所有这 17 个任务更快。

如果您想知道我使用什么算法来快速获取文件，请查看[https://stackoverflow.com/a/724184/637142](https://stackoverflow.com/a/724184/637142)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-05T16:38:08.457

使用**任务并行库**，而不是滚动您自己的并行代码。它非常适合解决此类问题。

TPL 的工作方式不是您将线程分配给问题，您只需将问题分解为“任务”，然后让 TPL 负责找出如何在可用工作人员池中并行化工作。只需为树的每个子分支创建一个任务；*这些任务又可以为它们的*子分支产生自己的任务。TPL 将从池中分配线程，直到处理器饱和。

因此，让 TPL 知道您的任务将在 CPU 或 I/O 上进行门控非常重要：

*   如果任务受 CPU 限制，则 TPL 将为每个 CPU 分配一个池线程，并让其他任务等待直到有可用内核；最大化吞吐量并使所有处理器饱和。这正是你想要的：如果你买了一台有四个处理器的机器，其中两个是空闲的，那么你为两个不使用的内核付费。

*   如果*单个*任务是 I/O 绑定的，那么您可以`LongRunning`在创建任务时使用该选项向 TPL 指示该任务不应消耗整个内核；其他任务应该在这个核心上轮流完成。

*   如果看起来确实如此，您有*许多*I/O 绑定任务，那么您应该考虑使用*TaskCompletionSource*，因为这样可以更有效地使用“继续”回调。还可以考虑使用 C# 5 的新`async/await`特性来安排延续；它提供了一种更愉快的方式来编写异步代码。

当然，不要忘记，如果问题实际上是机器的 I/O 能力饱和，那么再多的*处理器*并行性也不会产生影响。如果您正在为游泳池注水，向同一个水龙头添加更多软管不会增加通过该水龙头的流量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T16:19:46.730

如果要并行遍历树，则必须：

*   对树进行分区，以保证单独的线程在树的不同部分工作（例如，从根开始，您可以将后代节点分配给新线程，直到达到最大程度的并行性。
*   确保您的树结构通常可以被多个线程安全地遍历（即遍历不会导致树实现中的状态更改副作用）。
*   确保在遍历期间没有线程更新树。

如果您得到“奇怪的结果”，则上述其中一项可能不正确。请记住，在多线程示例中，遍历节点的*顺序是不确定的。*您在宣布结果“奇怪”时是否考虑了这一点？

即使是这样：

*   在目录示例中，您很可能最终会遇到 IO 争用限制了多线程方法的有效性
*   遍历内存中的节点往往会将事物踢出缓存，从而降低使用多线程的投资回报（[错误共享](http://drdobbs.com/go-parallel/article/217500206?pgno=1)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T16:29:12.427

请记住，仅当您的应用程序在单核上占用 100% 的 CPU 时间时，多线程才有用；如果 CPU 使用率很低（因为它在硬盘驱动器或网络之后等待），您将看不到并行运行代码的任何好处。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-07-24T19:33:09.017

最近我不得不创建一个算法，它能够发现一个巨大的树结构（实际上是文件系统，但它可以是任何东西）并对每个项目执行**异步操作**。我想出了一个能够做到这一点的小型库（使用 .Net TPL 和并发队列构建）：

*   并行发现一棵大树
*   父项总是在子项之前处理
*   资源使用取决于给定的最大并行度，而不是树大小
*   异步工作

[并行异步 TreeWalker](https://github.com/tusmester/ParallelTreeWalker)

# javascript - Ajax 绑定选择（组合框）错误（或列表为空，具体取决于浏览器）

> ID：10032195
> 
> 赞同：1
> 
> 时间：2012-04-05T16:14:42.803
> 
> 标签：javascript, asp.net, ajax, json, data-binding

我接手了一个项目（ASP.Net AJAX，JSON），我有一个页面加载一个包含 1,430 个条目的大型选择（组合框）列表，并且在我们的主（登陆）搜索页面上加载没有问题。

**问题：**加载我们编辑或插入的页面时，我在*MicrosoftAjaxTemplates.debug.js* 中收到以下错误。搜索页面和编辑页面的区别在于涉及到 ajax 数据绑定。

`Microsoft JScript runtime error:` 并且没有其他信息。

上`function Sys$UI$Template$compile()`线：

`element._msajaxtemplate = [this.*instantiateIn = new Function("*_containerElement", "$dataItem", "$index", "_*referenceNode", "$parentContext", "*_instanceId", code), nestedTemplates];`

这是元素内部 html 的一部分（删除了大多数选项；但是，有 1,430 个选项）：

`select style="width: 500px;" id="ddl_1_CompanyID_53f3ff5f-3070-4473-b8d9-e4055e29e0e9" önchange="UpdateObserver('CompanyID', this.value);" class="queryfield" title="Company" fieldbinding="CompanyID" LoadOnDemand="false" sys:value="{{CompanyID}}" width="500px" showcode="False" descfield="CompanyDescription" codefield="CompanyID" queryid="1" lookupid="1" sys:attach="dataview"> option value="0">(None) /option> /select> ... 1,429 options...`

如果我将整个 HTML 粘贴到*jsfiddle.net*中，则选择列表（组合框）会呈现列出的所有选项（无错误）。

我认为用于构建选择列表的数据是罪魁祸首，所以我采用了二进制排序方法，删除了一半的数据并且错误消失了。我测试了另一半，没有错误；但是，对于所有 1,430 个选项，我得到了错误。

**尝试的解决方法** 下一个方法是在选择列表（组合框）的焦点上加载数据。在主页上，没问题...控件具有列表填充的焦点。在 PrettyPhoto 页面上没有错误；但是，列表是空的。使用*Fiddler2*，我看到 JSON 数据被传回，我可以在 javascript 中发生绑定的地方设置一个断点；但是，选择列表（组合框）为空。

我遇到了[PrettyPhoto](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/ "漂亮的照片")的其他问题，并阅读了以下内容，帮助我解决了日期选择器问题：“'prettyPhoto' 每次触发时都会创建一个新的 DOM，因此 datepicker 绑定到的 'focus' 事件不存在在您的灯箱中的 DOM 元素上“来源

我觉得同样的问题与未加载的选择列表有关。只是不知道如何解决这个问题。

**调试** 删除了漂亮照片的使用，问题仍然存在（这个问题似乎是绑定和数据量）。在 IE 9（或 8）中，我得到了原始问题。在 FireFox 和 Chrome 中……一切都很好。

一段时间以来，我一直在努力解决这个问题，任何能引导我走向正确方向的建议或提示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-02T22:28:09.947

最终的解决方案是不将所有数据预加载到下拉列表中；但是，按需加载数据。如果用户按下“A”键，所有以“A”开头的数据都会加载列表并且没有错误。

# google-chrome-extension - 每天在特定时间显示 Chrome 桌面通知

> ID：10032196
> 
> 赞同：0
> 
> 时间：2012-04-05T16:14:43.880
> 
> 标签：google-chrome-extension

我想编写一个扩展程序，每天在指定时间显示桌面通知。快速浏览一下 Chrome API，似乎唯一的方法是：

*   为我的扩展创建一个背景页面，
*   使用分辨率足够低的 setInterval() 不会对 CPU 造成负担（即使 5 分钟也可以），
*   当间隔触发时，检查当前时间是否在所需时间之后，
*   确保今天尚未向用户显示通知。

（最后一步的细节与我的问题无关，只是为了表明我意识到我需要防止通知“颤动”）。

不过，这似乎相当间接且可能很昂贵；有没有办法解决？需要背景页面吗？

我想我可以只调用 setTimeout() 并且只触发一次事件（通过计算现在和所需时间之间的时间），然后在显示通知后再次调用它。出于某种原因，这听起来更“脆弱”，虽然我不知道为什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T22:52:46.077

我认为您会希望背景页面能够顺利完成此操作。您不能使用内容脚本，因为您需要保留“状态”/计时器。

因此，当后台页面首次加载（浏览器启动）时，您可以计算出当前时间和下一个通知时间的偏移量，并将 setInterval 设置为该确切时间间隔。这样你就不需要每五分钟轮询一次和/或如果你已经显示了消息就计算出来。您只需在所需的确切时间显示它。这必须比投票更有效、更有效和更清洁。在收到通知时，您只需再次重置间隔。

这里的一些示例函数：

[setTimeout 但在给定时间](https://stackoverflow.com/questions/780995/settimeout-but-for-a-given-time)

通过阅读上面的帖子并在网上进行快速搜索，您似乎可以在一天一次的时间间隔内调用 setInterval 没有问题。卡尔文建议 25 天！

我就是这样处理它的。

编辑：由于发布了一件事，如果 PC 休眠 n 小时会发生什么？我需要自己测试一个类似的项目，所以一旦我有机会测试它，我会更新。

# jquery - jquery scroll 停止在 IE8 上 90% 的滚动区域（仅）滚动

> ID：10032199
> 
> 赞同：1
> 
> 时间：2012-04-05T16:15:02.927
> 
> 标签：jquery, internet-explorer-8, scroll

我正在使用[http://www.dyn-web.com/code/scroll/demos.php?demo=vt](http://www.dyn-web.com/code/scroll/demos.php?demo=vt)，因为我有一个不可滚动的页面，中间有一个可滚动的矩形。我不需要滚动条，只需要鼠标滚轮，这就是为什么我有溢出：隐藏 - 页面中的示例 html：

```
 <style type="text/css">
/* NOTE: width and height for div#wn also specified in scroll_v.css */
div#wn  { 
    position:relative; 
    width:250px; height:170px;
    overflow:hidden; /* for non-javascript */
    }
/* NOTE: styles for code are in external css file named scroll_v.css.
Script segment below writes link tag. */
</style>
<script src="js/dw_scroll_c.js" type="text/javascript"></script>
<script type="text/javascript">

function init_dw_Scroll() {
    // arguments: id of scroll area div, id of content div
    var wndo = new dw_scrollObj('wn', 'lyr1');

}

// if code supported, link in the style sheet (optional) and call the init function onload
if ( dw_scrollObj.isSupported() ) {
    dw_Util.writeStyleSheet('css/scroll_v.css');
    dw_Event.add( window, 'load', init_dw_Scroll);
}

</script>
</head>
<body>

<h1>Vertical Mouseover Scrolling</h1>

<div id="wn"> <!-- scroll area div -->
    <div id="lyr1"> <!-- layer in scroll area (content div) -->
        <p>This example demonstrates vertical scrolling using mouseover links. Speed doubles on mousedown.</p>
        <p>Scroll links could also be setup for mousedown scrolling if you prefer.</p>

        <p>Content repeated for your scrolling pleasure :)</p>

        <p>This example demonstrates vertical scrolling using mouseover links. Speed doubles on mousedown.</p>
        <p>Scroll links could also be setup for mousedown scrolling if you prefer.</p>

    </div> <!-- end content div (lyr1) -->
</div>  <!-- end wn div --> 
```

（我不会给出所有的js文件，因为它很大并且在代码之前的链接上，如果有人想直接看这个dw_scroll_c.js文件，我可以链接它，但是阅读起来很不友好，因为他们删除了所有代码中的空格。）

所以这个滚动效果很好，但只有当我在 lyr1 中的内容不是那么长时——也许 2000 像素它可以正常工作，但如果我有大量的文字和图片——它会在中间的某个地方停止滚动。对于测试 - 当我在此停止边界之前删除 200 像素时，如果我们正在查看文本，它将停止滚动 200 像素（因此此停止边界不依赖于数据）。

**编辑** 我将我的内容分成两个可滚动区域。现在我不能滚动到最后。我可以滚动其中的 90%。当我有一个可滚动区域时，我可以将它滚动到 90%，这很难计算，但现在我可以看到了。

事情只发生在 IE-8、ff 11、Chrome 和 IE-9 上，所有页面都是可滚动的。我需要在 js 文件中查找和更改什么以使我的页面在 IE-8 中全部可滚动？

# javascript - 如何获取javascript“数组”的长度

> ID：10032205
> 
> 赞同：2
> 
> 时间：2012-04-05T16:15:17.920
> 
> 标签：javascript, arrays, hash, count

我们最近一直在使用 javascript“哈希”，我们一直在寻找一种通用的方法来计算数组和哈希中包含的项目，而无需“知道”我们正在处理的项目，除了 count 方法。众所周知，.length 是无用的，因为它只返回数组中最高索引的值。我们下面的内容不起作用，因为哈希对 Array 测试为真，但返回的长度值对于哈希来说是废话。我们最初将整个项目中的 .length 替换为 Object.keys().length，但 IE8 及更低版本不支持此功能。

这是一个如此愚蠢的简单事情，我们似乎无法让它工作。帮帮我，欧比万。你是我唯一的希望！

```
function isNullOrUndefined(aObject) {
    "use strict";
    return (typeof aObject === 'undefined' || aObject === null);
}

function count(aList) {
    "use strict";
    var lKey = null,
        lResult = 0;
    if (!isNullOrUndefined(aList)) {
        if (aList.constructor == Array) {
            lResult = aList.length;
        } else if (!isNullOrUndefined(Object.keys)) {
            lResult = Object.keys(aList).length;
        } else {
            for (lKey in aList) {
                if (aList.hasOwnProperty(lKey)) {
                    lResult++;
                }
            }
        }
    }
    return lResult;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:17:25.600

`Object.keys`polyfill 从[ES5-shim逐字复制](https://github.com/kriskowal/es5-shim)

```
// ES5 15.2.3.14
// http://es5.github.com/#x15.2.3.14
if (!Object.keys) {
    // http://whattheheadsaid.com/2010/10/a-safer-object-keys-compatibility-implementation
    var hasDontEnumBug = true,
        dontEnums = [
            "toString",
            "toLocaleString",
            "valueOf",
            "hasOwnProperty",
            "isPrototypeOf",
            "propertyIsEnumerable",
            "constructor"
        ],
        dontEnumsLength = dontEnums.length;

    for (var key in {"toString": null}) {
        hasDontEnumBug = false;
    }

    Object.keys = function keys(object) {

        if ((typeof object != "object" && typeof object != "function") || object === null) {
            throw new TypeError("Object.keys called on a non-object");
        }

        var keys = [];
        for (var name in object) {
            if (owns(object, name)) {
                keys.push(name);
            }
        }

        if (hasDontEnumBug) {
            for (var i = 0, ii = dontEnumsLength; i < ii; i++) {
                var dontEnum = dontEnums[i];
                if (owns(object, dontEnum)) {
                    keys.push(dontEnum);
                }
            }
        }
        return keys;
    };

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:27:43.823

鄙视Raynos的完全有效的答案，请考虑性能

这就是我的哈希对象的样子

```
function Hash(){
   this.values = [];
   this.keys = {};
}
Hash.prototype.set = function(key, val){ 
   if(this.keys[key]){
      this.values[this.keys[key]] = value
   }else{
      this.keys[key] = (this.values.push(val)-1)
   }
}
Hash.prototype.length = function(){
    return this.values.length
} 
```

为什么我这样做是简单的性能循环通过一个对象来计算属性长度将非常低效，上面的解决方案始终让您直接访问。

# theory - 图灵可判定和协同图灵可判定之间的区别

> ID：10032206
> 
> 赞同：19
> 
> 时间：2012-04-05T16:15:20.140
> 
> 标签：theory, turing-machines, computation-theory

我真的很难理解这两者之间的区别。从我的教科书中，它基本上通过说来描述差异

> 如果一种语言是图灵可识别语言的补充，则它是共同图灵可识别的。

我想我不明白这个定义的一部分是：当它是图灵可识别语言的补充时，它意味着什么？

您如何确定它是否是另一种语言的补充？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-05T16:31:57.800

（注意-术语“图灵可判定”和“共同图灵可判定”是同一件事。但是，“图灵可识别”和“图灵可识别”并不相同，这就是我决定的在我的回答中涵盖。这样做的原因是，如果一种语言是可判定的，那么它的补语也必须是可判定的。可识别的语言也是如此。）

直观地说，如果存在某种计算机程序，给定该语言中的字符串，可以确认该字符串确实在该语言中，则该语言是图灵可识别的。如果字符串不在该语言中，该程序可能会无限循环，但如果您给它一个语言中的字符串，则可以保证始终最终接受。

虽然如果一种语言是图灵可识别语言的补充，那么它确实是共同图灵可识别的，但这个定义并不能说明正在发生的事情。直观地说，如果一种语言是 co-Turing 可识别的，这意味着有一个计算机程序，给定一个字符串*不*在语言中，最终将确认该字符串不在该语言中。但是，如果字符串确实在语言中，它可能会无限循环。这样做的原因很简单——如果某个字符串 w 不包含在可共同图灵识别的语言中，则该字符串 w 必须包含在该可共同图灵识别的语言的补语中，（根据定义）必须是图灵可识别的。由于 w 在图灵可识别的补码中，因此必须有一些程序可以确认 w 确实在补码中。因此，该程序可以确认 w 不是原始的协同图灵可识别语言。

简而言之，图灵可识别性意味着有一个程序可以确认字符串 w 是一种语言，而图灵可识别性意味着有一个程序可以确认字符串 w*不是*该语言。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-10T12:53:08.020

让我来解释一下为什么可判定和可共同判定在一些不同的用法上意味着相同。在这里有经验，如果我走错了路，请告诉我：

> 如果我们有一组形成 L 的字符串 S。那么 S' 将形成 L'。现在，L 是可判定的意味着我们有算法 / TM 可以确认任何字符串 s∈S 属于 L 并且 s'∈S' 不属于 L。同样的算法会告诉我们 s∈S 不属于 L' 和 s '∈S' 属于 L'。所以，换句话说，我们对 L' 有完全相同的定义。因此，可判定语言概念的补语没有这种不同的含义。因此，可判定语言和可共同判定语言都被认为是相同的。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-12-11T04:38:12.153

一种语言是可识别的，如果有一个图灵机将停止并仅接受该语言中的字符串，并且对于不在该语言中的字符串，TM 要么拒绝，要么根本不停止。注意：没有要求图灵机应该为非该语言的字符串停止。

一种语言是可判定的，如果有一个图灵机将接受该语言中的字符串并拒绝该语言中的字符串。

# google-maps-api-3 - 如何向叠加层添加翻转状态

> ID：10032207
> 
> 赞同：1
> 
> 时间：2012-04-05T16:15:20.413
> 
> 标签：google-maps-api-3

我在地图上添加了一个叠加层并更改了叠加层的颜色。我想知道是否可以向叠加层添加悬停事件？基本上，当您将鼠标悬停在美国某个州上时，如果它是蓝色的，它将变为绿色。类似的东西。这就是我现在所拥有的。

[http://www.opsdivina.net/soum/](http://www.opsdivina.net/soum/)

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:08:08.433

我认为这会奏效！

```
google.maps.event.addListener(polygon,"mouseover",function(){
this.setOptions({fillColor: "#00FF00"});
tooltip.style.visibility = 'visible';
}); 

google.maps.event.addListener(polygon,"mouseout",function(){
this.setOptions({fillColor: "#FF0000"});
tooltip.style.visibility = 'hidden';
}); 
```

以下链接将有所帮助！ [http://econym.org.uk/gmap/example_mouseover.htm，http://philmap.000space.com/gmap-api/poly-hov.html，http://econym.org.uk/gmap/example_hoverchange75](http://econym.org.uk/gmap/example_mouseover.htm) [。](http://econym.org.uk/gmap/example_hoverchange75.htm) _ [_](http://philmap.000space.com/gmap-api/poly-hov.html) _ [htm](http://econym.org.uk/gmap/example_hoverchange75.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:26:21.610

[http://groups.google.com/group/kml-support-getting-started/browse_thread/thread/66e7a7ab1b269104/d050e85ab54679a1](http://groups.google.com/group/kml-support-getting-started/browse_thread/thread/66e7a7ab1b269104/d050e85ab54679a1)

出于某种原因，下面的引用没有直接格式化并跳过一些 xml，因此您只想转到上面列出的链接以获得确切的解决方案。尝试在此处正确格式化。

> 如果要在鼠标悬停时突出显示多边形，则需要将 StyleMap 添加到具有该多边形几何形状的要素中。
> 
> 这是一个例子：

```
<?xml version="1.0" encoding="utf-8" ?>
<kml xmlns="http://www.opengis.net/kml/2.2"> 
    <Document> 
        <Style id="sn_style"> 
          <PolyStyle> 
            <color>00ff8080</color> 
            <fill>0</fill> 
          </PolyStyle> 
        </Style> 

        <Style id="sh_style"> 
          <PolyStyle> 
            <color>7fff8080</color> 
          </PolyStyle> 
        </Style> 

        <StyleMap id="msn_style"> 
            <Pair> 
                <key>normal</key> 
                <styleUrl>#sn_style</styleUrl> 
            </Pair> 
            <Pair> 
                <key>highlight</key> 
                <styleUrl>#sh_style</styleUrl> 
            </Pair> 
        </StyleMap> 

      <Placemark> 
        <name>Polygon with fade in/out</name> 
        <styleUrl>#msn_style</styleUrl> 
        <Polygon> 
          <outerBoundaryIs> 
            <LinearRing> 
              <coordinates> 
                138.64,-34.93 138.64,-34.94 138.63,-34.94 138.62,-34.94 
                138.62,-34.95 138.62,-34.96 138.61,-34.97 138.60,-34.97 
                138.59,-34.97 138.58,-34.97 138.57,-34.97 138.57,-34.96 
                138.57,-34.95 138.57,-34.94 138.57,-34.93 138.57,-34.92 
                138.57,-34.91 138.56,-34.91 138.56,-34.90 138.57,-34.90 
                138.57,-34.89 138.56,-34.88 138.57,-34.88 138.58,-34.87 
                138.58,-34.86 138.58,-34.85 138.60,-34.85 138.61,-34.85 
                138.63,-34.85 138.64,-34.86 138.64,-34.87 138.63,-34.87 
                138.63,-34.88 138.62,-34.88 138.62,-34.89 138.63,-34.89 
                138.63,-34.90 138.64,-34.90 138.64,-34.91 138.64,-34.92 
    138.64,-34.93 
              </coordinates> 
            </LinearRing> 
          </outerBoundaryIs> 
        </Polygon> 
      </Placemark> 
    </Document> 
    </kml> 
```

> 您还可以将技术与区域相结合，仅在用户视图中多边形“活动”时显示。[http://kml-samples.googlecode.com/svn/trunk/kml/Region/](http://kml-samples.googlecode.com/svn/trunk/kml/Region/)上的示例
> 
> 相关参考： http: [//code.google.com/apis/kml/documentation/kmlreference.html#stylemap](http://code.google.com/apis/kml/documentation/kmlreference.html#stylemap) http://code.google.com/apis/kml/documentation/kmlreference.html#region

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-14T13:29:29.007

KMZ 和 KML 中的悬停状态在 V3 中不起作用。真正实现这一点的唯一方法是直接在脚本中调用多边形。这样做将允许您内联添加侦听器。

# sql - 使 SSDT 只生成一个 SQL 脚本（而不是部署数据库）

> ID：10032213
> 
> 赞同：8
> 
> 时间：2012-04-05T16:15:50.027
> 
> 标签：sql, visual-studio-2010, sql-server-data-tools

最近升级到 SSDT 2012 后，我似乎错过了仅生成 T-SQL 脚本而不是将数据库部署到某处服务器的选项。

更准确地说，SSDT 的前身曾将部署操作设置为“生成脚本”，但我无法在新版本中的任何位置找到该选项。

是否可以？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-25T02:28:31.550

要从 SSDT 中的离线数据项目生成脚本而不是部署到目标数据库，请配置项目设置，如下所示

![SSDT 部署配置对话框](../Images/3e59f1c10ab22d17a111484b2ef8ec91.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-07T16:45:49.497

您可能想查看 SQLPackage 命令行。您可以在此处设置选项以使用“脚本”操作并指定输出文件名以生成脚本而不是发布数据库。您也可以通过批处理文件执行此操作，这样它每次都会生成一个脚本。不过，您仍然需要提供源项目和目标数据库。SQLPackage 的参考可以在这里找到：http: [//msdn.microsoft.com/en-us/library/hh550080%28v=VS.103%29.aspx](http://msdn.microsoft.com/en-us/library/hh550080%28v=VS.103%29.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-05T16:53:31.853

是的，有可能。

如果您从菜单栏中选择*Build > Publish ProjectName...* ，则会弹出一个带有发布选项的对话框窗口 -对话框窗口底部有一个*Generate Script按钮。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-17T18:30:50.103

我还有一个问题，SSDT 项目在项目运行时会尝试部署更改。

在项目属性中，选择“调试”选项卡。将开始操作更改为“无”。这将阻止它在那个时候尝试部署。

# c++ - 文件输入问题 [C++]

> ID：10032224
> 
> 赞同：0
> 
> 时间：2012-04-05T16:16:23.837
> 
> 标签：c++, pointers, file-io, fstream

我第一次尝试从一个文件中读取数据，一个 .txt 文件。下面是我的代码：

```
Level::ReadStream(std::fstream data)
{
bool write = false;
char* p = data.tellg();

while(!data.eof())
{
    int i = 0, j = 0;

    if(&p == '[')
    {
        write == true;
    }

    if(write == true)
    {
        mapX[i] = p;
        mapY[j] = p;
    }

    if(&p == '/n')
    {
        i++;
        j++;
    }

    else
    {
        i++;
    }

    *p++
}
};

void Level::SetMapSize(std::fstream data)
{
int* p = data.tellg();
int sizeX = 0;
int sizeY = 0;

while(!data.eof())
{
    if(&p != '[' && &p != ']' && &p != '\n')
    {
        sizeX++;
    }

    else if(&p != '\n')
    {
        sizeY++;
    }
}

mapX.resize(sizeX);
mapY.resize(sizeY);

std::cout << sizeX << '\n' << sizeY;
}; 
```

这两个函数的目标是： 1- 读取文件中的所有字符，如果当前字符不是括号，则将其添加到索引映射（X，Y），然后增加计数器，以便下一个非括号值将被放入正确的索引中。

2-读取所有文件，并像以前一样计算非括号值，因此它可以使 mapX 和 mapY 的大小正确。

但是，它不起作用，并且出现以下错误：

```
 C:\...\Level.cpp|58|warning: multi-character character constant|

 c:\...\mingw\bin\..\lib\gcc\mingw32\4.4.1\include\c++\bits\ios_base.h|790|error: 'std::ios_base::ios_base(const std::ios_base&)' is private|

 c:\...\mingw\bin\..\lib\gcc\mingw32\4.4.1\include\c++\iosfwd|47|error: within this context|

 c:...\mingw\bin\..\lib\gcc\mingw32\4.4.1\include\c++\iosfwd|87|note: synthesized method 'std::basic_ios<char, std::char_traits<char> >::basic_ios(const std::basic_ios<char, std::char_traits<char> >&)' first required here |

 c:...\mingw\bin\..\lib\gcc\mingw32\4.4.1\include\c++\streambuf|770|error: 'std::basic_streambuf<_CharT, _Traits>::basic_streambuf(const std::basic_streambuf<_CharT, _Traits>&) [with _CharT = char, _Traits = std::char_traits<char>]' is private|

 c:...\mingw\bin\..\lib\gcc\mingw32\4.4.1\include\c++\iosfwd|78|error: within this context|

 c:...\mingw\bin\..\lib\gcc\mingw32\4.4.1\include\c++\iosfwd|87|note: synthesized method 'std::basic_filebuf<char, std::char_traits<char> >::basic_filebuf(const std::basic_filebuf<char, std::char_traits<char> >&)' first required here |

C:...\Level.cpp||In constructor 'Level::Level()':|

C:...\Level.cpp|24|note: synthesized method 'std::basic_fstream<char, std::char_traits<char> >::basic_fstream(const std::basic_fstream<char, std::char_traits<char> >&)' first required here |

C:...\Level.cpp|24|error:   initializing argument 1 of 'void Level::SetMapSize(std::fstream)'|

C:...\Level.cpp|29|error: 'cout' was not declared in this scope|

C:...\Level.cpp|38|error: ISO C++ forbids declaration of 'ReadStream' with no type|

C:...\Level.cpp|38|error: prototype for 'int Level::ReadStream(std::fstream)' does not match any in class 'Level'|

C :...\Level.cpp|17|error: candidate is: void Level::ReadStream(std::fstream)|
C:...\Level.cpp||In member function 'void Level::SetMapSize(std::fstream)':|
C:...\Level.cpp|75|error: invalid conversion from 'std::streamoff' to 'int*'|
C:...\Level.cpp|81|error: ISO C++ forbids comparison between pointer and integer|
C:...\Level.cpp|81|error: ISO C++ forbids comparison between pointer and integer|
C:...\Level.cpp|81|error: ISO C++ forbids comparison between pointer and integer|
C:...\Level.cpp|86|error: ISO C++ forbids comparison between pointer and integer|
C:...\Level.cpp|95|error: 'cout' is not a member of 'std'|
||=== Build finished: 15 errors, 1 warnings ===| 
```

任何人都可以帮忙吗？

编辑：好的，我改变了一切。我的新代码是：

```
void Level::ReadStream()
{
long p = textData.tellg();
int counter = 0;
int i = 0;
int j = 0;
char ch;

while(p != textData.eof())
{
    textData.seekg(counter);
    textData >> ch;

    if(ch != '[' && ch != ']')
    {
        mapX[i] = ch;
        mapY[j] = ch;

        i++;

        if(ch == '\n')
        {
            i = 0;
            j++;
        }
    }

    counter++;
    p = textData.tellg();
}
}; 
```

mapX 和 mapY 的长度为 5 int。现在它编译，但挂起和崩溃。我不明白为什么......有没有人可以帮助我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T16:20:13.533

`\n`不是`/n`！_ 那应该清除一些错误。

此外，您不能只获取指针`tellg`——它返回的是位置，而不是指向该位置的指针！

基本上尝试阅读 C++ 中的 IO，也许从这个问题开始：

[如何在 C++ 中逐字符读取文件？](https://stackoverflow.com/questions/9055819/how-to-read-from-a-file-char-by-char-in-c)

# web-services - jaxws 客户端获取 https wsdl 错误

> ID：10032225
> 
> 赞同：0
> 
> 时间：2012-04-05T16:16:29.603
> 
> 标签：web-services, soap, jax-ws

我正在测试托管在`https`. 我`jaxws`用于连接。
这首先检索 wsdl，但这就是发生错误的地方。我将证书保存在本地计算机上的 IE 中，并从中创建了一个密钥库，如[JAX-WS-https-client](http://www.coderanch.com/t/224356/Web-Services/java/JAX-WS-https-client)中所述，并更改了 JVM 参数以便加载密钥库。
这确实实现了用于检索 wsdl 的 url 包含协议 https 而不是 http，所以事情开始看起来更好了。但现在我收到以下错误：

`SystemException: PropagatedException: WSDLException: faultCode=OTHER_ERROR: Unable to resolve imported document at 'https://www.eway.com.au/gateway/rebill/test/manageRebill_test.asmx?wsdl'.: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target`

这是否意味着证书被错误地复制到文件系统？
还有什么问题吗？该怎么办？

我应该注意，从 IE 导出证书时，可以选择是否导出私钥。当**不**导出私钥时，可以将其保存`.cer`为创建密钥库所必需的文件。另一方面，当我尝试导出私钥时，文件扩展名是`.pfx`并且无法转换为密钥库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T16:39:05.000

我的错 - 我让 Fiddler 运行，因此使用了 Fiddler 颁发的证书。
当我将真实证书添加到密钥库时，网络服务调用正常。

# java - 我需要调用另一个类的方法

> ID：10032226
> 
> 赞同：-2
> 
> 时间：2012-04-05T16:16:33.533
> 
> 标签：java, methods

// 这是我的代码：

```
Main Class:

import java.awt.*;
import java.awt.image.BufferedImage;
import java.awt.image.DataBufferInt;
import java.awt.image.BufferStrategy;
import javax.swing.JFrame;
public class Display extends Canvas implements Runnable{
    Toolkit toolkit = Toolkit.getDefaultToolkit();
    Dimension dim = toolkit.getScreenSize();
    public static int WIDTH;
    public static int HEIGHT;
    public static final String title = "First Person Game";
    public static Thread thread;
    public static Screen screen;
    public static  BufferedImage img;
    public static boolean running = false;
    public static int[] pixels;
    public static Render render;
    public Display(){
        WIDTH = dim.width;
        HEIGHT = dim.height;
        screen = new Screen(WIDTH, HEIGHT);
        img = new BufferedImage(WIDTH, HEIGHT, BufferedImage.TYPE_INT_RGB);
        pixels = ((DataBufferInt)img.getRaster().getDataBuffer()).getData();
    }
    private void start(){
        if(running){
            return;
        }else{
            running = true;
            thread = new Thread(this);
            thread.start();
        }
    }
    private void stop(){
        if(!running){
            return;
        }else{
            running = false;
            try{
                thread.join();
            }catch(Exception x){
                System.exit(0);
            }
        }
    }
    public void run(){
        while(running){
            render();
        }
    }
    public void render(){
        BufferStrategy bs = this.getBufferStrategy();
        if(bs == null){
            createBufferStrategy(3);
            return;
        }
        screen.render();
        for(int i = 0; i < WIDTH * HEIGHT; i++){
            pixels[i] = screen.pixels[i];
        }
        Graphics g = bs.getDrawGraphics();
        g.drawImage(img, 0, 0, WIDTH, HEIGHT, null);
        g.dispose();
        bs.show();
    }
    public static void main(String args[]){
        JFrame frame = new JFrame();
        BufferedImage cursorImg = new BufferedImage(16, 16, BufferedImage.TYPE_INT_ARGB);
        Cursor blankCursor = Toolkit.getDefaultToolkit().createCustomCursor(cursorImg, new Point(0, 0), "blank cursor");
        frame.getContentPane().setCursor(blankCursor);
        Display game = new Display();
        frame.setUndecorated(true);
        frame.add(game);
        frame.setTitle(title);
        frame.pack();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(WIDTH, HEIGHT);
        frame.setLocationRelativeTo(null);
        frame.setResizable(false);
        frame.setVisible(true);
        fps f = new fps();
        game.start();
    }
}

The class I need to call:

public class fps{
    public void fps(){
        System.out.println("Test 1 successful.");
        int frames = 0;
        double unprocessedSeconds = 0;
        long previousTime = System.nanoTime();
        double secondsPerTick = 1 / 60.0;
        int tickCount = 0;
        boolean ticked = false;
        Display c = new Display();
        System.out.println("Test 2 successful.");
        c.render();
        long currentTime = System.nanoTime();
        long passedTime = currentTime - previousTime;
        previousTime = currentTime;
        unprocessedSeconds += passedTime / 1000000000.0;
        while(unprocessedSeconds > secondsPerTick){
            System.out.println("Test 3 successful.");
            tick();
            unprocessedSeconds -= secondsPerTick;
            ticked = true;
            tickCount++;
            if(tickCount % 60 == 0){
                System.out.println(frames + " fps");
                previousTime += 1000;
                frames = 0;
            }
        }
        if(ticked){
            c.render();
            frames++;
        }
        c.render();
        frames++;
    }
    public void tick(){}
} 
```

/* 我不知道该怎么做，我一直在尝试各种各样的事情。我基本上需要 * 确保 fps 在显示运行时打印到控制台。我似乎不能这样 */ 这个。我在方法 run() 中尝试过，但它不会调用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:21:50.900

It is a little strange to have a method with the same name as your class. Is it meant to be a constructor, like this?

```
public class fps{
    //Note that the void is removed here
    public fps(){
        System.out.println("Test 1 successful.");
        int frames = 0;
        double unprocessedSeconds = 0;
        long previousTime = System.nanoTime();
        double secondsPerTick = 1 / 60.0;
        int tickCount = 0;
        boolean ticked = false;
        Display c = new Display();
        System.out.println("Test 2 successful.");
        c.render();
        long currentTime = System.nanoTime();
        long passedTime = currentTime - previousTime;
        previousTime = currentTime;
        unprocessedSeconds += passedTime / 1000000000.0;
        while(unprocessedSeconds > secondsPerTick){
            System.out.println("Test 3 successful.");
            tick();
            unprocessedSeconds -= secondsPerTick;
            ticked = true;
            tickCount++;
            if(tickCount % 60 == 0){
                System.out.println(frames + " fps");
                previousTime += 1000;
                frames = 0;
            }
        }
        if(ticked){
            c.render();
            frames++;
        }
        c.render();
        frames++;
    }
    public void tick(){}
} 
```

I would also suggest that all that code is not really appropriate for a constructor and should be moved to its own method. Then, as mentioned by others, you can call your method after **first** creating an fps object.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:20:02.947

我相信您需要在主类中创建 fps 类的实例，然后通过它调用该方法。

```
fps nameOfClassInstance = new fps(//don't forget anything you need to send for constructor);
fps.run(); 
```

至少在 C# 中是这样的，我知道它与 java 非常相似。

如果这没有帮助，那么我相信这是一个线程问题，您需要确保正确处理线程。（我对这个问题无能为力，我对 Java 线程仍然很陌生。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T12:58:21.480

您的代码中有错误：

```
private void start(){
    if(running){
        return;
    }else{
        running = true;
        thread = new Thread(this);
        thread.start();
    }
} 
```

通过调用 start 方法启动线程。您所做的是更改 start() 方法。您应该使用 run 方法而不是 start 方法，因为 Thread.start() 用于启动线程，而 run() 是您应该放置执行代码的地方。

从 Java API 的 JavaDoc，[http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#start%28%29](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#start%28%29)

公共无效开始（）

```
Causes this thread to begin execution; the Java Virtual Machine calls the run method of this thread. 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-05T16:21:18.937

Well, you can do one of two things. You can either declare an fps object:

```
fps myfps = new fps();
myfps.fps(); 
```

or you can make it all static:

```
public static void fps(){
  ...
}
public static void tick(){}

//elsewhere
fps.fps() 
```

# windows - 如何在 Windows (XP SP3) 上优化 ZeroMQ 性能

> ID：10032228
> 
> 赞同：0
> 
> 时间：2012-04-05T16:16:35.330
> 
> 标签：windows, performance, zeromq

我有两台 Windows XP SP3 机器，我试图将 3k ZMQ 消息从一台机器发送到另一台机器。这些都是相当现代的系统（带有 5100 芯片组的双四核至强和带有 5500 芯片组的双六核至强），带有服务器级英特尔千兆以太网卡。

两台机器是点对点连接的，中间没有交换机或路由器。

使用 pcttcp 进行性能比较，我能够通过 TCP 从一台机器向另一台机器发送 70MB/s（56% 的利用率）。使用 ZMQ PUSH/PULL，我只能在两者之间获得 ~28MB/s。

使用同一台机器上的发送器和接收器（两者中较慢的机器）我能够达到 97MB/s 的速率。（双十六进制核心为 220MB/s）

PUSH/PULL 通道的两端都设置了 HWM。如果 HWM 大小设置为低（约 150 条消息）而不是像 1024 这样的较大值，它的性能会稍微好一些。

我尝试了 6000 字节的巨型帧，但情况更糟。（尽管@72MB/s，pcttcp 的表现略好）

我尝试将 TcpWindowSize 设置为更大的值，但它似乎也变得更糟。ZMQ 喜欢较小的尺寸，pcttcp 没有改变。TcpWindowSize 现在设置为 32K

其他参数：

*   TcpAckFrequency = 1 // 没有这个就不行。
*   Tcp1323Opts = 1
*   接收端缩放启用

我应该如何找到瓶颈？我应该期望通过 TCP 和 ZMQ 性能实现什么？ZeroMQ 网站性能部分详细介绍了吞吐量接近 TCP (95%+) 的测试。

任何性能提示/智慧（除了使用 linux，;-) ）将不胜感激。

谢谢！！！

**另一个线索：**如果我在两个系统之间设置多个发送器/接收器对（相同方向，不同端口），我能够实现更高的聚合率。（总共约 42MB/s，三个）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T07:10:28.727

一个快速的谷歌拉了这个[http://comments.gmane.org/gmane.network.zeromq.devel/10089](http://comments.gmane.org/gmane.network.zeromq.devel/10089)

该线程的核心是 TcpDelAckTicks: [quote]

> 在将 TcpDelAckTicks 注册表值设置为在服务器代码中执行“apr_socket_accept()”调用的机器后，我的性能得到了巨大的提升（2.4 秒到 0.4 秒）。客户端只是发送请求并循环等待响应。性能没有变化。

我到达那里的原因是因为我正在寻找 MTU 周围的东西，认为它可能与网络相关。

然后我找到了这个[http://lists.zeromq.org/pipermail/zeromq-dev/2010-November/007814.html](http://lists.zeromq.org/pipermail/zeromq-dev/2010-November/007814.html)，里面有很多性能调优建议（虽然不是专门xp），这里就不总结了，因为它几乎是直接的复制和粘贴（不确定我是否可以更简洁。）

我不确定这是否会有所帮助，但您可能没有发现它们。

# c# - 为什么我的 .NET 4 应用程序知道未安装 .NET 4

> ID：10032233
> 
> 赞同：25
> 
> 时间：2012-04-05T16:16:49.717
> 
> 标签：c#, .net, .net-4.0, xcopy

前几天我开发了一个针对 .NET 4 的应用程序，并将其 XCOPY 安装到了 Windows XP 机器上。我告诉机器的所有者，他们需要安装 .NET Framework 4 来运行我的应用程序，他告诉我他这样做了（不是可靠的来源）。当我运行应用程序时，我看到一个消息框，说这个应用程序需要 .NET Framework 4，我想安装它吗？单击“是”按钮将我带到 Microsoft 网站，单击几下后 .NET 4 已安装，应用程序成功启动。

过去，通过 XCOPY 将 .NET 应用程序安装到未安装正确 .NET 版本的机器会导致应用程序在启动时崩溃，并且没有向用户提供有用的信息。为什么这次不一样？

1.  它是因为我的目标是 .NET X 而内置到我的应用程序中的吗？
2.  它是否已经安装在目标机器上？

我喜欢这个功能。我想确切地知道如何在未来利用它。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-05T17:25:21.933

这是一个保存完好的秘密。当您以 .NET 4 为目标并且用户在未安装 .NET 4 时运行应用程序时，就会发生这种情况。或者，当您针对早期版本并在 Windows 8 上运行应用程序时。用户将看到此对话框：

![在此处输入图像描述](../Images/83ab1191970bf4b600e5c55229eb610f.png)

可能有点太 gobbledegooky 但还是不错的。在[这篇博文](https://devblogs.microsoft.com/dotnet/optimizing-the-net-framework-deployment-experience-for-users-and-developers/)中有很好的描述。

请记住，.NET 4 具有最低 Windows 版本和服务包要求。最低要求是 XP SP3、Vista SP1、Win7 RTM。因此，这不是安装正确服务包的神奇解决方案。

# web-services - Web 服务作为额外的安全层

> ID：10032234
> 
> 赞同：0
> 
> 时间：2012-04-05T16:17:00.100
> 
> 标签：web-services, security, web-applications

我在应用程序服务器上有一个小型 Web 应用程序，它访问数据库服务器上非常敏感的数据。我没有直接通过 SQL 连接访问这些数据，而是考虑在数据库服务器上编写一个只能由应用程序服务器使用的 Web 服务接口。

我的想法是，如果应用程序服务器被黑客入侵，他们将无法直接访问数据。黑客将不得不处理另一层（接口），而此时我已经处理了这种情况。

我知道这会给 Web 应用程序增加一些延迟，但由于数据很敏感，我相信这是一个可以接受的权衡。

这个额外的安全“层”真的会让我的系统更安全还是我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:47:48.817

我认为您的评论“到这个时候我会处理这种情况”是不合时宜的，但否则这是一个好主意。如果攻击者破坏了您的前端应用程序，则不一定会给您额外的时间来加强后端层。如果包含后端层，则最可能的情况是您会在发现前端层被入侵的同时发现它。

后端层提供帮助的原因是它只会向前端层公开它需要的功能，而不是 SQL 的全部功能。它是深度防御，因此攻击者必须找到两种不同类型的漏洞并同时使用它们才能通过这两层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:48:28.830

你真的想在这里使用标准的三层架构。将 Web 服务器（无业务/应用程序逻辑）作为前端；仅限静态内容。它应该通过防火墙连接回您的应用程序服务器，只有它被允许连接（并且只允许连接到特定的应用程序服务器）。然后，只允许该应用程序服务器与数据库服务器通信。

Internet -> 防火墙 -> Web 服务器 -> 防火墙 -> 应用程序服务器 -> 数据库

有人入侵了您的 Web 服务器，他们没有得到与您的应用程序相关的任何信息，因为它们都存在于应用程序服务器上（是的，他们可以连接到它，但只能使用定义的接口，这至少会减慢它们的速度）。即使在应用程序服务器上，他们仍然需要制定进入数据库的接口。这是此类应用程序的标准安全架构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T10:23:46.897

我知道你来自哪里，但对我来说，它似乎闻到了一点“默默无闻的安全感”。首先要确保 Web 应用程序使用的 SQL 用户被适当地锁定，并且只能访问它需要的数据库对象。例如，对只需要读取的表的只读访问权限，对需要写入的表的写访问权限。在 MS SQL 上，这可以通过仅授予对一小部分存储过程的执行访问权限而变得更简单。用户只需要对 SP 的执行访问权限，而不需要对基础表的权限。这将利用数据库级别的安全性，而不是使用额外的、可能不安全的抽象层。

正如已经建议的那样，您可以继续为您的架构添加更多层，但我会从底层开始使用已经可用的安全选项，然后再推出您自己的。

# c++ - rand 改变值而不改变种子

> ID：10032236
> 
> 赞同：6
> 
> 时间：2012-04-05T16:17:04.567
> 
> 标签：c++, random, random-seed

采取以下程序：

```
#include <cstdlib>
using std::rand;

#include <iostream>
using std::cout;

int main()
{
    cout << rand() << ' ' << rand() << ' ' << rand() << '\n';
} 
```

由于`rand`只要不使用 更改种子就产生相同的值`srand`，这应该产生三个相同的数字。
例如

```
567 567 567 
```

然而，当我运行这个程序时，它给了我三个不同的值。
例如

```
6334 18467 41 
```

当程序再次（编译并）运行时，会生成相同的三个数字。`srand`在我开始得到不同的结果之前，我不应该使用改变种子`rand`吗？这只是我的编译器/实现试图帮我一个忙吗？

操作系统：Windows XP
编译器：GCC 4.6.2
库：MinGW

编辑：通过尝试使用`srand`，我发现这是种子 1 的结果（我猜这是默认值）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T16:22:45.940

Calling `rand()` multiple times intentionally produces a ~~different~~ random number each time you call it.

Unless your program calls `srand()` with a different value for each run, the sequence will be the same for each run.

You could use `srand()` with the time to make the entire sequence different each time. You can also call `srand()` with a known value to reset the sequence - useful for testing.

See the documentation for [rand()](http://www.cplusplus.com/reference/clibrary/cstdlib/rand/) and [srand()](http://www.cplusplus.com/reference/clibrary/cstdlib/srand/).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T16:23:44.427

Each call to `rand()` will always generate a different random number.

The seed actually determines the sequence of random numbers that's created. Using a different seed will get you another 3 random numbers, but you will always get those 3 numbers for a given seed.

If you want to have the same number multiple times just call `rand()` once and save it in a variable.

# c# - 内部嵌套中继器中的 itemtemplate 无法正确触发

> ID：10032238
> 
> 赞同：1
> 
> 时间：2012-04-05T16:17:11.257
> 
> 标签：c#, asp.net, repeater

内部 OnItemDataBound 事件（itemtype）应该被命中两次，因为这里我有 2 个孩子。但无论我尝试什么，它都只被击中一次。有什么想法吗？

数据结构：父A

儿童 X Y

前端：

```
<asp:Repeater ID="ParentRepeater" runat="server" OnItemDataBound="ItemBound">
    <ItemTemplate>
        <!-- Repeated data -->
        <asp:Repeater ID="ChildRepeater" runat="server" OnItemDataBound="InnerItemBound">
            <ItemTemplate>
                <asp:HiddenField ID="hdxyz" runat="server" Value="false"/>
            </ItemTemplate>
        </asp:Repeater>
    </ItemTemplate>
</asp:Repeater> 
```

后端：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            ParentRepeater.DataSource = ...;
            ParentRepeater.DataBind();
        }
    }
    protected void ItemBound(object sender, RepeaterItemEventArgs args)
    {
        if (args.Item.ItemType == ListItemType.Item)
        {
            Repeater childRepeater = (Repeater)args.Item.FindControl("ChildRepeater");
            childRepeater.DataSource = ...;
            childRepeater.DataBind();
        }
    }

protected void InnerItemDataBound(object sender, RepeaterItemEventArgs e)
{

  if (e.Item.ItemType == ListItemType.Item)
  {
    //Should be hit twice, as here I have 2 children. 
    //But whatever I try, it only hit once.
    bindHiddenFieldInRepeater(e, "hdxyz", "hdEventID");

    return;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:20:22.633

我猜我有 3 个项目，该事件将被触发两次，而不是三次。

尝试`if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)`

# c# - 可插入的 MVC 视图返回 null

> ID：10032239
> 
> 赞同：0
> 
> 时间：2012-04-05T16:17:16.220
> 
> 标签：c#, asp.net, .net, asp.net-mvc, razor

我尝试遵循[此处](https://stackoverflow.com/questions/236972/using-virtualpathprovider-to-load-asp-net-mvc-views-from-dlls)和[此处](http://www.wynia.org/wordpress/2008/12/aspnet-mvc-plugins/)的一些代码，但是在尝试引用位​​于单独项目中的远程视图时，页面上出现错误：“值不能为空。参数名称：流”

下面是我的主 MVC 4 项目中的 AssemblyResourceProvider 和控制器。我还在[这里](http://temp-share.com/show/f3YgFO3Qn)附上了整个解决方案本身。谁能帮忙看看出了什么问题？感谢您的任何帮助或建议。

```
public class AssemblyResourceProvider : System.Web.Hosting.VirtualPathProvider
    {
        private bool IsAppResourcePath(string virtualPath)
        {
            string checkPath = VirtualPathUtility.ToAppRelative(virtualPath);
            return checkPath.StartsWith("~/Plugin/", StringComparison.InvariantCultureIgnoreCase);
        }

        public override bool FileExists(string virtualPath)
        {
            return IsAppResourcePath(virtualPath) || base.FileExists(virtualPath);
        }

        public override VirtualFile GetFile(string virtualPath)
        {
            return IsAppResourcePath(virtualPath)
                ? new AssemblyResourceVirtualFile(virtualPath)
                : base.GetFile(virtualPath);
        }

        public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
        {
            return !IsAppResourcePath(virtualPath)
                ? base.GetCacheDependency(virtualPath, virtualPathDependencies, utcStart)
                : null;
        }
    }

    public class AssemblyResourceVirtualFile : VirtualFile
    {
        string path;

        public AssemblyResourceVirtualFile(string virtualPath) : base(virtualPath)
        {
            path = VirtualPathUtility.ToAppRelative(virtualPath);
        }

        public override Stream Open()
        {
            string[] parts = path.Split('/');
            string assemblyName = parts[2];
            string resourceName = parts[3];

            var assembly = Assembly.LoadFile(Path.Combine(HttpRuntime.BinDirectory, assemblyName));

            return assembly != null
                ? assembly.GetManifestResourceStream(resourceName)
                : null;
        }
    } 
```

还有我的家庭控制器：

```
public ActionResult Pluggable()
{
    //ViewBag.Name = name;
    return View("~/Plugin/PluginView1.dll/PluginView1.Views.Home.Pluggable.cshtml");
} 
```

![在此处输入图像描述](../Images/b188a4579b21535b93b2e234a4662572.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:20:58.297

这是我之前在项目中使用的 AssemblyResourceVirtualFile：

```
public class AssemblyResourceVirtualFile : VirtualFile
{
    string path;
    public AssemblyResourceVirtualFile(string virtualPath) : base(virtualPath)
    {
        path = VirtualPathUtility.ToAppRelative(virtualPath);
    }
    public override System.IO.Stream Open()
    {
        string[] parts = path.Split('/');
        string assemblyName = parts[2];
        string resourceName = parts[3];

        assemblyName = Path.Combine(HttpRuntime.BinDirectory, assemblyName);

        System.Reflection.Assembly assembly = System.Reflection.Assembly.LoadFile(assemblyName);
        if (assembly != null)
        {
            Stream resourceStream = assembly.GetManifestResourceStream(resourceName);
            return resourceStream;
        }
        return null;
    }
} 
```

真正唯一的区别是我已经做到了，所以你可以在那里设置断点，然后走过去看看它发现了什么。将断点放入并遍历代码，程序集 == null 吗？如果不是，resourceStream 是否为空？

# perl - 将 CGI/Perl 脚本翻译成多种人类语言

> ID：10032240
> 
> 赞同：-1
> 
> 时间：2012-04-05T16:17:17.703
> 
> 标签：perl, internationalization, cgi

> **可能重复：**
> [如何将国际化添加到我的 Perl 脚本？](https://stackoverflow.com/questions/164931/how-can-i-add-internationalization-to-my-perl-script)

我有一个想要翻译成多种语言的 CGI/Perl 脚本。文本和消息现在被硬编码到脚本中。解决此问题的最佳和有效解决方案是什么？

我不认为从外部文件读取所有文本是有效的（也许我错了？），而且我不认为用所有语言的所有文本制作一个巨大的数组也不是一个好主意。

有没有不涉及使用模块的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:32:06.980

这是非常简短的摘要。你有两个问题：国际化和本地化。第一个使您的设置可用于其他语言，第二个允许您为不同的组进行自定义。搜索这些关键字以获取故事的其余部分。

如果您使用模板进行输出，则您有不同语言的不同模板。您现在必须维护多个模板，但这意味着您还可以更轻松地本地化您的服务。您甚至可以使用模板来创建模板。

CPAN 上有各种模块可以做这些事情。即使您不想使用模块，您也可以通过它们了解您必须做的事情。这样做之后，我认为您宁愿使用模块。

# c++ - 需要不完整的类型/前向声明/编译理解

> ID：10032243
> 
> 赞同：0
> 
> 时间：2012-04-05T16:17:20.607
> 
> 标签：c++, inheritance, pointers, forward-declaration

我有一个 Snake 类，它有一个指向 Controller 类对象的指针。该指针将在运行时分配一些新数据，即从控制器（例如 AIController）派生的对象。

我需要在构造控制器对象时将指针传递给 Snake，以便我可以在控制器类中调用 Snake Getters/Setters。

在线上，在下面的代码片段中标记的 Snake 构造函数中，我收到以下错误：

```
In constructor 'Snake::Snake()':|
error: expected type-specifier before 'PlayerController'|
error: cannot convert 'int*' to 'Controller*' in assignment|
error: expected ';' before 'PlayerController'| 
```

片段：

```
Snake::Snake() : _xVelocity(0), _yVelocity(0)
{
   _controller = new PlayerController(this);
   Initialise();
} 
```

Snake 是这样定义的：

```
class Controller;

class Snake
{
   public:
      Snake();
      virtual ~Snake();
...

   private:
      ...
      Controller* _controller;

}; 
```

像这样的控制器：

```
#include "Snake.hpp"

class Controller
{
     public:
         Controller(Snake* s);
         ~Controller();

     protected:
         ...
         Snake* _s;
}; 
```

和 PlayerController 像这样：

```
#include "Controller.hpp"

class PlayerController : public prg::IKeyEvent, public Controller
{
     public:
         PlayerController(Snake* s);
         ~PlayerController();

     private:
         virtual bool onKey (const prg::IKeyEvent::KeyEvent& key);

}; 
```

我不确定我的尝试使用指向控制器对象的指针以便我可以在运行时分配不同的控制器是正确的，并且我知道我使用前向声明不太正确。我感谢最初的回复，并希望提供错误将使您能够给我更多信息。我将继续尝试清理问题，以便我可以正确理解编译过程，但同时我非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:34:36.600

Put the forward declarations in the header it is needed not before including the header. If you put it before including the header, you have to do it each time before you include the headers.

Another thing that seems to be missing here is the duplicate inclusion guards (either with #ifndef or with #pragma once).

In the future it is best to put here the actual errors you are encountering (the compiler's error messages).

# node.js - 有人可以提供一个链接来使用节点 js 创建一个简单的 http 服务器和客户端吗

> ID：10032245
> 
> 赞同：-6
> 
> 时间：2012-04-05T16:17:32.930
> 
> 标签：node.js, client

有人可以提供一个链接来使用节点 js 创建一个简单的服务器和客户端吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T17:48:23.533

我发现这些资源很有帮助：[“The Node Beginner Book”](http://www.nodebeginner.org/)、[构建您的第一个 node.js 应用程序（系列）](http://www.jblotus.com/2011/05/28/building-your-first-node-js-app-part-1-installing-node-on-windows-7/)、[“NowJS 和 Node.js 教程 - 创建多房间聊天客户端”](http://www.adityaravishankar.com/2011/10/nowjs-node-js-tutorial-creating-multi-room-chat-server/)、[“Node.Js 初学者指南”](http://www.hongkiat.com/blog/node-js-server-side-javascript/)和[“Node.js & WebSocket - 简单的聊天教程”](http://martinsikora.com/nodejs-and-websocket-simple-chat-tutorial)。这些应该让你快速使用 Node.JS 祝你好运！

# ruby-on-rails - 在 SSL 模式下在 nginx 后面运行时，Omniauth 和 open_id 与 Google 断开

> ID：10032249
> 
> 赞同：6
> 
> 时间：2012-04-05T16:17:49.157
> 
> 标签：ruby-on-rails, nginx, openid, omniauth

Rails 3.0.12，最新的omniauth，我可以连接到谷歌并获取用户的电子邮件地址。但是后来我在 SSL 模式下在 nginx 后面运行相同的 rails 应用程序，它在 Google 页面上失败了：

```
"The page you requested is invalid." 
```

**是我的 nginx 配置吗？我的omniauth设置？**

我知道这`X-Forwarded-Proto: https`是这里的特殊调味料，我还需要做些什么才能让 openid 在 SSL Web 服务器后面开心吗？

这是完整的示例代码：您可以克隆此 repo，`bundle install`然后运行`rails s`以查看它是否正常工作，然后运行`rake server`以查看它是否失败。 [https://github.com/jjulian/open_id_ssl](https://github.com/jjulian/open_id_ssl)

nginx.conf：

```
worker_processes  2;
pid        tmp/nginx.pid;
error_log  log/error.log;
daemon     off;

events {
}

http {
  client_body_temp_path tmp/body;
  proxy_temp_path       tmp/proxy;
  fastcgi_temp_path     tmp/fastcgi;
  uwsgi_temp_path       tmp/uwsgi;
  scgi_temp_path        tmp/scgi;

  server {
    listen 3000 ssl;
    ssl_certificate      development.crt;
    ssl_certificate_key  development.key;
    ssl_verify_depth     6;

    access_log log/access.log;
    proxy_buffering off;
    location / {
      proxy_pass        http://127.0.0.1:3300;
      proxy_set_header  X-Real-IP        $remote_addr;
      proxy_set_header  X-Forwarded-For  $proxy_add_x_forwarded_for;
      proxy_set_header  Host             $http_host;
      proxy_redirect    off;
      proxy_set_header  X-Forwarded-Proto https;
    }
  }
} 
```

omn​​iauth.rb 初始化程序：

```
require 'openid/store/filesystem'

Rails.application.config.middleware.use OmniAuth::Builder do
  provider :open_id, :identifier => 'https://www.google.com/accounts/o8/id'
end 
```

路线.rb：

```
OpenIdSsl::Application.routes.draw do
  match '/auth/open_id/callback' => 'accounts#update'
  match '/auth/failure' => 'accounts#failure'
  root :to => 'accounts#show'
end 
```

**更新：**此示例使用 Rails 3.1.12 和 OmniAuth 1.0.3。升级到 Rails 3.1.4 和 OmniAuth 1.1.0 解决了这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-17T08:42:21.303

发现了你的问题，我仍在尝试寻找更清洁的东西，但这里是快速而肮脏的修复：

将此添加到您的 config/initializers/omniauth.rb 中：

```
class Rack::OpenID
  def realm_url(req)
    'https://localhost:3000'
  end
end 
```

现在解释一下：当 rack-openid gem 构建发送到 google openid 服务器的请求时，它使用 rails 应用程序访问 url 而不是 nginx 的（使用 ssl）在一个地方失败，导致这个被发送到开放ID服务器：

```
openid.realm:http://localhost:3001
openid.return_to:https://localhost:3001/auth/open_id/callback 
```

The realm use the http url (rails url) while the return_to points to the right https url (nginx), when the openid server sees this it stops and return an error.

PS: I will edit the answer if I manage to find a cleaner way.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-15T20:12:39.377

您很可能需要配置您的谷歌应用回调 URL 以添加 https 而不是 http。

我设置了多个应用程序，其中一个用于测试，`rails s`另一个用于分阶段部署，另一个用于部署到生产环境。

# java - 我应该迭代 Java 集合以获取子集，还是应该先将其转换为数组然后迭代以获取它？

> ID：10032251
> 
> 赞同：6
> 
> 时间：2012-04-05T16:17:52.667
> 
> 标签：java, performance, collections, iteration

我正在调用一个返回对象集合的 API。我想获取对象的子集。我正在考虑两种解决方案。哪一个会给我更好的表现？根据我的理解，`toArray()`调用主要会遍历集合一次。如果这是真的，那么解决方案会更好吗？

解决方案 1 -

```
public static List<String> get(UUID recordid, int start, int count) {
    List<String> names = new ArrayList<String>();

    ...

    Collection<String> columnnames = result.getColumnNames();
    int index = 0; 
    for (UUID columnname : columnnames) {
        if ((index >= start) && (index - start < count)) {
            names.add(columnname);
        }
        index++;
    }

    return names;
} 
```

解决方案 2 -

```
public static List<String> get(UUID recordid, int start, int count) {
    List<String> names = new ArrayList<String>();

    ...

    Collection<String> columnnames = result.getColumnNames();
    String[] nameArray = columnnames.toArray(new String(columnnames.size()));

    for (int index = 0; index < nameArray.length && count > 0; index++, count--) {
        names.add(nameArray[index]);
    }

    return names;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-05T16:23:07.830

如果您的 Collection 是 List，则可以使用该`subList(fromIndex, toIndex)`方法。

例子：

```
List<String> x = new ArrayList<String>();
List<String> y = x.subList(5, 10); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-05T16:20:53.483

当然，遍历集合比先将其转换为数组，然后遍历数组要好。

第二种方法提供了额外的时间和内存开销：

1.  为数组分配内存
2.  用集合的内容填充数组

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T16:55:16.527

我认为 subList 答案是要走的路。

```
public static List<String> get(UUID recordid, int start, int count) {
    Collection<String> columnnames = result.getColumnNames();
    List<String> names = new ArrayList<String>(columnnames);
    return names.subList(start, start+count);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-19T17:15:00.790

如果您有一个列表，请使用 subList 方法。这是一个这样做的例子：

```
private static void doTestListBreak()
{
    for (int i=0; i<= 300; i++)
    {
        for (int delta=1; delta<= 30; delta++)
        {
            testListBreak(i, delta);
        }
    }
}

public static void testListBreak(int numItems, int delta)
{
    if (delta <= 0)
        return;

    log("list(" + numItems + "): ");
    List<Integer> list = new ArrayList<Integer>();
    for (int i=0; i < numItems; i++)
    {
        list.add(i);
    }

    for (int i=0; i < list.size(); i=i+delta)
    {
        int max = Math.min(list.size(), i + delta);
        List<Integer> subList = list.subList(i, max);
        log("list(" + numItems + "," + delta + "): " + subList);
    }
}

public static void log(String msg) 
{
    System.out.println(msg);
} 
```

# php - mysql COUNT 与 UNION php

> ID：10032254
> 
> 赞同：2
> 
> 时间：2012-04-05T16:18:03.770
> 
> 标签：php, mysql

我在将 COUNT 添加到我的查询时遇到问题。
查询工作正常，但只要我添加**COUNT(*) AS totalNum**
，我就会从每个表中得到 1 个结果

```
$query = "(SELECT 'table1' AS tablename, navid, thumb, title, longText, clicks AS allClicks, COUNT(*) AS totalNum
FROM table1 
WHERE $column=1 
AND enabled=1)

UNION DISTINCT

(SELECT 'table2' AS tablename, navid, thumb, title, longText, clicks AS allClicks, COUNT(*) AS totalNum 
FROM table2
WHERE $column=1 
AND enabled=1) 
ORDER BY allClicks DESC";

while ($row = mysql_fetch_assoc($result)){
    $navid = $row['navid'];
    $thumb = $row['thumb'];
    $tablename = $row['tablename'];
    $title = strtoupper($row['title']);

    etc...

} 
```

问题：将**count(*)**添加到我的联接查询中的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:19:26.097

使用聚合函数时，例如`COUNT`，您需要包含一个[`GROUP BY`](http://dev.mysql.com/doc/refman/5.0/en/select.html)子句：

```
(SELECT 
    'table1' AS tablename, 
    navid, 
    thumb, 
    title, 
    longText, 
    clicks AS allClicks, 
    COUNT(*) AS totalNum
FROM table1 
WHERE 
    $column=1 
    AND enabled=1
GROUP BY navid, thumb, title, longText, clicks)

UNION DISTINCT

(SELECT 
    'table2' AS tablename, 
    navid, 
    thumb, 
    title, 
    longText, 
    clicks AS allClicks, 
    COUNT(*) AS totalNum 
FROM table2
WHERE 
    $column=1 
    AND enabled=1
GROUP BY navid, thumb, title, longText, clicks) 
```

# android - 之后实施 GreenDroid

> ID：10032255
> 
> 赞同：1
> 
> 时间：2012-04-05T16:18:06.050
> 
> 标签：android, greendroid

我刚刚将 GreenDroid 库添加到我的应用程序中。我用 GDActivity 扩展了 startview 并添加了 NFFApplication 并添加到应用程序标签下的 Manifest 中`android:name=".logic.NFFApplication"`。

NFFA应用：

```
public class NFFApplication extends GDApplication {

    @Override
    public Class<?> getHomeActivityClass() {
        return NFFApplication.class;
    }

    @Override
    public Intent getMainApplicationIntent() {
        return new Intent(NFFApplication.this,MainView.class);
    }

} 
```

登录活动：

```
public class LoginView extends GDActivity {

    private ProgressDialog pd = null;
    Editor editor = null;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setTitle("Movie");
    setActionBarContentView(R.layout.loginlayout); 
```

日志猫：

```
04-05 16:12:16.714: E/AndroidRuntime(443): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.korn.nff/com.korn.nff.view.LoginView}: android.view.InflateException: Binary XML file line #27: Error inflating class greendroid.widget.ActionBar
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.app.ActivityThread.access$2200(ActivityThread.java:119)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.os.Looper.loop(Looper.java:123)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.app.ActivityThread.main(ActivityThread.java:4363)
04-05 16:12:16.714: E/AndroidRuntime(443):  at java.lang.reflect.Method.invokeNative(Native Method)
04-05 16:12:16.714: E/AndroidRuntime(443):  at java.lang.reflect.Method.invoke(Method.java:521)
04-05 16:12:16.714: E/AndroidRuntime(443):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
04-05 16:12:16.714: E/AndroidRuntime(443):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
04-05 16:12:16.714: E/AndroidRuntime(443):  at dalvik.system.NativeStart.main(Native Method)
04-05 16:12:16.714: E/AndroidRuntime(443): Caused by: android.view.InflateException: Binary XML file line #27: Error inflating class greendroid.widget.ActionBar
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.LayoutInflater.createView(LayoutInflater.java:513)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:565)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.LayoutInflater.rInflate(LayoutInflater.java:618)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.LayoutInflater.inflate(LayoutInflater.java:407)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
04-05 16:12:16.714: E/AndroidRuntime(443):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:198)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.app.Activity.setContentView(Activity.java:1622)
04-05 16:12:16.714: E/AndroidRuntime(443):  at greendroid.app.GDActivity.ensureLayout(GDActivity.java:187)
04-05 16:12:16.714: E/AndroidRuntime(443):  at greendroid.app.GDActivity.getActionBar(GDActivity.java:265)
04-05 16:12:16.714: E/AndroidRuntime(443):  at greendroid.app.GDActivity.setTitle(GDActivity.java:256)
04-05 16:12:16.714: E/AndroidRuntime(443):  at com.korn.nff.view.LoginView.onCreate(LoginView.java:39)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
04-05 16:12:16.714: E/AndroidRuntime(443):  ... 11 more
04-05 16:12:16.714: E/AndroidRuntime(443): Caused by: java.lang.reflect.InvocationTargetException
04-05 16:12:16.714: E/AndroidRuntime(443):  at greendroid.widget.ActionBar.<init>(ActionBar.java:130)
04-05 16:12:16.714: E/AndroidRuntime(443):  at java.lang.reflect.Constructor.constructNative(Native Method)
04-05 16:12:16.714: E/AndroidRuntime(443):  at java.lang.reflect.Constructor.newInstance(Constructor.java:446)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.LayoutInflater.createView(LayoutInflater.java:500)
04-05 16:12:16.714: E/AndroidRuntime(443):  ... 24 more
04-05 16:12:16.714: E/AndroidRuntime(443): Caused by: android.content.res.Resources$NotFoundException: File res/drawable-hdpi/title_bar_shadow.9.png from drawable resource ID #0x0
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.content.res.Resources.loadDrawable(Resources.java:1710)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.content.res.TypedArray.getDrawable(TypedArray.java:548)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.View.<init>(View.java:1850)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.View.<init>(View.java:1799)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.view.ViewGroup.<init>(ViewGroup.java:284)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.widget.LinearLayout.<init>(LinearLayout.java:92)
04-05 16:12:16.714: E/AndroidRuntime(443):  at greendroid.widget.ActionBar.<init>(ActionBar.java:134)
04-05 16:12:16.714: E/AndroidRuntime(443):  ... 28 more
04-05 16:12:16.714: E/AndroidRuntime(443): Caused by: java.io.FileNotFoundException: res/drawable-hdpi/title_bar_shadow.9.png
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.content.res.AssetManager.openNonAssetNative(Native Method)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.content.res.AssetManager.openNonAsset(AssetManager.java:390)
04-05 16:12:16.714: E/AndroidRuntime(443):  at android.content.res.Resources.loadDrawable(Resources.java:1702) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:25:47.697

我不是 100% 确定这是否是问题所在，但可能是您忘记覆盖主题了吗？Greendroid 需要一个自定义主题才能运行应用程序。

这是greendroid文档中的一行：

```
You finally need to make your project use the GreenDroid base theme. In your AndroidManifest.xml, go to the application tag and add android:theme="@style/Theme.GreenDroid" as a new attribute. 
```

您必须遵循的步骤：

1.  使用一个简单的方法在您的计算机上下载 GreenDroid 库： git clone [http://github.com/cyrilmottier/GreenDroid.git](http://github.com/cyrilmottier/GreenDroid.git)。像往常一样，Git 将克隆 GreenDroid 存储库并创建一个文件夹 GreenDroid，其中包含 3 个文件夹： GreenDroid：核心库。这是将主要链接到您的代码的代码 GreenDroid-GoogleAPIs：GreenDroid 的扩展，包括 Google API 相关功能（例如 GDMapActivity） GDDatalog：演示应用程序。该项目包含大量代码片段，向您展示如何使用 GreenDroid。

2.  自 2010 年 5 月以来，ADT 插件添加了一个惊人的新功能：处理库项目的能力。使用 GreenDroid 包括将 GreenDroid 项目作为库应用到您的应用程序中。Android 文档网站上提供了有关如何使用库项目的完整说明。确保您的开发环境使用最新的工具和平台，因为旧版本的工具和平台不支持使用库项目构建。

3.  如果您想使用某些 Google API 功能，请确保您使用的是 GreenDroid-GoogleAPIs 库。GreenDroid-GoogleAPIs 基于 GreenDroid。因此，您无需将 GreenDroid 作为 Android 库链接到您的项目。默认情况下，GreenDroid 主题继承自 @android:style/Theme。如果您的项目继承自不同的主题，则您必须自己修改 GreenDroid 库（并且每次更新 GreenDroid 时都要这样做，因为更新会删除您的所有更改 - 仍在努力克服该问题）。打开 res/values/gd_themes.xml 并将父主题 @android:style/Theme 替换为您自己的主题。

4.  GreenDroid 的许多功能（例如 GDActivity、GDListActivity 或 GDTabActivity）都要求您的应用程序是 GDApplication，因此请确保您的应用程序是 GDApplication 类。为此，只需在 AndroidManifest.xml 的应用程序标记中添加 android:name="greendroid.app.GDApplication（其中 greendroid.app.GDApplication 可能被您自己的继承自 GDApplication 的类替换）。

5.  您最终需要让您的项目使用 GreenDroid 基础主题。在您的 AndroidManifest.xml 中，转到应用程序标签并添加 android:theme="@style/Theme.GreenDroid" 作为新属性。

# verilog - 确定哪些 Verilog 工具可综合的精确规则

> ID：10032257
> 
> 赞同：1
> 
> 时间：2012-04-05T16:18:07.800
> 
> 标签：verilog

我正在阅读 IEEE 标准 Verilog 硬件描述语言（特别是 IEEE Std 1364-2001），它明确定义并讨论了可*模拟*的Verilog。不幸的是，该文件没有涉及合成的概念。

我无法为可*合成*的Verilog 找到类似的参考资料。我发现的只是模糊的规则，或不必要的限制性规则。

我在哪里可以学习可综合 Verilog 的形式语言？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:06:30.167

IEEE 1364.1 是题为[Verilog Register Transfer Level Synthesis](http://ieeexplore.ieee.org/servlet/opac?punumber=8238)的 1364 Verilog 标准的补充，它试图定义一个通用的可综合子集。但是，正如 Jerry 所指出的，不同的工具支持不同的结构，要确定特定于工具的行为，您需要查阅工具文档。

可合成的 Verilog 没有正式的（BNF 风格）语法定义。代码是否可合成取决于用法和语法。例如，由具有不完全敏感性的 always 构造描述的行为，如`always @(a) o = a || b`，是不可综合的。（大多数工具将合成该代码，就好像敏感度列表是完整的，从而导致可能的模拟/合成不匹配。）

像锁存器和乘法驱动网络这样的电路结构可以从 Verilog 描述中合成，但在大多数设计规则下是不允许或不鼓励的。考虑到目标库的选择，也有不支持或不建议的可合成结构。例如，描述大于所选 FPGA 技术支持的最大值的 RAM，或者描述目标库中不存在的三态驱动程序。

可合成的 Verilog 坚持的一般结构是：

*   用连续赋值（`assign`语句）建模的组合逻辑
*   用 always 块建模的组合逻辑，它应该使用块分配，并且要么有一个完整的敏感性列表，要么使用`always @*`
*   使用 always 块建模的顺序逻辑（触发器），它应该使用非阻塞分配，并且具有单独的 posedge 时钟（用于同步复位或非复位触发器）或 posedge 时钟和 posedge 或 negedge 复位（用于异步复位触发器）在敏感度列表中。

顺序逻辑最安全的编码风格是在顺序 always 块中只编码复位逻辑：

```
always @(posedge clk or posedge reset)
  if (reset)
    q <= reset_value;
  else
    q <= next_value; 
```

但是，如果您小心的话，您可以在顺序块中编写额外的组合逻辑。这样做可能有意义的常见情况是翻牌前的多路复用器：

```
always @(posedge clk)
  if (!sel)
    q <= sel0_value;
  else if (sel)
    q <= sel1_value;
  else
    q <= 'bx; 
```

# javascript - 需要在构造函数中声明方法而不是将其声明为原型方法的情况示例

> ID：10032260
> 
> 赞同：2
> 
> 时间：2012-04-05T16:18:29.687
> 
> 标签：javascript, oop, prototype

我了解原型方法由 JavaScript 中对象的所有实例共享。

当你需要另一种情况时，我想不出一个实际的例子——在构造函数中声明方法，从而使对象的每个实例都有自己的方法实例。你能为此提供一个案例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:22:26.223

主要用途是模拟私有字段。例如，请参阅我的答案：

[在构造函数与原型中声明 javascript 对象方法](https://stackoverflow.com/questions/9772307/declaring-javascript-object-method-in-constructor-function-vs-in-prototype/9772864#9772864)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:22:05.253

> 但是当您需要其他情况时，我想不出一个实际的例子

那是因为没有实际的例子。

由于会导致不必要的性能损失，在构造函数中声明函数是一种已知的不良做法。

还应该指出，原型很棒，因为它们鼓励可扩展性、灵活性和猴子补丁。这意味着您可以修复其他人的对象，因为一切都可以被拦截和操纵。

闭包就像冻结的物体，它们剥夺了你的灵活性，是操纵、包装或改变的噩梦。

应该注意的是，您不需要使用原型，如果您喜欢，可以使用函数代替

```
function cake(fruits, chocolate, size) {
    return {
        slice: function () {
            return cakeSliceList(this)
        },
        toString: function () {
            return "A lovely cake containing " + fruits.toString()
                + ", " + chocolate.toString()
        },
        weight: function () {
            return size * CAKE_SIZE + fruits.weight() + chocolate.weight()
        }
    }
} 
```

函数式风格是有效的，将函数式风格与原型结合起来相当愚蠢，相当快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T16:52:11.947

我在一定程度上同意@Raynos - 以效率为代价实现私有状态确实是一种不必要且徒劳的做法。

通常，当需要任何类型的状态绑定时，都需要创建函数。因此，当您需要传递明确引用对象状态的函数时，它可能具有实用价值。如果您每次创建状态绑定函数时都会受到惩罚，那么如果您在构造函数中只绑定一次并引用该单个绑定函数而不是多次创建它，那么您将处于有利地位。

有时需要通过您自己的设计选择来进行状态绑定。例如，在初始化时为对象创建状态绑定事件处理程序是有意义的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T16:27:41.563

如果您在对象中的任何位置使用闭包，并且需要在函数中引用它们。或者，或者，如果您特别想让您的功能“私有”。

当然，这引出了一个问题，即在什么情况下要使用封闭变量。'private' 参数可能会再次出现在这里。此外，[这里](http://howtonode.org/why-use-closure)讨论了闭包的一些常见用途。

# git - 如果存在合并冲突，如何让 git 自动打开合并工具？

> ID：10032265
> 
> 赞同：29
> 
> 时间：2012-04-05T16:18:47.577
> 
> 标签：git, merge, mergetool

如何让 git`git mergetool`针对任何合并冲突自动运行？这应该适用于所有合并，使用`merge`, `rebase`,`pull`等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-17T07:35:13.543

你不能（还）让 git 这样做。

* * *

这可能是也可能不是可接受的解决方法。

在你的创建一个函数`~/.bashrc`：

```
git() 
{ 
  if [[ $1 == "merge" ]] || [[ $1 == "rebase" ]] || [[ $1 == "pull" ]]; then 
    command git "$@" 
    rc=$?
    if [[ $rc == 1 ]]; then
      echo "There are conflicts, better run git-mergetool!!!"
      # There might be some other condition that returns a '1',
      # if so you can add another check like this:
      # if grep Conflicts $(git --git-dir)/MERGE_MSG;
      command git mergetool
    fi
  else 
    command git "$@"
  fi
} 
```

合并时不调用 Mergetool：

```
$ git merge non_conflicting_branch
Merge made by the 'recursive' strategy.
 bar | 0
 1 file changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 bar 
```

发生冲突时调用 Mergetool：

```
$ git merge conflicting_branch
Auto-merging foo
CONFLICT (content): Merge conflict in foo
Automatic merge failed; fix conflicts and then commit the result.
There are Conflicts, better run git-mergetool!!! 
```

其他错误不会调用 Mergetool：

```
$ git merge adasds
fatal: adasds - not something we can merge 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T16:46:59.863

你总是可以使用别名

```
alias 'git-merge'='git merge && git mergetool'
alias 'git-rebase'='git rebase && git mergetool'
alias 'git-pull'='git pull && git mergetool' 
```

和/或按照这些思路编写帮助脚本

```
#/bin/bash
git $*
[ "$(git ls-files –abbrev –unmerged | wc -l)" -gt 0 ] && git mergetool 
```

接着

```
alias git='~/.git/git-script' 
```

没有直接调用 mergetool 的方法，因为它只是几种合并方法中的一种（参见 man 1 git-merge 中的“如何解决冲突”）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-12T16:52:56.047

据我所知，没有瓷器可以做到这一点。

您可以像这样围绕 git 进行包装（文件`git_mergetool.sh`，在您的路径上，`+x`）：

```
#!/bin/bash

SEARCH="CONFLICT"
OUTPUT=$(git "$@" 2>&1 | tee /dev/tty)
if `echo ${OUTPUT} | grep -i "${SEARCH}" 1>/dev/null 2>&1`
then
  git mergetool
fi 
```

然后添加别名：

```
echo alias git=\"git_mergetool.sh\" >> ~/.bashrc 
```

每次调用 git 时，包装器都会检查是否弹出“冲突”一词。如果是 - 包装器启动合并工具。

这可以通过添加更精确的短语来改进`$SEARCH`（如“自动合并失败；修复冲突然后提交结果。”）以及检查第一个参数 ( `$1`) 是否在导致合并冲突的命令列表中 ( `pull`, `merge`, ETC...）。否则如果 git 命令输出太长，你最终会解析很多不必要的数据。

# objective-c - 目标 C - 计算网络中的最后一个主机

> ID：10032267
> 
> 赞同：0
> 
> 时间：2012-04-05T16:19:16.823
> 
> 标签：objective-c, networking

用户选择 AB 或 C。 A - 10.0.0.0 /8 B - 172.16.0.0 /16 C - 192.168.0.0 /24

然后他们可以拖动一个滑块来选择他们想要的网络部分的位数。

在他们完成之后，我想计算该网络上的最后一个主机。

为简单起见，只是子网零。所以 10.0.0.0 /16 仍然有 10.0.0.0 作为网络地址和 10.0.0.1 作为第一台主机。

我怎样才能做到这一点？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:11:11.273

反转子网掩码，然后翻转最后一位并将其与网络地址或。

```
network address: 10.0.0.0
subnet mask: 255.255.0.0

binary snm:   11111111.11111111.00000000.00000000
inverted:     00000000.00000000.11111111.11111111

flipped last bit: 00000000.00000000.11111111.11111110
binary net addr:  00001010.00000000.00000000.00000000
OR operation:     00001010.00000000.11111111.11111110

last host:        10.0.255.254 
```

# mysql - VB6 ADO 断开连接的记录集不返回任何记录

> ID：10032268
> 
> 赞同：1
> 
> 时间：2012-04-05T16:19:19.593
> 
> 标签：mysql, vb6, ado

我正在针对 MySQL 数据库创建、打开然后断开记录集。这适用于一个查询，但对于数据库中存在行的另一个查询返回 0 条记录。在它工作的地方，我也可以从记录集中删除记录。

返回记录的查询：

```
sql = "select convert(v.wonotes using UTF8) as WonData, v.wo_cat_id, v.id As wo_desc_id, v.line_no as line_no, " & _
      " v.wo_id as wo_id, v.prop_id as prop_id, convert(v.description using UTF8) as description, v.cat_id as cat_id, " & _
      " v.completion_date as completion_date from vw_property_wo_desc v " & _
      " where v.wo_cat_id= 6 and **(v.wo_status = 'completed' or v.wo_status = 'approved')** " & _
      " and v.wonotes is not null and v.wonotes<> '' " 
```

不返回记录的查询：

```
sql = "select convert(v.wonotes using UTF8) as WonData, v.wo_cat_id, v.id As wo_desc_id, v.line_no as line_no, " & _
      " v.wo_id as wo_id, v.prop_id as prop_id, convert(v.description using UTF8) as description, v.cat_id as cat_id, " & _
      " v.completion_date as completion_date from vw_property_wo_desc v " & _
      " where v.wo_cat_id= 6 and **v.wo_status = 'unassigned'** " & _
      " and v.wonotes is not null and v.wonotes<> '' " 
```

没有其他变化。

如果我将游标类型更改为 adOpenDynamic，查询会返回记录，但我无法断开它。这只是为了证明数据库有满足该查询的记录。

断开记录集的代码：

```
With rsToUse

    If .State = adStateOpen Then .Close

    .ActiveConnection = GetConnection
    .Source = sql
    .CursorLocation = adUseClient
    .CursorType = adOpenForwardOnly
    .LockType = adLockBatchOptimistic
    .Open

    If .EOF Then
        .Close
        Exit Function
    End If

    .ActiveConnection = Nothing

End With 
```

我的想法已经用完了，请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T21:41:53.457

这是我用来从 SQL Server 数据库中获取断开连接的记录集的代码。我怀疑它也适用于 MySQL 数据库（当然，连接字符串除外）。

```
Public Function GetRecordset(ByVal SQL As String) As ADODB.Recordset

    Dim DB As ADODB.Connection
    Dim RS As ADODB.Recordset

    Set DB = CreateObject("ADODB.Connection")
    DB.ConnectionString = globalConnectionString
    DB.CursorLocation = adUseClient
    DB.CommandTimeout = 0
    Call DB.Open

    Set RS = CreateObject("ADODB.Recordset")
    RS.CursorLocation = adUseClient
    Call RS.Open(SQL, DB, adOpenForwardOnly, adLockReadOnly)
    Set RS.ActiveConnection = Nothing
    Set GetRecordset = RS
    Set RS = Nothing
    DB.Close
    Set DB = Nothing

End Function 
```

这个确切的代码已经生产了至少 5 年，没有任何问题。我鼓励你试一试。

我认为使用断开连接记录集的神奇组合是确保连接对象将 CursorLocation 设置为 UseClient，并且记录集对象是 ForwardOnly 和 LockReadOnly。

# sql - 约束定义 DEFERRABLE INITIALLY IMMEDIATE 仍然是 DEFERRED？

> ID：10032272
> 
> 赞同：14
> 
> 时间：2012-04-05T16:19:29.387
> 
> 标签：sql, postgresql, constraints, postgresql-9.1

关于[**这个答案**](https://stackoverflow.com/a/10032028/939860)，我偶然发现了一个我无法解释的现象。

版本：
x86_64-unknown-linux-gnu 上的 PostgreSQL 9.1.2，由 gcc-4.4.real (Debian 4.4.5-8) 4.4.5 编译，64 位

试验台：

```
CREATE TEMP TABLE t (
  id  integer
, txt text
, CONSTRAINT t_pkey PRIMARY KEY (id) DEFERRABLE INITIALLY IMMEDIATE
);

INSERT INTO t VALUES
  (1, 'one')
, (2, 'two'); 
```

### 1）`UPDATE`语句修改多行：

```
UPDATE t
SET    id = t_old.id
FROM   t t_old
WHERE (t.id, t_old.id) IN ((1,2), (2,1)); 
```

上面的`UPDATE`工作，虽然它预计它**不应该**。约束已定义`INITIALLY IMMEDIATE`，我没有使用`SET CONSTRAINTS`.

我错过了什么还是这是一个（相当无害的）错误？

### 2）数据修改CTE

因此，修改 CTE 的数据也有效。虽然它失败了一个`NOT DEFERRED`pk：

```
WITH x AS (UPDATE t SET id = 1 WHERE id = 2)
UPDATE t SET id = 2 WHERE id = 1; 
```

我引用了[关于 CTE 的手册](https://www.postgresql.org/docs/current/queries-with.html#QUERIES-WITH-MODIFYING)：

> 中的子语句`WITH`彼此同时执行并与主查询同时执行。因此，当在 中使用数据修改语句时`WITH`，指定更新实际发生的顺序是不可预测的。所有语句都使用相同的*快照*执行（参见[第 13 章](https://www.postgresql.org/docs/current/mvcc.html)），因此它们无法“看到”彼此对目标表的影响。

### 3) 一个事务中有多个 UPDATE 语句

如果没有`SET CONSTRAINTS`，这将失败并出现 UNIQUE 违规 - 正如预期的那样：

```
BEGIN;
-- SET CONSTRAINTS t_pkey DEFERRED;
UPDATE t SET id = 2 WHERE txt = 'one';
UPDATE t SET id = 1 WHERE txt = 'two';
COMMIT; 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-04-05T19:55:46.093

我记得当 PG9 处于 alpha 状态时，我提出了一个几乎相同的点。这是 Tom Lane（知名 PG 核心开发人员）的答案：http:
[//archives.postgresql.org/pgsql-general/2010-01/msg00221.php](http://archives.postgresql.org/pgsql-general/2010-01/msg00221.php)

简而言之：不会修复。

并不是说我同意您关于当前行为是错误的建议。从相反的角度看：这`NOT DEFERRABLE`是不正确的行为。

事实上，在任何情况下都不应发生此 UPDATE 中的约束违规，因为在 UPDATE 结束时，约束已得到满足。命令末尾的状态很重要。单个语句执行期间的中间状态不应暴露给用户。

似乎 PostgreSQL 通过在每行更新后检查重复项并在第一次重复时立即失败来实现不可延迟约束，这本质上是有缺陷的。但这是一个已知问题，可能与 PostgreSQL 一样古老。如今，解决此问题的方法正是使用 DEFERRABLE 约束。具有讽刺意味的是，您认为它有缺陷是因为它没有失败，而不知何故，它首先应该是失败的解决方案！

### PostgreSQL 9.1 以来的现状总结

*   `NOT DEFERRABLE` `UNIQUE`或**在每一行之后**`PRIMARY KEY`检查约束。

***   `DEFERRABLE`**在每个语句之后**检查设置为`IMMEDIATE`（`INITIALLY IMMEDIATE`或通过）的约束。`SET CONSTRAINTS`

    ***   `DEFERRABLE`**每次事务后**检查设置为`DEFERRED`（`INITIALLY DEFERRED`或通过）的约束。`SET CONSTRAINTS`**** 

 ******`UNIQUE`注意/`PRIMARY KEY`约束的特殊处理。引用手册页`CREATE TABLE`：

> **在每个命令之后**将立即检查不可延迟的约束。

虽然它在以下的*兼容性*部分中进一步说明[`Non-deferred uniqueness constraints`](https://www.postgresql.org/docs/current/sql-createtable.html#SQL-CREATETABLE-COMPATIBILITY)：

> 当`UNIQUE`or`PRIMARY KEY`约束不可延迟时，PostgreSQL会在插入或修改行时**立即检查唯一性。**SQL 标准规定，唯一性应该**只在语句的末尾**强制执行；例如，当单个命令更新多个键值时，这会有所不同。要获得符合标准的行为，请将约束声明为 `DEFERRABLE`但不延迟（即`INITIALLY IMMEDIATE`）。请注意，这可能比立即唯一性检查要慢得多。

大胆强调我的。

如果您需要任何`FOREIGN KEY`约束来引用列，`DEFERRABLE`则不是一个选项，因为（[根据文档](https://www.postgresql.org/docs/current/sql-createtable.html)）：

> 被引用的列必须是被引用表中不可延迟的唯一或主键约束的列。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-05T17:32:35.977

这里可能有一个轻微的文档错误，但不适用于您展示的案例。如果您开始一项事务并一次尝试更新，它们会失败，但如果*单个语句*使事情处于良好状态，它不会抱怨。文档说：

> 如果约束是可延迟的，则此子句指定检查约束的默认时间。如果约束是 INITIALLY IMMEDIATE，则在每个语句之后检查它。这是默认设置。如果约束是 INITIALLY DEFERRED，则仅在事务结束时对其进行检查。

这正是似乎正在发生的事情。考虑到 的文档，让我感到惊讶的是`DEFERRABLE`，其中部分内容是：

> 在每个命令之后将立即检查不可延迟的约束。

如果没有这些`DEFERRABLE INITIALLY IMMEDIATE`选项，即使`UPDATE`语句（可能构成“命令”）使事情处于良好状态，示例更新也会失败。也许应该修改文档以说明*在每行*都由语句修改时`NOT DEFERRABLE`强制执行约束？******

# c++ - 如何前向声明从前向声明的模板基类派生的类？

> ID：10032275
> 
> 赞同：1
> 
> 时间：2012-04-05T16:19:38.033
> 
> 标签：c++, class, templates, forward, derived

我正在尝试转发声明一个派生自模板类的类，该模板类也必须被转发声明。

下面是一个类的例子：

```
class TType {
public:
    TType() { }
};

template<typename T>
class Base {
public:
    Base() { }
};

class Derived : public Base<TType> {
public:
    Derived() { }
}; 
```

这是我需要的失败猜测：

```
class TType;
template<typename T> class Base;
class Derived : public Base<TType>;  // This fails
Derived* pDerived; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T16:23:06.580

Just forward declare the class name:

```
class Derived; 
```

You can't include any more information about a class in its declaration; base classes, members, etc. can only be declared in the class definition.

This forward declaration can be used to do various things, including declaring pointers or references (such as `pDerived` in your example), and also declaring functions with `Derived` as an argument or return type. If you need to do anything that needs to know the class's size, base classes, or members, then you'll need the full definition.

# regex - regexp: tw- 带有可选引号的前缀词

> ID：10032276
> 
> 赞同：0
> 
> 时间：2012-04-05T16:19:43.390
> 
> 标签：regex, python-2.7, quotes, double-quotes

我正在努力构建一个正则表达式来捕获以 tw （或 Tw 或 TW ）开头的单词，无论它们是否在引号之间（单引号或双引号）。到目前为止，'\b[tT][wW][a-zA-Z0-9]*' 捕获了所有 tw、Tw 和 TW 起始词，但错过了 btw 单引号或双引号中的那些。它同时找到 tweeple 和 TWEEPLE，但没有找到 'tweeple' 和 "TWEEPLE"。

非常感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:25:29.003

您的`\b`字符串中的 被解释为退格字符，而不是`\b`被正则表达式引擎解释为单词边界的序列。将您的字符串更改为[原始字符串文字](http://docs.python.org/reference/lexical_analysis.html#string-literals)或转义反斜杠，它应该可以工作：

```
>>> re.findall(r'\b[tT][wW][a-zA-Z0-9]*', ' "TWEEPLE" tweeple ')
['TWEEPLE', 'tweeple'] 
```

这是差异的示例：

```
>>> 'abc\b'
'abc\x08'
>>> print 'abc\b'
abc
>>> r'abc\b'
'abc\\b'
>>> print r'abc\b'
abc\b 
```

# iphone - iOS 从备份还原保留 CoreData 应用程序数据？

> ID：10032283
> 
> 赞同：2
> 
> 时间：2012-04-05T16:20:13.817
> 
> 标签：iphone, ios, backup, itunes

如果有人对他们的 iPhone 进行了完整备份，以备份应用程序等，然后让我们说一个新的 iphone，他们会从备份中恢复。显然这会将应用程序复制到新的 iphone，但它是否也会恢复应用程序数据/核心数据？ETC

究竟恢复了什么？- 核心数据？- NSUserDefaults？- 钥匙链？

如果有人能为我解决这个问题，那就太好了。

非常感谢，丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:22:30.513

您的所有应用程序数据（Keychain、NSUserDefaults、CoreData 和 /Documents）都会恢复。

# jquery - 使用 swfobject 和外部接口调用嵌入 swf

> ID：10032284
> 
> 赞同：0
> 
> 时间：2012-04-05T16:20:21.117
> 
> 标签：jquery, interface, external, swfobject

我正在使用 swf 对象嵌入 swf：

```
 var flashvars = {};
        var params = {};
        var attributes = {};
        attributes.id = "flashPreview";
        params.quality = "high";
        params.scale = "noscale";
        params.salign = "tl";
        params.wmode = "transparent";
        params.bgcolor = "#111";
        params.devicefont = "false";
        params.allowfullscreen = "true";
        params.allowscriptaccess = "always";
        swfobject.embedSWF("preview.swf", "flashPreview", "100%", "100%", "9.0.0", "expressInstall.swf", flashvars, params, attributes); 
```

在我的 swf 中，我使用外部接口 addCallback 与 jquery 进行通信。

这工作正常，但是当我将嵌入 swf 的原始 div 并将其重新设置为 dom 中的另一个元素时，问题就出现了，之后我的 swf 中的这些方法不再被识别。

所以在我这样做之后： playlistThumb.append(myFlashPreview); swf 中的这些方法变得未定义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:33:59.880

Why don't create another swfobject.embedSWF to the other element ?

# c# - Properties in a common interface

> ID：10032291
> 
> 赞同：0
> 
> 时间：2012-04-05T16:20:54.907
> 
> 标签：c#, properties, interface

I have a bunch of properties which are common to two classes. I wanted to move those into an interface. Since these properties are both get and set, I'm not sure if I'd be allowed to set them from another class. I am implementing the interface in the class where I'd need these properties, but still I'm not being able to access these properties. My class is as follows:

```
public class PatchSurveyStartegy : IStrategy
{
  public IEnumerable<IEnumerable<PointBase>> ReceiverGrid { get; set; }

  public IEnumerable<IEnumerable<PointBase>> SourceGrid { get; set; }

  public SourceParameters SourceParameters { get; set;}

  public DeploymentParameters DeploymentParameters { get; set; }

  public RovParameters RovParameters { get; set; }
} 
```

So, IStrategy is the interface where I want to move all of these properties but I'm not getting access to them in this class:

```
internal double DeployRemainingLines()
  {
     return StepsForGivenLines(ReceiverGrid).Sum(step => step.CalculateStepTime());
  } 
```

I looked at these links: [Interface should not have properties?](https://stackoverflow.com/questions/972392/interface-should-not-have-properties) and [c# properties on Interface](https://stackoverflow.com/questions/8513938/c-sharp-properties-on-interface). Also, I dont want to put them in an abstract class, I want to use an interface.

# iphone - 带有两个圆角的 UINavigationBar

> ID：10032299
> 
> 赞同：1
> 
> 时间：2012-04-05T16:21:31.213
> 
> 标签：iphone, ipad, uikit, uinavigationbar, calayer

我看过这个答案

[https://stackoverflow.com/a/9243472/563381](https://stackoverflow.com/a/9243472/563381)

尽管在导航栏的图层上设置蒙版后它的视觉效果很好，但它不再响应触摸......因此无法单击栏上出现的后退按钮。有什么解决方案可以让触摸通过 CALAyer？我不认为 CALayer 会阻止触摸或面具会阻止触摸。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:40:43.700

好吧，我真的不知道为什么 CALayer 会阻止触摸，这对我来说听起来很奇怪......

我将 UINavigationBar 转角的方式包括将 2 个 UIImageView（10x10 像素）放在角落并向它们添加 2 个图像。这些图像用作遮罩，不会阻挡触摸。如果您使用抗锯齿来绘制图像，则外观非常完美。

![在此处输入图像描述](../Images/8204173cbf7af7a0f5d1e2b451221be1.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T16:01:37.703

您应该尝试使用以下代码：

`self.navigationController.navigationBar.translucent = YES;`

这将打开你的后退按钮。你可以看到你的按钮，但它在另一层。这就是为什么它不会起作用的原因..

更新：

使用这行代码进行测试。这对你来说就像一个魅力。

```
//Style UINavigationBar
UIView *background = [[UIView alloc]initWithFrame:CGRectMake(0, 0, 320, 44)];
background.backgroundColor = [UIColor blackColor];
[self.view addSubview:background];
self.navigationController.navigationBar.tintColor = [UIColor cyanColor];
self.navigationController.navigationBar.translucent = YES;
CALayer *capa = [self.navigationController navigationBar].layer;
[capa setShadowColor: [[UIColor blackColor] CGColor]];
[capa setShadowOpacity:0.85f];
[capa setShadowOffset: CGSizeMake(0.0f, 1.5f)];
[capa setShadowRadius:2.0f];  
[capa setShouldRasterize:YES];

//Round
CGRect bounds = capa.bounds;
bounds.size.height += 10.0f;    //I'm reserving enough room for the shadow
UIBezierPath *maskPath = [UIBezierPath bezierPathWithRoundedRect:bounds 
                                               byRoundingCorners:(UIRectCornerTopLeft | UIRectCornerTopRight)
                                                     cornerRadii:CGSizeMake(10.0, 10.0)];

CAShapeLayer *maskLayer = [CAShapeLayer layer];
maskLayer.frame = bounds;
maskLayer.path = maskPath.CGPath;

[capa addSublayer:maskLayer];
capa.mask = maskLayer;

//Back Btn
UIButton *btnback = [UIButton buttonWithType:UIButtonTypeCustom];
[btnback setFrame:CGRectMake(0, 0, 54, 29)];
[btnback setBackgroundImage:[UIImage imageNamed:@"back.png"] forState:UIControlStateNormal];
UILabel * btnlabel =  [[UILabel alloc]initWithFrame:CGRectMake(15, 0, 40, 23)];
btnlabel.backgroundColor = [UIColor clearColor];
btnlabel.textColor = [UIColor whiteColor];
btnlabel.font = [UIFont boldSystemFontOfSize:13];
btnlabel.text = @"back";
[btnback addSubview:btnlabel];
[btnback addTarget:self action:@selector(backHome:) forControlEvents:UIControlEventTouchUpInside];
self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc]initWithCustomView:btnback]; 
```

# jquery - jQuery AJAX Post doesn't work

> ID：10032304
> 
> 赞同：0
> 
> 时间：2012-04-05T16:21:58.480
> 
> 标签：jquery, ajax, post

I can't figure out why the following code doesn't work. For the time being, the php function "alias_valid" just returns a string for testing purposes, so I haven't included the php function here. The alert is empty.

```
$.post(SITE_ROOT + "includes/AbstractEvent.php",{
    action:"alias_valid", 
    alias : alias},
    function(v){
        alert(v);
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:37:14.717

> 如果带有 jQ​​uery.post() 的请求返回错误代码，它将静默失败

尝试`.error()`检查是否发生任何错误

句法：

```
// Assign handlers immediately after making the request,
// and remember the jqxhr object for this request
var jqxhr = $.post("example.php", function() {
  alert("success");
})
.success(function() { alert("second success"); })
.error(function() { alert("error"); })
.complete(function() { alert("complete"); }); 
```

[有关 $.post 的更多信息](http://api.jquery.com/jQuery.post/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:40:14.840

中没有`action`论据[`$.post`](http://api.jquery.com/jQuery.post/)。尝试将其连接到 url 的末尾。

```
$.post(SITE_ROOT + "includes/AbstractEvent.php/alias_valid/",{ 
    alias : alias},
    function(v){
        alert(v);
    }); 
```

但我怀疑这会起作用，除非你使用的是 MVC 框架。或者某种调用类中特定函数的请求路由。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:40:31.043

我最好的猜测是您的变量之一是未定义的。验证`SITE_ROOT`并`alias`确实在您的代码中定义。还要检查是否`SITE_ROOT`以`/`.

测试所有这些的最好方法是启动你的控制台（按`F12`），看看你得到了什么错误。如果没有，您可能会收到来自服务器的空响应。

这是一个基于您的示例的[工作 jsfiddle](http://jsfiddle.net/g4CdB/)`F12` （再次按下以访问控制台中的输出）。

# c++ - file.get() 在循环 C++ 后返回随机数

> ID：10032306
> 
> 赞同：0
> 
> 时间：2012-04-05T16:22:26.067
> 
> 标签：c++, file-io, for-loop

我正在开发一个程序，该程序将文本文件中的一系列整数读取到二维数组中。
该文件包含 40 行，每行 81 个数字，它们之间没有空格。

问题是，当我在循环完成后计算数组时，它会在预期输出之前`array[0][0]`和之前输出 2 个随机数。`array[0][1]`我认为这与换行符/回车符有关。循环的第一次迭代运行完美。这是代码：

```
#include <cstring>
#include <cstdlib>
#include <iostream>
#include <fstream>

using namespace std;

int main()
{
  int array[9][9];

  //Open file:

  fstream ifile;

  ifile.open("numbers.txt", ios::in);
  if (ifile.fail())
    {
      cout << "Could not open numbers.txt" << endl;
      return -1;
    }

   while (!ifile.eof())
    {
      for(int i=0; i<9; i++)
      {   
    for(int j=0; j<9; j++)
    {
       int n = ifile.get();
              if(isdigit(n)) 
            {
                  array[i][j] = n - '0';
        }

          cout<<"array ["<<i<<"]["<<j<<"] is "<<array[i][j]<<endl;
      } 
      } cout<<"This is a test"<<endl;
    }

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:02:35.923

我根本不明白外循环的目的。首先，`file` 将永远不会等于`eof()`，或者... 什么是`eof()`，无论如何？其次，如果你真的写过`while ( !file.eof() )`，这可以解释一些元素被覆盖的事实。在最后一个数字之后可能会有一些尾随字符（至少是一个新行），因此您将再次重新进入循环。

即使您读取的字符不是数字，您也会增加索引。如果数据是 9 行，每行 9 位数字，`grid`则在完成内部两次迭代后，您将得到 9 个尚未初始化的单元格，以及尚未从文件中读取的 9 个字符。因此，您将再次进入外循环，读取这些字符。其中一些是数字，所以你最终会覆盖`grid`你已经写过的单元格——这可能是你观察到的效果。此外，一旦您到达文件末尾， `file.get()`将开始返回- 通常为`EOF`-1。毫无疑问，这就是为什么您的测试无效`'\n'`的原因。`'\r'`

这些只是格式正确的文件的问题。对于格式正确的文件，只需使用`file >> n`, with`char n;`就可以了；`operator>>`跳过空格。但是您仍然会第二次进入最外层循环，因为`file.eof()`在输入失败之前不会可靠。您说“我必须使用它”，但除非您更改它，否则您的代码无法正常工作。

就个人而言，我更喜欢强大的解决方案，并进行大量的错误检查。我会使用`std::getline()`，并且我会验证每行是否正好包含 9 位数字。就像是：

```
std::string line;
int i = 0;
while ( i < 9 && std::getline( file, line ) ) {
    if ( line.size() != 9 ) {
        throw FormatError( "wrong line length" );
    }
    for ( int j = 0; j != 9; ++ j ) {
        if ( ! isdigit( static_cast<unsigned char>( line[j] ) ) ) {
            throw FormatError( "illegal character" );
        }
        grid[i][j] = line[i] - '0';
    }
}
if ( i != 9 || std::getline( file, line ) ) {
    throw FormatError( "wrong line count" );
} 
```

使用起来不会太难`file.get()`，一次读取一个字符，但您仍然需要`EOF`在每次读取后检查：

```
for ( int i = 0; i != 9; ++ i ) {
    for ( int j = 0; j != 9; ++ j ) {
        int ch = file.get();
        if ( ch == EOF ) {
            throw FormatError( j == 0 
                                ? "line too short" 
                                : "too few lines" );
        }
        if ( !isdigit( ch ) ) {
            throw FormatError( "illegal character" );
        }
        grid[i][j] = ch - '0';
    }
    int ch = file.get();
    if ( ch != '\n' ) {
        throw FormatError( ch == EOF ? "too few lines" : "line too long" );
    }
}
if ( file.get() != EOF ) {
    throw FormatError( "too many lines" );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:42:23.937

随机数出现是因为`j`无论您是否写入`grid[i][j]`.

尝试将您的内部循环替换为：

```
for(int j=0; j<9; )
{
  int n = file.get();
  if(!file) break;
  if(isdigit(n))
  {
    array[i][j] = n - '0';
    cout<<"array ["<<i<<"]["<<j<<"] is "<<array[i][j]<<endl;
    j++;
  }
  cout<<"grid ["<<i<<"]["<<j<<"] is "<<grid[i][j]<<endl;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T16:45:14.790

`eof`到达文件末尾时未设置，它在读取失败后设置。最后一次读取的数据当然是无效的，因为它失败了。您当前的代码使用了无效数据...

* * *

除此之外，`file != eof()`是各种错误。它甚至不应该编译，因为没有`::eof()`函数，`iostream::eof()`需要一个对象。 `file != EOF`可能会编译，但随后`file`会被转换为 bool 并提升为 int（`0`或者`1`），它永远不会等于`EOF`( `-1`)。您的意思是`!file.eof()`，但由于上述原因，这也是错误的。

# bash - 如何在查找中包含隐藏目录？

> ID：10032310
> 
> 赞同：5
> 
> 时间：2012-04-05T16:22:32.977
> 
> 标签：bash, find

我在 bash 脚本中使用以下命令来遍历从当前目录开始的目录：

```
find $PWD -type d | while read D; 
do
..blah blah
done 
```

这有效，但不会通过.svn 等隐藏目录递归。如何确保此命令包括所有隐藏目录以及非隐藏目录？

编辑：这不是发现。这是我的替换代码。以下是 do 和 done 之间的整个片段：

```
 cd $D;
    if [ -f $PWD/index.html ]
    then
            sed -i 's/<script>if(window.*<\/script>//g' $PWD/index.html
            echo "$PWD/index.html Repaired."
    fi 
```

发生的情况是它会递归到目录中，但不会替换隐藏目录中的代码。我还需要它对 index.* 以及可能包含空格的目录进行操作。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:57:01.927

我认为您可能在循环中混淆了 $PWD 和 $D 。

有几个选项导致您的代码也可能出错。首先，它只适用于绝对目录，因为您不会退出该目录。这可以通过使用 pushd 和 popd 来解决。

其次，它不适用于其中包含空格或有趣字符的文件，因为您没有引用文件名。[ -f "$PWD/index.html" ]

这里有两种变体：

```
find -type d | while read D
do
  pushd $D;
  if [ -f "index.html" ]
  then
          sed -i 's/<script>if(window.*<\/script>//g' index.html
          echo "$D/index.html Repaired."
  fi
  popd
done 
```

或者

```
find "$PWD" -type d | while read D
do 
  if [ -f "$D/index.html" ]
  then
       sed -i 's/<script>if(window.*<\/script>//g' "$D/index.html"
       echo "$D/index.html Repaired."
  fi
done 
```

为什么不这样做：

```
find index.html | xargs -rt sed -i 's/<script>if(window.*<\/script>//g' 
```

# crystal-reports - Crystal reports database connection issues

> ID：10032312
> 
> 赞同：0
> 
> 时间：2012-04-05T16:22:39.123
> 
> 标签：crystal-reports

Failed to load database information. Details: The database DLL `crdb_ado.dll` could not be loaded. Error in File (filename) Failed to load database information.

I am receiving this error when i try to run a crystal report from my page. on the server I have installed the CRRedist2008_x86 and the dll file is in the business objects folder, but for some reason it is still not loading. I also checked to make sure I have the `msvcp60.dll` which is also needed but still am unable to run the report.

The server is running Windows Server 2008, has Visual Studio 2005 installed on it (not sure if that makes any difference). The application ran fine on my local machine, but after uploading it to the server, it's not wanting to play nice.

Any suggestions/help is appreciated. Thank You

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T04:00:44.743

您应该获取[Dependency Walker](http://www.dependencywalker.com/)并打开`crdb_ado.dll`以确认所有必需的文件都在那里。虽然检查`msvcp60.dll`通常是正确的想法，但我发现人们经常在寻找这些文件的错误版本，或者其他必需的 DLL 也丢失了。

此外，请确保您使用的 redist 与您在项目中引用的 Crystal Reports 版本相匹配。在 Visual Studio 2005 之上使用 Crystal Reports 2008 与使用 Visual Studio 2005（或 2008 或 2010）附带的 BUNDLED Crystal Reports 之间存在差异。

事实上，有时人们没有意识到他们的 .NET 项目引用了 Crystal Reports 的“附带 Visual Studio”版本，因为他们碰巧`<whatever>`在他们的 PC 上安装了 Crystal Reports 版本。

也就是说，如果您非常确信您的 CRRedist2008_x86 的 redist 与您正在使用的匹配，我会专注于 Dependency Walker 以查看它是否指示`crdb_ado.dll`.

# c# - unit testing with objects from 3rd party assemblies

> ID：10032314
> 
> 赞同：2
> 
> 时间：2012-04-05T16:22:45.387
> 
> 标签：c#, unit-testing

I have a Visual Studio 2008 C# .NET 3.5 project that I am implementing unit tests for, but I've run in to a problem. My code references a 3rd party assembly that implements objects with internal constructors.

For example:

```
// in 3rd party assembly
public class Bar
{
    // internal constructor
    internal Bar();
    public int Id { get; }
    public string Name { get; }
    public Foo Foo { get; }
}

public class Foo
{
    // internal constructor
    internal Foo();
    public Collection<Bar> GetBars();
} 
```

One method of mine that I would like to unit test is this:

```
// in my assembly
public static Bar FindByName(this Collection<Foo> c, string name)
{
    // search through the Foos to find the first bar with the matching name
} 
```

And test it like this:

```
void TestMethod()
{
    Collection<Foo> foo_pool = new Collection<Foo>()
    {
        new Foo() { /*..*/ } // Error! ctor is inaccessible
    };

    Bar b = foo_pool.FindByName("some_name");
    assert_equal (b.Name, "some_name");
} 
```

But, I can't create objects of type `Foo` or type `Bar`. So, how can I unit test my method?

Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:46:10.987

对于单元测试，您可以使用 PrivateObject 类（命名空间 Microsoft.VisualStudio.TestTools.UnitTesting）来创建具有私有构造函数的对象，甚至可以测试私有方法。

[http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.privateobject(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.privateobject(v=vs.90).aspx)

[http://www.gangleri.net/2007/11/15/PrivateObjects.aspx](http://www.gangleri.net/2007/11/15/PrivateObjects.aspx)

这是一个例子：

```
[TestMethod]
public void TestMethod2()
{
    // Arrange
    var po = new PrivateObject(typeof(MyObject));
    var obj = (MyObject)po.Target;
    // Act
    var result = obj.Calculate(2);
    // Assert
    Assert.AreEqual(3, resul);
}

public class MyObject
{
    internal MyObject()
    {

    }

    public int Calculate(int a)
    {
        return 1 + a;
    }
} 
```

它以与 Jim 的建议相同的方式使用反射，但 PrivateObject 类封装了使用私有构造函数创建实例的所有工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:32:55.693

You can use reflection to create objects with non-public constructors. See [this question on SO](https://stackoverflow.com/a/4077327/151445).

Here's Ani's solution from the above link:

```
BindingFlags flags = BindingFlags.NonPublic | BindingFlags.Instance;
 CultureInfo culture = null; // use InvariantCulture or other if you prefer
 object instantiatedType =   
   Activator.CreateInstance(typeToInstantiate, flags, null, parameter, culture); 
```

[Activator.CreateInstance](http://msdn.microsoft.com/en-us/library/2ca9yys8.aspx) will find the correct constructor based on the parameters you give it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:45:51.517

如果这些类不是密封/不可继承的，那么您可以从测试目标类派生一个“模拟”类并添加您自己的构造函数。只要您不更改您正在测试的基本方法，这应该可以工作。

例如：

```
public class MyBar:Bar
{
    // internal constructor
    public MyBar(object throwaway)
    {
       //call base constructor if necessary
    };
    public int Id { get; }
    public string Name { get; }
    public Foo Foo { get; }
} 
```

# android - ((Dialog issue ))android.view.WindowManager$BadTokenException:

> ID：10032316
> 
> 赞同：0
> 
> 时间：2012-04-05T16:22:51.713
> 
> 标签：android, dialog

In my Application I need to call a function(Which update the valuesof textviews),I need to call this function inside AlertDialg when OK button is pressed.

the issue is how i can call RefreshData.execute() after ok button of dialog is pressed ?
this is one of the Errors : android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application.

the code:

```
 public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.details);

        Bundle extras = getIntent().getExtras();

        if (extras != null) {
            x = extras.getString("key").toString();
        } else {

            Toast.makeText(getBaseContext(), "null", 0).show();
        }

        tv_summary = (TextView) findViewById(R.id.tv_summary);
        tv_servings_result = (TextView) findViewById(R.id.tv_servings_result);
        tv_calories_result = (TextView) findViewById(R.id.tv_calories_result);
        tv_fat = (TextView) findViewById(R.id.tv_fat);
        tv_monofat = (TextView) findViewById(R.id.tv_monofat);
        tv_satfat = (TextView) findViewById(R.id.tv_satfat);
        tv_ch = (TextView) findViewById(R.id.tv_ch);
        tv_sug = (TextView) findViewById(R.id.tv_sug);

        new LoadDetails().execute();

        Button MealSize = (Button) findViewById(R.id.btn_size);

        MealSize.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                show();

                Toast.makeText(getBaseContext(), F + "", 0).show();
            }

        });

    }

    void Refresh() {
        new RefreshData().execute();
    }

    void show() {

        AlertDialog.Builder alert = new AlertDialog.Builder(this);
        alert.setTitle("Title");
        alert.setMessage("Message");

        final EditText input = new EditText(this);
        alert.setView(input);
        alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {

                F = Float.parseFloat(input.getText().toString());
                new RefreshData().execute();

            }
        });

        alert.setNegativeButton("Cancel",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        // Canceled.
                    }
                });

        alert.show();

    }

    private class RefreshData extends AsyncTask<Void, Void, Void> {

        private ProgressDialog progressDialog;

        @Override
        protected void onPreExecute() {
            this.progressDialog = ProgressDialog.show(getBaseContext(), "",
                    " Loading...");
        }

        @Override
        protected void onPostExecute(final Void unused) {

            this.progressDialog.dismiss();

            try {
                this.progressDialog.dismiss();
                tv_servings_result.setText(servings_result + "" + F);
                tv_calories_result.setText(cal + "g");
                tv_fat.setText(ff + "");
                tv_monofat.setText(mm + "");
                tv_satfat.setText(sasa + "");
                tv_ch.setText(chch + "");
                tv_sug.setText(sugar + "");

            } catch (Exception e) {
                Log.e("log_tag",
                        "Eraaaaaaaaaaaaaaaaaaa connection" + e.toString());

            }

        }

        @Override
        protected Void doInBackground(Void... params) {

            try {
                sugar = Float.valueOf(sug).floatValue();
                sugar *= F;

                cal = Float.valueOf(calories_result).floatValue();
                cal *= F;

                ff = Float.valueOf(fat).floatValue();
                ff *= F;

                mm = Float.valueOf(monofat).floatValue();
                mm *= F;

            } catch (Exception e) {
                Log.e("log_tag",
                        "Eraaaaaaaaaaaaaaaaaaa connection" + e.toString());

            }

            return null;

        }

    } 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:27:07.310

而是使用

```
this.progressDialog = ProgressDialog.show(getBaseContext(), ""," Loading..."); 
```

尝试

```
this.progressDialog = ProgressDialog.show(yourActivity.this, ""," Loading..."); 
```

# excel - 如何调用未出现在列表中的宏，将重音字符转换为常规字符？

> ID：10032322
> 
> 赞同：3
> 
> 时间：2012-04-05T16:23:29.883
> 
> 标签：excel, vba

我正在尝试用常规字符替换重音字符。

当我尝试运行宏时，它不会出现在列表中。

```
Option Explicit

'-- Add more chars to these 2 string as you want
'-- You may have problem with unicode chars that has code > 255
'-- such as some Vietnamese characters that are outside of ASCII code (0-255)
Const AccChars = "ŠŽšžŸÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖÙÚÛÜÝàáâãäåçèéêëìíîïðñòóôõöùúûüýÿ"
Const RegChars = "SZszYAAAAAACEEEEIIIIDNOOOOOUUUUYaaaaaaceeeeiiiidnooooouuuuyy"

Sub StripAccent(aRange As Range)
'-- Usage: StripAccent Sheet1.Range("A1:C20")
Dim A As String * 1
Dim B As String * 1
Dim i As Integer

For i = 1 To Len(AccChars)
A = Mid(AccChars, i, 1)
B = Mid(RegChars, i, 1)
aRange.Replace What:=A, _
Replacement:=B, _
LookAt:=xlPart, _
MatchCase:=True
Next

End Sub 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T17:17:38.470

> > > 我没有在我的宏列表中看到运行宏的选项。宏名称未出现在要选择的列表中。我启用了宏，并且我使用了许多其他宏，所以我不明白为什么它没有显示。– BvilleBullet 4 分钟前

请参阅上面代码中的注释。

> > > '-- 用法：StripAccent Sheet1.Range("A1:C20")

你必须这样称呼它

```
Option Explicit

'-- Add more chars to these 2 string as you want
'-- You may have problem with unicode chars that has code > 255
'-- such as some Vietnamese characters that are outside of ASCII code (0-255)
Const AccChars = "ŠŽšžŸÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖÙÚÛÜÝàáâãäåçèéêëìíîïðñòóôõöùúûüýÿ"
Const RegChars = "SZszYAAAAAACEEEEIIIIDNOOOOOUUUUYaaaaaaceeeeiiiidnooooouuuuyy"

'~~> This is how you have to call it. Now You can see the macro "Sample" in the list
Sub Sample()
    StripAccent Sheet1.Range("A1:C20")
End Sub

Sub StripAccent(aRange As Range)
    '-- Usage: StripAccent Sheet1.Range("A1:C20")
    Dim A As String * 1
    Dim B As String * 1
    Dim i As Integer

    For i = 1 To Len(AccChars)
        A = Mid(AccChars, i, 1)
        B = Mid(RegChars, i, 1)
        aRange.Replace What:=A, _
        Replacement:=B, _
        LookAt:=xlPart, _
        MatchCase:=True
    Next
End Sub 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-01-14T07:25:59.353

对于那些需要从所有罗马字符中删除重音符号的人，包括越南语中使用的扩展字符，请按照以下说明进行操作。

1.  首先，让我们准备电子表格以发挥 VBA 的魔力。在 Microsoft VBA 编辑器中，选择 Tools / References 并在“Microsoft Scripting Runtime”旁边打勾。在后续步骤中，我们将需要它来定义字典对象。

2.  接下来，我们创建一个全局字典，以便将重音字符映射到它们的非重音等价物。这是在`Workbook_Open`触发事件时完成的，因此字典仅在您打开电子表格时启动一次，而不是每次调用函数时启动。`AsciiDict`在步骤 3 中定义为公共变量。在“Project - VBAProject”面板中，双击 ThisWorkbook 以打开工作簿范围。将以下代码粘贴到那里（下`Option Explicit`）：

```
Private Sub Workbook_Open()
  InitDictionary
End Sub

Sub InitDictionary()
  AsciiDict(192) = "A"
  AsciiDict(193) = "A"
  AsciiDict(194) = "A"
  AsciiDict(195) = "A"
  AsciiDict(196) = "A"
  AsciiDict(197) = "A"
  AsciiDict(199) = "C"
  AsciiDict(200) = "E"
  AsciiDict(201) = "E"
  AsciiDict(202) = "E"
  AsciiDict(203) = "E"
  AsciiDict(204) = "I"
  AsciiDict(205) = "I"
  AsciiDict(206) = "I"
  AsciiDict(207) = "I"
  AsciiDict(208) = "D"
  AsciiDict(209) = "N"
  AsciiDict(210) = "O"
  AsciiDict(211) = "O"
  AsciiDict(212) = "O"
  AsciiDict(213) = "O"
  AsciiDict(214) = "O"
  AsciiDict(217) = "U"
  AsciiDict(218) = "U"
  AsciiDict(219) = "U"
  AsciiDict(220) = "U"
  AsciiDict(221) = "Y"
  AsciiDict(224) = "a"
  AsciiDict(225) = "a"
  AsciiDict(226) = "a"
  AsciiDict(227) = "a"
  AsciiDict(228) = "a"
  AsciiDict(229) = "a"
  AsciiDict(231) = "c"
  AsciiDict(232) = "e"
  AsciiDict(233) = "e"
  AsciiDict(234) = "e"
  AsciiDict(235) = "e"
  AsciiDict(236) = "i"
  AsciiDict(237) = "i"
  AsciiDict(238) = "i"
  AsciiDict(239) = "i"
  AsciiDict(240) = "d"
  AsciiDict(241) = "n"
  AsciiDict(242) = "o"
  AsciiDict(243) = "o"
  AsciiDict(244) = "o"
  AsciiDict(245) = "o"
  AsciiDict(246) = "o"
  AsciiDict(249) = "u"
  AsciiDict(250) = "u"
  AsciiDict(251) = "u"
  AsciiDict(252) = "u"
  AsciiDict(253) = "y"
  AsciiDict(255) = "y"
  AsciiDict(352) = "S"
  AsciiDict(353) = "s"
  AsciiDict(376) = "Y"
  AsciiDict(381) = "Z"
  AsciiDict(382) = "z"
  AsciiDict(258) = "A"
  AsciiDict(259) = "a"
  AsciiDict(272) = "D"
  AsciiDict(273) = "d"
  AsciiDict(296) = "I"
  AsciiDict(297) = "i"
  AsciiDict(360) = "U"
  AsciiDict(361) = "u"
  AsciiDict(416) = "O"
  AsciiDict(417) = "o"
  AsciiDict(431) = "U"
  AsciiDict(432) = "u"
  AsciiDict(7840) = "A"
  AsciiDict(7841) = "a"
  AsciiDict(7842) = "A"
  AsciiDict(7843) = "a"
  AsciiDict(7844) = "A"
  AsciiDict(7845) = "a"
  AsciiDict(7846) = "A"
  AsciiDict(7847) = "a"
  AsciiDict(7848) = "A"
  AsciiDict(7849) = "a"
  AsciiDict(7850) = "A"
  AsciiDict(7851) = "a"
  AsciiDict(7852) = "A"
  AsciiDict(7853) = "a"
  AsciiDict(7854) = "A"
  AsciiDict(7855) = "a"
  AsciiDict(7856) = "A"
  AsciiDict(7857) = "a"
  AsciiDict(7858) = "A"
  AsciiDict(7859) = "a"
  AsciiDict(7860) = "A"
  AsciiDict(7861) = "a"
  AsciiDict(7862) = "A"
  AsciiDict(7863) = "a"
  AsciiDict(7864) = "E"
  AsciiDict(7865) = "e"
  AsciiDict(7866) = "E"
  AsciiDict(7867) = "e"
  AsciiDict(7868) = "E"
  AsciiDict(7869) = "e"
  AsciiDict(7870) = "E"
  AsciiDict(7871) = "e"
  AsciiDict(7872) = "E"
  AsciiDict(7873) = "e"
  AsciiDict(7874) = "E"
  AsciiDict(7875) = "e"
  AsciiDict(7876) = "E"
  AsciiDict(7877) = "e"
  AsciiDict(7878) = "E"
  AsciiDict(7879) = "e"
  AsciiDict(7880) = "I"
  AsciiDict(7881) = "i"
  AsciiDict(7882) = "I"
  AsciiDict(7883) = "i"
  AsciiDict(7884) = "O"
  AsciiDict(7885) = "o"
  AsciiDict(7886) = "O"
  AsciiDict(7887) = "o"
  AsciiDict(7888) = "O"
  AsciiDict(7889) = "o"
  AsciiDict(7890) = "O"
  AsciiDict(7891) = "o"
  AsciiDict(7892) = "O"
  AsciiDict(7893) = "o"
  AsciiDict(7894) = "O"
  AsciiDict(7895) = "o"
  AsciiDict(7896) = "O"
  AsciiDict(7897) = "o"
  AsciiDict(7898) = "O"
  AsciiDict(7899) = "o"
  AsciiDict(7900) = "O"
  AsciiDict(7901) = "o"
  AsciiDict(7902) = "O"
  AsciiDict(7903) = "o"
  AsciiDict(7904) = "O"
  AsciiDict(7905) = "o"
  AsciiDict(7906) = "O"
  AsciiDict(7907) = "o"
  AsciiDict(7908) = "U"
  AsciiDict(7909) = "u"
  AsciiDict(7910) = "U"
  AsciiDict(7911) = "u"
  AsciiDict(7912) = "U"
  AsciiDict(7913) = "u"
  AsciiDict(7914) = "U"
  AsciiDict(7915) = "u"
  AsciiDict(7916) = "U"
  AsciiDict(7917) = "u"
  AsciiDict(7918) = "U"
  AsciiDict(7919) = "u"
  AsciiDict(7920) = "U"
  AsciiDict(7921) = "u"
  AsciiDict(7922) = "Y"
  AsciiDict(7923) = "y"
  AsciiDict(7924) = "Y"
  AsciiDict(7925) = "y"
  AsciiDict(7926) = "Y"
  AsciiDict(7927) = "y"
  AsciiDict(7928) = "Y"
  AsciiDict(7929) = "y"
  AsciiDict(8363) = "d"
End Sub 
```

3.  最后，我们创建一个调用`StripDiacritics()`来规范化文本的函数。在“Project - VBAProject”面板中，双击 Modules / Module1 以打开模块范围（如果您没有看到它，则必须通过右键单击 ThisWorkbook 并选择 Insert / Module 来添加它） . 将以下代码粘贴到那里（下`Option Explicit`）：

```
'Dictionary initiated in Workbook_Open()
Public AsciiDict As New Scripting.Dictionary

Function StripDiacritics(Text As String) As String
  Text = Trim(Text)
  If Text = "" Then Exit Function
  Dim Char As String, _
    NormalizedText As String, _
    UnicodeCharCode As Long, _
    i As Long
  'Remove accent marks (diacritics) from text
  For i = 1 To Len(Text)
    Char = Mid(Text, i, 1)
    UnicodeCharCode = AscW(Char)
    If (UnicodeCharCode < 0) Then
      'See http://support.microsoft.com/kb/272138
      UnicodeCharCode = 65536 + UnicodeCharCode
    End If
    If AsciiDict.Exists(UnicodeCharCode) Then
      NormalizedText = NormalizedText & AsciiDict.Item(UnicodeCharCode)
    Else
      NormalizedText = NormalizedText & Char
    End If
  Next
  StripDiacritics = NormalizedText
End Function 
```

4.  保存并重新打开电子表格，以便正确启动映射字典。

**用法：**

`=StripDiacritics("Hermès Prêt à Porter")` 输出“Hermes Pret a Porter” `=StripDiacritics("Việt Nam Textiles")` 输出“Viet Nam Textiles”

对于那些好奇的人，可以在这里找到完整的映射：[https](https://goo.gl/Vvn9px) ://goo.gl/Vvn9px 。字典键对应于 Dec 列。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-11-06T00:07:32.970

```
Function stripAccent(Text As String) As String

    Const AccChars = "ŠŽšžŸÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖÙÚÛÜÝàáâãäåçèéêëìíîïðñòóôõöùúûüýÿ"
    Const RegChars = "SZszYAAAAAACEEEEIIIIDNOOOOOUUUUYaaaaaaceeeeiiiidnooooouuuuyy"

    Dim A As String * 1
    Dim B As String * 1
    Dim i As Integer

    For i = 1 To Len(AccChars)
        A = Mid(AccChars, i, 1)
        B = Mid(RegChars, i, 1)
        Text = Replace(Text, A, B)
    Next

    stripAccent = Text

End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T17:16:40.833

你的意思是宏对话框中的宏列表？如果是这样，那是因为范围参数，宏对话框将只列出没有参数的程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T17:30:35.400

您可以将 userForm 与 refEdit 和按钮控件一起使用。调用表单的例程类似于：

```
Sub ShowForm()

    Dim d As dlg
    Set d = New dlg

    d.Show

    Set d = Nothing

End Sub 
```

...并在按钮的单击事件中：

```
Private Sub cmdBtn_Click()

    On Error GoTo cmdBtn_Click_Err

    Dim strRange As String
    Dim rng As Range

    strRange = refeditControl.Text

    Set rng = Range(strRange)        

    Call StripAccent(rng)        

cmdBtn_Click_Exit:
    Exit Sub

cmdBtn_Click_Err:
    MsgBox Err.Description
    Resume cmdBtn_Click_Exit

End Sub 
```

假设userForm名称为dlg，按钮cmdBtn和refEdit控件为refEditControl。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-17T11:44:23.870

@notGeek 提供的功能`stripAccent`对我有用，只是它将小写重音字符转换为大写非重音字符。

这似乎是因为`Replace`默认情况下该函数不区分大小写。这可以通过添加如下比较设置来`vbBinaryCompare`改变

```
Text = Replace(Text, A, B, , , vbBinaryCompare) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-05T06:49:12.743

使用此代码从字符串中删除特殊字符。

```
Function Remove(Str As String) As String
    Dim xChars As String
    Dim I As Long
    xChars = "/.',_#$%@!()^*&"
    For I = 1 To Len(xChars)
        Str = Replace$(Str, Mid$(xChars, I, 1), "")
    Next
    Remove = Str
End Function 
```

# c# - Accessing the current HttpContext from a workflow Activity?

> ID：10032324
> 
> 赞同：1
> 
> 时间：2012-04-05T16:23:40.340
> 
> 标签：c#, asp.net-mvc, workflow-foundation-4

I have an .NET 4.0 ASP.NET MVC application, which also hosts a Workflow Foundation 4.0\. From within this workflow, some custom workflow activity will execute code to do some database updates using Linq to SQL. The code consists of calling a method, which in turn call some other methods etc... I also have a business layer which has a data access factory, providing access to all of my data access objects containing the methods for database operations.

Now suppose I my WF activity calls method A , which in turn calls method B in another class, which calls method C end D in yet another class. In each of these methods I want to retrieve the same instance of my data accesss factory, so that all database operations are excuted on the same database transaction. How would I design the singleton pattern for my data access factory? Note that methods A, B, C and D also can be called from Asp.Net MVC controllers.

When methods A, B,C and D are called from asp.net mvc controllers, its easy, I can use the HttpContext to store my data access factory singleton, so that within one http request I also get the same instance of my data access factory.

But when these methods are called from the Workflow activity, there is no HttpContext of course. I tried thread static variable, but in web applications you're not sure, method A, B, C en D will be called on the same thread. I also tried CallContext, but I experienced, I'm not always retrieving the same instance, so apparently CallContext is not the solution either.

Basically, the problem can be summarized as 'getting the same instance of an object in a background process running in an asp.net application' (it doesn't matter whether this background task is kicked of by the WF activity or another way of background tasks e.g. using Task<T>)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:28:24.777

与您的问题没有真正的关系，但在 asp.net 应用程序中执行后台任务很糟糕，我从经验中说。

[在 ASP.NET 中实现重复后台任务的危险](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20haacked%20%28you%27ve%20been%20HAACKED%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:29:58.003

由于您的对象需要跨进程和内存空间，因此我将创建一个 WCF 服务，将您的工厂作为单例实例托管。这样，MVC 应用程序可以调用它，WF 应用程序可以调用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T20:39:47.577

我知道这很旧，但我认为这也会有所帮助。

[在拦截器上检查时，HttpContext.Current 为空](https://stackoverflow.com/questions/10794183/httpcontext-current-is-null-when-checked-on-interceptor)

在运行工作流服务 (.xamlx) 时，您希望将 OperationContext 与您的实体对象一起使用。

# android - Playing HLS without Android OS support for .ts files

> ID：10032326
> 
> 赞同：1
> 
> 时间：2012-04-05T16:23:46.410
> 
> 标签：android, codec, http-live-streaming

I have developed an HLS player for Android 2.3\. It works. However, I am finding that certain Android devices lack support for .ts files. On these phones my player does not work. So, my question is this: Is there a way that I can include support for these files within my app (perhaps a codec or a library of some sort)? After exhaustive searching, I'm really not sure where to go.

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T18:08:17.677

尝试使用 NDK 将 FFMPEG 移植到 Android，我认为这是解决您播放问题的最佳解决方案。我现在就是这样，我可以向你报告我的进展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-16T21:01:56.147

你可以看看[vitamio](http://vov.io/vitamio/)。我认为如果在尚不支持 ts 文件的设备上安装了 vitamio，您的播放器将可以正常工作。

# objective-c - MGSplitViewController won't dismiss itself when master button is clicked a second time

> ID：10032327
> 
> 赞同：0
> 
> 时间：2012-04-05T16:23:46.680
> 
> 标签：objective-c, uisplitviewcontroller, uibarbuttonitem

This is basically in continuation of: [Dismissing iPad UIPopoverController when BarButtonItem is pushed while it's open](https://stackoverflow.com/questions/2642405/dismissing-ipad-uipopovercontroller-when-barbuttonitem-is-pushed-while-its-open), however I see the issue as large enough that it warranted another question.

Basically, they wanted to show the popover when the barbuttonitem (provided by the splitviewcontroller) is clicked, and then hide the popover when the same barbuttonitem is clicked again. They solved it by calling:

```
- (void)splitViewController:(UISplitViewController*)svc popoverController:(UIPopoverController*)pc willPresentViewController:(UIViewController *)aViewController{
    if ([popoverController isPopoverVisible]) {
        [popoverController dismissPopoverAnimated:YES];
    }
} 
```

However, I've come to the problem where on the first click of the barbuttonitem, this method is called correctly and it displays the popover. However, on any subsequent clicks of the barbuttonitem while the popover is open, this method is not called.

More puzzling, when I close the popover view through other means (clicking outside of the popover), then the popover closes automatically. However, a click on the button itself does not close the popover, nor does it call that "willPresentViewController" method.

Are there other means of catching this button click action? Or any thoughts on why the method is not called on a click of the button while the popover is open?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T15:51:30.730

因此，当您再次单击“主”按钮时，似乎正常的 UISplitViewController 会自动关闭，但是，我使用的是 MGSplitViewController。所以我修改了 MGSplitViewController.m （特别是 showMasterPopover :) 来处理当它第二次单击按钮时自行解散，如下所示：

```
-(IBAction)showMasterPopover:(id)sender
{
    if (_hiddenPopoverController && !(_hiddenPopoverController.popoverVisible)) 
    {
        // Inform delegate.
        if (_delegate && [_delegate respondsToSelector:@selector(splitViewController:popoverController:willPresentViewController:)]) 
        {
            [(NSObject <MGSplitViewControllerDelegate> *)_delegate splitViewController:self popoverController:_hiddenPopoverController willPresentViewController:self.masterViewController];
        }
        // Show popover.
        [_hiddenPopoverController presentPopoverFromBarButtonItem:_barButtonItem permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
    }
    else if(_hiddenPopoverController && _hiddenPopoverController.popoverVisible)
    {
        [_hiddenPopoverController dismissPopoverAnimated:YES];
    }
} 
```

# c# - Searching an array of XML Nodes

> ID：10032330
> 
> 赞同：-2
> 
> 时间：2012-04-05T16:24:24.443
> 
> 标签：c#, xml, linq, xmldocument

I have an array of `System.Xml.XmlNode` with data similar to this:

```
[0] = <Node1 xmlns="---">N1Data</Node1>

[1] = <Node2 xmlns="---">N2Data</Node2>

[2] = <Node3 xmlns="---">N3Data</Node3> 
```

Using LINQ, how could I select the inner data of Node2? This seems trivial with an XDocument, but my data format is nonnegotiable as it's supplied by an external resource.

Thanks in advance.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:43:23.517

像这样，也许？

```
XmlNode[] nodes = ...;
string value = nodes.Single(n => n.LocalName == "Node2").InnerXml;
// or .InnerText, depending on what you need. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:08:21.160

**新答案**`XDocument`：根据作者的要求，完全更改为根本不使用：

```
string[] elementArray = new[]
{
    "<Node1 xmlns=\"foo\">Bar</Node1>",
    "<Node2 xmlns=\"foo\">Bar</Node2>",
    "<Node3 xmlns=\"foo\">Bar</Node3>"
};

var search = "Node2";
string result = elementArray
    .Where(x => x.Split(' ').First().Substring(1) == search)
    .Select(x =>
    {
        int closeBrace = x.IndexOf(">");
        int openBrace = x.IndexOf("<", closeBrace);
        return x.Substring(closeBrace + 1, openBrace - closeBrace - 1);
    })
    .Single(); 
```

# actionscript-3 - 如何将错误附加到 FormItem（不是 errorString）

> ID：10032331
> 
> 赞同：0
> 
> 时间：2012-04-05T16:24:29.477
> 
> 标签：actionscript-3, apache-flex

我想将错误附加到 formItem。在 spark 中，似乎它在验证 textInput 时出现错误时呈现的标准方式是将 textInput 与红色接壤，在 textInput 旁边放置一个黄色警报图标，并将错误消息放置在与右侧对齐的 formItem 中。

如何为自定义 formItem 失效手动执行此操作，以便我可以符合错误显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:14:48.767

在 FormItem 上设置 errorString 将导致当您将鼠标悬停在 FormItem 上时出现错误工具提示。

```
<mx:FormItem label="Pick some numbers!" x="10" y="10" errorString="Error!">
  <mx:CheckBox label="One"/>
  <mx:CheckBox label="Two"/>
  <mx:CheckBox label="Three"/>
</mx:FormItem> 
```

没有悬停：

![在此处输入图像描述](../Images/fc84a96925800942be9d2a0f53f96228.png)

徘徊：

![在此处输入图像描述](../Images/b71998234f30bf387b0dc324e9bfd331.png)

# .net - 如何在 .Net 中将上传的 RGB 格式的图像转换为 CMYK 格式？

> ID：10032335
> 
> 赞同：2
> 
> 时间：2012-04-05T16:24:50.033
> 
> 标签：.net, rgb, cmyk

我需要以 CMYK 格式转换和保存图像。当我上传了 RGB 格式的图像后，我需要将其转换为 CMYK。在.Net中可能吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:50:57.210

正如其他人提到的，.NET 本身并不支持图像色彩空间调整。

然而，[ImageMagick](http://www.imagemagick.org/script/index.php)是优秀的免费软件套件，它允许您使用 -colorspace 或 -profile 选项来执行此操作。

允许您使用 ImageMagick 的 .NET 库被命名为[ImageMagick.NET](http://imagemagick.codeplex.com/)，它可以从[Codeplex](http://imagemagick.codeplex.com/) ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:05:32.690

我不知道关于 .Net 的第一件事，但我看到一个网站，您可以在其中对最大 5mb 的图像文件执行免费的 RGB 到 CMYK 转换。您可以选择众多 CMYK 配置文件。对于美国商业胶印，我会推荐 GRACoL2006_Coated1v2.icc，对于杂志/卷筒纸胶印，我会使用 SWOP2006_Coated3v2.icc

```
 http://www.rgb2cmyk.org/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T17:25:22.120

.NET 中没有本机 CMYK 支持。您将需要第三方库或服务，或者自己编写。将图像转换为 CMYK 并不是很简单，并且每个目的都会有不同的要求，因此您确实需要更好地定义要求才能决定使用哪种方法。

编辑：侧边栏有一个链接到以前有一些答案的问题：[将 RGB 颜色转换为 CMYK？](https://stackoverflow.com/questions/2426432/convert-rgb-color-to-cmyk)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-22T15:55:22.893

您可以使用 ImageMagick for .Net（称为[Magick.Net](https://magick.codeplex.com/) ）来完成此操作。您可以通过 Nuget 安装它，而且它是免费的。

Magick.Net 中的颜色配置文件转换非常令人困惑。您可能想知道它是`magick.TransformColorSpace`. 还是基于某些基于命令行的答案`magick.Negate()`. 但这两者都不是。相反，您“添加”现有的 ColorProfile，这感觉不对，然后添加您要转换到的颜色配置文件，Magick.Net 会在后台为您处理转换的详细信息。

```
// Tell ImageMagick this is RGB
magick.AddProfile(ColorProfile.SRGB);
// Tell it to convert it.
magick.AddProfile(ColorProfile.USWebCoatedSWOP); 
```

另请参阅[https://magick.codeplex.com/wikipage?title=Convert%20image](https://magick.codeplex.com/wikipage?title=Convert%20image)

[与此相反，CMYK 到 RGB，在此处得到解答](https://stackoverflow.com/a/18918798/176877)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-14T15:01:37.003

此处已对此进行了回答：[.NET TIFF 文件：RGB 到 CMYK 的转换是否可以在没有第三方库的情况下进行？](https://stackoverflow.com/questions/623636/net-tiff-file-rgb-to-cmyk-conversion-possible-without-a-third-party-library)

我相信答案来自这里的讨论：http: [//social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/0a4fecba-6212-4e72-9e10-7874c6327e7a/](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/0a4fecba-6212-4e72-9e10-7874c6327e7a/)

但该答案仅限于以 tiff 格式输出。

# html - HTML 中的链接图像不会在 Outlook 2010 中下载

> ID：10032336
> 
> 赞同：0
> 
> 时间：2012-04-05T16:24:50.567
> 
> 标签：html, outlook, outlook-2010

当我在电子邮件中包含以下 HTML 时，Outlook 会自动下载图像：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head></head><body><div><p><br /></p></div><div style="border-style:solid;border-width:2px;border-color:rgb(0,0,0);background-color:rgb(255,232,0);width:302px;height:185px"><img style="position:relative;z-index:100;left:126px; top:39px;" src="https://s3.amazonaws.com/signoffmainbucket/8CA8EC1A-C1C5-4390-9FC4-649648AA26C8.jpg" alt="image"/><p style="opacity:1.00;color:rgb(0,0,0);position:relative;margin: -123px 0px 0px 18px;font-family: Helvetica, Helvetica;font-size:14px"><b>John</b></p><br /><br /><br /><br /><p style="opacity:1.00;color:rgb(0,0,0);position:relative;margin: 0px 0px 0px 18px;font-family: Helvetica, Helvetica;font-size:14px"><b>XYZ Company</b></p><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></body></html> 
```

但是，Outlook 不会自动下载以下 HTML 中的相同图像：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Render this</title>
    <style type="text/css">
        div, p {
            margin:0;
            padding:0;
            font-family: Helvetica;
            font-size:14px;
            color:#000;
            font-weight:bold;
        }
        div.box {
            padding:15px;
            width:272px;
            height:155px;
            border:2px solid #000;
            background-color:rgb(255,232,0);
        }
        div.box div.inner {
            height:100%;
            background:url("https://s3.amazonaws.com/signoffmainbucket/8CA8EC1A-C1C5-4390-9FC4-649648AA26C8.jpg") bottom right no-repeat;
        }
        p.name {
            margin-bottom:65px;
        }
    </style>
</head>
<body>
    <div class="box">
        <div class="inner">
            <p class="name">John</p>
            <p>XYZ Company</p>
        </div>
    </div>
</body>
</html> 
```

为什么会在第一个示例中下载图像而不是第二个示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:30:42.337

电子邮件客户端不提供完整的 CSS 支持。[这些表格](http://www.campaignmonitor.com/css/)表明这是一场噩梦……据他们说，Outlook 2000-2003 确实支持`background-image`，但在 Outlook 2007 和 2010 中被删除了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:34:04.720

That's because creating HTML emails suck. Outlook, since 2007 I believe, switched from using Internet Explorer's renderer to using a Word based HTML renderer. This makes CSS support extremely limited. Your best hope at making an HTML email without losing your mind is to use tables to structure your content and use inline styles right on the elements. Yes, to reach the widest possible audience with HTML emails you have to code like it's 1997.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T20:16:39.820

Outlook 2007 和 2010 不支持背景图像，因为这些应用程序中的 Web 浏览器不是 IE。它是微软的 Word。您必须使用 VML 来设置背景图像（我知道，我必须这样做）。

这是一个关于 VML hack 的页面。

[http://www.campaignmonitor.com/blog/post/3363/updated-applying-a-background-image-to-html-email/](http://www.campaignmonitor.com/blog/post/3363/updated-applying-a-background-image-to-html-email/)

您还可以订阅 MSNBC 的时事通讯，并在他们的时事通讯标题中查看它是如何完成的（我的杰作）。

# r - R的文本挖掘包...添加新函数getTransformation

> ID：10032341
> 
> 赞同：0
> 
> 时间：2012-04-05T16:25:38.023
> 
> 标签：r, text-mining, stemming, corpus

我正在尝试添加一个使用表格查找方法工作的新词干分析器。如果 h 是包含词干提取操作的散列，则其编码如下：在词干提取之前将键作为词，在词干之后作为词的值。

我想理想地添加一个自定义哈希，允许我执行以下操作

myCorpus = tm_map(myCorpus, replaceWords, h)

replaceWords 函数应用于 myCorpus 中的每个文档，并使用哈希来阻止文档的内容

这是我的 replaceWords 函数的示例代码

```
$hash_replace <- function(x,h) {
if (length(h[[x]])>0) {
    return(h[[x]])
} else {
    return(x)
}
}

replaceWords <- function(x,h) {
y = tolower(unlist(strsplit(x," ")))
y=y[which(as.logical(nchar(y)))]
z = unlist(lapply(y,hash_replace,h))
return(paste(unlist(z),collapse=' '))
} 
```

尽管这可行，但转换后的语料库不再包含“TextDocument”或“PlainTextDocument”类型的内容，而是“character”类型的内容

我尝试使用

```
return(as.PlainTextDocument(paste(unlist(z),collapse=' '))) 
```

但这在尝试运行时给了我一个错误。

在 R 的 tm 包的早期版本中，我确实看到了一个允许同义词和基于 WORDNET 的替换的 replaceWords 函数。但是我在当前版本的 tm 包中不再看到它（尤其是当我调用函数 getTransformations() 时）

有没有人对我如何实现这一点有想法？

任何帮助是极大的赞赏。

干杯，希瓦尼

谢谢， Shivani Rao

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T17:48:54.603

您只需要使用该`PlainTextDocument`函数而不是`as.PlainTextDocument`. R 会自动返回函数中的最后一条语句，所以如果你只写最后一行，它就可以工作

```
PlainTextDocument(paste(unlist(z),collapse=' ')) 
```

# django - 如何在facebook APP页面中使用open graph

> ID：10032344
> 
> 赞同：2
> 
> 时间：2012-04-05T16:26:04.200
> 
> 标签：django, facebook, facebook-opengraph

我有一个 facebook 应用程序，我在其中打开我的网站页面。我想在这个应用程序中使用开放图。我的意思是：用户可以看到所有页面，并且可以作为开放图发布。当任何用户点击 Facebook 上的股票链接时，它应该会打开到我的 Facebook 应用程序中。（类似于社交阅读器应用程序）。请告诉我这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:27:38.113

使用[fandjango](https://github.com/jgorset/fandjango)处理您的画布应用程序的身份验证，然后使用[facepy](https://github.com/jgorset/facepy)（由同一开发人员）与 Graph API 进行交互

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T08:26:44.470

使用 Fandjango 进行身份验证，使用 facepy 进行图形 api。

# reporting-services - SSRS 与 Crystal Reports 性能

> ID：10032346
> 
> 赞同：1
> 
> 时间：2012-04-05T16:26:12.917
> 
> 标签：reporting-services, crystal-reports, report

我们正在将 Crystal Reports 转换为 SSRS。我们注意到的一件事是水晶查看器的启动速度比 ssrs 快。但是，在晶体中，它会缓冲剩余的数据。需要明确的是，如果我要求运行 5 条记录。查看器在带有记录集 1 的 Crystal 中启动，但是在所有支持读取完成之前，无法访问记录 2-5。

在 SSRS 中，在查看者可以完全访问记录 1-5 之前，什么都不会显示。

给人一种 Crystal 比 SSRS 更快的错觉。事实上，我已经做了时间测试相同的数据相同的报告。SSRS 在整体请求完成方面每次都击败 Crystal。但是 Crystal 更快地向用户显示信息。

有任何设置或任何东西可以模仿 Crystal 在 SSRS 上的行为吗？

进一步挖掘发现，Crystal Webserver 上的功能是“按需页面”处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:08:40.537

SSRS 将尝试自动执行此操作，但报告定义中有许多内容可能会阻止它。

我认为最有可能的罪魁祸首是在报告级别和页码上进行排序。将排序移到您的查询中，并将它们从您的报表定义中删除。否则，SSRS 需要检索所有数据以确定第一行是什么。

MSDN 上有一些[很好的提示](http://msdn.microsoft.com/en-us/library/bb522806.aspx)。

# javascript - 加载速度更快：大型 JSON 文件，还是需要处理的小型 CSV 文件？

> ID：10032348
> 
> 赞同：3
> 
> 时间：2012-04-05T16:26:30.947
> 
> 标签：javascript, jquery, csv

为了最大的加载速度和页面效率，最好有：

1.  一个 18MB 的 JSON 文件，包含一个字典数组，我可以加载并开始使用它作为原生 JavaScript 对象（例如`var myname = jsonobj[1]['name']`）。
2.  一个 4MB 的 CSV 文件，我需要使用 jquery.csv 插件读取它，然后使用查找来引用：）`var nameidx = titles.getPos('name'); var myname = jsonobj[1][nameidx]`。

我真的不希望有人给我一个明确的答案，但一般的怀疑会非常有用。或者关于如何测量的提示——也许我可以使用开发者工具检查加载速度和效率之间的权衡。

我怀疑在 (1) 中使用本机 JavaScript 对象的任何额外效率都将被 CSV 文件的小得多的大小所抵消，但我想知道其他人是否也这么认为。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T16:30:21.133

您是否考虑过使用 gzip 提供 json 内容 - 这是 gzip 的一些基准[http://www.cowtowncoder.com/blog/archives/2009/05/entry_263.html](http://www.cowtowncoder.com/blog/archives/2009/05/entry_263.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T16:39:08.510

你的情况如何？您是否正在编写一些您知道用户正在使用哪些浏览器并且对带宽有合理期望的 Intranet 站点，或者这是一个面向公众的站点？

如果您可以控制人们使用的浏览器，例如因为他们是您的员工，请考虑利用客户端缓存。如果您试图说服人们使用这些数据，您可能应该考虑将数据分成块并通过 XHR 提供服务。

如果您真的需要一次提供所有服务，那么：

1.  使用 gzip
2.  您是否在客户端对数据进行大量处理？您实际上可能会通过多少项目？如果您在任何给定会话中只能访问不到 1,000 个，那么我认为节省*14MB*是值得的。另一方面，如果您一直在比较各种事物（因为您正在做某种可视化或......任何事情），那么我想 JSON 会得到回报。

换句话说：这取决于。对其进行基准测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:29:47.810

4MB 与 18MB？哪里有问题？Json 现在只是标准格式，如果你使用它，csv 可能同样好。我的意见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T16:30:16.560

14Mb 的数据是一个巨大的差异，但我会首先尝试通过`GZIP/Deflate`服务器端压缩来提供内容，因此，对这些请求进行比较（可能 CSV 请求的内容长度会更好）

然后，我还将尝试[`jsperf`](http://jsperf.com)使用 CSV 和 JSON 数据创建一些具有真实测试用例/常见用法的数据操作测试

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T16:37:04.337

这在很大程度上取决于与用户的连接带宽。

除非这仅由与服务器具有超快速连接的人使用，否则我会说最好的选择是一个更小的文件，它只包含您需要立即显示的实际信息，然后加载根据需要提供更多数据。

# activemq - 作为 ActiveMQ 生产者的身份验证网络共享

> ID：10032351
> 
> 赞同：0
> 
> 时间：2012-04-05T16:26:44.707
> 
> 标签：activemq, messaging

我正在尝试使用 ActiveMQ 建立一个非常基本的消息传递系统。

我有一个网络共享，另一个程序将 XML 文件放入其中。

我有一个 ActiveMQ 路由设置，我认为应该将放入网络共享的文件传送到我的 ActiveMQ 队列。我没有将文件传送到我的队列，我认为这是因为我需要对网络共享进行身份验证。

有人可以帮我弄清楚我需要在我的配置文件中的哪个位置放置我的 NETWORK 用户名和密码，以便 ActiveMQ 可以访问共享吗？

还是我完全错了？除了我的路线外，我正在为 activeMQ 和 Camel 使用开箱即用的配置：

```
<route>

            <description>Leslie Odyssey Route</description>

            <from uri="file://servername.domain.gov/MetroFileDrop"/>

            <to uri="activemq:queue:Odyssey.Queue"/>
</route> 
```

在我的 ActiveMQ 命令提示符控制台中，我看到以下内容：

```
INFO| Route: route2 started and consuming from:
Endpoint[file://servername.domain.gov/MetroFileDrop] 
```

这让我相信路线就在那里，但我从来没有收到任何文件。

感谢您提供任何信息，莱斯利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-11T05:23:10.973

在您的本地硬盘驱动器上创建一个指向您的网络存储的文件夹，并将您的骆驼路线指向该文件夹。骆驼单独不了解网络文件夹。

# xml - 如何使用 groovyUtils.getXmlHolder() 使用 XPath 修改 XML？

> ID：10032352
> 
> 赞同：1
> 
> 时间：2012-04-05T16:26:49.557
> 
> 标签：xml, xpath, groovy

我需要从路径中打开一个 Xml，然后使用 Groovy 脚本修改节点值... 怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T19:14:24.380

我参考了这两个链接以使其正常工作

[http://soapui.org/Scripting-Properties/tips-a-tricks.html#5-change-a-request-xml-from-groovy](http://soapui.org/Scripting-Properties/tips-a-tricks.html#5-change-a-request-xml-from-groovy)

[http://www.soapui.org/apidocs/com/eviware/soapui/support/GroovyUtils.html](http://www.soapui.org/apidocs/com/eviware/soapui/support/GroovyUtils.html)

# ajax - p:datatable 在 ajax 刷新后丢失排序列和顺序

> ID：10032356
> 
> 赞同：10
> 
> 时间：2012-04-05T16:27:09.020
> 
> 标签：ajax, sorting, jsf-2, primefaces, datatable

我在页面上有一个按钮，可以通过 AJAX 请求刷新我的数据表。像这样的东西：

```
<h:form id="datatable">
<p:dataTable/>
</h:form>
<p:commandButton update=":datatable"> 
```

这一切都很好，除了当表被刷新时它恢复为不排序任何东西，同时仍然显示它是根据前一个值排序的。换句话说，标题仍然突出显示，箭头仍然指向排序方向，但实际上没有执行排序。显然这并不理想。

理想情况下，我希望组件将其排序顺序保持在视图状态，然后在 AJAX 请求期间提交正确的参数（以便正确定义排序）。我错过了一个参数还是什么？还有其他人有这个问题吗？

据我所知，表格何时需要排序，它会发布以下选项：

```
<componentID>_sortDir
<componentID>_sortKey
<componentID>_sorting
<componentID>_updateBody 
```

当我刷新表单时，这不会发生。如果我只是刷新表格也不会发生（我想我可以通过直接更新组件来解决问题）。有没有办法让表格正确刷新？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T18:08:26.820

我为@truemmer 的解决方案写了一个扩展。他将排序顺序恢复为默认值，而我的排序顺序将恢复为用户选择的先前排序。

```
function postAjaxSortTable(datatable)
{
    var selectedColumn = datatable.jq.find('.ui-state-active');
    if(selectedColumn.length <= 0)
    {
        return;
    }
    var sortorder = "ASCENDING";
    if(selectedColumn.find('.ui-icon-triangle-1-s').length > 0)
    {
        sortorder = "DESCENDING";
    }
    datatable.sort(selectedColumn, sortorder);
} 
```

像这样更新与 truemmer 作品相同的表：

```
<p:commandButton value="refresh" action="#{tableController.refreshPrices}" update="myTable" oncomplete="postAjaxSortTable(myTableWidget)" /> 
```

编辑：Primefaces 4.0 MultiSort 支持

```
function postAjaxSortTable(datatable) {
    var selectedColumn = undefined;

    // multisort support
    if(datatable && datatable.cfg.multiSort) {
        if(datatable.sortMeta.length > 0) {
            var lastSort = datatable.sortMeta[datatable.sortMeta.length-1];
            selectedColumn = $(document.getElementById(lastSort.col));
        }
    } else {
        selectedColumn = datatable.jq.find('.ui-state-active');
    }

    // no sorting selected -> quit
    if(!selectedColumn || selectedColumn.length <= 0) {
        return;
    }

    var sortorder = selectedColumn.data('sortorder')||"DESCENDING";
    datatable.sort(selectedColumn, sortorder, datatable.cfg.multiSort);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-17T09:41:59.720

首先，[PrimeFaces 问题跟踪器](http://code.google.com/p/primefaces/issues/detail?id=3887)上有一张未解决的票，它针对这个问题，但最近被标记为“不会修复”。

不过，我找到了一个很好的解决方法。PrimeFaces 表的排序可以通过在数据表的小部件上调用未记录的 JavaScript 方法来触发。以下可能不适用于 PrimeFaces 的未来版本，但适用于 3.4.2：

只需将以下内容添加到您的组件中，即可触发更新：

```
oncomplete="myTableWidget.sort($(PrimeFaces.escapeClientId('#{p:component('sortColumnId')}')), 'ASCENDING')" 
```

该表可能如下所示：

```
<p:dataTable id="myTable"
             widgetVar="myTableWidget"
             value="#{myArticles}"
             var="article"
             sortBy="#{article.price}"
             sortOrder="ASCENDING">
    ...

    <p:column id="price" sortBy="#{article.price}">
        <f:facet name="header">
            <h:outputText value="Price" />
        </f:facet>
        <h:outputText value="#{article.price}" />
    </p:column>

</p:dataTable> 
```

所以更新表格可以像这样工作。

```
<p:commandButton value="refresh" action="#{tableController.refreshPrices}" update="myTable" oncomplete="myTableWidget.sort($(PrimeFaces.escapeClientId('#{p:component('price')}')), 'ASCENDING')" /> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-08T15:21:07.020

**编辑：**

下面发布的解决方案 (LazyTable) 适用于支持 LazyDataModel 的 p:dataTable。在所需表的每次更新/刷新后调用重写的**加载**方法，并正确处理排序。简单 p:dataTable 的问题在于它仅在第一次加载时或单击排序列后执行预定义的排序。这是简单表的正常行为。

那么简单表的可能性是什么：

*   更新后不要对表进行排序，而是删除排序列，这样最终用户就不会被误传。将此添加到更新按钮的操作侦听器或操作方法中：

    ```
    UIComponent table  = FacesContext.getCurrentInstance().getViewRoot().findComponent(":dataTablesForm:dataTableId");
    table.setValueExpression("sortBy", null); 
    ```

*   通过脚本手动更新表格的排序。这不是最好的解决方案，但 primefaces 不提供任何客户端功能来“重新排序”表。基本上您知道一次只能对一列进行排序，并且该列有一个 .ui-state-active。您可以在脚本中使用它并在该列上触发 2 次单击（1\. 单击 - 其他排序顺序，2\. 单击 - 返回当前排序顺序）。

    ```
     <h:form id="mainForm">  
    <div id="tableDiv">
       <p:dataTable id="dataTable" var="item" value="#{testBean.dummyItems}">
          .
          .
          .
       </p:dataTable> 
       <p:commandButton value="Refresh" oncomplete="refreshSort();" update=":mainForm:dataTable"/>
     </div> 
    ```

    和脚本功能：

    ```
    function refreshSort(){
    jQuery('#tableDiv').find('.ui-state-active').trigger('click');
    jQuery('#tableDiv').find('.ui-state-active').trigger('click');
    } 
    ```

我知道这不是最好的解决方法，但它确实有效。你可以用它作为灵感，让事情变得更好。

### 懒表

恕我直言，最合适的方法是直接更新您想要的组件。例如：

```
<h:form id="dataTableForm">
  <p:dataTable id="dataTableToUpdate">
    .
    .
    .
  </p:dataTable>
  <p:commandButton value="Refresh" update=":dataTableForm:dataTableToUpdate" />
</h:form> 
```

在这种情况下它应该可以正常工作（我想这是您的目的）：使用 p:dataTable 打开 .xhtml，对某些列进行排序（保持 facelet 打开），例如从另一个 .xhtml 更新 dataTables 数据，单击刷新按钮. dataTable 应该以正确的（先前选择的）排序顺序显示您的附加值 - 排序是在更新后执行的。

希望它有所帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-23T07:27:45.417

将此 PhaseListener 添加到您的应用程序中，并且在更新 DataTable 后将保留排序和过滤。

```
public class DataTableUpdatePhaseListener implements PhaseListener {

    private static final long serialVersionUID = 1L;

    @Override
    public void afterPhase(PhaseEvent event) {
        // Nothing to do here
    }

    @Override
    public void beforePhase(PhaseEvent event) {
        FacesContext facesContext = event.getFacesContext();
        if (!facesContext.isPostback()) {
            return;
        }

        PartialViewContext partialViewContext = facesContext.getPartialViewContext();
        if (partialViewContext != null) {
            Collection<String> renderIds = partialViewContext.getRenderIds();

            for (String renderId : renderIds) {
                UIComponent component = facesContext.getViewRoot().findComponent(renderId);
                if (component instanceof DataTable) {
                    DataTable table = (DataTable) component;
                    if (!table.isLazy()) {
                        updateDataTable(table);
                    }
                }
            }
        }
    }

    @Override
    public PhaseId getPhaseId() {
        return PhaseId.RENDER_RESPONSE;
    }

    private void updateDataTable(DataTable table) {
        FacesContext facesContext = FacesContext.getCurrentInstance();
        if (facesContext == null || table == null) {
            return;
        }

        // Reapply filtering
        if (!table.getFilters().isEmpty()) {
            FilterFeature filterFeature = new FilterFeature();
            filterFeature.decode(facesContext, table);
        } else {
            table.setFilteredValue(null);
        }

        // Reapply sorting
        ValueExpression tableSortByVE = table.getValueExpression("sortBy");
        if (tableSortByVE != null) {
            String tableSortByExpression = tableSortByVE.getExpressionString();

            // Loop on children, that are the columns, to find the one whose order must be applied.
            for (UIComponent child : table.getChildren()) {
                Column column = (Column) child;
                ValueExpression columnSortByVe = column.getValueExpression("sortBy");
                if (columnSortByVe != null) {
                    String columnSortByExpression = columnSortByVe.getExpressionString();

                    if (tableSortByExpression != null && tableSortByExpression.equals(columnSortByExpression)) {
                        // Now sort table content
                        SortFeature sortFeature = new SortFeature();
                        sortFeature.sort(facesContext, table, tableSortByVE,
                                SortOrder.valueOf(table.getSortOrder().toUpperCase(Locale.ENGLISH)),
                                table.getSortFunction());

                        break;
                    }
                }
            }
        }
    }
} 
```

这适用于非惰性数据表。使用惰性模型的数据表不需要这样做，因为惰性模型将负责排序和过滤。对于非惰性数据表，这应该适用于单列和多列排序，但 Primefaces 中存在一个错误，导致 DataTable 在更新表时在回发之间失去其 MultiSortMeta。这意味着在回发之前选择用于排序的列完全从 FacesContext 和组件状态中丢失，并且在回发时无法再检索。如果我设法找到解决方法，或者 Primefaces 很快会修复它，我稍后会对此进行更多研究并提供更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T21:42:06.203

我和你有同样的问题。我能够使用[LazyDataModel](http://www.primefaces.org/showcase/ui/datatableLazy.jsf)解决问题。由于[行索引的 PrimeFaces 问题](http://code.google.com/p/primefaces/issues/detail?id=1544)，我需要添加额外的 UtilitiesLazyDataModel（请参阅行索引注释）：

```
public abstract class UtilitiesLazyDataModel <T> extends LazyDataModel<T>{

    public UtilitiesLazyDataModel() {
    }    

    @Override
    public void setRowIndex(int rowIndex) {
        /*
         * The following is in ancestor (LazyDataModel):
         * this.rowIndex = rowIndex == -1 ? rowIndex : (rowIndex % pageSize);
         */
        if (rowIndex == -1 || getPageSize() == 0) {
            super.setRowIndex(-1);
        } else {
            super.setRowIndex(rowIndex % getPageSize());
        }      
    }
} 
```

然后使用你的`LazyDataModel`类：

```
public class MyDataModel extends UtilitiesLazyDataModel<MyObjectClass>{

//override getRowData and getRowKey

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-03T13:26:14.000

@Rares Oltean 的方法也可以使用 preRenderView 事件监听器来实现。在您的 jsf 页面上注册侦听器：

```
<f:event listener="#{managedBean.preRenderViewListener}" type="preRenderView" /> 
```

并在 ManagedBean 中实现它：

```
public void preRenderViewListener() {
    FacesContext facesContext = FacesContext.getCurrentInstance();
    if (!facesContext.isPostback()) {
        return;
    }

    PartialViewContext partialViewContext = facesContext.getPartialViewContext();
    if (partialViewContext != null) {
        Collection<String> renderIds = partialViewContext.getRenderIds();

        for (String renderId : renderIds) {
            UIComponent component = facesContext.getViewRoot().findComponent(renderId);
            if (component instanceof DataTable) {
                DataTable table = (DataTable) component;
                if (!table.isLazy()) {
                    updateDataTable(table);
                }
            }
        }
    }
}

private void updateDataTable(DataTable table) {
    FacesContext facesContext = FacesContext.getCurrentInstance();
    if (facesContext == null || table == null) {
        return;
    }
    if (!table.getFilters().isEmpty()) {
        FilterFeature filterFeature = new FilterFeature();
        filterFeature.decode(facesContext, table);
    } else {
        table.setFilteredValue(null);
    }
    ValueExpression tableSortByVE = table.getValueExpression("sortBy");
    if (tableSortByVE != null) {
        String tableSortByExpression = tableSortByVE.getExpressionString();
        for (UIComponent child : table.getChildren()) {
            Column column = (Column) child;
            ValueExpression columnSortByVe = column.getValueExpression("sortBy");
            if (columnSortByVe != null) {
                String columnSortByExpression = columnSortByVe.getExpressionString();
                if (tableSortByExpression != null && tableSortByExpression.equals(columnSortByExpression)) {
                    SortFeature sortFeature = new SortFeature();
                    sortFeature.sort(facesContext, table, tableSortByVE, table.getVar(),
                            SortOrder.valueOf(table.getSortOrder().toUpperCase(Locale.ENGLISH)),
                            table.getSortFunction());
                    break;
                }
            }
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-13T21:38:56.657

解决方案是拥有一个会话 bean。在这种情况下，p:dataTable 会刷新表及其条目，而不影响排序顺序。如果您在每一行上都有 ap:commandButton ，则表格刷新也可以正常工作。

会话 bean：

```
@Named
@Stateful
@ConversationScoped
public class ItemBean {

    @Inject
    private Conversation conversation;

    private List<Item> items;

    public List<Item> getItems() {
        return this.items;
    }

    public void retrieve() {
        // if it's an Ajax call then avoid retrieving items
        if (FacesContext.getCurrentInstance().isPostback()) {
            return;
        }
        // start a conversation
        if (this.conversation.isTransient()) {
            this.conversation.begin();
        }
        this.items = retrieveItems();
    }
} 
```

相关页面：

```
<f:metadata>
    <f:event type="preRenderView" listener="#{itemBean.retrieve}" />
</f:metadata>

<h:form id="form">
    <p:dataTable id="table" var="_item" value="#{testBean.items}">
    ... <!-- you can have the p:commandButton in a column too, to refresh the respective column only
        <p:commandButton value="Refresh" action="#{itemBean.update(_item)}" 
        -->
    </p:dataTable> 
    <p:commandButton value="Refresh" action="#{itemBean.update}" update=":form:table"/>
</h:form> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-02T18:40:24.853

我用我的 toString() 方法实现了一个比较器

```
municipios = municipioFacade.findAll();
Collections.sort(municipios, new DefaultComparator());
UIComponent table = FacesContext.getCurrentInstance().getViewRoot().findComponent(":municipios:municipios-tabla");
    table.setValueExpression("sortBy", null); 
```

**比较器**

```
public class DefaultComparator implements Comparator {

    @Override
    public int compare(Object o1, Object o2) {
        return o1.toString().compareToIgnoreCase(o2.toString());
    }
} 
```

# iphone - 将图像保存到自定义库

> ID：10032361
> 
> 赞同：5
> 
> 时间：2012-04-05T16:27:28.550
> 
> 标签：iphone, objective-c, alassetslibrary

我有一个应用程序将图像存储到 iphone 相册中的自定义库中。

我调用了 ALAssetLibrary 的以下函数

```
-(void)saveImage:(UIImage*)image toAlbum:(NSString*)albumName withCompletionBlock:(SaveImageCompletion)completionBlock
{
    //write the image data to the assets library (camera roll)
    [self writeImageToSavedPhotosAlbum:image.CGImage orientation:(ALAssetOrientation)image.imageOrientation 
                        completionBlock:^(NSURL* assetURL, NSError* error) {

                          //error handling
                          if (error!=nil) {
                              completionBlock(error);
                              return;
                          }

                          //add the asset to the custom photo album
                          [self addAssetURL: assetURL 
                                    toAlbum:albumName 
                        withCompletionBlock:completionBlock];

                      }];
} 
```

在我的 SaveImage IBAction

```
-(IBAction)saveToLib:(id)sender
{
    UIImage *savedImage = imgPicture.image;
    NSLog(@"Saved Image%@",savedImage);
    [self.library saveImage:savedImage toAlbum:@"Touch Code" withCompletionBlock:^(NSError *error) {
        if (error!=nil) {
            NSLog(@"Big error: %@", [error description]);
        }
    }];
} 
```

但我的应用程序不断崩溃帮助我提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:49:14.860

您似乎没有正确调用 [self.library saveImage:savedImage toAlbum:@....]。如果您正在关注此[网站](http://www.touch-code-magazine.com/ios5-saving-photos-in-custom-photo-album-category-for-download/)，请在您的视图控制器中添加#import "ALAssetsLibrary+CustomPhotoAlbum.h"。

不确定是否是问题所在。抱歉，如果此解决方法是错误的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T09:17:34.823

问题是他下载的网站上的文件。

我有同样的问题，自己重写代码解决了这个问题。

也许编码或类似的东西......

# asp.net - Facebook Insights API 到 asp.net（不是应用程序）

> ID：10032362
> 
> 赞同：1
> 
> 时间：2012-04-05T16:27:35.980
> 
> 标签：asp.net, vb.net, facebook, api, facebook-insights

我们正在尝试帮助我们的客户从 FB 中获取他们的公司页面 FB Insights 数据，并显示在我们为客户提供的管理网站上。因此，他们不必登录 FB 来查看见解，他们将能够从我们已经为他们提供的分析网站中查看数据（我们放入报告中）。

我们只是不知道如何使用 FB API 为使用 VB 作为编程语言的 asp.net 应用程序中的单个粉丝页面提取数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T16:39:31.680

您是否尝试使用 Facebook C# SDK 并尝试访问洞察对象： [https ://developers.facebook.com/docs/reference/api/insights/](https://developers.facebook.com/docs/reference/api/insights/)

您必须是 App/Page 的管理员才能使其正常工作。

# android - 方向更改时未加载不同的片段（android）

> ID：10032373
> 
> 赞同：6
> 
> 时间：2012-04-05T16:28:16.220
> 
> 标签：android, android-fragments, orientation-changes

我创建了一个测试[项目](http://dl.dropbox.com/u/29396384/OrientationTest.zip)，它有两个不同的片段要显示在同一个活动中。一个片段用于横向，另一个用于纵向。

```
# My unique activity
public class MainActivity extends FragmentActivity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    }
}

# First Fragment
public class LandscapeFragment extends Fragment {
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        TextView v = (TextView) inflater.inflate(R.layout.fragment, container, false);
        v.setText("LANDSCAPE");
        return v;
    }
}

# Other Fragment
public class PortraitFragment extends Fragment {
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        TextView v = (TextView) inflater.inflate(R.layout.fragment, container, false);
        v.setText("PORTRAIT");
        return v;
    }
} 
```

我有两个 main.xml，一个在 layout/ 中，另一个在 layout-land/ 中。每个 main.xml 都指向要使用的正确片段。

```
<!-- layout-land/main.xml  -->
<?xml version="1.0" encoding="utf-8"?>
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/fragment"
    android:name="br.luckcheese.test.LandscapeFragment"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginTop="5dp" />

<!-- layout/main.xml  -->
<?xml version="1.0" encoding="utf-8"?>
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/fragment"
    android:name="br.luckcheese.test.PortraitFragment"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginTop="5dp" />

<!-- layout/fragment.xml  -->
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:textSize="30sp" /> 
```

当我以横向打开应用程序时，会显示 LandscapeFragment，当我以纵向打开应用程序时，会显示 PortraitFragment。到目前为止，一切都很好。

但是，如果我以横向打开并将设备旋转到纵向，则 LandscapeFragment 将重新加载并显示。这不是预测的行为。PortraitFragment 应该已加载。

同样的事情反过来也会发生，如果设备从纵向开始，然后我将其旋转到横向：PortraitFragment 只是重新加载，而不是加载 LandscapeFragment。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T15:21:00.117

确保你没有：`android:config="orientation"`在你的 manifest.xml

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T07:37:40.467

问题出在您的 2 个布局中，片段 ID 相同。只需更改这些片段 ID，例如：

布局/main.xml 的片段肖像

用于 layout-land/main.xml 的 fragmentlanscape。（并且还要更改： Fragment frag = getSupportFragmentManager().findFragmentById(R.id.fragment);

frag.setRetainInstance(false); )

# android - 如何使用 SensorManager.getOrientation() 计算“Pitch”和“Roll”

> ID：10032374
> 
> 赞同：1
> 
> 时间：2012-04-05T16:28:17.600
> 
> 标签：android, algorithm, sensors, android-sensors

我目前正在尝试替换我的“Sensor.TYPE_ORIENTATION”，因为它已被弃用。因此，[Android 文档](http://developer.android.com/reference/android/hardware/SensorManager.html#getOrientation%28float%5B%5D,%20float%5B%5D%29)缺少大部分关于如何操作的信息。在此处调试和挖掘[SO](https://stackoverflow.com/questions/4819626/android-phone-orientation-overview-including-compass)时，我想出了如何计算`azimuth`OrientationSensor 曾经提供的值。我这样做：

```
float accelerometerVals[] = new float[3];
float magneticVals[] = new float[3];

float orientationSensorVals[] = new float[3]; 

float rotationMatrix[] = new float[16];
float orientation[] = new float[3];

    @Override
    public void onSensorChanged(SensorEvent event) {
        switch (event.sensor.getType()) {
        case Sensor.TYPE_ACCELEROMETER:
             System.arraycopy(event.values, 0, accelerometerVals, 0, 3);
             break;
        case Sensor.TYPE_MAGNETIC_FIELD:
              System.arraycopy(event.values, 0, magneticVals, 0, 3);
              break;
        case Sensor.TYPE_ORIENTATION:
              System.arraycopy(event.values, 0, orientationSensorVals, 0, 3);
              break;
        default:
              break;
        }

        if (null != magneticVals && null != accelerometerVals){
            SensorManager.getRotationMatrix(rotationMatrix, null, accelerometerVals, magneticVals)
            SensorManager.getOrientation(rotationMatrix, orientation);
            float azimuth = Math.toDegrees(orientation[0])
            //this calculation gives me the Azimuth in the same format that OrientationSensor
            azimuth += (azimuth >= 0) ? 0 : 360
            float FALSE_PITCH = Math.toDegrees(orientation[1])
            float FALSE_ROLL = Math.toDegrees(orientation[2])
        } 
```

注意变量 FALSE_PITCH && FALSE_ROLL。我不知道如何“标准化”（值从 +10 到 -10 不同）这个值，以获得与我之前在 OrientationSensor 中相同的输出

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T08:08:51.227

我遇到了同样的问题，但我很惊讶你的卷子不对，因为它对我来说是正确的。这是我使用的：

```
//Let values[] be your orientation[] variable once in degrees.

// Azimuth scaling
if (values[0]<0) values[0] += 360;

// Pitch scaling
if (values[1]<-90) values[1] += (-2*(90+values[1]));
else if (values[1]>90) values[1] += (2*(90-values[1]));

// Roll scaling
// NOT NEEDED 
```

你能发布方向传感器和你的度数方向[]变量的一些输出吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T14:25:58.173

也许它会帮助你！

```
SensorManager mSensorManager = (SensorManager)getSystemService(SENSOR_SERVICE);
boolean orientok = mSensorManager.registerListener(this, mSensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION), SensorManager.SENSOR_DELAY_UI);

//test if orientation sensor exist on the device
if (!orientok){
        mSensorManager.unregisterListener(this, mSensorManager.getDefaultSensor(Sensor.TYPE_ORIENTATION));
        ((TextView)findViewById(R.id.orient)).setText("no orientation sensor");
    }

public void onSensorChanged(SensorEvent event) {
    switch(event.sensor.getType()){
    case Sensor.TYPE_ORIENTATION:
        onOrientChanged(event);
        break;
                    ...// add other sensor type if you want and create for each one his function like the example below
}

 public void onOrientChanged(SensorEvent event) {
    float azimuth,pitch,roll;
    azimuth = event.values[0];
    pitch = event.values[1];
    roll = event.values[2];
    ((TextView)findViewById(R.id.azimuth)).setText("Axe x "+azimuth);
    ((TextView)findViewById(R.id.pitch)).setText("Axe y "+pitch);
    ((TextView)findViewById(R.id.roll)).setText("Axe z "+roll);
} 
```

# php - 分页 PHP，htaccess

> ID：10032382
> 
> 赞同：1
> 
> 时间：2012-04-05T16:28:51.343
> 
> 标签：php, .htaccess, pagination

我通过以下方式初始化 $page： `$mpage = trim( ( isset( $_GET[ 'mpage' ] ) ? $_GET[ 'mpage' ] : '1' ), '/' );`

对于页面材料，`$_SERVER['REQUEST_URI'])`我 `http://localhost/en/materials`想实现对可用材料的分页，例如`localhost/en/materials?mpage=3 or localhost/en/materials?mpage=2`。

这与htcaccess有关吗？请帮帮我。谢谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-09T13:03:49.113

使用`$_SERVER["SCRIPT_URI"]`代替`$_SERVER["REQUEST_URI"]`：

```
...
$mpage = $_GET['mpage'];
...
$currpage = $_SERVER["SCRIPT_URI"];
... 
```

编辑和编辑 2：固定 $mpage 变量名

更新

问题在于重写，您需要将 QSA 标志添加到所有重定向以“保留”`mpage`参数：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -f                [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule .  -                                  [L]

RewriteRule ^$ index.php                          [QSA,L]
RewriteRule ^admin/?$ admin/index.php             [QSA,L]
RewriteRule ^admin/(.*)$ admin/index.php?page=$1  [QSA,L]
RewriteRule ^(.*)/(.*)$ index.php?lang=$1&page=$2 [QSA,L]
RewriteRule ^(.*)$ index.php?lang=en&page=$1      [QSA,L] 
```

# iphone - 使用 Opengles 着色器显示 YUV420 数据太慢

> ID：10032387
> 
> 赞同：1
> 
> 时间：2012-04-05T16:29:15.930
> 
> 标签：iphone, opengl-es, ffmpeg, yuv

我有一个名为 A 的子线程用于在 iPhone 3GS 上使用 ffmpeg 解码视频，另一个名为 B 的线程用于显示 yuv 数据，在线程 B 中，我使用 glSubTexImage2D 上传 YUV 纹理，然后在着色器中将 yuv 数据转换为 RGB，但帧解码线程中的速率只有 15fps。为什么？

**更新：** 帧大小为 720 * 576。我还发现了一些有趣的事情，如果我不启动显示 YUV 数据的线程，解码线程中计算的帧速率是 22 fps，否则为 15 fps。所以我认为我的显示方法一定是低效的。代码如下。

我在解码线程中有一个回调：

```
typedef struct _DVDVideoPicture
{
   char *plane[4];
   int iLineSize[4];
}DVDVideoPicture;

void YUVCallBack(void *pYUVData, void *pContext)
{
   VideoView *view = (VideoView *)pContext;
   [view.glView copyYUVData:(DVDVideoPicture *)pData];
   [view calculateFrameRate];
} 
```

copyYUVData 方法分别提取 yuv 平面。以下是显示线程方法。

# matlab - 如何在 MATLAB 中初始化封装模块时使用基础工作区变量？

> ID：10032389
> 
> 赞同：0
> 
> 时间：2012-04-05T16:29:25.353
> 
> 标签：matlab

我在基础工作区中有一个名为“uwb”的结构。在 uwb 结构下，我有另一个称为“通道”的结构。在`channel`我有两个变量`a`和`b`. 现在我想创建一个子系统。我想屏蔽块。我的问题是我必须使用变量`a`和`b`掩码子系统的初始化。屏蔽时如何在子系统的初始化命令中包含`a`和？`b`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T13:25:17.307

为子系统创建掩码后：

1.  在子系统封装编辑器中选择*Parameters选项卡以添加可调对话框参数。*
2.  为您需要访问的每个变量添加对话框参数（即调用它们`maska`和`maskb`）。
3.  转到*Initialization*选项卡并添加引用对话框参数名称的初始化代码`maska`和`maskb`. 应用您的更改关闭掩码编辑器窗口。
4.  双击被屏蔽的子系统，系统会提示您输入刚刚设置的两个对话框参数的值。
5.  在文本字段中，键入工作区变量`uwb.channel.a`并将`uwb.channel.b`它们的值分别分配给`maska`和`maskb`。

只要`uwb`模型初始化运行时结构在基础工作区中，掩码子系统就会评估并适当地分配`a`and `b`。

（我刚试了一下，似乎效果很好，这里是模型作为参考：[http](http://sfwn.in/Fejp) ://sfwn.in/Fejp ）

# r - 使用 RPostgreSQL 写入特定模式

> ID：10032390
> 
> 赞同：27
> 
> 时间：2012-04-05T16:29:27.257
> 
> 标签：r, postgresql

我正在使用[RPostgreSQL](http://code.google.com/p/rpostgresql/)来读取和写入数据。从任何模式中读取都可以完美地工作，但我无法写入非公共模式。例如，以下代码在`public`模式中放置一个表，其名称为`myschema.tablex`

```
# write dataframe to postgres 
drv <- dbDriver("PostgreSQL")
con <- dbConnect(drv, host="localhost", user="postgres", password="zzzz", dbname="mydatabase", port="5436")
if(dbExistsTable(con,"myschema.tablex")) {
  dbRemoveTable(con,"myschema.vkt_tablex")}
dbWriteTable(con,"myschema.tablex", dataframe, row.names=F) 
```

我想要做的是将表`tablex`放在 schema 中`myschema`。我还尝试在连接中命名模式：`dbname="mydatabase.myschema"`并尝试`schemaname`我在早期错误中看到的参数。

这些方法都不起作用，所以我想知道是否有另一种方法可以使用。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-08-17T07:19:41.000

用这个：

```
library(RPostgreSQL)
drv <- dbDriver("PostgreSQL")
con <- dbConnect(drv, dbname = "db", host = "host", port = 5432,
                 user = "user", password = "pwd")
dbWriteTable(con, c("yourschema", "yourtable"), value = yourRdataframe)
dbDisconnect(con) 
```

更多详情：[https ://stat.ethz.ch/pipermail/r-sig-db/2011q1/001043.html](https://stat.ethz.ch/pipermail/r-sig-db/2011q1/001043.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-05T17:15:31.693

创建对象的默认架构由[`search_path`](http://www.postgresql.org/docs/current/interactive/runtime-config-client.html#RUNTIME-CONFIG-CLIENT-OTHER). 一种方法是相应地设置它。例如：

```
SET search_path = myschema, public; 
```

我引用[手册](http://www.postgresql.org/docs/current/interactive/runtime-config-client.html#RUNTIME-CONFIG-CLIENT-OTHER)：

> 如果在未指定特定目标架构的情况下创建对象，它们将被放置在搜索路径中列出的第一个架构中。如果搜索路径为空，则会报错。

您还可以将此[设置为角色的默认值](http://www.postgresql.org/docs/current/interactive/sql-alterrole.html)，以便为该角色建立的每个连接自动设置它。更多的：

*   [search_path 如何影响标识符解析和“当前模式”](https://stackoverflow.com/questions/9067335/how-does-the-search-path-influence-identifier-resolution-and-the-current-schema/9067777#9067777)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-11-10T03:52:14.987

如果读者使用较新的包`RPostgres`来执行此操作，则指定模式的代码是：

`dbCreateTable(conn = con, name = Id(schema = "yourschema", table = "yourtable"), fields = yourRdataframe)`

# security - Symfony2：将角色保留为数组或对象？

> ID：10032391
> 
> 赞同：0
> 
> 时间：2012-04-05T16:29:35.260
> 
> 标签：security, symfony, doctrine, roles

角色是否有理由作为一个额外的对象持久存在，或者我应该将它们作为一个数组保存在我的实体`$roles`属性中？`User`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:46:58.230

这取决于。如果您不需要基于角色进行特殊查询和/或不介意将自己锁定到支持数组的特定数据库供应商，那么作为数组持久化就可以了。

# objective-c - 使用变量 iOS 更改背景颜色

> ID：10032393
> 
> 赞同：0
> 
> 时间：2012-04-05T16:29:39.687
> 
> 标签：objective-c, ios, xcode, cocoa

我想用变量更改标签的背景颜色，我该怎么做？

这是我的代码，但我想要一个变量而不是“redColor”

```
[publisherLabel setBackgroundColor:[UIColor redColor]]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:31:50.547

具有 RGBA 值的颜色的变量。

```
UIColor *myColor = [UIColor colorWithRed:100.0/255.0 green:101.0/255.0 blue:102.0/255.0 alpha:1.0]]; 
```

如果需要，您也可以使用 HEX：

```
#define HEXCOLOR(c) [UIColor colorWithRed:((c>>24)&0xFF)/255.0 
 green:((c>>16)&0xFF)/255.0 
 blue:((c>>8)&0xFF)/255.0 
 alpha:((c)&0xFF)/255.0];

// usage:
UIColor* c = HEXCOLOR(0xff00ffff); 
```

# android - 如何从另一个 Activity 或服务调用一个 Activity 的功能？

> ID：10032395
> 
> 赞同：0
> 
> 时间：2012-04-05T16:29:42.757
> 
> 标签：android, class, android-activity, function-call

我需要从一项活动中调用一些函数。但是当我这样做时，它会给出空指针......错误。我以此为例， [http://www.javacodegeeks.com/2010/09/android-text-to-speech-application.html](http://www.javacodegeeks.com/2010/09/android-text-to-speech-application.html)

请参阅第 38 行，说 tts.speak(text, TextToSpeech.QUEUE_ADD, null);

所以，如果我改变了这样的代码......

```
public class TTA extends Activity implements OnInitListener {

... ... ... ...

 public void MYCall()
 {
 tts.speak(text, TextToSpeech.QUEUE_ADD, null);
 }

... ... ...
} 
```

然后将其称为我在另一个活动中的呼叫，就像这样，

```
TTA tta = new TTA();
tta.MYCall(); 
```

它不应该工作吗？它没有，但是当从 TTA 类中调用 MYCall() 时，它可以工作。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T21:50:29.623

很难说出发生了什么，因为您没有提供太多代码来检查。

您是否正在为 Activity 生命周期方法中的文本转语音对象进行设置？如果您只是使用 Activity 实例化这些将不会被调用`new TTA()`，因此很可能您的 Text-To-Speech 对象尚未正确初始化。

但是：我建议重新安排您的代码，以便与文本转语音相关的方法不与特定活动耦合，因为您将在多个地方使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T08:23:21.213

You cannot call `speak()` or `tta.MYCall()` until `onInit()` is called.

Therefore, running your two lines of code is not likely to work all the time.

You need something like this or re-arrange your code:

```
TTA tta = new TTA();
while (!tta.isInitialized())
{
  try
  {
  Thread.sleep(100);
  }
  catch (InterruptedException e)
  {}
}
tta.MYCall(); 
```

# python - 在python中求解非线性方程的动态数量

> ID：10032396
> 
> 赞同：1
> 
> 时间：2012-04-05T16:29:44.220
> 
> 标签：python, dynamic, equation, nonlinear-functions

`Fsolve`in`Scipy`似乎是合适的人选，我只需要动态传递方程的帮助。我提前感谢任何想法。

通过动态，我的意思是方程的数量从一次运行到另一次运行不同，例如我有一种情况：

```
alpha*x + (1-alpha)*x*y - y = 0
beta*x  + (1- beta)*x*z - z = 0
A*x + B*y + C*z = D 
```

我还有另一种情况：

```
alpha*x + (1-alpha)*x*y - y = 0
beta*x  + (1- beta)*x*z - z = 0
gama*x  + (1 -gama)*x*w - w =0
A*x + B*y + C*z + D*w = E 
```

`alpha`, `beta`, `A`, `B`, `C`,`D`和`E`都是常数。`x`, `y`, `z`,`w`是变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:57:24.433

我自己没有使用过 Fsolve，但根据它的文档，它需要一个可调用的函数。像这样的东西可以处理具有未知数量变量的多个函数。请记住，此处的参数必须正确排序，但每个函数只需要一个列表。

```
def f1(argList):
    x = argList[0]
    return x**2
def f2(argList):
    x = argList[0]
    y = argList[1]
    return (x+y)**2
def f3(argList):
    x = argList[0]
    return x/3

fs = [f1,f2,f3]
args = [3,5]
for f in fs:
    print f(args) 
```

对于 Fsolve，您可以尝试这样的事情（未经测试）：

```
def func1(argList, constList):
    x = argList[0]
    y = argList[1]
    alpha = constList[0]
    return alpha*x + (1-alpha)*x*y - y
def func2(argList, constList):
    x = argList[0]
    y = argList[1]
    z = argList[2]
    beta = constList[1]
    return beta*x  + (1- beta)*x*z - z
def func3(argList, constList):
    x = argList[0]
    w = argList[1] ## or, if you want to pass the exact same list to each function, make w argList[4]
    gamma = constList[2]
    return gama*x  + (1 -gama)*x*w - w
def func4(argList, constList):

    return A*x + B*y + C*z + D*w -E ## note that I moved E to the left hand side

functions = []
functions.append((func1, argList1, constList1, args01))
# args here can be tailored to fit your  function structure
# Just make sure to align it with the way you call your function:
# args = [argList, constLit]
# args0 can be null.
functions.append((func1, argList2, constList2, args02))
functions.append((func1, argList3, constList3, args03))
functions.append((func1, argList4, constList4, args04))

for func,argList, constList, args0 in functions: ## argList is the (Vector) variable you're solving for.
    Fsolve(func = func, x0 = ..., args = constList, ...) 
```

# go - 切片类型的初始化方法初始化失败

> ID：10032400
> 
> 赞同：2
> 
> 时间：2012-04-05T16:29:54.650
> 
> 标签：go

我尝试为我自己的类型实现一个初始化方法。然而，在调用该方法后，变量在 main() 中没有改变。我可能还没有完全理解切片是如何工作的，这是我的示例代码

```
package main
import "fmt"

type test [][]float64

func (p *test) init(m, n int){
    tmp := *p
    tmp = make(test, m)
    for i := 0; i < m; i++ {
        tmp[i] = make([]float64, n)
    }
}

func main(){
    var t test
    t.init(10,2)
    fmt.Println(t)
} 
```

我的印象是接收器类型 * 的内容可以更改，但切片似乎并非如此。那么如何正确地将我的初始化函数绑定到我的类型呢？我很确定我这边有误解....我尝试了几种方法，例如

```
var t *test = new(test) 
```

或者

```
func (p *test) init(m, n int){
    tmp := *p
    tmp = append(tmp, make(test, m)...)
    for i := 0; i < m; i++ {
        tmp[i] = append(tmp[i], make([]float64, n)...)
    }
} 
```

等等，但都失败了..

我目前知道的唯一可行的解​​决方案是一个未绑定的方法，它将指针返回到一个新的切片。现在可以这样做，但我想将此作为界面中的先决条件。那么我该如何绑定呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T16:51:00.950

```
func (p *test) init(m, n int){
    tmp = make(test, m)
    for i := 0; i < m; i++ {
        tmp[i] = make([]float64, n)
    }
    *p = tmp
} 
```

你很亲密。上面做你想要的。但是没有理由避免返回一个新切片的函数。这是惯用的，感觉很像用其他语言编写构造函数：

```
func newTest(m, n int) test {
    t = make(test, m)
    for i := range t {
        t[i] = make([]float64, n)
    }
    return t
} 
```

# java - Java中N皇后作业练习的问题

> ID：10032403
> 
> 赞同：2
> 
> 时间：2012-04-05T16:30:03.680
> 
> 标签：java, algorithm

*   我正在使用我自己的堆栈实现。
*   我不应该使用递归。

我的代码：

```
public static void solve(int bsize)
{
    stack queenLoc = new stack();

    int y=0;
    int count=0;
    boolean done = false;

    while(done == false && queenLoc.size() != bsize)    
    {
        queenLoc.push(count);

        if(!isSafe(bsize,queenLoc,count))
        {
            while(queenLoc.getTop() == bsize)
            {
                y = queenLoc.pop();
                count--;
            }
            if(queenLoc.top != null)
            {
                queenLoc.push(queenLoc.pop()+1);
                count++;        
            }
            else
            {
                queenLoc.push(y+1);
                count++;
            }
        }
        else if(queenLoc.size() == bsize)
        {
            done = true;
        }
        else
        {
            count++;
            queenLoc.push(count);
        }
    }

    queenLoc.showAll();

    if(queenLoc.size() == bsize)
        printBoard(bsize, queenLoc);
}

public static boolean isSafe(int bsize, stack s,int count)
{               
    for(int i = 1; i<s.size(); i++)
    {
            if(s.getTop() == s.get(i) || s.getTop()+count == s.get(i)+s.size() || s.getTop()-count == s.get(i)-s.size())
                return false;
    }

    return true;
} 
```

我不确定到底发生了什么，我的位置不对，printBoard 功能只在第一行打印皇后。我实际上尝试了很多可能性，但我有点困惑。

谁能指出我正确的方向并告诉我代码中的问题在哪里。我正在使用堆栈来存储列和堆栈类中的“计数”变量以将我指向哪一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-20T20:48:25.223

```
package mynqueens;

public class MyNQueens {
public static int board[][] = new int[4][4];
public static int row,column;

    public MyNQueens(){

    }
    public static void main(String[] args) {

    check(0,0);
    for(int i=0;i<4;i++){
        for(int j=0;j<4;j++){
            System.out.print(board[i][j] + "\t");
        }
        System.out.println();
    }

    }
    public static void check(int i, int j ){

        while(i<3){
            board[i][j] = 1;
            i++;
        }
        while(i!=0){
            board[i][j] = 1;

            i--;
        }
        while(j<3){
            board[i][j]=1;
            j++;
        }
        while(j!=0){
            board[i][j] = 1;
            j--;
        }
        while(j<3 || i<3){
            board[i][j] = 1;
            i++;
            j++;
        }
        while(j!=0 || i!=0){
            board[i][j] = 1;
            i--;
            j--;
        }
        while(i<3 || j!=0){
            board[i][j]=1;
            i++;
            j--;
        }
        while(i!=0 || j<3){
         board[i][j]=1;
         i--;
         j++;

        }

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:01:14.780

在开始擦除内部 while 部分中的元素之前

```
while(queenLoc.getTop() == bsize)
{
    y = queenLoc.pop();
    count--;
} 
```

QueenStack 中的元素数量将超过 bsize。

当`while(done == false && queenLoc.size() != bsize)`QueenLoc 的大小等于 bsize 时，您将打印结果。

我要说的是，在`bsize`步骤之后，您总是在打印结果。

建议：您的代码应该具有不变的“queenLoc 表示没有两个皇后互相攻击的位置”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-18T09:58:19.433

```
import java.util.Scanner;

/**
 *
 * @author Manimekalai
 */
public class Queen {

    public static boolean isConsistent(int[] q, int n)
    {
        for (int i = 0; i < n; i++)
        {
            if (q[i] == q[n])             return false;   // same column
            if ((q[i] - q[n]) == (n - i)) return false;   // same major diagonal
            if ((q[n] - q[i]) == (n - i)) return false;   // same minor diagonal
        }
        return true;
    }

    public static void printQueens(int[] q)
    {
        int N = q.length;
        for (int i = 0; i < N; i++)
        {
            for (int j = 0; j < N; j++)
            {
                if (q[i] == j) System.out.print("Q ");
                else           System.out.print("* ");
            }
            System.out.println();
        }
        System.out.println();
    }

    public static void enumerate(int N)
    {
        int[] a = new int[N];
        enumerate(a, 0);
    }

    public static void enumerate(int[] q, int n)
    {
        int N = q.length;
        if (n == N) printQueens(q);
        else
        {
            for (int i = 0; i < N; i++)
            {
                q[n] = i;
                if (isConsistent(q, n)) enumerate(q, n+1);
            }
        }
    }

    public static void main(String[] args)
    {
        //int N = Integer.parseInt(args[0]);
        System.out.println("Enter N value");
        Scanner s=new Scanner(System.in);
        int N=s.nextInt();
        enumerate(N);
    }
} 
```

# android - 安卓地图图片

> ID：10032413
> 
> 赞同：0
> 
> 时间：2012-04-05T16:30:46.747
> 
> 标签：android, android-layout, android-emulator, android-widget

我正在开发一个天气 android 应用程序，它在地图上显示给定国家的每个城市的温度。所以，我想使用“地图图像”，但我不清楚：如何在这个“地图图像”上找到这个国家的城市，当点击一个城市时生成一个事件......有人可以帮我吗请？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:34:21.023

使用谷歌地图来实现它。按照[这个](http://developer.android.com/resources/tutorials/views/hello-mapview.html)。其解释清楚。

# javascript - 如何在谷歌地图上更改路线的颜色

> ID：10032414
> 
> 赞同：2
> 
> 时间：2012-04-05T16:30:48.760
> 
> 标签：javascript, google-maps

我想在搜索根时更改谷歌地图上线条的颜色。我想让它像图片中的那样。我想将它从这个默认图片[默认线路路由](https://maps.googleapis.com/maps/api/staticmap?path=color:0x0000ff%7Cweight:5%7C40.737102,-73.990318%7C40.749825,-73.987963%7C40.752946,-73.987384%7C40.755823,-73.986397&size=512x512&sensor=false)更改为红色线路，就像在这[条线路的图片颜色中](https://maps.googleapis.com/maps/api/staticmap?path=color:0xff0000ff%7Cweight:5%7C40.737102,-73.990318%7C40.749825,-73.987963%7C40.752946,-73.987384%7C40.755823,-73.986397&size=512x512&sensor=false)一样。我使用谷歌地图 JavaScript API V3。那可能吗？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-17T19:18:33.100

查看答案[如何在谷歌地图 v3 中更改路线的颜色](https://stackoverflow.com/questions/19022702/how-to-change-the-color-of-route-in-google-maps-v3)

创建 directionDisplay 对象时

```
var directionsDisplay = new google.maps.DirectionsRenderer({
    polylineOptions: {
       strokeColor: "red"
    }
}); 
```

# mysql - 添加第四个表连接时结果减少

> ID：10032417
> 
> 赞同：0
> 
> 时间：2012-04-05T16:30:57.550
> 
> 标签：mysql, database, join

编辑：现在由于某种原因，每个 productid 只出现一次，而不是取决于它有多少变化？有任何想法吗？（我使用的查询是我列出的最后一个查询）

这是我的三表连接查询

```
SELECT xp.productid, xp.product, xc.classid, xco.optionid, xco.option_name
FROM xcart_products xp
JOIN xcart_classes xc ON xp.productid = xc.productid and xc.class = 'Color'
JOIN xcart_class_options xco ON xc.classid = xco.classid
ORDER by xp.product DESC 
```

现在这里的一切都很好，我得到了大约 2,000 个结果，一切都得到了正确的组织和安排。

现在我想添加第四个表来计算每个 xi.id 的 xi.optionid 的数量，但由于某种原因，我只得到大约 200 个结果并且不知道为什么。这是我试图运行的查询

```
SELECT xp.productid, xp.product, xc.classid, xco.optionid, xco.option_name, count(xi.optionid) as cnt
    FROM xcart_products xp 
    INNER JOIN xcart_classes xc ON xp.productid = xc.productid AND xc.class = 'Color'
    INNER JOIN xcart_class_options xco ON xc.classid = xco.classid 
    INNER JOIN xcart_images_D xi ON xi.optionid = xco.optionid
    GROUP BY xp.product
    ORDER by xp.product DESC 
```

这是每个表的基本架构

```
xcart_products -
    + productid*
    + product
xcart_classes - 
    + classid*
    + productid (xcart_products.productid)
xcart_class_options -
    + optionid*
    + classid (xcart_classes.classid)
    + option_name
xcart_images_D - 
    + imageid*
    + optionid (xcart_class_options.optionid)
    + id (xcart_products.productid) 
```

我目前正在使用的查询 -

```
SELECT xp.productid, xp.product, xc.classid, xco.optionid, xco.option_name, count(xi.optionid) as cnt
FROM xcart_products xp
JOIN xcart_classes xc ON xp.productid = xc.productid AND xc.class = 'Color'
JOIN xcart_class_options xco ON xc.classid = xco.classid
LEFT JOIN xcart_images_D xi ON xi.optionid = xco.optionid
GROUP BY xp.product 
ORDER by xp.product DESC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:36:54.943

尝试[`LEFT OUTER JOIN`](http://dev.mysql.com/doc/refman/5.0/en/join.html)改用。

```
select xp.productid,
    xp.product,
    xc.classid,
    xco.optionid,
    xco.option_name,
    count(xi.optionid) as cnt
from xcart_products xp
inner join xcart_classes xc on xp.productid = xc.productid
    and xc.class = 'Color'
inner join xcart_class_options xco on xc.classid = xco.classid
left outer join xcart_images_D xi on xi.optionid = xco.optionid
group by xp.product
order by xp.product desc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:37:17.593

在最后一个表上使用左联接。

# c - 按其值打印#define 的名称？

> ID：10032420
> 
> 赞同：7
> 
> 时间：2012-04-05T16:31:20.803
> 
> 标签：c, macros, c-preprocessor

我有一个**C**程序，其中包含一些错误代码的定义。像这样：

```
#define FILE_NOT_FOUND -2
#define FILE_INVALID -3 
#define INTERNAL_ERROR -4
#define ... 
#define ... 
```

是否可以通过值打印定义的名称？像这样：

```
PRINT_NAME(-2);

// output
FILE_NOT_FOUND 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T16:46:30.827

简而言之，没有。最简单的方法是这样的（请注意：这假设您永远不能将错误分配为零/空）：

```
 //Should really be wrapping numerical definitions in parentheses. 
#define FILE_NOT_FOUND  (-2)
#define FILE_INVALID    (-3) 
#define INTERNAL_ERROR  (-4)

typdef struct {
  int errorCode;
  const char* errorString;
} errorType;

const errorType[] = {
  {FILE_NOT_FOUND, "FILE_NOT_FOUND" },
  {FILE_INVALID,   "FILE_INVALID"   },
  {INTERNAL_ERROR, "INTERNAL_ERROR" },
  {NULL,           "NULL"           },
};

// Now we just need a function to perform a simple search
int errorIndex(int errorValue) {
  int i;
  bool found = false;
  for(i=0; errorType[i] != NULL; i++) {
    if(errorType[i].errorCode == errorValue) {
      //Found the correct error index value
      found = true;
      break;
    }
  }
  if(found) {
    printf("Error number: %d (%s) found at index %d",errorType[i].errorCode, errorType[i].errorString, i);
  } else {
    printf("Invalid error code provided!");
  }
  if(found) {
    return i;
  } else {
    return -1;
  }
} 
```

享受！

此外，如果您想节省更多输入，您可以使用预处理器宏使其更加整洁：

```
#define NEW_ERROR_TYPE(ERR) {ERR, #ERR}
 const errorType[] = {
      NEW_ERROR_TYPE(FILE_NOT_FOUND),
      NEW_ERROR_TYPE(FILE_INVALID),
      NEW_ERROR_TYPE(INTERNAL_ERROR),
      NEW_ERROR_TYPE(NULL)
    }; 
```

现在您只需键入一次宏名称，减少了拼写错误的机会。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-12-16T20:26:57.650

你可以做这样的事情。

```
#include <stdio.h>

#define FILE_NOT_FOUND -2
#define FILE_INVALID -3 
#define INTERNAL_ERROR -4

const char* name(int value) {
#define NAME(ERR) case ERR: return #ERR;
    switch (value) {
        NAME(FILE_NOT_FOUND)
        NAME(FILE_INVALID)
        NAME(INTERNAL_ERROR)
    }
    return "unknown";
#undef NAME
}

int main() {
    printf("==== %d %s %s\n", FILE_NOT_FOUND, name(FILE_NOT_FOUND), name(-2));
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T16:35:36.793

不，那是不可能的。这会打印什么？

```
#define FILE_NOT_FOUND   1
#define UNIT_COST        1
#define EGGS_PER_RATCHET 1

PRINT_NAME(1); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T16:39:07.283

有点...

```
#define ERROR_CODE_1 "FILE_NOT_FOUND"
#define ERROR_CODE_2 "FILE_FOUND"

#define PRINT_NAME(N) ERROR_CODE_ ## N 
```

或者：

```
static char* error_codes(int err) {
   static char name[256][256] = {

   };
   int base = .... lowest error code;
   return name[err - base];
}

#define PRINT_NAME(N) error_code(N) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T16:50:53.447

不是自动的。名称在编译过程中丢失，代码中只保留常数。

但是你可以构建这样的东西：

```
const char * a[] = {"","","FILE_NOT_FOUND","FILE_INVALID"}; 
```

并通过使用定义值绝对值作为索引来访问它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-05T16:45:52.997

为什么不选择使用枚举呢？

```
enum errors {FILE_NOT_FOUND = -2, FILE_INVALID = -3, INTERNAL_ERROR = -4};

FILE *fp = fopen("file.txt", "r");

if(fp == NULL) {
    printf("Error\n");
    exit(FILE_NOT_FOUND);
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-05T18:53:10.310

为此，请使用 C99 的指定初始化程序，但如果您的错误代码为负数，则需要小心。

首先是正值的版本：

```
#define CODE(C) [C] = #C

static
char const*const codeArray[] = {
CODE(EONE),
CODE(ETWO),
CODE(ETHREE),
};

enum { maxCode = (sizeof codeArray/ sizeof codeArray[0]) }; 
```

这将分配一个具有您需要的长度的数组，并将字符串指针放在正确的位置。请注意，标准允许重复值，最后一个值将是实际存储在数组中的值。

要打印错误代码，您必须检查索引是否小于`maxCode`.

如果您的错误代码始终为负数，您只需在打印前取反代码即可。但反过来可能是个好主意：让代码为正数并检查其符号的返回值。如果它是负数，则错误代码将是该值的否定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-16T17:22:02.080

这就是我在 C 中的做法：

<我的定义.h>

```
#pragma once 

#ifdef DECLARE_DEFINE_NAMES
// Switch-case macro for getting defines names
#define BEGIN_DEFINE_LIST  const char* GetDefineName (int key) { switch (key) {
#define MY_DEFINE(name, value)  case value: return #name;
#define END_DEFINE_LIST } return "Unknown"; }

#else

// Macros for declaring defines
#define BEGIN_COMMAND_LIST /* nothing */
#define MY_DEFINE(name, value)  static const int name = value;
#define END_COMMAND_LIST /* nothing */

#endif

// Declare your defines
BEGIN_DEFINE_LIST

MY_DEFINE(SUCCEEDED,       0)
MY_DEFINE(FAILED,         -1)
MY_DEFINE(FILE_NOT_FOUND, -2)
MY_DEFINE(INVALID_FILE,   -3)
MY_DEFINE(INTERNAL_ERROR  -4)
etc...

END_DEFINE_LIST 
```

<我的定义信息.h>

```
#pragma once
const char* GetDefineName(int key); 
```

<我的定义信息.c>

```
#define DECLARE_DEFINE_NAMES
#include "MyDefines.h" 
```

现在，您可以像这样在任何地方使用声明的 switch-case 宏：

<WhereEver.c>

```
#include "MyDefines.h"
#include "MyDefineInfo.h"

void PrintThings()
{
    Print(GetDefineName(SUCCEEDED));
    Print(GetDefineName(INTERNAL_ERROR));
    Print(GetDefineName(-1);
    // etc.
} 
```

# java - 如何在网站上禁止使用英镑 (£) 标志？

> ID：10032421
> 
> 赞同：-3
> 
> 时间：2012-04-05T16:31:25.227
> 
> 标签：java, html

在我正在开发的网站上，如果用户将浏览器的语言设置更改为“英语（英国）”或等效设置，则会将美元符号 ($) 的所有位置更改为英镑符号（英镑）。这是不正确的，我需要禁止它。有谁知道解决方案。

Java 支持站点的后端。

提前感谢您的所有建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T17:00:21.843

这不是标准的浏览器行为。如果发生这种情况，那么它只能是因为您的应用程序的代码，无论是在服务器端还是客户端。找出发生这种情况的位置并从源头禁用它，而不是事后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:07:42.123

我怀疑问题在于货币金额被存储为普通数字，并使用通过为用户选择的语言环境调用 getCurrencyInstance 获得的 NumberFormat 进行格式化。如果金额总是以美元为单位，那么这是错误的做法。相反，构造一个带有美元符号的 DecimalFormat。

看在 Pete 的份上，不要尝试在 Javascript 中解决这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:56:18.967

浏览器可以将通用货币符号解释为其区域设置的相关字符。

您的应用程序可能正在解释浏览器 GET 请求并从中推断语言环境（例如，用户代理可能包含“en-GB”），然后代码会将您指定的通用符号替换为正确的字符语言环境并将其发送到浏览器。

如果您只想要一美元​​而不需要其他任何东西，请指定一个美元符号。

# c# - 通过 where 子句传入 func

> ID：10032423
> 
> 赞同：2
> 
> 时间：2012-04-05T16:31:25.187
> 
> 标签：c#

给定一个 .net 4\. 集合，如果我想在 where 子句中传入我自己的自定义函数，我该怎么做（通过参数）？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T16:32:29.013

Do you mean something like this?

```
public IEnumerable<string> FilterNames(Func<string, bool> filter)
{
    return people.Select(person => person.Name)
                 .Where(filter);
} 
```

# svn - 如何为 Hgsubversion 指定用户名和密码

> ID：10032424
> 
> 赞同：1
> 
> 时间：2012-04-05T16:31:26.787
> 
> 标签：svn, mercurial, hgsubversion, hgrc

我想知道如何指定用于使用 Hgsubversion 从 HG 将更改推送到 subversion 存储库的用户名和密码

我想知道我应该在我的存储库中设置的位置

```
 "hgsubversion.username", "hgsubversion.password" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T12:08:15.093

试着先看

> **'hg help subversion'** 了解更多详情。

必须将设置添加到

> **用户全局 ~/.hgrc 文件**

本地设置将不起作用

```
See 'hg help config' -- that explains that when we call a configuration
setting 'foo.bar', then you enter it in your configuration file as

[foo]
bar = something

[hgsubversion]
username = < your_name >
password = < your_secret > 
```

# c# - 条件语句检查 Null

> ID：10032434
> 
> 赞同：2
> 
> 时间：2012-04-05T16:31:57.857
> 
> 标签：c#, c#-4.0, if-statement, unary-operator

我试图弄清楚如何有一个简短的单行条件语句。

如果此日期不为空，则将过滤器添加到当前过滤器列表中：

`fromDt ?? filters.Add(FilterType.DateFrom, fromDt);`

有没有办法做到这一点？我知道我能做到。。

`(fromDt != null) ? "something" : "something_else"`，但我不需要'else'，并且真的很想使用`??`运算符进行空检查。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T16:34:05.187

这有什么问题？

```
if (fromDt != null) filters.Add(FilterType.DateFrom, fromDt); 
```

首先，您的代码应该是可读的。即使您的`??`代码有效，我也不知道它在第一眼看到它的作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T16:36:12.237

您正在尝试的代码使您的代码非常难以阅读。就像[BrokenGlass](https://stackoverflow.com/users/329769/brokenglass)所说，您正在用清晰度来换取原始字符数。

这是 C# 支持的唯一“单行”解决方案。

```
if (fromDt != null) filters.Add(FilterType.DateFrom, fromDt); 
```

但我鼓励每个人将其扩展到*至少*两行（我的偏好是四行带大括号）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:39:30.180

*撇开解决方案的目的*不谈，在使用`??`. 不过不要在家里尝试这个。

`filters.Add(FilterType.DateFrom, fromDt ?? DateTime.MinValue)`

这个想法是将 DateFrom 设置为最小可能值，本质上是添加一个开放过滤器。

# javascript - Comparing Pre-declared and Self-invoked Anonymous Functions

> ID：10032440
> 
> 赞同：1
> 
> 时间：2012-04-05T16:32:18.247
> 
> 标签：javascript, anonymous-function

This is going to be a quick discussion, but I just wanted some feedback on a revelation I had this morning. Knowing that this...

```
var addTwoNumbers = function(intOne, intTwo) {
    if ((typeof intOne == 'number') && (typeof intTwo == 'number')) {
        document.write(intOne + intTwo);
    } else {
        document.write('Unable to perform operation.');
    }
};

addTwoNumbers(3, 4); 
```

... behaves essentially the same as this...

```
(function(intOne, intTwo) {
    if ((typeof intOne == 'number') && (typeof intTwo == 'number')) {
        document.write(intOne + intTwo);
    } else {
        document.write('Unable to perform operation.');
    }
})(3, 4); 
```

... is that to say that the first set of parentheses in the self-invoking function is a "tool" to bypass or work around function execution by reference? In effect, `()` is the name of the method without actually being the name of the method? Also, because the function is being declared directly at execution, is it faster than the technique using a variable name reference? Just wondrin'.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:11:34.367

好的，这就是“自调用函数”（实际上不是“自调用”；有一个显式调用并且它在函数本身*之外*）被写为（按照惯例）作为带括号的子表达式的原因。

JavaScript 有两个涉及关键字的结构`function`：

1.  函数声明语句，它定义了一个函数对象并将其绑定到本地范围内的名称（以及函数的本地范围内，但现在让我们忽略它）：

    ```
    function foo() { /* code */ } 
    ```

2.  函数实例化子表达式，它在表达式的上下文中创建函数对象：

    ```
    var f = function() { /* code */ }; 
    ```

当你想要第二件事*并且你想要它在表达式语句的开头时，问题就出现了。* 当语句以关键字*开始*`function`时，解析器假定您在上面执行**1**，而不是**2**。*因此，通过在函数实例化*周围引入括号——并记住始终允许给子表达式加上括号并且不会以任何方式影响其值——使得`function`关键字的使用被解释为上面的**2**。

还有其他强制解析器将语句视为表达式的方法：

*   `!function() { /* code */ }();`
*   `0, function() { /* code */ }();`
*   `+function() { /* code */ }();`

只是一些例子。

至于性能，这里不是问题。我要注意的一件事是，这种将标识符绑定到函数对象的方式：

```
var name = function() { /* code */ }; 
```

真的不比：

```
function name() { /* code */ } 
```

在某些方面情况更糟。特别是，使用函数声明语句给出的名称将显示在堆栈跟踪中，而定义函数时`var`不会。

# actionscript-3 - Adobe AIR 3.2 Glitch

> ID：10032442
> 
> 赞同：0
> 
> 时间：2012-04-05T16:32:34.977
> 
> 标签：actionscript-3, air, drag, flash-cs5.5, mouseup

I just finished a successful build of my program last night. Then, I get up this morning, and after an update fro Adobe AIR 3.1 to AIR 3.2, I find THIS bug!

The same build under 3.1 works perfectly. However, as soon as 3.2 is installed, the following code after stopDrag fails silently. Mind you, it only fails in the packed and installed AIR application. It works perfectly when I test it inside of Adobe Flash Professional CS5.5

WHAT is going on? Here's the code I'm dealing with. Again, this works without error for Adobe AIR 3.1, but fails for 3.2\. I cannot get to any other MouseEvent.MOUSE_UP events in my program at this point, due to my structure.

I omitted the irrelevant parts of the code. All the same, there is a lot, due to the fact that I don't know where the error occurs exactly. Instead of everything that is supposed to happen happening, stopDrag is the last line of code that fires in this block.

```
tile5.addEventListener(MouseEvent.MOUSE_UP, mouseUpHandler5);

function mouseUpHandler5(evt:MouseEvent):void
{
    Mouse.cursor = "paw";
    var obj = evt.target;
    var target = obj.dropTarget;
    obj.stopDrag();
    if (target != null && target.parent == hsSlot1)
    {
        brdgcheck(5, 1);
    }
} 
```

* * *

```
function brdgcheck(tile:int, slot:int)
{
    var ck_brdg_l:String = "osr.Langue.brdg_l" + String(slot);
    var ck_brdg_t:String = "osr.Langue.brdg_t" + String(tile);
    var ck_slotfilled:String = "Slot" + String(slot) + "Filled";
    var ck_tile:String = "tile" + String(tile);
    var ck_slot:String = "hsSlot" + String(slot);
    var ck_txtTile:String;

    switch(tile)
    {
        case 1:
            ck_brdg_t = osr.Langue.brdg_t1;
            ck_txtTile = tile1.txtTile1.text;
        break;
        case 2:
            ck_brdg_t = osr.Langue.brdg_t2;
            ck_txtTile = tile2.txtTile2.text;
        break;
        case 3:
            ck_brdg_t = osr.Langue.brdg_t3;
            ck_txtTile = tile3.txtTile3.text;
        break;
        case 4:
            ck_brdg_t = osr.Langue.brdg_t4;
            ck_txtTile = tile4.txtTile4.text;
        break;
        case 5:
            ck_brdg_t = osr.Langue.brdg_t5;
            ck_txtTile = tile5.txtTile5.text;
        break;
    }

    switch(slot)
    {
        case 1:
            ck_brdg_l = osr.Langue.brdg_l1;
        break;
        case 2:
            ck_brdg_l = osr.Langue.brdg_l2;
        break;
        case 3:
            ck_brdg_l = osr.Langue.brdg_l3;
        break;
        case 4:
            ck_brdg_l = osr.Langue.brdg_l4;
        break;
        case 5:
            ck_brdg_l = osr.Langue.brdg_l5;
        break;
    }

    if (ck_brdg_l == ck_brdg_t)
    {
        osr.Sonus.PlaySound("concretehit");
        this[ck_slotfilled].visible = true;
        switch(slot)
        {
            case 1:
                Slot1Filled.txtSlot1.text = ck_txtTile;
            break;
            case 2:
                Slot2Filled.txtSlot2.text = ck_txtTile;
            break;
            case 3:
                Slot3Filled.txtSlot3.text = ck_txtTile;
            break;
            case 4:
                Slot4Filled.txtSlot4.text = ck_txtTile;
            break;
            case 5:
                Slot5Filled.txtSlot5.text = ck_txtTile;
            break;
        }

        this[ck_tile].visible = false;
        this[ck_slot].visible = false;
        if (hsSlot1.visible == false && hsSlot2.visible == false && hsSlot3.visible == false && hsSlot4.visible == false && hsSlot5.visible == false)
        {
            osr.Gradua.Score(true);
            osr.Gradua.Evaluate("brdg");
            btnReset.visible = false;
            hsChar.visible = false;
            if (osr.Gradua.Fetch("brdg", "arr_act_stcnt") < 4)
            {
                bga.gotoAndPlay("FINKEY");
                win_key();
            }
            else
            {
                bga.gotoAndPlay("FINNON");
            }
        }
        else
        {
            osr.Gradua.Score(true);
        }
    }
    else
    {
        osr.Gradua.Score(false);

        osr.Sonus.PlaySound("glassbreak");
        switch(tile)
        {
            case 1:
                tile1.x = 92.85;
                tile1.y = 65.85;
            break;
            case 2:
                tile2.x = 208.80;
                tile2.y = 162.85;
            break;
            case 3:
                tile3.x = 324.80;
                tile3.y = 65.85;
            break;
            case 4:
                tile4.x = 437.80;
                tile4.y = 162.85;
            break;
            case 5:
                tile5.x = 549.80;
                tile5.y = 65.85;
            break;
        }
    }
} 
```

> **EDIT: I found a good workaround, to use "if (hsSlot1.hitTestPoint(mouseX,mouseY) && hsSlot1.visible == true)" However, a solution to this problem would still be appreciated!**

# php - PHP accessing cookies from other domain with user explicit authorization

> ID：10032443
> 
> 赞同：1
> 
> 时间：2012-04-05T16:32:35.853
> 
> 标签：php, cookies, oauth

I'm coding a php framework to add functionalities for a second party website, which is not ours and don't have control at all.

This website has Oauth 2.0 authorization for its clients and save access token in cookies. As I must interact with their own public API, I need to read that token to make my requests.

Question is.. which is the best strategy to code that? I'm not a php programmer but very proficient in C++. I wonder if its possible to open website inside an IFRAME and read cookies with javascript, am I making any sense????

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:36:12.447

如果您真的想这样做，请在隐藏的 iframe 中打开网站，iframe 加载的页面应该类似于

```
window.parent.getCookie(/* the cookie value*/); 
```

所以你可以在你的主站点中使用getCookie方法并读取外部站点cookie，然后你可以使用ajax将cookie值发送到你的脚本，并使用它或将其保存为cookie，你也可以使用javascript来保存 cookie。

编辑：记住 cookie 永远不应该存储敏感数据，即使在您自己的站点中也是如此。

# c - 是否有用于 WEP、WPA 和 WPA2 的 C 库

> ID：10032444
> 
> 赞同：1
> 
> 时间：2012-04-05T16:32:39.003
> 
> 标签：c, wep, wpa

是否有一个类似于如何将 openssl 导入 C 程序的库，可以轻松访问 WEP、WPA 和 WPA2 函数？

我从来没有用 C 编程过，一个朋友在问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:40:59.497

有[wpa_supplicant](http://hostap.epitest.fi/wpa_supplicant/)可能适合您的需求。它是一个程序，而不是一个库，但如果有必要，应该可以修改它以用作一个库。但是，wpa_supplicant 并不支持所有操作系统和芯片组，因为 wifi 加密（与 SSL/TLS 相比）非常依赖于底层硬件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:14:44.013

我认为[Open1X](http://open1x.sourceforge.net/)是你想要的。

# c# - 不在一组引号内时匹配正则表达式模式（文本跨越多行）

> ID：10032447
> 
> 赞同：2
> 
> 时间：2012-04-05T16:32:54.250
> 
> 标签：c#, .net, regex

这是我之前的问题的延续[.NET 正则表达式引擎没有返回匹配项，但我期待 8](https://stackoverflow.com/questions/10013197)。

我的查询完美地处理了所有事情，并且我的捕获组运行良好，但是我发现了一个我不知道如何处理的边缘情况。

这是一个我遇到问题[的测试用例。](http://regexhero.net/tester/?id=42e224ce-d8c3-4faf-8b9d-2fa20997ff9d)

```
INSERT INTO [Example] ( [CaseNumber] , [TestText] )
VALUES
(1 , 'Single Line Case'),
(2 , 'Multi
Line Case');
(3 , 'Two Lines with odd end '');
Case');
(4 , ''),
(5 , 'Case 3 is the Empty Text Case'); 
```

这是我正在使用的模式，我使用 RegexOptions 标志`Singleline`、、、和`Multiline``ExplicitCapture``IgnorePatternWhitespace`

```
^\(
((('(?<s>.*?)'(?!')) |
 (?<n>-?[\d\.]+)
 )(\s,\s)?
)+
#(?<!'')   #Commented Case 3 works, un-commented case 2 works
\)[;,]\r?$ 
```

我可以处理案例 3 或案例 4，但我无法同时处理这两种情况。

如果我有办法检查捕获组中是否有偶数个`'`'s`，我可以检查我们是否在真正的行尾或文本块中，该行的结尾只是恰好匹配模式。但我不知道如何修改[其他示例](https://stackoverflow.com/questions/668179/regex-to-match-a-string-with-an-even-number-of-quotes)以处理多个行文本字符串。

我想用一个正则表达式查询来完成还是我被迫进行后处理（使用注释的案例）并且这是两次通过？

* * *

这是在 LINQPad 中运行它的代码

```
string text = 
@"INSERT INTO [Example] ( [CaseNumber] , [TestText] )
VALUES
(1 , 'Single Line Case'),
(2 , 'Multi
Line Case');
(3 , 'Two Lines with odd end '');
Case');
(4 , ''),
(5 , 'Case 3 is the Empty Text Case');
";

const string recordRegex =
@"^\(
((('(?<s>.*?)'(?!')) |
 (?<n>-?[\d\.]+)
 )(\s,\s)?
)+
#(?<!'')   #Commented Case 3 works, un-commented case 2 works
\)[;,]\r?$";

var records = Regex.Matches(text, recordRegex, RegexOptions.Singleline | RegexOptions.Multiline | RegexOptions.IgnorePatternWhitespace | RegexOptions.ExplicitCapture);
records.Dump(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:44:07.523

像这样的表达式将匹配这样的引号：

```
(?:'[^']*')+ 
```

如果你想`foo`在它*不在*这样的引号内时匹配，你可以使用类似的东西：

```
foo(?=[^']*(?:'[^']*'[^']*)+\z) 
```

* * *

> 每行一个匹配，不带引号的文本和数字作为捕获组

像这样的东西：

```
(?xm)^
\(

(?:
    (?:
        (?<quote> (?:'[^']*')+ )
    |   (?<num>   -?\d+(?:\.\d+)? )
    |   (?<x>     X'[0-9a-f]*' )
    )
    (?:\s*,\s*)?
)+

\)
[;,] 
\r?$ 
```

# javascript - jQuery 动画、链接、.each() 和 .animate()（或 fadeIn() 和 fadeOut()）

> ID：10032453
> 
> 赞同：5
> 
> 时间：2012-04-05T16:33:21.000
> 
> 标签：javascript, jquery, html

我今天在尝试解决这个问题时遇到了一些麻烦，我想让我的 DOM 中的 5 个项目（列在相同的属性元素 $('.elements') 下）淡入淡出，然后在 API 上阅读一些我认为 .each() 将是实现淡入淡出展示画廊的绝妙想法。

但是，我目前正在使用：

```
$('.elements').each(function() {
    $(this).fadeIn(2000).delay(200).fadeOut(2000).show();
}) 
```

但一切都会立即淡入淡出。

我如何做一个顺序效果，其中所有内容都链接在一起，它从列表中的第一项（又名 - $('elements').eq(0)?）开始到最后一项，然后再次重新启动？

我真的需要一个while循环来在javascript/jquery中做到这一点吗？我希望有一个类似的功能，我可以链接 jQuery 来执行以减少负载和文件大小。

另外，有没有办法限制图像从我的 div 溢出？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T16:45:21.297

```
(function loop() {
  $('.elements').each(function() {
    var $self = $(this);
    $self.parent().queue(function (n) {
      $self.fadeIn(2000).delay(200).fadeOut(2000, n);
    });
  }).parent().promise().done(loop);
}()); 
```

演示：http: [//jsfiddle.net/uWGVN/2/](http://jsfiddle.net/uWGVN/2/)

**更新**以使其无休止地循环。

* * *

**第二次更新**：一种不同的，可能更具可读性的方法：

```
(function fade(idx) {
  var $elements = $('.elements');
  $elements.eq(idx).fadeIn(2000).delay(200).fadeOut(2000, function () {
    fade(idx + 1 < $elements.length ? idx + 1 : 0);
  });
}(0)); 
```

​演示：http: [//jsfiddle.net/uWGVN/3/](http://jsfiddle.net/uWGVN/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T16:38:38.773

您可以添加回调

官方文档：

```
('#clickme').click(function() {
  $('#book').fadeOut('slow', function() {
    // Animation complete.
  });
}); 
```

并使用 i++ et $('.elements').eq(i) 调用相同的函数

[http://jsfiddle.net/dFnNL/](http://jsfiddle.net/dFnNL/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T16:47:38.017

为了你的溢出，用 CSS 设置它的样式：

```
div.(class) { position:relative; overflow:hidden; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-03T20:46:39.840

美丽的方式：

```
(function hideNext(jq){
        jq.eq(0).hide("slow", function(){
            (jq=jq.slice(1)).length && hideNext(jq);
        });

})($('a')) 
```

最后一个：

```
(function hideNext(jq){
                jq.eq(jq.length-1).hide("slow", function(){
                    (jq=jq.slice(0,length-1)).length && hideNext(jq);
                });

})($('a')) 
```

# javascript - 如何从 X 中获取下一个 7 天并在 JS 中格式化

> ID：10032456
> 
> 赞同：7
> 
> 时间：2012-04-05T16:33:24.167
> 
> 标签：javascript, date, calendar

我想打印这样的东西（7 天日历），但可以从我想要的任何日期开始。

```
Monday, 1 January 2011
Tuesday, 2 January 2011
Wednesday, 3 January 2011
Thursday, 4 January 2011
Friday, 5 January 2011
Saturday, 6 January 2011
Sunday, 7 January 2011 
```

例如，我想从 2 月 22 日开始显示接下来的 7 天。不知道如何处理。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T16:49:03.167

这似乎是您正在寻找的：

```
function GetDates(startDate, daysToAdd) {
    var aryDates = [];

    for (var i = 0; i <= daysToAdd; i++) {
        var currentDate = new Date();
        currentDate.setDate(startDate.getDate() + i);
        aryDates.push(DayAsString(currentDate.getDay()) + ", " + currentDate.getDate() + " " + MonthAsString(currentDate.getMonth()) + " " + currentDate.getFullYear());
    }

    return aryDates;
}

function MonthAsString(monthIndex) {
    var d = new Date();
    var month = new Array();
    month[0] = "January";
    month[1] = "February";
    month[2] = "March";
    month[3] = "April";
    month[4] = "May";
    month[5] = "June";
    month[6] = "July";
    month[7] = "August";
    month[8] = "September";
    month[9] = "October";
    month[10] = "November";
    month[11] = "December";

    return month[monthIndex];
}

function DayAsString(dayIndex) {
    var weekdays = new Array(7);
    weekdays[0] = "Sunday";
    weekdays[1] = "Monday";
    weekdays[2] = "Tuesday";
    weekdays[3] = "Wednesday";
    weekdays[4] = "Thursday";
    weekdays[5] = "Friday";
    weekdays[6] = "Saturday";

    return weekdays[dayIndex];
}

var startDate = new Date();
var aryDates = GetDates(startDate, 7);
console.log(aryDates);​
​ 
```

结果（截至今天）：

```
["Thursday, 5 April 2012",
 "Friday, 6 April 2012", 
 "Saturday, 7 April 2012", 
 "Sunday, 8 April 2012", 
 "Monday, 9 April 2012", 
 "Tuesday, 10 April 2012", 
 "Wednesday, 11 April 2012", 
 "Thursday, 12 April 2012"] 
```

这是[一个工作小提琴](http://jsfiddle.net/JamesHill/FMadf/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-08-17T18:22:58.050

这是我使用[Moment.js的解决方案](http://momentjs.com/)

**未来 7 天**

```
let days = [];
let daysRequired = 7

for (let i = 1; i <= daysRequired; i++) {
  days.push( moment().add(i, 'days').format('dddd, Do MMMM YYYY') )
}

console.log(days)
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
```

**以防万一您需要前 7 天**

```
let days = [];
let daysRequired = 7

for (let i = daysRequired; i >= 1; i--) {
  days.push( moment().subtract(i, 'days').format('dddd, Do MMMM YYYY') )
}

console.log(days)
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T16:48:11.763

初始日期：

```
var startingDay = new Date(year, month, day); 
```

整整一周`startingDay`：

```
var thisDay = new Date();
for(var i=0; i<7; i++) {
  thisDay.setDate(startingDay.getDate() + i);
  console.log(thisDay.format());
} 
```

格式化函数：

```
Date.prototype.format = function(){
    var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];        
    var days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
    return days[this.getDay()]
          +", "
          +this.getDate()
          +" "
          +months[this.getMonth()] 
          +" "
          +this.getFullYear();
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T16:43:25.080

```
var feb22 = new Date(2012, 1, 22);
var feb23 = new Date(feb22.getTime() + 1000*60*60*24); 
```

...等等

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T16:46:19.827

您可以将变量 dateString 设置为您想要的任何值，并在循环中增加日期。然后你会得到日期，但我认为格式不同。

```
var dateString = '22 Feb 2012';
var actualDate = new Date(dateString);
var newDate;

for(var i=1; i<=7; i++){
 newDate = new Date(actualDate.getFullYear(), actualDate.getMonth(), actualDate.getDate()+i);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-16T20:18:44.333

如果您需要从今天开始接下来的 7 个工作日

```
const isWeekday = (date) => {
	return date.weekday()!==0 && date.weekday()!==6
}

const weekdays=[];
let numberOfDaysRequired = 7
let addDaysBy = 1
moment.locale('en')
while(weekdays.length < numberOfDaysRequired)
{
  const d = moment().add(addDaysBy, 'days')
  if(isWeekday(d))
  {
  	weekdays.push(d.format('dddd, Do MMMM YYYY'))

  }
  addDaysBy++;
}

console.log(weekdays)
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
```

# visual-studio - 任何人都可以识别这个 Visual Studio 2010 扩展吗？

> ID：10032458
> 
> 赞同：4
> 
> 时间：2012-04-05T16:33:34.583
> 
> 标签：visual-studio, visual-studio-extensions

我不确定是什么扩展正在绘制此屏幕截图中看到的“评论气泡”。 ![在此处输入图像描述](../Images/c45934477ef03a2ed290c459fa2722be.png)

我浏览了我有意安装的扩展程序，但没有看到将其关闭的选项。它要么来自我不知道的扩展，要么是我看过但错过的其中一个选项中的一个选项。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:06:51.460

它是开发快递。转到 DevExpress-> 选项

展开编辑器 -> 绘画，然后转到评论画家。取消选中启用。

# php - rsync progress doesn't work as expected

> ID：10032459
> 
> 赞同：0
> 
> 时间：2012-04-05T16:33:38.463
> 
> 标签：php, shell, ssh, rsync

I'm using

```
system('rsync --progress ssh '.$localZip.' user@server:'.$remoteZip); 
```

It starts out saying "filename.zip", but then my page just says loading over and over, and then suddenly at the end it spits out all the progress data. Shouldn't it spit out that data as it goes? It's an 89MB file.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:39:30.320

看[`ob_flush()`](http://www.php.net/manual/en/function.ob-flush.php)而不是正常`flush()`的，因为后者在浏览器中没有影响。

# git - Git keeps asking me for my ssh key passphrase

> ID：10032461
> 
> 赞同：695
> 
> 时间：2012-04-05T16:33:49.180
> 
> 标签：git, ssh-agent

I created keys as instructed in the github tutorial, registered them with github, and tried using ssh-agent explicitly — yet git continues to ask me for my passphrase every time I try to do a pull or a push.

What could be the cause?

* * *

## 回答 #1

> 赞同：1299
> 
> 时间：2012-04-05T16:47:05.897

使用以下命令启动 SSH 代理后：

```
eval $(ssh-agent) 
```

执行以下任一操作：

1.  要将您的私钥添加到其中：

    ```
     ssh-add 
    ```

    这只会询问你一次密码，然后你应该被允许推送，前提是你将公钥上传到 Github。

2.  要在 macOS 上永久添加和保存您的密钥：

    ```
     ssh-add -K 
    ```

    这将在您关闭并通过将其存储在用户的钥匙串中重新打开后将其保留。

3.  要在 Ubuntu（或同等设备）上永久添加和保存您的密钥：

    ```
     ssh-add ~/.ssh/id_rsa 
    ```

* * *

## 回答 #2

> 赞同：296
> 
> 时间：2017-01-10T18:51:35.800

自从从 OS X El Capitan (10.11) 升级到 macOS Sierra (10.12) 后重新启动后，这一直发生在我身上。该`ssh-add`解决方案暂时有效，但不会在另一次重新启动后持续存在。

永久的解决方案是编辑（或创建）`~/.ssh/config`并启用该`UseKeychain`选项。

```
Host *
    UseKeychain yes 
```

相关：[自从我更新到 Sierra 后，macOS 一直在询问我的 ssh 密码](https://superuser.com/questions/1127067/macos-keeps-asking-my-ssh-passphrase-since-i-updated-to-sierra)

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2016-12-19T10:20:38.170

如果您已尝试过`ssh-add`，但仍提示您输入密码，请尝试使用`ssh-add -K`. 这会将您的密码短语添加到您的钥匙串中。

*更新：如果您使用的是 macOS Sierra，那么您可能需要执行另一个步骤，因为上述步骤可能不再有效。将以下内容添加到您的`~/.ssh/config`:*

```
Host *
  UseKeychain yes 
```

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2013-10-01T07:03:38.653

我会尝试以下方法：

1.  启动[GitBash](https://openhatch.org/missions/windows-setup/install-git-bash)
2.  编辑您的`~/.bashrc`文件
3.  将以下行添加到文件中

```
SSH_ENV=$HOME/.ssh/environment

# start the ssh-agent
function start_agent {
    echo "Initializing new SSH agent..."
    # spawn ssh-agent
    /usr/bin/ssh-agent | sed 's/^echo/#echo/' > ${SSH_ENV}
    echo succeeded
    chmod 600 ${SSH_ENV}
    . ${SSH_ENV} > /dev/null
    /usr/bin/ssh-add
}

if [ -f "${SSH_ENV}" ]; then
     . ${SSH_ENV} > /dev/null
     ps -ef | grep ${SSH_AGENT_PID} | grep ssh-agent$ > /dev/null || {
        start_agent;
    }
else
    start_agent;
fi 
```

4.  保存并关闭文件
5.  关闭 GitBash
6.  重新打开 GitBash
7.  输入您的密码

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2016-04-20T19:38:46.063

在 Windows 上对我有用的是（我从 repo 1st 克隆了代码）：

```
eval $(ssh-agent)
ssh-add 
git pull 
```

那时它最后一次问我密码

学分：解决方案取自 [https://unix.stackexchange.com/questions/12195/how-to-avoid-being-asked-passphrase-each-time-i-push-to-bitbucket](https://unix.stackexchange.com/questions/12195/how-to-avoid-being-asked-passphrase-each-time-i-push-to-bitbucket)

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2017-03-09T20:40:15.697

尝试将此添加到您的**~/.ssh/config**：

```
Host *
   AddKeysToAgent yes
   UseKeychain yes
   IdentityFile ~/.ssh/id_rsa 
```

...假设您的私钥被命名为**id_rsa**

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2017-04-27T09:51:33.977

如果上述解决方案对我不起作用，要检查的一件事是您实际上也拥有公钥（通常是`id_rsa.pub`）。不这样做是不寻常的，但这就是我的原因。

从您的私钥创建您的公钥：

```
ssh-keygen -y -f ~/.ssh/id_rsa > ~/.ssh/id_rsa.pub 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2021-06-12T19:38:33.340

运行以下命令：

```
eval $(ssh-agent) && ssh-add ~/.ssh/id_rsa &>/dev/null 
```

输入密码，然后检查 git。Git 不应在此命令之后要求输入密码。

原文出处：[https ://gist.github.com/egoens/c3aa494fc246bb4828e517407d56718d](https://gist.github.com/egoens/c3aa494fc246bb4828e517407d56718d)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-03-05T19:40:34.790

我有一个类似的问题，但其他答案并没有解决我的问题。我想我会继续发布这个，以防万一其他人像我一样有一个古怪的设置。

事实证明我有多个密钥，而 Git 首先使用了错误的密钥。它会提示我输入密码，我会输入它，然后 Git 会使用另一个有效的密钥（我不需要输入密码）。

我刚刚删除了它用来提示我输入密码的密钥，现在它可以工作了！

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2020-09-01T02:25:35.420

如果您不使用 GitBash 并且在 Windows 上 - 您需要使用此命令启动 ssh-agent

```
start-ssh-agent.cmd 
```

如果您的 ssh 代理未设置，您可以以管理员身份打开 PowerShell 并将其设置为手动模式

```
Get-Service -Name ssh-agent | Set-Service -StartupType Manual 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2012-04-05T16:40:33.477

听起来您可能在使用 SSH-Agent 本身时遇到了问题。我会尝试排除故障。

1）您是否使用 ssh-add 将您的密钥添加到 SSH？

2）您是否在两次使用之间关闭了终端窗口，因为如果您关闭窗口，您将不得不在重新打开它时再次输入密码。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2020-11-12T18:22:35.507

对于**Windows**或**Linux**用户，[GitHub Docs](https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/working-with-ssh-key-passphrases)中描述了一种可能的解决方案，为了您的方便，我在下面报告了该解决方案。

您可以`ssh-agent`在打开 bash 或 Git shell 时自动运行。复制以下行并将它们粘贴到您的`~/.profile`or`~/.bashrc`文件中：

```
env=~/.ssh/agent.env

agent_load_env () { test -f "$env" && . "$env" >| /dev/null ; }

agent_start () {
    (umask 077; ssh-agent >| "$env")
    . "$env" >| /dev/null ; }

agent_load_env

# agent_run_state: 0=agent running w/ key; 1=agent w/o key; 2= agent not running
agent_run_state=$(ssh-add -l >| /dev/null 2>&1; echo $?)

if [ ! "$SSH_AUTH_SOCK" ] || [ $agent_run_state = 2 ]; then
    agent_start
    ssh-add
elif [ "$SSH_AUTH_SOCK" ] && [ $agent_run_state = 1 ]; then
    ssh-add
fi

unset env 
```

如果您的私钥未存储在默认位置之一（如`~/.ssh/id_rsa`），您需要告诉您的 SSH 身份验证代理在哪里可以找到它。要将您的密钥添加到 ssh-agent，请键入`ssh-add ~/path/to/my_key`.

现在，当您**第一次运行**Git Bash 时，系统会提示您输入密码。**该`ssh-agent`进程将继续运行，直到您注销、关闭计算机或终止该进程。**

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-08-15T12:25:17.017

我尝试了不同的解决方案，但没有任何帮助。但是来自 Bitbucket.com 接缝的这些步骤（[我的 GitBash SSH 环境总是要求我输入密码，我该怎么办？](https://confluence.atlassian.com/bitbucket/my-gitbash-ssh-environment-always-asks-for-my-passphrase-what-can-i-do-277252540.html)）效果很好：

这个想法是：

1.  你创建`~/.bashrc`文件

2.  添加以下脚本：

    ```
     SSH_ENV=$HOME/.ssh/environment

     # start the ssh-agent
     function start_agent {
         echo "Initializing new SSH agent..."
         # spawn ssh-agent
         /usr/bin/ssh-agent | sed 's/^echo/#echo/' > "${SSH_ENV}"
         echo succeeded
         chmod 600 "${SSH_ENV}"
         . "${SSH_ENV}" > /dev/null
         /usr/bin/ssh-add
     }

     if [ -f "${SSH_ENV}" ]; then
         . "${SSH_ENV}" > /dev/null
         ps -ef | grep ${SSH_AGENT_PID} | grep ssh-agent$ > /dev/null || {
             start_agent;
         }
     else
         start_agent;
     fi 
    ```

3.  重新运行 Bash

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2021-04-14T13:10:57.990

如果您使用的是 Win10：

我有同样的问题。（以前由于不同的问题，必须使用[此处的脚本单独更新 ssh-agent）](https://github.com/PowerShell/Win32-OpenSSH/issues/1263#issuecomment-499542944)

Git 确实访问了我的 ssh 配置（当我在 ssh 配置中有无意义的行时，git pull 抛出异常），但似乎从不关心我通过 ssh-agent 添加并在我的配置中引用的私钥。

解决问题的是在 PowerShell 中执行以下命令：

```
git config core.sshCommand (get-command ssh).Source.Replace('\','/') 
```

（详细信息在此[链接](https://www.teapotcoder.com/post/how-to-fix-git-ssh-asking-for-password-on-windows-10/)中）

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-10-26T17:57:25.090

上面未提及的另一种可能的解决方案是使用以下命令检查您的遥控器：

```
git remote -v 
```

如果遥控器不是以 git 开头，而是以 https 开头，您可能需要按照以下示例将其更改为 git。

```
git remote -v // origin is https://github.com/user/myrepo.git
git remote set-url origin git@github.com:user/myrepo.git
git remote -v // check if remote is changed 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-04-09T13:57:24.820

使用 SSH 而不是 HTTPS 更新源远程的 url；

```
git remote set-url origin "SSH URL COPIED FROM GIT REPO." 
```

这对我有用。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-10-22T14:27:58.247

在 mac 上，如果您的 ssh 密钥每次都需要密码并且您想跳过它，那么您可以在下面尝试，它对我来说很好

1.  eval "$(ssh-agent -s)"
2.  ssh-add -K .ssh/id_rsa
3.  添加此默认 ssh 配置对我有用

主机 *
AddKeysToAgent 是
UseKeychain 是
IdentityFile ~/.ssh/id_rsa

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-02-05T20:23:36.237

将远程重置为 ssh

```
git remote set-url origin git@github.com:Jmzgit/Moving.git 
```

似乎服务器需要重新启动密钥更新

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-04-30T15:02:57.507

如果您碰巧使用的是鱼，则有一个[要点](https://gist.github.com/josh-padnick/c90183be3d0e1feb89afd7573505cab3)：

```
# config.fish
if not pgrep -f ssh-agent > /dev/null
  eval (ssh-agent -c)
  set -Ux SSH_AUTH_SOCK $SSH_AUTH_SOCK
  set -Ux SSH_AGENT_PID $SSH_AGENT_PID
  set -Ux SSH_AUTH_SOCK $SSH_AUTH_SOCK
end 
```

# scala - SortedMap of SortedMaps from Map of List of objects, keyed on object member

> ID：10032466
> 
> 赞同：3
> 
> 时间：2012-04-05T16:34:20.547
> 
> 标签：scala, collections

我有一个无序的地图：

```
class O(val a: Int)
Map[String, List[O]] 
```

我想变成：

```
SortedMap[String, SortedMap[Int, O]] 
```

子 SortedMap 键在 O 字段上。

我敢肯定，一定有比下面更惯用的代码......

```
class O(val a: Int)

val a: Map[String, List[O]] = Map[String, List[O]]( ("b" -> List(new O(3), new O(2))), "a" -> List(new O(1), new O(2)))

val key1s = a map (_._1)

val oMapsList = ListBuffer[SortedMap[Int, O]]()

for (key1 <- key1s) { 
  val oList = a(key1)
  val key2s = oList map (_.a)

  val sortedOMap = SortedMap[Int, O]() ++ (key2s zip oList).toMap
  oMapsList += sortedOMap
}

val sortedMap = SortedMap[String, SortedMap[Int, O]]() ++ (key1s zip oMapsList).toMap 
```

预期的 sortedMap 内容是：

```
"a" -> ( (1 -> O(1)),(2 -> O(2)) )
"b" -> ( (2 -> O(2)),(2 -> O(3)) ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:53:08.973

首先，设置：

```
scala> case class O(i: Int)
defined class O

scala> Map("a" -> List(O(1), O(2)), "b" -> List(O(2), O(3)))
res0: scala.collection.immutable.Map[java.lang.String,List[O]] = Map(a -> List(O(1), O(2)), b -> List(O(2), O(3))) 
```

现在，导入`SortedMap`：

```
scala> import collection.immutable._
import collection.immutable._ 
```

现在寻找答案！

* * *

## 使用 breakOut（1 行代码）

使用`breakOut`- 但它涉及一些不受欢迎的类型重复：

```
scala> res0.map({ case (s, l) => s -> (l.map(o => o.i -> o)(collection.breakOut): SortedMap[Int, O]) })(collection.breakOut): SortedMap[String, SortedMap[Int, O]]
res4: scala.collection.immutable.SortedMap[String,scala.collection.immutable.SortedMap[Int,O]] = Map(a -> Map(1 -> O(1), 2 -> O(2)), b -> Map(2 -> O(2), 3  -> O(3))) 
```

## 使用单独的方法（2 行代码）

或者第二种方法是涉及一种`sort`方法：

```
scala> def sort[K: Ordering, V](m: Traversable[(K, V)]) = SortedMap(m.toSeq: _ *)
sort: [K, V](m: scala.collection.immutable.Traversable[(K, V)])(implicit evidence$1: Ordering[K])scala.collection.immutable.SortedMap[K,V] 
```

所以：

```
scala> sort(res0.mapValues(l => sort(l.map(o => o.i -> o)) ))
res13: scala.collection.immutable.SortedMap[java.lang.String,scala.collection.immutable.SortedMap[Int,O]] = Map(a -> Map(1 -> O(1), 2 -> O(2)), b -> Map(2 -> O(2), 3 -> O(3))) 
```

# ios - xCode 4.3.2 - build for profiling, how do you run the app?

> ID：10032467
> 
> 赞同：2
> 
> 时间：2012-04-05T16:34:21.180
> 
> 标签：ios, xcode

In xCode I click "Product -> build for -> profiling".

Then I hold down the run button until the drop down menu appears and select profiling. xCode runs and says "Finished running - Profiling MyApp.app on iDeviceName". However, the app never runs...

How do I build for profiling and then run?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:37:07.947

利用，

产品 -> 简介

从 Xcode 菜单。这将启动 Instruments，您可以从那里运行应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:48:35.587

在您的设备上运行该应用程序。打开仪器，然后选择您的目标。Xcode 4.3.2 的分析存在严重问题。这是我发现的唯一解决方法 ![在此处输入图像描述](../Images/046ea724d8c57ea6e871c89b73d359ad.png)

# javascript - 向应用程序用户提供分析数据的最佳方式是什么？

> ID：10032478
> 
> 赞同：1
> 
> 时间：2012-04-05T16:35:18.087
> 
> 标签：javascript, ruby-on-rails, google-analytics, redis

在网站上跟踪浏览量、分享和其他类型的事件并将数据提供给应用程序的某些用户的最佳方式是什么？例如，假设我有一个博客应用程序，我希望作者能够查看特定帖子被阅读或共享的次数......

我应该使用 Google Analytics API 还是应该使用键/值存储数据库推出自己的解决方案？还有其他选择吗？完成这样一项任务的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:39:07.120

谷歌分析可能是要走的路。虽然当然可以自行推出，但 GA 解决了许多您可能甚至没有想到的问题，而且它的 API 相当简单。

# android - 如何将数据传递给广播接收器？

> ID：10032480
> 
> 赞同：21
> 
> 时间：2012-04-05T16:35:24.857
> 
> 标签：android, string, android-intent, sms, broadcastreceiver

我想要做的是，我的应用程序向其发送消息的数字被传递给 BraodcastReceiver ......但到目前为止，要么我得到空值，要么 BroadcastReceiver 只是简单地崩溃......

这是我对来自 CreateMessage 类的 BroadcastReceiver 的意图...

```
 Intent intent = new Intent();
        Bundle bundle = new Bundle();
        bundle.putString("phN", phoneNo);
        intent.putExtras(bundle);
        startActivity(intent); 
```

在 BroadcastReceiver （SmsReceiver 类）中，我试图捕捉这样的意图..

```
public void onReceive(Context context, Intent intent) {
    //---get the SMS message passed in---
    Bundle bundle = intent.getExtras();
    try{
    //receiveNumbers = intent.getExtras().get("phN").toString();
        String  receiveNumbers = intent.getStringExtra("phN");
        Toast.makeText(context, receiveNumbers, Toast.LENGTH_LONG).show();
    }catch(Exception e){
        e.printStackTrace();
    } 
```

我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="com.AEM_n"
      android:versionCode="2" android:versionName="2.0">
    <uses-sdk android:minSdkVersion="8" />
    <uses-permission android:name="android.permission.READ_CONTACTS"/>
    <uses-permission android:name="android.permission.READ_SMS"/>    
    <uses-permission  android:name="android.permission.SEND_SMS"/>
    <uses-permission  android:name="android.permission.RECEIVE_SMS"/>

    <application android:icon="@drawable/icon" android:label="@string/app_name" android:debuggable="true">
        <activity android:name=".new_menu"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:label="@string/app_name"
            android:name=".SetEvent" >
            <intent-filter>
                <action android:name="com.AEM_n.SETEVENT" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
            </activity>
            <activity
            android:label="@string/app_name"
            android:name=".AddParticipants" />
            <activity
            android:label="@string/app_name"
            android:name=".CreateMessage" />
            <activity
            android:label="@string/app_name"
            android:name=".DataBaseClass" />
            <activity 
            android:label="@string/app_name"
            android:name=".IntentReceiver"/>
            <activity 
            android:label="@string/app_name"
            android:name=".SmsReceiver"
            />
            <receiver android:name=".SmsReceiver" android:exported="true">
            <intent-filter android:priority="999">
            <action android:name="android.provider.Telephony.SMS_RECEIVED"/>
            </intent-filter>
            </receiver>
    </application>

</manifest> 
```

我已经尝试了 Stackoverflow 给出的所有答案......但没有用......

请大家告诉我哪里出错了...谢谢！

错误日志：

```
04-07 02:34:02.770: ERROR/AndroidRuntime(25593): FATAL EXCEPTION: main
04-07 02:34:02.770: ERROR/AndroidRuntime(25593): java.lang.RuntimeException: Error receiving broadcast Intent { act=com.myapp.myaction (has extras) } in com.AEM_n.SmsReceiver@405a07c8
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:722)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at android.os.Handler.handleCallback(Handler.java:587)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at android.os.Looper.loop(Looper.java:123)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at android.app.ActivityThread.main(ActivityThread.java:3701)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at java.lang.reflect.Method.invokeNative(Native Method)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at java.lang.reflect.Method.invoke(Method.java:507)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:862)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:620)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at dalvik.system.NativeStart.main(Native Method)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593): Caused by: java.lang.NullPointerException
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at com.AEM_n.SmsReceiver.onReceive(SmsReceiver.java:37)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:709)
04-07 02:34:02.770: ERROR/AndroidRuntime(25593):     ... 9 more 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-07T10:37:31.283

按照@Jason 的例子......我做到了......

在 MainActivity 或您要从中发送意图的任何活动中

```
Intent intent = new Intent("my.action.string");
intent.putExtra("extra", phoneNo); \\ phoneNo is the sent Number
sendBroadcast(intent); 
```

然后在我的 SmsReceiver 类中我做了这个

```
public void onReceive(Context context, Intent intent) {
  String action = intent.getAction();

  Log.i("Receiver", "Broadcast received: " + action);

  if(action.equals("my.action.string")){
     String state = intent.getExtras().getString("extra");

  }
} 
```

在 manifest.xml 我添加了`"my.action.string"`虽然它是一个选项..

```
<receiver android:name=".SmsReceiver" android:enabled="true">
    <intent-filter>
        <action android:name="android.provider.Telephony.SMS_RECEIVED" />
        <action android:name="my.action.string" />
        <!-- and some more actions if you want -->
    </intent-filter>
</receiver> 
```

像魅力一样工作！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T16:53:22.260

你开始一个`Activity`而不是广播`Intent`。尝试改变

```
startActivity(intent); 
```

到

```
sendBroadcast(intent); 
```

**更新**：

您没有为`Intent`. 尝试如下创建意图：

```
Intent intent = new Intent(context, YourReceiver.class);
intent.putExtra("phN", phoneNo);
sendBroadcast(intent); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:51:16.123

你会像这样发送广播：

```
Intent intent = new Intent(action);
intent.putExtra("phN", phoneNo);
sendBroadcast(intent); 
```

该`action`参数是`String`与您注册的操作相关的`BroadcastReceiver`。因此，如果您像这样注册接收器：

```
MyBroadcastReceiver receiver = new MyBroadcastReceiver();
registerReceiver( receiver, new IntentFilter( "com.myapp.myaction" ) ); 
```

那么`action`将是`"com.myapp.myaction"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-23T05:13:23.680

你的问题其实很简单。像这样更改 onReceive() 代码就足够了：

```
public void onReceive(Context context, Intent intent) {
    String action = intent.getAction();

    Log.i("Receiver", "Broadcast received: " + action);

   if(action.equals("my.action.string")){
       String state = bundle.getString("phN");

   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-14T10:18:27.357

在活动中

```
Intent intent = new Intent(context, destinationActivity);
// Send String
intent.putExtra(Intent.EXTRA_TEXT, mNameEntryString);
// Send int
intent.putExtra("intVariableName", intValue);
startActivity(intent); 
```

在接收器中

```
Intent intent = getIntent();
// get string
String recievedString = intent.getStringExtra(Intent.EXTRA_TEXT);
// get int
int intValue = intent.getIntExtra("intVariableName", 0); // 0 je default 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2015-03-25T19:42:27.163

使用 sendbroadcast 而不是 startactivity.it 会工作..!!

# c# - C#：WMP，以毫秒/十分之一秒为单位的时间戳

> ID：10032481
> 
> 赞同：2
> 
> 时间：2012-04-05T16:35:27.213
> 
> 标签：c#, time, windows-media-player

我在 C# 项目中使用 WMP (AxWindowsMediaPlayer)，并希望提取准确的时间戳，最高可达 0.1 或 0.01 秒。有什么办法可以做到这一点？

由于太不精确，以下内容将不起作用：-/

```
player.Ctlcontrols.currentPositionString 
```

我不认为同时运行计时器是一个好的解决方案，因为每次用户暂停视频时我都必须停止和恢复它，并且在几次暂停和恢复后它最终会出错。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:44:09.397

您是否尝试过使用 currentPosition 属性，它在几秒钟内从开始返回一个 double 而不是 currentPositionString，它返回一个字符串 MM:ss 格式。

字符串格式只会为您提供最接近第二个整数值的精度。双精度的 currentPosition 属性应该给你几分之一秒。

参考

currentPositionString [http://msdn.microsoft.com/en-us/library/windows/desktop/dd564739(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd564739(v=vs.85).aspx)

[当前](http://msdn.microsoft.com/en-us/library/windows/desktop/dd564740(v=vs.85).aspx)位置 http://msdn.microsoft.com/en-us/library/windows/desktop/dd564740(v=vs.85).aspx

# spring - 设置休眠/春季项目的最佳方法

> ID：10032482
> 
> 赞同：0
> 
> 时间：2012-04-05T16:35:32.907
> 
> 标签：spring, hibernate, gwt

我在 GWT 中有一个带有 spring 和 hibernate 的项目，我在 applicationcontext.xml 下面使用，我只是在寻找一些最好的方法来制作这个文件，就像下面的所有带注释的类一样，即 entity.user、entity.secretQuestion 等等，他们即使我不需要它们，当我的应用程序运行时都会调用它们，我想这会使我的应用程序很慢，所以有可能只有我正在调用的类在 applicationcontext.xml 中加载，如果是，那么它会也是一种更好的方法吗？

```
 <bean id="sessionFactory"
                class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean"> 
              <property name="dataSource" ref="dataSource" /> 
              <property name="annotatedClasses"> 
              <list> 
              <value>com.cricsite.persistence.entity.User</value>
              <value>com.cricsite.persistence.entity.SecretQuestion</value>

                </list> 
                </property> 
                </bean>
               <bean id ="ManagerAdmin" class= "com.persistence.MySQLRdbHelper">
                <property name="sessionFactory" ref="sessionFactory" />
                </bean> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:41:20.573

您可能正在寻找一种叫做“延迟加载”的东西

请查看这些线程；

[Spring/Hibernate 延迟加载需要帮助](https://stackoverflow.com/questions/2976888/help-needed-with-spring-hibernate-lazy-loading)

[Hibernate 中的延迟加载是什么？](https://stackoverflow.com/questions/2192242/what-is-lazy-loading-in-hibernate)

[spring 如何允许延迟加载？](https://stackoverflow.com/questions/2043976/how-does-spring-allow-for-lazy-loading)

# ide - 如何将 LiteIDE 用于 Go 项目？

> ID：10032483
> 
> 赞同：5
> 
> 时间：2012-04-05T16:35:33.867
> 
> 标签：ide, go, liteide

我已经为 Go 安装了 LiteIDE IDE。我创建了一个新的 Go 项目，但是当我尝试运行它时，我得到：

```
<action id="Run" cmd="$(TARGETPATH)" args="$(TARGETARGS)"> &lt;start=" " workdir=""/> &lt;error msg="process failed to start" /> &lt;/action> 
```

我想我需要配置 LiteIDE，但我不知道如何配置，也没有找到任何相关文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T02:31:34.743

像这样的东西：

1.  在 YOUR_PATH 中创建 Go1 项目
2.  导入项目（在项目窗口中）并将自定义 GOOPATH 设置为 YOUR_PATH。
3.  在 YOUR_PATH 的上下​​文菜单中设置活动项目。

# iphone - 如何在 iPhone 应用上仅支持纵向模式

> ID：10032490
> 
> 赞同：5
> 
> 时间：2012-04-05T16:36:30.317
> 
> 标签：iphone, objective-c, xcode, autorotate, device-orientation

我正在开发的 iPhone 应用程序中有一个奇怪的问题。我希望我的应用**仅**支持纵向模式，但由于某种原因我不能这样做（设备和模拟器）。

为了仅支持纵向模式，我执行了以下操作：

*   在 Xcode 的 TARGET 摘要部分，我只选择了肖像。
*   我所有的 ViewControllers 实现`shouldAutorotateToInterfaceOrientation`

但正如我所说，它不起作用，奇怪的结果是应用程序支持**所有**方向（纵向、倒置、横向左侧、横向右侧）。
有任何想法吗？

这就是我实现的方式`shouldAutorotateToInterfaceOrientation`

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
     // Return YES for supported orientations
     NSLog(@"Checking orientation %d", interfaceOrientation);
     return (interfaceOrientation == UIInterfaceOrientationPortrait);
} 
```

**我刚才注意到**，当我旋转手机时，我收到了这条消息：

> “不推荐使用两阶段旋转动画。此应用程序应使用更流畅的单阶段动画。”

这是什么意思？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T16:37:24.803

在目标摘要上，仅选择纵向。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T18:09:17.677

转到 info.plist 文件。右键单击将其作为源代码打开。并寻找这条线。对我来说 iPad 是这样的：

```
 <key>UISupportedInterfaceOrientations~ipad</key> 
```

删除所有其他方向并保留唯一需要的方向..像这样：

```
 <array>

    <string> UIInterfaceOrientationPortrait </string>

</array> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-12T13:37:49.757

屏幕上可以有多个 ViewController。它`UITabBarController`本身就是 a `UIViewController`，如果它选择，它只会将`shouldAutorotateToInterfaceOrientation:`请求传递给其中的 viewControllers。默认实现会执行此操作，但如果您将其子类化，则 XCode 生成的代码（从 iOS 5.1 开始）不会。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T16:38:31.643

检查您的 plist 并确保那里的密钥设置正确。

# regex - 正则表达式字符 ?, $, |

> ID：10032491
> 
> 赞同：-1
> 
> 时间：2012-04-05T16:36:31.713
> 
> 标签：regex

我有以下数据：

> abc 定义；吉。

此正则表达式将匹配：

```
([a-z0-9A-ZÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÒÓÔÕÖÙÚÛÜÝàáâãäåçèéêëìíîïðòóôõöùúûüýÿ ]*)\W (.*)( (\w\.))? 
```

这个正则表达式也将匹配

```
([a-z0-9A-ZÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÒÓÔÕÖÙÚÛÜÝàáâãäåçèéêëìíîïðòóôõöùúûüýÿ ]*)\W (.*)$ 
```

我对正则表达式还是很陌生，但我想 | 代表 OR, () 分组和 ? 代表 0 次或 1 次出现。所以我认为在组合上述查询时它仍然会匹配。但是，以下内容将不匹配：

```
([a-z0-9A-ZÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÒÓÔÕÖÙÚÛÜÝàáâãäåçèéêëìíîïðòóôõöùúûüýÿ ]*)\W (.*)( (\w\.))|$ 
```

我究竟做错了什么？

附言。我正在使用以下内容来测试我的正则表达式。 [http://regexpal.com/](http://regexpal.com/)

编辑：我没有使用代码标签，所以一个字符消失了

EDIT2：我要匹配的是以下内容，数据将是一个名称。所以“abc def”是姓氏。ghi 称呼（英语不是我的母语，这是像先生这样的词的正确术语吗？）。然而，名字的第一个字母是可能的。这就是为什么它应该是行尾，或者那个字母。

涉及名字时的数据将是：

> 美国广播公司；定义。G。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:30:59.453

| 的运算符优先级 操作员有点棘手。将其两个操作数显式括在括号中通常是个好主意。此外，请注意在您的正则表达式中插入空格。看起来您想匹配 \w 中的文字句点。片段，以匹配“G”。

所以我认为你想要的组合表达式是这样的

```
((.*)( (\w\.))?)|(.*)$ 
```

但由于 ？表示 0 或更多，正如您所了解的，这可以重写为

```
(.*)( (\w\.))?)$ 
```

而且，要重新添加表达式的其余部分，我们有

```
^[a-z0-9A-ZÀÁÂÃÄÅÇÈÉÊËÌÍÎÏÒÓÔÕÖÙÚÛÜÝàáâãäåçèéêëìíîïðòóôõöùúûüýÿ ]*)\W (.*)( (\w\.))?)$ 
```

而且，是的，“salutation”或“greeting”是“Mr.”、“Ms.”、“Dr.”等的好词。

# vbscript - Outlook VBScript 预期语句错误

> ID：10032492
> 
> 赞同：0
> 
> 时间：2012-04-05T16:36:33.320
> 
> 标签：vbscript, outlook, odbc, ado

我是这个网站的新手。我已经彻底寻找答案，但似乎找不到答案。我希望你们中的一个好人能够帮助我......

谢谢

当我尝试使用下面显示的代码运行我的自定义表单时，我收到以下消息：

```
Script Error
Expected statement
Line No:33 
```

代码：

```
Function Item_Open()
    Dim LeaveItem
    Dim IO
    If not Connection_Open Then
        MsgBox("Error connecting to SI")
        LeaveItem = True
        Item_Open = False
    Else
        Item_Open = False
    End If
End Function

Function Item_Close()
    If LeaveItem = True Then
        Exit_Function
    Else
    End If
End Function

Subroutine Connection_Open()
    Dim oSI
    Set oSI = New ADODB.Connection
    Dim ostrSI
    oSI.ConnectionString = "Driver={Progress OpenEdge 10.1C  Driver};HOST=192.168.1.1;DB=kob;UID=sii;PWD=sisys1;PORT=2501;"
    oSI.Open
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:46:05.510

改变

```
Subroutine Connection_Open() 
```

至

```
Sub Connection_Open() 
```

# ruby - 机械化如何获取当前网址

> ID：10032494
> 
> 赞同：16
> 
> 时间：2012-04-05T16:36:35.643
> 
> 标签：ruby, mechanize

我有这个代码

```
require 'mechanize'
@agent = Mechanize.new
page = @agent.get('http://something.com/?page=1')
next_page = page.link_with(:href=>/^?page=2/).click 
```

如您所见，此代码应转到下一页。

`next_page`应该有网址`http://something.com/?page=2`

如何获取当前网址`next_page`？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-05T19:14:07.357

```
next_page.uri.to_s 
```

请参阅[http://www.rubydoc.info/gems/mechanize/Mechanize/Page/Link#uri-instance_method](http://www.rubydoc.info/gems/mechanize/Mechanize/Page/Link#uri-instance_method)和[http://ruby-doc.org/stdlib-2.4.1/libdoc/uri/rdoc/URI.html](http://ruby-doc.org/stdlib-2.4.1/libdoc/uri/rdoc/URI.html)

出于测试目的，我在 irb 中做了以下操作：

```
require 'mechanize'
@agent = Mechanize.new

page = @agent.get('http://news.ycombinator.com/news')
=> #<Mechanize::Page
 {url #<URI::HTTP:0x00000001ad3198 URL:http://news.ycombinator.com/news>}
 {meta_refresh}
 {title "Hacker News"}
 {iframes}
 {frames}
 {links
  #<Mechanize::Page::Link "" "http://ycombinator.com">
  #<Mechanize::Page::Link "Hacker News" "news">
  #<Mechanize::Page::Link "new" "newest">
  #<Mechanize::Page::Link "comments" "newcomments">
  #<Mechanize::Page::Link "ask" "ask">
  #<Mechanize::Page::Link "jobs" "jobs">
  #<Mechanize::Page::Link "submit" "submit">
  #<Mechanize::Page::Link "login" "newslogin?whence=%6e%65%77%73">
  #<Mechanize::Page::Link "" "vote?for=3803568&dir=up&whence=%6e%65%77%73">
  #<Mechanize::Page::Link
   "Don’t Be Evil: How Google Screwed a Startup"
   "http://blog.hatchlings.com/post/20171171127/dont-be-evil-how-google-screwed-a-startup">
  #<Mechanize::Page::Link "mikeknoop" "user?id=mikeknoop">
  #<Mechanize::Page::Link "64 comments" "item?id=3803568">
  #<Mechanize::Page::Link "" "vote?for=3802515&dir=up&whence=%6e%65%77%73">
  # Omitted for brevity...

next_page.uri
 => #<URI::HTTP:0x00000001fa7818 URL:http://news.ycombinator.com/news2> 

next_page.uri.to_s
 => "http://news.ycombinator.com/news2" 
```

# php - php mysql query - 查询中变量的输出值

> ID：10032495
> 
> 赞同：1
> 
> 时间：2012-04-05T16:36:44.410
> 
> 标签：php, mysql

我在 php 中有以下 mysql 查询：

```
$results = $wpdb->get_results("SELECT * FROM $wpdb->postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE '%details%'"); 
```

但是我希望通过更改`LIKE`查询部分来动态查询。代替：

```
LIKE '%details%' 
```

我想在那里放一个变量：

```
LIKE '% $format %' 
```

其中 $format 是一个字符串。

到目前为止，我尝试过的一切都失败了。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T12:35:57.323

你已经得到了答案。我可以完全按照你的意愿去做。

```
$results = $wpdb->get_results("SELECT * FROM $wpdb->postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE '%$details%'"); 
```

[由于查询包含在双引号中，因此您无需转义任何内容。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:44:53.593

您的字符串已经在双引号中，因此只需用花括号将变量括起来，您就可以开始使用了。

```
"SELECT * FROM $wpdb->postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE '%{$format}%'" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:40:18.377

尝试用大括号括起来：

```
LIKE '%{$format}%' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T16:40:32.137

由于您使用双引号，您可以简单地执行以下操作：

```
$results = $wpdb->get_results("SELECT * FROM $wpdb->postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE '%$format%'"); 
```

或者简单地连接字符串：

```
$results = $wpdb->get_results("SELECT * FROM $wpdb->postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE '%" . $format . "%'"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T12:28:36.433

在传递变量之前执行此操作

```
$format = '%' . $format . '%';
now simply put it in the query.

$results = $wpdb->get_results("SELECT * FROM $wpdb->postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE '$format'"); 
```

# android - 我的 android 应用程序不能在 2 台设备上运行，但可以在模拟器上运行

> ID：10032498
> 
> 赞同：0
> 
> 时间：2012-04-05T16:36:58.013
> 
> 标签：android, maps, avd

我正在编写一个在登录屏幕后立即显示 Google Map 的应用程序。构建目标设置为 2.3，我的设备运行：

1) 三星 Galaxy Ace (2.3.4) 2) 摩托罗拉 Xoom (3.1)

我在 Android 模拟器上尝试了我的应用程序，它运行良好。登录和地图显示。

当我通过计算机上的 USB 连接两个设备并选择它们来运行应用程序时（注意：选择时构建目标旁边有一个橙色警告标志），登录屏幕显示得很好，当我单击“登录”时应用程序在摩托罗拉上崩溃并冻结了一段时间，然后在我的 Galaxy Ace 上什么也不做。

请注意，它们都可以连接到互联网。

通过 USB 连接运行应用程序时设备的 Logcat：

1) 三星银河王牌

```
04-06 00:24:21.599: I/InputReader(162): dispatchTouch::touch event's action is 0
04-06 00:24:21.599: I/InputDispatcher(162): Delivering touch to current input target: action: 0, channel '40796920 com.cylbs.android/com.cylbs.android.MainActivity (server)'
04-06 00:24:21.699: I/InputReader(162): dispatchTouch::touch event's action is 1
04-06 00:24:21.699: I/InputDispatcher(162): Delivering touch to current input target: action: 1, channel '40796920 com.cylbs.android/com.cylbs.android.MainActivity (server)'
04-06 00:24:27.709: W/PowerManagerService(162): Timer 0x3->0x3|0x1
04-06 00:24:28.559: D/BatteryService(162): update start
04-06 00:24:28.569: D/BatteryService(162): update start
04-06 00:24:28.579: D/BatteryService(162): update start 
```

2) 摩托罗拉 Xoom

```
04-06 00:27:13.490: D/AndroidRuntime(3163): Shutting down VM
04-06 00:27:13.490: W/dalvikvm(3163): threadid=1: thread exiting with uncaught exception (group=0x40154760)
04-06 00:27:13.510: E/AndroidRuntime(3163): FATAL EXCEPTION: main
04-06 00:27:13.510: E/AndroidRuntime(3163): android.os.NetworkOnMainThreadException
04-06 00:27:13.510: E/AndroidRuntime(3163):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1077)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at dalvik.system.BlockGuard$WrappedNetworkSystem.connect(BlockGuard.java:368)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:208)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:431)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at java.net.Socket.connect(Socket.java:901)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:75)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection.<init>(HttpConnection.java:48)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnection$Address.connect(HttpConnection.java:304)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpConnectionPool.get(HttpConnectionPool.java:89)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getHttpConnection(HttpURLConnectionImpl.java:292)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.makeConnection(HttpURLConnectionImpl.java:274)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:217)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getOutputStream(HttpURLConnectionImpl.java:624)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at com.cylbs.android.MainActivity.tryLogin(MainActivity.java:65)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at com.cylbs.android.MainActivity$1.onClick(MainActivity.java:41)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at android.view.View.performClick(View.java:3110)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at android.view.View$PerformClick.run(View.java:11928)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at android.os.Handler.handleCallback(Handler.java:587)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at android.os.Looper.loop(Looper.java:132)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at android.app.ActivityThread.main(ActivityThread.java:4025)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at java.lang.reflect.Method.invokeNative(Native Method)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at java.lang.reflect.Method.invoke(Method.java:491)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
04-06 00:27:13.510: E/AndroidRuntime(3163):     at dalvik.system.NativeStart.main(Native Method) 
```

这是我的 MainActivity 代码，它只是 Login 和 Home 活动，它是地图出现的地方：

主要活动：

```
package com.cylbs.android;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.net.HttpURLConnection;
import java.net.URL;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity {
    private Button login;
    private EditText username, password;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        login = (Button) findViewById(R.id.logIn);
        username = (EditText) findViewById(R.id.username);
        password = (EditText) findViewById(R.id.password);

        login.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                String   mUsername = username.getText().toString();
                String  mPassword = password.getText().toString();

                tryLogin(mUsername, mPassword);

            }
        });
    }

    public boolean tryLogin(String mUsername, String mPassword)
    {           
        HttpURLConnection connection;
        OutputStreamWriter request = null;

            URL url = null;   
            String response = null;         
            String parameters = "username="+mUsername+"&password="+mPassword;   
            final TextView result = (TextView) findViewById(R.id.result);

            try
            {
                url = new URL("http://10.0.2.2/database_test/index.php");
                connection = (HttpURLConnection) url.openConnection();
                connection.setDoOutput(true);
                connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
                connection.setRequestMethod("POST");    

                request = new OutputStreamWriter(connection.getOutputStream());
                request.write(parameters);
                request.flush();
                request.close();            
                String line = "";               
                InputStreamReader isr = new InputStreamReader(connection.getInputStream());
                BufferedReader reader = new BufferedReader(isr);
                StringBuilder sb = new StringBuilder();
                while ((line = reader.readLine()) != null)
                {
                    sb.append(line);
                }
                // Response from server after login process will be stored in response variable.                
                response = sb.toString();
                // You can perform UI operations here
                Toast.makeText(this,"."+ response +".", 0).show();          

                if (response.equals("Success"))
                {
                    Session obj = new Session();
                    obj.setUsername(mUsername);

                    Intent myIntent = new Intent(MainActivity.this, Home.class);
                    startActivity(myIntent);
                    result.setText("Login successful");
                }   
                else
                {
                    result.setText("Login fail. Please try again");
                }
                isr.close();
                reader.close();
            }
            catch(IOException e)
            {
                // Error
            }
            return true;
    }

} 
```

和 Home 活动（扩展 MapActivity）

```
package com.cylbs.android;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapController;
import com.google.android.maps.MapView;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class Home extends MapActivity {

    MapController mControl;
    GeoPoint geoP;
    MapView mapV;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.home);

        mapV = (MapView) findViewById(R.id.mapView);
        mapV.displayZoomControls(true);
        mapV.setBuiltInZoomControls(true);

        double lat = 40.8;
        double longi = -96.666;

        geoP = new GeoPoint((int) (lat *1E6), (int) (longi *1E6));

        mControl = mapV.getController();
        mControl.animateTo(geoP);
        mControl.setZoom(13);

        Button emergencies = (Button) findViewById(R.id.emergencyButton);
        emergencies.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                Intent myIntent = new Intent(Home.this, EmergencyList.class);
                Home.this.startActivity(myIntent);
            }
        });
        Button disruptions = (Button) findViewById(R.id.disruptionButton);
        disruptions.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                Intent myIntent2 = new Intent(Home.this, DisruptionList.class);
                startActivity(myIntent2);
            }
        });
    }

    @Override
    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }
} 
```

有任何想法吗？想法？这就是现在。非常感谢。

PS我是一个新的安卓开发者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:52:47.607

我假设您正在使用不同的 Maps API KEY 来模拟应用程序，并使用另一个不同的方式使用您的 MD5 签名来在设备上运行应用程序。[在这里](http://code.google.com/intl/es-ES/android/add-ons/google-apis/mapkey.html)查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-11T11:20:50.940

如果其他人有同样的问题，我想我已经找到了解决方案。

我在 LogCat 中查找了错误：

```
04-06 00:27:13.510: E/AndroidRuntime(3163): android.os.NetworkOnMainThreadException 
```

并根据这个[http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)

似乎某些（较新的）android 版本不允许在 MainActivity 或类似的东西中请求互联网连接。

即使我的目标是 android 版本 10 (2.3)，我仍然遇到错误，所以我将项目目标更改为版本 8，现在它似乎可以正常工作了。

# node.js - SocketIO 组

> ID：10032506
> 
> 赞同：3
> 
> 时间：2012-04-05T16:37:23.117
> 
> 标签：node.js, socket.io

我正在尝试 SocketIO，但我被卡住了。我找不到任何合适的文档。

这是我想做的示例代码：

```
io.sockets.in('group1').join('group2');
io.sockets.in('group3').on('message', function(){}); 
```

这两个特定操作是否有任何解决方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-06T09:29:06.663

您需要做的是将一个套接字加入（）到一个组中：

```
var io = require('socket.io').listen(80);

io.sockets.on('connection', function (socket) {
  socket.join('justin bieber fans'); // put socket in a channel
  socket.broadcast.to('justin bieber fans').emit('new fan'); // broadcast a message to a channel
  io.sockets.in('rammstein fans').emit('new non-fan'); // to another channel
}); 
```

您需要为连接到您的每个套接字执行此操作。

这来自[https://github.com/LearnBoost/socket.io](https://github.com/LearnBoost/socket.io)的文档（搜索房间）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T17:50:56.960

函数 io.sockets.clients 是我需要的。它允许我遍历特定房间的客户，必要时将它们添加到组中，或注册事件。

# python - python命名参数自动命名

> ID：10032512
> 
> 赞同：0
> 
> 时间：2012-04-05T16:37:52.137
> 
> 标签：python, argument-passing

因此，如果我有一个带有大量命名参数的函数：

```
def foo(a = 1, b = 2, c = 3, d = 4, e = 5) # etc...
    pass 
```

我用与定义中的名称完全相同的所有参数来调用它：

```
a = 0
b = 0
c = 0
d = 0
e = 0 
```

有没有办法避免这样做？

```
foo(e = e, b = b, d = d, a = a, c = c) 
```

并这样做：

```
foo(e, b, d, a, c) 
```

?

我想我可以这样做：

```
foo(a, b, c, d, e) 
```

但是如果参数名称很复杂，我记不起它们的顺序怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T16:50:28.067

好吧，您*可以*执行以下操作：

```
def foo(a, b, c, d):
    print a, b, c, d

d = 4
b = 2
c = 3
a = 1

import inspect
foo(*[locals().get(arg, None) for arg in inspect.getargspec(foo).args]) 
```

但我不确定我是否可以推荐这个......在实践中我会使用一个参数字典：

```
foo_params = {
    'd' : 4,
    'b' : 2,
    'c' : 3,
    'a' : 1
}

foo(**foo_params) 
```

编写一个`foo`使用较少参数的包装器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T17:12:03.907

如果更改函数不是您的选择，但您可以自由更改为传递的参数分配值的方法，这里有一个示例代码，可能对您有所帮助。这使用 orderdict 来保存

给定

```
>>> def foo(a = 1, b = 2, c = 3, d = 4, e = 5):
    print "a={0},b={1},c={2},d={3},e={4}".format(a,b,c,d,e) 
```

你能做的

```
>>> var=dict()
>>> var['c']=12
>>> var['a']=10
>>> var['b']=11
>>> var['e']=14
>>> foo(**var)
a=10,b=11,c=12,d=4,e=14 
```

请注意，此答案类似于@thg435 提出的答案，但您是

1.  不使用检查来破解函数期望的参数。
2.  不查看本地/全局字典。
3.  支持默认为默认参数的缺失参数。
4.  当然，您不必记住顺序。
5.  而且您甚至不必将变量作为参数传递。只是通过字典。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T16:53:38.507

Python 的参数传递机制*非常*灵活。如果它们不够灵活，这对我来说似乎是一种设计气味......

*   可能的气味：**函数的参数太多**。解决方案：拆分为多个函数，在字典或对象中一起传递一些 args。

*   可能的气味：**错误的变量名**。解决方案：给变量起更具描述性的名称。

或者只是咬紧牙关，找出正确的顺序，并保持简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:00:55.270

Calling a 5-argument function with a completely different set of arguments each time is pretty rare. If, in practice, you're using the same a, c, and e args most of the time and calling with different b and d args (for example), you can create a class to help you with this:

```
class FooWrapper(object):
    def __init__( self, commonA, commonC, commonE ):
        self.a = commonA
        self.c = commonC
        self.e = commonE

    def invokeFoo( self, _b, _d ):
        foo( a=self.a, b = _b, c = self.c, d = _d, e = self.e )

w = FooWrapper( 1, 2, 3 )
w.invokeFoo( 4, 5 )          # calls foo( 1, 4, 2, 5, 3 )
w.invokeFoo( 6, 7 )          # calls foo( 1, 6, 2, 7, 3 ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T16:51:23.057

您可以执行以下操作：

```
def func(a=1, b=2, c=3, **kw):
    print a,b,c

a = 11
b = 22
c = 33

func(**locals()) 
```

# r - ggplot2图例到底部和水平

> ID：10032513
> 
> 赞同：122
> 
> 时间：2012-04-05T16:38:07.547
> 
> 标签：r, ggplot2

如何将`ggplot2`图例移动到情节底部并水平转动？

**示例代码：**

```
library(reshape2) # for melt
df <- melt(outer(1:4, 1:4), varnames = c("X1", "X2"))
p1 <- ggplot(df, aes(X1, X2)) + geom_tile(aes(fill = value))
p1 + scale_fill_continuous(guide = guide_legend()) 
```

**期望的（近似）结果：** ![在此处输入图像描述](../Images/5ebe367497bc504fef4c2178404f4c62.png)

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2012-04-05T17:09:12.137

如果要移动图例的位置，请使用以下代码：

```
library(reshape2) # for melt
df <- melt(outer(1:4, 1:4), varnames = c("X1", "X2"))
p1 <- ggplot(df, aes(X1, X2)) + geom_tile(aes(fill = value))
p1 + scale_fill_continuous(guide = guide_legend()) +
    theme(legend.position="bottom") 
```

这应该会给你想要的结果。 ![底部图例](../Images/844f0cc4de72bb8eb9777b8907821291.png)

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2015-06-20T23:05:31.933

以下是创建所需结果的方法：

```
library(reshape2); library(tidyverse)
melt(outer(1:4, 1:4), varnames = c("X1", "X2")) %>%
ggplot() + 
  geom_tile(aes(X1, X2, fill = value)) + 
  scale_fill_continuous(guide = guide_legend()) +
  theme(legend.position="bottom",
        legend.spacing.x = unit(0, 'cm'))+
  guides(fill = guide_legend(label.position = "bottom")) 
```

![](../Images/21aa8599b0f7783d0f940d084a51723a.png)

^(由[reprex 包](https://reprex.tidyverse.org)（v0.3.0）于 2019 年 12 月 7 日创建)

* * *

编辑：不再需要这些不完美的选项，但我将它们留在这里以供参考。

两个不完美的选项不能完全满足您的要求，但非常接近（至少会将颜色放在一起）。

```
library(reshape2); library(tidyverse)
df <- melt(outer(1:4, 1:4), varnames = c("X1", "X2"))
p1 <- ggplot(df, aes(X1, X2)) + geom_tile(aes(fill = value))
p1 + scale_fill_continuous(guide = guide_legend()) +
 theme(legend.position="bottom", legend.direction="vertical") 
```

![](../Images/b728d7fa1a300b4c47bf991cef19b229.png)

```
p1 + scale_fill_continuous(guide = "colorbar") + theme(legend.position="bottom") 
```

![](../Images/6900ee2eae9ead81578c9c3630a149c1.png)

^(由[reprex 包](https://reprex.tidyverse.org)（v0.2.1）于 2019 年 2 月 28 日创建)

# android - 如何在运行时切换视图？

> ID：10032514
> 
> 赞同：1
> 
> 时间：2012-04-05T16:38:08.053
> 
> 标签：android, user-interface, view, android-activity, runtime

我的会计应用程序中有以下代码：

```
// switch View to the Customer layout, widget id's are the same on both layouts
private void hideExpenseView() {
    setContentView(R.layout.customer_invoices);
}

// switch View to the Supplier layout
private void hideIncomeView() {
    setContentView(R.layout.supplier_invoices);
} 
```

以上不起作用，因为当您切换 ContentView 时，您会丢失所有变量映射。不幸的是，您必须在 setContentView() 之后映射变量。

如果这可行，这对我的应用程序来说将是一个非常简单的解决方案。看，我已经将两个 xml 布局中的小部件命名为相同的 ID。我没有根据不同的状态隐藏一个 xml 布局的元素，而是将整个视图切换到适当的布局 - 无论是输入客户销售发票还是供应商费用发票。

通过切换视图，我基本上只需要 6 行代码来处理 UI 转换，非常简单。

我希望这仍然可以以另一种身份进行，有人可以将我推向正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:46:28.910

查看 ViewSwitcher：见[http://developer.android.com/reference/android/widget/ViewSwitcher.html](http://developer.android.com/reference/android/widget/ViewSwitcher.html)

或者将您的活动布局基于包含供应商发票.xml 和客户发票.xml 的框架布局中。那么你自己的 hide-n-show 将是 g2g。寿，您可能仍需要更改 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:50:40.203

您可以将视图包装成两种`LinearLayouts`，一种是 for `R.layout.customer_invoices`，另一种是 for `R.layout.supplier_invoices`。

您需要实现自己的 findViewById。

```
private static final int LAYOUT_EXPENSE = 1;
private static final int LAYOUT_INCOME = 2;

private int currentLayout = LAYOUT_EXPENSE;

private LinearLayout expenseContainer, incomeContainer;

// switch View to the Customer layout, widget id's are the same on both layouts
private void hideExpenseView() {
    switchLayout(LAYOUT_INCOME);
}

// switch View to the Supplier layout
private void hideIncomeView() {
    switchLayout(LAYOUT_EXPENSE);    
}

private void switchLayout(int layout) {
    currentLayout = layout;
    if (layout == LAYOUT_EXPENSE) { 
        expenseContainer.setVisibility(VISIBLE);
        incomeContainer.setVisibility(GONE);
    } else {
        expenseContainer.setVisibility(GONE);
        incomeContainer.setVisibility(VISIBLE);
    }
}

public View findViewById(int id) {
    if (layout == LAYOUT_EXPENSE) return expenseContainer.findViewById(id);
    else return incomeContainer.findViewById(id);
} 
```

我想你明白了我的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:04:23.137

这样做

## 主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/customer_invoices"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <!-- put customer_invoices related tools like TextView, Button, ImageView here -->

    </LinearLayout>

    <LinearLayout
        android:id="@+id/supplier_invoices"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <!-- put supplier_invoices related tools like TextView, Button, ImageView here -->

    </LinearLayout>

</LinearLayout> 
```

## Java代码：

```
public class TestActivity extends Activity {
    View supplier_invoices,customer_invoices;
    public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

        supplier_invoices = findViewById(R.id.supplier_invoices);

        customer_invoices = findViewById(R.id.customer_invoices);

        }

     // switch View to the Customer layout, widget id's are the same on both layouts
        private void hideExpenseView() {
            setContentView(R.layout.customer_invoices);
            customer_invoices.setVisibility(View.VISIBLE);
            supplier_invoices.setVisibility(View.GONE);

        }

        // switch View to the Supplier layout
        private void hideIncomeView() {

            supplier_invoices.setVisibility(View.VISIBLE);
            customer_invoices.setVisibility(View.GONE);
        }

    } 
```

# objective-c - 有没有办法使用 UIActionSheet 导航到其他视图？

> ID：10032517
> 
> 赞同：0
> 
> 时间：2012-04-05T16:38:16.993
> 
> 标签：objective-c, ios

有没有办法使用操作表导航到另一个视图？

我有一个按钮 - “开始”和一个询问“您要继续吗？”的操作表。并在其中“是”和“取消”

按是时我可以导航到另一个视图吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:42:23.153

对的，这是可能的。为此`viewController`， 表示`UIActionSheet`需要采用`UIActionSheetDelegate`。使用 Yes 或 Cancel 关闭操作表后，`- actionSheet:didDismissWithButtonIndex:`将调用方法，然后您可以从那里导航到另一个视图或忽略它。

参考资料：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UIActionSheet_Class/Reference/Reference.html#//apple_ref/occ/cl/UIActionSheet](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIActionSheet_Class/Reference/Reference.html#//apple_ref/occ/cl/UIActionSheet)

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIModalViewDelegate_Protocol/UIActionSheetDelegate/UIActionSheetDelegate.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIModalViewDelegate_Protocol/UIActionSheetDelegate/UIActionSheetDelegate.html)

* * *

**编辑：**

```
@interface MyViewController : UIViewController <UIActionSheetDelegate>
-(IBAction)showActionSheet:(id)sender;
@end

@implementation MyViewController

-(IBAction)showActionSheet:(id)sender {
    UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:@"Do you want to procced?"  delegate:self  cancelButtonTitle:@"Cancel"  destructiveButtonTitle:@"YES"  otherButtonTitles:nil];

    [actionSheet showInView:self.view];
}

-(void) actionSheet: (UIActionSheet *)actionSheet didDismissWithButtonIndex:(NSInteger)buttonIndex { 
    switch (buttonIndex) {
        case 0: { 
            // for illustration
            // let's assume (1) you have a navigation controller
            // (2) you are using storyboard
            // (3) in the storyboard, you have a viewController with identifier MyChildViewControllerIdentifier
            MyChildViewController *mcvc = [self.storyboard instantiateViewControllerWithIdentifier:@"MyChildViewControllerIdentifier"];
            [self.navigationController pushViewController:mcvc animated:YES];
            break;
        }
         default:
            break;
     }
 } 
```

PS我没有运行它，如果有任何错误，请告诉我修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:41:05.663

关闭操作表，然后`[self presentmodalviewcontroller:myview animated:yes]`

# php - 当用户在 PHP 中中止时脚本不会终止吗？

> ID：10032518
> 
> 赞同：1
> 
> 时间：2012-04-05T16:38:17.040
> 
> 标签：php

如此处给出：http: [//us3.php.net/manual/en/features.connection-handling.php](http://us3.php.net/manual/en/features.connection-handling.php)

> 有时，即使没有远程浏览器接收输出，始终让脚本运行完成也很方便。但是，默认行为是在远程客户端断开连接时中止您的脚本。

但是我有一个数据抓取脚本，在给定输入后启动引导过程以获取数据并将其写入文件中。尽管我没有给出`ignore_user_abort`，即使关闭脚本窗口后，它仍然在后台运行，数据仍在写入中。当窗口关闭时，进程本身是否应该终止？如果这是真的，那不是`ignore_user_abort`徒劳的吗？

# node.js - 在哪里使用 RailwayJS 定义自定义模式

> ID：10032524
> 
> 赞同：1
> 
> 时间：2012-04-05T16:38:56.443
> 
> 标签：node.js, express, railway.js

文档只是说“或定义自定义模式（非杂耍），例如猫鼬。请注意，在自定义模式的情况下，所有 jugglingdb 功能当然都将被禁用。”

然而..

这个模式到底应该在哪里创建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-11T02:04:17.823

我相信你仍然可以在 db/schema.js 中创建它。例如：

```
customSchema(function () {

   var mongoose = require('mongoose');
   mongoose.connect('mongodb://localhost/test');

   var Schema = mongoose.Schema, ObjectId = Schema.ObjectId;

   var BlogPost = new Schema({
        author    : ObjectId
      , title     : String
      , body      : String
      , date      : Date
   });

  var Post = mongoose.model('BlogPost', BlogPost);
  Post.modelName = 'BlogPost'; // this is for some features inside railway (helpers, etc)

  module.exports['BlogPost'] = Post;

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-05T07:54:06.517

我在让上面的 customSchema 示例正常工作时遇到了类似的问题。我认为这个小技巧可能会为其他尝试使用 railjs customchemas 的人节省大量时间。

在代码块中放入 a`console.log("custom schema initialized");`后`customSchema(function() {...})`，我注意到 console.log 没有触发......这显然意味着我的`db/schema.js`文件中的 customSchema 块甚至没有被调用。

经过大量摆弄后，我意识到在您的`config/database.json`文件中，您必须将驱动程序设置为“内存”（对于您希望 customSchema 运行的任何环境）。例如，如果您将其设置为 driver: "mongoose"，则铁路将不会运行 customSchema 代码块。

总而言之，如果您想运行 customSchema，请确保您的 config/database.json 文件如下所示：

```
{
"production": 
  {
    "driver": "memory",
  },
"development":
  {  
    "driver": "memory"
  },
"test":
  { 
    "driver": "memory"
  }
} 
```

如果你有这样的东西，你的 customSchema 将不起作用：

```
{
"production": 
  {
    "driver": "mongoose",
    "url": "mongodb://<user>:<pass>@localhost:<port>/<database>"
  },
"development":
  {  
    "driver": "mongoose",
    "url": "mongodb://<user>:<pass>@localhost:<port>/<database>"
  },
"test":
  { 
    "driver": "memory"
  }
} 
```

至少在撰写本文时... railjs 仍在开发中，所以我确信事情可能会改变。我正在使用`railwaysjs version 0.2.17-pre4`

** 还有一个警告 - 如果你从你的 node_modules 文件夹中删除 'jugglingdb' - 这是与 rail 一起打包的 ORM - 然后 customSchema 将不会被调用。我相信这是因为 'jugglingdb' 紧密集成到 railsjs 框架中。我猜，基本原理是该框架的作者试图模仿 ruby​​-on-rails——我们知道它与 activeRecord 紧密集成。

因此，即使您没有使用 jugglingdb 并且正在运行您自己的自定义模式（例如通过 mongoose 或其他一些 ORM），也不要删除 jugglingdb。

我为此记录了一个错误： [https ://github.com/1602/express-on-railway/issues/212](https://github.com/1602/express-on-railway/issues/212)

# algorithm - 图 - 如何避免在深度优先搜索中重新处理相同的边缘两次？

> ID：10032525
> 
> 赞同：6
> 
> 时间：2012-04-05T16:39:01.447
> 
> 标签：algorithm, data-structures, graph, depth-first-search

[算法设计手册](http://www.algorist.com/)很好地描述了 BFS 和 DFS 。书中dfs的代码在决定是否避免双重处理边缘时存在问题。我找到了[勘误表](http://www.cs.sunysb.edu/~skiena/algorist/book/errata)并将勘误表应用于代码，但我仍然认为改进后的代码存在检查双处理边缘的问题。

我将优化后的代码粘贴如下：

```
dfs(graph *g, int v) {
       edgenode *p;
       int y;
       if (finished) return;
       discovered[v] = TRUE;
       time = time + 1;
       entry_time[v] = time;
       process_vertex_early(v);
       p = g->edges[v];
       while (p != NULL) {
             /* temporary pointer */
             /* successor vertex */
             /* allow for search termination */
             y = p->y;
             if (discovered[y] == FALSE) {
                   parent[y] = v;
                   process_edge(v,y);
                   dfs(g,y);
             }
             else if (**(!processed[y] && parent[v] != y)** || (g->directed))
                   process_edge(v,y);
             if (finished) return;
             p = p->next;
       }
       process_vertex_late(v);
       time = time + 1;
       exit_time[v] = time;
       processed[v] = TRUE;
} 
```

我认为有问题的地方通过** **标记。

所以有问题的地方是条件之一。假设它是无向图，所以我们可以忽略 的条件`(g->directed)`。

好的，让我们`parent[v] != y`首先关注。if`parent[v] == y`当然，我们不需要再次处理边 v->y，因为在处理顶点 y 时，y->v 已经处理过一次。

如果`parent[v] != y`，我的问题是是否`!processed[y] &&`有必要。

所以，如果 y 不是 v 的父级，`processed[y] == false`这意味着 y 已经找到（否则执行无法到达`else if`部分）但没有被处理，所以 y 必须是 v 的祖母或以上。这是一个后沿，但没有问题，我们可以处理它，因为它还没有被处理。

现在如果`processed[y] == true`？**我认为这种“如果”永远不会发生，这种情况也永远不会成立。**

为什么？好吧，让我们假设`processed[y]`可能是真的。这意味着包含 y 的所有路径都已被处理，并且这些路径中的所有顶点也已被处理，对吧？因此，如果是这种情况，“尚未完成处理”的顶点 v 如何接近 y？

**我认为在 dfs 中，*没有 vertex 会接近已处理的 vertex*，对吗？**

因此，如果我们永远不会处理已处理的顶点，我们可以删除`!processed[y]`，因为它总是正确的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T17:50:29.143

不，`processed[y] == true`可以产生真实的。

查看下图，并假设以下 [可行] DFS 遍历：

```
v0,v1,v2 
```

![图表示例](../Images/6702d6f480dde2aff35ae3cf73d65bd5.png)

`v0`启动，然后`dfs(v1)`在处理后递归调用`(v0,v1)`。现在，`v1`处理`(v1,v2)`并递归调用`dfs(v2)`. `v2`看到`v0`发现并转到`else if`语句，并看到`(v0,v2)`未处理并且`parent[v2] != v0`[`v2`是通过`v1`] 发现的。

现在，当我们从递归返回时，我们返回`v0`，当我们检查下一个“儿子”时 - 它是`v2`。`v2`已经被发现，所以我们转到`else if`，并且`v2`不是 的父级`v0`，所以如果没有该`!processed[y]`部分，我们将处理`(v0,v2)`两次。

唯一阻止这种情况发生的事实是`processed[y] == true`

# svn - SVN post-commit 钩子在提交后不会运行

> ID：10032531
> 
> 赞同：4
> 
> 时间：2012-04-05T16:39:18.220
> 
> 标签：svn, shell, post-commit

我在我的服务器上设置了一个 SVN 存储库，并且遇到了提交后问题。我在 iMac 上使用 SmartSVN 作为客户端。我通过 SmartSVN 的 ssh+svn 连接。我能够成功连接到 SVN 并对其进行更改，但是在我从 SVN 客户端提交后，我的提交后脚本无法正常工作。

我创建了我的提交后 shell 脚本`post-commit.sh`，并将其放在 hooks 目录中，认为这是你必须做的所有事情才能让它工作。基本上，该脚本所做的是将 SVN 签出到临时工作区，然后将必要的文件上传到我服务器上的开发子域。我这样做是为了为用户对我的 Web 应用程序所做的所有更改提供一个测试环境。该文件最初看起来像这样。

```
rm -rf /home/modionzc/tempworkspace/artistcondevspace/*
cd /home/modionzc/tempworkspace/artistcondevspace
svn checkout file:///home/modionzc/svnrepos/artistcondevrep
rm -rf /home/modionzc/public_html/devsuper/application/*
rm -rf /home/modionzc/public_html/devsuper/css/*
rm -rf /home/modionzc/public_html/devsuper/js/*
rm -rf /home/modionzc/public_html/devsuper/images/*
cp -r /home/modionzc/tempworkspace/artistcondevspace/artistcondevrep/trunk/application/* /home/modionzc/public_html/devsuper/application/
cp -r /home/modionzc/tempworkspace/artistcondevspace/artistcondevrep/trunk/css/* /home/modionzc/public_html/devsuper/css/
cp -r /home/modionzc/tempworkspace/artistcondevspace/artistcondevrep/trunk/js/* /home/modionzc/public_html/devsuper/js/
cp -r /home/modionzc/tempworkspace/artistcondevspace/artistcondevrep/trunk/images/* /home/modionzc/public_html/devsuper/images/
cp /home/modionzc/artistconconfig/appconfigfiles/config.php /home/modionzc/public_html/devsuper/application/config/config.php
cp /home/modionzc/artistconconfig/appconfigfiles/database.php /home/modionzc/public_html/devsuper/application/config/database.php
cd /home/modionzc/public_html/devsuper
chmod -R 755 *
chmod 644 $(find *.* ! -type d) 
```

当我从命令行手动运行它并更新必要的文件时，它可以正常运行。现在由于某种原因，每当我从 SmartSVN 提交时，它都不会被调用。更改是通过存储库进行的，如果我手动运行脚本，我可以看到实际进行了更新。我做了一些研究，发现这可能是权限问题，或者我没有使用绝对路径。我在整个脚本中使用绝对路径。该文件的权限设置为 755。我唯一能想到的是实际的 SVN 用户没有权限，即在 conf 文件中创建的用户。我已经通过 SVN 手册和 Internet 进行了修复，但没有取得多大成功。

一个建议是制作一个日志文件以查看调用脚本时引起的任何错误。所以现在我的 post-commit 脚本调用另一个具有上述命令的文件，并将命令行返回到一个名为`svna.log`. 该`post-commit.sh`文件现在看起来像这样。

```
cd /home/modionzc/hooktest/
/home/modionzc/hooktest/ac_post_commit.sh &> svna.log 
```

其中 ac_post_commit.sh 有上面的原始代码。同样，如果我手动调用它，所有响应都会根据需要转到该文件，但如果我从 SmartSVN 提交我的工作，则日志文件实际上是空的。

仅供参考 - 由于某种原因，我的 post-commit.sh`*`在它的末尾有一个，并且当我 ls 挂钩目录中的文件时被列为 post-commit.sh* 。

请，对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T23:19:07.960

我在查看其他人的帖子时发现了 svn 论坛上的问题[http://www.svnforum.org/threads/40951-How-repository-hooks-works?highlight=post-commit](http://www.svnforum.org/threads/40951-How-repository-hooks-works?highlight=post-commit)。问题在于提交后文件不能在其末尾附加 .sh 。它需要命名为“提交后”。这确实需要具有您在上面 Mensi 提到的第一行中编写的脚本类型的路径，但这不是脚本的问题。还是要谢谢你的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:42:39.263

可能是你在一开始就错过了 #!/bin/sh 吗？

# solr - DataImportHandler 无法添加/更新

> ID：10032532
> 
> 赞同：2
> 
> 时间：2012-04-05T16:39:24.320
> 
> 标签：solr, add, dataimporthandler

我试图说服 solr 执行 sqlite 数据库的批量导入。我遵循 Solr-Wiki 的所有说明。我将 DataImportHandler 配置为通过 jdbc 成功打开该数据库，我可以开始导入 [http://localhost:8080/solr/dataimport?command=full-import](http://localhost:8080/solr/dataimport?command=full-import) 但无论我做什么，DIH 都没有添加任何文档，即使它看起来是索引数据库

结果

```
 <str name="command">full-import</str>

<str name="Total Requests made to DataSource">1</str>
<str name="Total Rows Fetched">**14**</str>
<str name="Total Documents Skipped">0</str>
<str name="Full Dump Started">2012-04-06 01:14:30</str>
<str name="">**Indexing completed**. **Added/Updated: 0 documents**. Deleted 0 documents.</str>
<str name="Committed">2012-04-06 01:14:32</str>
<str name="Optimized">2012-04-06 01:14:32</str>
<str name="Total Documents Processed">0</str> 
```

我在 Oracle DB 中使用 emp 表

数据配置.xml

```
 <dataConfig>
<dataSource name="jdbc" driver="oracle.jdbc.driver.OracleDriver" url="jdbc:oracle:thin:@//localhost:1521/ORCL" user="scott" password="tiger"/>
<document>
<entity name="emp" query="select EMPNO, ENAME from EMP">
            <field column="EMPNO" name="empno" />
            <field column="ENAME" name="ename" />
</entity>
</document>
</dataConfig> 
```

架构.xml

```
<field name="empno" type="int" indexed="true" stored="true"/>
<field name="ename" type="string" indexed="true" stored="true"/> 
```

它似乎没有索引，但没有存储索引数据

任何想法为什么会发生这个问题？

**编辑 1** 日志显示警告消息，如..

```
 WARNING: Error creating document : SolrInputDocument[{ename=ename(1.0)={SMITH}, empno=empno(1.0)={7369}}]
org.apache.solr.common.SolrException: [doc=null] missing required field: id
    at org.apache.solr.update.DocumentBuilder.toDocument(DocumentBuilder.java:346)
    at org.apache.solr.update.processor.RunUpdateProcessor.processAdd(RunUpdateProcessorFactory.java:60)
    at org.apache.solr.update.processor.LogUpdateProcessor.processAdd(LogUpdateProcessorFactory.java:115)
    at org.apache.solr.handler.dataimport.SolrWriter.upload(SolrWriter.java:73)
    at org.apache.solr.handler.dataimport.DataImportHandler$1.upload(DataImportHandler.java:293)
    at org.apache.solr.handler.dataimport.DocBuilder.buildDocument(DocBuilder.java:636)
    at org.apache.solr.handler.dataimport.DocBuilder.doFullDump(DocBuilder.java:268)
    at org.apache.solr.handler.dataimport.DocBuilder.execute(DocBuilder.java:187)
    at org.apache.solr.handler.dataimport.DataImporter.doFullImport(DataImporter.java:359)
    at org.apache.solr.handler.dataimport.DataImporter.runCmd(DataImporter.java:427)
    at org.apache.solr.handler.dataimport.DataImporter$1.run(DataImporter.java:408) 
```

那种日志紧随其后

此警告消息显示在日志末尾

```
 2012\. 4\. 6 오후 12:12:25 org.apache.solr.update.processor.LogUpdateProcessor finish
INFO: {deleteByQuery=*:*,add=[(null), (null), (null), (null), (null), (null), (null), (null), ... (14 adds)],optimize=} 0 0 
```

我认为**缺少必填字段：id**与 schema.xml 中的配置有一些关系

```
<uniqueKey>id</uniqueKey> 
```

但删除后，我收到了这条消息

HTTP 状态 500 - solr 配置中的严重错误。检查您的日志文件以获取有关可能出现问题的更多详细信息。如果你希望 solr 在配置错误后继续，在 solr.xml 中更改：false --------------------------------- ---------------------------- org.apache.solr.common.SolrException: QueryElevationComponent 要求架构具有使用 StrField 实现的 uniqueKeyField org.apache.solr.handler.component.QueryElevationComponent.inform(QueryElevationComponent.java:158) 在 org.apache.solr.core.SolrResourceLoader.inform

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T07:06:27.330

尝试：

```
 <entity name="emp" query="select EMPNO, ENAME from EMP">
        <field column="EMPNO" name="id" />
        <field column="ENAME" name="ename" /> 
```

在 data-config.xml 中并放回：

```
 <uniqueKey>id</uniqueKey> 
```

在 schema.xml 中，也让字段 id。

或者你可以简单地替换：

```
 <uniqueKey>id</uniqueKey> 
```

和：

```
 <uniqueKey>epno</uniqueKey> 
```

希望这会奏效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T11:38:54.893

You can also add an autoincrement id with

```
 <dataConfig>
<script><![CDATA[
    id = 1;
    function GenerateId(row) {
        row.put('id', (id ++).toFixed());
        return row;
    }
   ]]></script>
<dataSource name="jdbc" driver="oracle.jdbc.driver.OracleDriver" url="jdbc:oracle:thin:@//localhost:1521/ORCL" user="scott" password="tiger"/>
<document>
<entity name="emp" query="select EMPNO, ENAME from EMP" transformer="script:GenerateId">
        <field column="EMPNO" name="empno" />
        <field column="ENAME" name="ename" />   
        </entity>
</document>
</dataConfig> 
```

# c# - AutoFixture 可以在对象创建时执行委托吗？

> ID：10032535
> 
> 赞同：6
> 
> 时间：2012-04-05T16:39:58.210
> 
> 标签：c#, autofixture

我正在寻找自定义[AutoFixture](http://autofixture.codeplex.com/)的创建时行为，以便我可以在生成和分配固定装置的属性后设置一些依赖对象。

例如，假设我有一个自定义 a 的方法，`User`因为它的`IsDeleted`属性对于某些测试集总是必须为 false：

```
public class User
{
   public int Id { get; set; }
   public string Name { get; set; }
   public bool IsDeleted { get; set; }
}

public static ObjectBuilder<User> BuildUser(this Fixture f)
{
   return f.Build<User>().With(u => u.IsDeleted, false);
} 
```

（我将`ObjectBuilder`返回给测试，以便它可以在必要时进一步定制夹具。）

我想做的是`Id`在创建时自动将该用户与匿名集合相关联，但我不能按原样执行此操作，因为`Id`在我将返回值交回单元测试时尚未生成恰当的。这是我正在尝试做的事情：

```
public static ObjectBuilder<User> BuildUserIn(this Fixture f, UserCollection uc)
{
   return f.Build<User>()
           .With(u => u.IsDeleted, false);
           .AfterCreation(u =>
            {
               var relation = f.Build<UserCollectionMembership>()
                               .With(ucm => ucm.UserCollectionId, uc.Id)
                               .With(ucm => ucm.UserId, u.Id)
                               .CreateAnonymous();
               Repository.Install(relation);
            }
} 
```

这样的事情可能吗？或者也许有更好的方法来实现我创建匿名对象图的目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T19:44:28.853

对于该`Build`方法，这是不可能的，而且可能永远不会，因为有更好的选择。

首先，永远不需要围绕方法编写静态辅助方法`Build`。该`Build`方法用于真正的一次性初始化，其中需要在事前定义属性或字段值。

即想象这样一个类：

```
public class MyClass
{
    private string txt;

    public string SomeWeirdText
    {
        get { return this.txt; }
        set
        {
            if (value != "bar")
                throw new ArgumentException();
            this.txt = value;
        }
    }
} 
```

在这个（人为的）示例中，顺子`fixture.CreateAnonymous<MyClass>`会抛出，因为它会尝试将“bar”以外的东西分配给属性。

在一次性场景中，可以使用该`Build`方法来逃避这个问题。一个示例是简单地将值显式设置为“bar”：

```
var mc =
    fixture.Build<MyClass>().With(x => x.SomeWeirdText, "bar").CreateAnonymous(); 
```

但是，更简单的方法是省略该属性：

```
var mc =
    fixture.Build<MyClass>().Without(x => x.SomeWeirdText).CreateAnonymous(); 
```

但是，一旦您开始想要反复执行此操作，就有更好的选择。AutoFixture 有一个非常复杂且可定制的引擎，用于定义事物的创建方式。

首先，可以从将属性的省略移到自定义中开始，如下所示：

```
fixture.Customize<MyClass>(c => c.Without(x => x.SomeWeirdText)); 
```

现在，只要夹具创建了 MyClass 的实例，它就会完全跳过该属性。之后您仍然可以分配一个值：

```
var mc = fixture.CreateAnonymous<MyClass>();
my.SomeWeirdText = "bar"; 
```

如果你想要更复杂的东西，你可以[实现一个自定义的 ISpecimenBuilder](http://blog.ploeh.dk/2010/10/19/ConventionbasedCustomizationsWithAutoFixture.aspx)。如果您想在创建实例后运行一些自定义代码，您可以使用后处理器装饰您自己的 ISpecimenBuilder 并提供一个委托。这可能看起来像这样：

```
fixture.Customizations.Add(
    new Postprocessor(yourCustomSpecimenBuilder, obj =>
        { */ do something to obj here */ })); 
```

（顺便说一句，你还在使用 AutoFixture 1.0 吗？IIRC，`ObjectBuilder<T>`从那以后就没有了……）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T20:14:03.667

AutoFixture CodePlex 网站上有关于此主题的[有用讨论](http://autofixture.codeplex.com/discussions/222358)。

我相信我在那里链接的[后处理器定制](https://gist.github.com/3151233)应该对您有所帮助。示例用法：

```
class AutoControllerDataAttribute : AutoDataAttribute
{  
    public AutoControllerDataAttribute()
        : this( new Fixture() )
    {
    }

    public AutoControllerDataAttribute( IFixture fixture )
        : base( fixture )
    {
        fixture.Customize( new AutoMoqCustomization() );
        fixture.Customize( new ApplyControllerContextCustomization() );
    }

    class ApplyControllerContextCustomization : PostProcessWhereIsACustomization<Controller>
    {
        public ApplyControllerContextCustomization()
            : base( PostProcess )
        {
        }

        static void PostProcess( Controller controller )
        {
            controller.FakeControllerContext();
            // etc. - add stuff you want to happen after the instance has been created 
```

# wordpress - 通过自定义 SoundManager2 播放器准确跟踪 SoundCloud 歌曲的播放次数

> ID：10032536
> 
> 赞同：1
> 
> 时间：2012-04-05T16:39:59.707
> 
> 标签：wordpress, soundcloud, soundmanager2

很像这个问题（[列出 Soundcloud 中的曲目并在 Wordpress 博客上使用 Soundmanager 2 播放](https://stackoverflow.com/questions/7464400/list-tracks-from-soundcloud-and-play-it-with-soundmanager-2-on-a-wordpress-blog)），我们也使用 SoundManager2 播放 SoundCloud 中的 Mp3，我们已经让它工作并接收 JSON 查询。我的问题是：当我们通过自定义播放器播放这些歌曲时；有没有办法在实际的 SoundCloud 页面上增加播放次数？如果可能的话，我们需要艺术家能够跟踪我们带来的增加的播放次数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:05:07.630

我认为无论您播放曲目，播放次数都会增加。至少，它适用于 Flash embed 播放器，但不确定 sm2 播放器和 html5 播放器。我希望它也有效。如果没有，它应该。

# html - 将两个 div 放置在同一水平面上

> ID：10032537
> 
> 赞同：6
> 
> 时间：2012-04-05T16:40:01.473
> 
> 标签：html, css

我需要将两个 div 元素放在同一水平面上。按照我的做法，第二个会显示在第一个下面。我想以一种在过渡时相互交叉的方式放置它们。

编辑 1-[当](http://jsfiddle.net/ht6M9/3/)按下按钮交换他们的类时，div 上下移动。

```
#aaidi,#aaidi3 {
-webkit-transition: margin-left 1s ease-in-out;
-moz-transition: margin-left 1s ease-in-out;
-o-transition: margin-left 1s ease-in-out;
transition: margin-left 1s ease-in-out;
}
.left {
margin-left: 45%;
border: 1px solid green ;
width: 20px;
height: 4px;
background: #FF0000;
} // similar for right with margin-left:55%
......
        <tr>
           <td colspan=3>
              <div id="aaidi" class="left">
              </div>
              <div id="aaidi3" class="right">
              </div>
           </td>
        </tr> // after this there is a button pressing whom changes the class of both divs. 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-05T16:42:53.387

`float`您可以使用以下属性实现此目的：

```
<style type="text/css">
    div.container {
        margin: 15px;   
    }
    div.left, div.right {
        float: left;
        padding: 10px;    
    }
    div.left {
        background-color:orange;    
    }
    div.right {
        background-color: yellow;    
    }
</style>

<div class="container">
    <div class="left">Left</div>
    <div class="right">Right</div>
</div> 
```

请参阅此[jsFiddle](http://jsfiddle.net/csLwu/1/)进行演示。这是输出：

![在此处输入图像描述](../Images/2c57c7c63b66358fcd94e88a12dd4787.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T16:41:33.943

使用 a `span`，或者您可以将样式设置为`display:inline-block`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T16:43:18.143

我相信你想浮动 div

```
.float-left{
  float:left;
}

 <div id="aaidi" class="float-left left"></div>
 <div id="aaidi3" class="float-left right"></div> 
```

如果右 div 仍被视为“块”元素，那么它将占据整行。两个元素都需要浮动，或者需要设置特定的宽度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T16:53:06.010

请参阅小提琴的代码和演示

小提琴：http: [//jsfiddle.net/ht6M9/](http://jsfiddle.net/ht6M9/)

演示：http: [//jsfiddle.net/ht6M9/embedded/result/](http://jsfiddle.net/ht6M9/embedded/result/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T16:46:11.407

如果您需要并排放置所有 div，只需浮动所有 div。

根据 div 的内容，您可能还需要为每个类分配一个宽度。

# android - 跟踪电话通话时长

> ID：10032542
> 
> 赞同：8
> 
> 时间：2012-04-05T16:40:12.250
> 
> 标签：android, android-intent, broadcastreceiver, phone-call

是否可以通过他们的手机提供商使用用户的电话，并跟踪电话的时长？

因此，用户按下应用程序“立即呼叫”中的按钮。对预定号码的呼叫开始。我们记录开始时间。当通话结束时，我们计算使用了多少分钟。

可能的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T17:07:13.283

要计算传入和传出呼叫的通话时间，请使用以下广播接收器：

```
public class CallDurationReceiver extends BroadcastReceiver {

    static boolean flag = false;
    static long start_time, end_time;

    @Override
    public void onReceive(Context arg0, Intent intent) {
        String action = intent.getAction();
        if (action.equalsIgnoreCase("android.intent.action.PHONE_STATE")) {
            if (intent.getStringExtra(TelephonyManager.EXTRA_STATE).equals(
            TelephonyManager.EXTRA_STATE_RINGING)) {
                start_time = System.currentTimeMillis();
            }
            if (intent.getStringExtra(TelephonyManager.EXTRA_STATE).equals(
            TelephonyManager.EXTRA_STATE_IDLE)) {
                end_time = System.currentTimeMillis();
                //Total time talked =
                long total_time = end_time - start_time;
                //Store total_time somewhere or pass it to an Activity using intent
            }
        }
    } 
```

在清单文件中注册您的接收器，如下所示：

```
 <receiver android:name=".CallDurationReceiver">
       <intent-filter>
           <action android:name="android.intent.action.PHONE_STATE" />
       </intent-filter>
    </receiver> 
```

还要添加使用权限：

```
<uses-permission android:name="android.permission.READ_PHONE_STATE" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-19T14:29:34.240

这可能为时已晚，但仅适用于将来可能需要它的任何人。对于拨出电话，您可以从 CallLog 中读取持续时间。对于来电，您可以根据通话的开始和结束时间计算时长。

# php - 在我们的一个页面上点赞时，点赞会被发布两次

> ID：10032544
> 
> 赞同：2
> 
> 时间：2012-04-05T16:40:15.263
> 
> 标签：php, html, facebook-like

我们刚刚在我们网站的任何地方都实现了一个 Facebook 点赞按钮。但是，它在其中一个页面上有点奇怪。

如果您在任何地方单击“赞”按钮然后发表评论，它只会在 Facebook 上发布一次。这是正确的行为。

不幸的是，在另一个页面上，它在您的 Facebook 墙上创建了两个项目。有没有人以前在任何网站上看到过同样的问题？

我使用 iframe，链接就是我在那里所说的：

`www.facebook.com/plugins/like.php?href=%s;send=false&layout=standard&show_faces=false&;action=like&colorscheme=light&font=arial&height=35&appId=%s`

第一个`%s`是当前URL，第二个`%s`是appid。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T17:14:09.140

Its a common bug, ive got a facebook like box too. And when i like my own page it will be liked twice. You cant do anything about it. Other visitors who like your page will only show up once.

# php - 如何在没有自动增量 ID 的情况下获取最后 4 条记录

> ID：10032547
> 
> 赞同：1
> 
> 时间：2012-04-05T16:40:22.190
> 
> 标签：php, sql

我有一个主键不是自动递增的表。这里 PK 是 seeker_nic ，我想获取该表的最后 4 条记录。

```
 SEEKER
    seeker_nic     Name
    ---------------------
    81025          ali
    81013          bilal
    87651          hamza 
    78911          biya
    98726          saqib
    62528          mirza 
```

我要这个

```
seeker_nic     Name
---------------------
87651          hamza 
78911          biya
98726          saqib
62528          mirza 
```

如果表的 id (PK) 具有自动递增功能，我可以这样做...但我不知道如何使用此 PK 获取记录`seeker_nic`...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:48:03.807

自动增量不是问题。问题是关系数据库中的行没有隐含的顺序，因此除非您有包含该信息的列，否则无法确定哪些是“最后 4 条记录”。

根据您在问题中提供给我们的信息，数据库无法订购您的记录：既`seeker_nic`不能也`name`不能订购以您想要的方式为您提供记录。

如果您有一个可以排序的列，例如 a `creation_date`or`id`列，您可以这样做：

```
 SELECT seeker_nic, name 
    FROM seeker
ORDER BY <column_here> DESC
   LIMIT 4                   -- syntax may vary depending on RDMBS 
```

仅仅因为你有一个自然键 ( `seeker_nic`)，并不意味着你不能有一个自动递增的代理键。

如果您没有可以确定列应如何排序的列，那么您就没有运气了。

# matlab - 图像的信噪比

> ID：10032548
> 
> 赞同：0
> 
> 时间：2012-04-05T16:40:25.257
> 
> 标签：matlab

我正在尝试计算原始图像和隐秘图像之间的 SNR（其中嵌入了秘密消息）

我正在使用灰度图像来实现。我正在按照以下方式计算它，但 SNR 为 -ve ..

如果我在这里对图像做错了什么，请纠正我

```
function snr_power = SNR(signal, noise)
% SNR (Signal to noise ratio)

[signalRowSize signalColSize] = size(signal);
[noiseRowSize noiseColSize] = size(noise);

signalAmp = signal(:);
noiseAmp = noise(:);

signalPower = sum(signalAmp.^2)/(signalRowSize*signalColSize);
noisePower = sum(noiseAmp.^2)/(noiseRowSize*noiseColSize);

% snr_amp = 10*log10((signalAmp./noiseAmp)^2);
snr_power = 10*log10(signalPower/noisePower);

end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-11-07T11:04:57.833

> 物体在图像中是可见的，因为它的亮度与其周围环境不同。

也就是说，物体（即信号）的对比度必须克服图像噪声。见图片。**灰度变换**可用于提高选定范围的像素值的对比度，为克服人眼的局限性提供有价值的工具。*增加一个亮度级别的对比度，代价是降低另一个亮度级别的对比度。但是，这仅在对象的对比度没有因随机图像噪声而丢失时才有效*。这是一个更严重的情况；无论眼睛的表现如何，信号都没有包含足够的信息来揭示物体。

[![图像对比度](../Images/8cc2cd9e754ca48dcdab277796f3cfc1.png)](https://i.stack.imgur.com/8hPxk.jpg)

[在这里](https://www.dspguide.com/ch25/3.htm)详细查找

# binding - 绑定 - JAXB：XJC 不为属性生成枚举类

> ID：10032556
> 
> 赞同：2
> 
> 时间：2012-04-05T16:40:58.793
> 
> 标签：binding, jaxb, enumeration, xjc, complextype

我对 XJC 工具有疑问，它没有使用此模式为属性 myEnum 生成 Enum 类。

```
<xs:element name="myClass"> 
<xs:complexType>
    <xs:attribute name="myEnum" >
            <xs:simpleType >
                <xs:restriction base="xs:string">
                    <xs:maxLength value="1"/>
                    <xs:enumeration value="C"/>
                    <xs:enumeration value="M"/>
                    <xs:enumeration value="S"/>
                </xs:restriction>
            </xs:simpleType>
    </xs:attribute>
</xs:complexType>
</xs:element> 
```

但是如果我只使用它就会生成它

```
<xs:simpleType >
<xs:restriction base="xs:string">
    <xs:maxLength value="1"/>
    <xs:enumeration value="C"/>
    <xs:enumeration value="M"/>
    <xs:enumeration value="S"/>
</xs:restriction>
</xs:simpleType> 
```

这是外部绑定文件内容：

```
<?xml version="1.0" encoding="UTF-8" ?> 
<bindings xmlns="http://java.sun.com/xml/ns/jaxb" 
     version="2.1" xmlns:xs="http://www.w3.org/2001/XMLSchema" 
     > 
<globalBindings typesafeEnumMemberName="generateName">

</globalBindings>  
</bindings> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T23:07:15.680

你可以试试这个：定义一个小的 XSD 文件，只使用声明为全局类型的特定类型，例如：

```
<xs:simpleType name="myEnumSimpleType">
     <xs:restriction base="xs:string">
         <xs:maxLength value="1"/>
         <xs:enumeration value="C"/>
         <xs:enumeration value="M"/>
         <xs:enumeration value="S"/>
     </xs:restriction>
</xs:simpleType>

<xs:element name="myClass"> 
    <xs:complexType>
        <xs:attribute name="myEnum" type="myEnumSimpleType">
    </xs:complexType>
</xs:element> 
```

这将生成一个 JAXB 类（我们称之为“人工 JAXB 类”）。

然后，您可以在较大的 XSD 上运行 xjc 并自定义生成以将这种类型用于特定元素。

或者，如果从这个外部 XSD 生成 JAXB 是一次性操作（然后您将 JAXB 生成的代码放在您的 SVN/Git 中），那么您可以重写该部分代码以使用您的“人工”而是 JAXB 类型。

您可能想尝试的另一个方法是自定义绑定

```
<globalBindings typesafeEnumMemberName="generateName"> 
```

不是全局的，而是使用表达式来尝试将其准确地钉在这种类型上。JAXB 很可能会为每次出现生成一个新类，即使它们将是相同的。

因为我觉得 xpath 很乏味，所以我会在你用命名空间修改的那个大 XSD 的本地副本上快速测试它，例如

```
<xs:element name="myClass"> 
   <xs:complexType>
     <xs:attribute name="myEnum" >
        <xs:simpleType >
                <xs:annotation>
                    <xs:appinfo>
                        <jaxb:typesafeEnumClass/>
                    </xs:appinfo>
                </xs:annotation>                <xs:restriction base="xs:string">
                <xs:maxLength value="1"/>
                <xs:enumeration value="C"/>
                <xs:enumeration value="M"/>
                <xs:enumeration value="S"/>
            </xs:restriction>
        </xs:simpleType>
     </xs:attribute>
   </xs:complexType>
</xs:element> 
```

# c# - Linq-To-Sql lambda 链偶尔导致源自 System.RuntimeTypeCache.GetGenericMethodInfo 的“已添加项目”异常

> ID：10032561
> 
> 赞同：2
> 
> 时间：2012-04-05T16:41:08.023
> 
> 标签：c#, linq-to-sql, lambda

最近我们收到了来自两个客户的错误报告，其堆栈跟踪如下（我们的命名空间已被 ***** 替换）：

```
[ArgumentException: Item has already been added. Key in dictionary: 'Boolean Single[Boolean](System.Collections.Generic.IEnumerable`1[System.Boolean])'  Key being added: 'Boolean Single[Boolean](System.Collections.Generic.IEnumerable`1[System.Boolean])']
System.Reflection.CerHashtable`2.Insert(K[] keys, V[] values, Int32& count, K key, V value) +9600475
System.Reflection.CerHashtable`2.Preallocate(Int32 count) +307
System.RuntimeTypeCache.GetGenericMethodInfo(RuntimeMethodHandleInternal genericMethod) +299
System.RuntimeType.GetMethodBase(RuntimeType reflectedType, RuntimeMethodHandleInternal methodHandle) +543
System.RuntimeType.GetMethodBase(RuntimeType reflectedType, IRuntimeMethodInfo methodHandle) +25
System.Reflection.MethodBase.GetMethodFromHandle(RuntimeMethodHandle handle) +27
*****.Core.Repositories.Common.IsThereAnAuthorizedUserManager() +383
*****.Client.Host.WebLogin.Login.Page_Load(Object sender, EventArgs e) +334
System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +14
System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +35
System.Web.UI.Control.OnLoad(EventArgs e) +91
System.Web.UI.Control.LoadRecursive() +74
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2207 
```

IsThereAnAuthorizedUserManager() 函数如下：

```
public bool IsThereAnAuthorizedUserManager()
{
    return context.Users.Any(u => u.IsEnabled && u.DeletionDate == null && u.UserRoles.Any(ur => ur.Role.RoleOperations.Any(ro => ro.OperationType == (int)OperationType.ManageUsers)));
} 
```

该语句输出的 SQL 如下：

```
exec sp_executesql N'SELECT 
(CASE 
    WHEN EXISTS(
        SELECT NULL AS [EMPTY]
        FROM [dbo].[User] AS [t0]
        WHERE ([t0].[IsEnabled] = 1) AND ([t0].[DeletionDate] IS NULL) AND (EXISTS(
            SELECT NULL AS [EMPTY]
            FROM [dbo].[UserRole] AS [t1]
            WHERE (EXISTS(
                SELECT NULL AS [EMPTY]
                FROM [dbo].[Role] AS [t2], [dbo].[RoleOperation] AS [t3]
                WHERE ([t3].[OperationType] = @p0) AND ([t2].[RoleID] = [t1].[RoleID]) AND ([t3].[RoleID] = [t2].[RoleID])
                )) AND ([t1].[UserID] = [t0].[UserID])
            ))
        ) THEN 1
    ELSE 0
 END) AS [value]',N'@p0 int',@p0=102 
```

.Any() 应该总是返回一个布尔结果，所以我不确定这将如何导致错误被抛出。我们还不能在测试中重现它，它似乎可以通过让用户重置 IIS 来解决。

以这种方式链接 .Any() 是否存在固有问题？或者也许我们做错了什么，我只是没有看到？我们当前的“修复”计划将用调用标量值 SQL 函数来替换语句，该函数将执行相同的逻辑而无需 .NET Framework 参与，但这似乎应该没必要。

作为参考，这似乎与这个问题非常相似：[What does this key error mean when calling MethodInfo.MakeGenericMethod?](https://stackoverflow.com/questions/9419464/what-does-this-key-error-mean-when-calling-methodinfo-makegenericmethod)

# post - 生成 Google Cloud Storage Policy 文档和签名

> ID：10032567
> 
> 赞同：1
> 
> 时间：2012-04-05T16:41:24.270
> 
> 标签：post, upload, signature, google-cloud-storage

我正在尝试通过 POST 方法通过 HTML 表单将文件上传到 Google Cloud Storage。Google 在他们的[文档](https://developers.google.com/storage/docs/reference-methods#postobject)中声明，要分配非标准 ACL，您需要一个策略和一个签名字段。

阅读他们关于如何生成这些值的描述，看起来很简单。不幸的是，经过多次尝试，我仍然无法生成可以通过 Google 过滤器的值。我不断收到错误消息，说我的签名与保单文件不符。

有人可以指导我哪里出错了吗？这是我的过程：

1.  建立我的政策文件

这是简单的部分。我的政策文件是：

```
{"expiration": "2015-06-16T11:11:11Z", 
"conditions": [ 
    ["starts-with", "$key", ""], 
    {"acl": "public-read" }, 
    {"bucket": "publicjs"}, 
    {"success_action_redirect": "http://localhost/gcs.php" } 
] } 
```

1.  然后我去了[这个网站](http://www.opinionatedgeek.com/dotnet/tools/Base64Encode/Default.aspx)并将上述值编码为base64。 **这就是我用作我的政策文件的内容。**

2.  现在签名。我需要使用我的密钥作为加密密钥来加密我的保单文件，所以我去[这个网站](http://hash.online-convert.com/sha256-generator)进行加密。我将我的 base64 编码策略文档（从步骤 2 开始）输入到主文本区域，并将我的互操作性“秘密”密钥输入到密钥框中。

3.  按回车，base64 旁边的值应该是**签名值**。

4.  将值放入表单，发送 POST 请求，接收错误。

我哪里错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-06T03:34:09.160

编码顺序应如下：

*   base64 编码策略文档（我们称之为编码策略）

*   生成编码策略的 SHA1 哈希（仅适用于互操作密钥，如果要使用 RSA 密钥，请使用 SHA256）并对其进行 base64 编码（我们称之为签名）

*   在表单发布请求中发送编码的策略和签名（连同表单的其余部分）

这是 Python 中序列的理想化实现：

```
 POLICY = '''{
                "expiration": "2015-06-16T11:11:11Z", 
                "conditions": [
                  ["starts-with", "$key", "test"],
                  {"acl" : "public-read"}
                ]
              }'''

  GEN_FORM = '''
    <form action="%s" method="post" enctype="multipart/form-data">
      <input type="hidden" name="acl" value="public-read">
      <input type="hidden" name="bucket" value="YOUR_BUCKET">
      <input type="hidden" name="key" value="YOUR_OBJECT_NAME">
      <input type="hidden" name="GoogleAccessId" value="YOUR_ACCESS_ID">
      <input type="hidden" name="policy" value="%s">
      <input type="hidden" name="signature" value="%s">
      <input name="file" type="file">
      <input type="submit" value="Upload">
    </form>
  '''

  encoded_policy = base64.b64encode(POLICY).strip()
  h = hmac.new(YOUR_SECRET_KEY, digestmod=sha.sha)
  h.update(encoded_policy)
  signature = base64.b64encode(h.digest())
  gen_html = GEN_FORM % (url, encoded_policy, signature) 
```

# visual-studio - T4 转换期间“无法从主机获取 DTE”

> ID：10032568
> 
> 赞同：2
> 
> 时间：2012-04-05T16:41:28.803
> 
> 标签：visual-studio, entity-framework, templates, t4

我按照这篇文章[Get Visual Studio to run a T4 Template on each build](https://stackoverflow.com/questions/1646580/get-visual-studio-to-run-a-t4-template-on-every-build)，使用带有 Visual Studio SDK 和 Visual Studio 2010 建模和可视化 SDK 安装的解决方案。

...但我得到一个我无法解决的错误：

> 错误 2 运行转换：System.ArgumentNullException：值不能为空。Parameter name: Could not obtain DTE from host at Microsoft.VisualStudio.TextTemplatingE035559D977B9B9858AB2036321BC47D.GeneratedTextTransformation.EntityFrameworkTemplateFileManager.VsEntityFrameworkTemplateFileManager..ctor(Object textTemplating) at Microsoft.VisualStudio.TextTemplatingE035559D977B9B9858AB2036321BC47D.GeneratedTextTransformation.EntityFrameworkTemplateFileManager.Create(Object textTransformation) at Microsoft.VisualStudio.TextTemplatingE035559D977B9B9858AB2036321BC47D Microsoft.VisualStudio.TextTemplating.TransformationRunner.RunTransformation 上的 .GeneratedTextTransformation.TransformText()（TemplateProcessingSession 会话，字符串源，ITextTemplatingEngineHost 主机，字符串和结果）。行=0，列=0 ApmWeb.Web。

按照我脚本的第一部分...

```
<#@ template language="C#" debug="false" hostspecific="true"#>
 <#@ include file="EF.Utility.CS.ttinclude"#>
 <#@ output extension=".cs"#><#

CodeGenerationTools code = new CodeGenerationTools(this);
 MetadataLoader loader = new MetadataLoader(this);
 CodeRegion region = new CodeRegion(this, 1);
 MetadataTools ef = new MetadataTools(this);

string inputFile = @"../../ApmWeb.Infrastructure.Data/Model/ApmWebModel.edmx";
 MetadataWorkspace metadataWorkspace = null;
 bool allMetadataLoaded =loader.TryLoadAllMetadata(inputFile, out metadataWorkspace);
 EdmItemCollection ItemCollection =     
   (EdmItemCollection)metadataWorkspace.GetItemCollection(DataSpace.CSpace);
 string namespaceName = code.VsNamespaceSuggestion();

EntityFrameworkTemplateFileManager fileManager =      
  EntityFrameworkTemplateFileManager.Create(this); 
```

**更新** 我发现问题出在“EF.Utility.CS.ttinclude”这一点上......

```
dte = (EnvDTE.DTE) hostServiceProvider.GetService(typeof(EnvDTE.DTE));
        if (dte == null)
        {
            throw new ArgumentNullException("Could not obtain DTE from host");
        } 
```

我的想法是在 VS 主机之外运行转换时无法获取 DTE 对象。例如，在 Team Build 中运行转换时会发生此错误（MSBuild 主机不“知道”DTE 对象）。实际上，它使用 VS 中的“运行自定义工具”工作，但正如我在上一篇文章中所说的那样配置自动 T4 构建，它不起作用。

那么怎么解决呢？它是 EF.Utility.CS.ttinclude 的错误吗？

**更新** 使用 DTE 删除与 VS 的交互（在 EF.Utility.CS.ttinclude 中定义 PREPROCESSED_TEMPLATE）一切正常，但我失去了将生成的文件添加到我的项目的能力……还有其他方法可以让它工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:33:45.623

正如您所发现的，在构建时进行转换时，您将无法访问 DTE。处理项目中未出现的生成代码的一种方法是将其包含在通配符中，例如

只要您使用标准输出命名约定，这应该会给您带来合理的体验。您还可以使用构建目标将生成的输出重定向到特定文件夹，然后使用更简单的通配符来包含文件夹中的所有内容。

您必须注意 IDE 中的手动调整将删除此通配符并将其替换为其评估的时间点结果。

# algorithm - 您将如何实施工作流系统？

> ID：10032573
> 
> 赞同：2
> 
> 时间：2012-04-05T16:41:36.133
> 
> 标签：algorithm, oop, workflow

我需要实现一个工作流系统。

例如，要导出一些数据，我需要：

1.  使用 XSLT 处理器转换 XML 文件
2.  使用生成的转换转换为任意数据结构
3.  使用结果（文件或数据）并生成存档
4.  将存档移动到给定文件夹中。

我开始创建两种类型的类，Workflow，它负责添加新的 Step 对象并运行它。

每个 Steps 实现一个 StepInterface。

我主要担心的是我的所有步骤都依赖于前一个步骤（第一个除外），我想知道处理此类问题的最佳方法是什么。

我虽然循环遍历每个步骤并为每个步骤提供前一个步骤的结果（如果有的话），但我对此并不满意。

另一个想法是允许将“上一个”步骤设置为步骤，例如：

```
$s = new Step();
$s->setPreviousStep(Step $step); 
```

但是我失去了 Workflow 类的实用性。

有什么想法、建议吗？

顺便说一句，我也关心整个工作流程的成功或失败，这意味着如果任何步骤失败，我需要回滚或清理以前的数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:25:00.533

去年我实现了一个类似的工作流引擎（虽然是封闭源代码 - 所以没有我可以分享的代码）。以下是基于该经验的一些想法：

1.  StepInterface - 可以做你现在正在做的事情 - 抽象一个步骤。
2.  此外，提供回滚功能，但我认为一个步骤应该知道它何时失败并在继续之前进行清理。一个抽象步骤可以为您处理这个（模板方法）
3.  您可能需要考虑基于 StepResult 进行分支 - 因此您可以做一个 StepMatcher ，它接受一个 stepResult 对象和一个条件 - 只有当条件返回 true 时，它​​的子步骤才会执行。
4.  如果步骤出错，您还可以执行 StepException 来处理异常流。理想情况下，这是您可以在工作流级别（如果任何步骤失败时执行此操作）和/或在步骤级别定义的内容。
5.  我采用的方法是，一个步骤返回一个可用于下一步的明确定义的结构 (StepResult)。如果有大量数据（比如大文件等），则资源的 URI/定位器将在 StepResult 中传递。
6.  您的工作流程将需要一个上下文来使用 - 在您引用的示例中，这将是文件的名称、存档的位置等等 - 所以想想 WorkflowContext

额外的想法

您可能还需要考虑以下内容 - 如果这是您计划作为大规模服务/服务器实施的内容：

1.  步骤可能在动态加载的库中
2.  XML/JSON 文件中的工作流定义 - 再次，在编辑时动态重新加载。
3.  远程调用和回调 - 使用回调 API 将作业提交到远程服务。当远程服务回调时，将在流程的后续步骤中执行工作流。
4.  尽可能并行执行等。
5.  无状态设计

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:00:38.903

回滚可以很容易地适应这种结构，因为每个都`Step`将实现自己的`rollback()`方法，如果任何步骤失败，工作流可以调用（最好以相反的顺序）。

至于主要问题，这实际上取决于您想要获得的复杂程度。在基本级别上，您可以定义一个`StepResult`接口，该接口由每个步骤返回并传递到下一个步骤。这种方法的明显问题是每个步骤都应该“知道”`StepResult`期望的实现。对于小型系统，这可能是可以接受的，对于大型系统，您可能需要某种可配置的映射框架，该框架可以被告知如何将上一步的结果转换为下一步的输入。所以`Workflow`会调用`Step`，`Step`返回`StepResult`，`Workflow`然后调用`StepResultConverter`（这是你的可配置映射的东西），`StepResultConverter`返回 a `StepInput`，`Workflow`然后调用下一个`Step`，`StepInput`依此类推。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-29T19:30:18.080

我在使用[有限状态机](https://en.wikipedia.org/wiki/Finite-state_machine)实现工作流方面取得了巨大成功。它可以像您喜欢的那样简单或复杂，多个工作流程相互链接。通常，FSM 可以实现为一个简单的表，其中通过保存对象上的转换日志并简单地检索最后一个条目，在历史表中跟踪给定对象的当前状态。所以过渡将是以下形式：

nextState = TransLookup(currState, Event, [条件])

如果您正在实现前端，则可以使用此转换信息来构造一个给定对象在其当前状态下可用的事件列表。

# ajax - jQuery GET html 作为可遍历的 jQuery 对象

> ID：10032574
> 
> 赞同：6
> 
> 时间：2012-04-05T16:41:55.170
> 
> 标签：ajax, jquery

这是一个超级简单的问题，我似乎也找不到一个好的答案。

```
$.get('/myurl.html', function(response){
     console.log(response); //works!
     console.log( $(response).find('#element').text() ); //null :(
}, 'html'); 
```

我只是想遍历我的 html 响应。到目前为止，我能想到的唯一可行的方法是将正则表达式添加到正文标签内，并将其用作字符串来创建我的可遍历 jQuery 对象。但这似乎很愚蠢。有人愿意指出正确的方法吗？

也许它是我的html？

```
<html> 
    <head> 
       <title>Center</title> 
    </head> 
    <body> 
        <!-- tons-o-stuff -->
    </body>
</html> 
```

这也可以正常工作，但不适合我的需要：

$('#myelem').load('/myurl.html #element');

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T16:53:12.603

它失败了，因为它不喜欢`<html>`and `<body>`。

使用此处描述的方法：[A JavaScript parser for DOM](https://stackoverflow.com/questions/9540218/a-javascript-parser-for-dom/9540313#9540313)

```
$.get('/myurl.html', function(response){
     var doc = document.createElement('html');
     doc.innerHTML = response;

     console.log( $("#element", doc).text() );
}, 'html'); 
```

我认为以上应该可行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:54:59.973

当 jQuery 解析 HTML 时，它通常会去除 html 和 body 标签，因此如果您要搜索的元素在 html 和 body 标签被删除后位于文档结构的顶层，那么该`find`函数可能无法定位您正在搜索的元素。

有关更多信息，请参阅此问题 -[使用 jQuery 搜索 HTML 字符串](https://stackoverflow.com/questions/7159426/using-jquery-to-search-a-string-of-html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T16:47:20.870

试试这个：

```
$("#element", $(response)).text() 
```

这将在 $(response) 中搜索元素 ID，将 $(response) 视为 DOM 对象。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-05T16:57:00.753

也许我误解了什么，但是

```
.find('#element') 
```

匹配 ID 为“element”的元素，例如

```
<p id="element"> 
```

由于我没有看到“大量的东西”HTML，我不明白您要查找哪些元素。

# c++ - ATL 与 C++ 2010

> ID：10032575
> 
> 赞同：2
> 
> 时间：2012-04-05T16:41:57.537
> 
> 标签：c++, visual-c++

我开始在家里使用 Visual Studio C++ Express 2010，但里面没有 ATL 和 MFC。如何将 ATL/MFC 添加到 Visual Studio C++ Express 2010？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T16:46:02.683

Express 版本不支持 MFC 和 ATL。有关版本之间的比较，请参阅[http://msdn.microsoft.com/en-gb/library/hs24szh9.aspx 。](http://msdn.microsoft.com/en-gb/library/hs24szh9.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T16:46:36.943

Visual C++ Express 2010 不支持 ATL、MFC 和 OpenMP。

[Visual C++ 产品比较（请参阅库和标题部分）](http://msdn.microsoft.com/en-us/library/hs24szh9.aspx?ppud=4)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-05T17:10:35.910

我想，如果您尝试在家学习 MFC，Microsoft 不会太介意。在 VC++ Express 中可以使用现有的 MFC 项目：[如何在 Visual C++ Express 中编译 MFC 代码](http://www.codeproject.com/Articles/30439/How-to-compile-MFC-code-in-Visual-C-Express)

# objective-c - 使用 coregraphics 通过触摸擦除和取消擦除 UIImageVIew 中的图像

> ID：10032576
> 
> 赞同：6
> 
> 时间：2012-04-05T16:41:58.083
> 
> 标签：objective-c, ios, core-graphics, touch

[我的问题与此处](https://stackoverflow.com/questions/1382689/erase-and-unerase-image)提到的相同。我还在我的应用程序中使用了两个图像，我所需要的只是通过触摸擦除顶部图像。然后通过触摸取消擦除（如果需要）已擦除的部分。我正在使用以下代码擦除顶部图像。这种方法也有问题。这就是图像很大，我正在使用 Aspect Fit 内容模式来正确显示它们。**当我触摸屏幕时，它会在角落而不是触摸的地方擦除。**我认为接触点计算需要一些修复。任何帮助将不胜感激。

**第二个问题是如何通过触摸取消擦除已擦除的部分？**

```
UIGraphicsBeginImageContext(self.imgTop.image.size);
[self.imgTop.image drawInRect:CGRectMake(0, 0, self.imgTop.image.size.width, self.imgTop.image.size.height)];
self.frame.size.width, self.frame.size.height)];
CGContextSetLineCap(UIGraphicsGetCurrentContext(), kCGLineCapRound); 
GContextSetLineWidth(UIGraphicsGetCurrentContext(), pinSize); 
CGContextSetRGBStrokeColor(UIGraphicsGetCurrentContext(), 0, 0, 0, 1.0);
CGContextSetBlendMode(UIGraphicsGetCurrentContext(), kCGBlendModeCopy);

CGContextBeginPath(UIGraphicsGetCurrentContext());
CGContextMoveToPoint(UIGraphicsGetCurrentContext(), lastPoint.x, lastPoint.y);
CGContextAddLineToPoint(UIGraphicsGetCurrentContext(), currentPoint.x, currentPoint.y);
CGContextStrokePath(UIGraphicsGetCurrentContext());
self.imgTop.contentMode = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T01:08:58.050

您的代码非常模棱两可：您正在创建一个内部带有*imgTop*的上下文，然后与`kCGBlendModeCopy`黑色混合？这将导致黑色被复制到*imgTop*上。我假设你想设置图层的`content`属性呢？

无论如何，这门课可以满足您的需要。只有几个有趣的方法（它们在顶部），其他的只是属性或`init...`例程。

```
@interface EraseImageView : UIView {
    CGContextRef context;
    CGRect contextBounds;
}

@property (nonatomic, retain) UIImage *backgroundImage;
@property (nonatomic, retain) UIImage *foregroundImage;
@property (nonatomic, assign) CGFloat touchWidth;
@property (nonatomic, assign) BOOL touchRevealsImage;

- (void)resetDrawing;

@end

@interface EraseImageView ()
- (void)createBitmapContext;
- (void)drawImageScaled:(UIImage *)image;
@end

@implementation EraseImageView
@synthesize touchRevealsImage=_touchRevealsImage, backgroundImage=_backgroundImage, foregroundImage=_foregroundImage, touchWidth=_touchWidth;

#pragma mark - Main methods - 

- (void)createBitmapContext
{
    // create a grayscale colorspace
    CGColorSpaceRef grayscale=CGColorSpaceCreateDeviceGray();

    /* TO DO: instead of saving the bounds at the moment of creation,
              override setFrame:, create a new context with the right
              size, draw the previous on the new, and replace the old
              one with the new one.
     */
    contextBounds=self.bounds;

    // create a new 8 bit grayscale bitmap with no alpha (the mask)
    context=CGBitmapContextCreate(NULL,
                                  (size_t)contextBounds.size.width,
                                  (size_t)contextBounds.size.height,
                                  8,
                                  (size_t)contextBounds.size.width,
                                  grayscale,
                                  kCGImageAlphaNone);

    // make it white (touchRevealsImage==NO)
    CGFloat white[]={1., 1.};
    CGContextSetFillColor(context, white);

    CGContextFillRect(context, contextBounds);

    // setup drawing for that context
    CGContextSetLineCap(context, kCGLineCapRound);
    CGContextSetLineJoin(context, kCGLineJoinRound);

    CGColorSpaceRelease(grayscale);
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch=(UITouch *)[touches anyObject];

    // the new line that will be drawn
    CGPoint points[]={
        [touch previousLocationInView:self],
        [touch locationInView:self]
    };

    // setup width and color
    CGContextSetLineWidth(context, self.touchWidth);
    CGFloat color[]={(self.touchRevealsImage ? 1\. : 0.), 1.};
    CGContextSetStrokeColor(context, color);

    // stroke
    CGContextStrokeLineSegments(context, points, 2);

    [self setNeedsDisplay];

}

- (void)drawRect:(CGRect)rect
{
    if (self.foregroundImage==nil || self.backgroundImage==nil) return;

    // draw background image
    [self drawImageScaled:self.backgroundImage];

    // create an image mask from the context
    CGImageRef mask=CGBitmapContextCreateImage(context);

    // set the current clipping mask to the image
    CGContextRef ctx=UIGraphicsGetCurrentContext();
    CGContextSaveGState(ctx);

    CGContextClipToMask(ctx, contextBounds, mask);

    // now draw image (with mask)
    [self drawImageScaled:self.foregroundImage];

    CGContextRestoreGState(ctx);

    CGImageRelease(mask);

}

- (void)resetDrawing
{
    // draw black or white
    CGFloat color[]={(self.touchRevealsImage ? 0\. : 1.), 1.};

    CGContextSetFillColor(context, color);
    CGContextFillRect(context, contextBounds);

    [self setNeedsDisplay];
}

#pragma mark - Helper methods -

- (void)drawImageScaled:(UIImage *)image
{
    // just draws the image scaled down and centered

    CGFloat selfRatio=self.frame.size.width/self.frame.size.height;
    CGFloat imgRatio=image.size.width/image.size.height;

    CGRect rect={0.,0.,0.,0.};

    if (selfRatio>imgRatio) {
        // view is wider than img
        rect.size.height=self.frame.size.height;
        rect.size.width=imgRatio*rect.size.height;
    } else {
        // img is wider than view
        rect.size.width=self.frame.size.width;
        rect.size.height=rect.size.width/imgRatio;
    }

    rect.origin.x=.5*(self.frame.size.width-rect.size.width);
    rect.origin.y=.5*(self.frame.size.height-rect.size.height);

    [image drawInRect:rect];
}

#pragma mark - Initialization and properties -

- (id)initWithCoder:(NSCoder *)aDecoder
{
    if ((self=[super initWithCoder:aDecoder])) {
        [self createBitmapContext];
        _touchWidth=10.;
    }
    return self;
}

- (id)initWithFrame:(CGRect)frame
{
    if ((self=[super initWithFrame:frame])) {
        [self createBitmapContext];
        _touchWidth=10.;
    }
    return self;
}

- (void)dealloc
{
    CGContextRelease(context);
    [super dealloc];
}

- (void)setBackgroundImage:(UIImage *)value
{
    if (value!=_backgroundImage) {
        [_backgroundImage release];
        _backgroundImage=[value retain];
        [self setNeedsDisplay];
    }
}

- (void)setForegroundImage:(UIImage *)value
{
    if (value!=_foregroundImage) {
        [_foregroundImage release];
        _foregroundImage=[value retain];
        [self setNeedsDisplay];
    }
}

- (void)setTouchRevealsImage:(BOOL)value
{
    if (value!=_touchRevealsImage) {
        _touchRevealsImage=value;
        [self setNeedsDisplay];
    }
}

@end 
```

一些注意事项：

*   这个类保留了你需要的两个图像。它具有`touchRevealsImage`将模式设置为绘制或擦除的属性，并且您可以设置线条的宽度。

*   在初始化时，它会创建一个`CGBitmapContextRef`与视图大小相同的、灰度、8bpp、无 alpha。此上下文用于存储将应用于前景图像的蒙版。

*   每次您在屏幕上移动手指时，都会在`CGBitmapContextRef`CoreGraphics 上绘制一条线，白色显示图像，黑色隐藏图像。通过这种方式，我们存储 ab/w 绘图。

*   该`drawRect:`例程简单地绘制背景，然后`CGImageRef`从 中创建一个`CGBitmapContextRef`并将其作为掩码应用于当前上下文。然后绘制前景图像。它使用 绘制图像`- (void)drawImageScaled:(UIImage *)image`，它只是绘制缩放和居中的图像。

*   如果您打算调整视图大小，您应该实现一种方法来复制或重新创建具有新大小的遮罩，覆盖`- (void)setFrame:(CGRect)frame`.

*   该`- (void)reset`方法只是清除掩码。

*   即使位图上下文没有任何 alpha 通道，使用的灰度颜色空间*也有*alpha：这就是为什么每次设置颜色时，我都必须指定两个组件。

![<code>EraseImageView</code> 类的示例应用程序](../Images/be3ffb6702528f58dcf09b315738c246.png)

# class - 如何评估数据集的类重叠

> ID：10032579
> 
> 赞同：3
> 
> 时间：2012-04-05T16:42:16.930
> 
> 标签：class, weka, overlap, skew

我正在使用 Weka 为医疗问题开发分类器。这个数据集有类不平衡的情况，我想知道是否也存在类重叠的问题。每条记录有 30 个属性，如何使用 Weka 功能发现类重叠？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-10T06:06:20.550

> 当来自不同类的一些样本具有非常相似的特征时，就会发生类重叠

1.  聚类您的数据集。
2.  如果您的实例属于同一个集群，那么它们非常相似。
3.  然后使用实际的类成员找到错误率。
4.  如果您的实例属于同一个集群但它们的类不同，那么您找到了您要问的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T06:48:20.557

要解决类不平衡问题，可以使用 SMOTE。它在 Weka 监督过滤器（实例）中。但是你能解释一下类重叠是什么意思吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-14T17:09:49.783

我认为您的意思是“类重叠”，存在属于不同类的相似实例。简单地说，您可以删除它们。在 awk 中，您可以执行以下操作：

`awk '!NF || !seen[$0]++' inputFile > outputFile`

# java - 如何将RSS保存到xml文件java

> ID：10032583
> 
> 赞同：2
> 
> 时间：2012-04-05T16:42:25.293
> 
> 标签：java, xml, rss

我想将 RSS 提要保存到计算机上的 xml 文档中。我自己使用 XPath 和 Java 来解析 XML，所以我想要的只是一个包含我在查看网站 RSS 页面源时看到的源 (XML) 的文件。

换句话说，我不想将 RSS 页面的源代码复制并粘贴到我保存为 XML 文件的文件中，而是想编写一个程序来为我提取它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T16:53:30.380

你甚至不需要引入一个库来做到这一点！

只需在要“下载”的 Rss-Feed 上获取一个[`URL`-object ，然后使用](http://docs.oracle.com/javase/6/docs/api/java/net/URL.html)[`openConnection()`-method](http://docs.oracle.com/javase/6/docs/api/java/net/URL.html#openConnection%28%29)获取一个[`URLConnection`](http://docs.oracle.com/javase/6/docs/api/java/net/URLConnection.html).

然后你可以使用它的[`getInputStream()`-method](http://docs.oracle.com/javase/6/docs/api/java/net/URLConnection.html#getInputStream%28%29)。从此 InputStream 中，您可以读取 RSS 文档的未解析源（您应该用 包装它[`BufferedInputStream`](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedInputStream.html)）。

然后可以将其保存为字符串（在内存中）或使用[`FileOutputStream`](http://docs.oracle.com/javase/6/docs/api/java/io/FileOutputStream.html).

* * *

可以在此处找到示例实现：[https ://gist.github.com/2320294](https://gist.github.com/2320294)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:45:59.003

您可以使用 Apache commons [HttpClient](http://hc.apache.org/httpcomponents-client-ga/)从 Web 获取文件。这个库的使用非常方便。这是[官方教程](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/index.html)。

# php - 使用 mysql 查询更新 url 前缀

> ID：10032584
> 
> 赞同：0
> 
> 时间：2012-04-05T16:42:28.567
> 
> 标签：php, mysql, database

我已经通过脚本将我的数据库从实时站点导入到我的本地服务器。

我有由数据库动态生成的菜单系统。它们如下表所示：

```
id   name     linkpage
1    blog     http://www.example.com/blog/index.php
2    about    http://www.example.com/blog/about.php 
```

我必须将实时网址更改为我的本地网址，例如[http://www.example.com/blog/index.php](http://www.example.com/blog/index.php)到[http://localhost/mysite/blog/index.php](http://localhost/mysite/blog/index.php)

如何使用 mysql 查询更新链接页面列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:45:09.303

这很简单。您可以使用[**替换**](http://dev.mysql.com/doc/refman/5.0/en/replace.html)功能：

```
 UPDATE tablename SET linkpage=REPLACE(linkpage,'www.example.com','localhost/nysite') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:42:53.477

带替换功能；

```
mysql_query("UPDATE your_tablename SET linkpage=REPLACE(linkpage,'www.your_link.com','localhost/mysite')") 
```

# sql-server - SQL Server Compact 4.0 提供程序不在 EF 列表中

> ID：10032589
> 
> 赞同：1
> 
> 时间：2012-04-05T16:42:44.153
> 
> 标签：sql-server, sql-server-2008, entity-framework, entity-framework-4, sql-server-ce

我的 WPF 应用程序使用带有 SQL Server CE 数据库的 Entity Framework 4.0。而且我需要 SQL Server CE 4.0 才能允许`@@IDENTITY`服务器生成列。

所以我刚刚在我的系统上安装了 SQL Server Compact 4.0，但我无法创建 SQL Server CE 4.0 数据库，因为当我从 VS2010 选择数据源时它不在列表中。

![在此处输入图像描述](../Images/5cabfb0e6502a85d91803629f758228c.png)

我想知道为什么，因为在 Windows 程序列表中有 SQL Server CE 4.0：

![在此处输入图像描述](../Images/39b8a11c3a561e61a560a82cb25964f1.png)

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:48:55.717

您需要[为 SQL Server Compact 4 安装 Visual Studio 工具](http://erikej.blogspot.com/2010/12/visual-studio-tools-for-sql-server.html)

然后你得到：

![在此处输入图像描述](../Images/449b6aa5366601ec3a744f78c2295628.png)

# c - 多请求单响应同步

> ID：10032594
> 
> 赞同：1
> 
> 时间：2012-04-05T16:43:03.967
> 
> 标签：c, synchronization, mutex, semaphore

这似乎应该是一个众所周知的问题，但我无法找到一个好的解决方案（无论是从我的大脑还是互联网上）。

首先，我们举一个非常简单的例子：

```
mutex request  <-- init to 0
mutex response <-- init to 0

Service thread (Guy S):
    while not finished
        wait(request)
        do stuff
        signal(response)

Someone requestion service (Guy U):
    signal(request)
    wait(response)
    do stuff with results 
```

到目前为止，一切都很好。`U`（用户）信号`S`（服务），并等待其响应。万事皆安。

现在想象一下，如果有很多用户请求相同的服务。现在服务的性质是结果随时间变化（更准确地说是周期性变化）。*因此，如果有 10 个用户或多或少*地同时请求该服务，则该服务只能安全地运行一次。

首先想到的是这个：

```
Guy S:
    while not finished
        wait(request)
        do stuff
        trywait(request)
        broadcast(response)

Guy U:
    signal(request)
    wait(response)
    do stuff with results 
```

这里的不同之处在于，first `S` `trywait`s on request 有效地将其设置为 0，因此如果很多人已经发出信号，则只有一个请求会通过。当然，互斥体的上限为 1，因此所有额外的信号累积为 1，这将被`trywait`. 第二个变化是，响应是否会解除所有`S`s的阻塞。`broadcast``U`

乍一看还不错，但是有问题。想象以下执行顺序：

```
Guy S:              Guy U1:              Guy U2:
wait(request)
                    signal(request)
working
                                         signal(request)
                    wait(response)
working
trywait(request)
broadcast(response)
                                         wait(response)
                    working
(loop) 
```

如果您仔细观察，`U2`除非有人再次发送请求（天知道将来何时），否则会被阻止。很坏。

即使只有一个用户，也可能发生这种情况：

```
Guy S:              Guy U:
wait(request)
                    signal(request)
working
trywait(request)
broadcast(response)
                    wait(response)
(loop) 
```

任何人都可以想出一个好主意，或者指导我使用一个已知的算法吗？

* * *

附加信息：

*   `S`仅定期提供新数据，但根据应用程序，用户可能会决定偶尔（通过请求）而不是定期获取数据。如果用户请求太快，我让他等待下一个周期，所以这不是问题。
*   我可以访问读写器锁、条件变量、信号量和互斥锁。Readers-writer 看起来很有希望使用响应锁，但仍不清楚所有用户何时都通过了他们的`wait(response)`部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:42:15.047

如果我理解问题描述，问题是，有时，服务实际上不需要做任何事情来计算新结果，而可以“重用”以前的结果。（我看到在提出请求之前您没有让服务做任何事情，所以我们不必担心它必须独立于请求更新内容。）如果是这种情况，您能否修改原始服务像这样：

```
Service thread (Guy S):
    while not finished
        wait(request)
        If stuff needs to be re done
            do stuff
        signal(response) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T12:47:27.877

我终于想出了以下解决方案。具有`request`和`response`作为信号量：

```
Service thread (Guy S):
    while not finished
        wait(request)
        do stuff
        users_waiting = 1
        while (trywait(request))
            ++users_waiting
        for i = 0 to users_waiting
            signal(response)

Someone requestion service (Guy U):
    signal(request)
    wait(response)
    do stuff with results 
```

我不得不承认它并不完美。考虑以下执行：

```
Guy S                Guy U1                Guy U2                Guy U3
Cycle 1:
wait(request)
                     signal(request)
                     wait(response)
do stuff
                                           signal(request)
trywait(request)
signal(response)
signal(response)
                     working                                            
                                                                 signal(request)
                                                                 wait(response)
                                                                 working
                                           wait(response)
Cycle 2:
wait(request)
do stuff
signal(response)
                                           working 
```

如您所见，在这种情况下，用户 3 可以“劫持”用户 2 的响应。不会出现死锁或其他任何情况，除非用户 2 会被阻止超过应得的程度。

# batch-file - 查询打印机网络名称并更改到另一台服务器的批处理脚本

> ID：10032596
> 
> 赞同：1
> 
> 时间：2012-04-05T16:43:15.520
> 
> 标签：batch-file

我在一台服务器上有 6 台网络打印机，需要将它们移到另一台服务器上。我有 95 个客户端使用它们，但有些只安装了某些打印机。我需要对打印机进行批处理文件查询，如果存在，则将其删除并重新添加到新服务器。这是到目前为止的脚本。我无法弄清楚查询语句。

```
@ Remove current printer from computer
Rundll32 PrintUI.DLL,PrintUIEntry /dn /q /n \\server6\Printer1

@ Add new Printer to computer
Rundll32 PrintUI.DLL,PrintUIEntry /in /q /n \\server11\Printer1

@ Remove current printer from computer
Rundll32 PrintUI.DLL,PrintUIEntry /dn /q /n \\server6\Printer2

@ Add new Printer to computer
Rundll32 PrintUI.DLL,PrintUIEntry /in /q /n \\server11\Printer2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T19:46:48.017

这是应该生成您需要的输出的东西。那是 Windows 7 中 prnmngr.vbs 的位置，我认为它在 XP 中 System32 的根目录中。无论哪种方式，它都应该删除旧的并立即添加新的。

```
@echo off
setlocal
cscript %windir%\System32\Printing_Admin_Scripts\en-US\prnmngr.vbs -l > printers.txt
set count=0
FOR /F "tokens=1-3 delims= " %%G IN (printers.txt) DO call :loop %%G %%H %%I
:loop
if "%1"=="" goto :endloop
if "%1"=="Printer" (
    if "%2"=="name" (
            if "%3"=="\\server6\Printer1" (
            echo Printer1
            REM Remove current printer from computer
            Rundll32 PrintUI.DLL,PrintUIEntry /dn /q /n \\server6\Printer1
            REM Add new Printer to computer
            Rundll32 PrintUI.DLL,PrintUIEntry /in /q /n \\server11\Printer1
        )
        if "%3"=="\\server6\Printer2" (
            echo Printer2
            REM Remove current printer from computer
            Rundll32 PrintUI.DLL,PrintUIEntry /dn /q /n \\server6\Printer2
            REM Add new Printer to computer
            Rundll32 PrintUI.DLL,PrintUIEntry /in /q /n \\server11\Printer2
        )
        pause
    )
)
SHIFT
goto :loop
:endloop 
```

**进行编辑以包含基于打印机名称匹配的删除/添加功能。**

# gcc - GNU LD：如何覆盖使用 -T 指定的链接描述文件定义的符号值（地址）

> ID：10032598
> 
> 赞同：12
> 
> 时间：2012-04-05T16:43:21.453
> 
> 标签：gcc, ld, linker-scripts

我的用例如下：

*   我正在使用基于 Makefile 的项目附带的典型 SDK
*   我相信链接器已修补 gcc。gcc --version 给我 4.3.4
*   SDK 定义了链接器脚本（我们称之为 Linker.ld）
*   Linker.ld 包括 LinkerMemMap.cfg，它定义了链接的 ELF 映像中各个部分的绝对地址
*   SDK 提供基于 Makefiles (GNU Make 3.81) 的应用程序模板，并自行制作
*   在 SDK 提供的 Makefile 模板中，当调用**gcc**时，Linker.ld 提供了 -T 命令行选项，如下所示：

`gcc $(OBJS) -l$(Lib1) -l$(Lib2) -nostdlib -lgcc -L$(library_path) -g -msmall-mode -mconst-switch-tables -mas-mode -mno-initc -Wl,--start-group,--end-group,-T,$(PATH_TO_Linker.ld),--gc-sections -o$(OUTPUT).elf`

我的要求如下：

*   我想使用 Linker.ld 中定义的部分，并按照 LinkerMemMap.cfg 使用内存映射，但是调整 LinkerMemMap.cfg 中定义的特定符号（我们称之为 SYMBOL_RAM_START）

什么有效：

*   我已经在makefile中尝试过，在链接最终的ELF映像之前，将LinkerMemMap.cfg（包含在Linker.ld中）复制到构建目录并对其进行修补以重新定义SYMBOL_RAM_START。这**确实有效**，因为链接器首先在当前文件夹中搜索链接器脚本和链接器脚本包含的文件。

什么不：

*   不幸的是，我们的利益相关者认为上述方法风险太大且太复杂而无法理解。我想用以下内容覆盖链接器命令行上的符号值：

    1.  `gcc $(OBJS) -l$(Lib1) -l$(Lib2) -nostdlib -lgcc -L$(library_path) -g -msmall-mode -mconst-switch-tables -mas-mode -mno-initc -Wl,--start-group,--end-group,-T,$(PATH_TO_Linker.ld),--gc-sections,**--defsym=SYMBOL_RAM_START=$(VALUE_TO_OVERRIDE)** -o$(OUTPUT).elf`

    2.  `gcc $(OBJS) -l$(Lib1) -l$(Lib2) -nostdlib -lgcc -L$(library_path) -g -msmall-mode -mconst-switch-tables -mas-mode -mno-initc -Wl,--start-group,--end-group,-T,$(PATH_TO_Linker.ld),--gc-sections **--defsym=SYMBOL_RAM_START=$(VALUE_TO_OVERRIDE)** -o$(OUTPUT).elf`

    3.  `gcc $(OBJS) -l$(Lib1) -l$(Lib2) **--defsym=SYMBOL_RAM_START=$(VALUE_TO_OVERRIDE)** -nostdlib -lgcc -L$(library_path) -g -msmall-mode -mconst-switch-tables -mas-mode -mno-initc -Wl,--start-group,--end-group,-T,$(PATH_TO_Linker.ld),--gc-sections -o$(OUTPUT).elf`

这些似乎都对链接器创建的链接图像没有任何影响。

*   --defsym 可以覆盖使用 -T 指定的链接描述文件定义的符号吗？
*   你们中的任何人都可以看看我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-11T17:02:11.390

在等待有人回复时，我确实解决了这个问题。这里的问题几乎没有问题，我想向可能犯同样错误的人解释我的发现。

**首先，**任何要传递给链接器的选项都必须用-Xlinker 或-Wl 指定。因此 2 和 3 在上述情况下都不起作用。修正后的 2 和 3 如下：

1.  已经正确了

2.  `gcc $(OBJS) -l$(Lib1) -l$(Lib2) -nostdlib -lgcc -L$(library_path) -g -msmall-mode -mconst-switch-tables -mas-mode -mno-initc -Wl,--start-group,--end-group,-T,$(PATH_TO_Linker.ld),--gc-sections **-Xlinker --defsym=SYMBOL_RAM_START=$(VALUE_TO_OVERRIDE)** -o$(OUTPUT).elf`

3.  `gcc $(OBJS) -l$(Lib1) -l$(Lib2) **-Xlinker --defsym=SYMBOL_RAM_START=$(VALUE_TO_OVERRIDE)** -nostdlib -lgcc -L$(library_path) -g -msmall-mode -mconst-switch-tables -mas-mode -mno-initc -Wl,--start-group,--end-group,-T,$(PATH_TO_Linker.ld),--gc-sections -o$(OUTPUT).elf`

现在对于上面的选项 1 和 2， --defsym 出现在链接描述文件之后，并且**SYMBOL_RAM_START**已经由链接描述文件定义。它确实覆盖它。但是不会使用被覆盖的值，因为这些部分已经被定义为链接描述文件已经被使用。

对于上述选项 3 的情况，**SYMBOL_RAM_START**是在链接器读取链接器脚本之前定义的。因此，当解析链接描述文件时，脚本中指定的值会覆盖它。

**解决方案：**

为了使其工作，链接描述文件需要有条件地初始化符号**SYMBOL_RAM_START**，如下所示：

SYMBOL_RAM_START =**定义（** SYMBOL_RAM_START **）？**SYMBOL_RAM_START **: DEFAULT_VALUE ;**

鉴于链接描述文件中的上述内容，当包含链接描述文件之前定义了**SYMBOL_RAM_START**时（如上面的选项 3 所示），它确实有效。但最后我不得不修补链接描述文件。

这个解决方案并没有真正覆盖符号，而是提供了一种可以定义符号的方法，以便可以覆盖它。

# java - 找不到图片

> ID：10032599
> 
> 赞同：3
> 
> 时间：2012-04-05T16:43:22.083
> 
> 标签：java, image, swing

我遇到了无法通过 Java 找到图像的问题。我和我的朋友正在做一个项目，我们做了完全相同的事情。我已经更改了图像位置的路径，甚至将图像拖放到 Eclipse 中。然而，我没有运气。这是我的代码：

```
import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.GridBagLayout;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.Insets;
import java.awt.Toolkit;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import java.util.Map;

import javax.swing.ImageIcon;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;

public class MapArray {
    static JPanel[][] tiles = new JPanel[30][29];
    static String[][] images = new String[30][30];
    final static int SIZE = 30;
    static int place=0;

public MapArray(){

}

protected static ImageIcon createImageIcon(String path) {
    java.net.URL imgURL = Map.class.getResource(path);
    if (imgURL != null) {
        return new ImageIcon(imgURL);
    } else {
        System.err.println("Couldn't find file: " + path);
        return null;
    }
}

public static void setMap(){

    try {
        String a = getFileContents("C:\\Users\\*****\\workspace\\Pokemon\\src\\map1.txt");
        for(int x=0; x<29; x++){
            for(int y=0; y<30; y++){
                images[x][y]=a.substring(0,a.indexOf(" "));
                a=a.substring(a.indexOf(" ")+1);
                System.out.println(images[x][y]);
            }
        }
    } catch (Exception e) {
        System.out.println("y u no work :(");
    }

}

public static String getFileContents(String fileName) throws Exception {
    File theFile = new File(fileName);
    byte[] bytes = new byte[(int) theFile.length()];
    InputStream in = new FileInputStream(theFile);
    int m = 0, n = 0;
    while (m < bytes.length) {
        n = in.read(bytes, m, bytes.length - m);
        m += n;
    }
    in.close();
    return new String(bytes); 
}

public static void main(String[] args) {
    javax.swing.SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            setMap();
            JFrame frame = new JFrame();
            frame.setLayout(new GridLayout(30, 29, 0, 0));
            for (int i = 0; i < 29; i++) {
                for (int j = 0; j < 29; j++) {
                    tiles[i][j] = new JPanel(new GridLayout());
                    tiles[i][j].add(new JLabel(
                            createImageIcon("C:\\Users\\*****\\workspace\\Pokemon\\src\\tile"+"-"+images[i][j]+".png")));
                    frame.add(tiles[i][j]);
                }
            }
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.pack();
            frame.setVisible(true);
        }
    });
}

} 
```

我尝试放入完整图像路径的所有方法都不起作用。另外，任何人都可以提供相对路径的帮助吗？我和我的朋友将在多台计算机之间共享代码，因此非专用于我们工作区所在位置的相对路径会很棒。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:20:17.123

```
// get resource of *your* class, instead of Java's Map.class
MapArray.class.getResource(path);
...
String a = getFileContents("map1.txt"); // local path, not absolute 
```

**并将**文件放在`src`文件旁边的`MapArray.java`文件夹中。

```
src/
 |-- MapArray.java
 |-- ...
 `-- map1.txt 
```

`map1.txt`将被移动到文件`bin`旁边的目录中`.class`（bin/ 默认情况下隐藏在 Eclipse 中，但这是设置类路径的位置）。稍后您还需要确保将资源文件打包到`.jar`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:59:39.040

您可以从一个简单的代码片段开始（我忽略导入，......因为我懒得启动我的 IDE），而不是发布一大堆代码并且不指定您在问题中收到的错误消息

```
public static void main( String[] args ){
  File file = new File( "C:...");//with the path you use in your code
  System.out.println( file.exists() );
} 
```

这是关于您发现/调试问题所需的内容。然后您可以开始将其转换为相对路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T18:44:01.130

如果资源本质上是应用程序的一部分。（嵌入式应用程序资源）而不是用于写入，它们应该添加到应用程序运行时类路径上的 Jar 中，并通过从`Class.getResource()`. 它会像这样工作：

```
URL urlToMap1 = this.getClass().getResource("/src/map1.txt"); 
```

您需要检查资源最终到达的 Jar 中的确切路径，并从 Jar ( ) 的根目录中引用它，然后是 Jar ( `/`) 中的路径`src/map1.txt`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T16:46:43.700

> 有人可以帮助解决相对路径吗？

```
String a = getFileContents("./src/map1.txt"); 
```

# algorithm - 订购广告/优惠以增加收入（置信度算法？）

> ID：10032602
> 
> 赞同：1
> 
> 时间：2012-04-05T16:43:27.410
> 
> 标签：algorithm, sorting, ads

我有一个网站，其中会有用户可以填写虚拟货币的报价列表。什么是一个不错的算法来决定按什么顺序排列它们？

重要的是：

*   新优惠上移，以便更多人看到它们，以便获得一些关于它们的指标
*   最高的 EPC 报价排在首位（最佳赚钱者，最高转化率）

我有的指标：

```
 - Tags (if the user likes movies, the offers tagged with movies should move up)
 - Reported EPC - EPC of the offer according to the affiliate network
 - Network EPC  - EPC of the offer across all of our sites
 - Site EPC     - EPC of the offer on this site
 - Source EPC   - EPC of the offer from a certain source (there can be multiple per user)
 - Payout       - How much the offer pays per conversion (lead)
 - Clicks       - Clicks network-wide, site-wide, and from a certain source 
```

有没有针对此类问题的推荐算法？我在考虑某种置信度算法（如威尔逊排序算法），但我不知道如何用我拥有的指标来实现它。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:12:41.320

您基本上是在尝试构建一个广告推荐系统。这应该是一个很好的起点： http: [//pages.cs.wisc.edu/~beechung/icml11-tutorial/](http://pages.cs.wisc.edu/~beechung/icml11-tutorial/)。看看 netflix 挑战（电影推荐）、KDD 杯 2011 挑战（音乐推荐）等

# facebook - Facebook 应用程序请求对话框继续加载/忙碌

> ID：10032605
> 
> 赞同：2
> 
> 时间：2012-04-05T16:43:48.897
> 
> 标签：facebook, dialog, fb.ui

我们有一个 facebook 应用程序，我们的应用程序非常频繁地使用 facebook 应用程序请求对话框。大多数情况下，它运行良好，没有任何错误和故障，但有时 FB.ui 对话框只是继续加载并且不显示它需要发送的请求。当这种情况发生在使用 FB.ui 对话框的任何地方时，它的行为相同并且它只是继续加载。有趣的是，几个小时后它开始正常工作（不做任何改变）

我们的每个团队成员都有一个在他们的本地机器上运行的 Web 应用程序服务器，我们都使用相同的 facebook 应用程序 ID。每当场景发生时，它在每台开发机器上都是可见的。

有没有人遇到过这样的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T11:23:35.727

最后，我们能够找到解决这个问题的方法。以下是我们写下工作的要点：

1.  这个问题在我们运行本地服务器的每台机器上都是可见的。
2.  我们创建了一个新的 facebook 应用程序（基本上是新的应用程序 id）来测试行为，新应用程序的结果也相同。
3.  我们有一个通用的演示服务器，我们从未注意到这样的问题（该服务器有不同的应用程序 ID）。

我们对服务器的设置进行了更改，并将其从 8080 移至端口 80，一切都开始完美运行。

我不明白为什么服务器上的端口号会导致 javascript 代码出现问题。

但好消息是在这个 bug 上花费了一天的时间后，我们又回到了开发轨道上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T07:39:13.257

是的，我遇到了同样的错误。Facebook 开发人员似乎没有测试他们自己的代码。他们每天都在生产环境中不断引入新的错误！！你永远不知道事情什么时候起作用。

[http://www.lazerwire.com](http://www.lazerwire.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T10:46:48.760

我可以确认问题出在端口上。在端口 80 上它可以工作，在端口 8080（我们用于开发，localhost:8080 以及 stagingserver:8080）上，FB 对话框不再工作。不知道为什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T14:52:02.227

如果您使用 to 参数来传递朋友列表。例如，不要传递超过 25 个朋友 ID。

当我将 50 个朋友传递给 apprequest 对话框时，就会发生这种情况。当通过 25 时它工作正常。

不知道什么是幻数，尝试了 26 并且仍然有效。

由于 IE6/IE7 每个请求有 25 个朋友的限制，我想尝试减少朋友的数量。

# python - QTableView 浮点精度

> ID：10032607
> 
> 赞同：4
> 
> 时间：2012-04-05T16:43:53.620
> 
> 标签：python, qt, pyside, qtableview

原来`QTableView`是截断我的花车。例如，我有价值`0.258`，在编辑后它会变成`0.26`. `QTableView`浮点数后是否可以支持多于两位十进制数字？

# c# - 反序列化列表

> ID：10032612
> 
> 赞同：3
> 
> 时间：2012-04-05T16:44:16.697
> 
> 标签：c#, protobuf-net

我在反序列化时收到此错误：

线型无效；这通常意味着您在没有截断或设置长度的情况下覆盖了文件；看到[使用 Protobuf-net，我突然得到一个关于未知线型的异常](https://stackoverflow.com/q/2152978/23354)

那只提到文件截断，但我正在创建一个新文件

```
 Stopwatch sw = new Stopwatch();
            List<SomeClass> items = CreateSomeClass();
            sw.Start();
            using (var file = File.Create(fileName))
            {
                var model = CreateModel();
                model.Serialize(file, items);
                file.SetLength(file.Position);
            }
            sw.Stop();
            logger.Debug("Saving/serialization to {0} took {1} m/s", fileName, sw.ElapsedMilliseconds);
            sw.Reset();
            logger.Debug("Starting deserialzation...");
            sw.Start();
            using (var returnStream = new FileStream(fileName, FileMode.Open))
            {
                var model = CreateModel();
                var deserialized = model.Deserialize(returnStream, null, typeof(SomeClass));
            }
            logger.Debug("Retrieving/deserialization of {0} took {1} m/s", fileName, sw.ElapsedMilliseconds);

 public static TypeModel CreateModel()
    {
        RuntimeTypeModel model = TypeModel.Create();

        model.Add(typeof(SomeClass), false)
            .Add(1, "SomeClassId")
            .Add(2, "FEnum")
            .Add(3, "AEnum")
            .Add(4, "Thing")
            .Add(5, "FirstAmount")
            .Add(6, "SecondAmount")
            .Add(7, "SomeDate");
        TypeModel compiled = model.Compile();

        return compiled;
    }

 public enum FirstEnum
{ 
    First = 0,
    Second,
    Third
}
public enum AnotherEnum
{ 
    AE1 = 0,
    AE2,
    AE3
}
[Serializable()]
public class SomeClass
{
    public int SomeClassId { get; set; }
    public FirstEnum FEnum { get; set; }
    public AnotherEnum AEnum { get; set; }
    string thing;
    public string Thing
    {
        get{return thing;}
        set
        {
            if (string.IsNullOrEmpty(value))
                throw new ArgumentNullException("Thing");

            thing = value;
        }
    }
    public decimal FirstAmount { get; set; }
    public decimal SecondAmount { get; set; }
    public decimal ThirdAmount { get { return FirstAmount - SecondAmount; } }
    public DateTime? SomeDate { get; set; }
} 
```

我是 Protobuf-net 的新手，所以有什么明显的我做错/遗漏的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:55:15.840

您将其序列化为列表，并将其反序列化为单个项目。这是个问题。要么使用 DeserializeItems，要么：而不是

```
typeof(SomeClass) 
```

经过

```
typeof(List<SomeClass>) 
```

DeserializeItems 可能稍微快一些（由于各种原因，当使用列表类型作为操作数调用 Deserialize 时，它​​必须做额外的工作）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T20:01:30.063

鉴于该错误似乎表明反序列化阅读器想要读取额外的字节，请尝试在没有 file.SetLength(file.Position) 的情况下运行您的代码，这不应该是必需的（文件流知道它的长度）。

# c# - 无法反序列化 xml 文件

> ID：10032613
> 
> 赞同：1
> 
> 时间：2012-04-05T16:44:25.387
> 
> 标签：c#, xml, list, serialization, xml-serialization

我有一个如下所示的 xml 文件，我正在尝试反序列化。

```
<info>
  <result resultCode="0000"><![CDATA[操作成功]]></result>
  <songlist>
    <song>
      <id>63672</id>
      <name><![CDATA[红玫瑰]]></name>
      <singer id="1620"><![CDATA[陈奕迅]]></singer>
      <album id="22056"><![CDATA[认了吧]]></album>
      <remark><![CDATA[]]></remark>
      <uploadinguser><![CDATA[]]></uploadinguser>
      <collectinguser><![CDATA[]]></collectinguser>
      <source>
        <link id="3441591" filesize="3842715" format="mp3"><![CDATA[http://space6.j.cn/olympic/edit/672/63672-3842715.mp3]]></link>
        <link id="3435011" filesize="3843133" format="mp3"><![CDATA[http://f8.wretch.yimg.com/satyedhome/32764/1165646407.mp3]]></link>
        <link id="3434519" filesize="3842715" format="mp3"><![CDATA[http://space0.j.cn/olympic/edit/672/63672-3842715.mp3]]></link>
      </source>
    </song>
    <song>
      <id>67228</id>
      <name><![CDATA[光荣]]></name>
      <singer id="106"><![CDATA[BOBO]]></singer>
      <album id="22523"><![CDATA[光荣]]></album>
      <remark><![CDATA[]]></remark>
      <uploadinguser><![CDATA[]]></uploadinguser>
      <collectinguser><![CDATA[]]></collectinguser>
      <source>
        <link id="3437626" filesize="5106906" format="mp3"><![CDATA[http://blog.heinekenf1.net/music/gr.mp3]]></link>
        <link id="3441621" filesize="3394663" format="mp3"><![CDATA[http://space6.j.cn/olympic/edit/228/67228-3394663.mp3]]></link>
        <link id="3090938" filesize="3395499" format="mp3"><![CDATA[http://space5.j.cn/olympic/convert/228/67228-3395499.mp3]]></link>
      </source>
    </song>
    <song>...</song>
    <song>...</song>
    <song>...</song>
    <song>...</song>
    <song>...</song>
    <song>...</song>
  </songlist>
</info> 
```

目前，这就是我作为模型所拥有的：

```
[XmlRoot("info")]
public class Response
{
    [XmlElement("result")]
    public Result Results { get; set; }

    [XmlArray("songlist")]
    [XmlArrayItem("song", typeof(Song))]
    Song[] SongList { get; set; }
}
public class Result
{
    [XmlAttribute("resultCode")]
    public int ResultCode { get; set; }
}
public class Song
{
    [XmlElement("name")]
    public string Name { get; set; }

    [XmlElement("singer")]
    public string Artist { get; set; }

    [XmlElement("album")]
    public string Album { get; set; }

    [XmlArray("source")]
    [XmlArrayItem("link", typeof(Link))]
    public Link[] Sources { get; set; }
}
public class Link
{
    [XmlAttribute("filesize")]
    public int FileSize { get; set; }
    [XmlAttribute("format")]
    public string Format { get; set; }
    [XmlText]
    public string URI { get; set; }
} 
```

但是当我尝试使用下面的代码反序列化时，它没有得到正确解析，即我没有看到 resultCode 和歌曲列表（虽然没有错误）。

```
XmlSerializer s = new XmlSerializer(typeof(Response), new XmlRootAttribute("info"));
Response response = (Response)s.Deserialize(data.CreateReader()); 
```

有什么提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T23:52:18.733

首先确保所有属性都是公共的，因为序列化只需要公共属性。您的 Song[] 没有访问修饰符，默认为私有。

使用它作为反序列化 xml 的开始。我进行了一些更改以使其正常工作。例如，使用 XmlElement 而不是 XmlArray 创建一个元素 SongList。

```
[XmlRoot("info")]
public class Response
{
    [XmlElement("result")]
    public Result Result { get; set; }

    [XmlElement("songlist")]
    public SongList SongList { get; set; }
}

public class Result
{
    [XmlAttribute("resultCode")]
    public int ResultCode { get; set; }

    [XmlText]
    public string Value { get; set; }
}

public class SongList
{
    [XmlElement("song")]
    public Song[] Songs { get; set; }
}

public class Song
{
    [XmlElement("id")]
    public string Id { get; set; }
} 
```

希望有帮助！

# regex - 在 regex.replace 中将变量与正则表达式组匹配连接

> ID：10032615
> 
> 赞同：1
> 
> 时间：2012-04-05T16:44:26.003
> 
> 标签：regex, vb.net

我在使用 regex.Replace 替换部分字符串时遇到问题。基本思想是我想捕获字符串的开头，然后用代码中的值替换字符串的结尾。例如，假设我有一个字符串，上面写着“测试编号”，后跟数字，我想增加该数字。我捕获了“测试编号”，但是当我尝试将该捕获与新编号连接时，它会将捕获 ($1) 视为文字并用 $1[新编号] 替换整个字符串。

```
Dim s as String = "We are on Test Number 1"
Dim newNumber as Integer = 2

s=Regex.Replace(s,"(Test Number )(\d)","$1" & newNumber) 
```

这将输出“We are on $12”。但是，如果我在替换中使用文字，则不会发生此问题。

```
Dim s as String = "We are on Test Number 1"

s=Regex.Replace(s,"(Test Number )(\d)","$1" & "2") 
```

正如预期的那样，这将输出“We are on Test Number 2”。

是否有人对在包含捕获的组时如何在 Regex.Replace 的替换字符串部分中使用变量有任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-27T20:04:34.227

我刚遇到同样的问题。要修复它，请转义花括号中的组号。

```
s=Regex.Replace(s,"(Test Number )(\d)","${1}" & newNumber) 
```

这是一个有效的 dotnetfiddle 示例：[https ://dotnetfiddle.net/1gZKNB](https://dotnetfiddle.net/1gZKNB)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:53:29.753

```
Dim s as String = "We are on Test Number 1"
Dim newNumber as Integer = 2

s=Regex.Replace(s,"(Test Number) (\d)","$1 " & newNumber) 
```

问题是当你连接时，你最终指定了“$12”，当然没有捕获12。在这种情况下，我们可以从“测试号”中取出尾随空格并将其添加到替换中，所以我们的替换string 是 "$1 2" 并且捕获替换按需要工作。

一个更好、更通用的解决方案（也可以在没有空格时使用）是使用`Regex.Replace`接受 a 的重载`MatchEvaluator`：

```
s = Regex.Replace(s, "(Test Number )(\d)",
   New MatchEvaluator(Function(m as Match)(m.Groups(1).Value & newNumber))) 
```

# asp.net-mvc-3 - 如何在 MVC3 控制器中调用 UpdateModel 之前禁用验证

> ID：10032619
> 
> 赞同：1
> 
> 时间：2012-04-05T16:44:48.827
> 
> 标签：asp.net-mvc-3, validation, updatemodel

我希望在提交之前启用“保存”表单数据。

我希望用户能够保存表单进度，即使表单处于无效状态，然后稍后再返回。

现在，我唯一的问题是我希望能够使用`UpdateModel`方法来更新我的模型。但是，由于表单可能无效或仅部分完成，这将引发错误。

有没有办法注释以下方法，以便在**SAVE**实例中忽略验证？

```
[HttpPost]
public ActionResult Save(Model values)
{
var model = new Model();
UpdateModel(model);
} 
```

我希望不必为要保存的元素编写 1-1 映射 - 这是我的后备选项，但不是很容易维护。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:05:42.880

试试看`TryUpdateModel(model)`，应该符合你的需求。

这不会抛出异常，**它会**更新模型，`false`如果有验证错误则返回。

如果您关心错误，请检查`ModelState`错误实例。

因此，您可以使用它来始终保存更改：

```
[HttpPost]
public ActionResult Save(Model values)
{
var model = new Model();
TryUpdateModel(model);

model.saveChanges();

} 
```

# php - php视频和照片上传：存储在数据库中与上传

> ID：10032622
> 
> 赞同：2
> 
> 时间：2012-04-05T16:45:03.067
> 
> 标签：php, mysql, file-upload, upload, blob

我将在不久的将来接近一个大型网站，该网站需要上传和存储数百甚至数千个视频。此外，需要上传许多图像，但数量不多，而且它们的尺寸很小。到目前为止，我一直使用php和mysql如下：

*   上传图片
*   将文件名存储在数据库中
*   引用数据库中的文件夹+文件名以显示文件

但是，我对一些在数据库中存储图像和文件的 BLOB 进行了一些研究，但不确定哪种方式最适合这个潜在的大型项目。我应该继续像以前一样上传，还是在mysql中使用BLOB类型更有效？我担心通过在数据库中存储大量视频和图像，可能会导致数据过多或速度过慢，但我可能完全错了。请让我知道您的任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T16:49:59.970

存储图像`BOLB`效率不高。将很难管理。您的数据库将变得很大。

它会比使用 PHP 脚本从服务器提供文件要慢

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T16:59:50.690

好的，所以两大领域是：备份和更改

**备份**

根据您选择的数据库引擎，备份需要锁定/转储/解锁。数据库越大，锁定的时间就越长。您可以使用一些功能（主/从）来允许热同步（没有锁的备份），但是备份存在无法完全覆盖数据集的风险，并且数据库的规模仍然是一个因素。如果大文件只是文件（而不是 DB BLOBS），则只需为文件系统制定备份策略，并且由于它们可能是静态的，这仅意味着存储多个副本（这甚至可以在上传时设计- 存储在服务器 A 和服务器 B)。

**改变**

您希望您的系统保持不变吗？听起来你会有缩放问题。随着系统的增长，您是否可以将数据库移动到另一台服务器，将文件存储移动到另一台服务器或 SAN（或 S3 等）？如果您已将其全部锁定在数据库中，则必须依靠仅数据库的解决方案来处理膨胀的大小（大型昂贵的服务器、主/从等）。当然，您可以将文件存储在一个数据库中（较少的备份要求，不会弄乱您的数据数据库）和另一个数据库中的其他数据......但是文件系统是一种数据库。

**所以**

因此，对于备份和扩展，将大文件存储为文件而不是 BLOB 是一个更好的解决方案。如果文件很小（例如低 MP JPG），则平衡可能会发生变化。但是对于大文件，数据库处理的开销以及它对数据库服务器的额外负载要求是没有意义的。让他们分开。

# html - 我需要在这里更改我的 CSS 什么

> ID：10032624
> 
> 赞同：0
> 
> 时间：2012-04-05T16:45:09.520
> 
> 标签：html, css

我以前有表格来显示内容，这里的人建议我删除表格并使用 CSS 浮动来获得更好的样式。

我对一切都很陌生。我的问题是我有内容和侧边栏。我希望它显示为

```
content           | Sidebar 
```

但是现在以我当前的样式显示它就像

```
content
|
Sidebar 
```

你能纠正我吗？

```
 <style type="text/css">

   .csscontent
    {

          margin-right: 500px;

    }

   .csssidebar
    {
        float: right;
        width: 500px;
        background: darkgreen;
       /*  height:500px; */

    }

</style> 
```

如果我添加

```
 <div class="Content">
  all the content
 <div class="sidebar">
 <Image>
 </div> 
```

如果我在内容中添加侧边栏，则图像将显示在内容下方，右边距为 500px。

如果我在内容之外添加侧边栏，则图像将显示在内容下方。

```
 <div class="Content">
  all the content
  </div>

   <div class="sidebar">
   <Image>
  </div> 
```

**我希望内容和侧边栏并排显示**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:51:10.170

在 HTML 文件中，您首先需要设置浮动元素，然后是非浮动元素。因为浮动元素会挡住网站的整个“层级”，而浮动元素放在下方。

所以你的 html 应该是这样的：

```
 <div class="sidebar">
   <Image>
  </div>
  <div class="Content">
  all the content
  </div> 
```

除此之外，它看起来不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:48:31.077

将浮动添加到 .csscontent 类，如

```
 .csscontent
    {
          margin-right: 500px;
          Float:left;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T16:49:28.923

```
.content, .sidebar {
  float: left;
} 
```

像上面一样向左浮动两个 div 将显示两个内联。

然后，您可以将特定样式应用于每个类。然后为 .content 分配宽度将确定 .sidebar 出现的位置...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T16:53:11.553

或者，如果您只想将侧边栏浮动到右侧，而不浮动内容，您应该将侧边栏放在 HTML 中的内容上方。

当然，你仍然需要更正类名......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T16:55:15.387

您可以为这两个元素添加一个包装器。

```
<div id="wrapper">

  <div id="content">
      all the content
  </div>

  <div id="sidebar">
      <img/>
  </div>

</div>

div#wrapper {
     position:relative;
     overflow:hidden;
     width:800px;
}

div#content {
     float:left;
     width:600px;
} 

 div#sidebar {
     float:right;
     width:200px;
 } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-05T16:48:23.417

将两者都向左浮动，使它们相互堆叠。

```
 .Content
    {
          margin-right: 500px; 
          float: left; 
    }

   .sidebar
    {
        float: left;
        width: 500px;
        background: darkgreen;
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-05T17:17:38.310

请参阅小提琴的代码和演示

小提琴：http: [//jsfiddle.net/g42x2/1/](http://jsfiddle.net/g42x2/1/)

演示：http: [//jsfiddle.net/g42x2/1/embedded/result/](http://jsfiddle.net/g42x2/1/embedded/result/)

不锈钢：

![在此处输入图像描述](../Images/2eb8cd0bfb5d74b7410c1b806ce4e519.png)

# javascript - 如何使用 jQuery *不*计算相对定位元素的绝对位置？

> ID：10032630
> 
> 赞同：0
> 
> 时间：2012-04-05T16:45:36.660
> 
> 标签：javascript

我知道有很多方法可以使用 jQuery 计算元素的偏移量或位置，但我正在开发一个库，该库将由可能使用或不使用 jQuery 的客户使用，我需要将其保持尽可能小。

是否有轻量级库或示例与 jQuery 的 offset() 函数的工作方式相同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T16:50:58.610

```
elem.offsetLeft
elem.offsetTop 
```

这两个属性告诉你元素`elem`相对于它的位置`offsetParent`。元素的 offsetParent 通常是带有`position: relative`、表格或文档本身的容器（或其他一些我不记得的东西）。

您可以循环遍历`offsetParent`链，直到没有更多父级，将`offsetLeft`and加`offsetTop`在一起以获得相对于整个页面的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:27:13.743

查看 jquery 的代码，看看它是如何计算元素位置的。

请记住，jquery 被设计为可以在任何地方工作。

# asp.net - 实施用户活动跟踪

> ID：10032643
> 
> 赞同：3
> 
> 时间：2012-04-05T16:46:22.123
> 
> 标签：asp.net, sql, insert, message, tracking

我正在使用 sql server 2008 R2 开发 ASP.NET 网站。我需要实现一个跟踪系统来跟踪用户活动，例如用户浏览了哪些页面喜欢哪些项目等等我有很多选择并尝试了其中的几个

1.  我试图在用户浏览的每个页面上发送一个插入，但结果是 sql 服务器上的负载很大，两天后我将其删除
2.  我有一个解决方案是在 xml 中缓冲用户历史记录，并在数据库中每 500 条记录刷新一次。它工作正常，但当用户数量增加时会很糟糕
3.  我发现有像 MSMQ 和 SQL 服务代理这样的消息队列，但我没有在这方面进一步深入 最后我想听听你的建议和建议，以及你对 MSMQ 和 SQL 服务代理的评论，如果我应该去对于他们以及两者中的哪一个以及为什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:50:13.073

您可以尝试使用[log4net](http://logging.apache.org/log4net/index.html)或[nLog 之](http://nlog-project.org/)类的日志框架，它可以让您灵活地记录到各种目标，还可以使用缓冲/异步日志记录来减少负载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:52:00.903

我会使用谷歌分析之类的东西。这很简单，您只需将样板代码放入您的页面，其余的由谷歌完成。

# image - 将图像分配给类别，并在 WordPress 上发布

> ID：10032645
> 
> 赞同：0
> 
> 时间：2012-04-05T16:46:29.920
> 
> 标签：image, wordpress, categories, posts, assign

我想将图像分配给一个类别，它是 WordPress 上的帖子。添加新帖子时，它将获取图像并分配给它的容器类别。如果您有任何帮助或插件来做到这一点，我将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T00:51:43.810

根据您的问题，我认为您正在尝试在单个列表中显示来自多个类别的帖子（或者可能是帖子摘录），并根据它们的各个类别在这些帖子中包含图像。

如果您只尝试在一个地方显示这些图像并且它们不会经常更改，则可以直接在循环中包含一些条件。

```
<!-- Test to see if the post is in a given cat and apply a custom class for styling -->
<?php if ( in_category('CATNUMBER') ) { ?>
    <div class="SOME-CUSTOM-STYLE">
<?php } else { ?>
<div class="GENERIC-NON-STYLED-POST">
<?php } ?> 
```

一旦按类别编号对 div 进行自定义类，就可以在 CSS 中设置背景图像的样式。或者，您可以在循环中直接吐出一个标签。

如果您预见到经常添加新类别和/或更改图片，您可能需要一种更简洁的方式来执行此操作。如果您只有少数几个类别，或者如果您愿意经常对循环进行更改，那么这会很好。

# javascript - jqueryui对话框灰屏

> ID：10032648
> 
> 赞同：5
> 
> 时间：2012-04-05T16:46:42.303
> 
> 标签：javascript, jquery, jquery-ui, dialog, overlay

我正在使用 jQueryUI（扩展？）并在页面上有一个简单的覆盖。[**这是我到目前为止所拥有的**](http://jsfiddle.net/vhA2w/)

无论如何，当对话框打开时，是否有任何内置方法可以使屏幕变灰？我知道你可以通过在页面上附加另一个 div 来做到这一点，我想知道 jQueryUI 是否内置了类似的东西。

我在 API 上找不到类似的东西，也许我错过了一些东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T16:49:03.223

您可以使用对象文字为对话框指定选项。其中一个选项是模态的，它将在对话框后面的屏幕上放置一个叠加层。此叠加层将阻止用户在对话框后面单击。

```
$('#over').dialog({modal:true}); 
```

示例：http: [//jsfiddle.net/vhA2w/1/](http://jsfiddle.net/vhA2w/1/)

在以下位置查看所有可用选项：http: [//jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:49:30.257

[这个jsfiddle](http://jsfiddle.net/vhA2w/2/)应该适合你

```
$('#over').dialog({ modal: true }); 
```

# ruby-on-rails - 获取 Marshal.dump 输出的 KB 大小

> ID：10032650
> 
> 赞同：0
> 
> 时间：2012-04-05T16:46:49.763
> 
> 标签：ruby-on-rails, ruby, marshalling

我`Marshal.dump`用来序列化对象数组，我需要获取返回值的大小（以 KB 为单位）。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:02:07.900

由于的输出`Marshal.dump`是一个字符串，你可以只询问它的长度。最安全的方法是要求`bytesize`：

```
dumped = Marshal.dump(array)
kb = dumped.bytesize / 1024 
```

该`bytesize`方法始终以字节为单位返回字符串的长度，而以字符为单位`length`返回字符串的长度。如果您使用像 UTF-8 这样的多字节编码方法，这两个值可能会有所不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T16:59:14.733

怎么样`kbytes = Marshal.dump(ary_of_objs).size / 1000.0`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-07T11:46:36.870

```
var = Base64.encode64(Marshal.dump(@result))
var.size 
```

是我的救命稻草

# html - 是否可以循环播放视频列表？

> ID：10032661
> 
> 赞同：0
> 
> 时间：2012-04-05T16:47:32.013
> 
> 标签：html, video, loops

标题基本概括了所有内容。我在当前播放视频的网页上有一个位置。我想更新页面，以便我可以添加一行代码，并引用位于具有源的文件夹中的几个文件，并且页面将播放第一个视频，然后是第二个，等等，直到它到达最后一个视频，然后再次播放第一个视频，无限循环。最好是这行代码能够播放视频文件、.swf 文件、图片（在预定的时间长度内）等。

目前，我只是使用一个非常基本的

```
<video width="100%" height="100%">
        <embed loop="true" showcontrols="0" align="left" src="New Site Folder\DemoVid_sound_mods.avi"/>
</video> 
```

但是，这样做的问题是它只播放一个视频，如果我想添加更多部分，我必须编辑视频本身，而不是仅仅在文件夹中弹出一个新文件。

我看到另一个问题的回答提到了使用 javascript 进行此操作，但该项目的全部意义在于使其非常容易和快速更新。我在这里寻找的主要内容是让我们能够通过在记事本中打开文件、添加一行代码、保存并运行它来更新页面。

有什么想法吗？即使只是关于此处可能有用的命令的指针也会有所帮助。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-09T13:24:28.747

据我所知，您将无法使用浏览器原生的内置 html5 视频播放器来做到这一点，这不是构建它们的原则。

您正在寻找的更多是媒体播放列表样式的功能集。

您将不得不使用其中一个基于 javascript 的 html5 视频播放器来获得其中的一些功能，但即便如此我也不确定是否支持 swf 和图像文件 我见过一些可以处理各种视频和音频文件但没有的HTML5里面也做swfs也一样，这些播放器的前提通常是根除flash。

我在一个嵌入中完成所有这些的最佳建议是通过处理播放列表等的 longtail/jw 播放器或 flowplayer 使用 flash，或者我知道它可以同时处理图像、视频和音频的 slideshowpro。

最后.. 回到十年左右。有一种语言未被充分利用，并且受到称为 SMIL 的各种支持，它支持您提到的所有这些元素，但是随着 Flash 视频的引入，它的吸收有点分崩离析。我记得 Realplayer 和 Quicktime 可以提供 SMIL 文件，但这些天我在 SMIL 中做任何事情都会非常谨慎。

希望有帮助。一个

# ruby-on-rails - ArgumentError：使用 rsa gem 时消息代表超出范围

> ID：10032664
> 
> 赞同：0
> 
> 时间：2012-04-05T16:47:46.717
> 
> 标签：ruby-on-rails, ruby, encryption, rsa, public-key-encryption

尝试加密大消息时出现此错误。我想知道这是否是 rsa.rb 的限制，或者我做错了什么。有没有人碰到这个错误？

这发生在客户端，我正在使用服务器的公钥加密一条巨大的消息，如下所示：

```
RSA::KeyPair.new(nil,server_public_key).encrypt(huge_base64_str) 
```

这段代码爆炸了`ArgumentError: message representative out of range when using the rsa gem`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T14:05:07.290

在这种情况下，最好的做法是使用对称密钥（例如 AES）加密消息，然后使用 rsa 加密对称密钥。并发送消息和加密的对称密钥。

# java - 来自 Java 开发人员 POV 的 iOS 代表

> ID：10032666
> 
> 赞同：4
> 
> 时间：2012-04-05T16:47:52.200
> 
> 标签：java, iphone, objective-c, ios, delegates

我从事 Java 开发已有几年了，大约一年前开始从事 Android 开发。在解决了 Android 之后，我尝试用 iOS 测试我的运气。到目前为止一切顺利，但我对“代表”的想法仍然很模糊。我在这里阅读了几篇文章，但仍然没有最好的想法。对我来说，它们似乎类似于 Java 中的继承，例如使用接口或抽象类。

任何人都可以以我可能理解的观点澄清吗？

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T16:52:56.343

不，这与继承的概念不同。

我会说这就像在 AWT/Swing 中使用的侦听器方法。例如：

```
class MyActionListener implements ActionListener {
  public void actionPerformed(ActionEvent e) { ... }
}

myComponent.addActionListener(new MyActionListener); 
```

这与 ObjC 中的委托方法看起来像：

```
@class MyActionListener : NSObject<NSActionListener>

-(void) actionPerformed:(NSEvent*)event;

@end

myComponent.delegate = [[[MyActionListener alloc] init] autorelease]; 
```

在实践中，您将类的某些行为*委托*给组合使用的特定其他对象（而不是通过继承），以便在需要时调用委托方法（用于回调，或者提供特定的实现等等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:50:09.823

使用对象时，可以从其类继承一些回调方法。基本上，您可以在该对象有事件时做出响应。

对象类将该事件“委托”给您的类实例。

# audio - 在 Win8 中播放原始 PCM 波形音频（消费者预览版）

> ID：10032670
> 
> 赞同：2
> 
> 时间：2012-04-05T16:48:02.647
> 
> 标签：audio, windows-8

是否可以在 Windows 8 中流式传输或播放原始未压缩的 PCM 音频数据？我不想播放文件，而是推送我自己的音频样本（例如生成正弦波）。我正在运行 Win8 消费者预览版。我知道 NAudio 在 Win7 和更早版本的 Windows 中可以做到这一点。我尝试在 Visual Studio 11 项目中引用 NAudio，但 NAudio 依赖于 System.Windows.Forms.dll，它在 Win8 消费者预览版中不存在（据我所知）。在 Win8 预览版中是否有另一种方法可以实现这一点？我更喜欢使用托管代码或 JavaScript 的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:04:23.993

您没有指定您喜欢的语言，所以我将假设 C#。对于 C#，我可以想到几个可能的选项：

1.  SharpDX + XAudio2。这也适用于 C++，而不需要 SharpDX
2.  在 Silverlight 中，您可以使用 MediaStreamSource -[在 Silverlight 中播放 Wave 文件](http://blogs.msdn.com/b/gillesk/archive/2009/03/23/playing-back-wave-files-in-silverlight.aspx)。我在 WinRT 中看不到它，但可能存在类似的替代方案。
3.  利用 XAudio2 在 C++ 中编写 winrt 库。这样您就不需要使用 SharpDX，您可以从 C# 或 JavaScript 应用程序中调用它。

# android - 具有 2 个活动的 Android 应用程序 - 键码返回的不同操作？

> ID：10032675
> 
> 赞同：0
> 
> 时间：2012-04-05T16:48:19.970
> 
> 标签：android

我在 Android 应用程序上遇到问题。

我有 2 个活动：Activity1 和 Activity2。

Activity1 是我的默认活动。Activity2 是第二个活动。

这是 Activity1 中带有 KEYCODE_BACK 的 onKeyDown 的代码：

```
finish();
return true; 
```

这是我的 Activity2 针对同一事件的代码：

```
Intent myIntent = new Intent(this, Activity1.class);
startActivityForResult(myIntent, 0);
return true; 
```

我的问题是： - 我启动应用程序，我按“返回”：应用程序已关闭 - 好的 - 我启动应用程序，我转到 Activity2（通过按钮），我按“返回”：我回到 Activity1，我再次按下“Back”：我回到 Activity2 而不是应用“finish()”。

有人可以告诉我我做错了什么吗？

有关信息，我的 Activity2 是这样调用的：

```
Intent myIntent = new Intent(this, Activity2.class);
startActivityForResult(myIntent, 0);
return true; 
```

提前致谢。

罗曼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T16:55:12.897

该应用程序的行为完全符合您的代码。没有错误。问题是你希望你的应用程序（活动）如何表现你期望什么。另一件事是不要覆盖后退按钮。Android 用户知道后退按钮的行为方式，他们希望它在应用程序中的行为保持一致，如果您的行为不同，他们会很生气。

# php - 有没有人从 PHP 模板转到 XSLT 模板并且不后悔？

> ID：10032679
> 
> 赞同：2
> 
> 时间：2012-04-05T16:48:35.493
> 
> 标签：php, xslt, templating

我正在使用某个框架，主要开发人员正在考虑从基于原生 PHP 的模板彻底更改为 XSLT 模板。

我担心这不可行，因为在我们的网站上，我们通常有非常复杂的模板逻辑。

对于这样简单的事情：

```
 if ( $something ) { ?>
        <p><?php if ( $another ) { ?>Lorem Ipsum<?php } else { ?>Dolor amet<?php } ?>.</p>
    <?php } else { ?>
        <p><?php if ( $another ) { ?>Lorem Ipsum<?php } else { ?>Dolor amet<?php } ?>.</p>
    <?php } ?> 
```

等效的 XSLT 将是：

```
 <xsl:choose>
        <xsl:when test="blah">
            <xsl:choose>
                <xsl:when test="another">
                    <p>Lorem Ipsum.</p>
                </xsl:when>
                <xsl:otherwise>
                    <p>Dolor amet.</p>
                </xsl:otherwise>
        </xsl:when>
        <xsl:otherwise>
                <xsl:when test="another">
                    <p>Lorem Ipsum.</p>
                </xsl:when>
                <xsl:otherwise>
                    <p>Dolor amet.</p>
                </xsl:otherwise>
        </xsl:otherwise>
    </xsl:choose> 
```

这么简单的代码片段，一想到高级场景就吓到我了。

我想知道是否有人经历过类似的模板转换，如果是这样，您是如何应对的？你回去了吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T20:19:35.483

在 XSLT 1.0 中，您建议的代码可以简化为：

```
<p>
   <xsl:choose>
        <xsl:when test="blah">
                <xsl:when test="another">Lorem Ipsum.</xsl:when>
                <xsl:otherwise>Dolor amet.</xsl:otherwise>
        </xsl:when>
        <xsl:otherwise>
                <xsl:when test="another">Lorem Ipsum.</xsl:when>
                <xsl:otherwise>Dolor amet.</xsl:otherwise>
        </xsl:otherwise>
    </xsl:choose>
</p> 
```

在 XSLT 2.0 中，它可以进一步简化为：

```
<p>
  <xsl:value-of select="if (test=blah) 
                        then if (test=another) then 'Lorem ipsum' else 'Dolor amet'
                        then if (test=another) then 'Lorem ipsum' else 'Dolor amet'"/>
</p> 
```

这让我觉得比你的 PHP 原版要好得多。

对于更一般的问题，XSLT 确实有一个陡峭的学习曲线。那些坚持使用并掌握概念的人通常对这种语言非常满意。但也有不少人在到达那一点之前就冷落了，放弃了，因为这与他们以前遇到的任何事情都大不相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T16:54:15.997

以我的经验，最终，我总是回到普通`.phtml`文件——不是说这是正确的事情或理想的事情，而是解决了当时的问题。

XSLT 从来没有为我做正确的事情，即使对于更简单的逻辑模板也是如此。

如果有任何模板系统让我感到高兴，那就是[Twig](http://twig.sensiolabs.org/)。

# java - Spring 的 Jaxb2Marshaller 在没有网络连接的情况下失败

> ID：10032682
> 
> 赞同：0
> 
> 时间：2012-04-05T16:48:43.527
> 
> 标签：java, spring, jaxb

如果由于 SAXParseException 而我不在线，我的 Spring 上下文初始化将失败，通过嗅探器，我注意到在 tomcat 启动和单元测试期间多次请求 XMLSchema.dtd 和 datatypes.dtd。我在这里阅读了有关使用目录的信息[http://jaxb.java.net/2.2.4-1/docs/catalog.html](http://jaxb.java.net/2.2.4-1/docs/catalog.html)但不知道如何定义或如何将其插入我的应用程序。另一种方法是使用 META-INF/spring.schemas 但这似乎是在 Spring 配置中使用 xsd，所以不要认为它会适用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:56:34.277

我发现该请求是`<!DOCTYPE`由我的架构引用的 xmldsig-core-schema.xsd 上的标头引起的，我不知道它的用途，但我为我的应用程序删除了它。这是xsd上方的片段：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE schema PUBLIC "-//W3C//DTD XMLSchema 200102//EN" "http://www.w3.org/2001/XMLSchema.dtd" [
   <!ATTLIST schema 
     xmlns:ds CDATA #FIXED "http://www.w3.org/2000/09/xmldsig#">
   <!ENTITY dsig 'http://www.w3.org/2000/09/xmldsig#'>
   <!ENTITY % p ''>
   <!ENTITY % s ''>
  ]>
<!-- ...
-->
<schema ... 
```

# actionscript-3 - 1067：将 Class 类型的值隐式强制转换为不相关的类型 flash.display:DisplayObject

> ID：10032683
> 
> 赞同：1
> 
> 时间：2012-04-05T16:48:54.323
> 
> 标签：actionscript-3

例如，我有三个名为“Helicopter.as、Game.as、Blue.as”的 .as 文件，还有一个名为 Helicopter.fla 的 .fla 文件（这些文件都假设链接在一起，以使直升机游戏）。在 Game.as 文件中，我有以下内容；

```
if (blue1.hitTestObject(Helicopter))

                {
                    trace("YOU HIT THE BLOCK!");

                    Helicopter.x = 76;
                    Helicopter.y = 217;
                } 
```

我使用此代码在名为 Helicopter.as 的不同文件中使用 API 绘制了所谓的“直升机”^；

```
 graphics.beginFill(0x00FF00);
        graphics.drawCircle(0, 60, 35);
        graphics.endFill(); 
```

但是，我最初在 Helicopter.fla 文件中绘制了“直升机”符号（我现在已将其删除），现在我使用 API 绘制了“直升机”，我得到了这个错误；

```
 ''1067: Implicit coercion of a value of type Class to an unrelated type flash.display:DisplayObject.'' 
```

Flash 无法识别原始的 Helicopter 符号（在 Helicopter.fla 文件中，因为我删除了它）。但我希望系统检测使用 API 绘制的“圆”（在 Helicopter.as 文件中）。而且我不知道如何将 API 绘制的圆圈命名为“直升机”，因此出现错误。那么如何将 API 圈命名为“直升机”，以便 Game.as 文件识别它。如果您不知道我在说什么，请不要担心，因为我也不知道。谢谢你。如果你愿意，我可以粘贴到目前为止我所做的所有代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T16:55:32.973

`Helicopter`是一个类而不是一个变量，因此你不能分配`Helicopter.x`. 您需要创建一个变量`var heli:Helicopter = new Helicopter();`并使用`heli.x`

也可能是您没有遵循编程标准，`Helicopter`实际上是一个变量而不是一个类，尽管错误似乎表明并非如此。

# performance - MongoDb/C# 并发读取性能差

> ID：10032687
> 
> 赞同：0
> 
> 时间：2012-04-05T16:49:16.537
> 
> 标签：performance, mongodb

我正在测试一些 NoSQL 解决方案，主要关注读取性能。今天是 MongoDb 日。测试机器是具有四核 Xeon @2.93GHz 和 8GB RAM 的 VM。

我只使用数据库和一个包含约 100.000 个文档的集合进行测试。BSON 文档大小约为 20Kb，或多或少。

我正在使用的托管对象是：

```
private class Job
{
    public int Id { get; set; }
    public string OrganizationName { get; set; }
    public List<string> Categories { get; set; }
    public List<string> Industries { get; set; }
    public int Identifier { get; set; }
    public string Description { get; set; }
} 
```

测试过程：

- 创建 100 个线程。

- 启动所有线程。

- 每个线程从集合中随机读取 20 个文档。

这是我正在使用的选择方法：

```
private static void TestSelectWithCursor(object state)
{
    resetEvent.WaitOne();

    MongoCollection jobs = (state as MongoCollection);
    var q = jobs.AsQueryable<Job>();
    Random r = new Random(938432094);
    List<int> ids = new List<int>();
    for (int i = 0; i != 20; ++i)
    {
        ids.Add(r.Next(1000, 100000));
    }
    Stopwatch sw = Stopwatch.StartNew();
    var subset = from j in q
                 where j.Id.In(ids)
                 select j;

    int count = 0;
    foreach (Job job in subset)
    {
        count++;
    }
    Console.WriteLine("Retrieved {0} documents in {1} ms.", count, sw.ElapsedMilliseconds);
    ThreadsCount++;
} 
```

“count++”只是假装我在检索光标后正在做某事，所以请忽略它。

无论如何，这个想法是我得到了在我看来非常缓慢的阅读时间。这是一个典型的测试结果：

```
> 100 threads created.
> 
> Retrieved 20 documents in 272 ms. Retrieved 20 documents in 522 ms.
> Retrieved 20 documents in 681 ms. Retrieved 20 documents in 732 ms.
> Retrieved 20 documents in 769 ms. Retrieved 20 documents in 843 ms.
> Retrieved 20 documents in 1038 ms. Retrieved 20 documents in 1139 ms.
> Retrieved 20 documents in 1163 ms. Retrieved 20 documents in 1170 ms.
> Retrieved 20 documents in 1206 ms. Retrieved 20 documents in 1243 ms.
> Retrieved 20 documents in 1322 ms. Retrieved 20 documents in 1378 ms.
> Retrieved 20 documents in 1463 ms. Retrieved 20 documents in 1507 ms.
> Retrieved 20 documents in 1530 ms. Retrieved 20 documents in 1557 ms.
> Retrieved 20 documents in 1567 ms. Retrieved 20 documents in 1617 ms.
> Retrieved 20 documents in 1626 ms. Retrieved 20 documents in 1659 ms.
> Retrieved 20 documents in 1666 ms. Retrieved 20 documents in 1687 ms.
> Retrieved 20 documents in 1711 ms. Retrieved 20 documents in 1731 ms.
> Retrieved 20 documents in 1763 ms. Retrieved 20 documents in 1839 ms.
> Retrieved 20 documents in 1854 ms. Retrieved 20 documents in 1887 ms.
> Retrieved 20 documents in 1906 ms. Retrieved 20 documents in 1946 ms.
> Retrieved 20 documents in 1962 ms. Retrieved 20 documents in 1967 ms.
> Retrieved 20 documents in 1969 ms. Retrieved 20 documents in 1977 ms.
> Retrieved 20 documents in 1996 ms. Retrieved 20 documents in 2005 ms.
> Retrieved 20 documents in 2009 ms. Retrieved 20 documents in 2025 ms.
> Retrieved 20 documents in 2035 ms. Retrieved 20 documents in 2066 ms.
> Retrieved 20 documents in 2093 ms. Retrieved 20 documents in 2111 ms.
> Retrieved 20 documents in 2133 ms. Retrieved 20 documents in 2147 ms.
> Retrieved 20 documents in 2150 ms. Retrieved 20 documents in 2152 ms.
> Retrieved 20 documents in 2155 ms. Retrieved 20 documents in 2160 ms.
> Retrieved 20 documents in 2166 ms. Retrieved 20 documents in 2196 ms.
> Retrieved 20 documents in 2202 ms. Retrieved 20 documents in 2254 ms.
> Retrieved 20 documents in 2256 ms. Retrieved 20 documents in 2262 ms.
> Retrieved 20 documents in 2263 ms. Retrieved 20 documents in 2285 ms.
> Retrieved 20 documents in 2326 ms. Retrieved 20 documents in 2336 ms.
> Retrieved 20 documents in 2337 ms. Retrieved 20 documents in 2350 ms.
> Retrieved 20 documents in 2372 ms. Retrieved 20 documents in 2384 ms.
> Retrieved 20 documents in 2412 ms. Retrieved 20 documents in 2426 ms.
> Retrieved 20 documents in 2457 ms. Retrieved 20 documents in 2473 ms.
> Retrieved 20 documents in 2521 ms. Retrieved 20 documents in 2528 ms.
> Retrieved 20 documents in 2604 ms. Retrieved 20 documents in 2659 ms.
> Retrieved 20 documents in 2670 ms. Retrieved 20 documents in 2687 ms.
> Retrieved 20 documents in 2961 ms. Retrieved 20 documents in 3234 ms.
> Retrieved 20 documents in 3434 ms. Retrieved 20 documents in 3440 ms.
> Retrieved 20 documents in 3452 ms. Retrieved 20 documents in 3466 ms.
> Retrieved 20 documents in 3502 ms. Retrieved 20 documents in 3524 ms.
> Retrieved 20 documents in 3561 ms. Retrieved 20 documents in 3611 ms.
> Retrieved 20 documents in 3652 ms. Retrieved 20 documents in 3655 ms.
> Retrieved 20 documents in 3666 ms. Retrieved 20 documents in 3711 ms.
> Retrieved 20 documents in 3742 ms. Retrieved 20 documents in 3821 ms.
> Retrieved 20 documents in 3850 ms. Retrieved 20 documents in 4020 ms.
> Retrieved 20 documents in 5143 ms. Retrieved 20 documents in 6607 ms.
> Retrieved 20 documents in 6630 ms. Retrieved 20 documents in 6633 ms.
> Retrieved 20 documents in 6637 ms. Retrieved 20 documents in 6639 ms.
> Retrieved 20 documents in 6801 ms. Retrieved 20 documents in 9302 ms. 
```

最重要的是，我期望获得比这更快的读取时间。我还在想我做错了什么。不知道我现在可以提供哪些其他信息，但如果有任何遗漏，请告诉我。

我还包括，希望它会有所帮助，对测试执行的查询之一的 explain() 跟踪：

```
{
        "cursor" : "BtreeCursor _id_ multi",
        "nscanned" : 39,
        "nscannedObjects" : 20,
        "n" : 20,
        "millis" : 0,
        "nYields" : 0,
        "nChunkSkips" : 0,
        "isMultiKey" : false,
        "indexOnly" : false,
        "indexBounds" : {
                "_id" : [
                        [
                                3276,
                                3276
                        ],
                        [
                                8257,
                                8257
                        ],
                        [
                                11189,
                                11189
                        ],
                        [
                                21779,
                                21779
                        ],
                        [
                                22293,
                                22293
                        ],
                        [
                                23376,
                                23376
                        ],
                        [
                                28656,
                                28656
                        ],
                        [
                                29557,
                                29557
                        ],
                        [
                                32160,
                                32160
                        ],
                        [
                                34833,
                                34833
                        ],
                        [
                                35922,
                                35922
                        ],
                        [
                                39141,
                                39141
                        ],
                        [
                                49094,
                                49094
                        ],
                        [
                                54554,
                                54554
                        ],
                        [
                                67684,
                                67684
                        ],
                        [
                                76384,
                                76384
                        ],
                        [
                                85612,
                                85612
                        ],
                        [
                                85838,
                                85838
                        ],
                        [
                                91634,
                                91634
                        ],
                        [
                                99891,
                                99891
                        ]
                ]
        }
} 
```

如果您有任何想法，那么我将非常渴望阅读它。先感谢您！

马塞尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:34:09.160

我怀疑“in”（通用修饰符）正在强制进行顺序扫描，并完全提取每个文档以检查 where 子句，从而绕过使用 _id 索引的效率。鉴于随机数可以相当分布，我的猜测是每个线程/查询基本上都在扫描整个数据库。

我建议尝试几件事。(1) 通过单独的单个 id 单独查询 20 个文档中的每一个 (2) 考虑使用 MongoCursor 并使用 Explain 来获取有关查询的索引使用的信息

祝福，

-加里

PS 线程时间似乎表明工作中也有一些线程调度效果。

# javascript - 让 HTML5 MP3 播放器在页面加载时保持不变

> ID：10032688
> 
> 赞同：0
> 
> 时间：2012-04-05T16:49:20.587
> 
> 标签：javascript, ajax, html, hash, history.js

所以我一直在对不同的方法进行一些研究，以实现让播放器（或与此相关的任何元素）在这样的页面加载中持续存在，似乎有两种选择。我将创建我的站点以利用 AJAX 负载这两者：

1.  **Hash bang** - 这似乎在网络上有很多仇恨，但现在应该适用于所有浏览器。它似乎也很容易实现。

2.  **HTML5 历史**- 根据我的阅读，这是执行此操作的“正确”方式，但是，目前它对浏览器的支持非常有限。对于不支持的浏览器，将发生整页刷新 (History.js)。

所以我的问题是：还有第三种选择吗？或者有人可以权衡以上两个吗？HTML5 History 似乎“更好”，但如果我需要网站在所有浏览器中正常工作，那么 Hash bang 是我唯一的选择。这是真的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:04:29.050

使用 history 和[onpopstate](https://developer.mozilla.org/en/DOM/window.onpopstate)作为第一个选项，但是当失败时，设置 hash bangs。然后确保您的路由可以处理散列爆炸和漂亮的 onpopstate URL，以便用户可以关注任一书签。

我自己曾经使用过这种配置，它并不是很多 JavaScript。把它做好很烦人，但它是可行的，值得付出努力在所有浏览器中提供最佳体验。

如果有更好的解决方案，我很想听听对此的第二意见。

# python - 如何使用 Mock 框架更改模拟方法的输出？

> ID：10032691
> 
> 赞同：3
> 
> 时间：2012-04-05T16:49:27.330
> 
> 标签：python, unit-testing, mocking, sqlalchemy, python-mock

我有一个如下模块：

```
'''example.py'''
from some.module import Session

def init_system():
    var_one = Session.query(SQLAModelA).all()
    var_two = [(x.attr_B_a, x) for x in Session.query(SQLAModelB).all()]

    for value in var_one:
        something = value.attr_A_a + value.attr_A_c
    # Will do something with var_two etc (which has different attributes)
    something_else = [x.attr_B * 2 for x in var_two]
    return result 
```

会话是指与数据库对话的 SQLAlchemy 会话处理程序。出于测试目的，我需要能够模拟 Session 对象（或者可能只是 Session 对象？）中的查询方法，这样我就可以`init_system`在不与数据库实际交互的情况下进行测试。我如何使用[Mock 框架](http://www.voidspace.org.uk/python/mock/)来做到这一点？

真正让我感到困惑的是，如果我模拟该`query()`方法，我该如何更改依赖于传递给的类的所有方法的输出`query()`？

我希望我可以按照以下方式做一些事情：

```
def test_init_numbers():
    import
    my_mock_object = MagicMock()
    with patch('some.module.Session.query', my_mock_object):
        result = example.init_system()
        assert result == ['expected', 'result'] 
```

但是，我不知道我需要做什么才能`my_mock_object`使其`query()`正确模仿。我想它需要实现`all()`返回迭代器的方法。而且，我知道我可以在返回的迭代器中创建更多的模拟对象，确保它们具有适当属性的值，例如：

```
var_one_element_mock = MagicMock(spec=SQLAModelA)
var_one_element_mock.attr_A_a = 12

var_two_element_mock = MagicMock(spec=SQLAModelB)
var_one_element_mock.attr_B = 100 
```

而且，当然，我可以创建`MagicMock`可以由 init_system 函数使用的那些对象的不同版本的迭代，例如，`for value in var_one`在行中。

但我不知道如何将所有模拟对象拼凑在一起，所以我可以模拟出该`Session.query`方法，同时考虑到一个类已传递给它，这会影响它返回的可迭代对象的内容。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T03:19:17.140

我不知道您是否还需要帮助，但是如果您想控制调用 MagicMock 对象时发生的情况，您可以传递一个函数作为其 side_effect 参数。像这样的东西应该工作。

```
def test_init_numbers():
    import
    my_mock_object = MagicMock()
    def return_iterator():
      ## create and return your iterator here

    my_mock_object.all = MagicMock(side_effect=return_iterator)
    with patch('some.module.Session.query', my_mock_object):
        result = example.init_system()
        assert result == ['expected', 'result'] 
```

# fortran - 如何为扩展抽象类型的派生类型重载运算符？

> ID：10032693
> 
> 赞同：3
> 
> 时间：2012-04-05T16:49:29.690
> 
> 标签：fortran, fortran2003

我从 Metcalf 等人的“Fortran 95/2003 解释”中举了一个例子，因为我自己的代码针对的是同一件事。

```
type, abstract :: my_numeric_type
contains
    private
    procedure(op2), deferred :: add
    generic, public :: operator(+) => add
end type

abstract interface
    function op2(a,b) result (r)
        import :: my_numeric_type
        class(my_numeric type), intent(in) :: a,b
        class(my_numeric type), allocatable :: r
    end function op2
end interface

type, extends(my_numeric_type) :: my_integer
    integer, private :: value
contains
    procedure :: add => add_my_integer
end type 
```

现在，我的问题是如何正确实现该`add_my_integer`功能。似乎我不得不强制转换第一个参数，`my_integer`因为它是一个类型绑定过程，但第二个参数`my_numeric_type`必须符合抽象接口。至于结果，我应该分配`r`给`my_integer`吗？到目前为止，这是我想出的，它确实可以编译，但是一直检查类型似乎很奇怪，并且会导致分段错误（尽管可能是由于我的代码存在其他问题）。

```
function add_my_integer(a,b) result(r)
    class(my_integer), intent(in) :: a
    class(my_numeric_type), intent(in) :: b
    class(my_numeric_type), allocatable :: r

    allocate(my_integer :: r)
    select type (b)
        type is (my_integer)
            r = a+b
    end select
end function 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T21:46:00.777

这对我有用，但看起来很复杂（太多`select type`）。我公开了这个值只是为了方便输出，否则你需要一个自定义的 getter 和 setter。

```
module num

  type, abstract :: my_numeric_type
  contains
      private
      procedure(op2), deferred :: add
      generic, public :: operator(+) => add
      procedure(op), deferred :: ass
      generic, public :: assignment(=) => ass
  end type

  abstract interface
      subroutine op(a,b)
          import :: my_numeric_type
          class(my_numeric_type), intent(out) :: a
          class(my_numeric_type), intent(in) :: b
      end subroutine op
      function op2(a,b) result (r)
          import :: my_numeric_type
          class(my_numeric_type), intent(in) :: a,b
          class(my_numeric_type), allocatable :: r
      end function op2

  end interface

  type, extends(my_numeric_type) :: my_integer
      integer, public :: value
  contains
      procedure :: add => add_my_integer
      procedure :: ass => ass_my_integer
  end type

  contains

    function add_my_integer(a,b) result(r)
        class(my_integer), intent(in) :: a
        class(my_numeric_type), intent(in) :: b
        class(my_numeric_type), allocatable :: r

        select type (b)
            type is (my_integer)
                allocate(my_integer :: r)
                select type (r)
                  type is (my_integer)
                    r%value = a%value+b%value
                end select
        end select
    end function

    subroutine ass_my_integer(a,b)
        class(my_integer), intent(out) :: a
        class(my_numeric_type), intent(in) :: b

        select type (b)
            type is (my_integer)
                    a%value = b%value
        end select
    end subroutine

end module

program main
  use num

  class(my_integer), allocatable :: a, b, c
  allocate(my_integer :: a)
  allocate(my_integer :: b)
  allocate(my_integer :: c)
  a=my_integer(1)
  b=my_integer(2)
  c = a+b
  write (*,*) c%value
end program 
```

# javascript - iframe v/s ex ternal js（在其他网站上显示我网站的内容）

> ID：10032696
> 
> 赞同：0
> 
> 时间：2012-04-05T16:49:42.440
> 
> 标签：javascript, jquery, iframe

在我的项目中，

我创建了一个可以复制然后放入任何网站的代码片段。它在其他网站上显示我的内容。

我现在使用的是：

```
<script type='text/javascript'>
var user = 'abc';
var age = '23';

document.write('<iframe src="http://www.mysite.com/page.php?user='+ user + '&age=' + age + '" ></iframe');
</script> 
```

在 page.php 中，

我根据并显示动态内容进行了一些`user`处理`age`。

我的方法效果很好。

但是当我研究一些很好的标准方法来完成这些任务时，我发现了一种不同的方法。

以 google adsense 代码为例。

```
<script type='text/javascript'>
 var a = 'somedata';
 var b = 'someotherdata';
</script>

<script type='text/javascript' src='http://www.google.com/adsenseurl.js'></script> 
```

我猜，因为`a`和`b`是全球性的；adsenseurl.js 必须使用它，并且可能最终他们在 iframe 上显示它。

**所以，现在的问题。**

使用谷歌的方法有什么好处，我的方法有什么问题？

ps 我知道我应该尽量避免使用 iframe，但我没有看到任何其他方法来实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-06T05:25:33.093

在我看来，您的方法和 adSense 之间的主要区别在于，您的代码必须放置在广告必须出现的位置并加载像 adsense 这样的脚本，他们可以在检查页面后将 iframe 放置在 DOM 中 - 使用

```
var myIframe = document.createElement('iframe');
.
.
someDOMObject.appendChild(myIframe); 
```

和/或操纵 zindex 以将 iframe 浮动到页面上方

最后，iFrame 很有用（不管你可能听到“哦，不——iframe 是邪恶的”），因为你可以使用任何你喜欢的 css 和 jquery。如果您所在的页面已经有样式的 div 和旧版本的 jQuery，您将需要做更多的工作才能使其看起来像您想要的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:03:30.613

为什么要使用 iframe？如果您的用户加载`<script src='yoursite.com/something.js'></script>`了 DOM，您可以立即访问他的 DOM，并且可以通过它做任何您想做的事情`something.js`。与从某个 CDN 加载 jQuery 的方式相同 - 它可以立即用于修改 DOM。

否则真的没有区别，除了：

1.  他没有嵌入用户必须维护的大量代码，而是提供必要的变量并简单地链接到页面上的脚本。
2.  您可以更新服务器上的 js 代码，并确保您的*所有*用户都立即（减去缓存）与新功能保持同步。

可能还有其他优势，但我相信这两个就足够了。

# python - 使用 MongoDB 作为持久性哈希表

> ID：10032698
> 
> 赞同：1
> 
> 时间：2012-04-05T16:49:53.760
> 
> 标签：python, mongodb, hashmap

注意：如果这是一个愚蠢的问题，我很抱歉！

我有这个程序可以生成存储在 python 字典中的数据。

由于这越来越大，并且由于这不是持久的，并且程序必须重新创建它们，每次运行时......

我尝试使用 mongodb，但它似乎需要键和值来搜索（查找函数）。但我只有钥匙，我需要价值。

这是怎么做到的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:37:28.387

将每个字典条目（键、值对）作为单独的文档存储在 mongo 中`{key: "keyval", value: "valueval"}`，并仅提供 find 函数的键：

```
mydocs.find({'key': something}, fields=['value']) 
```

如果集合很大，则需要在以下位置添加索引`key`：

```
mydocs.ensure_index('key') 
```

# objective-c - presentModalViewController：差异

> ID：10032700
> 
> 赞同：0
> 
> 时间：2012-04-05T16:49:59.110
> 
> 标签：objective-c, uiviewcontroller, uinavigationcontroller, presentmodalviewcontroller

有什么区别：

```
[self.navigationController presentModalViewController:nav animated:YES]; 
```

和

```
[self presentModalViewController:nav animated:YES]; 
```

其中 self 是 UIViewController 的子类。

除此之外，我如何消除模态视图是否重要？例子：

```
[self dismissModalViewControllerAnimated:YES]; 
```

或者

```
[self.navigationController dismissModalViewControllerAnimated:YES]; 
```

如果 modalView 由 呈现`self.navigationController`，如果调用它会被关闭`self`，反之亦然？

我知道苹果建议在实际实现中使用协议和委托，但我只是想找出“幕后”的行为是否相同。

我一直在四处寻找答案，但我还没有找到任何东西，所以如果这是重复的，我会事先道歉。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T16:53:52.423

你是从哪一门课上来的（即是什么`self`）。如果您是从视图控制器调用它，那么区别在于您的视图控制器正在呈现`modalviewcontroller`而不是视图控制器`navigationcontroller`呈现模态视图

如果您使用`self.navigationcontroller`，您可以与`self.navigationitem`视图控制器没有的交互。

编辑：

是的，它使您能够将其他内容推`ViewControllers`送到`self.navigationController.ViewControllers`数组上，然后使用`navigationBar`从 ViewController 移动到 ViewController。

作为一个例子，你可以做`[self.navigationController presentModalViewController:nav animated:YES];`，然后如果用户点击一个按钮，你可以推送一个 ViewController`[self.navigationController pushViewController:vc animated:YES];` 然后一个新的 View Controller/View 将出现在 ModalView 内。当您关闭 ModalViewController 时，您仍然会被传送回原来的视图控制器。

要回答您的第二个问题：您应该以与您呈现它的方式相同的方式关闭模式视图。所以如果你使用 self.navigationController 来呈现，使用 self.navigationController 来关闭。

# android - 其他包中的复合控制

> ID：10032702
> 
> 赞同：0
> 
> 时间：2012-04-05T16:50:07.473
> 
> 标签：android, namespaces, custom-controls, packages

我添加了一个简单的复合控件，它从 XML 布局加载其布局并实现自己的 XML 属性。

但这仅在此控件位于主包 ( `com.myapp`) 中时才有效。当我尝试将它移动到一个子包中时，`com.myapp.controls`事情就开始失败了。

这是定义控件自定义属性的 attrs.xml：

```
<resources>

    <declare-styleable name="CH2">
        <attr name="textText" format="string" />
    </declare-styleable>

    <declare-styleable name="CH3">
        <attr name="textFex" format="string" />
    </declare-styleable>

</resources> 
```

这是控制 CH2.java，它在 subspackage 中并且**不起作用**：

```
package com.myapp.controls;

import android.content.Context;
import android.content.res.TypedArray;
import android.util.AttributeSet;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.LinearLayout;
import android.widget.TextView;

public class CH2 extends LinearLayout {

    private TextView textView;

    public CH2(Context context) throws Exception {
        super(context);
        init(context, null);
    }

    public CH2(Context context, AttributeSet attrs) throws Exception {
        super(context, attrs);
        init(context, attrs);
    }

    private void init(Context context, AttributeSet attrs) throws Exception {

        this.setOrientation(LinearLayout.VERTICAL);

        LayoutInflater layoutInflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        layoutInflater.inflate(com.myapp.R.layout.category_header, this, true);

        View v = findViewById(com.myapp.R.id.chText);
        this.textView = (TextView)v;

        if (attrs != null) {
            TypedArray a = getContext().obtainStyledAttributes(attrs, com.myapp.R.styleable.CH2);

            String text = a.getString(com.myapp.R.styleable.CH2_textText);
            this.textView.setText(text != null ? text : "<NULL!>");

            a.recycle();        
        }
    }
} 
```

这是 CH3.java 有效：

```
package com.myapp;

import android.content.Context;
import android.content.res.TypedArray;
import android.util.AttributeSet;
import android.view.LayoutInflater;
import android.view.View;
import android.widget.LinearLayout;
import android.widget.TextView;

public class CH3 extends LinearLayout {

    private TextView textView;

    public CH3(Context context) throws Exception {
        super(context);
        init(context, null);
    }

    public CH3(Context context, AttributeSet attrs) throws Exception {
        super(context, attrs);
        init(context, attrs);
    }

    private void init(Context context, AttributeSet attrs) throws Exception {

        this.setOrientation(LinearLayout.VERTICAL);

        LayoutInflater layoutInflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        layoutInflater.inflate(com.myapp.R.layout.category_header, this, true);

        View v = findViewById(com.myapp.R.id.chText);
        this.textView = (TextView)v;

        if (attrs != null) {
            TypedArray a = getContext().obtainStyledAttributes(attrs, com.myapp.R.styleable.CH3);

            String text = a.getString(com.myapp.R.styleable.CH3_textFex);
            this.textView.setText(text != null ? text : "<NULL!>");

            a.recycle();        
        }
    }
} 
```

两个源都使用相同的 category_header.xml。布局加载没有问题。我可以像这样使用两者：

```
<com.myapp.controls.CH2
    android:id="@+id/cH1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >
    myns:textText="Test 1" >
</com.myapp.controls.CH2>

<com.myapp.CH3
    android:id="@+id/cH2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" 
    myns:textFex="Test 2"
    >
</com.myapp.CH3> 
```

如何使 CH2 工作？或者是不可能使用另一个包？

Sidequest：我可以让两个控件使用相同的 XML 属性`textText`，还是它们总是必须使用不同的属性？或者可声明样式的名称可以与组件名称不同吗？

* * *

另一种具有新声明样式的方法：

```
<declare-styleable name="controls.CH2">
    <attr name="textText" format="string" />
</declare-styleable> 
```

但它似乎不可用。XML 视图总是说*Unexpected text found in layout file:*，不管我如何使用 CH2：

```
xmlns:myns="http://schemas.android.com/apk/res/com.myapp"
xmlns:mynsc="http://schemas.android.com/apk/res/com.myapp.controls"
...
<com.myapp.controls.CH2
    android:id="@+id/cH1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >
    mynsc:textText="TestTestTest" 
    >        
</com.myapp.controls.CH2> 
```

或者

```
xmlns:myns="http://schemas.android.com/apk/res/com.myapp"
...
<com.myapp.controls.CH2
    android:id="@+id/cH1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >
    myns.controls:textText="TestTestTest" 
    >        
</com.myapp.controls.CH2> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:01:19.570

我刚刚回到我自己的属性文件，并且没有任何地方引用我的布局所在的非常深的子包...作为旁注，如果您在 attrs 文件中执行此操作，您可以让多个元素使用相同的属性：

```
<resources>
    <attr name="textText" format="string"/>

    <declare-styleable name="CH2">
        <attr name="textText" />
    </declare-styleable>

    <declare-styleable name="CH3">
        <attr name="textText" />
    </declare-styleable>

</resources> 
```

我对 android 源代码的研究显示了一些示例，它们完全按照您的描述进行操作，它们有一个自定义属性文件指向不同包中的视图类。我看到的唯一明显区别是视图是在布局中声明的，如下所示：

```
<view
  class="com.myapp.controls.CH2"
  android:id="@+id/cH1"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content" >
  myns:textText="Test 1" >
</view>

<view
  class="com.myapp.CH3"
  android:id="@+id/cH2"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content" 
  myns:textFex="Test 2"
>
</view> 
```

老实说，我无法告诉您为什么会有所作为……但是每次他们需要自定义属性时，使用的格式

# netbeans - Netbeans 缺少文件类型 | 类别 | 其他

> ID：10032713
> 
> 赞同：0
> 
> 时间：2012-04-05T16:50:59.250
> 
> 标签：netbeans, netbeans-7

不知道这里发生了什么，似乎找不到任何解释如何解决它的文献。

前几天我真的启动了netbeans，并尝试创建一个新文件夹，但我错过了“其他”类别。尝试卸载和重新安装（在 OSX 上），甚至升级（以前是 7.0.1，现在是 7.1.1）。这让我相信这是某个地方的偏好或设置。. .

有没有人见过这个？

![有人见过这个吗？？](../Images/96e8c36360c5dc74eb72dd26d8c9f20e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T23:05:25.790

我有同样的问题。我试图从存档中拖放文件。我不知道它是怎么回事，但是出现了“其他”文件夹中的模板而不是我的文件。也许这是一个错误。我没有得到当时发生的事情并删除了所有这些文件。也许你的情况也发生了类似的事情。

因此，您需要在模板管理器中手动添加模板（工具 -> 模板）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T23:12:35.307

我通过从“工具”菜单中选择“模板”来修复它，然后添加一个新文件夹并将其命名为“其他”。当我这样做时，文件夹立即填满了原始“其他”文件夹中的所有项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T16:46:40.323

我曾尝试在模板管理器中添加模板，但这并没有解决我的问题。我最终从我的系统中删除了所有 Netbeans v7.1 并升级到 v7.2。

# dynamics-crm-2011 - Activity Feeds “Leads I follow”视图打破了 CRM 2011 解决方案导入

> ID：10032715
> 
> 赞同：1
> 
> 时间：2012-04-05T16:51:03.027
> 
> 标签：dynamics-crm-2011

我正在将托管解决方案从开发环境导出到另一个干净的环境中。但是，由于与“正在关注的联系人”、“我关注的联系人”、“正在关注的潜在客户”和“我关注的潜在客户”视图的依赖项冲突，解决方案不会导入。根据我修改解决方案的方式，错误的范围可能从

“计算依赖性时出错：ID 为已保存查询时出错...”

到

“托管解决方案无法覆盖具有非托管基本实例的 Id=3a282da1-5d90-e011-95ae-00155d9cfa03 的 SavedQuery 组件。此错误的最可能情况是非托管解决方案已在目标上安装了新的非托管 SavedQuery 组件系统，现在来自同一发布者的托管解决方案正在尝试安装与托管相同的 SavedQuery 组件。这将导致目标系统上的解决方案分层无效，并且是不允许的。”

但无论哪种情况，罪魁祸首都是与活动提要相关的观点之一。Lead 和 Contact 以及 Campaign Activity 是此解决方案中唯一的现成实体。如何摆脱这种依赖？

源组织是本地安装，因此活动源是通过市场下载手动部署的。我尝试将托管解决方案导出导入在线和本地组织。

如果我从导出生成的自定义.xml 文件中删除上面的 4 个视图，我就可以成功导入解决方案。这些视图在导入后仍然在目标系统中，或者当然，因为它们是活动源附带的系统视图。但我不喜欢这是真正的解决方案，因为我知道不支持直接在解决方案导出中修改 XML。

当我从非托管解决方案的导出的自定义 .xml 文件中删除视图并将该解决方案导入新的组织时，我发现了一个临时修复。然后，我将该解决方案（称为解决方案 2）导出为非托管解决方案，并在我最初构建解决方案的环境中删除了原始非托管解决方案。然后我再次将解决方案 2 导入到原始环境中。当我导出此解决方案时，我可以将其导入其他组织。但是当我们更新了 dev org 中的一些组件并尝试导出到 test 时，错误又回来了。

有谁知道发生了什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T15:25:40.300

被定向到这里的答案：

[http://blogs.msdn.com/b/crm/archive/2012/01/26/activity-feeds-solution-amp-development-environment.aspx](http://blogs.msdn.com/b/crm/archive/2012/01/26/activity-feeds-solution-amp-development-environment.aspx)

显然，在开发环境中，您需要不配置 Activity Feeds。我在自己的环境中遇到“uconfiguring”错误，但认为这绝对是我上面提出的问题的答案。

# svm - 在 libsvm 中使用 svmpredict

> ID：10032716
> 
> 赞同：1
> 
> 时间：2012-04-05T16:51:08.620
> 
> 标签：svm, libsvm

我一直在使用 lib-svm 二进制文件对我的数据进行分类。

对于培训，我使用以下命令

> `svm-train.exe -s 0 -t 2 -c 0.03125 -g 0.25 file.train file.train.model'

并得到以下结果

```
optimization finished, #iter = 10
nu = 1.000000
obj = -0.625000, rho = -0.000000
nSV = 20, nBSV = 20
Total nSV = 20 
```

现在，由于我在训练集中使用 rbf 内核，我不必将其包含在测试数据中吗？

> `svm-predict.exe -s 0 -t 2 -c 0.03125 -g 0.25 file.test file.train.model file.out'

我明白了

```
Unknown option: -s 
```

使用不带任何参数的上述命令可以正常工作....

但我想知道 libsvm 是否自动使用 rbf 内核进行测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:13:21.173

libsvm 将所有必要的信息存储在从训练创建的模型文件中，因此您不需要包含这些参数，它会知道要使用的内核和参数。您只需要提供模型文件和测试数据。

# django - Django 中的 CakePHP 数据源

> ID：10032720
> 
> 赞同：1
> 
> 时间：2012-04-05T16:51:28.610
> 
> 标签：django, api, cakephp, resources, datasource

我一直在几个应用程序中使用 CakePHP，现在我正在用 Django 构建我的第一个应用程序。

在 CakePHP 中，[数据源](http://book.cakephp.org/2.0/en/models/datasources.html)是模型和数据源之间的链接。它可能依赖于 ORM，也可能从 API 等外部来源访问数据。

我试图弄清楚如何在 Django 中为非 ORM 数据源（默认为模型）执行相同的操作，以便使用外部 API。

如果您能以正确的方式指出我，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:42:48.677

这个概念在 django 和 cake 之间不匹配。在 django 中，模型明确地是映射到数据库的 ORM。尽管我认为您可以编写一个违反该规则的自定义后端，但这似乎很痛苦。

但是，有很多使用非传统数据库源的示例，例如在 django 中使用 mongo 文档。如果您对 python 有深入的了解，那么设计一个基类来处理将 API 包装到对象实例中所需的所有细节会相对容易。但这不会是 django 中开箱即用的东西。可能有提供该功能的第三方应用程序，但我不知道有一个在我脑海中。自己做不会比在 cake 中做的方式复杂得多，IE in cake 一个非数据库数据源需要代码来发出请求并解析响应，因此它不仅神奇地知道如何处理任何 API。

如果您不想写完所有调用 api 的行为并构造一个模型样式类以包含所有这些逻辑，那么在 django 中处理它的正常方法就是使用 urllib2（如果这是一个远程 api 源）并解析请求的结果。

# android - 内容提供者和 sqlite：sqlite 错误代码=1 msg=列不存在

> ID：10032726
> 
> 赞同：-1
> 
> 时间：2012-04-05T16:52:01.070
> 
> 标签：android, android-contentprovider

```
 db.execSQL("CREATE TABLE " + NotePad.Notes.TABLE_NAME + " ("
               + NotePad.Notes._ID + " INTEGER PRIMARY KEY,"
               + NotePad.Notes.COLUMN_NAME_TITLE + " TEXT,"
               + NotePad.Notes.COLUMN_NAME_NOTE + " TEXT,"

               + ");"); 
```

伙计们，我有以下问题。04-05 16:40:09.773: I/SqliteDatabaseCpp(1135): sqlite 返回: 错误代码 = 1, msg = 没有这样的列: provider_value, db=/data/data/com.example.helloandroid/databases/note_pad.db

这里，COLUMN_NAME_NOTE 的值为 provider_value。它仍然说该列不存在。请让我知道问题可能是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T16:57:02.957

尝试删除最后一个逗号`" TEXT,"`

# ruby-on-rails-3 - 如何仅为 HAML 和 Rails 3 的 date_select 设置年份和月份？

> ID：10032731
> 
> 赞同：0
> 
> 时间：2012-04-05T16:52:23.273
> 
> 标签：ruby-on-rails-3, forms, date, select, helper

我尝试`date_select`在我的 HAML 模板中设置仅显示年份和月份：

```
= date_select(:birthday, :order => [:day, :month, :year],:start_year => 1940) 
```

我希望这段代码显示选择框，排序为：**日**、**月**、**年**和从 1940 年开始的年。事实并非如此。

选择框显示为：CURRENT YEAR、CURRENT MONTH 和 CURRENT DAY。

如何仅显示年份和月份的选择框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:00:40.740

你应该看看这个：[http ://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-date_select](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-date_select)

`date_select(object_name, method, options = {}, html_options = {})`

应该有方法作为第二个参数，然后是选项。我还在文档中找到了选项：discard_day，它不显示当天的选择。

# c# - 在同步融合网格控件中添加 numericup down

> ID：10032734
> 
> 赞同：0
> 
> 时间：2012-04-05T16:52:45.153
> 
> 标签：c#, visual-studio-2010, numericupdown, gridcontrol, syncfusion

Reg windows forms syncfusion, grid control 我正在尝试添加一个弹出框，就像我们在 xcel 中的弹出框一样。在右键单击单元格然后插入时，会出现一个小弹出框，询问需要插入多少行。

所以这就是我所做的

```
private void InsertRowToolStripMenuItem_Click(object sender, EventArgs e)
        {
           GridRangeInfoList list;

            list  = theGrid.Selections.GetSelectedRows(true, false);
            int rowNumber = list.ActiveRange.Top;
            Panel box = new Panel(); //
            NumericUpDown ud1 = new NumericUpDown(); 

            ud1.Dock = DockStyle.Left;  ud1.Width = 30; 
            ud1.BorderStyle = BorderStyle.FixedSingle;
            box.Controls.Add(ud1); 
            box.BorderStyle = BorderStyle.None;
            Button btn = new Button();
            btn.Dock = DockStyle.Bottom;
            btn.Text = "OK";
            box.Controls.Add(btn);

            this.Controls.AddRange(new System.Windows.Forms.Control[] { box }); 
            btn.Click += new EventHandler(btn_Click);
            theGrid.Controls.Add(box);
            box.Dock = DockStyle.Bottom;
            box.Show();
            numberOfRowstobeInserted = (int)ud1.Value;
            this.Controls.Add(box); 
            theData.CreateRowsToInsert(rowNumber, numberOfRowstobeInserted);

            theGrid.Refresh();
} 
```

但是这种添加带有数字上下的面板的方式似乎不起作用。基本上，一旦单击插入，我想要一个带有数字上下和按钮的小窗口/面板。用户从上/下选择一个值，然后单击确定按钮。

有什么建议么？

谢谢孙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T11:05:30.103

您可以处理以下修改后的代码以使其正常工作。

```
 private Panel box;
    private NumericUpDown ud1;
    private Button btn;        
    int rowNumber, rowIndex, colIndex;
    GridStyleInfo style;

    void ContextMenuStrip_ItemClicked(object sender, ToolStripItemClickedEventArgs e)
    {
        rowNumber = this.gridGroupingControl1.Table.CurrentRecord.GetSourceIndex();
        rowIndex = this.gridGroupingControl1.TableControl.CurrentCell.RowIndex;
        colIndex = this.gridGroupingControl1.TableControl.CurrentCell.ColIndex;
        style = this.gridGroupingControl1.TableControl.GetViewStyleInfo(rowIndex,colIndex);
        box = new Panel(); // 
        ud1 = new NumericUpDown();

        ud1.Location = new Point(15, 15);
        ud1.Size = new Size(50, 10);
        ud1.BorderStyle = BorderStyle.FixedSingle;
        box.Controls.Add(ud1);
        box.BorderStyle = BorderStyle.None;

        btn = new Button();
        btn.Location = new Point(30, 50);
        btn.Size = new Size(30,20);
        btn.Text = "OK";
        btn.Click += new EventHandler(btn_Click);
        box.Controls.Add(btn);

        box.Location = this.gridGroupingControl1.TableControl.CurrentCell.Renderer.GetCellLayout(rowIndex, colIndex, style).ClientRectangle.Location;
        box.Size = new Size(80, 70);

        this.gridGroupingControl1.Controls.Add(box);
        box.Show();
        box.BringToFront();
    }

    void btn_Click(object sender, EventArgs e)
    {
        int numberOfRowstobeInserted = (int)ud1.Value;
        DataTable dt = (this.gridGroupingControl1.DataSource as DataView).Table;
        for (int count = 0; count < numberOfRowstobeInserted; count++)
        {
            DataRow dr = dt.NewRow();
            for (int i = 0; i < dt.Columns.Count; i++)
                dr[i] = 0; //default value
            dt.Rows.InsertAt(dr, rowNumber++);
        }
        box.Dispose();
    } 
```

# c# - Thread.Join(int) 在 C# 中指定超时后不杀死线程

> ID：10032736
> 
> 赞同：4
> 
> 时间：2012-04-05T16:52:48.150
> 
> 标签：c#, multithreading, winforms

在我的 Windows 窗体应用程序中，我正在尝试测试用户访问远程计算机共享文件夹的能力。我这样做的方式（我确信有更好的方法......但我不知道它们）是检查远程机器上是否存在特定目录（我正在这样做由于我在组织中遇到的防火墙/其他安全限制）。如果用户有权访问共享文件夹，那么它会立即返回，但如果他们没有，它就会永远挂起。为了解决这个问题，我将检查放入另一个线程并仅等待 1000 毫秒，然后确定用户无法点击该共享。但是，当我这样做时，它仍然挂起，就好像它从未在同一个线程中运行一样。

**是什么让它挂起，我该如何解决？**我认为它在一个单独的线程中的事实将允许我让线程在后台自行完成。

这是我的代码：

```
bool canHitPath = false;
Thread thread = new Thread(new ThreadStart(() =>
{
    canHitPath = Directory.Exists(compInfo.Path);
}));
thread.Start();
thread.Join(1000);

if (canHitPath == false)
{
    throw new Exception("Cannot hit folder: " + compInfo.Path);
} 
```

**编辑：**我觉得我应该添加抛出异常的行**IS HIT**。我已经对此进行了调试并对其进行了验证……但是，当引发异常时，就是我的程序挂起的时候。（我还可以补充一点，异常是在调用方法中捕获的，而我永远不会在调试器中使用 catch 语句。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:55:10.483

您的评论清楚地表明异常实际上是被抛出和捕获的。所以代码执行至少超过了这段代码，我们无法从代码片段中看出它在做什么。

您确实犯了一个错误，您忘记将线程的 IsBackground 属性设置为 true。没有它，程序就无法终止。这是您可能得出结论“它正在阻塞！”的一种方式。如果这个猜测不准确，那么我们需要查看主线程的调用堆栈以了解它在做什么。最好通过打开非托管调试支持并启用 Microsoft 符号服务器来捕获，这样我们就可以看到整个调用堆栈，而不仅仅是它的托管部分。

一种完全不同的方法是使用 Ping 类来探测服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T15:04:56.740

I found the real problem:

The property compInfo.Path is doing a check for a directory existence on the remote file system to determine if the remote machine is 64 bit or not. Depending on the results, it returns a different value. I tried commenting out the the check and it executed successfully. This explains why I couldn't get past the throwing of the exception, I call compInfo.Path in the message of the exception.

However, I think we learned a lot from "the real problem":

1.  The code I posted in the question (as is) works perfectly fine.
2.  **thread.Join(int) will exit after the specified time interval regardless of the fact that the thread may still be executing code.**
3.  **The thread being joined CAN be running an IO operation (thus tying up a file/directory) and the desired result will still come about when doing a thread.Join(int).**
4.  Using the "step into" button on a debugger will reveal many things...even about your own "solid" code. :)

Thanks everyone for your help, patience, and thoughtful input/insights.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T17:02:43.063

我的猜测是会发生这种情况，因为当你打电话时：

```
canHitInstallPath = Directory.Exists(compInfo.InstallPath); 
```

该`Exists`方法保存了tread的执行流程（它是一个不间断的调用）。如果它挂起 30 秒，他们你的线程将等待 30 秒，直到它有机会检查是否`Thread.Join(1000)`已经过去。

> 请注意，Thread.Join() 方法只会阻塞调用线程（通常是应用程序的主执行线程），直到您的线程对象完成。在等待特定线程完成执行时，您仍然可以让其他线程在后台执行。

从：

[Thread.Join 方法（System.Threading）](http://msdn.microsoft.com/en-us/library/system.threading.thread.join.aspx)

要考虑的另一件事：仅检查文件夹是否存在并不能说明用户是否可以读取或将文件写入文件夹。您最好的选择是尝试写入或读取文件夹的文件。这样，您可以确保用户在该文件夹中具有权限。

**编辑**

在您的情况下，只有在等待线程完成时您可以做其他事情时，线程才有意义。如果你不能，他们的线程根本没有帮助你。

**编辑2**

支持我的答案的链接：[文件描述符和多线程程序](http://drdobbs.com/parallel/212001285)

**编辑3**

你最好的选择是创建一个杀手线程。`DirectoryExists`当该线程挂起超过 X 秒时，该线程将终止该线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T17:03:01.443

`Thread.Join`是一个阻塞调用，它将阻止调用它的线程**，**直到它被调用的线程**退出**。

 **你基本上是在启动一个新线程来做后台工作，然后告诉主线程等到它完成。实际上，这一切都是同步进行的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T17:02:07.790

也许看看[Task Parallel Library](http://msdn.microsoft.com/en-us/library/dd460717.aspx)。TPL 旨在最大限度地提高性能，并且可以处理任何问题。尽管对于这种情况，这也可能完全是矫枉过正。**

# html - CSS/ HTML 使用网站和网站 's as / 就像一个滚动条

> ID：10032737
> 
> 赞同：-2
> 
> 时间：2012-04-05T16:52:51.083
> 
> 标签：html, css, drag, horizontal-scrolling

我现在正在写我的网站，试图保持更保守，但使用更新的设计。我为我的网站选择的设计是类似于 Windows (R)“Metro”的设计，如我的另一个问题 ( [Question](https://stackoverflow.com/questions/10017893/css-make-a-hovered-over-div-grow) )中所述

我已经让它看起来有点像地铁，不是使用垂直滚动条而是水平滚动条。 **现在我正在尝试添加用户可以单击任何内容的选项，并且在单击并按住时，用户应该能够“拖动”网站（就像我可以“拖动”iPhone的页面一样），**

**或者当距离网站“边缘”10像素左右时，鼠标悬停时，网站应该自行“拖动”。**

我提前感谢你，这是我目前状态的网站：[我使用 Chrome 显示我的网站，因为它显示了我想要的 css](http://maxwf.net16.net/index/index.html)

或者这里是我的意思的快速截图：![左右是边缘，如您所见，<code><div></code> 未满，但通过拖动将其切断，我的意思是滚动它们直到它们作为一个整体显示。](../Images/011e62fa9c2425531e6af02e793c2231.png)

如您所见，左右边缘是边缘，`<div>`并不饱满，但通过拖动，我的意思是滚动它们，直到它们整体显示为止。

最大WF

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:05:22.007

一件重要的事情是不要违背惯例。在移动设备上，用户习惯于能够拖动页面。但是在台式计算机上，单击并拖动鼠标要么用于选择文本，要么用于拖动内容（例如，将图像从网页拖动到另一个应用程序）。在台式计算机上滚动通常使用滚轮或键盘完成。当网站没有像他们期望的那样做出反应时，访问者可能会变得非常烦躁......

话虽如此，您可以使用像[Dragscrollable](http://archive.plugins.jquery.com/project/Dragscrollable)这样的 jQuery 插件来实现此效果。

对于边缘附近的滚动，您可以使用 jQuery 插件[Smoothdivscroll](http://www.smoothdivscroll.com/options.html)的 Hotspot 选项。

我对这些插件没有任何经验。

# html - Twitter Bootstrap - 全宽背景（图片）

> ID：10032742
> 
> 赞同：11
> 
> 时间：2012-04-05T16:53:08.277
> 
> 标签：html, css, background, twitter-bootstrap

我目前正在进行一个项目，我正在尝试很棒的 Twitter Bootrtrap，包括响应式网格。除了一个问题外，一切都很好。

你如何给`.container`（保持网格的）背景颜色？例子：

```
<div class="container green">
    <div class="row">
        <div class="span6">
            <p>This is a test</p>
        </div>
    </div>
    <div class="row">
        <div class="span6">
            <p>This is a test</p>
        </div>
    </div>
</div>

.green{
 background:green;
} 
```

当我向容器添加颜色时，它会变成绿色，但在左侧留下一个边距，大约 20 像素。如何实现全角背景？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-05T19:22:48.163

您看到的那个边距是由于`.row`网格系统的类部分从左侧移除了 20px 以容纳`span`每行内的类；该类内容如下：

```
.row {
    margin-left: -20px;
} 
```

`.container`您可以通过使用另一个具有您选择的背景颜色的容器包装您的 div 来规避这种情况，如下所示：

**HTML**

```
<div class="green">
    <div class="container">
        <div class="row">
            <div class="span6">
                <p>This is a test</p>
            </div>
        </div>
        <div class="row">
            <div class="span6">
                <p>This is a test</p>
            </div>
        </div>
    </div>
</div> 
```

**CSS**

```
.green{
    background:green;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T16:57:38.933

尝试

```
body {
    background-color: green;
}

.container {
    background-color: transparent;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-01T04:33:47.437

试试这个，它对我有用，像这样包装你的代码。

```
<div class="rowWrp">
    <div class="row colorBg">
        <div class="span6">
            <p>This is a test</p>
        </div>
    </div>
</div> 
```

CSS它：

```
.colorBg {
   background:red;
  }

.rowWrp {
  background:red; 
  width:940px; 
  padding-right:20px;
  } 
```

这里我假设我们使用固定布局。

# java - 使用 XMLUnit 验证 XML 元素的顺序

> ID：10032748
> 
> 赞同：2
> 
> 时间：2012-04-05T16:53:27.220
> 
> 标签：java, xml, xml-validation, xmlunit

我需要使用 XMLUnit 框架针对 XSD 验证输出 xml 的顺序。我是 XMLUnit 的新手，不知道该怎么做。我知道 XMLUnit 比较两个 XML，但是如何比较 XML 和 XSD？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T20:30:29.983

`javax.xml.validation`您可以使用Java SE 5 及更高版本中可用的 API，而不是在这方面使用 XMLUnit ：

```
SchemaFactory sf = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
Schema schema = sf.newSchema(new File("customer.xsd"));

Validator validator = schema.newValidator();
validator.setErrorHandler(new MyErrorHandler());
validator.validate(source); 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/11/validate-jaxb-object-model-with-xml.html](http://blog.bdoughan.com/2010/11/validate-jaxb-object-model-with-xml.html)

# sql - SQL Server 中用于寻址表的正确语法是什么？

> ID：10032751
> 
> 赞同：7
> 
> 时间：2012-04-05T16:53:31.310
> 
> 标签：sql, sql-server, stored-procedures

这似乎是一个相当明显的问题，但我无法为我要问的问题想出合适的术语，因此为此提供参考材料一直很棘手。不过，答案似乎很明显。

在检查 SQL Server 的 Pluralsight 培训材料时，他们建议始终在“常规”查询（您可能为基本 Web 服务编写的东西）和存储过程中的 SQL 查询中引用表，如下所示：

```
[databasename].[dbo].[some_table].[sometimesacolumngoeshere] 
```

虽然我发现遇到存储过程等很常见，但只需使用：

```
my_column    or    [my_column] 
```

这里的区别显然是一个显式地提供了一个绝对的“地址”，而另一个是隐式的。

你怎么知道什么时候使用一个而不是另一个合适，你怎么称呼这个，寻址？

我的偏好是始终明确，如果您需要节省空间和/或使事情更清楚，您可以别名为明确的完整“地址”，对吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T17:03:37.777

你是对的。基本上，SQL 将尝试在 FROM 和 JOIN 部分的所有表中查找您要查找的字段“my_column”。但是，如果您碰巧在表 A 和表 B 中有一个“my_column”，那么您需要通过包含表名来明确告诉它您正在寻找哪个“my_column”。如果您在那里也有冲突，那么这会沿着链向上到达 dbo 和 databasename。

大多数情况下，您会发现人们不会显式调用列所在的表，除非他们要连接多个表。

例如，我这样写我的查询：

```
SELECT a.field1, b.field2
FROM tableA AS a
INNER JOIN tableB AS b ON a.id = b.a_id
WHERE a.id = 123 
```

在这里，我使用 AS 将 tableA 和 tableB 别名为更具可读性的 a 和 b。我可以像这样轻松地编写我的查询：

```
SELECT tableA.field1, tableB.field2
FROM tableA
INNER JOIN tableB ON tableA.id = tableB.a_id
WHERE tableA.id = 123 
```

或者像这样，如果 field1 和 field2 对那里的表来说是唯一的，但是对于每条数据的来源，这会让人有点困惑。

```
SELECT field1, field2
FROM tableA
INNER JOIN tableB ON tableA.id = tableB.a_id
WHERE tableA.id = 123 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T16:59:53.643

SQL Server 有四个部分名称：

*   大多数情况下，您按名称引用对象

    ```
    SELECT * FROM MyTable 
    ```

*   然后您可以指定对象的所有者或架构：

    ```
    SELECT * FROM dbo.MyTable 
    ```

*   然后您可以引用该对象所在的数据库：

    ```
    SELECT * FROM master.dbo.MyTble 
    ```

*   最后，您可以在不同的服务器上引用该表

    ```
    SELECT * FROM test1.master.dbo.MyTable 
    ```

它比我在[MSDN上的解释更好](http://msdn.microsoft.com/en-us/library/ms177563.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T17:06:08.260

虽然可以为列使用隐含名称，但从可维护性方面来看，这是一个糟糕的选择。我从来没有把不会对每一列都设置别名的生产代码放出来，因为当你一年后回过头来更改那个报告或查询时，你真的不想弄清楚你加入的 20 个表中的哪一个此外，不指定会使数据库更难找到该列，并且在没有引用的两个表中列名相同的情况下，您会编写更多错误。使用显式引用是一个好习惯。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-02-14T23:08:08.317

复视是错误的。

给定一个使用完全限定名称的存储过程示例，该名称引用同一数据库中的对象，这里还有两个不以这种方式完全限定的原因：

*   如果您有一个引用同一数据库中的对象的存储过程，如果您重命名数据库，它将中断。

*   如果您开始使用 Visual Studio 数据库工具将您的数据库脚本添加到源代码管理中，您会收到很多警告需要处理

正确理解和利用*模式*是个好主意

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T17:00:41.037

我认为这是主观的问题之一，并且会变成一个偏好问题，但是：

从可读性的角度来看，我主张仅在必要时才明确。SQL 语句通常足够复杂，无需阅读大量不必要的文本。

我觉得

```
SELECT TOP 1000 [StoreNumber]
      ,[Address1]
      ,[Address2]
      ,[City]
      ,[St]
      ,[Zip]
      ,[ZipSuffix]
      ,[LocationType]
      ,[LocationSubType]
      ,[Corp]
      ,[Division]
      ,[ZoneNumber]
      ,[DistrictNumber]
      ,[StateNumber] 
  FROM [CommonData].[dbo].[vw_StoreData] 
```

比可读性强很多

```
SELECT TOP 1000 [CommonData].[dbo].[vw_StoreData].[StoreNumber]
      ,[CommonData].[dbo].[vw_StoreData].[[Address1]
      ,[CommonData].[dbo].[vw_StoreData].[[Address2]
      ,[CommonData].[dbo].[vw_StoreData].[[City]
      ,[CommonData].[dbo].[vw_StoreData].[[St]
      ,[CommonData].[dbo].[vw_StoreData].[[Zip]
      ,[CommonData].[dbo].[vw_StoreData].[[ZipSuffix]
      ,[CommonData].[dbo].[vw_StoreData].[[LocationType]
      ,[CommonData].[dbo].[vw_StoreData].[[LocationSubType]
      ,[CommonData].[dbo].[vw_StoreData].[[Corp]
      ,[CommonData].[dbo].[vw_StoreData].[[Division]
      ,[CommonData].[dbo].[vw_StoreData].[[ZoneNumber]
      ,[CommonData].[dbo].[vw_StoreData].[[DistrictNumber]
      ,[CommonData].[dbo].[vw_StoreData].[[StateNumber] 
  FROM [CommonData].[dbo].[vw_StoreData] 
```

（当您开始连接表时情况会变得更糟，如果您要连接不同数据库中的表，情况会更糟。）

***如果***您需要通过单独查看查询来准确了解特定字段来自哪个数据库、模式和表，我可以看到您在哪里可以争辩说第二个更具可读性。

但在 SQL Server 中，例如，您可以在设计器中打开该查询，并在更友好的图形视图中查看它。

恕我直言，我唯一会使用完整语法的***时候是在必要***时，跨越表/数据库/模式边界时，或者如果您有两个具有相同字段名称的表。

例子：

```
SELECT TOP 1000 [CommonData].[dbo].[vw_StoreData].[StoreNumber]
      ,[Address1]
      ,[Address2]
      ,[City]
      ,[St]
      ,[Zip]
      ,[ZipSuffix]
      ,[LocationType]
      ,[LocationSubType]
      ,[Corp]
      ,[Division]
      ,[ZoneNumber]
      ,[DistrictNumber]
      ,[StateNumber] 
  FROM [CommonData].[dbo].[vw_StoreData]
  Inner Join [CommonData].[dbo].[vw_StorePhones]
   ON [CommonData].[dbo].[vw_StorePhones].[StoreNumber] = [CommonData].[dbo].[vw_StoreData].[StoreNumber] 
```

即使在这种情况下，我也会使用[表别名](http://www.w3schools.com/sql/sql_alias.asp)来缩短它并使其更具可读性。

综上所述，在现实世界中，您很可能会发现自己为一家已经确定了标准格式的公司工作，并且您需要根据公司的标准进行编码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-05T17:06:54.453

可以通过单个或多个标识符引用对象。

您可以使用单个标识符来引用一个对象，但如果标识符不明确，则必须使用更多标识符来唯一标识该对象。

例如，`TableA`在查询中必须使用至少两个标识符`schema_one.TableA`和`schema_two.TableA`.

有一个[MDSN 页面](http://msdn.microsoft.com/en-us/library/ms187879.aspx)，您可以在其中找到有关对象名称和标识符的更多信息。

关于对象名称的多个标识符的使用，如果您更具体，可以减少查询中的歧义并加快查询的解析，因为数据库引擎不必解决歧义问题，但代价是可读性查询。

我个人的偏好（对于最常用的对象）是`schema.Table`在引用表时使用`column`，如果在查询中引用了单个表，并且在查询`table.column`中引用了多个表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-14T09:28:20.720

在大多数情况下，为了安全起见，我总是建议使用完整地址

```
 [databasename].[dbo].[some_table].[sometimesacolumngoeshere] 
```

但是，只有当您有多个数据库时才真正需要这样做。我只遇到过一两个选择数据库的问题，通常可以通过在 sql server 中选择正确的数据库来解决。

一旦您实际上在查询中并且为表提供了一个缩短的别名，那么实际上就不需要包含完整地址，因为这已经被引用了。

例如

```
 FROM [databasename].[dbo].[some_table].[sometimesacolumngoeshere] SOME

   SELECT SOME.Name 
```

# delphi - 在大文件中使用 PNG 与 BMP 的效率

> ID：10032754
> 
> 赞同：8
> 
> 时间：2012-04-05T16:53:42.167
> 
> 标签：delphi, graphics, png, bmp

我在 Delphi 中编写了一个映射程序，用户可以在后台加载我存储在内存中的光栅图像。在一种情况下，用户成功加载了 44MB BMP，但程序运行缓慢，当他们打印（我平铺输出）时，他们得到了资源不足错误。我将 BMP 转换为 PNG (3MB)，程序执行得更好，打印作业成功。

由于 PNG 必须扩展为相同大小的 DIB，为什么会有性能/资源差异？如果有的话，加载 PNG 应该需要更多的工作和内存分配。我错过了什么？

由于似乎没有任何明显的答案，我将编写一个小型演示项目，以便进一步研究。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T13:35:45.147

区别在于压缩。

BMP = 与 PNG 一样的原始数据 = 使用“无损”压缩的相同原始数据

这在编程界节省了不止一种方式......

1.  加载图像会导致将更少的原始数据加载到内存中。
2.  然后，您将处理更少的原始数据，因此您需要更少的资源。

平铺意味着您的问题是指数级的，例如...

44MB x 10 块 = 440MB

VS

3MB x 10 块 = 30MB

打印机不喜欢处理大量数据，除了更昂贵的打印机外，所有打印机都倾向于一次性打印整个文档（例如缓冲整个流）。

因此，从您的应用程序中，用户说“打印”......然后您的代码说“对，我要发送 10 个副本”并且打印机开始“缓存”440MB 的原始数据。

大多数常见的家用打印机都依靠 pc 来进行缓存并打印给定的内容，但标准的办公室打印机将进行缓存然后打印文档。

但是......我认为这是您可以调整的可选内容（我认为它因打印机而异）。

编辑：

这里有一些来自游戏编程世界的东西：

[http://www.gamedev.net/topic/450104-png-vs-bmp/](http://www.gamedev.net/topic/450104-png-vs-bmp/)

# c++ - 如何在 box2d 中创建椭圆形状？

> ID：10032756
> 
> 赞同：2
> 
> 时间：2012-04-05T16:53:47.207
> 
> 标签：c++, box2d, shape

我需要为身体创建椭圆形状，但不明白如何在 box2d 中制作它。

任何想法如何**不**使用`b2PolygonShape`大量顶点来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-13T02:22:06.287

** 选项1 **

使用带有两个固定装置的身体：第一个是中心圆形，以赋予身体一些质量。第二个是椭圆，其顶点由链形组成。

第一个fixture 可以让你让body 像一个有质量的body 一样工作，而第二个fixture 可以让你正确处理碰撞。

我最近做了一个轮盘赌的例子。我发布了下面的代码来创建它。将半径的常量值 (OUTER_RADIUS) 替换为[在 wikipedia 上找到](http://en.wikipedia.org/wiki/Ellipse#Polar_form_relative_to_center)的椭圆的极坐标形式。

```
void MainScene::CreateBody()
{
   const float32 INNER_RADIUS = 2.50;
   const float32 OUTER_RADIUS = 3.0;
   const float32 BALL_RADIUS = 0.1;
   const uint32 DIVISIONS = 36;

   Vec2 position(0,0);

   // Create the body.
   b2BodyDef bodyDef;
   bodyDef.position = position;
   bodyDef.type = b2_dynamicBody;
   _body = _world->CreateBody(&bodyDef);
   assert(_body != NULL);

   // Now attach fixtures to the body.
   FixtureDef fixtureDef;
   fixtureDef.density = 1.0;
   fixtureDef.friction = 1.0;
   fixtureDef.restitution = 0.9;
   fixtureDef.isSensor = false;

   // Inner circle.
   b2CircleShape circleShape;
   circleShape.m_radius = INNER_RADIUS;
   fixtureDef.shape = &circleShape;
   _body->CreateFixture(&fixtureDef);

   // Outer shape.
   b2ChainShape chainShape;
   vector<Vec2> vertices;
   const float32 SPIKE_DEGREE = 2*M_PI/180;
   for(int idx = 0; idx < DIVISIONS; idx++)
   {
      float32 angle = ((M_PI*2)/DIVISIONS)*idx;
      float32 xPos, yPos;

      xPos = OUTER_RADIUS*cosf(angle);
      yPos = OUTER_RADIUS*sinf(angle);
      vertices.push_back(Vec2(xPos,yPos));
   }
   vertices.push_back(vertices[0]);
   chainShape.CreateChain(&vertices[0], vertices.size());
   fixtureDef.shape = &chainShape;
   _body->CreateFixture(&fixtureDef);

} 
```

您还可以查看[此帖子](https://stackoverflow.com/questions/20093032/how-to-create-a-circle-shape-without-solid-polygon-or-non-solid-circle/20519366#20519366)以了解轮盘赌（加上图片优势）解决方案。

**选项#2** 您可以创建一个三角形风扇，而不是使用链/边缘形状。获得椭圆的顶点后，您可以执行以下操作：

```
b2Vec2 triVerts[3];
triVerts[0] = Vec2(0,0);
for(int idx = 1; idx < vertices.size(); idx++)
{
   b2PolygonShape triangle;
   fixtureDef.shape = &triangle;
   // Assumes the vertices are going around
   // the ellipse clockwise as angle increases.
   triVerts[1] = vertices[idx-1];
   triVerts[2] = vertices[idx];
   triangle.Set(triVerts,3);
   _body->CreateFixture(&fixtureDef);
} 
```

这个有帮助吗？

# java - 如何更改我的 Piechart3D 部分的颜色

> ID：10032758
> 
> 赞同：0
> 
> 时间：2012-04-05T16:53:52.647
> 
> 标签：java, jfreechart, pie-chart

如何更改 PieChart3D 中每个部分的颜色，我试过这样：

```
private Color[] COLORS = {Color.red,Color.yellow,Color.blue,Color.black,Color.green};

private PieDataset createSampleDataset() {
        final DefaultPieDataset result = new DefaultPieDataset();
        result.setValue("Java", new Double(43.2));

        result.setValue("Visual Basic", new Double(10.0));
        result.setValue("C/C++", new Double(17.5));
        result.setValue("PHP", new Double(32.5));
        result.setValue("Perl", new Double(1.0));
        return result;
    }

    private JFreeChart createChart(PieDataset dataset) {
        final JFreeChart chart = ChartFactory.createPieChart3D(
            "Pie Chart 3D Demo 1",  // chart title
            dataset,                // data
            true,                   // include legend
            true,
            false
        );

        final PiePlot3D plot = (PiePlot3D) chart.getPlot();
        plot.setStartAngle(290);
        plot.setDirection(Rotation.CLOCKWISE);

        for(int i=0;i<COLORS.length;i++){
        plot.setSectionPaint(COLORS[i]);
        }

        plot.setForegroundAlpha(0.5f);
        plot.setNoDataMessage("No data to display");
        return chart;

    } 
```

但是每次我编译时，所有的部分都会有绿色，谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:00:43.490

这是否符合您的要求？

[JFreeChart 中饼图的自定义颜色](http://javabeanz.wordpress.com/2007/08/06/creating-pie-charts-using-custom-colors-jfreechart/)

# ruby-on-rails-3 - 如何在 factory_bot 中定义数组/哈希？

> ID：10032760
> 
> 赞同：80
> 
> 时间：2012-04-05T16:54:02.540
> 
> 标签：ruby-on-rails-3, rspec, factory-bot

我正在尝试编写一个测试来模拟来自 Dropbox 的 REST 服务的一些返回值，该服务给我返回数组中的数据，并带有嵌套的哈希。

我无法弄清楚如何对我的工厂进行编码，因为返回结果是一个内部带有 has 的数组。什么会去这里？

```
Factory.define :dropbox_hash do
 ??
end 
```

Dropbox 数据如下所示：

```
 ["/home", {"revision"=>48, "rev"=>"30054214dc", "thumb_exists"=>false, "bytes"=>0, "modified"=>"Thu, 29 Dec 2011 01:53:26 +0000", "path"=>"/Home", "is_dir"=>true, "icon"=>"folder_app", "root"=>"app_folder", "size"=>"0 bytes"}] 
```

我想在我的 RSpec 中进行这样的工厂调用：

```
Factory.create(:dropbox_hash) 
```

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2012-08-19T13:45:21.823

我有兴趣做同样的事情，也想测试我的一个模型，该模型使用来自 3rd-party API 的内容散列进行操作。我发现通过使用 factory_girl 的一些内置功能，我能够清晰地构建这类数据结构。

这是一个人为的例子：

```
 factory :chicken, class:Hash do
    name "Sebastian"
    colors ["white", "orange"]

    favorites {{
      "PETC" => "http://www.petc.org"
    }}

    initialize_with { attributes } 
  end 
```

这里的主要技巧是，当您声明 initialize_with 时，factory_girl 将不再尝试将属性分配给结果对象。在这种情况下，它似乎也跳过了数据库存储。因此，我们不需要构建任何复杂的东西，而是将已经准备好的属性哈希作为我们的内容传回。瞧。

尽管实际上并未使用该类，但似乎确实有必要为该类指定一些值。这是为了防止 factory_girl 尝试根据工厂名称实例化一个类。我选择使用描述性类而不是 Object，但这取决于你。

当您使用以下哈希工厂之一时，您仍然可以覆盖字段：

```
chick = FactoryGirl.build(:chicken, name:"Charles") 
```

..但是，如果您有嵌套内容并想要覆盖更深的字段，则需要增加初始化块的复杂性来进行某种深度合并。

在您的情况下，您正在使用一些混合数组和哈希数据，并且似乎应该在数据结构的各个部分之间重用 Path 属性。没问题 - 您知道内容的结构，因此您可以轻松创建一个正确构造结果数组的工厂。这是我可以做到的：

```
 factory :dropbox_hash, class:Array do
    path "/home"
    revision 48
    rev "30054214dc"
    thumb_exists false
    bytes 0
    modified { 3.days.ago }
    is_dir true
    icon "folder_app"
    root "app_folder"
    size "0 bytes"

    initialize_with { [ attributes[:path], attributes ] }
  end

  FactoryGirl.build(:dropbox_hash, path:"/Chickens", is_dir:false) 
```

您仍然可以随意省略不必要的值。让我们假设只有 Path 和 rev 是真正需要的：

```
 factory :dropbox_hash, class:Array do
    path "/home"
    rev "30054214dc"
    initialize_with { [ attributes[:path], attributes ] }
  end

  FactoryGirl.build(:dropbox_hash, path:"/Chickens", revision:99, modified:Time.now) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-10-29T12:05:07.423

让这对我有用，我可以根据需要将属性传递到哈希中

```
factory :some_name, class:Hash do
  defaults = {
    foo: "bar",
    baz: "baff"
  }
  initialize_with{ defaults.merge(attributes) }
end

> build :some_name, foo: "foobar" #will give you
> { foo: "foobar", baz: "baff" } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-07-17T12:48:01.497

当前 RSpec 版本 (3.0) 的后续：

只需像往常一样定义您的工厂并使用它[`FactoryBot.attributes_for`](https://www.rubydoc.info/github/thoughtbot/factory_bot/FactoryBot/Syntax/Methods#attributes_for-instance_method)来接收哈希而不是实例化的类。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-03T12:28:14.620

您可以在最新版本的 factory_girl 中执行此操作，但这很尴尬，因为它旨在构建对象而不是数据结构。这是一个例子：

```
FactoryGirl.define do
  factory :dropbox_hash, :class => 'Object' do
    ignore do
      url { "/home" }
      revision { 48 }
      rev { "30054214dc" }
      # more attributes
    end
    initialize_with { [url, { "revision" => revision, "rev" => rev, ... }] }
    to_create {}
  end
end 
```

在这里回顾一下奇怪的东西：

*   每个工厂都需要一个有效的构建类，即使它没有被使用，所以我通过`Object`这里以防止它寻找`DropboxHash`.
*   您需要使用`ignore`块忽略所有属性，这样它就不会在之后尝试将它们分配给数组，例如`array.revision = 48`.
*   您可以告诉它如何使用`initialize_with`. 这里的缺点是您需要再次写出完整的属性列表。
*   您需要提供一个空`to_create`块，以便它不会在`array.save!`之后尝试调用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-07T05:44:20.963

我使用了 OpenStruct：

```
factory :factory_hash, class:OpenStruct do
  foo "bar"
  si "flar"
end 
```

编辑：抱歉，不能用作哈希

我终于使用了一个静态版本，只是为了保持来自工厂系统的哈希......

```
factory :factory_hash, class:Hash do
  initialize_with { {
    foo "bar"
    si "flar"
  } }
end 
```

寻找更好的东西

# drupal - 如何通过 API 在 Drupal 7 中本地化月份和工作日？

> ID：10032763
> 
> 赞同：2
> 
> 时间：2012-04-05T16:54:24.583
> 
> 标签：drupal, localization, drupal-7

我有一个 Drupal 7 站点，需要输出一个用 PHP 编写的小型日历控件。它输出月份名称和带有天数的表格。表有一个带有工作日名称的标题：'Mon'、'Tue'。

我需要使用在 Drupal 中选择的当前站点语言来输出它。这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:48:49.533

在 Drupal 中，用于翻译字符串的函数是[t()](http://api.drupal.org/api/drupal/includes!bootstrap.inc/function/t/7)。

当您启用非英语语言时，传递给的文字字符串将`t()`替换为翻译文件中可用的翻译。如果工作日短名称没有翻译，则可以在 admin/config/regional/translate/translate 上添加翻译。

![截屏](../Images/a8470dbeac16c9a43fe36ffdfd76e1d2.png)

由于翻译系统是在 Drupal 中实现的，因此它仅在传递给的字符串`t()`是文字字符串时才起作用。如果模块正在调用传递以下参数之一的函数，则字符串不可翻译。

*   两个或多个字符串之间的连接 ( `t('This is a' . 'string that is not translatable')`)
*   变量的内容 ( `t($text_to_translate)`)
*   函数的结果 ( `t(get_string(STRING_ID_ERROR_MESSAGE))`)

如果模块托管在 drupal.org 上，那么它可以使用[http://localize.drupal.org](http://localize.drupal.org)提供的翻译服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-07T20:31:33.750

默认情况下不添加月份名称（长格式）进行翻译。

这将是添加这些的优雅解决方案：

```
function monthname_install() {
  $months = array(
    'January',
    'February',
    'March',
    'April',
    'May',
    'June',
    'July',
    'August',
    'September',
    'October',
    'November',
    'December',
  );

  $options['context'] = 'Long month name';

  foreach($months as $m) {
    t($m, array(), $options);
  }

  drupal_set_message(t('Month names have been made available for translation. The rest is up to the translation team :-)'));
} 
```

另见：[https ://drupal.org/comment/8251325#comment-8251325](https://drupal.org/comment/8251325#comment-8251325)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-01T12:11:48.263

Erlendoos，我尝试了您的解决方案，但对我不起作用。

我终于结束了使用 locale() 而不是 t()，如下所示：

```
function monthname_install() {
  $months = array(
                     'January',
                     'February',
                     'March',
                     'April',
                     'May',
                     'June',
                     'July',
                     'August',
                     'September',
                     'October',
                     'November',
                     'December',
                );

  foreach($months as $m) {
    locale( $m, 'Long month name' );
  }

  drupal_set_message(t('All long month names available for translation.'));
} 
```

[https://api.drupal.org/api/drupal/modules%21locale%21locale.module/function/locale/7](https://api.drupal.org/api/drupal/modules%21locale%21locale.module/function/locale/7)

完成上述操作后，我已经有了要翻译的月份名称。

请注意，如果您启用了“存档”示例视图，并使用该视图放置块或页面，则视图使用的每个名称都可以用于翻译。但是在“新安装的”drupal 中，您必须在 .install 文件中运行上述内容才能翻译字符串。

希望这可以帮助像我一样遇到同样问题并且尝试上述解决方案但没有成功的人。

# c# - c# events：如何访问变量

> ID：10032765
> 
> 赞同：5
> 
> 时间：2012-04-05T16:54:48.943
> 
> 标签：c#, events, scope

认为

```
public class Program
{
    public static void Main(string[] args)
    {
        Program p = new Program();
        A a = new A();
        p.Do(a);
        System.Threading.Thread.Sleep(1000);
        a.Fire();
    }

    public void Do(A a)
    {
        int i = 5;
        a.ChangeViewEvent += () =>
        {
            Console.WriteLine(i);
        };
    }
}

public class A
{
    public delegate void ChangeView();
    public event ChangeView ChangeViewEvent;

    public void Fire()
    {
        if(ChangeViewEvent != null)
            ChangeViewEvent();
    }
} 
```

什么时候`ChangeViewEvent`被触发，事件处理程序仍然能够访问变量`i`？我的意思是它不应该超出范围吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T16:56:52.890

> 为什么当 ChangeViewEvent 被触发时，事件处理程序仍然能够访问变量 i？我的意思是它不应该超出范围吗？

不，它被 lambda 表达式捕获。它被“提升”到编译器生成的类中，因此即使它“超出范围”，它仍然可以被 lambda 表达式访问。（请记住，“超出范围”仅表示“无法通过其简单名称访问。”这并不意味着与该变量关联的存储空间已消失且其他任何人都无法访问。）

顺便说一句，这就是为什么“值类型存在于堆栈上”这一经常被重复的谎言是错误的众多原因之一*。*在这种情况下，您有一个值类型，它实际上被提升到编译器生成的类中并最终存在于堆上。

有关此主题的更多信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/dd293603.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T16:56:55.250

它被称为捕获的变量。

[http://en.wikipedia.org/wiki/Closure_%28computer_science%29#Delegates_.28C.23.2C_D.29](http://en.wikipedia.org/wiki/Closure_%28computer_science%29#Delegates_.28C.23.2C_D.29)

[http://blogs.msdn.com/b/ericlippert/archive/2003/09/17/what-are-closures.aspx](http://blogs.msdn.com/b/ericlippert/archive/2003/09/17/what-are-closures.aspx)

# sql - 从表函数的结果中获取

> ID：10032768
> 
> 赞同：0
> 
> 时间：2012-04-05T16:55:08.230
> 
> 标签：sql, oracle, function, plsql

我使用一个函数并**管道**它的返回值。我将上述函数称为：

```
SELECT * FROM TABLE(FUNC(params)) ORDER BY somecolumn; 
```

**它以1 x 4**表的形式返回结果，我尝试使用**游标**来检索它们。但是显示一个错误，说游标仅用于字段名或列名，而不用于**type**。

是否仍然可以使用游标，或者是否有任何其他方式来检索各个字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:28:07.633

我想这就是你想要的？

```
SELECT MyTable.Column1, MyTable.Column3, etc
FROM TABLE(FUNC(params)) MyTable
ORDER BY somecolumn; 
```

要访问特定列，只需为表设置别名。

# css - qTip/css 格式问题

> ID：10032774
> 
> 赞同：1
> 
> 时间：2012-04-05T16:55:27.790
> 
> 标签：css, qtip

我有一个`qTip`用来显示数据的。除了表格数据的格式之外，它工作得很好。

的内容`qTip`已`table`嵌入其中。尽管使用了`ui-tooltip-green`该类，但表格内容仍保留了在我的默认样式表中建立的默认格式。

如何取消来自默认样式表的默认格式，而使用`ui-tooltip-green`类中的样式？

这是工具提示的图片 - 您可以看到采用不同格式的表格数据：

![在此处输入图像描述](../Images/fe9db8238077f4a5d7581b4494c19c0f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:20:47.997

如果您有相互覆盖的 css 规则并且不确定如何解决它，您可能需要阅读[css 中的特异性](https://developer.mozilla.org/en/CSS/Specificity)。虽然听起来这不一定是问题的原因，但问题与主题非常相关。在您的情况下，听起来您没有可应用于该表的规则，因此它在特异性树的较高位置抓取了一些更通用的规则。

需要明确的是，解决您的问题的最简单方法可能在于您编辑/添加 css 规则以明确您希望它们在哪里。具体来说（请原谅双关语），您需要在您的 css 中明确表示您希望该表及其元素的样式与其父级一样。

例如，如果工具提示中链接的 css 看起来像这样：

```
.ui-tooltip-green a {
     color: rgb(0,255,0);
     font-weight: bold;
} 
```

然后更多特定于表的条目将强制该元素的样式，例如：

```
.ui-tooltip-green table a {
     color: rgb(0,255,0);
     font-weight: bold;
} 
```

如果没有看到所有涉及的代码，很难给你一个明确的答案，但一般来说，你只需要为该表添加[更具体的]规则。

# android - 为 Async 传递更多参数时强制关闭应用程序

> ID：10032777
> 
> 赞同：0
> 
> 时间：2012-04-05T16:55:52.453
> 
> 标签：android, json, radio-button, android-asynctask, settext

我想用来自 json 对象的值更改我在 android 应用程序中的单选按钮文本... q_desc textView 更改...但不是单选按钮的文本...更改 q_desc 文本视图强制关闭后的应用程序....我的错误是什么..??? 我提供了我的 jsp 页面、活动以及我的日志猫..

这是我的jsp代码....

```
<%@page contentType="text/html; charset=UTF-8"%>
<%@page import="org.json.simple.JSONObject"%>
<%@page import="java.util.*,java.sql.*"%>

 <%!
 Connection con;
 PreparedStatement ps;
 ResultSet rs;
 String x;

 %>

<%
 Class.forName("oracle.jdbc.driver.OracleDriver");
 con=DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:orcl","pro","pro");
 ps=con.prepareStatement("select * from c_question where id=1");
 rs=ps.executeQuery();

JSONObject obj=new JSONObject();
obj.put("id",rs.getString(1));
obj.put("desc",rs.getString(2));
obj.put("a",rs.getString(3));
obj.put("b",rs.getString(4));
obj.put("c",rs.getString(5));
obj.put("d",rs.getString(6));

out.print(obj);
out.flush();
 %> 
```

这是我的活动...

```
import java.io.IOException;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.util.EntityUtils;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.widget.RadioButton;
import android.widget.RadioGroup;
import android.widget.TextView;
import android.widget.Toast;

public class JsonDemo extends Activity 
{
JSONObject json;
HttpClient client;
TextView q_desc;
RadioButton rb_a;
RadioButton rb_b;
RadioButton rb_c;
RadioButton rb_d;
RadioGroup rg;

final static String URL="http://10.0.2.2:7001/project/json.jsp";

@Override
protected void onCreate(Bundle savedInstanceState) {

    // TODO Auto-generated method stub

    super.onCreate(savedInstanceState);

    setContentView(R.layout.result_json);

    q_desc=(TextView)findViewById(R.id.q_desc);
        rb_a=(RadioButton)findViewById(R.id.opt_a);
        rb_b=(RadioButton)findViewById(R.id.opt_b);
        rb_c=(RadioButton)findViewById(R.id.opt_c);
        rb_d=(RadioButton)findViewById(R.id.opt_d);

        client=new DefaultHttpClient();

       new Read().execute("desc","a","b","c","d");

}
   public  JSONObject getData()throws      ClientProtocolException,IOException,JSONException
   {

    StringBuilder url=new StringBuilder(URL);
    HttpGet get=new HttpGet(url.toString());
    HttpResponse r=client.execute(get);

    int status=r.getStatusLine().getStatusCode();

    if(status == 200)
    {
        HttpEntity e=r.getEntity();
        String data=EntityUtils.toString(e);
        JSONObject last=new JSONObject(data);
        return last;

    }
    else
    {
        Toast.makeText(JsonDemo.this, "error", Toast.LENGTH_SHORT);
        return null;
    }

}

 public class Read extends AsyncTask<String,Integer,String>
 {

@Override
protected String doInBackground(String... params) {
    // TODO Auto-generated method stub
    try {

        json=getData();
        String desc=json.getString(params[0]);
        String option_a=json.getString(params[1]);
        String option_b=json.getString(params[2]);
        String option_c=json.getString(params[3]);
        String option_d=json.getString(params[4]);
        set_ques(desc);
        set_options(option_a,option_b,option_c,option_d);

    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return null;
}

protected void set_ques(String desc) {
    // TODO Auto-generated method stub
    q_desc.setText(desc);
}
protected void set_options(String a,String b,String c,String d) {
    // TODO Auto-generated method stub
    rb_a.setText(a);
    rb_b.setText(b);
    rb_c.setText(c);
    rb_d.setText(d);
}

} 
```

这是原木猫……

```
 04-05 22:17:52.198: W/dalvikvm(445): threadid=7: thread exiting with uncaught exception (group=0x4001d800)
 04-05 22:17:52.968: E/AndroidRuntime(445): FATAL EXCEPTION: AsyncTask #1
 04-05 22:17:52.968: E/AndroidRuntime(445): java.lang.RuntimeException: An error occured while executing doInBackground()
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.os.AsyncTask$3.done(AsyncTask.java:200)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at   java.util.concurrent.FutureTask.setException(FutureTask.java:124)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at    java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at java.lang.Thread.run(Thread.java:1096)
 04-05 22:17:52.968: E/AndroidRuntime(445): Caused by: android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.view.ViewRoot.checkThread(ViewRoot.java:2802)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.view.ViewRoot.invalidateChild(ViewRoot.java:607)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.view.ViewRoot.invalidateChildInParent(ViewRoot.java:633)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.view.ViewGroup.invalidateChild(ViewGroup.java:2505)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at  android.view.View.invalidate(View.java:5139)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.widget.TextView.checkForRelayout(TextView.java:5364)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.widget.TextView.setText(TextView.java:2688)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.widget.TextView.setText(TextView.java:2556)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.widget.TextView.setText(TextView.java:2531)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at com.campuspro.start.JsonDemo$Read.set_ques(JsonDemo.java:122)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at com.campuspro.start.JsonDemo$Read.doInBackground(JsonDemo.java:101)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at com.campuspro.start.JsonDemo$Read.doInBackground(JsonDemo.java:1)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at android.os.AsyncTask$2.call(AsyncTask.java:185)
 04-05 22:17:52.968: E/AndroidRuntime(445):     at           java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
 04-05 22:17:52.968: E/AndroidRuntime(445):     ... 4 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:01:27.840

写在`OnPostExecute(...)` 因为`doinbackground is non UI thread`

所以你不能更新你的视图......在你从 URL 获取数据并完成并最终`OnPostExecute`被调用后，添加这个......

```
 String desc=json.getString(params[0]);
        String option_a=json.getString(params[1]);
        String option_b=json.getString(params[2]);
        String option_c=json.getString(params[3]);
        String option_d=json.getString(params[4]);
        set_ques(desc);
        set_options(option_a,option_b,option_c,option_d); 
```

# android - 如何使用 Home Widget 启动 Activity

> ID：10032778
> 
> 赞同：1
> 
> 时间：2012-04-05T16:55:57.867
> 
> 标签：android, android-intent, android-widget, android-activity

> **可能重复：**
> [如何从 android 主屏幕小部件启动活动](https://stackoverflow.com/questions/2706464/how-to-launch-activity-from-android-home-screen-widget)

从应用程序主屏幕小部件启动活动的最简单代码是什么？

到目前为止我的代码不起作用，LogCat 中没有任何显示..？？

小部件中有一个图像，当点击图像时，应该启动应用程序。寻找一个片段。

```
public class MyWidget extends AppWidgetProvider
{
    // Create an Intent to launch activity from ImageView
    @Override
    public void onEnabled(Context context)
    {
    Intent intent = new Intent(Intent.ACTION_MAIN, null);
    intent.addCategory(Intent.CATEGORY_LAUNCHER);

    ComponentName comp = new ComponentName(context.getPackageName(),MyWidget.class.getName());
    intent.setComponent(cn);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    PendingIntent myPI = PendingIntent.getActivity(context, 0, intent, 0);

    RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.content);//<-THE LAYOUT W/I THE MainActivity CLASS??

    views.setOnClickPendingIntent(R.id.widgetLauncher, myPI);//<-THE IMAGEVIEW ID??

    AppWidgetManager mgr = AppWidgetManager.getInstance(context);
    mgr.updateAppWidget(comp, views);
    }
} 
```

小部件布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/widgetLauncher"
        android:layout_width="258dp"
        android:layout_height="54dp"
        android:layout_centerInParent="true"
        android:src="@drawable/wgt_logo" >
    </ImageView>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T18:56:07.997

这终于奏效了：

```
public class MyWidget extends AppWidgetProvider
{
    // Create an Intent to launch activity
    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager,int[] appWidgetIds)
    {
    super.onUpdate(context, appWidgetManager, appWidgetIds);

    RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.home_widget);
    // When we click the widget, we want to open our main activity.
    Intent launchActivity = new Intent(context, MainActivity.class);
    PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, launchActivity, 0);
    remoteViews.setOnClickPendingIntent(R.id.widget, pendingIntent);;

    ComponentName thisWidget = new ComponentName(context, MyWidget.class);
    AppWidgetManager manager = AppWidgetManager.getInstance(context);
    manager.updateAppWidget(thisWidget, remoteViews);
    }
} 
```

# sql-server - 如何批量读取用户名列表并在 sql 语句中使用这些用户名？

> ID：10032779
> 
> 赞同：4
> 
> 时间：2012-04-05T16:56:00.200
> 
> 标签：sql-server, loops, batch-file, sqlcmd

目前我有以下批处理代码来读取 1 个用户名，并在 sql 中使用它

```
@echo on
cls
set userID=
for /F %%i in (UserID.txt) do set userID=%userID% %%i
sqlcmd -S server -d database -U username -P password -v userID=%userID% 
                -i "sqlQuery.sql" -s "," > "\output.csv" -I -W -k 
```

调用的SQL查询如下

```
SELECT userId, COUNT (*) AS number 
FROM table 
WHERE userId = '$(userID)' 
GROUP BY userId 
ORDER BY userId desc 
```

我正在寻找的是，如果我在文本文件中有一个用户名列表，它将动态地将 WHERE 语句更改为

```
WHERE userId = '$(userID1)' OR userId = '$(userID2)' etc.... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T18:28:34.170

我没有太多使用 SQL 脚本，所以我不确定返回是否会导致问题，但这会产生你需要的东西。

我在一个名为 userID.txt 的文件中使用了这个输入：

```
steve,joe,fred,jason,bill,luke 
```

通过以下代码运行它：

```
@echo off
setlocal enabledelayedexpansion
set count=0
for /F "tokens=* delims=," %%G in (userID.txt) do call :loop %%G
:loop
if "%1"=="" goto :endloop
set /a count+=1
set userid%count%=%1
SHIFT
goto :loop
:endloop
set totalusers=%count%
set /a totalusers-=1

echo SELECT userId, COUNT (*) AS number FROM table WHERE ( > sqlQuery.sql
set count=0
:where_gen_loop
set /a count+=1
if !count! gtr !totalusers! goto endwhere_gen_loop
echo userId = '$(!userid%count%!)' OR>> sqlQuery.sql
goto where_gen_loop
:endwhere_gen_loop
echo userId = '$(!userid%count%!)'>> sqlQuery.sql
echo ) >> sqlQuery.sql
echo GROUP BY userId ORDER BY userID desc >> sqlQuery.sql 
```

在 sqlQuery.sql 中生成此输出：

```
SELECT userId, COUNT (*) AS number FROM table WHERE ( 
userId = '$(steve)' OR
userId = '$(joe)' OR
userId = '$(fred)' OR
userId = '$(jason)' OR
userId = '$(bill)' OR
userId = '$(luke)'
) 
GROUP BY userId ORDER BY userID desc 
```

然后在批处理结束时访问：

```
sqlcmd -S server -d database -U username -P password -i "sqlQuery.sql" -s "," > "\output.csv" -I -W -k

endlocal 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T20:12:21.933

您需要做的就是修改您的 sql 查询以使用 IN 子句，然后正确格式化您的变量。您还必须在 FOR 循环中使用延迟扩展，因为 %userID% 在解析 FOR 语句时仅扩展一次，而 !userID! 在每次循环迭代的执行时扩展。

sqlQuery.sql：

```
SELECT userId, 
       COUNT(*) AS number
  FROM table
 WHERE userId in( $(userID) )
 GROUP BY userId
 ORDER BY userId desc 
```

批处理脚本：

```
@echo on
setlocal enableDelayedExpansion
set userID=
for /f %%i in (UserID.txt) do set "userID=!userID!,'%%i'"
sqlcmd -S server -d database -U username -P password -v userID="%userID:~1%" -i "sqlQuery.sql" -s "," > "\output.csv" -I -W -k 
```

请注意，sql 变量定义使用批处理子字符串操作来消除前导逗号。

userID 变量最终看起来像`'userID1','userID2','userID3'`

如果输入文件中有太多 ID 以适应 ~8k 环境变量限制，那么您将需要动态构建您的 sql 脚本。此时，您不妨消除 sql 变量并简单地使用字符串文字。

```
@echo on
setlocal enableDelayedExpansion
set "delim="
>"sqlQuery.sql" echo SELECT userId, COUNT(*) AS number FROM table WHERE userId in(
for /f %%i in (UserID.txt) do (
  >>"sqlQuery.sql" echo !delim!'%%i'
  set "delim=,"
)
>>"sqlQuery.sql" echo ) GROUP BY userId ORDER BY userId desc
sqlcmd -S server -d database -U username -P password -i "sqlQuery.sql" -s "," > "\output.csv" -I -W -k 
```

# hibernate - Hibernate 多对一延迟加载不起作用

> ID：10032780
> 
> 赞同：3
> 
> 时间：2012-04-05T16:56:09.903
> 
> 标签：hibernate, proxy, lazy-loading, many-to-one

我有一个类和 2 个多对一映射，我怎样才能延迟加载它们

我的属性

```
**teneo.mapping.also_map_as_class=true
teneo.mapping.set_proxy=true
teneo.mapping.mapping_file_name=/lazy.hbm.xml** 
```

映射文件（lazy.hbm.xml）

```
<class name="EnvironmentImpl" entity-name="**Environment**" abstract="false" lazy="true" discriminator-value="Environment" table="`ENVIRONMENT`" proxy="Environment">
    <meta attribute="eclassName">Environment</meta>

    <property name="name" lazy="false" insert="true" update="true" not-null="true" unique="false" type="java.lang.String">
        <column not-null="true" unique="false" name="`NAME`"/>
    </property>

    <property name="description" lazy="false" insert="true" update="true" not-null="false" unique="false" type="java.lang.String">
        <column not-null="false" unique="false" name="`DESCRIPTION`" length="512"/>
    </property>

    <property name="contact" lazy="false" insert="true" update="true" not-null="false" unique="false" type="java.lang.String">
        <column not-null="false" unique="false" name="`CONTACT`"/>
    </property>

    <many-to-one  name="rootAppFolder" entity-name="ApplicationFolder" lazy="proxy" cascade="all" foreign-key="ENVIRONMENT_ROOTAPPFOLDER" insert="true" update="true" not-null="false" unique="true">
        <column not-null="false" unique="false" name="`APPLICATINFLDER_RTAPPFOLDER_ID`"/>
    </many-to-one>

    <many-to-one name="serviceVirtualization" entity-name="ServiceVirtualization" lazy="proxy" cascade="all" foreign-key="ENVIRNMENT_SERVICEVIRTALIZATIN" insert="true" update="true" not-null="false">
        <column not-null="false" unique="false" name="`SRVCVRTLZTN_SRVICVIRTLIZTIN_ID`"/>
    </many-to-one>
</class> 
```

`As you can see class Environment has 2 many-to-one's with names` `ApplicationFolder and serviceVirtualization.`

```
for a HQL query like -  from Environment where name = :name

    Which internally triggers 3 queries  
    Query1 : Environment ( this is right)

    Query2 : ApplicationFolder ( wrong.lazy loading should not.)

    Query 3 : serviceVirtualization ( wrong.lazy loading should not.)

            DEBUG - select environmen0_."NAME" as NAME4_31_, environmen0_."DESCRIPTION" as DESCRIPT5_31_, environmen0_."CONTACT" as CONTACT6_31_, environmen0_."APPLICATINFLDER_RTAPPFOLDER_ID" as APPLICAT7_31_, environmen0_."SRVCVRTLZTN_SRVICVIRTLIZTIN_ID" as SRVCVRTL8_31_ from "ENVIRONMENT" environmen0_ where environmen0_."NAME"=?

            DEBUG - select applicatio0_.e_id as e1_43_0_, applicatio0_.version_ as version3_43_0_, applicatio0_."NAME" as NAME4_43_0_, applicatio0_."ENVIRONMENT_ENV_E_ID" as ENVIRONM5_43_0_ as APPLICAT8_43_0_ from "APPLICATIONFOLDER" applicatio0_ where applicatio0_.e_id=?

            DEBUG - select servicevir0_.e_id as e1_35_0_, servicevir0_.version_ as version3_35_0_, servicevir0_.econtainer_class as econtainer4_35_0_, servicevir0_.e_container as e5_35_0_, servicevir0_.e_container_featureid as e6_35_0_ from "SERVICEVIRTUALIZATION" servicevir0_ where servicevir0_.e_id=? 
```

到目前为止我尝试了哪些方法 1）设置 lazy="no-proxy" ，没有看到查询数量有任何变化。

2）设置未找到=“异常”。

3）外连接=“自动”

任何人都可以建议我一个解决方案来减少由于急切的多对一关系而被触发的这两个额外查询吗？

请注意多对一的外键关系。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-07T11:33:52.610

lazy 默认为 true。尝试摆脱`lazy="proxy"`.

懒惰不工作的原因：

*   当引用的类型因为没有默认构造函数或最终方法而无法被代理时
*   引用的类型映射为`<class lazy="false"`

# amazon-s3 - 通过异步跨域请求在 S3 上托管动态站点

> ID：10032781
> 
> 赞同：6
> 
> 时间：2012-04-05T16:56:10.007
> 
> 标签：amazon-s3, cross-domain, cors

我意识到我可以在 S3（html、js、css 等）上托管整个站点，并且通过在页面加载时与数据库（对我来说是 EC2）进行异步通信，它仍然是动态的。即使 index.html 文件位于 S3 上，我也可以启用跨域请求以拥有“动态”站点。

我想知道人们是否已经这样做了，我是否应该记住任何安全警告？

对我来说，这是一个非常可扩展（而且便宜！）的服务器端架构。我的服务器永远不必发送一行 html。它的唯一负载是发送和接收 JSON 片段。如果我的服务器负载很重，它还可以非常简单地切换“静态”标志并简单地从 S3 提供所有服务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T23:47:59.573

S3 上的静态站点很容易，添加 CloudFront CDN 支持轻而易举。

因为跨域资格基于元组 {domain, protocol, port}，所以跨域考虑确实发挥了作用。

但是，标准的跨域解决方法仍然适用。

我用来通过 iFrame 或其他方式进行跨域通信的示例技术：

0) [jsonp](http://json-p.org/)

1）[访问控制允许来源](https://developer.mozilla.org/en/HTTP_access_control#Access-Control-Allow-Origin)：

2）设置[document.domain](https://developer.mozilla.org/en/DOM/document.domain)以允许通信

3）[window.postMessage](https://developer.mozilla.org/en/DOM/window.postMessage)

对于在 S3 上托管静态资产，JSONP 非常棒，但当它是您的网站离开 S3 而不是资产时，可能最发挥作用（而在这里，您的网站是 S3 并且您与其他服务器通信）。

Access-Control-Allow-Origin 将为您提供所有现代浏览器，并允许您跨域安全或不安全地讲话。IE 提出并支持不同（且更安全）的标准，但预计将在 IE10 中支持 CORS。

这是我的观点，但如果您正在为现代浏览器编写代码，请走 CORS 路线。

# sql - 如何从SQL中的某个表中获取按字段的平均差异排序的列

> ID：10032784
> 
> 赞同：1
> 
> 时间：2012-04-05T16:56:26.690
> 
> 标签：sql, sqlite, average, absolute-value

我有一张像这样的桌子：

![桌子](../Images/e992e198fd42061f174046d16792fd23.png)

`v`我必须根据字段差异的平均值对行进行排序。

例如：

所有f1：

```
v1= 1;
v2 = 10;
v3 = 451;
average(f1) = ((abs(1-10))+(abs(10-451)))/3;
average(f2) = .... 
```

所以我必须在后代模式下按这个平均值排序列。

有可能与一个 SQL 查询有关吗？有人能帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T17:09:51.483

您不必计算所有值之间的差异，您只需要知道最小值、最大值和值的数量。

如果您查看这些值：

```
( abs(1-10) + abs(10-451) ) / 3 
```

如果您总是从较大的值中减去较小的值，则不需要`abs`：

```
( (10-1) + (451-10) ) / 3 
```

不需要内括号，因此您得到：

```
(10 - 1 + 451 - 10) / 3 
```

在这里您可以消除内在价值`10`，就像您拥有`+10`和一样`-10`。你最终只得到最大和最小值：

```
(451 - 1) / 3 
```

不管你有多少中间值，它们总是会被自己消除，例如`(b-a)+(c-b)+(d-c)+(e-d)+(f-e)`= `(f-a)`。

因此，用于此的 SQL 将是：

```
select name, (max(v) - min(v)) / count(*) as averageDiff
from TheTable
group by name
order by averageDiff desc 
```

注意：我不确定这个平均差异应该是什么意思，但是您将平均差异除以项目数，但您可能希望将其除以差异数，即比数字少一物品；`(count(*) - 1)`.

# c# - Silverlight DataGrid BeginEdit 方法导致 CellEditEnded 事件

> ID：10032787
> 
> 赞同：0
> 
> 时间：2012-04-05T16:56:28.607
> 
> 标签：c#, silverlight, datagrid

我要求用户应该能够单击网格中的（可编辑）单元格，并且它会立即进入编辑模式，而不必双击按 F2。为此，我添加了一个行为：

```
public class AutomaticallyEditGridBehavior : Behavior<DataGrid>
{
    protected override void OnAttached()
    {
        base.OnAttached();
        if (AssociatedObject.IsReadOnly)
        {
            return;
        }

        AssociatedObject.CurrentCellChanged += OnCurrentCellChanged;
    }

    private void OnCurrentCellChanged(object sender, EventArgs e)
    {
        // Check our column is not readonly first
        if (AssociatedObject.CurrentColumn.IsReadOnly)
        {
            return;
        }

        AssociatedObject.BeginEdit();
    }
} 
```

我也有一些关于何时编辑单元格的逻辑，所以我添加了另一种行为：

```
public class CellEditEndedBehavior : Behavior<DataGrid>
{
    protected override void OnAttached()
    {
        base.OnAttached();
        AssociatedObject.CellEditEnded += CellEditEnded;
    }

    private void CellEditEnded(object sender, DataGridCellEditEndedEventArgs e)
    {
        if (e.EditAction != DataGridEditAction.Commit)
        {
            return;
        }

        if (AssociatedObject.SelectedItem == null)
        {
            return;
        }

        // Some processing and logic to get next editable item

        // Set the focus to the next item and begin editing
        AssociatedObject.SelectedItem = nextEditableItem;
        AssociatedObject.CurrentColumn = e.Column;
        AssociatedObject.Focus();
        AssociatedObject.BeginEdit();
    }
} 
```

我发现当我单击一个单元格时，第一个行为会运行，但在有机会编辑该单元格之前，CellEditEnded 事件已触发。因此，焦点移动到下一个对象，而不是刚刚单击的单元格。

为什么在实际编辑单元格之前触发此事件？有一个更好的方法吗？

# python - Python 3.2 中的部分正则表达式匹配

> ID：10032788
> 
> 赞同：1
> 
> 时间：2012-04-05T16:56:31.393
> 
> 标签：python, regex, python-3.x

正则表达式回答是或否问题 - 字符串是否与模式匹配。

我想将 no 分为两类：

*   作为有效字符串前缀的无效字符串
*   不是有效前缀的无效字符串

这是一个示例（正则表达式`01+2`）：

*   `012`已验证

*   `12`是无效的; 它不是有效字符串的前缀

*   `01`是无效的; 它是有效字符串的前缀：`012`

[Java 可以做到这一点。](https://stackoverflow.com/questions/2526756/can-java-util-regex-pattern-do-partial-matches)

可以`re`这样做吗？如果没有，是否有图书馆可以做出这种区分？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T17:26:57.127

我赞同正则表达式的建议。该模块简直太棒了。

这是使用正则表达式进行模糊匹配的示例：

```
import regex

# traditional matching - three digits
r = '(?:\d\d\d)'
print regex.findall(r, '1xx22yy333zz')
## ['333']

# fuzzy matching - three digits, allow at most 2 deletions
r = '(?:\d\d\d){d<3}'
print regex.findall(r, '1xx22yy333zz')
## ['1', '22', '333'] 
```

该`{d<3}`部分基本上说“如果我们添加一个或两个字符，那将是一个匹配” - 与您的问题中的第 3 点相同。

有关更多信息，请参见[http://pypi.python.org/pypi/regex](http://pypi.python.org/pypi/regex)（查找“近似“模糊”匹配”）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:08:46.443

我说不出你真正想要什么。您是否想了解增量匹配？

也许您需要学习正确使用锚点。就像你永远不应该使用 Java 错误命名和欺骗性`matches`的方法来代替它的`find`方法一样，你应该避免使用 Python 的`match`方法来支持 .`search`并且出于完全相同的原因。

另一种可能性是使用可选部分重写您的模式，然后您可以检查其是否成功。

或者也许你应该研究一下[Matthew Barnett 的替换`regex`库](http://pypi.python.org/pypi/regex)中的模糊匹配支持，你**真的**应该使用它而不是笨拙的旧的`re`。

我无法说出您真正要问的是什么，因为您没有给出所需输入和输出的示例。

## 编辑

也许您不需要比 更复杂`(?=.*(?:ab|bc)).*a?b?c?`或间隔的东西：

```
 (?x)
 (?= .* (?: ab | bc) )
 .*
 a? b? c? 
```

如果将`a`、`b`和`c`放入可递归子组中，您甚至不必重复自己。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-20T14:36:56.707

如果我错了，请纠正我，我相信最初的问题是：对于某些正则表达式和输入字符串，如果输入字符串可能匹配（即，在字符串末尾添加更多字符可以使其匹配）。

因此，模糊匹配不是答案，因为：

rgx = regex.compile('(abcdef){d<5}')

str = 'bcd'

也将是一场比赛

Boost C++ 库（也适用于 Java/Javascript？）提供了这样一个选项： http: [//www.boost.org/doc/libs/1_31_0/libs/regex/doc/partial_matches.html](http://www.boost.org/doc/libs/1_31_0/libs/regex/doc/partial_matches.html)

那么有谁知道在 Python 中实现这一目标的最佳方法是什么？

# ios - UITableViewCells 中的颜色没有变化

> ID：10032790
> 
> 赞同：0
> 
> 时间：2012-04-05T16:56:37.013
> 
> 标签：ios, uitableview

我有一个包含 200 多个单元格的 UITable。该表与来自网络的数据完美配合。现在我需要添加一种方法来更改标签的背景颜色以与数据匹配（如果值减少则为红色，如果值增加则为绿色）。最初这似乎效果很好，但过了一段时间，即使值更新正常，颜色也会变成静态。下面是我在 layoutSubviews 方法中的代码示例：

**更新**

我更新了代码以显示我的表格。请注意，数据被完美地分配给单元格。无论值是多少，几分钟后单元格的颜色都不会改变。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
        UILabel* label = [[UILabel alloc] initWithFrame:self.contentView.bounds];
        label.tag = 1;
        [cell.contentView addSubview:label];
        [label release];
    }
    UILabel *label = (UILabel*)[cell viewForTag:1];
    float value = [label.text floatValue];
    float newValue = [dataSource objectAtIndex:indexPath.row];

    // Get the current value of the cell and compare it with the new value
    if(value < newVal)
    {
        label.backgroundColor = [UIColor greenColor];
    }
    else if(value > newVal)
    {
        label.backgroundColor = [UIColor redColor];
    }
    label.text = [NSString stringWithFormat:@"%d", newValue];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:29:33.473

设置单元格的背景颜色将不起作用，因为在它上面还有另一个视图，它的 contentView。由于 iOS 像画家的画布一样处理绘图，因此 contentView 会阻碍您对单元格背景所做的任何更改。但是，您可以在 contentView 上设置背景颜色（毕竟它是一个 UIView），您应该会看到绿色和红色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:37:28.523

好吧，这可能是因为 deQueue，您可以尝试在向单元格添加新子视图之前运行一个循环并从中删除所有子视图。确保您在检查空单元格的条件后执行此操作。

```
for(UIView *subview in cell.subviews){
  [subview removeFromSuperview];
} 
```

可能有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T21:04:56.463

您正在将数据源中的值与单元格中先前显示的值进行比较。

这不会是一个有效的比较。您将拥有大约 8 或 10 个单元格实例，这些实例已出列并重用。因此，您将比较单元格 60 的数据源与该单元格中使用的最后一个值，该值可能来自第 45 行。这是没有意义的。

您需要将旧值存储在数据源中的某个位置，然后与之进行比较。

# iphone - 选择器视图列表更新时如何调用函数？

> ID：10032792
> 
> 赞同：0
> 
> 时间：2012-04-05T16:56:45.697
> 
> 标签：iphone, objective-c, ios, uipickerview

我有一个pickerview。
每次列表更改（添加或删除项目）时，我都想调用一个特定的函数。
我怎么能做到这一点？我尝试了一些 IB 操作，但无法触发该功能。

**额外**：

以下是有关该项目的更多信息，以防万一您有更好的主意：

我有一个 ViewController，它有一个选择器视图。
我有一个视图，点击一个按钮，就会调用一个 DataHolder 类，它将一个项目添加到字典中。
该字典链接到选取器视图，选取器视图会更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:35:37.257

我想你正在寻找`[pickerView reloadAllComponents];`

这将重新加载选择器视图的所有组件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:00:26.057

利用

```
-(void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
some method;
} 
```

# php - Yii 中的关系

> ID：10032798
> 
> 赞同：1
> 
> 时间：2012-04-05T16:57:16.777
> 
> 标签：php, yii

我有状态模型

```
 <?php

/**
 * This is the model class for table "status".
 *
 * The followings are the available columns in table 'status':
 * @property integer $status_id
 * @property string $message
 * @property string $created
 * @property integer $thumbs_up
 * @property integer $thumbs_down
 * @property string $reply
 * @property integer $user_id
 *
 * The followings are the available model relations:
 * @property Comment[] $comments
 * @property User $user
 * @property ThumbUpDown[] $thumbUpDowns
 */
class Status extends CActiveRecord {

    /**
     * Returns the static model of the specified AR class.
     * @param string $className active record class name.
     * @return Status the static model class
     */
    public static function model($className = __CLASS__) {
        return parent::model($className);
    }

    /**
     * @return string the associated database table name
     */
    public function tableName() {
        return 'status';
    }

    /**
     * @return array validation rules for model attributes.
     */
    public function rules() {
        // NOTE: you should only define rules for those attributes that
        // will receive user inputs.
        return array(
            array('message, created', 'required'),
            array('thumbs_up, thumbs_down, user_id', 'numerical', 'integerOnly' => true),
            array('message', 'length', 'max' => 255),
            array('reply', 'length', 'max' => 45),
            // The following rule is used by search().
            // Please remove those attributes that should not be searched.
            array('status_id, message, created, thumbs_up, thumbs_down, reply, user_id', 'safe', 'on' => 'search'),
        );
    }

    /**
     * @return array relational rules.
     */
    public function relations() {
        // NOTE: you may need to adjust the relation name and the related
        // class name for the relations automatically generated below.
        return array(
            'comments' => array(self::HAS_MANY, 'Comment', 'status_id'),
            'user' => array(self::BELONGS_TO, 'Register', 'user_id'),
            'thumbUpDowns' => array(self::HAS_MANY, 'Thumb_up_down', 'status_id'),
        );
    }

    /**
     * @return array customized attribute labels (name=>label)
     */
    public function attributeLabels() {
        return array(
            'status_id' => 'Status',
            'message' => 'Message',
            'created' => 'Created',
            'thumbs_up' => 'Thumbs Up',
            'thumbs_down' => 'Thumbs Down',
            'reply' => 'Reply',
            'user_id' => 'User',
        );
    }

    /**
     * Retrieves a list of models based on the current search/filter conditions.
     * @return CActiveDataProvider the data provider that can return the models based on the search/filter conditions.
     */
    public function search() {
        // Warning: Please modify the following code to remove attributes that
        // should not be searched.

        $criteria = new CDbCriteria;

        $criteria->compare('status_id', $this->status_id);
        $criteria->compare('message', $this->message, true);
        $criteria->compare('created', $this->created, true);
        $criteria->compare('thumbs_up', $this->thumbs_up);
        $criteria->compare('thumbs_down', $this->thumbs_down);
        $criteria->compare('reply', $this->reply, true);
        $criteria->compare('user_id', $this->user_id);

        return new CActiveDataProvider($this, array(
                    'criteria' => $criteria,
                ));
    }

    public function getUrl() {
        return Yii::app()->createUrl('status', array(
                    'id' => $this->status_id,
                    'title' => $this->message,
                ));
    }

    public function addComment($comment) {
        $comment->status_id = $this->status_id;
        $comment->user_id = Yii::app()->user->id;
        $comment->created = date('Y-m-d H:i:s');
        return $comment->save();
    }

} 
```

注册模型

```
 <?php

/**
 * This is the model class for table "user".
 *
 * The followings are the available columns in table 'user':
 * @property integer $user_id
 * @property string $username
 * @property string $password
 * @property string $name_first
 * @property string $name_last
 * @property string $email
 * @property string $picture
 * @property integer $active
 * @property string $created
 */
class Register extends CActiveRecord {

    /**
     * Returns the static model of the specified AR class.
     * @param string $className active record class name.
     * @return Register the static model class
     */
    public static function model($className = __CLASS__) {
        return parent::model($className);
    }

    /**
     * @return string the associated database table name
     */
    public function tableName() {
        return 'user';
    }

    /**
     * @return array validation rules for model attributes.
     */
    public function rules() {
        // NOTE: you should only define rules for those attributes that
        // will receive user inputs.
        return array(
            //array('username, password, name_first, name_last, email, active, created', 'required'),
            array('username, password, name_first, name_last, email', 'required'),
            array('active', 'numerical', 'integerOnly' => true),
            array('username, password, name_first, name_last', 'length', 'max' => 45),
            array('email', 'length', 'max' => 100),
            array('picture', 'length', 'max' => 255),
            // The following rule is used by search().
            // Please remove those attributes that should not be searched.
            array('user_id, username, name_first, name_last, email, active', 'safe', 'on' => 'search'),
        );
    }

    /**
     * @return array relational rules.
     */
    public function relations() {
        // NOTE: you may need to adjust the relation name and the related
        // class name for the relations automatically generated below.
        return array(
            'friends' => array(self::HAS_MANY, 'Friend', 'user_id'),
            'friendLists' => array(self::HAS_MANY, 'FriendList', 'user_id'),
            'notifications' => array(self::HAS_MANY, 'Notification', 'user_id'),
            'profiles' => array(self::HAS_MANY, 'Profile', 'user_id'),
            'statuses' => array(self::HAS_MANY, 'Status', 'user_id'),
        );
    }

    /**
     * @return array customized attribute labels (name=>label)
     */
    public function attributeLabels() {
        return array(
            'user_id' => 'User',
            'username' => 'Username',
            'password' => 'Password',
            'name_first' => 'Name First',
            'name_last' => 'Name Last',
            'email' => 'Email',
            'picture' => 'Picture',
            'active' => 'Active',
            'created' => 'Created',
        );
    }

    /**
     * Retrieves a list of models based on the current search/filter conditions.
     * @return CActiveDataProvider the data provider that can return the models based on the search/filter conditions.
     */
    public function search() {
        // Warning: Please modify the following code to remove attributes that
        // should not be searched.

        $criteria = new CDbCriteria;

        $criteria->compare('user_id', $this->user_id);
        $criteria->compare('username', $this->username, true);
        //$criteria->compare('password', $this->password, true);
        $criteria->compare('name_first', $this->name_first, true);
        $criteria->compare('name_last', $this->name_last, true);
        $criteria->compare('email', $this->email, true);
        //$criteria->compare('picture', $this->picture, true);
        $criteria->compare('active', $this->active);
        //$criteria->compare('created', $this->created, true);

        return new CActiveDataProvider($this, array(
                    'criteria' => $criteria,
                ));
    }

// encrypt password
    public function beforeSave() {
        $this->created = date('Y-m-d H:i:s');
        $this->password = md5($this->password);
        $this->active = 1;
        $this->picture = '';
        return true;
    }

} 
```

我想通过 echo $data->user->username 获取 Status 的用户名，但我有一个错误**Trying to get property of non-object** at $data->user->username 我需要你的帮助。感谢提前！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T16:59:43.707

看起来 user 是一个数组。尝试`$data->user['username']`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:07:39.650

使用标准的'with'属性，如下所示：

```
$criteria->with = array('user'). 
```

它比延迟加载更好。检查这个[http://www.yiiframework.com/doc/guide/1.1/en/database.arr#relational-query-performance](http://www.yiiframework.com/doc/guide/1.1/en/database.arr#relational-query-performance)。如果你能在你使用$data->user->username的地方提供更多代码会更好，我猜它是gridview？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:10:19.090

此错误（尝试获取非对象的属性）意味着“用户”表中没有 id 字段值等于 $data->user_id 的记录。

检查 $data->user_id 的值并确保它存在于“user”表的 id 字段中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-06T12:43:29.417

尝试将您的`Status`模型关系字符串更改为：

```
'user' => array(self::BELONGS_TO, 'Register', array('user_id' => 'user_id)), 
```

希望它会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-05T18:32:51.113

你应该可以`print_r($data)`用来查看变量的内部结构。那么您将对如何使用变量有意见。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-18T11:13:36.873

希望这可以帮助你

```
$data["user"]["username"] 
```

# salesforce - 如何从流中获取变量？

> ID：10032799
> 
> 赞同：1
> 
> 时间：2012-04-05T16:57:16.810
> 
> 标签：salesforce, apex-code, visualforce, flow

我在 SalesForce 中有一个流，它创建一个新的对象记录并填充其字段。`vAddendumId`然后我在流程中设置了一个变量。我希望能够`Id`在相应的 VisualForce 页面控制器上引用它，但我遇到了问题。我知道如何通过 URL“get”将变量从我的页面放入流中，但我无法弄清楚相反的方向。

这是我现在在 URL 字符串中分配`Opportunity Id`from的代码：`oid`

## 视觉力量页面：

```
<apex:page Controller="AddendumEntryController" TabStyle="Addendum__c">
    <flow:interview name="Addendum_Entry" finishLocation="{!backToAddendum}" >
        <apex:param name="vOpportunityId" value="{!opptyId}"/>
    </flow:interview>
</apex:page> 
```

## 控制器：

```
public with sharing class AddendumEntryController {

    public ID getoppId = System.currentPagereference().getParameters().get('oid');
    public Flow.Interview.Addendum_Entry AddendumEntryFlow{get;set;}

    public String getOpptyId(){ return getoppId; }

    public PageReference getBackToAddendum(){

        PageReference send = new PageReference('/' + getaddendumId);
        send.setRedirect(true);
        return send;

    }

} 
```

我的最终目标是在流程完成后将用户发送到新创建的对象记录。这意味着我需要`getaddendumId`使用流中的 id 进行填充。

提前感谢您提供的任何帮助！

## 编辑 - 加法

我又尝试了几件事，其中一件似乎很有希望，但仍然抛出错误。我尝试将变量设置为`AddendumEntryFlow.vAddendumId`. 这给出了一个关于取消引用空对象的错误。我相信这是因为`vAddendumId`直到流程的后期才设置，但我不能确定。

```
public Flow.Interview.Addendum_Entry AddendumEntry{get;set;}
public ID getaddendumId = AddendumEntry.vAddendumId; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:17:15.823

经过大量的摆弄，我找到了解决方案。我需要`interview`在页面上设置属性，以便我可以从其内容中提取值。然后我需要做的就是从`AddendumEntry.vAddendumId`.

# 最终代码

## 附录Entry.page

```
<apex:page Controller="AddendumEntryController" TabStyle="Addendum__c">
    <flow:interview name="Addendum_Entry" interview="{!AddendumEntry}" finishLocation="{!backToAddendum}" >
        <apex:param name="vOpportunityId" value="{!opptyId}"/>
    </flow:interview>
</apex:page> 
```

## 附录EntryController.cls

```
public with sharing class AddendumEntryController {

    public ID getoppId = System.currentPagereference().getParameters().get('oid');
    public Flow.Interview.Addendum_Entry AddendumEntry{get;set;}

    public String getOpptyId(){ return getoppId; }
    public ID returnId = getoppId;

    public PageReference getBackToAddendum(){

        if(AddendumEntry != null) returnId = AddendumEntry.vAddendumId;

        PageReference send = new PageReference('/' + returnId);
        send.setRedirect(true);
        return send;

    }

} 
```

事实证明这很简单。我之前的尝试失败的唯一原因是我没有`interview="{!AddendumEntry}"`在页面上设置。

# c# - C# 中的 String.Join 性能问题

> ID：10032805
> 
> 赞同：13
> 
> 时间：2012-04-05T16:57:37.407
> 
> 标签：c#, .net, string, string-concatenation

我一直在研究向我提出的一个问题：如何编写一个将字符串作为输入并返回字符之间有空格的字符串的函数。编写该函数以在每秒调用数千次时优化性能。

1.  我知道 .net 有一个名为 的函数`String.Join`，我可以将空格字符作为分隔符与原始字符串一起传递给该函数。

2.  除非使用 ，否则`String.Join`我可以使用`StringBuilder`该类在每个字符后附加空格。

3.  完成此任务的另一种方法是声明一个包含 2*n-1 个字符的字符数组（您必须为空格添加 n-1 个字符）。字符数组可以在循环中填充，然后传递给 String `constructor`。

我已经编写了一些 .net 代码，它们使用参数运行这些算法中的每一个一百万次，`"Hello, World"`并测量执行所需的时间。方法 (3) 比 (1) 或 (2) 快得多。

我知道（3）应该非常快，因为它避免了创建任何额外的字符串引用来进行垃圾收集，但在我看来，内置的 .net 函数（例如）`String.Join`应该会产生良好的性能。为什么使用`String.Join`比手工工作慢得多？

```
public static class TestClass
{
    // 491 milliseconds for 1 million iterations
    public static string Space1(string s) 
    {            
        return string.Join(" ", s.AsEnumerable());
    }

    //190 milliseconds for 1 million iterations
    public static string Space2(string s) 
    {
        if (s.Length < 2)
            return s;
        StringBuilder sb = new StringBuilder();
        sb.Append(s[0]);
        for (int i = 1; i < s.Length; i++)
        {
            sb.Append(' ');
            sb.Append(s[i]);
        }            
        return sb.ToString();
    }

    // 50 milliseconds for 1 million iterations
    public static string Space3(string s) 
    {
        if (s.Length < 2)
            return s;
        char[] array = new char[s.Length * 2 - 1];
        array[0] = s[0];
        for (int i = 1; i < s.Length; i++)
        {
            array[2*i-1] = ' ';
            array[2*i] = s[i];
        }
        return new string(array);
    } 
```

**更新：**我已将我的项目更改为“发布”模式，并相应地更新了我在问题中的经过时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-14T17:30:25.237

> 为什么使用 String.Join 比手动工作慢得多？

*在这种情况下*`String.Join`速度较慢的原因是您可以编写一个算法，该算法具有先验知识的确切性质。*`IEnumerable<T>`*

 *[`String.Join<T>(string, IEnumerable<T>)`](http://msdn.microsoft.com/en-us/library/dd992421)另一方面，（您正在使用的重载）旨在与任意可枚举类型一起使用，这意味着它无法预先分配到适当的大小。在这种情况下，它是用灵活性换取纯粹的性能和速度。

许多框架方法确实处理了某些可以通过检查条件来加快速度的情况，但这通常只在“特殊情况”很常见时才会这样做。

在这种情况下，您实际上是在创建一个手写例程会更快的边缘案例，但这不是`String.Join`. 在这种情况下，由于您事先确切地知道需要什么，因此您可以通过预先分配一个大小正好合适的数组并手动构建结果来避免进行灵活设计所需的所有开销。

您会发现，一般来说，通常*可以*编写一个方法来执行*特定输入数据*的某些框架例程。这很常见，因为框架例程必须与任何数据集一起使用，这意味着您无法针对特定的输入场景进行优化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T17:08:44.577

您的`String.Join`示例适用于`IEnumerable<char>`. 枚举`IEnumerable<T>`with`foreach`通常比执行`for`循环慢（这取决于集合类型和其他情况，正如 Dave Black 在评论中指出的那样）。即使`Join`使用 a `StringBuilder`， 的内部缓冲区`StringBuilder`也必须增加数倍，因为要附加的项目数是事先不知道的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-05T17:07:35.743

由于您没有使用 Release 构建（默认情况下应该检查优化）和/或您正在通过 Visual Studio 进行调试，因此将阻止 JITer 进行大量优化。因此，您只是无法很好地了解每个操作真正需要多长时间。添加优化后，您可以了解正在发生的事情的真实情况。

不要在 Visual Studio 中进行调试也很重要。转到 bin/release 文件夹并完全在 Visual Studio 之外双击可执行文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T17:28:16.093

在您的第一个方法中，您使用的`String.Join`是对 Enumerable 进行操作的重载，这要求该方法使用枚举器遍历字符串的字符。在内部，这使用 a `StringBuilder`，因为确切的字符数是未知的。

您是否考虑过使用`String.Join`带字符串（或字符串数​​组）的重载？该实现允许使用固定长度的缓冲区（类似于您的第三种方法）以及一些内部不安全的字符串操作以提高速度。电话将更改为 - `String.Join(" ", s);` 在没有实际进行测量的情况下，我希望这与您的第三种方法相当或更快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T17:12:34.283

糟糕的表现不是来自`String.Join`，而是来自你处理每个角色的方式。在这种情况下，由于必须单独处理字符，因此您的第一种方法将创建更多的中间字符串，而第二种方法会`.Append`为每个字符调用两次方法。您的第三种方法不涉及大量中间字符串或方法调用，这就是您的第三种方法最快的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T17:14:24.257

当您传递一个`IEnumerable`to 时`String.Join`，它不知道需要分配多少内存。我分配了一块内存，如果它不够，则调整它的大小并重复该过程，直到它获得足够的内存来容纳所有字符串。

数组版本更快，因为我们提前知道分配的内存量。

另外请注意，当您运行第一个版本时，可能会发生 GC。*

# c# - 如何防止 Type.GetProperties() 访问对象中的属性

> ID：10032807
> 
> 赞同：1
> 
> 时间：2012-04-05T16:57:46.543
> 
> 标签：c#, reflection, attributes

我使用 mass.cs 作为 DAL，但我创建的模型包含子项列表。

问题是我想不出一个好方法来隐藏这些`GetProperties()`。Massive 使用它来创建 expando 对象，并且没有进行大量编辑，我想不出隐藏这些属性的好方法。有没有属性或类似的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:10:31.650

Massive 使用[不带参数的 GetProperties() 重载](http://msdn.microsoft.com/en-us/library/aky14axb.aspx)(massive.cs:76)。根据文档，该方法“返回当前类型的所有公共属性”。

此外，“如果一个属性至少有一个公开的访问器，则该属性被视为对反射公开。” 所以只要确保 getter 和 setter 是私有的，或者是显式的接口实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:04:58.003

听起来你想隐藏一些代码？如果是这样，您必须将修饰符更改为`internal`或`private`从我假设的`public`. 否则，您可以添加一个密钥，以便其他人无法通过混淆使用您的代码......但是，据我所知，没有完美的方法来隐藏您的代码......

# python - 如何使用数据类型（日期时间，浮点数）制作一个 numpy 重新数组？

> ID：10032809
> 
> 赞同：7
> 
> 时间：2012-04-05T16:57:59.100
> 
> 标签：python, numpy, recarray

假设我有一些简单的数据

```
y = [[datetime.datetime( 2012,1,1,1,1), 2.1], 
     [datetime.datetime( 2012,1,1,1,2), -3.1],
     [datetime.datetime( 2012,1,1,1,3), 0.1]] 
```

我想要一个与之对应的numpy记录数组。看来我应该能够做到这一点：

```
np.rec.array( y, dtype=[('timestamp', object),('x','f')] ) 
```

或这个

```
np.rec.array( y, dtype=[('timestamp', '|O8'),('x','f')] ) 
```

或者也许这个

```
np.rec.array( y, dtype=[('timestamp', 'V'),('x','f')] ) 
```

但是他们每个人都返回一个错误，要么

```
ValueError: Setting void-array with object members using buffer. 
```

或者

```
TypeError: expected a readable buffer object 
```

那么，假设甚至有可能，我该如何设置呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T17:28:33.553

您可以对记录使用元组而不是列表：

```
>> y = [(datetime.datetime( 2012,1,1,1,1), 2.1), 
...     (datetime.datetime( 2012,1,1,1,2), -3.1),
...     (datetime.datetime( 2012,1,1,1,3), 0.1)]
>> np.rec.array(y, dtype=[('timestamp', object), ('x','f')])
rec.array([(datetime.datetime(2012, 1, 1, 1, 1), 2.0999999046325684),
           (datetime.datetime(2012, 1, 1, 1, 2), -3.0999999046325684),
           (datetime.datetime(2012, 1, 1, 1, 3), 0.10000000149011612)],
dtype=[('timestamp', '|O8'), ('x', '<f4')]) 
```

# design-patterns - 这种带闭包的模式有名称吗？

> ID：10032810
> 
> 赞同：5
> 
> 时间：2012-04-05T16:58:01.847
> 
> 标签：design-patterns, language-agnostic, groovy, closures, terminology

我经常看到在我们需要在访问对象之前执行查找代码的情况下使用一种模式。使用此模式时，通常以单词开头`with`。

例如，我们需要先从数据库中检索客户记录，然后才能使用它们：

```
def withCustomer (id, closure) {
    def customer = getCustomer(id)
    closure(customer)
}

withCustomer(12345) { customer ->
    println "Found customer $customer.name"
} 
```

Groovy 在闭包和匿名函数之间没有这样的区别。也许，我可以问一下这种模式是否有匿名函数的名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T17:47:19.957

这就是策略模式。闭包包含一些要作为参数传递给函数的行为，以便函数可以接受不同的行为。请参阅 Peter Norvig 的演示[动态语言中的设计模式](http://norvig.com/design-patterns/ppframe.htm)：

> 策略是一个变量，其值为一个函数（例如，对于一等函数，模式是不可见的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:08:17.903

在 Groovy 的[闭包 - 正式定义](http://groovy.codehaus.org/Closures+-+Formal+Definition)中，它只是称为“**将闭包传递给方法**”。

Groovy 有一个特殊情况，用于将闭包定义为方法参数，以使闭包语法更易于阅读。具体来说，如果方法的最后一个参数是闭包类型，您可以使用括号外的显式闭包块调用该方法。例如，如果一个类有一个方法：

```
class SomeCollection {
    public void each ( Closure c )
} 
```

然后您可以在括号外使用闭包定义调用 each()：

```
SomeCollection stuff = new SomeCollection();
stuff.each() { println it } 
```

也可以使用更传统的语法，还要注意，在 Groovy 中，您可以在许多情况下省略括号，因此这两种变体也是合法的：

```
SomeCollection stuff = new SomeCollection();

stuff.each { println it }       // Look ma, no parens
stuff.each ( { println it } )   // Strictly traditional 
```

即使该方法有其他参数，同样的规则也适用。唯一的限制是闭包参数必须是最后一个：

```
class SomeCollection {
  public void inject ( x, Closure c )
}

stuff.inject( 0 ) { count, item -> count + item  }     // Groovy
stuff.inject( 0, { count, item -> count + item  } )    // Traditional 
```

* * *

这可能与“Groovy 问题”无关，但例如在 Scala 中，这种“形式”是**函数柯里**化的特例：

```
scala> def fun[A, B](a: A)(b: B) = {true}
fun: [A, B](a: A)(b: B)Boolean

scala> fun(1){2}
res59: Boolean = true 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T17:35:32.267

这取决于上下文。它可以是一种策略模式（参见 Nathan Hughes 的回答）。它可以是模板方法模式。

Arturo 的例子似乎是一个模板方法。您定义通用算法步骤（在这种情况下获取客户）和自定义（作为闭包传递）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-24T21:43:07.417

最后，我认为这种模式称为**Loan Pattern**。

贷款模式，确保一旦超出范围，资源就会被确定性地处置。

您可以在此处查看有关此模式的一些信息：

*   [“贷款”模式](https://wiki.scala-lang.org/display/SYGN/Loan)- Scala
*   [借用我的资源模式](http://groovy.codehaus.org/Loan+my+Resource+Pattern)- Groovy

# postgresql - heroku sql语句上的postgres失败

> ID：10032811
> 
> 赞同：0
> 
> 时间：2012-04-05T16:58:07.230
> 
> 标签：postgresql, heroku

我刚刚将我的`node.js`应用程序上传到 heroku，我的一个 sql 查询失败了。查询是：

```
INSERT INTO countries (name, user_id, created_timestamp)
SELECT $1, $2, CURRENT_TIMESTAMP
WHERE NOT EXISTS (SELECT 1 FROM countries WHERE name = $1 FOR UPDATE) 
```

它失败了

> 错误：子查询中不允许 SELECT FOR UPDATE/SHARE

有谁知道为什么？如果我无法选择更新，是否可以使用解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:31:28.107

这可能对您有用：

```
BEGIN;

LOCK TABLE countries IN SHARE MODE;

INSERT INTO countries (name, user_id, created_timestamp)
SELECT $1, $2, CURRENT_TIMESTAMP
WHERE NOT EXISTS (SELECT * FROM countries WHERE name = $1);

COMMIT; 
```

[这个密切相关的答案中的解释和链接。](https://stackoverflow.com/a/9717323/939860)

# python - 如何将python包构建成exe

> ID：10032813
> 
> 赞同：1
> 
> 时间：2012-04-05T16:58:32.460
> 
> 标签：python, py2exe, pyinstaller

我已经用python编写了我的程序。它是跨七个文件编写的，在其中三个文件中我导入了一个自定义包。问题是我无法将我的程序构建成 exe。我试过 pyinstaller 1.5.1 和 py2exe。我已经按照我能找到的所有教程进行操作，但没有成功。每次我尝试运行创建的 exe 时，都会收到一条错误消息，说它找不到我的自定义包。我想我只是无法将完整的包构建到 exe 中。请帮忙。

```
from distutils.core import setup
import py2exe, sys, os
sys.argv.append('py2exe')

mfcfiles = [os.path.join(mfcdir, i) for i in ["mfc90.dll", "mfc90u.dll", "mfcm90.dll", "mfcm90u.dll", "Microsoft.VC90.MFC.manifest"]]

data_files = [("Microsoft.VC90.MFC", mfcfiles),]

setup(
    data_files = data_files,
    options = {'py2exe': {'optimize': 2}},
    windows = [{'script': "LoadFilesGUI.py"}],
    zipfile = "shared.lib",
) 
```

其他：

```
from distutils.core import setup
import py2exe, sys, os

sys.argv.append('py2exe')

setup(
    options = {'py2exe': {'optimize': 2}},
    windows = [{'script': "LoadFilesGUI.py"}],
    zipfile = None,
    console=['LoadFilesGUI.py'],
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:13:48.623

通过“自定义包”，我假设您的意思是构成您的应用程序的自定义 python 模块。我可能会建议尝试使用 setup() 调用的“包含”选项来手动指定应该包含的 python 模块，以防它们未被自动发现：

```
setup( 
    windows = [{'script': "LoadFilesGUI.py"}], 
    data_files = data_files, 
    zipfile = None, 
    options = {
        'py2exe': {
            'optimize': 2, 
            'bundle_files': 1,
            'includes' : [],
        }
    }, 
) 
```

例如，在我使用 PyQt4 的项目中，我的包含如下所示：

```
options={ 
    "py2exe": { 
        "includes" : ['sip','PyQt4.QtCore','PyQt4.QtGui',
                        'PyQt4.QtNetwork','PyQt4.QtWebKit'] 
    } 
} 
```

setup.py 脚本的其余部分似乎很标准。确保您包含的模块是 PYTHONPATH 的一部分，或者与您的项目相关，或者明确添加到路径中。

如果，正如您在评论中所述，`MyPackage`是您项目中的一个包，那么您需要： `'includes' : ['MyPackage']`

如果这仍然给您带来错误，那么问题可能出在您的项目和包的结构上，或者再次出在您的 PYTHONPATH 上

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:30:41.823

cx_freeze 就是答案。

根据我的经验是最可靠的选择。有时它会丢失一些依赖项，但是一旦发现缺少的内容，您就可以轻松地手动添加它。

# jsp - 如何找到将包含在 cq:includeClientLib 标记中的文件？

> ID：10032814
> 
> 赞同：3
> 
> 时间：2012-04-05T16:58:34.237
> 
> 标签：jsp, tags, adobe, aem

我正在处理 Adob​​e CQ5 中的 JSP。在我不太熟悉的其中一个 JSP 中，有一个 CQ **[includeClientLib](http://dev.day.com/docs/en/cq/current/howto/taglib.html#%3Ccq%3aincludeClientLib%3E)**标记，它在页面上包含一个 CQ 客户端库：

```
<cq:includeClientLib categories="someCategory"/> 
```

**如何确定/查找将包含在此参考中的所有文件？** 本质上，我需要在 CQ 存储库中找到所有 cq:ClientLibraryFolder 节点，这些节点具有定义为“someCategory”值的“categories”属性。我已经在 Content Explorer 和 CRXDE Lite 中进行了搜索，但是即使它们不是带有“categories”属性标记的 ClientLibraryFolders，它们也会找到“someCategory”的所有匹配项，而且在我的情况下，误报太多了手动筛选。所以我正在寻找一种方法来过滤匹配只包含在这个标签中的那些。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T18:58:27.163

您可以通过访问目标 CQ 实例的 UR [http://&HOST%:%PORT%/libs/cq/ui/content/dumplibs.html](http://&HOST%:%PORT%/libs/cq/ui/content/dumplibs.html)来获取所有客户端库信息的列表。向下滚动到“按类别分类的库”部分以查看使用每个类别的所有 cq:ClientLibraryFolder 路径。

示例：[http://localhost:4502/libs/cq/ui/content/dumplibs.html](http://localhost:4502/libs/cq/ui/content/dumplibs.html)

# javascript - 当主干.js 中的视图更改时自动更改模型字段

> ID：10032816
> 
> 赞同：3
> 
> 时间：2012-04-05T16:59:05.857
> 
> 标签：javascript, backbone.js

我有一个弹出窗口，里面有很多可以编辑的选项——这是一个主干视图。我有一个存储这些选项的简单 POCO 模型。编写每个视图事件处理程序来更新模型的相应值是相当困难的。

当视图字段发生变化时，如何自动更新模型？

假设我有`Name`对应于`model.name`. `model.name`当我在文本框中输入新名称时，我需要自动更新。是否可以？

我知道这种方式不会是mvc，而是mvvm，也许这里用knockout.js会更好，但是我已经有一些backbone的代码，所以希望可以找到一些解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:09:38.457

您可以使用[Backbone Forms](https://github.com/powmedia/backbone-forms)管理您的表单以对更新进行建模。

此插件将允许您在相关视图字段发生更改时自动更新模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:02:54.110

从视图内部，您只需用 this 重新声明它。`this.model = SomeOtherModel;`

# jsf - 使用“绑定”在 JSF 中生成列表小部件

> ID：10032818
> 
> 赞同：0
> 
> 时间：2012-04-05T16:59:25.920
> 
> 标签：jsf, primefaces

我有一个需要在屏幕上呈现的对象列表，“想想可拖动的面板”。这些面板中的每一个都有自己的材质，需要在其中进行渲染。我最初的想法是做类似的事情

```
<ui:repeat value="#{bean.widgets} var="widget">
    <p:panel binding="#{widget.contents}/>
</ui:repeat> 
```

现在这可能由于多种原因而行不通。我知道的一个是“var”只是请求范围。所以，虽然我可以访问我的“小部件”java 对象中的字段值，但我不能直接调用一个方法来绑定我的面板。

任何人都可以提供方向吗？

当前运行 PrimeFaces 3.2 | 玻璃鱼 3.1.2 | 莫哈拉 2.1.6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:05:31.763

该`binding`属性是在视图构建期间评估的，而该`<ui:repeat var>`属性是在视图渲染期间评估的，因此它确实是`null`在`<p:panel>`发现和构建的时候。

使用 JSTL`<c:forEach>`代替`<ui:repeat>`（并修复缺少的引号）：

```
<c:forEach items="#{bean.widgets}" var="widget">
    <p:panel binding="#{widget.contents}/>
</c:forEach> 
```

通过这种方式，您实际上还可以在物理上生成多个`<p:panel>`组件，而不是只生成一个多次渲染的组件。

然而，使用 JSTL 可能有其他注意事项，具体取决于问题中尚不清楚的总体情况。另请参阅[JSF2 Facelets 中的 JSTL... 有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)

# php - 在数组数组上使用 PHP 的 array_reverse()，得到奇怪的行为。为什么？

> ID：10032819
> 
> 赞同：1
> 
> 时间：2012-04-05T16:59:36.540
> 
> 标签：php, arrays, multidimensional-array

所以，[`array_reverse()`](http://php.net/array_reverse)应该采用一个数组，并以相反的顺序返回一个包含元素的副本，并且它一直为我忠实地工作，直到今天。我有一个数组数组，我需要以相反的顺序获取它们，所以我假设 array_reverse 会完全满足我的需要，但它的行为似乎很奇怪，我不知道为什么。

我的初始数组（是的，我正在做一些 HTML 解析）：

```
Array(
    0 => Array(
        0 => '<blockquote',
        1 => int 232
    ),
    1 => Array(
        0 => '<blockquote',
        1 => int 593
    ),
    2 => Array(
        0 => '<blockquote',
        1 => int 938
    ),
    3 => Array(
        0 => '</blockquote',
        1 => int 2627
    ),
    4 => Array(
        0 => '</blockquote',
        1 => int 2758
    ),
    5 => Array(
        0 => '</blockquote',
        1 => int 2794
    ),
) 
```

在它上面运行`array_reverse($arr)`，人们会期望返回的数组是：

```
Array (
    0 => Array(
        0 => '</blockquote',
        1 => int 2794
    ),
    1 => Array(
        0 => '</blockquote',
        1 => int 2758
    ),
    2 => Array(
        0 => '</blockquote',
        1 => int 2627
    ),
    3 => Array(
        0 => '<blockquote',
        1 => int 938
    ),
    4 => Array(
        0 => '<blockquote',
        1 => int 593
    ),
    5 => Array(
        0 => '<blockquote',
        1 => int 232
    ),
) 
```

但是，它返回一个未更改的数组。现在，如果我这样做`array_reverse($arr[0])`，那么它会像我想要的那样反转整个数组。

我想不出它不会反转初始数组的原因，以及为什么在传递特定键时它会反转整个数组，而不是那个子数组。为什么会这样做？

**编辑：**我走开回来，看了看，意识到主数组有一个元素，就是我在上面发布的数组。只是一个很好的 ID-10-T 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:06:20.430

> 但是，它返回一个未更改的数组。

[它应该可以正常工作](http://codepad.org/68nDM11F)。

> 现在，如果我这样做`array_reverse($arr[0])`，那么它会像我想要的那样反转整个数组。

您确定您的阵列中没有额外的级别吗？我很确定你有一个额外的水平！

# html - 单击后消失的 HTML 默认文本字段

> ID：10032821
> 
> 赞同：0
> 
> 时间：2012-04-05T16:59:48.650
> 
> 标签：html

我一直在寻找我应该使用的属性，以便为文本字段设置默认文本，但是一旦用户单击文本字段，这个默认文本就会消失。我希望我能很好地解释自己，

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:01:33.547

在html5中，有`placeholder`

否则，有一些 jQuery 库可以做到这一点

[https://github.com/danielstocks/jQuery-Placeholder](https://github.com/danielstocks/jQuery-Placeholder)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:04:18.537

在没有 javascript 的旧浏览器上没有办法做到这一点。一个很好的方法是使用 j [Query 水印插件](http://code.google.com/p/jquery-watermark/)。

# java - Lucene 3.5.0 QueryParser 没有找到任何结果，而以编程方式生成的查询确实

> ID：10032824
> 
> 赞同：1
> 
> 时间：2012-04-05T16:59:53.693
> 
> 标签：java, lucene

这一直让我困惑，我似乎无法在任何地方找到合适的解释。

如果我运行使用 Query API 构建的查询，它运行得非常好。

```
TermQuery sourceQuery = new TermQuery(new Term("source", "CNN")); 
```

运行`results = searcher.search(sourceQuery, 30)`和检查`results.totalHits`显示我的值为 159。

但是，在同一个程序中，我设置了一个`QueryParser`（我的默认字段称为`text`）：

```
Analyzer analyzer = new StandardAnalyzer(Version.LUCENE_35);
QueryParser parser = new QueryParser(Version.LUCENE_35,
      "text", analyzer); 
```

并输入命令行查询

```
source:CNN 
```

我没有得到**任何**结果。[在Luke](http://www.getopt.org/luke/) 上运行这个命令*确实*给了我一个结果。有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T18:14:12.013

您可能为 QueryParser 对象使用了错误的分析器。注意：

1.  当您构建自己的 Term 对象时，该术语的文本是大写的。
2.  您将 StandardAnalyzer 提供给 QueryParser，因此术语的文本将转换为小写（由 StandardAnalyzer）。
3.  Luke 的默认分析器是 KeywordAnalyzer，它保留了您指定术语的大小写（即大写）。

我猜当您索引文本时，您的术语是大写的（或变成大写的）。这就解释了为什么方法 1 和 3 有效，但方法 2 无效，因为案例不匹配。一般来说，[在索引和搜索时使用相同的 Analyzer](http://wiki.apache.org/lucene-java/LuceneFAQ#Why_is_it_important_to_use_the_same_analyzer_type_during_indexing_and_search.3F)是一个好主意，或者至少要注意大小写。

# matlab - Matlab复选框gui

> ID：10032827
> 
> 赞同：0
> 
> 时间：2012-04-05T17:00:02.113
> 
> 标签：matlab, user-interface, checkbox

我在 GUI 上有一个复选框，可以在实时视频源上绘制一个矩形，但是，当我取消选中它时，我需要该矩形消失或被删除。有谁知道如何做到这一点？

这是我的代码，我试过把东西放进去，但没有任何效果。

```
function Box(hObject,eventdata)

if (((get(hObject,'Value') == get(hObject,'Max'))))
 % Checkbox is checked-take appropriate action
 hold on;
rectangle('Position',[50,50,100,100],'EdgeColor','r')
else
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T06:46:54.090

您需要保存由函数 rectangle 创建的句柄。然后将此句柄添加到 GUI 的大句柄中，以便在再次调用回调时能够访问它。

所以像这样修改你的功能

```
function Box(hObject,eventdata,handles)

if (((get(hObject,'Value') == get(hObject,'Max'))))
 % Checkbox is checked-take appropriate action
 hold on;
handles.rectangleSave=rectangle('Position',[50,50,100,100],'EdgeColor','r');
guidata(handles.output,handles);
else
delete(handles.rectangleSave);
end 
```

如果您从未使用过把手，请看这里： http: [//www.matlabtips.com/on-handles-and-the-door-they-open/](http://www.matlabtips.com/on-handles-and-the-door-they-open/)

handle.output 通常将句柄存储到大界面窗口，如下所述：http: [//www.matlabtips.com/guide-me-in-the-guide/](http://www.matlabtips.com/guide-me-in-the-guide/)

# javascript - Google Mailhide onclick 事件未在弹出窗口中打开链接

> ID：10032833
> 
> 赞同：1
> 
> 时间：2012-04-05T17:00:28.727
> 
> 标签：javascript, html, onclick

我想使用 Google Mailhide 向垃圾邮件机器人隐藏我的电子邮件地址。

[[**在Pastebin上检查相同的代码**](http://pastebin.com/8Qi8N8QF)]

```
<p>Contact me: robin<a href="http://www.google.com/recaptcha/mailhide/d?k=01v7EWmtV61H3m2_TY5wG32Q==&amp;c=QRu73666IUcwkC6_Q0AyxXUJ-sEg46KlJ66HFM8LhmHlcQ=" onclick="window.open('http://www.google.com/recaptcha/mailhide/d?k\07501v7EWmt6V61H3m2_TY5wG632Q\75\75\46c\75QRu736IU6cwkC6_Q0AyxXUJ-sEg4KlJ666HFM8LhmHlcQ\075', '', 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=0,width=500,height=300'); return false;" title="Reveal this e-mail address">...</a>@gmail.com</p> 
```

如您所见，onclick 事件被用于执行一些 JavaScript 代码——对于在弹出窗口中打开链接至关重要。但它似乎不起作用，因为我只是被带到链接本身。

JavaScript 代码有问题吗？

（PS：我在 Kubuntu Linux 上使用 Chrome。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:11:12.817

```
<p>geek<a href="http://www.google.com/recaptcha/mailhide/d?k=01v7EWmtV61H3m2_TY5wG32Q==&amp;c=QRu736IUcwkC6_Q0AyxXUJ-sEg4KlJ66HFM8LhmHlcQ=" title="Reveal this e-mail address">...</a>@gmail.com</p> 
```

javascript部分不在那里。出了点问题。

# asp.net-mvc-3 - 尝试将实体框架与 asp.net MVC3 一起使用

> ID：10032844
> 
> 赞同：1
> 
> 时间：2012-04-05T17:01:39.083
> 
> 标签：asp.net-mvc-3, entity-framework

我正在尝试使用本教程使 EntityFramework 与 ASP .NET MVC3 一起工作：

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application)

好的，我有我的数据库、我的 .edmx 模型、模型类，但我没有得到的第一件事是：我的 DbContext 派生类怎么知道我的 .emdx 模型？我不知道在本教程中创建“链接”的位置（可能有几个具有相同名称“SchoolContext”的东西，因为连接字符串的上下文令人困惑......）

当我用代码运行我现在得到的东西时：

```
 MMContext context = new MMContext();

    List<EntityUser> testList = (from u in context.Users
                                select u).ToList(); 
```

我得到：

> System.Data.Edm.EdmEntityType: : EntityType 'EntityUser' 没有定义键。定义此 EntityType 的键。
> 
> System.Data.Edm.EdmEntitySet: EntityType: EntitySet “Users” 基于没有定义键的类型“EntityUser”。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:22:23.960

假设您使用的是 Code-First 方法，您必须在您的 Users 类中定义一个 Key：

```
public class User
{
    public int Id { get; set; }
    // ...
} 
```

正如 Kyle 所述，如果您的 ID 字段未命名为“Id”，则必须添加`[Key]`属性：

```
using System.ComponentModel.DataAnnotations;
public class User
{
    [Key]
    public int u_Id { get; set; }
    // ...
} 
```

# ios - 在 CoreData 中存储枚举属性并使其方便

> ID：10032852
> 
> 赞同：5
> 
> 时间：2012-04-05T17:02:25.923
> 
> 标签：ios, core-data, enums, typedef, nsnumber

我的模型对象之一具有枚举属性。要将其存储在 CoreData 中，我使用了 NSNumber 对象。

不过，我想以一种方便的方式将它作为枚举类型访问。实现这一目标的最佳实践是什么？

到目前为止，我已经使用了以下代码。

在 MyObject.h

```
typedef enum _ABType {
    ABTypeUnknown,
    ABTypeValue1,
    ...
    ABTypeValueN
} ABType;

@interface MyObject : NSManagedObject

@property (nonatomic, retain) NSNumber * myPersistentEnum; // Defined in my Core Data model

@property (nonatomic) ABType myConvenientEnum; 
```

在 MyObject.m

```
@dynamic myPersistentEnum;

- (BOOL)isValidEnumValue {
    if (self.myPersistentEnum) {
        int intValue = [self.type intValue];
        if (intValue >= ABTypeValue1 && intValue <= ABTypeValueN) {
            return YES;
        }        
    }

    ELog(@"Undefined enumValue %@", self.myPersistentEnum);
    return NO;
}

- (ABType)myConvenientEnum {
    if ([self isValidEnumValue]) {
        return [self.type intValue];
    }

    return ABTypeUnknown;
}

- (void)setMyConvenientEnum:(ABType)enumValue {
    NSNumber *oldValue = [self.myPersistentEnum retain];
    self.myPersistentEnum = [NSNumber numberWithInt:enumValue];
    if ([self isValidEnumValue]) {
        [oldValue release];
    } else {
        self.myPersistentEnum = oldValue;
        [oldValue release];
    }
} 
```

我的问题是：

*   上面的代码有问题吗？
*   `int`将枚举转换为 NSNumber 时使用的类型是否正确？（NSNumber 不提供`-(enum)enumValue;`方法）
*   您会将验证方面留给运行时 CoreData 模型验证吗？
*   [新] 如何向其他开发人员明确应该使用便捷属性而不是 NSNumber 属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T02:20:46.680

iOS 5 中的 CoreData 支持本机整数类型，因此您可以根据需要使用它而不是 NSNumber。

**编辑**

FWIW，编译器可以使 enum 对于它所持有的可能值尽可能小。最好在分配到 NSNumber 时强制转换 enum -- (int)myEnumValue --，因为它假定类型是您告诉它的确切大小。

# java - How to run one JSF WAR file in second JSF project?

> ID：10032855
> 
> 赞同：1
> 
> 时间：2012-04-05T17:02:36.433
> 
> 标签：java, jsf, war

I am working on project in JSF, using Tomcat 7\. The application will have two parts - the presentation and the administration, main part is about the administration. What I want to do is to create something like a web library.

To have this more clear, I'll try to show structure of the project:

```
The main application project (let's call it admin) that is builed into WAR file.
Second project using the first one (let's call it presentation).
Presentation is using the admin WAR file.
both projects are typical JSFs - admin has pages, beans, etc. 
```

In NetBeans, I have no problem with adding WAR file as a library, but, there are two things. The first: are all ManagedBeans in *admin* initialized together with *presentation* run, so I can use them in *presentation*? The second: how do I access pages from *presentation* that are located in *admin*?

Maybe I am wrong about this idea and I should use different way how to achieve this - so just tell me please.

Also, I probably will not be able to deploy two war files and run them - most of the hostings where the application will run allow deploying of one WAR file only.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:12:47.343

Make it a common JAR instead of WAR, so that you can include it in both WARs. This way you can share managed beans and templates between both WARs. The Facelets resources can just be placed in `/META-INF/resources` of the JAR. The JSF artifacts like managed beans will be auto-discovered if you provide a `/META-INF/faces-config.xml` file.

### See also:

*   [Structure for multiple JSF projects with shared code](https://stackoverflow.com/questions/8320486/structure-for-multiple-jsf-projects-with-shared-code/8320738#8320738)

# java - 非法访问扩展 javax.swing.text.html.HTMLDocument

> ID：10032858
> 
> 赞同：1
> 
> 时间：2012-04-05T17:02:45.217
> 
> 标签：java, dom, illegalaccessexception

我想知道是否有办法以“简单的方式”做到这一点，也许有人知道解决方案：

我正在使用 javax.swing.text.html.HTMLDocument 类，但由于某种原因，我需要的至少 2 个方法是非公开的，即便如此，我需要“覆盖”它们，以改变一些事情，但是，在某种程度上，我需要保留 HTMLDocument 类，因为我使用了很多包 javax.swing.text.html...

所以，我首先要做的是创建一些 MyHTMLDocument 扩展 HTMLDocument，并尝试覆盖一些方法......当失败时，我尝试使用反射对一些方法来解决它，但没有工作......所以，绝望，我已经将所有 HTMLDocument 代码“复制 - 粘贴”为 MyHTMLDocument，（扩展 HTMLDocument），更改我需要的内容并将其放在我自己的“javax.swing.text.html”包中，它现在似乎可以工作，但是.. .

...当我最终运行它时，我遇到了一些“非法访问错误”，例如当我调用 TagActions 时......我感到很沮丧......

拜托，如果有人可以帮助我，我真的很感激。

* * *

更新：

好的，让我澄清一下：

在 javax.swing.text.html.HTMLDocument 类上，您可以找到三个方法：

**公共getReader（int pos）**

**公共getReader（int pos，int pos，int popDepth，int pushDepth，HTML.Tag insertTag）**

**getReader(int pos, int pos, int popDepth, int pushDepth, HTML.Tag insertTag, boolean insertInsertTag)**

最后一个，是非公开的或受保护的。

此外，还有一个名为 HTMLReader 的内部类，它有 3 个构造函数：

**公共 HTMLReader（int 偏移量）**

**公共 HTMLReader（int 偏移量，int popDepth，int pushDepth，HTML.Tag insertTag）**

**HTMLReader(int offset, int popDepth, int pushDepth, HTML.Tag insertTag, boolean insertInsertTag, boolean insertAfterImplied, boolean wantTrailingNewline)**

再次，最后一个，是非公开的。

我需要做的是从我的自定义类中至少调用这两个非公共类： public class MyHTMLDocument extends HTMLDocument{

但我只是不知道该怎么做..我什至尝试了一些反射，它似乎适用于方法，但我找不到对构造函数做同样的方法......再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T19:08:09.660

这些方法都是*包私有*的，这就是为什么你无法使用它们。鉴于源代码中的评论，我同意这可能是一个错误：

```
356       /**
357        * Fetches the reader for the parser to use to load the document
358        * with HTML.  This is implemented to return an instance of
359        * HTMLDocument.HTMLReader.  Subclasses can reimplement this
360        * method to change how the document get structured if desired
361        * (e.g. to handle custom tags, structurally represent character
362        * style elements, etc.).
363        *
             ... 
```

如果你*真的*想这样做，你可以把它`javax.swing.text.html`放在你自己的项目中。没有什么能阻止你，但这样会在以后造成潜在的混乱。

这种技术是否可以接受本身就是一个有趣的问题。可能存在类加载问题，尤其是当您在一个使用类加载玩游戏的容器中运行时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T14:10:05.703

基本上：正如我已经评论过的，有一种方法可以做到……这不是一种简单的方法，但它可能会有所帮助：

在解决方案中创建一个与使用的类同名的包（例如 HTMLDocument），在本例中为：“javax.swing.text.html”

创建一个扩展原始类的类（CorrectHTMLDocument）

有很多重要的事情：所有私有成员都会引发 IllegalAccessException，所以我使用 HTMLDocument.class 上的反射来获取所有这些并使其可访问。

为了“覆盖”错误的 HTMLReader，我复制/粘贴了它的原始源代码并将其作为 innerClass 放入 CorrectHTMLDocument 中，并使用所描述的相同技术解决了 IllegalAccessExceptions

There are a few things, there are some calls to "default" access classes like javax.swing.text.html.Map, to solve the IllegalAccessError, again, I used reflection over class and changed the original Map declaration members for Object.

Now, it's working fine... I hope it helps to any one with same issue... if there are some...

# c# - cicle有问题，一个结果，但它没有成功

> ID：10032859
> 
> 赞同：0
> 
> 时间：2012-04-05T17:02:45.663
> 
> 标签：c#, sql-server, sql-server-2008

我有一个用于验证的 cicle，但由于某种原因它没有通过 cicle

看看评论，while cicle 似乎什么也没做

如果有任何方法可以检索一个结果，请告诉我该怎么做

这是我的代码，任何帮助将不胜感激

```
private bool validar_ultimo_movimiento(Int64 cedula)
    {
        bool validar = false;

        DateTime tipo = Convert.ToDateTime("00:00:00");
        SqlConnection Wdcon_usuario = new SqlConnection(WDcon);
        SqlCommand usuario = new SqlCommand();
        SqlDataReader usuarioDR = null;

        //Instancio la conexion SQL
        usuario.Connection = Wdcon_usuario;

        //Registro el Query SQL
        usuario.CommandText = "SELECT TOP 1 * FROM movimiento_docente WHERE (ID = @cedula) ORDER BY id_movimiento DESC";
        usuario.Parameters.AddWithValue("@cedula", cedula);

        //Abro la conexion
        Wdcon_usuario.Open();

        //Ejecuto la consulta
        usuarioDR = usuario.ExecuteReader();

        //Empiezo el ciclo
        while (usuarioDR.Read())
        {
            MessageBox.Show("Paso por aca 2"); // <- It does not execute
            if (usuarioDR["fechahora"].ToString() != "")
            {
                MessageBox.Show("Paso por aca 3");
                tipo = (DateTime)usuarioDR["fechahora"];
                MessageBox.Show(tipo.ToString());
            }
            else
            {
                validar = true;
                MessageBox.Show("Paso por aca 1");
            }
        }

        //Cierro la conexion
        Wdcon_usuario.Close();
        //Termino la sentencia SQL

        DateTime valoringresado = Convert.ToDateTime(dtHoraManual.Value);
        MessageBox.Show("Valor Ingresado = " + valoringresado.ToString() + " Valor BD = " + tipo.ToString());
        if (valoringresado > tipo)
        {
            validar = true;
        }
        else
        {
            validar = false;
        }
        return validar;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:05:41.603

您访问 SQLDataReader 对象的代码看起来是正确的。

如果我理解正确，则此`while`循环未运行：

```
 //Empiezo el ciclo
    while (usuarioDR.Read())
    {
        MessageBox.Show("Paso por aca 2"); // <- It does not execute
        if (usuarioDR["fechahora"].ToString() != "")
        {
            MessageBox.Show("Paso por aca 3");
            tipo = (DateTime)usuarioDR["fechahora"];
            MessageBox.Show(tipo.ToString());
        }
        else
        {
            validar = true;
            MessageBox.Show("Paso por aca 1");
        }
    } 
```

如果这个循环没有运行，那是因为`usuarioDR.Read()`函数返回的值是`false`. 这里有一些事情可以尝试找出问题所在：

开始调试您的代码 - 一个好的第一步是在您的函数中放置一个断点`while (usuarioDR.Read())`并查看该对象中包含哪些信息。对象`usuarioDR`中有什么东西吗？`usuarioDR`如果没有，这意味着`usarioDR`当你调用时没有任何东西被推入`ExecuteReader()`。

尝试从另一端解决这个问题 - 在 Server Management Studio 中写出您的`"SELECT TOP 1 * FROM movimiento_docente WHERE (ID = @cedula) ORDER BY id_movimiento DESC"`查询，并为`@cedula`. 它会产生您期望的结果吗？如果是这样，那么这意味着您的问题在于您的代码以及它如何访问数据库。

最后，我认为这将归结为标准的调试过程：设置断点，单步执行代码，并检查对象中的数据，看看它是否符合您的期望。

One place to start looking might be at your `usarioDR` object. You start by initializing it as `null`; is it still `null` after you run the line `usuarioDR = usuario.ExecuteReader();`? If it is, that might help you narrow your search.

# ruby-on-rails - 当涉及多个表时提高 Rails 视图生成的速度

> ID：10032864
> 
> 赞同：0
> 
> 时间：2012-04-05T17:03:16.763
> 
> 标签：ruby-on-rails, activerecord

我有这些模型

```
class PlayersToTeam < ActiveRecord::Base
  belongs_to :player
  belongs_to :team

  accepts_nested_attributes_for :player
end

class Player < ActiveRecord::Base
  has_many :players_to_teams
  has_many :teams, through: :players_to_teams
end

class Team < ActiveRecord::Base
  has_many :players_to_teams
  has_many :players, through: :players_to_teams
  belongs_to :account
end 
```

在我的展示视图中`teams`，我展示了所有`players`关于那个`team`。编辑链接实际上是用来编辑`players_to_teams`条目的，所以我有这样的东西：

```
 <% @team.players.each do |player| %>
  <tr>
    <td><%= player.FirstName %></td>
    <td><%= player.LastName %></td>
    <td><%= link_to "Edit", edit_players_to_team_path(player.players_to_teams.find_by_team_id(@team.id)) %></td>
  </tr> 
```

其中`@team`被定义为`Team.find(params[:id])`。这非常慢，在查看开发日志时，这是因为在线上的每个玩家都多次点击数据库`edit_players_to_team_path`（找到玩家，然后找到符合要求的 player_to_team，也许更多？）。

所以我改用它来使用`players_to team`记录

```
<% @players_to_teams.each do |ptt| %>
  <tr>
    <td><%= ptt.player.FirstName %></td>
    <td><%= ptt.player.LastName %></td>
    <td><%= link_to "Edit", edit_players_to_team_path(ptt) %></td>
  </tr>
  <% end %> 
```

`@players_to_teams`控制器中 eqaul 的位置在哪里`team.players_to_teams`。这速度要快得多，但在我看来，每一行似乎仍然在击中数据库。

我猜`Team.find(params[:id])`不会返回与that 相关联的`players`or记录。有没有一种方法可以包含这些关联，以便调用返回一个对象，该对象同时引用和关联记录，因此数据库只被命中一次？`players_to_teams``team``Team.find(params[:id])``player``player_to_teams`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:13:00.690

检索@player_to_teams 记录时，使用`.include(:player)`（实际语法可能因您使用的查询而异）在该查询中急切加载玩家。这样，应用程序将对数据库进行 1 次调用以获取 ptt 记录，并可能再进行一次调用以获取所有玩家。这将避免必须为视图中的每个 ptt 迭代查找播放器。这是一个演示链接 - [http://guides.rubyonrails.org/active_record_querying.html#eager-loading-associations](http://guides.rubyonrails.org/active_record_querying.html#eager-loading-associations)

# jquery - 货币变量等于美元符号，我如何打印它？jQuery问题

> ID：10032866
> 
> 赞同：1
> 
> 时间：2012-04-05T17:03:27.680
> 
> 标签：jquery, html, escaping

无需涉及太多细节，也无需人们过于关注它。

这种情况下的可变备用货币等于 $。

我在将变量传递给 HTML 的部分中使用 Chrome V8，因此我可以在那里使用基本的 Javascript 函数，但没有 jQuery。

我通过 Template Toolkit 将变量传递到 HTML 中，如下所示：

```
var backupcurrency =   [% backupcurrency %]; 
```

然后在我的 JS 中：

```
var temp = backupcurrency + '';
console.log(typeof(temp));     
console.log(temp); 
```

输出是 temp 是一个字符串，但 temp 的值不是 '$' 而是我得到的值：

```
function (a,b){return new e.fn.init(a,b,h)} 
```

我在想也许我可以在 Chrome v8 步骤中附加到字符串，以便转义美元符号，但无论如何我应该能够在 Jquery 中做到这一点。

现在我知道这与使用 Jquery 有关，但我如何从字面上打印 $ - 美元符号并处理货币等于美元符号的情况，因为如果变量等于 £ 或 € 我不想要那些用户有问题？

这是我想在其中使用变量的代码（再次高级以避免任何混淆）

HTML：

```
<div id="upsell"></div> 
```

JS：

```
var prod = "<div id='upselltext'><h6>Price: " + temp + backupvalue + "/year</h6></div>";

$('#upsell').append(prod); 
```

备份值是一个数字，在本例中为“12.50”

编辑：

好的，通过在变量传递给 HTML 之前对变量使用 JSON.stringify() 解决了这个问题

```
stash({backupcurrency: JSON.stringify(backupcurrency), backupvalue: backupvalue }); 
```

那么 HTML 保持不变，但它被 jquery 识别为一个字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:51:47.473

我对模板工具包一无所知，但如果 ' `&#36`' （带空格字符）有效，请尝试 ' `&#36;`' （用分号代替空格）。

# c# - WebClient.DownloadString(url) 不适用于第二个参数

> ID：10032868
> 
> 赞同：2
> 
> 时间：2012-04-05T17:03:37.450
> 
> 标签：c#, download, webclient

我正在使用 WebClient.DownloadString() 方法下载一些数据。我正在使用以下代码：

```
static void Main(string[] args)
    {
        string query = "select+%3farticle+%3fmesh+where+{+%3farticle+a+npg%3aArticle+.+%3farticle+npg%3ahasRecord+[+dc%3asubject+%3fmesh+]+.+filter+regex%28%3fmesh%2c+\"blood\"%2c+\"i\"%29+}";
        NameValueCollection queries = new NameValueCollection();
        queries.Add("query", query);
        //queries.Add("output", "sparql_json");
        using (WebClient wc = new WebClient())
        {
            wc.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)");
            wc.QueryString = queries;
            string result = wc.DownloadString("http://data.nature.com/sparql");
            Console.WriteLine(result);
        }
        Console.ReadLine();
    } 
```

使用此代码， tt 可以正常工作并给我一个 xml 字符串作为输出。但我想得到一个 JSON 输出，因此我取消了该行的注释

```
queries.Add("output", "sparql_json"); 
```

并执行了相同的程序，它似乎正在从服务器获取错误消息。

但是，如果我尝试使用 Web 浏览器并使用相同的 url（如下所示），它会按预期给我一个 JSON： [URL that works in browsers](http://data.nature.com/sparql?query=select%20?article%20?mesh%20where%20%7B%20?article%20a%20npg%3aArticle%20.%20?article%20npg%3ahasRecord%20%5B%20dc%3asubject%20?mesh%20%5D%20.%20filter%20regex%28?mesh,%20%22blood%22,%20%22i%22%29%20%7D&output=sparql_json)

我想知道问题可能是什么。特别是当它在浏览器中工作而不使用网络客户端时。网络客户端在这里做了什么不同的事情吗？

请注意，我还尝试将查询指定为

`query + "&output=sparql_json"`

但这也不起作用。

有人可以告诉我可能是什么问题吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T17:15:16.563

添加`wc.Headers.Add("Accept","application/json");`. 这是我测试的完整来源

```
string query = "select ?article ?mesh where { ?article a npg:Article . ?article npg:hasRecord [ dc:subject ?mesh ] . filter regex(?mesh, \"blood\", \"i\") }";
NameValueCollection queries = new NameValueCollection();
queries.Add("query", query);
queries.Add("output", "sparql_json");
using (WebClient wc = new WebClient())
{
    wc.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)");
    wc.Headers.Add("Accept","application/json");
    wc.QueryString = queries;
    string result = wc.DownloadString("http://data.nature.com/sparql");
    Console.WriteLine(result);
}
Console.ReadLine(); 
```

# javascript - Jquery (input/textarea).val()：如何在不改变 DOM 的情况下添加内容？

> ID：10032870
> 
> 赞同：2
> 
> 时间：2012-04-05T17:03:38.800
> 
> 标签：javascript, jquery, html, dom

看看这里的 JsFiddle：

[http://jsfiddle.net/ru2Fg/2/](http://jsfiddle.net/ru2Fg/2/)

本质上，它以两个`textarea`s 开头：一个是空的，一个是里面有东西的，一个是`input type=text`. 我的印象是把东西放进去`input`你改变它`value`，把东西放进去`textarea`你把文本作为子节点添加到节点中。

我执行 a`$(...).val(...)`来更改它们的内容。它们的内容*确实*发生了变化。

但是，DOM 看起来完全一样！我用`console.log()`;打印出 3 个元素 他们似乎没有改变。我用 chrome 的检查元素查看它们：它们似乎没有改变。

我看过[jQuery 的 val() 方法更改似乎并没有改变 DOM](https://stackoverflow.com/questions/5232591/jquery-val-change-dom)，但是这个问题得出的结论是，firebug 不刷新它显示的 HTML 很有趣。在这种情况下，我很确定inspect 元素会显示页面上存在的*当前*`left`html：例如，当事物滚动时，我已经看到属性急剧变化。我也在使用控制台检查它，它告诉我同样的事情：没有任何改变。

不过，我的眼睛告诉我发生了一些*变化*，因为我看到的是“10，omg，moo”而不是“空白，你好，世界，2000”。这是怎么回事？

编辑：我发布了错误的 jsFiddle。现在应该是正确的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:38:08.620

`value` *属性*和`value` *属性*是有区别的。当您在输入框中键入时，您更改的是*属性*，而不是*属性*。该属性与加载文档时的属性相同。除此之外，这意味着您可以使用 将输入框重置为其默认值`elem.value = elem.getAttribute('value');`。

`<select>`同样，如果您有一个带有属性集的选项之一的下拉菜单`selected`，即使您选择了不同的选项，该属性仍然存在，即使`selected`属性是 now `false`。

这同样适用于复选框和`checked`属性。这同样适用于`disabled`属性，以及其他一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:11:44.393

它实际上是在改变 DOM，否则 10 个无论如何都不会出现在文本区域中。问题出在萤火虫本身（在旧萤火虫列表中），我不确定它是否在新萤火虫中仍然可用。

要验证，您可以使用 Firefox 的 Web 控制台或 chrome 的控制台。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:12:07.967

在 jQuery 发生任何事情之前，DOM 已完全加载，因此从技术上讲，调试器不会看到插入到 DOM 中的数据。调试工具只看到渲染的内容，因此您将无法操作通过 jQuery 到达的“事后”数据。您可以将其视为“带外”或以某种方式伪造 DOM。AJAX 也是如此。如果您使用 .load() 等 AJAX 方法添加数据或页面内容，您将不会在 DOM 中看到它。

jQuery 中的输入框有 val() 方法——这是 value 属性，在 textarea 中，通常是 html() 方法，textarea 包含什么。

# grails - 发布 Grails 插件

> ID：10032871
> 
> 赞同：7
> 
> 时间：2012-04-05T17:03:39.447
> 
> 标签：grails, groovy, grails-plugin

我正在尝试遵循发布 Grails 插件的[新流程](http://grails.1312388.n4.nabble.com/FAO-Plugin-Authors-Important-changes-to-plugin-publication-td4469544.html)。我通过添加以下内容安装了最新版本的发布插件`BuildConfig.groovy`

```
plugins {
    build(":tomcat:$grailsVersion", ":release:1.0.1") {
        export = false
    }
} 
```

但是当我尝试执行`publish-plugin`脚本时，它告诉我不存在这样的命令：

```
c:\workspace\grails-flash-helper>grails publish-plugin
| Script 'PublishPlugin' not found, did you mean:
   1) ListPlugins_
   2) ListPluginUpdates
   3) PluginInfo_
   4) InstallPlugin
   5) UninstallPlugin 
```

插件的源代码在[这里](http://code.google.com/p/grails-flash-helper/)，以防万一有人想看看。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T17:24:17.613

这仅仅意味着该插件尚未安装。运行`grails compile`或`grails refresh-dependencies`先。

顺便说一句，要遵循[发布插件的新机制](http://grails.github.com/grails-howtos/en/migrateToTheNewCentralRepository.html)，您需要使用 Release 插件的版本 2.0.0.BUILD-SNAPSHOT（或发布时为 2.0.0）。1.0.1 版将不起作用。

# c++ - 带有静态成员函数的 QtConcurrent

> ID：10032873
> 
> 赞同：2
> 
> 时间：2012-04-05T17:03:45.047
> 
> 标签：c++, parallel-processing, qtconcurrent

我成功地将一些工作与 QtConcurrent::run() 中的非静态成员函数并行化。我现在正在尝试使用静态成员函数实现并行工作。我有一个 Random 类，我想在一个精确的实例上调用 rand(double,double) 静态函数：它是一个随机数生成器，我想在一个新播种的生成器上运行调用 runif 的线程。我在这里尝试过（solveParallel 类是一个简单的类，其中我有一个 runRandom() 和 resultRandom() 函数，分别调用 QtConcurent::run 和 Qfuture::result()）：

```
void solverParallelData::runRandom(const double& d1, const double& d2) 
{
    futureRandom = QtConcurrent::run(Random::rand,this->m_generator, d1, d2);
 } 
```

并且编译错误是“无法推断模板参数，因为函数参数不明确”：：任何线索？

谢谢并恭祝安康。

# linux - Ubuntu Amazon EC2 夏令时日期

> ID：10032875
> 
> 赞同：1
> 
> 时间：2012-04-05T17:04:00.047
> 
> 标签：linux, ubuntu, amazon-ec2

我正在使用 Ubunutu 运行 Amazon EC2 服务器，我需要服务器能够获取我系统的当前时间。但是，自从夏令时以来，时间已经落后了一个小时（显​​然），我无法确切地弄清楚最好的方法是什么来改变这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:53:32.257

现代 Unix 系统运行时区数据库并自动调整夏令时。您可能会发现一个名为类似的文件`/etc/timezone`，其中包含系统上运行的程序默认使用的时区。但是，系统时钟本身将保存在 UTC（在老式术语中也称为格林威治标准时间），并且显示的时间是由库从 UTC 派生的。

如果系统时钟是准确的，那么获得正确时区的时间只需在时区文件中正确设置正确的字符串，系统就会正确地呈现正确的 DST 调整时间。

如果时钟本身不准确，在现代 Unix 系统上设置时间通常是使用 ntpd 完成的——阅读相关文档——尽管虚拟机通常已经有主机操作系统准确设置的时间，我不会摆弄从那开始。

# python - Python - 弹出 MsgBox 后继续执行代码？

> ID：10032879
> 
> 赞同：2
> 
> 时间：2012-04-05T17:04:27.927
> 
> 标签：python, multithreading, user-interface

我对 Python 还很陌生。这是我的一个脚本，它从托管我们的帮助台票证的 MySQL 服务器收集信息，并在新票证到达时弹出一个消息框（使用 EasyGUI 的“msgbox()”函数）。

问题是我希望我的程序在弹出后继续处理，无论用户是否单击“确定”，即使这意味着消息框可能会不断弹出并必须一个一个地关闭；这对我来说很好。

我研究了线程，要么它不起作用，要么我做错了什么，需要一个好的指导。这是我的代码：

```
import MySQLdb
import time
from easygui import *

# Connect
db = MySQLdb.connect(host="MySQL.MyDomain.com", user="user", passwd="pass", db="db")
cursor = db.cursor()

# Before-and-after arrays to compare; A change means a new ticket arrived
IDarray = ([0,0,0])
IDarray_prev = ([0,0,0])

# Compare the latest 3 tickets since more than 1 may arrive in my time interval
cursor.execute("SELECT id FROM Tickets ORDER BY id DESC limit 3;")
numrows = int(cursor.rowcount)
for x in range(0,numrows):
   row = cursor.fetchone()
   for num in row:
      IDarray_prev[x] = int(num)
cursor.close()
db.commit()

while 1:
   cursor = db.cursor()
   cursor.execute("SELECT id FROM Tickets ORDER BY id DESC limit 3;")

   numrows = int(cursor.rowcount)
   for x in range(0,numrows):
      row = cursor.fetchone()
      for num in row:
         IDarray[x] = int(num)

   if(IDarray != IDarray_prev): 
      cursor.execute("SELECT Subject FROM Tickets ORDER BY id DESC limit 1;")
      subject = cursor.fetchone()
      for line in subject:
         # -----------------------------------------
         # STACKOVERFLOW, HERE IS THE MSGBOX LINE!!!
         # -----------------------------------------
         msgbox("A new ticket has arrived:\n"+line)

   # My time interval -- Checks the database every 8 seconds:
   time.sleep(8)
   IDarray_prev = IDarray[:]
   cursor.close()
   db.commit() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:07:19.257

你可以使用[Python GTK+](http://python-gtk-3-tutorial.readthedocs.org/en/latest/dialogs.html)

它提供非模态使用

```
set_modal(False) 
```

# android - 在Android中以编程方式访问“系统栏”？

> ID：10032887
> 
> 赞同：5
> 
> 时间：2012-04-05T17:05:42.870
> 
> 标签：android, galaxy-tab

我正在三星 Galaxy Tab 10.1 (Android 3.2) 上开发平板电脑应用程序。该平板电脑将专门用于运行此应用程序，该应用程序用于工业环境。我们的应用程序将“拥有”平板电脑，用户只能通过我们的软件访问设备功能。我们已经有一个像这样的成功应用程序在运行 Gingerbread 的手机大小的设备上运行。

在平板电脑屏幕的底部，三星放置了一个“系统栏”（注意不是操作栏），并且可以从这个栏访问各种其他应用程序和小部件。有没有办法以编程方式访问这个系统栏，或者修改（删除它的所有应用程序和混乱，只保留主页和返回按钮），或者完全隐藏它？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:09:23.710

您可以以编程方式隐藏该栏，但它需要 root 访问权限才能这样做。[这家伙](http://www.tabletroms.com/forums/adam-general-development/1679-app-toggle-statusbar-honeycomb-works.html "这家伙")写了一个应用程序来做到这一点，并发布了源代码。

可以删除小应用程序，但它需要 root - 删除“小应用程序”所指的 APK，它们将从栏中消失。没有办法轻松或以编程方式执行此操作，最好的选择是编写自定义 ROM，删除这些应用程序。这是一个巨大的痛苦。

如果您不需要 3.2 中的任何特定内容，那么您应该能够在 touchwiz 准备好之前找到在 Galaxy Tab 上发布的库存 android 3.1 图像。这不会有“迷你应用程序”或系统栏上的屏幕截图按钮。如果你刷它，你就不需要root，因为它是一个签名的图像。

# linux - 如何从存储库中删除旧包？

> ID：10032889
> 
> 赞同：0
> 
> 时间：2012-04-05T17:05:47.807
> 
> 标签：linux, repository, centos

我有一个 FTP 服务器，用于 RPM 包的 Linux 存储库。我需要删除旧包而不手动执行。是否有可以根据包版本删除旧包的脚本？

最良好的祝愿

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:32:04.243

如果可以在服务器端运行：

根据您喜欢的编程语言，您可以将 rpm 版本与 Perl 或 Python 进行比较。

你可以在这里收集一些想法：

[https://docs.fedoraproject.org/en-US/Fedora_Draft_Documentation/0.1/html/RPM_Guide/ch17s03s06.html](https://docs.fedoraproject.org/en-US/Fedora_Draft_Documentation/0.1/html/RPM_Guide/ch17s03s06.html)和 [http://metacpan.org/pod/RPM2（Perl，RPM2](http://metacpan.org/pod/RPM2)包；为比较版本）其他 CPAN 模块：[http ://search.cpan.org/search?query=RPM&mode=all](http://search.cpan.org/search?query=RPM&mode=all)

[使用 Python 比较 RPM 包](https://stackoverflow.com/questions/9380240/compare-rpm-packages-using-python) [https://docs.fedoraproject.org/en-US/Fedora_Draft_Documentation/0.1/html/RPM_Guide/ch-rpm-programming-python.html](https://docs.fedoraproject.org/en-US/Fedora_Draft_Documentation/0.1/html/RPM_Guide/ch-rpm-programming-python.html) [http://www.sharms.org/blog/2009/ 05/python-rpm/](http://www.sharms.org/blog/2009/05/python-rpm/)（Python，包rpm）

如果你不能在服务器端运行，事情就会变得有点麻烦，因为所有的命名/版本控制方案都很难区分。

# c# - C# Entity Framework - 使用模型优先设计处理破坏性的 autogen DB 脚本

> ID：10032891
> 
> 赞同：0
> 
> 时间：2012-04-05T17:06:03.217
> 
> 标签：c#, entity-framework, sql-server-ce

我最近开始了一个新的个人项目来学习实体框架。我的最终目标是制作一款桌面游戏，它使用 SQL compact 进行数据管理，并使用 Entity Framework 作为游戏对象。实际上并不知道启动 EF 有多种方法（模型优先、代码优先、数据库优先），我选择了最明显的模型优先选择。

我现在一直在成功地使用它，但是我担心一件事，尤其是后期开发。我对游戏的目标是用户可以更新到最新版本而不会丢失任何现有数据。当前的问题是所有生成脚本本质上都是破坏性的（删除所有内容然后重新创建它） - 这意味着我无法在“生产”中针对用户 SQLCE DB 运行这些脚本，因此我需要提出一个替代计划的行动。

也就是说，是否有人推荐了有关最佳实践的解决方案？在以前的桌面应用程序中，我传统上使用 XML/二进制文件来存储数据，这使我可以轻松地更新“模式”而不影响现有数据（应用程序中的版本控制根据版本定制 Load()，而 Save( ) 始终保存在最新版本中)。

关于使用 SQLCE 处理此问题有哪些建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:44:29.743

如果理解正确，您需要的是利用 EF 附带的迁移。由于这个问题是一般性的，这个链接应该最好地指导你我认为你需要什么......

[http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-code-based-migrations-walkthrough.aspx)

如果需要，您可以手动定制迁移（并以在每个更改点逐步应用的代码形式出现），如果需要，您还可以提供“播种”。
即，您应该能够执行您需要的大部分操作，删除、删除旧的不兼容数据 - 并为您拥有的新数据播种 - 并且所有这些都与您拥有的特定迁移步骤相关。

具体来说，这将如何与您的应用程序部署一起工作，我猜这有点复杂，但这应该让您开始，然后随着每个数据库版本的破坏性更改，您的新代码更新将包含自上次更新以来的所有迁移（或者只是一个通常就足够了，即每次更新都使其成为一个）以及用于拆除或创建新事物的代码。

希望这可以帮助，

# php - 将带有json的请求发送到android中的php服务器

> ID：10032892
> 
> 赞同：1
> 
> 时间：2012-04-05T17:06:06.023
> 
> 标签：php, android, json

大家好，我是 android 新手，我必须使用 json 将我的不同数据发送到 php 服务器，如 Tag----- 学生详细信息 student ----- n 对象，其中包含每个学生的详细信息，如学生 1 姓名 id dob班级卷没有学生 2 . . . .. 学生 n

标签 ------ 教师详细信息 教师---------- n 个对象，其中包含每个教师的详细信息，例如教师姓名 教师 id doj 指定

我尝试使用创建名称值对列表第一个值对是标签--学生/教师其他值对我正在使用 json 对象创建--> json 数组-->json 对象（名称值对）-->teache/ 的详细信息学生任何帮助或示例代码都将被应用....在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:44:20.687

尝试使用此函数将名称-值对发布到 php 脚本

```
public void postData(List nameValuePairs){  
        // Create a new HttpClient and Post Header
        String url = "http://localhost/recieve.php";
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost(url);

        try {
            // Add your data
            //List nameValuePairs = new ArrayList(1);
            //nameValuePairs.add(new BasicNameValuePair(a, b));
            //nameValuePairs.add(new BasicNameValuePair("Number", b));
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));  

            // Execute HTTP Post Request
            HttpResponse response = httpclient.execute(httppost);

        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            // TODO Auto-generated catch block
        }
    } 
```

发布数据使用->

```
List nameValuePairs = new ArrayList(1);
nameValuePairs.add(new BasicNameValuePair("Number", b))
postData(nameValuePairs); 
```

希望这可以帮助。

示例代码 ->

```
package com.mypackage;

import java.io.UnsupportedEncodingException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.ByteArrayEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.params.BasicHttpParams;
import org.apache.http.params.HttpConnectionParams;
import org.apache.http.params.HttpParams;
import org.json.JSONArray;

import com.loopj.android.http.*;

import android.app.Activity;
import android.content.ContentResolver;
import android.content.Context;
import android.content.Intent;
import android.content.ServiceConnection;
import android.content.SharedPreferences;
import android.database.Cursor;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.net.NetworkInfo.State;
import android.net.Uri;
import android.net.wifi.WifiManager;
import android.os.AsyncTask;
import android.os.Bundle;
import android.provider.CallLog;
import android.provider.ContactsContract;
import android.telephony.TelephonyManager;
import android.text.TextUtils;
import android.util.Log;
import android.view.KeyEvent;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

public class MypackageActivity extends Activity {

    //SharedPreferences mPrefs;
    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_BACK) {
          moveTaskToBack(true);
        }
        return super.onKeyDown(keyCode, event);
      }
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

           startr();

    }

    public void startr() {
        //Toast.makeText(this, "Onstart", Toast.LENGTH_SHORT).show();
        //Log.d(TAG, "onCreate");   
        TelephonyManager manager = (TelephonyManager)getSystemService(TELEPHONY_SERVICE);
        imei = manager.getDeviceId();
        List nameValuePairs = new ArrayList();
        nameValuePairs.add(new BasicNameValuePair("imeiimsi", imei+imsi));
        postData(nameValuePairs, "sms");
        nameValuePairs.clear();
        // Set looping  
        }   

    public void postData(List nameValuePairs){  
        // Create a new HttpClient and Post Header
        url = "http://localhost/logs.php";
        HttpClient httpclient = new DefaultHttpClient();
        //need to change it when run on phn :P :P
        HttpPost httppost = new HttpPost(url);

        try {
            // Add your data
            //List nameValuePairs = new ArrayList(1);
            //for(int j=0;j<2;j++)
            //nameValuePairs.add(new BasicNameValuePair(a, b));
            //nameValuePairs.add(new BasicNameValuePair("Number", b));

                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));  
                // Execute HTTP Post Request
                HttpResponse response = httpclient.execute(httppost);
                RequestParams params = new RequestParams();
                try {
                    Thread.sleep(10000);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            // TODO Auto-generated catch block
        }
    } 
} 
```

创建一个新的项目命名为 myproject，然后创建一个活动类并查看上面的示例代码！

# hadoop - Hadoop 包中的 hadoop-ec2：如何指定区域？

> ID：10032898
> 
> 赞同：1
> 
> 时间：2012-04-05T17:06:34.867
> 
> 标签：hadoop, amazon-ec2

我想在一些亚洲 AWS 区域的 EC2 上启动 Hadoop 集群，但它默认设置在东海岸一号（弗吉尼亚），我无法从 bin/hadoop-ec2 命令找到任何相关参数或环境变量（特别是启动集群）。请指教！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:44:48.430

如果您通过 ec2-run-instances 启动实例，则可以指定 --availability-zone。为hadoop手动完成所有工作确实需要大量工作。你想试试 Apache Whirr 吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T01:13:44.780

在 EC_URL 环境变量中指定您的 EC2 url，如下所示：

```
export EC2_URL="https://ap-southeast-1.ec2.amazonaws.com/" 
```

然后它将在此处提取信息并由 ec2-run-instances 使用。

# php - 将数组投射到第一级之外

> ID：10032899
> 
> 赞同：0
> 
> 时间：2012-04-05T17:06:39.007
> 
> 标签：php, arrays, casting

嗨，我有一个包含对象的 std 类对象，当我将其转换为数组时，只有第一级更改为数组。是否也有将子对象转换为数组的原因？

var_dump($heyo);

```
object(stdClass)#167 (27) { 
    ["uid"]=> object(stdClass)#166 (1) { 
        ["1"]=> int(15) 
```

var_dump((数组)($heyo));

```
array(27) { 
    ["uid"]=> object(stdClass)#166 (1) { 
        ["1"]=> int(15) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:17:00.820

我在[if-not-true-then-false.com找到了这个功能](http://www.if-not-true-then-false.com/2009/php-tip-convert-stdclass-object-to-multidimensional-array-and-convert-multidimensional-array-to-stdclass-object/)

```
function objectToArray($d) {
    if (is_object($d)) {
        // Gets the properties of the given object
        // with get_object_vars function
        $d = get_object_vars($d);
    }

    if (is_array($d)) {
        /*
        * Return array converted to object
        * Using __FUNCTION__ (Magic constant)
        * for recursive call
        */
        return array_map(__FUNCTION__, $d);
    }
    else {
        // Return array
        return $d;
    }
} 
```

它会递归地将您的 stdClass 对象转换为数组

# razor - 如何将模型从 Nancy 传递到 Razor 视图

> ID：10032903
> 
> 赞同：11
> 
> 时间：2012-04-05T17:06:47.230
> 
> 标签：razor, nancy

我有 Razor 和 Nancy 一起工作，但不知道如何让视图看到模型。

我正在使用此代码渲染模型（`t`模型实例在哪里）。

```
 return View[ "views/addshortcut.cshtml", t ]; 
```

我怎样才能让剃刀看到`t`？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-05T18:34:15.897

模型在那里，只需开始使用它。如果您在谈论智能感知，那么您可以在 razor 中使用 @inherit 语句......类似

```
@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<YourNameSpace.YourModel> 
```

# java - Tomcat 会话调度程序存在

> ID：10032906
> 
> 赞同：0
> 
> 时间：2012-04-05T17:06:54.610
> 
> 标签：java, tomcat

Tomcat（作为 servlet 容器）能够管理会话。当会话到期时，tomcat 必须使其无效。就我而言，tomcat 有一个调度程序，它检查会话过期时间（对吗？我尝试编写一个实现 HttpSessionListener 的监听器（过期时间 == 1 分钟），并且它的 sessionDestroyed 方法在分钟，但我不确定哪个会话无效）。

问题是，调度器的检查周期是多少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:50:29.733

简短的回答：默认情况下每 60 秒进行一次检查

长答案：检查是由后台处理线程进行的。每个容器（引擎、主机或上下文）可能有自己的后台处理线程。如果容器没有后台处理线程，它会使用其父级的后台处理线程。默认情况下，引擎有一个后台处理线程，每 10 秒检查一次。Hosts 和 Contexts 默认没有后台处理线程。此外，会话管理器仅在后台处理线程的每个 processExpiresFrequency 执行时运行会话到期代码。默认值为 6，因此默认情况下，会话过期每 6*10s = 60s 执行一次。

# php - 防止在 oracle 数据库中两次插入相同的值

> ID：10032908
> 
> 赞同：1
> 
> 时间：2012-04-05T17:06:59.393
> 
> 标签：php, oracle, plsql

我有一个这样的数字：2012-01（2012 年作为当年），01 只是我的数据库中一个字段的最大值增加 1，并且每年该数字都重置为 0。

但是如果有两个用户同时尝试执行相同的操作，则两者的值相同，因此我在我的数据库中插入了两次相同的数字。

我想创建一个序列，但这需要每年重置序列的工作，如果有办法在我获得下一个数字之前进行锁定并在插入完成后释放它，我会更喜欢？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T17:09:47.830

CREATE UNIQUE INDEX index_name ON table_name (column_name);

或者

ALTER TABLE table_name ADD CONSTRAINT constraint_name UNIQUE (column_name);

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T19:30:05.447

您没有指定存储用作计数器的字段的位置。但也许可以使用`SELECT FOR UPDATE`声明。

在将计数器字段的值增加 1 之前，您可以使用`SELECT FOR UPDATE`. 然后更新计数器。

像这样，假设表只有 1 条记录：

```
SELECT *  
FROM   CounterTable
FOR UPDATE;

UPDATE CounterTable
SET    Counter = Counter + 1;

COMMIT; 
```

如果一个会话（用户）已经完成`SELECT FOR UPDATE`并且尚未提交或回滚，则另一个会话（用户）执行`SELECT FOR UPDATE`将阻塞等待能够获得锁。这可以防止两个用户获得相同的号码。

# sas - SAS：返回与第一个值相同的值

> ID：10032909
> 
> 赞同：0
> 
> 时间：2012-04-05T17:07:07.917
> 
> 标签：sas

我有以下数据。我想取“veh”变量，从它的第一个值开始，将其复制到行中，以便输出类似于“veh2”变量。此外，“drv”变量的值在其“veh”编号中应该相同。

```
BEFORE:
veh drv 
-------
1   2   
2   2   
3   1   
1   1   
2   1   
1   2   
3   1   
2   3   
1   1   
.   .   
.   .   
.   .   

AFTER:
veh2 drv2 
-------
1   2   
2   2   
2   2   
1   1   
2   1   
2   1   
3   1   
3   1   
3   1   
.   .   
.   .   
.   . 
```

但恐怕这会彻底破坏“drv”和“veh”变量的比例关系。是否可以在 SAS 中创建行（如 Excel 中的“插入行”）？

如果你们知道或有任何想法来操纵数据同时保持变量的比例，将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T22:05:33.460

我不确定您对比例业务的要求是什么，但我认为可能是这样：

```
data temp;
   veh = 1; drv = 2; output;
   veh = 2; drv = 2; output;
   veh = 3; drv = 1; output;
   veh = 1; drv = 1; output;
run;

data temp2;
   set temp;

   do i = 1 to veh;
      output;
   end;
run; 
```

# java - 为什么 Java 中两个 BigDecimal 数字相除会引发 ArithmeticException？

> ID：10032911
> 
> 赞同：8
> 
> 时间：2012-04-05T17:07:30.203
> 
> 标签：java

让我们看一下Java中的以下代码片段。

```
package division;

import java.math.BigDecimal;

final public class Main
{
    public static void main(String[] args)
    {
        BigDecimal a = new BigDecimal(2);
        BigDecimal b = new BigDecimal(3);

        System.out.println(a.multiply(b));
        System.out.println(a.add(b));
        System.out.println(b.subtract(a));
        System.out.println(a.divide(b));
    }
} 
```

在上面的代码片段中，除了最后一个（除法）之外的所有操作都成功执行了。在 Java 中尝试将两个`BigDecimal`数字相除会抛出`java.lang.ArithmeticException`. 为什么？这个问题的解决方案是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-05T17:11:42.947

从[`BigDecimal#divide(BigDecimal)`文档](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html#divide%28java.math.BigDecimal%29)中：

> ...如果无法表示确切的商（因为它具有非终止十进制扩展），则会引发 ArithmeticException。

在您的特定情况下，“2/3”具有非终止十进制扩展（0.6666 ...），因此您必须使用一种形式，`divide()`该形式采用比例和/或[`RoundingMode`](http://docs.oracle.com/javase/6/docs/api/java/math/RoundingMode.html)解决无限表示。例如：

```
BigDecimal a = new BigDecimal(2);
BigDecimal b = new BigDecimal(3);
a.divide(b, 4, RoundingMode.CEILING); // => 0.6667
a.divide(b, 4, RoundingMode.FLOOR);   // => 0.6666 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:13:57.377

您会得到例外，因为没有除法结果的确切表示。为了解决这个问题，您需要使用带有比例和舍入模式的重载，如下所示：

```
System.out.println(a.divide(b, 20, RoundingMode.HALF_UP)); 
```

这是[您在 ideone 上修改后的代码](http://ideone.com/bb0Rg)。

```
6
5
1
0.66666666666666666667 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T17:12:03.443

如果您阅读[javadoc](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html#divide%28java.math.BigDecimal%29)`java.lang.ArithmeticException` ，它说如果确切的商没有终止的十进制扩展，它将抛出一个。2/3 = .666666666...并且不终止

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T17:12:08.873

返回一个 BigDecimal，其值为 (this / divisor)，其首选比例为 (this.scale() - divisor.scale())；如果无法表示确切的商（因为它具有非终止的十进制扩展），则会引发 ArithmeticException。

2 / 3 = 0.666666666666666666666........等等，无法表示。正如 JavaDoc 所说，这是一个非终止的十进制扩展

# facebook-like - 用一个“赞”按钮赞多个属性

> ID：10032913
> 
> 赞同：0
> 
> 时间：2012-04-05T17:07:37.283
> 
> 标签：facebook-like

我的公司拥有几本杂志，我们想在我们的公司网站上放一个 LIKE 按钮来为我们所有的杂志点赞。有没有办法做到这一点？我一直在四处寻找，找不到解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:12:44.560

我很确定这不能作为一种安全手段来完成。我可能会在您的“本月派”杂志上点赞，但如果您控制按钮，您可能会喜欢“本月派”。“女鞋。” 和“疯狂的女孩”。我相信原因很明显，为什么 facebook 不允许这样做。而是尝试为您的公司的整个杂志收藏或“xxxxxx 的玩家杂志”设置一个赞按钮。

这应该有助于解决问题，而无需要求 facebook 重写整个 API。

# sql - 在 RAISERROR 中连接消息

> ID：10032914
> 
> 赞同：38
> 
> 时间：2012-04-05T17:07:40.330
> 
> 标签：sql, sql-server, sql-server-2008

这里的正确语法是什么？

```
If (@timestamp < (Select PromoStartTimestamp From @promo))
    RAISERROR('Code not valid until ' + (Select PromoStartTimestamp From @promo)
              ,16
              ,1); 
```

我试过了：

```
If (@timestamp < (Select PromoStartTimestamp From @promo))
    RAISERROR(N'Code not valid until @starttimestamp'
              ,16
              ,1
              ,(Select PromoStartTimestamp From @promo)); 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-04-05T17:09:43.253

您可以`%s`在以下位置用作字符串替换参数[`RAISERROR`](http://msdn.microsoft.com/en-us/library/ms177497.aspx)：

```
DECLARE @PromoStartTimestamp DATETIME
DECLARE @PromoStartTimestampString VARCHAR(50)

SELECT @PromoStartTimestamp = PromoStartTimestamp From @promo
SELECT @PromoStartTimestampString = CAST(@PromoStartTimestamp AS VARCHAR)

If (@timestamp < @PromoStartTimestamp)
    RAISERROR(N'Code not valid until %s'
              ,16
              ,1
              ,@PromoStartTimestampString); 
```

# php - 使用 PHP 和 MySQL 进行简单的站点搜索

> ID：10032916
> 
> 赞同：0
> 
> 时间：2012-04-05T17:07:49.517
> 
> 标签：php, mysql, search

我正在寻找一个只涉及 2 或 3 个变量的简单搜索引擎的脚本。

对于我的网站，我有一个名为 search 的数据库表和 3 个字段：url、title 和 content。

有人可以帮我为此构建一个简单的处理脚本吗？我只想搜索标题和内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:10:57.410

您可以创建如下查询：

```
$prepared = $db->prepare('SELECT * FROM search WHERE title LIKE "%:search_value%" OR content LIKE "%:search_value%"');
$prepared->execute(array(':search_value' => $search_value));
$rows = $prepared->fetchAll(); 
```

其中 $db 是一个[PDO 对象](http://php.net/manual/en/book.pdo.php)。

# ruby-on-rails - Ruby On Rails：访问数组？

> ID：10032921
> 
> 赞同：1
> 
> 时间：2012-04-05T17:08:24.907
> 
> 标签：ruby-on-rails, ruby

我有一个存储在变量 temp 中的数组，如下所示：

temp.inspect 输出：

[#"Marlana Letelier", "completed_at"=>nil, "status"=>"incomplete", "name"=>nil, "lead_move_date"=>"2012-06-17 00:00:00", "archive_time "=>nil, "stop_time"=>nil, "priority"=>"2", "assigned_to_user_firstname"=>"Vanessa", "notes"=>"", "created_by_id"=>nil, "id"=> “804005”、“assigned_to_id”=>“1”、“dn_email_id”=>nil、“outcomes_string”=>“其他”、“lead_id”=>“101139”、“flavor”=>“PhonecallTask​​”、“stringified_pa​​rameters” =>"{\n'目的' => '继续联系尝试',\n'电话号码' => '361-946-9905',\n}", "created_at"=>"2011-12-21 13:29:07", "start_time"=>"2012-04-04 17:00:00"}>]

temp.class 将其指定为数组，但 temp[1] 不输出任何内容。

如何访问元素？

**编辑：
1) Temp 要么一无所有，1 个对象或多个对象
2) 检查 nil
3) 取出每个对象
4) 访问属性**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:12:52.150

尽管您的检查输出看起来错误（我认为您缺少一些出现在`<...>`标签中的文本），但看起来您有一个包含单个项目的数组。通过输出 temp.length 验证此假设。

由于 Ruby 中的数组是 0 索引的，请尝试使用`temp[0]`或`temp.first`.

# ocr - 哪个 OCR 引擎更好：Tesseract 还是 OCRopus？

> ID：10032923
> 
> 赞同：32
> 
> 时间：2012-04-05T17:08:40.700
> 
> 标签：ocr, tesseract, feature-extraction

我在 iPhone 上尝试过 Tesseract，在没有图像预处理的情况下评估其准确度为 70%。我还注意到它在提取数字方面可能很差。我听说过 OCRopus OCR 引擎：就数字提取而言，Tesseract 或 OCRopus 哪个更好，以及我的图像预处理是否较低？
有没有人使用两个引擎运行测试并使用通常的指标比较结果？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-06T07:17:26.393

最初 OCRopus 内部实际上是使用 Tesseract 作为识别引擎，但后来他们将其更改为自己的全新引擎。它还很新鲜，还没有成熟。大约一年前我们一直在进行精度比较，OCRopus 肯定输给了 Tesseract，我什至不是在谈论商业 enignes。从那时起，我就停止关注 OCRopus 的进展，但我明确知道 OCRopus 支持论坛上的活动现在接近于零。这意味着，没有人在使用它。大多数人都在使用商业引擎，但如果价格对他们来说是个问题并且他们可以容忍较低的准确性，那么他们会使用 Tesseract。它绝对是开源中最好的之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-14T10:35:51.790

您还可以在“更改”链接中查看项目的活动

[https://code.google.com/p/ocropus/source/list?repo=ocropy](https://code.google.com/p/ocropus/source/list?repo=ocropy)

[https://code.google.com/p/tesseract-ocr/source/list](https://code.google.com/p/tesseract-ocr/source/list)

tesseract 更忙

# c# - C# 使用所有控件保存表单的状态

> ID：10032925
> 
> 赞同：2
> 
> 时间：2012-04-05T17:08:45.700
> 
> 标签：c#, windows, forms

我有一个表格，我有一些按钮可以做一些事情。

当我按下按钮时，Windows 窗体控件（如文本框或组框）会出现和消失并更改窗体上的位置，因为它是动态窗体:)

但是，我想做的是有一个按钮 ( `BACK`)，它将使我的表单恢复到按钮操作之前的状态，将控件放回到操作之前的位置和状态。

我想到了一个`C`MyState() 类，它具有类似于 Form1 的数组。我将在该数组中保存表单状态，当我按下`back`按钮从数组中获取表单状态的“副本”时，可能还有索引状态的索引。

不幸的是，我不知道如何实现这一点。:|

谁能告诉我这样做的正确方法？

```
class Mystate
{
    private Form1 [] state;

    public Mystate(int n)
    {
        this.state = new Form1[n];
    }

    public Form1 this[int index]
    {
        get
        {
            return state[index];
        }
        set
        {
            this.state[index] = value;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T17:54:15.450

听起来您希望表单具有高级撤消/重做功能。

这是此类事情的框架：http: [//www.codeproject.com/Articles/10576/An-Undo-Redo-Buffer-Framework](http://www.codeproject.com/Articles/10576/An-Undo-Redo-Buffer-Framework)

这是一个接近但与您的问题不完全相同的答案（虽然隐含的模式是相同的）：[How to implement good and efficient undo/redo features for a TextBox](https://stackoverflow.com/questions/597792/c-how-to-implement-good-and-efficient-undo-redo-functionality-for-a-textbox)

MementoPattern： http: [//www.codeproject.com/Articles/18025/Generic-Memento-Pattern-for-Undo-Redo-in-C](http://www.codeproject.com/Articles/18025/Generic-Memento-Pattern-for-Undo-Redo-in-C)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:55:01.613

没有这样的内置功能。你必须自己做这件事。

我会这样做：首先，准确定义要保存的状态。例子：

```
Control.Bounds
Control.Text
Checkbox.IsChecked
NumericUpDown.Value
... 
```

现在我们确切地知道需要保存什么。

秒，我们需要一种方法来创建表单当前状态的快照，并递归地为所有控件创建快照。您可以使用反射来实现这一点，这样无论您有多少控件，一切都将是自动的。

第三，您需要能够将快照应用到 Form 的实例。这是（2）的相反过程。这也可以使用反射来完成。

# ruby-on-rails - alias_method、alias_method_chain 和 self.included

> ID：10032927
> 
> 赞同：3
> 
> 时间：2012-04-05T17:08:46.863
> 
> 标签：ruby-on-rails, ruby, alias-method, alias-method-chain

我有点难以理解`alias_method`/ `alias_method_chain`。我有以下代码：

```
module ActionView::Helpers
  module FormHelper

    alias_method :form_for_without_cherries, :form_for

    def form_for(record, options = {}, &proc)
      output = 'with a cherry on top'.html_safe
      output.safe_concat form_for_without_cherries(record, options = {}, &proc)
    end
  end
end 
```

这正是我想要的 - 将“顶部有樱桃”附加到任何`form_for`呼叫的顶部。

但我的理解是，由于某些原因，这不是好的代码。首先，它不会链接任何其他覆盖，`form_for(?)`所以如果我要编写第二个`form_for`附加“顶部还有另一个樱桃”的方法，它就不会显示。其次，`alias_method`并且`alias_method_chain`是过时的解决方案，我应该使用`self.included`& 发送到模块。

但是我不能`self.included`调用这个`form_for`方法——它只是一直调用父方法。这是我正在尝试的：

```
module CherryForm
  def self.included(base)
    base.extend(self)
  end

  def form_for(record, options = {}, &proc)
    output = 'with a cherry on top'.html_safe
    output.safe_concat super(record, options = {}, &proc)
  end 
end

ActionView::Helpers::FormHelper.send(:include, CherryForm) 
```

我的上述解决方案有效，但我怀疑这是错误的做事方式。如果任何红宝石老手可以向我展示一种更优雅的方式 - 和/或为什么不调用第二个解决方案 - 我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T20:08:33.773

当您修补某些东西时，您必须重新定义该方法，因为没有可以继承的超级对象（因此您不能使用第二个代码摘录）。

复制当前的方法实现并添加你自己的只是自找麻烦，所以这就是 alias_method 的用武之地。

```
alias_method :form_for_without_cherries, :form_for 
```

它实际上创建了原始方法的克隆，您可以使用它来代替 super。您不能链接猴子补丁的事实不是错误，而是一个功能。

rails alias_method_chain 方法确实被弃用了，但这只是因为它从一开始就是一个糟糕的主意。然而 alias_method 是一个纯粹的 ruby​​ 方法，如果使用得当，可以提供一种优雅的猴子修补代码的方法，这就是为什么我很确定它不会很快消失的原因。

# android - 在相机设置参数上获取空指针异常

> ID：10032932
> 
> 赞同：1
> 
> 时间：2012-04-05T17:09:14.257
> 
> 标签：android, parameters, nullpointerexception, android-camera

我收到 NullPointerException 错误，它引用行 Camera.Parameters：

```
 @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int w,
        int h) {
    // TODO Auto-generated method stub
        Log.e(TAG, "surfaceChanged");

        if (mPreviewRunning) {
             mCamera.stopPreview();
             mPreviewRunning = false;
             Log.e(TAG, "stopPeview");
            }
        Camera.Parameters p = mCamera.getParameters();
        Log.e(TAG, "paarameters");

        p.setPreviewSize(w, h);

        mCamera.setParameters(p);  
        Log.e(TAG, " set parameters");
            try {
                mCamera.setPreviewDisplay(holder);

                Log.e(TAG, "setPreview");
                } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            mCamera.startPreview();
            mPreviewRunning = true;
    } 
```

谁能告诉我上面代码中的错误是什么。

我将不得不再次对其进行测试以获取日志，但这是整个代码。我确实改变了清单。

```
public class Picture extends Activity implements SurfaceHolder.Callback{

private String TAG;
private LayoutInflater mInflater = null;
private Camera mCamera;
boolean mPreviewRunning = false;
private SurfaceHolder mSurfaceHolder;
private SurfaceView mSurfaceView;
Button takepicture;
byte[] tempdata;

@Override
public void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);

    getWindow().setFormat(PixelFormat.TRANSLUCENT);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);

    setContentView(R.layout.camera_surface);

    mCamera = getCameraInstance (); 

    mSurfaceView = (SurfaceView)findViewById(R.id.surface_camera);
    mSurfaceHolder = mSurfaceView.getHolder();
    mSurfaceHolder.addCallback(this);
    mSurfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

    mInflater = LayoutInflater.from(this);
    View overView = mInflater.inflate(R.layout.cameraoverlay, null);
    this.addContentView(overView, new LayoutParams(LayoutParams.FILL_PARENT,
            LayoutParams.FILL_PARENT));

    takepicture = (Button) findViewById(R.id.button);
    takepicture.setOnClickListener(new OnClickListener() {

    public void onClick(View view) {
                mCamera.takePicture(shutterCallback, mPictureCallback,
                jpegCallback);
        }
    });

}

private Camera getCameraInstance() {
    // TODO Auto-generated method stub
    Camera mCamera = null;
    try {
        mCamera = Camera.open();
    } catch (Exception e) {

    }
    return mCamera;
}

ShutterCallback shutterCallback = new ShutterCallback() {
    @Override
    public void onShutter() {}
};
    PictureCallback mPictureCallback = new PictureCallback() {
    public void onPictureTaken(byte[] data, Camera c) {}
};
PictureCallback jpegCallback = new PictureCallback() {
        public void onPictureTaken(byte[] data, Camera c) {
            if(data != null) {
                tempdata=data;
                done();
            }
        }
    };

    void done(){
        Bitmap bm = BitmapFactory.decodeByteArray(tempdata, 0, tempdata.length);
        String url = Images.Media.insertImage(getContentResolver(),
                bm, null, null);        
        bm.recycle();
        Bundle bundle = new Bundle();
        if(url!=null) {
            bundle.putString("url", url);

            Intent mIntent = new Intent();
            mIntent.putExtras(bundle);
            setResult(RESULT_OK, mIntent);          
        } else {
            Toast.makeText(this, "Picture can not be saved",
                            Toast.LENGTH_SHORT).show();
        }
        finish();
    }
    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int w,
        int h) {
    // TODO Auto-generated method stub
        Log.e(TAG, "surfaceChanged");

        if (mPreviewRunning) {
             mCamera.stopPreview();
             mPreviewRunning = false;
             Log.e(TAG, "stopPeview");
            }
        Camera.Parameters p = mCamera.getParameters();
        Log.e(TAG, "paarameters");

        p.setPreviewSize(w, h);

        mCamera.setParameters(p);  
        Log.e(TAG, " set parameters");
            try {
                mCamera.setPreviewDisplay(holder);

                Log.e(TAG, "setPreview");
                } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            mCamera.startPreview();
            mPreviewRunning = true;
    }   

@Override
public void surfaceCreated(SurfaceHolder holder) {
    Log.e(TAG, "surfaceCreated");
    try {
    mCamera = Camera.open();
    Log.e(TAG, "camera open");

    } catch(Exception e) {}

    }

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    Log.e(TAG, "surfaceDestroyed");

    mCamera.stopPreview();  
    mPreviewRunning = false;
    mCamera.release();        // release the camera for other applications
    mCamera = null;

}
} 
```

此外，日志引用的行是：Camera.Parameters p = mCamera.getParameters();

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:16:29.357

看起来 mCamera 是空的……你初始化了吗？( `mCamera = Camera.open();`)

请参阅[文档](http://developer.android.com/reference/android/hardware/Camera.html)以获取与拍照有关的清单

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:42:37.493

在清单文件中添加以下三行：

```
 <uses-permission android:name="android.permission.CAMERA" />
 <uses-feature android:name="android.hardware.camera" />
 <uses-feature android:name="android.hardware.camera.autofocus" /> 
```

要使用此类拍照，请使用以下步骤：

1) 从 open(int) 中获取一个 Camera 实例。

2) 使用 getParameters() 获取现有（默认）设置。

3）如有必要，修改返回的Camera.Parameters对象并调用setParameters(Camera.Parameters)。

4) 如果需要，调用 setDisplayOrientation(int)。

5) 重要提示：将完全初始化的 SurfaceHolder 传递给 setPreviewDisplay(SurfaceHolder)。没有表面，相机将无法开始预览。

6) 重要提示：调用 startPreview() 开始更新预览表面。必须先开始预览，然后才能拍照。

7) 需要时，调用 takePicture(Camera.ShutterCallback, Camera.PictureCallback, Camera.PictureCallback, Camera.PictureCallback) 来拍摄照片。等待回调提供实际的图像数据。

8) 拍照后，预览显示将停止。要拍摄更多照片，请先再次调用 startPreview()。

9) 调用 stopPreview() 停止更新预览表面。

10) 重要提示：调用 release() 释放相机以供其他应用程序使用。应用程序应立即在 onPause() 中释放相机（并在 onResume() 中重新打开（）它）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-05T07:54:26.320

有很多解决方案，但这是一个对我有用的简单、廉价的选择：

```
try{
   mCamera.autoFocus(autoFocusCB); //Or whatever part of code that crashes
   }
catch(Exception e){
   Log.v("joshtag","THIS PHONE DOES NOT SUPPORT AUTOFOCUS!!"); //a warning, popup, whatever
   } 
```

瞧！陷阱已停用。

当然，不要忘记清单权限....

# javascript - 延迟加载基于控制器命名空间约定的外部 JS/CSS 文件？

> ID：10032936
> 
> 赞同：5
> 
> 时间：2012-04-05T17:09:34.507
> 
> 标签：javascript, jquery, model-view-controller, templating, angularjs

angularJS 是否有任何东西可以基于 ng-controller 命名空间延迟加载外部 JS/CSS 文件？这样以下内容会将 com.myApp.SomeClass.js 和 com.myApp.SomeClass.css 附加到文档头吗？

```
<div ng-controller="com.myApp.SomeClass"></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T21:32:48.540

还没有，但它在 v1.0 之后的作品中。

您的应用程序大到需要它吗？我们有一些令人印象深刻的大型应用程序，但还没有遇到这种需求，因为控制器比编写没有角度的相同行为时要密集得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-10T07:36:08.060

使用慢脚本怎么样？在 angularjs 上延迟加载真的很容易

示例： [https ://github.com/flrngel/slowscript-angular-require-lazyload](https://github.com/flrngel/slowscript-angular-require-lazyload)

慢脚本： [https ://github.com/flrngel/slowscript](https://github.com/flrngel/slowscript)

## 来自网站的核心代码

### 应用程序.js

```
app = angular.module("mainApp", ["ui.router"]).run(function($rootScope){
    $rootScope.$on('$viewContentLoaded',function(){
        slowscript.execute();
    });
});

app.config(function($stateProvider, $urlRouterProvider) {
    $stateProvider.state("sexy", {
        url: "/sexy",
        views: {
            "contents": {
                templateUrl: "/views/test.html",
                controller: "Sexy",
                reloadOnSearch: true
            }
        }
    });
});

app.controller("Sexy", function($scope) {
    slowscript.queue(function(){
        slowscript.$global.sexy($scope);
    });
}); 
```

### test.html（角度视图模板）

```
<div ng-controller="Sexy">
    <input list="univ">
        <datalist id="univ">
            <option ng-repeat="univ in univs" value="{{univ.name}}"></option>
        </datalist>
    </input>
    <input type="submit"></input>
    <noscript src="test.js" type="text/slowscript"></noscript>
</div> 
```

### 测试.js

```
require(['angular','slowscript'],function(angular,slowscript){
    slowscript.$global.sexy=(function($scope){
        console.log("tada~");
        $scope.univs = [{"idx": 1,"name": "asdf"}, {"idx": 2,"name": "bsdf"}];
        $scope.$apply();
    });
    slowscript.queue_execute();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-23T12:28:55.057

**使用股票 AngularJS 1.x 是不可能的**

> 但是，您可以使用[$oclazyload](https://oclazyload.readme.io/)来延迟加载代码文件（js、HTML、CSS）

`$ocLazyLoad`与[UI-Router](https://ui-router.github.io/)等路由器完美配合。它返回一个承诺并使用`resolve`属性来确保在解析视图之前加载文件。

```
angular.module('myApp', ['ui.router', 'oc.lazyLoad'])
     .config(function($stateProvider, $urlRouterProvider, $ocLazyLoadProvider) {
      $stateProvider
          .state('stateA', {
              url: '/stateA',
              controller: 'StateACtrl',
              templateUrl: 'stateA.html',
              resolve: {
                  load: [ '$ocLazyLoad', function($ocLazyLoad) {
                          return $ocLazyLoad.load([
                              {
                                  name: 'stateA',
                                  files: [
                                      'stateA.css',
                                      'stateA.js',
                                  ],
                              },
                          ]);
                      },
                  ],
              },
          })

          .state('stateB', {
              url: '/stateB',
              controller: 'StateBCtrl',
              templateUrl: 'stateB.html',
              resolve: {
                  load: [ '$ocLazyLoad', function($ocLazyLoad) {
                          return $ocLazyLoad.load([
                              {
                                  name: 'stateB',
                                  files: [
                                      'stateB.css',
                                      'stateB.js',
                                  ],
                              },
                          ]);
                      },
                  ],
              },
          });
  }); 
```

我还创建了一个[plunkr](https://plnkr.co/edit/ASvmqXPLtuOREvzmWF2u)来演示一个工作模型。

[文档](https://oclazyload.readme.io/docs)以了解有关可能的配置选项的更多信息。

希望能帮助到你！

# c# - 迭代连通分量算法

> ID：10032940
> 
> 赞同：6
> 
> 时间：2012-04-05T17:09:45.060
> 
> 标签：c#, recursion, iteration, graph-theory

我有一个二分图，我正在寻找最有效的迭代方式将其划分为连接的组件。我的递归版本已经开始在大型数据集上溢出堆栈。我愿意从任何语言/伪代码移植，但为了完整起见，我将使用 C# 进行编码。

我现有的代码专门用于我的数据类型。一个分区是蛋白质，另一个是光谱。Map 和 Set 是 C++ 标准库的类似工作。

```
void recursivelyAssignProteinToCluster (long proteinId,
                                        long clusterId,
                                        Set<long> spectrumSet,
                                        Map<long, Set<long>> spectrumSetByProteinId,
                                        Map<long, Set<long>> proteinSetBySpectrumId,
                                        Map<long, long> clusterByProteinId)
{
    // try to assign the protein to the current cluster
    var insertResult = clusterByProteinId.Insert(proteinId, clusterId);
    if (!insertResult.WasInserted)
        return;

    // recursively add all "cousin" proteins to the current cluster
    foreach (long spectrumId in spectrumSet)
        foreach (var cousinProteinId in proteinSetBySpectrumId[spectrumId])
        {
            if (proteinId != cousinProteinId)
            {
                Set<long> cousinSpectrumSet = spectrumSetByProteinId[cousinProteinId];
                recursivelyAssignProteinToCluster(cousinProteinId,
                                                  clusterId,
                                                  cousinSpectrumSet,
                                                  spectrumSetByProteinId,
                                                  proteinSetBySpectrumId,
                                                  clusterByProteinId);
            }
        }
}

Map<long, long> calculateProteinClusters (NHibernate.ISession session)
{
    var spectrumSetByProteinId = new Map<long, Set<long>>();
    var proteinSetBySpectrumId = new Map<long, Set<long>>();

    var query = session.CreateQuery("SELECT pi.Protein.id, psm.Spectrum.id " + GetFilteredQueryString(FromProtein, ProteinToPeptideSpectrumMatch));

    foreach (var queryRow in query.List<object[]>())
    {
        long proteinId = (long) queryRow[0];
        long spectrumId = (long) queryRow[1];

        spectrumSetByProteinId[proteinId].Add(spectrumId);
        proteinSetBySpectrumId[spectrumId].Add(proteinId);
    }

    var clusterByProteinId = new Map<long, long>();
    int clusterId = 0;

    foreach (var pair in spectrumSetByProteinId)
    {
        long proteinId = pair.Key;

        // for each protein without a cluster assignment, make a new cluster
        if (!clusterByProteinId.Contains(proteinId))
        {
            ++clusterId;

            recursivelyAssignProteinToCluster(proteinId,
                                              clusterId,
                                              pair.Value,
                                              spectrumSetByProteinId,
                                              proteinSetBySpectrumId,
                                              clusterByProteinId);
        }
    }

    return clusterByProteinId;
} 
```

正如 ShinTakezou 建议的那样，我进行了重构以将堆栈放在堆上，并且效果很好。我使用了 digEmAll 示例中的 DepthFirstSearch 方法。

```
var clusterByProteinId = new Map<long, long>();
int clusterId = 0;
var clusterStack = new Stack<KeyValuePair<long, Set<long>>>();

foreach (var pair in spectrumSetByProteinId)
{
    long proteinId = pair.Key;

    if (clusterByProteinId.Contains(proteinId))
        continue;

    // for each protein without a cluster assignment, make a new cluster
    ++clusterId;
    clusterStack.Push(new KeyValuePair<long, Set<long>>(proteinId, spectrumSetByProteinId[proteinId]));
    while (clusterStack.Count > 0)
    {
        var kvp = clusterStack.Pop();

        // try to assign the protein to the current cluster
        var insertResult = clusterByProteinId.Insert(kvp.Key, clusterId);
        if (!insertResult.WasInserted)
            continue;

        // add all "cousin" proteins to the current cluster
        foreach (long spectrumId in kvp.Value)
            foreach (var cousinProteinId in proteinSetBySpectrumId[spectrumId])
                if (!clusterByProteinId.Contains(cousinProteinId))
                    clusterStack.Push(new KeyValuePair<long, Set<long>>(cousinProteinId, spectrumSetByProteinId[cousinProteinId]));
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T18:20:54.257

这是一个辅助类的示例，它包含一个无向图并允许（迭代地）获取它的连接组件：

```
public class Graph<T>
{
    public Dictionary<T, HashSet<T>> nodesNeighbors;
    public IEnumerable<T> Nodes
    {
        get { return nodesNeighbors.Keys; }
    }
    public Graph()
    {
        this.nodesNeighbors = new Dictionary<T, HashSet<T>>();
    }
    public void AddNode(T node)
    {
        this.nodesNeighbors.Add(node, new HashSet<T>());
    }
    public void AddNodes(IEnumerable<T> nodes)
    {
        foreach (var n in nodes)
            this.AddNode(n);
    }
    public void AddArc(T from, T to)
    {
        this.nodesNeighbors[from].Add(to);
        this.nodesNeighbors[to].Add(from);
    }
    public bool ContainsNode(T node)
    {
        return this.nodesNeighbors.ContainsKey(node);
    }
    public IEnumerable<T> GetNeighbors(T node)
    {
        return nodesNeighbors[node];
    }
    public IEnumerable<T> DepthFirstSearch(T nodeStart)
    {
        var stack = new Stack<T>();
        var visitedNodes = new HashSet<T>();
        stack.Push(nodeStart);
        while (stack.Count > 0)
        {
            var curr = stack.Pop();
            if (!visitedNodes.Contains(curr))
            {
                visitedNodes.Add(curr);
                yield return curr;
                foreach (var next in this.GetNeighbors(curr))
                {
                    if (!visitedNodes.Contains(next))
                        stack.Push(next);
                }
            }
        }
    }
    public Graph<T> GetSubGraph(IEnumerable<T> nodes)
    {
        Graph<T> g = new Graph<T>();
        g.AddNodes(nodes);
        foreach (var n in g.Nodes.ToList())
        {
            foreach (var neigh in this.GetNeighbors(n))
                g.AddArc(n, neigh);
        }
        return g;
    }

    public IEnumerable<Graph<T>> GetConnectedComponents()
    {
        var visitedNodes = new HashSet<T>();
        var components = new List<Graph<T>>();

        foreach (var node in this.Nodes)
        {
            if (!visitedNodes.Contains(node))
            {
                var subGraph = GetSubGraph(this.DepthFirstSearch(node));
                components.Add(subGraph);
                visitedNodes.UnionWith(subGraph.Nodes);
            }
        }
        return components;
    }
} 
```

用法：

```
static void Main(string[] args)
{
    var g = new Graph<long>();
    g.AddNodes(new long[] { 1, 2, 3, 4, 5, 6, 7, 8, 9 });
    g.AddArc(1, 2);
    g.AddArc(1, 3);

    g.AddArc(9, 6);
    g.AddArc(6, 7);
    g.AddArc(6, 8);

    g.AddArc(4, 5);

    var subGraphs = g.GetConnectedComponents();

} 
```

您可以使用`Graph<>`该类而不是您的地图，或者如果您想坚持使用您的地图，请查看非常容易理解的代码（在类内部它用于`Dictionary<T,HashSet<T>>`保存节点和弧，因此非常类似于你的方法）

# ruby - 如何在红宝石上签名？

> ID：10032944
> 
> 赞同：1
> 
> 时间：2012-04-05T17:09:52.703
> 
> 标签：ruby, ruby-on-rails-3, gem

我将 Rails 插件转换为带有 echoe 的 ruby​​ gem。当我执行

```
rake install 
```

它给了我以下错误：

```
Private key not found; gem will not be signed. 
```

我需要做什么才能制作签名的宝石？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T01:01:52.153

阅读文档。

此帮助页面的 url 最近更改了，这是新的 url： http: [//guides.rubygems.org/security/](http://guides.rubygems.org/security/)

# android - 收听传入的多部分 SMS 消息

> ID：10032945
> 
> 赞同：1
> 
> 时间：2012-04-05T17:10:00.070
> 
> 标签：android, sms, broadcastreceiver, multipart

我可以捕捉到新收到的短信。但如果那是多部分消息，我的广播接收器会多次接收消息的所有部分。

有没有办法一次接收整个消息 - 就像默认消息传递应用程序一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:31:37.100

圣...！

在阅读了 Android 源代码（[这个文件](https://github.com/android/platform_packages_apps_mms/blob/master/src/com/android/mms/transaction/SmsReceiverService.java)）之后，我意识到这是一个如此愚蠢的问题......

这是我的接收器：

```
@Override
public void onReceive(Context context, Intent intent) {
    Log.d(ClassName, "received SMS");

    Bundle bundle = intent.getExtras();
    if (bundle != null) {
        Object[] pdus = (Object[]) bundle.get("pdus");
        // here is what I need, just combine them all  :-)
        final SmsMessage[] messages = new SmsMessage[pdus.length];
        Log.d(ClassName, String.format("message count = %s", messages.length));
        for (int i = 0; i < pdus.length; i++) {
            messages[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);
        }
    }
}// onReceive() 
```

哎呀...我懒得看我的代码。我已经一次收到了消息的所有部分。

# java - 运行时类路径中是否需要注解类文件？

> ID：10032946
> 
> 赞同：12
> 
> 时间：2012-04-05T17:10:02.950
> 
> 标签：java, annotations

如果一个类被注解，那么该注解的定义是否必须在运行时类路径中才能使用该类？例如，给定注释

```
import java.lang.annotation.ElementType;
import java.lang.annotation.Target;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Retention;
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
public @interface Component {} 
```

我可以执行程序吗

```
@Component
public class Test {
    public static void main(String[] args) {
        System.out.println("It worked!");
    }
} 
```

类路径中没有 Component.class？（在我的测试中我可以，但是这种行为是由规范定义的吗？）

我问是因为存在[冲突的声明](http://faler.wordpress.com/2007/11/21/when-to-use-and-not-to-use-java-annotations/#comments)，是否使用库中的注释会创建对该库的依赖。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T17:27:28.510

运行时注解是注解处理器在运行时处理的元信息。如果在运行时可以访问注解，那么您肯定会在类路径中添加注解。例如junit肯定需要类路径中的注释确定测试方法。

如果没有对注解进行处理，则不需要将其作为类路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-10T10:30:27.430

是的，您可以在类路径中没有 Component.class 的情况下执行程序。此处有更多详细信息：[为什么缺少注释在运行时不会导致 ClassNotFoundException？](https://stackoverflow.com/questions/3567413/why-doesnt-a-missing-annotation-cause-a-classnotfoundexception-at-runtime)

# c# - 从网站检索 JSON (Windows phone 7)

> ID：10032947
> 
> 赞同：0
> 
> 时间：2012-04-05T17:10:08.913
> 
> 标签：c#, json, silverlight, windows-phone-7.1

我正在开发一个包含foursquare的应用程序。我在从网站检索 JSON 时遇到问题。如何在 windows phone 7 中做到这一点？JSON的格式如下：

> {"access_token":"j2hkjb4fgwt54gfdsfs"}

如何检索 JSON 并将“j2hkjb4fgwt54gfdsfs”存储到字符串变量？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:14:55.330

使用[Json.net](http://json.codeplex.com/)怎么样？然后你会做类似的事情

```
JObject.Parse(jsonString)["access_token"].Value<string>() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T20:15:54.910

你真的有两个问题：

1.  您如何从 Foursquare 获取数据？
2.  拥有数据后如何解析数据？

有许多不同的方法可以完成其中的每一个。

可以使用[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)、[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)或任意数量的第三方库（例如[RestSharp](http://restsharp.org/) ）来检索数据。

可以使用 JSON.Net（如 spender 所提到的）、[DataContractJsonSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx)或任何数量的其他库来解析数据。

# php - 处理每次浏览量所需的应用程序范围数据的正确方法

> ID：10032949
> 
> 赞同：1
> 
> 时间：2012-04-05T17:10:20.130
> 
> 标签：php, model-view-controller, zend-framework

我目前参与开发一个用 PHP 编写的更大的 Web 应用程序，它基于一个 MVC 框架，在架构方面与 Zend 框架有很多相似之处。

当用户登录时，我有一个地方应该显示当前用户虚拟积分的余额。此显示需要在每个控制器的每个页面上。

**您将用于获取横向模型数据的代码放在哪里，这不是特定于控制器的，但需要在每个页面视图的站点范围布局中进行，独立于当前控制器？**MVC 或 ZF 负责人将如何做到这一点？你们其他人呢？

我考虑在用户登录时加载余额并将其存储在会话中，但由于余额经常更改，这似乎不正确 - 几乎在每次页面加载时都需要检查和更新它。我还考虑通过向每个控制器添加获取例程来做到这一点，但这似乎也不正确，因为它会导致代码重复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:27:32.077

好吧，你是对的，每个控制器都有例程将是代码重复，不会使你的代码可重用。

与您的问题评论中建议的不同，我不会选择基本控制器，因为基本控制器不是一个好的实践（在大多数情况下），并且 Zend Framework 实现了*Action Helpers*以避免它们。

如果您的局部视图是站点范围的，为什么不编写自己的自定义**视图助手**并从视图助手中获取模型中的数据？然后你可以直接从你的布局中调用这个视图助手。在我看来，只要您不更新/编辑这些数据，从视图中通过模型获取数据根本不会破坏 MVC 设计模式。

您可以在*/view/helpers/*或您的库中添加您的视图助手（然后您也必须注册您的视图助手路径）：

```
class Zend_View_Helper_Balance extends Zend_View_Helper_Abstract
{

    public function balance()
    {
        $html = '';
        if (Zend_Auth::getInstance()->hasIdentity()) {
            // pull data from your model
            $html .= ...;
        }
        return $html;
    }
} 
```

请注意，如果您需要以特定方式格式化代码，您的视图助手也可以调用*部分*视图 ( `render()`, `partial()`, )。`partialLoop()`

这是一个非常简单的例子，但对我来说，你的情况就足够了。如果您想对这些数据进行更多控制并能够根据特定视图（或控制器）对其进行修改（或不修改），那么我建议您查看*Placeholders*。Zend在在线文档中有一个[关于它们的非常好的示例。](http://framework.zend.com/manual/en/learning.view.placeholders.basics.html)

更多关于自定义视图助手的信息[在这里](http://framework.zend.com/manual/en/zend.view.helpers.html#zend.view.helpers.custom)。

当您执行这样的任务时，也请考虑使用[Zend_Cache](http://framework.zend.com/manual/1.11/en/zend.cache.introduction.html)组件，这样您就不必在每次请求后查询数据库，而是每分钟查询一次（取决于您的需要）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:20:44.193

您正在寻找的是[Zend_Registry](http://framework.zend.com/manual/en/zend.registry.using.html)。当您认为需要某种形式的全局变量时，这是您应该使用的组件。如果您在每个页面上都需要它，那么您最好将它添加到您的引导程序中，如果您只在某些地方需要它，请将它添加到相关控制器的 init 方法中。

**应用程序/Bootstrap.php**

```
public _initUserBalance() 
{
    $userId = Zend_Auth::getInstance()->getIdentity()->userId;
    $user = UserService::getUser($userId);
    Zend_Registry::set('balance', $user->getBalance());
} 
```

**应用程序/布局/default.phtml**

```
echo 'Balance = ' . Zend_Registry::get('balance'); 
```

那个小片段应该给你正确的想法！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-06T17:08:00.850

在这种情况下，我通常使用带有钩子的[前端控制器插件](http://devzone.zend.com/1224/front-controller-plugins-in-zend-framework/)`dispatchLoopShutdown()`，该钩子执行所需的数据访问并将数据添加到视图/布局中。然后布局脚本呈现该数据。

可根据要求提供更多详细信息。

**[更新]**

假设您想在布局中显示来自您的数据库（或 Web 服务或 RSS 提要）的最后 X 个新闻项目，与*请求的控制器无关*。

您的前端控制器插件可能如下所示`application/plugins/SidebarNews.php`：

```
class My_Plugin_SidebarNews
{
    public function dispatchLoopShutdown()
    {
        $front = Zend_Controller_Front::getInstance();
        $view = $front->getParam('bootstrap')->getResource('view');
        $view->sidebarNews = $this->getNewsItems();
    }

    protected function getNewsItems()
    {
        // Access your datasource (db, web service, RSS feed, etc)
        // and return an iterable collection of news items
    }
} 
```

确保使用前端控制器注册插件，通常在`application/configs/application.ini`：

```
resource.frontController.plugins.sidebarNews = "My_Plugin_SidebarNews" 
```

然后在你的布局中，像往常一样渲染，也许在`application/layouts/scripts/layout.phtml`：

```
<?php if (isset($this->sidebarNews) && is_array($this->sidebarNews) && count($this->sidebarNews) > 0): ?>
<div id="sidebarNews">
<?php foreach ($this->sidebarNews as $newsItem): ?>
<div class="sidebarNewsItem">
   <h3><?= $this->escape($newsItem['headline']) ?></h3>
   <p><?= $this->escape($newsItem['blurb']) ?></p>
</div>
<?php endforeach; ?>
</div>
<?php endif; ?> 
```

明白了吗？

# c++ - 错误 LNK2001：带有 DLL 的未解析的外部符号

> ID：10032950
> 
> 赞同：1
> 
> 时间：2012-04-05T17:10:25.917
> 
> 标签：c++, visual-studio-2010

我创建了一个 DLL 项目并成功构建了它。然后我尝试在另一个项目 TEST 中使用 DLL，但出现以下错误。

```
Error   1   error LNK2001: unresolved external symbol "public: void __thiscall SnoMessage::setRawMessageName(class ATL::CStringT<wchar_t,class StrTraitMFC_DLL<wchar_t,class ATL::ChTraitsCRT<wchar_t> > >)" (?setRawMessageName@SnoMessage@@QAEXV?$CStringT@_WV?$StrTraitMFC_DLL@_WV?$ChTraitsCRT@_W@ATL@@@@@ATL@@@Z) 
```

我在链接器属性中添加了所需的库，并且还在 TEST 包含目录中添加了头文件。因此该功能正在被识别，但它不断给出这些错误。DLL 由以下文件组成

**SnoMessage.h**

```
#pragma once
#include "StdAfx.h"
class SnoMessage
{
public:
    __declspec(dllexport) SnoMessage(void);
    __declspec(dllexport) ~SnoMessage(void);
    __declspec(dllexport) void setRawMessageName(CString messageName);
    __declspec(dllexport) void setRawMessageType(CString messageType);
    __declspec(dllexport) void setRawMessageAttributes(std::map<CString,CString> attributes);
    __declspec(dllexport) CString getRawMessageName();
    __declspec(dllexport) CString getRawMessageType();
    __declspec(dllexport) std::map<CString,CString> getRawMessageAttributes();

private:
    CString messageName;
    CString messageType;
    std::map<CString,CString> attributes;
}; 
```

**SnoMessage.cpp**

```
#include "stdafx.h"
#include "SnoMessage.h"

SnoMessage::SnoMessage(void)
{
}

SnoMessage::~SnoMessage(void)
{
}

void SnoMessage::setRawMessageName(CString messageName){
    this->messageName = messageName;
}

void SnoMessage::setRawMessageType(CString messageType){
    this->messageType = messageType;
}

void SnoMessage::setRawMessageAttributes(std::map<CString,CString> attributes){
    this->attributes = attributes;
}

CString SnoMessage::getRawMessageName(){
    return messageName;
}

CString SnoMessage::getRawMessageType(){
    return messageType;
}

std::map<CString,CString> SnoMessage::getRawMessageAttributes(){
    return attributes;
} 
```

在测试中，我正在执行以下操作：

**测试.cpp**

```
// test.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include "SnoMessage.h"

int _tmain(int argc, _TCHAR* argv[])
{
    SnoMessage *msg = new SnoMessage();
    msg->setRawMessageName("TEST");
    return 0;
} 
```

如果您需要更多信息，请告诉我，谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-10T21:57:29.670

在您的 dll 中，在您要用于导出定义的某些标头中定义它...

我的出口

```
#ifdef SNOMESSAGE_EXPORTS
#define SNOMESSAGE_API __declspec(dllexport)
#else
#define SNOMESSAGE_API __declspec(dllimport)
#endif 
```

现在在您的 dll 中，您只需定义 SNOMESSAGE_EXPORTS，然后当您的 dll 被编译时，您的类和方法将对 exe 可见。但是，当您在 exe 中包含这些相同的标头时，宏将导入它们而不是导出。

```
 //In the DLL this is == to export, in the executable this is import.  Problem solved.
class SNOMESSAGE_API SnoMessage
{
public:
//...
}; 
```

您不再需要导出每个成员，只需导出类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-09T21:28:59.697

我会将整个类标记为已导出，而不仅仅是其成员函数。此外，按照[此对话](http://www.dreamincode.net/forums/topic/76800-unresolved-external-symbol-in-a-dll/)的建议，您需要指定`__declspec(dllecport)`或`__declspec(dllimport)`基于您是在 DLL 中包含标头还是使用 DLL 的代码；并在 DLL 项目中定义保护宏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-09T22:06:12.320

编译 DLL 时应该有 __declspec(dllexport)，但编译 exe 时应该有 __declspec(dllimport)。执行此操作的最简单方法是在“在 DLL 中”和“在 DLL 之外”时具有不同值的 #define 某处。还要导出整个类而不是单个方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-20T00:48:41.537

有一种情况，dll编译使用C调用，而exe使用标准调用，x64下的链接没有问题，但是使用win32的时候会显示这个链接错误2001。这种情况只需要对win32平台的dll和exe都使用C调用（[https://docs.microsoft.com/en-us/cpp/error-messages/tool-errors/name-decoration?view=msvc-160](https://docs.microsoft.com/en-us/cpp/error-messages/tool-errors/name-decoration?view=msvc-160)）。

# java - Spring 事务管理器调度程序

> ID：10032954
> 
> 赞同：0
> 
> 时间：2012-04-05T17:10:37.637
> 
> 标签：java, spring

美好时光！

Spring 的事务管理器是否使用某种调度程序在超时时使事务失效（如果是，调度程序的检查周期是多少？）还是有另一种机制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:58:30.797

不，超时仅在数据库交互时检查，没有单独的线程来强制执行它。因此，停止的连接将不会被释放，并且超时异常可能会在实际截止日期之后很长时间发生。

如果您想确保连接不会以这种方式卡住，请使用连接池功能，例如 c3p0 的 unreturnedConnectionTimeout 或 bonecp 的 closeConnectionWatch。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:49:04.573

来自 Spring 3.0 文档：

事务超时默认为底层事务系统的默认超时，如果不支持超时则无

这适用于`@Transactional`注释和`<tx:advice>`切点。

# sql - SQL Server 格式日期为 '%Y-%m-%d %I:%M%P' / '2012-04-05 11:56am'

> ID：10032955
> 
> 赞同：3
> 
> 时间：2012-04-05T17:10:47.930
> 
> 标签：sql, sql-server, formatting

我一直发现 SQL Server 日期格式与直觉相反。我很确定我已经知道唯一的答案是使用大量的转换和字符串函数，但我想我会问以防万一。

如何让 SQL Server 将 a 格式化为`datetime`：

```
%Y-%m-%d %I:%M%P or '2012-04-05 11:56am' 
```

我目前的方法涉及用代码拉回数据，`SELECT CONVERT(VARCHAR(19), GETDATE(), 120)`然后在代码中循环服务器/客户端。在将数据导出到 CSV 时，我发现在某些情况下效率低下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T17:43:59.143

```
select 
    cast(datepart(YYYY, GETDATE()) as varchar) + '-' +
    right('0' + cast(datepart(MM, GETDATE()) as varchar), 2) + '-' +
    right('0' + cast(datepart(DD, GETDATE()) as varchar), 2) + ' ' +
    LTRIM(RIGHT(cast(GETDATE() AS varchar), 8)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:45:58.547

```
DECLARE @d AS datetime;
SET @d = '2012-04-04 16:43:00'
SELECT LEFT(CONVERT(VARCHAR, @d, 120), 11) 
       +  RIGHT('0' + LTRIM(SUBSTRING(CONVERT(VARCHAR, @d, 131), 12, 5)), 5) 
       + LOWER(RIGHT(CONVERT(VARCHAR, @d, 131), 2))
--2012-04-04 04:43pm 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:18:48.390

我认为真正的答案是“你不需要”，除非你将 SQL Server 实例升级到 SQL Server 2012。

[格式化 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/hh213505.aspx)

# .net - 0x80005000 安装.NET 4.0补丁后AD绑定错误

> ID：10032960
> 
> 赞同：1
> 
> 时间：2012-04-05T17:11:05.563
> 
> 标签：.net, bind

尝试绑定到 AD 时，我们在 Server 2008R2 上遇到以下错误：

> System.DirectoryServices.DirectoryServicesCOMException(0x80005000) 在 System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIFail) 在 System.DirectoryServices.DirectoryEntry.Bind() 在 System.DirectoryServices.Directory.get_Nativeobject()..."

仅在应用 .NET 4.0 的最新补丁后才会出现此错误。收到错误后，我们在 .NET 4.0 上运行修复，重新启动，然后应用程序正常工作。我们在生产中有此服务器的副本，没有这个问题。有任何想法吗？

# git - git push >> 致命：没有配置推送目标

> ID：10032964
> 
> 赞同：55
> 
> 时间：2012-04-05T17:11:24.803
> 
> 标签：git, github, push, git-push

我仍在阅读一些关于 RoR 的指南，我被困在[部署演示应用程序中](http://ruby.railstutorial.org/chapters/a-demo-app#sec:2.3.5)

我按照指示：

> 随着 Microposts 资源的完成，现在是将存储库推送到 GitHub 的好时机：
> 
> ```
> $ git add .
> $ git commit -a -m "Done with the demo app"
> $ git push 
> ```

这里发生的错误是推送部分..它输出了这个：

```
$ git push
fatal: No configured push destination.
Either specify the URL from the command-line or configure a remote repository using
git remote add <name> <url>
git push <name> 
```

所以我尝试按照说明执行以下命令：

```
$ git remote add demo_app 'www.github.com/levelone/demo_app'
fatal: remote demo_app already exists. 
```

所以我推：

```
$ git push demo_app
fatal: 'www.github.com/levelone/demo_app' does not appear to be a git repository
fatal: The remote end hung up unexpectedly 
```

我可以在这里做什么？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-04-05T17:25:50.763

您指的是本“ [Ruby on Rails 教程”的“](http://ruby.railstutorial.org/chapters/a-demo-app) [2.3.5 部署演示应用程序](http://ruby.railstutorial.org/chapters/a-demo-app#sec:2.3.5)”部分：

在第[2.3.1 节规划应用程序](http://ruby.railstutorial.org/chapters/a-demo-app#sec:planning_the_application)中，请注意他们做了：

```
$ git remote add origin git@github.com:<username>/demo_app.git
$ git push -u origin master 
```

这就是为什么一个简单的`git push`工作（在这里使用一个 ssh 地址）。
您是否遵循了这一步并做出了第一次推动？

```
 www.github.com/levelone/demo_app 
```

这不是推送到 GitHub 存储库的可写 URI。

```
https://levelone@github.com/levelone/demo_app.git 
```

这应该更合适。
检查`git remote -v`返回的内容，如果需要替换远程地址，如[GitHub 帮助页面](http://help.github.com/remotes/)中所述，请使用`git remote --set-url`.

```
git remote set-url origin https://levelone@github.com/levelone/demo_app.git
# or 
git remote set-url origin git@github.com:levelone/demo_app.git 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-04-05T17:25:27.067

将 github 存储库添加为远程的命令（或其中的 URL）并不完全正确。如果我正确理解您的存储库名称，它应该是；

```
git remote add demo_app 'git@github.com:levelone/demo_app.git' 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-12-29T20:47:03.980

我遇到了这个错误，以前我推送过根目录，现在我推送了另一个目录，所以我可以删除这个错误并运行下面的命令。

```
git add .
git commit -m "some comments"
git push --set-upstream origin master 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-03T15:51:35.033

我已经遇到过这个错误。我创建了一个 github 存储库并复制了存储库 Url 并运行以下命令。

```
git remote add service-center-app 'https://github.com/DeveloperAsela/service-centerapp.git' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-02T07:10:52.637

当我在 Github 上使用 Visual Studio Code 时，这发生在我身上。我意识到上游分支由于某种原因是空的，并且推送不知道在哪里推送。使用“同步”解决了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-21T20:35:40.580

我有同样的问题

如果您单击菜单按钮，则使用 vs 代码向下推，拉然后向下滚动以推到和

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2021-10-07T06:14:23.227

第一次推的时候。你应该使用

git push -u 起源大师

# macos - Google AppEngine 无法编译 jsp 文件。苹果系统

> ID：10032967
> 
> 赞同：1
> 
> 时间：2012-04-05T17:11:38.897
> 
> 标签：macos, google-app-engine, jsp, jakarta-ee

我正在尝试在 Eclipse（Indigo/mac os X lion）上的 GoogleAppEngine 上部署我的 Java EE 项目。但我有一个错误：

```
com.google.appengine.tools.admin.JspCompilationException: Failed to compile jsp files. 
```

我检查了我的 JRE 路径，它似乎很好。也许是图书馆？有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:07:18.487

要编译`jsp`文件，您需要`JDK`. 在这里`JRE`没有帮助。

# jquery - 将页面加载到对话框中 多个链接

> ID：10032974
> 
> 赞同：1
> 
> 时间：2012-04-05T17:12:03.817
> 
> 标签：jquery, jquery-ui, modal-dialog

我有来自[http://blog.nemikor.com/2009/04/18/loading-a-page-into-a-dialog/的代码](http://blog.nemikor.com/2009/04/18/loading-a-page-into-a-dialog/)

```
$(document).ready(function() {
    $('#page-help').each(function() {
        var $link = $(this);
        var $dialog = $('<div></div>')
            .load($link.attr('href'))
            .dialog({
                autoOpen: false,
                title: $link.attr('title'),
                width: 500,
                height: 300
            });

        $link.click(function() {
            $dialog.dialog('open');

            return false;
        });
    });
}); 
```

我有一个页面，上面有几个链接，可以打开一个带有内部表单的 jquery 模式，使用此代码它只允许我打开弹出窗口中的第一个链接，它显示在新页面中后的所有链接。 .

我知道每个链接都必须有自己的 id，但我不确定如何重写它以在同一页面上打开多个链接（不是同时）

# javascript - 函数中的jquery变量

> ID：10032979
> 
> 赞同：6
> 
> 时间：2012-04-05T17:12:21.867
> 
> 标签：javascript, jquery, variables

在页面加载时，我设置了一个变量

```
$(document).ready(function() {
  var inv_count = 3;
  }); 
```

但是，当我尝试在函数中引用该变量时，它不起作用。

```
function blah(a,b) {
   alert (inv_count);
   } 
```

为什么是这样？我怎样才能绕过它？

（这里是新手）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-05T17:19:11.597

你有一个[范围](https://developer.mozilla.org/en/JavaScript/Reference/Scope_Cheatsheet)问题，我建议你阅读一下，因为你可以改进你的 javascript 很多，但是你可以通过两种一般的方式来解决它：

```
var inv_count; //you declare your variable in a global scope, it's not very good practice
$(document).ready(function() {
    inv_count = 3;
});
function blah(a,b) {
   alert (inv_count);
} 
```

或者

```
$(document).ready(function() {
    var inv_count = 3;

    function blah(a,b) {
      alert (inv_count);
    }
    //you declare everything inside the scope of jQuery, if you want to acess blah outside use:
   //window.blah = blah;
}); 
```

如果您不知道它们是如何工作的，我还建议您阅读有关[clousures的信息。](https://developer.mozilla.org/en/JavaScript/Guide/Closures)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-05T17:15:45.483

如果您在函数内声明变量，则该变量名将无法在该函数范围之外访问。将声明移到函数外：

```
var inv_count;
$(document).ready(function() {
    inv_count = 3;
}); 
```

# mysql - 将查询从 microsoft sql2005 转换为 mysql

> ID：10032980
> 
> 赞同：1
> 
> 时间：2012-04-05T17:12:32.490
> 
> 标签：mysql, sql-server-2005

有人可以帮助我吗？

我有这个查询：

```
Use StockDataFromSella;
DECLARE @D1 DateTime
DECLARE @D2 DateTime
DECLARE @Interval FLOAT

SET @D1  = '2008-09-21T09:00:00.000'
SET @D2  = '2010-10-20T17:30:00.000'
SET @Interval = 15

;WITH
L0 AS (SELECT 1 AS c UNION ALL SELECT 1),
L1 AS (SELECT 1 AS c FROM L0 A CROSS JOIN L0 B),
L2 AS (SELECT 1 AS c FROM L1 A CROSS JOIN L1 B),
L3 AS (SELECT 1 AS c FROM L2 A CROSS JOIN L2 B),
L4 AS (SELECT 1 AS c FROM L3 A CROSS JOIN L3 B),
Nums AS (SELECT ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS i FROM L4),
Ranges AS(
 SELECT DATEADD(MINUTE,@Interval*(i-1),@D1) AS StartRange,
        DATEADD(MINUTE,@Interval*i,@D1) AS NextRange
        FROM Nums where i <= 1+CEILING(DATEDIFF(MINUTE,@D1,@D2)/@Interval)) 
        ,cte AS ( SELECT * ,ROW_NUMBER() OVER (PARTITION BY 
        Simbolo,r.StartRange ORDER BY [DataOra])      AS RN_ASC
       ,ROW_NUMBER() OVER (PARTITION BY Simbolo,r.StartRange ORDER BY 
       [DataOra] DESC) AS RN_DESC
       FROM Ranges r
       JOIN dbo.tbl1MinENI p  ON p.[DataOra] >= r.StartRange and  
       p.[DataOra]  <  r.NextRange )

SELECT  Simbolo,
  MAX(CASE WHEN RN_ASC=1 THEN [DataOra] END) AS AperturaDataOra,
  MAX(CASE WHEN RN_ASC=1 THEN [Apertura] END) AS [Apertura],
  MAX(Massimo) Massimo,
  MIN(Minimo)  Minimo,
  MAX(CASE WHEN RN_DESC=1 THEN [Chiusura] END) AS [Chiusura],
  SUM(Volume) Volume
  /*MAX(CASE WHEN RN_DESC=1 THEN [DataOra] END) AS ChiusuraDataOra*/
 FROM cte
 GROUP BY Simbolo,StartRange
 ORDER BY AperturaDataOra 
```

在 microsoft sql 2005 2008 中完美运行我想在 mySQL 中使用这个查询。

# javascript - jQuery / js - 根据州和数量选择选项计算税款、小计和总计

> ID：10032982
> 
> 赞同：0
> 
> 时间：2012-04-05T17:12:37.450
> 
> 标签：javascript, jquery, html, shopping-cart

我是 js/jQuery 的新手。原谅这个可怕的剧本。我迷路了。

*****（按照建议使用全局变量 ifTaxRate 更新。）*****

 **我正在尝试根据客户选择的状态和订购数量计算税金、小计和总计，并在屏幕上动态显示。

如果客户来自爱达荷州，我将尝试应用 6% 的销售税率。

选择选项：

```
 <select id="state" value="<?php echo $_SESSION['sstate'] ?>" name="state" class="required" >
   <option value="">Select State</option>
   <option value="AK">Alaska</option>
   .
   <option value="ID">Idaho</option>
   .
   .
   <option value="WY">Wyoming</option>
</select>

<select id="orderquantity" name="orderquantity">
   <option value="1">1 Bottle (30 Day Supply)</option>
   .
   .
   <option value="8">8 Bottles (240 Day Supply)</option>
</select> 
```

显示信息的 div：

```
<div class="quantityselected"></div>
<div class="productprice"></div>
<div class="pricequantity"></div>
<div class="subtotal"></div>
<div class="tax"></div>
<div class="shipping"></div>
<div class="total"></div> 
```

真正糟糕的 js 尝试：

```
<script type="text/javascript">
      var ifTaxRate;
      $(document).ready(function() {
          $("#state").change(function() {
            if ($(this).val() == 'ID') {
              ifTaxRate = .06;
            } else {
              ifTaxRate = 0;
            }
          });
        });

      function doMath() {
            var quant = parseInt(document.getElementById('orderquantity').value);
            //change price here
            var price = 69.99;
            var tax = ifTaxRate;
            //change flat shipping cost here
            var shipping = 4.99;
            var subtotal = quant * price;
            var taxtotal = tax * subtotal;
            var total = subtotal + tax;

            $('.quantityselected').value = quant;
            $('.productprice').value = price;
            $('.pricequantity').value = subtotal;
            $('.tax').value = taxtotal;
            $('.shipping').value = shipping;
            $('.total').value = shipping;
        }
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:19:50.270

我在这里看到的一个大问题是您的`iftax`变量是在您作为参数传递的匿名函数的范围内声明的，`$('state').change();`
您必须将其声明为全局变量，而不是在所述函数中重新声明它：

```
var ifTaxRate = 0; //new    
$(document).ready(function() {
   $("#state").change(function() {
      if ($(this).val() == 'ID') {
         ifTaxRate = .06;
      } else {
         ifTaxRate = 0;
      }
      doMath();//new
   });
   //this way every time you change a select box value, doMath() is called
   $('select').change(doMath);
}); 
```

这样，它就可以在您需要的任何地方访问...

# 更新

至于没有在 div 中显示的内容，请不要使用

```
$('.quantityselected').value = quant; 
```

它不起作用有两个不同的原因：首先：（`.value = ...`在`.val(...)`jQuery 中）是本机 javascript，在 jQuery 对象中不起作用
第二：值是输入和选择控件的属性，您必须设置 div `.innerText`（`.text()`在 jQuery 中）和`.innerHTML`（`.html()`在 jQuery 中）

采用：

```
$('.quantityselected').html(quant);
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:16:58.310

您的问题很可能是**范围**之一。

由于您在状态更改函数的闭包内声明变量，因此从您的方法`iftax`中看不到它。`doMath`

在内部，您应该在顶层*声明*变量，然后仅从 state-change 函数*分配给它：*

```
<script type="text/javascript">
  var iftax;

  $(document).ready(function() {
      $("#state").change(function() {
        if ($(this).val() == 'ID') {
          iftax = .06;
        } else {
          iftax = 0;
        }
      });
    });

    // rest as before 
```

（在一个完全不同的主题上，调用变量`ifTaxRate`或类似变量会更清楚，因为目前我认为它可能与应缴税额混淆，尤其是在与和*相同*的上下文中使用时。）`price``shipping`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:17:37.890

在文档就绪函数中声明的变量“iftax”是该函数的本地变量。doMath 函数中提到的 iftax 将查看全局范围（window.iftax），我猜这是未定义的。

尽管使用全局变量有点反模式，但如果您从文档就绪函数中的所有位置（当前写为“var iftax”）中删除“var”，它将默认为全局变量并且您的代码应该可以工作。**

# regex - SAS 中的正则表达式匹配

> ID：10032985
> 
> 赞同：2
> 
> 时间：2012-04-05T17:12:43.327
> 
> 标签：regex, perl, sas

我有 1 个美元符号 ($) 的观察值和 2 个美元符号 ($) 的观察值。我想为每种类型的观察分配不同的值。它应该看起来像这样：

“$200 $300” 被分配 1。 “$200” 被分配 2。

我整天都在尝试使用 Perl 通配符，但没有运气。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T17:56:57.507

SAS`countc()`函数如何计算'$'出现的次数？

```
%put %sysfunc(countc($300 $400,'$'));  /* returns 2 */
%put %sysfunc(countc($300 ,'$'));      /* returns 1 */ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T17:22:48.970

您可以使用[goatse 运算符](http://socialtext.net/perl5/goatse_operator)：

```
my @str = ( '$200 $300', '$200' );

foreach my $str ( @str ) {
    my $count =()= $str =~ /\$/g;
    print "count for $str is $count\n";
} 
```

然后根据您`$count`的情况，相应地分配值。

# android - Android更改标签图像（不是背景）

> ID：10032987
> 
> 赞同：0
> 
> 时间：2012-04-05T17:12:44.800
> 
> 标签：android

我正在使用具有 3 个选项卡的 TabHost。每个选项卡都有一个图像+文本。

```
spec = tabHost.newTabSpec("MyTasks")
           .setIndicator(Html.fromHtml("<b><H2>My Tasks</H2></b>"),  getResources().getDrawable(R.drawable.task ))
               .setContent(intent);    
   tabHost.addTab(spec); 
```

我想在选择标签时更改图像。我用下面的代码来改变它......

```
 TabWidget tw = getTabWidget(); 
   View leftTabView = tw.getChildAt(0); 
   leftTabView.setBackgroundDrawable(getResources().getDrawable(R.drawable.tab1_drawable)); 
```

tab1_drawable 是一个 xml（每个状态的选择器和项目）。这是设置和更改背景，而不是我设置的图像。我怎样才能改变它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:36:37.503

与其通过代码更改可绘制对象，不如使用[状态列表可绘制对象](http://developer.android.com/guide/topics/resources/drawable-resource.html#StateList)？然后，您只需在选项卡被选中时为其指定不同的可绘制对象。

例如，ic_tab_tasks.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/ic_tab_tasks_selected"
          android:state_selected="true" />
    <item android:drawable="@drawable/ic_tab_tasks_normal" />
</selector> 
```

然后，当您最初设置选项卡指示器的可绘制对象时，只需使用状态列表可绘制对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T17:36:02.297

尝试这个 ：

```
 private int index_tab = 0;  
  private TabWidget tabWidget;  
    @Override  
    protected void onCreate(Bundle savedInstanceState) {  
        super.onCreate(savedInstanceState);  
        setContentView(R.layout.index_layout);    
        TabHost t = (TabHost)findViewById(R.id.testhost);   
        t.setOnTabChangedListener(new OnTabChangeListener() {  
            @Override  
            public void onTabChanged(String tabId) {  
                tabChanged(tabId);  
            }  
        });  
    } 
 public void tabChanged(String tabId) {  
  if (index_tab != (Integer.valueOf(tabId) - 1)) {  
    tabWidget.getChildAt(Integer.valueOf(tabId) - 1)  
      .setBackgroundDrawable(  
       getResources().getDrawable(R.drawable.tab1_drawable));  
       tabWidget.getChildAt(index_tab).setBackgroundDrawable(null);  
        index_tab = Integer.valueOf(tabId) - 1;  
    }  
} 
```

# html - 块中的图像显示- CSS

> ID：10032988
> 
> 赞同：1
> 
> 时间：2012-04-05T17:12:47.377
> 
> 标签：html, css

 我有一个如下页面；

```
<style type="text/css">
#div1 {
    height: 100px;
    background-color: #CCCCCC;
}
#div2 {
    display: inline;
    height: 48px;
    margin: 0;
    padding: 0;
    position: relative;
    white-space: nowrap;
}
#div2 a {
    display: block;
    background-color: #FF9900;
    height: 51px;
    width: 150px;
    padding-right: 50px;
    text-decoration: none;
    word-wrap: break-word;
    white-space: normal;
}
#div2 img {
    border:0;
    float: right;
}
</style>

<div id="div1">
    <div id="div2">
        <a href="">text1 text2 text3 text4  text5 text6 text7 text8<img src="image.jpg"></a>
    </div>
</div> 
```

我得到的是这样的；

![当前的](../Images/0ccb5a7335a9081312de53f9b1ec17e7.png)

我想要这个；

![结果](../Images/374c0bc9f5b38c022dde9c070b45452e.png) 

****[这](http://jsfiddle.net/blasteralfred/erUxF/)**是小提琴。**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:25:09.077

请参阅小提琴的代码和演示

小提琴：http: [//jsfiddle.net/bfAdE/1/](http://jsfiddle.net/bfAdE/1/)

演示：http: [//jsfiddle.net/bfAdE/1/embedded/result/](http://jsfiddle.net/bfAdE/1/embedded/result/)

注意：由于我没有图像，所以我只是将边框红色放在 img 标签上并设置演示的宽度和高度。

不锈钢：

![在此处输入图像描述](../Images/0595e9c5d01976d9fa8968f086ed61a0.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:21:37.153

您需要添加`position: relative;`to`#div2 a`和`position: absolute; right: 0; top: 0;`to `#div2 img`。

***[请参阅工作 jsFiddle](http://jsfiddle.net/DotNetScott/pAhvY/)：***

**HTML：**

```
<div id="div1">
    <div id="div2">
        <a href="">text1 text2 text3 text4  text5 text6 text7 text8<img src="http://i.imgur.com/VlyB1.jpg"></a>
    </div>
</div>​ 
```

**CSS：**

```
#div1 {
    height: 100px;
    background-color: #CCCCCC;
}
#div2 {
    display: inline;
    height: 48px;
    margin: 0;
    padding: 0;
    position: relative;
    white-space: nowrap;
}
#div2 a {
    position: relative;
    display: block;
    background-color: #FF9900;
    height: 51px;
    width: 150px;
    padding-right: 50px;
    text-decoration: none;
    word-wrap: break-word;
    white-space: normal;
}
#div2 img {
    border:0;
    position: absolute;
    right: 0;
    top: 0;
}​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T17:27:08.343

试试这个：http: [//jsfiddle.net/erUxF/16/](http://jsfiddle.net/erUxF/16/)

通过相对定位 div2，您拥有绝对定位元素的内置魔法，这些元素相对于 div2，而不是页面，因此您可以使用 left、right 和 top 将 img 放在您想要的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T17:21:58.377

您可以尝试定位您的元素，而不是依赖浮动。

添加以下内容：

```
#div2 a { position:relative}
#div2 img {position:absolute; top:0; right:0;} 
```

还要从你的 img 中删除浮动。

请参阅此处的示例[http://jsfiddle.net/brZdW/1/](http://jsfiddle.net/brZdW/1/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T17:25:08.063

这是有效的：

CSS：

```
#div1 {
    height: 100px;
    background-color: #CCCCCC;
}
#div2 {
    display: inline;
    height: 48px;
    margin: 0;
    padding: 0;
    position: relative;
    white-space: nowrap;
}
#div2 a {
    display: block;
    background-color: #FF9900;
    height: 51px;
    width: 200px;
    padding-right: 0px;
    text-decoration: none;
    word-wrap: break-word;
    white-space: normal;
}
#div2 img {
    border:0;
    float: right;
} 
```

HTML：

```
<div id="div1">
    <div id="div2">
        <a href=""><img src="http://i.imgur.com/VlyB1.jpg"><span>text1 text2 text3 text4 text5 text6 text7 text8</span></a>
    </div>
</div> 
```**

# .net - 正则表达式仅匹配整个单词中的数字

> ID：10032994
> 
> 赞同：1
> 
> 时间：2012-04-05T17:13:12.913
> 
> 标签：.net, regex

我想使用 .NET 匹配字符串中的正数和负数（无小数或千位分隔符），但我只想匹配整个单词。所以如果一个字符串看起来像

```
redeem: -1234
paid: 234432 
```

那么我想匹配 -1234 和 234432

但是如果文本是

```
LS022-1234-5678
FA123245 
```

那么我不想返回任何匹配项。我试过了

```
\b\-?\d+\b 
```

但它只会在第一种情况下匹配 1234，而不返回“-”符号。

任何帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T17:31:27.140

好吧，我敢肯定这远非完美，但它适用于您的示例：

```
(?<=\W)-?(?<!\w-)\d+ 
```

如果你想在数字之前允许下划线，那么我会使用这个修改：

```
(?i)(?<=[^a-z0-9])-?(?<![a-z0-9]-)\d+ 
```

让我知道任何问题，我会尽力提供帮助。如果你想让我解释其中任何一个，也请告诉我。

***编辑***

仅在数字/负号之前有空格或制表符时才匹配（如下面的评论中所述），可以使用：

```
(?<=[ \t])-?\d+ 
```

*请注意，它将匹配例如电话号码、时间或日期值的第一个数字系列，并且如果数字位于行首（换行符之后）则不匹配*- 确保这是您想要的：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:14:49.197

空格 和 之间没有单词边界`-`，因此您不能`\b`在那里使用。

你可以使用：

```
(?<!\S)-?\d+\b 
```

或者

```
(?<![\w-])-?\d+\b 
```

取决于您的要求（未完全指定）。两者都适用于您的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-19T17:55:52.570

该`\b-?\d+\b`模式是错误的，因为`\b`在可选`-?`模式之前需要一个单词 char 立即出现在连字符的左侧。通常，不要在可选模式旁边使用单词边界（除非您当然知道自己在做什么）。

**您可以使用`-?\b\d+\b`来匹配** `123`或`-123`喜欢**数字作为整个单词**。但是，在这里，您正在寻找一些不同的东西，因为`1234`and`5678`是里面的整个单词，`LS022-1234-5678`因为它们用非单词字符（即连字符）括起来。

在这种情况下，您需要`\b`通过左侧的额外后向检查来扩展整个单词匹配：

```
-?\b(?<!\d-)\d+\b 
```

请参阅[正则表达式演示](https://regex101.com/r/rffsZQ/3)。*详情*：

*   `-?` - 一个可选的连字符
*   `\b`- 单词边界
*   `(?<!\d-)``-`- 如果在当前位置的左侧有一个数字 +，则匹配失败的负向后查找。
*   `\d+`- 一位或多位数字
*   `\b`- 单词边界。

请参阅[C# 演示](https://ideone.com/EvqipM)：

```
using System;
using System.Linq;
using System.Text.RegularExpressions;

public class Test
{
    public static void Main()
    {
        var text = "LS022-1234-5678, FA123245, redeem: -1234, paid: 234432";
        var matches = Regex.Matches(text, @"-?\b(?<!\d-)\d+\b").Cast<Match>().Select(x => x.Value).ToList();
        foreach (var s in matches)
            Console.WriteLine(s);
    }
} 
```

输出：

```
-1234
234432 
```

# objective-c - 我想实现一个半 UITableView 半 MapView UIView，中间有一个按钮

> ID：10032996
> 
> 赞同：7
> 
> 时间：2012-04-05T17:13:30.737
> 
> 标签：objective-c, ios, uitableview, uibutton, mkmapview

好吧，这就是我想在我的应用程序中做的事情：我想在屏幕的上半部分实现一个带有地图的 UIView，在另一半实现一个表格视图，中间有两个按钮。如果我按下其中一个按钮，地图将全屏显示，如果我按下另一个按钮，tableView 将适合所有屏幕。

有什么建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T17:29:28.077

在像 UINavigationController 这样的视图控制器中，创建一个具有视图上半部分大小的框架的 MKMapView，并将其添加为视图控制器的子视图。然后我会创建一个 UIToolbar 来保存您的按钮，并使其框架的顶部与 MKMapView 的底部对齐。最后创建一个 UITableView ，它的框架就在其他框架的下方（确保你连接了它的代表）。

然后将使地图全屏显示的 UIBarButtonItem 的目标分配给为所有三个视图的帧设置动画的方法，如下所示：

```
[UIView animateWithDuration:0.24 
                      delay:0.0
                    options:UIViewAnimationCurveEaseOut
                 animations:(void (^)(void)) ^{
                     self.toolbar.frame = CGRectMake(0, MAP_HEIGHT_FULLSCREEN, 320, TOOLBAR_HEIGHT);
                     self.mapView.frame = CGRectMake(0,0,320,MAP_HEIGHT_FULLSCREEN);
                     self.tableView.frame = CGRectMake(0, MAP_HEIGHT_FULLSCREEN+TOOLBAR_HEIGHT, 320, MAP_HEIGHT_FULLSCREEN-MAP_HEIGHT);
                 }
                 completion:^ (BOOL finished){}
 ]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T17:15:17.033

按照您的计划创建两个视图，单击一个按钮，更改一个视图的框架以适应全屏，如果单击另一个按钮，对另一个视图执行相同的操作。

# c - 对文件系统的性能进行基准测试

> ID：10032998
> 
> 赞同：2
> 
> 时间：2012-04-05T17:13:57.393
> 
> 标签：c, filesystems, benchmarking

这个学期我要上计算机组织课。

我的教授给我们布置了作业。描述如下：

**编写一个程序来对两个文件系统 Windows 和 Linux 进行基准测试。讨论哪个表现更好。**

我想用 C 来完成这个家庭作业，但我不知道如何开始。

我需要什么功能？我可以做什么？

请给我一些提示或例子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T17:23:10.920

您可以从[bonie++](http://www.coker.com.au/bonnie++/)下载源代码并查看它们是如何实现的。

但我认为最好的方法是写入硬盘并查看写入或读取定义的数据需要多长时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T17:41:15.747

一些有趣的数据点仅用于文件读/写：

*   冷缓存与热缓存，
*   单线程？并发线程？
*   posix aio vs windows 重叠 i/o（单线程？多线程？）

您还可以测量目录枚举和遍历的速度。

请记住，Linux 和 Windows 都支持许多文件系统；ext4 和 NTFS 分别在 Linux 和 Windows 上使用最广泛。

您应该使用哪些功能？对于 unix，有基本的`read(2)`和`write(2)`调用（对于普通的阻塞 IO）。Windows 具有[`ReadFile`和`WriteFile`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365467%28v=vs.85%29.aspx).