# StackOverflow 问答 000677000-000677999

# asp.net-ajax - ajax 模态弹出扩展器 - 控件嵌套

> ID：677002
> 
> 赞同：0
> 
> 时间：2009-03-24T11:27:05.783 标签 + jQuery .clone() =?
> 
> 标签：asp.net-ajax

我是 ajax 新手，一直在玩扩展器。我一直在制作一些网络表单并在它们上使用模态弹出扩展器来获取用户反馈和通知。

我似乎无法找到答案的一个问题是如何控制弹出窗口的嵌套方式？

所以说我有3个弹出窗口。如何设置一些属性以允许我将 Popup1 ontopof Popup2 Popup2 ontopof Popup3 等

这里的任何帮助将不胜感激。

提前谢谢你，巴里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-13T23:01:01.167

这可以通过 CSS 或 javascript 更改 z-index 来完成

见[http://forums.asp.net/p/1067281/2152419.aspx](http://forums.asp.net/p/1067281/2152419.aspx)

以我个人的经验为例，CalendarExtenders 不会显示在顶部 od ModalPopupextenders 上，因为最新版本 (30930) 中存在错误。我降级到（30512），一切正常。

PD 我正在使用 .NET 3.5 和 VS2008

希望这可以帮助

# iphone - 如何在 iPhone 中放大图像？

> ID：677006
> 
> 赞同：3
> 
> 时间：2009-03-24T11:27:23.990
> 
> 标签：iphone

我需要在 iphone 中放大图像...当用户双击图像时，它将被放大，而在下一次单击时，它将被缩小...。谁能指导我如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T11:49:39.083

您可能必须使用, 方法触发的`size`属性。`UIImage``UIImageView``touchesBegan`

如果您希望缩放效果平滑，也可以使用动画。

另一种选择可能是将您的`UIImageView`内部 a`UIScrollView`或使用 a `UIWebView`。

另外，我建议你看看[Three20](http://github.com/joehewitt/three20)项目。我认为`TTPhotoView`支持缩放。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-07T21:32:15.917

如果你想缩放*和滚动*你的视图，你需要一个 UIScrollView。以前想用它来做你想做的事很难，现在 UIScrollView 的程序化缩放问题已经解决了。

我已经描述了如何做到这一点，创建了 ZoomScrollView 类（UIScrollView 的一个插入子类）来封装解决方案，并在[github.com/andreyvit/ScrollingMadness/](http://github.com/andreyvit/ScrollingMadness/)上提供了一个工作示例（自述文件包含两个 UIScrollView 技巧的详细描述以及它们背后的原因）。

# asp.net - 如何在 Asp.net 中以数据表达式语法访问父数据源？

> ID：677015
> 
> 赞同：0
> 
> 时间：2009-03-24T11:30:53.717
> 
> 标签：asp.net, databound-controls, nested-controls

我在 TemplateField 中有一个用于 GridView 的中继器。GridView 绑定到datasource1，repeater 绑定到datasource2。如何在转发器项模板的数据绑定语法 (<%# %>) 中从转发器的 ItemTemplate 访问 datasource1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T11:40:41.680

看到[这个问题](https://stackoverflow.com/questions/491537/nested-repeaters-and-sqldatasource-parameters)。这个问题与中继器有关，但你明白了。GridView 公开了`RowDataBound`您可以以相同方式处理的事件。

当然，我不相信有一种方法可以通过声明性数据绑定语法来访问它。

# silverlight - Silverlight 和音频合成

> ID：677017
> 
> 赞同：3
> 
> 时间：2009-03-24T11:31:45.210
> 
> 标签：silverlight, audio, synthesis

是否有可能在 Silverlight 应用程序中即时生成声音并播放？即，如果我想播放正弦波，我可以生成一个缓冲区并将其提供给一些媒体 API 吗？

干杯

尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T11:46:01.760

看起来你很幸运...

[http://blogs.msdn.com/gillesk/archive/2009/03/23/playing-back-wave-files-in-silverlight.aspx](http://blogs.msdn.com/gillesk/archive/2009/03/23/playing-back-wave-files-in-silverlight.aspx)

[http://code.msdn.microsoft.com/wavmss/Release/ProjectReleases.aspx?ReleaseId=2417](http://code.msdn.microsoft.com/wavmss/Release/ProjectReleases.aspx?ReleaseId=2417)

你应该能够破解一下这个来合成

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T16:39:48.060

皮特布朗已经有一个工作原型：http: [//community.irritatedvowel.com/blogs/pete_browns_blog/archive/2009/03/23/Creating-Sound-using-MediaStreamSource-in-Silverlight-3-Beta.aspx](http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2009/03/23/Creating-Sound-using-MediaStreamSource-in-Silverlight-3-Beta.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-02T16:23:23.923

Charles Petzold 有最好的例子：http: [//www.charlespetzold.com/blog/2009/07/Simple-Electronic-Music-Sequencer-for-Silverlight.html](http://www.charlespetzold.com/blog/2009/07/Simple-Electronic-Music-Sequencer-for-Silverlight.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-02T16:54:51.303

您还可以查看由[Archetype创建的](http://archetype-inc.com/)[此示例](http://www.microsoft.com/silverlight/silverlight/demos/RawAV/default.html)：

# regex - Emacs：正则表达式替换以改变大小写

> ID：677021
> 
> 赞同：57
> 
> 时间：2009-03-24T11:33:07.860
> 
> 标签：regex, emacs, replace

每隔一段时间，我想替换所有值的实例，例如：

```
<BarFoo> 
```

和

```
<barfoo> 
```

即用正则表达式替换尖括号内的所有内容，用它的小写等效项。

有人有一个很好的 Lisp 片段可以做到这一点吗？假设我们只处理 ASCII 值是安全的。任何足以采用完整正则表达式的通用内容的加分点，并且不仅仅处理尖括号示例。仅使用`M-x query-replace-regexp`.

谢谢，

多姆

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-03-24T11:38:16.333

尝试`M-x query-replace-regexp`使用`"<\([^>]+\)>"`作为搜索字符串和`"<\,(downcase \1)>"`替换。

这应该适用于 Emacs 22 及更高版本，有关如何在替换字符串中使用 Lisp 表达式的更多详细信息，请参阅此[Steve Yegge 博客文章。](http://steve-yegge.blogspot.com/2006/06/shiny-and-new-emacs-22.html)

对于早期版本的 Emacs，您可以尝试以下操作：

```
(defun tags-to-lower-case ()
  (interactive)
  (save-excursion
    (goto-char (point-min))
    (while (re-search-forward "<[^>]+>" nil t)
      (replace-match (downcase (match-string 0)) t)))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-25T09:19:00.187

我意识到这个问题很古老，但我刚刚发现如何在版本 22**之前**的 Emacs 中执行此操作（我的版本是 21.3.1），而无需定义自定义 Lisp 函数：使用（在[此 Emacs wiki 页面](https://www.emacswiki.org/emacs/ReplaceRegexpWithLispExpressions)`M-x query-replace-regexp-eval`顶部提到）作为搜索字符串和替换。`<\([^>]+\)>``(concat "<" (downcase \1) ">")`

这应该适用于任何可以定义为部分串联的替换字符串，包括未被任何函数修改的捕获组。例如：

```
<BarFoo baz="Quux"> 
```

可以只小写标签名称：

```
<barfoo baz="Quux"> 
```

通过使用搜索字符串`<\([A-Za-z]+\)\([^>]*\)>`和替换`(concat "<" (downcase \1) \2 ">")`（这也适用于看起来像没有属性的标签的 OP 示例）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-05T19:18:47.190

使用邪恶时，你可以简单地做`:%s/<\([^>]+\)>/<\L\1>`

`\L`负责将以下所有字母小写，这也适用于`query-replace-regexp`.

我没有找到有关 Emacs 的文档，但它似乎与此列表匹配：[https ://www.boost.org/doc/libs/1_44_0/libs/regex/doc/html/boost_regex/format/perl_format.html](https://www.boost.org/doc/libs/1_44_0/libs/regex/doc/html/boost_regex/format/perl_format.html)

# python - 如何通知在不同进程中完成的 SQLite 数据库更改的进程？

> ID：677028
> 
> 赞同：14
> 
> 时间：2009-03-24T11:34:34.207
> 
> 标签：python, sqlite, notifications

假设我有两个或多个处理 SQLite 数据库的进程——一个“播放器”进程和许多“编辑器”进程。

“播放器”进程读取数据库并更新视图 - 在我的情况下，它将是根据存储在数据库中的事件混合到声卡的波形。

“编辑器”进程是该数据库的任何编辑器：它不断更改数据库。

现在我希望播放器能够快速反映编辑更改。

我知道 SQLite 提供挂钩来跟踪同一进程中的数据库更改，但似乎很少有关于如何使用多个进程执行此操作的信息。

我可以不断地轮询数据库，比较记录和触发事件，但这似乎效率很低，尤其是当数据库增长到很大时。

我正在考虑使用日志表和触发器，但我想知道是否有更简单的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T11:55:22.550

关系数据库不是您最好的首选。

为什么？

您希望您的所有编辑器都将更改传递给您的播放器。

您的播放器实际上是所有这些编辑器的服务器。您的播放器需要多个打开的连接。它必须监听所有这些连接以进行更改。它必须显示这些更改。

如果更改非常大，您可以使用混合解决方案，编辑器会保留更改*并*通知玩家。

无论哪种方式，编辑都必须通知他们的玩家他们有更改。这比玩家试图发现数据库中的变化要简单得多。

* * *

更好的设计是一个服务器，它接受来自编辑器的消息，持久化它们，并通知玩家。该服务器既不是编辑器也不是播放器，而只是一个确保所有消息都得到处理的代理。它接受来自编辑和播放器的连接。它管理数据库。

有两种实现。服务器是玩家。服务器与播放器是分开的。服务器的设计没有改变——只有协议。当服务器为播放器时，服务器直接调用播放器对象。当服务器与播放器分离时，服务器会写入播放器的套接字。

当播放器是服务器的一部分时，当从编辑器接收到消息时直接调用播放器对象。当播放器分离时，一个小型阅读器从套接字收集消息并调用播放器对象。

播放器连接到服务器，然后等待信息流。这可以是来自编辑器的输入，也可以是对服务器保存在数据库中的数据的引用。

如果您的消息流量足够小以至于网络延迟不成问题，编辑器会将所有数据发送到服务器/播放器。如果消息流量太大，则编辑器写入数据库并将仅包含数据库 FK 的消息发送到服务器/播放器。

* * *

请在您的问题中澄清“如果编辑器在通知时崩溃，则播放器会永久混乱”。

这听起来像是播放器服务的糟糕设计。除非它没有从各个编辑那里得到状态，否则它不能“永远搞砸”。如果它从编辑器获取状态（例如，但试图反映该状态），那么您应该考虑一种设计，玩家只需从编辑器获取状态并且不会“永久混乱”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-13T21:03:29.777

SQLite 有一个[`update_hook`](https://www.sqlite.org/c3ref/update_hook.html)功能可以满足您的需求。

> SQLite C 接口
> 
> 数据更改通知回调

```
void *sqlite3_update_hook(
    sqlite3*,
    void(*)(void *,int ,char const *,char const *,sqlite3_int64),
    void*
); 
```

> 该`sqlite3_update_hook()`接口使用由第一个参数标识的数据库连接注册一个回调函数，每当在 rowid 表中更新、插入或删除行时将调用该回调函数。先前调用此函数为同一数据库连接设置的任何回调都将被覆盖。

不幸的是，Python sqlite 模块没有公开它......

这是一个稍微复杂的解决方法，它深入到 C api（来自 Python 代码）以利用它： [https ://stackoverflow.com/a/16920926](https://stackoverflow.com/a/16920926)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T11:40:26.547

只需在两个进程之间打开一个套接字，然后让编辑器告诉所有玩家有关更新的信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T12:45:44.410

我认为在这种情况下，我会创建一个流程来管理数据库读/写。

每个想要对数据库进行一些修改的编辑器都会调用这个过程，无论是通过 IPC 还是网络，或者任何方法。

然后，此过程可以通知玩家数据库中的更改。玩家，当他想要检索一些数据时，应该向管理数据库的进程提出它想要的数据的请求。（或者 db 进程在通知更改时告诉它它需要什么，因此不需要来自玩家的请求）

这样做的好处是只有一个进程访问 SQLite DB，因此数据库上没有锁定或并发问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T11:49:30.520

**编辑：**我假设同一台机器上的进程。

在我看来有两种方法：

*   轮询（如您所述），但将其保留为单个值（例如仅保留其他表的 LastUpdateTime 的表）

*   使用目标平台上可用的任何进程间通信。这可能是 Windows 中的事件（例如，在 C# 中（我不知道在 Python 中）ManualResetEvent、AutoResetEvent 或 Mutex，如果您想在每个进程中牺牲一个服务员线程），或者是 Linux 中的[信号](http://www.comptechdoc.org/os/linux/programming/linux_pgsignals.html)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T11:56:09.410

如果它在同一台机器上，最简单的方法是命名管道、带有阻塞 read() 的“播放器”和“编辑器”在修改数据库时将令牌放入管道。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T12:30:20.763

有多少编辑器进程（为什么是进程？），以及您期望多久更新一次？这听起来不是一个好的设计，尤其是考虑到 sqlite 真的对数据库的多个并发访问**不太满意。**

*如果*多个进程有意义**并且**您想要持久化，那么让编辑器通过套接字、管道、共享内存等通知您的播放器然后让播放器（也称为服务器进程）进行持久化可能会更聪明。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-01T14:29:20.487

Sqlite 本身没有实现这一点的机制。我看到的最接近这个问题的特性是监控文件系统。有很多选择。Stackoverflow 对此进行了讨论：[如何查看文件以进行更改？](https://stackoverflow.com/questions/182197/how-do-i-watch-a-file-for-changes).

其他编程语言也有相同的讨论： [如何让我的程序监视 C++ 中的文件修改？](https://stackoverflow.com/questions/931093/how-do-i-make-my-program-watch-for-file-modification-in-c)

# ruby-on-rails - 在 Rails 应用程序中向内置类添加方法

> ID：677034
> 
> 赞同：21
> 
> 时间：2009-03-24T11:38:19.937
> 
> 标签：ruby-on-rails, ruby

我想在 Rails 应用程序中向 Array 类添加一个方法。我应该把这个方法放在哪里？

编辑更清楚，显然我把它放在某个文件中，但是我如何告诉rails应用程序在哪里可以找到它？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-24T12:21:05.327

一种方法是在`lib/rails_extensions.rb`. 然后，像这样添加你的扩展：

```
class Array
  def bring_me_food
    # ...
  end

  def make_tea
    # ...
  end
end

class Hash
  def rub_my_shoulders
    # ...
  end
end 
```

然后在 中`config/environment.rb`，添加：

```
require 'rails_extensions' 
```

您使用从属对象的里程可能会有所不同。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-24T20:31:39.187

默认情况下，当您调用“require”时，Rails 会查找（来自 Rails 边缘源）：

app app/metal app/models app/controllers app/helpers app/services lib vendor

为简单起见，将文件放在 lib/ 中，并在 config/environment.rb 中按名称要求它，或者您可以将其放在 config/initializers/array_extension.rb 中，它会自动加载。

在我工作的地方，我们将核心 Ruby 库的所有扩展都放入了一个插件中，并将其存储在 (Rails.root/)vendor/plugins/utilities/lib/core_ext 中，然后我们需要在插件的init.rb。

给这只猫换皮的另一种方法：如果你说要将核心扩展存储在 Rails.root/core_ext 中，那么你可以将该路径作为加载路径添加到 environment.rb 中的配置块中：

```
Rails::Initializer.run do |config|
  config.load_paths << 'core_ext'
end 
```

然后你可以从任何地方调用“require 'array_extension'”，它就会加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T11:46:13.647

只需将其放入一个新文件中，例如`array_extended.rb`

```
class Array

  def my_new_method()
    ...
  end

end 
```

之后，您可以将此文件包含在`require "array_extended.rb"`. 确保您没有覆盖已经存在的方法，因为这可能会破坏其他功能。

# php - 从 PHP 中打开记事本

> ID：677036
> 
> 赞同：0
> 
> 时间：2009-03-24T11:38:32.603
> 
> 标签：php, string, notepad

我想从 php 文件打开一个记事本，记事本应该包含我在 php 文件中声明为字符串的文本。基本上一个记事本应该打开我从 php 文件传递​​的文本。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T11:43:59.127

如果 PHP 文件在 Web 服务器上执行，则无法使 Web 浏览器打开这样的新进程。我相信你可以想象那将是一个多么大的安全漏洞！

如果您在 CLI 模式下将 PHP 文件作为本地脚本运行，您应该能够像任何其他进程一样启动记事本，例如使用[反引号](http://uk.php.net/language.operators.execution)或[exec](http://uk.php.net/manual/en/ref.exec.php)等。

但是，如果你*真的*想做这个服务器端，你能做的最好的就是有一个使用[Content-Disposition](http://www.w3.org/Protocols/rfc2616/rfc2616-sec19.html#sec19.5.1)标头的 PHP 脚本，例如

```
//tell client we're delivering text
header('Content-type: text/plain');

//hint that it's a downloadable file
header('Content-Disposition: attachment; filename="textfile.txt"');

//output our text
echo "The quick brown\nfox jumps over\nthe lazy dog."; 
```

然后，用户可以保存此文件并在他们选择的编辑器中打开。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T11:47:24.143

您无法让 PHP 在用户机器上打开窗口，因为 PHP 完全在服务器上运行。当输出到达浏览器时，脚本通常会终止 - 你只能做你可以要求浏览器做的事情以及它会让你做什么（使用 HTML / headers 等）。出于安全目的，浏览器不会（或不应该）让任意网站对您的机器做很多事情——例如，它不会让您生成新的 Windows 进程。

我认为你能做的最好的事情是这样的：

```
$string = 'a string';

header('Content-type: text/plain');
header('Content-Disposition: attachment; filename="file.txt"');

echo $string; 
```

这将发送相关的标头，以便浏览器将内容视为纯文本类型的名为 file.txt 的下载。浏览器应提示他们下载可能会在记事本中打开的文件，除非他们更改了 .txt 的文件关联。

但是，除非您要求他们上传文档，否则您将无法恢复用户对文档所做的任何更改，因此我不确定这是否是您想要实现的目标的良好解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T11:43:27.337

可以从 php 执行程序，但只能在服务器端执行。

所以想象一下服务器运行 Windows，它会启动记事本服务器端。

PHP 在服务器上执行，与客户端运行的内容无关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T11:48:20.913

从技术上讲，要做到这一点，您必须创建一个文件，然后使用该文件作为参数执行系统。像这样的东西：

```
//String to show in notepad
$myStringToDisplay = "some text to show in notepad";

//Write this string to a file
$myFile = "somefile.txt";
$fh = fopen($myFile, 'w') or die("can't open file");
fwrite($fh, $myStringToDisplay);
fclose($fh);

//Execute notepad with this file as a parameter
system("notepad.exe ".$myFile); 
```

但是，这将在运行 PHP 文件的服务器上执行记事本（如果甚至在您的服务器上启用了系统调用），这可能不是您想要做的。PHP 不能在客户端机器上执行任何代码，当然也不能通过系统调用在客户端上执行它想要的任何程序（谢天谢地）。这将是一个巨大的安全漏洞。

如果这不能实现所需的功能，请告诉我们您想要做什么以及为什么。这听起来不是一个非常明智的要求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T11:49:14.170

无法从您的 php 应用程序中打开程序。但是您可以使用 PHP 文本编辑器加载文本文件。您还可以加载您正在谈论的值。

[http://www.fckeditor.net/](http://www.fckeditor.net/)就是这样一个编辑器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T11:46:23.023

首先，您可以“创建”文件并用文本填充它。

执行 shell 命令：echo $text >> $filename 然后执行：记事本 $filenameToOpen

而已。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-24T06:07:45.750

要从 php 脚本打开记事本，我们将使用命令行间阶段。首先，我们将创建一个 php 文件，我们将在其中写入：

```
var_dump(popen('notepad','r')); 
```

然后我们将使用一些名称保存它，`notepad.php` 然后打开命令提示符，我们将提供文件的路径来运行我们的文件，如：

```
d:/>wamp>www>php notepad.php 
```

它将运行我们的 php 文件并打开 notpad。

# java - Java中如何使用正则表达式解析HTML？

> ID：677038
> 
> 赞同：16
> 
> 时间：2009-03-24T11:39:32.650
> 
> 标签：java, regex

请问有人可以告诉我一种使用Java中的正则表达式在html文件中查找href和src标签的简单方法吗？
然后，如何获取与标签关联的 URL？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-24T11:41:56.420

使用正则表达式从 HTML 中提取值总是一个错误。HTML 语法要复杂得多，它可能首先出现，而且页面很容易捕捉到非常复杂的正则表达式。

请改用[HTML 解析器](http://www.google.co.uk/search?&q=java+html+parser)。另请参阅[领先的 Java HTML 解析器的优缺点是什么？](https://stackoverflow.com/questions/3152138/what-are-the-pros-and-cons-of-the-leading-java-html-parsers)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-24T13:17:37.967

其他答案都是真的。Java Regex API 不是实现目标的合适工具。使用其他答案中提到的高效、安全且经过良好测试的高级工具。

如果您的问题涉及 Regex API 而不是现实生活中的问题（例如学习目的） - 您可以使用以下代码进行操作：

```
String html = "foo <a href='link1'>bar</a> baz <a href='link2'>qux</a> foo";
Pattern p = Pattern.compile("<a href='(.*?)'>");
Matcher m = p.matcher(html);
while(m.find()) {
   System.out.println(m.group(0));
   System.out.println(m.group(1));
} 
```

输出是：

```
<a href='link1'>
link1
<a href='link2'>
link2 
```

请注意懒惰/不情愿的限定符 *? 必须使用以减少对单个标签的分组。第 0 组是整场比赛，第 1 组是下一场比赛（下一对括号）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-24T12:40:22.877

不要使用正则表达式，使用 NekoHTML 或 TagSoup，它们是提供 SAX 或 DOM 的桥梁，就像在 XML 中访问 HTML 文档的方法一样。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-24T11:56:12.797

如果你想沿着 html 解析路线走下去，我和 Dave 建议使用这里的代码来解析锚标记的字符串数据并打印它们的 href。

因为你只是使用锚标签，你应该只使用正则表达式，但如果你想用解析器做更多的事情。[Mozilla HTML Parser](http://mozillaparser.sourceforge.net/)是最好的。

```
File parserLibraryFile = new File("lib/MozillaHtmlParser/native/bin/MozillaParser" + EnviromentController.getSharedLibraryExtension());
                String parserLibrary = parserLibraryFile.getAbsolutePath();
                //  mozilla.dist.bin directory :
                final File mozillaDistBinDirectory = new File("lib/MozillaHtmlParser/mozilla.dist.bin."+ EnviromentController.getOperatingSystemName());

        MozillaParser.init(parserLibrary,mozillaDistBinDirectory.getAbsolutePath());
MozillaParser parser = new MozillaParser();
Document domDocument = parser.parse(data);
NodeList list = domDocument.getElementsByTagName("a");

for (int i = 0; i < list.getLength(); i++) {
    Node n = list.item(i);
    NamedNodeMap m = n.getAttributes();
    if (m != null) {
        Node attrNode = m.getNamedItem("href");
        if (attrNode != null)
           System.out.println(attrNode.getNodeValue()); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-24T11:50:55.977

我搜索了正则表达式库（[http://regexlib.com/Search.aspx?k=href](http://regexlib.com/Search.aspx?k=href)和[http://regexlib.com/Search.aspx?k=src](http://regexlib.com/Search.aspx?k=src)）

我发现的最好的是

```
((?<html>(href|src)\s*=\s*")|(?<css>url\())(?<url>.*?)(?(html)"|\)) 
```

查看这些链接以获取更多表达式：

[http://regexlib.com/REDetails.aspx?regexp_id=2261](http://regexlib.com/REDetails.aspx?regexp_id=2261)

[http://regexlib.com/REDetails.aspx?regexp_id=758](http://regexlib.com/REDetails.aspx?regexp_id=758)

[http://regexlib.com/REDetails.aspx?regexp_id=774](http://regexlib.com/REDetails.aspx?regexp_id=774)

[http://regexlib.com/REDetails.aspx?regexp_id=1437](http://regexlib.com/REDetails.aspx?regexp_id=1437)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-24T21:30:18.297

正则表达式只能解析正则语言，这就是它们被称为*正则*表达式的原因。HTML 不是正则语言，因此它不能被正则表达式解析。

另一方面，HTML 解析器*可以*解析 HTML，这就是为什么它们被称为 HTML 解析器。

您应该改用您最喜欢的 HTML 解析器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T08:49:23.283

与流行的观点相反，正则表达式是从非结构化文本（HTML 就是）中提取数据的有用工具。

如果您正在执行复杂的 HTML 数据提取（例如，查找页面中的所有段落），那么 HTML 解析可能是要走的路。但是，如果您只需要从 HREF 中获取一些 URL，那么正则表达式就可以正常工作，并且很难破解它。

尝试这样的事情：

```
/<a[^>]+href=["']?([^'"> ]+)["']?[^>]*>/i 
```

# c# - 连接到 Exchange - 入门教程？

> ID：677041
> 
> 赞同：1
> 
> 时间：2009-03-24T11:40:15.457
> 
> 标签：c#, c++, exchange-server

我需要连接到 Exchange-Server 并读取第三方应用程序存储在那里的一些值（BlackBerry Enterprise Server）。

据我了解，我需要将 CDO 与 C++ 一起使用（C# 在这方面似乎效果不佳）。是对的吗？我试着搜索了一下，但似乎有很多不同的方法和很多不同的 API，整个主题让我有点困惑。

谁能指点我一些资源或告诉我从哪里开始？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T13:45:12.567

根据您使用的 Exchange 版本，您有几个选项。

**如果您正在运行 Exchange 2007** Exchange Web 服务 - 与 Exchange 通信的与语言无关的方法以及前进的主要方法。除了大量书籍之外，谷歌搜索 EWS 还会返回许多带有教程和信息的好作品。

[微软的一个例子](http://msdn.microsoft.com/en-us/library/bb408521.aspx)

**如果您运行的是 Exchange 2003 或更早版本，** WebDAV 是一种访问 Exchange 的简单方法，正如 Marc 推荐的那样。网上也有很多很好的教程。它也像 EWS 一样与语言无关。

[Dan 的 WebDAV 101 博客](http://blogs.msdn.com/webdav_101/default.aspx)- 我过去用于 WebDAV 和 EWS 信息的博客。

**任何版本的 Exchange** 如果 C++ 是一个选项，那么还有 MAPI。如果您不熟悉 MAPI 编程，这将是一个学习曲线，但您几乎可以对邮箱及其内容做任何事情。C# 不支持 MAPI。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T13:05:00.807

自从我解决这个问题以来已经至少三年了，但在我看来，最好的解决方案是 C# 和 WebDAV。与其尝试解释我不记得的代码，不如在这里提供我当时编写[的教程的链接。](http://blog.mbcharbonneau.com/2006/10/26/using-net-and-webdav-to-access-an-exchange-server/)一定要查看最后的链接，我记得它们对理解技术是如何工作的非常有帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-03T11:44:52.003

感谢各位的回答！
然而，我最终从[codeplex](http://www.codeplex.com/MFCMAPI)下载了一个名为 MFCMapi 的小工具，并使用提供的源代码作为如何做事的指南。

# database - 如何查看 Oracle 表日志？

> ID：677052
> 
> 赞同：0
> 
> 时间：2009-03-24T11:44:23.543
> 
> 标签：database, oracle, logging

我在 Oracle 中查看了一个表的属性，它有“LOGGING: YES”。如何查询该日志，或者如果它在文件中，我在哪里可以找到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T11:48:16.810

登录一个表只是意味着该表上的所有 DML 都会生成 REDO，例如，如果服务器崩溃，该表将是可恢复的。如果您关闭了 LOGGING，则某些类型的 DML（直接加载）不会导致重做，并且在崩溃后可能无法恢复。

我相信这个选项主要用于数据仓库。

可以在[这里找到一篇关于它的好文章](http://www.databasejournal.com/features/oracle/article.php/3631361/Managing-Tables-Logging-versus-Nologging.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T12:08:55.417

我会回应 Matthew 的回复，但还要补充一点，您可以使用 Flashback Query 语法对“日志”进行排序查询。当然，您实际上是在查询撤消而不是重做，并且性能并不出色。11g 有显着的增强。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T15:06:10.953

您也可以打开审核。这可以审计 INS/UPD/DEL/SEL 的成功和/或失败。它可以将结果写入表或文件系统。

# c# - 在 C# 中打开表单

> ID：677056
> 
> 赞同：0
> 
> 时间：2009-03-24T11:46:05.457
> 
> 标签：c#, winforms

我在第一个表单中有一个按钮。如果我单击该按钮，第二个表单正在打开，如果我再次单击第一个表单中的相同按钮，另一个第二个表单正在打开。我只需要在 c# 中打开一个第二个表单。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T11:51:28.393

那么你可以做一个：

```
Form.ShowDialog() 
```

这将阻止用户单击第一个表单上的按钮，因为第二个表单将保持焦点直到它关闭。

或者你可以做

```
Form2 form2 = null;

void button_click(object sender, EventArgs e)
{ 
   if(form2 == null)
   {
      form2 = new Form2();
      form2.Disposed += new EventHandler(f_Disposed);
      form2.Show();
   }
}

void f_Disposed(object sender, EventArgs e)
{
   form2 = null;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T11:50:32.483

通过存储对它的引用并使用类似的东西来检查表单是否已经显示：

```
if(form2Instance.Visible==true)
    .... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T11:50:58.347

如果您提供一些示例代码，我们将有一个更具体的答案，但听起来您正在按钮单击事件中实例化一个新表单。第一次单击该按钮时，您的第二个表单（将/可能）不存在，因此创建它并在您的第一个表单本地保留对它的引用。然后下次单击按钮时，显示表单而不是重新创建它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T11:52:51.010

我会在类中声明一个私有变量，其中的按钮包含对打开的表单的引用。

如果单击按钮：

*   检查是否为空，
*   如果是，则创建并显示一个新表单，如果不是，则不执行任何操作。

如果只是打开一个表单，您还可以查看 form.ShowDialog()，它会阻止调用者表单，直到新表单关闭。

# javascript - 为什么我的 Dojo 图表中的图例没有显示颜色？

> ID：677061
> 
> 赞同：8
> 
> 时间：2009-03-24T11:48:14.890
> 
> 标签：javascript, dojo

我正在使用道场图表，出于某种原因，我的图表的图例显示的是 x 而不是颜色。

这是我的代码：

```
dojo.require("dojox.charting.Chart2D");
dojo.require("dojox.charting.themes.PlotKit.blue");
dojo.require("dojox.charting.widget.Legend");
dojo.require("dojox.layout.FloatingPane");
dojo.require("dojox.charting.themes.MiamiNice");
dojo.require("dojo.colors");
makeCharts = function(){
var chart1 = new dojox.charting.Chart2D("simplechart");

chart1.addPlot("default", {type: "StackedColumns", markers: true, tension:3, shadows: {dx: 2, dy: 2, dw: 2}});
chart1.addAxis("x",{labels: [{value: 1 , text: '18-Mar'}, {value: 2 , text: '19-Mar'}, {value: 3 , text: '20-Mar'}, {value: 4 , text: '21-Mar'}, {value: 5 , text: '22-Mar'}, {value: 6 , text: '23-Mar'}]});
chart1.addAxis("y", {vertical:true});

chart1.addSeries("Four", [196,209,77,218,48,243]);

chart1.addSeries("One", [266,158,131,228,217,262]);

chart1.addSeries("Three", [296,214,267,80,40,225]);

chart1.addSeries("Two", [207,264,115,227,193,27]);

chart1.setTheme(dojox.charting.themes.MiamiNice);
var legend = new dojox.charting.widget.Legend({chart: chart1, horizontal: true}, "legend");

chart1.render();
}

dojo.addOnLoad(makeCharts); 
```

正如我所说，图表显示完美，但图例上没有任何颜色。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T16:16:29.537

发现问题，图渲染后必须声明图例。

非常感谢#dojo 的人们向我指出更多帮助我注意到这一点的示例。

# c# - 自定义 ListViewItem

> ID：677069
> 
> 赞同：0
> 
> 时间：2009-03-24T11:49:45.260
> 
> 标签：c#, visual-studio, listviewitem

我必须自定义 .NET`ListView`控件。
`ListViewItem`必须具有以下结构：

[替代文字 http://img257.imageshack.us/img257/1575/85834837.jpg](http://img257.imageshack.us/img257/1575/85834837.jpg)

有没有什么好的教程可以帮助我进行这种定制？

我正在使用 Visual Studio 2008，C#。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T12:15:07.197

Scott Guthrie 有一些很棒的教程，涵盖了列表视图控件

[http://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui。 aspx](http://weblogs.asp.net/scottgu/archive/2007/08/10/the-asp-listview-control-part-1-building-a-product-listing-page-with-clean-css-ui.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T12:05:22.243

在普通 Listviewitem 的基础上创建自己的 listviewitem 并进行自己的绘图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-07T14:52:55.533

在 WPF 中，您可以使用 ListViewItem 来描述 ListViewItem 的外观，甚至可以使用 DataTemplate。这是您上述问题的一个非常简单的开始，然后看看您是否可以根据需要使用它。

```
<ListView ItemsSource="{Binding ViewModelList}" >
          <ListViewItem>
            <Grid>
                   <Grid.RowDefinitions>
                         <RowDefinition />
                         <RowDefinition />
                   </Grid.RowDefinitions>
                   <Grid.ColumnDefinitions>
                         <ColumnDefinition />
                         <ColumnDefinition />
                         <ColumnDefinition />
                         <ColumnDefinition />
                   </Grid.ColumnDefinitions>
                   <Image Source="{Binding ImageInViewModel}" 
                          Grid.Column="0" Grid.Row="0" Grid.RowSpan="2"/>
                   <TextBlock Text="{Binding ItemText}" Name="Item Text" 
                              Grid.Row="0" Grid.Column="1" />
                   <TextBlock Name="SubItem1" Text="{Binding SubItem1}"
                              Grid.Row="0" Grid.Column="2" />
                   <TextBlock Name="SubItem2" Text="{Binding SubItem2}"
                              Grid.Row="0" Grid.Column="3" />
                   <Read Comment! Grid.Row="1" Grid.Column="1" Grid.ColSpan="3" />
            </Grid>
          </ListViewItem>
</ListView> 
```

阅读评论：可以有两种方法，而不是将这个特定部分视为您的 ListBoxItem。

1.  您处于当前 ListViewItem 绑定的上下文中，因此您可以描述下一个块以满足您的需要。

2.  您可以使用“中间人” ViewModel，其中包含对另一个 ViewModel 的引用，该 ViewModel 在“Multiline subitem 3”中描述您的内容。这将允许您在这两种类型上使用 DataTemplate 并将每种类型的显示分开。起初，此解决方案很复杂，但看起来更符合您的问题。

# ruby - 我应该为轻量级 IDE 使用哪些设计模式？

> ID：677084
> 
> 赞同：2
> 
> 时间：2009-03-24T11:54:47.683
> 
> 标签：ruby, design-patterns, ide, gtk

我正在编写一个轻量级的 IDE。我为这个任务选择了 Ruby+Gtk2。我已经有了它的最小原型，但是现在，大部分代码都在我的窗口类中。我很快就会开始研究“真正的交易”，但我想知道我应该使用什么设计模式。我也在计划插件支持，以便应用程序可扩展。欢迎任何想法，但请讨论您的选择。

请记住，这是一种脚本语言。我不确定 Java 的所有设计模式是否都适用于此。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T12:01:18.447

设计模式是常见问题的解决方案。你有什么问题？在咨询工作中，我们经常看到当有人开始说“好吧，这是我的想法。我可以使用什么设计模式？”时，架构很快就会变得过于复杂。

与其寻找您可能使用的设计模式，不如阅读设计模式（我**讨厌**链接到 Wikipedia，但[他们的文章](http://en.wikipedia.org/wiki/Design_pattern_(computer_science))确实有一个很好的列表，至少可以让您开始其他搜索），然后在您使用它们时应用它们提出一个符合他们标准的问题。

至于在您的窗口类中有很多代码，这可能适合您的应用程序，或者您可能希望查看类似于松散 MVC 模式的东西。通常对于 GUI 编程，严格的 MVC 会过于严格，并且需要太多工作才能实现“真正的”关注点分离。

没有设计模式可以解决许多常见问题，但这并不意味着解决方案是对还是错。例如，插件支持通常仅通过提供插件接口或插件可以响应的一组事件来提供。或者，您可以查看适配器模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T11:58:31.463

我不确定这是否会有很大帮助，但是“ [Ruby 中的设计模式](http://www.amazon.co.uk/Design-Patterns-Ruby-Addison-Wesley-Professional/dp/0321490452)”一书谈到了 ruby​​ 中的设计模式以及它们与 Java 的设计模式有何不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T12:04:02.293

另外，不要忘记检查现有的 IDE。他们用了什么？

由于编辑将是您的 IDE 的一个组件，因此您应该检查实际的开源编辑器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T15:44:37.480

我不确定这是否合适，但有一本关于用 C# 剖析和构建 IDE 的好书。这本书确实讨论了用于开发 Sharp Develop IDE 的设计模式。SharpDevelop 是一个不错的 IDE，它是开源的，你可能想看看[这本书](https://rads.stackoverflow.com/amzn/click/com/1861008171)和Sharp Develop 的[主页](http://www.icsharpcode.net/OpenSource/SD/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T12:44:04.443

只是为了澄清一个可能的误解：您是否指的是[UI 模式](http://ui-patterns.com/)（而不是软件架构设计模式）？你的问题在我看来这样更有意义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-26T05:11:43.310

设计 ruby​​ GUI 应用程序的最佳方式是使用 visualruby：

[http://visualruby.net](http://visualruby.net)

您可以使您的 GUI 与您的类完全分开。例如，如果你想为下面的类创建一个 GUI，你可以很容易地做到，而不会打扰它：

```
class DataObject

  def initialize(name, address, email, phone)
    @name = name
    @address = address
    @email = email
    @phone = phone
  end

end 
```

您可以通过继承该类并添加 GUI 来为该类创建一个 GUI：

```
class DataObjectGUI < DataObject

  include GladeGUI

  def show()
    load_glade(__FILE__)  #loads glade/DataObjectGUI.glade into @builder
    set_glade_all() #populates glade controls with insance variables from DataObject 
    show_window() 
  end   

end 
```

GladeGUI 界面包含所有的 GUI 魔法。load_glade() 方法将加载文件 DataObject.glade。这是一个包含 Gtk::EntryBoxes 名称、姓名、地址、电话和电子邮件的林间空地表格。表格将显示在屏幕上，所有字段均已填写。

显然 show_window() 将使窗口出现在屏幕上。当您单击“x”按钮时，GladeGUI 会自动调用销毁窗口。

这种设计模式可以用于任何类。一个很好的例子是如果你有一个 ActiveRecord 类，并且你想在屏幕上显示记录。你只是像上面那样子类化，它是可编辑和可保存的。

此示例取自 visualruby.net 上的示例项目之一。

# postgresql - PostgreSQL 是否实现地理空间关系查询？

> ID：677086
> 
> 赞同：17
> 
> 时间：2009-03-24T11:55:24.827
> 
> 标签：postgresql, gis, geospatial

我的公司正在研究不同的数据库提供商，以及他们如何实施地理空间查询以获取与 Lat/Long 的距离以获取许多记录。

我们将研究 PostgreSQL 作为一个潜在的数据库平台。

*   我听说 PostGRE 实现了地理空间查询。它是否正确？
*   是否有一个很好的参考可以提供有关实施的信息？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-24T11:57:22.387

它是[PostGIS](http://postgis.net/)。作为参考，您有[手册](http://postgis.net/docs/manual-2.1)、[维基](http://trac.osgeo.org/postgis/wiki/UsersWikiMain)和[更多...](http://postgis.net/documentation/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-24T12:01:44.857

如果您想在空间上启用 PostgreSQL 数据库，您可以使用[PostGIS](http://postgis.refractions.net/)来实现，它也符合开放地理空间联盟的SQL[简单要素接口标准](http://www.opengeospatial.org/standards/sfs)。

# sql-server - Reporting Services - 对数据源视图 (DSV) 的报表模型 (SDML) 引用

> ID：677101
> 
> 赞同：1
> 
> 时间：2009-03-24T12:04:07.067
> 
> 标签：sql-server, visual-studio, reporting-services

我们有一个临时报告项目，我们在其中创建了几个数据源视图 (DSV) 和几个报告模型 (SDML)。我们经常需要更改与特定 SDML 关联的 DSV，但我们只在一个地方找到它的引用：sdml 文件的“数据源视图名称”属性（可通过 VS 属性窗格获得）。

我们发现在其他任何地方都没有对它的引用，甚至在 sdml xml 代码视图中也没有。但是，奇怪的是，当我们更改“数据源视图名称”属性时，VS 会要求签出 sdml 文件……然后对签出的文件不做任何更改。

最后，当我们关闭项目并重新打开它时，VS 会忘记该属性设置。此行为指向该设置的某种仅在内存中保存的位置...

我们是否遗漏了什么或者是否有人注意到类似的行为？

谢谢。布鲁诺·洛佩斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-03T12:09:43.297

查看您的 ReportModel.smdlproj 文件（项目文件）。在记事本中查看它而不是双击，因为那样只会启动 Visual Studio。

在该`<Models>`部分中，您会发现：

```
 <Models>
    <ModelProjectItem>
      <Name>MySmdlName.smdl</Name>
      <FullPath>MySmdlName.smdl</FullPath>
      <DsvName>MyDsvName</DsvName>
    </ModelProjectItem>
  </Models> 
```

这就是 VS 关联 dsv 和 smdl 文件的方式。

为什么部署时此关联会丢失我不知道，但这可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-21T22:56:04.890

你说的对。我不知道这是设计使然还是其他原因，但您可以尝试这样做：

将 smdl 部署到报表服务器后，单击模型定义部分中的编辑以获取 smdl。这会下载 smdl，并且 xml 中似乎有 DataSourceView 元素！

# sql-server - 向聚集索引添加超过 16 列

> ID：677103
> 
> 赞同：3
> 
> 时间：2009-03-24T12:04:27.533
> 
> 标签：sql-server

有什么方法可以在聚集索引中添加超过 16 列。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T12:11:39.343

从 SQLserver 2008 开始，[没有](http://msdn.microsoft.com/en-us/library/ms143432.aspx). 但是，如果您需要超过 16 列的聚集索引，我怀疑瓶颈在其他地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T12:12:07.627

不，此外，对于组合密钥大小，您的数据总量限制为 900 字节。

引自[创建索引参考](http://msdn.microsoft.com/en-us/library/ms188783(SQL.90).aspx)页。

> 最多可以将 16 列组合成一个复合索引键。复合索引键中的所有列必须在同一个表或视图中。组合索引值的最大允许大小为 900 字节。有关复合索引中变量类型列的更多信息，请参阅备注部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T12:14:41.333

聚集索引中最大的 16 列只能通过纯粹和彻底的疯狂来克服。那种你永远被锁在电脑前的那种，永远不允许尝试这样的事情。

因此，这是不可能的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T12:18:56.097

正如其他人所指出的那样，这是不可能的，甚至是不可取的。聚集索引不是宽键的好选择，[因为](http://msdn.microsoft.com/en-us/library/ms190639.aspx)：

> 聚集索引中的键值被所有非聚集索引用作查找键。在同一个表上定义的任何非聚集索引都将明显更大，因为非聚集索引条目包含聚集键以及为该非聚集索引定义的键列。

如果您对非聚集索引感到满意，那么从 SQL Server 2005 及更高版本开始，您可以使用[包含列](http://msdn.microsoft.com/en-us/library/ms190806.aspx)来克服 900 字节、16 列的限制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T12:19:00.213

不，16 是极限。

但是您可以将这些键组合成一个哈希值。这应该提高速度。当然哈希值应该被索引。

# ruby-on-rails - CSS 问题。如何让蓝图 css 工作 rails tabnav 小部件？

> ID：677105
> 
> 赞同：1
> 
> 时间：2009-03-24T12:05:42.057
> 
> 标签：ruby-on-rails, css, blueprint-css

我需要一个快速的解决方案来在[tabnav 小部件](http://wiki.github.com/paolodona/rails-widgets/tabnav)显示区域内获得一些体面的布局。我已经在布局的其他方面使用了蓝图 css，但是我没有足够的 CSS 代码来弄清楚如何让蓝图容器显示在 tabnav 的内容区域中。

tabnav 的内容区域是`<div class="main_tabnav_content" id="main_tabnav_content">` ，这是相关的 css：

```
.main_tabnav {
    color: #000;
    border-bottom: 1px solid #ccc;
    margin: 13px 0px 0px 0px;
    padding: 0px;
    z-index: 1;
    padding-left: 10px }

.main_tabnav ul {
    margin: 0px;
    padding: 0px;
}

.main_tabnav li {
    display: inline;
    overflow: hidden;
    list-style-type: none; }

.main_tabnav li span.disabled {
        color: #888888;
        background: #FAFAFA;
        border: 2px solid #DDDDDD;
        border-bottom: none;
        padding: 2px 5px 0px 5px;
        margin: 0;
        text-decoration: none;}

.main_tabnav a, main_tabnav a.active {
    color: #000000;
    background: #EEEEEE;
    font-weight: bold;
    border: 1px solid #ccc;
    padding: 2px 5px 0px 5px;
    margin: 0;
    text-decoration: none; }

.main_tabnav a.active {
    background: #FFFFFF;
    border-bottom: 3px solid #FFFFFF; }

.main_tabnav a:hover {
    color: #FFFFFF;
    background: #CCCCCC; }

.main_tabnav a:visited {
    color: #000000; }

.main_tabnav a.active:hover {
    background: #FFFFFF;
    color: #000000; }

.main_tabnav_content {
    background: #FFFFFF;
    padding: 20px;
    border:1px solid #ccc;
    border-top: none;
    z-index: 2;
} 
```

我希望能够像这样在 main_tabnav_content 区域内放置一些列

```
 <div class="span-5 colborder">
       stuff
    </div>
    <div class="span-5 colborder">
        stuff
    </div>
    <div class="span-5 colborder">
       stuff
    </div> 
```

目前显示列，但`main_tabnav_content`框不会在它们周围展开。关于如何将蓝图布局嵌套在该区域内的任何建议`main_tabnav_content`？

来自蓝图：screen.css：

```
.column, div.span-1, div.span-2, div.span-3, div.span-4, div.span-5, div.span-6,  div.span-7, div.span-8, div.span-9, div.span-10, div.span-11, div.span-12, div.span-13, div.span-14, div.span-15, div.span-16, div.span-17, div.span-18, div.span-19, div.span-20, div.span-21, div.span-22, div.span-23, div.span-24 {float:left;margin-right:10px;}
.last, div.last {margin-right:0;}
.span-1 {width:30px;}
.span-2 {width:70px;}
.span-3 {width:110px;}
.span-4 {width:150px;}
.span-5 {width:190px;} 
```

并且：

```
div.colborder {padding-right:24px;margin-right:25px;border-right:1px solid #eee;} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T03:46:42.903

我认为如果您`<div class="clearfix"></div>`在 main_tabnav_content div 结束之前添加它，它应该可以解决浮动问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:01:35.230

你有 span-5 和 colborder 类的 CSS 吗？听起来这可能是一个浮动问题。基本上发生的事情是当您将列添加到`main_tabnav_content`div 时，div 不会扩展，对吗？

# c++ - Visual Studio 2005 - C++ - 控制清单创建的因素

> ID：677106
> 
> 赞同：0
> 
> 时间：2009-03-24T12:07:06.110
> 
> 标签：c++, visual-studio, assemblies, version, manifest

我试图弄清楚为什么调试版本会因“无法找到依赖程序集 microsoft.vc80.debugcrt”事件错误而崩溃。

删除所有内容（不是 .cpp 或 .h 的内容）并重新创建解决方案后 - 我仍然遇到问题。

谷歌搜索没有结果，重新安装 VS 并没有产生任何变化。

我确实在 C:\WINDOWS\WinSxS\x86_Microsoft.VC80.DebugCRT_1fc8b3b9a1e18e3b_8.0.50727.42_x-ww_f75eb16c 中有 dll。

我打开了 \debug\.exe.intermediate.manifest 文件，它有 2 个（dependentAssembly）条目：
第一个：name='Microsoft.VC80.DebugCRT' version='8.0.50608.0'
第二个：name='Microsoft.VC80.DebugCRT '版本='8.0.50727.762'

如果我删除一个并将另一个更改为 name='Microsoft.VC80.DebugCRT' version='8.0.50727.42'

我可以得到一个将开始的构建。

当然，我确实安装了 VS2008 - 但是控制版本的是什么？或者我怎样才能获得正确的调试 dll 版本来“坚持”。

VS2008是通过控制面板卸载的。

编辑：如果搜索 DebugCRT，则在注册表中找不到任何内容。
环境路径指向 VS8 文件夹。
c:\windows\winsxs\policies 文件夹中只有1个DebugCRT文件夹
（8.0.50.727.42）
c:\windows\winsxs\manifests文件夹只有.42版本的.cat和
.manifest.manifest文件（在上面的清单文件夹中）有 version="8.0.50727.42"

澄清：清单文件有 2 个“dependentAssembly”条目，每个条目都有不同的版本，而不是 .42。我可以删除 1 个条目并更改另一个条目以匹配 .42 以获取启动的调试版本。

EDIT2：我也在使用 boost 并且在 DLL 中有 .762 版本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T19:16:40.180

该版本是从 Boost DLL 中获取的，这是 Boost 的下载、预编译版本。一旦库被重新编译（并重新安装），解决方案的重新构建会生成一个具有单个版本的清单，并且程序链接并运行。

因此 - 检查导入到解决方案中的库和 dll 以了解使用的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T12:18:59.590

VS 2008 是 VC90 而不是 VC80，所以这不是问题的一部分。清单请求的程序集和 SxS 加载的程序集之间的关系可在 C:\WINDOWS\WinSxS\Policies 中找到。IIRC，“8.0.50608.0”由 VS2005 pre-SP1 生成。这是错误的，应该是 8.0.50727.42，但这被政策抓住了。

我不确定您如何获得两个清单。你的清单设置是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T00:15:09.790

我建议在您的特定环境中重建 Boost。此外，您可以通过静态链接 CRT 来完全取消 Side by Side 程序集...

# scala - 从可迭代对象创建集合时，Scala 是否必须转换为 Seq？

> ID：677107
> 
> 赞同：5
> 
> 时间：2009-03-24T12:07:13.877
> 
> 标签：scala, scala-collections

也许我（再次）在错误的树上吠叫，但是如果将属性类型为 a 是正常做法`scala.collection.immutable.Set[A]`，那么在给定 a 的情况下，您将如何创建其中的一个`scala.Iterable[A]`？例如：

```
class ScalaClass {
    private var s: scala.collection.immutable.Set[String]

    def init(): Unit = {
        val i = new scala.collection.mutable.HashSet[String] 
        //ADD SOME STUFF TO i

        s = scala.collection.immutable.Set(i) //DOESN'T WORK

        s = scala.collection.immutable.Set(i toSeq : _ *) //THIS WORKS
    }
} 
```

有人可以解释为什么有必要通过 a 创建不可变集`Seq`（或者如果不是，那么我该怎么做）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T16:13:56.577

基本上是因为您通过“规范工厂方法”创建不可变 Set，应用在 Set 的伴随对象中，该对象采用序列或“可变参数”（如 Set(a,b,c)）。看到这个：
[http ://scala-tools.org/scaladocs/scala-library/2.7.1/scala/collection/immutable/Set$object.html](http://scala-tools.org/scaladocs/scala-library/2.7.1/scala/collection/immutable/Set$object.html)

我认为标准库中没有其他方法可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T17:34:03.577

它将制作一个不可变的副本：

```
scala> val mu = new scala.collection.mutable.HashSet[String]
mu: scala.collection.mutable.HashSet[String] = Set()

scala> val im = mu.clone.readOnly
im: scala.collection.Set[String] = ro-Set() 
```

# ms-access - 如何在 Access vba 中获取登录用户的名称？

> ID：677112
> 
> 赞同：21
> 
> 时间：2009-03-24T12:10:00.517
> 
> 标签：vba, access, ms-access, vba

> **可能重复：**
> [MS Access 有没有办法获取当前的 Active Directory 用户？](https://stackoverflow.com/questions/9052/is-there-a-way-for-ms-access-to-grab-the-current-active-directory-user)

我想通过[vba](/questions/tagged/vba "显示标记为“vba”的问题")在[access](/questions/tagged/access "显示标记为“访问”的问题")中获取登录用户的名称。做这个的最好方式是什么？

* * *

这个问题的重复：

*   [MS Access 有没有办法获取当前的 Active Directory 用户？](https://stackoverflow.com/questions/9052/is-there-a-way-for-ms-access-to-grab-the-current-active-directory-user)
*   [使用 VB6，如何在 Windows XP 上获取当前用户和域？](https://stackoverflow.com/questions/337237/using-vb6-how-do-i-get-the-current-user-and-domain-on-windows-xp/337374)
*   [如何在 Access VBA 中获取当前登录的 windows 用户？](https://stackoverflow.com/questions/168659/how-can-i-get-the-currently-logged-in-windows-user-in-access-vba/168682)
*   [Excel 2007 VBA 和 WMI - 当前域\用户](https://stackoverflow.com/questions/287369/excel-2007-vba-and-wmi-current-domain-user)

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-24T12:14:14.563

试试这个：

```
Function UserNameWindows() As String
     UserName = Environ("USERNAME")
End Function 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-24T12:15:26.713

```
Public Declare Function GetUserName Lib "advapi32.dll" 
    Alias "GetUserNameA" (ByVal lpBuffer As String, nSize As Long) As Long 
```

……

```
Dim strLen As Long
Dim strtmp As String * 256
Dim strUserName As String

strLen = 255
GetUserName strtmp, strLen
strUserName = Trim$(TrimNull(strtmp)) 
```

原来之前有人问过问题：[如何在 Access VBA 中获取当前登录的 windows 用户？](https://stackoverflow.com/questions/168659/how-can-i-get-the-currently-logged-in-windows-user-in-access-vba/168682)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-08-28T06:07:00.690

在表单中，创建一个文本框，在文本框属性中选择数据选项卡

```
Default value =CurrentUser() 
```

当前来源“选择表字段名称”

它将在文本框/标签中显示当前用户登录名，并将用户名保存在表格字段中

# asp.net - 我们应该如何在 aspx .net 中验证 http 标头引荐来源网址

> ID：677116
> 
> 赞同：2
> 
> 时间：2009-03-24T12:11:00.843
> 
> 标签：asp.net, validation, referrer, http-referer

我想确保在错误页面上没有任何不愉快的事情进入引荐来源网址。

为了验证 http 标头，我应该检查什么。

以下是我当前的代码：

```
// Ensure the referrer header is good
if (this.Request.UrlReferrer.IsWellFormedOriginalString() &&
    this.Request.UrlReferrer.Host.Equals(this.Request.Url.Host))
{ 
```

这将导致使用 %3C 和 %3E 而不是 < 和 > 的 acunetix 扫描失败，因此我显然需要涵盖 html 编码 - 还有什么我遗漏的吗？

**更新** 我可以使用以下代码捕获所有 acunetix 扫描：

```
if (this.Request.UrlReferrer.IsWellFormedOriginalString() &&
    this.Request.UrlReferrer.Host.Equals(this.Request.Url.Host) &&
    !Regex.IsMatch(this.Request.UrlReferrer.ToString(),
                   "%3C",
                   RegexOptions.IgnoreCase))
{ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:28:28.120

> 我想确保在错误页面上没有任何不愉快的事情进入引荐来源网址。

然后始终对您输出到错误页面的任何字符串（包括引荐来源网址）进行 HTML 转义。

尝试逐个选择包含潜在危险字符的输入并将其列入黑名单是在倒退。您可能无法捕获所有可能的攻击，并且您将不必要地禁止有效 URL。（有一个带有 '%3C' 的 URL 是完全合理的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T12:40:33.830

this.Request.UrlReferrer 可能为空，如果没有提供或参与的推荐人。

# vb.net - 使用 vb.net 恢复数据库

> ID：677122
> 
> 赞同：0
> 
> 时间：2009-03-24T12:12:26.377
> 
> 标签：vb.net

谁能帮助我如何从 vb.net 还原数据库，我尝试通过从 sql server2005 中获取还原模板脚本来使用存储过程进行还原。但出现错误“数据库已在使用中，请使用主数据库..”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T12:21:50.457

我假设您使用的连接字符串与您通常用来连接到您实际恢复的数据库的连接字符串相同。根据您的错误消息，我会说您应该使用不同的 InitialCatalog 参数创建与服务器的连接（错误消息表明您应该使用“master”）。

另一种选择是在脚本的开头添加一个“USE master”。[这](http://doc.ddart.net/mssql/sql70/ua-uz_7.htm)是 USE 语句的一个小描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-28T10:31:26.943

我刚刚在我的项目中写了这个，所以我想我会分享我的方法。

我通过使用 SqlCommand.CommandText 在服务器上触发 SQL 并为数据库和文件名设置 SqlParameters 来调用备份和恢复，如下所示：

简单备份：

```
备份数据库@dbName
    到磁盘=@文件名
    带格式
```

然后使用恢复它：

```
使用大师
恢复数据库@dbName
   从磁盘 = @fileName
```

BACKUP 和 RESTORE 命令有很多选项，但我只是想要一种快速的大锤方法，而且效果很好。

感谢丹尼斯的“使用大师”提示，它刚刚修复了我的“使用中”错误！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T12:51:52.273

从错误来看，它看起来并不存在实际的 VB.net 编程错误。
似乎问题出在数据库恢复存储过程上。

在还原数据库之前，请确保
• 您的连接没有使用您正在还原的数据库 - 这是导致该错误的可能原因之一，“数据库已在使用中，请使用主数据库。”
• 其他连接到应关闭目标数据库 - 关闭与其的所有连接。

Denis Troller 提到了[“USE master”](https://stackoverflow.com/questions/677122/restoring-a-database-using-vb-net/677142#677142)，并确保您的脚本将该语句作为还原批处理脚本中的“第一个”语句。

# ubuntu - Ubuntu 上的 CodeBlocks 没有出现

> ID：677135
> 
> 赞同：0
> 
> 时间：2009-03-24T12:18:38.920
> 
> 标签：ubuntu

我在 amd64 机器上运行的 Ubuntu Hardy heron 上安装了 CodeBlocks。安装很顺利，但是当我从菜单调用它时，我看到一个忙碌的光标，但应用程序没有出现。

我如何让它工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T12:22:48.550

CodeBlocks 用户手册可以在[这里](http://www.codeblocks.org/user-manual)找到，FAQ[在这里](http://wiki.codeblocks.org/index.php?title=FAQ)，维基[在这里](http://wiki.codeblocks.org/)，论坛[在这里](http://forums.codeblocks.org/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T12:28:25.183

从终端运行命令，看看它是否产生任何诊断。您可以通过编辑菜单（右键单击应用程序）找到运行的命令，您将在应用程序 -> 附件下找到终端。

如果没有产生诊断输出，请检查文档以查看是否有命令行开关类似于 --debug 或 --verbose 会导致它发出更多诊断信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T11:22:52.387

可能没有找到 libcodeblocks.so.0.0.1 这是 makefile 安装中的一个错误，您需要手动将其从 src/sdk/.libs/ 复制到 /usr/lib 或 /usr/local/lib

```
sudo cp src/sdk/.libs/libcodeblocks.so.0.0.1 /usr/lib/
sudo ln -s /usr/lib/libcodeblocks.so.0.0.1 /usr/lib/libcodeblocks.so.0
sudo ln -s /usr/lib/libcodeblocks.so.0.0.1 /usr/lib/libcodeblocks.so
sudo ldconfig 
```

而且您应该启动并运行代码块。

# php - 哪个是更可靠的匹配方案，EREGI 还是 STRIPOS？

> ID：677143
> 
> 赞同：0
> 
> 时间：2009-03-24T12:22:07.867
> 
> 标签：php, regex, string-matching

在匹配的情况下，您认为哪种方案更好？

是eregi还是stripos或任何其他方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T12:23:41.263

这取决于您是要进行完全匹配还是正则[表达式](http://en.wikipedia.org/wiki/Regex)匹配。

*   [**stripos**](http://www.php.net/manual/en/function.stripos.php)用于对另一个字符串中的字符串进行不区分大小写的匹配
*   [**eregi**](http://www.php.net/manual/en/function.eregi.php)是字符串中不区分大小写[的正则表达式](http://en.wikipedia.org/wiki/Regex)匹配
*   [**fnmatch**](http://www.php.net/manual/en/function.fnmatch.php)是第三种选择。这是简单的[通配符](http://en.wikipedia.org/wiki/Wildcard_character#Computing)匹配，如[globbing](http://en.wikipedia.org/wiki/Globbing)。

此外，**eregi**已被弃用，它不是二进制安全的，并且不适用于 UTF-8。对于正则表达式匹配，您应该使用[**preg_match**](http://www.php.net/manual/en/function.preg-match.php)与**`i`**flag 代替。

# c# - 无需开源的可扩展性

> ID：677150
> 
> 赞同：3
> 
> 时间：2009-03-24T12:22:50.657
> 
> 标签：c#, .net, plugins, extensibility

我的公司目前正在用 C# 创建一个大型多层软件包。我们对该结构采用了 SOA 方法，我想知道是否有人对如何使其具有编程知识的用户可扩展有任何建议。

这将涉及两个过程：生产系统管理员批准使用特定插件，以及实际插件架构本身。

我们希望允许用户编写脚本来执行常见任务、修改用户界面的布局（用 WPF 编写）并添加新功能（即允许制表数据的图表）。有没有人对如何实现这一点有任何建议，或者知道从哪里可以获得做这种事情的知识？

我认为这将是发布具有限制分发许可证的开源软件的完美角落案例，但是，我并不热衷于允许竞争对手访问我们的源代码。

谢谢。

编辑：我想我只是澄清一下为什么我选择了我所做的答案。我指的是我公司外部的生产管理员（即客户），并让他们以某种方式以更简单的方式自动化/编写脚本，而不需要他们完全了解 c#（他们大多是编程有限的最终用户经验）-我更多地考虑的是DSL。这可能是一个遥不可及的目标，而托管可扩展性框架似乎提供了迄今为止最好的折衷方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T12:32:59.213

只需使用接口。定义每个插件必须实现的 IPlugin，并使用定义良好的消息传递层来允许插件在主程序中进行更改。你可能想看看像 Mediaportal 或 Meedios 这样严重依赖用户插件的程序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-24T12:45:40.260

正如史蒂夫所提到的，使用接口可能是要走的路。您需要设计一组您希望客户使用的接口，设计插件的入口点以及插件通信模型。除了 Steve 的建议之外，您可能还想看看[Eclipse](http://www.eclipse.org/)项目。他们有一个非常明确的插件架构，即使它是用 Java 编写的，也值得一看。

另一种方法可能是设计一个可用于脚本语言的 API。[IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)和[Boo](http://boo.codehaus.org/)都是 动态脚本语言，可以很好地与 C# 配合使用。使用这种方法，您的客户可以编写脚本来与您的应用程序交互并扩展您的应用程序。与完整的插件系统相比，这种方法更像是一种轻量级的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-24T13:08:41.093

我想看看微软的**MEF**计划。它是一个框架，可让您为应用程序添加可扩展性。它现在处于测试阶段，但应该是 .Net 4.0 的一部分。

Microsoft 共享源代码，因此您可以查看它的实现方式和与之交互的方式。所以基本上你的可扩展性框架将对所有人开放，但它不会强迫你发布你的应用程序代码或插件代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T12:54:30.690

开源对于使产品可扩展的任何形式或形式都不是必需的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T12:25:24.303

我同意在这种情况下开源是一个可怕的想法。当您说由生产管理员批准时 - 是您公司内部的管理员还是外部管理员？

就个人而言，我会考虑通过继承（允许第三方在不提供源代码的情况下对您的代码进行子类化）和非常仔细地指定访问修饰符来实现可扩展性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T13:06:41.050

Microsoft 已经做到了这一点，从而产生了 Reporting Services，它具有您提到的每个属性：用户定义的布局、可编写脚本、图表、可定制的 UI。这包括一个可下载的 IDE。没有提供或要求访问源代码，但它绝对充斥着可扩展性挂钩。缺少源代码会抑制紧密耦合并促进 SOA 思维。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T13:21:16.663

我们目前处于类似的情况。我们确定了人们可能希望在数据级别上创建实时连接的不同场景。在这种情况下，他们可以访问单一网络服务来请求和导入数据。

在某些时候，他们可能希望拥有一个自定义用户界面（在我们的例子中是 Silverlight 2）。对于这种情况，我们可以提供一个基类并让他们在中央存储库中注册模块。然后它以统一的方式集成到我们的应用程序中，包括安全性、形式和行为以及与服务的交互。

# iocp - I/O 完成端口，如何释放每个套接字上下文和每个 I/O 上下文？

> ID：677155
> 
> 赞同：0
> 
> 时间：2009-03-24T12:24:39.030
> 
> 标签：iocp

我在 UDP 套接字上使用 IOCP，UDP 套接字可能在另一个线程中关闭。那么，如何安全地释放与 SOCKET 关联的 Per Socket Context 和 Per I/O Context 呢？

当我关闭套接字时，内核队列中仍然会有未完成的 I/O 请求。

如果我在套接字关闭时释放上下文，则 GetQueueCompletionStatus 可能会失败。

现在，我的问题是何时释放上下文？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-27T17:07:05.180

我对所有每个套接字和每个 I/O 数据结构都使用引用计数。它使这种事情变得容易，因为当它们的引用下降到 0 时它们被删除。对于一些显示一种方法的示例代码，您可以查看我的免费 IOCP 框架，您可以从[这里](http://www.serverframework.com/products---the-free-framework.html)下载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T12:27:28.103

使用[互斥锁](http://en.wikipedia.org/wiki/Mutex)在代码的关键部分强制互斥，这将检查套接字的可用性，并在必要时打开它。将套接字锁定到该线程，并在完成后适当地释放它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-12T08:15:11.503

我重用我的每个套接字结构。在我收到该连接所需的所有读写操作的完成事件后，我使用 and 标志调用[`TransmitFile`](http://msdn.microsoft.com/en-us/library/ms740565%28VS.85%29.aspx)以`TF_DISCONNECT`重置`TF_REUSE_SOCKET`套接字，而无需关闭它。一旦`TransmitFile`呼叫的完成事件通过，我还会重置每个连接的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-09T10:10:28.630

先关闭插座。你会从 GetQueuedCompletionStatus 得到错误（我认为是 ERROR_OPERATION_ABORTED），然后是释放结构的正确时间。此时内核队列中该连接上没有其他未完成的请求，完成包按FIFO顺序维护，错误包肯定是该连接的最后一个。

# asp.net-mvc - 堆栈溢出问题路由

> ID：677158
> 
> 赞同：3
> 
> 时间：2009-03-24T12:25:33.740
> 
> 标签：asp.net-mvc, routes

如果您查看 SO 问题 URL，您会看到 ID 和“SLUG”被传递给 Questions 控制器：[https ://stackoverflow.com/questions/676934/what-do-you-need-to-write-your -自己的博客引擎](https://stackoverflow.com/questions/676934/what-do-you-need-to-write-your-own-blog-engine)。我发现有趣的是，您可以更改 URL 的“SLUG”部分，而不会影响应用程序路由请求[示例](https://stackoverflow.com/questions/676934/just-a-friendly-test)的能力。我能想到的唯一方法是有一个接受 id 和“SLUG”的路由，并在 slug 上使用路由约束以确保它遵循模式。我必须使用约束来确保拥有这两个变量不会导致该路由匹配所有请求。有没有人有更好的方法来完成这个，或者更高级的路由场景的例子？

### 添加：

我意识到 SLUG 是为了人类可读性，我想在另一个应用程序中复制这个功能。实现这一目标的最佳方法是什么。

### 路线：

```
routes.MapRoute(
    "Id + Slug",          // Route name
    "Test/{id}/{slug}",   // URL with parameters
    new                   // Parameter defaults
    {
        controller = "Test", 
        action = "Details", 
        id = "", 
        slug = "" 
    },  
    new { slug = new SlugConstraint() }
); 
```

### 简单约束：

```
public class SlugConstraint : IRouteConstraint
{
    public bool Match(HttpContextBase httpContext,
        Route route,
        string parameterName,
        RouteValueDictionary values,
        RouteDirection routeDirection)
    {
        string value = values[parameterName].ToString();

        return value.Contains("-");
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T12:30:31.870

你根本不需要使用蛞蝓。它可能只是为了人类可读性和搜索引擎优化。您可以在路由时忽略它，只处理 ID。

例如，点击这里：

[堆栈溢出问题路由](https://stackoverflow.com/questions/677158/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T12:38:49.480

蛞蝓在那里供搜索引擎对资源/页面进行编目。它根本没有在路由中用作传递给数据库以检索请求的帖子的参数的一部分。

ID是重要的部分。

因此，在您的代码中，不需要 SlugConstraint，并且在 Details 操作中忽略 slug 参数的值。

如果您希望复制 SO，这种行为就是 SO 所做的以及您可以做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T12:34:37.900

“路由”可以是路由器可以配置为处理的任何内容。然后将“路由”的动态部分传递到登录/目标页面并通过 RouteValue() 方法（在 ASP.NET 路由中）进行检索。您如何处理目标页面上的这些值完全取决于您。使用它们或忽略它们。

所以ID（在你的例子中）是关键，其余的（slug）只是为了人类可读性和搜索引擎优化。

# c# - SQL SERVER 2005 自动计划备份工作不正常

> ID：677162
> 
> 赞同：1
> 
> 时间：2009-03-24T12:27:26.217
> 
> 标签：c#, asp.net, sql-server, sql-server-2005

我目前有一个安装了 WINDOWS 2003 Server 和 SQL SERVER 2005 的 Web 服务器，我尝试使用我创建的一些控件来执行作业计划。一切正常，但是当它开始工作时（在工作中我已经为备份数据库编写了 T-SQL 命令），它会给出以下错误。我已经检查我是否获得了根目录路径。我拥有该文件夹的所有权限，并且我是数据库的 DBOWNER。但是如果任何人或任何人对我的错误有想法，我仍然会出错，请立即帮助我。请

****我在这里给出的路径是我的应用程序的根目录 ok**** 我的错误：

无法打开备份设备“C:\Inetpub\httpdocs\Full_BackUp_at21032009_092140AM.bak”。设备错误或设备离线。有关详细信息，请参阅 SQL Server 错误日志。BACKUP DATABASE 异常终止。

因此，如果您对导致此错误的原因有任何想法，请帮助我，然后如果您希望通过此邮件 ID 直接向我发送解决方案：divyeshnh@gmail.com

谢谢

抱歉，但我在根目录中拥有我想要的全部权利，因为我将图像文件保存到此目录中。所以，你可以理解我有权利。

谢谢你的回复

我还做另一件事：

我非常仔细地阅读了您的回答并研究了您之前所说的所有内容。之后我尝试了另一件事，即我将该代码放在一个按钮单击事件上，幸运的是我成功了。所以，我问你，当我尝试执行计划时，它会在我单击按钮并进行备份时引发错误，它会正常工作。所以，请给我答案。

感谢你的回复

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T12:33:33.330

SQL Server 和代理服务使用的帐户是否有权访问*C:\Inetpub\httpdocs*文件夹？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T15:56:24.537

您的路径是否已经创建了所有文件夹？我认为它们必须已经存在，否则你会得到一个错误。

# localization - Installshield多语言问题

> ID：677166
> 
> 赞同：1
> 
> 时间：2009-03-24T12:29:08.537
> 
> 标签：localization, internationalization, windows-installer, globalization, installshield

我已经在工作中吸了一口气，我必须支持 Installshield 2009 安装应用程序。当我在 InstallShield 2009 Professional 中打开 .ISM 文件时，我收到以下消息：

以下语言将被禁用，因为它们已包含在此项目中但未安装在此系统上： 中文（繁体） 德语 法语（法国） 意大利语 瑞典语 中文（简体）

我需要在 Windows XP 中安装一些东西，还是需要在 InstallShield 中安装一些东西？任何见解都将非常有价值！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T15:28:10.463

问题是我需要 Installshield Premier 而不是 Installshield Professional（这是我拥有的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T22:20:22.670

对于多语言设置，您需要 Premier 而不是 Professional。如果您负担不起升级费用，我建议您迁移到 WiX。

# c# - 聚焦形式

> ID：677167
> 
> 赞同：0
> 
> 时间：2009-03-24T12:29:32.687
> 
> 标签：c#, winforms

如果我单击 form1 中的按钮事件 form2 应该是焦点，如果我单击 form2 中的按钮事件 form1 应该集中在 c#

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T16:58:36.143

Microsoft 建议不要在窗体上调用 Focus，而是使用窗体的 Activate 方法。以下是 MSDN 的摘录：

> Focus 是一种低级方法，主要用于自定义控件作者。相反，应用程序程序员应该对子控件使用 Select 方法或 ActiveControl 属性，或对窗体使用 Activate 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T12:33:15.920

存储对另一个表单的引用（即 Form1 具有对 Form2 的引用）并在按钮单击事件处理程序中，使用：

```
otherFormInstance.Focus(); 
```

# asp.net-mvc - 为什么这条 MVC 路线不起作用？

> ID：677168
> 
> 赞同：10
> 
> 时间：2009-03-24T12:29:35.633
> 
> 标签：asp.net-mvc, routes

这是我的 global.asax 文件中的两条路线。我试图去第二条路线，我得到一个默认的 404 资源未找到错误。

当我删除第一条路线（在此示例中列出）时，它可以工作。

请问我该如何解决这个问题？

### global.asax 代码片段

```
// GET: /user/PureKrome/Alert/69
routes.MapRoute(
    "User-Alert-Details",
    "user/{displayName}/alert/{alertId}",
    new { controller = "Account", action = "AlertDetails", alertId = 0 });

// GET: /user/PureKrome/Alert/create
routes.MapRoute(
    "User-Alert-Create",
    "user/{displayName}/alert/create",
    new { controller = "Account", action = "AlertCreate" }); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-24T12:36:13.277

您的第一条路线是“贪婪”路线，并且很乐意接受“create”作为最后一个参数中的 alertId。看来您希望 alertId 参数仅为数字，因此您应该添加一个约束来告诉路由系统最后一个参数必须是数字。

请参阅本[教程](http://www.asp.net/learn/mvc/tutorial-24-cs.aspx)。

例如：

```
// GET: /user/PureKrome/Alert/69
routes.MapRoute(
    "User-Alert-Details",
    "user/{displayName}/alert/{alertId}",
    new { controller = "Account", action = "AlertDetails", alertId = 0 },
    new { alertId = @"\d+" });

// GET: /user/PureKrome/Alert/create
routes.MapRoute(
    "User-Alert-Create",
    "user/{displayName}/alert/create",
    new { controller = "Account", action = "AlertCreate" }); 
```

请注意，您也可以颠倒路线的顺序，但即使这样做，如果您希望 alertId 始终为数字，您仍应包含正确性约束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T12:39:32.847

您希望以相反的方式定义路由，以便完全匹配 on`create`出现在 的无约束匹配之前`alertId`。那，或者您可以添加一个约束，`alertId`如 Twisty Maze 所述。

这是因为路由通过尝试从上到下匹配路由来工作。`/user/PureKrome/Alert/create`匹配`User-Alert-Details`路线，因为它认为`create`是`alertId`. 通过切换它们，它只会`User-Alert-Create`在第 4 段是明确的情况下匹配路线`create`，如果没有，它将落入`User-Alert-Details`。

为了清楚起见，他们应该这样工作：

```
// GET: /user/PureKrome/Alert/create
routes.MapRoute(
    "User-Alert-Create",
    "user/{displayName}/alert/create",
    new { controller = "Account", action = "AlertCreate" });

// GET: /user/PureKrome/Alert/69
routes.MapRoute(
    "User-Alert-Details",
    "user/{displayName}/alert/{alertId}",
    new { controller = "Account", action = "AlertDetails", alertId = 0 }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T18:38:01.083

如果您还有类似的问题，请在[http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx尝试 Phil Haack 的 url 调试器](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-03T20:14:15.330

问题是您在第一个映射中为控制器和操作指定了默认值。

现在任何传入请求都由第一条路由处理，如果控制器名称丢失，则将其替换为默认值，如果操作名称丢失，则也将其替换为默认值。

所以实际上，当您说[http://localhost/SomeRoute](http://localhost/SomeRoute) 第一个映射器开始行动并将字符串“SomeRoute”视为控制器名称时，它没有找到该操作，因此它使用您指定的默认操作，即“AlertCreate “在你的例子中。所以现在映射器试图在“SomeRoute”控制器中找到一个名为 AlertCreate 的动作。

底线是第二个映射不会生效，因为第一个映射正在处理您的所有路由请求。（因为您指定了默认值）

# .net - 使用列表 因为 ItemsControl 的 ItemsSource 导致 DataTemplate 不被应用

> ID：677171
> 
> 赞同：5
> 
> 时间：2009-03-24T12:30:53.617
> 
> 标签：.net, wpf, data-binding

我创建了一个自定义面板（MyCustomControl），它可以包含其他控件并且可以通过依赖属性进行配置。在不同的用户控件 (MyUserControl) 中，我在 XAML 中配置了多个 MyCustomControl 实例。

在用户控件之外，我试图将 ItemsControl (myItemsControl) 绑定到运行时存在于 MyUserControl 中的 MyCustomControls 列表。因此，我通过依赖属性从 MyUserControl 公开了 List。

我遇到了这种策略的意外行为。我希望 ItemsControl 获取 List 并将其中的每个控件实例用作具有可以填充 ItemsControl 的 DataTemplate 的数据值的对象。但是，它没有这样做。相反，它基本上完全忽略了 DataTemplate，而只是重新渲染列表/ItemsSource 中的所有控件。

总之，如果我将控件列表用作 ItemsControl 的 ItemsSource，它不会将它们用作数据对象，而是将它们呈现为控件实例。

令人惊讶的是，如果我尝试做同样的事情但使用 ListBox 而不是 ItemsControl，则数据绑定会按预期工作。由于其他原因，我不想使用 ListBox。有谁知道影响此行为的 ListBox 和 ItemsControl 之间的区别是什么？

编辑：我发现另一个有同样问题的用户在这里没有列出解决方案：[msdn 社交论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/d0942de0-7bcf-41b9-9003-ca244bf80206/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T20:29:27.570

使用 Reflector 检查 ItemsControl 代码后，如果项目是 UIElement，IsItemItsOwnContainerOverride 方法将返回 true。您可以创建 ItemsControl 的子类，并将此方法更改为：

```
protected override bool IsItemItsOwnContainerOverride(object item)
{
    return (item is ContentPresenter);
} 
```

如果您随后使用该类而不是 ItemsControl，它将按预期工作，但不会具有 ListBox 的不良功能。

# python - 模型中的verbose_name_plural 意外？

> ID：677172
> 
> 赞同：3
> 
> 时间：2009-03-24T12:31:09.593
> 
> 标签：python, django, django-models

我一直在为未来的应用程序做一些模型，并且在将 verbose_name 和 verbose_name_plural 添加到工作模型的每个条目之后，为了使其“漂亮”，我发现在验证时，Django 不喜欢那样，所以它说：

```
 File "/home/andor/Documentos/desarrollo/grundymanage/../grundymanage/concursantes/models.py", line 4, in <module>
    class Concursante(models.Model):
  File "/home/andor/Documentos/desarrollo/grundymanage/../grundymanage/concursantes/models.py", line 7, in Concursante
    nombre_artistico = models.CharField(verbose_name='Nombre Artístico', verbose_name_plural='Nombres Artísticos', max_length=50)
TypeError: __init__() got an unexpected keyword argument 'verbose_name_plural' 
```

我的模型是这样开始的：

```
# -*- encoding: utf-8 -*-
from django.db import models

class Concursante(models.Model):
    nombre = models.CharField(verbose_name='Nombre', max_length=30)
    apellidos = models.CharField(verbose_name='Apellidos', max_length=50)
    nombre_artistico = models.CharField(verbose_name='Nombre Artístico', verbose_name_plural='Nombres Artísticos', max_length=50) 
```

为什么“他”没想到那里有一个复数冗长的名字？不能和verbose_name 住在一起？

仅供参考，这是我的软件版本：

*   Ubuntu 8.04
*   Python 2.5.2
*   Django“1”“0”“最终”
*   Django ubuntu 包版本“1.0-1ubuntu1”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T12:39:49.913

没有`verbose_name_plural`。一个字段同时具有单数和复数是没有意义的。它们是相互排斥的。在 Django 中，它们共享相同的名称：`verbose_name`.

如果您的数据代表多个项目（例如在一对多关系中），请使用复数形式 in `verbose_name`。否则，如果您的数据代表单个项目，请使用单数形式。

[Django 文档中的详细名称字段](http://docs.djangoproject.com/en/dev/topics/db/models/#verbose-field-names)提供了一些示例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T12:39:52.100

不幸的是，`verbose_name_plural`这不是场上的选择。这是模型本身的元选项。字段没有复数名称，因为除非它是多对多关系（在这种情况下，Django 将使用复数表示关系指向的模型），该字段中只有一个实体。

这是文档部分：[http ://docs.djangoproject.com/en/dev/topics/db/models/#id3](http://docs.djangoproject.com/en/dev/topics/db/models/#id3)

# php - 等价运算符如何处理 PHP 中的数组？

> ID：677177
> 
> 赞同：2
> 
> 时间：2009-03-24T12:34:31.130
> 
> 标签：php

代码：

```
$arr = array( 10, 20, 30 );
$arr1 = array(
       1=>30,
       2=>20,
       0=>10
);
var_dump( $arr == $arr1 );

$a = array( 1, 2, 3);
$b = array(
       1=>2,
       2=>3,
       0=>1
 );
var_dump($a == $b); 
```

这输出：

```
bool(false)
bool(true) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T12:38:41.697

如果它们的对应值相同，则两个数组将被视为相等。

在您的第一个示例中，您正在比较两个数组：

```
[10, 20, 30]
[10, 30, 20] 
```

显然这些是不一样的，所以它返回false。第二个例子虽然：

```
[1, 2, 3]
[1, 2, 3] 
```

...是相同的。我在这里错过了什么吗？

* * *

如果要测试两个数组是否具有相同的成员，请参阅以下问题： [判断两个数组是否具有相同成员的算法](https://stackoverflow.com/questions/245509)

如果您只想查看它们的总数相同，可以使用[array_sum](http://www.php.net/array_sum)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T12:39:49.807

如果不为 指定键`array`，php 会自动选择数字，从 0 开始。因此，以下几对行的含义相同：

```
$arr = array(10,20,30);
$arr = array(0=>10,1=>20,2=>30);

$a = array(1,2,3);
$a = array(0=>1,1=>2,2=>3); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T13:18:25.627

相等运算符`===`在 php 中并且在数组`=>`中是正确的。也`$arr !=$arr1`coz `20 !=30`，`30!=20`根据您的分配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T12:39:52.177

可以预料的是，

```
array(10,20,30) != array(10,30,20) 
```

和

```
array(1,2,3) == array(1,2,3) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T12:40:34.843

这是一个非常广泛的问题，但在数组的情况下，它会逐个索引进行比较。

在您的第一个代码块中，$arr 不等于 $arr1，因为 30 != 10 和 10!=30。

在第二个代码块中，您指定索引 0 处的值为 1。索引 1 处的值为 2，索引 2 处的值为 3。因此，您拥有相同的数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T12:54:58.693

鉴于您的一些评论，我认为如果您阅读[php 中的数组类型](http://docs.php.net/manual/en/language.types.array.php)会很有用。主要是没有无键数组的事实。
并且不要忘记[比较运算符](http://docs.php.net/manual/en/language.operators.comparison.php)。

# ruby - 用 Ruby 打印报告和发票？

> ID：677183
> 
> 赞同：4
> 
> 时间：2009-03-24T12:36:05.493
> 
> 标签：ruby, printing, reporting

我刚学 Ruby，我想知道如何生成报告和发票（带有徽标、地址字段、页脚、可变数量的发票项目（有时会导致超过一页），将要支付的金额从一页结转到接下来，在结果现金信息下方的自由浮动 2 列文本（左对齐和右对齐）。

目前，我从操作系统（与打印机规格匹配）获得了一个用于打印和绘制的画布，并使用了一些绘制、移动、行、文本和换页 API 功能，并对文本块移动进行了一些繁重的计算（a有点像 TeX）。

这将如何在 Ruby 中完成？

构建 .odt 并将其扔到 OpenOffice 或 .tex 并将其扔到 LaTeX？

或者有没有免费的图书馆，它们为我做所有这些事情，所以我只需要提供相关部分，让 Ruby 做文本格式化的事情？

**编辑：**

更具体地说：我想在首页的特定位置（DIN-A4 格式，但也可能是字母）上放置一个公司徽标，以及每一页的页脚和首页的地址框。其余的应该是自由浮动的文本块，左右对齐，文本中间的粗体字。

就像是

```
pdf.column.blocktext("Hello Mr. P\nwe have [b]good news[/b] for you. bla bla bla and so on. Please keep this text together (no page break)...");
pdf.column.floatingblock("This is another block, that should be printed, and can be broken over more than one column..."); 
```

它应该在纸上以公司字体呈现文本，对齐，并在到达页面底部时整齐地换行到下一列/页面。

想一想，这正是 LaTeX 的用途。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T12:52:01.023

我建议你考虑 PDF 生成。在 Rails 中，使用 Prawn 库非常简单。

还有一个[全新的 Railcast 与此有关](http://railscasts.com/episodes/153-pdfs-with-prawn)。

[官方网站](http://prawn.majesticseacreature.com/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T18:36:17.717

您还可以查看用于生成 PDF 的 HtmlDoc，它只接受 HTML 并从中生成 PDF。这种方法很好，因为它可以让您非常轻松地将部分内容重用于屏幕和硬拷贝发票。

[http://blog.adsdevshop.com/2007/11/20/easy-pdf-generation-with-ruby-rails-and-htmldoc/](http://blog.adsdevshop.com/2007/11/20/easy-pdf-generation-with-ruby-rails-and-htmldoc/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T02:47:43.377

[Ruport 库](http://rubyreports.org/)( Ruby Reports) 可以很容易地以多种格式输出报告表，包括 PDF。还有一个 ActiveRecord 钩子`acts_as_reportable`可以为您的模型提供报告界面。

# c# - 如何强制 SQLconnection 释放数据库？

> ID：677184
> 
> 赞同：0
> 
> 时间：2009-03-24T12:36:11.967
> 
> 标签：c#, dispose, sqlconnection

我编写了一个小应用程序，可以恢复数据库（C# 和 SQL2005），但是在我访问数据库后，我无法删除它 - 它说它正在使用中。我想这与SQLconnection-pooling，但我可以强制它释放数据库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T12:39:31.663

在连接字符串中指定“Pooling=False”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:09:37.783

释放您的 SqlConnection 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T12:42:10.783

如果你利用

```
Using SQLConnection
    '' do your stuff here
End Using 
```

我认为这会在它退出后强制释放资源

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T12:44:04.647

调用“USE SomeOtherDB”（例如 Master）来关闭您自己的连接，或其中之一

ALTER DATABASE SET SINGLE_USER

或者

ALTER DATABASE SET SINGLE_USER WITH ROLLBACK_IMMEDIATE

关闭其他连接。第一个等待连接结束，第二个是立即的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-16T01:25:23.597

“调用“USE SomeOtherDB”（例如 Master）来关闭您自己的连接，或其中之一“

```
//on master ... CREATE
using (var cnn = new SqlConnection(MASTER))
{
    cnn.Open();
    var createDbCmd = new SqlCommand(string.Format("create database [{0}]", db), cnn).ExecuteNonQuery();
    cnn.Close();
}
using (var cnn = new SqlConnection(tempDB))
{
    cnn.Open();
    var createTbl = new SqlCommand(string.Format("create table t (t int )"), cnn).ExecuteNonQuery();
    var dropTbl = new SqlCommand(string.Format("drop table t"), cnn).ExecuteNonQuery();
    //Do additional stuf
    var userMaster = new SqlCommand(string.Format("use master"), cnn).ExecuteNonQuery();
    cnn.Close();

}
//on master ... CREATE
using (var cnn = new SqlConnection(MASTER))
{
    cnn.Open();
    var dropDbCmd = new SqlCommand(string.Format("drop database [{0}]", db), cnn).ExecuteNonQuery();
    cnn.Close();

} 
```

# sybase - Sybase 到 SQLserver 链接服务器错误

> ID：677196
> 
> 赞同：0
> 
> 时间：2009-03-24T12:39:37.997
> 
> 标签：sybase

我在 W2003 R2 上的 SQLserver 2005 和 IBM AIX H70 系统上的 SYBASE 12.5.0.2 服务器之间建立了一个 SQL 链接服务器。我使用 Sybase ODBC 驱动程序 04.20.00.67

问题是大多数时候（没有模式）当我从 Sybase 表中选择行时，我只得到一行而没有任何错误。请注意，当我将行从 SQL 服务器插入到 SYBASE 服务器时没有问题

我很感激任何可能的解决方案......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T02:55:11.900

你是如何选择行的？是否通过

```
从 LINKED_SERVERNAME.foo.bar.bletch 中选择 a,b,c

```

或者你在做这样的'pass-thru' sql

```
EXEC('SELECT * FROM foo..bletch') AT LINKED_SERVERNAME

```

我在直通式查询方面取得了更大的成功：SQL Server 似乎无法从 Sybase ODBC 驱动程序中获得所需的元数据。我被迫为 sp_tables_ex 和朋友系列的存储过程编写替代品，因为它们不适用于链接的 Sybase 数据服务器。

pjjH

# c# - 计算在枚举上设置的标志数

> ID：677204
> 
> 赞同：21
> 
> 时间：2009-03-24T12:41:12.063
> 
> 标签：c#, enums

我确信必须有更好的方法来做到这一点。我正在尝试对 Flags 枚举进行计数操作。在我迭代所有可能的值并计算成功的 AND 操作之前。

例如

```
[Flags]
public enum Skills
{
    None = 0,
    Skill1 = 1,
    Skill2 = 2,
    Skill3 = 4,
    Skill4 = 8,
    Skill5 = 16,
    Skill6 = 32,
    Skill7 = 64,
    Skill8 = 128
}

public static int Count(Skills skillsToCount)
{
   Skills skill;
   for (int i = 0; i < SkillSet.AllSkills.Count; i++)
   {
      skill = SkillSet.AllSkills[i];
      if ((skillsToCount & skill) == skill && skill != Skills.None)
         count++;
   }
   return count;
} 
```

我敢肯定，一定有更好的方法来做到这一点，但一定是精神障碍。谁能建议一个更好的解决方案？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-08-26T08:47:59.090

以下代码将为您提供为给定数量的任何类型设置的位数，这些类型的大小从字节到长不等。

```
public static int GetSetBitCount(long lValue)
{
  int iCount = 0;

  //Loop the value while there are still bits
  while (lValue != 0)
  {
    //Remove the end bit
    lValue = lValue & (lValue - 1);

    //Increment the count
    iCount++;
  }

  //Return the count
  return iCount;
} 
```

这段代码非常高效，因为它只为每个位迭代一次，而不是像其他示例中那样为每个可能的位迭代一次。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-24T13:19:59.507

在查看 Assaf 建议的网站后，我设法找到了一个稍微不同的解决方案，我为 Int32 工作。

这是其他人的代码：

```
 internal static UInt32 Count(this Skills skills)
    {
        UInt32 v = (UInt32)skills;
        v = v - ((v >> 1) & 0x55555555); // reuse input as temporary
        v = (v & 0x33333333) + ((v >> 2) & 0x33333333); // temp
        UInt32 c = ((v + (v >> 4) & 0xF0F0F0F) * 0x1010101) >> 24; // count
        return c;
    } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-03-02T14:03:31.283

`BitArray`使用和 LINQ的一种非常简洁的方法：

```
public static int Count(Skills skillsToCount)
{
    return new BitArray(new[] {(int)skillsToCount}).OfType<bool>().Count(x => x);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T12:51:18.513

计数相当于计算枚举的整数值中有多少位设置为 1。

在 C/C++ 中有非常快速的方法可以做到这一点，您可以适应 C#：

例如

```
int bitcount(unsigned int n) {
   /* works for 32-bit numbers only    */
   /* fix last line for 64-bit numbers */

   register unsigned int tmp;

   tmp = n - ((n >> 1) & 033333333333)
           - ((n >> 2) & 011111111111);
   return ((tmp + (tmp >> 3)) & 030707070707) % 63;
} 
```

取自[这里](http://gurmeetsingh.wordpress.com/2008/08/05/fast-bit-counting-routines/)。

**编辑**
提供的链接已失效。找到[另一个](http://gurmeet.net/puzzles/fast-bit-counting-routines/)可能包含相同内容的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-03-15T11:47:24.343

有一种使用函数式编程（LINQ）的直接方法：

```
var skillCount = Enum
    .GetValues(typeof(Skills))
    .Cast<Enum>()
    .Count(skills.HasFlag); 
```

它可能比 bit-juggling 解决方案慢一点，但它具有恒定的运行时间并且更直观。

虽然 GetValues 仍在分配，但编译器很有可能将其优化掉。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-03-02T11:37:56.003

如果您的目标是 .NET Core 3.0 或更高版本，则可以使用[`BitOperations.PopCount()`](https://docs.microsoft.com/en-us/dotnet/api/system.numerics.bitoperations.popcount?view=netcore-3.1)，它在`uint`or中运行`ulong`并返回`1`位数。

如果您的 CPU 支持 SSE4，它将使用`POPCNT`CPU 指令，否则它将使用软件回退。

```
public static int Count(Skills skillsToCount)
{
   return BitOperations.PopCount((ulong)skillsToCount);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T14:19:27.880

```
<FlagsAttribute()> _
Public Enum Skills As Byte
    None = 0
    Skill1 = 1
    Skill2 = 2
    Skill3 = 4
    Skill4 = 8
    Skill5 = 16
    Skill6 = 32
    Skill7 = 64
    Skill8 = 128
End Enum

    Dim x As Byte = Skills.Skill4 Or Skills.Skill8 Or Skills.Skill6
    Dim count As Integer
    If x = Skills.None Then count = 0 Else _
        count = CType(x, Skills).ToString().Split(New Char() {","c}, StringSplitOptions.RemoveEmptyEntries).Count 
```

取决于“更好”的定义。

需要对 Skills.None 进行检查，因为如果没有位打开，则 string() 返回 Skills.None 导致计数为 1。这对于整数、长整数和它们的无符号亲戚来说是一样的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T14:49:05.657

使用此方法的唯一原因是标志不连续并且标志将定期添加。

```
<FlagsAttribute()> _
Public Enum Skills As Integer
    Skill1 = CInt(2 ^ 0) 'bit 0
    Skill2 = CInt(2 ^ 1)
    Skill3 = CInt(2 ^ 2)
    Skill4 = CInt(2 ^ 3)
    Skill5 = CInt(2 ^ 4)
    Skill6 = CInt(2 ^ 5)
    Skill7 = CInt(2 ^ 6)
    Skill8 = CInt(2 ^ 7)
    Skillx = CInt(2 ^ 10) 'bit 10, some bits were skipped
End Enum

    Dim mySkills As Integer = Skills.Skillx Or Skills.Skill4 Or Skills.Skill8 Or Skills.Skill6
    Dim count As Integer 'count of bits on
    count = CType(mySkills, Skills).ToString().Split(New Char() {","c}, _
                                                     StringSplitOptions.RemoveEmptyEntries).Count 
```

如果“更好”意味着更快，这不是;）它。

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2009-03-24T12:46:00.057

```
int count = Enum.GetValues(typeof(Skills)).Length; 
```

# objective-c - 呈现 Renderbuffer 时，是什么导致执行时间波动？(OpenGL)

> ID：677211
> 
> 赞同：4
> 
> 时间：2009-03-24T12:45:15.253
> 
> 标签：objective-c, opengl-es, timing

这就是发生的事情：

*   **`usleep`正如建议的那样，由于 a ， **drawGL 函数在帧的确切结束处被调用。**这已经保持了稳定的帧速率。**

***   渲染缓冲区的实际呈现发生在`drawGL()`. 测量执行此操作所需的时间会给我带来**波动的执行时间，从而导致我的动画卡顿。**这个计时器使用 mach_absolute_time 所以**它非常准确**。

    *   在我的框架结束时，我测量`timeDifference`. 是的，平均为 1 毫秒，但**偏差很大**，从 0.8 毫秒到 1.2 毫秒不等，峰值高达 2 毫秒以上。** 

 ***例子：*

```
// Every something of a second I call tick
-(void)tick
{
  drawGL(); 
}

- (void)drawGL
{   
  // startTime using mach_absolute_time;

  glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer); 
  [context presentRenderbuffer:GL_RENDERBUFFER_OES];

 // endTime using mach_absolute_time;
 // timeDifference = endTime - startTime;
} 
```

我的理解是，一旦创建了帧缓冲区，**无论帧的复杂性如何，呈现渲染缓冲区都应该始终付出同样的努力？这是真的？如果没有，我该如何防止这种情况？**

顺便说一下，这是一个 iPhone 应用程序的示例。所以我们在这里讨论的是 OpenGL ES，尽管我不认为这是一个特定于平台的问题。如果是，那是怎么回事？这不应该**不会**发生吗？再说一次，如果是这样，我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:58:23.407

您遇到的偏差可能是由很多因素引起的，包括操作系统调度程序启动并将 cpu 提供给另一个进程或类似问题。事实上，普通人不会区分 1 到 2 毫秒的渲染时间。电影以 25 fps 的速度运行，这意味着每帧显示大约 40 毫秒，并且对于人眼来说看起来很流畅。

至于动画口吃，您应该检查如何保持恒定的动画速度。我见过的最常见的方法大致是这样的：

```
while(loop)
{
  lastFrameTime; // time it took for last frame to render
  timeSinceLastUpdate+= lastFrameTime;

  if(timeSinceLastUpdate > (1 second / DESIRED_UPDATES_PER_SECOND))
  {
     updateAnimation(timeSinceLastUpdate);
     timeSinceLastUpdate = 0;
  }

  // do the drawing

  presentScene();
} 
```

或者您可以将 lastFrameTime 传递给每帧的 updateAnimation 并在动画状态之间进行插值。结果将更加流畅。

如果你已经在使用类似上面的东西，也许你应该在渲染循环的其他部分寻找罪魁祸首。在 Direct3D 中，代价高昂的事情是调用图元和更改渲染状态，因此您可能想检查一下 OpenGL 的类似物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T10:59:17.270

我一直以来最喜欢的 OpenGL 表达方式：*“特定于实现”*。我认为它在这里非常适用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-28T16:26:34.800

A quick search for mach_absolute_time results in this article: [Link](http://shiftedbits.org/2008/10/01/mach_absolute_time-on-the-iphone/)

Looks like precision of that timer on an iPhone is only 166.67 ns (and maybe worse). While that may explain the large difference, it doesn't explain that there is a difference at all.

The three main reasons are probably:

*   Different execution paths during renderbuffer presentation. A lot can happen in 1ms and just because you call the same functions with the same parameters doesn't mean the exact same instructions are executed. This is especially true if other hardware is involved.
*   Interrupts/other processes, there is always something else going on that distracts the CPU. As far as I know the iPhone OS is not a real-time OS and so there's no guarantee that any operation will complete within a certain time limit (and even a real-time OS will have time variations).
*   If there are any other OpenGL calls still being processed by the GPU that might delay presentRenderbuffer. That's the easiest to test, just call glFinish() before getting the start time.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T22:05:02.957

出于多种原因，最好不要依赖高恒定帧速率，最重要的是操作系统可能会在后台执行一些减慢速度的操作。最好对计时器进行采样并计算出每帧经过了多少时间，这应该可以确保动画流畅。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T21:01:39.170

即使返回小数点 0.8->2.0，计时器是否可能不准确到亚毫秒级别？

# java - 按天分组长 UTC 日期

> ID：677218
> 
> 赞同：3
> 
> 时间：2009-03-24T12:46:42.567
> 
> 标签：java, utc

有没有一种合理的方法可以按天对长 UTC 日期进行分组？

我会将它们修改为 86400，但这不考虑闰秒。

有没有人有任何其他想法，我正在使用 java，所以我可以将它们解析为日期对象，但我有点担心使用日期类的性能开销。

还有比比较 Date 对象的年月日部分更有效的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T13:19:38.540

您的源数据是否*肯定*包含闰秒？有些 API 会，有些则不会 - 例如，Joda Time（我建议使用内置日期/时间 API）[不使用闰秒](http://joda-time.sourceforge.net/faq.html#leapseconds)。Java 日期和时间 API“有时”会这样做——它们支持 60 和 61 作为“分钟秒数”的值，但支持取决于操作系统（见下文）。如果你有一些好的样本值，如果我是你，我会先检查一下。显然，只是划分比其他任何事情都简单。

如果您*确实*需要创建`Date`对象（或`DateTime`在 Joda 中），我会在做任何其他事情之前对其进行基准测试。您可能会发现性能实际上是完全足够的。浪费时间优化适合您的数据的东西是没有意义的。当然，您需要确定需要支持的数据大小，以及首先需要多快 :)

甚至`java.util.Date`对闰秒的支持也有些不确定。从[文档](http://java.sun.com/javase/6/docs/api/java/util/Date.html)：

> 尽管 Date 类旨在反映协调世界时 (UTC)，但它可能并不完全如此，这取决于 Java 虚拟机的主机环境。几乎所有现代操作系统都假定在所有情况下 1 天 = 24 × 60 × 60 = 86400 秒。然而，在 UTC 中，大约每隔一两年就会多出一秒，称为“闰秒”。闰秒总是作为一天的最后一秒添加，并且总是在 12 月 31 日或 6 月 30 日。例如，由于添加了闰秒，1995 年的最后一分钟是 61 秒。大多数计算机时钟不够准确，无法反映闰秒的区别。

有一篇关于 Java 混乱和闰秒的[相当不错的博客文章](http://lpar.ath0.com/2008/09/16/the-fractious-leap-second-debate/)，您可能也想阅读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-23T19:51:02.990

> 我会将它们修改为 86400 但这并不考虑闰秒......

我很确定那会很好。API 文档`Date`真的不应该包含任何关于闰秒的内容，因为事实上它模拟了一个标准的 Unix 时间记录器，它的值中不包含闰秒。相反，它的作用是通过在闰秒开始时将代码值设置回 1 秒（如上一篇文章中的链接所述），使第 59 秒持续两秒。

因此，您可以假设您从`Date.getTime()`IS 获得的值仅由 86400 秒组成。如果你真的需要知道*某*一天是否有闰秒，互联网上有几张表格（自 1972 年以来只有 23 到 24 天，而在此之前的计算机日期很少考虑它们）。

HIH

温斯顿

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-28T08:05:40.877

# python - python中的条件覆盖

> ID：677219
> 
> 赞同：21
> 
> 时间：2009-03-24T12:47:09.070
> 
> 标签：python, unit-testing, code-coverage

是否有任何工具/库可以计算 python 代码的“条件/决策覆盖率”百分比。我只找到了coverage.py，但它只计算了“语句覆盖率”的百分比。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-11-11T12:44:20.443

[Coverage.py 现在包括分支覆盖](http://nedbatchelder.com/code/coverage/branch.html)。

对于好奇：代码在运行之前没有被修改。跟踪函数跟踪执行中的哪些行，并将该信息与已编译字节码的静态分析进行比较，以找到未执行的路径可能性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T22:37:42.037

我不知道任何用于 Python 的分支覆盖工具，尽管我已经考虑编写一个。我的想法是从 AST 开始，为每个分支点插入额外的工具。这是可行的，但有一些棘手的情况。

例如，

```
raise SomeException(x) 
```

对此的分支覆盖需要检查 SomeException(x) 是否已完全实例化并且没有引发自己的异常。

```
assert x, "Oh No!: %r" % (x, y) 
```

这需要检查断言语句右侧的文本是否被完全评估。

```
return args.name or os.getenv("NAME") or die("no name present") 
```

前两个术语中的每一个都必须检查真/假路径，但不是最后一个。事实上，最后一个甚至可能不会返回。

有很多情况要担心，除了好奇之外我没有迫切的需要，所以我没有去任何地方。我还想知道我是否会得到很多误报，我需要一些方法来抑制特定的警告。

如果您想尝试这条路线，请从 Python 2.6 或 3.0 开始。在这些版本中记录了 AST 模块，您可以在生成代码或 .pyc 文件之前创建自己的 AST 节点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T22:18:15.880

我自己没有用过，但是如果你愿意用[变异测试](http://en.wikipedia.org/wiki/Mutation_testing "突变测试")代替覆盖分析，我听说过一个变异测试器，叫做“pester”。

在我进行谷歌搜索时，我还发现了[一个 python 测试工具列表，](http://www.pycheesecake.org/wiki/PythonTestingToolsTaxonomy)其中提到了一些可能的代码覆盖工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T13:31:46.467

您在寻找[圈复杂度（维基百科）](http://en.wikipedia.org/wiki/Cyclomatic_complexity)吗？它基本上计算通过一段代码的路径数。有一些项目可以为 Python 代码计算它，例如[PyMetrics](http://sourceforge.net/projects/pymetrics/)或[这个](http://www.traceback.org/2008/03/31/measuring-cyclomatic-complexity-of-python-code/)。谷歌肯定会带来更多。

但是我不知道与单元测试的任何进一步集成会显示覆盖率。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T02:44:51.397

coverage.py 的同一维护者有一篇文章讨论了一种[在字节码级别获取覆盖信息的](http://nedbatchelder.com/blog/200804/wicked_hack_python_bytecode_tracing.html)方法。该方法有点笨拙：它涉及使用经过调整的行号重新组装 .pyc 文件。但是，它提供了您所要求的尽可能多的覆盖测量粒度。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-27T21:26:29.590

看起来“工具”实现了条件覆盖：

[Pypi 上的器乐](https://pypi.python.org/pypi/instrumental)

[关于coverage.py和工具的链接](https://lautaportti.wordpress.com/2011/05/07/test-coverage-analysis/)

有人试过吗？它有一个很小的版本号。我需要一些我可以信任的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-11T21:52:08.417

恕我直言，解析和修改 AST 是正确的答案。有关您需要做的事情的完整描述，请参阅本文：“Branch Coverage Made Easy for Arbitrary Languages”

[http://www.semanticdesigns.com/Company/Publications/TestCoverage.pdf](http://www.semanticdesigns.com/Company/Publications/TestCoverage.pdf)

# java - 如何从 Java 小程序打开和关闭浏览器窗口？

> ID：677220
> 
> 赞同：0
> 
> 时间：2009-03-24T12:47:17.277
> 
> 标签：java, applet

我想在 Google.com 上打开一个新窗口，但稍后再关闭该窗口。我目前的代码如下：

```
link="http://www.google.com"

try
{
    AppletContext a = getAppletContext();
    URL url = new URL(link);
    a.showDocument(url,"_blank");
}
catch (MalformedURLException e)
{
    System.out.println( e.getMessage() );
} 
```

这会打开窗口，但我以后如何关闭它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:47:22.573

我建议使用 JSObject 接口调用浏览器来打开窗口。然后您可以获取新窗口的变量并使用它来关闭它。

更多文档：

*   [从 Javascript 打开和关闭窗口](http://www.novell.com/documentation/extendas35/docs/help/books/TechWindowOpenClose.html#978293)
*   [来自 Java 的 JSObject](http://java.sun.com/products/plugin/1.3/docs/jsobject.html)

# c# - 使用 System.IO 在 C# 中复制文件夹

> ID：677221
> 
> 赞同：17
> 
> 时间：2009-03-24T12:47:28.990
> 
> 标签：c#, asp.net, file-io, .net

我需要将文件夹 C:\FromFolder 复制到 C:\ToFolder

下面的代码将剪切我的 FromFolder，然后创建我的 ToFolder。所以我的 FromFolder 将消失，所有项目都将在新创建的名为 ToFolder 的文件夹中

```
System.IO.Directory.Move(@"C:\FromFolder ", @"C:\ToFolder"); 
```

但我只想将 FromFolder 中的文件复制到 ToFolder。出于某种原因，没有 System.IO.Directory.Copy ？？？

这是如何使用批处理文件完成的 - 非常简单

xcopy C:\FromFolder C:\ToFolder

问候艾蒂安

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-24T12:51:04.787

这个链接提供了一个很好的例子。

[http://msdn.microsoft.com/en-us/library/cc148994.aspx](http://msdn.microsoft.com/en-us/library/cc148994.aspx)

这是一个片段

```
// To copy all the files in one directory to another directory.
// Get the files in the source folder. (To recursively iterate through
// all subfolders under the current directory, see
// "How to: Iterate Through a Directory Tree.")
// Note: Check for target path was performed previously
//       in this code example.
if (System.IO.Directory.Exists(sourcePath))
{
  string[] files = System.IO.Directory.GetFiles(sourcePath);

  // Copy the files and overwrite destination files if they already exist.
  foreach (string s in files)
  {
    // Use static Path methods to extract only the file name from the path.
    fileName = System.IO.Path.GetFileName(s);
    destFile = System.IO.Path.Combine(targetPath, fileName);
    System.IO.File.Copy(s, destFile, true);
  }
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-24T12:51:28.450

有一个文件副本。重新创建文件夹并将所有文件从原始目录复制到新的 [示例](http://www.java2s.com/Tutorial/CSharp/0300__File-Directory-Stream/CopyDirectory.htm)

```
static void Main(string[] args)
    {
        DirectoryInfo sourceDir = new DirectoryInfo("c:\\a");
        DirectoryInfo destinationDir = new DirectoryInfo("c:\\b");

        CopyDirectory(sourceDir, destinationDir);

    }

    static void CopyDirectory(DirectoryInfo source, DirectoryInfo destination)
    {
        if (!destination.Exists)
        {
            destination.Create();
        }

        // Copy all files.
        FileInfo[] files = source.GetFiles();
        foreach (FileInfo file in files)
        {
            file.CopyTo(Path.Combine(destination.FullName, 
                file.Name));
        }

        // Process subdirectories.
        DirectoryInfo[] dirs = source.GetDirectories();
        foreach (DirectoryInfo dir in dirs)
        {
            // Get destination directory.
            string destinationDir = Path.Combine(destination.FullName, dir.Name);

            // Call CopyDirectory() recursively.
            CopyDirectory(dir, new DirectoryInfo(destinationDir));
        }
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-24T14:17:16.700

（正确地）复制目录实际上是一项相当复杂的任务，特别是如果您考虑到诸如联结和硬链接之类的高级文件系统技术。最好的办法是使用支持它的 API。如果你不怕一点 P/Invoke，shell32 中的 SHFileOperation 是你最好的选择。另一种选择是在 Microsoft.VisualBasic 程序集中使用 Microsoft.VisualBasic.FileIO.FileSystem.CopyDirectory 方法（即使您不使用 VB）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-24T12:59:04.797

是的，你是对的。

[http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)

提供了复制功能..或者您可以使用其他功能

[http://msdn.microsoft.com/en-us/library/ms127960.aspx](http://msdn.microsoft.com/en-us/library/ms127960.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T12:53:12.037

您需要从头开始创建一个新目录，然后遍历源目录中的所有文件并将它们复制过来。

```
string[] files = Directory.GetFiles(GlobalVariables.mstrReadsWellinPath);
foreach(string s in files)
{
        fileName=Path.GetFileName(s);
        destFile = Path.Combine(DestinationPath, fileName);
        File.Copy(s, destFile);
} 
```

我将创建目标目录留给您:-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-24T12:58:40.040

你是对的。没有 Directory.Copy 方法。对于毫无戒心的开发人员来说，这将是一种非常强大的方法，但也是一种危险的方法。复制文件夹可能是一项非常耗时的操作，而移动文件夹（在同一驱动器上）则不然。

我猜微软认为逐个文件复制是有意义的，因此您可以显示某种进度信息。您可以通过创建 DirectoryInfo 的实例然后调用 GetFiles() 来遍历目录中的文件。要还包括子目录，您还可以调用 GetDirectories() 并使用递归方法枚举这些子目录。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-01-31T09:03:30.720

一个简单的函数，将源文件夹的全部内容复制到目标文件夹，如果目标文件夹不存在则创建它

```
class Utils
{
    internal static void copy_dir(string source, string dest)
    {
        if (String.IsNullOrEmpty(source) || String.IsNullOrEmpty(dest)) return;
        Directory.CreateDirectory(dest);
        foreach (string fn in Directory.GetFiles(source))
        {
            File.Copy(fn, Path.Combine(dest, Path.GetFileName(fn)), true);
        }
        foreach (string dir_fn in Directory.GetDirectories(source))
        {
            copy_dir(dir_fn, Path.Combine(dest, Path.GetFileName(dir_fn)));
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-24T12:54:19.973

[本文提供了一个递归复制某个文件夹及其所有内容的算法](http://www.csharp411.com/c-copy-folder-recursively/)

从文章：

> 遗憾的是 System.IO 中没有可以复制文件夹及其内容的内置函数。以下是一个简单的递归算法，它复制文件夹、其子文件夹和文件，并在需要时创建目标文件夹。为简单起见，没有错误处理；如果出现任何问题，例如 null 或无效路径或目标文件已存在，则会引发异常。

祝你好运！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-09T21:12:31.030

我使用扩展名的 DirectoryInfo.CopyTo 版本。

```
public static class DirectoryInfoEx {
    public static void CopyTo(this DirectoryInfo source, DirectoryInfo target) {
        if (source.FullName.ToLower() == target.FullName.ToLower())
            return;

        if (!target.Exists)
            target.Create();

        foreach (FileInfo f in source.GetFiles()) {
            FileInfo newFile = new FileInfo(Path.Combine(target.FullName, f.Name));
            f.CopyTo(newFile.FullName, true);
        }

        foreach (DirectoryInfo diSourceSubDir in source.GetDirectories()) {
            DirectoryInfo nextTargetSubDir = target.CreateSubdirectory(diSourceSubDir.Name);
            diSourceSubDir.CopyTo(nextTargetSubDir);
        }
    }
} 
```

并像这样使用...

```
DirectoryInfo d = new DirectoryInfo("C:\Docs");
d.CopyTo(new DirectoryInfo("C:\New")); 
```

# java - 无法对泛型子类 (Java) 进行静态引用

> ID：677226
> 
> 赞同：5
> 
> 时间：2009-03-24T12:50:55.333
> 
> 标签：java, generics, inheritance, static, extends

我有以下代码：

```
class SuperClass {
    public static String getName() { return "super"; }
}

class SubClass extends SuperClass {
    public static String getName() { return "sub"; }
}

public class Dummy<T extends SuperClass> {
    public void print() {
        System.out.println("SuperClass: " + SuperClass.getName());
        System.out.println("SubClass: " + SubClass.getName());
        System.out.println("T: " + T.getName());
    }
    public static void main(String[] args) {
        new Dummy<SubClass>().print();
    }
} 
```

此代码输出以下内容：

```
SuperClass: super
SubClass: sub
T: super 
```

我的问题是：为什么 T.getName() 不返回 SubClass.getName() 的值？毕竟，我指定了 T == SubClass。还是静态函数调用对泛型引用无效？

提前非常感谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-24T12:55:22.967

这不仅仅是关于泛型的问题。

如果你说：

```
SuperClass obj = new SubClass();
System.out.println(obj.getName()); 
```

您还将获得“超级”。没有“多态”静态方法。

在您的情况下，编译器所知道`T`的只是它 extends `SuperClass`，所以它会调用`SuperClass.getName()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:10:11.247

与 C++ 模板不同，Java 泛型通过类型擦除来工作，因此它只为 的所有值生成一个类`T`，并将该类中对类型的所有引用转换`T`为 的超类型`T`，在这种情况下`SuperClass`，然后使用虚拟调度来为对对象方法的调用，以及对静态方法的调用的静态分派。

因此，当您这样做时`Dummy<SubClass>.print()`，编译器不会对`T`with `SubClass`in进行全局替换`Dummy`。编译器所做的只是检查在are`T`的方法中作为参数或返回类型的使用。里面的任何代码都没有变化，所以不管是什么，都会调用相同的静态方法。`Dummy``SubClass``Dummy``SuperClass``T`

如果您希望根据参数化类型在泛型类中具有不同的行为，您可以传入该类型的对象并使用虚拟方法，或者传入该类型的类并使用反射。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T13:00:09.197

当你用“new Dummy()”实例化这个类时，你调用了默认构造函数，它实际上并没有设置任何东西。当调用 print 方法时，VM 看到 T 的类型，正如在类声明中声明的那样，是 SuperClass；然后它调用这个类的静态方法。

# asp.net - 如何通过只知道加密密码登录到 ASP.NET 应用程序？

> ID：677234
> 
> 赞同：1
> 
> 时间：2009-03-24T12:52:04.113
> 
> 标签：asp.net

我对 Web 应用程序（ASP.NET）非常陌生。我有一个完整项目的源代码和数据库。

ASP.NET (Authentication) 控件用于登录。我现在不知道密码，但我可以从数据库表中以加密格式获取登录名和密码。
只有这么少的信息，我怎么能登录到应用程序。

由于控件是在页面上动态创建的，因此很难在运行时调试和找到它们。

我如何通过加密密码进行登录？或者有没有办法通过克服身份验证控制来登录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T12:55:07.583

密码可能是 SHA1 加密的。基本上你需要做的是 SHA1 加密用户给你的密码并将它与你数据库中的密码进行比较。因为如果输入相同，SHA1 总是会产生相同的结果，所以如果两个哈希值匹配，您将知道给定密码的用户是正确的。

SHA1 加密是一种散列形式，无法逆转。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:15:12.827

不，数据库中的散列密码是故意不可逆的。这可以防止任何人（黑客？）读取您的数据库并能够登录。

正如 Sam152 所说，密码很可能是 SHA1 散列的，所以如果密码没有用盐存储，你可以建立一个彩虹表来找到原始密码。如果它们是盐渍的，你也需要知道盐来构建彩虹表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T12:54:51.720

您可以尝试`MembershipProvider`通过从此类派生来实现自定义。然后，您只需覆盖方法`ValidateUser`即可满足您的要求。还要记得修改Web.config。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T13:24:03.367

散列密码的要点是，不知道解密密码的人不能使用它们。

应该有一种方法可以为用户重置密码。您可以这样做并根据重置密码登录。

如果您尝试登录活动用户的帐户，您可能需要考虑在他们不知情的情况下这样做的影响（如果是这样的话）。但是，如果只是测试用户，重置密码可能是最不麻烦的方式。无论如何，该功能或过程可能应该是 Web 应用程序的一部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T13:34:37.660

如果它是标准的 ASP.NET 成员资格，我认为它使用存储过程来检查数据库。只需更改它并让它返回 true 或其他。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-27T04:06:42.487

添加到上述答案 SHA1 加密输出为 40 字节。您应该检查加密密码的长度以了解加密类型。由于哈希算法已预定义没有输出字节，这将帮助您映射算法类型，然后您应该寻找可能的盐用法@MattGWagner 说...数据库中存储用户信息的表是否类似于 aspnet_users、aspnet_membership 等？那么这应该是windows提供的标准认证了。google一下看看是怎么工作的

# .net - WM_DESTROY, WM_CLOSE 绕过 IMessageFilter

> ID：677236
> 
> 赞同：1
> 
> 时间：2009-03-24T12:52:55.437
> 
> 标签：.net, windows, winforms, message-queue, imessagefilter

以下是我的消息过滤器：

```
bool MyFilter::PreFilterMessage(Message %m){
    switch(m.Msg){
    case WM_CLOSE:
    case WM_DESTROY:
    case WM_NCDESTROY:
    case WM_QUIT:
        Debug::WriteLine(L"Gone!");
        break;
    case WM_MOUSEMOVE:
        Debug::WriteLine(L"A mouse! Catch! Catch!!! CATCH!!");
        break;
    }
    return false;
} 
```

我确认我正在过滤大多数消息而没有问题。但是，在单击窗口的关闭按钮（、、和）后，我没有收到任何`WM_CLOSE`发送的`WM_DESTROY`消息。为什么是这样？`WM_NCDESTROY``WM_QUIT`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T19:11:48.600

IMessageFilter.PreFilterMessage() 仅对消息队列中的消息调用。WM_CLOSE 之类的消息通过 SendMessage() 直接发送到 WndProc()，它们绕过队列。您也不会收到 WM_ACTIVATE、WM_GETTEXT 等消息。输入事件，仅此而已。

# cruisecontrol.net - 用于打开 ccnet.config 的 CCNetConfig 命令行参数？

> ID：677242
> 
> 赞同：1
> 
> 时间：2009-03-24T12:54:29.473
> 
> 标签：cruisecontrol.net, ccnet-config

我正在尝试[CCNetConfig](http://ccnetconfig.codeplex.com/) （警告，网站有点慢）。很棒的应用程序，一个烦恼。

我可以在文档甚至[源代码](http://ccnetconfig.codeplex.com/SourceControl/changeset/view/46726#405981)中看到（查看 Initialize 方法的末尾），我应该能够传入命令行参数以自动加载配置文件。

我努力了：

```
-f E:\CruiseControl.Net\server\ccnet.config
-file E:\CruiseControl.Net\server\ccnet.config
-f=E:\CruiseControl.Net\server\ccnet.config
-file=E:\CruiseControl.Net\server\ccnet.config 
```

为了以防万一，同样的 4 个开关在文件名周围加上引号。

他们都产生错误或只是不工作。有没有人成功做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T13:05:44.783

尝试将其移至其他路径。尝试最简单的方法：c:\ccnet.config。

我猜这是问题的根源，因为我记得 CCNetConfig 早在我尝试在其中包含空格的路径中打开文件时（例如在程序文件中）就给了我 sh!t。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-06T11:07:08.350

根据我的CCNet版本，使用不同配置文件的命令行标志是-c或--config，所以下面应该这样做......

```
-c "E:\CruiseControl.Net\server\ccnet.config" 
```

...这对我有用。

我不知道为什么它使用非标准标志，但你去。

# c# - 硬盘序列号

> ID：677251
> 
> 赞同：0
> 
> 时间：2009-03-24T12:57:51.447
> 
> 标签：c#, hard-drive

如何在c#.net中获取所有类型硬盘的序列号

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T13:01:12.063

看起来[这篇文章](http://www.codeproject.com/KB/cs/hard_disk_serialno.aspx)应该有所帮助

它使用 WMI [Win32_PhysicalMedia](http://msdn.microsoft.com/en-us/library/aa394346(VS.85).aspx)类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T13:02:50.327

智能 IOCTL。不记得我的头顶是哪个智能命令，但基本上你打开卷并发出一个智能命令......

# python - 适用于 Windows 的 Python SVN 绑定

> ID：677252
> 
> 赞同：21
> 
> 时间：2009-03-24T12:58:01.680
> 
> 标签：python, windows, svn, swig, precompiled

在哪里可以找到适用于 Windows 的预编译 Python SWIG SVN 绑定？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-24T13:18:35.343

tigris.org 上的（旧）[Windows 二进制文件页面包含一个](http://subversion.tigris.org/servlets/ProjectDocumentList?folderID=8100)*用于 SVN 的 python 绑定*的安装程序。[在/trunk/subversion/bindings/swig/python](http://svn.apache.org/viewvc/subversion/trunk/subversion/bindings/swig/python/)查看 SWIG 绑定的源代码。

（2010 年 5 月 - *Subversion 项目*正在转变为 Apache 软件基金会的新角色，许多资源正在更改地址。更新源链接。）

（2010 年 11 月 - 更多 Windows 二进制文件）

由 algazam 开发的[win32svn](http://alagazam.net/)项目*Subversion for Windows*是一个 win32 版本的 subversion。截至 2010 年 11 月，它包含日期为 2010-10-05 的 1.6.13 版本， *包括`python 2.6`绑定*。

（2011 年 1 月 - 跟上：2010 年 12 月 17 日，[1.6.15](http://sourceforge.net/projects/win32svn/files/1.6.15/)，Python 2.6.6。）

（2011 年 5 月 - 2011 年 3 月14 日， [1.6.16](http://sourceforge.net/projects/win32svn/files/1.6.16/)，Python 2.6.6）

（2011 年 6 月 - 2011-06-03，1.6.17 ，Python [2.6.6](http://sourceforge.net/projects/win32svn/files/1.6.17/)）

（2011 年 10 月 - 2011 年 10 月 15 日，[1.7.0](http://sourceforge.net/projects/win32svn/files/1.7.0/)），Python 2.6.6 和 2.7.2）

（2011 年 12 月 - 2011 年 12 月 12 日，[[1.7.2]](http://sourceforge.net/projects/win32svn/files/1.7.2/)，Python 2.7.2 和 2.6.6）

（2012 年 2 月 - 2012 年 2 月 18 日，[[1.7.3]](http://sourceforge.net/projects/win32svn/files/1.7.3/)，Python 2.5.4，2.6.6 和 2.7.2）

（2012 年 3 月 - 2012-03-08 [1.7.4](http://sourceforge.net/projects/win32svn/files/1.7.4/)，Python 2.5.4，2.6.6 和 2.7.2）

（2012 年 5 月 - 2012-05-17 [1.7.5](http://sourceforge.net/projects/win32svn/files/1.7.5/)，Python 2.5.4，2.6.6 和 2.7.3）

（2012 年 8 月 - 2012-08-15 [1.7.6](http://sourceforge.net/projects/win32svn/files/1.7.6/)，Python 2.5.4、2.6.6 和 2.7.3。没有 Python 3 版本）

（2012 年 12 月 - 2012-12-20 [1.7.8](http://sourceforge.net/projects/win32svn/files/1.7.8/)，Python 2.5.4、2.6.6 和 2.7.3。）

（2013 年 11 月 - 2013-11-25 [1.8.5](http://sourceforge.net/projects/win32svn/files/1.8.5/)，Python 2.6.6 和 2.7.6）

（2016 年 5 月 - 2016-05-04 [1.8.16](https://sourceforge.net/projects/win32svn/files/1.8.16/)，Python 2.6.6 和 2.7.9）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-31T08:10:41.040

您可以在 Trac 项目中找到有效的绑定：

[http://trac.edgewall.org/wiki/TracSubversion](http://trac.edgewall.org/wiki/TracSubversion)

见附件：

svn-win32-1.6.15_py_2.7.zip

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-21T11:24:36.300

以下页面似乎是唯一可以找到 64 位 SWIG 绑定的页面： [https ://bitbucket.org/tortoisehg/thg/wiki/libsvn](https://bitbucket.org/tortoisehg/thg/wiki/libsvn)

安装 64 位 mercurial 将需要它们，而 32 位 mercurial 安装程序不会安装在 64 位 Windows 上。

# php - 网站的 SQL 数据库存储有哪些替代方案？

> ID：677253
> 
> 赞同：19
> 
> 时间：2009-03-24T12:58:04.677
> 
> 标签：php, sql, cgi, lamp

如果您的存储需求很小，那么 SQL 数据库就显得多余了。当我年轻而愚蠢的时候，我使用了一个文本文件，并在需要访问它时对其进行了flock()。这无法扩展，但我仍然觉得非数据库解决方案在 Web 2.0 中已被完全忽略。

有人*不*使用 SQL 数据库进行存储吗？有哪些替代方案？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-24T13:05:55.593

有很多选择。但是拥有 SQLite 可以为您提供 SQL 功能，并且无需大惊小怪的基于文件的存储，因此无需寻找这些替代方案。SQLite 足够轻，可以用于手机和 MP3 播放器，所以我不明白它怎么会被认为是矫枉过正。

因此，除非您的应用程序需要一些非常具体的东西，否则不要打扰。大多数替代品更难使用并且性能较差。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-24T14:02:02.917

[SQLite](http://www.sqlite.org/)就是为此而发明的。

它只是一个包含完整 SQL 数据库的平面文件。您可以查询、更新、插入、删除，安装几乎没有开销，您只需要驱动程序（PHP 中的标准配置）

> SQLite 是一个实现自包含、无服务器、零配置、事务性 SQL 数据库引擎的软件库。

有点奇怪，没有人提到这一点？

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-24T13:17:57.560

CouchDB ( [http://couchdb.apache.org/index.html](http://couchdb.apache.org/index.html) ) 是一个非 sql 数据库，现在似乎是一个流行的项目，还有 Google 的 bigtable 或 GT.M ( [http://sourceforge. net/projects/fis-gtm](http://sourceforge.net/projects/fis-gtm)）一直存在。

对象数据库也比比皆是。dbforobjects ( [http://www.db4o.com/)、ZODB](http://www.db4o.com/) ( [http://www.zope.org/Products/StandaloneZODB](http://www.zope.org/Products/StandaloneZODB) )，仅举几例。

对于某些用例，所有这些都比传统的 SQL 数据库更快、更简单，但没有一个能达到平面文件的简单性。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-24T13:05:24.767

像[google bigtable](http://code.google.com/appengine/docs/python/datastore/)或[hadoop](http://hadoop.apache.org/core/)这样的分布式哈希表是一种简单且可扩展的非 SQL 数据库，通常比 SQL 数据库更适合网站。SQL 非常适合复杂的关系数据，但大多数网站没有这个要求。大多数网站以几种形式存储和检索数据，并且不需要对数据运行复杂的操作。

看看其中一个解决方案，因为它们将提供您需要的所有并发访问，但不支持传统的数据规范化理念。它们可以被认为非常类似于一堆命名的文本文件。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-24T13:04:54.957

这可能取决于您的网站的动态程度。我曾经使用过使用 RCS 签入和签出文本文件的 wiki 软件。对于像 StackOverflow 或 Wikipedia 那样获得尽可能多的更新的东西，我不会推荐该解决方案。关于数据库的事情是它们可以很好地扩展，并且数据库引擎编写者已经弄清楚了同时访问、负载平衡、复制等所有繁琐的小细节。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-24T13:08:45.587

我想说这不取决于您存储的信息是少是多，而是取决于您请求存储数据的频率。数据库管理器在缓存查询方面非常出色，因此它们通常是性能更好的选择。但是，如果您不需要动态网页而只是加载静态数据 - 也许文本文件是更好的选择。数据以哪种格式存储（即 XML、JSON、key=pair）并不重要——I/O 操作对性能很重要。

当我开发 Web 应用程序时，我总是使用 RDBMS 作为主要数据持有者。如果 Web 应用程序不需要在每次请求时都提供动态数据，我只需应用一个缓存功能，将数据存储在一个缓存文件中，当没有新数据添加到主数据源（RDBMS）时，该缓存文件会被请求。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-24T15:55:36.917

我不会根据我想存储多少数据来选择是否使用 SQL 数据库——我会根据我想存储*什么样*的数据以及如何使用它来选择。

维基百科将数据库定义为：*数据库是存储在计算机系统中的记录或数据的结构化集合*。而且我认为您的答案就在那里：如果您想存储诸如客户帐户、访问权限等记录，那么诸如 mySQL 或 SQLite 之类的数据库或其他任何不会过分的东西。它们为您提供了一种久经考验且值得信赖的机制来管理这些记录。

另一方面，如果您的网站存储和提供不变的基于文件的内容，例如 PDF、报告、mp3 等，那么只需将它们存储在磁盘上定义明确的目录布局中就足够了。我还会在此处包含 XML 文档：例如，如果您有一个生产部门以 XML 格式为网站创建文章，则无需将它们放在数据库中 - 将它们存储在磁盘上并使用 XSLT 来传递它们。

您是否选择 SQL 还取决于如何检索您希望存储的内容。SQL 显然适用于根据搜索条件检索许多记录，而目录树、XML 数据库、RDF 数据库等更有可能用于检索单个记录。

当尝试扩展高流量站点并将所有内容塞入 SQL DB 时，存储机制的选择非常重要，这将很快成为瓶颈。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-24T15:39:10.593

这取决于您存储的内容。我的博客使用 Blosxom（用 Perl 编写，但可以为 PHP 做类似的事情），其中每个单独的条目都是一个单独的文本文件。第一行是纯文本（标题），其余的是不受限制的 HTML。遵循一些简单的规则，这些被呈现以形成一个简单但有效的博客框架。

它确实有缺点，但这也意味着每个帖子都是一个独立的文件，非常适合在本地计算机上更新然后发布到远程 Web 服务器。但是，这在高效查询方面是有限的，因此如果您想要与数据进行细粒度控制和基于 Web 的交互，这肯定不是一个好的选择。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-24T13:15:10.110

检查[CouchDB](http://couchdb.apache.org/)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-24T13:18:25.580

我在 .NET 项目中使用 LINQ to XML 作为数据源。这是一个小型解决方案，并使用缓存来缓解性能问题。对于只需要将数据保存在公共位置而不增加服务器要求的快速站点，我会再次这样做。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-24T14:42:25.550

取决于您存储的内容以及您需要如何访问它。通常sql提供了很好的报告和手动管理能力。几乎所有东西都需要某种方式来管理存储的内容并对其进行报告。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-24T16:04:14.230

SQL 数据库的下一层是[ISAM](http://en.wikipedia.org/wiki/ISAM)（索引顺序访问方法）——基本上是表和索引，但没有 SQL，表之间也没有显式关系。只要概念基础适合您的设计，它就会很好地扩展。我已经有效地使用[Codebase](http://www.codebase.com/)很长时间了。

如果您想使用 SQL 数据库类型的数据，请考虑使用[FileMaker](http://www.filemaker.com/index.html)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-26T23:45:18.620

在 Perl 中，我使用 DBM 或 Storable 来完成此类任务。DBM 将在变量更新时自动更新。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-03-28T23:36:00.590

一个简单的答案是您可以使用任何数据存储格式，从标准定义到数据库（通常涉及协议），甚至是定制的文件格式。

您在 IT 领域做出的每一个选择都需要权衡取舍，当然网站也不例外。在 2000 年初，基于文件的论坛系统很流行，因为它允许任何技术能力有限的人编辑页面和帖子。完全静态的站点很快变得无法管理，并且内容不会从站点用户界面的升级中受益；但是，如果网站编码正确，则可以简单地将其移动到子目录，或翻录到新设计中。CMS 和动态系统带来了它们自己的一系列问题，即它们之间尚不存在广泛采用的数据存储标准；他们经常依赖第三方插件来提供设计风格之间的功能（尽管他们的文档提倡功能和形式的分离）。

在 2016 年，不使用标准存储机制的情况非常罕见，例如 *SQL RDBMS；尽管 Jekyll 等静态站点生成器（为许多 GitHub 页面提供支持）；像 October CMS 这样的独立玩家仍然提供基于静态文件的存储。

我个人的偏好是使用启用 *SQL 的 RDBMS，它为我提供了至少在供应商级别标准化的语法、熟悉且强大的语法，但与很多人不同的是，我认为这不是唯一的方法，并且在大多数情况下会提倡使用站点生成器将不必是动态的部分保存到静态存储中，因为这是在网络上生活的最便宜的方式。

TLDR；由你决定，支持 SQL 和 RDBMS 很受欢迎。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-04-01T20:02:28.263

好吧，这是来自 OP 的一个开放式问题，有两个问题......围绕 SQL 替代方案和非 SQL。

一般来说，在“为什么 SQL 好”类别中……它是一个成熟且强大的标准，可提供引用完整性。Java JDBC 完全支持它，就像 TOAD 之类的工具一样，还有许多 SQL 实现，例如前面提到的 SQL-Lite。

现在特定于“用于网站”并不能特别说明任何事情。网站是否需要参照完整性？也许。如果网站的业务性质主要是非结构化内容，那么可以考虑任何类型的持久存储，从 AWS DynamoDB 等所谓的“非 SQL”数据库到 Mongo（虽然不是粉丝）。

对于管理 SQL 存储的复杂性 - 一个建议与曾经创建的每个持久性存储的列表相比……是 AWS Aurora（RDS 服务的一部分）。它是多区域主动-主动且完全兼容 MySQL。基于 JDBC/ODBC 的驱动程序框架可以开箱即用，并且有效地提供“零管理”。

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2009-03-24T12:59:34.673

如果我是你，我会检查 XML。请参阅左侧的[w3schools XML 教程部分。](http://w3schools.com/)不使用 SQL 数据库的大量可能性。

# python - 从 Spring Python 开始的最佳在线教程是什么

> ID：677255
> 
> 赞同：4
> 
> 时间：2009-03-24T12:58:23.770
> 
> 标签：python, spring

Spring Python 似乎是如何在 Python 中定义优质 API 的黄金标准——它基于 Spring，这似乎也是 Java API 的黄金标准。

我的经理抱怨（有充分理由）我们的 API 一团糟——我们需要对它们强加一些命令。由于我们将进行重构，因此利用被认为是最佳实践的东西是有意义的——所以我们想考虑 Spring。

有人可以指出我开始使用 Spring 的最佳学习资源吗？我用谷歌搜索了一段时间，没有发现任何似乎从第一原则开始的东西。我正在寻找一些假设对 Python 有很好的了解，但对其他平台上的 Spring 或其原理零了解的东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T13:19:51.393

您是如何决定选择 Spring Python 作为您的 API 的？Spring 在具有声明式编程传统的 Java 上运行良好；主要使用 XML 定义应用程序来控制核心引擎是 Java 中的标准模式。

在 Python 中，虽然控制反转等底层模式仍然适用（取决于您的用例），但 Spring 选择的实现看起来像是由不想学习 Python 的 Java 程序员编写的经典案例。请参阅经常引用的文章[Python is Not Java](http://dirtsimple.org/2004/12/python-is-not-java.html)。

我赞赏你决定在你的代码库中引入秩序和深思熟虑，但你可能希望在做出决定之前评估一些选项。特别是，您可能会发现使用 Spring Python 将很难聘请优秀的 Python 程序员，当面对描述对象交互的 1000 行 XML 文件时，他们中的许多人会以另一种方式运行。

也许从重新审视你真正想要完成的事情开始。问题不能简单地是“你需要一个框架”。那里有很多框架，很难评估 a) 如果你真的需要一个，b) 如果你还没有确定你需要解决哪些潜在的软件问题，那么哪个框架可以工作。

如果真正的问题是您的代码是无法维护的混乱，那么引入框架可能无法解决问题。您将拥有其他人风格的混乱代码，而不仅仅是凌乱的代码 :-) 也许您应该建议首先在开发团队中严格要求：良好的规划、代码审查、严格的招聘实践、“清理”版本， ETC...

祝研究顺利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:55:00.017

我不会说 Spring Python 不好（因为我对它了解得不够多）。但是，将 Spring Python 称为“Python API 的黄金标准”有点牵强。在我看来，Spring Python 似乎更像是一种允许 Python 应用程序使用 Spring 与 Java 应用程序交互的方式。

无论如何，在初步浏览了[官方文档](http://springpython.webfactional.com/reference/html/index.html)之后，对我有相当的 Python 知识但不了解 Spring 的我来说似乎很容易理解。除了它几乎看起来像 Java 代码这一事实之外，作者忘记了类型名、分号和花括号。:-)

> ID：677257
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# operators - == 运算符和操作数

> ID：677264
> 
> 赞同：5
> 
> 时间：2009-03-24T13:00:30.847
> 
> 标签：operators, equality

我想检查一个值是否等于1。以下代码行有什么区别

评估值 == 1

1 == 评估值

就编译器执行而言

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-24T13:03:01.840

在大多数语言中都是一样的。

人们经常做 1 == 评估值，因为 1 不是左值。这意味着你不能不小心做作业。

例子：

```
if(x = 6)//bug, but no compiling error
{
} 
```

相反，您可以强制编译错误而不是错误：

```
if(6 = x)//compiling error
{
} 
```

* * *

现在，如果 x 不是 int 类型，并且您使用的是 C++ 之类的东西，那么用户可能已经创建了一个 operator==(int) 覆盖，它将这个问题赋予了新的含义。在这种情况下， 6 == x 不会编译，但 x == 6 会。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-24T21:20:50.240

这取决于编程语言。

在 Ruby、Smalltalk、Self、Newspeak、Ioke 和许多其他单次调度的面向对象编程语言中，`a == b`实际上是消息发送。例如，在 Ruby 中，它等价于`a.==(b)`. 这意味着，当您编写 时，将执行类中`a == b`的方法，但当您编写时，则执行类中的方法。所以，这显然*不是*一回事：`==``a``b == a``b`

 *```
class A; def ==(other) false end; end
class B; def ==(other) true  end; end

a, b = A.new, B.new

p a == b # => false
p b == a # => true 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-24T13:03:03.213

不，但如果您不小心键入，后一种语法会给您一个编译器错误

```
if (1 = evaluatedValue) 
```

请注意，今天任何体面的编译器都会警告您，如果您编写

```
if (evaluatedValue = 1) 
```

所以它主要与历史原因有关。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-24T13:03:09.407

取决于语言。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-24T13:21:12.733

在 Prolog 或 Erlang 中，`==`写`=`的是统一而不是赋值（您断言值相等，而不是测试它们是否相等或强制它们相等），因此您可以将其用于断言，如果左边是一个常数，如[here](http://armstrongonsoftware.blogspot.com/2009/01/micro-lightweight-unit-testing.html)所述。

因此`X = 3`将变量`X`和值统一起来`3`，而`3 = X`尝试将常量`3`与 的当前值统一起来`X`，并等效`assert(x==3)`于命令式语言。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-24T13:02:33.590

这是同一件事

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-24T13:19:07.510

通常，您是否使用评估值 == 1 或 1 == 评估值都无关紧要。

使用对您来说更具可读性的任何一个。我更喜欢 if(Evaluated value == 1) 因为它对我来说更具可读性。

再一次，我想引用一个众所周知的 java 中字符串比较的场景。考虑一个字符串 str，您必须将其与另一个字符串“SomeString”进行比较。

```
str = getValueFromSomeRoutine(); 
```

现在在运行时，您不确定 str 是否为 NULL。所以为了避免异常你会写

```
if(str!=NULL)
{
   if(str.equals("SomeString")
   {
      //do stuff
    }
} 
```

为了避免外部空检查，你可以写

```
if ("SomeString".equals(str))
{
   //do stuff
} 
```

尽管这又取决于上下文的可读性，但这可以为您节省额外的 if。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-24T13:06:06.887

对于这个和类似的问题，我建议您通过编写一些代码，通过编译器运行它并查看发出的汇编器输出来自己找出答案。

例如，对于 GNU 编译器，您可以使用 -S 标志来执行此操作。对于 VS 编译器，最方便的方法是在调试器中运行您的测试程序，然后使用汇编器调试器视图。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-24T13:13:34.013

有时在 C++ 中，如果评估的值是用户类型并且定义了 operator==，它们会做不同的事情。很糟糕。

但这很少是任何人选择一种方式而不是另一种方式的原因：如果 operator== 不是可交换/对称的，包括如果值的类型具有从 int 的转换，那么你有一个可能想要修复而不是修复的问题工作。Brian R. Bondy 和其他人的回答可能是人们在实践中担心它的原因。

但事实仍然是，即使 operator== 是可交换的，编译器在每种情况下也可能不会做*完全相同*的事情。它将（根据定义）返回相同的结果，但它可能会以稍微不同的顺序或其他方式做事。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-24T13:03:32.587

```
if value == 1
if 1 == value 
```

完全一样，但如果你不小心做了

```
if value = 1
if 1 = value 
```

第一个将起作用，而第二个将产生错误。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-24T13:03:43.227

他们是一样的。有些人喜欢把 1 放在第一位，以免不小心掉入打字的陷阱

```
 evaluated value = 1 
```

如果左侧的值是可分配的，这可能会很痛苦。例如，这是 C 语言中常见的“防御”模式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-24T13:18:51.163

在 C 语言中，通常将常量或幻数放在首位，这样如果您忘记了相等检查 (==) 的“=”之一，那么编译器不会将其解释为赋值。

在 Java 中，您不能在布尔表达式中进行赋值，因此对于 Java，相等操作数的写入顺序无关紧要；无论如何，编译器都应该标记一个错误。

# multithreading - 线程化向量统计库-数学内 核库时数据损坏

> ID：677273
> 
> 赞同：0
> 
> 时间：2009-03-24T13:01:59.317
> 
> 标签：multithreading, fortran

我刚刚并行化了一个模拟个人行为的 fortran 例程，并且在使用 Vector Statistical Library（来自 Math Kernel Library 的库）生成随机数时遇到了一些问题。该程序的结构如下：

```
program example
...
!$omp parallel do num_threads(proc) default(none) private(...) shared(...)
do i=1,n
call firstroutine(...)
enddo
!$omp end parallel do
...
end program example

subroutine firstroutine
...
call secondroutine(...)
...
end subroutine

subroutine secondroutine
...
VSL calls
...
end subroutine 
```

我使用 Intel Fortran 编译器进行编译，生成文件如下所示：

```
f90comp = ifort
libdir = /home
mklpath = /opt/intel/mkl/10.0.5.025/lib/32/
mklinclude = /opt/intel/mkl/10.0.5.025/include/
exec: Example.o Firstroutine.o Secondroutine.o
      $(f90comp) -O3 -fpscomp logicals -openmp -o  aaa -L$(mklpath) -I$(mklinclude) Example.o -lmkl_ia32 -lguide -lpthread
Example.o: $(libdir)Example.f90
       $(f90comp) -O3 -fpscomp logicals -openmp -c $(libdir)Example.f90
Firstroutine.o: $(libdir)Firstroutine.f90
       $(f90comp) -O3 -fpscomp logicals -openmp -c $(libdir)Firstroutine.f90
Secondroutine.o: $(libdir)Secondroutine.f90
       $(f90comp) -O3 -fpscomp logicals -openmp -c -L$(mklpath) -I$(mklinclude) $(libdir)Secondroutine.f90  -lmkl_ia32 -lguide -lpthread 
```

在编译时一切正常。当我运行我的程序生成变量时，一切似乎都正常。但是，有时（例如每 200-500 次迭代一次），它会为几次迭代生成疯狂的数字，然后以正常方式再次运行。我还没有发现这种腐败何时发生的任何模式。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T13:34:10.160

The random number code is either using a global variable internally or all threads use the same generator. Eventually, two threads will try to update the same piece of memory at the same time and the result will be non-predictable.

So you must allocate one random number generator per thread.

Solution: Protect the call to the random routine with a semaphore/lock.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T10:17:52.690

I got the solution! I was modifying the pseudo-random numbers generated by some values taken from a file. From time to time, more than one thread tried to read the same file and generated the corruption. To solve this, I added a omp critical section and it worked.

# java - 显示名称包含特殊字符的图像

> ID：677275
> 
> 赞同：1
> 
> 时间：2009-03-24T13:02:20.343
> 
> 标签：java, html, jsp, encoding, upload

我正在尝试使用 jsp 显示一些包含特殊字符（如 ☻ ☺ ♥ 或中文或阿拉伯字符）的图像......但图像没有显示！

```
<img src = "pipo².jpg" />
<img src = "pip☺☻♥o².jpg" /> 
```

我究竟做错了什么 ！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T13:21:35.697

在将 HTML 发送到页面之前，尝试使用[URLEncoder.encode()方法对文件名进行编码，例如](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLEncoder.html)

```
String encodedString = URLEncoder.encode(filename, "UTF-8"). 
```

这会将字符转换为可以在 HTML 中传递的实体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T13:22:18.657

您可以在 javascript 中使用 encodeURIComponent 对网址进行百分比编码，以便为您提供

```
<img src="pip%C3%A2%C2%98%C2%BA%C3%A2%C2%98%C2%BB%C3%A2%C2%99%C2%A5o%C3%82%C2%B2.jpg"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T13:23:23.103

我建议重命名您的文件。

不允许在 src 路径中使用特殊字符，您必须找到这些字符的 URL 样式转义码。

# vb.net - 限制 List(Of T) 的大小 - VB.NET

> ID：677278
> 
> 赞同：7
> 
> 时间：2009-03-24T13:02:41.467
> 
> 标签：vb.net, generics, list, limit

我试图限制我的通用列表的大小，以便在它包含一定数量的值之后，它不会再添加。

我正在尝试使用 List 对象的容量属性来执行此操作，但这似乎不起作用。

```
 Dim slotDates As New List(Of Date)
        slotDates.Capacity = 7 
```

人们会如何建议限制列表的大小？

我试图避免在添加每个对象后检查列表的大小。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-24T13:05:33.660

没有内置方法来限制 List(Of T) 的大小。容量属性只是修改底层缓冲区的大小，而不是限制它。

如果你想限制列表的大小，你需要创建一个检查无效大小的包装器。例如

```
Public Class RestrictedList(Of T)
  Private _list as New List(Of T)
  Private _limit as Integer
  Public Property Limit As Integer 
    Get 
      return _limit
    End Get
    Set 
      _limit = Value
    End Set
  End Property

  Public Sub Add(T value) 
    if _list.Count = _limit Then
      Throw New InvalidOperationException("List at limit")
    End If
    _list.Add(value)
  End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-24T13:29:43.337

有几种不同的方法可以向 a 中添加内容`List<T>`：Add、AddRange、Insert 等。

考虑一个继承自的解决方案`Collection<T>`：

```
Public Class LimitedCollection(Of T)
    Inherits System.Collections.ObjectModel.Collection(Of T)

    Private _Capacity As Integer
    Public Property Capacity() As Integer
        Get
            Return _Capacity
        End Get
        Set(ByVal value As Integer)
            _Capacity = value
        End Set
    End Property

    Protected Overrides Sub InsertItem(ByVal index As Integer, ByVal item As T)
        If Me.Count = Capacity Then
            Dim message As String = 
                String.Format("List cannot hold more than {0} items", Capacity)
            Throw New InvalidOperationException(message)
        End If
        MyBase.InsertItem(index, item)
    End Sub

End Class 
```

这样，无论您`Add`还是`Insert`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-24T13:08:47.223

您需要派生一个新的`LimitedList`并隐藏添加方法。这样的事情会让你开始。

```
public class LimitedList<T> : List<T>
{
    private int limit;

    public LimitedList(int limit)
    {
        this.limit = limit;
    }

    public new void Add(T item)
    {
        if (Count < limit)
            base.Add(item);
    }
} 
```

*刚意识到你在VB，我会尽快翻译*

**编辑**请参阅 Jared 的 VB 版本。我会把它留在这里，以防有人想要一个 C# 版本开始使用。

对于它的价值，我采取了一种稍微不同的方法，因为它扩展了 List 类而不是封装它。您要使用哪种方法取决于您的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T13:06:33.720

如果您需要限制其中项目的最大数量，您应该实现自己的列表/集合。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T13:07:39.007

List 没有这样的功能。

[容量](http://msdn.microsoft.com/en-us/library/y52x03h2.aspx)只是性能优化。

您将不得不推出自己的类，派生列表并覆盖 Add 实现。

# asp.net - 以编程方式查找 ASP.Net projectdir

> ID：677287
> 
> 赞同：0
> 
> 时间：2009-03-24T13:03:38.360
> 
> 标签：asp.net

标题是我的问题。我不知道我的项目将部署到的 Web 服务器的详细信息。在一个类中，我在项目目录中执行一个批处理文件。我应该说“C:\Inetpub\wwwroot\etcetcetc”并希望最好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T13:05:35.390

[http://msdn.microsoft.com/en-us/library/ms524632.aspx](http://msdn.microsoft.com/en-us/library/ms524632.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T13:06:50.317

尝试，

```
Server.MapPath(ResolveUrl("~/")) 
```

# winapi - 自定义绘制控件

> ID：677297
> 
> 赞同：0
> 
> 时间：2009-03-24T13:05:26.983
> 
> 标签：winapi, automated-tests

我们需要自动化在 Win32 API 中开发的应用程序的 GUI 测试。开发人员已通过自定义绘制控件创建了此应用程序。它们具有看起来像网格、按钮等的控件，但它们不是基本的 Windows 控件。

什么是自定义绘制控件？以及我们如何测试这些控件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T13:24:18.170

像任何其他 UI 一样对其进行测试：完全没有。将所有代码从回调移到应用程序层，您的单元测试可以像执行任何其他方法一样执行它们。

理由：测试“button.activate()”是否有效没有什么意义；您想知道按钮回调背后的代码是否有效*。*

如果需要知道是否打开了正确的对话框等，请看我的博客：[Testing the Impossible: User Dialogs](http://blog.pdark.de/2008/11/11/testing-the-impossible-user-dialogs/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T04:48:27.247

开发人员是否使用[IAccessible](http://msdn.microsoft.com/en-us/library/accessibility.iaccessible.aspx)添加了对可访问性的支持？如果有，您可以使用[主动可访问性](http://msdn.microsoft.com/en-us/library/ms971310.aspx)来浏览控件并以这种方式对其进行测试。

如果他们没有，请打开一个错误，说明他们的控件不能被残疾人（需要屏幕阅读器或其他辅助功能）使用。

一旦他们修复了该错误，您就可以使用他们添加到控件中的任何机制，以允许屏幕阅读器和其他可访问性辅助工具使用它们来测试他们的 UI。

# delphi - 如何通过 WebBrowser-Control (ActiveX InternetExplorer) 获取页面源代码？

> ID：677306
> 
> 赞同：6
> 
> 时间：2009-03-24T13:07:24.747
> 
> 标签：delphi, webbrowser-control

如何通过 WebBrowser Control (ActiveX InternetExplorer) 获取页面的源代码？

我有一个 xml 文档“foo.xml”。

```
var
 Web: TWebBrowser;
begin
 ...
 Web.Navigate("foo.xml");
 // How can I get source code thru WebBrower control<----
 ...
end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-25T13:30:10.000

WebBrowser1.Navigate() 使用 Windows 操作系统中内置的 IE 组件将其加载到 RAD 组件窗口中。您所做的是响应回调（对于浏览器组件，双击 OnDownloadComplete 事件）并将其保存到该函数中的文件。工作代码的片段：

```
procedure TMainForm.WB_SaveAs_HTML(WB : TWebBrowser; const FileName : string) ;
var
   PersistStream: IPersistStreamInit;
   Stream: IStream;
   FileStream: TFileStream;
begin
   if not Assigned(WB.Document) then
   begin
     Logg('Document not loaded!') ; //'Logg' adds a line to a log file.
     Exit;
   end;

   PersistStream := WB.Document as IPersistStreamInit;
   FileStream := TFileStream.Create(FileName, fmCreate) ;
   try
     Stream := TStreamAdapter.Create(FileStream, soReference) as IStream;
     if Failed(PersistStream.Save(Stream, True)) then ShowMessage('SaveAs HTML fail!') ;
   finally
     FileStream.Free;
   end;

end; (* WB_SaveAs_HTML *)

procedure TMainForm.WebBrowser1DownloadComplete(Sender: TObject);
begin
   if (WebBrowser1.Document<>nil)AND NOT(WebBrowser1.busy) then begin
       WB_SaveAs_HTML(WebBrowser1,'test.html');
       //myStringList.loadFromFile('test.html');   //process it.
   end;
end; 
```

请注意，某些 MIME（“文件”）类型（例如 JSON）会在 IE 中提供“另存为...”对话框，这会停止您的阅读并需要手动干预。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:19:18.150

我认为这很容易，但似乎它可能已经被遗忘了。不过，您可以使用 TidHTTP 控件轻松完成此操作。

```
MyPage := IdHTTP1.Get('www.google.com'); 
```

我知道这不是您想要的，但可能会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T13:20:21.347

在 DocumentCompleted 事件中，查看`DocumentText`WebBrowser 控件的属性。它应该包含加载页面的完整文本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T13:21:32.763

```
IHTMLDocument2(Web.Document).Body.InnerHTML; 
```

这应该返回页面的源。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T17:13:24.710

另一种效果很好的方法是使用[Synapse](http://www.ararat.cz/synapse/doku.php)。使用突触调用 HttpGet 检索您的初始资源（它为您提供源代码），然后根据需要进行操作。

另一种选择是使用[EmbeddedWB](http://www.bsalsa.com/product.html)组件，它比标准的 Delphi 组件公开了更多的 Web 浏览器属性和功能，并且仍然符合您在 Web 浏览器中执行此操作的要求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-19T14:38:26.543

要通过 WebBrowser 控件访问页面的整个 HTML，请使用：

```
Web.Document.All[0].OutterHtml; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-11-19T14:36:31.080

```
private void btnTest_Click(object sender, EventArgs e)
        {
            wbMain.Navigate("foo.xml");
            wbMain.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(testing);
        }

        private void testing(Object sender, WebBrowserDocumentCompletedEventArgs e)
        {
            test = wbMain.DocumentText;
        } 
```

我知道这有点晚了，但这对我有用。wbMain 是 WebBrowser 对象。

# visual-studio-2008 - 如果缺少项目，如何阻止 Visual Studio 2008 显示对话框？

> ID：677308
> 
> 赞同：2
> 
> 时间：2009-03-24T13:07:59.877
> 
> 标签：visual-studio-2008

我从 NAnt 给 DevEnv 打电话，通常一切都很好。但是，我们偶尔会遇到开发人员添加了新项目并签入解决方案文件但忘记将新项目添加到源代码管理的问题。不知道如何，但它发生了。

在这种情况下，Visual Studio 会弹出一个带有 OK 按钮的对话框，提示它找不到项目文件。麻烦的是，这是在没有人关注的无头构建服务器上，我们唯一注意到的是构建将超时。

如果 DevEnv 然后退出失败，我会更喜欢它，NAnt 可以选择它并且会使构建失败，这是正确的行为。

有没有办法阻止 Visual Studio 这样做，或者作为替代方案，在启动 DevEnv 之前是否可以运行任何好的验证器来检查它是否很有可能不会因为愚蠢的对话框而崩溃？

我调用 DevEnv 的原因是我需要构建部署项目，而这样做的唯一方法（对我们可用）是使用 DevEnv。

解析度：

事实证明，我的构建脚本是显式调用 devenv.exe。这就是 Visual Studio 的 gui 形式。解决方案是删除调用的 .exe 部分，使命令处理更倾向于 .com 而非 .exe 版本。devenv.com 版本不显示对话框 - 它在命令行上爆炸而不是我想要的行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:16:09.640

您是否尝试过使用 Visual Studio 的命令行版本。如果项目不可用于命令行构建，该过程将显示错误消息但不会弹出任何 UI。

例子：

> devenv.com SomeSolution.sln /build

在我的机器上，对于缺少项目的解决方案，它将显示以下输出

> Microsoft (R) Visual Studio 版本 9.0.30729.1。版权所有 (C) Microsoft Corp. 保留所有权利。
> 
> 由于以下原因，无法加载解决方案中的一个或多个项目：
> 
> 项目文件或网站已被移动、重命名或不在您的计算机上。
> 
> 这些项目将在解决方案资源管理器中标记为不可用。展开项目节点以显示无法加载项目的原因。-------- 构建开始：项目：ConsoleApplication1，配置：调试任何 CPU ------ ConsoleApplication1 -> C:\Users\jaredpar \Documents\Visual Studio 2008\Projects\C onsoleApplication26\ConsoleApplication1\bin\Debug\ConsoleApplication1.exe ------ 构建开始：项目：WpfApplication1，配置：调试任何 CPU --- --- WpfApplication1 -> C： \Users\jaredpar\Documents\Visual Studio 2008\Projects\Conso leApplication26\WpfApplication1\bin\Debug\WpfApplication1.exe ========== 构建：2 成功或最新，0 失败，0跳过

# linux - 在bash中，如何使控制删除意味着杀戮？

> ID：677312
> 
> 赞同：3
> 
> 时间：2009-03-24T13:09:12.793
> 
> 标签：linux, bash, readline

Bash使用readline，readline可以用“kill-word”删除光标右边的单词。

问题在于识别控制删除的按键。当我在 bash 中按下它们时，屏幕上会输出“5~”。我*可以*为此绑定，但这意味着有一天我需要输入“5~”，它会删除右侧的一个单词！所以我更愿意发现正确的控制顺序。

我用谷歌搜索过，很多资源讨论了“删除”键，但我发现没有一个讨论“控制删除”键。我尝试了许多变化，但没有任何效果。

最糟糕的是我在这种乏味、无意识的磨练上花费了几个小时，而这真的不应该成为问题。

编辑：它是通过 X，所以也许有 xev 和 xmodmap 的解决方案

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-24T13:39:04.297

在我的机器上，按 Ctrl-V，Ctrl-Delete 输出：

```
^[[3;5~ 
```

转义字符可以用`^[`\e 替换，因此您可以像这样对 bash 使用 bind（在您`~/.bashrc`的示例中）：

```
bind '"\e[3;5~":kill-word' 
```

或者，您可以`~/.inputrc`在任何使用 readline 的程序中添加以下内容，以便 Ctrl-Delete 执行 kill-word：

```
"\e[3;5~": kill-word 
```

这将只绑定 Ctrl-Delete 键，您不必担心如果需要键入 5~ 会发生什么。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T13:19:58.757

你看到的并不是全部真相。它可能是`<ESC>5~`或类似的东西。试试 Ctrl-V Ctrl-Delete。Ctrl-V 的意思是“不解释下一件事”。

所以绑定`<ESC>5~`应该是相当安全的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-12T15:14:03.690

Alt+D 删除光标右侧的一个单词 Ctrl+W 删除光标左侧的一个单词（我相信都是基于 Emacs 的）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T13:17:21.463

如果你输入 ^Q^V（即 Control-Q 后跟 Control-V，松开它们之间的 Control 键就可以了），然后按下 Control-Delete，你会得到你提到的输出吗？我刚刚尝试过，至少使用腻子我根本没有得到回应。不过，实际 Linux 控制台上的行为可能有所不同。

对于其他键，readline 打印更长的序列，通常包括一个特殊的“命令序列介绍”字符，很难输入错误。试试看，看看您是否使用 ^Q^V 命令（顺便说一句，称为quoted-insert）获得更长的序列。

例如，如果我按 ^Q^V 然后按 Delete （不按住控件），readline 将打印`^[[3~`. 这告诉我，我可以通过说将内容绑定到 Delete 键`\e[[3~`。CSI 字符似乎很有可能出现在您面前，但您没有看到它，因为您没有要求 readline 正确引用输入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T15:21:15.987

Ctrl-W 删除单词。

Ctrl-u 删除行。

它们基于 Emacs（Mw 和 Mu）。

# c# - 为什么我会在 X509CertificateStore 上的 OpenRead 中获得 ExecutionEngineException？

> ID：677316
> 
> 赞同：1
> 
> 时间：2009-03-24T13:10:11.620
> 
> 标签：c#, certificate

我将 WebServicesClientProtocol 类与安全令牌一起使用，并使用以下代码查找要使用的安全令牌：

```
private static X509SecurityToken GetSecurityCertificate(string subject)
{
    X509CertificateStore localStore = X509CertificateStore.LocalMachineStore(X509CertificateStore.MyStore);
    X509SecurityToken securityToken = null;
    if (localStore.OpenRead())
    {
       X509CertificateCollection certificateCollection = localStore.FindCertificateBySubjectString(subject);
        if (certificateCollection.Count == 0) throw new Exception("Skilríki finnst ekki í skilríkjageymslu");
        securityToken = new X509SecurityToken((X509Certificate)certificateCollection[0]);
    }
    localStore.Close();
    return securityToken;
} 
```

时不时地（但并非总是如此，而且我无法确定确切的时间）我得到以下异常：

[替代文字 http://www1.ruedenet.is/files/exception.png](http://www1.ruedenet.is/files/exception.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-18T21:33:43.340

我今天遇到了这个问题，我相信我已经弄清楚是什么原因造成的。静态方法需要同步。

如果您在异常发生时将鼠标悬停在 localStore 变量上并检查 Certificates 属性，您很可能会看到“InvalidOperationException - 要访问您必须使用 Open() 或 OpenRead() 的证书......等等。呜呜呜”。

正在发生的事情是某个线程在另一个线程完成访问它之前关闭了存储。

我通过首先创建一个静态类成员来锁定存储解决了这个问题：

```
private static object m_storeLock = new object(); 
```

当您访问商店时，您必须执行以下操作：

```
public static X509Certificate FindCertificate(string certName) {
    X509CertificateStore store = null;            
    X509Certificate cert = null;

    lock (m_storeLock) {
        try {                    
            store = X509CertificateStore.LocalMachineStore(X509CertificateStore.MyStore);
            store.OpenRead();

            X509CertificateCollection col =
            (X509CertificateCollection)store.FindCertificateBySubjectString(certName);

            if (col.Count > 0) {      
                cert = col[0];
            }
        }
        catch {
        }
        finally {
            if (store != null) {
                store.Close();
            }
        }
    }                           

    if (cert == null) {
        throw new ArgumentException("Certificate not found!");
    }

    return cert;
} 
```

为了更加安全，您可能应该锁定局部变量“cert”，但这不是生产代码的家伙......：D~

# silverlight - 如何针对 Google Chrome 调试 Silverlight

> ID：677318
> 
> 赞同：10
> 
> 时间：2009-03-24T13:10:46.940
> 
> 标签：silverlight, debugging, google-chrome

有谁知道如何从 Visual Studio 调试在 Google Chrome 中运行的 Silverlight 2 应用程序？即使在确保[Chrome 是调试浏览器](https://stackoverflow.com/questions/59154/set-google-chrome-as-the-debugging-browser-in-visual-studio)之后，仍然没有命中断点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T13:23:39.857

您是否尝试过手动附加到 Chrome？工具 > 附加到进程？

Chrome 不受官方支持，但有一些黑客攻击。

[以这里](http://timheuer.com/blog/archive/2009/02/11/moonlight-and-silverlight-detection-google-chrome-user-agent.aspx)为例。Halo 的评论也可能会给你一些帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T16:24:22.933

您可以在本地主机上运行多个浏览器。1) 按 F5 运行调试。可能会打开 IE 或任何您的默认设置。F5 穿过断点，直到它被加载。让这个 IE 打开。2) 打开您的其他浏览器，将 localhost Url 复制到新浏览器中并运行它。新浏览器应该会遇到断点。

这适用于所有浏览器，甚至黑莓模拟器等模拟器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-01-24T21:15:46.070

手动附加到进程（工具 > 附加到进程），但确保附加到将其**类型**列为“Silverlight，...”的 chrome 进程。它的标题应该是空白的。

如果您在标题中看到您的应用程序名称，那是因为 chrome 对您的 Silverlight 应用程序所在的 HTML 表单有一个单独的进程，并且 html 的标题可能匹配。附加到此进程不会加载 Silverlight 程序集。

我通常会开始在 IE 中调试应用程序以确保最新的更改已编译并运行，然后启动 chrome，清除其缓存（因为它喜欢挂在 Silverlight 数据上），从 IE 中粘贴 url，然后停止 IE 并附加到 chrome。额外的步骤，但不值得花 3 个小时来弄清楚您正在查看缓存的程序集。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-09-19T13:53:21.160

这是 Visual Studio 与 Chrome 交互的问题：[http](http://code.google.com/p/chromium/issues/detail?id=45560) ://code.google.com/p/chromium/issues/detail?id=45560 。我的猜测是您需要等待 Visual Studio 补丁，但老实说，我不会屏住呼吸。大多数 Silverlight 开发人员只是使用 IE 或 FF 进行调试。（显然即使是 FF 也有一些问题，因为他们已经将他们的插件沙箱化了：http: [//timheuer.com/blog/archive/2010/08/16/enable-silverlight-debugging-in-firefox-visual-studio.aspx# 20476](http://timheuer.com/blog/archive/2010/08/16/enable-silverlight-debugging-in-firefox-visual-studio.aspx#20476) )。尽管我讨厌 IE，但它确实是调试 Silverlight 应用程序的最佳选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-09-19T13:55:46.580

只需将 SL app 设置为启动 prtoject 而不是 asp.net，然后按 F5

# c# - 确定画布中的 ListboxItem 位置？

> ID：677321
> 
> 赞同：4
> 
> 时间：2009-03-24T13:11:37.420
> 
> 标签：c#, wpf, xaml

在我的 WPF 应用程序中，我有一个带有列表框的画布。在单击项目后，我想用另一个控件覆盖 Listboxitem。但为此，我需要 Listboxitem 在画布中的位置。我看到了问题，因为单个 Item 不是画布的子项。只有列表框本身是。

有什么方法可以获取画布中 ListboxItem 的相对位置，或者可能是窗口内的绝对位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T14:43:42.723

试试这个代码：

```
Point p = listboxItem.TranslatePoint(new Point(0.0,0.0),Window.GetWindow(listboxItem)); 
```

为了使其相对于画布，请将新点替换为画布位置。

HTH。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:57:47.077

这不是您问题的直接答案，但我想知道 WPF 的[Adorner](http://msdn.microsoft.com/en-us/library/ms743737(VS.85).aspx)概念是否可以为您提供您想要的。

# c++ - C++ - 2 类 1 个文件

> ID：677325
> 
> 赞同：5
> 
> 时间：2009-03-24T13:13:49.537
> 
> 标签：c++

假设我想要这样的东西，在一个`.cpp`源文件中：

```
class A {
    public:
        void doSomething(B *b) {};
};

class B {
    public:
        void doSomething(A *a) {};
}; 
```

是否有这样做而不将其拆分为两个单独的文件，并且没有收到编译器错误（语法错误`doSomething(B *b)`）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-24T13:15:58.987

放在第一行：

```
class B; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-24T13:16:22.823

如果我没记错的话，您可以“预先声明”您的 B 类。

```
class B; // predeclaration of class B

class A
{
   public:
      void doSomething(B* b);
}

class B
{
    public
      void doSomething(A* a) {}
}

public void A::doSomething(B* b) {} 
```

然后，您的“A”类知道将存在“B”类，尽管它尚未真正定义。

正如 Evan Teran 在评论中提到的那样，前向声明确实是正确的术语。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-24T13:16:07.580

前向声明一个类在其他类之前

```
class B;
or
class A; 
```

但是您仍然无法实施

```
void doSomething(B *b) 
```

仅使用 B 的前向声明。因此您必须将 doSomething 的定义放在完整的 A 类声明之下

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T13:16:44.257

是的。你需要一个前向声明：

```
class B; // add this line before A's declaration

class A {
    public:
        void doSomething(B *b) {};
};

class B {
    public:
        void doSomething(A *a) {};
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-24T13:19:05.763

[C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/misc-technical-issues.html#faq-39.11)回答了这个问题和其他问题。我会认真考虑端到端地阅读那本书，或者拿到这本书并做同样的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T13:18:44.360

您可以尝试前向声明，例如

```
class B;
class A {
  void Method( B* );
};
class B{
}; 
```

但是你只能为 B 声明指针和引用变量。如果您想要更多（例如取消引用 B* 变量的方法），您可以仅提供声明并稍后在同一文件中定义方法 - 在两个类声明已经可用的位置。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T13:18:56.263

您需要转发声明 B。

```
class B; 

class A
{
public:        
   void doSomething(B *b) {}
};

class B 
{    
public:        
   void doSomething(A *a) {}
}; 
```

（顺便说一句，您不需要成员函数花括号后的分号。:)）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T13:20:57.587

在 A 之前添加另一个 B 声明：

```
class B;

class A {
    public:
        void doSomething(B *b) {};
};

class B {
    public:
        void doSomething(A *a) {};
}; 
```

# wpf - WPF Datagrid 的“按下删除键”事件是什么？

> ID：677326
> 
> 赞同：41
> 
> 时间：2009-03-24T13:14:31.813
> 
> 标签：wpf, datagrid

我想让用户**突出显示 WPF DataGrid 上的一行，然后按删除键**删除该行。

*   该功能已经**内置到**网格的 UI 中，因此对于用户来说，该行消失了
*   **我目前在SelectionChanged 事件**上处理这个（下面的代码）
*   我遍历所有“e.RemovedItems”并使用 LINQ 删除它们

**问题是：**即使您只是*选择*一行并将其移开，选择更改也会被触发，并且该行位于 e.RemovedItems 中（这很奇怪，为什么简单地选择某些东西会将其放入 RemovedItems 容器中？）。

所以我正在寻找一个**DeleteKeyPressed**事件，以便我可以简单地处理它。那个事件叫什么？

我正在使用 2009 年 3 月的工具包。

**XAML：**

```
<Grid DockPanel.Dock="Bottom">
    <toolkit:DataGrid x:Name="TheDataGrid" 
                      SelectionChanged="TheDataGrid_SelectionChanged"
                      AutoGenerateColumns="True"
                      RowEditEnding="TheDataGrid_RowEditEnding"/> 
```

**代码隐藏：**

```
private void TheDataGrid_SelectionChanged(object sender, System.Windows.Controls.SelectionChangedEventArgs e)
{
    if (e.RemovedItems.Count > 0)
    {
        Message.Text = "The following were removed: ";
        foreach (object obj in e.RemovedItems)
        {
            Customer customer = obj as Customer;
            Message.Text += customer.ContactName + ",";
            _db.Order_Details.DeleteAllOnSubmit(
                customer.Orders.SelectMany(o => o.Order_Details));
            _db.Orders.DeleteAllOnSubmit(customer.Orders);
            _db.Customers.DeleteOnSubmit(customer);
        } 
    }

    try
    {
        _db.SubmitChanges();
    }
    catch (Exception ex)
    {
        Message.Text = ex.Message;
    }
} 
```

* * *

# 回答：

感谢 lnferis，这正是我想要的，这是我完成的数据网格删除处理事件，请注意 KeyDown 事件由于某种原因不会触发。

**XAML：**

```
<toolkit:DataGrid x:Name="TheDataGrid" 
                  KeyDown="TheDataGrid_KeyDown"
                  PreviewKeyDown="TheDataGrid_PreviewKeyDown"
                  AutoGenerateColumns="True"
                  RowEditEnding="TheDataGrid_RowEditEnding"/> 
```

**代码隐藏**

```
private void TheDataGrid_PreviewKeyDown(object sender, KeyEventArgs e)
{
    if (e.Key == Key.Delete)
    {
        var grid = (DataGrid)sender;

        if (grid.SelectedItems.Count > 0)
        {
            string checkMessage = "The following will be removed: ";

            foreach (var row in grid.SelectedItems)
            {
                Customer customer = row as Customer;
                checkMessage += customer.ContactName + ",";
            }
            checkMessage = Regex.Replace(checkMessage, ",$", "");

            var result = MessageBox.Show(checkMessage, "Delete", MessageBoxButton.OKCancel);
            if (result == MessageBoxResult.OK)
            {
                foreach (var row in grid.SelectedItems)
                {
                    Customer customer = row as Customer;
                    _db.Order_Details.DeleteAllOnSubmit(
                        customer.Orders.SelectMany(o => o.Order_Details));
                    _db.Orders.DeleteAllOnSubmit(customer.Orders);
                    _db.Customers.DeleteOnSubmit(customer);
                }
                _db.SubmitChanges();
            }
            else
            {
                foreach (var row in grid.SelectedItems)
                {
                    Customer customer = row as Customer;
                    LoadData();
                    _db.Refresh(System.Data.Linq.RefreshMode.OverwriteCurrentValues, customer); //TODO: this doesn't refresh the datagrid like the other instance in this code
                }
            }
        }
    }
}

private void TheDataGrid_KeyDown(object sender, KeyEventArgs e)
{
    Console.WriteLine("never gets here for some reason");
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-24T13:24:41.180

这些`RemovedItems`项目反映了从选择中删除的项目，而不是从网格中删除的项目。

处理`PreviewKeyDown`事件，并使用该`SelectedItems`属性删除那里的选定行：

```
private void PreviewKeyDownHandler(object sender, KeyEventArgs e) {
    var grid = (DataGrid)sender;
    if ( Key.Delete == e.Key ) {
        foreach (var row in grid.SelectedItems) {
            ... // perform linq stuff to delete here
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-10-17T14:21:44.040

XAML

```
<DataGrid ItemsSource="{Binding}" CommandManager.PreviewCanExecute="Grid_PreviewCanExecute" /> 
```

背后的代码

```
private void Grid_PreviewCanExecute(object sender, CanExecuteRoutedEventArgs e)
{
  DataGrid grid = (DataGrid)sender;
  if (e.Command == DataGrid.DeleteCommand)
  {
    if (MessageBox.Show(String.Format("Would you like to delete {0}", (grid.SelectedItem as Person).FirstName), "Confirm Delete", MessageBoxButton.OKCancel) != MessageBoxResult.OK)
      e.Handled = true;
  }
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-24T13:56:50.760

您将 DataGrid 绑定到什么？理想情况下，您应该对要绑定的集合上的 CollectionChanged 事件做出反应。这样，您的逻辑（删除已删除项目）将与您的 UI 分离。

如果原始集合没有必要的事件，您可以构建一个包含您的对象的 Observable 集合并将其绑定到 ItemsSource。

它可能不适合您的特定设置，但我通常是这样做的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-24T12:45:46.167

请按照下面的代码。我已成功使用以下代码。

请让我知道是否需要更改。

```
 private void grdEmployee_PreviewKeyDown(object sender, KeyEventArgs e)
    {

        if (e.Device.Target.GetType().Name == "DataGridCell")
        {
            if (e.Key == Key.Delete)
            {
                MessageBoxResult res = MessageBox.Show("Are you sure want to delete?", "Confirmation!", MessageBoxButton.YesNo,MessageBoxImage.Question);
                e.Handled = (res == MessageBoxResult.No);
            }
        }
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-02T15:34:42.553

聚会有点晚了，但要让 Inferis 回答工作：

```
Dim isEditing = False
AddHandler dg.BeginningEdit, Sub() isEditing = True
AddHandler dg.RowEditEnding, Sub() isEditing = False
AddHandler dg.PreviewKeyDown, Sub(obj, ev) 
  If e.Key = Key.Delete AndAlso Not isEditing Then ... 
```

这修复了 epalms 评论：“如果您正在编辑单元格并使用删除键删除单元格中的某些字符，您最终将删除整行”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-09T08:11:55.650

最干净的解决方案是使用 PreviewCanExecute ，就像[Flux](https://stackoverflow.com/users/1523703/flux)回答的那样，这是一个完整的解决方案，可以让任何像我一样忽略他的答案的人更清楚：

```
private void Grid_PreviewCanExecute(object sender, CanExecuteRoutedEventArgs e)
{
    if (e.Command == DataGrid.DeleteCommand)
    {
        if (MessageBox.Show($"Delete something from something else?", "Confirm removal of something", MessageBoxButton.YesNo) == MessageBoxResult.Yes)
        {
            // Do what ever needs to be done when someone deletes the row
        }
        else
        {
            e.Handled = true;   
            // Handled means.. no worries, I took care of it.. and it will not delete the row
        }
    }
} 
```

在此之后无需连接到 CommandManager.Executed。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-24T13:20:19.397

您要处理 KeyUp 或 KeyDown 事件并检查按下的键是否删除。

```
private void OnKeyDown(object sender, KeyEventArgs e) {
  if ( Key.Delete == e.Key ) {
    // Delete pressed
  }
} 
```

# xml - MXML 是有效的 XML 吗？

> ID：677335
> 
> 赞同：1
> 
> 时间：2009-03-24T13:16:35.410
> 
> 标签：xml, mxml

我只是好奇，在 MXML 中，许多标签都是大写的（例如： < Label /> ）。我知道这是因为节点名称与节点所代表的类名有关，并且按照惯例，类是大写的。但是 XML 的规则之一是所有节点名称都是小写的。那么这是否意味着 MXML 是无效的 XML？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T13:19:13.767

*节点名称必须*小写不是 XML 的规则；这只是惯例。因此 MXML 作为 XML 仍然有效。

XML 是区分大小写的，所以`<Lable />`不是相同的元素类型`<lable />`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:34:33.027

XML 区分大小写，因此`<label/>`不等于`<Label/>`，但是两者都是有效的 XML。

# actionscript-3 - Actionscript 3.0 的跨域策略文件

> ID：677337
> 
> 赞同：0
> 
> 时间：2009-03-24T13:16:54.710
> 
> 标签：actionscript-3, sandbox

我需要从 Action Script 3.0 访问一个 ASP.Net2 页面，我在 .fla 文件中编写了访问 asp.net 页面的代码，但是在访问它时出现问题，它向我报告了以下错误：

打开 URL 时出错“ [http://localhost/Trial/Default.aspx](http://localhost/Trial/Default.aspx) ”错误 #2044：未处理的 ioError:。文本=错误 #2032：流错误。URL：[http://localhost/Trial/Default.aspx](http://localhost/Trial/Default.aspx) at Script1/sendSQLXML() at Script1$iinit()

经过搜索，我发现这是与跨域策略有关的问题，因此我创建了一个名为 Crossdomain.xml 的 XML 文件，其代码如下：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM
"http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">

<cross-domain-policy>
    <site-control permitted-cross-domain-policies="all"/>
    <allow-access-from domain="*" secure="false"/>
    <allow-http-request-headers-from domain="*" headers="*" secure="false"/>
</cross-domain-policy> 
```

而且我不知道如何从 ACS3 使用它以及将它放在哪里注意：我在 IIS 中运行 Asp.Net2 页面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T18:14:03.970

crossdomain.xml 被放置在您尝试访问的服务器的根目录中。这是默认位置，因此您无需调用 Security.loadPolicyFile()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:44:32.733

如果您在本地工作（[http://localhost/Tri..](http://localhost/Tri..)），我不确定问题是否来自一些跨域问题...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T03:04:58.237

通常，跨域文件放置在服务器的根目录下，如果您在本地运行，则不应该遇到跨域问题，但您可能想尝试将其放置在 c:\inetput\wwwroot\ 中，看看是否能解决您的问题.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T13:41:31.997

查看 loadPolicyFile(..) 方法： http://livedocs.adobe.com/flex/3/langref/flash/system/Security.html#loadPolicyFile( [)](http://livedocs.adobe.com/flex/3/langref/flash/system/Security.html#loadPolicyFile())

# html - 从 MVC 应用程序创建可打印字母的最佳方法是什么？

> ID：677360
> 
> 赞同：0
> 
> 时间：2009-03-24T13:20:04.560
> 
> 标签：html, asp.net-mvc, model-view-controller

从 MVC 应用程序创建可打印字母的最佳方法是什么？我正在从我的应用程序中寻找一种邮件合并的东西，它打印一个填有各种值的套用信函。

在 ASP.NET 中，我之前通过创建 HTML 文档并将其显示为 来`application/msword`做到这一点，但是我使用代码隐藏来做到这一点，这在 MVC 中不是一个（简单的）选项，我不知道这是否是最好的方法与否。

请注意，这是一个内部应用程序，因此可以假设每个人的计算机上都有 Word。话虽如此，绕过Word会很好，但我可以选择任何一种方式。越简单越好。欢迎任何想法/方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:25:41.847

由于这只是将 ContentType 设置为 application/msword 的 HTML，我看不出您想要使用代码隐藏的任何理由。

带有典型 HTML 模板的标准 MVC 视图`<%=...>`在需要插入视图数据的位置上添加了适当的内容，这似乎是明智的方法。即使你可能想要循环。

顺便说一句，为什么代码隐藏不是一个简单的选择？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:16:44.853

在您的控制器中：

```
return Content(contentGoesHere, "application/msword"); 
```

# c# - 在 C# 中生成随机值

> ID：677373
> 
> 赞同：33
> 
> 时间：2009-03-24T13:22:39.000
> 
> 标签：c#, random, long-integer, int64

如何使用`Random`C# 中的类生成随机 Int64 和 UInt64 值？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-03-24T13:27:41.593

这应该可以解决问题。（它是一种扩展方法，因此您可以像调用对象上的普通`Next`或`NextDouble`方法一样调用它`Random`）。

```
public static Int64 NextInt64(this Random rnd)
{
    var buffer = new byte[sizeof(Int64)];
    rnd.NextBytes(buffer);
    return BitConverter.ToInt64(buffer, 0);
} 
```

如果您想要无符号整数，只需替换`Int64`为任何地方，一切都应该正常工作。`UInt64`

**注意：**由于没有提供关于生成数字的安全性或所需随机性的上下文（实际上 OP 特别提到了`Random`该类），我的示例仅处理`Random`该类，这是随机性（通常量化为[信息熵](http://en.wikipedia.org/wiki/Information_entropy)）时的首选解决方案不是问题。有趣的是，请参阅提到的其他答案`RNGCryptoServiceProvider`（命名空间中提供的 RNG `System.Security`），它们的使用几乎相同。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-24T13:26:19.570

使用[`Random.NextBytes()`](http://msdn.microsoft.com/en-us/library/system.random.nextbytes.aspx)和[`BitConverter.ToInt64`](http://msdn.microsoft.com/en-us/library/system.bitconverter.toint64.aspx)/ [`BitConverter.ToUInt64`](http://msdn.microsoft.com/en-us/library/system.bitconverter.touint64.aspx)。

```
// Assume rng refers to an instance of System.Random
byte[] bytes = new byte[8];
rng.NextBytes(bytes);
long int64 = BitConverter.ToInt64(bytes, 0);
ulong uint64 = BitConverter.ToUInt64(bytes, 0); 
```

请注意，使用[`Random.Next()`](http://msdn.microsoft.com/en-us/library/9b3ta19y.aspx)两次，移动一个值，然后 ORing/adding 不起作用。`Random.Next()`仅产生非负整数，即它产生 31 位，而不是 32，因此两次调用的结果仅产生 62 位随机位，而不是覆盖`Int64`/的完整范围所需的 64 位`UInt64`。（[Guffa 的回答](https://stackoverflow.com/questions/677373/generate-random-values-in-c/677602#677602)显示了如何通过*三个*调用来做到这一点`Random.Next()`。）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-24T14:41:23.397

给你，这使用了**crytpo 服务** *（不是`Random`类）*，它（理论上）是比 Random 类更好的 RNG。您可以轻松地将其作为 Random 的扩展或创建自己的 Random 类，其中 RNGCryptoServiceProvider 是类级对象。

```
using System.Security.Cryptography;
public static Int64 NextInt64()
{
   var bytes = new byte[sizeof(Int64)];    
   RNGCryptoServiceProvider Gen = new RNGCryptoServiceProvider();
   Gen.GetBytes(bytes);    
   return BitConverter.ToInt64(bytes , 0);        
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-24T14:17:28.667

您可以使用位移将 31 位随机数组合成一个 64 位随机数，但您必须使用三个 31 位数字才能获得足够的位：

```
long r = rnd.Next();
r <<= 31;
r |= rnd.Next();
r <<= 31;
r |= rnd.Next(); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-24T13:47:35.757

我总是用它来获取我的随机种子（为简洁起见，删除了错误检查）：

```
m_randomURL = "https://www.random.org/cgi-bin/randnum?num=1&min=1&max=1000000000";
HttpWebRequest req = (HttpWebRequest)WebRequest.Create(m_randomURL);
StreamReader stIn = new StreamReader(req.GetResponse().GetResponseStream());
Random rand = new Random(Convert.ToInt32(stIn.ReadToEnd())); 
```

random.org 使用大气噪声来产生随机性，显然用于彩票等。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-24T13:36:57.157

你没有说你将如何使用这些随机数......请记住，由*Random*返回的值不是“加密安全的”，它们不应该用于涉及（大）秘密或（很多） 钱。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-24T13:28:27.787

您可以创建一个[`byte`](http://msdn.microsoft.com/en-us/library/5bdb6693.aspx)数组，用随机数据填充它，然后将其转换为[`long`](http://msdn.microsoft.com/en-us/library/ctetwysk.aspx)( `Int64`) 或[ulong](http://msdn.microsoft.com/en-us/library/t98873t4.aspx) ( `UInt64`)。

```
byte[] buffer = new byte[sizeof(Int64)];
Random random = new Random();

random.NextBytes(buffer);
long signed = BitConverter.ToInt64(buffer, 0);

random.NextBytes(buffer);
long unsigned = BitConverter.ToUInt64(buffer, 0); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-20T08:59:06.813

另一个答案，`RNGCryptoServiceProvider`而不是`Random`。在这里，您可以看到如何删除 MSB，因此结果始终为正。

```
public static Int64 NextInt64()
{
    var buffer = new byte[8];
    new RNGCryptoServiceProvider().GetBytes(buffer);
    return BitConverter.ToInt64(buffer, 0) & 0x7FFFFFFFFFFFFFFF;
} 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-03-27T17:29:29.897

```
Random r=new Random();
int j=r.next(1,23);
Console.WriteLine(j); 
```

# css - 打印时是否可以使用 CSS 更改表格的宽度？

> ID：677376
> 
> 赞同：2
> 
> 时间：2009-03-24T13:24:01.900
> 
> 标签：css, printing

我需要在使用打印页面时更改表格的宽度

```
<link rel="stylesheet" type="text/css" href="../css/reportPrint.css" media="print" /> 
```

从 CSS 文件打印时可以更改表格的宽度吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T13:26:56.463

您可以在打印时使用打印样式表设置额外的 CSS 属性，方法是添加到 head 元素中：

```
<link rel="stylesheet" href="print.css" type="text/css" media="print" /> 
```

然后在 print.css 文件中，设置您的附加/不同属性，例如：

```
table {
   width:80em;
} 
```

编辑：原始帖子在我发布后编辑之前有不可见的代码，所以我不知道这是否回答了你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-14T16:26:53.637

实际上，如果您想覆盖 HTML 标记中的内联 CSS。做这个：

```
#divShowTable {
    width:100%!important;
} 
```

# git - 使用 Git 跟踪 3rd 方代码

> ID：677393
> 
> 赞同：24
> 
> 时间：2009-03-24T13:28:04.730
> 
> 标签：git

我似乎无法理解我为跟踪外部代码而找到和研究的不同解决方案。更不用说了解如何将它们应用到我的用例中......

你们会不会很好地阐明这一点并帮助我解决我的具体用例？以下具体问题的最佳解决方案是什么？（我不会试图概括我的问题，因为我可能会对事情做出错误的假设，特别是因为我对这一切都很陌生......）

我正在用 Django（Python 中的 Web 框架）构建一个网站。现在，有很多 3rd 方插件可用于 Django（Django 称它们为“应用程序”），您可以将它们放入您的项目中。其中一些应用程序可能需要进行一些修改才能像我想要的那样工作。但是，如果您开始对 3rd 方代码进行修改，则会在出现较新版本时引入更新该代码的问题，同时保留您的本地修改。

所以，我在 Subversion 中这样做的方式是使用供应商分支。我的存储库布局如下所示：

```
/trunk
  ...
  /apps
    /blog-app
  ...
/tags
  ...
/branches
  ...
/vendor
  /django-apps
    /blog-app
      /1.2
      /1.3
      /current
    /other-app
      /3.2
      /current 
```

在这种情况下，/trunk/apps/blog-app 将被 svn 复制到 /vendor/django-apps/blog-app 中的标签之一。说是v1.2。我现在想将我在主干中的版本升级到 v1.3。如您所见，我已经将 /vendor/django-apps/blog-app/current（使用 svn_load_dirs）和“标记”（svn 复制）更新为 /vendor/django-apps/blog-app/1.3。现在我可以通过 svn 合并 /vendor/django-apps/blog-app/1.2 和 /vendor/django-apps/blog-app/1.3 在 /trunk/apps 上的更改来更新 /trunk/apps/blog-app /博客应用程序。这将保留我的本地更改。（对于不了解此过程的人，Subversion 手册中对此进行了描述：http: [//svnbook.red-bean.com/en/1.5/svn.advanced.vendorbr.html](http://svnbook.red-bean.com/en/1.5/svn.advanced.vendorbr.html)）

现在我想在 Git 中完成整个过程。我怎样才能做到这一点？

让我重申一下要求：

*   我必须能够将外部代码放置在树中的任意位置
*   我必须能够修改外部代码并将这些修改保留（提交）在我的 Git 存储库中
*   如果发布新版本，我必须能够轻松更新外部代码，同时保留我的更改

额外（用于奖励积分;-)）：

*   最好我想在没有 svn_load_dirs 之类的情况下执行此操作。我认为应该可以直接从他们的存储库中跟踪应用程序及其更新（大多数 3rd 方 Django 应用程序都保存在 Subversion 中）。让我能够查看版本之间的单个提交消息的额外好处。并且更容易修复合并冲突，因为我可以处理许多小提交，而不是由 svn_load_dirs 创建的一个人工提交。我认为有人会在 Subversion 中使用 svn:externals 来做到这一点，但我以前从未使用过它......

可以使用两种方法组合的解决方案会更可取，因为可能有应用程序开发人员不使用源代码控制或不公开他们的存储库。（意味着类似 svn_load_dirs 的行为和直接从 Subversion 存储库（或另一个 Git）跟踪）

我想我要么必须使用子树、子模块、变基、分支......或这些的组合，但如果我知道哪个（或）或如何处理它，请击倒我：S

我热切地等待着您的回复！回复时请尽可能详细，因为我已经很难理解网上找到的其他示例。

提前致谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-24T21:35:15.353

这里有两个不同的问题：

1.  您如何维护远程项目的本地分支，以及
2.  您如何在自己的树中保留远程项目的副本？

问题 1 本身就很简单。只需执行以下操作：

```
git clone git://example.com/foo.git
cd foo
git remote add upstream git://example.com/foo.git
git remote rm origin
git remote add origin ssh://.../my-forked-foo.git
git push origin 
```

然后，您可以正常处理您的分叉存储库。当您想合并上游更改时，请运行：

```
git pull upstream master 
```

至于问题 2，一种选择是使用子模块。为此， cd 进入您的主项目，然后运行：

```
git submodule add ssh://.../my-forked-foo.git local/path/for/foo 
```

**如果我使用 git 子模块，我需要知道什么？**

你可能会发现 git 子模块有时有点棘手。以下是一些需要注意的事项：

1.  始终在提交父模块之前提交子模块。
2.  总是在推送父模块之前推送子模块。
3.  在提交之前确保子模块的 HEAD 指向一个分支。（如果您是 bash 用户，我建议使用[git-completion](http://blog.bitfluent.com/post/27983389/git-utilities-you-cant-live-without)将当前分支名称放在提示符中。）
4.  *在切换分支或拉取更改后始终*运行“git submodule update”。

您可以使用我的一位同事创建的别名在一定程度上解决 (4)：

```
git config --global alias.pull-recursive '!git pull && git submodule update --init' 
```

...然后运行：

```
git pull-recursive 
```

**如果 git 子模块这么棘手，有什么好处呢？**

1.  您可以签出主项目而不签出子模块。当子模块很大并且您在某些平台上不需要它们时，这很有用。
2.  如果您有经验丰富的 git 用户，您的子模块可能有多个分支，并将它们与主项目的不同分支链接。
3.  有一天，有人可能会真正修复 git 子模块以更优雅地工作。子模块实现的最深部分实际上是相当不错的；损坏的只是上层工具。

**git 子模块不适合我。接下来是什么？**

如果您不想使用 git 子模块，您可能需要查看[git merge 的子树策略](http://www.kernel.org/pub/software/scm/git/docs/howto/using-merge-subtree.html)。这将所有内容都保存在一个存储库中。

**如果上游存储库使用 Subversion 怎么办？**

如果你知道如何使用 git svn，这很容易：

```
git svn clone -s https://example.com/foo
cd foo
git remote add origin ssh://.../my-forked-foo.git
git push origin 
```

然后在 git 中建立一个本地跟踪分支。

```
git push origin master:local-fork
git checkout -b local-fork origin/local-fork 
```

然后，要从上游合并，运行：

```
git svn fetch
git merge trunk 
```

（我没有测试过这段代码，但它或多或少是我们如何使用上游 SVN 存储库维护一个子模块的方式。）

不要使用 git svn rebase，因为这样会使得在父项目中使用 git submodule 而不丢失数据非常困难。只需将 Subversion 分支视为上游的只读镜像，并从它们显式合并。

如果您需要访问另一台机器上的上游 Subversion 存储库，请尝试：

```
git svn init -s https://example.com/foo
git svn fetch 
```

然后，您应该能够像以前一样合并来自上游的更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T16:06:21.203

我环顾四周，偶然发现了[Braid](http://wiki.github.com/evilchelu/braid)。它是一个在 Git 中自动化供应商分支的工具。它可以使用 Git 或 SVN 存储库。

通过爬取源码，我发现它使用了子树策略。而且似乎使它变得非常简单！另外，它似乎满足了我的所有要求！

在我开始使用它之前：这里有人对 Braid 有任何经验吗？如果有的话，我想了解可能的缺点。另外，如果你没有使用过 Braid，但在 Git 方面有一定的专业知识，第一眼你会怎么看？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T13:31:56.873

我使用 git 子模块来跟踪我的 Django 项目中的可重用应用程序，但从长远来看它有点混乱。

部署很混乱，因为您无法使用 git archive 获得整个树（带有子模块）的干净存档。有一些技巧，但没有完美的。此外，子模块更新机制不适合与子模块分支一起使用。

您可能需要查看 virtualenv 和 pip，因为它们最近进行了一些改进，以便与外部存储库一起使用。

pip：[http](http://pip.openplans.org/) ://pip.openplans.org/ 并使用 pip/virtualenv：[http ://www.b-list.org/weblog/2008/dec/15/pip/](http://www.b-list.org/weblog/2008/dec/15/pip/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-26T21:08:00.667

我认为我对另一个问题的回答为这里描述的问题提供了一个很好的解决方案，而无需进入子模块的地狱（我已经尝试过，但甚至没有接近我习惯的 svn:externals）

不过，看看这个答案： [您是对单个应用程序或整个项目进行版本控制，还是两者兼而有之？](https://stackoverflow.com/questions/967817/do-you-version-control-the-invidual-apps-or-the-whole-project-or-both/18429335#18429335)

在再次删除我的答案之前，我不知道我无法将自己的答案复制到另一个问题，即使我确信它作为答案很有用。抱歉，请尝试一下这个答案，这确实是一个不错的解决方案。所以我希望我被允许引用我自己的分析器来解决另一个问题。

# python - 如何检查 RGB 图像是否只包含一种颜色？

> ID：677395
> 
> 赞同：5
> 
> 时间：2009-03-24T13:28:34.103
> 
> 标签：python, image, colors, python-imaging-library

我正在使用 Python 和 PIL。

我有 RGB 图像，我想知道那些只包含一种颜色（例如 #FF0000）或一些非常接近的颜色（#FF0000 和 #FF0001）的图像。

我正在考虑使用直方图，但很难用 3 个色带找出一些东西，所以我正在寻找一种更聪明的算法。

有任何想法吗？

> ImageStat 模块就是答案！谢谢亚伦。我使用 ImageStat.var 来获取方差，并且效果很好。

这是我的一段代码：

```
from PIL import Image, ImageStat

MONOCHROMATIC_MAX_VARIANCE = 0.005

def is_monochromatic_image(src):
    v = ImageStat.Stat(Image.open(src)).var
    return reduce(lambda x, y: x and y < MONOCHROMATIC_MAX_VARIANCE, v, True) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T14:03:28.870

试试[ImageStat 模块](http://www.pythonware.com/library/pil/handbook/imagestat.htm)。如果返回的值`extrema`相同，则图像中只有一种颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T13:41:58.813

首先，您应该定义两种颜色之间的距离。然后您只需验证每个像素与您的颜色的距离是否足够小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:09:00.043

这是您可以使用的一个小片段：

```
 import Image

im = Image.open("path_to_image")
width,height = im.size

for w in range(0,width):
  for h in range(0,height):
     # this will hold the value of all the channels
     color_tuple = im.getpixel((w,h))
     # do something with the colors here 
```

也许使用散列并将元组存储为键并将其出现次数作为值？

# forms - 如何编辑要以交互方式选择的 VBA 表单中的记录？

> ID：677396
> 
> 赞同：2
> 
> 时间：2009-03-24T13:28:35.883
> 
> 标签：forms, ms-access, vba, editing

我在 MS Access 2003 数据库中有一组组合框，它们都绑定到单个表中的字段。但是，它们允许您选择的数据并非来自该表，而是来自其他各种表。这适用于记录创建故事，但现在我希望能够追溯编辑记录。问题是我不知道如何在不编写一堆自定义代码的情况下重新填充表单元素。

我最初的想法是提供一个组合框，将您的选择限制为记录 ID，然后进行自定义查询并使用它来设置所有不同表单元素中的选定值。但是，我觉得我应该能够做一些简单的事情，`DoCmd.GoToRecord , , , ID`并且表单应该重新填充就好了。我并不反对从事繁重的工作，但我确信我只是在我对 VBA 和 Access 的相对微不足道的知识中遗漏了一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T03:45:57.583

只是为了增加组合，我会提供两种方法，一种推荐，另一种不推荐。

方法 1：如果您已将表单绑定到整个数据表（这是不推荐的方法），您可以使用组合框向导导航到请求的记录，但我不会在最近的版本中推荐它使用权：

一个。它不允许您在创建代码之前正确命名组合框。

湾。代码是错误的。

这是我刚刚在我的测试数据库中生成的代码：

```
Dim rs As Object

Set rs = Me.Recordset.Clone
rs.FindFirst "[InventoryID] = " & Str(Nz(Me![Combo2], 0))
If Not rs.EOF Then Me.Bookmark = rs.Bookmark 
```

这在很多方面都是错误的，这非常了不起。代码应该是这样的：

```
With Me.RecordsetClone
  .FindFirst "[ID]=" & Me!cmbMyComboBox
  If Not .NoMatch Then
     If Me.Dirty Then Me.Dirty = False
     Me.Bookmark = .Bookmark
  Else
     MsgBox "Not Found!"
  End If
End With 
```

当 RecordsetClone 已经存在时，不需要克隆表单的记录集。

当您可以直接使用预先存在的对象时，没有理由使用对象变量。

在离开记录之前需要检查脏记录，因为如果您不强制保存，保存过程中的错误可能会导致数据丢失。

但更好的方法是：

方法 2：使用组合框更改表单的基础记录源。

组合框的 AfterUpdate 事件如下所示：

```
If Not IsNull(Me!cmbMyComboBox) Then
   Me.Recordsource = Me.Recordsource & " WHERE [ID]=" & Me!cmbMyComboBox
End If 
```

现在，这只适用于第一次，因为在 Recordsource 的第二次重置时，您最终会得到两个 WHERE 子句，这并不好。有两种方法：

一个。假设表单在没有 WHERE 子句的情况下打开，将打开的记录源值存储在表单的 OnLoad 事件中的模块级变量中：

```
 Private Sub Form_Load()
     strRecordsource = Left(Me.Recordsource,Len(Me.Recordsource)-1)
   End Sub 
```

在模块级别，相应地定义 strRecordsource：

```
 Dim strRecordsource As String 
```

然后在组合框的 AfterUpdate 事件中，改为：

```
 Me.Recordsource = strRecordsource & " WHERE [ID]=" & Me!cmbMyComboBox 
```

现在，如果您的表单打开时已经定义了 WHERE 子句，它会变得更加复杂，但我不会深入讨论，而是将它作为练习留给读者，最好的方法可能是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T14:51:26.150

我假设您已经为每个组合框设置了行源。只要您没有将组合框限制在该列表中；它应该显示您在该列中存储的内容。

但是，如果您的 Combo Box 更改其每一行的列表，您可以在记录的 OnCurrent 事件或字段的 GotFocus 事件中执行以下操作：

```
Me.combo_box_name.Requery 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:51:47.150

重新阅读您的问题后，我想我看到了您想要实现的目标。`GotoRecord`尽管我可能会在这种情况下使用 ，但您在正确的轨道上`OpenForm`，因为它具有`WhereCondition`允许您使用 SQL 来准确指定要打开的记录的属性。听起来您想在表单中实现“跳转到记录”类型的功能，其中用户从列表中选择记录 ID，并且表单会更改以显示所选记录。

一种可能性是每次用户在 ComboBox 中选择一个项目时切换到新记录。您可以在 ComboBox 的`Click`事件中处理此问题。

我将使用一个简单的示例：假设您有一个`Students`表，以及一个`StudentForm`用于查看/编辑表中记录的`Students`表。有一个通过它的属性绑定到列的`StudentForm`ComboBox 。当您在 ComboBox 中选择一个学生 ID 时，将切换到显示相应的学生记录。`cboStudentID``Students.ID``RowSource``StudentsForm`

在`Click`ComboBox 的事件处理程序中，您可以使用如下代码编写此“跳转到记录”功能：

```
Private Sub cboStudentID_Click() 
    Dim recordID As Long
    'The ItemData property will return the value of the bound'
    'column at the specified index.'
    recordID = cboStudentID.ItemData(cboStudentID.ListIndex)
    'Jump to the record. This assumes we want to use the same form.'
    'You can change the form name if you want to open a different form when'
    'the user selects an ID from the ComboBox.'
    DoCmd.OpenForm "StudentForm", WhereCondition:="Student.ID=" & recordID
End Sub 
```

正如 David W. Fenton 在评论中指出的那样，您可以缩短以下行：

```
recordID = cboStudentID.ItemData(cboStudentID.ListIndex) 
```

对此：

```
recordID = Me!cboStudentID 
```

要不就：

```
recordID = cboStudentID 
```

因为在这种情况下 ComboBox 的默认值将是当前绑定列的值`ListIndex`。在这种情况下，您可以完全删除`recordID`并将事件编码`Click`如下：

```
Private Sub cboStudentID_Click() 
    DoCmd.OpenForm "StudentForm", WhereCondition:="Student.ID=" & cboStudentID
End Sub 
```

# html - css 和图像精灵

> ID：677399
> 
> 赞同：4
> 
> 时间：2009-03-24T13:30:12.367
> 
> 标签：html, css, http, image, css-sprites

我有一个关于 css 中精灵的快速问题：如果我在 css 文件中包含两次相同的图像，我会发送两个 HTTP 请求吗？例如，如果我想从同一个图标集图像中加载两个不同的按钮：

```
.btn-1 {
    background:url('img/icons.png') 0 0;
}

.btn-2 {
    background:url('img/icons.png') 0 -60px;
} 
```

还是有另一种方法只包含一次图像？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T13:32:00.367

浏览器将缓存图像，以便第二次从缓存中获取。

但是在这种情况下你想做的就是让 CSS 完成它的工作。
如果这些按钮是`<a>`例如。

```
a {
    background: url('img/icons.png');
}

.btn-1 {
    background-position:0 0;
}

.btn-2 {
    background-position: 0 -60px;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T13:34:59.267

除了 Ólafur 所说的之外，您还可以重写您的 CSS，使 URI 引用只会出现一次：

```
.btn-1,
.btn-2 {
    background:url('img/icons.png') 0 0;
}
.btn-2 {
    background-position: 0 -60px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T13:33:00.130

是，但客户端应该收到 HTTP 304

> 304 Not Modified 如果客户端执行了条件 GET 请求并且允许访问，但文档没有被修改，服务器应该用这个状态码响应。304 响应不能包含消息体，因此总是由头字段之后的第一个空行终止。

所以图像不会被发送两次，而是从缓存中使用。

[HTTP/1.1：状态码定义](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3.5)

# c# - 在 C# 和 ASP.NET 中进行跟踪对性能有何影响？

> ID：677411
> 
> 赞同：12
> 
> 时间：2009-03-24T13:32:17.683
> 
> 标签：c#, asp.net, performance, httpcontext, trace

我在最近查看的一些生产登录代码中发现了这一点......

```
HttpContext.Current.Trace.Write(query + ": " + username + ", " + password)); 
```

...where query 是一个简短的 SQL 查询，用于获取匹配的用户。这对性能有任何影响吗？我认为它非常小。

此外，使用 HTTP 上下文的这种确切类型的跟踪的目的是什么？这些数据追踪到哪里？提前致谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-24T13:34:56.413

是的，只要在构建期间定义了 TRACE 条件编译常量，它就会对性能产生影响。做任何事情都会产生某种影响:)

至于这是否对应用程序有重大影响。Trace 被设计为运行并在许多生产应用程序中运行，因此不太可能发生这种情况。只有滥用该功能才会导致明显的性能差异。

但一如既往，不要相信我，相信探查器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-07T12:01:24.133

我还没有评论的声誉点，但我想就乔纳森的回答做一个简短的陈述。我所看到的数字似乎表明，仅将 stringbuilder 用于少数字符串连接是没有意义的。创建 stringbuilder 对象的开销超过了连接速度的好处。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T13:35:14.447

跟踪消息可以发送到很多不同的地方。您可以为控制台、VisualStudio 调试窗口、文件或事件日志添加（或删除）TraceListeners 等等。你甚至可以建立自己的。

此外，您可以将 Trace 配置为在为 Release 编译时不执行任何操作。

因此，使用 Trace 对性能的影响可能会有很大差异，从零到完全使您的应用程序陷入困境，具体取决于哪些侦听器处于活动状态。但是，大多数听众都对您期望的影响有所了解。写入文件、数据库或控制台需要做大量工作，并且相对于那些 I/O 绑定活动而言，Trace 不会增加那么多开销。

* * *

不过，抛开性能影响不谈，我对跟踪密码值的想法感到**非常恐惧**。那是你绝对不能做的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T13:42:52.290

这段代码中最大的性能损失不是在跟踪中，而是在通过使用 + 运算符进行的字符串连接中。这会执行一些低效的内存操作，在性能方面可以击败 IO 操作。我会将其更改为使用类似 string.Concat 或 StringBuilder 类（或 string.Format ）之类的东西。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-21T15:16:58.410

“跟踪增加了请求的额外开销，不应为已部署的应用程序启用。但是，可以保留 Trace.Write() 语句，因为在未启用跟踪时它们会被忽略。”

[http://msdn.microsoft.com/en-us/library/ms972204.aspx](http://msdn.microsoft.com/en-us/library/ms972204.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T13:53:17.290

如果跟踪正在写入文本文件，它将比写入控制台恕我直言

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-04-21T13:20:50.183

我猜 Trace Source 在将消息转发给侦听器之前会查看其交换机的 TraceLevel。因此，如果我们将开关的默认 TraceLevel 值保持为“Error”，那么跟踪开销将大大减少，因为只有“Error”跟踪将被发送到侦听器。

只是一个猜测......我还没有测量任何东西。如果我这样做会更新。

**2017 更新**：似乎是一种已弃用但非常方便的方式来跟踪/记录信息到浏览器/在 asp.net 应用程序中可远程访问的 .aspx 页面。

[https://msdn.microsoft.com/en-IN/library/z48bew18(v=vs.71).aspx](https://msdn.microsoft.com/en-IN/library/z48bew18(v=vs.71).aspx)

# c# - WPF问题：需要在另一个之上绘制一个控件

> ID：677414
> 
> 赞同：4
> 
> 时间：2009-03-24T13:34:01.487
> 
> 标签：c#, wpf, xaml, layout

我有一个由页眉、主要内容和页脚构成的外壳窗口。主要内容是一个选项卡控件。根据设计，其中一个选项卡项内容（用户控件）需要在页脚上方稍微扩展一点。起初我考虑使用负边距来实现这一点，但无论我做什么，页脚总是被绘制在我的内容之上。

例如，考虑以下 xaml：

```
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition Height="33*"/>
    <RowDefinition Height="33*"/>
    <RowDefinition Height="33*"/>
  </Grid.RowDefinitions>
  <StackPanel Background="Blue" Grid.Row="0"/> <!-- Header -->
  <StackPanel Background="Red" Grid.Row="2"/>  <!-- Footer -->
  <TabControl Grid.Row="1"  > <!-- Content -->
    <TabItem>
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="33*"/>
          <ColumnDefinition Width="33*"/>
          <ColumnDefinition Width="33*"/>
        </Grid.ColumnDefinitions>
        <StackPanel Grid.Column="1" Background="Yellow" >
          <Button Width="100" Height="50" Content="Text"  />
        </StackPanel>
      </Grid>
  </TabItem>
</TabControl> 
```

我想要实现的是使黄色 StackPanel 以某种方式到达屏幕底部，重叠在红色页脚的顶部。

希望可以理解。谢谢爱丽儿

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T13:36:38.000

试试这个代码示例：

```
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition Height="33*"/>
    <RowDefinition Height="33*"/>
    <RowDefinition Height="33*"/>
  </Grid.RowDefinitions>
   <Grid.ColumnDefinitions>
     <ColumnDefinition Width="33*"/>
     <ColumnDefinition Width="33*"/>
     <ColumnDefinition Width="33*"/>
   </Grid.ColumnDefinitions>      
  <StackPanel Grid.ColumnSpan="3" Background="Blue" Grid.Row="0"/> <!-- Header -->
  <StackPanel Grid.ColumnSpan="3" Background="Red" Grid.Row="2"/>  <!-- Footer -->
  <TabControl Grid.ColumnSpan="3" Grid.Row="1"> <!-- Content -->
    <TabItem>
      <Grid>
          <Button Width="100" Grid.Column="1" Height="50" Content="Text"  />          
      </Grid>
    </TabItem>
  </TabControl>
    <StackPanel Grid.Column="1" Grid.Row="3" Background="Yellow" />
</Grid> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T13:45:23.487

问题是您希望堆栈面板包含在选项卡控件中，但您希望它超出选项卡控件的底部。选项卡控件不支持此功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T14:13:17.770

毫无疑问 TabControl 是问题所在。也许尝试编写自己的 TabControl。

干杯。

# c# - ASP.NET：GridView pageEventValidation 问题

> ID：677417
> 
> 赞同：1
> 
> 时间：2009-03-24T13:34:36.257
> 
> 标签：c#, asp.net

在以下代码中：

查询列表.ascx：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="EnquiryList.ascx.cs" Inherits="includes_EnquiryList"%>
<div class="EnquiryForm" runat="server">

    <asp:GridView ID="gridMain" 
        runat="server" 
        PageSize="20"
        Width="390"
        GridLines="None" 
        CssClass="gridview" 
        AllowPaging="True"
        AllowSorting="True" 
        CellPadding="0" 
        AutoGenerateColumns="False"
        OnPageIndexChanging="gridMain_PageIndexChanging"
        OnRowCommand="gridMain_RowCommand"
        DataSourceID="ldsGridMain">

        <Columns>

             <asp:TemplateField>
                <ItemTemplate>

                    <%# Eval("Id") %>
                    <asp:Button Text="Bekräfta" ID="apa" runat="server" CommandArgument='<%# Eval("Id") %>' CommandName="Buy" class="enquiryBtn"/>

                </ItemTemplate>
             </asp:TemplateField>

        </Columns>

    </asp:GridView>

    <asp:LinqDataSource ID="ldsGridMain" runat="server" OnSelecting="ldsGridMain_Selecting" OnSelected="ldsGridMain_Selected"/>

</div> 
```

查询列表.ascx.cs：

```
using System;
using System.Web.UI.WebControls;
using System.Web.UI;
using Offerta.Presentation;
using System.Collections;
using System.Collections.Generic;
using System.Linq;

public partial class includes_EnquiryList : System.Web.UI.UserControl
{

    protected Boolean IsAuthenticatedSupplier { get; set; }

    protected Boolean ShowSimilarEnquiriesLink { get; set; }

    protected int totalRows = 0;

    protected LinqDataSourceSelectEventArgs selectArgs;

    protected Supplier supplier;

    protected IQueryable<Enquiry> enquiries;

    protected string errorMessage;

    protected void Page_Load(object sender, EventArgs e)
    {
        IsAuthenticatedSupplier = false;
        Auth auth = new Auth();
        if (auth.IsAuthenticated)
        {
            IsAuthenticatedSupplier = auth.ClientTypeId == ClientMethods.CLIENT_TYPE_SUPPLIER;
            if (IsAuthenticatedSupplier)
            {
                supplier = (Supplier)auth.Client;
            }
        }
    }

    public void Bind(IQueryable<Enquiry> enquiries)
    {
        this.enquiries = enquiries;
        gridMain.DataBind();
    }

    protected void ldsGridMain_Selecting(object sender, LinqDataSourceSelectEventArgs e)
    {
        selectArgs = e;
        e.Result = (new EnquiryListController()).List(enquiries, supplier);
    }

    protected void ldsGridMain_Selected(object sender, LinqDataSourceStatusEventArgs e)
    {
        totalRows = selectArgs.Arguments.TotalRowCount;
    }

    protected void gridMain_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        gridMain.PageIndex = e.NewPageIndex;
        gridMain.DataBind();
    }

    protected void gridMain_RowCommand(object sender, GridViewCommandEventArgs e)
    {
    //never gets here?
    switch (e.CommandName.ToString())
        {
            case "Buy":
                PurchaseEnquiry(e.CommandArgument.ToString());
                break;
        }
    }

    protected void PurchaseEnquiry(string enquiryId)
    {
        try
        {
            Enquiry enquiry = EnquiryMethods.Get(new Guid(enquiryId));
            Order order = OrderMethods.Purchase(supplier, enquiry);
            Response.Redirect((new UrlFactory()).GetSupplierEnquiryMessageUrl(order.Id.ToString()), true);
        }
        catch (Exception e)
        {
            errorMessage = e.Message;        
        }
    }

} 
```

在SupplierInbox.aspx.cs（SupplierInbox.aspx基本上只包含一个EnquiryList和html）

```
using System;

public partial class SupplierInbox : System.Web.UI.Page
{

    protected void Page_Load(object sender, EventArgs e)
    {
        (new Auth()).RequireClientOfType(ClientMethods.CLIENT_TYPE_SUPPLIER);
        ucEnquiryList.Bind(EnquiryMethods.BuildQuery(new EnquiryQuery()));
    }

} 
```

在 GridView 中按下按钮时，我不断收到

> 无效的回发或回调参数。使用配置或页面中的 <%@ Page EnableEventValidation="true" %> 启用事件验证。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用 ClientScriptManager.RegisterForEventValidation 方法注册回发或回调数据以进行验证。

如果我禁用 EventValidation，当我按下按钮时不会发生任何事情，即永远不会调用 gridMain_RowCommand。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:46:12.487

通过添加解决 if(!IsPostBack) ucEnquiryList.Bind(EnquiryMethods.BuildQuery(new EnquiryQuery()));

# php - 如何使用 php 检测搜索引擎机器人？

> ID：677419
> 
> 赞同：141
> 
> 时间：2009-03-24T13:34:40.673
> 
> 标签：php, web-crawler, bots

如何使用 php 检测搜索引擎机器人？

* * *

## 回答 #1

> 赞同：261
> 
> 时间：2013-02-24T01:52:36.010

我使用以下似乎工作正常的代码：

```
function _bot_detected() {

  return (
    isset($_SERVER['HTTP_USER_AGENT'])
    && preg_match('/bot|crawl|slurp|spider|mediapartners/i', $_SERVER['HTTP_USER_AGENT'])
  );
} 
```

更新 16-06-2017 [https://support.google.com/webmasters/answer/1061943?hl=en](https://support.google.com/webmasters/answer/1061943?hl=en)

添加了**媒体合作伙伴**

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2009-03-24T13:37:21.897

这是[蜘蛛名称的搜索引擎目录](http://www.searchenginedictionary.com/spider-names.shtml)

然后你`$_SERVER['HTTP_USER_AGENT'];`用来检查代理是否是蜘蛛。

```
if(strstr(strtolower($_SERVER['HTTP_USER_AGENT']), "googlebot"))
{
    // what to do
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-24T13:37:42.443

检查`$_SERVER['HTTP_USER_AGENT']`此处列出的一些字符串：

[http://www.useragentstring.com/pages/useragentstring.php](http://www.useragentstring.com/pages/useragentstring.php)

或者更具体地说，对于爬虫：

[http://www.useragentstring.com/pages/useragentstring.php?typ=Crawler](http://www.useragentstring.com/pages/useragentstring.php?typ=Crawler)

如果您想记录最常见的搜索引擎爬虫的访问次数，您可以使用

```
$interestingCrawlers = array( 'google', 'yahoo' );
$pattern = '/(' . implode('|', $interestingCrawlers) .')/';
$matches = array();
$numMatches = preg_match($pattern, strtolower($_SERVER['HTTP_USER_AGENT']), $matches, 'i');
if($numMatches > 0) // Found a match
{
  // $matches[1] contains an array of all text matches to either 'google' or 'yahoo'
} 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-07-18T00:53:22.130

您可以检查它是否是具有此功能的搜索引擎：

```
<?php
function crawlerDetect($USER_AGENT)
{
$crawlers = array(
'Google' => 'Google',
'MSN' => 'msnbot',
      'Rambler' => 'Rambler',
      'Yahoo' => 'Yahoo',
      'AbachoBOT' => 'AbachoBOT',
      'accoona' => 'Accoona',
      'AcoiRobot' => 'AcoiRobot',
      'ASPSeek' => 'ASPSeek',
      'CrocCrawler' => 'CrocCrawler',
      'Dumbot' => 'Dumbot',
      'FAST-WebCrawler' => 'FAST-WebCrawler',
      'GeonaBot' => 'GeonaBot',
      'Gigabot' => 'Gigabot',
      'Lycos spider' => 'Lycos',
      'MSRBOT' => 'MSRBOT',
      'Altavista robot' => 'Scooter',
      'AltaVista robot' => 'Altavista',
      'ID-Search Bot' => 'IDBot',
      'eStyle Bot' => 'eStyle',
      'Scrubby robot' => 'Scrubby',
      'Facebook' => 'facebookexternalhit',
  );
  // to get crawlers string used in function uncomment it
  // it is better to save it in string than use implode every time
  // global $crawlers
   $crawlers_agents = implode('|',$crawlers);
  if (strpos($crawlers_agents, $USER_AGENT) === false)
      return false;
    else {
    return TRUE;
    }
}
?> 
```

然后你可以像这样使用它：

```
<?php $USER_AGENT = $_SERVER['HTTP_USER_AGENT'];
  if(crawlerDetect($USER_AGENT)) return "no need to lang redirection";?> 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2017-04-15T19:42:59.170

我用它来检测机器人：

```
if (preg_match('/bot|crawl|curl|dataprovider|search|get|spider|find|java|majesticsEO|google|yahoo|teoma|contaxe|yandex|libwww-perl|facebookexternalhit/i', $_SERVER['HTTP_USER_AGENT'])) {
    // is bot
} 
```

此外，我使用白名单来阻止不需要的机器人：

```
if (preg_match('/apple|baidu|bingbot|facebookexternalhit|googlebot|-google|ia_archiver|msnbot|naverbot|pingdom|seznambot|slurp|teoma|twitter|yandex|yeti/i', $_SERVER['HTTP_USER_AGENT'])) {
    // allowed bot
} 
```

然后，不需要的机器人（= 误报用户）能够解决验证码以在 24 小时内解锁自己。由于没有人解决这个验证码，我知道它不会产生误报。所以机器人检测似乎工作得很好。

注意：我的白名单基于[Facebook 的 robots.txt](https://www.facebook.com/robots.txt)。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2015-04-05T13:48:55.687

因为任何客户端都可以将用户代理设置为他们想要的，所以寻找“Googlebot”、“bingbot”等只是工作的一半。

第二部分是验证客户端的 IP。在过去，这需要维护 IP 列表。您在网上找到的所有列表都已过时。[正如 Google https://support.google.com/webmasters/answer/80553](https://support.google.com/webmasters/answer/80553)和 Bing [http://www.bing.com/webmaster/help/how-to-verify](http://www.bing.com/webmaster/help/how-to-verify-bingbot-3905dc26)所解释的，顶级搜索引擎正式支持通过 DNS 进行验证[-bingbot-3905dc26](http://www.bing.com/webmaster/help/how-to-verify-bingbot-3905dc26)

首先执行客户端 IP 的反向 DNS 查找。对于 Google，这会在 googlebot.com 下带来一个主机名，对于 Bing，它在 search.msn.com 下。然后，因为有人可以在他的 IP 上设置这样的反向 DNS，所以您需要通过对该主机名的正向 DNS 查找进行验证。如果生成的 IP 与网站访问者的 IP 相同，则可以确定它是来自该搜索引擎的爬虫。

我已经用 Java 编写了一个库来为您执行这些检查。随意将其移植到 PHP。它在 GitHub 上：[https ://github.com/optimaize/webcrawler-verifier](https://github.com/optimaize/webcrawler-verifier)

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2018-02-02T06:50:40.323

我使用这个函数......正则表达式的一部分来自 prestashop，但我添加了一些更多的机器人。

```
 public function isBot()
{
    $bot_regex = '/BotLink|bingbot|AhrefsBot|ahoy|AlkalineBOT|anthill|appie|arale|araneo|AraybOt|ariadne|arks|ATN_Worldwide|Atomz|bbot|Bjaaland|Ukonline|borg\-bot\/0\.9|boxseabot|bspider|calif|christcrawler|CMC\/0\.01|combine|confuzzledbot|CoolBot|cosmos|Internet Cruiser Robot|cusco|cyberspyder|cydralspider|desertrealm, desert realm|digger|DIIbot|grabber|downloadexpress|DragonBot|dwcp|ecollector|ebiness|elfinbot|esculapio|esther|fastcrawler|FDSE|FELIX IDE|ESI|fido|H�m�h�kki|KIT\-Fireball|fouineur|Freecrawl|gammaSpider|gazz|gcreep|golem|googlebot|griffon|Gromit|gulliver|gulper|hambot|havIndex|hotwired|htdig|iajabot|INGRID\/0\.1|Informant|InfoSpiders|inspectorwww|irobot|Iron33|JBot|jcrawler|Teoma|Jeeves|jobo|image\.kapsi\.net|KDD\-Explorer|ko_yappo_robot|label\-grabber|larbin|legs|Linkidator|linkwalker|Lockon|logo_gif_crawler|marvin|mattie|mediafox|MerzScope|NEC\-MeshExplorer|MindCrawler|udmsearch|moget|Motor|msnbot|muncher|muninn|MuscatFerret|MwdSearch|sharp\-info\-agent|WebMechanic|NetScoop|newscan\-online|ObjectsSearch|Occam|Orbsearch\/1\.0|packrat|pageboy|ParaSite|patric|pegasus|perlcrawler|phpdig|piltdownman|Pimptrain|pjspider|PlumtreeWebAccessor|PortalBSpider|psbot|Getterrobo\-Plus|Raven|RHCS|RixBot|roadrunner|Robbie|robi|RoboCrawl|robofox|Scooter|Search\-AU|searchprocess|Senrigan|Shagseeker|sift|SimBot|Site Valet|skymob|SLCrawler\/2\.0|slurp|ESI|snooper|solbot|speedy|spider_monkey|SpiderBot\/1\.0|spiderline|nil|suke|http:\/\/www\.sygol\.com|tach_bw|TechBOT|templeton|titin|topiclink|UdmSearch|urlck|Valkyrie libwww\-perl|verticrawl|Victoria|void\-bot|Voyager|VWbot_K|crawlpaper|wapspider|WebBandit\/1\.0|webcatcher|T\-H\-U\-N\-D\-E\-R\-S\-T\-O\-N\-E|WebMoose|webquest|webreaper|webs|webspider|WebWalker|wget|winona|whowhere|wlm|WOLP|WWWC|none|XGET|Nederland\.zoek|AISearchBot|woriobot|NetSeer|Nutch|YandexBot|YandexMobileBot|SemrushBot|FatBot|MJ12bot|DotBot|AddThis|baiduspider|SeznamBot|mod_pagespeed|CCBot|openstat.ru\/Bot|m2e/i';
    $userAgent = empty($_SERVER['HTTP_USER_AGENT']) ? FALSE : $_SERVER['HTTP_USER_AGENT'];
    $isBot = !$userAgent || preg_match($bot_regex, $userAgent);

    return $isBot;
} 
```

无论如何要注意一些机器人使用像用户代理这样的浏览器来伪造他们的身份
（我有很多俄罗斯 ip 在我的网站上有这种行为）

大多数机器人的一个显着特征是它们不携带任何cookie，因此没有会​​话附加到它们。
（我不确定如何，但这肯定是跟踪它们的最佳方法）

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2020-07-02T10:16:28.717

如果你真的需要检测 GOOGLE 引擎机器人，你不应该**依赖**“user_agent”或“IP”地址，因为“user_agent”可以根据谷歌所说的进行更改：[验证 Googlebot](https://support.google.com/webmasters/answer/80553?hl=en)

> **将 Googlebot 验证为调用者：**
> 
> 1.使用 host 命令对日志中的访问 IP 地址运行**反向 DNS查找。**
> 
> 2.验证域名在**googlebot.com**或**google.com中**
> 
> 3.对检索到的域名使用主机命令对步骤 1 中检索到的域名运行**正向 DNS 查找。**验证它是否与日志中的原始访问 IP 地址相同。

这是我测试过的代码：

```
<?php
$remote_add=$_SERVER['REMOTE_ADDR'];
$hostname = gethostbyaddr($remote_add);
$googlebot = 'googlebot.com';
$google = 'google.com';
if (stripos(strrev($hostname), strrev($googlebot)) === 0 or stripos(strrev($hostname),strrev($google)) === 0 ) 
{
//add your code
}

?> 
```

在这段代码中，我们检查“主机名”，它应该在“主机名”的末尾包含“googlebot.com”或“google.com”，这对于检查确切的域而不是子域非常重要。我希望你喜欢 ;）

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-03-24T13:37:12.787

您可以分析用户代理 ( `$_SERVER['HTTP_USER_AGENT']`) 或将客户端的 IP 地址 ( `$_SERVER['REMOTE_ADDR']`) 与[搜索引擎机器人的 IP 地址列表进行](http://www.iplists.com/)比较。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2015-04-28T12:02:20.547

使用 Device Detector 开源库，它提供了一个 isBot() 函数：[https ://github.com/piwik/device-detector](https://github.com/piwik/device-detector)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-03-24T18:22:48.250

```
 <?php // IPCLOACK HOOK
if (CLOAKING_LEVEL != 4) {
    $lastupdated = date("Ymd", filemtime(FILE_BOTS));
    if ($lastupdated != date("Ymd")) {
        $lists = array(
        'http://labs.getyacg.com/spiders/google.txt',
        'http://labs.getyacg.com/spiders/inktomi.txt',
        'http://labs.getyacg.com/spiders/lycos.txt',
        'http://labs.getyacg.com/spiders/msn.txt',
        'http://labs.getyacg.com/spiders/altavista.txt',
        'http://labs.getyacg.com/spiders/askjeeves.txt',
        'http://labs.getyacg.com/spiders/wisenut.txt',
        );
        foreach($lists as $list) {
            $opt .= fetch($list);
        }
        $opt = preg_replace("/(^[\r\n]*|[\r\n]+)[\s\t]*[\r\n]+/", "\n", $opt);
        $fp =  fopen(FILE_BOTS,"w");
        fwrite($fp,$opt);
        fclose($fp);
    }
    $ip = isset($_SERVER['REMOTE_ADDR']) ? $_SERVER['REMOTE_ADDR'] : '';
    $ref = isset($_SERVER['HTTP_REFERER']) ? $_SERVER['HTTP_REFERER'] : '';
    $agent = isset($_SERVER['HTTP_USER_AGENT']) ? $_SERVER['HTTP_USER_AGENT'] : '';
    $host = strtolower(gethostbyaddr($ip));
    $file = implode(" ", file(FILE_BOTS));
    $exp = explode(".", $ip);
    $class = $exp[0].'.'.$exp[1].'.'.$exp[2].'.';
    $threshold = CLOAKING_LEVEL;
    $cloak = 0;
    if (stristr($host, "googlebot") && stristr($host, "inktomi") && stristr($host, "msn")) {
        $cloak++;
    }
    if (stristr($file, $class)) {
        $cloak++;
    }
    if (stristr($file, $agent)) {
        $cloak++;
    }
    if (strlen($ref) > 0) {
        $cloak = 0;
    }

    if ($cloak >= $threshold) {
        $cloakdirective = 1;
    } else {
        $cloakdirective = 0;
    }
}
?> 
```

那将是隐藏蜘蛛的理想方式。它来自一个名为 [YACG] 的开源脚本 - [http://getyacg.com](http://getyacg.com)

需要一些工作，但绝对是要走的路。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2019-08-21T09:50:11.240

我为此做了一个又好又快的功能

```
function is_bot(){

        if(isset($_SERVER['HTTP_USER_AGENT']))
        {
            return preg_match('/rambler|abacho|acoi|accona|aspseek|altavista|estyle|scrubby|lycos|geona|ia_archiver|alexa|sogou|skype|facebook|twitter|pinterest|linkedin|naver|bing|google|yahoo|duckduckgo|yandex|baidu|teoma|xing|java\/1.7.0_45|bot|crawl|slurp|spider|mediapartners|\sask\s|\saol\s/i', $_SERVER['HTTP_USER_AGENT']);
        }

        return false;
    } 
```

这涵盖了所有可能的机器人、搜索引擎等的 99%。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2020-02-04T10:12:59.963

**100% 工作机器人检测器。**它在我的网站上成功运行。

```
function isBotDetected() {

    if ( preg_match('/abacho|accona|AddThis|AdsBot|ahoy|AhrefsBot|AISearchBot|alexa|altavista|anthill|appie|applebot|arale|araneo|AraybOt|ariadne|arks|aspseek|ATN_Worldwide|Atomz|baiduspider|baidu|bbot|bingbot|bing|Bjaaland|BlackWidow|BotLink|bot|boxseabot|bspider|calif|CCBot|ChinaClaw|christcrawler|CMC\/0\.01|combine|confuzzledbot|contaxe|CoolBot|cosmos|crawler|crawlpaper|crawl|curl|cusco|cyberspyder|cydralspider|dataprovider|digger|DIIbot|DotBot|downloadexpress|DragonBot|DuckDuckBot|dwcp|EasouSpider|ebiness|ecollector|elfinbot|esculapio|ESI|esther|eStyle|Ezooms|facebookexternalhit|facebook|facebot|fastcrawler|FatBot|FDSE|FELIX IDE|fetch|fido|find|Firefly|fouineur|Freecrawl|froogle|gammaSpider|gazz|gcreep|geona|Getterrobo-Plus|get|girafabot|golem|googlebot|\-google|grabber|GrabNet|griffon|Gromit|gulliver|gulper|hambot|havIndex|hotwired|htdig|HTTrack|ia_archiver|iajabot|IDBot|Informant|InfoSeek|InfoSpiders|INGRID\/0\.1|inktomi|inspectorwww|Internet Cruiser Robot|irobot|Iron33|JBot|jcrawler|Jeeves|jobo|KDD\-Explorer|KIT\-Fireball|ko_yappo_robot|label\-grabber|larbin|legs|libwww-perl|linkedin|Linkidator|linkwalker|Lockon|logo_gif_crawler|Lycos|m2e|majesticsEO|marvin|mattie|mediafox|mediapartners|MerzScope|MindCrawler|MJ12bot|mod_pagespeed|moget|Motor|msnbot|muncher|muninn|MuscatFerret|MwdSearch|NationalDirectory|naverbot|NEC\-MeshExplorer|NetcraftSurveyAgent|NetScoop|NetSeer|newscan\-online|nil|none|Nutch|ObjectsSearch|Occam|openstat.ru\/Bot|packrat|pageboy|ParaSite|patric|pegasus|perlcrawler|phpdig|piltdownman|Pimptrain|pingdom|pinterest|pjspider|PlumtreeWebAccessor|PortalBSpider|psbot|rambler|Raven|RHCS|RixBot|roadrunner|Robbie|robi|RoboCrawl|robofox|Scooter|Scrubby|Search\-AU|searchprocess|search|SemrushBot|Senrigan|seznambot|Shagseeker|sharp\-info\-agent|sift|SimBot|Site Valet|SiteSucker|skymob|SLCrawler\/2\.0|slurp|snooper|solbot|speedy|spider_monkey|SpiderBot\/1\.0|spiderline|spider|suke|tach_bw|TechBOT|TechnoratiSnoop|templeton|teoma|titin|topiclink|twitterbot|twitter|UdmSearch|Ukonline|UnwindFetchor|URL_Spider_SQL|urlck|urlresolver|Valkyrie libwww\-perl|verticrawl|Victoria|void\-bot|Voyager|VWbot_K|wapspider|WebBandit\/1\.0|webcatcher|WebCopier|WebFindBot|WebLeacher|WebMechanic|WebMoose|webquest|webreaper|webspider|webs|WebWalker|WebZip|wget|whowhere|winona|wlm|WOLP|woriobot|WWWC|XGET|xing|yahoo|YandexBot|YandexMobileBot|yandex|yeti|Zeus/i', $_SERVER['HTTP_USER_AGENT'])
    ) {
        return true; // 'Above given bots detected'
    }

    return false;

} // End :: isBotDetected() 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-10-12T02:04:41.177

我正在使用此代码，非常好。您将很容易知道访问过您网站的用户代理。此代码正在打开一个文件并将 user_agent 写入文件。您可以通过 go to 每天检查此文件`yourdomain.com/useragent.txt`并了解新的 user_agents 并将它们置于您的 if 子句条件中。

```
$user_agent = strtolower($_SERVER['HTTP_USER_AGENT']);
if(!preg_match("/Googlebot|MJ12bot|yandexbot/i", $user_agent)){
    // if not meet the conditions then
    // do what you need

    // here open a file and write the user_agent down the file. You can check each day this file useragent.txt and know about new user_agents and put them in your condition of if clause
    if($user_agent!=""){
        $myfile = fopen("useragent.txt", "a") or die("Unable to open file useragent.txt!");
        fwrite($myfile, $user_agent);
        $user_agent = "\n";
        fwrite($myfile, $user_agent);
        fclose($myfile);
    }
} 
```

这是 useragent.txt 的内容

```
Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
Mozilla/5.0 (compatible; MJ12bot/v1.4.6; http://mj12bot.com/)Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)
Mozilla/5.0 (Linux; Android 6.0.1; Nexus 5X Build/MMB29P) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.96 Mobile Safari/537.36 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)mozilla/5.0 (compatible; yandexbot/3.0; +http://yandex.com/bots)
mozilla/5.0 (compatible; yandexbot/3.0; +http://yandex.com/bots)
mozilla/5.0 (compatible; yandexbot/3.0; +http://yandex.com/bots)
mozilla/5.0 (compatible; yandexbot/3.0; +http://yandex.com/bots)
mozilla/5.0 (compatible; yandexbot/3.0; +http://yandex.com/bots)
mozilla/5.0 (iphone; cpu iphone os 9_3 like mac os x) applewebkit/601.1.46 (khtml, like gecko) version/9.0 mobile/13e198 safari/601.1
mozilla/5.0 (windows nt 6.1; wow64) applewebkit/537.36 (khtml, like gecko) chrome/53.0.2785.143 safari/537.36
mozilla/5.0 (compatible; linkdexbot/2.2; +http://www.linkdex.com/bots/)
mozilla/5.0 (windows nt 6.1; wow64; rv:49.0) gecko/20100101 firefox/49.0
mozilla/5.0 (windows nt 6.1; wow64; rv:33.0) gecko/20100101 firefox/33.0
mozilla/5.0 (windows nt 6.1; wow64; rv:49.0) gecko/20100101 firefox/49.0
mozilla/5.0 (windows nt 6.1; wow64; rv:33.0) gecko/20100101 firefox/33.0
mozilla/5.0 (windows nt 6.1; wow64; rv:49.0) gecko/20100101 firefox/49.0
mozilla/5.0 (windows nt 6.1; wow64; rv:33.0) gecko/20100101 firefox/33.0
mozilla/5.0 (windows nt 6.1; wow64; rv:49.0) gecko/20100101 firefox/49.0
mozilla/5.0 (windows nt 6.1; wow64; rv:33.0) gecko/20100101 firefox/33.0
mozilla/5.0 (windows nt 6.1; wow64) applewebkit/537.36 (khtml, like gecko) chrome/53.0.2785.143 safari/537.36
mozilla/5.0 (windows nt 6.1; wow64) applewebkit/537.36 (khtml, like gecko) chrome/53.0.2785.143 safari/537.36
mozilla/5.0 (compatible; baiduspider/2.0; +http://www.baidu.com/search/spider.html)
zoombot (linkbot 1.0 http://suite.seozoom.it/bot.html)
mozilla/5.0 (windows nt 10.0; wow64) applewebkit/537.36 (khtml, like gecko) chrome/44.0.2403.155 safari/537.36 opr/31.0.1889.174
mozilla/5.0 (windows nt 10.0; wow64) applewebkit/537.36 (khtml, like gecko) chrome/44.0.2403.155 safari/537.36 opr/31.0.1889.174
sogou web spider/4.0(+http://www.sogou.com/docs/help/webmasters.htm#07)
mozilla/5.0 (windows nt 10.0; wow64) applewebkit/537.36 (khtml, like gecko) chrome/44.0.2403.155 safari/537.36 opr/31.0.1889.174 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-04-24T01:07:30.413

对于谷歌，我正在使用这种方法。

```
function is_google() {
    $ip   = $_SERVER['REMOTE_ADDR'];
    $host = gethostbyaddr( $ip );
    if ( strpos( $host, '.google.com' ) !== false || strpos( $host, '.googlebot.com' ) !== false ) {

        $forward_lookup = gethostbyname( $host );

        if ( $forward_lookup == $ip ) {
            return true;
        }

        return false;
    } else {
        return false;
    }

}

var_dump( is_google() ); 
```

学分： https: [//support.google.com/webmasters/answer/80553](https://support.google.com/webmasters/answer/80553)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-03-11T11:20:55.760

可能会迟到，但是隐藏的链接呢？所有机器人都会使用 rel 属性跟随，只有坏机器人会使用 nofollow rel 属性。

```
<a style="display:none;" rel="follow" href="javascript:void(0);" onclick="isabot();">.</a>

function isabot(){
//define a variable to pass with ajax to php
// || send bots info direct to where ever.
isabot = true;
} 
```

对于一个糟糕的机器人，你可以使用这个：

```
<a style="display:none;" href="javascript:void(0);" rel="nofollow" onclick="isBadbot();">.</a> 
```

对于特定于 PHP，您可以删除 onclick 属性并将 href 属性替换为指向您的 ip 检测器/机器人检测器的链接，如下所示：

```
<a style="display:none;" rel="follow" href="https://somedomain.com/botdetector.php">.</a> 
```

或者

```
<a style="display:none;" rel="nofollow" href="https://somedomain.com/badbotdetector.php">.</a> 
```

您可以使用它，也可以同时使用两者，一个检测机器人，而另一个证明它是一个坏机器人。

希望你觉得这个有用

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-09-17T19:43:07.130

**验证[Googlebot](https://developers.google.com/search/docs/advanced/crawling/googlebot?hl=en)**

由于用户代理可以更改...

> 唯一官方支持的识别 google bot 的方法是对访问的 IP 地址运行反向 DNS 查找，并对结果运行正向 DNS 查找以验证它是否指向访问 IP 地址并且生成的域名在任一 googlebot 中。 com 或 google.com 域。

取自[这里](https://www.mail-archive.com/haproxy@formilux.org/msg38333.html)。

> 所以你必须运行 DNS 查询

两者，`reverse`和`forward`。

请参阅[Google 搜索中心](https://developers.google.com/search)上的[本指南](https://developers.google.com/search/docs/advanced/crawling/verifying-googlebot?hl=en)。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2018-01-25T05:20:09.410

```
function bot_detected() {

  if(preg_match('/bot|crawl|slurp|spider|mediapartners/i', $_SERVER['HTTP_USER_AGENT']){
    return true;
  }
  else{
    return false;
  }
} 
```

# asp.net - IE（Z-index 渲染问题）

> ID：677420
> 
> 赞同：2
> 
> 时间：2009-03-24T13:34:55.257
> 
> 标签：asp.net, css, cross-browser

我有一个 ASP.NET 应用程序， 当菜单展开时，它在另一个控件 (RadDock)*下呈现第 3 方 (Telerik) 菜单控件。*

这个工件只发生在 IE7 中。不在 Safari/FF/Opera/Chrome 中（我有遗漏吗？）

菜单控件需要呈现在其他控件之上。

我已经用谷歌搜索了很多，但还没有找到一个简单的解决方案来为 IE7 修复它。

IE 最容易解决这个问题的方法是什么？

您还知道这个 z-index 问题是否已在（待定？）IE8 中解决？

这个 Q 并不是要开始浏览器的火焰战争。请仅在您有相关评论时回复。

非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T13:41:34.353

我不知道这是否相似，但是我遇到了 z-indexing 的问题，当 z-index 应用于容器的元素而不是容器本身时，z-index 不是正确应用于子元素。这表现为出现在本应位于顶部的菜单项顶部的背景边框。我通过对包含菜单项的容器应用相同的 z-index 解决了这个问题。我不知道 Telerik 控件如何设置其 CSS，但您可能需要检查分配给容器的类是否具有适当的 z-index 以及菜单项本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T13:44:14.690

我以前遇到过一些类似的问题，虽然不是你提到的第 3 方控件。如果浏览器是 IE，请检查是否有任何一个控件有条件地设置了它自己的 z-index。如果不是这种情况，请尝试为每个控件（或其容器）设置特定的 z-index，以确保 IE 不会退回到某种默认的未知 z-index。

如果 z-index 更改没有修复它，它实际上可能是定位问题而不是 z-index 问题。当您尝试进行跨浏览器兼容性时，定位问题很常见（根据我自己的经验）。

# c# - 动态添加和删除 UserControl

> ID：677424
> 
> 赞同：1
> 
> 时间：2009-03-24T13:35:17.520
> 
> 标签：c#, winforms

我有持有 Infragistics Graph 控件的 UserControl。在 TreeView 子节点的右键单击上，我将上下文菜单设置为“创建图形”。这将创建新图表。这就是我要做的事情。

我对使用什么布局感到困惑。无论是 FlowLayoutPanel 还是 TableLayoutPanel 或其他任何东西。如果只添加一个图形 -> 图形必须占据完整的表格。如果添加了两个图形-> 两个图形必须拆分空间等等。这只是一个接一个的格式。即第一张图在顶部，第二张图在第一张图的下方……以此类推。

如果 UserControl 是手动更改的，它不应该影响我们显示的大小。

这是WinForm。目前我使用 FlowLayoutPanel，我创建了具有恒定大小的面板并添加了带有 DockStyle.Fill 的 UserControl。然后我将面板添加到 FlowLayoutPanel。

```
 GraphUserControl usr = new GraphUserControl();
 usr.Dock = DockStyle.Fill;

 Panel pnl = new Panel();

 pnl.Controls.Add(usr);

 flowLayoutpnl.Controls.Add(pnl); 
```

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T14:06:29.863

TableLayoutPanel 可能是您的最佳选择，因为可以将行高设置为百分比值。

```
private void AddControl(Control ctl)
{
    tableLayoutPnl.RowCount += 1;
    tableLayoutPnl.RowStyles.Add(
        new RowStyle(SizeType.Percent, 100F / tableLayoutPnl.RowCount));
    ctl.Dock = DockStyle.Fill;
    tableLayoutPnl.Controls.Add(ctl, 0, tableLayoutPnl.RowCount - 1);
    foreach (RowStyle rs in tableLayoutPnl.RowStyles)
    {
        rs.Height = 100F / tableLayoutPnl.RowCount;
    }
} 
```

然后，您可以按如下方式调用它：

```
GraphUserControl usr = new GraphUserControl();
AddControl(usr); 
```

# c - 检查溢出的最快方法？

> ID：677427
> 
> 赞同：1
> 
> 时间：2009-03-24T13:36:03.010
> 
> 标签：c, performance, optimization, embedded

这是我的尝试。有关更好解决方案的任何提示？：

```
// for loop to convert 32 to 16 bits
uint32_t i;
int32_t * samps32 = (int32_t *)&(inIQbuffer[0]);
int16_t * samps16 = (int16_t *)&(outIQbuffer[0]);
for( i = 0; i < ( num_samples * 2/* because each sample is two int32 s*/ ); i++ ) {
    overflowCount += ( abs(samps32[i]) & 0xFFFF8000 ) ? 1 : 0; 
    samps16[i] = (int16_t)samps32[i];
}

// Only report error every 4096 accumulated overflows
if( ( overflowCount & 0x1FFF ) > 4096 ) {
    printf( "ERROR: Overflow has occured while scaling from 32 "
            "bit to 16 bit samples %d times", 
            overflowCount );
} 
```

这是实际检查溢出的部分：

```
overflowCount += ( abs(samps32[i]) & 0xFFFF8000 ) ? 1 : 0; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T13:41:32.060

我个人更喜欢使用 SafeInt 类来进行溢出检查。它减少了对繁琐的错误检查的需求，并将其转变为易于处理但难以忽略的异常。

[http://blogs.msdn.com/david_leblanc/archive/2008/09/30/safeint-3-on-codeplex.aspx](http://blogs.msdn.com/david_leblanc/archive/2008/09/30/safeint-3-on-codeplex.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T13:55:20.590

你已经做的，最接近单次施法的最快速度。但是，您可以省略一些代码

> 溢出计数 += ( abs(samps32[i]) & 0xFFFF8000 ) ？1：0；

可以改成：

> if (samps32[i] & 0xFFFF8000) 溢出计数++；

甚至更简单

> if (samps32[i] >> 15) 溢出计数++；

这两个速度都一样快，而且都比你的快。

如果您实际上对溢出计数感兴趣，则可以考虑使用 SIMD 操作处理整数数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T14:17:11.117

您似乎正在检查 16 位加法的溢出。您可以避免在汇编代码中出现分支，只需

```
overflowCount += (samps32[i] & 0x8000) >> 15; 
```

这会生成三个 ALU 操作，但代码中没有分支。它可能会也可能不会比分支版本快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T14:09:04.240

位操作也是我的选择。目前我能想象的唯一更快的方法是使用内联汇编，在其中加载源操作数，在芯片上制作副本，截断和按位比较（那是伪伪代码）。

您的代码有一个问题：它违反了别名规则。你可以改用这样的东西：

```
union conv_t {
    int32_t i32;
    int16_t i16;
}; 
```

然后您可以确保 IQBuffer 属于该类型。最后，您可以运行：

```
for( i = 0; i < (num_samples * 2); i++ ) {
    <test goes here>
    samps [i].i16 = static_cast<int16_t>(samps [i].i32);
} 
```

**编辑：**根据您的编辑（[https://stackoverflow.com/revisions/677427/list](https://stackoverflow.com/revisions/677427/list)），您几乎使我的整个帖子无效。感谢您在问题中未提及您的编辑。

# git - 如何获得 Git 提交计数？

> ID：677436
> 
> 赞同：885
> 
> 时间：2009-03-24T13:38:55.390
> 
> 标签：git, build-process, revision

我想获取我的 Git 存储库的提交次数，有点像 SVN 修订号。

目标是将其用作唯一的、递增的内部版本号。

我目前在 Unix/Cygwin/msysGit 上这样做：

```
git log --pretty=format:'' | wc -l 
```

但我觉得这有点骇人听闻。

有没有更好的方法来做到这一点？如果我实际上不需要`wc`甚至不需要 Git，那就太酷了，这样它就可以在裸 Windows 上运行。只需读取文件或目录结构...

* * *

## 回答 #1

> 赞同：1374
> 
> 时间：2010-10-31T03:21:03.933

要获取修订的提交计数（`HEAD`, `master`，提交哈希）：

```
git rev-list --count <revision> 
```

要获取所有分支的提交计数：

```
git rev-list --all --count 
```

我建议不要将其用于构建标识符，但如果必须，最好将计数用于您正在构建的分支。这样，相同的修订版将始终具有相同的编号。如果您对所有分支使用计数，其他分支上的活动可能会更改数量。

* * *

## 回答 #2

> 赞同：189
> 
> 时间：2010-04-23T17:28:29.567

`git shortlog`是一种方式。

* * *

## 回答 #3

> 赞同：137
> 
> 时间：2011-11-14T07:52:03.313

此命令返回按提交者分组的提交计数：

```
git shortlog -s 
```

输出：

```
14 John lennon
9  Janis Joplin 
```

您可能想知道`-s`参数是 的收缩形式`--summary`。

* * *

## 回答 #4

> 赞同：128
> 
> 时间：2013-03-09T19:43:54.667

`git rev-list HEAD --count`

[git rev 列表](https://www.kernel.org/pub/software/scm/git/docs/git-rev-list.html)

`git rev-list <commit>`：列出可以通过跟随给定提交的父链接（在本例中为*HEAD*）到达的提交。

`--count`：打印一个数字，说明将列出多少次提交，并禁止所有其他输出。

* * *

## 回答 #5

> 赞同：55
> 
> 时间：2009-03-24T14:08:56.987

如果您正在为提交寻找一个唯一且仍然非常易读的标识符，那么[git describe](http://linux.die.net/man/1/git-describe)可能正是您的理想之选。

* * *

## 回答 #6

> 赞同：42
> 
> 时间：2017-12-26T09:09:13.137

你可以使用：

```
git shortlog -s -n 
```

结果 ：

```
 827  user one
    15  user two
     2  Gest 
```

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2009-03-24T13:54:57.520

您不是第一个[在 Git 中考虑“修订号”的人](http://wincent.com/a/about/wincent/weblog/archives/2007/07/build_numbers_i.php)，但 ' `wc`' 非常危险，因为提交可以被擦除或压缩，并且可以重新访问历史。

“修订号”对于 Subversion 尤其重要，因为[在合并的情况下需要](http://macresearch.org/whos-git)它（SVN1.5 和 1.6 在这方面有所改进）。

您最终可能会得到一个预提交挂钩，该挂钩将在评论中包含修订号，并且算法*不涉及*查找分支的*所有*历史以确定正确的编号。

[**Bazaar**](http://jameswestby.net/weblog/2008/Mar)实际上想出了[这样一个算法](http://thread.gmane.org/gmane.comp.version-control.bazaar-ng.general/38388)，它可能是你想做的一个很好的起点。

（正如[Bombe 的回答](https://stackoverflow.com/questions/677436/how-to-get-the-git-commit-count/677566#677566)所指出的，Git 实际上有自己的算法，基于最新的标签，加上提交的数量，再加上一点 SHA-1 密钥）。如果它对您有用，您应该看到（并赞成）他的答案。

* * *

为了说明[Aaron 的想法](https://stackoverflow.com/questions/677436/how-to-get-the-git-commit-count/677529#677529)，您还可以[将 Git 提交哈希附加到](http://www.stompy.org/2008/08/14/xcode-and-git-another-build-script/)您与应用程序一起分发的应用程序的“信息”文件中。

这样，关于框将如下所示：

![关于盒子](https://i.stack.imgur.com/xPr0b.png)

应用编号是提交的一部分，但在打包过程中会生成“应用程序的“信息”文件”，从而有效地将*应用*内部版本号链接到技术修订*ID*。

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2011-07-15T21:52:44.593

要将其放入变量中，最简单的方法是：

```
export GIT_REV_COUNT=`git rev-list --all --count` 
```

* * *

## 回答 #9

> 赞同：22
> 
> 时间：2014-02-06T15:38:19.777

一个简单的方法是：

```
 git log --oneline | wc -l 
```

`oneline`确保这一点。

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2012-11-25T07:59:41.343

Git shortlog 是获取提交详细信息的一种方法：

```
git shortlog -s -n 
```

这将给出提交次数，后跟作者姓名。-s 选项删除作者所做的每个提交的所有提交消息。如果您还想查看提交消息，请删除相同的选项。-n 选项用于对整个列表进行排序。希望这可以帮助。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2012-10-26T14:50:50.813

如果您只使用一个分支，例如 master，我认为这会很好用：

```
git rev-list --full-history --all | wc -l 
```

这只会输出一个数字。您可以将其别名为

```
git revno 
```

让事情变得非常方便。为此，请编辑您的`.git/config`文件并将其添加到：

```
[alias]
    revno = "!git rev-list --full-history --all | wc -l" 
```

这在 Windows 上不起作用。我不知道该操作系统的“wc”等价物，但编写一个 Python 脚本来为您进行计数将是一个多平台解决方案。

**编辑**：获取两次提交之间的计数：

* * *

我正在寻找一个答案，该答案将显示如何获取两个任意修订之间的提交次数，但没有看到任何内容。

```
git rev-list --count [older-commit]..[newer-commit] 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2009-03-24T15:22:54.173

Git 人员可以使用一个很好的帮助脚本来帮助生成基于 Git 描述的有用版本号。我展示了脚本并在我对*[如何在 Git 项目的文件中包含当前提交 ID 的回答中进行了解释。](https://stackoverflow.com/questions/514188/how-would-you-include-the-current-commit-id-in-a-git-projects-files/514668#514668)*.

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2009-11-24T09:24:53.620

git rev-parse --short HEAD

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-03-24T13:59:06.510

在构建期间生成一个数字并将其写入文件。每当您发布版本时，请使用注释“Build 147”（或当前的内部版本号）提交该文件。不要在正常开发过程中提交文件。这样，您可以轻松地在 Git 中的内部版本号和版本之间进行映射。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2014-06-11T11:05:11.337

在我们公司，我们从 SVN 迁移到 Git。缺少修订号是个大问题！

做`git svn clone`，然后用它的 SVN 修订号标记最后一个 SVN 提交：

```
export hr=`git svn find-rev HEAD`
git tag "$hr" -f HEAD 
```

然后您可以在以下帮助下获取修订号

```
git describe --tags --long 
```

该命令给出如下内容：

```
7603-3-g7f4610d 
```

意思是：最后一个标签是 7603 - 它是 SVN 版本。3 - 是来自它的提交计数。我们需要添加它们。

因此，可以通过此脚本计算修订号：

```
expr $(git describe --tags --long | cut -d '-' -f 1) + $(git describe --tags --long | cut -d '-' -f 2) 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2020-10-16T10:12:29.730

以下命令打印当前分支上的提交总数。

```
git shortlog -s -n  | awk '{ sum += $1; } END { print sum; }' "$@" 
```

它由两部分组成：

1.  打印按作者分组的总日志数 ( `git shortlog -s -n`)

    示例输出

    ```
     1445  John C
      1398  Tom D
      1376  Chrsitopher P
       166  Justin T
       166  You 
    ```

2.  总结每个作者的总提交数，即每行的第一个参数，并将结果打印出来（`awk '{ sum += $1; } END { print sum; }' "$@"`）

    使用与上面相同的示例将总结`1445 + 1398 + 1376 + 166 + 166`。因此输出将是：

    ```
     4,551 
    ```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-07-31T14:24:39.840

我以前用的是：

```
git log | grep "^commit" | wc -l 
```

简单但有效。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2014-09-17T20:51:30.220

使用 Bash 语法，

```
$(git rev-list --count HEAD) 
```

对于纯线性历史看起来不错。如果您有时还想从分支中获取“数字”（基于 off `master`），请考虑：

```
$(git rev-list --count $(git merge-base master HEAD)).$(git rev-list --count ^master HEAD) 
```

从结帐运行时`master`，您会得到简单`1234.0`的或类似的东西。当从一个分支结帐运行时`1234.13`，如果在该分支上进行了 13 次提交，您将得到类似的东西。`master`显然，这仅在您最多基于给定修订版的一个分支时才有用。

`--first-parent`可以添加到微编号以抑制仅由合并其他分支引起的某些提交，尽管这可能是不必要的。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2020-10-09T20:12:18.780

> `git shortlog`本身并不能解决提交总数的原始问题（未按作者分组）

这是真的，并且 git rev-list HEAD --count 仍然是最简单的答案。

但是，随着 Git 2.29（2020 年第四季度），“ [`git shortlog`](https://github.com/git/git/blob/2fa8aacc723d4c76b84d449fa7cf0de6cf40e5ad/Documentation/git-shortlog.txt)” ^(（[man](https://git-scm.com/docs/git-shortlog)）)变得更加精确。
它被教导**通过拖车行的内容对提交进行分组**，例如“ `Reviewed-by:`”、“ `Coauthored-by:`”等。

请参阅[Jeff King](https://github.com/git/git/commit/63d24fa0b055d3f0386ee3686c07428450add708)的提交 63d24fa 、提交[56d5dde](https://github.com/git/git/commit/56d5dde7526e725a9e590f32fe38ce6b3391bc36)、[提交 87abb96](https://github.com/git/git/commit/87abb96222b076a1a9aa9c92f799107141feeca4)、[提交 f17b0b9](https://github.com/git/git/commit/f17b0b99bf2dc2fcd74544ce35d058e558e6b056)、[提交 47beb37](https://github.com/git/git/commit/47beb37bc60b690e83b19aa7ff646255fb643ad9)、[提交 f0939a0](https://github.com/git/git/commit/f0939a0eb157cb23cd300d32ee0bff2f82aa5959)、[提交 92338c4](https://github.com/git/git/commit/92338c450bc41e8e3da31a10d2ab73844e8b0634)（2020 年 9 月 27 日）和[提交 45d93eb](https://github.com/git/git/commit/45d93eb82403a35d248d17dd0ea7dc3d690b1323) [（`peff`](https://github.com/peff) 2020 年 9 月 25 日[）](https://github.com/peff)。
^(（由[Junio C Hamano 合并`gitster`——](https://github.com/gitster)在[提交 2fa8aac](https://github.com/git/git/commit/2fa8aacc723d4c76b84d449fa7cf0de6cf40e5ad)中，2020 年 10 月 4 日）)

> ## [`shortlog`](https://github.com/git/git/commit/63d24fa0b055d3f0386ee3686c07428450add708): 允许指定多个组
> 
> ^(签字人：杰夫·金)

> 现在`shortlog`支持从预告片中读取，合并来自多个预告片或预告片和作者之间的计数会很有用。
> 这可以通过对多次运行的输出进行后处理来手动完成，但确保每个名称/提交对只计算一次并非易事。
> 
> 这个补丁教 shortlog 在命令行上接受多个`--group`选项，并从所有选项中提取数据。
> 
> 这使得可以运行：
> 
> ```
> git shortlog -ns --group=author --group=trailer:co-authored-by 
> ```
> 
> 获得一个平等计算作者和共同作者的简短日志。
> 
> 实施大多很简单。" `group`" 枚举变成了一个位域，而尾部键变成了一个列表。
> 我没有费心实现从标准输入读取的多组语义。这是可能的，但现有的匹配代码让它变得很尴尬，我怀疑有人在乎。
> 
> 我们用于预告片的重复抑制现在也涵盖了作者和提交者（尽管在非预告片单组模式下，我们可以跳过哈希插入和查找，因为每次提交只看到一个值）。
> 
> 有一个微妙之处：我们现在关心没有设置组位的情况（在这种情况下，我们默认显示作者）。
> 调用者[`builtin/log.c`](https://github.com/git/git/blob/63d24fa0b055d3f0386ee3686c07428450add708/builtin/log.c)需要适应明确地询问作者，而不是依赖于`shortlog_init()`. 通过一些体操可以使其保持原样工作，但对于单个呼叫者来说不值得。

`git shortlog`现在在其[手册页](https://github.com/git/git/blob/92338c450bc41e8e3da31a10d2ab73844e8b0634/Documentation/git-shortlog.txt#L50-L56)中包含：

> ## `--group=<type>`
> 
> 基于`<type>`. 如果未`--group`指定选项，则默认为`author`. `<type>`是其中之一：
> 
> *   `author`, 提交按作者分组
> *   `committer`, 提交按提交者分组（与 相同`-c`）
> 
> 这是 的别名`--group=committer`。

`git shortlog`现在还包括在其[手册页](https://github.com/git/git/blob/63d24fa0b055d3f0386ee3686c07428450add708/Documentation/git-shortlog.txt#L72-L77)中：

> 如果`--group`多次指定，则在每个值下计算提交（但同样，该提交中的每个唯一值仅计算一次）。例如，`git shortlog --group=author --group=trailer:co-authored-by` 计算作者和共同作者。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2022-01-18T07:26:53.457

有几种很酷的方法可以做到这一点 -

*   **第一种方法**

`git shortlog -s`

此命令打印所有为 repo 做出贡献的用户的提交计数列表。

```
956 Pankaj Tanwar
235 The Ninja
540 The Hardcore Geek
664 The Ever Shining Star
984 The Experienced Man 
```

简单地说，要获得总提交数 -

`git shortlog -s | grep "Pankaj Tanwar"`

它打印 -

```
956 Pankaj Tanwar 
```

*   **另一种干净凉爽的方法是-**

```
git rev-list HEAD --author="Pankaj Tanwar" --count 
```

要计算贡献的代码总行数和提出的总拉取请求，请查看[此博客](https://www.pankajtanwar.in/blog/counting-my-contributions-to-a-git-repo)

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2016-11-15T10:24:03.343

你可以试试

```
git log --oneline | wc -l 
```

或列出在存储库中做出贡献的人所做的所有提交

```
git shortlog -s 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2017-09-11T09:46:13.677

`git config --global alias.count 'rev-list --all --count'`

如果将其添加到配置中，则只需引用命令即可；

`git count`

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2020-01-23T15:14:30.473

制作一个怎么样`alias`？

```
alias gc="git rev-list --all --count"      #Or whatever name you wish 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-11-05T14:01:38.953

像这样使用 git shortlog

`git shortlog -sn`

或者创建一个别名（对于基于 ZSH 的终端）

`# show contributors by commits alias gcall="git shortlog -sn"`

# asp.net - 如何在 Visual Studio 2008 中解决此 JQuery 智能感知问题？

> ID：677440
> 
> 赞同：3
> 
> 时间：2009-03-24T13:39:25.123
> 
> 标签：asp.net, javascript, jquery, visual-studio-2008

我该如何解决这个问题“更新 JScript IntelliSense 时出错：D:\myProject\js\jquery-1.3.2.js: 对象不支持此属性或方法@ 2139:1”，我在这个 [Visual Studio jscript中做了所有事情jQuery 1.2.6 的智能感知错误？](https://stackoverflow.com/questions/218578/visual-studio-jscript-intellisense-error-with-jquery-1-2-6)

但没有希望，我应该在我的 Visual Studio 选项中编辑一些东西，还是 Visual Studio 有问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T14:51:47.570

确保在 jquery-1.3.2.js 旁边有[相应的 vsdoc 文件](http://code.google.com/p/jqueryjs/downloads/detail?name=jquery-1.3.2-vsdoc2.js)（在您的情况下是 /js/ ），并且它的名称正确为**jquery-1.3.2-vsdoc.js**。

此外，虽然我认为在您的情况下这不是绝对必要的，但安装此修补程序通常不会有什么坏处：http: [//blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to -enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx](http://blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to-enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx)

最后，这是 Jeff King（负责工具的项目经理）关于 Visual Studio JavaScript Intellisense 的有用常见问题解答：http: [//blogs.msdn.com/webdevtools/archive/2008/11/18/jscript-intellisense-常见问题解答.aspx](http://blogs.msdn.com/webdevtools/archive/2008/11/18/jscript-intellisense-faq.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-21T10:03:23.557

仅作记录：

添加修补程序后，并确保 vsdoc 具有相同的名称，不要忘记执行 ctrl shift 'J' 以强制 VS 更新 Jquery。您可能还会发现 VSdoc 文件在文件末尾有一个 2。在我的版本中，这不再是必需的，所以我不得不将我的 vsdoc2.js 重命名为 vsdoc.js： ctrl shift 'j' 和繁荣：它工作！

注意。使用此修补程序，您只需要在您的页面上使用它：

```
<script type="text/javascript" src="jsCode\jquery-1.3.2.js"></script> 
```

vsdoc.js 文件只需要放在 jquery-1.3.2.js 文件旁边，它不需要引用，所以如果你有这个：

```
<script type="text/javascript" src="jsCode\jquery-1.3.2-vsdoc.js"></script> 
```

..同样，您可以将其删除。这没有必要，而且 - 我认为 - 公鸡的事情了。

# java - Java Listener 未在 Tomcat 下启动

> ID：677443
> 
> 赞同：1
> 
> 时间：2009-03-24T13:40:05.543
> 
> 标签：java, tomcat, listener

在我的 Tomcat 日志（catalina）中，我收到以下错误，阻止我的应用程序启动：

```
严重：错误 listenerStart
2009 年 3 月 24 日 13:23:10 org.apache.catalina.core.StandardContext 开始
严重：上下文 [/exampleA] 由于先前的错误而启动失败

```

我不知道为什么我会得到这个。在我的 web.xml 我有以下

```
<listener>
    <listener-class>
        uk.co.a.listener.SessionListener
    </listener-class>
</listener>

<listener>
    <listener-class>
        uk.co.a.listener.SessionAttributeListener
    </listener-class>
</listener> 
```

当我注释掉听众时，它开始正常。监听器的代码如下：

```
public class SessionAttributeListener implements HttpSessionAttributeListener {
    static Log log = LogFactory.getLog(SessionAttributeListener.class.getName());

    public void attributeAdded(HttpSessionBindingEvent hsbe) {
        log.debug("VALUE attributeAdded to THE SESSION:" + hsbe.getName());
    }

    public void attributeRemoved(HttpSessionBindingEvent hsbe) {
        log.debug("VALUE attributeRemoved from THE SESSION:" + hsbe.getName());
    }

    public void attributeReplaced(HttpSessionBindingEvent hsbe) {
        log.debug("VALUE attributeReplaced in THE SESSION:" + hsbe.getName());
    }
} 
```

和

```
public class SessionListener implements HttpSessionListener {

    static Log log = LogFactory.getLog(SessionListener.class.getName());

    private static int activeSessions = 0;
    public void sessionCreated(HttpSessionEvent evt)
    {
        activeSessions++;
        log.debug("No. of active sessions on:"+
                new java.util.Date()+" : "+activeSessions);
    }
    public void sessionDestroyed (HttpSessionEvent evt)
    {
        activeSessions--;
    }
} 
```

为什么这没有开始？或者我在哪里可以找到更多信息？

**更新**

似乎只有 SessionAttributeListener 从启动时出现问题。SessionListener 没有启动，因为 <listener> 是在 <servlet> 之后声明的

**更新**

使用的 JAR 文件有问题。不包括 SessionAttributeListener 的类。当它被包含时，应用程序启动。

**更新**

AttributeListener 似乎没有运行。使用时，代码失败。有没有一种简单的方法来检查侦听器是否正在运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T15:30:48.517

由于我最终在其他地方找到了解决方案的途径，因此我认为使用该信息更新此问题会很有用。

这完全与导致可怕的“严重：错误 listenerStart”消息未在任何地方记录的底层异常有关，以及如何配置日志记录以产生异常。

从[这里](http://www.java-tutorial.ch/java-server-faces/jsf-error-listener-start-error-using-tomcat)可以非常清楚地描述日志记录问题和解决方案。

就我而言，我选择了一个更精简的版本，添加

```
org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/web-app].level = FINE
org.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/web-app].handlers = java.util.logging.ConsoleHandler 
```

到 tomcat conf/logging.properties，并将 /web-app 替换为适当的 Web 应用程序上下文路径。

神奇地出现了隐藏的异常并告诉我 Java 6 运行时不想知道 Java 7 编译的代码。令人尴尬，但很容易修复。

这适用于 Tomcat 7。您的里程可能会有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T17:40:49.443

重新阅读“AttributeListener 似乎没有运行。使用它时代码失败。是否有一种简单的方法来检查侦听器是否正在运行？” 您是否尝试过添加静态初始化程序？就像是

```
static {
log.debug("static initialiser called");
} 
```

这样第一次引用该类时，您应该获得一条日志记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-16T23:27:58.837

当您在 Tomcat 日志中遇到“由于以前的错误导致启动失败”时，您将在日志中进一步发现导致此问题的异常，或者您需要在 Tomcat 中完全配置日志记录，以便将异常写入日志。将根本原因写入日志后，解决问题通常是微不足道的。

# c++ - 为什么我的 C++ 代码在使用 read(...) 函数后会导致分段错误？

> ID：677444
> 
> 赞同：1
> 
> 时间：2009-03-24T13:40:13.060
> 
> 标签：c++, c, memory-leaks, segmentation-fault

我的应用程序在似乎没有任何问题的代码行上挂起，但是我的 IDE 似乎在该行上挂起并出现错误：

> gdb/mi (24/03/09 13:36)（退出。收到信号“SIGSEGV”。描述：分段错误。）

这行代码只是调用了一个没有代码的方法。当您有空引用时，不是分段错误吗？如果是这样，空方法如何具有空引用？

这段代码似乎导致了这个问题：

```
#include <sys/socket.h>

#define BUFFER_SIZE 256

char *buffer;

buffer = (char*)GetSomePointer()->SomeStackMemoryString.c_str();
int writeResult = write(socketFD, buffer, BUFFER_SIZE);

bzero(buffer, BUFFER_SIZE);
int readResult = read(socketFD, buffer, BUFFER_SIZE); 
```

当使用该`read(...)`方法的行被注释掉时，问题就消失了。

### 更新：

我已将问题更改为指向实际问题，并删除了所有不相关的代码-我还[回答了我自己的问题](https://stackoverflow.com/questions/677444/why-is-my-c-code-causing-a-segmentation-fault-when-calling-an-empty-virtual-met/678933#678933)，以便阅读本文的人具体知道问题是什么，请在说“你是一个白痴！”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T13:49:00.980

首先，通过空指针或引用调用方法严格来说是未定义的行为。但除非调用是虚拟的，否则它可能会成功。

如果引用/指针为空，则虚拟调用虚拟方法（通过指针/引用，而不是从具有 Class::Method() 调用方式的派生类）总是失败，因为虚拟调用需要访问 vtable 并通过 null 访问 vtable指针/引用是不可能的。所以你不能通过引用/指针调用一个空的虚拟方法。

要理解这一点，您需要更多地了解代码的组织方式。对于每个非内联方法，都有一段代码段包含实现该方法的机器代码。

当调用以非虚拟方式完成时（从派生类或通过引用/指针的非虚拟方法），编译器确切地知道要调用哪个方法（无多态性）。所以它只是插入一个对代码的确切部分的调用，并将*这个*指针作为第一个参数传递给那里。在通过空指针调用的情况下，*这*也将为空，但您不在乎您的方法是否为空。

当调用虚拟完成时（通过引用/指针），编译器不知道要调用哪个方法，它只知道有一个虚拟方法表，并且表的地址存储在对象中。为了找到要调用的方法，必须首先取消引用指针/引用，获取表，从中获取方法的地址，然后才调用该方法。读取表格是在运行时完成的，而不是在编译期间完成的。如果指针/引用为空，此时会出现分段错误。

这也解释了为什么虚拟调用不能内联。编译器在编译期间查看源代码时根本不知道要内联什么代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T14:30:28.447

没有代码，我能做的最好的就是一个疯狂的猜测。但这里有：

您的“长时间运行的代码”正在写入无效的指针。（要么是一个完全随机的指针，要么是越过缓冲区或数组的开始/开始）。这恰好破坏了您的对象的虚函数表——要么是覆盖指向对象的指针，要么是对象的 vptr 成员，要么是覆盖该类的实际全局虚函数表。

一些事情要尝试：

*   在您的班级中安排一名哨兵成员。例如，一个 int 在您的构造函数中初始化为已知模式（0xdeadbeef 或 0xcafebabe 很常见），并且从未更改。在进行虚函数调用之前，请检查 (assert()) 它是否仍然具有正确的值。
*   尝试使用内存调试器。在 Linux 上，选项包括 Electric Fence (efence) 或 Valgrind。
*   在调试器下运行您的程序（gdb 很好）并四处寻找问题所在 - 在段错误发生后进行事后分析，或者在它将发生段错误的位置之前设置一个断点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T19:33:10.343

您的代码是伪造的：缓冲区指向一些随机的内存。我不确定为什么带有 bzero 的行没有失败。

正确的代码是：

```
 char buffer[BUFFER_SIZE];

   bzero(buffer, BUFFER_SIZE);
   int readResult = read(socketFD, buffer, BUFFER_SIZE); 
```

或者您可以使用 calloc(1, BUFFER_SIZE) 来分配一些内存（并清零）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T13:52:18.150

我想不出一个空方法本身会导致这样一个问题的任何原因。没有任何其他背景，我的第一个想法是其他地方的问题正在破坏你的记忆，而它恰好在这里以这种方式表现出来。

我们以前遇到过这样的问题，我在这个答案中写了这个[问题](https://stackoverflow.com/questions/7525/of-memory-management-heap-corruption-and-c/71983#71983)。同样的问题也有很多其他好的建议，可能会对您有所帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T14:14:00.280

> 当您有空引用时，不是分段错误吗？

可能，但不一定。导致段错误的原因在某种程度上是特定于平台的，但这基本上意味着您的程序正在访问不应该访问的内存。您可能想阅读[维基百科文章](http://en.wikipedia.org/wiki/Segmentation_fault)以更好地了解它是什么。

您可能会检查一件事，空方法是否有返回类型？我可能错了，但是如果它返回一个对象，我可以看到如果该方法实际上没有返回一个对象，那么如何在垃圾上调用复制构造函数。这可能会导致各种不稳定的行为。

如果您将其返回类型更改为 void 或返回一个值，您会得到相同的结果吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T19:38:15.010

问题是因为变量正在使用未分配的内存，这会在函数将数据放入`buffer`时导致内存损坏。`read(...)``buffer`

通常，bzero 实际上会导致分段错误，但是由于将字符串分配给内存位置，因此允许读取函数写入分配的内存（导致泄漏）。

```
/* this causes *some* memory to be allocated, 
 * tricking bzero(...) to not SIGSEGV */
buffer = (char*)GetSomePointer()->SomeStackMemoryString.c_str();

int writeResult = write(socketFD, buffer, BUFFER_SIZE); 
```

此更改解决了内存泄漏：

```
#define BUFFER_SIZE 256

// Use memory on the stack, for auto allocation and release.
char buffer[BUFFER_SIZE];

// Don't write to the buffer, just pass in the chars on their own.
string writeString = GetSomePointer()->SomeStackMemoryString;
int writeResult = write(socketFD, writeString.c_str(), writeString.length());

// It's now safe to use the buffer, as stack memory is used.
bzero(buffer, BUFFER_SIZE);
int readResult = read(socketFD, buffer, BUFFER_SIZE); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T13:56:08.950

你是从基类的构造函数中调用虚方法吗？这可能是问题所在：如果您从 class 的构造函数中调用纯虚方法`Base`，`Base`并且它实际上只在 class 中定义`Derived`，您最终可能会访问尚未设置的 vtable 记录，因为`Derived`的构造函数那时还没有被执行。

# iphone - iPhone OS 3.0 中的 ImagePicker API 现在是否包含地理标记？

> ID：677453
> 
> 赞同：0
> 
> 时间：2009-03-24T13:41:57.627
> 
> 标签：iphone

我正在查看 iPhone OS 3.0 的 ImagePicker API 规范，但没有看到任何关于位置被集成到照片中的参考。我知道通过 ImagePicker 拍摄的 OS 2.x 照片不会包含位置数据。但是我想知道是否有人可以确认新的 ImagePicker API 中是否确实缺少地理标记。不知道为什么当本机相机应用程序已经使用了一段时间后，他们会继续忽略它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-28T05:13:58.167

不幸的是，UIImagePickerController 仍然没有任何附加到图像的地理标记数据。我同意，到目前为止，它仍然被省略是很奇怪的。

# wpf - WPF 从 vb.net 代码开始动画给出错误

> ID：677457
> 
> 赞同：0
> 
> 时间：2009-03-24T13:42:45.613
> 
> 标签：wpf, vb.net, animation, storyboard

我试图在引发事件（调用函数）时从窗口的 vb 代码触发在窗口的 XAML 文件中声明的动画，例如窗口的“加载”事件。

这是我声明动画的方式（作为故事板）：

```
Dim StartAnimation As Storyboard = DirectCast(FindName("ServiceOn"), Storyboard)
Dim StopAnimation As Storyboard = DirectCast(FindName("ServiceOff"), Storyboard) 
```

这是失败的函数的代码：

```
Public Function CheckStatus() As Boolean
    If sControl.Status = ServiceControllerStatus.Running Then
        Me.Button1.Content = "Stop"
        Button1.BeginStoryboard(StartAnimation, HandoffBehavior.Compose, isControllable:=False)
    ElseIf sControl.Status = ServiceControllerStatus.Stopped Then
        Me.Button1.Content = "Start"
        Button1.BeginStoryboard(StopAnimation, HandoffBehavior.Compose, isControllable:=False)
    End If
End Function 
```

我得到的错误如下：

> “值不能为空。参数名称：情节提要”

看起来它在“Button1.BeginStoryboard(StartAnimation,...)

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:46:03.827

看起来 StartAnimation 值是 Nothing 导致抛出异常。在调用 BeginStoryBoard 之前，您需要验证它是 non-Nothing。

```
If StartAnimation IsNot Nothing AndAlso sControl.Status = ServiceControllerStatus.Running Then
  Me.Button1.Content = "Stop"
  Button1.BeginStoryBoard(StartAnimation, HandoffBehavior.Compose)
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T17:38:13.777

我实际上弄清楚了问题所在：

当我声明动画时，我是在初始化级别做的，而不是在事件被引发时，所以新类实际上是 = Null。

诀窍是将其粘贴到逻辑代码而不是声明部分中以使其工作。这是最终代码（效果很好）：

```
Imports System
Imports System.ComponentModel
Imports System.ComponentModel.BackgroundWorker
Imports System.IO
Imports System.Threading
Imports System.Net
Imports System.Windows
Imports System.Windows.Controls
Imports System.Windows.Data
Imports System.Windows.Media
Imports System.Windows.Media.Animation
Imports System.Windows.Navigation
Imports System.ServiceProcess
Partial Public Class Window1
    Public Sub New()
        MyBase.New()
         Me.InitializeComponent()
         End Sub
Private WithEvents worker As New BackgroundWorker
Dim sControl As New ServiceController("Spooler")
Private Sub Window1_Loaded(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) Handles Me.Loaded
    worker.WorkerReportsProgress = True
    CheckStatus()
End Sub
Public Function CheckStatus() As Boolean
    If sControl.Status = ServiceControllerStatus.Running Then
        Dim StartAnimation As Storyboard = DirectCast(FindResource("ServiceIsStarted"), Storyboard)
        Me.Button1.Content = "Stop"
        Me.BeginStoryboard(StartAnimation)
    ElseIf sControl.Status = ServiceControllerStatus.Stopped Then
        Dim StopAnimation As Storyboard = DirectCast(FindResource("ServiceIsStopped"), Storyboard)
        Me.Button1.Content = "Start"
        Me.BeginStoryboard(StopAnimation)
    End If
End Function
Private Sub worker_DoWork(ByVal sender As Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles worker.DoWork
    If sControl.Status = ServiceControllerStatus.Running Then
        sControl.Stop()
        sControl.Refresh()
        worker.ReportProgress(100)
    ElseIf sControl.Status = ServiceControllerStatus.Stopped Then
        sControl.Start()
        sControl.Refresh()
        worker.ReportProgress(100)
    End If
End Sub
Private Sub worker_ProgressChanged(ByVal sender As Object, ByVal e As System.ComponentModel.ProgressChangedEventArgs) Handles worker.ProgressChanged
    If sControl.Status = ServiceControllerStatus.Running Then
        Dim StartAnimation As Storyboard = DirectCast(FindResource("ServiceIsStarted"), Storyboard)
        Me.Button1.Content = "Stop"
        Me.BeginStoryboard(StartAnimation)
    ElseIf sControl.Status = ServiceControllerStatus.Stopped Then
        Dim StopAnimation As Storyboard = DirectCast(FindResource("ServiceIsStopped"), Storyboard)
        Me.Button1.Content = "Start"
        Me.BeginStoryboard(StopAnimation)
    End If
End Sub
Private Sub Button1_Click(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) Handles Button1.Click
    worker.RunWorkerAsync()
End Sub 
```

结束类

# svn - Git a/o DVCS 的电梯间距

> ID：677460
> 
> 赞同：6
> 
> 时间：2009-03-24T13:44:05.360
> 
> 标签：svn, git

想象一下，你有一个朋友在打电话（不是 VoIP），他问：“Git 有什么特别之处？我可以使用 Subversion。” 为了描述使用像 Git 这样的 DVCS 的优势，你的“电梯间距”是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T13:53:46.163

已经[有类似的问题了](https://stackoverflow.com/questions/871/why-is-git-better-than-subversion)。此外，Eric Sink 有[许多](http://www.ericsink.com/entries/dvcs_dag_1.html)关于[DVCS](http://www.ericsink.com/entries/dbts_fossil.html)的[文章](http://www.ericsink.com/entries/dvcs_dag_2.html)。另一个问题的答案和文章都可能有助于做出明智的决定。简单地说一个比另一个更好可能不会有帮助（遗憾的是，这似乎是 Linus 在这方面所做的一切，这并不能真正帮助说服人们——至少不是我 :)）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:58:42.253

对我来说，您可以在 DVCS（如 git）中执行的主要操作之一，但在 SVN 中无法正常工作，如下所示：

1）为正在开发的各种功能从主干创建几个开发分支。

2) 在任一功能分支完成并准备好合并到主干之前，将代码从一个功能分支合并到另一个功能分支。

3）稍后，将特征分支合并到主干。

将新功能分解成单独的分支是很好的，这样主干就可以保持干净，直到功能完成。但是，您不可避免地会遇到这样一种情况，即在一个特性分支上工作的团队编写了一些代码，而另一个特性分支上的团队需要这些代码。如果您使用 SVN 跨功能分支合并此代码，那么您稍后将无法合并到主干中。Git 避免了这个问题。

这是另一个好处... 您的公司决定将一项功能的开发外包给一家印度承包公司。或者，您的专业服务团队需要为客户添加一项功能，并且该功能可能会在未来进行产品化。您真的不想将您的 SVN 写入权限授予印度承包商或您的 PS 组。因此，他们必须在源代码控制之外构建代码，并且您必须自己将其合并，在没有 SVN 帮助的情况下自行检测和解决任何冲突，并在此过程中丢失所有承包商的签入历史记录。

但是使用 git，您只需给承包商或您的 PS 组一个存储库的副本，他们就可以像开发人员一样提交它。稍后，您可以使用 git 的功能将更改合并回您的 git 存储库。Git 会发现冲突，并保存历史。

最后，关于 git 的最酷的事情之一是你真的不需要说服你的朋友它比 SVN 更好。因为 git 与 SVN 集成得非常好，所以您的公司/朋友可以愉快地使用 SVN，而您也可以愉快地使用连接到 SVN 的 git。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T13:52:11.660

让他在不访问他的网络存储库的情况下工作/结帐/提交/检查日志/恢复（例如在飞机上）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T17:34:35.400

这是[blub](http://www.paulgraham.com/avg.html)的问题。

您可以在集中式系统中执行的任何操作，我都可以在我的分布式系统中执行，但我的日常 DVCS 任务使我成为如此高效的开发人员，但无法在您的集中式系统中执行 - 而且您不能明白这一点，因为你以你的系统施加在你身上的限制来感知这个世界。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T13:51:11.740

两个字：合并，分支。

在 Git 中合并和分支比其他任何地方都容易。Git 需要解决一个问题：合并数千名开发人员编写的代码，这些开发人员很少使用相同的版本。现在在 SVN 中试试这个：

1.  提交您的工作副本（不破坏其他任何人的构建）
2.  获取最新版本（不会损坏您的工作副本）
3.  将代码与任意目标版本合并，同时能够回滚到您的工作副本或目标版本，而不会丢失三者中的任何一个（工作副本、目标版本、两者之间的合并）。

可以使用 SVN 完成，但在 Git 中，这是默认的操作模式，因此最简单。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T15:21:10.813

对于开发者来说，DVCS 和 SVN 最重要的区别就是**速度**。

当一个在 SVN 中需要 30 秒或 4 分钟的命令在 Git、Mercurial 或 Bazaar 中需要 1 或 2 秒时，这对开发人员来说是一个巨大的差异。版本控制成为一项次要任务，而不是中断您的工作流程。您无需添加咖啡因并重新启动您的巴甫洛夫仪式即可开始工作；你保持你的注意力不会失去它。

其他好处很重要，但相比之下它们是次要的：

*   更简单、更灵活的分支和合并，更少、更简单的合并冲突
*   自由受到网络访问和服务器正常运行时间的限制
*   与您的工作流程相匹配的回购结构

# asp.net - ASP.NET：在重定向页面上长时间运行进程的 UpdateProgress，需要帮助

> ID：677463
> 
> 赞同：0
> 
> 时间：2009-03-24T13:44:40.383
> 
> 标签：asp.net

我有一个由用户填写的带有巨大表单的查询页面。单击一个按钮，然后用户等待下一页上的进程完成运行，然后重定向到新页面。如果长时间运行的进程正在下一页上运行，这是典型的行为。

我想以某种方式运行某种 UpdateProgress，让用户知道下一页上有一个进程正在运行。

我尝试做一些延迟加载，但我不确定为什么它不起作用。这是一个简单的 ASPX 页面，其中包含一个表格、用于显示数据的 FormView，所有这些都在一个更新面板中。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:07:25.023

我让它为我工作的唯一可靠方法是创建一个执行工作单元的工作线程。然后，我使用轮询页面请求更新线程进度并使其重定向到自身，直到工作完成。

它对我有用，但我没有任何片段可以帮助（抱歉）。不过，我要指出，如果您尝试这种方法，您必须非常小心如何设置线程。首先，如果我没有记错的话，你不应该使用 backgroundworker，因为这会使 asp.net 线程池（可能）饿死。

在我的代码中，我创建了自己的线程并自己处理了所有轮询、加入（等）。

如果需要，我可以用一些额外的数据更新这个答案，除非其他人有更好的答案或片段:)。

！

# actionscript-3 - 在 for 循环中创建多个 TextInput 字段

> ID：677468
> 
> 赞同：2
> 
> 时间：2009-03-24T13:46:01.533
> 
> 标签：actionscript-3, loops, for-loop, mxml

我需要遍历一个数组并为每个元素创建一个文本字段。我的问题是如何为每个新的 TextInput 创建一个新的标识符

这是我的代码；

```
var count:Number = 0;
for (var i:String in columnsData)
{
var myTI:TextInput = new TextInput();
myTI.width = 70;
myTI.height = 25;
myTI.text = columnsData[i];
myTI.name = "myTI" + count;
addChild(myTI);
count++;    
   } 
```

然而，所有这一切都是覆盖先前创建的 TextInput 字段，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T14:10:25.407

试试这个：

```
var count:uint = 0,
    textInputs:Array /* of TextInputs */ = [];
for(var i:String in columnsData){
    textInputs[count] = new TextInput();
    // Customize textInput[count] instead of myTI
    addChild(textInputs[count]);
    count++;
} 
```

在此循环之外，您应该能够在`textInputs`数组内部查看对每个新 TextInput 的引用。请注意，在循环内，您可能希望更改每个 TextInput 的 x/y 坐标，以免它们重叠。

# sql-server - 如何在sqlserver中读取表列中的值？

> ID：677470
> 
> 赞同：0
> 
> 时间：2009-03-24T13:46:08.990
> 
> 标签：sql-server

有一张桌子叫Friends。它有名为 Names、Address、Phone no、Dob 的列。我们想一一使用 Friends 表中的名称。所以我想将所有名称存储在一个稍后使用的数组中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:59:38.970

这是纲要：

在您的 .config 文件中：

```
<configuration>
  <connectionStrings>
    <add name="Test" connectionString="Data Source=[server name here];Initial Catalog=[db name here];User Name=blah;Password=blah"/>
  </connectionStrings>
</configuration> 
```

在您的代码中：

```
using System.Configuration;
using System.Data.SqlClient;

...

// In ASP.NET use WebConfigurationManager instead...
string connectionString = ConfigurationManager.ConnectionStrings["Test"].ConnectionString;
SqlConnection connection = new SqlConnection(connectionString);
connection.Open();
SqlCommand command = new SqlCommand("SELECT Name FROM Friends ORDER BY Name", connection);

List<string> nameList = new List<string>();
using (SqlDataReader reader = command.ExecuteReader())
{
    while (reader.Read())
    {
        nameList.Add(reader["Name"] as string);
    }
}
string[] names = nameList.ToArray(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T14:22:39.137

这是谷歌搜索的最佳结果

```
 get sql data c# 
```

[http://www.devhood.com/Tutorials/tutorial_details.aspx?tutorial_id=454](http://www.devhood.com/Tutorials/tutorial_details.aspx?tutorial_id=454)

你想要的 SQL 语句是

```
 select * from friends 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:23:58.103

```
SELECT Name FROM Friends ORDER BY Name 
```

# python - 在 django 中使用“旧”数据库

> ID：677476
> 
> 赞同：6
> 
> 时间：2009-03-24T13:48:33.977
> 
> 标签：python, django

我正在使用带有 Django 的手工构建（Postgres）数据库。使用“inspectdb”，我能够自动为其创建模型。问题是某些表有多个主键（对于多对多关系）并且它们不能通过 Django 访问。

访问这些表的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T14:05:13.517

到目前为止，在 Django 的 ORM 中无法使用复合主键（直到 v1.0.2）。

我只能想到三个解决方案/解决方法：

1.  在 github 上有一个带有复合 pk 补丁的 django[分支](http://github.com/dcramer/django-compositepks/tree/master)，您可能想尝试一下。
2.  您可以将[SQLAlchemy](http://www.sqlalchemy.org/)与 Django 一起使用。
3.  您必须向这些表添加单个字段主键字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:01:35.270

Django 确实支持[多对多关系](http://docs.djangoproject.com/en/dev/topics/db/models/#many-to-many-relationships)。如果您想使用辅助表来管理这种关系，ManyToManyField 需要一个 through 参数来指定要使用的表。您不能以这种方式对任何非常复杂的东西进行建模，但它适用于大多数简单的应用程序。

# javascript - 哪些浏览器在缓存 XMLHTTPRequest 响应时存在问题？

> ID：677480
> 
> 赞同：7
> 
> 时间：2009-03-24T13:49:39.060
> 
> 标签：javascript, ajax, caching, xmlhttprequest, cross-browser

当前流行的浏览器是否在缓存 * 我需要注意的 XMLHttpRequest 响应时存在特殊问题？

我希望能够在每个页面上包含 XMLHttpRequest 查询，作为动态加载与页面类型相关的内容（即 JSON）或行为（如 eval()ed Javascript）的方法，但想确保资源如果服务器发送了正确的标头，它从服务器接收到的信息可能会被缓存。

我很担心阅读[这篇文章，其中提到](http://www.subbu.org/blog/2005/10/xmlhttprequest-and-caching)诸如 Firefox 1.1 之类的浏览器不会缓存通过 XMLHTTPRequest 获得的任何内容，并且它总是要求完全发送新数据（使用 Cache-Control 并且没有 If-Modified-Since），而不管标头如何由服务器发送。

显然那篇文章已经很老了——我什至不记得有 Firefox 1.1；那么对于当前流行的浏览器，我需要考虑哪些因素？当我特别*希望*缓存响应时，有什么技巧吗？

**为了澄清我的问题，缓存是指客户端缓存，其中服务器发出新鲜信息（以 Cache-Control: max-age 指令或 Expires: 标头的形式），浏览器存储其缓存中的响应以及到期日期，因此可以从浏览器缓存中满足从后续页面发出的相同资源的未来请求，而无需与服务器进行任何联系。所有主流浏览器都对大多数内容正确执行此操作，但我听说 Firefox 无法对 XMLHttpRequest 内容执行此操作。我要问的是，是否有人知道任何现代浏览器在使用 XMLHttpRequest 时不根据规范缓存响应的情况。*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T19:49:38.180

Mark Nottingham 有[一组出色的功能测试](http://www.mnot.net/javascript/xmlhttprequest/cache.html)来演示浏览器 XMLHttpRequest 缓存行为。在您想要支持的浏览器中加载页面，并确定您可以和不能依赖哪些技术来缓存您的响应。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T14:02:30.387

尽管某些浏览器具有不同的默认值（默认情况下，IE 会缓存 AJAX 请求的结果，但默认情况下 Firefox 不会），但我知道的所有浏览器都会遵循 http 标头，例如[Cache-Control](http://www.mnot.net/cache_docs/#CACHE-CONTROL)。因此，只需为您的应用程序正确设置缓存标头即可。

这是一个例子：

```
 public ActionResult SomeAction()
    {
        var model = [...];
        Response.AddHeader("Cache-Control", "no-cache");
        return Json(model);
    } 
```

现在 IE 和 Firefox 的行为都一样了；他们永远不会缓存操作的结果。

# php - 使用 PHP 创建 XML 文件并将其保存到服务器

> ID：677481
> 
> 赞同：4
> 
> 时间：2009-03-24T13:49:54.520
> 
> 标签：php, xml

我正在使用 PHP 从 MySQL 数据库中提取数据。我能够使用 DOM 函数构建 XML 文件。然后使用 `echo $dom->saveXML();` ，我能够从 AJAX 调用返回 XML。我如何将 XML 文件保存到服务器上的某个位置，而不是使用 AJAX 来获取 XML？谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T13:53:56.523

使用[`DOMDocument::save()`方法](http://docs.php.net/manual/en/domdocument.save.php)将 XML 文档保存到文件中：

```
$dom->save('document.xml'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T13:52:39.537

[DOMDocument::save()](http://www.php.net/manual/en/domdocument.save.php)对您没有帮助吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-07-05T13:27:43.193

使用 PHP XML DOM Parser 创建和保存 XML 文件。可以从这里找到以下代码和教程 - [Create and Save XML File using PHP](http://www.codexworld.com/create-save-xml-file-using-php/)

```
$xmlString = 'Insert XML Content';
$dom = new DOMDocument;
$dom->preserveWhiteSpace = FALSE;
$dom->loadXML($xmlString);

$dom->save('fileName.xml'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T13:55:32.290

除了前面两个分析器声明的 DOM 本身的“保存”选项之外，您还可以使用这段代码：

```
$strxml = $dom->saveXML();
$handle = fopen("yourxmlfile.xml", "w");
fwrite($handle, $strxml);
fclose($handle); 
```

你完成了。

请记住，运行您的应用程序服务器（可能是 Apache）的用户将需要在您放置 XML 文件的目录中写入的权限。

# c# - 在 UI、BL 和/或 DL 中重复使用验证代码

> ID：677482
> 
> 赞同：1
> 
> 时间：2009-03-24T13:50:04.643
> 
> 标签：c#, .net, asp.net, validation

我想进行客户端验证以快速响应用户，而无需往返服务器。

***我还想要相同的验证来保护业务和数据访问层***操作背后的代码。

如何在 ASP.NET 中实用地重用这种代码？

（注：ASP.NET、C# 3.0、.NET 3.5、Visual Studio 2008）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T23:01:57.080

我不知道常规的 asp.net 是否有一些东西，但您可能想检查一下这个开源项目是如何进行的：http: [//xval.codeplex.com/](http://xval.codeplex.com/)。注意，我还没有真正使用它，所以我不确定它有多好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T14:00:43.107

对于用户界面：

您可以调用方法/属性 Page.IsValid，然后，如果它返回 false，则检查验证器并手动打印它们的错误字符串。或者只是做你自己的错误处理，无论你认为合适。

IE：

```
 protected void OnSomeEvent(object sender, EventArgs e)
    {
        if (!Page.IsValid)
        {
            ErrorMessage.Text = "your socks are the wrong colour";
            return;
        }
        // Continue processing.
    } 
```

假设一个简单的文字来显示错误。显然是根据自己的需要量身定做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T15:36:44.700

建立一个验证项目，给它一个 web 服务接口，这样你就可以用 ajax 调用， [这里有一个教程](http://www.asp.net/AJAX/Documentation/Live/Tutorials/ConsumingWebServicesWithAJAXTutorial.aspx)，然后将它添加到你的 biz 层和你的 Dal 层。那么您的所有代码都可以使用相同的验证码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T15:42:32.177

一个友好的警告，不要期望你的努力取得太大的成功。本文很好地[描述](http://thedailywtf.com/Articles/The-Mythical-Business-Layer.aspx)了您在努力集中化和避免代码重复时所看到的神话“业务层”的谬误。结果是，做你所说的那种统一通常很难证明是合理的。

# sql-server - SQL Server 中非常大的表

> ID：677484
> 
> 赞同：10
> 
> 时间：2009-03-24T13:50:28.683
> 
> 标签：sql-server, sql-server-2005

我们有一个在 SQL Server 2005 64 位标准版上运行的非常大的表（> 77M 记录并且还在增长），并且我们看到了一些性能问题。每天添加多达十万条记录。

有谁知道 SQL Server 标准版可以处理的记录数量是否有限制？应该考虑迁移到企业版还是我们可以使用一些技巧？

附加信息：

有问题的表非常平坦（14 列），有一个包含 6 个字段的聚集索引，以及单个字段上的两个其他索引。

我们在一个问题查询中使用选择中的 3 个字段添加了第四个索引，并且没有发现估计性能有任何差异（查询是必须在下班时间运行的过程的一部分，因此我们没有指标然而）。这些字段是聚集索引的一部分。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T23:05:13.507

同意上面的 Marc 和 Unkown ... 聚集索引中的 6 个索引太多了，尤其是在只有 14 列的表上。你不应该超过 3 或 4，如果是这样，我会说 1 或 2。你可能知道聚集索引是磁盘上的实际表，所以当插入记录时，数据库引擎必须对其进行排序并且将其放在磁盘上已排序的有组织的位置。非聚集索引不是，它们支持查找“表”。根据下面的第 1 点，我的 VLDB 被布置在磁盘 (CLUSTERED INDEX) 上。

1.  将聚集索引减少到 1 或 2。最好的字段选择是 IDENTITY (INT)，如果您有一个，或者将字段添加到数据库中的日期字段，或者其他一些自然类型的字段您的数据是如何添加到数据库中的。关键是您试图将该数据保留在表格的底部......或者以您将读取记录的最佳（90％以上）方式将其布置在磁盘上。这样就不会进行重组，或者只需一次点击即可将数据放在正确的位置以进行最佳读取。请务必将删除的字段放入非聚集索引中，以免失去查找功效。我从来没有在我的 VLDB 上放置超过 4 个字段。如果您有经常更新的字段并且它们包含在您的聚集索引中，OUCH，那
2.  检查索引上的填充因子。填充因子数 (100) 越大，数据页和索引页就越满。关于您拥有的记录数和插入的记录数，您将更改非聚集索引的填充因子 #（+ 或 -），以便在插入记录时留出填充空间。如果您将聚集索引更改为顺序数据字段，那么这对聚集索引就没有那么重要了。经验法则 (IMO)，60-70 填充因子用于高写入，70-90 用于中等写入，90-100 用于高读取/低写入。通过将填充因子降低到 70，意味着对于页面上的每 100 条记录，将写入 70 条记录，这将为新记录或重组记录留下 30 条记录的可用空间。占用更多空间，但它肯定胜过每晚必须整理碎片（见下文 4）
3.  确保统计信息存在于表中。如果您想使用“sp_createstats 'indexonly'”扫描数据库以创建统计信息，那么 SQL Server 将在引擎累积的所有索引上创建所有统计信息作为需要统计信息。但是不要离开'indexonly'属性，否则你会为每个字段添加统计信息，那样就不好了。
4.  使用 DBCC SHOWCONTIG 检查表/索引以查看哪些索引碎片化最多。我不会在这里详细介绍，只知道你需要这样做。然后根据该信息，根据索引正在经历的变化以及变化的速度（随着时间的推移）向上或向下更改填充因子。
5.  设置一个作业计划，对各个索引进行联机 (DBCC INDEXDEFRAG) 或脱机 (DBCC DBREINDEX) 以对它们进行碎片整理。警告：在维护期间不要在这么大的表上执行 DBCC DBREINDEX，因为它会导致应用程序停止运行……尤其是在 CLUSTERED INDEX 上。你已经被警告过了。测试和测试这部分。
6.  使用执行计划查看存在哪些 SCANS 和 FAT PIPES 并调整索引，然后对存储的过程进行碎片整理和重写以消除这些热点。如果您在执行计划中看到一个 RED 对象，那是因为该字段上没有统计信息。那很糟。这一步更像是“艺术而不是科学”。
7.  在非高峰时间，运行 UPDATE STATISTICS WITH FULLSCAN 为查询引擎提供尽可能多的有关数据分布的信息。否则，在工作日晚上或更频繁地对表执行标准 UPDATE STATISTICS（标准 10% 扫描），以确保引擎有更多关于数据分布的信息以有效地检索数据。

对不起，这很长，但它非常重要。我在这里只给你很少的信息，但会有所帮助。这些点使用的策略需要您的时间和测试，有一些直觉和观察。

无需进入企业版。我这样做是为了获得前面提到的分区功能。但我特别是为了在搜索和在线碎片整理和维护方面拥有更好的多线程功能......在企业版中，它对 VLDB 更好、更友好。标准版也不处理对在线数据库进行 DBCC INDEXDEFRAG 处理。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-24T13:54:00.657

我首先要看的是索引。如果您使用 Management Studio 中的执行计划生成器，您希望查看索引查找或聚集索引查找。如果您看到扫描，特别是表扫描，您应该查看索引您通常搜索的列，看看这是否会提高您的性能。

您当然不需要为此迁移到企业版。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-24T16:57:18.250

您真的需要访问单个表中的所有 7700 万条记录吗？

例如，如果您只需要访问最近 X 个月的数据，那么您可以考虑创建归档策略。这可用于将数据重新定位到存档表，以减少数据量，从而减少“热”表上的查询时间。

这种方法可以在标准版中实现。

如果您升级到企业版，您可以使用表分区。同样取决于您的数据结构，这可以提供显着的性能改进。分区也可用于实现前面提到的策略，但管理开销较少。

这是关于 SQL Server 2005 中表分区的优秀白皮书

[http://msdn.microsoft.com/en-us/library/ms345146.aspx](http://msdn.microsoft.com/en-us/library/ms345146.aspx)

我希望我所详述的内容清晰易懂。如果您需要进一步的帮助，请直接与我联系。

干杯，

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-25T19:31:06.627

> [有一个包含 6 个字段的聚集索引，以及单个字段上的两个其他索引。]

在不知道有关字段的任何详细信息的情况下，我会尝试找到一种方法来使聚集索引更小。

使用 SQL Server，所有聚集键字段也将包含在所有非聚集索引中（作为从非聚集索引到实际数据页的最终查找的一种方式）。

如果您有 6 个字段，每个 8 字节 = 48 字节，则将其乘以两个索引乘以 7700 万行 - 您会看到大量浪费的空间，这会转化为大量 I/O 操作（从而降低性能）。

对于聚集索引，它绝对是唯一的、稳定的和尽可能小的（最好是单个 INT 等），这绝对是至关重要的。

马克

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-24T13:54:00.360

[http://msdn.microsoft.com/en-us/library/ms143432.aspx](http://msdn.microsoft.com/en-us/library/ms143432.aspx)

你有一些成长的空间。

至于性能问题，那是另一个问题。缓存、分片、规范化、索引、查询调优、应用程序代码调优等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T13:54:21.827

标准应该能够处理它。我会查看索引和您对表使用的查询。您希望以这样一种方式构造事物，即您的插入不会导致过多的索引重新计算，但您的查询仍然可以利用索引将查找限制在表的一小部分。

除此之外，您可能会考虑对表进行分区。这将允许您将表分成几个逻辑组。您可以在“幕后”执行此操作，因此即使它单独存储，它仍然作为一个表出现在 sql server 中，或者您可以手动执行（创建一个新的“存档”或年度表并手动移动行） . 无论哪种方式，只有*在*您首先查看其他选项之后才执行此操作，因为如果您没有做到这一点，您最终仍将不得不检查每个分区。另外：分区*确实* [需要 Enterprise Edition](http://www.brentozar.com/archive/2008/06/sql-server-partitioning-not-the-answer-to-everything/)，因此这是将其保存以备不时之需的另一个原因。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T14:29:25.750

就其本身而言，77M 记录对于 SQL Server 来说并不多。您如何加载 100,000 条记录？这是每天批量加载吗？或通过某种 OLTP 应用程序？那是您遇到的性能问题，即添加数据吗？还是查询给您带来的问题最多？

如果您一次添加 10 万条记录，并且添加的记录会强制集群索引重新组织您的表，那将很快降低您的性能。有关表结构、索引和插入数据类型的更多详细信息将有所帮助。

此外，内存的数量和磁盘的速度会产生很大的不同，你在运行什么？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-10-11T00:19:30.377

也许这些都是小问题，但是.... (1) 关系数据库没有字段...它们有列。(2) IDENTITY 列通常意味着数据没有被规范化（或者设计者很懒惰）。某些列组合必须是唯一的（并且这些列构成主键） (3) 对日期时间列进行索引通常是一个坏主意；在日期时间列上进行聚类通常也是一个坏主意，尤其是不断增加的日期时间列，因为所有插入都在争夺磁盘上的相同物理空间。在只读表中的日期时间列上聚类通常是一个好主意（看看这些想法是如何冲突的？谁说数据库设计不是一门艺术？！）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-24T16:51:26.143

你有什么类型的磁盘？

您可能会监视一些磁盘计数器以查看请求是否在排队。

您可以将此表移动到另一个驱动器，方法是将其放在另一个文件组中。您也可以与索引相同。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-25T19:36:44.240

最初我想同意 Marc 的观点。聚集索引的宽度似乎很可疑，因为它本质上将用作对所有记录执行查找的键。通常，聚集索引越宽，访问速度越慢。六字段聚集索引让人感觉非常非常可疑。

聚集索引不需要唯一性。事实上，应该在聚集索引中的字段的最佳候选者是那些不唯一且用于连接的字段。例如，在`Persons`每个人都`Person`属于一个`Group`并且您经常加入的表`Persons`中`Groups`，同时按组访问一批人`Person.group_id`，对于这个特定的用例来说，这将是一个理想的候选者。

# asp.net - 向 SharePoint Webpart 添加必填字段验证器

> ID：677485
> 
> 赞同：3
> 
> 时间：2009-03-24T13:50:39.340
> 
> 标签：asp.net, sharepoint, moss, sharepoint-2007, web-parts

我正在为 MOSS 2007 编写一个 webpart。我需要验证该 webpart 中的一个文本字段，或者我正在使用必填字段验证器。

我正在创建必填字段验证器，如下所示：

```
vldProjectError = new RequiredFieldValidator();
vldProjectError.ForeColor = Color.Red;
vldProjectError.ErrorMessage = Resources.LABEL_PROJECT_ERROR;
vldProjectError.ControlToValidate = txtProjectName.ClientID;
vldProjectError.Display = ValidatorDisplay.Dynamic;
this.Controls.Add(vldProjectError); 
```

上面的代码片段在 CreateChildControls() 覆盖中。当我打开此 Web 部件页面时，我在 SharePoint 中收到一般错误消息。我无法通过调试来捕获错误。

我注意到异常是在 CreateChildControls() 之后和 Render() 方法之前抛出的，因为调试器从不进入 Render() 方法

知道如何在 sharepoint webparts 中使用验证器吗？有什么我想念的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-02T13:32:01.713

我能够解决这个问题。

我们应该使用

```
txtProjectName.ID = "txtProjectName";    
vldProjectError.ControlToValidate = txtProjectName.ID; 
```

代替

```
vldProjectError.ControlToValidate = txtProjectName.ClientID; 
```

这应该在 CreateChidControls() 方法中完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T16:16:27.227

我会尝试两件事：

1.  在为 SharePoint 开发时，启用错误输出绝对有帮助，请按照[这篇文章](http://www.davehunter.co.uk/Blog/Lists/Posts/Post.aspx?ID=79)启用它。
2.  尝试在 Render 方法中分配 ControlToValidate 属性，而不是在 CreateChildControls 中。或者至少在将 txtProjectName 添加到控件集合之后执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T13:54:07.130

您是否尝试在 web.config 中向浏览器启用错误输出？也许这会给你一个更详细的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T07:41:38.827

在验证器控件方面，我遇到了与您相同的问题。已验证控件的**controlId**属性为 null，直到您将其添加到 Web 部件的控件集合中。因此，必须在此行之后配置验证器：

```
this.Controls.Add(txtProjectName); 
```

检查此调试您的 Web 部件并查看已验证控件的 ClientId 属性。

# c# - 返回字符串的 C# PInvoke Delphi dll 仅在 IIS 中失败

> ID：677487
> 
> 赞同：0
> 
> 时间：2009-03-24T13:51:08.823
> 
> 标签：c#, delphi, iis, pinvoke

我有一个导出以下函数的 Delphi 7 dll：

```
function StringTest(var StringOut : pchar) : boolean; stdcall;

begin
    GetMem(StringOut, 100);
    StrPCopy(StringOut, 'Test output string.');
    result := true;
end; 
```

该函数在 C# 中导入如下：

```
[DllImport(@"C:\\Test\\DelphiTest.dll")]
public static extern bool StringTest(out string stringOut); 
```

当我从 WPF 应用程序调用导入时，它工作正常，我看到我的测试字符串在 out 参数中返回。当我从 Cassini 托管的站点尝试相同的操作时，它也可以正常工作。但是，当我从 IIS7 中托管的站点运行该方法时，它会失败。如果我注释掉 GetMem 和 StrPCopy 行，该函数在 IIS 中返回“true”。如何在 IIS 中托管的站点中从 Delphi 将一些字符串数据返回到 C#？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T14:15:25.240

这不是“正常” dll 函数返回字符串的方式。您的代码中不清楚谁应该释放字符串。也许这就是.Net 并不总是喜欢它的原因。调用者应该分配足够的内存来放入结果字符串。

```
function StringTest(const StringOut : pchar; MaxLen: Integer) : Boolean; stdcall;
begin
    StrPLCopy(StringOut, 'Test output string.', MaxLen);
    result := true;
end;

[DllImport(@"C:\\Test\\DelphiTest.dll", CharSet = CharSet.Ansi)]
public static extern bool StringTest(ref string stringOut, int maxLen); 
```

# java - 无法导入 java.lang.instrument.Instrumentation

> ID：677490
> 
> 赞同：0
> 
> 时间：2009-03-24T13:51:34.173
> 
> 标签：java, import

如果我尝试使用

```
import java.lang.instrument.Instrumentation; 
```

它说这个说法无法解决。有什么问题？我正在使用jdk1.6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:55:33.803

你确定那*正是*你的进口线吗？它当然对我有用。尝试编译这个简单的测试类：

```
import java.lang.instrument.Instrumentation;
public class Test {} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:18:50.700

您传递给编译器的类路径可能是错误的吗？

如果您指向错误版本的 java 库，或者根本不包括它们，编译器将无法解析类导入。

# asp.net-mvc - 如何将表单值映射到 ASP.NET MVC HTTP-Post 场景的对象？

> ID：677499
> 
> 赞同：1
> 
> 时间：2009-03-24T13:53:37.490
> 
> 标签：asp.net-mvc

我有一个简单的 ASP.NET MVC 应用程序表单。我有一个与真实属性名称不同（无论出于何种原因）命名的表单属性。

我知道有`[Bind(Exlcude="", Include="")]`属性，但在这种情况下这对我没有帮助。

我也不想`(FormsCollection formsCollection)`在 Action 方法签名中有参数。

还有另一种方法可以定义映射吗？

例如。

```
<%= Html.ValidationMessage("GameServer", "*")%> 
```

结果是 ..

```
<select id="GameServer" name="GameServer">
    <option value="2">PewPew</option>
</select> 
```

这需要映射到..

```
myGameServer.GameServerId = 2; // PewPew. 
```

干杯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T07:36:13.927

将 FormCollection 作为参数传递有什么问题？我必须和你做同样的事情，我只是在 BindAttribute 中排除了 GameServer 属性。

您必须注意的另一件事是这`Html.ValidationMessage("GameServer", "*")`不起作用，因为底层模型不包含 GameServer 属性。您必须将其添加到模型中。不知道有没有更好的办法，没找到，但是制作`ValidationMessage`作品需要

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T18:38:57.650

我相信你需要在你的控制器参数中定义它，否则它不会有任何线索可以接受什么。

```
public ActionResult GameServer(string GameServer){
    GServer myGameServer = new GServer();
    myGameServer.GameServerId.ToString() = GameServer;
    return View("GameServer");
} 
```

您可以在视图页面上传递您尝试使用的参数的名称/ID，它会根据您视图上的 ID 自动知道要接收的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-13T15:54:13.883

You can create you own ModelBinder ([see how to](http://www.singingeels.com/Articles/Model_Binders_in_ASPNET_MVC.aspx)) to do the custom mapping.
An overkill IMO, but you might have your reasons...

# wix - 使用 WIX 安装 WMI 提供程序

> ID：677506
> 
> 赞同：1
> 
> 时间：2009-03-24T13:54:14.977
> 
> 标签：wix, windows-installer, wmi

我使用 System.Management.Instrumentation 命名空间在 C# 中开发了一个 WMI 提供程序。我需要将提供程序安装到 GAC 中并使用 MSI 将其注册到 WMI 存储库。我如何使用 WIX 完成此任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T16:32:26.063

您需要一个 CustomAction 来注册 WMI 提供程序。我们曾考虑向 WiX 工具集添加一个标准的 CustomAction 来支持这一点，但还没有时间这样做。应该是相当多的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-24T16:45:07.667

您可能需要查看 .NET 框架中的 AssemblyInstaller 类。 [http://msdn.microsoft.com/en-us/library/System.Configuration.Install.AssemblyInstaller_methods.aspx](http://msdn.microsoft.com/en-us/library/System.Configuration.Install.AssemblyInstaller_methods.aspx)

您可以创建一个托管自定义操作，该操作使用 Install() 和 Commit() 方法生成 WMI 提供程序的 mof 并安装它。您还可以在卸载 CustomAction 中使用 Uninstall() 和 Commit() 方法。

我不知道这是否是官方推荐的完成此任务的方法。这有点像自我注册，我不喜欢在安装程序中使用。但是，我知道在 WMI 的数据库中注册静态类/实例定义的唯一方法是编译 MOF 文件。包含您的类/实例信息的 MOF 是您的 WMI 提供程序程序集被引用的地方。

AssemblyInstaller 类知道如何为您生成和编译 MOF 文件。还有一个本机 API (IMofCompiler::CompileFile)： http: [//msdn.microsoft.com/en-us/library/aa390867](http://msdn.microsoft.com/en-us/library/aa390867(v=vs.85).aspx) (v=vs.85).aspx可用于编译您的 MOF 文件。

# java - ANTLR 可以生成最终的解析器类吗？

> ID：677508
> 
> 赞同：1
> 
> 时间：2009-03-24T13:54:43.120
> 
> 标签：java, parsing, antlr, grammar, antlrworks

我正在使用 ANTLR 3.1 和 ANTLRWorks 在 Java 中生成解析器类。如果我用 Java final 关键字标记生成的类，解析器的性能会更好。问题是：每次从 ANTLR 语法重新生成代码后，我都会手动添加此关键字。无论如何，在语法中，告诉 ANTLR 将 final 关键字添加到生成的解析器类定义中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T13:58:49.677

您使用的是什么版本的 Java？较新的应该会自动检测叶类，就像自 1.3 以来在 -server 模式下的任何一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T14:06:11.377

从[这个线程](https://stackoverflow.com/questions/357695/how-do-you-specify-the-access-specifier-on-an-antlr-v3-generated-parser-or-lexer)（哎呀-我的错），看起来还不可能做到这一点。:(

# .net - opencv：如何在 Visual Studio 2005 中设置项目依赖项？

> ID：677517
> 
> 赞同：0
> 
> 时间：2009-03-24T13:56:14.380
> 
> 标签：.net, visual-studio, opencv

我有四个项目：

*   简历
*   核心
*   高贵
*   模板匹配

* * *

**项目依赖**：

*   项目 cv 依赖于 cxcore
*   项目 highgui 依赖于 cxcore
*   项目TemplateMatching依赖于cv、cxcore、highgui

* * *

但仍有一些错误：

> 构建开始：项目：highgui，配置：调试 Win32
> 
> ......
> 
> **LINK : ....\bin\cxcore100d.dll 未找到或不是由最后一个增量链接构建的；执行完整链接**
> 
> cvcap.obj：错误LNK2019：函数_cvReleaseCapture cvcap_vfw.obj中引用的未解析的外部符号*cvFree*
> ：错误LNK2001：未解析的外部符号*cvFree*
> cvcap_vfw.obj：错误LNK2019：函数“void __cdecl icvCloseCAM_VFW”中引用的未解析的外部符号_cvReleaseImage（结构CvCaptureCAM_VFW） (?icvCloseCAM_VFW@@YAXPAUCvCaptureCAM_VFW@@@Z)
> image.obj：错误 LNK2001：未解析的外部符号 _cvReleaseImage loadingsave.obj
> ：错误 LNK2001：未解析的外部符号 _cvCreateImage loadingsave.obj
> ：错误 LNK2001：未解析的外部符号 _cvFlip
> image.obj：错误 LNK2019：未解析的外部符号 _cvSetImageROI 在 ....\bin/highgui100d.dll 中引用：致命错误 LNK1120：31 个未解析的外部
> 
> ......
> 
> highgui - 56 个错误，0 个警告
> ========== 构建：0 个成功，1 个失败，1 个最新，0 个跳过 ==========

我不知道如何弄清楚....如何让“TemplateMatching”使用 cv/cxcore/highgui 项目中的功能？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T14:23:34.907

右键单击一个项目并选择添加引用。选择 Projects 选项卡，突出显示要从当前项目中引用的项目，然后单击 OK。在类文件中，使用 (C#) using 语句来引用命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T13:10:47.693

如果您只希望自己的项目（模板匹配）使用 OpenCV，则不必构建 Open CV 项目，只需链接到 OpenCV 库 cv.lib、cxcore.lib 和 highgui.lib。

如果您仍想构建 OpenCV 项目，从错误看来，HighGui 项目未链接到 cxcore.lib。这就是您遇到错误的原因。

我假设您使用典型设置在 Windows 上安装了 OpenCV 1.0？

**编辑**：库，如 cxcore.lib，是“存根”。这些库基本上是占位符，通知链接器函数的实现在 DLL 中。因此，您必须在链接中包含这些库，并确保您的可执行文件知道在哪里可以找到实现这些功能的 DLL。

# c# - 链接多个 asp.NET MultiViews

> ID：677523
> 
> 赞同：0
> 
> 时间：2009-03-24T13:57:55.267
> 
> 标签：c#, master-pages, multiview

我正在处理像往常一样分成各种内容占位符的母版页。在许多页面上，我使用多视图来显示和隐藏基于不同视图模式（查看/编辑/添加）的内容。这意味着每个母版页内容占位符一个多视图...

当我需要切换视图模式时，问题就来了，例如从“视图”到“编辑”。我需要更改页面上的每个多视图以显示相应的信息。所以说存在 4 个不同的内容占位符，有 3 种不同的视图模式——那是 12 行相当乏味的代码。

我想知道是否有一种方法可以同步或链接页面上的所有多视图，以便当一个更改时-它们都会相应地更改？就像通过某种主多视图？

我曾考虑过使用视图的激活事件，但这仍然意味着一开始就需要进行大量接线，这是我试图避免的。

C#eers！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:31:55.043

最好的方法是在母版页上有一个事件，各个多视图添加一个事件处理程序。

这不需要太多代码，您可以通过为所有实例创建从 MultiView 继承的基类来避免重复该代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T22:48:56.440

另一个更自动的选项（但不如 RobW 的选项那样高效）是递归地查看任何多视图的页面控件。就像是：

```
ApplyToControlsRecursive(Page, c =>
{
    var multi = c as System.Web.UI.WebControls.MultiView;
    if (multi != null)
        multi.ActiveViewIndex = 1;
});
void ApplyToControlsRecursive(System.Web.UI.Control control, Action<System.Web.UI.Control> action)
{
    action(control);
    foreach (System.Web.UI.Control child in control.Controls)
    {
        ApplyToControlsRecursive(child, action);
    }
} 
```

# f# - 在 F# 中调用对象方法的简写

> ID：677526
> 
> 赞同：2
> 
> 时间：2009-03-24T13:58:35.467
> 
> 标签：f#

有没有办法“生成”这样的函数：

```
fun x -> x.ToString 
```

我希望能够将实例方法转换为将“this”作为参数的静态方法，如下所示：

```
items |> Seq.filter my_predicate |> Seq.map Object.ToString 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T16:15:13.720

这已在 F# 集线器上讨论过多次。例如，将[实例方法视为函数](http://cs.hubfs.net/forums/thread/3260.aspx)。这是一个非常棘手的问题，因此据我所知，没有计划在 F# 的第一个版本中包含类似的东西，但最终有类似的东西会很棒:-)。

您可以做的另一个解决方法是在 F# 中添加静态成员作为扩展方法：

```
type System.Object with
  static member ObjToString(o:obj) = o.ToString()

open System
[ 1 .. 10 ] |> Seq.map Object.ObjToString;; 
```

But that is a bit ugly. Also, it seems that this works only if you use different name for the method. I guess that F# doesn't allow you to overload existing method with an extension method and always prefer the intrinsic one.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T15:45:04.587

我不知道我是否完全理解你，但对于这个具体的例子，你可以写：

```
items |> Seq.filter my_predicate |> Seq.map (fun x -> x.ToString) 
```

或者

```
let f = fun x -> x.ToString
items |> Seq.filter my_predicate |> Seq.map f 
```

# ios - 如何以编程方式获取 iphone 的 MAC 地址

> ID：677530
> 
> 赞同：146
> 
> 时间：2009-03-24T13:59:30.347
> 
> 标签：ios, objective-c, iphone, mac-address

如何以编程方式获取 iPhone 的 MAC 地址和 IP 地址？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-03-24T14:51:27.023

* * *

**注意**从 iOS7 开始，您无法再检索设备 MAC 地址。将返回一个固定值而不是实际 MAC

* * *

我不久前偶然发现的东西。最初从[这里](http://www.iphonedevsdk.com/forum/iphone-sdk-development/5293-get-current-ip-address.html)我对其进行了一些修改并清理了一些东西。

[IPAddress.h](http://www.chrisandtennille.com/code/IPAddress.h)
[IPAddress.c](http://www.chrisandtennille.com/code/IPAddress.c)

并使用它

```
InitAddresses();
GetIPAddresses();
GetHWAddresses();

int i;
NSString *deviceIP = nil;
for (i=0; i<MAXADDRS; ++i)
{
    static unsigned long localHost = 0x7F000001;        // 127.0.0.1
    unsigned long theAddr;

    theAddr = ip_addrs[i];

    if (theAddr == 0) break;
    if (theAddr == localHost) continue;

    NSLog(@"Name: %s MAC: %s IP: %s\n", if_names[i], hw_addrs[i], ip_names[i]);

        //decided what adapter you want details for
    if (strncmp(if_names[i], "en", 2) == 0)
    {
        NSLog(@"Adapter en has a IP of %s", ip_names[i]);
    }
} 
```

适配器名称因模拟器/设备以及设备上的 wifi 或单元而异。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2011-11-07T12:13:12.643

**更新：**这不适用于 iOS 7。您应该使用[ASIdentifierManager](http://developer.apple.com/library/ios/#documentation/AdSupport/Reference/ASIdentifierManager_Ref/ASIdentifierManager.html)。

* * *

MobileDeveloperTips 网站上[更干净的解决方案：](http://mobiledevelopertips.com/device/determine-mac-address.html)

```
#include <sys/socket.h>
#include <sys/sysctl.h>
#include <net/if.h>
#include <net/if_dl.h>

...

- (NSString *)getMacAddress
{
  int                 mgmtInfoBase[6];
  char                *msgBuffer = NULL;
  size_t              length;
  unsigned char       macAddress[6];
  struct if_msghdr    *interfaceMsgStruct;
  struct sockaddr_dl  *socketStruct;
  NSString            *errorFlag = NULL;

  // Setup the management Information Base (mib)
  mgmtInfoBase[0] = CTL_NET;        // Request network subsystem
  mgmtInfoBase[1] = AF_ROUTE;       // Routing table info
  mgmtInfoBase[2] = 0;              
  mgmtInfoBase[3] = AF_LINK;        // Request link layer information
  mgmtInfoBase[4] = NET_RT_IFLIST;  // Request all configured interfaces

  // With all configured interfaces requested, get handle index
  if ((mgmtInfoBase[5] = if_nametoindex("en0")) == 0) 
    errorFlag = @"if_nametoindex failure";
  else
  {
    // Get the size of the data available (store in len)
    if (sysctl(mgmtInfoBase, 6, NULL, &length, NULL, 0) < 0) 
      errorFlag = @"sysctl mgmtInfoBase failure";
    else
    {
      // Alloc memory based on above call
      if ((msgBuffer = malloc(length)) == NULL)
        errorFlag = @"buffer allocation failure";
      else
      {
        // Get system information, store in buffer
        if (sysctl(mgmtInfoBase, 6, msgBuffer, &length, NULL, 0) < 0)
          errorFlag = @"sysctl msgBuffer failure";
      }
    }
  }

  // Befor going any further...
  if (errorFlag != NULL)
  {
    NSLog(@"Error: %@", errorFlag);
    return errorFlag;
  }

  // Map msgbuffer to interface message structure
  interfaceMsgStruct = (struct if_msghdr *) msgBuffer;

  // Map to link-level socket structure
  socketStruct = (struct sockaddr_dl *) (interfaceMsgStruct + 1);

  // Copy link layer address data in socket structure to an array
  memcpy(&macAddress, socketStruct->sdl_data + socketStruct->sdl_nlen, 6);

  // Read from char array into a string object, into traditional Mac address format
  NSString *macAddressString = [NSString stringWithFormat:@"%02X:%02X:%02X:%02X:%02X:%02X", 
                                macAddress[0], macAddress[1], macAddress[2], 
                                macAddress[3], macAddress[4], macAddress[5]];
  NSLog(@"Mac Address: %@", macAddressString);

  // Release the buffer memory
  free(msgBuffer);

  return macAddressString;
} 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2011-05-23T23:24:50.560

无论是否启用了wifi，我都想要返回地址，所以选择的解决方案对我不起作用。经过一些调整后，我使用了在某个论坛上找到的另一个电话。我最终得到了以下结果（请原谅我生锈的 C ）：

```
#include <sys/types.h>
#include <stdio.h>
#include <string.h>
#include <sys/socket.h>
#include <net/if_dl.h>
#include <ifaddrs.h>

char*  getMacAddress(char* macAddress, char* ifName) {

int  success;
struct ifaddrs * addrs;
struct ifaddrs * cursor;
const struct sockaddr_dl * dlAddr;
const unsigned char* base;
int i;

success = getifaddrs(&addrs) == 0;
if (success) {
    cursor = addrs;
    while (cursor != 0) {
        if ( (cursor->ifa_addr->sa_family == AF_LINK)
            && (((const struct sockaddr_dl *) cursor->ifa_addr)->sdl_type == IFT_ETHER) && strcmp(ifName,  cursor->ifa_name)==0 ) {
            dlAddr = (const struct sockaddr_dl *) cursor->ifa_addr;
            base = (const unsigned char*) &dlAddr->sdl_data[dlAddr->sdl_nlen];
            strcpy(macAddress, ""); 
            for (i = 0; i < dlAddr->sdl_alen; i++) {
                if (i != 0) {
                    strcat(macAddress, ":");
                }
                char partialAddr[3];
                sprintf(partialAddr, "%02X", base[i]);
                strcat(macAddress, partialAddr);

            }
        }
        cursor = cursor->ifa_next;
    }

    freeifaddrs(addrs);
}    
return macAddress;
} 
```

然后我称之为要求**en0**，如下所示：

```
char* macAddressString= (char*)malloc(18);
NSString* macAddress= [[NSString alloc] initWithCString:getMacAddress(macAddressString, "en0")
                                              encoding:NSMacOSRomanStringEncoding];
free(macAddressString); 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-06-11T23:35:52.477

从 iOS 7 开始，`02:00:00:00:00:00`当您在任何设备上请求 MAC 地址时，系统总是返回该值。

> 在 iOS 7 及更高版本中，如果您询问 iOS 设备的 MAC 地址，系统将返回值 02:00:00:00:00:00。如果需要识别设备，请改用 UIDevice 的 identifierForVendor 属性。（需要标识符用于自己的广告目的的应用程序应考虑改用 ASIdentifierManager 的 adsIdentifier 属性。）”

参考：[发行说明](https://developer.apple.com/library/prerelease/ios/releasenotes/General/WhatsNewIniOS/Articles/iOS7.html#//apple_ref/doc/uid/TP40013162-SW34)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-11-21T14:42:58.460

对此有多种解决方案，但我找不到完整的解决方案。所以我为以下问题制定了自己的解决方案：

[网易信息](https://bitbucket.org/kenial/nicinfo)

如何使用 ：

```
NICInfoSummary* summary = [[[NICInfoSummary alloc] init] autorelease];

// en0 is for WiFi 
NICInfo* wifi_info = [summary findNICInfo:@"en0"];

// you can get mac address in 'XX-XX-XX-XX-XX-XX' form
NSString* mac_address = [wifi_info getMacAddressWithSeparator:@"-"];

// ip can be multiple
if(wifi_info.nicIPInfos.count > 0)
{
    NICIPInfo* ip_info = [wifi_info.nicIPInfos objectAtIndex:0];
    NSString* ip = ip_info.ip;
    NSString* netmask = ip_info.netmask;
    NSString* broadcast_ip = ip_info.broadcastIP;
}
else
{
    NSLog(@"WiFi not connected!");
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-03-27T01:05:52.830

这看起来像一个非常干净的解决方案：[UIDevice BIdentifier](https://github.com/gekitz/UIDevice-with-UniqueIdentifier-for-iOS-5/blob/master/Classes/UIDevice+IdentifierAddition.m#L32)

```
// Return the local MAC addy
// Courtesy of FreeBSD hackers email list
// Accidentally munged during previous update. Fixed thanks to erica sadun & mlamb.
- (NSString *) macaddress{

    int                 mib[6];
    size_t              len;
    char                *buf;
    unsigned char       *ptr;
    struct if_msghdr    *ifm;
    struct sockaddr_dl  *sdl;

    mib[0] = CTL_NET;
    mib[1] = AF_ROUTE;
    mib[2] = 0;
    mib[3] = AF_LINK;
    mib[4] = NET_RT_IFLIST;

    if ((mib[5] = if_nametoindex("en0")) == 0) {
        printf("Error: if_nametoindex error\n");
        return NULL;
    }

    if (sysctl(mib, 6, NULL, &len, NULL, 0) < 0) {
        printf("Error: sysctl, take 1\n");
        return NULL;
    }

    if ((buf = malloc(len)) == NULL) {
        printf("Could not allocate memory. error!\n");
        return NULL;
    }

    if (sysctl(mib, 6, buf, &len, NULL, 0) < 0) {
        printf("Error: sysctl, take 2");
        free(buf);
        return NULL;
    }

    ifm = (struct if_msghdr *)buf;
    sdl = (struct sockaddr_dl *)(ifm + 1);
    ptr = (unsigned char *)LLADDR(sdl);
    NSString *outstring = [NSString stringWithFormat:@"%02X:%02X:%02X:%02X:%02X:%02X", 
                           *ptr, *(ptr+1), *(ptr+2), *(ptr+3), *(ptr+4), *(ptr+5)];
    free(buf);

    return outstring;
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-09-24T12:26:41.223

现在 iOS 7 设备 - 总是返回 02:00:00:00:00:00 的 MAC 地址。

所以最好使用[UIDevice identifierForVendor]。

所以最好调用这个方法来获取应用程序特定的唯一键

类别会更合适

导入“UIDevice+Identifier.h”

```
- (NSString *) identifierForVendor1
{
    if ([[UIDevice currentDevice] respondsToSelector:@selector(identifierForVendor)]) {
        return [[[UIDevice currentDevice] identifierForVendor] UUIDString];
    }
    return @"";
} 
```

现在调用上面的方法来获取唯一的地址

```
NSString *like_UDID=[NSString stringWithFormat:@"%@",
                [[UIDevice currentDevice] identifierForVendor1]];

NSLog(@"%@",like_UDID); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-03-27T18:15:23.693

@Grantland 这个“非常干净的解决方案”看起来类似于我自己对 iPhoneDeveloperTips 解决方案的改进。

你可以在这里看到我的步骤： [https ://gist.github.com/1409855/](https://gist.github.com/1409855/)

```
/* Original source code courtesy John from iOSDeveloperTips.com */

#include <sys/socket.h>
#include <sys/sysctl.h>
#include <net/if.h>
#include <net/if_dl.h>

+ (NSString *)getMacAddress
{
    int                 mgmtInfoBase[6];
    char                *msgBuffer = NULL;
    NSString            *errorFlag = NULL;
    size_t              length;

    // Setup the management Information Base (mib)
    mgmtInfoBase[0] = CTL_NET;        // Request network subsystem
    mgmtInfoBase[1] = AF_ROUTE;       // Routing table info
    mgmtInfoBase[2] = 0;              
    mgmtInfoBase[3] = AF_LINK;        // Request link layer information
    mgmtInfoBase[4] = NET_RT_IFLIST;  // Request all configured interfaces

    // With all configured interfaces requested, get handle index
    if ((mgmtInfoBase[5] = if_nametoindex("en0")) == 0) 
        errorFlag = @"if_nametoindex failure";
    // Get the size of the data available (store in len)
    else if (sysctl(mgmtInfoBase, 6, NULL, &length, NULL, 0) < 0) 
        errorFlag = @"sysctl mgmtInfoBase failure";
    // Alloc memory based on above call
    else if ((msgBuffer = malloc(length)) == NULL)
        errorFlag = @"buffer allocation failure";
    // Get system information, store in buffer
    else if (sysctl(mgmtInfoBase, 6, msgBuffer, &length, NULL, 0) < 0)
    {
        free(msgBuffer);
        errorFlag = @"sysctl msgBuffer failure";
    }
    else
    {
        // Map msgbuffer to interface message structure
        struct if_msghdr *interfaceMsgStruct = (struct if_msghdr *) msgBuffer;

        // Map to link-level socket structure
        struct sockaddr_dl *socketStruct = (struct sockaddr_dl *) (interfaceMsgStruct + 1);

        // Copy link layer address data in socket structure to an array
        unsigned char macAddress[6];
        memcpy(&macAddress, socketStruct->sdl_data + socketStruct->sdl_nlen, 6);

        // Read from char array into a string object, into traditional Mac address format
        NSString *macAddressString = [NSString stringWithFormat:@"%02X:%02X:%02X:%02X:%02X:%02X",
                                      macAddress[0], macAddress[1], macAddress[2], macAddress[3], macAddress[4], macAddress[5]];
        NSLog(@"Mac Address: %@", macAddressString);

        // Release the buffer memory
        free(msgBuffer);

        return macAddressString;
    }

    // Error...
    NSLog(@"Error: %@", errorFlag);

    return nil;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-04T16:08:11.223

**在运行 iOS 7.0 或更高版本的设备上不再可能**，因此无法在 Swift 中获取 MAC 地址。

正如苹果所说：

> 在 iOS 7 及更高版本中，如果您询问 iOS 设备的 MAC 地址，系统将返回值 02:00:00:00:00:00。如果需要识别设备，请改用 UIDevice 的 identifierForVendor 属性。（需要标识符用于自己的广告目的的应用程序应考虑改用 ASIdentifierManager 的 adsIdentifier 属性。）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-04-02T12:35:32.077

```
#import <sys/socket.h>
#import <net/if_dl.h>
#import <ifaddrs.h>
#import <sys/xattr.h>
#define IFT_ETHER 0x6 
```

...

```
- (NSString*)macAddress
{
    NSString* result = nil;

    char* macAddressString = (char*)malloc(18);
    if (macAddressString != NULL)
    {
        strcpy(macAddressString, "");

        struct ifaddrs* addrs = NULL;
        struct ifaddrs* cursor;

        if (getifaddrs(&addrs) == 0)
        {
            cursor = addrs;

            while (cursor != NULL)
            {
                if ((cursor->ifa_addr->sa_family == AF_LINK) && (((const struct sockaddr_dl*)cursor->ifa_addr)->sdl_type == IFT_ETHER) && strcmp("en0", cursor->ifa_name) == 0)
                {
                    const struct sockaddr_dl* dlAddr = (const struct sockaddr_dl*) cursor->ifa_addr;
                    const unsigned char* base = (const unsigned char*)&dlAddr->sdl_data[dlAddr->sdl_nlen];

                    for (NSInteger index = 0; index < dlAddr->sdl_alen; index++)
                    {
                        char partialAddr[3];

                        sprintf(partialAddr, "%02X", base[index]);
                        strcat(macAddressString, partialAddr);
                    }
                }

                cursor = cursor->ifa_next;
            }

        }

        result = [[[NSString alloc] initWithUTF8String:macAddressString] autorelease];

        free(macAddressString);
    }

    return result;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-27T03:59:14.727

在 iOS 6 中根据设备的唯一标识符创建一个 uniqueString：

```
#import <AdSupport/ASIdentifierManager.h>

NSString *uniqueString = [[[ASIdentifierManager sharedManager] advertisingIdentifier] UUIDString];
NSLog(@"uniqueString: %@", uniqueString); 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2014-12-17T14:11:10.433

很多这些问题只针对 Mac 地址。如果您还需要我刚刚写的 IP 地址，可能需要一些工作，但似乎在我的机器上运行良好......

```
- (NSString *)getLocalIPAddress
{
    NSArray *ipAddresses = [[NSHost currentHost] addresses];
    NSArray *sortedIPAddresses = [ipAddresses sortedArrayUsingSelector:@selector(localizedCaseInsensitiveCompare:)];

    NSNumberFormatter *numberFormatter = [[NSNumberFormatter alloc] init];
    numberFormatter.allowsFloats = NO;

    for (NSString *potentialIPAddress in sortedIPAddresses)
    {
        if ([potentialIPAddress isEqualToString:@"127.0.0.1"]) {
            continue;
        }

        NSArray *ipParts = [potentialIPAddress componentsSeparatedByString:@"."];

        BOOL isMatch = YES;

        for (NSString *ipPart in ipParts) {
            if (![numberFormatter numberFromString:ipPart]) {
                isMatch = NO;
                break;
            }
        }
        if (isMatch) {
            return potentialIPAddress;
        }
    }

    // No IP found
    return @"?.?.?.?";
} 
```

# eclipse - Eclipse 是否可以温和地终止而不是使用 SIGKILL？

> ID：677531
> 
> 赞同：24
> 
> 时间：2009-03-24T13:59:48.240
> 
> 标签：eclipse, process, pydev

我在 Windows 上使用 Eclipse，以及用于 Python 开发的 PyDev 插件。当我使用“运行”启动我的应用程序时，它会生成一个新的 Python (CPython) 实例。当我使用“终止”按钮（红色方块）时，它会终止进程。但是，它似乎执行了 SIGKILL，因此我的关闭处理程序无法清理。

有没有办法让 Eclipse 发送 SIGTERM，或者从 Eclipse 控制台模拟键盘中断（ctrl-c）？

注意：我知道还有其他 Python IDE，如 Komodo 或 Wing，可能会解决这个问题，但我不打算切换它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T16:04:38.237

Eclipse 使用发送信号的 Java Process API。这是一个原生 API，没有办法改变它。我假设您也尝试为 SIGKILL 安装处理程序，但没有成功。

因此，唯一的解决方案是编写一个小批处理文件，列出进程并将 SIGTERM 发送给其中一个。从命令提示符调用它。如果您使用 Alt-Tab 切换到它，它几乎与在 Eclipse 中进行切换一样舒适。

或者编写一个插件来调用批处理文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-03-27T22:17:13.410

我看了看[Java程序如何获得自己的进程ID？](https://stackoverflow.com/questions/35842/how-can-a-java-program-get-its-own-process-id)并想出了这个。

```
System.out.println("kill -SIGINT "+ProcessHandle.current().pid()); 
```

我意识到，如果您不希望将其打印出来进行生产，那么这并不理想，但如果您只是进行原型设计，那么它很方便。或者你可以把它放在一个 if 只有在你调试时才运行。

# mysql - 按组自动递增

> ID：677542
> 
> 赞同：10
> 
> 时间：2009-03-24T14:02:13.010
> 
> 标签：mysql, auto-increment

MySQL（特别是 5.0）有没有办法让 auto_increment 字段的值基于分组列？

例子：

```
id  name   group_field
1   test   1
2   test2  1
1   test3  2
2   test4  2
1   test5  3
2   test6  3 
```

我不想通过任何“疯狂”的方法来实现这一点，但如果有必要的话。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-24T14:09:58.967

对于 MyISAM 和 BDB 表，您可以将[auto_increment](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)字段作为键的辅助部分，例如

```
CREATE TABLE foo (
   id          INT AUTO_INCREMENT NOT NULL,
   group_field INT NOT NULL,
   name        VARCHAR(128),

   PRIMARY KEY(group_field, id)
); 
```

这是[手册](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)对此的说明

> 在这种情况下，AUTO_INCREMENT 列的生成值计算为 MAX(auto_increment_column) + 1 WHERE prefix=given-prefix。当您要将数据放入有序组时，这很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T14:11:06.263

您是否考虑过[复合主键](http://forums.mysql.com/read.php?125,75814,75814)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:12:10.613

You can achieve that with trigger on insert, setting max(id) from table group by group_field having group_fileld = @inserted_group;

# opengl - 这些“未定义的对 __glut*WithExit”的 OpenGL 链接器错误的引用是什么意思？

> ID：677547
> 
> 赞同：2
> 
> 时间：2009-03-24T14:04:09.417
> 
> 标签：opengl

原始问题：

> [警告] 传递`GLfloat' for converting 2 of`void glutSolidSphere(GLdouble, GLint, GLint)'
> [警告] 传递`GLfloat' for converting 3 of`void glutSolidSphere(GLdouble, GLint, GLint)'

* * *

在应用了包含 glut.h 的海报建议之一后，我现在遇到了这个问题。

没有它我不能使用 glutSolidSphere()。

> [链接器错误] 对 `__glutInitWithExit@12' 的未定义引用
> 
> [链接器错误] 对 `__glutCreateWindowWithExit@8' 的未定义引用
> 
> [链接器错误] 未定义对 `__glutCreateMenuWithExit@8' 的引用
> 
> [链接器错误] 未定义对 `glutSolidSphere@16' 的引用

如果有帮助，我正在使用 DEV C++。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T10:43:27.103

将选项传递`-lglut32`给 mingw 的链接器 - Dev-Cpp 使用 mingw。

您必须在项目选项中的某处找到“链接器选项”文本框。抱歉，我不能说得更具体，我使用 Dev-Cpp 已经一年多了，而我*真正*使用它已经三年多了。它应该与您添加`-lopengl32`和的位置相同`-lglu32`。

不要忘记安装[GLUT devpak](http://old.devpaks.org/show.php?devpak=128)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T14:05:45.963

看起来很乱。也许它告诉您您正在传递 a预期的`GLfloat`地方`GLint`，作为第二个和第三个参数？请再次粘贴您的确切错误/警告输出，这看起来不正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T14:08:53.350

'slices' 和 'stacks' 参数应该是整数；您的代码正在传递浮点数。

编辑：您真的不应该编辑您的问题以使其成为一个完全不同的问题。未定义的引用意味着您没有在包含这些函数的库中进行链接。您需要在要链接的库列表中包含 GLuT。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T19:19:46.037

正如 DNS 所说，但用更简单的术语来说：

您需要链接 GLUT 库。我相信它通常是 Win32 机器上的 glut32.lib。在 IDE 的项目属性页面中应该有一个选项；抱歉，我不使用 Dev-C++，但在 Visual Studio 中，它位于项目属性中，然后是链接器设置和“附加库包含”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-07T17:24:36.833

GLUTMingw32.zip 文件包含在 devcpp 下构建所需的所有文件，我在桌面上提取了它。从 devcpp 项目项目选项菜单添加 lib 和 include 目录到 include 和 lib 目录。在参数选项卡上的项目选项对话框中添加后 - >链接器：

../../../../Dev-Cpp/lib/libopengl32.a

../../../../Dev-Cpp/lib/libglu32.a

../GLUTMingw32/GLUTMingw32/lib/libglut32.a

前两个在 devcpp install dir/lib 文件夹中/您可以使用 -lopengl32 和 -lglu32 代替，它可以工作/

第三个，libglut32.a，我从提取的 GLUTMingw32.zip 文件夹中添加

将 glut32.dll 放在生成项目和 main.cpp 所在的文件夹中

就这样 。在我获得 Permission denied 后，我只是删除了生成的 exe 文件，如果无法删除 exe，则重新编译 close devcpp

如果它抱怨简短的重新定义

在 main.cpp 顶部添加“#define _WCHAR_T_DEFINED”

不带引号

# load-testing - 严重的测试环境

> ID：677550
> 
> 赞同：1
> 
> 时间：2009-03-24T14:05:29.583
> 
> 标签：load-testing, test-environments

我们有一个非常复杂的 Web 应用程序，以至于很难准确地模拟生产负载。

我们的应对机制之一是确保测试环境中的硬件总是比我们的生产硬件慢，因此负载和性能问题会更加明显。

其他人在这样做吗，您正在使用哪些其他策略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:13:38.783

我有一台 7 年使用的 600mHz Celeron 笔记本电脑，配备 256MB RAM，我保留它用于性能分析。为了测试网络延迟，你可以得到一个延迟代理（或者简单地写一个）；它收到一个数据包，等待 X 毫秒，然后继续传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T14:18:45.370

[Fiddler](http://www.fiddler2.com/fiddler2/)可以帮助您测试低带宽——可以模拟较慢网络的延迟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:45:43.090

连接测试仪。进行一些手动测试，并让他们的代理通过记录您手动执行的操作来编写测试脚本。使用脚本自动化。 [http://www.pushtotest.com/](http://www.pushtotest.com/) 开源免费。

# c# - C# 中的 Microsoft 活动辅助功能

> ID：677552
> 
> 赞同：1
> 
> 时间：2009-03-24T14:05:54.933
> 
> 标签：c#, winforms, accessibility

有没有人有任何关于从哪里开始的指示？

我正在使用 MS UI 自动化对应用程序进行一些验收测试，但 MenuStrip 控件不支持 MSUIA，显然，从中获得我想要的东西的唯一方法是 Active Accessibility (MSAA)。

遗憾的是，关于如何在 C# 中充当 MSAA 客户端的信息似乎很少。

如果有人有任何指示，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T14:16:09.703

据我所知，您必须使用 COM 互操作来用 C# 编写 MSAA 客户端。

# java - 在 SQL Server 2005 中限制 SELECT 语句

> ID：677555
> 
> 赞同：2
> 
> 时间：2009-03-24T14:06:29.253
> 
> 标签：java, sql-server, concurrency, locking

我有一种情况，在执行特定任务之前，我必须检查是否在 DB 中设置了特定标志，如果未设置，则完成其余处理并设置相同的标志。现在，在来自 2 个不同事务的并发访问的情况下，如果第一个事务检查标志并且未设置它会继续进行。同时，我想限制第二个事务检查标志，即我想限制该事务执行 SELECT 查询，并且一旦第一个事务完成其处理并设置标志，它就可以执行相同的操作。

我想用锁/提示在数据库级别实现它。但是没有提示限制 SELECT 查询，我不能去隔离级别限制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T14:38:01.863

您可以创建一个[应用程序锁](http://weblogs.sqlteam.com/mladenp/archive/2008/01/08/Application-Locks-or-Mutexes-in-SQL-Server-2005.aspx)来保护您的标志，因此如果第二个事务无法获得应用程序锁，它将不会执行 SELECT 或访问标志

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T14:16:06.017

我相信 SQL Server 2005 本身就是通过不允许脏读来做到这一点的。也就是说，据我了解，只要更新/插入发生在第二个用户尝试进行选择以检查标志之前，数据库将等待更新/插入在处理选择之前提交。

如果您想要更多粒度，这里有一些[常见的锁也可以帮助您。](http://blog.sqlauthority.com/2007/04/27/sql-server-2005-locking-hints-and-examples/)

编辑：XLOCK 也可能有一些帮助。而且，将 SQL 包装在事务中也可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T15:00:50.107

您可以尝试一个执行这两项任务的存储过程，或者作为两个执行不同任务的不同存储过程的入口点（类似于代理）。

存储过程是 SQL Server 中的监视器，管理并发（您想要做什么）的工件也是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T15:02:54.313

您只需要简单地在您的 SP / 代码中启动一个事务，然后更新标志。这将阻止任何其他用户阅读它（除非他们正在阅读未提交的内容）。

如果他们正在读取未提交的内容，请在您的更新事务上设置排他锁。

# java - 是否有现有的库方法可以检查 Java 中的 String 是全部大写还是小写？

> ID：677561
> 
> 赞同：38
> 
> 时间：2009-03-24T14:08:06.223
> 
> 标签：java, string

我知道在 Java 和其他框架（如 Apache commons lang）中有很多`upper()`方法，它们将字符串转换为全部大写。

是否有任何通用库提供类似`isUpper(String s)`and的方法`isLower(String s)`来检查字符串中的所有字符是大写还是小写？

编辑：

关于转换为 Upper 并与之比较的许多很好的答案。我想我应该更具体一点，并说我已经想到了这一点，但我希望能够为此使用现有的方法。

关于可能包含在 apache.commons.lang.StringUtils 中的良好评论。甚至有人提交了补丁（20090310）。希望我们很快就会看到这一点。 [https://issues.apache.org/jira/browse/LANG-471](https://issues.apache.org/jira/browse/LANG-471)

编辑：

我需要这种方法的目的是将有时全大写的酒店名称大写。如果它们都是小写或大写，我只想将它们大写。我确实遇到了一些帖子中提到的非字母字符的问题，最后做了这样的事情：

```
private static boolean isAllUpper(String s) {
    for(char c : s.toCharArray()) {
       if(Character.isLetter(c) && Character.isLowerCase(c)) {
           return false;
        }
    }
    return true;
} 
```

这个讨论和不同的解决方案（有不同的问题）清楚地表明，在 commons.lang 中需要一个好的可靠的 isAllUpper(String s) 方法

在那之前，我想这`myString.toUpperCase().equals(myString)`是最好的方法。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-18T20:31:26.520

现在在 StringUtils [isAllUpperCase](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/StringUtils.html#isAllUpperCase(java.lang.CharSequence))

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-24T14:15:41.137

不幸的是，它不是库函数，但很容易自己动手。如果效率是一个问题，这可能比 s.toUpperCase().equals(s) 更快，因为它可以提前退出。

```
public static boolean isUpperCase(String s)
{
    for (int i=0; i<s.length(); i++)
    {
        if (!Character.isUpperCase(s.charAt(i)))
        {
            return false;
        }
    }
    return true;
} 
```

**编辑：**正如其他张贴者和评论者所指出的，我们需要考虑字符串包含非字母字符时的行为：isUpperCase("HELLO1") 应该返回 true 还是 false？上面的函数将返回 false，因为 '1' 不是大写字符，但这可能不是您想要的行为。在这种情况下将返回 true 的替代定义是：

```
public static boolean isUpperCase2(String s)
{
    for (int i=0; i<s.length(); i++)
    {
        if (Character.isLowerCase(s.charAt(i)))
        {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-09-24T22:43:27.007

这个 if 条件可以得到预期的结果：

```
String input = "ANYINPUT";

if(input.equals(input.toUpperCase())
{
   // input is all upper case
}
else if (input.equals(input.toLowerCase())
{
   // input is all lower case
}
else
{
   // input is mixed case
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-24T14:10:53.393

不是我知道的。

您可以复制字符串并将副本转换为小写/大写并与原始字符串进行比较。

或者创建一个循环来检查单个字符是小写还是大写。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-24T14:13:36.460

此方法可能比比较 String 与其大写版本更快，因为它只需要 1 遍：

```
public static boolean isUpper(String s)
{
    for(char c : s.toCharArray())
    {
        if(! Character.isUpperCase(c))
            return false;
    }

    return true;
} 
```

请注意，不同字符集可能存在一些本地化问题。我没有任何第一手经验，但我认为在某些语言（如土耳其语）中，不同的小写字母可以映射到同一个大写字母。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-08-08T13:47:02.670

Guava 的[CharMatchers](https://github.com/google/guava/wiki/StringsExplained#charmatcher)倾向于为这类问题提供非常有表现力和有效的解决方案。

```
CharMatcher.javaUpperCase().matchesAllOf("AAA"); // true
CharMatcher.javaUpperCase().matchesAllOf("A SENTENCE"); // false
CharMatcher.javaUpperCase().or(CharMatcher.whitespace()).matchesAllOf("A SENTENCE"); // true
CharMatcher.javaUpperCase().or(CharMatcher.javaLetter().negate()).matchesAllOf("A SENTENCE"); // true
CharMatcher.javaLowerCase().matchesNoneOf("A SENTENCE"); // true 
```

静态导入`com.google.common.base.CharMatcher.*`可以帮助使这些更简洁。

```
javaLowerCase().matchesNoneOf("A SENTENCE"); // true 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-06-24T06:39:51.037

试试这个，可能会有所帮助。

```
import java.util.regex.Pattern;

private static final String regex ="^[A-Z0-9]"; //alpha-numeric uppercase
public static boolean isUpperCase(String str){
    return Pattern.compile(regex).matcher(str).find();
} 
```

使用此代码，我们只需更改正则表达式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-06-28T06:14:00.213

如果您希望输入字符串很短，则可以`myString.toUpperCase().equals(myString)`按照您的建议进行。它简短而富有表现力。

但你也可以使用流：

```
boolean allUpper = myString.chars().noneMatch(Character::isLowerCase); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-04-16T02:53:15.660

我意识到这个问题已经很老了，但是接受的答案使用了一个不推荐使用的 API，并且有一个关于如何使用 ICU4J 来做的问题。我是这样做的：

```
s.chars().filter(UCharacter::isLetter).allMatch(UCharacter::isUpperCase) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-24T14:14:07.677

您可以使用 java.lang.Character.isUpperCase() 然后您可以轻松编写一个方法来检查您的字符串是否为大写（使用简单的循环）。

将消息 toUpperCase() 发送到您的字符串，然后检查结果是否等于您的字符串可能会更慢。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-02T18:27:31.500

这是我想出的一个有点通用的解决方案，因为它不需要任何库或特殊导入，应该适用于任何版本的 Java，只需要一次通过，并且应该比任何基于正则表达式的解决方案快得多：

```
public static final boolean isUnicaseString(String input) {
  char[] carr = input.toCharArray();
  // Get the index of the first letter
  int i = 0;
  for (; i < carr.length; i++) {
    if (Character.isLetter(carr[i])) {
      break;
    }
  }
  // If we went all the way to the end above, then return true; no case at all is technically unicase
  if (i == carr.length) {
    return true;
  }
  // Determine if first letter is uppercase
  boolean firstUpper = Character.isUpperCase(carr[i]);
  for (; i < carr.length; i++) {
    // Check each remaining letter, stopping when the case doesn't match the first
    if (Character.isLetter(carr[i]) && Character.isUpperCase(carr[i]) != firstUpper) {
      return false;
    }
  }
  // If we didn't stop above, then it's unicase
  return true;
} 
```

# c# - 事务范围或 IDbTransaction

> ID：677563
> 
> 赞同：3
> 
> 时间：2009-03-24T14:08:43.413
> 
> 标签：c#, .net, ado.net

编辑：我只访问 1 个数据库，但正在创建 DTC 事务。我可以在 DTC 事务列表 GUI（组件服务插件）中看到它。为什么是这样？

我需要对 1 个数据库执行事务（几个插入命令）。

我应该使用 TransactionScope 还是 IDbTransaction (connection.BeginTransaction)？

TransactionScope 似乎更新了……但它应该只用于两阶段提交吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T14:14:59.903

TransactionScope 仅在检测到多个连接时才会升级为分布式事务。这意味着 TransactionScope 与本地事务的 BeginTransaction 一样轻量级，并且 TransactionScope 更易于使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T14:29:08.950

在绝大多数情况下，TransactionScope 更易于使用，尤其是与“使用”块结合使用时。

不过要小心，如果您使用 SQL Server 2000。它不能很好地与 TransactionScope 配合使用，并且总是会升级为分布式事务。

有关详细信息，请参阅[此链接](http://davidhayden.com/blog/dave/archive/2005/12/09/2615.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T14:16:48.857

只要您使用单个连接并且在 TransactionScope 期间不关闭并重新打开，它就不应升级为分布式事务。如果您的机器上没有运行 DTC 服务，它会在尝试提升时抛出异常。如果 DTC 正在运行，除了稍作停顿之外，您将不会更明智地进行促销。

# coldfusion - 在 fuse 的 .cfm 中使用 Fusebox 5.5 权限属性检查

> ID：677565
> 
> 赞同：1
> 
> 时间：2009-03-24T14:08:56.487
> 
> 标签：coldfusion, fusebox

我有一个标准的用户/角色设置，它在列表中返回当前用户的角色。然后我使用 permissions="" 属性和 preFuseaction 阶段来检查这个用户是否被授权访问这个 fuseaction。这允许显示页面的某些块，并为不同的用户隐藏某些块。

我不能在更细粒度的级别上做同样的事情，即禁止在侧边栏中向没有权限的用户显示链接。说：

```
<ul>
   <li><a href="#xfa.mainmenu#>Main Menu</a></li>
   <li><a href="#xfa.adminmenu#>Admin Menu</a></li>
</ul> 
```

管理员菜单应该只对具有“管理员”角色的用户可用。如果普通用户点击这个链接，他们什么也得不到，因为当 fuseaction 实际运行时，它会把他们踢出去。我宁愿一开始就没有链接。

这可以通过将角色硬编码到 .cfm 文件中来完成，因此：

```
<ul>
   <li><a href="#xfa.mainmenu#>Main Menu</a></li>
   <cfif checkRole('admin') EQ TRUE><li><a href="#xfa.adminmenu#>Admin Menu</a></li></cfif>
</ul> 
```

但是，如果可以查找在 circuit.xml 中定义的权限并将其传递给 checkRole() （可能通过传递 xfa？）而不是静态值，则会更优雅一些。这可能与 Fusebox 创建的结构有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T14:21:43.273

不要与真实进行比较-这是不必要的浪费时间...

```
<cfif checkRole('admin') >...</cfif> 
```

但是，在显示文件中我会这样做：

```
<cfif StructKeyExists( Xfa , 'AdminMenu' )>
    <li><a href="#xfa.adminmenu#>Admin Menu</a></li>
</cfif> 
```

然后，在您的 circuit.xml 文件中，您可以执行以下操作：

```
<fuseaction name="Menu">
    <do action="NormalMenuLinks"/>
    <do action="AdminMenuLinks"/>

    ...

</fuseaction>

<fuseaction name="NormalMenuLinks">
    <xfa name="MainMenu" value="..."/>

</fuseaction>

<fuseaction name="AdminMenuLinks" permissions="admin">
    <xfa name="AdminMenu" value="..."/>

</fuseaction> 
```

我实际上并没有使用 FB 权限，所以我不知道上面是否会按预期工作。

如果没有，您可以这样做：

```
<fuseaction name="Menu">
    <do action="NormalMenuLinks"/>

    <if condition="checkRole('admin')">
    <true>
        <do action="AdminMenuLinks"/>
    </true>
    </if>

    ...

</fuseaction> 
```

这有点难看，但应该可以。

当然，如果你只有一个 XFA，你可以直接使用它而不是做单独的 fuseactions，但是如果你有多个 XFAs（特别是如果它们将在多个页面中使用），那么在 fuseactions 中使用 XFAs 会有所帮助保持整洁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:13:16.953

不要认为它真的是 Fusebox 工作的一部分——定义对代码块的访问。每次设置 XFA 并不是真正灵活的 IMO 风格。

我通常使用安全令牌来限制访问。每个fuseaction名称默认为token，其他自定义token可由开发者添加。在您的情况下，自定义令牌应该是“MainMenu”和“AdminMenu”。

我正在使用基于组的安全性，因此 fuseaction 权限看起来像“管理员，成员”。这是 fuseaction 令牌的默认安全映射，例如“mycircuit.myfuseaction”。我将访问地图保存在数据库中，因此第一次使用时将 fuseaction 和自定义令牌推送到地图中，以后可以更改。

要检查使用简单方法（UDF）的访问权限（'TokenName'），它将当前用户组（在您的案例中的角色）与令牌映射进行比较：

```
<ul>
   <li><a href="#xfa.mainmenu#>Main Menu</a></li>
   <cfif granted('AdminMenu')><li><a href="#xfa.adminmenu#>Admin Menu</a></li></cfif>
</ul> 
```

这种方式更加灵活，让您能够为不同的令牌组定义默认访问级别，在 STRICT（如果未定义则拒绝）和 LOOSE（如果未定义则授予）模式等之间切换。

希望这可以帮助。

# python - distutils：如何将用户定义的参数传递给 setup.py？

> ID：677577
> 
> 赞同：76
> 
> 时间：2009-03-24T14:12:04.170
> 
> 标签：python, distutils, setup.py

请提示我如何将用户定义的参数从命令行和 setup.cfg 配置文件传递到 distutils 的 setup.py 脚本。我想编写一个 setup.py 脚本，它接受我的包特定参数。例如：

```
python setup.py install -foo myfoo 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-11-27T17:17:29.920

由于 Setuptools/Distuils 的文档非常糟糕，我自己在寻找答案时遇到了问题。但最终我偶然发现了[这个](http://marc.merlins.org/linux/talks/SvnScalingGvn/svn-tree/gvn-release/setup.py)例子。此外，[这个](https://stackoverflow.com/questions/1710839/custom-distutils-commands)类似的问题也很有帮助。基本上，带有选项的自定义命令如下所示：

```
from distutils.core import setup, Command

class InstallCommand(Command):
    description = "Installs the foo."
    user_options = [
        ('foo=', None, 'Specify the foo to bar.'),
    ]
    def initialize_options(self):
        self.foo = None
    def finalize_options(self):
        assert self.foo in (None, 'myFoo', 'myFoo2'), 'Invalid foo!'
    def run(self):
        install_all_the_things()

setup(
    ...,
    cmdclass={
        'install': InstallCommand,
    }
) 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2011-01-25T10:54:17.403

这是一个非常简单的解决方案，您所要做的就是`sys.argv`在调用 distutils 之前自己过滤并处理它`setup(..)`。像这样的东西：

```
if "--foo" in sys.argv:
    do_foo_stuff()
    sys.argv.remove("--foo")
...
setup(..) 
```

关于如何使用 distutils 执行此操作的文档非常糟糕，最终我遇到了这个：[hitchhikers guide to packaging](http://readthedocs.org/docs/the-hitchhikers-guide-to-packaging/en/latest/specification.html)，它使用`sdist`和它的`user_options`. 我发现[扩展 distutils](http://docs.python.org/2/distutils/extending)参考并不是特别有用。

尽管这看起来像是使用 distutils 的“正确”方式（至少是我能找到的唯一一种模糊记录的方式）。我找不到其他答案中提到的任何东西`--with`和开关。`--without`

这个 distutils 解决方案的问题在于，它对于我正在寻找的东西来说太复杂了（你也可能是这种情况）。添加几十行和子类`sdist`对我来说是错误的。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-10-17T00:21:10.450

`setuptools`是的，现在是 2015 年，在两者中添加命令和选项的文档`distutils`仍然很大程度上缺失。

经过几个令人沮丧的小时后，我想出了以下代码，用于向`install`命令添加自定义选项`setup.py`：

```
from setuptools.command.install import install

class InstallCommand(install):
    user_options = install.user_options + [
        ('custom_option=', None, 'Path to something')
    ]

    def initialize_options(self):
        install.initialize_options(self)
        self.custom_option = None

    def finalize_options(self):
        #print('The custom option for install is ', self.custom_option)
        install.finalize_options(self)

    def run(self):
        global my_custom_option
        my_custom_option = self.custom_option
        install.run(self)  # OR: install.do_egg_install(self) 
```

值得一提的是 install.run() 检查它是否被称为“本机”或已修补：

```
if not self._called_from_setup(inspect.currentframe()):
    orig.install.run(self)
else:
    self.do_egg_install() 
```

此时，您使用以下命令注册您的命令`setup`：

```
setup(
    cmdclass={
        'install': InstallCommand,
    },
    : 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-25T06:48:40.313

您不能真正将自定义参数传递给脚本。但是，以下事情是可能的，并且可以解决您的问题：

*   可选功能可以使用启用`--with-featurename`，标准功能可以使用禁用`--without-featurename`。[AFAIR 这需要安装工具]
*   您可以使用环境变量，但这些变量需要`set`在 Windows 上，而在 linux/OS X ( `FOO=bar python setup.py`) 上为它们添加前缀。
*   您可以使用自己的`cmd_class`es 扩展 distutils 来实现新功能。它们也是可链接的，因此您可以使用它来更改脚本中的变量。( `python setup.py foo install`) 将在`foo`命令执行之前执行它`install`。

希望能有所帮助。一般来说，我建议提供更多信息，您的额外参数到底应该做什么，也许有更好的解决方案可用。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-02-04T19:29:01.533

我成功地使用了一种解决方法来使用类似于 totaam 建议的解决方案。我最终从 sys.argv 列表中弹出了我的额外参数：

```
import sys
from distutils.core import setup
foo = 0
if '--foo' in sys.argv:
    index = sys.argv.index('--foo')
    sys.argv.pop(index)  # Removes the '--foo'
    foo = sys.argv.pop(index)  # Returns the element after the '--foo'
# The foo is now ready to use for the setup
setup(...) 
```

可以添加一些额外的验证来确保输入是好的，但我就是这样做的

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-09-22T04:39:08.190

与 totaam 给出的类似的一种快速简便的方法是使用 argparse 来获取 -foo 参数，并将剩余的参数留给 distutils.setup() 的调用。为此使用 argparse 比手动迭代 sys.argv 更好。例如，在 setup.py 的开头添加：

```
argparser = argparse.ArgumentParser(add_help=False)
argparser.add_argument('--foo', help='required foo argument', required=True)
args, unknown = argparser.parse_known_args()
sys.argv = [sys.argv[0]] + unknown 
```

该`add_help=False`参数意味着您仍然可以使用`-h`（提供`--foo`）获得常规 setup.py 帮助。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-04-08T00:11:34.520

也许你是一个像我一样没有经验的程序员，在阅读了上面所有的答案后仍然很挣扎。因此，您可能会发现另一个可能有用的示例（**并解决先前答案中有关输入命令行参数的评论**）：

```
class RunClientCommand(Command):
    """
    A command class to runs the client GUI.
    """

    description = "runs client gui"

    # The format is (long option, short option, description).
    user_options = [
        ('socket=', None, 'The socket of the server to connect (e.g. '127.0.0.1:8000')',
    ]

    def initialize_options(self):
        """
        Sets the default value for the server socket.

        The method is responsible for setting default values for
        all the options that the command supports.

        Option dependencies should not be set here.
        """
        self.socket = '127.0.0.1:8000'

    def finalize_options(self):
        """
        Overriding a required abstract method.

        The method is responsible for setting and checking the 
        final values and option dependencies for all the options 
        just before the method run is executed.

        In practice, this is where the values are assigned and verified.
        """
        pass

    def run(self):
        """
        Semantically, runs 'python src/client/view.py SERVER_SOCKET' on the
        command line.
        """
        print(self.socket)
        errno = subprocess.call([sys.executable, 'src/client/view.py ' + self.socket])
        if errno != 0:
            raise SystemExit("Unable to run client GUI!") 
```

* * *

```
setup(
    # Some other omitted details
    cmdclass={
        'runClient': RunClientCommand,
    }, 
```

以上内容经过测试，来自我编写的一些代码。我还包含了更详细的文档字符串，以使事情更容易理解。

至于命令行：`python setup.py runClient --socket=127.0.0.1:7777`. 使用 print 语句进行的快速复查表明，run 方法确实选择了正确的参数。

我发现有用的其他资源（***越来越*多*的***例子）：

[自定义 distutils 命令](https://stackoverflow.com/questions/1710839/custom-distutils-commands)

[https://seasonofcode.com/posts/how-to-add-custom-build-steps-and-commands-to-setuppy.html](https://seasonofcode.com/posts/how-to-add-custom-build-steps-and-commands-to-setuppy.html)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-05-24T02:32:27.300

要与两者完全兼容，`python setup.py install`您`pip install .`需要使用环境变量，因为`pip`选项`--install-option=`存在错误：

1.  [pip 跨行`--install-option`泄漏](https://github.com/pypa/pip/issues/5089)
2.  [使用 Wheels 确定应该如何处理 --(install|global)-option](https://github.com/pypa/pip/issues/2677)
3.  [pip 没有正确命名 abi3 轮子](https://github.com/pypa/pip/issues/6304)

这是一个不使用的完整示例`--install-option`：

```
import os
environment_variable_name = 'MY_ENVIRONMENT_VARIABLE'
environment_variable_value = os.environ.get( environment_variable_name, None )

if environment_variable_value is not None:
    sys.stderr.write( "Using '%s=%s' environment variable!\n" % (
            environment_variable_name, environment_variable_value ) )

setup(
        name = 'packagename',
        version = '1.0.0',
        ...
) 
```

然后，您可以在 Linux 上像这样运行它：

```
MY_ENVIRONMENT_VARIABLE=1 pip install .
MY_ENVIRONMENT_VARIABLE=1 pip install -e .
MY_ENVIRONMENT_VARIABLE=1 python setup.py install
MY_ENVIRONMENT_VARIABLE=1 python setup.py develop 
```

但是，如果您在 Windows 上，请像这样运行它：

```
set "MY_ENVIRONMENT_VARIABLE=1" && pip install .
set "MY_ENVIRONMENT_VARIABLE=1" && pip install -e .
set "MY_ENVIRONMENT_VARIABLE=1" && python setup.py install
set "MY_ENVIRONMENT_VARIABLE=1" && python setup.py develop 
```

参考：

1.  [如何使用“--install-option”从 pip 获取传递给 setup.py 的参数？](https://stackoverflow.com/questions/18725137/how-to-obtain-arguments-passed-to-setup-py-from-pip-with-install-option)
2.  [将命令行参数传递给 pip install](https://stackoverflow.com/questions/47210058/passing-command-line-arguments-to-pip-install)
3.  [将库路径作为命令行参数传递给 setup.py](https://stackoverflow.com/questions/16984753/passing-the-library-path-as-a-command-line-argument-to-setup-py)

# c# - 欧拉计划 #16 - C# 2.0

> ID：677579
> 
> 赞同：8
> 
> 时间：2009-03-24T14:13:15.680
> 
> 标签：c#, .net

我一直在与C# 2.0 中的 Project Euler [Problem #16搏斗。](http://projecteuler.net/index.php?section=problems&id=16)问题的症结在于，您必须计算并遍历一个 604 位长（或大约）的数字中的每个数字。然后，您将这些数字相加以产生答案。

这就带来了一个问题：C# 2.0*没有*可以处理这种计算精度的内置数据类型。我可以使用[3rd party library](http://intx.codeplex.com/)，但这会破坏尝试在没有外部库的情况下以编程方式解决它的目的。我可以用 Perl 解决它；但我正在尝试在 C# 2.0 中解决它（我将在下一次运行[Project Euler](http://projecteuler.net)问题时尝试使用 C# 3.0）。

### 问题

您对在 C# 2.0 中解决项目 Euler #16 有什么建议（**不是答案！**）？什么方法会奏效？

> **注意**：如果您决定发布答案，请在您的尝试前加上前面写有###Spoiler 的块引用。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-24T14:20:55.647

一系列数字的数字。32 位无符号整数是 32 位二进制数字。字符串“12345”是一系列 5 位数字。数字可以以多种方式存储：位、字符、数组元素等。C# 中具有完整精度的最大“本机”数据类型可能是十进制类型（128 位，28-29 位）。只需选择您自己的数字存储方法，即可存储更大的数字。

至于其余的，这会给你一个线索：

2 ¹ = 2
2 ² = 2 ¹ + 2 ¹
2 ³ = 2 ² + 2 ²

例子：

```
The sum of digits of 2^100000 is 135178
Ran in 4875 ms

The sum of digits of 2^10000 is 13561
Ran in 51 ms

The sum of digits of 2^1000 is 1366
Ran in 2 ms 
```

**剧透警报：C# 中的算法和解决方案如下。**

基本上，所提到的数字只不过是一个数字数组。这可以通过两种方式轻松表示：

*   作为一个字符串；
*   作为字符或数字的数组。

正如其他人所提到的，实际上建议以相反的顺序存储数字。它使计算变得容易得多。我尝试了上述两种方法。我发现字符串和字符算术很烦人（在 C/C++ 中更容易；在 C# 中语法很烦人）。

首先要注意的是，您可以使用一个数组来执行此操作。您不需要在每次迭代时分配更多存储空间。如前所述，您可以通过将前一个 2 的幂加倍来找到 2 的幂。因此，您可以通过将 1 加倍一千次来找到 2 ^(1000 。)可以使用通用算法进行加倍：

```
carry = 0
foreach digit in array
  sum = digit + digit + carry
  if sum > 10 then
    carry = 1
    sum -= 10
  else
    carry = 0
  end if
  digit = sum
end foreach 
```

该算法与使用字符串或数组基本相同。最后，您只需将数字相加。一个简单的实现可能会在每次迭代时将结果添加到一个新的数组或字符串中。馊主意。真的减慢了速度。如前所述，它可以就地完成。

但是数组应该有多大？嗯，这也很容易。在数学上，您可以将 2^a 转换为 10^f(a)，其中 f(a) 是一个简单的对数转换，您需要的位数是 10 的下一个更高的整数。为简单起见，您可以使用：

```
digits required = ceil(power of 2 / 3) 
```

这是一个近似且足够的。

您真正可以优化的地方是使用更大的数字。32 位有符号整数可以存储 +/- 20 亿之间的数字（大约。9 位数字等于 10 亿，因此您可以使用 32 位整数（有符号或无符号）作为基本的 10 亿“数字”。您可以工作找出您需要多少个整数，创建该数组，这就是运行整个算法（130 个字节）所需的所有存储空间，一切都已到位。

解决方案如下（在相当粗糙的 C# 中）：

```
 static void problem16a()
    {
        const int limit = 1000;
        int ints = limit / 29;
        int[] number = new int[ints + 1];
        number[0] = 2;
        for (int i = 2; i <= limit; i++)
        {
            doubleNumber(number);
        }
        String text = NumberToString(number);
        Console.WriteLine(text);
        Console.WriteLine("The sum of digits of 2^" + limit + " is " + sumDigits(text));
    }

    static void doubleNumber(int[] n)
    {
        int carry = 0;
        for (int i = 0; i < n.Length; i++)
        {
            n[i] <<= 1;
            n[i] += carry;
            if (n[i] >= 1000000000)
            {
                carry = 1;
                n[i] -= 1000000000;
            }
            else
            {
                carry = 0;
            }
        }
    }

    static String NumberToString(int[] n)
    {
        int i = n.Length;
        while (i > 0 && n[--i] == 0)
            ;
        String ret = "" + n[i--];
        while (i >= 0)
        {
            ret += String.Format("{0:000000000}", n[i--]);
        }
        return ret;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T14:25:39.350

我也使用 C# 解决了这个问题，当我发现 Python 可以通过一个简单的操作完成此操作时，我感到非常沮丧。

您的目标是使用 int 值数组创建一个加法机。

### 剧透跟随

> 我最终使用了一个 int 值数组来模拟加法机，但我将数字表示为倒数 - 你可以这样做，因为问题只要求数字的总和，这意味着顺序无关紧要。
> 
> 您实际上所做的是将值加倍 1000 倍，因此您可以将存储在数组第一个元素中的值 1 加倍，然后继续循环直到您的值超过 10。这是您必须跟踪的地方一个套利值。2 超过 10 的第一个幂是 16，所以第 5 次迭代后数组中的元素是 6 和 1。
> 
> 现在，当您从第一个值 (6) 开始遍历数组时，它变为 12（因此您保留最后一位，并在数组的下一个索引上设置一个进位） - 当 *该*值加倍时，您会得到 2 ...加上等于 3 的进位位的 1。现在您的数组中有 2 和 3 代表 32。
> 
> 继续此过程 1000 次，您将拥有一个包含大约 600 个元素的数组，您可以轻松地将它们相加。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T14:37:52.657

假装你很年轻，用方形纸。对我来说，这就像一个数字列表。然后将其加倍，您将每个数字加倍，然后通过减去 10 并将 1 添加到下一个索引来处理任何“进位”。因此，如果答案是 1366... 类似（完全未优化，rot13）：

```
hfvat Flfgrz;
hfvat Flfgrz.Pbyyrpgvbaf.Trarevp;    
pynff Cebtenz {
    fgngvp ibvq Pneel(Yvfg<vag> yvfg, vag vaqrk) {
        juvyr (yvfg[vaqrk] > 9) {
            yvfg[vaqrk] -= 10;
            vs (vaqrk == yvfg.Pbhag - 1) yvfg.Nqq(1);
            ryfr yvfg[vaqrk + 1]++;
        }
    }
    fgngvp ibvq Znva() {
        ine qvtvgf = arj Yvfg<vag> { 1 }; // 2^0
        sbe (vag cbjre = 1; cbjre <= 1000; cbjre++) {
            sbe (vag qvtvg = 0; qvtvg < qvtvgf.Pbhag; qvtvg++) {
                qvtvgf[qvtvg] *= 2;
            }
            sbe (vag qvtvg = 0; qvtvg < qvtvgf.Pbhag; qvtvg++) {
                Pneel(qvtvgf, qvtvg);
            }
        }

        qvtvgf.Erirefr();
        sbernpu (vag v va qvtvgf) {
            Pbafbyr.Jevgr(v);
        }
        Pbafbyr.JevgrYvar();

        vag fhz = 0;
        sbernpu (vag v va qvtvgf) fhz += v;
        Pbafbyr.Jevgr("fhz: ");
        Pbafbyr.JevgrYvar(fhz);
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T15:08:57.420

我以前解决过这个问题，现在我使用 C# 3.0 重新解决了它。:)

我刚刚写了一个`Multiply`扩展方法，它接受一个`IEnumerable<int>`和一个乘数并返回一个`IEnumerable<int>`. （每个 int 代表一个数字，第一个是最低有效数字。）然后我刚刚创建了一个包含项目 { 1 } 的列表并将其乘以 2 a 1000 次。`Sum`使用扩展方法在列表中添加项目很简单。

19 行代码，运行时间为 13 毫秒。在我的笔记本电脑上。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T14:25:28.600

如果您希望在 C# 中进行主要计算，您将需要某种大整数实现（很像C/C++ 的[gmp](http://gmplib.org/)）。编程就是为正确的工作使用正确的工具。如果你找不到一个好的 C# 大整数库，用 Python 这样已经有能力计算大数的语言来计算数字是不违反规则的。然后，您可以通过您选择的方法将此数字放入您的 C# 程序，并遍历数字中的每个字符（您必须将其存储为字符串）。对于每个字符，将其转换为整数并将其添加到总数中，直到到达数字的末尾。如果你想要大整数，我用下面的 python 计算了它。答案在下面。

> ## 部分剧透
> 
> 10715086071862673209484250490600018105614048117055336074437503883703510511249361 22493198378815695858127594672917553146825187145285692314043598457757469857480393 45677748242309854210746050623711418779541821530464749835819412673987675591655439 46077062914571196477686542167660429831652624386837205668069376
> 
> ## 下面剧透！

```
>>> val = str(2**1000)
>>> total = 0
>>> for i in range(0,len(val)): total += int(val[i])
>>> print total

1366 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-24T14:22:36.237

如果您有 ruby​​，您可以轻松计算“2**1000”并将其作为字符串获取。应该是在 C# 中轻松剪切/粘贴到字符串中。

### 剧透

> 在 Ruby 中： (2**1000).to_s.split(//).inject(0){|x,y| x+y.to_i}

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T14:27:26.490

> ### 扰流板
> 
> 如果您想查看解决方案，请查看[我的其他答案](https://stackoverflow.com/questions/377361/sum-of-the-digits-of-the-number-21000)。这是在 Java 中，但很容易移植到 C#

这里有一个线索：

用列表表示每个数字。这样你就可以做基本的总结，比如：

```
[1,2,3,4,5,6]
+       [4,5]
_____________
[1,2,3,5,0,1] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T15:20:02.930

将数字表示为整数序列的一种替代方法是将数字基数 2^32 表示为 32 位整数列表，这是许多大整数库所做的。然后，您必须将数字转换为以 10 为底的输出。对于这个特定问题，这对您没有太大帮助-您可以立即编写 2^1000，然后必须除以 10 多次，而不是将 2 自身乘以 1000 次（或者，因为 1000 是 0b1111101000。计算乘积2^8,32,64,128,256,512 使用重复平方 2^8 = (((2^2)^2)^2))) 这需要更多的空间和乘法方法，但操作要少得多) - 更接近正常的大整数使用，所以你可能会发现它在后面的问题中更有用（如果你尝试计算[28433×2^(7830457)+1的最后十位](http://projecteuler.net/index.php?section=problems&id=97)使用 digit-per int 方法和重复加法，可能需要一些时间（尽管在这种情况下，您可以使用模算术，而不是添加数百万位数的字符串）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-08T17:33:05.937

我也在这里发布的工作解决方案：[http ://www.mycoding.net/2012/01/solution-to-project-euler-problem-16/](http://www.mycoding.net/2012/01/solution-to-project-euler-problem-16/)

编码：

```
import java.math.BigInteger;
public class Euler16 {

public static void main(String[] args) {
    int power = 1;
    BigInteger expo = new BigInteger("2");
    BigInteger num = new BigInteger("2");
    while(power < 1000){
        expo = expo.multiply(num);
        power++;
    }
    System.out.println(expo);   //Printing the value of 2^1000
    int sum = 0;
    char[] expoarr = expo.toString().toCharArray();
    int max_count = expoarr.length;
    int count = 0;
    while(count<max_count){ //While loop to calculate the sum of digits
        sum = sum + (expoarr[count]-48);
        count++;
    }
    System.out.println(sum);
}
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-02T18:54:08.917

[欧拉问题 #16](https://projecteuler.net/index.php?section=problems&id=16)已经在这里讨论过很多次，但我找不到一个答案，可以很好地概述可能的解决方法，就像它的情况一样。这是我纠正这一点的尝试。

本概述适用于**已经找到解决方案**并希望获得更全面了解的人。即使示例代码是 C#，它也基本上与语言无关。有一些在 C# 2.0 中不可用的功能的用法，但它们不是必需的 - 它们的目的只是让无聊的东西以最少的大惊小怪消失。

除了使用现成的 BigInteger 库（不计算在内）之外，Euler #16 的直接解决方案分为两个基本类别：本地执行计算 - 即在一个为 2 的幂的基础中 - 并按顺序转换为十进制获取数字，或直接以十进制为基数执行计算，以便无需任何转换即可使用数字。

对于后者，有两个相当简单的选择：

*   重复加倍
*   通过重复平方供电

# 本机计算 + 基数转换

这种方法是最简单的，其性能超过了使用 .Net 内置`BigInteger`类型的简单解决方案。

实际的计算很容易实现：只需执行道德等价的`1 << 1000`，通过存储 1000 个二进制零并附加一个单独的二进制 1。

转换也很简单，可以通过编写铅笔和纸的划分方法来完成，为了提高效率，可以选择适当大的“数字”。中间结果的变量需要能够容纳两个“数字”；将适合 a 的小数位数除以`long`2 得到 9 个十进制数字，表示最大元数字（或“肢体”，因为它通常在 bignum 传说中被称为）。

```
class E16_RadixConversion
{
    const int BITS_PER_WORD = sizeof(uint) * 8;
    const uint RADIX = 1000000000;  // == 10^9

    public static int digit_sum_for_power_of_2 (int exponent)
    {
        var dec = new List<int>();
        var bin = new uint[(exponent + BITS_PER_WORD) / BITS_PER_WORD];
        int top = bin.Length - 1;

        bin[top] = 1u << (exponent % BITS_PER_WORD);

        while (top >= 0)
        {
            ulong rest = 0;

            for (int i = top; i >= 0; --i)
            {
                ulong temp = (rest << BITS_PER_WORD) | bin[i];
                ulong quot = temp / RADIX;  // x64 uses MUL (sometimes), x86 calls a helper function

                rest = temp - quot * RADIX;         
                bin[i] = (uint)quot;
            }

            dec.Add((int)rest);

            if (bin[top] == 0)
                --top;
        }

        return E16_Common.digit_sum(dec);
    }
} 
```

我写`(rest << BITS_PER_WORD) | big[i]`而不是使用 operator + 因为这正是这里需要的；不需要进行带有进位传播的 64 位加法。这意味着两个操作数可以直接写入寄存器对中的单独寄存器，或者写入等价结构中的字段，如`LARGE_INTEGER`.

在 32 位系统上，64 位除法不能作为几条 CPU 指令内联，因为编译器无法知道算法保证商和余数适合 32 位寄存器。因此，编译器调用一个可以处理所有可能性的辅助函数。

这些系统可能会受益于使用较小的肢体，即`RADIX = 10000`，`uint`而不是`ulong`保持中间（双肢）结果。像 C/C++ 这样的语言的另一种选择是调用一个合适的编译器内在函数，它将原始 32 位乘以 32 位到 64 位乘法（假设除以常数基数是通过与逆相乘来实现的） . 相反，在 64 位系统上，如果编译器提供合适的 64×64 到 128 位乘法原语或允许内联汇编程序，则肢体大小可以增加到 19 位。

# 十进制加倍

重复加倍似乎是每个人的最爱，所以接下来让我们这样做。中间结果的变量需要保存一个“数字”加上一个进位位，这为`long`. Going to`ulong`不能改善事情（19 位数字加上进位缺少 0.04 位），所以我们不妨坚持使用`long`.

在二进制计算机上，小数边与计算机字边界不一致。这使得有必要在计算的每个步骤中对肢体执行模运算。在这里，这个模运算可以在进位的情况下减少为模的减法，这比执行除法要快。内部循环中的分支可以通过位旋转来消除，但这对于基本算法的演示来说是不必要的模糊。

```
class E16_DecimalDoubling
{
    const int DIGITS_PER_LIMB = 18;                  // == floor(log10(2) * (63 - 1)), b/o carry
    const long LIMB_MODULUS = 1000000000000000000L;  // == 10^18

    public static int digit_sum_for_power_of_2 (int power_of_2) 
    {
        Trace.Assert(power_of_2 > 0);

        int total_digits = (int)Math.Ceiling(Math.Log10(2) * power_of_2);
        int total_limbs = (total_digits + DIGITS_PER_LIMB - 1) / DIGITS_PER_LIMB;
        var a = new long[total_limbs];
        int limbs = 1;

        a[0] = 2;

        for (int i = 1; i < power_of_2; ++i)
        {
            int carry = 0;

            for (int j = 0; j < limbs; ++j)
            {
                long new_limb = (a[j] << 1) | carry;

                carry = 0;

                if (new_limb >= LIMB_MODULUS)
                {
                    new_limb -= LIMB_MODULUS;
                    carry = 1;
                }

                a[j] = new_limb;
            }

            if (carry != 0)
            {
                a[limbs++] = carry;
            }
        }

        return E16_Common.digit_sum(a);
    }
} 
```

这与基数转换一样简单，但除了非常小的指数外，它的性能几乎没有（尽管它有 18 个小数位的巨大元数字）。原因是代码必须执行 (exponent - 1) 加倍，并且每次传递中所做的工作对应于大约一半的数字（肢体）总数。

# 重复平方

通过重复平方供电背后的想法是用少量乘法代替大量的加倍。

```
1000 = 2^3 + 2^5 + 2^6 + 2^7 + 2^8 + 2^9

x^1000 = x^(2^3 + 2^5 + 2^6 + 2^7 + 2^8 + 2^9)

x^1000 = x^2^3 * x^2^5 * x^2^6 * x^2^7 * x^2*8 * x^2^9 
```

x^2^3 可以通过 x 3 次平方得到，x^2^5 可以通过 5 次平方得到，以此类推。在二进制计算机上，很容易将指数分解为 2 的幂，因为它是表示该数字的位模式。然而，即使是非二进制计算机也应该能够测试一个数字是奇数还是偶数，或者将一个数字除以二。

乘法可以通过编写铅笔和纸的方法来完成；在这里，我使用了一个辅助函数，该函数计算一行乘积并将其添加到结果中适当移动的位置，以便以后不需要存储部分乘积的行以用于单独的加法步骤。计算过程中的中间值可以达到两个“数字”的大小，因此四肢的宽度只能是重复加倍的一半（其中除了“数字”之外，只需要添加一个额外的位）。

注意：计算的基数不是 2 的幂，因此这里不能通过简单的移位来计算 2 的平方。从积极的方面来说，该代码可用于计算 2 以外的碱基的计算能力。

```
class E16_DecimalSquaring
{
    const int DIGITS_PER_LIMB = 9;  // language limit 18, half needed for holding the carry
    const int LIMB_MODULUS = 1000000000;

    public static int digit_sum_for_power_of_2 (int e)
    {
        Trace.Assert(e > 0);

        int total_digits = (int)Math.Ceiling(Math.Log10(2) * e);
        int total_limbs = (total_digits + DIGITS_PER_LIMB - 1) / DIGITS_PER_LIMB;
        var squared_power = new List<int>(total_limbs) { 2 };
        var result = new List<int>(total_limbs);

        result.Add((e & 1) == 0 ? 1 : 2);

        while ((e >>= 1) != 0)
        {
            squared_power = multiply(squared_power, squared_power);

            if ((e & 1) == 1)
                result = multiply(result, squared_power);
        }

        return E16_Common.digit_sum(result);
    }

    static List<int> multiply (List<int> lhs, List<int> rhs)
    {
        var result = new List<int>(lhs.Count + rhs.Count);

        resize_to_capacity(result);

        for (int i = 0; i < rhs.Count; ++i)
            addmul_1(result, i, lhs, rhs[i]);

        trim_leading_zero_limbs(result);

        return result;
    }

    static void addmul_1 (List<int> result, int offset, List<int> multiplicand, int multiplier)
    {
        // it is assumed that the caller has sized `result` appropriately before calling this primitive
        Trace.Assert(result.Count >= offset + multiplicand.Count + 1);

        long carry = 0;

        foreach (long limb in multiplicand)
        {
            long temp = result[offset] + limb * multiplier + carry;
            carry = temp / LIMB_MODULUS;
            result[offset++] = (int)(temp - carry * LIMB_MODULUS);
        }

        while (carry != 0)
        {
            long final_temp = result[offset] + carry;
            carry = final_temp / LIMB_MODULUS;
            result[offset++] = (int)(final_temp - carry * LIMB_MODULUS);
        }
    }

    static void resize_to_capacity (List<int> operand)
    {
        operand.AddRange(Enumerable.Repeat(0, operand.Capacity - operand.Count));
    }

    static void trim_leading_zero_limbs (List<int> operand)
    {
        int i = operand.Count;

        while (i > 1 && operand[i - 1] == 0)
            --i;

        operand.RemoveRange(i, operand.Count - i);
    }   
} 
```

这种方法的效率与基数转换大致相当，但这里有一些特定的改进。通过编写一个特殊的平方例程，可以将平方的效率加倍，该例程利用`ai*bj == aj*bi`if`a == b`将乘法次数减半。

此外，与使用指数位来确定平方/乘法调度相比，有一些计算加法链的方法总体上涉及更少的操作。

# 辅助代码和基准

示例代码生成的元数字（十进制肢体）中的十进制数字求和的帮助代码是微不足道的，但为了您的方便，我还是在这里发布它：

```
internal class E16_Common
{
    internal static int digit_sum (int limb)
    {
        int sum = 0;

        for ( ; limb > 0; limb /= 10)
            sum += limb % 10;

        return sum;
    }

    internal static int digit_sum (long limb)
    {
        const int M1E9 = 1000000000;

        return digit_sum((int)(limb / M1E9)) + digit_sum((int)(limb % M1E9));
    }

    internal static int digit_sum (IEnumerable<int> limbs)
    {
        return limbs.Aggregate(0, (sum, limb) => sum + digit_sum(limb));
    }

    internal static int digit_sum (IEnumerable<long> limbs)
    {
        return limbs.Select((limb) => digit_sum(limb)).Sum();
    }
} 
```

这可以通过各种方式提高效率，但总体而言并不重要。

所有三个解决方案都需要 O(n^2) 时间，其中 n 是指数。换句话说，当指数增长十倍时，它们将花费一百倍的时间。通过采用分而治之的策略，基数转换和重复平方都可以提高到大约 O(n log n)；我怀疑是否可以以类似的方式改进加倍计划，但从一开始就没有竞争力。

这里介绍的所有三种解决方案都可用于打印实际结果，方法是使用适当的填充将元数字串起来并将它们连接起来。我将函数编码为返回数字总和而不是带有小数肢体的数组/列表，只是为了保持示例代码简单并确保所有函数具有相同的签名，以进行基准测试。

在这些基准测试中，.Net BigInteger 类型的包装如下：

```
static int digit_sum_via_BigInteger (int power_of_2)
{
    return System.Numerics.BigInteger.Pow(2, power_of_2)
        .ToString()
        .ToCharArray()
        .Select((c) => (int)c - '0')
        .Sum();
} 
```

最后，C# 代码的基准测试：

```
# testing decimal doubling ...

   1000:    1366 in      0,052 ms
  10000:   13561 in      3,485 ms
 100000:  135178 in    339,530 ms
1000000: 1351546 in 33.505,348 ms

# testing decimal squaring ...

   1000:    1366 in      0,023 ms
  10000:   13561 in      0,299 ms
 100000:  135178 in     24,610 ms
1000000: 1351546 in  2.612,480 ms

# testing radix conversion ...

   1000:    1366 in      0,018 ms
  10000:   13561 in      0,619 ms
 100000:  135178 in     60,618 ms
1000000: 1351546 in  5.944,242 ms

# testing BigInteger + LINQ ...

   1000:    1366 in      0,021 ms
  10000:   13561 in      0,737 ms
 100000:  135178 in     69,331 ms
1000000: 1351546 in  6.723,880 ms 
```

如您所见，基数转换几乎与使用内置 BigInteger 类的解决方案一样慢。原因是运行时是较新的类型，它只对有符号整数类型执行某些标准优化，而不对无符号整数类型执行某些标准优化（这里：实现除以常数作为与逆的乘法）。

我还没有找到一种简单的方法来检查现有 .Net 程序集的本机代码，因此我决定采用不同的调查路径：我编写了一个变体，`E16_RadixConversion`用于比较 where`ulong`和`uint`分别由 和 替换，`long`并`int`相应地`BITS_PER_WORD`减少 1。以下是时间安排：

```
# testing radix conv Int63 ...

   1000:    1366 in      0,004 ms
  10000:   13561 in      0,202 ms
 100000:  135178 in     18,414 ms
1000000: 1351546 in  1.834,305 ms 
```

比使用无符号类型的版本快三倍多！编译器中 numbskullery 的明显证据......

为了展示不同肢体大小的影响，我在 C++ 中对用作肢体的无符号整数类型的解决方案进行了模板化。计时以肢体的字节大小和肢体中的小数位数为前缀，用冒号分隔。对于在字符串中处理数字字符的常见情况没有时间安排，但可以肯定地说，这样的代码将花费至少两倍于在字节大小的肢体中使用两位数的代码。

```
# E16_DecimalDoubling

[1:02] e =    1000 ->    1366      0.308 ms
[2:04] e =    1000 ->    1366      0.152 ms
[4:09] e =    1000 ->    1366      0.070 ms
[8:18] e =    1000 ->    1366      0.071 ms

[1:02] e =   10000 ->   13561     30.533 ms
[2:04] e =   10000 ->   13561     13.791 ms
[4:09] e =   10000 ->   13561      6.436 ms
[8:18] e =   10000 ->   13561      2.996 ms

[1:02] e =  100000 ->  135178   2719.600 ms
[2:04] e =  100000 ->  135178   1340.050 ms
[4:09] e =  100000 ->  135178    588.878 ms
[8:18] e =  100000 ->  135178    290.721 ms

[8:18] e = 1000000 -> 1351546  28823.330 ms 
```

对于 10^6 的指数，只有 64 位肢体的时间，因为我没有耐心等待几分钟才能获得完整的结果。图片与基数转换类似，只是没有 64 位肢体的行，因为我的编译器没有原生的 128 位整数类型。

```
# E16_RadixConversion

[1:02] e =    1000 ->    1366      0.080 ms
[2:04] e =    1000 ->    1366      0.026 ms
[4:09] e =    1000 ->    1366      0.048 ms

[1:02] e =   10000 ->   13561      4.537 ms
[2:04] e =   10000 ->   13561      0.746 ms
[4:09] e =   10000 ->   13561      0.243 ms

[1:02] e =  100000 ->  135178    445.092 ms
[2:04] e =  100000 ->  135178     68.600 ms
[4:09] e =  100000 ->  135178     19.344 ms

[4:09] e = 1000000 -> 1351546   1925.564 ms 
```

有趣的是，简单地将代码编译为 C++ 并不能使其更快 - 即，优化器找不到 C# 抖动错过的任何低悬的果实，除了在惩罚无符号整数方面没有遵守规定. 这就是我喜欢在 C# 中进行原型设计的原因——性能与（未优化的）C++ 相同，而且没有任何麻烦。

这是 C++ 版本的精髓（没有大量无聊的东西，如帮助模板等），因此您可以看到我并没有为了让 C# 看起来更好而作弊：

```
template<typename W>
struct E16_RadixConversion
{
   typedef W limb_t;
   typedef typename detail::E16_traits<W>::long_t long_t;

   static unsigned const BITS_PER_WORD = sizeof(limb_t) * CHAR_BIT;
   static unsigned const RADIX_DIGITS = std::numeric_limits<limb_t>::digits10;
   static limb_t const RADIX = detail::pow10_t<limb_t, RADIX_DIGITS>::RESULT;

   static unsigned digit_sum_for_power_of_2 (unsigned e)
   {
      std::vector<limb_t> digits;

      compute_digits_for_power_of_2(e, digits);

      return digit_sum(digits);
   }

   static void compute_digits_for_power_of_2 (unsigned e, std::vector<limb_t> &result)
   {
      assert(e > 0);

      unsigned total_digits = unsigned(std::ceil(std::log10(2) * e));
      unsigned total_limbs = (total_digits + RADIX_DIGITS - 1) / RADIX_DIGITS;

      result.resize(0);
      result.reserve(total_limbs);

      std::vector<limb_t> bin((e + BITS_PER_WORD) / BITS_PER_WORD);

      bin.back() = limb_t(limb_t(1) << (e % BITS_PER_WORD));

      while (!bin.empty())
      {
         long_t rest = 0;

         for (std::size_t i = bin.size(); i-- > 0; )
         {
            long_t temp = (rest << BITS_PER_WORD) | bin[i];
            long_t quot = temp / RADIX;

            rest = temp - quot * RADIX;
            bin[i] = limb_t(quot);
         }

         result.push_back(limb_t(rest));

         if (bin.back() == 0)
            bin.pop_back();
      }
   }
}; 
```

# 结论

这些基准测试还表明，这个欧拉任务 - 与许多其他任务一样 - 似乎旨在在 ZX81 或 Apple ][ 上解决，而不是在功能强大一百万倍的现代玩具上解决。除非限制急剧增加（10^5 或 10^6 的指数更合适），否则这里不涉及任何挑战。

可以从[GMP 的算法概述中获得对](https://gmplib.org/manual/Algorithms.html#Algorithms)*现有*技术的一个很好的概述。算法的另一个很好的概述是理查德布伦特和保罗齐默尔曼的“现代计算机算术”的第 1 章。它包含了一个人在编码挑战和比赛中需要知道的内容，但不幸的是，深度不等于 Donald Knuth 在“计算机编程的艺术”中的处理方式。

基数转换解决方案为代码挑战工具箱添加了一项有用的技术，因为可以轻松扩展给定代码以转换任何旧的大整数，而不仅仅是位模式`1 << exponent`。重复平方解法可能同样有用，因为将示例代码更改为除 2 以外的其他东西再次变得微不足道。

直接以 10 的幂次执行计算的方法对于需要小数结果的挑战很有用，因为性能与本机计算处于同一水平，但不需要单独的转换步骤（这可能需要与实际计算）。

# java - Java——必须抛出异常，但是如何抛出？

> ID：677582
> 
> 赞同：3
> 
> 时间：2009-03-24T14:13:35.290
> 
> 标签：java, sql, exception

我在 NetBeans 中收到一个错误，说我必须在这个方法中抛出一个 SQLException：

```
private void displayCustomerInfo(java.awt.event.ActionEvent evt)                                     
{                                         
    int custID = Integer.parseInt(customerID.getText());
    String info = getCustomerInfo(custID);
    results.setText(info);
} 
```

此方法由 NetBeans 创建，因此不允许我编辑签名并引发异常。这就是我创建该`getCustomerInfo()`方法的原因。此方法确实会引发异常，因为它使用一种方法从数据库中检索有关客户的信息。

```
public String getCustomerInfo(int cid) throws SQLException
{
    Customer c = proc.getCustomer(cid);
    // get info
    return "info";
} 
```

该`getCustomer`方法还会引发异常并编译 proc.java。

确切的错误是

```
unreported exception java.sql.SQLException; must be caught or declared to be thrown 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T14:17:31.317

通常，如果您的代码需要抛出签名不支持的 Exception 类型，并且您无法控制接口，则可以捕获并重新抛出接口支持的类型。如果你的接口没有声明任何检查异常，你总是可以抛出一个 RuntimeException：

```
private void displayCustomerInfo(java.awt.event.ActionEven evt)                                     
{        
    try
    {                                 
        int custID = Integer.parseInt(customerID.getText());
        String info = getCustomerInfo(custID);
        results.setText(info);  
    }
    catch (SQLException ex)
    {
        throw new RuntimeException(ex);  // maybe create a new exception type?
    }
} 
```

您几乎肯定想要创建一个扩展 RuntimeException 的新异常类型，并让您的客户端代码捕获该异常。否则，您将面临捕获任何 RuntimeException 的风险，包括 NullPointerException、ArrayIndexOutOfBoundsException 等，您的客户端代码可能无法处理这些异常。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-24T14:16:20.977

再次阅读错误消息，它为您提供了两种选择。

您必须将异常声明为已抛出（您不能这样做）或捕获异常。试试第二个选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T14:16:38.653

您需要在对 的调用周围放置一个 try/catch 块`getCustomerInfo()`，如下所示：

```
private void displayCustomerInfo(java.awt.event.ActionEvent evt)                                     
{                                         
    int custID = Integer.parseInt(customerID.getText());
    try {
        String info = getCustomerInfo(custID);
    } catch (SQLException sqle) {
        // Do something with the exception
    }

    results.setText(info);
} 
```

处理异常的几个不错的选择可能是：记录异常和用于获取它的详细信息，或者将其用作重试连接请求的信号。或者，正如 Outlaw Programmer 所示，您可以将 Exception 作为某种 RuntimeException 重新抛出，这消除了检查的要求。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T14:16:35.843

它并没有说你必须扔掉它。它说你可以抓住它。所以使用 try/catch 块并处理它。

```
try {
    ...
}
catch (SQLException e) {
    System.out.println("Exception happened! Abort! Abort!");
    e.printMessage(); //Not sure if this is the correct method name
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-18T19:31:20.303

NetBeans 生成的组件具有不可修改的代码，我猜它是作为 gui 构建器的一部分生成的。我想问是否是这种情况，但我还不能发表评论。如果您在 GUI 编辑器中选择生成的对象，右侧有一个选项卡“代码”，可用于修改代码的灰色区域。

这里：
![用于修改生成代码的代码选项卡。](https://i.stack.imgur.com/NgNmy.jpg)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-12T10:45:48.660

我遇到了这个问题...过去2天一直很困惑..然后我用sublime打开源代码（.java文件），更改代码，保存，它的效果很神奇......我在笑我看到这行得通...认为开箱即用确实有效...

# python - wxPython：制作可滚动的 DC

> ID：677590
> 
> 赞同：1
> 
> 时间：2009-03-24T14:15:29.450
> 
> 标签：python, wxpython, scroll, scrollbar

我正在使用 PaintDC 在 wx.Window 内绘图。我正在那个窗口中画圆圈和类似的东西。问题是，有时圆圈会超出窗口的范围。我希望在绘图变得太大时自动出现滚动条。我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T07:36:46.547

使用 a`wx.ScrolledWindow`并在您的“绘图走出”窗口后立即设置窗口的大小

```
SetVirtualSize(width,height) 
```

如果这个尺寸大于客户端尺寸，那么 wx 将显示滚动条。在窗口中绘图时，请确保使用`CalcUnscrolledPosition`和`CalcScrolledPosition`

[在这里](http://docs.wxwidgets.org/stable/wx_wxscrolledwindow.html)您可以找到更多信息。

# java - 在Java中的构造函数之前初始化最终变量

> ID：677595
> 
> 赞同：8
> 
> 时间：2009-03-24T14:16:15.550
> 
> 标签：java, constructor, variables, initialization, final

是否有在 Java 构造函数中使用最终变量的解决方案？问题是，如果我初始化一个 final 字段，例如：

```
private final String name = "a name"; 
```

那么我不能在构造函数中使用它。Java 首先运行构造函数，然后运行字段。是否有允许我访问构造函数中的最终字段的解决方案？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-24T14:20:14.620

我不太明白你的问题。那

```
public class Test3 {
    private final String test = "test123";

    public Test3() {
        System.out.println("Test = "+test);
    }

    public static void main(String[] args) {
        Test3 t = new Test3();
    }
} 
```

执行如下：

```
$ javac Test3.java && java Test3
Test = test123 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-24T14:18:07.183

在构造函数中进行初始化，例如，

```
private final String name;
private YourObj() {
    name = "a name";
} 
```

当然，如果您确实知道变量声明时的值，则将其设为常量更有意义，例如，

```
private static final String NAME = "a name"; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-09-09T13:59:53.077

我们正在远离这个问题。

是的，您可以使用`private final`变量。例如：

```
public class Account {
    private final String accountNumber;
    private final String routingNumber;

    public Account(String accountNumber, String routingNumber) {
        this.accountNumber = accountNumber;
        this.routingNumber = routingNumber;
    }
} 
```

这意味着 Account 类依赖于两个字符串，即帐号和路由号码。这些类属性的值必须在构造 Account 类时设置，并且在不创建新类的情况下不能更改这些数字。

这里的“final”修饰符使属性不可变。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T14:21:56.283

将其标记为静态，将允许您在构造函数中使用它，但由于您将其设为最终状态，因此无法更改。

```
private static final String name = "a_name"; 
```

也可以使用静态初始化块。

```
private static final String name;

static { name = "a_name"; } 
```

如果您尝试修改构造函数中的值，则不能分配默认值，或者必须使其不是最终值。

```
private String name = "a_name";
Foo( String name )
{
    this.name = name;
} 
```

或者

```
private final String name;

Foo( String name )
{
    if( s == null )
       this.name = "a_name";
    else
       this.name = name;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T14:18:33.860

在这种情况下，您也可以将该字段标记为“静态”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-24T14:55:02.647

另一种可能性是在实例初始化程序块中初始化字段：

```
public class Foo {
        final String bar;

        {
                System.out.println("initializing bar");
                bar = "created at " + System.currentTimeMillis();
        }

        public Foo() {
                System.out.println("in constructor. bar=" + bar);

        }

        public static void main(String[] args) {
                new Foo();
        }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T14:18:52.313

在这种情况下，您也可以将其设为静态。Java 约定是在 ALL_CAPS 中命名这些常量。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-24T14:21:06.973

```
private static final String name = getName(); 
```

其中*getName()*是一个静态函数，可以为您获取名称。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-24T14:51:40.830

> 我不能在构造函数中使用它，而java首先运行构造函数然后是字段......

这是不正确的，首先评估字段，否则您无法访问构造函数中成员的任何默认值，因为它们不会被初始化。这*确实*有效：

```
public class A {
    protected int member = 1;
    public A() {
        System.out.println(member);
    }
} 
```

关键字*final*仅标记成员常量，否则将其视为任何其他成员。

编辑：您是否尝试在构造函数中*设置*值？那是行不通的，因为如果定义为最终成员，则该成员是不可变的。

# tfs - TFS：将团队项目从一台服务器移动到另一台服务器？

> ID：677608
> 
> 赞同：18
> 
> 时间：2009-03-24T14:18:38.587
> 
> 标签：tfs, administration

有没有一种（简单的）方法可以将单个 TeamProject 从一台服务器移动到另一台服务器？包括源代码、工作项、文档、项目站点...

我们不想将服务器从一台机器移动到另一台机器。从服务器 A 到服务器 B 只是一个项目。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-24T14:34:00.607

你有两个选择

1.  您可以使用 TFS 到 TFS 迁移工具：[单击此处](http://tfstotfsmigration.codeplex.com/)。这不包括 WSS 项目站点。

2.  或者您可以备份您的 TFS 数据库并在新的 TFS 实例上恢复，然后使用[TFSDeleteProject.exe 工具](http://msdn.microsoft.com/en-us/library/ms181482.aspx)删除您不想要的项目。

后一个选项是最简单的，但不会将备份的项目与目标实例上的任何现有项目合并。现有项目将丢失。WSS 站点也可以以这种方式移动。请参见[如何：备份 Team Foundation Server](http://msdn.microsoft.com/en-us/library/ms253070.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-15T07:22:46.227

TFS 到 TFS 迁移工具已过时。您正在寻找的功能是 TFS 集成平台的一部分。

转到[http://tfsintegration.codeplex.com/](http://tfsintegration.codeplex.com/)了解更多信息。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-15T18:37:46.880

在 TFS 2010 中，您可以使用 TFS 管理控制台分离项目集合数据库，然后将其重新附加到另一个 TFS 服务器。 [http://msdn.microsoft.com/en-us/library/dd936138.aspx](http://msdn.microsoft.com/en-us/library/dd936138.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T23:27:43.933

如果您希望将整个项目集合从一个 TFS 服务器移动到另一个：

1) 通过管理控制台分离集合。

2) 使用 SSMS 备份 Tfs_SomethingCollection 数据库，然后将其恢复到其他数据库服务器。

3) 在第二个 TFS 管理控制台上，附加项目集合。它将显示为可以附加的可用集合，因为它已在第二个 sql server 实例中恢复。

我没有迁移 Tfs_Configuration 数据库。就我而言，我没有使用报告服务、构建服务或共享点。

我还没有安装第二台 TFS 服务器，想知道在安装时选择哪些选项，以及是否应该在恢复迁移的数据库之后或之前安装它（这并不重要）：在第二台机器上安装 TFS。如果 TFS 及其数据库实例将位于单独的服务器上，则选择高级配置并指定数据库服务器实例的名称。当您有机会创建 DefaultCollection 时，请选择跳过该步骤。安装将在新服务器上创建一个新的 Tfs_Configuration DB。然后按照上述步骤将采集数据库迁移到新的数据库服务器实例并附加。

程序员需要将新服务器添加到团队资源管理器中，并为每个解决方案连续两次点击更改源代码控制...。确保本地路径映射正确，然后绑定每个解决方案/项目。

# c# - WinForm UserControl 的通用基类

> ID：677609
> 
> 赞同：38
> 
> 时间：2009-03-24T14:18:38.693
> 
> 标签：c#, .net, winforms, visual-studio-2008, windows-forms-designer

我为 WinForm UserControl 创建了一个通用基类：

```
public partial class BaseUserControl<T> : UserControl
{
    public virtual void MyMethod<T>() 
    { 
        // some base stuff here 
    }
} 
```

以及基于此的 UserControl：

```
public partial class MyControl : BaseUserControl<SomeClass>
{
    public override void MyMethod<SomeClass>() 
    { 
        // some specific stuff here 
        base.MyMethod<SomeClass>();
    }
} 
```

它工作正常，但无法在 VisualStudio 设计器中编辑 MyControl，因为它说它无法加载基类。我试图定义另一个类 BaseUserControl，非泛型，希望它能加载它，但这个技巧似乎不起作用。

我已经有一个解决方法：定义一个接口 IMyInterface<T>，然后将我的控件创建为

```
public partial class MyControl : UserControl, IMyInterface<SomeClass> 
```

但是我失去了我的基本虚拟方法（没什么大不了的，但仍然......）。

有没有办法为 UserControl 创建一个基本的泛型类，并可以在 VisualStudio 设计器中对其进行编辑？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-24T14:25:00.647

我们正在做同样的事情，我们通过首先专门化一个类并从专门化类派生来解决问题。使用您示例中的代码，这意味着：

```
public partial class UserControl : UserControlDesignable 
{

...
}
public class UserControlDesignable : BaseUserControl<Someclass> { } 
```

设计师有时仍然表现得有些古怪——但大多数时候它是有效的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-24T14:27:58.813

您必须通过添加一个从您的通用基本形式继承的“常规”类来欺骗设计者。然后，您的可设计表单应该从此类继承。因此，以下 2 个类定义在同一个文件中。您必须确保从通用基本用户控件继承的类是文件中的最后一个类。

```
public MyForm : EditableCustomerForm
{}

public EditableCustomerForm : GenericForm<Customer>
{} 
```

设计器将在它遇到的代码文件中显示第一个类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-13T19:38:53.500

好吧，这似乎是 Visual Studio 中的一个错误。

通过深入研究框架（实际上是通过添加一个`RootDesignerSerializer`派生自该方法的自定义类型`CodeDomSerializer`并覆盖该`serialize`方法），我能够证明 VS Code Dom 提供程序实际上解析了错误的泛型类，而不是将其视为泛型类它正在将其视为具有 name 的常规类`class<T>`，`Type.GetType()`当然找不到。

我仍在寻找一种解决方法，但同时可以使用上述解决方案。

有一个 Microsoft.Connect 错误报告，请在[https://connect.microsoft.com/VisualStudio/feedback/details/797279/win-forms-designer-error-when-inheriting-from-a-上投票通用形式](https://connect.microsoft.com/VisualStudio/feedback/details/797279/win-forms-designer-error-when-inheriting-from-a-generic-form)

# g++ - 有人可以解释 g++ 3.4.2 和 g++ 4.1.2 之间的链接器区别吗？

> ID：677614
> 
> 赞同：0
> 
> 时间：2009-03-24T14:19:55.133
> 
> 标签：g++, linker, compiler-construction

我只是将一些代码从一个平台移动到另一个需要更改编译器版本的代码。其中两个实用程序源导致了与未定义符号的链接问题，在本示例中将它们称为 Foo.c 和 Foo.h。

一切都在用 g++ 3.4.2 编译和链接，我认为切换到 g++ 4.1.2 将是不费吹灰之力。使用 4.1.2 时编译正常，但由于未定义的符号链接失败。在其他源文件中使用的 Foo 中每个函数的符号，即。即使 Foo.h 包含在 Bar.c 中，Bar.c 也未定义。

问题是 Foo.c 文件不包含 Foo.h。那么问题来了，g++ 3.4.2 是如何在 4.1.2 不能链接的时候链接这段代码的呢？我认为 3.4.2 期待一个 .h 文件，然后“神奇地”包含它以避免这个问题。但是有人有更好的解释吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T14:59:42.497

3.4 和 4.1 之间存在 ABI 差异，因此请确保您已经清理并重新编译了项目。并更新了您链接的所有库。

# c++ - 我需要显式调用基本虚拟析构函数吗？

> ID：677620
> 
> 赞同：401
> 
> 时间：2009-03-24T14:22:10.247
> 
> 标签：c++, destructor

当在 C++ 中重写一个类（使用虚拟析构函数）时，我在继承类上再次将析构函数实现为虚拟，但是我需要调用基本析构函数吗？

如果是这样，我想它是这样的......

```
MyChildClass::~MyChildClass() // virtual in header
{
    // Call to base destructor...
    this->MyBaseClass::~MyBaseClass();

    // Some destructing specific to MyChildClass
} 
```

我对吗？

* * *

## 回答 #1

> 赞同：540
> 
> 时间：2009-03-24T14:23:51.927

不，析构函数会以与构造相反的顺序自动调用。（最后是基类）。不要调用基类析构函数。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2009-03-24T14:23:20.477

不，您不需要调用基析构函数，派生析构函数始终为您调用基析构函数。 [请在此处查看我的相关答案以了解销毁顺序](https://stackoverflow.com/questions/654428/what-is-the-order-in-which-the-destructors-and-the-constructors-are-called-in-c/654432#654432)。

要了解为什么要在基类中使用虚拟析构函数，请查看以下代码：

```
class B
{
public:
    virtual ~B()
    {
        cout<<"B destructor"<<endl;
    }
};

class D : public B
{
public:
    virtual ~D()
    {
        cout<<"D destructor"<<endl;
    }
}; 
```

当你这样做时：

```
B *pD = new D();
delete pD; 
```

然后，如果您在 B 中没有虚拟析构函数，则只会调用 ~B()。但是因为你有一个虚拟析构函数，所以首先调用~D()，然后调用~B()。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-03-24T14:29:34.363

其他人所说的，但还要注意，您不必在派生类中声明析构函数 virtual 。一旦你声明了一个虚拟的析构函数，就像你在基类中所做的那样，所有派生的析构函数都将是虚拟的，无论你是否声明它们。换句话说：

```
struct A {
   virtual ~A() {}
};

struct B : public A {
   virtual ~B() {}   // this is virtual
};

struct C : public A {
   ~C() {}          // this is virtual too
}; 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2017-09-21T19:51:49.110

不，你永远不会调用基类析构函数，它总是像其他人指出的那样被自动调用，但这里有结果的概念证明：

```
class base {
public:
    base()  { cout << __FUNCTION__ << endl; }
    ~base() { cout << __FUNCTION__ << endl; }
};

class derived : public base {
public:
    derived() { cout << __FUNCTION__ << endl; }
    ~derived() { cout << __FUNCTION__ << endl; } // adding call to base::~base() here results in double call to base destructor
};

int main()
{
    cout << "case 1, declared as local variable on stack" << endl << endl;
    {
        derived d1;
    }

    cout << endl << endl;

    cout << "case 2, created using new, assigned to derive class" << endl << endl;
    derived * d2 = new derived;
    delete d2;

    cout << endl << endl;

    cout << "case 3, created with new, assigned to base class" << endl << endl;
    base * d3 = new derived;
    delete d3;

    cout << endl;

    return 0;
} 
```

输出是：

```
case 1, declared as local variable on stack

base::base
derived::derived
derived::~derived
base::~base

case 2, created using new, assigned to derive class

base::base
derived::derived
derived::~derived
base::~base

case 3, created with new, assigned to base class

base::base
derived::derived
base::~base

Press any key to continue . . . 
```

如果您将基类析构函数设置为虚拟的，那么情况 3 的结果将与情况 1 和 2 相同。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2019-10-11T14:16:32.833

**只有在声明了基类析构函数时**，C++中的析构函数才会自动按照它们的构造顺序（先派生然后基）**被调用**。**`virtual`**

如果不是，则在删除对象时仅调用基类析构函数。

**示例：没有虚拟析构函数**

```
#include <iostream>

using namespace std;

class Base{
public:
  Base(){
    cout << "Base Constructor \n";
  }

  ~Base(){
    cout << "Base Destructor \n";
  }

};

class Derived: public Base{
public:
  int *n;
  Derived(){
    cout << "Derived Constructor \n";
    n = new int(10);
  }

  void display(){
    cout<< "Value: "<< *n << endl;
  }

  ~Derived(){
    cout << "Derived Destructor \n";
  }
};

int main() {

 Base *obj = new Derived();  //Derived object with base pointer
 delete(obj);   //Deleting object
 return 0;

} 
```

输出

```
Base Constructor
Derived Constructor
Base Destructor 
```

**示例：使用 Base 虚拟析构函数**

```
#include <iostream>

using namespace std;

class Base{
public:
  Base(){
    cout << "Base Constructor \n";
  }

  //virtual destructor
  virtual ~Base(){
    cout << "Base Destructor \n";
  }

};

class Derived: public Base{
public:
  int *n;
  Derived(){
    cout << "Derived Constructor \n";
    n = new int(10);
  }

  void display(){
    cout<< "Value: "<< *n << endl;
  }

  ~Derived(){
    cout << "Derived Destructor \n";
    delete(n);  //deleting the memory used by pointer
  }
};

int main() {

 Base *obj = new Derived();  //Derived object with base pointer
 delete(obj);   //Deleting object
 return 0;

} 
```

输出

```
Base Constructor
Derived Constructor
Derived Destructor
Base Destructor 
```

建议声明基类析构函数，`virtual`否则会导致未定义的行为。

*参考：[虚拟析构函数](https://pencilprogrammer.com/cpp-tutorials/virtual-destructor/)*

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-03-24T14:34:07.427

不。与其他虚拟方法不同，您会从 Derived 显式调用 Base 方法以“链接”调用，编译器生成代码以按照调用构造函数的相反顺序调用析构函数。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-24T14:23:30.680

不，它是自动调用的。

# c# - 无法向 Visual C# 2008 express 添加资源？

> ID：677628
> 
> 赞同：0
> 
> 时间：2009-03-24T14:24:11.350
> 
> 标签：c#, visual-studio, visual-studio-2008, resources

我正在尝试将图像添加到我的应用程序的资源区域并且运气不佳。这在 C# express 中被破坏了吗？

我试过了：

1.  使用“添加->现有项目”将图像添加到项目。我已将其标记为“内容”、“资源”和“嵌入式资源”，但没有任何效果。

这是c#代码：

```
ResourceManager oResource = new ResourceManager("MyApp.images", Assembly.GetExecutingAssembly());
oResource.IgnoreCase = true;
m_oBedState = (Bitmap)oResource.GetObject("MyImage.bmp"); 
```

我尝试在项目中打开 resource1.resx 文件并将其添加到那里。还是找不到。

另外，自动创建的 resource1.designer.cs 是怎么回事？为什么我需要这里的代码？我在资源区中嵌入了一个二进制文件。它不需要更多的代码膨胀。我不需要“没有 steenkin 徽章”；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T15:13:39.920

添加资源时，它会删除文件的扩展名。您的查找必须与分配的名称完全匹配，并且没有扩展名。

# asp.net - 更新面板中的asp.net gridview，使内容可见并更新

> ID：677629
> 
> 赞同：0
> 
> 时间：2009-03-24T14:24:15.390
> 
> 标签：asp.net, gridview, updatepanel

目前，我的页面上有一个动态创建的网格视图。当用户在文本框中输入内容并按下按钮时，整个页面都会刷新以填充 gridview 并使其可见。我不想再那样了。我将如何使用 UpdatePanel 使 gridview 可见并填充它？

```
<div class="span-93 prepend-2 top">
        <strong>Enter  Number</strong><br />
        <asp:TextBox ID="PartNumber" runat="server" Width="100"></asp:TextBox>
        <asp:Button ID="CreateButton" runat="server" Width="85" Text="Locate" OnClick="CreateButton_Click" />
    </div>
<asp:Label ID="Select" runat="server" Font-Bold="true" Text="Select choice" Visible="false"></asp:Label><br />
            <ajax:UpdatePanel ID="UpdatePanel" runat="server" UpdateMode="Conditional">
                <ContentTemplate>
                    <asp:GridView ID="GridView" Visible="false" runat="server"  HeaderStyle-Width="200" HeaderStyle-BackColor="#2B6292" HeaderStyle-ForeColor="White" 
                    AllowSorting="true" AllowPaging="true" Width="600" AutoGenerateColumns="False" OnRowCreated="GridView_OnRowCreated" 
                    DataKeyNames="Id" onsorting="GridView_OnSort">
                        <Columns>
                            ...
                        </Columns>
                    </asp:GridView>
                </ContentTemplate>
                <Triggers>
                    <ajax:AsyncPostBackTrigger ControlID="CreateButton"/>
                </Triggers>
            </ajax:UpdatePanel> 
```

页面上还有一个名为 CreateButton 的按钮，显然，它将填充 gridview 并使其可见，以便用户可以从中进行选择。这可能吗？提前致谢。

编辑：将代码绑定到gridview：

```
 protected void Create_Click(object sender, EventArgs e)
        {
            if (!String.IsNullOrEmpty(Number.Text))
            {
                BLL newbll = new BLL();
                Database.DataTable tempTable = newbll.GetItemByPartNumber(Number.Text);

                if (Table.Count != 0)
                {
                DataTable table = tempTable ;

                string[] VID = { "Id" };
                GridviewDiv.Visible = true;
                GridView.DataSource = table;
                GridView.DataKeyNames = VID;
                GridView.DataBind();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T16:08:44.390

将 CreateButton 声明为触发器后，您不必显式调用 Update() 来进行刷新

您在哪里声明了 CreateButton ？- 它必须与 UpdatePanel 位于相同的“NamingContainer”中才能被找到

您可以在更新面板中移动 CreateButton 的声明吗？如果是这样，您不需要显式声明触发器 - 看看这是否会有所不同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T14:28:39.810

由于您的更新面板的更新模式设置为有条件的，因此在您调用网格视图上的 DataBind 之后的代码中，您需要在更新面板的名称上调用 Update()（在本例中名为 UpdatePanel）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-20T17:56:09.853

使用以下

```
<asp:UpdatePanel ID="..." runat="server" UpdateMode="Conditional" ChildrenAsTriggers="true">       
    <ContentTemplate>
      <asp:GridView  ....>
      </asp:GridView .....>

    ///buttons ..............whatever

    </ContentTemplate> 
```

# java - 我们如何在测试 web 应用程序时打开多个 IE 实例。在 Eclipse 中使用 selenium RC 和 java？

> ID：677631
> 
> 赞同：2
> 
> 时间：2009-03-24T14:25:14.717
> 
> 标签：java, selenium

我在 Eclipse 中使用 Java 在 Selenium RC 中运行测试以浏览两个 URL。我有两个 Selenium 窗口，但两个 URL 的测试是通过打开一个 IE 窗口来完成的。如何让它在两个不同的 IE 浏览器上打开 URL，如果可能的话，同时打开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:38:18.180

我相信你必须使用两个 Selenium 实例来达到这个效果——每个窗口一个 selenium 实例。

# c++ - 在 C++ 中实例化对象的不同方法

> ID：677632
> 
> 赞同：55
> 
> 时间：2009-03-24T14:25:15.713
> 
> 标签：c++, object

这有什么区别：

```
Myclass *object = new Myclass(); 
```

和

```
Myclass object = new Myclass(); 
```

我已经看到很多 C++ 库，如 wxWidgets、OGRE 等都使用第一种方法……为什么？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-03-24T14:34:59.310

```
Myclass *object = new Myclass(); //object has dynamic storage duration (usually is on the heap)
Myclass object; //object has automatic storage duration (usually is on the stack) 
```

如果您计划在很长一段时间内使用它们并创建具有自动存储持续时间的对象（通常在堆栈上），那么您将创建具有动态存储持续时间（通常在堆上）的对象，并且生命周期很短（或范围）。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-03-24T14:28:26.957

第二个错误！

您可以使用

```
MyClass object; 
```

那可行。

现在，关于如何在这两种可能性之间进行选择，主要取决于您的对象应该存在多长时间。请参阅[那里](https://stackoverflow.com/questions/408670/stack-static-and-heap-in-c)以获得详尽的答案。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2016-10-21T06:13:52.737

您的第一行是 100% 正确的。不幸的是，您不能在 C++ 中使用第二行创建对象。有两种方法可以在 C++ 中创建/创建对象。

第一个是：

```
MyClass myclass; // if you only need to call the default constructor    
MyClass myclass(12); // if you need to call constructor with parameters* 
```

第二个是：

```
MyClass *myclass = new MyClass();// if you only need to call the default constructor
MyClass *myclass = new MyClass(12);// if you need to call constructor with parameters 
```

In c++ if you use the `new` keyword, object will be stored in heap. It's very useful if you are using this object for a long time period and if you use first method, it will be stored in stack. it can be used only short time period. Notice: if you use `new` keyword, remember it will return pointer value. You should declare name with `*`. If you use second method, it doesn't delete object in the heap. You must delete by yourself using `delete` keyword:

```
delete myclass; 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-03-24T14:28:29.980

`new`运算符返回指向它创建的对象的指针，因此表达式无效`Myclass object = new Myclass();`。

其他语言没有像 C++ 这样的显式指针，因此您可以编写类似 的语句`Myclass object = new Myclass();`，但在 C++ 中这是不可能的。的返回类型`new Myclass();`是指向`Myclass`对象的指针，即`Myclass *`.

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-03-24T14:28:54.503

第一个示例创建一个指向 MyClass 的指针并将其初始化为指向 new 运算符的结果。

第二个可能无法编译，因为它正在尝试创建 MyClass 对象并将其分配给 MyClass 指针。如果您有一个接受 MyClass 指针的 MyClass 构造函数，这可能会起作用。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-07-08T06:12:19.087

您的第一个代码行是正确的，而第二个代码行是不正确的。

```
Myclass object=new Myclass();  //Incorrect code 
```

上面的代码不正确，因为**new Myclass();** 返回指向类和**Myclass 对象的指针；**声明类的对象，并且您试图将指向类的指针分配给类的对象，这是不正确的。

您的第一行代码是正确的。但这声明了指向类的指针而不是类的对象。

```
Myclass *object = new Myclass();  //declares pointer to class. 
```

要声明类的对象，您应该编写以下代码。

```
Myclass object;   //declares object of class Myclass 
```

但是您应该注意，使用指向类的指针和使用类的对象访问类成员的方式是不同的。以下是访问类成员的代码。

```
pointer_to_class->member;  // accessing class member using pointer to class
object.member;             //accessing class member using object of class 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-24T14:33:02.590

第一个是正确的。

第二个一般不会编译。如果它确实编译了，那么这个类就会在构造函数/赋值运算符中做一些复杂的事情。它可能是内存泄漏。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-06-02T14:24:00.997

Its posible Myclass name = Myclass();

# sas - 在创建相关椭圆时，是否可以识别落在椭圆内或外的案例？

> ID：677636
> 
> 赞同：1
> 
> 时间：2009-03-24T14:27:03.387
> 
> 标签：sas, ellipse

Support.sas.com 提供此语法来创建预测椭圆。输出数据集仅包括数据集的相关结果。有没有办法获取个别案例的信息，例如在图表中标记它们或让输出包含个别案例的值？

我尝试将 ID 选项添加到此代码中，但没有成功。

带有预测椭圆的散点图

```
ods graphics on;

proc corr data=fish1

   plots=scatter(alpha=.20 .30);

   var Height Width;

run;

ods graphics off; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T15:34:43.973

如果数据不必打印在图表本身上，您可以使用`imagemap=on`ods 选项获取显示为鼠标悬停提示的观察级别数据。不过，这只**适用**于 html 目的地。默认情况下，您的身高和体重以及观察数值将显示在提示中。ID 声明只是让您添加更多。

```
ods graphics on /imagemap=on;
ods html;
proc corr data=fish1
  plots=scatter(alpha=.20 .30);
  var Height Width;
run;
ods html close;
ods graphics off; 
```

* * *

**更新：** 这是一种在绘图上打印一些数据值的简单方法。如果更改`datalabel=weight`为`datalabel=height`它将打印每个观察值的高度值。这使用 sgplot proc 而不是 proc corr 中的 plots=scatter 语句。因此，观察的数量和相关性不会打印在绘图上，但我相信如果需要，您可以找到添加它的方法。

```
ods graphics on /imagemap=on;
ods html;
proc sgplot data=Fish1;
  scatter x=Height y=Width /datalabel=weight;
  ellipse x=Height y=Width / alpha=.2;
  ellipse x=Height y=Width / alpha=.3;
  keylegend  / location=outside position=bottom;
run;
ods html close;
ods graphics off; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:05:19.937

不完全是您正在寻找的答案，但 Warren Kufeld 编写了一个散点图宏，可以为您进行此类标记。检查一下，可能在程序的后续步骤中合并逻辑以生成带有标签的图。[http://support.sas.com/techsup/technote/ts722k.pdf](http://support.sas.com/techsup/technote/ts722k.pdf "http://support.sas.com/techsup/technote/ts722k.pdf")

# java - 将函数暴露给其他进程

> ID：677638
> 
> 赞同：0
> 
> 时间：2009-03-24T14:27:43.617
> 
> 标签：java, sockets, ipc

我正在使用这段代码，它使用套接字公开一个简单的函数：

```
while (true) {
  try {
    ServerSocket serverSocket = new ServerSocket(7070);
    Socket clientSocket = serverSocket.accept();
    String input = (new BufferedReader(new InputStreamReader(clientSocket.getInputStream()))).readLine();
    synchronized (this.map) {
      ObjectOutputStream o = new ObjectOutputStream(clientSocket.getOutputStream());
      o.writeChars(map.get(input));
      o.close();
    }
    clientSocket.close();
    serverSocket.close();
  } catch(Exception e) {
    e.printStackTrace();
  }
} 
```

我究竟做错了什么？日志显示它卡在输入接收线中，有时会抛出异常，说明套接字正在使用中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T14:30:46.777

对于初学者，您在循环中创建 ServerSocket [i] [i]，这显然不是您想要的。您只想创建一次，然后有一个不断从套接字读取的循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T14:50:35.373

readLine() 卡住了，因为您忘记刷新发送方（另一个进程）的输出流。

使用套接字时，计算机将缓冲一些数据（通常为 4KB），因为通过网络发送少量数据非常昂贵。因此，如果您的数据较少，您需要告诉它“立即发送”。

# log4net - 当 log4net 停止记录时如何对它进行故障排除

> ID：677640
> 
> 赞同：17
> 
> 时间：2009-03-24T14:28:00.543
> 
> 标签：log4net

似乎Log4Net由于不明显的原因默默地关闭了，我不知道如何解决它。我的预感是特定的附加程序在特定的日志消息上失败，并且似乎关闭了整个堆栈。

有没有办法让 Log4Net 抛出异常（至少在我们的调试阶段）而不是悄悄关闭服务。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-08-26T12:31:11.363

扩展上一个答案 -

要为 log4net.Internal.Debug 跟踪添加跟踪侦听器，请将其添加到您的应用配置中：

```
 <system.diagnostics>
    <trace autoflush="true">
      <listeners>
        <add
            name="textWriterTraceListener"
            type="System.Diagnostics.TextWriterTraceListener"
            initializeData="c:\temp\log4net.txt" />
      </listeners>
    </trace>
  </system.diagnostics> 
```

将上面的 initializeData 属性值替换为所需的日志文件路径。确保应用程序或 ASP.NET 服务器进程有权写入此文件。

您可以做的另一件事是检查启动时从 log4net 配置返回的消息。从 log4net 版本 1.2.11 开始，XmlConfigurator.Configure() 方法返回一个 ICollection，其中包含列出配置过程中遇到的问题的字符串。

所以如果你有这样的东西：

```
XmlConfigurator.Configure(); 
```

将其更改为

```
ICollection configMessages = XmlConfigurator.Configure(); 
```

并在调试器中检查 configMessages，或在某处打印出来，例如

```
foreach (string msg in configMessages)
{
   Console.WriteLine(msg);
} 
```

如果一切都失败了，请下载 log4net 源，将项目添加到您的解决方案中，并引用该项目而不是 log4net.dll。现在您可以在调试器中单步执行 log4net 调用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-24T23:47:03.603

我认为您可以在 app.config/web.config 的 appSettings 部分中设置一个配置值，以打开 log4net 中的内部调试语句：

```
<appSettings>
    <add key="log4net.Internal.Debug" value="true"/>
</appSettings> 
```

这将使您对 log4net 可能吞下的任何错误有一些了解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-31T01:44:27.583

我很难弄清楚为什么文件日志和 sql 日志附加程序不起作用。我更改了默认的 SQL 表，结果发现数据类型 Int 不好，而 Int32 是正确的值。在我在 Visual Studio 中调试并进入日志记录方法之前，我似乎无法找到这些信息。该方法的执行在我的断点处暂停，我在即时窗口中运行了 setup 命令：

log4net.Config.XmlConfigurator.Configure()

我能够立即看到反馈，并且实际上在该配置代码运行时引发了异常。它显示在即时窗口中，我能够解决这个问题。

希望这可以帮助某人。

# python - 如何使用 gstreamer 录制实时视频而不丢帧？

> ID：677641
> 
> 赞同：4
> 
> 时间：2009-03-24T14:28:02.307
> 
> 标签：python, linux, gstreamer

我正在尝试使用 Python 中的 gstreamer 0.10 同时显示 v4l2 视频源并将其记录到 xvid-in-avi。在很长一段时间内，计算机的速度足以做到这一点，但如果另一个程序使用磁盘，它就会丢帧。这已经够糟糕的了，但是在播放时视频中会出现突然的运动，其中帧被丢弃，而不是显示我们能够以较低帧速率编码的帧。

管道是`v4l2src ! capsfilter ! tee ! queue ! xvidenc ! avimux ! filesink`，三通也下沉到`queue ! xvimagesink sync=false`. 我试过`videorate`在前面添加，`xvidenc`但这似乎让事情变得更糟。

我考虑在这个管道中将未压缩的视频假脱机到磁盘并在后台线程中对其进行编码。我还能做些什么来解决这个问题？丢帧是错的还是`xvidenc`做错了？`avimux`我可以显着增加编码器之前的队列大小吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T14:35:41.867

`tee`如果任一输出阻塞都会阻塞，所以它可能是你的瓶颈。我建议将需要更长时间编码到磁盘并从那里编码的流写入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-10T15:20:28.733

你需要写 xvimagesink，而不是 xvimagesync

# iphone - iphone sdk：从第一个标签栏项目单击按钮时将焦点设置为不同的标签栏视图

> ID：677651
> 
> 赞同：1
> 
> 时间：2009-03-24T14:29:46.873
> 
> 标签：iphone, cocoa-touch

如何从第一个标签栏项目单击按钮时将焦点设置到不同的标签栏视图？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T14:42:10.230

找到了解决方案：

```
HelloWorldAppDelegate *theDelegate = (HelloWorldAppDelegate*)[[UIApplication sharedApplication] delegate];
tabController = theDelegate.tabBarController;
tabController.selectedIndex = 1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T05:38:58.833

你错过了指针

L1AppAppDelegate *theDelegate = (L1AppAppDelegate*)[[UIApplication sharedApplication] delegate]; tabBarController = theDelegate.tabBarController; tabBarController.selectedIndex = 1;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-27T20:40:12.417

尝试这个！

```
self.tabBarController.selectedViewController = YOURTABBARITEMController;
self.tabBarController.selectedViewController 
    = [self.tabBarController.viewControllers objectAtIndex:1]; 
```

不要忘记`YOURTABBARController`在接口（.h）中声明，合成它，并将接口文件#import到你的.m文件中。

另外对我来说，我`MYTABBARController`也被声明为`@class`在界面中。

你可以让它为你工作......看起来像一个国王！

# c++ - 删除指向子类的指针会调用基类析构函数吗？

> ID：677653
> 
> 赞同：170
> 
> 时间：2009-03-24T14:30:32.753
> 
> 标签：c++, memory-management, destructor, delete-operator, base-class

我有一个`class A`为其一个字段使用堆内存分配。类 A 被实例化并存储为另一个类（`class B`.

当我处理完 B 类的对象后，我调用`delete`，我假设它调用了析构函数……但这是否也调用了 A 类的析构函数？

### 编辑：

从答案中，我认为（如果不正确，请编辑）：

1.  `delete`B 的一个实例调用 B::~B();
2.  调用`A::~A();`
3.  `A::~A` *应该*显式地`delete`为 A 对象的所有堆分配的成员变量；
4.  最后，将存储所述 B 类实例的内存块返回到堆 - 当使用*new*时，它首先在堆上分配一块内存，然后调用构造函数来初始化它，现在在调用所有析构函数来完成对象之后对象所在的块被返回到堆中。

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2009-03-24T14:32:33.683

A 的析构函数将在其生命周期结束时运行。如果你想释放它的内存并运行析构函数，如果它是在堆上分配的，你必须删除它。如果它是在堆栈上分配的，这会自动发生（即，当它超出范围时；请参阅 RAII）。如果它是类的成员（不是指针，而是完整成员），那么当包含对象被销毁时就会发生这种情况。

```
class A
{
    char *someHeapMemory;
public:
    A() : someHeapMemory(new char[1000]) {}
    ~A() { delete[] someHeapMemory; }
};

class B
{
    A* APtr;
public:
    B() : APtr(new A()) {}
    ~B() { delete APtr; }
};

class C
{
    A Amember;
public:
    C() : Amember() {}
    ~C() {} // A is freed / destructed automatically.
};

int main()
{
    B* BPtr = new B();
    delete BPtr; // Calls ~B() which calls ~A() 
    C *CPtr = new C();
    delete CPtr;
    B b;
    C c;
} // b and c are freed/destructed automatically 
```

在上面的例子中，每个 delete 和 delete[] 都是需要的。在我没有使用它的地方不需要删除（或者确实可以使用）。

`auto_ptr`，`unique_ptr`等等`shared_ptr`......非常适合使这一生命周期管理变得更加容易：

```
class A
{
    shared_array<char> someHeapMemory;
public:
    A() : someHeapMemory(new char[1000]) {}
    ~A() { } // someHeapMemory is delete[]d automatically
};

class B
{
    shared_ptr<A> APtr;
public:
    B() : APtr(new A()) {}
    ~B() {  } // APtr is deleted automatically
};

int main()
{
    shared_ptr<B> BPtr = new B();
} // BPtr is deleted automatically 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-24T14:36:11.647

当你对 new 分配的指针调用 delete 时，将调用指向对象的析构函数。

```
A * p = new A;

delete p;    // A:~A() called for you on obkect pointed to by p 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-03-24T14:32:22.797

它被命名为“析构函数”，而不是“解构函数”。

在每个类的析构函数中，您必须删除所有其他已用 new 分配的成员变量。

编辑：澄清：

说你有

```
struct A {}

class B {
    A *a;
public:
    B () : a (new A) {}
    ~B() { delete a; }
};

class C {
    A *a;
public:
    C () : a (new A) {}        
};

int main () {
    delete new B;
    delete new C;
} 
```

分配 B 的一个实例然后删除是干净的，因为 B 内部分配的内容也会在析构函数中被删除。

但是类 C 的实例会泄漏内存，因为它分配了一个它不会释放的 A 实例（在这种情况下，C 甚至没有析构函数）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-24T14:34:39.437

如果你有一个通常的指针 ( `A*`) ，那么析构函数将不会被调用（`A`例如内存也不会被释放），除非你在的析构函数`delete`中明确地这样做。`B`如果您想要自动销毁，请查看智能指针，例如`auto_ptr`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-24T14:33:55.210

您应该在 B 的析构函数中自己删除 A。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-24T14:34:03.323

```
class B
{
public:
    B()
    {
       p = new int[1024];  
    }
    virtual ~B()
    {
        cout<<"B destructor"<<endl;
        //p will not be deleted EVER unless you do it manually.
    }
    int *p;
};

class D : public B
{
public:
    virtual ~D()
    {
        cout<<"D destructor"<<endl;
    }
}; 
```

当你这样做时：

```
B *pD = new D();
delete pD; 
```

仅当您的基类具有 virtual 关键字时，才会调用析构函数。

然后，如果您没有虚拟析构函数，则只会调用 ~B() 。但是因为你有一个虚拟析构函数，所以首先调用~D()，然后调用~B()。

除非您明确删除它们，否则在堆上分配的 B 或 D 的任何成员都不会被释放。删除它们也会调用它们的析构函数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T15:00:40.077

你有类似的东西

```
class B
{
   A * a;
}
B * b = new B;
b->a = new A; 
```

如果您然后调用`delete b;`，则 a 不会发生任何事情，并且您有内存泄漏。试图记住`delete b->a;`不是一个好的解决方案，但还有其他几个。

```
B::~B() {delete a;} 
```

这是 B 的析构函数，它将删除 a。（如果 a 为 0，则删除不执行任何操作。如果 a 不为 0 但未从 new 指向内存，则会出现堆损坏。）

```
auto_ptr<A> a;
...
b->a.reset(new A); 
```

这样你就没有 a 作为指针，而是一个 auto_ptr<> （shared_ptr<> 也可以，或者其他智能指针），当 b 是时它会被自动删除。

这两种方法中的任何一种都很好用，我都用过。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-17T12:29:43.397

我想知道为什么我的班级的析构函数没有被调用。原因是我忘记包含该类的定义（#include "class.h"）。我只有一个像“A级”这样的声明；编译器对此很满意，让我称之为“删除”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-24T14:32:13.077

不，指针将被删除。您应该在 B 的析构函数中显式调用 A 上的删除。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-24T14:35:15.533

只有当为该对象调用 delete 时，才会调用类 A 对象的析构函数。确保在 B 类的析构函数中删除该指针。

有关在对象上调用 delete 时会发生什么的更多信息，请参阅： http: [//www.parashift.com/c++-faq-lite/freestore-mgmt.html#faq-16.9](http://www.parashift.com/c++-faq-lite/freestore-mgmt.html#faq-16.9)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-24T14:50:35.077

不，它不会为 A 类调用析构函数，你应该显式调用它（就像 PoweRoy 所说的那样），删除行 'delete ptr;' 例如比较...

```
 #include <iostream>

  class A
  {
     public:
        A(){};
        ~A();
  };

  A::~A()
  {
     std::cout << "Destructor of A" << std::endl;
  }

  class B
  {
     public:
        B(){ptr = new A();};
        ~B();
     private:
        A* ptr;
  };

  B::~B()
  {
     delete ptr;
     std::cout << "Destructor of B" << std::endl;
  }

  int main()
  {
     B* b = new B();
     delete b;
     return 0;
  } 
```

# html - 停止列表中的文本换行

> ID：677655
> 
> 赞同：3
> 
> 时间：2009-03-24T14:31:05.513
> 
> 标签：html, css, html-lists

我有一个有序列表：

```
<ol>
<li>They used to bring concerns about their children or their marriages. But increasingly parishioners are also telling Glen VanderKloot, a Lutheran minister in Springfield, Ill., about their financial worries, and that puts him in the unusual position of dispensing investment advice.</li>
<li>This is the Second g</li>
<li>This is the Third g</li>
<li>This is the fourth g</li>
<li> <strong>This is the fifth g</strong> </li>
<li>This is the seventh g</li>
<li>This is the eight g</li>
<li>This is the ninth g</li>
<li>This is the tenth g</li>
<li>This is the eleventh g</li>
<li>This is the twelvth g</li>
</ol> 
```

如下所示：

```
1\.  They used to bring concerns about their children or their marriages. But
    increasingly parishioners are also telling Glen VanderKloot, a Lutheran
    minister in Springfield, Ill., about their financial worries, and that puts
    him in the unusual position of dispensing investment advice.
2\.  This is the Second g
3\.  This is the Third g
4\.  This is the fourth g
5\.  This is the fifth g
6\.  This is the seventh g
7\.  This is the eight g
8\.  This is the ninth g
9\.  This is the tenth g
10\. This is the eleventh g
11\. This is the twelvth g 
```

当我有很多像第一个项目这样的文本时，我希望它像上面那样格式化。我能够通过设置来实现这一点：

```
list-style-position:outside; 
```

并调整 li 和 ol 标签上的一些边距。但是，当我有两位数和三位数时，这会产生一些不利影响。我不得不使用这些边距，因为在 IE 中数字被截断了。我希望能够返回使用 a `list-style-position`of `inside`并删除边距，但文本包裹在数字下方，这不是我想要的。

有谁知道如何关闭这个包装？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T14:33:59.797

试试这个：

```
li { 
  white-space:nowrap;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T15:44:56.833

如果您使用的是无序列表，那么使用`list-style-position:outside;`会更可行，这将始终为标记占用相同数量的空间。由于您使用的是有序列表，我会坚持使用`list-style-position:inside;`. 正如您所发现的，问题在于 IE 和 Firefox 为标记留出相同数量的空间，而与标记中的位数或字体大小无关。因此，您需要通过自己创建空间来将事情掌握在自己手中。这里的技巧是要知道，默认情况下，IE 和 Firefox 使用不同的属性来创建空间。IE 使用`margin`（`<ol>`30 点）而 Firefox 使用`padding`（40 像素），因此您必须重置这两个值才能实现跨浏览器的快乐。

试试这个：

```
ol {
    margin-left: 0;
    padding-left: 3em;
    list-style-position: outside;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T15:13:10.483

问题是 list-style-position:inside “缩进标记和文本”。所以你永远不会用它来实现你想要做的事情。( [http://www.w3schools.com/CSS/pr_list-style-position.asp](http://www.w3schools.com/CSS/pr_list-style-position.asp) ) 所以你唯一的选择是list-style-position:outside。

如果您的问题是某些列表最多可包含 9 个项目（1 位），其他列表最多可包含 99 个项目（2 位），还有一些列表最多可包含 999 个项目（3 位），等等。我会说您有2个选择：

选项 1：为每个列表创建一个不同的类（假设您提前知道计数）。也许称它们为digits1、digits2、digits3等。因此，对于1位数字列表，您将使用：

```
<ol class='digits1'>
  <li>item</li>
  ...
</ol> 
```

选项 2：完全放弃列表，只使用表格（我知道啊）。但是无论列表中有多少项目，您都可以保证正确的换行和缩进。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T14:37:13.283

```
li { white-space: nowrap; } 
```

这将允许文本显示在同一行。它也可能导致其他事物水平扩展。

```
li { overflow: hidden; } 
```

在这种情况下可能不相关，但它会隐藏超出 LI 元素固定宽度的任何文本。

另见断词：

```
li { word-wrap: break-word } 
```

我认为这个选择器在 IE 中存在一些问题。

# python - 如何从对象列表中提取特定属性的列表？

> ID：677656
> 
> 赞同：48
> 
> 时间：2009-03-24T14:31:43.907
> 
> 标签：python

我有一个对象列表。对象有 3 个字符串属性。我想制作一个仅包含类中特定属性的列表。

是否有任何内置函数可以做到这一点？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-03-24T14:36:50.197

列表理解可以正常工作：

```
[o.my_attr for o in my_list] 
```

但是有一个内置函数的组合，因为你问:-)

```
from operator import attrgetter
map(attrgetter('my_attr'), my_list) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-24T14:35:30.697

你在找这样的东西吗？

```
[o.specific_attr for o in objects] 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-24T14:34:06.100

我想到的第一件事是：

```
attrList = map(lambda x: x.attr, objectList) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T14:33:14.290

假设您想要`b`名为列表中的对象的字段，`objects`请执行以下操作：

```
[o.b for o in objects] 
```

# actionscript-3 - FLVplayback - 停止文件自动下载

> ID：677671
> 
> 赞同：2
> 
> 时间：2009-03-24T14:34:32.527
> 
> 标签：actionscript-3, flvplayback

我目前在我的舞台上有 FLVplayback 组件，但是，我将 autoPlay 设置为 False。这是一个问题，因为我希望流仅在用户按下播放时才开始下载。

另外，当我点击离开视频的页面时，我希望能够停止下载流。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T19:12:02.317

在您设置源属性之前，视频不会开始加载，因此只需在您希望它开始时用代码设置它

只要您以后不想再次使用该 FLVPlayback，sims281 的答案就有效，因为他的方法会起作用，但会弄乱播放器。不久前我做了一个课程，它确实有效地停止了视频流，但仍然允许你继续使用该播放器，你可以在这里看到它：

[FLVPlaybackUtils](http://pastie.org/310174)

使用该类，您可以这样做：

```
import FLVPlaybackUtils;

FLVPlaybackUtils.reset(myFlvPlayback);
```

它将清除播放器，停止任何流式传输或下载，并将播放器重置为再次可用，以防万一您想稍后在程序中再次使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T14:36:35.733

不确定第一部分，但这与您所追求的相似吗？

```
if (FLVplayerInstanceName)
 {
  FLVplayerInstanceName.stop();  
  FLVplayerInstanceName.getVideoPlayer(FLVplayer.activeVideoPlayerIndex).close();
  gotoAndStop("yourPageLabel");
 } 
```

# vb.net - 是否可以获得调用另一个方法的名称方法？

> ID：677675
> 
> 赞同：1
> 
> 时间：2009-03-24T14:35:14.100
> 
> 标签：vb.net, methods

这就是我所说的：

```
Public Shared Sub Test1()
    Test2()
End Sub

Public Shared Sub Test2()
    MsgBox(Test2.LastMethod) ' Test1
End Sub 
```

我想如果这是可能的，`System.Reflection`会被利用吗？

有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T14:44:21.863

查看 System.Diagnostics.StackFrame 类。

```
 StackFrame frame = new StackFrame(1);
 MethodBase method = frame.GetMethod();
 Console.WriteLine(method.Name); 
```

作为旁注，您不应该依赖于调用者是谁，也不应该使用它，除非您正在编写调试器或用于记录目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T14:44:47.540

```
Dim stackFrame As New Diagnostics.StackFrame(1)
stackFrame.GetMethod.Name.toString() & stackFrame.GetMethod.DeclaringType.FullName.tostring() 
```

应该给你全名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:59:30.437

这个问题应该会有所帮助：
[你可以使用反射来找到当前正在执行的方法的名称吗？](https://stackoverflow.com/questions/44153/can-you-use-reflection-to-find-the-name-of-the-currently-executing-method)

小心你如何做到这一点。如果您的方法是 JIT 内联的，您可能会看到错误的方法。

# .net - 如何将故障转移伙伴添加到 VB.NET 中的连接字符串

> ID：677678
> 
> 赞同：4
> 
> 时间：2009-03-24T14:35:24.707
> 
> 标签：.net, asp.net, sql-server, vb.net, connection-string

我有一个连接到数据库的 Windows 应用程序来读取一些数据。由于数据库是为弹性设置的，我的应用程序需要连接到两个数据库之一。有人可以指定使用 sql server 身份验证在连接字符串中指定故障转移伙伴的语法是什么。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T14:42:20.120

检查[connectionstrings.com](http://www.connectionstrings.com/sql-server-2005)：

> **数据库镜像**
> 如果您使用 ADO.NET 或 SQL Native Client 连接到正在镜像的数据库，您的应用程序可以利用驱动程序在数据库镜像故障转移发生时自动重定向连接的能力。您必须在连接字符串中指定初始主体服务器和数据库以及故障转移伙伴服务器。

```
Data Source=myServerAddress;Failover Partner=myMirrorServerAddress;Initial
Catalog=myDataBase;Integrated Security=True; 
```

> 当然还有许多其他方法可以使用数据库镜像来编写连接字符串，这只是指出故障转移功能的一个示例。您可以将其与其他可用的连接字符串选项结合使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T18:47:53.057

> 如果您在连接字符串中提供故障转移伙伴服务器的名称，并且在客户端应用程序首次连接时主体数据库不可用，客户端将透明地尝试与故障转移伙伴建立连接。

```
";Failover Partner=PartnerServerName" 
```

> 如果您省略了故障转移伙伴服务器的名称，并且在客户端应用程序首次连接时主体数据库不可用，则会引发 SqlException。

[资源](http://msdn.microsoft.com/en-us/library/5h52hef8.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-28T02:46:58.210

如果您没有在 SQL 服务器之间设置镜像，则可以使用 .net 来实现。只是在一个 catch 语句中。

下面的代码..

```
enter code here
Imports System.Data.SqlClient
Imports System.Data

Public Class dbConn
Private primaryServerLocation As String = "SERVER=primaryAddress;DATABASE=yourDB;User id=youruserID;Password=yourPassword;"
Private secondaryServerLocation As String = "SERVER=secondaryAddress;DATABASE=yourDB;User id=youruserID;Password=yourPassword;"

Public sqlConnection As SqlConnection
Public cmd As SqlCommand

Public Sub primaryConnection()
    Try
        sqlConnection = New System.Data.SqlClient.SqlConnection(primaryServerLocation)
        cmd = New System.Data.SqlClient.SqlCommand()

        'test connection
        sqlConnection.Open()
        sqlConnection.Close()
    Catch ex As Exception
        secondaryConnection()
    End Try
End Sub

Public Sub secondaryConnection()
    'Used as the failover secondary server if primary is down.
    Try
        sqlConnection = New System.Data.SqlClient.SqlConnection(secondaryServerLocation)
        cmd = New System.Data.SqlClient.SqlCommand()

        'test connection
        sqlConnection.Open()
        sqlConnection.Close()
    Catch ex As Exception
    End Try
End Sub
End Class 
```

# windows-installer - 如何部署基于 .inf 的驱动程序？

> ID：677686
> 
> 赞同：19
> 
> 时间：2009-03-24T14:36:57.747
> 
> 标签：windows-installer, driver

我想用我的安装程序部署一个基于 .inf 的 USB 驱动程序。

我猜 .inf 需要放在`%SystemRoot%\inf`.cat 中（我猜是 WHQL 认证？）和 .sys 文件。我该怎么处理这些？

**编辑：**已解决，感谢有用的答案。我能够 P/Invoke 该功能，所以我有一个运行以下代码的安装后操作：

```
namespace DriverPackageInstallAction
{
    static class Program
    {
        [DllImport("DIFXApi.dll", CharSet = CharSet.Unicode)]
        public static extern Int32 DriverPackagePreinstall(string DriverPackageInfPath, Int32 Flags);

        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            DirectoryInfo assemblyDir = new DirectoryInfo(Application.ExecutablePath);
            DirectoryInfo installDir = assemblyDir.Parent;

            int result = DriverPackagePreinstall(installDir.FullName + @"\Driver\XYZ.inf", 0);
            if (result != 0)
                MessageBox.Show("Driver installation failed.");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T14:58:57.617

我将从阅读[SetupAPI](http://msdn.microsoft.com/en-us/library/ff550855.aspx)和[DIFx](http://msdn.microsoft.com/en-us/library/ff544838.aspx)开始。Windows 驱动程序工具包包含两者的[示例](http://msdn.microsoft.com/en-us/library/ff541313.aspx)，包括基于 DIFx 的合并模块和基于 DIFx 的 WiX 库。基于 SetupAPI的命令行[devcon实用程序的源代码也包含在 WDK 示例中。](http://msdn.microsoft.com/en-us/library/ff541193.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T14:40:07.427

您可以尝试要求 shell 为您安装它：

```
%SystemRoot%\System32\rundll32.exe setupapi,InstallHinfSection DefaultInstall 132 YOUR_FILE.inf 
```

但我100%肯定有更好的方法......

# c# - DataGridView 在更新时移动行

> ID：677699
> 
> 赞同：0
> 
> 时间：2009-03-24T14:41:43.337
> 
> 标签：c#, datagridview

有时，当我更新 DataGridView 中的一行时，行中会发生这样的变化： [alt text http://www.freeimagehosting.net/uploads/eb932776d2.jpg](http://www.freeimagehosting.net/uploads/eb932776d2.jpg)

查看中间的行，注意其中三列是如何绘制不正确的。一旦发生这种情况，即使刷新似乎也无法解决问题。当行中的任何数据发生更改时，问题就会消失。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T14:45:34.137

不确定是什么原因造成的，但您是否尝试过调用 Invalidate()？

你可以试试 this.gridView1.Invalidate() 或 this.InvalidateRow(rowIndex)。

# opengl - glut.h 的链接器错误

> ID：677714
> 
> 赞同：0
> 
> 时间：2009-03-24T14:45:49.863
> 
> 标签：opengl, glut, dev-c++

[链接器错误] 对 `__glutInitWithExit@12' 的未定义引用

[链接器错误] 对 `__glutCreateWindowWithExit@8' 的未定义引用

[链接器错误] 未定义对 `__glutCreateMenuWithExit@8' 的引用

[链接器错误] 未定义对 `glutSolidSphere@16' 的引用

**如果我包含 glut.h 标头，就会出现上述问题。为什么？**

**没有它我不能使用 glutSolidSphere() ..我正在
使用 DEV C++ btw ..**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:52:49.847

glut.h 头文件只是声明了函数。您需要链接实现它们的库，这应该在 glut 文档中进行描述。

# malloc - nsapi初始化函数中分配的内存是永久的吗？

> ID：677715
> 
> 赞同：0
> 
> 时间：2009-03-24T14:45:51.530
> 
> 标签：malloc, nsapi

nsapi 提供了一个 MALLOC 宏，该宏从池中获取内存，当请求结束时将为您释放内存，但它没有说明如果您在初始化函数中调用此 malloc 函数会发生什么，而没有请求。可以假定这个 malloc（或 pblock_created）内存是持久的吗？在 nsapi 文档中没有说任何关于它的内容，我希望有人对此有一些经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T15:03:37.447

我在sun论坛上收到了某人的回复。事实证明，是的，事实上，如果您在初始化部分调用 MALLOC() ，则您返回的内存不会被池化并且会持续存在。

# mysql - 在 SELECT 查询中用“foo”替换列的空记录？

> ID：677719
> 
> 赞同：3
> 
> 时间：2009-03-24T14:47:19.717
> 
> 标签：mysql, select

我正在将 MySql -table 备份到工作表。我当前的结果集有一些列是空的行。

没关系，但是对于工作表，我需要将这些替换为“foo”。如何？

高度赞赏所有帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T14:49:16.030

空还是NULL？那里有很大的不同。如果为 NULL，则可以使用该`COALESCE()`函数：

```
SELECT COALESCE(`MyColumn`, 'foo') As MyColumn FROM `MyTable` 
```

如果该值仅为空，则需要执行以下操作：

```
SELECT IF(char_length(`MyColumn`)>0, `MyColumn`, 'foo') AS MyColumn FROM `MyTable 
```

或者你甚至可以将它们组合起来：

```
SELECT IF(char_length(COALESCE(`MyColumn`,''))>0,`MyColumn`,'foo') AS MyColumn FROM `MyTable` 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T14:49:44.580

只需使用“IFNULL”：

```
SELECT IFNULL(col1,'foo')
FROM mytable 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T14:49:45.500

该`COALESCE`语句返回它传递的第一个非空参数：

```
SELECT COALESCE(column,'foo') 
```

`column`如果它不为 null，则返回，`'foo'`否则。

# javascript - Emacs JavaScript 自动缩进

> ID：677721
> 
> 赞同：16
> 
> 时间：2009-03-24T14:47:42.557
> 
> 标签：javascript, emacs, indentation

我正在寻找一种方法来关闭 emacs 中的自动缩进。当我输入特殊字符时，我不希望 emacs 自动缩进代码；或者 /*

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-24T20:35:44.653

Steve Yegge 的 js2 模式很棒。

来自[http://code.google.com/p/js2-mode/](http://code.google.com/p/js2-mode/)

一种改进的 GNU Emacs 的 JavaScript 模式。

特征：

*   可变（可调）缩进
*   准确的语法高亮
*   语法错误高亮
*   严格模式警告报告（如重复 var 声明）
*   注释和字符串中的智能换行
*   键入助手（例如匹配引号/括号）
*   代码折叠（将元素折叠为 {...}）
*   支持 JavaScript 1.5、1.6 和 1.7（包括 E4X）
*   可自定义的颜色，或使用字体锁定默认值
*   许多自定义选项

最终目标是与 IntelliJ 和其他一流的 JavaScript 编辑器竞争。

注意 - 此模式适用于 GNU Emacs 版本 21 及更高版本。它不支持 XEmacs。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-24T18:43:34.300

如果您使用的是基于 CC 模式的旧模式，`C-c C-l`则会切换电力。

Emacs 附带了一个新的 Javascript 模式，可以交互切换`M-x electric-indent-mode`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-07-08T12:53:53.743

显然，实现这一目标的新方法是：

```
M-x electric-indent-mode 
```

此命令切换“电子缩进”，即每当遇到某些特殊字符时自动缩进。

最好的事情是它可以跨主要模式工作，不仅适用于`js-mode`（最近版本的 Emacs 中的默认 javascript 主要模式）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T06:13:43.390

在加载 javascript 模式之前设置`javascript-auto-indent-flag`为。`nil`您可以在`.emacs`文件中添加一行或键入

```
M-x customize-group RET javascript RET 
```

并在那里编辑值并保存。您可能需要重新启动 Emacs 才能使其生效；至少在`javascript.el`我拥有的版本中，仅在设置键盘映射时才咨询该标志。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-03-24T16:53:14.690

这将关闭所有缩进：`M-x`基本模式

# c++ - 从一个进程导航到它的父进程

> ID：677722
> 
> 赞同：0
> 
> 时间：2009-03-24T14:48:17.063
> 
> 标签：c++, winapi, process

我坚持使用 IE8 的进程模型，其中我的 MFC 嵌入式窗口的*GetWindowThreadProcessId()*会给我一个子 IE PID，因为我的容器页面的*GetWindowThreadProcessId()*会给我根 IE PID。

这很糟糕，因为我想在枚举窗口时过滤掉我的容器。

所以我正在寻找一种方法来获取给定进程的*父*进程的 PID ，以便从我的 MFC 应用程序中获取根 IE PID。

Sysinternals 的[ProcessExplorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)知道如何做到这一点，在树视图中显示进程，所以我确信有办法实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T14:53:24.850

你[看过这个 codeproject 文章](http://www.codeproject.com/KB/threads/ParentPID.aspx)或[这个 codeguru 文章](http://www.codeguru.com/cpp/w-p/win32/article.php/c1437)吗？

我认为更好的方法是在 codeguru 文章中。

基本上你想要 PROCESS_BASIC_INFORMATION 的“ULONG InheritedFromUniqueProcessId”成员。请参阅[NtQueryInformationProcess](http://msdn.microsoft.com/en-us/library/ms684280(VS.85).aspx)和[此页面](http://social.msdn.microsoft.com/Forums/en-US/netfx64bit/thread/7bfc32ea-b493-4853-a690-fef7b1170162/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:00:46.690

使用 ToolHelp32 函数[http://support.microsoft.com/kb/192986](http://support.microsoft.com/kb/192986)并将它们排序为树。

但是如果你嵌入了窗口，也许你的代码在 IE 进程中？您使用什么类型的嵌入，ocx 还是 dll？

# ubuntu - wx.FileDialog 中缺少网络共享

> ID：677723
> 
> 赞同：0
> 
> 时间：2009-03-24T14:48:44.270
> 
> 标签：ubuntu, networking, wxpython, samba, filepicker

我正在使用带有 Nautilus 的 Xubuntu 8.10 作为文件管理器（XFCE 桌面不活动，Nautilus 处理它），并且我有一个 wxPython 2.8.8.0 应用程序，其 FileBrowseButton 按预期工作，除了“网络”上的快捷方式FileDialog 的左侧，即丢失。

我也尝试使用其他应用程序：Firefox 显示相同的行为，GIMP*具有*“网络”快捷方式，而 OpenOffice 2.4 具有两者的“混合”（没有“网络”，但它显示 Nautilus 安装的共享）

另一件事：如果我安装了 fusesmb，“网络”快捷方式*也会*显示在我的应用程序中。

由于 fusesmb（实际上是 smbclient）在 Ubuntu Intrepid 上并不完全稳定，我想避免使用它，所以我的问题是：关于如何强制文件选择器显示网络的任何提示？可能是 Gnome-VFS 问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T07:03:13.143

查看我的另一个问题的[答案](https://stackoverflow.com/questions/825724/network-aware-wx-filedialog/876524#876524)

# sql - 复杂的 MySQL 存储过程

> ID：677729
> 
> 赞同：3
> 
> 时间：2009-03-24T14:49:27.967
> 
> 标签：sql, mysql, stored-procedures

我有一个需要创建的半复杂的存储过程。我在这里并不完全是一名 DBA，但我公司中没有其他人比我更好。基本思想是我有一组任务。用户完成这些任务并为每个完成的任务获得一个标志。要被视为“完成”，用户必须完成所有一组给定任务。关键在于，其中一些任务可能是其他任务组的包装。

例如，我们有以下可能的任务：

```
Task 1
Task 2 
Task 3
Task 4 -> (1, 2, 3)
Task 5 -> (1, 2)
Task 6
Task 7 -> (5, 6) 
```

一旦用户完成了任务 1 和 2，他们就隐含地完成了任务 5。一旦他们完成了任务 3，他们就隐含地完成了任务 4。

如果另一个用户完成了任务 1、2 和 6，他们将隐式完成 1、2、5、6、7。

相反，如果一项作业只需要任务 7，那么它会扩展为需要任务 6 和 5，而这需要任务 1 和 2。

我有五个基本表：userCompletedTask、assignmentRequiredTask、compoundTask、userTaskAssignment 和 task。我省略了用户和分配表，因为它是多余的。

```
userCompletedTask:
userID (Foreign Key on user)
taskID (Foreign Key on task)

usertTaskAssignment:
userID (Foreign key on user)
assignmentID (Foreign key on assignment)

assignmentRequiredTask:
assignmentID (Foreign key on assignment)
taskID (Foreign key on task)

task:
taskID (primary key)
compound (boolean flag. If 1, it is compound)

compoundTask:
parentID (foreign key on task)
childID (foreign key on task) 
```

为用户分配了一个需要完成任务 4 的 userTaskAssignment。我想构建一个存储过程，将根据 assignmentRequiredTasks 检查 userCompletedTasks，检查是否有适当的复合任务。

伪代码是这样的：

```
collection tasksCompleted = user->getTasksCompleted
collection tasksRequired = new collection

foreach task in assignment->getRequiredTasks 
   if(task.isCompound) 
      tasksRequired->addAll(getCompountTasks(task))
   else 
      tasksRequired->add(task)

if tasksCompleted->containsAll(tasksRequired)
   return true
else 
   return false 
```

我只是不太了解 MySQL/SQL 的内部结构，无法将其转换为存储过程。最后的手段是我将代码拉入应用程序，但这确实适合数据级别。任何帮助将不胜感激。

**编辑**

正如下面所指出的，compoundTask 条目本身可以是复合任务。因此，您将需要一个递归练习来获得所有需要完成的非复合任务的列表。我扩展了上面的例子来说明这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:02:51.600

真的，您的`compoundTask`桌子正在复制您的`task`桌子。如果只是`parent_id`在任务表中添加一个可为空的列，则可以在一个表中实现相同的结果。

在这里，这是未经测试的，甚至可能不是有效的 MySQL，但它应该让你开始：

```
SELECT DISTINCT taskID FROM task AS t LEFT JOIN compoundTask AS ct ON ct.taskID = t.taskID
INNER JOIN userCompletedTask AS uct ON uct.taskID = t.taskID
INNER JOIN userCompletedTask AS uctCompound ON uctCompound.taskID = ct.taskID
WHERE uct.userID = @user AND uctCompound.userID = @user 
```

从这里返回的任何`taskID`s 都为指定的 s 完成`@user`。

自从我完成 MySQL 以来已经有很长时间了——所以这甚至可能行不通。此外，如果您可以合并`compoundTask`和`task`表，则第二个`INNER JOIN`将是不必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:48:08.450

我是 mysql 新手，但我对 T-SQL 存储过程并不陌生。这是我认为应该是存储过程。我认为它是 T-SQL 和 mysql 的混合......所以请适当消除语法担忧

```
CREATE PROCEDURE proc (@userId BIGINT)
AS
BEGIN

/*
   Consider this table the same as
   collection tasksCompleted = user->getTasksCompleted
*/
CREATE TABLE #TasksCompleted
(
   taskID BIGINT
);

INSERT INTO #TaskCompleted
   (SELECT
    task.taskId
    FROM
    userCompletedTask natural join
    task
    WHERE
    userCompletedTask.userId = @userID AND
    task.completed = 1);

/*
   Same as collection tasksRequired = new collection
*/
CREATE TABLE #RequiredTasks
(
   taskID BIGINT
);

CREATE TABLE #RetrivedRequiredTasks
(
   taskID BIGINT,
   compound BIT
);

INSERT INTO #RetrivedRequiredTasks
   (SELECT
    task.taskId,
    task.compound
    FROM
    usertTaskAssignment NATURAL JOIN
    assignmentRequiredTask NATURAL JOIN
    task
    WHERE
    userCompletedTask.userId = @userID);

INSERT INTO #RequiredTasks
   (SELECT taskID FROM #RetrivedRequiredTasks WHERE compound = 0);

INSERT INTO #RequiredTasks
   (SELECT
    compoundTask.childID
    FROM
    #RetrivedRequiredTasks INNER JOIN
    compoundTask on
    (
        #RetrivedRequiredTasks.compound = true  AND
        #RetrivedRequiredTasks.taskId = compoundTask.parentID
    ));

DECLARE @count INT

SELECT @count = Count(*)
FROM #RequiredTasks
WHERE taskId NOT IN (
    SELECT taskID FROM #TaskCompleted);

IF @count = 0 THEN
   SELECT 1 /* All required tasks completed */
ELSE
   SELECT 0 /* vice-versa */ 
```

结尾

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T15:51:53.650

如果您只有一个级别的任务，那么更好的模型可能是拥有一个任务表和一个子任务表。对于非复合任务，他们只会有一个子任务而不是多个子任务。您可以在自己的模型中执行此操作，只需为 parentid = childid 的所有非复合任务添加行。

除此之外，以下代码应该为您提供用户所需的所有未完成任务的列表：

```
SELECT
    COALESCE(CT.child_id, T.task_id)
FROM
    User_Task_Assignments UTA
INNER JOIN Assignment_Required_Tasks ART ON
    ART.assignment_id = UTA.assignment_id
INNER JOIN Tasks T ON
    T.task_id = ART.task_id
LEFT OUTER JOIN Compound_Tasks CT ON
    CT.parent_task_id = T.task_id AND
    T.compound = 1
LEFT OUTER JOIN User_Completed_Tasks UCT ON
    UCT.user_id = @user_id AND
    UCT.task_id = COALESCE(CT.child_id, T.task_id)
WHERE
    UTA.user_id = @user_id AND
    UCT.user_id IS NULL 
```

# java - 在 jar 启动时预加载 java 类/库？

> ID：677739
> 
> 赞同：9
> 
> 时间：2009-03-24T14:51:03.717
> 
> 标签：java, jvm, classloader, warm-up

在对服务器的第一次 RPC 调用期间发生超时，但 subsequest 请求成功。服务器响应超时，因为在第一次调用时它会加载处理请求所需的库。由于此延迟，一些客户端超时。尽管可以增加客户端的超时延迟，但我想尽量减少类加载对应用程序响应能力的影响。

您将如何预加载 Java 类文件，以便在`.jar`首次运行应用程序文件时，类加载不会在第一次调用时引入延迟？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T15:42:50.583

您可以在服务器上线之前运行负载。您尚未指定如何加载服务器、类以及环境是什么，但您可以利用类静态初始化程序将在加载类时运行这一事实。所以，如果你从“main”方法运行，你的类可能看起来像这样

```
public class Foo {

   static {
     //this will be run when the class is loaded
     try { Class.forName("fully.qualified.class.name.that.i.want.to.Load"); }
     catch ...
   }

   public static void main (string args[])
   {
    //run my server...
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T15:00:51.620

您可能想尝试的一件事是在 Java 服务器本身内部编写一个简单的客户端。这个客户端什么都不做，只是在启动时调用服务器中的一些方法，强制加载类。在这个小客户端得到结果（或回调）后，它会将服务器置于“外部世界可访问”状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T15:02:37.917

我建议在打开服务器之前伪造连接。这将确保（大多数）相关的延迟初始化将被执行。

# c# - 设计问题：如何处理初始化？

> ID：677742
> 
> 赞同：1
> 
> 时间：2009-03-24T14:51:27.540
> 
> 标签：c#, design-patterns, initialization

让我们假设我们有一个将在 (c#) 代码中广泛使用的类，例如 Log 类。假设日志将条目写入特定目录中的 XML 文件。现在，强制用户使用所需信息初始化类的一种尝试是将默认（无参数）构造函数设为私有，并提供一个采用*logdirectory*参数的构造函数。这样做的缺点是，用户每次需要将某些内容写入日志并因此创建 Log 类的实例时，都需要提供参数。

还有哪些其他选择？提前感谢您的回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T15:06:47.270

四个选项（主要包括，但没有明确和一起）：

*   只需将调用设为静态，并包括静态初始化。这对于测试（依赖于它的类）来说是可怕的，但非常简单。

*   按照大多数其他答案的建议使用[单例。](http://pobox.com/~skeet/csharp/singleton.html)从测试的角度来看，这可能会更好（您可以使用内部方法来替换单例仅用于测试目的），并实现一个用于模拟目的的接口。

*   使用依赖注入：让所有需要依赖的东西都放在构造函数或其他东西中，然后让你的 DI 框架连接所有东西。从测试的角度来看要好得多，但它并不完全方便。

*   使用工厂 - 就像单例一样，但将实现与构造分开。（它可能*实际上*最终成为一个单例，但没有那么多假设。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T14:54:22.227

我认为您要搜索的术语是单例模式。我不会在这里完整地写出来——这是一个非常适合谷歌的术语。但基本上你在应用程序加载时初始化对象的单个实例，然后在整个应用程序中引用同一个实例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T14:55:29.823

你是如此接近......将其实现为单例，并且您不需要多次初始化。简短的回答是在自身内部创建一个类的静态公共实例和一个公共静态方法，该方法（a）如果它当前为空，则初始化该实例，或者（b）返回已经初始化的实例。

单例模式还有更多细节需要考虑，但这应该可以帮助您入门。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T14:57:26.120

只需将 Logger.Log() 函数设为静态调用，并让它引用一个静态成员，即目录信息。然后，您只需在执行开始时设置一次目录信息成员，随后对 Logger.Log() 的所有调用都将“正常工作”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T14:58:34.263

辛格尔顿。您可以使用静态类，因此不必实例化它。然后，如果你有一个日志目录，有一个默认的日志路径和一个可空参数到 writelog 方法或覆盖的方法签名，一个接受路径，一个假设来自配置文件的默认值。

# asp.net - 如何从 WCF 服务返回大而复杂的对象？

> ID：677748
> 
> 赞同：0
> 
> 时间：2009-03-24T14:53:06.427
> 
> 标签：asp.net, wcf

我认为在尝试返回复杂对象（具有嵌套对象和嵌套对象的对象..）时，我遇到了序列化或大小问题。

错误代码我得到一个 CommunicationException。任何想法？

编辑：这是堆栈跟踪

```
A first chance exception of type 'System.ServiceModel.CommunicationException' occurred in mscorlib.dll
System.ServiceModel.CommunicationException: Connessione sottostante chiusa: Chiusura imprevista della connessione.. ---> System.Net.WebException: Connessione sottostante chiusa: Chiusura imprevista della connessione..
   in System.Net.HttpWebRequest.GetResponse()
   in System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
   --- Fine dell'analisi dello stack dell'eccezione interna ---

Server stack trace: 
   in System.ServiceModel.Channels.HttpChannelUtilities.ProcessGetResponseWebException(WebException webException, HttpWebRequest request, HttpAbortReason abortReason)
   in System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)
   in System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout)
   in System.ServiceModel.Channels.ClientReliableChannelBinder`1.RequestClientReliableChannelBinder`1.OnRequest(TRequestChannel channel, Message message, TimeSpan timeout, MaskingMode maskingMode)
   in System.ServiceModel.Channels.ClientReliableChannelBinder`1.Request(Message message, TimeSpan timeout, MaskingMode maskingMode)
   in System.ServiceModel.Channels.ClientReliableChannelBinder`1.Request(Message message, TimeSpan timeout)
   in System.ServiceModel.Security.SecuritySessionClientSettings`1.SecurityRequestSessionChannel.Request(Message message, TimeSpan timeout)
   in System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout)
   in System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
   in System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs)
   in System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
   in System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)

Exception rethrown at [0]: 
   in System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   in System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
   in RecuperoPagati.DataCoreReference.IDataCoreService.GetDossierByNumDossier(String Env, String NumDossier)
   in RecuperoPagati.DataCoreReference.DataCoreServiceClient.GetDossierByNumDossier(String Env, String NumDossier) in C:\Documents and Settings\gdipietro\Documenti\Dev\Rifatturazione\RecuperoPagati\RecuperoPagati\RecuperoPagati\Service References\DataCoreReference\Reference.vb:riga 198
   in RecuperoPagati.WebUserControl1.Page_Load(Object sender, EventArgs e) in C:\Documents and Settings\gdipietro\Documenti\Dev\Rifatturazione\RecuperoPagati\RecuperoPagati\RecuperoPagati\WebUserControl1.ascx.vb:riga 8 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T20:25:34.310

我同意约翰的观点；这可能不是类型复杂性问题。要找出真正的罪魁祸首，您可以尝试将诊断日志记录添加到您的服务配置中。WCF 的跟踪和日志记录功能非常强大，可以帮助您找到大多数问题的根本原因。

如果您正在运行 VS2008，当您右键单击服务宿主项目的配置文件时，您应该会看到“编辑 WCF 配置”的菜单选项。选择“诊断”节点以启用跟踪和消息记录。

[http://msdn.microsoft.com/en-us/library/ms730064.aspx](http://msdn.microsoft.com/en-us/library/ms730064.aspx)

可以在 Service Trace Viewer Tool 中非常有效地查看此日志的输出，该工具应该已经在您的机器上（框架随附）。

[http://msdn.microsoft.com/en-us/library/ms732023.aspx](http://msdn.microsoft.com/en-us/library/ms732023.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:03:28.103

这个问题可能与类型的复杂性无关。请发布完整的异常，以及所有 InnerException。只需捕获异常并发布 ex.ToString()。

# svn - git 提交者和 SVN 用户之间的映射

> ID：677753
> 
> 赞同：28
> 
> 时间：2009-03-24T14:54:11.497
> 
> 标签：svn, git, git-svn

我正在使用 git-svn 存储一些 SVN 存储库的“登台”版本，允许其他用户从该登台存储库中提取并将更改提交回它，然后在登台存储库上的提交定期提交到上游SVN 回购。

我想知道是否有办法在 git 提交者的姓名和 SVN 用户名之间进行映射，以便在提交回 SVN 存储库时保持他们的信息完整？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-24T15:11:55.180

[Vincent Danen](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/opensource/?p=482)[在使用 git svn 时](http://git-scm.com/docs/git-svn)确实提到了 -A 选项：

> 因此，使用 ~/git 作为 Git 存储库的顶级目录会`[...]`创建一个 authors.txt 文件。
> 该文件会将 Subversion 提交者的名称映射到 Git 作者，从而生成导入的 Subversion 存储库的正确历史记录。
> 对于提交者数量较少的项目，这很容易。对于有很多提交者的大型项目，这可能需要一些时间。该文件的语法是：

```
user = Joe User <user@example.com>
vdanen = Vincent Danen <vdanen@somewhere.com> 
```

> 短名称是 Subversion 的提交者名称，而长格式是 Git 使用的用户全名和电子邮件地址。
> 
> 最后一步是克隆 Subversion 存储库，它会基于它创建一个本地 Git 存储库。假设您的存储库使用 /trunk、/tags 和 /branches 的标准，请使用：

```
# git svn clone --no-metadata -A authors.txt -t tags -b branches -T trunk https://svn.example.com/svn/repo 
```

* * *

```
-A<filename>
--authors-file=<filename> 
```

语法与 git-cvsimport 使用的文件兼容：

```
loginname = Joe User <user@example.com> 
```

> 如果指定此选项并`git-svn`遇到作者文件中不存在的 SVN 提交者名称，则 git-svn 将中止操作。
> 然后用户必须添加适当的条目。
> 在修改作者文件后重新运行之前的`git-svn`命令应该会继续运行。

```
config key: svn.authorsfile 
```

* * *

这应该适用于所有`git-svn`命令，包括`git-svn dcommit`（当你推*送到*SVN 时）（注意：虽然我没有直接测试过）。

[Mohammed Gamal](https://stackoverflow.com/users/82057/mohammed-gamal)确实报告（在评论中）它正在工作，但没有`--no-metadata`选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T14:14:42.980

第二种选择是提供解决映射的程序/脚本。

如果提交者的数量未知但可能是从 SVN 提交者名称“生成”的，则非常有用！

> 如果…作者文件中不存在的 SVN 提交者名称，git svn 将中止操作。然后用户必须添加适当的条目。在修改作者文件后重新运行之前的 git svn 命令……</p>

所以，因此我们有：

```
--authors-prog=mapMyCompanyUsers.sh 
```

为了不强迫每个用户首​​先签出/ curl / wget'ting map-Script，您可以提供如下内容：

```
$(tmpMapFile="$TMPDIR/mapSvnUsersAutomatically.$$.sh" && echo -e '#!/bin/sh\necho $1" <"$1"@example.com>"' > $tmpMapFile && chmod +x $tmpMapFile && echo $tmpMapFile) 
```

克隆将如下所示：

```
$ git svn clone -s --authors-prog=$(tmpMapFile="$TMPDIR/mapSvnUsersAutomatically.$$.sh" && echo -e '#!/bin/sh\necho $1" <"$1"@example.com>"' > $tmpMapFile && chmod +x $tmpMapFile && echo $tmpMapFile) https://svn.example.com/svn/repo/ 
```

这将强制所有映射完全相同，并且 SVN 克隆可能被“共享”并通过 git 合并！

# java - Java Webservice 和 .NET 客户端删除 DateTime 对象

> ID：677754
> 
> 赞同：1
> 
> 时间：2009-03-24T14:54:14.427
> 
> 标签：java, .net, web-services, wsdl

在 Java Web 服务和与之交谈的 .NET 客户端之间看到一些奇怪的东西。我们正在来回发送一个带有`DateTime`属性的对象。有点像这样（从 WSDL 生成）：

```
[System.CodeDom.Compiler.GeneratedCodeAttribute("wsdl", "2.0.50727.3038")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(Namespace="http://ournamespace.com/")]
public partial class myClass {
    private System.DateTime expirationDateField;
    private string nameField;

    [System.Xml.Serialization.XmlElementAttribute(Form=System.Xml.Schema.XmlSchemaForm.Unqualified)]
    public System.DateTime expirationDate {
        get {
            return this.expirationDateField;
        }
        set {
            this.expirationDateField = value;
        }
    }

    [System.Xml.Serialization.XmlElementAttribute(Form=System.Xml.Schema.XmlSchemaForm.Unqualified)]
    public string name {
        get {
            return this.nameField;
        }
        set {
            this.nameField = value;
        }
    }
} 
```

我们收到带有日期的对象就好了，但是当我们将它们发送回 Web 服务时，该`expirationDate`属性显示为`null`. 我们查看了 Java 服务器正在接收的原始 XML，并且标签`expirationDate`不存在，有点像这样：

```
<myClass><name>My Name</name></myClass> 
```

（这不是确切的 XML，但足够接近）。我仔细检查过，`expirationDate`在发送之前肯定是在 .NET 客户端上设置的。WSDL 的 XSD 看起来并不奇怪：

```
<xs:element name="Expiration" type="xs:dateTime" minOccurs="0"/> 
```

我们对其他事情使用相同的类型，它们也可以正常工作。在 .NET 方面，我们使用该`wsdl.exe`工具来生成类和代码。

我们可以采取的另一步骤是在调用 Web 服务之前查看由 .NET 生成的 XML，但我不知道该怎么做。还有其他想法或建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T15:02:23.877

当模式中的值类型是可选的时，WSDL.EXE 会为该值生成一个属性，并生成一个 bool 属性来指示该值是否存在。您应该有一个 ExpirationSpecified 属性，当您想要发送到期日期时需要将其设置为*true ，如果不发送，则需要设置为**false*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-20T11:58:47.197

除了我接受约翰的回答作为解决方案之外，我还想说明完整的机制。每当将对应于“不可为空”C# 类型的“可空”Java 类型用作 Web 服务对象类型属性时，就会发生这种情况。例如，如果使用 Java 中的原始包装类型，如“Integer”、“Boolean”，则这些类型对应于不可为空的 int、bool。因此，应该设置“*Specified”属性以便发送它们。

对于原始文档，您可以参考：http:
[//msdn.microsoft.com/en-us/library/exchange/bb402199%28v=exchg.140%29.aspx](http://msdn.microsoft.com/en-us/library/exchange/bb402199%28v=exchg.140%29.aspx)

# sql - ibati 返回值

> ID：677761
> 
> 赞同：4
> 
> 时间：2009-03-24T14:55:11.073
> 
> 标签：sql, ibatis

我目前正在使用 ibatis 返回一些 pojo，一切都很好。
我的问题是：我必须从表中返回 1 行，就像 3 个字段一样，我不想为它创建一个 pojo。我只想运行查询并获取 3 个值。有没有简单的方法可以做到这一点而无需为此创建一个特殊的 java 对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T15:00:34.833

在 IBatis.NET 中，当我们需要来自查询的多个值时，我们使用 Hashtable。

```
<resultMap id="ResultMap1"  class="Hashtable"> 
      <result column="FirstName" property="FirstName" type="string" /> 
          <!-- shows up as "FirstName"  in the Hashtable --> 
      <result column="LastName" property="LastName" type="string" /> 
          <!-- shows up as "LastName"  in the Hashtable --> 
</resultMap> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:27:52.927

我不知道有任何方法可以按照您的要求进行操作；iBATIS 的具体目的是自动将关系模型映射到类。

我不确定您要做什么，但是如果您有有意义的数据，则应该能够映射到某种对象，即使该对象是短暂的。我猜你需要一些基于你的查询获取的值的逻辑？如果是这种情况，请创建一个新的 POJO，将查询映射到它，然后将逻辑移动到新的 POJO 中，而不是现在的任何地方。这将使代码更简洁，更易于维护。

如果您只是想在不映射到类的情况下提取原始数据，您可能需要重新审视您的设计。

（我知道这不是你要找的答案......对不起。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T17:55:06.803

您可以将结果映射到 java.util.HashMap（如果要保留字段顺序，则为 LinkedHashMap）。

# .net - LinqToSQL 中 DatabaseAttribute 的意义何在？

> ID：677768
> 
> 赞同：1
> 
> 时间：2009-03-24T14:57:11.940
> 
> 标签：.net, linq-to-sql

默认情况下，LinqToSQL 上下文类使用 DatabaseAttribute 进行注释。然而，它是可选的。在我能想到的任何情况下，您都会使用连接字符串指向数据库，那么它的原因是什么。现在，我显然已经阅读了文档。哪个状态，如果您希望从连接字符串中省略它，您可以使用它来指定默认数据库。但是......为什么哦，你为什么要这样做？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T22:35:47.547

很难知道当时设计团队是怎么想的。

我猜它允许在具有多个数据库的应用程序中使用默认通用连接字符串进行可选配置。内置不支持此功能，因此我对此表示怀疑。这将允许类似：

```
<add name="GeneralConnection" ... />
<add name="GeneralConnection.SomeDataContext" ... /> 
```

所有数据上下文都将被配置为指向 GeneralConnection。一些额外的代码来检索数据上下文实例，将检查 GeneralConnection.ThatDataContext 是否存在，并在这种情况下使用带有连接字符串的构造函数。

这只是一个猜测。我没有类似的需求，我认为我不会依赖这样的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:42:49.693

嗯....好问题。我想不出这个有什么好用的。如果您想从单个连接跨越多个数据库（不同的数据上下文）（这首先不是一个好主意），它**仍然**非常无用，因为它将针对数据上下文的所有实例进行修复.

在我能想到的每一种合理的情况下，连接都定义了数据库，或者它不是问题（独立的数据库文件等）。我想知道它是否只是因为它（数据库名称的知识）存在而被放在那里，所以它可以以同样的方式（理论上）获得......

# iphone - 一位用户无法运行应用

> ID：677770
> 
> 赞同：0
> 
> 时间：2009-03-24T14:57:33.140
> 
> 标签：iphone

我有一个用户无法运行我的 iPhone 应用程序。它启动得很好，但是一旦他们在 RootViewController 中选择了一行就会崩溃。选择一行转到另一个表视图。如果没有可用的数据库，我在应用程序包中使用 sqlite 并在初始安装时部署。数据库在那里，因为 RootViewController 否则不会加载。我与用户一起尝试了一些故障排除步骤，例如：

*   从 iPhone 中删除应用程序并与 iTunes 重新同步。
*   重新启动 iPhone。
*   确认 iPhone 的版本。

以上所有尝试都无济于事。

我没有任何其他用户写过关于此类问题的文章。有没有人遇到过这样的问题并对如何解决它有一些可能的建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T15:40:12.803

我会要求您的用户从iPhone*和*iTunes中删除该应用程序*，*然后重新安装它。这将有助于确保他们不会恢复数据。

 *您可能还想确保他们没有越狱他们的手机。一般来说，我会尝试询问各种各样的信息：

*   设备类型
*   设备生成
*   操作系统版本
*   越狱状态
*   语言设置
*   区域设置
*   他们是否开启了 WiFi、蜂窝网络和 3G（如果您的应用使用 GPS，我还会询问 GPS）

最后，iTunes 可能会在他们的硬盘驱动器上存储崩溃日志（在 Mac 上它位于`~/Library/Logs/CrashReporter/MobileDevice`；我不知道 Windows 机器）。让您的用户尝试找到与您的应用相关的内容并将其发送给您。

# iphone - iphone SDK：套接字客户端...如何处理跨不同视图/类的接收数据委托？

> ID：677779
> 
> 赞同：1
> 
> 时间：2009-03-24T14:59:12.637
> 
> 标签：iphone, sockets, client

我正在为 iPhone 上的音频服务器编写控制器。每个“视图”通常需要作为客户端从 TCP/IP 套接字获取数据。我有一个使用[AsyncSocket](http://www.cocoadev.com/index.pl?AsyncSocket)类的类的套接字。（在尝试让套接字客户端工作的时间超过我想承认的时间之后，这是一个非常令人印象深刻和有用的类）。这需要编写委托函数来接收数据......

```
- (void)onSocket:(AsyncSocket *)sock didReadData:(NSData *)data withTag:(long)tag 
```

我有一个标准表视图界面，​​我在一个视图上看到了一个艺术家列表，然后选择艺术家时，我会在下一个视图上移动到专辑，依此类推。

我的问题是：当我从一个视图转到另一个视图时，发送和接收数据的最佳方式是什么？我需要为每个视图类创建一个全新的套接字吗？（似乎有点过头了）以某种方式再次链接本地接收器委托？

我似乎想不出让这个在 1 类之外工作的“正确”方法，并且关于 iphone 上的套接字客户端通信的在线信息并不多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T17:03:27.707

听起来您希望多个对象接收委托方法，对吗？在 Mac OS X 上，解决方案是使用通知系统。我没有看过这个`AsyncSocket`类，但它看起来只支持开箱即用的委托。

通知很棒，因为它们让一个对象将信息广播给任何其他有兴趣接收它的对象。对象在通知中心注册自己，以便在发布特定通知时得到通知。您可以通过实现自己的类来轻松添加此功能 wrap `AsyncSocket`。

这就是你要做的。您将编写自己的类，该类具有`AsyncSocket`作为实例变量。您可以将此类设置为`AsyncSocket`对象的委托。然后，当调用委托方法时，您会将通知发布到`NSNotificationCenter`. 您可能需要将委托方法中的参数填充到通知的`userInfo`字典中。

另一方面，您的视图控制器将`NSNotificationCenter`作为观察者注册您的自定义类发送的通知。然后，每次委托方法触发时，每个视图控制器都会收到该事件的通知。

说够了；这是一些代码：

```
extern NSString *const AsyncSocketDidReadData;

@interface MySocketWrapper : NSObject { // give this class a better name ;-)
    AsyncSocket *socket;
}

@property (nonatomic, readonly) socket;

@end 
```

在 .m 文件中：

```
NSString *const AsyncSocketDidReadData = @"AsyncSocketDidReadData";

@implementation MySocketWrapper

@synthesize socket;

- (id)init {
    if (![super init]) return nil;

    socket = [[AsyncSocket alloc] init]; // initialize this however you want
    [socket setDelegate:self];
    return self;
}

- (void)onSocket:(AsyncSocket *)aSocket didReadData:(NSData *)data withTag:(long)tag {
    NSDictionary *userInfo = 
         [NSDictionary dictionaryWithObjectsAndKeys:
          data, @"data",
          [NSNumber numberWithLong:tag], @"tag",
          nil];
    [[NSNotificationCenter defaultCenter] postNotificationName:AsyncSocketDidReadData object:self.socket userInfo:userInfo];
}

@end 
```

最后，在您的各种视图控制器中，您可以编写如下代码：

```
- (id)initWithNibName:(NSString *)nibName bundle:(NSBundle *)bundle {
    if (![super initWithNibName:nibName bundle:bundle]) return nil;

    // Do any initalization you need here

    // Note that if you specify 'nil' for object, you'll be sent notifications for every MySocketWrapper object.
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(asyncSocketDidReadData:) notification:AsyncSocketDidReadData object:nil]; 

    return self;
}

- (void)asyncSocketDidReadData:(NSNotification *)notification {
    AsyncSocket *socket = [[notification object] socket];
    NSData *theData = [[notification userInfo] objectForKey:@"data"];
    long tag = [[[notification userInfo] objectForKey:@"tag"] longValue];

    // Do what you want with the data here
} 
```

显然，这段代码并不完全完整，而且我可能弄错了一些方法名称（我是凭记忆做的），但这是一个适合您的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-21T05:51:37.170

前面的答案很好，但视图控制器片段中的“通知：”应该是“名称：”。

# database - 基于键值的数据库，有人可以向我解释如何实际使用它们吗？

> ID：677780
> 
> 赞同：5
> 
> 时间：2009-03-24T14:59:25.117
> 
> 标签：database, performance, scalability, key-value

似乎对基于键/值的数据库有很大的推动作用，我相信 memcache 就是这样。

该值通常是某种可以保存更有意义数据的集合或 xml 文件吗？

如果是，反序列化数据通常比在返回基于行的结果集的表上执行传统的 JOINS 和选择更快吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T15:29:13.377

所发生的事情是，像谷歌和亚马逊这样的一些非常、**非常**、**非常**大的网站占据了一个很小很小的利基市场，它们的数据存储和检索要求与其他任何人都如此不同，以至于需要一种新的存储/检索数据的方法。我确信这些人知道他们在做什么，他们非常擅长他们所做的事情。

但是，然后这会被拾取并报告并扭曲为“关系数据库无法处理网络数据”。此外，读者开始认为“嘿，如果关系数据库对 Amazon 和 Google 来说不够好，那么它们对我来说也不够好。”

这些推论都是错误的：99.9% 的数据库（包括网站背后的数据库）与亚马逊和谷歌不在同一个球场——不在几个数量级之内。对于这 99.9%，没有任何改变，关系数据库仍然可以正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T15:09:47.573

与大多数事情一样，“这取决于”。如果连接相对无关紧要（即，少量连接在良好键控的数据上），并且您正在存储特别复杂的数据，那么坚持使用更复杂的查询可能会更好。

这也是新鲜度的问题。在许多情况下，许多连接的目的是汇集非常不同的数据。也就是说，数据的相对新鲜度差异很大。当跨大量数据对的一小部分数据被更新时，保持键值对表同步会增加*相当大的复杂性和开销。*系统复杂性通常可以被认为是性能成本的一种形式；在不影响性能的情况下对复杂系统进行更改所花费的时间、风险和成本通常远大于简单的系统。

最好的解决方案总是**尽可能简单地编写代码**。在大多数情况下，我会说这意味着创建一个完全规范化的数据库设计并加入其中的废话。只有在性能成为明显问题*后才重新审视您的设计。*当您分析问题时，问题所在以及需要采取哪些措施来解决这些问题也很明显。如果它正在减少连接，那就这样吧。你会知道什么时候需要知道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-24T15:15:30.837

我在键/值数据库方面没有很多经验，所以对我所说的话持保留态度。

话虽如此，我首先要指出的是 memcached 不是键/值*数据库*。数据库意味着某种持久存储，而 memcached 不是。Memcached 旨在成为一个临时存储，用于将查询保存到实际数据库中。

除此之外，我的理解是您将无法用键/值数据库替换您的 RDBMS。它们往往最适合非结构化数据或您可能不知道需要存储的所有属性的其他数据。如果您需要存储高度结构化的数据，那么您无法比传统的 RDBMS 做得更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T15:51:06.617

它们*可以*是需要反序列化的复杂结构化数据。它们也可以是简单的固定大小记录，就像您的 RDBMS 一样。部分好处是您可以自己做出决定。在优化数据库时，您不仅限于 SQL 可以做什么。

你问的方式听起来像是加入或反序列化将永远是瓶颈。但在任何数据库中，事情从来没有那么简单。您也可以将非规范化数据放入 RDBMS 中，或者在键值数据库之上编写 RDBMS 接口，如果您真的需要的话。

# java - Webshpere 上的外部 javascript 字符编码

> ID：677786
> 
> 赞同：1
> 
> 时间：2009-03-24T15:00:06.707
> 
> 标签：java, encoding, character-encoding, websphere

如何仅使用 Websphere (5.1) 在外部 JavaScript 文件上设置字符编码？我前面没有 Apache，所以我不能使用“AddCharset UTF-8 .js”来设置它。

或者也许还有其他方法可以通过 web.xml 或类似的魔法将其强制到 Web 容器上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:28:36.950

请参阅[http://www-01.ibm.com/software/globalization/j2ee/encoding.jsp](http://www-01.ibm.com/software/globalization/j2ee/encoding.jsp)

您还可以通过 servlet 提供 JavaScript 文件。

# powershell - Powershell Copy-Item，但仅复制更改的文件

> ID：677789
> 
> 赞同：29
> 
> 时间：2009-03-24T15:00:38.813
> 
> 标签：powershell, xcopy, copy-item

我正在尝试通过目录递归并将其从 A 复制到 B。这可以通过以下方式完成：

```
Copy-Item C:\MyTest C:\MyTest2 –recurse 
```

我希望能够只复制新文件（存在于 src 但不存在于 dest 中的文件），并且只复制可能基于 CRC 检查而不是日期时间戳而更改的文件。

```
$file = "c:\scripts"
param
(
$file
)

$algo = [System.Security.Cryptography.HashAlgorithm]::Create("MD5")
$stream = New-Object System.IO.FileStream($file, [System.IO.FileMode]::Open)

$md5StringBuilder = New-Object System.Text.StringBuilder
$algo.ComputeHash($stream) | `
% { [void] $md5StringBuilder.Append($_.ToString("x2")) }
$md5StringBuilder.ToString()

$stream.Dispose() 
```

此代码为我提供了对特定文件的 CRC 检查...我只是不确定如何将两个脚本放在一起以真正满足我的需求。我也不知道上面的 CRC 检查是否真的是这样做的正确方法。

有没有人有任何见解？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2011-03-25T13:32:24.287

[这两个都是 powershell 的可靠答案，但仅利用Robocopy](http://ss64.com/nt/robocopy.html)（MS 提供的健壮复制应用程序）可能会容易得多。

```
robocopy "C:\SourceDir\" "C:\DestDir\" /MIR 
```

会完成同样的事情。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-24T16:18:46.597

以下是一些指导方针，您可以如何使您的脚本更易于维护。

将原始脚本转换为过滤器。

```
filter HasChanged { 
    param($file)

    # if $file's MD5 has does not exist
    # then return $_
} 
```

然后只需过滤所有更新的文件并复制它们。

```
# Note that "Copy-Item" here does not preserve original directory structure
# Every updated file gets copied right under "C:\MyTest2"
ls C:\MyTest -Recurse | HasChanged | Copy-Item -Path {$_} C:\MyTest2 
```

或者您可以创建另一个生成子目录的函数

```
ls C:\MyTest -Recurse | HasChanged | % { Copy-Item $_ GenerateSubDirectory(...) } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-24T16:04:45.850

我找到了一个解决方案......但不确定从性能角度来看它是最好的：

```
$Source = "c:\scripts"
$Destination = "c:\test"
###################################################
###################################################
Param($Source,$Destination)
function Get-FileMD5 {
    Param([string]$file)
    $mode = [System.IO.FileMode]("open")
    $access = [System.IO.FileAccess]("Read")
    $md5 = New-Object System.Security.Cryptography.MD5CryptoServiceProvider
    $fs = New-Object System.IO.FileStream($file,$mode,$access)
    $Hash = $md5.ComputeHash($fs)
    $fs.Close()
    [string]$Hash = $Hash
    Return $Hash
}
function Copy-LatestFile{
    Param($File1,$File2,[switch]$whatif)
    $File1Date = get-Item $File1 | foreach-Object{$_.LastWriteTimeUTC}
    $File2Date = get-Item $File2 | foreach-Object{$_.LastWriteTimeUTC}
    if($File1Date -gt $File2Date)
    {
        Write-Host "$File1 is Newer... Copying..."
        if($whatif){Copy-Item -path $File1 -dest $File2 -force -whatif}
        else{Copy-Item -path $File1 -dest $File2 -force}
    }
    else
    {
        #Don't want to copy this in my case..but good to know
        #Write-Host "$File2 is Newer... Copying..."
        #if($whatif){Copy-Item -path $File2 -dest $File1 -force -whatif}
        #else{Copy-Item -path $File2 -dest $File1 -force}
    }
    Write-Host
}

# Getting Files/Folders from Source and Destination
$SrcEntries = Get-ChildItem $Source -Recurse
$DesEntries = Get-ChildItem $Destination -Recurse

# Parsing the folders and Files from Collections
$Srcfolders = $SrcEntries | Where-Object{$_.PSIsContainer}
$SrcFiles = $SrcEntries | Where-Object{!$_.PSIsContainer}
$Desfolders = $DesEntries | Where-Object{$_.PSIsContainer}
$DesFiles = $DesEntries | Where-Object{!$_.PSIsContainer}

# Checking for Folders that are in Source, but not in Destination
foreach($folder in $Srcfolders)
{
    $SrcFolderPath = $source -replace "\\","\\" -replace "\:","\:"
    $DesFolder = $folder.Fullname -replace $SrcFolderPath,$Destination
    if(!(test-path $DesFolder))
    {
        Write-Host "Folder $DesFolder Missing. Creating it!"
        new-Item $DesFolder -type Directory | out-Null
    }
}

# Checking for Folders that are in Destinatino, but not in Source
foreach($folder in $Desfolders)
{
    $DesFilePath = $Destination -replace "\\","\\" -replace "\:","\:"
    $SrcFolder = $folder.Fullname -replace $DesFilePath,$Source
    if(!(test-path $SrcFolder))
    {
        Write-Host "Folder $SrcFolder Missing. Creating it!"
        new-Item $SrcFolder -type Directory | out-Null
    }
}

# Checking for Files that are in the Source, but not in Destination
foreach($entry in $SrcFiles)
{
    $SrcFullname = $entry.fullname
    $SrcName = $entry.Name
    $SrcFilePath = $Source -replace "\\","\\" -replace "\:","\:"
    $DesFile = $SrcFullname -replace $SrcFilePath,$Destination
    if(test-Path $Desfile)
    {
        $SrcMD5 = Get-FileMD5 $SrcFullname
        $DesMD5 = Get-FileMD5 $DesFile
        If(Compare-Object $srcMD5 $desMD5)
        {
            Write-Host "The Files MD5's are Different... Checking Write
            Dates"
            Write-Host $SrcMD5
            Write-Host $DesMD5
            Copy-LatestFile $SrcFullname $DesFile
        }
    }
    else
    {
        Write-Host "$Desfile Missing... Copying from $SrcFullname"
        copy-Item -path $SrcFullName -dest $DesFile -force
    }
}

# Checking for Files that are in the Destinatino, but not in Source
foreach($entry in $DesFiles)
{
    $DesFullname = $entry.fullname
    $DesName = $entry.Name
    $DesFilePath = $Destination -replace "\\","\\" -replace "\:","\:"
    $SrcFile = $DesFullname -replace $DesFilePath,$Source
    if(!(test-Path $SrcFile))
    {
        Write-Host "$SrcFile Missing... Copying from $DesFullname"
        copy-Item -path $DesFullname -dest $SrcFile -force
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-23T12:09:10.470

这是我在备份文件夹中**仅复制新文件的解决方案**

```
$ImagesFolder = 'D:\img temp\from'
$BackupImagesFolder = 'D:\img temp\to'

$ImagesFiles = Get-ChildItem -Path $ImagesFolder
$BackUpImagesFiles = (Get-ChildItem -Path $BackupImagesFolder).Name

foreach($image in $ImagesFiles)
{
    $fileName = $image.Name;
    if($BackUpImagesFiles -notcontains $fileName)
    {
        Copy-Item $image.FullName -Destination $BackupImagesFolder
    }
} 
```

享受 ：）

# python - 在 Django 通用视图中指定不同的模板名称

> ID：677793
> 
> 赞同：2
> 
> 时间：2009-03-24T15:00:49.653
> 
> 标签：python, django, django-urls

我的 urls.py 中有用于通用视图的代码；

```
infodict = {
'queryset': Post.objects.all(),
'date_field': 'date',
'template_name': 'index.html',
'template_object_name': 'latest_post_list',
}

urlpatterns += patterns('django.views.generic.date_based',
(r'^gindex/$', 'archive_index', infodict),
) 
```

因此，转到地址 /gindex/ 将使用带有“index.html”模板的通用视图。

但是由于我将在这个 urlpattern 中有更多通用视图，我应该如何使用相同的 infodict 提供不同的模板名称？我不想使用大量的信息字典，也不能使用默认的模板名称。

请注意，这也适用于 infodict 中的模板对象名称。

谢谢你的帮助！

**编辑**：这是我关于 stackoverflow 的第一个问题，我对彻底的答案感到惊讶！我更喜欢使用我不知道的 dict 构造函数。我发现使用 python 文档有点困难，因为我通常找不到我要找的东西！

再次感谢所有答案和不同的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T17:35:51.653

使用 dict() 构造函数：

```
infodict = {
    'queryset': Post.objects.all(),
    'date_field': 'date',
    'template_name': 'index.html',
    'template_object_name': 'latest_post_list',
}

urlpatterns = patterns('django.views.generic.date_based',
    url(r'^gindex/$', 'archive_index', dict(infodict, template_name='gindex.html')),
    url(r'^hindex/$', 'archive_index', dict(infodict, template_name='hindex.html')),
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T15:15:01.010

如果您想为不同的视图提供不同的模板名称，通常的做法确实是将唯一的字典传递给每个 URL 模式。例如：

```
urlpatterns = patterns('',
    url(r'^home/$', 'my.views.home', {'template_name': 'home.html'}, name='home'),
    url(r'^about/$', 'my.views.about', {'template_name': 'about.html'}, name='about'),
) 
```

这种模式很常见并且可以接受。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T15:31:53.323

不是那么简单，但如果您有很多不同的模式匹配同一个视图，则可能很有用：

```
base_dict={
...
#defaults go here
}
def make_dict(template_name,template_object_name):
    base_dict.update({
        'template_name':template_name,
        'template_object_name':template_object_name,
    })
    return base_dict

urlpatterns += patterns('django.views.generic.date_based',
(r'^gindex/$', 'archive_index', make_dict('index1.html','latest_poll_list')),
(r'^hindex/$', 'archive_index', make_dict('index2.html','oldest_poll_list')),
) 
```

对于许多类似的通用视图，这会稍微压缩你的代码调用，但会牺牲一点透明度。如果您有很多行自定义相同的几个参数，这可能最容易阅读。

最后，如果您的所有或大部分视图都需要一些（但不是全部）相同的信息，请永远不要忘记[上下文处理器](http://docs.djangoproject.com/en/dev/ref/templates/api/?from=olddocs#writing-your-own-context-processors)是多么有用。设置只需要比上述解决方案多一点工作，但它扩展得更好，因为它将保证（除非您使用没有 RequestContext 关键字的 render_to_response 快捷方式）默认值将始终可用于您的模板无论如何您的视图或 url 配置更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T15:48:03.050

您可以定义包装视图函数来参数化通用视图。在你的 urls.py 添加模式

```
url(r'^/(?P<tmpl_name>\w+)/$', 'my.views.datebasedproxy') 
```

在你的 views.py 添加视图功能

```
def datebasedproxy(request, tmpl_name):
    return django.views.generic.date_based(request,otherparameters,
    template_name=tmpl_matrix[tmpl_name]) 
```

其中 tmpl_matrix 是将模板文件名与参数匹配的假设列表，而 otherparameters 代表基于 date_based 的函数所需的其他字典项

# wpf - 如何允许用户对 LINQ-to-SQL WPF 数据网格上的列进行排序？

> ID：677799
> 
> 赞同：0
> 
> 时间：2009-03-24T15:01:55.003
> 
> 标签：wpf, linq, datagrid

[我已经使用March 2009 WPF Toolkit](http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25047)成功设置了 WPF Datagrid，从 Northwind 数据库创建了 LINQ-to-SQL 类，使用以下代码绑定了 WPF 网格：

```
var customers = from c in _db.Customers
                select c;
TheDataGrid.ItemsSource = customers; 
```

我可以从左到右移动列，删除列，等等。

但是，当我单击列标题对其进行排序时，我的输出窗口中出现了大约 20 对错误，看起来每列都有一对错误：

> ***System.Windows.Data 错误：1：无法创建默认转换器以在类型“System.Data.Linq.EntitySet`1[TestDataGrid566.Model.Order]”和“System.String”之间执行“双向”转换。考虑使用 Binding 的 Converter 属性。绑定表达式：路径=订单；DataItem='客户' (HashCode=4925117); 目标元素是'TextBlock'（名称=''）；目标属性是“文本”（类型“字符串”）***
> 
> ***System.Windows.Data 错误：5：BindingExpression 生成的值对目标属性无效。；Value='System.Data.Linq.EntitySet`1[TestDataGrid566.Model.Order]' BindingExpression:Path=Orders; DataItem='客户' (HashCode=4925117); 目标元素是'TextBlock'（名称=''）；目标属性是“文本”（类型“字符串”）***

当我创建 LINQ-to-SQL 类时，我只是将所有表从数据库拖到模型设计器并保存，因此这些类都是默认代码。

**这些错误告诉我什么？**我只是没有正确设置 LINQ-to-SQL 类还是指向更深层次的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T15:23:11.800

我认为您应该将查询转换为列表。

```
var customers = from c in _db.Customers
                select c;
TheDataGrid.ItemsSource = customers.ToList(); //note the .ToList() call 
```

否则，DataGrid 会尝试重新枚举查询，这是一个坏主意，因为查询结果是延迟加载的集合。

# c# - 模拟和 HttpContextBase.get_User()

> ID：677801
> 
> 赞同：4
> 
> 时间：2009-03-24T15:02:23.800
> 
> 标签：c#, asp.net-mvc, rhino-mocks

我想模拟 HttpContext 的 User 属性。我正在使用 Scott Hanselmans MVCHelper 类和 RhinoMocks。

我有一个包含代码的单元测试，如下所示：

...

```
MockIdentity fakeId = new MockIdentity("TEST_USER", "Windows", true);
MockPrincipal fakeUser = new MockPrincipal(null, fakeId);

using (mocks.Record())
{
    Expect.Call(fakeHttpContext.User).Return(fakeUser);
} 
```

...

我的 MockIdentity 和 MockPrincipal 类分别是符合 IIdentity 和 IPrincipal 的模拟。

运行报告的单元测试时出现错误：

> System.NotImplementedException ：方法或操作未实现。在 System.Web.HttpContextBase.get_User()

当我尝试为 User 属性设置期望时，就会发生这种情况。

我知道 httpContextBase 有一个未实现的 getter 和 setter，但我认为 Rhino 在模拟时会处理这个问题。

这是否意味着我必须从 HttpContextbase 派生并覆盖我的模拟对象的属性。这似乎很奇怪。

其他用户也遇到过这个问题，在这里报告：http: [//www.mail-archive.com/rhinomocks@googlegroups.com/msg00546.html](http://www.mail-archive.com/rhinomocks@googlegroups.com/msg00546.html)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-24T15:22:38.010

我遇到了几乎同样的问题，然后搬到了 Moq。

这是我在应用程序中使用的自定义助手：

```
public static class MvcMockHelpers
    {
        public static HttpContextBase FakeHttpContext()
        {

            var context = new Mock<HttpContextBase>();
            var request = new Mock<HttpRequestBase>();
            var response = new Mock<HttpResponseBase>();
            var session = new Mock<HttpSessionStateBase>();
            var server = new Mock<HttpServerUtilityBase>();

            context.Expect(ctx => ctx.Request).Returns(request.Object);
            context.Expect(ctx => ctx.Response).Returns(response.Object);
            context.Expect(ctx => ctx.Session).Returns(session.Object);
            context.Expect(ctx => ctx.Server).Returns(server.Object);

            var form = new NameValueCollection();
            var querystring = new NameValueCollection();
            var cookies = new HttpCookieCollection();
            var user = new GenericPrincipal(new GenericIdentity("testuser"), new string[] { "Administrator" });

            request.Expect(r => r.Cookies).Returns(cookies);
            request.Expect(r => r.Form).Returns(form);
            request.Expect(q => q.QueryString).Returns(querystring);

            response.Expect(r => r.Cookies).Returns(cookies);

            context.Expect(u => u.User).Returns(user);

            return context.Object;
        }

        public static HttpContextBase FakeHttpContext(string url)
        {
            HttpContextBase context = FakeHttpContext();
            context.Request.SetupRequestUrl(url);

            return context;

        }

        public static void SetFakeControllerContext(this Controller controller)
        {
            var httpContext = FakeHttpContext();
            ControllerContext context = new ControllerContext(new RequestContext(httpContext, new RouteData()), controller);
            controller.ControllerContext = context;
        }

        public static void SetFakeControllerContext(this Controller controller, RouteData routeData)
        {
            SetFakeControllerContext(controller, new Dictionary<string, string>(), new HttpCookieCollection(), routeData);
        }

        public static void SetFakeControllerContext(this Controller controller, HttpCookieCollection requestCookies)
        {
            SetFakeControllerContext(controller,new Dictionary<string,string>(),requestCookies, new RouteData());
        }

        public static void SetFakeControllerContext(this Controller controller, Dictionary<string, string> formValues)
        {
            SetFakeControllerContext(controller, formValues, new HttpCookieCollection(), new RouteData());
        }

        public static void SetFakeControllerContext(this Controller controller,
            Dictionary<string, string> formValues,
            HttpCookieCollection requestCookies,
            RouteData routeData)
        {
            var httpContext = FakeHttpContext();

            foreach (string key in formValues.Keys)
            {
                httpContext.Request.Form.Add(key, formValues[key]);

            }
            foreach (string key in requestCookies.Keys)
            {
                httpContext.Request.Cookies.Add(requestCookies[key]);

            }
            ControllerContext context = new ControllerContext(new RequestContext(httpContext, routeData), controller);
            controller.ControllerContext = context;
        }

        public static void SetFakeControllerContextWithLogin(this Controller controller, string userName,
            string password,
            string returnUrl)
        {

            var httpContext = FakeHttpContext();

            httpContext.Request.Form.Add("username", userName);
            httpContext.Request.Form.Add("password", password);
            httpContext.Request.QueryString.Add("ReturnUrl", returnUrl);

            ControllerContext context = new ControllerContext(new RequestContext(httpContext, new RouteData()), controller);
            controller.ControllerContext = context;
        }

        static string GetUrlFileName(string url)
        {
            if (url.Contains("?"))
                return url.Substring(0, url.IndexOf("?"));
            else
                return url;
        }

        static NameValueCollection GetQueryStringParameters(string url)
        {
            if (url.Contains("?"))
            {
                NameValueCollection parameters = new NameValueCollection();

                string[] parts = url.Split("?".ToCharArray());
                string[] keys = parts[1].Split("&".ToCharArray());

                foreach (string key in keys)
                {
                    string[] part = key.Split("=".ToCharArray());
                    parameters.Add(part[0], part[1]);
                }

                return parameters;
            }
            else
            {
                return null;
            }
        }

        public static void SetHttpMethodResult(this HttpRequestBase request, string httpMethod)
        {
            Mock.Get(request)
                .Expect(req => req.HttpMethod)
                .Returns(httpMethod);
        }

        public static void SetupRequestUrl(this HttpRequestBase request, string url)
        {
            if (url == null)
                throw new ArgumentNullException("url");

            if (!url.StartsWith("~/"))
                throw new ArgumentException("Sorry, we expect a virtual url starting with \"~/\".");

            var mock = Mock.Get(request);

            mock.Expect(req => req.QueryString)
                .Returns(GetQueryStringParameters(url));
            mock.Expect(req => req.AppRelativeCurrentExecutionFilePath)
                .Returns(GetUrlFileName(url));
            mock.Expect(req => req.PathInfo)
                .Returns(string.Empty);
        } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-24T16:31:01.340

要模拟用户属性，您可以这样做：

```
var httpContext = MockRepository.GenerateStub<HttpContextBase>();
httpContext.Stub(x=>x.User).Return(yourFakePrincipalHere);

var controllerContext = new ControllerContext(httpContext, ....);

var controller = new HomeController();
controller.ControllerContext = controllerContext; 
```

（这使用了新的 RM 3.5 api，如果你正在使用记录/重播，那么：

```
using(mocks.Record)
{
   _httpContext = _mocks.DynamicMock<HttpContextBase>();
   SetupResult.For(_httpContext.User).Return(...);
}

using(mocks.PlayBack())
{
   ....
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-17T10:28:19.577

*[免责声明：我在[Typemock](http://www.typemock.com)工作]*

我知道这不是您所要求的，但是查看上面的答案，我必须展示另一种方法来做您需要的事情 - 使用[Isolator](http://www.typemock.com/typemock-isolator-product/)：

```
var fakeId = Isolate.Fake.Instance<IIdentity>();
Isolate.WhenCalled(() => fakeId.AuthenticationType).WillReturn("Windows");
Isolate.WhenCalled(() => fakeId.Name).WillReturn("TEST_USER");
Isolate.WhenCalled(() => fakeId.IsAuthenticated).WillReturn(true);

var fakePrincipal = Isolate.Fake.Instance<IPrincipal>();
Isolate.WhenCalled(() => fakePrincipal.Identity).WillReturn(fakeId);

var fakeContext = Isolate.Fake.Instance<HttpContext>();
Isolate.WhenCalled(() => fakeContext.User).WillReturn(fakePrincipal); 
```

# c# - 将参数从 lambda 函数更改为 lambda 表达式

> ID：677803
> 
> 赞同：7
> 
> 时间：2009-03-24T15:02:36.873
> 
> 标签：c#, lambda

我有扩展方法：

```
public static IQueryable<TResult> WithFieldLike<TResult>(
   this IQueryable<TResult> query,
   Func<TResult, string> field,
   string value)
{
   Expression<Func<TResult, bool>> expr = 
       trans => field(trans).Contains(value);
   return query.Where(expr);
} 
```

我需要更改参数字段以键入：表达式>。会是这样的。

```
public static IQueryable<TResult> WithFieldLike<TResult>(
   this IQueryable<TResult> query,
   Expression<Func<TResult, string>> field,
   string value)
{
   Expression<Func<TResult, bool>> expr = ???
   return query.Where(expr);
} 
```

这个方法的调用是：

```
var query7 = query.WithFieldLike(trans => trans.DeviceModelNumber, "ber_3"); 
```

在这种情况下我应该如何构建“expr”？请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T15:16:37.510

解构`field`并创建一个新表达式，如下所示：

```
var expr = Expression.Lambda<Func<TResult, bool>> (
    Expression.Call (field.Body, typeof (string).GetMethod ("Contains"),
        Expression.Constant (value)), field.Parameters) ; 
```

*（根据 Maxs 在评论中的改进进行了编辑）*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T15:20:11.747

您需要使用`Expression.Invoke`; 类似（未经测试）：

```
public static IQueryable<TResult> WithFieldLike<TResult>(
   this IQueryable<TResult> query,
   Expression<Func<TResult, string>> field,
   string value)
{
    var param = Expression.Parameter(typeof(TResult), "x");
    var expr = Expression.Lambda<Func<TResult, bool>>(
        Expression.Call(Expression.Invoke(field, param),
            "Contains", null, Expression.Constant(value)), param);

    return query.Where(expr);
} 
```

（编辑：固定）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T15:11:44.683

使用[Compile](http://msdn.microsoft.com/en-us/library/bb345362.aspx)使 lambda 退出：

```
Expression<Func<TResult, bool>> expr = 
   trans => field.Compile()(trans).Contains(value); 
```

编辑：哎呀——我的空气编译器让我失望了。编译后，您将获得委托。但是，您仍然需要调用它来获取要调用 Contains 的字符串。

# jquery - 在 jQuery 1.3.2 中执行 .next 时递归过多

> ID：677810
> 
> 赞同：1
> 
> 时间：2009-03-24T15:04:02.690
> 
> 标签：jquery

我刚刚升级到 jQuery 1.3.2，大部分都很好，但是当涉及到新的事件模型时我错过了一些东西（我认为）

```
$(document).ready(function()
{

    $(".AspNet-Menu-NonLink").click(function()
    {
        $(this).next($("ul")).slideToggle("fast");
    });
    $(".AspNet-Menu-NonLink").next($("ul")).hide();
    $(".AspNet-Menu-ChildSelected").next($("ul")).show();
}); 
```

这曾经有效，但在这一行弹出错误“递归过多”：

```
$(".AspNet-Menu-NonLink").next($("ul")).hide(); 
```

这怎么会导致递归，hide() 隐藏了一些东西，出了什么问题？

**更新**

我发现如果我删除对 j​​Query UI 1.7.1 脚本库的引用，问题就会消失。即使我没有调用 jQuery UI 库中的任何内容，但将其包含在内，我也会收到错误消息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T15:07:19.623

对于初学者，请尝试使用

```
$(".AspNet-Menu-NonLink").next("ul").hide(); 
```

反而。

否则，您将隐式搜索并返回页面上的*所有* `ul`元素，然后将*大量*结果传递给“ `next`”函数。

根据[文档](http://docs.jquery.com/Traversing/next#overview)， ' `next`' 接受一个字符串，一个表达式，用于过滤其遍历。

`$("ul")`然而，执行一个 DOM 查询并返回一个 jQuery 对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T15:07:37.953

而不是这个：

```
$(".AspNet-Menu-NonLink").next($("ul")).hide(); 
```

尝试这个：

```
$(".AspNet-Menu-NonLink").next("ul").hide(); 
```

调用时`next()`，只需要传递一个 CSS 选择器字符串，而不是整个 jQuery 对象。文档：[http ://docs.jquery.com/Traversing/next#expr](http://docs.jquery.com/Traversing/next#expr)

jQuery UI 可能有问题，因为当它被导入您的应用程序时，它会覆盖标准的 jQuery`hide()`函数。请参阅源代码中的第 3812 行：http: [//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.js](http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.js)

# python - Python 和 MySQL：有没有 MySQLdb 的替代品？

> ID：677811
> 
> 赞同：15
> 
> 时间：2009-03-24T15:04:09.817
> 
> 标签：python, mysql, database

是否有一个纯粹用 Python 编写的模块，允许脚本与 MySQL 数据库通信？我已经尝试过 MySQLdb 没有成功。它需要太多：GCC、zlib 和 openssl。我无权使用这些工具；即使我这样做了，我也不想浪费时间让他们一起工作。我正在寻找可以让我的工作更轻松的工具。

有人可以指出我用 Python 编写的 MySQL Python 模块的方向吗？如果没有，我将不胜感激编写我自己的代码以与 MySQL 通信的提示。

谢谢，

托尼

* * *

谢谢大家的回答。由于我正在使用一个小型数据库（几百条记录，主要是名称和地址），我决定使用 SQLite。我刚刚发现它。它似乎非常适合我的目的；它安装简单（大约需要两分钟），并且可以很好地与 Python 配合使用。我坚持使用 Python 2.4，所以我不能使用 sqlite3 模块，但我可以通过使用 Python 的“subprocess.Popen”函数和命令行参数与数据库进行通信。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T15:57:04.497

你看过这些吗？

[http://wiki.python.org/moin/MySQL](http://wiki.python.org/moin/MySQL)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-30T18:50:18.447

最近还有[oursql](http://pypi.python.org/pypi/oursql/) ( [docs](http://packages.python.org/oursql/) )，它比 MySQLdb 和其他现有驱动程序具有各种优势——列在文档的顶部。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-24T16:40:39.260

Oracle 实现了一个纯 python mysql 连接器，恰当地命名为[mysql-connector-python](https://github.com/mysql/mysql-connector-python)。它可以通过 pip 安装并接收大量更新。

请注意，它是 GPL 许可的，这对您的项目可能是也可能不是问题。如果你不能忍受，你也可以选择[PyMySQL](https://pypi.org/project/PyMySQL/)，它是少数几个运行良好的连接器之一，在 MIT 下分发。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-12-27T16:18:31.993

我有一个问题，我想编写适用于 Python 2 和 Python 3 的代码。我发现[`pymysql`](https://pymysql.readthedocs.io/en/latest/)它非常适合。我无需调整代码即可从 MySQLdb 切换到 pymysql

## 安装

```
$ pip install PyMySQL 
```

如果您没有管理员权限：

```
$ pip install -u PyMySQL 
```

## 用法

用法与 MySQLdb 相同：

### 选择

```
import pymysql
import pymysql.cursors
connection = pymysql.connect(host=mysql['host'],
                             user=mysql['user'],
                             passwd=mysql['passwd'],
                             db=mysql['db'],
                             cursorclass=pymysql.cursors.DictCursor)
cursor = connection.cursor()
sql = ("SELECT `id`, `formula_in_latex` FROM `wm_formula` "
       "WHERE `is_important` = 1 "
       "AND id != 1 "  # exclude trash class
       "ORDER BY `id` ASC")
cursor.execute(sql)
formulas = cursor.fetchall() 
```

## 插入

```
import pymysql
connection = pymysql.connect(host=mysql['host'],
                             user=mysql['user'],
                             passwd=mysql['passwd'],
                             db=mysql['db'])
cursor = connection.cursor()
cursor.execute("INSERT INTO `toys` (`id`, `arrival`, `duration`) "
               "VALUES ('1', '2014-12-01', '123');")
connection.commit() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T15:19:39.890

您可以为大多数操作系统找到 MySQLdb 及其依赖项的预构建二进制包。

[http://sourceforge.net/project/showfiles.php?group_id=22307&package_id=15775](http://sourceforge.net/project/showfiles.php?group_id=22307&package_id=15775)

你在什么平台上运行？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-12-01T07:34:11.353

正如前面的回答中提到的，MySQL 连接器/Python 完全用 Python 实现了 MySQL 服务器/客户端。无需编译，只需安装。

以下是链接：
* [https://launchpad.net/myconnpy](https://launchpad.net/myconnpy)
* 代码：[https](https://code.launchpad.net/myconnpy)
://code.launchpad.net/myconnpy * 下载：[https](https://launchpad.net/myconnpy/+download) ://launchpad.net/myconnpy/+download（开发截图）

它还没有完成，但它应该足以让你继续前进。（仅供参考，我是维护者）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T15:11:47.677

毫无疑问，MySQLdb 是最好的解决方案，但如果你不能使用它……</p>

如果你有`libmysqlclient`.[ `so`| []，您可以使用ctypes](http://docs.python.org/library/ctypes.html)模块`dll`直接访问它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T15:12:02.170

据我所知，没有直接的选择。[我唯一能想到的就是通过pyodbc](http://pyodbc.sourceforge.net/)使用 ODBC 。MySQL 站点有一个可以[下载](http://dev.mysql.com/downloads/connector/odbc/5.1.html)的 ODBC 连接器。但我自己从未使用过这种方法，所以我不能说它的效果如何。

# c++ - 当程序退出时，是否有理由在 C++ 中调用 delete？

> ID：677812
> 
> 赞同：52
> 
> 时间：2009-03-24T15:05:38.067
> 
> 标签：c++, memory-management, dynamic, heap-memory

例如，在我的 C++`main`函数中，如果我有一个指向使用堆内存（而不是堆栈内存）的变量的指针 - 这会在我的应用程序退出后自动释放吗？我会这样认为。

即便如此，即使您认为在退出时自动释放内存的情况下永远不会使用它们，也总是删除堆分配是一种好习惯吗？

例如，这样做有什么意义吗？

```
int main(...)
{
    A* a = new A();
    a->DoSomething();
    delete a;
    return 0;
} 
```

我在想*，*如果我重构（或其他人重构）该代码并将其放在应用程序中的其他位置，`delete`那么真的有必要。

除了 Brian R. Bondy 的回答（专门讨论了 C++ 中的含义）之外，Paul Tomblin[对一个 C 特定问题也有很好的回答，该问题](https://stackoverflow.com/questions/654754/what-really-happens-when-you-dont-free-after-malloc/654766#654766)也谈到了 C++ 析构函数。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-03-24T15:07:22.073

显式调用 delete 很重要，因为您可能在析构函数中有一些要执行的代码。就像可能将一些数据写入日志文件一样。如果您让操作系统为您释放内存，您的析构函数中的代码将不会被执行。

大多数操作系统会在程序结束时释放内存。但是最好自己释放它，就像我在上面所说的那样，操作系统不会调用你的析构函数。

至于一般调用 delete，是的，您总是想调用 delete，否则您的程序中会出现内存泄漏，这将导致新的分配失败。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-24T15:28:32.817

是的，当您通过内存泄漏检测工具运行程序时，它有助于消除误报。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-05-14T17:00:02.027

是的。

*   该标准不*保证*操作系统会清理内存。您可以在主流平台上期待这一点，但为什么要冒险呢？
*   如果您不故意泄漏内存，则可以最大限度地减少 valgrind 等工具报告的混乱情况。
*   如果你养成了这个习惯，谁能说你有一天会不小心将这种方法应用到重要的地方呢？
*   您*可能*需要对象销毁。通常只是假设你这样做。它不会伤害你。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-24T15:18:47.833

想想你的班级`A`不得不破坏。
如果您不调用`delete`on `a`，则不会调用该析构函数。通常，如果过程结束，这并不重要。但是如果析构函数必须释放例如数据库中的对象呢？将缓存刷新到日志文件？将内存缓存写回磁盘？

你看，删除对象不仅仅是“好习惯”，在某些情况下它是必需的。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-24T15:19:50.793

考虑要删除的对象获取操作系统无法安全释放的外部资源的情况。如果你不对那个对象调用 delete，那么你就有了真正的泄漏。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-24T15:28:57.170

显式删除对象的另一个原因是，如果您的应用程序存在真正的内存泄漏，那么使用[valgrind](http://valgrind.org/)之类的工具来查找泄漏会变得更容易，前提是您不必筛选因不清理而产生的“泄漏”。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-24T15:29:23.377

删除的另一个原因是避免您将来可能使用的检漏仪发出错误警报。如果您有误报，您可能不会注意到检漏仪报告的真实泄漏 - 它将被掩埋在报告中的虚假泄漏中。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-24T15:26:31.417

始终确保您自己删除它。操作系统会处理这个问题，但会排除可以轻松避免的错误

# c# - 数据库主键 C# 映射 - String 或 int

> ID：677823
> 
> 赞同：2
> 
> 时间：2009-03-24T15:07:46.610
> 
> 标签：c#, database, architecture, mapping, primary-key

在 Northwind Starters Kit 中，数据库中的主键映射到 C# 中的字符串。

这是好习惯吗？如果是这样，为什么？

谢谢，列文卡登

ps：对不起，可能是错误的问题......

在 Northwind Starters Kit 中，一些表具有数据类型为 int 的自动增量主键，而另一些表具有数据类型为 nchar(5) 的非自动增量主键。为什么是这样？***好吧，显然一些主键只是代码（nchar(5) 格式）。很抱歉占用了您的时间。***

我认为数据类型 int 已映射到 C# 字符串，这对我来说似乎非常错误（但事实并非如此）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T15:10:47.837

这完全取决于数据库中列的数据类型。

好的做法是使用兼容/对应的数据类型。如果数据库使用 int，则使用 int。如果数据库使用 uniqueidentifier，请使用 Guid。如果数据库使用 nvarchar，则使用字符串。

其他任何事情都会带来问题。保证。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T15:11:00.207

为了纯粹的效率，使用 Int 作为主键会更好，因为它支持在机器代码级别比较 Int。使用在数据库级别实现的算法来比较字符串。除非您的字符串很短，否则整数键在页面上占用的空间也会更少（db 页面）。

**更新**：根据板上的其他答案，我不确定我是否正确理解了您的问题。您是否在问与字符串相比，使用整数作为键是否更好（可以选择其中任何一个）？还是您在问您的 C# 类型是否应该与您的数据库类型匹配？我假设是前者……如果是后者，我会感到非常惊讶——我认为他的答案是显而易见的。

**更新**： Lieven 现在澄清了他的要求，说他实际上是在询问 Int 或 nchar 字段作为索引是否会更好，所以我最初对这个问题的看法是正确的。

为了补充我的回答，Lieven，将 Int 作为您的 PK 几乎总是更好。例外情况是存在可以作为短字符串捕获的*自然键（例如，在“项目”条目是字符字符串的会计系统中）。*原因有三方面。

首先，整数表示为本机机器类型（32 位或 64 位字）并通过机器本机操作进行操作，而字符串不是，但必须使用逐字符的方法进行比较。因此，例如，当遍历 PK 索引（通常是 BTree 的某种变体）来定位记录时，每个节点的比较操作是单个操作。这是一件大事吗？除非您正在处理真正庞大的数据库或事务负载，否则可能不会。如果你有一个自然的字符键，那么一定要使用它！但是，如果您的“关键”是姓氏的前五个字母加上第一个首字母加上一个数字以使其唯一，那么使用 Int 字段显然要好得多。

其次，与几乎任何 char 键相比，整数只占用更少的空间（假设使用 Unicode 的 char(1) 除外）。而且它不仅仅是主表页面中的房间，请记住索引字段也在索引中表示。再说一次，这有什么大不了的吗？不是真的，除非您再次使用大型数据库。

最后，我们对键的选择通常会在其他地方产生影响。因此，例如，如果您将一张表的主键用作另一张表的外键，那么当您使用外键在表中插入或更新记录时，上述两种效果都会被放大。

总而言之：使用最自然的键。但是，如果您可以在 Int 和 Char 之间进行选择，并且两者本质上都是任意的，请选择 Int 而不是 Char。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T15:12:54.290

始终为 Sql 数据类型使用相应的 C# 数据类型。正如其他海报所指出的那样，做任何其他事情都是在以后提出问题。

看看这篇文章： http: [//msdn.microsoft.com/en-us/library/ms131092.aspx](http://msdn.microsoft.com/en-us/library/ms131092.aspx)获取 Sql Server/C# 数据类型等价物的完整列表。

# linux - 远程 X 会话很慢 [centos5]

> ID：677834
> 
> 赞同：1
> 
> 时间：2009-03-24T15:10:05.607
> 
> 标签：linux, ssh, centos, xorg

好的，我已经搜索了谷歌，但我还没有找到答案。除非我试图在会话中使用 ide，否则与编程不完全相关......

我在同一个远程位置有服务器；一个是运行 Fedora 4 (P4 3.0Ghz) 的旧服务器，另一个运行 Centos5 (Quad Xeon 1.6) 的较新服务器。

我可以同时在两者上运行一个远程 X 会话，Fedora 服务器 X 窗口很好而且很活泼，但是 Centos 服务器很慢而且很慢。我连接到两个 vis ssh -X -C。我试过不压缩，但它仍然很慢/滞后。

两台 centos 服务器根本不被应用程序征税，一台是热备用服务器，因此它实际上没有运行任何东西。

我在 centos 盒子上试过这些内核：
2.6.18-92.1.22.el5xen
2.6.18-92.1.22.el5
2.6.18-8.1.8.el5

所有这些服务器都在同一个子网上并共享相同的路由路径/交换机等。

帮助！...

ps（我知道我应该只使用命令行访问，但我试图让这更容易让某人偶尔“支持我”）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T17:38:39.867

最有可能的是，您正在淹没您的网络连接而不是处理器。现代工具包（QT/GTK）在网络行为方面比旧工具差得多。我过去曾使用 VNC 和 NX 来解决这个问题，并且从 NX 获得了最好的低网络使用性能。如果钱是个问题，FreeNX 项目非常有用。我对 NX 的唯一问题是我从未有过合理的声音、GLX 或 XRender 性能。但是，对于大多数人来说，这并不是一个真正的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:21:57.497

X11转发确实可以使网络饱和，所以最可能的原因是这些机器之间的连接不同。

我建议您使用一些更适合网络使用的协议，例如[NX](http://en.wikipedia.org/wiki/NX_technology)或[RDP](http://en.wikipedia.org/wiki/Remote_Desktop_Protocol)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T14:36:55.070

我同意你的观点，Centos 5.x 和 RHEL 5.x 在通过 ssh 和 X11 转发通过慢速链接启动的应用程序存在严重的性能问题。我已经向 Centos 和 Redhat 提交了关于这个问题的错误。某些应用程序（wireshark、system-config-lvm、...）在 v5 服务器上远程启动时完全无法使用。

# python - python 和 symbian - 击键捕获

> ID：677846
> 
> 赞同：1
> 
> 时间：2009-03-24T15:13:03.197
> 
> 标签：python, symbian, pys60

我正在尝试在 python 中编写一个简单的原型应用程序来捕获用户击键，同时编写文本消息 (SMS) 以收集一些统计信息，以便在基于 Symbian 的手机的生物识别应用程序中使用。我以前从未使用过python，也很少接触它。但是，我确实遇到了一个示例[http://wiki.forum.nokia.com/index.php/How_to_use_Keys_in_PyS60](http://wiki.forum.nokia.com/index.php/How_to_use_Keys_in_PyS60)，详细说明了如何轻松地捕获 UP、DOWN、LEFT、RIGHT 和 0-9。我试图在 pys60 API 中找到关于 key_codes 和 keypress 的信息，但几乎没有可用的信息，因为我正在寻找一个如何捕获字符的示例，例如“a”、“b”等，假设禁用了预测文本。此外，如果无法捕获字符，将按键映射到字符有多可行？即228 ='b'，

谁能给我一些例子、建议或朝着正确的方向推进？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:22:54.157

我认为你在这里寻找错误的东西。

正如您已经说过的，键代码和按键事件只会捕获向上、向下等（实际按钮）。用户可以通过多种方式输入字母，这都是通过软件完成的（例如 22 是“b”，或者 228 可能是“cat”或“bat”），并且无法仅根据用户输入的内容来判断他们按下的按钮。大多数手机还内置了自动完成功能，它会添加用户没有按下按钮的字符。

尝试寻找捕捉用户看到的实际文本的方法。

# c# - 使用位图图像创建自定义通用列表

> ID：677850
> 
> 赞同：0
> 
> 时间：2009-03-24T15:13:42.197
> 
> 标签：c#, wpf, image, listbox, generic-list

在我的 WPF 项目中，有一个列表框，我必须在其中显示图像并在每个图像旁边显示它们的文本（例如：拍摄照片的日期、位置等）。我已经尝试创建一个通用列表，但我仍然无法将它分配给列表框

就像是

Bscially 我一直在尝试这方面的东西。

```
public class LoadImages
{
    public static List<ImageLoader> LoadImages()
    {
        List<ImageLoader> img = new List<ImageLoader>();

        Uri uri = new Uri(@"http://somedomain.com/pic.jpg", UriKind.Absolute);
        BitmapImage bi = new BitmapImage(uri);

        img.Add(new ImageLoader("1_1",bi));

        return img;            
    }
}

public class ImageLoader
{
    string mediaid;
    BitmapImage thumbnail;

    public ImageLoader(string mediaid, BitmapImage b)
    {
        this.mediaid = mediaid;
        this.thumbnail = b;
    }
} 
```

我的 XAML 看起来像这样。

```
 <ListBox Name="ListBox1" SelectionMode="Extended" ItemsSource="{Binding}"
             Width="300" Height="300" IsSynchronizedWithCurrentItem="True">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <Grid>
                    <Image Source="{Binding thumbnail}"/>
                    <TextBlock Text="{Binding mediaid}"/>
                </Grid>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

暂时我已经设置了 Window.DataContext

```
<Window.DataContext>
    <ObjectDataProvider ObjectType="{x:Type local:LoadImages}" MethodName="LoadImages"/>
</Window.DataContext> 
```

但是每次我运行应用程序时，列表框都会显示为空。

有什么建议么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:41:00.760

图像元素确实支持源属性的 Uris。为什么不让您的 LoadImages 类返回一组 Uris 而不是图像？图像元素也可以为你做异步工作；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T17:56:39.840

thumbnail 和 mediaid 不公开，因此绑定失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T08:37:49.137

经过大量阅读和谷歌搜索后，我找到了答案，我在 ImageLoader 类中所要做的就是为 mediaid 和缩略图创建属性，然后绑定到列表框现在就像一个字符一样工作。所以上面问题中的 ImageLoader 类现在看起来像

```
public class ImageLoader
{
    string mediaid;
    BitmapImage thumbnail;

    public string MediaId
    {
        get { return mediaid; }
        set { mediaid = value; }
    }

    public BitmapImage Thumbnail
    { 
        get { return thumbnail; } 
        set { thumbnail = value; } 
    }

    public ImageLoader(string mediaid, BitmapImage b)
    {
        this.mediaid = mediaid;
        this.thumbnail = b;
    }
} 
```

# sql-server - 用于搜索的分页

> ID：677854
> 
> 赞同：-2
> 
> 时间：2009-03-24T15:15:20.087
> 
> 标签：sql-server, stored-procedures

表 'sample' 包含字段 [AffiliateId] 作为主键，[AffiliateCode] L, [Name] , [AddressId] [, [Url] , [EmailId] , [ShopId] ,

我需要一个用于自定义分页的存储过程

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T15:25:00.190

在 sqlserver 2005[参考](http://howto.tawaret.com/implement-pagination-with-sql-server-2005/)或[示例](http://noprobs.wordpress.com/2008/07/24/pagination-in-sql-server-selecting-a-specific-range-of-records-from-a-table-or-resultset-in-sql-server/)中：

```
SELECT * FROM ( SELECT row_number() OVER (ORDER BY id) AS resultNum, id FROM table_name) AS numberResultsWHERE resultNum  BETWEEN ? AND ? 
```

对于旧版本，请参阅[参考资料](http://codeigniter.com/forums/viewthread/82124/)或[参考资料2](http://www.ruby-forum.com/topic/130319)

# visual-studio - ReadyBoost 会对 Visual Studio 2008 产生影响吗？

> ID：677858
> 
> 赞同：1
> 
> 时间：2009-03-24T15:16:54.843
> 
> 标签：visual-studio, visual-studio-2008, performance

有没有人通过在 Windows Vista 中使用 ReadyBoost 来提高 Visual Studio 2008 的性能？我有 4G 的 RAM 并且添加更多将无济于事（我正在运行 Vista 32），因此我正在研究其他选项以加快开发环境和构建过程的响应速度。

无法升级到 64 位 Windows。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T18:21:20.023

根据我的经验，ReadyBoost 确实提供了边际性能改进，但通常用于加载您经常使用的大型应用程序。

如果“加载 Visual Studio”对你来说是一个改进，你会喜欢 ReadyBoost。在我看来，你应该得到一个便宜的驱动器，并且无论如何都要使用 ReadyBoost。

要真正提高 Visual Studio 与您的系统的性能，ReadyBoost 只会做一点点……更好的硬件会做得更多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-04T08:44:03.613

Readyboost 只有在内存紧张的情况下才会产生真正的影响——它只是一些虚拟内存的更快存储库。查看任务管理器 - 如果您的机器运行非常紧张，那么 ReadyBoost 可能会有所帮助。但如果你有足够的可用内存，它几乎什么也做不了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-14T12:33:50.543

在添加 SD 卡并分配用于 Windows 7 32 位下的 ReadyBoost 后，我​​的 VS2008 环境有了很大的改进。我不同意一些关于内存的评论，尤其是在 32 位环境中。ReadyBoost 的想法是缓存小文件，由于这些设备上的访问时间很短，这些文件通常会从硬盘驱动器传输得更慢。如果您阅读的文件很大，那么由于顺序读取速度快，硬盘驱动器仍然是最好的来源，但对于较小的文件，准备好的加速缓存可以比 HDD 访问提高 10 倍。

值得自己尝试一下，这只是将 SD 或 USB 笔式驱动器添加到系统的情况，当被要求为 readyboost 缓存分配高达 4gb 的内存时。如果它不适合您，只需卸下驱动器。我发现在我的案例中检查 SD 卡的类别是值得的。我有一个 6 类 SDHC，发现在通过 CrystalDsikMark 运行各种 SD 卡后效果最好。这是 7200rpm HDD 与 Class 6 SD 卡的结果（记住我们在这里寻找的随机访问！！！）

**7200rpm 250Gb SATA 2.5" 硬盘**

> 顺序读取：42.671 MB/s
> 顺序写入：41.693 MB/s 随机读取 512KB：26.032 MB/s 随机写入 512KB：29.445 MB/s
> 随机读取 4KB： **0.493 MB/s**
> 随机写入 4KB：0.896 MB/s

**4GB 6 类 SD 卡**

> 顺序读取：15.085 MB/s
> 顺序写入：9.376 MB/s 随机读取 512KB：14.954 MB/s 随机写入 512KB：2.146 MB/s
> 随机读取 4KB： **4.373 MB/s**
> 随机写入 4KB：0.025 MB/s

我即将获得一个使用 PCI 并且应该更快的 expresscard SSD，当我从中获得结果时将在此处更新。希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-29T07:57:06.120

我监控了我的（资源监视器）、Wndows 7、64 位、4GB RAM 和 1 个专用于 ReadyBoost 的 Sandisk Extreme III SDHC 卡。

打开所有 MS-Office 2010 应用程序、所有 Adob​​e CS5 和每个应用程序中的大文件、Eclipse、Aptana、MySql 工作台，在第二个屏幕上流式传输高清（我保存时为 3.8 GB），并截取统计数据并添加它们在Fireworks的图层中，大约有30张截图。-- 从可用的 4GB 中取出 3.78GB。

我注意到该驱动器一直在使用，速度高达 1.2MB/s

然后我在所有打开的应用程序中测试了流畅度，它很不错，最慢的是 MySQL 工作台，但一旦加载它就运行良好。

我的建议是，无论您拥有何种系统，花几美元并增加一些额外的工作速度都是值得的。

我没有测试，但我确信它不会加速任何游戏..

# objective-c - 与 Cocotron 的链接错误

> ID：677861
> 
> 赞同：1
> 
> 时间：2009-03-24T15:17:11.767
> 
> 标签：objective-c, linux, macos, cross-platform, cocotron

我最近为 Cocotron 构建了一个 linux 平台接口，并且能够毫无错误地构建 Foundation 框架。

但是，在链接我的 Objective-C 项目时，出现链接器错误：

/Developer/Cocotron/1.0/Linux/i386/Frameworks/Foundation.framework//libFoundation.so：未定义引用`__gnu_objc_personality_v0'

我做了一些谷歌搜索，但没有发现任何有用的东西。

这是我的 ld 命令行（为了便于阅读而简化了一点）：

```
Ld /Users/me/MyProject/build/Linux/Release/ENCLAnalyzer normal i386
    cd /Users/me/MyProject
    /Developer/Cocotron/1.0/Linux/i386/gcc-4.3.1/bin/i386-ubuntu-linux-gcc -arch i386 
    -L/Users/me/MyProject/build/Linux/Release 
    -L../../frameworks/Shared/FFmpeg/Linux/lib 
    -L/Developer/Cocotron/1.0/PlatformInterfaces/i386-ubuntu-linux/lib 
    -L/Developer/Cocotron/1.0/PlatformInterfaces/i386-ubuntu-linux/intel/mkl/9.0/lib/32 
    -L/Developer/Cocotron/1.0/PlatformInterfaces/i386-ubuntu-linux/intel/ipp/5.1/ia32/sharedlib
    -L/Users/me/frameworks/Shared/FFmpeg/Linux/lib 

    -F/Users/me/MyProject/build/Linux/Release 
    -F/Users/me/frameworks/Shared 
    -F/Developer/Cocotron/1.0/Linux/i386/Frameworks 
    -F/Users/me/frameworks/OtherProject/Linux 

    -filelist "/Users/me/MyProject/build/Linux/MyProject.build/Release/MyProject Linux.build/Objects-normal/i386/MyProject.LinkFileList" 

    -Wl,-rpath-link,/Developer/Cocotron/1.0/PlatformInterfaces/i386-ubuntu-linux/lib 
    -Wl,-rpath-link,../../frameworks/Shared/FFmpeg/Linux/lib 
    -Wl,-rpath-link,/Developer/Cocotron/1.0/PlatformInterfaces/i386-ubuntu-linux/intel/ipp/5.1/ia32/sharedlib
    -Wl,-rpath-link,/Developer/Cocotron/1.0/PlatformInterfaces/i386-ubuntu-linux/intel/mkl/9.0/lib/32
    -Wl,-rpath-link,/Developer/Cocotron/1.0/Linux/i386/Frameworks/Foundation.framework 

    -framework Foundation -framework MyFramework1 -framework MyFramework2 -framework MyFramework3 
    -o /Users/me/MyProject/build/Linux/Release/MyProject 
```

我有一种感觉，基础项目需要链接到它不是的库，或者它可能链接到某个库的错误版本。但我不确定。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:24:13.170

您使用的是哪个编译器？我希望是来自 Cococtron 的那个？看看[这个](http://groups.google.com/group/cocotron-dev/browse_thread/thread/7d5d9d7bcd26fd6e)讨论。

`__gnu_objc_personality_v0`当您指定不正确的编译器时会发生这种情况（例如没有 -x 选项的 C++ 代码的 gcc）。尝试设置一些开关来告诉 g++ 你要编译 Obj-C 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T23:38:16.360

更新：Cocotron 存储库中有一些编译器更新可以解决此问题。安装脚本已更新以获取这些，新版本在这里：

[http://cocotron.org/Tools/Downloads/InstallCDT-2009-04-17.zip](http://cocotron.org/Tools/Downloads/InstallCDT-2009-04-17.zip)

在使用它之前，一定要删除 /Developer/Cocotron/1.0/Downloads/gcc-4.3.1.tar.bz2 否则它不会选择新的源。确保在重新安装时指定 Linux i386。

IE`sudo ./install.sh Linux i386`

感谢[Christopher Lloyd](https://stackoverflow.com/users/28973/christopher-lloyd)提供上述信息，并通过电子邮件向我发送修复程序。

# compiler-construction - 发布与调试构建时间

> ID：677862
> 
> 赞同：7
> 
> 时间：2009-03-24T15:17:31.470
> 
> 标签：compiler-construction, build, debugging, performance, release

我一直认为 Debug 构建比 Release 构建慢，因为编译器需要额外生成调试器信息。我最近很惊讶听到我的一位同事说发布版本通常需要更多时间。（我相信这只是因为增量链接/编译）。

一般来说，两者哪个更快？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-24T15:20:58.093

嗯，有许多变量可能会影响事情。以下是调试可能更快的一些原因：

*   通常调试模式做的优化要少得多，因为那些会弄乱指令和代码行之间的映射。因此，编译器在那里做的工作更少。
*   即使完整的调试构建速度较慢，调试构建的发生频率也更高，并且通常比发布构建更能利用增量构建。因此，Debug 构建通常不需要像 Release 构建那样做那么多工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T15:31:16.493

总的来说，我希望调试版本的构建速度会更快，但运行速度会更慢，而发布版本的构建时间会更长，但最终结果会运行得更快。

这取决于发布版本可能具有更积极的优化，这些可能会干扰可调试性。此外，一些更大规模的优化确实需要很长时间。在目标文件中插入调试信息的时间小到可以忽略不计，它可能比最初从磁盘读取源代码花费的时间更少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T15:19:38.267

只是一个猜测，但我认为由于优化，在大多数情况下发布构建需要更长的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T15:24:42.310

调试构建通常更快，因为没有进行优化（这在发布构建中很常见）。

您可以选择不使用可执行文件生成调试符号，也不进行优化，但这对于发布版本来说会很奇怪。虽然我认为它会建立得更快。

Debug 和 Release 之间的主要区别在于 Debug 用于调试（因此包括调试符号），而 Release 旨在运行得更快，因此您使用强优化

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T15:44:37.897

发布版本更快的主要原因是编译器对它们进行了大量优化。例如，它可以展开循环、删除不必要的变量和内联函数。优化不是一项简单的任务，需要大量的计算能力，从而减慢构建速度。

大多数编译器会让你关闭发布版本的优化。试试这个。您的构建时间将缩短。您还可以打开调试版本的优化并查看您的构建时间攀升。

# c++ - 在窗户上建造艾尔莎

> ID：677866
> 
> 赞同：2
> 
> 时间：2009-03-24T15:18:51.407
> 
> 标签：c++, windows, parsing, porting

我将如何在 Windows 下构建 elsa？

[http://www.eecs.berkeley.edu/~smcpeak/elkhound/sources/elsa/](http://www.eecs.berkeley.edu/~smcpeak/elkhound/sources/elsa/)

视觉工作室会更好，或者我可以使用视觉工作室链接，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T04:12:48.503

尝试在 Cygwin 下编译它。

下载 Cygwin 安装，选择 GCC 和 Flex、Perl 等。安装这些东西，然后按照正常的构建过程，在 Cygwin 中一次。

# delphi - 在远程计算机上运行应用程序或进程

> ID：677867
> 
> 赞同：4
> 
> 时间：2009-03-24T15:19:04.323
> 
> 标签：delphi, delphi-2007

我需要在远程计算机上运行应用程序或服务。我在 SysInternals 的 psexec 上取得了成功，但我正在调查并想比较替代方案。最终，该命令将从 Delphi 应用程序中运行。谢谢，彼得。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T16:20:41.990

如果您想遵循类似 PSexec 的路线，这里有一个示例（使用 C++）源，[名为 XCmd](http://www.codeguru.com/cpp/i-n/network/remoteinvocation/article.php/c5433)。

或者，您可以从 SourceForge 下载更新的 XCmd 项目[（现在称为“The Grim Linker”）。](http://sourceforge.net/projects/thegrimlinker/)

本质上，它在运行时提取服务，将其复制到远程系统，将其安装为服务，然后连接到它（通过命名管道）。

另一种选择是使用 WMI 的内置远程执行功能。这是一个可以转换为 Delphi 的 VBScript 示例。下面的示例在远程系统上执行记事本。

```
' This script provides a function for executing a command on a remote computer
' This uses WMI and requires that you have administrative righs on the remote machine
'

Dim strComputer, strCommandLineToRun

'change the period to an IP Address or computer name
strComputer = "."   'example: strComputer = "192.168.1.105"

'this is the path to the file on the computer whose name/IP address is stored in the strComputer variable
strCommandLineToRun = "c:\windows\system32\calc.exe"

' This calls the function to run the process on a remote computer
RemoteExecute strComputer,"","",strCommandLineToRun

Function RemoteExecute(strServer, strUser, strPassword, CmdLine)
    Const Impersonate = 3

    RemoteExecute = -1

    Set Locator = CreateObject("WbemScripting.SWbemLocator")
    Set Service = Locator.ConnectServer(strServer, "root\cimv2", strUser, strPassword)

    Service.Security_.ImpersonationLevel = Impersonate 
    Set Process = Service.Get("Win32_Process")

    result = Process.Create(CmdLine, , , ProcessId)

    If (result <> 0) Then
        WScript.Echo "Creating Remote Process Failed: " & result
        Wscript.Quit
    End If

    RemoteExecute = ProcessId
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T17:22:44.267

如果您要传输任何敏感内容，ssh 是一个不错的选择。甚至还有一些不依赖 cygwin 的 Windows 自由开源 sshd 服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T17:19:35.850

另一种可能性是使用 windows AT 命令，该命令通过 windows 调度程序安排任务。只要您具有管理员访问权限并且计划服务正在另一台计算机上运行，​​您就可以使用该命令远程提交作业。要检查语法，只需打开 CMD 窗口并输入**AT /?** .

例如，要在凌晨 4 点在名为“server”的机器上运行某些东西，只需输入命令

```
AT \\server 4:00 "c:\something.bat" 
```

# c# - 使用来自 Windows 服务的凭据启动进程

> ID：677874
> 
> 赞同：12
> 
> 时间：2009-03-24T15:20:18.483
> 
> 标签：c#, .net, windows-services

我有一个以 mydomain\userA 身份运行的 Windows 服务。我希望能够从服务中运行任意 .exe。通常，我使用 Process.Start() 并且它工作正常，但在某些情况下，我想以不同的用户 (mydomain\userB) 运行可执行文件。

如果我更改用于启动进程的 ProcessStartInfo 以包含凭据，我开始收到错误 - 一个错误对话框显示“应用程序未能正确初始化 (0xc0000142)。单击确定以终止应用程序。”，或者“访问被拒绝”Win32Exception。如果我从命令行运行进程启动代码而不是在服务中运行它，则进程将使用正确的凭据开始（我已通过将 ProcessStartInfo 设置为运行 whoami.exe 并捕获命令行输出来验证这一点）。

我也尝试过使用 WindowsIdentity.Impersonate() 进行模拟，但这并没有奏效——据我了解，模拟只会影响当前线程，并且启动一个新进程会继承进程的安全描述符，而不是当前线程。

我在一个隔离的测试域中运行它，因此 userA 和 userB 都是域管理员，并且都具有域范围内的作为服务登录权限。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-24T17:37:26.423

当您使用 ProcessStartInfo 启动新进程时，该进程将在与启动进程相同的窗口站和桌面中启动。如果您使用不同的凭据，则用户通常没有足够的权限在该桌面上运行。初始化失败错误是由于user32.dll尝试在新进程中初始化而无法初始化导致的。

要解决此问题，您必须首先检索与窗口站和桌面关联的安全描述符，并为您的用户添加适当的 DACL 权限，然后在新凭据下启动您的进程。

编辑：关于如何做到这一点和示例代码的详细描述在这里有点长，所以我整理了[一篇](http://asprosys.blogspot.com/2009/03/perils-and-pitfalls-of-launching.html)带代码的文章。

```
 //The following security adjustments are necessary to give the new 
        //process sufficient permission to run in the service's window station
        //and desktop. This uses classes from the AsproLock library also from 
        //Asprosys.
        IntPtr hWinSta = GetProcessWindowStation();
        WindowStationSecurity ws = new WindowStationSecurity(hWinSta,
          System.Security.AccessControl.AccessControlSections.Access);
        ws.AddAccessRule(new WindowStationAccessRule("LaunchProcessUser",
            WindowStationRights.AllAccess, System.Security.AccessControl.AccessControlType.Allow));
        ws.AcceptChanges();

        IntPtr hDesk = GetThreadDesktop(GetCurrentThreadId());
        DesktopSecurity ds = new DesktopSecurity(hDesk,
            System.Security.AccessControl.AccessControlSections.Access);
        ds.AddAccessRule(new DesktopAccessRule("LaunchProcessUser",
            DesktopRights.AllAccess, System.Security.AccessControl.AccessControlType.Allow));
        ds.AcceptChanges();

        EventLog.WriteEntry("Launching application.", EventLogEntryType.Information);

        using (Process process = Process.Start(psi))
        {
        } 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-06-06T20:22:59.073

*基于[@StephenMartin 的回答](https://stackoverflow.com/q/677874/850848#678449)。*

使用`Process`该类启动的新进程与启动进程在同一窗口站和桌面中运行。如果您使用不同的凭据运行新进程，则新进程将无权访问窗口站和桌面。什么会导致像 0xC0000142 这样的错误。

以下是一个“紧凑”的独立代码，用于授予用户对当前窗口站和桌面的访问权限。它不需要 AsproLock 库。

`GrantAccessToWindowStationAndDesktop`在调用之前使用您用于运行`Process`( `Process.StartInfo.UserName`)的用户名调用该方法`Process.Start`。

```
public static void GrantAccessToWindowStationAndDesktop(string username)
{
    IntPtr handle;
    const int WindowStationAllAccess = 0x000f037f;
    handle = GetProcessWindowStation();
    GrantAccess(username, handle, WindowStationAllAccess);
    const int DesktopRightsAllAccess = 0x000f01ff;
    handle = GetThreadDesktop(GetCurrentThreadId());
    GrantAccess(username, handle, DesktopRightsAllAccess);
}

private static void GrantAccess(string username, IntPtr handle, int accessMask)
{
    SafeHandle safeHandle = new NoopSafeHandle(handle);
    GenericSecurity security =
        new GenericSecurity(
            false, ResourceType.WindowObject, safeHandle,
            AccessControlSections.Access);

    security.AddAccessRule(
        new GenericAccessRule(
            new NTAccount(username), accessMask, AccessControlType.Allow));
    security.Persist(safeHandle, AccessControlSections.Access);
}

[DllImport("user32.dll", SetLastError = true)]
private static extern IntPtr GetProcessWindowStation();

[DllImport("user32.dll", SetLastError = true)]
private static extern IntPtr GetThreadDesktop(int dwThreadId);

[DllImport("kernel32.dll", SetLastError = true)]
private static extern int GetCurrentThreadId();

// All the code to manipulate a security object is available in .NET framework,
// but its API tries to be type-safe and handle-safe, enforcing a special
// implementation (to an otherwise generic WinAPI) for each handle type.
// This is to make sure only a correct set of permissions can be set
// for corresponding object types and mainly that handles do not leak.
// Hence the AccessRule and the NativeObjectSecurity classes are abstract.
// This is the simplest possible implementation that yet allows us to make use
// of the existing .NET implementation, sparing necessity to
// P/Invoke the underlying WinAPI.

private class GenericAccessRule : AccessRule
{
    public GenericAccessRule(
        IdentityReference identity, int accessMask, AccessControlType type) :
        base(identity, accessMask, false, InheritanceFlags.None,
             PropagationFlags.None, type)
    {
    }
}

private class GenericSecurity : NativeObjectSecurity
{
    public GenericSecurity(
        bool isContainer, ResourceType resType, SafeHandle objectHandle,
        AccessControlSections sectionsRequested)
        : base(isContainer, resType, objectHandle, sectionsRequested)
    {
    }

    new public void Persist(
        SafeHandle handle, AccessControlSections includeSections)
    {
        base.Persist(handle, includeSections);
    }

    new public void AddAccessRule(AccessRule rule)
    {
        base.AddAccessRule(rule);
    }

    #region NativeObjectSecurity Abstract Method Overrides

    public override Type AccessRightType
    {
        get { throw new NotImplementedException(); }
    }

    public override AccessRule AccessRuleFactory(
        System.Security.Principal.IdentityReference identityReference, 
        int accessMask, bool isInherited, InheritanceFlags inheritanceFlags,
        PropagationFlags propagationFlags, AccessControlType type)
    {
        throw new NotImplementedException();
    }

    public override Type AccessRuleType
    {
        get { return typeof(AccessRule); }
    }

    public override AuditRule AuditRuleFactory(
        System.Security.Principal.IdentityReference identityReference,
        int accessMask, bool isInherited, InheritanceFlags inheritanceFlags,
        PropagationFlags propagationFlags, AuditFlags flags)
    {
        throw new NotImplementedException();
    }

    public override Type AuditRuleType
    {
        get { return typeof(AuditRule); }
    }

    #endregion
}

// Handles returned by GetProcessWindowStation and GetThreadDesktop
// should not be closed
private class NoopSafeHandle : SafeHandle
{
    public NoopSafeHandle(IntPtr handle) :
        base(handle, false)
    {
    }

    public override bool IsInvalid
    {
        get { return false; }
    }

    protected override bool ReleaseHandle()
    {
        return true;
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-04-25T12:42:43.653

*基于@Stephen Martin 和 Martin Prikryl 的回答。*

此代码可帮助您使用来自服务的不同用户凭据运行进程。
我现在已经优化了源代码。
现在也可以删除和设置权限。

```
namespace QlikConnectorPSExecute
{
    #region Usings
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Runtime.InteropServices;
    using System.Security.AccessControl;
    using System.Security.Principal;
    #endregion

    //inspired by: http://stackoverflow.com/questions/677874/starting-a-process-with-credentials-from-a-windows-service
    public class WindowsGrandAccess : IDisposable
    {
        #region DLL-Import
        // All the code to manipulate a security object is available in .NET framework,
        // but its API tries to be type-safe and handle-safe, enforcing a special implementation
        // (to an otherwise generic WinAPI) for each handle type. This is to make sure
        // only a correct set of permissions can be set for corresponding object types and
        // mainly that handles do not leak.
        // Hence the AccessRule and the NativeObjectSecurity classes are abstract.
        // This is the simplest possible implementation that yet allows us to make use
        // of the existing .NET implementation, sparing necessity to
        // P/Invoke the underlying WinAPI.

        [DllImport("user32.dll", SetLastError = true)]
        private static extern IntPtr GetProcessWindowStation();

        [DllImport("user32.dll", SetLastError = true)]
        private static extern IntPtr GetThreadDesktop(int dwThreadId);

        [DllImport("kernel32.dll", SetLastError = true)]
        private static extern int GetCurrentThreadId();
        #endregion

        #region Variables && Properties
        public static int WindowStationAllAccess { get; private set; } = 0x000f037f;
        public static int DesktopRightsAllAccess { get; private set; } = 0x000f01ff;

        private GenericSecurity WindowStationSecurity {get; set;}
        private GenericSecurity DesktopSecurity { get; set; }
        private int? OldWindowStationMask { get; set; }
        private int? OldDesktopMask { get; set; }
        private NTAccount AccountInfo { get; set; }
        private SafeHandle WsSafeHandle { get; set; }
        private SafeHandle DSafeHandle { get; set; }
        #endregion

        #region Constructor & Dispose
        public WindowsGrandAccess(NTAccount accountInfo, int windowStationMask, int desktopMask)
        {
            if (accountInfo != null)
                Init(accountInfo, windowStationMask, desktopMask);
        }

        public void Dispose()
        {
            try
            {
                if (AccountInfo == null)
                    return;

                RestAccessMask(OldWindowStationMask, WindowStationAllAccess, WindowStationSecurity, WsSafeHandle);
                RestAccessMask(OldDesktopMask, DesktopRightsAllAccess, DesktopSecurity, DSafeHandle);
            }
            catch (Exception ex)
            {
                throw new Exception($"The object \"{nameof(WindowsGrandAccess)}\" could not be dispose.", ex);
            }
        }
        #endregion

        #region Methods
        private void Init(NTAccount accountInfo, int windowStationMask, int desktopMask)
        {
            AccountInfo = accountInfo;

            WsSafeHandle = new NoopSafeHandle(GetProcessWindowStation());
            WindowStationSecurity = new GenericSecurity(false, ResourceType.WindowObject, WsSafeHandle, AccessControlSections.Access);

            DSafeHandle = new NoopSafeHandle(GetThreadDesktop(GetCurrentThreadId()));
            DesktopSecurity = new GenericSecurity(false, ResourceType.WindowObject, DSafeHandle, AccessControlSections.Access);

            OldWindowStationMask = ReadAccessMask(WindowStationSecurity, WsSafeHandle, windowStationMask);
            OldDesktopMask = ReadAccessMask(DesktopSecurity, DSafeHandle, desktopMask);
        }

        private AuthorizationRuleCollection GetAccessRules(GenericSecurity security)
        {
            return security.GetAccessRules(true, false, typeof(NTAccount));
        }

        private int? ReadAccessMask(GenericSecurity security, SafeHandle safeHandle, int accessMask)
        {
            var ruels = GetAccessRules(security);

            var username = AccountInfo.Value;
            if (!username.Contains("\\"))
                username = $"{Environment.MachineName}\\{username}";

            var userResult = ruels.Cast<GrantAccessRule>().SingleOrDefault(r => r.IdentityReference.Value.ToLower() == username.ToLower() && accessMask == r.PublicAccessMask);
            if (userResult == null)
            {
                AddGrandAccess(security, accessMask, safeHandle);
                userResult = ruels.Cast<GrantAccessRule>().SingleOrDefault(r => r.IdentityReference.Value.ToLower() == username.ToLower());
                if (userResult != null)
                    return userResult.PublicAccessMask;
            }
            else
              return userResult.PublicAccessMask;

            return null;
        }

        private void AddGrandAccess(GenericSecurity security, int accessMask, SafeHandle safeHandle)
        {
            var rule = new GrantAccessRule(AccountInfo, accessMask, AccessControlType.Allow);
            security.AddAccessRule(rule);
            security.Persist(safeHandle, AccessControlSections.Access);
        }

        private void RemoveGrantAccess(GenericSecurity security, int accessMask, SafeHandle safeHandle)
        {
            var rule = new GrantAccessRule(AccountInfo, accessMask, AccessControlType.Allow);
            security.RemoveAccessRule(rule);
            security.Persist(safeHandle, AccessControlSections.Access);
        }

        private void SetGrandAccess(GenericSecurity security, int accessMask, SafeHandle safeHandle)
        {
            var rule = new GrantAccessRule(AccountInfo, accessMask, AccessControlType.Allow);
            security.SetAccessRule(rule);
            security.Persist(safeHandle, AccessControlSections.Access);
        }

        private void RestAccessMask(int? oldAccessMask, int fullAccessMask, GenericSecurity security, SafeHandle safeHandle)
        {
            if (oldAccessMask == null)
                RemoveGrantAccess(security, fullAccessMask, safeHandle);
            else if (oldAccessMask != fullAccessMask)
            {
                SetGrandAccess(security, oldAccessMask.Value, safeHandle);
            }
        }
        #endregion

        #region private classes
        private class GenericSecurity : NativeObjectSecurity
        {
            public GenericSecurity(
                bool isContainer, ResourceType resType, SafeHandle objectHandle,
                AccessControlSections sectionsRequested)
                : base(isContainer, resType, objectHandle, sectionsRequested) { }

            new public void Persist(SafeHandle handle, AccessControlSections includeSections)
            {
                base.Persist(handle, includeSections);
            }

            new public void AddAccessRule(AccessRule rule)
            {
                base.AddAccessRule(rule);
            }

            new public bool RemoveAccessRule(AccessRule rule)
            {
                return base.RemoveAccessRule(rule);
            }

            new public void SetAccessRule(AccessRule rule)
            {
                base.SetAccessRule(rule);
            }

            new public AuthorizationRuleCollection GetAccessRules(bool includeExplicit, bool includeInherited, Type targetType)
            {
                return base.GetAccessRules(includeExplicit, includeInherited, targetType);
            }

            public override Type AccessRightType
            {
                get { throw new NotImplementedException(); }
            }

            public override AccessRule AccessRuleFactory(
                System.Security.Principal.IdentityReference identityReference,
                int accessMask, bool isInherited, InheritanceFlags inheritanceFlags,
                PropagationFlags propagationFlags, AccessControlType type)
            {
                return new GrantAccessRule(identityReference, accessMask, isInherited, inheritanceFlags, propagationFlags, type);
            }

            public override Type AccessRuleType
            {
                get { return typeof(AccessRule); }
            }

            public override AuditRule AuditRuleFactory(
                System.Security.Principal.IdentityReference identityReference, int accessMask,
                bool isInherited, InheritanceFlags inheritanceFlags,
                PropagationFlags propagationFlags, AuditFlags flags)
            {
                throw new NotImplementedException();
            }

            public override Type AuditRuleType
            {
                get { return typeof(AuditRule); }
            }
        }

        private class GrantAccessRule : AccessRule
        {
            public GrantAccessRule(IdentityReference identity, int accessMask, bool isInherited,
                                     InheritanceFlags inheritanceFlags, PropagationFlags propagationFlags,
                                     AccessControlType type) :
                                     base(identity, accessMask, isInherited,
                                          inheritanceFlags, propagationFlags, type) { }

            public GrantAccessRule(IdentityReference identity, int accessMask, AccessControlType type) :
                base(identity, accessMask, false, InheritanceFlags.None,
                     PropagationFlags.None, type) { }

            public int PublicAccessMask
            {
                get { return base.AccessMask; }
            }
        }

        // Handles returned by GetProcessWindowStation and GetThreadDesktop should not be closed
        private class NoopSafeHandle : SafeHandle
        {
            public NoopSafeHandle(IntPtr handle) :
                base(handle, false) {}

            public override bool IsInvalid
            {
                get { return false; }
            }

            protected override bool ReleaseHandle()
            {
                return true;
            }
        }
        #endregion
    }
} 
```

使用示例

```
using (var windowsAccess = new WindowsGrandAccess(accountInfo, WindowsGrandAccess.WindowStationAllAccess, WindowsGrandAccess.DesktopRightsAllAccess))
{
   ...
} 
```

谢谢你。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-24T15:50:39.567

这是以下症状：
- 权利不足；
- 库加载失败；

使用 Filemon 检测某些访问被拒绝或使用
WinDbg 在调试器中运行应用程序并查看任何问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-11-07T01:32:51.097

我用 Python 重新实现了 Martin Prikryl 的答案，我希望有人觉得它有用。

我在 Python 脚本中运行子进程时遇到了这个问题。我正在使用该`pythonnet`软件包以`System.Diagnostics.Process`不同的用户身份运行。我的问题是子进程没有运行，我没有收到 stdout 或 stderr。

```
# Import .NET objects using pythonnet
from System.Diagnostics import Process

# Use .NET API to run a subprocess using the given executable
# as the target user, in the provided working directory.
process = Process()
process.StartInfo.UseShellExecute = False
process.StartInfo.CreateNoWindow = True
process.StartInfo.LoadUserProfile = True
process.StartInfo.RedirectStandardOutput = True
process.StartInfo.RedirectStandardError = True
process.StartInfo.WorkingDirectory = working_dir
process.StartInfo.Domain = "mydomain"
process.StartInfo.UserName = username.lower().replace("mydomain\\", "")
process.StartInfo.PasswordInClearText = password
process.StartInfo.FileName = executable
process.StartInfo.Arguments = " ".join(args)

# Run the subprocess.
process.Start()

# Read subprocess console output
stdout = process.StandardOutput.ReadToEnd()
stderr = process.StandardError.ReadToEnd()
log.info(f"\n{executable} subprocess stdout:\n\n{stdout}")
log.info(f"{executable} subprocess stderr:\n\n{stderr}")
log.info(f"Done running {executable} as {username}.") 
```

我使用了 Martin Prikryl 的答案，但我使用 pyWin32 库在 Python 中重新实现了它，这解决了我的问题。：

```
import win32api, win32process, win32service, win32security

WINDOW_STATION_ALL_ACCESS = 983935
DESKTOP_RIGHTS_ALL_ACCESS = 983551
SE_WINDOW_OBJECT = 7
DACL_SECURITY_INFORMATION = 4

def set_access(user, handle, access):
    info = win32security.GetSecurityInfo(
        handle, SE_WINDOW_OBJECT, DACL_SECURITY_INFORMATION
    )
    dacl = info.GetSecurityDescriptorDacl()
    dacl.AddAccessAllowedAce(win32security.ACL_REVISION, access, user)
    win32security.SetSecurityInfo(
        handle, SE_WINDOW_OBJECT, DACL_SECURITY_INFORMATION, None, None, dacl, None
    )

username = "mattsegal"
user, domain, user_type = win32security.LookupAccountName("", username)
thread_id = win32api.GetCurrentThreadId()
station_handle = win32process.GetProcessWindowStation()
desktop_handle = win32service.GetThreadDesktop(thread_id)
set_access(user, station_handle, WINDOW_STATION_ALL_ACCESS)
set_access(user, desktop_handle, DESKTOP_RIGHTS_ALL_ACCESS) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T15:27:14.397

你是如何设置域、用户和密码的？您是否正确设置了域以及密码（它必须使用 SecureString）。

另外，您是否设置了 WorkingDirectory 属性？使用用户名和密码时，文档声明您必须设置 WorkingDirectory 属性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-24T15:59:00.060

可能由服务启动的任何进程也必须具有“作为服务登录”权限。

如果您用于启动第二个进程的用户 ID 没有该框的管理权限，则可能是这种情况。

一个简单的测试是更改本地安全策略以赋予用户 ID“作为服务登录”并再次尝试。

编辑：在附加信息之后..

在 Google 上放牧，似乎 0xc0000142 与无法初始化所需的 DLL 有关。服务是否打开了衍生进程需要的东西？无论如何，它看起来与开始的过程有关，而不是你如何做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-26T07:51:47.463

我今天遇到了这个问题，我花了很长时间试图解决这个问题。我最终做的是将服务创建为交互式（使用 services.msc 中的允许服务与桌面交互复选框）。一旦我这样做了，0xc0000142 错误就消失了。

# asp.net-mvc - System.Web.Mvc.dll 发生了什么？

> ID：677875
> 
> 赞同：5
> 
> 时间：2009-03-24T15:20:20.840
> 
> 标签：asp.net-mvc, visual-studio-2008

一位同事通过电子邮件向我发送了一个示例 ASP.NET MVC 项目，该项目不会在我的机器上构建，因为它包含对`System.Web.Mvc.dll`

在 .csproj 文件中：

```
<Reference Include="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL" /> 
```

我安装了 VS2008 SP1 并且可以创建新的 ASP.NET MVC Web 应用程序。但是，这些不包括对此程序集的引用。

那么，有谁知道这个程序集存在于哪个版本的 ASP.NET MVC 中，以及我应该怎么做才能构建这个项目？

## 编辑

如何找出机器上安装的 ASP.NET MVC 版本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-24T15:23:23.173

MVC 刚刚进入 RTM。您可能正在运行早期版本。获取最新的。

[ASP.NET MVC 1.0](http://www.microsoft.com/downloads/details.aspx?FamilyID=53289097-73ce-43bf-b6a6-35e00103cb4b&displaylang=en)包括程序集`System.Web.Mvc.dll`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T16:28:28.883

**要找出安装的 MVC 版本：**

在 Program Files\Microsoft ASP.NET 中搜索 System.Web.Mvc.dll。

它应该位于具有发布名称的文件夹中，或者没有右键单击并检查属性。

**要解决您的问题：**

1.  在 Visual Studio 中展开引用部分并删除对 System.Web.Mvc 的当前引用（右键单击“删除”）。
2.  右键单击引用并选择“添加引用”
3.  从 .NET 选项卡中选择 System.Web.MVC。
4.  重建您的应用程序。

它现在应该编译并运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T15:35:16.700

您也可以访问： http: [//www.microsoft.com/web/](http://www.microsoft.com/web/)

并下载 Web Platform Installer 并通过它安装 MVC 和其他东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-01T04:52:39.167

这是我的答案-

最好的方法是使用 NuGet 包管理器。只需更新下面的 MVC 包，它应该可以工作

[为什么 System.Web.Mvc 未在添加引用中列出？](https://stackoverflow.com/questions/3648364/why-is-system-web-mvc-not-listed-in-add-references/23976853#23976853)

# c# - Removing empty strings

> ID：677876
> 
> 赞同：1
> 
> 时间：2009-03-24T15:20:22.353
> 
> 标签：c#, .net, regex

I have written the folllowing regex and would like to get empty strings removed automatically and could not find any equivalent to RemoveEmptyEntries for Regex which I found only for the Split method in string.

```
string test = "{ key1 = { key2= xx } | key3 = y | key4 = z }";
string[] help = Regex.Split(test, "(=)|({)|(})|(\\|)"); 
```

The result string array contains elements which are empty. I would like to run the regular expression without yielding any empty strings contained in the result.

I will run this code very, very frequently - thus I need it as efficient as possible. Updates: As this is a parser I need to keep the tokens and I found only a way with Regex to keep them.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T15:57:35.743

I don't think that option is built into RegEx. But with C#3.0 you could just use a simple `.Where()`:

```
string[] help = Regex.Split(test, "(=)|({)|(})|(\\|)")
                     .Where(s => !string.IsNullOrEmpty(s)).ToArray(); 
```

To make this more efficient, declare the RegEx once — perhaps at class level or make it static — rather than recreating it all the time. Additionally, odds are you're only using the returned array to iterate over the results. You can make this faster by skipping the `.ToArray()` call on the end and just keeping the IEnumerable for your iteration.

```
//earlier
RegEx KeySplitter = new RegEx ("(=)|({)|(})|(\\|)"); 
```

.

```
//later
string test = ""; // 
for (string key in KeySplitter.Split(test).Where(s => !string.IsNullOrEmpty(s)))
{
    // ...
} 
```

One of the nice things about how linq-to-objects works is that this will still only iterate over your `.Split` results *once*, because the `GetEnumerator` method in the `Where` function will do lazy evaluation. Depending on what you need to do inside the for loop you might be able to gain a similar efficiency by adding a `.Select()` call.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T19:30:34.140

Maybe not a full solution to the question, but I have a few remarks for the problem at hand (tokenizing a string):

```
the original regex:    (=)|({)|(})|(\|)
is equivalent to:      (=|{|}|\|)
is equivalent to:      ([={}|]) 
```

All of the above expressions return the same 21 elements, but they perform differently. I set up a quick test going over 100,000 iterations of `Split()` operations using pre-built Regex objects with `RegexOptions.Compiled` and the `Stopwatch` class.

*   regex #1 takes 2002ms on my hardware
*   regex #2 takes 1691ms
*   regex #3 takes 1542ms
*   regex #4 takes 1839ms (that's the one below)

YMMV.

However, the desired elements can still be surrounded by white space. I figure this is undesired as well, so the regex I would split on would be this:

```
\s*([={}|])\s* 
```

The returned elements are:

```
["", "{", "key1", "=", "", "{", "key2", "=", "xx", "}", "", "|", "key3", "=", "y", "|", "key4", "=", "z", "}", ""] 
```

The few remaining empty strings should not pose a big problem performance-wise when iterating the array and can be taken care of (read: ignored) when they are encountered.

EDIT: If you measure performance it is possible that you find splitting on `([={}|])` and trimming the array elements "manually" is faster than splitting on `\s*([={}|])\s*`. Just try what works better for you.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T16:02:36.917

As for efficiency: If the stars are lucky, you can gain some performance by compiling the regex:

```
Regex r = new Regex ("<regex goes here>", RegexOptions.Compiled); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T16:28:11.347

To remove spaces from a string just do this

```
Regex exp = new Regex(@"\s+");
string test = "{ key1 = { key2= xx } | key3 = y | key4 = z }";
string result = test.Replace(exp, string.Empty); 
```

Or you could also do the following (did not test which one works faster)

```
Regex.Replace(test, " ", string.Empty, RegexOptions.Compiled) 
```

Here is what Jeff Atwood (incidentally one of the creators of StackOverFlow has to [say about compiled regex](http://www.codinghorror.com/blog/archives/000228.html) )

After this you can user your split code to put the keys into the string array.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T15:48:15.657

I didn't quite figure out your question. But "^$" would mean a line that ends next to where it starts, therefore an empty line. Does that help?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T13:42:29.817

Rather than splitting the string using the regex you could modify your regular expression and return a match collection. Something like this:

```
string test = "{ key1 = { key2= xx } | key3 = y | key4 = z }";

Regex regex = new Regex("[={}|]|[^\\s={}|]{1,}");
MatchCollection matches = regex.Matches(test);

string[] help = new string[matches.Count];

for (int index = 0; index < matches.Count; index++)
{
    help[index] = matches[index].Value;                
} 
```

This will return the same as your regular expression minus the empty (white space) elements in the final array.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T15:26:53.343

So you want multiple occurrences of delimiters between values to be matched only once.

```
\s*[{}=|][\s{}=|]* 
```

This should match, in this order, any amount of whitespace, one delimiter, and any amount of both whitespace and further delimiters.

Adding C# string escapes and a compilation declaration:

```
Regex regex = new Regex("\\s*[{}=|][\\s{}=|]*"); 
```

# .net - Winform UI 的好例子——从 UX 和美学的角度来看

> ID：677878
> 
> 赞同：5
> 
> 时间：2009-03-24T15:21:02.040
> 
> 标签：.net, winforms, user-experience

**任何人都可以推荐一些好的在线资源，这些资源展示了在用户体验**和整体**美学**方面被认为是好的 Winforms“设计”的样本。我正在寻找包含屏幕截图的内容，以*激发* *我的灵感……*而不仅仅是最佳实践的项目符号列表。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T15:31:52.793

我猜想[Paint.NET](http://www.getpaint.net/)可能是“现实世界”中最常用的 WinForms 应用程序，我会说它有资格考虑。从美学上讲，它相当简单，但我觉得它非常直观。 [截图在这里](http://www.getpaint.net/screenshots.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T15:54:37.637

如需灵感，请查看[Infragistics Quince UX](http://quince.infragistics.com/#/main)网站。它可能不一定都符合您的 WinForms 标准，但无论您是否拥有 Infragistics，其中都有大量信息。

# asp.net - asp.net 中的条件渲染

> ID：677889
> 
> 赞同：1
> 
> 时间：2009-03-24T15:22:56.717
> 
> 标签：asp.net

我怎样才能让这样的东西在 asp.net 中工作

```
<asp:Panel Visible="<%(SType==switch_type.Trunk).ToString()%>" runat="server">Tickle</asp:Panel> 
```

其中 switch_type 是值的枚举，而 SType 是代码隐藏中的 get/set。

我有这个工作，但我只是觉得它很丑

```
<% if (SType == switch_type.Trunk)
    { %>
        ... 
```

我知道我可以在代码隐藏中将面板设置为可见/不可见，但是会有很多面板，而且在 aspx 文件中设置可见性似乎更容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T15:41:11.633

看哪，事件的力量！

ASPX 方面：

```
<asp:panel runat="server" id="myPnlName OnLoad="panelLoadEvent" Tooltip='<% Response.Write(switch_type.Trunk) %>'>
    Stuff
</asp:panel> 
```

代码方面：

```
protected sub panelLoadEvent(sender as object, e as EventArgs)
  dim pnl as Panel = sender 
  dim oItem as switch_type = ctype(pnl.ToolTip, switch_type) 
  pnl.visibile = iif(stype=oItem,true,false)
End sub 
```

关键是您将要检查的 VALUE 放入面板的工具提示中，并且每个面板都由 Panel aspx 声明的 OnLoad 属性中定义的相同 LoadEvent 处理程序处理。
此时，您检查给定值是否与您的变量匹配，并适当地设置可见性。

**编辑**如果你想在工具提示中存储一个字符串表示而不是枚举的底层 int，你可以使用类似的东西将它解析回枚举：

```
[Enum].Parse(System.Type, Value) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:27:46.313

这个怎么样

```
<asp:Panel runat="server" Visible="<%= SType == switch_type.Trunk %>">
    Stuff
</asp:Panel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T15:39:27.330

由于有很多面板，是否值得创建一个可以从中继器绑定到的数据集，然后您将能够使用 <%# %> 语法来执行可见的不可见逻辑？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-24T15:26:38.657

您可以使用 MultiView 控件，并将每个面板放在其中一个视图中。

# javascript - 使用 XMLHttpRequest 加载 JSON 文件时，Firefox 出现“格式不正确”错误

> ID：677902
> 
> 赞同：70
> 
> 时间：2009-03-24T15:25:19.877
> 
> 标签：javascript, firefox, xmlhttprequest, mime-types

当我页面上的 JavaScript 加载包含 JavaScript Object Notation 格式的对象的文本文件时，我在 Firefox 3.0.7 的错误控制台中收到“格式不正确”的错误。如果文件只包含 JSON 对象，则会产生错误。如果我将对象包装在 <document></document> 标记中，则不会产生错误。无论哪种方式，请求都会成功，所以我可以忽略它，但我不希望我的错误日志填满这些消息。

这是一些示例代码来说明问题。首先，名为“data.json”的“格式不正确”的文件：

```
{ a: 3 } 
```

现在一些代码来加载文件：

```
var req = new XMLHttpRequest();
req.open("GET", "data.json");
req.send(null); 
```

这会在 Firefox 错误控制台中产生以下错误：

**格式不正确的**
file://path/to/data.json Line: 1
{ a: 3 }
- ^

如果 data.json 被修改成这样：

```
<document>{ a: 3 }</document> 
```

没有错误。我认为它在抱怨是因为纯 JSON 文件不是格式良好的 XML 文档，所以我尝试在“发送”调用之前覆盖 MIME 类型以强制它作为纯文本加载，但这不起作用。

```
var req = new XMLHttpRequest();
req.open("GET", "data.json");
req.overrideMimeType("text/plain");
req.send(null);
// Still produces an error! 
```

我将继续将我的 JSON 数据包装在 XML 文档中，以绕过 XMLHttpRequest 正在执行的任何验证，但我想知道是否有任何方法可以强制它不加批判地加载纯文本而不是尝试验证它。或者，除了 XMLHttpRequest 之外，还有另一种可以与纯文本一起使用的数据加载方法吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-03-24T15:32:21.387

您是否尝试过对 JSON 使用 MIME 类型？

```
application/json 
```

您还可以将服务器配置为自动为 .json 文件发送此 MIME 类型。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-24T15:33:12.057

首先，真正的 JSON 比 JavaScript 严格得多，要成为有效的 JSON，您必须引用您的密钥。

```
 { "a": 3 } 
```

此外，由于您使用的是纯 XMLHttpRequest，它通常期望接收 XML 结果，除非 MIME 标头另有严格规定。

然而，您可能希望通过简单地使用 JavaScript 框架（例如 jQuery）来简化自己的生活，它将为您抽象出所有这些问题并处理所有令人讨厌的边缘情况。

```
$.getJSON("data.json",{}, function( data ){ 
  /*  # do stuff here  */ 
}); 
```

此外，如果您同时使用严格的 JSON 并使用库为您抽象它，那么当浏览器开始使用本机 JSON 解析器时，该库将能够透明地使用这些解析器并显着提高速度。

（这迟早会发生，当它发生时，您的用户将无需付出任何努力即可获得静默升级！）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-11-02T19:12:58.413

当 Content-Type 完全为空时也会发生这种情况（从而绕过自然类型检测）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-24T15:33:33.197

实际上应该是 {"a": 3} 。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-04-09T13:39:31.940

我发现了相同的错误消息，但原因却截然不同。经过一段时间无果而终地更改 JSON 内容后，我意识到我不小心重新启动了在本地文件系统 (file://Users/me/Sites/mypage.html) 而不是服务器 (http://localhost/) 上运行的页面~me/Sites/mypage.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-20T22:58:30.613

在请求服务器标记为的资源时，我也收到了与`XMLHttpRequest()`（在 FireFox 中）相同的警告消息`Content-Type: application/json`。

对我来说，诀窍是在请求对象上显式设置`XMLHttpRequest.responseType`属性。`json`例如，

```
var request = new XMLHttpRequest();
request.onreadystatechange = function() { ... }
...
request.open('GET','https://random-domain.com/random-path',true);
request.responseType = 'json';
...
request.send(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-12T09:34:12.390

```
Browser --- request expects a given content-type ---> Server
        <-- response contains content-type ---------- 
```

Firefox 查看 HTTP [Content-Type 标头](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type)。如果服务器 HTTP 响应标头与您的浏览器代码的期望不匹配，它将抱怨此消息。

恕我直言，此错误消息可能会好得多，例如“期望响应内容类型标头...但找到...”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-15T09:58:18.873

除非有特殊原因直接从磁盘打开 HTML ( `file://`)，否则您应该帮自己一个忙，并由本地 HTTP 服务器 ( `http://`) 打开它，就像[原型用户所写的](https://stackoverflow.com/a/10074069/2693875)那样。这将解决这个问题，因为[MIME 类型将被正确设置，正如 jthompson 建议的那样](https://stackoverflow.com/a/677943/2693875)。

多亏了这一点，您也不会遇到另一个问题，例如“[原因：CORS 请求不是 HTTP](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSRequestNotHttp) ”，可能还有其他问题，因为浏览器在被要求打开本地磁盘上的文件时变得越来越可疑 - 并且有充分的理由（安全！）。

如果您的系统上有 Python，那么[（可以说）运行本地 HTTP 服务器的最简单方法](https://developer.mozilla.org/en-US/docs/Learn/Common_questions/set_up_a_local_testing_server#running_a_simple_local_http_server)是：

**Mac/Linux：** `python3 -m http.server`

**窗户：** `python -m http.server`或`py -3 -m http.server`

当前工作目录中的文件将在 http://localhost:8000/ 下提供

* * *

## 回答 #9

> 赞同：-6
> 
> 时间：2010-11-24T07:23:53.667

肯特，我不同意。

以下**是**“有效”的 JSON：

```
{ a: 3 } 
```

JavaScript 对象属性名称不必是字符串。

问题是 MIME 类型之一，而不是 JSON/JavaScript 语法。

我刚刚通过将 json 作为“text/javascript”添加到我的网络服务器 mime 类型文件中解决了这个问题：

```
text/javascript                 js, json 
```

“格式不正确”的错误消失了。浏览器 (FireFox) 错误地认为 .json 文件是 XML。

# .net - 是否有 WPF XAML 用于统一拟合但恒定的 StrokeThickness

> ID：677903
> 
> 赞同：3
> 
> 时间：2009-03-24T15:26:28.017
> 
> 标签：.net, wpf, xaml

我要画一个均匀地融入其空间的圆，具有恒定的笔画厚度。ViewBox 让我得到统一的合身，但不是恒定的笔触厚度。

```
<Viewbox Stretch="Uniform" MinHeight="10" MinWidth="10" >
    <Ellipse Height="10" Width="10" Fill="Red" StrokeThickness="1" Stroke="Yellow"/>
</Viewbox> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T15:56:16.277

如果您不指定椭圆的宽度或高度，则默认值为“自动”。结合“Stretch”的默认 Horizo​​ntalAlignment/VerticalAligment 值，这应该会导致椭圆“拉伸”到其容器的宽度和高度（具有恒定的笔画厚度）。

父容器的 *ContentAlignment 属性可能会影响此行为，但同样，默认的未设置值应该为您提供所需的行为。

**编辑**：修改我的建议，因为我没有意识到椭圆必须保持一个圆圈（别担心，我决定拿起一份“阅读理解”）。

我建议您将椭圆的宽度和高度属性绑定到父容器的 ActualWidth 和 ActualHeight 属性的 MultiBinding。然后实现一个“多值转换器”，它将从多绑定中返回最小值。

所以转换器可能看起来像这样：

```
class MinimumValueConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return values.Cast<double>().Min();
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

椭圆属性可以这样绑定：

```
<Window.Resources>
    <l:MinimumValueConverter x:Key="MinimumValueConverter" />
</Window.Resources>
<Ellipse Stroke="Black" StrokeThickness="1">
    <Ellipse.Width>
        <MultiBinding Converter="{StaticResource MinimumValueConverter}">
            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UIElement}}" Path="ActualWidth" />
            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UIElement}}" Path="ActualHeight" />
        </MultiBinding>
    </Ellipse.Width>
    <Ellipse.Height>
        <MultiBinding Converter="{StaticResource MinimumValueConverter}">
            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UIElement}}" Path="ActualWidth" />
            <Binding RelativeSource="{RelativeSource FindAncestor, AncestorType={x:Type UIElement}}" Path="ActualHeight" />
        </MultiBinding>
    </Ellipse.Height>
</Ellipse> 
```

# c# - double[,] 类型，如何获取行数？

> ID：677909
> 
> 赞同：6
> 
> 时间：2009-03-24T15:27:17.283
> 
> 标签：c#, arrays

我似乎得到了一个奇怪的值。

如何获取数组中的行数：

```
double[,] lookup = { {1,2,3}, {4,5,6} }; 
```

输出应该是 2。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-24T15:35:11.960

查找有两个维度，这就是您可以阅读它们的方式

```
double[,] lookup = { {1,2,3}, {4,5,6} };

int rows = lookup.GetLength(0); // 2
int cols = lookup.GetLength(1); // 3    
int cells = lookup.Length;      // 6 = 2*3 
```

**行**和**列**的概念只是传统，您不妨将第一个维度称为列。

也看到[这个问题](https://stackoverflow.com/questions/586972/how-to-get-multidimensional-length-of-one-axis/587017#587017)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T15:31:02.030

您想要数组上的 rank 属性...

```
double[,] lookup = { { 1, 2, 3 }, { 4, 5, 6 } };
Console.WriteLine(lookup.Rank); 
```

这将为您提供维度的数量。

编辑：
这只会为您提供数组的维数，而不是主要元素或“行”的数量，请参阅@Henk Holterman 对工作解决方案的回答。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T15:35:20.103

我认为您正在寻找的是：

```
lookup.GetLength(0); 
```

# linux - 使用 imlib2 和 gtk2

> ID：677912
> 
> 赞同：0
> 
> 时间：2009-03-24T15:27:42.210
> 
> 标签：linux, image

我可以将 imlib2 与 gtk2 一起使用，还是将其与 Qt 一起用于图像处理更好？或者，如果有人知道我是否可以将 imlib2 与免费的 pascal 和/或 java 一起使用，那就太好了。

提前致谢

麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T18:34:14.330

屏幕抓取最快的方法是使用[XGetImage](http://tronche.com/gui/x/xlib/graphics/XGetImage.html)，它是 Xlib 的一部分，因此您不需要**任何**额外的库或工具包。还要检查[这个](http://bisqwit.iki.fi/source/xgetimage.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T18:38:16.247

你想做什么？

如果您实际上是指“图像处理”，我不会将 Qt/gtk2 用于“图像处理”。有几个开源的图像处理库，看看 ImageMagick API 接口，链接[在这里](http://www.imagemagick.org/script/api.php)，它有*许多*图像的绑定。还有可用于程序化图像生成的[gd 图像库](http://www.boutell.com/gd/)，它具有多种语言的绑定。

# c++ - 从 std::list 中删除具有特定值的元素

> ID：677913
> 
> 赞同：5
> 
> 时间：2009-03-24T15:27:43.677
> 
> 标签：c++, list, stl

我需要从 std::list 中删除具有特定值的元素。使用`list<int>`我使用的 remove() 方法。

现在我有`list<CMyClass>`所以我想我应该使用 remove_if() 但它的谓词只需要一个参数 - 要测试的元素。

如何编写一个`foo(const CMyClass &Bad)`从列表中删除所有等于 Bad 的元素的函数？

谢谢

附言

```
struct CMyClass {
    void *Ptr;
    int Var;
}

bool is_equal(const CMyClass &A, const CMyClass &B)
{
    if (A.Ptr == B.Prt and A.Var == B.Var)
        return true;
    else
        return false;
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-24T15:30:37.243

您的班级必须在您的 ClassName 中实现 operator ==

```
bool operator == ( const Class& rhs ); 
```

然后你可以使用

```
list.remove( Bad ) 
```

如果您的班级拥有 operator == （不仅仅是 remove ）是合理的 - 那么 list::remove 对您的解决方案有好处。if operator == only for list::remove 比使用 remove_if 更好。

在下面的示例中，我们演示了 list::remove 和 list::remove_if。

```
struct Class
{
    int a_;
    int b_;

    Class( int a, int b ):
        a_( a ),
        b_( b )
    {}

    bool operator == (const Class &rhs)
    {
        return (rhs.a_ == a_ && rhs.b_ == b_);
    }

    void print()
    {
        std::cout << a_ << " " << b_ << std::endl;
    }
};

bool isEqual( Class lhs, Class rhs )
{
    return (rhs.a_ == lhs.a_ && rhs.b_ == lhs.b_);
}

struct IsEqual
{
    IsEqual( const Class& value ):
        value_( value )
    {}

    bool operator() (const Class &rhs)
    {
        return (rhs.a_ == value_.a_ && rhs.b_ == value_.b_);
    }

    Class value_;
};

int main()
{
    std::list<Class> l;

    l.push_back( Class( 1, 3 ) );
    l.push_back( Class( 2, 5 ) );
    l.push_back( Class( 3, 5 ) );
    l.push_back( Class( 3, 8 ) );

    Class bad( 2, 5 );

    std::cout << "operator == " << std::endl;
    l.remove( bad );
    std::for_each( l.begin(), l.end(), std::mem_fun_ref( &Class::print ) );

    std::cout << "binary function predicat" << std::endl;
    l.push_back( Class( 2, 5 ) );
    l.remove_if( std::bind2nd( std::ptr_fun(isEqual), bad ) );
    std::for_each( l.begin(), l.end(), std::mem_fun_ref( &Class::print ) );

    std::cout << "functor predicat" << std::endl;
    l.push_back( Class( 2, 5 ) );
    l.remove_if( IsEqual( bad ) );
    std::for_each( l.begin(), l.end(), std::mem_fun_ref( &Class::print ) );

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-24T15:39:50.637

根据谓词删除所有元素：

```
struct Pred
{
   bool operator()(int i) const
   {
      return i == 42;
   }
};

std::list<int> l = ...;
l.remove_if(Pred()); 
```

或删除所有值为 42 的元素：

```
std::list<int> l = ...;
l.remove(42); 
```

或者对于 CMyClass 的列表：

```
struct Pred
{
   bool operator()(const CMyClass& item) const
   {
      return item.GetSomething() == 42 && item.GetSomethingElse() == 314159;
   }
};

std::list<CMyClass> l = ...;
l.remove_if(Pred()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T15:31:08.380

创建一个接受错误值并将其存储在成员变量中的类。然后实施

```
bool operator()(CMyClass const &currVal) { 
  return (currVal is equal to this->bad);
} 
```

将此对象的实例传递给 remove_if

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-24T15:31:30.190

如果条件匹配，您可以简单地迭代元素、比较和擦除，例如：

```
for (std::list<string>::iterator i = mylist.begin(), e = mylist.end(); i != e; )
{
    if (*i == "foobar")
       i = mylist.erase(i);
    else
       ++i;
}
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T15:36:13.563

实现 operator==(const CMyClass &)。

例如：

```
#include <list>
#include <iostream>
#include <iterator>
using namespace std;

class CMyClass {
public:
  CMyClass(const int d) : data(d) {}
  bool operator==(const CMyClass &rhs) { return data == rhs.data; }
friend
  ostream& operator<<(ostream &ost, const CMyClass &rhs) { return ost << rhs.data; }
private:
  int data;
};

int main(int, char **) {
  list<CMyClass> li;
  CMyClass a(1);
  CMyClass b(8);
  li.push_back(a);
  li.push_back(b);
  copy(li.begin(), li.end(), ostream_iterator<CMyClass>(cout,"\n"));
  li.remove(a);
  copy(li.begin(), li.end(), ostream_iterator<CMyClass>(cout,"\n"));
  return 0;
} 
```

结果：

1 8 8

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-24T15:41:50.070

```
using namespace std;

class Foo
{
    public:
        Foo(int newVal){value = newVal;}
        int value;
};

class checkEqual : public binary_function<Foo, Foo, bool>
{
    public:
        bool operator()(const Foo &inputOne, const Foo &inputTwo) const
        {   return inputOne.value == inputTwo.value;}
            // implement your comparison here
};

int main(int count, char** args)
{
    list<Foo> myList;

    for(int x = 0; x < 10; ++x)
        myList.push_back(Foo(x));

    Foo bad(5);

    myList.remove_if(bind2nd(checkEqual(), bad));    

    return 0;
} 
```

或者如果你想重载 == 你可以这样做：

```
class Foo
{
    public:
        Foo(int newVal){value = newVal;}
        int value;
        bool operator==(const Foo &other) const
            {    return this->value == other.value;}
                 // your comparison here
}; 
```

进而：

```
myList.remove(bad); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-24T15:31:16.290

尝试使用 remove_if 方法

[http://www.sgi.com/tech/stl/remove_if.html](http://www.sgi.com/tech/stl/remove_if.html)

# sharepoint - 使用“开箱即用”的 Sharepoint 进行定制开发

> ID：677917
> 
> 赞同：1
> 
> 时间：2009-03-24T15:27:53.020
> 
> 标签：sharepoint, foxpro, visual-foxpro

我目前正在将旧版 Visual FoxPro 应用程序迁移到网络上。我们的计划包括购买一个应用程序框架，例如 Strataframe 或 MM .NET，它们都对 VFP 友好，以及一些第三方控件以加快开发速度。

好吧，我们最近听说我们可能不得不使用“开箱即用”的 Sharepoint 来托管这个应用程序，我不完全确定这意味着什么。我知道您可以使用 Visual Studio 来扩展开箱即用的功能，但我认为这是不可能的。

有没有人不得不处理这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T15:38:53.727

我不确定我是否理解您所说的“我认为这是不可能的”是什么意思？正如您所指出的，SharePoint 旨在扩展/开发。

如果你的意思是你怀疑开箱即用的 SharePoint 可能不会做你想做的事......是的，我同意。SharePoint 应被视为一个平台，而不是一个交钥匙解决方案。我还没有听说过不需要某种定制/开发的项目。

至于处理这样的事情......完全取决于你想要做什么！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:47:53.293

我假设“开箱即用”SharePoint 意味着您不能使用 Visual Studio 来扩展它。我不确定使用 SharePoint Designer 是否算数。

对于不需要开发的东西，开箱即用的 SharePoint 可以非常强大。但是，如果您尝试解决复杂的问题，OOTB SharePoint 应用程序可能会有一些非常粗糙的边缘。您也可能会遇到 OOTB 功能根本不允许您以有用的方式模仿特定数据结构或流程的情况。

如果您必须进入自定义和扩展 SharePoint，学习曲线会变得陡峭。SharePoint 开发需要付出一些努力才能精通——也就是说，它可能会成为您或您团队中其他程序员的主要关注点。*Inside Microsoft Windows SharePoint Services 3.0*一书很好地介绍了事物的开发方面。

在您使用 SharePoint 之前，我会确保获得一个相当清晰的路线图，说明应用程序的发展方向。然后，我会花一些时间来熟悉 WSS3 的基本 OOTB 功能（Microsoft 有一个[评估 Virtual PC 映像](http://www.microsoft.com/downloads/details.aspx?familyid=1beeac6f-2ea1-4769-9948-74a74bd604fa&displaylang=en&tm)），以确保它能够处理它。你想清楚地设定对你能做什么和不能做什么开箱即用的期望，以及如果你必须超越它，它将如何影响你的程序员团队。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T15:56:48.460

Strataframe 或 MM .NET 是**winforms**解决方案。

Sharepoint 是**基于网络的，**所以我认为这里不匹配。无法在 sharepoint 中集成/托管使用这些工具创建的解决方案。您可以从 sharepoint 下载它，但我怀疑这是客户的意思..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T17:57:59.307

我最近刚刚参加了一个为期 4 个月的计划，旨在为文档管理创建 Sharepoint 解决方案。我不确定您的团队需要这个站点来做什么，但是您可以使用许多简单快捷的开发解决方案来扩展 Sharepoint。此外，还有许多易于安装的插件可以帮助特定项目。

对于开箱即用的 SharePoint，您指的是 SharePoint Server 2007，还是免费的 Windows Sharepoint Services 3.0？此外，您能否使用 SharePoint Designer（自定义 SharePoint 的外观/感觉和细微结构更改以及创建自定义工作流的好工具）。SharePoint Designer 占用空间非常小，并且不需要修改服务器。

另请注意，虽然 SharePoint 对所有基本情况都很有用，但如果您有任何想要实现的复杂要求，则确实需要对其进行一些扩展。如果您需要对 SharePoint 进行任何类型的细微开发更改，或者只是想了解可能的情况，我可以为您提供的最佳解决方案是[PilotHouse Consulting 的开发 DVD](http://www.pilothouseconsulting.com/SharePointTrainingDVD.html)或[Lynda.com](http://lynda.com)的基础知识。

最终，我会尽量让您的雇主不要完全限制将 Visual Studio 扩展至 SharePoint 的可能性。

此外，DylanW 的 Virtual PC 评估链接对于尝试学习使用创建 SharePoint 解决方案非常有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-28T17:07:33.173

我会仔细处理“OOTB SharePoint”上的任何自定义开发项目——尤其是如果您对该平台没有任何经验。API 的工作方式有很多特点，识别和预测它们需要时间；还有一些技术对于保持解决方案的稳定性和可扩展性至关重要（例如，使用 {} 块将 SharePoint 对象实例化包装在内部），更不用说了解业务/Web 应用程序的结构了。

您首先需要了解平台及其工作原理，然后才能超越自己，我强烈警告不要将其视为开发平台 - 它更像是一个具有一些可扩展性选项的框架。

在此之后，您确实需要对如何管理您的项目有一个扎实的想法，从开发到推出、培训和支持。由于规划和管理不足，太多的 SharePoint 项目失败了。

有关详细信息，请参阅 Paul Culmsee 的系列，[SharePoint 项目为什么会失败？](http://www.cleverworkarounds.com/2008/04/11/why-do-sharepoint-projects-fail-part-1/)

# python - 动态创建对象的 Doctest

> ID：677931
> 
> 赞同：3
> 
> 时间：2009-03-24T15:30:12.797
> 
> 标签：python, testing, sqlalchemy, doctest, docstring

测试这样的代码的最佳方法是什么（下面的方法显然失败，而对象每次都在不同的块中创建）：

```
def get_session(db_name, verbose, test):
"""Returns current DB session from SQLAlchemy pool.

>>> get_session('Mmusc20090126', False, True)
<sqlalchemy.orm.session.Session object at 0xfb5ff0>

"""
if test:
    engine = create_engine('sqlite:///:memory:', echo=verbose)
    log_load.debug('DB in RAM.')
else:
    engine = create_engine('sqlite:///' + 'DB/' + db_name + '.db', echo=verbose)
    log_load.debug('DB stored in file: %s' % 'DB/' + db_name + '.db')

# Create TABLES: Structures, Interactions, Interactors, PDB_UniProt, UniProtSeq
meta.create_all(engine)

Session = sessionmaker(bind=engine)
session = Session()

return session 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-24T15:53:03.100

我认为您想使用省略号，如下所示：

```
>>> get_session('Mmusc20090126', False, True) #doctest: +ELLIPSIS
<sqlalchemy.orm.session.Session object at 0x...> 
```

请参阅[此处](http://docs.python.org/library/doctest.html#doctest.ELLIPSIS)了解更多信息。

# sql - 如果 DDL 语句失败整个事务回滚 sql server

> ID：677947
> 
> 赞同：0
> 
> 时间：2009-03-24T15:33:28.483
> 
> 标签：sql, vb.net

我有一系列 DML 和 DDL（仅限 Drop View）语句，我需要在 VB.net 应用程序的单个事务下执行这些语句。我正在使用 commandObj，并且首先保留了我保留的 beginTransaction 语句。当 Drop 语句返回错误时，一切正常。如果 Drop 语句返回错误，则回滚整个事务。我不想要这个。即使 Drop 未能保留在 Drop 之前执行的其他 DML 语句，我也想继续。这可能吗？

提前感谢
赛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T08:48:33.270

谢谢大家的回复..

实际上，在执行 Drop View 之前已经检查了视图是否存在。只有当另一个用户锁定时才会出现下拉视图的问题。现在，当您在执行 drop view 后移动了所有 DML 事务时，即使 drop view 语句失败（这将回滚所有先前的事务），也不会有问题，因为这是正在执行的第一条语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T16:30:48.190

单独执行您的语句，并根据需要处理错误（回滚或不回滚）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T16:35:15.433

您可以在您的 sysobjects 视图中运行一个选择来检查该视图是否存在，并且仅当它存在时才将其删除。

您也可以在存储过程中使用 try ... catch。

像其他人提到的那样，您也可以在事务之前删除视图。

或者，也许您可​​以使用临时表而不是视图，但这实际上取决于您的需求和需要完成的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T16:25:41.790

我不认为 DDL 语句是事务性的（即，如果发生错误，您不能在当前语句之前回滚语句）。

查看错误发生的原因并修复它而不是`DROP VIEW`

编辑：如果它可能是一个不存在的视图（尚未创建或删除），您可以使用 IF EXISTS (....) 语法。

[这里](http://www.eggheadcafe.com/software/aspnet/28761912/-if-exists-with-a-view.aspx)的例子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T16:28:13.097

然后根据需要在 COMMIT 和/或 ROLLBACK 语句之前或之后移动 DDL。

# c# - 如何从通过 FtpCommand 运行的 FTP 命令获取结果？

> ID：677949
> 
> 赞同：1
> 
> 时间：2009-03-24T15:33:46.767
> 
> 标签：c#, winapi, ftp, pinvoke

我已经包装了大部分 wininet，没有任何问题，但现在我被卡住了。我正在尝试从 wininet.dll p/invoke [FtpCommand](http://msdn.microsoft.com/en-us/library/aa384133(VS.85).aspx)，但我运行的每个命令都返回“500 语法错误”。甚至像 dir 或 ls 这样的简单命令。如果我使用 ftp.exe 连接到同一台服务器，则命令可以正常工作并返回预期结果。

这是方法定义：

```
[DllImport("wininet.dll", CharSet = CharSet.Auto, SetLastError=true)]
extern public static int FtpCommand(
    [In]  IntPtr hConnect,      
    [In]  bool fExpectResponse, 
    [In]  int dwFlags,          
    [In]  string command,
    [In]  IntPtr dwContext,
    [In][Out]  ref int ftpCommand); 
```

以及我调用它的代码：

```
 public string SendCommand(string cmd)
    {
        int result;
        IntPtr dataSocket = new IntPtr();
        switch(cmd)
        {
            case "PASV":
                result = WININET.FtpCommand(_hConnect, false, WININET.FTP_TRANSFER_TYPE_ASCII, cmd, IntPtr.Zero, ref dataSocket);
                break;
            default:
                result = WININET.FtpCommand(_hConnect, true, WININET.FTP_TRANSFER_TYPE_ASCII, cmd, IntPtr.Zero, ref dataSocket);
                break;
        }

        Console.WriteLine(InternetLastResponseInfo());

        int BUFFER_SIZE = 8192;

        if(result == 0){
            Error();
        }
        else if(dataSocket != IntPtr.Zero)
        {
            StringBuilder buffer = new StringBuilder(BUFFER_SIZE);
            int bytesRead = 0;

            do
            {
                result = WININET.InternetReadFile(dataSocket, buffer, BUFFER_SIZE, ref bytesRead);
            } while (result == 1 && bytesRead > 1);

            return buffer.ToString();

        }

        return "";
    } 
```

其他一切正常，我可以下载文件、上传文件并使用 FtpFindFirstFile() 模拟 dir 命令，但我似乎无法使用上述方法发送命令。

## 编辑

我的 SendCommand 代码是 SendCommand("DIR") 或 SendCommand("LS")。在阅读了其中一个答案后（在我编辑时看不到谁），我将其更改为 SendCommand("LIST") 并成功返回。

但是，我的问题是如何读取结果，我用什么来读取从 LIST 命令返回的数据，以便以可读的格式输出？

我更新了 SendCommand 方法以显示我计划如何读取返回的数据，但对于 bytesRead，我总是得到 0。我也尝试在 FtpCommand 调用中传递 dataSocket 接收的句柄，但如果我这样做，应用程序只会退出而没有错误。

## 编辑 2

我正在使用 InternetReadFile 从调用 FtpCommand 时返回的数据套接字句柄读取数据。我正在使用的 InternetReadFile 的方法签名是这样的：

```
[DllImport("wininet.dll", CharSet = CharSet.Ansi, SetLastError = true)]
extern public static int InternetReadFile(
    [In] IntPtr hConnect,
    [In][Out] StringBuilder buffer,
    [In] int buffCount,
    [In][Out] ref int bytesRead); 
```

## 最终编辑

我[在 codeplex 上发布了这段代码](http://ftplib.codeplex.com)：

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T15:43:40.830

**你为什么要`500 Syntax error`s？**

请记住，与 FTP 客户端（如`ftp.exe`）不同，实际的[FTP 协议](http://www.faqs.org/rfcs/rfc959.html)不接受类似的命令`ls`，它接受类似`LIST`和`NLST`

有关 FTP接受的命令列表，请参阅[原始 FTP 命令列表](http://www.nsftools.com/tips/RawFTP.htm#LIST)或[RFC 959](http://www.faqs.org/rfcs/rfc959.html)

**如何获得`LIST`or`NLST`命令的结果？**

最后一个参数[`FtpCommand`](http://msdn.microsoft.com/en-us/library/aa384133.aspx)是

> 指向在打开有效数据套接字时创建的句柄的指针。该 `fExpectResponse`参数必须设置为`TRUE`用于`phFtpCommand`填充。

您可以使用此句柄来读出列表[`InternetReadFile`](http://msdn.microsoft.com/en-us/library/aa385103.aspx)。

**笔记：**

*   您可能会考虑使用[WireShark](http://www.wireshark.org/)之类的东西来查看实际发送的网络流量`ftp.exe`并将其与您的代码发送的内容进行比较
*   您也可以考虑查看[FtpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.getresponse.aspx)；如果它满足您的需求，它可能更容易使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T22:27:14.480

纠正我的问题的关键是确保发送原始 FTP 命令，而不是诸如“DIR”之类的命令，传递 true（我期望一个数据套接字），并且方法声明中的 CharSet 是 CharSet.Ansi。如果我用 CharSet.Auto 或 CharSet.Unicode 替换 CharSet.Ansi，我只会得到一堆乱码。

我已经更新了问题中的代码示例以反映有效的方法。

# winapi - Win32 打印 - 无法设置横向模式

> ID：677950
> 
> 赞同：0
> 
> 时间：2009-03-24T15:34:08.077
> 
> 标签：winapi, visual-c++, printing

我有一个旧应用程序需要以横向模式打印。我找到的文档说要获得一个 DEVMODE 结构，更改几个字段，然后将其放回原处。我得到的是：

```
 HANDLE printer_handle;
    LPHANDLE printer_handle_pointer(&printer_handle);
    OpenPrinter(printer_name.get(), printer_handle_pointer, NULL);
    size_t devmode_size = DocumentProperties(hWnd, printer_handle_pointer, printer_name.get(), NULL, NULL, 0);
    DEVMODE * devmode = reinterpret_cast<DEVMODE *>(new char[devmode_size]);
    DocumentProperties(NULL, printer_handle_pointer, printer_name.get(), devmode, NULL, DM_OUT_BUFFER);
    devmode->dmSize = sizeof( DEVMODE);
    devmode->dmFields |= DM_ORIENTATION;
    devmode->dmOrientation = DMORIENT_LANDSCAPE;
    DocumentProperties(NULL, printer_handle_pointer, printer_name.get(), devmode, devmode, DM_IN_BUFFER | DM_OUT_BUFFER);
    hdcPrint = CreateDC(NULL, printer_name.get(), NULL, devmode); 
```

我当前的问题是第一个 DocumentProperties（返回 DEVMODE 结构大小的那个）正在返回 -1（实际上是无符号等效项），表示出现错误情况。这在 Debug 和 Release 模式下都会发生（我在网上看到的一份报告在 Debug 中遇到了这个问题，但在 Release 中没有）。是有效的`printer_name.get()`，但我不知道如何在调试器中检查`hWnd`或的正确性。`printer_handle_pointer`

所以，如果有人能告诉我我做错了什么，或者如何更好地诊断它，或者如何判断句柄是否有效并指向有效信息，我将不胜感激。

我在 Vista Business SP1 上使用 VS 2008SP1，如果这有什么不同的话。原始应用程序是在某些版本的 XP 上使用早期版本的 VS 编写的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T15:42:17.013

你贴出真实的代码了吗？

另外，看看 DocumentProperties 函数签名：

```
LONG DocumentProperties(
     __in   HWND hWnd,
     __in   HANDLE hPrinter,         
     __in   LPTSTR pDeviceName,
     __out  PDEVMODE pDevModeOutput,
     __in   PDEVMODE pDevModeInput,
     __in   DWORD fMode 
```

第三个参数采用 a`HANDLE`而不是指向 a `HANDLE`（或`LPHANDLE`）的指针，就像您在代码中使用的那样：

```
DocumentProperties(NULL, 
                   printer_handle_pointer, /* <--- ? */
                   printer_name.get(), 
                   devmode, 
                   NULL, 
                   DM_OUT_BUFFER); 
```

改用：

```
DocumentProperties(NULL, 
                   printer_handle, /* <--- ? */
                   printer_name.get(), 
                   devmode, 
                   NULL, 
                   DM_OUT_BUFFER); 
```

看看[这个](http://support.microsoft.com/kb/167345)示例代码来修改`Devmode`using`DocumentProperties`函数。

我通常`GetPrinterW`用来获取`PRINTER_INFO_2W`结构。该`pDevMode`成员返回您的开发模式。使用这个开发模式我很幸运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T17:36:02.307

来自 DocumentProperties 的 Microsoft[文档](http://msdn.microsoft.com/en-us/library/dd183576(VS.85).aspx)：

> 要更改应用程序本地的打印设置，应用程序应遵循以下步骤：
> 
> 1.  通过调用 DocumentProperties 并在 fMode 参数中指定零，获取完整 DEVMODE 结构所需的字节数。
> 2.  为完整的 DEVMODE 结构分配内存。
> 3.  通过调用 DocumentProperties 获取当前的打印机设置。将指向在步骤 2 中分配的 DEVMODE 结构的指针作为 pDevModeOutput 参数传递，并指定 DM_OUT_BUFFER 值。
> 4.  修改返回的 DEVMODE 结构的适当成员，并通过设置 DEVMODE 的 dmFields 成员中的相应位来指示更改了哪些成员。
> 5.  调用 DocumentProperties 并将修改后的 DEVMODE 结构作为 pDevModeInput 和 pDevModeOutput 参数传回，并指定 DM_IN_BUFFER 和 DM_OUT_BUFFER 值（使用 OR 运算符组合）。第三次调用 DocumentProperties 返回的 DEVMODE 结构可用作参数在对 CreateDC 函数的调用中。

看起来您缺少第 1 步，这可能是您第一次调用 DocumentProperties 失败的原因。

在我自己的程序中，我还设置了页面大小、交换长度和宽度。这是用于具有自定义纸张尺寸的特殊小型标签打印机，但我不知道是否需要更多花园品种的打印机。

```
double width = 8.5;
double height = 11.0;
devmode.dmFields = DM_ORIENTATION | DM_PAPERSIZE | DM_PAPERLENGTH | DM_PAPERWIDTH;
devmode.dmOrientation = DMORIENT_LANDSCAPE;
devmode.dmPaperSize = DMPAPER_USER;
devmode.dmPaperLength = (short)(width * 25.4 * 10);
devmode.dmPaperWidth = (short)(height * 25.4 * 10); 
```

# hibernate - 在休眠中分组

> ID：677951
> 
> 赞同：1
> 
> 时间：2009-03-24T15:34:22.087
> 
> 标签：hibernate, hql

我正在将旧的“经典 ASP”应用程序迁移到 J2EE/Hibernate。我对以下类型的 SQL 语句有疑问：

```
SELECT parent.id, parent.name, parent.column1, count(child.id) AS no_of_children
FROM parent
INNER JOIN child ON child.parent_id = parent.id
GROUP BY parent.id, parent.name, parent.column1 
```

如何在 HQL 中表达这样的内容？我试图将孩子映射为一个集合（通过使用多对一）并从集合大小中获取孩子的数量，但是 Hibernate 必须分别为每个父母加载所有“孩子”实体。

这导致执行大约 1000 个 DB 查询而不是 1 个，从而导致性能问题。

有没有办法解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T22:34:47.440

我会尝试以下方法：

```
select parent.id, parent.name, parent.column1, count(child) 
from Parent parent 
join parent.Children as child 
group by parent.id, parent.name, parent.column1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T22:22:23.540

翻译成 HQL

```
FROM Parent GROUP BY Parent.id, Parent.name, Parent.column1 
```

其中 Parent 是先前建模的实体。连接子句在模型中定义。

至于获取子节点的数量，对于每个父节点，请尝试删除子模型中的任何 Lob 字段，因为它们会限制您的应用程序速度。

希望有所帮助

# sql - TSQL：变量范围和 EXEC()

> ID：677954
> 
> 赞同：1
> 
> 时间：2009-03-24T15:34:51.383
> 
> 标签：sql, sql-server, tsql

```
declare @test varchar(20)
set @test = 'VALUE'

exec('
select '+@test+'
') 
```

这将返回：

> 列名“VALUE”无效。

是否有另一种方法可以在 select 语句上显示变量值？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T15:51:08.723

干净的替代方法是使用[sp_executesql()](http://msdn.microsoft.com/en-us/library/ms188001.aspx)及其处理参数化语句的能力：

```
DECLARE @test VARCHAR(20)
DECLARE @stmt NVARCHAR(100)
DECLARE @parm NVARCHAR(100)

SET @stmt = N'SELECT @val'        /* statement definition */
SET @parm = N'@val VARCHAR(20)'   /* parameters definition */
SET @test = 'VALUE'

EXECUTE sp_executesql @stmt, @parm, @val = @test 
```

产量：

```
(no column name)
VALUE 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-24T15:37:25.043

您不需要在这种情况下使用 Exec 如果您正在执行直接分配，您可以使用

```
Set @test = 'VALUE' 
```

并显示值只需选择它而不分配值

```
Select @test 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-24T15:42:24.187

cmsjr 有一点关于不需要 exec 的观点。但是假设您要发布问题的简化版本并且 exec 是必需的：

没有名为“值”的列，因为没有表。如果你只是想让它打印`value`，你需要用引号将它括起来，这样它在对 exec 的调用中看起来就像一个字符串文字：

```
exec(' select ''' + @test + ''' ') 
```

# ms-access - 如何使用其他应用程序访问 Cognos PowerPlay Cubes？

> ID：677960
> 
> 赞同：0
> 
> 时间：2009-03-24T15:36:35.420
> 
> 标签：ms-access, data-access, cognos, cubes

Cognos PowerPlay Cubes (Cognos v7.3) 通过电子邮件分发，然后存储在本地客户端上。目前，用户使用 MS Access 作为界面来访问 Cubes 中的数据和报告。是否有任何其他工具、应用程序或编程语言允许访问 PowerPlay Cube 和其中的表格/图表？

要求是实现一个比旧的 MS Access 更易于使用的用户界面。

不能直接使用 Cognos Studios 访问数据，因为数据也必须离线可用。

谢谢你的任何想法。

此致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T17:10:29.173

您可以使用 Cognos Powerplay 版本 7.x 客户端离线访问 Cognos PowerPlay 多维数据集，我相信它与用于创建多维数据集的 Transformer 应用程序一起打包。它很可能比你自己开发的任何东西都要好。

据我所知，没有用于使用编程语言访问直接存储在多维数据集中的数据的 API。至少在 7.x 中没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T16:57:25.857

据我了解，这是不可能的。大约一年前，当我们评估产品时，这是 Cognos 的一个危险信号。我们已将多维数据集迁移到需要可供非 Cognos 使用的 SSAS。

# c# - Web 表单路由 - 无法创建抽象类

> ID：677961
> 
> 赞同：3
> 
> 时间：2009-03-24T15:36:38.493
> 
> 标签：c#, asp.net, asp.net-routing

Net 3.5 SP1 并尝试将[http://haacked.com/archive/2008/03/11/using-routing-with-webforms.aspx](http://haacked.com/archive/2008/03/11/using-routing-with-webforms.aspx)的示例副本实现到示例 Web 应用程序中，但是我似乎遇到了一些问题。

我正在运行 windows vista、IIS 7.0、集成模式。

以下是 YSOD：

> 无法创建抽象类。
> 
> **说明：**执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> **异常详细信息：** System.MissingMethodException：无法创建抽象类。
> 
> **源错误：**在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> **堆栈跟踪：**[MissingMethodException：无法创建抽象类。] System.RuntimeTypeHandle.CreateInstance（RuntimeType 类型，Boolean publicOnly，Boolean noCheck，Boolean& canBeCached，RuntimeMethodHandle& ctor，Boolean& bNeedSecurityCheck）+0 System.RuntimeType.CreateInstanceSlow（Boolean publicOnly，Boolean fillCache）+86 System.RuntimeType.CreateInstanceImpl(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean fillCache) +230 System.Activator.CreateInstance(Type type, Boolean nonPublic) +67 System.RuntimeType.CreateInstanceImpl(BindingFlags bindingAttr, Binder binder, Object[] args, CultureInfo 文化, Object[] activationAttributes) +1051 System.Activator.CreateInstance(Type type, BindingFlags bindingAttr, Binder binder, Object[] args, CultureInfoculture, Object[] activationAttributes) +111 System.Web.Configuration.HandlerFactoryCache..ctor(String type) +57 System.Web.HttpApplication.GetFactory(String type) +78 System.Web.MaterializeHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +229 System.Web. HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155

我有一个看起来像这样的界面：

```
public interface IRoutablePage : IHttpHandler
{
    UrlHelper Url { get; }
    HtmlHelper Html { get; }
    RequestContext RequestContext { get; set;}
} 
```

我有一个抽象类（RouteablePage），它继承了这个接口和 System.Web.UI.Page。

然后我有一个网页（附加到母版页），它继承了 RoutablePage 类。

我在我的 Web 配置中设置了路由，当我尝试访问[http://local.url/pageName](http://local.url/pageName)时，我体验到带有上述信息的 YSOD。

有人可以帮忙解决这个问题吗？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-20T07:47:38.760

我有同样的问题。我能够在这个论坛上找到答案[http://forums.asp.net/t/1272109.aspx](http://forums.asp.net/t/1272109.aspx)

交叉发布对我有帮助的东西：

> 在 Web.config -> system.webserver -> 处理程序中，替换

```
 <add name="UrlRoutingHandler"
 preCondition="integratedMode" verb="*"
 path="UrlRouting.axd"
 type="System.Web.Routing.UrlRoutingHandler,
 System.Web.Routing, Version=0.0.0.0,
 Culture=neutral,
 PublicKeyToken=31BF3856AD364E35"/> 
```

> 和：

```
 <add name="UrlRoutingHandler"
 preCondition="integratedMode" verb="*"
 path="UrlRouting.axd"
 type="System.Web.HttpForbiddenHandler,
 System.Web, Version=2.0.0.0,
 Culture=neutral,
 PublicKeyToken=b03f5f7f11d50a3a" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T00:25:25.443

该问题已暂时解决。在IIS7下运行网站会出现上述问题，使用cassini运行网站，每次都按预期运行，没有错误。

但是，将不胜感激有关此问题的任何进一步信息。

# python - 使用非常大的 Python 脚本向 Django 应用程序填充数据

> ID：677962
> 
> 赞同：0
> 
> 时间：2009-03-24T15:36:39.397
> 
> 标签：python, database, django, migration

我编写了一个程序，它输出一个 Python 程序，该程序用数据填充我的[Django](http://en.wikipedia.org/wiki/Django_%28web_framework%29)应用程序。然而，这个程序有 23 MB 大，我的电脑无法运行它。有解决方案吗？

填充数据库的另一种可能的解决方案是使用夹具。问题是我还不知道新的主键......或者我必须使用旧的（我不喜欢）。

有什么建议么？

我的路径的原因：我正在迁移一个与新数据库非常不同的数据库，它也有很多关系。23 MB 的程序会记住源数据库中的所有对象，这就是为什么它不容易被切成两半的原因。也许有更好的方法来做到这一点？我更喜欢使用 Django，而不是使用原始 SQL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T18:32:23.483

在大多数情况下，您可以找到对象的自然层次结构。有时存在某种“主控”，所有其他对象都有对该主控和彼此的外键（FK）引用。

在这种情况下，您可以使用类似于 XML 的结构，每个主对象“包含”许多子对象。在这种情况下，您首先插入主对象，所有子对象都具有对现有对象的 FK 引用。

然而，在某些情况下，存在与现有对象不能是简单 FK 的关系。在这种情况下，您有循环依赖项，您必须 (1) 暂时中断此依赖项并 (2) 在加载对象后重新创建依赖项。

您可以通过 (a) 将模型定义为具有可选的 FK，(b) 并具有临时的“自然键”引用来做到这一点。您将在没有正确 FK 的情况下加载数据（它是可选的）。

然后，在加载数据后，您将返回第二遍并插入所有缺少的 FK 引用。完成此操作后，您可以修改模型以强制执行 FK。

程序 1 - 从旧数据库导出到简单的平面文件。CSV 格式或 JSON 格式或简单的东西。

```
for m in OldModel.objects.all():
    aDict = { 'col1':m.col1, 'old_at_fk':m.fktoanothertable.id, 'old_id':id }
    csvwriter.writerow( aDict ) 
```

程序 2 - 读取简单的平面文件；构建新的数据库模型对象。

```
# Pass 1 - raw load

for row in csv.reader:
    new= NewModel.create( **row )

# Pass 2 - resolve FK's

for nm in NewModel.objects.all():
    ref1= OtherModel.objects.get( old_id=nm.old_at_fk )
    nm.properfk = ref1
    nm.save() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:40:32.087

您的计算机不会运行它，因为它是一个大程序？

也许您应该引用一个或多个具有所有结构的外部文件，然后将其转储到数据库中，而不是将其写入脚本/软件中...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T15:41:01.553

将数据放在一个单独的文件（或多个文件）中。然后编写一个小程序，读取数据并通过 Django 填充您的数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T16:45:03.553

如果我正确阅读了您的帖子，那么您正在从旧数据库中读取并基于该数据编写“python 程序”。在我看来，这似乎是错误的做法。

我的建议是通过从数据库中读取数据，根据需要对其进行修改，然后将其转储到文件中来创建旧数据库的可延展版本（XML 可以很好地工作）。

使用这个可延展的数据版本，使用单独的程序通过您的 Django 模型将此数据导入新数据库。

如果您需要复制此过程，这也将为您提供一定程度的灵活性。

# project-management - 项目的不同阶段有不同的数据库实例？

> ID：677967
> 
> 赞同：0
> 
> 时间：2009-03-24T15:37:35.667
> 
> 标签：project-management

推荐吗？大家对此怎么看？

或者任何人有更好的方法来管理项目的不同阶段，通过源代码控制/数据库控制来分享他们的观点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T16:04:37.053

我的建议是使用与项目中其余代码**相同的 SCM 存储库和分支**，将数据库模式定义保持在源代码控制之下。这样更容易使数据库与使用它的应用程序保持同步。应用程序查询一个不存在的表会很尴尬。

由于开发通常在源代码控制的不同分支中进行（例如 1.0 版维护、1.1 版开发和 2.0 版早期开发），因此**每个分支都需要一个数据库实例**。这允许您根据需要修改 1.1 和 2.0 版本的数据库设计，而不会干扰 1.0 版本维护工作的稳定性。

您肯定需要一个单独的数据库实例来进行**生产与测试**。我开发了一个向用户发送通知电子邮件的应用程序。我不希望用户被我的测试实例发送的虚假电子邮件所迷惑。在我的测试数据中，我将所有电子邮件地址更改为我自己域中的模拟地址，因此我可以验证它们是否被正确发送，发送次数不限，而不会打扰任何人。如果我使用相同的数据库进行测试和生产，我就无法做到这一点。

理想情况下，团队中的**每个开发人员**都应该有自己的环境，包括系统的所有组件（例如数据库）。这样每个开发人员都可以独立工作，能够进行更改和调用调试器等，而不会干扰团队中其他任何人的工作。

另一方面，这可能不切实际。为每个开发人员设置一个完整的复制系统可能过于昂贵。将此设置工作的成本与提高生产力的潜力进行比较，因为开发人员不必尽可能多地相互协调测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T19:03:00.803

通常我有多个数据库

*   一个用于支持（如果您有多个版本，则需要更多）。
*   一种用于回归测试
*   一个用于 QA 的单元测试/实验
*   一个用于开发人员的开发/实验（有时是多个实例，但我更喜欢一个 - 这样我们可以确定每个人都在编码相同的模式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T15:45:45.973

如果不同阶段是指开发阶段和生产阶段，那么无论如何都是好的。但我不认为在开发阶段使用不同的数据库实例是一个好习惯——在你的项目中有什么理由这样做吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T16:22:29.303

我可以将您的问题归结为最明智的含义是：项目的哪些阶段需要自己的共享数据库实例？标准答案（我通常同意，其他条件相同）是开发（针对当前构建）、测试（结构静态且可刷新以进行回归测试）和生产。

设计开发与实现开发可能会增加更多；多种测试；等等

当然，每个开发人员都应该能够克隆其中的任何一个以用于非共享目的。

# iphone - 使用 Wi-Fi 获取当前位置？

> ID：677969
> 
> 赞同：1
> 
> 时间：2009-03-24T15:38:10.563
> 
> 标签：iphone, objective-c, core-location

如何在不使用 GPS 的情况下使用 iPhone 中[的 Wi-Fi](http://en.wikipedia.org/wiki/Wi-Fi)塔获取当前位置？

实际上我有一部不包含任何 GPS的旧[iPhone 。](http://en.wikipedia.org/wiki/IPhone)所以我想使用 Wi-Fi 或任何其他方法找到我当前的位置。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-24T15:53:51.103

iPhone OS 中的定位服务会自动执行此操作。只需在您的 LocationManager 中请求“最佳准确性”，它就会为您完成剩下的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-11T10:37:22.370

不过，并非所有[Wi-Fi](http://en.wikipedia.org/wiki/Wi-Fi)区域都会为您提供此功能！

# asp.net-mvc - 查看不显示更新的值 asp.net mvc

> ID：677974
> 
> 赞同：1
> 
> 时间：2009-03-24T15:39:26.677
> 
> 标签：asp.net-mvc, jquery

我们想对视图中的某些值执行一些计算......所以当用户在输入中输入一个值时......我们想回到服务器......执行计算并使用“刷新”视图新值...使用现在的代码，它输入正确的（...或至少是我要求的）控制器操作，正确执行计算并将更新的 ViewData 返回到视图。当我通过为视图构建 html 的循环时，ViewData 具有更新的值，但是当视图显示在浏览器上时，值没有改变......

这是javascript

```
$('input.changeValue').change(function() {
    $('body').css('cursor', 'wait');
    var changedAmt = this.value;
    var frmUpdate = $('form#frmUpdate').serializeArray();

    fooSoldObj = new Object();
    fooSoldObj.name = 'fooSoldAmt';
    fooSoldObj.value = changedAmt;

    frmUpdate[frmUpdate.length] = fooSoldObj;

    $.ajax(
            {
                type: $('form#frmUpdate')[0].method,
                url: $('form#frmUpdate')[0].action,
                data: frmUpdate,
                dataType: 'html',
                error: function(error) {
                    alert('frmUpdate error' + error);
                }
            }
        ); 

    setTimeout(function() {
        $('body').css('cursor', 'default');
    }, 0);
}); 
```

这是 frmUpdate 表单的 html 的样子

```
<form action="/Forecast/Update" id="frmUpdate" method="post" name="frmUpdate">
    <span>
        <input id="HiddenForecastID" name="HiddenForecastID" type="hidden" value="XXX" />
        <input id="HiddenForecastYear" name="HiddenForecastYear" type="hidden" value="2009" />
        <input id="HiddenForecastMonth" name="HiddenForecastMonth" type="hidden" value="3" />       
    </span>
</form> 
```

现在只是为了进一步混淆，未正确显示的数据在视图上以不同的形式出现。原因（对或错）我有两个表单是视图上的另一个表单启动了保存例程。

这是控制器动作的相关部分

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Update(FormCollection frmUpdate)            
    {
        //go off and do some stuff...this part works as the ViewData 
        //is correct....meaning it has the updated values that
        //we want to see displayed in the view
        return View("MyView", ViewData[someData]);

    } 
```

我在想，也许它不起作用的原因是我正在更新一个表单，然后要求 MVC 视图引擎更新/刷新另一个表单（但请记住，当我在构建的视图上逐步循环时页面，数据已更新，但浏览器中的页面未更新）...如何使视图显示正确的 html？

/************************************************
刚刚添加了以下代码测试 RedirectToAction
上面的 ajax 调用不会出错 return View("blah") 东西
****************************** ******************/

PS刚刚在这样的控制器中尝试了RedirectToAction

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Update(FormCollection frmUpdate)            
    {
        //go off and do some stuff...this part works as the ViewData 
        //is correct....meaning it has the updated values that
        //we want to see displayed in the view
        return RedirectToAction("MyView", new RouteValueDictionary( new { controller = "Forecast", action = "MyView", addMonth = monthAdd } ) );
    } 
```

但随后出现 500 错误的 ajax 调用错误

谢谢，
格雷格

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T22:17:34.393

您快到了。这是我们的做法。

在视图中，对于要通过 ajax 更新的部分，将 html 从此处复制到局部视图，我们将调用 Partial_View_of_Form 并将其呈现在视图上。我们将把它放在一个唯一的 div 中，以便我们以后可以替换这个内容......

```
<div id="replace_me">
  <% Html.RenderPartial("Partial_View_of_Form", ViewData[someData]); %>
</div> 
```

对于 Update() 而不是返回视图，返回我们刚刚使用新值创建的局部视图：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Update(FormCollection frmUpdate)
{
    // do whatever processing you need here
    return PartialView("Partial_View_of_Form", ViewData[updatedData]));
} 
```

最后，在 ajax 帖子中，获取您从操作返回的 html 并替换原始部分视图的内容。

```
success: function(html)
{
    $("#replace_me").html(html); 
} 
```

这是相当粗略的代码并且未经测试，但应该很容易从这里开始

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T15:49:51.987

您在这里有 2 个独立的环境。您的 MVC 代码在服务器上运行，而您的 javascript 在客户端（浏览器）上运行。当您提交表单时，浏览器会将请求发送回服务器，您的控制器会处理它并提供数据以供视图呈现。呈现的视图被发送回浏览器，浏览器必须对其进行解释。

500 响应代码表示“服务器错误”。换句话说，服务器在向浏览器发送响应之前遇到了一些问题。尝试检查您看到错误时提供的错误详细信息。它应该给你一些关于出了什么问题的线索。您正在渲染的视图中可能只是一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T21:45:02.570

我得到了显示更新数据的视图...它只是不是 ajaxy...这是我对 javascript 所做的更改

```
$('input.changeValue').change(function() {
    $('body').css('cursor', 'wait');
var changedAmt = this.value;
var frmUpdate = $('form#frmUpdate').serializeArray();

fooSoldObj = new Object();
fooSoldObj.name = 'fooSoldAmt';
fooSoldObj.value = changedAmt;

frmUpdate[frmUpdate.length] = fooSoldObj;

$.ajax(
        {
            type: $('form#frmUpdate')[0].method,
            url: $('form#frmUpdate')[0].action,
            data: frmUpdate,
            dataType: 'html',
            /* the line below is the change */
            success: function() { window.location = document.location.href; },
            error: function(error) {
                alert('frmUpdate error' + error);
            }
        }
    ); 

setTimeout(function() {
    $('body').css('cursor', 'default');
}, 0);
}); 
```

所以现在 $.ajax 将数据 frmUpdate 发送到服务器...服务器对 Session 对象中的数据进行了一些更改...将保存的数据存储在 Session 对象中...然后通过

```
window.location = document.location.href 
```

线，启动控制器动作

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult MyView(int monthAdd) 
```

然后查看 Session 对象，获取刚刚更改的数据并返回视图......似乎我正在绕过我的肘部来获得我的 a$$ :)

# jquery - jQuery UI Datepicker - 禁用特定日期

> ID：677976
> 
> 赞同：23
> 
> 时间：2009-03-24T15:39:28.313
> 
> 标签：jquery, jquery-ui, datepicker

是否有任何（简单）方法可以将 jQuery UI Datepicker 设置为不允许选择特定的预定日期？

我能够使[这种方法](https://stackoverflow.com/questions/501943/can-the-jquery-ui-datepicker-be-made-to-disable-saturdays-and-sundays-and-holida/503082#503082)正常工作，但是，它会产生一个空错误，从而阻止它在 IE 中显示。

> 'natDays[...].0' 为 null 或不是对象

提前致谢！

**更新：**如果我包含一些代码可能会有所帮助，对吧？无论如何，大部分内容都是直接取自上述线程：

```
natDays = [
        [7, 23], [7, 24], [8, 13], [8, 14], 
    ];

    function nationalDays(date) {
        for (i = 0; i < natDays.length; i++) {
            if (date.getMonth() == natDays[i][0] - 1
            && date.getDate() == natDays[i][1]) {
                return [false, natDays[i][2] + '_day'];
            }
        }
        return [true, ''];
    }

    function noWeekendsOrHolidays(date) {
        var noWeekend = $.datepicker.noWeekends(date);
        if (noWeekend[0]) {
            return nationalDays(date);
        } else {
            return noWeekend;
        }
    }

    $(function() { 
        $("#datepicker").datepicker({
            inline: true,
            minDate: new Date(2009, 6, 6), 
            maxDate: new Date(2009, 7, 14), 
            numberOfMonths: 2, 
            hideIfNoPrevNext: true,
            beforeShowDay: $.datepicker.noWeekends,
            altField: '#alternate',
        }); 
    }); 
```

再次感谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-05-06T06:36:40.253

这是一种禁止选择特定日期的方法：

```
var unavailableDates = ["9-5-2011","14-5-2011","15-5-2011"];

function unavailable(date) {
  dmy = date.getDate() + "-" + (date.getMonth()+1) + "-" + date.getFullYear();
  if ($.inArray(dmy, unavailableDates) < 0) {
    return [true,"","Book Now"];
  } else {
    return [false,"","Booked Out"];
  }
}

$('#iDate').datepicker({ beforeShowDay: unavailable }); 
```

[*来源：jQuery - Datepicker - 禁用特定日期*](http://tokenposts.blogspot.com/2011/05/jquery-datepicker-disable-specific.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T17:21:42.333

您是否尝试过在前面使用 'var' 关键字正确声明 natDays？

另外 - 您在 natDays 定义的末尾有一个额外的逗号。

natDays[i][2] 不起作用，因为您的数组中只有 2 个项目 - 试试 ''

此外，您需要正确设置 beforeShowDay 函数名称 - 看起来它甚至不会调用您的自定义函数

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-25T19:10:05.353

您可以使用该`beforeShowDay`选项。我需要禁用该月 28 日之后的任何一天。这是我的代码。

```
$('.datepicker').datepicker({
    dateFormat: "yy-mm-dd",
    beforeShowDay: function(date) {
        var day = date.getDate();
        if (day > 28) {
            return [false];
        } else {
            return [true];
        }
    }
}); 
```

以下是有关它的更多信息：http: [//api.jqueryui.com/datepicker/#option-beforeShowDay](http://api.jqueryui.com/datepicker/#option-beforeShowDay)

传递给 beforeShowDay 回调的日期变量是一个 JavaScript 日期对象，因此可以使用各种库对其进行格式化，可以使用 date.getTime() 等检索时间戳。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-30T00:43:20.787

```
beforeShowDay: $.datepicker.noWeekends, 
```

将会

```
beforeShowDay: noWeekendsOrHolidays, 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-17T09:12:18.357

IE 的问题很可能在以下行：

```
altField: '#alternate',
}); 
```

尝试删除逗号符号，它应该可以工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-14T22:35:57.330

```
 var unavailableDates = ["19-8-2014","14-9-2014"];

 function unavailable(date) {
    dmy = date.getDate() + "-" + (date.getMonth()+1) + "-" +date.getFullYear();
    if ($.inArray(dmy, unavailableDates) < 0) {
     return [true,"","Book Now"];
    } else {
  return [false,"","Booked Out"];
  }
 }

 $('#iDate').datepicker({ beforeShowDay: unavailable }); 
```

现场演示：http: [//jsfiddle.net/vfod0krm/](http://jsfiddle.net/vfod0krm/)

# python - python中的弱引用列表

> ID：677978
> 
> 赞同：18
> 
> 时间：2009-03-24T15:39:59.840
> 
> 标签：python, weak-references

我需要一个弱引用列表，当它们死亡时删除它们。目前我这样做的唯一方法是继续刷新列表（手动删除死引用）。

我知道有一个 WeakKeyDictionary 和一个 WeakValueDictionary，但我真的很喜欢 WeakList，有没有办法做到这一点？

这是一个例子：

```
import weakref

class A(object):
    def __init__(self):
       pass

class B(object):
    def __init__(self):
        self._references = []

    def addReference(self, obj):
        self._references.append(weakref.ref(obj))

    def flush(self):
        toRemove = []

        for ref in self._references:
            if ref() is None:
                toRemove.append(ref)

        for item in toRemove:
            self._references.remove(item)

b = B()

a1 = A()
b.addReference(a1)
a2 = A()
b.addReference(a2)

del a1
b.flush()
del a2
b.flush() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T17:08:36.773

您可以自己实现它，类似于您的做法，但使用`flush()`在尝试访问项目之前调用的列表子类。

显然，您不想在每次访问时都这样做，但是您可以通过在弱引用上设置回调来优化此操作，以便在某些事情死亡时将列表标记为脏。然后，您只需要在自上次访问后发生某些事情时刷新列表。

这是使用此方法实现的列表类。（请注意，它没有经过太多测试，并且某些方法的实现效率不高（例如，那些只是转换为真实列表并在其上调用方法的方法），但这应该是一个合理的起点：

```
import weakref

class WeakList(list):
    def __init__(self, seq=()):
        list.__init__(self)
        self._refs = []
        self._dirty=False
        for x in seq: self.append(x)

    def _mark_dirty(self, wref):
        self._dirty = True

    def flush(self):
        self._refs = [x for x in self._refs if x() is not None]
        self._dirty=False

    def __getitem__(self, idx):
        if self._dirty: self.flush()
        return self._refs[idx]()

    def __iter__(self):
        for ref in self._refs:
            obj = ref()
            if obj is not None: yield obj

    def __repr__(self):
        return "WeakList(%r)" % list(self)

    def __len__(self):
        if self._dirty: self.flush()
        return len(self._refs)

    def __setitem__(self, idx, obj):
        if isinstance(idx, slice):
            self._refs[idx] = [weakref.ref(obj, self._mark_dirty) for x in obj]
        else:
            self._refs[idx] = weakref.ref(obj, self._mark_dirty)

    def __delitem__(self, idx):
        del self._refs[idx]

    def append(self, obj):
        self._refs.append(weakref.ref(obj, self._mark_dirty))

    def count(self, obj):
        return list(self).count(obj)

    def extend(self, items):
        for x in items: self.append(x)

    def index(self, obj):
        return list(self).index(obj)

    def insert(self, idx, obj):
        self._refs.insert(idx, weakref.ref(obj, self._mark_dirty))

    def pop(self, idx):
        if self._dirty: self.flush()
        obj=self._refs[idx]()
        del self._refs[idx]
        return obj

    def remove(self, obj):
        if self._dirty: self.flush() # Ensure all valid.
        for i, x in enumerate(self):
            if x == obj:
                del self[i]

    def reverse(self):
        self._refs.reverse()

    def sort(self, cmp=None, key=None, reverse=False):
        if self._dirty: self.flush()
        if key is not None:
            key = lambda x,key=key: key(x())
        else:
            key = apply
        self._refs.sort(cmp=cmp, key=key, reverse=reverse)

    def __add__(self, other):
        l = WeakList(self)
        l.extend(other)
        return l

    def __iadd__(self, other):
        self.extend(other)
        return self

    def __contains__(self, obj):
        return obj in list(self)

    def __mul__(self, n):
        return WeakList(list(self)*n)

    def __imul__(self, n):
        self._refs *= n
        return self 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-06-07T22:52:26.227

您可以使用`WeakSet`同一个weakref 模块（顺便说一句，它实际上是在其他地方定义的，但它是在那里导入的）。

```
>>> from weakref import WeakSet
>>> s = WeakSet()
>>> class Obj(object): pass # can't weakref simple objects
>>> a = Obj()
>>> s.add(a)
>>> print len(s)
1
>>> del a
>>> print len(s)
0 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-21T05:06:19.997

因为我需要像你这样的弱引用列表，所以我制作了一个并将其发布在 pypi 上。

现在你可以这样做：

```
pip install weakreflist 
```

然后：

```
from weakreflist import WeakList 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-04-12T22:09:36.393

为什么你不能这样做：

```
import weakref

class WeakList(list):
    def append(self, item):
        list.append(self, weakref.ref(item, self.remove)) 
```

`__iadd__`然后对等做类似的`extend`事情。对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-15T20:44:50.897

使用传递给弱引用的第二个参数的回调函数。

这段代码应该起作用：

```
import weakref

class WeakRefList(list):

    def add_reference(self, obj):
        self._references.append(weakref.proxy(obj, self.remove)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-31T19:43:32.467

你打算如何使用`B`？我对我构建的弱引用列表所做的唯一事情就是迭代它，所以它的实现很简单：

```
import weakref

class WeakRefList(object):
    "weakref psuedo list"
    def __init__(yo):
        yo._items = list()
    def __iter__(yo):
        yo._items = [s for s in yo._items if s() is not None]
        return (s() for s in yo._items if s() is not None)
    def __len__(yo):
        yo._items = [s for s in yo._items if s() is not None]
        return len(yo._items)
    def append(yo, new_item):
        yo._items.append(weakref.ref(new_item))
        yo._items = [s for s in yo._items if s() is not None] 
```

# c# - 在控制器外设置 ViewData

> ID：677980
> 
> 赞同：3
> 
> 时间：2009-03-24T15:40:17.453
> 
> 标签：c#, asp.net-mvc, linq, debugging

我正在尝试创建一个记录器，它将 LINQ 执行的查询写入使用出色的 JavaScript 库 SyntaxHighlighter 格式化的页面。

为此，我已将 DataContext 的 Log 属性设置为我的自定义记录器，该记录器运行良好。

现在我只需要获取当前的 Controller 对象（在控制器执行上下文之外），这样我就可以设置一些 ViewData 需要输出的内容。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T15:50:29.440

如果你想在控制器之外执行操作，那么 action-filters (etc) 是一个不错的选择；只需从 继承`ActionFilterAttribute`，覆盖`OnActionExecuting`（等）以将数据注入视图，并用 . 标记您的控制器`[YourCustomFilter]`。

[像这样](https://stackoverflow.com/questions/672327/672550#672550)

* * *

（原文；我可能误解了）

最好在这里使用依赖注入，通过将日志写入器作为构造函数参数传递到存储库（理想情况下通过 StructureMap 之类的东西，它通过 StructureMapControllerFactory 与 MVC 很好地配合，或类似的东西）。

# macos - 如何将选择复制到 OS X 剪贴板

> ID：677986
> 
> 赞同：230
> 
> 时间：2009-03-24T15:41:23.783
> 
> 标签：macos, vim, clipboard

我在 Vim 中选择了一个区域。如何将其复制到 OS X 剪贴板？

（可以通过管道将 OS X 剪贴板写入到`/usr/bin/pbcopy`）

* * *

## 回答 #1

> 赞同：255
> 
> 时间：2009-03-25T04:57:00.690

对于[MacVim](http://code.google.com/p/macvim/)和 Windows Gvim，只需将以下内容添加到您的`~/.vimrc`:

```
set clipboard=unnamed 
```

现在，所有操作，如`yy`、`D`和 ，`P`都可以使用剪贴板。无需在它们前面加上`"*`or `"+`。

* * *

## 回答 #2

> 赞同：139
> 
> 时间：2009-03-24T21:55:14.387

如果启用了剪贴板，您可以通过点击将选定区域复制到剪贴板`"*y`

要查看它是否已启用，请运行`vim --version`并查找`+clipboard`or `-clipboard`。例如，在我的 10.5.6 机器上默认情况下未启用它：

```
% 哪个 vim
/usr/bin/vim
% vim --版本
VIM - Vi IMproved 7.2（2008 年 8 月 9 日，2008 年 11 月 11 日 17:20:43 编译）
包含的补丁：1-22
_www@b77.apple.com 编译
没有图形用户界面的普通版。  包含 (+) 或不包含 (-) 的功能：
*...* 
-clientserver -clipboard +cmdline_compl +cmdline_hist +cmdline_info +comments
 *...*

```

如果它是用 编译的`+clipboard`，我就可以使用`"*`寄存器来访问系统剪贴板。

我下载了[7.2 的源代码](ftp://ftp.vim.org/pub/vim/unix/vim-7.2.tar.bz2)并编译了它（easy as `tar xjf vim-7.2.tar.bz && cd vim72 && ./configure && make && sudo make install`），并启用了剪贴板：

```
% 哪个 vim
/usr/local/bin/vim
% vim --版本
VIM - Vi IMproved 7.2（2008 年 8 月 9 日，2009 年 3 月 24 日 17:31:52 编译）
由 rampion@Myrrhy.local 编译
带有 GTK2 GUI 的普通版本。  包含 (+) 或不包含 (-) 的功能：
*...* 
+clientserver +clipboard +cmdline_compl +cmdline_hist +cmdline_info +comments
 *...*

```

但是，即使在编译之后，我在 Terminal.app 中运行 vim 时也无法复制到剪贴板，只能在 X11.app 中。

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2012-02-25T23:19:13.040

您可以直观地选择文本和类型`:w !pbcopy<CR>`

或者，您可以在`~/.vimrc`文件中包含以下键映射。他们以可视模式剪切/复制文本到操作系统的剪贴板。

```
vmap <C-x> :!pbcopy<CR>  
vmap <C-c> :w !pbcopy<CR><CR> 
```

来源：[http ://drydevelopment.com/blog/vim-pbcopy-on-os-x](http://drydevelopment.com/blog/vim-pbcopy-on-os-x)

* * *

## 回答 #4

> 赞同：83
> 
> 时间：2009-03-24T15:45:45.490

根据我使用的 Vim 版本，我可以使用`+`寄存器来访问剪贴板。

“ [Mac OS X 剪贴板共享](http://vim.wikia.com/wiki/Mac_OS_X_clipboard_sharing)”可能也有一些对你有用的想法。

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2009-03-24T15:44:03.310

`"``*`任何 yank 命令之前的双引号星号 ( ) 会将结果拉入复制缓冲区。这也适用于 Windows 和 Linux。

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2013-08-31T23:32:03.197

在 macos 10.8 上，vim 是用编译的，`-clipboard`所以要使用`"*y`你需要重新编译。幸运的是`brew install vim`，它会为您轻松编译一个新版本，它将是`+clipboard`.

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2013-06-15T17:56:51.157

直观地选择文本并键入：

```
ggVG
!tee >(pbcopy) 
```

我觉得比：

```
ggVG
:w !pbcopy 
```

由于它不会出现提示：“按 ENTER 或键入命令继续”

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2016-09-21T21:53:10.007

就我而言，我只需要这样做：

```
:set mouse=v 
```

[请访问 superuser.com 上的原始解决方案](https://superuser.com/questions/436890/cant-copy-to-clipboard-from-vim)

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2010-02-06T00:21:16.333

如果您使用的是 MacPorts，您可以通过以下方式升级您的 VIM 以包括剪贴板支持：

```
port install vim +x +x11 
```

现在您使用`"+`寄存器将文本直接拉到您的 Mac 剪贴板。奇迹般有效。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2015-06-09T15:29:48.713

如果您使用的是 MacOS X：

```
$ brew install vim
$ vim --version
VIM - Vi IMproved 7.4 [...] 
```

然后，添加到您的 .vimrc：

```
set clipboard=unnamed 
```

现在您只需要在*vim*中执行`:%y`，即可将所有内容复制到剪贴板。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2014-01-09T21:44:56.543

如果你的 Vim 没有用剪贴板编译，你希望复制选定的文本而不是整行，你不想安装 MacVim 或其他 GUI，最简单的解决方案是将此行添加到你的 .vimrc：

```
map <C-c> y:e ~/clipsongzboard<CR>P:w !pbcopy<CR><CR>:bdelete!<CR> 
```

要使用它，只需直观地选择要复制的文本，然后`Control`- `C`。如果您想了解此行的完整说明，请阅读“[如何在 vim 上复制到剪贴板](http://vimtips.quora.com/How-to-Copy-to-clipboard-on-vim)”。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2015-05-10T21:19:12.273

使用[Homebrew 的](http://brew.sh/)vim：`brew install vim`

Mac（从 10.10.3 Yosemite 开始）预装了一个**没有**`clipboard`启用标志的系统 vim。

您可以自己编译 vim 并启用该标志，或者简单地使用正确设置的 Homebrew 的 vim。

要亲自查看，请查看库存系统 vim`/usr/bin/vim --version`

你会看到类似的东西：

```
$ /usr/bin/vim --version

VIM - Vi IMproved 7.3 (2010 Aug 15, compiled Nov  5 2014 21:00:28)
Compiled by root@apple.com
Normal version without GUI.  Features included (+) or not (-):
... -clientserver -clipboard +cmdline_compl ... 
```

注意`-clipboard`

使用 homebrew 的 vim 你会得到

```
$ /usr/local/bin/vim --version

VIM - Vi IMproved 7.4 (2013 Aug 10, compiled May 10 2015 14:04:42)
MacOS X (unix) version
Included patches: 1-712
Compiled by Homebrew
Huge version without GUI.  Features included (+) or not (-):
... +clipboard ... 
```

注意`+clipboard`

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2015-06-03T06:25:38.233

我用了：

```
map <C-x> :!pbcopy<CR>
vmap <C-c> :w !pbcopy<CR><CR> 
```

它工作得非常好。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-03-24T15:58:19.923

当您在 Mac 上时，您可以使用[MacVim使用标准 OS 键轻松访问剪贴板。](http://code.google.com/p/macvim/)

它也完全向后兼容普通的 Vim，所以我什至不需要单独的`.vimrc`.

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-03-24T15:45:23.837

命令-C？这至少适用于从 Terminal.app 内启动的 vim，用于使用鼠标选择的文本。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-05-25T20:08:08.853

如果本机不支持[Fakeclip](http://www.vim.org/scripts/script.php?script_id=2098)`+`和缓冲区，则它们将实现。`*`

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2015-05-09T19:25:57.577

我的主要问题是 Vim 的默认 OSX 版本。`+clipboard`通过添加到构建中的自制软件安装它。

您可以通过以下方式检查：

```
vim --version 
```

看看它是否说`-clipboard`或`+clipboard`。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-10-26T04:23:26.473

如果您`+clipboard`在 Vim 安装中有选项（您可以使用 进行检查`:version`）并且您处于可视模式，您可以这样做`"+y`这会将选择拉到`+`剪贴板的缓冲区。

我已将以下地图添加到我的 vimrc 中，它工作正常。

`vmap <leader>y "+y` ：有了这个，我可以在可视模式`leader key`下`y`复制到剪贴板。

`nmap <leader>p "+p` ：有了这个，我可以在正常模式下从剪贴板粘贴`leader key`。`p`

PD：在 Ubuntu 上，我必须安装 vim-gtk 才能获得该`+clipboard`选项。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-06-06T12:13:59.053

我目前在 OS X 10.9 上，我用**+xterm_clipboard**编译 vim 的努力没有给我带来任何结果。所以我目前的解决方案是[在终端模式下使用 MacVim，](https://stackoverflow.com/a/5679658/1619451)`set clipboard=unnamed`并在我的 ~/.vimrc 文件中添加选项。非常适合我。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-06-02T23:58:48.813

什么对我有用`.vimrc`

```
set clipboard=unnamed
if has("unnamedplus") " X11 support
    set clipboard+=unnamedplus
endif 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2019-02-10T17:54:45.303

对于 Mac - 按住`option`键，然后`ctrl V`选择文本就可以了。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-07-19T08:31:59.853

Shift cmd c – 设置复制模式 拖动鼠标，选择文本， cmd c 复制选定文本 Cmd v 粘贴

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-10-27T20:44:29.780

使用映射的最佳方式。

例如：

```
nnoremap C "+y
vnoremap C "+y
nnoremap cC ^"+y$ 
```

这会将大写 C 映射到剪贴板，而不更改任何内容。适用于任何 vim。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2009-05-25T19:12:12.927

对于 Ubuntu 用户，您要使用剪贴板检索的包是 vim-full。其他软件包（vim-tiny、vim）不包括剪贴板功能。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2013-08-13T19:36:49.903

使用寄存器“+”或“*”复制到剪贴板不起作用？

原因：您的特定版本的 vim 是在不支持剪贴板的情况下编译的。在控制台上键入 vim --verion ，您将看到**-xterm_clipboard**。使用 gui 包安装 vim 解决了这个问题。在 ubuntu 上，您可以通过在 shell 上键入来执行此操作：

sudo apt-get install vim-gui-common

现在再次在控制台上执行 vim --version 。很可能，您现在会看到**+xterm_clipboard**！

因此，现在您可以使用寄存器 + 将任何内容复制到剪贴板（例如“+yy 将当前行复制到剪贴板）

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2014-01-03T07:08:07.133

在 Mac 上，当其他任何东西似乎都起作用时 - 用鼠标选择，右键单击选择副本。呜呜

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2017-08-24T02:40:20.100

我遇到了同样的问题，安装后`macvim`仍然无法正常工作，最后我找到了解决方法：

尝试先卸载所有vim，

`brew uninstall macvim`

`brew uninstall --force vim`

并重新安装 macvim

`brew install macvim --with-override-system-vim`

然后你可以使用`"*y`or `"+y`，不必`set clipboard=unnamed`

* * *

## 回答 #28

> 赞同：-2
> 
> 时间：2010-08-12T16:22:25.137

Command-c 在 MacVim 和终端中都适用于我。

# algorithm - n维匹配算法

> ID：677987
> 
> 赞同：5
> 
> 时间：2009-03-24T15:41:36.873
> 
> 标签：algorithm, matching, n-dimensional

在这里寻找一些建议。有谁知道在 n 维空间中开始研究匹配算法的好地方。例如，任何约会网站都必须使用某种算法来匹配 2 个人。我读到的是，我们可以将一个人的特征映射到一个 n 维数组中，每个特征都有一个点系统。一旦我们拥有了一个人的所有（可用）特征，我们就可以在一个 n 维数组中的一个点中表示这个人。然后，匹配 2 个人就像在这个 n-dim 数组中找到 2 点之间的最短距离一样简单。有没有人在实现这类算法时有任何参考？写这些东西的最佳语言是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-24T15:59:09.950

如果你想为一个人找到最接近的匹配，Bentley & Shamos 发表了一种多维分治法：O(N log N) time 分治法：[Divide-and-conquer in multidimensional space](http://portal.acm.org/citation.cfm?id=800113.803652) in 1976 年第八届 ACM 计算理论年度研讨会论文集。如果您无法获得副本[，这](http://www.eecs.umich.edu/~qstout/586/MultiDimDivConq.pdf)也可能会有所帮助。

但是，对于您的示例应用程序，实际上找到最近的邻居似乎并不是最大的问题——将输入映射到维度要棘手得多。例如，如果一个维度是“喜欢动物”，那么对于喜欢狗和猫但不能忍受马的人，你赋予什么价值？喜欢马、认为狗还可以、被猫惹恼、对金鱼矛盾的人呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T15:50:02.813

首先，选择您最熟悉的语言。处理这个问题的算法相当简单，并且应该适用于任何现代语言。（只要有一些数组的概念，可能还有矩阵库，你应该没问题。）我以前在 C、C++ 和 C# 中实现了许多这些，但在 python、vb.net 等中看到了实现.

根据您要执行的操作，有几种选择。

话虽如此，你想做什么取决于你的目标。如果您只想找到最佳匹配，您可以使用简单的距离计算（即：n 维数组中每个维度/属性的平方和的 sqrt），可选地加权每个属性距离，并使用最近点。

如果您想将人们分组在一起，您需要查看[聚类算法](http://en.wikipedia.org/wiki/Data_clustering)。对于这样的数据，我怀疑某种形式的 K-Means 聚类或模糊 c-means 聚类效果最好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-07T05:46:36.623

下面的解决方案怎么样。

假设用户是 U1, U2, U3, U4, U5.... Un。属性是A1，A2，A3，A4，A5..... Am

将这些存储为

A1 - U1、U2、U3... A2 - U4、U6、U7.... A3 -

Profile属性是索引并存储所有用户。现在，如果有新用户出现，请查看其属性，对于这些属性，请查找普通人。一个人出现在这些列表中的次数 - 更高的排名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-02T13:45:55.077

您在示例中描述的不是 n 维匹配，而是具有多个特征的节点的[二分匹配](http://en.wikipedia.org/wiki/Bipartite_graph)。（你需要提供一个函数，假设两个人计算这个距离）。应该有非常有效的算法。在 n 维匹配中，您将尝试匹配来自两个以上集合的节点（在您的示例中，假设您可以将人们切割成身体、灵魂和音乐偏好，然后将它们重新组合成新的人。那么 n 维匹配将把人们分开，然后重新组合，这样新设计的人就会成为非常好的夫妻：D）这是[维基百科文章中的 3 维匹配](http://en.wikipedia.org/wiki/3-dimensional_matching)，它是 np 完整的。

此外，正如另一个人所指出的，如果您的目标不是成对匹配人，而是找到兼容的组，您应该考虑将他们聚集到组中。这可以通过例如[无监督学习来完成](http://en.wikipedia.org/wiki/Unsupervised_learning)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T11:48:28.010

您提到的过程称为k最近邻居，k = 1。这是寻找相似向量的最直观的方法。

[http://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm](http://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm)

# wcf - WCF 服务的流式输出

> ID：677989
> 
> 赞同：0
> 
> 时间：2009-03-24T15:42:05.593
> 
> 标签：wcf, streaming

我正在尝试从 WCF 服务获取流式输出。

我已将其设置`transferMode`为“ `StreamedResponse`”。当客户端从服务器接收到流时，它无法读取流。从服务器端调试时，我可以看到流有数据，但从客户端 stream.Length 抛出 NotSupportedException。将流读入缓冲区会导致读取 0 个字节。

我使用 svcutil 生成了客户端代理，并且正在使用 .NET 3.0。有没有人遇到过类似的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T15:48:13.177

没有任何细节很难提供帮助，但请注意 VS2005 Cassini 服务器（asp.net 开发服务器）不支持通过 http 进行流式传输。

# c# - 阻止卸载的搁浅注册表项

> ID：677996
> 
> 赞同：0
> 
> 时间：2009-03-24T15:43:20.457
> 
> 标签：c#, visual-studio, registry, uninstallation

我有一个无法在我的一台开发计算机上卸载的 .NET/Visual Studio/C# 应用程序。（它可以在另一台开发计算机上安装和卸载。）

这似乎是一个注册表问题。作为测试，我在安装项目中添加了一个新的注册表项，因为这个问题开始了——新的注册表项被卸载程序删除了。只有旧的注册表项和文件不会被卸载。

卸载程序运行时没有错误消息——它只是无法删除应用程序。

如果这是我怀疑的注册表问题，我该如何清理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:02:28.000

使用*Sysinternals*的[regmon](http://live.sysinternals.com)查看运行卸载时正在访问哪些注册表项。尝试查看缺少哪些注册表项并修复它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T17:43:56.420

简单的答案：重新安装 Windows XP

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T18:45:45.823

更好的是，使用 sc.exe。这是一个 Windows 实用程序，可以从您的注册表中删除一项服务。

该命令将是这样的：

c:\windows\system32\sc 删除我的服务****