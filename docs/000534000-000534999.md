# StackOverflow 问答 000534000-000534999

# c++ - C++中的字符串

> ID：534007
> 
> 赞同：8
> 
> 时间：2009-02-10T20:17:44.513
> 
> 标签：c++, string, mutable

我对 C++ 中的字符串有以下疑问

1>>哪个是更好的选择（考虑性能），为什么？

1.

```
string a;
a = "hello!"; 
```

或者

2.

```
string *a;
a = new string("hello!");
...
delete(a); 
```

2>>

```
string a;
a = "less"; 
a = "moreeeeeee"; 
```

当一个较大的字符串被复制到一个较小的字符串中时，c++ 中如何准确地处理内存管理？c++ 字符串是可变的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T20:23:06.077

几乎从来没有必要或可取的说

```
string * s = new string("hello"); 
```

毕竟，你（几乎）永远不会说：

```
int * i = new int(42); 
```

你应该说

```
string s( "hello" ); 
```

或者

```
string s = "hello"; 
```

是的，C++ 字符串是可变的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T20:34:47.127

以下所有内容都是天真的编译器会做的事情。当然，只要不改变程序的行为，编译器就可以自由地进行任何优化。

```
string a;
a = "hello!"; 
```

首先，您初始化 a 以包含空字符串。（将长度设置为 0，以及一两个其他操作）。然后分配一个新值，覆盖已设置的长度值。它可能还必须执行检查以查看当前缓冲区有多大，以及是否应该分配更多内存。

```
string *a;
a = new string("hello!");
...
delete(a); 
```

调用 new 需要操作系统和内存分配器找到一块空闲的内存。那很慢。然后你立即初始化它，所以你不需要分配任何东西两次或要求调整缓冲区的大小，就像你在第一个版本中所做的那样。然后发生了一些不好的事情，您忘记调用 delete，并且您有内存泄漏，*此外*还有一个分配速度极慢的字符串。所以这很糟糕。

```
string a;
a = "less"; 
a = "moreeeeeee"; 
```

与第一种情况一样，您首先初始化 a 以包含空字符串。然后你分配一个新的字符串，然后是另一个。其中每一个都*可能*需要调用 new 来分配更多内存。每行还需要长度，并且可能还需要分配其他内部变量。

通常，您会像这样分配它：

```
string a = "hello"; 
```

一行，执行一次初始化，而不是先默认初始化，然后分配你想要的值。

它还可以最大限度地减少错误，因为您的程序中的任何地方都没有无意义的空字符串。如果字符串存在，它包含您想要的值。

关于内存管理，google RAII。简而言之，字符串在内部调用 new/delete 来调整其缓冲区的大小。这意味着您*永远*不需要使用 new 分配字符串。字符串对象具有固定大小，并且被设计为在堆栈上分配，以便在超出范围时*自动调用析构函数。*然后析构函数保证释放所有分配的内存。这样，您不必在用户代码中使用 new/delete，这意味着您不会泄漏内存。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T20:25:41.953

您经常使用赋值而不是初始化是否有特定原因？也就是说，你为什么不写

```
string a = "Hello"; 
```

ETC。？这避免了默认构造，并且在语义上更有意义。仅仅为了在堆上分配它而创建指向字符串的指针是没有意义的，即您的案例 2 没有意义并且效率稍低。

至于你的最后一个问题，是的，C++ 中的字符串是可变的，除非声明`const`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T20:21:18.500

```
string a;
a = "hello!"; 
```

2操作：调用默认构造函数std:string()然后调用operator::=

```
string *a; a = new string("hello!"); ... delete(a); 
```

只有一个操作：调用构造函数 std:string(const char*) 但你不应该忘记释放你的指针。

那么字符串 a("hello");

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T20:29:31.163

在案例 1.1 中，您的字符串*成员*（包括指向数据的指针）被保留，并且当超出范围`stack`时释放类实例占用的内存。`a`

在案例 1.2 中，成员的内存也是从堆中动态分配的。

当您将`char*`常量分配给字符串时，将包含数据的内存将被`realloc`'ed 以适应新数据。

您可以通过调用来查看分配了多少内存`string::capacity()`。

当您调用 时`string a("hello")`，内存会在构造函数中分配。

构造函数和赋值运算符都在内部调用相同的方法来分配内存并在那里复制新数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T20:30:17.277

如果您查看 STL 字符串类的[文档](http://www.sgi.com/tech/stl/basic_string.html)（我相信 SGI 文档符合规范），许多方法都列出了复杂性保证。我相信许多复杂性保证都故意含糊其辞，以允许不同的实现。我认为某些实现实际上使用了修改时复制的方法，这样将一个字符串分配给另一个字符串是一个恒定时间的操作，但是当您尝试修改其中一个实例时，您可能会产生意想不到的成本。不确定在现代 STL 中是否仍然如此。

您还应该查看该`capacity()`函数，它将告诉您在强制重新分配内存之前可以放入给定字符串实例的最大长度字符串。`reserve()`如果您知道稍后将在变量中存储一个大字符串，您也可以使用导致重新分配到特定数量。

正如其他人所说，就您的示例而言，您应该真正支持初始化而不是其他方法，以避免创建临时对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T20:35:08.467

直接在堆中创建字符串通常不是一个好主意，就像创建基类型一样。这是不值得的，因为对象可以很容易地留在堆栈上，并且它具有高效复制所需的所有复制构造函数和赋值运算符。

std:string 本身在堆中有一个缓冲区，可以由多个字符串共享，具体取决于实现。

例如，使用 Microsoft 的 STL 实现，您可以这样做：

```
string a = "Hello!";
string b = a; 
```

并且两个字符串将共享相同的缓冲区，直到您更改它：

```
a = "Something else!"; 
```

这就是为什么存储 c_str() 以供以后使用非常糟糕的原因；c_str() 仅保证在对该字符串对象进行另一次调用之前有效。

这会导致非常讨厌的并发错误，如果您在多线程应用程序中使用它们，则需要使用定义关闭此共享功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T09:32:26.010

最有可能的

```
 string a("hello!"); 
```

比其他任何东西都快。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-11T20:03:08.723

你来自Java，对吧？在 C++ 中，对象被视为（在大多数情况下）与基本值类型相同。对象可以存在于堆栈或静态存储中，并按值传递。当您在函数中声明字符串时，无论字符串对象占用多少字节，它都会在堆栈上分配。字符串对象本身确实使用动态内存来存储实际字符，但这对您来说是透明的。要记住的另一件事是，当函数退出并且您声明的字符串不再在范围内时，它使用的所有内存都将被释放。不需要垃圾收集（RAII 是你最好的朋友）。

在您的示例中：

```
string a;
a = "less"; 
a = "moreeeeeee"; 
```

这会将一块内存放在堆栈上并将其命名为 a，然后调用构造函数并将 a 初始化为空字符串。编译器将“less”和“moreeeeeee”的字节存储在（我认为）您的 exe 的 .rdata 部分中。字符串 a 将有几个字段，例如长度字段和 char*（我正在大大简化）。当您将“less”分配给 a 时，将调用 operator=() 方法。它动态分配内存来存储输入值，然后将其复制进去。当您稍后将“moreeeeeee”分配给 a 时，将再次调用 operator=() 方法，并在必要时重新分配足够的内存来保存新值，然后复制它进入内部缓冲区。

当字符串 a 的作用域退出时，将调用字符串析构函数并释放为保存实际字符而动态分配的内存。然后堆栈指针递减，保存 a 的内存不再“在”堆栈上。

# iphone - UIWebView 和 UISearchBar 用于搜索

> ID：534009
> 
> 赞同：1
> 
> 时间：2009-02-10T20:18:01.330
> 
> 标签：iphone, uiwebview

我在 UIWebView 的顶部显示了一个 UISearchBar，用于输入用于在 UIWebView 中显示内容的信息。有没有办法将 UISearchBar（或者可能是 UITextField？）附加到 UIWebView“标题”，以便当用户在 webview 上向下滚动时 UISearchBar 也会滚动出视图并且整个窗口能够显示文本？

如果这是不可能的，我还能如何在仍然使用 UIWebView 的固有文本格式功能的同时完成此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T22:36:25.210

您可以尝试在 UIScrollView 中包含 UIWebView 和 UISearchBar。也就是说，创建一个控制器，将主视图作为 UIScrollView，然后将 UISearchBar 和 UIWebView 作为子视图添加。如果您在滚动时想要自定义行为，则可能必须覆盖事件回调以进行滚动。我没有尝试过，但理论上你可以拥有它，这样当你向下滚动并且 UISearchBar 在视图中时，你可以将它隐藏到一定的像素数，直到 UISearchBar 被隐藏。之后，您将滚动请求转发给 UIWebView，以便它可以处理事情。基本上有一个中间人可以根据需要委托滚动事件。

# documentation - 敏捷文档的具体例子？

> ID：534019
> 
> 赞同：11
> 
> 时间：2009-02-10T20:20:42.043
> 
> 标签：documentation, agile, user-stories, burndowncharts

在回答*[项目的文档？](https://stackoverflow.com/questions/533126/documents-for-a-project)*, Chris Ballance 回答说，[“用户故事”和“燃尽图”是对开发人员最有用的两种项目文档类型。](https://stackoverflow.com/questions/533126/documents-for-a-project/533164#533164)

我的问题是，你知道我可以看到（例如在互联网上或在书中）这些类型的文档的任何好的例子吗？

如果可能的话，我很乐意看到很多例子，包括：

*   小/短/简单的例子
*   大/长/复杂的例子
*   著名的例子
*   高质量的例子

对于谷歌来说，我发现这不是一个简单的话题：我发现很多关于它的文章，但展示它的演示较少。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T20:27:39.607

就书籍而言，一个很好的起点是Mike Cohn 的[User Stories Applied](https://rads.stackoverflow.com/amzn/click/com/0321205685)和[Agile Estimation and Planning](https://rads.stackoverflow.com/amzn/click/com/0131479415)。对于任何第一次接触敏捷方法的人来说，这都有很好的例子和很好的起点。

就网站资源而言，它们很少而且相距甚远。实际开始的一个好地方可能是在 Google 图片上搜索这些关键字，因为许多人会为他们的燃尽图和用户故事拍照。这对我开始时帮助很大。以下是一些示例：[燃尽图](http://www.chrisspagnuolo.com/content/binary/Sprint%20Burndown.jpg)和[用户故事](http://sendes.posure.com/support/2006-01-07_UserStories1.png)

但是请注意，虽然燃尽图是一个简单的报告，您可以根据迭代中留下的当前故事点运行，但用户故事比这更复杂，并且确实需要一些阅读才能理解。从用户故事应用书开始。

希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T04:48:40.463

我认为对于这两个问题，您可以做的比浏览 Alistair Cockburn 的网站要糟糕得多。特别是，他有一篇关于燃尽图和生成它们的不同方法的精彩文章：

[http://alistair.cockburn.us/Earned-value+and+burn+charts](http://alistair.cockburn.us/Earned-value+and+burn+charts)

（虽然我回应了早期海报对迈克科恩作品的推荐）。

技巧之一是确定哪种文档对您的项目有益。您是否有很多开发人员，分布在时间和空间上？您将需要更大、更重、更详细的故事。您是否有一两个开发人员在同一个地方工作？你可以摆脱较轻的。团队是否在系统中工作了很长时间（如果它是遗留系统）？轻松的故事可能会。团队是系统新手，还是其业务需求复杂？这会将您推向更详细的方向。

如果您按照十几个小定义中的任何一个进行“小”项目，那么您可能会接受非常轻松的故事。下面是一个示例，同样来自 Cockburn 的网站：

[http://alistair.cockburn.us/Examples+of+ultra-light+use+cases](http://alistair.cockburn.us/Examples+of+ultra-light+use+cases)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T22:38:25.330

几个月前，我们在开发功能的同时开始编写用户文档。每个 Scrum 团队都分配了一名技术作家。

在开发过程中必须编写用户文档有助于验证设计。技术作家也参与应用程序的设计。

这是对发布燃尽和冲刺燃尽的补充。

当团队认为与产品所有者沟通有用时，他们会创建其他文档。随着我们正在学习编写更好的用户故事，这变得不那么重要了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T20:28:46.830

考虑阅读 Ambler 的“敏捷建模”。他提出了一个非常有力的案例，说明为什么只创建大量完整的 UML 是一个相当糟糕的主意，并给出了一些很好的例子。

# html - 支持更清洁设计论点的在线资源

> ID：534029
> 
> 赞同：3
> 
> 时间：2009-02-10T20:22:23.427
> 
> 标签：html, email

我在一家大型律师事务所的网络部门工作，除其他事项外，我还负责维护我们所有电子邮件通信的专业外观（每年超过 600 件）。

现在我陷入了困境。使用很大的压力和操纵，管理人员得到了“艺术指导”几封 HTML 电子邮件，直接与我的团队成员合作，我在最后一刻抓住了这个设计。

她的“设计”在电子邮件文本后面引入了背景图像，以及位于标题后面的附加高对比度图像。

我最终要求改变设计，但她非常坚持“她”的设计，并质疑我所有简化外观的推理。

基本上，她是在质疑我的专业知识，并要求“证明”她的设计对用户不友好。

几个小时后我要开会，想知道这里是否有人可以向我指出讨论这些特定项目的资源：

1.  反对位于电子邮件副本后面的背景图像。这些图像的不透明度约为 10%，这使它们难以理解，并使设计变得忙碌而丑陋（我的观点）。

2.  反对标题背后的高对比度图像。

现在，我知道在 HTML 电子邮件中包含图像的技术含义、Outlook 2007 不加载背景图像等。这不是技术问题，而是朝着错误方向迈出的严重美学/可用性步骤。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T20:59:34.913

**事实：**

沟通中的常识表明，任何使您从消息中分心的事情——电子邮件的内容都不是一个好主意。

您的信头背景和所有发票上是否有图像？为什么这样？为什么不？

背景图像对信息的价值和感知、贵公司的形象有何贡献？是否清楚地知道它们的影响？

去看看电子邮件通讯网站。它们包含在有关如何有效地通过电子邮件发送市场的指南和教程中。

www.icontact.com www.constantcontact.com 等等..

**意见：**

电子邮件并不意味着是传单。它们旨在清晰、简单、简洁地进行交流，同时带来专业的形象。让它看起来像卡通片，或花店，或任何你正在处理的东西可能不会增加它。

您可能会遇到的问题是她将其视为个人原因，因为她出于个人原因而依附于设计，而不是为业务需求而设计。所以对设计的攻击就是对她的攻击。她太沉迷于自己看起来不错，避免看起来不好或想要某种荣耀的自我。

简而言之，**她应该是符合您条件的人，为什么它是好的设计，而不是相反。如果她不知道，她为什么要你证明给她看？她会怎么理解？**

有一本书叫与难相处的人打交道，可能对你有用。

当然，如果常识真的很普遍，我们就不必指出它是常识。

更新我们发生的事情！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T20:26:40.313

[http://www.asciiribbon.org/](http://www.asciiribbon.org/)。

他们有很多关于为什么不在电子邮件中使用 HTML 等的观点。

*   相当多的电子邮件客户端不支持 HTML 电子邮件。
*   其他客户端的 HTML 呈现非常差或损坏，导致消息也无法读取。
*   发送 HTML 电子邮件会导致大量开销，而且效率非常低。
*   仅限于纯文本终端的人、残疾人、盲人，基本上任何不能轻松或根本无法使用图形界面的人，都可能无法阅读您的邮件。

（摘自链接）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T21:01:50.760

除了其他人所说的之外，请考虑法律的可访问性要求。我找到了[美国教育部](http://www.ed.gov/fund/contract/apply/clibrary/software.html)无障碍要求的一个例子。我确信搜索这个可以找到更多示例。

尽管它并不真正适用，但假设您在美国，您也许可以参考《美国残疾人法案》。

此外，由于您发送的是 HTTP 格式的邮件，因此可能对[Web Content Accessibility Guidelines 1.0](http://www.w3.org/TR/WCAG10/)感兴趣。例如，本文档的指南 2.2 指出“确保在由有色差的人观看或在黑白屏幕上观看时，前景色和背景色组合提供足够的对比度。”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T21:16:28.413

只有当这些图形模仿公司固定的外观、模仿公司网站的外观或图形是交互式的时，专业电子邮件才应该是图形密集型的。合理的一个常见示例是来自 Amazon.com 的计费电子邮件。但是请注意，内容本身实际上没有任何图形，只有内容上方、下方和两侧的框架使用图形。类似的东西出现在银行电子邮件和贝宝电子邮件中。这种事情使人们更容易将电子邮件与网站相关联，并制作更好的打印记录，以匹配相同记录的在线版本。

对于标准通信，我只会使用页眉和/或页脚图形。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-19T18:55:51.467

我所做的是将问题升级为一个既有立场又有理解问题重要性的人。此外，还展示了一个设计更简洁的版本。确保解决所有目标，并不意味着设计决策可以讨论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T20:40:18.673

我讨厌上面有设计和图片的电子邮件。这是不专业的IMO

我恨他们。

设计和艺术的可取性/美观性是主观的。所以，你怎么能确定所有收到它们的人都会欣赏它们。

对我来说，它们是一个很大的转折点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T21:17:36.213

还可以考虑在显示可读性研究的人为因素工程文本中查找一些参考资料。我敢打赌，在这方面的快速图书馆搜索会产生很多科学数据，而她的方式会导致阅读错误、眼睛疲劳和/或阅读速度变慢。

# spring - 在不重启 servlet 容器的情况下重新加载/刷新 Spring 配置文件

> ID：534030
> 
> 赞同：41
> 
> 时间：2009-02-10T20:23:03.160
> 
> 标签：spring

如何在不重新启动 servlet 容器的情况下刷新 Spring 配置文件？

我正在寻找 JRebel 以外的解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2017-11-28T19:03:13.687

对于那些最近遇到这个问题的人来说——解决这个问题的当前和现代的方法是使用[Spring Boot 的 Cloud Config](http://projects.spring.io/spring-cloud/spring-cloud.html)。

只需在可刷新的 bean 上添加[@RefreshScope](http://projects.spring.io/spring-cloud/spring-cloud.html#_refresh_scope)注释，在主/配置上添加 @EnableConfigServer[即可。](http://projects.spring.io/spring-cloud/spring-cloud.html#_spring_cloud_config_server)

因此，例如，这个 Controller 类：

```
@RefreshScope
@RestController
class MessageRestController {

    @Value("${message}")
    private String message;

    @RequestMapping("/message")
    String getMessage() {
        return this.message;
    }
} 
```

在 Spring Boot Actuator（通过 HTTP 端点或 JMX）上调用时，将返回端点的`message`String 属性的新值。`/message``refresh`

有关更多实现细节，请参阅官方[Spring Guide for Centralized Configuration示例。](https://spring.io/guides/gs/centralized-configuration/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-01-22T09:24:46.420

好吧，在测试您的应用程序时执行这样的上下文重新加载会很有用。

您可以尝试`refresh`其中一个`AbstractRefreshableApplicationContext`类的方法：它不会刷新您先前实例化的 bean，但对上下文的下一次调用将返回刷新的 bean。

```
import java.io.File;
import java.io.IOException;

import org.apache.commons.io.FileUtils;
import org.springframework.context.support.FileSystemXmlApplicationContext;

public class ReloadSpringContext {

    final static String header = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" +
        "<!DOCTYPE beans PUBLIC \"-//SPRING//DTD BEAN//EN\"\n" +
        " \t\"http://www.springframework.org/dtd/spring-beans.dtd\">\n";

    final static String contextA =
        "<beans><bean id=\"test\" class=\"java.lang.String\">\n" +
            "\t\t<constructor-arg value=\"fromContextA\"/>\n" +
        "</bean></beans>";

    final static String contextB =
        "<beans><bean id=\"test\" class=\"java.lang.String\">\n" +
            "\t\t<constructor-arg value=\"fromContextB\"/>\n" +
        "</bean></beans>";

    public static void main(String[] args) throws IOException {
        //create a single context file
        final File contextFile = File.createTempFile("testSpringContext", ".xml");

        //write the first context into it
        FileUtils.writeStringToFile(contextFile, header + contextA);

        //create a spring context
        FileSystemXmlApplicationContext context = new FileSystemXmlApplicationContext(
            new String[]{contextFile.getPath()}
        );

        //echo the bean 'test' on stdout
        System.out.println(context.getBean("test"));

        //write the second context into it
        FileUtils.writeStringToFile(contextFile, header + contextB);

        //refresh the context
        context.refresh();

        //echo the bean 'test' on stdout
        System.out.println(context.getBean("test"));
    }

} 
```

你得到这个结果

```
fromContextA
fromContextB 
```

实现这一点的另一种方法（也许是更简单的方法）是使用 Spring 2.5+ 的 Refreshable Bean 特性，使用动态语言（groovy 等）和 spring，你甚至可以改变你的 bean 行为。查看动态语言的[spring 参考](http://static.springsource.org/spring/docs/2.5.x/reference/dynamic-language.html)：

> 24.3.1.2。可刷新的豆子
> 
> Spring 中动态语言支持的最引人注目的增值之一（如果不是的话）是“可刷新 bean”特性。
> 
> 可刷新 bean 是动态语言支持的 bean，只需少量配置，动态语言支持的 bean 就可以监控其底层源文件资源的变化，然后在动态语言源文件发生变化时重新加载自己（例如例如，当开发人员编辑并保存对文件系统上文件的更改时）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-10T22:22:50.940

我不建议你这样做。您希望修改配置的单例 bean 会发生什么？您是否希望所有单身人士重新加载？但有些对象可能持有对该单例的引用。

另见这篇文章[Spring 中的自动配置重新初始化](https://stackoverflow.com/questions/461710/automatic-configuration-reinitialization-in-spring)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-30T08:06:43.613

您可以查看此[http://www.wuenschenswert.net/wunschdenken/archives/138](http://www.wuenschenswert.net/wunschdenken/archives/138)，在其中更改属性文件中的任何内容并保存后，bean 将使用新值重新加载。

# c# - C# 托管线程清理

> ID：534037
> 
> 赞同：0
> 
> 时间：2009-02-10T20:25:01.393
> 
> 标签：c#, .net, multithreading

在我的应用程序使用委托创建线程后`ParameterizedThreadStart`，该线程执行一些初始化并运行完成。稍后，我可以观察到该线程不再处于活动状态，因为它的`IsAlive`属性为 false 且`ThreadState`属性为`ThreadState.Stopped`.

一旦线程达到此状态，它们就会保留在我的应用程序中，仍然作为线程对象存在，直到我的应用程序关闭。一旦它们不再活跃，我可以采取任何步骤来处理它们吗？我想删除该对象并取消分配任何资源，以便在任何给定时刻我拥有的唯一线程对象都是活动线程。但是，Thread 没有实现 IDisposable，所以我不确定我应该如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T20:30:57.480

您在代码中保留对线程的引用。

如果您编写了将检查线程状态的代码，那么该代码本质上将使线程对象保持活动状态，直到 GC 收集它。

一旦你完成了一个线程，或者理想情况下如果你不需要访问它，确保你对它的所有引用都清空。Thread 没有实现 IDisposable ，因为正如您已经明确指出的那样，这对线程没有意义。

线程是 .Net 中的原生线程，因此您不必担心泄漏。如果您确定它们会停止，那么一旦您确定它已经完成，就将它们从您的列表中删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T20:32:02.717

听起来您需要放弃对`Thread`对象的引用，以便垃圾收集器可以丢弃它。只需将您必须的引用设置为`null`，并在准备好时让 GC 完成其工作。

根据您的情况，您可能希望使用 a `WeakReference`（或我的朋友 Cyrus' [`WeakReference<T>`](http://blogs.msdn.com/jaybaz_ms/archive/2004/05/07/127700.aspx)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T20:45:07.100

非托管线程是否仍然存在，线程实际上是否从其 ParameterizedThreadStart 方法返回？也尝试使 IsBackground = false

# c++ - 如何在多线程 C++ 中拆除观察者关系？

> ID：534044
> 
> 赞同：11
> 
> 时间：2009-02-10T20:26:43.010
> 
> 标签：c++, multithreading, design-patterns, oop

我有一个提供`Subscribe(Observer*)`给`Unsubscribe(Observer*)`客户的主题。主题在自己的线程中运行（它调用`Notify()`订阅的观察者），互斥体保护其内部观察者列表。

我希望客户端代码（我无法控制）能够在取消订阅后安全地删除观察者。如何做到这一点？

*   由于死锁风险，在通知观察者的同时持有互斥锁 - 甚至是递归互斥锁 - 不是一种选择。
*   我可以在取消订阅调用中将观察者标记为删除，并将其从主题线程中删除。然后客户可以等待特殊的“安全删除”通知。这看起来很安全，但对客户来说很麻烦。

**编辑**

下面是一些说明性代码。问题是如何防止在 Run 处于“Problem here”评论时发生取消订阅。然后我可以回调一个已删除的对象。或者，如果我始终持有互斥锁而不是制作副本，我可以使某些客户端死锁。

```
#include <set>
#include <functional>
#include <boost/thread.hpp>
#include <boost/bind.hpp>

using namespace std;
using namespace boost;

class Observer
{
public:
    void Notify() {}
};

class Subject
{
public:
    Subject() : t(bind(&Subject::Run, this))
    {
    }

    void Subscribe(Observer* o)
    {
        mutex::scoped_lock l(m);
        observers.insert(o);
    }

    void Unsubscribe(Observer* o)
    {
        mutex::scoped_lock l(m);
        observers.erase(o);
    }

    void Run()
    {
        for (;;)
        {
            WaitForSomethingInterestingToHappen();
            set<Observer*> notifyList;
            {
                mutex::scoped_lock l(m);
                notifyList = observers;
            }
            // Problem here
            for_each(notifyList.begin(), notifyList.end(), 
                     mem_fun(&Observer::Notify));
        }
    }

private:
    set<Observer*> observers;
    thread t;
    mutex m;
}; 
```

**编辑**

由于死锁风险，我无法在持有互斥锁时通知观察者。发生这种情况的最明显方式 - 客户端从 Notify 内部调用订阅或取消订阅 - 很容易通过使互斥体递归来解决。更隐蔽的是不同线程上出现间歇性死锁的风险。

我处于多线程环境中，因此在线程执行的任何时候，它通常都会持有一系列锁 L1、L2、... Ln。另一个线程将持有锁 K1, K2, ... Km。正确编写的客户端将确保不同的线程总是以相同的顺序获取锁。但是当客户端与我的主题的互斥体交互时——称之为 X——这个策略将被打破：订阅/取消订阅的调用按 L1、L2、... Ln、X 的顺序获取锁。从我的主题线程调用通知获取锁X, K1, K2, ... Km 的顺序。如果 Li 或 Kj 中的任何一个可以在任何调用路径上重合，则客户端将遭受间歇性死锁，几乎无法对其进行调试。由于我不控制客户端代码，所以我不能这样做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T20:53:13.867

Unsubscribe() 应该是同步的，因此它不会返回，直到 Observer 被保证不再在 Subject 的列表中。这是安全的唯一方法。

ETA（将我的评论移至答案）：

由于时间似乎不是问题，因此在通知每个观察者之间获取并释放互斥锁。您将无法像现在一样使用 for_each，您必须检查迭代器以确保它仍然有效。

```
for ( ... )
{
    take mutex
    check iterator validity
    notify
    release mutex
} 
```

那会做你想做的事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T20:42:14.080

您可以将 Subscribe() 的签名更改为 Unsubscribe() 吗？将 Observer* 替换为 shared_ptr<Observer> 之类的东西会使事情变得更容易。

编辑：用上面的“更容易”替换“容易”。有关这如何难以“正确”的示例，请参阅[Boost.Signals](http://www.boost.org/doc/html/signals.html)和已[采用](http://lists.boost.org/boost-announce/2008/11/0211.php)但尚未在分发中的[Boost.Signals2](http://www.comedi.org/projects/signals2/libs/signals2/doc/html/)（以前称为 Boost.ThreadSafeSignals）库的历史。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T20:47:39.793

嗯......我不太明白你的问题，因为如果客户调用取消订阅你应该能够让客户删除它（你不使用它）。但是，如果由于某种原因您无法在客户端取消订阅观察者后关闭关系，您可以添加“主题”一个新操作以安全地删除观察者，或者只是让客户端表示他们不再对观察者感兴趣.

*重新思考编辑*：好的，现在我想我明白你的问题是什么了。我认为解决您的问题的最佳方法是执行以下操作：

1.  让每个存储的观察者元素都有一个“有效”标志。当您在通知循环中时，此标志将用于通知它与否。
2.  您需要一个互斥锁来保护对该“有效”标志的访问。然后，取消订阅操作为“有效”标志锁定互斥锁，为选定的观察者将其设置为 false。
3.  通知循环还必须锁定和解锁有效标志的互斥体，并且只对“有效”的观察者起作用。

鉴于取消订阅操作将阻塞互斥体以重置有效标志（并且该特定观察者将不再在您的线程中使用），代码是线程安全的，并且客户端可以在取消订阅后立即删除任何观察者回来。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T20:50:31.737

这样的事情会令人满意吗？但是，在收到通知时取消订阅观察者仍然不安全，因为您需要一个像您提到的界面（据我所知）。

```
Subscribe(Observer *x)
{
    mutex.lock();
    // add x to the list
    mutex.unlock();
}

Unsubscribe(Observer *x)
{
    mutex.lock();
    while (!ok_to_delete)
        cond.wait(mutex);
    // remove x from list
    mutex.unlock();
}

NotifyLoop()
{
    while (true) {
        // wait for something to trigger a notify

        mutex.lock();
        ok_to_delete = false;
        // build a list of observers to notify
        mutex.unlock();

        // notify all observers from the list saved earlier

        mutex.lock();
        ok_to_delete = true;
        cond.notify_all();
        mutex.unlock();
    }
} 
```

如果您希望能够在 Notify() 中取消订阅（） - *（客户端 IMO 的错误设计决定......）*您可以将通知线程的线程 ID 添加到您的数据结构中。在 Unsubscribe 函数中，您可以根据当前线程的 id 检查该线程 id（大多数线程库都提供了这个 - 例如 pthread_self）。如果它们相同，则无需等待条件变量即可继续。

注意：如果客户端负责删除观察者，这意味着您会遇到在通知回调内部的情况，您将取消订阅并删除观察者，但仍在使用该指针执行某些操作。这是客户必须注意的事情，并且只能在 Notify() 结束时将其删除。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T20:50:50.893

与其让客户端收到“SafeToDelete”通知，不如为他们提供 IsSubscribed(Observer *) 方法。然后客户端代码变为：

```
subject.Unsubscribe( obsever );l
while( subject.IsSubscribed( observer ) ) {
   sleep_some_short_time;   // OS specific sleep stuff
}
delete observer; 
```

这不是太繁重。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T20:55:45.813

您可以在 CSubject 类型中创建一个“待删除队列”。当你移除 Observer 时，你可以调用 pSubject->QueueForDelete(pObserver)。然后当主题线程在通知之间时，它可以安全地从队列中删除观察者。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-13T07:43:35.657

“理想”的解决方案将涉及使用`shared_ptr`and `weak_ptr`。但是，为了具有通用性，它还必须考虑`Subject`在某些之前被丢弃的问题`Observer`（是的，这也可能发生）。

```
class Subject {
public:
    void Subscribe(std::weak_ptr<Observer> o);
    void Unsubscribe(std::weak_ptr<Observer> o);

private:
    std::mutex mutex;
    std::set< std::weak_ptr<Observer> > observers;
};

class Observer: boost::noncopyable {
public:
    ~Observer();

    void Notify();

private:
    std::mutex;
    std::weak_ptr<Subject> subject;
}; 
```

使用这种结构，我们创建了一个循环图，但明智地使用了 ，`weak_ptr`因此两者`Observer`和`Subject`可以在没有协调的情况下被破坏。

*注意：为简单起见，我假设 an 一次`Observer`观察一个`Subject`对象，但它可以轻松观察多个对象。*

* * *

现在，您似乎陷入了不安全的内存管理中。这是一个相当困难的情况，你可以想象。在这种情况下，我建议做一个实验：*异步`Unsubscribe`*. 或者至少，对`Unsubscribe`外部的调用将是同步的，但是是异步实现的。

思路很简单：我们将使用事件队列来实现同步。那是：

*   调用`Unsubscribe`在队列中发布事件（有效负载`Observer*`）然后等待
*   当`Subject`线程处理完`Unsubscribe`事件后，它会唤醒等待中的线程

您可以使用忙等待或条件变量，除非性能另有规定，否则我建议使用条件变量。

*注意：此解决方案完全无法解释`Subject`过早死亡。*

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T16:34:10.207

如果不是很优雅，我认为这可以解决问题：

```
class Subject {
public:
Subject() : t(bind(&Subject::Run, this)),m_key(0)    {    }
void Subscribe(Observer* o) {
    mutex::scoped_lock l(m);
    InternalObserver io( o );
    boost::shared_ptr<InternalObserver> sp(&io);
    observers.insert(pair<int,boost::shared_ptr<InternalObserver>> (MakeKey(o),sp));
}

void Unsubscribe(Observer* o) {
    mutex::scoped_lock l(m);
    observers.find( MakeKey(o) )->second->exists = false;    }

void WaitForSomethingInterestingToHappen() {}
void Run()
{
    for (;;)
    {
        WaitForSomethingInterestingToHappen();
        for( unsigned int i = 0; i < observers.size(); ++ i )
        {
            mutex::scoped_lock l(m);
            if( observers[i]->exists )
            {
                mem_fun(&Observer::Notify);//needs changing
            }
            else
            {
                observers.erase(i);
                --i;
            }
        }
    }
}
private:

int MakeKey(Observer* o) {
    return ++m_key;//needs changeing, sha of the object?
}
class InternalObserver {
public:
    InternalObserver(Observer* o) : m_o( o ), exists( true ) {}
    Observer* m_o;
    bool exists;
};

map< int, boost::shared_ptr<InternalObserver> > observers;
thread t;
mutex m;
int m_key;
}; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-11T05:20:13.530

更改`observers`为`map`带有键`Observer*`和值的包装器`Observer`。包装器包含一个`volatile`布尔值来指示 是否`Observer`有效。在`subscribe`方法中，包装器对象是在**有效**状态下创建的。在`unsubscribe`方法中，包装器被标记为**invalid**。**在包装器**`Notify`上调用而不是**实际的 Observer**。如果有效（仍然订阅），包装器将调用**实际的观察者******`Notify`****

 ******```
#include <map>
#include <functional>
#include <boost/thread.hpp>
#include <boost/bind.hpp>

using namespace std;
using namespace boost;

class Observer
{
public:
    void Notify() {}
};

class ObserverWrapper : public Observer
{
public:
    Observer* wrappee;
    volatile bool valid;
    ObserverWrapper(Observer* o) 
    {
        wrappee = o;
        valid = true;
    }

    void Notify() 
    {
        if (valid) wrappee->Notify();
    }
}
class Subject
{
public:
    Subject() : t(bind(&Subject::Run, this))
    {
    }

    void Subscribe(Observer* o)
    {
        mutex::scoped_lock l(m);
        boost::shared_ptr<ObserverWrapper> sptr(new ObserverWrapper(o));
        observers.insert(pair<Observer*, sptr));
    }

    void Unsubscribe(Observer* o)
    {
        mutex::scoped_lock l(m);
        observers.find(o)->second->valid = false;
        observers.erase(o);
    }

    void Run()
    {
        for (;;)
        {
            WaitForSomethingInterestingToHappen();
            vector<ObserverWrapper*> notifyList;
            {
                mutex::scoped_lock l(m);
                boost::copy(observers | boost::adaptors::map_values, std::back_inserter(notifyList));
            }
            // Should be no problem here
            for_each(notifyList.begin(), notifyList.end(), 
                     mem_fun(&ObserverWrapper::Notify));
        }
    }

private:
    map<Observer*, ObserverWrapper*> observers;
    thread t;
    mutex m;
}; 
```

# c# - Asp:Label 在 vi sible 设置为 true 时不显示？

> ID：534045
> 
> 赞同：6
> 
> 时间：2009-02-10T20:26:53.993
> 
> 标签：c#, asp.net

我有一个简单的网络表单，其中有几个列表框和一个搜索按钮。单击该按钮时，它会返回一个 DataSet。如果数据集包含记录，我将最初设置为 false 的 asp:label 设置为 true，但这并没有发生。如果数据集有记录并且 visible 属性设置为 true，则标签仍然不显示。

我还尝试将标签和其他几个控件放在 html 表中，并在表上设置 runat="server" 属性并更改其可见性，但它也没有显示。

这是aspx代码：

```
<table>
    <tr>
        <td>
        <asp:Label ID="lblSortBy" runat="server" Text="Sort By:" Visible="false">   
        </asp:Label>
        <asp:DropDownList
                        ID="ddlSortBy" 
                        runat="server" 
                        AutoPostBack="True" 
                        OnSelectedIndexChanged="ddlSortBy_SelectedIndexChanged">
        <asp:ListItem Value="Gross">Gross</asp:ListItem>
        <asp:ListItem Value="Population">Population</asp:ListItem>
        </asp:DropDownList>
        </td>
    </tr>
</table> 
```

这是单击按钮时的简化代码：

```
public void GetData()
{
    DataView dv = GetReportData().DefaultView;

    if(dv.ToTable().Rows.Count > 0)
     {
        lblSortBy.Visible = true;
     }
     else
     {
        lblSortBy.Visible = false;
     }
  } 
```

我在一些 ListBoxes 和一个 GridView 周围有几个更新面板，但不是 Label 和 Dropdown。这会引起问题吗？

我做了一个测试，如果找到记录并且标签消失，我将更新面板中的标签设置为 false，因此如果它在更新面板中，它就可以工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T21:20:33.910

如果我没记错的话，您的标签应该存在于更新面板上，因为就静态 HTML 页面而言，您当前的标签存在的唯一一次，它被设置为不可见。您必须重新加载整个页面才能使其再次可见。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T21:23:55.743

如果按钮位于 UpdatePanel 内，则表、标签等也必须位于 UpdatePanel 内才能更新。否则，单击按钮时只有 UpdatePanel 的内容会更新（这就是所谓的[部分页面渲染](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.aspx)）。

因此，如果按钮位于 UpdatePanel 中，您有两种解决问题的可能性：

1.  put the table, Label, DropDownList etc. into the same UpdatePanel
2.  or put them in another UpdatePanel and set the UpdateMode of that property to Always, so that it gets updated, even if a Postback was initiated by a control within another UpdatePanel.

See [this page in MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.aspx) for details.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T20:35:17.110

*   你只需要标签本身的 runat="server" ；虽然 Visible 应该默认为 True。
*   确保添加前景色以避免将其与背景混合。
*   调试以确保您的标签有内容并且它不在另一个可见 = False 的控件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T20:42:03.973

我假设如果没有数据，你也会隐藏 ddl。您是否尝试过在它们周围放置一个面板并将其可见性设置为 true

如果您要返回行并且您的按钮位于更新面板中，那么您的标签和 ddl 也在该更新面板中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T20:45:05.043

如果表格正在更改可见并且是标签的父容器，我认为根本没有必要更改标签的可见性，因为它应该始终设置为可见。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2014-03-05T07:33:06.580

thanks its really useful, put Lable in a update panel.

```
 <ContentTemplate>
       <table>
           <tr>
                <td>
                     <asp:LinkButton ID="LinkNM" runat="server" Text="Learn>" BackColor="Transparent" style=" color: #6699FF;text-decoration-color:none;border:none;font-size:x-large" OnClick="LinkNM_Click"/>
                    &nbsp;&nbsp;&nbsp;
                                  <asp:Label ID="lblChapterName"  runat="server" BackColor="Transparent" style=" color: #6699FF;text-decoration-color:none;border:none;font-size:x-large" ></asp:Label>

                                </td>
           </tr>
       </table>
             </ContentTemplate>
        <Triggers>
            <asp:PostBackTrigger ControlID="btnFileUpload" />
        </Triggers>

    </asp:UpdatePanel> 
```

# javascript - 当涉及到 JQuery 插件时，您是否有任何安全问题？

> ID：534051
> 
> 赞同：5
> 
> 时间：2009-02-10T20:28:07.283
> 
> 标签：javascript, jquery, jquery-plugins

我很好奇其他开发人员在使用 JQuery 插件方面存在哪些安全问题（如果有的话）。我很少看到有关 JQuery 的安全性的讨论。真的不是问题吗？

欣赏你的想法！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T20:33:44.460

就我个人而言，我对 Javascript 足够熟悉，能够快速浏览插件代码并理解可能的不当行为。

我寻找的是与 javascript、跨域通信最相关的安全问题，这通常是通过创建`iframe`s、`script`/`img`标签等来完成的。

但大多数时候，我信任社区，例如，如果它在[http://plugins.jquery.com/](http://plugins.jquery.com/)上，它通常是受信任的来源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T20:39:23.433

jQuery 不能做任何 javascript 本身不能做的事情，所以所有相同的安全标准都适用。基本上 - 永远不要依赖它来保证安全。始终验证服务器端的所有输入。

考虑它的最佳方式是，从安全角度来看，客户端 javascript 实际上并不是应用程序的一部分。您的应用程序包含对服务器的所有可能的 http 调用。为了获得良好的安全性，假设黑客甚至不会使用浏览器——他们会直接向您的服务器发出 http 请求。确保你没有暴露你的 http 端点中的任何漏洞，你应该没问题。

注意：我在此回复中假设您正在谈论数据和系统安全性。用户安全（防止您的用户被网络钓鱼等）是另一个问题，但我不确定它与 jQuery 的关系是否与一般的 javascript 有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T20:37:06.997

最流行的在主要网站上的整个网络上都使用。如果存在安全问题，其他人可能已经注意到它。此外，许多最常用的 jQuery 插件都来自社区中非常活跃的开发人员，因此信任它们是相当安全的。（想到做验证插件的人 Jörn Zaefferer）

诚然，始终测试并始终持怀疑态度是个好主意，但在某些时候，过度担心会变得成本效率低下。

# asp.net-mvc - 默认 MVC Web 应用程序数据库

> ID：534053
> 
> 赞同：3
> 
> 时间：2009-02-10T20:28:25.143
> 
> 标签：asp.net-mvc, datadirectory

设置新的 ASP.NET MVC Web 应用程序时，Web.Config 中的默认连接字符串如下所示：

connectionString="数据源=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;用户实例=true"

我只是想尝试登录和注册等，但是当我运行应用程序时，它显然找不到 SQL 数据库。我需要设置什么数据库和什么表才能做到这一点？

我的系统上安装了 SQL Server 2005 Standard，够吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T20:37:43.687

SQL Server 2005 绰绰有余。默认连接字符串在 App_Data 文件夹中查找 SQL Server Express 文件。将其替换为以下内容：

```
Data Source=<server name>;Initial Catalog=<database name>;User Id=<user name>;Password=<password>; 
```

如果您想生成 ASP.NET 成员表，则运行 aspnet_regsql.exe，它位于 .NET 2.0 框架文件夹（例如 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727）中。向导将指导您完成整个过程。

# c# - 模型视图演示者，如何在视图之间传递实体？

> ID：534054
> 
> 赞同：8
> 
> 时间：2009-02-10T20:28:38.920
> 
> 标签：c#, winforms, mvp

*编辑：接受 Chris Holmes 的回复，但如果有人想出更好的方法，随时准备重构！谢谢！*

用 MVP 做一些 winforms 什么是将实体传递到另一个视图的最佳方式。

假设我有一个`CustomerSearchView/Presenter`，在 doubleClick 上我想显示`CustomerEditView/Presenter`. 我不想让我的视图知道模型，所以我不能创建一个带有`ICustomer`in 参数的 ctor。

我的反应是，

`CustomerSearchView`创建一个新的`CustomerEditView`，它创建它自己的演示者。然后我`CustomerSearchView`会做类似的事情：

```
var customerEditView = new CustomerEditView();
customerEditView.Presenter.Customer = this.Presenter.SelectedCustomer; 
```

其他可能的方法是一个`CustomerDTO`类，并让一个`CustomerEditView`接受其中的一个`CustomerDTO`，但我认为这是很多简单的工作。

对不起，基本问题，但我能找到的所有例子都没有达到这一点，这是一个棕地项目，到目前为止使用的方法让我头疼......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T23:04:56.687

我不知道你是如何表达你的观点的，所以在这里给你具体的建议有点困难。这就是我以前做过这种事情的方式：

我们所做的是让 CustomerSearchViewPresenter 触发类似 OpenCustomer(customerId) 的事件。（假设您的搜索视图只有几条客户数据，而 customerId 就是其中之一。如果您的搜索视图列出了整个客户对象，那么您可以调用 OpenCustomer(customer)。但我不会构建搜索视图并允许它填充整个对象......我们在数据方面保持我们的搜索视图轻量级。）

应用程序中的其他地方是一个事件处理程序，它侦听 OpenCustomer() 事件并执行创建带有 Presenter 的新 CustomerEditView 的任务（我将推迟到我的 IoC 容器为我做这些事情，所以我不不必在任何地方使用“new”关键字）。创建视图后，我们可以将 id（或客户对象）传递给新的 CustomerEditView，然后显示它。

负责列出 OpenCustomer() 事件并执行 CustomerEditView 创建的此类通常是我们应用程序中的某种控制器类。

为了进一步简化这种情况，我采用了另一种方法：在应用程序或模块启动时创建 CustomerSearchView (&presenter) 和 CustomerEditView (&presenter)。当 CustomerSearchView 需要打开一个 Customer 进行编辑时，CustomerEditView 成为 OpenCustomer 事件的响应者并将数据加载到它自己中，并且知道如何在它应该做的任何容器中显示它自己。

所以有多种方法可以做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T20:39:43.760

怎么样：

```
//In CustomerSearchPresenter
var presenter = new CustomerEditPresenter();
var customerEditView = new CustomerEditView(presenter);
presenter.SetCustomer(customer);

//In CustomerEditPresenter
public void SetCustomer(customer)
{
    View.Name = customer.Name;
    View.Id = customer.Id;
    ...
} 
```

认为您的客户搜索视图应该只委托给它的演示者，您需要执行一个操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-16T23:02:35.753

在任何 MVP 代码中获得自然流程有几个关键的见解：

1.  驱动视图的是演示者，而不是相反。
2.  因为1.视图不需要知道presenter的存在。更少的依赖通常意味着更容易维护。

在 C# 中，我发现在将演示者与视图分离时，事件是一项重要资产。上一个答案中的更多详细信息：[WinForms 中的 Model-View-Presenter](https://stackoverflow.com/questions/4794121/model-view-presenter-in-winforms/4818268#4818268 "WinForms 中的模型视图演示者")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T20:50:42.883

1.  我会看看 MS Prism 4，以及它们漂亮的导航界面。另请查看 Silverlight 和 WCF 导航。他们做得很好，可以处理一些事情，比如提示用户从“脏”表单中确认，并取消。

2.  我也会查看 WCF 中的 PageFunction() 文档，了解如何从另一个页面“调用”页面并获取信息。

这是它的工作原理（javascript，抱歉）：

用户双击客户列表中的客户：

```
CustomerList.onDblClick(customerId){

  app.fireEvent('customerEditRequest', id)

} 
```

...

```
app.onCustomerEditRequest(id){
  this.mainRegion.requestNavigate('customers/edit', id);
} 
```

如果导航到编辑视图成功...

```
CustomerEditView.onNavigatedTo(context){
  this.model.load(context.parameters.id));
}

CustomerEditView.onSaveButtonClick(){
  this.model.save();
  app.fireEvent('customerEdited', id);
} 
```

...

```
app.onCustomerEdited(id){
  app.mainRegion.requestNavigate('customerlist', id);
} 
```

有几种不同的方法可以做到：

1.  从客户列表向编辑表单发送回调函数。编辑表单会调用它，当它被调用时你可以做你想做的事。

2.  在您收听并做出反应的“customerEdited”事件上引发编辑表单（没有应用程序范围的总线）

3.  使用应用程序范围的事件总线集中管理事件，如图所示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T03:26:01.177

我曾经让我的观点与他们的演讲者交流，但已经远离了。它不符合模式的原始定义（这本身并不是偏离只是实现这些好处的一个促成因素的原因）。理想情况下，视图应该保持尽可能低的依赖关系和尽可能少的依赖关系。View 应该通过委托/事件/一些“即发即弃”机制与 Presenter（任何“观察者”）进行通信。事实上，我已经在 MVP 中引入了一个控制器，专门用于拦截 View 事件并重新触发 Presenter（很少）与 Presenter 进行通信，或者与系统或特定于 Presenter 的事件总线进行通信 - 使我能够在不接触视图的情况下更改用户操作警报机制。但是必须小心使用事件总线；很快你就开始在那里抛出所有事件，应用程序在处理事件时变得健谈/陷入困境，并且事件不是 .Net 中最快的事情。同步是一个额外的问题，特别是如果您的应用程序需要与您的用户进行更“对话”的交互。

应该记住，尽管 Presenter 是特定于视图/流程的，但视图（和视图模型）可以被重用；让 View 与 Presenter 处于包含/委托关系中会强烈地耦合 View/限制其重用。这可以通过一些 DI 来减少，但我发现 DI 容器在大多数情况下是不必要的复杂性（因为我必须知道如何创建对象以及在创建/测试后多久将一个对象更改为另一个语义相似的对象？）。除了另一层/增加了更多的模糊性/使事情更难以调试/跟踪之外，具体的依赖性无处可去。不过最近一直处于“简单”状态，并且大多数情况下更喜欢为大多数应用程序进行工厂/对象创建/ORM 映射，因为有一个“一对一”

此外，View 观察 MVP 中的 Model 还是很可行的（就像在 MVC 中一样），所以我不会这么快就排除这种可能性。我不喜欢自己这样做，但它不会“打破”模式。事实上，大约十年前我开发了类似于 MVP 的东西，因为我不喜欢 MVC 组件的“循环循环”（查看了解模型）；我更喜欢所有这些模式（包括 MVC）所声称的视图和模型的更清晰的分离，以及保持视图尽可能愚蠢的愿望（观察模型将意味着视图需要更多的智能来处理模型更改）。我最终做的是类似于 MVVM 和策略模式的东西，我使用模型的“子结构”传递给视图，充当“更改通知器”。

# excel - 如何将单元格的第一个字符与 Excel 中的另一个单元格结合起来？

> ID：534062
> 
> 赞同：32
> 
> 时间：2009-02-10T20:30:21.177
> 
> 标签：excel, excel-formula

我有一个 Excel 表，其中 A 列中的名字和 B 列中的姓氏。我想创建第三个 C 列，其中包含名字中的第一个字符并将其添加到姓氏中，创建*第一个首字母 + 姓氏*。

```
First Name    Last Name    Combined Name
John          Smith        jsmith 
```

如何使用 Excel 做到这一点？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-02-10T20:33:14.867

```
=CONCATENATE(LEFT(A1,1), B1) 
```

假设 A1 拥有第一名；B1 姓氏

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-11T16:21:36.790

我个人喜欢这个 & 功能

假设您为 John Smith 使用单元格 A1 和 A2

```
=left(a1,1) & b1 
```

如果要在之间添加文本，例如句点

```
=left(a1,1) & "." & b1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-01T07:25:55.777

使用以下公式：

```
=CONCATENATE(LOWER(MID(A1,1,1)),LOWER( B1)) 
```

为了

```
Josh Smith = jsmith 
```

请注意，A1 包含姓名，B1 包含姓氏

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-10T22:49:06.860

这是我用来将名字的第一个字母和姓氏的第一个字母从 2 个不同的单元格中获取到一个的公式：

```
=CONCATENATE(LEFT(F10,1),LEFT(G10,1))
Lee Ackerman = LA 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-14T10:55:26.693

不知道为什么没有人使用分号。这对我来说是这样的：

```
=CONCATENATE(LEFT(A1;1); B1) 
```

带逗号的解决方案会在 Excel 中产生错误。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-12-07T14:28:38.857

问题是：假设T john要转换为john T，如何在excel中更改？

如果文本“T john”在单元格 A1 中

```
=CONCATENATE(RIGHT(A1,LEN(A1)-2)," ",LEFT(A1,1)) 
```

并向 & 人群点头

```
=RIGHT(A1,LEN(A1)-2)&" "&LEFT(A1,1) 
```

取字符串的右边部分，不包括前 2 个字符，添加一个空格，添加第一个字符。

# c# - ClickOnce DLL 问题

> ID：534064
> 
> 赞同：0
> 
> 时间：2009-02-10T20:31:24.233
> 
> 标签：c#, clickonce

我在 VS2008 中开发了一些与其他人的应用程序一起部署的 C# 插件库。他们使用 ClickOnce 进行部署，我想我正在尝试做一些非标准的事情。

在安装了应用程序和我的 DLL 的其中一台机器上，我想手动替换我的一些 DLL 以测试修复。

该应用程序位于 c:\Documents and Settings\testsystem\Local Settings\Apps\2.0\blahblahblah...long nasty path\

我的 DLL 位于该路径下的子目录中。

我的测试人员获取了我的 DLL 并将它们放在该子目录中，但从他发送给我的 Trace 输出中可以看出，实际上正在运行旧版本的 DLL。我让测试人员验证 DLL 是否在子目录中，并且 Trace 日志显示正确的路径，表明应用程序正在从该位置运行，但 Trace 输出不是来自我发送给他的 DLL。

在这一点上，ClickOnce 部署的东西对我来说都是精灵魔法。它似乎没有覆盖我的新 DLL，但它肯定没有运行我期望它运行的版本。有人有想法么？

谢谢，马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T22:06:27.157

你确定你有正确的目录吗？click-once 目录结构有点复杂，DLL 可以重复多次。它并不总是从您期望的地方拉取 DLL。如果有人曾经将它们放在那里，它也可能会从 GAC 中提取 DLL。

尝试运行[procexp](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)，查找您的应用程序并检查它持有的句柄。这将告诉您有问题的 DLL 的正确路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T20:34:09.297

在这种情况下，使用跟踪 DLL 发布对 clickonce 应用程序的更新对您来说是不可能的吗？这将是在 clickonce 中施展魔法的最简单方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T20:48:08.933

简单地安装本地构建的版本（不是点击）怎么样。显然，如果您尝试解决权限错误，这对您没有帮助:(。

但是没有什么可以阻止您在本地系统上将代码作为 exe 运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-27T06:14:33.983

戴上奇怪的解决方法，你可以：

*   以不同的名称发布应用程序并让测试人员安装该版本。

必须更改的是应用程序的命名空间，但请同时更新 ClickOnce 应用程序名称，否则您将陷入混乱。

或者

*   发布版本号较低的应用

我不得不说我不是 100% 确定这是否会起作用，但是如果您以较低的数字发布它，您的其他客户端不应该得到更新，但测试人员必须卸载然后安装并获取旧版本。但请注意，您可能希望在测试人员安装测试版本后切换回真实版本，然后测试人员每次启动应用程序时都必须拒绝安装更新。

我肯定会以不同的名称发布，并且您将拥有一个用于所有测试目的的版本。

# tomcat - 加快 Weblogic Server 启动时间

> ID：534066
> 
> 赞同：24
> 
> 时间：2009-02-10T20:32:00.050
> 
> 标签：tomcat, performance, weblogic, application-server

在我的工作中，我们使用 Weblogic Server 来托管企业门户。这很好。

然而，我最近有机会在一些副项目中使用 Tomcat，我对速度上令人难以置信的差异感到震惊。Tomcat 启动需要 3-5 秒，部署一个中型项目需要 10-15 秒。Webblogic 启动需要 3-5*分钟*，部署最多需要 10*分钟。*这会扼杀任何迭代开发。

我是否将不得不接受它的缓慢和臃肿，或者我能做些什么来加快它的速度？有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-10T20:46:58.407

您将无法将青蛙变成公主。我对 weblogic 的那些启动时间有点好奇——它们似乎有点过分，你不是在 linux 上运行吗？

如果您正在运行嵌套存档（耳朵内的战争等）以及目录扫描技术（hibernate、spring 等），您可以尝试在部署之前将其全部解压到相应的分解结构；众所周知，它会有所帮助。

Tomcat 包含 weblogic 的一小部分功能。我们在 jetty 上*开发*，但在 weblogic 上部署以用于验收/生产环境，并且效果很好。你可以用tomcat做同样的事情。

Tomcat 是一个相当严格的容器，而 weblogic 是宽松的，所以通常你在部署到 weblogic 时只会遇到一些小麻烦，特别是只要你不断地做这两个。

您还可以使用[javarebel 之](http://www.zeroturnaround.com/javarebel/)类的工具来进行非常漂亮的热部署并避免所有这些重新启动。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-09-23T08:17:14.580

正如 krosenvold 所说，随机数生成会导致启动缓慢。

Oracle 的建议是使用以下 -D 标志之一 - 仅在非生产系统上使用，因为它会降低安全性。

使用**-Djava.security.egd=file:///dev/urandom**开关或**file:/dev/./urandom**来启动 weblogic 的命令。

以上信息取自[http://download.oracle.com/docs/cd/E12839_01/doc.1111/e14772/weblogic_server_issues.htm#CIHIIBGJ](http://download.oracle.com/docs/cd/E12839_01/doc.1111/e14772/weblogic_server_issues.htm#CIHIIBGJ "12.27.7 随机数生成器在熵不足的机器上可能很慢")

如果 -D 标志不起作用，请查看以下解决方案： [http ://www.itonguard.com/20090313/weblogic-starts-slow/](http://www.itonguard.com/20090313/weblogic-starts-slow/ "Weblogic 启动缓慢")

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T21:03:48.680

您没有提到什么级别和什么平台，但[WebLogic Server 性能和调优指南](http://e-docs.bea.com/wls/docs81/perform/index.html)包含许多可能对您有所帮助的提示和技巧。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-24T12:02:58.840

如果 WebLogic 连接到数据库并且您没有正确设置 DNS，它在 Linux 上的启动也会很慢。

根据您的设置，您可能能够编辑 /etc/resolv.conf 并注释掉 nameserver 行。这可以将 WebLogic 的启动时间从 20 分钟减少到不到一分钟。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-02T13:53:33.060

关于内存消耗问题，您可能想尝试设置 WebLogic 服务器使用的 JVM 的内存参数。登录到您的 WL Web 管理控制台并转到 Environment/Servers/[your server]/Configuration/Server Start，然后在“Arguments”中设置 -Xms256m -Xmx256m 之类的设置将设置 JVM 的初始 (Xms) 和最大值 ( Xmx) 堆大小为 256 兆字节。您将希望使用这些数字并为您的环境找到最佳值。但请注意，您的 Eclipse 实例也可能会消耗大量内存。

关于启动时间，虽然比我预期的要大一些，但它们看起来还不错。这个问题非常频繁，我不认为你一定能解决它。WebLogic 比 Tomcat 有更多的功能，这反映在环境的其他特征（如启动时间）上。

原来 Weblogic 在启动期间使用随机数生成器。由于 java 中的错误，它从 /dev/random 读取“随机性”。/dev/random 是非常好的随机数生成器，但速度极慢。有时需要 10 分钟或更长时间才能生成一个数字。/dev/urandom 不是很好，但它是即时的。Java 以某种方式将 /dev/urandom 文件映射到 /dev/random。这就是 $JAVA_HOME/jre/lib/security/java.security 中的默认设置没有用的原因。

可能的解决方案： 1）在java参数中添加“-Djava.security.egd=file:/dev/./urandom”（/dev/urandom不起作用）。

更糟糕但可行的解决方案是：2） mv /dev/random /dev/random.ORIG ；ln /dev/urandom /dev/random

3）最好的解决方案是改变 $JAVA_HOME/jre/lib/security/java.security 替换securerandom.source

securerandom.source=file:/dev/./urandom

这个问题在 windows 下不会发生，因为它使用 /dev/random 的不同实现。

现在启动 weblogic 服务器需要几秒钟。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-26T01:52:21.640

如果您使用Weblogic Workshop，那么您只需要发布，而不是在进行迭代开发时重新启动应用程序服务器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-04-15T05:12:38.603

正如 Tomas F 和 krosenvold 建议的那样，它可能用于随机数生成器。

***在 Weblogic 12.2.1 的标准启动中，我收到了这条消息：***

```
Disabling the CryptoJ JCE Provider self-integrity check for better startup performance. 
To enable this check, specify -Dweblogic.security.allowCryptoJDefaultJCEVerification=true 
```

所以我指定了它，它把启动时间缩短了一半。在干净的域上大约需要 13 秒。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-09T17:53:53.587

请检查冗长的启动时间实际上是由于 WebLogic Server 启动而不是 WebLogic Portal 启动时间造成的。

# c# - 我应该将 Dispose 逻辑分离到部分类文件中吗？

> ID：534072
> 
> 赞同：2
> 
> 时间：2009-02-10T20:34:29.093
> 
> 标签：c#, refactoring, idisposable, partial-classes

在重构一些 C# 类时，我遇到了实现 IDisposable 的类。

我不假思索地为每个实现 IDisposable 接口的类创建了部分类文件。

例如）对于 Stamper.cs -> Stamper.cs + Stamper.Dispose.cs 其中**Stamper.cs**包含用于标记的实际逻辑，而**Stamper.Dispose.cs**包含处置逻辑

```
// Stamper.cs
public partial class Stamper
{
// actual logic
}

// Stamper.Dispose.cs
public partial class Stamper: IDisposable
{
// Implement IDisposable
} 
```

当我查看代码时，Stamper.cs 现在看起来更加清晰易读（现在大约 52 行而不是 100 行，大约 50 行只是一个清理处置代码）

我在这方面走得太远了吗？

***编辑**：感谢大家的意见 - 我决定将两个文件合二为一。我遇到的问题是我实际上在更新实际逻辑后忘记更新 IDisposable 实现。

此外，在源代码中的方法之间导航没有太大问题。第一个原因似乎不仅仅是在我的具体情况下坚持使用一个文件解决方案的原因。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T20:38:48.927

是的，太远了。只是在代码周围粘贴一个#Region 并将其折叠以使您看不到它有什么问题？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-10T20:41:38.140

它似乎与为构造函数逻辑创建部分类一样任意。现在我必须查看两个文件来了解该类。部分课程只对设计师的东西真正值得......

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-10T20:41:07.080

我更愿意在同一个文件中看到处置逻辑作为保证实现 IDisposable 的资源。虽然存在主观性因素，但我认为这太过分了

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T20:41:52.943

我认为你的解决方案是不合理的。部分类通常应该只用于将开发人员代码与生成器代码分开。区域通常可以更好地为代码添加结构。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T20:39:49.220

如果您的清理程序繁重，这是可以接受的，但并不理想。

对于暴露事件、繁重的序列化方法以及在您的情况下的内存管理等样板来说，这可能是一个好习惯。

我*更喜欢*部分类而不是轮廓（#region）。如果您必须使用部分类或代码大纲来使代码可读，这通常表明代码需要更改。如果代码对于维护该类是绝对必要的，则仅作为最后的手段使用部分类（或区域）。

在您的情况下，您可以使用一个简单地包装非托管资源并公开单个 Dispose 的类。然后在你的另一个类中，使用托管对象并在没有逻辑的情况下处理它。

如果您的类只是一个薄包装，那么我会说您的方法是矫枉过正，因为该类的全部目的是处置非托管资源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T20:45:04.963

有点奇怪的问题，因为它只对开发人员有影响，完全取决于个人喜好。我只能告诉你我更喜欢什么，如果处置部分中有大量逻辑，我会这样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-21T18:44:37.633

就我个人而言，我尝试将我的实例化/初始化逻辑和我的清理/处置逻辑并排保持，这是一个很好的提醒。

至于部分类，我唯一​​使用它们的时候是一个类非常大并且可以分类为方法组。隐藏设计器代码也很棒。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-16T23:44:10.333

当且仅当有问题的代码是计算机生成的时，我倾向于使用部分类。如果您有许多共享相似代码的类（由于各种原因必须重复，而不是被拉到自己的类中），那么拥有一些模板和一个基于此类模板生成代码的程序可能会很有用。在这种情况下，模板将被视为源文件，然后生成文件作为中间对象代码。将模板生成的代码提取到部分类中似乎是完全合适的。

在 vb.net 中，这种方法可能很好地允许在 IDisposable 对象中安全地一起处理字段声明、初始化和清理。需要适量的样板代码，但之后的字段声明非常干净。例如：

```
' 假设选项隐含在：
Dim MyThingie = RegDisposable（新 DisposableThingie）
' 如果未启用隐式：
将 MyThingie 调暗为 DisposableThingie = RegDisposable(New DisposableThingie)

```

RegDisposable 将是一个类成员，它将新的 DisposableThingie 添加到该类持有的列表中。然后类的 Dispose 例程将 Dispose 列表中的所有项目。

不幸的是，在 C# 中没有干净的方法可以做任何类似的事情，因为字段初始化程序无法使用即将构造的对象（在 vb.net 中，字段初始化程序在构造基础对象之后运行）。

# visual-studio-2008 - 带下划线的未解析引用

> ID：534081
> 
> 赞同：3
> 
> 时间：2009-02-10T20:36:43.503
> 
> 标签：visual-studio-2008, fortran

我在 VS2008 中有一个 x64 项目，需要包含一个多年前用 Fortran 编写的旧遗留库。我没有源代码，无法重新编译。.lib 中的函数名称前加下划线，但 x64 项目仅使用不想识别 stdcall 或 cdecl 引用的 fastcall 引用。有什么可以告诉构建识别带有前置下划线的名称吗？

## 编辑

自从我解决了命名问题后，所有的争论点最终告诉我致命错误 LNK1112：模块机器类型 x86 与目标机器类型 x64 冲突，所以无论如何我都无法链接这个旧库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T00:26:28.287

C 链接使用带有前置下划线的名称，因此如果您的实现语言是 C++（是吗？），您应该使用此声明

```
extern "C" {
  int foo();
  float bar();
} 
```

它也应该使用 __cdecl，尽管我不确定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T01:10:00.037

我假设您的旧库是 32 位的。您是否尝试过将项目编译为 x86 而不是 x64 以查看问题是否来自 x64 编译？如果是这样的话，你可以试试这里的东西：

[从 64 位进程调用 32 位代码](https://stackoverflow.com/questions/128445/calling-32bit-code-from-64bit-process)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T09:36:22.677

你肯定需要头文件。如果您仍然有问题，则表示标头中的定义未指定调用约定。

处理链接错误的一般方法：

1.  转储应用程序使用的函数

    垃圾箱/符号

2.  转储库和 dll

    垃圾箱 / 出口 垃圾箱 / 出口

对于静态库

```
dumpbin /symbols <libraryFileName.lib> 
```

3.  在 2 个转储中找到函数名称（3 个用于 dll+import 库）并确保它们相同。

4.  您发现的任何不匹配都将表明您的问题是什么

5.  更改您的调用以得到与导出的内容相同的结果

* * *

解释（部分）结果：

C函数：

```
_functionName = C function, __cdecl calling convention
_functionName@12 = C function, __stdcall calling convention
@functionName@12 = C function, __fastcall calling convention 
```

（当然，数字不一定非得是12）

C++ 函数

它们看起来像 ?functionName@ 即修饰名称。但转储也包含未装饰的。

例子：

```
?functionName@@$$J0YMHHPADPAUKeyVal@@@Z
(extern "C" int __clrcall functionName(int,char *,struct KeyVal *))
=> you have all the info, including the fact that this is compiled to
managed code (__clrcall)

?functionName@@YAHHPADPAUKeyVal@@@Z
(int __cdecl functionName(int,char *,struct KeyVal *))
=> normal C++ function

?functionName@className@@QAEHHPADPAUKeyVal@@@Z
(public: int __thiscall className::functionName(int,char *,struct KeyVal
*))
=> member function (because of __thiscall) of the class className 
```

等等。

* * *

提示：我建议转储到文件中，因为生成的转储可能是大的 dumpbin /exports fileToDump.lib > dumpResult.txt

额外提示：有时在一个转储中你会看到 unsigned short 而在另一个 wchar_t 这意味着编译没有使用 wchar_t 的相同设置（是否为原生类型）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T20:44:49.193

您的 x64 项目使用什么语言？您应该能够在函数的外部定义中指定调用约定：

```
 extern int __stdcall foo(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T02:15:12.673

您在几年前提到了 Fortran，它很有可能是 32 位的。名称修改（前导下划线）是冰山一角，即使你设法解决了这个问题（调用约定问题），你仍然会遇到从 32 位调用 64 位的问题。上面 Ben Robbins 的链接可能会有所帮助。我们有一个类似的问题，我们认为也许我们能够将我们的 32 位 DLL 包装在 COM 包装器中，然后从 64 位调用 COM 包装器。不知道这是否可行，因为我们最终找到了源代码并获得了良好的 64 位编译。

# c++ - 多台机器运行相同的软件，有些无法连接到 firebird

> ID：534088
> 
> 赞同：1
> 
> 时间：2009-02-10T20:39:09.533
> 
> 标签：c++, sql, database, firebird

我很困惑...我有 5 台不同的测试计算机，都是运行类似硬件规格的相对空白的 Windows XP 计算机。我运行 FireBird (Classic) 数据库和我的应用程序的静默安装。有些计算机在数据库位置之前需要“localhost:”（或 127.0.0.1）才能建立连接，而有些计算机根本无法工作！这是全面运行完全相同的软件。是否有人对使连接字符串通用需要发生什么或我可能做错了什么有任何建议？

火鸟版 2.1.1.17910 Classic

顺便说一句，我尝试使用 FlameRobin（一个小型​​数据库管理工具）连接到同一个数据库，它在未连接的计算机上运行良好。

任何需要的信息，请告诉我！非常感谢提前

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T21:36:59.300

对于任何人的未来参考，答案在服务中。显然，由于某种原因，它没有被注册为服务，并且在工作的计算机上，在某个时候被注册了，可能通过某种更早的 Interbase 测试是我最好的猜测。

C:\Windows\System32\drivers\etc 并打开文件“服务”并添加以下行允许服务器正常运行。

gds_db 3050/tcp

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T21:04:37.507

不知道你知不知道，但是数据库名或别名前没有“localhost:”或“127.0.0.1:”的连接字符串会使用本地协议，连接时不能使用到 Firebird Classic Server（有关更多信息，请参阅[此链接](http://www.volny.cz/iprenosil/interbase/connect_string.htm)）。如果给定主机名或 IP 地址，则 TCP 端口 3050 将用于连接。

如果您在 FlameRobin 中注册了服务器，并且没有将注册对话框中的主机名字段留空，那么主机名将成为连接字符串的一部分。这可以解释为什么您可以使用 FlameRobin 进行连接。

至于机器之间的区别：你应该先去火鸟服务器管理器小程序，确保服务器确实在所有机器上运行，并且版本相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T21:06:36.643

它与某些计算机上的主机文件有关吗？或者这就是你所指的

> 有些计算机在数据库位置之前需要“localhost:”（或 127.0.0.1）...

评论？

# exception - 违反业务规则是否应该引发异常？

> ID：534096
> 
> 赞同：19
> 
> 时间：2009-02-10T20:40:22.667
> 
> 标签：exception, exception-handling, rules, business-rules

违反业务规则是否应该引发异常？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T20:42:34.347

不，它是程序中正常条件处理逻辑的一部分（通常只是用户错误的一种伪装形式）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T20:43:06.390

这取决于业务规则是什么，IMO。我会冒昧地说“不经常”，但我会根据具体情况来看待它。我不认为有任何一个答案，因为不同的业务规则可能需要它，而其他规则可能不会。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-11T17:12:43.000

首先，引用[Jeffrey Richter](http://www.wintellect.com/TechnicalBioDetail.aspx?Tech=3)的 Applied Microsoft .NET Framework Programming（第 402 页）的第 18 章：

> “另一个常见的误解是‘异常’标识了‘错误’。”
> 
> “一个例外是违反编程接口的隐含假设。”

如果我从您的问题中正确推断出违反业务规则的数据将超出某个范围（例如），那么您可以使用@ahockley 建议的条件来处理此错误。根据 Richter 对异常的定义，如果您的代码无法从您正在使用的任何存储库中检索业务规则，则适当使用异常。能够检索业务规则将是该接口具有的合理隐含假设，因此如果违反此假设，则应抛出异常。

Richter 的第一句话（异常！= 错误）的一个很好的例子是 ThreadAbortException。如果调用 Response.Redirect(url)（在 ASP.NET 中），即使重定向成功，也会引发 ThreadAbortException。为什么？ASP.NET 页面执行的隐含假设是页面将完全执行。Response.Redirect(url) 违反了这个假设，因此例外。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-10T20:43:37.900

由于我进行验证的方式以及我对 ORM 的 LINQtoSQL 的使用，是的。如果实体在 OnValidate 方法期间未能通过业务规则验证，则通知调用代码的唯一方法是抛出异常。在这种情况下，我抛出了一个自定义 DataValidationException。在实体的部分类实现中使用 OnValidate 方法挂钩使我可以对更新/插入强制执行验证，因此只有有效的数据才会保存到数据库中。

**编辑**我应该明确一点，我通常会在客户端验证用户输入，因此持久层验证通常更保险，并且很少（如果有的话）失败。我不将客户端验证作为异常处理，而是使用条件逻辑处理。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-28T00:45:17.133

否 违反业务规则是业务问题，例外是技术问题。违反业务规则是系统应该将其视为正常操作并且应该有程序响应的事情，而不是例外。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-10T20:43:59.787

你的意思是，例如，一个值应该在 0-99 范围内，但不知何故最终是 105？

如果它来自用户，那就是验证问题。是否使用异常处理取决于您的语言习语。

如果它来自您的数据存储，那么是的，抛出异常似乎是合理的。这意味着你有错误的数据，你需要弄清楚它是如何到达那里的，并防止它再次发生。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-10T23:23:21.993

作为大多数答案的另一种观点......

从业务逻辑中抛出异常可能很有用，特别是如果它们是由验证失败引起的。如果您期待一个对象并且您得到一个空值，则表明某些问题已在用户界面（或其他界面）中规避了检测。此时抛出异常可能是完全有效的。实际上，当有多个接口时，您可能会决定将这种类型的验证放在业务逻辑中。

在某些语言/框架（我认为 .NET）中抛出异常可能代价高昂，但这不应该立即让您担心。顾名思义，这确实意味着它们用于特殊情况，而不是作为程序标准流程的一部分。你当然不应该仅仅为了退出一个方法就抛出一个异常。您还应该尽可能考虑优雅的恢复，其中可能不包括引发异常。

所以，总结一下......这取决于......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T22:37:17.470

我通常会说不是，但我认为你不能说从不。

例如，它取决于谁/什么正在处理失败的规则。如果它是用户界面/用户，那么我将使用条件逻辑来适当地处理故障。但是，如果它是业务规则失败，例如，将任何错误记录到将由技术资源监控的事件日志的不露面流程中，则异常可能是适当的。在后一种情况下，适当命名的异常可能与格式良好的消息一样有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-13T11:30:55.253

业务规则不应抛出异常，除非它们用于验证某些 API 的参数（即：检查请求有效性）或用于单元测试（即：[使用业务规则来简化 .NET 单元测试](http://abdullin.com/journal/2009/2/13/using-lokad-rules-to-simplify-net-unit-tests.html)）。

不过，通常业务规则会向验证范围输出错误和警告消息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-10T21:11:34.947

通常我将条件放在实现的规范对象中

```
bool IsVerfiedBy(T entity); 
```

因此，您可以毫无例外地检查条件。

如果您的代码中有一个地方应该事先验证规范，您可以抛出异常，因为这是您的功能的先决条件。

例如，如果您的实体在持久化之前必须处于特定状态，则在未验证规范时抛出异常，但在持久化之前使用规范，以便不会发生异常。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-10T20:44:36.417

抛出异常可能是计算密集型的，它们超出了规范。例如，在 .net 中，您有递增的性能计数器 - 这是一个重量级的活动，因此不是您想要做的事情，而不是简单的条件。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-10T20:49:49.897

这实际上取决于它是什么以及它在哪里。

如果是来自用户的一些数据，那么正如 levand 所说，这是一个验证问题。验证可以成功也可以失败，两者都是具有明确进一步行动方案的预期选项。

如果它类似于方法执行错误，最好在造成更多伤害之前抛出异常并停止（例如在数据库中产生不一致）。

这通常是一个观点和您的应用程序设计的问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-09-25T07:59:38.027

业务规则可以抛出异常，但它们不应该。

如果您有另一种方式来传达有关常见和可预测的验证错误的信息，您应该使用它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-03-03T11:33:47.857

[wiki 中](http://programmer.97things.oreilly.com/wiki/index.php/97_Things_Every_Programmer_Should_Know) 有很好的指导，这本书是*每个项目经理都应该知道的 97 件事，特别是在*[区分业务异常和技术](http://programmer.97things.oreilly.com/wiki/index.php/Distinguish_Business_Exceptions_from_Technical)的章节中。

因此，如果您的编程语言支持它，最好的办法是创建自定义异常类，以便它们的工作流程和处理可以不同于技术异常。

# ms-access - 文件夹更改时在同一文件夹中保留 Access DB 的链接表

> ID：534102
> 
> 赞同：8
> 
> 时间：2009-02-10T20:41:26.050
> 
> 标签：ms-access, hyperlink, linked-tables

我有两个共享链接表的 Access 数据库。它们一起部署在一个目录中，并通过 Word 形式的代码进行访问。

当两个数据库被复制（一起）到不同的文件夹时，如何确保保留链接？由于我没有“打开”数据库本身（通过 ADO 访问它），我不知道如何编写代码来刷新链接。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-14T03:26:36.797

**更新 14APR2009** 我发现我之前在这里给出的答案是错误的，所以我用新代码更新了它。

**如何进行**

*   将下面的代码复制到 VBA 模块。
*   从代码或VBA IDE的*即时窗口中，只需键入：*

    ```
    RefreshLinksToPath Application.CurrentProject.Path 
    ```

现在，这将重新链接所有链接表以使用您的应用程序所在的目录。
它只需要执行一次，或者在您重新链接或添加新表时执行。
我建议您每次启动应用程序时从代码中执行此操作。
然后，您可以毫无问题地移动您的数据库。

**代码**

```
'------------------------------------------------------------'
' Reconnect all linked tables using the given path.          '
' This only needs to be done once after the physical backend '
' has been moved to another location to correctly link to    '
' the moved tables again.                                    '
' If the OnlyForTablesMatching parameter is given, then      '
' each table name is tested against the LIKE operator for a  '
' possible match to this parameter.                          '
' Only matching tables would be changed.                     '
' For instance:                                              '
' RefreshLinksToPath(CurrentProject.Path, "local*")          '
' Would force all tables whose ane starts with 'local' to be '
' relinked to the current application directory.             '
'------------------------------------------------------------'
Public Function RefreshLinksToPath(strNewPath As String, _
    Optional OnlyForTablesMatching As String = "*") As Boolean

    Dim collTbls As New Collection
    Dim i As Integer
    Dim strDBPath As String
    Dim strTbl As String
    Dim strMsg As String
    Dim strDBName As String
    Dim strcon As String
    Dim dbCurr As DAO.Database
    Dim dbLink As DAO.Database
    Dim tdf As TableDef

    Set dbCurr = CurrentDb

    On Local Error GoTo fRefreshLinks_Err

    'First get all linked tables in a collection'
    dbCurr.TableDefs.Refresh
    For Each tdf In dbCurr.TableDefs
        With tdf
            If ((.Attributes And TableDefAttributeEnum.dbAttachedTable) = TableDefAttributeEnum.dbAttachedTable) _
               And (.Name Like OnlyForTablesMatching) Then
                collTbls.Add Item:=.Name & .Connect, key:=.Name
            End If
        End With
    Next
    Set tdf = Nothing

    ' Now link all of them'
    For i = collTbls.count To 1 Step -1
        strcon = collTbls(i)
        ' Get the original name of the linked table '
        strDBPath = Right(strcon, Len(strcon) - (InStr(1, strcon, "DATABASE=") + 8))
        ' Get table name from connection string '
        strTbl = Left$(strcon, InStr(1, strcon, ";") - 1)
        ' Get the name of the linked database '
        strDBName = Right(strDBPath, Len(strDBPath) - InStrRev(strDBPath, "\"))

        ' Reconstruct the full database path with the given path '
        strDBPath = strNewPath & "\" & strDBName

        ' Reconnect '
        Set tdf = dbCurr.TableDefs(strTbl)
        With tdf
            .Connect = ";Database=" & strDBPath
            .RefreshLink
            collTbls.Remove (.Name)
        End With
    Next
    RefreshLinksToPath = True

fRefreshLinks_End:
    Set collTbls = Nothing
    Set tdf = Nothing
    Set dbLink = Nothing
    Set dbCurr = Nothing
    Exit Function

fRefreshLinks_Err:
    RefreshLinksToPath = False
    Select Case Err
        Case 3059:

        Case Else:
            strMsg = "Error Information..." & vbCrLf & vbCrLf
            strMsg = strMsg & "Function: fRefreshLinks" & vbCrLf
            strMsg = strMsg & "Description: " & Err.Description & vbCrLf
            strMsg = strMsg & "Error #: " & Format$(Err.Number) & vbCrLf
            MsgBox strMsg
            Resume fRefreshLinks_End
    End Select
End Function 
```

此代码改编自以下来源：[http](http://www.mvps.org/access/tables/tbl0009.htm) ://www.mvps.org/access/tables/tbl0009.htm 。
我删除了对其他函数的所有依赖以使其独立，这就是为什么它比它应该的要长一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T21:20:16.267

您是指更新 Word 表单中的链接，还是 Access 数据库之间的链接表链接？

对于前者，我知道的最好方法是将连接字符串保持在 Word 文档/VBA 项目中的模块级别，并将它们设为 const 字符串。然后在为 ADO Connection 对象设置连接字符串时，将相对连接字符串 const 传递给它。

对于后者，我很想在连接字符串中使用相对路径来连接每个 Access 数据库中的数据。例如，

```
Dim connectionString as String

connectionString = ";DATABASE=" & CurrentProject.Path & "\[Database Name Here].mdb" 
```

如果如您所说，将数据库一起复制到不同的文件夹（我*假设*在同一个文件夹中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-23T14:04:46.240

Renaud 的答案不再适用于带有 Excel 或 CSV 文件的 Access 2010。

我做了一些修改：

*   适应连接字符串的当前模式
*   以不同方式处理 Excel 文件（包括文件名）和 CSV 文件（不包括文件名）的数据库路径

这是代码：

```
Public Function RefreshLinksToPath(strNewPath As String, _
Optional OnlyForTablesMatching As String = "*") As Boolean

Dim collTbls As New Collection
Dim i As Integer
Dim strDBPath As String
Dim strTbl As String
Dim strMsg As String
Dim strDBName As String
Dim strcon As String
Dim dbCurr As DAO.Database
Dim dbLink As DAO.Database
Dim tdf As TableDef

Set dbCurr = CurrentDb

On Local Error GoTo fRefreshLinks_Err

'First get all linked tables in a collection'
dbCurr.TableDefs.Refresh
For Each tdf In dbCurr.TableDefs
    With tdf
        If ((.Attributes And TableDefAttributeEnum.dbAttachedTable) = _
           TableDefAttributeEnum.dbAttachedTable) _
           And (.Name Like OnlyForTablesMatching) Then
            Debug.Print "Name: " & .Name
            Debug.Print "Connect: " & .Connect
            collTbls.Add Item:=.Name & ";" & .Connect, Key:=.Name
        End If
    End With
Next
Set tdf = Nothing

' Now link all of them'
For i = collTbls.Count To 1 Step -1
    strConnRaw = collTbls(i)
    ' Get table name from the full connection string
    strTbl = Left$(strConnRaw, InStr(1, strConnRaw, ";") - 1)
    ' Get original database path
    strDBPath = Right(strConnRaw, Len(strConnRaw) - (InStr(1, strConnRaw, "DATABASE=") + 8))
    ' Get the name of the linked database
    strDBName = Right(strDBPath, Len(strDBPath) - InStrRev(strDBPath, "\"))
    ' Get remainder of connection string
    strConn = Mid(strConnRaw, InStr(1, strConnRaw, ";") + 1, InStr(1, strConnRaw, "DATABASE=") _
                - InStr(1, strConnRaw, ";") - 1)

    ' Reconstruct the full database path with the given path
    ' CSV-Files are not linked with their name!
    If Left(strConn, 4) = "Text" Then
        strDBPath = strNewPath
    Else
        strDBPath = strNewPath & "\" & strDBName
    End If

    ' Reconnect '
    Set tdf = dbCurr.TableDefs(strTbl)
    With tdf
        .Connect = strConn & "Database=" & strDBPath
        .RefreshLink
        collTbls.Remove (.Name)
    End With
Next
RefreshLinksToPath = True

fRefreshLinks_End:
    Set collTbls = Nothing
    Set tdf = Nothing
    Set dbLink = Nothing
    Set dbCurr = Nothing
    Exit Function

fRefreshLinks_Err:
    RefreshLinksToPath = False
    Select Case Err
        Case 3059:

        Case Else:
            strMsg = "Error Information..." & vbCrLf & vbCrLf
            strMsg = strMsg & "Function: fRefreshLinks" & vbCrLf
            strMsg = strMsg & "Description: " & Err.Description & vbCrLf
            strMsg = strMsg & "Error #: " & Format$(Err.Number) & vbCrLf
            MsgBox strMsg
            Resume fRefreshLinks_End
    End Select
End Function 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-20T20:43:37.210

不幸的是，我仍在使用 Access 2007。我从上面不适合我的代码块之一开始。由于访问 vba 功能较少，我将其简化为仅第一个循环，该循环获取表路径并将其更新到位。遇到此问题的下一个人可以发表评论或更新。

选项比较数据库

```
'------------------------------------------------------------'
' Reconnect all linked tables using the given path.          '
' This only needs to be done once after the physical backend '
' has been moved to another location to correctly link to    '
' the moved tables again.                                    '
' If the OnlyForTablesMatching parameter is given, then      '
' each table name is tested against the LIKE operator for a  '
' possible match to this parameter.                          '
' Only matching tables would be changed.                     '
' For instance:                                              '
' RefreshLinksToPath(CurrentProject.Path, "local*")          '
' Would force all tables whose ane starts with 'local' to be '
' relinked to the current application directory.             '
'
' Immediate window type
' RefreshLinksToPath Application.CurrentProject.Path

'------------------------------------------------------------'
Public Function RefreshLinksToPath(strNewPath As String, _
    Optional OnlyForTablesMatching As String = "*") As Boolean

    Dim strDBPath As String
    'Dim strTbl As String
    'Dim strMsg As String
    Dim strDBName As String
    Dim dbCurr As DAO.Database
    Dim dbLink As DAO.Database
    Dim tdf As TableDef

    Set dbCurr = CurrentDb
    Dim strConn As String
    Dim strNewDbConn1 As String
    Dim strNewDbConn2 As String
    Dim strNewDbConn  As String

    '  On Local Error GoTo fRefreshLinks_Err

    'First get all linked tables in a collection'
    dbCurr.TableDefs.Refresh
    For Each tdf In dbCurr.TableDefs
        With tdf
            If ((.Attributes And TableDefAttributeEnum.dbAttachedTable) = TableDefAttributeEnum.dbAttachedTable) _
               And (.Name Like OnlyForTablesMatching) Then

                strConn = tdf.Connect
                strDBPath = Right(strConn, Len(strConn) - (InStr(1, strConn, "DATABASE=") + 8))
                strDBName = Right(strDBPath, Len(strDBPath) - InStrRev(strDBPath, "\"))
                Debug.Print ("===========================")
                Debug.Print (" connect is " + strConn)
                Debug.Print (" DB PAth is " + strDBPath)
                Debug.Print (" DB Name is " + strDBName)

                strDBNewPath = strNewPath & "\" & strDBName
                Debug.Print (" DB NewPath is " + strDBNewPath)

                strNewDbConn1 = Left(strConn, (InStr(1, strConn, "DATABASE=") - 1))
                strNewDbConn2 = "DATABASE=" & strDBNewPath
                strNewDbConn = strNewDbConn1 & strNewDbConn2
                Debug.Print (" DB strNewDbConn is " + strNewDbConn)

                'Change the connect path
                tdf.Connect = strNewDbConn
                tdf.RefreshLink
            End If
        End With
    Next
End Function 
```

# svn - 半可编辑文件（例如配置文件）和版本控制 - 最佳实践？

> ID：534119
> 
> 赞同：5
> 
> 时间：2009-02-10T20:43:55.263
> 
> 标签：svn, version-control, cvs

所以，我今天通过签入配置文件来终止构建。它知道服务器在哪里（想想 SQL 服务器等），而且我一直在针对在我的机器上运行的服务器工作。通常，或者更确切地说，在其他情况下，我们会针对中央服务器运行。当然，日常构建没有找到“我的”服务器，因此损坏了。再说一次，在签入之前编辑配置文件以指向“正常”服务器，并在签入后再次编辑它是有倾向性的。

我一直想让 VC 忽略配置文件，这样它就不会被意外签入。另一方面，存储库应该包含一个干净、可用的文件版本。我不可能忽略它并同时检查它，现在，可以吗？

因此，我正在寻找一种方法来获得一个文件，该文件 errr 签出但从不签入。至少在最常见的情况下 - 如果配置文件发生重大变化，一些特殊的程序来获取新版本进入存储库是可行的。

如果你们以前遇到过这个问题，我会对你们找到的任何解决方案感兴趣。只要他们不破坏构建，那就是;)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T21:19:55.880

您可以做的是拥有一个保持不变的默认配置文件，除非添加了一些新配置。然后你有一个不同的文件覆盖默认文件的配置。

```
config.Default.xml
config.User.xml 
```

只有 config.Default.xml 受源代码控制。config.User.xml 仅包含对您不同的配置。因此，假设您在本地 SQL 服务器上进行测试，您只将连接字符串放在那里，它将覆盖 config.Default 连接字符串。

看看 .Net Framwork Application Configuration，它为您完成了大部分（如果不是全部）工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T20:47:52.227

我使用的一种方法是拥有两个版本的配置文件，并让安装程序脚本提取正确的版本。

*   设置.xml
*   settings.xml-发布

这两个文件包含相同的键，但一个包含“开发”值，另一个包含我们希望在该字段中部署和编辑的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T20:55:42.490

我们有

*   *.（配置 | xml）
*   *.(config | xml).cert
*   *.(config | xml).production

Hudson 删除初始文件并为正确的环境部署正确的文件（当前只有证书）。

这允许开发人员独立记录和开发生产、证书和开发级别的配置文件，并在 SVN 中分别对它们进行版本控制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T20:53:54.817

我们将这些文件存储在我们的源代码控制系统中，并为我们正在构建的环境提供不同的文件夹。

所以我们有：

```
Dev
Test
Live 
```

这些下有用于其他环境特定文件的子文件夹。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T21:32:23.723

我认为接受的答案很好，但根据您的要求，它可能有局限性。

我们使用以下方法。请注意，我们是使用 VS 并使用 MSBuild（内置、社区和自定义）任务的 .NET 商店。

*   *App.config*被版本控制忽略，但包含在项目中。
*   *App.default.config*受版本控制，也包含在项目中。我们没有硬编码可以改变的东西，例如数据库连接字符串，而是使用令牌。

项目的 BeforeBuild 任务查找*App.config*的存在，如果没有找到，*则将 App.default.config*复制到*App.config*。*此外，如果App.config*存在于 CI 构建中，构建服务器始终会删除它（确保干净的配置）。然后，我们还使用 MSBuild Community FileUpdate 任务根据正在构建项目的任何内容将令牌替换为适当的值。

例如，新的开发人员结帐可以为本地数据库设置数据库连接字符串，每晚构建可以为每晚数据库设置等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T20:52:40.127

如果我工作，我们有单独的配置文件用于部署。所以我们解决方案中的配置文件是开发版本，人们可以将它们更改为他们想要的内容。这些配置文件永远不会部署在任何地方。

部署的配置文件存储在我们的源代码控制提供程序的单独位置。如果有人需要对将要部署的配置进行更改，他们必须改为修改此版本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-11T00:08:09.840

接受的答案很好。但是，可以做您想做的事情（4 年前），并且只维护一个检出但从不检入的配置文件——如果您的版本控制系统具有更改列表的概念。我在 Perforce 中做到了这一点：

查看配置文件并将其保存在自己的更改列表中。提交时，仅提交其他更改列表；如果您将配置文件更改列表命名为“请勿提交”之类的名称，这很容易记住。

该系统的一个优点是，如果其他人更改了配置文件的生产版本——即存在于服务器上的配置文件，并且每个人都在维护其修改的本地版本——那么您将在以下情况下收到可能的冲突通知您从服务器获取配置文件。使用已接受答案中建议的解决方案，您可能会继续使用本地设置默默地覆盖新的生产设置，这可能会破坏您的本地构建或导致您在下次提交时中断构建。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-10T21:43:08.040

对于每个配置文件 x，创建一个名为 x.dist 的文件供您签入，这是默认的分布式配置。开发人员签出后，有一个脚本将每个 x.dist 文件复制到 x，在那里他们可以根据需要自定义 x。可以重新运行此脚本以在重大更改后更新文件，或者开发人员可以手动合并他们的更改。

对于部署，您可以签入您的实时部署文件并让您的启动脚本明确引用它们（例如--config x.production）。

例如，这种方法用于[Wordpress](http://codex.wordpress.org/Installing_WordPress#Famous_5-Minute_Install)的分发方式（您必须复制模板 wp-config.php 文件）或使用 autoconf 的开发项目（其中 configure.ac 已签入，但配置文件必须由每个开发人员；在发布时构建了一个特殊的配置文件以在 tarball 中分发）。

# php - 如何安全地允许嵌入内容？

> ID：534121
> 
> 赞同：2
> 
> 时间：2009-02-10T20:43:58.320
> 
> 标签：php, javascript, html, web

我经营自己编写的网站（有点像社交网络）。我允许成员互相发送评论。在评论中；我接受评论，然后在将其保存到数据库之前调用此行。

```
$com = htmlentities($com); 
```

当我想显示它时；我称这段代码..

```
$com = html_entity_decode($com); 
```

这在大多数情况下都很有效。它允许用户复制/粘贴 youtube/imeem 嵌入代码并互相发送视频和歌曲。它还允许他们将图像上传到 photobucket 并复制/粘贴嵌入代码以发送图片评论。

我遇到的问题是，有些人基本上也在那里放入了 javascript 代码，这些代码往往会做一些讨厌的事情，例如打开警报框、更改网页的位置等等。我正在尝试找到一个好的解决方案来解决这个问题一劳永逸。其他网站如何允许这种功能？

感谢您的反馈意见

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T21:46:54.597

第一：[`htmlentities`](http://www.php.net/htmlentities)或者只是[`htmlspecialchars`](http://www.php.net/htmlspecialchars)应该用于转义嵌入到 HTML 中的字符串。当您将它们插入 SQL 查询时，您不应该使用它来转义字符串 - 使用[`mysql_real_escape_string`](http://www.php.net/mysql_real_escape_string)(For MySql) 或更好的是 - 使用具有绑定参数的[准备好的语句。](http://www.php.net/pdo-prepare)当您手动转义字符串时，请确保`magic_quotes`以其他方式关闭或禁用它。

第二：当你再次拉出它们时，你不会松开它们。例如。没有`mysql_real_unescape_string`。而且你也不应该使用`stripslashes`——如果你发现你需要，那么你可能打开了magic_quotes——而是将它们关闭，并在继续之前修复数据库中的数据。

第三：您正在做的事情`html_entity_decode`完全使`htmlentities`. 现在，您绝对无法防止恶意用户将代码注入您的站点（您很容易受到跨站点脚本的攻击。XSS）。嵌入到 HTML 上下文中的字符串应使用[`htmlspecialchars`](http://www.php.net/htmlspecialchars)(或`htmlentities`) 进行转义。如果您绝对*必须*将 HTML 嵌入到您的页面中，则必须首先通过清理解决方案运行它。[`strip_tags`](http://www.php.net/strip_tags)这样做 - 在理论上 - 但在实践中它是非常不充分的。我目前知道的最好的解决方案是[HtmlPurifier](http://htmlpurifier.org/)。但是，无论您做什么，让随机用户将代码嵌入您的站点总是有风险的。如果可能，请尝试将您的应用程序设计为不需要它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T20:47:29.950

我非常希望您在将数据发送到数据库之前对其进行清理。听起来您是[SQL 注入](https://web.archive.org/web/1/http://downloads.techrepublic%2ecom%2ecom/abstract.aspx?kw=sql%20injection&docid=173540)攻击的主要目标。我知道这不是你的问题，但这是你需要注意的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T20:47:12.243

是的，这是一个问题。许多网站只允许在用户字段中使用自己的自定义标记来解决这个问题。

但是如果你真的想允许 HTML，你需要清除所有的“脚本”标签。我相信有可用的图书馆可以做到这一点。但这应该足以防止 JS 在用户输入的代码中执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T20:49:31.630

[我认为，这就是](http://refactormycode.com/codes/333-sanitize-html)Stackoverflow 在[RefacterMyCode](http://refactormycode.com/codes/333-sanitize-html)上的做法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T20:50:59.427

您可能需要考虑[Zend Filter](http://framework.zend.com/manual/en/zend.filter.html)，它提供的不仅仅是 strip_tags ，而且您不必包含整个 Zend 框架即可使用它。

# jquery - ASP.NET MVC。使用 Ajax 更新用户控件（购物车）

> ID：534142
> 
> 赞同：1
> 
> 时间：2009-02-10T20:48:16.343
> 
> 标签：jquery, asp.net-mvc, user-controls, shopping-cart, partials

我想实现一个用户控件，它表示用户购物车中当前项目的列表，并且包含在母版页中。

我想将产品添加到购物车；当用户将产品添加到他或她的购物车时，购物车应该使用异步调用（JavaScript 框架是 jQuery）自动更新，反之亦然，内容应该可以从购物车中移除。

我有它静态实现，会话内容（订单，产品）存储在数据库中。

我有一个 ProductsController 和一个 OrderController（购物车基本上是一个带有指定产品和用户 ID 或临时会话 ID 的订单）。

对于所有不同的预览版、Beta 版和 RC，以及缺乏 ASP.NET MVC 的集中文档，我发现很难找到关于这个主题的适当文档。

谁能指点我一些入门教程？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T21:53:08.450

如果我理解正确的问题，您希望能够调用一个控制器，该控制器调用模型中的一些业务逻辑来更新购物车。如果这是正确的，您想创建一个 JsonResult 控制器操作。您将使用 jQuery 来调用此操作...我在[http://www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/上写了一个非常简单的示例](http://www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T22:29:22.653

我在目前正在处理的应用程序中所做的，在购物车控制器（将其命名为 getAjaxCart 或其他明显的名称）中执行一个操作，该操作返回一个包含价格等项目列表的部分视图，并将其放入您为购物车分配的 div。查看[http://docs.jquery.com/Ajax/jQuery.ajax](http://docs.jquery.com/Ajax/jQuery.ajax)上的 jquery 文档。

然后，您可以在 javascript 调用的成功部分使用 $('#shopcart').html(result) 。

# jsp - JSP 2.0 中的延迟 EL

> ID：534150
> 
> 赞同：1
> 
> 时间：2009-02-10T20:50:15.810
> 
> 标签：jsp, el

有没有办法在 JSP 2.0 / J2EE 1.4 中使用类似延迟 EL 的东西？这个想法是将测试传递给标记文件，并让它根据表达式的值显示（或不显示）列表中的项目。基本上，我想做这样的事情：

JSP：

```
<x:myTag items="${myCollection}" test="${item.visible}"/> 
```

myTag.tag

```
<c:forEach var="item" items="${collection}">
    <c:if test="${test}">
        ${item}
    </c:if>
</c:forEach> 
```

升级我们的 JSP 容器不是一种选择。有任何想法吗？

**更新：**

我尝试对 JSP 片段执行此操作，但片段中的 EL 在 JSP 中被评估一次，而不是在标记中每次迭代一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T21:01:44.767

您应该能够使用[jsp 片段](http://java.sun.com/javaee/5/docs/tutorial/doc/bnaln.html#bnalq)来做到这一点。我相信这不是您会喜欢的极其优雅的解决方案，但它确实允许将表达式的执行推迟到标签内。

编辑：您可以使用“name-given”设置检查[变量。](http://java.sun.com/javaee/5/docs/tutorial/doc/bnamu.html#bnank)

（我会欣然承认，大约 2 年前我做*了*类似你想做的事情。从那以后我就没有碰过它。我记得我觉得它很神秘）

# php - 从 PHP 中的变量实例化一个类？

> ID：534159
> 
> 赞同：162
> 
> 时间：2009-02-10T20:52:31.997
> 
> 标签：php, class, variables, eval

我知道这个问题听起来很模糊，所以我将通过一个例子更清楚地说明：

```
$var = 'bar';
$bar = new {$var}Class('var for __construct()'); //$bar = new barClass('var for __construct()'); 
```

这就是我想做的。你会怎么做？我当然可以像这样使用 eval() ：

```
$var = 'bar';
eval('$bar = new '.$var.'Class(\'var for __construct()\');'); 
```

但我宁愿远离 eval()。没有 eval() 有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：238
> 
> 时间：2009-02-10T20:53:52.213

首先将类名放入变量中：

```
$classname=$var.'Class';

$bar=new $classname("xyz"); 
```

这通常是您在工厂模式中看到的那种东西。

有关详细信息，请参阅[命名空间和动态语言功能](http://php.net/manual/en/language.namespaces.dynamic.php)。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2015-06-04T15:13:26.613

# 如果您使用命名空间

在我自己的发现中，我认为值得一提的是您（据我所知）必须声明一个类的完整命名空间路径。

MyClass.php

```
namespace com\company\lib;
class MyClass {
} 
```

索引.php

```
namespace com\company\lib;

//Works fine
$i = new MyClass();

$cname = 'MyClass';

//Errors
//$i = new $cname;

//Works fine
$cname = "com\\company\\lib\\".$cname;
$i = new $cname; 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2012-03-13T14:01:39.920

## 如何也传递动态构造函数参数

如果要将动态构造函数参数传递给类，可以使用以下代码：

```
$reflectionClass = new ReflectionClass($className);

$module = $reflectionClass->newInstanceArgs($arrayOfConstructorParameters); 
```

[有关动态类和参数的更多信息](http://rabaix.net/en/articles/2009/02/06/how-to-instantiate-a-php-class-with-dynamic-parameters)

### PHP >= 5.6

从 PHP 5.6 开始，您可以使用[Argument Unpacking](http://php.net/manual/en/migration56.new-features.php#migration56.new-features.splat)进一步简化这一点：

```
// The "..." is part of the language and indicates an argument array to unpack.
$module = new $className(...$arrayOfConstructorParameters); 
```

感谢 DisgruntledGoat 指出这一点。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-02-10T20:56:07.840

```
class Test {
    public function yo() {
        return 'yoes';
    }
}

$var = 'Test';

$obj = new $var();
echo $obj->yo(); //yoes 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-12-08T23:38:25.157

我会推荐`call_user_func()`or `call_user_func_array`php 方法。你可以在这里查看它们（[call_user_func_array](http://php.net/manual/en/function.call-user-func-array.php)，[call_user_func](http://php.net/manual/en/function.call-user-func.php)）。

例子

```
class Foo {
static public function test() {
    print "Hello world!\n";
}
}

 call_user_func('Foo::test');//FOO is the class, test is the method both separated by ::
 //or
 call_user_func(array('Foo', 'test'));//alternatively you can pass the class and method as an array 
```

如果您有要传递给方法的参数，请使用该`call_user_func_array()`函数。

例子。

```
class foo {
function bar($arg, $arg2) {
    echo __METHOD__, " got $arg and $arg2\n";
}
}

// Call the $foo->bar() method with 2 arguments
call_user_func_array(array("foo", "bar"), array("three", "four"));
//or
//FOO is the class, bar is the method both separated by ::
call_user_func_array("foo::bar"), array("three", "four")); 
```

# c++ - 编译 c++ 应用程序，以便它们也可以在其他计算机上工作

> ID：534183
> 
> 赞同：3
> 
> 时间：2009-02-10T20:58:00.220
> 
> 标签：c++, deployment, gcc, compilation, sdl

所以我有一个非常简单的 SDL 应用程序，我希望能够将其传递给我的朋友，而无需让他下载一大堆 SDL 包。

我该怎么办？有人告诉我使用这一行进行编译：（请注意，我使用 ubuntu linux，我的朋友也是如此，并且这个应用程序在没有“-Wl，-Bstatic”选项的情况下编译和运行就可以了。）

```
    g++ test-sdl.cpp -o test-sdl -Wl,-Bstatic -lSDL_image -lSDL

```

但后来我得到这个错误：

```
    /usr/bin/ld: 找不到 -lgcc_s  
    collect2: ld 返回 1 个退出状态

```

为什么我会收到此错误？我如何解决它？我什至必须这样做吗？有没有不同/更容易/替代的方式？

为了让我的朋友免去下载他可能永远不会使用的软件包的麻烦，我是否要求这么多？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T21:51:40.403

从长远来看，你最好的办法是弄清楚如何构建 .debs，然后你朋友系统的包管理可以负责安装所有需要的依赖项。如果您想更广泛地分发软件包，按预期使用平台的本机打包系统将为您和您的用户省去很多麻烦。

查看 Ubuntu 的[打包](https://wiki.ubuntu.com/PackagingGuide/Complete)指南和[pbuilder](https://wiki.ubuntu.com/PbuilderHowto)。

[就个人而言，我从 Martin Krafft Debian 书](http://debiansystem.info/)中学会了如何为我自己的项目（在 Debian 上）执行此操作，并发现使用[yada 大大](http://yada.alioth.debian.org/)简化了该过程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T21:03:26.260

我认为您应该摆脱-B（这会改变搜索路径，请参见 man g++，因此您再也找不到您的库了）。

您的意思是-static，没有B。

编辑回应评论：对不起，那是不完整的。相反，只需用“-static”替换所有“-Wl，-Bstatic”。

正如 codelogic 所写， -static 不是链接器的选项（这 -Wl 暗示）。

# sql - 创建数据库表结构的最佳方法

> ID：534184
> 
> 赞同：0
> 
> 时间：2009-02-10T20:58:06.510
> 
> 标签：sql, xsd

> **可能的重复：**
> [从 XSD](https://stackoverflow.com/questions/467176/generating-sql-server-db-from-xsd)
> [生成 SQL Server DB 从 XML 生成 SQL 架构](https://stackoverflow.com/questions/263836/generating-sql-schema-from-xml)

我有大量带有数据的 xml 文件，以及一个描述 xml 结构的模式文件 (.xsd)。

我想将数据存储在 MSSQL 数据库中，以便稍后查询并将其显示在网站上。

我现在必须创建 db 结构，并且到目前为止已经想到了 3 种创建表的方法：

1.  使用 xmlspy 我可以加载 xsd 并在那里使用“从 xsd 创建数据库”。“麻烦”是我必须手动添加表之间的关系，并且还要添加用于这些关系的列。
2.  使用 Microsoft SQL Management Studio，我可以以图形方式创建表和关系。这里的“麻烦”是 xsd 描述了大约 100 个表，并且以 GUI 方式手动执行此操作的想法很可怕。我会忘记我在那里的某个地方。
3.  在记事本或其他东西中手写sql。很无聊，但是我可以用小步骤来做，这是我用其他两个选项做不到的。

还有其他我没有想到的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T21:21:14.283

您可以执行类似于选项 (1) 的操作：将 xsd 导入数据库设计工具（例如 ERwin 或 PowerDesigner），然后在“图形”环境中执行编辑步骤，然后让该工具生成数据库。

我不确定这些工具与 xml 和 xsd 配合得如何，您可能必须使用 xmlspy 生成数据库，然后对数据库进行逆向工程。但是一个好的工具将使这比“仅仅”使用数据库更容易。

希望这与您提到的选项（2）不太相似...

# ruby-on-rails - 使用 AASM 调用初始状态的方法

> ID：534191
> 
> 赞同：1
> 
> 时间：2009-02-10T20:58:59.487
> 
> 标签：ruby-on-rails, ruby, rubygems

[使用AASM](http://github.com/rubyist/aasm/tree/master) Gem时是否可以在进入初始状态时调用方法？我希望在`spam_check`提交评论时调用该方法，但它似乎不起作用。

```
class Comment < ActiveRecord::Base
  include AASM

  aasm_column :state
  aasm_initial_state :submitted
  aasm_state :submitted, :enter => :spam_check
  aasm_state :approved
  aasm_state :rejected

  aasm_event :ham do
    transitions :to => :approved, :from => [:submitted, :rejected]
  end

  aasm_event :spam do
    transitions :to => :rejected, :from => [:submitted, :approved]
  end

  def spam_check
    # Mark the comment as spam or ham...
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T21:40:36.827

使用初始化方法怎么样？，它不是自我记录的，但应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T21:49:57.397

我的猜测是，由于垃圾邮件检查是在设置初始状态之前进行的，因此您的 :spam 和 :ham 转换无法执行，因为 :from 条件表明状态应该是 :submitted、:rejected 或 :批准（但事实上，它是零）。初始状态是在`before_validation_on_create`回调上设置的，那么像这样尝试呢？

```
after_validation_on_create :spam_check

aasm_event :spam_check do
  transitions :to => :approved, :from => [:submitted, :rejected], :guard => Proc.new {|c| !c.spam?} 
  transitions :to => :rejected, :from => [:submitted, :approved], :guard => 'spam?'
end

def spam?
  # your spam checking routine
end 
```

这应该在设置`spam_check`后触发事件，`initial_state`并将 ste 状态设置为`:approved`or : `rejected`。

# java - 如何从多个文件中收集弹簧属性以在单个 bean 上使用

> ID：534199
> 
> 赞同：17
> 
> 时间：2009-02-10T21:02:39.603
> 
> 标签：java, properties, spring

我还没有完全了解Spring，如果这个问题没有意义，请纠正我......

我有一个 PropertyPlaceholderConfigurer

```
<bean id="rdbmPropertiesPlacholder" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" lazy-init="false">
    <property name="location" value="classpath:/properties/rdbm.properties" />
</bean> 
```

我猜我注射了一个豆子？

```
<bean id="PortalDb" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="driverClassName" value="${hibernate.connection.driver_class}" />
    <property name="url" value="${hibernate.connection.url}" />
    <property name="username" value="${hibernate.connection.username}" />
    <property name="password" value="${hibernate.connection.password}" />
    ... 
```

我想要的是第二个占位符，它使用用户名/密码指向不同的属性文件，以便我可以将属性拆分为两个不同的文件。然后数据库连接信息可以与数据库用户名/密码分开，我可以控制一个而不是另一个。

我已经尝试过使用不同的 id 和文件复制 rdbmPropertiesPlaceholder 并尝试访问属性，但它不起作用。

此代码来自 uPortal 开源 Web 门户项目。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-10T21:15:12.490

使用此表示法，您可以指定多个文件：

```
 <bean id="rdbmPropertiesPlacholder" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer" lazy-init="false">
     <property name="locations">
       <list>
           <value>classpath:/properties/rdbm.properties</value>
           <value>classpath:/properties/passwords.properties</value>
       </list>
    </property>
 </bean> 
```

propertyplaceholderconfigurerer 只是合并所有这些，看起来只有一个，所以你的 bean 定义不知道属性来自哪里。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-11-27T13:13:52.203

org.springframework.beans.factory.config.PropertyPlaceholderConfigurer 可以做到这一点（正如已经回答的那样。您可能想要做的是利用名称间距，以便您可以从两个文件中引用同名属性而不会产生歧义。对于你的例子，你可以这样做：

```
<bean id="generalPropertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="classpath:/properties/general.properties"/>
</bean>

<bean id="db.PropertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="classpath:/properties/rdbm.properties" />
    <property name="placeholderPrefix" value="$db{" />
    <property name="placeholderSuffix" value="}" />     
</bean> 
```

在您的上下文文件中，您现在可以使用**${someproperty}引用常规属性，并使用****$db{** someproperty}引用 rdbm 属性。

这将使您的上下文文件对开发人员来说更加干净和清晰。

# c++ - 是否可以使用 gcov 测量功能覆盖率？

> ID：534201
> 
> 赞同：10
> 
> 时间：2009-02-10T21:03:44.560
> 
> 标签：c++, unit-testing, code-coverage, gcov

目前，我们将 gcov 与我们的 Linux C++ 应用程序测试套件一起使用，它在测量线路覆盖率方面做得很好。

gcov 除了线路覆盖率之外还能生成函数/方法覆盖率报告吗？

查看 gcov 接受的参数，我认为这是不可能的，但我可能会遗漏一些东西。或者，可能还有其他工具可以从 gcc 生成的统计信息中生成函数/方法覆盖率报告吗？

**更新：**函数/方法覆盖率是指在测试期间执行的函数的百分比。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T21:20:59.013

我猜你的意思是 -f 选项，它会给你每个函数覆盖的行的百分比。[Dobb 博士的](http://www.ddj.com/development-tools/184401989)一篇关于 gcov 的有趣文章可能会有所帮助。如果“man gcov”没有显示 -f 标志，请检查您是否拥有 gcc 套件的最新版本。

**编辑：**要获得未执行的函数的百分比，您可以简单地解析函数覆盖率输出，因为 0.00% 的覆盖率应该几乎等同于未调用。这个小脚本打印未执行的函数的百分比：

```
#!/bin/bash

if test -z "$1"
then
    echo "First argument must be function coverage file"
else
    notExecuted=`cat $1 | grep "^0.00%" | wc -l`
    executed=`cat $1 | grep -v "^0.00%" | wc -l`

    percentage=$(echo "scale=2; $notExecuted / ($notExecuted + $executed) * 100" |bc)

    echo $percentage
fi 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T10:13:51.790

我们已经开始一起使用 gcov 和[lcov](http://ltp.sourceforge.net/coverage/lcov.php)。lcov 的结果确实包括为您正在查看的“模块”执行的函数的百分比。

**编辑：**模块*可以*从目录到文件。

我还想补充一点，如果您已经在使用 GNU 编译器工具，那么 gcov/lcov 对您来说运行起来不会太难，并且它产生的结果非常令人印象深刻。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-11-18T19:17:27.117

lcov 实用程序很好，我们使用它。但我不确定你是否需要它来满足你的需求。

我们

1.  使用 ctags ( [wikipedia](http://en.wikipedia.org/wiki/Ctags) ; [sourceforge](http://ctags.sourceforge.net/) ) 查找相关头文件中声明的所有函数。

2.  运行 GCOV 以获取二进制文件中每个函数的行覆盖率。

3.  比较 1 和 2 中的函数列表以生成“调用的函数”/“可用的函数”。

我们称其为“API 覆盖率”，因为我们仅将第 1 步应用于公共 API 标头。但是您可以根据自己的选择对所有标题或仅在子集上执行此操作。我认为我们以这种方式产生的比率就是您正在寻找的比率。

# wpf - 从 Windows 窗体迁移到 WPF...值得吗？

> ID：534205
> 
> 赞同：14
> 
> 时间：2009-02-10T21:04:11.423
> 
> 标签：wpf, winforms

我还有一个用 Windows 窗体编写的桌面应用程序，大小适中（几十个主要窗体由数据库中的 46 个表支持）。我正在考虑用 WPF 重写 UI，但在我去那里之前，我很好奇是否有任何关于进行这种转换的战争故事。

我使用[LLBLGen](http://en.wikipedia.org/wiki/LLBLGen)来生成我的低级数据访问对象，并且我在其之上有一个业务逻辑层。尽管主表单使用缓存对象来最小化更常见的导航路线上的往返行程，但表单是数据绑定到业务逻辑对象的。UI*从不*直接与数据库对话：总是通过 UI -> 业务逻辑 -> 低级 -> 数据存储路径。

我大量使用的一个控件是 TreeView，它充当视觉指南和短程导航工具。该树已通过图标、突出显示颜色进行了大量定制，这是我最担心移植的控件。

是否有一个故事可以说服我继续转换（或者相反，等到微软更接近从 Windows 窗体下拉出地毯）？

编辑：我在评论中被问到我有什么转换的动机。我对未来的校对有些担心：我有 500,000 行代码，它们最初是 ASP 和[VBScript](http://en.wikipedia.org/wiki/VBScript)。随着时间的推移，我们一直在将功能移植到 ASP.NET 和 C#，但仅在我们对代码进行更改时。好处是我们将成本降到最低，坏处是一半的代码仍然是 ASP 和 VBScript。我担心 Windows 窗体应用程序会出现类似的情况。

我*今天*是否担心Windows 窗体会消失？甚至还没有接近它……但应用程序正在从 ASP 和 VBScript 转移到 ASP.NET 和 C#，已经有 9 年的历史了，而且这十年可能不会被取代（相反，它会不断发展）。桌面应用程序同样是一个具有多年历史的长期项目。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T21:10:05.763

对我来说，WinForms 与 WPF 的决定是一个简单的决定 - 如果普通人要使用它，用户界面可以决定赢家和输家。

这绝对是一个陡峭的学习曲线。但我从来没有完成一个漂亮的 WPF 应用程序，并说“伙计，我应该使用 WinForms”。

我想说的是，尽可能地为您的客户努力使您的 UI 变得更好，所以如果是这样的话，对 WPF 是肯定的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T21:25:20.203

WPF 有一个非常大的学习曲线。它很可能需要你重写比你想象的更多的东西来改变 UI。此外，许多使 WPF 更易于使用的功能尚未实现或包含在 WPF 中。[与 routeNpingme 不同](https://stackoverflow.com/questions/534205/migrating-from-winforms-to-wpf-was-it-worth-it/534214#534214)，我编写了漂亮的 WPF 应用程序，并说：“真是浪费时间，我应该使用 Windows 窗体并在 70% 的时间内完成”。

**编辑：** 另外，除非微软想出一种让 WPF 更容易学习的方法，否则我认为它根本不会吸引大众。WPF 可以做一些非常酷的事情，但是稍微努力让它易于理解而不是把东西扔到墙上就会有很长的路要走。看到微软放弃 WPF 以在不久的将来更容易使用，我一点也不感到惊讶。所以不要仅仅为了改变它而改变你的 Windows 窗体应用程序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-10T23:38:16.483

优点：

*   非常简单的数据绑定（大部分时间）
*   可笑地轻松定制外观和感觉

缺点：

*   非常陡峭的学习曲线
*   一些明显的错误或问题。类似于 .NET 1.0 Windows 窗体
*   很少或没有工具支持

在我看来，WPF 肯定会在某个时候取代 Windows 窗体。然而，现在工具是保持它的主要因素。我不同意 Dunk 的观点，即微软会为了别的东西放弃它。改变它是的，但我认为它会留下来。

您现在应该更改您的应用程序以使用 WPF 吗？不可以。随意学习 WPF，但如果您的应用程序当前运行良好，那么 WPF 不会给您任何额外的东西。它只是让在 Windows 窗体中可以做的事情变得更加容易。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T22:36:20.297

WPF 很棒。它特别适合通过自定义扩展诸如 TreeView 之类的控件。您可以将字符串添加为 TreeControl 中的项。您还可以添加一个包含图像和一些不同字体和颜色的文本的小面板。或者你可以添加按钮，或者任何你喜欢的东西。它有一个完全通用的可组合性系统。ListBox、ComboBox、Button 等也是如此。它们的所有内容或子项都可以像字符串一样简单，也可以像带有缩放按钮的多页文档查看器一样复杂（如果需要）。

但找出答案的唯一方法是尝试移植您的一种表格。从现有应用程序中打开 WPF 窗口应该不会太难。我通过制作托管在 C++ Win32 应用程序中的新 GUI 面板开始使用 WPF。最终很明显，WPF 是我们要走的路，所以我们把它换掉并制作了外壳 WPF，一些古老的对话框仍然由旧的 C++ 代码实现，我们懒得重写它们（可能正是将在 Visual Studio 2010 中发生）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T21:41:27.980

移植是一个艰难的决定。所以只是一些想法来帮助你做出决定。

当您按规则工作并保持所有内容保持原样时，WinForms 就可以了。但是，即使在某些控件上重新绘制边框也可能需要复杂而精确的工作和技能，正如您从树自定义中已经知道的那样。在 WPF 中可以以非常优雅的方式完成相同的任务。

此外，WPF 中的数据绑定为我节省了大量时间。从长远来看，您最终会考虑在没有特殊情况编码的情况下无法在 WinForms 中远程实现的数据绑定场景。

我什至不考虑将 WinForms 用于新开发——定制成本没有任何借口。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T14:37:45.073

我已经开始在我的 WinForms 应用程序中引入 WPF 元素，到目前为止已经取得了很大的成功。

该应用程序的主要组件是一个网格控件，我还没有发现 WPF 的文本渲染足够清晰，无法呈现重要的文本数据表。

但是该应用程序有几个附加面板，其中大部分是使用 WPF 实现的。所以，我打算通过`ElementHost`控件混合 WinForms 和 WPF。

我发现 WPF 的灵活性可以实现更具吸引力和可用性的 UI，而且我的用户似乎对此非常满意。就我而言，一次引入一个面板在政治上也更容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-17T17:44:12.063

WPF 对我的主要价值在于绑定，而不是更酷的 UI。我见过的最糟糕的 WPF 是人们仅仅因为它更新而使用 WPF，并将所有工作都放在代码隐藏中，包括不使用绑定。你得到的是 WinForms 数据管理。因此，请确保在执行 WPF 时要使用美妙的绑定。

I would port the OP's business logic to a business layer for ease of maintenance and conversion. I wouldn't port the WinForms to Xaml at all unless new Xaml functionality was needed, and preferably not until after the functionality was ported.

# javascript - 从 Silverlight 调用 Javascript 函数

> ID：534208
> 
> 赞同：7
> 
> 时间：2009-02-10T21:05:37.270
> 
> 标签：javascript, silverlight

我正在尝试从 silverlight 控件调用 javascript 函数（在我们的代码中）。我正在尝试通过以下方式调用该函数：

`HtmlPage.Window.Invoke("showPopup", new string[] { "http://www.example.com" });`

我收到错误“调用失败：showPopup”

我可以`HtmlPage.Window.Invoke("alert", new string[]{"test"});`毫无问题地打电话，但不是我自己的功能。

我还可以在 IE 开发人员工具中打开相关页面并手动调用`showPopup("http://www.example.com")`，它可以按预期工作。

所以 js 函数起作用了，Silverlight 二进制可以找到其他 js 函数。我在这里想念什么？

补充笔记：

*   函数调用在按钮单击事件处理程序中，因此它在页面（和脚本）加载后发生）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T23:02:14.213

showPopup javascript 函数是否与 Silverlight 控件位于同一 html 或 aspx 页面上？如果 javascript 函数不存在，您通常会收到“调用失败...”错误：

```
HtmlPage.Window.Invoke("functionThatDoesNotExist", new [] { "Testing" }); 
```

[![替代文字](https://i.stack.imgur.com/2AwxU.png)](https://i.stack.imgur.com/2AwxU.png)

当您遇到此问题时，您使用的是什么浏览器？

您使用的是最新版本的 Silverlight 吗？

您是否在任何地方使用 ScriptableType 属性？

是否可以列出导致此问题在您的计算机上发生的简短但完整的程序的代码...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T15:23:30.267

啊哈！我想到了。我们的应用程序使用 iframe，因此呈现的 html 看起来像这样

```
<html>
<head></head>
<body>
Stuff
<iframe>
    <html>
        <head></head>
        <body>Other Stuff</body>
    </html>
</iframe>
<body>
</html> 
```

有问题的 Silverlight 控件位于 iframe 中。问题是包含该`showPopup`函数的文件在外部引用`<head>`（为什么我可以使用 IE 工具栏调用该函数）而不是内部`<head>`. 在 iframe 中添加对文件的引用`<head>`解决了这个问题。

有点虎头蛇尾，但感谢所有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T19:32:56.413

实际上，从 iframe 再次引用脚本并不是引用父级中包含的代码的最有效方式。如果您的函数名为“showPopup”，您可以将其插入 iframe：

```
<script type="text/javascript">
    var showPopup = parent.showPopup;
</script> 
```

瞧。对此的解释是所有“全局”函数和对象都是这个“全局命名空间”的一部分......这是“窗口”对象。因此，如果您尝试从子级访问“全局”函数，则需要在父级上调用该函数（例如 parent.showPopup('....')）或为其声明一个本地别名（即我们在上面的例子中做了什么）。

干杯!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T21:10:08.757

在尝试从中调用函数之前，请确保您的脚本已完全加载。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T12:45:17.253

这是我的做法。但我正在创建没有视觉工作室的 Silverlight。我只有原始的 html、xaml 和 js (javascript)。注意 MouseLeftButtonUp 和它的值“LandOnSpace”

```
 <Canvas x:Name="btnLandOnSpace" Background="LightGreen" MouseLeftButtonUp="LandOnSpace"
            Cursor="Hand" Canvas.Top ="0"  Width="70" Height="50"> 
            <TextBlock Text="LandOnSpace"  />
            </Canvas> 
```

```
function LandOnSpace(sender, e) {  //on server
if (!ShipAnimateActive && !blnWaitingOnServer) {
    blnWaitingOnServer = true;
    RunServerFunction("/sqgame/getJSLLandOnSpace");
        ShowWaitingBox();
        };
else {
    alert('Waiting on server.');
}; 
```

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-09T09:36:10.093

我在带有 SL 4 的 VS 2010 中遇到了同样的问题。我创建了一些方法并将它们放入一个 JS 文件中。但是，此文件尚未添加到 ASPX 文件的头部。添加它解决了这个问题。不同之处在于，虽然我在 iframe 中没有单独的 head 部分，但我遇到了问题并且得到了解决。

# c++ - 如何在 c/c++ 中从 windows pc 获取唯一的硬件/软件签名

> ID：534215
> 
> 赞同：8
> 
> 时间：2009-02-10T21:10:07.650
> 
> 标签：c++, windows, copy-protection

我正在使用 c++ 开发一个小型 Windows 应用程序，我想在 pc 上获取某种软件/硬件的指纹，以便我可以允许该应用程序仅在某些 pc 上运行。

我知道该应用程序可能会被破解，但我真的对实现这样的东西很感兴趣。
有什么想法我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T21:17:35.120

这基本上取决于您希望将软件与底层硬件耦合的紧密程度。例如，您可以从注册表中获取一些硬件信息，从 LAN 卡中读取 MAC 地址，检索 gfx 制造商、CPU id 等并对所有这些数据进行哈希处理。
然后，您可以将此哈希用作发送给您公司的[质询代码。](http://en.wikipedia.org/wiki/Challenge-response_authentication)然后，客户会收到此哈希的签名（使用您的私钥）版本。
在启动时，您的应用程序能够检查散列的签名是好是坏（即已由您的公司签名）。
这不仅将您的软件绑定到某个硬件配置，而且还迫使破解者修补您的应用程序（因为他们需要修补可执行文件中的公钥并替换它才能编写密钥生成器）。与仅输入从注册机复制的有效序列相比，许多人考虑两次安装从各种来源获得的破解。

**编辑：**
为了检查哈希的签名，可以使用从[RSA](http://en.wikipedia.org/wiki/Rsa) over [DSA](http://en.wikipedia.org/wiki/Digital_Signature_Algorithm)到[ECC的任何东西。](http://en.wikipedia.org/wiki/Elliptic_curve_cryptography)我可以为此推荐[Crypto++](http://www.cryptopp.com/)或[libTomCrypt](http://libtomcrypt.com/index.old.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T21:16:29.880

在普通 PC 中没有可靠的方法可以做到这一点。人们多年来一直在努力。问题是您可能随时更改任何组件，包括 CPU 和 BIOS ROM。最接近的人是使用受密码保护的“[加密狗](http://en.wikipedia.org/wiki/Dongle)”，但事实证明这在操作上并不令人满意，而且不是很安全。

如果你想出一些东西，就申请专利；这将是非常有价值的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T21:22:24.017

正如其他人所说，没有什么可以完美满足您的需求。我对类似问题进行了半心半意的尝试，最终混合了驱动器卷 ID（不好，因为它可以重新格式化）和操作系统密钥（来自 Windows）。

最后我没有花太多时间在它上面，好像人们真的想破解你的软件，他们可能能够做到。我离开了极小的许可“保护”，但它很差。

花时间/精力让他们想买它，让它出类拔萃。

# sql - SQL返回特定行的rownum？（使用 Oracle 数据库）

> ID：534217
> 
> 赞同：2
> 
> 时间：2009-02-10T21:10:14.653
> 
> 标签：sql, oracle, oracle10g, rowid

在 Oracle 10g 中，我有这个 SQL：

```
select dog.id as dogId from CANINES dog order by dog.codename asc 
```

返回：

```
id
--
204
203
206
923 
```

我想扩展此查询以确定此结果集中 dog.id 的 oracle rownum。

我试过了

```
select rownum from 
(select dog.id as dogId from CANINES dog order by dog.codename asc) 
where dog.id=206 
```

但这不是很好（无论我匹配哪个 dog.id，它都会返回 1）。我期待着回来 3。

谢谢你的帮助！

* * *

*笔记*

[http://www.oracle.com/technology/oramag/oracle/06-sep/o56asktom.html](http://www.oracle.com/technology/oramag/oracle/06-sep/o56asktom.html)

我很确定我不需要使用 rowid

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T23:24:52.380

我怀疑您想要的是使用分析函数（RANK `DENSE_RANK`，或`ROW_NUMBER`），即

```
SELECT rnk
  FROM (select dog.id as dogId,
               ROW_NUMBER() OVER( ORDER BY dog.codename ASC ) rnk
          from CANINES dog )
 WHERE dogId = 206 
```

如果 CANINES 表中的 ID 列不是唯一的，则 RANK、`DENSE_RANK`和`ROW_NUMBER`) 将区别对待平局。

如果您只想使用 ROWNUM 执​​行此操作，

```
SELECT rn
  FROM (
        SELECT dogId, rownum rn
          FROM (select dog.id as dogId
                  from CANINES dog 
                 order by dog.codename ASC) inner
       ) middle
 WHERE dogId = 206 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T21:14:25.987

如果您要查找表中每一行的唯一标识符，则需要 ROWID，而不是 ROWNUM。

ROWNUM 是一个伪列，每次执行一点 SQL 时都会发生变化（在查询时计算出来）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T21:18:32.887

看看这是否适合你：

**回答**

```
SELECT dog1.DogID, dog1.DogName, COUNT(*) AS rownumber
FROM #ids dog1, #ids dog2
WHERE dog2.DogName <= dog1.DogName
GROUP BY dog1.DogID, dog1.DogName
ORDER BY dog1.DogName 
```

**结果**

```
DogID       DogName    rownumber
----------- ---------- -----------
204         Dog 1      1
203         Dog 2      2
206         Dog 3      3
923         Dog 4      4 
```

**DDL**

```
CREATE TABLE #ids (DogID int NOT NULL PRIMARY KEY, DogName varchar(10) NOT NULL)
INSERT INTO #ids (DogID, DogName) VALUES (204, 'Dog 1')
INSERT INTO #ids (DogID, DogName) VALUES (203, 'Dog 2')
INSERT INTO #ids (DogID, DogName) VALUES (206, 'Dog 3')
INSERT INTO #ids (DogID, DogName) VALUES (923, 'Dog 4') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-26T19:22:43.617

为了做到这一点，最好改变表并添加一个序列。如果您打算删除行，这可能会变得棘手。在哪里，也许更好的做法是使用状态列或 start-end-date 主题来决定哪些行是活动的并且应该返回。

# asp.net-mvc - 带有分页的asp.net MVC缓存

> ID：534219
> 
> 赞同：0
> 
> 时间：2009-02-10T21:11:14.853
> 
> 标签：asp.net-mvc, linq, pagination

实现分页时是否会首选使用 linqs 延迟加载？或者我应该缓存结果并在选择页面时重复调用它？当缓存刷新时，我会重新加载结果，但结果可能会改变，因此页面也会改变。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T21:37:30.407

我想这取决于您期望拥有多少数据以及用户对所有数据进行分页的频率。如果会有很多行，那么最好在查询中使用分页来避免在初始页面加载时加载大量数据集。如果不会有太多数据，那么使用缓存方法不会对初始页面加载造成太大影响，并且会加快后续加载速度，而不必重新查询数据库。

# sharepoint - 应用程序池标识 - 场管理员

> ID：534224
> 
> 赞同：1
> 
> 时间：2009-02-10T21:12:36.880
> 
> 标签：sharepoint, sharepoint-2007

作为应用程序池标识的用户 ID 也在 Farm Administrators 组中。

**那是一件坏事？**

进行此更改后，我们开始看到一些奇怪的权限错误（该用户 ID 已添加到场管理员组）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T21:58:12.417

在我们的开发环境中，我们已经多次这样做了，我们希望一个帐户对所有内容都具有上帝般的权限。

据我所知，它不应该导致权限问题，但 SharePoint 在这方面可能有点……善变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T03:37:53.850

Microsoft 建议使用单独的帐户：

[http://technet.microsoft.com/en-us/library/cc263445.aspx#Subsection2](http://technet.microsoft.com/en-us/library/cc263445.aspx#Subsection2)

# language-agnostic - 向独立开发者支付游戏费用的地方？

> ID：534228
> 
> 赞同：4
> 
> 时间：2009-02-10T21:14:00.650
> 
> 标签：language-agnostic

有哪些地方会为他们的游戏付费给独立游戏开发者？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T21:22:01.023

如果您不将自己限制在特定平台上，还有各种内容交付服务，例如 Steam (PC)、PlayStation Network (PS3/PSP) 和 XNA Creators Club (PC/Xbox 360)。它们具有各种机制来通过其服务托管独立游戏。

如果您是，那么这里的其他一些用户可能会对您的其他选项有一些很好的建议:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T21:23:15.403

XNA 游戏的[XNA Creators Club](http://creators.xna.com/en-US/)怎么样？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T21:28:55.420

[Kongregate](http://www.kongregate.com/)很好，因为他们进行收益分享并有奖金竞赛。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T21:19:49.030

你的游戏是用什么写的？

来自手机游戏背景的网站，如[http://www.didmo.com/community/](http://www.didmo.com/community/)会为您托管您的游戏，他们会在其周围添加广告包装以赚钱，然后您分摊利润。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T21:28:06.140

我猜你正在考虑开发 Flash 游戏，因为你提到了 Kongregate，几个月前我调查了这个，另一个看起来很有希望的网站是[疯狂的猴子游戏](http://www.crazymonkeygames.com/sponsor.php)。希望这会有所帮助，祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T21:29:33.797

不要忘记，您还可以将您的游戏移植到 iPhone 上并将其放在那里，也可以将其移植到 Android 平台上并轻松地将其放置在 Google 店面中。

不过，您应该查看 XNA Creators Club 的 360。此外，如果您在 XNA 中进行，则没有许可费或任何其他费用，您可以将您的程序按原样出售给 Windows 机器。GoDaddy，一个与 paypal 集成的购物车并不难，你可以自己托管。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T21:29:35.747

Kongregate 很受欢迎。他们的付款计划可能不是您想要的，如果您的游戏没有变得非常受欢迎，那么我认为您不会得到很好的报酬。

话虽如此，您还可以考虑其他选择。你看过游戏内的广告吗？许多流行的基于 Flash 的游戏都有在游戏加载时和/或在固定时间段内显示的广告。每次有人查看和/或点击广告时，您都会获得少量资金，他们最终会加起来获得一些可观的现金。

除非您的游戏非常受欢迎（例如桌面防御），否则我认为您无法从中赚到很多钱。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T21:29:41.253

您是否考虑过自己托管游戏，而只是在页面上放置广告？

我不是要轻率，我很好奇你是否走上了这条路，你学到了什么，如果有的话。

# version-control - 可视化版本控制文件中的更改

> ID：534232
> 
> 赞同：11
> 
> 时间：2009-02-10T21:14:34.113
> 
> 标签：version-control, visualization

我们一直在尝试使用受[Edward Tufte](http://www.edwardtufte.com/tufte/books_vdqi)启发的数据可视化技术来展示我们的测试套件，它非常有效。

我想将此扩展到我们的 Subversion 存储库，因为我觉得提交历史中隐藏着很多信息，可以更好地以图形格式表示。

我希望能够一目了然地识别以下内容：

*   哪些模块比较稳定 - 大量编写 - 少量维护，哪些模块已经编写和重写
*   哪些模块是一个人的工作，哪些是许多人的工作

理想情况下，我想用来自测试和性能工具的其他东西来注释这些信息，比如：

*   代码覆盖率
*   外部参照的东西，如函数调用图
*   mebbies 甚至像在一致负载下的处理器利用率之类的东西

任何人都很好，任何好的提示、示例、实用程序等……

我们的商店主要使用强大的 Erlang，但我们会从任何来源获得勇气和灵感。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T21:23:49.397

查看 StatSVN 作为 Subversion 统计生成器的示例：

[http://www.statsvn.org/](http://www.statsvn.org/)

[http://www.statsvn.org/demo/ruby/](http://www.statsvn.org/demo/ruby/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-21T14:45:56.267

您可以尝试[SVNplot](http://code.google.com/p/svnplot)。它首先从 svn 提交日志消息中创建一个本地 sqlite 数据。然后它使用 sql 查询和 matplotlib 从中生成各种图形。

您可以在 sqlite 数据库中使用它来添加您的自定义查询和其他图表。

（免责声明 - 我是 SVNPlot 的主要作者。如果您觉得它有用或者您有任何改进建议，请告诉我）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T01:45:52.557

您可能已经看到今年早些时候[Codewarm](http://code.google.com/p/codeswarm/)成为一些头条新闻，当时它被用来生成一些关于 Ruby on Rails 协作的酷视频——请参阅[Visualizing Rails 和 Git](http://www.igvita.com/2009/01/27/ruby-swarms-visualizing-rails-git/)博客文章以获取精彩的摘要和示例视频。

[您可能还会从历史流](http://www.research.ibm.com/visual/projects/history_flow/explanation.htm)中获得一些想法，Jeff Atwood 在最近的 Coding Horror 帖子中提到了这一点。

# model-view-controller - 在 MVC/MVP/MVPC 中，您将业务逻辑放在哪里？

> ID：534233
> 
> 赞同：27
> 
> 时间：2009-02-10T21:14:42.960
> 
> 标签：model-view-controller, mvp, puremvc

在 MVC/MVP/MVPC 设计模式中，您将业务逻辑放在哪里？不，我不是指 ASP.NET MVC 框架（又名“标签汤”）。

有人说你应该把它放在MVC/MVPC中的“Controller”或“Presenter”中。但是，其他人认为它应该是模型的一部分。

你怎么看，为什么？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-02-10T21:17:56.663

这就是我的看法：

控制器用于应用程序逻辑；特定于您的应用程序希望如何与其相关的知识领域进行交互的逻辑。

该模型用于独立于应用程序的逻辑。即在其相关知识领域的所有可能应用中都有效的逻辑。

因此，几乎所有业务规则都将包含在模型中。

当我需要决定在哪里放置一些逻辑时，我会问自己一个有用的问题是“这总是正确的，还是仅针对我当前正在编码的应用程序的一部分？”

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-02-10T21:36:40.707

我的 ASP.NET MVC 应用程序结构的工作流程如下所示：

控制器 -> 服务 -> 存储库

上面的服务层是所有业务逻辑发生的地方。如果您将业务逻辑放在控制器层中，您将失去在其他控制器中重用该业务逻辑的能力。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-10T21:25:08.440

我不相信它属于控制器，因为一旦嵌入其中，它就无法脱身。

我认为 MVC 应该在中间注入另一层：映射到用例的服务层。它包含业务逻辑，了解工作单元和事务，并处理模型和持久性对象以完成其任务。

控制器具有对实现其用例所需的服务的引用。它担心将请求解组为服务可以处理的对象，调用服务，并编组响应以发送回视图。

通过这种安排，即使没有控制器/视图对，服务也可以单独使用。它可以是控制器处理的本地或远程对象，以您希望的任何方式打包和部署。

控制器现在变得更紧密地绑定到视图。毕竟，用于桌面的控制器可能与用于 Web 应用程序的控制器不同。

我觉得这个设计更注重服务。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-09-17T03:52:01.203

将您的业务逻辑放在域中并保持您的域独立。我更喜欢 Presenter -> Command (Message command use NServiceBus) -> Domain (with BC Bounded Context) -> EventStore -> Event handler -> Repository (read model)。如果逻辑不适合域，则使用服务层。

请阅读 Martin fowler、Eric Evan、Greg Young 和 Udi dahan 的文章。他们定义了非常清晰的画面。

这是 Mark Nijhof 写的文章：http: [//elegantcode.com/2009/11/11/cqrs-la-greg-young/](http://elegantcode.com/2009/11/11/cqrs-la-greg-young/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-08-17T17:49:55.083

**无论如何，把它放在模型中！**

当然，一些用户交互必须在视图中，这将与您的应用程序和业务逻辑相关，但尽可能避免这种情况。具有讽刺意味的是，遵循用户在您的 GUI 中“工作”时尽可能少做的原则，在“提交”或操作请求期间尽可能多地做，这会带来*更好*的用户体验和可用性，而不是相反。至少对于业务线应用程序而言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T21:36:23.797

你可以把它放在两个地方。控制器和表示层。通过在表示层中包含一些逻辑，您可以限制返回到架构中的请求数量，这会增加系统的负载。是的，您必须编写两次代码，但有时这正是响应式用户体验所需要的。

我有点喜欢这里所说的（[http://www.martinhunter.co.nz/articles/MVPC.pdf](http://www.martinhunter.co.nz/articles/MVPC.pdf)）

“使用 MVPC，MVP 模型的 Presenter 组件分为两个组件：Presenter（视图控制逻辑）和控制器（抽象目的控制逻辑）。”

# asp.net - gridview 删除和允许分页问题

> ID：534234
> 
> 赞同：0
> 
> 时间：2009-02-10T21:14:58.107
> 
> 标签：asp.net, vb.net

我已经搜索过，现在对我的问题的原因一无所知。

这是我的问题的简短版本。

我有一个 gridview、一个用于打开/关闭 gridview 分页的复选框以及一个带有选择和删除查询的 sql 数据源。如果分页打开，我可以单击删除网格视图中的一行，它运行并且页面刷新没有问题。如果我为 gridview 关闭分页，当我对 sql server 中的表执行直接查询但页面无法重新加载时，删除查询似乎会运行。我收到以下错误：

> 指定的参数超出了有效值的范围。参数名称：value 说明：当前web请求执行过程中发生了未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.ArgumentOutOfRangeException：指定的参数超出了有效值的范围。参数名称：值
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [ArgumentOutOfRangeException：指定的参数超出了有效值的范围。参数名称：值]
> System.Web.UI.WebControls.GridView.set_SelectedIndex(Int32 value) +280
> System.Web.UI.WebControls.GridView.HandleDeleteCallback(Int32 affectedRows, Exception ex) +352
> System.Web.UI.DataSourceView。删除（IDictionary 键，IDictionary oldValues，DataSourceViewOperationCallback 回调）+119
> System.Web.UI.WebControls.GridView.HandleDelete（GridViewRow 行，Int32 rowIndex）+938
> System.Web.UI.WebControls.GridView.HandleEvent（EventArgs e，布尔原因验证，字符串验证组）+1152
> System.Web.UI.WebControls.GridView.RaisePostBackEvent（字符串 eventArgument）+190
> System.Web.UI.WebControls.GridView.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +7
> System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +11 System.Web.UI.Page .RaisePostBackEvent（NameValueCollection postData）+172
> System.Web.UI.Page.ProcessRequestMain（布尔includeStagesBeforeAsyncPoint，布尔includeStagesAfterAsyncPoint）+4920

这是页面代码：

```
<asp:SqlDataSource ID="dsSQL_ClaimsDetail" runat="server" ConnectionString="<%$ ConnectionStrings:activeDB_Connection %>"
        DeleteCommand="DELETE FROM [tblReturnClaimDetail] WHERE [ID] = @ID" ProviderName="<%$ ConnectionStrings:activeDB_Connection.ProviderName %>"
        SelectCommand="SELECT ID, HeaderID, CustomerSKUData, NikeInvoiceOrSalesOrderNumber, StyleandColorCode, StyleCode, ColorCode, StyleName, WholesaleDolrs, OriginalWholesaleDolrsPerUnit, Units, AccountDiscDolrsPerUnit, TotalNetPriceDolrs, HandlingandProcessing, Negotiated, NegotiatedReason, NegotiatedOptionType, NegotiatedOptionValue, FinalUnitPrice, FinalDolrs, FinalStandardDolrs, UpdateTime, UpdateUser, BatchUser, Approved, Denied, Pending, ClaimDisposition, FinalDecisionDate, ClaimRecordNumber, ASMName, Category, Gender, Other1, Other2, Other3, GBURegion, Division, BudgetManagerName, ClaimsBudgetYear, ClaimsBudgetQuarter, ApprovedDate, ReconciledBy, ReconciledDate, ReconcileOrigionalLineID FROM tblReturnClaimDetail WHERE (HeaderID = @claimID)">
        <DeleteParameters>
            <asp:Parameter Name="ID" />
        </DeleteParameters>
    <SelectParameters>
            <asp:ControlParameter ControlID="lbl_ClaimNumber" Name="claimID" PropertyName="Text" />
        </SelectParameters>
    </asp:SqlDataSource>
    <asp:CheckBox ID="chkbox_detailPagerToggle" runat="server" Text="View all styles at once" Visible="True" AutoPostBack="True" Checked="True" />&nbsp;</div>
    <asp:GridView ID="grid_Details" runat="server" AutoGenerateColumns="False"
        DataKeyNames="ID" DataSourceID="dsSQL_ClaimsDetail">
        <Columns>
            <asp:CommandField SelectText="Edit" ShowSelectButton="True">
                <HeaderStyle BackColor="Transparent" />
            </asp:CommandField>
            <asp:BoundField DataField="ID" HeaderText="ID" InsertVisible="False" ReadOnly="True"
                SortExpression="ID" />
            <asp:BoundField DataField="NikeInvoiceOrSalesOrderNumber" HeaderText="Nike Invoice /&lt;br /&gt;Sales Order #"
                HtmlEncode="False" SortExpression="NikeInvoiceOrSalesOrderNumber" />
            <asp:BoundField DataField="StyleCode" HeaderText="Style Code" SortExpression="StyleCode" />
            <asp:BoundField DataField="ColorCode" HeaderText="Color Code" SortExpression="ColorCode" />
            <asp:BoundField DataField="StyleName" HeaderText="Style Name" SortExpression="StyleName" />
            <asp:BoundField DataField="GBURegion" HeaderText="Channel" SortExpression="GBURegion" />
            <asp:BoundField DataField="Category" HeaderText="Category" SortExpression="Category" />
            <asp:BoundField DataField="Gender" HeaderText="Gender" SortExpression="Gender" />
            <asp:BoundField DataField="OriginalWholesaleDolrsPerUnit" DataFormatString="{0:c2}"
                HeaderText="WholeSale&lt;br /&gt;$/Unit" HtmlEncode="False" SortExpression="OriginalWholesaleDolrsPerUnit" />
            <asp:BoundField DataField="Units" HeaderText="Units" SortExpression="Units" />
            <asp:BoundField DataField="AccountDiscDolrsPerUnit" DataFormatString="{0:c2}" HeaderText="Discount&lt;br /&gt;$/Unit"
                HtmlEncode="False" SortExpression="AccountDiscDolrsPerUnit" />
            <asp:BoundField DataField="HandlingandProcessing" DataFormatString="{0:c2}" HeaderText="Handling &amp;&lt;br /&gt;Processing"
                HtmlEncode="False" SortExpression="HandlingandProcessing" />
            <asp:CheckBoxField DataField="Negotiated" HeaderText="Negotiated" SortExpression="Negotiated" />
            <asp:BoundField DataField="NegotiatedReason" HeaderText="Negotiated Reason" SortExpression="NegotiatedReason" />
            <asp:BoundField DataField="NegotiatedOptionType" HeaderText="Negotiated Type" SortExpression="NegotiatedOptionType" />
            <asp:BoundField DataField="NegotiatedOptionValue" HeaderText="Negotiated Value" SortExpression="NegotiatedOptionValue" />
            <asp:BoundField DataField="FinalDolrs" DataFormatString="{0:c2}" HeaderText="Final $ for Product"
                HtmlEncode="False" SortExpression="FinalDolrs">
                <ItemStyle Font-Bold="True" />
            </asp:BoundField>
            <asp:CommandField ShowDeleteButton="True">
                <HeaderStyle BackColor="Transparent" />
            </asp:CommandField>
        </Columns>
    </asp:GridView> 
```

有问题的 3 个对象的唯一代码位于复选框上：

```
Protected Sub chkbox_detailPagerToggle_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles chkbox_detailPagerToggle.CheckedChanged
    If Me.chkbox_detailPagerToggle.Checked = True Then
        Me.grid_Details.AllowPaging = False
    Else
        Me.grid_Details.AllowPaging = True
    End If
End Sub 
```

任何能让我朝着正确方向前进的想法都会很棒，因为我不知道下一步该去哪里解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T21:55:31.940

看起来 GridView 对要删除的行数感到困惑，并尝试将所选索引设置为无效值。

是否仅在删除最后一行时发生？

删除时是否触发了任何触发器？这可能会导致 @@RowCount 搞砸。尝试在删除调用之前添加“SET NOCOUNT OFF”和“SET NOCOUNT ON”。

我猜，但也许随着分页，SetSelectedIndex 代码的工作方式略有不同。

# sql - 具有增量整数列的 MSSQL Select 语句...不是来自表

> ID：534240
> 
> 赞同：48
> 
> 时间：2009-02-10T21:16:44.420
> 
> 标签：sql, sql-server, sql-server-2000, auto-increment, row-number

如果可能，我需要一个 t-sql 查询，它从任意表返回值，还返回一个增量整数列，第一行的 value = 1，第二行的 value = 2，依此类推。

该列实际上并不驻留在任何表中，并且必须严格递增，因为 ORDER BY 子句可以对表的行进行排序，并且我希望增量行始终保持完美的形状......

提前致谢。

--EDIT 对不起，忘了说，必须在 SQL Server 2000 上运行

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-10T21:26:11.793

对于 SQL 2005 及更高版本

```
SELECT ROW_NUMBER() OVER( ORDER BY SomeColumn ) AS 'rownumber',*
    FROM YourTable 
```

2000年你需要做这样的事情

```
SELECT IDENTITY(INT, 1,1) AS Rank ,VALUE
INTO #Ranks FROM YourTable WHERE 1=0

INSERT INTO #Ranks
SELECT SomeColumn  FROM YourTable
ORDER BY SomeColumn 

SELECT * FROM #Ranks
Order By Ranks 
```

另请参阅此处的 [行号](http://wiki.lessthandot.com/index.php/Row_Number)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-05-01T16:13:27.020

您可以从自定义编号开始并从那里递增，例如，您想为可以执行的每笔付款添加一个支票编号：

```
select @StartChequeNumber = 3446;
SELECT 
((ROW_NUMBER() OVER(ORDER BY AnyColumn)) + @StartChequeNumber ) AS 'ChequeNumber'
,* FROM YourTable 
```

将为每一行提供正确的支票号码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-10T21:19:57.283

试试 ROW_NUMBER()

[http://msdn.microsoft.com/en-us/library/ms186734.aspx](http://msdn.microsoft.com/en-us/library/ms186734.aspx)

例子：

```
SELECT
  col1,
  col2,
  ROW_NUMBER() OVER (ORDER BY col1) AS rownum
FROM tbl 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T21:34:14.923

它很丑而且性能很差，但从技术上讲，这适用于任何具有至少一个唯一字段的表，并且适用于 SQL 2000。

```
SELECT (SELECT COUNT(*) FROM myTable T1 WHERE T1.UniqueField<=T2.UniqueField) as RowNum, T2.OtherField
FROM myTable T2
ORDER By T2.UniqueField 
```

注意：如果您使用这种方法并将 WHERE 子句添加到外部 SELECT 中，如果您希望数字是连续的，则还必须将其添加到内部 SELECT 中。

# c++ - 如何使用 C++ 在 Vista 中将窗口置于前台？

> ID：534241
> 
> 赞同：3
> 
> 时间：2009-02-10T21:17:09.053
> 
> 标签：c++, winapi, window

我有一段代码使用 WinXP 的 SetForegroundWindow API 将光标下的窗口带到前台。我一直在为 Vista 测试它，但 API 似乎不再正确地完成这项工作。

AllowSetForeground 没有帮助，我的进程是后台进程。

我可以用什么来实现这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T21:24:12.327

试试下面的代码，看看它是否适合你：

```
SetWindowPos(WndHandle,HWND_TOPMOST,0,0,0,0,SWP_NOMOVE | SWP_NOSIZE);
SetWindowPos(WndHandle,HWND_NOTOPMOST,0,0,0,0,SWP_SHOWWINDOW | SWP_NOMOVE | SWP_NOSIZE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-16T07:02:28.333

如果使用 MFC，这在 Windows 7 x64 中对我有用：

```
 RECT rc;
    m_pMainWnd->GetWindowRect(&rc);

    int nBoxWidth = rc.left-rc.right;
    int nBoxHeight = rc.bottom-rc.top;
    int nBoxTop = rc.top;
    int nBoxLeft = rc.left;

    SetWindowPos(m_pMainWnd->GetSafeHwnd(), HWND_TOPMOST,
                    nBoxLeft, nBoxTop, nBoxWidth, nBoxHeight,
                    SWP_NOMOVE || SWP_NOSIZE);
    SetWindowPos(m_pMainWnd->GetSafeHwnd(), HWND_NOTOPMOST,
                    nBoxLeft, nBoxTop, nBoxWidth, nBoxHeight,
                    SWP_SHOWWINDOW || SWP_NOMOVE || SWP_NOSIZE); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T21:25:01.840

如果`SetForegroundWindow()`失败，您是否尝试过设置窗口`WS_EX_TOPMOST`，然后在调用后立即非最上面`SetForegroundWindow()`？

这可能与人们理所当然地抱怨应用程序在您最不期望的情况下到处出现有关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-02T06:41:05.883

将当前线程设置为睡眠对我来说是这样做的，以及之前将其设置为非最顶层：

```
OS.SetWindowPos(handle, OS.HWND_NOTOPMOST, 0, 0, 0, 0, OS.SWP_NOMOVE | OS.SWP_NOSIZE);
try {
    Thread.sleep(100);
} catch (InterruptedException e) {
    LOG.error("sleeping thread was interrupted", e);
}
OS.SetWindowPos(handle, OS.HWND_TOPMOST, 0, 0, 0, 0, OS.SWP_NOMOVE | OS.SWP_NOSIZE); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T21:33:22.430

```
VOID SwitchToThisWindow(HWND hWnd, BOOL fAltTab); 
```

适用于 XP 到 Windows 7 [http://msdn.microsoft.com/en-us/library/ms633553.aspx](http://msdn.microsoft.com/en-us/library/ms633553.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T09:28:25.923

只是一个警告：有一个公共 API 可以做到这一点（SetForegroundWindow），现在它不再将窗口置于前台。

现在窗口只是闪烁。

但这是有原因的。这样做的应用程序从当前窗口“窃取”焦点（通常没有充分的理由），并可能导致各种问题。

因此，在尝试规避操作系统针对此类行为设置的保护措施之前，请确保您不会惹恼您的用户。问问自己：“即使我的应用程序在后台，我真的——真的必须跳到我的用户面前吗？”

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2011-04-14T07:09:27.500

使用windows powertoys的tweakui程序来改变焦点的许可状态。

选择“一般”，然后选择“焦点”，然后取消选中允许其他程序关注的框。

当每个人的建议似乎都不起作用时，这才起作用（他们实际上都起作用）。

微软以其无限的智慧决定，对 setforegrondwindow 等的调用的响应现在将为空。

他们懒得说tjat你仍然可以通过tweakui回到原来的状态！！！！

请享用.....

# asp.net - 一起更新所有 ListView 项目而不是一个接一个？

> ID：534250
> 
> 赞同：1
> 
> 时间：2009-02-10T21:19:02.277
> 
> 标签：asp.net, listview

我在 ASP.Net 3.5 中有一个发票输入表。我有一个用于主发票表单的 FormView 和一个用于发票行项目的 ListView。当用户编辑它们时，我不想将每个行项目单独提交到数据库。当用户单击按钮更新 FormView 时，我想将它们全部作为一个组提交。我想我可以绑定到数据表并从每个控件中手动检索值。但是，如果可能，我更喜欢使用 LinqDataSource 或 ObjectDataSource。

有没有一种简单的方法来完成我在那里尝试做的事情？如果有更简单的方法，我不会与 FormView/ListView 方法结婚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-06-08T06:25:16.243

如果您使用的是 LinqDataSource，并且使用操作已对实体进行了更改，则只需调用 SubmitChanges 方法将在单个事务中将数据更改提交回数据库。

# .net - 如何在 .net 中跨不同程序集版本保留 user.config 设置？

> ID：534261
> 
> 赞同：160
> 
> 时间：2009-02-10T21:21:14.783
> 
> 标签：.net, settings, assemblyversions

基本上问题是每次程序集版本更改（即用户安装应用程序的新版本）时，他们的所有设置都会重置为默认值（或者更准确地说，在具有不同版本的文件夹中创建新的 user.config 文件数字作为名称）

升级版本时如何保持相同的设置，因为似乎不鼓励使用 ini 文件或注册表？

当我们使用 Clickonce 时，它​​似乎能够处理这个问题，所以它似乎应该能够完成，但我不确定如何。

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2009-02-10T21:41:25.623

ApplicationSettingsBase 有一个[名为 Upgrade 的方法](http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.upgrade.aspx)，它可以迁移以前版本的所有设置。

为了在您发布应用程序的新版本时运行合并，您可以在设置文件中定义一个默认为 true 的布尔标志。将其命名为**UpgradeRequired**或类似名称。

然后，在应用程序启动时，您检查是否设置了标志，如果是，则调用[Upgrade 方法](http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.upgrade.aspx)，将标志设置为 false 并保存您的配置。

```
if (Settings.Default.UpgradeRequired)
{
    Settings.Default.Upgrade();
    Settings.Default.UpgradeRequired = false;
    Settings.Default.Save();
} 
```

[在MSDN](http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.upgrade.aspx)上阅读有关升级方法的更多信息。如果您需要进行一些自定义合并，[GetPreviousVersion](http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.getpreviousversion.aspx)也可能值得一看。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-11-20T08:52:00.373

当我们每个版本只需要升级一次时，下一个简短的解决方案对我有用。它*不需要*额外的设置，例如`UpgradeRequired`：

```
if (!ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.PerUserRoamingAndLocal).HasFile)
    Settings.Default.Upgrade(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-03-13T01:01:01.190

我知道已经有一段时间了......在winforms应用程序中，只需`My.Settings.Upgrade()`在加载它们之前调用。这将获得最新的设置，无论是当前版本还是以前的版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-04-13T15:48:33.313

这是我的研究，以防其他人在迁移已更改/删除的设置时遇到困难。基本问题是，`GetPreviousVersion()`如果您在新版本的应用程序中重命名或删除了设置，这将不起作用。因此，您需要将设置保留在您的`Settings`类中，但添加一些属性/工件，这样您就不会无意中在其他地方的代码中使用它，使其过时。VB.NET 中的示例过时设置如下所示（可以轻松转换为 C#）：

```
<UserScopedSetting(),
DebuggerNonUserCode(),
DefaultSettingValue(""),
Obsolete("Do not use this property for any purpose. Use YOUR_NEW_SETTING_NAME instead."),
NoSettingsVersionUpgrade()>
Public Property OldSettingName() As String
  Get
    Throw New NotSupportedException("This property is obsolete")
  End Get
  Set
    Throw New NotSupportedException("This property is obsolete")
  End Set
End Property 
```

确保将此属性添加到具有应用程序设置的同一名称空间/类中。在 VB.NET 中，这个类被命名`MySettings`并且在`My`命名空间中可用。您可以使用部分类功能来防止过时的设置与当前设置混淆。

完全归功于 jsharrison 发表了一篇关于这个问题的[优秀文章。](http://www.codeproject.com/Articles/247333/Renaming-User-Settings-properties-between-software)您可以在此处阅读有关它的更多详细信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-21T07:06:38.173

这是此处介绍的解决方案的一种变体，它将升级逻辑封装到设置类可以从中派生的抽象类中。

一些建议的解决方案使用 DefaultSettingsValue 属性来指定一个值，该值指示何时未加载先前的设置。我的偏好是简单地使用默认值表明这一点的类型。作为奖励，日期时间？是有用的调试信息。

```
public abstract class UserSettingsBase : ApplicationSettingsBase
{
    public UserSettingsBase() : base()
    {
        // Accessing a property attempts to load the settings for this assembly version
        // If LastSaved has no value (default) an upgrade might be needed
        if (LastSaved == null)
        {
            Upgrade();
        }
    }

    [UserScopedSetting]
    public DateTime? LastSaved
    {
        get { return (DateTime?)this[nameof(LastSaved)]; }
        private set { this[nameof(LastSaved)] = value; }
    }

    public override void Save()
    {
        LastSaved = DateTime.Now;
        base.Save();
    }
} 
```

派生自 UserSettingsBase：

```
public class MySettings : UserSettingsBase
{
    [UserScopedSetting]
    public string SomeSetting
    {
        get { return (string)this[nameof(SomeSetting)]; }
        set { this[nameof(SomeSetting)] = value; }
    }

    public MySettings() : base() { }
} 
```

并使用它：

```
// Existing settings are loaded and upgraded if needed
MySettings settings = new MySettings();
...
settings.SomeSetting = "SomeValue";
...
settings.Save(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T21:42:10.163

如果您对 user.settings 的更改是以编程方式完成的，那么如何在单独的文件（例如 user.customized.settings）中维护（仅）对 user.settings 的修改的副本？

您可能还想在 user.settings 中维护和加载修改后的设置。但是这样，当您使用更新版本的 user.settings 安装应用程序的更新版本时，您可以通过将修改后的设置复制回新的 user.settings 来询问用户是否要继续使用修改后的设置。您可以批量导入它们，或者更高级地要求用户确认他们想要继续使用哪些设置。

*编辑：我在“更准确”的部分上读得太快了关于程序集版本导致新的 user.settings 安装到新版本特定的目录中。因此，上面的想法可能对您没有帮助，但可能会提供一些思考。*

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-11T15:46:33.010

我是这样处理的：

```
public virtual void LoadSettings(ServiceFileFormBaseSettings settings = null, bool resetSettingsToDefaults = false)
{
    if (settings == null)
            return;

    if (resetSettingsToDefaults)
        settings.Reset();
    else
    {
        settings.Reload();

        if (settings.IsDefault)
            settings.Upgrade();
    }

    this.Size = settings.FormSize; 
```

}

在设置类中，我定义了 IsDefault 属性：

```
// SaveSettings always sets this to be FALSE.
// This will have the default value TRUE when first deployed, or immediately after an upgrade.
// When the settings exist, this is false.
//
[UserScopedSettingAttribute()]
[DefaultSettingValueAttribute("true")]
public virtual bool IsDefault
{
    get { return (bool)this["IsDefault"]; }
    set { this["IsDefault"] = value; }
} 
```

在 SaveSettings 中，我将 IsDefault 设置为 false：

```
public virtual void SaveSettings(ServiceFileFormBaseSettings settings = null)
{
    if (settings == null) // ignore calls from this base form, if any
        return;

    settings.IsDefault = false;
    settings.FormSize = this.Size;
    settings.Save();
} 
```

# build-automation - 您正在使用哪些自动化构建系统？你的构建需要多长时间？

> ID：534273
> 
> 赞同：3
> 
> 时间：2009-02-10T21:24:18.457
> 
> 标签：build-automation, automated-tests

我当前的项目有 5 个独立的自动化构建，每次签入后都会启动：
单元测试（模拟数据库调用）：~6 分钟
集成测试（仅针对数据库）：~40 分钟
网站 1 UI（Selenium，从 UI 到DB）：~80 分钟
网站 2 UI1（Selenium，从 UI 到 DB）：~90 分钟
网站 2 UI2（Selenium，从 UI 到 DB）：~100 分钟

我们正在使用 Maven2、JUnit 和 Selenium。

我认为将大大减少集成测试时间的一种策略是将尽可能多的集成测试转移到单元测试中，并简单地使用集成项目来测试数据库的持久性。

我想知道您发现哪些策略有助于减少大型项目的构建时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T21:28:20.460

我们的构建运行时间几乎相同，在 selenium 上可能略少（我会说大约 3x50 分钟的运行时间，在 firefox 上进行相同的站点测试，即和 opera）。我们的解决方案是投入更多的 cpu，我们有一个总共 7 个双核节点的集群[竹环境。](http://www.atlassian.com/software/bamboo/)

我们发现，在与 web-container/selenium 测试不同的盒子上运行 selenium-rc 和浏览器可以显着改善 selenium 运行时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T21:30:31.563

我正在使用[GNU make](http://www.gnu.org/software/make/)来自动化一切。视项目而定，需要 2 分钟到 30 分钟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T21:29:15.967

团队系统：一切都在 1 小时内

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T21:30:26.633

我假设您的项目由几个子项目组成。如果没有，您可能需要重构代码库以便它可以做到。通过这种方式，您可以选择仅构建整个应用程序的特定部分，测试单个部分，然后在解决您正在处理的子项目上的错误时运行您的集成测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T21:32:59.733

我们使用 Hudson 构建了一个包含少量 Windows 服务、Web 服务和可执行文件的大型 C# 解决方案。通过 MSTest.exe 进行大约 800 次左右的测试，每次构建大约需要 12-15 分钟。由于 MSTest 很慢，因此测试占了很大一部分。

为了减少时间，我们试图限制通过 MSTest 运行的程序集的数量，因为设置和拆卸似乎需要一段时间。

编辑：我们的构建还部署到我们的证书环境，其中包括 Web 服务、Windows 服务、可执行文件和数据库部署。只是为了让您了解范围

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T21:48:04.000

Erlang Common Test - 主要关注系统测试而不是单元测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T22:36:03.730

我们所有的自动化构建都是使用 Team City 完成的。

我们使用的最自动化的项目实际上是一个编译器。我们的测试套件包含大约 20000 个已编译和运行的测试查询，这些查询在每次签入时运行。这通常需要一个小时的时间，但是将完整的测试套件保存在构建机器上的 RAM 驱动器中（而不是每次都检查出来）将其减少到几分钟。

每天晚上触发第二次构建，运行这些相同的测试，但在 4 个不同的配置文件下，同时在 NCover 下运行，生成代码覆盖率报告。这个场景需要几个小时，这就是为什么它是作为夜间构建完成的。同时生成其他内部报告，以确保一切正常。

对测试套件本身的更新是单独触发的，并检出到 RAM 驱动器，为下一次运行做好准备。否则，检查测试会占用大部分构建时间。部分测试套件来自我们无法控制的远程 CVS 存储库，甚至在构建时间中查询更新会增加几分钟，因此这也在“更新测试”构建中完成。这种松散的耦合意味着我们不得不将这个项目的构建限制在一台机器上，但由于反馈如此之快，这不是一个大问题。

事实证明，在保持代码库的高覆盖率的同时尽可能快地保持“常规”测试构建非常有帮助。任何缓慢的测试（超过一秒左右）都已通过夜间构建。在我们的案例中，将测试保存在 RAM 驱动器中确实很有帮助，尽管我们的场景相当专业。我想模拟你的数据库是最接近的等价物。我的建议是通过删除任何“笨拙”或缓慢的测试来保持一个构建“精简和平均”，让快速响应知道您可能没有破坏任何东西。其他构建可以在单独的机器上运行，也可以在晚上运行，以保持快速构建的快速响应。

从角度来看，我们（对于另一个项目）最长的自动化构建有时需要一天以上的时间，尽管幸运的是它不需要定期运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T01:42:53.453

不幸的是，在我当前的客户 BuildForge（来自 ClearCase SCC）：从一到三天不等。严重。我真的不知道他们在构建中做了什么，也不知道为什么要花这么长时间。

# c# - 原始类型的最优序列化

> ID：534274
> 
> 赞同：6
> 
> 时间：2009-02-10T21:24:45.930
> 
> 标签：c#, serialization

我们开始为我们的产品推出越来越多的 WAN 部署（带有 IIS 托管远程处理后端的 .NET 胖客户端）。正因为如此，我们正在尝试减少网络上数据的大小。

我们通过实现 ISerializable（类似于[this](http://www.codeproject.com/KB/cs/FastSerialization.aspx)）覆盖了默认序列化，我们看到了 12% 到 50% 的增益。我们的大部分工作都集中在优化原始类型的数组上。**有没有一种奇特的方式来序列化原始类型，而不是显而易见的？**

例如，今天我们序列化一个 int 数组，如下所示：

> [4 字节（数组长度）][4 字节][4 字节]

任何人都可以做得更好吗？

对于布尔数组，最明显的显着改进示例是在每个字节中放置 8 个布尔值，我们已经这样做了。

注意：*每个 bool 节省 7 位似乎是浪费时间，但是当您处理大量数据（我们就是这样）时，它加起来非常快。*

注意：我们希望避免使用通用压缩算法，因为它存在延迟。远程处理仅支持缓冲的请求/响应（无分块编码）。我意识到压缩和最佳序列化之间有一条细线，但我们的测试表明我们可以以非常小的延迟成本提供非常具体的序列化优化。而将整个缓冲响应重新处理为新的压缩缓冲区太昂贵了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T22:40:43.143

（与消息/类有关，而不仅仅是原语）

谷歌为这种类型的场景设计了“协议缓冲区”（它们转移了大量数据）——它们的格式紧凑（使用 base-128 编码之类的东西）但可扩展且版本容错（因此客户端和服务器可以轻松升级）。

在 .NET 世界中，我可以推荐 2 个协议缓冲区实现：

*   [protobuf-net](http://code.google.com/p/protobuf-net/)（由我）
*   [dotnet-protobufs](http://github.com/jskeet/dotnet-protobufs/tree/master)（由 Jon Skeet 编写）

对于信息，protobuf-net 直接支持`ISerializable`和远程处理（它是[单元测试](http://code.google.com/p/protobuf-net/source/browse/trunk/Examples/Remoting/RemotingDemo.cs)的一部分）。[这里](http://code.google.com/p/protobuf-net/wiki/Performance)有性能/大小指标。

最重要的是，您所做的只是为您的类添加一些属性。

警告：它并没有声称是理论上**最好**的——但实用且易于正确——性能、可移植性和简单性之间的折衷。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T21:33:03.197

查看 Google 协议缓冲区中使用的[base-128 varint](http://code.google.com/apis/protocolbuffers/docs/encoding.html#varints)类型；这可能就是你要找的。

（如果您搜索网络，则有许多可用的协议缓冲区的 .NET 实现，根据它们的许可证，您可能可以从中获得一些代码！）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-10T18:42:09.750

是的，有一种序列化原始类型的奇特方式。作为奖励，它也更快（通常为 20-40 倍）。

Simon Hewitt 的开源库（参见*[Optimizing Serialization in .NET - part 2](https://www.codeproject.com/Articles/16017/Optimizing-Serialization-in-NET-part)*）使用了各种技巧。例如，如果已知数组包含小整数，则序列化输出将更少。这[在文章的第 1 部分](https://www.codeproject.com/kb/dotnet/fastserializer.aspx)中有详细描述。例如：

> ...因此，小于 128 的 Int32 可以存储在单个字节中（通过使用 7 位编码）...。

完整的和大小优化的整数可以混合和匹配。这似乎很明显，但还有其他事情；例如，整数值 0 会发生特殊情况 - 优化以存储数字类型和零值。

第 1 部分指出：

> ... 如果您曾经使用 .NET 远程处理大量数据，您会发现可伸缩性存在问题。对于少量数据，它运行良好，但大量数据会占用大量 CPU 和内存，**生成大量数据进行传输**，并且可能会因内存不足异常而失败。实际执行序列化所花费的时间还有一个大问题 - 大量数据可能使其无法在应用程序中使用......

[我在我的应用程序](http://msquant.sourceforge.net/)中成功地使用了这个库。

为了确保永远不会使用 .NET 序列化 ，请在库代码中依赖 .NET 序列化的位置放置一个`ASSERT 0`,或类似的位置。`Debug.WriteLine()`那是`WriteObject()`file 中函数的末尾 `FastSerializer.cs`， near `createBinaryFormatter().Serialize(BaseStream, value);`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T21:40:07.610

如果您的数组可以排序，您可以执行简单的 RLE 以节省空间。即使它们没有排序，RLE 仍然是有益的。写和读都可以快速实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T21:49:19.163

这是我曾经用来编码整数数组的一个技巧：

1.  以 4 个为一组对数组元素进行分组。
2.  在每个组之前加上一个字节（我们称之为长度掩码），指示以下 4 个元素的长度。长度掩码是由双位组成的位掩码，指示相应元素的长度（00 - 1 字节，01 - 2 字节，10 - 3 字节，11 - 4 字节）。
3.  尽可能短地写出元素。

例如，要表示无符号整数 0x0000017B、0x000000A9、0xC247E8AD 和 0x00032A64，您可以编写（假设为小端）：B1、7B、01、A9、AD、E8、47、C2、64、2A、03。

在最好的情况下，它可以为您节省高达 68.75% (11/16) 的空间。在最坏的情况下，您实际上会浪费额外的 6.25% (1/16)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T21:33:29.357

如果您知道哪些 int 值更常见，则可以用更少的位对这些值进行编码（并使用相应的更多位对不太常见的值进行编码）：这称为“霍夫曼”编码/编码/压缩。

一般来说，尽管我建议您可以做的最简单的事情之一是对您的数据运行标准的“zip”或“压缩”实用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T21:35:09.633

对于整数，如果您通常有小数字（低于 127 或 32768），您可以使用 MSB 作为标志对数字进行编码，以确定它是否是最后一个字节。有点类似于 UTF-8 但实际上浪费了标志位（UTF-8 不是这种情况）

示例（**大端**）：

```
125 which is usually encoded as 00 00 00 7D
Could be encoded as 7D

270 which is usually encoded as 00 00 01 0E
Could be encoded as 82 0E 
```

主要限制是 32 位值的有效范围减少到 28 位。但是对于较小的值，您通常会获得很多。

这种方法实际上用于 MIDI 等旧格式，因为旧电子设备需要非常高效和简单的编码技术。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-19T17:49:17.333

如果您想自己控制序列化格式，只需借助库帮助进行紧凑型整数存储，请从[BinaryWriter](https://msdn.microsoft.com/en-us/library/System.IO.BinaryWriter)派生一个使用[Write7BitEncodedInt](https://msdn.microsoft.com/en-us/library/system.io.binarywriter.write7bitencodedint)的类。[对BinaryReader.Read7BitEncodedInt](https://msdn.microsoft.com/en-us/library/system.io.binaryreader.read7bitencodedint)做同样的事情。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-10T21:35:45.140

在自己实现 ISerializable 之前，您可能在 Web 服务中使用 XmlSerializer 或 SOAP 格式化程序。鉴于您的所有胖客户端都运行 .NET，您可以尝试使用 BinaryFormatter。

# graphics - .NET 中的非仿射图像转换

> ID：534297
> 
> 赞同：7
> 
> 时间：2009-02-10T21:31:20.063
> 
> 标签：graphics, gdi+, image-manipulation

.NET 库中是否有任何类、方法或任何一般算法来执行非[仿射](http://en.wikipedia.org/wiki/Affine_transformation)转换？（即不仅仅涉及旋转、缩放、平移和剪切的变换）

例如：

[![替代文字](https://i.stack.imgur.com/dZWsQ.png)](https://i.stack.imgur.com/dZWsQ.png)

[![替代文字](https://i.stack.imgur.com/U9vpM.jpg)](https://i.stack.imgur.com/U9vpM.jpg)
[（来源：[last100.com](http://www.last100.com/wp-content/uploads/2008/01/iphone-maps.jpg)）]

* * *

[非仿射变换](http://www.google.com/search?q=non-affine+transformation)还有其他术语吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T22:07:29.633

我不知道 .Net 中集成的任何东西可以让您进行非仿射变换。

我猜您正在尝试进行某种 3D 纹理映射？如果是这种情况，您需要一个同质仿射变换，这在 .Net 中不可用。我也不知道在.Net 中进行像素位移变换的任何集成方法。

但是，当前投票的解决方案可能对您正在尝试做的事情有好处，请注意它不会开箱即用地进行透视校正。

例如：

![替代文字](https://i19.photobucket.com/albums/b193/Coincoin/perspective-correction.png)

左图是使用 Neil N 提供的单四边形扭曲库生成的。右图是使用 DirectX 中的单四边形（实际上是两个三角形）生成的。

这可能对您尝试做的事情没有任何影响，但是如果您想做 3D 的东西，请记住这一点，如果没有透视正确的映射，它看起来会很奇怪。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T21:50:20.453

您发布的所有示例图像都可以使用四边形扭曲来完成。虽然我不能肯定地说四边形失真会覆盖所有非仿射变换。

这是一个在 C# 中不太好的实现的链接......它可以工作，但速度很慢。浏览 Wikipedia，了解可用于此类计算的许多不同优化

[http://www.vcskicks.com/image-distortion.html](http://www.vcskicks.com/image-distortion.html)

-尼尔

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-27T05:02:30.030

您可以使用 Viewport3d 控件和非仿射变换矩阵在 wpf 中执行此操作。再次将其渲染到位图可能会很有趣....我通过包含一个不可见的 <image> 控件来“修复”它，该控件与我的纹理平面上的图像相同...（另外，我必须解决最大值通过分割平面和裁剪图像来解决纹理大小问题......）

[http://www.charlespetzold.com/blog/2007/08/060605.html](http://www.charlespetzold.com/blog/2007/08/060605.html)

在我的情况下，我想要这个的相反（将扭曲上的任意点转换为我的矩形窗口的角），这是矩阵的逆来做相反的事情。

# jquery - .getJSON 生成文件 ASP.NET MVC 的下载

> ID：534300
> 
> 赞同：1
> 
> 时间：2009-02-10T21:32:18.003
> 
> 标签：jquery, asp.net-mvc, ajax

我编写了一个 .getJSon，它完成了这项工作，但我让 IE 要求下载文件。这是代码

```
<script type="text/javascript">
$(function() {
    $('#id').click(function() {
        var dateReport = "01/01/2009";

        $.getJSON('/Report/SendReport', { date: dateReport},
                function(response) {
                    if (response.result == "OK") {
                        $('#OKSendReport').toggle();
                        $('#OKSendReport').html("OK");
                    }
                });
    });
}); 
```

控制器中的代码是

```
 public ActionResult SendReport(string date) {
        //DO Stuff

        return new JsonResult {
            Data = new { result = "OK" }
        };
    } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T21:49:22.453

尝试添加`event.preventDefault();`点击事件：

```
$(function() {
    $('#id').click(function(event) {
        var dateReport = "01/01/2009";

        event.preventDefault(); // added this

        $.getJSON('/Report/SendReport', { date: dateReport},
                function(response) {
                    if (response.result == "OK") {
                        $('#OKSendReport').toggle();
                        $('#OKSendReport').html("OK");
                    }
                });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T21:49:55.027

嗯，您确定在该实例中触发了 Javascript 吗？#ID 是什么 HTML 类型？如果 JavaScript 没有被调用并且你的控制器试图路由到 json 结果，我认为这可能是你的问题。

# emacs - 为每个缓冲区/模式设置 Emacs 默认字体

> ID：534307
> 
> 赞同：38
> 
> 时间：2009-02-10T21:33:38.793
> 
> 标签：emacs, fonts, themes, emacs-faces, font-lock

如何更改 Emacs 用于基于每个模式设置文本样式的默认面？

例如，假设我已经对我拥有的面部自定义感到满意，其中包括默认的固定宽度字体。但是，在一种特定模式下（`markdown-mode.el`例如），我希望默认字体为可变宽度。

为 markdown 模式设置独特的标题、链接等样式很容易：只需将光标放在样式化的文本和`M-x describe-face`上，然后单击链接即可对其进行自定义。

但是，如果没有指定其他面，则默认面是使用的面，因此它不是特定于 markdown-mode，如果修改将影响所有其他模式。

`markdown-mode-hook`使用此模式设置缓冲区的默认面时，我可以使用什么魔法？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-11T00:37:47.650

像这样的东西怎么样：

```
(add-hook 'markdown-mode-hook (lambda () (variable-pitch-mode t)) 
```

然后您可以自定义`variable-pitch`人脸，缓冲区中的其他人脸将继承此人脸，而不是默认人脸。

阅读文档了解`buffer-face-mode`更多自定义细节。（BufFace 也用于`text-scale-increase`和`text-scale-decrease`...非常有用。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-11T09:39:42.420

我必须给出部分答案，因为这太复杂而无法当场弄清楚，而且我已经超出了我的时间预算。

面是框架属性。一帧可以同时显示多个缓冲区。模式是一个缓冲区属性。您询问如何在每种模式的基础上改变面部。结合所有这些，似乎这个问题不可能没有一个完全正确的答案。

如果您假设给定的帧永远不会显示多个缓冲区，则可以近似得到所需的答案。您实际上可以使用类似这样的方法来完成此操作，但修改为使用特殊显示正则表达式和一组与您的降价模式缓冲区名称匹配的正则表达式。

```
(append special-display-buffer-names
        '("*VC-log*"
          "*Help*"
          ("*Completions*" 
           (height . 25)
           (font . "8x13")))) 
```

但是，这可能不是您想要的。您的问题似乎暗示改变单个框架的面部属性。

再次假设一帧一次不会显示多个缓冲区，您可以尝试建议切换到缓冲区。但这可能还不够低，而且可能太慢了。（未经测试）

```
(defadvice switch-to-buffer (after switch-to-buffer activate compile)
  "change the frame's default face after switch-to-buffer"
  (doSomethingToChangePropertiesOfDefaultFace)) 
```

现在对于我的实际（不完整）答案......

一种更好但更复杂的方法将指示 markdown-mode 为尚未分配内置面之一的所有区域使用新面。您可以使用 copy-face 创建一个新面孔，并使用 set-face-* 为其赋予有趣的属性。

修改 markdown-mode 的 font-lock-defaults 以覆盖默认的 font-lock-fontify-region-function，如 font-lock.el 的第 946 行附近的注释块中所述，开头为“Fontification functions”。您可能可以使用一个非常轻微修改的 font-lock-default-fontify-region ，它在它之后立即执行一个额外的步骤：

```
 (unless font-lock-keywords-only
    (font-lock-fontify-syntactically-region beg end loudly)) 
```

额外的步骤解析区域类似于 font-lock-fontify-syntactically-region 所做的，将区域分解为“有趣的”子区域。但是这一次您会找到具有默认面的子区域，然后将这些子区域设置为您之前创建的新面。

总而言之，你的 .emacs 文件中应该只有几行 elisp，再加上与原始文件只有微小差异的 font-lock-default-fontify-region 的副本（调用一个新函数），加上复制 font-lock-fontify-syntactically-region 并修改它以进行您的竞标（最困难的部分）。

实际上，如果您“之后”建议 font-lock-fontify-syntactically-region 那么您可能甚至不需要修改 font-lock-defaults 或 font-lock-default-fontify-region。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-09-20T22:34:23.293

`variable-pitch`-mode 很棒。我通过这个线程发现了它。但它可以变得更棒：

```
(dolist (hook '(erc-mode-hook
        LaTeX-mode-hook
        org-mode-hook
        edit-server-start-hook
        markdown-mode-hook))
  (add-hook hook (lambda () (variable-pitch-mode t)))) 
```

只需将您想要无衬线字体的任何模式添加到列表中即可。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-05-24T06:02:26.297

有一段代码我觉得非常方便，来自 EmacsWiki。这样做的好处是不仅可以设置字体，还可以方便地进行配置`:height`等`:width`

```
;; Use variable width font faces in current buffer
(defun my-buffer-face-mode-variable ()
  "Set font to a variable width (proportional) fonts in current buffer"
  (interactive)
  (setq buffer-face-mode-face '(:family "DejaVu Sans" :height 100 :width semi-condensed))
  (buffer-face-mode))
;; Use monospaced font faces in current buffer
(defun my-buffer-face-mode-fixed ()
  "Sets a fixed width (monospace) font in current buffer"
  (interactive)
  (setq buffer-face-mode-face '(:family "Consolas" :height 100))
  (buffer-face-mode))
;; Set default font faces for Info and ERC modes
(add-hook 'erc-mode-hook 'my-buffer-face-mode-variable)
(add-hook 'Info-mode-hook 'my-buffer-face-mode-variable) 
```

结合`load-theme-buffer-local`包，您甚至可以轻松地为缓冲区指定颜色主题：

```
(defun my-buffer-face-mode-variable ()
  "Set font to a variable width (proportional) fonts in current buffer"
  (interactive)
  (setq buffer-face-mode-face '(:family "DejaVu Sans" :height 100 :width semi-condensed))
  (buffer-face-mode)
  (load-theme-buffer-local 'leuven (current-buffer))) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-13T22:21:51.337

即使对于 emacs 版本 22.3.1，它实际上也很简单......

只需尝试以下操作：

```
(progn 
  (set-buffer "your buffer name here")
  (overlay-put (make-overlay 0 (buffer-size)) 'face 'your-face)) 
```

# git - 你如何设置 Hudson 来使用 Git？

> ID：534308
> 
> 赞同：12
> 
> 时间：2009-02-10T21:34:05.690
> 
> 标签：git, continuous-integration, hudson

我正在尝试将 Hudson 设置为 CI 服务器，但我无法让一切正常工作。我正在尝试使用“官方”git 插件。我还没有对 stephenh 开发的备用插件进行任何测试。

我想知道是否有其他人让 Hudson 使用 Git 或任何 CI 服务器使用 Git。如果是这样，如何以及使用什么配置。

相关信息是我在 Hudson 1.277 上，我正在使用 Git 1.6.1.1.230.gdfb04 和 Git Plugin 0.5，都在 windows 平台上。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-07-05T19:23:41.630

随着即将到来的2.1。发布 Hudson 会将 git 插件作为默认安装的一部分。即使是现在，git 插件也像魅力一样工作。

简而言之，您在全局配置中配置 git 安装，然后在项目配置中指定 repo url 和分支。

查看 Hudson 的书以获取有关如何配置事物等的更多信息。

[http://www.simpligility.com/2011/06/hudson-book-changes-and-community/](http://www.simpligility.com/2011/06/hudson-book-changes-and-community/)

更新：这本书现在可以在[http://wiki.eclipse.org/The_Hudson_Book](http://wiki.eclipse.org/The_Hudson_Book)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T14:26:31.407

[用于 Hudson 结帐问题的 Git 插件](https://stackoverflow.com/questions/499316/git-plugin-for-hudson-checkout-problem)

在我的旅行中发现它，认为它可能会帮助你

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-10T13:52:43.853

我在 Linux 上使用 Hudson git plugin 0.5 的经验非常积极。它工作得很好。

我在 Windows 上使用 Hudson git plugin 0.5 的经验一直是负面的。我遇到了 Hudson[错误 2762](https://hudson.dev.java.net/issues/show_bug.cgi?id=2762)，“/ 已添加到克隆目标的路径，Windows 不会克隆到该目标”

当我从 stephenh（在 Windows 上）切换到 Hudson git plugin pre-release 0.6 时，我能够在带有 Hudson 的 Windows 上使用 git。

[在kernel trap](http://kerneltrap.org/index.php?q=mailarchive/git/2008/12/23/4478444/thread)中提到了 Stephen Haberman 的改进。我确认他的 target/git.hpi 在我的 Hudson 版本 1.290 安装中工作。我相信它位于[http://github.com/stephenh/hudson-git2/](http://github.com/stephenh/hudson-git2/)

当 Hudson 1.290 开始使用 Stephen 的插件时，有一个令人惊讶的消息。哈德森报道：

```
2009 年 3 月 10 日上午 7:57:36 hudson.util.RobustReflectionConverter doUnmarshal
警告：无法将 hudson.util.DescribableList 类型转换为 hudson.model.Hudson$CloudList 类型
2009 年 3 月 10 日上午 7:57:36 hudson.util.RobustReflectionConverter doUnmarshal
警告：跳过不存在的字段存储库
com.thoughtworks.xstream.converters.reflection.NonExistentFieldException：没有这样的字段 hudson.plugins.git.GitSCM.repositories

```

但是，即使有这些消息，我仍然能够克隆我的存储库。我还没有进行详细的测试，但初步结果看起来很有希望。

# wpf - WPF 编辑蒙版

> ID：534326
> 
> 赞同：9
> 
> 时间：2009-02-10T21:38:06.910
> 
> 标签：wpf, wpf-controls

在 WPF 中为简单文本框指定编辑掩码的最简单方法是什么？

例如，在您键入时将 10000 转换为 10,000。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T00:08:05.617

简短的回答，没有简单的方法。如果您经常使用遮罩，我建议您使用遮罩功能创建您自己的控件。使用 MaskedTextProvider 类应该相当简单。

有关具有屏蔽功能的自定义 TextBox 的示例，请参见以下内容：

[蒙面文本框示例...](http://marlongrech.wordpress.com/2007/10/28/masked-textbox/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T21:56:59.020

最简单和最直接的方法可能只是获取 TextChanged 事件并执行您需要的任何处理。

例如... [http://karlhulme.wordpress.com/2007/02/15/masking-input-to-a-wpf-textbox/](http://karlhulme.wordpress.com/2007/02/15/masking-input-to-a-wpf-textbox/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T19:57:33.453

您是否查看过用于 WPF 的 Xceed DataGrid Express。它是免费的，并提供了一个蒙版的文本框控件，可以非常简单地执行您想要的操作。

不再提供用于 WPF 的 xceed Datagrid Express 版本。

# function - 深思熟虑的方法/函数名称是否创建了 DSL？

> ID：534329
> 
> 赞同：1
> 
> 时间：2009-02-10T21:38:24.523
> 
> 标签：function, methods, dsl

我在想，方法名称和它们的调用似乎在你的代码中创建了一个 DSL，通过包装通用的东西并为你想要实现的目标适当地命名它。

你知道，所以很容易推断出下面的意思

```
if (a.isSubReportOf(b) || b.isSubReportOf(a)) {
    // do stuff
} 
```

但是如果不研究它，方法中的代码可能真的很难解释。

我知道人们有时会认为整个 DSL 有什么特别之处——我们是否一直在代码中创建它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T21:51:09.313

我认为您指的是 Martin Fowler（也许还有其他人）所说的内部 DSL。读[这个](http://www.martinfowler.com/bliki/DomainSpecificLanguage.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T21:43:56.990

您可以交替询问是否应将 DSL 替换为经过深思熟虑的类、变量和方法名称。我总是把这与 Kent Beck 联系起来，因为他一直是“编写读起来像诗一样的代码”的支持者。

您*正在*发明领域词汇，将业务操作的语法制作成对象、方法和变量。对我来说听起来 DSL'ish ;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T21:45:09.703

这取决于您对 DSL 的定义，但对我来说，是的，我会这么说。DDD 是关于创建抽象的，它允许您拥有一种无处不在的语言并在更高级别上对概念进行推理。有些人可能会争辩说它本身不是 DSL，但更重要的问题是，像这样的代码是关于域的推理吗？

我会说是的，这才是真正重要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T21:51:09.563

你能在足够复杂或简单的情况下一个接一个地替换吗？是的

他们是一样的吗？一点也不。

每个都有优点和缺点，这完全取决于需要什么。如果您需要在运行时对其进行修改，那么在编译语言中使用函数可能不是最好的解决方案（尽管它仍然是可能的），因为它对于您的需求来说太重了。

DSL 的目标是确定您的需求并制作一种仅包含这些需求的语言，以便尽可能简单地表示。这样，我们有限的大脑可以轻松地描绘出数据是什么，而无需编译程序。

此外，一个足够简单的 DSL 可以很容易地被另一个程序解析和编辑。毕竟，您制作了语法，并将其封装在库中，对吧？

在上面的示例中：

```
a.isSubReportOf(b) || b.isSubReportOf(a) 
```

还是比说：

```
a <-> b 
```

# grails - 在 Grails 中读取 g:datePicker 值而不使用“new Object(params)”方法

> ID：534330
> 
> 赞同：3
> 
> 时间：2009-02-10T21:38:45.210
> 
> 标签：grails, datepicker, gsp, taglib

假设我有一个名为“foobar”的 datePicker：

```
<g:datePicker name="foobar" value="${new Date()}" precision="day" /> 
```

如何读取此日期选择器的提交值？

一种有效但有一些不需要的副作用的方法如下：

```
def newObject = new SomeClassName(params)
println "value=" + newObject.foobar 
```

这种方式将所有提交的字段读取到 newObject 中，这是我想要避免的。我只对“foobar”字段的值感兴趣。

我最初认为可以做到这一点的方式是：

```
def newObject = new SomeClassName()
newObject.foobar = params["foobar"] 
```

但 Grails 似乎不会自动将 foobar 字段转换为 Date() 对象。

**更新：**可以在[Grails JIRA](http://jira.codehaus.org/browse/GRAILS-3740)中找到更多信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T02:26:20.650

使用[命令对象](http://grails.org/Command+objects+and+Form+Validation)习语。在您的示例中，我将假设您的表单调用 action `handleDate`。控制器内部：

```
 def handleDate = { FoobarDateCommand dateCommand ->
    def theNextDay = dateCommand.foobar + 1
} 
```

这是`FoobarDateCommand`. 请注意您如何将字段命名为与视图中相同的名称：

```
 class FoobarDateCommand { 
    Date foobar 
} 
```

命令对象是封装每个表单的所有验证任务的便捷方式，使您的控制器保持美观和小巧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-26T23:50:01.123

在 Grails 1.2 中读取 g:datePicker 值变得容易得多（请参阅[发行说明](http://www.grails.org/1.2+Release+Notes)）：

> **更好的日期解析**
> 
> 如果您从标签提交日期，现在获取 Date 对象就像从 params 对象中按名称查找一样简单（例如 params.foo ）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T09:30:24.827

当一个参数说是一个“结构”时，这意味着有许多参数来表示它的值。在您的情况下，有：

*   params["foobar_year" 存储年份
*   params["foobar_month"] 存储月份
*   params["foobar_day"] 存储日

只需将它们取出并做任何你想做的事情:)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-11T00:51:27.617

你仍然需要知道格式

```
def newObject = new SomeClassName()
newObject.foobar = Date.parse('yyyy-MM-dd', params.foobar) 
```

# php - 处理日期

> ID：534334
> 
> 赞同：1
> 
> 时间：2009-02-10T21:40:42.037
> 
> 标签：php, mysql, date

所以基本上我将一堆日历事件存储在一个 mysql 表中。我存储了它们应该发生的星期几以及时间。现在，时间存储为从 GMT 计算的午夜开始的秒数。但是，当我让人们登录并检查日历并且他们来自 GMT 以外的不同时区时，我在计算哪些事件在他们的时区的一天之内时遇到了问题。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T03:06:05.157

在处理时区时，您**不想**自己进行偏移计算，尤其是在处理小于 1 天的时间单位时。一个简单的原因：夏令时。

MySQL 和 PHP 都有许多用于操作日期的日期/时间函数。他们知道夏令时和其他移动日期和时间的怪癖。如果您尝试手动解决解决方案，他们会比您更频繁地正确解决问题。至少，使用（或创建）一个包含时区的日期对象。不幸的是，PHP 函数可能有点棘手并且没有很好的文档记录，但所有功能都在那里。您仍然可以使用 unix 时间戳作为您的“规范”格式，但所有使用它的代码都必须知道或理解它“在”哪个时区。

在过去的工作中，我必须处理学校时间表并将该格式（学期、周、日、期间...）与实际日期进行转换。我们构建了一个对象，可以按需进行任何必要的转换并缓存结果。这是一项努力，但是让 PHP 日期函数完成*所有*转换和调整可以避免很多时区和夏令时问题。

日历的另一个警告：您可能必须区分*事件*的时区和*用户*的时区。以及当事件的时区保持固定以及它们随用户移动时。未能处理所有细微差别是 Exchange/Outlook 中的日历仍然存在夏令时更改问题的原因。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T21:44:46.397

这里有[许多](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)可以帮助你的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T21:50:00.160

您可以在进行比较之前将其时区中的当前日期转换为 GMT（不一定在 MySQL 中，但您可以为此使用[CONVERT_TZ ）。](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_convert-tz)

至于找到他们的时区，防弹方法可能是询问用户并保存他的选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T21:51:02.823

我会存储事件的 unix 时间戳，并使用 PHP 中的时间函数来计算正确的显示。这使得数据库数据独立于您实际所在的时区。用户仍然需要提供他所在的时区。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T22:42:22.217

使用数据库的日期时间数据类型并使用数据库的日期/时间函数。PHP 函数相当有限，如果您处理的是真实日期，则不应简单地将时间视为整数*。*一个好的策略是将所有日期时间存储在 UTC 中，然后您可以为该位置添加一个附加字段（例如本地时区偏移量），如果这是相关的。不过，通常情况下，相关的是*观众*时区，而不是提供数据的时区（感到困惑吗？）

# firefox - 布尔 Javascript 表达式在 Firebug Watch 窗口中返回 true，但在代码中返回 false？

> ID：534337
> 
> 赞同：1
> 
> 时间：2009-02-10T21:41:39.900
> 
> 标签：firefox, firebug, boolean-logic, watch

我有一个名为“objFrame”的 IFrame 网页。

在 Javascript 文件中，执行以下语句：

var useWindow = (typeof(window.objFrame) != "undefined" && typeof(window.objFrame.contentWindow) != "undefined");

运行代码时（通常或使用调试器单步执行），表达式

(typeof(window.objFrame) != "undefined" && typeof(window.objFrame.contentWindow) != "undefined")

当我将它粘贴到 Firebug 的 Watch 窗口中时为 true，但 useWindow 的值为 false。

我正在使用 Firefox 3.0.6 和 Firebug 1.3.2。

我在这里想念什么？请告诉我这是我的一个简单的语法错误（？！？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T22:22:08.333

我在 Firebug 上也看到过类似的情况，并且发现了两个问题/解决方法：

*   在 Firebug 中开始发生一些奇怪的事情后，重新启动 Firefox 通常会有所帮助
*   我正在使用 dojo 并在调试器中看到一件事，而另一件事实际上发生在这样的代码模式中（在 Firebug 中状态 = true，但实际上未定义）：

    dojo.byId("ajaxProgress").style.visibility = "hidden";

    var status = responseObject.status;

一旦我改变了这些线条的顺序，事情就开始与现实相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T21:58:02.073

如果您编写日志语句、打印整个值以及每个组件的“typeof”结果，这可能会有所帮助。还将这些输入到 Firebug 控制台。

“window.objFrame”不是只存在于 IE DOM 中吗？

在 Firebug 论坛或 comp.lang.javascript 中提出这样的问题不是更有意义吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T22:38:20.480

我会去

```
var useWindow = (window.objFrame != null
    && window.objFrame.contentWindow != null); 
```

如果可能的话。

我认为这就是您要检测的内容，但是检查 typeof(null) 对我来说似乎有点不稳定。

（如果有充分的理由这不起作用，请忽略我:)）

# xslt - 最佳实践

> ID：534338
> 
> 赞同：0
> 
> 时间：2009-02-10T21:42:05.297
> 
> 标签：xslt

使用 apply-templates 容易编写难以理解的代码。

是否有编写易于阅读和维护的应用模板的规则？

例如，“避免在选择中使用 //*”、“尝试在一个模板中编写所有应用模板”或“如果可能，不要使用应用模板”

什么看起来自然，什么丑陋？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T00:26:38.130

抱歉，如果您发现应用模板难以维护 - 但这是 XSLT 做事的方式。事实上，您应该使用 apply-templates 来支持 for-each 作为示例。这就是您将在不同 XSLt 处理器上提供最佳性能的原因。一般来说，我会尽量避免在 select 子句中有太多的 XPath 段/级别。但这里真的没有经验法则。

如果您了解不同的轴，那么要避免“//*”就会变得很明显。如果您正在使用 XSLT 和 XPath，我真的建议您阅读这些内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T14:37:14.987

在我的简短经验中，组织应用模板功能是次要的良好文档。尝试使您的执行路径显而易见，并在需要时使用注释对其进行增强，以使跟踪更容易。

否则，根据需要将样式表拆分为尽可能多的逻辑模块并没有错。

*   任何重复的内容都应该在模板中（显然）
*   路径匹配应该可以通过字符串搜索进行匹配。apply-templates 和模板匹配至少应该看起来相似。模板越大，这就越重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T15:09:31.803

您必须更多地考虑每个模板正在选择什么以及您想要从中获得什么输出。不要太担心设计一些执行路径。让 XSLT 为您解决这个问题。

考虑一下文档的结构以及您希望输出的结构。然后从根目录开始创建模板，逐步选择要创建输出的位置。使用没有任何输出的中间模板来阐明您选择的内容和原因是很有用的。

避免“for-each”。它只会让你误以为你是在一个程序域中工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T08:26:56.420

`<xsl:apply-templates select="//abc/xyz" />`永远不要从内部应用模板中的根开始，因为它会导致堆栈溢出

# linux-kernel - 针对 Linux 内核 2.6.21.3 运行的 gphoto2 中的 PTP 错误

> ID：534344
> 
> 赞同：0
> 
> 时间：2009-02-10T21:44:01.953
> 
> 标签：linux-kernel, debian, libgphoto2

希望有一个 gphoto 或 Linux 内核专家在那里闲逛，我在这里问这个问题。我正在尝试为 Linux libgphoto2 库构建一个自定义前端。目前我正在使用 gphoto2 调用图书馆。我在 Etch (Debian 4.0) VM 映像上运行它作为我的测试机器。我从 gphoto-suite svn 存储库主干中提取源代码并毫无问题地构建它。我刚刚构建了套件的 libgphoto2 和 gphoto2 部分，因为这就是我所需要的。当我尝试连接到我的相机 (Canon EOS Rebel XTi) 时，我收到一个 PTP 错误，然后出现一条消息，上面写着“i/o 库中发生错误（'未指定错误'）”。我发现了一些与 libgphoto2 相似的错误的参考，这些错误散布在具有多个不同内核的多个 Linux 发行版中。最近的一个似乎是在 2.6.28 中，被 gphoto-suite 团队明确宣布为内核错误。参考[这里](http://bugzilla.kernel.org/show_bug.cgi?id=12301)和[这里](https://bugzilla.redhat.com/show_bug.cgi?id=476355)

我之前在 Ubunut 的 Hardy Heron 上已经让这个库与这台相机一起使用，所以我知道它过去一直有效。由于我的目标平台是运行 2.6.21 内核的单板计算机，我将 Etch VM 的内核更新为 2.6.21.3 并得到了同样的错误。

那么我的问题是，有谁知道这是否真的是 USB 驱动程序中的一个内核错误，它已经存在了一段时间并且正在内核 2.6.28.4 及更高版本中得到解决，或者它实际上是否是 gphoto2 版本的问题? 由于我无法轻松地将嵌入式设计升级到新内核，我希望这是一个 gphoto 错误。同时，我将尝试构建一些旧版本的 gphoto。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T01:14:08.233

显然这是一个用户空间错误。在同一 VM 映像上构建 gphoto-suite 2.4.4 版，然后运行良好。好的组合似乎是 libgphoto2-2.4.2 和 libgphoto2_port-0.8.0，以及 gphoto2-2.4.2。也许 gphoto-devl 邮件列表会给出原因的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T22:04:34.867

使用调试符号构建 libgphoto（即 makefile 中的 CFLAGS=$(CFLAGS) -g），然后尝试在 GDB 中捕获错误。查看实际代码将提供更多关于它是内核还是用户空间错误的信息，而不是超级模糊的错误消息。

# c# - 如何使用 Linq to ADO.NET 实体框架进行全文搜索 (FTS)？

> ID：534356
> 
> 赞同：11
> 
> 时间：2009-02-10T21:47:50.447
> 
> 标签：c#, entity-framework, sql-server-2008, linq-to-entities, full-text-search

现在 SQL Server 2008 内置了全文搜索。我希望用它来支持我的网站搜索。我也在考虑为我的 ORM 使用 ADO.NET 实体框架，但我想知道如何使用 Linq 到 ADO.NET 实体框架进行全文搜索（FTS）？

ADO.NET 实体框架中是否有任何支持，或者我是否坚持使用[创建使用全文搜索谓词的函数的方法](http://sqlblogcasts.com/blogs/simons/archive/2008/12/18/LINQ-to-SQL---Enabling-Fulltext-searching.aspx)？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-11T05:03:10.523

Entity Framework 仅支持可用的 sql 功能的一个子集（部分是为了在一系列提供程序上保持兼容）。但是，即使是 LINQ-to-SQL（支持更多 SQL-Server 特定结构，例如 UDF）也不支持全文 AFAIK。

我相信你需要使用存储过程/udf。首选 UDF 方法，因为元数据层要强大得多，并且可以在 db 服务器上组合 - 但是，Entity Framework 不像 UDF（或者上次我检查时没有）；-p 所以你可能有使用存储过程。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-05-25T19:09:54.447

我见过这样的 EF4 代码：

```
var query = context.ExecuteStoreQuery<Person>(
        "SELECT * FROM People WHERE FREETEXT(*,{0})", 
        searchText
    ).AsQueryable(); 
```

在某些情况下，这可能比创建存储过程或 UDP 更简单。

# asp.net - SiteMapPath 在子页面上消失

> ID：534363
> 
> 赞同：0
> 
> 时间：2009-02-10T21:50:07.210
> 
> 标签：asp.net, sitemap, sitemappath

出于某种原因，我的页面上的 SiteMapPath 消失了。

网站结构：

```
WebApp
-Default.aspx
-> Reports\
----Default.aspx
----MyReport.aspx 
```

网站地图

```
<?xml version="1.0" encoding="utf-8" ?>
<siteMap xmlns="http://schemas.microsoft.com/AspNet/SiteMap-File-1.0" >
  <siteMapNode url="~/Default.aspx" title="Overview"  description="Overview">
    <siteMapNode url="~/Reports/Default.aspx" title="Reports"  description="Reports" >
      <siteMapNode url="~/Reports/MyReport.aspx" title="MyReport"  description="MyReport" />
    </siteMapNode>
  </siteMapNode>
</siteMap> 
```

当我在报告页面的概览页面而不是 MyReport 页面时，将显示 SiteMapPath。将站点地图绑定到树视图后，我可以正确看到所有节点。

作品 - 在 MyReport 页面上显示

```
<asp:TreeView ID="TreeView1" runat="Server" DataSourceID="SitePathDataSource">
</asp:TreeView> 
```

在 MyReport 页面上消失，但在所有其他页面上可见

```
<asp:SiteMapPath ID="SiteMapPath1" runat="server" DataSourceID="SitePathDataSource">
</asp:SiteMapPath> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T20:06:40.940

不显示控件时浏览器中的 URL 是什么？我敢打赌，您有一个查询字符串值或与 Reports/Myreport.aspx 不匹配的东西。如果页面的路径与站点地图节点中的项目不完全匹配，它将不会显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T22:17:45.583

我不是这方面的专家。我只是在我的页面上对其进行了测试，它运行良好。我所做的与您所做的唯一区别是我没有在父节点上指定文件名。尽管我偶然发现了那个，因为我的站点地图中不能有两次相同的路径。

```
<?xml version="1.0" encoding="utf-8" ?>
<siteMap xmlns="http://schemas.microsoft.com/AspNet/SiteMap-File-1.0" >  
    <siteMapNode url="~/Default.aspx" title="Overview"  description="Overview">   
        <siteMapNode url="~/Reports/" title="Reports"  description="Reports" >      
            <siteMapNode url="~/Reports/Default.aspx" title="Reports Home"  description="Home" />
            <siteMapNode url="~/Reports/MyReport.aspx" title="MyReport"  description="MyReport" />    
        </siteMapNode>  
    </siteMapNode>
</siteMap> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-21T21:34:32.920

在页面的 page_load 中分配站点地图提供程序

```
SiteMapPath1.SiteMapProvider = "DefaultSiteMap" 
```

在 web.config 里面

```
 <siteMap defaultProvider="DefaultSiteMap" enabled="true">
<providers>
<add name="DefaultSiteMap" type="System.Web.XmlSiteMapProvider" siteMapFile="~\SiteMaps
\Default.sitemap" />
</providers> 
```

# php - PHP：计算两次之间的持续时间

> ID：534364
> 
> 赞同：7
> 
> 时间：2009-02-10T21:50:09.770
> 
> 标签：php

好的，一个非常简单的问题，但我太厚了，无法弄清楚。我想得到两次之间的差异。例如，“1:07”（1 分 7 秒）和“3:01”（3 分 1 秒）。它只会是几分钟和几秒钟。我一直在尝试利用这个：

```
function timeDiff($firstTime,$lastTime)
{

// convert to unix timestamps
$firstTime=strtotime($firstTime);
$lastTime=strtotime($lastTime);

// perform subtraction to get the difference (in seconds) between times
$timeDiff=$lastTime-$firstTime;

// return the difference
return $timeDiff;
} 
```

但我认为我跑错了方向？

感谢您的任何帮助。

## 编辑

我试过这个： echo timeDiff('1:07','2:30');

我得到了这个输出“4980”

以上是什么？是秒吗？我不知道如何将其设为“1:23”，这就是区别。

## 编辑 2

谢谢大家，我从这个线程中学到了很多东西，尤其是。保罗的。它工作得很好，我喜欢防守！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-10T22:01:10.990

**您不能使用 strtotime ，因为它会将 MM:SS 解释为 HH:MM** - 这就是为什么您获得的值高于预期的原因。

您可以简单地在您的 MM:SS 值前面加上“00:”，使它们看起来像 HH:MM:SS。

*但是请注意，如果只给出 HH:MM:SS，strtotime 将给出**今天**的时间戳，这对于一次性代码来说很好。不要将这种技术用于任何重要的事情，考虑一下如果你的两次调用 strtotime 跨越午夜会发生什么！*

或者，这样的事情会将 MM:SS 值转换为时间戳，您可以对其进行算术运算

```
function MinSecToSeconds($minsec)
{
    if (preg_match('/^(\d+):(\d+)$/', $minsec, $matches))
    {
        return $matches[1]*60 + $matches[2];
    }
    else
    {
        trigger_error("MinSecToSeconds: Bad time format $minsec", E_USER_ERROR);
        return 0;
    }
} 
```

它比使用爆炸更具防御性，但显示了另一种方法！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T22:00:36.360

这应该以秒为单位为您提供两次之间的差异。

```
$firstTime = '1:07';
$secondTime = '3:01';

list($firstMinutes, $firstSeconds) = explode(':', $firstTime);
list($secondMinutes, $secondSeconds) = explode(':', $secondTime);

$firstSeconds += ($firstMinutes * 60);
$secondSeconds += ($secondMinutes * 60);
$difference = $secondSeconds - $firstSeconds; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T22:07:57.247

使用[此处](http://us2.php.net/manual/en/book.datetime.php#86589)找到的代码，如何自己计算秒数：

```
<?php

function time_to_sec($time) {
    $hours = substr($time, 0, -6);
    $minutes = substr($time, -5, 2);
    $seconds = substr($time, -2);

    return $hours * 3600 + $minutes * 60 + $seconds;
}

function sec_to_time($seconds) {
    $hours = floor($seconds / 3600);
    $minutes = floor($seconds % 3600 / 60);
    $seconds = $seconds % 60;

    return sprintf("%d:%02d:%02d", $hours, $minutes, $seconds);
} 

function timeDiff($firstTime,$lastTime)
{

// convert to seconds
$firstTime=time_to_sec($firstTime);
$lastTime=time_to_sec($lastTime);

// perform subtraction to get the difference (in seconds) between times
$timeDiff=$lastTime-$firstTime;

// return the difference
return sec_to_time($timeDiff);
}

echo timeDiff("1:07", "3:01");

?> 
```

返回 0:01:54

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T22:12:09.780

strtotime 函数用于将字符串格式**的日期（精确到秒）**转换为 Unix Timestamp 样式格式。它不适用于将时间格式的字符串转换为任何内容。看看这两个陈述是否有助于您了解任何

```
//recent php5 for DATE_RFC822
echo date(DATE_RFC822,strtotime('1:07'));
echo date(DATE_RFC822,strtotime('3:01')); 
```

听起来你想要这样的东西

```
function timeDiff($firstTime,$lastTime)
{
    //split minutes and seconds
    list($min_one, $sec_one) = preg_split('{:}',$firstTime,2, PREG_SPLIT_NO_EMPTY);
    list($min_two, $sec_two) = preg_split('{:}',$lastTime ,2, PREG_SPLIT_NO_EMPTY);

    //convert times into seconds
    $time_one = $min_one * 60 + $sec_one;
    $time_two = $min_two * 60 + $sec_two;

    //return times
    return $time_two - $time_one;
}

echo timeDiff('1:07','3:10'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-09T13:25:03.320

```
$time1 = date("H:i",strtotime($strtime));
$time2 = date("H:i");
list($hours, $minutes) = explode(':', $time1);
$startTimestamp = mktime($hours, $minutes);

list($hours, $minutes) = explode(':', $time2);
$endTimestamp = mktime($hours, $minutes);

$seconds = $endTimestamp - $startTimestamp;
$minutes = ($seconds / 60) % 60;
$hours = floor($seconds / (60 * 60)); 
```

# internet-explorer - IE 中的 HTML 实体和字符集

> ID：534367
> 
> 赞同：7
> 
> 时间：2009-02-10T21:50:46.070
> 
> 标签：internet-explorer, character-encoding, entities, html-entities, iso-8859-1

我在`&#10003;`使用 iso-8859-1 作为字符集的 html 文档中显示 html 实体（复选标记：✓）。

在 Firefox 中，它显示为复选标记。在 IE 中，它显示为一个方框。切换到 UTF-8 似乎没有什么不同。

有没有一种可靠的方法可以在不使用图像的情况下在 IE 6 和 7 中显示这些实体？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-11T09:16:25.797

Square 表示使用的字体没有该字符的字形。

不幸的是，包含该字符的字体并不多，并且默认情况下，所有 Windows 机器上都不存在这些字体（在非 Windows 机器上甚至更少）

最有可能出现的字体（包含该字形）是 Arial Unicode MS（随 Officie 提供）和 MS Gothic + 系列（这是一种日文字体）。

请参阅此处了解可以帮助您确定字体包含哪些字形的工具：http: [//www.mihai-nita.net/article.php ?artID=charmapex](http://www.mihai-nita.net/article.php?artID=charmapex)

但是，如果您想要一个可靠的解决方案，图像是您最安全的选择。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-10T22:15:21.987

也许 Internet Explorer 使用的字体没有显示该字符的字形。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-07-08T14:25:48.323

您可能想使用`font-family: Arial Unicode MS, Arial, Sans-Serif`. IE 无法正确显示 Arial 中的 unicode 字符...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-18T21:01:26.790

您可以尝试平方根符号“√”，它看起来并不完美，但还可以。√

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T22:49:23.357

如果是 IE，你可以合理地假设它在 Windows 上，因此，有可用的 WingDings 字体...... MS WingDings 中的字母 ü 是一个简单的复选标记（类似于 ✓），而 þ 是一个框内的复选标记（类似于☑)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-30T15:24:46.080

我在样式标记中指定了字体属性，并且复选标记在 IE7 中正确显示，这是我的大多数客户正在使用的。例子：

✓ 一些文字

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T22:02:55.090

根据[http://www.w3.org](http://www.w3.org)，复选标记不是 8859-1 的一部分：http: [//www.w3.org/TR/html401/sgml/entities.html](http://www.w3.org/TR/html401/sgml/entities.html)

它是 UTF-8 中的 e29c93。

# asp.net - 如何从引用的程序集访问 Web.config？

> ID：534369
> 
> 赞同：1
> 
> 时间：2009-02-10T21:51:08.813
> 
> 标签：asp.net, assemblies, web-config

我需要从引用的程序集中访问 Web 应用程序的 web.config。我需要获取文件的路径或配置对象。我无法使用 System.Reflection.Assembly.GetEntryAssembly 来执行此操作，就像我为应用程序配置 windows exe 所做的那样。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-10T22:06:21.570

我在我的类库中使用以下代码从配置文件中读取：

```
using System.Configuration;

...

string value = ConfigurationManager.AppSettings.Get("myKey");
// returns null if the specified key does not exist 
```

这适用于读取 Web 应用程序 (web.config) 和 Windows 窗体/控制台应用程序 (application.exe.config) 中的应用程序设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T21:59:09.903

您可以使用 System.Configuration 程序集中的 ConfigurationManager 类。

但是你不会得到路径，因为配置是很多配置文件的混合（machin.config，几个 web.config 等）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T22:14:24.267

这不是一个好的做法，因为它将太多的东西结合在一起。

相反，将所需的配置设置从主机程序集传递到它引用的任何程序集。

这样，可以在不依赖配置文件的情况下构建和测试引用的程序集。

# python - 在 Python 中传递值

> ID：534375
> 
> 赞同：77
> 
> 时间：2009-02-10T21:51:43.760
> 
> 标签：python, pass-by-reference, pass-by-value

当您将列表、数组之类的集合传递给 python 中的另一个函数时，它会复制它，还是只是一个指针？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-02-10T21:53:45.703

Python[通过 value 传递对对象的引用](https://web.archive.org/web/20120615042202/http://testingreflections.com/node/view/5126)。

> Python 按值传递对对象的引用（如 Java），Python 中的一切都是对象。这听起来很简单，但随后您会注意到某些数据类型似乎表现出按值传递的特征，而另一些数据类型似乎表现得像按引用传递......这是怎么回事？
> 
> 了解可变和不可变对象很重要。一些对象，如字符串、元组和数字，是不可变的。在函数/方法内部更改它们将创建一个新实例，而函数/方法外部的原始实例不会更改。其他对象，如列表和字典是可变的，这意味着您可以就地更改对象。因此，更改函数/方法内部的对象也会更改外部的原始对象。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2009-02-10T22:29:25.697

问题是，整个参考/价值概念不适合 python。Python 没有变量的“值”。Python 只有对象和引用对象的名称。

因此，当您调用一个函数并在括号内放置一个“名称”时，如下所示：

```
def func(x): # defines a function that takes an argument
    ... # do something here

func(myname) # calling the function 
```

`myname`传递的是指向的实际对象，而不是**名称** `myname` **本身**。在函数内部，**另一个名称**( `x`) 用于引用传递的同一对象。

如果它是可变的，您可以修改函数内部的对象，但您**不能更改外部名称指向的内容**。和你做的时候一样

```
anothername = myname 
```

因此，我可以回答您的问题：

**它是“按值传递”，但所有值都只是对对象的引用。**

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-11-27T06:08:04.897

这里的答案很有帮助，但我发现需要展示我没有看到的这种细微差别，我已经通过随后的 CL 实验向自己证明了这一点：

1.  **在函数调用中不能单独更改不可变对象。**（到目前为止的答案已经说了很多......）
2.  **但是，包含在可变对象中的不可变对象可以在方法调用中重新分配。**

'num' 在这里没有改变，因为它是一个不可变的 Number 对象[支持我的观点 1。]：

```
def incr_num(num):
    num += 1

num = 0

num
0

incr_num(num)

num
0 
```

'list[0]' 这里也是一个不可变的 Number 对象。

```
def incr_list(list):
    list[0] += 1

list = [0]

list[0]
0

incr_list(list)

list[0]
1 
```

*那么，作为不可变的 Number 对象，'list[0]' 是如何改变的（支持我的观点 2.），而上面示例的 Number 对象 'num' 没有？* 不可变的 Number 对象“list[0]”包含在*可变*列表对象“list”中，而第一个示例中的“num”只是一个非包含的 Number 对象（*不可变*）。

虽然出于善意，但我觉得[@Stephen Pape](https://stackoverflow.com/users/38714/stephen-pape)评价最高的答案（引用如下）和其他一些类似的答案并不完全正确（这促使我写下这个答案）：

> 一些对象，如字符串、元组和数字，是不可变的。在函数/方法内部更改它们将创建一个新实例，而函数/方法外部的原始实例不会更改。

我上面的第二个代码实验显示了一个 Number 对象 ('list[0]') 在方法内被更改，然后函数外部的原始实例发生了更改。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-10T21:54:50.537

传递了引用，但如果参数是不可变对象，则在方法中对其进行修改将创建一个新实例。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-10T21:53:42.723

对象被传递。不是副本，而是对底层对象的引用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-10T21:58:57.097

我还建议查看`copy`模块：

[用于复制的 Python 文档](http://docs.python.org/library/copy.html)

它将帮助您了解潜在问题以及如何使用它来执行您自己的深度复制。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-10T21:55:22.050

引用：

```
>>> x = [0,1,2,3]
>>> def foo(x_list):
    x_list[0] = 1

>>> foo(x)
>>> x
[1, 1, 2, 3] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-10-22T10:26:54.440

请让我举一个谦虚的例子

```
def swap(a, b):
    x = a
    print id(x)
    print id(a)
    print id(b)
    a = b

    print id(a)
    b = x
    print id(b)
    a[0]= '20'

var1 = ['1','2','3','4']
var2 = ['5','6','7','8','9']
print id(var1)
print id(var2)

swap(var1, var2)

print id(var1)
print id(var2)
print var1
print var2 
```

产生以下结果

28329344 var1 28331264 var2 28329344 x 28329344 a 28331264 b 后 a = b 28331264 a 后 b = x 28329344 b 后返回 28329344 var1 28331264 var2 ['1', '2', '3', ''] '6'、'7'、'8'、'9']

映射到内存地址 28329344 28331264 var1 var2 ab x 之后 a=b a 之后 b=x b 之后 a[0] = '20' [0] = '20' 之后 return ['1','2','3', '4'] ['20', '6', '7', '8', '9']

# c# - 添加到自定义列表的项目中的图像未更新

> ID：534377
> 
> 赞同：0
> 
> 时间：2009-02-10T21:52:10.280
> 
> 标签：c#, collections

我有一个带有 Image 字段的项目，以及一个从 CollectionBase 派生的自定义列表。当我将项目添加到自定义列表中，然后尝试更改该项目图像然后从列表中获取项目时，图像未在列表项上设置。如何确保列表中的项目与我们创建的项目相同，并且任何更新都将在两者之间同步。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T21:56:33.420

您的项目是值类型还是引用类型？

如果项目是结构，从列表中获取项目实际上会得到一个副本，您必须更改该副本，删除原始副本并将其重新插入列表中。

# keyboard-shortcuts - 远程 Xwindows 程序的键盘快捷键损坏

> ID：534392
> 
> 赞同：-1
> 
> 时间：2009-02-10T21:56:36.460
> 
> 标签：keyboard-shortcuts, terminal, remote-desktop

有一台远程机器，我使用 ssh 登录。在那台机器上，我们有一个 Xwindows GUI 程序，即 nedit。**该**程序的所有键盘快捷键（如`Ctrl`+`O`或`Alt`+ ）都已损坏（而其他程序工作正常）`F`。

 **现在奇怪的是，对于另一个用户，这些快捷方式有效！他具有相同的 shell (bash) 和相同的 TERM 环境变量 (xterm)。但是他有一台mac而不是linux笔记本电脑。远程机器是 AIX。你对可能被破坏的东西有任何暗示吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T19:21:16.670

原来只是这个已知的错误。 [http://www.nedit.org/faq/sect_bugs.php#NumLockBis](http://www.nedit.org/faq/sect_bugs.php#NumLockBis)

# prototyping - 原型设计时的最佳实践？

> ID：534395
> 
> 赞同：3
> 
> 时间：2009-02-10T21:57:02.780
> 
> 标签：prototyping

在进行原型设计时，您在多大程度上放弃了最佳实践以支持代码和修复黑客攻击？当然，代码并不打算在完整的生产中保留。

补充：我正在研究一个用 Python 制作的相当大的半工作原型，以找出嵌入式应用程序的 UI。我知道代码不打算在生产中使用，但是代码库的质量随着更改次数的增加而稳步下降，这让我很恼火。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T22:21:12.953

不幸的是，由于时间限制，我有太多的原型变成了基线产品。因此，理想情况下，您将遵循最佳实践。实际上，您尽一切努力完成工作，以满足您所追求的任何最后期限。不要指望有机会完全重写。您提出的通常是基准，尤其是在开发时间超过几天的情况下。最好的建议是以黑客级别的速度学习使用最佳实践。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T22:08:12.050

这取决于您的原型试图证明什么。您是为了可用性和向客户演示而对 UI 进行原型设计，还是在对架构进行原型设计？

如果我正在对 UI 进行原型设计，那么一旦这个概念经过迭代并得到证明，我就会抛弃所有东西。

如果我正在对架构进行原型设计，那么最终代码将符合最佳实践并且可以使用。

也就是说，由于时间或预算限制，最终投入全面生产的黑客工作原型的数量令人惊讶。如果您的目的是让代码不最终投入生产（即 UI 原型），那么模拟屏幕截图而不是对其进行编码可能会很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T22:02:29.427

我抛弃了“干净”的方法和评论（即“使事情发生”的实用程序类），但如果你愿意的话，我不会抛弃“业务对象”。

例如，如果我可以选择定义“Car”类来定义“WheelCount”、“DoorCount”的字符串值属性，或者只是制作一个快速的 Hashtable，我通常会继续并花一些额外的时间来创建汽车类。

这样做的原因是因为当我稍后回去重新编码时，查看真实的类名更有意义（有时这些小类可以转移到“真实”版本）。

一般来说，原型设计的最大危险是想“我会在以后修复它”然后不去做......所以如果在任何时候你在脑海中想“我对我需要如何做这门课有一个很好的想法”，继续在这门课上多花几分钟，把它做好，这样你就可以重复使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T23:51:29.947

我几乎总是将原型（此处称为“尖峰”）视为一次性代码。原型的目的是**了解问题**，而不是解决问题。这种理解比任何代码制品都重要得多，正确实施解决方案应该是微不足道的（如果不是，我认为尖峰的范围太大了）。

您可以将原型重构为合适的状态，但根据我的经验，从头开始重写会更快，因为它必须与更广泛的系统集成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T22:00:59.120

对于原型来说，只有外部才是真正重要的。如果你以后有足够的勇气把代码扔掉，你可以使用书中任何肮脏的技巧，只要它看起来很棒。

请记住，原型只是获得客户响应的工具。（是的，我喜欢它，或者，你为什么把那个选项放在那里？）。

# iphone - 如何在标签栏应用程序中将视图旋转为横向

> ID：534405
> 
> 赞同：7
> 
> 时间：2009-02-10T21:59:02.807
> 
> 标签：iphone, ios, cocoa-touch

我有一个基于标签栏的应用程序。

我在 Interface Builder 中构建了 2 个视图，一个是纵向的，另一个是横向的。

现在，我想要类似 iPod 应用程序的东西。我希望横向视图是全屏的，并隐藏标签栏和状态栏。

我做这个的基本工作：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
                                duration:(NSTimeInterval)duration { 
    if (self.landscape) {
        if (toInterfaceOrientation == UIInterfaceOrientationPortrait)
        {
            self.view = self.portrait;
            self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(360));
        }
        else if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft)
        {
            self.view = self.landscape;
            self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(-90));
        }
        else if (toInterfaceOrientation == UIInterfaceOrientationLandscapeRight)
        {
            self.view = self.landscape;
            self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(90));
        }
        else
        {
            self.view = self.portrait;
            self.view.transform =  CGAffineTransformMakeRotation(degreesToRadian(-180));
        }
    }
} 
```

但是所有工作都很混乱。横向视图未正确填充该区域，并且控件位于错误的位置，与最初的设计不同。

另外，我仍然没有找到隐藏其他所有内容的方法......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-11-30T00:47:01.643

查看 Apple 的“AlternateViews”示例代码。

基本思想是您可以通过通知检测设备的物理方向，然后“模态”激活一个新的视图控制器并让它请求全屏。您可以通过 shouldAutorotate... 仅针对一个方向返回 YES 来禁用界面旋转，因为您是通过通知手动完成所有这些操作的。当您更改物理方向时，您的模态视图控制器要么显示要么关闭。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T12:20:48.773

您可以通过调用隐藏状态栏

```
setStatusBarHidden:(BOOL) 
```

在 UIApplication 参考上，就像这样。

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {

[application setStatusBarHidden:YES];

} 
```

要摆脱标签栏，您可以在 Interface builder 中为您的代码创建一个引用插座并调用

```
[myUITabBar removeFromSuperview]; 
```

这可能有效，虽然我没有测试过，至于其他问题，我不是 100%，以前没有解决过这些问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-14T09:24:31.937

When I look at the iPod app, it seems to me that the TabBarController view is not replaced or modified in any way. I think there is just a fade transition between the tabbarcontroller view and the coverflow view.

If I were you, I would try (not sure if this might work) with a coverflow controller, with its view displayed on top of the tabBarController's view. If would prevent the tabBarController from autorotating its view, but at that moment I would fade out its view and fade in the coverflow view, which would be landscape only.

I don't know if the statusBar would have a proper behavior, and I let a lot of details for you to sort out, but in any case I think it would be a nice idea to have two separate controllers, one showed in landscape, the other (the tabBar) in portrait.

Hope that will help you.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T20:23:30.043

好的，这就是我所做的工作：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
                                duration:(NSTimeInterval)duration {
    if (self.landscape) {
        if (toInterfaceOrientation == UIInterfaceOrientationPortrait)
        {
            self.view = self.portrait;
            //self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(360));
        }
        else if (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft)
        {
            self.view = self.landscape;
            //self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(-90));
        }
        else if (toInterfaceOrientation == UIInterfaceOrientationLandscapeRight)
        {
            self.view = self.landscape;
            //self.view.transform = CGAffineTransformMakeRotation(degreesToRadian(90));
        }
        else
        {
            self.view = self.portrait;
            //self.view.transform =  CGAffineTransformMakeRotation(degreesToRadian(-180));
        }
    }
} 
```

现在，在 AppDelegate 中：

```
- (void) didRotate:(NSNotification *)notification
{   
    UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation];
    [UIView beginAnimations:nil context:NULL];  

    if (orientation == UIDeviceOrientationLandscapeLeft || orientation == UIDeviceOrientationLandscapeRight)
    {
        [tabBarController.view setAlpha:0.0];
        [tabBarController.view removeFromSuperview];

        [[UIApplication sharedApplication] setStatusBarHidden:YES animated:NO]; 
    } else {
        [tabBarController.view setAlpha:1.0];
        [[UIApplication sharedApplication] setStatusBarHidden:NO animated:NO];      
    }
    [UIView commitAnimations];  
} 
```

但是那么如何设置当前视图以及如何恢复标签栏呢？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-15T01:21:31.647

似乎有相当多的编码人员希望有一个标签栏项目将他们带到一个横向视图全屏（没有状态栏，没有标签栏）然后回来。

我已经在 Apple 开发者论坛上发布了关于这是否确实可行的询问，但尚未得到回复。

为什么这很难？（对不起，一个新手问题？看起来一些相当明显的事情应该不难）我在网上找到的没有人对此有明确的答案。

# sql-server - SQL Server 身份验证的 SSPI 错误？

> ID：534415
> 
> 赞同：0
> 
> 时间：2009-02-10T22:02:03.920
> 
> 标签：sql-server, sspi

我们有几个使用 SQL Server 身份验证的旧 ASP 和 PHP Web 应用程序。周期性地，所有应用程序都无法连接到我们的 SQL Server 2000 数据库服务器，从而导致访问被拒绝。

对应于大致相同的时间，我们得到

```
1115 Cannot generate SSPI Context SQLSTATE HY000 
```

SQLServer 2000 服务器上的错误。

这是奇怪的部分 - 重新启动**Web**服务器可以解决问题。重新启动数据库服务器没有任何效果。

这对我来说毫无意义——我不认为 SSPI 以任何方式涉及 SQL Server 身份验证。

有任何想法吗？

**编辑：**

一些额外的细节：

Web 服务器位于 DMZ 中。Web 服务器上的 hosts 文件有一个数据库服务器条目（并且 IP 地址是正确的），因此 Web 服务器（至少理论上）甚至不应该通过 DNS 连接到数据库服务器。

这似乎不是防火墙问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T22:21:32.063

我认为您是对的，根据我的经验，该错误与 SQL 身份验证无关。Web 服务器是否位于任何类型的防火墙后面？是否对任一服务器上的“主机”文件进行了任何更改？当您遇到这些问题时，您是否尝试过从 Web 服务器 ping SQL Server 以确保 Web 服务器能够解析 SQL Server 的名称？我会检查企业管理器中的活动监视器，以确保 Web 应用程序肯定使用 SQL 身份验证进行连接。一种可能性是某种网络或域控制器问题 - 这可以解释来自 Web 服务器的连接断开和 SQL Server 上的 SSPI 上下文错误，但不确定为什么重新启动 Web 服务器会解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-06T19:52:03.070

我们在我们的主服务器和其他国家的一些客户之间有这个。

如果这里和那里之间有太多延迟（例如防火墙），那么底层的 Kerberos 就会失去情节（技术术语:-)。

我们通过指定端口来修复它。另外，我建议使用服务器的 FQDN。所以我们现在使用：“SQLServer.domain.tld\InstanceName,1234”

# c++ - 为什么 BTNS_DROPDOWN 样式会导致整个工具栏向下移动几个像素？

> ID：534421
> 
> 赞同：8
> 
> 时间：2009-02-10T22:03:35.243
> 
> 标签：c++, mfc, toolbar

我有一个 CToolbar，在其中我有一个样式为 BTNS_BUTTON|BTNS_DROPDOWN 的按钮。我想让它成为一个拆分按钮，所以按钮的左侧是一个按钮，右侧有一个下拉菜单。

为了完成此操作，我创建了按钮，然后调用 ::SendMessage，如下所示：

```
::SendMessage( hwndForButton, TB_SETEXTENDEDSTYLE, 0, TBSTYLE_EX_DRAWDDARROWS ); 
```

这很好用并创建了拆分按钮，但也有向下移动工具栏几个像素的不良影响。如果我不发送消息，那么我仍然有问题（并且我不再有拆分按钮）。

如果我将按钮的样式更改为 BTNS_BUTTON|BTNS_WHOLEDROPDOWN 那么​​我没有问题，尽管我也没有拆分按钮。

关于这里可能出现什么问题的任何线索？我认为有一个应用于 BNTS_DROPDOWN 的边距，它导致工具栏向下移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-07T16:17:01.580

好吧，这个问题确实*很*老了，但是由于它出现在有关该主题的谷歌搜索结果的最顶部，并且为了将来参考进一步浏览，似乎有一种解决方法（引自[http://www.ureader.com/msg /1484852.aspx](http://www.ureader.com/msg/1484852.aspx)）：

“不知道为什么，但是当我从一开始就设置 BTNS_DROPDOWN 样式时，问题就出现了。我是否将没有任何设置的按钮添加到 BTNS_DROPWN 并且在下一行中我使用 TB_SETBUTTONINFO 来更改样式，一切工作正常。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-27T11:20:59.393

我们在 CToolBar 扩展上设置 BTNS_DROPDOWN 样式时遇到了同样的问题，当 DPI 缩放高于 100% 时，这一点变得更加明显。

floyd73 的链接似乎被破坏了，但是尝试通过 setbuttoninfo 单独设置下拉样式不起作用。

我们找到的解决方案是在设置样式后重新缩放工具栏，以使用 SetSizes() 考虑新的按钮大小：

```
auto imgList = GetToolBarCtrl().GetImageList();
if (imgList)
{
    //Scale toolbar buttons to fit the correct scaled icons
    CSize buttonSize(GetToolBarCtrl().GetButtonSize());
    CSize imageSize;
    ImageList_GetIconSize(imageList, &imageSize.cx, &imageSize.cy);

    SetSizes(buttonSize, imageSize);
} 
```

我们将它嵌入到 NormalSize() 函数中，以便在任何自定义工具栏设置结束时使用，这应该允许我们捕捉任何其他有趣的按钮样式调整大小业务。

希望这可以帮助任何仍然面临同样问题的人。

# wpf - 数学（在 WPF 中）：翻译后获取新的 x,y 坐标

> ID：534424
> 
> 赞同：4
> 
> 时间：2009-02-10T22:04:45.693
> 
> 标签：wpf, math, matrix, translation, angle

*参考我目前正在构建的[这个编程游戏。](https://stackoverflow.com/questions/505040/developing-a-robocode-type-game-with-net-for-a-school-assignment)*

我正在使用 WPF 为画布设置动画，并且正在使用该`BeginAnimation`方法在另一个画布上转换（移动）画布。

使用 BeginAnimation，我需要指定 x 和 y 的`From`坐标`To`，这就是我使用的方法，如下所示：

```
//X 
Animator_Body_X.From = Translate_Body.X; //Current x-coordinate
Animator_Body_X.To = //The end X-coordinate
Translate_Body.BeginAnimation(TranslateTransform.XProperty, Animator_Body_X);

//Y
Animator_Body_Y.From = Translate_Body.Y; //Current y-coordinate
Animator_Body_Y.To = //The end Y-coordinate
Translate_Body.BeginAnimation(TranslateTransform.YProperty, Animator_Body_Y); 
```

现在画布需要使用给定的角度进行平移，我可以从该方法中获得该角度。

所以我的问题是，**给定画布当前旋转的角度（0-359），起始x和y坐标（画布当前所在的位置）和距离（以px为单位），我如何计算结束坐标？**即画布最终将被翻译到的地方。

[替代文字 http://img244.imageshack.us/img244/4794/canvastranspositionmi5.jpg](http://img244.imageshack.us/img244/4794/canvastranspositionmi5.jpg)

在上图中，我绘制了一个我想要实现的示例。

假设画布（实线框）的当前航向（角度）为 130 度，并且它需要被平移（沿着该角度向下的路径；即取决于它当前面对的位置）200 像素...什么将是画布的新坐标（它将停止动画：虚线框）？我如何计算它将停止的这些新坐标？

**[更新]解决方案：**

感谢[Andy](https://stackoverflow.com/questions/534424/math-in-wpf-getting-new-x-y-coordinates-after-a-translation/534475#534475)和[Cameron](https://stackoverflow.com/questions/534424/math-in-wpf-getting-new-x-y-coordinates-after-a-translation/534628#534628)的帮助，它终于按预期工作了。

这是工作代码：

```
double headingRadians = Heading * (Math.PI / 180);

Animator_Body_X.From = Translate_Body.X;
Animator_Body_X.To = Math.Sin(headingRadians) * pix + Translate_Body.X;
Translate_Body.BeginAnimation(TranslateTransform.XProperty, Animator_Body_X);

Animator_Body_Y.From = Translate_Body.Y;
Animator_Body_Y.To = ((Math.Cos(headingRadians) * pix) * -1) + Translate_Body.Y;
Translate_Body.BeginAnimation(TranslateTransform.YProperty, Animator_Body_Y); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T22:17:57.563

假设您从 12 点开始顺时针旋转，您的新 x 坐标将为：

```
sin(130) * 200 = 153 + original x-coordinate 
```

你的新 y 坐标将是

```
cos(130) * 200 = -129 + original y-coordinate (assuming negative 'y' is down) 
```

如下所示，请注意，例如，在 C# 中，`sin`取`cos`弧度而不是度数 - 乘以`Math.PI/180`首先获得以弧度表示的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T22:55:07.273

您可以使用`cos`和`sin`计算 x 和 y 坐标中的移动量。这是基于[单位圆](http://en.wikipedia.org/wiki/Unit_circle)的。

单位圆的角度从右侧开始，逆时针方向。所以在单位圆中，你的 130 度角实际上是 320 度。

```
actualAngle = 90 - 130 = -40 
(which is the same as 320 degrees when used in sin/cos) 
```

另一件需要注意的是`cos`and`sin`函数使用的是[弧度](http://en.wikipedia.org/wiki/Radian)而不是度数。

```
angleInRadians = 320 * pi / 180 (about 5.59)
x = cos(angleInRadians) * 200 + 300 (about 453.21)
y = sin(angleInRadians) * 200 + 400 (about 271.44) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T23:17:53.177

我将详细说明如何在不使用数学的情况下进行操作：

请注意，我不会尝试我所说的，所以也许有一些错误。

我将你正在移动的方格称为 Visual B，

我将方形 Visual A 的容器称为。

现在，您希望能够将 B 从 B 原点平移到 B'，并从 A 原点检索 B' 坐标。

如果你的平移是 (200,0)，那么 B' 从 B 原点的坐标是 (200,0)。您需要来自 A 原点的这些坐标。所以你必须这样做。

```
var transform = B.TransformToVisual(A);
var pointFromAOrigin  = transform.Transform(new Point(200,0)); 
```

pointFromAOrigin 反映了你想要什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T22:33:59.617

如果您有来自 Visual A 原点的对象坐标并且想要来自 Visual B 原点的对象坐标，请查看[TransformToVisual ，然后执行](http://msdn.microsoft.com/en-us/library/system.windows.media.visual.transformtovisual.aspx)

```
 var transformation = A.TransformToVisual(B); 
```

如果需要，您可以将转换从 GeneralTransform 转换为 Transform。然后您可以使用 GeneralTransform 对象的 Transform 方法。

# psexec - PsExec：将我的程序复制到“system32”文件夹中

> ID：534426
> 
> 赞同：3
> 
> 时间：2009-02-10T22:05:15.363
> 
> 标签：psexec

我无法让 PsExec 工作。它不断将我的安装程序复制到 system32 中（它不会启动）。有谁知道如何从本地复制到远程计算机到不是 system32 的目录？我的 PsExec 命令行是

```
psexec \\000.00.00.000 -f -u DOMAIN\meuser -p testpwd -c ..\Installer\test.exe /S 
```

任何帮助将不胜感激。

编辑：它不会启动，因为我在计算机上没有完全的管理权限。它将从其他目录启动

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T16:12:01.850

作为 psexec 在目标上启动 Windows 服务的一部分，您需要对目标具有管理员权限，并且您需要管理员权限才能执行此操作。

psexec 将 psexecsvc 文件复制到管理共享，然后使用远程管理使用该文件启动服务。它打开命名管道并将其用于进一步的通信。完成后，它会自行整理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-04-05T22:36:59.717

尝试使用 PsExec 的 -w 参数来设置远程计算机上进程的工作目录。我认为该文件可能仍会复制到 system32 目录，但是当它执行时，工作目录将是指定的目录。

从 PSExec 命令行帮助：

```
-w   Set the working directory of the process (relative to remote computer). 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T22:38:12.663

你有没有尝试过：

```
net use G: \\remotecomputer\droppoint mypassword /user:myuser@mydomain
xcopy installer G: 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T22:10:56.163

您可以将安装程序 XCOPY 到远程 PC 上的某个位置，然后 PSExec 安装程序吗？PSExec 实际上不应该复制任何东西......如果我遗漏了什么，请告诉我。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T04:33:30.217

将 PsExec 复制到`C:\Windows\System32`远程 PC 并从远程 PC 运行它需要远程 PC 的管理员权限。但是，如果我们将其复制到其他文件夹（Windows 文件夹除外），例如：`C:\`. 在这种情况下，我们可以尝试将`app.manifest`文件添加到项目并更改执行级别，例如：

```
requestedExecutionLevel level="requireAdministrator" uiAccess="false" /> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-11T11:36:44.100

# 解决方案

我尝试了很多事情，但无法成功。而是将某些内容复制到**`%allusersprofile%`**文件夹！

# javascript - Javascript：根据条件在内存中加载大量数据

> ID：534427
> 
> 赞同：0
> 
> 时间：2009-02-10T22:06:04.880
> 
> 标签：javascript, greasemonkey

每次我的greasemonkey脚本启动时，我都会自动加载许多不同的正则表达式模式。在任何阶段都不需要 95% 的加载内存，所以我想找到一种方法，如果我知道它不会被使用，甚至不将这些数据放入内存中。

举一个基本的例子：

```
 var patterns = [
   {
     name    : 'p1',
     url     : 'http://www.someurl.com',
     pattern1 : /./,
     pattern2 : /./,
     pattern3 : /./,
   },
   {
     name    : 'p2',
     url     : 'http://www.someurl2.com',
     pattern1 : /./,
     pattern2 : /./,
     pattern3 : /./,
   },
   {
     name    : 'p3',
     url     : 'http://www.someurl3.com',
     pattern1 : /./,
     pattern2 : /./,
     pattern3 : /./,
   },

 ]; 
```

....还有更多的模式。

如果 url 与当前 url (location.href) 不匹配，我不需要加载任何数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T10:01:57.623

最好的方法是通过 GM_getResourceText+eval 按需加载数据。元数据块中定义的资源数据将在用户脚本的第一次安装时下载。

文档：[http ://wiki.greasespot.net/Metadata_block#.40resource](http://wiki.greasespot.net/Metadata_block#.40resource)

您需要考虑如何存储数据 - 可能是每个站点的资源（我知道很讨厌）？

缓解性能问题的另一个更简单的解决方案是将正则表达式存储为简单的字符串，并仅在需要时创建 RegExp 对象。例如：当实际需要表达式时`patterns : [".", ".", "."]`。`new RegExp(the_pattern)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T22:10:00.050

当且仅当需要时，使用 document.write() 包含来自单独的 javascript 文件的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T17:19:36.327

您可以坚持当前的模式定义并删除所有不需要的模式：

```
var patterns = [
   //patterns array as defined in question
];
var newpatterns = [];
var count = 0;

for (var i = 0 ; i < patterns.length ; i++ ){
  if (href.indexOf(patterns[i].url) == -1) {
     newpatterns[count++] = patterns[i];
     console.log("remove " + patterns[i].name);
  }
}
patterns = newpatterns; 
```

尽管这种方式您最初仍将其全部加载到内存中，但不会保留您在页面的整个生命周期中不需要的对象。

更好的方法是在将每个对象添加到模式数组之前一次测试一个对象，并且只添加与当前 url 相关的对象。

```
var patterns = [];
var count = 0;

var href = window.location.href;

function addPattern(p){
    if (href.indexOf(p.url) != -1) patterns[count++] = p;
}

addPattern({
     name    : 'p1', 
     url     : 'http://www.someurl.com',
     pattern1 : /./,
     pattern2 : /./,
     pattern3 : /./,
   })

addPattern({
     name    : 'p2',
     url     : 'http://www.someurl2.com',
     pattern1 : /./,
     pattern2 : /./,
     pattern3 : /./,
   })

addPattern({
     name    : 'p3',
     url     : 'http://www.someurl3.com',
     pattern1 : /./,
     pattern2 : /./,
     pattern3 : /./,
   }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T22:29:00.767

由于这是一个 GreaseMonkey 脚本，我假设它驻留在用户的机器上，而不是从外部站点生成的。如果不是这种情况，您可能需要考虑根据 URL 动态生成 JavaScript。

否则，您可以将模式分配 JavaScript 存储在单独的文件中，根据加载的站点的 URL 仅检索其中一个文件，并通过 eval() 运行其内容，就像它是一个 JSON 请求一样。

# sql - SQL中有没有办法询问“发生了什么变化？”？

> ID：534431
> 
> 赞同：3
> 
> 时间：2009-02-10T22:06:49.917
> 
> 标签：sql, database, diff

我经常发现自己正在使用一个我还不了解其架构的巨型 RDBMS 进行新项目。我希望能够在数据库中标记一个检查点，在应用程序中做一些事情，然后返回数据库并询问哪些表发生了变化（理想情况下，哪些记录发生了变化）。

有没有办法用 SQL 做这样的事情？我找到[了这个](https://stackoverflow.com/questions/36/check-for-changes-to-a-sql-table)，但它只是 MSSQL（我没有使用）。

它不需要超级高效。它只是在我的开发盒上，如果需要，我可以等待几秒钟，但我正在寻找比“两次转储整个数据库并区分结果”更好的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T22:09:51.080

如果您的 DBMS 支持查询日志记录，请将其打开并 tail -f 记录日志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T22:10:57.067

SQL Server 和 Oracle 都有一个可以启用的功能，称为“更改数据捕获”。您说您没有使用 SQL Server，但如果您使用的是 Oracle，那么这里仍有希望。也许您应该提及您使用的 dbms。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T22:23:02.763

我很漂亮我曾经遇到过一个位于您和服务器之间的 MySQL 代理工具。

我怀疑您会遇到一种适用于每个 SQL 数据库的解决方案。（前后将所有表转储到 .SQL 或 .CSV 文件并进行比较？）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T22:31:24.320

*   将触发器添加到记录所有更改的所有表。
*   检查您是否可以连接到应用程序的数据访问层以记录事物
*   或者它是否支持开箱即用的注销。（我认为 Windows 上的 ODBC 支持这一点。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T22:33:07.373

您最好的选择是查看您的 RDBMS 是否提供可以执行此操作的专有功能，或者添加可以记录事件的更新触发器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T22:35:06.853

在mysql中，我使用一个列

```
modified timestamp 
```

检索更改的行

# c# - ImageButton 事件未在更新面板内触发

> ID：534438
> 
> 赞同：2
> 
> 时间：2009-02-10T22:08:24.513
> 
> 标签：c#, asp.net, updatepanel

这是我的问题的后续行动：

[Asp:Label 在 vi​​sible 设置为 true 时不显示？](https://stackoverflow.com/questions/534045/asplabel-is-not-shown-when-visible-is-set-to-true)

在上面的问题中，我有一些控件的可见性没有设置为 false，因为它们不在`UpdatePanel`. 一旦我将控件放入`UpdatePanel`中，可见性的切换就起作用了，但这给我带来了另一个问题。我有一个`ImageButton`导出到excel的。当按钮不在 an 中`UpdatePanel`时，会触发 click 事件，但现在我将它放在 an`UpdatePanel`中时，不会触发 click 事件。

我也有一个工作正常的下拉菜单。我认为这与`ImageButton`没有`AutoPostBack`财产的事实有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-22T07:20:33.203

我有类似的问题。就我而言，`ImageButtons`位于绑定到`updatepanel`. 但是我在转发器方法`Page.RegisterRequiresRaiseEvent(ImageButton)`内的代码中使用`ItemDataBound`了它，它起作用了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T10:47:14.830

添加`ChildrenAsTriggers="true"`到您的更新面板。如果您有母版页，则可以使用。

如果您的更新面板在 master 中，则您无法添加触发器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-15T18:45:47.310

确保您已将图像按钮关联到 UpdatePanel 上的 PostBackTrigger。如果您使用类似于[Matt Berseth 的方法](http://mattberseth.com/blog/2007/04/export_gridview_to_excel_1.html)导出到 Excel ，则必须使用此触发器才能使导出工作。

```
<asp:PostBackTrigger ControlID="ImageButton1"/> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-20T10:38:27.017

如果您在 itemTemplate 中有一个带有图像按钮的数据列表，则不需要触发器，但`causeValidation = false`它是。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T23:51:59.820

不，ImageButtons 没有 AutoPostBack：它们不像普通按钮那样需要它们。

这种行为听起来很奇怪。我想说的第一件事是将 asp:ImageButton 更改为 asp:Button 并查看是否会改变行为。如果不是，它是一个 ImageButton 的事实是一个红鲱鱼。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-17T12:42:32.250

尝试用菜单（包含单个菜单项）替换 imagebutton 并设置其 imageurl 属性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-18T10:53:26.247

```
myImagebutton.OnClientClick = "return true;"; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-12T21:47:56.647

将“CausesValidation”属性更改为 false。

# sql-server - 使用参数的sql语句很慢，没有参数就快

> ID：534439
> 
> 赞同：1
> 
> 时间：2009-02-10T22:08:52.157
> 
> 标签：sql-server, vb.net, parameters

我在参数化 sql 语句的性能方面遇到了一些麻烦。我正在使用的表有约 150,000 条记录，每条记录有约 30 列。

该语句在 3.5 秒内执行。

```
 Dim selectstring As String
    selectstring = "SELECT * FROM LineInfo WHERE jobNum=@jobnum and revision_number=@revnum AND lineNum=@linenum;"
    Dim selectCommand As New SqlClient.SqlCommand(selectstring, Singleton.DbConnection)
    selectCommand.Parameters.Add("@jobnum", "testing1")
    selectCommand.Parameters.Add("@revnum", "0")
    selectCommand.Parameters.Add("@linenum", 13)

    Dim da As New SqlClient.SqlDataAdapter(selectCommand)
    Dim ds As New DataSet

    Try
        da.Fill(ds)
        MsgBox("Done.")
        ds.Dispose()
    Catch ex As System.Exception
        MsgBox(ex.Message)
    End Try

    da.Dispose() 
```

此 select 语句在 0.0015 秒内执行。

```
 Dim selectstring As String
    selectstring = "SELECT * FROM LineInfo WHERE jobNum='testing1' and revision_number=0 AND lineNum=13;"

    Dim selectCommand As New SqlClient.SqlCommand(selectstring, Singleton.DbConnection)
    Dim ds As New DataTable
    Dim a As New SqlClient.SqlDataAdapter(selectCommand)

    Try
        a.Fill(ds)
        MsgBox("Done.")
        ds.Dispose()
    Catch ex As System.Exception
        MsgBox(ex.Message)
    End Try

    a.Dispose() 
```

我在论坛上读过一些关于参数嗅探的文章，但这似乎与存储过程有关。我不太确定从这里去哪里，所以我想我会在堆栈溢出时在这里尝试一下。有谁知道可能导致此问题的原因是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T22:12:27.687

运行 SQL Profiler 并检查访问数据库的实际 SQL。获取这两个查询并在启用了 Show Execution Plan 的查询分析器/SQL Server Management Studio 中运行它们，并找到花费时间的地方。

如果服务器上的性能相同，则再次检查您的 .NET 代码。你有什么理由在上面的例子中使用 DataSet 而在下面的例子中使用 DataTable 吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T22:12:58.420

我希望您更快的查询时间是因为 SQL Server 之前已经缓存了您的确切查询。尝试更改值，看看它是否仍然运行得很快。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-10T22:19:03.787

我会专门看

```
selectCommand.Parameters.Add("@jobnum", "testing1") 
```

我有过在进行查找之前将整个索引转换为 unicode 的经验。这可能是罪魁祸首。在这种情况下，您要创建一个参数并将其设置为键入 ansi 字符串或类似的类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T22:14:17.043

不能肯定地说（并不是真正了解 SQL 引擎的所有复杂性），但我首先想到的是对数字列使用字符串参数：

```
selectCommand.Parameters.Add("@revnum", "0") 
```

对比

```
revision_number=0 
```

我怀疑如果您在第二个示例中使用字符串而不是数值，它也会减慢速度……试试看，看看会发生什么。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-10T22:53:04.487

我不得不将参数语句更改为：

```
 selectCommand.Parameters.Add("@jobnum", SqlDbType.Char).Value = "testing1"
   selectCommand.Parameters.Add("@revnum", SqlDbType.Int).Value = 0
   selectCommand.Parameters.Add("@linenum", SqlDbType.Int).Value = 13 
```

仅更改 @revnum 参数是不够的，我必须更改所有参数。无论如何，它正在工作，我现在知道如何处理它。

谢谢。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T22:14:28.523

您是否能够一致地重现每个版本的执行时间？您是否有可能先运行参数化版本，然后在运行动态 SQL 版本时查询已被缓存？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T22:17:07.270

我怀疑这是答案，因为我不太了解 VB，但我看到在第一个代码片段中，revnum 设置为“0”，而 linenum 设置为 13（无引号）。

我对 VB 数据类型的了解不够好以至于不能有信心，但是在 SQL 查询过程中 revnum 以字符串形式出现并且必须转换为整数的情况下是否存在一些奇怪的行为？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T22:20:46.670

我相信参数嗅探也适用于此，因为 SQL Server 缓存 SQL 语句的执行计划，就像它对存储过程一样。您可以尝试清除语句缓存并使用相同的参数重新运行语句，看看它是否加快了速度。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-29T10:47:14.667

我不知道您的 .net 驱动程序是否有类似的东西，但 JDBC 驱动程序有一个选项“sendStringParametersAsUnicode”，请参阅[http://msdn.microsoft.com/de-de/library/ms378988.aspx](http://msdn.microsoft.com/de-de/library/ms378988.aspx)。

# asp.net-mvc - .Net mvc 活页夹

> ID：534448
> 
> 赞同：0
> 
> 时间：2009-02-10T22:11:58.313
> 
> 标签：asp.net-mvc, modelbinders

我对 Microsoft 的 mvc 框架中的模型绑定器存在分歧。我的域模型有一个基类，它有一个只读的 id 属性和类型 guid。但是因为它是只读的，所以活页夹不能设置属性的值。那么我完全搞砸了还是有人可以解决我的问题？

编辑：很抱歉，我忘了提及其他信息，我希望活页夹绑定 id 属性的唯一时间是当它是另一个模型对象的相关对象时。就像在这种情况下，当我为帖子选择了一个类别并且我只想要 ORM 的 id 时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T22:20:47.947

活页夹不能设置只读值 - 他们也不应该！常见的情况是您创建了一个模型，它返回一个 ID。

下次您检索该对象时，ID 将传递给构造函数以方便检索该对象。您在任何时候都不需要双向绑定该属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-13T14:05:41.100

我不同意答案，-为什么活页夹不能设置只读或私有属性？这引入了限制并防止对象是不可变的。（您当然可以实现自己的模型绑定器）

我不是活页夹或反射方面的专家，但我猜想标准实现使用反射和反射不会设置不设置私有属性的限制。

# c# - XML 反序列化和松散数组项

> ID：534451
> 
> 赞同：3
> 
> 时间：2009-02-10T22:12:24.817
> 
> 标签：c#, arrays, xml-serialization

因此，我正在处理一些我认为很可能格式不正确的 XML 文件，并且我试图弄清楚如何以及是否可以使用 XmlSerializer 将此 XML 反序列化为逻辑业务对象。假设我有以下 XML 文件：

```
<Root>
   <ArrayType1 Name="Bob"/>
   <ArrayType1 Name="Jim"/>
   <ArrayType2 Name="Frank">
      <SubItem Value="4"/>
   </ArrayType2>
   <ArrayType2 Name="Jimbo">
      <SubItem Value="2"/>
   </ArrayType2>
</Root> 
```

现在我想创建一个具有这三种类型的类，Root、ArrayType1 和 ArrayType2，但我想在 Root 中获取两个列表，一个包含 ArrayType1 项的集合，一个包含 ArrayType2 项的集合，但似乎这些项目需要有某种根，例如，我知道如何反序列化以下内容就好了：

```
<Root>
   <ArrayType1Collection>
      <ArrayType1 Name="Bob"/>
      <ArrayType1 Name="Jim"/>
   </ArrayType1Collection>
   <ArrayType2Collection>
      <ArrayType2 Name="Frank">
         <SubItem Value="4"/>
      </ArrayType2>
      <ArrayType2 Name="Jimbo">
         <SubItem Value="2"/>
      </ArrayType2>
   </ArrayType2Collection>
</Root> 
```

但是，如果没有 ArrayType# 元素周围的父 ArrayType#Collection 元素，我将如何反序列化呢？

XML 序列化器会允许这样做吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T22:22:20.363

不就是这样吗：

```
[Serializable]
public class Root {
    [XmlElement("ArrayType1")]
    public List<ArrayType1> ArrayType1 {get;set;}

    [XmlElement("ArrayType2")]
    public List<ArrayType2> ArrayType2 {get;set;}
} 
```

?

或者，只需将 xml 放入文件（“foo.xml”）并使用：

```
xsd foo.xml
xsd foo.xsd /classes 
```

并查看生成的 foo.cs

# .net - WinForms：设计与代码

> ID：534467
> 
> 赞同：2
> 
> 时间：2009-02-10T22:16:20.377
> 
> 标签：.net, winforms

我是在 VS2008 中构建 WinForm 应用程序、C# 和 .Net 3.5 的独立开发人员。

它本质上是一个美化的数据输入和检索应用程序。我的问题是，将 %60 + 的时间花在“设计”上是否正常？

UI，放置所有控件，直观地命名控件，在 UI 控件上设置属性（修改器，onFocused 颜色等）。似乎每 30 分钟我花在编写代码上的时间就会有两倍的时间弄乱 UI。我究竟做错了什么？

我意识到这是一个不可能回答的问题，所以我会接受一些一般性的建议。

*   有没有办法为所有 UI 控件默认设置某些属性设置？
*   有没有更快的方法来编辑现有的然后单击和编辑？
*   这真的是我缺乏计划的产物吗？解决方案是计划并写下所有这些，以便我第一次就做对了吗？

这真的很令人沮丧，因为我喜欢编码方面，但我觉得我花了更多时间确保我的字体可读（我有一个半年长的用户群）！

* * *

编辑根据反馈进一步阐述！

我正在制作的应用程序是 webform、ASP.Net 应用程序的 winform 端口。功能齐全，正在使用中。此时我不允许更改数据库层，但由于 WinForm 与 WebForm 的性质，UI 发生了重大变化。我将把 DAL 和 BLL 留到最后，所以我可以先看看我可以重复使用多少。

我知道这可能不正常，但在这种情况下似乎最有意义。这是否使我的问题更清楚？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T22:28:05.717

> 有没有更快的方法来编辑现有的然后单击和编辑？

您可以按住 CTRL+单击具有公共属性（例如 Font、ForegroundColor 或其他）的多个表单控件，然后一次更改所有控件。各种控件的属性也定义在表单代码的顶部（我相信该部分通常默认折叠）。当您使用表单设计器进行更改时，这些属性会自动更新，但您可以在代码中修改它们，如果您有很多类似的更改要进行，请使用 Find+Replace。

> 这真的是我缺乏计划的产物吗？解决方案是计划并写下所有这些，以便我第一次就做对了吗？

虽然做计划总是好的，但我认为我从来没有做过一个完整的项目，我没有忘记在我的计划中考虑*一些事情。*很多时候，您只是没有注意到需要添加的某些内容，直到您能够浏览表单。

> 有没有办法为所有 UI 控件默认设置某些属性设置？

routeNpingme 的解决方案是一个很好的解决方案。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T22:21:59.443

不要感觉太糟糕 - 这听起来不像你在这个应用程序的背景下做火箭科学，所以你**应该**花更多的时间来确保 UI 是正确的。

如果您还没有这样做，请快速注意 - 当您第一次创建表单时，请在表单级别设置字体。然后你放在它上面的任何东西都会默认继承该字体。

这些小小的接触对您的用户体验大有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T22:55:22.547

使用继承来集中您自己的定制，例如

添加一个名为 MyButton 的类，例如：

```
using System;
using System.Drawing;
using System.Windows.Forms;

namespace MyApp
{
  class MyButton : Button
  {
    public MyButton()
    {
      this.BackColor = Color.Pink;
      this.Font = new Font(SystemFonts.DialogFont.FontFamily, 12, FontStyle.Bold, GraphicsUnit.Point);
    }

    protected override Size DefaultSize
    {
      get
      {
        return new Size(150, 50);
      }
    }
  }
} 
```

它将在工具箱中显示为一个控件，您可以将其拖放到窗体上而不是常规按钮上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T03:12:09.307

你可能正在倒退。*在*您完成使其工作之前，您不应该真正关心字体、颜色、位置和外观。这样可以节省大量时间来调整您最终可能会丢弃的控件。即使你有一个很好的 UI 模型，之后仍然要做。或者当代码没有流动时。顺便说一句，这可能是另一种解释......

# javascript - 将任意 Flash 对象 wmode 更改为透明

> ID：534474
> 
> 赞同：10
> 
> 时间：2009-02-10T22:17:48.003
> 
> 标签：javascript, flash, object, swfobject, wmode

我需要将`wmode`任意 Flash 对象从外部 js 文件更改为透明，以确保它们不会在不使用 Jquery 或类似库的情况下隐藏菜单。

在 FF 我使用`getElementsByTagName("embed")`并设置属性。它似乎运作良好。

具体来说，我在 IE7 中`object`由`swfObject`库设置时遇到问题。

`swfObject`在 iE7 中创建以下代码：

```
<OBJECT id=mymovie height=400 width=134 classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000>
        <PARAM NAME="_cx" VALUE="3545">
        <PARAM NAME="_cy" VALUE="10583">
        <PARAM NAME="FlashVars" VALUE="">
        <PARAM NAME="Movie" VALUE="imgs/site/tower.swf">
        <PARAM NAME="Src" VALUE="imgs/site/tower.swf">
        <PARAM NAME="WMode" VALUE="Window">
        <PARAM NAME="Play" VALUE="0">
        <PARAM NAME="Loop" VALUE="-1">
        <PARAM NAME="Quality" VALUE="High">
        <PARAM NAME="SAlign" VALUE="">
        <PARAM NAME="Menu" VALUE="-1">
        <PARAM NAME="Base" VALUE="">
        <PARAM NAME="AllowScriptAccess" VALUE="">
        <PARAM NAME="Scale" VALUE="ShowAll">
        <PARAM NAME="DeviceFont" VALUE="0">
        <PARAM NAME="EmbedMovie" VALUE="0">
        <PARAM NAME="BGColor" VALUE="FFFFFF">
        <PARAM NAME="SWRemote" VALUE="">
        <PARAM NAME="MovieData" VALUE="">
        <PARAM NAME="SeamlessTabbing" VALUE="1">
        <PARAM NAME="Profile" VALUE="0">
        <PARAM NAME="ProfileAddress" VALUE="">
        <PARAM NAME="ProfilePort" VALUE="0">
        <PARAM NAME="AllowNetworking" VALUE="all">
        <PARAM NAME="AllowFullScreen" VALUE="false">
</OBJECT> 
```

我尝试了所有可能的方法来设置`wmode`并`transparent`让闪光灯在没有成功的情况下不隐藏浮动对象，包括但不限于：

1.  搜索`OBJECT`并将其更改`PARAM` `wmode`为`transparent`.
2.  `Object`设置( `wmode=transparent`)的属性
3.  调用`object`'`SetValue`函数

似乎没有一个工作。尽管 wmode 似乎改变了 Flash 仍然隐藏了其他具有高`z-index`. 我在这里想念什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-12-27T14:12:24.337

我用这个小技巧成功了：

```
$("embed").attr("wmode", "opaque").wrap('<div>'); 
```

它有效地重绘了 flash 对象，对我有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-12-22T18:12:00.160

一般来说，Cirday 的解决方案是正确的。这是一个非 jQuery 版本，适用于 IE、FF 和 Chrome：

```
var embed = document.getElementsByTagName('embed');
for(var i = 0; i < embed.length; i++){
    embed[i].setAttribute('wmode','opaque');
}
// FF does a "live" array when working directly with elements,
// so "els" changes as we add/remove elements; to avoid problems
// with indexing, copy to a temporary array
var els = document.getElementsByTagName('object');
var obj = [];
for(var i = 0; i < els.length; i++){
   obj[i] = els[i];
}
for(var i = 0; i < obj.length; i++){
    var param = document.createElement('param');
    param.setAttribute('name','wmode');
    param.setAttribute('value','opaque');
    obj[i].appendChild(param);

    var wrapper = document.createElement('div');
    obj[i].parentNode.appendChild(wrapper);

    if(obj[i].outerHTML){
        // IE
        var html = obj[i].outerHTML;
        obj[i].parentNode.removeChild(obj[i]);
        wrapper.innerHTML = html;
    }else{
        // ff/chrome
        obj[i].parentNode.removeChild(obj[i]);
        wrapper.appendChild(obj[i]);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T22:24:21.823

当您使用 SWFObject 包含 flash 时，embedSWF 方法中应该有一个名为“params”的参数。你像这样将一个对象传递给它：

```
swfobject.embedSwf(blah,blah,blah, { wmode:'transparent'}); 
```

[更多在这里](http://code.google.com/p/swfobject/wiki/documentation)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-25T14:03:05.613

需要重新发布 Flash 电影以更改 wmode 参数是不正确的 - 这是一个神话：

[http://www.communitymx.com/content/article.cfm?cid=E5141](http://www.communitymx.com/content/article.cfm?cid=E5141)

我有同样的菜单问题，我需要一些代码来将 wmode 参数添加到 javascript 调用的任何 flash 对象中。

我认为原始帖子与此有关，但我不确定从哪里开始并且需要更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T09:43:49.087

I'm almost 100% sure that you cannot change the wmode parameter at runtime. I mean, you technically can, but won't have any effect. I'm actually surprised that you got any successful attempts. What Flash player version and browser did you try successfully?

I'm sorry I can't find any official link to prove my point, but I'll leave you this very interesting link about how wmode works (updated to player 10):

[What does GPU acceleration mean?](http://www.kaourantin.net/2008/05/what-does-gpu-acceleration-mean.html)

Cheers,

Juan

# java - 将 IntelliJ IDEA 8 用于 IDEA 6 项目

> ID：534494
> 
> 赞同：1
> 
> 时间：2009-02-10T22:24:36.143
> 
> 标签：java, intellij-idea

我的一个客户正在为他们的项目使用 IDEA 6，我想使用 IDEA 8。我知道 IDEA 8 提供了升级项目或将其保留为 v6 格式的选项。如果我使用 IDEA 8 但将其保留为 v6 格式，这会给 IDEA 6 用户带来任何痛苦吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T21:27:13.167

IDEA 一直升级我的项目文件没有问题，但我不认为它是向后兼容的。如果要保持向后兼容性，请仅将 IDEA 6 项目文件存储在版本控制中，并将 IDEA 8 项目文件仅保留在本地。

另一种可能性是根本不将 IDEA 项目文件存储在版本控制中。使用 Maven 或其他东西来管理项目依赖项。从 IDEA 7 开始，可以将 Maven 项目导入 IDEA。（我建议从 6 升级到至少 7 只是为了提高性能，更不用说其他新功能了。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T22:57:40.480

除非项目文件发生很大变化，否则您可能只想复制 v6 项目文件并让 Idea 将它们升级到 v8。这将避免任何会导致想法 6 出现问题的更改（有意或其他）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T22:58:55.487

我最近在保留版本 6 文件的同时从 6 升级到 IJ8 的经历非常混乱（文件编码管理不善、ant 文件倾斜、各种冻结），我将 IntelliJ 8 重命名为“StoopidJ”。

我的建议是，如果您可以保留第 6 版，请保留它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T19:25:13.930

我建议您不要在用户之间共享项目文件。如果您复制他们的项目文件，请将其保留为本地副本。

# web-applications - 将大型战争上传到 glassfish 的问题

> ID：534502
> 
> 赞同：0
> 
> 时间：2009-02-10T22:27:58.663
> 
> 标签：web-applications, glassfish

所以我们的战争文件最近从大约 55MB 膨胀到超过 100MB。此时，在管理员中通过上传进行部署停止工作。从命令行部署和从本地文件系统部署仍然有效。通过实验，我们确定故障点在 95 - 100 MB 之间，因为 95 MB 的战争部署成功，而 100 MB 则没有。

失败是无信息的。

1.  转到管理应用程序
2.  单击树中的“Web 应用程序”
3.  点击“部署...”
4.  如果还没有，请选择“要上传到服务器的打包文件”
5.  单击“浏览...”并选择战争文件
6.  点击“确定”

此时会搅动几秒钟，然后返回部署屏幕，就好像什么都没发生一样。日志中也没有任何异常。无论服务器是否在我们的本地机器上，都会发生这种情况。

我们所有的 QA 程序都使用这种部署方法，因此切换到替代方案会很痛苦。客户也可能会引起恶臭。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T22:40:07.013

似乎这是一个可配置的限制。[Glassfish 论坛](http://forums.java.net/jive/thread.jspa?messageID=319318&#319318)中有一个关于 100MB EAR 文件的主题。

按照线程的建议，我修改`$GLASSFISH_HOME/lib/install/applications/adminGUI/adminGUI_war/WEB-INF/web.xml`了，将`maxSize`参数增加到 200000000。

```
 <filter-name>UploadFilter</filter-name>
    <filter-class>com.sun.webui.jsf.util.UploadFilter</filter-class>
    <init-param>
            <param-name>maxSize</param-name>
            <param-value>100000000</param-value>
    </init-param> 
```

# javascript - 在构建过程中缩小后更新 javascript 引用

> ID：534503
> 
> 赞同：1
> 
> 时间：2009-02-10T22:28:04.560
> 
> 标签：javascript, asp.net-mvc, minify

缩小 JavaScript 引用后更新它们的最佳方法是什么（我使用 YUI Compressor）？

我正在使用 ASP.NET mvc，并且在开发期间每个文件中都有一堆或 javascript 引用。在构建时（使用 MSBuild），我将所有文件缩小为单个文件。同时我想用单个引用替换所有引用。这应该是一件很常见的事情，但我找不到一个很好的干净的自动化方法来做到这一点。

有人有想法么？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T09:39:47.863

我们使用自定义脚本管理器。在我们的 msbuild 过程中，YUI Compressor 用于创建缩小版本，也可以将几个较小的 .js 文件合并为一个较大的文件。这减少了请求的数量，从而减少了加载时间。缩小版本和组合版本与可调试版本并排创建。

在运行时，控件调用脚本管理器来注册特定的脚本，这些脚本由它们的最小化名称引用。然后，脚本管理器将仅在 DEBUG 模式下包含这些脚本（尽管我们执行了一个技巧，即在 HEAD 中包含脚本，而不是像 ClientScriptManager 那样包含正文）。在 RELEASE 模式下，脚本管理器将用它们的缩小副本替换它已知的某些脚本。在脚本组合成一个文件的情况下，管理器会被多次调用，每次都注册同一个组合的、缩小的文件。一些文件在外部托管：这也由脚本管理器处理。

缺点：

*   什么文件被缩小的知识是重复的：脚本管理器和构建脚本都必须同步。
*   添加新脚本时，它们不会自动缩小（我个人认为这是一个好点；我希望缩小成为一种选择）

顺便说一句：我们不使用 C# 端口在 MSBuild 中运行。当我第一次尝试它时，它有太多的错误。我们只是用一个 Exec 任务调用 YUI Compressor。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T00:08:34.600

有几个想法浮现在脑海：

1) 利用发布的修补程序以允许 .js 文件的调试/智能版本：[KB958502](http://code.msdn.microsoft.com/KB958502/Release/ProjectReleases.aspx?ReleaseId=1736)

这将允许您编写（尽管是一个）大的、完全可读的 js 文件，但请参阅脚本 src 中的完整版本，该版本可以在构建期间生成。hofix 使 VS 能够查找名为“-vsdoc.js”或“.debug.js”的文件来代替引用的文件（因此您在 src 属性中引用“/scripts/myscript.js”，但 IDE 将首先查找对于“/scripts/myscript-vsdoc.js”，然后是“/scripts/myscript.debug.js”，最后它会查找“/scripts/myscript.js”——更多信息可以在[Visual Web上找到开发者团队博客](http://blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to-enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx)。

2) 其他人发布了他们编写的[自定义脚本管理器](http://www.west-wind.com/WebLog/posts/413878.aspx)，该管理器将在调试期间引用主版本，但在发布模式下会请求最小化版本。

3）我确定我在某个地方读到过，虽然我现在找不到，关于有人编写了自己的 HTML 帮助扩展方法，这将根据 buid 模式适当地生成脚本调用 - 类似于 Rick 的过程想法，但允许您以更“通常”的方式工作，尽管我不确定它与智能感知的效果如何。

我目前倾向于 1 - 使用类似于 Nick Berardi 的过程：[如何创建 YUI Compressor MSBuild 任务](http://www.coderjournal.com/2008/05/how-to-create-a-yui-compressor-msbuild-task/)以生成最小化的 js。

# php - PHP 中的软件包？

> ID：534507
> 
> 赞同：13
> 
> 时间：2009-02-10T22:29:21.483
> 
> 标签：php, oop

是否可以创建相关类的包并具有仅对同一包中的类可见的相同`protected`和字段？`private`

基本上，与 Java 具有相同类型的包。是否可以？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T22:34:04.297

目前，还没有包的概念。

然而，PHP 5.3 将引入[命名空间](http://www.php.net/manual/en/language.namespaces.faq.php)。我不确定这将如何影响类之间的可见性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T22:33:05.220

没有。PHP 没有包或友元类支持。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T12:50:59.273

您可能有兴趣阅读[http://philsturgeon.co.uk/blog/2012/03/packages-the-way-forward-for-php](http://philsturgeon.co.uk/blog/2012/03/packages-the-way-forward-for-php)

简短的回答 - [http://getcomposer.org/](http://getcomposer.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-09-06T21:55:13.033

以下是我在思考同一问题时偶然发现的两种方法：

[在 PHP 中模拟包](http://www.codediesel.com/php/simulating-packages-in-php/)

[PHP 包管理和自动加载](http://jacwright.com/40/php-package-management-and-autoloading/)

看起来[PHP require_once() 文档](http://php.net/manual/en/function.require-once.php)中还有更多的导入类似物。希望它可以帮助某人前进。

# javascript - JavaScript/jQuery - offsetLeft 和 offsetTop

> ID：534511
> 
> 赞同：4
> 
> 时间：2009-02-10T22:30:17.770
> 
> 标签：javascript, jquery

当悬停在一个跨度上时，我想获得 offsetLeft 和 offsetTop 值，这样我就可以在它附近悬停一些东西。当我这样做时，两个值都为 0。

有什么更好的方法来解决这个问题？我正在使用 jQuery。

假设我从（由服务器端脚本循环）开始：

```
<span onmouseover="hoverNearMe(this.offsetLeft,this.offsetTop);">some username</span><br /> 
```

**最后的想法：**
我根据“代码杠杆”/DRY给出答案。您可以在自己的 js 库中一遍又一遍地使用更长的函数。然而，第二个简短的答案也是 100% 正确的。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-10T22:35:46.197

`$(this).offset().left`和`$(this).offset().top`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-10T22:33:59.180

我认为你应该能够做到这一点：

**HTML**

```
<span class="get-close-to">some username</span><br /> 
```

**jQuery**

```
jQuery('.get-close-to').hover(function() {
    var offset = jQuery(this).css('offset');
    alert( 'Left: ' + offset.left + '\nTop: ' + offset.top );
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-07-07T15:27:48.320

为什么需要服务器端脚本？

试试这个：

```
 var positionImg = function(e) {
        $(this).offset();
    var zoomCntnrPos = $(this).offset.top;
      if (zoomCntnrPos >= maxBottomVPos)
      {
           tPosX = e.pageX;
           tPosY = e.pageY +20;
          }
      else if (zoomCntnrPos <= maxTopVPos){
           tPosX = e.pageX;
           tPosY = e.pageY +40;
          }
      else
          {
           tPosX = e.pageX;
           tPosY = e.pageY -100;  
          }
        $zoomContainer.css({top: tPosY, left: tPosX});
    }; 
```

# c# - 使用套接字的简单 Http 代理：问题

> ID：534512
> 
> 赞同：1
> 
> 时间：2009-02-10T22:30:48.127
> 
> 标签：c#, .net, sockets, proxy

我正在尝试了解套接字在 C# 中的工作原理。我的想法是编写一个简单的 http 代理：这是我的代码：

```
using System;
using System.IO;
using System.Net;
using System.Net.Sockets;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading;

class Program
{
    static void Main(string[] args)
    {
        ThreadPool.SetMaxThreads(1000, 500);
        ThreadPool.SetMinThreads(500, 250);

        TcpListener listener = new TcpListener(IPAddress.Any, 8282);
        listener.Start();

        while (true)
        {
            Socket client = listener.AcceptSocket();
            ThreadPool.QueueUserWorkItem(ProcessSocket, client);
        }
    }

    private static readonly string patternHostPort = @"(Host:\s)(\S+)(:)(\d+)";
    private static readonly string patternHost = @"(Host:\s)(\S+)";
    private static Regex regexHostPort = new Regex(patternHostPort);
    private static Regex regexHost = new Regex(patternHost);

    static void ProcessSocket(object request)
    {
        string requestString = string.Empty;
        MemoryStream mStream = new MemoryStream();
        int bytesReceived;
        int bytesSended;
        byte[] buffer;
        byte[] byteOriginalRequest;

        Socket socketClient = (Socket)request;
        Console.WriteLine("Incoming connection: " + socketClient.RemoteEndPoint.ToString());

        buffer = new byte[4096];

        bytesReceived = socketClient.Receive(buffer, 0, buffer.Length, SocketFlags.None);
        mStream.Write(buffer, 0, bytesReceived);
        while (socketClient.Available > 0)
        {
            bytesReceived = socketClient.Receive(buffer, 0, buffer.Length, SocketFlags.None);
            mStream.Write(buffer, 0, bytesReceived);
        }

        mStream.Close();

        byteOriginalRequest = mStream.ToArray();
        requestString = Encoding.ASCII.GetString(byteOriginalRequest);
        //Console.WriteLine(requestString);

        #region Get requested Host and Port
        string srvHost = string.Empty;
        string srvPort = string.Empty;

        Match matchHostPort = regexHostPort.Match(requestString);
        if (matchHostPort.Success)
        {
            srvHost = matchHostPort.Groups[2].Value;
            srvPort = matchHostPort.Groups[4].Value;
        }
        else
        {
            Match matchHost = regexHost.Match(requestString);
            if (matchHost.Success)
            {
                srvHost = matchHost.Groups[2].Value;
                srvPort = "80";
            }
            else
            {
                Console.WriteLine("Invalid request?");
            }
        }
        #endregion

        Console.WriteLine(string.Format("Request to {0} on port {1}", srvHost, srvPort));

        IPAddress[] ipAddress = Dns.GetHostAddresses(srvHost);
        IPEndPoint endPoint = new IPEndPoint(ipAddress[0], int.Parse(srvPort));

        using (Socket socketProxy = new Socket(endPoint.AddressFamily, SocketType.Stream, ProtocolType.Tcp))
        {
            socketProxy.Connect(endPoint);

            bytesSended = socketProxy.Send(byteOriginalRequest, byteOriginalRequest.Length, SocketFlags.None);

            MemoryStream m2Stream = new MemoryStream();
            bytesReceived = 1;
            while (bytesReceived > 0)
            {
                bytesReceived = socketProxy.Receive(buffer, 0, buffer.Length, SocketFlags.None);
                m2Stream.Write(buffer, 0, bytesReceived);
            }

            m2Stream.Close();
            byte[] finalResponse = m2Stream.ToArray();
            string stringFinalResponse = Encoding.ASCII.GetString(finalResponse);

            bytesSended = socketClient.Send(finalResponse, finalResponse.Length, SocketFlags.None);

            socketProxy.Close();
        }

        socketClient.Close();
    }
} 
```

这里有一些问题：

**1）**为什么如果我更换这个

```
bytesReceived = 1;
while (bytesReceived > 0)
{
    bytesReceived = socketProxy.Receive(buffer, 0, buffer.Length, SocketFlags.None);
    m2Stream.Write(buffer, 0, bytesReceived);
} 
```

有了这个

```
while (socketProxy.Available > 0)
{
    bytesReceived = socketProxy.Receive(buffer, 0, buffer.Length, SocketFlags.None);
    m2Stream.Write(buffer, 0, bytesReceived);
} 
```

我只得到一个空页面（在浏览器中）？

**2）**也许与1）有关，但是......使用当前代码加载任何简单页面（如google）需要一段时间，调试我发现问题可能出在socketProxy.Receive中......但我没有不知道为什么。

**3)**有什么区别吗

```
socketProxy.Send(byteOriginalRequest, byteOriginalRequest.Length, SocketFlags.None); 
```

或者

```
socketProxy.Send(byteOriginalRequest); 
```

? （更多参数不是有效答案:)

**4)**有什么推荐的读物吗？书，教程，...？

**5)**还有其他学习套接字的建议吗？

谢谢你的时间。最好的祝福。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T22:48:47.913

1) Socket.Available 如果在您调用它的那一刻缓冲区中没有可用数据，则返回零。如果尚无可用数据，则 Socket.Read 将阻止（等待）数据到达。所以这就是区别。通过调用 Read，你让它等待数据。通过检查可用，您不会让它等待。因此，如果您碰巧在数据到达之前查看了可用，它将为零。

2）不知道为什么它很慢，但是您不需要为要发送回客户端的数据使用内存缓冲区，因为您不检查它。只需从一个套接字读取并直接写入另一个。

3) 这两个调用是相同的。

至于 4) 和 5)，CLR 套接字 API 非常接近原始 C API，因此如果 C# 教程很难找到，您可以查看任何有关 C 中良好套接字编程的教程或信息以获取更多提示。

此外，您应该在调用 Close 之前调用 Shutdown。当您调用 Close 时，套接字断开连接，这意味着另一端失去连接并且无法读取他们尚未读取的任何数据 - 另一端的缓冲区被操作系统破坏并且数据被丢弃。调用 Shutdown(SocketShutdown.Send) 会导致另一端在调用 Read 时获得零字节（在他们读取剩余数据之后）。因此，您调用 Read 直到它返回零，这告诉您另一端已获取所有数据并且还调用了 Shutdown。然后你可以调用关闭。

最后，当您最后一次调用 Send 将所有数据发送回客户端时，它可能不会一次性发送所有数据。因此，您应该循环并继续发送剩下的任何内容，直到全部发送完毕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T22:52:13.643

如果这是您的第一个 Sockets 项目，我强烈建议您从“聊天”应用程序开始。无论哪种方式，一个有价值的测试工具也是一个名为 WinsockTool 的小工具。

不知道您是否可以在此处直接发布指向 .MSI 文件的链接，但如果这不起作用：

[http://www.isatools.org/tools/winsocktool.msi](http://www.isatools.org/tools/winsocktool.msi)

谷歌**网站：isatools.org WinsockTool**

这对于连接到您的“服务器”套接字并发送原始文本并查看原始响应而无需创建客户端应用程序非常棒。

# excel - 如何让 VBA 宏在整个工作簿的公式中执行搜索/替换？

> ID：534522
> 
> 赞同：1
> 
> 时间：2009-02-10T22:33:06.187
> 
> 标签：excel, replace, vba

我将 Excel 工作簿分发给许多用户，他们*应该*在他们的 XLSTART 文件夹中预先安装了一个特定的宏文件。

如果他们没有正确安装宏，并且他们将工作簿发回给我，则任何依赖于它的公式都包含宏的完整路径，例如：

```
'C:\Documents and Settings\richard.tallent\Application Data\
Microsoft\Excel\XLSTART\pcs.xls'!MyMacroFunction() 
```

我想创建一个快速宏，可用于从*工作簿中的每个公式中*删除不正确的路径。

我已经使用 GetSpecialFolder（一个运行良好的外部函数）成功检索了特殊文件夹，但是下面显示的 Replace 调用本身会引发“应用程序定义或对象定义错误”。

```
Public Sub FixBrokenMacroFormulas()
  Dim badpath As String
  badpath = "'" & GetSpecialFolder(AppDataFolder) & "\Microsoft\Excel\XLSTART\mymacro.xls'!"
  Dim Sheet As Worksheet
  For Each Sheet In ActiveWorkbook.Sheets
      Call Sheet.Activate
      Call Sheet.Select(True)
      Call Selection.Replace(What:=badpath, Replacement:="", LookIn:=xlFormulas)
      ''//LookAt:=xlPart, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
  Next
End Sub 
```

自动搜索和替换并不是我的强项，我做错了什么？

我已经注释掉了一些看起来并不重要的参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:26:57.423

不需要使用这样的函数，您可以只使用以下语句：

```
 'Replace with a reference to other workbook
  xlBook.ChangeLink Name:= _
     "C:\LISTADOS\reporte_gestion_sucursales\modelo_vaciado\modelo_reporte.xlsx", _
     NewName:=fileIn2, Type:=xlExcelLinks 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T23:41:55.710

尝试以下操作：

```
Sub FormulaFindAndReplace(phrase As String)
  For Each Sheet_Select In ActiveWorkbook.Worksheets
    Sheet_Select.Activate
    Set Found_Link = Cells.Find(what:=phrase, After:=ActiveCell, _
        LookIn:=xlFormulas, lookat:=xlPart, searchorder:=xlByRows, _
        searchdirection:=xlNext, MatchCase:=False)
    While UCase(TypeName(Found_Link)) <> UCase("Nothing")
       Found_Link.Activate
       Found_Link.Formula = Replace(Found_Link.Formula, phrase, "")
       Set Found_Link = Cells.FindNext(After:=ActiveCell)
    Wend
  Next Sheet_Select
End Sub 
```

我称之为：

```
FormulaFindAndReplace "'" & GetSpecialFolder(AppDataFolder) & "\Microsoft\Excel\XLSTART\mymacro.xls'!" 
```

这是被黑客入侵的：

[删除公式链接的宏](http://support.microsoft.com/kb/126093)

# apache-flex - 使用 Adob e Flex SDK 3.0（最新），您可以创建“图表”吗？

> ID：534524
> 
> 赞同：2
> 
> 时间：2009-02-10T22:33:16.450
> 
> 标签：apache-flex, adobe, mxml

只是在网上搜索，看起来你不能。看来您需要 Flex 构建器。我试图避免使用完整的 GUI 工具。有没有办法绕过这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T09:07:43.557

最新的 Flex SDK 是 3.2，不，它们不包括图表组件。您需要包含图表组件的 Flex Builder 3 Professional 许可证。

如果您已经拥有它并且需要为您的项目迁移到新版本的 SDK，那么您需要手动将图表组件 swcs 复制到新的 SDK 文件夹中。刚刚搜索了执行此操作的说明：

> 如果您的应用程序使用 Flex Builder Professional 功能，例如数据可视化组件或自动化测试，您需要将这些元素从 Flex Builder 附带的最新里程碑 SDK 复制到新下载的 SDK 中。您需要复制的相关文件是：
> 
> {sdkdir}/frameworks/libs/automation*.swc
> 
> {sdkdir}/frameworks/libs/datavisualization.swc
> 
> {sdkdir}/frameworks/locale/en_US/automation*.swc
> 
> {sdkdir}/frameworks/locale/en_US/datavisualization_rb.swc
> 
> {sdkdir}/frameworks/locale/ja_JP/automation*.swc
> 
> {sdkdir}/frameworks/locale/ja_JP/datavisualization_rb.swc
> 
> {sdkdir}/frameworks/rsls/datavisualization_3.0.0.477.*（或更新的内部版本号以供以后构建）
> 
> {sdkdir}/fbpro (如果你关心源)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T09:00:23.823

图表组件是 Flex Builder Professional 的一部分。如果您有图表 swc，您可以在没有 Flex Builder 的情况下使用图表。您需要拥有有效的许可证才能去除水印。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T09:20:18.393

除了 Christophe，您还可以滚动您自己的图表组件。这并不难。

# sql - SQL Server 2000 中的多参数搜索

> ID：534530
> 
> 赞同：2
> 
> 时间：2009-02-10T22:34:31.533
> 
> 标签：sql, sql-server, vb.net

我在 Visual Basic .Net 应用程序中有一个搜索屏幕，其中包含以下文本框：

1.  名字 Varchar(50)
2.  姓氏 Varchar(50)
3.  中间名 Varchar(50)
4.  出生日期时间
5.  家庭电话 Varchar(10)
6.  工作电话 Varchar(10)

我将如何在 SQL Server 2000 中创建一个存储过程，使我能够搜索所有/某些/一个字段。如果用户只输入名字和家庭电话号码的数据，我需要为未输入数据的其余参数做什么。我尝试了下面的 select 语句，但它不能正常工作。

```
 Select Last_Name, First_Name, Mid_Name, DOB, Home_Phone, Work_Phone from dbo.tblClient
Where Last_Name Like '%@LastName' and
    First_Name Like '%@FirstName' and
    Mid_Name Like '%@MiddleName' and
    DOB Like '%DOB' and
    Home_Phone Like '%@HomePhone' and
    Work_Phone Like '%@WorkPhone' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T22:44:10.247

我经常使用这种模式：

 `````
Select Last_Name, First_Name, Mid_Name, DOB, Home_Phone, Work_Phone from dbo.tblClient
Where (@LastName is null or Last_Name Like '%'+ @LastName)
and (@FirstName is null or First_Name Like '%'+ @FirstName)
and (@HomePhone is null or Home_Phone Like '%'+ @HomePhone)
-- etc... 
````  `它将忽略任何未提供的内容，同时仍然提供良好的性能。更好的是，它不借助动态 SQL 来实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T22:40:40.490

快速的方法是这样的

其中 (Last_Name Like @LastName + '%' OR @LastName IS NULL) 和 (First_Name Like @FirstName + '%' OR @FirstName IS NULL) 等等...

[Erland Sommarskog 有一些很棒的文章，介绍了执行此](http://www.sommarskog.se/dyn-search.html)操作的不同方法及其对性能的影响

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T22:46:10.553

在您的存储过程或 VB 中，您将不得不决定如何处理无输入。例如我使用：

```
IF ltrim(rtrim(@FirstName)) = ''
SET @FirstName = null 
```

...在我的存储过程中。您可能必须尝试使用​​ OR 而不是 AND。您基本上是在告诉您的查询，您必须使用 AND 满足所有这些条件，无论没有任何输入可以通过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T22:47:14.903

一个快速而肮脏的解决方案。

```
Select Last_Name, First_Name, Mid_Name, DOB, Home_Phone, Work_Phone from dbo.tblClient
Where (Last_Name Like '%' + @LastName OR @LastName Is Null) and
(First_Name Like '%' + @FirstName OR @FirstName Is Null) and
(Mid_Name Like '%' + @MiddleName OR @MiddleName Is Null) and
(DOB Like '%' + @DOB OR @DOB Is Null) and
(Home_Phone Like '%' + @HomePhone OR @HomePhone Is Null and
(Work_Phone Like '%' + @WorkPhone OR @WorkPhone Is Null) 
```

注意我已经更正了参数用法。难道你不也想在参数的另一边也有一个通配符吗？另外，您真的会使用 Like to a Date of Birth 字段吗？

这在一张大桌子上表现不佳。一个性能更高的解决方案是使用 Where 子句中的必填字段来构造 SQL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T22:53:15.950

只是为了澄清为什么您的原始 SQL 不起作用；

您需要将 % 通配符连接到参数值，但是您编写的是创建一个包含通配符和参数名称的文字字符串，例如

`Work_Phone Like '%@WorkPhone'`

应该写成

`Work_Phone Like '%' + @WorkPhone`

如果您为没有输入值的参数返回一个空字符串（即您返回“”，而不是 NULL），那么您拥有的 SQL 应该可以工作 - 这些字段的 Like 比较将只包含 % 通配符（即匹配任何值）。但是，这不是很有效，因为理想情况下您只想对用户输入值的字段进行比较。这可能需要一些动态生成的 SQL，如 kenj 链接的文章所示。

如果您的 tblClient 表不是那么大，那么您所做的可能就足够了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T23:09:24.477

如何使用 ISNULL() 函数来确定一个值是否已传递到存储过程中，如果没有，设置 WHERE 子句字段值以在每种情况下搜索等于自身（*如果有人能想到更好的词选择描述这一点，我会更新答案*）。

```
 SELECT 
     Last_Name, 
     First_Name, 
     Mid_Name, 
     DOB, 
     Home_Phone, 
     Work_Phone 
 FROM 
     dbo.tblClient
 WHERE 
    Last_Name LIKE '%' + ISNULL(@LastName, Last_Name) AND
    First_Name LIKE '%' + ISNULL(@FirstName, First_Name) AND
    Mid_Name LIKE '%' ISNULL(@MiddleName, Mid_Name) AND
    DOB LIKE '%' + ISNULL(@DOB, DOB) AND
    Home_Phone LIKE '%' + ISNULL(@HomePhone, Home_Phone) AND
    Work_Phone LIKE '%' + ISNULL(@WorkPhone, Work_Phone) 
```

您还可以为每个存储过程参数设置 NULL 默认值。

# git - VB.NET 项目的 Git 忽略文件

> ID：534531
> 
> 赞同：14
> 
> 时间：2009-02-10T22:34:38.803
> 
> 标签：git, vb.net, gitignore, ignore

我想在 Windows 中将一个 VB.NET 项目置于 Git 控制之下（以前在 Visual Source Safe 之下 - 存储库损坏等长期悲伤的故事）。我应该如何设置忽略文件？我正在考虑使用的排除项是：

*   *。可执行程序
*   *.pdb
*   *。显现
*   *.xml
*   *.log（Git 在 Windows 上区分大小写吗？我也应该排除 *.log 吗？）
*   *.scc（我收集这些是 Visual Source Safe 遗留下来的 - 也许我应该删除它们？）

这是一个合理的清单吗？我应该排除目录吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-10T22:41:29.647

这是我的 C# 项目的内容：

```
ProjectName/bin
ProjectName/obj
*.user
*.suo
_ReSharper.*
*.sln.cache 
```

随着 bin/obj 目录的消失，您不需要排除*所有*EXE、XML 文件等 - 这很方便，因为这意味着您仍然可以放入您想要的文件 :) （您可能有示例 XML 文件等。 )

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-05-24T04:06:09.157

我们使用以下内容，我们所有的共享内容（dll、exe、bat 等）都保存在名为“lib”的文件夹中，这样它就保持干净，我们可以将任何我们想要的东西放在 lib 中，并且它被排除在忽略之外规则。

```
[Bb]in/
[Oo]bj/
!/lib
*.user
*.suo
_ReSharper.*
*.sln.cache
*.xap
*.vspcc
*.vscc 
*.vssscc 
```

顺便说一句，是`.gitignore`的，即使在 Windows 中也是区分大小写的，所以是的，您需要包含多个案例。如果您正在使用 Silverlight 或 WPF 应用程序，Visual Studio 有时会创建一个`Bin`文件夹，而不是。`bin`这同样适用于 Obj。一些外部工具也可以做到这一点。据我所知，扩展名在所有情况下都是小写的，除非你当然修改它（如果你想从`git add .`命令中删除单个文件，另一个黑客，顺便说一句）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T02:46:48.760

在这里维护： [https ://github.com/github/gitignore](https://github.com/github/gitignore)

```
# Build and Object Folders
bin/
obj/

#User Specific Files
*.user
*.suo

## Ignore Visual Studio temporary files, build results, and
## files generated by popular Visual Studio add-ons.

# User-specific files
*.suo
*.user
*.sln.docstates

# Build results
[Dd]ebug/
[Rr]elease/
x64/
*_i.c
*_p.c
*.ilk
*.meta
*.obj
*.pch
*.pdb
*.pgc
*.pgd
*.rsp
*.sbr
*.tlb
*.tli
*.tlh
*.tmp
*.vspscc
*.vssscc
.builds

# Visual C++ cache files
ipch/
*.aps
*.ncb
*.opensdf
*.sdf

# Visual Studio profiler
*.psess
*.vsp

# Guidance Automation Toolkit
*.gpState

# ReSharper is a .NET coding add-in
_ReSharper*

# NCrunch
*.ncrunch*
.*crunch*.local.xml

# Installshield output folder 
[Ee]xpress

# DocProject is a documentation generator add-in
DocProject/buildhelp/
DocProject/Help/*.HxT
DocProject/Help/*.HxC
DocProject/Help/*.hhc
DocProject/Help/*.hhk
DocProject/Help/*.hhp
DocProject/Help/Html2
DocProject/Help/html

# Click-Once directory
publish

# Publish Web Output
*.Publish.xml

# Others
[Bb]in
[Oo]bj
sql
TestResults
[Tt]est[Rr]esult*
*.Cache
ClientBin
[Ss]tyle[Cc]op.*
~$*
*.dbmdl
Generated_Code #added for RIA/Silverlight projects

# Backup & report files from converting an old project file to a newer
# Visual Studio version. Backup files are not needed, because we have git ;-)
_UpgradeReport_Files/
Backup*/
UpgradeLog*.XML 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T22:43:12.823

删除现有的 .scc 文件。它们是来源安全的垃圾。

您还需要排除：.licx（许可证文件）、.dll、.suo、.ncb、.vspcc、.vscc 和 .vssscc 文件。最后三个由 Visual Studio 生成以跟踪源代码控制绑定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-28T15:59:34.437

不要忘记包括`[Pp]ublish/`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-27T21:04:17.813

发现这个太全面了...

[https://github.com/github/gitignore/blob/master/VisualStudio.gitignore](https://github.com/github/gitignore/blob/master/VisualStudio.gitignore)

截至 2018 年 3 月 27 日

```
## Ignore Visual Studio temporary files, build results, and
## files generated by popular Visual Studio add-ons.
##
## Get latest from https://github.com/github/gitignore/blob/master/VisualStudio.gitignore

# User-specific files
*.suo
*.user
*.userosscache
*.sln.docstates

# User-specific files (MonoDevelop/Xamarin Studio)
*.userprefs

# Build results
[Dd]ebug/
[Dd]ebugPublic/
[Rr]elease/
[Rr]eleases/
x64/
x86/
bld/
[Bb]in/
[Oo]bj/
[Ll]og/

# Visual Studio 2015/2017 cache/options directory
.vs/
# Uncomment if you have tasks that create the project's static files in wwwroot
#wwwroot/

# Visual Studio 2017 auto generated files
Generated\ Files/

# MSTest test Results
[Tt]est[Rr]esult*/
[Bb]uild[Ll]og.*

# NUNIT
*.VisualState.xml
TestResult.xml

# Build Results of an ATL Project
[Dd]ebugPS/
[Rr]eleasePS/
dlldata.c

# Benchmark Results
BenchmarkDotNet.Artifacts/

# .NET Core
project.lock.json
project.fragment.lock.json
artifacts/
**/Properties/launchSettings.json

# StyleCop
StyleCopReport.xml

# Files built by Visual Studio
*_i.c
*_p.c
*_i.h
*.ilk
*.meta
*.obj
*.pch
*.pdb
*.pgc
*.pgd
*.rsp
*.sbr
*.tlb
*.tli
*.tlh
*.tmp
*.tmp_proj
*.log
*.vspscc
*.vssscc
.builds
*.pidb
*.svclog
*.scc

# Chutzpah Test files
_Chutzpah*

# Visual C++ cache files
ipch/
*.aps
*.ncb
*.opendb
*.opensdf
*.sdf
*.cachefile
*.VC.db
*.VC.VC.opendb

# Visual Studio profiler
*.psess
*.vsp
*.vspx
*.sap

# Visual Studio Trace Files
*.e2e

# TFS 2012 Local Workspace
$tf/

# Guidance Automation Toolkit
*.gpState

# ReSharper is a .NET coding add-in
_ReSharper*/
*.[Rr]e[Ss]harper
*.DotSettings.user

# JustCode is a .NET coding add-in
.JustCode

# TeamCity is a build add-in
_TeamCity*

# DotCover is a Code Coverage Tool
*.dotCover

# AxoCover is a Code Coverage Tool
.axoCover/*
!.axoCover/settings.json

# Visual Studio code coverage results
*.coverage
*.coveragexml

# NCrunch
_NCrunch_*
.*crunch*.local.xml
nCrunchTemp_*

# MightyMoose
*.mm.*
AutoTest.Net/

# Web workbench (sass)
.sass-cache/

# Installshield output folder
[Ee]xpress/

# DocProject is a documentation generator add-in
DocProject/buildhelp/
DocProject/Help/*.HxT
DocProject/Help/*.HxC
DocProject/Help/*.hhc
DocProject/Help/*.hhk
DocProject/Help/*.hhp
DocProject/Help/Html2
DocProject/Help/html

# Click-Once directory
publish/

# Publish Web Output
*.[Pp]ublish.xml
*.azurePubxml
# Note: Comment the next line if you want to checkin your web deploy settings,
# but database connection strings (with potential passwords) will be unencrypted
*.pubxml
*.publishproj

# Microsoft Azure Web App publish settings. Comment the next line if you want to
# checkin your Azure Web App publish settings, but sensitive information contained
# in these scripts will be unencrypted
PublishScripts/

# NuGet Packages
*.nupkg
# The packages folder can be ignored because of Package Restore
**/[Pp]ackages/*
# except build/, which is used as an MSBuild target.
!**/[Pp]ackages/build/
# Uncomment if necessary however generally it will be regenerated when needed
#!**/[Pp]ackages/repositories.config
# NuGet v3's project.json files produces more ignorable files
*.nuget.props
*.nuget.targets

# Microsoft Azure Build Output
csx/
*.build.csdef

# Microsoft Azure Emulator
ecf/
rcf/

# Windows Store app package directories and files
AppPackages/
BundleArtifacts/
Package.StoreAssociation.xml
_pkginfo.txt
*.appx

# Visual Studio cache files
# files ending in .cache can be ignored
*.[Cc]ache
# but keep track of directories ending in .cache
!*.[Cc]ache/

# Others
ClientBin/
~$*
*~
*.dbmdl
*.dbproj.schemaview
*.jfm
*.pfx
*.publishsettings
orleans.codegen.cs

# Including strong name files can present a security risk 
# (https://github.com/github/gitignore/pull/2483#issue-259490424)
#*.snk

# Since there are multiple workflows, uncomment next line to ignore bower_components
# (https://github.com/github/gitignore/pull/1529#issuecomment-104372622)
#bower_components/

# RIA/Silverlight projects
Generated_Code/

# Backup & report files from converting an old project file
# to a newer Visual Studio version. Backup files are not needed,
# because we have git ;-)
_UpgradeReport_Files/
Backup*/
UpgradeLog*.XML
UpgradeLog*.htm
ServiceFabricBackup/

# SQL Server files
*.mdf
*.ldf
*.ndf

# Business Intelligence projects
*.rdl.data
*.bim.layout
*.bim_*.settings
*.rptproj.rsuser

# Microsoft Fakes
FakesAssemblies/

# GhostDoc plugin setting file
*.GhostDoc.xml

# Node.js Tools for Visual Studio
.ntvs_analysis.dat
node_modules/

# Visual Studio 6 build log
*.plg

# Visual Studio 6 workspace options file
*.opt

# Visual Studio 6 auto-generated workspace file (contains which files were open etc.)
*.vbw

# Visual Studio LightSwitch build output
**/*.HTMLClient/GeneratedArtifacts
**/*.DesktopClient/GeneratedArtifacts
**/*.DesktopClient/ModelManifest.xml
**/*.Server/GeneratedArtifacts
**/*.Server/ModelManifest.xml
_Pvt_Extensions

# Paket dependency manager
.paket/paket.exe
paket-files/

# FAKE - F# Make
.fake/

# JetBrains Rider
.idea/
*.sln.iml

# CodeRush
.cr/

# Python Tools for Visual Studio (PTVS)
__pycache__/
*.pyc

# Cake - Uncomment if you are using it
# tools/**
# !tools/packages.config

# Tabs Studio
*.tss

# Telerik's JustMock configuration file
*.jmconfig

# BizTalk build output
*.btp.cs
*.btm.cs
*.odx.cs
*.xsd.cs

# OpenCover UI analysis results
OpenCover/

# Azure Stream Analytics local run output 
ASALocalRun/

# MSBuild Binary and Structured Log
*.binlog

# NVidia Nsight GPU debugger configuration file
*.nvuser 
```

# asp.net - ASP.NET 下拉菜单 - 在 MasterPage EnableViewState = true 时工作

> ID：534535
> 
> 赞同：2
> 
> 时间：2009-02-10T22:35:43.450
> 
> 标签：asp.net, drop-down-menu

我有一个下拉菜单，在回发时，我无法获得选定的值。

*   MasterPage EnableViewState = False
*   内容页面 ViewState = true
*   DropdownList 控件 ViewState = true

不工作

如果我切换 Masterpage EnableViewState = true，它可以工作，但是站点的其余部分确实不需要视图状态，所以理想情况下我希望启用它。

数据绑定发生在 Page_Init 处理程序中，其中有一个 Page.IsPostBack 子句。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T22:37:36.533

每页只有一个视图状态（除了控件状态，它存储在视图状态中）。如果在 Masterpage 上将其关闭，则在页面上将其关闭。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T22:40:26.857

克里斯是 100% 正确的。如果您只想维护这个控件的状态，您可以子类化`DropDown`并添加控件状态。这与任何 ViewState 设置无关。

[这是关于控制状态的 Phil Haack 教程。](http://haacked.com/archive/2007/03/16/gain-control-of-your-control-state.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T22:58:06.517

我认为您应该能够从 Form 集合中获取下拉列表的选定值（无需启用 ViewState），例如：

```
if (IsPostBack)
    string selectedValue = Request.Form["Id_of_the_DropDownList"]; 
```

# c++ - 使用 SFINAE 检测 C++ 中类型的 POD-ness

> ID：534555
> 
> 赞同：4
> 
> 时间：2009-02-10T22:39:26.657
> 
> 标签：c++, visual-studio-2005, sfinae

这里的原标题是 **Workaround for SFINAE bug in VS2005 C++**

这是对 SFINAE 的尝试性使用，以等效于 TR1 中存在的 is_pod 模板类（在 VS2005 中还没有 TR1）。*当模板参数是 POD 类型（包括原始类型和由它们构成的结构）时，它的值*成员应该为true，而在不是时（如非平凡的构造函数），它的值成员应该为 false。

```
template <typename T> class is_pod
{
  public:

    typedef char Yes;
    typedef struct {char a[2];} No;

    template <typename C> static Yes test(int)
    {
      union {T validPodType;} u;
    }
    template <typename C> static No test(...)
    {
    }
    enum {value = (sizeof(test<T>(0)) == sizeof(Yes))};
};

class NonPOD
{
  public:
    NonPod(const NonPod &);
    virtual ~NonPOD();
};

int main()
{
  bool a = is_pod<char>::value;
  bool b = is_pod<NonPOD>::value;
  if (a) 
    printf("char is POD\n");
  if (b)
    printf("NonPOD is POD ?!?!?\n");
  return 0;
} 
```

问题是，不仅 VS 2005 没有 TR1，它也不关心上面的联合（当模板参数不是 POD 时它不应该是有效的），所以 a 和 b 都评估为 true。

* * *

感谢您在下面发布的答案。在仔细阅读它们（和代码）之后，我意识到我试图做的确实是一个错误的方法。这个想法是将 SFINAE 行为与对模板*must_be_pod的适应结合起来（我在**Imperfect C++*一书中找到了它，但它也可以在其他地方找到）。实际上，这需要一套非常特殊的 SFINAE 规则，这显然不是标准定义的。毕竟，这并不是 VS 中的真正错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T00:14:54.303

您的方法的最大问题是您不在这里执行 SFINAE - SFINAE 仅适用于此处的参数类型和返回类型。

但是，在标准中的所有 SFINAE 情况中，没有一个适用于您的情况。他们是

*   无效、引用、函数或无效大小的数组
*   不是类型的类型成员
*   指向引用的指针、对引用的引用、对 void 的引用
*   指向非类类型成员的指针
*   模板值参数的无效转换
*   参数类型为 void 的函数类型
*   const/volatile 函数类型

这可能就是为什么在 Boost 文档中，有：

> 如果没有来自编译器的一些（尚未指定的）帮助，ispod 将永远不会报告类或结构是 POD。这总是安全的，如果可能不是最理想的。目前（2005 年 5 月）只有 MWCW 9 和 Visual C++ 8 具有必要的编译器-_intrinsics。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T00:06:31.953

这也不适用于 VS2008，但我怀疑你也知道这一点。SFINAE 用于推导模板参数的模板参数；即使您可以创建与另一种类型不兼容的类型（即联合不能使用非 POD），您也无法真正推断出揭示类型的构造函数的类型。

事实上，VS 2008 使用编译器对特征的支持来实现`std::tr1::type_traits`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T23:25:40.973

我不确定你在这里尝试做 SFINAE 的方式，因为`is_pod<T>::test(...)`也会匹配`is_pod<T>::test(0)`。也许如果你使用不同的类型而不是 'int' 你会得到更好的匹配：

```
template <typename T> class is_pod
{
  struct my_special_type { };
  public:
    typedef char Yes;
    typedef struct {char a[2];} No;

    template <typename C> static Yes test(my_special_type)
    {
      union {T validPodType;} u;
    }

    template <typename C> static No test(...)
    {
    }
    enum {value = (sizeof(test<T>(my_special_type())) == sizeof(Yes))};
}; 
```

您可能还想查看[Boost.Enable_if](http://www.boost.org/doc/libs/1_38_0/libs/utility/enable_if.html)来为您执行 SFINAE —— 除非您尝试实现自己的库或出于某种原因。

# silverlight - Silverlight - 在列表框上停止高亮显示

> ID：534558
> 
> 赞同：15
> 
> 时间：2009-02-10T22:39:44.500
> 
> 标签：silverlight

我有一个 silverlight 列表框，我想删除当用户在列表框中选择一个项目时发生的颜色更改突出显示。

默认情况下，选择项目时，它会突出显示物品一种浅蓝色。

我怎样才能阻止这种情况发生？

作为一个附带问题，我如何将其自定义为任何任意颜色？

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-10T23:41:03.543

您可以通过自定义列表框项的现有控件模板来做到这一点。执行此操作的简单方法是启动 Expression Blend，右键单击 ListBoxItem，转到 Edit Control Parts (Template) 并选择 Edit a Copy... 然后根据需要自定义 fillColor 和 fillColor2 矩形的填充颜色。

下面的 Xaml 将 ListBoxItem 鼠标悬停颜色设置为透明，并将所选颜色设置为亮绿色，但您可以根据需要对其进行自定义：

```
<UserControl x:Class="SilverlightApplication2.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vsm="clr-namespace:System.Windows;assembly=System.Windows"
    Width="400" Height="300" Background="#FF000000">
  <UserControl.Resources>
    <Style x:Key="ListBoxItemStyleTransparent" TargetType="ListBoxItem">
      <Setter Property="Padding" Value="3"/>
      <Setter Property="HorizontalContentAlignment" Value="Left"/>
      <Setter Property="VerticalContentAlignment" Value="Top"/>
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="1"/>
      <Setter Property="TabNavigation" Value="Local"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="ListBoxItem">
            <Grid Background="{TemplateBinding Background}">
              <vsm:VisualStateManager.VisualStateGroups>
                <vsm:VisualStateGroup x:Name="CommonStates">
                  <vsm:VisualState x:Name="Normal"/>
                  <vsm:VisualState x:Name="MouseOver">
                    <Storyboard>
                      <DoubleAnimationUsingKeyFrames Storyboard.TargetName="fillColor" Storyboard.TargetProperty="Opacity">
                        <SplineDoubleKeyFrame KeyTime="0" Value=".35"/>
                      </DoubleAnimationUsingKeyFrames>
                    </Storyboard>
                  </vsm:VisualState>
                  <vsm:VisualState x:Name="Disabled">
                    <Storyboard>
                      <DoubleAnimationUsingKeyFrames Storyboard.TargetName="contentPresenter" Storyboard.TargetProperty="Opacity">
                        <SplineDoubleKeyFrame KeyTime="0" Value=".55"/>
                      </DoubleAnimationUsingKeyFrames>
                    </Storyboard>
                  </vsm:VisualState>
                </vsm:VisualStateGroup>
                <vsm:VisualStateGroup x:Name="SelectionStates">
                  <vsm:VisualState x:Name="Unselected"/>
                  <vsm:VisualState x:Name="Selected">
                    <Storyboard>
                      <DoubleAnimationUsingKeyFrames Storyboard.TargetName="fillColor2" Storyboard.TargetProperty="Opacity">
                        <SplineDoubleKeyFrame KeyTime="0" Value=".75"/>
                      </DoubleAnimationUsingKeyFrames>
                    </Storyboard>
                  </vsm:VisualState>
                </vsm:VisualStateGroup>
                <vsm:VisualStateGroup x:Name="FocusStates">
                  <vsm:VisualState x:Name="Focused">
                    <Storyboard>
                      <ObjectAnimationUsingKeyFrames Duration="0" Storyboard.TargetName="FocusVisualElement" Storyboard.TargetProperty="Visibility">
                        <DiscreteObjectKeyFrame KeyTime="0">
                          <DiscreteObjectKeyFrame.Value>
                            <Visibility>Visible</Visibility>
                          </DiscreteObjectKeyFrame.Value>
                        </DiscreteObjectKeyFrame>
                      </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                  </vsm:VisualState>
                  <vsm:VisualState x:Name="Unfocused"/>
                </vsm:VisualStateGroup>
              </vsm:VisualStateManager.VisualStateGroups>
              <Rectangle x:Name="fillColor" IsHitTestVisible="False" Opacity="0" RadiusX="1" RadiusY="1" Fill="Transparent"/>
              <Rectangle x:Name="fillColor2" IsHitTestVisible="False" Opacity="0" Fill="#FF00FF00" RadiusX="1" RadiusY="1"/>
              <ContentPresenter HorizontalAlignment="Left" Margin="{TemplateBinding Padding}" x:Name="contentPresenter" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
              <Rectangle x:Name="FocusVisualElement" Visibility="Collapsed" Stroke="#FF6DBDD1" StrokeThickness="1" RadiusX="1" RadiusY="1"/>
            </Grid>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>
  </UserControl.Resources>
  <Grid x:Name="LayoutRoot" Background="White">
    <ListBox x:Name="ListBoxTest">
      <ListBoxItem Content="Some String" Style="{StaticResource ListBoxItemStyleTransparent}" />
    </ListBox>
  </Grid>
</UserControl> 
```

fillColor Rectangle 指定当用户将鼠标悬停在 ListBoxItem 上时要使用的颜色。在上面的代码中，我将其设置为透明，因此当您将鼠标悬停在 ListBoxItem 上时不会出现颜色。

fillColor2 指定选择 ListBoxItem 时使用的颜色。In the code above I've specified #FF00FF00 so the color will be bright green when a ListBoxItem is selected.

在您的情况下，您可以将 fillColor2 Rectangle 的 Fill 属性设置为透明，以在用户选择项目时模拟无颜色。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-01-11T10:47:28.033

如果您不想选择，您可以考虑使用 ItemsControl 而不是 ListBox。
（ItemsControl 是同一控件的更简单版本）。

来自 [http://forums.silverlight.net/post/140375.aspx](http://forums.silverlight.net/post/140375.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-01-04T12:23:03.257

```
<ListBox.ItemContainerStyle>
    <Style TargetType="ListBoxItem">
        <Setter Property="Focusable" Value="false"></Setter>
    </Style>
</ListBox.ItemContainerStyle> 
```

# c# - 使用 Nhibernate Criteria Api 查询集合？

> ID：534572
> 
> 赞同：4
> 
> 时间：2009-02-10T22:41:38.850
> 
> 标签：c#, .net, nhibernate, criteria, icriteria

我有一个“Estate”实体，该实体有一个集合“EstateFeatures”（类型：EstateFeature），EstateFeature 有一个属性“MyFeatureValue”。

*注意：这些是问题的有限属性。所有实体都有一个 ID 和所有必需的等*

**财产**

```
IList<EstateFeature> EstateFeatures; 
```

**房地产特征**

```
FeatureValue MyFeatureValue; 
```

**特征值**

```
public virtual long Id; 
```

我正在尝试获取具有给定 FeatureValue.Id 的房地产

```
DetachedCriteria query = DetachedCriteria.For<Estate>();
Conjunction and = new Conjuction();
foreach (var id in idCollection)
   and.Add(Expression.Eq("MyFeatureValue.Id",id);

query
     .CreateCriteria("EstateFeatures")
     .Add(and);
IList<Estate> estates = query.GetExecutableCriteria(session).List<Estate>(); 
```

此查询没有返回任何内容，我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T20:30:35.160

如果我理解正确，我认为这样的事情可能会奏效

```
CreateCriteria(typeof(Estate))
     .CreateAlias("EstateFeatures", "estatefeature")
     .Add(Restrictions.In("estatefeature.MyFeatureValue.Id", ids))
     .List<Estate>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T23:02:30.360

NHibernate 为您生成了什么查询？您可以使用 show_sql 配置属性进行检查。

当我看到您的查询时，您正在尝试获取具有给定功能集的所有庄园。我认为，这将生成一个看起来像的查询

```
SELECT ....
FROM Estates
INNER JOIN Features
WHERE Feature.Id = 1 AND Feature.Id = 2 ... 
```

如果你想检索包含所有指定特征的所有庄园，我认为你必须使用析取，以便 NHibernate 检索至少具有这些特征之一的所有庄园。然后，在您的客户代码中，您将检查您的“客户代码”中的每个庄园，以便最终得到具有所有功能的庄园。
我不知道是否有一种有效的方法让 NHibernate 处理这个......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T23:30:55.033

您需要确保为您希望您的遗产拥有的每项功能加入一次 MyFeatureValue。

一种方法是为每次迭代调用 .CreateAlias，给它一个唯一的别名，然后添加表达式“aliasX.Id”

```
foreach（idCollection 中的变量 id）
{
   query = query.CreateAlias("MyFeatureValue", "feature" + id)
                .Add(Expression.Eq("feature" + id + ".Id",id);

}

```

真的不记得语法是怎么回事，这是我脑子里写的，不确定是否需要重新声明查询:)

但是，我认为这会让你开始。

编辑：由于 Criteria API 中的错误限制您使用 CreateAlias 或 CreateCriteria 多次关联集合，因此您需要求助于 HQL。

[http://derek-says.blogspot.com/2008/06/duplicate-association-path-bug-in.html](http://derek-says.blogspot.com/2008/06/duplicate-association-path-bug-in.html)

（Hibernate 也有同样的问题）

```
选择 e   
来自房地产公司
INNER JOIN e.MyFeatureValue AS fv1
INNER JOIN e.MyFeatureValue AS fv2
其中 fv1.Id = 3
   和 fv2.Id = 13

```

您将需要动态构建 HQL，以便您的别名变得独一无二（fv1、fv2、fvX ...）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T22:57:06.067

该代码看起来像您正在传递一个 FeaturesValueIds 列表，并且想要一个具有所有这些功能的列表。如果是这种情况，我会查看正在生成的 SQL，并针对数据库运行它，看看是否应该取回任何东西。

否则，如果您正在寻找包含您要传入的任何特征的列表，您应该使用析取而不是合取。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T23:22:25.147

```
 exec sp_executesql N'SELECT TOP 3 id11_1_, Address11_1_, Title11_1_, Descript4_11_1_, 
    Price11_1_, Discount11_1_, ForBankL7_11_1_, AddDate11_1_, LastUpdate11_1_, 
IsVisible11_1_, ViewCount11_1_, SaleOrRent11_1_, LocationId11_1_, StaffId11_1_, 
CategoryId11_1_, id27_0_, EstateId27_0_, FeatureV3_27_0_ FROM (SELECT ROW_NUMBER() 
OVER(ORDER BY __hibernate_sort_expr_0__) as row, query.id11_1_, query.Address11_1_, 
query.Title11_1_, query.Descript4_11_1_, query.Price11_1_, query.Discount11_1_, 
query.ForBankL7_11_1_, query.AddDate11_1_, query.LastUpdate11_1_, query.IsVisible11_1_, 
query.ViewCount11_1_, query.SaleOrRent11_1_, query.LocationId11_1_, query.StaffId11_1_, 
query.CategoryId11_1_, query.id27_0_, query.EstateId27_0_, query.FeatureV3_27_0_, 
query.__hibernate_sort_expr_0__ FROM (SELECT this_.id as id11_1_, this_.Address as 
Address11_1_, this_.Title as Title11_1_, this_.Description as Descript4_11_1_, this_.Price 
as Price11_1_, this_.Discount as Discount11_1_, this_.ForBankLoan as ForBankL7_11_1_, 
this_.AddDate as AddDate11_1_, this_.LastUpdate as LastUpdate11_1_, this_.IsVisible as 
IsVisible11_1_, this_.ViewCount as ViewCount11_1_, this_.SaleOrRent as SaleOrRent11_1_, 
this_.LocationId as LocationId11_1_, this_.StaffId as StaffId11_1_, this_.CategoryId as 
CategoryId11_1_, estatefeat1_.id as id27_0_, estatefeat1_.EstateId as EstateId27_0_, 
estatefeat1_.FeatureValueId as FeatureV3_27_0_, CURRENT_TIMESTAMP as 
__hibernate_sort_expr_0__ FROM Estate this_ inner join EstateFeature estatefeat1_ on 
this_.id=estatefeat1_.EstateId WHERE this_.CategoryId = @p0 and 
(estatefeat1_.FeatureValueId = @p1 and estatefeat1_.FeatureValueId = @p2 and 
estatefeat1_.FeatureValueId = @p3 and estatefeat1_.FeatureValueId = @p4 and 
estatefeat1_.FeatureValueId = @p5 and estatefeat1_.FeatureValueId = @p6 and 
estatefeat1_.FeatureValueId = @p7)) query ) page WHERE page.row > 0 ORDER BY 
__hibernate_sort_expr_0__',N'@p0 bigint,@p1 bigint,@p2 bigint,@p3 bigint,@p4 bigint,@p5 
bigint,@p6 bigint,@p7 bigint',@p0=3,@p1=7,@p2=8,@p3=9,@p4=10,@p5=11,@p6=12,@p7=16 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T14:02:34.143

看起来您想要`or`( `Disjunction`) 而不是`and`( `Conjunction`)。现在，您正在搜索`EstateFeature`s 对象，使得每个对象都有多个不同`Id`的 s，这似乎不是您想要的。

```
var or = new Disjunction();
foreach(var id in idCollection)
    or.Add(Expression.Eq("MyFeatureValue.Id", id);

var query = DetachedCriteria.For<Estate>();
query
    .CreateCriteria("EstateFeatures")
    .Add(and);
var estates = query.GetExecutableCriteria(session).List<Estate>(); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-11T00:44:38.447

我也试过这个，但结果是一样的：

```
DetachedCriteria features = DetachedCriteria.For<FeatureValue>();
features.SetProjection(Projections.Property("Id"));
features.Add(Property.ForName("Id").EqProperty("value.Id"));

var and = new Conjunction();

foreach (var l in FeatureIdCollection)
    and.Add(Expression.Eq("Id", l));

features.Add(and);

query.CreateCriteria("EstateFeatures")
     .CreateCriteria("MyFeatureValue","value")
     .Add(Subqueries.Exists(features)); 
```

# c++ - C ++中的全局变量VS文件变量

> ID：534574
> 
> 赞同：9
> 
> 时间：2009-02-10T22:41:47.647
> 
> 标签：c++, global-variables

C ++中的全局变量和文件变量有什么区别？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-10T22:50:43.837

在 C 和 C++ 中，您可以使用声明前面的 static 关键字使全局变量只能从声明它的文件中访问。不使用 static 关键字的全局变量可以从编译到程序中的任何 C 或 C++ 文件中访问。

静态全局方法在 C++ 中被弃用，取而代之的是匿名命名空间。放置在匿名命名空间内的任何声明也只能从该文件中访问。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-10T23:11:24.427

C++ 程序一次编译一个翻译单元（基本上这意味着每个 .cpp 文件都是独立编译的）。

默认情况下，非变量、非`const`函数`inline`和`typedef`s 具有*内部链接*：这意味着它们对其他翻译单元不可见。如果其他翻译单元引用了具有内部链接的符号（在*声明*它之后，这需要变量的关键字`extern`），链接器将无法找到它们。

要明确要求内部链接，请使用关键字`static`，或者更好的是使用未命名的命名空间。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-10T23:14:25.637

*注意：*这些规则适用于 C++ 和 C 一样，涉及类/结构/命名空间范围。（我没有注意到问题是关于 C++，而不是 C。）

请记住（在大多数情况下）C 源文件被编译成目标文件。目标文件有一个“导出”表，它告诉链接器（链接时）它提供了哪些符号。符号是指代函数或变量（在大多数情况下）的名称（其确切名称取决于 ABI）。

在 C 源文件中声明全局变量时，如下所示：

```
// fileA.c
int hello = 42;

void printMessage() {
    printf("Hello, %d world(s)!\n", hello);
} 
```

`hello`并被`printMessage`出口。当 C 目标文件请求一个名为 ' `hello`' 的符号（假设是一个简单的 ABI）时，链接器将其与`hello`导出的`fileA.c`.

现在换一种情况。当您像这样声明文件局部变量时：

```
// fileB.c
static int world = 9001;

static void messagePrint() {
    printf("It's over %d!\n", world);
} 
```

`world`并且`messagePrint`不*出口*。当 C 目标文件请求一个名为 ' `hello`' 的符号时，链接器无法将其与`hello`of连接起来，因为其中（或其他）`fileB.c`没有关于它的信息。`fileB.obj`

怎么可能`messagePrint`知道`world`呢？两者都在同一个翻译单元中。范围在这里接管。我相信您会[通过 Google 找到很多有关范围](http://www.google.com/search?q=c+programming+scope)的信息。

（符号名称是否与 C 中的函数/变量名称标准匹配？我知道它与 C++ 不同（其中没有名称修饰的标准化），这就是我首先提到 ABI 的原因。）

（（（如果 ABI 是正确的术语，甚至？；P））

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T22:47:50.583

唯一的区别是文件变量只能在文件内部访问。但它们的寿命相同。

# .net - 如何反转 BooleanToVisibilityConverter？

> ID：534575
> 
> 赞同：159
> 
> 时间：2009-02-10T22:41:50.033
> 
> 标签：.net, wpf, binding, visibility

我`BooleanToVisibilityConverter`在 WPF 中使用 a 将`Visibility`控件的属性绑定到`Boolean`. 这很好用，但如果布尔值是 ，我希望其中一个控件隐藏，如果是`true`，则显示`false`。

* * *

## 回答 #1

> 赞同：271
> 
> 时间：2011-03-03T15:18:48.590

您可以通过使用通用`IValueConverter`实现来实现相同的目标，而不是反转，该实现可以将布尔值转换为可*配置*的真假目标值。下面是一种这样的实现：

```
public class BooleanConverter<T> : IValueConverter
{
    public BooleanConverter(T trueValue, T falseValue)
    {
        True = trueValue;
        False = falseValue;
    }

    public T True { get; set; }
    public T False { get; set; }

    public virtual object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return value is bool && ((bool) value) ? True : False;
    }

    public virtual object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return value is T && EqualityComparer<T>.Default.Equals((T) value, True);
    }
} 
```

接下来，将其子类化 where `T`is `Visibility`：

```
public sealed class BooleanToVisibilityConverter : BooleanConverter<Visibility>
{
    public BooleanToVisibilityConverter() : 
        base(Visibility.Visible, Visibility.Collapsed) {}
} 
```

最后，这就是您可以`BooleanToVisibilityConverter`在 XAML 中使用上述方法并将其配置为例如使用`Collapsed`for true 和`Visible`for false 的方式：

```
<Application.Resources>
    <app:BooleanToVisibilityConverter 
        x:Key="BooleanToVisibilityConverter" 
        True="Collapsed" 
        False="Visible" />
</Application.Resources> 
```

`IsHidden`当您要绑定到名为as的布尔属性时，此反转很有用`IsVisible`。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2010-03-11T17:46:00.143

自己写是目前最好的解决方案。这是一个转换器的示例，它可以正常和反转两种方式。如果您对此有任何问题，请询问。

```
[ValueConversion(typeof(bool), typeof(Visibility))]
public class InvertableBooleanToVisibilityConverter : IValueConverter
{
    enum Parameters
    {
        Normal, Inverted
    }

    public object Convert(object value, Type targetType,
                          object parameter, CultureInfo culture)
    {
        var boolValue = (bool)value;
        var direction = (Parameters)Enum.Parse(typeof(Parameters), (string)parameter);

        if(direction == Parameters.Inverted)
            return !boolValue? Visibility.Visible : Visibility.Collapsed;

        return boolValue? Visibility.Visible : Visibility.Collapsed;
    }

    public object ConvertBack(object value, Type targetType,
        object parameter, CultureInfo culture)
    {
        return null;
    }
} 
```

```
<UserControl.Resources>
  <Converters:InvertableBooleanToVisibilityConverter x:Key="_Converter"/>
</UserControl.Resources>

<Button Visibility="{Binding IsRunning, Converter={StaticResource _Converter}, ConverterParameter=Inverted}">Start</Button> 
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2009-05-27T12:35:05.660

```
using System;
using System.Globalization;
using System.Windows;
using System.Windows.Data;

public sealed class BooleanToVisibilityConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var flag = false;
        if (value is bool)
        {
            flag = (bool)value;
        }
        else if (value is bool?)
        {
            var nullable = (bool?)value;
            flag = nullable.GetValueOrDefault();
        }
        if (parameter != null)
        {
            if (bool.Parse((string)parameter))
            {
                flag = !flag;
            }
        }
        if (flag)
        {
            return Visibility.Visible;
        }
        else
        {
            return Visibility.Collapsed;
        }
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        var back = ((value is Visibility) && (((Visibility)value) == Visibility.Visible));
        if (parameter != null)
        {
            if ((bool)parameter)
            {
                back = !back;
            }
        }
        return back;
    }
} 
```

然后将 true 或 false 作为 ConverterParameter 传递

```
 <Grid.Visibility>
                <Binding Path="IsYesNoButtonSetVisible" Converter="{StaticResource booleanToVisibilityConverter}" ConverterParameter="true"/>
        </Grid.Visibility> 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-02-10T22:45:06.657

实现您自己的 IValueConverter 实现。示例实现位于

[http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)

在您的 Convert 方法中，让它返回您想要的值而不是默认值。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2009-02-10T23:10:17.207

Codeplex 上还有[WPF 转换器](http://www.codeplex.com/wpfconverters)项目。在他们的文档中，他们说您可以使用他们的[MapConverter](http://www.codeplex.com/wpfconverters/Wiki/View.aspx?title=User%20Documentation&referringTitle=Home#MapConverter)将 Visibility 枚举转换为 bool

```
<Label>
    <Label.Visible>
        <Binding Path="IsVisible">
            <Binding.Converter>
                <con:MapConverter>
                    <con:Mapping From="True" To="{x:Static Visibility.Visible}"/>
                    <con:Mapping From="False" To="{x:Static Visibility.Hidden}"/>
                </con:MapConverter>
            </Binding.Converter>
        </Binding>
    </Label.Visible>
</Label> 
```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2014-10-20T12:37:08.857

将 ViewModel 布尔值 (IsButtonVisible) 与 xaml 控件可见性属性绑定的另一种方法。没有编码，没有转换，只是样式。

```
<Style TargetType={x:Type Button} x:Key="HideShow">
   <Style.Triggers>
      <DataTrigger Binding="{Binding IsButtonVisible}" Value="False">
          <Setter Property="Visibility" Value="Hidden"/>
      </DataTrigger>
   </Style.Triggers>
</Style>

<Button Style="{StaticResource HideShow}">Hello</Button> 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2012-12-24T05:53:57.557

或者真正的懒人方式，只需利用已有的东西并翻转它：

```
public class InverseBooleanToVisibilityConverter : IValueConverter
{
    private BooleanToVisibilityConverter _converter = new BooleanToVisibilityConverter();

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        var result = _converter.Convert(value, targetType, parameter, culture) as Visibility?;
        return result == Visibility.Collapsed ? Visibility.Visible : Visibility.Collapsed;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        var result = _converter.ConvertBack(value, targetType, parameter, culture) as bool?;
        return result == true ? false : true;
    }
} 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2016-11-02T20:38:16.457

如果您不喜欢编写自定义转换器，可以使用数据触发器来解决此问题：

```
<Style.Triggers>
        <DataTrigger Binding="{Binding YourBinaryOption}" Value="True">
                 <Setter Property="Visibility" Value="Visible" />
        </DataTrigger>
        <DataTrigger Binding="{Binding YourBinaryOption}" Value="False">
                 <Setter Property="Visibility" Value="Collapsed" />
        </DataTrigger>
</Style.Triggers> 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-02-22T22:56:14.170

我刚刚在这方面做了一个帖子。我使用了与 Michael Hohlios 类似的想法。只是，我使用了属性而不是使用“对象参数”。

[在我看来，使用属性将可见性绑定到 WPF 中的布尔值](http://www.rhyous.com/2011/02/22/binding-visibility-to-a-bool-value-in-wpf/)

使其更具可读性。

```
<local:BoolToVisibleOrHidden x:Key="BoolToVisConverter" Collapse="True" Reverse="True" /> 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-06-26T22:53:04.597

这是我写过并经常使用的一个。它使用一个布尔转换器参数来指示是否反转该值，然后使用 XOR 执行否定：

```
[ValueConversion(typeof(bool), typeof(System.Windows.Visibility))]
public class BooleanVisibilityConverter : IValueConverter
{
    System.Windows.Visibility _visibilityWhenFalse = System.Windows.Visibility.Collapsed;

    /// <summary>
    /// Gets or sets the <see cref="System.Windows.Visibility"/> value to use when the value is false. Defaults to collapsed.
    /// </summary>
    public System.Windows.Visibility VisibilityWhenFalse
    {
        get { return _visibilityWhenFalse; }
        set { _visibilityWhenFalse = value; }
    }

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        bool negateValue;
        Boolean.TryParse(parameter as string, out negateValue);

        bool val = negateValue ^ System.Convert.ToBoolean(value); //Negate the value when negateValue is true using XOR
        return val ? System.Windows.Visibility.Visible : _visibilityWhenFalse;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        bool negateValue;
        Boolean.TryParse(parameter as string, out negateValue);

        if ((System.Windows.Visibility)value == System.Windows.Visibility.Visible)
            return true ^ negateValue;
        else
            return false ^ negateValue;
    }
} 
```

这是一个 XOR 真值表供参考：

```
 XOR
        x  y  XOR
        ---------
        0  0  0
        0  1  1
        1  0  1
        1  1  0 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-03-10T23:12:28.443

我正在寻找更一般的答案，但找不到。我写了一个可以帮助别人的转换器。

它基于我们需要区分六种不同情况的事实：

*   真 2 可见，假 2 隐藏
*   真 2 可见，假 2 折叠
*   真 2 隐藏，假 2 可见
*   真 2 已折叠，假 2 可见
*   真 2 隐藏，假 2 折叠
*   真 2 折叠，假 2 隐藏

这是我对前 4 个案例的实现：

```
[ValueConversion(typeof(bool), typeof(Visibility))]
public class BooleanToVisibilityConverter : IValueConverter
{
    enum Types
    {
        /// <summary>
        /// True to Visible, False to Collapsed
        /// </summary>
        t2v_f2c,
        /// <summary>
        /// True to Visible, False to Hidden
        /// </summary>
        t2v_f2h,
        /// <summary>
        /// True to Collapsed, False to Visible
        /// </summary>
        t2c_f2v,
        /// <summary>
        /// True to Hidden, False to Visible
        /// </summary>
        t2h_f2v,
    }
    public object Convert(object value, Type targetType,
                          object parameter, CultureInfo culture)
    {
        var b = (bool)value;
        string p = (string)parameter;
        var type = (Types)Enum.Parse(typeof(Types), (string)parameter);
        switch (type)
        {
            case Types.t2v_f2c:
                return b ? Visibility.Visible : Visibility.Collapsed; 
            case Types.t2v_f2h:
                return b ? Visibility.Visible : Visibility.Hidden; 
            case Types.t2c_f2v:
                return b ? Visibility.Collapsed : Visibility.Visible; 
            case Types.t2h_f2v:
                return b ? Visibility.Hidden : Visibility.Visible; 
        }
        throw new NotImplementedException();
    }

    public object ConvertBack(object value, Type targetType,
        object parameter, CultureInfo culture)
    {
        var v = (Visibility)value;
        string p = (string)parameter;
        var type = (Types)Enum.Parse(typeof(Types), (string)parameter);
        switch (type)
        {
            case Types.t2v_f2c:
                if (v == Visibility.Visible)
                    return true;
                else if (v == Visibility.Collapsed)
                    return false;
                break;
            case Types.t2v_f2h:
                if (v == Visibility.Visible)
                    return true;
                else if (v == Visibility.Hidden)
                    return false;
                break;
            case Types.t2c_f2v:
                if (v == Visibility.Visible)
                    return false;
                else if (v == Visibility.Collapsed)
                    return true;
                break;
            case Types.t2h_f2v:
                if (v == Visibility.Visible)
                    return false;
                else if (v == Visibility.Hidden)
                    return true;
                break;
        }
        throw new InvalidOperationException();
    }
} 
```

例子：

```
Visibility="{Binding HasItems, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter='t2v_f2c'}" 
```

我认为参数很容易记住。

希望它可以帮助某人。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-03-16T11:24:43.763

您可以使用**QuickConverter**。

使用 QuickConverter，您可以使用 BindingExpression 内联编写转换器逻辑

这是一个反转的 BooleanToVisibility 转换器：

```
Visibility="{qc:Binding '!$P ? Visibility.Visible : Visibility.Collapsed', P={Binding Example}}" 
```

您可以通过 NuGet 添加 QuickConverter。查看设置文档。链接：[https ://quickconverter.codeplex.com/](https://quickconverter.codeplex.com/)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2020-05-01T20:18:36.813

与其编写自己的代码/重新发明，不如考虑使用[CalcBinding](https://github.com/Alex141/CalcBinding)：

```
 // Automatic two way convertion of bool expression to Visibility and 
    // back if target property has such type: description

    <Button Visibility="{c:Binding !IsChecked}" /> 
    <Button Visibility="{c:Binding IsChecked, FalseToVisibility=Hidden}" /> 
```

CalcBinding 对于许多其他场景也非常有用。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-10T22:45:44.423

写你自己的转换。

```
public class ReverseBooleanToVisibilityConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
   {
       // your converter code here
   }
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-09-04T19:32:16.590

一个简单的单向版本，可以像这样使用：

```
Visibility="{Binding IsHidden, Converter={x:Static Ui:Converters.BooleanToVisibility}, ConverterParameter=true} 
```

可以这样实现：

```
public class BooleanToVisibilityConverter : IValueConverter
{
  public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
  {
    var invert = false;

    if (parameter != null)
    {
      invert = Boolean.Parse(parameter.ToString());
    }

    var booleanValue = (bool) value;

    return ((booleanValue && !invert) || (!booleanValue && invert)) 
      ? Visibility.Visible : Visibility.Collapsed;
  }

  public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
  {
    throw new NotImplementedException();
  }
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-04-17T07:30:36.287

将所有内容转换为所有内容（布尔、字符串、枚举等）：

```
public class EverythingConverterValue
{
    public object ConditionValue { get; set; }
    public object ResultValue { get; set; }
}

public class EverythingConverterList : List<EverythingConverterValue>
{

}

public class EverythingConverter : IValueConverter
{
    public EverythingConverterList Conditions { get; set; } = new EverythingConverterList();

    public object NullResultValue { get; set; }
    public object NullBackValue { get; set; }

    public object Convert(object value, Type targetType,
        object parameter, CultureInfo culture)
    {
        return Conditions.Where(x => x.ConditionValue.Equals(value)).Select(x => x.ResultValue).FirstOrDefault() ?? NullResultValue;
    }
    public object ConvertBack(object value, Type targetType,
        object parameter, CultureInfo culture)
    {
        return Conditions.Where(x => x.ResultValue.Equals(value)).Select(x => x.ConditionValue).FirstOrDefault() ?? NullBackValue;
    }
} 
```

XAML 示例：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:conv="clr-namespace:MvvmGo.Converters;assembly=MvvmGo.WindowsWPF"
                xmlns:sys="clr-namespace:System;assembly=mscorlib">

<conv:EverythingConverter x:Key="BooleanToVisibilityConverter">
    <conv:EverythingConverter.Conditions>
        <conv:EverythingConverterValue ResultValue="{x:Static Visibility.Visible}">
            <conv:EverythingConverterValue.ConditionValue>
                <sys:Boolean>True</sys:Boolean>
            </conv:EverythingConverterValue.ConditionValue>
        </conv:EverythingConverterValue>
        <conv:EverythingConverterValue ResultValue="{x:Static Visibility.Collapsed}">
            <conv:EverythingConverterValue.ConditionValue>
                <sys:Boolean>False</sys:Boolean>
            </conv:EverythingConverterValue.ConditionValue>
        </conv:EverythingConverterValue>
    </conv:EverythingConverter.Conditions>

</conv:EverythingConverter>

<conv:EverythingConverter x:Key="InvertBooleanToVisibilityConverter">
    <conv:EverythingConverter.Conditions>
        <conv:EverythingConverterValue ResultValue="{x:Static Visibility.Visible}">
            <conv:EverythingConverterValue.ConditionValue>
                <sys:Boolean>False</sys:Boolean>
            </conv:EverythingConverterValue.ConditionValue>
        </conv:EverythingConverterValue>
        <conv:EverythingConverterValue ResultValue="{x:Static Visibility.Collapsed}">
            <conv:EverythingConverterValue.ConditionValue>
                <sys:Boolean>True</sys:Boolean>
            </conv:EverythingConverterValue.ConditionValue>
        </conv:EverythingConverterValue>
    </conv:EverythingConverter.Conditions>
</conv:EverythingConverter>

<conv:EverythingConverter x:Key="MarriedConverter" NullResultValue="Single">
    <conv:EverythingConverter.Conditions>
        <conv:EverythingConverterValue ResultValue="Married">
            <conv:EverythingConverterValue.ConditionValue>
                <sys:Boolean>True</sys:Boolean>
            </conv:EverythingConverterValue.ConditionValue>
        </conv:EverythingConverterValue>
        <conv:EverythingConverterValue ResultValue="Single">
            <conv:EverythingConverterValue.ConditionValue>
                <sys:Boolean>False</sys:Boolean>
            </conv:EverythingConverterValue.ConditionValue>
        </conv:EverythingConverterValue>
    </conv:EverythingConverter.Conditions>
    <conv:EverythingConverter.NullBackValue>
        <sys:Boolean>False</sys:Boolean>
    </conv:EverythingConverter.NullBackValue>
</conv:EverythingConverter> 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2012-08-03T17:40:06.440

我知道这已经过时了，但是，你不需要重新实现任何东西。

我所做的是否定属性的值，如下所示：

```
<!-- XAML code -->
<StackPanel Name="x"  Visibility="{Binding    Path=Specials, ElementName=MyWindow, Converter={StaticResource BooleanToVisibilityConverter}}"></StackPanel>    
<StackPanel Name="y"  Visibility="{Binding Path=NotSpecials, ElementName=MyWindow, Converter={StaticResource BooleanToVisibilityConverter}}"></StackPanel> 
```

……

```
//Code behind
public bool Specials
{
    get { return (bool) GetValue(SpecialsProperty); }
    set
    {
        NotSpecials= !value; 
        SetValue(SpecialsProperty, value);
    }
}

public bool NotSpecials
{
    get { return (bool) GetValue(NotSpecialsProperty); }
    set { SetValue(NotSpecialsProperty, value); }
} 
```

它工作得很好！

我错过了什么吗？

# .net - 在 SQL Server CLR 中托管 .NET 方法

> ID：534577
> 
> 赞同：0
> 
> 时间：2009-02-10T22:42:24.760
> 
> 标签：.net, sql, clr-hosting

我被要求在 SQL Server 2005 中创建一个函数，它是我在 .NET 3.5 中创建的 CLR 托管函数。SQL 中托管的 CLR 函数是否可以访问 App.Config 文件，或者是否所有配置选项都需要作为参数传递？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T23:11:07.140

SQL Server CLR 函数在服务器上运行。App.Config 在客户端。

因此，如果 SQL Server CLR 函数可以访问客户端上的 App.Config，这对我来说不是很合乎逻辑......

# sql-server - 有没有办法让 SSRS 2008 图表显示前 X 个结果并将其余的分组/总和？

> ID：534579
> 
> 赞同：0
> 
> 时间：2009-02-10T22:42:43.527
> 
> 标签：sql-server, sql-server-2008, reporting-services, ssrs-2008

我想在 SQL Server Reporting Services 2008 中有一个图表显示前 X 值，并将其余的总和/分组为其他值。如果不在 T-SQL 中进行分组，这可能吗？

**例子：**

查询返回美国 50 个州的总销售额。我想显示销售额最高的五个州，并将其余的州与其销售额的总和归为“所有其他州”。

用户将能够按任意数量的状态进行过滤，我需要图表来显示所选状态的前 5 个。

我想缓存所有状态的报告执行，并从快照中呈现报告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T04:02:31.840

最简单的方法是使用 SQL 本身。鉴于您想从缓存的数据中运行报告，这不是一个选项。

下一个明显的方法是在自定义代码中进行。您可能会执行以下操作：

右键单击布局空间选择属性，然后单击代码选项卡。放入以下代码：

```
Public Dim RowCount As Integer = 0
Public Dim Top5Sum As Double = 0

Public Function HideThisRow(Value As Double) As Boolean
  RowCount = RowCount + 1
  if RowCount > 5 Then
    Return True
  Else
    Top5Sum = Top5Sum + Value
    Return False
  End If
End Function 
```

在详细信息带上，创建两个详细信息行 - 第一个是您的普通行，您可以将字段与该详细信息行的 Visibility-Hidden 属性相加，该属性具有以下表达式：

```
=Code.HideThisRow(Fields!YourFieldToSum.Value) 
```

这将执行上面的代码，因为它准备显示每个详细信息行并隐藏除前 5 行之外的所有行。它还具有对前 5 个值求和的副作用。

您的详细信息带中的第二行是我们将显示“所有其他州”部分的位置，因此在您拥有州名称的列中给它描述“所有其他州”，并且在您显示字段的列中具有表达式：

```
=Sum(Fields!YourFieldToSum.Value) - Code.Top5Sum 
```

我们还必须隐藏除显示的最后一行（第 5 行）之外的所有行，因此我们将其 Visibility-Hidden 属性设置为以下表达式：

```
=IIF(RowNumber(Nothing) = 5, False, True) 
```

这有效地隐藏了除要显示的最后一行（第 5 行）之外的所有行的该行。

您可能认为您可以只在报告的页脚中执行此操作，而不是隐藏所有这些行，但有一个陷阱 - 您无法预测构建报告的顺序以及代码的顺序将执行。真的。

如果您只是在页脚而不是隐藏的详细信息行中进行了计算，那么 Top5Sum 变量的值将被适当地计算。但是，Visibility-Hidden 功能不起作用（至少在我的 SSRS 版本上——它在我的测试中生成了 17 个空白页，然后才生成了准确的页脚）。但是，假设您要计算每个州的百分比，因此您将以下表达式添加到您的详细信息带中：

```
=Fields!YourFieldToSum.Value / SUM(Fields!YourFieldToSum.Value) 
```

这是完全合理的做法，但这完全改变了计算报告的顺序 - 在这种情况下，详细信息带需要知道字段的总和，因此在详细信息带之前计算页脚带，这意味着在计算页脚带时 Top5Sum 变量为零，并且您的计算不起作用。但是，详细信息行现在已适当隐藏。

这就是为什么您需要在 Detail 带中进行计算并隐藏所有其他结果而不是在 Footer 带中进行计算，这似乎是合乎逻辑的。

# c# - 如何在 javascript 中获取 POST 请求的大小？

> ID：534583
> 
> 赞同：0
> 
> 时间：2009-02-10T22:43:23.213
> 
> 标签：c#, .net, javascript, file-upload

有没有办法在 javascript 中获取 POST 请求的大小？我想在通过 ac# 处理程序上传文件之前检查文件的大小，这样我就可以告诉用户上传一个较小的文件。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T22:49:22.513

JavaScript 无法访问用户计算机上文件的详细信息。如果可能的话，将会产生重大的安全隐患。

您需要在该阶段上传文件并检查其大小。无论如何，这是最佳实践，因为您不应该对您的用户环境做出任何假设。在这种情况下，他们的浏览器中可能没有 JavaScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T22:52:24.097

简短的回答：没有。

长答案：可能，但脚本需要由用户通过签名的 ActiveX 对象或 HTA 之类的东西授予对本地文件系统的访问权限。我不知道这方面的确切细节，因为我从来没有做过（沿着那条路，有龙！）

# .net - LINQ 生成的类是 POCO 吗？

> ID：534584
> 
> 赞同：1
> 
> 时间：2009-02-10T22:43:25.647
> 
> 标签：.net, linq, poco

LINQ (DBML) 生成的类是否被视为 POCO？如果我向这些类添加静态查询，它们仍然是 POCO 吗？

我想一旦我开始在 LINQ 部分中做生意，它就会改变。例如添加其他属性，创建集合，基本上使部分比 DAL 类更多。

如果 LINQ 类是 POCO，那么另一个例子是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T23:20:59.927

我会说[不是](http://geekswithblogs.net/AzamSharp/archive/2008/03/29/120847.aspx)。在 Linq to SQL 设计器生成的类中有相当多的智能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T02:27:34.110

好吧，它们至少没有继承任何特殊的基类。那里的大部分代码都可以简单地删除——LINQ-to-SQL 不需要任何代码。但请注意，这样做会失去许多增强功能，例如更有效的更改跟踪（没有属性更改事件）和延迟加载关系。

更重要的是，如果有人为您的需要工作，谁会在乎他们是否认为他们 POCO？至于将您自己的行为添加到数据对象……这就是对象的用途。POCO 并不意味着没有行为，它只是意味着对象不是太“奇怪”或具有大量特定于框架的代码（例如需要特殊的基类、特殊的接口等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T02:38:44.600

最简洁的答案是不。LINQ to SQL 生成的类包含数据库持久性逻辑，这是 LINQ to SQL 正常工作所必需的。[根据定义](https://stackoverflow.com/questions/250001/define-poco)， POCO没有这样的代码。

# app-store - 在哪里可以找到详细的 Apple App Store 政策？

> ID：534586
> 
> 赞同：5
> 
> 时间：2009-02-10T22:43:57.767
> 
> 标签：app-store

包括在哪些情况下申请会被拒绝，以及苹果占了多少百分比（广泛分布为 30%，尽管我在他们的网站上找不到任何提及）。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T23:13:12.940

给你：http: [//i.imgur.com/MgyH2.jpg](https://i.imgur.com/MgyH2.jpg)

不过，说真的，Apple 尚未发布接受政策的权威指南。有时这似乎是武断的和毫无根据的，有时甚至与他们提供的伪政策相反。

来自 iPhone 开发者协议第 3.3 节：

使用此 SDK 开发的任何应用程序必须符合这些标准和要求，因为它们可能会被 Apple 不时修改：

API 和功能：3.3.1 应用程序只能以 Apple 规定的方式使用已发布的 API，不得使用或调用任何未发布或私有的 API。

3.3.2 应用程序本身不得以任何方式安装或启动其他可执行代码，包括但不限于通过使用插件架构、调用其他框架、其他API或其他方式。除了由 Apple 发布的 API 和内置解释器解释和运行的代码外，不得在应用程序中下载和使用任何解释代码。

3.3.3 未经 Apple 事先书面批准，应用程序不得通过 App Store 以外的分发机制提供、解锁或启用其他特性或功能。

3.3.4 应用程序只能将设备上的数据写入应用程序的指定容器区域，Apple 另有规定的除外。用户界面和数据：

3.3.5 应用程序必须遵守 Apple 提供的人机界面指南和其他文档。

3.3.6 任何形式的用户或设备数据收集，或应用程序执行的图像、图片或语音捕获或录音（统称为“录音”），以及任何形式的用户数据、内容或信息处理、维护、上传、同步、应用程序执行的传输或传输（统称“传输”）必须遵守所有适用的隐私法律和法规以及与此类方面相关的任何 Apple 计划要求，包括但不限于任何通知或同意要求。特别是，必须向用户显示一个合理显眼的视觉指示器作为应用程序的一部分，以指示正在发生记录。SDK 协议第 5 页位置服务和用户隐私：

3.3.7 对于使用基于位置的 API 或收集、传输、维护、处理、共享、披露或以其他方式使用用户个人信息的应用程序：

*   对于本应用对用户位置数据或个人信息的任何收集、传输、维护、处理、使用等，您和本应用必须遵守所有适用的隐私和数据收集法律法规。

*   应用程序的设计或营销不得以骚扰、辱骂、跟踪、威胁或以其他方式侵犯他人的合法权利（如隐私权和公开权）为目的。

*   对于使用基于位置的 API 的应用程序，此类应用程序可能不是为实时路线引导而设计或销售的；车辆、飞机或其他机械设备的自动或自主控制；调度或车队管理；或紧急或救生目的。

*   应用程序不得使用任何机器人、蜘蛛、站点搜索或其他检索应用程序或设备来抓取、检索或索引 Apple 或其许可方提供的服务，或出于任何未经授权的目的收集有关用户的信息。

3.3.8 提供基于位置的服务或功能的应用程序必须在收集、传输或以其他方式使用应用程序之前通知个人并征得其同意。

3.3.9 应用程序不得禁用、覆盖或以其他方式干扰任何 Apple 实施的系统警报、警告、显示面板、同意面板等，旨在通知用户正在收集、传输、维护、处理或使用用户的位置数据，或打算获得此类使用的同意。如果拒绝或撤回同意，应用程序不得收集、传输、维护、处理或使用用户的位置数据。内容和材料：

3.3.10 您的申请中包含的任何主录音和音乐作品必须由您全资拥有或在全额支付的基础上以无需支付任何费用、版税和/或款项的方式授权给您Apple 向您或任何第三方提供。此外，如果您的申请将在美国境外分发，则您的申请中包含的任何主录音和音乐作品 (a) 不得属于任何机械或表演/传播权收集或许可组织现在或在(b) 如果获得许可，则必须由每个适用的版权所有者为您的应用程序专门许可给您。

3.3.11 如果您的应用程序包含或将包含任何其他内容，您必须拥有所有此类内容或获得内容所有者的许可才能在您的应用程序中使用这些内容。

3.3.12 应用程序不得包含任何淫秽、色情、攻击性或诽谤性的内容或任何类型的材料（文本、图形、图像、照片等），或 Apple 合理判断可能会被 iPhone 反感的其他内容或材料或 iPod touch 用户。

3.3.13 应用程序不得包含任何恶意软件、恶意或有害代码、程序或其他内部组件（例如计算机病毒、特洛伊木马、“后门”），这些组件可能会损坏、破坏或对其他软件、固件、硬件、数据产生不利影响、系统、服务或网络。SDK协议第6页

3.3.14 如果您的应用程序包含任何 FOSS，您同意遵守所有适用的 FOSS 许可条款。您还同意在您的应用程序开发中使用任何 FOSS 不会导致 SDK 的非 FOSS 部分受任何 FOSS 许可条款或义务的约束。蜂窝网络：

3.3.15 如果应用程序需要或将有权访问蜂窝网络，则另外此类应用程序：

*   必须遵守 Apple 关于应用程序应如何访问和使用蜂窝网络的最佳做法和其他指南；

*   不得在 Apple 的合理判断下过度使用或过度使用网络容量或带宽；

*   可能没有使用蜂窝网络的互联网协议语音 (VoIP) 功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T01:38:43.837

查看有关应用商店拒绝的帖子：[Apple store 拒绝 iPhone 应用程序的原因](https://stackoverflow.com/questions/308479/reasons-for-rejecting-iphone-application-by-apple-store)

是的，苹果的提成是 30%

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-10T22:54:55.463

您需要成为注册开发者。但信息在[这里](http://developer.apple.com/webapps/)。

# visual-studio-2008 - 将 VS2005 解决方案批量升级到 VS2008

> ID：534590
> 
> 赞同：5
> 
> 时间：2009-02-10T22:44:58.607
> 
> 标签：visual-studio-2008, visual-studio-2005, upgrade, bulk

是否可以将 VS 2005 项目批量升级（同时很多）到 VS 2008。

我知道我可以一次打开一个，但是，我想一次选择 10 个来升级并添加到新的解决方案中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-08T03:42:12.020

我最近遇到了同样的问题，并使用 Windows Powershell 脚本让 Visual Studio 使用[/upgrade](http://msdn.microsoft.com/en-us/library/w15a82ay.aspx)命令行开关为我进行升级

```
$slnFiles = ls C:\source -Filter *.sln -Recurse 
$devenv = "C:\Program Files (x86)\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe"
$i = 1
foreach ($sln in $slnFiles)
{
    "Upgrading Solution " + $i++ + ": " + $sln.FullName
    &$devenv /upgrade $sln.FullName
}
"Done!" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-01T12:21:40.473

Casey 的略微修改版本，适用于 VS 2010 并等待转换完成。这也将解决方案文件复制到一个在 .sln 之前带有 x 的文件。

```
$slnFiles = ls "C:\projects\source\" -Filter *.sln -Recurse 
$devenv = "C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\devenv.exe"
$i = 1
foreach ($sln in $slnFiles)
{
    "Upgrading Solution " + $i++ + ": " + $sln.FullName
    Start-Process -Wait $devenv -ArgumentList /NoSplash,/upgrade,$sln.FullName
    $name = $sln.name -replace ".sln", "x.sln" 
    Rename-Item $sln.FullName  -NewName $name
}
"Done!" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T06:27:36.797

我知道没有自动工具（除非最近开发了一些商业解决方案）。但是，如果您有大量项目要转换（100 个），那么编写一个小程序来为您执行此操作可能是值得的（毕竟我们是程序员 :)）。项目文件是有效的 XML 文件。只需手动转换一两个，并注意项目文件中的差异/更改。当您从 2005 升级到 2008 时，它并没有太大变化。编写一个程序来对大量项目文件进行相同的更改不会太难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-22T07:43:26.713

我总是使用免费的[AutoHotkey](http://www.autohotkey.com/)来执行重复性任务。

如果您使用一个项目记录鼠标/键盘操作，则可以为一组项目重新运行这些操作。

如果某些项目需要任何不同的选项，您可以手动编辑宏。

# javascript - 有没有 JavaScript 静态分析工具？

> ID：534601
> 
> 赞同：118
> 
> 时间：2009-02-10T22:47:29.117
> 
> 标签：javascript, static-analysis

当我做一些愚蠢的事情（比如变量名的拼写错误）时，我习惯于让我的编译器抱怨，但 JavaScript 有让这个通过的习惯。

有 JavaScript 的静态分析工具吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-08-17T11:47:01.340

2017 年更新答案：是的。使用 ESLint。[http://eslint.org](http://eslint.org)

* * *

除了[JSLint](http://jslint.org)（已经在[Flash Sheridan 的回答](https://stackoverflow.com/a/710837/55478)中提到）和[Closure 编译器](https://developers.google.com/closure/compiler/docs/gettingstarted_app)（之前在[awhyte 的回答](https://stackoverflow.com/a/2220180/55478)中提到）之外，我还从运行 JSHint 和 PHP CodeSniffer 中获得[了](http://jshint.com/about)很多[好处](http://pear.php.net/package/PHP_CodeSniffer)。截至 2012 年，所有四个工具都是免费开源的，并且背后有一个庞大而活跃的开发者社区。它们在执行的检查类型上都有点不同（我认为是互补的）：

**JSLint**被设计成，现在仍然是 Douglas Crockford 的个人 linting 工具。它附带了一个*很棒的*默认规则集——Crockford 自己的，随着他[继续学习](http://tech.groups.yahoo.com/group/jslint_com/msearch?date=any&DM=------------&DD=----&DY=----&DM2=------------&DD2=----&DY2=----&AM=contains&AT=douglas&SM=contains&ST=&MM=contains&MT=%22try+it+now%22&charset=UTF-8)JavaScript 及其陷阱而[不断更新。](https://github.com/douglascrockford/JSLint/commits/master/)JSLint[非常固执己见](https://gist.github.com/1745829)，这通常[被视为一件好事。](http://docs.jquery.com/JQuery_Core_Style_Guidelines#JSLint "jQuery 从 1.4.3 版开始通过 JSLint")因此，您可以（有意地）[有限地配置或禁用单个规则。](http://www.jslint.com/lint.html#options)但这会使将 JSLint 应用于遗留代码变得困难。

**JSHint**与 JSLint 非常相似（实际上它是作为 JSLint 的分支[开始](http://anton.kovalyov.net/2011/02/20/why-i-forked-jslint-to-jshint/)的），但通过命令行选项或[文件](https://npmjs.org/package/jshint)[配置或禁用](http://www.jshint.com/docs/)所有 JSLint 的检查更容易/可能。[`.jshintrc`](https://npmjs.org/package/jshint)

我特别喜欢我可以告诉 JSHint 报告文件中的*所有*错误，即使有数百个错误。相比之下，尽管 JSLint 确实有一个`maxerr`配置选项，但它通常会在尝试处理包含大量错误的文件时相对较早地退出。

**Closure 编译器**非常有用，因为如果代码*不能*用 Closure 编译，你可以很确定地感觉到所说的代码在某些基本方面*被*深深地冲洗了。闭包编译可能是 JS 世界中最接近“解释器”语法检查的东西，例如`php -l`或`ruby -c`

闭包还会[警告您潜在的问题](https://developers.google.com/closure/compiler/docs/error-ref)，例如缺少参数和未声明或重新定义的变量。如果您没有看到预期的警告，请尝试通过调用 Closure 选项来提高警告级别`--warning_level VERBOSE`

**PHP CodeSniffer** [可以解析 JavaScript](https://github.com/squizlabs/PHP_CodeSniffer/blob/master/CodeSniffer/Tokenizers/JS.php)以及 PHP 和 CSS。CodeSniffer 附带了几种不同的编码标准，（比如`phpcs -i`看看它们），其中包括许多对 JavaScript 代码有用的嗅探，包括检查[内联控制结构](https://github.com/squizlabs/PHP_CodeSniffer/blob/master/CodeSniffer/Standards/Generic/Sniffs/ControlStructures/InlineControlStructureSniff.php)和[多余的空格](https://github.com/squizlabs/PHP_CodeSniffer/blob/master/CodeSniffer/Standards/Squiz/Sniffs/WhiteSpace/SuperfluousWhitespaceSniff.php)。

这是PHP CodeSniffer 1.3.6 版本中可用[的 JavaScript 嗅探列表，这是一个](https://gist.github.com/3375708#file_js_code_sniffs.md)[自定义规则集，可让您一次运行它们。](https://gist.github.com/3375708#file_js_sniffs.xml) 使用自定义规则集，您可以轻松[挑选](http://pear.php.net/manual/en/package.php.php-codesniffer.annotated-ruleset.php)要应用的规则。如果您想强制执行开箱即用不支持的特定“房屋风格”，您甚至可以[编写自己的嗅探器。](http://pear.php.net/manual/en/package.php.php-codesniffer.coding-standard-tutorial.php)Afaik CodeSniffer 是这里提到的四个工具中唯一支持自定义和创建新静态分析规则的工具。不过需要注意的是：CodeSniffer 也是上述所有工具中运行速度最慢的。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-04-02T17:46:45.933

我同意 JSLint 是最好的起点。请注意，[JavaScript Lint](http://www.javascriptlint.com/)与[JSLint](http://www.jslint.com/)不同。我还建议检查一下[JSure](https://github.com/berke/jsure)，在我有限的测试中，它比其中任何一个都好，尽管在实施中有一些粗糙的边缘——英特尔 Mac 版本在启动时崩溃了，尽管 PowerPC 版本即使在英特尔上也运行良好， Linux 版本也运行良好。（开发商 Berke Durak 说他会在这个问题修复后回复我，但我还没有收到他的消息。）

不要对 JavaScript 静态分析的期望与从优秀的 C 检查器获得的期望一样多。正如 Durak 告诉我的，“由于 Javascript 的动态特性，任何重要的分析都非常困难。”</p>

（另一个更隐蔽的仅适用于 Mac 的错误，这次是 JSLint 的 Konfabulator 小部件：将 BBEdit 文档图标拖到小部件上会将文档移动到垃圾箱。开发人员 Douglas Crockford 没有在 Mac 上尝试过该小部件。）

2009 年 8 月 10 日：今天在[静态分析研讨会上](http://sas09.cs.ucdavis.edu/)，Simon Holm Jensen 发表了一篇关于[TAJS：JavaScript 类型分析器](http://www.brics.dk/TAJS/)的论文，由 Anders Møller 和 Peter Thiemann 撰写。这篇论文没有提到上述工具，但 Jensen 告诉我他看过其中一些工具并没有留下深刻的印象。TAJS 的代码应该在今年夏天的某个时候可用。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-02-08T07:51:37.363

[Google 的“Closure”JS 编译器](http://code.google.com/closure/compiler/)在编译时产生可配置的警告和错误。它肯定会发现拼写错误的变量和方法，以及数量错误。如果您愿意以 Closure 方式编写 JsDoc，它也可以在类型信息方面做很多事情。

YUI“压缩器”工具也可以产生警告，但还没有尝试过。

我对基于 Eclipse 构建的 Aptana IDE 不太满意，但其他人喜欢它。请参阅 JS IDE 的 Stack Overflow 讨论。

IntelliJ IDE（我上次检查时不是免费的）具有出色的 JS 支持。它会在您键入时检测并突出显示拼写错误的变量和方法等。它也有自动完成功能。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-09-08T16:28:33.477

总之，JSLint、JSHint、Plato、ESLint、Google Closure-Linter 是可用的工具。我在试用适用于 Windows 的 Google Closure-Linter 时遇到了安装问题。但是，它确实在网页上提到它对 Windows 的支持是实验性的。我找到并尝试了另一种效果很好的工具。这是它的链接： [http ://esprima.org/](http://esprima.org/)

此外，这是工具 Esprima 的 github 链接： [https ://github.com/ariya/esprima](https://github.com/ariya/esprima)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2017-09-15T10:59:34.467

[您可以在这个Wiki](https://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis#JavaScript)中看到一些用于 JavaScript 静态代码分析的工具。

Wiki 中的一个工具是[DeepScan](https://deepscan.io) ，但本文未提及。它的重点是发现运行时错误和质量问题，而不是 linter 的编码约定。它还涵盖了 TypeScript、React 和 Vue.js。

你可以在你的 GitHub 项目中尝试一下。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-09-08T16:01:50.337

我试用了 ESlint，发现它很好。你也可以在那里添加自定义规则。这里是 github repo：[https](https://github.com/nzakas/eslint) ://github.com/nzakas/eslint ，这里是它的介绍：[http://www。 nczonline.net/blog/2013/07/16/introducing-eslint/](http://www.nczonline.net/blog/2013/07/16/introducing-eslint/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-11-03T04:00:38.553

可以在 Mozilla Wiki 的[Security/B2G/JavaScript 代码分析中找到比通用列表更注重安全性的内容](https://wiki.mozilla.org/Security/B2G/JavaScript_code_analysis)

> 本文档的目的是收集适合包含在即将到来的 Mozilla 项目中或供内部使用的 JavaScript 代码分析工具。

此外，至少还有一种商业产品可以进行安全分析： [Burp 获得了新的 JavaScript 分析功能](http://blog.portswigger.net/2014/07/burp-gets-new-javascript-analysis.html)

> Burp 的最新版本包括一个用于 JavaScript 代码静态分析的新引擎。这使 Burp Scanner 能够报告一系列新漏洞，包括：
> 
> *   基于 DOM 的 XSS
> *   JavaScript 注入
> *   客户端 SQL 注入
> *   WebSocket 劫持
> *   本地文件路径操作
> *   基于DOM的开放重定向
> *   Cookie 操作
> *   Ajax 请求头操作
> *   基于 DOM 的拒绝服务
> *   网络消息操作
> *   HTML5 存储操作

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-01-14T17:35:44.463

在商业领域，[**Coverity 静态分析**](http://www.coverity.com/products/code-advisor/)从 7.7 版（2015 年中）开始支持对 JavaScript 的分析。关于您对拼写错误的具体询问，我在最新版本（8.0，2016 年初）中出现的宠物项目确实在程序元素的名称**中发现拼写错误。**

作为项目的关键开发人员，请接受我的无耻插件：虽然还没有像古老的[C/C++ 分析](http://www.coverity.com/press-releases/cern-chooses-coverity-to-ensure-accuracy-of-large-hadron-collider-software/)那样成熟，但Coverity 的 JavaScript 分析与很多引擎共享相同的引擎，同样专注于寻找高价值缺陷和低价值缺陷。误报缺陷报告的比率。除了发现一般编程错误外，我们还更加关注发现 JavaScript（和其他语言）中的安全缺陷。

现在，这里有一些它发现的错别字（确切的错别字留给读者作为练习，以强调这些错字是多么容易被忽略）：

merge.js：（[稳定链接）](https://github.com/OnsenUI/OnsenUI/blob/cf7d845552751f6a9a4f1d26ea9f0377e90dfbb3/css-components/www/vendor/codemirror-4.0/addon/merge/merge.js#L356) [（最新版本）](https://github.com/OnsenUI/OnsenUI/blob/master/css-components/www/vendor/codemirror-4.0/addon/merge/merge.js#L356)

commands-packages-query.js：（[稳定链接）](https://github.com/CulturalMe/meteor/blob/e6788b9a223710d66bae9f279b27bf78255ce6b7/tools/commands-packages-query.js#L1119) [（最新版本）](https://github.com/CulturalMe/meteor/blob/devel/tools/commands-packages-query.js#L1119)

series-pie-tests.js：（[稳定链接）](https://github.com/yui/yui3/blob/25264e3629b1c07fb779d203c4a25c0879ec862c/src/charts/tests/unit/assets/series-pie-tests.js#L382) [（最新版本）](https://github.com/yui/yui3/blob/master/src/charts/tests/unit/assets/series-pie-tests.js#L382)

outline_case.js：（[稳定链接）](https://github.com/sproutcore/sproutcore/blob/5b85498348e01ba59663c03c70da11f13571d20d/frameworks/foundation/tests/controllers/tree/outline_case.js#L99) [（最新版本）](https://github.com/sproutcore/sproutcore/blob/master/frameworks/foundation/tests/controllers/tree/outline_case.js#L99)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-10T22:49:41.250

我喜欢[Jslint](http://www.jslint.com/)的这种东西......

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-05-01T20:45:55.123

[Flow](http://flowtype.org/)进行带注释和不带注释的静态分析。

如果您需要注解，语法与[TypeScript](http://www.typescriptlang.org/)兼容。

安装[包](https://www.npmjs.com/package/flow-bin)：

```
npm install --global flow-bin 
```

还有一些工具。看看[gulp-flowtype](https://www.npmjs.com/package/gulp-flowtype)和[SublimeLinter-flow](https://packagecontrol.io/packages/SublimeLinter-flow)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-11-29T21:12:05.523

JSAnalyse 刚刚在 codeplex 上发布。它是一个分析javascript文件之间依赖关系的工具。您甚至可以定义允许的依赖项，JSAnalysis 会检查定义的规则是否得到满足。即使在大型项目中，这也允许跟踪 javascript 依赖项并拥有干净的架构。

JSAnalyse 可以作为命令行工具执行，也可以通过 Visual Studio Layer Diagramm 进行配置。它也很容易集成到构建中。通过门控签入，您可以控制依赖关系。

[http://jsanalysis.codeplex.com/](http://jsanalyse.codeplex.com/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-05-05T08:08:11.163

我们的[SD ECMAScript CloneDR](http://www.semanticdesigns.com/Products/Clone/ECMAScriptCloneDR.html)是一种工具，用于在大型 JavaScript 源代码库中查找重复代码的准确副本和几乎未命中的副本。

它使用语言语法来指导检测，因此无论格式更改、插入/删除注释、重命名变量甚至是一些插入/删除语句，它都能找到克隆。

该站点有一个在 Google 的 Closure 库上运行的示例 CloneDR。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-08-25T14:24:21.600

完全披露，我支持：[http](http://www.toptensoftware.com/minime) ://www.toptensoftware.com/minime ，它进行缩小、混淆和一组合理的 lint 样式检查。

# python - Python Golf：将此列表转换为字典的最简洁方法是什么：

> ID：534608
> 
> 赞同：3
> 
> 时间：2009-02-10T22:49:02.153
> 
> 标签：python, code-golf

我有一个看起来像这样的列表：

```
[['Tom', 'Dick'], ['Harry', 'John', 'Mike'], ['Bob']] 
```

我想把它变成一个字典，其中每个键是一个名称，每个值是一个与其子列表在列表中的位置相对应的数字：

```
{'Tom': 0, 'Dick': 0, 'Harry': 1, 'John': 1, 'Mike': 1, 'Bob': 2} 
```

我尝试了各种列表推导，但我无法让它与嵌套列表一起正常工作。我可以使用嵌套循环，如下所示：

```
names = [['Tom', 'Dick'], ['Harry', 'John', 'Mike'], ['Bob']]
names_dict = {}
for i, name_sublist in enumerate(names):
    for name in name_sublist:
        names_dict[name] = i 
```

但我怀疑有一种更短、更优雅的方法。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-10T23:09:25.147

与 MizardX 相同的想法，但在 Python 3.0 中使用[dict 推导更小更漂亮：](http://www.python.org/dev/peps/pep-0274/)

```
>>> names = [['Tom', 'Dick'], ['Harry', 'John', 'Mike'], ['Bob']]
>>> names_dict = {name:index for index, lst in enumerate(names) for name in lst}
>>> names_dict
{'Tom': 0, 'Mike': 1, 'Dick': 0, 'Harry': 1, 'Bob': 2, 'John': 1} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-10T22:51:09.933

```
names_dict = dict((name,index)
                  for index,lst in enumerate(names)
                  for name in lst) 
```

例子：

```
>>> names = [['Tom', 'Dick'], ['Harry', 'John', 'Mike'], ['Bob']]
>>> names_dict = dict((name,index)
...                   for index,lst in enumerate(names)
...                   for name in lst)
>>> names_dict
{'Tom': 0, 'Mike': 1, 'Dick': 0, 'Harry': 1, 'Bob': 2, 'John': 1} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-12T20:39:19.320

蟒蛇2.6

```
dict([(t,l.index(x)) for x in l for t in x]) 
```

python3.0

```
{t:l.index(x) for x in l for t in x} 
```

如果 l 是名称列表

# ruby-on-rails - 为最新的 Rails 创建“朋友”系统/社交网络的最佳插件？

> ID：534621
> 
> 赞同：3
> 
> 时间：2009-02-10T22:53:31.130
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-plugins

我正在寻找一个 Rails 插件，它可以简化最新版本的 Ruby on Rails 的“朋友”系统或社交网络系统的开发。

在任何人说之前...我知道，我可能应该自己创建它，从头开始。我完全有能力做到这一点（我认为）。我只是在寻找一个好的插件，它可以a.）让我的生活更轻松，b.）给我一些参考的想法。

我尝试制作自己的身份验证系统，并做了我认为还可以的事情，但后来我切换到 restful_authentication 并意识到我的系统相比之下是多么糟糕。

提前致谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T02:47:06.123

你可能想试试[社区引擎](http://www.communityengine.org/)

从网站

> CommunityEngine 是一个免费的开源社交网络插件，适用于 Ruby on Rails 应用程序。将其放入您的新应用程序或现有应用程序中，您将立即拥有基本社区站点的所有功能。

它使用引擎，易于更改布局或进行修改

现实世界的例子 - [http://www.weebabystuff.com/](http://www.weebabystuff.com/)

我知道的另一个选择是 Chuck 发布的 Insoshi

更新：查看这篇博文[http://jimneath.org/2008/04/25/building-a-social-network-site-in-rails/](http://jimneath.org/2008/04/25/building-a-social-network-site-in-rails/)

-- 埃德 :) --

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T08:24:16.873

您可以查看[http://lovdbyless.com/](http://lovdbyless.com/)

这是一个免费的开源 Rails 社交网络应用程序，它应该会给你很多想法和建议。

罗纳德

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-01T12:12:14.973

你必须看到这个[railscasts 视频。](http://railscasts.com/episodes/163-self-referential-association)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-01T07:28:26.200

尝试acts_as_network插件

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T23:24:59.883

我知道的唯一一个是[Insoshi](http://portal.insoshi.com/)。我自己没有使用过它，但听起来这就是你要找的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T23:29:01.123

我建议使用[OpenID](http://wiki.rubyonrails.org/rails/pages/openid)库来处理身份验证。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T08:25:09.200

除了其他人所说的，还有acts_as_network。这个的好处是它是一个纯插件（不需要引擎）。不必担心引擎是一个巨大的优势。当然，缺点是它不是一个成熟的社交网络。它只是一个模型的交友插件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-20T00:46:18.400

您可能想查看[Amistad](https://github.com/raw1z/amistad) gem。它看起来很简单，它同时支持 Mongoid 和 Active Record。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-11T00:04:12.257

对于头像我会使用[头像](http://github.com/gcnovus/avatar/tree/master)并尝试[将分页](http://github.com/mislav/will_paginate/tree/master)进行分页。除此之外，我喜欢[can_serach](http://github.com/technoweenie/can_search/tree/master)以使其更容易在数据库中搜索。

您还应该查看[technoweenie](http://github.com/technoweenie)的其他宝石。那里有很多很棒的东西可以帮助你

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-11T10:57:33.400

我自己一直在研究这个并选择使用 Bort & CommunityEngine

Bort，因为我已经熟悉它，它提供了用户身份验证和基本应用程序功能所需的一切。Community Engine，因为它是一个基于 Engines 的插件，并且 Engines 的某些方面正在合并到 Rails 2.3 中，所以我知道我学到的东西将继续有用，并且因为 CommunityEngine 看起来更加模块化，而 lovebyess 和 Insoshi 看起来更像是完整的应用程序，我怀疑它将我想要的功能与我不想要的功能分开可能需要做更多的工作。但是，请注意这一点，因为它只是基于高级快速浏览的初始印象。

如果您只想要一个活动源，那么有[活动流插件](http://www.railslodge.com/plugins/1211-activity-streams)

# vim - 字节码对比 口译

> ID：534623
> 
> 赞同：8
> 
> 时间：2009-02-10T22:54:01.130
> 
> 标签：vim, performance, interpreter, bytecode

我记得一位教授曾经说过解释代码比编译代码慢大约 10 倍。解释和字节码之间的速度差异是什么？（假设字节码不是 JIT 编译的）

我问是因为有些人一直在考虑将 vim 脚本编译成字节码的想法，我只是想知道这会得到什么样的性能提升。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-10T22:55:19.067

当您将内容编译为字节码时，您有机会首先执行一系列昂贵的高级优化。您将字节码设计为*非常*容易编译为机器码并提前运行所有优化和流分析。

因此，速度的提高可能相当可观——您不仅在运行时跳过了整个词法分析/解析阶段，而且您还有更多机会应用优化并生成更好的机器代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T23:01:26.290

你可以看到一个很好的提升。但是，有很多因素。你不能只说编译代码总是比解释代码快 10 倍，或者说字节码比解释代码快 n 倍。

例如，因素包括语言的复杂性和冗长程度。如果语言中的关键字是几个字符，而字节码是一个，那么加载字节码并跳转到处理该字节码的例程应该比读取关键字字符串快得多，然后弄清楚去哪儿。但是，如果您正在解释一种具有单字节关键字的外来语言，则差异可能不太明显。

我已经在实践中看到了这种性能提升，所以这对你来说可能是值得的。此外，编写这样的东西很有趣，让您了解语言解释器和编译器的工作原理，这将使您成为更好的编码器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T00:25:10.707

这些天实际上有没有真正编译他们的代码的主流“解释器”？（无论是字节码还是类似的东西。）

例如，当您直接从源代码使用 Perl 程序时，它所做的第一件事就是将源代码编译成语法树，然后对其进行优化并用于执行程序。在正常情况下，编译所花费的时间与实际运行程序的时间相比是很小的。

坚持这个例子，显然 Perl 不能比经过良好优化的 C 代码更快，因为它是用 C 编写的。实际上，对于您通常使用 Perl 做的大多数事情（如文本处理），它会尽可能快用 C 合理地编码它，并且更容易编写几个数量级。另一方面，我当然不会尝试直接在 Perl 中编写高性能数学例程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T00:26:02.983

此外，许多“经典”解释器还包括 lex/parse 阶段以及执行​​。

例如，考虑执行 Python 脚本。当您这样做时，您将承担与将程序文本转换为内部解释器数据结构相关的所有成本，然后执行这些数据结构。

现在将其与执行已编译的 Python 脚本（一个 .pyc 文件）进行对比。到这里，lex 和 parse 阶段就完成了，你就拥有了内部解释器的运行时间。

但是，如果您考虑使用经典的 BASIC 解释器，它们通常从不存储原始文本，而是存储标记化的形式并在您执行“LIST”时重新创建程序文本。这里的字节码要粗略得多（您实际上并没有虚拟机），但是您的执行会跳过一些文本处理。当您输入该行并按 ENTER 时，这一切都完成了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T00:09:55.033

这是根据你的虚拟机。您的一些更快的虚拟机 (JVM) 正在接近 C 代码的速度。那么，与 C 相比，您的解释代码运行速度有多快？

不要认为如果将解释代码转换为字节码，它的运行速度会与 Java 一样快（接近 C 速度），性能提升已经持续多年，但您应该会看到显着的速度提升。

[Emacs](http://jemacs.sourceforge.net/)已被移植到具有更高性能的字节码中。可能值得你看看。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T00:21:12.840

我从来没有注意到一个慢到足以引起注意的 Vim 脚本。假设脚本主要调用在编辑器核心中实现的内置本机代码操作（正则表达式、块操作等），即使脚本中的“胶合逻辑”加速 10 倍也是微不足道的。

尽管如此，剖析是真正确定的唯一方法。

# c# - 如何使用下拉列表动态排序列表框？

> ID：534629
> 
> 赞同：2
> 
> 时间：2009-02-10T22:55:07.430
> 
> 标签：c#, asp.net

我有一个有 20 种颜色的列表框。它看起来像这样：

1：红色 2：绿色 3：蓝色 4：橙色 5：红色 6：黄色 7：橙色 8：红色 9：绿色 ....

它从 ObjectDataSource 获取数据，ObjectDataSource 又从返回数据表的方法获取数据。我想要一个下拉菜单，它基本上有 2 个项目，按 # 排序和按颜色排序。如果用户选择Order By #，它将按升序或降序对ListBox 进行排序。如果用户选择按颜色排序，它将按颜色排序。我该怎么做呢？

我可以使用 DataView 对此进行排序吗？

谢谢， XaiSoft

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T00:04:56.247

您可以将排序表达式作为 Select 参数添加到 ObjectDataSource，您可以像这样定义它：

```
 <asp:ObjectDataSource 
        ID="ObjectDataSource1" 
        runat="server" 
        SelectMethod="SelectMethod" 
        TypeName="MyDataObject">
            <asp:Parameter Direction="input" Type="string" Name="sortExpression">
            </asp:Parameter>
    </asp:ObjectDataSource> 
```

然后在检索数据的“SelectMethod”方法中添加该名称的参数并返回 DataView：

```
 public DataView SelectMethod(string sortExpression)
    {
        DataTable table = GetData();
        DataView dv = new DataView(table);
        dv.Sort = sortExpression;
        return dv;
    } 
```

然后在 ObjectDataSource 的向导中，您可以将该参数绑定到下拉列表 SelectedValue。使每个 DropDown 项的值与您的列名相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T23:05:57.153

（我假设您首先已经弄清楚如何绑定 ListBox。）

在 DropdownList 上设置属性 AutoPostback="true"。当用户选择不同的值时，这将导致 SelectedIndexChanged 事件触发。

在那里你可以重新绑定你的列表框。

* * *

**编辑：**删除了我对 ObjectDataSource 的误解 - joshperry 的回答涵盖的要好得多！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T11:06:39.980

只是想知道...您已经在 ListBox 中拥有数据，为什么不使用 javascript 对其进行排序呢？为了避免回到服务器并要求同样的事情。

只需获取正确的列表框 id，您就完成了！

```
<script language="JavaScript" type="text/javascript">
  function sortlist() {
    var lb = document.getElementById('mylist'); // <-- Use $get(<%# myList.ClientID %>); if you want
    arrTexts = new Array();

    for(i=0; i<lb.length; i++)  {
      arrTexts[i] = lb.options[i].text;
    }

    arrTexts.sort();
    // arrTexts.reverse()  // <-- uncomment if you want descending

    for(i=0; i<lb.length; i++)  {
      lb.options[i].text = arrTexts[i];
      lb.options[i].value = arrTexts[i];
    }
  }
</script>

<select name="mylist" id="mylist" size="5">
  <option value="Anton">Anton</option>
  <option value="Mike">Mike</option>
  <option value="Peter">Peter</option>
  <option value="Bill">Bill</option>
  <option value="Carl">Carl</option>
</select>
<br />
<a href="javascript:sortlist();">sort</a> 
```

# java - 如何守护 Java 程序？

> ID：534648
> 
> 赞同：75
> 
> 时间：2009-02-10T22:58:42.647
> 
> 标签：java, process, daemon

我有一个 Java 程序，我想在 linux 系统上进行守护进程。换句话说，我想在 shell 中开始运行它，并在我注销后让它继续运行。我也希望能够干净地停止程序。

我发现[这篇文章](http://barelyenough.org/blog/2005/03/java-daemon/ "本文")结合使用了 shell 脚本和 Java 代码来解决问题。它看起来不错，但如果可能的话，我想要更简单的东西。

在 Linux 系统上守护 Java 程序的首选方法是什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-10T23:04:17.640

[Apache Commons Daemon](http://commons.apache.org/daemon/)会将您的 Java 程序作为 Linux 守护程序或 WinNT 服务运行。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-10T23:35:24.087

如果你不能依赖[其他地方](https://stackoverflow.com/a/534680/362)引用的[Java Service Wrapper](http://wrapper.tanukisoftware.org/)（例如，如果你在 Ubuntu 上运行，它没有 SW 的打包版本），你可能想用老式的方式来做：让你的程序在 / 中写入它的 PID var/run/$progname.pid，然后围绕它编写一个标准的 SysV 初始化脚本（例如使用 ntpd 的脚本，它很简单）。最好也使其符合 LSB。

本质上，启动函数测试程序是否已经在运行（通过测试 /var/run/$progname.pid 是否存在，并且该文件的内容是正在运行的进程的 PID），如果没有运行

```
logfile=/var/log/$progname.log
pidfile=/var/run/$progname.pid
nohup java -Dpidfile=$pidfile $jopts $mainClass </dev/null > $logfile 2>&1 
```

stop 函数检查 /var/run/$progname.pid，测试该文件是否是正在运行的进程的 PID，验证它是否是 Java VM（以免杀死一个简单地从死机中重用 PID 的进程我的 Java 守护进程的实例），然后终止该进程。

调用时，我的 main() 方法将首先将其 PID 写入 System.getProperty("pidfile") 中定义的文件中。

然而，一个主要障碍是：在 Java 中，没有简单而标准的方法来获取 JVM 运行的进程的 PID。

这是我想出的：

```
private static String getPid() {
    File proc_self = new File("/proc/self");
    if(proc_self.exists()) try {
        return proc_self.getCanonicalFile().getName();
    }
    catch(Exception e) {
        /// Continue on fall-back
    }
    File bash = new File("/bin/bash");
    if(bash.exists()) {
        ProcessBuilder pb = new ProcessBuilder("/bin/bash","-c","echo $PPID");
        try {
            Process p = pb.start();
            BufferedReader rd = new BufferedReader(new InputStreamReader(p.getInputStream()));
            return rd.readLine();
        }
        catch(IOException e) {
            return String.valueOf(Thread.currentThread().getId());
        }
    }
    // This is a cop-out to return something when we don't have BASH
    return String.valueOf(Thread.currentThread().getId());
} 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-02-10T23:27:28.787

我经常发现自己编写的脚本或命令行基本上看起来像这样，如果我想：

1.  运行一个不受 sighups 影响的程序
2.  这与生成它的外壳完全断开，并且
3.  从 stderr 和 stdout 生成一个日志文件，其中的内容也会显示出来，但是
4.  允许我停止查看正在进行的日志并执行其他操作，而不会中断正在运行的进程

享受。

```
nohup java com.me.MyProgram </dev/null 2>&1 | tee logfile.log &
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-02-10T23:10:43.133

我更喜欢[nohup](http://linux.die.net/man/1/nohup)命令。博客文章说有更好的方法，但我认为它们还不够好。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-10T23:07:06.167

你可以试试[Java Service Wrapper](http://wrapper.tanukisoftware.org/doc/english/download.jsp)，社区版是免费的，可以满足你的需求。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-10T23:10:45.737

那要看。如果这只是一次性的事情，我想将其守护，然后回家，但通常我等待结果，我可能会这样做：

```
nohup java com.me.MyProgram & 
```

在命令行。要彻底杀死它，您有很多选择。您可能有一个 SIGKILL 侦听器，或者侦听端口并在建立连接时关闭，定期检查文件。不同的方法有不同的弱点。如果它用于生产，我会多加考虑，并且可能会在 /etc/init.d 中添加一个脚本来阻止它，并进行更复杂的关闭，例如 tomcat 所具有的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-05-16T15:31:42.357

我在 Ubuntu 上的首选方式是使用 libslack 'daemon' 实用程序。这就是 Jenkins 在 Ubuntu 上使用的（这就是我产生这个想法的地方。）我已经将它用于基于 Jetty 的服务器应用程序，它运行良好。

当您停止守护进程时，它将向 JVM 发出关闭信号。此时，您可以通过使用 Runtime.addShutdownHook() 注册关闭挂钩来执行关闭/清理代码。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-10T23:46:01.020

[这个](https://stackoverflow.com/questions/525247/how-do-i-daemonize)问题是关于守护任意程序（不是特定于 java 的），所以一些答案可能适用于您的案例：

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-02-23T04:48:09.883

DaemonTools :- 在 UNIX 上管理服务的更简洁的方法[https://cr.yp.to/daemontools.html](https://cr.yp.to/daemontools.html)

1.  从 url [https://cr.yp.to/daemontools/install.html](https://cr.yp.to/daemontools/install.html)安装守护程序工具， 按照那里提到的说明进行操作，如有任何问题，请尝试说明[https://gist.github.com/rizkyabdilah/8516303](https://gist.github.com/rizkyabdilah/8516303)

2.  **在/etc/init/svscan.conf**创建一个文件并添加以下行。（仅 cent-os-6.7 需要）

> ```
>  start on runlevel [12345]
>  stop on runlevel [^12345]
>  respawn
>  exec /command/svscanboot 
> ```

3.  在 /service/vm/ 文件夹中创建一个名为**run**的新脚本并添加以下行。

> ```
> #!/bin/bash    
> echo starting VM 
> exec java -jar
> /root/learning-/daemon-java/vm.jar 
> ```

注意：将 Jar 替换为您自己的 Jar 文件。或任何 java 类文件。

4.  重新启动系统

5.  svstat /service/vm 现在应该已经启动并运行了！

6.  svc -d /service/vm 现在应该关闭 vm ！
7.  svc -u /service/vm 现在应该启动 vm 了！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-06-05T07:32:50.353

看看这里：

[http://jnicookbook.owsiak.org/recipe-no-022/](http://jnicookbook.owsiak.org/recipe-no-022/)

获取基于 JNI 的示例代码。在这种情况下，您将对作为 Java 启动的代码进行守护，并在 C 中执行主循环。但也可以将主、守护、服务循环放在 Java 中。

[https://github.com/mkowsiak/jnicookbook/tree/master/recipes/recipeNo029](https://github.com/mkowsiak/jnicookbook/tree/master/recipes/recipeNo029)

JNI 玩得开心！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-08-14T07:05:34.993

```
nohup java -jar {{your-jar.jar}} > /dev/null & 
```

这可能会奏效。

# charts - Yahoo Finance API 类似图表

> ID：534650
> 
> 赞同：1
> 
> 时间：2009-02-10T22:59:04.393
> 
> 标签：charts

我想在 .NET 应用程序中创建一个与[yahoo Finance 交互式图表非常相似的图表。](http://finance.yahoo.com/echarts?s=%5EDJI#chart1:symbol=%5Edji;range=6m;indicator=volume;charttype=line;crosshair=on;ohlcvalues=0;logscale=on;source=undefined)雅虎财经的交互式图表不包含在他们的开发者 API 中。有没有人尝试利用他们的 API 创建类似的图表？尽管该图表与雅虎上使用的图表非常相似，但用于我分析的数据不是股票数据。因此，我将无法通过提供任何查询参数来调用 Yahoo Url。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-19T05:01:48.543

如果您查看基于 Web 的图表，恕我直言，jQuery 的*浮动*图是一个不错的选择。它们看起来很漂亮，具有交互性，并且很容易上手。

[http://plugins.jquery.com/project/flot](http://plugins.jquery.com/project/flot)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T04:50:27.353

amCharts[股票图表](http://amcharts.com/stock/)属于同一品种。它是基于 Flash 的，但您可以轻松地将它与任何服务器端引擎一起使用。不确定您是在寻找网络解决方案还是 Windows 解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T08:30:27.090

您也可以考虑[Infragistics Web Charts](http://www.infragistics.com/dotnet/netadvantage/aspnet/webchart.aspx)。

# java - 如何将对象实例存储为 EJB3 实体的字段？

> ID：534652
> 
> 赞同：1
> 
> 时间：2009-02-10T22:59:42.783
> 
> 标签：java, orm, jpa

我有一个实体 Promotion，它有 3 个简单字段（id、name、description），所有 3 个字段都将映射到 DB。到目前为止，一切都很好。问题在于第 4 个字段 ruleModel，它是 RuleModel 的一个实例，在运行时构造时，它将包含十几个其他类的对象实例。我不想将 RuleModel 映射到数据库表，因为这是很多额外的工作，也是不必要的。我只想将 ruleModel 对象实例存储到 DB 中，然后能够从 DB 加载 ruleModel 并将对象实例恢复到内存中。

代码：

```
@Entity  
public class Promotion {  
    @Id  
    @GeneratedValue  
    private Long id;  

    private String name;  
    private String description;  

    private RuleModel ruleModel; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T23:05:14.227

If you make the Rule Model class implement the Serializeable interface then you should be able to add a RuleModel variable to your Promotion class. This would require the addition of a new column to the Promotion table. When you persist the Promotion class the seraralized instance of the RuleModel class instance will be stored in the new column.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-08T12:56:52.900

如果我理解正确，您正在尝试序列化*RuleModel*实例 - 其中包含对许多其他实例的引用 - 当您反序列化它时，您会接受之前持有的所有引用*ruleModel*都会丢失。如果这是你的目标，你需要做两件事：

1.  用瞬态标记*RuleModel*中的任何字段
2.  使用 JPA **@Embeddable**注释对*RuleModel*进行注释
***   使用**@Embedded**注释*Promotion中的**ruleModel*字段**

 *****虽然这不会将*ruleModel*实例保存到单个列中，但它会将实例保存到*Promotion*使用的同一表的多个列中。它还将根据您的需要重新实例化*ruleModel*。

# javascript - Javascript 和只有一个复选框 - 未定义

> ID：534657
> 
> 赞同：6
> 
> 时间：2009-02-10T23:01:35.493
> 
> 标签：javascript, html, forms, checkbox

```
for (i = 0; i < document.checks.user.length; i++) //for all check boxes
{
    if (document.checks.user[i].checked == true )
    {
        document.checks.submit();
        return 0;
    }
}

<body>
<form action="" method=POST name="checks" ID="Form2">
  I have a bike:
  <input type="checkbox" name="user" value="Bike" ID="Checkbox1">
  <br>
  <br>
</form>
<input type="button" value="Delete" 
    class="btn" onclick="sub_delete()" 
    onmouseover="hov(this, 'btn btnhov')" onmouseout="hov(this, 'btn')" 
    id="Button1" name="Button1" 
/>
</body> 
```

正如您可能已经知道，当只剩下一个复选框时 document.checks.user.length = undefined。确保当只有一个复选框时，它会被删除的最有效方法是什么。我只是想在此处的 if 语句之前将其添加为单独的 if 语句......任何建议。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-10T23:25:38.493

使用循环控制变量，如果长度未定义，则将其设置为 1...

```
var len = document.checks.user.length;
if(len == undefined) len = 1;
for (i = 0; i < len; i++) //for all check boxes 
```

最好的祝福...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T07:31:27.920

```
if (document.getElementById('Checkbox1').checked) { /* do something */ } 
```

如果你想循环一堆复选框，你可以循环表单的输入字段，比如：

```
var formNodes  = document.checks.getElementsByTagName('input');
for (var i=0;i<formNodes.length;i++) {
   /* do something with the name/value/id or checked-state of formNodes[i] */
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T05:36:32.690

```
if(document.checks.user[0]) {
  //it's an array
}
else {
  //it's a single element
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-02T06:23:57.133

您的问题有些令人困惑，因为您的 javascript 显然必须在一个名为“sub_delete”的函数中才能使用......具有编辑问题的强大能力的人可能会通过使问题更清晰来改善问题......

因此，您必须解决的第一个问题是，对于具有给定名称“用户”的单个复选框，它不是一个数组，因此没有定义的长度，而且如果您尝试将其作为数组访问..事情变得混乱.. 完全重写您的 javascript 函数可能如下所示：

```
 function sub_delete{
        if (typeof document.checks.user.length === 'undefined') {
   /*then there is just one checkbox with the name 'user' no array*/
        if (document.checks.user.checked == true )
                            {
                                document.checks.submit();
                                return 0;
                            }   
    }else{
  /*then there is several checkboxs with the name 'user' making an array*/
        for(var i = 0, max = document.checks.user.length; i < max; i++){
            if (document.checks.user[i].checked == true )
                            {
                                document.checks.submit();
                                return 0;
                            }

        }
    }
    }//sub_delete end 
```

HTH, -FT

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-29T06:54:29.493

我也面临同样的问题，总共有 5 个复选框，其中 4 个被禁用，1 个被启用。现在 checkboxId.length 是未定义的，所以我能想到的唯一选项是 if(checkboxId.length ==undefined ){checkboxId.checked=true & submith the form}。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-17T11:39:18.777

这很简单，只需创建一个与现有复选框输入标签名称相同的隐藏输入标签。

例如：

```
<input type="checkbox" name="user" value="Bike" ID="Checkbox1">
<input type="hidden" name="user" value=""/> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-10T23:19:00.413

我可能会遍历 document.checks.elements，寻找 .type == 'checkbox'。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-02-10T23:12:22.160

jQuery 是你的朋友：

```
$("input[type='checkbox']").attr('checked', false); 
```

（...如果您可以使用 jQuery？）

# ruby-on-rails - Rails ActiveRecord：计算关联的关联

> ID：534658
> 
> 赞同：0
> 
> 时间：2009-02-10T23:02:04.917
> 
> 标签：ruby-on-rails, activerecord

我正在尝试编写一个 ActiveRecord 查找查询但没有成功。请帮忙！

我的项目的这个功能是一种类似于 Digg 功能的博客：每个注册用户都可以在博客文章本身或其任何回复中添加星标。

所以这里是相关的模型类：

*   博客帖子（有多个回复）
*   回复（belongs_to 博客文章）
*   加星标（这表示一个用户加星标一个 BlogPost 或回复的操作；它有一个到 BlogPost 和回复的多态接口，在内部将它们称为 :starrables，充满 :starrable_id 和 :starrable_type 字段）

因此，我要做的是在 blog_post.rb 中编写一个方法，该方法将返回 BlogPost 对象及其所有回复类的星标总数。也就是说，如果一篇博文有 10 颗星，并且它有两条回复，每条有 5 颗星，它应该返回 20。

如何在不进行数百万数据库事务的情况下编写此查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T00:09:30.760

我建议用 SQL 来做。您可以通过多种方式进行操作。你在使用 MYSQL 吗？如果您想处理 2 个查询，然后将数字相加，您可以在 SQL 中执行以下操作：

`select count(starrings.id) from starrings where starrable_type='BlogPost' and starrable_id=#{blogpost.id}`

和

`select count(starrings.id) from starrings join replies on starrings.starrable_type='Reply' and starrable_id=replies.id and replies.blog_post_id=#{blogpost.id}`

注意：我没有测试此 SQL，可能拼写错误或打错字。

您可以使用 'Starring.count_by_sql(your sql here)' 运行 SQL 计数，然后将 2 个数字相加。您可能可以通过联合将其简化为 1 个 SQL 语句，但我不会打扰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T23:27:21.440

假设您`stars`在 BlogPost 和 Reply 上都有一个多态方法，该方法返回`Starring`每个对象的对象（您可能没有，但对我来说应该这样做是有意义的）然后在 blog_post.rb 中您可以执行以下操作：

```
def total_number_of_stars
  stars.size + replies.inject(0) { |s,v| s.stars.size += v.stars.size }
end 
```

诚然，这将在幕后进行相当多的查询，但这就是 Rails 的工作方式。如果它的性能不够好，您可以将 find_by_sql 与定制 SQL 一起使用。

# c# - 通过 .NET 的文件权限对话框

> ID：534664
> 
> 赞同：0
> 
> 时间：2009-02-10T23:02:31.840
> 
> 标签：c#, .net, security, interop

如何从 .NET 应用程序启动标准文件权限对话框？似乎在任何地方都找不到任何这样的例子。我不想以编程方式设置文件权限，我想让用户通过对话框设置它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T01:40:40.247

在这里找到了答案：

[http://www.pluralsight.com/community/blogs/keith/archive/2004/10/04/2636.aspx](http://www.pluralsight.com/community/blogs/keith/archive/2004/10/04/2636.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T23:16:14.617

我认为 Winforms 中没有包装该对话框的包装器，尽管创建自己的对话框很简单，但您需要从 FileInfo 类调用 SetAccessControl 方法，这里有一个示例

[http://msdn.microsoft.com/en-us/library/system.io.fileinfo.setaccesscontrol.aspx](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.setaccesscontrol.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T01:46:02.167

还有另一种更简单的方法：

BOOL SHObjectProperties(HWND hwndOwner, DWORD dwType, LPCWSTR szObject, LPCWSTR szPage);

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T00:34:52.603

Shell API (IShellFolder) 可能是执行此操作的一种方法，如果您可以找出哪个动词将打开文件的安全对话框。我只是尝试编写一个脚本来列出文件中可用的动词，而我能看到的最接近的东西是“属性”，它会显示所有属性页，而不仅仅是安全性。同样，当我尝试调用动词时，什么也没有发生。所以我承认，答案并不多，但也许这将是一个起点。

# mysql - 低成本在线 SQL 或 mySQL 培训？

> ID：534666
> 
> 赞同：0
> 
> 时间：2009-02-10T23:02:44.900
> 
> 标签：mysql, sql

我是一名介于咨询工作之间的 Lotus Domino 程序员——不是选择咨询工作市场现在真的很糟糕。

有一些额外的时间，我想接受一些 SQL 培训作为简历助推器并扩展我的技能。

SQL 是我过去使用过的东西，但我需要一种方法来在我的简历中记录我的知识。

任何人都可以推荐低成本 SQL 或 mySQL 培训的来源吗？

德里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T23:33:30.660

如果您真的在寻找便宜的方法，我所在地区的社区学院提供整个学期的 MSSQL（考试 70-431 大纲）课程。典型的班级将有 4 个单元（在加利福尼亚，社区学院收费 20 美元/单元）。大多数这些课程都是在线的，因此在日程安排方面具有灵活性和便利性。

你可以参加为期 4 天的训练营，但通常每节课要花费 2-3000 美元。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-13T13:37:04.233

我认为您可以获得的最低成本培训就是从您的图书馆或亚马逊（以下链接）阅读书籍并在家练习。熟能生巧！

有：

[学习 MySQL](https://rads.stackoverflow.com/amzn/click/com/0596008643)

[MySQL 5.0 认证学习指南](https://rads.stackoverflow.com/amzn/click/com/0672328127)

[MySQL 简介 (In a Nutshell (O'Reilly))](https://rads.stackoverflow.com/amzn/click/com/0596514336)

# iscsi - 有人在生产中使用 OpenFiler 吗？

> ID：534667
> 
> 赞同：0
> 
> 时间：2009-02-10T23:02:48.860
> 
> 标签：iscsi

是否有人在生产中（尤其是在托管环境中）使用 OpenFiler ( [http://openfiler.com/](http://openfiler.com/) ) 作为 iSCSI 目标？

如果是，那么硬件配置是什么，使用过程中出现了什么问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-12T20:23:14.390

尚未投入生产，但正在为此做好准备。到目前为止，我的经验是，只要用于公开 iSCSI lun 就可以了。到目前为止对我来说效果很好。我正在测试模式下运行它，但计划在带有 1 个带有 24 个驱动器的 PowerVault MD1120 的 poweredge 2950 上运行，这将允许我在单个盒子中最多运行 144 个驱动器。

# visual-studio - 将 OpenGL 项目从 Visual Studio 移植到 Xcode

> ID：534669
> 
> 赞同：1
> 
> 时间：2009-02-10T23:03:53.523
> 
> 标签：visual-studio, xcode, opengl, opengl-es

我正在将 Visual Studio OpenGL 项目转换/迁移到 Xcode (iPhone) OpenGL 项目。

您有什么经验或建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T23:14:24.713

您需要了解 OpenGL ES 1.1 的限制以及 iPhone 中硬件的性能，即不能使用 glBegin/glEnd，因此所有顶点数据都必须作为数组传递，而 GLU 的东西丢失了。有关一些性能统计数据，请参见[此处](http://tinyurl.com/4a3jqb)。

如果您的 OpenGL 代码相当简单，Apple 提供了一个很好的模板来使用它。我创建了一个[截屏视频](http://blip.tv/file/1600554/)，在其中演示了一个 AC3D 库，15 秒后我从一个干净的 Xcode OpenGL ES 项目开始。

# c# - 限制控制器返回的数据

> ID：534670
> 
> 赞同：0
> 
> 时间：2009-02-10T23:04:15.160
> 
> 标签：c#, asp.net-mvc, serialization, interface

我需要有关如何从 MVC 控制器返回一组有限数据的建议。

可以说我有一个这样构造的类：

```
public interface ICustomerExpose
{
   string Name {get; set;}
   string State {get; set;}
}

public interface ICustomer: ICustomerExpose
{
   int Id {get; set;}
   string SSN {get; set;}
}

public class Customer: ICustomer
{
   ...
} 
```

在我的 MVC 项目中，我有一个返回客户数据的控制器操作。该项目实际上更像是一个 Web 服务，因为没有与数据关联的视图……我们使用 XmlResult（由[MVCContrib](http://www.codeplex.com/MVCContrib)项目提供）。控制器动作如下所示：

```
 // GET: /Customer/Show/5
    public ActionResult Show(int id)
    {
        Customer customer = Customer.Load(id);

        ...  // some validation work

        return new XmlResult((ICustomerExpose)customer);
    } 
```

上面的控制器代码不像我想要的那样工作。我想要发生的是只有 Name 和 State 属性被序列化并在 XmlResult 中返回。在实践中，整个客户对象都被序列化了，包括我绝对不想暴露的数据。

我知道这不起作用的原因：您无法序列化接口。

办公室里出现的一个想法是简单地将属性 Name 和 State 标记为 [XmlIgnore]。但是，这对我来说似乎不是一个好的解决方案。可能在其他情况下，我想序列化这些属性并以这种方式在类上标记属性禁止我。

实现仅序列化 ICustomerExpose 接口中的属性的目标的最佳方法是什么？

附录：

对于那些对 XmlResult 的作用感兴趣的人来说，这里是它的相关部分：

```
 public class XmlResult : ActionResult
 {
     private object _objectToSerialize;
     public XmlResult(object objectToSerialize)
     {
        _objectToSerialize = objectToSerialize;
     }

     /// <summary>
     /// Serialises the object that was passed into the constructor 
     /// to XML and writes the corresponding XML to the result stream.
     /// </summary>
     public override void ExecuteResult(ControllerContext context)
     {
         if (_objectToSerialize != null)
         {
            var xs = new XmlSerializer(_objectToSerialize.GetType());
            context.HttpContext.Response.ContentType = "text/xml";
            xs.Serialize(context.HttpContext.Response.Output, _objectToSerialize);
         }
     }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-10T23:32:51.253

你可以试试这个，但我不确定它是否适用于 xml 序列化程序：

```
return new XmlResult(new { customer.Name, customer.State }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T23:33:22.407

请参阅建议使用匿名类型的[相关问题。](https://stackoverflow.com/questions/372955/best-way-to-filter-domain-objects-for-json-output-in-an-asp-net-mvc-application)

```
// GET: /Customer/Show/5
public ActionResult Show(int id)
{
    Customer customer = Customer.Load(id);

    ...  // some validation work

    var result = from c in cusomter
                 select new
                 {
                     Name = c.Name,
                     State = c.State,
                 };

    // or just

    var result = new
                 {
                     Name = customer.Name,
                     State = customer.State,
                 };

    return new XmlResult(result);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T06:16:02.613

考虑使用 VB9 中的 XML 文字而不是序列化来解决这一问题。严重地。只需给它 20 分钟的时间。有很多选择。

[http://www.hanselman.com/blog/TheWeeklySourceCode30VBNETWithXMLLiteralsAsAViewEngineForASPNETMVC.aspx](http://www.hanselman.com/blog/TheWeeklySourceCode30VBNETWithXMLLiteralsAsAViewEngineForASPNETMVC.aspx)

[http://www.hanselman.com/blog/XLINQToXMLSupportInVB9.aspx](http://www.hanselman.com/blog/XLINQToXMLSupportInVB9.aspx)

[http://blogs.msdn.com/dmitryr/archive/2008/12/29/asp-net-mvc-view-engine-using-vb-net-xml-literals.aspx](http://blogs.msdn.com/dmitryr/archive/2008/12/29/asp-net-mvc-view-engine-using-vb-net-xml-literals.aspx)

[http://haacked.com/archive/2008/12/29/interesting-use-of-xml-literals-as-a-view-engine.aspx](http://haacked.com/archive/2008/12/29/interesting-use-of-xml-literals-as-a-view-engine.aspx)

[http://www.infoq.com/news/2009/02/MVC-VB](http://www.infoq.com/news/2009/02/MVC-VB)

对于您正在做的事情，将 XML 作为穷人的 Web 服务返回，这是量身定制的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T14:17:01.903

我最终只是按照同事的建议做了 XmlIgnore，尽管这给我留下了一些不受欢迎的（或者我认为是这样的）行为。

To get around the fact that XmlIgnore would continue hiding properties that I might want serialized later I [asked another question](https://stackoverflow.com/questions/592671/overriding-a-property-with-an-attribute/593084#593084) trying to find a way to around that issue. Cheeso came up with a great answer making the XmlIgnore the best route (in my opinion) to take.

# javascript - 我可以让 Visual Studio 2008 中的 C# 代码编辑器显示行分隔方法吗？

> ID：534675
> 
> 赞同：8
> 
> 时间：2009-02-10T23:05:48.760
> 
> 标签：javascript, c#, visual-studio, visual-studio-2008, ide

对不起这个愚蠢的问题，但是......

我正在从 VB 迁移到 C#，这真的让我很烦恼。有没有办法说服 VS 2008 像 VB 那样画一条线来分隔我的方法？

我真的习惯了那些，我习惯了

//------------------------------------------------ --------

我自己在 Javascript 中。

我希望我也不必在 C# 中手动执行此操作。

任何指针？
谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T23:12:54.483

不是开箱即用。可能有第三方应用程序会这样做，例如 CodeRush 或类似的东西。

但我的建议是：改掉在程序之间划线的习惯。没有意义的评论是邪恶的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-01T16:06:03.483

您可以免费执行此操作（假设您使用的是 Visual Studio 2008 标准版或更高版本）。

安装免费的[CodeRush Xpress](http://msdn.microsoft.com/en-us/vcsharp/dd218053.aspx)。然后安装免费插件[DrawLinesBetweenMethods](http://code.google.com/p/dxcorecommunityplugins/wiki/DrawLinesBetweenMethods)

将 DLL 复制到此位置 - C:\Program Files\Developer Express Inc\DXCore for Visual Studio .NET\2.0\Bin\Plugins。

这将产生此处描述的效果：[C# 编辑器中的方法之间的行（CodeRush/DxCore 插件）](http://blog.dotsmart.net/2008/05/02/lines-between-methods-in-the-c-editor-coderushdxcore-plugin/)

如果您不想要 CodeRush Xpress，那么另一种方法是安装免费的[DXCore](http://devexpress.com/Downloads/Visual_Studio_Add-in/DXCore/)扩展引擎，然后安装上述插件。如果您安装 DXCore，您还可以使用许多其他有用的插件，其中大部分都可以在与 DrawLinesBetweenMethods 相同的站点上找到。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T23:16:56.283

为什么不向方法添加真正的**摘要注释**？任何数量的工具都可以从中创建某种形式的文档。

IDE 也可以折叠该方法，因此不确定该行的增益。#**个地区**不是更有趣吗？（反问）

**VS10**将允许您内联 WPF，因此如果您可以等待，您甚至可以在两种方法之间绘制日落！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T23:14:27.180

[Devexpress.com](http://devexpress.com/)制作了 CodeRush，它有一些可视化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T23:22:37.720

或使用#region 分隔任何代码区域。例如，我将覆盖、方法、属性、事件和对象分开，但您可以将方法包装在#region 中以清楚地分开每一个（并在不使用时折叠它们。）

这不是您要求的，但它是一个很好的选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T23:50:10.447

不完全是您要查找的内容，但是使用 Resharper 可以设置一个自定义类型成员模板，该模板将在您按下快捷方式时将文件/项目/解决方案中的每个方法都围绕一个区域。

您的另一个 Resharper 选项是创建一个自定义环绕模板，它可以让您选择一个文本块并选择环绕 ->YourCustomSurround 将您的评论块放在顶部。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-10T23:28:21.577

由于可扩展的、基于 WPF 的文本编辑器，这在 Visual Studio 2010 中应该很容易实现。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-03-07T11:54:45.033

关于[您的评论](https://stackoverflow.com/questions/534675/can-i-have-the-code-editor-for-c-in-visual-studio-2008-show-a-line-separating-me/534715#534715)的说明：

> 分隔符 [...] 让我可以快速浏览代码。[...] 我可以很快跳到下一个 [方法]。

我经常看到的是，人们忘记了编辑器窗口顶部的两个下拉列表（列出当前文件的类和当前类的类成员）。它允许非常快速地导航到班级成员。

# search - 在浏览器中进行实时 xpath 搜索

> ID：534681
> 
> 赞同：6
> 
> 时间：2009-02-10T23:07:39.583
> 
> 标签：search, xpath, plugins

是否有工具或浏览器插件（不确定 Firebug 是否可以这样做）可以让您打开网页，然后使用工具/插件使用 xpath 查询进行搜索，它会突出显示屏幕上与您的查询匹配的内容?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-10T23:17:16.940

Firebug 和 Chrome Web Inspector 提供了`$x()`方便的功能，它将 xpath 查询的结果转储到控制台（可以将它们悬停在控制台上以突出显示）。虽然不是你想要的。

然后是[XPather](https://addons.mozilla.org/en-US/firefox/addon/1192)，它可以做更多的事情。

# c# - 返回匿名类型结果？

> ID：534690
> 
> 赞同：204
> 
> 时间：2009-02-10T23:10:44.317
> 
> 标签：c#, linq, linq-to-sql

使用下面的简单示例，使用 Linq to SQL 从多个表返回结果的最佳方法是什么？

假设我有两张桌子：

```
Dogs:   Name, Age, BreedId
Breeds: BreedId, BreedName 
```

我想把所有的狗和他们的`BreedName`. 我应该让所有狗都使用这样的东西没有问题：

```
public IQueryable<Dog> GetDogs()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select d;
    return result;
} 
```

但是如果我想要有品种的狗并尝试这个我有问题：

```
public IQueryable<Dog> GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select new
                        {
                            Name = d.Name,
                            BreedName = b.BreedName
                        };
    return result;
} 
```

现在我意识到编译器不会让我返回一组匿名类型，因为它需要 Dogs，但是有没有办法在不必创建自定义类型的情况下返回它？还是我必须创建自己的类`DogsWithBreedNames`并在选择中指定该类型？或者还有其他更简单的方法吗？

* * *

## 回答 #1

> 赞同：222
> 
> 时间：2009-02-10T23:35:56.317

我倾向于这种模式：

```
public class DogWithBreed
{
    public Dog Dog { get; set; }
    public string BreedName  { get; set; }
}

public IQueryable<DogWithBreed> GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select new DogWithBreed()
                        {
                            Dog = d,
                            BreedName = b.BreedName
                        };
    return result;
} 
```

这意味着您有一个额外的类，但它可以快速且易于编码、易于扩展、可重用且类型安全。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-02-10T23:15:08.083

你*可以*返回匿名类型，[但它真的不漂亮](http://codeblog.jonskeet.uk/2009/01/09/horrible-grotty-hack-returning-an-anonymous-type-instance)。

在这种情况下，我认为创建适当的类型会好得多。如果它只在包含该方法的类型中使用，请将其设为嵌套类型。

就我个人而言，我希望 C# 获得“命名匿名类型”——即与匿名类型相同的行为，但具有名称和属性声明，仅此而已。

编辑：其他人建议返回狗，然后通过属性路径等访问品种名称。这是一种完全合理的方法，但 IME 会导致您因为想要的数据而以特定方式进行查询的情况使用 - 当您返回时，元信息会丢失`IEnumerable<Dog>`- 查询可能*期望*您使用（比如说）`Breed`而不是`Owner`由于某些加载选项等，但是如果您忘记了这一点并开始使用其他属性，您的应用程序可能会工作但没有你最初设想的那么有效。当然，我可能是在胡说八道，或者过度优化等等……

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-01-07T11:20:35.193

只是为了增加我两美分的价值 :-) 我最近学会了一种处理匿名对象的方法。它只能在针对 .NET 4 框架时使用，并且只能在添加对 System.Web.dll 的引用时使用，但它非常简单：

```
...
using System.Web.Routing;
...

class Program
{
    static void Main(string[] args)
    {

        object anonymous = CallMethodThatReturnsObjectOfAnonymousType();
        //WHAT DO I DO WITH THIS?
        //I know! I'll use a RouteValueDictionary from System.Web.dll
        RouteValueDictionary rvd = new RouteValueDictionary(anonymous);
        Console.WriteLine("Hello, my name is {0} and I am a {1}", rvd["Name"], rvd["Occupation"]);
    }

    private static object CallMethodThatReturnsObjectOfAnonymousType()
    {
        return new { Id = 1, Name = "Peter Perhac", Occupation = "Software Developer" };
    }
} 
```

为了能够添加对 System.Web.dll 的引用，您必须遵循[rushonerok 的建议](https://stackoverflow.com/questions/2146256/httputility-urlencode-in-console-application/2675248#2675248)：确保您的 [项目] 目标框架是“.NET Framework 4”而不是“.NET Framework 4 Client Profile”。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-03-29T07:29:25.127

在 C# 7 中，您现在可以使用元组！... 这消除了创建类来返回结果的需要。

这是一个示例代码：

```
public List<(string Name, string BreedName)> GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
             join b in db.Breeds on d.BreedId equals b.BreedId
             select new
             {
                Name = d.Name,
                BreedName = b.BreedName
             }.ToList();

    return result.Select(r => (r.Name, r.BreedName)).ToList();
} 
```

您可能需要安装 System.ValueTuple nuget 包。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-10-13T20:03:54.240

你可以这样做：

```
 public System.Collections.IEnumerable GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select new
                        {
                            Name = d.Name,
                            BreedName = b.BreedName
                        };
    return result.ToList();
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-10T23:27:51.500

不，您不能在不经过一些技巧的情况下返回匿名类型。

如果您不使用 C#，您将要查找的内容（返回多个没有具体类型的数据）称为元组。

有很多 C# 元组实现，使用[此处显示](http://www.ugmfree.it/TipsCSharp.aspx)的一个，您的代码将像这样工作。

```
public IEnumerable<Tuple<Dog,Breed>> GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select new Tuple<Dog,Breed>(d, b);

    return result;
} 
```

在调用站点上：

```
void main() {
    IEnumerable<Tuple<Dog,Breed>> dogs = GetDogsWithBreedNames();
    foreach(Tuple<Dog,Breed> tdog in dogs)
    {
        Console.WriteLine("Dog {0} {1}", tdog.param1.Name, tdog.param2.BreedName);
    }
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-04-13T09:02:47.540

您必须首先使用`ToList()`方法从数据库中获取行，然后选择项目作为一个类。试试这个：

```
public partial class Dog {
    public string BreedName  { get; set; }}

List<Dog> GetDogsWithBreedNames(){
    var db = new DogDataContext(ConnectString);
    var result = (from d in db.Dogs
                  join b in db.Breeds on d.BreedId equals b.BreedId
                  select new
                  {
                      Name = d.Name,
                      BreedName = b.BreedName
                  }).ToList()
                    .Select(x=> 
                          new Dog{
                              Name = x.Name,
                              BreedName = x.BreedName,
                          }).ToList();
return result;} 
```

所以，诀窍是**第一`ToList()`**。它立即进行查询并从数据库中获取数据。第二个技巧是**选择项目并使用对象初始化器**生成加载项目的新对象。

希望这可以帮助。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-04-09T16:38:09.750

*现在我意识到编译器不会让我返回一组匿名类型，因为它需要 Dogs，但是有没有办法在不必创建自定义类型的情况下返回它？*

使用 use**对象**返回匿名类型的列表，而无需创建自定义类型。这将在没有编译器错误的情况下工作（在 .net 4.0 中）。我将列表返回给客户端，然后在 JavaScript 上对其进行解析：

```
public object GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select new
                        {
                            Name = d.Name,
                            BreedName = b.BreedName
                        };
    return result;
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-10T23:28:50.123

只需选择狗，然后使用`dog.Breed.BreedName`，这应该可以正常工作。

如果您有很多狗，请使用 DataLoadOptions.LoadWith 来减少 db 调用次数。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-07-24T20:58:31.140

您不能直接返回匿名类型，但可以通过泛型方法循环它们。大多数 LINQ 扩展方法也是如此。那里没有魔法，虽然看起来它们会返回匿名类型。如果参数是匿名的，结果也可以是匿名的。

```
var result = Repeat(new { Name = "Foo Bar", Age = 100 }, 10);

private static IEnumerable<TResult> Repeat<TResult>(TResult element, int count)
{
    for(int i=0; i<count; i++)
    {
        yield return element;
    }
} 
```

下面是一个基于原始问题代码的示例：

```
var result = GetDogsWithBreedNames((Name, BreedName) => new {Name, BreedName });

public static IQueryable<TResult> GetDogsWithBreedNames<TResult>(Func<object, object, TResult> creator)
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                    join b in db.Breeds on d.BreedId equals b.BreedId
                    select creator(d.Name, b.BreedName);
    return result;
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-05-15T14:29:10.430

这并不能完全回答你的问题，但谷歌根据关键词把我带到了这里。这是您可以从列表中查询匿名类型的方式：

```
var anon = model.MyType.Select(x => new { x.Item1, x.Item2}); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-11-22T15:04:41.657

试试这个来获取动态数据。您可以转换 List<> 的代码

```
public object GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    var result = from d in db.Dogs
                 join b in db.Breeds on d.BreedId equals b.BreedId
                 select new
                        {
                            Name = d.Name,
                            BreedName = b.BreedName
                        };
    return result.FirstOrDefault();
}

dynamic dogInfo=GetDogsWithBreedNames();
var name = dogInfo.GetType().GetProperty("Name").GetValue(dogInfo, null);
var breedName = dogInfo.GetType().GetProperty("BreedName").GetValue(dogInfo, null); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T23:14:49.050

好吧，如果你要归还 Dogs，你会这样做：

```
public IQueryable<Dog> GetDogsWithBreedNames()
{
    var db = new DogDataContext(ConnectString);
    return from d in db.Dogs
           join b in db.Breeds on d.BreedId equals b.BreedId
           select d;
} 
```

如果您想要 Breed 急切加载而不是延迟加载，只需使用适当的[DataLoadOptions](http://geekswithblogs.net/AzamSharp/archive/2008/03/29/120847.aspx)构造。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-10T23:34:07.927

如果您的数据库中有一个关系设置，并且对 BreedId 有外键限制，您还没有得到它吗？

[![DBML 关系映射](https://i.stack.imgur.com/UcEWk.png)](https://i.stack.imgur.com/UcEWk.png)

所以我现在可以打电话：

```
internal Album GetAlbum(int albumId)
{
    return Albums.SingleOrDefault(a => a.AlbumID == albumId);
} 
```

在调用它的代码中：

```
var album = GetAlbum(1);

foreach (Photo photo in album.Photos)
{
    [...]
} 
```

因此，在您的实例中，您将调用类似 dog.Breed.BreedName 的东西 - 正如我所说，这取决于您的数据库设置了这些关系。

正如其他人所提到的，如果这是一个问题，DataLoadOptions 将有助于减少数据库调用。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-12-03T23:34:20.300

`BreedId`在`Dog`表中显然是表中相应行的外键`Breed`。如果您的数据库设置正确，LINQ to SQL 应该会自动在两个表之间创建关联。生成的 Dog 类将具有 Breed 属性，并且 Breed 类应该具有 Dogs 集合。以这种方式设置，您仍然可以返回`IEnumerable<Dog>`，这是一个包含品种属性的对象。唯一需要注意的是，您需要在查询中预加载品种对象和狗对象，以便在处理数据上下文后可以访问它们，并且（正如另一位发帖人建议的那样）在集合上执行一个方法，这将导致要立即执行的查询（在本例中为 ToArray）：

```
public IEnumerable<Dog> GetDogs()
{
    using (var db = new DogDataContext(ConnectString))
    {
        db.LoadOptions.LoadWith<Dog>(i => i.Breed);
        return db.Dogs.ToArray();
    }

} 
```

然后为每只狗获取品种是微不足道的：

```
foreach (var dog in GetDogs())
{
    Console.WriteLine("Dog's Name: {0}", dog.Name);
    Console.WriteLine("Dog's Breed: {0}", dog.Breed.Name);        
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-06-04T17:23:51.337

如果主要思想是使发送到数据库服务器的 SQL 选择语句只有必需的字段，而不是所有的实体字段，那么你可以这样做：

```
public class Class1
{
    public IList<Car> getCarsByProjectionOnSmallNumberOfProperties()
    {

        try
        {
            //Get the SQL Context:
            CompanyPossessionsDAL.POCOContext.CompanyPossessionsContext dbContext 
                = new CompanyPossessionsDAL.POCOContext.CompanyPossessionsContext();

            //Specify the Context of your main entity e.g. Car:
            var oDBQuery = dbContext.Set<Car>();

            //Project on some of its fields, so the created select statment that is
            // sent to the database server, will have only the required fields By making a new anonymouse type
            var queryProjectedOnSmallSetOfProperties 
                = from x in oDBQuery
                    select new
                    {
                        x.carNo,
                        x.eName,
                        x.aName
                    };

            //Convert the anonymouse type back to the main entity e.g. Car
            var queryConvertAnonymousToOriginal 
                = from x in queryProjectedOnSmallSetOfProperties
                    select new Car
                    {
                        carNo = x.carNo,
                        eName = x.eName,
                        aName = x.aName
                    };

            //return the IList<Car> that is wanted
            var lst = queryConvertAnonymousToOriginal.ToList();
            return lst;

        }
        catch (Exception ex)
        {
            System.Diagnostics.Debug.WriteLine(ex.ToString());
            throw;
        }
    }
} 
```

# django - 我可以拥有一个对其自身具有外键引用的 Django 模型吗？

> ID：534700
> 
> 赞同：59
> 
> 时间：2009-02-10T23:12:48.090
> 
> 标签：django, django-models

好的，我该怎么做？

```
class Example(models.Model):
  parent_example = models.ForeignKey(Example) 
```

我想让一个模型有一个对其自身的外键引用。当我尝试创建它时，我得到一个 django 验证错误，示例尚未定义。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-02-10T23:19:14.063

你应该使用

```
models.ForeignKey('self') 
```

[正如这里](http://docs.djangoproject.com/en/dev/ref/models/fields/#foreignkey)提到的。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-02-10T23:17:55.300

是的，只需这样做：

```
class Example(models.Model):
  parent_example = models.ForeignKey('self') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-31T18:13:11.900

您也可以使用引号来执行此操作：

```
class Example(models.Model):
    parent_example = models.ForeignKey('Example') 
```

# apache-flex - 是否可以在运行时使用 Flash 或 FMS 对音频流进行下采样？

> ID：534703
> 
> 赞同：0
> 
> 时间：2009-02-10T23:13:38.227
> 
> 标签：apache-flex, flash, actionscript, audio, streaming

我不是音频方面的专家，所以如果你们中有任何人是，我会很感激你对此的见解。

我的客户有一些以相对较高的比特率存储的 MP3 播客，我希望能够根据用户的凭据以“不同”的比特率向她的用户提供这些文件。（例如，如果您是经过身份验证的用户，您可能会获得完整的、未更改的流，但如果您不是，您将获得较低比特率的版本——或者至少是故意调整的较低质量的比原来的版本。）

似乎有两种选择：在源处下采样和在客户端下采样。在这种情况下，当然知道源流将以高比特率到达客户端（并且对此有一些考虑，我意识到），我宁愿以某种方式改变客户端的流，而不是在服务器上，有几个原因。

在运行时（甚至使用第三方库）单独使用 Flash Player 和 ActionScript 是否可以做到这一点，或者像这样的场景是否需要基于服务器的解决方案？如果是后者，Flash Media Server 可以专门处理这个需求吗？同样，如果可以，我想避免使用 FMS，因为她并没有真正的预算，但如果这是唯一的选择*，而且确实是一个选择*，我愿意考虑。

提前致谢...

* * *

注意：请不要质疑请求的合理性——我意识到这听起来可能有点奇怪，但要求就是这样。鉴于此，为了回答问题，您可以忽略比特的来源和传递路径；我真正想要的是解释 Flash 客户端是否（以及如何）可以在运行时对 MP3 音频流进行下采样，而不管音频是通过网络连接到达还是直接从磁盘读取。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-11T01:48:19.323

> 出于几个原因，我宁愿以某种方式在客户端而不是在服务器上更改流。

请说明原因，因为在客户端重新采样通常被认为是疯狂的：浪费带宽将更高质量的版本发送给听不见的用户，并冒着让精明的用户翻录更高质量的流的风险。网络。

在任何情况下，Flash Player 都不会为您提供处理音频的工具，只能播放它。

您不需要 FMS 在服务器端处理音频。您可以有一个服务器端脚本来加载新上传的播客并将它们保存为低比特率文件，这些文件可以通过普通的 Web 服务器提供给低端用户。对于 Python，请参见例如。PyMedia，py-lame；甚至使用 lame 或 ffmpeg 或命令行中的其他东西的 shell 脚本应该很容易实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-02T10:26:42.793

如果存储非常宝贵，您是否研究过 AAC 音频？我相信桌面浏览器上的 Flash 9 和 10 会播放它。以我的经验，AAC 只占用同等 MP3 的一半大小（即 80kbps AAC 听起来与 160kbps MP3 相同）。

至于播放质量，如果我没记错的话，Flash 编辑器的“发布设置”部分中有音频播放设置。我不确定是否可以在运行时更改播放比特率。

# cocoa-touch - iPhone 模拟器 - 设置 HTTP 代理

> ID：534704
> 
> 赞同：19
> 
> 时间：2009-02-10T23:14:08.287
> 
> 标签：cocoa-touch, ios-simulator

我正在编写一个需要向 Internet 发出小型 HTTP 请求的 iPhone 应用程序。在我们公司的 LAN 中，所有 HTTP 流量都必须通过 Squid。

模拟器显然能够使用代理——因为 Mobile Safari 可以工作。但是，如何在代码中获取/设置代理设置？

为模拟器注释了一堆标题。例如，

```
CFNetworkCopySystemProxySettings 
```

在 CFProxySupport.h 中对模拟器不可用 - 仅对设备可用。我试过这样的硬编码：

```
CFReadStreamSetProperty(stream, kCFProxyHostNameKey, @"internal.proxy.servername");
CFReadStreamSetProperty(stream, kCFProxyPortNumberKey, [NSNumber numberWithInt:80]);
CFReadStreamSetProperty(stream, kCFProxyTypeKey, kCFProxyTypeHTTP); 
```

但没有喜悦。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-23T05:31:32.117

您可以尝试：
“系统偏好设置”->“网络”->选择您的网络设备->“高级”->“代理”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-18T04:39:32.147

您可以尝试使用 Proxifier： http: [//www.proxifier.com/mac/](http://www.proxifier.com/mac/) 它使您可以为任何程序设置代理。

不是你问的，但它应该可以解决你的问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-11-23T23:00:08.343

要关闭它。看起来这在 iOS4 SDK 中已修复 - 模拟器上的网络堆栈将使用 Mac 的代理进行任何 HTTP 调用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-14T18:35:45.287

看起来 XCode 4.0 (4A304a) 再次打破了这一点。如果我将堆栈设置为通过 Burp 代理 http 调用，那么除了模拟器之外的每个应用程序（Safari 等）都可以正常工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-12T12:27:04.823

只需重新启动 iPhone 模拟器。

为此，我使用以下技巧

转到设置>>常规>>辅助功能>>粗体文本打开>>选择器视图打开并要求重新启动以使其生效>>按继续>> iPhone模拟器现在重新启动

弹出窗口询问代理的用户名和密码...

# 在 ios 模拟器 7.1 中测试

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-15T18:55:05.973

这个问题有点老了，但我想我会添加我的发现以供参考。至少在 iOS 4.x SDK 中，以下代码可在模拟器和 iPhone 上运行。

```
CFDictionaryRef systemProxyDict = CFNetworkCopySystemProxySettings();
CFReadStreamSetProperty(m_resultRef, kCFStreamPropertyHTTPProxy, systemProxyDict); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-21T21:28:41.633

模拟器可能无法使用代理。它使用 Mac OS X 提供的标准网络堆栈，*这*就是使用代理的方式。

如果在模拟器使用期间常量被注释掉，并且您尝试对其进行硬编码但没有运气，那么这可能是模拟器和设备之间根本不一样的众多事情之一，您将拥有在设备上测试应用程序的这一部分。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-04-14T11:46:15.650

应用配置后关闭并重新打开模拟器。

# java - 在 Java 中捕获异常

> ID：534718
> 
> 赞同：4
> 
> 时间：2009-02-10T23:17:36.407
> 
> 标签：java, exception, exception-handling, catch-block

Java中有某些预定义的异常，如果抛出这些异常，则报告发生了严重的事情，您最好改进您的代码，而不是在catch块中捕获它们（如果我理解正确的话）。但是我仍然发现许多程序中有以下内容：

```
} catch (IOException e) {
     ...
} catch (FileNotFoundException e) {
     ....
} 
```

我认为 IOException 和 FileNotFoundException 正是这种异常，我们不应该在 catch 块中捕获它们。人们为什么这样做？像这样抓住他们会更好吗？无论如何，Java 编译器都会警告任何此类问题。

谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-10T23:19:35.280

`IOException`不，捕捉和`FileNotFoundException`- 如果你能真正*处理*这些异常并没有错。这是重要的一点——面对那个例外，你真的能继续吗？有时你可以——通常是在服务器的顶层，例如，仅仅因为一个请求失败并不意味着下一个请求不能继续。在客户端应用程序中不太常见，尽管这在很大程度上取决于情况。尝试批量导入时无法读取文件？好的，中止操作，但不一定要关闭整个过程...

诚然，你不应该这样使用它们——它`FileNotFoundException`会被`IOException`它的来源所掩盖。幸运的是，编译器完全阻止您这样做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-10T23:30:01.183

你显示的顺序，`IOException`之前被抓住`FileNotFoundException`是错误的。由于`FileNotFoundException`extends `IOException`，当 a`FileNotFoundException`被抛出时，将使用第一个处理程序，第二个处理程序是死代码。

我还没有尝试过，但是如果编译成功，我会感到有些惊讶。我希望像 FindBugs 这样的静态分析工具会捕捉到这个错误。

至于你是否*应该*抓住 a `FileNotFoundException`，这取决于调用者。但是，我会说 a`FileNotFoundException`通常可以通过一种有意义的方式来恢复——提示另一个文件，尝试回退位置——而不是简单地记录错误或中止进程。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-10T23:32:34.810

Java中有两种异常，检查异常和未检查异常。

已检查的异常必须在 catch 块中处理。不这样做会导致编译器错误。IOException 是已检查异常的示例，必须进行处理。您在此处实际执行的操作取决于相关应用程序，但必须处理异常以使编译器满意。

未经检查的异常不需要被捕获。从 RuntimeException 扩展的所有类都未选中。NullPointerException 或 ArrayIndexOutOfBoundsException 就是一个很好的例子。编译器不会强制您捕获这些异常，但它们可能在您的程序运行时仍然发生，导致程序崩溃。

作为记录，IOException 可以被抛出，比如试图打开一个不存在的文件。处理这样的事情并优雅地恢复是一个好主意（向用户发出对话框说文件不存在并重新出现打开的文件对话框或其他东西），而不是让程序崩溃。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-10T23:20:32.797

这样做是为了以不同的方式处理不同类型的异常。通常，您会希望首先捕获最精细的异常，如果您将更广泛的异常放在 catch 块的开头，您将首先执行该代码，然后点击 finally 块。

Jon 是对的，捕获 IOException 的 catch 将捕获所有 IOExceptions 和 IOException 的任何子类型，并且由于 FileNotFoundException 是 IOException 的一种类型，它永远不会遇到第二个 catch。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T23:51:15.640

正如[Jon 所说](https://stackoverflow.com/questions/534718/catching-exceptions-in-java/534730#534730)，在许多情况下捕获这些异常是可以的。您不应该捕获的异常类型是 NullPointerException 和 ArrayIndexOutOfBoundsException，它们表明您的代码中存在错误。

Java 有两种异常类型：已检查异常和未检查异常（继承自 RuntimeException 的异常）。

已检查的异常，例如 IOException，通常用于无法通过编写更好的代码来避免的不可预测的场景。它们被检查的事实意味着编译器会强制您编写代码来解释可能出现的异常情况。例如，您必须考虑 FileNotFoundException 的可能性，因为您不能保证该文件会存在（有人可能会在您的程序运行时移动它）。由于网络连接断开，可能会发生 IOException。编译器强制您提供处理这些情况的策略，即使它只是通过允许异常向上传播以供调用代码处理来推卸责任。

另一方面，未经检查的异常最好用于可以通过更改代码来避免的事情。如果代码检查是否存在空引用，则始终可以避免 NullPointerException。同样，如果你小心你的索引，你永远不会得到 ArrayIndexOutOfBoundsException。编译器不强制您处理这些场景，因为它们代表应该修复的错误。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-11T00:29:45.173

> *我认为 IOException 和 FileNotFoundException 正是这种异常*

不，这些实际上是“其他”类型的异常，超出了您的编程技能。无论你的程序有多好，编译器和库都会让你“意识到”某些事情可能会发生。

想想这个场景：

您创建一个将数据保存到临时文件夹的应用程序。

一切正常，您已检查该文件夹是否存在，如果不存在，则您自己创建它。

然后您将 2 MB 写入该临时文件夹。

突然，其他系统进程删除了您的临时文件夹，您无法再写入。

您无法以编程方式阻止这种情况，在某些系统中可能会发生这种操作（在 unix 中，root 用户可能执行 rm -rf /tmp 并且您无能为力。在 Windows 中，我认为系统不会让其他进程删除正在使用的文件）

通过强制您检查代码中的这种异常，平台设计人员认为至少您意识到了这一点。

[乔恩是正确的](https://stackoverflow.com/questions/534718/catching-exceptions-in-java/534730#534730)，有时你无能为力，可能在程序死亡之前记录，这被认为是“处理异常”（糟糕的处理是的，但至少处理）

```
try { 
   .... 
} catch( IOException ioe ) { 
    logger.severe( 
        String.format("Got ioe while writting file %s. Data was acquired using id = %d, the message is: %s", 
             fileName, 
             idWhereDataCame,
             ioe.getMessage()) );
  throw ioe;
} 
```

您可以做的另一件事是“链接”异常以适应抽象。

可能您的应用程序有一个 GUI，向用户显示 IOException 没有任何意义，也可能是一个[安全漏洞](http://www.owasp.org/index.php/Improper_Error_Handling)。可以发送修改后的消息。

```
try { 
   .... 
} catch( IOException ioe ) { 
   throw new EndUserException("The operation you've requeste could not be completed, please contact your administrator" , ioe );
} 
```

EndUserException 可能会被困在 gui 中的某个地方，并在 Dialog 消息中呈现给用户（而不是在没有进一步信息的情况下让应用程序消失在他的眼中）。当然，您无能为力来恢复该 IOException，但至少您以风格死去：P

最后一个客户端代码，可以使用不同的实现，并不是所有的异常都是有意义的。

例如，再想想第一个场景。同样的“操作”可以有三种“插件”服务来执行数据保存。

```
a) Write the data  to a file.
b) Or, write to a db
c) Or write to a remote server. 
```

接口不应抛出：

```
java.io.IOException
java.sql.SQLException 
```

也不

```
java.net.UnknownHostException 
```

但取而代之的是

```
my.application.DataNotSavedException 
```

并且不同的实现将在正确的级别处理异常，**并将**其转换为适当的抽象：

客户端代码：

```
 DataSaver saver = DataServer.getSaverFor("someKeyIdString");

 try {
     saver.save( myData );
 } catch( DataNotSavedException dnse ) {

     // Oh well... .
     ShowEndUserError("Data could not be saved due to : " dnse.getMessage() );
 } 
```

实现代码：

```
 class ServerSaver implements DataSaver { 
 ....
     public void save( Data data ) throws DataNotSavedException {
         // Connect the remore server.
         try { 
             Socket socket = new Socket( this.remoteServer, this.remotePort );
             OuputStream out = socket.getOut.... 

             ....
             ....
         } catch ( UnknownHostException uhe ) { 
            // Oops....
            throw new DataNotSavedException( uhe );
         }
    }
 } 
```

FileSaver 和 DatabaseSaver 会做类似的事情。

所有这些都是**检查异常**，因为编译器会让你检查它们。

何时使用其中一个（选中/未选中）：[这里](https://stackoverflow.com/questions/27578/when-to-choose-checked-and-unchecked-exceptions)

还有另外两种：[这里](https://stackoverflow.com/questions/462501/exception-other-than-runtimeexception/462745#462745)

最后，运行时的一个更简单的解释是：[这里](https://stackoverflow.com/questions/528917/why-dont-you-have-to-explicitly-declare-that-you-might-throw-some-built-in-excep/528942#528942)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T00:51:12.237

*稍微考虑一下这个想法：也许在另一个领域会更清楚*

如果前面的车突然停下来怎么办。

停止！

所以我们处理异常。

**所以回到代码：**

如果您需要的文件不可用怎么办？

任何一个

1.  有备份。编译为资源，因为它是您程序的一部分。*我不是在开玩笑。*
2.  IFF 这是用户提供的文件：告诉用户；这是他们的档案。
3.  由于您的软件系统已损坏，因此中止程序并向用户发送消息。

我认为没有第四种选择。

我们的 C#/VC++ 兄弟选择未经检查的异常。许多“专家”认为受检异常不好：我的论点是生活很艰难，克服它。已检查的异常代表已知的故障模式：并且必须加以解决。您的鱼骨图对于正常操作有一个直线，而对于故障则从侧面分支。检查的异常是预期的失败。

现在，一旦您开始处理运行时异常，它就会变得有趣。Java 程序可以在大部分情况下正常运行，但具有不起作用的功能。我的意思是，它们抛出空指针异常、数组边界错误、无效参数以及堆空间不足。这使得增量交付非常可行。

（如果您确实捕获了运行时错误，请将它们记录下来。否则您永远不知道要修复问题）

# sql-server - SQL Server 2000 中的内爆类型函数？

> ID：534724
> 
> 赞同：4
> 
> 时间：2009-02-10T23:17:56.190
> 
> 标签：sql-server, tsql

SQL Server 是否有 Implode 类型的函数？

我拥有的是一个列表（在 SQL 服务器表中）：

```
 Apple
 Orange
 Pear
 Blueberry 
```

我希望他们出来

```
 Apple, Orange, Pear, Blueberry 
```

我希望空格和逗号是可配置的，但如果不是，我总是可以替换它......

快速帮助将不胜感激！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-10T23:22:31.560

已经有一些与此相关的问题（搜索 PIVOT 或 UNPIVOT 或 GROUP_CONCAT），但对于您陈述的问题，SQL Server 的简单解决方案（使用变量连接的技巧）：

```
DECLARE @str AS varchar(MAX)
DECLARE @separator AS varchar(50)
SET @separator = ', ' -- Here's your configurable version

SELECT @str = COALESCE(@str + @separator, '') + <column_name>
FROM <table_name>
ORDER BY <sort_order> 
```

当然，如果每行都需要这样做，您可以使用 UDF 或[非常酷的 FOR XML](https://stackoverflow.com/questions/273238/how-to-use-group-by-to-concatenate-strings-in-mssql)技巧

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T21:03:54.330

我通常为此使用 FOR XML PATH 方法，它也适用于行子查询，只是

```
SELECT ', ' + <column_name>
FROM <table_name>
ORDER BY <sort_order>
FOR XML PATH('') 
```

这将在您的列表开始时为您提供“，”，并且删除它的最快方法
是使用东西

```
SELECT STUFF((
        SELECT ', ' + <column_name>
        FROM <table_name>
        ORDER BY <sort_order>
        FOR XML PATH('')
    ),1,2,'') 
```

# c - C中的内部静态变量，你会使用它们吗？

> ID：534735
> 
> 赞同：23
> 
> 时间：2009-02-10T23:21:08.007
> 
> 标签：c, static

在 C 语言中，您可以拥有在文件中的每个位置都可以查看的外部静态变量，而内部静态变量仅在函数中可见但是持久的

例如：

```
#include <stdio.h>

void foo_bar( void )
{
        static counter = 0;
        printf("counter is %d\n", counter);
        counter++;
}
int main( void )
{
        foo_bar();
        foo_bar();
        foo_bar();
 return 0;
} 
```

输出将是

```
counter is 0
counter is 1
counter is 2 
```

我的问题是为什么要使用内部静态变量？如果您不希望您的静态变量在文件的其余部分中可见，那么该函数不应该真的在它自己的文件中吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-11T00:56:15.983

这种混淆通常是因为`static`关键字有两个目的。

在文件级别使用时，它控制其对象在编译单元之外的*可见性，而不是对象的**持续时间*（可见性和持续时间是我在教育课程中使用的外行术语，ISO 标准使用您最终可能想要学习的不同术语，但我发现它们使大多数初学者感到困惑）。

在文件级别创建的对象已经根据它们在文件级别的事实决定了它们的持续时间。然后，`static`关键字只会使它们对链接器不可见。

在函数内部使用时，它控制*持续时间*，而不是*可见性*。可见性已经确定，因为它在函数内部——在函数外部是看不到的。在这种`static`情况下，关键字导致对象与文件级对象同时创建。

请注意，从技术上讲，在第一次调用函数之前，函数级静态可能不一定存在（这对于带有其构造函数的 C++ 可能有意义），但我曾经使用过的每个 C 实现都会同时创建其函数级静态时间作为文件级对象。

此外，虽然我使用“对象”这个词，但我并不是指 C++ 对象的意思（因为这是一个 C 问题）。这只是因为`static`可以应用于文件级别的变量或函数，我需要一个包罗万象的词来描述它。

函数级别的静态变量仍然被大量使用——如果不满足这种情况，它们可能会在多线程程序中造成麻烦，但是，如果你知道你在做什么（或者你没有线程化），它们是最好的方法在多个函数调用之间保持状态，同时仍然提供封装。

即使使用线程，您也可以在函数中执行一些技巧（例如在函数中分配线程特定的数据*）*以使其可行，而不会不必要地暴露函数内部。

我能想到的唯一其他选择是全局变量，并且每次都将“状态变量”传递给函数。

在这两种情况下，您都将函数的内部工作原理暴露给其客户端，并使函数依赖于客户端的良好行为（始终是一个冒险的假设）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-10T23:26:01.193

它们用于实现类似的工具`strtok`，它们会导致重入问题......

在玩弄这个工具之前请仔细考虑，但有时它们是合适的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T23:28:34.993

例如，在 C++ 中，它被用作获取单例实例的一种方式

```
SingletonObject& getInstance()
{
  static SingletonObject o;
  return o;
} 
```

它用于解决初始化顺序问题（尽管它不是线程安全的）。

广告“函数不应该在它自己的文件中”

当然不是，这是胡说八道。编程语言的大部分目的是促进隔离并因此重用代码（局部变量、过程、结构等都这样做），这只是另一种方式。

顺便说一句，正如其他人指出的那样，几乎所有反对全局变量的论点也适用于静态变量，因为它们*实际上*是全局变量。但是在很多情况下使用全局变量是可以的，而且人们会这样做。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-11T00:32:07.070

我发现它对于一次性的、延迟的初始化很方便：

```
int GetMagic()
{
   static int magicV= -1;

   if(-1 == magicV)
   {
      //do expensive, one-time initialization
      magicV = {something here}
   }
   return magicV;
} 
```

正如其他人所说，这在第一次调用期间不是线程安全的，但有时你可以侥幸逃脱:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-10T23:25:24.393

我认为人们通常会远离内部静态变量。我知道 strtok() 使用一个或类似的东西，因此可能是 C 库中最讨厌的函数。

其他语言如 C# 甚至不支持它。我认为曾经的想法是，在 OO 语言出现之前，它就在那里提供了一些类似的封装（如果你可以这么称呼的话）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T23:28:31.687

在 C 中可能不是非常有用，但它们在 C++ 中用于保证命名空间范围静态的初始化。在 C 和 C++ 中，它们在多线程应用程序中的使用都存在问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T23:30:26.080

我不希望静态变量的存在迫使我将函数放入自己的文件中。如果我有许多类似的函数，每个函数都有自己的静态计数器，我想将它们放入一个文件中怎么办？我们必须做出足够多的决定来决定把东西放在哪里，而不需要更多的限制。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T23:41:47.660

静态变量的一些用例：

*   您可以将它用于计数器，并且不会污染全局命名空间。
*   您可以使用将值作为指针获取并返回内部静态的函数来保护变量。这样您就可以控制值的分配方式。（当您只想获取值时使用 NULL）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-11T00:04:56.107

我从未听说过这种称为“内部静态变量”的特定构造。一个合适的标签，我想。

像任何构造一样，它必须以知识和负责任的方式使用。您必须知道使用该构造的后果。

它将声明的变量保留在最本地范围内，而无需为函数创建单独的文件。它还可以防止全局变量声明。

例如 -

```
char *GetTempFileName()
{
  static int i;
  char *fileName = new char[1024];
  memset(fileName, 0x00, sizeof(char) * 1024);
  sprintf(fileName, "Temp%.05d.tmp\n", ++i);
  return fileName;
} 
```

VB.NET 支持相同的构造。

```
Public Function GetTempFileName() As String
  Static i As Integer = 0
  i += 1
  Return String.Format("Temp{0}", i.ToString("00000"))
End Function 
```

这样做的一个后果是这些函数不是可重入的，也不是线程安全的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-11T00:12:40.037

不再。我已经看到或听到了多线程领域中函数局部静态变量的结果，但它并不漂亮。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-11T02:31:44.087

所有静态变量都是持久的，不受同时访问的保护，就像全局变量一样，因此必须谨慎使用。但是，有时它们会派上用场，并且不一定值得放在自己的文件中。

我在一个致命错误记录函数中使用了一个，该函数被修补到我的目标的错误中断向量中，例如。除以零。当这个函数被调用时，中断被禁用，所以线程不是问题。但是如果我在记录第一个错误的过程中*导致*了一个新的错误，那么重新进入仍然可能发生，比如错误字符串格式化程序坏了。在那种情况下，我必须采取更激烈的行动。

```
void errorLog(...)
{
    static int reentrant = 0;
    if(reentrant)
    {
        // We somehow caused an error while logging a previous error.
        // Bail out immediately!
        hardwareReset();
    }

    // Leave ourselves a breadcrumb so we know we're already logging.
    reentrant = 1;

    // Format the error and put it in the log.
    ....

    // Error successfully logged, time to reset.
    hardwareReset();
} 
```

这种方法正在检查一个非常不可能的事件，并且它只是安全的，因为中断被禁用。但是，在嵌入式目标上，规则是“从不挂起”。这种方法保证（在合理范围内）硬件最终以一种或另一种方式被重置。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-12T14:56:11.383

在为微控制器编写代码时，我会使用局部静态变量来保存特定功能的子状态的值。例如，如果我有一个 I2C 处理程序，每次 main() 运行时都会调用它，那么它将有自己的内部状态保存在静态局部变量中。然后每次调用它时，它都会检查它所处的状态并相应地处理 I/O（将位推到输出引脚上，拉起一条线等）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T23:27:08.007

一个简单的用途是一个函数可以知道它被调用了多少次。

# web-applications - 存储调查数据的最佳方式？

> ID：534737
> 
> 赞同：4
> 
> 时间：2009-02-10T23:22:17.300
> 
> 标签：web-applications, survey

我正在开发一个非常小的调查应用程序，可能是 3-4 页的 Web 应用程序。所以我的问题是保存调查数据的最佳方法是什么？

顺便说一句，到目前为止，我想出了以下方法。

1.  保存到数据库并将每个调查标记为不完整。当用户提交最后一份调查表时，检查调查的完整性，如果完成则将其标记为完成。

2.  当用户提交最后一份调查表时，保存到会话而不是保存到数据库。

你觉得这些方法怎么样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T23:28:43.837

我对这类事情有些头疼，如果可能的话，我建议不要使用 Sessions。当您的站点获得适度的流量时，或者如果 ASP.NET 只是喜欢它，您可能会发现您丢失了所有会话，因为 .NET 试图释放一些内存。

我会尽快将其放入数据库中。使用 Guid.NewGuid() 生成一个唯一的不可猜测的键，您可以在查询字符串中从一页传递到下一页：这将是您从数据库中检索记录的键。

您尚未考虑的另外两个选项：

1.  将响应从一页发布到下一页。（这可能比它的价值更麻烦。）

2.  使用 asp:Wizard 控件。这样，您的 3-4 页实际上将是单个页面上的 3-4 个步骤。每个阶段的数据都会自动为您存储在 ViewState 中，因此当您处于最后一步时，您仍然可以访问第一步中的输入字段。

（不过，我仍然会选择您的选项 1。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T23:33:55.713

不要为此使用会话。微软有一个很好的例子，说明如何不在他们在 TechEd 使用的应用程序中进行调查。每次您必须考虑答案时，会话都会超时。使用 ajax，保存每个答案，甚至是部分答案。如果您遇到数据库性能问题，请在一定时间内收集所有调查的所有答案，并将它们保存在一起。使用一些 javascript，您可以仅在过去几秒钟内发生更改时或在窗口关闭之前对服务器进行回调。

当然，除非你有回答问题的时间限制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-10T23:34:39.347

如果您预计您的应用程序将来可能会增长（提供更长的调查，甚至可能以用户可以在“中间”结果相同并在以后恢复的形式），我肯定会选择数据库选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T23:38:01.507

这是我的做法：

*   我从数据库中生成“问题”，因此只有一页用于显示不同的问题。
*   一旦用户单击“下一步”，我就会保存每个问题的答案。这有一个很大的优势，即用户可以回来并从她离开的地方开始。
*   我使用指针跟踪进度，该指针与结果的保存一起更新。
*   我不使用会话，因为我不想冒丢失数据的风险，也不想让内存紧张。
*   当指针 == 问题数时，标记为已完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T23:27:09.880

如果您希望他们能够在调查中途保存他们的结果并在另一个时间回来完成它，那么您必须存储调查的开始时间和结束时间才能知道他们完成了它。到目前为止，您还必须存储它们的所有值。

由于它很小，我只会将其保留在会话中，然后在完成后将其保存到数据库中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T23:29:19.860

我认为第二种选择是你最好的选择。如果您的网站访问量很大，选项 1 会给数据库带来更大的压力，并且还会因为不完整的调查而使数据库变得混乱。会话听起来是一个更好的选择，因为实际上，除非数据完整，否则您不想要数据，对吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T23:30:40.293

两者看起来都不错，这取决于您期望用户做什么或期望用户表现什么。

第一种方法将允许用户返回（即使在关闭浏览器之后）以完成调查。这是一个好点，如果您的调查很大并且用户在迷失在其他事情之前无法完成它，但是如果您想强迫用户完成，这也是一个负面点，我的意思是，如果您不希望不完整调查。

第二种方法强制用户在开始调查的同时完成调查。如果您的调查很快并且您想要有关它们的完整数据，这是一个很好的观点，但如果您的调查很长并且通常用户在完成之前会分心，那就不好了。

我想说，每页的问题数量将是我在两种方法之间选择的决定性因素，也许它也适合你。

# php - 什么是 mysql_real_escape_string() 而addslashes() 没有？

> ID：534742
> 
> 赞同：20
> 
> 时间：2009-02-10T23:23:30.357
> 
> 标签：php, security, sql-injection

为什么我们需要一个特定于数据库的函数，比如 mysql_real_escape_string()？addlashes() 不能做什么？

暂时忽略参数化查询的优越替代方案，仅使用 addlashes() 的 web 应用程序仍然容易受到 SQL 注入的攻击，如果是，如何？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-10T23:32:20.443

它将斜杠添加到：

```
\x00, \n, \r, \, ', " and \x1a. characters. 
```

其中addslashes 只添加斜线到

```
' \ and NUL 
```

[Ilias 文章](http://ilia.ws/archives/103-mysql_real_escape_string-versus-Prepared-Statements.html)也非常详细地介绍了它的功能

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-10T23:39:53.983

在处理多字节编码字符串时，Addslashes 通常不够好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T01:31:53.730

gs 严厉反对的答案实际上是正确的。

标准 SQL 使用加倍来转义文字撇号。MySQL 为转义使用反斜杠的非标准使用是默认设置，但它可以被禁用并且通常是禁用的，特别是在 sql_mode ANSI 中。

在这种情况下，只有双倍语法才能工作，并且您使用的任何应用程序都使用了 addlashes（或其他临时转义方法）将中断。mysql_real_escape_string 将使用最适合连接的 sql_mode 的任何转义方法。

如果您仍在使用那些重复使用较低 128 个字符的讨厌的东亚编码，那么多字节编码问题也很重要，但您确实想改用 UTF-8。另一方面，\n 转义无关紧要，因为 MySQL 可以完美地处理语句中的原始换行符。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-05-08T14:50:53.233

[mysql_real_escape_string](http://dev.mysql.com/doc/refman/5.7/en/mysql-real-escape-string.html)的作用远不止*于此*`addslashes`。

addlashes 在纯 ascii 上运行，无需了解数据库。它逃脱：

*   `'`→`\'`
*   `"`→`\"`
*   `\`→`\\`
*   ASCII `0`→ `\0`.

[mysql_real_escape_string](http://dev.mysql.com/doc/refman/5.7/en/mysql-real-escape-string.html)的目的是“创建一个可以在 SQL 语句中使用的合法 SQL 字符串”。mysql_real_escape_string 考虑**了连接的当前字符集**（这就是为什么你必须总是传递一个有效的 $mysql 对象）。

它执行以下操作（取自 MySQL C API 文档）：

*   编码： `\`, `'`, `"`, ASCII `0`, `\n`, `\r`, 和`Control+Z`以不会导致问题的方式
*   确保一个`0`字节终止字符串（在 C api 中）
*   如果 $mysql 中链接的数据库使用宽字符集，则可以执行多字节（ascii）到宽字符的转换。

我真的不知道 PHP 如何在内部存储字符串，但关键是当您使用`mysql_real_escape_string`. 我想主要的区别是`mysql_real_escape_string` **考虑连接的字符集**，哪里`addslashes`不能（它甚至不知道你连接到什么数据库）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-10T23:30:09.730

[`somedb_real_escape_string()`](http://ee2.php.net/mysql_real_escape_string)是特定于数据库的，[`addslashes()`](http://ee.php.net/addslashes)不是。

对于 MySQL，这意味着：

> mysql_real_escape_string() 调用 MySQL 的库函数 mysql_real_escape_string，该函数在以下字符前添加反斜杠：\x00、\n、\r、\、'、" 和 \x1a。

（来自手册。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-08T21:01:53.950

> 为什么我们需要一个特定于数据库的函数，比如 mysql_real_escape_string()？

事实上，大多数时候我们没有。
一些极其罕见的编码需要此功能，并稍微美化 mysql 日志和转储。

> 一个只使用addslashes() 的webapp 是否仍然容易受到SQL 注入的攻击？

只要它使用任何单字节字符集或 utf8 -**使用 addlashes() 就完全安全。**

> addlashes() 不能做什么？

它可以在一些罕见的编码的情况下保护 SQL*字符串文字*。

**但是，它无法自行完成。**必须`mysql_set_charset()`首先使用函数设置正确的编码。如果这个函数没有被使用，它`mysql_real_escape_string()` **的行为方式与`addslashes()`字符集处理完全一样——根本没有区别**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-10T23:31:25.533

我知道的唯一真正的区别是 mysql_real_escape_string() 在转义输入字符串时会考虑数据库的字符集。这两个函数都不会转义通配符 % 和 _ ，这仍然会使脚本对某些 SQL 注入开放。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T23:35:12.323

根据[PHP 手册](http://us.php.net/mysql_real_escape_string)：

> mysql_real_escape_string() 调用 MySQL 的库函数 mysql_real_escape_string，该函数在以下字符前添加反斜杠：\x00、\n、\r、\、'、" 和 \x1a。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-11T03:39:16.560

PHP 的 mysql_real_escape_string 函数或多或少会**询问 mysql 哪些字符需要转义**，其中的 addlashses 函数只会在任何单引号 (')、双引号 (")、反斜杠 () 前面添加一个反斜杠或 NUL（NULL 字节）字符。

这两个实际效果是，addslashes 往往不适用于多字节字符，更重要的是，通过询问 mysql 需要转义哪些字符，可以避免未来可能的兼容性。使用 assslashes 有点像将几个特定字符硬编码到转义序列中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-10T23:30:08.390

它应该以其他引用工具没有的方式为 MySQL 转义字符串。

然而，更可取的是**使用 mysqli 接口**，并使用参数化的准备查询，而不是尝试确保所有字符串都正确转义。使用参数化查询消除了对这种凌乱的字符串工作的需要，并大大降低了 SQL 注入的风险。

编辑：我将澄清一下为什么我考虑引用一个坏主意：很容易忘记何时何地需要引用 - 你的变量是字符串还是数字，是否已经被引用等等。参数化查询**没有这些问题**，并且*完全*不需要引用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-02-24T15:52:12.167

根据我的理解 mysql_real_escape_string() 更精确地完成工作，因为它与 db 通信首先检查需要编码的内容，然后进行相应的编码，不是吗？因此，它可以更有效地工作

为什么你想先做addslashes然后你会在显示数据之前删除那个斜杠并且仍然addslashes不如mysql_real_escape_string高效，如果你使用mysql_query之类的db函数进行查询，请使用mysql_real_escape_string，或者我认为带有prepare的PDO是更好的方法，因为 mysql_real_escape_string 是特定于数据库的

# iis - 将用户添加到 SQL Server 2008 - 权限被拒绝

> ID：534764
> 
> 赞同：4
> 
> 时间：2009-02-10T23:28:47.050
> 
> 标签：iis, login, windows-authentication, sql-server-2008-express

我最近遇到了[一些问题](https://stackoverflow.com/questions/524905/handleerror-attribute-does-not-seem-to-act-at-all)，我认为调试我的 ASP.NET MVC 应用程序`IIS`而不是使用默认的 ASP.NET 开发服务器可能会有所帮助。但是，当我尝试这样做时，应用程序无法访问数据库服务器（MS SQL Server 2008 Express）——尽管它在开发服务器上运行良好。

我得到的错误是

> `Cannot open database 'myDbName' requested by the login. The login failed. Login failed for user 'NT INSTANCE/NETWORK SERVICE'.`

我认为它以前可以工作，因为开发服务器通过我的用户帐户访问数据库，而不是通过像`IIS`.

我尝试将用户添加`NETWORK SERVICE`到数据库，但事实证明我没有这样做的用户权限 - 我登录到服务器的 Windows 帐户是管理员，或者我运行管理员上下文中的程序。我只是无法将其他用户添加到数据库中。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T23:41:24.620

您可以更改运行 IIS 的用户：它是您的网站在其下运行的 ApplicationPool 的属性中的设置。

我们一直这样做，因为它使我们能够更好地控制用户访问 - NT INSTANCE/NETWORK SERVICE 帐户对我来说有点太神奇了......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T23:38:46.543

NETWORK SERVICE 是一个特殊帐户。如果您的数据库服务器位于 IIS 服务器的另一台计算机上，则需要添加帐户：

\$ 作为数据库的用户。因此，如果您在 SPRINGFIELD 网络上名为 LISA 的 IIS 服务器上，则需要授予对 SPRINGFIELD\LISA$ 数据库的访问权限。请注意美元符号，它表示您的用户是机器帐户，而不是真实的人。

如果您的数据库服务器和 IIS 服务器是同一台服务器，请授予对帐户“NT AUTHORITY\NETWORK SERVICE”的访问权限。这是帐户的全名。这应该有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T12:58:25.993

您正在运行非英语操作系统吗？

由于某些原因，“NT Authority\Network Service”的帐户名称已本地化为其他语言。
可悲的是，许多程序将帐户名硬编码为英文名称，并且在外国版本的 Windows 上运行时找不到网络服务。

# web-services - Amazon EC2 - 选择哪个 Ubuntu 服务器：32 位还是 64 位？

> ID：534774
> 
> 赞同：23
> 
> 时间：2009-02-10T23:30:48.327
> 
> 标签：web-services, ubuntu, amazon-ec2

我正在为我在 Amazon EC2 网络上的网站选择 AMI。似乎 Ubuntu 实例有 32 位或 64 位版本。大概 64 位系统会给你更多的内存地址空间，这很好。但是，我想知道查找预编译的二进制文件是否有问题。我最好坚持使用 32 位吗？我的 Web 应用程序不是非常占用内存。

为什么我会选择一个而不是另一个，优点和缺点是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-10T23:40:32.280

您应该根据所需服务器的大小做出决定。

32 位 AMI 仅在 上运行，而`m1.small`64 位 AMI 仅在实例上运行（加上相应的高 CPU 变体）。`m1.large``m1.xlarge`

更大的实例显然需要更多的钱，理论上价格与性能成线性关系。但是，我发现大型和 xlarge 实例实际上比小型实例具有更高的性能/美元。

这似乎不是由于 32 位或 64 位架构，而是由于 I/O 控制器的争用。如果您在 EC2 上做认真的工作，我建议您使用`m1.large`实例，以及所需的 64 位 AMI。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-10T23:33:58.520

在 64 位部署期间，我的团队出现的一个问题是 64 位机器上的指针更大，因此内存耗尽的速度比我们想象的要快。
不是答案，我知道，只是提醒一下。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-04-25T23:06:38.133

自 2012 年 3 月 8 日起，Amazon EC2 支持所有实例类型的 64 位 AMI。

这使得此列表中的先前答案已过时，因为它们假设不同的实例类型需要不同的架构选择。

我建议始终使用 64 位 AMI，以便您在更改实例的实例类型方面拥有最大的灵活性，并且从该实例创建的自定义 AMI 将适用于任何其他实例类型。

我在这里写了更多关于此的内容：http: [//alestic.com/2012/03/ec2-64-bit](http://alestic.com/2012/03/ec2-64-bit)

读者对该文章的评论中有一些很好的讨论点，用于专门的异常，其中 32 位可能比 64 位执行得更好，但请记住，这限制了您可以在哪些实例类型上运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-19T11:15:02.623

如果成本是优先考虑的，那就选择 32 位。如果性能很重要，请选择 64 位。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-15T18:11:29.077

基础已经回答了。我只想指出，相对较新的**微型实例**同时支持 32 位和 64 位。这（还）不适用于**小型实例**。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-10T23:40:16.417

缺点：就像 RKitson 所说，64 位指针占用的内存空间是原来的两倍。如果这意味着你的东西现在不适合 CPU 缓存，这可能会降低性能。

优点：您获得双倍的寄存器 - 从中​​受益的程序将显示出很多性能改进。（第二个专业人士：64 位版本的软件包都在 SSE 支持下编译......这也可以提高性能，具体取决于您的工作量）

我只会构建两个图像并对其进行基准测试，这比理论化更容易，也不应该花费数天时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-11T00:05:56.760

我会说选择 32 位，除非您出于性能原因确实需要 64 位。您可以在 m1.small 实例上运行 32 位 Ubuntu，成本为 10c/实例小时，或约 75 美元/月；相比之下，64 位最便宜的选择是 m1.large，它的成本是它的四倍——40c/实例小时或大约 300 美元/月。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T23:36:16.597

64 位为您提供更多内存地址空间，并且可以更好地执行处理器密集型任务。假设您使用 PHP 和 Mysql 等标准软件，查找二进制文件应该不是问题。除非您有一些可能无法在 64 位下运行的稀有库，否则我会选择 64 位。

# asp.net - Asp.NET：UserControl 的 BubbleEvent 未被转发器或页面处理

> ID：534792
> 
> 赞同：2
> 
> 时间：2009-02-10T23:35:38.627
> 
> 标签：asp.net, events, user-controls, repeater

我在中继器中有一个用户控件。用户控件有一个 ImageButton，当单击它时，应该向将处理该事件的页面引发一个事件：

```
//Button onClick event in user control
protected void btnOpenOption_Click(object sender, ImageClickEventArgs e)
{
    RaiseBubbleEvent(sender, e);
} 
```

以下是页面上的两种方法。一个处理来自子控件的 BubbleEvent，另一个处理转发器的 ItemEvent 命令：

```
protected void rptProcessOptions_ItemCommand(object source, RepeaterCommandEventArgs e)
{
    //do something...
}

protected override bool OnBubbleEvent(object source, EventArgs args)
{
    //do something else...
} 
```

我读过中继器 ItemCommand 处理程序应该从子控件侦听 BubbleEvent 并随后处理它，但事实并非如此。页面上的 OnBubbleEvent 处理程序也没有拾取它。换句话说，事件只是迷路了。我知道它正在触发，因为我可以在调试器中单步执行时看到它。

我之前成功使用过 RaiseBubbleEvent，但从未在中继器中使用过，所以我不确定我尝试的是否正确。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T00:18:31.627

仅当 EventArgs 是 RepeaterCommandEventArgs 的实例时才会触发 ItemCommand。

# linq-to-sql - 用于查询运算符“相交”的不受支持的重载

> ID：534793
> 
> 赞同：2
> 
> 时间：2009-02-10T23:35:46.473
> 
> 标签：linq-to-sql

当我移动到 sqlRepository 时，我可以使用内存中的测试存储库很好地执行此查询，我收到此错误 Unsupported overload used for query operator'Intersect'。

我认为这是因为在不处理 Model.Model.Talent 类型时，将查询发送到 sql 对 Linq to Sql 来说太复杂了。有没有办法用 Intersect 进行这样的搜索？

谢谢

```
public class TalentService : ITalentService
{ 
    ITalentRepository _repository = null;

    private IQueryable<Talent> BasicSearch(string searchExpression)
    {
        IQueryable<Talent> t;
        string[] sa = searchExpression.Trim().ToLower().Replace("  ", " ").Split(' ');
        t = _repository.GetTalents();
        foreach (string s in sa)
        {
            t = t.Intersect(AddBasicSearch(s), new TalentComparer()); 
        }
        return t;
    }

    private IQueryable<Talent> AddBasicSearch(string s)
    {
        IQueryable<Talent> t2 = _repository.GetTalents()
            .Where(tal => tal.EyeColor.ToString().ToLower().Contains(s)
                          || tal.FirstName.ToLower().Contains(s)
                          || tal.LastName.ToLower().Contains(s) 
                          || tal.LanguagesString.ToLower().Contains(s) 
                          );
        return t2;
    } 
}

public class SqlTalentRepository:ITalentRepository
{
    public IQueryable<Model.Model.Talent> GetTalents()
    {
        var tal = from t in _db.Talents  
                  let tLanguage = GetTalentLanguages(t.TalentID)
                  where t.Active == true
                  select new Model.Model.Talent
                  {
                      Id = t.TalentID,
                      FirstName = t.FirstName,
                      LastName = t.LastName, 
                      TalentLanguages = new LazyList<Model.Model.TalentLanguage>(tLanguage),
                      LanguagesString = t.TalentLanguages.ToLanguageNameString(_LanguageRepository.GetLanguages()) 
                  };
        return tal ;
    }

    public IQueryable<Model.Model.TalentLanguage> GetTalentLanguages(int iTalentId)
    {
        var q = from y in this.talentLanguageList
                let Languages = _LanguageRepository.GetLanguages()
                where y.TalentId == iTalentId
                select new Model.Model.TalentLanguage
                {
                    TalentLanguageId = y.TalentLanguageId,
                    TalentId = y.TalentId,
                    LanguageId = y.LanguageId,
                    Language = Languages.Where(x => x.LanguageId == y.LanguageId).SingleOrDefault() 
                };
        return q.AsQueryable<Model.Model.TalentLanguage>();
    }

}

public static class TalentExtensions
{ 
    public static string ToLanguageNameString(this IEnumerable<TalentLanguage> source
        , IEnumerable<Model.Model.Language> allLanguages)
    {
        StringBuilder sb = new StringBuilder();
        const string del = ", ";
        foreach (TalentLanguage te in source)
        {
            sb.AppendFormat("{0}{1}", allLanguages
                .Where(x => x.LanguageId == te.LanguageID).SingleOrDefault().LanguageName, del);
        }
        string sReturn = sb.ToString();
        if (sReturn.EndsWith(del))
            sReturn = sReturn.Substring(0, sReturn.Length - del.Length);
        return sReturn;
    } 
}

public class TestTalentRepository : ITalentRepository
{ 
    IList<Talent> talentList; 

    public TestTalentRepository(ILanguageRepository _LanguageRepo )
    { 
        this._LanguageRepository = _LanguageRepo; 
        talentList = new List<Talent>(); 
        talentLanguageList = new List<TalentLanguage>(); 
        for (int i = 0; i < 55; i++)
        {
            var t = new Talent();
            t.Id = i;
            t.FirstName = (i % 3 == 0) ? "Ryan" : "Joe";
            t.LastName = (i % 2 == 0) ? "Simpson" : "Zimmerman";   
            AddLanguagesToTestTalent(i, t);
            talentList.Add(t);
        }
    }

    private void AddLanguagesToTestTalent(int i, Talent t)
    { 
        IList<Language> Languages = _LanguageRepository.GetLanguages().ToList<Language>();
        Random rLanguages = new Random();
        int numLanguages = rLanguages.Next(Languages.Count - 1) + 1;
        t.TalentLanguages = new LazyList<TalentLanguage>();
        for (int j = 0; j < numLanguages; j++)
        {
            var x = new TalentLanguage();
            x.TalentLanguageId = j;
            x.TalentId = i;
            Random random2 = new Random();
            int rand = random2.Next(Languages.Count);
            var y = Languages.ElementAtOrDefault(rand);
            Languages.RemoveAt(rand);
            x.Language = y;
            x.LanguageId = y.LanguageId;
            t.TalentLanguages.Add(x);
        }
    }

    public IQueryable<Talent> GetTalents()
    {
        var ts = from t in this.talentList 
                 let tLanguage = GetTalentLanguages(t.Id)
             where t.Active == true
             select new Model.Model.Talent
             {
                 Id = t.Id,
                 FirstName = t.FirstName,
                 LastName = t.LastName, 
                 TalentLanguages = new LazyList<Model.Model.TalentLanguage>(tLanguage),
                 LanguagesString = t.TalentLanguages.ToLanguageNameString(_LanguageRepository.GetLanguages()), 
                 City = t.City, 
             };
        return ts.AsQueryable<Model.Model.Talent>(); 
    }

    public IQueryable<Model.Model.TalentLanguage> GetTalentLanguages(int iTalentId)
    {
        var q = from y in this.talentLanguageList
                let Languages = _LanguageRepository.GetLanguages()
                where y.TalentId == iTalentId
                select new Model.Model.TalentLanguage
                {
                    TalentLanguageId = y.TalentLanguageId,
                    TalentId = y.TalentId,
                    LanguageId = y.LanguageId,
                    Language = Languages.Where(x => x.LanguageId == y.LanguageId).SingleOrDefault() 
                };
        return q.AsQueryable<Model.Model.TalentLanguage>();
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T23:38:25.483

如果您要查找符合*所有*这些条件的条目，则只需要多个 where 子句：

```
private static readonly char[] SplitDelimiters = " ".ToCharArray();

private IQueryable<Talent> BasicSearch(string search)
{
    // Just replacing "  " with " " wouldn't help with "a      b"
    string[] terms = search.Trim()
                           .ToLower()
                           .Split(SplitDelimiters, 
                                  StringSplitOptions.RemoveEmptyEntries);
    IQueryable<Talent> query = _repository.GetTalents();
    foreach (string searchTerm in terms)
    {
        query = AddBasicSearch(query, searchTerm);
    }
    return query;
}

private IQueryable<Talent> AddBasicSearch(IQueryable<Talent> query, string s)
{
    return query.Where(tal =>  
                       tal.EyeColor.ToString().ToLower().Contains(s)
                       || tal.FirstName.ToLower().Contains(s)
                       || tal.LastName.ToLower().Contains(s) 
                       || tal.LanguagesString.ToLower().Contains(s) 
                       );
} 
```

# visual-studio-2008 - 数据集设计器问题 - Visual Studio 2008

> ID：534796
> 
> 赞同：9
> 
> 时间：2009-02-10T23:38:00.493
> 
> 标签：visual-studio-2008, dataset, designer

我们正在使用数据集在应用程序的各个节点之间投放少量数据。

数据集本身就在一个程序集中，因为它是许多其他组件的引用。

Visual Studio 数据集工具养成了一种奇怪的习惯，即每次构建完成时都创建一个新设计器。

所以，项目看起来像这样

```
我的数据集.xsd
 - 我的数据集.cs
 - MyDataset.designer.cs
 - ....
```

然后执行构建，结果是

```
我的数据集.xsd
 - 我的数据集.cs
 - MyDataset.designer.cs
 - MyDataset1.designer.cs
 - ....
```

MyDataSet1 设计器包含新的更改，而原始设计器保持不变。我目前的解决方案是用 MyDataset1.designer 替换 MyDataset.designer 然后重建。

这是一个小小的不便，但如果有人进行了更改并且不执行上述操作，则生成的程序集不包含他们的更改。

除了不使用数据集之外，还有什么建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-02-26T01:22:27.997

关闭您的项目。以 XML 模式编辑*项目*.csproj 文件。您将在组中找到一个条目，内容如下：

```
<None Include="*myDataSet*.xsd">
  <SubType>Designer</SubType>
  <Generator>MSDataSetGenerator</Generator>
  <LastGenOutput>*myDataSet*1.Designer.cs</LastGenOutput>
</None> 
```

更改项目以删除“1”。保存并关闭文件。重新打开您的项目。

当您重新生成数据集时，它应该会恢复正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-11T19:06:03.373

1.  从 VS 中卸载您的项目。
2.  在记事本中编辑项目文件。
3.  从相关元素的值中删除 1。
4.  再次在VS中打开项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T06:04:32.293

我曾经遇到过这个问题，但不记得我是如何解决的。

我相信我做到了：

*   删除 XSD 后面的所有 de *.cs 文件（它们是生成的，所以没有问题）。您可以从解决方案资源管理器中执行此操作。

我这还不够。。

*   删除 XSD 后面的所有 *.cs 文件，然后从项目中删除 esd。（将其复制到备份位置）然后从备份位置添加 bij“添加现有文件”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T16:22:12.007

据我了解，您可以右键单击“数据源”选项卡中的数据集。点击 Configure Dataset with 向导并选择新的或修改的数据对象，你应该很高兴。

# svn - 递归删除匹配文件和目录的命令行

> ID：534798
> 
> 赞同：29
> 
> 时间：2009-02-10T23:38:03.737
> 
> 标签：svn, command-line, file, recursion, dos

如何递归删除与特定模式匹配的所有文件和目录？例如删除所有“.svn”目录和它们包含的文件？

（遗憾的是仅 DOS）

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-02-10T23:49:31.993

由于您正在寻找 DOS 解决方案，因此上周的帖子几乎相同，共识是：

[在Windows中递归删除具有指定名称的文件夹的命令行工具？](https://stackoverflow.com/questions/521382/command-line-tool-to-delete-folder-with-a-specified-name-recursively-in-windows/521433#521433)

> 对于 /d /r 。%d in (.svn) do @if exists "%d" rd /s/q "%d"

或者

> for /f "usebackq" %d in ("dir .svn /ad/b/s") do rd /s/q "%d"

实际上，SVN 还为您提供了导出没有 .svn/_svn 目录的工作目录的选项。

三年后的事后思考：我认为人们最终需要递归删除 .svn/_svn 文件夹的原因是因为他们已直接将本地工作副本复制到新位置，以便对其修改后的版本进行文件夹比较比较到一个干净的导出，即在修改后的本地工作副本出现问题之后。（至少这就是我需要它的原因。在可能的情况下使用'svn export'绝对更容易/更快。）

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-10T23:43:59.683

这是 Unix 还是 Windows？在 Unix 上，一个简单的解决方案是

```
find . -name '.svn' -type d | xargs rm -rf 
```

这会递归搜索层次结构中从“.”开始的所有目录（-type d）。（当前目录），并查找名称为 '.svn' 的人；然后将找到的目录列表提供给 rm -rf 以进行删除。

如果您想尝试一下，请尝试

```
find . -name '.svn' -type d | xargs echo 
```

这应该为您提供*将*被递归删除的所有目录的列表。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-10T23:47:11.140

如果您的文件处于 subversion 中，那么从存储库执行导出将为您提供一个目录树，其中包含 .svn 文件和任何其他杂物被删除。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-10T23:42:43.727

像这样的东西可能会奏效，但当然要小心！

```
find . -name ".svn" -exec rm -rf {} \; 
```

首先尝试这样的事情来进行试运行：

```
find . -name ".*" -exec echo {} \; 
```

请注意，空括号用文件名填充，转义的分号结束执行的命令（从“-exec”之后开始）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-10T23:41:31.250

在 *nix 或 Cygwin 上：

```
find -name .svn -print0 | xargs -0 rm -rf 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-08T13:18:29.773

如果您想复制它而不从项目中导出和删除 .svn，您应该使用 XCOPY 中的 /EXCLUDE 选项。

像这样：

```
xcopy /S/Q/EXCLUDE:svn.excludelist [path_from] [path_to\] 
```

观察 [path_to] 上的“\”（反斜杠）。它确定它是一个输出目录，因此，xcopy 不会质疑它是文件还是目录。

svn.excludelist 是一个文本文件，包含复制时要忽略的模式，以行分隔。

例如：

```
.svn
.svn\
\.svn\
.obj
.o
.lib
\src\ 
```

等等...

# email - 如何将 Gmail 邮件中的附件保存到 Gdocs？

> ID：534801
> 
> 赞同：1
> 
> 时间：2009-02-10T23:38:18.387
> 
> 标签：email, gmail, google-docs

**问题：**将 Gmail 中的许多 pdf 附件提取到我的 Google 文档中，并用“Python”标记每个文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T23:47:16.117

一种可能的解决方案是：

使用带有过滤器**tcp 端口 80**的 wireshark 并手动执行几次任务。然后在 Wireshark 中检查浏览器发出的请求。

**然后使用httplib**模块构建脚本以自动化先前检查的请求。

据我所知，当您收到 PDF 附件时，gmail 中有一个“以 HTML 格式查看”链接。您可以使用它将文档转换为谷歌文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T23:47:03.747

对此的任何解决方案都非常重要，需要以编程方式阅读您的邮件、遍历附件、破解 PDF、打开 Google 文档并将其中的内容转录到另一个中。我怀疑 Google API 中是否有任何预先打包的功能，尽管它们可能很广泛。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-27T19:31:07.147

Mailspect 提供了这个，[http ://esm.mailspect.com/index.php/Attachments_as_Google_Docs](http://esm.mailspect.com/index.php/Attachments_as_Google_Docs)

# sql - Excel 中外部数据查询背后的 SQL

> ID：534804
> 
> 赞同：0
> 
> 时间：2009-02-10T23:39:07.043
> 
> 标签：sql, excel

我继承了一个包含外部数据查询的 Excel 电子表格。我可以编辑查询，它提供了返回的列的列表，但它确实提供了该数据来自的表。有什么方法可以检索查询背后的实际 SQL 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T23:56:01.540

我认为这可能取决于您使用的办公室版本以及您连接的外部数据的类型。

我相信如果您使用的是 Office 2003，并且您看到的列就像您说的那样，那么工具栏中可能会有一个 SQL 图标。单击以查看用于返回数据的 SQL。

如果您使用的是 Office 2007，请转到数据选项卡，依次单击连接、属性、定义选项卡，然后更改命令文本。

但是我相信您使用的是第一种方法。

这是我记得的，所以我希望它是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T00:17:54.640

通过使用 ODBC 链接或其他东西，它也可能会有些混淆。另一种获取它的方法是在 SQL Server 上运行 SQL Profiler 以查看正在执行的确切 SQL。当然，这不会帮助您编辑它，但您会知道它在做什么。

# java - 在 XML 中存储二维表（决策表）以实现高效查询

> ID：534807
> 
> 赞同：2
> 
> 时间：2009-02-10T23:40:30.660
> 
> 标签：java, xml

我需要实现一个路由表，其中有许多参数。

例如，我在下面的传入消息中说明了五个属性

```
Customer Txn Group Txn Type Sender Priority  Target
UTI       CORP     ONEOFF   ABC    LOW       TRG1
UTI       GOV      ONEOFF   ABC    LOW       TRG2 
```

用 XML 表示这些数据的最佳方式是什么，以便可以有效地查询它。

我想将这些数据存储在 XML 中，并使用 Java 将其加载到内存中，当消息进入时，我想根据属性识别目标。

感谢任何输入。

谢谢，芒卢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T04:41:33.337

**这是一个纯 XML 表示，可以按原样非常有效地处理**，无需转换为任何其他内部数据结构：

```
<table>
 <record Customer="UTI" Txn-Group="CORP" 
      Txn-Type="ONEOFF" Sender="ABC1" 
      Priority="LOW"  Target="TRG1"/>

 <record Customer="UTI" Txn-Group="Gov" 
      Txn-Type="ONEOFF" Sender="ABC2" 
      Priority="LOW"  Target="TRG2"/>

</table> 
```

**有一种使用[`<xsl:key>`](http://www.w3.org/TR/xslt#key)指令和 XSLT [key()](http://www.w3.org/TR/xslt#function-key)函数**以这种格式查询数据的非常有效的方法：

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes"/>

 <xsl:key name="kRec" match="record"
  use="concat(@Customer,'+',@Sender)"/>

    <xsl:template match="/">
      <xsl:copy-of select="key('kRec', 'UTI+ABC2')"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于上述 XML 文档时，会产生所需的结果**：

```
<record Customer="UTI" 
        Txn-Group="Gov" Txn-Type="ONEOFF" 
        Sender="ABC2" Priority="LOW" 
        Target="TRG2"/> 
```

**请注意以下几点**：

1.  **可以`<xsl:key>`定义多个 s 来**标识使用要连接在一起的不同值组合的记录（无论将被视为“键”和/或“主键”）。

2.  **如果 an`<xsl:key>`被定义为使用“主键”的串联，**则在评估 key() 函数时将找到唯一记录（或没有记录）。

3.  **如果 an`<xsl:key>`被定义为使用“非主键**”的串联，则在评估 key() 函数时可能会找到多个记录。

4.  **The `<xsl:key>` instruction is the equivalent of defining an index in a database**. This makes using the key() function **extremely efficient**.

5.  **In many cases it is not necessary to convert the above XML form to an intermediary data structure**, due neither to reasons of understandability nor of efficiency.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T23:47:03.637

如果您将它加载到内存中，那么 XML 采用何种形式并不重要——我建议让它最容易手动读取或写入。当您将其加载到内存中时，*您*应该将其转换为适当的数据结构。（数据结构的确切性质将取决于需求的确切性质。）

编辑：这是为了反驳 Dimitre 在评论中提出的论点：

我不确定你是否认为我是在建议人们实现他们自己的哈希表——我当然不是。只需为要用作键的每一列保留一个直接的哈希表或[MultiMap 。](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/collect/Multimap.html)开发人员知道如何使用哈希表。

至于运行时效率，您认为哪个效率更高：

*   您构建了一些 XSLT（请记住，对于大多数开发人员而言，至少相对而言，这*是外国领土）*
*   XSLT 引擎解析它。如果您使用的 XSLT 库允许您对现有查询进行参数化，则此步骤*可能是可以避免的。*即便如此，你还有*一些*额外的工作要做。
*   XSLT 引擎命中哈希表（至少您希望如此）并返回一个节点
*   您将节点转换为更有用的数据结构

或者：

*   您根据给定的键在哈希表中查找适当的条目，直接获得有用的数据结构

我个人认为我会相信第二个。在这里使用 XSLT 感觉就像用螺丝刀敲钉子一样……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T23:46:23.110

这取决于重复的内容和可能为空的内容。XML 并不以其高效的可查询性而闻名，因为它既不是固定长度也不是紧凑的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T00:00:53.840

我同意前两张海报的观点——当消息进来时，你绝对不应该在 XML 中保留这些数据的内部表示。

XML 表示可以是任何东西，您可以执行以下操作：

```
<routes>
  <route customer="UTI" txn-group="CORP" txn-type="ONEOFF" .../>
  ...
  </routes> 
```

我的内部表示将取决于传入消息的格式和语言。一个简单的表示将是一个映射，将数据结构（即做出路由决策的关键字段）映射到目标路由上的信息。

根据您的性能要求，您可以将键/目标信息保留为字符串，但在任何高性能系统中，您可能希望进行直接内存比较（在 C/C++ 中）或某种形式的整数比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T00:14:05.913

是的，您的基本问题是您在同一个句子中使用“XML”和“高效”。

编辑：不，说真的，你杀了我。这个线程中的几个人正在使用“高效”来描述与数据格式上的操作有关的*任何事情*，这些操作需要字符串解析来找出你的字段在哪里，这表明这个线程中的几个人甚至不知道什么是“高效”一词的意思。尽可能多地对我投反对票。我可以接受，教练。

# javascript - 如何简化这个 Javascript 函数？

> ID：534809
> 
> 赞同：1
> 
> 时间：2009-02-10T23:40:35.103
> 
> 标签：javascript, jquery

我正在尝试扩展它，但在创建 JS 函数时我有点绿色。我自己设法做到了这一点，但唉......

当跨度获得任何值（在本例中为城市名称）时，我希望选择框自动匹配它。我想通过摆脱所有其他的 if 来扩大规模。

```
$(document).ready(function() {
  $('select#field1 option').removeAttr('selected');
  var whereEvent = $('span#field2').html();
  if (whereEvent == 'New York') {
    $('select#field1 option[value=New York]').attr('selected', 'true');
  } else if (whereEvent == 'Los Angeles') {
    $('select#field1 option[value=Los Angeles]').attr('selected', 'true');
  } else if (whereEvent == 'Tokyo') {
    $('select#field1 option[value=Tokyo]').attr('selected', 'true');
  } else if (whereEvent == 'London') {
    $('select#field1 option[value=London]').attr('selected', 'true');
  } else if (whereEvent == 'Sydney') {
    $('select#field1 option[value=Sydney]').attr('selected', 'true');
  } else if (whereEvent == 'Paris') {
    $('select#field1 option[value=Paris]').attr('selected', 'true');
  }
}); 
```

有人可以帮我吗？我保证我会感谢你的帮助。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-10T23:44:52.253

这是一个选项：

```
 $(document).ready(function() {
      $('select#field1 option').removeAttr('selected');
      var whereEvent = $('span#field2').html();
      var filter = 'select#field1 option[value=' + whereEvent + ']';
      $(filter).attr('selected', 'true');
   } 
```

或者你可以这样做：

```
 $(document).ready(function() {
      var filter = $('span#field2').html();
      $('select#field1 option').each(function(){
           this.selected = (this.value == filter);
      });
   } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-10T23:42:59.560

也许：

```
$('select#field1 option').removeAttr('selected');
var whereEvent = $('span#field2').html();
$('select#field1 option[value='+whereEvent+']').attr('selected', 'true'); 
```

?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T23:44:11.103

我不知道 jQuery，所以可能有一种更优雅的方式，但是：

```
var whereEvent = $('span#field2').html();
$('select#field1 option[value=' + whereEvent + ']').attr('selected', 'true'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-09T00:17:34.890

这至少会起作用，而且看起来也很合乎逻辑。

```
$(document)
.ready(function () {
$("select#field1 option")
    .removeAttr("selected");
var a = $("span#field2")
    .html();
a == "New York" ? $("select#field1 option[value=New York]")
    .attr("selected", "true") : a == "Los Angeles" ? $("select#field1 option[value=Los Angeles]")
    .attr("selected", "true") : a == "Tokyo" ? $("select#field1 option[value=Tokyo]")
    .attr("selected", "true") : a == "London" ? $("select#field1 option[value=London]")
    .attr("selected", "true") : a == "Sydney" ? $("select#field1 option[value=Sydney]")
    .attr("selected", "true") : a == "Paris" && $("select#field1 option[value=Paris]")
    .attr("selected", "true")
}) 
```

# c# - “手动”加载 AAC / MP3 文件

> ID：534824
> 
> 赞同：5
> 
> 时间：2009-02-10T23:46:13.483
> 
> 标签：c#, c#-3.0, mp3, decoding

对于我正在创建的应用程序，我需要能够读取 AAC 和 MP3 文件并获取波形数据（不是直接播放，我需要在播放前对数据进行操作）。理想情况下，我应该能够读取任何 MP3/AAC 文件（VBR、不同比特率等），或者至少可以读取任何可能出现在 iTunes 中的文件。

正如 Chuck 所说，最后一点非常重要。我以为 iTunes 会是 MP3，我不知道他们使用 AAC。本质上，我必须能够阅读 iTunes 中的任何内容。

您建议我使用什么方法？
那里有什么样的图书馆？

这是用于将在 Windows 上运行的商业应用程序，使用 C# 3.0 编写。我可以使用开源库，但没有任何许可证可以让我稍后发布我的源代码。

任何指针都非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-10T23:51:13.520

看看获得[LGPL](http://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License)许可的[mpg123 。](http://www.mpg123.org/)

还有[MAD](http://www.underbit.com/products/mad/)，这是 GPL 但可以协商商业许可。

对于 AAC，有[FAAD2](http://www.audiocoding.com/faad2.html)，但它是 GPL。不确定其他条款是否可用。另一个查询来源可能是检查维基百科上此[AAC 软件列表中使用的来源和许可证。](http://en.wikipedia.org/wiki/Advanced_Audio_Coding#Software)

# asp.net - 后台任务仍然有缓存？或 SO 团队发现问题

> ID：534832
> 
> 赞同：0
> 
> 时间：2009-02-10T23:49:22.900
> 
> 标签：asp.net, asp.net-mvc, background

我即将使用 Jeff[在 Asp.Net 中发布的关于 Easy Background Task 的](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/)内容。我想知道 SO 是否仍在使用它，或者他们发现解决方案存在问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-15T01:09:56.383

我在 UserVoice 中询问，Jeff 回答我他们使用“HTTP 请求服务”。

# python - 如何在 Python 中创建 GUID/UUID

> ID：534839
> 
> 赞同：939
> 
> 时间：2009-02-10T23:51:21.473
> 
> 标签：python, uuid, guid, uniqueidentifier

如何在 Python 中创建独立于平台的 GUID？我听说有一种在 Windows 上使用 ActivePython 的方法，但它只是 Windows，因为它使用 COM。有没有使用普通 Python 的方法？

* * *

## 回答 #1

> 赞同：1145
> 
> 时间：2009-02-10T23:54:26.040

> [uuid 模块](https://docs.python.org/3/library/uuid.html)提供不可变的UUID 对象（UUID 类）和函数[`uuid1()`](https://docs.python.org/3/library/uuid.html#uuid.uuid1), [`uuid3()`](https://docs.python.org/3/library/uuid.html#uuid.uuid3), [`uuid4()`](https://docs.python.org/3/library/uuid.html#uuid.uuid4),用于生成[RFC 4122](https://www.rfc-editor.org/rfc/rfc4122)[`uuid5()`](https://docs.python.org/3/library/uuid.html#uuid.uuid5)中指定的版本 1、3、4 和 5 UUID 。

> 如果您想要的只是一个唯一的 ID，您可能应该调用`uuid1()`或`uuid4()`。**请注意，这`uuid1()`可能会损害隐私，因为它会创建一个包含计算机网络地址的 UUID。** `uuid4()`创建一个随机的 UUID。

文件：

*   [蟒蛇2](https://docs.python.org/2/library/uuid.html)
*   [蟒蛇 3](https://docs.python.org/3/library/uuid.html)

示例（适用于 Python 2 和 3）：

```
>>> import uuid

>>> # make a random UUID
>>> uuid.uuid4()
UUID('bd65600d-8669-4903-8a14-af88203add38')

>>> # Convert a UUID to a string of hex digits in standard form
>>> str(uuid.uuid4())
'f50ec0b7-f960-400d-91f0-c42a6d44e3d0'

>>> # Convert a UUID to a 32-character hexadecimal string
>>> uuid.uuid4().hex
'9fe2c4e93f654fdbb24c02b15259716c' 
```

* * *

## 回答 #2

> 赞同：342
> 
> 时间：2009-02-10T23:55:52.197

如果您使用的是 Python 2.5 或更高版本，则[**uuid 模块**](https://docs.python.org/2/library/uuid.html#module-uuid "uuid 模块")已包含在 Python 标准发行版中。

前任：

```
>>> import uuid
>>> uuid.uuid4()
UUID('5361a11b-615c-42bf-9bdb-e2c3790ada14') 
```

* * *

## 回答 #3

> 赞同：153
> 
> 时间：2014-12-04T19:34:05.913

复制自：[https](https://docs.python.org/3/library/uuid.html) ://docs.python.org/3/library/uuid.html （因为发布的链接不活跃并且不断更新）

```
>>> import uuid

>>> # make a UUID based on the host ID and current time
>>> uuid.uuid1()
UUID('a8098c1a-f86e-11da-bd1a-00112444be1e')

>>> # make a UUID using an MD5 hash of a namespace UUID and a name
>>> uuid.uuid3(uuid.NAMESPACE_DNS, 'python.org')
UUID('6fa459ea-ee8a-3ca4-894e-db77e160355e')

>>> # make a random UUID
>>> uuid.uuid4()
UUID('16fd2706-8baf-433b-82eb-8c7fada847da')

>>> # make a UUID using a SHA-1 hash of a namespace UUID and a name
>>> uuid.uuid5(uuid.NAMESPACE_DNS, 'python.org')
UUID('886313e1-3b8a-5372-9b90-0c9aee199e5d')

>>> # make a UUID from a string of hex digits (braces and hyphens ignored)
>>> x = uuid.UUID('{00010203-0405-0607-0809-0a0b0c0d0e0f}')

>>> # convert a UUID to a string of hex digits in standard form
>>> str(x)
'00010203-0405-0607-0809-0a0b0c0d0e0f'

>>> # get the raw 16 bytes of the UUID
>>> x.bytes
'\x00\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f'

>>> # make a UUID from a 16-byte string
>>> uuid.UUID(bytes=x.bytes)
UUID('00010203-0405-0607-0809-0a0b0c0d0e0f') 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2012-06-11T16:47:53.517

我使用 GUID 作为数据库类型操作的随机键。

带有破折号和额外字符的十六进制形式对我来说似乎不必要地长。但我也喜欢表示十六进制数字的字符串非常安全，因为它们不包含在某些情况下可能导致问题的字符，例如“+”、“=”等。

我使用 url 安全的 base64 字符串而不是十六进制。以下不符合任何 UUID/GUID 规范（除了具有所需的随机性）。

```
import base64
import uuid

# get a UUID - URL safe, Base64
def get_a_uuid():
    r_uuid = base64.urlsafe_b64encode(uuid.uuid4().bytes)
    return r_uuid.replace('=', '') 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2019-06-25T08:38:00.510

如果您需要为模型或唯一字段的主键传递 UUID，则下面的代码将返回 UUID 对象 -

```
 import uuid
 uuid.uuid4() 
```

如果您需要将 UUID 作为 URL 的参数传递，您可以执行以下代码 -

```
import uuid
str(uuid.uuid4()) 
```

如果您想要 UUID 的十六进制值，您可以执行以下操作 -

```
import uuid    
uuid.uuid4().hex 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-16T15:37:23.880

**2019 年答案（适用于 Windows）：**

如果您想要一个在 Windows 上唯一标识机器的永久 UUID，您可以使用这个技巧：（从我在[https://stackoverflow.com/a/58416992/8874388](https://stackoverflow.com/a/58416992/8874388)的答案复制）。

```
from typing import Optional
import re
import subprocess
import uuid

def get_windows_uuid() -> Optional[uuid.UUID]:
    try:
        # Ask Windows for the device's permanent UUID. Throws if command missing/fails.
        txt = subprocess.check_output("wmic csproduct get uuid").decode()

        # Attempt to extract the UUID from the command's result.
        match = re.search(r"\bUUID\b[\s\r\n]+([^\s\r\n]+)", txt)
        if match is not None:
            txt = match.group(1)
            if txt is not None:
                # Remove the surrounding whitespace (newlines, space, etc)
                # and useless dashes etc, by only keeping hex (0-9 A-F) chars.
                txt = re.sub(r"[^0-9A-Fa-f]+", "", txt)

                # Ensure we have exactly 32 characters (16 bytes).
                if len(txt) == 32:
                    return uuid.UUID(txt)
    except:
        pass # Silence subprocess exception.

    return None

print(get_windows_uuid()) 
```

使用 Windows API 获取计算机的永久 UUID，然后处理字符串以确保它是有效的 UUID，最后返回一个 Python 对象（[https://docs.python.org/3/library/uuid.html](https://docs.python.org/3/library/uuid.html)），这给您提供了方便使用数据的方式（如 128 位整数、十六进制字符串等）。

祝你好运！

PS：子进程调用可能会替换为直接调用 Windows 内核/DLL 的 ctypes。但就我的目的而言，这个功能就是我所需要的。它进行强大的验证并产生正确的结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-19T09:11:09.287

要创建唯一 id，您应该使用 UUID 包：了解有关 UUID 的更多信息：访问：[https ://www.copilotcode.com/2021/12/get-unique-id-string-or-numberuuid-in.html](https://www.copilotcode.com/2021/12/get-unique-id-string-or-numberuuid-in.html)

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2018-02-24T17:11:18.880

此函数是完全可配置的，并根据指定的格式生成唯一的 uid

例如：- [8, 4, 4, 4, 12] ，这是提到的格式，它将生成以下 uuid

> **LxoYNyXe-7hbQ-caJt-DSdU-PDAht56cMEWi**

```
 import random as r

 def generate_uuid():
        random_string = ''
        random_str_seq = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
        uuid_format = [8, 4, 4, 4, 12]
        for n in uuid_format:
            for i in range(0,n):
                random_string += str(random_str_seq[r.randint(0, len(random_str_seq) - 1)])
            if n != 12:
                random_string += '-'
        return random_string 
```

* * *

## 回答 #9

> 赞同：-9
> 
> 时间：2019-12-05T11:28:52.677

看看[这个](https://www.geeksforgeeks.org/generating-random-ids-python/)帖子，对我帮助很大。简而言之，对我来说最好的选择是：

```
import random 
import string 

# defining function for random 
# string id with parameter 
def ran_gen(size, chars=string.ascii_uppercase + string.digits): 
    return ''.join(random.choice(chars) for x in range(size)) 

# function call for random string 
# generation with size 8 and string  
print (ran_gen(8, "AEIOSUMA23")) 
```

因为我只需要 4-6 个随机字符而不是笨重的 GUID。

# .net - 是否存在 WPF .NET 3.0 日期选择器？

> ID：534845
> 
> 赞同：4
> 
> 时间：2009-02-10T23:53:33.093
> 
> 标签：.net, wpf, datepicker

我试图找到一个 WPF 3.0 日期选择器控件。你可以推荐什么，它在哪里？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-10T23:56:58.327

[WPF 工具包](http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25047)包含一个 DatePicker 控件。

**编辑：**我忘了添加一个指向[DatePicker 演练](http://windowsclient.net/wpf/wpf35/wpf-35sp1-toolkit-calendar-datepicker-walkthrough.aspx)的链接，以了解如何使用它。

**更新：** Microsoft 没有在 .Net 3.0 上运行的 DatePicker 控件。您可以购买第三方 DatePicker 控件，例如[Telerik 的 DatePicker](http://www.telerik.com/products/wpf/datepicker.aspx)，或者您可以从[开源 DatePicker](http://marlongrech.wordpress.com/2008/04/04/avaloncontrolslibrary-datepicker-refactored/)实现开始并自行开发。免责声明：我没有使用任何第三方 DatePicker 控件，因此我无法保证它们的质量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T10:40:01.057

Kevin 的 WPF bag-o-tricks 中有一个免费的日期选择器控件，网址为[http://j832.com/bagotricks/](http://j832.com/bagotricks/)

并且在 MS WPF 工具包中有 Franci Penov 说的。

我过去使用过bag-o-tricks，它有效，但并不完美。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T01:51:59.033

本书第 25 章中的 Applications = Code + Markup (Charles Petzold) 有一个 datePicker 控件，Microsoft 团队已将其转换为 VB.net。该控件是为 .Net 3.0 编写的。这是控件和源代码的链接。

[http://code.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=petzoldsamplevb&DownloadId=244](http://code.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=petzoldsamplevb&DownloadId=244)

# c# - ASP.NET - 交换布尔值的简单方法？

> ID：534846
> 
> 赞同：1
> 
> 时间：2009-02-10T23:53:39.143
> 
> 标签：c#, asp.net, datagrid

背景：我使用的是 ASP.NET 2.0（使用 C#），下面的代码嵌入在 DataGrid 控件中。我的 .aspx 文件中有以下内容：

```
 <ASP:TEMPLATECOLUMN HeaderText="Includes CRS Statement?">       
            <ITEMTEMPLATE>
                <asp:RadioButtonList id="rblSCIncludesCRSStatement" runat="server" RepeatDirection="Horizontal"
                SelectedIndex='<%# Convert.ToInt32(DataBinder.Eval(Container, "DataItem.CRS_Included")) %>'
                DataValueField="CRS_Included" RepeatLayout="Flow">
                  <asp:ListItem value="true" selected="true">Yes</asp:ListItem>
                  <asp:ListItem value="false">No</asp:ListItem>
                  </asp:RadioButtonList>
            </ITEMTEMPLATE>
        </ASP:TEMPLATECOLUMN>
        <ASP:BOUNDCOLUMN visible="false" HeaderText="IncludesCRSStatement" DataField="CRS_Included"></ASP:BOUNDCOLUMN> 
```

它应该将布尔值 CRS_Included 与 RadioButtonList 绑定。它有效，但顺序相反。是变成否，否变成是，我能看到解决它的唯一方法是交换 ListItems 的顺序，这将是违反直觉的（单选按钮不应该像否/是的那样开始，它需要是/否）。

有谁知道一种快速方法（最好使用 .NET 函数）将 0 换成 1、1 换成 0 并无缝解决问题？或者，有没有更好的方法来编写 SelectedIndex 代码？

任何帮助表示赞赏:-)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-10T23:54:54.477

```
SelectedIndex='<%# 1 - Convert.ToInt32(...) %> 
```

1 - 0 = 1；1 - 1 = 0。交换的案例:)

编辑：可能有更好的方法来处理更一般的问题 - 这只是解决 1/0 交换的简单方法:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-10T23:58:21.350

为什么不使用 SelectedValue 属性而不是 SelectedIndex。？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T00:03:22.647

您是否尝试过使用 SelectedValue 而不是 SelectedIndex。

（来自 MSDN）SelectedValue 属性还可用于通过设置项目的值来选择列表控件中的项目。

# python - 在 Python 中减去 2 个列表

> ID：534855
> 
> 赞同：96
> 
> 时间：2009-02-10T23:57:22.270
> 
> 标签：python, list, tuples, vector

现在，我将 vector3 值表示为列表。有没有办法减去其中的 2 个，比如 vector3 值，比如

```
[2,2,2] - [1,1,1] = [1,1,1] 
```

我应该使用元组吗？

如果它们都没有在这些类型上定义这些操作数，我可以定义它吗？

如果没有，我应该创建一个新的 vector3 类吗？

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2009-02-11T00:00:52.217

如果这是你经常做的事情，并且有不同的操作，你可能应该创建一个类来处理这样的情况，或者更好地使用像[Numpy](http://numpy.scipy.org/)这样的库。

否则，查找与[zip](http://docs.python.org/library/functions.html#zip)内置函数一起使用的[列表推导：](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)

```
[a_i - b_i for a_i, b_i in zip(a, b)] 
```

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2009-02-11T00:19:03.997

这是列表推导的替代方法。Map 遍历列表（后面的参数），同时进行，并将它们的元素作为参数传递给函数（第一个参数）。它返回结果列表。

```
import operator
map(operator.sub, a, b) 
```

这段代码因为语法较少（这对我来说更美观），而且显然它对于长度为 5 的列表要快 40%（参见 bobince 的评论）。不过，任何一种解决方案都可以。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-11T00:17:55.827

如果您的列表是 a 和 b，您可以执行以下操作：

```
map(int.__sub__, a, b) 
```

但你可能不应该。没有人会知道这意味着什么。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-11T07:59:28.290

我也必须推荐[NumPy](http://numpy.scipy.org/)

不仅做矢量数学更快，而且它还有大量的便利功能。

如果您想要更快的一维向量，请尝试[vop](http://www.excamera.com/articles/25/vop.html)

它类似于 MatLab，但免费。这是您要执行的操作的示例

```
from numpy import matrix
a = matrix((2,2,2))
b = matrix((1,1,1))
ret = a - b
print ret
>> [[1 1 1]] 
```

繁荣。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-11-09T20:38:35.553

```
import numpy as np
a = [2,2,2]
b = [1,1,1]
np.subtract(a,b) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-10T23:59:49.707

如果您有两个名为“a”和“b”的列表，您可以执行以下操作：`[m - n for m,n in zip(a,b)]`

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-11T02:44:23.493

稍有不同的 Vector 类。

```
class Vector( object ):
    def __init__(self, *data):
        self.data = data
    def __repr__(self):
        return repr(self.data) 
    def __add__(self, other):
        return tuple( (a+b for a,b in zip(self.data, other.data) ) )  
    def __sub__(self, other):
        return tuple( (a-b for a,b in zip(self.data, other.data) ) )

Vector(1, 2, 3) - Vector(1, 1, 1) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-11T00:03:52.600

如果您计划执行的不仅仅是简单的单行，最好实现自己的类并覆盖适用于您的案例的适当运算符。

取自[Python 中的数学](http://www.math.okstate.edu/~ullrich/PyPlug/)：

```
class Vector:

  def __init__(self, data):
    self.data = data

  def __repr__(self):
    return repr(self.data)  

  def __add__(self, other):
    data = []
    for j in range(len(self.data)):
      data.append(self.data[j] + other.data[j])
    return Vector(data)  

x = Vector([1, 2, 3])    
print x + x 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-02-08T17:44:28.647

对于曾经在 Pycharm 上编写代码的人来说，它也可以让其他人恢复活力。

```
 import operator
 Arr1=[1,2,3,45]
 Arr2=[3,4,56,78]
 print(list(map(operator.sub,Arr1,Arr2))) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-02-22T03:09:06.483

`map`Python 中的和函数的组合`lambda`很好的解决了这类问题：

```
a = [2,2,2]
b = [1,1,1]
map(lambda x,y: x-y, a,b) 
```

`zip`函数是另一个不错的选择，正如@UncleZeiv 所证明的那样

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-07-30T22:00:27.227

已经提出了许多解决方案。

如果对速度感兴趣，这里是关于速度的不同解决方案的回顾（从最快到最慢）

```
import timeit
import operator

a = [2,2,2]
b = [1,1,1]  # we want to obtain c = [2,2,2] - [1,1,1] = [1,1,1

%timeit map(operator.sub, a, b)
176 ns ± 7.18 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)

%timeit map(int.__sub__, a, b)
179 ns ± 4.95 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)

%timeit map(lambda x,y: x-y, a,b)
189 ns ± 8.1 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)

%timeit [a_i - b_i for a_i, b_i in zip(a, b)]
421 ns ± 18.4 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)

%timeit [x - b[i] for i, x in enumerate(a)]
452 ns ± 17.2 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each

%timeit [a[i] - b[i] for i in range(len(a))]
530 ns ± 16.7 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)

%timeit list(map(lambda x, y: x - y, a, b))
546 ns ± 16.1 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)

%timeit np.subtract(a,b)
2.68 µs ± 80.9 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)

%timeit list(np.array(a) - np.array(b))
2.82 µs ± 113 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)

%timeit np.matrix(a) - np.matrix(b)
12.3 µs ± 437 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each) 
```

使用`map`显然是最快的。令人惊讶的是，`numpy`是最慢的。事实证明，首先将列表转换为数组的成本`a`是`b`一个`numpy`瓶颈，它超过了向量化带来的任何效率提升。

```
%timeit a = np.array([2,2,2]); b=np.array([1,1,1])
1.55 µs ± 54.9 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)

a = np.array([2,2,2])
b = np.array([1,1,1])
%timeit a - b
417 ns ± 12.8 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-07-21T04:18:39.657

```
arr1=[1,2,3]
arr2=[2,1,3]
ls=[arr2-arr1 for arr1,arr2 in zip(arr1,arr2)]
print(ls)
>>[1,-1,0] 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-07-15T12:19:33.847

这个答案显示了如何编写“正常/易于理解”的 pythonic 代码。

我建议不要使用`zip`，因为并不是每个人都知道它。

解决方案使用[列表推导](https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions)和常见的内置函数。

* * *

## 备选方案 1（推荐）：

```
a = [2, 2, 2]
b = [1, 1, 1]
result = [a[i] - b[i] for i in range(len(a))] 
```

*推荐，因为它只使用 Python 中最基本的函数*

* * *

## 备选方案 2：

```
a = [2, 2, 2]
b = [1, 1, 1]
result = [x - b[i] for i, x in enumerate(a)] 
```

* * *

## 备选方案 3（如[BioCoder 所述](https://stackoverflow.com/questions/534855/subtracting-2-lists-in-python/54819502#54819502)）：

```
a = [2, 2, 2]
b = [1, 1, 1]
result = list(map(lambda x, y: x - y, a, b)) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-07T19:40:37.343

使用 for 循环

```
a = [3,5,6]
b = [3,7,2]

c = []

for i in range(len(a)):
     c.append(a[i] - b[i])

print(c) 
```

输出 [0, -2, 4]

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2021-03-08T17:34:51.117

好简单

```
list1=[1,2,3,4,5]
list2=[1,2]
list3=[]
# print(list1-list2)

for element in list1:
    if element not in list2:
       list3.append(element)

print(list3) 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2009-10-09T12:03:44.343

试试这个：

```
list(array([1,2,3])-1) 
```

# xslt - 自动将转义字符转换为字符串文字

> ID：534859
> 
> 赞同：2
> 
> 时间：2009-02-10T23:58:40.490
> 
> 标签：xslt, xslt-2.0

我正在研究 XSLT 转换以重新排列 XML 块以验证 NewsML 文件。其中一些文件包含编码字符（例如 & " 等...）。问题是 XSLT 转换将这些字符转换为它们的文字字符串（即“and”、“'”）。这导致了问题。我不希望这种情况发生。

我已经尝试了各种技术（使用 <xsl:text>、<xsl:value-of> 和禁用输出转义标志、<xsl:output method='xml|html|xhtml|text'>）利用。这些方法要么转换字符，要么简单地将它们排除在外。

例如，以“PM&’s card 上的星号”开头的字符串可以结束为

*   PM卡片上的星星
*   PM卡上的星星

我正在使用 Saxonica ( [http://www.saxonica.com/](http://www.saxonica.com/) ) 处理应用程序。

下面提供了我正在使用的基本 XSLT。（还有其他事情，但即使使用这个最简单的样式表也存在问题）

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="no" />
   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

任何关于如何防止这种转换的想法将不胜感激。要求是保留原始文本的外观。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T00:31:10.460

我认为您需要同时执行 disable-output-escaping="yes" 并将文档设置为 HTML。

来自 W3C（强调我的）：

对于用于结果树中文本节点以外的其他内容的文本节点，禁用输出转义是错误的。因此，禁用用于生成注释、处理指令或属性节点的字符串值的 xsl:value-of 或 xsl:text 元素的输出转义是错误的；如果结果树片段包含禁用转义的文本节点，则将结果树片段转换为数字或字符串也是错误的。在这两种情况下，XSLT 处理器都可能发出错误信号。**如果它没有发出错误信号，它必须通过忽略 disable-output-escaping 属性来恢复。**

disable-output-escaping 属性可以与 html 输出方法以及 xml 输出方法一起使用。文本输出方法忽略 disable-output-escaping 属性，因为它不执行任何输出转义。

XSLT 处理器只有在控制结果树的输出方式时才能禁用输出转义。情况可能并非总是如此。例如，结果树可以用作另一个 XSLT 转换的源树而不是输出。XSLT 处理器不需要支持禁用输出转义。如果 xsl:value-of 或 xsl:text 指定应禁用输出转义并且 XSLT 处理器不支持此功能，则 XSLT 处理器可能会发出错误信号；如果它没有发出错误信号，它必须通过不禁用输出转义来恢复。

如果对无法在 XSLT 处理器用于输出的编码中表示的字符禁用输出转义，则 XSLT 处理器可能会发出错误信号；如果它没有发出错误信号，它必须通过不禁用输出转义来恢复。

由于**禁用输出转义可能不适用于所有 XSLT 处理器**，并且可能导致 XML 格式不正确，因此只有在别无选择时才应使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T00:44:28.553

这些是[实体](http://www.xml.com/pub/a/98/08/xmlqna0.html)。通常[它们被映射](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references)到该实体的 unicode 表示。最终流将只包含字符。如果您输出流，则取决于输出类型（您可以使用 disable-output-escaping 禁用），由序列化程序来转义字符。所以一个合适的序列化器应该把这个

```
<xsl:output method="html" encoding="UTF-8"/>
<xsl:text>some&#160;test</xsl:text> 
```

进入

```
some&nbsp;test 
```

请参阅[本文](http://www.oreillynet.com/pub/a/oreilly/java/news/javaxslt_0801.html)的第 5 节。

所以我会先用你的 XSLT 处理器检查一下。

# xml - 如何在 XSL for-each 测试中引用当前节点值？

> ID：534860
> 
> 赞同：28
> 
> 时间：2009-02-10T23:58:43.017
> 
> 标签：xml, xslt, xpath

假设我有一个这样的 XML 文档：

```
<books>
    <book>1110</book>
    <book>1111</book>
    <book>1112</book>
    <book>1113</book>
</books> 
```

我正在尝试设置一个条件来测试 中当前节点的值`for-each`，但我做错了：

```
<xsl:for-each select="/books/book">
    <xsl:if test=".[='1112']">
        Success
    </xsl:if>
</xsl:for-each> 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-11T00:03:01.853

确实，使用`.`可以引用当前（或“上下文”）节点，但不是您在此处使用它的方式。在 XPath 中，`.[foo]`不是有效的语法——您需要使用它`self::node()[foo]`来代替。此外，`=`操作员需要匹配的东西，在这种情况下`text()`选择器来访问元素的文本内容：

```
<xsl:for-each select="/books/book">
    <xsl:if test="self::node()[text()='1112']">
        Success
    </xsl:if>
</xsl:for-each> 
```

但是，正如其他答案中所述，除非您`for-each`还执行其他操作，否则您根本不需要迭代并且可以使用`if`来完成相同的任务：

```
<xsl:if test="/books/book[. = 1112]">
    Success
</xsl:if> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-11T02:44:46.673

> 我正在尝试设置一个条件来测试 for-each 中当前节点的值，但我做错了：

**不正确的第一件事是语法**：

```
 .[='1112'] 
```

**这里有两件事不对**：

1.  **在 [ 和 ] 中没有谓词**：“=”运算符需要两个参数，但只提供一个。

2.  **`.[x = y]`仍然是无效的语法，尽管谓词是 OK**。这必须指定为：

    self::node()[条件]

**提供的代码**中可以改进****的第二件事**是`<xsl:for-each>`指令，这根本不是必需的；一个 XPath 表达式就足够了。**

 ****总而言之**，计算结果为所需布尔值的一种可能的 XPath 表达式是：

```
 /books/book[. = '1112'] 
```

**如果确实有必要在`<xsl:for-each>`**指令内测试条件，那么我将使用的一个正确的 XPath 表达式是：

```
 . = '1112' 
```

**以上**是字符串比较，如果周围有空格，**可能无法评估。`true()`**因此，**数值比较可能会更好**：

```
 . = 1112 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T00:09:34.940

虽然 Ben 正确回答了您的问题，但使用 for-each 绝对是错误的一般方法。毕竟这是 XSLT。所以你可能更多地寻找这样的东西：

```
<xsl:if test="/books/book[text()='1112']">
  Success
</xsl:if> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-23T07:26:24.363

XSLT 有一个专门针对这个问题的功能。

[http://www.w3.org/TR/xslt#function-current](http://www.w3.org/TR/xslt#function-current)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-15T10:52:53.600

试试这个

```
<xsl:for-each select="/books/book">
    <xsl:if test="current() = '1112'">
        Success
    </xsl:if> 
</xsl:for-each> 
```

# c++ - 在 Xcode 中编译 C++ 类：编译期间出错：stl vector

> ID：534861
> 
> 赞同：10
> 
> 时间：2009-02-10T23:58:45.140
> 
> 标签：c++, xcode, porting

我有一个 C++ 类，可以在带有 gcc 的 linux 和 Visual Studio 中的寡妇上很好地编译。

boid.h：

```
#ifndef BOID_CLASS_HEADER_DEFINES_H
#define BOID_CLASS_HEADER_DEFINES_H
#include "defines.h"

class Boid {

public:
     // Initialize the boid with random position, heading direction and color
     Boid(float SceneRadius,float NormalVel);

     .....
protected:
     ...
};

#endif 
```

在 boid.cpp 中：

```
#include "Boid.h"

// Initialize the boid with random position, heading direction and color
Boid::Boid(float SceneRadius,float NormalVel) 
{
    ....
} 
```

但是，当我在 Xcode 中编译此代码时出现以下错误：

```
Compiling Boid.h: "error: vector: No such file or directory" 
```

有任何想法吗？我认为您可以使用 C/C++ 代码并在 Xcode 中编译它而不会出现问题？

谢谢

**编辑**：添加了defines.h（还添加了#endif到示例，但这是在原始代码中）

**编辑2**：在注释掉几个包含空的包含后，我得到了一个不同的错误：上面的向量错误。

```
#ifndef BOID_NAV_DEFINES_H
#define BOID_NAV_DEFINES_H
#include <stdlib.h>
#include <vector>
#include "Vector3d.h"
#include "Point3d.h"
#include "win_layer.h"
#endif 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-11T00:29:19.840

您是否在 .m 文件中包含 C++ 标头？

.m 文件被视为具有 Objective-C 扩展名的 .c 文件。

.mm 文件被视为具有 Objective-C 扩展名的 .cpp 文件，然后它被称为 Objective-C++

只需将任何 .m 文件重命名为 .mm，右键单击或按住 ctrl 单击并在 Xcode 中选择文件上的重命名。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-05-14T16:51:33.190

在不将任何 .m 更改为 .mm 或类似内容的情况下，如果您单击项目，请单击 tagets->build settings 一直到**“LLVM GCC 4.2 - Languages”**（新的 xcode 说**“Apple LLVM compiler 4.2”**）你将看到**Compile Sources As**将该值更改为**Objective-C++**；

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T00:23:15.533

确保将其编译为 C++。右键单击 XCode 中的文件并选择**Get Info**并确保将**File Type**设置为**sourcecode.cpp.cpp**以用于实现文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-09-19T06:21:20.783

我希望这将有所帮助。将 xCode 更新到版本 10 后，我遇到了包括 <map> 和 <vector> 库在内的问题。通过更改项目的构建设置（目标的构建设置）中的 C++ 库类型找到了一个简单的解决方案：

**C++ 标准库：libc++（支持 C++ 11 的 LLVM C++ 标准库）**

编译没有任何问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T00:32:49.550

假设您正在谈论使用 gcc 进行实际编译的 OS X XCode。所以这和 Linux 应该没有区别，除了 gcc 的版本可能不同。

这里让我感到震惊的第一件事是您输入了“boid.h”作为文件名，但您包含了“Boid.h”。假设这不是一个错字，我希望这会在 Linux 和 OS X 上造成麻烦......

编辑回答新问题：嗯...矢量绝对是 Xcode 的一部分：`/Developer/SDKs/MacOSX10.5.sdk/usr/include/c++/4.0.0/vector`在我的机器上。

进一步思考：如果您将源代码和 makefile 从 Linux 构建移植到 Mac，您可能只需像在 Linux 上一样从命令行编译它......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-11T00:07:06.570

不确定您是否忘记粘贴，但您有一个未终止的#ifndef

*define.h*里面有什么？

**编辑：**您似乎已经找到了解决方案。再说一句：

```
#include <stdlib.h> 
```

对于 C++，请：

```
#include <cstdlib> 
```

:D

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T00:11:33.097

毫无疑问，defines.h 中的某些内容正在影响类定义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T00:53:23.540

这个问题有两个错误：

*   我的一个包含有一个错字导致编译错误
*   未找到矢量错误已由 .m 文件修复为 .mm

# winapi - 声音处理：我应该使用 DirectSound 还是直接使用 Win32 API？

> ID：534865
> 
> 赞同：4
> 
> 时间：2009-02-11T00:00:46.553
> 
> 标签：winapi, audio, audio-recording, directsound, audio-player

我正在申请我将：

*   从麦克风录制并对输入进行一些实时处理
*   播放 MP3 文件（一首普通歌曲），但实时处理输出
*   有时我也需要在这首歌上播放额外的声音，但我想我可以通过简单地添加缓冲区来做到这一点。

简而言之，我需要有用于录制和播放的循环缓冲区，并且我需要每 20 毫秒左右向输出缓冲区“输入”即将播放的新数据。

我一直在研究 DirectSound，它似乎并没有多大帮助。对输出缓冲区的读取和写入似乎与 Win32 非常相似，它似乎有帮助的唯一地方是在主歌曲上播放“附加声音”。

我应该使用 DirectSound，还是应该直接使用原始 Windows API？
DirectSound 会为我做些什么吗？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T00:25:14.327

Directsound API 为您提供更好的实时控制。它们也是在 Windows 中使用声音的受支持方式。我的印象是 win32 api 已被弃用，但我可能错了。

这个问题和你很接近

[https://stackoverflow.com/questions/314522/what-is-the-best-c-sound-api-for-windows](https://stackoverflow.com/questions/314522/what-is-the-best-c-sound-api-for-windows)

还

[DirectSound 是 Windows 的最佳音频抽象层吗？](https://stackoverflow.com/questions/158282/is-directsound-the-best-audio-abstraction-layer-for-windows)

最后但并非最不重要的一点是，这是微软必须说的 [http://msdn.microsoft.com/en-us/library/dd370784(VS.85).aspx](http://msdn.microsoft.com/en-us/library/dd370784(VS.85).aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T00:32:27.350

两者都不？:)

故事是 DirectSound 是 waveOut 的替代品，但 DirectSound 在 Vista 中作为已弃用的 API 加入 DirectInput 并被[WASAPI](http://en.wikipedia.org/wiki/Technical_features_new_to_Windows_Vista#Audio_stack_architecture)取代。DirectSound 和 waveOut 在 Vista 中的用户空间 WASAPI 之上实现。在 XP 上，waveOut 和 DirectSound 提供给同一个内核级别的 Mixer API。

要整合所有这些接口，请看一下 OpenAL 之类的东西，它是一种与 OpenGL 相同的受良好支持的音频标准。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T00:27:13.993

听起来您将对延迟非常敏感。看看[ASIO可能是值得的](http://en.wikipedia.org/wiki/Audio_Stream_Input/Output)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-11T00:25:50.707

我找到了[Harmony Central - 音频编程](http://www.harmony-central.com/Computer/Programming/)。另请阅读[w:DirectSound](http://en.wikipedia.org/wiki/DirectSound)。

> Windows Vista 具有基于通用音频体系结构的完全重写的音频堆栈。由于重新设计的音频堆栈中的体系结构更改，从 DirectSound 到音频驱动程序的直接路径不存在。
> 
> 由于 Xbox 360 和 Microsoft Windows 的集成，Microsoft 正在积极推动开发人员将新应用程序迁移到等效的 Xbox 音频 API，例如 XAudio 和 XACT。

[OpenAL](http://connect.creativelabs.com/openal/default.aspx)看起来很有希望。

# php - Zend Form：我如何让它服从我的意志？

> ID：534870
> 
> 赞同：42
> 
> 时间：2009-02-11T00:01:23.090
> 
> 标签：php, zend-framework, zend-form

我已经阅读了很多次手册，我搜索了谷歌提供的关于这个主题的帖子，我什至买了几本关于 ZF 的书。现在，为什么我仍然感到困惑？

我可以使用 Zend_Form 制作一个验证和运行良好的表单。我不能做的就是使表单看起来与我希望它看起来与我希望它具有的错误消息完全一样。我想要自定义按钮，我想要时髦的布局，我想要在表单中间插入文本，等等。

有没有人有一种简单的方法来实现这些事情？让我觉得框架节省了我时间而不是成本的东西？我可以放弃 Zend Form... 制作我自己的表单，让它的动作点击一个页面来验证和处理发布的数据，我可以尽可能快地完成它，但我真的想“得到”这个并且能够按照明显的意图使用它。

有什么建议吗？对于自定义按钮、时髦布局和基本（或者相当高级，因为有大量基本教程跳过了更难的问题）“完成工作”有任何简单的“如何”使用 zend 表单？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-08T00:07:08.690

Barrett Conrad 的建议正是我所建议的。另外，请记住，您不需要使用表单对象来呈现您的表单。

您可以做的一件事是在您的视图脚本中创建一个表单，该表单具有与表单类同名的元素。

您的 HTML 表单：

```
<form action="/login/" method="post">
<fieldset>
    <label for="username">Username:</label>
    <input type="text" size="10" name="username" />
    <label for="password">Password:</label>
    <input type="password" size="10" name="password" />
    <input type="submit" />
</fieldset>
</form> 
```

你的班：

```
class LoginForm extends Zend_Form
{
    public function init()
    {
        $username = $this->createElement('text','username');
        $username->setRequired(true);
        $this->addElement($username);

        $password = $this->createElement('password','password');
        $password->setRequired(true);
        $this->addElement($password);        
    }
} 
```

您的表单类反映了您的 HTML 表单，类中的每个元素都有自己的验证器和要求。回到您的操作中，您可以创建表单类的实例并针对该表单验证您的 post/get vars：

```
$form = new LoginForm();
if ($this->_request->isPost()) {
    if ($form->isValid($this->_request->getParams())) {
        // do whatever you need to do
    } else {
        $this->view->errors = $form->getMessages();
    }
} 
```

您可以使用此方法在一组表单的顶部显示错误消息。

这是一个基本示例，但它允许您完全控制表单的呈现方式，而无需花时间学习使用装饰器。在我看来，Zend_Form 的大部分优势在于它的验证和过滤属性。这给了你力量。像这样的解决方案的主要缺点是您的视图脚本 HTML 表单可能与您的表单类不同步。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-03-20T20:12:59.130

在您的视图中单独渲染每个元素 - 例如

```
<!-- view script here -->
<form method="POST">
Name: <?php echo $this->myForm->getElement('name')->render(); ?>
some other text between the fields
Birthdate: <?php echo $this->myForm->getElement('birthdate')->render(); ?>
<input type="submit" />
</form> 
```

这保持了使用 Zend_Form 视图助手的能力（即显示错误消息并在验证失败时维护表单字段的值），但为您提供了完全的定制能力。

如果您想更进一步，请关闭各个表单元素的默认装饰器，然后附加您自己的以进一步自定义使用的标签（即错误消息和标签）或根本不使用装饰器（其他而不是渲染表单元素本身）然后手动编写所有周围的 HTML。完整的定制能力，而不会失去 Zend_Form 的好处，无论是在表单级别还是在视图级别。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-08T15:35:56.987

Matthew Weier O'Phinney 已经开始了一系列关于 Zend_Form 装饰器的博客文章：

1.  [最简单的 Zend_Form 装饰器](http://weierophinney.net/matthew/archives/212-The-simplest-Zend_Form-decorator.html)
2.  [从内到外：如何分层装饰器](http://weierophinney.net/matthew/archives/213-From-the-inside-out-How-to-layer-decorators.html)
3.  [单独渲染 Zend_Form 装饰器](http://weierophinney.net/matthew/archives/215-Rendering-Zend_Form-decorators-individually.html)
4.  [创建复合元素](http://weierophinney.net/matthew/archives/217-Creating-composite-elements.html)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-11T00:19:39.800

目前我们已经有了新的和闪亮的`Zend\Form`，它比旧的组件更复杂，但也更可控、封装和强大。所以，我下面说的不适用。恕我直言，新组件是一个巨大的改进，因为它...

*   ...让您完全控制要如何呈现表单，您需要编写更多视图代码，但这是值得的
*   ...最大限度地分离数据、逻辑和视图
*   ...利用 HTML5 表单元素
*   ...为您提供了许多选择如何将表单组合在一起，例如水合作用、注释等。

### 关于 Zend_Form 的旧答案

我真的帮不上忙，可能是因为我有完全相同的问题。我认为 Zend_Form 装饰器很强大，但到目前为止我见过的 ZF 中对程序员最不友好和不直观的部分，我在各种项目中使用了 ZF 的主要部分。

也就是说，我只能从我的经验中给出一些提示：

*   过滤器易于使用，无需使用表单
*   您想要实现的大多数（如果不是全部）事情都是在装饰器的帮助下完成的
*   我从小表格开始，一点一点地添加东西，但我没有在我的一些表格中得到我正在做的一些东西，因为结果是基于反复试验（主要是装饰器）
*   我从 zend 邮件列表中获得了我在网上任何地方都找不到的信息

从右侧的相关问题到此，很明显 Zend_Form 缺乏全面的文档，特别是考虑到它的非直观性质。我真的很想看到 ZF 的人为此做点什么，就像我喜欢 Zend Framework 一样。

所以这个答案可能只是为了让你知道你不是唯一一个遇到这个问题的人。

* * *

或者你当然可以使用**绝地思维技巧**！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-11T00:44:58.507

添加到所说的内容：

不要害怕装饰器，如果你决定坚持使用 Zend_Form，你会大量使用它们。一旦你“得到它”，它就相当简单了，不幸的是，文档很弱，玩它几乎是到达那里的唯一方法。

ViewScript 和 ViewHelper 装饰器为您提供了强大的功能。

不要害怕挖掘存在的不同装饰器的源代码，看看它们是如何做事的（通过比较原始装饰器和 dojo 装饰器，我获得了相当多的见解）。

我认为 Sean 的建议是你不需要调用 form->render，你可以在你的 viewscript 中使用类似的东西。

```
 <someHtmlThingy name="blah" value="<?php echo $this->formInstance->getElement('whatever')->getValue(); ?>" /> 
```

我参与了一个项目（Zend_Form 之前），我们构建了一组验证器并一直使用标准的视图脚本。与使用 Zend_Form 创建元素相比，这需要更多的工作（检查错误消息等），但并不过分。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-28T20:22:01.617

如果您只想在表单元素之前或之后添加任意标记而不使用 ViewScript 装饰器，则可以使用我的 AnyMarkup 装饰器：[http://www.zfsnippets.com/snippets/view/id/62](http://www.zfsnippets.com/snippets/view/id/62)

例如，以下是您如何在包装器标签内添加带有图像的输入字段（需要包括正确设置自动加载的路径）：

```
$form->addElement('text', 'my_field', array(
  '标签' => '输入信息：',
  '装饰器' => 数组（
    '查看助手',
    数组（'AnyMarkup'，数组（
      '标记' => '<span class="imgwrapper">'。
        '<img src="info.png" alt="info icon"/></span>'),
      '放置' => '前置'
    ),
    'HTML标签',
    '标签'
  )
);

```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-11T00:30:29.383

跳过表单范围的装饰器（IE - 打印表单的单个元素，而不是仅仅依靠表单的标准 View Helper 来处理所有内容）是获得一堆控制权的一种方法。

另一种选择是简单地手动编码您的表单并仅使用 ZF 处理验证和过滤。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-11T05:19:58.597

不幸的是，更复杂的问题被跳过了，因为如果没有真正的特定目的或目标，很难编写示例或操作方法。我花了一些时间在 SO 上帮助另一个想要[修改隐藏元素显示方式的](https://stackoverflow.com/questions/508511/zendformdecorator-how-to-add-attrib-to-zendformelementhidden/519833#519833)开发人员，但他的案例非常具体，因此更容易深入了解细节。

大多数更复杂的任务实际上归结为扩展特定字段类型的默认帮助程序。例如，我有一个项目，我想在提交表单后将“错误”类应用于所有未通过验证的字段，而不是写出验证错误文本：

```
<label for="field">Label:</label>
<input type="text" name="field" id="field" class="error"> 
```

这是一个相当复杂的过程，因为默认情况下视图助手无法使用实际的表单元素，因此助手无法检查元素是否存在验证错误。所以我进行了以下过程：

1.  我必须为要应用“错误”类的每个字段类型创建一个客户视图助手。在其中，我覆盖了该`formXXX()`方法，并添加了一个检查以查看元素是否有错误。此外，我添加了一个`setElement()`方法，装饰器可以调用该方法来设置元素的实例，以便我的助手可以检查错误。
2.  接下来我必须覆盖默认的`Zend_Form_Decorator_ViewHelper`. 在其中，我访问了视图并实例化了表单元素类型的帮助器，并检查了`setElement()`我在视图帮助器中创建的方法是否存在，如果存在则设置它。通过这样做，我可以在不破坏整个脚本的情况下扩展一些表单元素类型而不是其他类型。
3.  在每个表单的 init() 函数中，我必须添加一个新的元素前缀路径 ( `addElementPrefixPath('My_Form_Decorator'), 'path/to/decorator')`)，它指向我的新表单装饰器。
4.  最后，我必须将帮助程序路径添加到我的应用程序，以便 Zend Framework 可以找到我在第一个要点中创建的帮助程序：`addHelperPath('/path/to/helpers', 'My_View_Helper');`

你可以看到为什么编写复杂的教程真的需要现实世界的问题。设置这些帮助器或复杂的装饰器方案的重要之处在于，尽管前面很烦人，但它允许您非常轻松地创建许多遵循相同设计方案的表单，并在更改时非常快速地统一修改它们的输出需要制作。但是另一方面，如果您觉得自己花费大量时间来弄清楚如何做应该是一项简单的任务以使一个表格受益，我会说跳过它！

但是，如果您需要更具体的帮助，我将非常乐意提供帮助。只需提出另一个问题（或更新这个问题），我会尽力提供帮助。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-11T14:47:28.780

为什么cantitbemorethan25c 上面提到了它们，但是[ViewScripts](http://framework.zend.com/manual/en/zend.form.standardDecorators.html#zend.form.standardDecorators.viewScript)为您提供了对呈现表单的极细粒度的控制。Zend_Form 旨在快速，因此它假定许多默认值，如标准装饰器，并按照添加到表单对象的方式对元素进行排序。使用 ViewScript，您可以跳过其中的大部分内容并将所有元素放置在普通 HTML 中。

不过，不要完全跳过装饰器的概念。即使稍后在 ViewScript 中使用它们，它们也会为各个元素设置样式。例如，您可以按照其他人的建议将它们用于错误消息。

如果您有一个非常复杂的表单，其中包含多个具有相似操作的数据点（想想具有活动/非活动按钮的用户列表以及每个用户的删除按钮），您应该考虑[Zend_Form_SubForm](http://framework.zend.com/manual/en/zend.form.forms.html#zend.form.forms.subforms)。子表单可以像普通表单一样使用 ViewScripts，如果您将带有 ViewScript 的表单与带有自己的 ViewScripts 的子表单级联，您最终会得到比直接表单更强大的包含良好的逻辑和表示。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-11T00:53:13.930

我为 Zend_Form 和装饰器编写了一些子类，以使其在 <table> 中布局表单。它甚至有一些特殊的技巧来做一些事情，比如让多个提交按钮显示在同一行。

花了一整天的时间来让它工作。它是针对 Zend 1.5.1 编写的，所以不知道它是否适用于当前版本，但如果您有兴趣，我可能会在某处上传源代码。

这似乎是 Zend Forms 的一个非常常见的抱怨。

（我知道 CSS 纯粹主义者会因为使用表格来布局表单而大吃一惊，虽然我同意 CSS 对大多数事情来说更好，但我还没有看到使用看起来不好看的 CSS 的良好表单布局就像一个丑陋的杂物。有了表格，表格几乎可以在我需要的每个浏览器上“正常工作”。）

编辑：好的，说到丑陋的杂物，我已经将用于生成表格 zend 表单的代码放在 github 中。去[这里](http://github.com/ecognito/tabular-zend-forms/tree/master)看看吧。（因为 gaoshan88 要了。）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-21T16:44:34.110

在这里回答。希望它会帮助你。我浏览了异常数量的信息，直到找到它。

```
<table>
    <tr>
        <td>Page name: *</td>
        <td><?php echo $this->pageForm->header_title;?></td>
    </tr>

    <tr>
        <td>H1 tag: *</td>
        <td><?php echo $this->pageForm->h1_tag;?></td>
    </tr>

    <tr>
        <td>Page URL: *</td>
        <td><?php echo $this->pageForm->url;?></td>
    </tr>

    <tr>
        <td>Meta Description: </td>
        <td><?php echo $this->pageForm->meta_description;?></td>
    </tr>

    <tr>
        <td>Meta Keywords: </td>
        <td><?php echo $this->pageForm->meta_keywords;?></td>
    </tr>

    <tr>
        <td>Short Description: *</td>
        <td><?php echo $this->pageForm->short_description;?></td>
    </tr>

    <tr>
        <td colspan="2"><a href="<?php echo $this->websiteUrl;?>backend_template/list?placeValuesBeforeTB_=savedValues&TB_iframe=true&height=200&width=300&modal=true"
                           title="add a caption to title attribute / or leave blank" class="thickbox">Open iFrame Modal</a></td>
         <td>
            <a href="<?php echo $this->websiteUrl;?>backend_template/list?placeValuesBeforeTB_=savedValues&TB_iframe=true&height=200&width=300&modal=true" onclick="javascript:getDataFromAddPage()" title="Select Template For Page" class="thickbox" > TEST FORM  </a>
         </td>
    </tr>

    <tr>
        <td>Featured: </td>
        <td><?php echo $this->pageForm->featured;?></td>
    </tr>

    <tr>
        <td>Mark as 404: </td>
        <td><?php echo $this->pageForm->is_404page;?></td>
    </tr>

    <tr>
        <td>Show in Navigation Menu: </td>
        <td><?php echo $this->pageForm->in_navmain;?></td>
    </tr>

    <tr>
        <td>Show in Static Menu:</td>
        <td><?php echo $this->pageForm->in_navstatic;?></td>
    </tr>

    <tr>
        <td><?php echo $this->pageForm->submit;?></td>
        <td><?php echo $this->pageForm->button_close;?></td>
    </tr>

</table> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-11-17T23:42:49.377

您现在可能已经解决了这个问题，但我一直在做一些工作并且需要一个类似的解决方案。

```
form->getSubform('subform');
foreach ($subform as $key => $value) {
//这里有一些标记和自定义代码
    打印$值；
//这里有一些标记和自定义代码

}
?>

```

在 foreach 循环中，您可以添加表格标记。如果您为表格行适当地命名了键，它们应该与表单键匹配。您甚至可以使用一个循环来按键抓取适当的子表单，甚至可以按键抓取一个元素。如果您知道键，则可以跳过 foreach 循环，只需说 print $subform['somekey']; 假设您通过说 $form->setIsArray(true); 来设置主表单；（不确定最后一部分是否是绝对必要的，但对于复杂的表格，无论如何都应该这样设置。

我删除了默认装饰器，因此我可以完全控制每个元素内的打印。Zend_Form 应该有一个更容易抓取单个元素的内置方法。但我认为这很有效。

希望这对某人有帮助！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-23T10:58:25.487

Sean McSomething 的第一个建议是适合我的方法。我一直认为`<?php echo $this->form ?>`渲染表单太神奇了。不过，我会更进一步，通过`$element->renderDecorator()`魔术方法渲染单个装饰器而不是单个元素。这样，您就不必担心定义装饰器的顺序。你只需要它们在那里，你就不必添加那些讨厌的、不直观的`HtmlTag`装饰器。[我为此发表了一篇博文](http://monzee.wordpress.com/2009/02/23/decorators-are-hard-lets-go-shopping/)。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-02-11T10:41:37.793

我不确定 Zend 是否已经具有该功能，但是一个快速的解决方案是扩展类，使其接受 html 模板。

例如：

```
<?php
$form = new zend_form_whatever($field_list + $validators + $template);
echo $form;
?> 
```

模板：

```
<form id="my_custom_form">
    <label>{label.email}</label>
    {input.email}
    <span class="red">{error.email}</span>

    <div>
        {label.password}
        {error.password}
        {input.password}
    </div>

    <div class="purple">{input.submit}<div>
</form> 
```

# c# - 在受限用户帐户 XP 下运行时，C# 应用程序无法读取/写入管理员创建的文件

> ID：534877
> 
> 赞同：5
> 
> 时间：2009-02-11T00:04:03.270
> 
> 标签：c#, log4net, file-access, limited-user

我有一个可供 .NET（特别是 C#）中的所有用户（管理员或受限用户）使用的应用程序。

当应用程序首次启动时 - 它会在 C:\Documents and Settings\All Users\Documents\ 中创建一些文件，供所有后续启动使用。

如果 XP 中的受限用户是第一个启动应用程序的用户，它会正常创建文件，受限用户和管理员都可以正常运行。

但是，如果管理员（或者我猜是不同的受限用户）是第一个启动应用程序的人，那么受限用户将无法运行该应用程序。

如果由管理员创建，它无法读取/写入的两个文件是 Log4Net 日志文件和 SQLite db 文件。

SQLite 数据库文件是用一个 straitforward .NET File.Copy(sourcepath,destinationpath) 创建的。源路径是与应用程序一起安装的种子数据库文件 - 所以首先运行它会从 C:\Program Files\app install\seed.db 复制它

复制文件时有没有办法设置文件的权限？File.SetAccessControl() 也许？我不清楚它是如何工作的。

另一个问题是 log4Net 滚动文件附加程序不会滚动旧文件并创建新文件，因为旧文件是管理员用户在运行应用程序时创建的。

有任何想法吗？具有讽刺意味的是，这一切在 Vista 中使用受限/管理员帐户都可以正常工作 - 这仅在 XP 中使用管理员/受限帐户发生。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-11T00:34:24.680

我认为`SetAccessControl`是要走的路。也许是这样的：

```
// get the existing access controls
FileSecurity fs = File.GetAccessControl(yourFilename);

// add the new rule to the existing settings
fs.AddAccessRule(new FileSystemAccessRule(
    @"DOMAIN\Users",  // or "BUILTIN\Users", "COMPUTER\AccountName" etc
    FileSystemRights.Modify,
    AccessControlType.Allow));

// set the updated access controls
File.SetAccessControl(yourFilename, fs); 
```

*注意：从文件中获取现有的访问控制列表，然后将新规则添加到该列表中，这一点很重要。如果您只是从头开始创建一个新的访问控制列表，那么它将完全覆盖现有的权限。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T00:31:08.993

是的，没错，就是 SetAccessControl 方法，这里有一个很好的例子[（](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/dc841874-b71b-4e1c-9052-06eb4a87d08f/) 来自 satankidneypie 的帖子）

祝你好运

# c# - 在 c# 中：表达式评估函数，如 flash 脚本

> ID：534894
> 
> 赞同：4
> 
> 时间：2009-02-11T00:10:52.020
> 
> 标签：c#, eval

### 重复：[如何动态评估 C# 表达式？](https://stackoverflow.com/questions/53844/how-can-i-evaluate-a-c-expression-dynamically)

另请参阅：[C# eval 等价物？](https://stackoverflow.com/questions/4629/c-eval-equivalent)

* * *

如何评估表达式。也许像：

```
int a=1;
int b=3;
int c=Eval("a+b"); 
```

或者

```
int c=int.parse("1+3*(2+3)"); 
```

这对我来说似乎很愚蠢。在c#中可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T00:17:36.200

您可以获取代码，并使用 CSharpCodeProvider 编写一个 Eval 函数，该函数实际上将您的代码编译到内存中的程序集中，然后执行该代码。

有关示例源，请参阅此[CodeProject 文章](http://www.codeproject.com/KB/cs/evalcscode.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T00:16:29.213

不是直接的。C# 不包含运行时编译器。有[一个附加到 Mono 的开源项目](http://tirania.org/blog/archive/2008/Sep-10.html)可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-07T05:54:19.307

我在[“如何动态评估 C# 表达式”的答案中](https://stackoverflow.com/questions/53844/how-can-i-evaluate-a-c-sharp-expression-dynamically/52685808#52685808)列举了几种不同的方法，其中包括各种 .NET 框架解决方案，例如 CodeDomProvider、DataBinder.Eval、DataTable.Compute、Document.InvokeScript 等。

# powershell - cmd & powershell 的未来

> ID：534905
> 
> 赞同：22
> 
> 时间：2009-02-11T00:16:33.520
> 
> 标签：powershell

我们今天只是在讨论它，所以我进行了一些搜索，但什么也没找到，zip，nada。

ms的cmd shell的未来是什么？他们是否打算在未来版本的 windows 中完全用 powershell 替换它，或者只是将 powershell 作为并行替代方案？

有没有人有任何链接，文章，......关于上述任何内容，因为我无法介意女士的立场。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-11T00:20:36.927

最新版本的 Windows 7 分别具有两个 shell。我相信他们不会取代优秀的 cmd.exe。他们需要它主要是出于兼容性原因。许多程序调用 cmd /c，而为 powershell 复制完全相同的机制将是重复劳动。所以，我想 cmd.exe 仍然存在。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-11T00:23:29.103

cmd.exe 不会去任何地方（它使用得太广泛了）。

但是，我认为您不会看到它的任何改进（不是说它们一直在燃烧它们）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T00:37:00.833

Powershell 非常擅长处理复杂的任务。然而，它更难学习，而且运行速度要慢得多。

CMD 将保留，因为您可以非常快速地运行批处理文件和命令行操作。此外，弹出命令外壳并执行命令非常便宜。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T23:53:17.293

想象一下如果删除 cmd.exe 会破坏多少登录脚本？即使 Powershell 可以无缝地运行所有 cmd 命令（它不能），在 Powershell 下运行的登录脚本在用户登录期间也会太慢，因为您还需要等待 .NET 加载。

我曾经听说一位 Citrix 管理员将他的登录脚本转换为 Powershell，然后很快意识到这是一个坏主意。

# web-services - 你知道哪些使用 Webhook 的 Web 应用程序

> ID：534913
> 
> 赞同：9
> 
> 时间：2009-02-11T00:18:44.810
> 
> 标签：web-services, http, webhooks

[来自http://webhooks.pbwiki.com/](http://webhooks.pbwiki.com/)的 webhook 如何工作的描述-

> 它们是如何工作的？
> 
> 通过让用户为各种事件指定 URL，应用程序将在事件发生时将数据 POST 到这些 URL……除此之外，您可以：
> 
> *   通过电子邮件、IRC、Jabber、...向您或任何人创建通知
> *   将数据放在另一个应用程序中（实时数据同步）
> *   处理数据并使用应用程序的 API 重新发布
> *   验证数据并可能阻止应用程序使用它
> 
> 谁在使用网络挂钩？
> 
> DevjaVu, BitBucket, GitHub, Shopify, Versionshelf, PayPal (IPN), Jott (Links), IMified, PBwiki, Facebook (Platform, sort of), Mailhook.org, SMTP2Web, Astrotrain, Notifixious, Assembla, ZenDesk, Google Code

你知道 webhook 有什么好的用途吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-09-14T17:14:56.920

[AlertGrid](http://alert-grid.com) is the webhook consumer. You can configure it to accept http calls from ANY source and raise alert (email, sms, phone) to a specified person or group of people (works worldwide!) whenever the parameters in the http callback meet your criteria or when the http call was expected but it didn't occur (kind of 'heartbeat' monitoring). There is a visual editor for you to easily create rules.

Apart from notifying people by sms or email it can also notify existing applications by sending the http requests to their APIs.

It can also visualise data received in http callbacks and show the history.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T09:17:56.627

不幸的是，wiki 并不是已知实现的最新列表。我有我自己的列表，当我有时间重新组织它时，我会把它放在 wiki 上。当前列表中未提及的一些：

*   投递箱
*   尼普
*   谷歌代码（项目托管）
*   亚马逊结账（用于通知和带有返回数据的实际回调）
*   善意的
*   豆茎
*   谷歌结帐
*   邮件黑猩猩
*   调查小发明
*   嘿！看
*   MySpace（适用于应用程序开发人员）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-10T20:36:24.337

[Kiln 1.2](http://kilnhg.com)使用[webhook](http://kiln.stackexchange.com/questions/952/does-kiln-support-web-hooks)很像 GitHub、BitBucket 等。

（免责声明：我是 Kiln/FogBugz 开发人员。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-14T15:29:04.057

我知道[shopify](http://wiki.shopify.com/WebHook)现在非常成功地使用了 webhook。通过扩展，fetchapp 也使用它们。您要么发送一个 xml 文件，要么接收一个并在其上执行您自己的处理逻辑。

哦，链接中的shopify wiki完整地写了关于如何在您的应用程序中实现它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-21T21:02:47.453

[OfficeAutopilot](http://officeautopilot.com)有一个有趣的 webhook 版本。他们使用他们的规则接口来触发 API 帖子。可以响应任何系统事件触发。电子邮件打开、点击、页面访问、购买等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-02T16:17:45.890

例如，假设您想从任何 API（例如 twitter、facebook 等）获取数据。它不是每隔几分钟/秒轮询一次数据，而是将数据发布到指定的 URL，只要它可用。

通过使用它，您将避免不必要的轮询，例如说您轮询并且数据还没有。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-23T22:15:52.403

如果你想将一个支持 webhook 的服务连接到另一个服务的 API，你可以查看[IronWorker](http://www.iron.io)的 webhook 支持。这是一篇博客文章，介绍了将 github webhooks 连接到 HipChat：

[http://blog.iron.io/2012/04/one-webhook-to-rule-them-all-one-url.html](http://blog.iron.io/2012/04/one-webhook-to-rule-them-all-one-url.html)

这里还有[一些其他的例子](https://github.com/iron-io/iron_worker_examples/tree/master/ruby_ng)，一个接受 chargify 回调并发布到 Campfire 的例子。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-18T15:02:40.197

[StorageRoom](http://storageroomapp.com/developers/webhooks "储存室")是一个基于 JSON 的 CMS，支持 webhook，因此您可以通知其他服务或在您自己的服务器上进行一些手动处理。

（请注意：我自己创建了服务）

# java - ruby 线程编程，ruby 等价于 java wait/notify/notifyAll

> ID：534919
> 
> 赞同：6
> 
> 时间：2009-02-11T00:22:21.587
> 
> 标签：java, ruby, multithreading, synchronization

我想知道 ruby​​ 的 Java 方法替代品是什么：

*   等待
*   通知
*   通知所有

您能否发布一个小片段或一些链接？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-06-24T05:52:50.357

您正在寻找的`ConditionVariable`是`Thread`：

```
require "thread"

m = Mutex.new 
c = ConditionVariable.new
t = []

t << Thread.new do
  m.synchronize do
    puts "A - I am in critical region"
    c.wait(m)
    puts "A - Back in critical region"
  end
end

t << Thread.new do
  m.synchronize do
    puts "B - I am critical region now"
    c.signal
    puts "B - I am done with critical region"
  end
end

t.each {|th| th.join } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T04:03:43.600

需要注意的是，我不了解 Java，根据您的评论，我认为您需要一个条件变量。谷歌的“Ruby 条件变量”提供了一堆有用的页面。我得到的[第一个链接](http://www.linuxtopia.org/online_books/programming_books/ruby_tutorial/Ruby_Threads_and_Processes_Condition_Variables.html)似乎是对条件变量的一个很好的快速介绍，而[这](http://phrogz.net/ProgrammingRuby/tut_threads.html)看起来它提供了更广泛的 Ruby 线程编程的覆盖范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T02:33:28.950

没有等价于 notifyAll()，但另外两个是`Thread.stop`（停止当前线程）和`run`（在停止的线程上调用以使其重新开始）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-01T04:43:24.823

我认为您正在寻找更多类似的东西。它适用于执行后实例化的任何对象。它并不完美，尤其是在 Thread.stop 位于互斥体之外的情况下。在java中，等待一个线程，释放一个监视器。

```
class Object 
  def wait
    @waiting_threads = [] unless @waiting_threads
    @monitor_mutex = Mutex.new unless @monitor_mutex
    @monitor_mutex.synchronize {
      @waiting_threads << Thread.current
    }
    Thread.stop
  end

  def notify
    if @monitor_mutex and @waiting_threads 
      @monitor_mutex.synchronize {
        @waiting_threads.delete_at(0).run unless @waiting_threads.empty?
      }
    end
  end

  def notify_all
    if @monitor_mutex and @waiting_threads
      @monitor_mutex.synchronize {
        @waiting_threads.each {|thread| thread.run}
        @waiting_threads = []
      }
    end
  end
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T00:25:27.710

我想你想要的是`Thread#join`

```
threads = []
10.times do
  threads << Thread.new do
    some_method(:foo)
  end
end

threads.each { |thread| thread.join } #or threads.each(&:join)

puts 'Done with all threads' 
```

# asp.net-mvc - 为 php 程序员了解 .net MVC 的最佳方式

> ID：534920
> 
> 赞同：0
> 
> 时间：2009-02-11T00:22:36.190
> 
> 标签：asp.net-mvc, model-view-controller

好的，我知道关于在 dot net 中学习 MVC 的书籍和教程有很多问题，但是在我开始阅读其中一些内容后，我意识到它们并不面向像我这样的人。

我一直在 MVC 配置中使用 Zend 上的 php，并在 Rails 上做了一些 ruby​​，所以我对这种模式有一个很好的了解，但我完全不知道：IIS、Visual Studio 和 asp/C#... 所以，什么是最好的方法（可能是一本书、几个教程、一个指南、一个手册、一篇博客文章）来很好地了解这项技术。

至少我会知道（第一手）这一切的利弊！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T00:29:41.710

截屏视频对我的帮助比什么都大。看到某人实际做某事比阅读更有启发性。[在http://asp.net/mvc](http://www.asp.net/learn/mvc-videos/#howdoi)上观看截屏视频。Scott Hanselman 的预览 3 视频仍然具有相关性，因为从那时起并没有太多巨大的、彻底的变化。它们向您展示了如何拖动数据、使用 LINQ 以及其他特定于 .NET 的东西。在与这些一起观看和编码之后，检查其他的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T00:49:03.647

如果您真的是从头开始，第一步是下载并安装[Visual C# 2008 Express Edition](http://www.microsoft.com/express/vcsharp/)、[Visual Web Developer 2008 Express Edition](http://www.microsoft.com/express/vwd/Default.aspx)和[SQL Server 2008 Express Edition](http://www.microsoft.com/express/sql/Default.aspx)。这些是微软 Visual Studio 和数据库产品的免费版本。

然后从像[这样](http://www.csharp-station.com/Tutorial.aspx)的基本 C# 教程开始，熟悉C# 与 PHP 不同的特性。你可能会浏览它，但我认为拥有这个基础会很有价值。

查找 LINQ to SQL 教程，因为大多数 MVC 教程都使用它来访问数据，它可能与您在 PHP 中看到的非常不同。

从那里我认为您将有足够的时间开始 MVC 教程。花一些时间学习简单的 ASP.NET 肯定会帮助您过渡到 ASP.NET MVC，但您也会花费大量时间处理 MVC 中不存在的概念。

此外，手头有[MSDN](http://msdn.microsoft.com/en-us/library/ms229335.aspx)作为 .NET 框架的参考。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-12T20:14:50.243

您处于劣势，因为您没有接受过正式的 C# 培训并且不熟悉 .Net 框架。幸运的是，总是有时间学习。这是我建议你做的。获得一本 C# 初学者书籍并开始学习一些 C#，一旦你掌握了使用 MVC 框架的 html 和 php 技能。另一件可能有帮助的事情是获得一份 .Net 工作，说真的，这是学习东西的最佳方式！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-24T08:29:58.597

学习核心 C# 技能 2.0 到 3.5，因此泛型 / LINQ / Lambda 表达式 / 列表 / 继续在 Visual Studio Express、控制台应用程序、winforms 和 Web 应用程序中编写应用程序。

您必须掌握基本的核心 C# 语言。如果您了解 PHP，那么至少您了解逻辑...条件和 html/jquery/css。然而，在真正做 MVC 之前，你真的很想学 C#，因为你会盯着泛型和 lambda 表达式，完全迷失了方向。

从各个角度攻击它，主要是从头开始手工编码的反复试验，然后是来自复数视觉/微软等的一些视频。MVC 3 书籍也很好，但 .NET C# 书籍将是一个大的第一。

# javascript - 在javascript中橡皮筋多个区域

> ID：534925
> 
> 赞同：0
> 
> 时间：2009-02-11T00:24:44.140
> 
> 标签：javascript

我想显示图像，然后让用户在图像上创建多个橡皮筋选择。每次按下鼠标都会创建一个额外的选择。有没有人在javascript中看到过这种技术的实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T05:30:18.477

我确实使用了这个图像裁剪脚本。它使用橡皮筋来选择裁剪区域。代码很容易理解，你可以修改它来做你想做的事。不过，选择重叠区域可能会有点挑战。

脚本：[JavaScript Image Cropper UI，使用 Prototype 和 script.aculo.us](http://www.defusion.org.uk/code/javascript-image-cropper-ui-using-prototype-scriptaculous/)

# .net - 团队正在从 XP32 升级到 XP64 以进行 .NET 开发 - 有什么陷阱吗？

> ID：534941
> 
> 赞同：6
> 
> 时间：2009-02-11T00:30:45.203
> 
> 标签：.net, visual-studio, windows-xp, 64-bit

我的团队正在获得新的 XP64 工作站。到目前为止，我们一直在使用 XP32。我们的大部分工作是在托管 C#/VS2008/.net 3.5 和 SQL Server 2005 中完成的。但是我们确实有几个应用程序仍在 VS2005/.net 2.0 中。我们的大多数应用程序是 ASP.NET Webforms 应用程序和 WCF 服务，它们在生产环境中的 64 位服务器上运行。但是，我们正在进行一些必须在 32 位机器上运行的 WPF 开发。

是否有任何我们应该注意的问题或过渡痛点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T02:43:28.597

如果您要引用为 32 位编译的任何第三方 DLL，那么您必须将您的应用程序定位为 32 位。这可以通过更改项目设置或使用带有 /32BIT+ 参数的[corflags应用程序来完成。](http://msdn.microsoft.com/en-us/library/ms164699(VS.80).aspx)

在我作为开发工作站的许多个月的 XP x64 中遇到的唯一“问题”是 Edit-And-Continue 在 64 位应用程序的 Visual Studio 调试器中不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T00:40:05.540

这取决于。

您是否在代码中使用过 P/Invoke？

您是否使用过非托管代码和编组数据进出它？如果是这样，那么您将不得不使用细齿梳来检查此代码:(。

但是，如果您的代码是未使用 P/Invoke 的纯 C#，那么您应该看到的唯一区别是性能略有提高和内存性能更好:)。

但是，您可能会遇到 gremlins 为您的开发机器寻找驱动程序。

如果您有一些 32 位代码，那么也许您可以为其创建一个 WCF 接口（命名管道非常非常快）并使用它与 32 位服务通信。我知道你不能在 64 位进程中拥有 32 位代码，但我认为你可以打开一个到 32 位进程的管道，除非我错了。在这种情况下，您总是可以使用 TCP/IP。可能会使您免于重写系统中的关键代码，并允许您使用 WOW64 或 VM 来处理迁移问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T02:06:31.103

希望这有帮助

[为 asp 64 位调用注册 COM 32 位 DLL](https://stackoverflow.com/questions/503740/how-to-force-process-isolation-for-an-out-of-process-com-server/512327#512327)

[许多关于约定 32-64 位的链接](https://stackoverflow.com/questions/8896/memcached-on-windows-x64/499610#499610)

[关于 64 位 Windows 的一般常见问题解答](http://msdn.microsoft.com/en-us/isv/bb190528.aspx)

[64 位系统设计](http://www.microsoft.com/whdc/system/platform/64bit/default.mspx)

也看到这个提示[以最小的变化获得最大的性能提升？](https://stackoverflow.com/questions/545844/biggest-performance-improvement-youve-had-with-the-smallest-change/547697#547697)

更多精彩博客提示：[回归基础：围绕 x86 和 x64 以及 .NET Framework 和 CLR 的 32 位和 64 位混淆](http://www.hanselman.com/blog/BackToBasics32bitAnd64bitConfusionAroundX86AndX64AndTheNETFrameworkAndCLR.aspx)

[Microsoft 的 Windows 应用程序质量指南](http://code.msdn.microsoft.com/Windows7AppQuality/Release/ProjectReleases.aspx?ReleaseId=1734)

[DevReadiness.org](http://devreadiness.org/)
该站点致力于帮助 Windows ISV 生态系统为新版本的平台开发高质量的应用程序。Windows 7 最近在 PDC 2008 大会上发布，右侧提供了指向新应用准备就绪“食谱”的链接

Microsoft.com OPS 人员在博客中介绍了他们迁移到 x64 以及它是如何工作的。
[在 64 位上运行 Microsoft.com……依赖关系、优点、问题](http://blogs.technet.com/mscom/archive/2005/09/26/411568.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-12T18:20:10.660

您将无法从 .NET x64 与 MS Access 数据库通信，因为没有 x64 Jet 驱动程序。

我认为这是迁移到 x64 的绝佳理由。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-11T01:27:05.613

去年我已经使用 XP 64 位几个月了。我的经验是 Microsoft 开发堆栈的安装和运行没有任何问题，包括 64 位版本的 SQL Server。

我的华硕主板的板载 Marvell Yukon 网卡的网络驱动程序遇到了问题。64 位驱动程序存在严重的问题，这些问题并不立即明显，但经过几个月的激烈测试后变得明显。千兆网络上的网络传输速率不如预期，当两个进程访问相同的网络资源时，Windows 会崩溃。

我的建议是，就像其他海报建议的那样，在切换整个团队之前测试硬件-软件设置。这更有可能是您看到问题的地方。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-11T02:17:12.233

我已经在 64 位平台上开发了一段时间。这是一个小技巧，可以让您免于头痛。

如果你得到异常

> “BadImageFormatException”（例如“无法加载或组装 'Microsoft.TeamFoundation 等或其中一个依赖项。试图加载格式不正确的程序”）

应用程序很可能找不到 64 位版本的程序集。

我们在使用 OLEDB/Jet 驱动程序访问数据库时经常遇到此错误。我也曾使用与 TFS 集成的工具体验过这一点。

要解决此问题，请转到项目设置下的“编译”选项卡，“高级编译选项”并选择“x86”作为目标 CPU。

希望这可以帮助！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-12T18:12:02.007

*   如果您将任何 C++ 和 C# 与 64 位应用程序一起使用，则混合模式调试是一个问题。
*   仍有许多开发工具不支持在 Windows x64 上运行或不支持使用 64 位二进制文​​件。以 Compuware DevPartner 为例。它目前只支持 32 位应用程序开发，但应用程序本身将在 64 位 Windows 上运行。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-12T18:26:48.227

TFS 不支持 64 位（TFS 服务器，不确定是否适用于团队资源管理器）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-02T15:49:29.517

您可能会遇到 string.GetHashCode() 在 32 位和 64 位机器上为同一字符串返回不同值的问题，因为它们将运行不同版本的 CLR。

至关重要的是：

> “GetHashCode 的行为取决于它的实现，它可能会从一个版本的公共语言运行时更改为另一个版本。发生这种情况的一个原因是为了提高 GetHashCode 的性能。”</p>

更多信息[在这里](http://dotnetdebug.net/tag/gethashcode/)和[这里](http://lxit.be/programming/gethashcode-on-a-32-bit-vs-a-64-bit-platform/)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-07-02T15:56:08.600

现在将有两组**ODBC 数据源**(DSN)：32 位和 64 位。一些数据库目前没有更新 64 位驱动程序，因此您将被迫使用 32 位驱动程序，或者您可以等待。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-07-02T15:58:06.480

我们遇到了两种不同类型的问题：

1.  我们有一个包装原生 32 位 dll 的 3rd 方组件。供应商没有提供 64 位版本，因此我们必须针对 32 位开发。

2.  几个驱动问题。当我们尝试 XP-64 时，它并没有流行起来（现在有了吗？）。这些问题与开发无关，但我们在打印机驱动程序、网络驱动程序等方面遇到了一些问题）。在vista中，他们改变了驱动模型，所以现在可能会有更多的64位驱动，但我不知道它们是否会向后兼容XP。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-11T00:37:07.433

Sun 有一篇关于它的好文章。[http://developers.sun.com/solaris/articles/ILP32toLP64Issues.html](http://developers.sun.com/solaris/articles/ILP32toLP64Issues.html)

> 当前的 32 位应用程序通常假定 int 类型、long 类型和指针大小相同。由于 LP64 数据模型中 long 和指针的大小发生了变化，因此这种变化本身就是导致 ILP32 到 LP64 转换问题的主要原因。

# c# - 泛化 LINQ 查询？

> ID：534942
> 
> 赞同：1
> 
> 时间：2009-02-11T00:30:45.343
> 
> 标签：c#, linq

除了查询的主题和参数之外，我有几个相同的查询，我正在尝试制定一个“通用”查询以避免多行几乎相同的代码。

我有以下代码：

代码片段

```
 private IEnumerable doQuery(string rangeVar,
                             DataSet dsSubTable,
                             string qrySubject,
                             string subTableKey,
                             string subTableDescription,
                             string fldName)
    {
        qryStart = dtmpickFrom.Value;
        qryEnd = dtmpickTo.Value;

        var groupQuery =
            from trans in dataSet.Transaction    
            where ((trans.T_Date >= qryStart) && (trans.T_Date <= qryEnd))
            from rangeVar in dataSet.dsSubTable  <<<<<<
                 where trans.qrySubject == rangeVar.subTableKey

            select new    ..... <snipped> 
```

编译器将不接受带有以下消息的 dsSubTable（显示为 <<<<<）：

> “ExpenditureLINQDataSets.Expenditure”不包含“dsSubTable”的定义，并且找不到接受“ExpenditureLINQDataSets.Expenditure”类型的第一个参数的扩展方法“dsSubTable”（您是否缺少 using 指令或程序集引用？）

当然，我意识到这一点（如果我尝试给 dsSubTable 一种 Expenditure ......只有在我的 DataSet 中定义的实际表名出现在 Intellisense 中。）

是否可以概括此类 LINQ 查询，或者我必须在代码中使用多个几乎相同的查询？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T03:20:45.667

如果您将 dsSubTable 作为 DataTable 传入，那么您可以直接在 dsSubTable 的 from blah 中使用它。

但感觉就像你在滥用 Linq。Linq 的强大之处在于它不是 Sql，所以你为什么要编写一个方法，而不是将 Sql 字符串连接在一起，而是构建一个 Linq 表达式。

Linq 允许您根据集合来考虑您的数据，这就是我发现它的真正强大之处。我鼓励您在调用“doQuery”并将这些查询编码为一流操作时考虑您要完成的工作。

# reporting-services - 从 VB.Net 渲染 SSRS 报告

> ID：534954
> 
> 赞同：2
> 
> 时间：2009-02-11T00:36:07.763
> 
> 标签：reporting-services, reportingservices-2005

我们在内网上有很多带参数的报告。所有报告都将在 SSRS 中重新构建。我们的目标是将所有参数从 .net 应用程序传递给报告。从 .NET 应用程序呈现报告的最简单、最快捷的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T01:44:05.557

如果您使用的是 VisualStudio 2008，您应该能够将 MicrosoftReportViewer 控件添加到您的工具箱中，并以这种方式将其添加到您的表单设计器中。

如果没有，您可以将项目引用添加到 Microsoft.ReportViewer.WinForms（或 .WebForms）。

更多信息是[http://msdn.microsoft.com/en-us/library/ms252073(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms252073(VS.80).aspx)在标记*为将 ReportViewer 控件添加到表单的部分下*

# sql - 最佳数据库变更控制方法

> ID：534955
> 
> 赞同：13
> 
> 时间：2009-02-11T00:36:40.477
> 
> 标签：sql, database, architecture, schema, methodology

作为数据库架构师、开发人员和顾问，有很多问题可以回答。一，虽然我最近被问到，但仍然不能很好地回答，是......

> “在单开发人员或多开发人员环境中保持数据库更改记录、组织并能够有效推出的最佳方法或技术之一或部分是什么。”

这可能涉及存储过程和其他对象脚本，但尤其是模式 - 从文档到新的物理更新脚本，再到推出，然后是完整的循环。有一些应用程序可以实现这一点，但需要模式挂钩和开销。我想知道在没有大量额外第三方参与的情况下使用的技术。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T00:45:31.937

我更喜欢这个系列： http: [//odetocode.com/Blogs/scott/archive/2008/02/03/11746.aspx](http://odetocode.com/Blogs/scott/archive/2008/02/03/11746.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-11T00:47:34.367

如果你愿意的话，我见过的最简单的方法是创建一个“模式补丁”。模式补丁只是一个简单的 t-sql 脚本。架构补丁在脚本中被赋予了一个版本号，并且该版本号存储在数据库的表中以接收更改。

对数据库的任何新更改都涉及创建一个新的模式补丁，然后您可以按顺序运行该补丁，然后检测数据库当前的版本并运行其间的所有模式补丁。之后，模式版本表将更新为执行补丁以存储下一次运行的任何日期/时间。

一本详细介绍此类细节的好书叫做[Refactoring Databases](https://rads.stackoverflow.com/amzn/click/com/0321293533)。

如果您希望使用外部工具，您可以查看[Ruby 的 Migrations项目或 C# 中称为](http://wiki.rubyonrails.org/rails/pages/understandingmigrations)[Migrator.NET](http://code.google.com/p/migratordotnet/)的类似工具。这些工具通过创建具有“前向”和“后向”迁移的 c# 类/ruby 类来工作。这些工具功能更丰富，因为它们知道如何在模式补丁中前进和后退。但是，正如您所说，您对外部工具不感兴趣，但我想无论如何我都会为其他读者添加它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T00:45:55.993

就我而言，每次更改数据库时都会生成一个脚本，我将脚本命名为 00001.sql、n.sql，并且我有一个表，其中包含我执行的最后一个脚本的编号。您还可以查看[数据库文档](https://stackoverflow.com/questions/10066/sql-database-documentation/10120#10120)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T17:33:50.050

只要您将列/表添加到数据库中，通过提前在 sql 文件中编写这些更改的脚本，这将是一项简单的任务。你只需执行它们。也许你有一些命令来执行它们。

一个好的解决方案是为每个表创建一个文件，这样所有在表上工作的人都可以看到属于该表的所有更改（就像在上课一样）。这同样适用于存储过程或视图。

一个更困难的任务（因此也许工具会很好）是退后一步。只要您只是添加表格/列，这可能不是一个大问题。但是，如果您在更新中删除了列，现在您必须撤消更新，则数据不再存在。您将需要从备份中获取此数据。但请记住，如果您有更多的表，这可能是一项艰巨的任务，在正常情况下，您应该非常快速地撤消更新！

如果您可以恢复备份，那么此时就可以了。但是，如果您在周一更新，您的客户一直工作到周三，然后他们发现一些数据丢失（您刚刚从表中删除），那么您不能只恢复旧数据库。

我有一个基于模型的方法（抱歉，目前没有实现），其中模式更改被“建模”（例如每个 xml），并且在更新期间处理器（例如 ac# 程序）创建所有必要的“sql ”，例如将数据移动到“dropDatabase”。数据可以保存在那里，如果由于某种原因我需要恢复一些丢失的数据，我可以用处理器来完成。我认为经过一段时间（几年），这种方法并没有那么糟糕，因为否则开发人员不会接触“旧”表，因为他们不再知道表或列是否真的需要。用这种方法，如果你丢东西，你不会冒太大的风险！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-12T10:11:17.403

我要做的是：

*   重新创建模式（以及存储过程和索引等）所需的所有 DDL 命令都在脚本中。
*   为确保脚本正常，不时对其进行测试（创建数据库、运行脚本并恢复备份并检查数据库是否正常工作）。
*   对于变更控制，脚本保存在版本控制系统中（我通常使用 Subversion）。

诀窍是，如果数据库无法通过添加列重新创建，我需要进行**两项**更改，一个 ALTER TABLE + 脚本中的修改。更多的工作，但从长远来看，它会赢。

# tcp - TCP 如何处理 cwnd 的超时？

> ID：534957
> 
> 赞同：4
> 
> 时间：2009-02-11T00:36:44.953
> 
> 标签：tcp

最近一直在研究TCP拥塞控制，但是有一个问题困扰着我……

如果我理解正确，除非 cwnd（拥塞窗口）和 rwnd（接收方窗口）允许，否则 TCP 不会发送新数据。换句话说：

```
if(flightSize < MIN(cwnd, rwnd))
{
    // Send some new data (if possible)
    // Taking into account other details that we don't need
    // to get into such as Nagle's algorithm, etc.
} 
```

其中 flightSize 是已发送但尚未确认的数据量。

让我们假设 TCP 正在运行，发送数据，并酌情增加 cwnd。假设 cwnd = [10 个完整数据包]，而 flightSize == cwnd。然后在网络中发生丢包，发送方的重传计时器关闭。New Reno 如何/何时重新传输未确认的数据？

这是我目前的理解/误解：

当定时器关闭时，cwnd 将被重置为 [1 full packet]，最旧的发送但未确认的数据包将被重新发送，rto 将加倍，重传定时器将被重置。因此，如果我们说定时器关闭时 rto 为 1 秒，它将被更新为 2 秒，并且重传定时器将重新启动，等待时间为 2 秒。

这就是我感到困惑的原因：

在上述情况下，TCP 只会重新发送一个数据包。即使该数据包立即得到确认，TCP 也无法发送任何新数据，因为 cwnd 仍然小于 flightSize。那么它有什么作用呢？坐等到 2 秒重传计时器再次关闭，然后再重新发送另一个数据包？由于无法发送新数据，是否会强制重新发送旧数据？它是否重置了 flightSize，并重新考虑所有以前发送的数据未发送？

我已经阅读了我能找到的所有 RFC，以及各种关于 TCP 的指南和解释。我一定是在什么地方漏掉了什么……

* * *

澄清：我正在考虑多重损失，其中 TCP 不使用 SACK。

如果收到重复的确认，TCP 将在第 3 次重复确认时重新发送最旧的确认（快速重传），并在第 4 次重复确认之后发送新数据（快速恢复）。我的问题是如果 TCP 发送方收到少于 3 次重复确认会发生什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-12T04:39:24.110

我在“TCP/IP Illustrated, Volume 2”一书中找到了答案，第 25.11 节，第 842-844 页：

> [在重传超时时] 下一个发送序列号 (snd_nxt) 设置为最旧的未确认序列号 (snd_una)。...通过将 snd_nxt 移回，[TCP 可以开始重新传输所有未确认的数据]。

换句话说，flightSize 将被重置，因此可以继续发送数据（在慢启动模式下）。只是其中一些数据可能是之前已经发送过的数据。可能会出现累积确认，以防止所有数据被重新发送。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-11T02:09:51.470

要求澄清：您是否正在考虑单个数据包丢失？还是在一个窗口内多次亏损？

在单个丢失的情况下，由于在丢失后收到的数据包，将收到重复的确认。我相信 New Reno 将传输后续数据包（“新数据”）以响应重复的确认。然后这会重置超时计时器。

# javascript - 像这里的链接对话框一样使屏幕变暗的 jQuery 对话框

> ID：534963
> 
> 赞同：2
> 
> 时间：2009-02-11T00:38:43.857
> 
> 标签：javascript, jquery, css, jquery-ui, jquery-1.3

我喜欢这里的链接对话框的外观。它使屏幕变暗并且可能是模态的（尽管我没有测试过我只是假设它是）。使用 jQuery UI 对话框使屏幕变暗的快速简便的方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-11T00:46:32.717

您所说的功能由[WYSIWYM Markdown Editor提供](http://wmd-editor.com/)

要使用 jQuery UI 的对话框来做到这一点，试试这个：

```
$("#something").dialog({ modal: true; });

<div id="something" title="modal dialog">
<p>Add your stuff here.</p>
</div> 
```

默认情况下它并不完全相同，但我认为它更漂亮。;)

[http://ui.jquery.com/demos/dialog/#modal](http://ui.jquery.com/demos/dialog/#modal)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-12T14:31:54.983

一种方法是在 z-order > 1 处设置一个 div，它以低于 100% 的不透明度覆盖整个屏幕

HTML：

```
<div id="cover>&nbsp;</div> 
```

CSS：

```
#cover {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
z-index: 10;
display: none;
background-color: #000000;
opacity: .7;
filter:progid:DXImageTransform.Microsoft.BasicImage(opacity=.7); 
```

}

然后，您可以在显示对话框时显示封面，该对话框需要更高的 z-index 并在您的对话框同时移除封面：

打开：

```
$("#cover").show();
$("#fileupload").show( "slow" ); 
```

关闭：

```
$("#fileupload").fadeOut( "slow" );
$("#cover").hide(); 
```

# java - 为什么使用 Java Sockets 永远不会到达输入流的末尾？

> ID：534964
> 
> 赞同：4
> 
> 时间：2009-02-11T00:39:02.797
> 
> 标签：java, sockets, stream

我正在用 Java 编写一个简单的代理。我无法将给定请求的全部内容读入字节数组。具体来说，在下面的循环中，即使客户端已经发送了它将发送的所有数据（也就是说，永远不会到达流的末尾），对“读取”的调用也会阻塞。因为在我读完整个输入之前我不能确定是时候开始写输出了，这会造成一些麻烦。如果我终止与服务器的连接，则最终到达流的末尾，并且一切都顺利进行（来自客户端的所有数据，在这种情况下，Firefox 请求 www.google.com，已被服务器读取，并且它能够根据需要对其进行处理，但显然它无法将任何内容发送回客户端）。

```
public static void copyStream(InputStream is, OutputStream os) throws IOException
{
    int read = 0;
    byte[] buffer = new byte[BUFFER_SIZE];
    while((read = is.read(buffer, 0, BUFFER_SIZE)) != -1)
    {
      os.write(buffer, 0, read);
    }
    return;
} 
```

InputStream 直接来自客户端套接字（getInputStream()，然后缓冲）；OutputStream 是一个 ByteArrayOutputStream。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T00:42:39.790

通常在 HTTP 中，`Content-Length`标头指示您应该从流中读取多少数据。`\r\n`基本上，它会告诉您指示 HTTP 标头结束的双换行符（实际上是 double- ）后面有多少字节。有关更多信息，请参阅[W3C](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.13) ...

如果没有`Content-Length`发送标头，您可以尝试在经过一定时间后中断读取，并且没有通过连接发送数据，尽管这绝对不是可取的。

（我假设您将以某种方式处理正在读取的数据，否则您可以在读取时写出每个字节）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T00:53:48.080

所有现代浏览器都支持的 HTTP 1.1 有一个名为“keep-alive”或“持久连接”的功能，默认情况下允许客户端为多个请求重用与服务器的 HTTP 1.1 连接（参见[http:// www.w3.org/Protocols/rfc2616/rfc2616-sec8.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html)）。因此，如果您将 FF 指向[http://www.google.com](http://www.google.com)，与 www.google.com:80 的连接将保持打开一段时间，即使第一个请求已完成。因此，如果您的应用程序对 HTTP 协议没有基本了解，您将无法知道是否所有数据都已发送。您可以通过在连接上使用超时以某种方式规避这种情况，希望客户端不会卡在某个地方，并且静音实际上意味着数据块的结束。另一种方法是重写服务器响应标头，将您的代理宣传为符合 HTTP 1.0，而不是 1.1，从而禁止客户端使用持久连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T03:07:45.903

请记住，并非所有连接都有`Content-Length`标头；有些人可能会使用[`Transfer-Encoding: chunked`](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)内容长度被编码并包含在正文中的地方。

# oop - OOP 设计：可重用验证应该在哪里？

> ID：534967
> 
> 赞同：1
> 
> 时间：2009-02-11T00:41:26.223
> 
> 标签：oop

我有一个向导，它需要验证用户是否已登录，然后最后验证他们输入的所有详细信息是否正确。

问题是我不确定将验证逻辑放在哪里。目前我有一个 BuyMembership 类，它对 Buy() 方法进行了验证。但是，这不会在向导开始时调用，我需要验证用户是否是唯一的并且有资格购买会员资格。

对于这个验证，我创建了一个 BuyMembershipValidation 类来验证用户是否符合条件。

现在的问题是我必须将不同的参数对象传递给 BuyMembershipValidation 和 BuyMembership 类。这意味着数据被拆分。

有没有更好的方法来做到这一点。我是否应该只将部分信息加载到 BuyMembership 类中进行初始验证，然后再加载其余信息？

**更新：**

我需要验证他们何时进入向导（检查他们是否已经登录），如果没有，那么他们将注册为新用户，否则我必须检查他们是否有正确的设置来购买会员资格，因为所有用户都可以不买会员。这就是为什么我需要两组验证。一个用于他们是否有资格，另一个用于他们输入注册的实际数据。但是，我想重新检查他们在进行最终交易时是否符合条件，以防万一他们以某种方式通过了第一个向导步骤，或者稍后从其他地方调用了 Web 服务（我正在执行逻辑的地方）观点。

**另一个更新：**

我已经为我的决定添加了答案。

* * *

TIA，乔纳森。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T06:24:33.870

您实际上在这里谈论的是三件非常不同的事情，就像艾伦所说的那样，您需要按照单一职责的思路来正确地做这件事，就像 OOP 一样。

*   身份验证：确保用户是已知的
*   授权：确保用户可以访问应用程序中的某些逻辑
*   验证：确保用户输入的数据有效/安全/预期或需要的数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T01:01:19.013

验证者通常负责验证用户提供的信息，而不是授权。单一责任原则规定，在您的情况下，它们绝对应该由两个对象处理。

传递不同的参数对象很好，但我认为授权不应该真正传递给 BuyMembership 对象，这听起来像是应该在外部处理的东西。

我的 2 美分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T01:07:05.287

用户身份验证是一个广泛的话题。这实际上取决于您正在构建的应用程序类型。如果它是一个 Web 应用程序，我建议使用其中一种标准的身份验证方法：NTLM / kerberos

至于何时验证，我认为在调用实际的 Buy 方法之前推迟验证没有任何问题。只要在向导中的步骤期间，您不会向他们发布任何信息，而只是从表单中收集数据。您需要关注身份验证的主要时间是当您实际下订单或向用户发布信息时，这些信息应该被锁定在某个数据库中。

如果您提供有关您尝试做的事情的更多详细信息，我将完善我的答案以帮助您更多。这是一个相当广泛的问题，所以这是我现在能想到的最好的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T08:50:45.880

我决定只上一节课。原因是 IsEligible 和 Buy 方法中有共同的逻辑/行为。一个确定输入是否满足资格要求，另一个验证购买会员资格所需的所有详细信息是否有效。我真的不认为这与身份验证有关。身份验证在单独的 Web 控件中完成，我只检查 Identity.IsAuthenticated 和用户名以查看他们是否已登录。然后我检查他们的用户名，如果他们有资格购买，那么我让他们继续，否则显示错误消息. 在输入验证方面，我的网页上已经有验证控件，但我在这里关心的验证是服务器端业务逻辑验证。出于这个原因，我认为它应该在业务逻辑类中。不是一些与执行支付的逻辑分开的验证类。这可能只是我看待它的方式，但我认为这很符合 BDD 将验证保留在保存数据的实体内的想法。

# delphi - 我在哪里可以找到 Delphi 的照片浏览器或轮播控件？

> ID：534969
> 
> 赞同：0
> 
> 时间：2009-02-11T00:42:34.847
> 
> 标签：delphi, controls

Delphi 有什么好的图像、照片浏览器或轮播控件吗？

如果有的话，我更喜欢免费的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-11T07:03:54.510

它不是免费的，但[TMS Software GUI Motions](http://www.tmssoftware.com/site/guimotions.asp)似乎相当惊人： ![TMS 软件 GUI 运动](https://www.tmssoftware.com/site/img/screens/guim_tn_carousel.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T02:16:43.887

[Delphi Area 的PicShow Components](http://www.delphiarea.com/products/delphi-components/picshow/)看起来可以满足您的需求。我自己没试过，只是想起来了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T00:51:53.093

快速谷歌搜索会产生一些可能适合您需求的结果：

[一些星球源代码贡献](http://www.planet-source-code.com/vb/scripts/BrowseCategoryOrSearchResults.asp?txtCriteria=image+viewer&blnWorldDropDownUsed=TRUE&txtMaxNumberOfEntriesPerPage=10&blnResetAllVariables=TRUE&lngWId=7&B1=Quick+Search&optSort=Alphabetical)

[威尔逊图像查看器（我相信是 Delphi 5）](http://www.wilsonc.demon.co.uk/d6imageviewer.htm)

尽管有些代码可能已经过时，但这些示例可以让您走上正确的道路并为您提供一个起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T15:06:49.627

刚找到一个好。但似乎它不再更新:(

[GL场景](http://glscene.sourceforge.net/wikka/GlsceneDownloads)

但这正是我所需要的并且是免费的。

好的 TMS Software GUI Motions 它好多了。而且我想我会买它，但现在这个就可以了……</p>

# javascript - 在Javascript中查找复选框是否聚焦

> ID：534971
> 
> 赞同：1
> 
> 时间：2009-02-11T00:42:47.013
> 
> 标签：javascript, dom, checkbox

在 Javascript 中，如何判断复选框是否具有焦点？

我认为会有一个名为 isfocused 的方法或属性。但显然不是。

通过焦点，我的意思是他们已经使用键盘对其进行了标记，此时按空格键将选中该框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T00:51:08.010

创建一个连接到 onfocus 事件的事件处理程序。当它被调用时，设置一个全局变量来记住它有焦点。在清除变量的 onblur 事件上再写一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T00:50:34.623

当元素获得焦点时会触发 onfocus 事件。

```
<script type="text/javascript">

var isFocused = false;

</script>

<input type="checkbox" name="team" value="team" onfocus="javascript:isFocused = true;">Spurs<br> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-11T00:51:12.500

您可能只需要连接到复选框的 onfocus 和 onblur 事件，以跟踪它何时获得和失去焦点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T01:07:38.407

这是一个可能对您有所帮助的实现基础知识示例。注意：输出内容仅用于演示目的，而不是实际解决方案的一部分。

```
<html>
<head>
    <script type="text/javascript">

    onload = function()
    {
        var f = document.forms.test;
        f.focusedElem = null;
        updateOutput( f );

        for ( var i = 0, l = f.elements.length, elem; i < l; i++ )
        {
            elem = f.elements[i];
            elem.onfocus = function( elem )
            {
                return function()
                {
                    elem.form.focusedElem = elem;
                    updateOutput( elem.form );
                }
            }( elem )

            elem.onblur = function()
            {
                f.focusedElem = null;
                updateOutput( f )
            }
        }
    }

    function updateOutput( f )
    {
        document.getElementById( 'output' ).innerHTML = ( null == f.focusedElem ) ? 'Nothing!' : f.focusedElem.id;
    }

    </script>
</head>
<body>

<form name="test">

<input type="checkbox" name="foo" id="foo1">
<input type="checkbox" name="foo" id="foo2">
<input type="checkbox" name="foo" id="foo3">
<input type="checkbox" name="foo" id="foo4">

</form>

What has focus? <span id="output"></span>

</body>
</html> 
```

# web-services - 用于安全性和互操作性的理想 Web 服务框架

> ID：534972
> 
> 赞同：1
> 
> 时间：2009-02-11T00:43:11.537
> 
> 标签：web-services, programming-languages

我现在正在开始一个需要相当广泛的 Web 后端的项目。在不同的调用约定中，我们发现更简单且更具成本效益的方法是构建标准的 SOAP Web 服务。

所以现在，我们正在研究不同的 Web 服务框架，以确定哪些可以满足业务需求：

*   安全
*   成本
*   时间

我只使用过 WCF，对此我很满意，但我想在做出明确决定之前探索所有其他选项。根据您的经验，您认为最好的 Web 服务框架是什么？

Web 服务互操作性技术 (Java)？
WCF（.NET）？
ActionWebService（红宝石）？

附带说明一下，我们需要一个可以通过 iPhone、Windows 移动设备和黑莓安全访问的框架。

在此先感谢您的帮助。

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T00:52:19.317

WCF 可用于制作 SOAP 和 RESTful Web 服务。只要您遵守标准，就可以保证互操作性。但是你设置的标准越多，能赶上的平台就越少。从这个意义上说，基于 https 的 Basic Auth 上的 REST 将是非常轻量级的。另请参阅[WS-I 基本概要文件](http://en.wikipedia.org/wiki/WS-I_Basic_Profile)。我认为 Java 与 .NET 的区别在于口味。WCF 并不完美，但它似乎可以完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-14T19:07:48.890

关于 WCF 需要考虑的一件事是它具有非常丰富的可扩展性模型。任何它开箱即用的东西，你都可以教它去做，而对你的基本服务几乎没有改变。

# javascript - 用于打印的 Javascript 事件处理程序

> ID：534977
> 
> 赞同：8
> 
> 时间：2009-02-11T00:44:59.070
> 
> 标签：javascript, events, printing

我正在尝试在打印时更改样式：

javascript中是否有一个事件可以在调用file>>print时监听？它是什么？另外 - 打印完成时是否有处理程序？它是什么？

或者如果有更好的方法可以通过其他方式（例如样式表）来做到这一点，你是怎么做到的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-11T01:32:43.807

**不同的样式表**

您可以指定不同的样式表进行打印。

```
<link rel="stylesheet" type="text/css" media="print" href="print.css" />
<link rel="stylesheet" type="text/css" media="screen" href="main.css" /> 
```

**一个样式表**

正如 kodecraft 提到的，您还可以使用 @media 块将样式放入同一文件中。

```
@media print {
    div.box {
        width:100px;
    }
}

@media screen {
    div.box {
        width:400px;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T01:00:29.750

在 IE 中有非标准的 window.onBeforePrint() 和 window.onAfterPrint() 事件监听器。但是，据我所知，没有一种非 IE 方法可以做到这一点。

你试图做出什么样的改变？通过为您的打印样式表指定不同的规则，您的问题可能会得到解决。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-08-24T20:55:42.233

Firefox 6 现在支持 beforeprint 和 afterprint

[https://developer.mozilla.org/en/Printing#Detecting_print_requests](https://developer.mozilla.org/en/Printing#Detecting_print_requests)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T17:35:30.440

我们还发现，您可以使用以下内容制作仅打印样式：

```
<style type="text/css">
@media print {
    div
    {
        overflow:visible;
    }    
}
</style> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T00:53:39.423

IE有onbeforeprint和onafterprint

# c# - 我的 ItemsSource 语法可以吗？

> ID：534984
> 
> 赞同：0
> 
> 时间：2009-02-11T00:46:36.880
> 
> 标签：c#, wpf, xaml, itemssource

我有以下 XAML。假设 FruitList 是 Fruits 的集合，每个 FruitSeeds 都有一个 FruitSeeds 集合。是否有将 cbxFruitSeeds 绑定到 FruitSeeds 集合的语法，具体取决于在 cbxFruits 中选择了哪个 Fruit？

```
<GridView>

    <GridViewColumn Header="Fruits">

        <GridViewColumn.CellTemplate>

            <DataTemplate>

                <ComboBox DisplayMemberPath="Fruit.Name" ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ItemsControl}}, Path=DataContext.FruitList}" x:Name="cbxFruits"/>

            </DataTemplate>

    </GridViewColumn.CellTemplate>

</GridViewColumn>

    <GridViewColumn Header="FruitSeeds">

        <GridViewColumn.CellTemplate>

            <DataTemplate>

                <ComboBox x:Name="cbxFruitSeeds"></ComboBox>

            </DataTemplate>

        </GridViewColumn.CellTemplate>

    </GridViewColumn>

</GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-11T01:08:02.570

看起来你正在尝试做一个级联组合框。

[真的没有办法在xaml绑定中跟进数据集父关系吗？](https://stackoverflow.com/questions/202990/is-there-really-no-way-to-follow-up-dataset-parent-relation-in-xaml-binding)展示了如何在 xaml 中进行父子设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-12T14:28:31.363

有两种方法可以正确地做到这一点。

1.  将集合视图设置为第二个组合框的源，然后设置第一个组合框以更改该集合视图上的过滤器。
2.  让第一个组合框的项目的数据类型每个都包含第二个组合框的项目列表。当第一个组合框被选中时，它的结果被设置为第二个的数据上下文，然后将第二个绑定到包含的列表。

第一个更可取，因为您不需要将水果类型存储在保存用户选择的数据中。第一个组合框由配置或元数据填充。

# algorithm - 我可以使用什么算法来确定半圆内的点？

> ID：534989
> 
> 赞同：11
> 
> 时间：2009-02-11T00:50:01.397
> 
> 标签：algorithm, optimization, geometry

我有一个二维点列表，我想获得它们中的哪些落在半圆内。

最初，目标形状是与 x 和 y 轴对齐的矩形。因此，当前算法通过它们的 X 坐标和二进制搜索对可能落在矩形内的第一个对进行排序。然后它依次迭代每个点。当它碰到一个超出目标矩形的 X 和 Y 上限的位置时，它会停止。

这不适用于半圆，因为您无法为其确定有效的上/下 x 和 y 边界。半圆可以有任何方向。

最坏的情况是，我会在半圆中找到维度（比如 x）的最小值，二分搜索到超出它的第一个点，然后依次测试这些点，直到超出该维度的上限。基本上是在网格上测试整个乐队的分数。问题是这将最终检查许多不在范围内的点。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-11T01:08:03.740

检查一个点是在半圆（或矩形）内部还是外部是一个常数时间操作。

检查 N 个点位于半圆或矩形的内部或外部是 O(N)。

对 N 个点进行排序是 O(N*lg(N))。

顺序测试所有点比排序然后基于二分搜索快速剔除点要快。

这可能是那些看起来快和快是两种不同事物的时代之一。

**编辑**

还有一种非常简单的方法可以测试半圆中某个点的包容性，而无需使用旋转、变换等。

将半圆表示为两个分量：

*   从 a 点到**b点****的**线段代表半圆的直径
***   *left-of*或*right-of*的方向，表示半圆在从**a**到**b**行进时位于线段**ab的左侧或右侧****

 ******您可以利用右手定则来确定该点是否在半圆内。

然后一些伪代码来测试点**p**是否在半圆中，例如：

```
procedure bool is_inside:
    radius = distance(a,b)/2
    center_pt = (a+b)/2    
    vec1 = b - center_pt
    vec2 = p - center_pt
    prod = cross_product(vec1,vec2) 
    if orientation == 'left-of'
        return prod.z >= 0 && distance(center_pt,p) <= radius
    else
        return prod.z <= 0 && distance(center_pt,p) <= radius 
```

此方法的另一个好处是不使用任何三角函数，您可以通过与平方距离进行比较来消除所有平方根。您还可以通过缓存 'vec1' 计算、半径计算、center_pt 计算并重新排序几个操作以提早退出来加速它。但我试图澄清。

'cross_product' 返回一个 (x,y,z) 值。它检查 z 分量是正还是负。这也可以通过不使用真正的叉积而只计算 z 分量来加速。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-11T00:57:26.213

首先，平移和旋转半圆，使一端在负 X 轴上，另一端在正 X 轴上，以原点为中心（当然，您不会实际平移和旋转它，您将获得可以平移和旋转它的适当数字，并在下一步中使用它们）。

然后，您可以将其视为一个圆，忽略所有负 y 值，只使用 X 和 Y 的平方和的平方根进行测试，看看它是否小于或等于半径。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-11T01:23:29.007

> “也许他们可以暴力破解，因为他们有一个完整的 GPU 专用于他们。”

如果您有 GPU 供您使用，那么还有更多方法可以做到这一点。例如，使用模板缓冲区：

*   清除模板缓冲区并将模板操作设置为递增
*   将你的半圆渲染到模板缓冲区
*   提出你的观点
*   读回像素并检查您的点的值
*   半圆内的点将增加两次。

[本文](http://www.opengl.org/resources/code/samples/sig99/advanced99/notes/node117.html)介绍了如何在 OpenGL 中使用模板缓冲区。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-11T00:58:10.143

如果有这样做的标准算法，我相信其他人会想出它，但如果没有：您可以尝试按距圆心的距离对点进行排序，并仅迭代那些距离小于半圆的半径。或者，如果计算距离很昂贵，我会尝试找到半圆的边界框（甚至是半圆所在的圆的边界正方形）并迭代该范围内的点。在某种程度上它取决于点的分布，即您希望它们中的大多数还是只有一小部分落在半圆内？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-11T01:42:21.490

您可以在给定斜率的一侧找到圆中的点，对吗？

只需将两者结合起来。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-11T03:20:22.923

这是我编写的函数的一部分，它确实为基于瓷砖的游戏中的武器提供锥形发射弧。

```
float lineLength;
float lineAngle;
for(int i = centerX - maxRange; i < centerX + maxRange + 1; i++){
    if(i < 0){
        continue;
    }
    for(int j = centerY -  maxRange; j < centerY + maxRange + 1; j++){
        if(j < 0){
            continue;
        }

        lineLength = sqrt( (float)((centerX - i)*(centerX - i)) + (float)((centerY - j)*(centerY - j)));
        lineAngle = lineAngles(centerX, centerY, forwardX, forwardY, centerX, centerY, i, j);

        if(lineLength < (float)maxRange){
            if(lineAngle < arcAngle){
                if( (float)minRange <= lineLength){ 
                    AddToHighlightedTiles(i,j);
                }
            }
        }
    }
} 
```

变量应该是不言自明的，线角度函数需要 2 条线并找到它们之间的角度。根据您指向的角度，forwardX 和 forwardY 只是从中心 X 和 Y 沿正确方向的一个图块。这些可以通过 switch 语句轻松获得。

```
float lineAngles(int x1, int y1, int x2, int y2, int x3, int y3, int x4, int y4){
    int a = x2 - x1;
    int b = y2 - y1;
    int c = x4 - x3;
    int d = y4 - y3;

    float ohSnap = ( (a * c) + (b * d) )/(sqrt((float)a*a + b*b) * sqrt((float)c*c + d*d) );
    return acos(ohSnap) * 180 / 3.1415926545f;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-11T02:16:53.433

*   将弧的中心平移到原点
*   计算纵坐标轴与半圆半径端点之间的角度
*   用相同的 dx,dy 翻译问题点
*   计算从原点到平移 x,y 点的距离，如果 d > 圆/弧的半径消除

    *   计算纵坐标轴和终点之间的角度
    *   如果角度不在半圆的起点和终点弧之间，则消除

    剩余点应在半圆内

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-11T03:39:05.233

我想有人在这里找到了与我相同的解决方案，但我没有代码可以显示，因为它在我的记忆中很远......

我会按步骤进行...
1.我会看看我是否在一个圆圈内...如果是的话，看看圆圈的哪一边。
2\. 通过绘制一个来自半球体的向量的法线向量。我可以知道我是在向量的后面还是前面……如果你知道哪一边是半球，哪一边是虚空……如果你在向量之内，那将非常容易找到半球形。你必须做点积。

我不确定它是否足够清楚，但测试不应该那么难做......最后你必须寻找一个负值或正值......如果它是 0 你在向量上半球，所以由你决定它是在半球之外还是在半球内。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-11T16:26:51.880

最快的方法将取决于您的典型数据。如果您要查看真实世界的数据，请先执行此操作。当点在半圆之外时，通常是因为它们在圆之外吗？您的半圆形通常是薄饼片吗？

有几种方法可以用向量来做到这一点。您可以将圆缩放为单位圆并使用叉积并查看结果向量。您可以使用点积并查看预期点如何落在其他向量上。

如果你想要一些非常容易理解的东西，首先检查以确保它在圆内，然后获取角度并确保它在决定半圆的两个向量的角度之间。

* * *

编辑：我忘记了半圆总是半圆。我在想一个圆的任意部分。

现在我已经记住了半圆是什么，这就是我将如何做到的。它类似于 stbuton 的解决方案，但它以不同的方式表示半圆。

我将半圆表示为平分半圆的单位向量。您可以通过交换 x 和 y 并取反其中一个，轻松地从指示半圆边界的任一向量（因为它们与表示相距 90 度）中得到它。

现在，您只需穿过从圆心减去要测试的点所创建的向量。z 的符号告诉您该点是否在半圆中，并且 z 的长度可以与半径进行比较。

我为 Cool Pool 做了所有的物理（来自 Sierra Online）。这一切都是在向量中完成的，并且充满了点和十字。向量解决方案很快。Cool Pool 能够在 P60 上运行，并进行了合理的休息甚至旋转。

注意：对于检查 sqrt(x *x+y* y) 的解决方案，甚至不要执行 sqrt。相反，保持半径的平方并与之进行比较。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-01T01:25:02.063

看起来一个简单的方案在这里可以工作。

1.  通过首先计算凸包来减少集合中的点数。只有凸包上的点将有助于与任何凸边界形状的任何交互。所以只保留船体周边的点子集。

2.  可以很容易地认为，最小半径边界半圆必须具有凸包的一个边缘（两个点）沿半圆的直径重合。即，如果船体的某些边缘不在直径范围内，则存在一个直径较小的不同半圆，其中包含相同的点集。

3.  依次测试每条边。（凸包通常有相对较少的边，所以这会很快。）现在它变成了一个简单的一维最小化问题。如果我们选择假设所讨论的边缘位于直径上，那么我们只需要找到球的中心。它必须位于我们认为是直径的当前线。因此，作为该点沿当前直径的位置的函数，只需找到离标称中心最远的点。通过最小化该距离，我们找到沿该线的最小半圆的半径作为直径。

现在，只需选择在凸包所有边缘上找到的最佳半圆。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-09-28T16:05:17.513

如果您的点具有整数坐标，则最快的解决方案可能是查找表。由于半圆是凸的，对于每个 y 坐标，您会得到一个固定范围的 x，因此查找表中的每个条目都会给出最大和最小 X 坐标。

当然你仍然需要预先计算表格，如果你的半圆不是固定的，你可能会做很多。也就是说，这基本上是曾经渲染半圆的一部分——通过重复调用水平线绘制函数，整个形状将被渲染为一系列水平跨度。

首先要计算跨度（如果需要重复计算），您可能需要查找 Michael Abrash 的图形编程禅宗的旧副本。这描述了 Bresenhams 著名的直线算法和不太知名的 Hardenburghs 圆算法。将两者的面向跨度的版本结合起来快速计算半圆的跨度应该不会太难。

IIRC，Hardenburgh 使用 x^2 + y^2 = 半径^2，但利用了您正在逐步通过跨度以避免计算平方根的事实 - 我认为它使用了 (x+1)^2 = x 的事实^2 + 2x + 1 and (y-1)^2 = y^2 - 2y + 1，保持x、y、x^2和(radius^2 - y^2)的运行值，所以每一步只需要比较（当前 x^2 + y^2 是否太大）和一些补充。它只针对一个八分圆（确保单像素步长的唯一方法），并通过对称扩展到整个圆。

一旦你有了整个圆圈的跨度，应该很容易使用 Bresenhams 来切断你不想要的一半。

当然，只有在您绝对确定需要（并且可以使用整数）时，您才会执行所有这些操作。否则坚持使用stbuton。

# delphi - 我在哪里可以找到 Delphi 的地图控件？

> ID：534990
> 
> 赞同：6
> 
> 时间：2009-02-11T00:50:14.407
> 
> 标签：delphi, geolocation, maps, gis

我正在尝试在应用程序中构建一个选项，让用户查看地图。此地图必须是可编辑的，并且启用了标签。还应该可以看到不同颜色的子区域，并突出显示鼠标下方的那个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T08:13:22.203

TGlobe 不错，但自 2004 年以来一直没有更新，如果您需要的不仅仅是显示地图，还需要构建类似 GIS 的应用程序，我建议使用以下其中一种：

1.  [TatukGIS](http://www.tatukgis.com/Home/home.aspx)（非常强大的 GIS 组件和原生 VCL 编写）。
2.  [卡托VCL](http://cartovcl.com/)。
3.  [MapObjects](http://www.esri.com/software/mapobjects/index.html)（领先的 GIS 公司，但组件是 ActiveX）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-11T01:02:13.583

曾经有一个名为[TGlobe](https://web.archive.org/web/20090201162449/http://tglobe.com/)的组件，我从未使用过。该网站自 2009 年以来一直没有更新，自 2013 年起不再可用。

> *   TGlobe 5 是 Delphi 5、6、7、2005 以及 CBuilder 5 和 6 的 VCL 组件。
> *   TGlobe 显示可以实时旋转、平移和缩放的地球仪。地球包含点、线和多边形形式的地图数据。
> *   TGlobe 将地图数据组织成图层。这些层可以嵌套在一起以构建相关层的层次结构。
> *   TGlobe 可以在地球的 3D 球面视图和笛卡尔、墨卡托或用户定义的投影之间切换。

![替代文字](https://web.archive.org/web/20010619210158im_/http://www.tglobe.com/images/tImage2.jpg)

# web-applications - 处理动态演示内容

> ID：534998
> 
> 赞同：1
> 
> 时间：2009-02-11T00:51:31.113
> 
> 标签：web-applications

我想知道其他人通常使用哪些技术来为他们的网络应用程序的表示层持久化动态内容信息。例如，我的客户希望通过管理部分更改主页上的一些图像。当然，可以为此创建一个数据库表，但对我来说感觉不太合适。一，缓存是一个问题。第二，我更喜欢为域类型数据保留数据库，而不是表示数据。也许是通过基础设施层访问的 xml 文件？还有其他选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-08-13T09:06:29.620

如果软件代码对于多个站点是唯一的，并且客户编辑自己的页面等，我倾向于将其视为应用程序业务的一部分，然后将图像路径和（最终）图像文件存储在数据库中，利用在 UI 模板中缓存并用于渲染。如果软件代码对于一个客户来说是唯一的，或者最终如果他们只是客户软件的一个实例，那么我倾向于将定制视为一个集成步骤，并使用 XML 文件将所有内容存储在 UI 层中路径（我可能没有管理页面）。

# list - Erlang，列表理解语法

> ID：534999
> 
> 赞同：10
> 
> 时间：2009-02-11T00:51:39.800
> 
> 标签：list, erlang, list-comprehension

我在 Erlang 中看到了这段代码：

```
[X-$0 || X<-someFun()] 
```

在那一行中，我发现`-$0`语法非常有用。

我阅读了代码并估计了它的含义，但我不太确定：它是否拆分了所有数字？

我想查看该语法的解释或手册页，但找不到。谁能告诉我正确的页面？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-11T04:10:35.953

该代码所做的是从`someFun()`（需要返回一个列表）获取输出，并且对于列表中的每个元素，它将元素的值分配给变量`X`，然后从该值中减去字符的 ASCII`0`值。结果列表就是整个表达式的值。

在实践中（我自己已经编写了数十次此代码）它在做什么，假设这`someFun/0`是一个函数，它返回一个只有数字的字符串，然后将该字符串转换为数字列表。所以，如果`someFun()`返回 " `12345`"，这个列表推导的结果是`[1, 2, 3, 4, 5]`.

如果您熟悉`map`函数的概念（如 MapReduce），那么现在听起来应该很熟悉。

这个 wikibooks 页面看起来像是对 Erlang 列表推导的一个很好的介绍：

[http://en.wikibooks.org/wiki/Erlang_Programming/List_Comprehensions](http://en.wikibooks.org/wiki/Erlang_Programming/List_Comprehensions)

Joe Armstrong 的书“Programming Erlang”，来自 Pragmatic Bookshelf，（[http://pragprog.com/titles/jaerlang/programming-erlang](http://pragprog.com/titles/jaerlang/programming-erlang)）也很好地涵盖了列表推导（以及与 Erlang 相关的所有其他内容）。好书，强烈推荐等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T07:25:51.040

列表推导的常规文档页面在[Erlang 参考手册](http://www.erlang.org/doc/reference_manual/users_guide.html)第 6.22 节和[编程示例](http://www.erlang.org/doc/programming_examples/users_guide.html)第 3 节中。

这两个都在[主文档页面上](http://erlang.org/doc/)（单击左侧菜单栏上的 Erlang 编程文件夹）。

Erlang 文档非常棒 - 只是它的布局有点笨拙......*************``********