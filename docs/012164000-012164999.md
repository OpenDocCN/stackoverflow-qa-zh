# StackOverflow 问答 12164000-12164999

# crystal-reports - 水晶报表对象能否公开数据表

> ID：12164004
> 
> 赞同：0
> 
> 时间：2012-08-28T16:56:06.567
> 
> 标签：crystal-reports

再会。

我们通过为报表提供数据表来创建水晶报表。

```
 myReport.dataSource = myDataTable 
```

有没有办法在代码后面从报表对象中获取数据表？

```
 DataTable myDataTable = myReport.getDataSource() 
```

谢谢 ST

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T07:47:36.610

我认为您可以通过以下方式做到这一点

```
 DataTable myDataTable = myReport.Database.Tables[0]; 
```

# dns - 使用 cname 指向主域

> ID：12164005
> 
> 赞同：2
> 
> 时间：2012-08-28T16:56:09.763
> 
> 标签：dns, cname

我需要使用 CNAME 将一个域指向另一个域，但我需要将两者都指向主域 www。

我认为使用 cname 是不可能的。我需要将域指向其他域，例如 cname，但也需要主域。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:01:22.243

要重定向整个域，您实际上希望使用 DNAME 而不是 CNAME。你也可以做 CNAME 记录，但你需要一个 CNAME 对应每一个相等的记录，而 DNAME 只允许你做一个。但是，DNAME 记录并没有得到很好的支持。

# javascript - 使用 jQuery 的 wysihtml5 解析器问题

> ID：12164015
> 
> 赞同：2
> 
> 时间：2012-08-28T16:56:39.750
> 
> 标签：javascript, jquery, html, wysiwyg

我使用了 wysihtml5 bootstrap 提供的标准解析器，只是链接没有提供正确的 href 属性。我如何使用他们给你的解析器来改变它。

使用脚本...

```
<link rel="stylesheet" type="text/css" href="/css/bootstrap-wysihtml5.css"></link>
<link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css"></link>
<script src="js/wysihtml5-0.3.0.js"></script>
<script src="js/jquery-1.7.2.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/bootstrap-wysihtml5.js"></script> 
```

解析器来源：[https ://github.com/xing/wysihtml5/blob/master/parser_rules/advanced.js](https://github.com/xing/wysihtml5/blob/master/parser_rules/advanced.js)

解析器摘录：

```
* The following options are available:
 *
 *    - add_class:        converts and deletes the given HTML4 attribute (align, clear, ...) via the given method to a css class
 *                        The following methods are implemented in wysihtml5.dom.parse:
 *                          - align_text:  converts align attribute values (right/left/center/justify) to their corresponding css class "wysiwyg-text-align-*")
 *                            <p align="center">foo</p> ... becomes ... <p> class="wysiwyg-text-align-center">foo</p>
 *                          - clear_br:    converts clear attribute values left/right/all/both to their corresponding css class "wysiwyg-clear-*"
 *                            <br clear="all"> ... becomes ... <br class="wysiwyg-clear-both">
 *                          - align_img:    converts align attribute values (right/left) on <img> to their corresponding css class "wysiwyg-float-*"
 *                          
 *    - remove:             removes the element and its content
 *
 *    - rename_tag:         renames the element to the given tag
 *
 *    - set_class:          adds the given class to the element (note: make sure that the class is in the "classes" white list above)
 *
 *    - set_attributes:     sets/overrides the given attributes
 *
 *    - check_attributes:   checks the given HTML attribute via the given method
 *                            - url:            allows only valid urls (starting with http:// or https://)
 *                            - src:            allows something like "/foobar.jpg", "http://google.com", ...
 *                            - href:           allows something like "mailto:bert@foo.com", "http://google.com", "/foobar.jpg"
 *                            - alt:            strips unwanted characters. if the attribute is not set, then it gets set (to ensure valid and compatible HTML)
 *                            - numbers:  ensures that the attribute only contains numeric characters
    "a": {
        "check_attributes": {
            "href": "href"
        },
        "set_attributes": {
            "rel": "nofollow",
            "target": "_blank"
        }
    }, 
```

所以基本上我要做的是获取所有的 a 标签并将它们的 href 属性设置为它们的内容。或禁用解析器删除我的 href 属性的倾向。这可能是一个错误吗？

# jquery - jquery 不适用于我的 html

> ID：12164018
> 
> 赞同：0
> 
> 时间：2012-08-28T16:56:51.593
> 
> 标签：jquery

> **可能重复：**
> [preventDefault() 对我不起作用](https://stackoverflow.com/questions/12162217/preventdefault-wont-work-for-me)

我有这个 HTML 代码

```
<div id="nav-bar">  
  <span>  
        <a href="check.html">check</a>  
      </span>  
</div> 
```

现在我正在尝试为此锚标记绑定点击事件并使用 stopPropagation 但它不起作用。

```
$('div#nav-bar').filter('a').click(function(event){
    event.preventDefault();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:01:10.103

你在滥用`.filter()`. 这是为了缩小 jQuery 对象的选择范围。将在 jQuery 对象的元素中查找匹配的元素（因此*将*`.find()`在元素中查找）。*`$('div#nav-bar').find('a')``<a>``<div id="nav-bar">`*

 *但是，如果您直接使用直接选择器，您也会发现更好的里程数：

```
$('#nav-bar a').click(function (e) {
    e.preventDefault();
}); 
```

选择器`#nav-bar a`选择`<a>`元素内的所有`#nav-bar`元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T16:58:16.300

您应该使用从以下[`find()`](http://api.jquery.com/find/)位置获取`<a>`元素`#nav-bar`：

```
$('#nav-bar').find('a').click(function(event) {
    event.preventDefault();
}); 
```

另一种选择是[更改选择器](http://api.jquery.com/descendant-selector/)：

```
$('#nav-bar a').click(function(event) {
    event.preventDefault();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T16:58:45.397

```
$('#nav-bar a').click(function(event){
    event.preventDefault();
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T16:59:12.147

```
$('#nav-bar').on("click", "a", function(event){
    event.preventDefault();
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T16:59:13.807

你不需要`.find()`也不需要`e.preventDefault()`。（显然你不需要`.filter()`.

```
<div id="nav-bar">  
  <span>  
        <a href="#" data-url="check.html">check</a>  
      </span>  
</div>

$('div#nav-bar  a').click(function(){
   var url = $(this).data('url');
   window.location.href = url;
}); 
```*

# android - Android 打开和保存文件到/从 Google Drive SDK

> ID：12164024
> 
> 赞同：61
> 
> 时间：2012-08-28T16:57:30.387
> 
> 标签：android, google-drive-api

在过去的六个小时里，我一直在翻阅来自 Google 的文档，但我仍然不知道如何开始。我想做的就是让我现有的 Android 应用程序可以从 Google Drive 读取文件，将新文件上传到 Google Drive，并编辑 Google Drive 上的现有文件。

我读过 Drive SDK v2 只专注于让 Android（和一般的移动设备）开发人员更容易使用它，但他们的文档中似乎几乎没有关于它的内容。

理想情况下，我希望有人指出一些体面的文档、示例或教程，涵盖如何执行此操作（请记住，我使用的是 Android。他们有很多关于如何将 Drive 与 Google App Engine 一起使用的资料；我已经看过它，但我不知道如何从它转到 Android 应用程序。）

我需要知道我需要下载哪些库并将其添加到我的项目中，我需要添加到我的清单中，以及我最终如何从 Google Drive 中获取文件列表，下载一个，然后上传修改后的版本。

理想情况下，我希望它能够像官方的 Google Drive 应用程序那样自动处理帐户。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-09-07T15:41:10.477

编辑：克劳迪奥凯鲁比诺说谷歌播放服务现在可用，这将使这个过程更容易。但是，没有可用的示例代码（但是，他说它即将推出......他们说 Google Play 服务在 4 个月前“即将推出”，所以这个答案很有可能继续成为唯一完全有效的访问示例Google Drive 从您的 Android 应用程序到 2013 年。）

编辑 2X：当我说谷歌要到明年才会有一个可行的例子时，看起来我已经离开了大约一个月。谷歌官方指南在这里：

[https://developers.google.com/drive/quickstart-android](https://developers.google.com/drive/quickstart-android)

我还没有测试他们的方法，所以我从 2012 年 9 月（下）开始的解决方案可能仍然是最好的：

为此不需要 Google Play 服务。真是让人头疼，我花了 50 多个小时（编辑：100 多个小时）来弄清楚这一切，但这里有很多事情有助于了解：

**图书馆**

一般来说，对于 Google 的在线服务，您的项目中需要这些库：（[说明和下载链接](http://code.google.com/p/google-api-java-client/wiki/Setup)）

*   google-api-client-1.11.0-beta.jar
*   google-api-client-android-1.11.0-beta.jar
*   google-http-client-1.11.0-beta.jar
*   google-http-client-android-1.11.0-beta.jar
*   google-http-client-jackson-1.11.0-beta.jar
*   google-oauth-client-1.11.0-beta.jar
*   番石榴-11.0.1.jar
*   杰克逊核心asl-1.9.9.jar
*   jsr305-1.3.9.jar

特别是对于 Google Drive，你还需要这个：

*   google-api-services-drive-v2-rev9-1.8.0-beta.jar（[下载链接](http://mavenrepo.google-api-java-client.googlecode.com/hg/com/google/apis/google-api-services-drive/v2-rev9-1.8.0-beta/)）

**设置控制台**

接下来，转到[Google Console](https://code.google.com/apis/console/)。做一个新项目。在服务下，您需要打开两件事：**DRIVE API**和**DRIVE SDK**！它们是分开的，一个不会自动打开另一个，**您必须同时打开！**（弄清楚这一点浪费了我至少 20 个小时的时间。）

仍然在控制台上，转到 API 访问。创建一个客户端，使其成为 Android 应用程序。给它你的包 ID。我认为指纹这件事实际上并不重要，因为我很确定我使用了错误的指纹，但无论如何都要尽量做到这一点（谷歌提供了相关说明。）

它将生成一个**Client ID**。你会需要那个。坚持下去。

编辑：我被告知我弄错了，你只需要打开 Drive API，Drive SDK 根本不需要打开，你只需要使用 Simple API Key，而不是设置为 Android 做点什么。我现在正在调查这个问题，如果我弄清楚的话，可能会在几分钟内编辑这个答案......

**ANDROID 代码 - 设置和上传**

首先，获取一个身份验证令牌：

```
AccountManager am = AccountManager.get(activity);
am.getAuthToken(am.getAccounts())[0],
    "oauth2:" + DriveScopes.DRIVE,
    new Bundle(),
    true,
    new OnTokenAcquired(),
    null); 
```

接下来，需要像这样设置 OnTokenAcquired()：

```
private class OnTokenAcquired implements AccountManagerCallback<Bundle> {
    @Override
    public void run(AccountManagerFuture<Bundle> result) {
        try {
            final String token = result.getResult().getString(AccountManager.KEY_AUTHTOKEN);
            HttpTransport httpTransport = new NetHttpTransport();
            JacksonFactory jsonFactory = new JacksonFactory();
            Drive.Builder b = new Drive.Builder(httpTransport, jsonFactory, null);
            b.setJsonHttpRequestInitializer(new JsonHttpRequestInitializer() {
                @Override
                public void initialize(JSonHttpRequest request) throws IOException {
                    DriveRequest driveRequest = (DriveRequest) request;
                    driveRequest.setPrettyPrint(true);
                    driveRequest.setKey(CLIENT ID YOU GOT WHEN SETTING UP THE CONSOLE BEFORE YOU STARTED CODING)
                    driveRequest.setOauthToken(token);
                }
            });

            final Drive drive = b.build();

            final com.google.api.services.drive.model.File body = new com.google.api.services.drive.model.File();
            body.setTitle("My Test File");
    body.setDescription("A Test File");
    body.setMimeType("text/plain");

            final FileContent mediaContent = new FileContent("text/plain", an ordinary java.io.File you'd like to upload. Make it using a FileWriter or something, that's really outside the scope of this answer.)
            new Thread(new Runnable() {
                public void run() {
                    try {
                        com.google.api.services.drive.model.File file = drive.files().insert(body, mediaContent).execute();
                        alreadyTriedAgain = false; // Global boolean to make sure you don't repeatedly try too many times when the server is down or your code is faulty... they'll block requests until the next day if you make 10 bad requests, I found.
                    } catch (IOException e) {
                        if (!alreadyTriedAgain) {
                            alreadyTriedAgain = true;
                            AccountManager am = AccountManager.get(activity);
                            am.invalidateAuthToken(am.getAccounts()[0].type, null); // Requires the permissions MANAGE_ACCOUNTS & USE_CREDENTIALS in the Manifest
                            am.getAuthToken (same as before...)
                        } else {
                            // Give up. Crash or log an error or whatever you want.
                        }
                    }
                }
            }).start();
            Intent launch = (Intent)result.getResult().get(AccountManager.KEY_INTENT);
            if (launch != null) {
                startActivityForResult(launch, 3025);
                return; // Not sure why... I wrote it here for some reason. Might not actually be necessary.
            }
        } catch (OperationCanceledException e) {
            // Handle it...
        } catch (AuthenticatorException e) {
            // Handle it...
        } catch (IOException e) {
            // Handle it...
        }
    }
} 
```

**ANDROID 代码 - 下载**

```
private java.io.File downloadGFileToJFolder(Drive drive, String token, File gFile, java.io.File jFolder) throws IOException {
    if (gFile.getDownloadUrl() != null && gFile.getDownloadUrl().length() > 0 ) {
        if (jFolder == null) {
            jFolder = Environment.getExternalStorageDirectory();
            jFolder.mkdirs();
        }
        try {

            HttpClient client = new DefaultHttpClient();
            HttpGet get = new HttpGet(gFile.getDownloadUrl());
            get.setHeader("Authorization", "Bearer " + token);
            HttpResponse response = client.execute(get);

            InputStream inputStream = response.getEntity().getContent();
            jFolder.mkdirs();
            java.io.File jFile = new java.io.File(jFolder.getAbsolutePath() + "/" + getGFileName(gFile)); // getGFileName() is my own method... it just grabs originalFilename if it exists or title if it doesn't.
            FileOutputStream fileStream = new FileOutputStream(jFile);
            byte buffer[] = new byte[1024];
            int length;
            while ((length=inputStream.read(buffer))>0) {
                fileStream.write(buffer, 0, length);
            }
            fileStream.close();
            inputStream.close();
            return jFile;
        } catch (IOException e) {        
            // Handle IOExceptions here...
            return null;
        }
    } else {
        // Handle the case where the file on Google Drive has no length here.
        return null;
    }
} 
```

最后一件事......如果该意图被发送出去，您需要在它返回结果时进行处理。

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    if (requestCode == 3025) {
        switch (resultCode) {
            case RESULT_OK:
                AccountManager am = AccountManager.get(activity);
                am.getAuthToken(Same as the other two times... it should work this time though, because now the user is actually logged in.)
                break;
            case RESULT_CANCELED:
                // This probably means the user refused to log in. Explain to them why they need to log in.
                break;
            default:
                // This isn't expected... maybe just log whatever code was returned.
                break;
        }
    } else {
        // Your application has other intents that it fires off besides the one for Drive's log in if it ever reaches this spot. Handle it here however you'd like.
    }
} 
```

**ANDROID 代码 - 更新**

关于更新 Google Drive 上文件的最后修改日期的两个快速说明：

1.  您必须提供完全初始化的 DateTime。如果不这样做，您将收到来自 Google Drive 的“错误请求”响应。
2.  您必须在来自 Google Drive 的文件上使用 setModifiedDate() 并在更新请求本身上使用 setSetModifiedDate(true)。（有趣的名字，嗯？“setSet[...]”，人们不可能打错那个...）

下面是一些简短的示例代码，展示了如何进行更新，包括更新文件时间：

```
public void updateGFileFromJFile(Drive drive, File gFile, java.io.File jFile) throws IOException {
    FileContent gContent = new FileContent("text/csv", jFile);
    gFile.setModifiedDate(new DateTime(false, jFile.lastModified(), 0));
    gFile = drive.files().update(gFile.getId(), gFile, gContent).setSetModifiedDate(true).execute();
} 
```

**清单**

您将需要以下权限：GET_ACCOUNTS、USE_CREDENTIALS、MANAGE_ACCOUNTS、INTERNET，并且很有可能您还需要 WRITE_EXTERNAL_STORAGE，具体取决于您希望将文件的本地副本存储在何处。

**您的构建目标**

右键单击您的项目，进入它的属性，如果必须，在 Android 下将构建目标更改为 Google API。如果它们不存在，请从 android 下载管理器下载它们。

如果您在模拟器上进行测试，请确保其目标是 Google API，而不是通用 Android。

您需要在测试设备上设置 Google 帐户。所编写的代码将自动使用它找到的第一个 Google 帐户（这就是 [0] 的含义）。如果您需要下载 Google Drive 应用程序才能使其正常工作，请使用 IDK。我使用的是 API Level 15，我不知道这段代码可以工作多远。

**其余的部分**

以上应该让你开始，希望你能从那里找到出路......老实说，这就是我到目前为止所获得的。我希望这可以帮助很多人，并为他们节省很多时间。我相当肯定我刚刚编写了最全面的设置指南来设置 Android 应用程序以使用 Google Drive。Google 感到羞耻，因为他们在至少 6 个完全不相互链接的不同页面上传播了必要的材料。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T17:23:37.720

观看 Google I/O 的此视频，了解如何将您的 Android 应用与云端硬盘集成：

[http://www.youtube.com/watch?v=xRGyzqD-vRg](http://www.youtube.com/watch?v=xRGyzqD-vRg)

请注意，您在视频中看到的内容基于 Google Play 服务：

[https://developers.google.com/android/google-play-services/](https://developers.google.com/android/google-play-services/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-18T01:36:33.520

**现在是 2015 年，情况发生了变化！**

使用 gradle 获取“Drive API for Android”：

```
compile 'com.google.android.gms:play-services-drive:7.8.0' 
```

有一些新的 doco（尽管 IMO 仍然乏善可陈）：

[https://developers.google.com/drive/web/quickstart/android](https://developers.google.com/drive/web/quickstart/android)

对于那些即将去洞穴的人......到目前为止我遇到的最大问题是绝对没有办法区分已永久删除的文件夹和正常文件夹......你可以找到它们，你可以创建文件夹和其中的文件，仅写入文件 DriveContents 将始终失败。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-27T23:17:44.787

看看 Google 的[DrEdit Example](https://github.com/googledrive/dredit)，它有一个名为`android/`. 复制它，按照`readme`，它应该可以工作（在带有 KitKat 的 Android 模拟器上对我有用）。

.

**附言**

抱歉恢复了这个，但是新的[Google Drive Android API](https://developers.google.com/drive/android/)不支持完全的 Drive 访问，只有`drive.file`和`drive.appdata` [授权范围](https://developers.google.com/drive/web/scopes)，所以如果你需要完全访问，你必须回到好的 'ol [Google API's Client for Java](https://code.google.com/p/google-api-java-client/)（DrEdit示例使用）。

# php - 选择数组中位于 2 个特定元素之间的所有元素

> ID：12164029
> 
> 赞同：1
> 
> 时间：2012-08-28T16:57:43.157
> 
> 标签：php, arrays

我有一个普通的、无聊的旧数组，里面有很多数据。假设数组的结构如下：

`$myArray = array( 'a','b','c','START','d','e','f','END' );`

现在，我只需要选择 START 之后但 END 之前的值。因此，在本例中，我需要选择值“d”、“e”和“f”。

这是棘手的部分；START 将始终存在，但 END 可能存在也可能不存在（这是从服务器返回数据的方式）。如果 START 和 END 都存在，那么我只需要 2 之间的值。如果只有 START 存在，那么只需选择从 START 到数组末尾的所有值。'START' 没有固定索引；它的位置会根据服务器提供的数据而变化。

那么有什么方法可以快速、相对轻松地在两个指定值之间提取这些值，然后将它们保存到一个新数组中呢？

编辑：我能够运行的唯一实现是@nickb 提供的实现，在评论的下方。我已将其添加到此 OP 以方便其他人使用。

```
array_shift( $array[0]); // Get rid of the 'count' element
$start = array_search( 'registered:current', $array[0], true);
$end = array_search( 'END', $array[0], true); // Change 'END' to whatever it is
$return = array_slice( $array[0], $start + 1, ($end ? ($end - $start - 1) : null)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:02:10.400

这个怎么样？

```
$end = array_search( 'END', $array, true);
$return = array_slice( $array,
    array_search( 'START', $array, true) + 1,
        ($end ? ($end - count( $array)) : null)
); 
```

如果`'END'`未找到，`array_search()`将返回 false，这会导致将第三个参数`array_slice()`设置为`null`，返回数组中的剩余元素，从 开始`'START'`。但如果找到 ，您将获得一个包含和`'END'`之间元素的数组，如[本演示](http://viper-7.com/BDHvDT)所示。`'START'``'END'`

**编辑：**这是一个直接使用索引的更简单的实现，它基于马特的编辑，并进行了一些调整以使其不包含分隔符：

```
$start = array_search( 'START', $array, true) + 1; // +1 to get rid of 'START'
$end = array_search( 'END', $array, true);
$return = array_slice( $array, $start, ($end ? ($end - $start - 1) : null)); // Omit 3rd param if 'END' is not found 
```

**编辑：**最终实现：

```
array_shift( $array[0]); // Get rid of the 'count' element
$start = array_search( 'registered:current', $array[0], true);
$end = array_search( 'END', $array[0], true); // Change 'END' to whatever it is
$return = array_slice( $array[0], $start + 1, ($end ? ($end - $start - 1) : null)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:01:02.433

获取从返回的索引[`array_search()`](http://php.net/manual/en/function.array-search.php)。尝试这个：

```
$startIndex = array_search("START", $myArray);
$endIndex = array_search("END", $myArray);
if ($endIndex === false) {
    $endIndex = count($myArray) - 1;
}

$newArray = array();

for($i = $startIndex; $i < $endIndex; $i++) {
    // do your thing
    $newArray[] = $myArray[$i];
} 
```

**更新：**可以用来`array_slice()`代替循环。

```
$newArray = array_slice($myArray, $startIndex, $endIndex - $startIndex); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:05:38.607

```
$myArray = array( 'a','b','c','START','d','e','f','END' );

$arr = array();
$start = false;
foreach($myArray as $val) {
   if($val == 'END') {
       break;
   }

   if($start) {
       $arr[] = $val;
   }

   if($val == 'START') {
       $start = true;
   }
}

print_r($arr); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-28T17:02:57.720

```
foreach ($myArray as $A){
    if(//condition of the elements you want to display){

      }
} 
```

如果我们确切地知道您的数组的结构，那么提供帮助会更容易。

# javascript - JS for 循环设置 HTML 对象参数

> ID：12164030
> 
> 赞同：0
> 
> 时间：2012-08-28T16:57:51.657
> 
> 标签：javascript, html, class

我正在尝试编写一个 JS 类来轻松创建`Iframe`HTML 对象。这是我的代码：

```
var Iframe = function (params) {
    var src = params.src || '';
    var appendTo = document.getElementById(params.appendId) || document.body;
    var iframe = document.createElement('iframe');
    iframe.src = src;
    if (typeof params.attrs != 'undefined') {
        for (attr in params.attrs) {
            iframe.attr = params.attrs[attr];
            alert('attr: ' + attr + "\nIframe.attr: " + iframe.attr);
            alert(params.attrs[attr]);
        }
    }

    appendTo.appendChild(iframe);

} 
```

当 DOM 加载时：

```
var myIframe = new Iframe({
    src: 'http://www.example.com',
    appendId: 'iframeDiv',
    attrs: {height: '500px', id: 'ID'}
}); 
```

它提醒预期值：

```
attr: height
Iframe.attr: 500px 
```

和：

```
500px 
```

但未能在 HTML 上设置参数，这是生成的源：

```
<div id="iframeDiv">
    <iframe src="http://www.example.com"></iframe>
</div> 
```

怎么了？我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T16:59:05.427

```
iframe.attr = params.attrs[attr]; 
```

我想你的意思是：

```
iframe[attr] = params.attrs[attr]; 
```

或者：

```
iframe.setAttribute(attr, params.attrs[attr]); 
```

顺便说一句，你也忘了声明`attr`。

# mysql - 使用 MySQL 的 SVN 身份验证

> ID：12164032
> 
> 赞同：2
> 
> 时间：2012-08-28T16:58:06.073
> 
> 标签：mysql, svn, apache2, mod-auth

我正在尝试通过 MySQL 设置每个存储库 SVN 身份验证，但我遇到了一些问题。

**首先mod_authn_dbd**和**mod_auth_mysql**有什么区别？

其次，我已经有一个 MySQL 数据库设置，其中包含一个用于用户、组和权限的表。是否可以使用这些模块中的任何一个链接到我当前的权限系统，其中需要用户名、密码和权限才能访问存储库（最好每个存储库具有读取权限和写入权限）

tbl_users：user_id、user_name、user_hash

tbl_group: group_id, group_name

tbl_permission：permission_id，permission_name

tbl_user_group: user_id, group_id

tbl_group_permission：group_id，permission_id

tbl_user_permission：user_id，permission_id

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:41:59.850

首先是区别。

[mod_authn_dbd](http://httpd.apache.org/docs/2.2/mod/mod_authn_dbd.html)提供 mod_auth_digest 和 mod_auth_basic 等身份验证前端，通过在 SQL 表中查找用户来对用户进行身份验证。

[mod_auth_mysql](https://sourceforge.net/projects/modauthmysql/)是一个 Apache 模块，它允许使用存储在 MySQL 数据库中的用户和组数据进行身份验证。该项目似乎自 2005 年以来没有更新，所以我会选择[mod_authn_dbd](http://httpd.apache.org/docs/2.2/mod/mod_authn_dbd.html)。

要正确设置它，首先您需要在 apache 配置中正确配置 mod_authn_dbd 和 mod_dbd，mod_dbd 负责您的数据库连接。完成此操作后（确保您的 Apache 在这些模块处于活动状态的情况下运行），然后您可以继续配置它们。

将类似这样的内容添加到您的 apache 配置中以配置数据库连接：

```
<IfModule mod_dbd.c>
  DBDriver mysql
  DBDParams "host=(your_db_server, p.e. 127.0.0.1) dbname=your_db_name user=your_db_user pass=your_db_pass"
  DBDMin 1
  DBDKeep 8
  DBDMax 20
  DBDExptime 200
</IfModule> 
```

现在将所需的身份验证配置添加到 apache 配置中：

```
<Directory "/your/svn/repository/path/">
  Options FollowSymLinks Indexes MultiViews
  AuthType Basic
  AuthName "Allowed users Only"
  AuthBasicProvider dbd
  AuthDBDUserPWQuery "SELECT pwd FROM tbl_users, tbl_user_group WHERE tbl_users.user_id=%s AND tbl_user.user_id=tbl_user_group.user_id"
  Require valid-user
  AllowOverride None
  Order allow,deny
  Allow from all
</Directory> 
```

我已经简化了 SELECT 语句以获得更好的可读性，你必须扩展它来优化你的配置。

**编辑：**

打字后，我在网上找到了一个很好的例子，也许也可以[在这里](http://www.experts-exchange.com/Software/Server_Software/Web_Servers/Apache/A_3270-Enabling-and-Administering-Apache%27s-HTTPD-authn-dbd-MySQL-authentication-through-PHP-on-Suse.html)阅读。它比我的简化答案要深入得多。

# python - 客户端断开连接后重新启动套接字连接

> ID：12164041
> 
> 赞同：3
> 
> 时间：2012-08-28T16:58:44.050
> 
> 标签：python, sockets, mit-scratch

我有这个代码，它在启用远程传感器连接的情况下侦听/发送到 Scratch 程序（例如，通过 127.0.0.1 上的端口 42001 进行通信）

```
# This code is copyright Simon Walters under GPL v2
# This code is derived from scratch_handler by Thomas Preston
# Version 5dev 11Aug08 Much better looping supplied by Stein @soilandreyes
# and someone else @MCrRaspJam who've name I've forgotton!
# Version 6dev - Moved Allon/AllOff to be processed before single pins :)
# Vesion 7dev - start to tidy up changes
# Vesion 8dev - use gpio-output system and broadcast allon, 1on system
# V0.1 - change to 6 out 2 in and sanitise the code
# V0.2 -

from array import *
import threading
import socket
import time
import sys
import struct

import RPi.GPIO as GPIO
GPIO.setmode(GPIO.BOARD)
GPIO.setup(11,GPIO.OUT)
GPIO.setup(12,GPIO.OUT)
GPIO.setup(13,GPIO.OUT)
GPIO.setup(15,GPIO.OUT)
GPIO.setup(16,GPIO.OUT)
GPIO.setup(18,GPIO.OUT)
GPIO.setup(22,GPIO.IN,pull_up_down=GPIO.PUD_UP)
GPIO.setup(7,GPIO.IN,pull_up_down=GPIO.PUD_UP)

'''
from Tkinter import Tk
from tkSimpleDialog import askstring
root = Tk()
root.withdraw()
'''

PORT = 42001
DEFAULT_HOST = '127.0.0.1'
#HOST = askstring('Scratch Connector', 'IP:')
BUFFER_SIZE = 240 #used to be 100
SOCKET_TIMEOUT = 1

SCRATCH_SENSOR_NAME_INPUT = (
    'gpio-input0',
    'gpio-input1'
)

SCRATCH_SENSOR_NAME_OUTPUT = (
    'gpio-output0',
    'gpio-output1',
    'gpio-output2',
    'gpio-output3',
    'gpio-output4',
    'gpio-output5'
)

SCRATCH_BROADCAST_NAME_OUTPUT = (
    '1on','1off','2on','2off','3on','3off','4on','4off','5on','5off','6on','6off'
)

#Map gpio to real connector P1 Pins
GPIO_PINS = array('i',[11,12,13,15,16,18,22,7])
GPIO_PIN_OUTPUT = array('i')
GPIO_PIN_INPUT = array('i')
print "Output Pins are:"
for i in range(0,len(SCRATCH_SENSOR_NAME_OUTPUT)):
    print GPIO_PINS[i]
    GPIO_PIN_OUTPUT.append(GPIO_PINS[i])
print "Input Pins are:" 
for i in range(len(SCRATCH_SENSOR_NAME_OUTPUT),8):
    print GPIO_PINS[i]
    GPIO_PIN_INPUT.append(GPIO_PINS[i])

class ScratchSender(threading.Thread):
     #Not needed as its a Listening issue 
     ...   

class ScratchListener(threading.Thread):
    def __init__(self, socket):
        threading.Thread.__init__(self)
        self.scratch_socket = socket
        self._stop = threading.Event()

    def stop(self):
        self._stop.set()

    def stopped(self):
        return self._stop.isSet()

    def physical_pin_update(self, pin_index, value):
        physical_pin = GPIO_PIN_OUTPUT[pin_index]
        print 'setting GPIO %d (physical pin %d) to %d' % (pin_index,physical_pin,value)
        GPIO.output(physical_pin, value)

    def run(self):
        #This is main listening routine
        while not self.stopped():
            #time.sleep(0.1) # be kind to cpu
            try:
                data = self.scratch_socket.recv(BUFFER_SIZE)
                dataraw = data[4:].lower()
                print 'Length: %d, Data: %s' % (len(dataraw), dataraw)
                if len(dataraw) == 0:
                    #This is probably due to client disconnecting
                    #I'd like the program to retry connecting to the client
                    time.sleep(2)
            except socket.timeout:
                print "sockect timeout"
                time.sleep(1)
                continue
            except:
                break

            if 'sensor-update' in dataraw:
                #gloablly set all ports
                if 'gpio-outputall' in dataraw:
                    outputall_pos = dataraw.find('gpio-outputall')
                    sensor_value = dataraw[(outputall_pos+16):].split()
                    #print sensor_value[0]
                    for i in range(len(SCRATCH_SENSOR_NAME_OUTPUT)):
                        self.physical_pin_update(i,int(sensor_value[0]))

                #check for individual port commands
                for i in range(len(SCRATCH_SENSOR_NAME_OUTPUT)):
                    if 'gpio-output'+str(i) in dataraw:
                        #print 'Found '+ 'gpio-output'+str(i)
                        outputall_pos = dataraw.find('gpio-output'+str(i))
                        sensor_value = dataraw[(outputall_pos+14):].split()
                        #print sensor_value[0]
                        self.physical_pin_update(i,int(sensor_value[0]))

                #Use bit pattern to control ports
                if 'gpio-pattern' in dataraw:
                    #print 'Found gpio-outputall'
                    num_of_bits = len(SCRATCH_SENSOR_NAME_OUTPUT)
                    outputall_pos = dataraw.find('gpio-pattern')
                    sensor_value = dataraw[(outputall_pos+14):].split()
                    #print sensor_value[0]
                    bit_pattern = ('0000000000000000'+sensor_value[0])[-num_of_bits:]
                    #print 'bit_pattern %s' % bit_pattern
                    for i in range(len(SCRATCH_SENSOR_NAME_OUTPUT)):
                    #bit_state = ((2**i) & sensor_value) >> i
                    #print 'dummy gpio %d state %d' % (i, bit_state) 
                        physical_pin = GPIO_PIN_OUTPUT[i]
                        if bit_pattern[-(i+1)] == '0':
                            print 'setting GPIO %d (physical pin %d) low' % (i,physical_pin)
                            GPIO.output(physical_pin, 0)
                        else:
                            print 'setting GPIO %d (physical pin %d) high' % (i,physical_pin)
                            GPIO.output(physical_pin, 1)

            elif 'broadcast' in dataraw:
                #print 'received broadcast: %s' % data
                if 'allon' in dataraw:
                    for i in range(len(SCRATCH_SENSOR_NAME_OUTPUT)):
                        self.physical_pin_update(i,1)
                if 'alloff' in dataraw:
                    for i in range(len(SCRATCH_SENSOR_NAME_OUTPUT)):
                        self.physical_pin_update(i,0)
                for i in range(len(SCRATCH_SENSOR_NAME_OUTPUT)):
                    #check_broadcast = str(i) + 'on'
                    #print check_broadcast
                    if str(i+1)+'on' in dataraw:
                        self.physical_pin_update(i,1)
                    if str(i+1)+'off' in dataraw:
                        self.physical_pin_update(i,0)
                    if 'pin' + str(GPIO_PIN_OUTPUT[i])+'on' in dataraw:
                        GPIO.output(physical_pin, 1)
                    if 'pin' + str(GPIO_PIN_OUTPUT[i])+'off' in dataraw:
                        GPIO.output(physical_pin, 0)

            elif 'stop handler' in dataraw:
                cleanup_threads((listener, sender))
                sys.exit()

            else:
                print 'received something: %s' % dataraw

def create_socket(host, port):
    while True:
        try:
            print 'Trying'
            scratch_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            scratch_sock.connect((host, port))
            break
        except socket.error:
            print "There was an error connecting to Scratch!"
            print "I couldn't find a Mesh session at host: %s, port: %s" % (host, port) 
            time.sleep(3)
            #sys.exit(1)

    return scratch_sock

def cleanup_threads(threads):
    for thread in threads:
        thread.stop()

    for thread in threads:
        thread.join()

if __name__ == '__main__':
    if len(sys.argv) > 1:
        host = sys.argv[1]
    else:
        host = DEFAULT_HOST

    # open the socket
    print 'Connecting...' ,
    the_socket = create_socket(host, PORT)
    print 'Connected!'

    the_socket.settimeout(SOCKET_TIMEOUT)

    listener = ScratchListener(the_socket)
    sender = ScratchSender(the_socket)
    listener.start()
    sender.start()
    # wait for ctrl+c
    try:
        while True:
            time.sleep(0.5)            
    except KeyboardInterrupt:
        cleanup_threads((listener, sender))
        sys.exit() 
```

我遇到的问题在这部分代码中

```
 def run(self):
        #This is main listening routine
        while not self.stopped():
            #time.sleep(0.1) # be kind to cpu
            try:
                data = self.scratch_socket.recv(BUFFER_SIZE)
                dataraw = data[4:].lower()
                print 'Length: %d, Data: %s' % (len(dataraw), dataraw)
                if len(dataraw) == 0:
                    #This is probably due to client disconnecting
                    #I'd like the program to retry connecting to the client
                    time.sleep(2)
            except socket.timeout:
                print "sockect timeout"
                time.sleep(1)
                continue
            except:
                break 
```

如果客户端断开连接，例如 Scratch 已关闭，我需要这个程序基本上重新开始寻找连接并等待 Scratch 重新连接。我可以就如何实现这一点提出一些建议，因为我是一个 python 新手问候西蒙

我的解决方案是使用全局变量并更改主循环结构

```
 if len(dataraw) == 0:
            #This is probably due to client disconnecting
            #I'd like the program to retry connecting to the client
            #tell outer loop that Scratch has disconnected
            if cycle_trace == 'running':
                cycle_trace = 'disconnected'
                break 
```

用于跳出循环和

```
cycle_trace = 'start'
while True:

    if (cycle_trace == 'disconnected'):
        print "Scratch disconnected"
        cleanup_threads((listener, sender))
        time.sleep(1)
        cycle_trace = 'start'

    if (cycle_trace == 'start'):
        # open the socket
        print 'Starting to connect...' ,
        the_socket = create_socket(host, PORT)
        print 'Connected!'
        the_socket.settimeout(SOCKET_TIMEOUT)
        listener = ScratchListener(the_socket)
        sender = ScratchSender(the_socket)
        cycle_trace = 'running'
        print "Running...."
        listener.start()
        sender.start()

    # wait for ctrl+c
    try:
        #just pause
        time.sleep(0.5)
    except KeyboardInterrupt:
        cleanup_threads((listener,sender))
        sys.exit() 
```

这现在是我的主要外循环似乎工作:)

# iphone - animationDidStop 用于组动画

> ID：12164049
> 
> 赞同：4
> 
> 时间：2012-08-28T16:59:09.733
> 
> 标签：iphone, ios, core-animation, uiviewanimation

我有一个组动画，但我无法检测到何时点击 animationDidStop。我的代码示例：

```
[group setDelegate:self];
[view.layer addAnimation:group forKey:@"groupAnimation"]; 
```

你们中的任何人都知道我是如何知道组动画何时完成的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-28T20:11:46.927

您还需要设置 animationName 属性以匹配，并确保您的委托函数已正确定义：

```
CAAnimationGroup *group = [CAAnimationGroup animation];
group.duration = 2.0f;
group.delegate = self;
[group setValue:@"groupAnimation" forKey:@"animationName"];
[group setAnimations:[NSArray arrayWithObjects:myAnimation, myOtherAnimation, nil]];
[view.layer addAnimation:group forKey:@"groupAnimation"]; 
```

. . .

```
- (void)animationDidStop:(CAAnimation *)animation finished:(BOOL)finished
{
 if (finished)
 {
  NSString *animationName = [animation valueForKey:@"animationName"];
  if ([animationName isEqualToString:@"groupAnimation"])
  {
   // your groupAnimation has ended
  }
 }
} 
```

请注意，对于组动画，在组件动画上设置的代理将被忽略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T02:01:06.197

我想出了一种组织动画完成代码的方法，效果非常好。首先，我为动画完成时运行的代码块定义了一个自定义类型：

```
typedef void (^animationCompletionBlock)(void); 
```

我定义了一个常量，用于将自定义键值对添加到我的动画中：

```
#define kAnimationCompletionBlock @"animationCompletionBlock" 
```

然后，当我创建动画时，如果我希望它在完成时执行一段代码，我会在我的动画中添加一个自定义属性，其中包含我想要执行的代码块：

```
animationCompletionBlock theBlock;
theBlock = ^void(void)
{    
  someButton.enabled = TRUE;
  NSLog(@"Animation complete");
  //whatever other code you want to do on completion
}

[myAnimation setValue: theBlock forKey: kAnimationCompletionBlock]; 
```

我将视图控制器设置为动画的委托：

```
myAnimation.delegate = self 
```

最后，我编写了一个通用的动画完成方法，它会查找附加到动画的动画完成块，如果找到就执行它：

```
/*
 This method looks for a value added to the animation that just completed 
 with the key kAnimationCompletionBlock.
 If it exists, it assumes it is a code block of type animationCompletionBlock, 
 and executes the code block.
 This allows you to add a custom block of completion code to any animation or 
 animation group, rather than Having a big complicated switch statement in your 
 animationDidStop:finished: method with global animation ompletion code.
 (Note that the system won't call the animationDidStop:finished method for 
 individual  animations in an animation group - it will only call the 
 completion method for the entire group. Thus, if you want to run code after 
 part of an animation group  completes, you have to set up a manual timer.)
*/

- (void)animationDidStop:(CAAnimation *)theAnimation 
  finished:(BOOL)flag
{
  animationCompletionBlock theBlock = 
    [theAnimation valueForKey: kAnimationCompletionBlock];
  if (theBlock)
    theBlock();
} 
```

除了非常干净之外，这种方法还允许您的动画完成代码访问您定义块的范围内的局部变量。这解决了将信息传递给您的完成方法的问题，这可能很困难。

您可以在我发布到 Github 的一个工作示例程序中看到这种技术：

**[Github 上的 Core Animation 演示，包括完成块代码](https://github.com/DuncanMC/iOS-CAAnimation-group-demo)**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-20T17:48:09.173

我正在使用这个类别来设置完成，如下所示：

```
[group setCompletionBlock:^{

}]; 
```

第一个 CAAnimationGroup+Blocks.h：

```
#import <QuartzCore/QuartzCore.h>
#import <objc/runtime.h>

typedef void (^TIFAnimationGroupCompletionBlock)();

@interface CAAnimationGroup (Blocks)

- (void)setCompletionBlock:(TIFAnimationGroupCompletionBlock)handler;

@end 
```

和 CAAnimationGroup+Blocks.m：

```
#import "CAAnimationGroup+Blocks.h"

static char CAAnimationGroupBlockKey;

@implementation CAAnimationGroup (Blocks)

- (void)setCompletionBlock:(TIFAnimationGroupCompletionBlock)handler {
    objc_setAssociatedObject(self, &CAAnimationGroupBlockKey, handler, OBJC_ASSOCIATION_COPY_NONATOMIC);

    self.delegate = self;
}

- (void)animationDidStop:(CAAnimation *)animation finished:(BOOL)finished
{
    if (finished)
    {
        TIFAnimationGroupCompletionBlock handler = (TIFAnimationGroupCompletionBlock)objc_getAssociatedObject(self, &CAAnimationGroupBlockKey);
        if (handler) {
            handler();
        }
    }
}

@end 
```

# jquery - 在列表项中的文本两侧添加两个 div

> ID：12164054
> 
> 赞同：0
> 
> 时间：2012-08-28T16:59:25.473
> 
> 标签：jquery, jquery-ui

我有一个接收列表项的函数。当它这样做时，我想在列表项中文本的任一侧添加两个 div：例如，当它接收到该项目时：

```
<li class="sortedli">
  Call Type
</li> 
```

它应该变成：

```
<li class="sortedli">
   <div class="sel-display-on">&nbsp;</div>
       Call Type
   <div class="sel-trash-on">&nbsp;</div>
</li> 
```

但是，我的功能

```
receive: function (event, ui) {
   $(this).prepend("<div class=\"sel-display-on\"></div>");
   $(this).append("<div class=\"sel-trash-on\"></div>");
} 
```

产生这个标记：

```
<div class="sel-display-on"></div>
<li class="sortedli" style="">Caller Id</li>
<div class="sel-trash-on"></div> 
```

我该如何纠正这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:00:53.133

您正在附加/附加到`.sortedli`的父级。使用上下文找到正确的元素：

```
receive: function (event, ui) {
   $('.sortedli', this).prepend("<div class=\"sel-display-on\"></div>");
   $('.sortedli', this).append("<div class=\"sel-trash-on\"></div>");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:03:23.940

尝试如下，

```
receive: function (event, ui) {
   $(this).html(function (idx, oldhtml) {
      return "<div class=\"sel-display-on\">&nbsp;</div>" + 
             oldhtml + 
             "<div class=\"sel-trash-on\">&nbsp;</div>";
} 
```

* * *

> 你使用的是什么 jQuery UI 小部件。接收函数看起来像一个回调函数。所以 this 可能不是 li 元素。– 维加
> 
> @Vega - 显然不是，根据输出它是 li 的父母。– adeneo 44 秒前

如果上述方法不起作用，请尝试以下方法..

```
receive: function (event, ui) {
   $('.sortedli', this).html(function (idx, oldhtml) {
      return "<div class=\"sel-display-on\">&nbsp;</div>" + 
             oldhtml + 
             "<div class=\"sel-trash-on\">&nbsp;</div>";
} 
```

# c++ - C 和 C++ 中的初始值设定项列表

> ID：12164061
> 
> 赞同：3
> 
> 时间：2012-08-28T16:59:49.700
> 
> 标签：c++, c, initializer-list

出于某种原因，我认为 C 和 C++ 是这样工作的：

```
int foo[10] = {57};
for (int i=0; i<10; ++i)
    assert (foo[i] == 57); 
```

结果剩下的整数被初始化为0，而不是57。我从哪里得到这个想法？这是真的吗？结构初始化列表是否曾经如此？当分配给 = {} 和 = {0} 时，数组和结构什么时候开始整齐正确地初始化为 0 值？我一直认为他们会初始化为垃圾，除非另有明确说明。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-28T17:01:32.913

只要初始化程序存在，它就一直如此。C89 说：

> 如果列表中的初始化程序少于聚合的成员，则聚合的其余部分应隐式初始化，与具有静态存储持续时间的对象相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:04:00.983

> 我从哪里得到这个想法？

这显然是一个相对普遍的误解，因为我最近从其他一些人那里听到了同样的事情。也许你从其他人那里得到了这个错误的想法，或者这个想法只是“直觉的”。

`{}`初始化至少可以追溯到 C89。我不知道它曾经以不同的方式工作，或者任何编译器曾经以不同的方式工作。

对于初始化聚合类型（如数组）时的初始化列表：

> 如果列表中的初始化子句少于聚合中的成员，则每个未显式初始化的成员都应从空的初始化器列表（8.5.4）中初始化。*— 聚合 [dcl.init.aggr] 8.5.1p7*

在 C++ 术语中，当您使用空初始化程序时，对象是值初始化的。

> 对T 类型的对象进行*值初始化*意味着：
> 
> — 如果 T 是具有用户提供的构造函数（12.1）的（可能是 cv 限定的）类类型（第 9 条），则调用 T 的默认构造函数（如果 T 没有可访问的默认构造函数，则初始化是非良构的);
> 
> — 如果 T 是没有用户提供的构造函数的（可能是 cv 限定的）非联合类类型，则该对象是零初始化的，如果 T 的隐式声明的默认构造函数是非平凡的，则调用该构造函数。
> 
> — 如果 T 是一个数组类型，那么每个元素都是值初始化的；
> 
> — 否则，对象被零初始化。
> 
>                                                                                               *— 初始化程序 [dcl.init] 8.5p7*

# ruby - Mongoid和数据库结构的变化

> ID：12164062
> 
> 赞同：1
> 
> 时间：2012-08-28T17:00:08.970
> 
> 标签：ruby, mongodb, mongoid

我想做的具体改变是我想摆脱模型的基类。假设我有一个基类 Fruit，然后我有两个不同的扩展水果类 Orange 和 Banana。

所以我有这样的事情：

```
class Fruit
  include Mongoid::Document
  field :weight, type: Integer
end
class Orange < Fruit
end
class Banana < Fruit
end 
```

我想在不丢失任何数据或对水果的引用的情况下将其转换为此：

```
class Orange
  include Mongoid::Document
  field :weight, type: Integer
end
class Banana
  include Mongoid::Document
  field :weight, type: Integer
end 
```

PS请不要质疑我为什么要看似打破DRY规则并摆脱继承的原因。我有我的理由，它们很好:)，最终的想法是将重复的东西重构到一个模块中。

# entity-framework - EF 迁移声称上下文发生了变化，而没有

> ID：12164063
> 
> 赞同：3
> 
> 时间：2012-08-28T17:00:10.873
> 
> 标签：entity-framework, entity-framework-migrations

我正在使用实体框架迁移和代码优先，最近遇到了一个非常奇怪的问题。该问题已在 4.3.1 和 4.4 版本中重现。

EF 认为上下文发生了变化，而实际上并没有。当我更改解决方案的路径时会发生这种情况。例如：如果我的解决方案位于 C:\integration\something.sln 迁移可能会工作，但如果现在我将路径更改为 C:\development\something.sln 并重新构建解决方案，迁移将引发异常说数据库中有待处理的更改。（当然源代码没有任何变化。

我使用 IL Disassembler 创建输出程序集的转储，使用 BeyondCompare 我发现存在差异。我假设数据是相同的，但它的写入顺序不同......

EF 如何确定上下文是否发生了变化？汇编校验和是否有可能出现不同并导致 EF 认为发生了变化？

任何想法都是最受欢迎的......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T22:16:11.697

首先，这不是迁移问题——它可能是实体框架算法中的一个错误，用于检查数据库中是否有更改。

我有一个类层次结构，其中包含一个没有属性的抽象类，使该类不抽象解决了这个问题。

在获得了一些宝贵的调试经验之后，我找到了几种解决这个问题的方法，每一种方法都比以前更令人惊讶，这让我非常确信我陷入了一个非常罕见的极端情况。正如我所提到的，我决定通过使类不抽象来解决。

我试图在一个干净的解决方案中重现该错误，以便我可以将其发送给 Microsoft，但直到现在它并没有真正起作用。

所以......总结一下，如果你发现自己有这样的问题（非常令人沮丧），一个好的提示是寻找抽象类！

# java - 有人可以帮助我澄清我对这个正则表达式的理解吗？

> ID：12164064
> 
> 赞同：3
> 
> 时间：2012-08-28T17:00:16.813
> 
> 标签：java, regex

```
Pattern pattern = Pattern.compile("(\\S+)\\s+(.+?)\\s+(\\S+)");
Matcher matcher = pattern.matcher("IA HEART RATE 184"); 
```

所以我的问题是为什么上面的模式在第 2 组中捕获 HEART RATE。'.+' 不应该匹配一个或多个字符，包括空格字符，所以第 2 组不应该捕获 HEART，因为它后面跟着一个空格，应该匹配 (.+?)\s+ 正确吗？那么为什么它与心率匹配？

PS我正在使用matches（）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:03:44.283

你还没有展示你是如何使用的`matcher`，但我猜你正在使用[它的`matches()`方法](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#matches%28%29)，而你真正想要的是[它的`find()`方法](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#find%28%29)。`matches()`需要将模式与*整个*字符串进行匹配，唯一的方法是让第 2 组成为`HEART RATE`. （如果第 2 组只是`HEART`，那么第 3 组就是`RATE`，并且会有一个尾随` 184`与模式中的任何内容都不匹配。）如果您使用的是`find()`，那么第 2 组就是`HEART`，因为这是允许模式来匹配字符串的一部分。

你也可能会误解什么`+?`意思。它尝试尽可能少地匹配，同时仍然导致整体匹配。`(.+?)\s+`完全可以匹配`HEART RATE `；只是它*更喜欢*match `HEART `，只要这不会阻止模式的其余部分匹配。

# c++ - 分析 WinDbg 中的崩溃

> ID：12164065
> 
> 赞同：2
> 
> 时间：2012-08-28T17:00:21.493
> 
> 标签：c++, .net, windbg

我有一个 .NET 应用程序在退出时有时会崩溃。引擎盖下也有一堆 COM 和原生的东西。它是在 Windows 7 x64 上运行的 x86 应用程序。

我已经浏览了一些 WinDbg 教程，并且我*认为*我正在执行合理的步骤来获取有用的信息，但是堆栈跟踪本身并没有响起任何铃声。

其他一些花絮：

*   我可以非常一致地重现这一点，比如说 75% 的时间
*   如果我清理线程（很多`Thread.Abort()`），它可能有 20% 的时间可以重现
*   运行相同的过程，我也看到了与下面的完全不同的堆栈跟踪

我正在使用 32 位 WinDbg。这是我一直在使用的一般过程：

*   直接从 WinDbg 打开可执行文件
*   将符号路径设置为：`SRV*c:\sym*http://msdl.microsoft.com/download/symbols`
*   类型：`.loadby sos clr`
*   使用应用程序，让它崩溃

崩溃后，我得到输出：

```
(a38.1424): CLR exception - code e0434352 (first chance)
(a38.1424): CLR exception - code e0434352 (first chance)
(a38.1fd0): Unknown exception - code c000000d (first chance)
(a38.1fd0): Unknown exception - code c000000d (!!! second chance !!!)
eax=00000000 ebx=004dea1c ecx=7efdd000 edx=00000057 esi=7264d0c0 edi=07f2a248
eip=778715de esp=004dea08 ebp=004def50 iopl=0         nv up ei pl zr na pe nc
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000246
ntdll!ZwRaiseException+0x12:
778715de 83c404          add     esp,4 
```

如果我输入，`~`我只会得到一个线程： `. 0 Id: a38.1fd0 Suspend: 1 Teb: 7efdd000 Unfrozen`

现在，如果我输入，`!analyze -v`我会得到一个很大的堆栈跟踪：

```
*******************************************************************************
*                                                                             *
*                        Exception Analysis                                   *
*                                                                             *
*******************************************************************************
[ a bunch of symbol stuff loading here ]

FAULTING_IP: 
ntdll!TpReleaseCleanupGroupMembers+276
778e4f52 a1b4009577      mov     eax,dword ptr [ntdll!TppLogpRoutine (779500b4)]

EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)
ExceptionAddress: 778e4f52 (ntdll!TpReleaseCleanupGroupMembers+0x00000276)
   ExceptionCode: c000000d
  ExceptionFlags: 00000000
NumberParameters: 0

FAULTING_THREAD:  00001fd0

PROCESS_NAME:  XXXXX.exe

ERROR_CODE: (NTSTATUS) 0xc000000d - An invalid parameter was passed to a service or function.

EXCEPTION_CODE: (NTSTATUS) 0xc000000d - An invalid parameter was passed to a service or function.

NTGLOBALFLAG:  70

APPLICATION_VERIFIER_FLAGS:  0

CONTEXT:  004dea6c -- (.cxr 0x4dea6c)
eax=004deee0 ebx=00000001 ecx=7efdd000 edx=00000057 esi=7264d0c0 edi=07f2a248
eip=778e4f52 esp=004deed0 ebp=004def50 iopl=0         nv up ei ng nz ac pe cy
cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00000297
ntdll!TpReleaseCleanupGroupMembers+0x276:
778e4f52 a1b4009577      mov     eax,dword ptr [ntdll!TppLogpRoutine (779500b4)] ds:002b:779500b4=00000000
Resetting default scope

STACK_ADDR_RAW_STACK_SYMBOL: 4deb4c

ADDITIONAL_DEBUG_TEXT:  Followup set based on attribute [Is_ChosenCrashFollowupThread] from Frame:[0] on thread:[ffffffff]

LAST_CONTROL_TRANSFER:  from 00000000 to 77883c04

DEFAULT_BUCKET_ID:  STATUS_INVALID_PARAMETER

PRIMARY_PROBLEM_CLASS:  STATUS_INVALID_PARAMETER

BUGCHECK_STR:  APPLICATION_FAULT_STATUS_INVALID_PARAMETER

STACK_TEXT:  
778e4f52 ntdll!TpReleaseCleanupGroupMembers+0x276
72630d69 AUDIOSES!DllCanUnloadNow+0x42
7565b5f4 ole32!CClassCache::CDllPathEntry::CanUnload_rl+0x3b
7565b771 ole32!CClassCache::FreeUnused+0x83
7565b68f ole32!CoFreeUnusedLibrariesEx+0x36
756a0ccb ole32!CoFreeUnusedLibraries+0x9
15e2f549 GxMetadata+0xf549
15e45e3d GxMetadata!DllCanUnloadNow+0x1686d
77889950 ntdll!LdrpCallInitRoutine+0x14
7789d6b2 ntdll!LdrShutdownProcess+0x1aa
7789d554 ntdll!RtlExitUserProcess+0x74
754279f4 KERNEL32!ExitProcessStub+0x12
720642f0 mscoreei!RuntimeDesc::ShutdownAllActiveRuntimes+0x29c
72064321 mscoreei!CLRRuntimeHostInternalImpl::ShutdownAllRuntimesThenExit+0x15
5ea18580 clr!EEPolicy::ExitProcessViaShim+0x66
5ea1862f clr!SafeExitProcess+0x122
5e9638a9 clr!DisableRuntime+0x120
5e963905 clr!EEPolicy::HandleExitProcess+0x5c
5e9b8af8 clr!_CorExeMainInternal+0xdd
5e9b3a30 clr!_CorExeMain+0x4e
720555ab mscoreei!_CorExeMain+0x38
72f67f16 MSCOREE!ShellShim__CorExeMain+0x99
72f64de3 MSCOREE!_CorExeMain_Exported+0x8
7542339a KERNEL32!BaseThreadInitThunk+0xe
77889ef2 ntdll!__RtlUserThreadStart+0x70
77889ec5 ntdll!_RtlUserThreadStart+0x1b

FOLLOWUP_IP: 
AUDIOSES!DllCanUnloadNow+42
72630d69 ff3514d06472    push    dword ptr [AUDIOSES!_AudioClientThreadpoolCleanupGroup (7264d014)] 
```

编辑1：（附加信息）

!clrstack

```
OS Thread Id: 0x1fd0 (0)
Child SP IP       Call Site
GetFrameContext failed: 1 
```

!线程

```
ThreadCount:      7
UnstartedThread:  0
BackgroundThread: 4
PendingThread:    0
DeadThread:       3
Hosted Runtime:   no
                                   PreEmptive   GC Alloc                Lock
       ID  OSID ThreadOBJ    State GC           Context       Domain   Count APT Exception
   0    1  1fd0 005afe88     16220 Enabled  03051294:03051e6c 00578550     0 STA
XXXX    2   e5c 005801d0      b220 Enabled  0305a22c:0305be6c 00578550     0 MTA (Finalizer)
XXXX    3       00641258     19820 Enabled  00000000:00000000 00578550     0 Ukn
XXXX    4       06e4b800    819820 Enabled  00000000:00000000 00578550     0 Ukn
XXXX    5  18a0 081be620   200b220 Enabled  00000000:00000000 00578550     1 MTA
XXXX    8       081d5e18    819820 Enabled  00000000:00000000 00578550     0 Ukn
XXXX    7   158 07ed78d8       220 Enabled  00000000:00000000 00578550     0 Ukn 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-29T14:22:28.247

看起来`ntdll!TpReleaseCleanupGroupMembers`（与`kernel32!CloseThreadpoolCleanupGroupMembers`- 您可以在 msdn 上查找相同）函数（从故障堆栈顶部）不喜欢在进程关闭时被调用 - 它抛出您看到的异常（无效参数） 在这种情况下。

从堆栈上还有两个库（**audioses**和**gxmetadata**）的存在来看，我猜有些对象被销毁/释放得太晚了。**audioses.dll**似乎是 Core Audio API 库，不确定 gxmetadata.dll - 你能解释一下这些的用法吗？

# hudson - 哈德逊文件 SCM 插件

> ID：12164067
> 
> 赞同：1
> 
> 时间：2012-08-28T17:00:27.693
> 
> 标签：hudson, hudson-plugins

我们使用 Hudson CI 作为我们的构建工具，当我们在 Hudson 运行的同一台服务器机器中引用文件系统时，没有问题。

但是当我们使用 File SCM 插件指向具有所有读/写权限的远程机器中的文件系统时，它无法签出并失败并出现以下错误。

```
FATAL: Parameter 'directory' is not a directory
java.lang.IllegalArgumentException: Parameter 'directory' is not a directory
    at org.apache.commons.io.FileUtils.listFiles(FileUtils.java:358)
    at org.apache.commons.io.FileUtils.iterateFiles(FileUtils.java:404)
    at hudson.plugins.filesystem_scm.FolderDiff.getNewOrModifiedFiles(FolderDiff.java:104)
    at hudson.plugins.filesystem_scm.RemoteFolderDiff$CheckOut.invoke(RemoteFolderDiff.java:94)
    at hudson.plugins.filesystem_scm.RemoteFolderDiff$CheckOut.invoke(RemoteFolderDiff.java:88)
    at hudson.FilePath.act(FilePath.java:758)
    at hudson.FilePath.act(FilePath.java:740)
    at hudson.plugins.filesystem_scm.FSSCM.checkout(FSSCM.java:123)
    at hudson.model.AbstractProject.checkout(AbstractProject.java:1483)
    at hudson.model.AbstractBuild$AbstractRunner.checkout(AbstractBuild.java:507)
    at hudson.model.AbstractBuild$AbstractRunner.run(AbstractBuild.java:424)
    at hudson.model.Run.run(Run.java:1366)
    at hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:46)
    at hudson.model.ResourceController.execute(ResourceController.java:88) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T16:17:04.943

我解决了这个问题，在我使用用户 ID 运行 Hudson 服务后，它可以访问远程服务器位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:23:37.393

根据您的配置，我可以想到几件事 - 请注意，我不是 Windows 专家。

1.  您的 Hudson 服务器是否在 Windows 上运行？否则，文件系统路径的 \remoteserver\d$\source\ 格式将不起作用。
2.  运行 Hudson 的用户是否有权访问远程文件路径 \remoteserver\d$\source\ ？

# ruby - 自动修复 Ruby 中未关闭的 HTML 标签

> ID：12164071
> 
> 赞同：1
> 
> 时间：2012-08-28T17:00:43.227
> 
> 标签：ruby, nokogiri, tidy

我正在尝试使用 reverse-markdown Ruby gem 将 HTML 页面转换为 Markdown。不幸的是，它失败了：

```
/usr/lib/ruby/1.9.1/rexml/parsers/treeparser.rb:95:in `rescue in parse': #<REXML::ParseException: Missing end tag for 'img' (got "td") (REXML::ParseException) 
```

源代码包含一些以代替结尾的 , 等`IMG`标签。`INPUT``>``/>`

我试过 tidy_ffi 宝石：

```
doc = Nokogiri::HTML(TidyFFI::Tidy.new(Nokogiri::HTML(page).to_html,
        :numeric_entities => 1,
        :output_html => 1,
        :merge_divs => 0,
        :merge_spans => 0,
        :join_styles => 0,
        :clean => 1,
        :indent => 1,
        :wrap => 0,
        :drop_empty_paras => 0,
        :literal_attributes => 1).clean) 
```

但这并没有什么不同。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:05:59.910

反向降价实际上假设降价处理器生成格式良好的 XHTML。如果你没有，你可能想试试[html2markdown](https://github.com/29decibel/html2markdown) gem。它使用 Nokogiri 进行解析，并且可能更健壮（免责声明：我没有使用它）。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-28T17:25:24.497

~~我制作了一个摘录 html 的 gem：[https](https://www.ruby-toolbox.com/gems/auto_excerpt) ://www.ruby-toolbox.com/gems/auto_excerpt 也许您可以使用它或查看它用来执行此操作的代码？不确定这是否回答了这里的问题。~~

实际上我只是注意到你调用了 Nokogiri::HTML 两次：`Nokogiri::HTML(TidyFFI::Tidy.new(Nokogiri::HTML(page).to_html`

我不确定您遇到的错误是来自 Nokogiri 还是来自 TifyFFI。

# c# - ASP.Net Web API - 同步获取 POSTed 文件？

> ID：12164077
> 
> 赞同：3
> 
> 时间：2012-08-28T17:01:15.567
> 
> 标签：c#, asp.net, .net, asp.net-web-api

有没有办法在 ASP.Net Web API 中**同步处理上传到控制器的上传文件？**

我已经尝试过 Microsoft[在此处](http://www.asp.net/web-api/overview/working-with-http/sending-html-form-data,-part-2)提出的流程，它的工作原理与描述的一样，但我想从 Controller 方法返回 Task<> 以外的其他内容，以匹配我的 RESTful API 的其余部分。

基本上，我想知道是否有任何方法可以使这项工作：

```
public MyMugshotClass PostNewMugshot(MugshotData data){
    //get the POSTed file from the mime/multipart stream <--can't figure this out
    //save the file somewhere
    //Update database with other data that was POSTed
    //return a response
} 
```

同样，我已经使异步示例工作，但我希望有一种方法可以在响应客户端之前处理上传的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:26:57.443

```
public class UploadController : ApiController
{
    public async Task<HttpResponseMessage> Post()
    {
        if (!Request.Content.IsMimeMultipartContent())
        {
            throw new HttpResponseException(HttpStatusCode.UnsupportedMediaType);
        }

        var appData = HostingEnvironment.MapPath("~/App_Data");
        var folder = Path.Combine(appData, Guid.NewGuid().ToString());
        Directory.CreateDirectory(folder);
        var provider = new MultipartFormDataStreamProvider(folder);
        var result = await Request.Content.ReadAsMultipartAsync(provider);
        if (result.FileData.Count < 1)
        {
            // no files were uploaded at all
            // TODO: here you could return an error message to the client if you want
        }

        // at this stage all files that were uploaded by the user will be
        // stored inside the folder we specified without us needing to do
        // any additional steps

        // we can now read some additional FormData
        string caption = result.FormData["caption"];

        // TODO: update your database with the other data that was posted

        return Request.CreateResponse(HttpStatusCode.OK, "thanks for uploading");
    }
} 
```

您可能会注意到上传的文件存储在指定的文件夹中，其名称可能如下所示：`BodyPart_beddf4a5-04c9-4376-974e-4e32952426ab`. 这是[Web API 团队经过深思熟虑的选择，](https://stackoverflow.com/a/10972291/29407)您可以根据需要进行覆盖。

# wpf - 在 WPF 中以编程方式更改 DataGrid 单元格值

> ID：12164079
> 
> 赞同：6
> 
> 时间：2012-08-28T17:01:17.030
> 
> 标签：wpf, datagrid

我有一个`DataGrid`视图，它在运行时通过列表填充它的内容。我想更改（例如）行：2 和列：3 中的单元格值。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-28T17:33:46.893

没那么复杂。

你需要辅助函数；

```
public static T GetVisualChild<T>(Visual parent) where T : Visual
{
    T child = default(T);
    int numVisuals = VisualTreeHelper.GetChildrenCount(parent);
    for (int i = 0; i < numVisuals; i++)
    {
        Visual v = (Visual)VisualTreeHelper.GetChild(parent, i);
        child = v as T;
        if (child == null)
        {
            child = GetVisualChild<T>(v);
        }
       if (child != null)
       {
           break;
       }
   }
       return child;
}

public static DataGridRow GetSelectedRow(this DataGrid grid)
{
    return (DataGridRow)grid.ItemContainerGenerator.ContainerFromItem(grid.SelectedItem);
}
public static DataGridRow GetRow(this DataGrid grid, int index)
{
    DataGridRow row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);
    if (row == null)
    {
        // May be virtualized, bring into view and try again.
        grid.UpdateLayout();
        grid.ScrollIntoView(grid.Items[index]);
        row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);
    }
    return row;
}

public static DataGridCell GetCell(this DataGrid grid, DataGridRow row, int column)
{
    if (row != null)
    {
        DataGridCellsPresenter presenter = GetVisualChild<DataGridCellsPresenter>(row);

        if (presenter == null)
        {
            grid.ScrollIntoView(row, grid.Columns[column]);
            presenter = GetVisualChild<DataGridCellsPresenter>(row);
        }

        DataGridCell cell = (DataGridCell)presenter.ItemContainerGenerator.ContainerFromIndex(column);
        return cell;
    }
    return null;
}

public static DataGridCell GetCell(this DataGrid grid, int row, int column)
{
    DataGridRow rowContainer = grid.GetRow(row);
    return grid.GetCell(rowContainer, column);
} 
```

使用 yourDataGrid.GetCell(5, 3).Content = "whatever you want";

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:06:09.277

例如，如果您的网格上有 TextBox

```
<TextBox  Grid.Row="2" Grid.Column="3" Text="{Binding ...}"/> 
```

完整样本

```
<Grid x:Name="RootElement">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <Grid.RowDefinitions>
        <RowDefinition/>
        <RowDefinition/>
        <RowDefinition/>
      </Grid.RowDefinitions>

      ...
      <TextBox  Grid.Row="2" Grid.Column="3" Text="{Binding ...}"/>
      ...
    </Grid> 
```

你可以使用这些助手；你有这个链接[http://techiethings.blogspot.fr/2010/05/get-wpf-datagrid-row-and-cell.html](http://techiethings.blogspot.fr/2010/05/get-wpf-datagrid-row-and-cell.html)。

在站点关闭的情况下，我添加了代码以将代码保存在 stackoverflow 上

```
public static DataGridRow GetRow(this DataGrid grid, int index)
{
    DataGridRow row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);
    if (row == null)
    {
        // May be virtualized, bring into view and try again.
        grid.UpdateLayout();
        grid.ScrollIntoView(grid.Items[index]);
        row = (DataGridRow)grid.ItemContainerGenerator.ContainerFromIndex(index);
    }
    return row;
}

public static DataGridCell GetCell(this DataGrid grid, DataGridRow row, int column)
{
    if (row != null)
    {
        DataGridCellsPresenter presenter = GetVisualChild<DataGridCellsPresenter>(row);

        if (presenter == null)
        {
            grid.ScrollIntoView(row, grid.Columns[column]);
            presenter = GetVisualChild<DataGridCellsPresenter>(row);
        }

        DataGridCell cell = (DataGridCell)presenter.ItemContainerGenerator.ContainerFromIndex(column);
        return cell;
    }
    return null;
}

public static DataGridCell GetCell(this DataGrid grid, int row, int column)
{
    DataGridRow rowContainer = grid.GetRow(row);
    return grid.GetCell(rowContainer, column);
} 
```

# app-engine-ndb - app engine ndb Key.get 只返回密钥？

> ID：12164083
> 
> 赞同：5
> 
> 时间：2012-08-28T17:01:27.030
> 
> 标签：app-engine-ndb

给定我构建的密钥，我想访问数据存储以查看它是否存在，但我想要最便宜（及时）的方式来做到这一点。我正在寻找的是一个只有键的查询，但来自 get，例如 my_key.get(keys_only=True)。这样的动物存在吗？在我看来不像。如果没有，还有其他方法可以实现我的目标吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T21:16:13.630

不，此功能不存在。由于并非所有实体都被索引，因此没有捷径 - 测试密钥是否存在的唯一方法是尝试获取它，然后您可以免费使用实体数据（无论如何就磁盘操作而言 -有一点序列化成本，但我们不为此收费）。

PS。您确定您没有尝试过早优化吗？

# perl - Perl DBD::CSV - SQL 语法 - “AND”子句无法正常工作

> ID：12164087
> 
> 赞同：2
> 
> 时间：2012-08-28T17:01:45.163
> 
> 标签：perl, dbi

我在 Ubuntu 10.04 上运行 Perl 5.10 并使用 perl DBI 模块。我正在尝试在 Perl DBI 下的 SQL 查询中的“WHERE”子句中使用“AND”条件。我正在使用 DBD::CSV 驱动程序。

请考虑下面的 test.csv：

```
OS,RELEASE,VERSION
Ubuntu,Warty,4
Ubuntu,Hoary,5
Ubuntu,Breezy,5
Fedora,Yarrow,1
Fedora,Tettnang,2
Fedora,Stentz,4 
```

在这里，我想检索 Fedora Stentz 的 VERSION。这是我的代码：

```
#!/usr/bin/perl -w

use strict;
use DBI;

my $table = "test.csv";

my $dbh = DBI->connect ("dbi:CSV:") or die "Cannot connect to the CSV file: $DBI::errstr()";
$dbh->{RaiseError} = 1;
$dbh->{TraceLevel} = 0;

my $query = "select VERSION from $table where OS='Fedora' and RELEASE='Yarrow'";
my $sth = $dbh->prepare ($query);
$sth->execute ();
$sth->dump_results();
$sth->finish();
$dbh->disconnect(); 
```

这是hte输出；

```
0 rows 
```

如果我在查询中使用占位符而不是实际值，如下所示：

```
my $query = "select VERSION from $table where OS=? and RELEASE=?";
my $sth = $dbh->prepare ($query);
$sth->execute ('Fedora', 'Yarrow');
$sth->dump_results();
$sth->finish();
$dbh->disconnect(); 
```

那么输出是一个错误如下：

```
DBD::CSV::st execute failed: You passed 2 parameters where 0 required [for Statement "select VERSION from test.csv where OS=? and RELEASE=?"] at count.pl line 14.
DBD::CSV::st execute failed: You passed 2 parameters where 0 required [for Statement "select VERSION from test.csv where OS=? and RELEASE=?"] at count.pl line 14. 
```

但是，如果我在 hte WEHRE 子句中只使用一个条件，如下所示，那么脚本会给我正确的输出：

```
my $query = "select VERSION from $table where OS=?";
my $sth = $dbh->prepare ($query);
$sth->execute ('Fedora');
$sth->dump_results();
$sth->finish();
$dbh->disconnect(); 
```

hte 输出为：

```
'1'
'2'
'4'
3 rows 
```

所以，底线和我的问题是，当我在“where”子句中写“and”条件时，它不起作用。我怀疑我的查询语法有问题，但还不能弄清楚。任何指示或建议都会有很大帮助。

另外，我在 perlmonks 上有一个关于同一问题的持续线程：[http ://www.perlmonks.org/?node_id=990214](http://www.perlmonks.org/?node_id=990214)

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:13:40.017

你所有的片段对我来说都很好。确保您的模块是最新的。从[Devel::VersionDump](http://search.cpan.org/perldoc?Devel%3a%3aVersionDump)（退出时调用）：

```
Perl version: v5.16.0 on linux (/home/eric/usr/perlbrew/perls/5.16.0t/bin/perl)
AutoLoader                      -     5.72
Carp                            -     1.26
Clone                           -     0.31
Config                          -  Unknown
Cwd                             -  3.39_02
DBD::CSV                        -     0.36
DBD::File                       -     0.40
DBI                             -    1.620
DBI::DBD::SqlEngine             -     0.03
DBI::SQL::Nano                  - 1.014600
Data::Dumper                    - 2.135_06
Devel::VersionDump              -     0.02
DynaLoader                      -     1.14
Errno                           -     1.15
Exporter                        -     5.66
Exporter::Heavy                 -     5.66
Fcntl                           -     1.11
File::Basename                  -     2.84
File::Spec                      -  3.39_02
File::Spec::Unix                -  3.39_02
IO                              -  1.25_06
IO::File                        -     1.16
IO::Handle                      -     1.33
IO::Seekable                    -      1.1
List::Util                      -     1.23
Params::Util                    -     1.07
SQL::Dialects::AnyData          -     1.33
SQL::Dialects::Role             -     1.33
SQL::Eval                       -     1.33
SQL::Parser                     -     1.33
SQL::Statement                  -     1.33
SQL::Statement::Function        -     1.33
SQL::Statement::Functions       -     1.33
SQL::Statement::Operation       -     1.33
SQL::Statement::Placeholder     -     1.33
SQL::Statement::RAM             -     1.33
SQL::Statement::Term            -     1.33
SQL::Statement::TermFactory     -     1.33
SQL::Statement::Util            -     1.33
Scalar::Util                    -     1.23
SelectSaver                     -     1.02
Symbol                          -     1.07
Text::CSV_XS                    -     0.91
Tie::Hash                       -     1.04
XSLoader                        -     0.16
base                            -     2.18
bytes                           -     1.04
constant                        -     1.23
overload                        -     1.18
overloading                     -     0.02
sort                            -     2.01
strict                          -     1.07
unicore::Heavy.pl               -  Unknown
unicore::lib::Perl::Word.pl     -  Unknown
unicore::lib::Perl::_PerlIDS.pl -  Unknown
utf8                            -     1.09
utf8_heavy.pl                   -  Unknown
vars                            -     1.02
warnings                        -     1.13
warnings::register              -     1.02 
```

# ruby-on-rails - Ruby On Rails：按子属性排序

> ID：12164088
> 
> 赞同：6
> 
> 时间：2012-08-28T17:01:46.670
> 
> 标签：ruby-on-rails

如果我有一个具有属性 X 的模型 A 和一个名为 B 且具有属性 Y 的 A 子模型，我如何按 Y 和 X 对 A 的所有实例进行排序？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-28T17:29:39.823

您可以使用`default_scope`通过关联对所有模型实例进行排序。您只需将关联的模型名称传递给`:includes`参数并调整您的订单参数：

`default_scope :include => 'record', :order => 'records.attribute'`

但是，`default_scope`并不强烈推荐。一种更简洁的方法是在您的父模型中创建一个可以从控制器调用的类方法：

```
def self.all_ordered_by_child
   includes(:records).order('records.attribute DESC')
end 
```

您只需要更新从父模型调用所有记录的所有实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:05:45.490

我将改用小写字母：

```
a_instances.sort_by{|a| [a.b.y, a.x]} 
```

# mysql - mysql中limit的使用

> ID：12164091
> 
> 赞同：0
> 
> 时间：2012-08-28T17:01:49.763
> 
> 标签：mysql, select, limit, information-schema

![在此处输入图像描述](../Images/559fcdb4844e47b052410b508601aa3a.png)

第一个查询给出了很好的结果，但问题大约是第二个

当我给出限制 2,2。如何选择两行？这是 weied 行为查询

```
SELECT Ordinal_Position, Column_Name FROM information_schema.columns WHERE
table_schema = 'accounts' AND table_name = 'chequeout' LIMIT 2 , 2 
```

第二个查询或其总和错误有什么问题？有什么解决办法？

**第二个查询的预期结果**是带有值的单行`2 and Amount`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:06:17.353

限制 2, 2 表示从记录 2（第三个 0,1,2）开始，显示 2 行

你似乎想要做的是：

```
WHERE Ordinal_Position = 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:06:28.127

您可能对如何使用有点困惑`LIMIT`：

```
LIMIT <offset>,<limit> 
```

`<offset>`表示起始行索引并`<limit>`告知行数。

# sql - 在 MYSQL 查询中使用变量进行计算

> ID：12164092
> 
> 赞同：0
> 
> 时间：2012-08-28T17:01:52.647
> 
> 标签：sql, variables, select, rounding

希望你能帮忙，这把我逼疯了

我需要计算一个问题失败的百分比，但这需要按地理区域缩小范围，并针对这些问题提出的产品。

我有 ：

```
$CA002 = "( SELECT ROUND(100 *  (SELECT count(CA002Result) from Data_Table where (CA002Result='Fail'))/count(CA002Result),2) from Data_Table) AS 'CA002 %'"; 
```

哪个“有效”，但只是针对整个记录集作为“整体”进行计算

我正在努力 ：

```
$CA001 = "( SELECT ROUND(100 *  (SELECT count(CA001Result) from Data_Table where (CA001Result='Fail' AND Area ='$Area'))/count(CA001Result) from Data_Table WHERE (Area='$Area'),2) AS 'CA001 %'"; 
```

并且 ：

```
$CA001 = "( SELECT ROUND(100 * (SELECT count(CA001Result ) from Data_Table where (CA001Result='Fail' AND Product='$product' AND Area='$Area'))      
    /     count(CA001Result WHERE Product = '$product' AND Area='$Area'),2) from Data_Table) AS 'CA001 %'"; 
```

并且无论我尝试什么都会出错，我似乎无法弄清楚我需要把什么放在哪里。

非常感谢，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T04:29:20.773

尝试这个

**//按区域过滤**

```
create table t( id int,  answer varchar(10),Area varchar(10));
insert into t select 1  ,  'pass' , 'Area1';
insert into t select 2  ,  'pass' , 'Area1';
insert into t select 3  ,  'fail' , 'Area1';
insert into t select 4  ,  'fail' , 'Area1';
insert into t select 5  ,  'fail' , 'Area1';
insert into t select 6 ,   'fail' , 'Area2';

SELECT 
        (x.TotalFailedAnswerRecord * 100) /y.TotalRecord AS Fail_percent
FROM
            (   SELECT Area,TotalFailedAnswerRecord = COUNT(answer) 
                FROM t 
                WHERE answer='fail' AND Area = 'Area1' 
                GROUP BY Area
            )x
INNER JOIN
            (   SELECT Area,TotalRecord = COUNT(answer) 
                FROM t 
                WHERE Area = 'Area1'
                GROUP BY Area
            )y ON x.Area =y.Area

//Result
Fail_percent
-------------
60 
```

**//按区域、产品筛选**

```
create table t( id int,  answer varchar(10),Area varchar(10),Product varchar(10));
insert into t select 1  ,  'pass' , 'Area1' ,'Product1';
insert into t select 2  ,  'fail' , 'Area1' ,'Product1';
insert into t select 3  ,  'fail' , 'Area1' ,'Product1';
insert into t select 4  ,  'fail' , 'Area1' ,'Product1';
insert into t select 5  ,  'fail' , 'Area1' ,'Product2';
insert into t select 6 ,   'fail' , 'Area2' ,'Product2';

SELECT 
        (x.TotalFailedAnswerRecord * 100) /y.TotalRecord AS Fail_percent
FROM
            (   SELECT Area,Product,TotalFailedAnswerRecord = COUNT(answer) 
                FROM t 
                WHERE answer='fail' AND Area = 'Area1' AND Product = 'Product1' 
                GROUP BY Area,Product
            )x
INNER JOIN
            (   SELECT Area,Product,TotalRecord = COUNT(answer) 
                FROM t 
                WHERE Area = 'Area1' AND Product = 'Product1'
                GROUP BY Area,Product
            )y ON x.Area =y.Area AND x.Product = y.Product

//Result
Fail_percent
-------------
75 
```

希望这可以帮助

# eclipse - “没有可用的源代码......”在 OSX 10.8.1 上使用 Nsight Eclipse Edition RC1

> ID：12164093
> 
> 赞同：2
> 
> 时间：2012-08-28T17:01:58.860
> 
> 标签：eclipse, cuda, osx-mountain-lion, nvcc, nsight

我正在尝试在 OS X Mountain Lion 10.8.1 上使用 CUDA 5 RC1。从 Nsight Eclipse Edition 调试时，出现错误：

> main() 没有可用的源

我已经验证 nvcc 设置为使用 -g 和 -G 来发出设备和主机调试符号，并且 -O0 设置为禁用优化。

任何想法是什么问题或我可以执行的其他一些诊断？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T15:53:11.247

至少对我来说，问题是需要将架构设置为 x64。

要做到这一点，`right click`在你的`project`和命中`Properties`。

然后转到`Build`--> `Settings`--> `Tool Settings`。

在`NVCC Compiler`-->下`Code Generation`，设置`Architecture`为`x64`.

在`NVCC Linker`-->下`Miscellaneous`设置`Architecture`为`x64`.

最后，清理项目并重建。

# c++ - 为什么 V8 包在类中时会崩溃

> ID：12164095
> 
> 赞同：1
> 
> 时间：2012-08-28T17:02:05.360
> 
> 标签：c++, v8, embedded-v8

我试图将 V8 包装在一个类结构中，其中存在一个将 JavaScript 回调公开给 C++ 代码的对象，该对象应该进行一些数据处理。

这个想法是让所有参与的班级都可以使用 context 和 handle_scope，即我想到了一个“全局”状态。我将其归结为以下示例：

```
using namespace v8;

Persistent<Context> context;
HandleScope handle_scope;

struct CallBackTest {
HandleScope handle_scope;
Handle<v8::Function> function;
void RegisterCallback(Handle<v8::Function> f) {
    function = f;
}

bool MakeCall(int argc, Handle<Value> args[2]) {
    Handle<Value> js_result = function->Call(context->Global(), argc, args);
    String::AsciiValue ascii(js_result);
    return atoi(*ascii);
}
};

struct V8Wrapper {
CallBackTest tester;
V8Wrapper() {
    context = Context::New();
    Context::Scope context_scope(context);

    Handle<String> source;
    Handle<Script> script;
    Handle<Value> result;

    source = String::New("function test_function() { return (arguments[0] == arguments[1]); };");

    script = Script::Compile(source);

    result = script->Run();

    Handle<v8::Value> value1 = context->Global()->Get(String::New("test_function"));
    if(!value1->IsFunction()) {
        std::cout << "function not found" << std::endl;
    } else {
        Handle<v8::Function> func1 = v8::Handle<v8::Function>::Cast(value1);
        tester.RegisterCallback(func1);
    }
}
};

int main(int argc, char* argv[]) {
V8Wrapper wrap;
Handle<Value> args[2];
Handle<Value> js_result;
int final_result;

args[0] = v8::String::New("1");
args[1] = v8::String::New("1");

final_result = wrap.tester.MakeCall(2, args);

if(final_result == 1) {
    std::cout << "Matched\n";
} else {
    std::cout << "NOT Matched\n";
}
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T17:16:29.977

我认为您的问题是对 HandleScope 的误解。Handle 必须“存在”在已定义 HandleScope 的范围内。HandleScope 的想法不是必须在某个全局位置定义的全局结构，而是对应于类似堆栈的概念。

# codeigniter - Codeigniter 引导分页

> ID：12164114
> 
> 赞同：4
> 
> 时间：2012-08-28T17:03:45.220
> 
> 标签：codeigniter

我正在使用 CodeIgniter 和 Twitter Bootstrap 制作一个网络应用程序。我在网上找到了一个资源，其中包含 $config 设置列表以正确设置分页链接的样式。有没有办法将它存储在库中并将其加载到控制器中，这样我就不必每次都输入它？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-06T11:29:39.963

您可以在 application/config 中将其保存为 pagination.php：

```
$config['per_page'] = 2;
$config['uri_segment'] = 3;
$config['num_links'] = 9;
$config['page_query_string'] = TRUE;

$config['query_string_segment'] = 'page';

$config['full_tag_open'] = '<div class="pagination"><ul>';
$config['full_tag_close'] = '</ul></div><!--pagination-->';

$config['first_link'] = '&laquo; First';
$config['first_tag_open'] = '<li class="prev page">';
$config['first_tag_close'] = '</li>';

$config['last_link'] = 'Last &raquo;';
$config['last_tag_open'] = '<li class="next page">';
$config['last_tag_close'] = '</li>';

$config['next_link'] = 'Next &rarr;';
$config['next_tag_open'] = '<li class="next page">';
$config['next_tag_close'] = '</li>';

$config['prev_link'] = '&larr; Previous';
$config['prev_tag_open'] = '<li class="prev page">';
$config['prev_tag_close'] = '</li>';

$config['cur_tag_open'] = '<li class="active"><a href="">';
$config['cur_tag_close'] = '</a></li>';

$config['num_tag_open'] = '<li class="page">';
$config['num_tag_close'] = '</li>';

$config['anchor_class'] = 'follow_link'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-22T09:54:06.253

引导程序和代码点火器的非常简单的解决方案

```
$this->load->model('reciever');
                $this->load->library('uri');
                $this->load->library('pagination');
                $config['base_url'] = base_url(). 'users_ci/users';
                $config['total_rows'] = $this->reciever->getRows();
                $config['per_page'] = 4;
                $config['full_tag_open'] = '<ul class="pagination">';
                $config['full_tag_close'] = '</ul>';            
                $config['prev_link'] = '&laquo;';
                $config['prev_tag_open'] = '<li>';
                $config['prev_tag_close'] = '</li>';
                $config['next_link'] = '&raquo;';
                $config['next_tag_open'] = '<li>';
                $config['next_tag_close'] = '</li>';
                $config['cur_tag_open'] = '<li class="active"><a href="#">';
                $config['cur_tag_close'] = '</a></li>';
                $config['num_tag_open'] = '<li>';
                $config['num_tag_close'] = '</li>';
                $config["num_links"] = round( $config["total_rows"] / $config["per_page"] );
                $config['users']= $this->reciever->getUsers(4,$this->uri->segment(3));
                $this->pagination->initialize($config);
                $config['pages'] = $this->pagination->create_links();
                $this->load->view('users',$config); 
```

为了查看你有

```
<div><?php echo $pages; ?></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:12:39.133

您始终可以简单地在模型中创建一个`.php`带有设置数组的文件，`require_once()`然后返回给分页启动器。或者最好创建一个模型/库，将所有设置返回给您。

模型：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

$pagination_config = array(
    'full_tag_open' = '<p>',
    'full_tag_close' = '</p>',
    // ...
);

class Pagiconf extends CI_Model {
    public function load() {
        $this->load->library('pagination');
        $this->pagination->initialize($config);
        return $this->pagination->create_links();
    }
} 
```

任何你需要它的地方：

```
$this->load->model('pagiconf');
echo $this->pagiconf->load(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-18T08:24:32.360

```
 The bellow working fine 

       $config["base_url"] = base_url() . "product/product/index1";
        $config["total_rows"] = $count_products;    

  $config['per_page'] = 2;
$config['uri_segment'] = 4;
$config['num_links'] = 9;

$config['full_tag_open'] = '<div class="pagination"><ul>';
$config['full_tag_close'] = '</ul></div><!--pagination-->';

$config['first_link'] = '&laquo; First';
$config['first_tag_open'] = '<li class="prev page">';
$config['first_tag_close'] = '</li>';

$config['last_link'] = 'Last &raquo;';
$config['last_tag_open'] = '<li class="next page">';
$config['last_tag_close'] = '</li>';

$config['next_link'] = 'Next &rarr;';
$config['next_tag_open'] = '<li class="next page">';
$config['next_tag_close'] = '</li>';

$config['prev_link'] = '&larr; Previous';
$config['prev_tag_open'] = '<li class="prev page">';
$config['prev_tag_close'] = '</li>';

$config['cur_tag_open'] = '<li class="active"><a href="">';
$config['cur_tag_close'] = '</a></li>';

$config['num_tag_open'] = '<li class="page">';
$config['num_tag_close'] = '</li>';

        $this->pagination->initialize($config); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-21T21:50:49.703

这是我的 Bootstrap v4.0 工作代码

```
$config['full_tag_open'] = '<ul class="pagination">';
$config['full_tag_close'] ='</ul>';
$config['num_tag_open'] = '<li class="page-item">';
$config['num_tag_close'] = '</li>';
$config['cur_tag_open'] = '<li class="page-item active"><a class="page-link" href="#">';
$config['cur_tag_close'] = '</a></li>';
$config['next_tag_open'] = '<li class="page-item"><a href="#" aria-label="Next">';
$config['next_tagl_close'] = '</a></li>';
$config['prev_tag_open'] = '<li class="page-item">';
$config['prev_tagl_close'] = '</li>';
$config['first_tag_open'] = '<li class="page-item disabled">';
$config['first_tagl_close'] = '</li>';
$config['last_tag_open'] = '<li class="page-item"><a href="#" aria-label="Next">';
$config['last_tagl_close'] = '</a></li>';
$config['attributes'] = array('class' => 'page-link'); 
```

# ios5 - 未收到来自 UITextField 的 canPerformAction:withSender 的“粘贴：”操作

> ID：12164119
> 
> 赞同：0
> 
> 时间：2012-08-28T17:04:18.993
> 
> 标签：ios5, uitextfield

我想禁用 UITextField 的“粘贴”选项，在我的 UITextField 的委托类中，我提供了一个实现：

```
-(BOOL)canPerformAction:(SEL)action withSender:(id)sender 
```

`NSObject(UIResponderStandardEditActions)`定义了以下操作，我将所有这些操作都发送给我，`canPerformAction`除了`paste:`

```
@interface NSObject(UIResponderStandardEditActions)   // these methods are not implemented in NSObject

- (void)cut:(id)sender __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_3_0);
- (void)copy:(id)sender __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_3_0);
- (void)paste:(id)sender __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_3_0);
- (void)select:(id)sender __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_3_0);
- (void)selectAll:(id)sender __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_3_0);
- (void)delete:(id)sender __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_3_2);
- (void)makeTextWritingDirectionLeftToRight:(id)sender __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_5_0);
- (void)makeTextWritingDirectionRightToLeft:(id)sender __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_5_0);

@end 
```

现在，只要剪贴板中有内容并且我将焦点放在 UITextField 上，我就会看到显示的“粘贴”菜单。

我还应该做些什么来接收粘贴消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-17T13:23:07.377

创建一个子类`UITextField`并覆盖`canPerform`那里，该`paste:`操作在 上调用`UITextField`，而不是在`delegate`

# c# - c++/c# 系统和程序资源监控 - Windows

> ID：12164125
> 
> 赞同：1
> 
> 时间：2012-08-28T17:04:38.330
> 
> 标签：c#, c++, resources, monitor

我正在考虑制作一个改进版的 Windows 资源监视器，它不仅包括资源使用情况，还包括硬件状态，例如温度和风扇速度。

我昨天开始使用 c++ 对其进行编程，并且我已经成功地列出并刷新了我计算机上每个进程的内存和 CPU 利用率。

然而，问题来了：它非常慢。每秒轮询一次使用情况时，它使用了我的 i5 2500k@4.3 GHz 的 5%。这是不可接受的，因为我不仅想要 CPU 和内存使用情况，还想要每个硬盘驱动器的磁盘使用情况、互联网使用情况、GPU 使用情况（每个进程的所有这些），然后我还想监控所有温度。

这是我的代码：

```
const double MB = 1024*1024;
const double KB = 1024;

struct WinProcess
{
    wstring Name;
    unsigned int ID;
    wstring UserName;
    double cpuUsage;
    long long int ramUsage;

    WinProcess(wstring name, unsigned int id) : Name(name), ID(id), UserName(L"Not set"), cpuUsage(0), ramUsage(0) {}
};

class ResourceMonitor
{
private:
    void** hquery;
    void** hcountercpu;
    void** hcountermem;

    int cpuCores;

    vector<WinProcess> Processes;
public:
    ResourceMonitor();
    ~ResourceMonitor();

    void StartResourceMonitor();
    void MeasureResourceUsage();
    void PrintUsage();
};

ResourceMonitor::ResourceMonitor() : 
    Processes(GetProcessList())    // Function GetProcessList() returns vector with all processes, their IDs and username, from which it was launched
{
    hquery = new void*[Processes.size()];
    hcountercpu = new void*[Processes.size()];
    hcountermem = new void*[Processes.size()];

    for (unsigned int i = 2; i < Processes.size(); i++)
    {
        Processes[i].Name = Processes[i].Name.substr(0, Processes[i].Name.size() - 4);
    }

    for (unsigned int i = 2; i < Processes.size(); i++)
    {
        wstring CounterPathCPU = L"\\Process(" + Processes[i].Name + L")\\% Processor Time";
        wstring CounterPathMEM = L"\\Process(" + Processes[i].Name + L")\\Private Bytes";

        if ((PdhOpenQuery(NULL, 0, &hquery[i])) != ERROR_SUCCESS
            || PdhAddCounter(hquery[i], CounterPathCPU.c_str(), 0, &hcountercpu[i]) != ERROR_SUCCESS
            || PdhAddCounter(hquery[i], CounterPathMEM.c_str(), 0, &hcountermem[i]) != ERROR_SUCCESS
            || PdhCollectQueryData(hquery[i]) != ERROR_SUCCESS)
        {
            continue;
        }
    }

    SYSTEM_INFO sysinfo;
    GetSystemInfo(&sysinfo);
    cpuCores = sysinfo.dwNumberOfProcessors;

    wcout.setf(ios::fixed);
}

ResourceMonitor::~ResourceMonitor()
{    
    for (unsigned int i = 2; i < Processes.size(); i++)
    {
        PdhCloseQuery(hquery[i]);
        PdhRemoveCounter(hcountercpu[i]);
        PdhRemoveCounter(hcountermem[i]);
    }

    delete[] hquery;
    delete[] hcountercpu;
}

void ResourceMonitor::StartResourceMonitor()
{
    system("mode CON: COLS=150");

    while (1)
    {
        MeasureResourceUsage();
        PrintUsage();
        Sleep(1000);
    }
}

void ResourceMonitor::MeasureResourceUsage()
{
    PDH_FMT_COUNTERVALUE countervalcpu;
    PDH_FMT_COUNTERVALUE countervalmem;

    for (unsigned int i = 2; i < Processes.size(); i++)
    {
        if ((PdhCollectQueryData(hquery[i])) != ERROR_SUCCESS)
        {   
            printError(L"Error on collecting query data: ");
            continue;
        }        
        if ((PdhGetFormattedCounterValue(hcountercpu[i], PDH_FMT_LONG | PDH_FMT_NOCAP100, 0, &countervalcpu)) != ERROR_SUCCESS)
        {
            printError(L"Error on CPU usage retrieval: ");
            continue;
        }
        if ((PdhGetFormattedCounterValue(hcountermem[i], PDH_FMT_LONG, 0, &countervalmem)) != ERROR_SUCCESS)
        {
            printError(L"Error on Memory usage retrieval: ");
            continue;
        }

        Processes[i].cpuUsage = countervalcpu.longValue / (double)cpuCores;
        Processes[i].ramUsage = countervalmem.longValue;
    }
}

void ResourceMonitor::PrintUsage()
{
    system("cls");
    long long int RAMSUM = 0;
    for (unsigned int i = 2; i < Processes.size(); i++)
    {
        wcout << left << setw(40) << Processes[i].Name + L".exe: ";
        wcout << setw(6) << left << L" | ID " << setw(4) << right << Processes[i].ID;
        wcout << setw(8) << left << L" | User " << setw(15) << Processes[i].UserName;
        wcout << setw(8) << left << L" | CPU usage " << setw(10) << right << setprecision(2) << Processes[i].cpuUsage << setw(1) << L"%";
        wcout << setw(8) << left << L" | RAM usage " << setw(15) << right << setprecision(3) << Processes[i].ramUsage / MB << setw(3) << left << L" MB" << endl;

        RAMSUM += Processes[i].ramUsage;
    }
    wcout << L"Total RAM usage: " << setw(7) << right << RAMSUM / MB
        << setw(3) << left << L" MB" << endl;
} 
```

我很清楚围绕此代码的问题：进程列表永远不会更新，也没有 GUI，但这些是可以修复的，因为获取进程列表功能非常快。

有没有办法像 Windows 任务管理器那样检查 CPU 和内存使用任务？我可以使用 c++ 或 c#，因为我知道这两种语言。最后，我不知道如何监控每个进程的网络流量、磁盘使用情况和 GPU 使用情况。有任何想法吗？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T02:16:15.270

我上次使用 cpu 和 mem 统计数据时使用的是 Delphi，但这些调用非常适合 Windows API。我在这个答案的末尾包含了 Delphi/pascal 源代码，这样你就可以看到我使用的实际代码。这涵盖了 CPU 和内存使用情况，但对于您关于网络流量、磁盘使用情况和 GPU 使用情况的最后一个问题，我没有答案。

这些链接涵盖了我使用的技术，但适用于 c/c++。对于 c#，这一切都很好地包含在[System.Diagnostics.Process](http://msdn.microsoft.com/en-us/library/ccf1tfx0)类中，并且非常易于访问。

**内存使用情况：**

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms683219%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683219%28v=vs.85%29.aspx)

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms684877%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684877%28v=vs.85%29.aspx)

[如何在 C++ 中使用 GetProcessMemoryInfo？](https://stackoverflow.com/questions/8644110/how-to-use-getprocessmemoryinfo-in-c)

[如何在 C++ 中获取 Windows 下的内存使用情况](https://stackoverflow.com/questions/282194/how-to-get-memory-usage-under-windows-in-c)

**CPU时间：**

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms683223%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683223%28v=vs.85%29.aspx)

[使用 GetProcessTimes 和 FileTimeToSystemTime 的 CPU 处理时间在 64 位 win 中不起作用](https://stackoverflow.com/questions/3071652/cpu-process-time-using-getprocesstimes-and-filetimetosystemtime-do-not-work-in-6)

```
// this member var is referenced within the function
mLastMemInfo: TProcessMemoryCounters;

procedure TProcess.UpdateStats(handle: Cardinal);
var
  creation, exit, kernel, user: FILETIME;
  sysTime: TSystemTime;
  iKernel: Int64;
  iUser: Int64;
  totalTime: Int64;
  tickCount: Cardinal;
  tDelta: Cardinal;
begin
  if (handle <> INVALID_HANDLE) then begin
    tickCount := GetTickCount;
    tDelta := tickCount - mLastStatsTick;
    // only update stats if its been 500 ms or more since last check
    // or if we haven't checked at all yet
    if (tDelta >= 500) then begin
      // get cpu stats
      if GetProcessTimes(handle, creation, exit, kernel, user) then begin
        if (mCreationTime = 0) then begin
          if (FileTimeToSystemTime(creation, sysTime)) then begin
            mCreationTime := SystemTimeToDateTime(sysTime);
          end;
        end;
        iKernel := kernel.dwHighDateTime;
        iKernel := (iKernel shl 32) or kernel.dwLowDateTime;
        iUser := user.dwHighDateTime;
        iUser := (iUser shl 32) or user.dwLowDateTime;
        iKernel := iKernel div 10; // convert 100nanos to microseconds
        iUser := iUser div 10; // convert 100nanos to microseconds
        mLastKernelDelta := iKernel - mLastKernelTime;
        mLastUserDelta := iUser - mLastUserTime;
        totalTime := mLastKernelDelta + mLastUserDelta;
        if (totalTime <= 0) and (mLastStatsTick = 0) then begin
          mLastCpuUsage := 0;
        end else begin
          mLastCpuUsage := (totalTime / NumberOfProcessors) / (tDelta * 1000);
          if (mLastCpuUsage > 1.0) then mLastCpuUsage := 1.0;
        end;
        mLastKernelTime := iKernel;
        mLastUserTime := iUser;
      end else begin
        mLastCpuUsage := 0;
      end;
      // get memory stats
      mLastMemInfo.cb := SizeOf(mLastMemInfo);
      if not GetProcessMemoryInfo(handle, @mLastMemInfo,
                    SizeOf(mLastMemInfo)) then begin
        mLastMemInfo.cb := 0; // flag data as no good
      end;
      // set the time we got the stats
      mLastStatsTick := tickCount;
    end;
  end;
end; 
```

# html - 在 Chrome 中水平滚动后出现奇怪的垂直线

> ID：12164127
> 
> 赞同：1
> 
> 时间：2012-08-28T17:04:39.530
> 
> 标签：html, google-chrome, scroll

我们在 iframe 中有一个带有发票表的页面。在 IE 中，水平滚动可以正常工作并且看起来不错。在 Chrome 上，如果您向右滚动，然后再向左滚动，您会看到这些丑陋的垂直线：

![在此处输入图像描述](../Images/bd8412a4a71281e25b7215f88fb70c9d.png)

这似乎是 doctype 的问题，但我尝试过改变它并没有帮助。这仅发生在 Chrome 中并且仅在水平滚动之后发生；Firefox 和 IE 不显示这些。我认为这与 Chrome 呈现不同的页面上的某些 HTML 有关，但我无法准确找到它是什么。

有没有人以前见过这个或知道如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T15:52:09.020

我相信它与 Chrome 错误有关：

[https://groups.google.com/a/chromium.org/forum/?fromgroups#!topic/chromium-bugs/eUfzp3UJDwo%5B1-25%5D](https://groups.google.com/a/chromium.org/forum/?fromgroups#!topic/chromium-bugs/eUfzp3UJDwo%5B1-25%5D)

一种可能的解决方法（或此处提示解决方法）：

[Chrome 错误：向上滚动时屏幕上的 iframe 渲染线](https://stackoverflow.com/questions/12021248/chrome-bug-iframe-rendering-lines-on-screen-when-scrolling-up)

# ios - UITableViewCell 的多种布局

> ID：12164128
> 
> 赞同：0
> 
> 时间：2012-08-28T17:04:40.977
> 
> 标签：ios, uitableview, subclass

我正在创建一个使用自定义 UITableViewCell 类的 UITableView。UITableViewCell 使用它自己的方法根据 indexPath 和选定的索引进行布局。

代码如下： AgendaView.h TableViewDelegate 方法

```
-(UITableViewCell*)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

EventInfoCell *cell = [tableView dequeueReusableCellWithIdentifier:@"infoCell"];
if(cell == nil){
    cell = [[EventInfoCell alloc]initWithStyle:0 reuseIdentifier:@"infoCell"];
}

cell.frame = CGRectMake(0, 0, 320, [self tableView:tableView heightForRowAtIndexPath:indexPath]);
cell.selectedBackgroundView = nil;
cell.delegate = self;

TimerEvent *event = [_eventsArray objectAtIndex:indexPath.row];
EventInfo *info = [event valueForKey:@"eventInfo"];

NSDateFormatter *df = [[NSDateFormatter alloc]init];
[df setDateFormat:@"h:mma"];
cell.timeLabel.text = [NSString stringWithFormat:@"%@",[df stringFromDate:event.date]];

cell.titleField.text = [info title];

cell.bgImageView.frame = cell.frame;

cell.countdownLabel.text = [self getCountdown:event];

if (_selectedIndex == indexPath.row){
    [cell layoutSelected:YES editing:[tableView isEditing]];

    if ([info location]) 
        cell.locationField.text =[NSString stringWithFormat:@"@%@",[info location]];
    else
        cell.locationField.text = @"Location";

    if ([info notes]) 
        cell.notesView.text = [info notes];
    else
        cell.notesView.text = @"Notes";
}else
    [cell layoutSelected:NO editing:NO];

return cell;
} 
```

这是布局单元格的可接受方式吗？或者我应该为不同的单元格布局创建不同的单元格子类？如果有帮助，当被触摸时单元格会展开以显示更多信息，这就是我让子类处理它自己的布局的原因。

图片：[http ://tinypic.com/r/2vjpi12/6](http://tinypic.com/r/2vjpi12/6)

单元格信息由 tableView:cellForRowAtIndexPath 期间分配的 TimerEvent/Info 确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:18:37.743

我认为您应该为每种类型的行创建不同的 UITableViewCell 子类。这是我如何做到这一点的草图：

```
@interface UITableViewCell (MyTableViewSupport)
@property ( nonatomic, strong ) id value ; // value to display
+(NSString *)identifier ; // reuse identifier for this class
@end

@implementation UITableViewCell (MyTableViewSupport)

+(NSString*)identifier
{
    return NSStringFromClass( self ) ;
}

const char * sValueKey = "TableCellValue";
-(void)setValue:(id)value
{
    objc_setAssociatedObject( self, sValueKey, value, OBJC_ASSOCIATION_RETAIN_NONATOMIC ) ;
}

-(id)value
{
    return objc_getAssociatedObject( self, sValueKey ) ;
}

@end

@interface TableCellA : TableViewCell
@end

@interface TableCellB : TableViewCell
@end

@implementation TableCellA

-(void)layoutSubviews
{
    // one type of layout
}

@end

@implementation TableCellB

-(void)layoutSubviews
{
    // another type of layout
}

@end 
```

您的表视图数据源（可能是您的视图控制器）：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    id value = [ self _valueForRowAtIndexPath ] ;
    Class cellClass = /// ...look up cell class based on section/row or type of value, etc.

    UITableViewCell * cell = [ tableView dequeueReusableCellWithIdentifier:cellClass.identifier ] ;
    if ( !cell )
    {
        cell = [ [ cellClass alloc ] init ] ;
    }

    cell.value = value ;
    return cell ;
} 
```

编辑：对上述内容的扩展解释：

UITableViewCell 上的第一部分代码（类别）对其进行了扩展，以提供`cellIdentifier`类方法和`value`属性。现在 UITableViewCell 的所有实例都支持设置/获取“值”属性，包括您的子类。

假设您必须选择行类型、**Employees**和**Companies**。您将创建`EmployeeCell`和`CompanyCell`：

```
@interface EmployeeCell : UITableViewCell

-(void)layoutSubviews
{
    // layout code for employee cells
}

-(void)setValue:(id)value
{
    [ super setValue:value ] ;
    // configure the subviews of this employee cell (first name label, last name label, photo, for example) based on `value`
}

@end

@implementation CompanyCell : UITableViewCell

-(void)layoutSubviews
{
    // layout code for company cells
}

-(void)setValue:(id)value
{
    [ super setValue:value ] ;

    // configure the subviews of this company cell (company name label, address label, CEO label, for example) based on `value`
}

@end 
```

# python - 在 Python 2.7.3 中将网络驱动器映射到一个字母

> ID：12164129
> 
> 赞同：0
> 
> 时间：2012-08-28T17:04:54.970
> 
> 标签：python, networking, share, drive

到目前为止找不到任何有用的答案。我必须使用 Python 2.7.3 将文件从 Linux 机器复制到 Windows 共享驱动器/Samba 共享（用户名和密码保护）

如何将网络驱动器映射到 Python 中的字母？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:31:46.570

以下是如何使用 samba ... 读取文件并保存

如果它很大，请按行读取它，而不是一次...

[使用 pysmbc 通过 samba 读取文件](https://stackoverflow.com/questions/986730/using-pysmbc-to-read-files-over-samba)

如果你真的，真的想要脚本来写信，使用上面的解决方案和net use，或者win32或windll，其中一个肯定会有直接的东西，但是对于windows，总是很难找到一种使用方法脚本，所以最简单的方法就是复制文件而不是映射它......

享受

# c# - C# PInvoke 和 QWidget

> ID：12164133
> 
> 赞同：1
> 
> 时间：2012-08-28T17:05:07.887
> 
> 标签：c#, pinvoke, qwidget

我有一个尝试在 Windows 上自动化的应用程序。我需要找到在应用程序内运行的窗口的位置，然后在应用程序上自动执行几个鼠标事件。

在我正在自动化的软件的前一个化身中，我能够搜索使用 C# 中的 GetWindowText WinAPI 函数（与 GetWindowTextLength 组合）命名的进程的子窗口。

软件制造商现在已经更新了软件并更新了子窗口的绘制方式。现在每个窗口都没有标题，并且有一个 QWidget 的类名。我不能再使用我的旧策略来查找子窗口位置。我认为使用 QWidget 意味着窗口系统使用 Qt 框架。

有什么方法可以使用 PInvoke 从 QWidget 中提取任何数据，以便我可以识别我的窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:28:58.507

这里有几个问题。一个是您无法从另一个进程中获取“未共享”数据。您可以通过调用以下方法获取窗口数据`GetWindowLong`；但是除非您知道 QWidget 在该数据中所做的具体数据（另一个问题），否则您对数据无能为力。

另一个问题是，如果您想在托管应用程序中使用大多数 QT 对象（您可以使用 C++/CLI 和 IJW 执行此操作），您需要在您的应用程序中初始化 QT 应用程序对象......我不确定这会如何影响你想做什么。

# jquery - 从不同的域加载 jQuery Mobile 页面？

> ID：12164136
> 
> 赞同：0
> 
> 时间：2012-08-28T17:05:19.107
> 
> 标签：jquery, ajax, cordova, jquery-mobile

有没有办法从外部页面加载启用 jQuery AJAX 的页面？我正在使用 phonegap 制作一个应用程序，我需要一个页面来在线托管，因为它会不断更新，但我似乎无法弄清楚如何！我尝试只是链接它，但这没有用！有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T20:55:29.827

由于您使用的是 PhoneGap，因此您可以设置一个白名单来解决跨域策略。您必须专门为每个目标平台维护此白名单。

查看本指南（PhoneGap 1.9+）： [http ://docs.phonegap.com/en/1.9.0/guide_whitelist_index.md.html](http://docs.phonegap.com/en/1.9.0/guide_whitelist_index.md.html)

如果您使用的是旧版本的 PhoneGap，则必须注意不同平台之间白名单条目语法的一些不一致。

如果您使用的是 jQueryMobile，还请查看此 PhoneGap 特定建议：http: [//jquerymobile.com/test/docs/pages/phonegap.html](http://jquerymobile.com/test/docs/pages/phonegap.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T04:44:55.680

你在使用 jquery-mobile 吗？

无论如何，您始终可以使用以下配置来允许通过 ajax 进行跨域请求。您还可以参考下面给出的文档链接，这将有助于您更好地理解。

```
$( document ).bind( "mobileinit", function() {
    // Make your jQuery Mobile framework configuration changes here!
    $.support.cors = true;
    $.mobile.allowCrossDomainPages = true; 
}); 
```

如果上述方法不适合您，您也可以使用 JSONP 插件进行 phonegap。这是一个示例。

[JSONP 示例](http://samcroft.co.uk/2010/loading-data-into-a-phonegap-app/)

[jQuery-Mobile 文档](http://jquerymobile.com/test/docs/pages/phonegap.html)

# php - 将来自多个月的多个数据库表条目链接在一起

> ID：12164137
> 
> 赞同：0
> 
> 时间：2012-08-28T17:05:23.767
> 
> 标签：php, mysql, database, web-applications

我正在开发一个个人理财追踪器（为了好玩！），我有一个类别表。每个类别都是表中的一个条目，并且在月底它们都被复制，其相关余额重置为新月份的月初读数。

其中，这些类别可以是“储蓄”类型，因此有一个运行总数。如果我想检索一个类别或更新它，那么我使用了 category_id 字段，这对于当前工作月份来说效果很好，但是将月份链接在一起会让我大吃一惊。对于储蓄类别，我想展示 running_total 在过去六个月中是如何增加的，但在我当前的数据库设计中，类别不“知道”它们之前的几个月，因为它们是在每个月初创建的。

我目前可以检索最近 6 个月的储蓄 running_total 的唯一方法是按类别名称搜索，但这可能不可靠。

我已经考虑向表中添加一个字段“previous_month_category_id”，它可以作为将类别链接在一起的一种方式，但实施起来会很昂贵，因为每次从结果中获取“previous_month_category_id”都需要 6 个 MSQL 操作，然后重新运行查询。

如果 MYSQL 可以进行某种递归，那么也许这可以工作，但我觉得有一个更明显的答案在盯着我看。

我正在使用 Codeigniter 和 MYSQL，但如果需要，我不会害怕原生 PHP。

关于如何做到这一点的帮助会很棒。

更新 1：

以下是储蓄类别与其他类别混合的示例。在每个月末，该条目会重复使用相同的 category_name、type、buget、year 和 users_id，但 category_id 会自动增加，月份更新为新的月份编号，并且运行总计是之前的 running_total + 预算。我将如何在不使用 category_name 的情况下进行一个数据库查询来检索这些？由于这可能会改变，用户决定在 7 月底将其称为“更大的电视”

```
+-------------+--------------+------+--------+---------------+------+-------+----------+
| category_id |category_name | type | budget | running_total | year | month | users_id |
+-------------+--------------+------+--------+---------------+------+-------+----------+
|      44     | Big TV       | sav  |   20   |      240      | 2012 |   8   |   77     |

+-------------+--------------+------+--------+---------------+------+-------+----------+
|      32     | Big TV       | sav  |   20   |      220      | 2012 |   7   |   77     |

+-------------+--------------+------+--------+---------------+------+-------+----------+
|      24     | Big TV       | sav  |   20   |      200      | 2012 |   6   |   77     | 
```

更新 2：

我不确定我是否很好地解释了自己，所以我将详细介绍该应用程序的工作原理，看看是否有帮助。

我有名为“类别”、“交易”和“用户”的表格。类别可以是三种类型之一，1：现金，2：定期付款，3：储蓄。将现金和定期付款类型视为桶，在每个月初，每个桶都已满，目的是从中取出钱并确保在月底还有一点钱（或至少没有消极的）。

这可以按月计算，而且效果很好（对我来说，我认为我已经使用这个系统 2 年了）。这次旅行伴随着储蓄，因为它们逐月联系在一起，更像是一个大桶，每个月都会添加（有一个称为预算的固定增量），直到它溢出然后被耗尽（就像你购买时的大电视一样它），或者取材于这里和那里，目的是建立一个应急基金（比如“当我的车坏了”类型的东西）。

当为每个类别显示相关信息时，仅显示当前月份的现金和常规月份，因为这是最重要的，但对于储蓄而言，当前金额也会显示，但最好显示一个小的历史图表，说明如何随着时间的推移，它已经积累（或耗尽）。为此，我需要某种方法来搜索这些类别的上个月末状态，以便可以绘制图表，但目前我无法弄清楚如何通过 category_name 以外的任何其他方式将它们全部链接起来。

我试图实现一些 DB 规范化，但这是我实施的第一个了解规范化的模式，所以我可能错过了它的某些方面，并且可能避免了任何感觉不正确的过度规范化。

以下是我的表格：

类别

```
 +-------------+--------------+------+--------+---------------+------+-------+----------+
 | category_id |category_name | type | budget | running_total | year | month | users_id |
 +-------------+--------------+------+--------+---------------+------+-------+----------+ 
```

交易

```
+----------------+--------------+--------+------+----------+------------------------+
| transaction_id |  description | amount | date | users_id | categories_category_id |
+----------------+--------------+--------+------+----------+------+-------+---------+ 
```

他们加入了 categories_category_id 这是一个外键

我一直认为每个类别每个月都需要一个新条目，但从下面的评论和答案看来，无论月份如何，我最好只输入一个类别条目，然后即时计算所有内容？

虽然，预算可以由用户更改，因此为了保存记录，我不确定这是否可行，“存款”也从未真正发生过，它只是在月底重复的类别，所以我想那会需要处理......

这个应用程序的目的一直是将财务跟踪与银行账户中发生的物理交易脱钩，并为某人的财务提供一个层次，从而使用户能够避免难以解释的交易等，而只关注所有现金头寸。在这个系统中没有“收入”的概念，也没有银行账户的概念。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:47:59.103

在我看来，您的数据库设计可能需要一些工作。我仍然不完全熟悉您真正想要做什么，但我最初的想法是将每个事务作为单行存储在表中，然后以不同方式查询该表以生成不同类型的报告它。像这样的东西：

```
transactions:
+----+---------+--------+---------------+-----------+-------------+
| id | user_id | amount | running_total | datestamp | category_id |
+----+---------+--------+---------------+-----------+-------------+

categories:
+----+------+------+
| id | name | type |
+----+------+------+ 
```

不要根据时间增加类别。当您实际上有一个新类别时，将一个条目添加到类别表中。如果一个事务可能属于多个类别，则使用第三个（关系）表将事务（基于事务 ID）与类别（基于类别 ID）相关联。

当您有存款时，该`amount`字段将为正数，而对于提款，该字段将为负数。您可以通过执行以下操作来获取当前的运行总数：

```
SELECT running_total FROM transactions
WHERE id = (SELECT MAX(id) FROM transactions WHERE user_id = '$userID'); 
```

您可以通过执行以下操作找到特定月份的总差异：

```
SELECT SUM(amount) FROM transactions WHERE DATE('%c', datestamp) = '$monthNumber'; 
```

您可以通过以下方式找到特定类别的总支出：

```
SELECT SUM(t.amount) FROM transactions t
INNER JOIN categories c ON t.category_id = c.id WHERE c.name = 'Big TV'; 
```

还有很多其他的可能性，但这里的目的只是为了展示一种可能更好的方式来存储您的数据。

# javascript - angularjs中的编译和链接函数有什么区别

> ID：12164138
> 
> 赞同：209
> 
> 时间：2012-08-28T17:05:25.467
> 
> 标签：javascript, angularjs

有人可以简单地解释一下吗？

文档似乎有点迟钝。我没有了解何时使用其中一个的本质和全局。一个对比两者的例子会很棒。

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2013-01-13T03:24:58.803

*   compile 函数 - 用于**模板**DOM 操作（即 tElement = 模板元素的操作），因此适用于与指令关联的模板的所有 DOM 克隆的操作。

*   链接函数 - 用于注册 DOM 侦听器（即，实例范围上的 $watch 表达式）以及**实例**DOM 操作（即，操作 iElement = 单个实例元素）。
    它在模板被克隆后执行。例如，在 <li ng-repeat...> 中，链接函数在 <li> 模板 (tElement) 被克隆（到 iElement）用于特定的 <li> 元素之后执行。
    $watch() 允许将实例范围属性更改通知指令（实例范围与每个实例相关联），这允许指令将更新的实例值呈现给 DOM——通过将内容从实例范围复制到DOM。

请注意，DOM 转换可以在 compile 函数和/或 link 函数中完成。

大多数指令只需要一个链接函数，因为大多数指令只处理特定的 DOM 元素实例（及其实例范围）。

帮助确定使用哪个方法的一种方法：考虑编译函数没有接收 `scope`参数。（我故意忽略了 transclude 链接函数参数，它接收一个包含的范围——这[很少](https://stackoverflow.com/questions/13183005/what-exactly-do-you-do-with-the-transclude-function-and-the-clone-linking-functi)使用。）所以编译函数不能做任何你想做的需要（实例）范围的事情——你可以't $watch 任何模型/实例范围属性，您不能使用实例范围信息操作 DOM，您不能调用在实例范围上定义的函数，等等。

但是，编译函数（如链接函数）确实可以访问属性。因此，如果您的 DOM 操作不需要实例范围，则可以使用 compile 函数。由于这些原因，这是一个仅使用编译函数的指令[示例。](https://stackoverflow.com/questions/13852248/how-to-write-a-double-and-a-ntimes-directive-for-angularjs/13873098#13873098)它检查属性，但不需要实例范围来完成其工作。

这是一个也只使用编译函数的指令[示例。](https://stackoverflow.com/a/14107024/215945)该指令只需要转换模板 DOM，因此可以使用编译函数。

另一种帮助确定使用哪个的方法：如果您不使用链接函数中的“元素”参数，那么您可能不需要链接函数。

由于大多数指令都有链接功能，我不会提供任何示例——它们应该很容易找到。

请注意，如果您需要编译函数和链接函数（或链接前和后链接函数），编译函数必须返回链接函数，因为如果定义了“编译”属性，则忽略“链接”属性。

也可以看看

*   [定义指令时“控制器”、“链接”和“编译”函数之间的区别](https://stackoverflow.com/questions/12546945/difference-between-the-controller-and-link-functions-when-defining-an-angula)
*   Dave Smith 的[关于指令的出色 ng-conf 2104 演讲](http://youtu.be/UMkd0nYmLzY?t=21m59s)（链接转到视频中关于编译和链接的部分）

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2013-12-22T06:17:59.587

我为此苦苦挣扎了几天，我觉得有必要做更多的解释。

基本上，文档提到分离在很大程度上是一种性能增强。我要重申，编译阶段主要用于在编译子元素本身之前需要修改 DOM 时。

出于我们的目的，我将强调术语，否则会令人困惑：

编译器 SERVICE ($compile) 是处理 DOM 并在指令中运行各种代码的角度机制。

compile FUNCTION 是指令中的一段代码，由编译器 SERVICE ($compile) 在特定时间运行。

关于编译功能的一些注意事项：

1.  您不能修改 ROOT 元素（您的指令影响的那个），因为它已经从 DOM 的外部级别编译（编译服务已经扫描了该元素上的指令）。

2.  如果要将其他指令添加到（嵌套）元素，您可以：

    1.  必须在编译阶段添加它们。

    2.  必须将编译服务注入链接阶段并手动编译元素。但是，要小心编译两次！

了解对 $compile 的嵌套和显式调用如何工作也很有帮助，因此我在[http://jsbin.com/imUPAMoV/1/edit](http://jsbin.com/imUPAMoV/1/edit)创建了一个用于查看它的游乐场。基本上，它只是将步骤记录到 console.log。

我将在此处说明您在该垃圾箱中看到的结果。对于自定义指令 tp 和 sp 的 DOM，嵌套如下：

```
<tp>
   <sp>
   </sp>
</tp> 
```

Angular compile SERVICE 将调用：

```
tp compile
sp compile
tp pre-link
sp pre-link
sp post-link
tp post-link 
```

jsbin 代码还具有 tp post-link FUNCTION 在第三个指令 (up) 上显式调用 compile SERVICE，该指令在最后完成所有三个步骤。

现在，我想通过几个场景来展示如何使用编译和链接来做各种事情：

场景 1：作为宏的指令

您想在模板中动态添加指令（例如 ng-show），您可以从属性派生该指令。

假设您有一个 templateUrl 指向：

```
<div><span><input type="text"></span><div> 
```

你想要一个自定义指令：

```
<my-field model="state" name="address"></my-field> 
```

将 DOM 变成这样：

```
<div><span ng-show="state.visible.address"><input ng-model="state.fields.address" ...> 
```

基本上，您希望通过具有一些您的指令可以解释的一致模型结构来减少样板文件。换句话说：你想要一个宏。

这对于编译阶段很有用，因为您可以将所有 DOM 操作基于您仅从属性中知道的事物。只需使用 jQuery 添加属性：

```
compile: function(tele, tattr) {
   var span = jQuery(tele).find('span').first();
   span.attr('ng-show', tattr.model + ".visible." + tattr.name);
   ...
   return { 
     pre: function() { },
     post: function() {}
   };
} 
```

操作顺序将是（您可以通过前面提到的 jsbin 看到这一点）：

1.  compile SERVICE 找到 my-field
2.  它在指令上调用 compile FUNCTION，从而更新 DOM。
3.  然后编译服务进入生成的 DOM，并编译（递归）
4.  compile SERVICE 然后调用 pre-link 自上而下
5.  compile SERVICE 然后调用 post-link BOTTOM UP，所以 my-field 的链接函数在内部节点被链接之后被调用。

在上面的示例中，不需要链接，因为所有指令的工作都是在 compile FUNCTION 中完成的。

在任何时候，指令中的代码都可以要求编译器 SERVICE 在其他元素上运行。

这意味着如果您注入编译服务，我们可以在链接函数中做完全相同的事情：

```
directive('d', function($compile) {
  return {
    // REMEMBER, link is called AFTER nested elements have been compiled and linked!
    link: function(scope, iele, iattr) {
      var span = jQuery(iele).find('span').first();
      span.attr('ng-show', iattr.model + ".visible." + iattr.name);
      // CAREFUL! If span had directives on it before
      // you will cause them to be processed again:
      $compile(span)(scope);
    }
}); 
```

如果您确定您传递给 $compile SERVICE 的元素最初是无指令的（例如，它们来自您定义的模板，或者您只是使用 angular.element() 创建它们），那么最终结果几乎是和以前一样（尽管你可能会重复一些工作）。但是，如果元素上有其他指令，您只是导致这些指令被再次处理，这可能导致各种不稳定的行为（例如，事件和手表的双重注册）。

因此，编译阶段是宏风格工作的更好选择。

场景 2：通过范围数据配置 DOM

这个来自上面的例子。假设您在操作 DOM 时需要访问范围。好吧，在这种情况下，编译部分对您来说毫无用处，因为它发生在范围可用之前。

因此，假设您想通过验证来提取输入，但您想从服务器端 ORM 类 (DRY) 导出验证，并让它们自动应用并为这些验证生成正确的客户端 UI。

您的模型可能会推动：

```
scope.metadata = {
  validations: {
     address: [ {
       pattern: '^[0-9]',
       message: "Address must begin with a number"
     },
     { maxlength: 100,
       message: "Address too long"
     } ]
  }
};
scope.state = {
  address: '123 Fern Dr'
}; 
```

你可能需要一个指令：

```
<form name="theForm">
  <my-field model="state" metadata="metadata" name="address">
</form> 
```

自动包含正确的指令和 div 以显示各种验证错误：

```
<form name="theForm">
  <div>
    <input ng-model="state.address" type="text">
    <div ng-show="theForm.address.$error.pattern">Address must begin with a number</input>
... 
```

在这种情况下，您肯定需要访问范围（因为这是存储验证的地方），并且必须手动编译添加的内容，再次注意不要重复编译。（作为旁注，您需要在包含的表单标签上设置一个名称（我假设这里是 theForm），并且可以通过 iElement.parent().controller('form').$name 链接访问它） .

在这种情况下，编写编译函数是没有意义的。链接真的是你想要的。步骤是：

1.  定义一个完全没有角度指令的模板。
2.  定义添加各种属性的链接函数
3.  删除您可能在顶级元素上允许的任何角度指令（my-field 指令）。它们已经被处理过，这是一种防止它们被双重处理的方法。
4.  通过在顶级元素上调用 compile SERVICE 来完成

像这样：

```
angular.module('app', []).
directive('my-field', function($compile) {
  return {
    link: function(scope, iele, iattr) {
      // jquery additions via attr()
      // remove ng attr from top-level iele (to avoid duplicate processing)
      $compile(iele)(scope); // will pick up additions
    }
  };
}); 
```

当然，您可以逐个编译嵌套元素，以避免在再次编译顶级元素时不必担心 ng 指令的重复处理。

关于这种情况的最后一点说明：我暗示您将从服务器推送验证的定义，在我的示例中，我已将它们显示为范围内的数据。我把它作为一个练习让读者弄清楚如何处理需要从 REST API 中提取数据（提示：延迟编译）。

场景 3：通过链接进行双向数据绑定

当然，link 最常见的用法是通过 watch/apply 简单地连接双向数据绑定。大多数指令都属于这一类，因此在其他地方已经充分涵盖。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2012-08-28T17:08:23.830

[从文档：](http://docs.angularjs.org/guide/compiler)

> ## 编译器
> 
> Compiler 是一个 Angular 服务，它遍历 DOM 寻找属性。编译过程分为两个阶段。
> 
> 1.  **编译：**遍历 DOM 并收集所有指令。结果是一个链接函数。
>     
>     
> 2.  **链接：**将指令与范围组合并生成实时视图。范围模型中的任何更改都反映在视图中，并且用户与视图的任何交互都反映在范围模型中。使范围模型成为单一的事实来源。
>     
>     
> 
> 一些指令[`ng-repeat`](http://docs.angularjs.org/api/ng.directive:ngRepeat)为集合中的每个项目克隆一次 DOM 元素。有一个编译和链接阶段可以提高性能，因为克隆的模板只需要编译一次，然后为每个克隆实例链接一次。

所以至少在某些情况下，**这两个阶段作为优化是分开存在的。**

* * *

[来自@UmurKontacı](https://stackoverflow.com/questions/12164138/what-is-the-difference-between-compile-and-link-function-in-angularjs/12164194#comment16280957_12164194)：

> 如果你要进行 DOM 转换，它应该是`compile`. 如果你想添加一些行为改变的特性，它应该在`link`.

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2013-01-16T13:33:16.153

这是来自 Misko 关于指令的谈话。[http://youtu.be/WqmeI5fZcho?t=16m23s](http://youtu.be/WqmeI5fZcho?t=16m23s)

> 将编译器函数视为在模板上工作的东西，以及允许通过例如向模板添加类或类似的东西来更改模板本身的东西。但实际上是链接函数完成了将两者绑定在一起的工作，因为链接函数可以访问范围，并且链接函数为特定模板的每个实例化执行一次。因此，您可以在编译函数中放置的唯一类型的东西是在所有实例中通用的东西。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-09-27T14:10:08.837

有点晚了。但是，为了未来读者的利益：

我遇到了以下视频，它以非常棒的方式解释了 Angular JS 中的编译和链接：

[https://www.youtube.com/watch?v=bjFqSyddCeA](https://www.youtube.com/watch?v=bjFqSyddCeA)

在这里复制/输入所有内容是不愉快的。我从视频中截取了几张截图，解释了编译和链接阶段的每个阶段：

[![在 Angular JS 中编译和链接](../Images/35188760f7686e75e21a1fe5857a7a05.png)](https://i.stack.imgur.com/DyVuw.png)

[![在 Angular JS 中编译和链接 - 嵌套指令](../Images/36bbc5cf536cc12746bcffdf0ad8f581.png)](https://i.stack.imgur.com/v6DkI.png)

第二个屏幕截图有点混乱。但是，如果我们按照步骤编号，这很简单。

第一个周期：首先对所有指令执行“编译”。
第二个循环：“控制器”和“预链接”被执行（一个接一个） 第三个循环：“后链接”以相反的顺序执行（从最里面开始）

以下是代码，它演示了上述内容：

```
var app = angular.module('app', []);

app.controller('msg', ['$scope', function($scope){

}]);

app.directive('消息'，函数($interpolate){
    返回{

        编译：函数（tElement，tAttributes）{
            console.log(tAttributes.text + "-在编译中..");
            返回 {

                前：功能（范围，iElement，iAttributes，控制器）{
                    console.log(iAttributes.text + "-在 pre..");
                },

                发布：功能（范围，iElement，iAttributes，控制器）{
                    console.log(iAttributes.text + "-In Post..");
                }

            }
        },

        控制器：函数（$scope，$element，$attrs）{
            console.log($attrs.text + " -In controller..");
        },

    }
});

```

```
<body ng-app="app">
<div ng-controller="msg">
    <div message text="first">
        <div message text="..second">
            <div message text="....third">

            </div>              
        </div>  
    </div>
</div> 
```

**更新：**

同一视频的第 2 部分可在此处获得：[https](https://www.youtube.com/watch?v=1M3LZ1cu7rw) ://www.youtube.com/watch?v=1M3LZ1cu7rw 该视频以一个简单的示例详细说明了如何在 Angular JS 的编译和链接过程中修改 DOM 和处理事件.

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-05-29T08:27:38.747

两个阶段：编译和链接

编译：

遍历 DOM 树寻找指令（元素/属性/类/注释）。指令的每次编译都可以修改其模板，或修改尚未编译的内容。一旦一个指令被匹配，它就会返回一个链接函数，该函数在稍后阶段用于将元素链接在一起。在编译阶段结束时，我们有一个编译指令列表及其对应的链接函数。

关联：

当一个元素被链接时，DOM 树在其在 DOM 树中的分支点处被破坏，内容被模板的已编译（和链接）实例替换。原始置换的内容要么被丢弃，要么在嵌入的情况下重新链接回模板。通过嵌入，这两个部分重新链接在一起（有点像一条链，模板部分位于中间）。当调用链接函数时，模板已经被绑定到一个范围，并被添加为元素的子元素。链接功能是您进一步操作 DOM 并设置更改侦听器的机会。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-11-19T11:14:42.373

这个问题很老，我想做一个简短的总结，这可能会有所帮助：

*   为所有指令实例调用一次编译
*   编译的主要目的是返回/创建链接（可能是前/后）函数/对象。您还可以初始化在指令实例之间共享的内容。
*   在我看来，“链接”是这个功能的一个令人困惑的名称。我更喜欢“预渲染”。
*   为每个指令实例调用链接，其目的是准备在 DOM 中呈现指令。

# objective-c - 在 CGContext 中使用比例变换绘制平铺图像会产生精度误差

> ID：12164144
> 
> 赞同：2
> 
> 时间：2012-08-28T17:05:44.477
> 
> 标签：objective-c, core-graphics, quartz-graphics

我想绘制平铺图像，然后使用通常的平移和缩放手势对其进行转换。将我带到这里的问题是，每当我对大量小数位进行缩放转换时，瓷砖中间会出现一条细线像素（1 或 2）。我设法隔离了这样的问题：

```
CGContextSaveGState(UIGraphicsGetCurrentContext());

CGContextSetFillColor(UIGraphicsGetCurrentContext(), CGColorGetComponents([UIColor redColor].CGColor));
CGContextFillRect(UIGraphicsGetCurrentContext(), rect);//rect from drawRect:

float scale = 0.7;
CGContextScaleCTM(UIGraphicsGetCurrentContext(), scale, scale);
CGContextDrawImage(UIGraphicsGetCurrentContext(), CGRectMake(50, 50, 100, 100), testImage);
CGContextDrawImage(UIGraphicsGetCurrentContext(), CGRectMake(150, 50, 100, 100), testImage);
CGContextRestoreGState(UIGraphicsGetCurrentContext()); 
```

使用 0.7 比例尺，这两个图像显示正确平铺： ![0.7 刻度](../Images/69f33cda442de2f5d1491672c19fd638.png)

使用 0.777777 比例（将第 6 行更改为“float scale = 0.777777;”），出现视觉伪影：

![0.777777 比例](../Images/c5d549056e1239dc2e866d4975ca2c96.png)

有没有办法避免这个问题？这发生在 CGImage、CGLayer 和矩形等原始形式中。它也发生在 MacOSx 上。

谢谢您的帮助！

编辑：补充说这也发生在原始形式上，如 CGContextFillRect

edit2：它也发生在 MacOSx 上！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:22:31.747

Quartz 有一个浮点坐标系，因此缩放可能会导致值不在像素边界上，从而在边缘产​​生可见的抗锯齿。如果你不想这样，你有两个选择：

1.  调整您的比例因子，使您的所有缩放坐标都是积分的。这可能并不总是可行的，尤其是当你画很多东西的时候。

2.  使用 为您的图形上下文禁用抗锯齿`CGContextSetShouldAntialias(UIGraphicsGetCurrentContext(), false);`。这将产生清晰的像素边界，但除了直线之外的任何东西都可能看起来不太好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:56:13.660

总而言之，iOS 正在处理整数边界上的离散像素。当您的帧减少 0.7 时，50 减少到 35，就在像素边界上。在 0.777777 它不是 - 所以 iOS 适应和移动/缩小/混合任何东西。

你真的有两个选择。如果要使用上下文的缩放，则向上或向下舍入所需的值，以便得到整数缩放的帧值（您的代码显示 50 作为标准乘法值。）

否则，您无法缩放上下文，而是将内容一一缩放，并根据需要使用 CGIntegralRect 将所有维度向上或向下舍入。

编辑：如果我的怀疑是正确的，那么您还有另一种选择。假设您想要 0.77777 的比例因子和 50,50,100,100 的帧。你取 50，乘以比例，然后向上或向下舍入返回值。然后，您使用该值除以 0.7777 来重新计算新帧以获得一些小数值，当按 0.7777 缩放时返回一个整数。Quartz 非常擅长确定您的意思是整数值，因此忽略了小的舍入误差。我敢打赌，这对你来说会很好。

# c++ - 变量零初始化 - 未定义的行为与否

> ID：12164148
> 
> 赞同：2
> 
> 时间：2012-08-28T17:05:58.143
> 
> 标签：c++, c

> **可能重复：**
> [这个自初始化是否有效？](https://stackoverflow.com/questions/3309042/is-this-self-initialization-valid)

这是一个定义明确的 C/C++ 程序吗？

```
int foo = foo;

int main()
{

} 
```

会`foo`被零初始化，还是未定义的行为？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-28T17:09:44.293

这是一个格式错误的 C 程序。在 C 中，具有静态存储持续时间的对象的初始化程序必须是常量表达式。`foo`右侧的 不是常量表达式。

在 C++ 中，由于对象的零初始化具有静态存储持续时间（这发生在任何其他初始化之前），因此它是格式良好的并且具有定义的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:07:13.067

它甚至不能在 C 中编译。除了使用编译时常量之外，您不能初始化全局变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T17:08:25.170

静态/全局变量初始化为 0。因此：

```
int ThisIsZero;

int main(void)
{
    static int AndSoIsThis;
    int ButThisIsNotInitialized;
    ...
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T17:11:29.203

那不编译 - 问题的重点是什么？

# c# - 当url以“/”结尾时获取url的文件名

> ID：12164149
> 
> 赞同：1
> 
> 时间：2012-08-28T17:05:59.280
> 
> 标签：c#, file, url, default

我想知道如何获取不包含文件名的 Internet url 的文件名。

例如“http://www.google.com/”。如何获得“index.html”？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:07:55.467

```
string fileNameILike = "index.html" 
```

如果 Url 没有文件名段而不是没有文件名，则可以从 Url 获得 - 如果必须，只需发明一个（即用于在客户端上保存文件）。大多数服务器框架甚至没有支持特定 url 的物理文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:20:24.647

正如对该问题的两条评论所解释的那样，您不能这样做

1.  文件本身可以是 index.htm、index.html、index.php、index.asp 或任何其他。您不知道文件的真正含义。

2.  如果网站使用的是框架，则该文件可能不是现有文件，而是重定向到 @andrecalil 指出的完全不同的文件名。

一种方法可以将所有这些*可能的*文件名放在一个数组中，并使用[cURL](http://php.net/manual/en/book.curl.php)（PHP 函数）之类的函数来查看是否返回任何内容。如果是，则表示使用了该文件名，否则，不使用该特定文件。对于像 WordPress 这样的网站，这种方法可能不起作用，因为它们不使用物理文件。他们使用重定向（我相信）。

这只是一种可能的方法。

# xslt - 使用 XSLT 将 XML 扁平化成树。只显示一个分支

> ID：12164154
> 
> 赞同：0
> 
> 时间：2012-08-28T17:06:16.460
> 
> 标签：xslt

我有扁平的 xml 结构，我需要转换成层次结构。在stackoverflow的帮助下，我能够做到。问题：是否可以使用相同的平面结构只显示一个分支？

这是我的 xml 和 xsl 文件：

XML

```
<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="Stack.xsl"?>
<Items>
    <Item>
        <Id>1</Id>
        <ParentId>0</ParentId>
        <Name>1</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>2</Id>
        <ParentId>1</ParentId>
        <Name>1.1</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>3</Id>
        <ParentId>1</ParentId>
        <Name>1.2</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>4</Id>
        <ParentId>1</ParentId>
        <Name>1.3</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>5</Id>
        <ParentId>1</ParentId>
        <Name>1.4</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>6</Id>
        <ParentId>0</ParentId>
        <Name>2</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>7</Id>
        <ParentId>6</ParentId>
        <Name>2.1</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>8</Id>
        <ParentId>6</ParentId>
        <Name>2.2</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>9</Id>
        <ParentId>0</ParentId>
        <Name>3</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>10</Id>
        <ParentId>3</ParentId>
        <Name>1.2.1</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>11</Id>
        <ParentId>8</ParentId>
        <Name>2.2.1</Name>
        <SortOrder>0</SortOrder>
    </Item>
    <Item>
        <Id>11</Id>
        <ParentId>5</ParentId>
        <Name>1.4.1</Name>
        <SortOrder>0</SortOrder>
    </Item>
</Items> 
```

XSL

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns="http://www.w3.org/1999/xhtml">

    <xsl:param name="SelectedId" select="'10'"/>
    <xsl:key name="ChildNodes" match="/Items/Item" use="ParentId"/>

    <xsl:template match="Items">
        <ul>
          <xsl:apply-templates select="Item[ParentId = 0]" />
        </ul>
    </xsl:template>

    <xsl:template match="Item">
        <li>
            <xsl:choose>
                <xsl:when test="Id = $SelectedId">
                    <b><xsl:value-of select="Name" /></b>
                </xsl:when>
                <xsl:otherwise>
                    <xsl:value-of select="Name" />
                </xsl:otherwise>
            </xsl:choose>

            <xsl:variable name="Descendants" select="key ('ChildNodes', Id)" />

            <xsl:if test="count ($Descendants) > 0">
                <ul>
                    <xsl:apply-templates select="$Descendants" />
                </ul>
            </xsl:if>
        </li>
    </xsl:template>
</xsl:stylesheet> 
```

我目前的输出：

```
1
   1.1
   1.2
        1.2.1
   1.3
   1.4
        1.4.1
2
   2.1
   2.2
        2.2.1
3 
```

理想的结果示例：

```
1
   1.1
   1.2
        1.2.1
   1.3
   1.4
2
3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T12:15:09.263

一种方法是使用节点集函数，这将需要在 XSLT 中使用扩展名称空间。

您可以做的是，而不是像当前那样直接输出**Descendants**变量：

```
<ul>
   <xsl:apply-templates select="$Descendants"/>
</ul> 
```

而是将结果存储在变量中

```
<xsl:variable name="list">
   <ul>
      <xsl:apply-templates select="$Descendants"/>
   </ul>
</xsl:variable> 
```

然后您可以将此“结果树片段”转换为节点集，然后您可以检查所选元素（保存在**b**元素中）是否存在。如果是这样，您可以输出它

```
<xsl:if test="exsl:node-set($list)//li[b]">
   <xsl:copy-of select="$list"/>
</xsl:if> 
```

这是完整的 XSLT

```
<xsl:stylesheet version="1.0" 
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
 xmlns:exsl="urn:schemas-microsoft-com:xslt" 
 exclude-result-prefixes="exsl">
   <xsl:output method="html"/>
   <xsl:param name="SelectedId" select="'10'"/>
   <xsl:key name="ChildNodes" match="/Items/Item" use="ParentId"/>

   <xsl:template match="Items">
      <ul>
         <xsl:apply-templates select="Item[ParentId = 0]"/>
      </ul>
   </xsl:template>

   <xsl:template match="Item">
      <li>
         <xsl:choose>
            <xsl:when test="Id = $SelectedId">
               <b>
                  <xsl:value-of select="Name"/>
               </b>
            </xsl:when>
            <xsl:otherwise>
               <xsl:value-of select="Name"/>
            </xsl:otherwise>
         </xsl:choose>
         <xsl:variable name="Descendants" select="key ('ChildNodes', Id)"/>
         <xsl:if test="count ($Descendants) &gt; 0">
            <xsl:variable name="list">
               <ul>
                  <xsl:apply-templates select="$Descendants"/>
               </ul>
            </xsl:variable>
            <xsl:if test="exsl:node-set($list)//li[b]">
               <xsl:copy-of select="$list"/>
            </xsl:if>
         </xsl:if>
      </li>
   </xsl:template>
</xsl:stylesheet> 
```

应用于您的示例 XML 时，将输出以下内容

```
<ul>
   <li>1
      <ul>
         <li>1.1</li>
         <li>1.2
            <ul>
               <li>
                  <b>1.2.1</b>
               </li>
            </ul></li>
         <li>1.3</li>
         <li>1.4</li>
      </ul></li>
   <li>2</li>
   <li>3</li>
</ul> 
```

注意，因为我在这里使用 Microsoft XML，所以扩展命名空间是“urn:schemas-microsoft-com:xslt”。对于其他处理器，您可能必须使用“http://exslt.org/common”

# xcode - Xcode - 如何获取有关异常/堆栈跟踪的更多详细信息？

> ID：12164158
> 
> 赞同：1
> 
> 时间：2012-08-28T17:06:18.807
> 
> 标签：xcode, debugging, stack-trace

我可以知道你们如何在 Xcode 中调试吗？

每次我的 iphone 应用程序出现异常时，例如

> *** 由于未捕获的异常“NSRangeException”而终止应用程序，原因：“*** -[__NSArrayI objectAtIndex:]: index 1 beyond bounds [0 .. 0]” ***第一次抛出调用堆栈：(0x1b48022 0x183dcd6 0x1b34644 0xf37a 0xb5f7 0x1b49e42 0x4fe5b 0x1b46 0x1b49e42 0x1a7fb43 0x1a7f424 0x1a7ed84 0x1a7ec9b 0x22c57d8 0x22c588a 0x9a0626 0x715d 0x1fe5) 终止调用抛出异常

我不知道到底哪里错了。

在 Eclipse 或 Java 编程中，Java 给出了异常的堆栈，清楚地指示了错误的位置。

如何在 Xcode 中获取调用堆栈？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:13:18.830

您可以在抛出异常之前添加断点。首先转到断点导航器（cmd + 6）。在左下角鼠标单击加号按钮。 ![截图1](../Images/778ae210c4955fb10ebbd6e70f49da69.png)

并添加异常断点，然后完成。 ![在此处输入图像描述](../Images/f1da52c71816f1e3ce927da81fc55e29.png) 应该是这样的。

# android - Android JSON：无法将 JSONArray 转换为 JSONObject

> ID：12164161
> 
> 赞同：0
> 
> 时间：2012-08-28T17:06:26.840
> 
> 标签：android, json

我正在尝试解析从服务器获取的 JSON 响应，但收到错误消息：JSONArray 无法转换为 JSONObject。

这是日志猫：

```
08-28 18:56:08.083: W/System.err(1037): org.json.JSONException: Value [{"content":"<p class=\"bodytext\">erhalten Sie einen Überblick über die Aktivitäten der SKBF im Jahr 2011 im aktuellen Jahresbericht.<br \/><br \/><a href=\"de\/portraet\/auftrag\/#c113\" class=\"internal-link\" >SKBF Jahresbericht 2011<\/a><\/p>","pubDate":"01.06.12","category":"Allgemeine News","title":"SKBF Jahresbericht 2011","description":"Wenn Sie wissen wollen, was die SKBF macht","link":"http:\/\/www.skbf-csre.ch\/de\/news\/news-detail\/?tx_ttnews%5BbackPid%5D=2&tx_ttnews%5Btt_news%5D=80&cHash=1274043c236945bf6e592329e6742ebf"}] at 0 of type org.json.JSONArray cannot be converted to JSONObject
08-28 18:56:08.083: W/System.err(1037):     at org.json.JSON.typeMismatch(JSON.java:96)
08-28 18:56:08.083: W/System.err(1037):     at org.json.JSONArray.getJSONObject(JSONArray.java:484)
08-28 18:56:08.093: W/System.err(1037):     at com.example.skbf_csre.SKBFActivity.onCreate(SKBFActivity.java:55)
08-28 18:56:08.093: W/System.err(1037):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072)
08-28 18:56:08.093: W/System.err(1037):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1836)
08-28 18:56:08.103: W/System.err(1037):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1893)
08-28 18:56:08.103: W/System.err(1037):     at android.app.ActivityThread.access$1500(ActivityThread.java:135)
08-28 18:56:08.103: W/System.err(1037):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1054)
08-28 18:56:08.103: W/System.err(1037):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-28 18:56:08.113: W/System.err(1037):     at android.os.Looper.loop(Looper.java:150)
08-28 18:56:08.113: W/System.err(1037):     at android.app.ActivityThread.main(ActivityThread.java:4389)
08-28 18:56:08.113: W/System.err(1037):     at java.lang.reflect.Method.invokeNative(Native Method)
08-28 18:56:08.113: W/System.err(1037):     at java.lang.reflect.Method.invoke(Method.java:507)
08-28 18:56:08.123: W/System.err(1037):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
08-28 18:56:08.123: W/System.err(1037):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
08-28 18:56:08.123: W/System.err(1037):     at dalvik.system.NativeStart.main(Native Method) 
```

我正在尝试做的是：

```
for (int i = 0; i < jsonArray.length(); i++) {
        JSONObject jsonObject = jsonArray.getJSONObject(i);
        System.out.println(jsonObject.getString("title"));
} 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T17:35:21.027

看起来您没有深入挖掘数据以获取数据。你所拥有的是一个包含多个数组的数组，每个数组都包含一个对象。试试这个：

```
for (int i = 0; i < jsonArray.length(); i++) {
        JSONArray innerJsonArray = jsonArray.getJSONArray(i);
        JSONObject jsonObject = innerJsonArray.getJSONObject(0);
        System.out.println(jsonObject.getString("title"));
} 
```

# php - 缓慢的 PHP/MySQL 查询。请求重构协助。（160k 和 300 行表格长度）

> ID：12164172
> 
> 赞同：2
> 
> 时间：2012-08-28T17:06:58.390
> 
> 标签：php, mysql, performance, refactoring, timeout

所以我有一个“注释”字段，它正在将一行（assigned_user_id）更新为新的 id。笔记是大约。长度为 160k。users 表大约有 300 个。

对于每个注释行，我将assigned_user_id 与 users 表进行比较，如果找到匹配项，则获取新的用户 ID 并更新 notes 表。冲洗重复：

```
//dis-allow timeout. Was timing out consistently under 100 rows changes.
set_time_limit(0);
ignore_user_abort(1);

//foreach note
$counter = 0;
foreach ( $msCRMAnnotations as $key=>$value)
{

    //foreach user, check for match between assigned_user_id and id_mscrm
    foreach( $sugarCRMUsers as $key2=>$value2 )
    {
        if($value['assigned_user_id'] == $value2['id_mscrm'] )
        {
            //give some output as to what is changing...
            echo("Note #"  . $counter++ . " - Note id " . $value['id'] . "  is assigned to user " . $value2['user_name'] . ".<br />" );

            $query = "
                UPDATE `notes`
                SET `assigned_user_id` = '" . $value2['id'] . "'
                WHERE `id` = '" . $value['id'] . "' AND
                `assigned_user_id` = '" . $value['assigned_user_id'] . "'
            ";
            $DB->query($query);
            //unset($query);
        }
    }
} 
```

具体来说，我们正在将选定数据从 MsCRM 迁移到 SugarCRM。这是项目的帐户/注释/用户阶段。

所以现在的问题....我怎样才能最好地重构上面的代码以提高性能？非常感谢任何和所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:44:08.787

***从评论假设：***

尝试为这些列设置索引，以便更快地搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:14:25.207

使用准备好的语句*可能会*有所帮助。请参阅[PDO::prepare](http://php.net/manual/en/pdo.prepare.php)。

```
$stmt = $pdo->prepare($query);
...
foreach (...) {
   $stmt->execute($params);
}
... 
```

此外，您可以使用[REPLACE](http://dev.mysql.com/doc/refman/5.0/en/replace.html)命令一次发出多个更新。根据您的主键的实现方式，这可能/可能不起作用：

```
REPLACE INTO `notes` (`id`, `assigned_user_id`)
VALUES
(?, ?),
(?, ?),
(?, ?),
(?, ?),
(?, ?) 
```

...您还需要一组包含 id 和assigned_user_ids 的参数。

[编辑] PDO 可能会决定模拟准备好的语句。您可以使用 关闭此功能`$pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, FALSE)`。分析这两种方式，看看什么最适合你。

# javascript - 使用网格拖放

> ID：12164175
> 
> 赞同：-5
> 
> 时间：2012-08-28T17:07:11.350
> 
> 标签：javascript, jquery, drag-and-drop, grid

我正在寻找一个 jQuery/vanilla javascript 插件，它具有放置在网格中的功能 - 水平 + 垂直。就像 Photoshop 网格一样。并且有 ID 或类似的东西（或易于实现）。

我需要这些 ID 为该 ID 赋予一些价值，以便我可以看到物品被丢弃的位置。希望我的问题很清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:44:06.140

由于您的帖子是半模糊的，我会尽力描述......

我使用 jQueryUI Draggable/Droppable 函数。有了这个，您可以制作您认为合适的自己的网格，并在 jQueryUI 中绑定以获得您想要的拖放。

# asp.net - 4.0 和 2.0 应用程序之间的 Asp.Net Forms Authentication SSO

> ID：12164178
> 
> 赞同：3
> 
> 时间：2012-08-28T17:07:19.743
> 
> 标签：asp.net, single-sign-on, application-pool

4.0 框架应用程序和 2.0 框架应用程序之间的单点登录似乎被破坏了。

我有一个基于 asp.net framework 2.0 的旧应用程序和一个基于 asp.net framework 4.0 的新应用程序，我正在尝试在两者之间配置 SSO。

我已经完成了设置具有相同validationKey、decryptionKey、验证和解密属性以及相同身份验证名称、域、保护和路径属性的相同机器密钥的所有正确配置。

奇怪的是，这个配置在我的本地开发机器上运行良好： - Windows 7 Ultimate（Service Pack 1） - 在应用程序池中运行的 2.0 应用程序设置为 v2.0 集成 - 在应用程序池中运行的 4.0 应用程序设置为 v4.0 集成

但是，在部署服务器 Windows 事件日志中，我收到“请求的表单身份验证失败。原因：提供的票证无效。”：- Windows Server 2008 R2 Standard (Service Pack 1) - 在应用程序池中运行的 2.0 应用程序设置为v2.0 Integrated - 应用程序池中运行的 4.0 应用程序设置为 v4.0 Integrated

我已经检查、重新检查并重新检查了部署机器上的机器密钥和身份验证配置，所以我确定这不是问题所在。

另外，为了争论，在部署服务器上，我什至尝试设置两个应用程序**表单 protection="None"**只是为了查看加密是否是问题并且结果仍然相同。

此外，在部署服务器上，使用相同 SSO 设置配置的所有其他 v2.0 应用程序都没有问题。即使是在不同的应用程序池中运行的那些。简而言之，v2.0 到 v2.0 可以工作，而 v4.0 到 v2.0 会呕吐。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T23:13:56.637

经过几天的绝望，这成功了：在 4.0 web.config 配置标签中

```
<appSettings>
    <add key="aspnet:UseLegacyFormsAuthenticationTicketCompatibility" value="true" />
    <add key="aspnet:UseLegacyEncryption" value="true" />
    <add key="aspnet:UseLegacyMachineKeyEncryption" value="true" />
</appSettings> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T15:01:05.460

如果添加这些 appSetting 键不起作用，请尝试调整 MachineKey 元素的兼容模式，尤其是当您的应用程序之一面向 .NET 4.5 时：

[http://msdn.microsoft.com/en-us/library/system.web.configuration.machinekeysection.compatibilitymode.aspx](http://msdn.microsoft.com/en-us/library/system.web.configuration.machinekeysection.compatibilitymode.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:47:06.183

有关如何管理旧版 Web 应用程序之间的加密的提示，请参阅[此问题的答案。](https://stackoverflow.com/questions/8361323/net-2-0-web-app-authentication-failing-the-ticket-supplied-was-invalid)

# php - 如何计算图片的流量

> ID：12164180
> 
> 赞同：1
> 
> 时间：2012-08-28T17:07:26.763
> 
> 标签：php, logging, statistics, memcached, cdn

我正在运行一个运行良好的网站，我想添加类似 imgur.com 的内容，它是每个图像的简单统计计数器。

```
Submitted 9 hours ago
222,660 views · 22.61 GB bandwidth 
```

问题是，我使用 CDN，所以我的服务器上没有任何类型的日志。

我想用 memcached 模拟这个计数器，

即：每次我为永久链接打印 img 标签时，计数器都会增加一，然后我可以进行数学运算以获取使用的带宽（热链接图像除外，但这不是重点）。

问题是有很多图像，我不确定 memcached 是最好的工具，在某些时候我将被迫将 memcached 数据放在 mysql 或其他地方，并且快速/易失的“写入”将在那个时候成为一个真正的瓶颈。

您将如何使用 mysql 解决这个简单的统计数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:44:29.417

在处理统计数据和创建大量数据时，我们使用[BLACKHOLE 存储引擎](http://dev.mysql.com/doc/refman/5.0/en/blackhole-storage-engine.html)取得了不错的效果。

您只需要一个带有`id`（图像 id）的简单表格，该表格`count`将用于计算查看次数。

然后在加载页面时，您可以聚合您的图像 ID 并运行如下查询：

```
INSERT INTO image_stats (id)
VALUES($some_id)
ON DUPLICATE KEY UPDATE count = count + 1 
```

我们使用这种方法来计算高流量网站的页面浏览量（每天大约 600 000 次页面浏览量），而且速度非常快。

# php - 如果用户离开页面时它仍在执行，则来自 ajax 请求 (YUI) 的错误

> ID：12164182
> 
> 赞同：0
> 
> 时间：2012-08-28T17:07:28.277
> 
> 标签：php, ajax, apache, symfony1, symfony-1.2

我的应用程序是用 PHP 和 Symfony 开发的，它运行在标准的 apache2 配置上。

当我尝试在 ajax 请求仍在执行时离开页面时，就会出现问题。脚本停止并返回 500 错误代码。无论它在内部做什么，每个 ajax 请求都会发生这种情况。

这是预期的行为吗？

我已经尝试将 ignore_user_abort 设置为 true，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T01:58:30.807

我的坏：我冲了。问题之前没有足够的调查，帖子本身也没有足够的信息。无论如何，您的评论引导我找到解决方案。

我正在使用 YUI 连接管理器来处理 ajax 请求。正如 Maerly 所建议的，这并不是真正的 500 错误，而是浏览器中止请求，在 Chrome 控制台中看起来像前者。在页面离开时，YUI 使用 status=0 和 statusText="communication failure" 调用失败回调，所以我通过忽略这种情况来修复它。

谢谢

# python - Python mongoengine 模型中仅保存一个字段

> ID：12164192
> 
> 赞同：1
> 
> 时间：2012-08-28T17:08:19.583
> 
> 标签：python, mongodb, mongoengine

我遇到了一个问题，即只有一个字段保存在 mongoengine 模型上。

这是类定义：

```
from mongoengine import *

connect('leads')

class Contact(Document):
  name = StringField()
  email = StringField()
  phone = StringField()
  company = StringField()
  title = StringField()
  message = StringField() 
```

在 python 终端中，我运行：

```
>>> from Contact import Contact
>>> contact = Contact(name='myrtle williams', email='myrtlewilliams@gmail.com', phone='1234567890', title='president', message='asdfsadf')
>>> contact.save() 
```

然后，在 mongo 中，我查询，我看到的只是一个保存了“消息”字段的文档：

```
{
    "_id" : ObjectId("503cfa86d0d9b317a258e136"),
    "_types" : [
        "Contact"
    ],
    "message" : "asdfsadf",
    "_cls" : "Contact"
} 
```

为什么没有保存其余字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:21:16.203

我尝试运行您的代码，它对我来说效果很好（mongodb 1.8.2，mngoengine 0.6.20，pymongo 2.2.1）。

```
{ 
    "_id" : ObjectId("503cfceb6cb71a38d4a4cd4e"), 
    "_types" : [ "Contact" ], 
    "name" : "myrtle williams", 
    "title" : "president", 
    "phone" : "1234567890", 
    "_cls" : "Contact", 
    "message" : "asdfsadf", 
    "email" : "myrtlewilliams@gmail.com" 
} 
```

您最有可能遇到与 mongoengine 的旧版本之一相关的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T15:25:44.340

您的测试代码看起来不错，并且 MongoEngine 已经有类似的测试用例确保它从我在 0.4 天加入项目之前开始。

我可以想到不同数据的两个可能原因：

1.  您在数据库中有旧的测试数据 - 来自以前版本的`Contact`
2.  您正在导入与执行时描述的文档不同定义的文档：
    `from Contact import Contact`

# ios - 布局子视图中的内存泄漏

> ID：12164193
> 
> 赞同：0
> 
> 时间：2012-08-28T17:08:20.670
> 
> 标签：ios, memory-management, uitableview, memory-leaks

当我在 UITableView 中滚动时，`rateView`is == nil 并且为每个单元格分配了内存。这是内存泄漏吗？或者当单元格滚动出屏幕并为下一个单元格的“rateView”分配新内存时，ARC是否会自动释放内存？

此代码位于`layoutSubviews`我的自定义单元格中：

```
if (_rateView == nil) {
    _rateView = [[DYRateView alloc] initWithFrame:CGRectMake(150, 7, 175, 50) fullStar:[UIImage imageNamed:@"StarFullLarge.png"] emptyStar:[UIImage imageNamed:@"StarEmptyLarge.png"]];
    _rateView.padding = 8;
    _rateView.alignment = RateViewAlignmentRight;
    _rateView.editable = YES;
    _rateView.delegate = self; 
    [_clearRateViewBg addSubview:_rateView];
}
_rateView.rate = _userRating.intValue; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:57:20.547

您需要将 _rateView 声明为强

而且您还需要确保正确地重复使用单元格。

# php - 警告：file_get_contents：无法打开流：已达到重定向限制，正在中止

> ID：12164196
> 
> 赞同：8
> 
> 时间：2012-08-28T17:08:26.730
> 
> 标签：php, dom, redirect, curl, simple-html-dom

我在这个网站上阅读了 20 多个相关问题，在谷歌中搜索但没有用。我是 PHP 新手，正在使用 PHP Simple HTML DOM Parser 来获取 URL。虽然此脚本适用于本地测试页面，但它不适用于我需要该脚本的 URL。

这是我为此编写的代码，遵循 PHP Simple DOM 解析器库附带的示例文件：

```
<?php

include('simple_html_dom.php');

$html = file_get_html('http://www.farmersagent.com/Results.aspx?isa=1&name=A&csz=AL');

foreach($html->find('li.name ul#generalListing') as $e)
echo $e->plaintext;  

?> 
```

这是我收到的错误消息：

```
Warning: file_get_contents(http://www.farmersagent.com/Results.aspx?isa=1&amp;name=A&amp;csz=AL) [function.file-get-contents]: failed to open stream: Redirection limit reached, aborting in /home/content/html/website.in/test/simple_html_dom.php on line 70 
```

请指导我应该做些什么来使它工作。我是新手，所以请提出一种简单的方法。在阅读此站点上的其他问题及其答案时，我尝试了 cURL 方法来创建句柄，但未能成功。我尝试的 cURL 方法不断返回“资源”或“对象”。我不知道如何将它传递给 Simple HTML DOM Parser 以使 $html->find() 正常工作。

请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-07-29T15:00:59.580

今天遇到了类似的问题。我正在使用 CURL，它没有返回我的任何错误。用 file_get_contents() 测试，我得到了......

**无法打开流：已达到重定向限制，正在中止**

进行了一些搜索，我结束了这个适用于我的案例的功能......

```
function getPage ($url) {

$useragent = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.89 Safari/537.36';
$timeout= 120;
$dir            = dirname(__FILE__);
$cookie_file    = $dir . '/cookies/' . md5($_SERVER['REMOTE_ADDR']) . '.txt';

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_FAILONERROR, true);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie_file);
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie_file);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true );
curl_setopt($ch, CURLOPT_ENCODING, "" );
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true );
curl_setopt($ch, CURLOPT_AUTOREFERER, true );
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout );
curl_setopt($ch, CURLOPT_TIMEOUT, $timeout );
curl_setopt($ch, CURLOPT_MAXREDIRS, 10 );
curl_setopt($ch, CURLOPT_USERAGENT, $useragent);
curl_setopt($ch, CURLOPT_REFERER, 'http://www.google.com/');
$content = curl_exec($ch);
if(curl_errno($ch))
{
    echo 'error:' . curl_error($ch);
}
else
{
    return $content;        
}
    curl_close($ch);

} 
```

该网站正在检查有效的用户代理和**cookie**。

cookie问题导致了它！：） 和平！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-29T21:54:54.327

解决方法：

```
<?php
$context = stream_context_create(
    array(
        'http' => array(
            'max_redirects' => 101
        )
    )
);
$content = file_get_contents('http://example.org/', false, $context);
?> 
```

中间是否有代理也可以告知：

```
$aContext = array('http'=>array('proxy'=>$proxy,'request_fulluri'=>true));
$cxContext = stream_context_create($aContext); 
```

更多详细信息：[https](https://cweiske.de/tagebuch/php-redirection-limit-reached.htm) : //cweiske.de/tagebuch/php-redirection-limit-reached.htm（感谢@jqpATs2w）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T17:13:53.543

使用 cURL，您需要将 CURLOPT_RETURNTRANSFER 选项设置为 true，以便通过调用返回请求正文，`curl_exec`如下所示：

```
$url = 'http://www.farmersagent.com/Results.aspx?isa=1&name=A&csz=AL';
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
// you may set this options if you need to follow redirects. Though I didn't get any in your case
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, true);
$content = curl_exec($curl);
curl_close($curl);

$html = str_get_html($content); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-13T12:47:41.600

我还需要添加这个 HTTP 上下文选项`ignore_errors`：

见：[https ://www.php.net/manual/en/context.http.php](https://www.php.net/manual/en/context.http.php)

```
$arrContextOptions = array(
    "ssl" => array(
        // skip error "Failed to enable crypto" + "SSL operation failed with code 1."
        "verify_peer" => false,
        "verify_peer_name" => false,
         ),
     // skyp error "failed to open stream: operation failed" + "Redirection limit reached"
     'http' => array(
          'max_redirects' => 101,
          'ignore_errors' => '1'
      ),

  );

  $file = file_get_contents($file_url, false, stream_context_create($arrContextOptions)); 
```

显然，我仅将它用于在本地环境中进行快速调试。**它不用于生产**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-01T14:46:42.627

我不确定您为什么使用 get html 中的字符串重新定义 $html 对象，该对象旨在用于搜索字符串。如果用字符串覆盖对象，则该对象不再存在且无法使用。

无论如何，要搜索从 curl 返回的字符串。

```
<?php
$url = 'http://www.example.com/Results.aspx?isa=1&name=A&csz=AL';

include('simple_html_dom.php');

# create object
$html = new simple_html_dom();

#### CURL BLOCK ####

$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
# you may set this options if you need to follow redirects.
# Though I didn't get any in your case
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, true);

$content = curl_exec($curl);
curl_close($curl);

# note the variable change.
$string = str_get_html($content);

# load the curl string into the object.
$html->load($string);

#### END CURL BLOCK ####

# without the curl block above you would just use this.
$html->load_file($url);

# choose the tag to find, you're not looking for attributes here.
$html->find('a');

# this is looking for anchor tags in the given string.
# you output the attributes contents using the name of the attribute.
echo $html->href;
?> 
```

您可能正在搜索不同的标签，方法是相同的

```
# just outputting a different tag attribute
echo $html->class;

echo $html->id; 
```

# jquery - UX - 如何以及在何处放置大型表单上的保存按钮

> ID：12164199
> 
> 赞同：0
> 
> 时间：2012-08-28T17:08:27.557
> 
> 标签：jquery, forms, save, user-experience

我有一个在左侧使用 jQuery 选项卡的页面。

大约有 8 个选项卡，每个选项卡内都有表格，每个选项卡内的每个表格上大约有 10-20 个项目。

如何以及显示“保存”按钮或某些标识的最佳方式是每个选项卡上的表单上的项目正在保存？

保存按钮需要保存所有选项卡上的所有字段，但不确定在屏幕上呈现此内容的最佳方式，以获得最佳用户体验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:17:44.553

如果您有一个包含许多项目的选项卡，您可能希望在顶部和底部放置一个保存按钮。

此外，我认为让这些保存按钮中的任何一个保存多个选项卡都是一个坏主意。如果我在 4 个不同的选项卡中进行更改，然后在第 5 个选项卡上单击“保存”，并且出现验证错误，您将遇到五分钱的情况 - 用户将不得不单击所有选项卡才能找到它们.

更好的方法是让每个选项卡都包含自己的表单，您可以方便地显示该选项卡的验证消息。

从用户的角度考虑这一点，您是否不讨厌做出一堆更改却只显示半打错误消息，然后必须单击每个选项卡来修复它们？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:21:07.340

我同意尼克的观点。与带有单个保存按钮的一系列选项卡相比，使用向导样式布局而不在每个步骤中进行验证可能是一个更好的主意。每个步骤都有一个后退和下一步按钮，并且每次您单独为该步骤点击下一步时都会进行验证。最后一步有一个保存按钮而不是下一步按钮。此外，在后退和下一步按钮之间，您有一个进度条，显示用户在进程中的位置。

我已经构建了这样的 UI，并且我发现它们在很多用例中都能很好地工作。

# routing - ServiceStack 路由不适用于查询字符串

> ID：12164201
> 
> 赞同：17
> 
> 时间：2012-08-28T17:08:31.147
> 
> 标签：routing, servicestack

我有一个使用 ServiceStack 构建的简单 REST 服务。

如果我这样配置路由：

```
 //register user-defined REST-ful urls
        Routes
            .Add<Contact>("/Contacts")
            .Add<Contact>("/Contacts/{ContactId}") 
```

此请求成功。

```
http://<server>:59557/Contacts?ContactId=9999 //Works 
```

* * *

如果我像这样配置路由（业务分析师更喜欢生成的元数据）

```
 //register user-defined REST-ful urls
        Routes
            .Add<UpdateContact>("/UpdateContact", "PUT")
            .Add<CreateContact>("/CreateContact", "POST")
            .Add<GetContact>("/Contacts/{ContactId}", "GET")

http://<server>:59557/Contacts/9999           //Works
http://<server>:59557/Contacts?ContactId=9999 //Fails, Handler for request not found 
```

如何配置第二个示例中的路由，以便对 /Contacts?ContactId=9999 的请求成功？

谢谢。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-28T18:39:49.677

在[您的第一个网站解释 wiki](https://github.com/ServiceStack/ServiceStack/wiki/Your-first-webservice-explained)页面上解释了[ServiceStack](http://www.servicestack.net/)中的一些路由：

```
[Route("/hello/{Name}")] 
```

仅匹配：

```
/hello/name 
```

然而：

```
[Route("/hello")] 
```

火柴：

```
/hello?Name=XXX 
```

*注意：QueryString、FormData 和 HTTP 请求正文不是 Route 的一部分（即只有 /path/info 是），但除了每个 Web 服务调用之外，它们都可以用于进一步填充 Request DTO。*

并使用带有通配符路径的路由，例如：

```
[Route("/hello/{Name*}")] 
```

火柴：

```
/hello
/hello/name
/hello/my/name/is/ServiceStack 
```

[何时使用通配符路由的另一个很好的用例](https://stackoverflow.com/questions/7780157/multiple-optional-parameters-with-servicestack-net)。

所以要匹配`/Customers?Key=Value`，`/Customers/{Id}`你需要为这两个路由注册匹配的路由，例如：

```
Routes
    .Add<GetContact>("/Contacts", "GET")
    .Add<GetContact>("/Contacts/{ContactId}", "GET") 
```

### 如何为所有服务自动注册基于约定的路线

与此相关的还有通过[AddFromAssembly](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/ServiceRoutesExtensions.cs#L26)扩展方法注册自动路由，其中​​这个单一调用：

```
Routes.AddFromAssembly(typeof(MyService).Assembly) 
```

遍历并扫描您的所有服务（在指定的程序集中）并根据您已实现的所有 HTTP 方法注册基于约定的路由。例如，如果您的`GetContact`和`UpdateContact`服务具有`Id`属性，它将自动注册以下路由：

```
Routes
    .Add<GetContact>("/Contacts", "GET")
    .Add<GetContact>("/Contacts/{Id}", "GET")
    .Add<UpdateContact>("/Contacts", "POST PUT")
    .Add<UpdateContact>("/Contacts/{Id}", "POST PUT") 
```

如果您只有一个`Contacts`包含所有 HTTP 动词实现的 REST 服务，它将注册这些路由：

```
Routes
    .Add<Contacts>("/Contacts", "GET POST PUT DELETE PATCH")
    .Add<Contacts>("/Contacts/{Id}", "GET POST PUT DELETE PATCH") 
```

## 路由解析顺序

[这在New API Design wiki](https://github.com/ServiceStack/ServiceStack/wiki/New-API)上有更详细的描述，但用于选择路线的权重基于：

1.  首先使用任何精确的文字匹配
2.  精确动词匹配优于所有动词
3.  路线中的变量越多，它的权重就越小
4.  当Routes具有相同的权重时，顺序由Action在服务中的位置或注册顺序（FIFO）决定

有关示例，请参阅wiki 上的[智能路由部分。](https://github.com/ServiceStack/ServiceStack/wiki/New-API)

### 很棒的演出

由于当您拥有大量[路由时，MVC 中的路由可能会很慢，因此我认为值得指出 ServiceStack 的路由实现是通过哈希查找实现的，因此不会遭受 MVC 可能遇到的线性性能回归问题。](http://samsaffron.com/archive/2011/10/13/optimising-asp-net-mvc3-routing)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-12T15:12:56.520

按照[其他 StackOverflow 帖子中的答案，](https://stackoverflow.com/questions/7780157/multiple-optional-parameters-with-servicestack-net)您可以尝试这条路线：

```
/Contacts/{Ids*} 
```

并使用这个请求类：

```
public class ContactRequest { public string Ids { get; set; } } 
```

然后给定 URL，`<service>/Contacts?Id=1&Id=2&Id=3`ServiceStack 将`Ids`使用以下字符串填充请求对象的属性：

```
Id=1&Id=2&Id=3 
```

然后您可以解析为 ID 列表，例如

```
public object Get(ContactRequest request)
{
    var idPairs = request.Ids.Split("&");
    var ids = new List<string>();
    foreach (var idPair in idPairs)
    {
        ids.Add(idPair.Split("=")[1];
    }
    // ... do something with your ids now ...
    // ... return results ...
} 
```

当然，您可能还希望将整个 ID 解析逻辑包装在一个`try...catch`块中以处理格式错误的查询字符串。

# python - Selenium 从字典中选择带有 for 循环的下拉选项

> ID：12164205
> 
> 赞同：7
> 
> 时间：2012-08-28T17:08:45.167
> 
> 标签：python, selenium, web2py

我有一个带有输入和下拉列表的表单：

```
[...]
<select>
<option></option>
<option>Test User 1</option>
<option>Test User 2</option>
</select>
[...] 
```

我将值作为字典传递给 Selenium：

```
dict = {'user':'Test User 1', [...]} 
```

我使用 for 循环来做到这一点：

```
for key in dict.keys():
    inputElement = driver.find_element_by_name(key)
    inputElement.clear()
    inputElement.send_keys(dict[key]) 
```

它适用于所有输入，但下拉菜单不起作用。但是当我在没有循环的情况下这样做时它会起作用。例如：

```
inputElement = driver.find_element_by_name('user')
inputElement.clear()
inputElement.send_keys(dict['user']) 
```

或者

```
inputElement = driver.find_element_by_name('user')
inputElement.clear()
inputElement.send_keys('Test User 1') 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-28T17:25:15.580

```
from selenium.webdriver.support.ui import Select

select = Select(driver.find_element_by_id("dropdown_menu"))
select.select_by_visible_text("Test User 1") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:19:05.770

如果 clear() 是问题...然后执行以下操作：

```
from selenium import webdriver
from selenium.webdriver.support.ui import Select
driver = webdriver.Firefox()
dict = {'user': 'Test User 1', 'user': 'Test User 2'}
for key in dict.keys():
    inputElement = driver.find_element_by_name(key)
    if inputElement.tag_name == 'input':
        inputElement.clear()
        inputElement.send_keys(dict[key])
    elif inputElement.tag_name == 'select':
        # now use the suggestion by J.F. Sebastian
        select_obj = Select(inputElement)
        select_obj.select_by_visible_text(dict[key]) 
```

这适用于 FF，它很可能也适用于 Chrome，但尚未测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T11:45:12.897

如果 clear() 本身导致了问题的意思，那么就像这样包含。 `if key != 'user'` 您不能像这样通过 is_not_dropdown() 进行检查，因为您是在循环中执行此操作，并且值也在字典中。

# sql-server - Windows 7中的SQL Server Management Studio本地数据库连接错误

> ID：12164208
> 
> 赞同：13
> 
> 时间：2012-08-28T17:09:13.343
> 
> 标签：sql-server, sql-server-2008, ssms

我在 Windows 7 中运行 SQL Server 2012 Management Studio Express，我在连接到本地数据库时遇到问题。我尝试了上述所有解决方案，但没有奏效。请帮忙。提前致谢。

安装网址在[这里](http://www.filehippo.com/download_sql_server_studio/)。

> 错误 - 建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）（Microsoft SQL Server，错误：-1）

如需帮助，请单击[MSDN 链接](http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&EvtSrc=MSSQLServer&EvtID=-1&LinkId=20476)。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-28T17:18:25.083

假设您安装了 SQL Server 并使用了命名实例 SQLEXPRESS，您的服务器名称应为：

```
.\SQLEXPRESS 
```

或者：

```
127.0.0.1\SQLEXPRESS 
```

您可以检查实例名称（它可能不是 SQLEXPRESS）以及服务器是否在“开始”菜单中以与此非常相似的路径运行（但会因版本而异）：

> 开始 > 程序 > Microsoft SQL Server > 配置工具 >
>    SQL Server 配置管理器

如果当前已停止，则需要右键单击并选择开始：

![在此处输入图像描述](../Images/6053198990c1c024a6795675499e35ae.png)

您还应该右键单击并确保启动模式设置为自动（位于属性 > 服务下）。

该错误消息似乎暗示服务器正在尝试使用命名管道。虽然在本地它应该能够使用共享内存，但您接下来应该确保 SQL Server Browser 服务正在运行。你可以这样做：

> 控制面板 > 管理工具 > 服务

![在此处输入图像描述](../Images/70f10dc240ec7c38d261ae8a2f7ed355.png)

如果未启动，请启动它，并将其启动模式设置为自动。（如上所述，您可以从右键菜单中执行这两项操作。）

如果您仍然没有得到任何结果，您可能安装了 SQL Server 2012，而没有手动将您的 Windows 帐户添加到管理员组。如果是这种情况，希望您将其设置为使用混合模式，并且您可以以 sa 身份连接。否则，您将需要使用[PSExec.exe 之](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)类的工具以 NT AUTHORITY\SYSTEM 身份运行 SSMS：

```
PsExec -s -i "C:\...path to ssms...\Ssms.exe" 
```

无论您可以作为 sa 连接还是需要使用 PSExec 连接，接下来的步骤是：

1.  确保您的 Windows 帐户是 Server > Security > Logins 下的登录名。如果它不存在，请通过右键单击登录 > 新登录来添加它。
2.  确保登录是 sysadmin 固定服务器角色的成员。如果不是，请确保它位于“服务器角色”选项卡下。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-08-08T11:02:45.840

您可以使用命名管道将 SSMS 连接到 LocalDB 实例。

1 - 通过运行以下命令获取 (localdb) 实例的地址： ***"C:\Program Files\Microsoft SQL Server\110\Tools\Binn\SqlLocalDB.exe" info [InstanceName]*** （如果它是您的默认实例）重新感兴趣，将 v11.0 指定为 [InstanceName] 您可以在 CMD 中使用以下命令将其写入文本文件：

```
"C:\Program Files\Microsoft SQL Server\110\Tools\Binn\SqlLocalDB.exe" info v11.0 > C:\db_details.txt 
```

2 - 复制“实例管道名称”值，例如***np:\.\pipe\LOCALDB#1E0FF40B\tsql\query***

3 - 将“实例管道名称”值粘贴为服务器名称。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-04-06T19:54:06.067

聚会迟到了，但看看这个链接我有同样的问题

[http://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx](http://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx)

也试试 `(localdb)\V11.0 as the server name.`

注意..，实例名称 V11.0 区分大小写，大写 V 然后 11.0

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-04-04T06:15:52.967

经过两天的故障排除，终于得到了结果**。**

**使用 ServerName = (LocalDb)\MSSQLLocalDB**

[图片](https://i.stack.imgur.com/fMBP8.png)

有关更多信息，请访问参考链接 - [https://social.msdn.microsoft.com/Forums/sqlserver/en-US/b75bef7e-13f3-4658-8d43-9df12ab4c320/connecting-localdb-using-sql-server-management -studio-express?forum=sqlexpress](https://social.msdn.microsoft.com/Forums/sqlserver/en-US/b75bef7e-13f3-4658-8d43-9df12ab4c320/connecting-localdb-using-sql-server-management-studio-express?forum=sqlexpress)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-04T17:20:41.113

试试这个代码：

```
RegistryKey rKey;
string InstanceName;

//use this string for database connection
string ConString;
string regPath = @"Software\Microsoft\Microsoft SQL Server\UserInstances";
rKey = Registry.CurrentUser.OpenSubKey(regPath);

if (rKey.GetSubKeyNames().Length != 0)
{
    regPath += @"\" + rKey.GetSubKeyNames()[0];
    rKey = Registry.CurrentUser.OpenSubKey(regPath);
    InstanceName = rKey.GetValue("InstanceName").ToString();
    ConString = @"Server=np:\\.\pipe\" + InstanceName +
        @"\tsql\query;Initial Catalog=RahBord;Trusted_Connection=True";
}
else
{
    Process.Start(@"C:\Program Files\Microsoft SQL Server\110\Tools\Binn\SqlLocalDB.exe", "c amirLOCALDB -s");
    regPath += @"\" + rKey.GetSubKeyNames()[0];
    rKey = Registry.CurrentUser.OpenSubKey(regPath);
    InstanceName = rKey.GetValue("InstanceName").ToString();
    ConString = @"Server=np:\\.\pipe\" + InstanceName + @"\tsql\query;Initial Catalog=RahBord;Trusted_Connection=True";
} 
```

如果您的实例停止，请转到此地址：

```
C:\Program Files\Microsoft SQL Server\110\Tools\Binn\ 
```

并使用此命令

```
SqlLocalDB.exe s yourInstance 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-04T17:45:20.803

您是否检查过您的特定服务器是否启用了 TCP 协议。按照这些说明查看它是否已启用。

[http://msdn.microsoft.com/en-us/library/bb909712(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/bb909712(v=vs.90).aspx)

启用它们后，您必须重新启动服务。如果它无法启动，请检查事件日志以了解它没有启动的原因。常见原因是该端口上已经运行了另一个服务（通常是另一个版本的 sql server）。如果是这种情况，您可能需要重新配置服务器端口。检查此博客文章（还包括有关如何检查 TCP/IP 启用的图像）：

[http://blogs.msdn.com/b/sqlblog/archive/2009/07/17/how-to-configure-sql-server-to-listen-on-different-ports-on-different-ip-addresses。 aspx](http://blogs.msdn.com/b/sqlblog/archive/2009/07/17/how-to-configure-sql-server-to-listen-on-different-ports-on-different-ip-addresses.aspx)

之后，通常的下一个障碍是防火墙或 Internet 安全软件阻止连接。即使在本地实例上，这也发生在我身上。解决这个问题，你应该很高兴。

如果在这一切之后您仍然无法连接，请在事件日志中搜索原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-21T11:01:58.063

1.  打开任务管理器，然后在进程选项卡下找到 sqlservr.exe
2.  如果没有，请确保列命令行可见，然后单击查看>选择列>向下滚动并勾选命令行>单击确定
3.  你会看到 "C:\Program Files\Microsoft SQL\110\LocalDB\Binn\sqlservr.exe" -c SMSSQL11E.LOCALDB -s **LOCALDB#C1E849D0** --etc
4.  记下**LOCALDB#C1E849D0**
5.  打开 SQL Management studio (runas Administrator) 然后在 Server name 中输入 \\.\pipe**LOCALDB#C1E849D0**\tsql\query 您现在应该可以浏览 LOCALDB 中的所有数据库

# entity-framework - 如何在实体框架中添加表关联？

> ID：12164209
> 
> 赞同：0
> 
> 时间：2012-08-28T17:09:18.147
> 
> 标签：entity-framework, c#-4.0

我有一个名为 User 的表、一个名为 Permission 的表和一个关联表，因此许多用户可以拥有许多权限。

**用户**

身份证 - PK

**允许**

身份证 - PK

**用户权限**

用户 ID - PK（对用户的 FK）

PermissionID - PK（FK 到 Permission）

在实体框架中，如何向关联表添加条目以将用户链接到权限？

我试过以下没有运气：

```
var user = _Repository.Users.Single(u => u.ID == someUserID);
var permission = _Repository.Permissions.Single(p => p.ID == somePermissionID);

user.Permissions.Add(permission) //Not working
user.Permission.Attach(permission) //Still not working

_Repository.Save(); 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:13:22.530

它应该是 ：

```
UserPermission obj = new UserPermission { UserID = someUserID, PermissionID = somePermissionID };
_Repository.UserPermissions.AddObject(obj)
_Repository.Save(); 
```

希望这会有所帮助。

# javascript - jQuery可读性：在里面插入表格 元素

> ID：12164215
> 
> 赞同：1
> 
> 时间：2012-08-28T17:10:13.470
> 
> 标签：javascript, jquery, code-readability

我希望得到一些关于如何编写更漂亮的 javascript 和 jQuery 代码并获得更多可读性的建议。

在这种情况下，我希望在列表元素中插入表格。列表和表格都是使用脚本动态添加的。

我有一些这样的代码：

```
 $('#Items').append("<ul></ul>");
 var car_index;
 var photo_index;
 var lot_index;
 for (car_index = 0; car_index < cars.length; car_index++)
 {
   lot_index = car_index + 1;
   //From here, I thought the code is really ugly...though it works.
   //I can't image that I will need to adde 3 rows with 6 cols into the table by using this way
   //Also each col may has their own style need to be assigned....
   //Any advise??
   $('#Items ul').append("<li id='r_" + car_index +"'></li>");
   $('#r_' + car_index).append("<table cellspacing='2' cellpadding='0'><tr><td width='50' align='left' style='font-size:10pt; font-weight:bold'>Lot " + lot_index +"</td></tr></table>");               
  } 
```

正如我在上述代码的注释中所写。我可以使用 append 方法并在其中放置大量 HTML 代码。然而它看起来真的很丑……在上面的例子中，我只是在列表中添加了一行。在最终目标中，我必须添加三行，大约 6 个单元格。每个单元格都有自己的内容样式集。真的会一团糟。

任何建议将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:53:42.220

好吧...经过一番思考，我找到了一种更清晰的方法来编写这种代码。我不确定这是否是 goog 的选择，因为它需要更多的工作......但我觉得这样写更好。

这个想法非常简单，创建对象来存储将为每个块固定的 HTML 标签。作为我的示例，每次添加列表时都会重复一个表。那么为什么不将所有固定的表格标签及其样式属性存储到一个类似对象的数组中呢？

```
 var unit = 
 {
   table_header : "<table border = '1'>",
   row_1_col_1 : "<tr><td>Lot ",
   row_1_col_2 : "</td><td><a class='addto' href='#'>Add to like</a>",
   row_2_col_1 : "</td></tr><tr><td>",
   row_2_col_2 : "</td><td><img src='",
   row_3 : "'></td></tr><tr><td>",
   table_end : "</td></tr></table><hr />"       
 }; 
```

将此变量设为全局变量，而不是需要添加表时，原代码：

```
 $('#r_' + car_index).append("<table cellspacing='2' cellpadding='0'><tr><td width='50' align='left' style='font-size:10pt; font-weight:bold'>Lot " + lot_index +"</td></tr></table>"); 
```

会变成这样：

```
 $('#r_' + car_index).append(unit['table_header'] +
                             unit['row_1_col_1'] + "Content in cell 1" +
                             unit['row_1_col_2'] + "Content in cell 2" +
                             unit['row_2_col_1'] + "Content in cell 3" +
                             unit['row_2_col_2'] + "Content in cell 4" +
                             unit['row_3'] + unit['table_end']); 
```

请注意双引号和单引号，并且需要引用数组的索引（如果遇到问题，请参阅javascript数组的使用以获取详细信息）。

我认为这种方法的优点是修改表格更容易。添加行、更改内容或更改样式变得更加容易，因为它使用单个对象。

我也不确定这是否是一个好方法，希望听到更多关于您的想法！谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:17:30.933

也许通过[Mustache](https://github.com/janl/mustache.js)或[jQuery](http://api.jquery.com/category/plugins/templates/)使用模板。

查看更多：[您推荐哪些 Javascript 模板引擎？](https://stackoverflow.com/questions/7788611/what-javascript-template-engines-you-recommend)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:19:34.433

试试这个，因为 `$('#Items ul').append("<li id='r_" + car_index +"'></li>);`“”之间没有包含

```
$('#Items ul').append("<li id='r_"+car_index+"'></li>");
$('#r_' + car_index).append("<table cellspacing='2' cellpadding='0'><tr><td width='50' align='left' style='font-size:10pt; font-weight:bold'>Lot " + lot_index +"</td></tr></table>");               
  } 
```

# java - 奇怪的 JMenu 位置问题

> ID：12164216
> 
> 赞同：1
> 
> 时间：2012-08-28T17:10:15.490
> 
> 标签：java, swing, jmenu

当我看到一个奇怪的问题时，我试图将两个 JMenu 添加到父 JMenu：

```
StateListener stL = new StateListener();            
SpeedListener spL = new VitesseListener();

animation.add(speed);
animation.add(state);

 //Add of JRadiobuttons (st1, st2 and st3) to JMenu : state
 state.add(st1); 
 state.add(st2);
 state.add(st3);

  //Add of JRadiobuttons to ButtonGroup : bG1
  bG1.add(st1);
  bG1.add(st2);
  bG1.add(st3);

   //Setting a default selected button
   st2.setSelected(true);

    //Add of an action listener to JRadioButtons (StateListener : stL)
    st1.addActionListener(stL);
    st2.addActionListener(stL);
    st3.addActionListener(stL);

 //Same code, with speed this time
 speed.add(sp1);
 speed.add(sp2); [...] 
```

这段代码效果很好，但是当我将速度和状态的添加切换到动画时，就像我在下面的代码中所做的那样，代码有一种“错误”。确实，当我将鼠标移到“速度菜单”上时，一切都卡住了，我无能为力（包括以干净的方式关闭程序）：

```
[...] animation.add(stae);
animation.add(speed); [...] 
```

感谢您的帮助，并为我的糟糕（我什至不知道我是否可以在不粗俗的情况下使用这个词^^）英语感到抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T10:34:22.510

对我来说，我会使用

```
this.setPreferredSize(new Dimension(800,245)); 
```

如果您使用任何布局管理器。参见[setSize() 与 setPreferredSize()](https://stackoverflow.com/questions/1783793/java-difference-between-the-setpreferredsize-and-setsize-methods-in-compone)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T10:27:24.597

我发现了我的问题：速度的 JMenu 包含 8 个 JRadioButton。我的第八个按钮在我的窗口外面（高度太小），这就是我的程序腐烂的原因。我的程序在逆向 JMenu（速度第一，状态第二）上运行良好的事实是因为 state 的 JMenu 大小。事实上，它更短（包含 3 个 JRadioButtons 而不是 8 个用于速度的），当我将它放在 speed 的 JMenu 下时，这个是较高的，并且多出 20px 左右，足够多一个 JRadioButton。

我用八个变化解决了这个问题：

```
this.setSize(800,245); 
```

代替

```
this.setSize(800,230); 
```

谢谢你的帮助，andrew，做一个 SSCCE 改变了我的观点，我很快就看到了我的问题；）

# php - 与自定义 ID 混合的简短唯一 ID

> ID：12164219
> 
> 赞同：1
> 
> 时间：2012-08-28T17:10:35.607
> 
> 标签：php, mysql, short

我所拥有的是一张带有元素的表格。每个元素都有一个唯一的id和一个唯一的short id，称为short。它看起来像下面这样：

```
id=>short
1 => 1
9 => 9
10=> a
37=> B 
```

等等。短 id 是通过 php 函数生成的。

我现在想做的是让用户将自己的自定义设置为短。假设第 38 位用户希望他的短片是“foobar”。简单的解决方案是：

```
10=> a
37=> B
38=> foobar
39=> D 
```

但那样我会失去 C 。如果许多用户决定使用自定义的短 id，最终会导致许多短 id 丢失。

所以每个自定义的short都会导致id“太超前”有什么办法可以解决这个问题吗？在mysql或php中。

完美的是：

```
10=> a
37=> B
38=> foobar
39=> C
40=> FUBAR
41=> D 
```

更新：（可能的三排方法）

仅当生成短 ID 而不是定制时，“已使用”行才会增加。这样，可以始终使用“已使用”行生成短 ID。例如：

```
id  |  short  |  used
10  |  a      |  10
37  |  B      |  37
38  |  foobar |  37
39  |  C      |  38
40  |  FUBAR  |  38
41  |  D      |  39 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T03:22:53.673

应该足够简单。

1.  使用回收的短 id 创建一个新表

2.  创建另一个（序列）表，其中包含用于生成短 id 的最后一个 id

3.  当短 ID 被自定义 ID 替换时，将其插入回收站

4.  当您需要创建新的短 id 时，请先查看回收站。

    一种。如果您能找到一个项目，请将其用作新的短 ID（然后将其删除）

    湾。如果 bin 为空，则将序列加一并从中生成一个新的短 id。

**更新**

这是创建和使用序列表的简单方法：

```
CREATE TABLE seqname (id BIGINT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY) ENGINE=MyISAM SELECT 0 AS id;

UPDATE seqname SET id=LAST_INSERT_ID(id+1); 
```

# objective-c - OpenGL ES混合功能，所以颜色总是在背景中显示

> ID：12164221
> 
> 赞同：2
> 
> 时间：2012-08-28T17:10:55.060
> 
> 标签：objective-c, ios, opengl-es, glblendfunc

我正在使用 OpenGL ES 1.1 在我的 iPad 应用程序中画线。我想确保无论背景颜色如何，绘制的线条在屏幕上始终可见，并且不允许用户选择颜色。是否有混合功能可以产生这种效果？因此，所绘制线条的颜色将根据其下方已绘制的颜色而变化，因此始终可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T22:24:38.080

遗憾的是，最终将片段混合到帧缓冲区中仍然是固定功能。此外`glLogicOp`，ES 中没有实现，所以你不能做一些像 XOR 绘图这样便宜的事情。

我认为最终的效果是：

*   您希望输出颜色是帧缓冲区中已有颜色的自定义函数；
*   但是无法在着色器中读取帧缓冲区（它会破坏管道并导致并发问题）。

因此，您将不得不实现一个 ping pong 管道。

您有两个屏幕外缓冲区。一个代表上一帧输出的内容，另一个代表上一帧输出的内容。

要生成一个新帧，您可以使用表示之前帧的帧作为输入来渲染。因为它是一个输入，所以您可以在任何地方对其进行采样并对其进行任何您喜欢的计算。您渲染到您拥有的另一个缓冲区（即更旧的缓冲区），因为您不再关心它的内容。

然后将所有内容复制到屏幕上并将两者交换，这意味着您刚刚绘制的内容仍然在纹理中，以引用您上一帧绘制的内容。您刚才提到的内容将成为您的下一个绘图目标，因为它是您方便地已经拥有的东西。

因此，您将立即对渲染到纹理感兴趣。您还需要决定要使用什么功能来为现有背景选择合适的“不同”颜色。也许只是反转它会做？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:19:10.627

我认为这可以工作：

`glBlendFunc(GL_ONE_MINUS_DST_COLOR, GL_ZERO);`

用白色绘制线条，然后结果将呈现为

`[1,1,1,1] * ( 1 - [DstR, DstG, DstB, DstA]) + ([DstR, DstG, DstB, DstA] * 0)`

这应该渲染背景为白色的黑色像素，背景为黑色的白色像素，背景为蓝色的黄色像素等。

# jsf - Primefaces 自动完成功能不起作用并且没有显示异常

> ID：12164224
> 
> 赞同：0
> 
> 时间：2012-08-28T17:11:23.637
> 
> 标签：jsf, jakarta-ee, primefaces

我是primefaces的新手，我想使用primeface的自动完成标签。所以我遵循[了这个例子](http://www.primefaces.org/showcase/ui/autoCompleteBasic.jsf)。
这是我的代码

# 布局.xhtml

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<head>

<title>Title</title>
</head>
<body>
<h:form id="form">  
    <p:panel header="AutoComplete" toggleable="true" id="panel">
        <h:panelGrid columns="2" cellpadding="5">  

            <h:outputLabel value="Simple :" for="acSimple" />  
            <p:autoComplete id="acSimple" value="#{autoCompleteBean.txt1}"   
                    completeMethod="#{autoCompleteBean.complete}"/>
                    </h:panelGrid>
                    </p:panel>
                    </h:form>
</body>
</html> 
```

# AutoCompleteBean.java

```
import java.util.ArrayList;
import java.util.List;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.RequestScoped;
@ManagedBean(name="autoCompleteBean")
@RequestScoped
public class AutoCompleteBean {  

    private String txt1;  

    public List<String> complete(String query) {  
        List<String> results = new ArrayList<String>();  

        for (int i = 0; i < 10; i++) {  
            results.add(query + i);  
        }  

        return results;  
    }  

    public String getTxt1() {  
        return txt1;  
    }  

    public void setTxt1(String txt1) {  
        this.txt1 = txt1;  
    }  
} 
```

所以 layout.xhtml 呈现良好并向我显示一个文本字段，但之后它不起作用并且不显示自动完成功能。
有什么遗漏吗？或者会有什么问题
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:47:48.460

您发布的 xhtml 使用标准 html 标记作为***头部***和***主体***，因此它可能无法正确解释用于调用 bean 中完整方法的 Javascript。

尝试使用***h:head***和***h:body***。

提示可能会显示在您的输出窗口中。检查类似的东西：

```
sourceId=null[severity=(ERROR 2), summary=(One or more resources have the target of 'head', but no 'head' component has been defined within the view.), detail=(One or more resources have the target of 'head', but no 'head' component has been defined within the view.)] 
```

请参阅有关 h:head in primefaces 的 Stack Overflow 讨论：[Java Facelets 中的 <h:head> 和 <head> 有什么区别？](https://stackoverflow.com/questions/6028105/whats-the-difference-between-hhead-and-head-in-java-facelets)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:50:48.003

编写 facelets 时，应始终使用**h:head**和**h:body 。**原因是为了使自动完成工作需要 javascript，如果您不包含 h:head jsf 将无法正确放置 javascript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-06T10:29:48.573

我遇到了类似的问题，但是在我的情况下，当我删除 p:autocomplete 标记周围的 p 标记时，问题**得到****了**解决。

以下代码不会抛出错误消息，但不会出现自动选择下拉菜单。删除后`<p></p>`一切正常。

```
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:p="http://primefaces.org/ui"
xmlns:f="http://xmlns.jcp.org/jsf/core"
xmlns:h="http://xmlns.jcp.org/jsf/html">
<h:head>
</h:head>
<h:body>
    <h:form>
        <p>
            <p:autoComplete id="place" value="#{addPlaceBean.place}"
                completeMethod="#{autoCompletePlace.completePlace}" var="place"
            itemLabel="#{place.city}, #{place.country}"
            itemValue="#{place}" converter="placeConverter">
            </p:autoComplete>
        </p>
    </h:form>
</h:body>
</html> 
```

# jsf - 渲染时的 JSF 相同 ID

> ID：12164226
> 
> 赞同：2
> 
> 时间：2012-08-28T17:11:28.037
> 
> 标签：jsf, duplicates, identifier, illegalstateexception

假设我`rendered`基本上使用的是案例陈述。我有一个输入字段的标签和消息，但我希望字段本身根据情况而变化。像这样：

```
<p:inputText id="foo" value="#{myBean.params[paramKey]}" 
   rendered="#{paramIsInput}" />
<p:calendar  id="foo" value="#{myBean.params[paramKey]}" 
   rendered="#{paramIsCalendar}" /> 
```

如果我这样做，那么我会收到以下错误：`java.lang.IllegalStateException: Component ID j_idt64:foo has already been found in the view.`

作为一种解决方法，我为每种参数类型创建了许多标签/消息并更改了它们的 ID。但这带来了我的问题。如果实际上只渲染了一个具有 id 的组件，那么在我的 jsf 文件中定义多个组件又有什么关系呢？有没有办法让他们保持所有相同的ID？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-28T17:30:44.067

JSF 组件 ID 在视图构建期间应该是唯一的，而不是仅在视图渲染期间。这样，您就可以有效地得到**两个**具有相同 ID 的 JSF 组件，这确实是无效的。您希望在视图构建时间之后在 JSF 组件树中有效地最终得到**一个**具有所需 ID 的 JSF 组件。

您可以通过在视图构建期间填充组件来实现此目的，而不是在视图渲染期间有条件地生成其 HTML 输出。您可以为此使用 JSTL`<c:if>`标记。

```
<c:if test="#{paramIsInput}">
    <p:inputText id="foo" value="#{myBean.params[paramKey]}" />
</c:if>
<c:if test="#{paramIsCalendar}">
    <p:calendar id="foo" value="#{myBean.params[paramKey]}" />
</c:if> 
```

然而，这有一些警告：`<c:if test>`条件不能依赖于仅在 JSF 渲染期间才知道的变量。所以它不必依赖于`var`JSF 迭代组件，或者是视图范围 bean 的属性等。

### 也可以看看：

*   [JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T17:18:42.960

> 如果实际上只渲染了一个具有 id 的组件，那么在我的 jsf 文件中定义多个组件又有什么关系呢？

JSF 怎么知道只有一个组件会被渲染？您正在使用`EL`in`rendered`并且两者都可以评估为真。这是[文档](http://java.sun.com/javaee/javaserverfaces/1.2_MR1/docs/api/javax/faces/component/UIComponent.html#setId%28java.lang.String%29)，它说您不能在命名容器内有重复的 id。

> 指定的标识符必须在所有组件（包括方面）中唯一，这些组件是作为 NamingContainer 的最近祖先 UIComponent 的后代，或者在整个组件树的范围内（如果没有这样的作为 NamingContainer 的祖先）。

-

> 有没有办法让他们保持所有相同的ID？

如果您仍然希望在多个组件上具有相同的 id，则需要**分隔命名容器。**

您可以使用[PanelGrid](http://www.primefaces.org/docs/vdl/4.0/primefaces-p/panelGrid.html)作为命名容器。

# javascript - 设置 display:none 后 Flash 对象方法不可用

> ID：12164228
> 
> 赞同：1
> 
> 时间：2012-08-28T17:11:35.333
> 
> 标签：javascript, css, flash, object, youtube

这是我目前面临的情况。我有一个嵌入的 youtube 视频作为`<object>`. 该对象公开了 javascript API 来控制播放器。将 display:none 设置为对象或包装对象的 div 后，方法变得未定义。一旦将显示 css 属性设置回“块”-这些方法再次可用。我创建了一个 Fiddle 来展示这个问题。

[展示案例小提琴](http://jsfiddle.net/borislit/ynuMT/)

我想知道为什么会这样，是否可以监控对象的状态并查看它是否已经加载并准备好使用？

提前谢谢！

**注意：问题可以在 Chrome 中看到**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:13:55.210

在 IE 中对我来说效果很好。

我的假设是，您使用的任何浏览器都认为通过“优化”东西而变得聪明。那个 Flash 对象被隐藏了？好吧，你不可能想用它做任何事情，没办法。[/讽刺]

我建议将元素移出屏幕而不是隐藏它：

```
#elem {
    position: fixed;
    right: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T23:26:10.973

使用 NPAPI 插件（即不是 Internet Explorer）时会发生这种情况。您可以将项目移出屏幕（需要`display:absolute`/ `display:relative`），或者将 flash 对象设置为包含 html 元素的 100% 大小，并将该元素的高度或宽度设置为 0.01px。不要使用`$(elem).fadeOut`，因为在动画结束时， jq 设置了`display:none`. 而是使用`$(elem).fadeTo`which 不会改变其他 css 属性。还需要添加一个新参数

```
<param name="wmode" value="transparent"> 
```

让淡入淡出动画工作。

[http://jsfiddle.net/ynuMT/4/](http://jsfiddle.net/ynuMT/4/)

# linux - 如何找到某物指向的内核结构？

> ID：12164230
> 
> 赞同：2
> 
> 时间：2012-08-28T17:11:44.307
> 
> 标签：linux, kernel, kmem

我正在尝试调试内核问题，其中某些函数会覆盖内存的随机部分。我在尝试读取一些不可用的内存区域（通常是 0x0...00282）时遇到了一些内核错误，这对调试没有太大帮助。但是现在我遇到了一些可能有用的东西——文件缓存中发生了损坏，所以最终得到了一个像这样的好片段：

```
000bfc0: f0ef cf17 1888 ffff 8202 0000 0000 0000  ................
000bfd0: a0af 11a4 0a88 ffff a0af 11a4 0a88 ffff  ................
000bfe0: a0af 11a4 0a88 ffff 0094 aab3 0b88 ffff  ................
000bff0: 8202 0000 0000 0000 214e 1281 ffff ffff  ........!N...... 
```

因此，我的典型签名包含了两次（0x0282... 以相反的顺序）和一些看起来可能包含有效指针的数据。有什么好的方法可以尝试识别它指向的结构类型吗？或者至少是结构（分配）大小？我可以从中提取任何其他有用的信息吗？

我希望这个片段可以帮助我找出哪个模块/函数写入随机地址。

# cuda - CUDA 内核无法启动

> ID：12164235
> 
> 赞同：6
> 
> 时间：2012-08-28T17:12:33.263
> 
> 标签：cuda, gpgpu, gpu

我的问题很像[这个](https://stackoverflow.com/questions/9519272/cuda-kernel-not-launching)。我运行最简单的 CUDA 程序，但内核没有启动。但是，我确信我的 CUDA 安装没问题，因为我可以毫无问题地运行由多个文件（我从其他人那里获取）组成的复杂 CUDA 项目。在这些项目中，编译和链接是通过带有很多标志的 makefile 完成的。我认为问题在于编译时使用的正确标志。我只是使用这样的命令： `nvcc -arch=sm_20 -lcudart test.cu`使用这样的程序（在 linux 机器上运行）：

```
 __global__ void myKernel() 
{ 

    cuPrintf("Hello, world from the device!\n"); 

} 
int main() 
{ 
    cudaPrintfInit(); 
    myKernel<<<1,10>>>(); 
    cudaPrintfDisplay(stdout, true);    
    cudaPrintfEnd(); 
} 
```

程序编译正确。当我添加 cudaMemcpy() 操作时，它不会返回任何错误。关于内核为什么不启动的任何建议？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-29T02:02:56.723

使用时不打印的原因是`printf`内核启动是异步的，并且您的程序在 printf 缓冲区被刷新之前退出。CUDA (5.0) C Programming Guide 的 B.16 节解释了这一点。

> printf() 的输出缓冲区在内核启动之前设置为固定大小（请参阅关联的主机端 API）。它是循环的，如果在内核执行期间产生的输出多于缓冲区可以容纳的输出，则旧的输出将被覆盖。仅当执行以下操作之一时才会刷新：
> 
> *   通过 <<<>>> 或 cuLaunchKernel() 启动内核（在启动开始时，如果 CUDA_LAUNCH_BLOCKING 环境变量设置为 1，也在启动结束时），
> *   通过 cudaDeviceSynchronize()、cuCtxSynchronize()、cudaStreamSynchronize()、cuStreamSynchronize()、cudaEventSynchronize() 或 cuEventSynchronize() 进行同步，
> *   通过任何阻塞版本的 cudaMemcpy*() 或 cuMemcpy*() 进行内存复制，
> *   通过 cuModuleLoad() 或 cuModuleUnload() 加载/卸载模块，
> *   通过 cudaDeviceReset() 或 cuCtxDestroy() 销毁上下文。

出于这个原因，这个程序什么也不打印：

```
#include <stdio.h>

__global__ void myKernel() 
{ 
  printf("Hello, world from the device!\n"); 
} 

int main() 
{ 
  myKernel<<<1,10>>>(); 
} 
```

但是这个程序会打印十次“Hello, world from the device!\n”。

```
#include <stdio.h>

__global__ void myKernel() 
{ 
  printf("Hello, world from the device!\n"); 
} 

int main() 
{ 
  myKernel<<<1,10>>>(); 
  cudaDeviceSynchronize();
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T17:24:18.540

您确定您的 CUDA 设备支持 SM_20 架构吗？

从您的 nvcc 命令行中删除 arch= 选项并重建所有内容。这为 1.0 CUDA 架构编译，所有 CUDA 设备都支持该架构。如果它仍然没有运行，请进行构建清理并确保没有任何目标文件遗留在任何地方。然后重建并运行。

此外，arch= 指的是虚拟架构，应该类似于 compute_10。sm_20 是真正的架构，我相信应该与 code= 开关一起使用，而不是 arch=。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-26T06:56:33.070

**在 Visual Studio 中：**

> 右键单击您的项目 > 属性 > Cuda C/C++ > 设备

然后将以下内容添加到**代码生成**字段

```
compute_30,sm_30;compute_35,sm_35;compute_37,sm_37;compute_50,sm_50;compute_52,sm_52;compute_60,sm_60;compute_61,sm_61;compute_70,sm_70;compute_75,sm_75; 
```

为所有这些架构生成代码会使您的代码变慢一些。因此，一一消除以找到您的 GPU 需要哪些`compute`和`sm`生成代码。但是，如果您要将其运送给其他人，则最好将所有这些都包括在内。

# bash - 为什么我不能在 while 循环中进行评估？

> ID：12164238
> 
> 赞同：6
> 
> 时间：2012-08-28T17:12:42.040
> 
> 标签：bash, shell

我想在循环中从命令读取行的循环中创建 bash 别名。为了逐行读取输出，我相信我需要将输出通过管道传输到`read`. 但是，当我这样做时，别名不存在。

如果我在我的中包含以下内容`.bashrc`：

```
for x in a1 a2; do
    eval "alias $x='echo foo'"
done

echo -e "a3\na4" | while read x; do
    eval "alias $x='echo foo'"
done 
```

别名`a1`和`a2`存在，但`a3`又不`a4`存在。这两个循环有什么区别？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T17:15:12.447

管道中的 while 循环在子外壳中运行。你可以做：

```
while read x; do
    eval "alias $x='echo foo'"
done << EOF
a3
a4 
EOF 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T17:14:22.620

问题是管道。在表单的管道中`a | b | c`，每个单独的命令`a`、`b`和`c`都在单独的子shell [ [ref](http://www.gnu.org/software/bash/manual/bashref.html#Pipelines) ] 中运行，这意味着它接收到父执行环境的副本（包括别名），以及它对其自身所做的任何更改复制（例如通过运行`alias`）对父级 [ [ref](http://www.gnu.org/software/bash/manual/bashref.html#Command-Execution-Environment) ] 没有影响。

在您的情况下，您可以通过以下方式解决此问题：

```
while read x; do
    eval "alias $x='echo foo'"
done < <(echo -e "a3\na4") 
```

它仍将`echo -e "a3\na4"`在子 shell 中运行，但将`while`在正常/父执行环境中运行 -loop。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-28T17:28:20.707

In bash 4.2 and later, you can set the `lastpipe` option to keep the *last* command of a pipe from executing in a subshell. Job control must also be off (`set +m`) for this to work.

```
shopt -s lastpipe
set +m
echo -e "a3\na4" | while read x; do
    alias $x='echo foo'
done 
```

# php - 浏览器会缓存 PHP 生成的 CSS 和 Javascript 文件吗？

> ID：12164240
> 
> 赞同：1
> 
> 时间：2012-08-28T17:13:08.310
> 
> 标签：php, javascript, css, caching, browser

简单的问题。

浏览器是否会自动缓存 PHP 生成的 CSS 和脚本文件，就像 CSS/JS 文件一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:14:43.230

当然，除非有明确的行为来防止缓存。浏览器无法知道文件是静态资源还是动态生成的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:16:35.833

如果 URL 保持不变，并且 HTTP 响应中没有提示告诉浏览器否则，它们可以被缓存。

如果 URL 包含动态信息，浏览器可能无法利用缓存。

通过添加时间戳作为虚拟参数（例如`http://host/myfile.php?t=17279273`）来更改 URL 是防止缓存的方法之一，因为浏览器会将微小的更改视为新资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T19:12:48.307

Jonathon 的回答建议添加时间戳以防止缓存是一个很好的回答。

这些方面的一个有用提示是附加文件的创建/上次修改日期。这样做意味着浏览器会在未更改的情况下缓存文件，但是当您更新文件时，这些更改会强制发送给您的用户。

这并不总是最好的选择，但值得注意。

# javascript - 地理位置超时

> ID：12164250
> 
> 赞同：3
> 
> 时间：2012-08-28T17:13:55.587
> 
> 标签：javascript, html, geolocation

我正在开发一个将使用地理位置的网站。事实是，如果地理定位系统没有回答，我想设置一个超时......我正在使用 javascript 来获取位置。

在检查是否有地理定位系统后，

我使用了这个 javascript 函数：

```
geoloc.getCurrentPosition(successCallback, errorCallbak, {timeout: 5000}); 
```

我将超时设置为 5 秒。但它根本不起作用......我从来没有收到超时错误......

有人对此有想法吗？

谢谢

# delphi - 肥皂数组元素需要命名空间

> ID：12164252
> 
> 赞同：3
> 
> 时间：2012-08-28T17:13:57.797
> 
> 标签：delphi, soap, wsdl, delphi-7

Delphi 7 客户端不包括数组元素上的命名空间。不包含命名空间时，Web 服务无法反序列化数组。

使用带有 SOAP/WSDL 更新 24535 的 Delphi 7。

我可以通过访问数组元素来做到这一点吗？

# task - 任务和盒子 API

> ID：12164254
> 
> 赞同：1
> 
> 时间：2012-08-28T17:14:06.147
> 
> 标签：task, box-api

有谁知道是否有计划向 api 添加任务？喜欢添加或完成任务的能力？将任务附加到文档？

谢谢和欢呼，

乍得

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:32:10.063

是的，有计划向 V2 API 添加任务。将 V2 API 升级为 GA 状态不是我们的候选清单的一部分，但可能很快就会出现。

如果您愿意与我们分享任务的特定用途，您可以通过 Box dot com 的 api 电子邮件让我们了解更多详细信息。

# jquery - 无法在浏览器中手动访问 ASMX Web 服务，但可以使用 jQuery

> ID：12164259
> 
> 赞同：2
> 
> 时间：2012-08-28T17:14:46.150
> 
> 标签：jquery, asp.net, web-services, asmx

我是 JQuery 和 Web 服务的新手。我的问题是（在下面的代码中），为什么**url: "WebService1.asmx/WebMethod"**通过这个 JQuery 代码工作，但是如果我直接在浏览器中键入那个 URL，它说找不到路径？我必须手动单击浏览器中服务的“调用”按钮才能调用该方法，然后导航到 WebService1.asmx/WebMethod。

```
 $(document).ready(function () {
        $.ajax({
            type: "POST",
            contentType: "application/json; charset=utf-8",
            url: "WebService1.asmx/WebMethod",
            data: "{}",
            dataType: "json",
            success: function (msg) {
                alert(msg.d);
            },
            error: function (errormessage) {
                alert("got an error");
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:21:45.677

在`ajax`调用的情况下，您正在调用 url 作为`POST`请求。而直接在浏览器中访问 url 时，您正在调用 url 作为`GET`请求。您的服务可能会接受带有空 json 数组的 POST 请求作为参数，该参数在作为 GET 请求调用时会丢失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:22:30.290

发布和获取！该服务正在侦听不同的 HTTP 动词并做出相应的响应。

按下 Invoke 会向服务发送 POST 消息，而在栏中键入它会向服务发送 GET 消息。

使用 : type: "GET" 更改查询，您会看到。

# ruby-on-rails-3 - Capybara 在页面上找不到链接

> ID：12164261
> 
> 赞同：4
> 
> 时间：2012-08-28T17:14:51.663
> 
> 标签：ruby-on-rails-3, capybara, rspec2

我正在尝试进行我的第一次水豚测试。我遵循 Ryan Bate 的理念并将一些功能测试放入我的控制器规范文件中。

```
describe UsersController do
  render_views

  it "can get the home page" do
    get 'home'
    response.body.should include("Login")
  end

  it "should log in" do
    get 'home'
    puts response.body
    click_link('Login')
    response.body.should include("Email")
    response.body.should include("Password")
  end

end 
```

在它应该登录时我遇到了问题，所以开始尝试确保我可以找到并单击链接。没运气。在上面的测试中，我只是想确保链接存在

产生以下`puts response.body`输出

```
...
  <div id="user_nav">
      <a href="/users/sign_up">Register</a> or <a href="/users/sign_in" id="Login">Login</a>
  </div>
... 
```

而且我还在实际页面上看到了该元素。似乎只有我的测试找不到它。第一个测试确实通过了。

```
 1) UsersController should log in
     Failure/Error: click_link('Login')
     Capybara::ElementNotFound:
       no link with title, id or text 'Login' found
     # (eval):2:in `click_link'
     # ./spec/controllers/users_controller_spec.rb:14:in `block (2 levels) in <top (required)>' 
```

我正在使用 Rails 3.2、Rpsec 2.11 和 Capybara 1.1.2。

（我已经检查了有关 stackoverflow 的其他问题以及一些教程和截屏视频。我看不出它找不到给定 id 标签的元素的任何原因，但我可能遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-29T02:00:08.380

我认为它不起作用的原因是您正在使用`get`本质上是集成测试的东西。看到这篇文章：[http ://blog.plataformatec.com.br/2012/06/improving-the-integration-between-capybara-and-rspec/](http://blog.plataformatec.com.br/2012/06/improving-the-integration-between-capybara-and-rspec/)

如果我的理解是正确的，你需要使用`visit`才能`click_link`在页面上使用：

```
it "should log in" do
  visit home_path
  click_link('Login')
  page.should ...
end 
```

另请参阅关于 SO 的答案：[Rspec and capybara, difference between visit and get methods, about the current_path object](https://stackoverflow.com/questions/11090038/rspec-and-capybara-difference-between-visit-and-get-methods-with-regards-to-th)

# c - c 带套接字的可移植代码

> ID：12164262
> 
> 赞同：0
> 
> 时间：2012-08-28T17:14:54.793
> 
> 标签：c, portability

这是我的程序的一部分：

```
 while((total_bytes_read != fsize) && ((nread = read(f_sockd, filebuffer, fsize_tmp)) > 0)){
    if(write(fd, filebuffer, nread) != nread){
      perror("write RETR");
      onexit(f_sockd, 0, 0, 1);
    }
    total_bytes_read += nread;
    fsize_tmp -= nread;
  } 
```

哪里`total_bytes_read, fsize, nread`被声明为`uint32_t`.
在 64 位机器上没有问题，它编译和运行得很好（这部分代码必须接收文件）。
问题是当我在 32 位机器上编译时，因为我收到了这个错误：
`warning: comparison of integers of different signs: 'ssize_t' (aka 'int') and 'uint32_t' (aka 'unsigned int') [-Wsign-compare] if(write(fd, filebuffer, nread) != nread){`
我不知道如何解决这个问题，因为如果我更改`if(write(fd, filebuffer, nread) != nread){` **为** `if(nread != (uint32_t)write(fd, filebuffer, nread)){`程序**不再接收文件**但它打印*（部分）*文件内容到标准输出。
为什么我会出现这种奇怪的行为，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:18:10.463

只需使用正确的类型。[标准](http://pubs.opengroup.org/onlinepubs/9699919799/functions/read.html)说：

```
ssize_t read(int fildes, void *buf, size_t nbyte);
^^^^^^^                             ^^^^^^ 
```

所以这就是你应该使用的。不是`int`，不是`uint64_t`，不是`unsigned long long`等等。

# jquery - jQuery在div中自动垂直滚动

> ID：12164263
> 
> 赞同：4
> 
> 时间：2012-08-28T17:14:55.400
> 
> 标签：jquery, autoscroll

谁能推荐一个简单的 jQuery 垂直自动滚动脚本？一个不臃肿的，我只需要它自动启动并`li`在 div 中滚动 6 个或更多。我尝试了**jquery.autoscroll.js**但无法让它自动启动。

```
$.fn.autoscroll.defaults = { 
   start: { 
      step: 50, 
      scroll: true, 
      direction: "down", 
      pauseOnHover: true 
   }, 
   delay: 5000, 
   ffrw: { 
      speed: "fast", 
      step: 100 
   } 
}; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-28T17:18:12.993

```
var div = $('div.autoscrolling');
var scroller = setInterval(function(){
    var pos = div.scrollTop();
    div.scrollTop(++pos);
}, 100)​ 
```

[工作演示](http://jsfiddle.net/mrobin/52jzM/1/)。

**编辑：**

要在 div 滚动到底部时停止滚动，请在上面的末尾添加以下检查`function() {}`-

```
if($(this).scrollTop() + $(this).innerHeight() >= this.scrollHeight)
   clearInterval(scroller);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T10:26:19.563

simpleScroll 是一个很酷的插件[http://logicbox.net/jquery/simplyscroll/](http://logicbox.net/jquery/simplyscroll/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-07T17:27:17.150

出于多种原因，罗宾的回答对我来说并没有完全奏效，所以这里是他的方法的修改和扩展版本：

```
var div = $('.scrollbit');

$('.scrollbit').bind('scroll mousedown wheel DOMMouseScroll mousewheel keyup', function(evt) {
    if (evt.type === 'DOMMouseScroll' || evt.type === 'keyup' || evt.type === 'mousewheel') {

    }
    if (evt.originalEvent.detail < 0 || (evt.originalEvent.wheelDelta && evt.originalEvent.wheelDelta > 0)) { 
        clearInterval(scrollbit);
    }
    if (evt.originalEvent.detail > 0 || (evt.originalEvent.wheelDelta && evt.originalEvent.wheelDelta < 0)) { 
        clearInterval(scrollbit);
    }
});

var scrollbit = setInterval(function(){
    var pos = div.scrollTop();
    if ((div.scrollTop() + div.innerHeight()) >= div[0].scrollHeight) {
        clearInterval(scrollbit);
    }
    div.scrollTop(pos + 1);
}, 100); 
```

在匿名用户 1248475 的帮助下：

[检测用户是否创建了滚动事件](https://stackoverflow.com/questions/7035896/detect-whether-scroll-event-was-created-by-user/)

这个答案：

[https://stackoverflow.com/a/9392134](https://stackoverflow.com/a/9392134)

希望这对任何希望解决如何使用 jquery 自动滚动 div 并在用户手动滚动时停止问题的人有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-30T16:41:25.607

github 上的 autoscroll.js 下载有错误的文件。如果你在那里搜索，你可以找到它们。

我在下面的链接中做了一个工作演示，如果你喜欢，你可以从中复制。

[github 上的 autoscroll.js](https://github.com/wilkerlucio/jquery-autoscroll/tree/master/examples/images)

[我的工作自动滚动演示](http://nbson.com/autoscroll/)

# facebook-graph-api - 澄清 Facebook 关键字搜索中允许的查询

> ID：12164268
> 
> 赞同：1
> 
> 时间：2012-08-28T17:15:34.727
> 
> 标签：facebook-graph-api, search, keyword

我试图找到这方面的文档，但仍然一无所获。我发现 facebook graph api 允许 OR 搜索但使用 | 符号，即使这样，结果也不是 100% 准确的。我看到它只需要一组术语并将它们和在一起，括号和引号无关紧要。无论如何在facebook graph api中使用NOT或NEGATE搜索？在 facebook graph api 中可以使用哪些其他搜索（布尔值）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-17T21:11:20.590

不支持否定，这个来源说：[http ://civic.mit.edu/blog/mstem/graph-search-rejiggers-your-personal-info](http://civic.mit.edu/blog/mstem/graph-search-rejiggers-your-personal-info)

# solr - 仅返回顶部方面结果

> ID：12164272
> 
> 赞同：1
> 
> 时间：2012-08-28T17:15:50.403
> 
> 标签：solr

在分面搜索中，可能会返回许多方面：

```
<lst name="provider_id">
    <int name="18"> 39843 </int>
    <int name="1"> 18398 </int>
    <int name="5"> 6949 </int>
    <int name="6"> 5274 </int>
    <int name="16"> 2717 </int>
    <int name="4"> 2333 </int>
    <int name="11"> 2107 </int>
    <int name="13"> 2095 </int>
    <int name="17"> 433 </int>
    <int name="12"> 408 </int>
    <int name="9"> 50 </int>
    <int name="14"> 0 </int>
    <int name="2"> 0 </int>
</lst> 
```

我如何将输出限制在前 3 个方面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:52:40.327

使用`&facet.limit=3`（或您想使用的任何其他数字）。

顺便说一下，这个参数的默认值是100；如果要返回无限数量的构面结果，请使用负数。

这是 Solr 中包含的 Simple Faceting 工具包可以使用的完整参数列表： [http ://wiki.apache.org/solr/SimpleFacetParameters](http://wiki.apache.org/solr/SimpleFacetParameters)

# r - 输入文件的对数值

> ID：12164273
> 
> 赞同：-1
> 
> 时间：2012-08-28T17:15:52.763
> 
> 标签：r

我们如何绘制包含浮点类型数字的输入文件的对数值。例如，考虑我的文件是这种格式：

```
0.000012
0.000234
1.078229
3.246678 
```

我想为上述值的对数值绘制直方图，即下面给出的值：

```
log(0.000012)
log(0.000234)
log(1.078229)
log(3.246678) 
```

我如何使用 R 统计包做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:19:52.710

这是你要找的吗？：

```
dat <- c(0.000012, 0.000234, 1.078229, 3.246678)
hist(log(dat)) 
```

# java - 多线程中令人困惑的输出显示死锁？

> ID：12164274
> 
> 赞同：2
> 
> 时间：2012-08-28T17:16:09.807
> 
> 标签：java, multithreading

我刚刚编译并运行了这个java程序，但输出令人不快。我不知道为什么线程处于死锁状态。谁能帮我理解程序的输出。

```
class A {
synchronized void foo(B b) {
    String name=Thread.currentThread().getName();
    System.out.println(name+"entered A.foo");

    try {
        Thread.sleep(1000);
    } catch(Exception e) {}
    System.out.println(name+"trying to call B.last()");
    b.last();
}
synchronized void last() {
    System.out.println("inside A.last");
}
}

class B {
synchronized void bar(A a) {
    String name=Thread.currentThread().getName();
    System.out.println(name+"entered B.bar");
    try {
        Thread.sleep(1000);
    } catch(Exception e) {
        System.out.println("b interrupted");
    }
    System.out.println(name+"trying to call A.last()");
    a.last();
}
synchronized void last() {
    System.out.println("inside A.last");
}
}

class DeadLock implements Runnable {
A a=new A();
B b=new B();
DeadLock() {
    Thread.currentThread().setName("mainthread");
    Thread t=new Thread(this,"racingthread");
    t.start();
    a.foo(b);
    System.out.println("back in main thread");
}
public void run() {
    b.bar(a);
    System.out.println("back in other theread");
}
public static void main(String...d) {
    new DeadLock();
}
} 
```

**我电脑上的输出是**

```
mainthreadentered A.foo

racingthreadentered B.bar

mainthreadtrying to call B.last()

racingthreadtrying to call A.last() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T17:23:26.577

你有一个经典的僵局。

*   `A.foo()`尝试锁定的锁`a`和调用`b.last()``b`
*   `B.bar()`尝试锁定的锁`b1`和调用`a.last()``a`

两者都不能继续，因为每个人都需要对方的锁。

> 我不知道为什么线程处于死锁状态。

因为这就是你的程序设计的目的。

* * *

鉴于您不需要任何锁，最简单的解决方案是删除所有`synchronized`关键字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:37:30.690

There is no solution for Deadlock. Programmer has to take care and code in such a way that deadlock should not occur.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:20:31.150

由于对象 b 一直被锁定`bar()`，因此当您调用每个函数时，都`a`在等待另一个释放锁定。这导致了僵局`foo()``last()`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T17:20:51.930

看起来像家庭作业。但我想说的答案是你在 deadlock() 的构造函数中设置了另一个线程。

两个线程都将竞争并且可能被锁定在同步方法之一上，因为您正在使用计时器使它们对齐。是我的猜测没有运行它。

类名也应该是大写的。

# ruby-on-rails-3 - ActiveRecord::Relation.last 不一致的结果

> ID：12164279
> 
> 赞同：0
> 
> 时间：2012-08-28T17:16:46.967
> 
> 标签：ruby-on-rails-3, activerecord

我有一个订阅应用程序，其中包含用户、订单和 DeliverySchedules（以及其他使 has_many :through 成为必需而不是 has_many 的模型）。

```
class User < ActiveRecord::Base
    has_many :orders
    has_many :deliveryschedules, :through => :orders

class Deliveryschedule < ActiveRecord::Base
    has_many :orders
    has_many :users, :through => :orders

class Order < ActiveRecord::Base
    belongs_to :user
    belongs_to :deliveryschedule 
```

我的问题是，为什么

```
@allusers.each do |t|
    User.find_by_id(t.id).deliveryschedules.last.delivery_date
end 
```

返回不同的东西

```
@allusers.each do |t|
    t.deliveryschedules.last.delivery_date
end 
```

我的应用程序正在运行，但我觉得我在这里遗漏了一些基本的东西，我无法在文档中找到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:23:38.857

这是正常的数据库行为。从数据库返回的记录顺序是不确定的，除非您专门使用`ORDER BY`. 因此，两个不同的查询可能会以不同的顺序返回行。

# python - Pythons random.randint 在统计上是随机的吗？

> ID：12164280
> 
> 赞同：6
> 
> 时间：2012-08-28T17:16:47.907
> 
> 标签：python, random, statistics, probability

所以我正在测试计算某些掷骰子的概率，以进行游戏。如果滚动一个 10 面模具，则为基本情况。

我做了一百万个样本，最终得到以下比例：

```
Result
0       0.000000000000000%
1       10.038789961210000%
2       10.043589956410000%
3       9.994890005110000%
4       10.025289974710000%
5       9.948090051909950%
6       9.965590034409970%
7       9.990190009809990%
8       9.985490014509990%
9       9.980390019609980%
10      10.027589972410000% 
```

当然，这些都应该是 10%。这些结果的标准偏差为 0.0323207%。在我看来，这似乎相当高。这只是巧合吗？据我了解，随机模块访问正确的伪随机数。即通过统计测试的方法是随机的。或者是这些伪伪随机数生成器

我应该使用加密伪随机数生成器吗？我相当确定我不需要*真正*的随机数生成器（参见[http://www.random.org/](http://www.random.org/)、[http://en.wikipedia.org/wiki/Hardware_random_number_generator](http://en.wikipedia.org/wiki/Hardware_random_number_generator)）。

我目前正在用 10 亿个样本重新生成所有结果，（因为为什么不呢，我有一个松脆的服务器可供我使用，还有一些睡眠要做）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-28T17:18:01.383

从[`random`模块文档](http://docs.python.org/library/random.html)：

> 几乎所有的模块函数都依赖于基本函数random()，它在半开范围[0.0, 1.0)内均匀地生成一个随机浮点数。Python 使用 Mersenne Twister 作为核心生成器。它产生 53 位精度浮点数，周期为 2**19937-1。C 中的底层实现既快速又线程安全。Mersenne Twister 是现有测试最广泛的随机数生成器之一。但是，由于是完全确定性的，它并不适合所有用途，并且完全不适合加密用途。

来自[关于 Mersenne Twister 的维基百科文章](https://en.wikipedia.org/wiki/Mersenne_twister)：

> 它提供了快速生成非常高质量的伪随机数，专门设计用于纠正旧算法中发现的许多缺陷。

如果您有一个特定于操作系统的随机源，可通过 获得[`os.urandom()`](http://docs.python.org/library/os.html#os.urandom)，那么您可以改用[`random.SystemRandom()`](http://docs.python.org/library/random.html#random.SystemRandom)该类。大多数`random`模块函数都可用作该类的方法。它可能更适合加密目的，再次引用文档：

> 返回的数据对于加密应用程序来说应该是不可预测的，尽管它的确切质量取决于操作系统的实现。

Python 3.6 添加了一个带有便捷方法的[`secrets`模块](https://docs.python.org/3.6/library/secrets.html)来生成适用于加密目的的随机数据：

> 该`secrets`模块用于生成适用于管理密码、帐户身份验证、安全令牌和相关机密等数据的加密强随机数。
> 
> 特别是，`secrets`应该优先使用`random`模块中的默认伪随机数生成器，该生成器是为建模和模拟而设计的，而不是安全或密码学。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T18:55:38.723

我用十亿次迭代重新运行了 OP 的练习：

```
from collections import Counter
import random
n = 1000000000
c = Counter(random.randint(1, 10) for _ in xrange(n))
for i in range(1,11):
    print '%2s  %02.10f%%' % (i, c[i] * 100.0 / n) 
```

这是（重新格式化的）结果：

```
 1     9.9996500000%
 2    10.0011089000%
 3    10.0008568000%
 4    10.0007495000%
 5     9.9999089000%
 6     9.9985344000%
 7     9.9994913000%
 8     9.9997877000%
 9    10.0010818000%
10     9.9988307000% 
```

请参阅此问题的其他答案以获得出色的分析。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-28T18:00:41.677

Martijn 的回答非常简洁地回顾了 Python 可以访问的随机数生成器。

如果您想查看生成的伪随机数据的属性，请`random.zip`从[http://www.fourmilab.ch/random/](http://www.fourmilab.ch/random/)下载，然后在大量随机数据样本上运行它。特别是 χ²（卡方）检验对随机性非常敏感。对于真正随机的序列，来自 χ² 检验的百分比应该在 10% 到 90% 之间。

对于一个游戏，我猜 Python 内部使用的 Mersenne Twister 应该是足够随机的（除非你正在建立一个在线赌场:-)。

如果您想要*纯*随机性，并且您使用的是 Linux，则可以从`/dev/random`. 这只会从内核的熵池（从中断到达的不可预测的时间收集）中产生随机数据，因此如果您用尽它，它将阻塞。此熵用于初始化（种子）由`/dev/urandom`. 在 FreeBSD 上，提供数据的 PRNG`/dev/random`使用 Yarrow 算法，该算法通常被认为是加密安全的。

**编辑：**我对来自`random.randint`. 首先创建一百万个随机字节：

```
import random
ba = bytearray([random.randint(0,255) for n in xrange(1000000)])
with open('randint.dat', 'w+') as f:
    f.write(ba) 
```

然后我运行[Fourmilab](http://www.fourmilab.ch/random/)`ent`的程序：

```
Entropy = 7.999840 bits per byte.

Optimum compression would reduce the size
of this 1000000 byte file by 0 percent.

Chi square distribution for 1000000 samples is 221.87, and randomly
would exceed this value 93.40 percent of the times.

Arithmetic mean value of data bytes is 127.5136 (127.5 = random).
Monte Carlo value for Pi is 3.139644559 (error 0.06 percent).
Serial correlation coefficient is -0.000931 (totally uncorrelated = 0.0). 
```

现在对于 χ² 检验，距离 50% 越远，数据越可疑。如果一个非常挑剔，值 <10% 或 >90% 被认为是不可接受的。约翰沃克，作者`ent`称这个值“几乎是可疑的”。

作为对比，这里是我之前运行的来自 FreeBSD 的 Yarrow prng 的 10 MiB 的相同分析：

```
Entropy = 7.999982 bits per byte.

Optimum compression would reduce the size
of this 10485760 byte file by 0 percent.

Chi square distribution for 10485760 samples is 259.03, and randomly
would exceed this value 41.80 percent of the times.

Arithmetic mean value of data bytes is 127.5116 (127.5 = random).
Monte Carlo value for Pi is 3.139877754 (error 0.05 percent).
Serial correlation coefficient is -0.000296 (totally uncorrelated = 0.0). 
```

虽然其他数据似乎没有太大差异，但 χ² 百分比*更*接近 50%。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-28T17:18:37.493

是的，出于所有实际目的，它在统计上是随机的。您看到的随机变化是完全正常的。事实上，如果它没有这样的变化，那将是一个糟糕的 rng。

由于 prng 的周期是 2**19937-1，因此在看到非随机分布之前，您需要生成比宇宙中的原子更多的数字。请注意，如果您生成 623 维向量，它会很快变得非随机。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T18:14:48.140

在良好的 PRNG 中随机数出现不完美分布确实是正常的。但是，您生成的数字越多，您看到的数字就越少。

顺便说一句，我得到的标准偏差为 0.03066，略低于您给出的值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-13T11:05:12.233

这些结果非常接近您的预期，您可以通过简单的计算来检查这一点。如果您掷出 1,000,000 个 D10 并计算 1 的数量（例如），该随机变量的平均值为 100,000（试验次数 * 成功概率），方差为 90,000（试验次数 * 成功概率 * 失败概率），所以标准差是 sqrt(90,000)=300。因此，您应该期望从 100,000 得到大约 300，即 10% +/- 0.03%。

# javascript - 更改日期选择器上的日期格式

> ID：12164281
> 
> 赞同：0
> 
> 时间：2012-08-28T17:16:54.337
> 
> 标签：javascript, jquery, jquery-ui

您好我使用此代码显示基于选择的到期日期。

```
<script>    
$(function(){                  
    $("#date_picker").datepicker();
    $("#Plano_Id").change(function() {
        var offset = +$(this).find("option:selected").attr("title"), /* get days to add on date*/
        theDate = new Date();
        theDate.setDate(theDate.getDate() + offset);         
        $("#date_picker").datepicker("setDate", theDate);
    });    
});        
</script> 
```

但这会以这种格式返回日期`mm/dd/yyyy`。我试图展示`dd/mm/yyyy`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:20:26.673

用于设置特定日期控件的格式

```
$('#datepicker').datepicker({ dateFormat: 'dd/mm/yyyy' }); 
```

要在整个站点/页面中设置它，请使用

```
$.datepicker.setDefaults({ dateFormat: 'dd/mm/yyyy' });
//Note:Call this before initializing any date pickers 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:19:43.740

使用 dateFormat 选项：http: [//jqueryui.com/demos/datepicker/#date-formats](http://jqueryui.com/demos/datepicker/#date-formats)

# google-app-engine - GAE TimeEntry 应用日期序列化异常

> ID：12164286
> 
> 赞同：1
> 
> 时间：2012-08-28T17:17:22.107
> 
> 标签：google-app-engine

我正在尝试 Google 应用引擎示例应用程序[TimeEntry](http://code.google.com/p/gae-timecard/source/browse/?r=7#svn/TimeEntry%253Fstate%253Dclosed)。当我尝试运行它时，它会显示我最后添加的异常。我已经查看并尝试了其他线程和论坛中提供的解决方案，但我仍然无法修复它。我在 Eclipse、app engine sdk 1.7.0 和 gwt 2.4.0 上运行它。您的帮助将非常明显..谢谢！这是输出错误消息

```
Aug 28, 2012 6:39:51 PM com.google.appengine.tools.development.ApiProxyLocalImpl log
SEVERE: javax.servlet.ServletContext log: Exception while dispatching incoming RPC call
com.google.gwt.user.client.rpc.SerializationException: Type 'org.datanucleus.store.types.sco.simple.Date' was not included in the set of types which can be serialized by this SerializationPolicy or its Class object could not be loaded. For security purposes, this type will not be serialized.: instance = Tue Aug 07 22:00:00 UTC 2012
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serialize(ServerSerializationStreamWriter.java:619)
    at com.google.gwt.user.client.rpc.impl.AbstractSerializationStreamWriter.writeObject(AbstractSerializationStreamWriter.java:126)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter$ValueWriter$8.write(ServerSerializationStreamWriter.java:153)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serializeValue(ServerSerializationStreamWriter.java:539)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serializeClass(ServerSerializationStreamWriter.java:709)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serializeImpl(ServerSerializationStreamWriter.java:748)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serialize(ServerSerializationStreamWriter.java:621)
    at com.google.gwt.user.client.rpc.impl.AbstractSerializationStreamWriter.writeObject(AbstractSerializationStreamWriter.java:126)
    at com.google.gwt.user.client.rpc.core.java.util.Collection_CustomFieldSerializerBase.serialize(Collection_CustomFieldSerializerBase.java:44)
    at com.google.gwt.user.client.rpc.core.java.util.Vector_CustomFieldSerializer.serialize(Vector_CustomFieldSerializer.java:39)
    at com.google.gwt.user.client.rpc.core.java.util.Vector_CustomFieldSerializer.serializeInstance(Vector_CustomFieldSerializer.java:51)
    at com.google.gwt.user.client.rpc.core.java.util.Vector_CustomFieldSerializer.serializeInstance(Vector_CustomFieldSerializer.java:28)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serializeImpl(ServerSerializationStreamWriter.java:740)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serialize(ServerSerializationStreamWriter.java:621)
    at com.google.gwt.user.client.rpc.impl.AbstractSerializationStreamWriter.writeObject(AbstractSerializationStreamWriter.java:126)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter$ValueWriter$8.write(ServerSerializationStreamWriter.java:153)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serializeValue(ServerSerializationStreamWriter.java:539)
    at com.google.gwt.user.server.rpc.RPC.encodeResponse(RPC.java:616)
    at com.google.gwt.user.server.rpc.RPC.encodeResponseForSuccess(RPC.java:474)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:571)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
    at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:35)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:60)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:370)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T07:52:15.100

尝试通过以下方式运行您的日期移动到客户端运行：

```
**import java.util.Date;**

public class ConvertDate {
    public static Date g(Date date) {
        if (date != null) {
            long timeStamp = date.getTime();
            return new Date(timeStamp);
        }
        return null;
    }
} 
```

# ruby-on-rails - Ruby csv导入麻烦

> ID：12164287
> 
> 赞同：1
> 
> 时间：2012-08-28T17:17:23.337
> 
> 标签：ruby-on-rails, ruby, csv, fastercsv

我试图在我的 rails 应用程序中从 csv 导入数据，但出了点问题：

```
CSV::MalformedCSVError in ArticlesController#index
Unclosed quoted field on line 1. 
```

我的 csv 看起来像这样：

```
"Код";"№ по каталогу  (артикул)";"Наименование  товара";"Ед. изм.";"Цена опт.";"Доп.";"Остатки";"Класс";"Группа";"Бренд";"Блок."
2223;15-562-44;15-562-44 (27-B07-F) VW Polo 95-R                                                                   ;шт  ;37,430;;;Амортизаторы                                                                                        ;Амортизаторы BOGE                                                                                   ;; 
10327;24-052-1;24-052-1(46-A27-0) LAND ROVER 84- F                                                                 ;шт  ;68,750;;;Амортизаторы                                                                                        ;Амортизаторы BOGE                                                                                   ;; 
10328;24-053-1;24-053-1(46-A28-0) LAND ROVER 84- R                                                                 ;шт  ;68,750;;;Амортизаторы                                                                                        ;Амортизаторы BOGE                                                                                   ;; 
```

也许这是因为第一行（没有;;）

我的代码如下所示：

```
def csv_import 
    require 'csv'
    file = File.open("/#{Rails.public_path}/uploads/smallcsv.csv")
    #csv = CSV.parse(file)

    csv = CSV.open(file, "r:ISO-8859-15:UTF-8", {:col_sep => ";", :row_sep => ";;", :headers => :first_row})
    file_path = "/#{Rails.public_path}/uploads/smallcsv.csv"
    #@parsed_file=CSV::Reader.parse(file_path)

    csv.each do |row| 
      ename = row[2]
      eprice = row[5]
      eqnt = row[7]
      esupp = row[10]

      logger.warn(ename)
    end

  end 
```

我正在使用 fastcsv gem 运行 ruby​​ 1.9+

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:43:24.487

[我自己使用“ CSV - Unquoted fields do not allow \r or \n (line 2)](https://stackoverflow.com/questions/11548637/csv-unquoted-fields-do-not-allow-r-or-n-line-2) ”想出了这一点。

问题出在第一行，所以`:auto`帮助了我。

# apache - CodeIgniter 解析错误显示但未写入日志

> ID：12164289
> 
> 赞同：0
> 
> 时间：2012-08-28T17:17:26.300
> 
> 标签：apache, codeigniter, logging, error-handling, codeigniter-2

我正在尝试为我的 CodeIgniter 应用程序构建错误处理服务，并且除解析错误外，所有内容都按预期记录。例如，

`Parse error: syntax error, unexpected T_VARIABLE in /var/www/foo/web/app/controllers/foo.php`

... 将在 E_ALL 下输出*并由 Apache记录。*所有其他（非解析）错误都会传递给`log_exception`我编写的扩展`/core/MY_Exceptions.php`，并使用 PHP 5.2.17 和 5.3.6 (MAMP) 显示在 CI 的日志中。解析错误将显示在 Apache 的本地错误日志中，但不会显示在 CodeIgniter 的日志中——它们似乎完全错过了 CodeIgniter。

如何确保解析错误被 CI 拾取？我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:22:36.387

**这可能会对您有所帮助：[为什么 codeigniter 没有记录错误！](https://stackoverflow.com/questions/3277751/why-is-codeigniter-not-logging-error)**

> 如果页面由于解析错误而无法加载，那么它将永远不会执行
> 
> ```
> error_reporting(E_ALL); 
> ```
> 
> 所以你的脚本永远不会知道输出错误。编辑您的 php.ini 文件以确保您有：
> 
> ```
> error_reporting = E_ALL
> error_log = "/path/to/some/apache/writable/file" 
> ```

希望这可以帮助。

# c# - 使用语句变体

> ID：12164290
> 
> 赞同：0
> 
> 时间：2012-08-28T17:17:28.233
> 
> 标签：c#, ado.net, using

我发现我的代码库包含各种数据访问代码，我以两种不同的方式使用 using 语句。如果有的话，哪种方法更好，这两种方法是否不同？没有在 using 语句中实例化 SqlConnection 和 SqlCommand 可能会出现什么问题？忽略明显的不一致问题。

方法一：

```
public int SampleScalar(string query, CommandType queryType, SqlParameter[] parameters)
    {
        int returnValue = 0;
        SqlConnection objConn = new SqlConnection(ConnString);
        SqlCommand objCmd = new SqlCommand(query, objConn);
        objCmd.CommandType = queryType;

        if (parameters.Length > 0)
            objCmd.Parameters.AddRange(parameters);

        using (objConn)
        {
            using (objCmd)
            {
                objConn.Open();
                try
                {
                    returnValue = (int)objCmd.ExecuteScalar();
                }
                catch (SqlException e)
                {
                    Errors.handleSqlException(e, objCmd);
                    throw;
                }
            }
        }
        return returnValue;
    } 
```

方法二：

```
public int SampleScalar2(string query, CommandType queryType, SqlParameter[] parameters)
    {
        int returnValue = 0;
        using (SqlConnection objConn = new SqlConnection(ConnString))
        {
            using (SqlCommand objCmd = new SqlCommand(query, objConn))
            {
                objConn.Open();
                objCmd.CommandType = queryType;

                if (parameters.Length > 0)
                    objCmd.Parameters.AddRange(parameters);
                try
                {
                    returnValue = (int)objCmd.ExecuteScalar();
                }
                catch (SqlException e)
                {
                    Errors.handleSqlException(e, objCmd);
                    throw;
                }
            }
        }
        return returnValue;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T17:20:28.770

在第一个片段中，如果在创建对象之后和开始使用之前发生任何异常，`IDisposable`则不会正确处理它。使用第二个实现，没有可能导致未释放资源的这种差距。

第一种方法可能出现的另一个问题是，您可以在处理对象后使用它，这不太可能结束。

您可能会确保不会发生异常，也许您不会。一般来说，我永远不会使用第一种方法，因为我不相信自己（或其他任何人）永远不会在那个不受保护的空间里犯错。如果不出意外，我将需要花费时间和精力*仔细*查看，以*确保*不会出错。使用这种不太安全的方法也不会真正获得任何好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:19:29.700

我总是选择第二种方法。更容易阅读和理解在给定块的末尾处理了哪些对象。它还会阻止您使用已处置的对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T17:19:48.140

如果您不使用 using，则不要处置您的对象，不托管，GC 不处置

GC dispose 只管理对象，不管理 sql 连接，所以你必须 dispose，最后使用 use dispose

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T17:21:21.007

根据[MSDN](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)

> 您可以实例化资源对象，然后将变量传递给 using 语句，但这不是最佳实践。在这种情况下，对象在控制离开 using 块后仍保留在范围内，即使它可能不再有权访问其非托管资源。换句话说，它将不再被完全初始化。如果您尝试在 using 块之外使用该对象，则可能会引发异常。出于这个原因，通常最好在 using 语句中实例化对象并将其范围限制在 using 块中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T17:23:14.100

第二个更好。请阅读[http://msdn.microsoft.com/en-us/library/yh598w02.aspx](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)最后一句话。

在第一个对象被处理后，它仍然在范围内。然后使用它不是一个好习惯。

# c# - 有没有办法可以延迟加载手风琴窗格的数据源？

> ID：12164292
> 
> 赞同：1
> 
> 时间：2012-08-28T17:17:31.500
> 
> 标签：c#, asp.net, ajaxcontroltoolkit

我正在尝试延迟加载手风琴窗格的内容数据源。所以换句话说，当窗格打开时，它将绑定数据源。我找不到可以用来触发`if (source == null) LoadMe();`逻辑的事件。

我知道至少有一百个人以前这样做过。任何想法都会有所帮助。TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:53:48.283

好的，我让它工作了。我对此并不完全满意，但这就是我得到的：

每个标题都有一个链接按钮，我调整其大小以填充整个区域，基本上使该区域可点击：

```
<ajaxToolkit:AccordionPane ID="acpInReview" runat="server">
    <Header>
        <asp:LinkButton runat="server" Width="100%" Height="25" CssClass="SectionLinkButtons" CommandName="LoadInReview">In Review</asp:LinkButton>
    </Header> 
```

如您所见，它有一个关联的命令。在父手风琴中，我设置了在模板中检测到命令时触发的事件处理程序：

```
<ajaxToolkit:Accordion runat="server" ID="accMainNav" HeaderCssClass="AccordionSection"
                       CssClass="AccordionMainNav" ContentCssClass="AccordionContent"
                       RequireOpenedPane="False" SelectedIndex="-1"
                       OnItemCommand="accMainNav_OnItemCommand" ClientIDMode="Static">
    <Panes>
        ... 
```

然后在后面的代码中，处理程序读取命令并执行以下操作：

```
protected void accMainNav_OnItemCommand(object sender, CommandEventArgs e)
{
    switch(e.CommandName)
    {
        case "LoadAwaitingControllerApproval":
            LoadAwaitingControllerApproval();
            break;
        case "LoadInReview":
            LoadInReview();
            break;
        case "LoadAwaitingFinalization":
            LoadAwaitingFinalization();
            break;
    }
} 
```

我还将整个内容包装在一个更新面板中，以便我可以使用更新进度控件。所以基本上发生的事情是当您单击触发命令的标题时单击链接按钮。该命令被路由到绑定数据源的事件处理程序。因为它在更新面板中，所以它是异步发生的，我使用 updateprogress 控件来显示加载指示器。我可以通过使用覆盖整个区域的 div 支持链接按钮来改进它，然后给该 div 一个导致回发的 onclick 事件。但就目前而言，这是可行的。

# mysql - 你可以计算重复的行，左连接到适当的行，然后在一张表中分组吗？

> ID：12164293
> 
> 赞同：0
> 
> 时间：2012-08-28T17:17:39.420
> 
> 标签：mysql

我真的不知道它是否可能，但你能计算重复的行，左连接到适当的行，然后在 1 个表中分组吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:28:53.387

SELECT count(name) FROM table1 t1, table2 t2 WHERE t1.name = t2.name;

这将为您提供 table1 中的名称与 table2 中的名称相同的行数。我假设这就是你所说的重复。不需要左侧外部，因为它将显示左侧（table1）中没有右侧（table2）匹配的记录。如果他们没有匹配，他们是 n

# moodle - 如何增加 Moodle 的最大允许上传文件大小

> ID：12164296
> 
> 赞同：1
> 
> 时间：2012-08-28T17:17:47.350
> 
> 标签：moodle, scorm, scorm1.2

我已经尝试了所有找到的建议，但未能成功消除错误消息：

```
The page at [ip address] says:
[filename] is too large to upload 
```

我正在运行 Ubuntu 12.04.1 服务器和 Moodle 2.3.1+。正如其他人所建议的那样，我修改 `/etc/apache2/httpd.conf`了添加 `LimitRequestBody 0`，以便对上传的最大大小没有限制。

我还修改了`/etc/php5/apache2/php.ini`设置：

```
post_max_size = 1024M
upload_max_filesize = 1024M
max_execution_time = 300 
```

这些更改实际上对 Moodle 产生了影响，并导致它在站点安全策略和课程设置中列出了更大的上传限制。在修改 php.ini 之前，最大值为 2MB。因此，我将这些限制中的每一个都设置为 1GB。

```
http://[ip address]/moodle/admin/settings.php?section=sitepolicies
http://[ip address]/moodle/admin/settings.php?section=coursesettings 
```

我仍然收到错误消息，指出我要上传的文件太大。它只有 30MB。

你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:29:20.750

1.  您是否重新加载了您的网络服务器实例？
2.  [memory_limit](http://www.php.net/manual/en/ini.core.php#ini.memory-limit)指令呢？
3.  您是否尝试搜索任何可能覆盖您的设置的 .htaccess 文件？

但是，您的问题与[PHP 更改最大上传文件大小](https://stackoverflow.com/questions/2184513/php-change-the-maximum-upload-file-size)问题有关

* * *

Moodle 文档：

*   [上传文件的限制如何运作？](http://docs.moodle.org/23/en/Administration_FAQ#How_do_the_limits_on_uploaded_files_work.3F)
*   [文件上传大小](http://docs.moodle.org/22/en/File_upload_size)

要查看您的实际 php 设置，您可以查看： `http://[path to moodle]/admin/phpinfo.php`和`http://[path to moodle]/admin/environment.php`

# selenium - Knockoutjs 和 Selenium 测试

> ID：12164298
> 
> 赞同：1
> 
> 时间：2012-08-28T17:17:53.940
> 
> 标签：selenium, knockout.js

查看 Knockout 示例，实际上不需要向 HTML 元素添加 ID。创建一个没有 ID 的大型表单似乎更易于维护。

但是，这会给 Selenium HQ 带来问题。无法唯一标识表单上的元素。

有哪些选择？Selenium 是否有另一种方法来选择由 Knockout 创建的元素？还是我必须为元素分配 ID？

我已经回顾了其他淘汰赛和硒问题。当它们开始时，它们都为 HTML 元素定义了 ID。

谢谢阿比

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T17:38:41.557

**简短回答：将 ID 添加到您的 HTML 元素**中。

尽管您*不需要*这些属性来使您的网站正常运行，但您将使测试人员的生活*变得*更加轻松。

我在创建大型 ASP.NET MVC 4 应用程序的项目中遇到了完全相同的问题，该应用程序广泛使用 Knockout.js 和 Selenium。对于表单元素，我依靠 ASP.NET MVC 实用程序方法结合数据绑定表达式生成输出 HTML。ASP.NET MVC 根据支持模型自动生成唯一的 NAME 和 ID 属性。

然而，在我必须呈现表格、显示表单或对话框的所有其他情况下，**我最终将 ID 属性添加到这些 HTML 元素**中。如果您考虑一下，这是您的要求的逻辑结果。Knockout 很棒，因为您不再需要 ID 和 NAME 来将您的布局 (HTML) 和行为 (JS) 连接在一起。但是，其他框架（例如 Selenium）需要这些 ID 存在。

**是的，您可以使用复杂而臃肿的 XPATH 表达式来解决它。但这会大大降低测试的可维护性**。根据我的经验，将 ID 添加到数百个 HTML 元素只用了不到一天的时间，并且大大提高了我们测试人员的工作效率。

请记住，使用尽可能少的 HTML 开发功能性网站可能会很好。但是，如果这使您的网站无法测试，那么您将失去更多。可测试性是非功能性需求，但这并不意味着它不重要！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:44:28.810

**您应该将 Id 添加到您的 html 元素中。**您的应用程序将变得更加复杂，可能您需要将多个视图模型绑定到同一页面上的不同部分，您需要 Ids。例如，在 中`ASP.NET MVC`，您需要构建一个`partial view`来显示您订购的所有产品，并且您希望在整个订购过程中共享这个局部视图，您需要绑定到这个特定的局部视图部分

# php - 在 Windows 7 上安装 curl 时遇到困难

> ID：12164309
> 
> 赞同：0
> 
> 时间：2012-08-28T17:18:36.237
> 
> 标签：php, curl

我一直在尝试在我的工作计算机上安装 curl，但我一直遇到问题。我已取消注释 php.ini 中的扩展 php_curl.dll。但是每次我尝试运行一个带有 curl 的程序时，我都会收到一条错误消息，指出 curl 函数未定义。我已经完成了 phpinfo 以确保它位于正确的路径中。我没有使用 Xammp 或 Wammp。

# django - Django 1.4 本地 500 错误页面

> ID：12164322
> 
> 赞同：0
> 
> 时间：2012-08-28T17:19:29.823
> 
> 标签：django

自从使用 DEBUG = True 和 TEMPLATE_DEBUG = True 迁移到 Django 1.4 后，当我在本地遇到错误时，我不再看到带有回溯的典型黄色错误屏幕。相反，我得到一个纯白色的屏幕，上面写着“发生错误。请检查您的日志......”。这是新行为还是我通过组合 1.3 和 1.4 文件和设置搞砸了一些事情。

这是[我的本地设置的示例。](http://pastebin.com/icAgiKeS)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T14:16:44.370

错误处理程序位于 django.core.handler.base 尝试调试 handle_uncaught_exception 函数。

```
def handle_uncaught_exception(self, request, resolver, exc_info):
    """
    Processing for any otherwise uncaught exceptions (those that will
    generate HTTP 500 responses). Can be overridden by subclasses who want
    customised 500 handling.

    Be *very* careful when overriding this because the error could be
    caused by anything, so assuming something like the database is always
    available would be an error.
    """
    from django.conf import settings

    if settings.DEBUG_PROPAGATE_EXCEPTIONS:
        raise

    logger.error('Internal Server Error: %s', request.path,
        exc_info=exc_info,
        extra={
            'status_code': 500,
            'request': request
        }
    )

    if settings.DEBUG:
        from django.views import debug 
```

> > 检查你是否通过这里 return debug.technical_500_response(request, *exc_info)

```
 # If Http500 handler is not installed, re-raise last exception
    if resolver.urlconf_module is None:
        raise exc_info[1], None, exc_info[2]
    # Return an HttpResponse that displays a friendly error message.
    callback, param_dict = resolver.resolve500()
    return callback(request, **param_dict) 
```

检查您在 debug.technical_500_response 中传递的调试器

# javascript - 在 Javascript 中引用索引集合

> ID：12164327
> 
> 赞同：0
> 
> 时间：2012-08-28T17:19:40.510
> 
> 标签：javascript, node.js, firefox, google-chrome, v8

我搜索了一种在 Javascript 中获取通过引用索引的对象的方法。

就像是：

```
var myRefMap = new RefMap();

var a = [{}, [], function () {}];

myRefMap.set(a[0], true);
myRefMap.set(a[1], { hello: 'world' });
myRefMap.set(a[2], 42);

myRefMap.has(a[0]); // true
myRefMap.has(a[1]); // true
myRefMap.has(a[2]); // true

myRefMap.has({});             // false
myRefMap.has([]);             // false
myRefMap.has(function () {}); // false 
```

在循环引用中的树浏览期间，我需要这个对象来优化和避免实际的繁重数组搜索。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:48:27.217

如果所有存储的值都是对象，一种基本的方法是：

```
(function () {
    var instCount = 0;
    self.RefMap = function () {
        instCount ++;
        var propName = '__RefMap' + instCount + '__';
        this.has = function (o) {
            return propName in o;
        };
        this.set = function (o) {
            o[propName] = true;
        }
        this.remove = function (o) {
            delete o[propName];
        }
    }
}());

//then use it like
var myRefMap = new RefMap(); 
```

编辑：数组和函数也是对象。您可以使用 Object.defineProperty 隐藏“标记”属性，具体取决于您定位的浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:32:29.377

如果您的代码说您希望最后一个条件评估为真，那么只需使用一个对象和“in”指令就可以正常工作。

```
var mystuff = {};
var a = [{}, [], function () {}];

mystuff[a[0]] = true;
mystuff[a[1]] = {hello:'world'};
mystuff[a[2]] = 42;

(a[0] in mystuff); // true
({} in mystuff);   // true
(a[1] in mystuff); // true
(a[2] in mystuff); // true 
```

但是，如果您希望 ({} in mystuff) 评估为 false，那就大不相同了。

# php - 远程数据库

> ID：12164329
> 
> 赞同：0
> 
> 时间：2012-08-28T17:19:45.270
> 
> 标签：php, android, mysql, database

我正在尝试使用 Web 服务从远程 SQL 数据库存储/检索信息。由于某种原因，空字符串被插入到数据库中，而不是我想要存储的字符串。

如果 DB 中不存在具有 deviceID 的条目，我需要存储字符串 deviceID 和 dateStamp。

DB表名是trials，列是：_id | device_id | 安装日期

注意：与数据库连接和交互，只存储“”和“”而不是字符串。

有人可以告诉我这是为什么吗？这是我第一次尝试这种事情，所以遇到了很多麻烦并尝试修改我发现的片段以满足我的需要。

这是我的java代码：

```
import java.io.InputStream;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.provider.Settings.Secure;
import android.widget.Toast;

public class LicenseCheck extends Activity 
{
    String deviceID="",dateStamp="";       
    byte[] data;    
    HttpPost httppost;    
    StringBuffer buffer;    
    HttpResponse response;    
    HttpClient httpclient;    
    InputStream inputStream;    
    List<NameValuePair> nameValuePairs;

    public void onCreate(Bundle savedInstanceState)    
    {        
        super.onCreate(savedInstanceState); 
        final String android_id = Secure.getString(getApplicationContext().getContentResolver(),Secure.ANDROID_ID);        
        deviceID = android_id; 
        Date now = new Date();
        dateStamp = String.valueOf(now);

        try 
        {                    
            httpclient = new DefaultHttpClient();                    
            httppost = new HttpPost("http://99.57.234.12/Main.php");                    
            // Add your data                    
            nameValuePairs = new ArrayList<NameValuePair>(2);                   
            nameValuePairs.add(new BasicNameValuePair("device_id", deviceID));                    
            nameValuePairs.add(new BasicNameValuePair("install_date", dateStamp));                    
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));                     
            // Execute HTTP Post Request                    
            response = httpclient.execute(httppost);                    
            inputStream = response.getEntity().getContent();                     
            data = new byte[256];                     
            buffer = new StringBuffer();                    
            int len = 0;                    
            while (-1 != (len = inputStream.read(data)) )                    
            {                        
                buffer.append(new String(data, 0, len));                    
            }                     
            inputStream.close();                
            } catch (Exception e) {                    
                Toast.makeText(LicenseCheck.this, "error"+e.toString(), Toast.LENGTH_LONG).show();                
            }                
            if(buffer.charAt(0)=='Y')                
            {                    
                Toast.makeText(LicenseCheck.this, "working: " + buffer.toString() + ".", Toast.LENGTH_LONG).show();

                Move_to_next();
                LicenseCheck.this.finish();
            } else {                    
                Toast.makeText(LicenseCheck.this, "Trial Started", Toast.LENGTH_LONG).show();
                Move_to_next();
                LicenseCheck.this.finish();
            }                    
        }        
    public void Move_to_next()        
    {         
        startActivity(new Intent(this, MainMenu.class));        
    }
} 
```

这是PHP：

```
<?php 
    require_once('Connections.php'); 
    mysql_select_db($database_localhost,$localhost); 

    $device = $_POST['device_id'];
    $date = $_POST['install_date'];

    $query_search = "select * from trials where device_id = '".$device."'"; 
    $query_exec = mysql_query($query_search) or die(mysql_error()); 
    $rows = mysql_num_rows($query_exec);  

    if($rows --> 0) 
    { 
        echo "Y"; 
        $result = mysql_query("SELECT device_id,install_date FROM trials WHERE device_id = '".$device."'");
        if (!$result) {
            echo 'Could not run query: ' . mysql_error();
            exit;
        }
        $row = mysql_fetch_row($result);

        echo $row[0]; // device_id
        echo $row[1]; // install_date
        } else {
        echo "N";
        mysql_query("INSERT INTO trials (device_id, install_date) VALUES ( '".$device."', '".$date."')") or die (mysql_error()); 
    }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:21:55.563

您正在发布：

```
nameValuePairs.add(new BasicNameValuePair("DeviceID", deviceID));
nameValuePairs.add(new BasicNameValuePair("DateStamp", dateStamp)); 
```

但您正在寻找：

```
$device = $_POST['device_id'];
$date = $_POST['install_date']; 
```

您的 PHP 正在 $_POST 中寻找尚未设置的变量。

# android - 如何为列表视图选定项设置背景颜色

> ID：12164331
> 
> 赞同：1
> 
> 时间：2012-08-28T17:19:48.527
> 
> 标签：android, listview

当我们使用选择器时工作正常。但这是暂时的。如果列表项的焦点发生变化，那么选定的颜色也会发生变化。但我想要不同。当我们单击列表视图项目时，该特定项目的颜色会发生变化。之后，我们可以移动列表视图的其他项目。当我们单击另一个项目时。然后再次这个特定的选定项目要设置颜色，最后一个彩色列表项从颜色中释放

# database - 我对一张数据库表的期望太高了吗？

> ID：12164335
> 
> 赞同：2
> 
> 时间：2012-08-28T17:20:03.580
> 
> 标签：database, database-design, modeling

我正在开发一个专有的反馈应用程序。我有一个名为*主题*的表，我将用它来存储建议、问题和问题。

```
topics [ id, user_id, title, content, type[suggestion, question, problem] ] 
```

我可以使用列轻松地将这些数据存储在一个表中，`type`以区分三种不同的主题类型。

但是，还有另一个问题：每个主题也有自己的响应，并且响应与主题本身非常相似。我也很想将它们存储在同一张表中。所以现在我有`type (suggestion, question, problem)`and `subtype (topic, response)`。

我对我的主题表要求太多了吗？我应该将数据拆分到单独的表中吗？我正在为这个特定项目使用 Postgres 和 Rails。

可视化的最佳方法是将其与 StackoverFlow 进行比较。SO 将问题和答案存储在同一个`posts`表中。现在假设，而不是只有问题，所以决定允许建议和问题。他们还会使用同一张桌子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:29:09.783

您希望多长时间在一次操作中同时查询主题和响应？也许在搜索时，但有时您也想只搜索主题或只搜索回复。您多久需要查询一次？大多数时候。

去两个单独的表，`UNION`如果你想一起使用它们，你可以使用带有子句的视图。同样在应用程序级别，您可以在关系数据库之上构建继承模型。说`Post`对象`Topic`和`Response`子类。[像hibernate](/questions/tagged/hibernate "显示标记为“休眠”的问题")这样的一些库会透明地将*所有帖子的查询...`转换为两个单独的查询并将结果合并在一起。

[另一种方法](http://openjpa.apache.org/builds/1.0.4/apache-openjpa-1.0.4/docs/manual/jpa_overview_mapping_inher.html)（也是在关系存储中处理继承的一种方法）是拥有......三个表！`Posts`,`Topics`和`Response`, 最后两个有外键`Posts`. 这样，公共列在一个表中，特定类型的列是分开的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T21:38:17.650

将主题和响应保存在一张表中更适合论坛。（很大程度上取决于您计划拥有的功能。它是论坛还是新闻/文章/评论网站？）

大多数论坛框架都使用这种设计。包括你提到的SO。要明确的一个区别 - 请注意，您定义为“主题”的内容通常是“帖子”。所以“回复”也是帖子。*其他*框架称为“主题”的是线程*信息*。

*   这是[phpBB 架构的图像](http://internal.shirta.com/tech/phpbb3_tables.png)（警告，1MB）。请注意带有and的`phpbb_posts`表格（其中是标题、论坛 ID、查看次数等，但不是**）**。`post_text``topic_id``topic_`**`post_text`**

***   StackOverflow：[表](http://sqlserverpedia.com/wiki/Understanding_the_StackOverflow_Database_Schema#Posts_Table)[`PostTypeId`中的`Posts`](http://sqlserverpedia.com/wiki/Understanding_the_StackOverflow_Database_Schema#Posts_Table)- *“1 是问题，2 是答案。答案将填充 ParentId 字段以链接回问题帖子。”*

    *   请参阅此相关问题和其他人的谷歌：[您将如何构建论坛的数据库架构？](https://stackoverflow.com/questions/571192/how-would-you-structure-a-forums-db-schema)** 

 **您可以使用以下内容查询帖子 + 回复：

```
select t.id, t.user_id, t.title, t.content, t.type, t.parent_id,
       r.id, r.user_id, r.title, r.content, r.type, r.parent_id
from topics t
left join topics r on r.parent_id = t.id
where t.parent_id = 0 and t.id = <specific id> 
```

您应该分开的部分是：如果您想显示线程摘要，例如 stackoverflow Questions/Active/Newest 页面；或具有最新主题、响应、海报等的论坛索引，然后维护一个`thread_info`表将有助于数据库性能，特别是如果您期望高访问量和/或许多线程和帖子。

> 现在假设，而不是只有问题，所以决定允许建议和问题。他们还会使用同一张桌子吗？

这`Suggestions`取决于。看[`comments`例子](http://sqlserverpedia.com/wiki/Understanding_the_StackOverflow_Database_Schema#Comments_Table)。不同的表。评论的**性质（模型）+功能不同，**可以单独存储。

再举一个例子：在新闻/评论网站或类似的 wordpress 中，由于相同的原因，文章及其[回复将被分开存储。](http://www.jayminkapish.com/wp-content/uploads/2009/03/wp_2.7.png)文章将与网站作者、相关文章、格式、类别等有关系。响应将被串接，可能未格式化等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:31:06.003

在这里使用多个表，你自己说的：还有另一个问题：每个主题都有自己的响应* *es* * too

任何东西的多个通常需要另一个表。

我会这样看：[主题] [主题ID，用户ID，标题，内容，类型[建议，问题，问题]]

```
[SUGGESTION] [ suggID     <fields here>        *topicID ] 
```

注意`topicID`作为外键`[SUGGESTION]`**

# sql - SQL group by 不相等的结果

> ID：12164336
> 
> 赞同：1
> 
> 时间：2012-08-28T17:20:07.467
> 
> 标签：sql, tsql, postgresql

我正在使用 postgres，但我也知道 T-SQL，所以任何人都可以给我的任何答案都将不胜感激并能够进行转换。我正在尝试为我的汽车销售公司运行查询。他们主要在 OR 和 WA 在美国各地销售汽车。我需要提供一份报告，允许我返回 OR 的新销售和 Wa 的新销售，然后我遇到的问题是所有其他非 OR 或 Wa 的州的销售。所以现在我运行一个与组的联合，其中一个查询是针对 WA 的，另一个语句是针对 OR 的。我希望结果看起来非常简单，只有 3 行。1 OR 1 WA 和第 3 行所有其他州相结合。我不知道如何将不等于 OR 或 WA 组合成一个值。这甚至可能吗？

感谢您花时间看这个

我的查询还将包括二手车，但一旦我弄清楚如何解决这个问题，我就可以整合它，这就是为什么查询有多个联合

这是我现在的查询：

```
SELECT buyerstate        AS "State", 
       Count(buyerstate) AS "Acura", 
       saletype          AS "N/U" 
FROM   lydeal 
WHERE  stocklocationid = '8' 
       AND buyerstate = 'OR' 
       AND saledate > '8/01/12' 
       AND saletype = 'N' 
GROUP  BY buyerstate, 
          stocklocationid, 
          saletype 
UNION 
SELECT buyerstate        AS "State", 
       Count(buyerstate) AS "Acura", 
       saletype          AS "N/U" 
FROM   lydeal 
WHERE  stocklocationid = '8' 
       AND buyerstate = 'OR' 
       AND saledate > '8/01/12' 
       AND saletype = 'U' 
GROUP  BY buyerstate, 
          stocklocationid, 
          saletype 
UNION 
SELECT buyerstate        AS "State", 
       Count(buyerstate) AS "Acura", 
       saletype          AS "N/U" 
FROM   lydeal 
WHERE  stocklocationid = '8' 
       AND buyerstate = 'WA' 
       AND saledate > '8/01/12' 
       AND saletype = 'N' 
GROUP  BY buyerstate, 
          stocklocationid, 
          saletype 
UNION 
SELECT buyerstate        AS "State", 
       Count(buyerstate) AS "Acura", 
       saletype          AS "N/U" 
FROM   lydeal 
WHERE  stocklocationid = '8' 
       AND buyerstate = 'WA' 
       AND saledate > '8/01/12' 
       AND saletype = 'U' 
GROUP  BY buyerstate, 
          stocklocationid, 
          saletype 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:37:24.960

试试这个

```
SELECT CASE WHEN buyerstate IN ('OR','Wa') THEN buyerstate ELSE 'OTHER' END   AS "State", 
   Count(buyerstate) AS "Acura", 
   saletype          AS "N/U" 
FROM   lydeal 
WHERE  stocklocationid = '8' 
   AND saledate > '8/01/12' 
   AND saletype = 'N' 
GROUP  BY CASE WHEN buyerstate IN ('OR','Wa') THEN buyerstate ELSE 'OTHER' END, 
      stocklocationid, 
      saletype 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:32:55.007

您可以使用`CASE`表达式：

```
SELECT CASE WHEN buyerstate IN ('OR', 'WA')
            THEN buyerstate
            ELSE 'other'
        END AS OR_or_WA_or_other,
       ...
  FROM lydeal
 WHERE ...
 GROUP
    BY CASE WHEN buyerstate IN ('OR', 'WA')
            THEN buyerstate
            ELSE 'other'
        END,
       ...
 ORDER
    BY OR_or_WA_or_other
; 
```

（您实际上可以更改`OR_or_WA_or_other`为`buyerstate`，但我认为使用新名称更清楚，所以很清楚哪些地方指的是什么。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T17:37:12.203

我认为你应该这样做：

```
SELECT buyerstate        AS "State", 
       Count(buyerstate) AS "Acura",
       saletype          AS "N/U" 
FROM   lydeal 
WHERE  stocklocationid = '8' 
       AND (
          (buyerstate in ('OR', 'WA') AND saledate > '8/01/12' AND saletype in ('N', 'U')) OR //Only new sales for Or and Wa
          (buyerstate not in ('OR', 'WA')) //all other sales
       )
       AND saletype = 'N' 
GROUP  BY buyerstate, 
          stocklocationid, 
          saletype 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T17:30:58.977

你可以尝试这样的事情：

```
select buyerstate as "State",count(buyerstate) as "Acura", saletype as "N/U"
from lydeal
where stocklocationid = '8' and buyerstate = 'OR' and saledate > '8/01/12' and saletype = 'N'
group by buyerstate,stocklocationid,saletype
union

select buyerstate as "State",count(buyerstate) as "Acura", saletype as "N/U"
from lydeal
where stocklocationid = '8' and buyerstate = 'WA' and saledate > '8/01/12' and saletype = 'N'
group by buyerstate,stocklocationid,saletype

union
select 'Others' as "State",count(buyerstate) as "Acura", saletype as "N/U"
from lydeal
where stocklocationid = '8' and buyerstate <> 'WA' and buyerstate <> 'OR'  and saledate > '8/01/12' and saletype = 'N'
group by stocklocationid,saletype 
```

对于第三部分，只需使用某些东西而不是buyerstate，并且不要根据它进行分组，它应该会有所帮助。

# android - 用列表视图中的图像视图替换文本视图

> ID：12164337
> 
> 赞同：0
> 
> 时间：2012-08-28T17:20:11.303
> 
> 标签：android, listview, textview, imageview

我有一个 listView 成功显示了一些文本和推荐。推荐可以是“L”或“A”。现在我有两张图片。我如何用该图像替换推荐或根据推荐将另一个图像添加到该列表中。提前感谢

换句话说，我如何在制作后循环列表视图及其值。

这就是我制作列表视图的方式。

```
this.setListAdapter(new SimpleAdapter(Grammar_tab_all.this, testdata ,
                R.layout.list_item, new String[] { "name","recom"},
    new int[] { R.id.module_name_item, R.id.module_recom,}));
        final ListView lv = getListView(); 
```

现在如何循环该列表视图以便我可以比较推荐值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:21:29.050

那么，你需要的是自定义列表视图。希望[这个链接](http://www.ezzylearning.com/tutorial.aspx?tid=1763429)可以帮助你解决你的问题。

# c# - 有没有办法将白名单 和 标签而不添加额外的按钮？

> ID：12164339
> 
> 赞同：0
> 
> 时间：2012-08-28T17:20:20.800
> 
> 标签：c#, ajaxcontroltoolkit, htmleditorextender

当我使用 HTML Editor Extender 从文本框中保存 text/html 时，它会不断删除新行和 div。

我找到了原因：

> 如果标签不在白名单上（换句话说，HtmlEditorExtender 按钮不需要），那么它就会被剥离。我们希望尽我们所能来防止跨站点脚本攻击，因此我们需要限制您可以使用的标签、属性和属性值的类型。如果您设置 HtmlEditorExtender 属性 EnableSanitization=”false” 则不会发生剥离 - 但随后您将面临跨站点脚本攻击。

[http://stephenwalther.com/archive/2012/06/25/announcing-the-june-2012-release-of-the-ajax-control-toolkit.aspx#comment-4842](http://stephenwalther.com/archive/2012/06/25/announcing-the-june-2012-release-of-the-ajax-control-toolkit.aspx#comment-4842)

我目前在工具栏上启用了以下工具：

```
<ajaxToolkit:HtmlEditorExtender ID="HtmlEditorExtender1" 
    TargetControlID="txtBody" DisplaySourceTab="false" 
    runat="server" Enabled="True">
    <Toolbar> 
        <ajaxToolkit:Bold />
        <ajaxToolkit:Italic />
        <ajaxToolkit:Underline />
        <ajaxToolkit:InsertOrderedList />
        <ajaxToolkit:InsertUnorderedList />
        <ajaxToolkit:CreateLink />
        <ajaxToolkit:UnLink />
        <ajaxToolkit:RemoveFormat />
    </Toolbar>
</ajaxToolkit:HtmlEditorExtender> 
```

我添加了按钮`<ajaxToolkit:JustifyLeft />`，`<div>`标签不再被剥离，但理想情况下我不想允许额外的按钮。

问题：

**有没有办法在不添加额外按钮的情况下加入白名单`<br />`和`<div>`标签？**

大家还能想到什么其他的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T09:32:06.523

添加任何 justify 按钮将使 htmleditor 扩展器可在 Internet Explorer 中使用。

```
<ajaxToolkit:Justifyleft /> 
<ajaxToolkit:JustifyCenter /> 
<ajaxToolkit:JustifyRight /> 
<ajaxToolkit:JustifyFull /> 
```

没有这些按钮，一切都会被剥离，标签也不会被接受。你提到你已经能够让标签 br 接受了，你添加了哪个按钮来允许这种情况发生。这将使 htmleditorextender 可用。谢谢。

# c# - 如何在不丢失原始结构的情况下添加 XML 节点？

> ID：12164347
> 
> 赞同：0
> 
> 时间：2012-08-28T17:20:53.833
> 
> 标签：c#, visual-studio-2008

我有代码，我在其中将新节点添加到 xml 文件中，它运行良好，但是有一个问题，当我保存添加的更改时，xml 文件的原始结构发生了更改。

最初，该文件对每个节点都有一个完整的行或行，如下所示：

```
<DATA>
   <ROW><mk v = "2801"/><gd v = "170300"/><wn v = "00Y6354"/><bn v = ""/></ROW>
   <ROW><mk v = "2801"/><gd v = "170301"/><wn v = "00Y6355"/><bn v = ""/></ROW>
   <ROW><mk v = "2801"/><gd v = "170302"/><wn v = "00Y6356"/><bn v = ""/></ROW>
</DATA> 
```

但添加新节点并保存更改后，结构如下所示：

```
<DATA>
   <ROW>
      <mk v = "2801"/>
      <gd v = "170300"/>
      <wn v = "00Y6354"/>
      <bn v = ""/>
   </ROW>
   <ROW>
      <mk v = "2801"/>
      <gd v = "170301"/>
      <wn v = "00Y6355"/>
      <bn v = ""/>
   </ROW>
   <ROW>
      <mk v = "2801"/>
      <gd v = "170302"/>
      <wn v = "00Y6356"/>
      <bn v = ""/>
   </ROW>
   <ROW>
      <mk v = "2341"/>
      <gd v = "170342"/>
      <wn v = "00Y9872"/>
      <bn v = "new node"/>
   </ROW>
</DATA> 
```

我试图找到一些带有 FINAL OUTPUT 的示例，例如第一个结构，但什么也没有。因此，可以在不更改原始结构的情况下保存更改，请告诉我！

我的代码是这样的：

```
 public void CreateXML(string[] ipRow, string ipFile)
    {
        XmlDocument doc = new XmlDocument();
        XmlDocument xmlDoc = new XmlDocument();
        xmlDoc.Load(ipFile);

        for (int j = 0; j < ipRow.Length; j++)
        {
            doc.LoadXml(ipRow[j]);
            XmlNode newNode = doc.DocumentElement;
            XmlNode copiedNode = xmlDoc.ImportNode(newNode, true);
            xmlDoc.DocumentElement.LastChild.AppendChild(copiedNode);                
        }
        xmlDoc.Save(ipFile);
    } 
```

我只是想应用某种格式，或者至少指示程序尊重文件中已有内容的原始结构。我找到了论坛，他们说您可以使用 StringBuilders、XmlWriterSettings 和其他东西，但不起作用，而且正如您所见，新节点来自字符串，所以，我无法更改新节点的方式创建节点后，代码必须保持原样，只需添加规则以保持原始格式。

或者，如果有人知道在 Visual Studio 2008 上使用 C# 不可能做到这一点，请告诉我（我只相信明显的专家用户）。

请回复！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:40:22.053

冒着重复您在其他地方可能被告知的内容的风险，您不能仅通过保存 XmlDocument 来做到这一点。您可以尝试使用 XmlTextWriter：

```
using (var xmlWriter = new XmlTextWriter(filePath, Encoding.UTF8))
{
  xmlWriter.Formatting = Formatting.None;
  yourDocument.WriteTo(xmlWriter);
} 
```

...但我不确定这是否会为您提供您正在寻找的非常具体的布局。

`<ROW>`或者您可以将整个文档作为字符串获取（使用 yourDocument.OuterXml），然后使用普通字符串匹配（可能是最好的 REGEX）来删除所有回车符，节点之前和之后的回车符除外。

请记住，这些都不会对您的文件结构产生任何实际影响——这只是格式化的一种情况。

# ruby-on-rails - 如何将所有项目 gem 包含到 gemfile 中？

> ID：12164352
> 
> 赞同：0
> 
> 时间：2012-08-28T17:21:08.360
> 
> 标签：ruby-on-rails, rubygems, gem

我作为一名开发人员支持在 Rails 中构建的多个应用程序，通常我需要安装未包含在 gem 文件中的 gem。

昨天我构建了一个项目，当我尝试在另一台计算机上运行它时，我遇到了一些缺少 gems 的问题，实际上很多，我不知道从哪里获得所有缺少的 gems 的列表或如何安装它们。

问题是，有没有办法将项目需要的所有 gem 包含到 gem 文件中，这样下次有人尝试在另一台计算机上运行它时，使用 comand 就足够了`bundle install`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:16:03.723

您需要在 Gemfile 中包含 Gem，然后`bundle install`在任何新机器上运行以安装这些 Gem 及其依赖项。例如：

来源“https://rubygems.org”

```
gem 'rails', '3.2.6'
gem 'jquery-rails'
gem 'mongoid'
gem 'devise'
gem 'cancan' 
```

在这个例子中，当 bundler 安装 rails 时，所有 rails 的依赖，如 Active Record、Action Pack 等都会被安装。其余的 gem 及其依赖项也是如此。

如果您正在计划并且看起来您正在计划花很多时间在 Rails 上，那么您应该认真阅读[Bundler](http://gembundler.com/)。

# javascript - 将命名函数用作jquery ajax成功回调时是否需要括号

> ID：12164354
> 
> 赞同：1
> 
> 时间：2012-08-28T17:21:16.907
> 
> 标签：javascript, jquery, ajax

如果我之前定义了一个函数，在指定它应该用于成功回调时是否需要包含括号？

如果我这样做会有什么不同？

如在

```
function fish_food(){//do something}

$.ajax({
    url: '/',
    success: fish_food
}); 
```

或者

```
$.ajax({
    url: '/',
    success: fish_food()
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T17:28:48.630

`fish_food`它本身（没有括号）充当对函数对象的引用。它允许您传递对函数的引用，以便在以后调用。

`fish_food()`（带括号）是一个函数调用表达式，它导致函数被执行。函数代码被评估并运行，并且可以选择返回一个值。

使用您提供的 AJAX 代码（以及所有涉及回调的异步 JavaScript），您希望使用该`fish_food`版本（不带括号）。这会将 AJAX 代码传递给您的成功函数的引用，一旦 AJAX 代码完成与服务器的往返行程并返回，就会异步执行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T17:22:57.653

不。

括号将告诉浏览器`fish_food`需要立即执行函数，并且必须将值返回给`success`属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:22:33.233

您想要无括号版本。原因是括号告诉 JavaScript 立即执行该函数，而不是仅通过名称引用它，因此您的`success`回调实际上是在`fish_food()`执行 AJAX 调用时调用的结果（这可能是一个涉及`undefined`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T17:23:03.437

这会起作用

```
$.ajax({
    url: '/',
    success: fish_food
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T17:23:04.980

你不需要括号。使用括号会调用函数，它需要的只是一个相当于 C/C++ 中函数指针的名称。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-28T17:23:28.780

有括号会导致函数在那里执行，这就是为什么你需要第一个版本，否则成功存储函数的返回值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-28T17:23:48.993

```
$.ajax({
    url: '/',
    success: fish_food
}); 
```

是正确的。

当你使用`success: fish_food()`时，它会立即执行并且返回设置为成功。

# c# - Windows 服务或控制台应用程序中的文件系统观察程序？

> ID：12164358
> 
> 赞同：0
> 
> 时间：2012-08-28T17:21:35.093
> 
> 标签：c#, .net-4.0

我正在实现一个文件系统观察器，我的要求是在机器上观察给定的本地文件夹，然后执行一项小任务（例如在 Web 浏览器中打开某个页面）。给定目录中的文件有时会每两小时或四小时随机生成一次。这个工具应该是自动化的，因为用户不必启动它。所以我的问题是，我应该在始终运行的 Windows 服务中还是在控制台应用程序中实现它。首选是在控制台应用程序中执行它，但它需要由用户启动吗？请指教

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:24:21.647

您可以自动调用任何类型的应用程序（控制台、Windows 等）。Windows 服务归结为您是否希望它在任何人登录之前运行。

只有 Windows 服务在没有人登录时运行。控制台应用程序（虽然它可以设置为在登录时运行）必须有人登录才能运行。

# asp.net-mvc - 如何检查虚拟路径是否存在

> ID：12164360
> 
> 赞同：2
> 
> 时间：2012-08-28T17:21:41.947
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

如何以编程方式检查 MVC 路由是否存在？

假设我有这段代码：

```
var virtualPath = base.GetVirtualPath(requestContext, routeValues); 
```

我想检查 virtualPath.Route 处生成的路由是否有匹配的控制器和操作。

我尝试使用 GetRouteData 但即使对于有效路线它也会返回 null 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:51:00.300

您可以从中获取 RouteValueDictionary `virtualPath`，然后使用反射检查此路由值是否存在控制器和操作

**更新：** 示例方法（我尝试过。它有效）：

```
public static bool CheckRoute(RequestContext requestContext)
    {
        var routeData = RouteTable.Routes.GetRouteData(requestContext.HttpContext);
        if (routeData == null)
            return false;
        var controllerName = (string)routeData.Values["controller"];
        var actionName = (string) routeData.Values["action"];
        var controller = ControllerBuilder.Current.GetControllerFactory().CreateController(requestContext, controllerName);
        if (controller == null)
            return false;
        var controllerType = controller.GetType();
        var controllerDescriptor = new ReflectedControllerDescriptor(controllerType);
        var actionDescriptors = controllerDescriptor.GetCanonicalActions();
        return actionDescriptors.Select(a => a.ActionName).Contains(actionName);
    } 
```

# ruby-on-rails - 如何覆盖有效密码？（密码）在设计

> ID：12164362
> 
> 赞同：3
> 
> 时间：2012-08-28T17:21:49.263
> 
> 标签：ruby-on-rails, ruby, devise

我让我的用户模型使用 Devise 进行身份验证，我想在我的类定义中的 user.rb 中覆盖 valid_password 方法

```
class User < ActiveRecord::Base
  devise  :database_authenticatable

  # overwriting the valid_password from database_authenticatable
  module PostDatabaseAuthenticatable 

   def valid_password?(password)
    if old_password
      # do something new
    else
      # call valid_password from DatabaseAuthenticatable
      super
    end 
   end 

  end 

  include PostDatabaseAuthenticatable

end 
```

所以首先我们通过设计包含 database_authenticable 然后包含我的 PostDatabaseAuthenticatable 所以根据我读到的[Rails 3: alias_method_chain 仍然使用？](https://stackoverflow.com/questions/3689736/rails-3-alias-method-chain-still-used)它应该完全覆盖设计的 valid_password 方法。

但是当我运行我的代码时，它总是先调用它，然后再调用设计，所以根本不会覆盖它。

任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:35:23.537

实际上这一直在工作，我调试错了。此外，我不需要模块覆盖，只需创建用户类的 valid_password?(password) 方法 insdie 即可完成工作

# html - 将 float:right 样式应用于按钮会弄乱其与相邻文本的垂直对齐方式

> ID：12164365
> 
> 赞同：1
> 
> 时间：2012-08-28T17:21:57.827
> 
> 标签：html, css, alignment

我想在表格单元格中放置一个文本和按钮。按钮需要向右对齐。如果我将 float:right 样式应用于按钮，则垂直对齐会变差。有什么帮助吗？

这是没有浮动的jsfiddle：对，垂直对齐在这里很好：http: [//jsfiddle.net/5GRHL/2/](http://jsfiddle.net/5GRHL/2/)

这是应用了 float:right 的 jsfiddle：http: [//jsfiddle.net/5GRHL/3/](http://jsfiddle.net/5GRHL/3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:42:13.707

我相信最简单的解决方案是为您的按钮设置一个固定的高度，并将该高度作为文本的行高应用。像这样的东西：

```
td
{
    height:50px;
    width:80px;
    vertical-align:middle;
    line-height: 22px;
}
td button 
{
    float:right;
    height: 22px;
} 
```

我更新了小提琴：http: [//jsfiddle.net/5GRHL/26/](http://jsfiddle.net/5GRHL/26/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:32:19.180

我认为最简单的解决方案（但可能不是最干净的）是重新调整按钮。

尝试类似：

```
button {
  margin-top: -4px;
  float: right
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:33:14.883

您可以使用 float:right 并更正定位对齐：http: [//jsfiddle.net/5GRHL/23/](http://jsfiddle.net/5GRHL/23/)

# android - 以编程方式展开操作视图

> ID：12164367
> 
> 赞同：4
> 
> 时间：2012-08-28T17:22:08.543
> 
> 标签：android, search, view, action, expand

我希望能够以编程方式扩展我的操作视图。我的操作视图是一个搜索视图，我尝试了 mSearchView.expandActionView() 但它没有用。如何才能做到这一点？

# windows-7 - Console.Writeline c# 不工作

> ID：12164368
> 
> 赞同：1
> 
> 时间：2012-08-28T00:36:08.850
> 
> 标签：windows-7, macos, visual-studio-2008, c#

我对在 Visual Studio 中编程 c# 很感兴趣，我在这里遇到了问题。我有一个 mac book pro 并安装了并行 7，然后是 Windows 7。现在我在机器上安装了 Visual Studio 2008，但是当我尝试执行命令 Console.Writeline 时，控制台不会保持打开状态。它只会执行命令并在不到一秒钟的时间内将其关闭。有什么解决方案可以用来修复它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T00:57:22.757

控制台应用程序存在于`Main()`方法之后，这很可能是控制台窗口立即关闭的原因。

尝试使用`Ctrl`+运行应用程序`F5`，或在方法`Console.ReadLine()`末尾添加`Main()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T00:59:02.210

您可以在调试模式下运行应用程序，并在最后一行设置断点以使其暂停，以便您可以读取控制台输出。

这是所有语言的 Visual Studio 开发的一个非常常见的问题，并且还有其他几种解决方法。有关更多选项，请参阅 Stack Overflow 上以下问题的答案：

*   [Visual Studio 控制台应用程序 - 防止窗口关闭](https://stackoverflow.com/q/1775865/1288)
*   [在调试模式下执行控制台应用程序后如何使 Visual Studio 暂停？](https://stackoverflow.com/q/193469/1288)
*   [在 Visual Studio 2010 中看到控制台的输出？](https://stackoverflow.com/q/5301232/1288)

# c++ - 在 VS2010 上构建 openssl 时出错

> ID：12164371
> 
> 赞同：0
> 
> 时间：2012-08-28T17:22:21.693
> 
> 标签：c++, openssl

在链接我缺少什么文件时出现问题？

> Visual Studio 2010 错误输出

*   错误 14 错误 LNK2001：无法解析的外部符号 ___umoddi3 C:\Users\Yohannes\Desktop\AES Encryption\libcrypto.a(bn_word.o) Rijndael
*   错误 11 错误 LNK2001: 无法解析的外部符号 __alloca C:\Users\Yohannes\Desktop\AES Encryption\libcrypto.a(sha512.o) Rijndael
*   错误 12 错误 LNK2001: 无法解析的外部符号 __alloca C:\Users\Yohannes\Desktop\AES Encryption\libcrypto.a(err_prn.o) Rijndael
*   错误 15 错误 LNK2019：函数 _fmtint C:\Users\Yohannes\Desktop\AES Encryption\libcrypto.a(b_print.o) Rijndael 中引用的未解析外部符号 ___udivdi3
*   错误 13 错误 LNK2019：函数 _fmtint C:\Users\Yohannes\Desktop\AES Encryption\libcrypto.a(b_print.o) Rijndael 中引用的未解析的外部符号 ___umoddi3
*   错误 10 错误 LNK2019：函数 _OPENSSL_isservice C:\Users\Yohannes\Desktop\AES Encryption\libcrypto.a(cryptlib.o) Rijndael 中引用的未解析的外部符号 __alloca -

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:30:38.130

根据：[http ://aluigi.freeforums.org/post4997.html](http://aluigi.freeforums.org/post4997.html)

```
link it to libcrypto.a, it's the static library.

if you don't have it:
http://gnuwin32.sourceforge.net/packages/openssl.htm 
```

# android - 创建屏幕键盘 (android)

> ID：12164377
> 
> 赞同：1
> 
> 时间：2012-08-28T17:22:42.970
> 
> 标签：android, android-layout

我想开发一个类似于方形应用程序的屏幕键盘（下图）![在此处输入图像描述](../Images/c846f8a2dd424305a6b80913bb3654fc.png)

如果有人能给我一些提示，告诉我应该关注/覆盖哪些课程，我将不胜感激。特别是，如何将按钮点击与 EditText 字段中的数字输入相关联？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:30:14.400

每个人都会[`Button`](http://developer.android.com/reference/android/widget/Button.html)获得一个带有关联值的[标签](http://developer.android.com/reference/android/view/View.html#attr_android%3atag)（例如`1`）。然后，您使用-[`android:onClick`属性](http://developer.android.com/reference/android/view/View.html#attr_android%3aonClick)将所有按钮设置为`input()`活动中的相同方法（例如）。

此方法将与单击的视图一起调用，然后您可以使用[`getTag()`](http://developer.android.com/reference/android/view/View.html#getTag%28%29)- 方法获取相应的值：

```
// Will be called for every Button that is clicked
public void input(View v){
  Log.v("APP", "Pressed: "+v.getTag());
} 
```

`Button`将s组织在[`GridLayout`](http://developer.android.com/reference/android/widget/GridLayout.html)([`GridView`](http://developer.android.com/guide/topics/ui/layout/gridview.html)也可能) 中。

# c# - 序列化包含 List 的 T

> ID：12164380
> 
> 赞同：0
> 
> 时间：2012-08-28T17:22:52.960
> 
> 标签：c#, serialization, xml-serialization, deserialization, xml-deserialization

我想序列化一个`MyClass`，它是一个包含一个列表的类`MyClass`。

在 XML 中，我只想写`myClass.Name`，然后当我反序列化它时，我会找到哪个`MyClass`应该在哪个其他`MyClass`. 我有以下代码可以将列表正确序列`MyClass`化为`string`. 但是，它不会反序列化字符串列表。

```
//List of actual object. It's what I use when I work with the object.
[XmlIgnore]
public List<TaskConfiguration> ChildTasks { get; set; }

//Used by the serializer to get the string list, and used
//by the serializer to deserialize the string list to.
[XmlArray("ChildTasks")]
public List<string> ChildTasksSurrogate
{
    get
    {
        List<string> childTaskList = new List<string>();

        if (ChildTasks != null)
            childTaskList.AddRange(ChildTasks.Select(ct => ct.Name).ToList());

        if (_childTasksSurrogate != null)
            childTaskList.AddRange(_childTasksSurrogate);

        //Clears it not to use it when it serializes.
        _childTasksSurrogate = null;
        return childTaskList;
    }
    set
    {
        _childTasksSurrogate = value;
    }
}

[XmlIgnore]
private List<string> _childTasksSurrogate; 
```

正如我所说，序列化有效。问题在于反序列化。反序列化后，`MyClass._childTasksSurrogate`就是`null`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:23:16.893

问题与如何`XmlSerializer`反序列化 Xml 有关：我认为`XmlSerializer`将分配整个属性（读取：`myList = DeserializedList)`，而看起来它添加了所有元素（读取：`myList.AddRange(DeserializedList)`.

# javascript - 提交后如何关闭彩盒窗口，并刷新父页面上的图像？

> ID：12164388
> 
> 赞同：0
> 
> 时间：2012-08-28T17:23:17.930
> 
> 标签：javascript, colorbox

我正在使用颜色框进行模态显示，当单击图像进行更新时，它会为用户打开。一旦用户上传新图像并在颜色框模式上点击提交，模式应该关闭并刷新父页面上的图像。

我在提交按钮中使用以下 onClick 事件：

```
 <input onClick='window.parent.location.reload(true);' type='submit' value='Submit' name='save_button' id='save_button'> 
```

这将关闭模式并刷新父 page.php。但是由于某种原因，它不会刷新旧图像以显示用户刚刚上传的新图像。

**编辑：添加颜色框代码**

调用颜色框的脚本与其他javascript代码冲突，所以我在颜色框代码上方添加了以下脚本，并将代码中的更改`$`为`jQuery`：

```
<script>jQuery.noConflict();
  jQuery(document).ready(function(){
  jQuery("iframe").hide();
  });

  $('input').hide();
</script>

<script>
  jQuery(document).ready(function(){
  jQuery(".iframe").colorbox({iframe:true, width:"748px", height:"92%"});
  });
</script> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:59:51.677

浏览器会创建一个缓存以加快浏览速度，如果刷新页面后您的图像 src[location] 相同，则浏览器会向您显示图像的先前副本。您必须在每次重新加载时更改图像 src 属性的目标或通过函数执行相同操作，如下所示：

```
$('img').each(function(){
$(this).attr('src',$(this).attr('src')+Datetime.now());
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T02:11:20.317

这是特定于颜色框脚本的代码，它最终为我工作。我`onClosed:function(){ location.reload(true); }`在下面脚本的最后部分添加了：

```
<script>jQuery.noConflict();
  jQuery(document).ready(function(){
  jQuery("iframe").hide();
  });

  $('input').hide();
</script>

<script>
  jQuery(document).ready(function(){
  jQuery(".iframe").colorbox({iframe:true, width:"748px", height:"92%", onClosed:function(){ location.reload(true); } });
  });
</script> 
```

然后我在提交按钮代码中添加了 onClick 事件：

```
<input type='submit' value="Submit' onClick='parent.jQuery.fn.colorbox.close();'> 
```

这会在刷新父页面的同时关闭颜色框模式，以及所有当前版本的 FF、IE、Opera 和 Chrome 的图像。它刷新页面，但不刷新 Opera 中的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:27:17.953

图片很可能缓存在浏览器中，给您的图片控件一个 ID 并调用`window.parent.document.getElementID("image").src += "?" + [some random number, or maybe the miliseconds];`它会导致它返回服务器并重新加载图片。

**编辑**

更充实的脚本：

```
<script language="javascript" type="text/javascript">
  function onSubmitClick(){
    parent.jQuery("#img")[0].src += "?" + Math.floor(Math.random()*1001);
    //note the above will append a random number between 0 and 1000 to the src.
    parent.jQuery.colorbox.close()
  }
</script>

<input onClick='onSubmitClick();' type='submit' value='Submit' name='save_button' id='save_button'>
<img src="pic.jpg" id="img"> 
```

我还意识到我的建议中的一个失败之处是，当重新加载页面时，它只会再次从缓存中加载相同的图像。所以这个脚本是在没有页面刷新的情况下编写的。

# java - Android上Web上相同图像的不同大小

> ID：12164390
> 
> 赞同：2
> 
> 时间：2012-08-28T17:23:27.493
> 
> 标签：java, android, drawable

我有一个像 test.png 这样的图像。

我需要从网上购买该图像，并且在另一个位置我需要从可绘制对象中选择相同的图像。

问题是我在网络上和drawable中有相同的png。当我在可绘制对象中显示我拥有的图像时，它会以正确的大小显示，但是当我从网络上获取它时，它会显得更小。为了清楚起见，这只是我的问题的一个例子......我实际上并没有使用相同的图像，它们是不同的图像但具有相同的大小。为了验证，我在网络和可绘制对象上上传了同一张图片，发现同一张图片以不同的尺寸出现。我需要做什么才能使两者都出现在可绘制模式下？

我已经验证了这一点：

当我使用以下方法获得保存在 SD 卡中的图像时：

```
File sdCard = Environment.getExternalStorageDirectory();
Fle directory = new File(sdCard.getAbsolutePath());
File file = new File(directory, "teste.png");
File InputStream streamIn;
Bitmap bitmap = Bitmapfactory.decodeStream(streamin);
ImageView image = new ImageView(c);
image.setImageBitmap(bitmap); 
```

图像看起来比这种方式更大：

```
Drawable img = Drawable.createFromPath(new File(Environment.getExternalStorageDirectory(), "teste.png").getAbsolutePath());
ImageView image = new ImageView(c);
image.setImageDrawable(img); 
```

但在第一种模式下，它看起来比我使用 getResouces.getDrawable 直接从可绘制资源中获取图像时要小...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T20:06:17.943

我写了这段代码来重现错误：

```
LinearLayout ll = (LinearLayout) findViewById(R.id.root);

try {
    ImageView image = new ImageView(this);
    Bitmap bitmap = BitmapFactory.decodeStream(getAssets().open("tag-logo-android.png"));
    image.setImageBitmap(bitmap);
    ll.addView(image);

    image = new ImageView(this);
    Drawable drawable = Drawable.createFromStream(new URL("http://cdn.sstatic.net/stackoverflow/img/tag-logo-android.png").openStream(), null);
    image.setImageDrawable(drawable);
    ll.addView(image);
} catch (MalformedURLException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} 
```

问题不在于图像的来源。问题是`Drawable`忽略了屏幕密度。此代码有效：

```
LinearLayout ll = (LinearLayout) findViewById(R.id.root);

try {
    ImageView image = new ImageView(this);
    Bitmap bitmap = BitmapFactory.decodeStream(getAssets().open("tag-logo-android.png"));
    image.setImageBitmap(bitmap);
    ll.addView(image);

    image = new ImageView(this);
    bitmap = BitmapFactory.decodeStream(new URL("http://cdn.sstatic.net/stackoverflow/img/tag-logo-android.png").openStream());
    image.setImageBitmap(bitmap);
    ll.addView(image);
} catch (MalformedURLException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} 
```

在您的情况下，您可以使用：

```
bitmap = BitmapFactory.decodeFile(new File(Environment.getExternalStorageDirectory(), "test.png")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:02:54.553

也许您需要使用 Bitmap 对象而不是 Drawable 来解决您的问题。

# objective-c - 为 NSInvocationOperation 设置多个参数

> ID：12164400
> 
> 赞同：0
> 
> 时间：2012-08-28T17:24:08.500
> 
> 标签：objective-c, cocoa-touch, nsinvocationoperation

`-[NSInvocationOperation initWithTarget:selector:object:]`只接受一个对象作为将要调用的方法的参数传递。我想使用两个参数；我怎样才能做到这一点？

这是我的代码：

```
- (void)loadImage:(NSURL *)imageURL
{
    NSOperationQueue *queue = [NSOperationQueue new];
    NSInvocationOperation *operation = [[NSInvocationOperation alloc]
                                        initWithTarget:self
                                        selector:@selector(requestRemoteImage:)
                                        object:imageURL];
    [queue addOperation:operation];
}

- (void)requestRemoteImage:(NSURL *)imageURL
{
    NSData *imageData = [[NSData alloc] initWithContentsOfURL:imageURL];
    UIImage *image = [[UIImage alloc] initWithData:imageData];

    [self performSelectorOnMainThread:@selector(placeImageInUI:) withObject:image waitUntilDone:YES];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:26:41.750

您可以使用 NSInvocation 对象来初始化操作：

```
- (id)initWithInvocation:(NSInvocation *)inv 
```

（NSInvocation 可以处理多个参数）；或者您可以将所需的参数包装到 NSArray 或 NSDictionary，前提是它们是对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:39:01.593

[`invocation`](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/NSInvocationOperation_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40005505-RH2-SW9)在将操作添加到队列之前询问操作并对其进行修改。

```
 NSInvocation * invocation = [operation invocation];
 [invocation setArgument:&anotherObject atIndex:3];    
 // Indexes 0 and 1 are self and cmd, and you've already used index 2 
```

或者，[正如 Rob Napier 建议](https://stackoverflow.com/questions/12164400/how-can-i-use-more-than-one-argument-in-nsinvocationoperation/12164601#comment16279952_12164400)的那样，使用`NSBlockOperation`更加灵活和易于使用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-28T17:25:42.887

你可以发送一个包含所有你想要的值的字典

# ajax - 如何在 Rspec 中使用 Ajax 测试图像的删除

> ID：12164412
> 
> 赞同：0
> 
> 时间：2012-08-28T17:25:06.073
> 
> 标签：ajax, ruby-on-rails-3, testing, rspec

我在页面上有一个图像，我通过 Ajax 将其删除。

我想测试删除图像。

控制器：

```
def destroy

    current_image = Image.find(params[:id])
    current_car = current_image.car

    Image.delete_image_file(params[:id])    
    flash[:notice] = t('activerecord.errors.controllers.message.attributes.image.image_destroy_success')

    @images = current_car.images.order("order_id")

    respond_to do |format|
      format.html { redirect_to images_path(:car_id => params[:id]) }
      format.js
    end

  end 
```

文件 destroy.js.erb - 刷新视图并显示 Flash 消息

```
$('#image_list').html("<%= escape_javascript(render('list')) %>")
$('#div_flash_box').html("<%= escape_javascript(render :partial => 'layouts/flash', :locals => { :flash => flash }).html_safe %>") 
```

图像视图：_list.html.erb

```
<ul id="ul_images" data-update-url="<%= sort_images_url %>">  
  <% @images.each do |image| %>
    <%= content_tag_for :li, image, :class => 'ui-state-default' do %>     
     <%= link_to image_tag("#{RAILS_CAR_VIEW_IMAGES}" + "#{image.name}/" + image.image_thumb_file), "#{RAILS_CAR_VIEW_IMAGES}" + "#{image.name}/" + image.image_file, :class => 'group1' %>
     <div class="div-images-delete"><%= link_to t('views.buttons.delete'), image, :method => :delete, :remote => true, :confirm => t('views.forms.confirm') %></div>
    <% end %>
  <% end %>
</ul> 
```

我在 Rspec 中的测试

```
it "should delete an image using Ajax" do
  lambda do
    xhr :delete, :destroy, :id => @image.id
    response.should be_success
  end.should change(Image, :count).by(-1)  
end

it "should destroy image" do
   xhr :delete, :destroy, :format => "html"
   flash[:notice].should == I18n.t('activerecord.errors.controllers.message.attributes.image.image_destroy_success')
end 
```

汽车和图像有关系

```
class Image < ActiveRecord::Base
  belongs_to :car,
   :foreign_key => "car_id"

class Car < ActiveRecord::Base

  has_many :images 
```

失败：

1) 登录用户的 ImagesController 应该使用 Ajax Failure/Error 删除图像：xhr :delete, :destroy, :id => @image.id NoMethodError: undefined method `images' for nil:NilClass # ./app/controllers/images_controller.rb:32:in`destroy' # ./spec/controllers/images_controller_spec.rb: 36：在`block (4 levels) in <top (required)>' # ./spec/controllers/images_controller_spec.rb:35:in`块（3级）中'

2) 登录用户的 ImagesController 应该销毁图像失败/错误：xhr :delete, :destroy, :format => "html" ActionController::RoutingError: No route matches {:format=>"html", :controller=> "images", :action=>"destroy"} # ./spec/controllers/images_controller_spec.rb:42:in `block (3 levels) in '

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:55:14.337

第一个错误是因为您尝试删除的图像没有关联的汽车。听起来您在为此测试创建数据时忘记创建汽车。

另一个错误是因为您错过了`id`测试中的参数：

```
xhr :delete, :destroy, :format => "html" 
```

应该

```
xhr :delete, :destroy, :id => @image.id, :format => "html" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:43:34.123

对于第一个错误，我认为`current_car`测试环境中没有设置对象。这`.images`就是调用时出现 NilClass 错误的原因。

# c# - 如何统一 -centralize- 管理来自具有不同 CustomEventArgs 的提供者的事件

> ID：12164414
> 
> 赞同：0
> 
> 时间：2012-08-28T17:25:17.323
> 
> 标签：c#, design-patterns

我正在使用几个实现相同接口的不同*提供程序*，通过对象工厂实例化和访问它们。

我从这些附加到事件的不同提供者那里获取数据。这些提供者中的每一个都有自己的 CustomEventArgs，这在提供者之间有所不同......

您能否建议一种以“集中”方式管理事件（使用不同的 eventArgs）的方法？像投射事件之类的东西？以防万一我想对事件始终执行相同的行为，例如将字符串属性分配给 IU 上的标签。

*   我是否可以实现类似中间类的东西来监听多个事件（使用不同的 eventArgs），然后 onEvent 可以使用 MyOwnEventArgs 引发一个新的 MyEvent，其中包含来自提供者的几个 CustomEventArgs 的所有特定属性的总和？这有优势吗？

*   我可以实现类似中间类的东西来监听几个事件（使用不同的 eventArgs），然后 onEvent 可以引发一个新的 MyEvent，其中 MyOwnEventArgs 只包含一个 IDictionary 属性，其中每个 Item 包含所有特定属性的名称和值来自提供商的几个 CustomEventArgs？这有优势吗？

*   有没有其他方法可以轻松地从几个 CustomEventArgs 中读取“不同”属性（不同的属性名称）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:23:00.460

听起来很适合适配器模式将所有不同的事件类转换为您自己的事件类。

如果提供者正确地遵循事件模式，您将在`source`参数中获得提供者。

所以你可以做这样的事情：

```
interface IEventAdapter
{
    CustomEventArgs Transform(EventArgs E);
}

public class EventListener
{
    Dictionary<Type, IEventAdapter> _adapters;

    public void Map(Type providerType, IEventAdapter adapter)
    {
        _adapters.Add(providerType, adapter);
    }

    public void Subscribe(IProvider provider)
    {
        //hook event
    }

    protected void OnEvent(object source, EventArgs e)
    {
        var theArgs = _adapters[source.GetType()].Adapt(e);
        TheEvent(source, theArgs);
    }

    public EventHandler<CustomEventArgs> TheEvent;
} 
```

# c# - 在 silverlight .NET 中要上传（附加）的文件的大小

> ID：12164417
> 
> 赞同：0
> 
> 时间：2012-08-28T17:25:24.460
> 
> 标签：c#, .net, silverlight

我正在 Silverlight 中制作附件组件，并且想知道他们是否在 Silverlight .NET 中有一个 api，或者在我开始上传文件之前知道文件大小的方法。Gmail之类的...

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:08:38.410

```
OpenFileDialog ofd = new OpenFileDialog();
const int megaSize = 1024000;
            if (ofd.File.Length > megaSize)
                ShowError("Can not upload images with this size."); 
```

希望能帮助到你

# java - 一个 ArrayList 与另一个 Arraylist 的差异同步（添加、删除但不覆盖）

> ID：12164421
> 
> 赞同：2
> 
> 时间：2012-08-28T17:25:54.743
> 
> 标签：java, arraylist

新数据：

```
ArrayList<Comment> newComments =  getComments(); 
```

已经存在的数据，已经填写了一些数据：

```
ArrayList<Comment> oldComments 
```

我不能用新内容覆盖整个旧内容。

我希望将新的（尚未存在的）`Comment`对象`newComments`添加到 中`oldComments`，也希望将缺少的那些`newComments`从 中删除`oldComments`。

`Collections`包装中有一些好的方法吗？或任何其他方式？

注意：`Comment`类有自定义`compare()`方法（不使用 default `equals()`）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:34:00.267

A`java.util.Set`更适合您的用例。然后你可以这样做：

```
oldComments.retainAll(newComments);
oldComments.addAll(newComments); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:33:50.437

您可以使用[`CollectionUtils`](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html)来自 Apache 的基础和`union()`方法。

请注意，您需要确保`Comment`该类覆盖该`equals()`方法以确保具有有效的联合，而不是两个列表的串联。

# php - 在适当的上下文中隔离字符串的正则表达式

> ID：12164424
> 
> 赞同：0
> 
> 时间：2012-08-28T17:26:04.020
> 
> 标签：php, regex, string, parsing

所以，我有一个我正在编写的仪表板（PHP）。这个想法是它应该在数据库中显示相对于指定给定 url 的数据。如果用户只想抓取所有东西，他们只需要指定“全部”。如果他们希望抓取特定 URL 的数据并一次显示所有内容，他们将使用“all”指令指定其他*URL*。

然而，我发现了一个错误。

如果我有一个 URL 中包含字符“all”（例如，`http://everythingallatonce.com`<-- 这只是一个示例 - 我不知道它是否真的存在），那么采用给定指令的仪表板解析算法将不会好好工作。事实上，按照这个逻辑，它会认为用户指定了一个给定的 URL 以及“all”这个词，而没有真正勾选“perform scrape?”。复选框，这根本没有意义（因此，它只是抛出异常/死亡并显示错误消息）。

到目前为止，我只有一个如下功能：

```
function _strExists( $needle, $haystack )
{
     $pos = strpos( $haystack, $needle );

     return ( $pos !== false );
} 
```

我用它来检测查询中是否存在“all”一词，如下所示：

`$fetchEverything = _strExists('all', $urls);`

**对于这样的事情，有什么好的解决方法可以避免指定的包含“all”的 URL 与*all*本身的实际查询之间的歧义？**我正在考虑正则表达式，但我不确定......

**还**

我考虑过只使用`*`，但如果可能的话，我想避免这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:34:15.087

如果在 URL 中传递了某个值`all`（即 all=1）。然后你应该在`$_GET`超全球中寻找它的存在（即`$_GET['all']`）

# iphone - 使用 Google 地图的 iOS 商店定位器

> ID：12164427
> 
> 赞同：0
> 
> 时间：2012-08-28T17:26:13.537
> 
> 标签：iphone, ios, google-api

我希望将“商店定位器”添加到一个简单的 iOS 应用程序中。

理想情况如下...

*   用户将输入他们的邮政编码。
*   地图将显示该邮政编码半径范围内的商店位置
*   这些位置将存储在 Google Places 帐户中（如果更简单，我不介意这些位置是否存储在应用程序代码中。）
*   结果可以显示在地图或列表视图上，或两者兼而有之。（没有偏好）

有谁知道如何做到这一点？或者我可以遵循的教程？

我已经搜索了一段时间，但我找不到一个像样的教程来完成这项工作。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T22:27:17.187

以下是我将如何处理这个问题：

1) 下载您的商店列表。

2）向他们询问邮政编码/地址，然后对其进行地理编码以检索经度和纬度坐标。

3）在地图上显示经度/纬度，以及您的商店。然后他们可以看到离他们最近的东西。

4) 由于您已经下载了商店，最好为每个商店使用 long/lat，然后您可以计算到商店的距离并在列表中以升序方式对它们进行排序，从而首先显示最近的商店。

# java - 无法让休眠在 Spring Web Flow 项目中工作

> ID：12164429
> 
> 赞同：0
> 
> 时间：2012-08-28T17:26:33.600
> 
> 标签：java, spring, hibernate, spring-webflow, hibernate-search

我正在尝试在 Spring Web Flow 项目中使用休眠，但出现以下错误。我一直在看这个，不知道为什么我会收到错误

这是我的 database.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"

       xsi:schemaLocation="http://www.springframework.org/schema/beans 
                            http://www.springframework.org/schema/beans/spring-beans.xsd
                            http://www.springframework.org/schema/context 
                            http://www.springframework.org/schema/context/spring-context-3.0.xsd
                            http://www.springframework.org/schema/tx
                            http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
                            http://www.springframework.org/schema/jdbc
                            http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd">

  <context:property-placeholder location="classpath:jdbc.properties" />

  <context:component-scan base-package="org.uftwf" />

  <tx:annotation-driven transaction-manager="hibernateTransactionManager"/>

    <bean id="dataSource"
        class="org.apache.commons.dbcp.BasicDataSource">
        <property name="driverClassName" value="${database.driver}" />
        <property name="url" value="${database.url}" />
        <property name="username" value="${database.user}" />
        <property name="password" value="${database.password}" />
        <property name="timeBetweenEvictionRunsMillis" value="300000" />
        <property name="numTestsPerEvictionRun" value="6" />
        <property name="minEvictableIdleTimeMillis" value="1800000" />
        <property name="initialSize" value="3" />
        <property name="maxActive" value="10" />
        <property name="maxIdle" value="10" />
        <property name="maxWait" value="5000" />
        <property name="poolPreparedStatements" value="true" />
       <property name="maxOpenPreparedStatements" value="100" />
    </bean>

    <bean id="sessionFactory"
        class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="annotatedClasses">
            <list>
                <value>org.uftwf.schoolvisit.model.VisitModel</value>
            </list>
        </property>

        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect">${hibernate.dialect}</prop>
                <prop key="hibernate.show_sql">${hibernate.show_sql}</prop>             
            </props>
        </property>
    </bean>

    <bean id="hibernateTransactionManager"
        class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>
</beans> 
```

这是我的错误：有人可以告诉我为什么

```
2012-08-28 13:20:08,222 [localhost-startStop-1] ERROR org.springframework.web.context.ContextLoader - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'database': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire field: private org.hibernate.SessionFactory org.uftwf.schoolvisit.database.DatabaseImpl.sessionFactory; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/spring/database.xml]: Invocation of init method failed; nested exception is java.lang.IncompatibleClassChangeError: Implementing class
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor.postProcessPropertyValues(AutowiredAnnotationBeanPostProcessor.java:287)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:585)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4791)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5285)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)
    at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:650)
    at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1582)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
    at java.util.concurrent.FutureTask.run(FutureTask.java:166)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679) 
```

这是我的文件：

```
activation-1.1.jar
antlr-2.7.6.jar
aopalliance-1.0.jar
asm-3.1.jar
asm-attrs-1.5.3.jar
aspectjrt-1.6.8.jar
aspectjweaver-1.6.8.jar
cas-client-core-3.2.1.jar
cglib-2.2.jar
commons-beanutils-1.8.0.jar
commons-codec-1.4.jar
commons-collections-3.1.jar
commons-dbcp.jar
commons-digester-1.8.1.jar
commons-email-1.0.jar
commons-fileupload-1.1.1.jar
commons-io-1.1.jar
commons-lang-2.5.jar
commons-logging-1.1.1.jar
commons-pool.jar
dom4j-1.6.1.jar
dumbster-1.6.jar
ehcache-1.2.3.jar
files.txt
hibernate-3.2.6.ga.jar
hibernate-annotations-3.5.0-Final.jar
hibernate-commons-annotations-3.2.0.Final.jar
hibernate-core-3.5.0-Final.jar
hibernate-entitymanager-3.5.0-Final.jar
hibernate-jpa-2.0-api-1.0.0.Final.jar
hibernate-search-3.0.0.GA.jar
hibernate-validator-4.0.2.GA.jar
hsqldb-1.8.0.10.jar
httpclient-4.1.2.jar
httpclient-cache-4.1.2.jar
httpcore-4.1.2.jar
httpmime-4.1.2.jar
icu4j-2.6.1.jar
jackson-core-asl-1.5.3.jar
jackson-mapper-asl-1.5.3.jar
javassist-3.9.0.GA.jar
jaxb-api-2.1.jar
jaxb-impl-2.1.3.jar
jaxen-1.1.1.jar
jcl-over-slf4j-1.5.10.jar
jdom-1.0.jar
joda-time-1.6.jar
joda-time-jsptags-1.0.2.jar
jstl-1.2.jar
jta-1.1.jar
list.txt
log4j-1.2.15.jar
lucene-core-2.3.2.jar
lucene-highlighter-2.0.0.jar
mail-1.4.jar
mysql-connector-java-5.0.5.jar
org.springframework.aop-3.1.1.RELEASE.jar
org.springframework.asm-3.1.1.RELEASE.jar
org.springframework.aspects-3.1.1.RELEASE.jar
org.springframework.beans-3.1.1.RELEASE.jar
org.springframework.binding-2.3.1.RELEASE.jar
org.springframework.context-3.1.1.RELEASE.jar
org.springframework.context.support-3.1.1.RELEASE.jar
org.springframework.core-3.1.1.RELEASE.jar
org.springframework.expression-3.1.1.RELEASE.jar
org.springframework.faces-2.3.1.RELEASE.jar
org.springframework.instrument-3.1.1.RELEASE.jar
org.springframework.instrument.tomcat-3.1.1.RELEASE.jar
org.springframework.jdbc-3.1.1.RELEASE.jar
org.springframework.jms-3.1.1.RELEASE.jar
org.springframework.js-2.3.1.RELEASE.jar
org.springframework.js.resources-2.3.1.RELEASE.jar
org.springframework.orm-3.1.1.RELEASE.jar
org.springframework.oxm-3.1.1.RELEASE.jar
org.springframework.test-3.1.1.RELEASE.jar
org.springframework.transaction-3.1.1.RELEASE.jar
org.springframework.web-3.1.1.RELEASE.jar
org.springframework.webflow-2.3.1.RELEASE.jar
org.springframework.web.portlet-3.1.1.RELEASE.jar
org.springframework.web.servlet-3.1.1.RELEASE.jar
org.springframework.web.struts-3.1.1.RELEASE.jar
persistence-api-1.0.jar
quartz-1.5.2.jar
slf4j-api-1.5.10.jar
slf4j-log4j12-1.5.10.jar
spring-security-cas-3.1.0.RELEASE.jar
spring-security-config-3.0.3.RELEASE.jar
spring-security-config-3.1.0.RELEASE.jar
spring-security-core-3.1.0.RELEASE.jar
spring-security-crypto-3.1.0.RELEASE.jar
spring-security-ldap-3.1.0.RELEASE.jar
spring-security-openid-3.1.0.RELEASE.jar
spring-security-remoting-3.1.0.RELEASE.jar
spring-security-taglibs-3.1.0.RELEASE.jar
spring-security-web-3.1.0.RELEASE.jar
spring-tx-3.0.5.RELEASE.jar
stax-api-1.0-2.jar
tiles-api-2.1.3.jar
tiles-core-2.1.3.jar
tiles-jsp-2.1.3.jar
tiles-servlet-2.1.3.jar
urlrewritefilter-3.1.0.jar
validation-api-1.0.0.GA.jar
xalan-2.6.0.jar
xml-apis-1.3.02.jar
xmlParserAPIs-2.6.2.jar
xom-1.0.jar 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:44:15.997

我怀疑您的类路径中可能有多个版本的 Spring。有关 IncompatibleClassChangeError 的更多信息，请参见此处：

[http://docs.oracle.com/javase/specs/jls/se5.0/html/binaryComp.html](http://docs.oracle.com/javase/specs/jls/se5.0/html/binaryComp.html)

# html - 如何沿画布中的自定义路径为对象设置动画？

> ID：12164433
> 
> 赞同：2
> 
> 时间：2012-08-28T17:27:12.817
> 
> 标签：html, canvas

我在 Illustrator 中创建了一系列路径（带有曲线点）。如何让我的圈子跟随 Canvas 中的这些路径？

我可以通过 svg -> canvas 转换器将路径设置为一条线，但这并不能帮助我为这条线的任何内容设置动画。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:01:19.583

我建议检查类似[CAAT.js](http://labs.hyperandroid.com/static/caat/)的内容。第一个演示几乎完全符合您的要求。

[CAAT.js 跟随路径演示](http://labs.hyperandroid.com/static/CAAT-Samples/demos/demo1/path.html)

# css - 在更改浏览器宽度时消失背景图像

> ID：12164436
> 
> 赞同：3
> 
> 时间：2012-08-28T17:27:21.487
> 
> 标签：css, background

我有一个带有 2 个背景图像的侧边栏。这是我的 CSS：

```
background-color: #fff;
background-image: url('img/back-1.png'), url('img/back-2.png');
background-position: left top, left top;
background-repeat: no-repeat, repeat-y;
background-size: 100% auto, 100% auto; 
```

当我用鼠标更改浏览器的宽度时（我使用响应式设计），第二张图片会在某个位置消失。但是，如果我刷新页面或更改宽度，一切都会恢复。你知道为什么图像会消失吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T09:05:16.077

我有一个类似的问题，
我做了 2 类 CSS，
用 JavaScript 检测浏览器宽度，用 JavaScript
将右边的类附加到类；

# ruby-on-rails - Rails - 我怎样才能只运行黄瓜测试？

> ID：12164446
> 
> 赞同：2
> 
> 时间：2012-08-28T17:28:07.337
> 
> 标签：ruby-on-rails, ruby, testing, cucumber, rake

我可以运行所有模型`rake:models`

有什么选择可以为黄瓜测试而不是仅仅`rake`运行所有级别的所有测试？

我试过：

```
$ rake spec:cucumber
rake aborted!
Don't know how to build task 'spec:cucumber' 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-28T17:31:33.683

你应该能够运行`rake cucumber`

`rake -T`节目的快速输出：

```
rake cucumber                          # Alias for cucumber:ok
rake cucumber:all                      # Run all features
rake cucumber:ok                       # Run features that should pass
rake cucumber:rerun                    # Record failing features and run only them if any exist
rake cucumber:wip                      # Run features that are being worked on 
```

# c++ - 使用管道后如何将 std::cin 恢复到键盘？

> ID：12164448
> 
> 赞同：2
> 
> 时间：2012-08-28T17:28:10.490
> 
> 标签：c++, c++11

有问题的代码：

```
#include <array>
#include <iostream>
#include <cstring>

int main(int argc, char *argv[])
{
    using namespace std;

    cout << "Read from file:" << endl;

    while (!cin.eof())
    {
        array<char, 16> l_array;
        cin.read(l_array.data(), l_array.size());
        cout.write(l_array.data(), cin.gcount());
    }

    cout << endl;
    cout << "Read from keyboard:" << endl;

    cin.rdbuf(cout.rdbuf());

    while (!cin.eof())
    {
        array<char, 64> l_array;
        memset(l_array.data(), 0, l_array.size());
        cin.read(l_array.data(), l_array.size());

        cout << "===== DATA =====" << endl;
        cout << l_array.data() << endl;
        cout << "================" << endl;
    }
} 
```

这就是我运行程序的方式：

```
./application < file.txt 
```

我可以毫无问题地从管道读取数据，但是当我想再次读取它时，它仍然与管道相关联。我不知道如何切换回来。我找到了可以改变它的“rdbuf”函数，但我不知道如何使用它。

我仅在您开始使用键盘切换到文件并返回到键盘时才找到示例。

喜欢这里：[http ://www.cplusplus.com/reference/iostream/ios/rdbuf/](http://www.cplusplus.com/reference/iostream/ios/rdbuf/)

但是我没有记住streambuf，所以我不能像他们那样做。我想编写可以从文件中读取大部分数据的程序，并且仅在缺少某些内容时询问，或者只是在运行时询问用户许可或其他内容。全部在linux下的console里面。

@EDIT 谢谢你的帮助，我发布解决方案

```
class RedirectCinToConsole
{
    protected:
        std::ifstream m_console;
        std::streambuf *m_oldCin;
        bool m_success;

    public:
        RedirectCinToConsole() :
            m_oldCin(0),
            m_success(false)
        {
            m_console.open("/dev/tty");

            if (m_console.is_open())
            {
                m_success = true;
                m_oldCin = std::cin.rdbuf(m_console.rdbuf());
            }
        }
        virtual ~RedirectCinToConsole()
        {
            if (m_oldCin)
            {
                std::cin.rdbuf(m_oldCin);
            }
            m_console.close();
        }

        operator bool () const { return m_success; }
};

int main()
{
    RedirectCinToConsole l_redirect;
    if (l_redirect)
    {
        std::string l_helloWorld;
        std::cin >> l_helloWorld;
        std::cin.ignore();

        std::cout << l_helloWorld;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T18:13:43.050

我突然想到，不管提出的解决方案如何，最简单的解决方案（也可能是最好的）将做相反的事情：不要重定向输入，而是将文件名传递给程序，然后让它打开`std::ifstream`一个阅读它，保持`std::cin`免费的交互式输入。

Ben Voigt 提出了标准的 Unix 解决方案，但仔细想想，上面的方法似乎更自然；它当然更容易，更便携。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T17:31:58.333

也许您应该使用`fstream`创建自己的流并要求提供文件名或将文件名作为命令行参数。这将使`cin`其他输入操作可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:32:12.513

尝试打开`/dev/tty`。这将是您的进程的关联控制台（如果有）。如果您的进程是从守护进程启动的，它可能会失败。

# jquery - 查找 jquery 文件的 html

> ID：12164451
> 
> 赞同：-3
> 
> 时间：2012-08-28T17:28:25.807
> 
> 标签：jquery, html

我有三个大问题，为此我已经打开了两个主题。这是我的最后一期，对你这样的人来说很容易，但对我这样的人来说肯定不容易（我不知道 jquery 什么的）......

所以，这就是问题所在：我有一个（工作？）脚本，但我不能使用它，因为我没有它的 HTML 代码。您能否通过提供此代码来帮助我？提前感谢小伙子们！

仅供参考：这是一个名为“Modalpreview”的下载脚本，但下载的文件夹中没有 HTML 文件。

```
 (function($){

var $defaults = {
    fade:      'fast',
    allowHtml: false,
    opacity:   '0.7',
    text:      {
        preview: 'Preview',
        close:   'Close'
    }
};

var $o = $.extend($defaults, $options);

var _o = $(document.createElement('div')).css({
    display: 'none',
    opacity: $o.opacity
}).attr('id','overlay');

$('body').append(_o);

return this.each(function(){

    var _c = $(this);
    var _f = $(this).parents('form');
    var _b = _f.find('input[type=submit]');
    var _t = $(document.createElement('div')).addClass('preview_txt');
    var _h = $(document.createElement('p')).addClass('preview_header').text($o.text.preview+':');
    var _k = $(document.createElement('div')).addClass('preview_inputwrapper');
    var _d = $(document.createElement('div')).addClass('preview_div').css({
                display:'none'
             });
    var _p = $(document.createElement('input')).attr({
                 value:$o.text.preview,
                 type: 'button'
             }).addClass('preview_btn');
    /*
    var _s = _b.clone(true).click(function() {
        _f.find('*[name=submit]').attr('name','_submit');
        _f.submit();
    });
    */
    var _e = $(document.createElement('input')).attr({
                 value:$o.text.close,
                 type: 'button'
             }).addClass('edit_btn');
    _k.append(_e);
    _d.append(_h).append(_t).append(_k);
    _o.after(_d);
    _p.click(function() {
        if (_c.val().length < 1) {
            return;
        }
        _o.fadeIn($o.fade);
        var _i = (!$o.allowHtml) ? $$.removeTags(_c.val()) : _c.val();
        _t.html($$.parse(_i));
        _e.click(function() {
            _o.fadeOut($o.fade);
            _d.fadeOut($o.fade,function() { _t.empty(); });
            _c.focus();
        });
        _d.fadeIn($o.fade);
    });
    _b.before(_p);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:13:39.290

下载了插件后（来自：[这里](http://webscripts.softpedia.com/script/Modal-Windows/Modalpreview-61456.html)[从软百科的镜像下载，插件主页已经没有了]），我想出了如何使用它。

您的文本区域需要位于 中`form`，并且`form`需要有一个`submit`按钮。

因此，“缺少的 HTML”应该是：

```
<form>
    <textarea></textarea>
    <input type="submit" value="submit" />
<form>​​​​​​​​​​​​​​​​​​​​​​​ 
```

然后启用此功能的 jQuery 是：

```
$('form textarea').modalpreview(); 
```

演示：http: [//jsfiddle.net/TqTXA/](http://jsfiddle.net/TqTXA/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:35:39.997

根据您使用的浏览器 -

1.  [右键单击并“检查元素”](https://developers.google.com/chrome-developer-tools/docs/elements)以获取 chrome。
2.  [IE 的开发者工具](https://superuser.com/questions/43653/whats-ie8-equivalent-of-chrome-and-firefox-firebug-inspect-element)。
3.  [FF 的萤火虫](http://getfirebug.com/downloads)。
4.  每个其他（现代）浏览器也有[FirebugLite](http://getfirebug.com/firebuglite)。

# python - 如何在 Django 的后端会话中存储对象，就像 Django 存储用户一样

> ID：12164453
> 
> 赞同：7
> 
> 时间：2012-08-28T17:28:27.553
> 
> 标签：python, django, django-views

我正在 Django 中创建一个 webapp。[我已经浏览了来自https://docs.djangoproject.com/en/dev/intro/](https://docs.djangoproject.com/en/dev/intro/)的Django 教程和部分文档

我有一个问题，如何在服务器端的请求之间存储额外的数据。Django 对用户真的很酷，如下所示：

在views.py中：

```
def login_user(request):
    if request.POST:
        username = request.POST.get('username')
        password = request.POST.get('password')

        user = authenticate(username=username, password=password)
        if user is not None:
            if user.is_active:
                login(request, user)
                return HttpResponseRedirect(settings.LOGIN_REDIRECT_URL) 
```

现在在另一个函数中，您可以使用存储在后端的信息，这些信息通过 csrf 令牌关联，如下所示：

在views.py中

```
@login_required
def myappformmethod(request):
    user = request.user
    msg = 'hello '+user.username 
```

生成的 html 文件不包含有关已登录用户的任何直接信息，但它将 csrf 令牌保留为表单字段：

```
<form name="myform" action="/myapp/myappformmethod" method="post" onsubmit="prepare()">
<div style='display:none'><input type='hidden' name='csrfmiddlewaretoken' value='NwKW2lFWSkkNEasdd3ExHe1l5ltzQi' /></div> 
```

我想存储一些与会话相关的数据（例如最喜欢的颜色），这些数据在 html 中不可见，但将存储在服务器端，并且可以使用类似的东西：

```
if request.favourite_color:
    color = request.favourite_color 
```

并且不使用

```
if request.POST.get('favourite_color'):
    request.POST.get('favourite_color') 
```

这很容易受到手动表单元素操作的影响（如果使用表单字段 [type:hidden 没有帮助，因为您也可以编辑它们]）

适当的方法是在请求中添加字段并产生类似于前面提到的“登录”方法的东西......但是怎么做呢？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-28T17:30:56.197

您正在寻找的功能称为“会话”，由 Django 直接支持：

[https://docs.djangoproject.com/en/dev/topics/http/sessions/](https://docs.djangoproject.com/en/dev/topics/http/sessions/)

...这是该页面中的两个示例：

```
request.session['fav_color'] = 'blue'

fav_color = request.session['fav_color'] 
```

# c - Compiler warning "result of malloc is converted to a point incompatible with sizeof operand type"

> ID：12164455
> 
> 赞同：4
> 
> 时间：2012-08-28T17:28:28.607
> 
> 标签：c, malloc, compiler-warnings

I have these defined in the interface of an ObjC class:

```
unsigned m_howMany;
unsigned char * m_howManyEach;
... 
```

Then later in the code I have this:

```
 m_howManyEach = malloc(sizeof(unsigned) * m_howMany); 
```

which is where I get a warning "Result of malloc is converted to a pointer of type unsigned char, which is incompatible with sizeof operand type unsigned int"

Could someone please explain the proper use of `malloc()` in this situation, and how to go about getting rid of the warning?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:31:00.470

here's your problem:

```
sizeof(unsigned) 
```

the compiler interprets "unsigned" as "unsigned int", you should specify "unsigned char" like this:

```
m_howManyEach = malloc(sizeof(unsigned char) * m_howMany); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T17:32:35.237

First, `unsigned` is really `unsigned int`.

The compiler is being nice to you, telling you that you are allocating N items of unsigned, which is not `unsigned char`.

Also, your later access will be wrong as well.

Change

```
unsigned char * m_howManyEach; 
```

to

```
unsigned * m_howManyEach; 
```

because it looks like you really want `unsigned int` as your type instead of `unsigtned char`.

Of course, this assumes you really want unsigned integers, and not 1-byte unsigned chars.

If the actual size of your integral values is important, you should consider the sized valued (uint8_t, uint16_t, uint32_t, uint64_t).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T17:32:11.323

It's weird you are sizing your array based on `unsigned int` size instead of `unsigned char` one.

```
m_howManyEach = malloc(sizeof(unsigned char) * m_howMany); 
```

# java - AppEngine 上的繁重处理

> ID：12164456
> 
> 赞同：0
> 
> 时间：2012-08-28T17:28:32.447
> 
> 标签：java, javascript, google-app-engine

以下是在 java 中运行 Javascript 的简单方法：

```
ScriptEngineManager mgr = new ScriptEngineManager();
  ScriptEngine jsEngine = mgr.getEngineByName("JavaScript");
  try {
    jsEngine.eval("print('Hello, world!')");
  } catch (ScriptException ex) {
      ex.printStackTrace();
  } 
```

问题是，如果我用 AppEngine 运行它（也许更大的 JS 可能需要很长时间才能完成），是否会有关于平台施加的处理时间限制的任何问题（在前端过程中） ，我应该在不会终止的 AppEngine 进程上运行它吗？到后端？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:09:06.333

是的，前端处理有非常严格的时间限制。您必须在后端执行此处理或使用任务队列任务来启动操作。任务队列任务有 10 分钟的时间限制。

但坦率地说，我建议不要为此目的使用 App Engine。您的 javascript 代码在 node.js 中的运行速度可能比在 Java 解释器中快得多。找到可以托管 node.js 的服务，并在该服务上运行应用程序的这一部分。您可能需要更少的实例时间并通过这种方式节省一大笔钱。

# android - 使透明画布不透明（尝试在 Android 中通过拖放覆盖默认的 DragShadow 外观）

> ID：12164457
> 
> 赞同：5
> 
> 时间：2012-08-28T17:28:43.663
> 
> 标签：android, drag-and-drop

拖动阴影的默认外观和位置是过去的视图，使其透明并以您的触摸为中心。我希望它看起来坚固，并且从您的触摸开始视图。

我已经下降了 DragShadowBuilder 并覆盖了“onProvideShadowMetrics”和“onDrawShadow”。我已经得到了我想要的定位，但我不知道如何关闭透明。

这是创建我的 dragShadowBuilder 和 dragShadowBuilder 类的调用的触摸侦听器：

```
private OnTouchListener onTouchListener = new OnTouchListener() {

    @Override
    public boolean onTouch(View v, MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_DOWN) {
            Item current = (Item) ((View) v.getTag()).getTag();
            //ClipData data = ClipData.newPlainText("test", "testText");
            View dragView = (View) v.getTag();//the on touch view is just the "grid" image.  It holds the whole view in it's tag
            DragShadowBuilder shadowBuilder = new ItemDragShadowBuilder(dragView, 
                                new Point(v.getWidth()/2, v.getHeight()/2));
            v.startDrag(null, shadowBuilder, current, 0);
            dragView.setVisibility(View.INVISIBLE);
            return true;
        } else {
            return false;
        }       
    }

};

private static class ItemDragShadowBuilder extends View.DragShadowBuilder {

    private Point touchPoint = null;
    private Point sizePoint = null;
    private View dragView = null;

    public ItemDragShadowBuilder(View dragView, Point touchPoint) {
        super();
        sizePoint = new Point(dragView.getWidth(), dragView.getHeight());
        this.touchPoint = touchPoint;
        this.dragView = dragView;
    }

    @Override
    public void onProvideShadowMetrics (Point size, Point touch) {
        size.set(sizePoint.x, sizePoint.y);
        touch.set(touchPoint.x,touchPoint.y);
    }

    @Override
    public void onDrawShadow(Canvas canvas) {
        dragView.draw(canvas);
        //How do I change the transparency?
        //super.onDrawShadow(canvas);
    }

} 
```

这是我当前的屏幕，其中有一个项目被拖动：

![我当前的屏幕](../Images/4f48eb4b96077221dffc989e49cca54e.png)

注意透明的外观。当您长按订阅并选择“重新订购”时，我希望它看起来类似于下面的 Google Current 应用程序。您会注意到视图看起来很坚固。

![谷歌潮流](../Images/ee2ff14be85c2b97bbafafdc48a2455e.png)

我怎样才能使我的拖动阴影变得坚实？

# c++ - 指针和面向对象编程

> ID：12164459
> 
> 赞同：2
> 
> 时间：2012-08-28T17:28:53.157
> 
> 标签：c++, oop, pointers, responsibility

指针如何与面向对象编程的概念一起工作？

据我了解（请承认，我被归类为 ID-10T），OOP 的主要原则是包含在类中并保持管理责任（内存/实现/等）；但是当一个对象的方法返回一个指针时，我们似乎在“*弹出*”这个对象。现在，有人可能需要担心：

1.  他们*应该*删除指针的关联对象吗？
2.  但是如果类仍然需要这个对象呢？
3.  他们可以改变对象吗？如果是这样，怎么做？（我知道`const`可能会解决这个问题）
4.  等等……

似乎该对象的用户现在需要更多地*了解*该类的工作方式以及该类对用户的期望。感觉就像是“猫从袋子里出来”的场景，似乎是在打 OOP 的耳光。

注意：我注意到这是一个独立于语言的问题；但是，在 C++ 环境中工作时，系统提示我提出这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T17:56:29.903

What you describe are ownership issues. These are orthogonal (i.e. independent, you can have either without the other or even both) to object orientation. You have the same issues if you do not use OOP and juggle pointers to POD structs. You don't have the issue if you use OOP but solve it somehow. You can (try to) solve it using more OOP or in another way.

They are also orthogonal to the use of pointers (unless you nit pick and extend the definition of pointer). For example, the same issues arise if two separate places hold indices into an array and mutate, resize and ultimately delete the array.

In C++, the usual solution is to select the right smart pointer type (e.g. return a shared pointer when you wish to share the object, or a unique pointer to signify exclusive ownership), along with extensive documentation. Actually, the latter is a key ingredient in *any* language.

One OOP-*related* thing you can do to help this is encapsulation (of course, you can have encaptulation just fine without OOP). For instance, don't expose the object at all, only expose methods which query the object under the hood. Or don't expose raw pointers, only expose smart pointers.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:01:11.677

对于初学者......你不能没有指针或引用的多态性。在 C++ 中，传统上，对象是被复制的，并且（在大多数情况下）具有自动存储持续时间。但是复制不适用于多态对象——它们往往会被切片。而 OO 也常常意味着身份，这反过来又意味着你不想要复制。所以解决方案是动态分配对象，并传递指针。你用它们做什么是设计的一部分：

如果对象在逻辑上是另一个对象的一部分，则该对象对其生命周期负责，并且接收指针的对象应采取措施确保在拥有对象消失后它们不使用它。（请注意，即使在具有垃圾收集的语言中也是如此。只要您有指向它的指针，该对象就不会消失，但是一旦拥有的对象无效，拥有的对象也可能变得无效。事实垃圾收集器不会回收内存并不能保证您指向的对象是可用的。）

如果对象本身是第一类实体，而不是逻辑上另一个对象的一部分，那么它可能应该照顾自己。同样，如果它不再存在（或变得无效），则必须通知可能持有指向它的指针的其他对象。观察者模式的使用是通常的解决方案。当我开始 C++ 时，有一种“关系管理”的时尚，有一些管理类，你可以在其中注册关系，据说可以确保一切正常。在实践中，它们要么不起作用，要么只做简单的观察者模式，而且你今天再也听不到它们了。

在大多数情况下，您的精确问题是每个类必须为其每个功能建立的契约的一部分。对于真正的 OO 类（实体对象），您可能永远不应该删除它们：那是业务，而不是您的业务。但也有例外：如果你在处理事务，例如，一个被删除的对象不能回滚，所以当一个对象决定删除自己时，它通常会向事务管理器注册这个事实，事务管理器会将它作为一部分删除提交后，一旦确定回滚就没有必要了。至于改变对象，那是合约的问题：在很多应用程序中，都有映射对象，用于将某种外部标识符映射到对象。通常，目标是能够修改对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:38:16.923

根据我的理解和经验，它通常围绕着你正在尝试做的事情以及*使用*指针的语言（例如 C++ 与 Objective-C）。

但是，通常，在 C++ 术语中，我发现最好`std::shared_ptr`通过引用（甚至可能是`const`引用，取决于情况）返回对智能指针（例如 ）的引用，或者只是将指针隐藏在类中，如果它需要被它之外的东西访问或使用，请使用 getter 方法，该方法要么复制指针并返回它，要么返回对指针的引用（授予，AFAIK ref-to-ptr 只能在 C++ 中实现） . 如果有人不知道在大多数情况下您*不应该*删除 ref-to-ptr（当然，如果它的释放是由类内部处理的），那么您真的应该三思而后行，看看他们是否准备好在你的团队中做 C++ 的事情。

如果类成员可以被堆栈分配（即，如果它们不会占用太多内存），那么只对类成员使用公共引用是相当普遍的，同时在内部管理堆分配的对象。如果您需要在类之外设置类成员，可以只使用一个获取所需值的 set 方法，而不是直接访问它。

# iphone - uiTableView 在删除单元格时第二次崩溃

> ID：12164466
> 
> 赞同：0
> 
> 时间：2012-08-28T17:29:26.387
> 
> 标签：iphone, ios, ipad, uitableview

我是 iPhone 的新手，我试图从我的 UITableView 中删除一个单元格，第一次它删除得很好，但第二次它给了我以下错误：

```
*** Terminating app due to uncaught exception 'NSInternalInconsistencyException', 
reason: 'Invalid update: invalid number of rows in section 0\.  The number of rows 
contained in an existing section after the update (3) must be equal to the number 
of rows contained in that section before the update (3), plus or minus the number 
of rows inserted or deleted from that section (0 inserted, 1 deleted) and plus or 
minus the number of rows moved into or out of that section (0 moved in, 0 moved out).' 
```

这是我的表格代码：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle: (UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
Book_own *temp= (Book_own *)[self.books objectAtIndex:indexPath.row];

if (editingStyle == UITableViewCellEditingStyleDelete) {
    // Delete the row from the data source

    [books removeObjectAtIndex:indexPath.row];

    [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];

    isDeleted = @"true";
    deletedBook_id = temp.bo_id;

    [self viewDidLoad];

}

else if (editingStyle == UITableViewCellEditingStyleInsert) {
    // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
}  

}

 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
// Return the number of sections.
return 2;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
// Return the number of rows in the section.

NSDictionary *dictionary = [listOfItems objectAtIndex:section];
NSArray *array = [dictionary objectForKey:@"myBooks"];
return [array count];
} 
```

在 ViewDidLoad 我写了以下代码：

```
NSDictionary *mbooks = [NSDictionary dictionaryWithObject:books forKey:@"myBooks"];

NSDictionary *mgroups = [NSDictionary dictionaryWithObject:filteredParts forKey:@"myBooks"];
listOfItems = [[NSMutableArray alloc] init];

[listOfItems addObject:mbooks];
[listOfItems addObject:mgroups]; 
```

谁能告诉我如何解决这个问题？？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:37:03.770

如果我正确阅读了您的代码，则您的数据源是 listOfItems。您应该从表数据源中删除该行。一般规则是，当您删除或添加项目时，`UITableView`您必须更新数据源。

```
[listOfItemsremoveObjectAtIndex:indexPath.row]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:54:44.210

发生的情况是您要么没有删除该项目，要么在您允许多次删除时只删除一个项目。您可以通过检查它是否真的被删除来进行调整，如果没有，则重新加载数据：

```
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        BOOL success = [self removeFile:indexPath];
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
        if (!success) [tableView reloadData];
    }
} 
```

然后此方法删除数据源项（它来自我自己的项目，因此应调整名称：

```
-(BOOL) removeFile:(NSIndexPath *)indexPath{
    // Removes from the datasource and the filesystem
    NSURL *fileURL = [self.dataSource objectAtIndex:indexPath.row];
    NSError *error;
    BOOL success = [[NSFileManager defaultManager] removeItemAtURL:fileURL error:&error];
    if (success) {
        [self.dataSource removeObjectAtIndex:indexPath.row];
    } else {
        UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"Error" message:[error localizedDescription] delegate:self cancelButtonTitle:@"Ok" otherButtonTitles: nil];
        [alert show];
        [alert release];
        [self.dataSource removeObjectAtIndex:indexPath.row];
    }
    return success;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:51:06.400

该错误表示删除后应该少 1 行。它失败是因为数据源代码在报告模型的方式上不一致。

看看你如何回答 numberOfRowsInSection。我认为正确的是，首先选择节索引表示的数组，然后回答该数组的计数。

相同的逻辑必须适用于删除。您从中删除的数组需要是 indexPath.section 指示的数组。考虑一下：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle: (UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {

    // the array you manipulate here must be the same array you use to count
    // number of rows, and the same you use to render rowAtIndexPath

    NSDictionary *dictionary = [listOfItems objectAtIndex:indexPath.section];
    NSArray *array = [dictionary objectForKey:@"myBooks"];

    // in order to be edited, it must be mutable
    // you can do that on the fly here, or set it up as mutable
    // let's make it temporarily mutable here:
    NSMutableArray *mutableCopy = [array mutableCopy];

    if (editingStyle == UITableViewCellEditingStyleDelete) {
        [mutableCopy removeObjectAtIndex:indexPath.row];

        // if it's setup mutable, you won't need to replace the immutable copy in the dictionary.
        // but we just made a copy, so we have to replace the original
        [listOfItems replaceObjectAtIndex:indexPath.section withObject:[NSArray arrayWithArray:mutableCopy]];

        // and so on 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T17:44:03.563

一、不要调用[self viewDidLoad]；不应手动调用此方法。

我认为您没有将更新方法调用到您的表格视图。这可能会解决您的问题：

```
[tableView beginUpdates];
[books removeObjectAtIndex:indexPath.row];
[tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
[tableView endUpdates]; 
```

编辑：您还需要更仔细地查看您的代码。您正在从 indexPath 的行中直接从数据源数组中删除一条记录，考虑到您的 tableView 有两个部分，这可能会出现问题。

# php - Facebook 按钮未在 chrome 中加载

> ID：12164467
> 
> 赞同：1
> 
> 时间：2012-08-28T17:29:31.253
> 
> 标签：php, facebook, google-chrome, heroku

facebook 按钮不显示我只在 chrome 中获得文本，但它在 Firefox 中有效。

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en">

<div id="fb-root"></div>
<fb:login-button scope="email,user_about_me,user_interests,user_location,publish_stream" width="width_value"  size="large">Login with Facebook</fb:login-button> 
```

我只是收到文本“使用 Facebbok 登录”

```
<script src="http://connect.facebook.net/en_US/all.js"></script>   
<script>
 // Initiate FB Object
 FB.init({
   appId: '<?= YOUR_APP_ID ?>', 
   status: true,
   cookie: true, 
   xfbml: true
   });
 // Reloading after successfull login
 FB.Event.subscribe('auth.login', function(response) { 
 window.location.reload(); 
 });
</script> 
```

![铬输出](../Images/014b5dd78fc506fa5fbc12aee27cf2d1.png)

![火狐输出](../Images/9c3e6948fb5d1da575f5ac600d7dd681.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T01:58:58.787

将 Facebook SDK 脚本 src 更改为方案相关，即没有`http:`

```
<script src="//connect.facebook.net/en_US/all.js"></script> 
```

这最初失败了，因为 Chrome 会在使用 HTTPS 时阻止通过 HTTP 传输的脚本，默认情况下，当您在 Facebook 中查看您的应用程序时。另一方面，Firefox 并不那么挑剔。

# python - Python FTP隐式TLS连接问题

> ID：12164470
> 
> 赞同：31
> 
> 时间：2012-08-28T17:30:02.810
> 
> 标签：python, ssl, ftp, ftplib, ftps

我需要连接到能够使用 lftp 成功连接的 FTPS 服务器。但是，当我尝试使用 Python ftplib.FTP_TLS 时，它会超时，堆栈跟踪显示它正在等待服务器发送欢迎消息等。有谁知道问题是什么以及如何克服？我想知道服务器端是否需要做一些事情，但是 lftp 客户端如何正常工作。任何帮助是极大的赞赏。

这是堆栈跟踪：

```
 ftp = ftplib.FTP_TLS()  
    ftp.connect(cfg.HOST, cfg.PORT, timeout=60)
  File "C:\Users\username\Softwares\Python27\lib\ftplib.py", line 135, in connect  
    self.welcome = self.getresp()  
  File "C:\Users\username\Softwares\Python27\lib\ftplib.py", line 210, in getresp  
    resp = self.getmultiline()  
  File "C:\Users\username\Softwares\Python27\lib\ftplib.py", line 196, in getmultiline  
    line = self.getline()  
  File "C:\Users\username\Softwares\Python27\lib\ftplib.py", line 183, in getline  
    line = self.file.readline()  
  File "C:\Users\username\Softwares\Python27\lib\socket.py", line 447, in readline  
    data = self._sock.recv(self._rbufsize)  
socket.timeout: timed out 
```

使用 lftp 成功登录到同一个 ftps 服务器：

```
$ lftp
lftp :~> open ftps://ip_address:990
lftp ip_address:~> set ftps:initial-prot P
lftp ip_address:~> login ftps_user_id  ftps_user_passwd
lftp sftp_user_id@ip_address:~> ls
ls: Fatal error: SSL_connect: self signed certificate
lftp ftps_user_id@ip_address:~> set ssl:verif-certificate off
lftp ftps_user_id@ip_address:~> ls
lftp ftps_user_id@ip_address:/> 
```

顺便说一句，我使用的是 Python 2.7.3。我用谷歌做了很多搜索，但没有发现任何有用的东西。

我仍然遇到这个问题，如果有人可以提供帮助，不胜感激。仔细查看 FTP.connect() 与服务器的连接不是问题，但从服务器获得确认（或欢迎消息）是一个问题。lftp 没有这个问题，FileZilla 也没有任何问题，如这里的日志所示 -

```
Status: Connecting to xx.xx.xx.xxx:990...  
Status: Connection established, initializing TLS...  
Status: Verifying certificate...  
Status: TLS/SSL connection established, waiting for welcome message...  
Response:   220-      Vous allez vous connecter sur un serveur prive  
Response:   220-     Seules les personnes habilitees y sont autorisees  
Response:   220 Les contrevenants s'exposent aux poursuites prevues par la loi.  
Command:    USER xxxxxxxxxxxxx  
Response:   331 Password required for xxxxxxxxxxxxx.  
Command:    PASS **********  
Response:   230 Login OK. Proceed.  
Command:    PBSZ 0  
Response:   200 PBSZ Command OK. Protection buffer size set to 0\.  
Command:    PROT P  
Response:   200 PROT Command OK. Using Private data connection  
Status: Connected  
Status: Retrieving directory listing...  
Command:    PWD  
Response:   257 "/" is current folder.  
Command:    TYPE I  
Response:   200 Type set to I.  
Command:    PASV  
Response:   227 Entering Passive Mode (81,93,20,199,4,206).  
Command:    MLSD  
Response:   150 Opening BINARY mode data connection for MLSD /.  
Response:   226 Transfer complete. 0 bytes transferred. 0 bps.  
Status: Directory listing successful 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2016-03-17T00:58:51.820

扩展迄今为止提出的解决方案，问题是隐式 FTPS 连接需要在我们有机会调用 login() 之前自动对套接字进行 ssl 包装。人们提议的许多子类在 connect 方法的上下文中执行此操作，我们可以更一般地通过修改 self.sock 的 get/set 和一个属性以在 set 上自动包装来管理它：

```
import ftplib
import ssl

class ImplicitFTP_TLS(ftplib.FTP_TLS):
    """FTP_TLS subclass that automatically wraps sockets in SSL to support implicit FTPS."""

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self._sock = None

    @property
    def sock(self):
        """Return the socket."""
        return self._sock

    @sock.setter
    def sock(self, value):
        """When modifying the socket, ensure that it is ssl wrapped."""
        if value is not None and not isinstance(value, ssl.SSLSocket):
            value = self.context.wrap_socket(value)
        self._sock = value 
```

用法与标准 FTP_TLS 类基本相同：

```
ftp_client = ImplicitFTP_TLS()
ftp_client.connect(host='ftp.example.com', port=990)
ftp_client.login(user='USERNAME', passwd='PASSWORD')
ftp_client.prot_p() 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-09-18T03:01:09.490

我在同一个问题上工作了半天，终于弄明白了。

对于隐式 FTP TLS/SSL（默认端口 990），我们的客户端程序必须在创建套接字后立即建立 TLS/SSL 连接。但是 python 的类`FTP_TLS`不会从类 FTP重新加载**连接函数。**我们需要修理它：

```
class tyFTP(ftplib.FTP_TLS):
  def __init__(self,
               host='',
               user='',
               passwd='',
               acct='',
               keyfile=None,
               certfile=None,
               timeout=60):

    ftplib.FTP_TLS.__init__(self,
                            host=host,
                            user=user,
                            passwd=passwd,
                            acct=acct,
                            keyfile=keyfile,
                            certfile=certfile,
                            timeout=timeout)

  def connect(self, host='', port=0, timeout=-999):
    """Connect to host.  Arguments are:
    - host: hostname to connect to (string, default previous host)
    - port: port to connect to (integer, default previous port)
    """
    if host != '':
        self.host = host
    if port > 0:
        self.port = port
    if timeout != -999:
        self.timeout = timeout
    try:
        self.sock = socket.create_connection((self.host, self.port), self.timeout)
        self.af = self.sock.family
        # add this line!!!
        self.sock = ssl.wrap_socket(self.sock,
                                    self.keyfile,
                                    self.certfile,
                                    ssl_version=ssl.PROTOCOL_TLSv1)
        # add end
        self.file = self.sock.makefile('rb')
        self.welcome = self.getresp()
    except Exception as e:
        print(e)
    return self.welcome 
```

这个派生类重新加载**连接**函数并围绕套接字构建一个包装器到 TLS。成功连接并登录 FTP 服务器后，您需要**`FTP_TLS.prot_p()`**在执行任何 FTP 命令之前调用：

希望这会有所帮助^_^

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2019-03-23T16:12:29.947

# 具有被动传输模式的基于 TLS 的隐式 FTP

这是一个更“工业”的实现。

让我们注意，在前面的示例中，名为 'context' 的属性在**init**中丢失了。

**下面的代码在 Python 2.7 和 Python 3 上都能完美运行**

## 编码

```
import ftplib, socket, ssl
FTPTLS_OBJ = ftplib.FTP_TLS

# Class to manage implicit FTP over TLS connections, with passive transfer mode
# - Important note:
#   If you connect to a VSFTPD server, check that the vsftpd.conf file contains
#   the property require_ssl_reuse=NO
class FTPTLS(FTPTLS_OBJ):

    host = "127.0.0.1"
    port = 990
    user = "anonymous"
    timeout = 60

    logLevel = 0

    # Init both this and super
    def __init__(self, host=None, user=None, passwd=None, acct=None, keyfile=None, certfile=None, context=None, timeout=60):        
        FTPTLS_OBJ.__init__(self, host, user, passwd, acct, keyfile, certfile, context, timeout)

    # Custom function: Open a new FTPS session (both connection & login)
    def openSession(self, host="127.0.0.1", port=990, user="anonymous", password=None, timeout=60):
        self.user = user
        # connect()
        ret = self.connect(host, port, timeout)
        # prot_p(): Set up secure data connection.
        try:
            ret = self.prot_p()
            if (self.logLevel > 1): self._log("INFO - FTPS prot_p() done: " + ret)
        except Exception as e:
            if (self.logLevel > 0): self._log("ERROR - FTPS prot_p() failed - " + str(e))
            raise e
        # login()
        try:
            ret = self.login(user=user, passwd=password)
            if (self.logLevel > 1): self._log("INFO - FTPS login() done: " + ret)
        except Exception as e:
            if (self.logLevel > 0): self._log("ERROR - FTPS login() failed - " + str(e))
            raise e
        if (self.logLevel > 1): self._log("INFO - FTPS session successfully opened")

    # Override function
    def connect(self, host="127.0.0.1", port=990, timeout=60):
        self.host = host
        self.port = port
        self.timeout = timeout
        try:
            self.sock = socket.create_connection((self.host, self.port), self.timeout)
            self.af = self.sock.family
            self.sock = ssl.wrap_socket(self.sock, self.keyfile, self.certfile)
            self.file = self.sock.makefile('r')
            self.welcome = self.getresp()
            if (self.logLevel > 1): self._log("INFO - FTPS connect() done: " + self.welcome)
        except Exception as e:
            if (self.logLevel > 0): self._log("ERROR - FTPS connect() failed - " + str(e))
            raise e
        return self.welcome

    # Override function
    def makepasv(self):
        host, port = FTPTLS_OBJ.makepasv(self)
        # Change the host back to the original IP that was used for the connection
        host = socket.gethostbyname(self.host)
        return host, port

    # Custom function: Close the session
    def closeSession(self):
        try:
            self.close()
            if (self.logLevel > 1): self._log("INFO - FTPS close() done")
        except Exception as e:
            if (self.logLevel > 0): self._log("ERROR - FTPS close() failed - " + str(e))
            raise e
        if (self.logLevel > 1): self._log("INFO - FTPS session successfully closed")

    # Private method for logs
    def _log(self, msg):
        # Be free here on how to implement your own way to redirect logs (e.g: to a console, to a file, etc.)
        print(msg) 
```

## 使用示例

```
host = "www.myserver.com"
port = 990
user = "myUserId"
password = "myPassword"

myFtps = FTPTLS()
myFtps.logLevel = 2
myFtps.openSession(host, port, user, password)
print(myFtps.retrlines("LIST"))
myFtps.closeSession() 
```

## 输出示例

```
INFO - FTPS connect() done: 220 (vsFTPd 3.0.2)
INFO - FTPS prot_p() done: 200 PROT now Private.
INFO - FTPS login() done: 230 Login successful.
INFO - FTPS session successfully opened
-rw-------    1 ftp      ftp         86735 Mar 22 16:55 MyModel.yaml
-rw-------    1 ftp      ftp          9298 Mar 22 16:55 MyData.csv
226 Directory send OK.
INFO - FTPS close() done
INFO - FTPS session successfully closed 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-12-14T15:07:11.827

扩展 NERV 的响应 - 这对我有很大帮助，这就是我如何通过需要身份验证的端口 990 上的隐式 TLS 连接来解决我的问题。

文件名：ImplicitTLS.py

```
from ftplib import FTP_TLS
import socket
import ssl

class tyFTP(FTP_TLS):
    def __init__(self, host='', user='', passwd='', acct='', keyfile=None, certfile=None, timeout=60):
        FTP_TLS.__init__(self, host, user, passwd, acct, keyfile, certfile, timeout)
    def connect(self, host='', port=0, timeout=-999):
        if host != '':
            self.host = host
        if port > 0:
            self.port = port
        if timeout != -999:
            self.timeout = timeout

        try: 
            self.sock = socket.create_connection((self.host, self.port), self.timeout)
            self.af = self.sock.family
            self.sock = ssl.wrap_socket(self.sock, self.keyfile, self.certfile, ssl_version=ssl.PROTOCOL_TLSv1)
            self.file = self.sock.makefile('rb')
            self.welcome = self.getresp()
        except Exception as e:
            print e
        return self.welcome 
```

然后从我的主应用程序中，我这样做了：

```
from ImplicityTLS import tyFTP
server = tyFTP()
server.connect(host="xxxxx", port=990)
server.login(user="yyyy", passwd="fffff")
server.prot_p() 
```

就是这样，我能够下载文件等。道具去 NERV 寻找原始答案。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-06-02T17:59:16.233

NERV 的答案和 Brad Decker 的样本真的很有帮助。向他们致敬。他们为我节省了几个小时。

不幸的是，最初它对我不起作用。

就我而言，一旦我从方法中删除了`ssl_version`参数，连接就可以正常工作。`ssl.wrap_socket`此外，要将任何命令发送到服务器，我必须覆盖类中的`ntransfercmd`方法`FTP_TLS`并删除`ssl_version`那里的参数。

那是对我有用的代码：

```
from ftplib import FTP_TLS, FTP
import socket
import ssl

class IMPLICIT_FTP_TLS(FTP_TLS):
    def __init__(self, host='', user='', passwd='', acct='', keyfile=None,
        certfile=None, timeout=60):
        FTP_TLS.__init__(self, host, user, passwd, acct, keyfile, certfile, timeout)

    def connect(self, host='', port=0, timeout=-999):
        '''Connect to host.  Arguments are:
        - host: hostname to connect to (string, default previous host)
        - port: port to connect to (integer, default previous port)
        '''
        if host != '':
            self.host = host
        if port > 0:
            self.port = port
        if timeout != -999:
            self.timeout = timeout
        try:
            self.sock = socket.create_connection((self.host, self.port), self.timeout)
            self.af = self.sock.family
            self.sock = ssl.wrap_socket(self.sock, self.keyfile, self.certfile)
            self.file = self.sock.makefile('rb')
            self.welcome = self.getresp()
        except Exception as e:
            print (e)
        return self.welcome

    def ntransfercmd(self, cmd, rest=None):
        conn, size = FTP.ntransfercmd(self, cmd, rest)
        if self._prot_p:
            conn = ssl.wrap_socket(conn, self.keyfile, self.certfile)
        return conn, size 
```

和强制性样品：

```
>>> ftps = IMPLICIT_FTP_TLS()
>>> ftps.connect(host='your.ftp.host', port=990)
>>> ftps.login(user="your_user", passwd="your_passwd")
>>> ftps.prot_p()
>>> ftps.retrlines('LIST') 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-05-07T12:29:57.993

对于使用隐式 TLS（也在被动模式下）的 FTP 服务器，我也遇到了同样的问题。我遇到了多个错误：

```
450 TLS session of data connection has not resumed or the session does not match the control connection 
```

与建议的解决方案。作为记录，我基于@George Leslie-Waksman 的解决方案是：

```
class ImplicitFTP_TLS(ftplib.FTP_TLS):
    """
    FTP_TLS subclass that automatically wraps sockets in SSL to support implicit FTPS.
    Prefer explicit TLS whenever possible.
    """

    def __init__(self, *args, **kwargs):
        """Initialise self."""
        super().__init__(*args, **kwargs)
        self._sock = None

    @property
    def sock(self):
        """Return the socket."""
        return self._sock

    @sock.setter
    def sock(self, value):
        """When modifying the socket, ensure that it is SSL wrapped."""
        if value is not None and not isinstance(value, ssl.SSLSocket):
            value = self.context.wrap_socket(value)
        self._sock = value

    def ntransfercmd(self, cmd, rest=None):
        """Override the ntransfercmd method"""
        conn, size = ftplib.FTP.ntransfercmd(self, cmd, rest)
        conn = self.sock.context.wrap_socket(
            conn, server_hostname=self.host, session=self.sock.session
        )
        return conn, size 
```

新颖之处在于`ntransfercmd`覆盖。

然后它的使用类似于`ftplib.FTP_TLS`（以前帖子中的许多示例）。

覆盖`connect`而不是使用`sock`属性/设置器也可以。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-02-10T03:09:39.790

我知道这个线程已经很老了，ftp 不像以前那么受欢迎了，但无论如何，如果它可以帮助任何我想做出额外贡献的人。我在被动模式下尝试使用隐式（端口 990）ftps 连接到 ftp 服务器时遇到了类似的情况。在这种情况下，服务器在协商初始连接后，通常会提供一个新的主机 IP 地址和端口，这可能与用于进行初始连接的那些不同，实际数据传输应该通过这些地址和端口进行。没什么大不了的，包括 python 在内的 ftps 客户端可以处理这个问题，只有这个特定的服务器提供了一个不可路由的（可能是防火墙内部的）IP 地址。我注意到 FileZilla 连接没问题，但 python ftplib 不能。然后我遇到了这个线程：

[如何用 ftplib 上的服务器地址替换不可路由的 IP 地址](https://stackoverflow.com/questions/22991417/how-to-replace-a-non-routable-ip-address-with-server-address-on-ftplib)

这让我明白了。使用 Grzegorz Wierzowiecki 方法，我扩展了该线程中提到的方法并提出了这个，它解决了我的问题。

```
import ftplib, os, sys
import socket
import ssl
FTPS_OBJ = ftplib.FTP_TLS

def conn_i_ftps(FTP_Site, Login_Name, Login_Password):
    print "Starting IMPLICIT ftp_tls..."
    ftps = tyFTP()
    print ftps.connect(host=FTP_Site, port=990, timeout=120)
    ftps.prot_p()
    ftps.login(user=Login_Name, passwd=Login_Password)
    print "Logged In"
    ftps.retrlines('LIST')
    # return ftps

class tyFTP(FTPS_OBJ):
    def __init__(self, host='', user='', passwd='', acct='', keyfile=None, certfile=None, timeout=60):
        FTPS_OBJ.__init__(self, host, user, passwd, acct, keyfile, certfile, timeout)

    def connect(self, host='', port=0, timeout=-999):
        if host != '':
            self.host = host
        if port > 0:
            self.port = port
        if timeout != -999:
            self.timeout = timeout

        try:
            self.sock = socket.create_connection((self.host, self.port), self.timeout)
            self.af = self.sock.family
            self.sock = ssl.wrap_socket(self.sock, self.keyfile, self.certfile)
            self.file = self.sock.makefile('rb')
            self.welcome = self.getresp()
        except Exception as e:
            print e
        return self.welcome

    def makepasv(self):
        print port #<---Show passively assigned port
        print host #<---Show the non-routable, passively assigned IP
        host, port = FTPS_OBJ.makepasv(self)
        host = socket.gethostbyname(self.host) #<---- This changes the host back to the original IP that was used for the connection
        print 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
        print host #<----Showing the original IP
        return host, port 
```

然后代码被这样调用

```
FTP_Site       =  "ftp.someserver.com"
Login_Name     =  "some_name"
Login_Password =  "some_passwd"

conn_i_ftps(FTP_Site, Login_Name, Login_Password) 
```

我想可以用一个标识不可路由地址的 IF 语句来包装主机被更改回来的行，有点像这样：

```
if host.split(".")[0] in (10, 192, 172):
     host = socket.gethostbyname(self.host)
     .
     .
     . 
```

# c# - 使用 Entity Framework 5 在 1 个事务中调用多个存储过程

> ID：12164472
> 
> 赞同：2
> 
> 时间：2012-08-28T17:30:04.730
> 
> 标签：c#, entity-framework, c#-4.0, asp.net-mvc-4, entity-framework-5

我正在使用 Entity Framework 5，需要在单个事务中进行多个存储过程调用。它们都是插入，其中每个都依赖于前一个的输出，我希望能够在一个失败的情况下回滚所有内容。每个调用都使用相同的实体对象。第一个调用成功执行，但下一个调用总是失败并出现以下错误：

“底层提供商在 Open 上失败。”

内部异常：“分布式事务管理器 (MSDTC) 的网络访问已被禁用。请使用组件服务管理工具在 MSDTC 的安全配置中为网络访问启用 DTC。”

内部内部异常：“事务管理器已禁用对远程/网络事务的支持。（来自 HRESULT 的异常：0x8004D024）”

有没有办法在不走 DTC 道路的情况下做到这一点？

代码：

```
ObjectParameter outputParam1 = new ObjectParameter("newEntity1", 0);
ObjectParameter outputParam2 = new ObjectParameter("newEntity2", 0);

using (var scope = new TransactionScope())
{
    try
    {
        using(var context = new DatabaseContext())
        {
            context.f_createEntity1(outputParam1);
        }

        using(var context = new DatabaseContext())
        {
            context.f_createEntity2(ouputParam2, outputParam1.Value);
        }

        ... other calls ...

        scope.Complete();
    }
    catch (Exception ex)
    {
        ... handle error ...
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:36:07.933

如果不启用 DTC，就没有办法做到这一点。

来自相关的[SO 帖子](https://stackoverflow.com/questions/1690892/transactionscope-automatically-escalating-to-msdtc-on-some-machines)：

> 事务中至少包含两个支持单阶段通知的持久资源。例如，征用单个连接不会导致事务被提升。但是，每当您打开与数据库的第二个连接导致数据库登记时，System.Transactions 基础结构会检测到它是事务中的第二个持久资源，并将其升级为 MSDTC 事务。

# c# - 为什么在构造函数中首选对象初始化？

> ID：12164474
> 
> 赞同：3
> 
> 时间：2012-08-28T17:30:08.660
> 
> 标签：c#, java

> **可能重复：**
> [C#成员变量初始化；最佳实践？](https://stackoverflow.com/questions/298183/c-sharp-member-variable-initialization-best-practice)
> [为什么要在构造函数中初始化成员变量？](https://stackoverflow.com/questions/685600/why-should-member-variables-be-initialized-in-constructors)
> [我应该在构造函数内还是在构造函数外初始化变量](https://stackoverflow.com/questions/3918578/should-i-initialize-variable-within-constructor-or-outside-constructor)

在 Java/C# 中我们通常会看到

```
public class MyClass {
    private MyObject myObject;

    public MyClass(){
        myObject = new MyObject();
    }
} 
```

代替

```
public class MyClass {
    private MyObject myObject = new MyObject();

    public MyClass(){

    }
} 
```

如果有的话是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:34:41.410

没有区别，只是风格选择。

在您的示例中，如果您选择第二种方法，则不必提供构造函数，这样可以节省几行代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:36:59.803

这归结为其中一条评论中所述的编码偏好。如果编译以下代码

```
public class TestInitialization
{
    private object test1 = new object();
    private object test2;

    public TestInitialization()
    {
        this.test2 = new object();
    }
} 
```

编译时，实际使用的代码如下

```
public class TestInitialization
{
    private object test1;
    private object test2;

    public TestInitialization()
    {
        this.test1 = new object();
        this.test2 = new object();
    }
} 
```

所以它们是完全相同的东西，使用你喜欢的任何一个。

编辑：这是一个具有继承类的基类和生成的编译 IL 的示例。

基类

```
class basetest
{
    private object test1 = new object();
    private object test2;

    public basetest()
    {
        this.test2 = new object();
    }
} 
```

继承类

```
class testclass : basetest
{
    private object testclass1 = new object();
    private object testclass2;

    public testclass() : base()
    {
        this.testclass2 = new object();
    }
} 
```

生成的 IL 基类

```
.class private auto ansi beforefieldinit basetest
    extends [mscorlib]System.Object
{
    .method public hidebysig specialname rtspecialname instance void .ctor() cil managed
    {
        .maxstack 8
        L_0000: ldarg.0 
        L_0001: newobj instance void [mscorlib]System.Object::.ctor()
        L_0006: stfld object logtest.basetest::test1
        L_000b: ldarg.0 
        L_000c: call instance void [mscorlib]System.Object::.ctor()
        L_0011: nop 
        L_0012: nop 
        L_0013: ldarg.0 
        L_0014: newobj instance void [mscorlib]System.Object::.ctor()
        L_0019: stfld object logtest.basetest::test2
        L_001e: nop 
        L_001f: ret 
    }

    .field private object test1

    .field private object test2

} 
```

继承类 IL

```
.class private auto ansi beforefieldinit testclass
    extends logtest.basetest
{
    .method public hidebysig specialname rtspecialname instance void .ctor() cil managed
    {
        .maxstack 8
        L_0000: ldarg.0 
        L_0001: newobj instance void [mscorlib]System.Object::.ctor()
        L_0006: stfld object logtest.testclass::testclass1
        L_000b: ldarg.0 
        L_000c: call instance void logtest.basetest::.ctor()
        L_0011: nop 
        L_0012: nop 
        L_0013: ldarg.0 
        L_0014: newobj instance void [mscorlib]System.Object::.ctor()
        L_0019: stfld object logtest.testclass::testclass2
        L_001e: nop 
        L_001f: ret 
    }

    .field private object testclass1

    .field private object testclass2

} 
```

我觉得我有点困惑。在此示例中，构造函数外部的初始化程序在调用基本构造函数之前首先被初始化。所以无论如何，构造函数之外的初始化器将在构造器内部的初始化器之前被初始化，并且在大多数情况下这应该无关紧要。从技术上讲，它们都被转换为在构造函数中初始化，并且适用以下规则。

1.  首先运行构造函数之外的所有初始化程序
2.  调用所有基类构造函数
3.  构造函数内的所有初始化程序都运行

基本上，编译器会将构造函数之外的所有初始化程序添加到构造函数代码中，然后正常运行。

所以这

```
public class test : basetest
{
    private object test1 = new object();
    private object test2;

    public test() : base()
    {
        this.test2 = new object();
    }
}

public class basetest
{
    private object basetest1 = new object();
    private object basetest2;

    public basetest()
    {
        this.basetest2 = new object();
    }
} 
```

变成

```
public class test : basetest
{
    private object test1;
    private object test2;

    public test()
    {
        //prepend everything first
        this.test1 = new object();

        //call base
        base(); //not legal but just an example

        //everything else that was already here
        this.test2 = new object();
    }
}

public class basetest
{
    private object basetest1;
    private object basetest2;

    public basetest()
    {
        //prepend initializers
        this.basetest1 = new object();

        //if there were more base classes, the constructors would be called here

        //do everything else that was already here
        this.basetest2 = new object();
    }
} 
```

希望这更有意义并澄清了一些事情。我知道我在理解某些人说它在构造函数“首先”或“外部”运行时的含义时遇到了问题；它实际上 ALL 都在构造函数内运行，但被调用的顺序受到影响。

# finite-automata - 有限自动机、下推自动机和图灵机示例

> ID：12164479
> 
> 赞同：2
> 
> 时间：2012-08-28T17:30:19.200
> 
> 标签：finite-automata, turing-machines, pushdown-automaton

我正在寻找一些有限自动机、下推自动机和图灵机任务示例的良好来源（用于手动解决）。

我四处寻找，但没有发现什么特别的东西，所以我想知道是否有人有一些很好的例子。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T19:09:14.493

你最好的选择可能是买一本关于这个主题的书，比如Michael Sipser[的《计算理论导论》第三版](http://www.cengage.com/search/productOverview.do?Ntt=sipser%7C%7C991938321204392568016032450701059771599&N=0&Ntk=all%7C%7CP_EPI)，然后完成练习。

有关自动机问题集的集合以及解决方案，请查看[斯坦福大学的计算理论入门课程](http://www.stanford.edu/class/archive/cs/cs103/cs103.1134/)。问题集 5、6 和 7 直接讨论自动机（有限、下推和图灵机）以及等效表示（正则表达式和上下文无关文法）。

希望这可以帮助！

# android - 无法将选定的单选按钮保存到共享首选项

> ID：12164481
> 
> 赞同：0
> 
> 时间：2012-08-28T17:30:31.160
> 
> 标签：android

我的问题是每当我尝试保存输入的内容时，特别是检查单选组中的适当答案时，其他所有内容都已保存，但未保存组中选定的单选按钮。如果我遗漏了什么，请查看我的代码。这个问题让我发疯已经好几天了。

```
private void saveData(){

     //get entered value and set to a variable
     String fname_input = fnametext.getText().toString();
     int checkedButton = gendertext.getCheckedRadioButtonId();

     //SAVE shared pref value
     SharedPreferences.Editor editor = settings.edit();
     editor.putString("fname", fname_input);
     editor.putInt("gender", checkedButton);
     editor.commit();

     //show button after saving
     Toast.makeText(Profile_Pref.this, 
                "You have successfully saved!",
                Toast.LENGTH_SHORT)
                .show();

 } // end of saveData method 
```

感谢帮助！

对于我的 loadSavedData 方法： private void loadSavedData(){

```
 //RETRIEVE/load the saved shared pref value
     String fname = settings.getString("fname", null);

      fnametext.setText( fname );
      gendertext.setSelected(true);

 }   // end of loadSavedData method 
```

我认为这里有一个逻辑错误:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:45:10.037

我假设性别文本是一个 RadioGroup。

loadSavedData() 需要检查正确的单选按钮。

```
private void loadSavedData(){
    //RETRIEVE/load the saved shared pref value
    String fname = settings.getString("fname", null);

    fnametext.setText( fname );

    gendertext.check(settings.getInt("gender", 0));
} 
```

在单独的说明中，您不应该真正将视图 ID 存储在首选项中。他们将来可以改变。而是存储性别值，例如“M”和“F”。

# android - Android - 无法解析 getSupportFragmentManager 的符号

> ID：12164483
> 
> 赞同：1
> 
> 时间：2012-08-28T17:30:43.063
> 
> 标签：android, list, fragment

这是我的 ItemAdapter 的代码，我以这种方式将其用作列表的适配器。

```
list.setAdapter(new ItemAdapter(thisContext,imageUrl)); 
```

我正在尝试为将项目添加到 ListFragment 的按钮实现 onclick 侦听器。当我编译时，它说“无法解析符号 getSupportFragmentManager”。请参见下面的粗体字。但我很确定我导入了 android.support.v4.app.FragmentActivity（见下文）。我在主要活动中使用了相同的 getSupportFragmentManager 并且它有效。我不明白为什么它不在这里。如果不是，我应该如何获取 HeadlinesFragment 以便我可以添加到该片段中的列表中？

感谢我能在这里得到的任何帮助。

码头。

```
package com.suite.android.menu;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;
**import android.support.v4.app.FragmentActivity;**

public class ItemAdapter extends BaseAdapter {

private Context itemPageContext;
private String imagesUrl[];
private static final String TAG = "ItemAdapter" ;

public ItemAdapter(Context c, String[] imageUrl)
{
   super();
   itemPageContext = c;
   imagesUrl = imageUrl.clone();  // copy over

}

private LayoutInflater getLayoutInflater()
{
    return (LayoutInflater) itemPageContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
}

public View getView(final int position, View convertView, ViewGroup parent)
{
    // all this is for 1 item in the list

    View theView = convertView;
    final ViewHolder holder;
    if (convertView == null) {
        theView = getLayoutInflater().inflate(R.layout.item_list_image, null);
        holder = new ViewHolder();
        holder.text = (TextView) theView.findViewById(R.id.foodTitle);
        holder.image = (ImageView) theView.findViewById(R.id.foodImage);
        holder.button = (Button) theView.findViewById(R.id.addOrderButton);
        theView.setTag(holder);
    } else
        holder = (ViewHolder) theView.getTag();

    holder.text.setText("Item " + position);
    holder.image.setImageResource(R.drawable.ic_launcher);

    holder.button.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            **HeadlinesFragment headFragment = (HeadlinesFragment) getSupportFragmentManager().findFragmentById(R.id.headlines_fragment);**
            headFragment.AddItem("One");
            Log.d(TAG, "Added Item!");
        }
    });

    return theView;
}

private class ViewHolder {
    public TextView text;
    public ImageView image;
    public Button button;
}

@Override
public int getCount() {
    return imagesUrl.length;
}

@Override
public Object getItem(int position) {
    return position;
}

@Override
public long getItemId(int position) {
    return position;
}

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T17:44:49.753

自从我玩碎片以来已经有一段时间了。但我相信您只能从 FragmentActivity 类访问 getSupportedFragmentManager 。

试试这个

```
public ItemAdapter(Context c,FragmentActivity activity, String[] imageUrl)
{
   super();
   itemPageContext = c;
   this.activity = activity;
   imagesUrl = imageUrl.clone();  // copy over
} 
```

然后在扩展 FragmentActivity 的类中执行以下操作：

```
list.setAdapter(new ItemAdapter(thisContext,thisActivity, imageUrl)); 
```

然后在适配器内执行此操作

```
activity.getSupportedFragmentManager... 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-28T17:41:24.127

您可能已经导入了该类，但您不在 a 中`FragmentActivity`，您在 a 中，`BaseAdapter`因此您所在的类上不存在该方法。如果您想在 Activity 上调用该方法，则需要传递中的 Activity（作为 a`FragmentActivity`而不是 a `Context`）或使此适配器成为私有内部类，以便它可以访问封闭的 Activity 方法。该方法需要在`FragmentActivity`对象上调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-17T17:46:40.303

当然，您现在已经找到了答案，但这可能对其他人有所帮助。我的情况可能与您的情况相似，对于如何解决将`Adapter`类与类分开的问题没有准确的答案`FragmentActivity`，同时需要访问`getSupportFragmentManager`适配器中的 ()。

传递上下文不起作用，因为它不允许转换 FragmentActivity （原因我仍然不明白）。

但是我放弃了，只是保存了对经理本身的访问权限并直接调用它：

```
public ViewPagerAdapter(Context context, FragmentManager fm, Fragment f) {
    super(fm);  
    _fm = fm; // declared in the class "private FragmentManager _fm;"
    _context=context;       
} 
```

# c# - PresentationFramework.dll 中发生“System.Reflection.TargetInvocationException”

> ID：12164488
> 
> 赞同：34
> 
> 时间：2012-08-28T17:30:49.673
> 
> 标签：c#, .net, wpf

好吧，我有一个奇怪的错误......

这工作正常：

```
private void radioButtonNormalPoint_Checked(object sender, RoutedEventArgs e)
{
   //comboBoxNormalPoint.SelectedIndex = 0;
   //ellipsePoint.Fill = System.Windows.Media.Brushes.Black;
} 
```

这抛出`System.Reflection.TargetInvocationException`：

```
private void radioButtonNormalPoint_Checked(object sender, RoutedEventArgs e)
{
   comboBoxNormalPoint.SelectedIndex = 0;
   ellipsePoint.Fill = System.Windows.Media.Brushes.Black;
} 
```

此外，它不允许我调试它；它在程序加载时崩溃。如果我在没有命中它的任何地方放置一个断点；它只是立即出错。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-28T18:34:52.267

该事件可能在元素完全加载或引用仍未设置之前引发，因此存在异常。`null`仅在引用 is not和`IsLoaded`is时尝试设置属性`true`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-09-16T20:49:09.573

要诊断此问题，请将导致 TargetInvocationException 的代码行放在 try 块内。

要解决此类错误，请获取内部异常。这可能是由于许多不同的问题。

```
try
{
    // code causing TargetInvocationException
}
catch (Exception e)
{
    if (e.InnerException != null)
    {
    string err = e.InnerException.Message;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T20:05:55.077

我认为如果您声明一个实现 INotifyPropertyChanged 的​​属性，然后对其进行数据绑定`IsChecked`（`SelectedIndex`使用 IValueConverter）和`Fill`（使用 IValueConverter），而不是使用 Checked Event 来切换`SelectedIndex`和`Fill`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-08T07:15:45.577

如果radiobutton-checked事件发生在窗口内容完全加载之前，即椭圆被完全加载，就会抛出这样的异常。所以检查窗口的UI是否被加载（可能是通过Window_ContentRendered事件等）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-29T16:41:37.713

这通常是由试图处理空对象引起的。例如，尝试清空一个为 null 的 Bindable 列表将触发异常：

```
public class MyViewModel {
    [BindableProperty]
    public virtual IList<Products> ProductsList{ get; set; }

    public MyViewModel ()
    {
        ProductsList.Clear(); // here is the problem
    }
} 
```

这可以通过检查 null 来轻松解决：

```
if (ProductsList!= null) ProductsList.Clear(); 
```

# ios - 减少 JPEG 和 PNG 文件大小的最佳程序

> ID：12164489
> 
> 赞同：0
> 
> 时间：2012-08-28T17:30:51.910
> 
> 标签：ios, ios4, cocos2d-iphone, png, jpeg

我正在为 iphone 开发游戏，我需要我的 PNG 和 JPEG 文件比它们小很多。最好的程序是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:53:34.150

对于 PNG，我使用 optipng。 [http://optipng.sourceforge.net](http://optipng.sourceforge.net)

对于 JPG，我使用 ImageMagick（转换实用程序）。 [http://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php) , [http://www.imagemagick.org/script/convert.php](http://www.imagemagick.org/script/convert.php)

# mysql - MySQL中多列索引的效率

> ID：12164497
> 
> 赞同：1
> 
> 时间：2012-08-28T17:31:09.940
> 
> 标签：mysql, indexing, explain, multiple-columns

如果我有一个带有 3 列索引的 MyISAM 表，例如

```
create table t (
  a int,
  b int,
  c int,
  index abc (a, b, c)
) engine=MyISAM; 
```

问题是，以下查询能否充分利用索引：

```
select * from t where a=1 and c=2; 
```

换句话说，考虑到索引是一个b-tree，MySQL可以跳过中间的列并且仍然对第一列和最后一列进行快速搜索吗？

EXPLAIN 似乎确实表明将使用该索引，但是，Extra 说：`Using where; Using index`我不知道这到底意味着什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:08:56.033

答案是不”。

MySQL 文档对如何使用索引非常清楚：

*如果表有一个多列索引，优化器可以使用索引的任何最左边的前缀来查找行。例如，如果您在 (col1, col2, col3) 上有一个三列索引，则您在 (col1)、(col1, col2) 和 (col1, col2, col3) 上有索引搜索功能。* （http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html。）

发生的事情是索引被用于“a = 1”。加载所有匹配的记录，以查看“c=2”是否为真。过滤器最终使用索引和显式记录过滤的组合。

顺便说一句，如果你想处理两列的所有组合，你需要几个索引：

*   (a, b, c)
*   (b, a, c)
*   (c, b, a)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:44:16.277

> 即使您对 WHERE 子句的所有部分都使用索引，您也可能会看到使用 where 如果列可以为 NULL。

根据`MySQL`文档，上面的语句阐明了表中的列可能为空，因此它也说明`using where`了它在 where 子句中具有覆盖字段的索引。

[http://dev.mysql.com/doc/refman/5.1/en/explain-output.html#explain-extra-information](http://dev.mysql.com/doc/refman/5.1/en/explain-output.html#explain-extra-information)

# git - 有没有办法查看分支中的某个提交提交了哪些工作？

> ID：12164499
> 
> 赞同：1
> 
> 时间：2012-08-28T17:31:24.223
> 
> 标签：git, commit

很久以前我在一个分支上做过一些工作，现在我需要做一些改变，但不记得我做了什么。给定提交代码，我如何找出提交了哪些文件/更改？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T17:38:08.357

```
git show <sha1> 
```

在哪里

```
<sha1> 
```

是你的“提交代码”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:56:48.607

`git whatchanged -1 -p <sha>`是一种方式。`git log -1 -p <sha>`类似。

# bash - Bash 行注释继续

> ID：12164505
> 
> 赞同：13
> 
> 时间：2012-08-28T17:31:50.367
> 
> 标签：bash, shell, comments

我看到一些 bash/shell 注释使用了这个符号

```
#  Some comment block that starts on line 1, but then
#+ continues on line 2 with this silly plus sign.

#  And this is another comment line that is not related to the ones above 
```

“#+”是否有助于任何类型的解析器（例如如何使用 Doxygen 样式的注释来自动生成文档）？

这是一种常见的做法吗？我知道包含/排除它并没有什么坏处，就实际脚本执行而言，但我很好奇采用这种评论风格是否有好处。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T20:21:21.807

根据[Advanced Bash-Scripting Guide](http://tldp.org/LDP/abs/html/abs-guide.html)，看起来这是可以用来提高脚本*清晰度和易读性的几个*[注释标题之一。](http://tldp.org/LDP/abs/html/abs-guide.html#COMMENTH)此花絮在指南的“各种提示”部分中介绍：

 *> 使用特殊用途的注释标题来提高脚本的清晰度和易读性。

以下是他们在指南的示例块中列出的几个：

```
## Caution.
rm -rf *.zzy   ##  The "-rf" options to "rm" are very dangerous,
               ##+ especially with wild cards.

#+ Line continuation.
#  This is line 1
#+ of a multi-line comment,
#+ and this is the final line.

#* Note.

#o List item.

#> Another point of view.
while [ "$var1" != "end" ]    #> while test "$var1" != "end" 
```

显然有些人觉得这些小技巧很有帮助，但我个人认为这样做并没有多大好处。*

# iphone - NavigationController 未加载视图

> ID：12164507
> 
> 赞同：0
> 
> 时间：2012-08-28T17:31:52.920
> 
> 标签：iphone, ios, xcode, ios4, xcode4.3

我正在使用 xCode 4.3.2 并启动了一个空白应用程序。

我有一个导航控制器和一个简单的登录控制器。我希望登录控制器成为我的根视图，因此这是用户登录时要做的第一件事。

我正在使用以下代码，当我运行应用程序时，它会显示黑屏。我输入了 LoginViewController.m->ViewDidLoad 的日志，它正在运行，我做错了什么吗？ LoginViewController.xib 非常简单，它现在只包含一个按钮，一旦我弄清楚它就会切换到选项卡视图控制器.

提前致谢。

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:     (NSDictionary *)launchOptions
    {
        UIViewController *loginController = [[LoginViewController alloc] initWithNibName:@"LoginViewController" bundle:nil];
        navigationController = [[UINavigationController alloc] initWithRootViewController:loginController];

        self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
        [self.window addSubview:navigationController.view];
        [self.window makeKeyWindow];

        return YES;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:36:37.247

这个不对：

```
[self.window addSubview:navigationController.view]; 
```

将其更改为：

```
self.window.rootViewController = navigationController; 
```

# javascript - 文本框输入中的限制字符

> ID：12164512
> 
> 赞同：0
> 
> 时间：2012-08-28T17:32:11.397
> 
> 标签：javascript, html

请友好一点。我正在尝试创建一个设置限制并减少多余部分（从指定限制开始）的页面。示例：限制为 3。然后，我将输入 abc，如果我输入 d，它必须说已达到其限制并且 abc 将保留。我的问题是它只是删除了我以前的输入并进行了新的输入。期待您的大力合作。谢谢。

```
 <html>
    <script type="text/javascript">

     function disable_btn_limit(btn_name)
     {
     /* this function is used to disable and enable buttons and textbox*/
    if(btn_name == "btn_limit")
{
        document.getElementById("btn_limit").disabled = true;
        document.getElementById("ctr_limit_txt").disabled = true;
        document.getElementById("btn_edit_limit").disabled = false;
}
         if(btn_name == "btn_edit_limit")
{
        document.getElementById("btn_limit").disabled = false;
        document.getElementById("ctr_limit_txt").disabled = false;
        document.getElementById("btn_edit_limit").disabled = true;
}
   }

     function check_content(txtarea_content)
    {
        /*This function is used to check the content*/
    // initialize an array
var txtArr = new Array();
       //array assignment
      //.split(delimiter) function of JS is used to separate 
     //values according to groups; delimiter can be ;,| and etc
txtArr = txtarea_content.split("");
var newcontent = "";
var momo =  new Array();
var trimmedcontent = "";
var re = 0;
var etoits;
var etoits2;

    //for..in is a looping statement for Arrays in JS. This is similar to foreach in C# 
    //Syntax: for(index in arr_containter) {}
for(ind_val in txtArr)
{
    var bool_check = check_if_Number(txtArr[ind_val])
    if(bool_check == true)
    {
        //DO NOTHING
    }
    else
    {

        //trim_content(newcontent); 
        newcontent += txtArr[ind_val];
        momo[ind_val] = txtArr[ind_val];
    }
}
var isapa = new Array();
var s;
re = trim_content(newcontent);  

for(var x = 0; x < re - 1; x++){

    document.getElementById("txtarea_content").value += momo[x];
    document.getElementById("txtarea_content").value = "";

}

     }
       function trim_content(ContentVal)
     {
//This function is used to determine length of content
//parseInt(value) is used to change String values to Integer data types.
//Please note that all value coming from diplay are all in String data Type
var limit_char =parseInt(document.getElementById("ctr_limit_txt").value);
var eto;
if(ContentVal.length > (limit_char-1))
{ 
    alert("Length is greater than the value specified above: " +limit_char);
    eto = limit_char ;
    etoits = document.getElementById("txtarea_content").value;
    //document.getElementById("txtarea_content").value = "etoits";
    return eto;
    //for(var me = 0; me < limit_char; me++)
    //{document.getElementById("txtarea_content").value = "";}
}
return 0;
  }

    function check_if_Number(ContentVal)
{
   //This function is used to check if a value is a number or not
   //isNaN, case sensitive, JS function used to determine if the values are 
        //numbers or not. TRUE = not a number, FALSE = number
if(isNaN(ContentVal))
{
    return false;
}
else
{ alert("Input characters only!");
    return true;
}
      }

</script>
   <table>
   <tr>
   <td>
  <input type="text" name="ctr_limit_txt" id="ctr_limit_txt"/>
   </td>
        <td>
        <input type="button" name="btn_limit" id="btn_limit" value="Set Limit"         onClick="javascript:disable_btn_limit('btn_limit');"/>
     </td>
     <td>
  <input type="button" name="btn_edit_limit" id="btn_edit_limit" value="Edit Limit"       disabled="true" onClick="javascript:disable_btn_limit('btn_edit_limit');"/>
     </td>
   </tr>
        <tr>
   <td colspan="2">
  <textarea name="txtarea_content" id="txtarea_content" onKeyPress="javascript:check_content(this.value);"></textarea>
     <br>
    *Please note that you cannot include <br>numbers inside the text area
     </td>
 </tr>

    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:45:56.563

尝试用这个替换：

```
for(var x = 0; x < re - 6; x++){
    document.getElementById("txtarea_content").value += momo[x];
    document.getElementById("txtarea_content").value = "";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:57:38.593

Try this. If the condition is satisfied return true, otherwise return false.

```
<html>
<head>
    <script type="text/javascript">
        function check_content(){
            var text = document.getElementById("txtarea_content").value;
            if(text.length >= 3){
                alert('Length should not be greater than 3');
                return false;
            } else { 
            return true;
            }
        }
    </script>
</head>
<body>
    <div>
        <textarea name="txtarea_content" id="txtarea_content" onkeypress=" return check_content();"></textarea>
    </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:58:24.347

Instead of removing the extra character from the text area, you can prevent the character from being written in the first place

```
function check_content(event) {  //PARAMETER is the event NOT the content
    txtarea_content = document.getElementById("txtarea_content").value; //Get the content 

    [...]

    re = trim_content(newcontent);

    if (re > 0) {
        event.preventDefault();   // in case the content exceeds the limit, prevent defaultaction ie write the extra character
    }

    /*for (var x = 0; x < re - 1; x++) {
    document.getElementById("txtarea_content").value += momo[x];
    document.getElementById("txtarea_content").value = "";
    }*/
} 
```

And in the HTML (parameter is the event):

```
<textarea ... onKeyPress="javascript:check_content(event);"></textarea> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T21:43:23.233

为什么文本输入上的 maxlength 属性不适用于这么少的字符？在您的情况下，您将拥有：

```
<input type="text" maxlength="3" /> 
```

或者如果是 HTML5，你仍然可以使用 textarea：

```
<textarea maxlength="3"> ... 
```

然后只需有一个标签，指示任何输入的三个字符限制。

# xpath - Html Agility Pack 中的 XPath 表达式问题

> ID：12164514
> 
> 赞同：0
> 
> 时间：2012-08-28T17:32:12.997
> 
> 标签：xpath, html-agility-pack

我正在使用 Html Agility Pack 对 Google 搜索结果进行基本的网络抓取。作为 XPath 的新手，我确保我的路径表达式是正确的（在 FirePath 的帮助下）。但是，返回的 HtmlNodeCollection 始终为 NULL。

```
HtmlWeb web = new HtmlWeb();
HtmlAgilityPack.HtmlDocument htmlDoc = web.Load("http://www.google.com/search?num=10&q=Hello+World");

// get search result URLs
var items = htmlDoc.DocumentNode.SelectNodes("//div[@id='ires']/ol[@id='rso']/li/div[@class='vsc']/h3/a/@href");

foreach (HtmlNode node in items)
{
    Console.WriteLine(node.Attributes);
} 
```

我错过了什么吗？任何人都可以请赐教吗？

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:17:54.157

HAP 只能处理从 url 返回的原始 HTML，它不会运行页面上的任何其他 javascript 或诸如此类的东西。您需要相应地调整您的查询。

在原始 HTML 中，`ires`div 存在，但在`rso`运行 javascript 之前不会插入，因此您不会得到任何结果。这里还完成了其他转换，您也必须对其进行调整。

这是 HTML 的一个片段：

```
<div id="ires">
    <ol>
        <li class="g">
            <h3 class="r">
                <a href="...">...</a> 
```

用于此的更合适的 xpath 是：

```
var xpath = "//li[contains(concat(' ',@class,' '),' g ')]" +
            "/h3[contains(concat(' ',@class,' '),' r ')]" +
            "/a/@href"; 
```

`li`使用类找到所有内容会更容易，`g`因为它们对应于所有结果。您需要`h3`使用`r`该类过滤所有内容，否则您将包含其他结果（例如图像结果）。

# javascript - CSS Sprites 性能

> ID：12164517
> 
> 赞同：7
> 
> 时间：2012-08-28T17:32:19.793
> 
> 标签：javascript, css, performance, css-sprites, knockout-2.0

我有静态图像 500x640 坐在由 20x20 块和 css 精灵组成的文件夹中，我正在设置背景位置来显示每一块，我需要这种显示以便以后能够对每一块进行操作。

CSS：

```
 .piece
        {
            width: 20px;
            height: 20px;
            display: inline-block;
            //display: inline;
            //zoom:1;
        }        

    .ob { background-image: url("/Images/ob.jpg");} 
```

js：

```
<script id="flipTemplate" type="text/html">
    <div class="piece ob" data-bind="style: { backgroundPosition: viewModel.getLeftValue($index) + ' ' + viewModel.getTopValue($index) }, attr: {cond: Cond, id: Id }, click: viewModel.setClick ">
                </div>
</script>
<script type="text/javascript">
    viewModel = {
        flips: ko.observableArray([]),      

        setClick: function (data, e) {
            e.preventDefault();            
            //doing click
        },

        getLeftValue: function (index) {

            var position = 0;

            var currentLine = div(index(), 25);

            if (currentLine > 0)
                return '-' + (index() - (currentLine * 25)) * 20 + 'px';
            else
                return '-' + index() * 20 + 'px';
        },

        getTopValue: function (index) {

            return '-' + (div(index(), 25)) * 20 + 'px';
        }
    };    

    ko.applyBindings(viewModel);
</script>
function div(val, by){
    return (val - val % by) / by;
} 
```

所以我有一些性能问题。例如，在 Opera 和 FF 图像中加载非常快，大约 1 秒，在 IE 中大约 3 秒，但在 Chrome 中加载非常慢![在此处输入图像描述](../Images/d020957798b72c69da44ac5ef970d392.png)

在 Chrome 中显示所有部分大约需要 17 秒...

浏览器只执行一个请求来获取图像而不是从中切割小块，为什么在 Chrome 中可能需要这么长时间？

有什么办法可以提高性能吗？ ![在此处输入图像描述](../Images/9c4f95699b492c33e564ef305b1db730.png)

刚刚做了 CTRL+Refresh 和这里奇怪的加载结果： ![在此处输入图像描述](../Images/a6cc21f79cfcca73607097ef7a210f4f.png)

**更新：我刚刚在这里放了一个样本：http: [//bit.ly/TrcCdp](http://bit.ly/TrcCdp)**

**更新：** 在我的示例中有 JSON 数组，它包含 800 个元素，所以我只是找出如果我减少它，例如 600-700 个元素，性能会越来越好，但无论如何我需要 800 个元素。

例如，当只有 600 个元素时，它会将 Chrome 中的负载减少到大约 6 秒....

所以可能是淘汰迭代模板的某个地方的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-29T17:23:08.150

问题不在于图像。可以通过在顶部任何样式表或脚本标记之前放置预加载来修复图像：

```
<meta name="viewport" content="width=device-width">

<script type="text/javascript">
    var img = new Image();
    img.src = 'TestApp_files/obm000.jpg';
</script>

<link href="TestApp_files/jquery00.css" rel="stylesheet">
<link href="TestApp_files/jquery01.css" rel="stylesheet">
<!-- ad nauseum --> 
```

在此之后，图像在 170 毫秒（本地）内加载。然而，在试图决定要做什么之后，该页面仍然会再混乱 10 到 15 秒。

根本问题是javascript绝对是一团糟。图像/文件/函数名称是神秘的。页面中间的东西取决于末尾的代码取决于开头的代码取决于末尾的代码。控制器/视图/模型逻辑遍布地图。全局变量和多文件耦合...呵呵`</soapbox>`，现在开始治疗症状。

**问题 1：在 DOM 加载之前绑定敲除**

将 applyBindings 放入 domready 回调中：

```
jQuery(function($) {
   ko.applyBindings(viewModel);
}); 
```

**问题2：foreach很慢**

对于大型数据集，淘汰赛 foreach 绑定非常慢。您可以尝试使用 jQuery 模板并在模板中移动 foreach，[如此 SO question 中所述](https://stackoverflow.com/questions/9709374/knockout-js-incredibly-slow-under-semi-large-datasets)。它似乎将时间缩短到大约 3 秒。

我真的不明白为什么这是必要的，因为它似乎与您当前的 foreach 渲染得很好，它只是永远挂起，而淘汰赛在后台做了一些魔术，据我所知，在 foreach 完成后发生。

旁注：是否有必要将翻转放入可观察数组？我假设您打算稍后使用它，因为当前代码中不需要它。如果没有，请将其取出，它将有助于提高性能（尽管它不会解决此问题）。

干杯，我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T23:23:54.567

`foreach`这是绑定和 Chrome之间的某种奇怪的渲染错误。我尝试在模板中添加一个字符，然后`div`修复延迟（但也搞砸了布局）。

解决此问题的一个好方法是使用`foreach`. 我的[`repeat`绑定](https://github.com/mbest/knockout-repeat)在这里运行良好，解决了延迟问题。

这是您使用的代码部分`repeat`：

```
<div class="condListHolder" style="width:558px">
    <div class="cond2" title="Click to flip" data-bind="repeat: flips">
        <div class="piece obm" data-bind="
          style: { backgroundPosition: getLeftValue($index) + ' ' + getTopValue($index) },
          attr: {cond: $item().cond, id: $item().Id },
          click: setClick "></div>
    </div>
</div> 
```

因为`repeat`不使用可观察的 for `$index`，所以您还需要更改您的`getTopValue`and`getLeftValue`函数以取出 之后的`()`括号`index`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T08:16:11.593

You should also look into streamlining your code that is called by the foreach loop. I don't know how often you call the `getLeftValue` and `getTopValue` methods but they are pretty unoptimized.

*   Try limiting function calls that give you the same result, use local vars to cache since they are cheap
*   don't concatenate strings in large loops, this is way slower than using an array to join them.

I tried optimizing your two functions. You should see at least some improvement:

```
getLeftValue: function (index) {

    var position = 0,
        realIndex = index(),
        currentLine = div(realIndex, 25);

    if (currentLine > 0)
        return ["-", (realIndex - (currentLine * 25)) * 20, "px"].join("");
    else
        return ["-", realIndex, "px"].join("");
},

getTopValue: function (index) {

    return ["-",(div(index(), 25)) * 20,"px"].join("");
} 
```

# javascript - jQuery - 如果存在正文区域，则删除元素

> ID：12164520
> 
> 赞同：2
> 
> 时间：2012-08-28T17:32:43.113
> 
> 标签：javascript, jquery, jquery-animate

我正在使用 jQuery animate 来更改页面上多个元素（装饰元素）的位置。如果元素退出`body`区域，我希望元素被删除。（如果`left`大于`body width`或`top`大于`body height`）。

在我的情况下不能使用以下内容：

*   为身体隐藏溢出
*   手动为元素设置动画。我想使用 jQuery animate 来保持简单（我动态地创建元素，为它们设置动画然后我不关心它们，不跟踪它们，当动画完成时它们有一个 .remove() 方法）

[http://jsfiddle.net/a7Nck/](http://jsfiddle.net/a7Nck/)

所以在这个 JSfiddle 中，我希望红色 div 在到达右边缘时消失，`body`这样就不会出现滚动条。

例如，是否没有任何 CSS3 媒体查询，以便如果 div 不在视口中，它将被隐藏？

**编辑：**

我只是想到了一个解决方案：在触发动画之前获取主体的宽度，然后`top`通过`left`使用主体大小和动画应该做什么之间的最小值来设置动画。问题是这会影响动画速度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:49:55.377

您可以使用动画的`step`功能。

> .animate() 的第二个版本提供了一个 step 选项——一个在动画的每一步触发的回调函数。此函数对于启用自定义动画类型或更改正在发生的动画很有用。它接受两个参数（now 和 fx），并将其设置为动画的 DOM 元素。

```
var w = $(window).width()
$('div').animate({
    left: '20px'
}, 500).delay(1000).animate({
    left: '2000px'
}, {
    step: function(now, fx) {
        if (now > w) {
            $(fx.elem).remove()
        }
    }
}, 1000); 
```

[小提琴](http://jsfiddle.net/a7Nck/4/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:50:28.227

一种可能的解决方法（假设您的第一个限制是关于全局添加`overflow: hidden`CSS）：`overflow: hidden`在动画开始时使用 js 添加，并在动画结束时将其删除：

```
$('body').css('overflow', 'hidden');
$('div').animate({left: '20px'},400).delay(1000).animate(
    {left: '2000px'},1000, false, function(){ 
    $(this).hide();
    $('body').css('overflow', 'auto');
});​ 
```

[http://jsfiddle.net/a7Nck/3/](http://jsfiddle.net/a7Nck/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:45:17.697

当最后一个动画完成时隐藏 div 即

```
$('div').animate({left: '20px'},400).delay(1000).animate({left: '2000px'},1000, function(){ $(this).hide(); }); 
```

见[演示](http://jsfiddle.net/a7Nck/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T17:49:56.117

一旦 div 离开可见区域，滚动条就会出现。如果要防止滚动条出现，就不能让 div 离开屏幕。这是我的解决方案：

```
$('div')
    .animate({left: '20px'},400)
    .delay(1000)
    .animate(
        {left: ($(window).width()-$('div').width()) + "px"},
        1000,
        null, // default easing
        function() { $('div').hide() }
    ); 
```

jsfiddle：http: [//jsfiddle.net/j4rdA/1/](http://jsfiddle.net/j4rdA/1/)

​</p>

# c++ - 为什么使用 Boost pool ordered_free() 而不是 free()？

> ID：12164521
> 
> 赞同：1
> 
> 时间：2012-08-28T17:32:53.803
> 
> 标签：c++, memory-management

为什么会选择使用`ordered_free()`而不是`free()`使用 Boost 池？假定`ordered_free()`总是`O(n)`同时`free()`应该是`O(1)`。碎片更少有什么好处吗？我的用例是在高性能服务器中使用 Boost 池，该服务器将全天运行，全天进行大量分配和解除分配。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:43:50.620

[该文档](http://www.boost.org/doc/libs/release/libs/pool/doc/html/boost_pool/pool/interfaces.html#boost_pool.pool.interfaces.ordered_versus_unordered)回答了这个问题：

> 有序池按照每个空闲块的地址顺序维护它的空闲列表 - 如果您可能分配对象数组，这是最有效的方式。然而，释放一个对象在当前空闲块的数量上可能是 O(N)，这在某些情况下可能会非常昂贵。
> 
> 无序池不会以任何特定顺序维护它的空闲列表，因此分配和释放单个对象非常快，但分配数组可能会很慢（特别是池可能不知道它包含足够的空闲内存用于分配请求，并不必要地分配更多内存）。

# magento - magento - 使用旧安装的产品、客户和订单进行干净安装

> ID：12164525
> 
> 赞同：2
> 
> 时间：2012-08-28T17:33:06.210
> 
> 标签：magento, reinstall

我在专用服务器上运行了 magento 1.6.2（ubuntu 10.04 lts）

我尝试了各种方法将 magento 升级到 1.7.0.2，但没有成功。

现在我正在考虑安装一个新的 magento 1.7.0.2 并重建商店。这样我就不再有旧的已删除扩展程序的垃圾了。

但我希望在我的全新安装中导入所有当前数据，如产品、订单、客户、邮件列表等。

我怎样才能做到这一点？或者这不是一个好主意吗？

我希望有一个人可以帮助我 ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T13:46:37.930

试试 Magento 数据库修复工具：

[http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/db-repair-tool](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/db-repair-tool)

在删除不需要的表/键后，我会安装你所拥有的东西。上述工具将使您能够识别要删除的内容。它还将让您对您的数据库构建充满信心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T18:11:18.313

不升级到最新版本而不是免费安装似乎不是一个好主意，因为您可以导入所有产品和客户，但没有直接的方法来导入新安装的订单和其他信息。

我个人建议您应该再次尝试升级到最新版本，因为我已经将几个项目从 Magento 1.6.2 升级到最新版本，并且升级时没有出现这么大的问题。

您只需要记住基本的事情，比如在升级之前保持备份等等。

使用最新的 connect20 密钥进行升级，即

[http://connect20.magentocommerce.com/community/Mage_All_Latest](http://connect20.magentocommerce.com/community/Mage_All_Latest)

希望这会有所帮助，或者您可以告诉您在升级过程中遇到的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-29T18:25:14.813

我已经找到了...

新安装将按以下方式工作...

1.  复制您的数据库库
2.  将您的媒体文件夹复制到新文件夹
3.  而不是将从magento OS commerce下载的新文件复制到服务器
4.  安装magento并从第1点填写您的数据库基础凭据...
5.  现在您有了全新的安装，但您的所有数据（订单、客户、产品、新闻通讯等）

# jsessionid - 寻找生成jsessionid的代码

> ID：12164532
> 
> 赞同：1
> 
> 时间：2012-08-28T17:33:41.733
> 
> 标签：jsessionid

我正在寻找用于创建 jsessionids 的默认代码库。它可能因实例而异，但我似乎无法在网上找到它，只是解释如何更改/设置它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:40:35.220

JSESSIONID cookie 在创建会话时创建/发送。Session 是在您的代码第一次调用 request.getSession() 或 request.getSession(true) 时创建的。如果您只想获取会话，但如果它不存在则不创建它，请使用 request.getSession(false) - 这将返回一个会话或 null。在这种情况下，不会创建新会话，也不会发送 JSESSIONID cookie。（这也意味着会话不一定是在第一次请求时创建的......您和您的代码在创建会话时处于控制之中）

会话是每个上下文的：

```
SRV.7.3 Session Scope

HttpSession objects must be scoped at the application (or servlet context) level. The underlying mechanism, such as the cookie used to establish the session, can be the same for different contexts, but the object referenced, including the attributes in that object, must never be shared between contexts by the container. 
```

# iphone - splitViewController中如何让detailview和masterView通信？

> ID：12164540
> 
> 赞同：1
> 
> 时间：2012-08-28T17:34:09.890
> 
> 标签：iphone, cocoa-touch, ipad, uisplitviewcontroller

我有`UISplitView`a`masterView`和 a `detailView`。`masterView`是 a `UITableViewController`（在 a 内）`UINavigationControler`和 the`detailView`是 a `UIViewController`（也在 a 内`UINavaigationController`）。

和一个空的`UISplitView`看起来就好了。在，我有这个方法：`masterView``detailView``masterView`

```
 - (void)tableView:(UITableView *)aTableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
    {
       if (![self splitViewController])
       DetailViewController*myDetailView = [[DetailViewController alloc] init];
       Item *selectedItem = [items objectAtIndex:[indexPath row]];
       [myDetailView setItem:selectedItem];
       [[self navigationController] pushViewController:myDetailView animated:YES];
    } 
```

这适用于 iPhone。对于 iPad，尽管正确`detailView`显示在 中，但详细视图仍然为空。`masterViewController`

我怎样才能使出 `myDetailview`现在`detailView`（右侧`splitView`）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T10:58:51.670

我建议你使用 Matt gemmell 的[`MGSplitViewController`](https://github.com/mattgemmell/MGSplitViewController)

他已经自定义了拆分视图控制器中的所有内容，您可以使用它让主控在右侧，您说`UISplitViewController`在 iPhone 上工作正常很奇怪

要明确`UISplitViewController`的是特定于 iPad 而不是 iPhone

因此，请了解 iPad 特定的控制器，例如`UIPopOverController`和`UISplitViewController`

在 Doc's 中，您可以在第一行中自行阅读

```
Split view controllers are for use exclusively on iPad devices.

 Attempting to create one on other devices results in an exception. 
```

# c - 添加数字的程序不显示任何输出

> ID：12164542
> 
> 赞同：0
> 
> 时间：2012-08-28T17:34:14.630
> 
> 标签：c, pointers, memory-management

我对“添加计算器”有疑问。Valgrind 没有报告内存错误，也没有来自编译器的错误，但程序没有显示任何输出，尽管 printf -“Base is”。

所有指针和变量（我认为）都已正确初始化。

`getnum`函数获取一个数字，返回一个指向 char - 的指针`char *`， `add`函数将两个数字作为字符串处理，`return`s`result`也是指向 char ( `char *`) 的指针。

我不知道问题是内存分配还是连接到处理数组的过程......

这是代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <string.h>

#define MAX(A,B) ((A)>(B) ? (A) : (B))

char *getnum(FILE *infile, int base)
{
    int len = 10;
    int c;
    int pos = 0;
    char *num = NULL;
    char *tmpnum = NULL;

    num = malloc(sizeof(char)*len);

    while (((c = fgetc(infile)) != EOF) && (isalnum(c))) {

        if (isdigit(c)) {
           /* irrelevant*/
        }
        else if (isalpha(c)) {
            fprintf(stderr, "Wrong base, expected 16\n");
            free(num);
            return NULL;

        }
        if (pos >= len) {
            /*realloc*/
        }
    }

    return num;           
} 
```

* * *

```
int main(int argc, char **argv)
{
    FILE *infile = NULL;
    char *number1 = NULL;
    char *number2 = NULL;
    char *result = NULL;
    int base, i, j = 0, length, count = 0;

    infile = fopen(argv[1], "r");

    base  = atoi(argv[2]);
    while (!feof(infile)) {
        number1 = getnum(infile, base);

        number2 = getnum(infile, base);

        break;
    }
    printf("Base is %d\n", base);
    result = add(number1, number2, base);

    length = strlen(result);
    for (i = 0; i <= length - 1; i++) {
        if (result[i] == '0') {
            count++;
        }
    }

    for (j = i; j == (length - 1); j++) {
        printf("Result is: %s\n", &result[j]);
        break;
    }
    free(result);
    result = NULL;
    fclose(infile);
    return 0;
} 
```

在过去的 4 个小时里试图解决它，但找不到错误。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:07:59.587

结尾处有一处严重错别字`main()`。

```
for (j = i; j == (length - 1); j++) {
/*            ^^ SHOULD BE <= */
    printf("Result is: %s\n", &result[j]);
    break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:21:55.177

看这段代码：

```
for (i = 0; i <= length - 1; i++) {
    if (result[i] == '0') {
        count++;
    }
}
if (count == length) {
    printf("Result is 0\n");
    free(result);
    result = NULL;                     /* arguable */
    fclose(infile);
    return 0;
}
for (i = 0; i <= length - 1; i++) {
    if (result[i] != '0') {
        break;
    }
}
for (j = i; j == (length - 1); j++) {
    printf("Result is: %s\n", &result[j]);
    break;
} 
```

1.  与其计算输出数中零的总数，然后再次计算前导零的数量，为什么不将两者结合起来呢？
2.  最后一个循环是关于什么的？它甚至不是一个真正的循环——它会执行一次 if `i`is `length - 1`，否则根本不执行（大概你在测试输入中遇到了后一种情况）。

例如

```
for (count = 0; count < length; count++) {
    if (result[count] != '0')
        break;
}
if (count == length) {
    printf("Result is 0\n");
    free(result);
    result = NULL;                     /* arguable */
    fclose(infile);
    return 0;
}
printf("Result is: %s\n", &result[count]); 
```

# php - db类上的mysql_query错误

> ID：12164544
> 
> 赞同：0
> 
> 时间：2012-08-28T17:34:29.070
> 
> 标签：php, mysql

我正在尝试编写简单的用户注册页面并使用与下面相同的简单 DBCONNECTOR 类，当我尝试将用户发送到数据库时，我得到 mysql_query() 错误。这是我的 php 代码和类，请帮我解决问题

这是我的 dbconnector 类：

```
<?php
    require_once 'UConfig.inf.php';
    class udbcl extends USettings{
        var $link;
        var $myquery;
        function UDbconnect(){
            $DBinfo=USettings::GSettings();
            $DBhost=$DBinfo['UDbhost'];
            $DBname=$DBinfo['UDbname'];
            $DBusername=$DBinfo['UDbusername'];
            $DBpassword=$DBinfo['UDbpassword'];
            $this->link=mysql_connect($DBhost,$DBusername,$DBpassword);
            mysql_select_db($DBname);

        }
      function UQuery($myquery){
          $this->link=$myquery;
          return mysql_query($myquery,  $this->link);

      }
      function UFetch($result){
         return mysql_fetch_array($result);
      }
      function UDbclose(){
          mysql_close($this->link);

      }
    }

?> 
```

这是我的 register.php 页面：

```
<?php
require_once ('UConfig/UDbconnector.php');
$myinfoadd = new udbcl();
if (isset($_POST['username'])) {
    $myq = "INSERT INTO userinfo(username,password,email,telphon) VALUES('$_POST[username]','$_POST[password]','$_POST[email]','$_POST[telnumber]')";
    $myinfoadd->UQuery($myq);
    $myinfoadd->UDbclose();
    echo "You registration is Success!";
    sleep(3);
    header('Location:index.php');
} else {
    print <<<hldoc
    <html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>U S R R</title></head><body><form method="POST" action="register.php" ><b>User Name:</b> <input type="text" name="username" /><br/><b>User Password:</b><input type="password" name="password" /><br/><b>User Email:</b><input type="email" name="email" /><br/><b>User Tel:</b><input type="telnumber" name="telnumber" /><br/><input type ="submit" name="submit" value="Register"/></form></body></html>
hldoc;
}
?> 
```

当我尝试注册用户时，出现如下错误：

> 警告：mysql_query()：提供的参数不是第 18 行 C:\xampp\htdocs\uzu\UConfig\UDbconnector.php 中的有效 MySQL-Link 资源
> 
> 警告：mysql_close()：提供的参数不是第 25 行 C:\xampp\htdocs\uzu\UConfig\UDbconnector.php 中的有效 MySQL-Link 资源
> 
> 您注册成功！
> 
> 警告：无法修改标头信息 - 标头已由第 10 行 C:\xampp\htdocs\uzu\register.php 中的（输出从 C:\xampp\htdocs\uzu\UConfig\UDbconnector.php:18 开始）发送

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:46:37.013

```
function UQuery($myquery){
    $this->link=$myquery;
    return mysql_query($myquery,  $this->link);
} 
```

上述函数等价于：

```
function UQuery($myquery){
    $this->link=$myquery;
    return mysql_query($myquery,  $myquery);
} 
```

不要重新分配`$this->link`，你应该没问题。

**更新**

我还注意到您从未初始化链接。您应该在类构造函数中执行此操作，或者将其作为参数传递*给*构造函数。

```
class udbcl extends USettings{
    var $link;
    var $myquery;

    public function __construct($dbLink = null) {
        if (is_null($dbLink)) {
            $dbLink = $this->UDbconnect();
        }
        $this->link = $dbLink;
    } 

    private function UDbconnect(){
        $DBinfo=USettings::GSettings();
        $DBhost=$DBinfo['UDbhost'];
        $DBname=$DBinfo['UDbname'];
        $DBusername=$DBinfo['UDbusername'];
        $DBpassword=$DBinfo['UDbpassword'];
        $this->link=mysql_connect($DBhost,$DBusername,$DBpassword);
        mysql_select_db($DBname);
    }
    .
    .
    .
} 
```

# python - 确定 python 实例正在执行什么脚本/模块？

> ID：12164546
> 
> 赞同：2
> 
> 时间：2012-08-28T17:34:50.380
> 
> 标签：python, process, monitor

我正在编写一个程序来监视正在运行的 python 脚本。该脚本将有多个实例，即服务器，从计算机上的不同位置运行。我的程序将监视以查看所有被“监视”的实例是否已启动并正在运行，并将在必要时重新启动它们。

无法编辑服务器脚本。

我的问题是服务器进程只是显示为 python 可执行文件，我无法确定特定服务器脚本在计算机上的位置。

无论如何确定在特定的 python/pythonw.exe 进程上实际运行的脚本是什么？还有它的路径？

ENV：仅限 Windows

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:42:07.980

您可以从命令行运行以下命令：

```
WMIC PROCESS get Caption,Commandline,Processid,ExecutablePath 
```

这将显示正在执行的模块。

# javascript - 在所有页面上仅显示某些自定义侧边栏组件

> ID：12164548
> 
> 赞同：0
> 
> 时间：2012-08-28T17:35:06.517
> 
> 标签：javascript, salesforce, visualforce

我们有大约 10 个自定义主页组件。我需要在页面上显示一个名为“注册”的自定义对象。

在设置/应用设置/自定义/用户界面中有一个设置，“在所有页面上显示自定义侧边栏组件”。问题是它将在所有页面上显示所有 10 个自定义组件，而我只需要显示一个。任何想法如何做到这一点？

附带说明一下，此自定义组件由将自定义查找窗口链接注入标准页面布局的 JavaScript 组成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T21:05:10.053

您如何将组件组合成一个组件，然后在组件内部使用javascript来确定（基于document.location）是否显示子组件。

# r - period.apply 在 xts 中返回超过 1 个值

> ID：12164553
> 
> 赞同：3
> 
> 时间：2012-08-28T17:35:33.850
> 
> 标签：r, time-series, xts, zoo

我有一个`xts`对象，我正在尝试使用`period.apply`一个函数，该函数将为每个非重叠时段返回多个值。例如：我运行回归并希望返回每个非重叠时期的残差，因此我的函数返回该时期的所有日期以及每个特定日期的残差。目前似乎`xts`不支持这种行为。这个对吗？有解决办法吗？

```
> df <- data.frame(x=rnorm(31)+10, y=rnorm(31)+10)
> xts.data <- xts(df, order.by=as.Date(13514:(13544),origin="1970-01-01"))
> f <- function(d) {as.numeric(coredata(d[,"x"]))}
> period.apply(xts.data, INDEX=endpoints(xts.data,"weeks"), FUN=f)
Error in coredata.xts(x) : currently unsupported data type 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:50:02.420

我突然想到这个问题很可能是每个非重叠周期没有相同数量的观察值，因此无法轻松创建类似矩阵的结构。

改用这样的东西，并注意每个列表元素的长度不同：

```
lapply(split(xts.data,"weeks"), f) 
```

为了说明如何`period.apply`在每个期间返回多于一列：

```
period.apply(xts.data, endpoints(xts.data,"weeks"), range)
period.apply(xts.data, endpoints(xts.data,"weeks"), colMeans) 
```

# python - Logging SMTP connections with Twisted

> ID：12164557
> 
> 赞同：0
> 
> 时间：2012-08-28T17:35:59.603
> 
> 标签：python, twisted, smtpd

Python newbie here. I'm writing an SMTP server using Twisted and twisted.mail.smtp. I'd like to log incoming connections and possibly dump them when there are too many concurrent connections. Basically, I want ConsoleMessageDelivery.connectionMade() method to be called in the following, when a new connection is made:

```
class ConsoleMessageDelivery:
    implements(smtp.IMessageDelivery)

    def connectionMade(self):
        # This never gets called

    def receivedHeader(self, helo, origin, recipients):
        myHostname, clientIP = helo
        headerValue = "by %s from %s with ESMTP ; %s" % (myHostname, clientIP, smtp.rfc822date())
        # email.Header.Header used for automatic wrapping of long lines
        return "Received: %s" % Header(headerValue)

    def validateFrom(self, helo, origin):
        # All addresses are accepted
        return origin

    def validateTo(self, user):
        if user.dest.local == "console":
            return lambda: ConsoleMessage()
        raise smtp.SMTPBadRcpt(user)

class ConsoleMessage:
    implements(smtp.IMessage)

    def __init__(self):
        self.lines = []

    def lineReceived(self, line):
        self.lines.append(line)

    def eomReceived(self):
        return defer.succeed(None)

    def connectionLost(self):
        # There was an error, throw away the stored lines
        self.lines = None

class ConsoleSMTPFactory(smtp.SMTPFactory):
    protocol = smtp.ESMTP

    def __init__(self, *a, **kw):
        smtp.SMTPFactory.__init__(self, *a, **kw)
        self.delivery = ConsoleMessageDelivery()

    def buildProtocol(self, addr):
        p = smtp.SMTPFactory.buildProtocol(self, addr)
        p.delivery = self.delivery
        return p 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:31:14.063

`connectionMade` is part of `twisted.internet.interfaces.IProtocol`, not part of `twisted.mail.smtp.IMessageDelivery`. There's no code anywhere in the mail server implementation that cares about a `connectionMade` method on a message delivery implementation.

A better place to put *per connection* logic is in the factory. And specifically, a good way to approach this is with a factory *wrapper*, to isolate the logic about connection limits and logging from the logic about servicing SMTP connections.

Twisted comes with a few factory wrappers. A couple in particular that might be interesting to you are `twisted.protocols.policies.LimitConnectionsByPeer` and `twisted.protocols.policies.LimitTotalConnectionsFactory`.

Unfortunately, I don't know of any documentation explaining `twisted.protocols.policies`. Fortunately, it's not too complicated. Most of the factories in the module wrap another arbitrary factory to add some piece of behavior. So, for example, to use `LimitConnectionsByPeer`, you do something like this:

```
from twisted.protocols.policies import LimitConnectionsByPeer
...
factory = ConsoleSMTPFactory()
wrapper = LimitConnectionsByPeer(ConsoleSMTPFactory(...))
reactor.listenTCP(465, wrapper) 
```

This is all that's needed to get `LimitConnectionsByPeer` to do its job.

There's only a little bit more complexity involved in writing your own wrapper. First, subclass `WrappingFactory`. Then implement whichever methods you're interested in customizing. In your case, if you want to reject connections from a certain IP, that would mean overriding `buildProtocol`. Then, unless you also want to customize the protocol that is constructed (which you don't in this case), call the base implementation and return its result. For example:

```
from twisted.protocols.policies import WrappingFactory

class DenyFactory(WrappingFactory):
    def buildProtocol(self, clientAddress):
        if clientAddress.host == '1.3.3.7':
            # Reject it
            return None
         # Accept everything else
         return WrappingFactory.buildProtocol(self, clientAddress) 
```

These wrappers stack, so you can combine them as well:

```
from twisted.protocols.policies import LimitConnectionsByPeer
...
factory = ConsoleSMTPFactory()
wrapper = LimitConnectionsByPeer(DenyFactory(ConsoleSMTPFactory(...)))
reactor.listenTCP(465, wrapper) 
```

# extjs - EXT.JS 循环遍历存储并在项目数组中生成组件

> ID：12164560
> 
> 赞同：5
> 
> 时间：2012-08-28T17:36:10.510
> 
> 标签：extjs, extjs4

我正在尝试使用商店中填充的数据将一堆组件添加到我的容器中。我想遍历我的商店记录并输出标签/面板/等来显示数据。

这就是我现在循环的方式：

```
 initComponent: function () {
  //Create a container for each array, then in that container, 
  //create a label and wrapping panel, then add the items to the wrapping panel
  this.store = Ext.create('Ext.data.Store', {
     model: 'MyProject.model.ItemArray',
     data: []
  });
  Ext.apply(this, {
     items: [
        this.store.each(function() {
           {
              xtype:'label', text:
              'test'
           }
        })
     ]
  });

  this.callParent(arguments);
} 
```

但是，当然，作为我的 EXTJS 菜鸟，这是行不通的。我将不胜感激您可以提供任何建议和最佳实践技巧以使其正常工作。

我的模型 ItemArray 包含 Items。我需要遍历我的 ItemArrays 存储并制作容器，然后遍历 ItemArray 中的 Items，用 Items 填充这些容器。

感谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T20:33:26.070

您需要先加载您的商店，然后在商店回调中生成您的标签。

```
var me = this;
me.store.load(function(records) {
    Ext.each(records, function(record) {
        //Add a container for each record
        me.add({
            xtype: 'container',
            items: [] //your labels here
        });
    });
});​ 
```

在您的示例中，您的商店尚未填充。它还异步加载，因此会有轻微的延迟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T23:01:42.393

```
Ext.define('Foo', {

    initComponent: function(){
        // assumes store is loaded with data
        var store = new Ext.data.Store(),
            items = [];

        store.each(function(rec){
            items.push({
                html: rec.get('aField')
            });
        });
        this.items = items;
        this.callParent();
    }

}); 
```

# javascript - jQuery拆分数组问题

> ID：12164564
> 
> 赞同：1
> 
> 时间：2012-08-28T17:36:18.417
> 
> 标签：javascript, arrays, string, list, split

我曾尝试在数组字段上使用 jQuery 进行拆分，但它不起作用：

```
var arr;
arr[0] = 'size:256';
var vals = $(arr[0]).split(':');
alert(vals);​ 
```

为什么 ？

谢谢 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T17:37:21.603

jQuery 中不需要，只需要纯 JavaScript。String[`split`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/split)是原生的 JS 函数。

```
var arr = [];     // and don't forget to initialize array
arr[0] = 'size:256';

var vals = arr[0].split(':');
alert(vals[0]);   // gives "size"
alert(vals[1]);   // gives "256" 
```

# javascript - 控制来自不同主机的内容的图像宽度

> ID：12164565
> 
> 赞同：1
> 
> 时间：2012-08-28T17:36:20.763
> 
> 标签：javascript, css, same-origin-policy, fluid-layout

我想控制来自不同主机的内容的图像宽度。此内容显示在 iframe 内。我无法控制此远程内容。

根据我的测试，如果 iframe 的内容来自同一主机，则尝试更改图像的宽度（使用 CSS 和 javascript）似乎有效，但如果来自不同的主机则不起作用。似乎这受到同源政策“http://en.wikipedia.org/wiki/Same_origin_policy”的限制（这是正确的吗？还是我错了？），并且似乎唯一的方法是拉远程内容并执行一个预处理（服务器端）来修改该内容（更改图像的宽度）然后显示该内容，但如果可能只使用 CSS 或/和 javascript，我不想采用这种方式。有人可以在 iframe 中的内容上仅使用 CSS 和/或 javascript 给我一些指导吗？（请记住，内容来自不同的主机）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:38:10.800

你的分析是对的。

如果你想改变你需要的那些图像

*   服务器的协作（[使用标头](https://developer.mozilla.org/en-US/docs/HTTP_access_control)）
*   或一种服务器端代理，让浏览器认为只有一个来源

由于它是一个安全系统（针对用户），因此在现代浏览器上当然没有已知的解决方法。

您不能仅使用客户端跨浏览器解决方案来做到这一点。

# silverlight - 在模态窗口中的 Silverlight 中传输数据

> ID：12164570
> 
> 赞同：0
> 
> 时间：2012-08-28T17:36:54.317
> 
> 标签：silverlight, modal-window

如何在 silverlight 中将数据从一个窗口传输到另一个模式。我有一个窗口，按下按钮，另一个窗口出现，其中补充了示例文本框，来自这些字段的数据，我希望在上一个窗口中看到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:10:33.440

答案取决于您使用的框架类型。在具有视图模型优先方法的 caliburn micro 中，这些类型的事情非常简单。您只需创建一个新的视图模型并设置适当的字段，然后让 caliburn 为您处理显示它。使用其他视图优先方法会更加困难。您可以使用消息来设置字段，例如 MVVM Light。无论哪种方式，我们都需要有关您如何构建应用程序来回答您的问题的更多信息。

# jquery - scrollorama 是否水平工作

> ID：12164572
> 
> 赞同：4
> 
> 时间：2012-08-28T17:37:00.117
> 
> 标签：jquery

scrollorama[水平](http://johnpolacek.github.com/scrollorama/)工作吗？

它有一个持续时间，但是当 scoll 达到垂直阈值时就会开始

我想在水平滚动页面上使用这些功能

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-29T13:25:12.113

Scrollorama 未设置为水平滚动。但是，SuperScrollorama 是：

`var scrollyStuff = $.superscrollorama({isVertical:false});`

[http://johnpolacek.github.com/superscrollorama/](http://johnpolacek.github.com/superscrollorama/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-14T09:49:27.797

编辑**jquery.scrollorama.js**

**字符串 102：**

```
var scrollTop = $(window).scrollTop(), 
```

**改成：**

```
var scrollTop = $(window).scrollLeft(), 
```

# linux - 传递 shell 脚本变量来查找

> ID：12164573
> 
> 赞同：1
> 
> 时间：2012-08-28T17:37:02.397
> 
> 标签：linux, shell

我正在递归地重命名目录中的目录和文件。

```
alan/
    alan_0001.txt
    alan_0002.txt
andy/
    andy_0001.txt
    andy_0002.txt
andytwo/
    andytwo_0001.txt
    andytwo_0002.txt 
```

我有一个制表符分隔的文件（希望在这里复制），它提供了文件名的新信息；例如

```
alan     123_123     Alan's Place
andy     124_010     Andy's Place
andytwo     125_001     Andy's Second Place 
```

我已经制定了以下 shell 脚本，但我不确定如何在脚本的早期传递值以在最后找到。

```
#!/bin/sh

FILE="sample-list.txt"

exec 3<&0
exec 0<$FILE

while read line
do
    echo $line
    oldName=`echo "$line" | cut -f1`
    adminDB=`echo "$line" | cut -f2`
    title=`echo "$line" | cut -f3`
    echo "$oldName is old, his number is $adminDB, and the title is $title"
    echo "renaming files"
#    echo find -name '{$oldName}*' 
    echo "`find ./ -name '${oldName}*'`"
done
exec 0<&3 
```

我想使用通配符`$oldName`来捕获 andy_0001, _0002 文件并将它们重命名为`find ./ -name ${oldName}* -exec rename $oldName $adminDB {} \;`

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:48:22.307

我认为你只需要使用双引号：

```
find ./ -name "${oldName}*" -exec rename $oldName $adminDB {} \; 
```

* * *

您还可以通过让 shell 将输入行拆分为字段来节省一些代码：

```
while read oldName adminDB title; do
    ...
done 
```

您会丢失整行中的原始空格，因此如果这很重要，请忽略这个不请自来的建议。

# asp.net-mvc - 来自多个项目的表达式相等或等价

> ID：12164584
> 
> 赞同：1
> 
> 时间：2012-08-28T17:37:56.360
> 
> 标签：asp.net-mvc, unit-testing, expression

据了解：

```
Expression<Func<string, bool>> first = x => x.Length == 4;
Expression<Func<string, bool>> second = x => x.Length == 4;

Console.WriteLine(first.Equals(second)); // Output is "False" 
```

但是，检查每个表达式的字符串确实显示相等：

```
Expression<Func<string, bool>> first = x => x.Length == 4;
Expression<Func<string, bool>> second = x => x.Length == 4;

Console.WriteLine(first.ToString().Equals(second.ToString())); // Output is "True" 
```

这个想法是不同帖子的高潮......

[http://www.codethinked.com/Comparing-Simple-Lambda-Expressions-With-Moq](http://www.codethinked.com/Comparing-Simple-Lambda-Expressions-With-Moq) [Moq'ing 方法，其中 Expression<Func<T, bool>> 作为参数传入](https://stackoverflow.com/questions/5196669/moqing-methods-where-expressionfunct-bool-are-passed-in-as-parameters) [验证方法是使用某些 linq 表达式调用的（moq )](https://stackoverflow.com/questions/3458406/verify-method-was-called-with-certain-linq-expression-moq)

意图：

我正在使用存储库模式编写一个 MVC 应用程序，这样

```
public class MyController : Controller
{
    public Repository.IRepository Repository { get; set; }

    public MyController()
    {
        this.Repository = new Repository.CommonRepository();
    }

    public MyController(Repository.IRepository repository)
    {
        this.Repository = repository;
    }

    [HttpPost]
    public ActionResult Create(Domain.Common.Object1 o1)
    {
        if (ModelState.IsValid)
        {
            // Additional validation
            o1.Name = o1.Name.Trim();

            if (this.Repository.Any<Domain.Common.Object1>(a => a.Name.ToLower() == plant.Name.ToLower()))
                this.ModelState.AddModelError("Name", "Duplicate found.");
        }

        if (ModelState.IsValid)
        {
            var entity = this.Repository.Add(o1);

            if (Request.IsAjaxRequest())
                return this.Json(new { Completed = true, Id = entity.Id });

            return RedirectToAction("Details", new { id = entity.Id });
        }

        if (Request.IsAjaxRequest())
            return PartialView("_Create", o1);

        return View("Create", o1);
    }
} 
```

存储库与域一样是一个完全独立的项目。我的存储库代码已设置，以便我可以使用一个存储库来查询基于泛型的任何对象：

```
public IQueryable<T> GetAll<T>() where T : AbstractEntity
{
    return this.DbContext.Set<T>();
} 
```

注意：AbstractEntity 是我的所有 POCO 对象都继承自的域抽象类。

使用 Moq 对控制器进行单元测试时一切正常：

```
[TestMethod]
public void Create_Post_DuplicateNameAddsError()
{
    // Arrange
    var repository = new Mock<Repository.IRepository>();

    repository.Setup(a => a.Any<Domain.Common.Object1>(It.IsAny<System.Linq.Expressions.Expression<Func<Domain.Common.Object1, bool>>>()))
              .Returns(true);

    var controller = ControllerFactory<MyController>.GetController();
    controller.Repository = repository.Object;

    var model = new Domain.Common.Object1()
    {
        Id = Guid.NewGuid()
        ,
        Name = "Name"
    };

    // Act
    var result = controller.Create(model) as ViewResult;

    // Assert
    Assert.IsFalse(controller.ModelState.IsValid);

    Assert.IsNotNull(result);
    Assert.AreEqual("Create", result.ViewName, false);

    Assert.AreEqual(model, result.Model);
} 
```

注意：ControllerFactory 是一种生成具有某些属性的控制器的方法，例如 Request、Response、User、Request.Headers 等...

如果我必须多次使用 IRepository.Any(predicate) 或使用多次调用的表达式的任何方法，则失败的地方。我需要它对一个人说真，对另一个人说假。如果表达式字符串是匹配的，这将不是问题，但由于所有内容都在不同的项目中，表达式字符串的结果如下：

```
a => (a.Name.ToLower() == value(foo.Web.Tests.Controllers.Object1ControllerTests+<>c__DisplayClass3).ob1.Name.ToLower())
a => (a.Name.ToLower() == value(foo.Controllers.MyController+<>c__DisplayClass1).ob1.Name.ToLower()) 
```

区别在于价值函数。我已经尝试从正则表达式进行匹配，它有效，但很难看，因为你必须转义每个 .<>()，这反过来又使它很难维护。

我尝试使用[Matt Meber 的 Expression Equality Comparer](http://www.codethinked.com/Comparing-Simple-Lambda-Expressions-With-Moq)，但由于该值函数（我的信念），它们并不相等。

建议？

# javascript - Jquery for slide change event

> ID：12164585
> 
> 赞同：0
> 
> 时间：2012-08-28T17:38:02.630
> 
> 标签：javascript, jquery, css, jquery-cycle

My jquery code is like this

```
$(document).ready(function() {
    $(".slideshow").css("overflow","hidden");
    $("ul#slides").cycle({
    fx: 'fade',
    pause: 1,
    prev: '#prev',
    next: '#next'
}); 
```

And i want to know ,is there any slide change event in jquery for this...i mean i need to get the slide number when each slide changes

Thank you

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:04:44.167

Your question is about Cycle specifically, not general jQuery. The documentation on options for Cycle can be found [here](http://jquery.malsup.com/cycle/options.html).

It looks like there is an event called `onPrevNextEvent`:

```
onPrevNextEvent: null,// callback fn for prev/next events: function(isNext, zeroBasedSlideIndex, slideElement) 
```

The second parameter passed into a function you define for that event will be `zeroBasedSlideIndex`. That's your current slide number, with the first slide starting at 0.

So your code might look something like:

```
$(document).ready(function() {
    $(".slideshow").css("overflow","hidden");
    $("ul#slides").cycle({
    fx: 'fade',
    pause: 1,
    prev: '#prev',
    next: '#next',
    onPrevNextEvent: function(isNext, slideNum) {
        alert("This is slide "+ slideNum);
    }
}); 
```

# android - 在 Android 中的按钮上插入图库中的图像

> ID：12164587
> 
> 赞同：1
> 
> 时间：2012-08-28T17:38:08.997
> 
> 标签：android, android-gallery, android-button

我试图这样做：

```
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    if (requestCode == 1 && resultCode == RESULT_OK && null != data) {
        Uri selectedImage = data.getData();
        String[] filePathColumn = { MediaStore.Images.Media.DATA };

        Cursor cursor = getContentResolver().query(selectedImage,
                filePathColumn, null, null, null);
        cursor.moveToFirst();

        int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
        String picturePath = cursor.getString(columnIndex);
        cursor.close();
        Bitmap bmp = BitmapFactory.decodeFile(picturePath);
        b[1].setCompoundDrawablesWithIntrinsicBounds(null, new BitmapDrawable(bmp), null, null);
} 
```

但无论如何，它都不会设置图像。我也尝试了几种不同的方法，例如使用图像按钮而不是按钮并使用：

```
imageButton.setImageBitmap(bmp) 
```

画廊打开正常，回调来到 onActivityResult(...) 但图像不会出现在按钮上，我有一组按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T20:26:10.743

我做了一个快速测试。以下代码适用于我。如果这样你仍然无法设置图像，我会检查是否存在布局问题（即图像已设置但没有空间显示它）。

activity_main.xml 只有一个 ImageButton 设置为 wrap_content，在 match_parent 的主布局内。

```
public class MainActivity extends Activity {

    ImageButton imgButton;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        imgButton = (ImageButton) findViewById(R.id.imgButton);

        imgButton.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent intent = new Intent(Intent.ACTION_PICK);
                intent.setType("image/*");

                startActivityForResult(intent, 0);
            }
        });
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        if(requestCode == RESULT_CANCELED) return;

        ParcelFileDescriptor fd;
        try {
            fd = getContentResolver().openFileDescriptor(data.getData(), "r");
        } catch (FileNotFoundException e) {
            e.printStackTrace();
            return;
        }

        Bitmap bmp = BitmapFactory.decodeFileDescriptor(fd.getFileDescriptor());

        imgButton.setImageBitmap(bmp);
    }   
} 
```

# c# - 在 IIS（客户端）中安装 WCF 服务

> ID：12164594
> 
> 赞同：0
> 
> 时间：2012-08-28T17:38:34.953
> 
> 标签：c#, wcf, iis, service, installation

我搜索但找不到明确的答案...

我想在客户端（客户）安装我的 WCF 服务 (IIS) 有没有简单的方法可以做到这一点？

谢谢

附言。它的 C#

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:46:18.053

如果您希望您的客户自己执行此操作，您可以自己从 Visual Studio[发布](http://msdn.microsoft.com/en-us/library/31kztyey.aspx)它或创建 Visual Studio[安装项目。](http://msdn.microsoft.com/en-us/library/996a3fxs%28VS.71%29.aspx)

# jquery - jQuery滑块：活动链接

> ID：12164595
> 
> 赞同：0
> 
> 时间：2012-08-28T17:38:37.960
> 
> 标签：jquery, html, css

我正在研究一个全宽的 jQuery 滑块。我卡在导航上。当我单击“1”时，它转到滑块 1。在“2”上，它转到滑块 2……等等。但我希望链接颜色更改为#d45；当链接处于活动状态时。我尝试添加一个 a.active 类......但它似乎不起作用。

这是我的[小提琴](http://jsfiddle.net/5UYmu/1/)

这是我的代码：

**HTML**

```
<div class="slider">
    <div class="slide">1</div>
    <div class="slide">2</div>
    <div class="slide">3</div>
    <div class="slide">4</div>
</div>
<ul class="slider-nav">
    <li><a href="#" >1</a></li>
    <li><a href="#" >2</a></li>
    <li><a href="#" >3</a></li>
    <li><a href="#" >4</a></li>
</ul>
<div class="clear"></div>
<div class="content">
    <div class="wrapper">
        <p>Some site content will be here</p>
        <p>Some site content will be here</p>
        <p>Some site content will be here</p>
        <p>Some site content will be here</p>
        <p>Some site content will be here</p>
    </div>
</div>
<div class="footer">
    <div class="wrapper">&copy; www.mysite.com</div>
</div>​ 
```

**CSS**

```
.clear { clear:both; }
.wrapper { width:980px; margin:0 auto; }
.slider { margin:0 0; height:200px; position:relative;  }
.slider .slide { display:none; background:red; position:absolute; height:200px; width:100%; text-align:center; color:#fff; font-size:24pt; }
.header { background:#eee; font-size:18pt; }
.content { }
.footer { background:#eee; text-align:center; }

.slider-nav { margin: 0 auto; width:100px; clear:both; } 
.slider-nav li { float:left; margin:0 5px; }

.slider-nav li a.active { color:#d45; }
​ 
```

**jQuery**

```
$('.slider .slide:first').addClass('active').fadeIn(200);

function rotate(index) {
     $('.slider .slide.active').removeClass('active').fadeOut(200, function() { 
         $('.slider .slide:eq(' + index + ')').addClass('active').fadeIn(200);
     });   
}

$('.slider-nav li a').click(function() {    
    var index = $(this).parent().index('li');
    rotate(index);
    return false;
});

setInterval(function() {
    var $next = $('.slider .slide.active').next();

    if ($next.length == 0)
        $next = $('.slider .slide:first');

    rotate($next.index());
}, 2000);​ 
```

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:14:28.150

见[http://jsfiddle.net/5UYmu/3/](http://jsfiddle.net/5UYmu/3/)

```
$('.slider .slide:first').addClass('active').fadeIn(200);

function rotate(index) {
     $('.slider .slide.active').removeClass('active').fadeOut(200, function() {
         $('.slider .slide:eq(' + index + ')').addClass('active').fadeIn(200);
     });   
}

$('.slider-nav li').click(function() {
    clearInterval(timer);
    $(this).siblings('.active').removeClass('active');
    $(this).addClass('active');
    var index = $(this).index('li');
    rotate(index);
    timer=setInterval(go, 2000);
    return false;
});
$('.slider-nav li:first').click();
var timer=setInterval(go, 2000);
function go() {
    var $next = $('.slider-nav li.active').next();
    if ($next.length == 0){
        $next = $('.slider-nav li:first');
    }
    $next.click();
} 
```

如果将`click`事件添加到`'.slider-nav li'`而不是`'.slider-nav li a'`.

而为了解决你的问题，`.slide`你可以在中`click()`的下一个，而不是显示下一个。`<li>``.slider-nav`

此外，我认为最好清除用户单击导航链接时的间隔。这样我们就可以避免以下情况：

*   t=0 毫秒。间隔开始
*   t=2000 毫秒。下一张幻灯片
*   t=3900 毫秒。用户单击导航链接
*   t=4000 毫秒。下一张幻灯片

# jquery - 单击更改颜色文本

> ID：12164597
> 
> 赞同：2
> 
> 时间：2012-08-28T17:38:46.633
> 
> 标签：jquery, text, onclick

我希望文本*Collapsible Group Item #1*在我单击并且 div 折叠时变成红色，这是最好的方法？

这是我的情况

[http://jsfiddle.net/STqCF/66/](http://jsfiddle.net/STqCF/66/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:03:42.673

您可以使用带有回调的 .css 方法来切换颜色

```
$('.accordion').collapse();

$('.accordion').on('show hide', function(e){
    var $sib = $(e.target).siblings('.accordion-heading');
    $sib.css('color','red').find('.accordion-toggle i').toggleClass('icon-arrow-down icon-arrow-up', 200);
    $sib.find('a.accordion-toggle').css('color',function(){
        return $(e.target).hasClass('in') ? 'red':'#08C';
    });
}); 
```

[http://jsfiddle.net/STqCF/82/](http://jsfiddle.net/STqCF/82/)

**编辑：**

要添加字体粗体粗体，只需做同样的事情并链接另一个 .css 方法

```
$('.accordion').on('show hide', function(e){
    var $sib = $(e.target).siblings('.accordion-heading');
    $sib.css('color','red').find('.accordion-toggle i').toggleClass('icon-arrow-down icon-arrow-up', 200);
    $sib.find('a.accordion-toggle').css('color',function(){
        return $(e.target).hasClass('in') ? 'red':'#08C';
    }).css('font-weight',function(){
        return $(e.target).hasClass('in') ? 'bold':'';
    });
}); 
```

虽然更好的方法是使用 css 类.. 并切换该类

```
$('.accordion').on('show hide', function(e) {
    var $sib = $(e.target).siblings('.accordion-heading');
    $sib.css('color', 'red').find('.accordion-toggle i').toggleClass('icon-arrow-down icon-arrow-up', 200);
    $sib.find('a.accordion-toggle').toggleClass('aCollapsed', $(e.target).hasClass('in'));
});​ 
```

[http://jsfiddle.net/STqCF/112/](http://jsfiddle.net/STqCF/112/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:19:38.883

这是另一个更适合我的风格的解决方案。

我不得不尝试稍微解释一下您的问题-如果我完全误解了您要做什么，请原谅我。

这会将 is-off 类添加到未展开的标题中，并将 is-on 类添加到已展开的标题中。

[http://jsfiddle.net/STqCF/111/](http://jsfiddle.net/STqCF/111/)

```
// Cache our jQuery objects so we don't have to fetch them repeatedly
var $accordion = $('.accordion'),
    $accordionHeadings = $accordion.find('.accordion-heading');

// Collapse the accordion initially
$accordion.collapse();

$accordion.on('show hide', function(e){
    $(e.target).siblings('.accordion-heading').find('.accordion-toggle i').toggleClass('icon-arrow-down icon-arrow-up', 200);
});

// Bind an event to give an is-on state to the current headline and an is-off state to all other headlines
$('.accordion').on('show', function (e) {
    var $target = $(e.target);

    // Reset the class states - remove all is-ons and add is-offs
    $accordionHeadings.removeClass('is-on')
    $accordionHeadings.addClass('is-off');

    // For only the current item, add the is-on class and remove is-off
    $target.siblings('.accordion-heading')
        .addClass('is-on')
        .removeClass('is-off');
}); 
```

​</p>

# c# - 用鼠标点击创建新的瓷砖

> ID：12164599
> 
> 赞同：0
> 
> 时间：2012-08-28T17:38:53.300
> 
> 标签：c#, xna

我想知道你是否可以在这里帮助我，因为我有点难以用碰撞方法在屏幕上绘制一个新的瓷砖。单击鼠标时，我只是想在屏幕上绘制图块。注意这个图块需要在我创建的网格内。

这是我的关卡代码，当我创建一个看起来像这样的文本文件时，它会将图块绘制到屏幕上

```
...GGGGG....
....dddd....
............ 
```

代码

```
public class Level
{
    private Tile[,] tiles;

    ContentManager content;

    public Vector2 startPosition;

    public Level(ContentManager newContent, Stream fileStream)
    {
        content = newContent;
        LoadTiles(fileStream);
    }

    private void LoadTiles(Stream fileStream)
    {
        int width;
        List<string> lines = new List<string>();
        using (StreamReader reader = new StreamReader(fileStream))
        {
            string line = reader.ReadLine();
            width = line.Length;
            while (line != null)
            {
                lines.Add(line);
                if (line.Length != width)
                    throw new Exception(String.Format("Line {0} isn't the right length, sort it out, good debug method here ;)", lines.Count));
                line = reader.ReadLine();
            }
        }

        tiles = new Tile[width, lines.Count];

        for (int y = 0; y < Height; ++y)
            for (int x = 0; x < Width; ++x)
            {
                char tileType = lines[y][x];
                tiles[x, y] = LoadTile(tileType, x, y);
            }
    }

    private Tile LoadTile(char tileType, int x, int y)
    {
        switch (tileType)
        {
            case '.':
                return new Tile(null, TileCollision.Passable);

            // Grass
            case 'g':
                return LoadTile("Grass", TileCollision.Impassable);
            // Dirt
            case 'd':
                return LoadTile("Dirt", TileCollision.Impassable);

            // Log + Leaves || Log = "L" Leaves "l"
            case 'L':
                return LoadTile("Log", TileCollision.Passable);
            case 'l':
                return LoadTile("Leaves", TileCollision.Passable);

            // Stone
            case 'S':
                return LoadTile("Ore_Stone", TileCollision.Impassable);
            // Coal
            case 'c':
                return LoadTile("Ore_Coal", TileCollision.Impassable);

            // Door
            case '!':
                return LoadTile("Door_Top", TileCollision.Door);
            case '1':
                return LoadTile("Door_Bottom", TileCollision.Door);
            case 'b':
                // Brick
                return LoadTile("Brick", TileCollision.Passable);

            // Player spawn 'S'
            case 's':
                return LoadStartTile(x, y);

            default:
                throw new NotSupportedException(String.Format("Unsupported tile type character '{0}' at position {1}, {2}.", tileType, x, y));
        }
    }

    private Tile LoadStartTile(int x, int y)
    {

        startPosition = new Vector2(x * 32, y * 32);

        return new Tile(null, TileCollision.Passable);
    }

    private Tile LoadTile(string name, TileCollision collision)
    {
        return new Tile(content.Load<Texture2D>("Blocks/" + name), collision);
    }

    public Rectangle GetBounds(int x, int y)
    {
        return new Rectangle(x * Tile.Width, y * Tile.Height, Tile.Width, Tile.Height);
    }

    public int Width
    {
        get { return tiles.GetLength(0); }
    }

    public int Height
    {
        get { return tiles.GetLength(1); }
    }

    public TileCollision GetCollision(int x, int y)
    {
        // Prevent escaping past the level ends.
        if (x < 0 || x >= Width)
            return TileCollision.Passable;
        // Allow jumping past the level top and falling through the bottom.
        if (y < 0 || y >= Height)
            return TileCollision.Passable;

        return tiles[x, y].Collision;
    }

    public void Draw(SpriteBatch spriteBatch)
    {
        DrawTiles(spriteBatch);
    }

    public void DrawTiles(SpriteBatch spriteBatch)
    {
        for (int y = 0; y < Height; ++y)
        {
            for (int x = 0; x < Width; ++x)
            {
                Texture2D texture = tiles[x, y].Texture;
                if (texture != null)
                {
                    Vector2 position = new Vector2(x, y) * Tile.Size;
                    spriteBatch.Draw(texture, position, Color.White);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:55:52.070

就像是：

```
MouseState mouseState = Mouse.GetState();

int x = (int)(mouseState.X / Tile.Size);
int y = (int)(mouseState.Y / Tile.Size);

tiles[x, y] = //whatever tile type you want here 
```

# mysql - 拯救所有 ConstraintException 而不是关闭

> ID：12164602
> 
> 赞同：0
> 
> 时间：2012-08-28T17:39:09.997
> 
> 标签：mysql, ruby-on-rails, activerecord, ruby-on-rails-3.1, sqlite

我的应用程序遇到了问题：我的数据库有一个限制，其中 trip_id + trip_level_id 必须是唯一的。

现在，这是在数据库级别（没有验证），如果我尝试添加一个包含数据库中已经存在的字段的项目，我会收到一个“约束异常”。

问题是：

1.  约束异常仅与 SQlite3 相关，而我需要“所有数据库”的东西，特别是我将在生产中使用 mysql，而在开发中使用 sqlite3。
2.  在约束异常之后，mongrel 关闭，这绝对不是我想要的。我想向用户发送一条消息“发生约束异常”并且只是不添加该项目，用户需要返回并添加一个正确的项目。

如果可能的话，我如何将所有这些异常转换为 activerecords 应该为我获取的错误（这应该是最好的解决方案）？

否则，如何声明一个验证方法来确保这 2 列的值应该是唯一的？

**编辑 1：**我刚刚注意到我无法在 save 方法上拯救 SQLite3::ConstraintException，至少如果我只使用 Exception 类的话。我想我必须声明一个验证，但如果数据库中已经存在，感觉有点多余。

**编辑2：**这些似乎在谈论这个问题：[https](https://rails.lighthouseapp.com/projects/8994/tickets/2419-raise-specific-exceptions-for-violated-database-constraints) ://rails.lighthouseapp.com/projects/8994/tickets/2419-raise-specific-exceptions-for-violated-database-constraints但是看起来他们没有应用它，但帖子真的很旧（3年）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:18:09.713

仔细阅读，我发现数据库约束在 activerecord 中实现得不是很好，使用 validates_uniqueness_of 和范围将解决我的问题。

我绝对不喜欢优化的解决方案，但是我在我的创建和更新方法中找不到有效挽救异常的方法，所以实际上我是这样解决的。

# jsf - 在 p:dataTable 标签上使用带有延迟加载数据的 primefaces 时，h:commandLink 不起作用

> ID：12164604
> 
> 赞同：3
> 
> 时间：2012-08-28T17:39:15.033
> 
> 标签：jsf, primefaces

我正在使用primefaces的p：dataTable，我需要将一个动作关联到每一行（编辑和删除），当我使用h：commandLink时似乎工作正常，但如果我将lazyLoading添加到p：dataTable中，h： commandLink 不再起作用（不再调用该操作）。

这是一个错误还是有一种特殊的方法让 ap:dataTable 在每一行上使用lazyLoading 和 ah:commandLink ？

编辑：谢谢@Heidarzadeh，我添加了源代码。

位置列表.xhtml：

```
<ui:composition template="/template/layout.xhtml">
    <ui:define name="content">
        <div class="span10">
            <h2>Listado de Bodegas</h2>
            <h:form id="locationsForm">
                <fieldset>
                    <p:dataTable 
                        id="locationTable"
                        var="row"
                        value="#{locationBackingBean.list()}" 
                        paginator="true" 
                        rows="10"
                        lazy="true"
                        dynamic="true"
                        rowsPerPageTemplate="10,30,50"
                        paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}">

                        <p:column headerText="#">
                            <h:outputText style="" value="#{row.locationId}"/>
                        </p:column>

                        <p:column headerText="Nombre">
                            <h:outputText style="" value="#{row.name}"/>
                        </p:column>

                        <p:column headerText="Descripción">
                            <h:outputText style="" value="#{row.description}"/>
                        </p:column>

                        <p:column headerText="Sede">
                            <h:outputText
                                value="#{officeBackingBean.findById(row.officeId).description}"/>
                        </p:column>

                        <p:column >
                            <h:commandLink id="edit"
                                action="#{locationBackingBean.view(row.locationId)}">
                                <h:graphicImage styleClass="icon-edit" />
                            </h:commandLink>
                        </p:column>

                        <p:column headerText="Elminar">
                            <p:commandLink id="remove"
                                action="#{locationBackingBean.remove(row.locationId,row.recordVersion)}">
                                <p:graphicImage styleClass="icon-remove" />
                            </p:commandLink>
                        </p:column>
                    </p:dataTable>
                    <br />
                    <h:link styleClass="btn btn-primary" value="Agregar"
                        outcome="/config/locationView" />
                </fieldset>
            </h:form>

        </div>
    </ui:define>
</ui:composition> 
```

托管bean：

```
import javax.annotation.PostConstruct;
import javax.ejb.EJB;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ManagedProperty;
import javax.faces.bean.RequestScoped;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.primefaces.model.LazyDataModel;

@ManagedBean(name = "locationBackingBean")
@RequestScoped
public class LocationBackingBean implements Serializable {

@EJB
private LocationBean locationBean;
private InvLocationDTO invLocationDTO;
private LazyLocationDataModel lazyInvLocationDTO;

public LocationBackingBean() {
    super();
    invLocationDTO = new InvLocationDTO();
}

@PostConstruct
public void init() throws InventoryException {
    try {
        lazyInvLocationDTO = new LazyLocationDataModel(locationBean);
    } catch (Exception ex) {
        throw new InventoryException(ex.getMessage(), ex);
    }
}

public String view(Integer locationId) throws InventoryException {
    try {
        if (locationId != null) {
            invLocationDTO.setLocationId(locationId);
            invLocationDTO = locationBean.findByID(invLocationDTO);
        }
    } catch (InventoryException ex) {
        throw ex;
    } catch (Exception ex) {
        log.error(ex.getMessage(), ex);
        throw new InventoryException(ex.getMessage(), ex);
    }
    return "/config/locationView";
}

public String remove(Integer locationId, Integer recordVersion) throws InventoryException {
    try {
        if (locationId != null) {
            invLocationDTO.setLocationId(locationId);
            invLocationDTO.setRecordVersion(recordVersion);
            Integer rows = locationBean.remove(invLocationDTO);
            if (rows == 0) {
                // TODO Fix the handle of error, this will be, because the record doesn't exists or record version didn't match.
                throw new InventoryException("Registro no fue eliminado.");
            }
        }
        return "/config/locationList";
    } catch (InventoryException ex) {
        throw ex;
    } catch (Exception ex) {
        log.error(ex.getMessage(), ex);
        throw new InventoryException(ex.getMessage(), ex);
    }
}    

public InvLocationDTO getInvLocationDTO() {
    return invLocationDTO;
}

public void setInvLocationDTO(InvLocationDTO invLocationDTO) {
    this.invLocationDTO = invLocationDTO;
}

public LazyDataModel<InvLocationDTO> list() throws InventoryException {
    return lazyInvLocationDTO;
}
} 
```

惰性数据模型：

```
import java.util.List;
import java.util.Map;

import org.primefaces.model.LazyDataModel;
import org.primefaces.model.SortOrder;

public class LazyLocationDataModel extends LazyDataModel<InvLocationDTO> {

    private LocationBean locationBean;
    private List<InvLocationDTO> datasource = null;

    public LazyLocationDataModel(LocationBean locationBean) {
        super();
        this.locationBean = locationBean;
    }

    public List<InvLocationDTO> load(int first, int pageSize, String sortField,
            SortOrder sortOrder, Map<String, String> filters) {
        try {
            datasource = locationBean.findAll(first, pageSize);
            // Row Count
            this.setRowCount(locationBean.countFindAll());
        } catch (InventoryException ex) {
            log.error(ex.getMessage(), ex);
        }
        return datasource;
    }

    @Override
    public void setRowIndex(int rowIndex) {
        if (rowIndex == -1 || getPageSize() == 0) {
            super.setRowIndex(-1);
        } else
            super.setRowIndex(rowIndex % getPageSize());
    }

    public List<InvLocationDTO> getDatasource() {
        return datasource;
    }

    @Override  
    public InvLocationDTO getRowData(String rowKey) {  
        for(InvLocationDTO location : datasource) {  
            if(location.getLocationId().equals(Integer.valueOf(rowKey)))  
                return location;  
        }  

        return null;  
    }  

    @Override  
    public Object getRowKey(InvLocationDTO location) {  
        return location.getLocationId();  
    }      

} 
```

# java - 调用在另一个类中更改的 int

> ID：12164605
> 
> 赞同：1
> 
> 时间：2012-08-28T17:39:15.593
> 
> 标签：java, android, class, int, call

这是问题所在，我有一个类（可以说是class1），根据您选择的按钮，int x 更改为数字1-6。我需要能够在类 2 中调用这个 int，但它不读取新的 int x 值，它只读取默认值。

```
public class class1 extends Activity {
    private view btn1;
    private view btn2;
    //...
    private view btn6;
    public int x = 1;

btn1.setOnClickListener(sbtn1Listener);
//...
btn2.setOnClickListener(sbtn2Listener);

private View.OnClickListener sbtn1Listener = new View.OnClickListener() {
    public void onClick(View v) {
        x = 1;
    }
};
private View.OnClickListener sbtn2Listener = new View.OnClickListener() {
    public void onClick(View v) {
        x = 2;
    }
};
//... 
```

所以按钮在那个程序中工作得很好，还有更多，但我现在就先把它留在那里。然后 class2 需要读取新值。

```
public class class2 extends BaseObject {
    public int y = 1;

    class1 a = new class1();
    a.getx();

    y = a;

    if (y == 1) {
    }else if (y == 2){
    //... 
```

它不会从 class1 读取新的 x 值，而是仅读取默认设置为 1。

另请注意，我无法更改 class2 的扩展部分，因为 BaseObject 是它运行所有组件所必需的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:46:30.180

那是因为 class2 正在创建 class 1 的新实例。

您需要做的是访问已经存在的 1 类实例。

如果你全球化类 2，然后通过类 1 设置它，你将能够访问它。

```
public class class1 extends Activity {
private view btn1;
private view btn2;
//...
private view btn6;
public int x = 1;
public class2 cls2; // SET GLOBAL. Needs initialising somewhere relevant.

btn1.setOnClickListener(sbtn1Listener);
//...
btn2.setOnClickListener(sbtn2Listener);

private View.OnClickListener sbtn1Listener = new View.OnClickListener() {
public void onClick(View v) {
    x = 1;
    cls2.x = 1; // Or use setter methods in class 2.
}
};
private View.OnClickListener sbtn2Listener = new View.OnClickListener() {
public void onClick(View v) {
    x = 2;
    cls2.x = 2;
}
}; 
```

然后在类 2 中有一个名为 x 的公共变量。（您在点击侦听器中设置的那个。

重要提示：无论何时调用类 2，请确保将其分配为全局实例，而不是新实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:46:50.673

使`int x a static variable.`

**例如：**

```
public static int x = 1; 
```

现在像这样从另一个类访问它......

```
int y = class1.x; 
```

// 这将反映更改后的 x 值。

# php - 自定义 substr php

> ID：12164606
> 
> 赞同：0
> 
> 时间：2012-08-28T17:39:17.397
> 
> 标签：php, regex, substring

使用以下字符串：

```
$string='some text <photo id="id#" /> some text'; 
```

制作一个 substr，如果其字符串的结尾是

```
<photo id="id#" /> 
```

然后应用一个额外的块来完成

```
"<photo id="id#" />" 
```

例子：

```
substr($string,0,15); 
```

结果是：

```
some text <phot 
```

如果发生这种情况，我需要结束：

```
some text <photo id="id#" /> 
```

他，找不到这样做的方法。顺便说一下 id# 是一个随机数值，其长度不会超过 3 个字符。如果需要正则表达式来提出一个功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T07:32:36.447

看到这个： -

输出：-

![在此处输入图像描述](../Images/24096c29c650313594d58c3e0524dce3.png)

```
<?php

$str= 'some text <photo id="#xx"/> some test';
$parts = preg_split('~(</?[\w][^>]*>)~', $str, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);
echo '<pre>';
print_r($parts);
echo htmlentities($parts[1]);

$str_new= 'some text <photo id="#xx"></photo> some test';
$parts_new = preg_split('~(</?[\w][^>]*>)~', $str_new, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);
echo '<pre>';
print_r($parts_new);
echo htmlentities($parts_new[1]);
echo htmlentities($parts_new[2]);

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:27:46.677

无需使用正则表达式，只需使用 PHP 字符串函数即可：

```
$string = 'some text <photo id="id#" /> some text';
$newString = substr($string, 0, strpos($string, '>') + 1); 
```

# c++ - 为什么恒定值变化不被视为错误？

> ID：12164608
> 
> 赞同：2
> 
> 时间：2012-08-28T17:39:24.770
> 
> 标签：c++, pointers, constants

必须遵循代码 -

```
 const int WEEKDAYS = 7;
    const int *pWeekdays = &WEEKDAYS;
    *((int*) pWeekdays) = 9;
    cout << WEEKDAYS << endl; 
```

它给出输出`7` ，即该行`*((int*) pWeekdays) = 9;`无效或抛出任何错误。

显然它喜欢这样做`7 = 9`，为什么没有抛出错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T17:40:43.597

抛弃 const 并因此可变地访问 const 对象是简单的**未定义行为**。你的程序可以做它想做的任何事情，并且不需要诊断。

永远记住，虽然崩溃的程序确实有错误，但有错误的程序并不总是崩溃。（或者正如苏格拉底所说，“不是每只猫都是鱼”。）

* * *

在 C++ 中，你真的不应该使用 C 风格的强制转换。如果您尝试了更合适的`static_cast<int*>(pWeekdays)`方法，您将得到正确的诊断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:43:19.183

您已定义`WEEKDAYS`为常量，并且您正在更新`*pWeekdays`存储在**地址中的值**`pWeekdays`，因此**从技术上讲，您不会更新常量。**

您定义为的参考`WEEKDAYS`或未更新`pWeekdays``constant`

# iphone - 像 Facebook 的 iPhone App 一样在侧边栏中模拟 UITableView 的滚动效果

> ID：12164609
> 
> 赞同：0
> 
> 时间：2012-08-28T17:39:36.407
> 
> 标签：iphone, facebook, uitableview, scroll

我正在开发一个应用程序，我最近在侧边栏中添加了一个应用程序，我希望它像 Facebook 的一样。他们有一个固定在顶部的搜索栏，我确定作为自定义标题（因为其他部分标题会在您滚动时替换它），但标题不允许弹跳。我不知道该怎么做是允许在表格视图中的单元格上弹跳。设置 tableview.bounces = NO 将所有内容锁定到位，但不允许单元格像我希望的那样弹跳。

总之，我有一个可以滑动的侧边栏。我有一个部分，带有自定义标题。我希望该标题锚定（锁定）到它初始化的位置（在标题上方没有弹跳）。然后我希望表格视图中的单元格能够在视图的顶部和底部反弹。

感谢您的任何帮助或意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:44:13.460

与其制作章节或表格标题，不如在表格视图上方放置一个“标题”视图，并使表格视图更小？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:05:28.027

`UITableView`只是一种幻想`UIScrollView`，也是一种`UIScrollViewDelegate`为自己。当 contentOffset.y > 0 时，您可以覆盖`scrollViewDidScroll:`并将标题的位置设置为始终锚定到顶部。

# sql - SELECT - 查询中列的值

> ID：12164610
> 
> 赞同：0
> 
> 时间：2012-08-28T17:39:44.580
> 
> 标签：sql

这就是我想做的。我有 3 张表：工作场所、详细信息和停机时间。到目前为止，我从 Workplace 表中选择了工作场所的编号（并从 Details 表中添加了它的名称）、发出通知的日期、班次和 Downtime 表中的停机时间总和 Now... 在 Downtime 表中是带有停机时间代码的列。每个通知都有一个代码和分钟数。我想要做的......也有与代码一样多的列......这是我的查询现在向我显示的内容：

```
|Workplace|Date       |Shift|Downtime|
|1345     |2012-08-28 |1    |100     |
|1346     |2012-08-28 |1    |130     |
|1347     |2012-08-28 |1    |40      | 
```

我在停机时间表中有停机时间代码及其报告的分钟数......我希望它类似于：

```
|Workplace|Date       |Shift|Code 1|Code 3|Code 4|Code 6|
|1345     |2012-08-28 |1    |100   |30    |10    | 5    |
|1346     |2012-08-28 |1    |130   |30    |10    | 5    |
|1347     |2012-08-28 |1    |40    |30    |10    | 5    | 
```

我怎么能做这样的事情？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:14:45.890

那么 - 您想将停机时间分解为用于它的代码吗？您应该能够使用 case 语句来做到这一点：

SELECT Workplace, Date, Shift, SUM(CASE WHEN Code = Code1 then Downtime ELSE 0) as Code1, SUM(CASE WHEN Code = Code2 then Downtime ELSE 0) as Code2，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:46:04.737

我的快速回答是您可以使用游标和动态查询。

游标示例： [http ://www.mssqltips.com/sqlservertip/1599/sql-server-cursor-example/](http://www.mssqltips.com/sqlservertip/1599/sql-server-cursor-example/)

动态查询示例： [http ://www.techrepublic.com/blog/datacenter/generate-dynamic-sql-statements-in-sql-server/306](http://www.techrepublic.com/blog/datacenter/generate-dynamic-sql-statements-in-sql-server/306)

祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:04:38.530

好的，从您的回复中，我建议您拥有大部分代码，因此最终大致如下：

```
select 
 tablea.workplace, 
 tablea.date, 
 tablea.shift, 
 sum(downtimemins),
 tableb.code1,
 tableb.code3, 
 tableb.code4, 
 tableb.code6 
from tablea 
left join downtime on 
 tablea.workplace=tableb.workplace and 
 tablea.date=tableb.date and 
 tablea.shift=tableb.shift 
group by tablea.workplace, tablea.date, tablea.shift 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T18:30:29.220

您需要的基本上是 SQL 2005 标准中引入的 PIVOT 子句。AFAIK Microsoft SQL Server 和 Oracle 确实支持 PIVOT 子句。postgresql 有第三方解决方案，但我不知道其他 RDBMS。

因此，取决于您使用的数据库：您不能或可以（使用 PIVOT）。

# android - 如何实现带有按钮的标题栏？

> ID：12164613
> 
> 赞同：1
> 
> 时间：2012-08-28T17:40:06.127
> 
> 标签：android, android-layout, android-widget

我一直在谷歌上搜索有关如何在 Android 中进行这种布局的教程和其他文档：

![在此处输入图像描述](../Images/59d3201c77c8bdc938c9970d85403278.png)

我一直在将 Eclipse 中的每个小部件拖放到 XML 上，以找到标题栏与 + 按钮相似的那个，以及刷新按钮。

还有这种标签叫什么？我环顾四周，提示是PageViewer？

请记住我正在学习Android。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:42:25.940

它被称为`Actionbar`. 如果您使用的是 Android 3.0+，那么您可以原生使用它。如果没有，请查看 ActionbarSherlock。

链接：

[http://actionbarsherlock.com](http://actionbarsherlock.com)

[http://developer.android.com/guide/topics/ui/actionbar.html](http://developer.android.com/guide/topics/ui/actionbar.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:42:36.187

您正在查看的可能是带有 Tabs+Swipes 的 ViewPager 实现，您可以通过使用最新的 Android SDK 创建一个新项目并选择 Tab+Swipe 导航来获得它。这里列表的布局只是一个带有自定义适配器的 ListFragment。

这是 Android 上 ActionBar 模式的一部分，通过使用支持库或 ActionBar Shelock (http://actionbarsherlock.com/)，您也可以针对旧手机。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:43:52.243

那是一个[Action Bar](http://developer.android.com/guide/topics/ui/actionbar.html "操作栏")，它只在 Android 3.0+ 中可用。这些选项卡是标准选项卡，在处理操作栏时具有特殊的 API。如果你想在 3.0 之前的版本中使用 Action Bar，我推荐[ActionBarSherlock](http://actionbarsherlock.com/ "动作条夏洛克")。

# javascript - 使用点语法访问数据

> ID：12164616
> 
> 赞同：0
> 
> 时间：2012-08-28T17:40:23.707
> 
> 标签：javascript, jquery, json

JSON：

```
{
    "count": 1,
    "rows": [
        {
            "user_id": "7",
            "lat": "48.452583",
            "lng": "-123.545052",
            "distance": "0.4852177729308128"
        }
    ]
}​ 
```

这进入我的`function(data)`，我正在尝试访问`count`，然后`user_id`..

```
downloadUrl(searchUrl, function(data) {
    alert( "Locations Found: " + data[0].count );
}); 
```

`data.count`, `data[0].count`...不工作。我对如何访问它们一无所知。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:46:33.537

如果您`data`是字符串（不是数据类型：json），那么您需要按如下方式解析它

```
var obj=$.parseJSON(data); 
```

然后使用

```
obj.count;
obj.rows[0].user_id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:44:20.800

数据真的是一个对象还是只是一个字符串。您可以通过执行 console.log(typeof data) 或 alert(typeof data) 来使用大多数浏览器的控制台调试类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:42:12.210

尝试这个

```
data = {"count":1,"rows":[{"user_id":"7","lat":"48.452583","lng":"-123.545052","distance":"0.4852177729308128"}]}
data.count
data.rows[0].user_id 
```

# html - 如何为多个选择框设置一个标签？

> ID：12164617
> 
> 赞同：8
> 
> 时间：2012-08-28T17:40:32.100
> 
> 标签：html

我在这张签到表上有：

```
<label>Check in date </label>
<select id="day">
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
</select> 
<select id="month">
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
  <option value="4">4</option>
</select> 
<select id="year">
  <option value="1">2012</option>
  <option value="2">2013</option>
</select> 
```

如您所见，用户将在不同的选择框中选择月、日和年，但是，这三个标签应该只存在一个标签。

使用 HTML 执行此操作的正确方法是什么？

更新：我担心我们在开发类似上面的代码时可能会遇到的可访问性问题。我的意思是，盲人用户应该能够听到每个标签才能填写此表格......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-28T18:40:32.093

为所有三个输入框使用一个标签的问题在于，视力不佳的用户不会知道焦点在三个框中的哪一个，因为在每种情况下都会读出相同的文本。有多种可能的方法。也许最安全的方法是为每个框设置一个标签，但将这些标签隐藏在视口的左侧。另一种应该可行但我没有测试过的可能性是：

```
<fieldset>
    <legend>Check in date</legend>
    <select id="day" aria-label="day">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
    </select> 
    <select id="month" aria-label="month">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
    </select> 
    <select id="year" aria-label="year">
      <option value="1">2012</option>
      <option value="2">2013</option>
    </select>
</fieldset> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-21T05:30:04.743

根据@Alohci 的回答，您还可以使用`aria-labelledby`和反转命名参考（*我认为它更接近您正在寻找的约定*）：

```
<label id="date">Check in date</label>
<select aria-labelledby="date">
    <!-- ... -->
</select> 
<select aria-labelledby="date">
    <!-- ... -->
</select> 
<select aria-labelledby="date">
    <!-- ... -->
</select> 
```

另请注意，根据[W3C](http://www.w3.org/TR/wai-aria/states_and_properties#aria-labelledby)关于`labelled-by`：

> 如果标签文本在屏幕上可见，作者**应该**使用`aria-labelledby`并且**不应该**使用`aria-label`. `aria-label`仅当界面无法在屏幕上显示可见标签时使用。计算可访问名称属性时，`aria-labelledby`用户代理优先。`aria-label`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-28T20:00:17.380

您不能将一个`label`元素与多个控件相关联。这在 的[定义中`label`](http://www.w3.org/TR/html401/interact/forms.html#h-17.9.1)有所描述。

你可以给每个`select`元素自己的标签。

更好的方法是为日期设置一个文本输入字段。那么就没有问题了`label`。这意味着更多的工作，因为您必须在服务器端解析数据，并且您还应该在客户端解析它（用于检查，以便用户可以立即被告知问题）。但它具有更好的可用性（输入日期肯定比使用三个笨拙的下拉菜单更快）和更好的可访问性。您需要确定日期格式并清楚地告诉用户预期的格式是什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T18:38:31.990

试图改进@Bracketworks 答案：

```
<label id="date">Check in date</label>
<label for="day" id="label_day">Day</label>
<select id="day" aria-labelledby="date label_day">
    <!-- ... -->
</select> 
<label for="month" id="label_month">Month</label>
<select id="month" aria-labelledby="date label_month">
    <!-- ... -->
</select> 
<label for="year" id="label_year">Year</label>
<select id="year" aria-labelledby="date label_year">
    <!-- ... -->
</select> 
```

请参阅 MDN 的“[使用 aria-labelledby 属性](https://developer.mozilla.org/en-US/docs/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-labelledby_attribute)”的示例 1。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-28T17:43:26.603

没有合适的方法；标签指的是一个元素。只需将其指向第一个即可。

```
<label for="day">Check in date </label> 
```

如果您喜欢语义，您也可以使用特定样式的`<fieldset>`，但我认为这有点矫枉过正。An`<input type="date">`可能是这里最好的选择，因为它是一个可以由你的 指向的元素，`<label>`更具语义性，并且如果你实现一个好的日期选择器来配合它，它可能会更友好一些。

如果您想坚持使用`<select>`s，请尝试为每个`title`属性赋予可访问性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-30T18:46:10.613

HTML5[`input type="date"`](http://www.w3.org/TR/html-markup/input.date.html)也可能很有用，特别是如果您使用月/日/年选择框来限制日期选择的可能性。此输入元素支持`min`和`max`日期属性，因此您可以应用您的限制。较旧的浏览器不支持它，但我看到智能 cookie 使用[jQueryUI 的 datepicker](http://jqueryui.com/datepicker/)作为填充程序（通过使用[功能检测](http://modernizr.com/)来确定`type="date"`支持，然后仅当它本身不支持时才加载并调用 datepicker）。

# azure - Azure 工具如此不稳定

> ID：12164621
> 
> 赞同：2
> 
> 时间：2012-08-28T17:40:56.313
> 
> 标签：azure

我很难使用 Azure 工具进行开发，它会引发有关 DF 代理的各种错误...

此外，我无法调试，因为我为一个 Web 角色配置了多个站点。它一直在说“语法错误”（由于语法无效，服务器无法处理调试请求）。然后我重新启动模拟器，有时可以工作，有时不能。

正如我在一些博客中所读到的，我让我的主机文件指向 127.255.0.1，但这并不能解决我的问题。

另一个随机错误说“已经有一个端点正在监听 dfservice...”

我花了 90% 的开发时间来解决这个问题……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T23:03:23.553

正如您所提到的，您遇到了随机错误，因为“已经有一个端点正在监听 dfservice ...”，我可以为您指出正确的方向。

[此处](http://msdn.microsoft.com/en-us/library/windowsazure/hh472164.aspx)详细描述了上述问题，这是由于某些应用程序试图访问 DFAgent 使用的同一端口。请按照文章解决此问题。

正如您还提到重启模拟器确实工作了一段时间，似乎其他一些应用程序和服务正在干扰模拟器/DF配置。有时，在这种情况下，减少正在运行的进程/服务的数量确实会有所帮助。

# jquery - 迁移到 knockout.js

> ID：12164622
> 
> 赞同：3
> 
> 时间：2012-08-28T17:41:03.567
> 
> 标签：jquery, knockout.js

在我们的应用程序中，我们使用 jquery 来编写所有客户端脚本。这些脚本一开始只是简单的 dom 操作，但随着时间的推移，它的数量越来越大，而且我们认为它可能更难以维护。感觉很混乱脚本中的任何更改都会破坏某些功能。因此，我们计划使用 knockout.js 来清理我们构建的混乱。我的问题是必须进行多少结构更改才能适应 knockout.js ？我们是否必须重写所有内容？我知道不看代码就很难回答这个问题，但我想征求一般意见。如果你发现自己处于这种情况，你会怎么做？

编辑：

关于代码结构的一些细节：

我们正在使用 Asp.net MVC 框架

大约 30% 的客户端代码处理向服务器发出 ajax 请求并根据响应对 Ui 进行更改

我们有很多代码根据用户操作显示和隐藏 Ui 元素。其中大部分是重复的，我们应该为此责备自己。

这就是我们没有做任何计算或需要大量逻辑的事情，只是通过服务器响应或用户操作来操作 ui。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:09:15.690

我从事过一个 ASP.NET MVC3 项目，和你一样，我开始使用 jQuery 进行一些简单的 DOM 操作，但随着时间的推移，我最终有了很多客户端逻辑来使用 jQuery 进行管理 - 所以我开始切换到 knockoutJS .

在开始迁移之前，我浏览了[http://learn.knockoutjs.com/](http://learn.knockoutjs.com/)上的所有优秀教程- 只是为了熟悉术语（视图模型、绑定、自定义绑定、可观察对象、实用程序函数等）和一些您可以制作的不同绑定。

然后我开始以最适合我的应用程序的方式创建我的视图模型——这部分特别取决于你正在制作的应用程序类型。就我而言，我使用了很多`ko.observable()`' 和`ko.observableArray()`' 以便在满足不同条件时轻松更新客户端。随着视图模型的出现，我开始使用适当的绑定（`foreach`、`with`、`text`、`css`、`attr`、`enable`等）更新我的视图——这样我就可以一直看到一些进展。

所以总结一下——开始学习如何使用它——然后开始定义你的视图模型并找出你需要代表客户端的状态。然后开始（重新）实现您的视图 - 一个接一个地替换您的一些“旧”jQuery 代码并开始保存一些行并获得更干的视图实现；）

顺便说一句 - StackOverflow 和[http://knockoutjs.com/documentation/introduction.html](http://knockoutjs.com/documentation/introduction.html)将成为你的朋友 - 如果你有任何疑问，它几乎总是在文档中 - 如果它非常具体（或很难找到），我发现在 StackOverflow 上找到已经提出的相关问题非常简单。

- 更新：

和你一样，我也有一系列 AJAX 请求——机器人我也使用 SignalR 向客户端发送一些异步实时消息——我确实发现 observables 对此非常有用——所以如果我应该推荐 knoutJS 的特定部分你应该非常注意并开始熟悉，那就是[observables](http://knockoutjs.com/documentation/observables.html)，[observable arrays](http://knockoutjs.com/documentation/observableArrays.html)和[computed observables](http://knockoutjs.com/documentation/computedObservables.html)。

# xpages - 更新后端文档后应更新重复控件

> ID：12164624
> 
> 赞同：0
> 
> 时间：2012-08-28T17:41:12.303
> 
> 标签：xpages

目前我正在使用 Dojo 的 AutoRotator 来显示一组内容文档。我使用重复控件填充此轮播，该控件从托管 bean 获取数据收集。有一种方法可以从视图中收集通用 id，并将其作为 bean 属性放入 HashMap 中。

在重复控件中，有一个面板，其中绑定了一个数据源。数据源是文档，documentId 来自托管 bean 的数据集合。我决定这样，因为主体是具有大量格式化信息的 Mime 实体

到目前为止一切顺利，一切正常……当通过另一个 XPage 更新和保存内容文档时，轮播中的文档将不会更新。

有谁知道更新我的数据收集的方法？是否可以更新托管 Bean 中的数据集合 Hashmap，repeatcontrol 是否会获取新数据？或者还有其他方法可以在后端和前端之间保持同步。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T03:44:00.533

您可以将 bean 移动到 applicationContext 中，这样数据库的所有用户都可以访问它。然后不仅收集 docid，还收集实际的 mime 条目（重要：不要使用 NotesMimeEntry 类，在 bean 中使用标准 Java 对象）。您可以使用以 unid 为键、以 HTML 为内容的地图。然后在querySave 中更新applicationBean。

说得通？

# javascript - Ajax 调用超时

> ID：12164628
> 
> 赞同：0
> 
> 时间：2012-08-28T17:41:25.767
> 
> 标签：javascript, ajax

我目前正在使用一个轻量级的 javascript 库来进行 ajax 调用。图书馆是'jx'。

它工作正常。但是我想添加一个超时，以便在一段时间后没有响应时停止 ajax 调用。我环顾四周，似乎没有像jquery那样的超时参数......

由于纯javascript，有没有办法实现超时？像这样 ：

```
timer = setTimeout('function{stop the call}', 20000);
jx.load(url, function(data){ 
        // get the data
        clearTimeout(timer);
        } 
```

我试过了，但效果不好……还有其他方法吗？或者让ajax调用syn

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:07:31.247

如果[这](http://www.openjs.com/scripts/jx/jx.php)是您正在使用的库，它似乎是可能的：

```
var xhr = jx.init();
var timer = setTimeout(function(){ 
    if(xhr && xhr.abort) xhr.abort();
}, 20000);

jx.load(url, function(data){ 
    clearTimeout(timer);
}); 
```

# android - OpenGL ES 2.0 投影映射为正 Y？

> ID：12164629
> 
> 赞同：0
> 
> 时间：2012-08-28T17:41:46.157
> 
> 标签：android, opengl-es, opengl-es-2.0

我在 OpenGL ES 2.0 中有一个投影，但不幸的是我希望 Y 为正值，这样我更容易使用 TouchEvents。

现在这是投影矩阵：

```
private void setOrthographicMatrix(int w, int h)
{
    orthographicMatrix[0] = (float) (2.0f / w ); //a
    orthographicMatrix[3] = -1f;                 //tx
    orthographicMatrix[5] = (float) (2.0f / h);  //b
    orthographicMatrix[7] = 1f;                  //ty
    orthographicMatrix[10] = -1f;                //c
    orthographicMatrix[15] = 1f;                 //1

//  a, 0, 0, tx,
//  0, b, 0, ty,
//  0, 0, c, tz,
//  0, 0, 0, 1
} 
```

顶点着色器：

```
attribute vec4 a_position;
attribute vec2 a_texCoord;

varying vec2 v_texCoord;

uniform mat4 u_MVPMatrix;

void main()
{
    //Pass Values to Fragment Shader
    v_texCoord = a_texCoord; 

    //Set Position
    gl_Position = a_position * u_MVPMatrix;
} 
```

片段着色器：

```
precision mediump float;

varying vec2 v_texCoord;

uniform vec4 u_color;
uniform sampler2D u_s_texture;

void main()
{
    gl_FragColor = texture2D(u_s_texture, v_texCoord) * u_color;
} 
```

结果是： (0,0) - 左上角

```
0,0----------> X++
|
|
|
↓
Y-- 
```

我希望投影映射，因此 Y 在屏幕下方变为正数。

编辑 - 解决方案：

我已将 OrthographicMatrix 函数的设置替换为使用内置的 Android Matrix 库：

```
Matrix.orthoM(orthographicMatrix, 0, 0, w, h, 0, -10f, 10f); 
```

并将我的顶点着色器更改为：

```
gl_Position = u_MVPMatrix * a_position; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:46:12.900

我建议只使用 OpenGL 的标准正交投影功能，它允许您定义顶部、底部、左侧、右侧，而不仅仅是宽度和高度，因此您可以以任何您想要的方式翻转 Y 轴：

此函数在 OpenGLES 2.0 中不存在，但您可以将方程复制到您自己的正交函数中：

[http://www.opengl.org/sdk/docs/man/xhtml/glOrtho.xml](http://www.opengl.org/sdk/docs/man/xhtml/glOrtho.xml)

此外，如果这是针对 Android 的（您的其他帖子是针对 android 的，所以我假设是这样），已经存在一个可以使用的正交矩阵函数 ( `android.opengl.Matrix.orthoM`)

# c# - 客户端在超时异常上超出 sendTimeout

> ID：12164633
> 
> 赞同：2
> 
> 时间：2012-08-28T17:41:56.330
> 
> 标签：c#, wcf

我正在尝试将超时/EndPointNotFound 异常时间减少到 10 秒。异常日志表明呼叫在 10 秒内超时，但如果我使用 StopWatch 添加代码，则大约需要 21 - 22 秒。

[我在这个](https://stackoverflow.com/questions/5966315/wcf-not-timing-out-correctly/5989738#5989738)链接上读过同样的内容。

它真的是一个错误吗？有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:48:03.940

1 SendTimeout 用于初始化 OperationTimeout，它控制发送消息的整个交互

[http://msdn.microsoft.com/fr-fr/librarysystem.servicemodel.configuration.standardbindingelement.sendtimeout.aspx](http://msdn.microsoft.com/fr-fr/librarysystem.servicemodel.configuration.standardbindingelement.sendtimeout.aspx)

[http://msdn.microsoft.com/fr-fr/library/ms731343.aspx](http://msdn.microsoft.com/fr-fr/library/ms731343.aspx)

> 这不是错误

2 您可以在绑定部分调整属性 sendTimeout=""

# c# - 私有静态成员和继承

> ID：12164644
> 
> 赞同：0
> 
> 时间：2012-08-28T17:42:44.237
> 
> 标签：c#, oop, inheritance, static-members

所以我正在使用一个包含一些 Web 服务的单例类。对服务的引用存储为私有静态只读成员。我想要一个非常相似的类，它用相同的接口包装不同的 Web 服务。如果我从第一个类继承并用新成员覆盖私有静态只读成员，一切都会像我想的那样顺利吗？所有继承的函数（一些公共的、一些私有的、一些静态的）都会使用新的引用吗？

我问是因为我之前遇到过一些关于静态成员继承的怪癖。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T17:43:58.210

不，这行不通。静态成员附加到类型，而不是实例，并且不能被覆盖。如果您更改派生类中的静态值（必须至少是`protected`，而不是`private`），这将更改基类和派生类的所有实例的值。

这里要注意的重要一点是静态字段附加到基本类型。当您从该基类派生时，您不会获得静态字段的新副本，派生类使用与基类相同的静态实例。

# java - JGoodies 绑定是否会在 EDT 上占用太多时间？

> ID：12164645
> 
> 赞同：0
> 
> 时间：2012-08-28T17:42:51.427
> 
> 标签：java, swing, real-time, event-dispatch-thread, jgoodies

我正在为我的摇摆组件使用 JGoodies 绑定。我的程序中有一个要求很高的实时显示，当打开 JGoodies 绑定时，它不会在视觉上更新。有没有办法让绑定不占用 EDT 线程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T21:22:36.210

不，绑定几乎肯定不是您的问题的原因 - 它们所做的只是连接事物。如果确实执行花费了大量时间来触发绑定事件，那么您应该弄清楚是什么触发了这些事件。

我建议在分析器中运行您的程序，以查看代码中 CPU 的使用位置（如果您看到高 CPU）。

# c# - 声明要由子类实现的方法的正确方法是什么？

> ID：12164650
> 
> 赞同：2
> 
> 时间：2012-08-28T17:43:01.383
> 
> 标签：c#, inheritance, implementation, icommand

我创建了一个具有通用方法的父类，但有些方法我希望由子类实现。即单击执行方法。

实现这一点的正确方法是什么？

```
public Parent {
    CancelCommand = new RelayCommand(CancelClicked, CancelCanExecute);
    private void CancelClick(object param) {
        // Do stuff
    }
}

public Child : Parent {
    private bool CancelCanExecute(object param) {
        // Do stuff
        return true;
    }
} 
```

其中 CancelClick 由父类托管，而 CancelCanExecute 由子类处理。

我会使用外部人员吗？或者我应该使用接口？如果我在子类中使用覆盖，它不会强迫我必须实现该方法。我不确定是否应该将父类更改为抽象类，因为它具有非抽象方法等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:57:14.053

因此，这是您的选择：

**1.**声明你的**基类**和`abstract`一些方法

这种方法有两个好处：您可以在基类中自由地实现通用方法（也就是说，并非所有方法都需要`abstract`），而任何抽象方法都**必须**在派生类中被覆盖。有一个反驳点（您可能知道）：您无法实例化它。也就是说，您不能执行以下操作：

```
Base obj = new Base(); 
```

但是，您仍然可以这样做：

```
Base obj = new Child(); 
```

**2.**使用**接口**

你可以声明一些接口来强制你的类实现一些方法。但是，继承和接口之间的语义是完全不同的。您必须决定哪个最适合您。

恕我直言，您可以选择第一个选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T17:58:18.933

您需要在 Parent 中指定一个抽象方法：

```
public abstract class Parent
{
    public void DoSomething()
    {
        // Do something here...
    }

    public abstract void ForceChildToDoSomething();
} 
```

这迫使孩子实现它：

```
public class Child : Parent
{
    public override void ForceChildToDoSomething()
    {
        // Do something...
    }
} 
```

但是，您现在将有一个抽象的 Parent。因此，如果您想使用 Parent 中的功能，您需要执行以下操作：

```
Parent parent = new Child();
parent.DoSomething();
parent.ForceChildToDoSomething(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T17:59:55.797

是的，摘要：

```
public abstract Parent
{
  protected abstract bool CancelCanExecute(object param);
  //more stuff
} 
```

也可能是`public`，但不是`private`。

现在你不能有一个既不实现又不实现的派生类，它`CancelCanExecute`本身`abstract`就迫使进一步的派生类来实现它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T18:13:09.053

您应该定义一个接口，然后您的代码应该只接受实现该接口的对象。虽然使用`abstract`和创建公共基类非常诱人，但这种方法（几乎）根据定义（几乎）是错误的。

在 C# 和其他不允许多重继承的语言中，创建一个基类只是为了定义一个其他人必须填充的空“骨架”并强制每个人使用它是**非常有限**的。每个人都必须继承它，因此，例如，他们将无法重用自己现有的类层次结构，或者必须创建乏味的桥梁或 (...)。

如果您的抽象基类除了一个/几个/几十个/数百个抽象方法、事件和属性之外什么都没有——它应该是一个接口，因为它只定义了“通用要求”。

使用通用事物创建新抽象基础的唯一合理理由是实际**提供**默认实现。尽管如此，对于这样的基类，也应该定义一个接口，基类应该实现它并允许覆盖甚至可能将某些东西标记为实际上是抽象的——但您的代码仍然应该通过接口引用所有内容，而不是基类。这样的抽象基础应该是实现者的帮助/快捷方式，而不是强制性的。如果有人想从头开始做所有事情 - 他将实现接口并忽略示例代码的基础，您的代码仍然可以很好地使用它。尽管如此，所有通用代码都可以作为一组在该接口上运行的静态帮助程序类提供。

抽象基类实际上是需要的，并且在某些极端情况下不能被接口取代，例如，当您必须强制派生类具有参数构造函数时，或者您自己必须从某些东西派生时，即。像 WPF Visual 或 UIElement 或 DependencyObject --- 因此微软的设计在这里也有一点缺陷。他们强制从基类派生，它在许多地方影响了开发人员（例如，来自 EntityFramework 的数据模型对象不是 DependencyObjects 等）。尽管如此，我认为他们应该从中抽象出来——看看 Visual 和朋友，没有多少内部例程不能提升到接口。我不认为他们这样做只是“因为”，而是，我认为它是关于性能和削减演员/方法调度。

请注意，我所说的一切并不完全符合您在问题中提出的内容。在那里，您已经假设“父/基类将处理 XYZ”。这意味着，您从一开始就放弃了界面方法。使用接口，您将只定义 click 和 cancelclick 必须存在，但您将无法强制/提供“基本实现”。这些事情你可以用基类来做。因此，我认为您应该采取开放/混合的方法：定义接口，定义静态可重用处理程序，仅使用接口，并为一些“懒惰的编码器”提供基类：

```
public interface IClickable
{
    ICommand CancelCommand { get; }
    void CancelClick();
    bool CanCancelClick();
}

public static class ClickableDefaultImpl
{
    public static void DefaultCancelClick(IClickable obj)
    {
        ... do the common things on the OBJ
    }
    public static bool DefaultCanCancelClick(IClickable obj)
    {
        ... do the common things on the OBJ
    }
}

public abstract class Clickable : IClickable
{
    public void CancelClick() { ClickableDefaultImpl.CancelClick(this); }
    public bool CanCancelClick() { return ClickableDefaultImpl.CanCancelClick(this);  }
} 
```

这可能看起来很臃肿，但它对定制非常开放。尽管具有开放性，但几乎没有办法强制每个人都必须使用“ClickableImpl”。有一些方法，但是..它们会包括更多的膨胀和时间/内存开销，我认为它们现在不值得描述。

请记住估计将来将使用此代码的人员、方式和数量。如果是用于一/二/五用途，请坚持使用抽象基础。但是如果你感觉到有几十个或几百个子实现，你最好加上那个小膨胀——以后可能会节省很多时间。

# filesystems - 如何从lua中删除std文件管理

> ID：12164654
> 
> 赞同：1
> 
> 时间：2012-08-28T17:43:19.570
> 
> 标签：filesystems, lua, cross-platform, std, stdio

我尝试将 lua 集成到我的项目中（lua 5.2.1）而且我编译它没有问题。

但我的问题是我的项目使用我自己的系统从文件系统读取/写入文件。

所以我开始修改 lua 以替换 fopen / fclose / fread / fwrite 的每个调用......

但问题是，如果 stdio fct ans 使用一些我在我的项目中没有等效的 FILE 函数（并且没有那么容易重新实现），Lua 混合太多，例如：ungetc setvbuff

等等....

我的问题^^有些人已经尝试这样做了？如果是的话怎么办？是否有人现在是具有此功能的 lua 扩展（某些 c 库使用回调 fct 来询问打开/关闭文件）？

对我来说很奇怪的是，真正在多平台操作系统甚至嵌入式系统上使用的 lua 如此强烈地使用 std lib，对于真正跨平台的 lib，每种类型和来自 std 的 fct 都是类型定义的，以便于平台细节的改变。

感谢你给与我的帮助 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:02:07.463

您不是在询问“Lua 语言的”文件 IO；你说的是“Lua C 库的”文件 IO。从问题中并不清楚这一点。

Lua 对此有规定。`luaL_loadfile`例如，它只是一个函数的语法糖，它打开给定文件，加载它，关闭文件，然后调用`luaL_loadstring`它。

如果您处于文件 IO 必须通过不同渠道的环境中，则不应尝试`luaL_loadfile`使用新的文件 IO。您应该编写一个新函数，该函数从文件系统加载文件并调用`luaL_loadstring`.

简而言之：您不应该使用任何需要文件的 Lua API。Lua 的基于文件的函数是*便利*函数；而已。Lua 本身已经对此有规定；每个基于文件的 API 都有一个同样可以工作的非基于文件的版本。你不应该修改 Lua 本身。

# c# - 更改字符串声明时出现奇怪的错误

> ID：12164658
> 
> 赞同：-1
> 
> 时间：2012-08-28T17:43:34.720
> 
> 标签：c#, .net, debugging

我声明一个字符串，它基本上是一个指示符列表，其中 yy 是字母，xxxx 是数字。

```
string sMyString = "('yy-xxxx','yy-xxxx','yy-xxxx','yy-xxxx','yy-xxxx','yy-xxxx')";

if(File.Exists(sFileLocation + sFileName))
{
    txtRunning.Text = "Starting db copy";
    File.Copy(sFileLocation + sFileName, sFileName, true);
    File.Copy(sDbLocation + "clipper.dbf", "clipper.dbf", true);
    File.Copy(sDbLocation + "clipper.dbt", "clipper.dbt", true);

    txtRunning.Text = "Starting datatable population";
    string connString = @"Provider=VFPOLEDB;Data source=.\clipper.dbf";
    string mySelectQuery = "SELECT UPPER(TRIM(field1))," +
        " UPPER(TRIM(field2)), UPPER(TRIM(field3)), UPPER(TRIM(field4))" +
        " FROM `clipper` WHERE condition1 AND field1 IN " + sMyString +
        " ORDER BY field2;";

    DataTable dtClipper = new DataTable();
    DataTable dtNotFound = new DataTable();
    DataTable dTable = new DataTable();

    OleDbConnection conn = new OleDbConnection(connString);
    OleDbDataAdapter adapter = new OleDbDataAdapter();
    adapter.SelectCommand = new OleDbCommand(mySelectQuery, conn);
    adapter.Fill(dtClipper);
} 
```

如果我取出括号，我会在 dataadapter.fill 命令中收到错误，说该函数不存在。如果我将其更改为字符串文字，无论有无括号，我都会收到相同的错误。如果我保持原样，使用括号和单引号，它运行得很好。

我需要它只是列表，没有单引号，因为我将它们添加到字典中以用作发生率计数器。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:09:45.453

该错误是因为您使用该字符串来运行 SQL 查询，并且没有引号和括号，它是无效的 sql。

您需要保留引号和括号才能使 SQL 查询正常工作。如果您*还*需要以纯字符串形式访问列表，则将其存储为列表。

```
List<string> myStrings = new List<String> {
    "yy-xxxx",
    "yy-xxxx",
    "yy-xxxx",
    "yy-xxxx",
    "yy-xxxx",
    "yy-xxxx"
};
string myStringsForSQL = string.Join(myStrings, "','");

string mySelectQuery = "SELECT UPPER(TRIM(field1)), " +
    "UPPER(TRIM(field2)), UPPER(TRIM(field3)), UPPER(TRIM(field4)) " +
    "FROM `clipper` WHERE condition1 AND field1 IN ('" + myStringsForSQL + "') " +
    "ORDER BY field2;"; 
```

# javascript - 如何使用 Rails 中的控制器在 javascript 文件中创建条件

> ID：12164671
> 
> 赞同：0
> 
> 时间：2012-08-28T17:44:18.700
> 
> 标签：javascript, ruby-on-rails, model-view-controller, coffeescript

我正在尝试扩展[like-twitter 应用程序教程](http://ruby.railstutorial.org/chapters/user-microposts#top)并包含我的第一个脚本（无论教程如何）。

我正在尝试制作一个仅在用户登录时才起作用的脚本（我发现我需要制定此规则，因为当用户未登录时我收到脚本错误）。

调用 js 文件`static_pages.js.coffee`并包含如下代码：

```
micropost =
  p: {
    ...
  }
  init: ->
    ...

$(document).ready ->
  micropost.init() 
```

由于代码与**仅**在用户登录时出现的微博相关，所以我需要一些规则来通知我。

我可以在主文件中放入`views/layout/application.html.erb`一个带有如下变量的脚本：

```
<head>
  <title><%=full_title(yield(:title)) %></title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>

  <script type="text/javascript">
      var signed_in = <%= signed_in? =>;
  </script>

  <%= csrf_meta_tags %>
  <%= render 'layouts/shim' %>
</head> 
```

但它看起来不像干净的方式，**我的问题是：**

1.  我该怎么做？
2.  我需要通过控制器来完成吗？（我不知道怎么...）
3.  而且，我将 $(document).ready 放在 static_pages.js.coffee 中 - 我应该将它放在主 application.js 中，因为这是在构建 dom 后调用所有函数的调用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T21:05:57.087

使用这种美：[https ://github.com/gazay/gon](https://github.com/gazay/gon)

包含在 gem 文件中：

```
gem 'gon' 
```

添加到 application.html.erb（在脚本之前）：

```
 <%= include_gon %> 
```

在任何控制器中，您都可以进行此调用：

```
class StaticPagesController < ApplicationController
  def home
    gon.signed_in = signed_in?
  end 
```

然后你可以从你的js中获取这个参数：

```
console.log(gon.signed_in) 
```

# javascript - 需要关于如何实现 js/css 版本控制的建议

> ID：12164677
> 
> 赞同：3
> 
> 时间：2012-08-28T17:44:32.007
> 
> 标签：javascript, version-control, web

所以我正在实现这个 js/css 版本控制方案，我基本上在其中附加了 js/css 文件的校验和。我正在考虑的策略是，基本上得到这个校验和值，然后计算文件的校验和（我认为可能来自缓存），如果它们匹配，那么客户端有最新的文件，如果没有那么客户端浏览器将强制从服务器下载该特定文件。这种方法正确吗？另外我想了解脚本标签的行为，比如脚本标签的 src 属性，是先去缓存 js 文件还是直接去网络服务器？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:50:58.673

好吧，在现实生活中它实际上更简单。您将一些唯一的校验和附加到 JavaScript 文件*名*（您不会更改文件本身）并在 HTML 文件中使用该全名。此外，当浏览器请求此`.js`文件时，您使用远在未来的`Expires`标头（通常为一年），以便浏览器“*永远*”缓存此文件。查看您现在使用的网站的来源：

```
<script src="http://cdn.sstatic.net/js/stub.js?v=aa8b9e2e0673" type="text/javascript"></script>
<link href="http://cdn.sstatic.net/stackoverflow/all.css?v=ffb907d7e663" rel="stylesheet" type="text/css"> 
```

（所以使用*@machineghost*在这里描述的技术）。

只要你不改变`.js`文件，它的校验和和文件名是一样的，浏览器什么也不做。该文件已缓存，您说它不会在一年内更改。那么如何改变呢？好吧，每次修改文件时，校验和都会发生变化。浏览器看到一个不同的`.js`文件并被迫下载它。以前的文件没用，但浏览器会保留一年（我们不在乎）。

通过这种方式，您可以将激进的缓存和快速更改结合起来（浏览器缓存旧 JavaScript 没有问题，但使用新的 HTML 等）

> script标签的src attr，js文件先去缓存

是的，如果这个 JavaScript 文件已经被下载，浏览器将使用缓存。这实际上有点复杂。如果您`Expires`上次返回标头，浏览器甚至不会接触您的服务器。如果您只返回`Last-Modifed`标头，浏览器将发出所谓的*条件 GET* - 如果文件更改，服务器将仅返回新内容，`304 Not Modified` 否则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:55:39.107

Tomasz 一针见血……除了有一个更简单的解决方案 :-) 根本不要更改文件的文件名；只需更改指向它们的链接，特别是“搜索”部分。而且您实际上并不需要校验和，您也可以在源代码控制系统中使用递增数字或当前修订号

换句话说：

```
<script src='myFile.js'/> 
```

将会：

```
<script src='myFile.someChecksum.js'/> 
```

正如 Tomasz 所描述的那样；如果你这样做：

```
<script src='myFile.js?x=someChecksum'/> 
```

浏览器仍将其视为新文件（当校验和更改时），但您不必每次都更改文件名。如果您使用修订号，您甚至不必每次都计算校验和，您只需要服务器端逻辑即可：

```
<script src='myFile.js?x={{currentRevisionNumber}}'/> 
```

# linq - 实体框架和 LINQ - 算术运算导致溢出

> ID：12164679
> 
> 赞同：4
> 
> 时间：2012-08-28T17:44:43.093
> 
> 标签：linq, entity-framework, odp.net

我收到错误

> 算术运算导致溢出。

运行时：

```
using (MyEntities ctx = new MyEntities())
{
    var OraLINQEX1 = from e in ctx.TABLE_A
        select e;
    Console.WriteLine("LINQ to Entities Result");
    foreach (var result in OraLINQEX1)
    {
        //Console.WriteLine(String.Format("ID: {0}    Name: {1}", result.FIELDA,           result.FIELDB));
    }
} 
```

我的数据库是 Oracle，我正在使用[这个参考](http://www.oracle.com/webfolder/technetwork/tutorials/obe/db/dotnet/EntityFrameworkOBE/EntityFrameworkOBE.htm)。

我用了另一张桌子，它奏效了。我的表有很多字段。这些字段是 varchar2 和没有大小的数字。

我知道产生错误的表的确切记录，但我不知道如何获得更详细的消息。

请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T11:12:55.737

我也有同样的问题。我的例外来自 oracle.dataaccess，我认为这是因为数据库中的数字没有刻度，所以有 38 并且不能转换为十进制。

# python - ModelForm 数据不保存 django

> ID：12164680
> 
> 赞同：0
> 
> 时间：2012-08-28T17:44:47.447
> 
> 标签：python, django

我在这里阅读了有关表单数据未保存的其他帖子，但似乎无法确定我自己的问题。有一种感觉，我错过了一些非常基本的东西。非常感谢帮助谢谢。

```
#model

class AboutMe(models.Model):
    title = models.CharField(max_length=30)
    user = models.ForeignKey(User)
    post = models.TextField()
    created = models.DateTimeField(auto_now_add=True)

    def __unicode__(self):
        return self.title

#form

class AboutMeForm(forms.ModelForm):

    class Meta:
        model = AboutMe
        fields = ['title', 'post']

#view

def post_line(request):
    if request.method == 'POST':
        form = AboutMeForm(request.POST)
        if form.is_valid():
            new_about = form.save(commit=False)
            new_about.user = request.user       
            new_about.save()
            return HttpResponseRedirect('index.html')
    else:
        form = AboutMeForm()
    return render_to_response('post_line.html', locals(), context_instance=RequestContext(request))

#template:

<div class="post_line">
<form enctype="multipart/form-data" action='.' method="post">{% csrf_token %}
    {{ form.as_table }}
    <input type="submit" name="submit" value="post" />
</form>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-26T13:29:30.837

尝试这样做：

表格.py

```
class AboutMeForm(ModelForm):
    class Meta:
        model=AboutMe
        fields = YOUR FIELDS

    def __init__(self, *args, **kwargs):
        self.user = kwargs.pop('user', None)
        super(AboutMeForm, self).__init__(*args, **kwargs)

    def save(self, commit=True):
        instance = super(AboutMeForm, self).save(commit=False)
        if self.user:
            instance.user = self.user
        return instance.save() 
```

在views.py上：

```
def post_line(request):
    if request.method == 'POST':
        form = AboutMeForm(request.POST)
        if form.is_valid():
            new_about = form.save() 
            return HttpResponseRedirect('index.html')
    else:
        form = AboutMeForm()
    return render_to_response('post_line.html', locals(), context_instance=RequestContext(request)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T17:56:31.603

I am not able to comment here so i am writing here

1) `HttpResponseRedirect('index.html')` this is wrong here you have to pass some url like

/login/ or /profile/

2) please print your form like

print form and check what you are getting is all fields are valid or anything missing

and then tell the form error

# sockets - 如何在服务端（HTTP服务器）知道Lua中的客户端套接字描述符

> ID：12164682
> 
> 赞同：2
> 
> 时间：2012-08-28T17:44:48.810
> 
> 标签：sockets, lua, http-headers, luasocket

在启用 Lua 的网络服务器（如 Lighttpd、Apache）上使用时，有没有办法知道服务器端连接的客户端套接字描述符？

我测试了获取客户端 IP 地址和 HTTP 标头，并且能够正确接收它们。

我在 Lua Socket(2.0.3) 中找不到任何可以接受 HTTP 请求并返回请求的套接字描述符的函数。

如果可用的启用 Lua 的网络服务器不提供这些功能，我们有什么办法可以试试吗？

# apache - mod_expires 还是 mod_headers？

> ID：12164684
> 
> 赞同：6
> 
> 时间：2012-08-28T17:45:01.227
> 
> 标签：apache, browser-cache, mod-expires, mod-headers

[这个页面](http://www.askapache.com/htaccess/speed-up-sites-with-htaccess-caching.html)是这样说的：

> 如果响应同时包含 Expires 标头和 max-age 指令，则 max-age 指令将覆盖 Expires 标头，即使 Expires 标头更具限制性

似乎 mod_expires 和 mod_headers 在我的服务器中都处于活动状态。
其中哪一个更可取，您能评论一下它们各自的优点吗？
谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T18:01:13.223

您可能只想使用 mod_expires，因为这允许自动发送 Cache-Control 标头和 Expires 标头，并且可以允许您指定访问时间和文件修改时间。它还允许您按文件类型设置不同的默认值。

使用 mod_expires 您可以使用以下指令设置默认到期时间：

```
ExpiresDefault "access plus 2 days" 
```

当然 mod_headers 是一个更通用的模块，它允许您做一些相同的事情，但通常更多地用于创建自定义标题或管理多个（可能是冲突的）标题。

# excel - 如何在 Excel VBA 中将多个 Excel 工作表复制到 1 个变体

> ID：12164685
> 
> 赞同：0
> 
> 时间：2012-08-28T17:45:01.737
> 
> 标签：excel, vba

我在 Excel VBA 中使用以下代码复制 Excel 工作表进行计算：

```
Dim Store1Sheet() As Variant

Store1Sheet = Range("A1:D99") 
```

请您告知如何将多个 Excel 工作表复制到 1 个变体，例如 StoreMultiSheet。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:31:57.770

从技术上讲，您正在做的是在 Variant 中存储该范围内每个单元格的值数组。

要执行您要求执行的操作，您需要创建一个由这些数组组成的数组。例如，假设您将不得不做这样的事情，假设数组基数为 0：

```
Dim Multisheet() As Variant
Dim x As Integer
ReDim Multisheet(Sheets.Count - 1)
For x = 0 To Sheets.Count - 1
    Multisheet(x) = Sheets(x + 1).Range("A1:D99")
Next 
```

这将生成一个变体数组，其中包含工作簿中每个工作表的“A1：D99”范围内的每个单元格的值的变体数组。

要访问它们，您需要使用`Multisheet(x)`，这将等同于`Store1Sheet`您习惯使用的。

我建议查看 JackOrangeLantern 提供的一些相关问题，因为这种方法感觉相当不妥。

# java - 从 Groovy 测试用例模拟 Java 类

> ID：12164690
> 
> 赞同：1
> 
> 时间：2012-08-28T17:45:20.103
> 
> 标签：java, grails, groovy, junit, mocking

我正在尝试用 groovy 为用 java 编写的类编写一个测试用例。Java 类（名称：Helper）中有一个方法，其中获取 HttpClient 对象并在其上调用 executeMethod。我试图在常规测试用例中模拟这个 httpClient.executeMethod() ，但无法正确模拟它。

下面是Java类 //这个帮助类是一个java类

```
public class Helper{

public static message(final String serviceUrl){   
----------some code--------

HttpClient httpclient = new HttpClient();
HttpMethod httpmethod = new HttpMethod();

// the below is the line that iam trying to mock
String code = httpClient.executeMethod(method);

}
} 
```

到目前为止，我用 groovy 编写的测试用例是：

```
 void testSendMessage(){
        def serviceUrl = properties.getProperty("ITEM").toString()

    // mocking to return null   
def mockJobServiceFactory = new MockFor(HttpClient)
    mockJobServiceFactory.demand.executeMethod{ HttpMethod str ->
                return null
            }

    mockJobServiceFactory.use {         
             def responseXml = helper.message(serviceUrl)

            }   
        } 
```

关于为什么它没有正确模拟的任何想法。提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T22:02:32.203

出色地！很难测试静态方法，甚至更难测试局部变量，除非您将它们声明为属性。我对静态类的结论有时是关于设计的，因为您可以将该代码块放在其他地方并重用。无论如何，这是我在这种情况下使用存根、模拟和 MOP 进行测试的方法：

这是一个类似于您的类的 Java 类：

```
import java.text.SimpleDateFormat;
import java.text.ParseException;
import java.util.Date;

public class Helper{

  public static String message(final String serviceUrl) throws ParseException{
    SimpleDateFormat formatter = new SimpleDateFormat("dd-MM-yy");
    Date d = formatter.parse(serviceUrl);
    String code = d.toString();
    return code;
  }
} 
```

这是我的 GroovyTestCase：

```
import groovy.mock.interceptor.MockFor
import groovy.mock.interceptor.StubFor
import java.text.SimpleDateFormat

class TestHelper extends GroovyTestCase{

  void testSendMessageNoMock(){
    def h = new Helper().message("01-01-12")
    assertNotNull h
    println h
  }

  void testSendMessageWithStub(){
    def mock = new StubFor(SimpleDateFormat)
    mock.demand.parse(1..1) { String s -> 
      (new Date() + 1) 
    }
    mock.use {
      def h = new Helper().message("01-01-12")
      assertNotNull h
    }
  }

  void testSendMessageWithMock(){
    def mock = new MockFor(SimpleDateFormat)
    mock.demand.parse(1..1) { String s -> 
      (new Date() + 1) 
    }
    shouldFail(){
      mock.use {
        def h = new Helper().message("01-01-12")
        println h
      }  
    }
  }

  void testSendMessageWithMOP(){
    SimpleDateFormat.metaClass.parse = { String s -> 
      println "MOP"
      new Date() + 1 
    }
    def formatter = new SimpleDateFormat()
    println formatter.parse("hello world!")
    println " Exe: " +  new Helper().message("01-01-12")
  }
} 
```

您的问题的答案可能是：因为是方法中的局部变量，而不是要测试的协作者。

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T11:37:06.503

它不起作用，因为编译的 Java 类在构造*HttpClient*实例时未通过 Groovy 的元对象协议 (MOP)，因此未实例化模拟对象。

由于*HttpClient*实例是线程安全的，我会考虑将其作为依赖项注入到类中，这样测试就可以简单地注入模拟。

# javascript - 项目总计 NaN

> ID：12164691
> 
> 赞同：1
> 
> 时间：2012-08-28T17:45:20.630
> 
> 标签：javascript

我正在编写一个 codecademy.com 教程，我们正在构建一个收银机。我应该制作必要的工具来取消收银机的最后一笔交易。因此，我补充说

1.  一个名为 lastTransactionAmount 的属性
2.  函数“添加”的另一行代码以设置最后一笔交易金额
3.  一个函数 voidLastTransaction 金额，从总金额中减去最后一笔交易
4.  然后我在底部测试了 void last transaction 函数（我希望这四个巧克力作废
5.  然后我试着加了三块巧克力

当我运行代码时，我得到

> 你的账单是 NaN

有人可以解释我做错了什么吗？

```
var cashRegister = {
    total:0,
    //Dont forget to add your property
    lastTransactionAmount: 0,         //this is a property I added

    add: function(itemCost) {
        this.total +=  itemCost;
        this.lastTransactionAmount = this.itemCost; //I added this to save 
    },
    scan: function(item,quantity) {
        switch (item) {
        case "eggs": this.add(0.98 * quantity); break;
        case "milk": this.add(1.23 * quantity); break;
        case "magazine": this.add(4.99 * quantity); break;
        case "chocolate": this.add(0.45 * quantity); break;
        }
        return true;
    },
    //Add the voidLastTransaction Method here // I made this function to void l
    voidLastTransaction: function() {
        this.total = this.total - this.lastTransactionAmount; 
    }
};

cashRegister.scan('eggs',1);
cashRegister.scan('milk',1);
cashRegister.scan('magazine',1);
cashRegister.scan('chocolate',4);

//Void the last transaction and then add 3 instead
cashRegister.voidLastTransaction();              //I'm voiding last transaction
cashRegister.scan('chocolate', 3);             //trying to add 3 (instead of 4)chocolate

//Show the total bill
console.log('Your bill is '+cashRegister.total); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T17:48:22.153

中没有财产`itemCost`。`cashRegister`它应该是`this.lastTransactionAmount = itemCost;`

# python - 从服务器读取一个巨大的文件。

> ID：12164692
> 
> 赞同：-1
> 
> 时间：2012-08-28T17:45:43.113
> 
> 标签：python, shell, unix

所以我是这个领域的新手，不知道该怎么做！！但基本上这就是我所做的。

我sshed到somehost。

```
ssh hostname
username: foo
password: bar 
```

在其中一个目录中，有一个巨大的 csv 文件.. abc.csv

现在，我不想将该文件复制到我的本地.. 但从那里读取它。

当我问周围的人时，他们说我可以编写一个 unix 脚本并从 tehre 获取我的 python 程序中的数据。我不确定那是什么意思？有什么线索吗？另外，我正在使用 Windows 环境。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:58:26.533

You could run a python script on the Linux server.

Or you could subprocess.Popen a Cygwin ssh (with passwordless, passphraseless authentication) and treat it as though the file is on your Windows system. The cygwin ssh could just run "ssh linux.server.com cat my-file.csv" and then read the content line by line back on the windows system in python.

[http://stromberg.dnsalias.org/~strombrg/ssh-keys.html](http://stromberg.dnsalias.org/~strombrg/ssh-keys.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:51:12.523

远程命令的标准输出被传递到`ssh`进程的标准输出。如果您的脚本从标准输入读取文件，您可以尝试

```
ssh user@hostname 'cat abc.csv' | python myScript.py 
```

# ajax - 如何在提交表单上获取星级评分的选定值

> ID：12164693
> 
> 赞同：1
> 
> 时间：2012-08-28T17:45:49.320
> 
> 标签：ajax, select

我想得到这个 ajax 星级评分的选定值，我不知道为什么，但它的意思并不明显。

```
<span id="stars-cap"></span>
    <div id="stars-wrapper2">
     <select name="selrate">
         <option value="1">Déplorable</option>
         <option value="2">Pas satisfaisant</option>
         <option value="3">Correct</option>
         <option value="4" selected="selected">Très satisfaisant</option>
         <option value="5">Parfait</option>
</select> 
```

我有 4 个区块 评分后，用户必须提交表单。

我尝试添加这个：

```
document.getElementById('selrate').value 
```

像这样的ID：

但它不运行...

您可以在此处查看示例：http: [//www.developper-photo.com/tpl/avis-labos.php](http://www.developper-photo.com/tpl/avis-labos.php)

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T17:51:58.677

```
var selectedOption = ​$('select[name=selrate] option:selected').text()​; 
```

尝试上面的脚本并将其传递`selectedOption`给您的 ajax 请求参数。我相信您熟悉`jquery`并且我的脚本可能仅适用于包含`jquery`在您的网站中。

# iphone - CSS背景未显示在移动设备上

> ID：12164695
> 
> 赞同：3
> 
> 时间：2012-08-28T17:45:56.423
> 
> 标签：iphone, html, css, mobile, background-image

在移动设备（尤其是 iPhone）上查看网站时，我的背景图片无法正确显示。我可以在那里看到它只是不在正确的位置。我附上了一个图片链接，显示了背景是如何呈现的，以及一个指向该网站的链接。

如果有人有解决此问题的答案，我将非常感谢任何建议。

提前致谢。

[http://mikedemar.com/weightloss4youth/bgissue](http://mikedemar.com/weightloss4youth/bgissue)

[http://mikedemar.com/weightloss4youth/index.html](http://mikedemar.com/weightloss4youth/index.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:22:03.767

也许试试这个：

```
html { 
        background: url(images/bg.jpg) no-repeat center center fixed; 
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
    } 
```

您可以在以下位置查看其他方法：[http ://css-tricks.com/perfect-full-page-background-image/](http://css-tricks.com/perfect-full-page-background-image/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T12:51:49.833

我的一个朋友建议我删除“width=device-width”并将背景大小设置为 2560px 1440px。这是完美的工作。见链接。

[http://mikedemar.com/weightloss4youth/index.html](http://mikedemar.com/weightloss4youth/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T17:50:40.453

试试这个

```
<meta name="viewport" content="width=device-width, initial-scale=1.0" /> 
```

# javascript - JetBrains WebStorm 中的原生或底层 JavaScript 文件

> ID：12164707
> 
> 赞同：1
> 
> 时间：2012-08-28T17:46:38.560
> 
> 标签：javascript, webstorm, ecmascript-5

我目前正在使用 JetBrains WebStorm 开发一个 JavaScript 库。当我声明一个变量 (EG `var instance = new HTMLDivElement()`) 时，它在智能感知中显示为在 JavaScript 文件中定义（在 的情况下`HTMLDivElement`，它似乎在 DHTML.js 中）。我似乎找不到它们，但是如果可能的话，我想找到它们，以便我可以理解本机对象的底层代码。这些文件物理上是否位于我的系统上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:49:51.457

是的，根据我使用 PHPStorm 的经验，它保存在原始安装文件夹下某个位置的 .jar 文件中。我将尝试在 PHPStorm 中找到它，以便您了解在 IDE 中的查找位置。

在 PHPStorm 中，它位于

```
INSTALLATION_FOLDER\plugins\php\lib\php.jar(\com\jetbrains\php\lang\psi\...) 
```

那是一个PHP函数。希望这可以帮助您在 WebStorm 上找到合适的。请注意，除了函数和方法定义之外什么都没有（实际的实现不存在）。

# android - 为什么需要 android:description？

> ID：12164709
> 
> 赞同：1
> 
> 时间：2012-08-28T17:46:41.813
> 
> 标签：android, android-manifest

在 Android 清单文件中有 android:description 字段。这是[Android 指南](http://developer.android.com/guide/topics/manifest/application-element.html)提供的内容：

> 安卓：描述
> 
> 关于应用程序的用户可读文本，比应用程序标签更长且更具描述性。该值必须设置为对字符串资源的引用。与标签不同，它不能是原始字符串。没有默认值。

没有提到这个领域的目标。

用户能否看到该字段？用户在哪里可以看到？是否有用户可以看到的设备？

此字段是否会影响 Google Play 搜索或其他市场（Kindle Fire、Nook、三星市场等）中的位置？

这个领域的目的是什么？我应该填写它还是可以简单地将它留空？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:59:17.783

This must be only for longer and more descriptive as stated in [docementation](http://developer.android.com/guide/topics/manifest/application-element.html#desc).

There is another interesting answer [Where appears android:description label from your manifest?](https://stackoverflow.com/a/9402654/432903) comparing it to `meta-tag`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:53:03.120

[据此，](https://stackoverflow.com/questions/8420730/where-appears-androiddescription-label-from-your-manifest)任何人的最佳猜测是，如果您想从其他应用程序的清单中获取描述。例如，我想如果您正在创建一个应用程序管理器应用程序。您将从那里获得应用程序的描述。除此之外，它并没有真正在任何地方使用。

# google-app-engine - 多域分析 - Google App 引擎托管站点

> ID：12164710
> 
> 赞同：0
> 
> 时间：2012-08-28T17:46:43.990
> 
> 标签：google-app-engine, google-analytics, subdomain

> **可能重复：**
> [Google 应用引擎网站的多个域 - 每个域的分析](https://stackoverflow.com/questions/12159060/multiple-domains-for-google-app-engine-site-analytics-for-each-domain)

好的，所以我正在测试这家汽车公司的营销理念，购买 10 个左右的域名，其中包含与业务相关的关键词（例如 carservice.com carmot.com hondaservice.com），并将它们全部链接到一个托管的站点在谷歌应用引擎上。我已经完成了这项工作，每个域都显示相同的站点，但我现在想要让谷歌分析显示有多少人点击了每个域，这样我就知道它是否值得更新。如果没有人访问它，它不值得支付。有没有办法可以将每个域发送到托管在同一个应用引擎帐户上的不同页面？这样我就可以将其发送到具有域唯一分析代码的页面，然后将其重定向到主站点。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T20:22:42.223

我要做的是使用 GA 事件来告诉分析他们去了哪个站点。
例如 _gaq.push(['_trackEvent', Catagory, Action]) 并将类别作为“站点”，将操作作为域名（“carservice.com”或“carmot.com”或“hondaservice.com”）

我认为通过这种方式，您可以使用 GA 告诉您每个站点的运行情况以及人们如何访问每个站点（关键字、直接链接、营销）及其跳出率。

# c# - 复制目录不放文件

> ID：12164712
> 
> 赞同：2
> 
> 时间：2012-08-28T17:46:51.337
> 
> 标签：c#, file, process

我直接从[How to: Copy, Delete, and Move Files and Folders (C# Programming Guide)](http://msdn.microsoft.com/en-us/library/cc148994.aspx)获得了这段代码：

```
string sourceDir = currDir + "\\" + "Trends";
string targetDir = currDir + "\\" + reportDir + "\\" + "Trends";
if (Directory.Exists(sourceDir))
{
    string[] files = Directory.GetFiles(sourceDir);

    foreach (string file in files)
    {
        string fileName = Path.GetFileName(file);
        string targetFile = Path.Combine(targetDir, fileName);
        File.Copy(file, targetFile, true);
    }
} 
```

但是，当我运行此代码时，我会在 sourceDir 中的每个文件上抛出一个错误，因为它已经在使用中，所以无法访问它。当我退出代码时，很明显没有其他进程正在使用这些文件，所以一定是这段代码导致了问题。有没有办法为此使用“使用”？

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:05:48.190

感谢所有的建议——他们让我找到了答案。我正在覆盖我的网页的 Render 方法以将其中一个表保存为 .html 文件。为了显示这个表，我需要 sourceDir 中的文件。但是，表格不会立即呈现，因此在第一次调用 Render 时，这些文件会被 Web 应用程序合法使用。我发布的代码工作得很好。

# c# - 如何以管理员身份运行windows服务

> ID：12164715
> 
> 赞同：0
> 
> 时间：2012-08-28T17:46:59.567
> 
> 标签：c#, windows-services

在我的 Windows 服务中，我无法在`onStart`方法中创建文件给我一个错误

**错误在 onstart 方法中访问路径“C:\Program Files (x86)\Common Files\xxx\BridgeServiceLog.txt”被拒绝。**

现在我如何通过代码以管理员身份运行我的服务

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:49:13.360

你不能提升自己的过程。此外，由于服务并非旨在与桌面交互，因此不会向用户显示您提示的任何通知。您需要调整执行服务的用户帐户。

![在此处输入图像描述](../Images/1556a9d752d2a24d55ffd6d7f44cc555.png)

# c# - 尝试将 XmlElementAttribute 分配给 .NET CF 下的自定义 IXmlSerializable 对象时出现 InvalidOperationException

> ID：12164716
> 
> 赞同：3
> 
> 时间：2012-08-28T17:47:07.887
> 
> 标签：c#, .net, windows-mobile, xml-serialization, .net-cf-3.5

假设我们有一些类似的代码：

```
[XmlRoot("class-a")]
public class ClassA
{
    [XmlElement("variable")] // without this everything works fine
    public ClassB<Type1, Type2> Variable;

    public ClassA()
    {
        new XmlSerializer(typeof(ClassA)); // exception occurs here
    }
}

public class ClassB<TKey, TValue>
    : NonSerializableClassC<TKey, TValue>, IXmlSerializable
{
    // irrelevant stuff
} 
```

在标题的上下文中，一切都是不言自明的。

请注意，这是 .NET CF [3.5]，其中 XmlSerialization 的内部完全不同（由于性能问题）。相同的代码在 .NET [4.0] 的桌面版本下运行良好。此外，这个问题实际上并没有影响我的工作，因为我仅将 XmlElementAttribute 用于元素别名，通过重命名变量本身可以轻松访问。但这不是一个真正的解决方案。

**所以......任何想法为什么这不起作用？**

* * *

*堆栈跟踪的最后条目：*

```
// . . .
System.Xml.dll!System.Xml.Serialization.XmlSerializer.XmlSerializer(System.Type type = {Name = "ClassA" FullName = "RandomProject.ClassA"})
System.Xml.dll!System.Xml.Serialization.XmlSerializer.XmlSerializer(System.Type type = {Name = "ClassA" FullName = "RandomProject.ClassA"}, System.Xml.Serialization.XmlAttributeOverrides overrides = null, System.Type[] extraTypes = null, System.Xml.Serialization.XmlRootAttribute root = null, string defaultNamespace = null)
System.Xml.dll!System.Xml.Serialization.XmlSerializer.findTypeByType(System.Type type = {Name = "ClassA" FullName = "RandomProject.ClassA"}, string defaultNamespace = null)
System.Xml.dll!System.Xml.Serialization.XmlSerializationReflector.FindType(System.Type type = {Name = "ClassA" FullName = "RandomProject.ClassA"}, bool encoded = false, string defaultNamespace = null, bool searchIntrinsics = true)
System.Xml.dll!System.Xml.Serialization.XmlSerializationReflector.AddType(System.Type type = {Name = "ClassA" FullName = "RandomProject.ClassA"}, bool encoded = false, string defaultNS = null, bool genericNullableArg = false) 
```

* * *

**UPD1**：顺便说一句，如果我在 ClassB 声明上方添加 XmlTypeAttribute/XmlRootAttribute - 在同一个地方发生同样的异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T11:02:07.047

你可以试试。

```
public class ClassB<TKey, TValue>
    : NonSerializableClassC<TKey, TValue>, IXmlSerializable
where TKey : IXmlSerializable
where TValue : IXmlSerializable 
```

# java - 如何从 JavaFX 选项卡中删除阴影？

> ID：12164717
> 
> 赞同：6
> 
> 时间：2012-08-28T17:47:10.770
> 
> 标签：java, javafx

我在 JavaFX 中有选项卡，我想设置一种样式来删除阴影：

![在此处输入图像描述](../Images/21cc7862851ae6eda66b7b54b98be6f9.png)

如果您查看 foo 的左侧，您可以看到阴影。

这是我现在的风格：

```
.tab {
    -fx-background-color: #393939;
    -fx-border-color: #282828;
    -fx-border-width: 0;
    -fx-padding: 1 8;
} 
```

我试图查看文档，但找不到删除阴影的方法：http: [//docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html#tabpane](http://docs.oracle.com/javafx/2/api/javafx/scene/doc-files/cssref.html#tabpane)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-29T15:48:58.957

要查找默认样式表，请在您的计算机上搜索该文件`jfxrt.jar`，在 WinRAR 等存档器中打开它，然后打开`com/sun/javafx/scene/control/skin/caspian.css`. 有了这些知识，您就可以轻松查看导致问题的原因。

`caspian.css`也可以在线获得，这里是[JavaFX 2.2 版本](http://hg.openjdk.java.net/openjfx/2.2/master/rt/raw-file/tip/javafx-ui-controls/src/com/sun/javafx/scene/control/skin/caspian/caspian.css)的链接。

现在，添加这种样式：

```
.tab-pane .headers-region {
    -fx-effect: null;
} 
```

它删除了默认样式并且阴影消失了。

# php - CakePHP - 从插件加载路由文件

> ID：12164718
> 
> 赞同：6
> 
> 时间：2012-08-28T17:47:16.017
> 
> 标签：php, cakephp, plugins, routing, routes

有人可以指出我是如何做到的吗？我想在插件文件夹本身的配置文件中定义插件特定的路由。

目前，我只是在我的主要 routes.php 文件中定义用于插件的路由。这显然会变得很长。所以我想将它重构为一个单独的配置文件并将其放在插件的文件夹中。

但是我看到有一个代码实际上会自动加载特定于插件的路由，但我找不到任何关于此的文档。在“config/routes.php”中，有一行说

```
/**
 * Load all plugin routes.  See the CakePlugin documentation on 
 * how to customize the loading of plugin routes.
 */
CakePlugin::routes(); 
```

[在这里](http://book.cakephp.org/2.0/en/development/routing.html)搜索插件路由是完全不同的主题。[插件文档](http://book.cakephp.org/2.0/en/plugins.html)对此一无所知。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-28T18:41:13.063

查看本节中的文档：[插件配置](http://book.cakephp.org/2.0/en/plugins.html#plugin-configuration)。

首先，[将您的路由添加](http://book.cakephp.org/2.0/en/development/routing.html)到 app/Plugin/YourPlugin/Config/routes.php

在 app/Config/bootstrap.php 中执行此操作：

```
<?php
CakePlugin::loadAll(array(
    'Blog' => array('routes' => true),
    'ContactManager' => array('bootstrap' => true),
    'WebmasterTools' => array('bootstrap' => true, 'routes' => true),
)); 
```

它会加载您所有可用的插件，但添加您在数组参数中列出的附加功能。如果您想为所有可用插件加载路由，请在 app/Config/bootstrap.php 中执行此操作：

```
<?php
CakePlugin::loadAll(array(
    array('bootstrap' => true)
)); 
```

祝你好运！

# c# - 在 ac# 应用程序中将 html 页面作为 word 文档附加到 Outlook 中

> ID：12164720
> 
> 赞同：3
> 
> 时间：2012-08-28T17:47:35.657
> 
> 标签：c#, html, asp.net, ms-word, outlook

我正在用 c# 编写一个 Web 表单应用程序，我遇到了这个问题。我想在一个页面中创建一个按钮，一旦按下：1）它会打开outook 2）要发送的邮件的附件是作为word文档的aspx页面。

我已经尝试了两天，但我仍然找不到解决方案！我几乎用一个脚本找到了一个解决方案，首先（使用 Interop.World 库）打开 Word 并从 html 代码创建文档，然后运行一个宏，该宏打开带有附件中文档的 Outlook ......但它只工作当我调试应用程序时，一旦页面发布到我的本地 Intranet 就不会。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:05:03.757

你不可以做这个。

您在 ASP.NET / JSP /PHP 中创建 Web 应用程序，您的网站将作为 HTML 呈现给客户端浏览器。它无法访问客户端计算机中的应用程序。如果可能的话，人们会编写网站，在其中自动打开客户端计算机中的 Skype / Outlook / 投递箱应用程序并窃取发送给作者的相关数据。

您可以在客户端计算机上做某事的唯一可能性是创建一个 Activex 组件并让用户下载它并授予运行权限。这与所有浏览器都不兼容。您还可以查看 Silver light 运行时的功能，看看它可以在客户端做什么（非常少）。

**摘要：** ***不要计划在客户端计算机上做某事的任何功能。这几乎是不可能的。***

您可以考虑的是其他一些库，它们从您的数据创建一些文档（PDF ？）并使用 dot net（SmtpClient 类）中的标准电子邮件发送过程发送电子邮件。

# jquery - 使用 Superscrollorama 的视差滚动文本

> ID：12164723
> 
> 赞同：1
> 
> 时间：2012-08-28T17:47:49.160
> 
> 标签：jquery, parallax

我试图让 John Polacek 的 Superscrollorama jQuery 插件对某些文本产生视差效果，但我一直遇到困难 - 错误消息：“控制器未定义”但据我所知控制器已定义，我'我可能错过了明显的，但我不确定是什么？

[http://jsfiddle.net/RPRzW/6/](http://jsfiddle.net/RPRzW/6/)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:15:28.930

你需要初始化控制器，像这样..

```
var controller = $.superscrollorama(); //Pass settings if any 
```

[更新的演示](http://jsfiddle.net/mrobin/RPRzW/8/)

# java - 在 Java 中格式化货币

> ID：12164727
> 
> 赞同：3
> 
> 时间：2012-08-28T17:48:07.897
> 
> 标签：java, swing, user-interface, formatting

在我当前的项目中，我将货币值存储为`int`代表美分数的值。但是，当用户在文本字段中输入此值时，他们很可能希望将其输入为十进制值。另外，如果用户不手动输入，我想在前面加上一个美元符号。我如何利用 a`JFormattedTextField`为我完成大部分工作？或者是否有其他使用预先存在的 Swing 组件的解决方案，这样我就不必通过手动编码来重新发明轮子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:24:34.197

`NumberFormat`也适用于格式化货币（请参阅 参考资料）[`NumberFormat#getCurrencyInstance`](http://docs.oracle.com/javase/7/docs/api/java/text/NumberFormat.html#getCurrencyInstance%28java.util.Locale%29)。既然你需要一个`Format`我`JFormattedTextField`会从那里开始。

您可以将其配置`NumberFormat`为允许十进制值，并稍后在您的代码中将其转换为`int`没有问题的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:55:18.067

我强烈建议考虑 Joda Money 库-> [http://joda-money.sourceforge.net/userguide.html](http://joda-money.sourceforge.net/userguide.html)

# asp.net - MVC 4 - DataAnnotations - 类型验证

> ID：12164728
> 
> 赞同：12
> 
> 时间：2012-08-28T17:48:08.687
> 
> 标签：asp.net, asp.net-mvc, data-annotations

我有以下代码工作

```
 [Required(ErrorMessage = "Price is required.")]
    [Range(typeof(Decimal), "1", "9999", ErrorMessage = "Price xx.xx")]
    public decimal? productPrice { get; set; } 
```

当页面提交时 Price = EMPTY Field 错误消息是“Price is required.”。价格 = 超过 9999 错误消息是“价格 xx.xx”。

但是，当我键入“aaaa”时，错误消息是 **“该字段 productPrice 必须是数字”。**

如果输入不正确，如何更改消息？比如：“价格必须是 1-9999 之间的小数/数字。

**---- 更新：----** 下面的代码使用

NULL，非十进制，介于范围之间，但不适用于“.1”。

```
 [Required(ErrorMessage = "Price is required.")]
    [RegularExpression(@"[0-9]*\.?[0-9]+", ErrorMessage = "Price must be a Numbers only.")]
    [Range(typeof(Decimal), "1", "9999", ErrorMessage = "Price must be a decimal/number between {1} and {2}.")]
    public decimal? productPrice { get; set; } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-28T17:54:55.583

您可以尝试使用正则表达式：

```
[RegularExpression(@"[0-9]*\.?[0-9]+", ErrorMessage = "{0} must be a Number.")] 
```

您还可以尝试数据注释扩展： [http ://dataannotationsextensions.org/Home/Wiki](http://dataannotationsextensions.org/Home/Wiki)

或者编写自己的实现，如下所示： [https ://github.com/srkirkland/DataAnnotationsExtensions/blob/master/DataAnnotationsExtensions/DigitsAttribute.cs](https://github.com/srkirkland/DataAnnotationsExtensions/blob/master/DataAnnotationsExtensions/DigitsAttribute.cs)

**使用 REGEX更新** （匹配 $9,999.99 | $0.70 | .1）

```
[RegularExpression(@"^\$?([1-9]{1}[0-9]{0,2}(\,[0-9]{3})*(\.[0-9]{0,2})?|[1-9]{1}[0-9]{0,}(\.[0-9]{0,2})?|0(\.[0-9]{0,2})?|(\.[0-9]{1,2})?)$", ErrorMessage = "{0} must be a Number.")] 
```

或者使用 Range 对@Martin 的建议稍作修改（实际上是一个更好的解决方案）：

```
[Range(typeof(Decimal), "0", "9999", ErrorMessage = "{0} must be a decimal/number between {1} and {2}.")] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T18:04:05.173

首先，我认为您将希望将 Range 属性更改为

```
[Range(typeof(Decimal), "1", "9999", ErrorMessage = "{0} must be a decimal/number between {1} and {2}.")] 
```

[根据 MSDN，](http://msdn.microsoft.com/en-us/library/cc679255.aspx)这是使用 RangeAttribute 的有效方法。

第二：

> “字段 productPrice 必须是数字。”

这实际上是不显眼的客户端 JavaScript 验证启动。您的范围验证器将在数字被验证后触发。您可以禁用号码验证器，但我不建议这样做：

```
$.validator.methods.number = function (n, t) {
    return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-10T21:41:21.060

我认为您可能会绊倒 jQuery 中的错误。该验证正在与为您的验证属性发出的内容作斗争。

我有以下财产：

```
[Display(ResourceType = typeof(TaxSetupResources), Name = "Model_Value")]
[RegularExpression(@"(^\d+$)|(^\.\d{1,4}$)|(^\d*\.\d{0,4}$)", ErrorMessageResourceName="Model_InvalidFormatForAmount", ErrorMessageResourceType=typeof(TaxSetupResources))]
public decimal? Value { get; set; } 
```

在这样的视图中使用：

```
<div>
    @Html.TextBoxFor(t => t.Tiers[i].Value, new { title = @Resources.TaxSetupResources.Model_ValueTip })
    <br />@Html.ValidationMessageFor(t => t.Tiers[i].Value)
</div> 
```

就其本身而言，值“foo”会产生我的错误消息。接受值 0.075。0.075 的值会产生“字段值必须是数字”，您似乎遇到了同样的问题。

基于[this SO article](https://stackoverflow.com/questions/5276531/decimal-is-not-validated-correctly-in-mvc-3-with-jquery-validator)，我在准备好的文档中添加了以下内容：

```
$(function () {
    $.validator.methods.number = function (value, element) {
        return parseFloat(value).toString() !== "NaN";
    }
}); 
```

现在我只收到我的错误消息，并且只有在预期的时候（接受.075）。

# java - 将int添加到字符串

> ID：12164729
> 
> 赞同：-1
> 
> 时间：2012-08-28T17:48:17.117
> 
> 标签：java

我正在尝试制作一个看起来像这样的列表 Pages = ["Page 1", "Page 2" ... "Page 48"]

我正在使用这个，以下几行有什么问题吗？

```
String[] Pages = {};
    int i = 0;
    for (; i < 47; i++) {
        String p = Integer.toString(i+1);
        Pages[i] = ("Page " + p);
    } 
```

它一直给我一个 arrayIndexOutOfBoundsException

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T17:49:54.947

页面已初始化为长度 0。`String[] Pages = new String[47];`将解决您的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T17:52:26.513

正如我在[评论](https://stackoverflow.com/questions/12164729/adding-int-to-string#comment16280492_12164729)中提到的，

> 是由声明为的`ArrayIndexOutOfBoundsException`事实引起的，因此没有可索引的元素 - 它的长度为.`Pages``{ }``0`
> 
> 评估时抛出异常`Pages[i]`，而不是做时`"Page " + p`。要更正，请尝试`String[] Pages = new String[47];`:-)

或者，正如评论中提到的 Ash，你想要一个`List<String>`代替吗？

```
final List<String> pages = new ArrayList<String>(47);
for (int i = 1; i <= 47; ++i) {
  pages.add("Page " + i);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-28T17:51:50.153

更清洁更好的方法是使用`Collection`......

尝试使用列表

```
List<String> aList = new ArrayList<String>();

for(int i=0 ; i<47 ; i++ ){

    aList.add("Page :"+i);

 } 
```

集合将为您提供比数组更大的灵活性......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T17:50:57.520

这是因为您的数组尚未初始化为 47，而是 0。试试这个：

```
String[] Pages = new String[47]; 
```

我希望这有帮助。

# python - 逻辑或列

> ID：12164734
> 
> 赞同：1
> 
> 时间：2012-08-28T17:48:30.937
> 
> 标签：python, matrix, dynamic-programming, logical-operators

在 Python 中对矩阵的每一列执行逻辑 OR（在 1 和 0 上）的最有效方法是什么？

```
 0    0    0
   0    0    0
   1    0    1
   0    0    1
OR 0    0    1
   _    _    _
   1    0    1 
```

一些背景：我正在使用动态编程方法为我一直在从事的一个小项目生成一个表。我有两张桌子，一张是 3-d，另一张是 2-d。在 3-d 表中只有 1 或 0，而另一个包含整数。

2-d 表是像 3-d 一样生成的，所以我必须将它们交错。我想要 OR 整个列的原因是查看其中是否有任何 1，如果是，则同一列将在二维表中包含 1。

例子：

3维表：

```
[1][i][j]
1000010000000000...
1000000001000000...
1000000000010000...
1000000000000001...

[2][i][j]
1000100000000000...
1000001000000000...
1000000001000000... 
```

2-d 表：（在对 3-d 表的每一列进行 OR 运算后，最左边的索引对应于 2-d 表中的一行）：

```
1000010001100001...
100010100000000... 
```

不确定这是否都清楚......但感谢任何帮助的人！:D

我不会解释我使用的方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T17:56:08.530

您如何表示这些数据？如果那是列表列表，则交换 3D 数组的最后两个索引，因此“列”可以作为顺序列表访问，并使用`any`. 这与普通 CPython 中的速度差不多：循环将在 C 运行时中完全执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T18:25:38.707

使用`numpy`：

```
>>> from numpy import array
>>> m = array([[0,0,0],[0,0,0],[1,0,1],[0,0,1],[0,0,1]])
>>> m
array([[0, 0, 0],
       [0, 0, 0],
       [1, 0, 1],
       [0, 0, 1],
       [0, 0, 1]])
>>> m.any(0)*1
array([1, 0, 1])
>>> len('.any(0)*1')
9 
```

或者，不那么简洁：

```
>>> m.any(axis=0)
array([ True, False,  True], dtype=bool)
>>> m.any(axis=0)*1 # make them ints
array([1, 0, 1]) 
```

如果您必须使用纯 Python，我实际上会按照@rkhayrov 的建议进行操作，并且如有必要，请继续转置和索引混洗，以使引用列就像引用列表一样容易。`m[:, 0]`但是写作的能力`m[2:5, :]`对我来说太得心应手了，不能轻易放弃。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T17:55:29.140

像这样的事情应该这样做。reduce 不受欢迎，map 和 filter 也是如此。

```
col = 2
value = 0
for row in range(height):
    value |= matrix[row][col] 
```

对于 python 2.x，使用 xrange 而不是 range。

# php - 如何比较旧的 GET 变量和新的 GET 变量？

> ID：12164735
> 
> 赞同：1
> 
> 时间：2012-08-28T17:48:31.750
> 
> 标签：php, web-applications

我正在开发一个 PHP 应用程序，用户可以在其中根据 4 个不同的类别过滤搜索结果。切换类别会影响**GET**变量`page_type`。

在我的情况下，每个类别的字段在导航页面时需要保持不变（*它们存储在会话变量中*），但是如果`page_type`发生更改，则需要取消设置会话变量，以便用户不需要花时间删除最后一个类别的所有旧数据。

有人可以帮我找出一种方法来比较旧的**GET**变量和新的变量吗？如果这是不可能的，那么有没有一种有效的方法来实现我想要做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:00:13.893

也保留`page_type`在会话中，并在每一页上检查它。如果不同，请取消设置会话并执行您需要的任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:06:18.433

您必须通过页面导航链接中搜索所需的所有信息（该类别的所有“字段”）。如果您将数据存储在您正在执行的会话中，则“返回”按钮将无法正常工作。（回击将返回页面，但存储在会话变量中的字段会发生变化）。

或者-您可以使用键控数组将字段存储在会话中，这样会话变量将根据 field_type 单独存储

```
$_SESSION['search_fields'][$_GET['page_type']] = $fields_array 
```

同样，您不应该为此使用 $_SESSIONS，因为您正在消耗服务器资源，为通过 google（或其他外部链接）点击页面的用户创建会话，并且永远不会去其他任何地方。此外，一个好的搜索引擎应该在第一页上给用户他们想要的东西:-)

# iphone - 尽快在两台 iOS 设备之间发送数据

> ID：12164736
> 
> 赞同：2
> 
> 时间：2012-08-28T17:48:33.343
> 
> 标签：iphone, ios, ipad, bluetooth, wifi

这是一个“方法”问题，而不是代码。

我希望尽快将数据从一台设备（比如 iPhone）发送到另一台设备（可能是 iPad）。例如，我希望在 iphone 上按下一个按钮以在 ipad 上触发和操作，尽可能接近即时。（当时两台设备都将运行我的应用程序。）

我知道我可以将数据发送到云端然后检索它，但我正在寻找更快的东西......是否可以通过本地 wifi 网络或蓝牙来做到这一点，或者还有其他选择吗？

# git - GitPython 从远程分支创建本地分支

> ID：12164737
> 
> 赞同：2
> 
> 时间：2012-08-28T17:48:43.107
> 
> 标签：git, branch, local, gitpython

我有多台实验室机器，我需要在本地实验室机器上复制我的远程分支。我相信为此的 git bash 命令是：

git checkout -b mybranch origin/mybranch

我如何在 GitPython 中做同样的事情？

我可能会进行更改并将更改推送回 origin/mybranch，然后将更改拉回其他实验室机器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:22:44.453

从[他们的文档](http://packages.python.org/GitPython/0.3.1/tutorial.html#using-git-directly)快速浏览，看起来你应该能够做到`git.checkout('origin/mybranch', b='mybranch')`。不过，我对 GitPython 不是很熟悉，所以请谨慎对待。

# c# - WebDriver 套件的顺序执行 - C# // Selenium Grid - All Local

> ID：12164738
> 
> 赞同：0
> 
> 时间：2012-08-28T17:48:58.473
> 
> 标签：c#, .net, selenium-webdriver, selenium-grid

一段时间以来，我一直在努力寻找解决这个问题的好方法，但还没有想出一个强有力的解决方案。我使用 WebDriver 和 C# 创建了一个测试套件来针对我们的站点运行我们的测试套件。我唯一剩下的问题是我想找到一种方法让整个套件在 FireFox、Chrome 和 IE 中执行。所以基本上，我需要在 FireFox 中完成测试，然后在 Chrome 中完成，最后在 IE 中完成。

我已经研究了 Selenium Grid，目前正在解决它的启动和运行问题，但由于我们没有任何虚拟机可供使用，因此我需要在本地运行它。因此，如果这个问题的一部分是不可能的，或者不是一个好的解决方案，是否有人能够指导我如何设置 Selenium 网格以在我本地的这 3 个主要浏览器中运行？我找到的所有文档都需要虚拟机设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T12:06:10.143

I have just used NUnit's parameterised test's.

I created an Enum:

```
/// <summary>
/// Enum that holds references to different browsers used in testing.
/// </summary>
public enum BrowserTypeEnum
{
    /// <summary>
    /// Google Chrome.
    /// </summary>
    Chrome, 

    /// <summary>
    /// Mozilla Firefox.
    /// </summary>
    Firefox, 

    /// <summary>
    /// Internet Explorer.
    /// </summary>
    InternetExplorer
} 
```

Called it in the TestFixture like so:

```
/// <summary>
/// Tests related to browsing Google
/// </summary>
[TestFixture(BrowserTypeEnum.Chrome)]
[TestFixture(BrowserTypeEnum.Firefox)]
public class GoogleTests : AbstractTestFixture
{
} 
```

In AbstractTestFixture:

```
 /// <summary>
    /// Create's the browser used for this test fixture. 
    /// <para>
    /// Must always be called as part of the test fixture set up, not the base test fixtures.
    /// </para>
    /// <para>
    /// It is the actual test fixture's responsibility to launch the browser.
    /// </para>
    /// </summary>
    protected override void CreateBrowser()
    {
        switch (BrowserType)
        {
            case BrowserTypeEnum.Chrome:
                Browser = new ChromeDriver();
                break;
            case BrowserTypeEnum.Firefox:
                Browser = new FirefoxDriver();
                break;
            case BrowserTypeEnum.InternetExplorer:
                Browser = new IEDriver();
                break;
            default:
                break;
        }
    } 
```

May not be the best solution, but I found it pretty readable. The alternative is using something like Selenium Grid, or maybe passing the type of driver into NUnit and create it directly, like so:

```
/// <summary>
/// Tests related to browsing Google
/// </summary>
[TestFixture(typeof(FirefoxDriver))]
public class GoogleTests : AbstractTestFixture
{
} 
```

Another alternative is if you use a CI Server solution, create a configuration setting to indicate which browser to use for the test. Have the CI Driver repeat the tests three times, editing that configuration setting each time.

# ruby - 如何在 Ruby 中做 HTTPS 管道？

> ID：12164744
> 
> 赞同：0
> 
> 时间：2012-08-28T17:49:35.647
> 
> 标签：ruby, http, https, pipeline

我正在使用 net-http-pipeline gem 为我的项目做 HTTP 管道，一切都很好。但是现在其中一个 API 提供者更改为 HTTPS，一切都崩溃了。有没有办法在 Ruby 中做 HTTPS 管道？

# api - Shopify 中美国各州的缩写形式

> ID：12164746
> 
> 赞同：0
> 
> 时间：2012-08-28T17:49:51.750
> 
> 标签：api, shopify

在结帐期间，美国各州目前在 Shopify 中一经选择就会被拼写出来。

选择缩写形式后是否可以显示？
我们希望能够以缩写形式导出此信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T12:59:34.710

结帐文本不可编辑。

如果您真的很想在导出的数据中使用缩写版本，您可以进行一些后期处理以查找长名称的实例并将它们替换为缩写。

# javascript - 检查输入值长度

> ID：12164751
> 
> 赞同：27
> 
> 时间：2012-08-28T17:50:04.107
> 
> 标签：javascript, validation, input

我在输入检查时遇到问题。如果输入长度小于 3，我不想发送请求。

我的表格：

```
<form method='post' action=''>
    Albūma nosaukums: # # this is the input --><input id='titleeee' type='text' name'album_title' /><br />

    Bilde Nr 1: <input type='file' name='pic_nr1' /><br />
    Bilde Nr 2: <input type='file' name='pic_nr2' /><br />
    Bilde Nr 3: <input type='file' name='pic_nr2' /><br />

    Aktīvs*: 
    <select>
        <option>Jā</option>
        <option>Nē</option>
    </select>

    <br />

    <input Onclick='testlenght(document.getElementById("titleeee"), "Tavs albūma nosaukums ir pa īsu!", "3")' type='submit' value='Pievienot' />
</form> 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-08-28T17:52:06.170

您可以添加一个表单提交处理程序，例如：

```
<form onsubmit="return validate();">

</form>

<script>function validate() {
 // check if input is bigger than 3
 var value = document.getElementById('titleeee').value;
 if (value.length < 3) {
   return false; // keep form from submitting
 }

 // else form is good let it submit, of course you will 
 // probably want to alert the user WHAT went wrong.

 return true;
}</script> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-08-17T05:50:24.190

`<input type='text' minlength=3 /><br />`

如果浏览器支持html5，

它将自动验证标签中的属性（最小长度）

但 Safari（iOS）不工作

# string - Matlab：将数字数组转换为字符串数组

> ID：12164752
> 
> 赞同：28
> 
> 时间：2012-08-28T17:50:20.287
> 
> 标签：string, matlab, numbers, type-conversion

如何转换`[12 25 34 466 55]`为字符串数组`['12' '25' '34' '466' '55']`？我知道的转换函数将该数组转换为一个代表整个数组的字符串。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-28T17:59:05.857

字符串数组必须是元胞数组。那说：

```
s = [12 25 34 466 55]
strtrim(cellstr(num2str(s'))') 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-28T18:16:12.427

`arrayfun`一起使用会`num2str`起作用：

```
>> A = [12 25 34 466 55]
A =
   12    25    34   466    55

>> arrayfun(@num2str, A, 'UniformOutput', false)
ans = 
    '12'    '25'    '34'    '466'    '55' 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-11-05T23:05:28.057

现在在 MATLAB 2016b 之后，您可以简单地使用

```
s = [12 25 34 466 55]; 
string(s) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T17:59:16.483

在 MATLAB 中， ['12' '25' '34' '466' '55'] 与包含这些数字的单个字符串相同。也就是说：

```
['12' '25' '34' '466' '55']

ans =

12253446655 
```

对于您要完成的工作，我需要更多上下文，但假设您仍然希望能够以字符串的形式访问每个单独的数字，那么单元格数组可能是您可以采用的最佳方法：

```
A = [1 2 3]
num2cell(num2str(A)) 
```

（当然，您仍然必须从 ans 中删除杂散空间）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-21T12:56:51.220

从 R2016b 开始，还有 compose 功能：

```
>> A = [12 25 34 466 55]

A =

    12    25    34   466    55

>> compose("%d", A)

ans = 

  1×5 string array

    "12"    "25"    "34"    "466"    "55"''' 
```

# css - 垂直居中文本

> ID：12164757
> 
> 赞同：5
> 
> 时间：2012-08-28T17:50:51.027
> 
> 标签：css, vertical-alignment

如何将一些简单的文本垂直居中正常`<div>`？我有这样的标记：

```
<div style="height:200px;">
   <span style="display:inline; vertical-align:middle;">ABOUT</span>
<div> 
```

它不适用于 Firefox 或 Internet Explorer。为什么不？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-28T17:51:57.220

[不是`vertical-align`这样。](http://css-tricks.com/what-is-vertical-align/)你可能想要`line-height`：

```
<div>
    <span style="line-height: 200px;">ABOUT</span>
</div> 
```

[这是一个演示。](http://jsfiddle.net/minitech/GMmSJ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:11:03.040

我发现使用间距元素是最可靠的方法，可以让您知道（图像、文本）高度的任何元素居中。这将使元素在任何高度的容器中居中。

***CSS：***

```
#outer {
    background: grey;
    height: 200px; /* any height */
}

#outer > div {
    height: 50%;
    margin-bottom: -6px;
}

#outer span {
    font-size: 12px;
} 
```

***HTML：***

```
<div id="outer">
    <div></div>
    <span>Example</span>
</div> 
```

# android - Android USB 模式无需 USB 数据线

> ID：12164761
> 
> 赞同：0
> 
> 时间：2012-08-28T17:51:02.420
> 
> 标签：android, usb

众所周知，当我们使用USB线将Android手机连接到PC时，我们可以选择“USB连接类型”。我的问题是：

1.  我可以在没有 USB 电缆的情况下启用“USB 连接类型”选择 UI 吗？比如在我的程序中。

2.  当手机通过 USB 数据线连接到电脑时，Android OS 会做什么？例如，加载任何驱动程序。

希望有人能给我一些建议。非常感谢。

# javascript - 将字符串值转换为对象属性名称

> ID：12164764
> 
> 赞同：26
> 
> 时间：2012-08-28T17:51:08.843
> 
> 标签：javascript

> **可能重复：**
> [如何在 javascript 中将字符串转换为对象的字段名称](https://stackoverflow.com/questions/4841254/how-to-convert-string-as-objects-field-name-in-javascript)

我可以做这个：

```
var objPosition = {};
objPosition.title = "whatever"; 
```

但是我正在动态地获取“标题”，并且想要使用大约六个这样获得的字符串来将六个属性分配给对象。我试过 eval 和其他几个似乎有同样问题的方案，但到目前为止都是空的。

我有：

```
var txtCol = $(this).text();
txtCol = $.trim(txtCol); 
```

我希望 txtCol 的值是一个属性名称。

有任何想法吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-08-28T17:53:20.967

使用`['propname']`：

```
objPosition[txtCol] = "whatever"; 
```

演示：http: [//jsfiddle.net/hr7XW/](http://jsfiddle.net/hr7XW/)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-28T17:53:36.833

使用[括号表示法](https://stackoverflow.com/questions/4968406/javascript-property-access-dot-notation-vs-brackets)：`objPosition['title'] = "whatever";`

所以：

```
var objPosition = {}, ttl = 'title';
objPosition[ttl] = 'whatever'; 
```

[编辑 11/2019：es20xx]

```
let objPosition = {};
const ttl = 'title';
// [...]
objPosition = {...objPosition, [ttl]: "whatever"};
console.log(objPosition);
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-28T17:53:36.363

你也可以像这样设置对象的键

```
var property = "title"
objPosition[property] = "something"; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-28T17:54:00.920

像这样使用括号表示法：

```
objPosition["title"] = "Whatever"; 
```

# jquery - 这个移动的火箭使用 CSS3（动画）吗？

> ID：12164766
> 
> 赞同：0
> 
> 时间：2012-08-28T17:51:16.897
> 
> 标签：jquery, html, css

你认为[这个火箭](http://demo.drythemes.com/thebigbang/)使用 CSS3（动画）吗？或者，jQuery？我试图理解网页设计师编写的 CSS，但我找不到任何样式来让火箭移动。

怎么做这样的动画？如果您有，请分享您的想法和教程。我想学这种动画。谢谢！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:01:03.050

当然不：

让我告诉你为什么，以便你下次自己弄清楚。

在 Google Chrome 中，使用火箭上方的“右键单击”->“检查元素”操作。Chrome 应该会自动选择火箭，你可以看到这样的内联内容：

`<img class="floating-rocket" src="images/rocket.png" alt="Launching" style="margin-top: -90.86px; margin-left: -510.43px; ">`

这部分：`style="margin-top: -90.86px; margin-left: -510.43px; "`动态变化，来回移动火箭。这种行为不能用 CSS 完成。您还可以通过注意受影响的标签是一个`img`标签并且没有 CSS 动画属性来仔细检查这一点。

内联样式更改是非常典型的 Javascript。事实上，如果您查看附加到页面的 Javascript 文件，您会发现：

[http://demo.drythemes.com/thebigbang/js/custom/customUI.js](http://demo.drythemes.com/thebigbang/js/custom/customUI.js)

其中包含移动火箭的实际 javascript。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T17:59:52.107

It does use Javascript animation.

Use the Chrome Dev Tools to figure it out. In Chrome, right-click on the rocket and click "Inspect element".

I recommend you to use CSS animations for this, not like this website.

Here is a a example on how to do it:

```
@-webkit-keyframes rocket {
   from {
    margin-left: -510px;
    margin-top: -90px;
   }
   to {
    margin-left: -500px;
    margin-top: -100px
   }
}
.rocket {
 -webkit-animation: rocket 1s alternate infinite linear;
} 
```

Of course, don't forget to prefix :D I think this solution is better because CSS > Javascript and if you want scale or rotation, you can add that easily!

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-28T17:55:10.777

[http://demo.drythemes.com/thebigbang/js/custom/customUI.js](http://demo.drythemes.com/thebigbang/js/custom/customUI.js)

有火箭动画：

```
$('.floating-rocket').everyTime(10, function () {
            $(".floating-rocket").animate({
                marginTop: "+=10",
                marginLeft: "+=5"
            }, 1000, 'linear').animate({
                marginTop: "-=10",
                marginLeft: "-=5"
            }, 1000, 'linear');
    }); 
```

# c# - 修改语法树，然后得到更新的语义模型

> ID：12164769
> 
> 赞同：9
> 
> 时间：2012-08-28T17:51:20.813
> 
> 标签：c#, roslyn

我正在尝试修改语法树，然后更新语义模型。这是我到目前为止所拥有的：

```
var tree = Roslyn.Compilers.CSharp.SyntaxTree.ParseCompilationUnit(code);
var compilation = Roslyn.Compilers.CSharp.Compilation.Create(
                        "MyCompilation",
                        syntaxTrees: new[] { tree },
                        references: new[] { mscorlib });
var semanticModel = compilation.GetSemanticModel(tree);
...
var oldStatementNode = (parent as ExpressionStatementSyntax); //some SyntaxNode in the tree
var oldExpressionNode = oldStatementNode.Expression;
var newExpressionNode = Syntax.ParenthesizedExpression(oldExpressionNode);
var newRootNode = tree.GetRoot().ReplaceNode(oldExpressionNode, newExpressionNode);

var semanticInfo = semanticModel.GetTypeInfo(newExpressionNode); //throws exception "Syntax node is not within syntax tree" 
```

如果我在调用之前尝试调用`semanticModel = compilation.GetSemanticModel(tree);`甚至进行新的编译- 相同的异常。`tree``GetTypeInfo()`

那么我该如何更新`SemanticModel`呢？（当然我可以得到修改后的源代码并从头开始做所有事情，但我想有更有效的方法）。

我敢肯定，我在这里遗漏了一些明显的东西，也许在某处创建了一个新的语法树？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-28T23:05:41.913

Roslyn 类型是不可变的，所以你需要为`SyntaxTree`你的 构造一个 new `newRootNode`，然后调用`compilation.UpdateSyntaxTree`来获取一个 new `Compilation`，然后你可以调用`newCompilation.GetSemanticModel(newTree)`来获取一个 new `SemanticModel`。

考虑升级到服务级别并改用 ISolution。就像是：

```
var doc = Solution.Create(SolutionId.CreateNewId()).AddCSharpProject("MyCompilation", "MyCompilation").AddMetadataReference(mscorlib).AddDocument("MyFile", code);

var semanticModel = (SemanticModel)doc.GetSemanticModel();
var root = (CompilationUnitSyntax)doc.GetSyntaxRoot();

SyntaxNode parent = null;
var oldStatementNode = (parent as ExpressionStatementSyntax); //some SyntaxNode in the tree
var oldExpressionNode = oldStatementNode.Expression;
var newExpressionNode = Syntax.ParenthesizedExpression(oldExpressionNode);
var newRootNode = root.ReplaceNode(oldExpressionNode, newExpressionNode);

doc = doc.UpdateSyntaxRoot(newRootNode);
semanticModel = (SemanticModel)doc.GetSemanticModel(); 
```

# google-chrome - 字母“M”比其他文本的其余部分更粗

> ID：12164770
> 
> 赞同：0
> 
> 时间：2012-08-28T17:51:27.097
> 
> 标签：google-chrome, fonts, windows-xp, font-face

不确定是什么原因造成的。

我在家里的 W7 电脑上用 Chrome、FF 和 IE 对此进行了测试，没有任何问题。我也在我的Droid上查了一下，还是没有问题。

我在 XP 机器上工作，这就是它在 Chrome 中的显示方式：

![在此处输入图像描述](../Images/e3d7e19430ad4b291dced8b46cc8dfcd.png)

它在我的 FF 和 IE 中的 XP 机器上显示良好。

有什么线索吗？

编辑：页面应要求：[www.terrencebowman.com](http://www.terrencebowman.com)（显然仍在开发中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T19:40:17.237

铬 21，Windows XP：

![在此处输入图像描述](../Images/24d4d9f2ce9801d71a987a2f8c266fa1.png)

对我来说似乎很好。

编辑：这是一个抗锯齿“问题”。使用标准抗锯齿（Cleartype 关闭）时，页面看起来与屏幕截图中的相同（Chrome 和 IE6、IE7、IE8）。IE9 和 IE10 浏览器完全忽略系统范围的抗锯齿设置并强制启用 cleartype，因此这就是您在计算机上看不到损坏文本的原因。

1.  你可以简单地忽略这个问题，或者......
2.  您可以尝试使用较小的字体 (font-size: 17px) 而不是 18px
    *font-size: 17px with cleartype off：* ![在此处输入图像描述](../Images/50805225d4397d6bbd13ba5d94af3b01.png)
3.  我找到了一种解决方法：只需`-webkit-transform: translateZ(0);`在您的 p 标签上使用。
    这会强制 Chrome 使用 GPU 呈现标签（包括文本、过渡）。
    PS：要小心，translateZ 有时有问题，不要在 Mac 上非必要时使用

# google-apps-script - 谷歌应用脚 本 urlfetch 访问已登录的网站

> ID：12164777
> 
> 赞同：0
> 
> 时间：2012-08-28T17:52:02.823
> 
> 标签：google-apps-script

我希望能够使用 urlfetch 将信息从网页提取到电子表格中。我需要从中提取信息的站点需要登录信息。一旦我在浏览器的一个选项卡中登录该站点，我为该站点打开的任何后续选项卡都将已登录，但是当我尝试使用 urlfetch 访问该站点时，我收到一条错误消息：

“设置 cookie 时出错。对象引用未设置为对象的实例。”

这是我用来尝试在标头中设置适当 cookie 的代码：

```
function webURL() {

  var response = UrlFetchApp.fetch("https://website.com");

  var cookie = response.getAllHeaders()['Set-Cookie']; 
  var header = {'Cookie':cookie};
  var opt3 = {"Headers":header};
  var pageData = UrlFetchApp.fetch(pageURL, opt3);

Browser.msgBox(pageData.getContentText());

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:08:54.887

请记住，您的 Google Apps 脚本代码是在 Google 的服务器上执行的，而不是在您的计算机/浏览器上。因此，UrlFetch 请求是从 Google 的服务器发出的。

如果您知道网站使用哪种类型的身份验证（HTTP Basic/oauth 等），那么您也许可以让您的脚本执行身份验证。

# reverse-engineering - 为了构建服务器模拟器，我将从哪里开始对服务器连接进行逆向工程？

> ID：12164779
> 
> 赞同：1
> 
> 时间：2012-08-28T17:52:12.130
> 
> 标签：reverse-engineering, server-side, packet-capture

我是一名长期的游戏开发人员，我一直在考虑为一款流行游戏编写服务器模拟器。到目前为止，我的假设是，当多人游戏处于活动状态时，客户端相互交谈并绕过服务器，所以我所要做的就是进行匹配和启动客户端相互连接。目标不是规避任何类型的安全身份验证，而是简单地为一个不稳定的服务器系统实现一个更好的解决方案。此外，现有系统没有任何级别的作弊保护，网络社区用不了多久就会被彻底摧毁。如果这样做有任何法律问题，我不会在官方服务器关闭之前发布我的任何作品。

我将从哪里开始？我假设我必须能够记录和跟踪发送和接收的数据包。有什么软件可以解决这个问题？

欢迎任何其他提示或建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T17:54:17.627

当涉及到数据包捕获时，权威机构是[Wireshark](http://www.wireshark.org/) - 以前称为 Ethereal。它将允许您捕获、过滤和检查数据包，但您可以扩展 wireshark 并教它识别新协议 - 让您更轻松地检查和理解游戏包。

Wireshark 还可以打开包含由许多其他流行软件捕获的数据包的文件，例如*NIX 系统上的[tcpdump](http://www.tcpdump.org/)。

我建议您下载 wireshark 并快速浏览该站点，然后运行它并开始捕获。使用一个使用你知道和理解的（最好是简单的）协议（IRC、FTP、HTTP、SMTP）的程序，看看它做了什么。一旦您了解了有关 Wireshark 的基础知识，就可以启动您想要的应用程序到逆向工程并开始工作！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T17:54:45.443

[Wireshark](http://www.wireshark.org/)是一个跟踪发送和接收数据包的工具。

# html5-canvas - HTML5 Canvas 笔划没有抗锯齿

> ID：12164780
> 
> 赞同：5
> 
> 时间：2012-08-28T17:52:20.290
> 
> 标签：html5-canvas, antialiasing, stroke

我只是想在画布上用厚实的抗锯齿笔画制作一个圆圈。

圆圈按预期绘制，但笔划的边缘非常锯齿。我一直在阅读 Chrome 强制抗锯齿，所以不知道该怎么做......

小提琴：http: [//jsfiddle.net/nipponese/hWsxw/](http://jsfiddle.net/nipponese/hWsxw/)

**HTML**

```
<div id="main">
    <canvas id="myCanvas" width="400" height="400" style="border: 1px solid #000"></canvas>
        <div id="counter" style="height: 100px; width: 100px; border: 1px solid #000">
     </div>
</div> 
```

**JS + jQuery**

```
<script>
    function calc(myVal) {
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        var radius = 70;

        ctx.beginPath();
        ctx.arc(140, 140, 20, myVal * Math.PI, 0, true);
        ctx.lineWidth = 14;
        ctx.stroke();
    };
    $(document).ready(function() {
        var count = 0;
        var parsedCount;
        function go(){  
            if (count <= 200) {
                parsedCount = count*.01
                $('#counter').html('<p>' + parsedCount + '</p>');
                calc(parsedCount);
                count++;
            }
        }
        setInterval(go, 10)
    });
</script> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-28T18:24:26.840

我的同事刚刚指出，我需要在每次绘制后使用 clearRect 来清除画布。笔画只是被画在彼此之上。

```
function calc(myVal) {
    var canvas = document.getElementById("myCanvas");
    var ctx = canvas.getContext("2d");
    var radius = 70;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    ctx.beginPath();
    ctx.arc(140, 140, 20, myVal * Math.PI, 0, true);
    ctx.lineWidth = 14;
    ctx.stroke();
}; 
```

# node.js - 计算水平服务器上的 socket.io 用户

> ID：12164783
> 
> 赞同：7
> 
> 时间：2012-08-28T17:52:28.437
> 
> 标签：node.js, redis, socket.io, scalability

我有多个使用 redisstore 水平扩展的 socket.io 服务器。我已经有效地设置了房间，并且能够成功地跨服务器广播到房间等。现在我正在尝试构建一个状态页面，而我未能弄清楚的是如何简单地计算连接的用户数量所有服务器。

io.sockets.clients('room') 和 io.sockets.sockets 只会告诉你那台服务器上连接的客户端数量，而不是所有连接到同一个 RedisStore 的服务器。

建议？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T17:58:09.623

当用户连接到聊天室时，您可以在 RedisStore 中自动增加用户计数器。当用户断开连接时，您会减小该值。通过这种方式，Redis 维护了用户数量并且可供所有服务器访问。

见[INCR](http://redis.io/commands/incr)和[DECR](http://redis.io/commands/decr)

```
SET userCount = "0" 
```

当用户连接时：

```
INCR userCount 
```

当用户断开连接时：

```
DECR userCount 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T12:52:39.287

这是我使用 Redis 脚本解决它的方法。它需要 2.6 或更高版本，因此现在很可能仍需要编译您自己的实例。

每次进程启动时，我都会生成一个新的 UUID 并将其保留在全局范围内。我可以使用 pid，但这感觉更安全一些。

```
# Pardon my coffeescript
processId = require('node-uuid').v4() 
```

当用户连接时（socket.io 连接事件），然后我将该用户的 id 推送到基于该 processId 的用户列表中。我还将该密钥的到期时间设置为 30 秒。

```
RedisClient.lpush "process:#{processId}", user._id
RedisClient.expire "process:#{processId}", 30 
```

当用户断开连接（断开连接事件）时，我将其删除并更新到期时间。

```
RedisClient.lrem "process:#{processId}", 1, user._id
RedisClient.expire "process:#{processId}", 30 
```

我还设置了一个以 30 秒间隔运行的函数，以基本上“ping”该键，使其保持在那里。因此，如果进程确实意外终止，所有这些用户会话将基本上消失。

```
setInterval ->
  RedisClient.expire "process:#{processId}", 30
, 30 * 1000 
```

现在来说说魔法。Redis 2.6 包含 LUA 脚本，它本质上提供了一种存储过程的功能。它真的很快而且不是非常密集的处理器（他们将其与“几乎”运行的 C 代码进行比较）。

我的存储过程基本上循环遍历所有进程列表，并创建一个 user:user_id 键及其当前登录总数。这意味着如果他们使用两个浏览器等登录，它仍然允许我使用逻辑来判断他们是完全断开连接，还是只是其中一个会话。

我在所有进程上每 15 秒运行一次这个函数，在连接/断开事件之后也是如此。这意味着我的用户计数很可能会精确到秒，并且不会超过 15 到 30 秒。

生成该 redis 函数的代码如下所示：

```
def = require("promised-io/promise").Deferred

reconcileSha = ->
  reconcileFunction = "
    local keys_to_remove = redis.call('KEYS', 'user:*')
    for i=1, #keys_to_remove do
      redis.call('DEL', keys_to_remove[i])
    end

    local processes = redis.call('KEYS', 'process:*')
    for i=1, #processes do
      local users_in_process = redis.call('LRANGE', processes[i], 0, -1)
      for j=1, #users_in_process do
        redis.call('INCR', 'user:' .. users_in_process[j])
      end
    end
  "

  dfd = new def()
  RedisClient.script 'load', reconcileFunction, (err, res) ->
    dfd.resolve(res)
  dfd.promise 
```

然后我可以稍后在我的脚本中使用它：

```
reconcileSha().then (sha) ->
  RedisClient.evalsha sha, 0, (err, res) ->
    # do stuff 
```

我做的最后一件事是尝试处理一些关闭事件，以确保进程尝试最好不要依赖 redis 超时并真正优雅地关闭。

```
gracefulShutdown = (callback) ->
  console.log "shutdown"
  reconcileSha().then (sha) ->
    RedisClient.del("process:#{processId}")
    RedisClient.evalsha sha, 0, (err, res) ->
      callback() if callback?

# For ctrl-c
process.once 'SIGINT', ->
  gracefulShutdown ->
    process.kill(process.pid, 'SIGINT')

# For nodemon
process.once 'SIGUSR2', ->
  gracefulShutdown ->
    process.kill(process.pid, 'SIGUSR2') 
```

到目前为止，它运行良好。

我仍然想做的一件事是让 redis 函数返回任何已更改其值的键。这样，如果特定用户的计数发生了变化，而没有任何服务器主动知道（例如进程死亡），我实际上可以发送一个事件。现在，我必须依靠再次轮询 user:* 值才能知道它已更改。它有效，但它可能会更好......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T15:58:44.053

我通过让每台服务器定期在 redis 中设置一个用户计数来解决这个问题，其中包含他们自己的 pid：

每做`setex userCount:<pid> <interval+10> <count>`

然后状态服务器可以查询每个键，然后获取每个键的值：

对于每个`keys userCount*`做总+=`get <key>`

因此，如果服务器崩溃或关闭，那么它的计数将在间隔+10 后从 redis 中退出

对丑陋的伪代码感到抱歉。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T21:28:49.043

您可以使用哈希键来存储值。

当用户连接到服务器 1 时，您可以在名为“userCounts”的键上设置一个名为“srv1”的字段。只需将值覆盖为当前使用[HSET](http://redis.io/commands/hset)的计数。无需增加/减少。只需设置 socket.io 已知的当前值。

```
HSET userCounts srv1 "5" 
```

当另一个用户连接到不同的服务器时，设置不同的字段。

```
HSET userCounts srv2 "10" 
```

然后任何服务器都可以通过返回“userCounts”中的所有字段并使用[HVALS](http://redis.io/commands/hvals)将它们相加以返回值列表来获得总数。

```
HVALS userCounts 
```

当服务器崩溃时，您需要运行一个脚本来响应崩溃，将该服务器的字段从 userCounts 或 HSET 中删除为“0”。

您可以查看[Forever](https://github.com/nodejitsu/forever)以自动重新启动服务器。

# android - 两个按钮与背景图像并排

> ID：12164784
> 
> 赞同：0
> 
> 时间：2012-08-28T17:52:34.723
> 
> 标签：android

我希望有两个并排的大按钮。它们应该占据整个屏幕（即每个宽度的一半）。我希望按钮的背景包含一个图像（将从比按钮大得多的源图像按比例缩小）。我希望按钮的高度由图像的纵横比决定。最好全部在 xml 中完成。可以做到吗？

我尝试了以下操作，却发现按钮看起来是方形的，即使图像比它们高得多（并且两个图像具有相同的尺寸）。

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <Button
        android:id="@+id/rep_button"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.1"
        android:background="@drawable/repeating"
        android:text="" />

    <Button
        android:id="@+id/oneoff_button"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0.1"
        android:background="@drawable/oneoff"
        android:text="" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:13:01.877

我会使用`ImageView`, 并将 clickable 属性设置为 true。然后，您可以`Button`通过设置a 将其视为 a `onClickListener`，但它会处理图像的纵横比，而不像使用 a 那样添加灰色边框`ImageButton`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:14:40.620

尝试使用`ImageButton`我相信它们会根据正在显示的图像的大小进行缩放。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:49:34.003

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:id="@+id/LinearLayout02"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:layout_alignParentBottom="true" >

<Button
    android:id="@+id/Button01"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:background="@drawable/retro_blue_background"
    android:text="Übernehmen" >

</Button>

<Button
    android:id="@+id/Button02"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:background="@drawable/retro_blue_background"
    android:text="Abbrechen" >

</Button>

</LinearLayout> 
```

![那是你要的吗？](../Images/8552c75b600455e8e46a19c0d8bf05e3.png)

# jboss7.x - 在不手动编辑standalone.xml 的情况下配置 JBoss 7

> ID：12164787
> 
> 赞同：3
> 
> 时间：2012-08-28T17:52:50.513
> 
> 标签：jboss7.x

What are the appropriate options for configuring JBoss 7 without manually editing the standalone.xml (or the domain.xml).

我们有一个相当复杂的配置（JavaMail、许多数据源等），编辑 XML 不是一个好的选择，因为重写时注释会丢失，而且通常很难部署更改。

我看到的一个选项是命令行界面，至少您可以在其中编写脚本，但它似乎会使更改它与创建它不同。还有什么好的选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T19:19:36.743

对于批量配置更改，CLI 脚本可能是您最好的选择。

另一种选择是创建自己的程序来执行此操作。您可以使用本机 Java API，另请参阅模型[参考的](https://docs.jboss.org/author/display/AS71/The+native+management+API)[detyped API](https://docs.jboss.org/author/display/AS71/Detyped+management+and+the+jboss-dmr+library)。这将使您可以选择在添加或更改之前检查资源和/或资源值。

```
final ModelNode op = new ModelNode();
op.get(ClientConstants.OP).set("read-resource");
op.get(ClientConstants.OP_ADDR).set("/subsystem=logging/console-handler=CONSOLE");
final ModelControllerClient client = ModelControllerClient.Factory.create("localhost", 9999);
final ModelNode result = client.execute(op);
if (result.get(ClientConstants.OUTCOME).asString().equals(ClientConstants.SUCCESS)) {
    // The operation was successful
} else {
    // Unsuccessful get the failure description
    final String msg;
    if (result.hasDefined(ClientConstants.FAILURE_DESCRIPTION)) {
        if (result.hasDefined(ClientConstants.OP)) {
            msg = String.format("Operation '%s' at address '%s' failed: %s", result.get(ClientConstants.OP), result.get(ClientConstants.OP_ADDR), result.get(ClientConstants.FAILURE_DESCRIPTION));
        } else {
            msg = String.format("Operation failed: %s", result.get(ClientConstants.FAILURE_DESCRIPTION));
        }
    } else {
        msg = String.format("An unexpected response was found. Result: %s", result);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T06:02:54.863

为什么不使用 Web 管理控制台？Standalone.xml 中包含的大多数属性都可以使用 UI 进行配置。

# javascript - 如何将 WinJS ListView 绑定到 Web 服务？

> ID：12164788
> 
> 赞同：0
> 
> 时间：2012-08-28T17:52:51.417
> 
> 标签：javascript, windows-8, winjs

我想连接到 Web 服务并在 WinJS ListView 中显示结果。Web 服务返回 JSON。到目前为止，我有这个标记：

```
 <div id="mediumListIconTextTemplate" data-win-control="WinJS.Binding.Template">
            <div>
                <h4 data-win-bind="innerText: title"></h4>
            </div>
    </div>

    <div id="basicListView" data-win-control="WinJS.UI.ListView"
        data-win-options="{itemDataSource : DataExample.itemList.dataSource, 
        itemTemplate: select('#mediumListIconTextTemplate')}">
    </div> 
```

这是我认为我需要在 JS 中做的事情：

*   用于`WinJS.xhr`从 Web 服务获取 JSON 数据。
*   从返回的 JSON 创建一个数据元素数组
*   用于`WinJS.Binding.List`从数组创建列表

我错过了什么？我在哪里打电话`WinJS.Binding.processAll(my_listview, data_list)`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:28:26.407

你不需要打电话`WinJS.Binding.processAll(my_listview, data_list).`

我将假设您使用的是单页导航模型，因此在页面的就绪事件处理程序中，您将执行以下操作：

```
var page = WinJS.UI.Pages.define("/pages/home.html", {
        ready: function (element, options) {

            WinJS.xhr({url:'http://someservice.com'}).then(
                function(response) { 
                    var json = JSON.parse(response.responseText);
                    var list = new WinJS.Binding.List(json.results); // or whatever array you are binding too 
                    DataExample.itemList = list; // or however you want to get the list into DataExample.itemList
                },
                function(error) {
                    //handle error 
                }
            );
        } 
```

而已。default.js 将处理整个页面的 processAll()，只需让 WinJS 魔法为您完成工作。

[您可以在http://slickthought.net/post/2012/08/20/Windows-8-and-HTML-Part-6-Displaying-Data-with-WinJS-ListView.aspx](http://slickthought.net/post/2012/08/20/Windows-8-and-HTML-Part-6-Displaying-Data-with-WinJS-ListView.aspx)找到一个简单的示例。您也可以按照此处的 ListView 快速入门[http://msdn.microsoft.com/en-us/library/windows/apps/hh465496.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465496.aspx)

如果您不使用单页模型，那么在 default.js 上的激活处理程序中，您只需在返回的承诺中添加上面的代码即可执行`WinJS.UI.processAll()`

# ruby-on-rails - 使用关联条件时列名不明确

> ID：12164792
> 
> 赞同：0
> 
> 时间：2012-08-28T17:53:03.320
> 
> 标签：ruby-on-rails

我遇到了一些问题，当使用第 3 方的应用程序的数据库时，我必须做一些奇怪的连接，我经常加入到一种用于多种不同类型对象的包罗万象的表中。因此，我创建了具有条件子句的 has_many 或 has_one 关联。问题是如果我尝试在同一个查询中加入其中两个关联，我会得到一个“不明确的列名”，这是正确的，因为在两个关联的条件中调用了相同的列。

有没有办法解决这个问题。如果我可以告诉关联总是以连接名称为前缀，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:07:10.563

在条件子句中，您可以断言您的表名存在如下：

```
has_many :x_models, :conditions => {attribute: some_value}
has_many :y_models, :conditions => {attribute: some_value} 
```

已编辑

也许这就是你想要的。

# java - 如何在java中对多个数组进行排序

> ID：12164795
> 
> 赞同：23
> 
> 时间：2012-08-28T17:53:24.330
> 
> 标签：java, arrays, sorting

我正在尝试按字典顺序对三个数组进行排序。这些数组通过一个公共数组相互关联。如果我演示一下，就更容易解释：

```
int[] record = new int[4];
String [] colors = {"blue", "yellow", "red", "black"};
String [] clothes = {"shoes", "pants", "boots", "coat"}; 
```

在控制台上打印时，我希望将它们放在类似于下面的三列中：

## 未分类：

```
Record  Color   Clothes
0       blue    shoes
1       yellow  pants
2       red     boots
3       black   coat 
```

## 按颜色排序：

```
Record  Color   Clothes
3       black   coat
0       blue    shoes
2       red     boots
1       yellow  pants 
```

## 按服装分类：

```
Record  Color   Clothes
2       red     boots
3       black   coat
1       yellow  pants
0       blue    shoes 
```

我找到了与我的场景类似的先前答案，但它比较的是整数而不是字符串，并且我在使用该`compareTo()`方法时遇到了麻烦，`Arrays.sort()`无法达到我想要的输出。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-07-11T01:12:17.937

在某些情况下，创建一个新类只是为了进行排序没有多大意义。

这里，是一个函数，可用于`List<?>`根据键列表 ( `List<T implements Comparable>`) 对任意数量的任意类型列表 ( ) 进行排序。 [**Ideone 示例在这里**](https://ideone.com/cXdw6T)。

* * *

## 用法

以下是如何使用该函数对任意类型的多个列表进行排序的示例：

```
List<Integer> ids = Arrays.asList(0, 1, 2, 3);
List<String> colors = Arrays.asList("blue", "yellow", "red", "black");
List<String> clothes = Arrays.asList("shoes", "pants", "boots", "coat");

// Sort By ID
concurrentSort(ids, ids, colors, clothes);

// Sort By Color
concurrentSort(colors, ids, colors, clothes);

// Sort By Clothes
concurrentSort(clothes, ids, colors, clothes); 
```

**输出：**

```
// Sorted By ID:
ID:      [0, 1, 2, 3]
Colors:  [blue, yellow, red, black]
Clothes: [shoes, pants, boots, coat]

// Sorted By Color:
ID:      [3, 0, 2, 1]
Colors:  [black, blue, red, yellow]
Clothes: [coat, shoes, boots, pants]

// Sorted By Clothes:
ID:      [2, 3, 1, 0]
Colors:  [red, black, yellow, blue]
Clothes: [boots, coat, pants, shoes] 
```

* * *

## 代码

可以在[**此处**](https://ideone.com/cXdw6T)找到一个 Ideone 示例，其中包括参数验证和测试用例。

```
public static <T extends Comparable<T>> void concurrentSort(
                                        final List<T> key, List<?>... lists){
    // Create a List of indices
    List<Integer> indices = new ArrayList<Integer>();
    for(int i = 0; i < key.size(); i++)
        indices.add(i);

    // Sort the indices list based on the key
    Collections.sort(indices, new Comparator<Integer>(){
        @Override public int compare(Integer i, Integer j) {
            return key.get(i).compareTo(key.get(j));
        }
    });

    // Create a mapping that allows sorting of the List by N swaps.
    // Only swaps can be used since we do not know the type of the lists
    Map<Integer,Integer> swapMap = new HashMap<Integer, Integer>(indices.size());
    List<Integer> swapFrom = new ArrayList<Integer>(indices.size()),
                  swapTo   = new ArrayList<Integer>(indices.size());
    for(int i = 0; i < key.size(); i++){
        int k = indices.get(i);
        while(i != k && swapMap.containsKey(k))
            k = swapMap.get(k);

        swapFrom.add(i);
        swapTo.add(k);
        swapMap.put(i, k);
    }

    // use the swap order to sort each list by swapping elements
    for(List<?> list : lists)
        for(int i = 0; i < list.size(); i++)
            Collections.swap(list, swapFrom.get(i), swapTo.get(i));
} 
```

* * *

**注意：**运行时间是列表`O(mlog(m) + mN)`的`m`长度和列表`N`的数量。通常`m >> N`这样运行时间并不比只排序 key 更重要`O(mlog(m))`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-28T18:00:19.607

由于`Record`, `Color`and`Clothes`似乎属于一起，我建议将它们一起移动到自定义对象中，例如

```
public class ClothesItem {
    int record;
    String color;
    String clothes;
} 
```

然后你可以制作不同[`Comparator`](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)的 s 来做不同的排序变体。

如果您需要使用多个数组保留当前结构，[@Jherico 在这里有一个排序解决方案](https://stackoverflow.com/a/951910/1343161)，可以获取排序索引的数组，这应该可以轻松获得您想要的结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-29T16:17:07.533

好的，这就是它最终形式的样子。

```
// ColorClothes.java

import java.util.*;

public class ColorClothes
{
public int record;
public String color;
public String clothes;

public static void main(String[] args)
{
    Initialize();
}

public ColorClothes(int record, String color, String clothes)
{
    this.record = record;
    this.color = color;
    this.clothes = clothes;
}

public static void Initialize()
{
    List<ColorClothes> list = new ArrayList();
    list = CreateList();

    Sort(list, "Unsorted", 1);
    Sort(list, "\nSortedByColor", 2);
    Sort(list, "\nSortedByClothes", 3);
    Sort(list, "\nSortedByRecord", 4);
}

public static List<ColorClothes> CreateList()
{
    List<ColorClothes> list = new ArrayList();
    list.add(new ColorClothes(1, "blue  ", "shoes"));
    list.add(new ColorClothes(0, "yellow", "pants"));
    list.add(new ColorClothes(3, "red   ", "boots"));
    list.add(new ColorClothes(2, "black ", "coat"));

    return list;
}

public static void Print(List<ColorClothes> list)
{
    for (ColorClothes item : list)
    {
        System.out.println(item.record + "    " + item.color + "   " + item.clothes);
    }
}

public static void Sort(List<ColorClothes> list, String string, int choice)
{
    System.out.println(string + "\n");

    switch (choice)
    {
    case 1:
        break;
    case 2:
        Collections.sort(list, new ColorComparator());
        break;
    case 3:
        Collections.sort(list, new ClothesComparator());
        break;
    case 4:
        Collections.sort(list, new RecordComparator());
        break;
    }

    Print(list);
}

} // End class. 
```

* * *

```
// ColorComparator.java

import java.util.Comparator;

 class ColorComparator implements Comparator
 {
public int compare(Object str1, Object str2)
{
    String str1Color = ((ColorClothes)str1).color;
    String str2Color = ((ColorClothes)str2).color;

    return str1Color.compareTo(str2Color);

}
}// End class. 
```

* * *

```
// ClothesComparator.java

import java.util.Comparator;

class ClothesComparator implements Comparator
{
public int compare(Object str1, Object str2)
{
    String str1Clothes = ((ColorClothes)str1).clothes;
    String str2Clothes = ((ColorClothes)str2).clothes;

    return str1Clothes.compareTo(str2Clothes);

}
} // End class. 
```

* * *

```
// RecordComparator.java

import java.util.Comparator;

public class RecordComparator implements Comparator 
{
public int compare(Object rec1, Object rec2)
{
    int rec1Rec = ((ColorClothes)rec1).record;
    int rec2Rec = ((ColorClothes)rec2).record;

    if(rec1Rec > rec2Rec)
    {
        return 1;
    }
    else if(rec1Rec < rec2Rec)
    {
        return -1;
    }
    else
    {
        return 0;
    }
}
}// End class. 
```

**控制台输出**

```
Unsorted

1    blue     shoes
0    yellow   pants
3    red      boots
2    black    coat

SortedByColor

2    black    coat
1    blue     shoes
3    red      boots
0    yellow   pants

SortedByClothes

3    red      boots
2    black    coat
0    yellow   pants
1    blue     shoes

SortedByRecord

0    yellow   pants
1    blue     shoes
2    black    coat
3    red      boots 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T18:03:34.173

我不确定一次对多个数组进行排序；查看您使用的用例，这看起来像是一个竞争者，其中所有 3 个属性都可以组合成一个对象，然后可以以多种方式对对象数组进行排序。

你确定你需要3个数组吗？

`ColoredCloth`是否适合您的数组：

```
class ColoredCloth implements Comparable<ColoredCloth>{
    int id;
    String color;
    String cloth;
} 
```

并定义几个`Comparators`按`color`和排序`cloth`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-12T22:47:42.677

以下是我如何对两个或多个相同长度的字符串数组进行排序，以便第一个数组按顺序排列，而其他数组按该顺序排列：

```
public static void order(String[]... arrays)
{
    //Note: There aren't any checks that the arrays
    // are the same length, or even that there are
    // any arrays! So exceptions can be expected...
    final String[] first = arrays[0];

    // Create an array of indices, initially in order.
    Integer[] indices = ascendingIntegerArray(first.length);

    // Sort the indices in order of the first array's items.
    Arrays.sort(indices, new Comparator<Integer>()
        {
            public int compare(Integer i1, Integer i2)
            {
                return
                    first[i1].compareToIgnoreCase(
                    first[i2]);
            }
        });

    // Sort the input arrays in the order
    // specified by the indices array.
    for (int i = 0; i < indices.length; i++)
    {
        int thisIndex = indices[i];

        for (String[] arr : arrays)
        {
            swap(arr, i, thisIndex);
        }

        // Find the index which references the switched
        // position and update it with the new index.
        for (int j = i+1; j < indices.length; j++)
        {
            if (indices[j] == i)
            {
                indices[j] = thisIndex;
                break;
            }
        }
    }
    // Note: The indices array is now trashed.
    // The first array is now in order and all other
    // arrays match that order.
}

public static Integer[] ascendingIntegerArray(int length)
{
    Integer[] array = new Integer[length];
    for (int i = 0; i < array.length; i++)
    {
        array[i] = i;
    }
    return array;
}

public static <T> void swap(T[] array, int i1, int i2)
{
    T temp = array[i1];
    array[i1] = array[i2];
    array[i2] = temp;
} 
```

如果您想对其他类型的数组执行此操作，则需要对其进行一些重构。或者，对于要与字符串数组一起排序的整数数组，您可以将整数转换为字符串。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-28T18:17:35.497

直接对数组进行排序。索引所有数组并仅对所需数组的索引数组进行排序。看看这个[SO post](https://stackoverflow.com/questions/4859261/get-the-indices-of-an-array-after-sorting)中的解决方案。这将使您的阵列保持一致。我不确定是否很容易将此推断为同步排序 N 数组，但它应该让您了解如何解决问题，以防您想坚持将数据分布在多个数组中。正如一些人已经指出的那样，将数据分组到一个对象中是一种好方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-28T18:09:56.373

我建议你创建一个类如下

```
class Dress {
  public int record;
  public String color;
  public String clothes;
} 
```

保持如下的礼服清单

```
List<Dress> dressCollection = new ArrayList<Dress>(); 
```

实现基于颜色和衣服的比较器。

```
List<Dress> resultBasedOnColor = Collections.sort(dressCollection, new Comparator<Dress>() {
   public int compareTo(Dress obj1, Dress obj2) {
     return obj1.color.compareTo(obj2.color);
 }

}); 
```

左排序基于衣服作为问题所有者的练习。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-28T21:16:18.243

谢谢你们的帮助。

我非常专注于使用数组和对这些数组进行排序（因为这是我所需要的），以至于我什至没有考虑创建对象。

使用这个简单的程序，它将允许您创建一个对象并对对象中的字段进行排序。颜色和衣服只是我使用的一个例子。

下面是我完成的代码：

```
// ColorClothes.java

import java.util.*;

public class ColorClothes
{
public int record;
public String color;
public String clothes;

public static void main(String[] args)
{
    Initialize();
}

public static void Initialize()
{
    ColorClothes item[] = new ColorClothes[4];

    item[0] = new ColorClothes();
    item[0].record = 0;
    item[0].color = "blue";
    item[0].clothes = "shoes";

    item[1] = new ColorClothes();
    item[1].record = 1;
    item[1].color = "yellow";
    item[1].clothes = "pants";

    item[2] = new ColorClothes();
    item[2].record = 2;
    item[2].color = "red";
    item[2].clothes = "boots";

    item[3] = new ColorClothes();
    item[3].record = 3;
    item[3].color = "black";
    item[3].clothes = "coat";

    System.out.println("Unsorted");

    for(int i = 0; i < item.length; i++)
    {
        System.out.println(item[i].record + "     " + item[i].color + "     " + item[i].clothes);
    }

    System.out.println("\nSorted By Color\n");

    Arrays.sort(item, new ColorComparator());

    for(int i = 0; i < item.length; i++)
    {
        System.out.println(item[i].record + "     " + item[i].color + "     " + item[i].clothes);
    }

    System.out.println("\nSorted By Clothes\n");

    Arrays.sort(item, new ClothesComparator());

    for(int i = 0; i < item.length; i++)
    {
        System.out.println(item[i].record + "     " + item[i].color + "     " + item[i].clothes);
    }

}

}// End class.

// ColorComparator.java

import java.util.Comparator;

class ColorComparator implements Comparator
{
public int compare(Object str1, Object str2)
{
    String str1Color = ((ColorClothes)str1).color;
    String str2Color = ((ColorClothes)str2).color;

    return str1Color.compareTo(str2Color);

}
}// End class.

// ClothesComparator.java

import java.util.Comparator;

class ClothesComparator implements Comparator
{
public int compare(Object str1, Object str2)
{
    String str1Clothes = ((ColorClothes)str1).clothes;
    String str2Clothes = ((ColorClothes)str2).clothes;

    return str1Clothes.compareTo(str2Clothes);

}
} // End class. 
```

**控制台输出**

```
Unsorted
0     blue     shoes
1     yellow     pants
2     red     boots
3     black     coat

Sorted By Color

3     black     coat
0     blue     shoes
2     red     boots
1     yellow     pants

Sorted By Clothes

2     red     boots
3     black     coat
1     yellow     pants
0     blue     shoes 
```

我将添加另一个比较器，以便稍后按记录/整数进行排序。我还将进一步压缩代码，使其不是一大块，但我几乎完成了这一天的工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-28T18:13:32.113

将数据放入像@SiB 这样的自定义类中：

```
class ColoredClothes {
    int id;
    String color;
    String cloth;
} 
```

然后，将此类的每个实例放入以颜色为键的 TreeMap（或布料名称，具体取决于您要排序的内容）：

```
TreeMap<String,ColoredClothes> sortedCloth= new TreeMap<String,ColoredClothes>();
//loop through arrays and put new ColoredClothes into Map 
```

然后得到这样的排序值：

```
Collection<ColoredClothes> values = sortedCloth.values(); 
```

您可以使用 values.iterator() 按顺序遍历这些

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-09-06T20:53:21.480

正如其他人所建议的那样，对对象集合进行排序而不是同时对三个数组进行排序更容易。

如果出于某种原因您必须坚持对多个数组进行排序，则可以使用以下方法 - 想法是**实现自己的数组列表变体，它由三个数组**而不是一个数组支持。

```
import java.util.AbstractList;
import java.util.Collections;

public class SortMultipleArrays extends AbstractList {

    //object representing tuple from three arrays
    private static class ClothesItem implements Comparable<ClothesItem> {
        int record;
        String color;
        String clothes;

        public ClothesItem(int record, String color, String clothes) {
            this.record = record;
            this.color = color;
            this.clothes = clothes;
        }

        @Override
        public int compareTo(ClothesItem o) {
            return this.color.compareTo(o.color); //sorting by COLOR
        }
    }

    private int[] records;
    private String[] colors;
    private String[] clothes;

    public SortMultipleArrays(int[] records, String[] colors, String[] clothes) {
        this.records = records;
        this.colors = colors;
        this.clothes = clothes;
    }

    @Override
    public Object get(int index) {
        return new ClothesItem(records[index], colors[index], clothes[index]);
    }

    @Override
    public int size() {
        return records.length;
    }

    @Override
    public Object set(int index, Object element) {
        ClothesItem item = (ClothesItem) element;
        ClothesItem old = (ClothesItem) get(index);

        records[index] = item.record;
        colors[index] = item.color;
        clothes[index] = item.clothes;

        return old;
    }

    public static void main(String[] args) {
        int[] record = {0,1,2,3};
        String[] colors = {"blue", "yellow", "red", "black"};
        String[] clothes = {"shoes", "pants", "boots", "coat"};

        final SortMultipleArrays multipleArrays = new SortMultipleArrays(record, colors, clothes);
        Collections.sort(multipleArrays);

        System.out.println("Record  Color   Clothes");
        for (int i = 0; i < record.length; i++) {
            System.out.println(String.format("%8s %8s %8s", record[i], colors[i], clothes[i]));
        }
    }
} 
```

此实现基于 AbstractList，这使得实现 Collections.sort(...) 所需的 List 接口变得更加容易。

请注意，此实现中可能隐藏了低效率：**get(...)**和**set(...)**方法都在创建包装器对象的实例，这可能导致在对更大的数组进行排序时创建的对象过多。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-04-07T06:16:21.123

喜欢@bcorso 创建交换列表以对任何其他列表进行排序的想法。这是一个更优化的版本，它只使用 2 个数组而不是一个 Map 和 3 个 ListArrays，并且只交换需要交换的索引：

```
public static <T extends Comparable<T>> void syncedSort(final List<T> key, List<?>... lists) {
    // Create an array of indices
    Integer[] indices = new Integer[key.size()];
    for (int i = 0; i < indices.length; i++)
        indices[i] = i;

    // Sort the indices array based on the key
    Arrays.sort(indices, new Comparator<Integer>() {
        @Override public int compare(Integer i, Integer j) {
            return key.get(i).compareTo(key.get(j));
        }
    });

    // Scan the new indices array and swap items to their new locations,
    // while remembering where original items stored.
    // Only swaps can be used since we do not know the type of the lists
    int[] prevSwaps = new int[indices.length];
    for (int i = 0; i < indices.length; i++) {
        int k = indices[i];
        while (i > k)
            k = prevSwaps[k];
        if (i != k) {
            prevSwaps[i] = k;
            for (List<?> list : lists)
                Collections.swap(list, i, k);
        }
    }
} 
```

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2012-08-28T18:13:08.773

```
import java.util.Arrays;

Arrays.sort (int [])
Arrays.sort (String []) 
```

这将对字符串数组进行排序。

# slimdx - 用 SlimDX 强制反馈？

> ID：12164807
> 
> 赞同：1
> 
> 时间：2012-08-28T17:54:01.187
> 
> 标签：slimdx

我还没有找到任何文章或教程，可以吗？它试图调用一个 Effect 类，但我得到的只是

E_INVALIDARG：向返回函数传递了一个无效参数 (-2147024809)

编码

```
[TestClass]
public class ForceFeedbackTest
{
    [TestMethod]
    public void Test()
    {
        using (var form = new Form())
        {
            var directInput = new DirectInput();

            foreach (var device in directInput.GetDevices(DeviceClass.GameController, DeviceEnumerationFlags.AttachedOnly))
            {
                var controller = new Joystick(directInput, device.InstanceGuid);
                controller.SetCooperativeLevel(form.Handle, CooperativeLevel.Exclusive | CooperativeLevel.Background);
                controller.Acquire();

                int xAxisOffset = 0, yAxisOffset = 0;
                int nextOffset = 0;
                foreach (DeviceObjectInstance d in controller.GetObjects())
                {
                    if ((d.ObjectType & ObjectDeviceType.ForceFeedbackActuator)
                        != 0)
                    {
                        if (nextOffset == 0)
                            xAxisOffset = d.Offset;
                        else
                            yAxisOffset = d.Offset;
                        nextOffset++;
                    }
                }

                int[] offsets = new int[2];
                offsets[0] = xAxisOffset;
                offsets[1] = yAxisOffset;
                int[] coords = { 0, 0 };

                var info = controller.GetEffects(EffectType.All).First();

                var args = new EffectParameters();
                args.Flags = EffectFlags.ObjectOffsets | EffectFlags.Cartesian;
                var typeSpec = new ConstantForce();

                args.Duration = 1000;
                args.SamplePeriod = controller.Capabilities.ForceFeedbackSamplePeriod;
                args.Parameters = typeSpec;

                args.Gain = 5000;

                args.SetAxes(offsets, coords);

                args.StartDelay = 500;

                var effect = new Effect(controller, info.Guid);
                effect.SetParameters(args); //This is the line i get the error on.
                effect.Start();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-09T13:22:18.677

您不能使用从`DeviceObjectInstance`for获得的偏移量`SetAxes`。MSDN 提到了这一点，但它有点粗略：

> 设备本机数据格式的偏移量。本机数据格式对应于原始设备数据。dwOfs 成员不对应此对象的设备常量，例如 DIJOFS_BUTTON0。

[http://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.reference.dideviceobjectinstance(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/microsoft.directx_sdk.reference.dideviceobjectinstance(v=vs.85).aspx)

您可以使用`EffectFlags.ObjectIds`代替`EffectFlags.ObjectOffsets`并传入`ObjectType`from`DeviceObjectInstance`来识别轴。

据我所知，如果您知道哪些轴有执行器，您还可以使用`JoystickObjects`类的静态成员之一作为 的偏移量。`SetAxes`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:35:40.957

如果您使用的是 Xbox 360 控制器或任何支持 XInput 的控制器，我会使用它而不是 DirectInput。使用 IMO 更容易，强制反馈也很简单。查看 SlimDX.XInput。过去几年的大多数新游戏手柄都支持 XInput。

VB.net 代码：

```
Dim player As Integer = 1 'Player can be 1-4
Dim gamePad As SlimDX.XInput.Controller = New SlimDX.XInput.Controller(player)

Public Sub VibrateController(ByVal rSpeed As Short, ByVal lSpeed As Short)
   Dim vibSettings As New SlimDX.XInput.Vibration()
   vibSettings.LeftMotorSpeed = lSpeed
   vibSettings.RightMotorSpeed = rSpeed
   gamePad.SetVibration(vibSettings)
End Sub 
```

# javascript - Javascript - 你将如何正则表达式这个模式。好像做不到

> ID：12164808
> 
> 赞同：-2
> 
> 时间：2012-08-28T17:54:00.423
> 
> 标签：javascript, jquery

> **可能重复：**
> [在 JavaScript 中获取查询字符串值](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)

我“拥有”这种模式，但它并没有完全满足我的需求，尽管它有效。

```
var regex = new RegExp('\\b' + data.keyword + '(=[^&]*)?(&|$)',"gi"); 
```

但是以下正则表达式“是”我需要的，但我似乎无法让它在正则表达式 obj 中工作： /&dyanmicTxtHere(\=[^&] *)?(?=&|$)|^dyanmicTxtHere(\ =[^&]* )?(&|$)/

我试过：这不起作用 -

```
var regex = new RegExp('&' + data.keyword + '(=[^&]*)?|^' + data.keyword + '(=[^&]*)?&?',"gi"); 
```

我不知道为什么。所以上面的正则表达式应该去掉我传递的参数（和 vlaue）（data.keyword），并处理？和 & 该参数位于 url 中的任何位置。它

**那么，这会是什么搭配呢？**

www.someurl.com?Keyword=foo

www.someurl.com?up=down&Keyword=foo

www.somurl.com?up=down&keyword=foo&left=right

等等......所以，如果我将“关键字”作为我的动态参数传递，那么它将删除它及其相关值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:06:19.830

在我看来，您想要的是通过 JavaScript 从请求中读取参数值，对吗？

尝试使用这个：

```
function getParameterByName(name)
{
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + name + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec(window.location.search);
    if(results == null)
        return "";
    else
        return decodeURIComponent(results[1].replace(/\+/g, " "));
} 
```

取自[这个问题](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:10:20.667

如果您需要查看生成的正则表达式的样子，只需调用`regex.toString()`

如果你在你尝试过的那个上这样做，你会得到：

```
/&dyanmicTxtHere(=[^&]*)?|^dyanmicTxtHere(=[^&]*)?&?/gi 
```

基于此，您可以公平地看到需要更改哪些内容才能使其类似于您提供的正则表达式：

```
var regex = new RegExp('&' + data.keyword + '(\\=[^&])?(?=&|$)|^' + data.keyword + '(\\=[^&])?(&|$)', ''); 
```

如果我们调用`toString`它，我们会得到：

```
/&dyanmicTxtHere(\=[^&])?(?=&|$)|^dyanmicTxtHere(\=[^&])?(&|$)/ 
```

如果这不起作用，请尝试准确解释您要解析的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:47:46.983

显然下面的不是正则表达式；但我认为它*应该*满足您的要求。它利用 GET 查询字符串中的名称-值对的要求，并使用简单的字符串和一些数组操作来检查来自传递的 URL 的各种（如果有的话）名称-值对：

```
function removeParam(url, param) {
    // checks for the existence of a '?' in the passed url:
    var queryAt = url.indexOf('?') + 1;
    /* function exits if:
       1\. no 'url' parameter was passed,
       2\. no 'param' parameter was passed in, or
       3\. the 'queryAt' variable is false, or has a falsey value */
    if ((!url || !param) || !queryAt) {
        return false;
    }
    else {
        /* if the 'param' passed in wasn't found in the 'url' variable,
           the function exits, returning the original url (as no modification
           is required */
        if (url.indexOf(param) == -1) {
            return url;
        }
        else {
                /* gets the substring of the url from the first
                   character *after* the '?' */
            var all = url.substring(queryAt),
                // creates an array of the name and value pairs
                nameValues = all.split('&'),
                // creating a new array
                newNameValues = [],
                parts;
            // iterates through each name-value pair
            for (var i = 0, len = nameValues.length; i < len; i++) {
                // splits the name-value pair into two parts
                parts = nameValues[i].split('=');
                /* if the first part (the 'name' of the param) does not
                   matches what you're looking for then the whole name-value
                   pair is pushed into the 'newNameValues' array */
                if (parts[0] !== param) {
                    newNameValues.push(nameValues[i]);
                }
            }
            // returns the reconstructed URL
            return url.substring(0, queryAt) + newNameValues.join('&');
        }
    }
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/mrw64/1/)。

# android - 线性布局中的图像视图权重

> ID：12164814
> 
> 赞同：1
> 
> 时间：2012-08-28T17:54:32.307
> 
> 标签：android, android-layout, android-linearlayout, android-layout-weight

我有这个布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:gravity="center_vertical"
    android:orientation="horizontal"
    android:minWidth="100dp" >

    <TextView
        android:id="@+id/txt_what_way"
        android:layout_height="wrap_content"
        android:layout_width="0dp"
        android:layout_weight="4"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <LinearLayout
        android:layout_height="wrap_content"
        android:layout_width="0dp"
        android:layout_weight="3">
        <ImageView
            android:layout_width="20dp"
            android:layout_height="20dp"
            android:scaleType="fitCenter"
            android:src="@drawable/ic_launcher"/>
    </LinearLayout>

    <LinearLayout
        android:layout_height="wrap_content"
        android:layout_width="0dp"
        android:layout_weight="3">
        <ImageView
            android:layout_width="20dp"
            android:layout_height="20dp"
            android:scaleType="fitCenter"
            android:src="@drawable/ic_launcher"/>
    </LinearLayout>

</LinearLayout> 
```

我希望它看起来像：

*   TextView - 40% 的宽度，带有 ImageView 的布局 - 30% 的宽度，带有 - - ImageView 的布局 - 30% 的宽度。

但是，输出是：

```
TextViewImageViewImageView----------------free space---------------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:04:32.873

在你的情况下使用 android:weightSum="10" 并使用 android:background 代替 android:src ，用这个替换你的xml文件

```
<TextView
    android:id="@+id/txt_what_way"
    android:layout_height="wrap_content"
    android:layout_width="fill_parent"
    android:layout_weight="4"
    android:text="test"
    android:textAppearance="?android:attr/textAppearanceMedium" />

        <ImageView
        android:layout_width="fill_parent"
        android:layout_height="20dp"
       android:layout_weight="3"
        android:background="@drawable/s1"/>

    <ImageView
        android:layout_width="fill_parent"
        android:layout_height="20dp"
        android:layout_weight="3"
         android:background="@drawable/s1"/>
</LinearLayout> 
```

你可能会得到扭曲的图像

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-09T07:31:05.327

这应该这样做，尽管它会扭曲你的形象。

```
 <?xml version="1.0" encoding="utf-8"?>
        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:gravity="center_vertical"
            android:minWidth="100dp"
            android:orientation="horizontal" >

            <TextView
                android:id="@+id/txt_what_way"
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="4"
                android:textAppearance="?android:attr/textAppearanceMedium" />

            <ImageView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="3"
                android:scaleType="fitCenter"
                android:src="@drawable/icon" />

            <ImageView
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="3"
                android:scaleType="fitCenter"
                android:src="@drawable/icon" />

        </LinearLayout> 
```

# php - 动态调用函数，不管是实例方法还是静态方法？

> ID：12164815
> 
> 赞同：1
> 
> 时间：2012-08-28T17:54:31.400
> 
> 标签：php

我需要能够调用一个方法而不必知道它是否是静态的。

例如，这不起作用，我希望它：

```
class Groups {
    public function fetchAll($arg1, $arg2){
        return $this->otherFunction();
    }
    public static function alsoFetchAll($arg1, $arg2){}
}

$arguments = array('one', 'two');
$result = call_user_func_array(array('Groups', 'fetchAll'), $arguments);
$result = call_user_func_array(array('Groups', 'alsoFetchAll'), $arguments); 
```

我收到实例变量的错误：

```
Fatal error: Using $this when not in object context 
```

它不起作用的原因是因为我需要实例化类才能使实例变量起作用。但是我的构造函数不接受任何参数，所以我想要一个快速的方法来跳过这一步。

我怎样才能写这个，这样不管它是什么样的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:09:02.770

你*可以*用反射来做到这一点。假设你有这些变量：

```
$class = 'Groups';
$params = array(1, 'two'); 
```

然后您可以创建该类的新实例：

```
$ref = new ReflectionClass( $class);
$instance = $ref->newInstance(); 
```

并以相同的方式调用这两种方法，检查它们是否是静态的以确保完整性：

```
$method = $ref->getMethod( 'fetchAll');
$method->invokeArgs( ($method->isStatic() ? null : $instance), $params);

$method = $ref->getMethod( 'alsoFetchAll');
$method->invokeArgs( ($method->isStatic() ? null : $instance), $params); 
```

但是，您不需要确保它们是静态的，您可以轻松地做到这一点，无论方法是否是静态的：

```
$ref->getMethod( 'fetchAll')->invokeArgs( $instance, $params);
$ref->getMethod( 'alsoFetchAll')->invokeArgs( $instance, $params); 
```

[您可以在此演示](http://viper-7.com/16RtNc)中看到它的工作原理。

**编辑：** [这是一个演示](http://viper-7.com/vnLT6y)，显示这适用于 OP 的用例，没有任何错误/警告/通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:07:57.450

我认为存在设计问题 - 如果您需要实例方法，则需要*实例*，因此您可能需要访问该实例的属性。

如果您需要静态方法，则不需要引用任何实例，因此请使用`call_user_func_array`. 当您处理存储库方法时，您可以毫无问题地将它们设为静态 - 无论如何，如果您需要解决方案：

```
function callMethod($class, $method, $arguments)
{

    // if there is no such method, return
    $info = new ReflectionClass($class);
    if(!$info -> hasMethod($method))
        return false;

    // let's find if desired method is static - create a temporary instance in case
    foreach($info -> getMethods(ReflectionMethod::IS_STATIC) as $method)
    {

        if($method['name'] == $method)
        {

            $class = $info -> newInstance;
            break;

        }

    }

    return call_user_func_array(array($class, $method), $arguments);

} 
```

# java - 服务器终止时调用 sessionDestroyed()

> ID：12164823
> 
> 赞同：3
> 
> 时间：2012-08-28T17:55:14.830
> 
> 标签：java, tomcat, servlets, servlet-listeners

为什么`sessionDestroyed()`只在无效或超时时调用，而在服务器终止时不调用？服务器终止时如何对每个会话进行一些操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:27:29.440

Java Servlet 3.0 规范声明`HttpSessionListener.sessionDestroyed()`应该在服务器/应用程序关闭时调用（第 11.3.4 节**通知关闭时**）：

> 在应用程序关闭时，侦听器的通知顺序与其声明的相反，会话侦听器的通知先于上下文侦听器的通知。会话侦听器必须在应用程序关闭通知上下文侦听器之前通知会话失效。

Tomcat 7 实现了 Java Servlet 3.0 规范并且应该支持您的用例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T18:05:39.607

**关于你的第一个问题：**

> 为什么 sessionDestroyed() 仅在无效或超时时调用，但在服务器终止时不调用？

以下是关于在 Tomcat 中关闭时为什么`sessionDestroyed()`没有被调用的解释（至少从 Tomcat 6.0.33 开始），来自 Tomcat 上的一篇文章：http://comments.gmane.org/gmane.comp.jakarta.tomcat [。用户/215644](http://comments.gmane.org/gmane.comp.jakarta.tomcat.user/215644)

> 当我请求我的 Web 应用程序时，我收到 sessionCreated，当我从收到 sessionDestroyed 的代码中使会话无效时。不幸的是，当我停止 Web 应用程序时，我没有收到 sessionDestroyed。
> 
> 我检查了 StandardContext 停止的代码。我可以看到调用 StandardManager.stop 没问题 但是当调用 StandardManager.doUnload() 时，在其实现中 * session.expire(false)* 被调用，其中“false”实际上是指示是否通知的标志听众与否。因为它是用“false”调用的——监听器没有被调用。

这不是我的帖子，我将归功于该帖子的作者 Violeta。

该帖子提供了一种修补方法`StandardManager.java`。

如果您不想修改该类（我个人尽可能避免修改属于 Application Server 的类），您可以采用其他方法。

**关于你的第二个问题：**

> 服务器终止时如何对每个会话进行一些操作？

为什么要在服务器终止时对每个会话进行操作？Servlet 规范提供了在服务器关闭时执行代码的方法。但是，它们没有提供一种方法，您可以通过它对每个活动会话执行操作（可能是设计使然）。

正如这个较早的答案所提到的，[如何在 Java 中访问 HTTP 会话](https://stackoverflow.com/questions/3235997/how-to-access-http-sessions-in-java/3236022#3236022)，会话管理应该由 Servlet 容器处理，您可以重新考虑您当前的应用程序方法。

对于服务器关闭时的一般处理清理，您有`ServletContextListener.contextDestroyed`并且`Servlet.destroy`

`ServletContextListener`接口提供生命周期`contextDestroyed`方法

Servlet 接口提供了一个 destroy 方法，用于在服务器关闭时释放任何资源或处理任何清理工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T07:24:50.073

[在 Glassfish Web 部署之后](https://stackoverflow.com/questions/10603521/execute-code-after-glassfish-web-deployment)阅读执行代码我得到了这个问题的答案。

我们可以编写一个 ServletContextListener 在上下文加载或终止时触发，如下所示：

```
public class MyServlet implements ServletContextListener {

  public void contextInitialized(ServletContextEvent e) {
         // implementation code
  }

  public void contextDestroyed(ServletContextEvent e) {
         // implementation code
  }
} 
```

现在，在您的情况下，将触发关闭，然后将调用 contextDestroyed() 方法。

参考：

*   [ServletContextListener 示例](http://www.javabeat.net/2009/02/servletcontextlistener-example/)

感谢加里斯·苏罗

# android - Android 调试（重新设计的 APK 和 waitForDebugger）

> ID：12164825
> 
> 赞同：1
> 
> 时间：2012-08-28T17:55:21.807
> 
> 标签：android, debugging, smali

我正在尝试使用 APKTOOL、Smali 等工具以及 Eclipse 和 NetBeans 等 IDE 制定黑盒测试 APK 的方法。我有我需要的大部分东西——我可以反编译/调试仪器/重新编译/签名/对齐并在设备上运行。

我遇到的问题是在附加调试器后设置断点（断点在 Smali 代码中设置）。看来断点没有提交给 Dalvik 或 Dalvik 没有遵守断点。无论哪种方式，当程序遇到断点时，调试器都不会捕捉。一些研究表明我可能需要`Debug.waitForDebugger`. （http://stackoverflow.com/questions/3107587/android-with-jdb-confusion-using-waitfordebugger）。

假设是下一个障碍，我可以在调整本地堆栈后`waitForDebugger`使用 Smali 语法插入它。`invoke-static {}, Landroid/os/Debug;->waitForDebugger()V`

我的问题是，我在哪里插入呼叫`waitForDebugger`？我应该在静态构造函数 ( )、实例构造函数 ( )还是其他地方选择`MainActivity`（来自清单） ？诸如 Eclipse、NetBeans 等 IDE 如何在其调试版本中做到这一点？`clinit``init``onCreate`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T18:05:10.003

上述问题的简短答案是将其放入`MainActivity.onCreate`.

Dima 在 APKTOOL 错误报告中提供的长答案指出这`Debug.waitForDebugger`是不可靠的，我们应该等待调试器附加：

```
boolean debuggerAttached = false;
while(!debuggerAttached ) { ; } 
```

在此错误报告中参考他的答案：[NetBeans/Smali Debugging is Broken (SmaliDebugging Page)](http://code.google.com/p/android-apktool/issues/detail?id=339)。

# jquery - jquery交换/动画顺序jpg图像数组

> ID：12164828
> 
> 赞同：1
> 
> 时间：2012-08-28T17:55:32.027
> 
> 标签：jquery, image, animation, swap

我正在尝试使用以下方法交换/动画预加载的 jpg 图像以预加载图像：

```
<img id="slideshow" src="../../Content/images/IM0-Frame1.jpg" alt="" width="200"
        height="200">
    <script type="text/javascript">
                $(document).ready(function () {
                    preload_images();
                  });
                function preload_images() {
                    var images = new Array();
                    for (var i = 1; i <= 126; i++) {
                        var str;
                        if (i < 10) {
                            str = i;
                        } else {
                            str = i;
                        }
                          images.src="../Content/images/IM0-Frame" + str + ".jpg";
                    }
                }
    </script> 
```

我会很感激你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:00:26.403

您实际上并没有预加载图像，只是用它们的 url 填充一个数组，以预加载图像创建一个 Image 对象并将其 src 属性设置为图像 url。

```
var img = new Image();
img.src = "../Content/images/IM0-Frame" + str + ".jpg"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T19:50:18.787

这是一个简单的幻灯片，它预加载图像，使用`setInterval`功能滑动它们并在鼠标悬停/离开时停止/恢复循环图像：

```
var images = [];
var i = 0;
var interval = null;

function preload_images() {
    for (var i = 0; i < 126; i++) {
        images[i] = new Image();
        images[i].src = "../Content/images/IM0-Frame" + i + ".jpg";
    }
}

preload_images();

function cycle_images() {
    i = (i < 2) ? i + 1 : 0;
    document.getElementById('slideshow').src = images[i].src;
}

$(document).ready(function() {
    interval = setInterval(cycle_images, 2000);
    $('#slideshow').hover(function() {
        clearInterval(interval);
    }, function() {
        interval = setInterval(cycle_images, 2000);
    });
}); 
```

[小提琴示例](http://jsfiddle.net/lalatino/zmSw5/)

# c# - ExecuteNonQuery 留下一个休眠的等待命令会话

> ID：12164832
> 
> 赞同：2
> 
> 时间：2012-08-28T17:55:48.110
> 
> 标签：c#, sql-server-2008-r2, executenonquery

我有用 C# 编写的命令行实用程序，它更新数据库中的一些记录，然后进入一个循环检查其他一些东西。由于某种原因，SQL 执行总是在 SQL 执行后在 SQL Server 2008 中留下一个休眠的等待命令会话。我可以使用 SQL 服务器活动监视器并运行 sp_who2 来确认这一点。但是SQL事务确实已经提交成功了。我可以从代码中的调试以及数据库中数据记录的时间戳中看出这一点。此外，当我明确停止命令行实用程序时，打开的睡眠会话将被终止。这似乎表明我的函数创建了一些 SQL 连接对象，该对象在应用程序中止时被 CLR 垃圾收集之前无法释放。这怎么可能发生？谢谢。这是代码：

```
bool result = false;
     using (SqlConnection conn = new SqlConnection(this.Connection))
     {

        using (SqlCommand cmd = conn.CreateCommand())
        {
           cmd.CommandText =
                 @"if not exists (select id from pl where sj=@sj and ej=@ej and dateInactivated is null) 
                       insert into pl(sj,ej,pf, br, tk, lastModified )
                       values(@sj,@ej,@pf,@br,@tk,getDate())
                    else
                       update pl set sj=@sj,ej=@ej,pf=@pf,br=@br,tk=@tk,lastModified=getDate()
                       where sj=@sj and ej=@ej and dateInactivated is null
                    ";

           cmd.Parameters.AddWithValue("@sj", sj);
           cmd.Parameters.AddWithValue("@ej", ej);
           cmd.Parameters.AddWithValue("@pf", pf);
           cmd.Parameters.AddWithValue("@br", br);
           cmd.Parameters.AddWithValue("@tk", tkData);
           cmd.CommandTimeout = 60;
           SqlTransaction trans = null;
           try
           {
              conn.Open();
              trans = conn.BeginTransaction();
              cmd.Transaction = trans;
              cmd.ExecuteNonQuery();
              trans.Commit();
              conn.Close();
              result = true;
           }
           catch (SqlException ex)
           {
              if (trans != null)
              {
                 trans.Rollback();
              }
              Log.WriteLog(LogLevel.ERROR, ex.Message);
              result = false;
           }
           finally
           {
              if (conn.State != ConnectionState.Closed)
              {
                 conn.Close();
              }
           }
        }

     }

     return result; 
```

请注意，tk 字段是一个 xml 数据库字段。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T17:57:12.490

这称为连接池，[您希望它以这种方式工作](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)。

基本上，完全断开连接然后为您的应用程序重新建立连接会比仅重新使用先前调用代码留下的空闲连接产生更高的惩罚。这是一件好事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T18:07:50.657

这是由于池化。在 99.99% 的情况下，这是一件好事——它可以减少建立和拆除的连接，如果多线程可以减少同时打开的连接。

如果您添加`Pooling=false`到连接字符串，它将不会被使用。这样做的唯一原因是：

1.  作为临时措施，如果您在某处泄漏池连接 - 请注意，就性能而言，这会使糟糕的情况变得更糟，但它不会达到最大池大小。此处**暂**重强调。
2.  您有客户端应用程序共享一个数据库，并在很短的时间内使用连接。在这里，您要关闭池，因为虽然它降低了每个客户端的效率，但它减少了服务器本身的压力。

第二个非常罕见。第一个应该是非常罕见的——再次强调*暂时*的。

# java - 让Eclipse专门自动导入jsp文件中的类

> ID：12164841
> 
> 赞同：8
> 
> 时间：2012-08-28T17:56:32.287
> 
> 标签：java, eclipse, jsp, intellisense

我是一个被宠坏的 Java 开发人员，我喜欢将鼠标悬停在我丢失的类上并选择“导入 com.package.ClassName”。

如何让 Intellisense 在 jsp 文件中工作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-28T18:06:57.590

据我回忆，在所有 Eclipse 版本中，按`Ctrl`+`Space`获取自动完成导入的常用方法一直对我有用。

![在此处输入图像描述](../Images/30e2f4120597564f16a7c80a7b6ec6b1.png)

* * *

事实上，大多数其他有用的工具，如`Ctrl`++ （自动组织导入）、+ `Shift`（快速修复）等在 JSP 中都不起作用。但是，毕竟，Java 代码[根本不](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files/3180202#3180202)应该写在 JSP 文件中。这不仅是一个开发中的噩梦（当您遇到自己在 Eclipse 中缺乏适当的工具支持时），而且在所有其他颜色中也很糟糕。只需在普通 Java 类中编写 Java 代码即可。`O``Ctrl``1`

# mysql - 更改mysql数据库中项目顺序的最有效方法

> ID：12164842
> 
> 赞同：4
> 
> 时间：2012-08-28T17:56:45.850
> 
> 标签：mysql

我将从我的排序脚本中返回值，该脚本提供了元素在更改开始和结束时的位置。因此，假设第 4 位排在第 1 位。知道我只需要在原来的第 1、2、3 位加 1 就可以保留顺序。

现在，更新数据库的最佳方式是什么？是否为每个需要更改的 id 循环运行查询？那是 4 个更新查询，这似乎效率低下？还有其他方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T19:09:24.307

您可以使用单个查询更新表中行的位置值，无论您是向上还是向下移动位置：

```
UPDATE tbl
SET    pos = CASE WHEN pos = [oldpos] THEN
                       [newpos]
                  WHEN [newpos] < [oldpos] AND pos < [oldpos] THEN
                       pos + 1
                  WHEN [newpos] > [oldpos] AND pos > [oldpos] THEN
                       pos - 1
             END
WHERE  pos BETWEEN LEAST([newpos], [oldpos]) AND GREATEST([newpos], [oldpos]) 
```

`pos`是您的职位字段。

只需将行的当前位置和该行`[oldpos]`的新位置传递给`[newpos]`，查询就会为您工作。

前任。如果要将行从位置 3 更改为位置 10：

```
UPDATE tbl
SET    pos = CASE WHEN pos = 3 THEN
                       10
                  WHEN 10 < 3 AND pos < 3 THEN
                       pos + 1
                  WHEN 10 > 3 AND pos > 3 THEN
                       pos - 1
             END
WHERE  pos BETWEEN LEAST(3, 10) AND GREATEST(3, 10) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T17:59:05.827

我做了一些类似于我认为你正在尝试做的事情。我有一个表格，其中每一行代表一个特定的 UI 元素，以网格的形式布置在页面上。用户能够更改 UI 元素的顺序，我会将该数字存储在表中，以便默认情况下按该顺序出现。

为此，如果我没记错的话，我使用了两个查询：

```
UPDATE table SET position = 0 WHERE position = 4;
UPDATE table SET position = position+1 WHERE position < 4; 
```

第一个查询将该特定的行设置为最小数字，第二个查询将原始值下的所有行增加 1（包括您刚刚设置为 0 的行，使其为 1）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T17:59:44.643

在关系数据库中，基础表没有固有顺序。所以，我假设你想改变输出的顺序。我建议以下查询：

```
select t.*
from t join
     newsort
     on t.id = newsort.id
order by newsort.newid 
```

# wordpress - Is it possible to host site at wordpress but have it reachable by mydomain.com/blog? What are SEO implications of this?

> ID：12164850
> 
> 赞同：0
> 
> 时间：2012-08-28T17:57:16.907
> 
> 标签：wordpress, seo, domain-mapping

I have a blog currently hosted at mydomain.wordpress.com but reachable by blog.mydomain.com and have been told this is not helping my SEO credibility. I've been told to switch to mydomain.com/blog but don't know if I can point a subdirectory at a site hosted elsewhere. Is this possible? Will it actually improve my SEO ranking/credibility?

**Current Setup**

```
//Hosted at:
mydomain.wordpress.com

//Domain Mapped to:
blog.mydomain.com 
```

**Desired Setup**

```
//Hosted at:
mydomain.wordpress.com

//Domain Mapped to:
mydomain.com/blog 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T05:23:33.390

您将需要实现从子域到 mydomain.com/blog 子文件夹的 301（永久）重定向。将您的博客放在子文件夹中将极大地帮助您，因为您的博客目前被视为一个单独的站点。您的域中的任何链接或可信度都不会在您的子域上流向您的博客，反之亦然。

如果您的主站点上有博客

*   它将为网站添加新鲜和独特的内容
*   它将为网站带来更多的入站链接（指向您的子域的链接不会帮助您的主域​​排名）
*   它将为您提供更大的能力来为网站排名生成丰富的关键字。

这些都为网站增加了很多 SEO 价值。将您的博客托管在您的子域上，它不会为您的网站提供任何附加值。

# c# - 如何对 ASP 网站中包含的 Web 服务进行单元测试？

> ID：12164852
> 
> 赞同：1
> 
> 时间：2012-08-28T17:57:17.970
> 
> 标签：c#, asp.net, web-services, unit-testing, web

我有一个 ASP 站点，其中包含访问外部库的 Web 服务。即我所有的网络服务都包含在“App_Code”文件夹中。

我想对这些 Web 服务进行单元测试，但我需要经过身份验证才能访问它们。

有没有办法在 ASP Web 项目中对经过身份验证的 Web 服务进行单元测试？

我发现[this question](https://stackoverflow.com/questions/1198555/unit-testing-asp-net-web-site-project-code-stored-in-app-code)似乎在问一个类似的问题，但我认为3年内可能会有一些发展。

我还发现[了这个](http://msujaws.wordpress.com/2010/06/13/unit-testing-code-behinds-in-asp-net-web-forms/)测试代码背后的项目，这几乎是我需要的，但不完全是。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T20:04:04.787

如果有您无法控制的服务，您通常会将它们存根或隐藏在接口后面并模拟它们。这样您就可以为自己的内部框架/应用程序测试设置期望值。

如果您想确保与这些服务的交互正常工作，那么您可以进行集成测试，该测试将调用“开发”服务进行测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-29T13:26:20.777

您提到的问题上发布的答案是这种情况的正确答案。由您的服务调用的可测试类库是可行的方法。那时您的 Web 服务层将非常薄，并且其本身几乎没有逻辑。

这样您就可以对相关业务逻辑进行适当的单元测试。

# iphone - 如何清除 CGContextRef？

> ID：12164854
> 
> 赞同：1
> 
> 时间：2012-08-28T17:57:24.080
> 
> 标签：iphone, ios, uikit, core-graphics, cgcontextref

我尝试在 ipad 上创建一个简单的手指绘画应用程序。我能够正确地绘制到屏幕的路径，但我希望有一个选项可以完全清除所有绘制路径的屏幕。我目前拥有的代码清除了上下文，但是当我调用绘图代码块时，所有路径都会重新出现在屏幕上。

```
- (void)drawRect:(CGRect)rect
{
   //Drawing code
   CGContextRef context = UIGraphicsGetCurrentContext();

     if(clearContext == 0){

        CGContextSetLineWidth(context, 6);
        CGContextSetRGBStrokeColor(context, 1, 0, 0, 1);
        CGContextAddPath(context, drawingPath);

        CGContextStrokePath(context);
     }
     if(clearContext == 1){

      //This is the code I currently have to clear the context, it is clearly wrong
      //Just used as experimentation.

      CGContextSetBlendMode(context, kCGBlendModeClear);
      CGContextAddPath(context, drawingPath);
      CGContextStrokePath(context);
      clearContext = 0;

     }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:04:49.480

我假设 drawingPath 是一个 CGPath ...你在清除那个 CGPath 吗？这可能是你的问题的原因

在清除路径的操作中，请执行以下操作：

```
CGPathRelease(drawingPath);
drawingPath = CGPathCreateMutable();
[self setNeedsDisplay]; 
```

做你通常做的正常绘图。如果路径为空，则不会绘制任何内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-19T21:14:20.073

清除所有 CGContextRef 绘图：

```
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextClearRect(context, self.bounds); //self.bounds = your drawing base frame
[self setNeedsDisplay]; 
```

# c - 嵌套在联合中的结构中的公共初始序列 - C 标准中的定义

> ID：12164855
> 
> 赞同：2
> 
> 时间：2012-08-28T17:57:32.193
> 
> 标签：c, structure, unions

在 C11 标准中，嵌套在单个联合中的结构共享的公共初始序列定义如下：

> **6.5.2.3/6**
> 
> 一个特殊的保证是为了简化联合的使用：如果一个联合包含多个共享一个公共初始序列的结构（见下文），并且如果联合对象当前包含这些结构之一，则允许检查公共它们中的任何一个的初始部分，在任何地方都可以看到已完成联合类型的声明。如果对应的成员对于一个或多个初始成员的序列具有兼容的类型（并且对于位域，具有相同的宽度），则两个结构共享一个*共同的初始序列。*
> 
> 示例 3 以下是一个有效片段：
> 
> ```
> union {
>     struct {
>         int alltypes;
>     } n;
> 
>     struct {
>         int type;
>         int intnode;
>     } ni;
> 
>     struct {
>         int type;
>         double doublenode;
>     } nf;
> } u;
> 
> u.nf.type = 1;
> u.nf.doublenode = 3.14;
> /* ... */
> if (u.n.alltypes == 1)
>         if (sin(u.nf.doublenode) == 0.0)
>             /* ... */ 
> ```

但是根据我对这篇文章的理解，上面的代码是无效的。

在外部`if`语句中，我们指示`n::alltypes`数据成员是活动的（与标准状态同时`ni::type`并`nf::type`作为标准状态），但在内部`if`我们使用`nf::doublenode`的不是公共初始序列的一部分。

有人可以澄清这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:05:06.697

> 允许检查[共享一个共同初始序列的几个结构]的共同初始部分

使用提供的示例，规范的这一部分是说，由于 的每个可能的成员类型`union`都有一个`int`作为初始字段，因此您可以使用*任何*成员类型访问该公共初始字段，*即使在*变量已经初始化/使用之后作为特定成员类型之一。

这正是该示例所做的：*在*将后续字段初始化为 an 之后，它作为 an的`int`成员`alltypes`访问初始值，然后继续访问an 的字段，所有这些都使用相同的变量。`n`*`nf``doublenode``nf`*

 *使用`union`作为一种可能的类型不会强制它进入某种结构：这就是联合的​​工作方式。

请注意，这种保证已经存在了一段时间：在[ANSI 规范](http://flash-gordon.me.uk/ansi.c.txt)中可以找到基本相同的文本，第*3.3.2.3 节结构和联合成员*。*

# php - How to catch error or warning while getting data from database

> ID：12164861
> 
> 赞同：1
> 
> 时间：2012-08-28T17:57:59.437
> 
> 标签：php, mysql, phpmyadmin

I have a problem. I am trying, but I am not getting the exact solution.

I have code to take something from database.

```
try {
    require_once('blogic.php');
    $obj  = new blogic();
    $re   = $obj->select("SELECT link FROM eff ORDER BY RAND() LIMIT 1");
    $l    = mysql_fetch_row($re);
    $link = $l[0];
} catch (Exception $e) {
    $link = "http://www.xyz.com/friendsin2013/";
} 
```

The above code is working properly, but if (for whatever reason) any problem comes while getting data from the database, I want the link to be defaulted as given in the `catch` block.

However it is not working the way I want it to. It works when there is no error, however, when I experience an errorr, `$link` does not get passed from the `catch`. I just get the error message instead.

Blogic.php life is like --->> This is a file to get database entry.

```
<?php

include('s.php');

class blogic {

    function connect() {
        $link = mysql_connect(SERVER, USER, PASSWORD);
        if (!$link) {
            die('Could not connect: ' . mysql_error());
            return false;
        } else {
            return true;
        }
    }

    function select_database() {
        $db = mysql_select_db(DATABASE);
        if (!$db) {
            die('Could not connect: ' . mysql_error());
            return false;
        } else {
            return true;
        }
    }

    function select($str) {
        self::connect();
        self::select_database();

        $res = mysql_query($str);
        return $res;
    }
}
?> 
```

s.php ->>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:09:57.463

是在/逻辑`$link`之前定义的吗？如果不先尝试。`try``catch`

`$link`使用提供的代码看起来无法在`try`/之外访问。`catch`

尽管马特以最佳答案击败了我；和他一起去是完全可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:02:39.237

把它写成一个函数，然后调用它；`$link`在`try`和`catch`块中返回：

```
require_once('blogic.php');

function getLink() {
     try {
        $obj = new blogic();
        $re=$obj->select("SELECT link FROM eff ORDER BY RAND() LIMIT 1");
        $l=mysql_fetch_row($re);
        return $l[0];
    }
    catch(Exception $e) {
        return "http://www.xyz.com/friendsin2013/";
    }
}

$link = getLink(); 
```

# facebook - xmpp login fails after authentication

> ID：12164863
> 
> 赞同：17
> 
> 时间：2012-08-28T17:58:07.020
> 
> 标签：facebook, authentication, xmpp, conflict

I've been seeing this behavior for some time now, but it wasn't really a problem. After I successfully authenticate in xmpp with my own app, an error close my connection:

```
<message from="chat.facebook.com" 
         to="-USERID@chat.facebook.com/RESOURCE" type="normal">   
   <subject>Lo sentimos, tu cuenta no está disponible</subject>
   <body>Your account is temporarily unavailable. Regain 
      access by logging into your account from your 
      computer&apos;s web browser: http://www.facebook.com/
   </body>
</message>

<stream:error>
   <conflict xmlns="urn:ietf:params:xml:ns:xmpp-streams"/>
   <text xml:lang="" xmlns="urn:ietf:params:xml:ns:xmpp-streams">
      Session terminated
   </text>
</stream:error> 
```

Note the message stanza that I received before the disconnection.

Why is this happening?, have I hit some kind of undocumented limit?, and more than that, is there a way to differentiate between this error and a disconnection from the Facebook's web page?.

I used to check the texts that are received in that message stanza, but now they change almost weekly, and the stream:error's text is the same for both cases, so it's painful to change the app every time a text changes.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-21T19:49:00.670

转到 Facebook，右上角菜单，设置。导航到安全。禁用登录批准。如果在那之后事情不起作用，请在隐私模式下进入 FB，您最终会看到一个您必须接受的批准对话框。

# c - How to smartly detect undefined symbols when linking a plugin on GNU/Linux?

> ID：12164864
> 
> 赞同：6
> 
> 时间：2012-08-28T17:58:07.250
> 
> 标签：c, linux, macos, linker, ld

I have a program `foo` that can load plugins via `dlopen()`. I'm writing one such plugin `foobar` that interfaces to functionality provided by a third-party library `libfoo`.

On Linux, I'm building `foobar` like this:

```
gcc -fpic -c -o foobar.o foobar.c
gcc -fpic -shared -o foobar.so foobar.o -lbar 
```

So far so good.

The problem is that this doesn't detect undefined symbols, for example because of bugs in the code or mismatches between header files and library. The link succeeds, and you only get an error later when you load the plugin or when you invoke something in the plugin (depending on `dlopen()` flags).

To detect undefined symbols in a shared library, one would normally use `-Wl,-z,defs` or perhaps `-Wl,--no-allow-shlib-undefined`. But this will fail because it will also report symbols that are supposed to be found in the `foo` program at run time. I would like to detect undefined symbols except those provided by the hosting program.

On Mac OS X, for example, this is done by the `-bundle_loader` option. The equivalent link command would be

```
gcc -bundle -o foobar.so foobar.o -lbar -bundle_loader=foo 
```

and that detects undefined symbols in the way I want.

How does one do this on GNU/Linux or with GNU ld in general? (I have looked through all the options listed on the `ld` man page, but none looked promising.)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:09:44.880

据我所知，没有办法做到这一点。但是，如果 'foo' 的结构在您的控制之下，您可以将 'foo' 中的所有逻辑移动到导出正确符号的新共享库中，然后将您的插件和主线链接到该库。

# html - Why is a canvas line rendered below the initial page load have lower fidelity than those above?

> ID：12164867
> 
> 赞同：0
> 
> 时间：2012-08-28T17:58:13.927
> 
> 标签：html, canvas, paperjs

I am using paper.js to manage my html5 drawing. In Chrome if I reload at the bottom of the page and view this line, it is clear:

![image1](../Images/ced13daf25e33f32a603467c877a57c3.png)

If I reloaded at the bottom, I can scroll up and back down, and the line will maintain its fidelity.

But if I reload at the top of the page and scroll down, the line looks jagged and not anti-aliased, like so:

![image2](../Images/6bb8088595297ae0aa665d615327dd2b.png)

Strangely, if I scroll up and down a few times after initially loading at the top of the page, the fidelity gets worse:

![image3](../Images/2559df016a7d9c035df68100e77a355c.png)

This happens in Safari as well, and in Firefox it happens but almost to an unnoticeable degree. My assumption is that this has something to do with the fact that when I load at the bottom, all of the dom elements above the load are rendered at page load. Whereas if I load at the top, the elements are only rendered when scrolled into view (and so are fighting with the scroll event and repaints for CPU?)

But is there anything I can do to make sure all dom events are rendered at page load? I am already wrapping the initial draw function in a $(document).ready.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T22:27:04.887

看来这只是与性能有关（我还没有对其进行分析，所以我不确定 CPU 或内存是否是限制因素）。但是我可以简单地在 onFrame 循环中向 console.log 添加一个计算，尽管屏幕上没有 html5 启动的动画或重绘，但线条会出现锯齿状。

编辑：

真正的问题是向画布标签添加调整大小，例如：

```
<canvas resize></canvas> 
```

将导致页面中某个点下的所有内容都被重新绘制。

# ios - +initialize 中的内存泄漏

> ID：12164868
> 
> 赞同：1
> 
> 时间：2012-08-28T17:58:15.287
> 
> 标签：ios, memory-leaks, instruments

Instruments 在此方法中报告 100% 泄漏：

```
+(void)initialize{
    mapper = [[NSMutableDictionary alloc] init];
} 
```

假设 Instruments 没有报告误报，有哪些可能的情况会导致这种情况？多线程（尽管文档说它是以“线程安全的方式”调用的）？

这是非 ARC。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:00:42.877

问题（假设是非 ARC 环境）是您分配了内存`mapper`但您从未释放它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:03:31.843

使用自动释放池：

```
+(void)initialize {
    @autoreleasepool {
      mapper = [[NSMutableDictionary alloc] init];
    }
} 
```

在这种情况下，对象的创建可能会导致自动释放对象（例如，在 NSMutableDictionary 的实现中是内部的或临时的）。当然，如果这是问题所在，您会在控制台中看到“……autoreleased with no pool - just leaking”消息。

您还应该考虑懒惰地初始化您的共享/全局内容，或者在您的应用程序启动后初始化。

如果您没有看到这些消息，那么这将不适用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-29T22:42:25.130

问题是上面有这个类的子类。在块中设置`alloc`s修复了泄漏。`initialize``dispatch_once`

[Mike Ash 的这篇文章](http://www.mikeash.com/pyblog/friday-qa-2009-05-22-objective-c-class-loading-and-initialization.html)有助于弄清楚`initialize`。

# c - API 设计思想中的 C void 指针

> ID：12164874
> 
> 赞同：4
> 
> 时间：2012-08-28T17:58:33.317
> 
> 标签：c

我正在开发一个大型项目，该项目作为静态 c 库和一个头文件提供给我们的客户，其中包含我们公开的 API 的原型。该项目有两个相似但独特的构建，它们需要在标头中公开不同的数据结构。我正在尝试提出最佳设计，以允许单个 API 函数根据构建使用不同的数据结构。到目前为止，这是我的想法，但我担心这是一个糟糕的设计。

我的功能将像这样实现

```
void foo(void *generic_data_struct)
{
#ifdef BUILD1
   build1_t *data_struct = generic_data_struct;
#else
   build2_t *data_struct = generic_data_struct;
#endif
...
} 
```

根据客户订单的构建，公开的 API 标头将是

```
void foo(build1_t *data_struct); 
```

或者

```
void foo(build2_t *data_struct); 
```

这是一个合理的设计模式还是不赞成？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T18:04:20.020

`struct foo;`对于这种事情，使用不透明类型 ( ) 几乎总是比使用`void`指针更好。

每当您有变体构建时，都非常希望最大限度地减少#ifdefs 的数量。我建议您使用 eq- 的建议，但要使用 typedef 排除函数原型的变化：

```
/* header file */
#ifdef BUILD1
typedef build1_t generic_t;
#else
typedef build2_t generic_t;
#endif

void foo(generic_t *);
void bar(generic_t *);
/* etc */ 
```

每当实际行为基于 改变时，您仍然需要在 、 等内部*使用* #ifdefs ，但您不需要在每个函数的声明和定义中使用它们。`foo``bar``BUILD1`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T18:01:01.903

为什么不这样：

```
#ifdef BUILD1
foo(build1_t *data_struct)
#else
foo(build2_t *data_struct)
#endif
{
  /* ... */
} 
```

AFAIK，该标准不要求不同的指针类型按位兼容，因此您的原始想法可能无法移植到所有可能的实现。如果原型也被使用`void*`（但在这个过程中当然会牺牲一些类型安全），那将会是这样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:04:09.997

```
struct generic_struct {
    union {
        struct specific_struct_1 struct_1;
        struct specific_struct_2 struct_2;
    };
}; 
```

这为您提供了在重叠空间中保存两个结构定义的单一类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T18:08:03.573

我建议您不要使用编译时指令来分离功能。在运行时选择；使用 if() 语句并有一些状态指示模式。

# ruby-on-rails - Mongoid Query DB by Virtual Attribute

> ID：12164876
> 
> 赞同：1
> 
> 时间：2012-08-28T17:58:43.613
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, mongoid, mongoid3

**BACKGROUND:** I have Posts and Users, both of which HABTM Communities. In my Post model, I have a method for calculating a post's relevance to a given user by comparing how many communities they have in common as such:

```
def relevance(user)
  (self.communities & user.communities).length
end 
```

**OBJECTIVE:** To query Posts either by a given relevance i.e.

```
Post.where(:relevance => 3) 
```

or

to query all posts and sort them by relevance i.e.

```
Post.all.desc(:relevance) 
```

I know that the user variable is needed there somewhere, just wondering if something like this is possible or if a workaround exists.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T23:00:05.637

[您可以使用聚合框架](http://docs.mongodb.org/manual/applications/aggregation/)（2.2 版中的新功能）在 mongoDB 中执行此操作。

您必须拥有一系列可用的用户社区。在本例中，我将其称为 userComms - 我希望它是一个具有与 posts.communities 相同类型的值的数组。

```
db.posts.aggregate( [
    {
        "$unwind" : "$communities"
    },
    {
        "$match" : {
            "communities" : {
                "$in" : userComms
            }
        }
    },
    {
        "$group" : {
            "_id" : "$_id",
            "relevance" : {
                "$sum" : 1
            }
        }
    },
    {
        "$sort" : {
            "relevance" : -1
        }
    }
]); 
```

这将返回以下形式的文档：

```
{
    "result" : [
        {
            "_id" : 1,
            "relevance" : 4
        },
        {
            "_id" : 6,
            "relevance" : 3
        },
...
        ]
} 
```

结果数组包含帖子的 _ids 和相关性，通过添加他们与用户共同拥有的社区数量来计算。然后按该总和对其进行排序（降序）。

# android - api demos/app/preferences/1.preferences from xml

> ID：12164885
> 
> 赞同：1
> 
> 时间：2012-08-28T17:59:14.003
> 
> 标签：android, xml, sharedpreferences, preferences, android-ui

I want to use "API Demos/app/preferences/1.preferences from XML" layout in my application but i don't know where to find the source files . I searched in API Demos samples but i could only find .java files not layouts.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:06:37.740

首选项 xml 位于 /res/xml 文件夹下。您可以在 apidemo 中签出 res -> xml -> preferences.xml。

# delphi - Indy 10 + Delphi 客户端-服务器应用程序占用所有 CPU

> ID：12164888
> 
> 赞同：1
> 
> 时间：2012-08-28T17:59:21.857
> 
> 标签：delphi, client-server, indy10

我编写了一个小型客户端-服务器应用程序，它运行在两台或多台不同的机器上，用于重启/关机。由于我对客户端-服务器应用程序比较陌生，因此我在[这里采用了关于 Delphi 的方法](http://delphi.about.com/od/internetintranet/l/aa012004a.htm)。简而言之，我的服务器应用程序等待端口 7676 上的连接，将客户端添加到客户端列表然后什么都不做（稍后将执行关闭和重新启动程序）。但是，即使它是被动的，它也会在仅连接两个客户端的情况下占用高达 90% 的 CPU。这是客户端代码，由 TidTCPServer 和 TidAntiFreeze 组成：

```
type
  PClient   = ^TClient;
  TClient   = record
    PeerIP      : string[15];            { Client IP address }
    HostName    : String[40];            { Hostname }
    Connected,                           { Time of connect }
    LastAction  : TDateTime;             { Time of last transaction }
    AContext      : Pointer;             { Pointer to thread }
  end;

[...]

procedure TForm1.StartServerExecute(Sender: TObject);
var
  Bindings: TIdSocketHandles;
begin

  //setup and start TCPServer
  Bindings := TIdSocketHandles.Create(TCPServer);
  try
    with Bindings.Add do
    begin
      IP := DefaultServerIP;
      Port := DefaultServerPort;
    end;
    try
      TCPServer.Bindings:=Bindings;
      TCPServer.Active:=True;
    except on E:Exception do
      ShowMessage(E.Message);
    end;
  finally
    Bindings.Free;
  end;
  //setup TCPServer

  //other startup settings
  Clients := TThreadList.Create;
  Clients.Duplicates := dupAccept;

  RefreshListDisplay;

  if TCPServer.Active then
  begin
    Protocol.Items.Add(TimeToStr(Time)+' Shutdown server running on ' + TCPServer.Bindings[0].IP + ':' + IntToStr(TCPServer.Bindings[0].Port));
  end;
end;

procedure TForm1.TCPServerConnect(AContext: TIdContext);
var
  NewClient: PClient;
begin
  GetMem(NewClient, SizeOf(TClient));

  NewClient.PeerIP      := AContext.Connection.Socket.Binding.PeerIP;
  NewClient.HostName    := GStack.HostByAddress(NewClient.PeerIP);
  NewClient.Connected   := Now;
  NewClient.LastAction  := NewClient.Connected;
  NewClient.AContext    := AContext;

  AContext.Data := TObject(NewClient);

  try
    Clients.LockList.Add(NewClient);
  finally
    Clients.UnlockList;
  end;

  Protocol.Items.Add(TimeToStr(Time)+' Connection from "' + NewClient.HostName + '" from ' + NewClient.PeerIP);
  RefreshListDisplay;
end;

procedure TForm1.TCPServerDisconnect(AContext: TIdContext);
var
  Client: PClient;
begin
  Client := PClient(AContext.Data);
  Protocol.Items.Add (TimeToStr(Time)+' Client "' + Client.HostName+'"' + ' disconnected.');
  try
    Clients.LockList.Remove(Client);
  finally
    Clients.UnlockList;
  end;
  FreeMem(Client);
  AContext.Data := nil;

  RefreshListDisplay;

end;

procedure TForm1.TCPServerExecute(AContext: TIdContext);
var
  Client : PClient;
  Command : string;
  //PicturePathName : string;
  ftmpStream : TFileStream;
begin
  if not AContext.Connection.Connected then
  begin
    Client := PClient(AContext.Data);
    Client.LastAction := Now;

    //Command := AContext.Connection.ReadLn;
    if Command = 'CheckMe' then
    begin
      {do whatever necessary in here}
    end;
  end;
end; 
```

idTCPServer 组件设置如下：ListenQueue := 15, MaxConnections := 0, TerminateWaitTime: 5000。

我在这里做错了吗？我应该采取不同的方法来一次支持大约 30 到 40 个客户吗？

谢谢，鲍勃。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T23:21:09.683

您的 CPU 使用率被固定的原因是因为您的`OnExecute`事件处理程序实际上并没有做任何事情，因此每个连接线程实际上都在运行一个紧密的循环，不会为等待 CPU 时间的其他线程产生 CPU 时间片。您需要在该事件处理程序中进行让步操作。一旦你实现了你的实际命令，那个yield将由`ReadLn()`你处理，但是在你实现之前，你可以使用一个调用来`IndySleep()`代替，例如：

```
procedure TForm1.TCPServerExecute(AContext: TIdContext); 
var 
  Client : PClient; 
  Command : string; 
  //PicturePathName : string; 
  ftmpStream : TFileStream; 
begin 
  Client := PClient(AContext.Data); 
  Client.LastAction := Now; 

  //Command := AContext.Connection.ReadLn; 
  IndySleep(10);
  //...
end; 
```

现在，话虽如此，您的代码中还有一些其他问题，例如滥用`TIdSocketHandles`、线程安全问题等。试试这个：

```
uses
  ..., IdContext, IdSync;

//...

type 
  PClient   = ^TClient; 
  TClient   = record 
    PeerIP      : String;            { Client IP address } 
    HostName    : String;            { Hostname } 
    Connected   : TDateTime;         { Time of connect } 
    LastAction  : TDateTime;         { Time of last transaction } 
    AContext    : TIdContext;        { Pointer to thread } 
  end; 

//...

procedure TForm1.StartServerExecute(Sender: TObject); 
begin 
  //setup and start TCPServer 
  TCPServer.Bindings.Clear;
  with TCPServer.Bindings.Add do 
  begin 
    IP := DefaultServerIP; 
    Port := DefaultServerPort; 
  end; 
  TCPServer.Active := True; 
  //setup TCPServer 

  //other startup settings 
  Protocol.Items.Add(TimeToStr(Time) + ' Shutdown server running on ' + TCPServer.Bindings[0].IP + ':' + IntToStr(TCPServer.Bindings[0].Port)); 
  RefreshListDisplay; 
end; 

procedue TForm1.RefreshListDisplay;
var
  List: TList;
  I: Integer;
  Client: PClient;
begin
  // clear display list as needed...
  List := TCPServer.Contexts.LockList;
  try
    for I := 0 to List.Count-1 do
    begin
      Client := PClient(TIdContext(List[I]).Data);
      if Client <> nil then
      begin
        // add Client to display list as needed..
      end;
    end;
  finally
    TCPServer.Contexts.UnlockList;
  end;
end;

type
  TProtocolNotify = class(TIdNotify)
  protected
    FStr: String;
    procedure DoNotify; override;
  public
    class procedure Add(const AStr: String);
  end;

procedure TProtocolNotify.DoNotify;
begin
  Form1.Protocol.Items.Add(FStr);
end;

class procedure TProtocolNotify.Add(const AStr: String);
begin
  with Create do
  begin
    FStr := AStr;
    Notify;
  end;
end;

type
  TRefreshListNotify = class(TIdNotify)
  protected
    procedure DoNotify; override;
  public
    class procedure Refresh;
  end;

procedure TRefreshListNotify.DoNotify;
begin
  Form1.RefreshListDisplay;
end;

class procedure TRefreshListNotify.Refresh;
begin
  Create.Notify;
end;

procedure TForm1.TCPServerConnect(AContext: TIdContext); 
var 
  NewClient: PClient; 
begin 
  GetMem(NewClient, SizeOf(TClient)); 
  try
    NewClient.PeerIP      := AContext.Connection.Socket.Binding.PeerIP; 
    NewClient.HostName    := GStack.HostByAddress(NewClient.PeerIP); 
    NewClient.Connected   := Now; 
    NewClient.LastAction  := NewClient.Connected; 
    NewClient.AContext    := AContext; 
    AContext.Data         := TObject(NewClient); 
  except
    FreeMem(NewClient);
    raise;
  end;

  TProtocolNotify.Add(TimeToStr(Time) + ' Connection from "' + NewClient.HostName + '" from ' + NewClient.PeerIP); 
  TRefreshListNotify.Refresh;
end; 

procedure TForm1.TCPServerDisconnect(AContext: TIdContext); 
var 
  Client: PClient; 
begin 
  Client := PClient(AContext.Data); 
  TProtocolNotify.Add(TimeToStr(Time) + ' Client "' + Client.HostName+'"' + ' disconnected.'); 
  FreeMem(Client); 
  AContext.Data := nil; 
  TRefreshListNotify.Refresh; 
end; 

procedure TForm1.TCPServerExecute(AContext: TIdContext); 
var 
  Client : PClient; 
  Command : string; 
  //PicturePathName : string; 
  ftmpStream : TFileStream; 
begin 
  Client := PClient(AContext.Data); 
  Client.LastAction := Now; 

  //Command := AContext.Connection.ReadLn; 
  IndySleep(10);

  if Command = 'CheckMe' then 
  begin 
    {do whatever necessary in here} 
  end; 
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T20:33:58.427

在`TCPServerExecute()`中，您没有在初始化`Command`.

你不应该`Bindings`在`StartServerExecute()`. 而是尝试这样的事情：

```
var
  sh: TidSocketHandle;
begin
  sh := TCPServer.Bindings.Add;
  sh.IP := DefaultServerIP;
  sh.Port := DefaultServerPort; 
```

是什么`StartServerExecute()`？

不幸的是，代码存在太多问题，并且缺少太多代码来猜测发生了什么。

# java - 用于操作 jar 文件的 Java 库

> ID：12164889
> 
> 赞同：1
> 
> 时间：2012-08-28T17:59:29.260
> 
> 标签：java, jar

谁能推荐一个Java库来操作**jar**文件？我发现**java.util.jar**提供的设施相当简洁（或者我可能没有一些示例代码可供查看）。我对以下内容感兴趣：

1.  将文件添加到**jar**
2.  从**jar 中删除文件**
3.  从文件夹创建**jar**文件
4.  **将jar**文件放气到文件夹中
5.  读取**jar 条目**的内容（可能在内存中，无需对磁盘上的**jar进行放气）**
6.  在内存中创建一个**jar 条目**，而无需从磁盘上的文件中读取。
7.  询问**jar**文件条目是**Manifest**文件还是其他特殊文件。

**如果有人可以使用java.util.jar**或其他一些有帮助的库指向示例代码。特别是查看**java.util.jar**的类和方法，我不清楚如何读取特定 Jar 条目的内容，甚至如何对**jar**进行放气（不产生外部进程）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:09:04.663

jar 只是[具有不同扩展名](http://en.wikipedia.org/wiki/JAR_%28file_format%29)（和清单）的 zip 文件，因此您可能会对[zip4j](http://www.lingala.net/zip4j/)或[java.util.zip](http://docs.oracle.com/javase/6/docs/api/java/util/zip/package-frame.html)等 zip 库感兴趣。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T20:41:25.937

1 & 2 是简单的手动操作，将条目从 Jar 复制到另一个添加或保留所需条目，删除原始文件并重命名新文件以替换它。

正如 jtahlbom 所指出的，Java Jar API 开箱即用地处理其余部分。

**更新示例**

这些都是非常基本的例子。他们向您展示了如何读写 Jar。基本上，您可以从中得出您需要做的所有其他事情。

我已经建立了一个个人图书馆（不包括在内），它基本上允许我传入一个`InputStream`并将其写入一个`OutputStream`，反之亦然。这意味着您可以从任何地方读取并写入任何地方，这可以满足您的大部分需求。

```
public void unjar(File jar, File outputPath) throws IOException {
    JarFile jarFile = null;
    try {
        if (outputPath.exits() || outputPathFile.mkdirs()) {
            jarFile = new JarFile(jar);
            Enumeration<JarEntry> entries = jarFile.entries();
            while (entries.hasMoreElements()) {
                JarEntry entry = entries.nextElement();
                File path = new File(outputPath + File.separator + entry.getName());
                if (entry.isDirectory()) {
                    if (!path.exists() && !path.mkdirs()) {
                        throw new IOException("Failed to create output path " + path);
                    }
                } else {
                    System.out.println("Extracting " + path);

                    InputStream is = null;
                    OutputStream os = null;
                    try {
                        is = jarFile.getInputStream(entry);
                        os = new FileOutputStream(path);

                        byte[] byteBuffer = new byte[1024];
                        int bytesRead = -1;
                        while ((bytesRead = is.read(byteBuffer)) != -1) {
                            os.write(byteBuffer, 0, bytesRead);
                        }
                        os.flush();
                    } finally {
                        try {
                            os.close();
                        } catch (Exception e) {
                        }
                        try {
                            is.close();
                        } catch (Exception e) {
                        }
                    }
                }
            }
        } else {
            throw IOException("Output path does not exist/could not be created");
        }
    } finally {
        try {
            jarFile.close();
        } catch (Exception e) {
        }
    }
}

public void jar(File jar, File sourcePath) throws IOException {
    JarOutputStream jos = null;
    try {
        jos = new JarOutputStream(new FileOutputStream(jar));

        List<File> fileList = getFiles(sourcePath);
        System.out.println("Jaring " + fileList.size() + " files");

        List<String> lstPaths = new ArrayList<String>(25);
        for (File file : fileList) {
            String path = file.getParent().replace("\\", "/");
            String name = file.getName();

            path = path.substring(sourcePath.getPath().length());
            if (path.startsWith("/")) {
                path = path.substring(1);
            }

            if (path.length() > 0) {
                path += "/";
                if (!lstPaths.contains(path)) {
                    JarEntry entry = new JarEntry(path);
                    jos.putNextEntry(entry);
                    jos.closeEntry();
                    lstPaths.add(path);
                }
            }

            System.out.println("Adding " + path + name);

            JarEntry entry = new JarEntry(path + name);
            jos.putNextEntry(entry);

            FileInputStream fis = null;
            try {
                fis = new FileInputStream(file);
                byte[] byteBuffer = new byte[1024];
                int bytesRead = -1;
                while ((bytesRead = fis.read(byteBuffer)) != -1) {
                    jos.write(byteBuffer, 0, bytesRead);
                }
                jos.flush();
            } finally {
                try {
                    fis.close();
                } catch (Exception e) {
                }
            }
            jos.closeEntry();
        }
        jos.flush();
    } finally {
        try {
            jos.close();
        } catch (Exception e) {
        }
    }
} 
```

如果您花时间看，有许多示例说明如何从 SO 上的 zip/jar 文件中添加/删除条目

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T18:27:34.047

[TrueZip](http://truezip.java.net/)似乎是一个非常全面的 zip 库。

顺便说一句，我很确定 jdk jar API 可以很容易地处理 3-7。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-28T18:08:44.493

也许[Apache Commons Compress](http://commons.apache.org/compress/)可以在这里为您提供帮助。

# ruby-on-rails - 使用 MongoDB 和 Rails 进行锦标赛数据建模

> ID：12164894
> 
> 赞同：0
> 
> 时间：2012-08-28T18:00:04.563
> 
> 标签：ruby-on-rails, mongodb, mongoid

我正在使用 ROR、MongoDB 和 Mongoid 开发一个应用程序。

我的应用程序有两个模型：`team`和`match`. 该模型`match`有两个文档`away_home`和`home_team`. 我的问题是：我如何建立和之间的`teams`关系`match`？

我应该使用`has_and_belongs_to_many`吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T20:51:36.443

您为什么不尝试将两个团队作为嵌入式文档？

例如，您可以执行以下操作：

```
class Match
  include Mongoid::Document
  embeds_one :away_team, :class_name => "Team"
  embeds_one :home_team, :class_name => "Team"
end

class Team
  include Mongoid::Document
  field :name, type: String
  embedded_in :match
end 
```

那么你可以像这样创建比赛：

```
> m = Match.new
> t = Team.new
> m.away_team = t
> m.away_team.name = "yankees"
> m.save
> t = Team.new
> m.home_team = t
> m.home_team.name = "blue jays"
> m.save 
```

您的文档将如下所示

```
> db.matches.find().pretty()
{
    "_id" : ObjectId("503d2e123005c811cc000001"),
    "away_team" : {
        "_id" : ObjectId("503d2e143005c811cc000002"),
        "name" : "yankees"
    },
    "home_team" : {
        "_id" : ObjectId("503d2e303005c811cc000003"),
        "name" : "blue jays"
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-28T23:12:08.010

@Emily S 解决方案可以工作，但是如果您打算直接为团队查询很多内容，那将会很麻烦，因为您正在查询嵌入式文档，最好将它们作为根文档。

这里有一篇关于 SO 的非常相似的帖子[Mongoid - 同一个外国字段的两个字段逆](https://stackoverflow.com/questions/8191688/mongoid-two-fields-inverses-of-the-same-foreign-field)

如果这对你不起作用，我碰巧也有球队和比赛:)。我所做的，因为在我的情况下，团队 ID 是静态的，我有两个字段用于主队和客队，索引它们，并使用它们来查询我需要的团队。也许不是最好的解决方案，但它确实有效。

# android - 应用内购买出现奇怪的错误

> ID：12164895
> 
> 赞同：0
> 
> 时间：2012-08-28T18:00:05.717
> 
> 标签：android, in-app-purchase, android-billing

我的一个应用程序中的应用程序内购买存在一个奇怪的问题。几个月前它工作得很好......

当我尝试在我的应用程序中使用自己的真实手机 (android 2.3.5) 进行购买时，Google Play 会打开，然后显示一个消息框“您已经拥有此商品”。我签入了我的 Google 结帐帐户，但我之前没有购买它（事实上我几个月前就进行了测试，但我总是取消订单）。

此消息框上有两个按钮：

*   好的：我回到我的应用程序
*   详细信息：嗯...它只会让 Google Play 崩溃！

此消息框由 Google Play 显示，而不是由我的应用程序显示。有没有人已经遇到过这个问题？我通过应用内购买检查了其他一些应用，它们可以正常工作。而且我仍然收到我的应用内购买订单，所以似乎它只发生在我身上......

我正在使用 Robomedia AndroidBillingLibrary：[https ://github.com/robotmedia/AndroidBillingLibrary](https://github.com/robotmedia/AndroidBillingLibrary)

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T18:05:28.103

这一定是谷歌方面的问题，他们一定已经解决了，因为它现在有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T03:39:24.377

我可以通过转到“Google Play”的应用信息并清除缓存和数据来解决这个问题。GP 似乎在设备上缓存了购买信息，并且很少检查购买是否已退款。我会推荐人

# r - 在 Excel 中快速查看 R data.frame、vector 或 data.table

> ID：12164897
> 
> 赞同：16
> 
> 时间：2012-08-28T18:00:15.687
> 
> 标签：r, dataframe, data.table

如何在 Excel 中快速打开小型 R 表/矢量对象？

例如，假设您有以下三个要在 Excel 中查看的对象：

```
## A data frame with commas and quotes
df = data.frame(
  area = unname(state.x77[,'Area']),
  frost = unname(state.x77[,'Frost']),
  comments = "Ok for a visit, but don't want to live there",
  challengeComments = c('"', '""'))
row.names(df) = state.name
df = df[1:10, ]
df['California', 'comments'] = "Would like to live here"

## A Matrix
mat = matrix(rnorm(100), 10)

## A Vector
v = 1:10 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-28T18:00:15.687

我写了这个函数来完成这个任务。我称之为“写临时文件”或“wtf”。如果您有与 Excel 关联的 csv 文件，它仅适用于 Windows。

您可以查看 PBSmodelling::openFile 中的代码，了解如何将其应用于不同的操作系统。

```
wtf = function (x) {
  tempFilePath = paste(tempfile(), ".csv")
  tempPath = dirname(tempFilePath)
  preferredFile = paste(deparse(substitute(x)), ".csv", sep = "")
  preferredFilePath = file.path(tempPath, preferredFile)

  if(length(dim(x))>2){
    stop('Too many dimensions')
  }
  if(is.null(dim(x))){
    x = as.data.frame(x)
  }
  if (is.null(rownames(x))) {
    tmp = 1:nrow(x)
  }else {
    tmp = rownames(x)
  }
  rownames(x) = NULL
  x = data.frame(RowLabels = tmp, x)
  WriteAttempt = try(
    write.table(x, file=preferredFilePath, quote=TRUE, sep=",", na="",
                row.names=FALSE, qmethod="double"),
    silent = TRUE)
  if ("try-error" %in% class(WriteAttempt)) {
    write.table(x, file=tempFilePath, , quote=TRUE, sep=",", na="",
                row.names=FALSE, qmethod="double")
    shell.exec(tempFilePath)
  } else {
    shell.exec(preferredFilePath)
  }
}

wtf(df)
wtf(mat)
wtf(v) 
```

如果您多次打开同一个对象，由于错误处理，它仍然可以工作，但它会有一个混乱的临时名称。

```
wtf(df)
df$MoreData = pi
wtf(df) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-18T07:01:03.350

我编写了一个函数来在 Libre Office Calc 或 Excel 中打开文件。[详情请看这里](http://jeromyanglim.tumblr.com/post/33825729070/function-to-view-r-data-frame-in-spreadsheet)。

```
view <- function(data, autofilter=TRUE) {
    # data: data frame
    # autofilter: whether to apply a filter to make sorting and filtering easier
    open_command <- switch(Sys.info()[['sysname']],
                           Windows= 'open',
                           Linux  = 'xdg-open',
                           Darwin = 'open')
    require(XLConnect)
    temp_file <- paste0(tempfile(), '.xlsx')
    wb <- loadWorkbook(temp_file, create = TRUE)
    createSheet(wb, name = "temp")
    writeWorksheet(wb, data, sheet = "temp", startRow = 1, startCol = 1)
    if (autofilter) setAutoFilter(wb, 'temp', aref('A1', dim(data)))
    saveWorkbook(wb, )
    system(paste(open_command, temp_file))
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-11-21T14:43:36.063

I wanted something that mimicked View() but in Excel, not in the internal view of RStudio. Learned little bits from numerous posts above. Eventually came to a pretty simple little bit of code that....so far... seems to do the trick for me.
Just want to quickly view it, but in Excel. If I decide I want to save the file, I can handle that within Excel. Otherwise it just automatically create a temp file in the default temp directory for that session of R. It's setup to act on the .Last.value of the R session as a default, or you pipe in an object that can be coerced to a data frame

I just have it defined in my R profile so its always available. Might make more sens to name it ViewExt for "View External" so as to not link it directly to Excel but whatever program of choice the user has set in Windows to be the default editor for a .csv file. But thats what I use so that's what I named it

```
 ViewExcel <- function(df = .Last.value, file = tempfile(fileext = ".csv")) {
       df <- try(as.data.frame(df))
       stopifnot(is.data.frame(df))
       utils::write.csv(df, file = file)
       base::shell.exec(file)
    }

    #Examples
    mtcars
    ViewExcel()
    mtcars %>% ViewExcel()
    ViewExcel(mtcars) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T22:01:17.567

对不起无耻的广告......你可以试试我的包[http://cran.r-project.org/web/packages/excel.link/index.html](http://cran.r-project.org/web/packages/excel.link/index.html "excel.link") 它看起来像：

```
library(excel.link)
xlrc[a1]=df 
```

它依赖于 Omegahat RDCOMClient 包，因此有必要从源代码安装它：

```
install.packages("RDCOMClient", repos = "http://www.omegahat.org/R")
install.packages("excel.link", repos = "http://cran.at.r-project.org",type="source") 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-11T03:51:30.523

我经常使用它来将数据表粘贴到 Excel 中：

```
write.table(x, "clipboard", row.names=F, sep='\t') 
```

并将 Excel 中的（子）表复制到 R 中，执行以下操作（假设表有标题行）：

```
read.csv('clipboard', sep='\t') 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2022-01-03T18:02:55.693

使用`view_in_xl`viewxl 包中的函数。这相当于在 RStudio 中使用 F4 键盘快捷键。

```
viewxl:::view_in_xl(x) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-06-01T03:22:05.403

`geneorama`的解决方案很棒，但是使用`write.table`会很慢。您可以将其更改`fwrite`为[data.table 包](https://cran.r-project.org/web/packages/data.table/index.html)。

这个解决方案有用的主要原因（至少对我来说）是因为大数据帧`View`很*糟糕*。我`geneorama`用 15600 obs 的数据框测试了 的解决方案。通过 1270 个变量，它在 16 秒后打开。`fwrite`0.6秒后打开的版本！

这是修改后的功能：

```
wtf = function (x) {
  tempFilePath = paste(tempfile(), ".csv")
  tempPath = dirname(tempFilePath)
  preferredFile = paste(deparse(substitute(x)), ".csv", sep = "")
  preferredFilePath = file.path(tempPath, preferredFile)

  if(length(dim(x))>2){
    stop('Too many dimensions')
  }
  if(is.null(dim(x))){
    x = as.data.frame(x)
  }
  if (is.null(rownames(x))) {
    tmp = 1:nrow(x)
  }else {
    tmp = rownames(x)
  }
  rownames(x) = NULL
  x = data.frame(RowLabels = tmp, x)
  WriteAttempt = try(
    data.table::fwrite(x, file=preferredFilePath, quote=TRUE),
    silent = TRUE)
  if ("try-error" %in% class(WriteAttempt)) {
    data.table::fwrite(x, file=tempFilePath, quote=TRUE)
    shell.exec(tempFilePath)
  } else {
    shell.exec(preferredFilePath)
  }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-26T15:52:43.153

我为windows写了一个函数。但可能它也适用于其他操作系统。

它在 C:\Users\...\Documents\Rview 中创建临时文件，并使用 browseURL() 打开它们。您最多可以同时打开 99 个文件。您可以通过参数“名称”轻松选择应显示的暗名称。该函数将在 col/rownames 的 +,-,= 之前添加 '，以便在 Excel 中正确显示。

我个人更喜欢使用 Sys.getenv("TMP") 而不是使用 tempfile() 的解决方案，因为 tempfile() 会在一段时间后弄乱您的临时文件夹。

有关详细信息，请参阅代码顶部的参数描述。

```
# This function creates a CSV file from a data.frame/matrix and opens it with the default CSV-opening-program
# of the computer.
#
# x = data.frame/matrix
# names = dimnames to be saved in the file. "col"=colnames, "rowcol"=rownames&colnames, "row"=rownames, "no"=no dimnames
# nrows = maximum number of rows    to be saved (for higher speed with large datasets)
#         if n=-1, all rows will be displayed.-> see also the help for read.table()
# ncols = maximum number of columns to be saved (for higher speed with large datasets)
# folder = directory, where the temporary file should be saved.
#          If NULL an accessible folder in C:/Users/.../Documents will be created automatically.
# quote = should quotes be written into the csv File? -> see also the help for write.table()
# na = how should NA values be displayed in the csv File? -> see also the help for write.table()
# openfolder = Should the folder with all temporary files be opened after having created the file?

view <- function(x, names=c("col","rowcol","row","no"), nrows=10000, ncols=1000, folder=NULL, quote=FALSE, na="NA", openfolder=FALSE, ...){

  names <- match.arg(names)
  if(is.null(dim(x))) {
    x <- as.matrix(x)
  }
  if(is.null(colnames(x))) colnames(x) <- paste0("V",1:ncol(x))

  if(nrows<0) nrows <- nrow(x)
  if(ncols<0) ncols <- ncol(x)
  # Shrink data.frame such that it can be saved & viewed faster.
  nrows <- min(nrow(x), nrows)
  if(nrows!=nrow(x)) x <- x[1:nrows,,drop=FALSE]
  ncols <- min(ncol(x), ncols)
  if(ncols!=ncol(x)) x <- x[,1:ncols,drop=FALSE]

  # Define paths
  # If is.null(folder), wird ein temporaerer Ordner im Windows-Dateisystem angelegt.
  if(is.null(folder)) {
    folder <- paste0(Sys.getenv("TMP"), "\\Rview")
    suppressWarnings( dir.create(folder) )
  }  

  # Wenn am Schluss des Pfades kein "/" angefuegt wurde, wird dies gemacht:
  if( !substr(folder,nchar(folder),nchar(folder))%in%c("/","\\") ) folder <- paste0(folder, "\\")
  pfad0 <- folder
  name <- "Rview_tmp"
  nr <- "01"
  csv <- ".csv"

  # Check if there are existing files in the folder
  fil <- list.files(pfad0)
  # If there are no files in the folder, use the default save path.
  if(length(fil)==0){
    pfad1 <- paste0(pfad0, name, nr, csv)
  } else {
    # Remove all files in the folder (if possible)
    fil <- paste0(pfad0, fil)
    suppressWarnings( try( file.remove( fil )  , silent=TRUE) )
    fil <- list.files(pfad0)
    # If there are no files anymore use the default save path.
    if( length(fil)==0 ) {
      pfad1 <- paste0(pfad0, name, nr, csv)
    } else {
      # If there are sill files, read out the number of the newest file (with the highest number)
      ncharfil <- nchar(fil)
      mx <- max( as.numeric( substr(fil,ncharfil-5,ncharfil-4) ) )
      # Add 1 to the number of the file
      mxpl1 <- as.character( mx+1 )
      if(nchar(mxpl1)==1) mxpl1 <- paste0("0",mxpl1)
      # Create a new path
      pfad1 <- paste0(pfad0, name, mxpl1, csv)
    }
  }

  # Rownames und colnames, die mit +, - oder = anfangen, mit ' am Anfang versehen, dass es von Excel richtig dargestellt wird
  rn1 <- rownames(x)
  cn1 <- colnames(x)
  ind <- substr(rn1,1,1)%in%c("+","-","=")
  if(any(ind)) rownames(x)[ind] <- paste0(" ",rn1[ind])
  ind <- substr(cn1,1,1)%in%c("+","-","=")
  if(any(ind)) colnames(x)[ind] <- paste0(" ",cn1[ind])

  # Write CSV file & open.
  if(names=="row") {
    # If the first cell of the file is named "ID" Microsoft Excel warns that a SYLK file is opened. Therefore it is renamed.
    if(rownames(x)[1]=="ID") rownames(x)[1] <- "lD"
    write.table(x, file=pfad1, sep = ";", col.names=FALSE, row.names=TRUE, quote=quote, na=na, ...)
  } else if (names=="col") {
    # If the first cell of the file is named "ID" Microsoft Excel warns that a SYLK file is opened. Therefore it is renamed.
    if(colnames(x)[1]=="ID") colnames(x)[1] <- "lD"
    write.table(x, file=pfad1, sep = ";", col.names=TRUE, row.names=FALSE, quote=quote, na=na, ...)
  } else if (names=="rowcol") {
    write.table(x, file=pfad1, sep = ";", col.names=NA)                    # Colnames & Rownames
  } else {
    write.table(x, file=pfad1, sep = ";", col.names=FALSE, row.names=FALSE, quote=quote, na=na, ...)
  }

  browseURL(pfad1)
  if(openfolder) {
    Sys.sleep(1)
    browseURL(folder)
  }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-16T20:57:53.153

不完全回答这个问题，因为这不仅限于 Excel，但这里有一个简单的函数（受其他一些答案的启发），它从对象创建一个临时 csv 文件并将其路径复制到剪贴板（使用 package `clipr`）。

这允许通过简单地键入所选应用程序的名称并将剪贴板的内容粘贴到命令行中来快速可视化任何应用程序中的对象（例如[sc-im 、Libreoffice calc、Excel、Gnumeric 等）。](https://github.com/andmarti1424/sc-im/tree/freeze/src)

```
ext <- function(data) {
    file_name <- tempfile(fileext = ".csv")
    file <- write.csv(data, file_name)
    clipr::write_clip(paste(file_name))
} 
```

我最初使用这个是因为我很难`sc-im`从 R 中打开一个文件`system()`，但最后，我发现能够选择我想用来可视化临时文件的应用程序非常方便：取决于我想探索的对象，一个或另一个应用程序可能更合适。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2012-08-28T19:48:10.183

`write.csv(x, "clipboard")`在excel中使用和粘贴。

# php - php将文本文件写入windows文件服务器

> ID：12164903
> 
> 赞同：0
> 
> 时间：2012-08-28T18:00:37.653
> 
> 标签：php, drupal, file-io

Php 不是我的强项，我遇到了一个我不明白的错误。我正在使用 PHP 5.2，而 drupal 6 正在使用这些内容调用 php 函数。

我可以成功地将文件写入运行此脚本的服务器，但不能写入需要该文件的另一个 Windows（文件）服务器。

这是我的php代码：

```
try{
    $outputFile = "//myserver/dir1/dir2/dir_with_everybody_write_permission/print.txt";
    $fh = fopen($outputFile, 'w');
    $filecontents = "script to be written";
    fwrite($fh, $filecontents);
    fclose($fh);
} catch (Exception $e) {
    form_set_error('', t('File Write Error'));
} 
```

我的错误：

```
[function.fopen]: failed to open stream: No such file or directory in C:\web\apache\htdocs\sites\all\modules\dirA\X.module on line 161.
warning: fwrite(): supplied argument is not a valid stream resource in C:\web\apache\htdocs\sites\all\modules\dirA\X.module on line 164.
warning: fclose(): supplied argument is not a valid stream resource in C:\web\apache\htdocs\sites\all\modules\dirA\X.module on line 165\. 
```

为什么无法打开文件流？

谢谢您的考虑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:04:17.043

> 没有相应的文件和目录

我会说您正在写入错误的目录。

# ubuntu - x11：有没有办法从浏览器窗口 id 知道正在浏览哪个 URL？

> ID：12164906
> 
> 赞同：0
> 
> 时间：2012-08-28T18:00:43.563
> 
> 标签：ubuntu, browser, window, x11

无论如何，从浏览器窗口 id 知道正在浏览哪个 URL。我正在使用 X 窗口系统开发 Ubuntu 系统。我是 X 窗口编程的新手。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:21:45.153

从理论上讲，您可以通过找到特定的 xwindow 来从浏览器中获取文本，因为所有其他 xwindows 都可以完全访问所有 xwindows，因此您将沿着一条黑暗的道路进入 X 内部。相信我，里面很乱。

更简单的方法是查看浏览器是否具有允许您访问这些信息的 API。我很确定任何基于 QTs/webkit 的东西都会允许这样做（Chrome、Safari、Konqueror），我相信 FF 也有这个功能。或者，您可以通过代理路由请求并在那里捕获数据。

因此，简短的回答是肯定的，您可以通过浏览 XWindows 和 XAtoms 来做到这一点，但是有更简单的方法来收集这些信息。

# python - 根据其社交分享数（fb+ twitter + gplus）订购网站的内容

> ID：12164910
> 
> 赞同：1
> 
> 时间：2012-08-28T18:01:01.513
> 
> 标签：python, django

我对我的 django 网站有要求。

有没有办法根据我的网站的 fb 喜欢 + twitter 分享计数 + gplus 计数 + 等来订购我网站的内容。

我可以使用的任何 api。

我在新的 digg 网站上看到了这个功能。他们似乎已经汇总了故事的计数 fb + twitter + digg)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:04:00.020

如果您不必在后端执行，您可以使用 Javascript。

只需使用 API 阅读 facebook likes，然后对 div 进行排序。

# outputstream - 如何将 int 打印到 std::wcerr？

> ID：12164916
> 
> 赞同：0
> 
> 时间：2012-08-28T18:01:12.257
> 
> 标签：outputstream, widestring

`operator<<`如果我的对象需要打印 a`std::wstring`以及 ints 等，我该如何编写输出？

```
#include <iostream>

struct Foo {
  int i;
  std::wstring wstr;
};

std::ostream& operator<<(std::ostream& out, Foo const& foo) {
  out << foo.i << foo.wstr; // error                                                                                            
  return out;
}

int main() {
  Foo foo;
  std::wcerr << foo << std::endl;
} 
```

换句话说：`int`如果我通过 a ，我如何打印 s 和其他原始数据类型`wcerr`？我需要`boost::lexical_cast<std::wstring>`或类似的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:05:32.580

```
#include <iostream>

struct Foo {
   int i;
   std::wstring wstr;
};

std::wostream& operator<<(std::wostream& out, Foo const& foo) {
   out << foo.i << foo.wstr;                                                                                             
   return out;
}

int main() {
   Foo foo;
   std::wcerr << foo << std::endl;
} 
```

# groovy - 从一个 catch 块返回

> ID：12164923
> 
> 赞同：1
> 
> 时间：2012-08-28T18:01:37.260
> 
> 标签：groovy

我很困惑为什么即使捕获到异常，此方法也总是返回......它不应该在记录错误后返回吗？

```
private def sendConfCode(sendTo)
    {

        def confCode = genConfCode()
        try
        {
            mail.sendMessage(sendTo.toString(), "Your confirmation code is", confCode)
            //insert confCode into temporary banner table?
        }
        catch(Exception e)
        {
            logIt.writeLog(e.message, Priority.ERR)
        }
        return confCode + " - " + sendTo
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:07:49.197

是的，它应该在记录错误后返回，如果确实抛出了异常，这可能是您的记录器配置中的错误。

如果您想在 catch 块中停止执行，请从那里返回

```
private def sendConfCode(sendTo)
    {

        def confCode = genConfCode()
        try
        {
            mail.sendMessage(sendTo.toString(), "Your confirmation code is", confCode)
            //insert confCode into temporary banner table?
        }
        catch(Exception e)
        {
            logIt.writeLog(e.message, Priority.ERR)
            return
        }
        return confCode + " - " + sendTo
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:15:32.107

正确代码：

```
private def sendConfCode(sendTo)
    {

        def confCode = genConfCode()
        def sent=false
        try
        {

            mail.sendMessage(sendTo.toString(), "Your confirmation code is", confCode)
            //insert confCode into temporary banner table?
            sent = true
        }
    catch(Exception e)
    {
        logIt.writeLog(e.message, Priority.ERR)
    }
    return sent

} 
```

# excel - 如何使用 VBA 和后期绑定（无 ADO、无 DAO）将 Excel 数据移动到 Access - DoCmd.TransferSpreadsheet 运行时错误 424？

> ID：12164924
> 
> 赞同：2
> 
> 时间：2012-08-28T18:01:40.113
> 
> 标签：excel, vba, ms-access, late-binding, import-from-excel

我正在尝试创建一个宏，它会定期将 Excel 中的 25,000 - 35,000 行移动到 Access 数据库中。据我了解，如果我在使用宏的人拥有不同版本的 Excel 和 Access（我碰巧使用的是 2007）的环境中工作，我最好使用后期绑定，因为它避免了不同参考的问题和版本等 - 一旦它起作用，它就会起作用（即使它更慢）。

我正在尝试让以下代码在 Excel VBA 中工作：

```
Sub TransferToDB()
Dim acApp As Object

ssheet = "C:\Documents and Settings\yk\Desktop\Open Invoice Summary 322 - 2012-07-17.xlsx"
ssrange = "AllData!A1:M28323"

Set acApp = CreateObject("Access.Application")
    acApp.OpenCurrentDatabase ("C:\Documents and Settings\yk\Desktop\Open Invoice Summary.accdb")
    acApp.Visible = True
    acApp.UserControl = True
    DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, OpenInvoices, ssheet, True, ssrange
    acApp.CloseCurrentDatabase
    acApp.Quit
Set acApp = Nothing

End Sub 
```

当宏到达 DoCmd.TransferSpreadsheet 行时，它会因错误而停止：

> 运行时错误 424：
> 
> 所需对象

Excel 中的此例程从另一个例程调用，该例程从大型工作簿中的许多工作表中收集信息，并将其全部转储到该工作簿中名为“AllData”的工作表中。我一直在网上看到对此 DoCmd.TransferSpreadsheet 方法的引用，但我似乎找不到任何有效的剪切和粘贴代码......

1.  为什么程序在那个时候总是崩溃？
2.  甚至可以在不使用 ADO 或 DAO 的情况下将日期从 Excel 传输到 Access？
3.  后期绑定确实可以防止问题，还是使用 ADO 更好？

谢谢 - 非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T18:41:15.217

这感觉有点明显，但我相信您的错误消息的实际原因是：

DoCmd 是一个对象。这是帮助文件中的一个尝试`Application.DoCmd Property`

> 您可以使用 DoCmd 属性访问只读 DoCmd 对象及其相关方法。只读 DoCmd。句法
> 
> 表达式.DoCmd
> 
> 表达式 表示应用程序对象的变量。

换句话说，您需要使用`acApp.DoCmd`而不仅仅是`DoCmd`. 否则，您的代码无法知道是什么`DoCmd`意思，因为它不是 Excel 的一部分。

我现在也将插话其他问题。

1.  我敢肯定，虽然我不知道 Docmd.TransferSpreadSheet 是如何实现的，它可能会在没有用户参与的情况下使用 DAO 或 ADO。

2.  如果您使用 VBA 实施任何使用不同 Office 应用程序的解决方案，**如果**您的 Office 版本比您的任何用户都新，则通常需要后期绑定。以我的经验，早期绑定适用于从 2003 年升级到 2010 年，但是一旦你做出了改变，你就不能回去了。对旧版 VBA 的任何更新都会自动更新对当前引用的引用并破坏版本兼容性。因此，如果您在用户之前使用早期绑定和更新，则需要切换到后期绑定或停止支持您的系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T18:19:08.083

如果没有 Access 类型库的引用集，Excel 将不知道 Access 命名常量`acImport`和`acSpreadsheetTypeExcel9`. 对于 TransferSpreadsheet 方法，使用这些常量的值而不是它们的名称。

如果 OpenInvoices 是文字 Access 表名称，请添加引号。但是，如果 OpenInvoices 是包含 Access 表名称的变量的名称，则不需要引号。

```
DoCmd.TransferSpreadsheet 0, 8, "OpenInvoices", ssheet, True, ssrange 
```

因此，要回答您问题的三个部分：

1.  我怀疑它在 OpenInvoices 周围没有引号就崩溃了，因为 Excel 没有找到名为 OpenInvoices 的变量，因此试图不提供`TransferSpreadsheet`任何表名。
2.  是的，有点。我认为您的`TransferSpreadsheet`方法应该适用于这些答案中建议的修订。但是，我也认为`TransferSpreadsheet` 使用 DAO。
3.  后期绑定可以防止某些类型的问题。但是您必须使用相应常量的值而不是它们的名称，或者在您的过程中将它们重新定义为常量。后期绑定与 ADO 对我来说是一个令人困惑的问题。这不是非此即彼的事情……当我使用 ADO 时，我几乎总是使用后期绑定来避免由于与特定 ADO 版本的早期绑定而导致的部署问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:18:34.267

表名应该是一个字符串。

```
acSpreadsheetTypeExcel9 = 8
acImport = 0
DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel9, _
    "OpenInvoices", ssheet, True, ssrange 
```

# json - 使用 Json.net 和 Web API

> ID：12164925
> 
> 赞同：0
> 
> 时间：2012-08-28T18:01:41.923
> 
> 标签：json, asp.net-web-api, json.net

经过一番争论，我终于让我的 Json 结果在我的 web api 中为具有关联的类正常工作：

```
 public string GetAll()
    {
        var order =_repository.GetAll();
        var settings = new JsonSerializerSettings
               {
                   ReferenceLoopHandling = ReferenceLoopHandling.Ignore
               };

        return JsonConvert.SerializeObject(order, settings);

    } 
```

但是当我在浏览器或 Fiddler 中进行测试时，而不是典型的类似：

（一种）

```
 "Books":
        [  
           {    
             "Id": "1",  
             "Name": "Book1", 
             "Authors": 
                [
                  { 
                    ....... 
                  }
               ]  
           } 
       ] 
```

(B) 我明白了：

"[{\"Id\":1,\"Name\":\"Book1\",\"Authors\":[{\"Id\":1,\"PersonId\":1,\"Person \":null,\"Books\":[{\"Id\":3,\"Name\":\"Book3\",\"Authors\":[{\"Id\":4,\ "PersonId\":4,\"Person\":null,\"Books\":[{\"Id\":2,\"Name\":\"Book2\",\"Authors\":[ {\"Id\":2,\"PersonId\":2,\"Person\":null,\"Books\": .....

有人可以告诉我我必须做什么才能像上面的 A. 那样格式化它吗？

谢谢

更新：

顺便说一句，Formatting.Indented 使情况变得更糟：

"[\r\n {\r\n \"Id\": 1,\r\n \"Name\": \"Book1\",\r\n \"Authors\": [\r\n {\r\n \"Id\": 1,\r\n \"PersonId\": 1,\r\n \"Person\": {\r\n \"Id\": 1,\r \n \"FirstName\": \"John\",\r\n \"LastName\": \"Doe\"\r\n },\r\n \"Books\": [\r\n {\r\n \"Id\": 3,\r\n \"Name\": \"Book3\",\r\n \"Authors\": [\r\n {\r\n \ "Id\": 4,\r\n \"PersonId\": 4,\r\n \"Person\": {\r\n \"Id\": 4,\r\n \"FirstName\ ":\"朱莉\",\r\n

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T20:16:37.153

传统方法是您的 API 控制器返回一个`HttpResponseMessage`或一个集合对象，而**不是**已经序列化的对象。这些`MediaTypeFormatter`对象会为你处理好这些。

看起来正在发生的事情是您的控制器正在返回一个字符串，*然后*将其转换为 JSON 表示形式（因为`MediaTypeFormatter`for JSON）。尝试更改您的控制器以仅返回对象集合（而不将其序列化为字符串），它应该适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:14:15.520

settings.Formatting = Formatting.Indented;

只是好奇...为什么您使用 JsonMediaTypeFormatter 来处理写入响应？...我看到您正在将其显式序列化为 json...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T00:55:39.993

我认为这里的问题是 JSON 被序列化了两次，一次是你，一次是 WebAPI。删除您的序列化，一切都应该没问题。

# file - Monotorrent 传输文件

> ID：12164927
> 
> 赞同：0
> 
> 时间：2012-08-28T18:01:56.013
> 
> 标签：file, transfer, monotorrent

我想在项目中使用 monotorrent 在两台计算机之间传输文件。不幸的是，我找不到有关如何执行此操作的文档。更确切地说，有一个关于如何使用这个库下载文件的源代码示例，但我找不到关于如何使用它上传文件的示例。是否有一些代码示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T08:08:32.577

该问题与创建洪流时添加的层有关。看来他们必须以`announce/`

```
RawTrackerTier tier = new RawTrackerTier();
tier.Add("http://127.0.0.1:10000/announce/"); 
```

# sql - oracle 11g sql查询从连接的两个表中获取数据

> ID：12164932
> 
> 赞同：2
> 
> 时间：2012-08-28T18:02:16.333
> 
> 标签：sql, database, join, oracle11g

我有两个表 ACTUAL 和 ESTIMATE 具有唯一列（sal_id、gal_id、amount、tax）。

在 ACTUAL 表中，我有

```
actual_id, sal_id, gal_id, process_flag, amount, tax    
1          111     222     N             100     1  
2          110     223     N             200     2 
```

在 ESTIMATE 表中，我有

```
estimate_id, sal_id, gal_id, process_flag, amount, tax      
3            111     222     N             50      1  
4            123     250     N             150     2 
5            212     312     Y             10      1 
```

现在我想要一个最终表，它应该有来自 ACTUAL 表的记录，如果 ACTUAL 中不存在 sal_id+gal_id 映射的记录但存在于 ESTIMATE 中，则填充估计记录（以及添加金额和税款）。

在 FINAL 表中

```
id  sal_id, gal_id, actual_id, estimate_id, total   
1   111     222     1          null         101 (since record exist in actual table for 111 222)   
2   110     223     2          null         202 (since record exist in actual table for 110 223)  
3   123     250     null       4            51  (since record not exist in actual table but estimate exist for 123 250) 
```

（估计为212 312组合，由于记录已经处理，无需再次处理）。

我正在使用 Oracle 11g。请帮助我在单个 sql 查询中编写逻辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T18:38:53.763

这是一个[SQLFiddle 示例](http://sqlfiddle.com/#!4/1f018/7)

```
select sal_id,gal_id,actual_id,null estimate_id,amount,tax from actual where process_flag='N' 
union all
select sal_id,gal_id,null actual_id,estimate_id,amount,tax from estimate where process_flag='N' and
(sal_id,gal_id) not in (select sal_id,gal_id from actual where process_flag='N') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:42:01.157

这是执行此操作的一种方法，即从 Actual 中获取所有内容，然后仅在 Estimate 中获取不在 Actual 中的内容：

```
select a.*
from Actual a
union all
select e.*
from Estimate e
where not exists (select 1 from actual a where a.sal_id = e.sal_id and a.gal_id = e.gal_id) and
      e.process_flag = 'N' 
```

如果您有大量数据，这可能不是最有效的方法。但它应该适用于较小的数据集。

# c# - 我试图跟踪内存泄漏，它做我想要的吗？

> ID：12164934
> 
> 赞同：4
> 
> 时间：2012-08-28T18:02:22.707
> 
> 标签：c#, .net, memory-management, windows-ce

我有一个由多个组件组成的应用程序，每个组件都编译成单个 DLL，每个组件都在其内部运行多个线程。我有一个启动这些组件的 shell 程序。

我在 Windows CE 6 环境中运行这个应用程序，这是它上面唯一的程序（除了系统的程序）。但是，随着时间的推移，当我查看任务管理器窗口时，我发现分配的内存使用量缓慢增加。怀疑我的程序可能有内存泄漏，我执行以下操作。

我转到一个特定组件并创建一个每 30 分钟运行一次的 Timer 对象，该对象调用以下代码：

```
long memByte = GC.GetTotalMemory(false);
Console.Write("Heap Memory: " + (memByte/1000).ToString() + "KB"); 
```

通过在互联网上阅读，我认为 GetTotalMemory 基本上为我提供了系统的总管理内存。如果我的程序没有内存泄漏问题，那么我怀疑在绘制结果时我会得到某种类型的平线。否则我会看到一个缓慢的增长。

我的问题是，GetTotalMemory 实际上给了我所有应用程序的总管理堆内存，还是只给了运行此代码的当前组件正在使用的特定堆？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:38:30.173

任务管理器向您显示 GC.GetTotalMEmory 的不同信息。制作一个具有 GC.GetTotalMemory 的应用程序是很有可能的，但它会慢慢地使设备耗尽内存并崩溃。

GC.GetTotalMemory 只查看 GC 堆，而不是分配的虚拟或物理内存。GCHeap 之外的 P/Invokes 和本机分配将对 GC.GetTotalMemory 调用透明，这就是为什么尝试确定您是否真的在泄漏是一个相当无用的调用。

GC 堆有时可以增长和/或缩小，而无需对操作系统内存管理器进行任何调用，实际上这样做很常见。GC 一次从操作系统抓取大块，然后将其划分为更小的块，因为应用程序需要 GC 堆内存。

[P/Invoke GlobalMemoryStatus](http://pinvoke.net/default.aspx/coredll.GlobalMemoryStatus)如果您想跟踪您在设备控制面板中看到的实际操作系统分配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:34:48.967

此方法返回进程的托管内存使用情况。**不是**系统范围的。

您的进程甚至可能没有权限查询其他进程的内存。

# asp.net - 如何控制对 ASP.Net MVC 3 视图上的表单字段的访问？

> ID：12164937
> 
> 赞同：2
> 
> 时间：2012-08-28T18:02:37.243
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, razor

**例子**

用户“jtirado”被分配角色“HR-Assistant”，可以访问路由“mymvcapp/employeeee/edit/1452”来编辑员工（id：1452）数据。

作为“HR-Assistant”，该用户可以更改员工电话号码和电子邮件，可以查看员工工资但不能编辑金额。

电话号码、电子邮件、工资是数据库字段，由视图上的“asp.net-mvc-control”或“HTML-control”表示/呈现。所以我想根据用户的角色限制对这些控件的访问。

**以往的经验**

我之前使用 MasterPage、BasePage 类和 RoleBasedAccessControl 数据库模型为经典的 3 层 ASP.Net 3.5 Web 表单应用程序完成了此操作。

MasterPage 根据分配的角色构建用户可以访问的选项菜单。

BasePage 类检查用户是否有权访问所需页面，如果是，则检查用户可以编辑哪些控件（例如：DdlClientType、TxtLastName、ChkIsActive）。

这样，我不必使用 if-then 语句来检查权限，而且我可以创建任意数量的角色，为他们提供任何权限，而无需更改任何 C# 代码。

我计划为这个新的 MVC 应用程序使用相同的 RoleBasedAccessControl 数据库模型。

**问题**

所以我的问题是关于如何使用 ASP.Net MVC 3 实现 MasterPage 和 BasePage 类，或者是否有另一种实现方式，以及我是否应该以其他方式实现。

在我看来，ViewMasterPage 是与 Web-Forms-MasterPages 等效的 MVC。我还听说过 Razor 布局页面。

无论如何，我想我应该在控制器中处理所有这些。

我将使用：

1.  ASP.NET MVC 3.0
2.  剃刀

我检查了这些帖子：

[asp.net mvc 用户权限和视图](https://stackoverflow.com/questions/547049/asp-net-mvc-user-permissions-and-views)

[控制对表单字段的访问的最佳实践](https://stackoverflow.com/questions/368904/best-practices-for-controlling-access-to-form-fields)

[控制权限的最佳实践？](https://stackoverflow.com/questions/273534/best-practices-for-control-permissions)

[ASP.NET MVC 母版页](https://stackoverflow.com/questions/452698/asp-net-mvc-master-pages)

[实现安全的 ASP.NET MVC 应用程序](http://www.codeproject.com/Articles/288631/Secure-ASP-NET-MVC3-applications)

但它们并不完全适合我的情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T02:47:24.237

听起来您可以使用自定义编辑器模板，并在其中包含您的逻辑。

在您的 Viewmodel 中，您可以使用属性来确定将使用哪个模板 - 使用[UIHint](https://stackoverflow.com/questions/8069994/uihint-attribute-in-mvc)或通过设置 DataType 属性并为此使用自定义模板。

然后您的编辑器模板可以确定是渲染编辑值还是显示值（或完全隐藏）。不要忘记在您的活页夹中强制执行相同的规则，否则您就有可能让用户操纵他们不应访问的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:27:45.670

Razor 引擎的一个问题是页面上没有“控件”集合，就像在 WebForms 中一样。因此，您将无法遍历页面中的所有控件并对它们进行操作。

也就是说，您仍然可以通过子类化`System.Web.Mvc.WebViewPage`和/或`System.Web.Mvc.WebViewPage<TModel>`如上[一个问题](https://stackoverflow.com/questions/3963834/whats-the-base-class-of-a-razor-view-in-asp-net-mvc3)中所述来使用“基本视图”的想法。同样，从 Controller 继承也将有助于基本控制器。

我不确定我在这里有一个具体的答案，但我做的一件事是在我的模型属性上添加自定义属性，指示哪些角色可以访问它们。然后我重载了内置方法，例如`@Html.TextBoxFor()`，传入当前用户的角色。在重载中，我根据属性上的属性检查角色参数。

在您的情况下，属性可能不起作用，而是您将从数据库中读取授权；相同的想法，只是不同的实现。

希望这能让你朝着正确的方向前进。

# css - 带有 IE 的 div 中的背景图像和背景颜色

> ID：12164939
> 
> 赞同：0
> 
> 时间：2012-08-28T18:02:50.523
> 
> 标签：css, html

`background-image`我有一个与混合和`background-color`div 持有人有关的小问题。

div 看起来像这样：

```
<div class="board_position" x="1"  y="1"></div> 
```

CSS是：

```
.board_position {
width:25px;
height:25px;
margin:1px 0 0 1px;
float:left;
-webkit-border-radius:3px;
-moz-border-radius:3px;
border-radius:3px;

background: #f4f4f4; /* Old browsers */
background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjAlIiB5MT0iMCUiIHgyPSIwJSIgeTI9IjEwMCUiPgogICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2Y0ZjRmNCIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjIzJSIgc3RvcC1jb2xvcj0iI2ZmZmZmZiIgc3RvcC1vcGFjaXR5PSIxIi8+CiAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNmZmZmZmYiIHN0b3Atb3BhY2l0eT0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
background: -moz-linear-gradient(top,  #f4f4f4 0%, #ffffff 23%, #ffffff 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f4f4f4), color-stop(23%,#ffffff), color-stop(100%,#ffffff)); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top,  #f4f4f4 0%,#ffffff 23%,#ffffff 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top,  #f4f4f4 0%,#ffffff 23%,#ffffff 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top,  #f4f4f4 0%,#ffffff 23%,#ffffff 100%); /* IE10+ */
background: linear-gradient(to bottom,  #f4f4f4 0%,#ffffff 23%,#ffffff 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f4f4f4', endColorstr='#ffffff',GradientType=0 ); /* IE6-8 */
} 
```

该类`board_position`绘制一个带有渐变背景颜色的圆角框。

某些具有该类的 div 具有我通过向该 div 添加另一个类来提供的附加属性。这个额外的类只是一个`background-image`：

```
<div class="board_position bg" x="3"  y="1"></div>
.bg { background-image:url(/img/bg.png); } 
```

在 Chrome、Firefox、Safari 和 Opera 中运行良好。

但是在 IE 中，结果是一个方形框（不是圆形的），并且在`board_position`添加了另一个类的附加属性的 div 中，加载的图像没有显示，因为它似乎在`background-color`.

这个问题有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:16:26.797

哪个版本的IE？CSS 3 属性（如边框半径）在旧版本的 IE 中不起作用，并导致方角。其次，您的 css 选择器 .bg 和 .border_position 具有相同的重要规则，因此 css 中的最后一个将获胜，因此如果您首先列出 bg 然后 board_positon，则棋盘位置将获胜。为了确保 .bg 获胜，向选择器添加更多内容，例如 .board_position.bg 现在它的重要性为 020，并且 bkg 将推翻值为 010 的 .board_position。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:16:40.553

IE8 及以下不支持圆角。

尝试使用[http://css3pie.com/](http://css3pie.com/)

请记住使用[http://css3pie.com/documentation/known-issues/中的修复程序](http://css3pie.com/documentation/known-issues/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:17:34.920

IE8 不支持圆角边框。至于另一个问题，请记住图像路径是相对于 CSS 文件的，而不是链接它的文件。

# python - 安装后的项目/bin，如何使用脚本

> ID：12164941
> 
> 赞同：0
> 
> 时间：2012-08-28T18:03:00.117
> 
> 标签：python, setuptools

我正在尝试学习 Python 分发包，但`/bin`我自己似乎无法弄清楚这部分。已安装 Foo 包，我可以使用`from FOO import Foo`.

例如，如果我有一个名为 的项目`foo`，并且我有一个名为 的脚本，`use-foo`在我将 'use-foo' 放入 my 之后`foo/bin`，我应该如何使用它？

项目源文件/目录结构如下所示：

```
foo
-->FOO (source code for foo)
    -->Foo.py
-->bin (script uses Foo goes here)
    -->use-foo.py 
```

我试过了`import use-foo`，`from foo import use-foo`不工作，相对路径？

添加 setup.py：

```
try:
    from setuptools import setup
except ImportError:
    from distutils.core import setup

config = {
    'description': 'My Foo Project', 
    'author': 'Paul Liu',
    'url': 'URL to get it at.',
    'download_url': 'Where to download it.',
    'author_email': 'My email.',
    'version': '0.1',
    'install_requires':['nose'],
    'packages':['FOO'],
    'scripts':['bin/use-foo.py'],
    'name': 'foo'
}

setup(**config) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:49:25.893

只有源目录才是您开发代码的地方。在您通过可用命令之一构建它（或手动将各种路径添加到您的环境）之前，它并不能真正反映最终产品（已安装）的形式。

要进行开发，您可以运行以下命令：`python setup.py develop`
这将在您的 python 站点包中安装一个鸡蛋，它实际上只是一个返回到您的源位置的链接。这意味着您可以主动编辑代码，它将反映在您的 PYTHONPATH 中。构建过程会将包`FOO`放入您的 PYTHONPATH，并将脚本中的所有内容复制到 python `bin`。例如在我的机器上：

> 创建 /Library/Frameworks/Python.framework/Versions/2.6/lib/python2.6/site-packages/foo.egg-link （链接到。）将
> use-foo.py 脚本安装到 /Library/Frameworks/Python.framework /版本/2.6/bin

现在在您的 中`use-foo.py`，您可以将其`FOO`称为导入包，因为它将存在于 python 路径中。如果您选择不使用该`develop`命令，则需要手动添加`foo/`到您的 PYTHONPATH，以便它可以找到`FOO`下面的包。

**这里最重要**的是：将`__init__.py`文件（空）添加到您的`FOO`包中。这是python将其识别为包所必需的。

* * *

### 手动环境路径

手动向 shell 环境添加路径可能如下所示（bash shell）：

```
export PYTHONPATH=/path/to/foo:$PYTHONPATH
export PATH=/path/to/foo/bin:$PATH 
```

# android - 无法从android将参数传递给Web服务

> ID：12164952
> 
> 赞同：0
> 
> 时间：2012-08-28T18:03:47.017
> 
> 标签：android, web-services, soap

我的安卓代码

```
public class MainActivity  extends Activity {

    TextView et,tv1;
    private static String url = "//10.0.2.2:8090/WebApplication8/du";
    private boolean add;
    private static final String NAMESPACE = "//db/";
    private static final String SOAP_ACTION = "//db/du/helloRequest";
    private static final String METHOD_NAME = "hello";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        // listAdapter = new ArrayAdapter<String>(this, R.layout.list_item);  
        //  setListAdapter(new ArrayAdapter(this, android.R.layout.simple_list_item_1));  

        //    setListAdapter(adapter);

        //list1=(ListView)findViewById(R.id.list1);
        TextView tv;
        InputStream is = null;

        //String[] values = new String[] { "Mercury", "Venus", "Earth", "Mars",  
        //   "Jupiter", "Saturn", "Uranus", "Neptune"};    

        tv=(TextView)findViewById(R.id.tv1);

        // Create ArrayAdapter using the planet list.  
        ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
        try
        {
            SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME); 
            request.addProperty("parameters", 51);
            request.addProperty("username", "Rajapandian");
            request.addProperty("password", "Rajapandian");

            SoapSerializationEnvelope envelope =  new SoapSerializationEnvelope(SoapEnvelope.VER11); 

            envelope.setOutputSoapObject(request);
            HttpTransportSE androidHttpTransport = new HttpTransportSE(url);
            androidHttpTransport.call(SOAP_ACTION, envelope);
            SoapObject resultsRequestSOAP = (SoapObject) envelope.bodyIn;
            tv.setHint("Received :" + resultsRequestSOAP.toString());
        }
        catch (Exception e) {
            e.printStackTrace();
        }

    }
} 
```

这是我的wsdl

```
<definitions targetNamespace="//db/" name="du"><types><xsd:schema><xsd:import namespace="http://db/" schemaLocation="http://localhost:8090/WebApplication8/du?xsd=1"/></xsd:schema></types><message name="hello"><part name="parameters" element="tns:hello"/></message><message name="helloResponse"><part name="parameters" element="tns:helloResponse"/></message><portType name="du"><operation name="hello"><input wsam:Action="//db/du/helloRequest" message="tns:hello"/><output wsam:Action="//db/du/helloResponse" message="tns:helloResponse"/></operation></portType><binding name="duPortBinding" type="tns:du"><soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"/><operation name="hello"><soap:operation soapAction=""/><input><soap:body use="literal"/></input><output><soap:body use="literal"/></output></operation></binding><service name="du"><port name="duPort" binding="tns:duPortBinding"><soap:address location="http://localhost:8090/WebApplication8/du"/></port></service></definitions> 
```

这是我的 du.java

```
@WebService(serviceName = "du")
public class du {

/**
 * This is a sample web service operation
 */
  @WebMethod(operationName = "hello")
 public String hello(@WebParam(name ="id",targetNamespace="http://db/" )int id,@WebParam(name ="username",targetNamespace="http://db/" ) String username,@WebParam(name ="password",targetNamespace="http://db/" )String password) {

 {

 String result="",user="",pass="";

    try
       {

        Class.forName("com.mysql.jdbc.Driver");
      Connection con=DriverManager.getConnection("jdbc:mysql://localhost:3306/users","root","789456");
   String query=  "Insert into users(id,password,username)                values('"+id+"','"+password+"','"+username+"')";
      PreparedStatement stm = con.prepareStatement(query); 

   stm.executeUpdate();

} 
      catch(ClassNotFoundException e){
  System.err.println ("Sql Exception"+e);
      }

      catch(SQLException e){
  System.err.println ("Sql Exception"+e);
      }

    return "hey"+ id+"\n"+username+"\n"+password;
}
}

    } 
```

当我测试这一切正常并且数据被插入到mysql数据库中但是它来自android数据的问题没有被发送并且null，null结果被插入到mysql表中并且在我的服务器日志中的android屏幕上收到了null响应我收到了这个警告

```
WARNING: Received WS-I BP non-conformant Unquoted SoapAction HTTP header: ://db/du/helloRequest 
```

请告诉我怎么了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T20:26:00.863

对不起，我不能评论，只是回答。警告与问题无关。

我有同样的警告。警告只是要求您“引用” SOAP_ACTION。让我们这样做：

你的代码：

```
private static final String SOAP_ACTION = "http://db/du/helloRequest"; 
```

引用的代码：

```
private static final String SOAP_ACTION = "\"http://db/du/helloRequest\""; 
```

请注意 \"，它将引号发送到服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T18:34:24.490

您的连接参数缺少`http`标记。

```
 private static String url = "http://10.0.2.2:8090/WebApplication8/du";
    private static final String NAMESPACE = "http://db/";
    private static final String SOAP_ACTION = "http://db/du/helloRequest";
    private static final String METHOD_NAME = "hello"; 
```

注意：**肥皂动作 = 命名空间 + 方法名称。**

因此，您`METHOD_NAME`应该是`"helloRequest"`或 `SOAP_ACTION` 应该是`"http://db/du/hello"`（取决于您使用的内容）。

# javascript - 这是在 JavaScript 中形成闭包的正确方法吗？

> ID：12164953
> 
> 赞同：-6
> 
> 时间：2012-08-28T18:03:54.860
> 
> 标签：javascript, function, scope, closures

`iD`是一个在循环中的每次迭代中都会发生变化的对象。同样在这个循环中，我运行以下命令：

```
$("td.item_holder > div").append(dynamo.shop.box.ini(item_info,(function(data){
    return function(){
        console.log(data);
    }
})(iD))); 
```

我希望这会形成一个封闭。我唯一的查询是，它调用的函数`dynamo.shop.box.ini`使用`.bind`（jQuery）如下：

```
ini : function(data,callback){
....
            var right = $('<div>').addClass("dynamo_right").html('bye').bind('click',callback);
....
    return container;
}, 
```

我是否需要在`.bind`调用中使用另一个匿名函数来保持关闭？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T18:09:24.897

不，`ini`它本身就是一个函数，因此有它自己的作用域。因此，每次调用传递给的参数`ini`都不会改变，也不需要另一个闭包。

# c# - 32 位 Windows 2003 上的多个“repairDatabase”导致 MongoDb 终止

> ID：12164956
> 
> 赞同：1
> 
> 时间：2012-08-28T18:04:01.583
> 
> 标签：c#, mongodb

我正在尝试实现更改上限集合大小的功能，并且在 2GB 的 32 位系统上用完了可用的虚拟空间。如果我尝试删除旧集合并创建一个名称相同但大小不同的新集合，Mongo db 会不断创建新文件。

为了修复它，我决定每次更改集合大小时都做一个repairDatabase，以便Mongo Db可以在执行该操作之前减小文件大小。它在 Windows 2008 32 位上运行良好，但在 Windows 2003 32 位上，在经过一定次数的尝试（接近 10 次尝试）后尝试执行一系列操作“repairDatabase”、“dropCollection”、“createCollection”时出现以下错误。

```
Tue Aug 28 06:24:28 [conn7] MapViewOfFileEx for C:/Program Files/.../MongoDb/data/$tmp_repairDatabase_0/sbm.1 failed with errno:8 ?????????????????????????? (file size is 536870912) in MemoryMappedFile::map, terminating. 
```

我相信用问题字符代替的消息是`'Not enough storage is available to process this command.'`. [我在这里SERVER-6044](https://jira.mongodb.org/browse/SERVER-6044)和这里[SERVER-5244](https://jira.mongodb.org/browse/SERVER-5244)见过它。但是这些问题似乎都与我的情况不同。有什么办法可以防止 Mongo Db 终止？或者，如果我要更改上限集合大小，是否有更好的方法来减小文件大小？

我还尝试仅创建大小不超过 500MB 的集合（请参阅[此](https://stackoverflow.com/questions/11825598/cannot-create-a-capped-collection-larger-than-500-megabytes)问题以了解原因）。我正在使用的 Mongo Db 版本是 2.0.7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T14:54:42.953

当“repairDatabase”运行时，它需要两倍于正常运行状态的空间，所以我在 32 位系统上用完了 2GB 的限制，即使我的数据库只比 1GB 大一点。解决方案是使用大小低于 500MB 的上限集合，并考虑“repairDatabase”可以使用的空间

# xcode - 等号后的 NSScanner 扫描

> ID：12164964
> 
> 赞同：0
> 
> 时间：2012-08-28T18:04:36.820
> 
> 标签：xcode, nsscanner

```
oauth_token=requestkey&oauth_token_secret=requestsecret 
```

如何使用 NSScanner 获取“requestkey”和“requestsecret”。我似乎无法实现它。

```
NSScanner* scanner = [NSScanner scannerWithString:string];
NSString *oauth_token = @"oauth_token=";
NSString *oauth_token_secret = @"oauth_token_secret=";
[scanner setCharactersToBeSkipped:nil];

NSString *token;
NSString *key;

while (![scanner isAtEnd]) {
    [scanner scanString:oauth_token intoString:NULL];
    [scanner scanUpToCharactersFromSet:[NSCharacterSet characterSetWithCharactersInString:@"&"] intoString:&token];
    [scanner scanUpToString:oauth_token_secret intoString:NULL];
    [scanner scanUpToString:oauth_token intoString:&key];

    NSLog(@"token%@", token);
    NSLog(@"key %@", key);

//token requestkey
//key oauth_token_secret=requestsecret

} 
```

我似乎无法弄清楚为什么它是空的。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:12:32.600

没有什么是空的。所以我不能说那个。

如果您只是逐行遵循代码的逻辑，这实际上是一个非常直接的错误。例如：

```
[scanner scanString:oauth_token intoString:nil];
// The cursor is now just after the equals sign.
[scanner scanUpToCharactersFromSet:[NSCharacterSet characterSetWithCharactersInString:@"&"] intoString:&token];
// This leaves the cursor just BEFORE the &.
[scanner scanUpToString:oauth_token_secret intoString:nil];
// This leaves the cursor just BEFORE the "oauth_token_secret="
[scanner scanUpToString:oauth_token intoString:&key];
// This scans effectively the rest of the string into &key which is in fact
// "oauth_token_secret=requestsecret" 
```

解决此问题的最简单方法是使用该`scanString:intoString:`方法将光标前进到`oauth_token_secret`.

```
[scanner scanString:oauth_token intoString:nil];
[scanner scanUpToCharactersFromSet:[NSCharacterSet characterSetWithCharactersInString:@"&"] intoString:&token];
[scanner scanUpToString:oauth_token_secret intoString:nil];
// This leaves the cursor just BEFORE the "oauth_token_secret="

// **FIX HERE**
[scanner scanString:oauth_token_secret intoString:nil];
// The cursor is now AFTER oauth_token_secret.

[scanner scanUpToString:oauth_token intoString:&key]; 
```

日志输出现在显示有用的字符串。

```
token:requestkey
key  :requestsecret 
```

但是，正如 H2CO3 在评论部分所说，`componentsSeparatedByString:`它更适合这个用例。

# iphone - AVAudioPlayer 真的很奇怪的行为

> ID：12164966
> 
> 赞同：0
> 
> 时间：2012-08-28T18:04:38.373
> 
> 标签：iphone, cocoa, ipad, avaudioplayer

我正在使用 AVAudioPlayer 在应用程序上播放一些 caf 文件，它在所有模拟器（iPhone 和 iPad）和我的 iPhone 上都可以正常工作，但是当我在 iPad 上测试它时它不起作用并给我这个错误：错误域 = NSOSStatusErrorDomain 代码 =-43 “操作无法完成。（OSStatus 错误 -43。）”奇怪的是，相同的代码在 iPad 上也适用于另一个应用程序...... iPad更新到IOS版本5.1.1

这是我正在使用的代码：

```
NSError *error;
NSURL *url = [NSURL fileURLWithPath:[NSString stringWithFormat:@"%@/music.caf", [[NSBundle mainBundle] resourcePath]]]; 

audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];
audioPlayer.numberOfLoops = 0;

audioPlayer.volume = 0.5;

if (audioPlayer == nil)
    NSLog(@"%@", [error description]);

else
{
    [audioPlayer prepareToPlay];
    [audioPlayer play];
} 
```

在 .h 文件中，我有 AVFoundation 的导入和

```
 AVAudioPlayer *audioPlayer; 
```

并且 AVFoundation.framework 在它的位置

我真的对这件事感到疯狂......任何帮助将不胜感激。谢谢， 马西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:26:41.537

```
NSString* filepath = [[NSBundle mainBundle] pathForResource:@"music" ofType:@"caf"];
NSURL* url = [NSURL fileURLWithPath:filepath]; 
```

# android - 什么时候应该在 AlertDialog 中使用标题？

> ID：12164969
> 
> 赞同：-3
> 
> 时间：2012-08-28T18:05:02.203
> 
> 标签：android, user-interface, android-alertdialog, human-computer-interface

从用户界面的角度来看，为什么有一个[`title`](http://developer.android.com/reference/android/app/AlertDialog.html#setTitle%28java.lang.CharSequence%29)选项`AlertDialog`？为什么一个[`message`](http://developer.android.com/reference/android/app/AlertDialog.html#setMessage%28java.lang.CharSequence%29)人不够用？我们真的需要一个标题吗？如果是这样，请提供标题有用的视觉示例。

该`AlertDialog` [文档](http://developer.android.com/guide/topics/ui/dialogs.html#AlertDialog)显示`AlertDialog`没有标题，对我来说看起来很完美：

![没有标题的警报对话框](../Images/cefe04ac302980f70a5559729917b8df.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T18:05:02.203

[关于警报](http://developer.android.com/design/building-blocks/dialogs.html#alerts)的Android 设计指南说：

> **警报**
> 
> 警报通知用户在继续之前需要他们确认或确认的情况。根据所传达信息的严重程度和影响，它们的外观略有不同。
> 
> **没有标题栏的警报**
> 
> 大多数警报不需要标题。通常这个决定不会产生严重的影响，可以用一两句话来概括。内容区域应该提出一个问题（例如“删除此对话？”）或明确说明其与操作按钮的关系是显而易见的。
> 
> ![没有标题的对话框](../Images/2e9e9a9bc366fecce6ec0aaabf7a6d2c.png)
> 
> **带有标题栏的警报**
> 
> 保持问题或陈述简短：例如，“擦除 USB 存储？” 避免道歉。用户应该能够完全跳过内容，并且仍然可以根据标题和操作按钮的文本清楚地了解可用的选项。
> 
> ![带标题的对话框](../Images/fd627b039b50c06a899d8e66b3f36877.png)
> 
> 在制作确认对话框时，通过呼应请求的操作使标题有意义。
> 
> 不：
> 
> *   你确定吗？
> *   别
> *   警告！
> 
> 做：
> 
> *   擦除 USB 存储？

# ios - 无法从 appcelerator 中的 strings.xml 获取字符串

> ID：12164973
> 
> 赞同：1
> 
> 时间：2012-08-28T18:05:20.630
> 
> 标签：ios, string, titanium, appcelerator

我正在开发 Titanium 2.1 并开发 iOS 应用程序，但我无法在我的 strings.xml 文件中获取任何字符串。这是我的 strings.xml 文件[链接](http://pastebin.com/B71uyPDd)

在我的代码中，我有以下内容：

```
var action = 'created_a_group'; //string at line 24 in strings.xml

var actionLabel= Titanium.UI.createLabel({

    text:Ti.Locale.getString(action), 
    color:"#666666",
    font:{fontSize:12}, 
    left:8

}); 
```

但是当我的标签显示时，没有显示正确的字符串，而是`created_a_group`出现了。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-29T12:02:30.067

你有正确的文件夹中的文件吗？

它应该位于 Resources 文件夹之外的 i18n 文件夹中。它也应该在适当的语言文件夹中。虽然我没有尝试过，但您是否使用您的设备使用正确的语言设置来选择适当的 sting.xml 文件？例如，如果您在 /i18n/en 文件夹中有 string.xml 文件，但在设备上将其设置为不同的语言，则可能无法找到该语言的文件。

# azure - Windows Azure 上的 CPU 品牌（英特尔、AMD 或任何）是什么？

> ID：12164975
> 
> 赞同：1
> 
> 时间：2012-08-28T18:05:27.947
> 
> 标签：azure, intel, amd-processor

我想在 VM Azure 上托管应用程序，但这需要 Intel CPU 指令。在“计算机菜单”上打开属性时，我在 VM 上看到了 AMD 类型。我认为这是 Azure 上的兼容 CPU。

Windows Azure 上的实际 CPU 品牌（英特尔或 AMD 或任何）是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T19:08:46.563

虽然在任何地方的 Windows Azure 文档中都没有讨论 CPU 类型，因为基本理解是当代码在云中运行时，它不依赖于 CPU 指令级别。然而，大多数用户发现 Azure 主机确实运行 AMD 处理器，并在[此处](http://social.msdn.microsoft.com/Forums/en-US/windowsazurepurchasing/thread/9eb5a474-90ba-43ab-8c79-a7e0451e9dee)的 Azure 论坛中进行了讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T19:27:13.980

正如另一个答案所述，它很可能是 AMD，但是你不应该依赖这个。混合了英特尔服务器，并且没有承诺保留在任何特定品牌或芯片组上。

此外，由于您在远离 CPU 的情况下进行虚拟化，因此使用 CPU 特定指令可能无法正常工作，即使您在物理上使用正确的硬件也是如此。

# python - 在 Python 中将数据写入文件

> ID：12164977
> 
> 赞同：9
> 
> 时间：2012-08-28T18:05:32.890
> 
> 标签：python

如何有效地将数据保存到文件（稍后将绘制）？

我从我的研究中得到了这个：

```
#Open new data file
f = open("data2.txt", "w")
f.write( str(yEst)  )      # str() converts to string
f.close() 
```

到目前为止，这是我的一些代码：

```
for i in drange2(0, 2*math.pi + 0.0634665182543392 , 0.0634665182543392):
    for x in range(1,N+1):
       yEst = yEst + a * cos(x* i)
#print yEst
f.write( str(yEst)  )      # str() converts to string
yEst=0
f.close() 
```

现在，当我去打开我的文件“ `data2.txt`”时，我无法读取数据，因为它没有“组织”。如何使用 转到下一行，`f.write( str(yEst) )`以便在“data2.txt”文件中有一列包含我的“yEst”数据？提前感谢您的考虑:)

PS：yEst 看起来像（在 data2.txt 文件中）：`48.901347147148.605785828748.114506165947.429486 ..`我希望它作为一列：-->

```
48.9013471471 (new line)
48.6057858287 (new line)
48.1145061659 (new line)
47.4294863684    
etc .. 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-28T18:44:47.243

你的意思是说你希望每个数据点都在自己的线上，像这样？

```
48.9013471471
48.6057858287
48.1145061659
47.4294863684 
```

如果是这样，那么您可能想尝试这样的事情：

```
for i in drange2(0, 2*math.pi + 0.0634665182543392 , 0.0634665182543392):
    for x in range(1,N+1):
       yEst = yEst + a * cos(x* i) 
       f.write( str(yEst) + "\n"  )
f.close() 
```

首先，要将每个数据点写入该行，它需要位于循环“内部”——这就是为什么我在调用`f.write`.

我添加的第二件事是`+ "\n"`- 这会将换行符添加到行尾。你可以把它改成你想要的任何东西！几个例子：

`f.write( str(yEst) + " " )`将在每个数据点后添加一个空格：

```
48.9013471471 48.6057858287 48.1145061659 47.4294863684 
```

`f.write( str(yEst) + "|" )`将在每个数据点后添加一个管道字符：

```
48.9013471471|48.6057858287|48.1145061659|47.4294863684| 
```

* * *

另一方面，如果您只想将数据保存为数组，请尝试以下操作：

```
yEst = 0 # or some initial value
yEstArray = []
for i in drange2(0, 2*math.pi + 0.0634665182543392 , 0.0634665182543392):
    for x in range(1,N+1):
       yEst = yEst + a * cos(x* i) 
       yEstArray.append(yEst) 
```

然后，您可以像这样遍历数组：

```
for yEst in yEstArray:
    do something with yEst 
```

或者

```
for yEst, index in enumerate(yEstArray):
    do something with yEst and its index 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-28T18:06:43.883

您需要[pickle](http://docs.python.org/library/pickle.html)进行数据序列化。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-28T18:13:16.293

Python 有三种主要的内置方式来持久化数据：

1.  `pickle`将对象序列化为文件；
2.  `sqlite`- 一个嵌入式 SQL 数据库，许多 ORM 系统都支持它（加上它是`pickle`对象存储的绝佳替代品）；和
3.  `json`/ `yaml`- 用于网络的序列化，具有基本的数据结构和类型。

# php - PHP - 只允许用户访问一次

> ID：12164978
> 
> 赞同：0
> 
> 时间：2012-08-28T18:05:35.347
> 
> 标签：php, paypal, payment

我正在寻找一个支付处理类型的脚本。这是步骤。

它用于 Minecraft 服务器，以便玩家捐赠。然后是贝宝。然后给出物品。

1.  玩家在游戏名称中输入他们的 Minecraft，然后它会为 $player 创建一个 cookie。
2.  玩家点击自己想要的包裹，付款后会被定向到带有特定页面重定向的PayPal包裹。如果设置了 cookie，则每个不同的包都会给出不同的项目，什么不是。
3.  然后他们将拥有他们的物品并开始他们的快乐方式：D

我的问题是，如果他们足够聪明。他们会通过刷新和一遍又一遍地给自己物品来滥用。隐藏该部分过程或不允许他们刷新页面并只允许访问一页的最佳方法是什么？

谢谢， 死灵

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:08:45.430

您可能应该使用会话变量来存储此信息，而不是 cookie。当用户在 PayPal 上进行付款处理后被重定向回您的站点时，您只需使用会话变量中所需的信息，然后取消设置，使其无法再次使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T08:19:09.760

听起来您没有通过 CURL 使用 PayPal API，而是依靠 PayPal 重定向到您网站的非索引页面。

使用将为您提供“令牌”的 PayPal API，您可以指定返回 URL，当用户返回返回 URL 时，您可以使用 PayPal API 来检查令牌是否真实。禁止某人刷新页面。

这将是一种更好的支付网关方式。

尝试这样的事情以供参考：

[http://coding.smashingmagazine.com/2011/09/05/getting-started-with-the-paypal-api/](http://coding.smashingmagazine.com/2011/09/05/getting-started-with-the-paypal-api/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-28T18:47:36.480

会话可以被规避

1.  使用不同的浏览器或
2.  使用浏览器在`VM`.

记录用户`IP`可以将 IP 访问限制为每 X 天一次...

另一种选择是[BuyCraft](http://buycraft.net/)。我自己使用它，它的设置非常简单 + 它是许多用户认可的值得信赖的插件。

# spring - Spring WebServiceTemplate 没有给出完整的响应

> ID：12164980
> 
> 赞同：0
> 
> 时间：2012-08-28T18:05:40.407
> 
> 标签：spring, response, webservicetemplate

我正在使用 Spring WebServiceTemplate MarshalSendAndReceive 进行 Web 服务调用。但是，我从呼叫中收到的响应缺少从 Web 服务发送的大部分响应。

当 MarshalSendAndReceive 运行时，我看到一个调试语句（不确定哪个确切的类正在生成它），但它同时显示了完整的响应和请求。

```
DEBUG:MessageTracing.received:Received response [<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/ etc.... 
```

这显示了完整的响应：

```
<element1><element2><element3>etc..</element3></element2></element1> 
```

但是，我从 MarshalSendAndReceive 收到的响应仅包含 element1 和 element 2。 Element3 或后续元素不在响应中。

有人知道为什么会发生这种情况吗？

谢谢，

肯尼

# ios - UIPageControl 不显示当前页面

> ID：12164982
> 
> 赞同：0
> 
> 时间：2012-08-28T18:05:53.427
> 
> 标签：ios, xcode, uipagecontrol

页面控制指示器不跟随滚动视图。我都尝试了：-没有任何效果..我做错了什么？

```
-(void) scrollViewDidScroll:(UIScrollView *)scrollView{

CGFloat pageWidth = self.scroller.frame.size.width;

int page = floor((self.scroller.contentOffset.x - pageWidth/2)/ pageWidth)+1;
self.pageControl.currentPage=page;

}

-(void) scrollViewDidEndDecelerating:(UIScrollView *)scrollView{
   int page = scrollView.contentOffset.x / scrollView.frame.size.width;

self.pageControl.currentPage = page;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:58:45.363

我认为您不需要在方法中指定您的 currentPage`-(void) scrollViewDidEndDecelerating:(UIScrollView *)scrollView`

# java - 验证类应该是静态类吗？

> ID：12164984
> 
> 赞同：10
> 
> 时间：2012-08-28T18:06:04.863
> 
> 标签：java, static

我正在开发一个每秒收到数千个请求的系统，本质上我们试图避免的任务之一是**创建不必要的/额外的对象**。

我们需要验证 6 个请求项本身的传入请求。

我正在考虑为每个项目验证创建一个类。

但是，我试图证明我是否应该使用静态验证类与包含`HttpRequest`作为实例字段的实例的对象。

我应该使用静态类还是对象？你会怎么做？

本质上，我正在做的是注入`List<IValidator> validators`请求处理程序并对其进行迭代。但不确定我是否应该有一个实例与静态类。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-28T18:28:00.867

您是否实际测量过创建新的 Validator 实例与重用静态方法对内存的影响？使用短命对象的成本非常非常小。您应该衡量这两种方法之间的差异，如果没有可衡量的差异，请使用代码更清晰、更易于理解的那一种。

在这种情况下，衡量差异总是有意义的，而不是仅仅假设一个与另一个更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:45:41.443

在多线程环境中，使用静态类/方法总是会带来并发陷阱。由于短期对象的创建和收集很便宜，因此创建短期对象通常比遇到并发问题和额外的同步要好，后者很昂贵。

[出于类似的原因， Struts](http://struts.apache.org/)从静态请求处理程序切换到基于实例的请求处理程序。

# git - Github 是如何处理这么多公钥的

> ID：12164992
> 
> 赞同：12
> 
> 时间：2012-08-28T18:06:32.567
> 
> 标签：git, ssh, github, openssh

我想知道，Github 是如何处理这么多用于通过 ssh 进行身份验证的公钥的。

一个用户拥有大约 3 个证书，Github 上有多少用户 - 数百万？简单的乘法为我们提供了数百万个证书。我猜它不在一个`.ssh/authorized_keys`用户 git 的文件中，对吧？

他们已经实现了自己的 ssh 服务器，或者存在任何用于 OpenSSH 解决此类问题的模块？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-28T18:09:29.970

他们已经修补了 sshd 以在 MySQL 数据库中查找键：

[https://github.com/blog/530-how-we-made-github-fast](https://github.com/blog/530-how-we-made-github-fast)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T18:29:38.087

答案是，如何提到 rkhayrov，Github 使用修补过的 OpenSSH 守护程序。

对于那些对这个问题感兴趣的人，我找到了源代码（猜猜代码托管在哪里；）） - [http://github.com/norbauer/openssh-for-git](http://github.com/norbauer/openssh-for-git)

# css - 实现插件时如何解决多个CSS文件冲突？

> ID：12164995
> 
> 赞同：4
> 
> 时间：2012-08-28T18:06:38.850
> 
> 标签：css, html, jquery-plugins

我期待在我的网站中集成某个 jQuery 幻灯片，但它的外部 CSS 文件与我的原始 CSS 文件集冲突。你通常如何处理这个问题？

我是否必须重新分析我的所有 CSS 文件并分析插件的 CSS 文件以将它们混合在一起才能完成这项工作？或者有一种方法可以将插件的这个外部 CSS 文件应用到特定的 div 代码中，这样文档的其余部分就不会受到影响？

对于那些熟悉 CSS 的人，我一定会感谢您的友好回答和反馈。

PS：使用 iframe 可以解决这个问题吗？虽然我读到使用 iframe 是一个坏习惯，对 SEO 不利。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T18:16:43.703

任何值得一试的 jQuery 插件都应该有足够具体的 CSS 来仅针对它们自己的元素（通常通过提供 ID 或类名）。

更有可能的是，您正在使用覆盖整个标签的样式覆盖插件的 CSS。

您应该为自己的标签使用类来防止这些冲突。

此外，尝试在您自己的自定义 CSS 之后链接插件的 CSS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T18:15:57.833

通常 jQuery 插件具有非常独特的标签 ID。我认为查看您的 CSS 并查看可以在哪里消除任何冲突是值得的。另外，查看这篇文章以获得一些好主意：[系统地解决 css 中的冲突样式](https://stackoverflow.com/questions/2788466/systematically-resolve-conflicting-styles-in-css)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-17T09:45:16.760

这是获取 favicon 图标的 jquery 函数

```
 $('link').each(function(i,v){
       rel = $(v).attr('rel').split(" ").filter(function(i){if(i.length)return i});
       if(ibreak)return false;
       rel.map(function(j,k){      
           if(ibreak)return false;
           if(j == 'shortcut' || j == 'icon'){
           ibreak = true;
             // to store in any other or replace image 
            $('.widgetintroductionpopup-imgcover img').attr('src',$(v).attr('href'));           
           }
       }); 
   }); 
```

# asp.net-mvc - linq to sql 急切加载自引用属性

> ID：12164997
> 
> 赞同：0
> 
> 时间：2012-08-28T18:06:51.297
> 
> 标签：asp.net-mvc, asp.net-mvc-3, linq-to-sql

我正在尝试进行一个数据库调用来加载我的菜单，但在研究之后我注意到没有可用于自引用表的急切加载。现在它看起来像这样：

```
public ActionResult PopulateHeaderMenu()
{
 using (var context = ww.WebObjs.WebDataContext.Get())
 {
    var menus = from menu in context.MenuCaches
    where menu.URL == "MENU" && menu.ParentID == -1
    select new MenuModel
    {
        ID = menu.ID,
        Children = from x in menu.Children
                select new MenuModel
                {
                   ID = x.ID,
                   Children = from y in x.Children
                            select new MenuModel
                            {
                                ID = y.ID,
                                Children = from p in y.Children
                                    select new MenuModel
                                    {
                                      ID = p.ID,
                                      Children = from r in p.Children
                                      select new MenuModel 
                                      {
                                        ID =r.ID,
                                        Children = from s in r.Children     
                                        select new MenuModel
                                        {
                                          ID =s.ID,
                                          Children = from t in s.Children
                                             select new MenuModel
                                             {
                                               ID = t.ID,
                                             }
                                        }
                               }
                      }
                  }
            }
         };
         var model = menus.First();
         return PartialView("_NaviPartial", model);
        }

    } 
```

这工作得相当好，但它会生成 113 个单独的查询。我尝试使用 DataLoadWith()，但不能对自引用属性执行此操作。还有另一种方法可以做我在这里想做的事情吗？我采取了错误的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:59:02.220

几年前我做过类似的事情（并且不再有权访问代码）。关键是加载平面表一次，然后循环遍历为父实体设置本地（未映射）属性的项目。这样，您可以随意通过这些未映射的属性在树中导航，并且只获取一次图形。不幸的是，您不能对自引用实体使用 LoadWith 选项（请参阅[http://www.thinqlinq.com/Default/Managing-self-referencing-tables-with-LINQ-to-SQL.aspx](http://www.thinqlinq.com/Default/Managing-self-referencing-tables-with-LINQ-to-SQL.aspx)）。