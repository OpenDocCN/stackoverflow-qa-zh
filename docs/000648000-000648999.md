# StackOverflow 问答 000648000-000648999

# asp.net - ASP.NET 中的本地化从未对我有用！

> ID：648001
> 
> 赞同：1
> 
> 时间：2009-03-15T15:41:16.637
> 
> 标签：asp.net, localization, asp.net-2.0

我遇到了一个奇怪的问题，我正在尝试本地化一个网站，所以我将它转换为一个 Web 应用程序并为我拥有的每个 aspx 和 ascx 文件生成 resx 文件（pagename.en.resx ..etc）

但是本地化从未对我有用。有一件事要提一下，当我在设计器模式下打开 resx 文件时，我发现右上角启用了“访问修改器”下拉菜单，在成功运行的示例项目中，我发现“访问修改器”下拉菜单被禁用？

非常感谢您的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-29T18:44:34.450

解决 ！问题如下：我定义了带有语言前缀的资源文件：resourcefile.en.resx，resourcefile.jp.resx 但是 ASP.NET 需要像 resourcefile.resx 这样的通用资源文件

谢谢你们 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T16:55:18.160

*   尝试同时声明文化：

*   确保您的浏览器设置包括英语作为一种语言。

如果这没有帮助，您可以发布一些您使用本地化的 aspx/ascx 文件的代码吗？

# c# - 确保 ascii 值

> ID：648003
> 
> 赞同：1
> 
> 时间：2009-03-15T15:41:42.533
> 
> 标签：c#, .net

我想确保我的 webapp 中的某些输入只包含可以表示为 ascii 的字符（它用于标记，我试图通过使用 varchar 而不是 nvarchar 来节省数据库列中的空间）

.net 中是否有框架功能可以执行此操作，还是我应该一一检查字符代码以确保它们在正确的范围内？

编辑：我刚刚写了这个扩展方法，但是对于这么简单的事情来说似乎太麻烦了。

```
public static bool IsAscii(this string value)
{
    if (value != null)
        for (int current = 0; current < value.Length; current++)
        {
            if ((int)value[current] > 127)
                return false;
        }

    return true;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T16:43:48.700

鉴于您正在使用扩展方法，您可能正在使用 C# 3 和 .NET 3.5。在那种情况下，我会使用：

```
using System.Linq;

...

public static bool IsPrintableAscii(this string value)
{
    return value != null && value.All(c => c >= 32 && c < 127);
} 
```

这将检查每个字符是否在 [U+0020-U+007E] 范围内，该范围仅包含可打印字符。这就是你所追求的吗？

正如其他评论所说，这将排除所有带有口音等的东西 - 你确定没关系吗？这也拒绝回车、换行和制表符。再说一遍，可以吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T15:48:19.223

您可以通过 System.Text.ASCIIEncoding 运行文本，这将确保所有内容都是 ASCII（任何未映射到 ASCII 字符的字符都将转换为“？”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T16:11:11.900

我在您的解决方案中看到的问题是您将输入您真正不想要的 ASCII 字符。您还将排除扩展的 ASCII 代码，如果您支持其他语言，则可以很好地存储重音字符。

# jquery - jQuery 中最快的 children() 或 find() 是什么？

> ID：648004
> 
> 赞同：330
> 
> 时间：2009-03-15T15:42:31.063
> 
> 标签：jquery, jquery-selectors

要在 jQuery 中选择子节点，可以使用 children()，也可以使用 find()。

例如：

`$(this).children('.foo');`

给出相同的结果：

`$(this).find('.foo');`

现在，哪个选项最快或首选，为什么？

* * *

## 回答 #1

> 赞同：427
> 
> 时间：2009-03-15T15:47:44.843

[`children()`](https://api.jquery.com/children/)仅查看节点的直接子节点，同时[`find()`](https://api.jquery.com/find/)遍历节点下方的整个 DOM，因此在等效实现的情况下`children()` *应该*更快。但是，`find()`使用*本机*浏览器方法，而`children()`使用在浏览器中解释的*JavaScript 。*在我的实验中，典型情况下的性能差异不大。

使用哪一个取决于您是只想考虑DOM 中的直接后代还是该节点下的所有节点，即根据您想要的结果选择适当的方法，而不是方法的速度。如果性能确实是一个问题，那么尝试找到最佳解决方案并使用它（或在此处查看其他答案中的一些基准）。

* * *

## 回答 #2

> 赞同：181
> 
> 时间：2011-10-07T20:11:23.363

这个[jsPerf 测试](http://jsperf.com/jquery-children-vs-find)表明 find() 更快。我创建了一个[更彻底的测试](http://jsperf.com/jquery-children-vs-find/3)，它看起来仍然好像 find() 优于 children()。

**更新：**根据 tvanfosson 的评论，我创建了另一个具有 16 级嵌套的[测试用例。](http://jsperf.com/jquery-children-vs-find/8)find() 仅在查找所有可能的 div 时较慢，但在选择第一级 div 时 find() 仍然优于 children()。

当 find() 有超过 100 层嵌套和大约 4000 多个 div 供 find() 遍历时，children() 开始优于 find()。这是一个基本的测试用例，但我仍然认为 find() 在大多数情况下比 children() 快。

我在 Chrome 开发者工具中逐步浏览了 jQuery 代码，并注意到 children() 在内部调用了兄弟 ()、filter()，并且比 find() 执行了更多的正则表达式。

find() 和 children() 满足不同的需求，但是在 find() 和 children() 输出相同结果的情况下，我建议使用 find()。

* * *

## 回答 #3

> 赞同：91
> 
> 时间：2013-08-14T02:19:16.713

这是一个可以运行性能测试[的链接。](http://jsperf.com/jquery-selectors-context/2)`find()`实际上比 . 快大约 2 倍`children()`。

![OSX10.7.6 上的 Chrome](https://i.stack.imgur.com/m6nEr.png)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-03-15T15:49:26.540

那些不一定会给出相同的结果：`[find()](http://docs.jquery.com/Traversing/find)`将为您提供任何*后代*节点，而`[children()](http://docs.jquery.com/Traversing/children)`只会为您提供匹配的*直接子节点。*

在某一时刻，`find()`它要慢得多，因为它必须搜索每个可能匹配的后代节点，而不仅仅是直接子节点。然而，这不再是真的；`find()`由于使用本机浏览器方法，速度要快得多。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2014-12-01T17:43:30.923

其他答案均未涉及使用*或仅*`.children()`搜索`.find(">")`父元素的直接子元素的情况。所以，我创建了一个[jsPerf 测试来找出](http://jsperf.com/children-vs-find-in-jquery)，使用三种不同的方式来区分孩子。

 *碰巧的是，即使使用额外的 ">" 选择器，`.find()`仍然比;快*很多。*`.children()`在我的系统上，是 10 倍。

因此，从我的角度来看，似乎没有太多理由使用过滤机制`.children()`。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-05-04T12:12:34.517

> `find()`和方法都`children()`用于过滤匹配元素的子元素，除了前者是向下移动任何级别，后者是向下移动单个级别。

简化：

1.  `find()`- 搜索匹配元素的孩子、孙子、曾孙……所有级别。
2.  `children()`– 仅搜索匹配元素的子元素（向下一层）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-28T13:31:46.223

很抱歉，我自己的经验与这里的大多数答案都不匹配，所以我认为在这里分享它并建议人们为自己的使用环境进行自己的测试很有趣。

通过在我的脚本`$(...).find()`的几个地方替换为`$(...).children()`.

项目的实际嵌套非常低（最多 3 层），尽管如此，children() 显然效率更高。

两者都被调用了数千次以检索网格中的信息（由数千个 组成）。目的主要是根据单元格内容中的几件事对单元格/列/行应用一些样式。

使用 Firefox，在替换 find() 之前，网格的加载时间在 2100 到 2400 毫秒之间。在使用 children() 进行更改后，它减少到 1300 到 1500 毫秒之间（因此减少了 30% 到 40% 之间）。

然而，不幸的是，对于 Chrome，它并没有那么令人信服：Chrome 处理完全相同的事情要慢得多（8 秒），而且在此更改前后我没有看到任何明显的性能差异。

# java - java服务和资源共享

> ID：648016
> 
> 赞同：1
> 
> 时间：2009-03-15T15:48:43.547
> 
> 标签：java, service, resources, shared

我正在用 Java 创建一个将数据写入对象的 Windows 服务。该对象必须可由另一个 Java 程序访问。最好的方法是什么？

谢谢你。杰克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T16:19:38.277

我同意“将其放入文件”的方法，除非您详细说明两个 java 进程如何“看到”彼此。它们是否同时运行？在同一台机器上？等等 你需要传输什么数据？

* * *

如果所有应用程序和服务都可以写入数据，则在确定哪些数据是正确的（应用程序 A 中的数据或服务中的数据）时会出现问题。

解决“通用数据存储”问题的一种简单方法可能是使用 JNDI 服务器，该服务器包含在大多数 Java EE 服务器（如 JBoss）中，其中每个配置都被告知从同一个 JNDI 服务器读取。我不确定客户是否可以更新 JNDI 中的信息，但这可能是特定于供应商的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T16:04:24.787

将对象序列化为文件并使用其他进程读取/写入它！您还可以使用 JAXB 或 XStream 等框架将其序列化为 XML。

另一种方式是JMS，但很难掌握。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T16:23:39.343

普通的旧[RMI](http://en.wikipedia.org/wiki/Java_remote_method_invocation)用于满足您的需要。[现在首选WS](http://en.wikipedia.org/wiki/Web_service)等较新的替代方案，但也许第一个对您来说就足够了。

# iphone - 如何在多视图控制器中正确释放和切换视图？

> ID：648020
> 
> 赞同：1
> 
> 时间：2009-03-15T15:51:04.867
> 
> 标签：iphone, cocoa-touch

我正在尝试为游戏创建一个多视图控制器，其中一个根视图控制器在切换到另一个视图之前释放视图。反过来，子视图控制器本身就是子根视图控制器，因为它们包含其他视图控制器。

例如，我的 singlePlayerViewController 将有一个shakeObjectViewController 可能还有其他。使用操作表在视图之间切换，将应用程序委托作为操作表的委托，从 singlePlayer 视图转到另一个视图时，一切都按预期工作。

但是当我尝试使用相同的 init 方法创建一个新的 singlePlayerViewController`_BAD`时，当我尝试插入一个子视图，即shakeObjectViewController.view 时，调试器会抛出一个 EXC _ACCESS 错误。

初始化现在看起来像这样：应用程序委托使用默认的 init 方法初始化窗口，

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {   
    // Override point for customization after application launch
   [window addSubview:rootViewController.view];
    [window makeKeyAndVisible];
} 
```

然后在rootViewController.m的viewDidLoad中，

```
 if(singlePlayerViewController == nil) {

      SinglePlayerViewController *singleController = [[SinglePlayerViewController alloc]
                                       initWithNibName:@"SinglePlayerView" bundle:nil];
      self.singlePlayerViewController = singleController;
      [singleController release];
   }

   [self.view insertSubview:singlePlayerViewController.view atIndex:0]; 
```

其次是singlePlayerViewController.m，

```
- (void)viewDidLoad {
   self.view.tag = kSinglePlayerView; // tag the view

   ShakeObjectViewController *shakeController = [[ShakeObjectViewController alloc]
                                       initWithNibName:@"ShakeObjectView" bundle:nil];
   self.shakeObjectViewController = shakeController;
   self.view = shakeController.view;
   [shakeController release];
} 
```

请注意我的 singlePlayerViewController 没有插入子视图，而是用子视图控制器的视图替换它自己的视图。（不知道这是否是一个好习惯：？：）

切换视图时，应用程序委托执行以下操作：

```
for(UIView *subview in [rootViewController.view subviews])
{   
   [subview removeFromSuperview];
}
[rootViewController.singlePlayerViewController release]

[rootViewController initMultiplayerView]; 
```

然后在切换回单人模式时，执行rootViewController.m的viewDidLoad中同样的init方法，调试器在“[self.view insertSubview:singlePlayerViewController.view atIndex:0];”上抛出错误 线。

关于为什么没有创建新视图的任何想法？我尝试将 singlePlayerViewController 设置为 nil 而不是释放，但随后在“self.view = shakeController.view;”上抛出错误 线。我的理解是，如果视图属性当前为零，则在下次访问视图时会自动为您创建一个新属性。

initWithNibName 是否只意味着执行一次？还是我的设计方式在 # 视图控制器方面过于复杂？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-29T21:26:42.400

> 请注意我的 singlePlayerViewController 没有插入子视图，而是用子视图控制器的视图替换它自己的视图。（不知道这是否是一个好习惯：？：）

这里有巨大的警告标志。听起来您有一个带有两个视图控制器的视图。这是不好的。

考虑插入和删除子视图：

*   根视图
    *   SinglePlayerView（可以去掉，换成 MutliplayerView）
        *   摇视

这样你就有 3 个视图和 3 个视图控制器。

这是该框架的使用方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T16:09:49.843

您的设计确实看起来有点过于复杂，但这并不意味着调试器应该抛出随机错误！:) 不过，尝试简化它可能会有所帮助。如果您只是要立即将其替换为摇动对象视图，我不明白您为什么需要单个播放器视图。

我绝对认为你想将 singlePlayerViewController 设置为 nil，因为否则 rootViewControllers viewDidLoad 方法中的“if(singlePlayerViewController == nil) {”行将为 false，并且不会创建新的视图控制器，这就是你得到它的原因第一个错误。

我只看到 3 种方式可能会导致“self.view = shakeController.view”行出现访问错误：

*   ShakeController 不是零，而是垃圾。这似乎不太可能，因为它刚刚被初始化，除非它的 viewDidLoad 释放自己或类似的东西。
*   self 不是零，而是垃圾。同样，不太可能，但可能 - 也许检查调试器以查看 self 的样子（它的变量是否有意义等）
*   当您调用 self.view = ... 时，它将向原始视图发送释放。单人视图的dealloc方法中是否有可能导致访问错误的代码？

将 self 或shakeController 设为nil 不会导致错误，因为该行相当于

```
[self setView:[shakeController view]] 
```

如果这些为 nil，则不会崩溃，因为允许向 nil 发送消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T03:09:59.397

是的，所有标有（非原子，保留）的@property 语句。

也许这个问题可以重新表述为，如何多次从 nib 创建视图控制器？我第二次创建 VC 时，无论是否释放同一类的先前 VC，都不会创建关联的视图并抛出 BAD ACCESS 错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-14T19:30:57.997

你这样做的方式让我很困惑，我认为这对你的错误负责。我正在逐行浏览它并试图弄清楚它为什么会崩溃而不是完全弄清楚它，但同时我很难弄清楚在切换期间视图发生了什么。

正如 Kailoa 建议的那样，我会用三个不同的视图控制器重写它。每个视图都应该有自己的控制器。视图不应该替换它自己，它应该被它的父视图控制器替换。

我怀疑在她的某个地方有什么东西被释放然后被发送信息，然后你试图用返回的信息做某事，认为某物是一个对象，而实际上它不是。

# java - 如何使用按位运算符将多个整数值传递给 Java 函数？

> ID：648021
> 
> 赞同：15
> 
> 时间：2009-03-15T15:52:20.183
> 
> 标签：java, function, bit-manipulation, bitwise-operators, integer

在应用程序框架中，我不断看到允许您将多个 Int 值（通常用于代替枚举）传递给函数的框架。

例如：

```
public class Example
{ 
    public class Values
    {
        public static final int ONE = 0x7f020000;
        public static final int TWO = 0x7f020001;
        public static final int THREE = 0x7f020002;
        public static final int FOUR = 0x7f020003;
        public static final int FIVE = 0x7f020004;
    }

    public static void main(String [] args)
    {
        // should evaluate just Values.ONE
        Example.multiValueExample(Values.ONE);

        // should evalueate just values Values.ONE,  Values.THREE, Values.FIVE
        Example.multiValueExample(Values.ONE | Values.THREE | Values.FIVE);

        // should evalueate just values Values.TWO , Values.FIVE
        Example.multiValueExample(Values.TWO | Values.FIVE);
    }

    public static void multiValueExample(int values){
        // Logic that properly evaluates bitwise values
        ...
    }
} 
```

那么 multiValueExample 中应该存在什么逻辑，以便我正确评估使用按位运算符传入的多个 int 值？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-15T15:56:21.140

您的值应该是 2 的幂。

这样，当您对它们进行按位或运算时，您不会丢失任何信息。

```
public static final int ONE   = 0x01;
public static final int TWO   = 0x02;
public static final int THREE = 0x04;
public static final int FOUR  = 0x08;
public static final int FIVE  = 0x10; 
```

等等

然后你可以这样做：

```
public static void main(String [] args) {
    Example.multiValueExample(Values.ONE | Values.THREE | Values.FIVE);
}

public static void multiValueExample(int values){
    if ((values & Values.ONE) == Values.ONE) {
    }

    if ((values & Values.TWO) == Values.TWO) {
    }

    // etc.
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-15T19:20:28.700

如前所述，考虑使用枚举而不是位值。

根据[Effective Java 2](https://rads.stackoverflow.com/amzn/click/com/0321356683)：*“第 32 项：使用[EnumSet](http://java.sun.com/j2se/1.5.0/docs/api/java/util/EnumSet.html)而不是位域”*

使用[EnumSet](http://java.sun.com/j2se/1.5.0/docs/api/java/util/EnumSet.html)对内存使用非常有效，非常方便。

这是一个例子：

```
package enums;

import java.util.EnumSet;
import java.util.Set;

public class Example {
  public enum Values {
    ONE, TWO, THREE, FOUR, FIVE
  }

  public static void main(String[] args) {
    // should evaluate just Values.ONE
    Example.multiValueExample(EnumSet.of(Values.ONE));

    // should evalueate just values Values.ONE, Values.THREE, Values.FIVE
    Example.multiValueExample(EnumSet.of(Values.ONE, Values.THREE, Values.FIVE));

    // should evalueate just values Values.TWO , Values.FIVE
    Example.multiValueExample(EnumSet.of(Values.TWO, Values.FIVE));
  }

  public static void multiValueExample(Set<Values> values) {
    if (values.contains(Values.ONE)) {
      System.out.println("One");
    }

    // Other checks here...

    if (values.contains(Values.FIVE)) {
      System.out.println("Five");
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-15T16:01:29.787

您将整数值设置为 2 的幂，以便每个枚举值都是二进制表示中的单个位。

```
int ONE = 0x1;    //0001
int TWO = 0x2;    //0010
int THREE = 0x4;  //0100
int FOUR = 0x8;   //1000 
```

然后，您使用按位 OR 来组合值并使用按位 AND 来测试设置值。

```
int test_value = (ONE | FOUR);   //-> 1001
bool has_one = (test_value & ONE) != 0;  //-> 1001 & 0001 -> 0001 -> true 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-15T16:00:28.290

您结合的值 | （二进制 OR，而不是逻辑 OR [即 ||]）在其位表示中不能有重叠的“1”。例如，

```
ONE = 0x1 =   0000 0001
TWO = 0x2 =   0000 0010
THREE = 0x3 = 0000 0011
FOUR = 0x4 =  0000 0100 
```

然后你可以结合一和二，例如：

```
ONE | TWO = 0000 0011 
```

但你分不清ONE | 三中二，因为有重叠的位。因此，您组合的数字应该是 2 的幂，这样它们在 OR'ed 在一起时不会重叠。要测试是否在“值”中传递了一个数字，请执行以下操作：

```
if (values & ONE) {
    // ... then ONE was set
} 
```

为了更好地理解它为什么以及如何工作，我建议您阅读一些关于二进制表示和逻辑的内容。一个好地方是[装配艺术的第 3 章](http://webster.cs.ucr.edu/AoA/Windows/HTML/DataRepresentation.html#998834)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-15T16:00:17.120

首先，您不能以这种方式定义值来进行按位比较。相反，设置不同的位：

```
public static final int ONE   = 0x1;  // First bit is set
public static final int TWO   = 0x2;  // Second bit is set
public static final int THREE = 0x4;  // Third bit is set
public static final int FOUR  = 0x8;  // Fourth bit is set
public static final int FIVE  = 0x10; // Fifth bit is set 
```

其次，您可能应该将**[java.util.BitSet](http://java.sun.com/javase/6/docs/api/java/util/BitSet.html)**用于这些类型的操作：

```
BitSet bits = new BitSet(5);
bits.set(2);
bits.set(4);

System.out.println("these bits are set: " + bits);
// Prints "these bits are set: {2, 4}"

BitSet otherBits = new BitSet(5);
otherBits.set(3);
otherBits.set(4);

System.out.println("these bits are set: " + bits.or(otherBits));
// Prints "these bits are set: {2, 3, 4}" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-15T16:08:55.120

好吧，如果它们是 2 的幂，您将在下面的代码中执行类似“显示”方法的操作。

[这是维基百科](http://en.wikipedia.org/wiki/Mask_%28computing%29)中关于该主题的链接，它应该解释为什么你想要 2 的幂。

```
public class Main
{
    private static final int A = 0x01;
    private static final int B = 0x02;
    private static final int C = 0x04;

    public static void main(final String[] argv)
    {
        display(A);
        display(B);
        display(C);
        display(A | A);
        display(A | B);
        display(A | C);
        display(B | A);
        display(B | B);
        display(B | C);
        display(C | A);
        display(C | B);
        display(C | C);
        display(A | A | A);
        display(A | A | B);
        display(A | A | C);
        display(A | B | A);
        display(A | B | B);
        display(A | B | C);
        display(A | C | A);
        display(A | C | B);
        display(A | C | C);
        display(B | A | A);
        display(B | A | B);
        display(B | A | C);
        display(B | B | A);
        display(B | B | B);
        display(B | B | C);
        display(B | C | A);
        display(B | C | B);
        display(B | C | C);
        display(C | A | A);
        display(C | A | B);
        display(C | A | C);
        display(C | B | A);
        display(C | B | B);
        display(C | B | C);
        display(C | C | A);
        display(C | C | B);
        display(C | C | C);
    }

    private static void display(final int val)
    {
        if((val & A) != 0)
        {
            System.out.print("A");
        }

        if((val & B) != 0)
        {
            System.out.print("B");
        }

        if((val & C) != 0)
        {
            System.out.print("C");
        }

        System.out.println();
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-15T18:18:31.687

当每一位都被计算在内时，使用位掩码很流行。今天做到这一点的另一种方法是使用更易于操作和扩展的枚举。

```
import static Example.Values.*;
import java.util.Arrays;

public class Example {
    public enum Values { ONE, TWO, THREE, FOUR, FIVE }

    public static void main(String [] args) {
        // should evaluate just Values.ONE
        multiValueExample(ONE);

        // should evaluate just values Values.ONE,  Values.THREE, Values.FIVE
        multiValueExample(ONE, THREE, FIVE);

        // should evaluate just values Values.TWO , Values.FIVE
        multiValueExample(TWO, FIVE);
    }

    public static void multiValueExample(Values... values){
        // Logic that properly evaluates
        System.out.println(Arrays.asList(values));
        for (Values value : values) {
            // do something.
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-15T16:16:28.097

有关按位运算的 Java 教程章节位于

[http://java.sun.com/docs/books/tutorial/java/nutsandbolts/op3.html](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/op3.html)

它非常简洁，但可供参考。

# eclipse - 如何调试 Eclipse 插件错误“插件无法加载类”？

> ID：648024
> 
> 赞同：2
> 
> 时间：2009-03-15T15:54:54.373
> 
> 标签：eclipse, plugins, eclipse-plugin, debugging

它正在尝试从调试对话框加载我的 TabGroup，但我收到无法加载我的选项卡组类的错误。

在错误的“详细信息”中，它所说的只是：

“org/eclipse/debug/ui/AbstractLaunchConfigurationTabGroup”

这是我的 TabGroup 扩展的类。

# vb.net - Redim 只删除数据，不删除节点

> ID：648029
> 
> 赞同：0
> 
> 时间：2009-03-15T15:58:36.767
> 
> 标签：vb.net, arrays

所以我很困惑。我定义了一个公共 string() 数组，每次触发 timer_tick 事件时，我都会遍历数组并访问数组中包含的网页。

```
for i = 0 to UrlList.Count - 1
  ' Do stuff
  WebBrowser.Navigate(urllist(i))
   While WeBbrowser.ReadyState <> WebBrowserReadyState.Complete
       Application.DoEvents() 
   end while
next

redim urllist(0) ' I have tried w/ & w/out preserve
urllist = nothing
array.resize(urllist,0) 
```

我只想要一个节点数为零的空数组。（基本上消除了整个数组）我有另一个填充数组的进程。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T16:01:11.347

我建议使用列表，而不是数组。您可以使用 list.Clear() 将其清空，并使用 For Each 对其进行迭代。这个数组功能来自 .NET 之前的远古时代，当时 VB 在语言中没有用于列表或其他奇特事物的工具。

# php - Smarty：如何引用关联数组索引

> ID：648042
> 
> 赞同：16
> 
> 时间：2009-03-15T16:03:35.053
> 
> 标签：php, arrays, indexing, reference, smarty

```
Array $imagelist:

Array ( 
    [additional] => Array ( 
        [count] => 2 
        [image] => Array ( 
            [nokia_e61_1.jpg] => Array ( 
                [name_body] => nokia_e61_1 
                [name_ext] => jpg 
            ) 
            [nokia_e61_2.jpg] => Array ( 
                [name_body] => nokia_e61_2 
                [name_ext] => jpg 
            ) 
            [nokia_e61_3.jpg] => Array ( 
                [name_body] => nokia_e61_3 
                [name_ext] => jpg 
            ) 
            [nokia_e61_4.jpg] => Array ( 
                [name_body] => nokia_e61_4 
                [name_ext] => jpg 
            ) 
        ) 
    ) 
    [main] => nokia_e61 
) 
```

该值`nokia_e61_1.jpg`保存在`{$getvars.imagename}`.

我写了`{$imagelist.additional.image.`$getvars.imagename`.name_body}`，但它不起作用。

请帮忙。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-15T16:20:17.167

看看是否`{$imagelist.additional.image[$getvars.imagename].name_body}`有效

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-16T12:29:27.930

我不喜欢 smarty，但我使用它。这是提取表单文档

```
{$foo.$bar}   <-- display variable key value of an array, similar to PHP $foo[$bar] 
```

为了能够做到这一点，你必须

```
{assign var='key' value=$getvars.imagename}
{$imagelist.additional.image.$key.name_body} 
```

希望能帮助到你

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-15T20:26:09.307

重组数组，内部“图像”偏移的键无论如何都是多余的：

```
$imagelist = array('additional' => array('count' => 2,
       'image' => array(
            array('name_body' => 'nokia_e61_1',
                  'name_ext'  => 'jpg'),
            array('name_body' => 'nokia_e61_2',
                  'name_ext'  => 'jpg'),
            array('name_body' => 'nokia_e61_3',
                  'name_ext'  => 'jpg'),
            array('name_body' => 'nokia_e61_4',
                  'name_ext'  => 'jpg')
        )
    ),
    'main' => 'nokia_e61'
); 
```

为您提供数字索引图像：

```
array(2) {
  ["additional"]=>
  array(2) {
["count"]=>
int(2)
["image"]=>
array(4) {
  [0]=>
  array(2) {
    ["name_body"]=>
    string(11) "nokia_e61_1"
    ["name_ext"]=>
    string(3) "jpg"
  }
  [1]=>
  array(2) {
    ["name_body"]=>
    string(11) "nokia_e61_2"
    ["name_ext"]=>
    string(3) "jpg"
  }
  [2]=>
  array(2) {
    ["name_body"]=>
    string(11) "nokia_e61_3"
    ["name_ext"]=>
    string(3) "jpg"
  }
  [3]=>
  array(2) {
    ["name_body"]=>
    string(11) "nokia_e61_4"
    ["name_ext"]=>
    string(3) "jpg"
  }
}
}
["main"]=>
string(9) "nokia_e61"
}

//and then the smarty bit
{$imagelist.additional.image[0].name_body}
{$imagelist.additional.image[1].name_body}
{$imagelist.additional.image[2].name_body}
{$imagelist.additional.image[3].name_body} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T17:25:04.517

```
{php}echo $imagelist['additional']['image'][$getvars['imagename']]['name_body'];{/php} 
```

# ruby-on-rails - RSpec应该redirect_to问题

> ID：648044
> 
> 赞同：11
> 
> 时间：2009-03-15T16:04:56.690
> 
> 标签：ruby-on-rails, rspec

我正在为我的 Rails 控制器编写规范，这是我正在测试的操作：

```
def create
  @course = Course.new(params[:course])
  if @course.save then
    #flash[:notice] = 'Course Created'
    redirect_to courses_path
  else
    render :action => 'new', :status => 400
  end
end 
```

这是验证它的规范：

```
describe "POST /courses [Good Input]" do

  it "should redirect to Courses index page after creation" do
    @course.stub!(:save).and_return(true)
    post :create
    response.should be_success
    response.should redirect_to(courses_path)
  end

end 
```

我仍然从 RSpec 收到此错误：

> 'CoursesController POST /courses [良好输入]
> 
> 创建后应重定向到课程索引页面'

**失败的**

> 预期重定向到“/课程”，没有重定向

任何想法为什么会发生这种情况？

**解决了**

正如**rishavrastogi**所说，*应该 be_success*期望 http 代码在 2xx 范围内，并且重定向属于 3xx 范围（实际上是它的 302）

断言需要更改为 => *response.should be_redirect*。

尽管在这种情况下，检查响应是否为重定向然后检查重定向到特定页面是多余的，因此不再需要断言。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T09:12:25.407

我也不是 RSpec-er，但我想“response.should be_success”不应该存在，因为响应实际上是“HTTP 重定向”而不是“HTTP 成功”......所以尝试删除 response.should be_success

也改变

```
发布：创建
```

到

```
发布：创建，：课程 => {}
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T16:50:14.083

我不是 rspecer，但你必须做类似`assigns(:course).stub!...`. 规范中的实例变量与控制器中的实例变量不同，`assigns`因此您可以访问控制器的实例变量。

# ajax - Ajax 跨域调用

> ID：648048
> 
> 赞同：6
> 
> 时间：2009-03-15T16:08:02.297
> 
> 标签：ajax, json, cross-domain

我们可以向在同一台机器上运行的不同服务器实例（不同端口）发出 Ajax 请求吗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T16:16:40.937

不同的端口意味着浏览器的不同域。因此，您将遇到跨域障碍。

就像 Stuart 说的，你可以尝试使用 JSONP。

如果您使用 jQuery，如果您希望它尽可能轻松，我建议您使用[http://code.google.com/p/jquery-jsonp/ 。](http://code.google.com/p/jquery-jsonp/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-15T16:11:42.040

带着一些诡计。试试[JSONP。](http://remysharp.com/2007/10/08/what-is-jsonp/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-05T13:28:12.887

如果您使用 easyXSS ( [http://easyxss.net](http://easyxss.net) ) 并按照[http://xsslocal.kinsey.no/projects/easyxss/example/methods.html](http://xsslocal.kinsey.no/projects/easyxss/example/methods.html)上的示例进行操作，那么您可以通过在xhr-request 正在执行实际请求的域。

# c# - 将 IL 转换为 C# 代码

> ID：648051
> 
> 赞同：17
> 
> 时间：2009-03-15T16:08:24.247
> 
> 标签：c#, .net

我需要将 IL 转换为 c# 代码。我有一个程序集，我正在阅读这个程序集。我从 MethodInfo 获得 MethodBody 并且 methodbody 有一个方法 GetILAsByteArraY() 现在我想将此 IL 转换为 C# 代码，它返回一个字节数组。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-15T16:11:22.727

不要重新发明轮子；使用 Lutz Roeder 的[.NET Reflector](http://www.red-gate.com/products/reflector/)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-11-21T22:16:16.977

Lutz Roeder 反射器已购买，不再提供免费下载。

[**现在有一个名为ILSpy**](https://github.com/icsharpcode/ILSpy)的免费（再次）工具。我发现它非常好，它不仅可以从 IL 生成 C# 代码，还可以`.csproj`在反编译整个 DLL 程序集时创建一个项目。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-07-19T15:22:20.893

重新发明轮子肯定是一种更好的学习方式！您必须创建自己的类，将 iL 转换为 C#。这需要中级语言的知识。

我假设您已经将字节数组转换为 IL 指令，就像我们在 ildasm.exe、Using Reflection.Emit.OpCodes、OpCode.OperandType、BitConvertor.ReadByte()、BitConvertor.ReadInt32 等中看到的那样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-19T15:41:52.867

如果你想自己做，你可以从旧的 Cecil.Decompiler 开始并增强它，查看[源代码](https://github.com/mono/cecil-old/tree/master/decompiler)和[Jb 的旧帖子。Evain 宣布该项目](http://evain.net/blog/articles/2008/12/15/cecil-decompiler)（链接关闭）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T16:11:51.227

让我们看看我是否能够首先获得它：[.NET Reflector](http://www.red-gate.com/products/reflector/)！这真的应该是一个常见问题解答......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T16:11:56.593

你不能用[Reflector](http://reflector.red-gate.com/download.aspx)做到这一点吗？

您可以加载程序集并将其查看为 VB.net/C#/IL...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-11-21T21:56:56.220

对于搜索引擎的人来说，Reflector 不再免费了。但是，telerik 提供了一种更新更好的**免费**工具，称为[JustDecompile](http://www.telerik.com/products/decompiler.aspx)。我刚刚下载了这个，它太棒了，它只是测试版。显然telerik承诺永远免费。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-15T16:12:33.940

如果你有程序集，你应该只使用[.NET Reflector 。](http://www.red-gate.com/products/reflector/)也尝试[文件生成插件。](http://www.codeplex.com/FileGenReflector)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-15T16:12:38.107

BCL 中没有工具可以做到这一点；但是，有一个很棒的工具叫做[Reflector](http://www.red-gate.com/products/reflector/)，你可以为它编写自己的插件。因此，您可能可以使用它来获取所需的数据。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-15T16:12:44.143

[反射器](http://www.red-gate.com/products/reflector/index.htm)做到了这一点。也许您可以使用 Reflector 来对抗 Reflector 并了解它是如何处理问题的。

您可能还会说为什么要这样做 - 可能有更好的解决方案来解决您的整体问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-15T17:14:12.093

让我成为第一个建议您购买 Red Gate 的 Reflector 的人。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-05-29T14:09:47.830

如果您不想重新发明轮子，也许您应该尝试 Dis#... 它几乎是转换代码的最佳工具 NetDASM 有一个工具可以让您将 C# 转换为 IL。也许你应该看看那个。

# html - 框架集在 IE8 中不起作用

> ID：648061
> 
> 赞同：0
> 
> 时间：2009-03-15T16:12:17.297
> 
> 标签：html, internet-explorer-8, center, frames, frameset

我构建了一个框架集，旨在将网页置于浏览器窗口的中间。

```
<html>

    <frameset rows="100%,567px,100%" border="0">
        <frame src="blank.html" noresize="noresize" scrolling="yes">

        <frameset cols="100%,1128px,100%" border="0">
            <frame src="blank.html" noresize="noresize">
            <frame src="webpage.html" noresize="noresize">
            <frame src="blank.html" noresize="noresize">
        </frameset>

        <frame src="blank.html" noresize="noresize" scrolling="yes">

        <noframes>
            <body>Page requires a frame-supporting browser.</body>
        </noframes>

    </frameset>

</html> 
```

Blank 是一个空的 html 文档。这在 Firefox 和 IE6 中都非常有效，但在 IE8 中它只是显示一个白页，即 blank.html。为什么它与 Firefox 中的显示不一样？

编辑：如果没有我的代码，这显然无法解决，所以在这里，除了 doctype 和 html 标签以及其他一些位之外。我试过你的解决方案，但它仍然没有垂直居中。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="imagetoolbar" content="no">
<title>Untitled Document</title>
<style type="text/css">
<!--
body {
    margin-left: 0px;
    margin-top: 0px;
    margin-right: 0px;
    margin-bottom: 0px;
    background-image: url(xxxbackground.gif);
}
#divInteraction {
    position:absolute;
    width:640px;
    height:480px;
    z-index:1;
    left: 460px;
    top: 47px;
    overflow: hidden;
}
#divVideo {
    position:absolute;
    width:424px;
    height:284px;
    z-index:2;
    left: 13px;
    top: 101px;
    overflow: visible;
}
#imgInteraction {
}
#iframeInteraction {
display: none;
}
-->
</style>
</head>

<body>

<div id="divInteraction">
    <iframe id="iframeInteraction" width="100%" height="100%" ></iframe>
    <img id="imgInteraction" src="powerpoint_pic_0.jpg" />
</div>

  <div id="divVideo">

     <object id="wmvVideo" width="424" height="284" classid="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95" codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,7,1112" standby="" type="application/x-ms-wmp" VIEWASTEXT>

        <param name="AutoSize" value="false" />
        <param name="ShowStatusBar" value="0" />
        <param name="DefaultFrame" value="x" />
        <param name="ShowControls" value="1" />
        <param name="ShowAudioControls" value="1" />
        <param name="ShowPositionControls" value="0" />
        <param name="ShowTracker" value="1" />
        <param name="ShowDisplay" value="0" />
        <param name="ShowCaptioning" value="0" />
        <param name="ShowGoToBar" value="0" />
        <param name="ControlType" value="2" />
        <param name="Autostart" value="1" />
        <param name="InvokeUrls" value="1" />
        <param name="AnimationAtStart" value="0" />
        <param name="TransparentAtStart" value="0" />
        <param name="SendStateChangeEv" value="1" />
        <param name="SendOpenChangeEv" value="1" />
        <param name="SendPlayChangeEv" value="1" />
        <param name="AllowChangeCtrlType" value="1" />
        <param name="AllowChangeDisplaySize" value="1" />
        <param name="AllowScan" value="1" />
        <param name="AutoRewind" value="1" />
        <param name="PlayCount" value="1" />
        <param name="Volume" value="0" />   
        <param name="Filename" value="http://www.example.com/example/example.wmv"/>

    <embed type="application/x-mplayer2"
    pluginspage="http://www.microsoft.com/windows/windowsmedia/download/"
    name="Player1NS"
    AutoSize="false"
    ShowStatusBar="0"
    DefaultFrame="x"
    ShowControls="1"
    ShowTracker="1"
    ShowDisplay="0"
    ShowCaptioning="0"
    ShowGoToBar="0"
    Autostart="1"
    AnimationAtStart="0"
    TransparentAtStart="0"
    PlayCount="1"
    Volume="0"
    Filename="http://www.example.com/example/example.wmv"
    ShowAudioControls="1"
    ShowPositionControls="0"     
    width="424"
    height="284">
    <br />

  </embed>    
 </object>

</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T16:21:42.937

天啊！

您可以在您的 pages.html 文件中使用以下 css 获得完全相同的结果：

```
body {
  width: 1128px;
  margin: auto;
  margin-top: 567px;
} 
```

请注意，将 margin-top 设置为 567 像素只会使您的内容以特定的屏幕分辨率居中。

如果 IE 对 body 标签敏感，你可以用 div 嵌入 body 的全部内容：

```
    <正文>
      <div id="内容" >
         <-- 你的内容-->
      </div>
    <正文>

```

然后使用以下css：

```
html, body {
  width: 100%;
  text-align: center;
}

div#content {
  width: 1128px;
  margin: auto;
  margin-top: 567px;
  text-align: left;
} 
```

现在将你为 body 设置的所有 css 规则应用到 div#content。

编辑：所以我现在看到了 html 代码。

您应该为您的 div 尝试 position:relative 而不是 absolute ，看看我提交的最后一个“解决方案”会发生什么。

此外，删除您之前在 body css 规则中的所有边距设置，并将背景图像移动到 div#content 规则。

...让我知道：P

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T18:49:32.800

不需要框架集。下面的代码将在页面中居中 div。

通过将左右边距设置为自动来完成水平居中。垂直居中是通过将 div 的顶部放在页面下方 50% 的位置来完成的，然后使用 div 高度一半的负上边距将其向上移动到中心。

`html`您还需要将and元素的高度指定`body`为 100%，否则它们只会与内容一样高。

div`position:relative`还可以解决其中绝对定位元素的问题。div 变成了一个层，这意味着其中任何绝对定位的元素都将使用 div 的左上角作为零点，而不是页面。

div上的边框只是看它在哪里。你可以删除它。

该代码在 Firefox 3、IE 7、IE 8 beta 和 Opera 9 中进行了测试。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://data.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://data.w3.org/1999/xhtml">
<head>
<title>Center</title>
<style type="text/css">
html { height: 100%; }
body { margin: 0; padding: 0; height: 100%; }
.Content {
   width: 1128px; height: 567px;
   margin: -283px auto 0; position: relative; top: 50%;
   border: 1px solid #000;
}
</style>
</head>
<body>

<div class="Content">
</div>

</body>
</html> 
```

编辑：
这是粘贴内容和样式的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://data.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://data.w3.org/1999/xhtml">
<head>
<title>Center</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="imagetoolbar" content="no">
<style type="text/css">

html { height: 100%; }
body { margin: 0; padding: 0; height: 100%; background-image: url(xxxbackground.gif); }
.Content { width: 1128px; height: 567px; margin: -283px auto 0; position: relative; top: 50%; }

#divInteraction {
        position:absolute;
        width:640px;
        height:480px;
        z-index:1;
        left: 460px;
        top: 47px;
        overflow: hidden;
}
#divVideo {
        position:absolute;
        width:424px;
        height:284px;
        z-index:2;
        left: 13px;
        top: 101px;
        overflow: visible;
}
#imgInteraction {
}
#iframeInteraction {
display: none;
}

</style>
</head>
<body>

<div class="Content">

<div id="divInteraction">
        <iframe id="iframeInteraction" width="100%" height="100%" ></iframe>
        <img id="imgInteraction" src="powerpoint_pic_0.jpg" />
</div>

  <div id="divVideo">

         <object id="wmvVideo" width="424" height="284" classid="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95" 

codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,7,1112" standby="" 

type="application/x-ms-wmp" VIEWASTEXT>

                <param name="AutoSize" value="false" />
                <param name="ShowStatusBar" value="0" />
                <param name="DefaultFrame" value="x" />
                <param name="ShowControls" value="1" />
                <param name="ShowAudioControls" value="1" />
                <param name="ShowPositionControls" value="0" />
                <param name="ShowTracker" value="1" />
                <param name="ShowDisplay" value="0" />
                <param name="ShowCaptioning" value="0" />
                <param name="ShowGoToBar" value="0" />
                <param name="ControlType" value="2" />
                <param name="Autostart" value="1" />
                <param name="InvokeUrls" value="1" />
                <param name="AnimationAtStart" value="0" />
                <param name="TransparentAtStart" value="0" />
                <param name="SendStateChangeEv" value="1" />
                <param name="SendOpenChangeEv" value="1" />
                <param name="SendPlayChangeEv" value="1" />
                <param name="AllowChangeCtrlType" value="1" />
                <param name="AllowChangeDisplaySize" value="1" />
                <param name="AllowScan" value="1" />
                <param name="AutoRewind" value="1" />
                <param name="PlayCount" value="1" />
                <param name="Volume" value="0" />       
                <param name="Filename" value="http://www.xxx.com/xxx/xxx.wmv"/>

        <embed type="application/x-mplayer2"
        pluginspage="http://www.microsoft.com/windows/windowsmedia/download/"
        name="Player1NS"
        AutoSize="false"
        ShowStatusBar="0"
        DefaultFrame="x"
        ShowControls="1"
        ShowTracker="1"
        ShowDisplay="0"
        ShowCaptioning="0"
        ShowGoToBar="0"
        Autostart="1"
        AnimationAtStart="0"
        TransparentAtStart="0"
        PlayCount="1"
        Volume="0"
        Filename="http://www.xxx.com/xxx/xxx.wmv"
        ShowAudioControls="1"
        ShowPositionControls="0"         
        width="424"
        height="284">
        <br />

  </embed>    
 </object>

</div>

</div>

</body>
</html> 
```

# asp.net - 一次在 HTML 中为多个类实现添加/编辑功能的最佳方法

> ID：648069
> 
> 赞同：0
> 
> 时间：2009-03-15T16:18:15.423
> 
> 标签：asp.net, nhibernate, webforms, scaffolding

我正在用 C# 编写一个 Web 应用程序。我有几个使用 Fluent NHibernate 存储在数据库中的类。用户将能够列出、添加、编辑和删除这些对象。

我想避免逐个类地添加控件来编辑和添加名称或文本等属性，而是有一些方法可以根据类名添加/编辑它们。它应该是获取发布的表单值、验证值、构造正确类型的新对象并调用 ClassXServiceClass.SaveOrUpdate(ClassX cx) 的东西。你推荐什么方法？如果验证失败，我还希望文本框保留它们的值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T16:34:29.440

我不确定这是否与流畅的 nhibernate 一起使用，但[动态数据](http://www.codeplex.com/aspnet/Wiki/View.aspx?title=Dynamic%20Data&referringTitle=Home)非常适合为类/表创建 CRUD 页面。

# internet-explorer - 如何从在 localhost 上运行的网页启动可执行文件？

> ID：648077
> 
> 赞同：0
> 
> 时间：2009-03-15T16:25:00.027
> 
> 标签：internet-explorer, executable

我有一个托管 web 控件 (IE) 并使用 Casini 在 localhost 上运行的应用程序。我用它来运行 CruiseControl.NET（有关该应用程序，请参见[http://www.codeplex.com/ccnetbuildstation](http://www.codeplex.com/ccnetbuildstation)）。

在自定义 CruiseControl.NET 报告中，我想启动其他应用程序，如 Visual Studio。

知道如何从网页启动可执行文件而无需安装额外的应用程序吗？我目前不需要安装任何东西来使用我的应用程序，它由自定义表单应用程序、CruiseControl.NET 和 Cassini 3.5 组成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T16:38:40.273

我不熟悉 CruiseControl.NET，但如果它只是在返回网站的网络服务器中运行的某种网络服务器/应用程序，它不能（也不应该）直接运行可执行文件，但是，我可以想到 3 种方法尽管如此：

1.  编写一个小型启动器应用程序，在应用程序运行时下载它，但您必须单击“打开”、“我确定”、“是的，我知道，这不是安全区域，无论如何都运行它”。它不舒服，但它适用于所有浏览器。
2.  编写一个程序，注册一个协议处理程序，如 run://something.exe 并执行指定的文件。
3.  获取一个执行可执行文件的浏览器插件，我发现的第一件事是[LaunchInIE](http://www.whirlywiryweb.com/q/launchinie.asp)，配置看起来有点乱，但它似乎做你想要的。

# sql - SQL 错误：滥用聚合

> ID：648083
> 
> 赞同：30
> 
> 时间：2009-03-15T16:29:40.623
> 
> 标签：sql, sqlite

SQLite 版本 3.4.0 聚合函数有什么问题？此外，我怀疑 ORDER BY 也不会起作用。如何重写这个？

```
sqlite> SELECT p1.domain_id, p2.domain_id, COUNT(p1.domain_id) AS d1, COUNT(p2.domain_id) AS d2
   ...> FROM PDB as p1, Interacting_PDBs as i1, PDB as p2, Interacting_PDBs as i2
   ...> WHERE p1.id = i1.PDB_first_id
   ...> AND p2.id = i2.PDB_second_id
   ...> AND i1.id = i2.id
   ...> AND d1>100
   ...> AND d2>100
   ...> ORDER BY d1, d2;
SQL error: misuse of aggregate: 
sqlite> 
```

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-03-15T16:32:57.743

使用聚合函数（sum / count / ...）时，您还必须使用 GROUP BY 子句。

接下来，当您想要过滤聚合的结果时，您不能在 WHERE 子句中执行此操作，但您必须在 HAVING 子句中执行此操作。

```
SELECT p1.domain_id, p2.domain_id, COUNT(p1.domain_id) AS d1, COUNT(p2.domain_id) AS d2
    FROM PDB as p1, Interacting_PDBs as i1, PDB as p2, Interacting_PDBs as i2
    WHERE p1.id = i1.PDB_first_id
    AND p2.id = i2.PDB_second_id
    AND i1.id = i2.id
GROUP BY p1.domain_Id, p2.domain_Id
HAVING d1 > 100 AND d2 > 100
ORDER BY d1, d2; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-05-03T09:58:32.180

对此的短版修复是：

当您使用类似的功能时`COUNT/SUM`，您需要使用`HAVING`而不是`WHERE`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-14T01:39:03.133

还要确保您不使用您正在使用 COUNT/SUM 作为 WHERE 子句的列之一。确保对这些变量使用 HAVING 而不是 WHERE。

# wcf - 抛出通用的 FaultException

> ID：648084
> 
> 赞同：4
> 
> 时间：2009-03-15T16:30:00.467
> 
> 标签：wcf, exception

我有一个 WCF 服务，如果出现问题，它会抛出一个通用的 FaultException。我不知道为什么，有时客户端会捕获非泛型 FaultException 而不是泛型异常。

有谁知道，问题是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-15T16:45:35.797

您的服务需要处理所有异常并将它们包装到 FaultException<T> 中，其中 T 是您编写的数据协定。因此，第一步是定义一个包含您的异常信息的自定义数据协定：

```
[DataContract]
public class CustomFault
{
    public string Message { get; set; }
} 
```

然后您指示您的服务合同，它的方法可能会抛出 FaultException<CustomFault>。这允许服务在 wsdl 中公开 CustomFault 类，以便客户端可以生成代理类：

```
[ServiceContract]
public interface IMyServiceContract
{
    [FaultContract(typeof(CustomFault))]
    void MyMethod(string someArgument);
} 
```

下一步是实现这个接口：

```
public class MyService : IMyServiceContract
{
    public void MyMethod(string someArgument)
    {
        // Do something here that could throw exceptions but don't catch yet
    }
} 
```

要处理异常，您可以实现[IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)，只要您的服务方法之一抛出异常，就会使用它。此错误处理程序的目的是将异常包装到 FaultException<CustomFault> 中：

```
public class MyErrorHandler : IErrorHandler
{
    public bool HandleError(Exception error)
    {
        return true;
    }

    public void ProvideFault(Exception error, MessageVersion version, ref Message msg)
    {
        var customFault = new CustomFault()
        {
            Message = error.Message,
        };
        var fe = new FaultException<CustomFault>(customFault);
        MessageFault fault = fe.CreateMessageFault();
        string ns = "http://somenamespace/whatever";
        msg = Message.CreateMessage(version, fault, ns);
    }
} 
```

在客户端注册错误处理程序后，您将始终得到 FaultException<CustomFault>。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-01-07T18:31:11.507

如果您的客户端无权访问 Exception 类型本身（FaultException<T> 上的 <T>），则抛出 FaultException 的非泛型版本。我只是花了几个小时试图弄清楚这一点，当我在 msdn 论坛上找到它时，我最终意识到了这[一点。](http://social.msdn.microsoft.com/Forums/en/wcf/thread/da446cc7-07e2-4821-9357-b3eed9ed8d88)如果在将异常从服务中抛出之前有一些迹象表明异常已更改，那就太好了，但没有。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T17:12:30.287

`FaultException`当服务抛出一些未捕获的其他异常时，将抛出非泛型。您需要找出异常是什么并修复它，如果它是一个错误，或者确定它是您想要向您的客户公开的东西，然后将它包装在一个泛型中`FaultException`并适当地添加一个`FaultContract`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T17:23:35.533

另一种可能性是您的 TDetail 没有被正确序列化。如果例如 TDetail 从 Exception 派生并且您有一个不可序列化的内部异常，则可能会出现这种情况。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-30T13:47:35.547

我看到了同样的问题，Drew 发布的链接为我提供了答案。

我的解决方案是我的服务接口的命名空间与我的服务故障不同。

即，服务合同有：

```
[ServiceContract(Namespace = "http://dummydomain.com/service/searchservice")]
    public interface ISearchService
    .... 
```

服务故障有：

```
[DataContract(Namespace = "http://dummydomain.com/service/searchservicefault")]
public class MySearchServiceFault
... 
```

显然，当命名空间不同时，客户端不知道如何处理它并恢复为非通用 FaultContract ...我认为这在某种程度上取决于客户端，因为我已经看到上面的代码工作并返回通用 FaultContract。 ..

但是，当我将命名空间更改为相同时，它似乎使代码在我的测试中一直有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-31T05:34:25.740

如果您没有使用 FaultContractAttribute 声明故障详细信息类型，则会发生这种情况。

以下是您的服务合同的外观：

```
[ServiceContract]
public interface IMyServiceContract
{
    //...
    [OperationContract]
    [FaultContract(typeof(MyFaultDetail))]
    [FaultContract(typeof(OtherFaultDetail))] 
    GetDetailsResp GetDetails(GetDetailsReq req);
    //...
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-16T01:44:37.660

我有一个类似的问题，它发生在我升级一些 NuGet 包、使用共享的 .NET 标准类等时（我不知道到底是什么原因造成的，两个月内发生了很多变化，但这些都在变化）。结果是之前将 Action 设置为字符串“FAULT”的问题，并且使用默认的 FaultContract 属性在客户端运行良好。但是在这些更改之后（2018 年末），字符串“FAULT”作为操作意味着它不再与故障类匹配，而我得到了一般的 FaultException。**解决所有问题的更改（客户端没有更改）是在抛出 FaultException 而不是 "FAULT" 时将操作设置为 "null"**。我想我'

# linq-to-sql - 如何通过 Nullable 进入存储过程...来自 F#？

> ID：648086
> 
> 赞同：1
> 
> 时间：2009-03-15T16:30:58.420
> 
> 标签：linq-to-sql, f#, null, stored-procedures

我正在尝试使用 F# 的输出参数调用存储过程，因此我需要传递一个`int?`初始化为`null`. 但是，F# 拒绝我的尝试，说对象不能为空。我已经在网上阅读了为什么会这样，但我的问题仍然存在 - 我需要调用该存储过程。有没有人知道我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T16:50:50.603

我不相信 F# 有从 null -> empty Nullable 的转换。但是如果你实例化一个 Nullable 对象，它将默认为无值。这相当于在 C#/VB 中传递 null。

```
myStoredProc (new System.Nullable<int>()) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T02:56:21.600

F# 允许您做的一件好事是声明“通用值”，这样您就不必一直编写冗长的值构造。

```
let gnull = new System.Nullable<_>();; 
```

现在，您可以`gnull`在需要将 null 作为可空值传递给某个函数时使用：

```
> let foo (a:System.Nullable<int>) = 0;;
val foo : System.Nullable<int> -> int

> foo gnull;;
val it : int = 0 
```

# asp.net-membership - LoginControl 无法在 Firefox 中正常工作，需要两次登录尝试

> ID：648087
> 
> 赞同：1
> 
> 时间：2009-03-15T16:31:42.957
> 
> 标签：asp.net-membership

知道为什么 LoginControl 要求用户使用 FireFox 进行两次身份验证但使用 IE 可以正常工作（一次）吗？如果这很重要，我正在使用自定义 MembershipProvider 和 RoleProvider。

我的 web.config 的身份验证部分；

```
<authentication mode="Forms">
      <forms
          timeout="50000000"
          protection="All"
          requireSSL="false"
          slidingExpiration="true"
          cookieless="AutoDetect"
          domain=""
          enableCrossAppRedirects="true">
        <credentials passwordFormat="SHA1" />
     </forms>        
</authentication> 
```

会员部分；

```
 <membership defaultProvider="CustomMembershipProvider">
        <providers>
            <add 
    name="CustomMembershipProvider" 
    type="CustomCrateMembershipProvider" 
    connectionString="" 
    enablePasswordRetrieval="false" 
    enablePasswordReset="true" 
    requiresQuestionAndAnswer="true" 
    applicationName="/" 
    requiresUniqueEmail="true" 
    passwordFormat="Hashed" 
    maxInvalidPasswordAttempts="5" 
    minRequiredPasswordLength="5" 
    minRequiredNonalphanumericCharacters="1" 
    passwordAttemptWindow="10" 
    passwordStrengthRegularExpression=""/>
        </providers>
    </membership>
    <roleManager defaultProvider="CustomRoleProvider" enabled="true">
        <providers>
            <add name="CustomRoleProvider" type="CustomRoleProvider"/>
        </providers>
    </roleManager> 
```

只有与登录相关的代码；

```
protected void OnLoggedIn(object sender, EventArgs e)
{
}

protected void OnLoggingOut(object sender, EventArgs e)
{
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T17:06:11.423

嗯......它在 IE 中工作但在 Firefox 中不起作用似乎很奇怪。

尝试将此添加到您的表单设置中：

```
loginUrl="~/Login.aspx" defaultUrl="default.aspx" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-19T04:54:22.270

在过去的几个小时里，这一直让我发疯 - 通过将 web.config 中的超时更改为更大的值来解决，例如从 30 到 30000

# java - 使用 JLayer 时在 Java 中更改音量

> ID：648107
> 
> 赞同：6
> 
> 时间：2009-03-15T16:43:55.223
> 
> 标签：java, audio, mp3, jlayer

我正在使用 JLayer 播放来自互联网的 mp3 数据输入流。如何更改输出的音量？

我正在使用此代码来播放它：

```
URL u = new URL(s);
URLConnection conn = u.openConnection();  
conn.setConnectTimeout(Searcher.timeoutms);  
conn.setReadTimeout(Searcher.timeoutms);

bitstream = new Bitstream(conn.getInputStream()/*new FileInputStream(quick_file)*/);
System.out.println(bitstream);
decoder = new Decoder();
decoder.setEqualizer(equalizer);
audio = FactoryRegistry.systemRegistry().createAudioDevice();
audio.open(decoder);
for(int i = quick_positions[0]; i > 0; i--){
    Header h = bitstream.readFrame();
    if (h == null){
        return;
    }
bitstream.closeFrame(); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-02-24T07:50:01.963

你可能认为这是一个不可接受的 hack，但它在我编写的 MP3 播放器中工作。它需要向其中一个 JLayer 类添加少量代码。

将以下方法添加到 javazoom.jl.player.JavaSoundAudioDevice。

```
public void setLineGain(float gain)
{
    if (source != null)
    {
        FloatControl volControl = (FloatControl) source.getControl(FloatControl.Type.MASTER_GAIN);
        float newGain = Math.min(Math.max(gain, volControl.getMinimum()), volControl.getMaximum());

        volControl.setValue(newGain);
    }
} 
```

然后，这种新方法允许您使用这样的代码更改音量。

```
if (audio instanceof JavaSoundAudioDevice)
{
    JavaSoundAudioDevice jsAudio = (JavaSoundAudioDevice) audio;
    jsAudio.setLineGain(yourGainGoesHere);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-01-06T22:08:34.883

另一种（非 JLayer）调整 PC 扬声器音量的方法是使用 Sun/Oracle 提供的 javax.sound.sampled 包中的类。

在我的机器上，SPEAKER 是唯一支持的输出目标。

```
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.FloatControl;
import javax.sound.sampled.Line.Info;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.Port;

public class SoundVolumeDemo 
{

    public static void main(String[] args) 
{        
    Info source = Port.Info.SPEAKER;
    //        source = Port.Info.LINE_OUT;
    //        source = Port.Info.HEADPHONE;

        if (AudioSystem.isLineSupported(source)) 
        {
            try 
            {
                Port outline = (Port) AudioSystem.getLine(source);
                outline.open();                
                FloatControl volumeControl = (FloatControl) outline.getControl(FloatControl.Type.VOLUME);                
                System.out.println("       volume: " + volumeControl.getValue() );
                float v = 0.33F;
                volumeControl.setValue(v);
                System.out.println("   new volume: " + volumeControl.getValue() );
                v = 0.73F;
                volumeControl.setValue(v); 
                System.out.println("newest volume: " + volumeControl.getValue() );
            } 
            catch (LineUnavailableException ex) 
            {
                System.err.println("source not supported");
                ex.printStackTrace();
            }            
        }
    } 

 } 
```

这就是我在这个应用程序中实现音量控制的方式：

[http://onebeartoe.com/media-players/randomjuke/filesystem/java-web-start/swing/index.jsp](http://onebeartoe.com/media-players/randomjuke/filesystem/java-web-start/swing/index.jsp)

请注意，我只有在 MS Windows 操作系统机器上使用它的经验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T20:10:26.083

尝试根据您想要获得的音量调整均衡器的所有频段。也许您也可以为此使用[EQFunction](http://www.javazoom.net/javalayer/docs/docs1.0/javazoom/jl/decoder/Equalizer.EQFunction.html)？

```
public class ChangeVolumeFunction extends EQFunction {
    public double volume = 1.0;
    public void setVolume(double volume) { this.volume = volume; }
    public float getBand(int band) { return (float) (Math.log(volume) / Math.log(2) * 6.0); }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-28T15:28:12.167

我在 ChrisH 的回答中制作了自己的版本，但我没有更改 JLayer 的源代码，而是通过反射来做到这一点：

```
Class<JavaSoundAudioDevice> clazz = JavaSoundAudioDevice.class;
Field[] fields = clazz.getDeclaredFields();

try{
    SourceDataLine source = null;
        for(Field field : fields) {
            if("source".equals(field.getName())) {
                field.setAccessible(true);
                source = (SourceDataLine) field.get(device);
                field.setAccessible(false);

                FloatControl volControl = (FloatControl) source.getControl(FloatControl.Type.MASTER_GAIN);
                if (volControl != null) {
                     float newGain = Math.min(Math.max(gain, volControl.getMinimum()), volControl.getMaximum());
                     volControl.setValue(newGain);
                }
            }
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

有点粗糙，但它的工作原理

# c# - 从动态控件获取用户输入

> ID：648110
> 
> 赞同：1
> 
> 时间：2009-03-15T16:45:54.920
> 
> 标签：c#, asp.net, viewstate, dynamic-controls

我正在寻找创建一个动态调查。我从数据库生成所有问题控件的地方。下面是我正在尝试做的一个例子（没有数据库部分）。我可以显示如下所示的问题。我无法阅读用户输入。

有没有人有任何想法。

我已经查看了视图状态，但我似乎无法让它工作。

当页面通过 Post Back 重新加载时，控件就消失了。我查看了我能想到的每一个事件，并且页面上没有控件。直到我在 Page_Load 事件上再次创建它们。

我在哪里可以找到动态创建的控件上的用户输入值？

页

```
<body>
    <form id="form1" runat="server">
    <div>

    </div>
    </form>
</body> 
```

代码文件

```
 protected override void OnPreLoad(EventArgs e)
{
    base.OnPreLoad(e);
    foreach (Control item in form1.Controls)
    { }
}

protected void Page_PreInit(object sender, EventArgs e)
{
    foreach (Control item in form1.Controls)
    { }
}
protected override void OnLoad(EventArgs e)
{
    base.OnLoad(e);
    foreach (Control item in form1.Controls)
    { }
}

protected override void OnSaveStateComplete(EventArgs e)
{
    base.OnSaveStateComplete(e);
    foreach (Control item in form1.Controls)
    { }
}
protected override void OnInit(EventArgs e)
{
    base.OnInit(e);
    foreach (Control item in form1.Controls)
    { }
}
protected void Page_Load(object sender, EventArgs e)
{
    RadioButton rb;
    rb = new RadioButton();
    rb.ID = "rb_1";
    rb.Text = "yes";
    rb.GroupName = "question";
    form1.Controls.Add(rb);

    rb = new RadioButton();
    rb.ID = "rb_2";
    rb.Text = "no";
    rb.GroupName = "question";
    form1.Controls.Add(rb);

    rb = new RadioButton();
    rb.ID = "rb_3";
    rb.Text = "other";
    rb.GroupName = "question";
    form1.Controls.Add(rb);

    TextBox tb = new TextBox();
    form1.Controls.Add(tb);

    Button btn = new Button();
    btn.Text = "Save";
    form1.Controls.Add(btn);

    foreach (Control item in form1.Controls)
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T16:50:45.207

您必须生成具有唯一 ID 的控件。您必须能够用数据库中的一个问题对每个控件 ID 进行数学运算。完成此操作后，您可以将特定问题的答案写回到数据库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T16:53:30.753

编辑：在 OnInit 函数中创建控件（在 Init 事件期间）。检查[这个页面](http://msdn.microsoft.com/en-us/library/ms178472.aspx)。

尝试将“rb”或“tb”变量设置为类范围。或者至少将创建的控件的引用存储在列表（或数组）中，然后在需要时尝试通过它访问它们。

由于您在 OnInit 函数中创建控件，因此它们是在加载视图状态之前创建的。因此，当视图状态被加载时，用户发布的值会从视图状态恢复到控件，因此您可以从代码中访问它。您只需要保留对控件的引用。

# asp.net - “调用目标已引发异常”错误 (mscorlib)

> ID：648113
> 
> 赞同：74
> 
> 时间：2009-03-15T16:47:18.693
> 
> 标签：asp.net, exception, mscorlib

我有一个用 ASP.Net 2.0 开发的网站，它抛出了错误

```
"Exception has been thrown by the target of an invocation" 
```

在生产环境中。它没有在开发中抛出这个错误。

源是“mscorlib”，堆栈跟踪显示错误在

```
System.RuntimeMethodHandle._InvokeMethodFast. 
```

自从我上次上传到生产环境以来，我唯一改变的是我已经开始使用会员控制（登录、登录视图），并添加了更多的存储过程和表等。会员资格取决于我的自定义提供程序我写过。

有人知道为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-03-15T16:51:57.543

我建议检查内部异常。如果没有，请检查您的日志以了解在此之前发生的异常。

这不是特定于 Web 的异常，我在桌面应用程序开发中也遇到过。简而言之，正在发生的事情是接收此异常的线程正在运行一些异步代码（例如，通过 Invoke()），并且正在异步运行的代码因异常而爆炸。此目标调用异常是该失败的后果。

如果您还没有，请在触发此错误时调用的异步回调周围放置某种异常日志记录包装器。例如，事件处理程序。这应该可以帮助您找出问题所在。

祝你好运！

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-08-04T04:06:51.753

调用不存在的方法时可能会发生这种情况。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-09T07:50:10.980

我知道这有点奇怪，但我在 ac# 应用程序中遇到了这个错误，最后我发现问题是表单的图标！当我改变它时，一切都很好。

我应该说我只是在 XP 而不是 7 或 8 中遇到了这个错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-25T05:23:39.937

```
' Get the your application's application domain.
Dim currentDomain As AppDomain = AppDomain.CurrentDomain 

' Define a handler for unhandled exceptions.
AddHandler currentDomain.UnhandledException, AddressOf MYExHandler 

' Define a handler for unhandled exceptions for threads behind forms.
AddHandler Application.ThreadException, AddressOf MYThreadHandler 

Private Sub MYExnHandler(ByVal sender As Object, _
ByVal e As UnhandledExceptionEventArgs) 
Dim EX As Exception 
EX = e.ExceptionObject 
Console.WriteLine(EX.StackTrace) 
End Sub 

Private Sub MYThreadHandler(ByVal sender As Object, _
ByVal e As Threading.ThreadExceptionEventArgs) 
Console.WriteLine(e.Exception.StackTrace) 
End Sub

' This code will throw an exception and will be caught.  
Dim X as Integer = 5
X = X / 0 'throws exception will be caught by subs below 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-04-02T08:24:44.157

由于我没有将我的项目设置为**启动项目，因此出现此错误**

当我将当前项目设置为**设置为启动项目**时，它就消失了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-09-13T07:04:11.317

尝试通过**Management Studio 2014连接到****SQLServer2017时遇到同样的错误**

 **[![在此处输入图像描述](https://i.stack.imgur.com/ZhKjQ.png)](https://i.stack.imgur.com/ZhKjQ.png)

**原因是向后兼容**

所以我刚刚下载了 Management Studio 2017 并尝试连接到 SQLServer2017。

问题解决！！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-20T20:55:22.090

我刚刚从命名空间不匹配中遇到了这个问题。我的 XAML 文件被移植过来，它的命名空间与代码隐藏文件中的命名空间不同。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-24T06:09:00.873

这可能有两个原因

1.我在我的 web.config 文件中发现了连接字符串错误，我更改了连接字符串及其工作。

2.  连接字符串正确然后检查控制面板>服务> SQL Server浏览器>**启动**与否

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-06T21:19:57.263

遇到同样的错误，解决了将目标平台从“混合平台”更改为“任何 CPU”的问题

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-02T09:10:58.050

在我的情况下，这是由于选择在 VS（.NET 5 控制台应用程序）中作为单个文件发布的选项而发生的，一旦我将其更改为正常发布，异常就消失了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-04-02T23:01:47.650

尝试在 Controller 文件夹中添加新控制器后出现此错误，但连接字符串放置在 Web.config 文件中的 entityFramework 标记内。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-29T14:41:10.390

对我来说，当有一个内部呼叫到其他服务器并且该服务器没有在逻辑时间内应答或调用它的配置错误时，就会发生这种情况。我修复了连接到其他服务器的问题，然后我从该服务器收到了正确的数据，并且负责调用该服务器的功能正常工作，然后我没有收到该错误。

# c# - 一个对象怎么能不与 null 比较呢？

> ID：648115
> 
> 赞同：48
> 
> 时间：2009-03-15T16:48:45.943
> 
> 标签：c#, .net, generics

我在 KeyValuePair 方法上有一个“可选”参数。我想要一个将 null 传递给该参数的核心方法的重载，但是在核心方法中，当我想检查 KeyValuePair 是否为 null 时，出现以下错误：

```
Operator '!=' cannot be applied to operands of type System.Collections.Generic.KeyValuePair<string,object>' and '<null>. 
```

如何不允许检查对象是否为空？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-03-15T16:51:37.123

`KeyValuePair<K,V>`是一个结构，而不是一个类。就像这样做：

```
int i = 10;
if (i != null) ... 
```

（尽管由于奇怪的可空转换规则，这实际上是合法的，但有警告。重要的是`if`条件永远不会为真。）

要使其成为“可选”，您可以使用可为空的形式：

```
static void Foo(KeyValuePair<object,string>? pair)
{
    if (pair != null)
    {
    }
    // Other code
} 
```

注意 ? 在`KeyValuePair<object,string>?`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-05-03T17:54:15.860

尽管它很老，但我还是在回答这个问题，因为它是“测试 keyvaluepair 为 null”的第一个 Google 结果

指定的答案是正确的，但它并不能完全回答问题，至少是我遇到的问题，我需要测试它的存在`KeyValuePair`并继续检查`Dictionary`它是否不存在，就像我一样期待。

使用上面的方法对我不起作用，因为编译器在获取`KeyValuePair.Value`时会窒息`KeyValuePair<>?`，所以最好使用`default(KeyValuePair<>)`这个问题+答案中看到的。[KeyValuePair 的默认值](https://stackoverflow.com/q/1641392/528748)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-15T16:51:09.650

因为 KeyValuePair 是结构体（一种值类型），所以只能比较引用类型上的空值。

我猜你还没有写出额外的重载。当您尝试将 null 作为 KeyValuePair 的值传递时，它将失败。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-15T16:53:08.133

KeyValuePair<K,V> 是一个结构，因此在任何情况下都不能为空。只有引用类型可以为空。

如果您试图捕获不正确的值，则必须单独验证 Key 和 Value 成员。

* * *

## 回答 #5

> 赞同：-9
> 
> 时间：2010-04-12T03:14:36.380

您实际上可以使用 KeyValuePair.IsNull() 来确定 KeyValuePair 是否已设置。

# visual-studio-2008 - 如何使用 MS Access 作为 ADO.NET 实体框架的提供者？

> ID：648116
> 
> 赞同：10
> 
> 时间：2009-03-15T16:49:11.277
> 
> 标签：visual-studio-2008, ms-access, ado.net

您知道在 ADO.NET Entity Framework 中使用 MS Access 提供程序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T16:53:55.307

ADO.NET Entity Framework 旨在与作为标准 ADO.NET 提供程序的任何东西一起使用。访问确实如此。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2009-03-16T15:36:53.470

我不知道这是否会对您有所帮助，但请考虑它的价值。以下是我在 C# 中连接到 MS-Access 数据库的连接字符串。

我有一个强类型数据集，我将数据放入其中，然后他们在那里对其进行操作。使用`System.Data.OleDb`命名空间。

```
sourceString = "\\\DatabaseServer\DatabaseFolder\database.mdb";

conString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + sourceString;
string strSql1 = "SELECT * FROM IDTable";
OleDbConnection con = new OleDbConnection(conString);

currentDataSet.IDTable.Rows.Clear();
con.Open();
OleDbDataAdapter dAdapter = new OleDbDataAdapter();
dAdapter.SelectCommand = new OleDbCommand(strSql1, con);
dAdapter.Fill(currentDataSet, "IDTable");
con.Close(); 
```

# php - 如何将我的网站、mySQL、php 页面、文件、设置等迁移到 Amazon EC2？

> ID：648133
> 
> 赞同：5
> 
> 时间：2009-03-15T16:58:26.543
> 
> 标签：php, mysql, windows, amazon-ec2, migrate

嗨，我是 EC2 的新手和服务器管理员的新手，并且一直在使用我们当前的 Web 应用程序使用 Windows 2003 服务器工作，该应用程序由 PHP 页面、mySQL 数据库和来自单个独立 Windows 2003 服务器的图像文件提供。

我想知道如何“打包”我们的服务器并将其作为图像安装在 Amazon Web Services 上。

有没有一种简单的方法可以做到这一点，或者我需要在亚马逊上重建。是否已经安装了 PHP 和 MySQL 的基本 Windows 映像？

我已经完成了注册过程并使用远程桌面连接连接到服务器。我习惯于在dreamweaver 中处理服务器文件，我将如何使用dreamweaver 连接到EC2 服务器？

有人知道这方面的一些好的教程吗？

非常感谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-15T17:40:49.907

这是 Windows 映像的[列表](http://developer.amazonwebservices.com/connect/kbcategory.jspa?categoryID=209)。我找不到你所要求的，所以你需要从现有的开始（最好从已经安装了 IIS 的开始），然后自己安装 PHP 和 MySQL。然后，您可以将其保存为您的基本映像，并将其用于所有后续部署。

但是，您所描述的基础架构并不适合云环境。首先，MySQL 或任何其他关系数据库都不是合适的持久性机制。不能保证您的实例不会消失，如果发生这种情况，则存储在本地文件系统中的所有数据都将丢失。您只能通过使用 Elastic Block Storage 安全地使用 MySQL。这是您的另一个考虑因素。

出于同样的原因，不建议使用简单的图像来提供文件。亚马逊提供 S3 服务，在这方面做得很好。

总而言之，在云环境中部署不同于在专用服务器中部署。您需要不同的架构，而不仅仅是重现您的安装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T16:37:04.643

根据您的网站的文档记录和备份情况，它应该不会太糟糕。当然，尽量坚持使用与您的原始系统尽可能相似的操作系统。事实上，您甚至可以按照文档从头开始构建图像。甚至有一些方法可以通过您自己的 VMWare 设置中的安装媒体构建系统，然后将其推送到 EC2（参见[此处](http://developer.amazonwebservices.com/connect/message.jspa?messageID=61772)和[此处](http://thewebfellas.com/blog/2008/9/1/creating-an-new-ec2-ami-from-within-vmware-or-from-vmdk-files)）。我从来没有这样做过，但原则上听起来可行。如果我有一台长期服务器，我将在 EC2 上运行。

另一方面，您可以只花一百美元左右，然后访问 odesk.com 或其他地方，让某人为您迁移它。只要告诉他你想要一份他所做的一切的全面清单，瞧——即时文档。

**编辑：**正如 kgiannakakis 所说，请确保您清楚 EC2 技术，因为它与托管不同。

# .net - 从 .Net 访问 COM 对象时访问冲突

> ID：648134
> 
> 赞同：1
> 
> 时间：2009-03-15T16:58:50.617
> 
> 标签：.net, com, access-violation, chartfx

如果帖子太长，我很抱歉，但如果有人至少指出粗体标题，我会很高兴，并指出我正确的方向。我这几天遇到这个问题，但无法在网上找到答案。这些是我到目前为止发现的东西。

**1.“访问冲突”异常崩溃了我的托管应用程序**

我的 C# WinForms 应用程序有时会在 Windows 窗体 TabControl 中选择 TabPage 时以“访问冲突”异常（“尝试读取或写入受保护的内存”）关闭。从堆栈跟踪（在 Application.Run 周围尝试/捕获）我可以看到异常发生在`System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)`，在内部调用`UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 dwComponentID, Int32 reason, Int32 pvLoopData)`。

```
-- 消息：试图读取或写入受保护的内存。
   这通常表明其他内存已损坏。
-  堆栈跟踪：
   在 System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW（味精和味精）
   在 System.Windows.Forms.Application.ComponentManager
      .System.Windows.Forms.UnsafeNativeMethods
      .IMsoComponentManager.FPushMessageLoop
      （Int32 dwComponentID，Int32 原因，Int32 pvLoopData）
   在 System.Windows.Forms.Application.ThreadContext
      .RunMessageLoopInner（Int32 原因，ApplicationContext 上下文）
   在 System.Windows.Forms.Application.ThreadContext
      .RunMessageLoop（Int32 原因，ApplicationContext 上下文）
   在 System.Windows.Forms.Application.Run（ApplicationContext 上下文）
   在 MyApp.Program.Main()

```

**2\. 故障模块似乎是一个 COM 对象（ChartFX Client Server 6.2）**

使用 WinDbg（加载了 SoS），我在 ChartFX.ClientServer.Core.dll（这是我们正在使用的 COM 图表组件）内部的非托管端捕获了它：

```
(ca84.c98c)：访问冲突 - 代码 c0000005（第一次机会）
在任何异常处理之前报告第一次机会异常。
可以预期并处理此异常。
eax=00000000 ebx=06e67c38 ecx=06e67c38 edx=000018c6 esi=06e7df30 edi=317a9e80
eip=31666110 esp=0015e040 ebp=0015e08c iopl=0 nv up ei pl zr na pe nc
cs=001b ss=0023 ds=0023 es=0023 fs=003b gs=0000 efl=00010246
ChartFX_ClientServer_Core!Ordinal5507+0x97b7:
31666110 8a404d mov al,byte ptr [eax+4Dh] ds:0023:0000004d=??

```

[编辑：]我也无法从 WinDbg 获得未管理的堆栈详细信息（它说“堆栈展开信息不可用”）：

```
0:000> kP
ChildEBP RetAddr  
警告：堆栈展开信息不可用。以下框架可能是错误的。
0015e08c 3166288b ChartFX_ClientServer_Core!Ordinal5507+0x97b7
0015e394 3165a921 ChartFX_ClientServer_Core!Ordinal5507+0x5f32
0015e480 31678685 ChartFX_ClientServer_Core!Ordinal5496+0x26a
0015e568 3167bef4 ChartFX_ClientServer_Core!Ordinal5492+0x975
0015e668 316a356b ChartFX_ClientServer_Core!Ordinal5492+0x41e4
0015e77c 31709496 ChartFX_ClientServer_Core!Ordinal443+0x5745
0015e7d0 31707f70 ChartFX_ClientServer_Core!Ordinal2584+0x3cdc
0015e7f8 3170817d ChartFX_ClientServer_Core!Ordinal2584+0x27b6
0015e81c 3162fd76 ChartFX_ClientServer_Core!Ordinal2584+0x29c3
0015e86c 7719f8d2 ChartFX_ClientServer_Core!Ordinal899+0x6b6
0015e898 7719f794 USER32!GetMessageW+0x93
0015e910 771a06f6 USER32!GetWindowLongW+0x115
0015e940 771a069c USER32!CallWindowProcW+0x75
0015e960 747fcef4 USER32!CallWindowProcW+0x1b
0015e97c 747fd073 comctl32!Ordinal377+0x5c
0015e9e0 747fd027 comctl32!DefSubclassProc+0x92
0015ea04 747fd4e6 comctl32!DefSubclassProc+0x46
0015ea20 747fd073 comctl32!DefSubclassProc+0x505
0015ea84 747fd118 comctl32!DefSubclassProc+0x92
0015eae4 7719f8d2 comctl32!DefSubclassProc+0x137

```

**3、Bug 不易复现（虽然一般5分钟内就可以引发）**

我在几个 TabPages 中有几个 Chart 实例，这通常发生在我切换选项卡时。我仍然不知道如何重现它，除了在它发生之前切换这些选项卡几分钟，所以我不能使用我们的源代码管理来可靠地找到没有这个问题的构建。我通过 VS 设计器自动创建的托管 AxChart 包装类（从 AxHost 派生）访问图表。

**4\. 我的下一步应该是什么？**

如果有人能指出我应该采取的下一步行动来找到真正的原因，我将不胜感激。实验（删除和返回代码）并没有多大好处，因为我不知道如何重现它，所以每次迭代都需要大量时间才能说服自己该错误仍然存​​在。

我发现人们经常建议“切换编译器优化”之类的东西，但由于异常不是确定性地抛出的，我不想简单地重新排列一些字节并希望它永远不会返回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T13:29:26.803

通过在整个代码中添加大量日志跟踪，我设法注意到在某些情况下，图表的一个属性会变成 Double.NaN。在我得到那个之后，应用程序总是在下一次图表重绘期间崩溃。通过处理图表的 PrePaint 和 PostPaint 事件（幸运的是它有这些事件），我确认崩溃发生在这两个事件之间。

特别是，仅当我在第一次绘制图表之前设置图表的缩放比例（自上次更新以来的第一次）时才会发生这种情况。我设法以不同的方式做到了，从那以后它就没有崩溃过。

我对这个“解决方案”不是很满意，因为它显然是一些内部问题，在它实际崩溃之前无法准确检测到，我可能只是这样隐藏它。但我必须暂时保留它，否则我会浪费太多时间。

**[更新]**

**成功复制错误**

我做了一个快速测试应用程序，在实际绘制之前，我设置了一些图表的属性两次，应用程序立即崩溃。我已经向 Software FX 报告了这个错误，但没有得到答复。这不是我在使用此控件时遇到的第一个恼人的错误，但是对于我们的下一个版本，我们将切换到他们的托管 (.Net) 版本，因此我们至少会有 Reflector 来找出如何解决这些错误。

总之谢谢大家！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T21:16:15.083

它看起来很像一个线程安全问题。
我建议您首先阅读控件的文档，专门寻找线程安全的提及。COM 组件通常使用的线程模型与（微不足道的）.NET 用法不同——而且通常不兼容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T17:08:45.443

前一阵子有一个。我们的例子是一个 PInvoke 调用： OpenPrinter(string port);

我们的问题是托管代码发送了：“LPT1:”，但非托管代码声明了一个 byte[1024] 数组并从字符串地址开始读取 1024 个字节。这将在分配的字符串（“LPT1：”）的范围之外读取，并且偶尔会进入未分配给应用程序的内存，从而导致此间歇性 AccessViolationException。

我们通过将调用更改为： OpenPrinter(int length, string port) 来解决此问题，因此非托管代码可以声明一个长度正确的字节数组。

ctacke 的[这篇文章也有一些关于试图找出可能导致此问题的好东西。](https://stackoverflow.com/questions/402957/what-are-some-techniques-for-troubleshooting-very-intermittent-access-violation-o/403129#403129)

# c++ - 帮助 VS8 命令行到 IDE？

> ID：648138
> 
> 赞同：4
> 
> 时间：2009-03-15T17:00:57.210
> 
> 标签：c++, visual-studio, visual-studio-2008, command-line, ide

问题：

C:\> **cl /LD hellomodule.c /Ic:\Python24\include c:\Python24\libs\python24.lib /link/out:hello.dll**

> 'cl' 不是内部或外部命令、可运行程序或批处理文件。

我正在使用 Visual Studio Prof Edi 2008。

1.  我应该为这个命令设置什么路径？
2.  如何使用 IDE 执行上述命令？

注意：我正在研究[这个](http://en.wikibooks.org/wiki/Python_Programming/Extending_with_C)。

* * *

```
C:\>cl /LD hellomodule.c /Ic:\Python24\include c:\Python24\libs\python24.lib /li
nk/out:hello.dll
'cl' is not recognized as an internal or external command,
operable program or batch file.

C:\>PATH="C:\Program Files\Microsoft Visual Studio 9.0\VC\bin\cl.exe"

C:\>cl
'cl' is not recognized as an internal or external command,
operable program or batch file.

C:\>PATH="C:\Program Files\Microsoft Visual Studio 9.0\VC\bin\cl.exe"

C:\>cl /LD hellomodule.c /Ic:\Python24\include c:\Python24\libs\python24.lib /li
nk/out:hello.dll
'cl' is not recognized as an internal or external command,
operable program or batch file.

C:\> 
```

* * *

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T17:39:55.010

您可以使用设置环境

C:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T17:05:39.570

你的问题能更具体一点吗？究竟是什么不工作？是否找不到程序，编译是否失败，等等...

我能看到的唯一直接问题是命令行无法解析 CL 命令。尝试包含 cl.exe 二进制文件的完整路径。这是我机器上的相关路径。

```
C:\Program Files\Microsoft Visual Studio 9.0\VC\bin\cl.exe 
```

**编辑**

使用路径环境变量时，必须将其设置为路径，而不是应用程序。将您的路径代码更改为

```
set PATH=%PATH%;C:\Program Files\Microsoft Visual Studio 9.0\VC\bin 
```

至于无法加载 mspdb80.dll，我担心弄乱您的环境变量可能会导致这个问题。重新启动您的 cmd.exe 外壳并添加我在上面指定的行并重试。如果您仍然收到 mspdb80.dll 错误，您可能需要修复您的 Visual Studio 安装。

**编辑2**

绝对看起来 PATH 环境变量弄乱了 mspdb80.dll 的加载路径。这个线程有一堆解决这个问题的方法

[http://social.msdn.microsoft.com/Forums/en-US/Vsexpressinstall/thread/2a3c57c5-de79-43e6-9769-35043f732d68/](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressinstall/thread/2a3c57c5-de79-43e6-9769-35043f732d68/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T17:11:09.213

我的程序菜单中有一个“Visual Studio 2008 命令提示符”。您使用的是那个还是命令提示符？

# javascript - 循环遍历它们时，javascript对象中的字段顺序是否可预测？

> ID：648139
> 
> 赞同：16
> 
> 时间：2009-03-15T17:01:28.673
> 
> 标签：javascript, language-features

在php中，如果你有以下代码：

```
$map = array(
  "first" => 1,
  "second" => 2
);

$map["third"] = 3;

foreach($map as $key => $value) {
  // code
} 
```

您知道条目将按照它们添加到数组中的顺序列出。

现在，我可以假设相同的规则适用于下面的 Javascript 等效项吗？

```
map = {
  "first": 1,
  "second": 2
};

map["third"] = 3;

for (key in map) {
  // code
} 
```

* * *

这是以下内容的副本：[元素顺序 - javascript 中的 for (... in ...) 循环](https://stackoverflow.com/questions/280713/elements-order-for-in-loop-in-javascript)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-15T17:12:54.717

大多数浏览器会按照属性添加到对象的顺序循环遍历属性，但是 Javascript 标准说该顺序是未定义的——所以你不应该依赖这种行为。例如，我不久前阅读了[一篇](http://ejohn.org/blog/javascript-in-chrome/)关于 Google Chrome 并非总是表现出这种行为的博客文章。

如果您需要有序的功能，您应该为自己创建一个可以使用对象键或数字键的新类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T17:04:32.083

不，行为取决于实施并且不能保证。当需要保留订单时使用数组。

# asp.net - 如何在asp.net中使用jquery表单提交表单数据？

> ID：648142
> 
> 赞同：0
> 
> 时间：2009-03-15T17:02:54.460
> 
> 标签：asp.net, jquery, forms

我想获取响应值，但是点击按钮没有响应；为什么不在 asp.net 中提交表单？

我的代码：

```
<script type="text/javascript">
$(文档).ready(函数() {
 变量选项 = {
        目标：'#htmlTarget',
        数据类型：'json'，
        网址：'Response.aspx',
        类型：'发布'，
        beforeSubmit: showRequest,
        成功：函数（msg）{警报（msg.txt + '\n\n' + msg.item）；}
 };
 $('#myForm1').ajaxForm(options);

});

函数 showRequest(formData, jqForm,options) {
    返回真；
}

$.fn.serializeNoViewState = 函数（）
{
   return this.find("input,textarea,select,hidden").not("[type=hidden][name^=__]").serialize();    
}

</脚本>

```

```
<form id="myForm1" runat="server">
<div id="htmlTarget"></div>

<input type="text" name="txt">
<br>
<input type="radio" name="item" value="A">A
<input type="radio" name="item" value="B">B
<input type="radio" name="item" value="C">C
<input type="radio" name="item" value="D">D
<br><br>
<input type="submit" name="submitbtn" value="submit">

</form>

```

响应.cs

```
公共部分类响应：System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        Response.Expires = -1;
        if (Request.Form["txt"] != null && Request.Form["item"] != null)
            Response.Write("{txt: '" + Request["txt"] + "',item: '" + Request["item"] + "'}");

    }
}

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-15T17:28:30.123

可能是因为 id-mangling 吗？ASP.NET 认为它可以自由地更改带有 runat="server" 的标签的 ID。检查您生成的 HTML 并检查表单的 ID。

为了解决这种特殊情况，您可以将不 runat=server 的包装元素添加到表单，并通过该元素定位表单。

```
<div id="myform_wrapper">
    <!-- your form here -->
</div> 
```

并以它为目标

```
$("#myform_wrapper form") 
```

# objective-c - 持久化自定义对象

> ID：648143
> 
> 赞同：10
> 
> 时间：2009-03-15T17:03:46.797
> 
> 标签：objective-c, iphone, persistence, plist

我有一个简单地从 NSObject 继承的自定义对象。它有 3 个成员 - 两个浮点数和一个`NSDate`.

我的应用程序将有一个数组，其中包含许多这样的对象，我需要在运行之间保持它。我怎样才能做到这一点？

我曾考虑过使用 SQLite 数据库，但我认为这有点矫枉过正，因为我曾经做过的唯一查询是`select *`.

在理想的世界中，我想使用 xml plist 文件。我不确定我是否可以用我的自定义对象来做到这一点。我知道有一组 Property List 对象，`NSArray`属于它，但`writeToFile:atomically:`仅适用于 property list 对象。

任何想法将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-15T19:58:42.913

`NSCoding`会做你想做的事。我建议您在 Apple 文档中阅读它，但我认为它使用起来非常简单。您的类（和任何子类）将需要实现`NSCoding`协议，并且您需要向对象添加`-encodeWithCoder:`和`-initWithCoder:`方法。大多数常见的框架类`NSCoding`已经实现。

您的课程的代码将如下所示：

```
-(void) encodeWithCoder: (NSCoder*) coder {
  [coder encodeInteger: versionValue forKey: versionKey];
  [coder encodeObject: myStuff forKey: myStuffKey];
}

-(id) initWithCoder: (NSCoder*) coder {
  self = [super init];
  if ( ! self) return nil;
  myStuff = [[coder decodeObjectForKey: myStuffKey] retain];
  return self;
} 
```

建议您在编码时添加一个版本号，以便您在未来版本中灵活地管理对存档格式的更改。

在我的课堂上，我添加了一个方便的方法来归档我的对象：

```
-(void) archiveToFile: (NSString*) path {
  NSMutableData *data = [[NSMutableData alloc] init];
  NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData: data];
  [archiver encodeObject: self forKey: myArchiveKey];
  [archiver finishEncoding];
  [archiver release];
  [data writeToFile: path atomically: YES];
  [data release];
} 
```

另一个用于取消归档或创建新对象：

```
+(MyArchive*) newFromFile: (NSString*) path
            orWithMyStuff: (MyStuff*) myStuff
{
  NSData *data = [[NSData alloc] initWithContentsOfFile: path];
  NSKeyedUnarchiver *unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData: data];
  MyArchive *myArchive = [unarchiver decodeObjectForKey: myArchiveKey];
  [unarchiver finishDecoding];

  if (myArchive) {
    [myArchive retain];
  } else {
    myArchive = [[MyArchive alloc] initWithStuff: myStuff;
  }
  [unarchiver release];
  [data release];
  return myArchive;
} 
```

由于您的顶级对象是`NSArray`，因此您需要针对您的案例修改最后两个方法，但大多数样板代码都是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T18:41:25.923

如果您要检索对象的子集，SQLite 是迄今为止您的最佳选择。

如果不是，则在 plist 格式和 NSCoding 之间进行选择。plist 要求您能够将自定义对象转换为 plist 友好的对象，然后将 plist 转换回您的对象，但是 NSCoding 有点难以绕开您的头，并且不能轻松地手动编辑（或检查） .

# ruby - 单引号字符串与双引号字符串中的反斜杠

> ID：648156
> 
> 赞同：29
> 
> 时间：2009-03-15T17:08:00.157
> 
> 标签：ruby, string, quotes, literals, backslash

如果我在双引号和单引号字符串的开头添加反斜杠+空格，我会得到不同的结果：

```
"\ text"
'\ text' 
```

在双引号字符串的输出中，我只看到一个空格。
在单引号字符串的输出中，我看到了反斜杠+空格。

那里发生了什么？这是因为`'\ '`在双引号字符串中被解释为特殊字符，但在单引号字符串中，字符按原样保留？

如果我将字符串更改为此，我会看到相同的输出，即一个斜杠后跟一个空格，然后是文本：

```
"\\ text"
'\\ text' 
```

在这两种情况下，反斜杠都会被转义。我很困惑为什么他们在这种情况下以同样的方式工作。

是否有一些规则可以帮助解释单引号字符串和双引号字符串如何在 Ruby 中处理反斜杠之间的根本区别？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-15T18:10:21.880

双引号字符串支持全范围的转义序列，如下所示：

*   `\a`响铃/警报 (0x07)
*   `\b`退格 (0x08)
*   `\e`转义 (0x1b)
*   `\f`福尔福 (0x0c)
*   `\n`换行符 (0x0a)
*   `\r`返回 (0x0d)
*   `\s`空间 (0x20)
*   `\t`选项卡 (0x09)
*   `\v`垂直制表符 (0x0b)

对于单引号字符串，将两个连续的反斜杠替换为单个反斜杠，反斜杠后跟单引号变成单引号：

```
'escape using "\\"' -> escape using "\"
'That\'s right'     -> That's right 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-11-26T15:21:01.097

Ruby 只解释双引号字符串中的转义序列。在单引号字符串中，只有`\\`(backslash backslash) 和`\'`(backslash quote) 被视为特殊字符。只有在需要更多解释时才应该使用双引号字符串。否则，单引号会提高性能。

当您提到包含变量的名称时，Ruby 从不这样做。只是变量名被视为更多的字符串文字。要包含变量（或任何表达式）的值，请将表达式放入如下：

```
"#{variable}" 
```

请注意，这仅适用于双引号字符串。要将变量添加到单引号中，您需要执行以下操作：

```
'The value of X is: '+X 
```

如果您需要严格的格式化，请查看 Ruby 的 sprintf 和 printf 版本。它们几乎是 C 函数的包装器，功能强大，但使用起来有点麻烦。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-15T17:29:38.403

我建议您参阅“ [Ruby Programming/Strings](http://en.wikibooks.org/wiki/Ruby_Programming/Strings#Single_quotes) ”，以获得对差异的非常简洁而全面的概述。

从参考：

> `puts "Betty's pie shop"`
> 
> `puts 'Betty\'s pie shop'`
> 
> 因为 "Betty's" 包含一个撇号，它与单引号的字符相同，所以在第二行中我们需要使用反斜杠来转义撇号，以便 Ruby 理解撇号在字符串文字中，而不是标记结束字符串文字。后跟单引号的反斜杠称为转义序列。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-16T11:52:13.510

这不是一个完整的答案（因为已经回答了简单的问题），而是补充信息。

[你喜欢哪种风格的 Ruby 字符串引用？](https://stackoverflow.com/questions/279270/which-style-of-ruby-string-quoting-do-you-favour)

> 如果必须转义，请不要使用双引号。并且不要陷入“单引号对双引号”的陷阱。Ruby 对字符串文字的任意分隔符有很好的支持：
> 
> [http://rors.org/2008/10/26/dont-escape-in​​-strings](http://rors.org/2008/10/26/dont-escape-in-strings)

我接受了这个建议，再也没有回头！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-15T18:00:17.503

> 这是因为 '\ ' 被解释为双引号字符串中的特殊字符，但在单引号字符串中，字符按原样保留？

是的。单引号字符串被视为文字；双引号字符串被插值。这在其他类似 Ruby 的语言中是相同的，并且在 1.9 中没有改变。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-04T00:10:35.590

你（们）能做到`<%= f.label :nom_entreprise, "Nom de l'entreprise" %>`

# c# - 如何从 C# 中的字符串创建实例？

> ID：648160
> 
> 赞同：12
> 
> 时间：2009-03-15T17:11:03.253
> 
> 标签：c#, reflection

我正在从包含我需要实例化的对象类型及其构造函数参数的 XML 中读取信息。

对象类型实际上在另一个项目中，在同级命名空间中。（我需要在 Company.Project1 类中创建一个 Company.Project2.Type。）

我发现[了这个问题](https://stackoverflow.com/questions/223952/c-create-an-instance-of-a-class-from-a-string)，但它不处理构造函数参数或它在另一个命名空间中的事实。

我怎样才能做到这一点？

**编辑：**项目属性中未正确设置程序集名称和默认命名空间。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-15T17:15:02.713

*   您需要指定完整的类型名称[`Type.GetType()`](http://msdn.microsoft.com/en-us/library/w3f99sx1.aspx)，包括命名空间，例如“Company.Project2.Type”
*   如果类型不在同一个程序集（或 mscorlib）中，您还需要提供程序集名称，如果它是强类型的，则包括版本信息。例如，对于非强类型程序集`Company.Project2.dll`，您可以指定“Company.Project2.Type, Company.Project2”。
*   要使用参数调用构造函数，您可以调用[`Activator.CreateInstance(Type, Object[])`](http://msdn.microsoft.com/en-us/library/wcxyzt4d.aspx)或获取所需的确切构造函数[`Type.GetConstructor()`](http://msdn.microsoft.com/en-us/library/system.type.getconstructor.aspx)，然后调用[`ConstructorInfo.Invoke()`](http://msdn.microsoft.com/en-us/library/system.reflection.constructorinfo.invoke.aspx).

如果这没有帮助，请提供更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T17:20:05.743

如果您想在运行时动态创建类型，Activator.CreateInstance 方法将为您完成。如果您的问题是具有带参数的构造函数的类型，则此重载将执行此操作。例如， http: [//msdn.microsoft.com/en-us/library/wcxyzt4d.aspx](http://msdn.microsoft.com/en-us/library/wcxyzt4d.aspx)

我建议通过重载寻找最佳匹配。

命名空间问题不应该是相关的——只要 dll 在 bin 目录或 GAC 中，你应该没问题。如果程序集是强命名的，规则可能会改变。

您能否提供不起作用的代码的代码片段（使用您链接到的方法）？这+您看到的错误将非常有帮助！[更新] 使用 Activator.CreateInstance 处理带参数的构造函数的快速示例。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            BaseProduct b =(BaseProduct)System.Activator.CreateInstance(Type.GetType("ConsoleApplication1.Product")
                ,new object[]{typeof(string)}, 
                new object[]{"123"}
            );
            //Activator..::.CreateInstance Method (Type, array<Object>[]()[], array<Object>[]()[])
        }
    }
    public class Product: BaseProduct{
        public  Product(string id) { 

        }
        public string Id {get;set;}

   }

    public abstract class BaseProduct {
        abstract public string Id { get; set; }
    }
} 
```

# c# - 泛型函数问题 C#

> ID：648165
> 
> 赞同：0
> 
> 时间：2009-03-15T17:13:23.280
> 
> 标签：c#, asp.net, generics

我有一个通用函数和以下类层次结构：

```
protected virtual void LoadFieldDataEditor <T1, T2> (T1 control, T2 objData, string strFieldName) where T1 : Control where T2 : BaseDataType
{
  //I will need to access field1\. 
  //I don't know at compile time if this would be SomeType1 or 
 //SomeType2 but all of them inherit from BaseDataType. 

  //Is this possible using generics?
}

public abstract class BaseDataType {}

public class SomeType1 : BaseDataType
{
   string field1;
   string field2;
}

public class SomeType2 : BaseDataType
{
   string field3;
   string field4;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T17:16:42.100

这只有在您有一些公开 field1 的具体类型时才有可能。在这种情况下，您有 BaseDataType 可以提供在所有基类中实现的虚拟属性。

```
public abstract class BaseDataType {
  public abstract string Field1 { get; } 
} 
```

这允许您访问 LoadFieldDataEditor 中的属性

```
protected virtual void LoadFieldDataEditor <T1, T2> (T1 control, T2 objData, string strFieldName) where T1 : Control where T2 : BaseDataType
{
  string f1 = objData.Field;
} 
```

在 SomeType1 中实现该属性是直截了当的。只需实现该属性并返回基础字段。

```
public class SomeType1 : BaseDataType {
  public override string Field1 { get { return field1; } }
  // Rest of SomeType
} 
```

但问题是 SomeType2 应该为 Field1 返回什么？您的问题不清楚应该如何实施。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T17:16:04.647

不。除非在 BaseDataType 上声明了“field1”，否则如果不强制转换为 SomeType1，它将无法访问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T17:31:17.480

不，但这首先并不是对泛型方法的适当使用。只需将您的方法重写为：

```
`protected virtual void LoadFieldDataEditor(Control control, BaseDataType objData, string strFieldName)
{
    SomeType1 type1 = objData as SomeType1;
    if (type1 != null)
    {
         // use type1.field1 here!
    }

}` 
```

`如果您将两种类型都限制为两种特定的引用类型，则泛型方法对您没有任何帮助。你可以直接使用基类——它更简单，更容易调用，更容易理解，整体效果更好。`

 `# sql - 如何获取 SQL 登录用户的 Windows 登录用户名

> ID：648166
> 
> 赞同：16
> 
> 时间：2009-03-15T17:14:07.117
> 
> 标签：sql, sql-server, windows, sql-server-2005

通过使用 sp_who2 我可以获得当前登录用户和机器名称的列表。一些用户使用 sa 等 SQL Server 登录用户名。有什么方法可以获取 SQL 登录用户的 windows 登录用户名？

如果无法从机器名中获取 Windows 登录用户，我可以使用 WMI 类或 C# 来通过机器名找出 Windows 登录用户名吗？

我的 SQL 服务器是 Microsoft SQL Server 2005，Windows 是 Server 2003。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-12-30T18:46:42.820

要获取用户和机器名，请使用以下命令：

```
SELECT HOST_NAME() AS HostName, SUSER_NAME() LoggedInUser 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T05:55:00.203

SQL 登录名和 NT 用户名之间没有链接。

你在这里问过类似的问题：[How to find out user name and machine name to access to SQL server](https://stackoverflow.com/questions/641515/how-to-find-out-user-name-and-machine-name-to-access-to-sql-server/641620)

如果超过 1 个用户登录到客户端 PC（例如服务帐户、通过 mstsc 的远程用户等），WMI 方法将不明确。像这样的任何方法都需要客户端 PC 上的管理员权限才能用于所使用的帐户。

我怀疑你可以实时做到这一点。

您所能做的就是从那里记录输入`client_net_address`和`sys.dm_exec_connections`回溯，可能是通过 WMI 而不是从 SQL Server 本身。

你需要用户名吗？或者只是客户端 PC，以便您可以更改应用程序连接字符串？

如果您只有相对较少的 SQL 连接，您最终的解决方案是更改 sa 密码并查看谁调用了

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-31T18:28:26.900

1.  您可以通过查询会话和连接来获取客户端 IP 地址和远程 PID。
2.  使用此信息构建 TASKLIST 命令。
3.  使用 XP_CMDShell 执行构建的命令来获取用户。

    ```
    DECLARE @CMD VARCHAR(500) = 
    (SELECT  TOP 1 'tasklist /S ' + client_net_address + 
    ' /FI "PID eq ' + CONVERT(VARCHAR(MAX),host_process_id) + 
    '" /V /FO LIST /U DOMAIN\Admin /P password' 
    FROM sys.dm_exec_connections C JOIN sys.dm_exec_sessions S
    ON C.session_id = S.session_id WHERE S.session_id = @@SPID)
    EXEC xp_cmdshell @CMD
    ```

您可以随意使用它。要么通过在 ALL SERVER 触发器中使用它来向 DBA 发送邮件，要么用于 Ad-Hoc 审计。希望这会有所帮助=)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T17:49:10.730

我不知道是否有办法完全按照您的要求进行操作。但是，我过去所做的是使用 sql profiler 并在结果列中包含“主机名”。我工作的机器名称恰好是唯一的，并且可以追溯到用户。如果您的机器名称也是唯一的，这可能会得到您需要的结果。您可以过滤登录名 = sa 以缩小结果范围。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T17:57:44.827

我在黑暗中拍摄，但也许我的想法会帮助你找到答案。据我所知，没有直接的方法可以得到这个。恕我直言，这是一件好事。现在有几个想法：

如果这是一个自定义应用程序，您也许可以将该信息作为应用程序名称包含在连接字符串中。如果这是一个服务器应用程序并且您使用模拟，那么如果您这样做，您将失去连接池的能力。在客户端应用程序上，这应该不是问题。

您的客户在任何给定时间都只有一个登录用户吗？例如桌面应用程序？您可以这样使用[WMI](http://computerperformance.co.uk/vbscript/wmi_who_logon.htm#Example_1_-_Discover_who_is_Logged_on_at_a_Computer)。如果这又是一个服务器，并且您想知道它运行在谁的安全上下文下，您可能仍然能够获取此信息。否则，您至少可以弄清楚是谁启动了该过程。

SQL Profiler 知道客户端进程的 PID。但我找不到它在 SQL 中的存储位置。如果您能找到如何获取 PID（您可以以编程方式运行跟踪并将登录事件存储到表中）。[您可以使用此脚本](http://benreichelt.net/blog/2006/01/31/get-process-user-name/)获取启动用户。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T18:24:38.320

好的。我尝试使用 WMI 类来获取远程计算机的信息（WMI 类 \fullmancinename\roor\cimc2，以及对象查询 select * from Win32_ComputerSystem）。它适用于我的本地计算机，但使用远程计算机名称，您需要传递具有足够安全权限的用户名和密码才能访问或读取。从远程计算机获取用户名是另一个需要处理的 Windows 安全问题。

我的尝试代码基于参考[C# Read Windows Logon User Name in WMI](http://alperguc.blogspot.com/2008/11/c-read-windows-logon-user-name-in-wmi.html)。

# regex - 正则表达式：如何匹配包含重复模式的字符串？

> ID：648170
> 
> 赞同：3
> 
> 时间：2009-03-15T17:15:07.520
> 
> 标签：regex, string

是否存在匹配包含重复模式的字符串的正则表达式模式，例如：

```
"a"|"b","c"|"d",...,"y"|"z"
```

你有什么主意吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T17:30:08.730

也许你正在寻找这样的东西：

```
^"."\|"."(,"."\|".")*$ 
```

这将匹配以逗号分隔的`"`*α* `"|"`*β*`"`形式的序列列表，其中*α*和*β*可以是任何字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T18:06:26.507

请注意，要真正寻找重复的模式，您可以像这样使用分组：

```
<(htmltag>).*\1 
```

其中 \1 指的是重复的第一组中的匹配字符串。有道理？

# c++ - 如何在 C++ 中的大端和小端值之间进行转换？

> ID：648177
> 
> 赞同：2
> 
> 时间：2009-03-15T17:21:41.013
> 
> 标签：c++, visual-studio, bytecode-manipulation

如何在 C++ 中的大端和小端值之间进行转换？我正在使用 VC++ 6.0。当我使用 _byteswap_ulong() 函数时，它需要头文件 intrin.h。当我包含头文件时，它会报告一个错误，指出编译器不兼容，并且 intrin.h 用于 gcc 编译器。那么除了这个函数之外，还有其他函数可以在 VC++ 中的 big-endian 和 little-endian 值之间进行转换吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T17:45:00.833

在符合 POSIX 的系统中，您拥有标准的 byteswap(3) 函数：

```
#include <arpa/inet.h>

uint32_t htonl(uint32_t hostlong);
uint16_t htons(uint16_t hostshort);
uint32_t ntohl(uint32_t netlong);
uint16_t ntohs(uint16_t netshort); 
```

这些专供网络使用，如名称所示（主机到网络长、主机到网络短等）

GNU 和 BSD 系统也提供 endian(3) 函数：

```
#define _BSD_SOURCE
#include <endian.h>

uint16_t htobe16(uint16_t host_16bits);
uint16_t htole16(uint16_t host_16bits);
uint16_t be16toh(uint16_t big_endian_16bits);
uint16_t le16toh(uint16_t little_endian_16bits);

uint32_t htobe32(uint32_t host_32bits);
uint32_t htole32(uint32_t host_32bits);
uint32_t be32toh(uint32_t big_endian_32bits);
uint32_t le32toh(uint32_t little_endian_32bits);

uint64_t htobe64(uint64_t host_64bits);
uint64_t htole64(uint64_t host_64bits);
uint64_t be64toh(uint64_t big_endian_64bits);
uint64_t le64toh(uint64_t little_endian_64bits); 
```

（在 OpenBSD 上，位宽的数字总是在函数的末尾：例如 be64toh() 与 betoh64()。）

否则，大多数人都会定义自己的宏或函数：

```
#define bswap16(x) ((x)>>8 | ((x)&255)<<8)
#deinfe bswap32(x) ((bswap16((x)>>16)&65535)|(bswap16((x)&65535)<<16))
/* etc. */ 
```

您还可以使用汇编内在函数，例如 x86 上的 bswap 指令。`__builtin_bswap64`在 GCC 和 ICC 中。自 VS7.0 以来，VS 中也有类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T17:27:21.310

[文档](http://msdn.microsoft.com/en-us/library/a3140177.aspx)似乎说这些函数存在于 stdlib.h 中。

# java - 解释 Enum 声明中使用的泛型

> ID：648188
> 
> 赞同：4
> 
> 时间：2009-03-15T17:29:52.350
> 
> 标签：java, generics, enums

有人可以解释一下这是什么意思吗？

```
Enum<T extends Enum<T>> 
```

这似乎是一个循环定义，我觉得至少可以说非常令人困惑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T17:34:38.080

[Java Generics FAQ 中](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TypeParameters.html#FAQ106)有一个很好的解释。

从结尾位：

> 总而言之，该声明`Enum<E> extends Enum<E>>`可以解读为：`Enum`是一个只能为其子类型实例化的泛型类型，并且这些子类型将继承一些有用的方法，其中一些采用子类型特定的参数（或以其他方式依赖于子类型）。

（虽然我很同情——递归泛型声明很痛苦。我的协议缓冲区端口到 C# 更糟糕：它需要两个声明，每个声明都引用自己*和*彼此......我还没有找到简化它们的方法。 )

# list - F# 将 Array2 转换为列表

> ID：648193
> 
> 赞同：5
> 
> 时间：2009-03-15T17:35:57.827
> 
> 标签：list, f#

我还是函数式编程的新手，所以如果我不知道如何做某事，我会恢复到程序风格。我找到了一种不必转换为列表的方法，但我仍然想知道如何。

这是我将二维数组转换为列表的尝试。

```
let board = Array2.init 10 20 (fun i j -> pull(i, j))

let mutable pieces = []

board
|> Array2.mapi (fun i j a -> transform(i, j, a))
|> Array2.iter (fun a -> (pieces <- a :: pieces)) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-15T18:02:57.857

显然在 .Net 中，多维数组是 IEnumerable （非泛型），因此这是有效的：

```
let a2 = Array2.init 2 3 (fun x y -> (x+1)*(y+1))
let l = a2 |> Seq.cast<int> |> Seq.fold (fun l n -> n :: l) []
printfn "%A" l 
```

编辑：正如 Noldorin 在评论中指出的那样，这甚至更好：

```
let l = a2 |> Seq.cast<int> |> Seq.toList 
```

# c - C 标准是否定义了堆栈溢出行为？

> ID：648194
> 
> 赞同：5
> 
> 时间：2009-03-15T17:36:09.170
> 
> 标签：c, standards, stack-overflow

是否有处理堆栈溢出的定义行为？

除了终止进程之外，似乎没有很多事情可以做。我只是想知道是否有人可能知道 C 标准对此有何评论。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-15T17:42:09.107

该标准不要求使用堆栈，也没有提及堆栈溢出。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-15T18:15:55.500

C99 标准没有定义堆栈。它只抽象地讨论了自动或分配的存储，而带有溢出检测的连续堆栈只是实现自动存储的一种机制。

该标准的第 7.14 节将 SIGSEGV 定义为在*“对存储的无效访问”*时出现的信号。C 的实现不需要生成任何信号，但如果检测到堆栈溢出，则使用连续固定大小堆栈*的实现通常会发出 SIGSEGV 信号。

您可以为 SIGSEGV 注册一个信号处理函数，但它不能返回 - *"[i]f 并且当函数返回时，如果 sig 的值是 SIGFPE、SIGILL、SIGSEGV 或任何其他与 a 对应的实现定义的值计算异常，behavio[u]r 未定义”*。

（* 并不是我故意使用 C 实现，但我不知道 C 标准中的任何内容阻止使用用于在其他环境中实现可增长自动存储域的常用技术）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-15T17:42:15.753

C 标准甚至没有定义堆栈，因此它当然没有定义堆栈溢出时会发生什么。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-15T18:23:40.163

这里的答案是正确的，说明它与 c 标准无关，但你的说法“除了终止进程，似乎没有很多事情可以做”——一般来说——真的。

事实上，在大多数具有虚拟内存管理和按需分页的系统上，分配的堆栈非常小（通常比当前使用的多 4KB）并且经常溢出（这会产生页面错误中断）并且操作系统只是添加另一个页面内存到线程的堆栈。

堆栈限制（通常为 1MB）只是为防止程序失控而选择的一个相当随意的数字，通常不是绝对限制（尽管它是在某些带有英特尔处理器 IIRC 的内存模型上）。为每个线程分配 1MB 的物理内存通常是没有意义的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-15T17:42:30.353

根据[this question](https://stackoverflow.com/questions/627201/why-do-i-have-to-use-free-on-a-pointer-but-not-a-normal-declaration/627211)的一些答案，C标准甚至没有关于堆栈的存在说什么，更不用说堆栈溢出了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T17:38:09.053

我相当确定发生的事情的细节是由操作系统定义的，但是，在所有情况下，程序都应该退出。您正确地假设一旦发生堆栈溢出（至少作为程序员），您实际上无能为力。你真正能做的就是从一开始就阻止它们发生。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-15T17:39:44.730

这取决于操作系统。但是，许多操作系统允许覆盖默认堆栈大小。例如，在 Windows 上，您可以使用[此链接器标志](http://msdn.microsoft.com/en-us/library/tdkhxaks(VS.80).aspx)将堆栈大小从 1MB 增加到更高的值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-15T18:16:25.797

正如其他人所提到的，该标准没有说明堆栈。

但是，我认为这是定义堆栈溢出行为，标准会说它会导致未定义的行为。

::边缘射击::

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-02-26T07:40:02.027

C标准在这方面是矛盾的。考虑以下程序：

```
void foo(uintptr_t n)
{
    int a;
    printf("%p\n", (void *)&a);
    if (n+1) foo(n+1);
}
int main()
{
    int a;
    printf("%p\n", (void *)&a);
    foo(0);
} 
```

该程序完全符合要求，不违反任何最低翻译限制，正如其他人所说，标准语言中没有关于堆栈限制/溢出的任何内容。但是，它会产生`UINTPTR_MAX`+2 个对象`a`（在每个调用级别），它们的生命周期都重叠，每个对象都有不同的地址。这是不可能的，仅靠计数论证。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-02-25T20:10:27.547

在某些系统上，确保堆栈溢出后任何一种可预测的好处都会给每个函数调用增加相当大的开销；因此，该标准相当合理地将堆栈溢出视为未定义行为。如果目标是最大限度地提高实现运行合法程序的效率，这是完全合适的。

该标准也不要求系统有足够的堆栈来支持任何重要的函数调用深度。鉴于一些有用的程序（尤其是在嵌入式系统领域）可以使用少于 16 字节的堆栈，并且可能不一定能够腾出更多的 RAM，因此需要一个大的堆栈将违反“不要'不要为你不需要的东西买单'。

不幸的是，程序无法说明它需要什么样的深度，也无法查询什么样的堆栈可用，唯一可以保证不参与未定义行为的程序是那些堆栈使用低于最低保证；在嵌入式系统世界之外，这基本上意味着该标准不保证任何比玩具大的程序。

# c# - C# 动态类型转换

> ID：648195
> 
> 赞同：6
> 
> 时间：2009-03-15T17:36:16.767
> 
> 标签：c#

我们有 2 个对象 A 和 B：A 是 system.string，B 是一些 .net 原始类型（string、int 等）。我们想编写通用代码将 B 的转换（解析）值分配给 A。有什么建议吗？谢谢，阿迪巴尔达

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-15T18:12:13.077

进行字符串转换的最实用和通用的方法是`TypeConverter`：

```
public static T Parse<T>(string value)
{
    // or ConvertFromInvariantString if you are doing serialization
    return (T)TypeDescriptor.GetConverter(typeof(T)).ConvertFromString(value);
} 
```

类型转换器比实现`IConvertible`等更多的类型，您还可以在编译时将转换器添加到新类型；

```
[TypeConverter(typeof(MyCustomConverter))]
class Foo {...}

class MyCustomConverter : TypeConverter {
     // override ConvertFrom/ConvertTo 
} 
```

如果您需要，也可以在运行时（对于您不拥有的类型）：

```
TypeDescriptor.AddAttributes(typeof(Bar),
    new TypeConverterAttribute(typeof(MyCustomConverter))); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-15T17:51:26.573

如前所述，System.Convert 和 IConvertible 将是第一个赌注。如果由于某种原因您不能使用这些（例如，如果内置类型的默认系统转换不适合您），一种方法是创建一个字典来保存每个转换的委托，并在其中进行查找以在需要时找到正确的转换。

例如; 当您想从 String 转换为 X 类型时，您可以使用以下内容：

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine(SimpleConvert.To<double>("5.6"));
        Console.WriteLine(SimpleConvert.To<decimal>("42"));
    }
}

public static class SimpleConvert
{
    public static T To<T>(string value)
    {
        Type target = typeof (T);
        if (dicConversions.ContainsKey(target))
            return (T) dicConversions[target](value);

        throw new NotSupportedException("The specified type is not supported");
    }

    private static readonly Dictionary<Type, Func<string, object>> dicConversions = new Dictionary <Type, Func<string, object>> {
        { typeof (Decimal), v => Convert.ToDecimal(v) },
        { typeof (double), v => Convert.ToDouble( v) } };
} 
```

显然，您可能希望在自定义转换例程中做一些更有趣的事情，但这说明了这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T17:38:58.040

已经存在的**[System.Convert](http://msdn.microsoft.com/en-us/library/system.convert.aspx)**类和**[IConvertible](http://msdn.microsoft.com/en-us/library/system.iconvertible.aspx)**接口有什么问题？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-24T12:20:56.440

MSDN 上有类型转换的[概述](http://msdn.microsoft.com/en-us/library/98bbex99%28v=vs.110%29.aspx)，您可以在其中获得有关该主题的更多信息。我发现它很有用。

# c# - 从 Linq 到 Sql 的随机行

> ID：648196
> 
> 赞同：116
> 
> 时间：2009-03-15T17:37:16.343
> 
> 标签：c#, .net, linq-to-sql

当我有条件时，使用 Linq to SQL 检索随机行的最佳（和最快）方法是什么，例如某些字段必须为真？

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2009-03-15T18:07:21.043

您可以在数据库中使用伪造的 UDF 来执行此操作；在部分类中，向数据上下文添加一个方法：

```
partial class MyDataContext {
     [Function(Name="NEWID", IsComposable=true)] 
     public Guid Random() 
     { // to prove not used by our C# code... 
         throw new NotImplementedException(); 
     }
} 
```

然后只是`order by ctx.Random()`; 这将在 SQL-Server 上进行随机排序，由`NEWID()`. IE

```
var cust = (from row in ctx.Customers
           where row.IsActive // your filter
           orderby ctx.Random()
           select row).FirstOrDefault(); 
```

请注意，这只适用于中小型桌子；对于巨大的表，它会对服务器的性能产生影响，并且找到行数（`Count`）然后随机选择一个（ ）会更有效`Skip/First`。

* * *

对于计数方法：

```
var qry = from row in ctx.Customers
          where row.IsActive
          select row;

int count = qry.Count(); // 1st round-trip
int index = new Random().Next(count);

Customer cust = qry.Skip(index).FirstOrDefault(); // 2nd round-trip 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2011-01-10T20:53:56.947

实体框架的另一个示例：

```
var customers = db.Customers
                  .Where(c => c.IsActive)
                  .OrderBy(c => Guid.NewGuid())
                  .FirstOrDefault(); 
```

这不适用于 LINQ to SQL。`OrderBy`只是被丢弃了。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-03-15T18:03:41.863

编辑：我刚刚注意到这是 LINQ to SQL，而不是 LINQ to Objects。使用 Marc 的代码让数据库为您执行此操作。我把这个答案留在这里作为 LINQ to Objects 的潜在兴趣点。

奇怪的是，您实际上并不需要计数。但是，除非您获得计数，否则您确实需要获取每个元素。

您可以做的是保留“当前”值和当前计数的想法。当您获取下一个值时，取一个随机数并将“当前”替换为“新”，概率为 1/n，其中 n 是计数。

因此，当您读取第一个值时，您*总是*将其设为“当前”值。当您读取第二个值时，您*可能会将*其设为当前值（概率 1/2）。当您读取第三个值时，您*可能会将*其设为当前值（概率 1/3）等。当您用完数据时，当前值是您读取的所有值中的一个随机值，具有统一的概率。

要将其应用于条件，只需忽略不满足条件的任何内容。最简单的方法是只考虑开始的“匹配”序列，首先应用 Where 子句。

这是一个快速实现。我*觉得*没问题...

```
public static T RandomElement<T>(this IEnumerable<T> source,
                                 Random rng)
{
    T current = default(T);
    int count = 0;
    foreach (T element in source)
    {
        count++;
        if (rng.Next(count) == 0)
        {
            current = element;
        }            
    }
    if (count == 0)
    {
        throw new InvalidOperationException("Sequence was empty");
    }
    return current;
} 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2010-07-27T15:32:58.620

一种有效实现的方法是向数据`Shuffle`中添加一列，该列填充有随机整数（在创建每条记录时）。

以随机顺序访问表的部分查询是......

```
Random random = new Random();
int seed = random.Next();
result = result.OrderBy(s => (~(s.Shuffle & seed)) & (s.Shuffle | seed)); // ^ seed); 
```

这会在数据库中执行 XOR 操作，并按 XOR 的结果排序。

好处：-

1.  高效：SQL 处理排序，无需获取整个表
2.  可重复：（适合测试）- 可以使用相同的随机种子生成相同的随机顺序

这是我的家庭自动化系统用来随机播放列表的方法。它每天挑选一个新种子，在白天提供一致的顺序（允许轻松暂停/恢复功能），但每天都会重新审视每个播放列表。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-08-03T06:18:41.483

如果你想`var count = 16`从表中获取例如随机行，你可以写

```
var rows = Table.OrderBy(t => Guid.NewGuid())
                        .Take(count); 
```

这里我用的是EF，表是一个Dbset

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-11T14:32:42.437

如果获取随机行的目的是采样，我在[这里](http://qualityofdata.com/2011/02/13/sampling-data-with-sql-server/)非常简短地谈到了 Larson 等人的一个很好的方法，微软研究团队在那里他们使用物化视图为 Sql Server 开发了一个采样框架。也有指向实际论文的链接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-18T07:11:14.653

我对`DataTable`s 有随机函数查询：

```
var result = (from result in dt.AsEnumerable()
              order by Guid.NewGuid()
              select result).Take(3); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-22T12:54:49.133

来到这里想知道如何从少数几个随机页面中获取一些随机页面，因此每个用户都会获得一些不同的随机 3 个页面。

这是我的最终解决方案，使用 LINQ 对 Sharepoint 2010 中的页面列表进行查询。它在 Visual Basic 中，抱歉：p

```
Dim Aleatorio As New Random()

Dim Paginas = From a As SPListItem In Sitio.RootWeb.Lists("Páginas") Order By Aleatorio.Next Take 3 
```

可能应该在查询大量结果之前进行一些分析，但这非常适合我的目的

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-26T01:15:28.290

在 LINQPad 中使用 LINQ to SQL 作为 C# 语句看起来像

```
IEnumerable<Customer> customers = this.ExecuteQuery<Customer>(@"SELECT top 10 * from [Customers] order by newid()");
customers.Dump(); 
```

生成的 SQL 是

```
SELECT top 10 * from [Customers] order by newid() 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-09T09:55:41.093

下面的示例将调用源来检索计数，然后在源上应用一个跳过表达式，其数字介于 0 和 n 之间。第二种方法将通过使用随机对象（它将对内存中的所有内容进行排序）应用顺序并选择传递给方法调用的数字。

```
public static class IEnumerable
{
    static Random rng = new Random((int)DateTime.Now.Ticks);

    public static T RandomElement<T>(this IEnumerable<T> source)
    {
        T current = default(T);
        int c = source.Count();
        int r = rng.Next(c);
        current = source.Skip(r).First();
        return current;
    }

    public static IEnumerable<T> RandomElements<T>(this IEnumerable<T> source, int number)
    {
        return source.OrderBy(r => rng.Next()).Take(number);
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-24T01:11:49.887

我使用这种方法来获取随机新闻并且它的工作正常；）

```
 public string LoadRandomNews(int maxNews)
    {
        string temp = "";

        using (var db = new DataClassesDataContext())
        {
            var newsCount = (from p in db.Tbl_DynamicContents
                             where p.TimeFoPublish.Value.Date <= DateTime.Now
                             select p).Count();
            int i;
            if (newsCount < maxNews)
                i = newsCount;
            else i = maxNews;
            var r = new Random();
            var lastNumber = new List<int>();
            for (; i > 0; i--)
            {
                int currentNumber = r.Next(0, newsCount);
                if (!lastNumber.Contains(currentNumber))
                { lastNumber.Add(currentNumber); }
                else
                {
                    while (true)
                    {
                        currentNumber = r.Next(0, newsCount);
                        if (!lastNumber.Contains(currentNumber))
                        {
                            lastNumber.Add(currentNumber);
                            break;
                        }
                    }
                }
                if (currentNumber == newsCount)
                    currentNumber--;
                var news = (from p in db.Tbl_DynamicContents
                            orderby p.ID descending
                            where p.TimeFoPublish.Value.Date <= DateTime.Now
                            select p).Skip(currentNumber).Take(1).Single();
                temp +=
                    string.Format("<div class=\"divRandomNews\"><img src=\"files/1364193007_news.png\" class=\"randomNewsImg\" />" +
                                  "<a class=\"randomNews\" href=\"News.aspx?id={0}\" target=\"_blank\">{1}</a></div>",
                                  news.ID, news.Title);
            }
        }
        return temp;
    } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-13T16:10:54.317

如果您使用**LINQPad**，请切换到**C# 程序**模式并执行以下操作：

```
void Main()
{
    YourTable.OrderBy(v => Random()).FirstOrDefault.Dump();
}

[Function(Name = "NEWID", IsComposable = true)]
public Guid Random()
{
    throw new NotImplementedException();
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-06-25T21:44:08.110

```
var cust = (from c in ctx.CUSTOMERs.ToList() select c).OrderBy(x => x.Guid.NewGuid()).Taket(2); 
```

随机选择 2 行

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-10-08T13:44:29.117

添加到 Marc Gravell 的解决方案中。如果您不使用 datacontext 类本身（因为您以某种方式代理它，例如为了测试目的伪造数据上下文），您不能直接使用定义的 UDF：它不会被编译为 SQL，因为您没有在真实数据上下文类的子类或部分类。

此问题的解决方法是在您的代理中创建一个 Randomize 函数，将您希望随机化的查询提供给它：

```
public class DataContextProxy : IDataContext
{
    private readonly DataContext _context;

    public DataContextProxy(DataContext context)
    {
        _context = context;
    }

    // Snipped irrelevant code

    public IOrderedQueryable<T> Randomize<T>(IQueryable<T> query)
    {
        return query.OrderBy(x => _context.Random());
    }
} 
```

以下是您在代码中使用它的方式：

```
var query = _dc.Repository<SomeEntity>();
query = _dc.Randomize(query); 
```

完整地说，这是如何在 FAKE 数据上下文（在内存实体中使用）中实现它：

```
public IOrderedQueryable<T> Randomize<T>(IQueryable<T> query)
{
    return query.OrderBy(x => Guid.NewGuid());
} 
```

# javascript - 亚马逊 aStore 的动态高度

> ID：648206
> 
> 赞同：2
> 
> 时间：2009-03-15T17:40:55.413
> 
> 标签：javascript, height, amazon

这里有一个类似的问题：[Resize iframe height based on content height in it](https://stackoverflow.com/questions/525992/resize-iframe-height-according-to-content-height-in-it)。但这与亚马逊 aStore 无关。

创建 Amazon aStore 时，您会得到如下代码：

> < iframe src="http://astore.amazon.com/AMAZON_SOME_STORE_HERE-20" width="90%" height="4000" frameborder="0" scrolling="no">

问题是静态高度“4000”。我应该在代码中添加什么以使其动态调整到 aStore 的高度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T02:49:54.767

我不相信你能做到保留那个 <IFRAME>，因为要获得商店的高度，你需要在商店页面上运行一些 JavaScript。

问题是大多数浏览器不允许您在其他域上运行自己的 JS 代码，因为可能存在[跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)攻击。

也许您可以尝试使用 AJAX 获取该页面并将内容插入页面上的 <DIV> 。通过这样做，请记住，如果用户单击商店内的任何链接，他们将浏览您的页面，而不是用户在 iframe 内单击的“正常”工作流程，它会重新加载并且您的页面位于周围安静。

# javascript - 仅远程机器上的 IIS7 javascript 错误

> ID：648212
> 
> 赞同：-1
> 
> 时间：2009-03-15T17:43:59.243
> 
> 标签：javascript, iis, iis-7

我有一个工作的 asp.net 应用程序，其中包含很多 Telerik 控件、jQuery、动态数据和大量 aax 调用。

在我的开发机器上，一切运行良好。没有错误。部署到 Web 服务器（w2k8 上的 iis7）应用程序在服务器上的 IE 中运行时运行良好。但是任何远程机器上的 IE（在 XP 和 Vista 上测试））给了我一个预期的';' javascript错误？大多数 javascript 似乎工作正常。任何人以前见过这个或有线索可能是错的？我认为它必须是 iis7 设置但是什么？

编辑：Firefox 没有给出 javascript 错误，只有 IE（在 3 台不同的机器上）

Edit2：我发现我的一个 .js 文件使用以下代码传递给 IE（它是类的一部分，但该 headerinfo 是如何出现的？？？？？？）：

```
 get_numVideos: function()
    {
        return this._numVideHTTP/1.1 200 OK
Content-Type: application/x-javascript
Last-Modified: ue;
    }, 
```

亨克。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T00:06:07.640

在远程桌面连接到网络服务器时也遇到加密问题后，我找到了解决方案！

我似乎必须在我的 NIC 上禁用 IPv4 大型发送卸载。

所以最后它不是 IIS7 或 ASP.NET，而是一个 nic 属性 :(

亨克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T17:57:15.437

IIS 7 不应该是您的问题的根源。

对于像这样的故障排除问题。我建议 - 从远程机器 - 查看源代码并将所有支持的 JS 脚本的 URL 放在 IE 中以直接下载它们。一个或多个可能会给您一条错误消息，或者更有可能是权限问题。

此外 - 将面向公众的 URL 放在远程计算机的受信任站点列表中。错误仍然发生吗？从网络服务器这将被信任为内部网站。IE 可能会阻止它不信任的东西。这不会解决你的问题，但它会让你走上解决问题的正确道路。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T18:06:26.723

使用[Fiddler](http://fiddlertool.com)检查服务器返回的 HTML 和 JavaScript。如果 IIS7 以某种方式修改了您的页面，您会看到它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-15T17:57:40.537

如果 IE7，它们运行相同的版本吗？

是否有任何脚本生成 404 错误？

# windows - 有没有办法获取 Windows Media Player 当前正在播放的曲目的名称？

> ID：648213
> 
> 赞同：3
> 
> 时间：2009-03-15T17:44:11.257
> 
> 标签：windows, audio, windows-media-player

我想从外部应用程序查询 Windows Media 播放器，以了解它当前正在播放的曲目（专辑和艺术家）。

这些信息是否暴露在任何地方？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T18:05:43.123

一种方法是编写一个 Windows Media Player 插件。[在http://msdn.microsoft.com/en-us/library/bb262326(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb262326(VS.85).aspx)有一个用于执行此操作的 API 。还有一些关于[如何将插件向导更新到 Visual Studio 2008 的信息](http://social.msdn.microsoft.com/Forums/en-US/mediafoundationdevelopment/thread/0edad96a-207d-4c91-8fa7-4226335fd3ae/)。

后台用户界面插件可以将您想要的信息（例如当前播放的曲目、标题等）写入您监控的文件中。UI 插件只是一个实现 IWMPPluginUI 的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T18:09:59.773

一种方法似乎是安装一个“博客插件”，它将信息写入注册表，您可以在其中读取它。

这里有解释（向下滚动到*从媒体播放器（和 iTunes）获取数据* 部分：http: [//blogs.msdn.com/coding4fun/archive/2005/04/11/407357.aspx](http://blogs.msdn.com/coding4fun/archive/2005/04/11/407357.aspx)

博客插件可从 Microsoft 获得[，](http://www.microsoft.com/windowsxp/downloads/powertoys/wm_create.mspx)但您也可以编写自己的插件以获得更多控制权并选择所需的通信方式。

# iphone - 如何创建整数数组

> ID：648218
> 
> 赞同：3
> 
> 时间：2009-03-15T17:49:36.610
> 
> 标签：iphone, objective-c

我正在努力在目标 c 中创建一个整数数组。

我这样做的方式是javascript：

```
arr = new Array ( 1, 2, 3, 4, 3, 2, 2 ); 
```

我需要使用`NSMutableArray`, 因为需要更新值（它是游戏的平铺地图）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T17:52:27.757

数组需要改变长度吗？

如果不是，为什么不使用普通的整数数组：

```
int arr[] = { 1, 2, 3, 4, 3, 2, 2}; 
```

请注意，NSArray（或其子类）本身不`int`包含类型，您必须创建一个 NSNumber 对象。

如果你真的需要一个 Objective-C 风格的数组，那么使用这个：

```
int vals[] = { 1, 2, 3, 4, 3, 2, 2};  // you still need this
int n = sizeof(vals) / sizeof(vals[0]);

[NSMutableArray* array = [[NSMutableArray alloc] initWithCapacity:n];
for (int i = 0; i < n; ++i) {
    [array addObject: [NSNumber numberWithInt:vals[i]]];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T17:56:35.827

对于 NSMutableArray（虽然 C 风格的数组可能更可取，正如 Alnitak 所建议的那样），您需要执行以下操作：

```
NSMutableArray *array = [NSMutableArray arrayWithObjects: [NSNumber numberWithInt: 1], [NSNumber numberWithInt:2], nil]; 
```

（您可以在该构造函数中放入任意数量的内容，只需将它们用逗号分隔并以 . 结尾`nil`。）

您也可以创建一个空数组 ( `[NSMutableArray array]`)，然后使用 int 填充它`[array addObject:[NSNumber numberWithInt:1]]`。

如果您需要 2D 版本，请查看[此处](https://stackoverflow.com/questions/638129/how-to-declare-a-two-dimensional-array-of-string-type-in-objective-c/638183#638183)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T17:57:59.007

NSMutableArray 只能包含继承自 NSObject 的 Cocoa 对象（即 Apple 的类和您的类）。

基本上对于 NSMutableArray 你只需像这样初始化它：

```
myArray = [[NSMutableArray alloc] init]; 
```

然后根据需要添加/删除对象。

祝你好运！

PS：汉克的类参考是一个很好的起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-21T04:49:20.630

除了 Alnitak 的回答之外，我还要补充一点，这个问题还暗示了我在学习编写 iPhone 编程代码时肯定会感到的一些困惑。这里有一些关于 iPhone 上编程语言的一般提示

*   并非您编写的所有代码都是objective-c。
*   您可以（并且经常应该）在编程中使用其他语言，尤其是 C。
*   Alnitak 的“普通数组”是一个 C 数组。它非常适合存储*原始*数据类型的信息。
*   如果要将*对象*存储在数组中，请使用 NSArray。这不是 C 中可用的功能。我们立即知道这一点，因为它以“NS”开头（顺便说一下，这代表下一步）。

# oracle - 在 PL/SQL 中实现应用程序

> ID：648220
> 
> 赞同：2
> 
> 时间：2009-03-15T17:52:06.323
> 
> 标签：oracle, plsql

我们正在开发一个 Web 应用程序，根据我的规范，它的后端必须完全用 PL/SQL（存储过程等）编写。有人对如何使用存储过程和自定义类型编写结构良好的后端有任何建议/链接吗？通常我会有一个业务层，所有这一切都会发生，但雇主希望雇主得到什么等等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T12:53:13.127

您**仍然**可以拥有业务层——只是您使用 PL/SQL 而不是其他语言编写它。

典型的 PL/SQL 业务层将为每个主要功能领域使用包，其中包含适当的过程和功能，例如

```
create package employees_pkg as
    procedure hire_employee (p_id integer, p_name varchar2,
                             p_start_date date, ...);
    procedure terminate_employee (p_id integer, p_end_date date);
    ...
end; 
```

这些包可以直接对表执行 DML，尽管有些人（不是我）会提倡在此下方使用“表 API”层，以便 employees_pkg.terminate_employee 将调用“employee_tapi.update(...)”而不是“UPDATE employees.. ."，这对我来说似乎毫无意义。

自定义类型有其用途，但我不会过分尝试在 PL/SQL 中构建 OO 层。

您不会说您的客户端应用程序是用什么构建的，但[Oracle Application Express](http://apex.oracle.com/i/index.html)将是基于 Web 的 Oracle 数据库应用程序的绝佳选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T17:58:22.190

我读过规范说你不要在你的程序代码中构造或嵌入 SQL 语句，我希望你同意在任何情况下都是一个好计划。

PL/SQL 与 Python 或 PHP 不同。因此，无论您通常在“业务层”中做什么，您仍然会以同样的方式进行操作。差异会出现在 DAL 中（您确实有一个，不是吗？）。您将使用 PL/SQL 作为带参数的函数调用，而不是 SQL。如果您愿意，它会成为您的 ORM，但在数据库中构建（并且可能比面向对象更面向功能）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T18:14:09.797

我不知道你的职责范围到底是什么，但你有义务向你的客户提供建议。我想我们都知道，如果应用程序的规模很大、容易增长或者项目没有明确说明（即敏捷环境），他所要求的就是一个灾难。

无论如何，客户不希望您直接从数据库中生成 HTML，是吗？

话虽如此，我开发了一个巨大的应用程序，该应用程序将很多（我想说的太多）推迟到数据库（不是 PL/SQL 而是 Oracle 和 MSSQL——这意味着两组存储过程——有时是特定的表），视图、触发器和约束——维护）。从一般的角度来说，我想说的是：

*   读读读读
*   首先将架构工作到细节（不要犹豫，将事物分解为许多不同的表，并使用视图来连接它们并获得一个更简单的数据库接口），
*   如果 PL/SQL 自定义类型很好，那么将您的顶级表/视图隐藏在自定义类型后面（总是），
*   考虑模块化和“服务”来组织您的过程，
*   不要从一开始就尝试变得聪明/快速。

我的意思是这样的结构：

*   业务：存储过程和自定义类型
*   应用：视图、表、内部过程、内部类型
*   存储：基本模式（基表）、触发器和约束（小心操作）

哦，是的，尽早重构。应用程序越大，移动东西就越难，尤其是在这样的环境中。

当然我不需要告诉你早点测试；）

# php - 有人可以给我一个很好的理由，说明为什么 php 中的断言会如此吗？

> ID：648237
> 
> 赞同：3
> 
> 时间：2009-03-15T18:00:58.343
> 
> 标签：php, assert

PHP 的 assert 语句的行为与大多数其他语言不同。

`assert('return false');`实际上评估字符串，然后断言其结果（假）。

它没有将参数与 true 进行比较，而是通过检查参数的额外步骤，如果它是一个评估它的字符串，则执行比较。

确实很奇怪。

我的问题不在于理解行为，我的问题是想出这种行为的正当理由，尤其是。因为你现在必须做额外的思考工作......“这是否评估为字符串？”。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-15T18:12:18.193

> 字符串断言的优点是当断言检查关闭时开销较小，并且在断言失败时包含断言表达式的消息。这意味着，如果您将布尔条件作为断言传递，该条件将不会显示为您可能使用 assert_options() 函数定义的断言函数的参数，在调用该处理函数之前，条件将转换为字符串，并且boolean FALSE 被转换为空字符串。

来自[http://www.php.net/manual/en/function.assert.php](http://www.php.net/manual/en/function.assert.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T18:04:18.617

我**猜**这只是为了让他们不需要对语言的特定部分进行特殊处理。我相信在 PHP 中，如果您将字符串视为表达式，它会自动评估。这样你就可以做一些事情，比如传递一个函数的名称并尝试“调用”它并且它可以工作（没有指针的函数指针:-P）。

编辑：请参阅[Jakob 的答案](https://stackoverflow.com/questions/648237/can-someone-give-me-a-good-reason-for-why-assert-in-php-behaves-the-way-it-does/648257#648257)，以获取 PHP 文档中有关断言的相关引用。

# nhibernate - Fluent NHibernate/NHibernate 中的多级子实体对象

> ID：648239
> 
> 赞同：0
> 
> 时间：2009-03-15T18:03:27.060
> 
> 标签：nhibernate, fluent-nhibernate

我有一个包含 Child1 对象列表的实体。映射似乎对此工作正常。如果我尝试将 Child2 对象列表添加到 Child1 实体并设置映射，则似乎没有创建 xml 映射并且我收到此错误：

测试方法 vRATest.ORMTest.NHibernateTests.NHibernate_Should_Be_Able_To_Get_All_Routes_Using_ProjectID 抛出异常：NHibernate.MappingException：关联引用未映射的类：vRA.Domain.RouteLocationNH。

我现在已经检查了我的实体和映射好几次，但我似乎无法弄清楚如何使这个第 3 级工作。这在 Fluent NHibernate 甚至 NHibernate 中是否可行？我对这两种技术都很陌生，所以我想我最好问问。如果有人有 3 级实体的工作示例，我会很高兴看到如何做到这一点。

提前致谢！账单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-16T20:49:56.247

这绝对是可能的。异常消息表明您在一个映射中的一个`References<T>()`调用（或`many-to-one`XML 映射）中缺少一个类的映射。

浏览您的类并确保您`ClassMap`为从任何现有映射引用的每个实体类都有一个类。

在设置从 Child1 到 Child2 的映射后出现问题的事实表明，这是 Child2 或其引用的类之一的问题。

# configuration - 配置文件在什么时候成为编程语言？

> ID：648246
> 
> 赞同：100
> 
> 时间：2009-03-15T18:07:14.290
> 
> 标签：configuration, programming-languages, configuration-files, config

一段时间以来，我一直在考虑配置文件及其与代码的关系，并且根据日期和风向，我的观点似乎会发生变化。尽管我越来越多地回到我在学习 Lisp 时最初的认识：数据和代码之间几乎没有区别。这对于配置文件来说似乎是双重的。从正确的角度来看，Perl 脚本只不过是 perl 的配置文件。这往往会对 QA 和分工（例如谁应该负责更改配置文件）等任务产生相当严重的后果。

从配置文件到成熟语言的转变通常很慢，并且似乎是由拥有通用系统的愿望驱动的。大多数项目一开始看起来很小，只有一些配置项，比如在哪里写日志、在哪里查找数据、用户名和密码等。但随后它们开始增长：功能开始能够打开或关闭，操作的时间和顺序开始被控制，并且，不可避免地，有人想要开始添加逻辑（例如，如果机器是 X，则使用 10，如果机器是 Y，则使用 15）。在某个时刻，配置文件变成了一种特定领域的语言，而且是一种写得很糟糕的语言。

既然我已经开始着手搭建舞台，以下是我的问题：

1.  配置文件的真正目的是什么？
2.  是否应该尝试保持配置文件简单？
3.  谁应该负责对他们进行更改（开发人员、用户、管理员等）？
4.  它们是否应该受到源头控制（见问题 3）？

正如我之前所说，我对这些问题的回答不断变化，但现在我在想：

1.  允许非程序员快速改变大量行为
2.  是的，任何不是粗粒度的都应该在代码中
3.  用户应该对配置文件负责，程序员应该对配置文件和代码之间的配置层负责，它可以对应用程序进行更细粒度的控制
4.  不，但更细粒度的中间层应该是

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-15T18:15:08.623

非常有趣的问题！

我倾向于将我的配置文件限制为非常简单的“key=value”格式，因为我完全同意您的看法，配置文件可以很快成为成熟的程序。例如，任何曾经尝试“配置” OpenSER 的人都知道您所说的感觉：这不是配置，而是（痛苦的）编程。

当您需要您的应用程序以您今天无法想象的方式非常“可配置”时，您真正需要的是**插件系统**。您需要以其他人可以编写新插件并在将来将其挂接到您的应用程序的方式来开发您的应用程序。

所以，回答你的问题：

1.  配置文件的真正目的是什么？

    我想说，为了让安装您的应用程序的人能够调整一些与部署相关的参数，例如主机名、线程数、您需要的插件的名称以及这些插件的部署参数（检查出FreeRadius的配置这个原理的例子）等等。绝对不是表达业务逻辑的地方。

2.  是否应该尝试保持配置文件简单？

    确实。正如您所建议的，配置文件中的“编程”是可怕的。我认为应该避免。

3.  谁应该负责对他们进行更改（开发人员、用户、管理员等）？

    一般来说，我会说部署应用程序的管理员。

4.  它们是否应该受到源头控制（见问题 3）？

    我通常不对配置文件本身进行源代码控制，但我会对模板配置文件*进行*源代码控制，其中包含所有参数及其默认值，以及描述它们作用的注释。例如，如果配置文件名为`database.conf`，我通常对名为 的文件进行源代码控制`database.conf.template`。现在我当然是在谈论我*作为开发人员*所做的事情。 *作为管理员*，我可能想要对我为每次安装选择的实际设置进行源代码控制。例如，我们远程管理数百台服务器，我们需要跟踪它们的配置：我们选择使用源代码控制来做到这一点。

* * *

*编辑*: 虽然我相信以上对于大多数应用程序都是正确的，但当然也有例外。例如，您的应用程序可能允许其用户动态配置复杂的规则。大多数电子邮件客户端允许用户定义管理其电子邮件的规则（例如，“所有来自 'john doe' 并且在收件人：字段中没有我的电子邮件都应该被丢弃”）。另一个示例是允许用户定义新的复杂商业报价的应用程序。您还可以考虑像 Cognos 这样的应用程序，它允许用户构建复杂的数据库报告。电子邮件客户端可能会为用户提供一个简单的界面来定义规则，这将生成一个复杂的配置文件（甚至可能是一些代码）。另一方面，商业报价的用户定义配置可能以结构化方式保存在数据库中（既不是简单的键=值结构也不是代码的一部分）。一些其他应用程序甚至可能允许用户使用 python 或 VB 或其他一些具有自动化功能的语言进行编码。换句话说...您的里程可能会有所不同。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-15T18:34:39.247

行。您将有一些用户想要一个非常简单的配置，您应该将其提供给他们。同时，你会不断的请求“你能添加这个吗？我在配置文件中怎么做？”，我不明白为什么你不能同时支持这两个组。

我目前正在处理的项目使用 Lua 作为其配置文件。Lua 是一种脚本语言，它在这种情况下工作得很好。有一个我们[默认配置](http://prosody.im/doc/example_config)的示例。

你会注意到它主要是 key=value 语句，其中 value 可以是 Lua 的任何内置类型。最复杂的是列表，它们并不复杂（只是语法问题）。

现在我只是在等待有人问他们每次启动时如何将服务器的端口设置为随机值......

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-15T20:30:34.273

最近我正在做一个项目，我意识到我想在我的配置文件中包含条件 - 以前只是一个非常简单的形式：

```
 key = val
key2 = val
name = `hostname` 

```

我不想编写迷你语言，因为除非我非常小心地这样做，否则我不能允许有用的灵活性。

相反，我决定我有两种形式：

1.  如果文件以“#!”开头 并且是可执行的，我会解析运行它的结果。

2.  否则我会按原样阅读

这意味着我现在可以允许人们编写如下所示的“配置文件”：

```
 `#!/usr/bin/perl
if ( -x /bin/foo ) 
{
   print <<EOF;
foo=me
bar=you
EOF
}
else
{
   print <<EOF;
foo=bar
bar=foo
EOF
}` 
```

`这样，如果用户想要使用它，我就可以获得动态配置文件的强大功能，并且不必编写自己的迷你语言。`

 `* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-15T18:15:25.017

每个（足够长的）配置文件模式最终都会成为一种编程语言。由于您描述的所有含义，配置文件设计者最好意识到她正在编写一种编程语言并相应地进行计划，以免她给未来的用户带来不良遗产。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-15T20:03:20.157

我对配置文件有不同的理念。关于应用程序应该如何运行**的数据仍然是数据**，因此属于数据存储，而不是代码（配置文件 IMO 是代码）。如果最终用户需要能够更改数据，那么应用程序应该提供一个接口来做到这一点。

我只使用配置文件来指向数据存储。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-16T07:29:19.773

您可以求助于计算理论来定义什么才是编程语言。如果您的配置文件格式是[图灵完备](http://en.wikipedia.org/wiki/Turing_complete)的，那么它可以合理地算作一种编程语言。根据这个定义，描述[推箱子](http://en.wikipedia.org/wiki/Sokoban)级别的文件格式算作一种编程语言（参见[此处](http://web.cs.ualberta.ca/~joe/Preprints/Sokoban/index.html)）。低于图灵完备的其他复杂程度也可能计算在内，例如[常规语法](http://en.wikipedia.org/wiki/Regular_grammar)和[下推自动机](http://en.wikipedia.org/wiki/Pushdown_automaton)。

另一种看待它的方式是，许多配置文件只能进行数据标记，而适当的编程语言必须能够实现[算法](http://en.wikipedia.org/wiki/Algorithm)。例如，JSON 是一种配置文件格式，而 ECMA 脚本是一种编程语言。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-15T18:12:53.543

这是我的想法：

1.  允许轻松修改应用程序的运行时行为。这可以由程序员或非程序员根据需要进行。这可以在开发过程中进行，但我经常将配置文件视为有助于使程序在任何时候更加灵活的一种方式。

2.  是的。我认为配置文件应该尽可能简单，因为您可能需要各种选项来控制运行时的不同行为。我更喜欢对配置设置进行分组，并尽可能简化它们。

3.  取决于进行更改的内容和原因。如果用户要对其进行更改，则应制作前端以隐藏细节。一般来说，非开发人员通常也是如此。

4.  我经常对“默认”配置进行源代码控制，但有一种方法可以在实际运行时覆盖每个系统。

至于向配置文件添加逻辑 - 我会避免这种情况。我认为最好只在应用程序中的逻辑上切换配置文件。根据我的经验，配置文件中的行为导致缺乏可维护性和理解力。我强烈希望使配置文件尽可能简单。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-15T22:11:25.293

我倾向于同意这个问题的前提。我通过及早预测这将会发生来避免让自己陷入麻烦，因此**从不**推出我自己的配置系统。

*   我要么使用操作系统的配置工具（例如 plist、gconf 或任何合适的），
*   或者一个简单的平面文件，可以由现成的 INI 解析器之类的东西处理。
*   咬紧牙关，在应用程序中插入一个轻量级语言解析器，通常是 lua，有时是 tcl，
*   或者将数据存储在 SQLite 或类似的关系数据库中。

并让自己接受我做出的任何决定，或者如果我不能，重构以使用上述更适合应用程序的选择之一。

关键是，没有任何理由使用本土配置解决方案。一方面，您的用户很难学习一种新的、特定于应用程序的配置格式。另一方面，您可以从使用现成解决方案时免费提供的所有许多错误修复和更新中受益。最后，特性蠕变被搁置，因为，实际上，你不能只添加一个特性而没有真正进行大修，因为配置系统一开始并没有真正掌握在你的手中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-15T18:28:01.587

这取决于您与团队中其他开发人员达成的共识。您是在使用配置文件作为配置文件还是在创建[模型驱动](http://en.wikipedia.org/wiki/Model-driven_architecture)应用程序。

配置文件成为编程语言的症状：

*   名称=值对开始相互依赖
*   您觉得需要进行流量控制（例如*if (this) than that*）
*   为了进行进一步的开发（而不仅仅是使用应用程序），配置文件的文档变得必不可少
*   在读取配置中的值之前，它需要有一些上下文（即值取决于配置文件本身的外部内容）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-15T18:39:24.930

配置文件总是逐渐变得丑陋、不合逻辑的“成熟的编程语言”。设计好的编程语言需要艺术和技巧，而配置语言变成编程语言往往是可怕的。

一个好的方法是使用设计精美的语言，例如 python 或 ruby​​，并使用它为您的配置创建[DSL](http://en.wikipedia.org/wiki/Domain-specific_language)。这样，您的配置语言表面上可以保持简单，但实际上是成熟的编程语言。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-15T19:50:53.510

鉴于转向“流畅的界面”，我相信您的问题非常相关。许多开发人员已经“看到了曙光”关于 XML 配置的应用程序。使用 XML 可能非常冗长且难以正确编辑（尤其是在未提供模式的情况下）。拥有流畅的界面允许开发人员在纯文本配置文件（或者可能是命令行参数）中的一些键值对的帮助下，以特定领域的语言配置应用程序。它还使得设置和配置应用程序的新实例以进行测试或其他任何事情变得非常容易。

以下是我对您的问题的回答：

*   配置文件的真正目的是什么？

配置文件是一种允许用户在运行时自定义其程序行为的方法。

*   是否应该尝试保持配置文件简单？

理想情况下，我认为配置文件至少应该辅以流畅的界面来配置程序（这在很多方面都很有用）。如果您确实需要一个配置文件，那么它应该保持非常简单，除了键值对之外别无其他。

*   谁应该负责对他们进行更改（开发人员、用户、管理员等）？

我认为这个问题的答案取决于您的组织。部署软件的人应负责确保软件配置正确。

*   它们是否应该受到源头控制（见问题 3）？

我会从其他人那里窃取这个答案:) 我喜欢将模板配置存储在源代码管理中并根据每个本地用户的需要对其进行修改的想法。一个开发人员的配置文件很可能是另一个开发人员的噩梦，因此最好将因用户而异的内容排除在源代码控制之外。拥有模板也是让部署应用程序的人员（或其他开发人员）准确了解配置文件的有效值的好方法。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-16T03:09:07.700

我见过配置文件*是*代码的python程序。如果您不需要做任何特殊的事情（条件等），它看起来与其他配置样式没有太大区别。例如，我可以使用以下内容制作文件`config.py`：

```
num_threads = 13
hostname = 'myhost' 
```

与（比如说）INI 文件相比，用户的唯一负担是他们需要将 '' 放在字符串周围。毫无疑问，您可以在其他解释语言中做同样的事情。它使您可以无限地在必要时使配置文件复杂化，但可能会吓到您的用户。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-15T18:19:30.577

是的，配置文件应该很简单。它们本身不应包含“逻辑”——将它们视为 if 语句中的表达式列表，而不是整个条件语句。

它们的存在是为了让用户决定应该使用应用程序中编码的哪些选项，所以不要试图让它们变得复杂，它最终会弄巧成拙——你最终可能会编写简单的配置文件控制原始配置文件的配置方式！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-15T18:20:08.063

微软“奥斯陆”工作的目的之一是允许（尽管不是必需的）解决这个问题。

1.  应用程序将附带它包含的任何新组件的模型。它还将使用现有模型。例如，它可能包含一个 Web 服务，因此它可以重用 Web 服务的系统模型。
2.  这些模型将包括描述它们的元数据，包括足够的信息以供工具以文本或图形方式访问它们。
3.  部分机型将对应“配置”

这意味着与今天的配置文件相当的内容可能足够丰富以支持对其配置的文本和图形编辑。图形工具将随“Oslo”（代号“Quadrant”）一起提供。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-15T19:07:10.697

我将成为逆向者，并认为它只是一种语言，它体现的不仅仅是 XML 所能表示的；或者当 XML 被认为是一种语言时。

或者，大多数配置文件可以被认为是类，但只有属性，没有方法。没有方法，我不认为它是一种语言。

归根结底，“语言”是一种模糊的抽象，但是是的，边缘是模棱两可的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-15T19:17:34.293

我们应用程序的代码变得不那么重要了……有脚本，有各种各样的属性来定义类、方法、方法参数和属性的行为。用户可以定义数据库触发器和数据库约束。可能有非常复杂的配置文件。有时用户可以定义 XSLT 样式表来操作输入和输出，因为我们的系统需要是开放的 (SOA)。还有像 BizzTalk 这样的东西也需要复杂的配置。用户可以定义复杂的工作流程。

我们必须编写更好的代码来处理这种复杂的环境，因此我们应用程序的代码变得更加重要......

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-16T20:13:34.180

我非常喜欢使用 python 程序作为配置文件，尤其是对于守护进程。除了“配置端口”之外，我喜欢让守护进程完全没有配置。然后，python 程序连接到守护程序并继续在守护程序中创建对象并将它们连接在一起以创建所需的配置。一切设置好后，就可以让守护程序自行运行。当然，好处是您可以使用成熟的编程语言来编写配置文件，并且由于您已经有办法从另一个程序与守护程序对话，因此您可以使用它进行调试和获取统计信息。主要的缺点是必须随时处理来自另一个程序的消息。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-08-13T22:40:19.430

*配置文件*：“我的目的是什么？”
*你*：“配置黄油。”
*配置文件*：“好的……”
*配置文件*：“我的目的是什么？”
*你*：“你配置黄油。”
*配置文件*：“天哪。” *你*：“是的，欢迎来到俱乐部。”

1.  配置文件没有“真正目的”。它对您的应用程序有意义。一般来说，机器之间不同（或可能不同）并且在应用程序运行过程中不会改变的东西可能应该在配置文件中。其他服务的默认值、端口和地址都是很好的选择。密钥和秘密也是很好的候选者，但出于安全原因，应与您的正常配置分开处理。我不同意配置文件的目的是允许进行快速更改。目的应该是允许灵活地设置您的应用程序。如果配置文件是一种允许这种灵活性的快速简便的方法，那就更好了 - 但您*不*应该打算频繁更改配置文件。

2.  是和不是。您是否应该尝试简化应用程序的代码？是的。您应该尝试使您编写的所有内容都简单明了。没有比它需要的更复杂。您的配置也是如此。但是，这是非常特定于应用程序的。硬编码配置中应该包含的内容，因为它会使您的配置“过于复杂”，这是糟糕的设计。事实上，试图“保持简单”就是为什么配置文件最终会变得一团糟。有时最简单的举措是模块化。这就是为什么你的配置文件应该用众所周知的通用编程语言编写——而不是一些糟糕的配置语言（阅读：[所有“配置语言”都很烂](https://hackernoon.com/configuration-files-suck-6daa9812f601)）。

3.  同样，谁应该修改配置文件完全取决于应用程序。但我同意 miniquark，部署应用程序的人应该负责配置。

4.  源代码控制尽你所能。源代码控制很棒。您可以超级轻松地回滚内容，并且您拥有所做更改的完整历史记录以及谁进行了这些更改的记录。那为什么不呢？

# jquery - 使用 jQuery .click() 事件和

> ID：648248
> 
> 赞同：2
> 
> 时间：2009-03-15T18:09:07.857
> 
> 标签：jquery, plugins, click

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T20:24:10.683

终于搞定了——

```
//jQuery.clickless.js

(function($){    
    $.fn.clickless = function(fnCallback) {        
        return this
                .click(function(){return false;})                
                .bind("click", function(){                        
                    fnCallback.apply(this);                
                });    
           }}
)(jQuery); 
```

**编辑：**

感谢 cobbal 和 Julian（来自 Dharma Initiative）——非常感谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T18:21:51.070

试试这个：

```
(function($){
    $.fn.clickless = function(fnCallback) {

      $.each(this, function() {

        var element = $(this);

        element.click(function(){return false;})
               .bind("click", function(){
                    fnCallback();
               });
     });

     return this;

   }
})(jQuery); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T19:07:28.327

为什么不直接使用：

```
.bind("click", fnCallback); 
```

因为那将`this`正确设置。

**编辑**：这个版本实际上有效：

```
.bind("click", function(){
    fnCallback.apply(this);
}); 
```

在 jQuery`each()`中四处寻找以了解它使用了什么

**更多编辑：**
看看如何`apply()`和 `call()`不同，这可能是更正确的方法。

```
.bind("click", function(){
    fnCallback.call(this);
}); 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-03-15T18:59:41.403

或者，您需要建议您的用户如何进入控制面板、声音以及关闭开始/结束导航的声音。

我个人讨厌这些咔嗒声，所以这是我在安装 Windows 时关闭的第一件事。

# .net - 如何：后退按钮支持“Ajax”

> ID：648250
> 
> 赞同：3
> 
> 时间：2009-03-15T18:09:57.497
> 
> 标签：.net, asp.net, javascript, html, ajax.net

我有一个 asp.net ajax 网站，它在同一页面上发生了很多事情而无需重新加载页面，例如排序记录，分页，......当用户转到同一站点中的另一个页面并按下浏览器后退按钮时，如何使浏览器保存页面状态以使用预选选项（例如排序选项、分页中的页码）返回到它。

我知道新的 .net 3.5 中有一个历史控件，但它在同一页面中工作，而不是从一个页面导航到另一个页面。我也在寻找适用于所有浏览器的解决方案。

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T20:26:40.430

你不需要 3.5 的历史控制，[在这里查看 ScottGu 的博客](http://weblogs.asp.net/scottgu/archive/2006/09/14/Tip_2F00_Trick_3A00_-Enabling-Back_2F00_Forward_2D00_Button-Support-for-ASP.NET-AJAX-UpdatePanel.aspx)

还要检查[这篇文章是否有帮助](http://geekswithblogs.net/frankw/archive/2008/10/29/enable-back-button-support-in-asp.net-ajax-web-sites.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T02:41:49.777

你做上面建议的历史插件。我假设在引擎盖下，这就是正在发生的事情。例如，当您的 async-postback 返回客户端时，对 window.location = 'somePage.aspx#anchor1' （一个老式的 HTML 锚）进行 JavaScript 调用，然后返回客户端的下一个 async-postback 将执行 window.location = 'somePage.aspx#anchor2' 等。GMail 在重定向到您的收件箱或电子邮件中的其他标签或文件夹时执行此操作。

希望有帮助，尼克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T20:43:45.893

我听说这通常是通过使用 iframe 而不是 XMLHttpRequest 来解决的。我不知道如何将此建议合并到 ASP.Net webapp 中。

# .net - 如何在后台线程运行时阻止 Winforms UI

> ID：648255
> 
> 赞同：11
> 
> 时间：2009-03-15T18:11:34.747
> 
> 标签：.net, winforms, multithreading, .net-2.0

我继承了一个 Winforms 应用程序，该应用程序从 UI 线程对应用程序服务器进行大量长时间运行的调用，因此 UI 在相当长的一段时间内保持无响应、无法使用、无法关闭。（这让我真的去**AAAAAAAAAARGH！**）

我计划将服务器调用移动到后台线程并禁用 UI - 但可移动和可关闭 - 而后台线程执行其工作。

那么禁止用户输入我的应用程序的最佳方法是什么？我正在考虑“模态进度对话框”的思路，但我更喜欢一种不会强迫我将视觉效果扔给用户的解决方案（某些服务器操作在不到 500 毫秒内运行，因此对话框*不是*最佳的...)

Winforms 中是否有任何方法可以防止用户启动操作或更改应用程序中的数据，同时允许一些选择的内容（调整大小、显示、隐藏和家庭以及用户关闭窗口）？我更喜欢一种不会让我访问表单中的每个 UI 元素并将其设置为禁用的方式......其中有很多，并且该应用程序确实有一个“在 UI 设计器中被黑客入侵，直到它显示华丽的东西" 源代码风格。在发布日期之前，无法重构所有有味道的东西......

哦，顺便说一句，这个应用程序存在于 .net framework 2

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T18:14:56.393

我知道的唯一方法是禁用某些/所有控件。但是，根据控件的布局方式，没有必要将每个控件都设置为禁用 - 当容器控件被禁用时，它的所有子控件也会被禁用。例如，如果您有`GroupBox`一些控件，如果您将其设置`GroupBox`为禁用，则其中的所有控件`GroupBox`也将被禁用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-15T18:15:53.067

选择一些上层容器控件（可能是表单本身），并将其 Enabled 属性设置为 false。放置在该控件上的所有控件都将被禁用，这将阻止它们接收输入。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-21T14:05:17.813

简单地启用/禁用按钮的问题是 UI 事件仍会在任务运行时添加到消息队列中......

假设您有一个搜索按钮和一个重置按钮。当您单击搜索时，您将禁用这两个按钮。搜索运行了一段时间。如果用户单击重置，即使它被禁用，搜索将在完成后立即重置。

解决这个问题的快速而肮脏的方法是添加一个

```
Application.DoEvents(); 
```

在重新启用按钮*之前立即*调用。DoEvents() 将处理控件上的所有单击事件，对于仍然禁用的控件将被忽略。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T19:07:38.653

在 Win32 API 级别，有一个[EnableWindow](http://msdn.microsoft.com/en-us/library/ms646291(VS.85).aspx)函数，您可以使用它禁用任何窗口手（当然，您需要获取主窗口以及任何其他顶级窗口的底层句柄）。不过，我还没有在 WinForms 中测试过它。（我很确定在 User32 级别上还有其他答案，但我现在不记得 API 调用了。）

注意：这不会使控件变灰，从可用性的角度来看，这会降低其实用性（用户只会看到“冻结的应用程序”）。如果您至少设置一个沙漏光标，它会稍微好一些。

但是，这是处理异步处理的一种快速而肮脏的方式。您真的需要将用户锁定在整个应用程序之外吗？也许只是在请求进行时应该禁止的一些功能？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T18:16:59.883

不幸的是，使用 WinForms，您可能需要在单个共享方法中禁用/启用按钮。这是 WPF 相对于 windows 窗体的优势之一 - 处理这些情况要容易得多。

至于不阻塞您的 UI - 您需要将调用移至异步编程模型。在您的情况下，我建议您查看 ThreadPool。

你会想做一些事情，比如让按钮禁用你的控件，在线程池上调用你的操作，然后在完成时重新启用它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-25T20:00:17.590

我在这里回答了一个旧线程，但我看到了这个问题并记得我的一个旧 WinForm 应用程序，在那里我遇到了同样的问题，即禁用表单同时仍然允许调整大小和移动等。我加载了我的代码并发现解决方案是：

1.  在窗体上放置一个 Panel 控件，并为 Dock 属性指定一个 DockStyle.Fill 值。
2.  不要将所有窗体的组成顶级控件直接放入窗体中，而是将它们放入 Panel 控件中。
3.  现在来看看神奇的一点——当你想禁用表单的控件时，只需将 Panel 的 Enabled 属性设置为 false。执行此操作时，Panel 控件包含的所有控件也将被禁用，但窗体本身仍处于启用状态，因此可调整大小等。要恢复所有控件的状态，只需将 Enabled 属性设置回 true。

严格来说，您不必使用 Panel 控件，任何容器控件都应该表现出相同的行为。即使是 PictureBox 控件也可以解决问题！

# database - 使用 Amazon SimpleDB 有什么意义？

> ID：648270
> 
> 赞同：51
> 
> 时间：2009-03-15T18:19:28.363
> 
> 标签：database, amazon-web-services, amazon-simpledb

我认为我可以使用 SimpleDB 来处理我的应用程序中最具挑战性的领域（就缩放而言） - 类似 twitter 的评论，但位置在顶部 - 直到我坐下来真正开始实施它深发展。

首先，SDB 每个属性值有 1000 字节的限制，即使是注释也不够（可能需要将较长的值分解为多个属性）。

然后，最大域大小为 10GB。承诺是您可以扩展而不必担心数据库分片等，因为 SDB 不会随着数据负载的增加而降级。但是，如果我理解正确，对于域，我将遇到与分片完全相同的问题，即。在某些时候需要在应用程序级别实现跨域的数据记录分布和查询。

即使对于我在整个应用程序中拥有的最简单的对象，即。原子用户评级，SDB 不是一个选项，因为它无法计算查询中的平均值（一切都是基于字符串的）。因此，要计算对象的平均用户评分，我必须加载所有记录——一次 250 条——并在应用程序级别进行计算。

我错过了关于 SDB 的一些东西吗？10GB 的数据库真的可以克服所有 SDB 限制吗？老实说，我非常热衷于利用 SDB，因为我已经使用了 S3 和 EC2，但现在我根本看不到用例。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-05T16:04:46.517

我在几个大型应用程序上使用 SDB。每个域 10 GB 的限制确实让我担心，但我们在亚马逊上赌博，如果我们需要它允许扩展它。如果您想要更多空间，他们会在他们的网站上提供申请表。

至于跨域连接，不要将 SDB 视为传统数据库。在将数据迁移到 SDB 期间，我不得不对其中的一些数据进行非规范化处理，以便手动进行跨域连接。

每个属性 1000 字节的限制也很难解决。我拥有的一个应用程序是一个博客服务，它在数据库中存储帖子和评论。在将它移植到 SDB 时，我遇到了这个限制。我最终将帖子和评论作为文件存储在 S3 中，并在我的代码中阅读。由于此服务器位于 EC2 上，因此到 S3 的流量不会花费任何额外费用。

也许需要注意的其他问题之一是 SDB 上的最终一致性模型。您不能写入数据然后再将其读回，并保证新写入的数据将返回给您。最终数据将被更新。

说了这么多，我还是喜欢深发展。我不后悔改用它。我从 SQL 2005 服务器移出。我认为我对 SQL 有更多的控制权，但是一旦放弃了这种控制权，我就有了更多的灵活性。不需要预先定义模式很棒。在您的代码中使用强大而健壮的缓存层，很容易使 SDB 更加灵活。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-27T08:08:50.360

我在 SimpleDB 中有大约 50GB，跨 30 个域进行分片。我使用它来允许存储在 S3 中的对象上的多个键，并降低我的 S3 成本。我没有尝试过使用 SimpleDB 进行全文搜索，但我不会尝试。

SimpleDB 可以工作，很简单，等等，但它并不是适合所有情况的一组功能。在您的情况下，如果您需要聚合，SimpleDB 不是正确的解决方案。它是围绕数据库只是一个键值存储的学派构建的，聚合应该由一个聚合过程来处理，该过程将结果写回键值存储。这正是*某些应用程序所需要的。*

这是[我如何使用 SimpleDB 捏硬币的描述](http://kdpeterson.net/blog/2009/06/pack-multiple-small-objects-in-s3-for-cost-savings.html "在 s3 中打包多个小对象以节省成本")

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-01-07T00:08:51.120

值得补充的是，虽然必须跨域编写自己的分片逻辑并不理想，但在性能方面。例如，如果您需要搜索 100gb 的数据，最好让 20 台每台 5gb 的机器对它们负责的部分执行相同的搜索，而不是一台机器必须执行整个任务。如果您的目标是最终得到一个排序列表，您可以从 20 个同时查询返回的最佳结果，并在发起请求的机器上对它们进行整理。

也就是说，如果您想获得较低级别的内容，我宁愿看到它从正常使用中抽象出来，并且在 API 中有类似“提示”的东西。因此，如果您碰巧存储了 100gb 的数据，让 Amazon 决定是跨 20 台机器还是 10 台或 40 台机器进行分区，然后分配工作。例如，在 Google 的 BigTable 设计中，随着表的增长，它会不断划分为 400mb 的平板电脑。从表中请求一行就这么简单，BigTable 的工作就是找出它在一个或数百万个平板电脑中的位置。

再说一次，BigTable 要求您编写 MapReduce 调用来执行查询，而 SimpleDB 会为您动态索引自身，因此您赢了一些，也输了一些。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-15T18:26:53.417

如果每个属性的存储大小是问题，您可以使用 S3 存储更大的数据，并将链接存储到 SDB 中的 s3 对象。S3 不仅适用于文件，它还是一种通用的存储解决方案。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-15T18:30:28.913

亚马逊试图让你实现一个简单的对象数据库。这主要是出于速度原因。将 SimpleDB 记录视为 S3 中元素的指针/键。通过这种方式，您可以运行查询（针对 SimpleDB 慢速获取结果列表，或者当您需要一次检索或修改记录时，您可以使用键（快速）直接点击 S3 来拉取对象。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-24T17:22:26.677

这些限制似乎适用于当前的**Beta**版本。我认为在他们弄清楚如何能够经济地满足需求之后，他们将在未来允许更大的数据库。即使有限制，支持高可扩展性和可靠性的 10GB 数据库也是一种有用且具有成本效益的资源。

请注意，可扩展性是指在数据量或请求量增长的同时保持**稳定而浅的性能曲线的能力。**这并不一定意味着最佳性能，也不意味着非常高容量的数据存储。

Amazon SimpleDB 还提供**免费服务层**，因此您可以存储多达 1GB，每月传输多达 1GB，使用长达 25 小时的机器时间。虽然这个限制听起来很低，但它是免费的这一事实允许一些小规模的客户使用该技术，而无需投资大型服务器场。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-30T18:38:32.707

我正在构建一个商业 .NET 应用程序，它将使用 SimpleDB 作为其主要数据存储。我还没有投入生产，但我也一直在构建一个开源库，它解决了使用 SimpleDB 与 RDBS 的一些问题。我的路线图上的一些功能与您提到的问题有关：

*   数据的透明分区
*   伪事务性
*   属性的透明跨越超过 1000 字节限制

SimpleDB 仍在积极开发中，最终肯定会拥有许多今天没有的功能（一些添加到核心系统中，一些添加到代码库中）。

.NET 库是[Simple Savant](http://www.codeplex.com/SimpleSavant)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-23T09:27:16.090

我不买关于 SimpleDB 的所有炒作，基于以下限制，我看不出应该使用它的原因（我知道现在你可以用几乎任何技术构建几乎任何东西，但这不是选择一个的理由） .

所以我看到的限制：

*   只能在亚马逊AWS上运行，你还应该[为一大堆员工买单](https://aws.amazon.com/simpledb/pricing/)
*   域（表）的最大大小为 10 GB
*   属性值长度（字段大小）为 1024 字节
*   选择响应中的最大项目数 - 2500
*   Select 的最大响应大小（可以返回的最大数据量） - 1Mb，实际上您可以在[此处查看所有限制](http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/SDBLimits.html)
*   仅适用于[几种语言](http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/AWSLibraries.html)（java、php、python、ruby、.net）的驱动程序
*   不允许不区分大小写的搜索。您必须引入额外的小写字段/应用程序逻辑。
*   只能[在一个字段上进行排序](http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/SortingDataSelect.html)
*   因为 5s timelimit [count in 会表现得很奇怪](http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/CountingDataSelect.html)。如果 5 秒过去了，查询还没有完成，你会得到一个部分数字和一个允许你继续查询的令牌。应用程序逻辑负责收集所有这些数据并进行汇总。
*   [一切都是 UTF-8 字符串](http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/NumericalData.html)，这使得使用非字符串值（如数字、日期）变得很痛苦。
*   排序对于数字的行为很奇怪（因为一切都是字符串）。所以现在你必须[用填充物跳萨满舞](http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/ZeroPadding.html)
*   两者都没有事务和连接
*   没有复合、地静态、多列索引、没有外键

如果这还不够，那么您还必须忘记基本的东西，如`group by`,以及数据操作。总的来说，查询语言非常初级，只是提醒了 SQL 可以做什么的一小部分。`sum` `average``distinct`

所以功能并不比 Redis/Memcached 更丰富，但我非常怀疑它在用例中的性能是否与这两个数据库一样好。

SimpleDB 将自己定位为无模式的基于文档的 nosql 数据库，但 MongoDB/CounchDB 的查询语法更具表现力，它们的局限性也更加合理。

最后，不要忘记[供应商锁定](https://en.wikipedia.org/wiki/Vendor_lock-in)。如果在几年内 Azure（或其他可能出现的东西）将提供比 AWS 便宜 5 倍的云托管，那真的很难转换。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-21T17:48:10.723

SimpleDB .. 的重点不是用作所有数据的数据库，而是用作其他非传统“DB”数据存储（例如 S3）中数据的索引。这就是我将 SimpleDB 用于 ETL 流程之类的事情的方式。我的 S3 数据湖中的数据必须被索引，但 S3 没有合适的索引，这**是 SimpleDB 的最佳**用例之一（恕我直言）

谷歌这个：“simpledb s3 索引”

请注意，它不必专门针对 S3。您可能在 EFS / EBS 甚至 SES 中有您想要索引的数据。SimpleDB 是一个很好的解决方案，可以为几乎任何东西提供简单的快速索引。我发现 DynamoDB 在为您**所需的吞吐量**及其与成本的关系方面的配置方面过度杀伤和不必要地过于复杂，并且听说过与此相关的恐怖故事。使用 SimpleDB，性能始终如一，成本可预测。

阅读：[https ://segment.com/blog/the-million-dollar-eng-problem/](https://segment.com/blog/the-million-dollar-eng-problem/)

鉴于这一事实以及任何复杂的事情，还有其他用于数据存储/索引的解决方案，例如 Sphinx、Postgres、Mongo ..等，我的问题一直是当其他解决方案同样快时，DynamoDB 成本陷阱的意义何在但是，不需要吞吐量配置，并且具有可预测的成本。DynamoDB 是 AWS 抢钱（恕我直言）。他们不能逐步淘汰 SimpleDB，因为有太多现有的已知客户依赖它。AWS 本身也依赖它。如果它真的像他们声称的那样被 DynamoDB 取代，那么每个人都会转移到 Dynamo，这不会是一个讨论。

# iphone - 将大文件从网络下载到 iPhone 以写入磁盘的最佳方式

> ID：648275
> 
> 赞同：1
> 
> 时间：2009-03-15T18:20:18.673
> 
> 标签：iphone, cocoa-touch

在一个 iPhone 应用程序中，我目前有用于将文件从 Web 下载到 iPhone 并将其保存到磁盘的代码。

问题是，如果文件*很大*，那么应用程序的内存使用量会飙升并且应用程序崩溃。

我确信我只是没有以“正确”的方式去做。

目前我有以下内容：

```
mediaData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:path]];
[mediaData writeToFile:fullPath atomically:YES];
[mediaData release]; 
```

正如我所提到的，这适用于图片之类的东西，但不适用于视频剪辑之类的东西，因为应用程序崩溃了。

这样做以防止我的应用程序崩溃的正确方法是什么？我的想法可能是套接字，但由于我没有做过很多套接字编程，我不确定。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T19:23:11.300

您可以使用[NSURLConnection](http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)异步运行并以可管理的块的形式提供数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T19:27:43.533

由于`NSURLDownload`在 iPhone 上不可用，您可能希望在using委托方法中使用`NSURLConnection`和缓冲一些数据。本文描述了其中的一些内容：http: [//dannyg.com/iapps/Blog/Entries/2009/2/16_The_Joy_in_Discovering_You_Are_an_Idiot.html](http://dannyg.com/iapps/Blog/Entries/2009/2/16_The_Joy_in_Discovering_You_Are_an_Idiot.html)`NSMutableData``connection:didReceiveData:`

# python - 如何使用 python 中的 group() 方法进行列表理解？

> ID：648276
> 
> 赞同：3
> 
> 时间：2009-03-15T18:21:24.100
> 
> 标签：python, list, list-comprehension

我正在尝试编写一个小脚本来清理我的目录。事实上我有：

```
pattern = re.compile(format[i])
...
current_f.append(pattern.search(str(ls))) 
```

我想使用列表理解但是当我尝试时：

```
In [25]: [i for i in current_f.group(0)] 
```

我得到：

```
AttributeError: 'list' object has no attribute 'group' 
```

那么如何使用 进行列表理解`group()`？还有另一种方法可以做我想做的事吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T18:27:53.943

你想这样做吗？：

```
[f.group(0) for f in current_f] 
```

# asp.net - 将谷歌搜索添加到我的网站时出现问题

> ID：648279
> 
> 赞同：0
> 
> 时间：2009-03-15T18:23:25.203
> 
> 标签：asp.net

我在我的网站中添加了 Google 搜索的标准代码（取自[http://www.askdavetaylor.com/how_can_i_add_a_google_search_box_to_my_web_site.html](http://www.askdavetaylor.com/how_can_i_add_a_google_search_box_to_my_web_site.html)）：

当我编译并运行该站点时，我收到以下错误（页面加载后）：

无效的回发或回调参数。`<pages enableEventValidation="true"/>`使用配置或页面启用事件验证`<%@ Page EnableEventValidation="true" %>`。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用该`ClientScriptManager.RegisterForEventValidation`方法注册回发或回调数据以进行验证。

该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-17T12:59:27.477

摆脱错误的最简单方法是将 EnableEventValidation="true" 添加到 aspx 页面顶部的 Page 指令中。这将消除错误，但我不认为你的代码会工作:)。正如 Freddy 指出的那样，您的代码试图在服务器端表单中提交客户端表单。

归根结底，Google 搜索实际上只是[http://www.google.com/search?q=Your+search+term](http://www.google.com/search?q=Your+search+term)。您可以使用一些简单的 javascript 轻松实现这一点，而无需任何形式。

```
<input type="text"   name="q" size="25"
 maxlength="255" value="" />
<input type="button" onclick="location='http://www.google.com/search?q=" + document.getElementById("q").value + "'" value="Google Search" /> 
```

可能需要一些调整和转义，但它应该给你的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T20:23:21.047

确保不要将 runat=server 与该表单一起使用。如果这不起作用，请发布您正在使用的确切代码，您可能在不应该使用的地方使用了 asp.net 的一部分。如果可能，请尝试将其保留在 html 控件中，特别是 asp.net 按钮将执行 asp.net 回发，这不是您想要的。

# c# - .NET 的任何 NIO 框架？

> ID：648282
> 
> 赞同：25
> 
> 时间：2009-03-15T18:24:13.857
> 
> 标签：c#, .net, frameworks, nio

.NET 是否有任何非阻塞 IO 框架？

我正在寻找类似于[Apache Mina](http://mina.apache.org/)和[JBoss Netty](http://www.jboss.org/netty)为 Java 提供的东西：一个用于实现高度可扩展的服务器的框架——而不仅仅是 .NET 框架提供的低级支持。

**编辑：**为了更好地解释我希望看到的内容，这里有一个基本示例，说明您可以使用 Mina 做什么：

在 Mina 中，我可以像这样实现 ProtocolDecoder：

```
public class SimpleDecoder extends CumulativeProtocolDecoder {
  protected boolean doDecode(IoSession session, IoBuffer in, ProtocolDecoderOutput out) throws Exception {
    if (in.remaining() < 4) 
      return false;
    int length = in.getInt();
    if(in.remaining() < 4 + length)
      return false;
    Command command = new Command(in.asInputStream());
    out.write(command);
  }
} 
```

还有一个像这样的 CommandHandler：

```
public abstract class CommandHandler extends IoHandlerAdapter{
  public void messageReceived(IoSession session, Object message) throws IOException, CloneNotSupportedException {
    Command command = (Command) message;
    // Handle command. Probably by putting it in a workqueue.
  }
} 
```

如果我通过调用启动服务器

```
CommandHandler handler = new CommandHandler();
NioSocketAcceptor acceptor = new NioSocketAcceptor();
acceptor.getFilterChain().addLast("protocol", new ProtocolCodecFilter(new SimpleDecoder(false)));
acceptor.setLocalAddress(new InetSocketAddress(port));
acceptor.setHandler(handler);
acceptor.bind(); 
```

我将获得一个非阻塞服务器。

它将运行一个（或至少几个）线程，循环遍历所有传入的连接，从套接字收集数据，并调用`SimpleDecoder.doDecode()`以查看它是否在连接上有完整的命令。然后它将命令传递给`CommandHandler.messageReceived()`，我可以接管处理。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-08-19T02:58:02.577

你可以看看 SuperSocket，[http](http://supersocket.codeplex.com/) ://supersocket.codeplex.com/ 它可能不像 Mina 和 Netty 那样强大，但它是一种简单的框架，你可以轻松使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-04T07:37:11.333

有[XF.Server](http://www.codeproject.com/KB/IP/high-performance-server.aspx)，[这个问题](https://stackoverflow.com/questions/319732/tips-techniques-for-high-performance-c-server-sockets)说它是片状的。最后一个问题提供了有关如何在 .NET 中编写高性能网络代码的建议（使用异步套接字等）

Google Books 上还有[C# Network Programming](http://books.google.com/books?id=mHT-_P_jKQcC)的预览版，其中讨论了异步套接字调用等内容。

这篇[MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc300760.aspx)也很有趣，但不会让您更接近实际的框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-14T22:58:32.157

您可以通过[ikvm](http://www.ikvm.net/)在 .Net 中直接使用 Mina 。

# c# - CLR 如何处理 C# 中的外部方法调用

> ID：648289
> 
> 赞同：5
> 
> 时间：2009-03-15T18:28:21.477
> 
> 标签：c#, c#-3.0

我想问为什么所有外部方法调用都是静态的？CLR 如何处理这些调用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T18:33:59.763

外部方法调用是非托管代码。因此，在（托管）对象实例上调用是没有意义的——实例方法中的第一个（隐藏）参数是实例引用，也就是`this`. 通常，`extern`方法只涉及简单的类型（原语、字符串等）——而不是对象（也许数组除外——甚至它们通常被`IntPtr`首先解析）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T23:47:23.177

`extern`调用通常还必须符合“C 风格”API，并且 C 对对象一无所知，因此调用是`static`.

我的陈述并非 100% 正确，因为存在可与*[DllImport]一起使用的**ThisCall*调用约定，以帮助调用 C++ 方法。

 *# c# - 在 .Net 中创建局部变量

> ID：648290
> 
> 赞同：4
> 
> 时间：2009-03-15T18:28:26.627
> 
> 标签：c#, premature-optimization

我只想知道创建局部变量来接受函数的返回值会影响 .Net 应用程序中的内存使用或性能，尤其是在 ASP.Net 中。

说

```
 MyObject myObject = Foo();
 MyOtherObject myOtherObject = Boo();

 SomeFuntion(myObject, myOtherObject); 
```

或者

我应该使用

```
 MyFunction(Foo(), Boo()); 
```

当然，前一种用法具有更好的可读性。但是内存使用和性能呢？

在此先感谢 123Developer

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-15T18:30:47.947

不要过早优化；在发布版本中，编译器很可能无论如何都会优化这些！无论哪种方式，您都只是在为（大概）一些引用谈论少量的堆栈空间。两种方法都可以；选择更具可读性的那个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-15T18:36:26.700

CIL（C# 编译成的中间语言）是一种基于堆栈的语言，因此中间函数的返回值需要在堆栈上结束，然后才能作为参数传递给最终函数。

没有办法预测 C# 编译器会根据本地人做什么^([1])；当你这样做时，它可能会决定使用本地人，或者它可能会使用堆栈行为并完全跳过它们。同样，即使您不使用它们，它也可能会合成本地人，或者可能不会。

无论哪种方式，性能差异都不值得担心。

* * *

^([1])是的，当然，您可以编译并查看它生成的 IL 以确定它将做什么，但这仅对您正在使用的编译器的当前版本有效，并且是您不应该执行的实现细节依靠。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T18:31:26.727

我相信内存性能基本相同。除非性能测试显示出显着差异，否则请选择具有增强可读性的选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T21:04:37.450

不要害怕使用局部变量。内存使用和性能的差异非常小，或者在某些情况下根本没有。

在您的特定情况下，局部变量可能使用 8 个字节（在 64 位应用程序上为 16 个字节）的堆栈空间。但是，如果需要临时存储，编译器可以自行创建局部变量，因此两个版本都可能具有相同的局部变量集。

此外，编译器可以为某些局部变量使用处理器寄存器而不是堆栈空间，因此甚至不能确定创建局部变量实际上是否使用任何堆栈空间。

无论如何，分配堆栈空间非常便宜。调用该方法时，会为该方法中的本地数据创建一个堆栈帧。如果必须分配更多内存，那只会改变堆栈指针的移动量，根本不会产生任何额外的代码。

因此，只需编写可维护且健壮的代码，并相信编译器会优化变量的使用。

# php - 使用 PHP 转义 CURL @ 符号

> ID：648292
> 
> 赞同：10
> 
> 时间：2009-03-15T18:30:34.793
> 
> 标签：php, curl, escaping

我正在编写一个 php 应用程序，它通过 curl 数据提交以注册 iContact 电子邮件列表。但是，我不断收到无效的电子邮件地址错误。我认为这可能是因为我正在转义 @ 符号，所以它看起来像 %40 而不是 @。此外，根据带有 CURLOPT_POSTFIELDS 的 curl_setopt 的 php 文档：

> 在 HTTP“POST”操作中发布的完整数据。要发布文件，请在文件名前加上 @ 并使用完整路径。

那么，有没有办法通过 php 中的 curl 将 @ 符号作为发布数据传递，而不先通过 urlencode 运行它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-15T18:33:44.333

[`http_build_query()`](http://php.net/http_build_query)在将它传递给之前先在您的数据数组上使用`curl_setopt()`，这将导致它发送表单`application/x-www-form-encoded`而不是`multipart/form-data`（因此不会解释 @）。

另外，您为什么真正关心电子邮件地址中的@？只有@是第一个字符才重要，而不是中间的某个地方。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-02-04T02:28:03.020

在搜索 PHP curl 手册后，我发现如果 post 字段是字符串而不是文件，如果 post 使用 multipart/form-data 编码，则没有信息可以转义第一个 '@'。

我解决这个问题的方法是在文本的开头添加一个空格。而我们的后端 API 将删除空白，以便它可以删除空白并恢复原始文本。我不知道 Twitter API 是否会在用户输入时修剪空白。

如果是这样，此解决方法也适用于您。

如果有人在使用多部分/表单数据编码的 PHP curl 时找到了转义第一个“@”的方法，请告诉我们。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-12-09T02:48:40.520

我遇到了同样的问题，虽然是 curl 本身而不是 PHP curl。

当使用 curl 的字段选项 ' `-F`' 时，不会在 POST 中发送前导 @ 符号，而是指示 curl 将紧接在符号之后的文件名作为 POST 的一部分发送。

幸运的是，curl 提供了另一个选项 ' `--form-string`'，其行为方式与 ' `-F`' 相同，只是不解析 'form-string' 选项。

例如，如果你想使用 curl 来 POST field1 的值为“@value”，file1 的值为“testfile.txt”，你可以这样做：

```
curl "http://www.url.com" --form-string "field1=@value" -F "file1=@testfile.txt" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-05T10:49:03.900

这是可以同时支持包含**字符串**和**文件的****真正**解决方案。**`@`**

 **### PHP 5.6 或更高版本的解决方案：

*   使用`CURLFile`而不是`@`.

### PHP 5.5 或更高版本的解决方案：

*   启用`CURLOPT_SAFE_UPLOAD`.
*   使用`CURLFile`而不是`@`.

### PHP 5.3 或更高版本的解决方案：

*   自己构建多部分内容体。
*   自己更改`Content-Type`标题。

以下代码段将为您提供帮助：D

```
<?php

/**
 * For safe multipart POST request for PHP5.3 ~ PHP 5.4.
 * 
 * @param resource $ch cURL resource
 * @param array $assoc "name => value"
 * @param array $files "name => path"
 * @return bool
 */
function curl_custom_postfields($ch, array $assoc = array(), array $files = array()) {

    // invalid characters for "name" and "filename"
    static $disallow = array("\0", "\"", "\r", "\n");

    // initialize body
    $body = array();

    // build normal parameters
    foreach ($assoc as $k => $v) {
        $k = str_replace($disallow, "_", $k);
        $body[] = implode("\r\n", array(
            "Content-Disposition: form-data; name=\"{$k}\"",
            "",
            filter_var($v), 
        ));
    }

    // build file parameters
    foreach ($files as $k => $v) {
        switch (true) {
            case false === $v = realpath(filter_var($v)):
            case !is_file($v):
            case !is_readable($v):
                continue; // or return false, throw new InvalidArgumentException
        }
        $data = file_get_contents($v);
        $v = call_user_func("end", explode(DIRECTORY_SEPARATOR, $v));
        list($k, $v) = str_replace($disallow, "_", array($k, $v));
        $body[] = implode("\r\n", array(
            "Content-Disposition: form-data; name=\"{$k}\"; filename=\"{$v}\"",
            "Content-Type: application/octet-stream",
            "",
            $data,
        ));
    }

    // generate safe boundary 
    do {
        $boundary = "---------------------" . md5(mt_rand() . microtime());
    } while (preg_grep("/{$boundary}/", $body));

    // add boundary for each parameters
    array_walk($body, function (&$part) use ($boundary) {
        $part = "--{$boundary}\r\n{$part}";
    });

    // add final boundary
    $body[] = "--{$boundary}--";
    $body[] = "";

    // set options
    return curl_setopt_array($ch, array(
        CURLOPT_POST       => true,
        CURLOPT_POSTFIELDS => implode("\r\n", $body),
        CURLOPT_HTTPHEADER => array(
            "Expect: 100-continue",
            "Content-Type: multipart/form-data; boundary={$boundary}", // change Content-Type
        ),
    ));

}

?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-20T14:58:01.023

@PatricDaryll 的回答是正确的，但我需要做一些研究来了解在哪里使用这个[http_build_query](http://fr2.php.net/http_build_query)函数。

为了澄清和总结，而不是这样做：

```
 curl_setopt($ch, CURLOPT_POSTFIELDS, $array); 
```

您将使用：

```
 curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($array)); 
```

简单但令人困惑...... curl 足够聪明，可以理解您是否给了他一个字符串或数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-11T08:46:12.950

为了对非文件数据中的@符号进行转义，您需要执行以下操作。在文本字符串前面加上 NULL 字符

```
$postfields = array(
    'upload_file' => '@file_to_upload.png',
    'upload_text' => sprintf("\0%s", '@text_to_upload')
);

$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, 'http://example.com/upload-test');
curl_setopt($curl, CURLOPT_POSTFIELDS, $postfields);
curl_exec($curl);
curl_close($curl); 
```

# python - 碰撞准则

> ID：648299
> 
> 赞同：1
> 
> 时间：2009-03-15T18:35:19.777
> 
> 标签：python, symbian, coding-style, pys60, pep8

在 Python 中编码时，最好按照 PEP8 的准则进行编码。

在为 Symbian 编码时，最好遵循其编码标准。

但是当我为 PyS60 编码时，我应该遵循哪些准则？到目前为止，我一直在关注 PEP8，但[这段代码](http://wiki.forum.nokia.com/index.php/A_100%25_Python_implemented_Listbox_base_class)显示相反。我需要返工我的代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T21:43:10.760

“我需要修改我的代码吗？”

它是否增加了返工代码的价值？

有多少人会帮助你开发代码？

A) 不知道 PEP 8

B) 只知道 PyS60 编码标准，因为这是他们见过的唯一代码。

和

C) 不能教任何不同于 PyS60 编码标准的东西？

列出所有符合所有三个条件的人。然后决定哪个更便宜：重新编写代码或解雇它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T01:20:42.623

我在您的代码示例中看不到任何明显虚假的内容。这不是我会使用的风格，但也不是很难阅读，而且它与 PEP8 相距不远，我称之为“相反”。

PEP8 不应被视为所有代码都必须遵守的一成不变的法律。它是可读 Python 的基线。当你稍微有点 Java 程序员并且对使每个运算符周围的间距保持一致感到厌烦时，请返回并再次阅读 PEP8 的开头。小妖精的位子。

不要沉迷于对功能性、可读性且至少与 PEP8 大致相同的代码进行冗长的“返工”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T20:02:29.347

使用您最常使用的 API 样式。这是一个适用于大多数地方的简单规则（您可以在其中看到代码，即 Java/C# 有点难（呃）.. :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T15:31:13.153

我会说使用 PEP8，但如上所述，不要太挂断它。在 symbian c++ 中编码时，您应该使用 symbian 编码标准，但如果您的程序仅在平台上运行，则不一定。不要混淆 symbian 操作系统和 symbian c++（伪）语言。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T11:25:57.843

您的示例代码只是那个人的个人风格。它不遵循官方 PyS60 编码约定，没有这样的事情！写任何风格给你最好的结果。

话虽如此，我会推荐使用 PEP8，但前提是你打算使用 pylint 来给你的项目一些额外的信心。

除了 PyS60 的东西，我什么也没做，从来没有真正的 python。使用 pylint 来加快开发时间，并在我在现实生活中遇到它们之前自动指出一些潜在的缺陷。

# web-applications - 何时在 Web 界面和原生 GUI 之间进行选择？

> ID：648305
> 
> 赞同：17
> 
> 时间：2009-03-15T18:41:00.043
> 
> 标签：web-applications, interface, desktop

我们今天所知道的许多应用程序（尤其是网络应用程序，例如文件共享、sql 查询程序、一些多人游戏）都可以通过使用 Web 界面轻松提供。

我的问题是何时应该使用浏览器访问应用程序？

何时使用使用 Qt、Visual Basic 等接口构建的桌面应用程序是明智的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T18:49:58.570

Web界面的一些要点：

*   当需要从网络上的另一台计算机管理程序时
*   当需要更快的开发速度时（通常写 html/javascript 比 Qt/Gtk 等更快）
*   使程序尽可能跨平台兼容

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T18:56:23.093

这个问题没有一般的答案。这取决于一些因素：

*   您的**目标群体**- 它是广泛传播还是汇集？
*   **可移植性**——您的用户在哪些平台上工作？
*   **性能**——需要很多吗？如果是，桌面应用程序会更好。我无法想象在浏览器中运行的视频编辑软件。也许在 10 年后:)
*   以及更多必须单独解决的问题

但趋势明显转向基于 Web 的应用程序。你可以和他们一起接触很多人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T18:49:28.697

我越来越认为我们应该使用基于 Web 的 javascript（或 flex）界面作为默认界面。这意味着应用程序映像中的代码要少得多，而且它允许一个代码库做得很好，而不是几个可能做得不好的代码库。

如果您从构建 Web 界面开始，您永远不会发现自己需要一个单独的项目来构建 Web 界面。

借助现代浏览器、javascript 和 ajax 以及 javascript 库，您可以构建一个极其丰富且易于更改的界面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T19:03:44.217

我认为这是一个错误的问题。您需要做的是分析平台之间的差异以及它们如何影响您的组织。给你一个真实世界的例子。

我在一家只构建过基于 Web 的应用程序的小公司工作。其中一个应用程序没有成功，部分原因是我们有很多拨号用户，需要离线支持。

该公司继续开发了一个 .net 客户端应用程序，他们猛然醒悟。该公司没有为部署到任意数量的客户端配置的复杂性做好准备。例如，我们被 Novell Networks 咬了一口。他们没有为支持客户端应用程序的成本增加做好准备。（是的，发展已经警告并试图警告他们这意味着什么）。

因此，您不仅需要提出各种问题，还需要在生产软件的组织的背景下对其进行评估。

要问的事情包括：

1.  首先是您的应用程序可以作为网络应用程序运行吗？有些应用程序不可行。如果您需要访问低级资源，那么您将没有太多选择。
2.  你能负担得起客户端软件的维护费用吗？如果这是一个分布式应用程序，当您更新服务器但客户端没有更新时会发生什么。
3.  你能支持客户吗？
4.  构建软件的团队有什么经验？这是巨大的恕我直言。无论团队在构建 Web 应用程序方面有多出色，他们都会在开发有经验的客户端开发人员不会犯的客户端应用程序时犯错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T19:06:24.100

仅适用于桌面应用程序，如果您可以控制环境（内部网）或程序到该包/应用程序将在其中运行的环境（跨平台版本）。

看看现在的趋势，一切都在浏览器中进行，与桌面应用程序相比，我们获得了同样好的交互。运行应用程序唯一需要的就是浏览器，这总是好的，我们可以要求用户拥有一个它的正确版本，他已经准备好使用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T19:13:01.120

根据我的经验，我发现 Web 应用程序通常需要更多时间来开发，但开发 Web 应用程序有一些优势。

1.  您不必部署基于 Web 的应用程序
2.  人们通常更习惯于使用 Web 浏览器而不是自定义应用程序，因此通常情况下，应用程序会提高可用性
3.  通常，由于界面的原因，用户更容易在 Web 应用程序中找到他们想要的内容。
4.  您只需要使用几个浏览器进行测试，就可以避免测试大量可能发生冲突的客户端配置。
5.  使用 Web 应用程序，您不必关心客户端可能使用的操作系统。例如，假设您的公司决定将其台式计算机迁移到 linux，您不必构建新版本。

您应该开发桌面软件，如果您需要快速开发的东西，或者您需要性能/响应式界面（网络仍然比桌面慢）或者如果您正在开发无法在网络中完成的东西（想想图形软件/复杂游戏）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-09-17T07:34:24.950

要开发应用程序，最好将客户端和服务器代码分开。在桌面应用程序中，通常情况并非如此。处理用户交互的客户端代码与处理用户命令的服务器代码集成在一起。然而，这不一定是这种情况，只需拆分代码并通过 TCP/IP 进行通信。

下一个问题是，您的客户端代码应该在浏览器中运行还是作为本机 GUI 运行。对我来说，原生 GUI 更好，原因有很多： - 运行速度更快 - 客户端和服务器代码使用相同的编程语言 - 更少依赖更改软件组件：浏览器、html、css、Web 服务器

大多数 GUI 框架都是多平台的。

唯一的缺点是您需要在计算机上安装客户端软件。如果您想避免在服务器上安装客户端并通过终端服务器程序（如 Citrix）访问。

当然，如果您的应用程序的用户很少使用，那么 Web 应用程序是最有用的。

大型软件公司已花费数百万美元将其 GUI 更改为 Web，而没有为其应用程序添加任何附加功能。大多数时候，界面变得更加原始。所以这是一种巨大的金钱浪费，这种情况仍在继续。所以不要总是随波逐流。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-15T18:55:38.150

如果您的应用程序的 UI 可以实现为表现良好的 Web 服务/应用程序，您应该认真考虑将其作为一个选项。

可以在浏览器中运行的 UI 的最大好处是它独立于客户端操作系统。今天的大多数计算机用户通常在网络中连接不止一台计算机。不同操作系统的分布每天都在变大（windows 的替代品市场份额越来越大）。因此，您可以获得 UI 的最大可移植性。您的应用程序可以在一台计算机上启动一次并从任何地方访问。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-22T16:38:48.960

随着原生和 Web 开发的改进，GUI 部分甚至可移植性都变得不那么重要了。原生应用程序的最大因素是您需要较低的硬件访问权限，或者浏览器的安全保护机制是否会限制开发人员。也许最重要的是，如果您的应用程序需要性能并且计算量很大，例如金融应用程序中需要并行编程的那种，那么您真的需要一个原生应用程序。如果您的应用程序不需要任何适合您口味的选择，那么有许多开发人员可以使用任何技术对这些应用程序进行编程。

# php - PHP 保护自己免受 SQL 注入？

> ID：648307
> 
> 赞同：0
> 
> 时间：2009-03-15T18:42:12.927
> 
> 标签：php, security, sql-injection

当我`");--`从输入字段发送到我的本地主机 PHP 服务器时，它会自动将其转换为

> \");--

看起来很棒，只是我不知道这种行为有多值得信赖。虽然好像避免了SQL注入，但是我的开发环境和生产环境不一样，恐怕生产环境可能没有这种自动激活的保护……

为什么 PHP 会这样做（无需使用即可转换输入`mysql_real_escape_string`）？它*总是*这样做还是只使用某些扩展？依靠这种行为来防止 SQL 注入是否安全？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T18:44:33.497

您似乎启用了[魔术行情。](http://docs.php.net/manual/en/security.magicquotes.php)但是您最好禁用此选项或恢复它们。`mysql_real_escape_string`更安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T18:52:16.740

PHP 的这个“特性”被称为“魔术引号”。尽管它们可能很“神奇”，但使用它们是非常糟糕的做法，因为它们只会给人一种虚假的安全感。值得庆幸的是，它们已从 PHP 6（开发中）中删除。

可以在此[Wikipedia 文章](http://en.wikipedia.org/wiki/Magic_quotes#Criticism)中找到更详细的批评列表。

PHP 手册描述了[禁用魔术引号](http://www.php.net/manual/en/security.magicquotes.disabling.php)的各种方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T19:43:58.767

您可能希望使用[Zend_Db 之](http://framework.zend.com/manual/en/zend.db.html)类的抽象层与数据库进行对话。例如，如果您通过实例化 Zend_Db_Select 创建一个 select 语句，它将如下所示：

```
//$_GET['thing'] is automatically escaped 
$select = $zdb->select()->from('things')->where('name = ?',$_GET['thing']);
$result = $zdb->fetchRow($select->__toString());//__toString generates a really pretty, vendor independent query

//a plain vanilla query would look like this:
$result = $zdb->fetchRow('select * from things where name = ?', $zdb->quote($_GET['thing']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T14:39:29.140

您打开了魔术行情。PHP 组官方强烈反对这个函数，并且强烈反对依赖它。在运行时禁用魔术引号的方法并不总是有效，您使用的天气`.htaccess`或`ini_set()`在脚本中。一直调用 stripslashes 也会变得非常混乱。

更多细节：[http ://ca3.php.net/magic_quotes](http://ca3.php.net/magic_quotes)

# sql - 从连接表过滤

> ID：648308
> 
> 赞同：2
> 
> 时间：2009-03-15T18:43:24.017
> 
> 标签：sql, mysql, join, filtering

我在处理棘手的 SQL 查询时遇到了一些麻烦。

在我的 MySQL 数据库中，有表主题、标签和 tags_topics 加入它们。我想获取共享相同指定标签的主题。例如，假设我有 3 个 ID 为 1、2 和 3 的标签，我想获取与标签 1、2 和 3 相关联的所有主题。主题可以有其他标签，但必须有所有指定的标签。

帮我想想plz xD

编辑：在这个问题中使用 GROUP BY 找到了解决方案：[仅获取与连接表中所有条目匹配的行（SQL）](https://stackoverflow.com/questions/333750/fetching-only-rows-that-match-all-entries-in-a-joined-table-sql) 如果有人有更优雅的解决方案，请发布:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T19:36:30.067

**`JOIN`解决方案：**

```
SELECT t.*
FROM topics t
 JOIN tags_topics t1 ON (t.id = t1.topicId AND t1.tagId = 1)
 JOIN tags_topics t2 ON (t.id = t2.topicId AND t2.tagId = 2)
 JOIN tags_topics t3 ON (t.id = t3.topicId AND t3.tagId = 3) 
```

**`GROUP BY`解决方案：**

请注意，您需要列出子句中`t.*`的所有列，除非您使用 MySQL 或 SQLite。`GROUP BY`

```
SELECT t.*
FROM topics t JOIN tags_topics tt 
  ON (t.id = tt.topicId AND tt.tagId IN (1,2,3))
GROUP BY t.id, ...
HAVING COUNT(*) = 3; 
```

**子查询解决方案：**

```
SELECT t.*
FROM topics t
WHERE t.id = ANY (SELECT topicId FROM tags_topics tt WHERE tt.tagId = 1)
  AND t.id = ANY (SELECT topicId FROM tags_topics tt WHERE tt.tagId = 2)
  AND t.id = ANY (SELECT topicId FROM tags_topics tt WHERE tt.tagId = 3); 
```

**修改`GROUP BY`解决方案：**

通过在子查询中隔离搜索来简化`GROUP BY`子句。

```
SELECT t.*
FROM topics t
WHERE t.id IN (
  SELECT tt.topicId FROM tags_topics tt 
  WHERE tt.tagId IN (1,2,3))
  GROUP BY tt.id HAVING COUNT(*) = 3
); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T19:15:20.350

```
SELECT 
    topic_id
FROM
    tags_topics
WHERE
    tag_id IN (1,2,3)
GROUP BY
    topic_id
HAVING
    COUNT(*) > 2  /* or use COUNT(*) = 3 if you know that there cannot be duplicates in the junction table */ 
```

# buffer - 缓冲区是什么意思？

> ID：648309
> 
> 赞同：194
> 
> 时间：2009-03-15T18:43:52.097
> 
> 标签：buffer, terminology

我到处都能看到**“BUFFER”**这个词，但我无法理解它到底是什么。

1.  **有人可以用外行的语言**解释什么是缓冲区吗？
2.  什么时候使用？
3.  它是如何使用的？

* * *

## 回答 #1

> 赞同：358
> 
> 时间：2009-03-15T18:50:03.657

想象一下，你正在吃碗里的糖果。你经常拿一件。为了防止碗用完，有人可能会在碗空了之前把它装满，这样当你想再吃一块时，碗里就有糖果了。

碗充当您和糖果袋之间的缓冲区。

如果您正在在线观看电影，网络服务将在接下来的 5 分钟左右将持续下载到缓冲区中，这样您的计算机就不必在观看电影时下载电影（这会导致挂起）。

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2009-03-15T18:46:13.603

术语“缓冲区”是一个非常通用的术语，并不特定于 IT 或 CS。这是一个临时存储东西的地方，以减轻输入速度和输出速度之间的差异。当生产者比消费者快时，生产者可以继续将输出存储在缓冲区中。当消费者找到它时，它可以从缓冲区中读取。缓冲区位于中间以弥合差距。

* * *

如果你平均一下[http://en.wiktionary.org/wiki/buffer](http://en.wiktionary.org/wiki/buffer)上的定义，我想你会明白的。

为了证明我们确实“每天必须走 10 英里，想着下雪去上学”，请参阅[TOPS-10 Monitor Calls Manual 第 1 卷](https://www.vt100.net/manx/details/1,4098)，第 11.9 节，“使用缓冲 I/O”，书签 11-24。如果您受到噩梦的影响，请不要阅读。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-03-15T18:58:22.030

缓冲区只是用于保存数据的一块内存。在最一般的意义上，它通常是在一个操作中加载的单个内存块，然后在一个或多个操作中清空，Perchik 的“糖果碗”示例。例如，在 C 程序中，您可能有：

```
#define BUFSIZE 1024
char buffer[BUFSIZE];
size_t len = 0;

// ... later
while((len=read(STDIN, &buffer, BUFSIZE)) > 0)
    write(STDOUT, buffer, len); 
```

...这是*cp(1)*的最小版本。这里，缓冲区数组用于存储*read(2) 读取*的数据，直到它被写入；然后重新使用缓冲区。

使用了更复杂的缓冲区方案，例如*循环缓冲区*，其中使用了一些有限数量的缓冲区，一个接一个；一旦缓冲区已满，索引就会“环绕”，以便重新使用第一个。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-15T19:22:05.123

缓冲区的意思是“临时存储”。缓冲区在计算中很重要，因为互连的设备和系统很少彼此“同步”，因此当信息从一个系统发送到另一个系统时，它需要等待接收系统准备好。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-15T18:57:18.927

实际上，这取决于每种情况下的上下文，因为没有一个定义-但通常来说，缓冲区是临时保存某些东西的地方。我能想到的最好的现实世界比喻是等候区。计算中的一个简单示例是缓冲区指的是用于临时存储数据的 RAM 的一部分。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-15T18:53:12.260

缓冲区是内存（ram/disk）中的临时占位符（许多编程语言中的变量），可以在其上转储数据，然后可以进行处理。

Buffering 有很多优点，比如它可以让事情并行发生、提高 IO 性能等。

如果使用不当，它也有许多缺点，例如缓冲区溢出、缓冲区下溢等。

C 字符缓冲区示例。

```
char *buffer1 = calloc(5, sizeof(char));

char *buffer2 = calloc(15, sizeof(char)); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-10T07:46:37.023

缓冲区是内存（ram/disk）中的临时占位符（许多编程语言中的变量），可以在其上转储数据，然后可以进行处理。

术语“缓冲区”是一个非常通用的术语，并不特定于 IT 或 CS。这是一个临时存储东西的地方，以减轻输入速度和输出速度之间的差异。当生产者比消费者快时，生产者可以继续将输出存储在缓冲区中。当消费者加速时，它可以从缓冲区中读取。缓冲区位于中间以弥合差距。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-11T04:51:53.110

缓冲区是由硬件设备或程序进程共享的数据区域，它们以不同的速度或不同的优先级运行。缓冲区允许每个设备或进程在不被另一个阻止的情况下运行。为了使缓冲区有效，缓冲区的大小以及将数据移入和移出缓冲区的算法。

缓冲区是一个“中点保持位置”，但它的存在与其说是为了加快一项活动的速度，不如说是为了支持不同活动的协调。

该术语用于编程和硬件中。在编程中，缓冲有时意味着需要从其最终预期位置筛选数据，以便在将其移动到常规文件或数据库之前可以对其进行编辑或以其他方式处理。

# design-patterns - 数据绑定作为一种设计模式

> ID：648311
> 
> 赞同：7
> 
> 时间：2009-03-15T18:44:09.833
> 
> 标签：design-patterns, data-binding, binding

我在哪里可以找到与 GoF 类似的关于 Binding 的讨论？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T19:55:47.803

[Paul Stovell](https://stackoverflow.com/users/57132/paul-stovell)对 Binding Oriented Programming 进行了精彩的讨论。他的网站现在离线，所以我能找到的最接近的是他的这篇文章：

[http://web.archive.org/web/20070516233101/www.paulstovell.net/blog/index.php/binding-orient-programming/](http://web.archive.org/web/20070516233101/www.paulstovell.net/blog/index.php/binding-oriented-programming/)

这是我想的原始文章的链接；我在回程机器上找不到它的版本，所以希望他的网站能很快恢复！

[http://www.paulstovell.com/blog/searchquery-windows-forms-binding-orientation-programming-example](http://www.paulstovell.com/blog/searchquery-windows-forms-binding-oriented-programming-example)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T18:58:51.543

数据绑定是Presentation-Model模式同步问题的一种解决方案。

找到这篇关于它的文章： [http ://martinfowler.com/eaaDev/PresentationModel.html](http://martinfowler.com/eaaDev/PresentationModel.html)

但我很有信心你可以在互联网上找到其他来源。

# asp.net - RegularExpressionValidator 不会让我进入下一页

> ID：648329
> 
> 赞同：1
> 
> 时间：2009-03-15T18:52:20.373
> 
> 标签：asp.net, regex, datalist

我有两个数据列表。一个像菜单一样工作，您可以在其中单击链接以填充其他数据列表。我还添加了一个下一个和上一个链接按钮来在不同的“页面”之间移动，这样您就不必使用菜单数据列表进行更改。

现在在后面的代码中，根据我从数据库中获得的值，我添加了一个 RegularExpressionValidator。

这很好用，直到我想使用下一个按钮（或上一个按钮）。即使与 RegularExpressionValidator 相比，检查的所有控件都是有效的，我也永远无法加载新值。下一个和上一个按钮触发 datalist selected index change 事件，然后我检查它是单击的上一个按钮还是下一个按钮。

但是上一个和下一个按钮都麻木了。他们甚至不触发该事件。就像点击背景一样。什么都没发生。

我已经检查了 PageIs.Valid，这是真的。

有谁知道导致这种行为的原因是什么？

提前致谢！

下面的一些文本是瑞典语的，但对于代码来说应该无关紧要。

```
rev_checkfieldvalue.ControlToValidate = "tb_detailValue";
switch (iDataTypeId)
{
    case 2:
        rev_checkfieldvalue.ValidationExpression = @"^\d*[0-9 ]+$";
        rev_checkfieldvalue.Text = "Fältet får endast innehålla siffror och mellanslag.";
        break;
    case 3:
        break;
    case 4:
        break;
    case 5:
        rev_checkfieldvalue.ValidationExpression = @"\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*";
        rev_checkfieldvalue.Text = "Fältet får endast innehålla en e-postadress.";
        break;

}
e.Item.Controls.AddAt(32, rev_checkfieldvalue);

<asp:DataList ID="dl_componentInfo" DataKeyField="ComponentId" runat="server" OnItemDataBound="dl_componentInfo_OnItemDataBound" OnItemCommand="dl_componentInfo_OnItemCommand">
    <ItemTemplate>
        <table>
            <tr>
                <td colspan="2"><asp:Label ID="lb_componentName" SkinID="lblHeader" runat="server" Text='<%# Eval("ComponentName") %>' /></td>
            </tr>
            <tr>
                <td colspan="2">Fält markerade med * är obligatoriska</td>
            </tr>
            <tr>
                <td>&nbsp;</td>
                <td>
                    <asp:DataList ID="dl_details" OnItemDataBound="dl_details_OnItemDataBound" runat="server">
                        <ItemTemplate>
                            <table>
                                <tr>
                                    <td colspan="2">
                                        <asp:Label ID="lbl_detailName" Text='<%# Eval("DetailName") %>' runat="server"></asp:Label>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <asp:Label ID="lbl_custDetName" runat="server" />
                                    </td>
                                    <td align="left">
                                        <%--Always hidden values--%>
                                        <asp:Label ID="lbl_detailTypeId" Visible="false" Text='<%# Eval("DetailTypeId") %>' runat="server" />
                                        <asp:Label ID="lbl_detailId" Visible="false" Text='<%# Eval("DetailId") %>' runat="server" />
                                        <asp:Label ID="lbl_dataTypeId" Visible="false" Text='<%# Eval("DataTypeId") %>' runat="server" />
                                        <asp:Label ID="lbl_customerEventValueId" Visible="false" Text='<%# Eval("CustomerEventValueId") %>' runat="server" />
                                        <asp:Label ID="lbl_reqFld" Visible="false" Text='<%# Eval("ReqFld") %>' runat="server" />

                                        <%--Sometimes visible values--%>
                                        <asp:Label ID="lbt_detailValue" Visible="false" Text='<%# Eval("PresetDetailValue") %>' runat="server" />
                                        <asp:Label ID="lbtb_detailValue" Visible="false" Text='<%# Eval("PresetDetailValue") %>' runat="server" />
                                        <asp:Label ID="lbth_detailValue" Visible="false" Text='<%# Eval("PresetDetailValue") %>' runat="server" />
                                        <asp:Label ID="lbc_detailValue" Visible="false" Text='<%# Eval("PresetDetailValue") %>' runat="server" />
                                        <asp:DropDownList ID="dd_detailValue" Visible="false" runat="server"></asp:DropDownList>
                                        <%--Om det ska gå att markera/avmarkera alla så använd AJAX--%>
                                        <asp:CheckBoxList ID="cbl_detailValue" RepeatDirection="Horizontal" RepeatLayout="flow" Visible="false" runat="server" />
                                        <asp:CheckBox ID="cb_detailValue" Visible="false" Text='<%# Eval("PresetDetailValue") %>' runat="server" />
                                        <asp:TextBox ID="tb_detailValue" Visible="false" Text='<%# Eval("PresetDetailValue") %>' runat="server" />
                                        <asp:TextBox ID="ta_detailValue" Visible="false" Text='<%# Eval("PresetDetailValue") %>' runat="server"></asp:TextBox>
                                    </td>
                                </tr>
                            </table>
                        </ItemTemplate>
                    </asp:DataList>
                </td>
            </tr>
        </table>
    </ItemTemplate>
    <FooterTemplate>
        <table width="600">
            <tr>
                <td>
                    <asp:LinkButton id="lb_previous" Text="Föregående" CommandName="Previous" runat="server"/>
                </td>
                <td>
                    <asp:LinkButton id="lb_next" Text="Nästa" CommandName="Next" runat="server"/>
                </td>
            </tr>
        </table>
    </FooterTemplate>
</asp:DataList> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T19:31:53.073

我以为我解决了这个问题，但它只是停止检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T19:09:47.710

因此，对于第二种情况，您接受任何非空的数字和空格字符串。

这是你的意图吗？

# c++ - 我应该学习 GTK+ 还是 GTKMM？

> ID：648334
> 
> 赞同：11
> 
> 时间：2009-03-15T18:54:27.203
> 
> 标签：c++, c, user-interface, gtk, gtkmm

我是一名 C# 程序员，大约 2 年前开始使用 ubuntu。我想学习 C 或 C++ 中的 GUI 编程。我真的不喜欢单声道，它往往会在我的系统上崩溃。我对 C++ 有基本的了解。我从未在 C 中工作过，但它看起来很酷。我应该学习/使用哪个工具包？给出每个的优点/缺点。谢谢！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-16T02:20:33.183

我可能会被指责有偏见，因为我确实帮助了 gtkmm，但我首先是用户，所以......无论如何，如果你对 C++ 感到满意，我强烈推荐 gtkmm。使用 gtkmm 比使用 GTK+ 更容易管理内存，因为引用计数的对象是使用智能指针自动管理的。您还可以将对象实例化为自动变量（例如在堆栈上），并让它们的生命周期由它们的作用域决定。所以在实践中，使用 gtkmm 比使用 GTK+ 更容易避免内存泄漏。

gtkmm 相对于 GTK+（在我看来）的另一个*巨大*优势是使用了类型安全的信号框架。在 GTK+ 中，您经常需要将事物作为 void 指针传递，然后将它们转换为您认为它们应该是的类型。在 gtkmm 中，您不需要这样做，并且可以利用编译器在信号处理程序上强制执行类型安全。

与 C/GTK+ 相比的另一大优势是易于派生新类。在 GTK+ 中，您需要编写大量样板代码，并且基本上重新实现您在 C++ 中免费获得的东西，作为语言的一部分（例如继承、构造函数、析构函数等）。这更繁琐且容易出错。

grayfade 提到 gtkmm 是不完整的，他在一定程度上是对的—— gtkmm 并没有完全涵盖 GTK+ API 中的所有内容（尽管它非常接近）。但实际上这不是问题，因为您总是可以直接从您的 gtkmm 代码中使用 C/GTK+ API。与 C# 或 python 绑定相比，这种 C 兼容性是 C++ 的一个巨大优势，如果绑定不涵盖 API 的一部分，您将别无选择。

选择 GTK+ 而不是 gtkmm (IMO) 的唯一真正原因是 gtkmm 有一点额外的开销，因为它是 C 库顶部的包装器（但这通常只是一个函数调用，影响可以忽略不计） ，或者如果你讨厌或不能使用 C++。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-16T02:34:29.640

如果您是 C# 程序员，为什么不看看[Vala](http://live.gnome.org/Vala)呢？

我的大多数 Linux GUI 应用程序都使用 pygtk，但是对于我现在正在处理的项目来说，Python 实在是太慢了，所以我试图选择 GTK+ 和 GTKmm 中的一个。然后我遇到了瓦拉。

这是一种相当新的语言，因此目前的文档非常有限，但我认为它具有两全其美的优点：C# 语法和 C 速度。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-15T18:59:03.573

由于您更熟悉 C++，您可能会发现 GTKmm 更合适，因为您可以使用 RAII 之类的惯用语。不幸的是，GTKmm 有点不完整，并且缺少一些 GTK 较少使用的部分。

然而，GTK+ 本身本质上公开了一个类似于 C++ 中的对象模型，但只有 C 函数。C++ 中的构造和销毁之类的事情在 C API 中显式完成，小部件的实例仅通过指针处理。

尝试两者，看看哪个更适合您的项目。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-11-02T17:32:27.377

正如许多人所说，Gtkmm 确实为您提供了良好的内存管理、引用计数对象等。不过，它确实属于一个部门。文档。整个 Gtkmm 项目都受到“无文档”现象的影响，其中发布（并在 3rd 方网站上重新发布）文档只是对头文件的 javadoc 扫描。

只是想让你知道你会进入什么。例如，[Scrolled Window](http://developer.gnome.org/gtkmm/stable/classGtk_1_1ScrolledWindow.html#a08e8c15db9b3d1d025b5d7d6ec46ae5f)是 Gtkmm 中记录较好的类之一。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-05T04:48:35.187

我建议用 gedit学习**vala 。**

[http://www.valaide.org/doku.php](http://www.valaide.org/doku.php)：瓦拉

[https://launchpad.net/valable](https://launchpad.net/valable)：日食

[http://code.google.com/p/vtg/：Gedit](http://code.google.com/p/vtg/) _

[http://abderrahim.arablug.org/blog/：anjuta](http://abderrahim.arablug.org/blog/) _

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-15T19:07:36.983

你看过Qt吗？
这是不错的 C++ 设计、跨平台和 LGPL

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-12-12T16:54:54.857

我认为最好的方法是先学习 gtkmm！在您完成 gtkmm 的基础知识之后，GTK+ 应该很容易学习（前提是您了解 C 并且熟悉指针）。

如果您不了解 C，您可以通过阅读 Dennis Ritchie 的 The C Programming Language 快速学习它

我建议你先学习gtkmm，因为它是专门为C++设计的，它与C#有点相似，都是面向对象的，所以gtkmm会比GTK+更容易学习。

在 gtkmm 之后，您可以继续使用 GTK+

大部分开源公司使用 GTK+ 而不是 gtkmm，所以 GTK+ 值得学习！

# c# - 在 ASP.Net 中注册活动的最佳地点

> ID：648347
> 
> 赞同：1
> 
> 时间：2009-03-15T18:59:46.643
> 
> 标签：c#, asp.net

我现在进入了一个 ASP.Net 项目（当然，这是我的第一个项目 ASP.Net :)）。我们正在使用依赖注入，该解决方案旨在使用 MVC 模式。这是现在的问题。

我可以看到用作自定义控件一部分的不同 ASP.Net 内部控件的事件正在自定义控件的 OnInit 事件方法中注册，而不是在自定义控件的构造函数中注册它们。这是一个好习惯吗？？我想知道..

在此先感谢 123Developer

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T20:29:30.500

是的，oninit 通常是挂钩事件的地方。但是，这可能会因特定场景而有所不同，因为在某些情况下，您可能在已绑定的列表中拥有控件，在这种情况下，您通常在 asp.net 生命周期的早期就没有控件的层次结构。

我建议您尝试与 asp.net 生命周期和事件一起玩。不这样做通常会让你陷入意想不到的行为。请检查此以获取更多信息：http: [//msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T19:13:23.367

如果您使用的是 ASP.NET MVC，请远离底层 ASP.NET 模型的事件驱动模型。

您应该在控制器方法中处理所有以控制器为中心的逻辑，而不是在任何控制事件中。

此外，我不是 100% 确定，但 MVC 框架不支持许多标准的 asp.net 控件（这可能随着最近的候选版本而改变）。您可能会发现标准 asp.net 控件的行为不正确。

# xml - 如何从 xml 文档的不同部分嵌套 xsl:for-each？

> ID：648363
> 
> 赞同：0
> 
> 时间：2009-03-15T19:11:35.243
> 
> 标签：xml, loops, xslt, nested, xslt-1.0

我将 XSL 放在一起，而不是使用定义所有需要构建的项目的 XML 文件作为输入来创建 NAnt 构建脚本。我们有许多非常相似的项目，它们具有标准布局和已定义的移交区域标准，因此拥有一个定义开发人员想要发生的事情而不是描述需要如何完成的 XML 文件将极大地帮助构建服务的采用。

我想在产品构建 XML 文件中尽早定义要使用的构建模式，即

```
<Build>
    <BuildModes>
        <Mode name="Debug" />
        <Mode name="Release" />
    </BuildModes>

    <ItemsToBuild>
        <Item name="first item" .... />
        <Item name="second item" .... />
    </ItemsToBuild>
 </Build> 
```

我想要一个

```
<xsl:for-each select="/Build/BuildModes/Mode">
    <xsl:for-each select="/Build/ItemsToBuild/Item">
        <exec program="devenv">
        <xsl:attribute name="line">
            use the @name from the Mode and other stuff from Item to build up the command line
        </xsl:attribute>
    </xsl:for-each>
</xsl:for-each> 
```

现在，我可以通过在两条 for-each 行之间定义一个来保存 Mode/@name 值，但这有点混乱，我真正想要做的是翻转下一个，以便构建模式在里面Item 循环，因此它先构建一种模式，然后再构建另一种模式。目前它将构建所有调试，然后构建所有发布版本。要做到这一点，我必须声明几个，这变得非常混乱。

所以当源文档中的元素没有嵌套时它是嵌套的。

编辑：

好的，正如下面接受的答案所示，在大多数情况下使用 for-each 是一个坏主意，我已将此示例改写为以下示例。略有不同，因为我使用的架构已针对上述帖子进行了简化，但您明白了。

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" encoding="ISO-8859-1" indent="yes"/>

<xsl:template match="/BuildDefinition">
    <xsl:apply-templates select="/BuildDefinition/VS2008SLN/DeploymentProject"/>
</xsl:template>

<xsl:template match="/BuildDefinition/VS2008SLN/DeploymentProject">
    <xsl:apply-templates select="/BuildDefinition/BuildModes/Mode">
        <xsl:with-param name="BuildTarget" select="." />
    </xsl:apply-templates>
</xsl:template>

<xsl:template match="/BuildDefinition/BuildModes/Mode">
    <xsl:param name="BuildTarget" />
    <exec program="devenv"> <!-- not the real call, but for example purposes -->
        <xsl:attribute name="ProjectName" select="$BuildTarget/@ProjectName"/>
        <xsl:attribute name="SolutionName" select="$BuildTarget/../@SolutionName" />
        <xsl:attribute name="ModeName" select="@name"/>
    </exec>
</xsl:template>
</xsl:stylesheet> 
```

这是它运行的架构

```
<BuildDefinition Version="1.0">

 <BuildModes>
    <Mode name="Debug" />
    <Mode name="Release" />
</BuildModes>

<VS2008SLN 
    SolutionName="MySolution"
    SolutionDirectory="Visual Studio 2008\MySolution">
    <DeploymentProject 
        ProjectName="MyDeploymentProject" 
        DeploymentTargetDirectory="EndsUpHere"
        DeploymentManifestName="AndCalledThisInTheDocumentation" />
</VS2008SLN> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T20:38:08.543

成功的关键是[根本](http://gregbeech.com/blog/using-xsl-for-each-is-almost-always-wrong)[不使用`<xsl:for-each>`](http://gregbeech.com/blog/using-xsl-for-each-is-almost-always-wrong)。

```
<xsl:template match="/">
  <xsl:apply-templates select="Build/BuildModes/Mode" />
</xsl:template>

<xsl:template match="Build/BuildModes/Mode">
  <exec program="devenv">
    <xsl:apply-templates select="/Build/ItemsToBuild/Item">
      <xsl:with-param name="BuildMode" select="." />
    </xsl:apply-templates>
  </exec>
</xsl:template>

<xsl:template match="Build/ItemsToBuild/Item">
  <xsl:param name="BuildMode" />
  <xsl:attribute name="line">
    <!-- use $BuildMode/@name etc. to build up the command line -->
  </xsl:attribute>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T19:55:59.020

我认为您可能缺少的关键技术是将当前上下文节点保存在变量中，然后再执行更改上下文节点的操作。如果您使用该技术，您所拥有的就可以发挥作用，下面的示例将使用该技术。

与许多 XSLT 问题一样，如果您考虑转换而不是过程，这将更容易解决。问题实际上并不是“我如何嵌套 for-each 循环？”，而是“如何将`Item`元素转换为所需的`exec`元素？”

```
<xsl:template match="/">
   <output>
      <xsl:apply-templates select="/Build/ItemsToBuild/Item"/>
   </output>
</xsl:template>

<xsl:template match="Item">
   <xsl:variable name="item" select="."/>
   <xsl:for-each select="/Build/BuildModes/Mode">
      <exec program="devenv">
         <xsl:attribute name="itemName" select="$item/@name"/>
         <xsl:attribute name="modeName" select="@name"/>
         <!-- and so on -->
      </exec>
   </xsl:for-each>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T19:32:15.397

您可以使用命名模板：

```
<xsl:template name="execute">
  <xsl:param name="mode" />
  <xsl:for-each select="/Build/ItemsToBuild/Item">
   <exec program="devenv">
    <xsl:attribute name="line">
        use $mode and other stuff from Item to build up the command line
    </xsl:attribute>
   </exec>
  </xsl:for-each>
</xsl:template> 
```

然后调用它：

```
<xsl:for-each select="/Build/BuildModes/Mode">
 <xsl:call-template name="execute">
  <xsl:with-param name="mode" select="@name" />
 </xsl:call-template>
</xsl:for-each> 
```

这将有助于分离事物，但我不确定它是否真的更清楚。

不幸的是，无论您如何看待它，您都必须做一些工作，因为您正在尝试同时获取两个上下文。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T19:57:32.230

您可以使用**变量**来存储 Item 上下文。还有一个**用于清理属性定义的简写**。

```
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="/">
        <someroot>
            <xsl:for-each select="/Build/ItemsToBuild/Item">
                <xsl:variable name="item" select="." />
                <xsl:for-each select="/Build/BuildModes/Mode">
                    <exec program="devenv"
                        item="{$item/@name}" line="{@name}" />
                </xsl:for-each>
            </xsl:for-each>
        </someroot>
    </xsl:template>
</xsl:stylesheet> 
```

结果是

```
<someroot>
    <exec program="devenv" item="item1" line="Debug" />
    <exec program="devenv" item="item1" line="Release" />
    <exec program="devenv" item="item2" line="Debug" />
    <exec program="devenv" item="item2" line="Release" />
</someroot> 
```

# database - 在访问中合并表

> ID：648377
> 
> 赞同：0
> 
> 时间：2009-03-15T19:25:14.227
> 
> 标签：database, ms-access, merge

我有一个带有 2 个表的 MS Access 数据库文件：`t1`, `t2`. 两者都有主键，假设`id`，但`t1`有 3 列`A`，`B`并且`C`，同时`t2`有列`D`，`E`和`F`。

两者都有相同的行，但每个都有不同的列，如所述。

合并这两个表的最简单方法是什么？请注意，它们非常大，不能导出到 excel、CSV 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T22:14:13.400

如果您像这样粘贴 SQL：

```
SELECT t1.ID, t1.a, t1.b, t1.c, t2.d, t2.e, t2.f 
INTO t0
FROM t1 INNER JOIN t2 ON t1.ID = t2.ID; 
```

进入 Access 中查询设计窗口的 SQL 视图，您将有一个生成表查询，该查询将从 t1 和 t2 创建 t0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T19:27:01.790

这一切都可以仅使用 Access GUI 来完成。

一种。编辑 t1，并添加两个新列。

湾。在 Update querydef 的 Querydef 设计模式中，拉出两个表，并在 id 上加入它们。

C。用 t2 中的相同两列更新 t1 中的两个新列。

d。执行查询定义 (F5)。

完毕！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T20:54:07.493

访问支持工会吗？

```
select a,b,c from t1
union
select d as a, e as b and f as c from t2 
```

# c# - 如何获得一定百分比的 LINQ to SQL 提交更改？

> ID：648379
> 
> 赞同：2
> 
> 时间：2009-03-15T19:27:33.473
> 
> 标签：c#, sql-server, linq-to-sql

我想知道是否有人问过类似的问题。

基本上，我有一个巨大的树，我正在使用 LINQ 对象在 RAM 中构建，然后我使用`DataContext.SubmitChanges()`.

它有效，但我找不到如何给用户一种视觉指示到目前为止查询的进展情况。如果我最终可以实现一种进度条，那就太好了，即使性能损失很小。

请注意，我有相当多的行要放入数据库，超过 750,000 行。我没有准确计时，但确实需要很长时间才能将它们放入。

**编辑：**我想我最好说明一下我在做什么。

基本上，我正在构建指环王的后缀树。因此，有很多节点，并且某些节点具有与之关联的位置（恰好位于后缀末尾的节点）。我正在按照这些思路构建 Linq 对象。

```
suffixTreeDB.NodeObjs.InsertOnSubmit(new NodeObj()
{
    NodeID = 0,
    ParentID = 0,
    Path = "$"
}); 
```

在 RAM 中完全生成后缀树后（只需几秒钟），然后我调用`suffixTreeDB.submitChanges();`

我想知道是否有更快的方法来做到这一点。谢谢！

**编辑 2：**我做了一个秒表，显然需要 6 分钟来编写数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T20:18:05.707

我建议你分开你正在做的电话，因为无论如何它们都是在单独的电话中发送到数据库的。这也将减少事务的大小（调用 submitchanges 时 linq 会这样做）。

如果将它们分成 75.000 的 10 个块，则可以提供 1/10 比例的粗略估计。

**更新 1：**重新阅读您的帖子和新评论后，我认为您应该改为查看 SqlBulkCopy。如果您需要改进操作的时间，那就是要走的路。检查此相关问题/答案：[在 SQL Server（C# 客户端）中批量插入大量数据的最快方法是什么](https://stackoverflow.com/questions/24200/whats-the-fastest-way-to-bulk-insert-a-lot-of-data-in-sql-server-c-client/24224#24224)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-02T17:06:39.597

我能够通过使用 ctx.Log 和 ActionTextWriter 获得 ctx.submitchanges() 的百分比进度

```
ctx.Log = new ActionTextWriter(s => {
if (s.StartsWith("INSERT INTO"))
    insertsCount++;
    ReportProgress(insertsCount);
}); 
```

更多详细信息可在我的博客文章 [http://epandzo.wordpress.com/2011/01/02/linq-to-sql-ctx-submitchanges-progress/](http://epandzo.wordpress.com/2011/01/02/linq-to-sql-ctx-submitchanges-progress/)

和 stackoverflow 问题 [LINQ to SQL SubmitChangess() 进度](https://stackoverflow.com/questions/4563828/linq-to-sql-submitchangess-progress)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T20:01:07.120

这并不理想，但您可以创建另一个线程来定期查询您正在填充的表以计算已插入的记录数。我不确定如果您在事务中运行，这将如何/是否有效，因为可能存在锁定/等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T22:02:27.563

我真正认为我需要的是 Bulk-Insert 的一种形式，但是 Linq 似乎不支持它。

# c++ - 新表达式的评估顺序？

> ID：648380
> 
> 赞同：7
> 
> 时间：2009-03-15T19:27:35.547
> 
> 标签：c++

在下面的代码示例中，C++ 标准是否保证在内存分配（调用 operator new）之后但在调用 X 的构造函数之前评估“++i”？

```
new X( ++i ) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-15T20:01:40.677

从我的 n2798 副本中：

> **5.3.4 新**
> 
> 21 分配函数是在计算构造函数参数之前调用还是在计算构造函数参数之后但在进入构造函数之前调用是未指定的。如果分配函数返回空指针或使用异常退出，是否评估构造函数的参数也未指定。

结合阅读（以避免歧义）：

> **5.3.4 新**
> 
> 8 new-expression 通过调用分配函数 (3.7.4.1) 为对象获取存储空间。如果 new 表达式因抛出异常而终止，它可以通过调用释放函数 (3.7.4.2) 来释放存储空间。如果分配的类型是非数组类型，则分配函数的名称是 operator new，而释放函数的名称是 operator delete。如果分配的类型是数组类型，则分配函数的名称是 operator new[]，而释放函数的名称是 operator delete[]。[...]

这几乎回答了这个问题。答案是不'。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T19:39:26.097

通常，只要不改变含义，C++ 编译器可以自由地重新排序函数参数。

请在此处查看 Martin 的回答：[C++ 程序员应该了解哪些常见的未定义行为？](https://stackoverflow.com/questions/367633/what-are-all-the-common-undefined-behaviour-that-c-programmer-should-know-about)

实际上有 2 个函数调用在这里进行。

1.  新操作员
2.  X 的构造函数调用

即使这是两个单独的调用，我也不相信这两个操作之间存在序列点。维基百科似乎[支持这一点](http://en.wikipedia.org/wiki/Sequence_point)。因此，编译器可以自由地重新排序评估，因为它认为合适。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T19:38:48.127

一句话，没有。

“new”和“++i”之间没有序列点

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T19:38:45.770

++i 应该在分配和调用之前执行。

编辑：（我可能回答得太快了）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T20:00:23.660

新 X(++i)

new 运算符 wrt C++ 标准的语法：

[::] "new" ["(" 表达式列表 ")"] {new-type-id | "(" type-id ")"} ["(" expression-list ")"]

所以，

1.  为对象 X 分配内存。
2.  表达式列表将被评估以传递给分配对象的构造函数。

因此，我们可以确定，在调用对象 X 的构造函数之前，将评估 ++i。

干杯..

# .net - 在 .NET 中查找数据包丢失和跟踪路由

> ID：648385
> 
> 赞同：0
> 
> 时间：2009-03-15T19:30:16.803
> 
> 标签：.net, vb.net, winforms, network-programming, network-protocols

我正在尝试编写代码以捕获计算机上的数据包丢失，但我能够这样做的唯一方法是运行 NetStat.exe 和 TraceRt.exe 进程并将它们捕获到列表框（使用下面的代码） ：

```
Private Sub myProcess()
    Dim p As System.Diagnostics.Process
    Dim theFile, sTemp, sLineOut, mySent, myRetrans As String
    Dim intSentStart As Double
    Dim isEnabled As Boolean

    p = New System.Diagnostics.Process
    theFile = t.Name

    If File.Exists("c:\windows\system32\" & theFile) Then
        theFile = "c:\windows\system32\" & theFile
    Else
        MessageBox.Show("Unable to find the " & theFile & " file on your computer.", "File Find Error!", MessageBoxButtons.OK, MessageBoxIcon.Error)
    End If

    Select Case t.Name
        Case "TraceRt.exe"
            p.StartInfo.Arguments = "-h 30 www.stackoverflow.com"

        Case "NetStat.exe"
            p.StartInfo.Arguments = "-s -p tcp"
    End Select

    Try
        p.StartInfo.FileName = theFile
        p.StartInfo.CreateNoWindow = True
        p.StartInfo.UseShellExecute = False
        p.StartInfo.RedirectStandardOutput = True
        p.Start()
        p.PriorityClass = System.Diagnostics.ProcessPriorityClass.Normal

        sLineOut = ""

        Do While Not p.HasExited
            sTemp = p.StandardOutput.ReadLine()
            If sTemp <> "" Then
                sLineOut = sLineOut & sTemp & vbNewLine
                'Send to listbox
                setTrace(sTemp)
            End If
        Loop
        If sLineOut = "" Then
            'Clear Listbox
            clearTrace()
            myProcess()
            Exit Sub
        End If
        If t.Name = "NetStat.exe" Then
            Try
                If lboxTrace.Items.Count < 9 Then
                    'Clear Listbox
                    clearTrace()
                    myProcess()
                    Exit Sub
                End If
                mySent = ""
                mySent = lboxTrace.Items.Item(8) '("Segments Sent")
                mySent = Trim(mySent.Replace("Segments Sent", ""))
                mySent = Trim(mySent.Replace("=", ""))

                myRetrans = ""
                myRetrans = lboxTrace.Items.Item(9)
                myRetrans = Trim(myRetrans.Replace("Segments Retransmitted", ""))
                myRetrans = Trim(myRetrans.Replace("=", ""))

                intSentStart = Math.Round((myRetrans / mySent) * 100, 2)

                'setTrace sends data to the listbox
                If intSentStart < 2 Then
                    setTrace("Your Current Packet Loss is: " & intSentStart & "%.")
                    setTrace("Your packet loss is within acceptable ranges.")
                Else
                    setTrace("Your Current Packet Loss is: " & intSentStart & "%.")
                    setTrace("Your packet loss is below acceptable ranges!")
                    setTrace("Please contact your Internet Provider about your Internet Connection.")
                End If

            Catch ex As Exception
                'Clear Listbox
                clearTrace()
                myProcess()
                Exit Sub
            End Try
        End If
    Catch ex As Exception
        MessageBox.Show(ex.Message)
    End Try

End Sub 
```

有没有人有更好的主意来获取这些信息？我宁愿使用托管代码，也不愿以这种方式破解它。

提前致谢！-JFV

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T19:35:53.327

不确定这是否是您要查找的内容，但您看过[Ping 类](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.ping.aspx)吗？

编辑：实际上对于 TraceRoute，请在此处查看答案：[TraceRoute and Ping in C#](https://stackoverflow.com/questions/142614/traceroute-and-ping-in-c)。

对于 Netstat，请查看[http://towardsnext.wordpress.com/2009/02/09/netstat-in-c/](http://towardsnext.wordpress.com/2009/02/09/netstat-in-c/)。

# iphone - UIWebView 是否泄漏内存？

> ID：648396
> 
> 赞同：12
> 
> 时间：2009-03-15T19:36:45.667
> 
> 标签：iphone, cocoa-touch, memory-leaks, uiwebview

如果您的 iPhone 应用程序使用 UIWebView，并且加载了许多带有大图像的页面，您可能会发现您正在泄漏内存。这可以解决吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-04-14T20:12:49.903

尝试添加

```
[webView loadHTMLString: @"" baseURL: nil]; 
```

就在你发布 webview 之前。对于 4.2.1 中与在 UIWebView 中显示 PDF 相关的泄漏，这为我解决了大部分泄漏问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-29T21:15:42.787

这是一个已知问题。

Marco Arment 在这里提到了泄漏。 [http://blog.instapaper.com/post/60628543](http://blog.instapaper.com/post/60628543)

你能做的不多。“拦截” html 的一种选择是尝试截断您不需要的部分。显然，这不太可能适用于通用 web 视图。

与此同时，您可能只需要等待 Apple 的更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T05:38:32.677

我有一个

> 收到内存警告，级别 1

然后应用程序在 Web 视图中因巨大的文本大小而崩溃。

[这篇文章](http://www.codercowboy.com/code-uiwebview-memory-leak-prevention/)帮助了我，解决了泄漏问题。使用起来非常简单直接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-08T20:38:34.017

我这样做了，它似乎有帮助（查看泄漏并通过模拟器运行）：

```
MyWebViewController *myWebViewController = [[[MyWebViewController alloc] initWithNibName:@"MyWebView" bundle:[NSBundle mainBundle]] autorelease]; 
```

正是“自动释放”似乎有助于在我打开的每个 web 视图上泄漏都没有变大。

# php - 对多维数组进行排序

> ID：648405
> 
> 赞同：1
> 
> 时间：2009-03-15T19:40:08.653
> 
> 标签：php, arrays, sorting, multidimensional-array

我需要对代表文件系统结构的多维数组进行排序：

```
Array
(
    [dir1] => Array
        (
            [dir2] => Array
                (
                    [dir3] => Array
                        (
                            [dir4] => Array
                                (
                                    [0] => file1.php
                                    [1] => abc.php
                                )

                        )

                    [0] => file2.php
                    [1] => abc.php
                )

        )

    [abc] => Array
        (
            [abc] => Array
                (
                    [abc] => Array
                        (
                            [0] => file5.php
                        )

                )

        )

) 
```

我不知道算法是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T19:43:54.650

[http://php.net/sort#51088](http://php.net/sort#51088)

用 ksort($a) 替换 mulsort 函数开头的 sort($a)

编辑：对不起，只需将 mulsort 代码更改为：

```
function mulsort(&$a)
{
 ksort($a);
 foreach($a as &$value)
    if (is_array($value))
        mulsort($value);
} 
```

# c# - 内联函数

> ID：648409
> 
> 赞同：9
> 
> 时间：2009-03-15T19:44:30.810
> 
> 标签：c#, inlining

什么是内联？

这有什么用途？

你可以在 C# 中内联一些东西吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-15T19:46:51.163

**这是什么**

在 C 和 C++ 中，您使用 inline 关键字来告诉编译器调用例程，而无需将参数压入堆栈的开销。相反，函数将其机器代码插入到调用它的函数中。这可以在某些情况下显着提高性能。

**危险**

随着内联函数大小的增加，使用“内联”的速度优势显着降低。过度使用实际上会导致程序运行速度变慢。内联非常小的访问器函数通常会减少代码大小，而内联非常大的函数会显着增加代码大小。

**C#中的内联**

在 C# 中，内联发生在 JIT 编译器做出决定的 JIT 级别。目前 C# 中没有可以显式执行此操作的机制。如果您想知道 JIT 编译器在做什么，那么您可以调用：`System.Reflection.MethodBase.GetCurrentMethod().Name`在运行时。如果方法是内联的，它将返回调用者的名称。

在 C# 中，您不能强制方法内联，但可以强制方法不内联。如果您确实需要访问特定的调用堆栈并且需要删除内联，您可以使用：`MethodImplAttribute`with `MethodImplOptions.NoInlining`。此外，如果一个方法被声明为虚拟，那么它也不会被 JIT 内联。这背后的原因是调用的最终目标是未知的。

[更多关于内联](https://docs.microsoft.com/en-us/archive/blogs/davidnotario/jit-optimizations-inlining-i)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T19:46:42.037

有关内联的定义和讨论，[请参阅此问题](https://stackoverflow.com/questions/132738/why-should-i-ever-use-inline-code)。

在 C# 中，您不需要指示编译器或运行时内联，因为运行时会自动执行此操作。

PS这个答案对于Java也是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T19:50:39.860

内联是指不调用特定函数，而是直接在调用站点完成函数的内容。这样做的主要原因是它通过在调用点运行函数内容来消除调用函数的开销。

它被用作一种优化技术。对于 C#，它实际上依赖于 CLR JIT 引擎来完成这项工作。在运行时，编译方法时，JIT 引擎将使用启发式方法来确定内联函数是否合适并且是有效的优化。如果是这样，则执行内联。

Vance 有一篇关于 JIT 在内联时考虑的好文章：http: [//blogs.msdn.com/vancem/archive/2008/08/19/to-inline-or-not-to-inline-that-is-the -问题.aspx](http://blogs.msdn.com/vancem/archive/2008/08/19/to-inline-or-not-to-inline-that-is-the-question.aspx)

没有办法在 C# 中强制内联。该语言不支持这种结构。主要是因为人们对应该优化什么的判断力很差。JITer 是一个更好的判断者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T20:14:28.943

引用埃里克·冈纳森的话

[内联发生在 JIT 级别，而 JIT 通常会做出正确的决定](http://blogs.msdn.com/ericgu/archive/2004/01/29/64644.aspx)

# c# - 如何列出在 Windows 中运行的所有进程？

> ID：648410
> 
> 赞同：45
> 
> 时间：2009-03-15T19:44:54.880
> 
> 标签：c#, .net, pid, diagnostics

我想找到一种方法来遍历所有活动进程并对它们进行诊断检查（内存使用情况、cpu 时间等），有点类似于任务管理器。

问题分为两部分：

1.  查找所有进程
2.  查找有关它们的诊断属性

我什至不确定要在哪个名称空间中查找它。任何帮助/提示/链接都将不胜感激。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-03-15T19:47:11.350

**查找所有进程**

您可以通过 Process 类执行此操作

```
using System.Diagnostics;
...
var allProcesses = Process.GetProcesses(); 
```

**运行诊断**

你能在这里给我们更多的信息吗？目前还不清楚你想做什么。

Process 类提供了一些信息，尽管这可能会对您有所帮助。可以查询这个类

*   所有线程
*   主窗口句柄
*   所有加载的模块
*   有关内存的各种诊断信息（分页、虚拟、工作集等......）
*   基本进程信息（id、名称、磁盘位置）

**编辑**

OP 提到他们想要获取内存和 CPU 信息。这些属性在 Process 类中很容易获得（由 GetProcesses() 返回）。下面是列出所有受支持属性的 MSDN 页面。有多种内存和 CPU 可供选择，以满足您的需求。

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)

**代码：**

将此行添加到您的使用列表中：

```
using System.Diagnostics; 
```

现在您可以使用 Process.GetProcesses() 方法获取进程列表，如下例所示：

```
Process[] processlist = Process.GetProcesses();

foreach (Process theprocess in processlist)
{
    Console.WriteLine("Process: {0} ID: {1}", theprocess.ProcessName, theprocess.Id);
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-15T19:56:24.497

查找所有进程实际上相当容易：

```
using System.Diagnostics;

Process[] processes = Process.GetProcesses();

foreach (Process process in processes)
{
    // Get whatever attribute for process.
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-15T19:59:30.773

JaredPar 已经指出了`Process`该类，所以我将补充一点，您应该知道，该类会在创建实例时获取进程信息的快照。这不是实时取景。要更新它，您必须调用`Refresh()`实例。

还要记住，当您检查它时，该进程可能会关闭，因此请准备好捕获异常并相应地处理它们。

最后，如果您致电`Process.GetProcesses()`，您还将获得伪进程“空闲”和“系统”。IIRC 它们具有特定的进程 ID，因此您可以轻松地将它们过滤掉。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-09-22T20:11:24.393

这是我更喜欢访问进程的方式：

```
static void Main(string[] args)
{
    Process.GetProcesses().ToList().ForEach(p =>
    {
        Console.WriteLine(
            p.ProcessName + " p.Threads.Count=" + p.Threads.Count + " Id=" + p.Id);
    });

    Console.ReadKey();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T19:48:53.030

您使用什么操作系统？我从你的 C# 标签中得到它是 windows 吗？

如果是这样，请查看 WMI，尤其是 Win32_Process 类。这是 MSDN 参考： http: [//msdn.microsoft.com/en-us/library/aa394372 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa394372(VS.85).aspx)

以及这里的几个使用场景（例如获取进程列表）：http: [//msdn.microsoft.com/en-us/library/aa394599 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa394599(VS.85).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T21:30:55.297

那么你可以在powershell中做到这一点

1.查找所有进程

```
get-Process 
```

2.查找有关它们的诊断属性

```
get-Process | where-object { $_.Handles -gt 200 } 
```

上面的代码将返回超过 200 个句柄的所有进程，您可以通过这种方式轻松指定诊断属性。

有关[如何使用 powershell 处理进程的更多信息，请参阅此](http://computerperformance.co.uk/powershell/powershell_process.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-22T12:41:22.280

```
using System.Diagnostics;

class Program
{
   static void Main()
   {   
      Process[] processlist = Process.GetProcesses();`          
   }
} 
```

这里的进程数组包含所有存在于其中的进程数。

# asp.net-mvc - ASP.NET MVC 母版页代码文件

> ID：648423
> 
> 赞同：0
> 
> 时间：2009-03-15T19:53:56.263
> 
> 标签：asp.net-mvc

请任何人指出此代码可能出错的地方。我正在尝试为母版页创建一个部分类。

母版页类：

```
namespace MuniWeb.Models.SiteMaster{

public class BaseViewData
{
    public string Title { get; set; }
    public string MetaKeywords { get; set; }
    public string MetaDescription { get; set; }
}

public partial class Site : System.Web.Mvc.ViewMasterPage<MuniWeb.Models.SiteMaster.BaseViewData>
{
    public Site()
    {
        ViewData.Model = new BaseViewData();
    }
}} 
```

母版页：

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage<MuniWeb.Models.SiteMaster.BaseViewData>" %> 
```

错误：

```
Object reference not set to an instance of an object.
Line 33:             <div id="footer">
Line 34:                 ApplicationID:
Line 35:                 <%= Model.Title %>
Line 36:             </div>
Line 37:         </div> 
```

我只是以此为例。我要使用的代码需要为每个页面触发以检查某些参数，这就是它在母版页中的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-15T20:53:48.600

您不需要制作部分课程。您的控制器操作代码是什么样的？该错误看起来可能是因为没有将视图（因此它是母版页）交给模型。

尝试这样的事情：

```
namespace MuniWeb.Website.ViewDataModels {

    public class BaseViewData
    {
        public string Title { get; set; }
        public string MetaKeywords { get; set; }
        public string MetaDescription { get; set; }
    }

    public class SubViewData : BaseViewData
    {
        public IList<Thing> Things { get; set; }
    }
} 
```

然后像以前一样定义母版页：

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage<MuniWeb.Website.ViewDataModels.BaseViewData>" %> 
```

现在在你的控制器中

```
public ActionResult Index()
{
    SubViewData viewData = new SubViewData();
    viewData.Title = "Page Title";
    viewData.MetaKeywords = "This, that, and the other";
    viewData.MetaDescription = "A really great page about this, that, and the other.";

    viewData.Things = _myRepository.GetThings();

    return View(viewData);
} 
```

看看情况如何...

我会问为什么 MasterPage 需要强类型 ViewData。我知道是的，有时在母版页中需要强类型的视图数据，但通常你应该能够只使用 ViewData 名称值集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T03:48:09.790

您的母版页不应该继承 Site 而不是 System.Web.Mvc.ViewMasterPage？您的母版页定义实际上没有在哪里引用 Site 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T04:08:37.293

在您的代码中，

```
public partial class Site :  
         System.Web.Mvc.ViewMasterPage<MuniWeb.Models.SiteMaster.BaseViewData>
{
    public Site()
    {
        ViewData.Model = new BaseViewData();
    }
}} 
```

`ViewData.Model = new BaseViewData();`没有必要。`BaseViewData`应该通过控制器传入。换句话说，您的所有视图都应该寻找继承基础视图的视图。母版页将具有与基类相同的对象`BaseViewData`。您的控制器代码似乎是正确的。

似乎与我的类似代码不同的另一件事是*Inherits* =`System.Web.Mvc.ViewMasterPage<MuniWeb.Models.SiteMaster.BaseViewData>`应该是*Inherits* = `my.codebehind.class`，然后您的代码隐藏将继承`ViewMasterPage<MuniWeb.Models.SiteMaster.BaseViewData>`。

我只是没有看到这样的代码，也许它有效？

# latex - 在 LaTeX 中排版音乐

> ID：648429
> 
> 赞同：38
> 
> 时间：2009-03-15T19:57:19.673
> 
> 标签：latex

我将不胜感激在 LaTeX 中排版音乐的任何帮助。我曾尝试使用[MusiXTeX](http://icking-music-archive.org/software/indexmt6.html)，但非常沮丧。

据我了解，MusiXTeX 符号的学习曲线很陡峭，但我可以接受；该符号似乎有据可查。最困难的部分是安装并让一个简单的“hello world”示例工作。

我不致力于MusiXTeX；我会尝试任何适用于 LaTeX 的东西。但是我尝试了其他替代方案，并且对它们同样感到沮丧。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-15T20:05:19.857

[百合池](http://lilypond.org/web/)怎么样？它使用自己的明文表示法，但使用 TeX 进行输出。引擎本身使用一整套措施来分析音乐并制作漂亮的乐谱，因此它的自动化程度比 MusixTex 大得多。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-15T20:54:54.620

[Lilypond 有一个预处理器](http://lilypond.org/doc/v2.12/Documentation/user/lilypond-program/LaTeX)，`lilypond-book`可以让你在一个源文件中混合 LaTeX 代码和 Lilypond 代码。

示例用法：tsst.lytex 包含以下内容：

```
\documentclass{article}
\begin{document}
\begin[quote,fragment,staffsize=26]{lilypond}
c' d' e'
\end{lilypond}
\end{document} 
```

它还支持内联符号（而不是显示）和从外部文件读取。

使用 编译它`lilypond-book --pdf tsst.lytex`，生成每个系统的 pdf 图像以及`tsst.tex`包含片段的 LaTeX 文件，该文件通常使用`pdflatex`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-17T15:56:56.423

如果您有简单的符号（民谣等），那么[ABC](http://abcnotation.com/software.html)之类的可能很合适。简单的基于标记的符号，但打印到 LaTeX。维基百科有一个[很好的例子](http://en.wikipedia.org/wiki/Abc_notation)

```
X:1
T:The Legacy Jig
M:6/8
L:1/8
R:jig
K:G
GFG BAB | gfg gab | GFG BAB | d2A AFD |
GFG BAB | gfg gab | age edB |1 dBA AFD :|2 dBA ABd |:
efe edB | dBA ABd | efe edB | gdB ABd |
efe edB | d2d def | gfe edB |1 dBA ABd :|2 dBA AFD |] 
```

哪个生产

[ABC 示例 png http://en.wikipedia.org/wiki/File:Legacy_jig.png](http://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Legacy_jig.png/700px-Legacy_jig.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-06T23:25:22.683

还有[lyluatex](https://github.com/jperon/lyluatex/blob/master/README.en.md)，它使用[lualatex](http://www.luatex.org/)。

示例用法：（用 编译`lualatex -shell-escape DOCUMENT.TEX`）

```
\usepackage{lyluatex}

% include file
\lilypondfile[staffsize=17]{PATH/TO/THE/FILE}

% direct input
\begin{lilypond}
\relative c' { c d e f g a b c }
\end{lilypond}

% short direct input
\lilypond[staffsize=12]{c' d' g'} 
```

# linux - 恢复格式化的分区

> ID：648437
> 
> 赞同：-2
> 
> 时间：2009-03-15T19:59:34.987
> 
> 标签：linux, data-recovery

我不小心在我的 ext3 分区（适用于 Ubuntu）上的 qtparted 中点击了“格式”，我正在通过另一台计算机进行分析。它在格式化过程中给出的四个消息列表包括“写入 inode 表”和“写入文件系统”或类似的东西。

如何查看这些数据？我看过的工具似乎要么需要完整的 inode 表，要么在文件雕刻器的情况下，不保留目录结构（这可能是不可能的）并且在非常有限的一组文件类型上运行。这些数据可以恢复吗？格式化操作花费的时间太短了，我怀疑数据可能仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T20:44:10.653

查看[TestDisk](http://www.cgsecurity.org/wiki/TestDisk)实用程序。它们正是为此目的而设计的，在[分配表](http://en.wikipedia.org/wiki/File_Allocation_Table)丢失/覆盖时恢复数据。

如果您从那以后就没有使用过该磁盘，并且在格式化过程中它没有被彻底覆盖，那么您很有可能会取回大量数据。只是不要相信它的有效性（恢复的文件可能在任何位置都有错误或丢失的数据）。

# continuous-integration - 持续集成和处理项目引用

> ID：648443
> 
> 赞同：1
> 
> 时间：2009-03-15T20:01:58.727
> 
> 标签：continuous-integration

我已决定开始使用 Team City 作为我的持续集成软件，但我遇到了一些问题，我应该如何处理我的项目引用，因为我的项目所依赖的程序集位于我的开发人员解决方案和团队城市中的解决方案中的不同位置（我我正在使用 vs2008 解决方案文件选项进行团队城市的构建）。问题是项目在开发中建立，在团队城市中失败。

我应该如何处理项目文件中的不同项目引用？

前任。我的 MVC 应用程序也引用了我在其他项目中使用的通用 util 程序集。在我的开发人员解决方案中，我将此项目添加到解决方案中，但我不希望在团队城市构建中使用它，因此我在那里有一个不同的解决方案文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T20:13:01.803

听起来您应该将代码拆分为多个解决方案。当一个解决方案中的项目需要从另一个解决方案中的项目访问二进制文件时，他们不应该*将*那些外部项目添加到解决方案中。不要使用项目引用，而是使用文件引用。

这意味着您需要将已完成构建的结果部署到某个公共位置，可能是共享位置。

请参阅[模式和实践：Visual Studio 2005 Team System Guidance](http://www.codeplex.com/VSTSGuidance)。它适用于 TFS 和 2005，但一般概念适用于许多其他源代码控制系统。

# entity-framework - SQL Server Compact 不支持服务器生成的键和服务器生成的值

> ID：648449
> 
> 赞同：35
> 
> 时间：2009-03-15T20:05:26.360
> 
> 标签：entity-framework, compact-framework

我刚开始使用实体框架，所以我决定将它连接到我现有的 SQL Server CE 数据库。我有一个带有 IDENTITY(1, 1) 主键的表，但是当我尝试添加实体时，出现上述错误。

从[MS Technet 文章中](http://technet.microsoft.com/en-us/library/cc835494.aspx) 我了解到

> SQL Server Compact 在与实体框架一起使用时不支持具有服务器生成的键或值的实体。使用实体框架时，实体的密钥可能会被标记为服务器生成。这使数据库能够在插入或实体创建时为键生成一个值。此外，可以将实体的零个或多个属性标记为服务器生成的值。有关详细信息，请参阅实体框架文档中的存储生成的模式主题。SQL Server Compact 在与实体框架一起使用时不支持具有服务器生成的键或值的实体，尽管实体框架允许您使用服务器生成的键或值来定义实体类型。对具有服务器生成值的实体进行的数据操作操作会引发“不支持”异常。

所以现在我有几个问题：

*   如果不支持密钥并且会引发异常，为什么要将密钥标记为服务器生成？从引用的段落中很难理解。
*   当我尝试将 StoreGeneratedPattern="Identity" 添加到我的实体属性时，Studio 抱怨说这是不允许的。我做错了什么？
*   这种限制的最佳解决方法是什么（包括切换到另一个数据库）？我的限制是零安装和使用实体框架。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-15T20:40:33.093

当我达到这个限制时，我将类型更改为 uniqueidentifier

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-23T06:04:15.990

使用 uniqueidentifier 或手动生成 bigint/int 键值是您的最佳选择。

像这样的东西也许...

```
 private static object lockObject = new object();

    private static long nextID = -1;

    public static long GetNextID()
    {
        lock (lockObject)
        {
            if (nextID == -1) nextID = DateTime.UtcNow.Ticks; else nextID++;
            return nextID;
        }
    } 
```

这假设您在应用程序运行期间每次滴答生成的记录不超过一条（加上停止和重新启动的时间）。我相信这是一个合理的假设，但是如果您想要一个完全防弹（但更复杂）的解决方案，请从数据库中读取最高 ID 并从中递增。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-10-03T00:25:34.750

SQL CE 4.0 版通过其实体框架提供程序解决了这个问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-09T00:58:32.577

我也遇到了这个问题...大多数技术的答案可能是最好的选择，GUID 非常易于使用，并且密钥冲突的风险非常低（尽管并非不存在）。

> *   如果不支持密钥并且会引发异常，为什么要将密钥标记为服务器生成？从引用的段落中很难理解。

因为 SQL Server（不是 Compact）支持它，而其他第三方也可能支持它......实体框架不仅适用于 SQL Server Compact；）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-05-11T22:34:18.373

就我而言，我所有的课程都有名为“ID”的主键

我创建了一个界面

```
public class IID
{
    public Int32 ID { get; set; }
} 
```

然后我创建一个扩展方法

```
public static Int32 GetNextID<T>(this ObjectSet<T> objects)
    where T : class, IID
    {
        T entry = objects.OrderByDescending(u => u.ID).FirstOrDefault();
        if (entry == default(T))
            return 1;
        return entry.ID + 1;
    } 
```

然后，当我需要一个新 ID 时，我就这样做：

```
MyObject myobj = new MyObject();
myobj.ID = entities.MyTable.GetNextID(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-12-23T16:20:55.167

另一种选择是在具有标识列的表上使用 SqlCeResultSet。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-07T02:21:32.810

我有一个名为 ID 的主键，数据类型为 INT32，并且有标识列

就这样做

我的实体实体 = 新的我的实体（）；

字符串命令；

command = "插入消息(Created,Message,MsgType)values('12/1/2014','Hello World',5); Entity.ExecuteStoreCommand(command);

-- 排除插入语句中的主键

-- 由于 SQLCE 不支持系统生成的密钥

--不要使用 LINQ，因为它为具有 INT 数据类型的主键提供默认值 0

# sql-server - 刷新 SQL 数据库连接

> ID：648450
> 
> 赞同：0
> 
> 时间：2009-03-15T20:05:59.683
> 
> 标签：sql-server, vb.net

如何在 VB 应用程序中刷新与 SQL Server 2005 的数据库连接，以便每当 SQL 中的数据发生更改时，应用程序都会接收到这些更改？目前，该应用程序仅在重新启动后才获取更改，这不是我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T20:10:04.867

您不需要“刷新”数据库连接。如果您的应用程序仅在重新启动后才获取更改，那么您的事务处理有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T20:11:23.787

您可能没有将您的 chanes 提交给数据库。或者不再运行查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T21:34:42.277

你的意思是你想让你的程序中的数据随着sqlserver中数据的变化而自动更新吗？我不认为你能做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T21:38:04.033

我将首先查找设置事务隔离级别的命令

```
   例如“*设置事务隔离级别 ...*”

```

这要么在代码中设置，要么从数据库中默认设置。确定应用程序在哪个隔离级别上运行以及这是否合适。

谷歌该命令或查看 SQL Server 联机丛书以获取更多详细信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T20:09:54.307

可能不是需要刷新的连接。您的代码中可能有一些东西在应用程序启动时查询一次数据，并且永远不会再次查询数据。你能发布你的代码和你想要做什么吗？

# php - mysqli 和准备好的语句有问题

> ID：648453
> 
> 赞同：1
> 
> 时间：2009-03-15T20:08:08.600
> 
> 标签：php, mysqli

我有以下函数，它总是返回 false。它甚至没有尝试执行该语句，我知道是因为我更改了 $query = "aldfjaf lkjfsk" 并且它没有为我返回错误。有什么建议么？

```
class Mysql {
private $conn;

function __construct() {
    $this->conn = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME) or 
                  die('There was a problem connecting to the database.');
}

function verify_Username_and_Pass($un, $pwd) {

    $query = "SELECT *
            FROM user_table
            WHERE login_username = ? AND login_password = ?";

    if($stmt = $this->conn->prepare($query)) {
        $stmt->bind_param('ss', $un, $pwd);
        $stmt->execute();

        if($stmt->fetch()) {
            $stmt->close();
            return true;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T20:31:56.157

你没有检查错误，试试这个：

```
if($stmt->execute()) {
 //code
}
else{
 die($stmt->error);
} 
```

或者：

```
if($stmt = $this->conn->prepare($query)){
 //code
}
else{
 die($this->conn->error);
} 
```

# algorithm - 有人可以帮我做算法作业吗？

> ID：648459
> 
> 赞同：0
> 
> 时间：2009-03-15T20:12:19.120
> 
> 标签：algorithm

我对老师提出的作为家庭作业的算法有点问题。它是这样的：

有很多这样的棍子：

4（使用的堆数）

11 7 5 4（棒的长度）

1 1 3 3（每根长度多少根）

我必须找出一种算法，通过合并它们来形成最少数量的棍子。上一个示例的解决方案是这样的：

15 3 (15(最佳总和) * 3(最小棒) = 45 = 11*1 + 7*1 + 5*3 + 4*3)

11 4

7 4 4

5 5 5

现在我不是要求你们解决这个问题，而是给我一条线索，我试图将其简化为“进行更改”问题，直到我不得不从剩下的部分中选择解决好问题。

所需的复杂性是指数级的，并且限制是：

1.  0 < 棒 < 100
2.  0 < max_sum_of_sticks < 1000

那么大家对此有什么想法吗？

非常感谢您的宝贵时间。

**关于最小数量的解释**：例如，如果我有一组棍子。要形成的总和是 80，我有很多解决方案：

1根80长

2根40长

4根长度为20的棍子，依此类推。

第一个是微不足道的，我们将其丢弃，对于剩余的解决方案，我必须测试我是否可以用我拥有的木棒组构建它们，因为选择的解决方案（例如 2*40）可能不是可靠的，因为我们有未使用的棍子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T20:24:32.557

这看起来很像[背包](http://en.wikipedia.org/wiki/Knapsack_problem)问题。

你也可以看看[Branch and bound](http://en.wikipedia.org/wiki/Branch_and_bound)，它是用于各种优化问题的通用算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T20:25:35.347

像朱利安一样，我不完全确定您的意思，但这听起来很像多个背包上的“背包问题”，并且是 NP 完全的。有许多不同的方法来接近它——从简单的启发式方法，如“首先使用大的东西”，到蚁群（遗传）优化。以及介于两者之间的几乎所有东西。

事实上，候选集的数量几乎和方法一样多......我想知道这个**问题**是否是 NP 完全的？;-p

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T21:41:43.633

注意：我在这个答案中称合并的棍子为“桩”。

当然，解总是“1”。把你所有的棍子合并成一大堆；你有*最佳总和*= 所有木棍的总长度和*最小桩*= 1。

现在，假设您想要 1 之后的下一个最小数字，有一些可行的选择。你会尝试 2*最小桩*吗？为什么不？4个呢？5?

假设你有两个候选者，3 和 5。（即*最优总和*=15，*最小堆*=3 和*最优总和*=9，*最小堆*=5）如果你知道你可以将你的棍子排列成 3 堆长度为 15，您是否需要检查 5 堆（以及它们的长度）？

所以，问题归结为找到你是否可以将你的棍子排列成长度为*n的**m*堆。

 *我敢肯定有很多关于这个问题的文献，但如果我是为了家庭作业而做的，我会从自己解决它开始。

*我会首先*尝试形成一堆长度*n*。然后尝试用剩余的木棍形成长度为*n的**m-1*堆......

 *使用这种方法要小心的是，您可能会形成**错误**在任何给定时间堆积，因此您需要一种回溯并尝试另一种组合的方法。例如，假设我们有这些棍子： 20 1 7 7 7 7 14 6 15 并试图形成 4 个长度为 21 的桩。这可以通过组合 (20 1) (7 7 7) (7 14) (6 15)，但如果你从 (14 6 1) 开始，没有任何解决方案可以为其余的木棍提供 3x21 堆。现在，我不确定这是否表明 4x21 不是答案。（答案实际上是 2x42。）如果是这样的话，如果你总是从较小的数字开始，你就不会遇到“错误”堆的问题，即在尝试 4x21 之前尝试 2x42。但是，不确定，我会编写代码，在放弃之前回溯并尝试所有不同的组合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T20:25:33.753

我不确定我是否理解这个问题。

*   我假设每个桩必须是相同的长度？也就是说，所有桩的长度总和必须相同？

*   我们这里有三堆。这三个是哪里来的？如果可以做2个桩，你会选择哪一个？例如，如果你只有六根 X 长的木棍，你会做三堆，每根两根棍子，还是两堆，每根三根？

我猜蛮力方法是：你试着做X桩。将所有排列/组合放在每一堆中，看看你是否最终得到相同的总长度。

如果你给每根棍子起唯一的名字会有帮助吗？在这种情况下，您有 11-1、7-1、5-1、5-2、5-3 等。

# sql - 建模客户 <--> 地址的最佳方法

> ID：648463
> 
> 赞同：21
> 
> 时间：2009-03-15T20:14:44.187
> 
> 标签：sql, database-design, orm, data-modeling

每个`Customer`人都有一个实际地址和一个可选的邮寄地址。您首选的建模方式是什么？

选项 1.`Customer`有外键`Address`

```
   客户（id、phys_address_id、mail_address_id）
   地址（id、街道、城市等）

```

选项2.`Customer`与 具有一对多关系`Address`，其中包含描述地址类型的字段

```
   客户ID）
   地址（id、customer_id、address_type、街道、城市等）

```

选项 3\. 地址信息被反规范化并存储在`Customer`

```
   客户（id、phys_street、phys_city 等 mail_street、mail_city 等）

```

我最重要的目标之一是简化对象关系映射，所以我倾向于第一种方法。你怎么认为？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-15T20:28:26.570

出于标准化的所有常见原因，我倾向于第一种方法。这种方法还可以更轻松地对邮件详细信息执行数据清理。

如果您可能要允许多个地址（邮件、住宅等）或希望能够使用生效日期，请考虑这种方法

```
   客户（id，phys_address_id）
   Cust_address_type（cust_id、mail_address_id、address_type、start_date、end_date）
   地址（id、街道、城市等）

```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-15T21:35:59.233

您可能需要考虑的一个重要事实（取决于您的问题领域）是人们更改地址，并且可能希望在地址更改之前让您知道；这对于公用事业公司、电信公司等来说当然是正确的。

在这种情况下，您需要有一种方法可以为客户存储多个具有有效期的地址，以便可以提前设置地址并在正确的位置自动切换。如果这是一个要求，那么 (2) 的变体是对其建模的唯一合理方法，例如

```
Customer (id, ...)
Address (id, customer_id, address_type, valid_from, valid_to) 
```

另一方面，如果您不需要满足这一点（并且您确定将来不会），那么（1）可能更易于管理，因为维护数据完整性要容易得多，因为没有问题确保只存在一个相同类型的地址，并且连接变得更简单，因为它们只在一个字段上。

因此，根据您是否需要搬家，（1）或（2）都可以，但我会避开（3），因为您随后会重复表中地址的定义，并且您如果您更改地址的外观，则必须添加多个列。它的性能可能略高一些，但老实说，当您在关系数据库中处理正确索引的联接时，并没有太多收获，而且在某些不需要地址的情况下它可能*会*变慢因为客户的记录大小会更大。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-12-22T18:32:06.867

我们正在推进这样的模型：

```
Person (id, given_name, family_name, title, suffix, birth_date)
Address (id, culture_id, line1, line2, city, state, zipCode, province, postalCode)
AddressType (id, descriptiveName)
PersonAddress (person_id, address_id, addressType_id, activeDates) 
```

大多数人可能认为这太过分了。然而，在我们开发的应用程序中，一个不可否认的共同主题是它们将拥有一些基本实体——人员、组织、地址、电话号码等——并且它们都希望以不同的方式组合它们。因此，我们正在预先建立一些泛化，我们 100% 确定我们有用例。

Address 表将遵循 table-per-hierarchy 继承方案，以根据文化区分地址；所以美国地址将有一个州和邮政编码字段，但加拿大地址将有一个省和邮政编码。

我们使用一个单独的连接表来“给”一个人一个地址。这使我们的其他实体 - 人员和地址 - 与其他实体没有联系，而我们的经验是这往往会使事情变得复杂。它还使得将地址实体连接到许多其他类型的实体（人员、组织等）以及与链接关联的不同上下文信息（如我的示例中的 activeDates）变得更加简单。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-15T20:20:00.273

第二种选择可能是我要走的路。并且如果它允许用户添加额外的地址'（如果你想让他们这样做），他们可以随意切换以进行运输等。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-15T20:23:11.403

我更喜欢#1。良好的规范化并清楚地传达意图。该模型还允许将*相同*的地址对象（行）用于两个地址，我发现这是非常有价值的。过多地重复这些信息太容易迷失方向。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-15T21:36:55.550

在回答这类问题时，我喜欢使用[DDD](http://en.wikipedia.org/wiki/Domain-driven_design)的分类。如果它是一个实体，它应该有一个单独的 ID，如果它是一个值对象，它不应该。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-15T21:04:12.600

选项 3 限制性太强，选项 1 不能扩展以允许其他地址类型而不更改架构。选项 2 显然是最灵活的，因此也是最佳选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-15T22:47:03.710

在我现在编写的大多数代码中，每个客户都有一个且只有一个物理位置。这是我们的业务合作伙伴的法人实体。因此，我将街道、城市等放在客户对象/表中。通常这是可行的最简单的事情，并且可行。

当需要额外的邮寄地址时，我将其放在单独的对象/表格中，以免客户对象过于混乱。

在我职业生涯的早期，我疯狂地规范了一个订单，该订单引用了一个引用了送货地址的客户。这使事情变得“干净”，但使用起来又慢又不雅。现在我使用一个只包含所有地址信息的订单对象。我实际上认为这更自然，因为客户可能会更改他的（默认？）地址，但 2007 年发送的货件地址应该始终保持不变——即使客户在 2008 年搬家。

我们目前在 out 项目中实现了[VerySimpleAddressProtocol](http://github.com/hudora/huTools/blob/master/doc/standards/address_protocol.markdown#readme)以标准化使用的字段。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-15T20:25:38.277

我会选择第一个选项。在这些情况下，我对 YAGNI 感到非常厌倦（你不会需要它）。我数不清有多少次我查看过具有一对多表“只是以防万一”多年的模式。如果您只需要两个，只需使用第一个选项；如果将来需求发生变化，那么就改变它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-15T20:56:14.447

就像在许多情况下一样：**这取决于。**

如果您的客户处理多个地址，那么一对多关系将是合适的。您可以在地址上引入一个标志，表明地址是否用于发货或账单等。或者您将不同的地址类型存储在不同的表中，并在客户上具有多对一的关系。

在您只需要知道客户的一个地址的情况下，您为什么要对多对数进行建模？一对一的关系将满足您的需求。

重要提示：仅在遇到性能问题时才进行非规范化。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-15T21:19:49.303

我会选择选项 1。如果你愿意，你甚至可以稍微修改它以保留地址历史记录：

```
Customer   (id, phys_address_id, mail_address_id)
Address    (id, customer_id, start_dt, end_dt, street, city, etc.) 
```

如果地址发生变化，只需结束当前地址的日期并在`Address`表中添加一条新记录。和`phys_address_id`总是`mail_address_id`指向当前地址。

这样，您可以保留地址历史记录，您可以在数据库中存储多个邮寄地址（默认为），如果实际地址和`mail_address_id`邮寄地址相同，您只需指向同一记录。`phys_address_id``mail_address_id`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-02-27T12:41:03.947

好线。我花了一段时间考虑最合适的模式，并得出结论，quentin-starin 的解决方案是最好的，除了我在他的 PersonAddress 表中添加了**start_date**和**end_date字段。**我还决定添加**注释**，**激活**和**删除**。

**deleted**用于软删除功能，因为我想我不想仅仅通过从联结表中删除记录来丢失以前地址的踪迹。我认为这是非常明智的，其他人可能想考虑一下。如果不这样做，则可能需要修改纸质或电子文档以尝试追踪地址信息（最好避免这样做）。

**笔记**我认为这是一种要求，但这可能只是偏好。我花时间在回填练习中验证数据库中的地址，有些地址可能非常模糊（例如农村地址），我认为至少允许在记录地址中保存有关该地址的注释非常有用。

我想听听意见的一件事是**地址的唯一索引**表（再次，在 quentin-starin 的示例中引用同名表。您认为应该强制执行唯一索引吗（作为可能跨所有非空/必需字段的复合索引）？这似乎是明智的，但可能仍然很难阻止重复数据，因为邮政/邮政编码并不总是对单个属性唯一。即使国家，省和城市字段是从参考数据（它们在我的模型中）填充的，拼写差异地址行可能不匹配。最好避免这种情况的唯一方法可能是从传入的表单字段运行一个或多个 DB 查询，以查看是否找到了可能的重复项。另一种安全措施是为用户提供从已链接到该人的数据库中的地址中选择并使用该地址进行自动填充的选项。我认为这可能是一种情况，您只能明智并采取预防措施来停止重复，但只需接受它迟早会（并且可能会）发生。

对我来说，另一个非常重要的方面是将来编辑**地址**表记录。假设您有 2 个人都列在：-

11 随便街 随便城市 Z1P C0D3

**允许将相同的地址**表记录分配给不同的实体（个人、公司）是否不应该被认为是危险的？然后假设用户意识到其中一个人住在 111 What Street 并且有一个错字。如果您更改该地址，它将同时更改两个实体的地址。我想避免这种情况。我的建议是让 MVC 中的模型（在我的例子中是 PHP Yii2）在创建已知与该客户相关的新地址时查找现有**地址**记录（SELECT * FROM address INNER JOIN personaddress ON personaddress.address_id = address.id WHERE personaddress.person_id = {当前正在编辑的人员 ID}）并为用户提供使用该记录的选项（正如上面所建议的）。

我觉得将同一个地址链接到多个不同的实体只是自找麻烦，因为这可能是拒绝稍后编辑**地址**记录（不切实际）或冒着将来编辑记录可能会损坏与外部其他实体相关的数据的风​​险正在编辑**地址**记录的人。

我很想听听人们的想法。

# c++ - 为什么 g++ 编译这个？

> ID：648464
> 
> 赞同：0
> 
> 时间：2009-03-15T20:15:54.543
> 
> 标签：c++, compiler-construction, syntax, segmentation-fault

最近很累，写了如下代码：

```
GLfloat* array = new GLfloat(x * y * z); 
```

其中，当然应该是：

```
GLfloat* array = new GLfloat[x * y * z]; 
```

（注意方括号而不是括号。）

据我所知，第一种形式无效，但 g++ 编译了它。当然，它吐出了一个完全无法理解的段错误，但它编译了。

为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-15T20:17:18.173

```
GLfloat* array = new GLfloat(x * y * z); 
```

创建一个指针，该指针指向一个值为 的`array`类型的对象。`GLfloat``x * y * z`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-15T20:18:12.227

好吧，结果`new T()`是 a `T*`，所以`new GLFloat`会返回一个 GLFloat*。只要`x*y*z`传递给 GLFloat 构造函数是有效的，它就是有效的代码。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-15T20:18:35.957

这与以下内容相同：

```
int * p = new int(42); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T20:18:09.763

嗯，第一个表达式是一个指向值为 (x *y* z) 的 GLfloat 的指针，这是完全合法的。

# java - 在 Java 中合并两个 XML 文件

> ID：648471
> 
> 赞同：15
> 
> 时间：2009-03-15T20:19:47.293
> 
> 标签：java, xml, api, parsing

我有两个结构相似的 XML 文件，我希望将它们合并到一个文件中。目前我正在使用本教程中遇到的[EL4J XML Merge 。](http://www.javaworld.com/javaworld/jw-07-2007/jw-07-xmlmerge.html?page=1)但是它并没有像我期望的那样合并，例如主要问题是它没有将两个文件中的合并到一个元素中，即包含 1、2、3 和 4 的元素。相反，它只是丢弃 1 和 2 或 3 和 4取决于首先合并哪个文件。

因此，我将感谢任何有 XML Merge 经验的人，如果他们能告诉我我可能做错了什么，或者是否有人知道一个好的 Java XML API 能够根据我的需要合并文件？

非常感谢您提前提供的帮助

编辑：

真的可以用一些好的建议来做这件事，所以增加了赏金。我已经尝试过 jdigital 的建议，但仍然遇到 XML 合并问题。

下面是我尝试合并的 XML 文件结构类型的示例。

```
<run xmloutputversion="1.02">
    <info type="a" />
    <debugging level="0" />
    <host starttime="1237144741" endtime="1237144751">
        <status state="up" reason="somereason"/>
        <something avalue="test" test="alpha" />
        <target>
            <system name="computer" />
        </target>
        <results>
            <result id="1">
                <state value="test" />
                <service value="gamma" />
            </result>
            <result id="2">
                <state value="test4" />
                <service value="gamma4" />
            </result>
        </results>
        <times something="0" />
    </host>
    <runstats>
        <finished time="1237144751" timestr="Sun Mar 15 19:19:11 2009"/>
        <result total="0" />
    </runstats>
</run>

<run xmloutputversion="1.02">
    <info type="b" />
    <debugging level="0" />
    <host starttime="1237144741" endtime="1237144751">
        <status state="down" reason="somereason"/>
        <something avalue="test" test="alpha" />
        <target>
            <system name="computer" />
        </target>
        <results>
            <result id="3">
                <state value="testagain" />
                <service value="gamma2" />
            </result>
            <result id="4">
                <state value="testagain4" />
                <service value="gamma4" />
            </result>
        </results>
        <times something="0" />
    </host>
    <runstats>
        <finished time="1237144751" timestr="Sun Mar 15 19:19:11 2009"/>
        <result total="0" />
    </runstats>
</run> 
```

预期产出

```
<run xmloutputversion="1.02">
    <info type="a" />
    <debugging level="0" />
    <host starttime="1237144741" endtime="1237144751">
        <status state="down" reason="somereason"/>
        <status state="up" reason="somereason"/>
        <something avalue="test" test="alpha" />
        <target>
            <system name="computer" />
        </target>
        <results>
            <result id="1">
                <state value="test" />
                <service value="gamma" />
            </result>
            <result id="2">
                <state value="test4" />
                <service value="gamma4" />
            </result>
            <result id="3">
                <state value="testagain" />
                <service value="gamma2" />
            </result>
            <result id="4">
                <state value="testagain4" />
                <service value="gamma4" />
            </result>
        </results>
        <times something="0" />
    </host>
    <runstats>
        <finished time="1237144751" timestr="Sun Mar 15 19:19:11 2009"/>
        <result total="0" />
    </runstats>
</run> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-30T20:11:22.013

不是很优雅，但是您可以使用 DOM 解析器和 XPath 来做到这一点：

```
public class MergeXmlDemo {

  public static void main(String[] args) throws Exception {
    // proper error/exception handling omitted for brevity
    File file1 = new File("merge1.xml");
    File file2 = new File("merge2.xml");
    Document doc = merge("/run/host/results", file1, file2);
    print(doc);
  }

  private static Document merge(String expression,
      File... files) throws Exception {
    XPathFactory xPathFactory = XPathFactory.newInstance();
    XPath xpath = xPathFactory.newXPath();
    XPathExpression compiledExpression = xpath
        .compile(expression);
    return merge(compiledExpression, files);
  }

  private static Document merge(XPathExpression expression,
      File... files) throws Exception {
    DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory
        .newInstance();
    docBuilderFactory
        .setIgnoringElementContentWhitespace(true);
    DocumentBuilder docBuilder = docBuilderFactory
        .newDocumentBuilder();
    Document base = docBuilder.parse(files[0]);

    Node results = (Node) expression.evaluate(base,
        XPathConstants.NODE);
    if (results == null) {
      throw new IOException(files[0]
          + ": expression does not evaluate to node");
    }

    for (int i = 1; i < files.length; i++) {
      Document merge = docBuilder.parse(files[i]);
      Node nextResults = (Node) expression.evaluate(merge,
          XPathConstants.NODE);
      while (nextResults.hasChildNodes()) {
        Node kid = nextResults.getFirstChild();
        nextResults.removeChild(kid);
        kid = base.importNode(kid, true);
        results.appendChild(kid);
      }
    }

    return base;
  }

  private static void print(Document doc) throws Exception {
    TransformerFactory transformerFactory = TransformerFactory
        .newInstance();
    Transformer transformer = transformerFactory
        .newTransformer();
    DOMSource source = new DOMSource(doc);
    Result result = new StreamResult(System.out);
    transformer.transform(source, result);
  }

} 
```

这假设您可以同时在 RAM 中保存至少两个文档。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-04-18T17:04:21.090

我使用 XSLT 来合并 XML 文件。它允许我调整合并操作以将内容拼凑在一起或在特定级别合并。它需要更多的工作（并且 XSLT 语法有点特殊）但超级灵活。你需要的一些东西在这里

a) 包含一个附加文件 b) 1:1 复制原始文件 c) 设计合并点，带或不带重复避免

a) 一开始我有

```
<xsl:param name="mDocName">yoursecondfile.xml</xsl:param>
<xsl:variable name="mDoc" select="document($mDocName)" /> 
```

这允许使用 $mDoc 指向第二个文件

b) 1:1 复制源代码树的说明是 2 个模板：

```
<!-- Copy everything including attributes as default action -->
<xsl:template match="*">
    <xsl:element name="{name()}">
         <xsl:apply-templates select="@*" />
        <xsl:apply-templates />
    </xsl:element>
</xsl:template>

<xsl:template match="@*">
    <xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>
</xsl:template> 
```

没有其他任何东西，您将获得第一个源文件的 1:1 副本。适用于任何类型的 XML。合并部分是文件特定的。假设您有具有事件 ID 属性的事件元素。您不希望有重复的 ID。模板如下所示：

```
 <xsl:template match="events">
    <xsl:variable name="allEvents" select="descendant::*" />
    <events>
        <!-- copies all events from the first file -->
        <xsl:apply-templates />
        <!-- Merge the new events in. You need to adjust the select clause -->
        <xsl:for-each select="$mDoc/logbook/server/events/event">
            <xsl:variable name="curID" select="@id" />
            <xsl:if test="not ($allEvents[@id=$curID]/@id = $curID)">
                <xsl:element name="event">
                    <xsl:apply-templates select="@*" />
                    <xsl:apply-templates />
                </xsl:element>
            </xsl:if>
        </xsl:for-each>
    </properties>
</xsl:template> 
```

当然，您可以比较标签名称等其他内容。合并的深度也取决于您。如果您没有要比较的键，则构造会变得更容易，例如日志：

```
 <xsl:template match="logs">
     <xsl:element name="logs">
          <xsl:apply-templates select="@*" />
          <xsl:apply-templates />
          <xsl:apply-templates select="$mDoc/logbook/server/logs/log" />
    </xsl:element> 
```

要在 Java 中运行 XSLT，请使用以下命令：

```
 Source xmlSource = new StreamSource(xmlFile);
    Source xsltSource = new StreamSource(xsltFile);
    Result xmlResult = new StreamResult(resultFile);
    TransformerFactory transFact = TransformerFactory.newInstance();
    Transformer trans = transFact.newTransformer(xsltSource);
    // Load Parameters if we have any
    if (ParameterMap != null) {
       for (Entry<String, String> curParam : ParameterMap.entrySet()) {
            trans.setParameter(curParam.getKey(), curParam.getValue());
       }
    }
    trans.transform(xmlSource, xmlResult); 
```

或者您下载[Saxon SAX Parser](http://saxon.sourceforge.net/)并从命令行执行（Linux shell 示例）：

```
#!/bin/bash
notify-send -t 500 -u low -i gtk-dialog-info "Transforming $1 with $2 into $3 ..."
# That's actually the only relevant line below
java -cp saxon9he.jar net.sf.saxon.Transform -t -s:$1 -xsl:$2 -o:$3
notify-send -t 1000 -u low -i gtk-dialog-info "Extraction into $3 done!" 
```

YMMV

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-14T16:47:54.443

感谢大家的建议，不幸的是，建议的方法最终都不是合适的，因为我需要对结构的不同节点合并的方式制定规则。

所以我所做的是获取与我正在合并的 XML 文件相关的 DTD，并从中创建许多反映结构的类。由此我使用[XStream](http://xstream.codehaus.org/)将 XML 文件反序列化回类。

通过这种方式，我注释了我的类，使其成为使用分配有注释和一些反射的规则组合的过程，以便合并对象而不是合并实际的 XML 结构。

如果有人对在这种情况下合并 Nmap XML 文件的代码感兴趣，请参阅[http://fluxnetworks.co.uk/NmapXMLMerge.tar.gz](http://fluxnetworks.co.uk/NmapXMLMerge.tar.gz)代码并不完美，我承认它不是非常灵活，但它确实有效。我计划重新实现系统，当我有空闲时间时，它会自动解析 DTD。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T23:47:15.850

如果您明确说明您有兴趣实现的结果，这可能会有所帮助。这是你要求的吗？

文件 A：

```
<root>
  <a/>
  <b>
    <c/>
  </b>
</root> 
```

文件 B：

```
<root>
  <d/>
</root> 
```

合并结果：

```
<root>
  <a/>
  <b>
    <c/>
  </b>
  <d/>
</root> 
```

您是否担心缩放大型文档？

在 Java 中实现这一点的最简单方法是使用流式 XML 解析器（google for 'java StAX'）。如果您使用 javax.xml.stream 库，您会发现 XMLEventWriter 有一个方便的方法 XMLEventWriter#add(XMLEvent)。您所要做的就是遍历每个文档中的顶级元素，并使用此方法将它们添加到您的编写器以生成合并结果。唯一时髦的部分是实现仅在顶级节点上考虑（仅调用“添加”）的阅读器逻辑。

如果您需要提示，我最近实现了此方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-17T12:38:53.097

这是使用 XML Merge 的样子：

```
action.default=MERGE

xpath.info=/run/info
action.info=PRESERVE

xpath.result=/run/host/results/result
action.result=MERGE
matcher.result=ID 
```

您必须为 //result 节点设置 ID 匹配器并为 //info 节点设置 PRESERVE 操作。还要注意 .properties XML Merge 使用区分大小写 - 您必须在 .properties 中使用“xpath”而不是“XPath”。

不要忘记像这样定义 -config 参数：

```
java -cp lib\xmlmerge-full.jar; ch.elca.el4j.services.xmlmerge.tool.XmlMergeTool -config xmlmerge.properties example1.xml example2.xml 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T22:52:54.743

我看了一下引用的链接；奇怪的是 XMLMerge 不能按预期工作。你的例子似乎很简单。您是否阅读了标题为[将 XPath 声明与 XmlMerge 一起使用](http://www.javaworld.com/javaworld/jw-07-2007/jw-07-xmlmerge.html?page=2)的部分？使用该示例，尝试为结果设置 XPath 并将其设置为合并。如果我正确阅读了文档，它看起来像这样：

```
XPath.resultsNode=results
action.resultsNode=MERGE 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T20:38:15.393

您也许可以编写一个 Java 应用程序，将 XML 文档反序列化为对象，然后以编程方式将各个对象“合并”到一个集合中。然后，您可以将集合对象序列化回 XML 文件，并将所有内容“合并”。

[JAXB](http://java.sun.com/developer/technicalArticles/WebServices/jaxb/) API 有一些工具可以将 XML 文档/模式转换为 java 类。“xjc”工具可能能够做到这一点，尽管我不记得是否可以直接从 XML 文档创建类，或者是否必须先生成模式。有一些工具可以从 XML 文档生成模式。

希望这会有所帮助...不确定这是否是您要找的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-01T06:32:44.490

您可以尝试使用[Dom4J](http://dom4j.org)，它提供了一种使用 XPath 查询提取信息的非常好的方法，并且还允许您非常轻松地编写 XML。您只需要使用 API 一段时间即可完成您的工作

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-27T02:54:27.053

除了使用 Stax（这确实有意义）之外，使用 StaxMate（[http://staxmate.codehaus.org/Tutorial](http://staxmate.codehaus.org/Tutorial)）可能会更容易。只需创建 2 个 SMInputCursors，如果需要，还可以创建子光标。然后是带有 2 个游标的典型合并排序。类似于以递归下降方式遍历 DOM 文档。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-31T16:40:15.333

那么，您只对合并“结果”元素感兴趣？其他一切都被忽略了吗？input0 有一个 <info type="a"/> 并且 input1 有一个 <info type="b"/> 并且预期结果有一个 <info type="a"/> 的事实似乎暗示了这一点。

如果您不担心缩放并且想快速解决这个问题，那么我建议您编写一段特定于问题的代码，使用像 JDOM 这样的简单库来考虑输入并编写输出结果。

尝试编写一个足够“智能”以处理所有可能的合并情况的通用工具将非常耗时 - 您必须公开配置功能来定义合并规则。如果您确切地知道您的数据将是什么样子并且您确切地知道需要如何执行合并，那么我想您的算法将遍历每个 XML 输入并写入单个 XML 输出。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-08-24T11:07:39.103

有时您只需将 XML 文件连接成一个，例如具有类似结构的文件，如下所示：

文件`xml1`：

```
<root>
    <level1>
        ...
    </level1>
    <!--many records-->
    <level1>
        ...
    </level1>
</root> 
```

文件`xml2`：

```
<root>
    <level1>
        ...
    </level1>
    <!--many records-->
    <level1>
        ...
    </level1>
</root> 
```

在这种情况下，使用`jdom2`库的下一个过程可以帮助您：

```
void concatXML(Path fSource,Path fDest) {
     Document jdomSource = null;
     Document jdomDest = null;
     List<Element> elems = new LinkedList<Element>();
     SAXBuilder jdomBuilder = new SAXBuilder();
     try {
         jdomSource  = jdomBuilder.build(fSource.toFile());
         jdomDest    = jdomBuilder.build(fDest.toFile());
         Element root = jdomDest.getRootElement();
         root.detach();
         String sourceNextElementName=((Element) jdomSource.getRootElement().getContent().get(1)).getName();
         for (Element record:jdomSource.getRootElement().getDescendants(new ElementFilter(sourceNextElementName)))
                elems.add(record);
            for (Element elem : elems) (elem).detach();
            root.addContent(elems);

            Document newDoc = new Document(root);
            XMLOutputter xmlOutput = new XMLOutputter();

            xmlOutput.output(newDoc, System.out);
            xmlOutput.setFormat(Format.getPrettyFormat());
            xmlOutput.output(newDoc, Files.newBufferedWriter(fDest, Charset.forName("UTF-8")));
        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

* * *

## 回答 #12

> 赞同：-6
> 
> 时间：2009-03-27T02:08:56.523

Have you considered just not bothering with parsing the XML "properly" and just treating the files as big long strings and using boring old things such as hash maps and regular expressions...? This could be one of those cases where the fancy acronyms with X in them just make the job fiddlier than it needs to be.

Obviously this does depend a bit on how much data you actually need to parse out while doing the merge. But by the sound of things, the answer to that is not much.

# python - 一个微不足道的 Python SWIG 错误问题

> ID：648482
> 
> 赞同：8
> 
> 时间：2009-03-15T20:27:49.460
> 
> 标签：python, swig

我正在尝试让 Python 与 swig 一起运行以执行 C/C++。我在[这里](http://www.swig.org/tutorial.html)运行教程，“构建 python 模块”。当我打电话时

```
gcc -c example.c example_wrap.c -I /my_correct_path/python2.5 
```

我收到一个错误：

```
my_correct_path/python2.5/pyport.h:761:2: error: #error "LONG_BIT definition appears wrong for platform (bad gcc/glibc config?)."
example_wrap.c: In function 'SWIG_Python_ConvertFunctionPtr':
example_wrap.c:2034: warning: initialization discards qualifiers from pointer target type
example_wrap.c: In function 'SWIG_Python_FixMethods':
example_wrap.c:3232: warning: initialization discards qualifiers from pointer target type 
```

它实际上确实创建了一个 example.o 文件，但它不起作用。我使用的是 python2.5 而不是示例中的 2.1，这是一个问题吗？错误（其他一切都只是一个“警告”）说明了错误的平台。这是一台 64 位机器；这是一个问题吗？我的 gcc 是否为我的机器配置错误？我该如何度过这个难关？

更新：我仍然有问题。我如何实际实施这个“修复”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-05-25T22:36:08.050

在 64 位 centos 上为 32 位 python 安装 python readline 时，我发现这个线程正在寻找相同“LONGBIT”错误的答案。该链接没有直接答案，因此我不得不进一步搜索答案（对于经验丰富的 linux 用户/开发人员来说，这可能是直截了当的）。为了将来参考，解决方案是通过在 CFLAGS 环境变量中使用“-m32”来强制 32 位。

```
bash-3.2$ easy_install readline
Searching for readline
Reading http://pypi.python.org/simple/readline/
Reading http://www.python.org/
Best match: readline 2.6.4
Downloading http://pypi.python.org/packages/source/r/readline/readline-2.6.4.tar.gz#md5=7568e8b78f383443ba57c9afec6f4285
Processing readline-2.6.4.tar.gz
Running readline-2.6.4/setup.py -q bdist_egg --dist-dir /tmp/easy_install-mqr9wH/readline-2.6.4/egg-dist-tmp-p3apfF
In file included from /usr/local/python2.6/include/python2.6/Python.h:58,
                 from Modules/readline.c:8:
/usr/local/python2.6/include/python2.6/pyport.h:685:2: error: #error "LONG_BIT definition appears wrong for platform (bad gcc/glibc config?)."
error: Setup script exited with error: command 'gcc' failed with exit status 1 
```

然后我尝试使用 CFLAGS=-m32：

```
bash-3.2$ CFLAGS=-m32 easy_install readline
Searching for readline
Reading http://pypi.python.org/simple/readline/
Reading http://www.python.org/
Best match: readline 2.6.4
Downloading http://pypi.python.org/packages/source/r/readline/readline-2.6.4.tar.gz#md5=7568e8b78f383443ba57c9afec6f4285
Processing readline-2.6.4.tar.gz
Running readline-2.6.4/setup.py -q bdist_egg --dist-dir /tmp/easy_install-uauVci/readline-2.6.4/egg-dist-tmp-YY0tQa
In file included from /usr/include/features.h:352,
                 from /usr/include/limits.h:27,
                 from /usr/lib/gcc/x86_64-redhat-linux/4.1.2/include/limits.h:122,
                 from /usr/lib/gcc/x86_64-redhat-linux/4.1.2/include/syslimits.h:7,
                 from /usr/lib/gcc/x86_64-redhat-linux/4.1.2/include/limits.h:11,
                 from /usr/local/python2.6/include/python2.6/Python.h:19,
                 from Modules/readline.c:8:
/usr/include/gnu/stubs.h:7:27: error: gnu/stubs-32.h: No such file or directory
error: Setup script exited with error: command 'gcc' failed with exit status 1 
```

最新的错误是由于没有 32 位的 glibc-devel 包（感谢[这个线程](http://gcc.gnu.org/ml/fortran/2008-09/msg00120.html)）。我还必须安装 ncurses-devel.i386 ，然后 easy_install 完成并且 ipython 识别了它。我的生活感觉被毁了，直到我为了 ipython 而工作。

```
bash-3.2$ CFLAGS=-m32 easy_install readline
Searching for readline
Reading http://pypi.python.org/simple/readline/
Reading http://www.python.org/
Best match: readline 2.6.4
Downloading http://pypi.python.org/packages/source/r/readline/readline-2.6.4.tar.gz#md5=7568e8b78f383443ba57c9afec6f4285
Processing readline-2.6.4.tar.gz
Running readline-2.6.4/setup.py -q bdist_egg --dist-dir /tmp/easy_install-dHly4D/readline-2.6.4/egg-dist-tmp-oIEDYl
Adding readline 2.6.4 to easy-install.pth file

Installed /home/hari/bin/python/lib/python2.6/site-packages/readline-2.6.4-py2.6-linux-x86_64.egg
Processing dependencies for readline
Finished processing dependencies for readline 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-30T22:09:36.083

我在尝试安装 Python 包时遇到了同样的错误，但已修复它。
“LONG_BIT”错误是：

```
$ easy_install astropy  
/my_path/epd/epd-7.3-2-rh5-x86/include/python2.7/pyport.h:849:2: 
error: #error "LONG_BIT definition appears wrong for platform 
(bad gcc/glibc config?)." error: Setup script exited with error: 
command 'gcc' failed with exit status 1 
```

正如你所建议的，Alex，我必须安装正确版本的 Python epd 以匹配我的机器和我想要安装的包的要求。有并行版本的 Python 正在运行，我认为这就是混乱和错误的来源。转到[Enthought 的存储库](https://www.enthought.com/products/epd/package-index/)（单击“登录到存储库”-> 安装程序）并安装正确的版本。

确保通过删除旧的 Python 版本来清理（或询问知道他们在做什么的人为您做这件事）。然后当然更改您的 .cshrc 路径以指向新版本并正确获取文件。我这样做后没有任何问题。

我意识到这个问题是 4 年前提出的！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-29T20:25:24.287

实际上，我发现这个线程两次，相隔几年，都是在尝试`libxml2`从源代码安装时。该库的`configure`脚本实际上有一个`--without-python`选项，我使用它而不是尝试修复错误。

# user-interface - 显示添加/删除列表元素的最佳动画

> ID：648492
> 
> 赞同：0
> 
> 时间：2009-03-15T20:32:19.057
> 
> 标签：user-interface, list, animation, usability

视觉传达元素已添加到项目列表或从项目列表中删除的最佳方式是什么？（我要的是可用性，而不是无缘无故的眼睛糖果）

1.  向上或向下滑动其他项目以显示新项目或隐藏已删除项目
2.  淡入或淡出项目，但不为其他项目设置动画
3.  #1 和 #2 的组合
4.  完全没有动画
5.  其他形式的动画

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T20:34:42.670

我认为通过渐进式（和缓慢）改变背景颜色的直接插入可以解决问题......我发现它对 SO 本身特别有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T21:11:50.787

*删除：*

如果您从列表中删除一个项目，您可以假设该项目是可见的（因为用户刚刚选择它进行删除），所以只需将其淡出（可能带有闪烁效果）。

*添加：*

如果将项目添加到列表中，则滚动不是一个好的选择，因为它不是用户直接启动的。他可能不得不滚动回去。那将是一种穿透性的行为。作为替代方案，只需在列表旁边显示一条闪烁的信息消息，表明已添加新项目。

# html - Internet Explorer 的未来

> ID：648497
> 
> 赞同：5
> 
> 时间：2009-03-15T20:36:02.997
> 
> 标签：html, internet-explorer, internet-explorer-8, browser, webbrowser-control

有传言说 IE8 将是微软最终发布的 IE（当我问[这个问题](http://stackoverflow.com/questions/635851/support-for-border-radius-in-ie)时，有人给我指[了一篇关于 Slashdot 的文章](http://tech.slashdot.org/article.pl?sid=09/03/10/1942232)——是的，我知道，它是 Slashdot，但它引用了 InfoWorld 上的一篇文章——无论如何，微软对 IE 的持续支持似乎存在一些合理的担忧，至少以目前的形式）。

他们对 HTML 渲染引擎的未来计划是什么？

微软显然没有在使当前的 Trident 引擎与 CSS3 兼容方面取得重大进展，所以我只是想知道他们是否正在寻找用下一代引擎替换它（我听说过代号“Triton”）或放弃它以支持竞争平台（例如 WebKit，正如 Reed Copsey 在他的回答中指出的那样）。

为什么要进行激进的投票？对于计划将 IE 用作嵌入式控件的任何人来说，这是一个合理的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T20:50:00.730

我见过的两个最常见的猜测是渲染引擎将被基于[Gazelle](http://research.microsoft.com/apps/pubs/default.aspx?id=79655)或[Webkit 的东西所取代。](http://webkit.org/) 就个人而言，我认为 Gazelle 的可能性更大。

话虽如此，我认为 IE 8 不会是 IE 的最后一个版本——我认为它更有可能是*使用*当前代码库的渲染引擎和核心解析例程的 IE 的最后一个版本。我怀疑 MS 会重写他们的内部结构，但我非常非常怀疑，只要微软还在编写软件，Internet Explorer 就会消失。

# c# - 如何在绑定到数据表的 Windows 窗体 dataGridView 中显示时间

> ID：648509
> 
> 赞同：1
> 
> 时间：2009-03-15T20:41:04.763
> 
> 标签：c#, datagridview, datatable

我使用 SqlDataAdapter 的填充方法填充数据表。然后我使用 DataSource 属性将它绑定到 DataGridView

dataGridView1.DataSource = mydataTable;

我希望 DateTime 列也显示秒数。我需要更改什么以默认显示秒数。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T21:18:08.027

对于 winforms 的 DataGridView，可以使用 Column DefaultCellStyle.Format 来设置 DateTime 的格式字符串，如下所示：

```
public Form1()
{
    InitializeComponent();

    dataGridView1.DataSource = new List<MyObject>
    {
        new MyObject{ MyDateTime= DateTime.Now }
    };

    dataGridView1.Columns["MyDateTime"].DefaultCellStyle.Format = "yyyy-MM-dd HH:mm:ss";
}

public class MyObject
{
    public DateTime MyDateTime { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T14:35:16.853

执行此操作的设计时方法是更改​​相关列上的 DefaultCellStyle 属性。单击“...”按钮，然后可以使用出现的弹出框中的“格式”项。

# event-log - 搜索事件日志以找出程序何时被卸载

> ID：648515
> 
> 赞同：2
> 
> 时间：2009-03-15T20:45:17.513
> 
> 标签：event-log, windows-server-2000

我试图通过搜索事件日志来找出何时在 Win2k 机器上卸载程序。我应该搜索哪个日志，是否有任何好的关键字可以搜索以标记卸载事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T21:31:24.627

如果程序是使用 Microsoft Installer 卸载的，您会发现来自源“MsiInstaller”的事件。

我认为没有其他安装程序将事件写入事件日志（也许 Install Shield 会）。也许会有一些来自第 3 方卸载/安装程序的自定义 .log 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T21:43:18.217

你可以试试 Jozef Izso 的建议。作为最后的手段，有时当您卸载程序时，它所在的目录会留在“程序文件”中。该目录将有一个修改日期，该日期应反映任何内容最后一次更改的时间。这可能会指示它何时被卸载。

# matrix - D 编程语言的线性代数库

> ID：648521
> 
> 赞同：11
> 
> 时间：2009-03-15T20:50:45.270
> 
> 标签：matrix, d, linear-algebra, mathematical-optimization

我正在寻找一个包来做矩阵数学高达大约 100 x 100 的矩阵。

我至少需要做逆运算、乘法运算和转置运算。我更喜欢更封装的接口而不是更高的性能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-16T04:00:08.883

dsource.org/projects 之前已经在这个线程中提到过，这里有一些细节。

以下是[GNU 科学库 (GSL) 的 D 语言绑定](http://www.dsource.org/projects/bindings/wiki/GnuScientificLibrary)。

这是[GSL](http://www.gnu.org/software/gsl/)的链接。

这是GSL 中有关[BLAS 支持](http://www.gnu.org/software/gsl/manual/html_node/BLAS-Support.html)、分解（[1、2](http://www.gnu.org/software/gsl/manual/html_node/Vectors-and-Matrices.html) [）](http://www.gnu.org/software/gsl/manual/html_node/Linear-Algebra.html)、[特征系统](http://www.gnu.org/software/gsl/manual/html_node/Eigensystems.html)的文档的一些链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T02:11:05.157

D不能直接调用C代码吗？或者您正在寻找一个用 D 编写的库？

# .htaccess - 如何使用 htaccess 强制 www。在多个域上

> ID：648524
> 
> 赞同：5
> 
> 时间：2009-03-15T20:51:32.943
> 
> 标签：.htaccess

基本上，我的网络服务器上有一个文件夹，每当我购买新域时，我都会将其分配给只有 index.html 和 images 文件夹的新域。它基本上只有我的标志，并说该域正在建设中，即将推出。

通常当我想强制 www 时。前缀我使用以下代码：

```
rewritecond %{HTTP_HOST} ^domain.com [nc]
rewriterule ^(.*)$ http://www.domain.com/$1 [r=301,nc] 
```

这很好用，但是我需要明确写出域的名称。我处理很多域，所以我需要在不知道域名的情况下执行此操作的代码。我试了一下，但老实说没有人接近。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T21:02:14.367

试试这个：

```
RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-10T08:32:05.020

这会将“ftp.domain.com”重定向到“www.ftp.domain.com”。可能不是你想要的。

这可能需要一些修改，但我决定自己写，所以你去吧：

```
RewriteCond %{HTTP_HOST} !^%{SERVER_ADDR}$ [NC]
RewriteCond %{HTTP_HOST} !\.dev$ [NC]
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTP_HOST} ([^\.]+(\.[^\.0-9]{2,4}){1,2})$ [NC]
RewriteRule ^(.*)$ http://www.%1/$1 [R=permanent,L] 
```

它应该支持单字和双字 TLD、通过 IP 地址访问和 DOMAIN.dev 以进行本地开发。适用于超过 4 个字符的域。

# objective-c - NSWorkspace notificationCenter 不发送垃圾收集下的通知

> ID：648526
> 
> 赞同：1
> 
> 时间：2009-03-15T20:52:59.913
> 
> 标签：objective-c, cocoa, garbage-collection

我不确定我是否在这里做错了什么：

我正在使用 awakeFromNib 中的此代码段注册工作区通知

```
[[[NSWorkspace sharedWorkspace] notificationCenter] 
    addObserver:self 
       selector:@selector(noteReceived:) 
           name:nil 
         object:nil]; 
```

选择器`noteReceived:`将单个`NSNotification *`作为参数。我有一个断点。

在关闭 GC 的情况下编译时，它可以正常工作，并且我会收到所有通知。

开启 GC 后，我的应用启动时只会收到一条通知，仅此而已。

我错过了什么吗？

**解决方案：**

我错过了一些东西。这只是一个快速测试项目，因此控制器之间没有实际应用程序中的通常连接。在 nib/xib 文件中实例化一个对象并期望它不被收集是不够的。

一旦我让我的控制器成为文件所有者的委托（即使它没有实现任何委托方法），这足以让对象保持活动状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T01:44:47.153

在 GC 下， NSNotificationCenter 只维护一个对你的观察对象的弱引用。因此，请确保您的观察对象植根于对象层次结构中的某个位置。

# c - 如何在 C 中在运行时声明数组的大小？

> ID：648533
> 
> 赞同：13
> 
> 时间：2009-03-15T20:56:39.250
> 
> 标签：c, arrays

我基本上想要相当于这个的C（嗯，只是数组的一部分，我不需要类和字符串解析等等）：

```
public class Example
{
    static int[] foo;
    public static void main(String[] args)
    {
        int size = Integer.parseInt(args[0]);
        foo = new int[size]; // This part
    }
} 
```

原谅我对C的无知。我已经被java破坏了；）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-15T20:58:58.167

```
/* We include the following to get the prototypes for:
 * malloc -- allocates memory on the freestore
 * free   -- releases memory allocated via above
 * atoi   -- convert a C-style string to an integer
 * strtoul -- is strongly suggested though as a replacement
*/
#include <stdlib.h>
static int *foo;
int main(int argc, char *argv[]) {
    size_t size = atoi(argv[ 1 ]); /*argv[ 0 ] is the executable's name */
    foo = malloc(size * sizeof *foo); /* create an array of size `size` */
    if (foo) {  /* allocation succeeded */
      /* do something with foo */
      free(foo); /* release the memory */
    }
    return 0;
} 
```

*警告：即插即用的东西，没有任何错误检查。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-15T20:59:56.247

在 C 中，如果您忽略错误检查，您可以这样做：

```
#include <stdlib.h>
static int *foo;

int main(int argc, char **argv)
{
     int size = atoi(argv[1]);
     foo = malloc(size * sizeof(*foo));
     ...
} 
```

如果你不想要一个全局变量并且你使用的是 C99，你可以这样做：

```
int main(int argc, char **argv)
{
    int size = atoi(argv[1]);
    int foo[size];
    ...
} 
```

这使用 VLA - 可变长度数组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-22T11:09:18.133

不幸的是，这个问题的许多答案，包括接受的答案，都是*正确*的，但不*等同于 OP's code snippet*。请记住，它`operator new[]`为每个数组元素调用默认构造函数。`int`对于没有构造函数的POD 类型，它们是默认初始化的（阅读：零初始化，参见[C++ 标准的](https://isocpp.org/std/the-standard)§8.5 ¶5-7 ）。

`malloc`我刚刚将（分配未初始化的内存）交换为`calloc`（分配零内存），因此与给定的 C++ 片段等效的是

```
#include <stdlib.h>  /* atoi, calloc, free */

int main(int argc, char *argv[]) {
    size_t size = atoi(argv[1]);
    int *foo;

    /* allocate zeroed(!) memory for our array */
    foo = calloc(sizeof(*foo), size);
    if (foo) {
        /* do something with foo */

        free(foo); /* release the memory */
    }

    return 0;
} 
```

很抱歉重新提出这个老问题，但不发表评论就离开是不对的（我没有所需的代表）;-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T22:58:37.473

如果需要初始化数据，可以使用calloc：

```
int* arr = calloc (nb_elems, sizeof(int));
/* Do something with your array, then don't forget to release the memory */
free (arr); 
```

这样，分配的内存将用零初始化，这很有用。请注意，您可以使用任何数据类型来代替 int。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T21:00:05.327

```
int count = getHowManyINeed();
int *foo = malloc(count * sizeof(int)); 
```

# grails - 向 Grails 域类添加字段？

> ID：648540
> 
> 赞同：2
> 
> 时间：2009-03-15T21:01:30.313
> 
> 标签：grails

我想向现有域类添加一个字段。我不想丢失我的视图文件，但是我知道如果我运行 generate-all 就会发生。还有其他方法可以更新映射等吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-17T08:22:22.400

我认为这是一个普遍的担忧。

这不是您问题的直接解决方案，但这是我所做的并且对我来说效果很好。

1.  我从不直接修改 grails 脚手架的工件（视图和控制器）

2.  我将生产视图/控制器与脚手架工件分开；通过我使用脚手架作为我的应用程序控制器和视图的起点。

3.  如果域模型发生变化，我会重新生成视图并从脚手架工件复制粘贴（尽可能）到手工编码的工件。

4.  在某些时候，我要么从应用程序中删除所有搭建的工件，要么只是保护对它们的访问。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T18:06:55.950

有几种方法可以做到这一点。

1.  如果您没有过多地修改生成的视图并且正在使用版本控制，您可以允许 grails 覆盖您的视图，然后将对新模板的更改与版本控制中的内容合并。

2.  如果您修改了生成的视图，您只需对覆盖视图的提示回答否即可。如果您只是添加一个新字段、更改字段名称或类似的简单操作，那么手动修改视图模板应该非常简单。

您将以相同的方式处理对控制器的任何可能更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T21:04:56.997

只需声明它：

```
class MyDomain {
    String newField;
} 
```

应该是您需要做的所有事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T21:04:42.297

不要重新生成视图，只需将另一个类似的字段复制并粘贴到您要放入视图中的字段。

# c# - WPF 内部：为什么 UserControl 覆盖 AdjustBranchSource？

> ID：648542
> 
> 赞同：2
> 
> 时间：2009-03-15T21:02:36.160
> 
> 标签：c#, .net, wpf, internals

通过使用反射器，您可以看到 WPF UserControl 正在覆盖 AdjustBranchSource。

```
 internal override void AdjustBranchSource(RoutedEventArgs e)
{

   e.Source = this;

} 
```

我自己的问题与该问题引起的不一致有关。当元素基于用户控件内部或外部时。Source 参数的行为不同。令我惊讶的是，源应该始终是 RoutedEvent 的目标元素。

问题是为什么要这样实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T22:25:11.610

这有点道理。如果您将 UserControl 视为一个黑盒子，那么您不应该知道上面有哪些控件，因此不知道事件的来源。

如果您需要区分 UserControl 上的不同按钮，那么 UserControl 应该有它自己的按钮触发的事件。从外部看，它看起来像是正确的事件，并且 UserControl 的用户不需要知道哪个按钮执行了哪个事件。

举个例子，在一个列表框上，你需要知道向下滚动按钮是发送原始事件的按钮吗？还是您只需要知道触发了向下滚动事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T21:43:11.383

路由事件的源可以在事件的整个路由过程中发生变化。我不完全确定为什么要`UserControl`更改它，但是您不能只使用该`OriginalSource`属性[`RoutedEventArgs`](http://msdn.microsoft.com/en-us/library/system.windows.routedeventargs.originalsource.aspx)吗？

# c++ - 如何在 C++ 中从流中执行快速格式化输入？

> ID：648545
> 
> 赞同：4
> 
> 时间：2009-03-15T21:04:04.613
> 
> 标签：c++, performance, stl, file-io

情况是：有一个文件有14 294 508个无符号整数和13 994 397个浮点数（需要读取`double`s）。总文件大小约为 250 MB。

使用`std::istream`大约需要 30 秒。将数据从文件读取到内存（只是复制字节，没有格式化输入）要快得多。有什么方法可以在不改变文件格式的情况下提高阅读速度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T21:07:55.040

你需要使用 STL 风格的 i/o 吗？您必须查看[其中](http://www.dietmar-kuehl.de/cxxrt/cxxrt-1.0.4.tar.gz)一位专家的出色工作。`iostream`这是Dietmar Kuhl专门设计的。

我不想建议这个，但请看一下 C 格式的 i/o 例程。另外，您是否一口气读完整个文件？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T21:53:44.963

您可能还想查看 Matthew Wilson 的 FastFormat 库：

*   [http://www.fastformat.org/](http://www.fastformat.org/)

我没有使用它，但他提出了一些非常令人印象深刻的主张，而且我发现他的许多其他作品值得研究和使用（有时还会偷窃）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T09:00:20.383

你没有指定格式。您可能可以对其进行内存映射，或者可以读取非常大的块并以批处理算法进行处理。

此外，您还没有说您是否确定将读取它的文件和进程将在同一平台上。如果一个 big-endian 进程写入它而一个 little-endian 进程读取它，或者反之亦然，它不会工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-17T11:51:05.067

与“通用”读取方法相比，自己解析输入（atoi 和 atof）通常会提高速度至少两倍。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-22T10:38:14.763

快速而肮脏的方法是将文件转储到标准 C++ 字符串中，然后在其上使用字符串流：

```
#include <sstream>
// Load file into string file_string
std::stringstream s( file_string );
int x; float y;
s >> x >> y; 
```

这可能不会给您带来太多的性能改进（通过避免 iostream，您将获得更大的加速），但它很容易尝试，而且速度可能足够快。

# iphone - 直接设置控制器的视图和添加视图作为子视图的区别

> ID：648551
> 
> 赞同：3
> 
> 时间：2009-03-15T21:08:33.697
> 
> 标签：iphone

我刚刚开始学习objective-C和iphone sdk，我有一个问题希望有人能帮助解释一下。

以下有什么区别：

```
self.view = someView; 
```

和

```
[self.view addSubView: someView]; 
```

例如，在一个简单的应用程序中，我们只有一个控制器和一个容器视图（有几个图像子视图）。这两种说法有什么区别？我问的原因是因为我正在修改一些示例代码，我注意到视图正在使用图像作为子视图初始化，如下所示：

```
if (self = [super initWithFrame:CGRectZero])
{
//adds some images as subviews here
} 
```

据我了解，initWithFrame: CGRectZero 创建了一个大小为 [0,0,0,0] 的框架（基本上不可见）。

当我直接设置视图时

```
self.view = someView; 
```

我注意到视图实际上显示了图像。但是当我将视图添加为控制器的“默认”视图的子视图时，它不会。所以基本上我的问题是，幕后发生了什么？为什么第一种方法“调整”框架的大小，而第二种方法没有做同样的事情。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T23:11:19.130

你在 iPhone 屏幕上看到的几乎都是视图的层次结构。

例如，当您查看 Mail 中的收件箱时，您会看到一堆视图。有一个很大的包含视图。[1] 在其中，有一个导航栏视图、一个表格视图和一个工具栏视图。在导航栏视图中，每一侧都有一个按钮视图，中间有一个标签视图。在表格视图内部，有一堆表格单元格视图，每个单元格都有几个标签视图。工具栏有五个按钮视图。我可以进一步讨论这些按钮内的视图等等，但我相信你明白了。

任何给定视图之上的视图是它的超级视图；它下面的视图是它的子视图。所以一个表格单元格视图有一个表格视图作为它的父视图和一堆标签视图作为它的子视图。顶视图，即其中包含所有其他视图的视图，称为根视图。

每个视图都有自己的绘图表面。由该绘图表面形成的矩形称为框架。一个视图的框架是相对于它的包含视图的框架而言的。因此，如果我们的表格单元格的标签子视图之一的框架位于 (0,0)，这意味着它将位于表格单元格的左上角，即使该单元格位于屏幕的一半。

当您编写视图控制器时，`self.view`是我前面提到的根视图吗？所有其他视图都是该视图的子视图（或其子视图的子视图等）。视图控制器的特性之一是它会自动调整其大小`self.view`以适应屏幕。（在通话过程中可用区域会变小：状态栏的高度是那时的两倍，因此您的应用程序的空间更少。如果您的视图控制器由导航控制器或选项卡管理，它也会更小bar 控制器，但这是另一回事。）但仅仅因为您调整其根视图的大小并不意味着根视图的子视图会自动调整大小。为此，您需要设置它们的自动调整大小掩码（该属性告诉视图在其父视图更改大小时应如何反应）：

```
someView.autoresizingMask = UIViewAutoresizingFlexibleWidth
                          | UIViewAutoresizingFlexibleHeight; 
```

（有一种图形方式可以在 Interface Builder 中设置自动调整掩码——单击检查器窗口中的标尺图标并查看“自动调整大小”部分。）

但是，即使这还不够，如果`someView`开始的尺寸不合适。为此，请在将其添加为以下子视图之前调整其框架`self.view`：

```
someView.frame = CGRectMake(
                            0, // all the way to the left
                            0, // all the way at the top
                            self.view.frame.size.width, // same width as the root view
                            self.view.frame.size.height, // same height too
                           ); 
```

那么，如果你必须像根视图那样为你做这些事情，你为什么还要使用子视图呢？很简单：你只能有一个根视图，但一个视图几乎不足以满足你的需要。如果你真的只需要一个视图，当然，你可以将它设置为根视图并继续你的快乐方式，但很可能事情比这更复杂。

[1] 我在这里进行了一些简化，但现在还可以。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T21:45:23.547

当您将视图添加为子视图时，您需要确保您实际上是添加到现有视图中。

`self.view = view`设置控制器的视图。如果没有这个（无论是在代码中还是使用 XIB 完成），您将永远看不到任何东西，因为控制器无法显示任何视图。

`[self.view addSubView: someView]`假设 self.view 已经设置。如果没有，您将添加`someview`为 的子视图`nil`，并且它永远不会被看到。

基本上，将其`self.view`视为大容器，所有子视图都只是其中的一部分。如果您不需要任何子视图，设置`self.view`为 UIImageView 或 UIWebView 就可以了。如果*确实*需要子视图，则需要一个大的空容器视图来放置它们。

在您的情况下，我打赌`self.view`永远不会设置，并且您正在将图像视图添加到`nil`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T21:44:47.043

设置视图控制器的“视图”属性只会更改它正在管理的视图。

添加一个视图作为另一个视图的子视图，实际上是在另一个视图下面添加了子视图。

它们是非常不同的东西，一个调整视图控制器，另一个改变视图层次结构。

作为猜测，您第一次看不到任何东西的原因是您添加的子视图的框架是 CGRectZero（大小为 0）。

# java - 有人可以帮助我提供与我的作业的 jar 级别相同的 java 参考文件吗？

> ID：648553
> 
> 赞同：0
> 
> 时间：2009-03-15T21:10:17.827
> 
> 标签：java, config

用下面的代码解决了这个问题——不是最优雅的方式——但我需要一个快速解决这个任务的方法

```
package six.desktop.gui.common;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.URL;

public class Config
{
    private static final String configFileName = "/config/config.ini";

    private Config()
    {

    }

    public static String getPropertyValue(String propertyName) throws IOException
    {
        URL url = new Config().getClass().getResource(configFileName);

        BufferedReader br = new BufferedReader(new InputStreamReader(url.openStream()));

        String inputline = "";
        while ((inputline = br.readLine()) != null)
        {
           if (inputline.contains(propertyName))
           {
               int index = inputline.indexOf(propertyName);
               index += propertyName.length() + 1;

               return inputline.substring(index, inputline.length());
           }
        }
        return null;
    }
} 
```

* * *

我希望能够配置包含与 jar 位于同一级别的数据库连接字符串的文件。我怎么能做到这一点？还是我想要的有不同的方法？

我有一个 DB 处理程序类，目前它刚刚硬编码了连接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T21:58:00.257

如果“与 JAR 相同级别”是指属性文件与 JAR 文件位于同一目录中，那么完成您正在尝试的操作的极其简单的方法是：

```
public class MyMain {
   Properties props;
   MyMain(Properties props) {
      this.props = props;
   }

   public static void main(String[] args)
      throws Exception
   {
      File f = new File("just_the_name.properties");
      FileInputStream fis = new FileInputStream(f);
      Properties props = new Properties();
      props.load(fis);
      // Now, you'll have your properties loaded from "just_the_name.properties"
      MyMain mm = new MyMain(props);
      // ... and do whatever you need to do ... 
   } 
```

我还建议您使用一个包含存储在各个类成员中的所有属性的类，以便您轻松使用它们。

如果您的属性文件位于**JAR**文件中，您可以按照之前的帖子建议进行操作。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T21:35:43.400

这段代码是你的开始......

```
private static URI getJarURI()
    throws URISyntaxException
{
    final ProtectionDomain domain;
    final CodeSource       source;
    final URL              url;
    final URI              uri;

    domain = Main.class.getProtectionDomain();
    source = domain.getCodeSource();
    url    = source.getLocation();
    uri    = url.toURI();

    return (uri);
} 
```

这将获取您正在运行的 Jar 文件的 URI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T21:14:42.060

我可以立即想到三个选项。首先是找出 jar 文件的名称，这可以通过对调用返回的 URL 进行一些棘手的检查来完成`Class.getResource()`，然后计算出完全限定的配置文件名。

第二种选择是将目录本身放在类路径中，并以`InputStream`using`Class.getResourceAsStream()`或的形式请求资源`ClassLoader.getResourceAsStream()`。

最后，您可以通过其他方式（例如通过系统属性）传入配置文件的名称，并基于此加载文件。

就我个人而言，我喜欢第二个选项——除此之外，这意味着你可以在以后将配置文件发送*到*jar 中，如果你愿意的话——或者将配置文件移动到另一个目录并只更改类路径。如果您将配置文件名直接指定为系统属性，后者也很容易：这将是我的第二选择。

# c# - 有没有一种好方法可以使用 Console.ReadKey 在值之间进行选择，而无需在类型之间进行大量转换？

> ID：648555
> 
> 赞同：1
> 
> 时间：2009-03-15T21:10:56.407
> 
> 标签：c#, types, console

我使用 Console.ReadKey() 从多个不时变化的选项中进行选择。在这个初始代码片段之前，有一个 for 循环将出现次数计入 int 类型的计数器变量中。

关键是使用 Console.ReadKey() 来获取一个 int。

```
int choice = ReadKey();
Console.WriteLine("");

if (choice < counter)
{
    mail.to = result[counter-1].email;
} 
```

通过使用以下方法

```
static int ReadKey()
{
    ConsoleKeyInfo choice = Console.ReadKey();
    char convertedchoice = choice.KeyChar;
    string convertedchoice2 = convertedchoice.ToString();
    int result = TryInt(convertedchoice2);
    return result;
}

static int TryInt(string totry)
{
    while (true)
    {
        int result;
        if (int.TryParse(totry, out result))
        {
            return result;
        }
        Console.WriteLine("Sorry, you need to enter a number. Try again.");
    }
} 
```

我尝试使用 ToString() 但这是最​​终让我这样做的方式。所以这对我来说看起来有点无效，因此我真的很感激一些指导，因为我有什么不同的做法？

编辑：

我最终得到了以下所有好的答案的组合。非常感谢你们。

```
static int ReadKey()
{
    while (true)
    {
        ConsoleKeyInfo choice = Console.ReadKey();
        if (char.IsDigit(choice.KeyChar))
        {
            int answer = Convert.ToInt32(choice.KeyChar);
            return answer - 48; //-48 because 0 is represented in unicode by 48 and 1 by 49 etc etc
        }
        Console.WriteLine("\nSorry, you need to input a number");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T21:27:24.573

对于选项为 0..9 的菜单系统，这是可以接受的。不是为了阅读更大的数字。

使用 char.IsDigit() 可以使您的整个检查逻辑变得更加容易：

```
if char.IsDigit(convertedchoice)
{
  int result = convertedchoice - '0';    // char1 - char2 = int, in this case in 0..9
  return result;
}
else ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T21:15:49.343

你可以直接打电话`Convert.ToInt32(choice.KeyChar);`。

那会简化一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T21:30:23.163

有很多方法可以简化代码，但首先要尽量避免将所有内容都放入变量中。一般来说，像：

```
(a + b + c) / 2 
```

比以下内容更容易阅读：

```
int A_plus_B = a + b
int A_plus_B_plus_C = A_plus_B + c
int answer = A_plus_B_plus_C / 2 
```

考虑到这一点，您可以编写：

```
static int ReadKey()
{
    while (true)
    {
        char ch = Console.ReadKey().KeyChar;
        int result;
        if (int.TryParse(ch.toString(), out result))
        {
            return result;
        }
    }
} 
```

# c# - 如何确定windows窗体中的文本框是否有焦点

> ID：648559
> 
> 赞同：0
> 
> 时间：2009-03-15T21:13:31.067
> 
> 标签：c#, internet-explorer, forms, textbox, focus

假设我在 Windows 窗体中嵌入了 Internet Explorer，然后我导航到网络上的一个随机页面。如何确定文本框（或任何其他可以接受文本输入的控件）何时成为焦点项目？基本上，每次单击鼠标时，我都可以检查焦点项目是文本框还是其他文本输入控件，然后采取适当的行动。

提前致谢，

鲍勃

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T00:08:44.670

您还没有解释 WebBrowser 的滚动，但问题似乎在于跟踪输入焦点。我不知道表单级别的事件，但您可以将事件处理程序挂钩到所有相关控件的 Enter 或 GotFocus 事件。

```
// in Form_Load
foreach (var control in this.Controls)  control.Enter += OnEnterControl;

private void OnEnterControl(object sender, EventArgs e)
{
  focusControl = (sender as Control);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T00:48:38.443

我相信您想要做的是接收[HTMLTextContainerEvents2](http://msdn.microsoft.com/en-us/library/aa741890(VS.85).aspx)调度接口并响应 onFocus（可能还有 onBlur）。

没错，您必须自己通过 pinvoke 进行互操作。我假设您可以获得指向您要跟踪的所有对象的 IHTMLElement 指针（通过使用 getElementsByTagName 或类似的东西）。一旦你有了它，

1.  在 IHTMLElemnt 中查询[IConnectionPointContainer](http://msdn.microsoft.com/en-us/library/ms683857.aspx)。
2.  调用 IConnectionPointContainer::FindConnectionPoint(DIID_DHTMLTextContainerEvents2)
3.  在步骤 2 中获得的[IConnectionPoint](http://msdn.microsoft.com/en-us/library/ms694318(VS.85).aspx)上调用 IConnectionPoint::Advise() 。
4.  当然，您需要实现 IDispatch::Invoke() 这将是您的回调。
5.  处理 DISPID_HTMLELEMENTEVENTS2_ONFOCUS 等。

# .net - 在浏览器之外解释 JavaScript？

> ID：648568
> 
> 赞同：16
> 
> 时间：2009-03-15T21:20:00.503
> 
> 标签：.net, javascript, clr

这更多是出于好奇而不是真正的要求，但我想知道是否有可能将 JavaScript 视为（理想情况下）一流的 .NET 公民，或者（其次）有某种方式调用/解释纯 JavaScript 函数（即不需要 DOM）在桌面设置中？

有没有人尝试过实现 JavaScript 的 CLR 版本？关于这一点，我的脑海里一直萦绕着一些东西，但现在我想它可能是 PHP，而不是 JavaScript。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T21:36:41.977

对于您的第二个选择，有[Rhino](http://en.wikipedia.org/wiki/Rhino_(JavaScript_engine))和[类似的东西](http://en.wikipedia.org/wiki/JavaScript#Uses_outside_web_pages)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T21:54:22.120

使用 DLR（动态语言运行时），您可以使用托管 JScript。请在此处查看 Microsoft 的官方 JScript 博客。

[http://blogs.msdn.com/jscript/archive/2007/05/04/managed-jscript-announced.aspx](http://blogs.msdn.com/jscript/archive/2007/05/04/managed-jscript-announced.aspx)

这适用于 Ruby (IronRuby)、Python (IronPython) 和 Dynamic VB。您还可以编写自己的 DLR 语言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T21:53:13.683

[JScript](http://msdn.microsoft.com/en-us/library/3bf5fs13.aspx)作为一等公民在 .NET 上可用。它不完全是 JavaScript，但它可能足以满足您的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T21:35:38.437

根据this page，CLR上曾经有2个“实现”：

[http://blogs.ugidotnet.org/nettools/articles/8060.aspx](http://blogs.ugidotnet.org/nettools/articles/8060.aspx)

不过好像两个都死了……

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T21:37:54.657

完全可以在不使用 Web 浏览器的情况下运行 JavaScript 应用程序。您可以通过使用 cscript 运行应用程序来做到这一点（通常 javascript 文件以 .js 结尾）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-18T20:44:39.830

您还可以使用[node.js](http://nodejs.org/)运行 .js 文件。希望这对其他人有帮助。

# arrays - ASP 中数组赋值的类型不匹配

> ID：648569
> 
> 赞同：1
> 
> 时间：2009-03-15T21:20:33.153
> 
> 标签：arrays, asp-classic

自从我使用 ASP 以来已经有一段时间了，但是我在看似简单的赋值语句上遇到了类型不匹配错误。任何人都可以阐明为什么会发生这种情况。

这有效，但是当我尝试 foreach 未分配的问题块时，我得到一个对象而不是集合错误

```
Class Survey
  public ID
  public Title
  public Questions
End Class

Sub Test()
  Dim oSurvey
  Set oSurvey = new Survey
  Dim aQuestions(2)
  Set aQuestions(0) = new Question
  ' Other aQuestions assignments
  oSurvey.Questions = aQuestions
End Sub 
```

或者，如果我将问题设置为动态数组，则分配失败并出现类型不匹配错误。

```
Class Survey
  public ID
  public Title
  public Questions()
End Class

Sub Test()
  Dim oSurvey
  Set oSurvey = new Survey
  Dim aQuestions(2)
  Set aQuestions(0) = new Question
  ' Other aQuestions assignments
  ' Throws a Type mismatch error here
  oSurvey.Questions = aQuestions
End Sub 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-22T16:02:33.783

回答您关于实际情况的问题。

> 当我尝试 foreach 未分配的问题块时，我得到一个 Object not a collection 错误

For Each 枚举来自源变量的一组变体，它通过获取 IEnumVARIANT 来做到这一点。如果源变量包含一个对象，则预期它具有此接口的实现。如果它是一个数组，VBScript 会动态地创建一个实现，并且它只能在数组已被标注尺寸的情况下执行此操作。源变量中的任何其他内容（例如本例中的 Empty）都将导致错误。

> 然后分配失败并出现类型不匹配错误。

赋值操作的左侧必须始终是变体。因此，不可能通过简单的赋值将一个动态数组的内容复制到另一个。

您的第一种方法相当合理，但您需要一种方法来表示一个空数组，而不会导致 For Each 崩溃。你可以使用这个小技巧：-

```
Function EmptyArray
EmptyArray = Split("", " ")
End Function

Class Survey
   public ID
   public Title
   public Questions

   Private Sub Class_Initialize
       Questions = EmptyArray
   End Sub
End Class 
```

现在，如果您在为其分配一个真正的数组之前尝试 For Each the Questions ，则 for each 将不会按预期执行任何操作。此外，如果您使用 UBound(Questions) + 1 来获取仍然准确的问题数，因为 UBound(EmptyArray) 为 -1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T21:54:49.063

如果我尝试将相同的代码粘贴到 VBA（excel 或 word）中，它不会编译。

它在线显示错误 `public Questions()` 说

```
--------------------------
微软 Visual Basic
--------------------------
编译错误：

常量、定长字符串、数组、用户定义类型和 Declare 语句不允许作为对象模块的公共成员
--------------------------
确定 帮助   
--------------------------

```

在第一个示例中，您尚未将其定义为数组（它是一个变体，因此可以分配任何值）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T10:18:52.863

**更新：**我在 ASP.NET 中对此进行了测试，但没有意识到问题是关于经典 ASP 的。我已经修改了下面的代码以使用经典的 ASP，虽然我还不能测试它：

```
 Class Question
        ...
    End Class

    Class Survey
        Public ID
        Public Title
        Public Questions As Question()
    End Class

    Sub Test()
        Dim oSurvey As New Survey
        Dim aQuestions(0 To 2) As Question
        Set aQuestions(0) = New Question
        ...
        Set oSurvey.Questions = aQuestions
    End Sub 
```

在您的第一个示例中，`Survey.Questions`不是集合；在您的第二个中，它是一个 Type 数组`Variant`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T01:39:35.787

所以我最终坚持使用 Array 声明。此外，当我尝试像这样重新调整数组时，我得到了一个错误。

```
ReDim oSurvey.Questions(2) 
```

所以我创建了一个子程序来重新调整数组，这很有效。

```
Class Survey
  public ID
  public Title
  public Questions()

  sub ReDimQuestions(count)
    ReDim Questions(count)
  end sub
End Class

Sub Test()
  Dim oSurvey
  Set oSurvey = new Survey
  oSurvey.ReDimQuestions 2
  Set oSurvey.Questions(0) = new Question
  ' Other aQuestions assignments
End Sub 
```

# database - 如何解决 Sybase 表锁（VB6）？

> ID：648572
> 
> 赞同：1
> 
> 时间：2009-03-15T21:25:09.150
> 
> 标签：database, performance, vb6, locking, sap-ase

我不是一个出色的 VB 程序员，但我的任务是维护/增强使用 Sybase ASE 作为后端的 VB6 桌面应用程序。这个应用程序有大约 500 个用户。

最近，我向这个应用程序添加了功能，它对数据库中的单行执行额外的插入/更新，关键字段是事务号，并且该字段被索引。正在更新的表中通常有大约 6000 条记录，因为在事务完成时会删除记录。部署后，在用户报告性能缓慢之前，该应用程序可以正常运行一天半。

最终，我们将性能问题追溯到数据库中的表锁，不得不回滚到应用程序的先前版本。使用的第一天是周一，一般是系统使用非常繁重的一天，所以我很困惑为什么当天没有出现问题。

在现有的代码中，有一个启动 Sybase 事务的调用。在 BeginTrans 和 CommitTrans 之间的块中，有一个对更新数据库的 DLL 文件的调用。我将新代码放在 DLL 的类模块中。

我很困惑为什么对单行的单个插入/更新会导致这样的问题，特别是因为系统在更改之前工作正常。有没有可能我在这里暴露了一个更大的问题？或者我只需要重新考虑我的方法？

提前感谢任何遇到类似情况并可以提供建议的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-19T00:35:04.620

事实证明，罪魁祸首是出现在 BeginTrans 和 CommitTrans 调用范围内的消息框。拥有消息框的用户将在数据库上保持阻塞锁，直到他们确认消息为止。解决方案是将消息框移到上述范围之外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T21:41:20.453

如果没有您正在使用的 SQL 代码，我无法理解完整的图片。

另外，如果是单次插入或更新，为什么要使用事务？是否有可能许多用户会尝试更新同一行？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T09:59:36.340

如果您同时发布了 VB 代码和 SQL（如果可能，请提供查询计划），这将很有帮助。但是，根据我们拥有的信息；我会`update statistics table_name` 针对该表运行以确保查询计划是最新的。

如果您确定您的代码必须在事务中运行，您是否尝试过添加自己的包含 SQL 的事务块，而不是使用已经存在的事务块？

# vb.net - 如何在 VB .NET 中对单独项目中的私有函数进行单元测试？

> ID：648576
> 
> 赞同：6
> 
> 时间：2009-03-15T21:31:02.350
> 
> 标签：vb.net, unit-testing, nunit, private, friend

当我开发代码时，我经常想对一个类的一些构建块进行单元测试，即使它们通常是私有的。如果我的单元测试在项目内部，我可以使用“朋友”来完成此操作，并且仍然保持功能私有以供正常使用。但我宁愿将我的 NUnit 测试转移到他们自己的单独项目中。如何达到我想要的效果？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-15T21:33:08.070

您不能（轻松）测试*来自*不同项目的*私有*方法，但是使用. 这使得成员可以访问另一个程序集。*`Friend`[`InternalsVisibleToAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)`Friend`*

 *显然这是 VB 9 中的新功能，尽管它在 C# 2 中可用......不太清楚为什么，但[Bart de Smet 的这篇博客文章](http://community.bartdesmet.net/blogs/bart/archive/2007/09/01/visual-basic-9-0-feature-focus-friend-assemblies.aspx)给出了一个简单的例子。

请注意，如果您的生产程序集已签名，则您的测试程序集也需要签名，并且您必须在`InternalsVisibleToAttribute`参数中指定公钥。有关更多详细信息，请参阅[此 Stack Overflow 答案](https://stackoverflow.com/a/1123831/22656)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T22:03:48.260

您可以使用反射来调用私有方法。有很多样本可以做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T17:20:07.370

从谷歌快速搜索： http: [//www.codeproject.com/KB/cs/testnonpublicmembers.aspx](http://www.codeproject.com/KB/cs/testnonpublicmembers.aspx)

基础知识：（这是从上面链接的代码项目站点粘贴的）

```
 public static object RunStaticMethod(System.Type t, string strMethod,
  object []  objParams) 
    {
        BindingFlags eFlags = 
         BindingFlags.Static | BindingFlags.Public | 
         BindingFlags.NonPublic;
        return RunMethod(t, strMethod, 
         null, aobjParams, eFlags);
    } //end of method

    public static object RunInstanceMethod(System.Type t, string strMethod, 
     object objInstance, object [] aobjParams) 
    {
        BindingFlags eFlags = BindingFlags.Instance | BindingFlags.Public | 
         BindingFlags.NonPublic;
        return RunMethod(t, strMethod, 
         objInstance, aobjParams, eFlags);
    } //end of method

    private static object RunMethod(System.Type t, string 
     strMethod, object objInstance, object [] aobjParams, BindingFlags eFlags) 
    {
        MethodInfo m;
        try 
        {
            m = t.GetMethod(strMethod, eFlags);
            if (m == null)
            {
                 throw new ArgumentException("There is no method '" + 
                  strMethod + "' for type '" + t.ToString() + "'.");
            }

            object objRet = m.Invoke(objInstance, aobjParams);
            return objRet;
        }
        catch
        {
            throw;
        }
    } //end of method 
```

# xslt - xslt 文档功能问题

> ID：648578
> 
> 赞同：1
> 
> 时间：2009-03-15T21:32:00.710
> 
> 标签：xslt

如果一个人正在使用文档功能并打开可能不存在的文件，例如

```
<xsl:variable name="input" select="document($A)/document/input"/> 
```

处理错误的优雅方式是什么？如果无法打开文件，我想要变量的默认值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T13:47:35.543

**没有一种通用的方法可以优雅地处理[`document()`](http://www.w3.org/TR/xslt#function-document)函数**中的错误。

**根据[XSLT 1.0 规范](http://www.w3.org/TR/xslt#function-document)**：

"*如果在检索资源时出错，那么 XSLT 处理器可能会发出错误信号；如果它没有发出错误信号，它必须通过返回一个空节点集来恢复。* "

**这意味着我们由实现者**决定是否由函数产生空节点集（很好，我们可以测试空（不存在的）节点集）还是“发出错误信号”，这通常可能会结束转变。

如果我们检查了特定 XSLT 处理器的特定实现只产生一个空节点集并且没有结束转换，我们可能会决定测试这种情况并“优雅地”恢复。但是，我们的应用程序变得不可移植，它依赖于这个特定的 XSLT 处理器，并且绝对不能保证在下一个版本中这种行为不会变得更糟。有风险，不是吗？

**因此，无论谁启动转换（例如从 C# 程序中），最好检查文件是否存在**并将适当的参数传递给转换，以反映这种存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-05T21:15:34.810

使用 XPath 2.0 中可用的 doc-available() 函数怎么样？： [http ://www.w3.org/TR/xpath-functions/#func-doc-available](http://www.w3.org/TR/xpath-functions/#func-doc-available)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T02:57:20.787

我相信你可以`<xsl:variable>`这样写：

```
<xsl:variable name="input">
 <xsl:choose>
  <xsl:when test="document($A)/document/testElementCondition = 'foo'">
   <xsl:value-of select="document($A)/document/input" />
  </xsl:when>
  <xsl:otherwise>
   <!-- add some default source document and logic that will then direct to an error message. -->
  </xsl:otherwise>
  </xsl:choose>
</xsl:variable> 
```

太糟糕了，您经常不得不通过 h​​ack 来在 XSL 中完成任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T23:01:52.490

优雅的方法是在将参数提供给样式表之前检查文件是否存在。

# php - 如何在 setcookie() 中使用变量？

> ID：648585
> 
> 赞同：1
> 
> 时间：2009-03-15T21:36:44.380
> 
> 标签：php, session, cookies

我想将用户设置的变量传递给`setcookie`函数。我想让用户更改网站某些部分的颜色。到目前为止，有关颜色的信息已发送到服务器，`$_SESSION['colorcode']`我也想将其添加到服务器，`setcookie`因此当用户下次登录该站点时，他/她的颜色就在那里。我有这个代码：

```
setcookie(
    'colorcode',
    $_SESSION['colorcode'],
    time() + 60 * 60 * 24 * 30,
    '',
    '',
    false,
    true
); 
```

我想将变量的值保存在 cookie 中，但它仅适用于会话。怎么了？怎么做才能使用户登录时出现颜色？我正在寻找另一种方式，而不是将其存储在数据库或文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T12:02:54.047

您是否在下一个会话开始时从 cookie 中读回了值？设置 cookie 看起来不错，但我认为最后一个参数可以省略。

```
setcookie("colorcode", $_SESSION['colorcode'], time()+3600*24*30, '/'); 
```

甚至路径 ( `'/'`) 也是可选的。但这只会设置 cookie。当用户下次返回您的站点时，您必须重新读取数据。

```
if ( !isset($_SESSION['colorcode']) and isset($_COOKIE['colorcode']) ) {
    if ( preg_match('/^#?[0-9a-fA-F]{6}$/', $_COOKIE['colorcode']) ) {
        $_SESSION['colorcode'] = $_COOKIE['colorcode'];
    } else {
        // bad value... delete cookie if you like
    }
} 
```

如果`colorcode`会话中不存在但 cookie 值存在，则验证数据，如果它是有效的 6 位十六进制颜色代码，则将该值插入会话中。验证是必要的，因为 cookie 是来自用户的数据，因此可能是恶意的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T21:46:56.587

试着检查一下：

```
setcookie('colorcode',$_SESSION['colorcode'],time()+60*60*24*30); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T22:38:16.417

这应该可以正常工作：

```
setcookie("colorcode",$_SESSION['colorcode'],time()+60*60*24*30); 
```

只是让你在标题中输出它，我猜：

> setcookie() 定义了一个 cookie 与其余的 HTTP 标头一起发送。与其他标头一样，必须在脚本的任何输出之前发送 cookie（这是协议限制）。这要求您在任何输出之前调用此函数，包括和标记以及任何空格。

你有错误吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T04:58:38.280

由于 cookie 相关功能（setcookie()，...）与 HTTP 标头一起使用，因此您应该在将任何输出发送到客户端之前使用它们。但这并不意味着这些函数应该出现在代码的开头。只要确保没有输出已发送。甚至文件开头的单个空格字符

# asp.net - 如何防止来自您的 ASP.NET 站点的图像热链接？

> ID：648592
> 
> 赞同：6
> 
> 时间：2009-03-15T21:39:57.943
> 
> 标签：asp.net, http, hotlinking

防止人们从我托管的 ASP.NET 网站热链接到图像的最佳/最简单方法是什么？我不需要阻止所有图像/资源热链接，我只想阻止热链接到站点上的特定图像/资源。供参考。它在 GoDaddy.com 上托管，因此 IIS 技巧可能不起作用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-08-08T07:27:36.127

最简单的方法是使用 IIS 7.0 中的 UrlRewrite。

[https://help.maximumasp.com/KB/a738/using-url-rewrite-to-prevent-image-hotlinking.aspx](https://help.maximumasp.com/KB/a738/using-url-rewrite-to-prevent-image-hotlinking.aspx)

```
<configuration>
<system.webServer>
    <rewrite>
        <rules>
            <rule name="PreventImageHotlinking" enabled="true" stopProcessing="true">

<match url=".*\.(gif|jpg|png)$" />
  <conditions>
                        <add input="{HTTP_REFERER}" negate="true" pattern="^$" />
                        <add input="{HTTP_REFERER}" negate="true" pattern="http://www.YourDomain.com/.*" />
  </conditions>
  <action type="Rewrite" url="/images/hotlinking.jpg" />
</rule>
            </rules>
        </rewrite>
    </system.webServer> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T21:44:23.987

您可以拒绝任何在 HTTP 引用标头字段中没有您的站点的图像请求。这就是理论。为了控制应用程序中的请求，您必须通过 ASP 页面流式传输所有图像（而不是直接链接到它们）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T22:17:34.780

通过 ASPX 页面流式传输图像是一个很好的解决方案。虽然 Referrer 可能会被黑客入侵。

如果您真的关心安全性，您可以做的是使用唯一的盐（关键字）并针对 MD5（SHA-1 或 SHA-2）生成。同时运行当前纪元时间，这也会使图像到期。将此“密钥代码”存储在 cookie 中。每当提供图像时，您基本上都会通过查询字符串传递它。验证发生在另一端的 ASPX 上。您甚至可以使用 HTTPRequestModule 或 Global.asax 页面在每个请求之间重新生成一个新的“密钥代码”。

会有开销，但它会阻止任何人进行盗链。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T23:55:23.313

我看到的一件我认为很聪明的事情是在图像的底部添加一个额外的部分，然后在您的网站上显示时使用 css sprite 技术将其切断。一个天真的热链接将导致显示您的额外部分。这将意味着图像是倾斜的，因此它在其他站点上看起来不正确，您可以使用额外的部分来显示您自己的 url 或您想要的任何其他内容。

# jquery - sIFR swf 实施问题

> ID：648597
> 
> 赞同：2
> 
> 时间：2009-03-15T21:42:11.603
> 
> 标签：jquery, flash, sifr

我已经尝试了一些 sIFR 实现的方法，但我无法让它 100% 工作。我非常感谢有关此问题的任何帮助或提示。

我主要尝试使用 sIFR 3 (r436)，我让它与示例中提供的 rockwell.swf 一起使用，但我无法让它与任何其他 .swf 文件一起使用

我要使用的字体是一种名为 Swedbank (PostScript Mac) 的字体，但另一种名为 Telenor (Truetype) 的字体也可以。我想使用 H3 标签上的字体。

我使用提供的 sifr.fla 在 Adob​​e Flash CS4 中生成 .swf 文件。所有导出设置均根据[http://wiki.novemberborn.net/sifr3/How+to+use（flash](http://wiki.novemberborn.net/sifr3/How+to+use) 8、as2、压缩和保护等）。但是当我使用我的 swedbank.swf 而不是 rockwell.swf 时它不起作用

我还尝试了[http://www.sifrgenerator.com/](http://www.sifrgenerator.com/)上的 sIFR 生成器向导 它只支持 Truetype。我已经尝试过 Telenor 字体，因为它是 Truetype 字体，以及 2-3 种其他 Truetype 字体，但没有一个字体能够生成工作的 .swf 文件

我怀疑是对这些字体有一些限制，所以我尝试了导出 Arial、Verdana 等，但它也不起作用！我曾尝试使用 Flash CS4 中的 Rockwell (Opentype)，但即使是这个也不起作用！由于工作示例中使用了 Rockwell，我认为我选择的字体没有问题，它一定是别的东西？

我使用的是 OS X 10.5.6，但也在 Windows XP 上尝试过上述方法。

那里的任何人都可以提出解决方案或从这些字体中获得有效的 .swf 吗？

我还尝试了基于 sIFR 2.0.5 的 jQuery sIFR 插件。我认为这个版本与 Flash 10 有问题，但使用这个插件我可以让 swedbank.swf 工作！！.. 我从 Flash CS4 生成了一个 swedbank_j.swf 文件，它工作正常！但是实现非常有问题，我不希望使用 jQuery sIFR。我一直在尝试使用 OffsetLeft 和 Zoomlevel 等，但左侧位置不一致且不可预测，我无法使用此方法获得我想要的结果

示例： [http](http://www.easytowah.com/test/rockwell_sifr3.html) ://www.easytowah.com/test/rockwell_sifr3.html （使用 rockwell 示例 swf 文件） [http://www.easytowah.com/test/swedbank_sifr3.html](http://www.easytowah.com/test/swedbank_sifr3.html) （不工作...） [http： //www.easytowah.com/test/swedbank_jquery.html](http://www.easytowah.com/test/swedbank_jquery.html) （swf 工作，但不是实现）

以上示例中使用的所有文件 [http://www.easytowah.com/test/sifrtest.zip](http://www.easytowah.com/test/sifrtest.zip)

字体： [http ://www.easytowah.com/test/swedbank_osx.zip](http://www.easytowah.com/test/swedbank_osx.zip) [http://www.easytowah.com/test/telenor_tt.zip](http://www.easytowah.com/test/telenor_tt.zip)

文档/下载 jquery sIFR：http: [//jquery.thewikies.com/sifr/](http://jquery.thewikies.com/sifr/)

文档/下载 sIFR3： http: [//novemberborn.net/sifr3](http://novemberborn.net/sifr3)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-17T03:21:01.923

尝试删除“字体粗细：粗体；” 从你的代码。如果查看实际的 swf 文件：

[http://www.easytowah.com/test/swedbank.swf](http://www.easytowah.com/test/swedbank.swf)

现在将其与罗克韦尔一号进行比较：

[http://www.easytowah.com/test/rockwell.swf](http://www.easytowah.com/test/rockwell.swf)

Rockwell 有 3 种不同的样式/重量导出，您的只有一种。

既然你的 swf 中没有粗体，我会说这就是为什么它没有显示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T00:59:55.937

如果您甚至无法让 Arial 工作，则可能是 Flash CS4 中的任何内容！

您是否使用过其他工具，例如：

*   [发电机](http://www.sifrgenerator.com/wizard.html)
*   [教程](http://designintellection.com/2008/this-is-how-you-get-sifr-to-work/)
*   [命令行](http://www.mtasc.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T13:50:52.070

此外，如果您需要转换 opentype 字体以与 sIFR Generator 等工具一起使用，您可以使用此转换器：[https ://onlinefontconverter.com](https://onlinefontconverter.com)

# wcf - WsDualHttpBinding 如何了解回调通道？

> ID：648601
> 
> 赞同：2
> 
> 时间：2009-03-15T21:44:13.473
> 
> 标签：wcf, wsdualhttpbinding

有些东西对我来说似乎很奇怪，我试图用反射器查看 WCF 内部，但请原谅我太难理解了:(。

当客户端 A 使用 wsDualHttpBinding 在服务器 B 上调用双工服务时，我在想客户端 A 在请求的标头中包含客户端基地址（回调的地址），如下所示

```
<a:ReplyTo>http://client.foo/29293-3287-2387-3291</a:ReplyTo> 
```

.

但 `OperationContext.Current.IncomingMessageHeaders.ReplyTo` 返回空...

wsDualHttpBinding 如何知道客户端通道的地址？？？？

有什么黑魔法吗？

***解决方案***

这是负责传输replyTo 地址的可靠会话。我们可以在 customBinding 中使用这些绑定元素来验证这一点

```
<reliableSession/>
<compositeDuplex/>
<oneWay></oneWay>
<textMessageEncoding></textMessageEncoding>
<httpTransport/> 
```

删除reliableSession，您的服务不再有回调通道......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T21:53:48.160

我认为这些信息是在建立会话时通过消息传递的。如果您使用“fiddler”之类的工具来查看所有 http 流量，我的直觉是您会在初始会话设置消息中看到它。没有魔法，客户端必须告诉服务器“在哪里回调”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T21:48:09.547

当我使用套接字时，调用者的地址也可用 - 我的猜测是知道你需要回复哪个地址是网络通信的一个相当低级的功能......

# javascript - 如何在没有 document.write 长度限制的情况下写入页面

> ID：648602
> 
> 赞同：0
> 
> 时间：2009-03-15T21:44:13.613
> 
> 标签：javascript, html

我**不是**一个 javascript/html/css 的人。

即便如此，我发现自己不得不做一个网页。它是静态的，您唯一可以做的就是单击标志以根据 cookie 更改显示语言。

如果 cookie 说“this”，我用一种语言写文本，如果 cookie 说“that”，我用另一种语言写。这非常有效，但我必须使用**大量**的 document.write 语句，而且它又丑又麻烦。

现在我输入我想要的文本，并在 emacs 中使用宏将文本折叠成大约 80 个字符，然后放在`document.write("`每行的开头和`");`结尾。然后我将它粘贴到网页中的`if(cookie_this) { } else { }`.

必须有更好的方法来做到这一点...拜托？
**编辑**：
我正在寻找解决方法来解决 document.write 中的限制

约束：

*   没有服务器端魔法，这意味着没有 ruby​​/php/perl
*   只有一页，或者更确切地说只有一个可见的 url
*   解决方案应该比我的工作更简单

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T22:23:09.680

扩展[artlung的答案](https://stackoverflow.com/questions/648602/how-write-to-page-without-document-write-length-limitation/648637#648637)：

您可以显示或隐藏给定`lang`属性（或任何其他条件，例如类名）的事物。在 jQuery 和 HTML 中：

```
<p>Language:
    <select id="languageSelector">
        <option value="en">English</option>
        <option value="es">Espa&ntilde;ol</option>
    </select>
</p>

<div lang="en-us">
Hello
</div>

<div lang="es">
Hola
</div>

<script type="text/javascript">
var defaultLanguage = 'en';
var validLanguages = ['en', 'es'];

function setLanguage(lang, setCookie) {
    if(!$.inArray(languages, lang))
        lang = defaultLang;

    if(typeof(setCookie) != 'undefined' && setCookie) {
       $.cookie('language', lang);
    }

    // Hide all things which can be hidden due to language.
    $('*[lang]').filter(function() { return $.inArray(languages, $(this).attr('lang')); }).hide();

    // Show currently selected language.
    $('*[lang^=' + lang + ']).show();
}

$(function() {
    var lang = $.cookie('language'); // use jQuery.cookie plugin
    setLanguage(lang);

    $('#languageSelector').change(function() {
        setLanguage($(this).val(), true);
    });
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T21:55:14.817

jQuery 可以轻松地做到这一点，但是您可以创建一个元素，然后设置该元素的 innerHTML 属性。您可能需要稍微更改您的调用，以便附加子元素。有关详细信息，请参阅[createElement](http://www.google.com/search?q=document.createElement)函数。例如

```
<script type="text/javascript">
  function writeElement(language, elementId) {
    var newElement = document.createElement("span");
    if (language = "this") {
      newElement.innerHTML = "text for this";
    }
    else {
      newElement.innerHTML = "text for that";
    }
    var element = document.getElementById(elementId);
    element.appendChild(newElement);
  }
</script> 
```

**用法**

```
<span id="data1"></span>
<script type="text/javascript">
  writeElement("this", "data1")
</script> 
```

如果您可以支持 jQuery 并且想要一个示例，请添加评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T22:03:52.020

我认为解决这个问题的正确方法是解析 Accept-Language 标头，并在服务器端执行此操作。

但是在你被客户端脚本困住的情况下。假设您的内容被标记为这样

```
<script type="text/javascript">
if(cookie_this) { 
document.getElementById('esContent').style.display = 'block';
} else {
document.getElementById('enContent').style.display = 'block';
}
</script>

<div id="esContent" style="display:none">
Hola, mundo.
</div>

<div id="enContent" style="display:none">
Hello, world.
</div> 
```

对于启用 CSS 和禁用 JavaScript 的人来说，这不会降级。其他方法可能包括使用 Ajax 根据 cookie 值加载内容（您可以为此使用 jQuery）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T22:34:45.533

如果您只想要一个可见的 URL，但可以在服务器上托管多个页面，您也可以尝试 XHR。我使用[jQuery](http://www.jquery.com)是因为我最熟悉它，尽管它可以单独在 javascript 中实现：

```
<html>
 <head>
  <script type="text/javascript" src="path/to/jquery.js"> </script>
  <script type="text/javascript">
   $(document).ready(function () {
       if (cookie_this) {
           $("body").load("onelanguage.html body");
       } else {
           $("body").load("otherlanguage.html body");
       }
   });
  </script>
 </head>
 <body>
 </body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T21:48:54.520

检测应该在服务器上（最好基于客户端发送的[Accept-Language](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4)标头），并且您应该发送一个已经本地化的静态文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T21:50:13.083

**这不符合原始问题的（已编辑）标准，但无论如何都可能有用。**

使用服务器端脚本。您正在寻找的内容可以在 PHP 中轻松完成。您可能需要基于语言的文档层次结构，并且会在给定的情况下进行查找。例如，目录树：

```
/en/
/en/page1.html
/en/page2.html
/es/
/es/page1.html
/es/page2.html 
```

在 PHP 中，它很简单

```
$language = $_GET['lang'];
$page = $_GET['page'];
include($language . '/' . $page);
// URL is: /whatever.php?lang=LANGUAGE_HERE&page=PAGE_HERE 
```

但是，随之而来的是许多安全问题。清理您的输入并确保目录和文件存在。更完整的例子：

```
$contentRoot = './';      // CHANGE ME.  Do include trailing /.
$defaultLanguage = 'en';  // CHANGE ME.
$defaultPage = 'home';    // CHANGE ME.

if(isset($_GET['lang']))
    $language = $_GET['lang'];
else
    $language = substr($_SERVER['HTTP_ACCEPT_LANGUAGE'], 2);

if(isset($_GET['page']))
    $page = $_GET['page'];
else
    $page = $defaultPage;

$languageDir = basename($_GET['lang']) . '/';
$pageFile = basename($page) . '.html';

if(!file_exists($contentRoot . $languageDir) || !is_dir($contentRoot . $languageDir))
    $languageDir = $defaultLanguage;

$fullFileName = $contentRoot . $languageDir . $pageFile;

if(!file_exists($fullFileName) || !is_file($fullFileName) || !is_readable($fullFileName))
    $pageFile = $defaultPage;

readfile($fullFileName);
// Or, if you want to parse PHP in the file:
include($fullFileName); 
```

您可能还想使用`mod_rewrite`(Apache) 来允许 URL，例如`http://www.mysite.com/en/page1`. （请务必隐藏实际页面。）

```
// TODO mode_rewrite rules 
```

另一种方法是将上述层次结构放入文档根目录并直接分发 URL。然而，这给了你更少的权力（例如，模板更困难），你必须担心外部媒体被正确引用。

如果您正在寻找动态方法，请在客户端使用 Javascript 使用 Ajax 获取数据。这也是微不足道的，并且不需要动态服务器后端。我推荐使用 jQuery 之类的 Javascript 框架来尽可能简化此操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T21:54:38.720

在 JS 中没有很好的方法来做到这一点。最好的方法是使用非常简单的 PHP 代码。但是，如果你愿意，在 JS 中有一种方法——准备这样的页面：

*   一些具有不同语言版本的页面，例如`index_en.html`，`index_ru.html`

*   主页`index.html`，您有类似的代码

    ```
    if(cookie) windows.location.replace('index_en.html') else ... 
    ```

# windows - 提高生产力 | 我在重复什么命令？

> ID：648608
> 
> 赞同：1
> 
> 时间：2009-03-15T21:46:56.990
> 
> 标签：windows, developer-tools

我正在寻找一种程序来监视我在 Windows Vista/XP/2003 中的活动，让我知道我更频繁地访问哪些命令、快捷方式、网站等。

有了这些信息，我可以创建快捷方式、热键、别名等来提高生产力，随着时间的推移，我可以知道与其他日子相比我节省了多少时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T22:13:24.900

Leon Bambrick 的时间快照器非常有趣。可能并不完全是您想要的。[http://www.timesnapper.com/](http://www.timesnapper.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T22:17:26.077

有一个名为[Rescue Time](http://www.rescuetime.com/)的程序可以监控您的应用程序和网站使用情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T22:25:06.463

[世人寿](http://www.slifelabs.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T23:08:46.700

我有一个这样的程序，并且已经使用了多年。这叫*懒惰*。当我厌倦了再次做同样的事情时，我会编写一个程序或脚本来为我做这件事。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T23:02:31.613

不完全是记录您的活动的工具，但[Tasktop](http://tasktop.com/products/tour/)可能会帮助您实现您想要的。

我在 Eclipse 中使用 Mylyn，Tasktop 小麻烦来组织并让我专注于我的任务，这是一个很大的帮助。

# c# - 链表线程安全吗？

> ID：648609
> 
> 赞同：4
> 
> 时间：2009-03-15T21:47:47.097
> 
> 标签：c#, .net, multithreading

好吧，我在.net中写作，我有一个女巫列表，我只会添加项目，永远不会删除，它是一个链接列表，如果它不是最好的选择，我可以改变它，但无论如何，不​​使用任何锁定是否安全在这种情况下，当我知道该列表将永远不会以任何其他方式更改但将其添加到？（尝试添加到列表时会使用锁）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T21:58:08.493

不; 为了支持许多读者和一位作者（对 Jared 回复的评论），您可能需要查看`ReaderWriterLockSlim`. 作者需要独占访问权限；读者可以合作。这就是这样`ReaderWriterLockSlim`做的。还有`ReaderWriterLock`pre 3.5。

您将需要手动处理进入/退出等 - 最好通过 try/finally。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T21:51:06.637

不，这不安全。LinkedList 不是线程安全的类。LinkedList 唯一支持的多线程场景是多个阅读器

[http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)

# c++ - 调整 OpenGL 窗口的大小会导致它崩溃

> ID：648619
> 
> 赞同：4
> 
> 时间：2009-03-15T21:52:37.477
> 
> 标签：c++, opengl, graphics, glut

出于某种原因，当我调整 OpenGL 窗口的大小时，一切都崩溃了。图像失真，坐标不起作用，一切都崩溃了。我正在唱 Glut 来设置它。

```
//Code to setup glut
glutInitWindowSize(appWidth, appHeight);
glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA);
glutCreateWindow("Test Window");

//In drawing function
glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
glClear(GL_COLOR_BUFFER_BIT);

//Resize function
void resize(int w, int h)
{
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(0, w, h, 0);
} 
```

OpenGL 应用程序是严格的 2D 的。

这是它最初的样子：[http ://www.picgarage.net/images/Corre_53880_651.jpeg](http://www.picgarage.net/images/Corre_53880_651.jpeg)

这是调整大小后的样子：[http ://www.picgarage.net/images/wrong_53885_268.jpeg](http://www.picgarage.net/images/wrong_53885_268.jpeg)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-15T21:56:48.607

你不应该忘记挂钩 GLUT 'reshape' 事件：

```
glutReshapeFunc(resize); 
```

并重置您的视口：

```
void resize(int w, int h)
{
    glViewport(0, 0, width, height); //NEW
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(0, w, h, 0);
} 
```

透视投影必须考虑新的纵横比：

```
void resizeWindow(int width, int height)
{
    double asratio;

    if (height == 0) height = 1; //to avoid divide-by-zero

    asratio = width / (double) height;

    glViewport(0, 0, width, height); //adjust GL viewport

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(FOV, asratio, ZMIN, ZMAX); //adjust perspective
    glMatrixMode(GL_MODELVIEW);
} 
```

# python - 我如何确定 vim 缓冲区是否从 vim 的 python api 中列出或未列出？

> ID：648638
> 
> 赞同：2
> 
> 时间：2009-03-15T22:03:57.200
> 
> 标签：python, vim

对于一个工具，我需要计算所有仍然列出的 vim 缓冲区（有列出和未列出的缓冲区）

不幸`vim.buffers`的是，它包含所有缓冲区，并且似乎没有一个属性来确定缓冲区是列出还是未列出

我想做的vim命令是

```
:buffers 
```

不幸的是，vim python api的所有可能都在模拟

```
:buffers! 
```

但没有关于我们需要的列出/未列出的元数据

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T22:09:08.950

以下是仅使用 Vim 语言来管理它的方法。

```
function s:buffers_list()
    let result = []

    for buffer_number in range(1, bufnr('$'))
        if !buflisted(buffer_number)
            continue
        endif

        call add(result, buffer_number)
    endfor

    return result
endfunction 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-28T16:48:55.207

使用 Vim 的 python api：

```
listedBufs = []
for b in vim.buffers:
    listed = vim.eval('buflisted(bufnr("%s"))' % b.name)
    if int(listed) > 0:
        listedBufs.append(b) 
```

或者如果你不介意牺牲一些可读性：

```
listedBufs = [b for b in vim.buffers
              if int(vim.eval('buflisted(bufnr("%s"))' % b.name)) > 0] 
```

# internet-explorer - 确定 IE activex 控件何时重绘

> ID：648640
> 
> 赞同：0
> 
> 时间：2009-03-15T22:04:39.537
> 
> 标签：internet-explorer, delegates, events, pinvoke, repaint

我正在使用 spy++ 并注意到我嵌入在 Windows 窗体中的 IE 控件在重新绘制自身时会定期调用或发送 WM_PAINT。我试图弄清楚每次该控件发送 WM_PAINT 时如何在 C# 代码中执行 C# 方法。我知道此时的 pinvoke 足够危险。

提前致谢，

鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-15T22:40:51.573

您实际上并不需要 PInvoke 来执行此操作。正确的方法是使用子类化来处理特定的 Windows 消息。这是执行此操作的链接：

[使用 .Net 处理 Windows 消息](http://www2.sys-con.com/ITSG/virtualcd/Dotnet/archives/0112/hankins/index.html)

# html - 有人再为 Dublin Core 烦恼吗？

> ID：648641
> 
> 赞同：14
> 
> 时间：2009-03-15T22:04:50.753
> 
> 标签：html, metadata, dublin-core

正如问题所述，将 Dublin Core 元标记添加到您的 HTML 头部有什么意义吗？或者[sitemap.org](http://www.sitemap.org)删除了大部分的使用（尽管它只替换了一些标签）

我问这个问题是因为我访问的大多数网站似乎都没有在其源代码中使用 DC 元标记。

**我感兴趣的是我是否需要将它们用于一个主要用于开发人员的网站，但是讨论可以比这个类别更广泛**。

引用谷歌的话（从 2002 年开始）：

> “目前我们不信任元数据，因为我们害怕它被操纵”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T23:05:27.397

我宁愿说丰富元数据的时代还没有到来。事实上，像 RFD 这样的技术刚刚起步。蒂姆·伯纳斯-李（Tim Berners-Lee）——你知道，网络的发明者——最近在 TED 上谈到[了开放、链接数据的下一个网络](http://www.ted.com/talks/tim_berners_lee_on_the_next_web.html)。因此，都柏林核心和其他元数据格式绝不会出现。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T22:16:15.563

都柏林核心在某些行业领域仍然非常重要。在英国，政府组织使用 DC 提供对标签的标准化访问。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-17T13:04:59.927

`META`标签不是您可以放置​​ DC 元数据的唯一位置。[您可以使用RDFa](http://www.w3.org/TR/xhtml-rdfa-primer/)将其更多地与 HTML 集成。

现在，至于扩散——嗯，它目前给予网站管理员的唯一激励是对出色工作的满意度，但**尚未**影响 SEO。一旦这种情况发生变化，您就会看到大量使用 RDF 和微格式标记的网站。它会来的。雅虎已经开始研究：http: [//ysearchblog.com/2008/03/13/the-yahoo-search-open-ecosystem/](http://ysearchblog.com/2008/03/13/the-yahoo-search-open-ecosystem/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-04T18:35:32.430

我在网上寻找有关都柏林核心的信息，如果搜索引擎使用它们，我偶然发现了学术论文“网络上的搜索引擎和资源发现：都柏林核心是影响因子吗？” 通过 Mehdi Safari：

[http://www.webology.ir/2005/v2n2/a13.html](http://www.webology.ir/2005/v2n2/a13.html)

引用他的结论部分：“发现使用都柏林核心元素并没有提高网页的检索排名”，并且“都柏林核心元数据作为一种众所周知的元数据模式，并未被搜索引擎广泛接受和使用设计师和蜘蛛在对网页进行排名时不会考虑其元素”。

这是在 2005 年，但我认为这仍然是正确的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T22:48:53.333

语义网的努力仍在进行中。我已经完成了一些使用[RDF 三元组](http://en.wikipedia.org/wiki/Resource_Description_Framework)的研究工作，包括都柏林核心......但没有接近商业化。

但是，作为万维网的一般组织原则？不要打扰。我的猜测是，[folksonomies](http://en.wikipedia.org/wiki/Folksonomy)将处理一些元数据管理，但站点标记将需要通过某种本体论推论来处理。我对 DC 和 RDF 的感觉与我对通用的全球开放[UDDI](http://en.wikipedia.org/wiki/UDDI)注册中心的感觉相同：好主意，但世界不是这样运作的。

知道 DC 标签是否会提高您的[Google 页面排名](http://en.wikipedia.org/wiki/Page_rank)（以及可靠性如何）会很有趣：这对许多人来说可能是一种强烈的激励！

# grails - Grails 中的 Config.groovy：grails.views.default.codec - 为什么是 base64？

> ID：648644
> 
> 赞同：1
> 
> 时间：2009-03-15T22:08:58.233
> 
> 标签：grails

Config.groovy 设置`grails.views.default.codec`指定用于编码数据的默认编解码器`${...}`。

此配置设置可以采用任何值`none`和。`html``base64`

我理解为什么将它们设置为`none`（不需要过滤）或`html`（以避免 XSS 攻击）的原因，但为什么有人愿意将其设置为 base64 编码？

请在适合将其设置为 时提供特定用例`base64`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T10:39:05.123

这很可能没有真正的用例。它应该只是说明您可以使用任何编解码器（捆绑的或您自己的）作为视图的默认编解码器。

# c# - 设置默认 waveIn 设备的记录电平

> ID：648646
> 
> 赞同：2
> 
> 时间：2009-03-15T22:10:21.910
> 
> 标签：c#, audio

我正在尝试使用`mixerGetLineInfo`和`mixerGetLineControls`函数来访问使用 waveIn 打开的默认录音设备的音量控制。我编写了可以成功枚举系统中所有源目标和控件的 C# 互操作代码，但是到目前为止，我还没有弄清楚哪个是与默认 waveIn 设备关联的控件。有没有人有一些示例代码可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T08:25:43.197

你可以使用：

```
int mixerId = -1;
int inputID = MmeMixerApi.WAVE_MAPPER; // = -1
int result = MmeMixerApi.mixerGetID(inputId, ref mixerId, MIXER_OBJECTFLAG.WAVEIN); 
```

可以通过 ID 为 -1 的波形映射器访问默认输入和输出设备。MixerGetID 将返回与该输入关联的混音器 ID。然后，您可以使用混音器 ID 来遍历控件。您仍然需要找到正确的源线路（例如麦克风、线路输入等）。为此，您可能需要查找具有特定 dwComponentType 的源代码行，例如 MIXERLINE_COMPONENTTYPE.SRC_MICROPHONE 或 MIXERLINE_COMPONENTTYPE.SRC_LINE。

# c++ - 在 C++ 中，类函数放在内存的哪个位置？

> ID：648647
> 
> 赞同：20
> 
> 时间：2009-03-15T22:10:44.360
> 
> 标签：c++, memory, dynamic

我试图通过创建大量对象来了解我会招致什么样的内存打击。我知道每个对象 - 在创建时 - 将在 HEAP 中为成员变量分配空间，并且我认为属于该类型对象的每个函数的所有代码都存在于内存中的代码段中 - 永久存在。

是对的吗？

因此，如果我在 C++ 中创建 100 个对象，我**可以估计**我将需要空间用于对象拥有的所有成员变量乘以 100（此处可能存在对齐问题），然后我需要在代码段中为单个副本留出空间该类型对象的每个成员函数的代码（不是 100 个代码副本）。

虚函数、多态性、继承是否以某种方式影响了这一点？

来自动态链接库的对象呢？我假设 dll 有自己的堆栈、堆、代码和数据段。

简单示例（可能在语法上不正确）：

```
// parent class
class Bar
{
public:
    Bar()  {};
    ~Bar() {};

    // pure virtual function
    virtual void doSomething() = 0;

protected:
    // a protected variable
    int mProtectedVar;
}

// our object class that we'll create multiple instances of
class Foo : public Bar
{
public:
    Foo()  {};
    ~Foo() {};

    // implement pure virtual function
    void doSomething()          { mPrivate = 0; }

    // a couple public functions
    int getPrivateVar()         { return mPrivate; }
    void setPrivateVar(int v)   { mPrivate = v; }

    // a couple public variables
    int mPublicVar;
    char mPublicVar2;

private:
    // a couple private variables
    int mPrivate;
    char mPrivateVar2;        
} 
```

大约 100 个动态分配的 Foo 类型的对象应该占用多少内存，包括代码和所有变量的空间？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-15T22:17:59.833

“每个对象 - 在创建时 - 将在 HEAP 中为成员变量分配空间”并不一定是真的。您创建的每个对象都会在某处为其成员变量占用一些非零空间，但在哪里取决于您如何分配对象本身。如果对象具有自动（堆栈）分配，那么它的数据成员也是如此。如果对象是在空闲存储（堆）上分配的，那么它的数据成员也是如此。毕竟，除了其数据成员之外，对象的分配是什么？

如果堆栈分配的对象包含一个指针或其他类型，然后用于在堆上分配，则无论对象本身是在哪里创建的，该分配都将在堆上进行。

对于具有虚函数的对象，每个对象都将分配一个 vtable 指针，就好像它是类中显式声明的数据成员一样。

至于成员函数，就其在可执行映像中的位置而言，它们的代码可能与自由函数代码没有什么不同。毕竟，成员函数基本上是一个以隐式“this”指针作为其第一个参数的自由函数。

继承不会改变任何事情。

我不确定你对 DLL 获得自己的堆栈是什么意思。DLL 不是程序，并且不需要堆栈（或堆），因为它分配的对象总是在具有自己的堆栈和堆的程序的上下文中分配。在 DLL 中会有代码（文本）和数据段确实是有道理的，尽管我不是在 Windows 上实现这些东西的专家（我假设你正在使用你的术语）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T22:21:52.897

代码存在于文本段中，基于类生成多少代码是相当复杂的。一个没有虚拟继承的无聊类表面上对于每个成员函数（包括那些在省略时隐式创建的函数，例如复制构造函数）只有一次在文本段中的代码。正如您所说，任何类实例的大小通常是成员变量的总大小。

然后，它变得有些复杂。有几个问题是...

*   编译器可以，如果它想要或被指示，`inline`编码。因此，即使它可能是一个简单的函数，但如果它在许多地方使用并选择用于内联，则可以生成大量代码（遍布整个程序代码）。
*   虚拟继承增加了多态每个成员的大小。VTABLE（虚拟表）使用虚拟方法与类的每个实例一起隐藏，包含运行时调度的信息。如果您有许多虚拟函数或多个（虚拟）继承，则此表可能会变得非常大。澄清：VTABLE 是每个类的，但指向 VTABLE 的指针存储在每个实例中（取决于对象的祖先类型结构）。
*   模板会导致代码膨胀。每次使用带有一组新模板参数的模板类都可以为每个成员生成全新的代码。现代编译器尝试尽可能多地折叠它，但这很难。
*   结构对齐/填充可能导致简单的类实例比您预期的要大，因为编译器会为目标体系结构填充结构。

编程时，使用`sizeof`运算符来确定对象大小 - 绝不是硬编码。在估计大型实例组的成本时，使用“成员变量大小的总和 + 一些 VTABLE（如果存在）”的粗略指标，不要过分担心代码的大小。稍后进行优化，如果任何不明显的问题重新变得有意义，我会感到相当惊讶。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T22:20:48.393

尽管这方面的某些方面取决于编译器供应商，但所有编译的代码都会进入大多数系统上称为`text`段的内存部分。这与堆和堆栈部分是分开的（第四部分，`data`，保存大多数常量）。实例化一个类的许多实例只会为它的实例变量产生运行时空间，而不是它的任何函数。如果您使用虚拟方法，您将获得额外的但很小的内存位，用于虚拟查找表（或使用其他概念的编译器的等价物），但其大小取决于虚拟方法乘以虚拟类的数量，并且与运行时的实例数量无关。

对于静态和动态链接的代码也是如此。实际代码都存在于一个`text`区域中。大多数操作系统实际上可以在多个应用程序之间共享 dll 代码，因此如果多个应用程序使用相同的 dll，则只有一个副本驻留在内存中，并且两个应用程序都可以使用它。显然，如果只有一个应用程序使用链接代码，那么共享内存不会带来额外的节省。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T22:21:36.533

您不能完全准确地说出一个类或 X 对象将在 RAM 中占用多少内存。

但是，要回答您的问题，您是正确的，代码只存在于一个地方，它永远不会“分配”。因此，代码是每个类的，并且无论您是否创建对象都存在。代码的大小由您的编译器决定，即使这样，编译器也经常被告知要优化代码大小，从而导致不同的结果。

虚函数也不例外，节省了虚方法表的（小）额外开销，这通常是每个类的。

关于 DLL 和其他库...根据代码的来源，规则没有什么不同，因此这不是内存使用的一个因素。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-03T07:53:53.427

上面给出的信息很有帮助，让我对 C++ 内存结构有了一些了解。但我想在这里补充的是，无论一个类中有多少个虚函数，每个类总是只有 1 个 VPTR 和 1 个 VTABLE。因为所有的VPTR都指向VTABLE，所以在有多个虚函数的情况下不需要一个以上的VPTR。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T22:22:23.067

在您提供的基本情况下，您的估计是准确的。每个对象还有一个 vtable，其中包含每个虚函数的指针，因此每个虚函数都需要一个额外的指针内存。

来自任何基类的成员变量（和虚函数）也是类的一部分，因此包括它们。

就像在 c 中一样，您可以使用 sizeof(classname/datatype) 运算符来获取类的大小（以字节为单位）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T22:23:33.767

是的，没错，创建对象实例时不会重复代码。就虚函数而言，正确的函数调用是使用[vtable](http://en.wikipedia.org/wiki/Vtable)确定的，但这并不影响对象创建本身。

DLL（通常是共享/动态库）被内存映射到进程的内存空间。每次修改都作为写时复制 (COW) 进行：单个 DLL 仅加载一次到内存中，每次写入可变空间时都会创建该空间的副本（通常为页面大小）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-15T22:23:37.433

如果编译为 32 位。然后 sizeof(Bar) 应该产生 4。 Foo 应该添加 10 个字节（2 个整数 + 2 个字符）。

由于 Foo 是从 Bar 继承的。即至少 4 + 10 个字节 = 14 个字节。

GCC 具有用于打包结构的属性，因此没有填充。在这种情况下，100 个条目将占用 1400 字节 + 用于对齐分配的微小开销 + 一些内存管理开销。

如果未指定打包属性，则取决于编译器对齐方式。

但这并没有考虑 vtable 占用多少内存以及编译代码的大小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-15T22:28:04.943

很难准确回答您的问题，因为这取决于实现，但 32 位实现的近似值可能是：

```
int Bar::mProtectedVar;    // 4 bytes
int Foo::mPublicVar;        // 4 bytes
char Foo::mPublicVar2;     // 1 byte 
```

这里有所有的问题，最终的总数很可能是 12 个字节。您还将有一个 vptr - 比如说另外 4 个字节。因此，每个实例的数据总大小约为 16 个字节。无法说代码将占用多少空间，但您认为所有实例之间只有一个代码副本是正确的。

当你问

> 我假设 dll 有自己的堆栈、堆、代码和数据段。

答案是 DLL 中的数据和应用程序中的数据之间确实没有太大区别 - 基本上它们在它们之间共享所有内容，当你考虑它时必须如此 - 如果它们有不同的堆栈（例如）函数调用如何工作？

# c# - 如何将位写入文件？

> ID：648651
> 
> 赞同：4
> 
> 时间：2009-03-15T22:13:36.023
> 
> 标签：c#, .net, io, bits

如何使用 c#、.net 将位（而不是字节）写入文件？我很喜欢它。
**编辑**：我正在寻找一种不同的方式，将每 8 位写入一个字节

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T22:17:15.203

您一次可以写入的最小数据量是一个字节。

如果您需要写入单个位值。（例如需要 1 位标志、3 位整数和 4 位整数的二进制格式）；当您有一个完整的字节要写入时，您需要在内存中缓冲各个值并写入文件。（为了性能，缓冲更多并将更大的块写入文件是有意义的）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-15T22:18:53.280

1.  累积缓冲区中的位（单个字节可以称为“缓冲区”）
2.  添加位时，将缓冲区左移并使用 OR 将新位放在最低位置
3.  缓冲区已满后，将其附加到文件中

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-13T20:08:10.570

我做了类似的东西来模拟 BitsWriter。

```
 private BitArray bitBuffer = new BitArray(new byte[65536]);

    private int bitCount = 0;

    // Write one int. In my code, this is a byte
    public void write(int b)
    {
        BitArray bA = new BitArray((byte)b);
        int[] pattern = new int[8];
        writeBitArray(bA);            
    }

    // Write one bit. In my code, this is a binary value, and the amount of times
    public void write(int b, int len)
    {
        int[] pattern = new int[len];
        BitArray bA = new BitArray(len);
        for (int i = 0; i < len; i++)
        {
            bA.Set(i, (b == 1));                
        }

        writeBitArray(bA);
    }

    private void writeBitArray(BitArray bA)
    {
        for (int i = 0; i < bA.Length; i++)
        {
            bitBuffer.Set(bitCount + i, bA[i]);
            bitCount++;
        }

        if (bitCount % 8 == 0)
        {
            BitArray bitBufferWithLength = new BitArray(new byte[bitCount / 8]);                
            byte[] res = new byte[bitBuffer.Count / 8];               
            for (int i = 0; i < bitCount; i++)
            {
                bitBufferWithLength.Set(i, (bitBuffer[i]));
            }

            bitBuffer.CopyTo(res, 0);
            bitCount = 0;
            base.BaseStream.Write(res, 0, res.Length);                                                
        }           
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T22:16:16.640

您将不得不使用位移位或二进制算术，因为您一次只能写入一个字节，而不是单个位。

# flash - Flash是一个很好的技能吗？

> ID：648662
> 
> 赞同：0
> 
> 时间：2009-03-15T22:18:10.957
> 
> 标签：flash

我已经做了两年的网络程序员，感觉有些事情你不能“做好”，除非你使用闪存。我从来没有拿起闪光灯，因为我没有钱支付它。我最近发现有许多开源替代品，例如 open laszlo 和 flashdevelop，所以我承认选择它。

1) 作为 Web 开发人员，Flash 是一项很好的技能吗？2）你认为flash在未来会越来越远离网络吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T22:26:36.537

尽管这个问题根本无法回答（所有技能都很好，如果我知道将来会流行什么，我会比我富有得多）......

1.  SFlash 在网络上肯定很受欢迎，客户可能会想要它，而且弓上的弦不是坏事。
2.  我怀疑它的受欢迎程度会一直停留在它的位置上。HTML 5 等可能会给它带来一些压力，Silverlight 也是如此。我也不希望大规模放弃它，但我也看不到使用量的大幅上升。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T22:28:10.433

在我*看来*……我相信 Flash 的大部分用途并不需要它，而且我认为人们开始意识到纯 Javascript 的强大功能和灵活性。这得到了 jQuery 等库的帮助，使得执行通常会看到人们立即调用 Flash 设计人员的事情变得轻而易举。

关于您的问题第 2 部分...我认为 Flash 在未来将越来越少地成为网络的一部分，这纯粹是因为互联网的开放和标准的自然趋势。

如果我们必须观看 Flash/Silverlight/等，我个人不会有乐趣。在每个人再次意识到这一点之前，全力以赴 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T22:28:32.757

1）我认为这取决于你的野心是什么。如果您想主要在前端工作并使事情看起来很漂亮；Flash 无疑是适合您工具箱的技能。另一方面，如果您对在服务器端进行工作更感兴趣，我不会在闪存上投入大量时间。然而，与大多数事情一样，对所有事情都了解一点并没有什么坏处，因为它使整合事物变得更容易。

2) 我认为 Flash 还会存在一段时间，因为它已经很普遍了。如今，大多数计算机都安装了 Flash，因此如果您正在开发丰富的浏览器应用程序，Flash 将是最安全的选择。然而，这可能会随着时间的推移而改变，并且当今可用的 Flash 存在激烈的竞争 - 例如 Silverlight 或 Flex。就个人而言，我发现 Silverlight 更有吸引力（我是 .NET 人），但现在不会将它用于广泛的应用程序，因为许多用户不会安装运行时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T22:29:06.173

微软也在 Silverlight 方向上大力推动。我会考虑至少看看它，因为它不仅在开发社区中起飞，而且在企业中也很流行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T22:29:59.510

这些天我从事网络开发，我得出了同样的结论：如果我知道一点闪存（比如编写我自己的视频播放器，它实际上就像我期望的那样，并且发布了一个不错的 javascript 界面）。

然而，我已经测试过 Open Lazslo（并且很喜欢它），但我不认为它是一个典型的 Web 开发工具。当您必须以某种方式从浏览器中模拟桌面应用程序时（就 UI 而言），它会变得非常有用。所以我会把它放到公司内部网部门。

至于 Flash 的未来以及它与网络的关系，我不知道。但是，如果浏览器供应商恢复理智并接受由服务器明确授权的跨域 ajax 请求（如 flash 那样），那么我们将使用 flash 的唯一用途是用于重量级应用程序，如视频播放器和重动画游戏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T13:25:46.463

如果你有兴趣学习新的东西，你可以看看[Haxe](https://haxe.org)。它是一种有很多可能性的语言。它创建 flashmovies (flash 6 - 11)，生成服务器端代码 (Neko/PHP) 和 JavaScript。它是开源的，所以它也是免费的。

# java - 你如何在Java中重复调用一个线程？

> ID：648663
> 
> 赞同：4
> 
> 时间：2009-03-15T22:18:12.703
> 
> 标签：java, multithreading

我希望每 500 毫秒在后台执行一个线程。为此，我扩展了一个 Thread，实现了 ActionListener 并将我扩展的类放入一个 Timer。Timer 每 500 毫秒调用一次 run()。然而，当这个线程从 Internet 下载东西时，我的整个 Swing GUI 冻结了。我希望它在后台运行，而不会在等待 IO 完成时冻结 GUI。我也是下载器在我们等待 500 毫秒之前完成下载。

调用gogogo()来初始化整个过程：

```
public final class Downloader extends Thread implements ActionListener
{
public static void gogogo()
{
    t= new Downloader();
    new Timer(500, (ActionListener) t).start();

}

public void run() 
{
    doStuff(); //the code that i want repeatedly called
}

public void actionPerformed(ActionEvent e) 
{
    run();
}
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T22:33:44.710

只需启动线程一次，使其循环，然后进行`Thread.sleep(500L)`每次迭代。这可能比每 500 毫秒启动一个全新线程更有意义。如果可以避免，就没有理由产生相关费用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T22:31:01.627

尝试使用 java util timer 或 ScheduledExecutorService，而不是使用 swing 计时器。摆动计时器共享一个预先存在的计时器线程，这可能导致冻结。

java教程的推荐：

> 一般来说，我们建议使用 Swing 计时器而不是通用计时器来处理与 GUI 相关的任务，因为 Swing 计时器都共享相同的、预先存在的计时器线程，并且与 GUI 相关的任务会自动在事件调度线程上执行。但是，如果您不打算从计时器触摸 GUI，或者需要执行冗长的处理，则可以使用通用计时器

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T23:08:14.893

如果您的 GUI 冻结，那么您的冗长任务 (doStuff) 可能正在事件调度线程上运行。虽然它占用了该线程，但其他操作无法使用它。

如果您尝试重复运行任务，则最好使用 TimerTask 类

```
public class Downloader extends TimerTask {
    public void run() {
        doStuff();
    }
}

... elsewhere ...

Timer myTimer = new Timer();

public void gogogo() {
    myTimer.scheduleAtFixedRate(new Downloader(), 0, 500);
} 
```

这有点不同，因为您的任务将被安排为每 500 毫秒运行一次，而不是延迟 500 毫秒。完成后，只需使用 myTimer.cancel() 停止重复任务执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T22:31:52.530

您需要在每个计时器操作上启动线程。调用线程的 run() 方法不会启动线程。

```
public void actionPerformed(ActionEvent e) 
{
        //run();
Downloader t = new Downloader();
t.start();

} 
```

为 actionlistener 使用匿名类可能会更好。请原谅我的 java 语法，但我还没有验证它......

```
 new Timer(500, 
      new ActionListener(){
            public void actionPerformed(ActionEvent e) 
            {
               //run();
               Downloader t = new Downloader();
               t.start();

            }
          }).start(); 
```

或者没有计时器...

```
public static void gogogo()
{
        t= new Downloader();
        t.start();

}

public void run() 
{
    while(true){
        doStuff(); //the code that i want repeatedly called

        Thread.sleep(500);
    }
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-15T22:20:43.103

嗯，很可能您需要做的就是降低线程优先级，因此它不会占用您所有的资源。

# template-toolkit - 我可以重定向 TPAGE 的输出吗

> ID：648665
> 
> 赞同：0
> 
> 时间：2009-03-15T22:19:19.177
> 
> 标签：template-toolkit

我希望**tpage**将输出重定向到不同的文件。重定向过滤器似乎几乎可以满足我的要求，但是当我使用它时，我得到：

> 重定向错误 - 未设置 OUTPUT_PATH

我可以使用 tpage 设置 OUTPUT_PATH 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T07:27:58.263

目前这似乎是不可能的。您可以做的是[将此补丁](http://www.mail-archive.com/templates@template-toolkit.org/msg09511.html)应用于 tpage / tpage.bat，然后在命令行上指定 output_path，例如

```
tpage --output_path=DIR [files] 
```

# generics - 硬编码与通用编码：在哪里划清界限？

> ID：648672
> 
> 赞同：5
> 
> 时间：2009-03-15T22:22:08.887
> 
> 标签：generics, abstraction

我不完全确定如何措辞，但我会尝试。

假设您在程序的某些部分中有一些设置，您 80% 确信您将永远不必再次修改。你怎么知道在可变代码上画线？您知道将设置一直保存到用户定义的 XML 文件是多余的。但是，您也知道，稍后可能需要更改这些设置的可能性为 20%，因此在橡胶与道路相遇的地方对其进行编码也不是最佳选择。

我想我想问的是，你应该让你的程序容易改变抽象树多远？

许多示例之一是手动为网站编写 HTML 代码，而不是让程序自动生成它。直接编写 HTML 代码不会花费太多时间。编写程序以自动生成 HTML 代码需要更长的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T22:29:42.863

这是一个很好的问题，但没有绝对的答案：

正如爱因斯坦所说：

> 让事情尽可能简单，但不要简单。

简单是相对的。对设计中抽象层的数量做出最佳决定是伟大架构师的伟大之处。一个好的架构师应该总是评估特定的情况并做出最好的权衡。没有银弹。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T23:24:06.197

我试一试，我的理念如下：

1 - 保留一个配置文件和解析器类/函数，它们非常简单，尽可能简单，让您高枕无忧，无论何时需要它，您都可以得到它，而无需实例化一个可笑的过度膨胀的 XML 处理配置文件解析器。我的配置文件如下所示：

```
DBHostname -> XX.XX.XXX.XX
DBUsername -> foomonger
DBName -> fooDb
DBPassword -> xxxxx
ImageUploadsDir -> /uploads/images/
... 
```

我使用我的白痴朋友 ConfigHelper 生成的静态辅助方法（小型应用程序）或单例实例（大型 MVC 驱动的应用程序）从中提取我需要的东西，他太笨了，他不知道如何产生开销。

在我的平均工作日中，我多次遇到这种困境：我应该把它放在 config.txt 中还是应该让它成为一个类常量？我的回答是我只是不知道——直到很久以后。如果事实证明它需要放入配置文件中，那么没有什么能比一个体面的 IDE 更好了，它具有稳定的“在项目中查找和替换”实现以更改引用。

3 - 当开发涉及测试服务器然后部署到生产时，配置文件消除了应用程序部署的噩梦 - 没有真正实用的替代方案。在我理解的世界中，不同机器上的不同数据库实例具有不同的 IP。

> 许多示例之一是手动编写网站的 HTML 代码与让程序自动生成它

这是真的。虽然我们作为开发人员喜欢构建机器，但我们往往会浪费大量时间来构建机器来构建我们最初打算构建的机器。虽然这可能非常令人满意，但根据经验，我可以大胆地说，在*大多数*情况下，您拥有的机器越多，您必须支持的系统就越多，故障点就越多，您从企业主那里得到的打击就越多——而且这不好玩。此外，您往往会遇到中间 HTML 生成器无法生成所需输出的情况。那么你会怎么做，浪费时间修复生成器中的错误，浪费时间设计一个巫毒的解决方法，或者只是手写 HTML？这确实取决于特定情况，但我更喜欢后者。

有点咆哮，但希望它至少有助于回答你的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T23:03:40.677

在过去的四年里，这只老狗学会了 TDD 的新把戏。即使我没有时间做“真正的”TDD，我也会假装我做。

所以我**总是**写重复的代码。没关系，因为我**总是**在之后重构它。这是编写代码过程的一部分，而不是稍后再做的事情。由于我遵循了 TDD 并且只编写了必要的最少代码，并且由于我有自动化测试证明该代码有效，因此如果我发现重复，我可以放心地重构它，因为我知道我会再次运行我的测试在重构期间和之后。这将再次证明我没有破坏任何东西。

这样，我不会推测代码是否会被重用——在重用之前我从不*重构*。由于它是根据实例的需要在每个实例中创建的，因此我知道代码的调用者并没有因为使代码通用的愿望而扭曲。调用者，包括单元测试，都是为了满足他们的直接需求而编写的。单独的重构过程可以处理更广泛的不重复代码的需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T22:33:24.743

两点：

*   所有常量都应该是通用的，也就是说，永远不要硬编码幻数而不将其放入*描述性*常量中。
*   实现您实际需要的最低要求 - 对其进行硬编码，直到您将多次复制硬编码代码 - 在这种情况下，您应该开始使代码通用。（测试驱动开发在这里很棒）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T22:46:57.050

您的问题是针对实际代码设计的，而不是将变量放在配置文件中还是常量中。我同意关于这些方面的其他答案。

但是关于是否写通用代码...

以我的经验，如果您专门编写代码来处理手头的任务，您只会发现自己在将来的某个时候编写类似的代码。好吧，如果你真的只做一次任务，没关系。但我发现大多数时候情况并非如此。

如果您发现自己重复一项任务**，**那么您应该退后一步，考虑以一般方式自动化它需要什么。

还要检查是否有人还没有这样做。如果他们没有，请考虑发布您的代码，无论它多么小或多么粗糙。有人可能会免费为您改进它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T22:29:50.493

80% ? 硬编码还不够好，将其放入配置文件中。

100% ? 一个常数可能会。

# coldfusion - 您如何决定使用什么：UDF 或自定义标签？

> ID：648674
> 
> 赞同：3
> 
> 时间：2009-03-15T22:22:32.723
> 
> 标签：coldfusion, user-defined-functions, custom-tag

[WACK](http://forta.com/books/)说：

> 如果你觉得你需要有很多争论，可以考虑创建一个 CT。
> 
> ...
> 
> CT 比自定义函数更强大、更灵活。尝试将 UDF 用于简单的事情......将 CT 和组件用于更多涉及的过程，尤其是那些您可以将其视为离散动作而不是简单的“按摩”的过程

好的，但是您通常如何做出决定？了解现实生活中的实践和例子很有趣。

对我来说，当一个函数有许多不需要的参数时就会发生这种情况，所以我必须称它们为 myFunc(arg1="foo", arg2="bar")。有时`<cfmodule>`语法只是变得更具可读性，但并非总是如此。

其他原因是我不喜欢长的（比如说，超过 2 个代码屏幕）UDF。

但是所有这些想法都是非常主观的，这就是为什么我有兴趣阅读其他人的意见。也许有更好的规则？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T12:29:10.850

社区中可能有很多人会不同意我的观点，但这是我通常的看法。如果您需要做的事情涉及到屏幕的输出，并且如果将其“包装”在一些其他代码或文本周围是有意义的，那么可能需要一个自定义标签。在所有其他情况下，UDF 工作正常且通常更好。话虽如此，在将近 8 年的 CF 开发中，我真的从来没有遇到过自定义标签的充分理由。我并不是说原因不存在，但我会说它们很少见。

如果你有一个很长的 UDF，是否可以安全地假设这是你通过调用这个 UDF 输出到屏幕的东西（我的意思不是真的返回一个值）？如果可以的话，我会考虑将 UDF 分解成更小的更易于管理的部分，但就像你所暗示的那样，最终重要的是对你、你的团队和可能追随你的人来说，什么是最易读的。

更新：出于好奇，您指的是哪本书（版本和卷）以及哪一页？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T12:37:34.977

我记得，可以随时调用自定义标签，因为必须先定义 UDF，然后才能使用它们。这通常使自定义标签更容易。如果你有大量的 UDF 库，那么确保它们都被包含在内是很麻烦的，并且服务器解析它们可能会很困难（至少在过去）。

然而，UDF 可以以更紧凑的方式使用

```
<cfif myUdf(myVariable)> 
```

自定义标签的优点是它们可以很好地与您的标记配合使用。

```
<h1>Order Page</h1>
<cf_basket_nav>
  <ul>
  <cfloop ...>
    <li>
    <cf_basket_item item="#items[i]#">
    </li>
  </cfloop>
  </ul>
</cf_basket_nav> 
```

一般来说，现在我会有一个'utils' CFC，其中包含你的 UDF 的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T21:41:56.423

关于在 udfs 或 cfc 方法上使用自定义标签的一个考虑因素是，当您发现需要向子例程传递一组子项时，可以使用嵌套自定义标签将子自定义标签及其元素关联到父自定义标签. 这使您可以编写易于阅读的非常干净的编码：

```
<cfmenubar ... >
  <cfloop array="menuitems" ...>
    <cfmenubaritem url="#i.url#">
      #i.label#
    </cfmenubaritem>
  </cfloop>
</cfmenubar> 
```

是的，是的，我知道我们有更好的 dhtml 内容，例如菜单和选项卡，这只是为了指出一个示例。您可以在自定义标签中使用 cfassociate 将属性“传递”给父自定义标签，然后在 executionmode="end" 中访问关联属性数组中所有动态生成的子项。在此示例中，您将在此处循环并将菜单输出到屏幕。

另外，正如另一位评论的那样，允许你做一些聪明的事情......我特别使用的一件事是我设置了 prefix="" 然后我基本上可以强制简单的 html 标签（如 <a> 标签）被踢在运行时通过自定义标签处理程序 - 因此 html 标签在运行时变得智能......我这样做是为了分析 href 和目标属性并决定是否要显示 pdf 图标（或其他 mime 类型图标）下一个到链接......它很漂亮！这在内容管理系统中特别有用，或者当 7 有 html 开发人员使用 Dreamweaver 或做出贡献时，您希望他们的标签触发智能冷融合标签，而不需要他们在标准 html 之外做任何事情 - 编辑器不知道任何区别，他们不需要进入“代码”视图以创建一些相当强大的功能。

最后，在自定义标签中，您可以选择抑制输出（或使用缓存），因此这对于环绕动态生成的 html 块非常有用...在执行模式 EQ“结束”模式下访问 thistag.generatedcontent 变量

不要把婴儿和洗澡水一起扔在这个上面……我同意它们的使用频率要低得多，因为我们有 cfcs，但是自定义标签中仍然有一些强大的功能……我通常在每个应用程序中都有一个或 2 个（和至少几十个 cfcs)

乔恩

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T19:51:17.743

Jeremy 指出了有用的选项：通过 CT 包装 HTML。但是这个功能似乎很少使用。无论如何，这对CT来说是一个加分项。

我还认为我更喜欢函数，因为我喜欢 cfscript 编码。有几次我不得不将遗留 CT 包装到 UDF 中，以便能够在完全 cfscript-ed 页面上使用它。这是 UDF 的一个优点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-27T22:11:41.687

不知道为什么我会陷入这种模式，但一般来说，我对任何输出 HTML 和 UDF 的东西都使用自定义标签（总是使用 cfmodule）来处理任何只返回简单数据/对象的东西。我意识到 UDF 也可以输出，但我不喜欢我的函数有任何副作用，这感觉就像一个。出于类似的原因，我现在在以前使用 cfinclude 的任何地方使用自定义标签，因为它们提供数据封装。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T00:09:05.450

`cfmodule`对功能没有优势；`cfinvoke`工作原理一样。

当然，`cfimport`您可以启用一个漂亮整洁的命名空间 CT 语法 - 这是自定义标签很好的时候：当使用清晰的打开/关闭构造时，或者如果嵌套逻辑很重要。

对于其他一切，尤其是在返回结果时，函数更容易处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-22T00:35:57.830

简单的可重用代码可以进入 UDF。这可能包括字符串格式化、数据结构操作等。

对于比这更复杂的事情，我会考虑使用 CFC 而不是自定义标签。您将能够在 OO 模型中编写更简洁的代码。如果您想为更习惯使用标签的人提供易用性，您始终可以使用自定义标签将逻辑包装在 CFC 中。

# python - 嵌套/多个列表推导或生成器表达式的用例。什么时候更优雅？

> ID：648675
> 
> 赞同：14
> 
> 时间：2009-03-15T22:22:52.380
> 
> 标签：python, list-comprehension, generator-expression

我有时会看到这样的事情：

```
(k for k in (j for j in (i for i in xrange(10)))) 
```

现在这真的让我的大脑弯曲，我宁愿它不以这种方式呈现。

有没有使用这些嵌套表达式的用例或示例，它比嵌套循环更优雅、更易读？

**编辑：**感谢您提供简化此方法的示例。这实际上不是我要求的，我想知道是否有任何时候它很优雅。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-16T00:39:51.147

检查[PEP 202](http://www.python.org/dev/peps/pep-0202/)，这是将列表推导语法引入该语言的地方。

为了理解你的例子，Guido 自己有一个简单的规则：

*   形式 [... for x... for y...] 嵌套，最后一个索引变化最快，就像嵌套 for 循环一样。

同样来自 PEP 202，它可以回答您的问题：

```
基本原理
    列表推导式提供了一种更简洁的方式来创建列表
    map() 和 filter() 和/或嵌套循环的情况
    目前正在使用。

```

如果你有这样的情况，你会发现它更优雅。但是，恕我直言，在您的代码中，多个嵌套列表推导式可能不如嵌套 for 循环清晰，因为`for`循环很容易在视觉上解析。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-15T22:41:50.883

如果您担心一行太复杂，您可以拆分它：

```
(k for k in 
    (j for j in 
        (i for i in xrange(10)))) 
```

我总是发现在 Python 中的续行看起来有点奇怪，但这确实可以更容易地看到每个续行在循环的内容。由于额外的分配/查找不会造成或破坏任何东西，你也可以这样写：

```
gen1 = (i for i in xrange(10))
gen2 = (j for j in gen1)
gen3 = (k for k in gen2) 
```

在实践中，我认为我从来没有嵌套过超过 2 层的理解，在那时它仍然很容易理解。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-15T22:41:06.987

在您的示例中，我可能会将其写为：

```
foos = (i for i in xrange(10))
bars = (j for j in foos)
bazs = (k for k in bars) 
```

鉴于更具描述性的名称，我认为这可能会很清楚，而且我无法想象会有任何可衡量的性能差异。

也许您正在考虑更多的表达方式，例如：

```
(x for x in xs for xs in ys for ys in lst) 
```

——实际上，这甚至是无效的。你必须把东西放在另一个顺序：

```
(x for ys in lst for xs in ys for x in xs) 
```

我可能会把它写成扁平化列表的一种快速方法，但总的来说，我认为您是这样写的：通过键入更少的内容节省的时间通常与您花费在正确生成生成器表达式上的额外时间相平衡。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-15T22:40:38.297

由于它们是生成器表达式，因此您可以将每个表达式绑定到它自己的名称，以使其更具可读性，而不会改变性能。将其更改为嵌套循环可能会损害性能。

```
irange = (i for i in xrange(10))
jrange = (j for j in irange)
krange = (k for k in jrange) 
```

选择哪个并不重要，我认为多行示例通常更具可读性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-24T22:38:46.237

警告：优雅部分是品味问题。

列表推导永远不会比相应的扩展 for 循环更*清晰。*For 循环也比列表推导更*强大。*那么为什么要使用它们呢？

列表推导是**简洁**的——它们允许你在一行中做一些事情。

使用列表推导式的时机是当您需要某个列表时，它可以相当容易地动态创建，并且您不希望或不需要中间对象。当您需要将当前范围内的一些对象打包成一个可以输入函数的对象时，可能会发生这种情况，如下所示：

```
list1 = ['foo', 'bar']
list2 = ['-ness', '-ity']
return filterRealWords([str1+str2 for str1 in list1 for str2 in list2]) 
```

这段代码的可读性与扩展版本差不多，但要短得多。它避免了创建/命名在当前范围内仅使用一次的对象，这可以说是更优雅。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T12:38:54.460

表达方式：

```
(k for k in (j for j in (i for i in xrange(10)))) 
```

相当于：

```
(i for i in xrange(10)) 
```

这几乎是一样的：

```
xrange(10) 
```

最后一个变体比第一个变体更优雅。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-27T03:34:58.673

我发现它在你有这样的代码的情况下是有用和优雅的：

```
output = []
for item in list:
    if item >= 1:
        new = item += 1
        output.append(new) 
```

你可以把它做成这样的单行：

```
output = [item += 1 for item in list if item >= 1] 
```

# python - 在 Python 中打印出函数参数列表

> ID：648679
> 
> 赞同：4
> 
> 时间：2009-03-15T22:24:37.353
> 
> 标签：python

有没有办法打印出函数的参数列表？例如：

```
def func(a, b, c):
  pass

print_func_parametes(func) 
```

这将产生类似的东西：

```
["a", "b", "c"] 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-15T22:27:58.047

使用检查模块。

```
>>> import inspect
>>> inspect.getargspec(func)
(['a', 'b', 'c'], None, None, None) 
```

返回的元组的第一部分是您要查找的内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T22:31:48.210

阅读源代码。严重地。Python 程序和库作为源提供。你可以阅读源码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T01:03:58.203

您也可以尝试使用内置`help()`函数，它不仅会为您提供命名参数的列表，还会提供有关您`func()`是否提供了文档字符串的描述：

```
>>> def func(a, b, c):
...     """do x to a,b,c and return the result"""
...     pass
... 
>>> help(func) 
```

给你

```

模块 __main__ 中函数 func 的帮助：

函数（a，b，c）
    对 a,b,c 执行 x 并返回结果

```

大多数模块都提供了至少某种内置文档。

# java - 我可以停止 JTree 缓存节点（在文件系统树中）吗？

> ID：648684
> 
> 赞同：0
> 
> 时间：2009-03-15T22:26:05.150
> 
> 标签：java, filesystems, jtree

我有一个用于文件系统中目录的 JTree 实现。我遇到的问题是，当一个目录被删除或重命名时，树仍然显示它的父目录。扩展节点后，父树似乎不会因任何更改而更新。

我写的模型没有缓存（我已经注释掉了它确实有什么有限的缓存）——就像 JTree 本身已经缓存了节点一样。

代码（模型是嵌套子类）：

```
public class FileSystemTree
extends JTree
{

// *****************************************************************************
// INSTANCE CREATE/DELETE
// *****************************************************************************

public FileSystemTree() {
    this(new Model(null,null,null));
    }

public FileSystemTree(String startPath) {
    this(new Model(startPath,null,null));
    }

public FileSystemTree(FileSelector inc, FileSelector exc) {
    this(new Model(null,inc,exc));
    }

public FileSystemTree(String startPath, FileSelector inc, FileSelector exc) {
    this(new Model(startPath,inc,exc));
    }

private FileSystemTree(Model model) {
    super(model);

    //setLargeModel(true);
    setRootVisible(false);
    setShowsRootHandles(true);
    putClientProperty("JTree.lineStyle","Angled");
    }

// *****************************************************************************
// INSTANCE METHODS - ACCESSORS
// *****************************************************************************

public Object getRoot() {
    return getModel().getRoot();
    }

// *****************************************************************************
// INSTANCE METHODS
// *****************************************************************************

public String convertValueToText(Object value,boolean selected,boolean expanded,boolean leaf,int row,boolean hasFocus) {
    File                                fil=(File)value;

    return (fil.getName().length()!=0 ? fil.getName() : fil.getPath());
    }

// *****************************************************************************
// STATIC NESTED CLASSES - SUPPORTING MODEL
// *****************************************************************************

    static class Model
    extends Object
    implements TreeModel, FilenameFilter
    {

    private File                        root;                                   // tree root
    //ivate Map                         cache;                                  // caches child counts for directories
    private File[]                      fsRoots;                                // copy of file system roots
    private FileSelector                include;                                // inclusion selector
    private FileSelector                exclude;                                // exclusion selector
    private java.util.List              listeners=new ArrayList();

    public Model(String roo, FileSelector inc, FileSelector exc) {
        super();

        root=(roo==null ? DRIVES : new File(roo));
        //cache=new HashMap();
        fsRoots=(root==DRIVES ? rootList() : null);
        include=inc;
        exclude=exc;
        }

    // *****************************************************************************
    // METHODS - MODEL
    // *****************************************************************************

    public Object getRoot() {
        return root;
        }

    public Object getChild(Object parent, int index) {
        File                            dir=(File)parent;

        if(dir==DRIVES) {
            File[]   chl=fsRoots; //rootList();
            return (index<chl.length ? chl[index] : null);
            }
        else {
            String[] chl=dirList(dir);
            return (index<chl.length ? new File(dir,chl[index]) : null);
            }
        }

    public int getChildCount(Object parent) {
        File                            dir=(File)parent;
        //Integer                         cch=(Integer)cache.get(dir);

        //if(cch!=null) {
        //    return cch.intValue();
        //    }

        if(dir==DRIVES) {
            return fsRoots.length; //rootList().length;
            }
        else if(dir.isDirectory()) {
            return dirList(dir).length;
            }
        else {
            return 0;
            }
        }

    public boolean isLeaf(Object node) {
        return((File)node).isFile();
        }

    public void valueForPathChanged(TreePath path, Object newValue) {
        }

    public int getIndexOfChild(Object parent, Object child) {
        File                            dir=(File)parent;
        File                            fse=(File)child;

        if(dir==DRIVES) {
            File[] ca=fsRoots; //rootList();
            for(int xa=0; xa<ca.length; xa++) {
                if(fse.equals(ca[xa])) { return xa; }
                }
            }
        else {
            String[] ca=dirList(dir);
            for(int xa=0; xa<ca.length; ++xa) {
                if(fse.getName().equals(ca[xa])) { return xa; }
                }
            }
        return -1;
        }

     private File[] rootList() {
        File[]                          lst=File.listRoots();

        if(lst==null) { lst=new File[0]; }
        //cache.put(DRIVES,new Integer(lst.length));
        return lst;
        }

     private String[] dirList(File dir) {
        String[]                        lst=dir.list(this);

        if(lst==null) { lst=new String[0]; }
        //cache.put(dir,new Integer(lst.length));
        return lst;
        }

    // *****************************************************************************
    // METHODS - FILENAME FILTER
    // *****************************************************************************

    public boolean accept(File dir, String nam)  {
        return ((include==null || include.accept(dir,nam)) && (exclude==null || !exclude.accept(dir,nam)));
        }

    // *****************************************************************************
    // METHODS - LISTENER
    // *****************************************************************************

    public void addTreeModelListener(TreeModelListener listener) {
        if(listener != null && !listeners.contains(listener)) {
            listeners.add(listener);
            }
        }

    public void removeTreeModelListener(TreeModelListener listener) {
        if(listener != null) {
            listeners.remove(listener);
            }
        }

    public void fireTreeNodesChanged(TreeModelEvent evt) {
        Iterator                        itr=listeners.iterator();

        while(itr.hasNext()) {
            TreeModelListener listener=(TreeModelListener)itr.next();
            listener.treeNodesChanged(evt);
            }
        }

    public void fireTreeNodesInserted(TreeModelEvent evt) {
        Iterator                        itr=listeners.iterator();

        while(itr.hasNext()) {
            TreeModelListener listener=(TreeModelListener)itr.next();
            listener.treeNodesInserted(evt);
            }
        }

    public void fireTreeNodesRemoved(TreeModelEvent evt) {
        Iterator                        itr=listeners.iterator();

        while(itr.hasNext()) {
            TreeModelListener listener=(TreeModelListener)itr.next();
            listener.treeNodesRemoved(evt);
            }
        }

    public void fireTreeStructureChanged(TreeModelEvent evt) {
        Iterator                        itr=listeners.iterator();

        while(itr.hasNext()) {
            TreeModelListener listener=(TreeModelListener)itr.next();
            listener.treeStructureChanged(evt);
            }
        }
    } // END INNER CLASS

// *****************************************************************************
// STATIC PROPERTIES
// *****************************************************************************

static private final File               DRIVES=new File("*DRIVES");             // marker for listing file system drives

} // END PUBLIC CLASS 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T23:52:17.533

该模型负责通知侦听器树结构中的任何修改。如果没有这样的通知，树将不会自行刷新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T23:05:15.180

如果您检测到目录已更改，您可以编写一些后台线程来查找文件系统中的更改并触发一些模型修改事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T00:44:30.760

Without seeing the code for the Model, are you sure it is being called, such as the getChild method?

# c# - C# DTO 和 LINQ2SQL

> ID：648685
> 
> 赞同：1
> 
> 时间：2009-03-15T22:26:13.900
> 
> 标签：c#, linq-to-sql, dto

这是我的第一个问题，要温柔:)。我正在从事具有某种分布式架构的项目。我正在尝试执行以下操作：

1.  我有一个使用**LINQ2SQL的****数据访问层**

***   我有一个**服务层**，它是数据访问层的代理。

    *   我有一个为实体调用服务层的业务层**。**

    问题是如何将这些 LINQ2SQL 实体转移到我的业务层？

    *   我想修改业务层上的这些对象，并与服务层一起返回并将它们重新转换为 LINQ2SQL 实体以将更改保留在数据库中。

    如果我要求一些不可能的东西，我很抱歉，但我试图找出最好的方法，但我自己无法获得一些聪明的东西：）

    最好的祝福！** 

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T22:56:03.643

在我看来，您有 2 个不同的上下文，即 BusinessLogic 上下文和数据访问域。您可能需要一个转换器/上下文映射器来从一个转换到另一个，反之亦然。

公共类 ContextMapper { public BusinessLogic.Customer Convert(DataAccess.Customer customer) {

} 公共 DataAccess.Customer 转换（BusinessLogic.Customer 客户）{

}

如果你愿意，你也可以把这些写成扩展方法

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T23:08:27.857

听起来您需要 NHibernate 或其他更高级的 ORM。

# c# - 将项目从一个数组移动到另一个数组的优雅技术

> ID：648692
> 
> 赞同：0
> 
> 时间：2009-03-15T22:28:17.000
> 
> 标签：c#, arrays, pass-by-reference

背景：纸牌游戏；我想以一种干净的方式将牌组中的牌发给游戏中的每个玩家。

这就是我的想法：

```
public static CardGame.IGame DealAll(this CardGame.IGame objThis, CardGame.Card[] cards)
    {
        if (objThis.Players.Length > 0)
        {
            for (int i = 0; i < cards.Length; i++)
            {
                objThis.Deck.MoveTo(cards[i], objThis.CurrentPlayer.Hand);

                objThis.AdvancePlayer();
            }
        }

        return objThis;
    }

public static Card[] MoveTo(this Card[] objThis, Card card, Card[] cards)
    {
        List<Card> lstCards = cards.ToList();
        List<Card> lstThis = objThis.ToList();

        lstThis.Remove(card);
        lstCards.Add(card);

        objThis = lstThis.ToArray();
        cards = lstCards.ToArray();

        return cards;
    } 
```

当然，您可以看到参考问题。使用 ref 关键字会导致一些看起来不太好看的代码，但这可能是不可避免的。有什么建议么？

我更喜欢一种足够灵活的解决方案来处理其他“传牌”情况（玩家将牌打到牌堆中，将牌从牌堆移到“垃圾”牌组等）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T22:40:04.990

我认为，这对 . 来说是一个糟糕的情况`Arrays`，它通常不是为了重复添加和删除而设计的。此外，我不会将此作为扩展方法，因为它在您的应用程序中的几个选定位置之外没有相关性。

考虑只使用 List 并拥有一个负责移动的类方法。

```
public class CardDealer {
...
  private List<Card> _deck;

  // Put the card [c] into [hand], and remove it from the deck.
  public void Deal(List<Card> hand, Card c) {
    _deck.Remove(c);
    hand.Add(c);
  }
} 
```

评论者建议一副牌可能更好地建模为一个队列，这是一个合理的观点，取决于你是否只能从牌组顶部拿牌。如果确实如此，请考虑以下情况：

```
public class CardDealer {
...
  private Queue<Card> _deck;

  // Put the top card of the deck into the specified hand.
  public void Deal(List<Card> hand) {
    // Deck is a Queue now. No need to specify which card to take.
    Card c = _deck.Dequeue(); 
    hand.Add(c);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T22:38:21.673

嗯，一个简单的方法是首先不使用数组。从一开始就使用列表，您不需要重新分配等 - 只需从牌组中移除并添加到手牌中。不过，您可能需要考虑将 a`Queue<T>`用于甲板。

更实用的方法是使用不可变集合和 ref 参数，但如果没有一些好的不可变集合类在你身后，这并不是非常实用。（它们可用，但未内置到框架中。）

你为什么将卡片数组传递给方法呢？它不应该只处理甲板上的所有东西吗？在这一点上更容易写：

```
foreach (Card card in deck)
{
    CurrentPlayer.Hand.Add(card);
    AdvancePlayer();
}
deck.Clear(); 
```

（顺便说一句，我不确定你为什么在这里使用扩展方法。这看起来更适合作为实例方法。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T23:10:54.417

也许是这样的？

```
interface ICardPile
{
    ICollection<Card> Cards
    {
        get;
    }
}

interface IOrderedCardPile : ICardPile // FIXME Better name.
{
}

class Deck : ICardPile
{
    private Stack<Card> _cards = new Stack<Card>();

    ICollection<Card> Cards
    {
        get
        {
            return _cards;
        }
    }

    public Deck()
    {
        // TODO Fill deck.
    }

    public void DealCardsTo(IEnumerable<ICardPile> piles, int cardCount)
    {
        for(int i = 0; i < cardCount; ++i)
        {
            foreach(var pile in piles)
                Cards.MoveSomeTo(piles, 1);
        }
    }
}

class Hand : IOrderedCardPile
{
    private HashSet<Card> _cards = new HashSet<Card>();

    ICollection<Card> Cards
    {
        get
        {
            return _cards;
        }
    }
} 
```

* * *

```
// Extension methods
static void MoveSomeTo(this ICardPile pile, ICardPile other, int count)
{
    // Removes cards from the end of pile and puts them at the end of other.

    foreach(Card card in pile.Cards.Reverse().Take(count))
    {
        other.Add(card);
    }

    pile.Cards = pile.Cards.Take(count);
}

static void MoveCardTo(this IOrderedCardPile pile, ICardPile other, Card card)
{
    // Removes card from pile and puts it at the end of other.
    pile.Remove(card);
    other.Add(card);
} 
```

* * *

```
// Examples
Deck deck;
DiscardPile discard;
var hands = new Hand[4];

deck.DealCardsTo(hands, 7);

// Discard all aces.
forach(var hand in hands)
{
    foreach(var card in hand.Cards.Where(card => card.Number == Card.SomeEnum.Ace))
        hand.MoveCardTo(discard, card);
} 
```

# windows - 如何在本地（在我的开发 PC 上）运行 .ASP（ASP 经典）页面以进行测试等？

> ID：648694
> 
> 赞同：1
> 
> 时间：2009-03-15T22:28:37.623
> 
> 标签：windows, asp-classic

我正在处理一些旧的 .asp 页面。我主要做 VB 开发，所以我是 .ASP 的新手。

如何在本地运行这些页面进行测试？

我正在运行 Windows XP Home SP2。

我猜我需要安装本地服务器等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T22:32:27.723

是的，您将需要一个本地服务器。但是，IIS 不会安装在 XP Home 上。但像大多数事情一样，有解决方法。

[在 XP 主页上安装 IIS](http://adamv.com/dev/articles/iis-on-xp-home/ "在 XP Home 上安装 IIS")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T22:33:18.003

您需要在本地安装 IIS 来测试 ASP。IIS 是 XP Pro 的一部分，但不是 XP Home 的一部分。

所以正式你将需要至少升级到 Pro。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T15:59:06.083

还有一些其他服务器，从免费到非免费，让您测试您的 ASP 代码。我听说过但没用过 Baby Web Server： http: [//www.pablosoftwaresolutions.com/html/baby_web_server.html](http://www.pablosoftwaresolutions.com/html/baby_web_server.html)

# c# - 有没有办法在 Windows 窗体中延迟事件处理程序（比如 1 秒）

> ID：648700
> 
> 赞同：13
> 
> 时间：2009-03-15T22:30:11.910
> 
> 标签：c#, .net, winforms, events

我需要能够延迟某些控件（如按钮）的事件处理程序，例如在实际事件（例如单击事件）的 1 秒后触发。.net 框架可以做到这一点吗？

我使用计时器并从计时器的滴答事件中调用我的代码，如下所示，但我不确定这是否是最好的方法！

```
void onButtonClick( ..)
{
   timer1.Enabled = true;
}

void onTimerTick( ..)
{
   timer.Enabled = false; 

   CallMyCodeNow();
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-16T00:38:18.250

也许您可以创建一个创建计时器的方法？

```
void onButtonClick(object sender, EventArgs e)
{
    Delay(1000, (o,a) => MessageBox.Show("Test"));
}

static void Delay(int ms, EventHandler action)
{
    var tmp = new Timer {Interval = ms};
    tmp.Tick += new EventHandler((o, e) => tmp.Enabled = false);
    tmp.Tick += action;
    tmp.Enabled = true;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-15T22:32:50.173

在回答您的问题之前，刚刚阅读了主要问题页面上的摘要部分，计时器正是我要建议的。

这对我来说看起来很干净。这意味着如果需要，您可以轻松地“取消”延迟事件，例如再次禁用计时器。它还在 UI 线程中执行所有操作（但没有重入），这使得生活比其他替代方案更简单。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-16T02:56:53.157

如果您只为一个控件执行此操作，则计时器方法可以正常工作。支持多种控件和事件类型的更强大的方法如下所示：

```
class Event
{
   public DateTime StartTime { get; set; }
   public Action Method { get; set; }

   public Event(Action method)
   {
      Method = method;
      StartTime = DateTime.Now + TimeSpan.FromSeconds(1);
   }
} 
```

在您的表单中维护 a`Queue<Event>`并让需要延迟的 UI 事件将它们添加到队列中，例如：

```
void onButtonClick( ..)
{
   EventQueue.Enqueue(new Event(MethodToCall));
} 
```

让您的计时器每秒滴答 10 次左右，并使其 Tick 事件处理程序如下所示：

```
void onTimerTick()
{
   if (EventQueue.Any() && EventQueue.First().StartTime >= DateTime.Now)
   {
      Event e = EventQueue.Dequeue();
      e.Method;
   }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-03-18T06:07:10.790

我的解决方案使用 System.Threading.Timer：

```
public static class ExecuteWithDelay
{
    class TimerState
    {
        public Timer Timer;
    }

    public static Timer Do(Action action, int dueTime)
    {
        var state = new TimerState();
        state.Timer = new Timer(o =>
        {
            action();
            lock (o) // The locking should prevent the timer callback from trying to free the timer prior to the Timer field having been set.
            {
                ((TimerState)o).Timer.Dispose();
            }
        }, state, dueTime, -1);
        return state.Timer;
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-03-31T15:10:54.427

对于那些仅限于 .NET 2.0 的用户，这里是 Bengt 有用的解决方案的另一种看法：

```
/// <summary>
/// Executes the specified method in a delayed context by utilizing
/// a temporary timer.
/// </summary>
/// <param name="millisecondsToDelay">The milliseconds to delay.</param>
/// <param name="methodToExecute">The method to execute.</param>
public static void DelayedExecute(int millisecondsToDelay, MethodInvoker methodToExecute)
{
    Timer timer = new Timer();
    timer.Interval = millisecondsToDelay;
    timer.Tick += delegate
                      {
                          // This will be executed on a single (UI) thread, so lock is not necessary
                          // but multiple ticks may have been queued, so check for enabled.
                          if (timer.Enabled)
                          {
                              timer.Stop();

                              methodToExecute.Invoke();

                              timer.Dispose();
                          }
                      };

    timer.Start();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-12T02:44:26.307

使用反应式扩展：

一、安装nuget包

```
PM> Install-Package Rx-Main 
```

代码：

```
 private void CallMyCodeNow()
    {
        label1.Text = "reactivated!";
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        var o = Observable.FromEventPattern<EventHandler, EventArgs>(
            handler => button1.Click += handler
            , handler => button1.Click -= handler
            )
            .Delay(TimeSpan.FromSeconds(5))
            .ObserveOn(SynchronizationContext.Current)  // ensure event fires on UI thread
            .Subscribe(
                ev => CallMyCodeNow()
                , ex => MessageBox.Show(ex.Message)
            );
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-16T03:00:56.923

如果您正在寻找更奇特的解决方案，您可能想看看我的 Reactive [LINQ project](http://tomasp.net/blog/reactive-iii-linqoperators.aspx)。该链接没有显示如何解决您遇到的特定问题，但是使用那里描述的技术（在整个 4 篇文章系列中）应该可以以一种非常优雅的方式解决。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2009-03-15T23:34:10.807

您可以使用：

```
Thread.Sleep(1000); 
```

这将使当前线程暂停一秒钟。所以我会这样做...

此致！

# iphone - 这一切都适用于 Objective-C 中的垃圾收集吗？

> ID：648710
> 
> 赞同：2
> 
> 时间：2009-03-15T22:34:03.290
> 
> 标签：iphone, objective-c, memory, garbage-collection

嗨，我刚拿起 Obj-C，非常不喜欢它的手动内存管理。

我决定使用它的垃圾收集，通过添加

```
objc_startCollectorThread();//garbage collection 
```

在我的 Main() 中并将垃圾收集值更改为 [-fobjc-gc]

**这就是我所需要的**吗？所以我可以像在 Java/Python..etc 中那样“自由地”编程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T01:20:51.580

是的，你是对的，但如果任何 iPhone 程序员过来并认为“哦，亲爱的！”，请注意 iPhone 还不支持垃圾收集（曾经？）。所以这是 MacOS 唯一的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T13:04:43.353

请注意，这`-fobjc-gc`意味着您仍然使用保留/释放（在编写框架/库时）；`-fobjc-gc-only`如果您想完全摆脱引用计数代码，您可能想要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T13:25:34.177

正如其他人所说，iPhone 中没有垃圾收集。

如果你正在编写一个桌面 Cocoa 应用程序，你所需要的只是`-fobjc-gc-only`标志，没有显式的`objc_startCollectorThread()`启动函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T22:38:15.743

基本上，是的。这在[Apple 的文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/GarbageCollection/Articles/gcEssentials.html)中有所介绍。您可能还需要偶尔致电

```
objc_clear_stack 
```

但这是可选的，以确保堆栈保留对象的生命周期尽可能短。

# asp.net - Global.asax 中的事件未触发

> ID：648713
> 
> 赞同：5
> 
> 时间：2009-03-15T22:35:07.517
> 
> 标签：asp.net, session, global-asax

在我的 ASP.Net 应用程序中，我无法让 Global.asax 中的事件在我的机器上触发。例如， Session_Start 不会触发。

同样的 Global.asax 在我办公室的其他开发机器上也能正常工作。

我努力了：

*   ASP.Net 开发服务器和我的本地 IIS

*   重新启动机器

*   从项目中删除和重新创建文件（包括
    从磁盘中删除它）

*   所有机器都配置了相同级别的软件（VS2008
    SP1、.Net 3.5、XP）

这让我发疯了，有什么帮助吗？

编辑：由于该应用程序可以在其他机器上运行，我认为它与 Global.asax 的内容没有直接关系。出于某种原因，我的机器不处理文件。我已经修复了 VS 2008 和 .Net 2.0。还有其他想法吗？

编辑：在所有三台机器上运行的应用程序是直接从源代码管理中提取的。这绝对是一台机器特有的东西。

谢谢，

拍

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T22:49:02.847

应用程序级事件只需要正确命名即可工作。您的代码隐藏类是否在您的 Global.asax 文件中指定？

```
<%@ Application Inherits="YourNamespace.YourApplicationClass" Language="C#" %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T22:50:17.440

这是一个很长的镜头，但我以前被这个咬过。当您创建 Global.asax.cs 文件时，您是否确保在您的项目中包含一个基本的 Global.asax 文件？

还要确保 Global.asax 中的**继承**属性指向 Global.asax.cs 文件中的自定义类（命名空间和所有）。

我曾经遇到过这个问题，这是因为我完全忘记了制作 Global.asax 文件并将其连接到我的班级。我刚刚从另一个做类似事情的项目中复制了 Global.asax.cs。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-09T06:29:58.687

因为首先编译项目，然后您添加或修改或更改 global.asax.vb 的位置。

解决方案：- 只需删除调试文件夹。清理项目，然后重建整个项目。

问候，米希尔

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-23T16:29:37.320

正如我[在这里](https://stackoverflow.com/questions/2942797/global-asax-not-firing-for-aspx-pages-in-iis7/42981784#42981784)写的那样，就我而言，我正在将我的网站发布到生产环境中，我错过了复制到服务器**App_global.asax.compiled**文件的内容。由于这个原因，没有触发 Global.asax 中的事件。

希望anyelse帮助这个提示，我失去了8个小时的寻找。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-15T23:10:27.260

如果您使用过 ASP.NET，那么也许可以尝试重新安装它。

# sql-server - 杀死数据库中的阻塞进程

> ID：648714
> 
> 赞同：0
> 
> 时间：2009-03-15T22:36:57.603
> 
> 标签：sql-server

如果我们在数据库中看到很多阻塞的进程，最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T22:48:55.297

一些阻塞是正常的，问题是阻塞是否会导致查询无法及时完成或更糟的是导致死锁。您需要做的是确定导致阻塞的原因。微软有一些很好的工具来解决这个问题。

这篇[文章](http://blogs.technet.com/rob/archive/2008/05/26/detecting-sql-server-2005-blocking.aspx)应该让你开始或[在这里](http://blogs.msdn.com/psssql/archive/2007/02/21/sql-server-2005-performance-statistics-script.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T01:50:07.907

WITH (NOLOCK) 不一定是一个好的选择。这将导致查询返回未提交的读取。在事务系统上，这可能是您不想要的行为。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-16T01:19:53.283

## 临时解决方案

使用 sp_who 查找 spid 并终止 spid（即 kill 59，其中 59 是阻塞进程的 spid）以终止进程。

## 真正的解决方案

这将解决问题，但不会阻止它再次发生。为此，您需要查看您的代码。我建议您至少在您正在执行的任何选择上使用 WITH NO LOCK 以减少锁定的可能性。

此外，您可以重构您的代码，以便您只访问最少的次数。考虑复制到临时（# 或 ##）表以进行详细处理，然后在需要时复制回位置。这尤其适用于目的是为报告准备数据的情况。最好将数据提取一次并在主表之外进行任何其他处理。

如果由于基础数据变化太快而无法做到这一点，或者您需要将更改应用于其他目的，则使用 SQL Service Broker 将异步工作项排队。这可用于根据您的情况解决阻塞问题。

# c# - 访问自动属性中的支持字段

> ID：648718
> 
> 赞同：8
> 
> 时间：2009-03-15T22:38:35.027
> 
> 标签：c#, .net-3.5, c#-3.0, properties, encapsulation

有什么方法可以访问属性的支持字段以进行验证、更改跟踪等？

可能会出现以下情况吗？如果没有，是否有计划在 .NET 4 / C# 4 中使用它？

```
public string Name
{
    get;
    set
    {
        if (value != <Keyword>)
        {
            RaiseEvent();
        }
        <Keyword> = value;
    }
} 
```

我遇到的主要问题是，使用自动属性不允许在验证等方面具有与具有显式支持字段的属性相同的灵活性。然而，显式支持字段在某些情况下具有缺点，即当它应该访问和重用属性的验证、更改跟踪等时，允许包含它的类访问支持字段，就像可能正在访问的任何其他类一样外部的财产。

在上面的示例中，对支持字段的访问将限定在属性范围内，从而防止绕过属性验证、更改跟踪等。

**编辑：**我已将 <Backing Field> 更改为 <Keyword>。我会提出一个类似于 value 的新关键字。**字段**会做得很好，尽管我确信它已在很多现有代码中使用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-15T22:42:10.477

不，没有。如果您想访问支持字段，请不要使用自动属性并自行滚动。

我同意拥有一个只能由物业访问而不能由班级其他人访问的字段会很棒。我会一直使用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T23:06:13.133

正如[MSDN](http://msdn.microsoft.com/en-us/library/bb384054.aspx)所述：

> “在 C# 3.0 及更高版本中，当属性访问器中不需要其他逻辑时，自动实现的属性使属性声明更加简洁。它们还使客户端代码能够创建对象当您如下例所示声明属性时，编译器创建一个私有的、匿名的支持字段只能通过属性的 get 和 set 访问器访问。”

由于您的访问器中有额外的逻辑，因此在您的场景中使用自动实现的属性是不合适的。

虽然支持字段确实存在，但它被赋予了一个错误的名称以阻止您轻松引用它 - 想法是您*永远不会直接引用该字段*。出于利益考虑，您可以使用 Reflector 反汇编代码并发现字段名称，但我建议您不要直接使用该字段，因为该名称可能确实是 volatile，因此您的代码随时可能中断。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T00:49:37.270

在阅读了您在 Mehrdad 的回答中的评论后，我想我对您的问题有了更好的理解。

您似乎担心开发人员在他们正在编写的类中访问私有状态、绕过您的验证逻辑等的能力。这表明状态根本不应该包含在类中。

我建议以下策略。编写一个表示 ValidatedValue 的泛型类。此类仅包含支持值，并且仅允许通过 get 和 set 方法进行访问/更改。将委托传递给 ValidatedValue 以表示验证逻辑：

```
public class ValidatedValue< T >
{
    private T m_val;
    public ValidationFn m_validationFn;

    public delegate bool ValidationFn( T fn );

    public ValidatedValue( ValidationFn validationFn )
    {
        m_validationFn = validationFn;
    }

    public T get()
    {
        return m_val;
    }

    public void set(T v)
    {
        if (m_validationFn(v))
        {
            m_val = v;
        }
    }
} 
```

当然，您可以根据需要添加更多代表（例如，支持更改前/后通知）。

您的班级现在将使用 ValidatedValue 代替您的财产的后备存储。

下面的示例显示了一个类 MyClass，其整数被验证为小于 100。请注意，引发异常的逻辑在 MyClass 中，而不是 ValidatedValue。这允许您执行复杂的验证规则，这些规则依赖于 MyClass 中包含的其他状态。Lambda 表示法用于构造验证委托 - 您可以改为绑定到成员函数。

```
public partial class MyClass
{
    private ValidatedValue<int> m_foo;

    public MyClass()
    {
        m_foo = new ValidatedValue<int>(
            v => 
            {
                if (v >= 100) RaiseError();
                return true;
            }
        );
    }

    private void RaiseError()
    {
        // Put your logic here....
        throw new NotImplementedException();
    }

    public int Foo
    {
        get { return m_foo.get(); }
        set { m_foo.set(value); }
    }
} 
```

希望这会有所帮助 - 有点偏离原始主题，但我认为它更符合您的实际担忧。我们所做的是将验证逻辑从属性中取出，并将其放在数据上，这正是您想要的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-16T01:35:36.787

不，但您可以在子类中：

```
public class Base
{
    public string Name
    {
        get;
        virtual set;
    }
}

public class Subclass : Base
{
    // FIXME Unsure as to the exact syntax.
    public string Name
    {
        override set
        {
            if (value != base.Name)
            {
                RaiseEvent();
            }

            base.Name = value;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T22:40:26.537

如果您要这样做，为什么要使用自动属性？！

一个简单的属性早在 1.0 中就已经完成了。我认为为每种特殊情况增加语言的复杂性是没有意义的。您要么需要该属性来执行普通的存储/检索模型，要么需要更多。在后一种情况下，正常的属性就可以了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T22:44:56.807

恐怕你不能这样做。这就是我开始编写[MoXAML Power Toys](http://peteohanlon.wordpress.com/moxaml-power-toys/)的原因之一，以提供将自动属性转换为 Notify 属性的能力。

# windows - Windows 关机对话框

> ID：648729
> 
> 赞同：4
> 
> 时间：2009-03-15T22:45:55.307
> 
> 标签：windows, winapi, shutdown

有没有办法使用任何语言（首选：C/C++、VB、Haskell、批处理）调出 Windows XP 关机对话框（具有三个按钮的对话框 - 按下 Shift 时暂停、关机、重新启动和休眠）？

我想我可以在我的 C++ 程序中加载 msgina.dll，但我不知道下一步该做什么——dll 中的什么函数用于显示对话框？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T22:48:26.627

假设您的语言可以在 Windows 上执行基本文件 I/O 和调用快捷方式，请从[此处](http://www.onecomputerguy.com/windowsxp_tips.htm#shutdown_dialog)尝试此提示：

> *   在系统的某处创建一个新的 txt 文件，打开它并放入这一行： `(new ActiveXObject("Shell.Application")).ShutdownWindows();`
> *   保存并关闭文件。将扩展名更改为`*.js`.
> *   您可以创建该文件的快捷方式，以便轻松关闭系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T23:36:26.837

我发现 PowerShell 比其他 Windows 脚本选项更优雅。

```
(新对象-Com Shell.Application).ShutdownWindows()

```

# java - Java 无符号字符数组

> ID：648732
> 
> 赞同：1
> 
> 时间：2009-03-15T22:47:16.830
> 
> 标签：java, crc

我正在做一个模糊媒体播放器的项目。我用 Java 编写了文件生成器，并从用 C 编写的原始压缩代码转换了 CRC 生成器。我可以用 DataOutputStream 很好地写入数据，但我不知道如何在 java 中将数据作为无符号字符数组发送。在 C 中，这是一个非常简单的过程。我已经非常彻底地搜索了一个解决方案，我发现的最佳解决方案是将数据发送到 C 并让 C 返回一个 CRC。我可能只是没有正确搜索，因为我对这些东西很不熟悉。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T23:01:07.593

你肯定想要一个字节[]。“字节”相当于 C 中的有符号字符。Java 的“字符”是一个 16 位的 unicode 值，根本不等价。

如果是为了模糊测试，除非您使用的 CRC 函数有什么特别之处，否则我想您可以简单地使用：

```
import java.util.Random;
Random randgen = new Random();

byte[] fuzzbytes = new byte[numbytes];
randgen.nextBytes(fuzzbytes);
outstream.write(fuzzbytes, 0, numbytes); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T22:53:53.883

我怀疑你想对角色做任何事情。我在您的描述中看不到任何暗示*文本*操作的内容，这就是您对字符所做的事情。

您想使用字节数组。在 Java 中对字节进行签名有点痛苦，但字节数组就是你所拥有的——只需使用位模式而不是将它们视为实际数字，并仔细检查每个操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T22:54:23.677

大多数 CRC 运算符主要使用按位移位和 XOR。这些在不支持无符号整数原语的 Java 上应该可以正常工作。如果您需要其他算术才能正常工作，您可以尝试转换为*short*。

# objective-c - Objective-C：模偏差

> ID：648739
> 
> 赞同：13
> 
> 时间：2009-03-15T22:51:21.907
> 
> 标签：objective-c, random

使用：

```
value = arc4random() % x 
```

如何避免或消除模偏差？

至少根据 Wikipedia 的说法，在编写机会游戏时，模偏差是一个问题。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2011-05-31T22:08:12.487

使用`arc4random_uniform(x)`. 这是为你做的。

根据手册页：

> `arc4random_uniform()` will return a uniformly distributed random number less than `upper_bound`. `arc4random_uniform()` is recommended over constructions like `arc4random() % upper_bound` as it avoids "modulo bias" when the upper bound is not a power of two.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-15T22:56:55.137

arc4random 返回一个 32 位无符号整数（0 到 2 ^(32) -1）。

对于足够小的 x，可能不会有明显的模偏差。但是，如果您想真正确定，请执行以下操作：

y = 2 ^p其中 2 ^(p-1) < x ≤ 2 ^p

```
val = arc4random() % y;
while(val >= x)
    val = arc4random() % y; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-15T23:24:07.023

```
u_int32_t maxValue = ~((u_int32_t) 0);      // equal to 0xffff...
maxValue -= maxValue % x;                   // make maxValue a multiple of x
while((value = arc4random()) >= maxValue) { // loop until we get 0 ≤ value < maxValue
}
value %= x; 
```

尽管除非您使用任何低于一百万（或更多）的 x，否则我不会担心

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T22:57:23.983

`arc4random`如果mod的最大值`x`大于`x`，忽略任何大于最大值的值，而是再次`arc4random-max mod x`调用。`arc4random`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-18T03:46:50.773

```
u_int32_t maxValue = ~((u_int32_t) 0);      // equal to 0xffff...
maxValue -= maxValue % x;                   // make maxValue a multiple of x
while((value = arc4random()) >= maxValue) { // loop until we get 0 ≤ value < maxValue
}
value %= x; 
```

对科巴尔的回答有些迂腐的反对。它“有效”，即它消除了模偏差，但它拒绝了比必要更多的值。最极端的情况是 x = 2^31。此处应接受 arc4random() 的所有值，但编写的代码将拒绝其中的一半。

相反，将 1 添加到 maxValue 的初始化（将其置于 2^32，因此您必须使用 64 位 int），然后它是正确的。您还可以避免使用 64 位 int。预先测试 2^32 % x == 0，如果是这样，所有 arc4random() 值都可以接受，您可以跳过循环，否则您可以通过在初始化时减去 2^32 % x 来保持 maxValue 为 32 位。

# wpf - WPF 没有给孩子的事件

> ID：648749
> 
> 赞同：0
> 
> 时间：2009-03-15T22:58:32.280
> 
> 标签：wpf

在 WPF 代码中

```
<Button Click="onClick">
  <TextBlock>
    <Hyperlink >Click Me!</Hyperlink>
  </TextBlock>
</Button> 
```

如何阻止 HyperLink 接收鼠标事件？我不希望它突出显示、更改光标或任何东西。

提前致谢！詹姆士

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T23:04:02.267

您不能在 XAML 中执行此操作，但您可以在代码中执行此操作，方法是为您不想处理的每个鼠标事件设置一个事件处理程序，并将该事件标记为已被处理，这应该会阻止它继续进行。

```
private void OnClickHandler(object sender, RoutedEventArgs e)
{
    e.Handled = true; 
} 
```

# c# - 我在 C# 中的常见问题，我的解决方案是好、愚蠢、合理的吗？（高级初学者）

> ID：648754
> 
> 赞同：2
> 
> 时间：2009-03-15T23:01:57.077
> 
> 标签：c#, linq-to-sql, collections

好的，了解我来自 Cold Fusion，所以我倾向于以 CF 的方式思考事物，而 C# 和 CF 在一般方法中是不同的。

所以问题是：我想通过 LINQ 从 SQL 数据库中提取数据的“表”（这就是我的想法），然后我想在内存中对其进行一些计算。这个“表”包含 6 或 7 个不同类型的值。

现在，我的解决方案是使用自定义类型的通用列表进行 LINQ 查询。所以我的例子是 RelevanceTable。我提取了一些我想对数据进行评估的数据，这些数据首先以 .Contains 开头。看来 .Contains 想要对整个列表采取行动，或者什么都不做。因此，如果我有，我可以使用它`List<string>`，但如果我有`List<ReferenceTableEntry>`其中 ReferenceTableEntry 是我的自定义类型，我将需要覆盖 IEquatable 并告诉编译器“Equals”究竟是什么意思。

虽然这似乎不是不合理的，但要解决一个简单的问题似乎还有很长的路要走，所以我有一种偷偷摸摸的怀疑，即我的方法从一开始就有缺陷。

如果我想使用 LINQ 和 .Contains，重写接口是唯一的方法吗？似乎只有一种方法可以说明要在哪个字段上进行操作。除了 LIST 之外，是否还有另一种可能具有这种能力的集合类型。为此，我已经开始大量使用 List ，虽然我已经看了又看，但看到了其他一些但不一定是更好的方法。

我不是在寻找一些性能或紧凑性或可读性的好点，只是想知道我是否在六角螺丝中使用十字头螺丝刀。如果我的方法是“体面”的，但不是最好的，我当然想知道一个更好的方法，但只要知道它在球场上就不会给我一点“是的！我不傻！” 在切换到另一种方法之前，我至少会完成我正在做的事情。

希望我解释得足够好。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T23:15:21.413

你到底想用这张桌子*做什么？*目前还不清楚。但是，标准 LINQ（-to-Objects）方法可用于任何类型的集合（包括`List<T>`），允许任何范围的`Where`、`First`、`Any`、`All`等。

所以：你想做什么？如果你有桌子，你想要什么值？

作为猜测（基于这些`Contains`东西） - 你只是想要：

```
bool x= table.Any(x=>x.Foo == foo); // or someObj.Foo 
```

?

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T23:26:34.567

List 类中的一些方法有重载，它们接受一个委托（可选地以 lambda 表达式的形式），您可以使用它来指定要查找的字段。

例如，要查找 Id 属性为 42 的项目：

```
ReferenceTableEntry found = theList.Find(r => r.Id == 42); 
```

该`found`变量将引用第一个匹配的项目，或者`null`如果没有项目匹配。

还有一些接受委托或表达式的 LINQ 扩展。这将与`Find`方法相同：

```
ReferenceTableEntry found = theList.FirstOrDefault(r => r.Id == 42); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T23:15:13.130

好的，所以如果我没看错，你想使用 contains 方法。将它与对象集合（例如 ReferenceTableEntry）一起使用时，您需要小心，因为您要检查集合是否包含与您要比较的对象相同的对象。

如果您使用 .Find() 或 .FindAll() 方法，则可以使用匿名方法指定要匹配的条件。

因此，例如，如果您想在列表中查找 ID 大于 1 的所有 ReferenceTableEntry 记录，您可以执行以下操作

```
List<ReferenceTableEntry> listToSearch = //populate list here
var matches = listToSearch.FindAll(x => x.Id > 1); 
```

匹配项将是 ID 大于 1 的 ReferenceTableEntry 记录的列表。

说了这么多，还不清楚这就是你想要做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T01:57:30.243

这是创建我正在谈论的对象所涉及的 LINQ 查询，问题线是：

**.Where (searchWord => queryTerms.Contains(searchWord.Word))**

```
List<queryTerm> queryTerms = MakeQueryTermList();

public static List<RelevanceTableEntry> CreateRelevanceTable(List<queryTerm> queryTerms)
            {
            SearchDataContext myContext = new SearchDataContext();
            var productRelevance = (from pwords in myContext.SearchWordOccuranceProducts
            where (myContext.SearchUniqueWords
            .Where (searchWord => queryTerms.Contains(searchWord.Word))
            .Select (searchWord => searchWord.Id)).Contains(pwords.WordId)
            orderby pwords.WordId
            select new {pwords.WordId, pwords.Weight, pwords.Position, pwords.ProductId});
            } 
```

此查询返回与提交的搜索字符串匹配的 WordId 列表（当它是 List 并且它只是单词时，效果很好，因为作为前面提到的回答者，它们是相同类型的对象）。**我这里**的自定义类型是 queryTerms，一个包含 WordId、ProductId、Position 和 Weight 的 List。从那里我开始通过对创建的对象进行各种操作来计算相关性。按产品对“权重”求和，使用位置匹配来提高权重等。我要保持这一点的观点是，执行这些操作的规则会改变，但所涉及的基本因素不会改变。我什至宁愿它更加独立（我仍在学习，我不想花哨），但是当我这样做时，本地和解释的 LINQ 查询的规则似乎让我绊倒了。

由于 CF 一直支持查询查询，这就是我倾向于采用的方式。从数据库中提取您需要的数据，然后在内存表上执行您的操作（包括使用聚合函数的查询）。

我希望这更清楚。

# windows-xp - 如何在 IIS 6 上启用 Web 服务扩展文件夹

> ID：648770
> 
> 赞同：1
> 
> 时间：2009-03-15T23:08:43.863
> 
> 标签：windows-xp, iis-6

我试图让 .asp 页面在**Win XP Pro上的 Windows Internet Information Server 6.0 上运行** *（我最初错误地将其发布为主页）*。

我在几个地方找到了说明我应该在 Web 服务扩展文件夹中启用它。

问题是我的 IIS6 在本地计算机下没有那个文件夹。

更新：我尝试让它与 IIS5 一起工作，但（如下所述）指令要求一个不存在的 WSE 文件夹。

所以我安装了IIS6。因此我的问题是关于 IIS6。

我是否可能需要卸载 IIS6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T00:46:31.583

IIRC XP 有 IIS 5.1，而不是 6.0，因此“Web 服务扩展”的说明不适用

我记得 IIS 5.1 只允许虚拟文件夹上的 ASP 支持，而不是出于某种原因在根级别上？

您是否运行了 IIS 锁定工具并锁定了 ASP？需要撤消它:-)

检查[http://www.codinghorror.com/blog/archives/000329.html](http://www.codinghorror.com/blog/archives/000329.html)以获取其他提示

# .net - 寻找 .Net 表组件

> ID：648772
> 
> 赞同：0
> 
> 时间：2009-03-15T23:09:59.787
> 
> 标签：.net, controls

我正在寻找一个表格控件（又名 ListView 或 DataGridView）：

*   可以将一系列行显示为一行的“子项” - 如果有人用过 Access，它会在计算出行之间的关联时执行此操作
*   将让我将标题插入表格的中间，因此我可以例如按特定行分组并在每个组上方有一个标题。
*   理想情况下，让我一次绘制多个表格，但我可以用一个面板和两个表格控件来伪造它，这样我就不会那么烦恼了。

如果它能够达到 DataGridView 的效率那就太好了——我的数据表通常有很多行往往会同时进入，并且在这个应用程序中并不需要分页。

本质上，我正在寻找一个表格控件，我可以在其中打破任何行的表格并插入其他东西。

有人知道可能合适的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T23:17:11.737

我相信[obout](http://www.obout.com/grid/)网格可以满足您的要求。还有其他第三方供应商，如[Telerik](http://www.telerik.com/products/aspnet-ajax/grid.aspx)、[Infragistics](http://www.infragistics.com/dotnet/netadvantage/aspnet/webgrid.aspx)和[ComponentOne](http://www.componentone.com/SuperProducts/WebGridASPNET/)，它们都有网格控件，可以满足您的需求。我建议下载每个的试用版，看看哪一个最适合你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T23:33:29.543

我保证我与[DevExpress](http://devexpress.com/)没有任何关系，但是，使用过[Telerik](http://www.telerik.com/products/aspnet-ajax/grid.aspx)、[Infragistics](http://www.infragistics.com/dotnet/netadvantage/aspnet/webgrid.aspx)和[DevExpress](http://devexpress.com/)，如果您正在寻找第 3 方控件，根据我的经验，DevExpress 控件是迄今为止我最喜欢的可用性、功能和外观和感觉。如上所述，我没有使用过[ComponentOne ，所以我无法评论它们。](http://www.componentone.com/SuperProducts/WebGridASPNET/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-13T10:20:07.927

你可以试试我的 Grid，它很完整，可以在[www.webgrid.com](http://www.webgrid.com)找到。

它应该满足您的要求，并且语法类似于 GridView。

希望对你有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T14:59:37.163

我实际上在另一边，我已经在各种追求和自由演出中使用了所有这三个，并且发现[Telerik](http://www.telerik.com)控件更加通用，并且似乎通过他们的 .Net 3.5 支持提供了更多。您更喜欢[DevExpress](http://www.devexpress.com)的哪些方面...即，下次我的工作之一是寻找那种类型的 UI 控制套件时，我为什么要重新访问它们？

# iphone - 从分数到小数再返回？

> ID：648778
> 
> 赞同：5
> 
> 时间：2009-03-15T23:12:30.233
> 
> 标签：iphone, c, objective-c

是否可以在某种变量中存储像 3/6 这样的分数？当我尝试这个时，它只存储 / 之前的数字。我知道我可以使用 2 个变量并将它们分开，但输入来自单个文本字段。这是可能吗？

我想这样做是因为我需要计算小数赔率的分数。

一个额外的问题;) - 有没有一种简单的方法可以将十进制值计算为分数？谢谢..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T23:23:24.483

简而言之，没有真正的方法可以从小数中提取原始分数。

示例：取 5/10

你会得到 0.5

现在，0.5 也转换回 1/2、2/4、3/6 等。

最好的办法是分别存储每个整数，然后再执行计算。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T23:25:00.517

恐怕在这方面你没有任何简单的答案。要创建分数，您必须拆分“/”上的文本字段，将两半转换为`double`s，然后将它们分开。至于将其转换回分数，您必须打开一本数学教科书并弄清楚。（更糟糕的是，一个双精度数实际上并不精确——你可能认为它有 0.1，但它实际上有 0.09999999999999998726 或类似的东西，所以你必须选择一个精度并坚持下去，或者写一些分数基于一对整数的类。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T00:14:03.690

最好的办法是实现一个分数类（或有理数类）。通常它需要一个分子和分母，并能够提供一个双精度数，并与其他分数对象进行基本数学运算。它还应该能够解析和格式化分数。

[Rosetta Code 上的 Rational Arithmetic](http://www.rosettacode.org/wiki/Rational_Arithmetic#Objective-C)看起来不错。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-16T00:42:13.903

如前所述，该方法是存储分子和分母，就像您可以将其写在纸上一样。

对于“C”，使用

[GNU 多精度算术库](http://gmplib.org/#DOC)

在文档中寻找“理性”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T00:27:13.440

> > 有没有一种简单的方法可以将十进制值计算为分数？

如果您将十进制值限制为一定数量的小数点，您可以创建一个查找表。

```
0.3333, 1/3
0.6666, 2/3
0.0625, 1/16
0.1250, 1/8
0.2500, 1/4
0.5000, 1/2
0.7500, 3/4
ETC...

```

因此，如果用户输入 0.5，则用 0 填充它，直到获得 4 位小数。然后，您将使用查找表返回“1/2”。查找表可能应该是某种字典。

估计也不会太难。例如，如果用户输入 0.0624，您可以轻松地在表中选择最接近该小数的值。在这种情况下，它将返回“1/16”。

不要让输入/输入有限的小数/分数对组吓到您（根据您选择的精度，它实际上并没有那么大）。

如果一切都失败了，也许谷歌搜索会显示一个为你做这种事情的图书馆。

# .net - 如何在 LINQ 中的子表上创建 where 条件

> ID：648782
> 
> 赞同：5
> 
> 时间：2009-03-15T23:14:49.603
> 
> 标签：.net, linq

这是对另一个问题的答案部分中的这个[问题的回应。](https://stackoverflow.com/questions/315966/how-do-you-construct-a-linq-to-entities-query-to-load-child-objects-directly-ins/550118#550118)

我有一个 Orders 集合，每个 Order 都是一个 OrderItems 集合，每个 OrderItem 都有一个 PartId。使用 LINQ 如何实现以下 SQL 语句：

1) 选择所有具有特定零件 ID 的订单

```
SELECT *
FROM Order
WHERE Id in (SELECT OrderId FROM OrderItems WHERE PartId = 100) 
```

2) 选择 Order.OrderNumber 和 OrderItem.PartName

```
SELECT Order.OrderNumber, OrderItem.PartName
FROM Order INNER JOIN OrderItem ON Order.Id = OrderItem.OrderId
WHERE OrderItem.partId = 100 
```

3) 选择 Order.OrderNumber 和整个 OrderItem 详细信息：

```
SELECT Order.OrderNumber, OrderItem.*
FROM Order INNER JOIN OrderItem ON Order.Id = OrderItem.OrderId
WHERE OrderItem.partId = 100 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-15T23:15:03.877

实际代码应该是

1)

```
var orders = from o in Orders
             where o.OrderItems.Any(i => i.PartId == 100)
             select o; 
```

Any() 方法返回一个布尔值，类似于 SQL 的“in”子句。这将获得所有 OrderItem 的 PartId 为 100 的订单。

2a)

```
// This will create a new type with the 2 details required 
var orderItemDetail = from o in Orders
                      from i in Orders.OrderItems
                      where i.PartId == 100
                      select new()
                      {
                          o.OrderNumber,
                          i.PartName
                      } 
```

两个 from 子句就像一个内连接。

2b)

```
// This  will populate the OrderItemSummary type
var orderItemDetail = from o in Orders
                      from i in Orders.OrderItems
                      where i.PartId == 100
                      select new OrderItemSummary()
                      {
                          OriginalOrderNumber = o.OrderNumber,
                          PartName = i.PartName
                      } 
```

3)

```
// This will create a new type with two properties, one being the
// whole OrderItem object.
var orderItemDetail = from o in Orders
                      from i in Orders.OrderItems
                      where i.PartId == 100
                      select new()
                      {
                          OrderNumber = o.OrderNumber,
                          Item = i
                       } 
```

由于“i”是 OrderItem 类型的对象，因此 Item 被创建为 OrderItem。

# c# - 使用 Linq to SQL 确定行是否存在的最快方法是什么？

> ID：648795
> 
> 赞同：52
> 
> 时间：2009-03-15T23:23:43.997
> 
> 标签：c#, linq-to-sql, lambda

我对一行的内容不感兴趣，我只想知道一行是否存在。该`Name`列是主键，因此将有 0 或 1 个匹配行。目前，我正在使用：

```
if ((from u in dc.Users where u.Name == name select u).Count() > 0)
    // row exists
else
    // row doesn't exist 
```

虽然上述方法有效，但它通过选择行的所有内容（如果存在）做了很多不必要的工作。以下是否会创建更快的查询：

```
if (dc.Users.Where(u => u.Name == name).Any()) 
```

...或者是否有更快的查询？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-03-15T23:25:38.157

该`Count()`方法可能会做额外的工作，例如（在 TSQL 中）`EXISTS`或者`TOP 1`通常更快；数据库可以优化“至少有一行”。就个人而言，我会使用任何/谓词重载：

```
if (dc.Users.Any(u => u.Name == name)) {...} 
```

当然，您可以通过查看 TSQL 来比较每个人的作用：

```
dc.Log = Console.Out; 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-06-18T08:57:56.063

当然

```
if (dc.Users.Where(u => u.Name == name).Any()) 
```

这是最好的，如果要检查多个条件，那么写成很简单

假设您要检查公司的用户然后

```
if (dc.Users.Where(u => u.ID== Id && u.Company==company).Any()) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-15T23:30:37.227

我认为：

```
if (dc.Users.Any(u => u.Name == name)) {...} 
```

是最好的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-02-19T15:42:18.647

对于那些声称 Any() 是前进方向的人，我在 LinqPad 中针对 CommonPasswords 的 SQL 数据库进行了一个简单的测试，1400 万次给予或接受。代码：

```
var password = "qwertyuiop123";

var startTime = DateTime.Now;
"From DB:".Dump();
startTime = DateTime.Now;

if (CommonPasswords.Any(c => System.Data.Linq.SqlClient.SqlMethods.Like(c.Word, password)))
{
    $"FOUND: processing time: {(DateTime.Now - startTime).TotalMilliseconds}\r\n".Dump();
}
else
{
    $"NOT FOUND: processing time: {(DateTime.Now - startTime).TotalMilliseconds}\r\n".Dump();
}

"From DB:".Dump();
startTime = DateTime.Now;
if (CommonPasswords.Where(c => System.Data.Linq.SqlClient.SqlMethods.Like(c.Word, password)).Count() > 0)
{
    $"FOUND: processing time: {(DateTime.Now - startTime).TotalMilliseconds}\r\n".Dump();
}
else
{
    $"NOT FOUND: processing time: {(DateTime.Now - startTime).TotalMilliseconds}\r\n".Dump();
}

"From DB:".Dump();
startTime = DateTime.Now;
if (CommonPasswords.Where(c => c.Word.ToLower() == password).Take(1).Any())
{
    $"FOUND: processing time: {(DateTime.Now - startTime).TotalMilliseconds}\r\n".Dump();
}
else
{
    $"NOT FOUND: processing time: {(DateTime.Now - startTime).TotalMilliseconds}\r\n".Dump();
} 
```

这是翻译后的 SQL：

```
-- Region Parameters
DECLARE @p0 NVarChar(1000) = 'qwertyuiop123'
-- EndRegion
SELECT 
    (CASE 
        WHEN EXISTS(
            SELECT NULL AS [EMPTY]
            FROM [Security].[CommonPasswords] AS [t0]
            WHERE [t0].[Word] LIKE @p0
            ) THEN 1
        ELSE 0
     END) AS [value]
GO

-- Region Parameters
DECLARE @p0 NVarChar(1000) = 'qwertyuiop123'
-- EndRegion
SELECT COUNT(*) AS [value]
FROM [Security].[CommonPasswords] AS [t0]
WHERE [t0].[Word] LIKE @p0
GO

-- Region Parameters
DECLARE @p0 NVarChar(1000) = 'qwertyuiop123'
-- EndRegion
SELECT 
    (CASE 
        WHEN EXISTS(
            SELECT NULL AS [EMPTY]
            FROM (
                SELECT TOP (1) NULL AS [EMPTY]
                FROM [Security].[CommonPasswords] AS [t0]
                WHERE LOWER([t0].[Word]) = @p0
                ) AS [t1]
            ) THEN 1
        ELSE 0
     END) AS [value] 
```

您可以看到 ANY 将查询包装在另一层代码中以执行 CASE Where Exists Then 1 其中 Count() 只是添加了一个 Count 命令。这两个问题是你不能做 Top(1) 但我看不到使用 Top(1) 的更好方法

结果：

来自 DB：发现：处理时间：13.3962

来自 DB：发现：处理时间：12.0933

来自 DB：发现：处理时间：787.8801

再次：

来自 DB：发现：处理时间：13.3878

来自 DB：发现：处理时间：12.6881

来自 DB：发现：处理时间：780.2686

再次：

来自 DB：发现：处理时间：24.7081

来自 DB：发现：处理时间：23.6654

来自 DB：发现：处理时间：699.622

无索引：

来自 DB：发现：处理时间：2395.1988

来自 DB：发现：处理时间：390.6334

来自 DB：发现：处理时间：664.8581

现在你们中的一些人可能认为这只是一两毫秒。但是，在我对其进行索引之前，差异要大得多。几秒钟。

最后一个计算就在那里，因为我从 ToLower() 比 LIKE 更快的概念开始，我是对的，直到我尝试计数并在其上放置一个索引。我猜 Lower() 使索引无关紧要。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T23:59:08.030

我不同意在所有 SQL 实现中选择 top 1 总是优于 select count。你知道，这完全取决于实现。奇怪的是，即使存储在特定数据库中的数据的性质也会影响整体结果。

如果我这样做，让我们以实现它们的方式检查它们：对于这两种情况，投影（WHERE 子句）评估是一个常见的步骤。

接下来对于选择前 1，您将必须读取所有字段（除非您确实选择了前 1 'x'，例如：选择前 1 1）。这在功能上等同于 IQueryable.Any(...).，除了您将花费一些时间在第一个遇到的记录的每一列（如果 EXISTS）中闪烁值。如果在语句中找到 SELECT TOP，则如果没有投影后过程（例如 ORDER BY 子句），则投影将被截断。此预处理会产生少量成本，但如果不存在任何记录，则这是额外成本，在这种情况下，仍然会完成一个完整的项目。

对于选择计数，未完成预处理。投影已完成，如果 EXISTS 为假，则结果是即时的。如果 EXISTS 为真，计数仍然很快，因为它只是 dW_Highest_Inclusive - dW_Lowest_Exclusive。最快 500 - 26。如果存在为假，则结果更加即时。

因此，剩下的情况是：投影的速度有多快？通过完全投影你会失去什么？答案导致这里最关键的问题是：[NAME] 字段是否被索引！如果您在 [NAME] 上有索引，则任一查询的性能将非常接近，最终归结为开发人员的偏好。

总的来说，我会简单地写两到四个 linq 查询并输出前后时间的差异。

1.  选择计数
2.  选择前 1
3.  选择前 1 1
4.  选择任何

在 [NAME] 上使用非聚集索引重复所有 4 个；

# visual-studio - 退出时关闭 Visual Studio 中的所有文件

> ID：648803
> 
> 赞同：2
> 
> 时间：2009-03-15T23:27:45.017
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2005

有什么方法可以在退出时关闭 Visual Studio 中的所有文件？或者，如果这不可能，是否可以删除 Visual Studio 在退出时创建的用户项目文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T23:41:20.600

Windows->关闭所有文档
文件->退出

或在项目关闭后手动删除 .sou 文件
您可能可以编写一个 VB 脚本宏来执行这些操作。

# c# - 使用 [程序集：] 进行 log4net 配置

> ID：648813
> 
> 赞同：7
> 
> 时间：2009-03-15T23:36:27.057
> 
> 标签：c#, configuration, assemblies, log4net

我很好奇以下行如何在程序集中配置 log4net：

```
[assembly: log4net.Config.XmlConfigurator(Watch=true)] 
```

我猜这会在运行时调用“main()”之前的某个时候被调用，但是什么时候会发生，这意味着什么？是否有其他框架/库使用此程序集属性来加载这样的初始上下文？与在 main() 中调用“配置”方法相比，做这样的事情有什么优点/缺点吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-20T14:00:33.937

这样做的好处是代码在主代码之前和静态初始化之前初始化。

例如，这意味着您可以在静态构造函数中使用 log4net 日志记录。如果没有预初始化 log4net 的方法，在静态构造函数中，您永远无法确定代码是否已正确初始化。

这个区域似乎没有很好的文档记录（或者无论如何都不容易找到），但我假设调用方法的初始化是在程序集加载时执行的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T20:34:28.853

> “我猜这会在运行时调用“main()”之前的某个时候被调用，但是什么时候会发生，这意味着什么？

* * *

根据[log4net 文档](http://logging.apache.org/log4net/release/manual/configuration.html)：

> 使用属性可以更清晰地定义应用程序的配置将从何处加载。不过值得注意的是，*属性是纯被动的*。它们只是信息。因此，如果您使用配置属性，您必须调用 log4net 以允许它读取属性。

所以我想你仍然必须调用`XmlConfigurator.Configure()`方法或`LogManager.getLogger()`.

# c# - 使用常量值直接初始化数组

> ID：648814
> 
> 赞同：51
> 
> 时间：2009-03-15T23:37:29.127
> 
> 标签：c#, arrays, initialization, constants

每当您在 C# 中分配一个新数组时

```
new T[length] 
```

数组条目设置为 T的默认值。如果是值类型，则`null`适用于`T`引用类型或默认构造函数的结果的情况。`T``T`

在我的情况下，我想`Int32`用值 -1 初始化一个数组：

```
var myArray = new int[100];
for (int i=0; i<myArray.Length; i++) { myArray[i] = -1; } 
```

因此，在为数组保留内存之后，CLR 循环遍历新分配的内存并将所有条目设置为 default(int) = 0。之后，我的代码将所有条目设置为 -1。

这使得初始化变得多余。JIT 是否检测到这一点并忽略初始化为 0，如果没有，有没有办法用自定义值直接初始化一部分内存？

参考[C# 数组初始化 - 使用非默认值](https://stackoverflow.com/questions/136836/c-array-initialization-with-non-default-value)，使用`Enumerable.Repeat(value, length).ToArray()`是没有选项，因为`Enumerable.ToArray`分配一个新数组并随后将值复制到它。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-09-29T17:33:34.950

类似于丹的回答，但不需要使用集合：

```
int[] myArray = Enumerable.Repeat(-1, 100).ToArray(); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-03-15T23:42:30.380

这不是多余的。

假设在初始化循环期间引发了异常。如果 CLR 没有首先清除内存，您可能能够“看到”原始未初始化的内存，这是一个非常糟糕的主意，尤其是从安全角度来看。这就是 CLR 保证任何新分配的内存都被擦除为 0 位模式的原因。

顺便说一句，同样的论点也适用于对象中的字段。

我想在这两种情况下，CLR 都可以在完成初始化之前检查您是否不会使数组在其他地方可见，但这是一项复杂的检查，以避免非常简单的“擦除该内存区域”。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-16T00:08:43.577

如果您购买[被认为有些有害的 Arrays](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/arrays-considered-somewhat-harmful)，那么您的问题将没有实际意义，因为您会写：

```
var myArray = new List<int>(Enumerable.Repeat(-1, 100)); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-15T23:44:13.840

我非常怀疑 JIT 是否会优化掉这个场景的默认设置。原因是这将是一个可观察到的差异。考虑以下稍微改变的场景。

```
obj.myArray = new int[100];
for (int i=0; i<myArray.Length; i++) { obj.myArray[i] = -1; } 
```

循环完全有可能抛出。至少，JIT 可能无法证明它不是。如果它确实抛出并且 CLR 没有默认初始化内存，那么如果您仍然有对 obj 的引用，则结果将是可观察的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-01-08T13:03:49.453

我建议使用`Array.Fill`作为一种非常简洁的方式来用初始值填充数组：

```
bool[] isPrime = new bool[MaxNum];
Array.Fill(isPrime, true); 
```

这会将`isPrime`数组中的所有值初始化为`true`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-26T16:03:35.853

如果您正在寻找一种衬垫解决方案，那么您可以使用以下方法：

```
var myArray = Array.ConvertAll(new int[100], i => -1); 
```

# emacs - 如何在 Emacs 中将 ESC 绑定到键盘转义退出？

> ID：648817
> 
> 赞同：20
> 
> 时间：2009-03-15T23:41:52.317
> 
> 标签：emacs

通常[，keyboard-escape-quit](http://www.gnu.org/software/emacs/manual/html_node/emacs/Quitting.html)绑定到`Esc``Esc``Esc`. 是否可以将其重新绑定到单个`Esc`？我从不使用 Escape 作为前缀键。

我在 Windows XP 上运行 Emacs 23.0.60.1。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-16T13:17:41.730

重新散列其他人的答案，我有

```
(global-set-key (kbd "<escape>")      'keyboard-escape-quit) 
```

在我的 .emacs 文件中，它适用于我在 WinXP 上的 emacs 22。我也讨厌连续输入 3 个 ESC；从多年的（Windows）习惯中，我的手指自然而然地进入了退出键，以摆脱任何不愉快的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T05:33:38.163

并不是说这适合你，但是当我遇到这个问题时，我教自己按 Ctrl-g 代替，默认情况下它也绑定到 keyboard-escape-quit。对我来说，这样做的好处是可以让我的左手非常靠近起始位置，同时让我的 Esc 前缀保持不变。

编辑：阅读链接页面后，它没有绑定到完全相同的功能，并且在 Windows 上 Ctrl-g 不能强制中断正在运行的命令，但 Ctrl-g 涵盖了我将使用 Esc Esc Esc 的 99% - -- 中止我输入错误的命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T05:06:34.627

你可以这样做，但以杀死 Esc 前缀键映射为代价执行此操作的代码是 (global-set-key "" 'keyboard-escape-quit) 其中有趣的字符是转义（使用 ^Q esc 到输入它）它会为你映射 esc 但键盘映射的其余部分在那之后就消失了

# asp.net-mvc - ASP.Net MVC 数据行验证

> ID：648819
> 
> 赞同：1
> 
> 时间：2009-03-15T23:43:17.850
> 
> 标签：asp.net-mvc, validation, datarow

我正在 delevelopring 我的第一个 MVC 应用程序，我正在使用经典的 ADO.NET 数据集作为模型。我遵循的指南是[NerdDinner ASP.NET MVC 教程](http://aspnetmvcbook.s3.amazonaws.com/aspnetmvc-nerdinner_v1.pdf)，它提到了 Linq To SQL 模型的 GetRuleViolations() 方法。我想要一种类似的方法来检查数据行在编辑后是否有效。我怎么能做这种事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T00:13:18.277

数据集已断开连接。因此，除非您手动添加约束，否则它们不支持验证规则。

编辑：从链接：

> 我们将通过向我们的项目添加“部分类”来实现 IsValid 和 GetRuleViolations()。部分类可用于将方法/属性/事件添加到由 VS 设计器维护的类（如 LINQ to SQL 设计器生成的 Dinner 类），并帮助避免工具与我们的代码混淆。

你可以对类型化的数据集做类似的事情。

[请参阅有关使用类型化数据集进行验证的](http://www.codeproject.com/KB/architecture/SimpleValidation.aspx?display=Print)链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T00:14:20.647

我想您应该仅将数据集用于数据传输。不适用于业务规则验证。通过这种方式，您仍然可以遵循教程并保留存储库。但是用您自己的数据集代码替换存储库中的所有 Linq to SQL 代码。

您的业​​务对象将是实现该`GetRuleViolation()`方法的对象。

# refactoring - 软件重写与运行成本分析

> ID：648821
> 
> 赞同：6
> 
> 时间：2009-03-15T23:44:16.023
> 
> 标签：refactoring

我作为程序员工作的 IT 部门围绕着一个 30 多年的代码库（Fortran 和 C）。代码状况不佳的部分原因是 30 多年的临时考虑不周的更改，但我也怀疑这在很大程度上与进行更改的程序员的能力有关（顺便说一句，他们仍然大约）。

依赖软件的业务一年 363 天，每天 20 小时运行。不幸的是，有许多中断。这是我工作的第一个地方，有开发人员随时待命，将操作代码修复应用于生产系统。当我刚开始的时候，生产服务器上实际上有一份源代码和开发工具的副本，以便可以即时应用更改；幸运的是，这种做法现在已经停止。

我曾多次向管理层暗示，停机时间、随叫随到的开发人员、额外的运营人员、不满意的客户等在中期甚至可能是短期内给企业带来的成本要比实际成本高得多全力以赴地重写/重构/替换整个东西（代码库大约有 300k 行）。

理想情况下，他们会是一些外部咨询公司，可以进来并运行关于代码质量的规则以及保持其运行与重写/重构/替换它所涉及的成本。我的问题是，企业应该如何对软件进行这种成本分析并能够对该分析充满信心？街上的第一批 IT 顾问可能声称能够进行分析，但如何才能让管理层对内部员工告诉他们的内容感到满意呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-15T23:52:30.560

我们最近决定从头开始完全重写大部分业务代码，但它并没有像我们希望的那样顺利。我看到很多引述说你永远不应该尝试从头开始重写任何东西，现在我明白为什么了。我建议从小处着手——不要试图一次重写整个事情。识别大问题区域，并专注于一次重构系统的一小部分。由于该系统有 30 多年的工作价值，因此需要很长时间才能使其恢复到合理状态。我们有大约 5 到 8 年的工作需要重写，这很困难。我无法想象30多年的工作！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-15T23:58:55.707

首先想到的是您过早地解决了重写/重构/替换参数。我建议的第一步两个步骤是：

1.  单元测试
2.  质量保证

实施这些完全在工程范围内。在任何合理的重构或重写可能发生之前，单元测试是必不可少的初步步骤。通过“单元测试”，我的意思是用相应的代码包装每个函数调用，证明代码适用于所有已知条件。在复杂的改造中，这实际上可能不会发生在最细粒度的级别，但任何自动化测试都会有很大帮助。

和 QA - 有一个独立的（和积极的）质量保证团队，在生产之前严格测试 beta 版本。他们的测试计划和测试程序对于任何类型的更换工作都至关重要。

一旦您控制了代码，那么您就处于业务可以合理考虑大规模更改的位置。

只是关于您对外部顾问的评论的注释 - 没有顾问会足够关心代码以提供现实的质量保证。QA 最终嫁给了捍卫公司底线的商业精英。归根结底，这是一项内部职能，而外部顾问只能帮助您真正开始。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-16T00:00:16.437

首先，您需要的顾问的个人资料非常具体。除非您能找到在相似领域工作且使用相同语言的人，否则不要雇用他。

其次，有 99% 的可能性（我喜欢戏剧性的数字）分析如下：

*   顾问探索应用程序
*   顾问确实了解 10% 的申请
*   时间到了，报告时间
*   顾问建议完全重写（不重构，直接重写）

因此，您不妨考虑一下顾问的成本。

您在这里只有两个解决方案：

*   保留实际源代码，但确定解决问题的适当方法，以便您进行长期重构，由了解应用程序的人逐步进行
*   找一个二级团队制作一个新的应用程序来替换旧的应用程序

如果我谈论一个二级团队，那是因为你不能只带一个架构师来制作新应用程序并让旧团队与他一起工作：

*   他们忙于旧应用程序
*   会有摩擦，因为新人无疑会低估手头的任务

我是根据经验说话的，相信我。

如果您采用“新应用程序”方式，请不要抱太大希望。您最终会得到一个功能不到当前功能一半的应用程序，这仅仅是因为您无法将 30 多年的特殊情况和特殊情况修复塞进一个新设计的软件中。

哦，另外，如果您的开发人员碰巧告诉您他们有一个计划，请务必听取他们的意见。他们很可能知道他们在说什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T23:55:34.733

我认为您的描述提供了有关代码质量（缺乏）的所有必要信息。需要如此多的支持资源这一事实也表明维护现有系统所涉及的高成本。

[正如我在这里](https://stackoverflow.com/questions/605031/605046#605046)回答的那样，一个值得考虑的好方法是一次重构一个系统，直到一切工作在可接受的水平。我同意 Joel 不丢弃现有代码的观点（请参阅[您永远不应该做的事情](http://www.joelonsoftware.com/articles/fog0000000069.html)。您的部分代码可以正常工作，因此您应该尽可能将它们留在原处，并专注于导致停机的部分。

安迪还提出了一个很好的观点，即从小处着手。

另一件要尝试的事情是审查系统周围的流程。当你这样做时，你应该尝试确定哪些故障情况是由用户操作直接或间接导致的？是否存在配置或环境问题？如果您无法直接修复代码，那么您仍然可以通过更有效地处理外部问题来支持它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T00:32:36.920

代码已经存在了 30 年？

在过去的三年中，开发范式在很多方面发生了重大变化，我认为与您的困境最相关的是创建输入->处理->输出某些东西所需的时间（以人为单位） .

30 年前 300,000 行代码，今天可能适合 100,000 行或更少，并且花费更少的工时（？）这对某些人来说似乎是乐观/荒谬的，但另一方面*是*可以实现的，具体取决于应用程序的类型问题。您没有说明系统的分类 - 它是一种实时制造过程控制系统，带有传感器和执行器吗？航空公司订票系统？它是否对一些积压的数据进行后处理？换句话说，它可以用 Java 之类的东西重建，并用一个积极进取的小团队快速重建吗？需求是否已记录在案，如果是，是否需要从头开始更新或重新开发？人的安全是一个因素吗？

只是一个快速的健全性检查，我认为你是否应该重建取决于（任何顺序都意味着同样的事情）：

1.  所需的代码人员数量。
2.  上述人员的专业水平。
3.  哪些语言不适合。
4.  适合哪些语言。
5.  就硬件和软件而言，使用所选语言的成本是多少。
6.  企业在多大程度上依赖于此来维持活力。
7.  停机时间真的太多了，还是你只是在吹毛求疵？（也许他们真的不在乎，但假装在乎）。

祝你好运！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-16T01:05:36.653

1.  阅读《[有效地使用遗留代码》](https://rads.stackoverflow.com/amzn/click/com/0131177052)这本书（另请参阅[简短的 PDF 版本](http://www.objectmentor.com/resources/articles/WorkingEffectivelyWithLegacyCode.pdf)），并按照该书中的说明用自动化测试包围代码。

2.  一点一点地重构系统。如果你重写代码的某些部分，一次只做一个小子系统。不要试图进行[大重新设计](http://www.informit.com/articles/article.aspx?p=1235624&seqNum=3)。

# c# - 声明枚举时，是否应强制类型为 256 个以下实体的字节？

> ID：648823
> 
> 赞同：49
> 
> 时间：2009-03-15T23:46:25.597
> 
> 标签：c#, enums, types

如果您的应用程序中有一个枚举并且您只有几个项目，您是否应该强制底层类型为可能的最小类型？

```
 enum smaller : byte
    {
        one,
        two,
        three
    }; 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-15T23:48:12.083

不。不要过早地优化**，除非**你已经用分析器证明它实际上是一个问题。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-16T00:04:18.707

**与最佳实践相关：**

当您没有特殊原因将枚举设置为类型字节时，您应该将其保留为默认值。

任何时候在 switch 语句中使用枚举时，都应该有一个用于无效枚举值的“默认”子句。因此，检查 256-NumRealEnumValues 还是 2^32-NumRealEnumValues 并不重要。两者都有一个处理所有无效情况的默认子句。

显式设置枚举类型的一个原因是，如果您希望枚举对应于程序中的另一种类型，并且需要在它们之间显式转换。

将类型更改为最适合的类型也不会帮助您解决版本控制问题。除非您完全填写了枚举的最大大小。通过版本控制问题，我的意思是当你有一个使用枚举编译的 dll，然后你添加一个新的枚举值时，可能会执行一些不打算进入 switch 语句的“默认”子句的代码。

**与效率有关：**

不，使它成为一个字节在效率方面没有任何好处。

int 使用起来更高效，因为 x86 上的 cpu 具有 32 位寄存器。一次将 32 位复制到寄存器中。

当您使用较小的类型时，您必须将寄存器的一部分清零并复制到寄存器的其余低位。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-16T00:14:09.867

这样做的唯一原因是，如果您使用已定义的协议存储或传输该值，该协议要求该字段具有该大小。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-02-22T19:13:13.033

如果您将带有枚举的模型映射到另一个模型，或者对其进行序列化，或者您的枚举反映到数据库列中——那么我建议您明确指定类型。

* * *

场景：您在数据库中有一个列：`status_id`类型为`tinyint`。你的代码中有枚举：`enum Status { Well = 1, Bad = 2 }`. 你在某个实体中使用这个枚举。假设您使用实体框架核心 2.0。如果您尝试从数据库中读取/写入此实体，您将收到错误“无法转换对象”，除非您明确指定`byte`类型。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-15T23:50:21.920

会得到什么？您将节省高达 3 字节的内存，但代价是执行速度稍慢，代码不太直观或可读性较差。（读到这里，我不得不怀疑 pyou 是否真的有理由将它变成一个字节，以及那个原因可能是什么。大概是因为某种原因你特意使用了非默认类型）。

如果您打算存储数百万个这样的东西，那么可以，在每个上节省几个字节可能会得到回报。否则，没有。

这与您通常不使用 byte 或 short 代替 int 的原因相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T23:52:48.560

您不应该为枚举分配某个整数类型并让 C# 回退到默认值`int`¹ ~~，而是让 .NET 环境找出 enum 的最佳“大小”~~。正如 JaredPar 所说，*如果*您更改数据类型，您*绝对应该*检查它是否真的有帮助。

问题是 32 位整数在 x86 处理器上是“自然的”，因为它们可以很容易地以最佳方式对齐。

¹ [默认情况下，枚举成员关联的常量值为int类型](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/builtin-types/enum)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-01T20:23:53.790

在 .Net core 中，如果调用 Enum.IsDefined 来检查传入的值是否存在于枚举中，则应确保类型相同。

> ArgumentException：枚举基础类型和对象必须是相同类型或对象必须是字符串。

# php - 为什么会 print_r ($row); 只返回一个数字 1？

> ID：648837
> 
> 赞同：1
> 
> 时间：2009-03-15T23:55:42.593
> 
> 标签：php, mysql, mysqli

我正在尝试学习 PHP5，但遇到了一些问题。我正在使用准备好的语句并尝试运行以下代码：

```
<?php
require_once 'includes/config.php';

$conn = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME) or 
die('There was a problem connecting to the database.');

$query = "SELECT * FROM user_table";

    if($stmt = $conn->prepare($query)) {
        $stmt->execute();

        while ($row = $stmt->fetch()) {
            print_r ($row);
        }

    }

?> 
```

我有 2 行它应该返回每行包含一个 id、login_name、login_password 和一个 login_level。

当语句运行时，它只打印以下内容：

11

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T00:03:54.167

[fetch()](http://ca2.php.net/manual/en/mysqli-stmt.fetch.php)方法返回`TRUE`, `FALSE`, 或`NULL`取决于它是否成功获取数据。它不返回数组中的数据。相反，它将结果放在由[bind_result()](http://ca.php.net/manual/en/mysqli-stmt.bind-result.php)方法绑定的变量中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T00:07:05.237

它返回 1，因为 1 在 PHP 中为 TRUE。

您应该做的是将变量与该`[bind_result][1]`方法绑定，然后执行以下操作：

```
while ($stmt->fetch()) {
    printf ("%s\n", $variable);
} 
```

一个很好的例子是在[绑定结果文档页面上。](http://is.php.net/manual/en/mysqli-stmt.bind-result.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T00:11:22.387

为了能够以这种方式获得，您首先需要像这样绑定结果变量：

```
$stmt->execute();

// bind the result variables in order 
$stmt->bind_result($id, $login_name, $login_password, $login_level);

// then get results
while ($stmt->fetch()) {
    var_dump($id, $login_name, $login_password, $login_level);
} 
```

# asp.net - 登台环境应该等于现场环境多少？

> ID：648855
> 
> 赞同：4
> 
> 时间：2009-03-16T00:13:55.687
> 
> 标签：asp.net, windows, iis, staging

管理层已决定使用带有 IIS7 的 Windows 2008 64 位来为我们的主要网站提供服务。

他们希望将它放在带有 IIS6 的 Windows 2003 服务器上。　**[编辑]**是的 32 位是他们计划暂存的**[结束编辑]**

我想知道[除了安全问题之外](http://learn.iis.net/page.aspx/110/changes-between-iis6-and-iis7-security/)，我应该提出哪些问题，建议我们应该在暂存环境中选择与实际环境中相同的服务器。

我读过这样的好帖子[，](http://www.iisworkstation.com/2008/09/iis-6-and-iis-7-how-different-are-they.html)但我想要一些我可以用几个要点说的话

登台和现场环境应该是相同的，任何经验丰富的开发人员都很容易理解，我的问题是我试图向似乎已经下定决心的高层管理人员解释这一点......

* * *

**[编辑]** @卢克：

它基本上是一个经常更新的网站，在部署到实时环境之前，整个网站都将进行上演、测试。

该站点将由营销部门（非开发人员）负责，并让他们在部署之前验证该站点没有问题。

* * *

**[Edit++]** 代码为 ASP.NET，用于 3 个重要的客户订购页面。

谢谢，

里克

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T00:28:00.613

我希望这不是您用来测试 64 位 Windows 2008 生产服务器功能的 32 位 Windows 2003 临时服务器，或者您正处于痛苦的世界中。

登台服务器应该尽可能地等同于生产服务器，因为您使用它的目的是回答“这个软件在生产环境中工作吗？”这个问题。在实际承诺将其加载到生产环境之前。

回答“这个软件是否可以在与我们的生产服务器几乎完全不同的服务器上运行？” 没有用，实际上您所做的只是致力于在另一个环境中测试和调试软件，但在您不会实际使用的环境中。它的工作量更大，最终您仍然不知道它是否适用于您的生产环境，这是首先拥有一个登台服务器的全部意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T00:17:59.170

登台环境与现场匹配的越多，在测试中发现的问题就越多。如果你只有一个糟糕的匹配，就像你在这里一样，这限制了可能被发现的错误类型。例如，假设与 2008 64 位和网站的某些组件不兼容？在您上线之前，您不会找到它。这可能为时已晚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T01:24:49.527

也许你应该问他们他们认为暂存环境是什么。向他们解释，暂存环境的全部意义在于尽可能模仿生产环境。说明如果暂存环境要大不相同，您还不如没有它。然后，如果您没有它，您的生产站点将用于测试。告诉他们这真的没什么大不了的，只是该网站会崩溃几次，并且由于缺乏适当的登台，在您修复所有问题之前可能会出现一些重大的安全漏洞。我相信他们会理解的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T01:25:50.163

一般规则是您只能验证使用舞台和现场之间的公共子系统的更改。如果您只验证 HTML 副本更改，并且可以保证只有 HTML 从阶段滚动到现场，那么您可能会对网站将在现场运行充满信心。

舞台和现场之间有很多差异，以至于您无法验证任何编码或 IIS 配置更改。这将是“推动和祈祷”的生活。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T00:41:31.127

直播和分期当然应该是相同的技术（同一个盒子？）。但是你在这里展示什么，技术还是内容？如果暂存环境主要用于内容，那么您可能会因为两台服务器不同而侥幸成功。但是，如果您正在部署技术，那么您肯定会遇到无法正常工作的问题。我想，如果那个拿着钱包的人愿意为此负责，那就去吧……

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T01:09:42.417

从风险和金钱的角度向企业解释。

*   您的站点在生产部署时遇到问题的风险是众所周知的，而且并非微不足道。
*   由于不可预见的问题，您的网站停机的成本非常高。
*   您的支持人员和开发人员每次在生产中遇到问题时都需要花费大量时间，因为您的暂存环境没有回答正确的问题（“我的软件可以在生产中工作吗？”），并且加剧了前者。
*   深夜和重复部署失败可能导致的高压力水平会导致团队不开心、效率低下，从而导致无法接受的高流动率。
*   通过购买硬件来缓解所有这些问题的成本相对较低，许多知名工程师都将其推荐为最佳实践。

# unix - Shell 脚本 - 使用字符串列表搜索和替换多个文件中的文本

> ID：648862
> 
> 赞同：8
> 
> 时间：2009-03-16T00:21:51.113
> 
> 标签：unix, replace

我有一个文件“changesDictionary.txt”，其中包含（可变数量的）键值字符串对。

例如

"textToSearchFor" = "替换文本"

（字典的格式不重要，可根据需要更改。）

我需要遍历给定目录的内容，包括子目录。对于遇到的每个扩展名为“.txt”的文件，我们在 changesDictionary.txt 中搜索**每个**键，用替换字符串值替换每个找到的实例。

即搜索和替换多个文件，但使用搜索/替换术语列表而不是单个搜索/替换术语。

我怎么能这样做？（我研究过单个搜索/替换示例，但不明白如何在一个文件中进行多个搜索。）

只要我可以从 Mac OS X 的命令行运行它，实现（bash、perl 等）并不重要。感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T19:07:59.500

我会将您的 changesDictionary.txt 文件转换为 sed 脚本，使用... sed：

```
$ sed -e 's/^"\(.*\)" = "\(.*\)"$/s\/\1\/\2\/g/' \
      changesDictionary.txt  > changesDictionary.sed 
```

**请注意**，字典中正则表达式或 sed 表达式的任何特殊字符都将被 sed 错误解释，因此您的字典要么只能具有最原始的搜索和替换，要么您需要维护 sed 文件有效的表达。不幸的是，在 sed 中没有简单的方法来关闭正则表达式并仅使用字符串匹配或将您的搜索和替换引用为“文字”。

使用生成的 sed 脚本，使用 find*和*xargs——而不是 find -exec——通过一次处理多个文件，尽快使用 sed 脚本转换文件。

```
$ find somedir -type f -print0 \
   | xargs -0 sed -i -f changesDictionary.sed 
```

**请注意**，`-i`sed 选项“就地”编辑文件，因此请务必进行备份以确保安全，或用于`-i~`创建波浪号备份。

**最后一点**，使用搜索和替换可能会产生意想不到的后果。您的搜索是否是其他搜索的子字符串？这是一个例子。

```
$ cat changesDictionary.txt
"fix" = "broken"
"fixThat" = "Fixed"
$ sed -e 's/^"\(.*\)" = "\(.*\)"$/s\/\1\/\2\/g/' changesDictionary.txt  \
   | tee changesDictionary.sed
s/fix/broken/g
s/fixThat/Fixed/g
$ mkdir subdir
$ echo fixThat > subdir/target.txt
$ find subdir -type f -name '*.txt' -print0 \
   | xargs -0 sed -i -f changesDictionary.sed
$ cat subdir/target.txt
brokenThat 
```

“fixThat”应该变成“Fixed”还是“brokenThat”？sed 脚本的顺序很重要。类似地，搜索和替换可以多次搜索和替换——将“a”更改为“b”，稍后可能会被另一个搜索和替换从“b”更改为“c”。

也许你已经考虑过这两个，但我提到是因为我已经尝试过你之前正在做的事情并且没有想到它。我不知道任何可以一次进行多次搜索和替换*的正确方法。*因此，您需要对其进行编程以自己做正确的事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-16T00:31:20.030

这是我会做的基本步骤

1.  复制 changesDictionary.txt 文件
2.  在其中将 "a"="b" 替换为等效的 sed 行：例如（使用 $1 作为文件名）

    sed -e 's/a/b/g' $1

    （您可以编写一个脚本来执行此操作，或者只是手动执行，如果您只需要执行一次并且它不是太大）。

3.  如果文件都在一个目录中，那么您可以执行以下操作：

    ls *.txt | xargs scriptFromStep2.sh

4.  如果它们在子目录中，请使用 find 在所有文件上调用该脚本，例如

    寻找 。-name '*.txt' -exec scriptFromStep2.sh {} \;

这些都不准确，做一些实验以确保你做对了——这只是我会使用的方法。

（但是，如果可以的话，只需使用 perl，它会简单得多）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-26T04:10:16.830

使用这个工具，它是用 Perl 编写的——有很多花里胡哨的东西——老歌，但很好：

[http://unixgods.org/~tilo/replace_string/](http://unixgods.org/~tilo/replace_string/)

特征：

*   执行多个搜索替换或查询搜索替换操作
*   搜索替换表达式可以在命令行上给出或从文件中读取
*   处理多个输入文件
*   递归地进入目录并对所有文件执行多个搜索/替换操作
*   用户定义的 perl 表达式应用于每个输入文件的每一行
*   可选择在段落模式下运行（用于多行搜索/替换）
*   交互模式
*   批处理模式
*   可选择备份文件和备份编号
*   以 root 身份运行时保留模式/所有者
*   忽略符号链接、空文件、写保护文件、套接字、命名管道和目录名
*   可选地替换仅匹配/不匹配给定正则表达式的行

多年来，该脚本已被广泛用于大型数据集。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-06T14:22:15.563

```
#!/bin/bash
f="changesDictionary.tx"
find /path -type f -name "*.txt" | while read FILE 
do
    awk 'BEGIN{ FS="=" }
    FNR==NR{ s[$1]=$2;  next }
    {
       for(i in s){      
        if( $0 ~ i ){ gsub(i,s[i]) }
       }
       print $0
    }' $f $FILE  > temp
    mv temp $FILE
done 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-27T19:11:33.673

for i in `ls -1 /script/arq*.sh` do echo -e "ARQUIVO ${i}" sed -i 's|/$file_path1|/file_path2|g' ${i} done

# linq-to-sql - 可以在 Linq to SQL 中进行高级搜索吗？

> ID：648865
> 
> 赞同：2
> 
> 时间：2009-03-16T00:23:11.513
> 
> 标签：linq-to-sql, search

如果在 Dynamic Linq 中不使用“LIKE”，当我尝试创建高级搜索查询时，它实际上对我来说毫无用处。

在使用 Linq to SQL 时，你们中的任何人是如何克服这个高级搜索问题的？

我需要搜索以下字段类型，它们也可能为空：

*   项目清单
*   varchar（列 LIKE '%' + myText + '%'）
*   文本（列 LIKE '%' + myText + '%'）
*   DateTime（列 >= myDate - 如果“myDate”当然不为空）
*   整数（列 = myInt - 如果“myInt”当然不为空）
*   布尔值

我也不能只使用 ExecuteQuery，因为那样我就没有真正的“实体”以及所有它的关系/关联。

我只是不明白如何使用 Linq to SQL 做到这一点。我目前没有存储过程，所以如果我能用 Linq 解决这个问题，我宁愿没有一个存储过程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T00:39:49.383

要制作 LIKE 语句，您可以使用[Contains](http://msdn.microsoft.com/en-us/library/dy85x1sa.aspx)方法：

```
string myText = "test";
var query = dc.Table.Where(r=>r.Column.Contains(myText)); 
```

这将生成这种 SQL 语句：

```
SELECT [t0].[Column], ... [t0].[ColumnN]
FROM [Table] AS [t0]
WHERE [t0].[Column] LIKE @p0 
```

@p0 参数将具有`"%test%"`值。

对于 Date 和 int 比较，如果我正确理解你想要什么，你可以这样做：

```
DateTime? myDate = new DateTime(2009, 3, 15);
var query = dc.Table.Where(r=> r.DateColumn > myDate || myDate == null ); 
```

因此，如果 myDate 为 null，则`DateColumn > myDate`不会评估条件。

# vb.net - 在 VB.NET 中，我可以将函数标记为已弃用吗？

> ID：648876
> 
> 赞同：66
> 
> 时间：2009-03-16T00:34:08.680
> 
> 标签：vb.net, function, deprecated

VB.NET 中是否有能力弃用代码？我知道在 C# 中有“属性”和 java 中的标签；除了留下`'todo:`...之外，VB.NET 中还有什么类似的吗？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-03-16T00:35:46.943

VB.NET 中也有属性：

*   [https://msdn.microsoft.com/en-us/library/system.obsoleteattribute(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.obsoleteattribute(v=vs.110).aspx)
*   [http://www.vb-helper.com/howto_net_obsolete_attribute.html](http://www.vb-helper.com/howto_net_obsolete_attribute.html)

看起来像这样（在你的函数之前）

```
<Obsolete("This method is deprecated, use XXXX instead.")> _ 
```

从 VB.NET 10（.NET 4 及更高版本）开始，我们[不再需要下划线](https://msdn.microsoft.com/en-us/library/ff637436.aspx)。

```
<Obsolete("This method is deprecated, use XXXX instead.")> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-16T00:35:22.483

使用 [过时] 属性。

# eclipse - 黑莓调试输出

> ID：648877
> 
> 赞同：4
> 
> 时间：2009-03-16T00:34:23.530
> 
> 标签：eclipse, blackberry

运行调试模式时，BlackBerry Simulator 会向 Eclipse 的控制台输出大量信息。有没有过滤显示的信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-17T14:33:35.097

我一直在研究它，并且该选项在 Eclipse 中似乎不可用。它肯定存在于 JDE 中（编辑 -> 首选项 -> 调试选项卡 -> 显示选项卡 -> “将调试字符串记录到输出窗口”复选框）。

我会考虑查询[BlackBerry 开发人员论坛](http://supportforums.blackberry.com/rim/?category.id=BlackBerryDevelopment)或发送电子邮件至 devsupport@rim.com，请求在 Eclipse BlackBerry 插件中公开此选项。

# .net - MSTest、NUnit、MbUnit、xUnit.NET 测试运行器的标准输出

> ID：648880
> 
> 赞同：1
> 
> 时间：2009-03-16T00:36:27.770
> 
> 标签：.net, unit-testing, build, nunit, mstest

您如何在任何常见的 .NET 测试框架 MSTest、NUnit、MbUnit 或 xUnit.NET 中让命令行测试运行程序输出一个简单的 yes/no 或 true/false 或 1/0 是否所有测试通过还是失败？

我愿意接受以下解决方法：

1.  如果所有测试都通过则不输出，如果有任何失败则输出。
2.  失败的测试计数。我可以寻找零或非零值。
3.  其他类似于 #1 或 #2 的事情

哪些框架提供了这种能力？

我今天玩了一些 MSTest，但没有看到让 MSTest.exe 输出我可以使用的东西的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T06:48:14.570

如果您愿意，它们都会输出 XML（尤其是[MSTest](https://en.wikipedia.org/wiki/Visual_Studio_Unit_Testing_Framework)）。您可以像[我](http://preetsangha.blogspot.com/2008/05/decoding-ms-test-trx-file.html)的 MSTest 版本一样使用 XSLT。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-10T11:55:13.077

看看[Gallio](http://www.gallio.org/)，MbUnit 所基于的框架和其他工具（测试运行器等），但它也处理输出 MSTest、NUnit、RSpec 等。

虽然这并不完全符合您的要求，但如果您使用 Gallio 测试运行程序的输出，那么您将获得对测试格式的免费支持 - 它本质上是标准输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-20T18:54:03.623

MSTest 和大多数其他运行程序返回一个您可以检查的退出代码。

# lamp - PDT Eclipse 在保存时自动上传

> ID：648885
> 
> 赞同：4
> 
> 时间：2009-03-16T00:39:49.540
> 
> 标签：lamp, dreamweaver, eclipse-pdt, autosave

我正在从 Dreamweaver 强制工作环境迁移到自由选择的工作环境。也就是说，我必须说我对能够使用 Dreamweaver PDT 非常感兴趣。但是，我已经非常依赖“保存时自动上传”功能的使用。

我正在开发 LAMP，但面向 Windows 基础多数，所以我真的必须运行 Windows 本机并为 IE 进行大量测试，所有项目在 FF 和 Safari 上运行顺利，IE 确实是瓶颈。另一方面，我喜欢让我的项目由服务器的克隆服务，所以我有一个运行 Linux 的 Windows 上的虚拟机，作为我的开发服务器。

正如你所知道的那样，保存时的自动更新就像一个魅力。

我已经挖掘了一些文档，并且我也搜索了很多，但没有发现任何东西（除了 Aptana）可以满足我的需求。我正在寻找错误的方向，或者 Eclipse 真的没有这样的东西吗？

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-06T15:20:22.543

在使用不同的设置几个月后，我开始使用一种非常适合我需要的组合，尽管我应该分享。

Eclipse 作为插件运行 Aptana。

Eclipse 的所有功能和 Dreamweaver 的所有可用性以及一些不错的 Aptana 好东西。也就是说，在将 Aptana 作为插件安装后，只需在 /scripts 目录下创建一个新文件（或将该文件放入您永远不会关闭的项目中）并在其中添加以下代码：

```
/* 
 * Menu: gMan > Upload On Save 
 * Kudos: Ingo Muschenetz 
 * License: EPL 1.0 
 * Listener: commandService().addExecutionListener(this); 
 * DOM: http://localhost/com.aptana.ide.syncing.doms
 * DOM: http://download.eclipse.org/technology/dash/update/org.eclipse.eclipsemonkey.lang.javascript 
 */  

function commandService() 
{ 
   var commandServiceClass = Packages.org.eclipse.ui.commands.ICommandService; 
   var commandService = Packages.org.eclipse.ui.PlatformUI.getWorkbench().getAdapter(commandServiceClass);
   return commandService; 
} 

function preExecute(commandId, event) {}

function postExecuteSuccess(commandId, returnValue) 
{ 
   if (commandId == "org.eclipse.ui.file.save") 
   { 
       sync.uploadCurrentEditor(); 
   } 
}

function notHandled(commandId, exception) {} 

function postExecuteFailure(commandId, exception) {} 
```

因此，如果您正在处理的项目在每次保存时都激活了同步连接，那么您将把文件上传到服务器。

希望它能为您节省一些时间！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-09T04:29:55.683

这些解决方案都不适用于我的 PHP 文件。第一个解决方案适用于除 PHP 之外的所有其他文件类型，而第二个解决方案似乎对我没有任何作用。我正在使用带有 Aptana Studio 2 的 Eclipse Helios 3.6.1 - 为什么 Aptana Studio 不支持宇宙中最常见的服务器端脚本文件类型，这与大白鲨上的山雀一样有意义。

对于那些在互联网上广泛搜索但没有找到解决这个烦人问题的方法的 PHP 开发人员，我有我认为是下一个最好的东西。

安装[这些密钥](http://www.jaynay.com/util/MyEclipseKeys.csv)。

此键盘映射集是 Eclipse Helios 3.6.1 附带的默认键盘映射，并添加了上传快捷方式。

这适用于文件视图窗口作为您的主要文件列表查看器。首先，确保您已启用“与编辑器链接”（文件视图窗口顶部的图标有两个金色水平箭头）。现在，当您编辑任何文件类型的文件（上下文：在结构化文本编辑器中编辑）并且想要保存和上传当前文件时，您可以使用以下按键：

`CTRL`+ `S` （保存文件）

`CTRL`++ （将切换到文件视图窗口，并且由于您启用了“`SHIFT`与`U` 编辑器链接”，因此您当前的文件将被突出显示）

`CTRL`+ `SHIFT`+ `U` （将上传文件）

阅读这些说明可能看起来很痛苦，但实际过程非常简单，您可以在大约 5 分钟后闭上眼睛甚至无需思考即可完成。

我选择了`CTRL`++ `SHIFT`，`U`因为这是我在Dreamweaver 中用来将文件“放入”远程服务器的关键命令。显然，您可以设置任何您喜欢的键。

不管怎样，看它的价值。每次上传 PHP 文件时，这比使用鼠标在上下文菜单中导航要好得多。

单词。周杰伦

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T00:46:52.440

您可以通过 Windows 资源管理器创建 ftp 连接，也可以将 ftp 位置安装为驱动器，然后像往常一样通过 eclipse 访问它。这就是我在过去所做的工作做得足够好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-01T21:47:39.617

Eclipse（至少 Helios）中有一些东西。它被称为远程服务器资源管理器（RSE）。您可能需要使用“安装新软件”=> 通用工具来安装运行时包。

然后您应该能够创建一个新项目（常规），但您可以自定义位置并选择 RSE 文件系统，而不是保留默认位置。定义一个新的连接或使用现有的连接到您的 (s)ftp 服务器。

这不适用于 PHP 项目类型 (Eclipse PDT)，因为出于某种原因，您无法选择其他文件系统。在这些项目中，您可以执行类似的方法，将每个文件定义为位于远程服务器上（新建 => 常规 => 文件），然后使用“文件系统中的文件链接”设置。但这是一个皮塔饼；您需要浏览到您添加的每个文件的位置。

我已经找了好几个小时寻找体面的替代品。aptana 插件是我发现的一个小错误。当然你可以使用脚本和所有...我猜大多数 Eclipse 开发人员并不真正需要这个特性。

我最终决定使用 Netbeans。它是体面的、免费的、轻量级的，它拥有 PHP 开发和调试的一切。顺便说一句，其他语言也有，但我没有尝试过。它阻止了我浪费时间。

干杯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-15T15:43:42.230

这与 Aptana 2.0 完美配合：http: [//juergen-schwind.de/Save-and-Upload-Current-File-fuer-Aptana-Studio-1-5_9.html](http://juergen-schwind.de/Save-and-Upload-Current-File-fuer-Aptana-Studio-1-5_9.html)

```
/*
 * Key: M1+M2+S
 * Menu: Synchronize > Save and Upload Current File
 * Kudos: Juergen Schwind
 * License: EPL 1.0
 * DOM: http://localhost/com.aptana.ide.syncing.doms
 * DOM: http://download.eclipse.org/technology/dash/update/org.eclipse.eclipsemonkey.lang.javascript
 */

function main(){
    editors.activeEditor.save();
    sync.uploadCurrentEditor();
} 
```

它更干净，并且适用于所有文件类型（包括 php）。我将它安装在当前项目的脚本目录中。在某处我读到您可以制作项目，例如“Nice Scripts”，您可以在其中保存您想要在所有项目中使用的所有脚本。而不是在其他项目中引用该项目，没有尝试过，但也许有人会需要它。

而且我发现这非常有用：docs.aptana.com/docs/index.php/Assigning_a_keyboard_shortcut_to_a_snippet

> 注意M1是Control/Command，M2是Shift，M3是Alt/Option

随意将其应用于包含“Key：M1+M2+S”的注释的第一行，我将其更改为 M1+R，因为它与任何现有的快捷方式都不冲突。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-20T10:54:24.380

我使用 FileSync 它是一个椭圆插件。在 zend studio 9 中，它已经安装，您只需要启用它。

启用后，请执行以下操作

项目右键-->属性-->文件同步

然后只需添加项目文件夹。和默认目标路径找到您的目标文件夹

（我的目标文件夹是我的开发服务器，我只是将它映射到我的本地驱动器）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-26T12:09:12.320

作为我在[这个](https://stackoverflow.com/questions/17634283/eclipse-auto-upload-on-save-without-aptana/24430065#24430065)问题中的回答：

> 这是我的建议，它不是快速的方法，但非常可定制。在eclipse中你可以设置外部工具。也就是说，你可以设置一个php/java脚本文件作为外部程序，并发送一些eclipse给你的参数(${resource_loc} ${project_name} ${resource_path})。因此，使用脚本文件，您可以登录 SSH 或 FTP 或任何您想要的，并将您的文件或项目与远程系统同步。只需在 eclipse 的 External Tools Configuration 窗口中，您必须将 Location 设置为 /usr/bin/php，在 Arguments 中，您可以使用 eclipse 变量将脚本路径设置为脚本 args。最后，如果可能，您应该为外部程序分配一些快捷键。

# c++ - 如何在 C++ 中按值传递引用？

> ID：648888
> 
> 赞同：2
> 
> 时间：2009-03-16T00:41:25.917
> 
> 标签：c++, reference, constants, immutability

我正在尝试在 C++ 中创建不可变类型（类），

我这样做是为了让所有方法“又名成员函数”都不会修改对象并返回一个新实例。

我遇到了很多问题，但它们都围绕 C++ 中的引用类型。

一个示例是通过引用传递相同类类型的参数时：

```
Imm Imm::someOp( const Imm& p_im ) const
{
   ...
   p_im = p_im.someOtherOp(); //error, p_im is const, can't modify it!
   ...
} 
```

该错误是由通过引用传递值引起的。相反，如果我是按值传递引用，那么上面的错误行就不会是错误！

考虑一个 Java/C# 示例

```
class Imm
{
    ...
    Imm someOp( Imm p_im )
    {
        ....
        p_im = p_im.someOtherOp(); //ok, you're not modifying the 
                 //original object, just changing the local reference
        ....  
    }
    ....
} 
```

我怎样才能在 C++ 中做这样的事情？我知道我可以使用指针，但后来我遇到了整个内存管理混乱。我不想担心谁拥有对对象的引用。

理想情况下，我想将类设计为类似于 python 中的不可变字符串；您可以在没有注意到甚至不知道它们是不可变的情况下使用它们，并且它们的行为符合您的预期；他们只是工作。

**编辑**

当然，我可以通过按值传递或使用临时变量（这是我目前正在做的）来解决它。我要问的是“如何在 C++ 中按值传递引用”

我期待答案围绕 STL 中的某些内容展开，我目前正在研究 smart_ptr 模板系列。

**更新**

感谢您的回复，我意识到指针无法逃脱。（见我的[另一个问题](https://stackoverflow.com/questions/653211/stl-class-for-reference-counted-pointers)，这真的是对这个问题的跟进）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T00:50:09.157

根据定义，赋值不是常量操作吗？

您看起来好像正在尝试将某些内容分配给 const 引用，这完全违背了 const 引用的想法。

我认为您可能正在寻找指针而不是参考。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T01:30:55.797

在 Java 和 C# 中，您并没有真正处理引用 - 它们更像是句柄或指针。C++ 中的引用实际上是原始对象的另一个名称，而不是指向它的指针（尽管它可以用指针实现）。当您为引用分配值时，您正在分配给对象本身。在初始化引用时可以使用`=`字符存在混淆，但它是初始化，而不是赋值。

```
 Imm im, im2, im3; 
 Imm &imr = im;  // initialize a reference to im
 imr = im2; // assign im2 to imr (changes the value of im as well)
 Imm *imp = &im; // initialize a pointer to the address of im
 imp = &im3; // assign the address of im3 to imp (im is unnaffected);
 (*imp) = im2; // assign im2 to imp (modifies im3 as well). 
```

如果您特别想通过“按值引用”，那么您实际上是在要求一个矛盾。根据定义，引用是通过引用传递的。正如在别处指出的那样，您可以按值传递指针，也可以直接传递值。如果你真的想要，你可以在一个类中保留一个引用并通过值传递它：

```
 struct ImmRef
 {
     Imm &Ref;
     ImmRef(Imm &ref) : Ref(ref) {}
 }; 
```

另请注意，应用于引用的 const 使引用的对象成为常量，而不是引用。引用总是常量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T04:24:38.330

它在 C++ 中不像那样工作。

当您传递对对象的引用时，实际上是在传递对象内存中的地址。引用也不能重新定位到其他对象，因此 C++ 格言“引用就是对象”。您必须制作副本才能对其进行修改。Java 将在幕后为您完成这项工作。C++，你只需要复制它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T00:45:47.030

你不是忘了把你调用的方法设置为const吗？

编辑：所以，在 const 固定的情况下。

也许你应该做类似的事情

```
Imm & tmp = p_im.someOtherOp(); 
```

然后对 tmp 变量做进一步的操作。

如果您将变量或参数设置为 const & 您就不能分配给它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T00:58:49.433

您需要制作传入参数的新副本。你可以用几种等效的方式做你想做的事：1）你可以按值传递：

```
Imm Imm::someOp( Imm im ) const {
   im = im.someOtherOp();      // local im is a copy, original im not modified
   return im;                  // return by value (another copy)
} 
```

或 2）您可以通过引用传递并显式复制：

```
Imm Imm::someOp( const Imm & im ) const {
   Imm tmp = im.someOtherOp(); // local tmp is a copy
   return tmp;                 // return by value (another copy)
} 
```

两种形式是等价的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T05:20:56.870

检查此以了解临时寿命[http://herbsutter.wordpress.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/](http://herbsutter.wordpress.com/2008/01/01/gotw-88-a-candidate-for-the-most-important-const/)

```
Imm Imm::someOp( const Imm& p_im ) const
{
   ...
   //Imm& im = p_im.someOtherOp();       // will *not* work
   const Imm& im = p_im.someOtherOp();   // will work, but you get a const reference
   ...
} 
```

但是你可以使用 boost::shared_ptr

```
shared_ptr<Imm> Imm::someOtherOp() const
{
  shared_ptr<Imm> ret = new Imm;
  ...
  return ret;
}

shared_ptr<Imm> Imm::someOp(const share_ptr<Imm>& p_im) const
{
  shared_ptr<Imm> im = p_im->someOtherOp();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-24T00:27:11.480

C++ 有比不可变类型更好的东西——<code>const。根据您的需要，单一类型可以是可变的或不可变的。也就是说，有一些有用的模式可以处理短寿命（近）副本：

```
void f(const X &x) {
  // Trivial case: unconditional copy
  X x2=transform(x);
  // Less trivial: conditional copy
  std::optional<X> maybe;
  const X &use=need_copy ? maybe.emplace(transform(x)) : x;
  use.go();  // whichever, x or *maybe
}  // *maybe destroyed iff created, then x2 destroyed 
```

`std::unique_ptr`可以在 C++17 之前以类似的方式使用，尽管该函数当然可以 throw `std::bad_alloc`。

# linq - 挣扎于 .ToList() 返回 EntitySet<...>，而不是 IList<..>

> ID：648891
> 
> 赞同：1
> 
> 时间：2009-03-16T00:42:40.640
> 
> 标签：linq, entityset

我正在尝试`Id`从对象 heirachy 中深几级的集合中检索 's 列表。当我尝试执行 a`ToList()`时，我一直在检索到一个`EntityList<>`.. 这意味着它不允许我检索实例的`BarId`属性，因为它`EntitySet`是一个`Enumerable`，而不是单个实例对象。

```
Foo.Child1 (1 to 1)
Child1.Children2 (0 to many of type Bar)
Bar.BarId int;

IList<Foo> fooList = (from blah blah blah).ToList();

var children2List = (from x in fooList
select x.Child1.Children2).ToList(); 
```

它不断返回`children2List`作为一个`EntitySet<Bar>`，而不是一个`IList<Bar>`。因此，我正在努力`BarId`从`children2List`.

请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T00:59:02.693

您可以使用：

```
var children2List = fooList.SelectMany( x => x.Child1.Children2 ).ToList(); 
```

这将允许您执行以下操作：

```
children2List.ForEach( b => b.BarId.Print() ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T00:53:17.167

在您的查询中，您将整个结果变成一个列表，而不是单个 Children2 集合。尝试

```
var children2List = (from x in fooList
select x.Child1.Children2.ToList()).ToList(); 
```

这会将每个 Children2 变成一个列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T01:44:17.093

`EntitySet<T>`工具`IList<T>`，所以你已经*回来*了`IList<Bar>`。

# javascript - 一个关于跨域（子域）ajax请求的问题

> ID：648899
> 
> 赞同：55
> 
> 时间：2009-03-16T00:49:44.540
> 
> 标签：javascript, ajax

[假设我从http://www.example.com/index.html](http://www.example.com/index.html)加载了主页。[在该页面上有向http://n1.example.com//echo?message=hello](http://n1.example.com//echo?message=hello)发出 ajax 请求的 js 代码。当收到响应时，主页上的 div 将使用响应正文进行更新。

这适用于所有流行的浏览器吗？

编辑：

显而易见的解决方案是在 www.example.com 和 n1.example.com 前面放置一个代理并设置它，以便每个发往[http://www.example.com/n1](http://www.example.com/n1)子资源的请求都被代理到[http： //n1.example.com/](http://n1.example.com/)。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2010-03-06T15:09:44.587

跨域是完全不同的主题。但是跨子域相对容易。您需要做的就是在父页面和 iframe 页面中将 document.domain 设置为相同。

```
document.domain = "yourdomain.com" 
```

[更多信息在这里](https://web.archive.org/web/20170615000649/http://hoppeweb.blogspot.in/2008/03/cross-sub-domain-javascript-ajax-iframe.html)

注意：这种技术[只会让您与来自您域**的**父级的*iframe*](https://stackoverflow.com/a/3076648/5257399)进行交互。它不会**改变**XMLHttpRequest 发送的 Origin。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-11-30T15:29:17.997

所有现代浏览器都支持 CORS，因此我们应该利用这个添加。

它适用于简单的握手技术，两个域通过发送/接收的 HTTP 标头相互信任。这是期待已久的，因为同源策略对于避免 XSS 和其他恶意尝试是必要的。

要发起跨域请求，浏览器会发送带有 Origin HTTP 标头的请求。此标头的值是提供该页面的站点。例如，假设[http://www.example-social-network.com](http://www.example-social-network.com)上的页面尝试访问 online-personal-calendar.com 中的用户数据。如果用户的浏览器实现了 CORS，则会发送以下请求标头：

来源：[http ://www.example-social-network.com](http://www.example-social-network.com)

如果 online-personal-calendar.com 允许该请求，它会在其响应中发送一个 Access-Control-Allow-Origin 标头。标头的值指示允许哪些源站点。例如，对上一个请求的响应将包含以下内容：

访问控制允许来源：[http ://www.example-social-network.com](http://www.example-social-network.com)

如果服务器不允许跨域请求，浏览器将向 example-social-network.com 页面发送错误，而不是 online-personal-calendar.com 响应。

为了允许访问所有页面，服务器可以发送以下响应标头：

访问控制允许来源：*

但是，这可能不适用于需要考虑安全性的情况。

在下面的 wiki 页面中有很好的解释。 [http://en.wikipedia.org/wiki/Cross-origin_resource_sharing](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-16T01:47:15.820

另一种可能对您有用也可能无效的解决方案是在您的 DOM 中动态插入/删除指向目标域的脚本标签。如果目标返回 json 并支持回调，这将起作用。

处理结果的函数：

```
<script type="text/javascript">
  function foo(result) {
    alert( result );
  }
</script> 
```

您可以动态插入如下内容，而不是执行 AJAX 请求：

```
<script type="text/javascript" src="http://n1.example.com/echo?callback=foo"></script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-26T23:07:40.313

新想法：如果您想要跨子域（www.domain.com 和 sub.domain.com）并且您正在使用 apache。事情会变得容易得多。如果子域实际上是 public_html 中的子目录（sub.domain.com = www.domain.com/sub/。所以如果你有 ajax.domain.com/?request=subject...你可以这样做：www .domain.com/ajax/?request=subject

对我来说就像一个魅力，没有愚蠢的黑客，代理或困难的事情只需要几个 Ajax 请求！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-30T11:55:24.220

另一种解决方法是将 ajax 请求定向到您域上的 php（例如）页面，并在该页面中向子域发出 cURL 请求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-21T21:25:51.380

我找到的最简单的解决方案是在您的子域上创建一个 php，并使用完整路径在其中包含您的原始函数文件。

例子：

> www.domain.com/ajax/this_is_where_the_php_is_call.php

子域：

> sub.domain.com

创建：sub.domain.com/I_need_the_function.php

> 在 I_need_the_function.php 中只使用一个包含：
> 
> include_once("/server/path/public_html/ajax/this_is_where_the_php_is_call.php");

现在从您的 javascript 调用 sub.domain.com/I_need_the_function.php。

```
var sub="";
switch(window.location.hostname)
{
case "www.domain.com":
sub = "/ajax/this_is_where_the_php_is_called.php";
break;
case "domain.com":
sub = "";
break;
default: ///your subdomain (or add more "case" 's)
sub = "/I_need_the_function.php";
}

xmlHttp.open("GET",sub,true); 
```

这个例子很简单。您可能希望使用格式更好的路径。

我希望这可以帮助别人。这里没有什么乱七八糟的——你正在调用原始文件，所以任何编辑都将应用于所有函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-14T03:16:08.663

我为跨子域编写了一个解决方案，它一直在为我的应用程序工作。我在两边都使用了 iframe 并设置了 document.domain="domain.com" 。您可以在以下位置找到我的解决方案：

[https://github.com/emphaticsunshine/Cross-sub-domain-solution](https://github.com/emphaticsunshine/Cross-sub-domain-solution)

# c++ - C++ 模板，未定义的引用

> ID：648900
> 
> 赞同：30
> 
> 时间：2009-03-16T00:50:01.513
> 
> 标签：c++, templates, g++, undefined-reference

我有一个这样声明的函数：

```
template <typename T> 
T read(); 
```

并定义如下：

```
template <typename T>
T packetreader::read() {
    offset += sizeof(T);
    return *(T*)(buf+offset-sizeof(T)); 
} 
```

但是，当我尝试在 main() 函数中使用它时：

```
packetreader reader;
reader.read<int>(); 
```

我从 g++ 收到以下错误：

```
g++ -o main main.o packet.o
main.o: In function `main':
main.cpp:(.text+0xcc): undefined reference to `int packetreader::read<int>()'
collect2: ld returned 1 exit status
make: *** [main] Error 1 
```

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-16T00:53:12.223

您需要使用`export`关键字。但是，我认为 G++ 没有适当的支持，因此您需要在标头中包含模板函数的定义，以便翻译单元可以使用它。这是因为`<int>`尚未创建模板的“版本”，只有`<typename T>`“版本”。

一个简单的方法是`#include`.cpp 文件。但是，这可能会导致问题，例如当 .cpp 文件中有其他函数时。它也可能会增加编译时间。

一种干净的方法是将模板函数移动到它自己的 .cpp 文件中，并将其包含在标题中*或*使用`export`关键字并单独编译。

[关于为什么你应该尝试将模板函数定义放在其头文件中的更多信息（并`export`完全忽略）。](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2003/n1426.pdf)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-16T01:00:41.753

问题是函数模板不是函数。它是根据需要创建函数的模板。

因此，要使模板正常工作，编译器直观地需要两条信息：模板本身，以及应该替换到其中的类型。这与函数调用不同，编译器一旦知道函数存在就可以生成函数调用。它不需要知道函数做了什么，只需要知道它的样子`void Frobnicate(int, float)`，或者它的签名是什么。

当您声明函数模板而不定义它时，您只是告诉编译器存在这样的模板，而不是它的样子。这还不足以让编译器实例化它，它还必须能够看到完整的定义。通常的解决方案是将整个模板放在一个可以在需要的地方包含的标题中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-16T00:58:30.917

模板函数的最佳实践是在头文件中定义它们。它们是在编译时创建的，因此编译器必须有定义才能这样做。

当`export`for 模板将得到更多支持时，情况并非如此，但现在它仍然几乎不能使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T01:01:08.180

他们是否有任何编译器支持模板单独编译？

据我所知，通常的做法是在头文件中声明和实现模板函数

# java - Java 动态绑定

> ID：648903
> 
> 赞同：2
> 
> 时间：2009-03-16T00:51:33.490
> 
> 标签：java, binding, overloading, method-dispatch

我正在练习考试，发现了一个让我完全迷失的示例问题。对于以下代码，找到输出是什么：

```
class Moe {
    public void print(Moe p) {
        System.out.println("Moe 1\n");
    }
}
class Larry extends Moe {
    public void print(Moe p) {
        System.out.println("Larry 1\n");
    }
    public void print(Larry l) {
        System.out.println("Larry 2\n");
    }
}
class Curly extends Larry {
    public void print(Moe p) {
        System.out.println("Curly 1\n");
    }
    public void print(Larry l) {
        System.out.println("Curly 2\n");
    }
    public void print(Curly b) {
        System.out.println("Curly 3\n");
    }
}
public class Overloading_Final_Exam {
    public static void main (String [] args) {
        Larry stooge1 = new Curly();
        Moe stooge2 = new Larry();
        Moe stooge3 = new Curly();
        Curly stooge4 = new Curly();
        Larry stooge5 = new Larry();
        stooge1.print(new Moe()); 
        ((Curly)stooge1).print(new Larry()); 
        ((Larry)stooge2).print(new Moe()); 
        stooge2.print(new Curly()); 
        stooge3.print(new Curly()); 
        stooge3.print(new Moe()); 
        stooge3.print(new Larry()); 
        ((Curly)stooge3).print(new Larry()); 
        ((Curly)stooge3).print(new Curly()); 
        stooge4.print(new Curly()); 
        stooge4.print(new Moe()); 
        stooge4.print(new Larry()); 
        stooge5.print(new Curly()); 
        stooge5.print(new Larry()); 
        stooge5.print(new Moe()); 
    }
} 
```

我有我的想法，但是当我运行 java 时，我得到了完全不同的东西：

```
卷曲 1
卷曲 2
拉里 1
拉里 1
卷曲 1
卷曲 1
卷曲 1
卷曲 2
卷曲 3
卷曲 3
卷曲 1
卷曲 2
拉里 2
拉里 2
拉里 1

```

前几个还可以，后来真的看不懂了。有人对这个问题有很好的解释吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T01:06:17.840

我会从画图开始...

```
Moe - print(Moe)
 |
Larry - print(Moe), print(Larry)
 |
Curly - print(Moe), print(Larry), print(Curly) 
```

然后我会跟踪变量：

*   拉里 - stooge1 -> 卷毛
*   萌 - stooge2 -> 拉里
*   萌 - stooge3 -> 卷毛
*   卷曲 - stooge4 -> 卷曲
*   拉里 - stooge5 -> 拉里

*   `stooge1.print(new Moe())`

    *   stooge1 -> Curly 所以叫 Curly.print(Moe)
*   `((Curly)stooge1).print(new Larry());`

    *   stooge1 -> Curly 所以调用 Curly.print(new Larry())
*   `((Larry)stooge2).print(new Moe());`

    *   stooge2 -> Larry 所以叫 Larry.print(new Moe());
*   `stooge2.print(new Curly());`
    好的，这就是它变得有点棘手的地方（抱歉，我在此之前停止了一个）

    *   stooge2 被宣布为 Moe。因此，当编译器查看要调用什么时，它会调用 print(Moe) 方法。然后在运行时它知道 stooge2 是一个 Larry，所以它调用了 Larry.print(Moe) 方法。

ETC...

让我知道，如果一直这样做对您不起作用。

（更新以澄清下一个）

所以一般规则是：

*   编译器查看变量类型来决定调用什么方法。
*   运行时查看变量指向的实际类来决定从哪里获取方法。

所以当你有：

```
Moe stooge2 = new Larry();
stooge2.print(new Moe()); 
```

编译器说：

*   拉里可以分配到 stooge2 吗？（是的，因为拉里是萌的子类）
*   Moe 有 print(Moe) 方法吗？（是的）

运行时说：

*   我应该在此对象上调用 print(Moe) 方法... stooge2
*   stooge2 指向拉里。
*   我将在 Larry 类中调用 print(Moe) 方法。

一旦你完成了所有这些尝试摆脱一些方法，看看它如何改变事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T13:36:14.307

实际上，这个问题并不像看起来那么简单，因为 Java 既是静态的又是动态的。您必须先了解每个应用程序的应用位置，然后才能了解您从本练习中获得的所有结果。

TofuBeer 提到的一般规则只在动态绑定的情况下是正确的。在静态绑定中，仅在编译时做出决定。

您的示例混合了动态绑定（当方法被覆盖时）和静态绑定（当方法被重载时）。

请查看[此问题](https://stackoverflow.com/questions/321864/java-dynamic-binding-and-method-overriding/322234#322234)以获取更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T01:06:11.927

提示是在查看对象时忽略左侧的值。而是在声明的时候看一下right的值，这是对象的实际值。

# c - C内存分配问题

> ID：648907
> 
> 赞同：0
> 
> 时间：2009-03-16T00:57:11.137
> 
> 标签：c, malloc, double-free

所以我有几个函数可以与`string`我创建的类型一起使用。其中之一创建了一个动态分配的字符串。另一个接受所述字符串，并扩展它。最后一个释放字符串。注意：函数名称已更改，但都是我自定义的。

```
string new = make("Hello, ");
adds(new, "everyone");
free(new); 
```

上面的代码有效 - 它编译并运行良好。下面的代码不起作用 - 它编译、运行，然后

```
string new = make("Hello, ");
adds(new, "everyone!");
free(new); 
```

代码之间的区别在于该`adds()`函数增加了 1 个字符 (a `!`)。它添加的字符没有区别 - 只是长度。为了完整起见，以下代码不起作用：

```
string new = make("Hello, ");
adds(new, "everyone");
adds(new, "!");
free(new); 
```

奇怪的是，以下代码使用不同的函数`addc()`（添加 1 个字符而不是字符串）可以工作：

```
string new = make("Hello, ");
adds(new, "everyone");
addc(new, '!');
free(new); 
```

以下，也做同样的事情，工作：

```
string new = make("Hello, everyone!");
free(new); 
```

所有不起作用的错误都是这样的：

```
test(526) malloc: *** error for object 0x100130: double free
*** set a breakpoint in malloc_error_break to debug 
```

（`test`是我在其中的程序的极具描述性的名称。）

就函数内部而言，my`make()`是一个调用`strlen()`和两个调用`malloc()`和一个调用`memcpy()`，my`adds()`是一个调用`strlen()`、一个调用`realloc()`和一个调用`memcpy()`，而 my`free()`是对标准库的两个调用`free()`。

那么有什么想法为什么我会得到这个，还是我需要分解并使用调试器？我只能用`adds()`超过一定长度的 es 来获得它，而不是`addc()`s。

分解和发布功能的代码：

```
typedef struct _str {
  int _len;
  char *_str;
} *string;

string make(char *c)
{
    string s = malloc(sizeof(string));
    if(s == NULL) return NULL;
    s->_len = strlen(c);
    s->_str = malloc(s->_len + 1);
    if(s->_str == NULL) 
      {     
        free(s);
        return NULL;
      }
    memcpy(s->_str, c, s->_len);
    return s;
}

int adds(string s, char *c)
{
    int l = strlen(c);
    char *tmp;
    if(l <= 0) return -1;
    tmp = realloc(s->_str, s->_len + l + 1);
    if(!tmp) return 0;
    memcpy(s->_str + s->_len, c, l);
    s->_len += l;
    s->_str[s->_len] = 0;
    return s->_len;
}

void myfree(string s)
{
    if(s->_str) free(s->_str);
    free(s);
    s = NULL;
    return;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T01:19:45.590

第一个 malloc`make`应该是：

```
malloc (sizeof (struct _str)); 
```

否则，您只会为*指向*`struct _str`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T01:21:33.370

我会解决的一些潜在问题：

1/ 你`make()`的很危险，因为它没有复制字符串的空终止符。

`s`2/ 设置为`NULL`in也没什么意义，`myfree()`因为它是一个传递的参数，不会对传入的实际参数产生影响。

`adds()`3/如果添加的字符串长度为 0 或更少，我不确定为什么返回 -1 。首先，它不能是负数。其次，您可以添加一个空字符串似乎很合理，这应该导致不更改字符串并返回当前字符串长度。如果失败（即没有工作），我只会返回 -1 的长度，`realloc()`并确保在发生这种情况时保留旧字符串。

4 /即使变量可以更改，您也不会将`tmp`变量存储到`s->_str`其中-如果您增加大小，它很少会就地重新分配内存，尽管如果增加的大小足够小以适合由分配的任何额外空间，则它是可能的`malloc()`. `malloc()`除非您的实现为不同大小的内存块使用不同的缓冲池，否则减小大小几乎肯定会就地重新分配。但这只是一个问题，因为您从未使用此代码减少内存使用量。

5 /我认为你的*具体*问题是你只为字符串分配空间，它是指向结构的指针，而不是结构本身。这意味着当您将字符串放入时，您正在破坏内存领域。

这是我会编写的代码（包括更具描述性的变量名称，但这只是我的偏好）。

我改变了：

*   的返回值`adds()`更好地反映长度和错误情况。现在它只返回 -1 如果它无法扩展（并且原始字符串未被触及） - 任何其他返回值都是新的字符串长度。
*   `myfree()`如果你真的想用“”之类的东西将字符串设置为NULL，则返回`s = myfree (s)`。
*   签入`myfree()`字符串`NULL`，因为您现在永远不能在没有已分配`string`的情况下分配`string->strChars`。

在这里，使用（或不使用:-) 你认为合适的：

```
/*================================*/
/* Structure for storing strings. */

typedef struct _string {
    int  strLen;     /* Length of string */
    char *strChars;  /* Pointer to null-terminated chars */
} *string;

/*=========================================*/
/* Make a string, based on a char pointer. */

string make (char *srcChars) {
    /* Get the structure memory. */

    string newStr = malloc (sizeof (struct _string));
    if (newStr == NULL)
        return NULL;

    /* Get the character array memory based on length, free the
       structure if this cannot be done. */

    newStr->strLen = strlen (srcChars);
    newStr->strChars = malloc (newStr->strLen + 1);
    if(newStr->strChars == NULL) {     
        free(newStr);
        return NULL;
    }

    /* Copy in string and return the address. */

    strcpy (newStr->strChars, srcChars);
    return newStr;
}

/*======================================================*/
/* Add a char pointer to the end of an existing string. */

int adds (string curStr, char *addChars) {
    char *tmpChars;

    /* If adding nothing, leave it alone and return current length. */

    int addLen = strlen (addChars);
    if (addLen == 0)
        return curStr->strLen;

    /* Allocate space for new string, return error if cannot be done,
       but leave current string alone in that case. */

    tmpChars = malloc (curStr->strLen + addLen + 1);
    if (tmpChars == NULL)
        return -1;

    /* Copy in old string, append new string. */

    strcpy (tmpChars, curStr->strChars);
    strcat (tmpChars, addChars);

    /* Free old string, use new string, adjust length. */

    free (curStr->strChars);
    curStr->strLen = strlen (tmpChars);
    curStr->strChars = tmpChars;

    /* Return new length. */

    return curStr->strLen;
}

/*================*/
/* Free a string. */

string myfree (string curStr) {
    /* Don't mess up if string is already NULL. */

    if (curStr != NULL) {
        /* Free chars and the string structure. */

        free (curStr->strChars);
        free (curStr);
    }

    /* Return NULL so user can store that in string, such as
       <s = myfree (s);> */

    return NULL;
} 
```

我能看到的唯一其他可能的改进是保持空间缓冲区和末尾`strChars`以允许在不调用`malloc()`.

这将需要缓冲区长度和字符串长度，并且如果组合的字符串长度和新字符长度大于缓冲区长度，则将代码更改为仅分配更多空间。

这将全部封装在函数中，因此 API 根本不会改变。而且，如果你有时间提供函数来减小字符串的大小，它们也不必重新分配内存，它们只会减少缓冲区的使用。在这种情况下，您可能需要一个`compress()`函数来减少具有大缓冲区和小字符串的字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T01:51:33.127

```
 tmp = realloc(s->_str, s->_len + l + 1); 
```

realloc 可以返回一个指向请求块的新指针。您需要添加以下代码行：

```
 s->_str = tmp; 
```

它在一种情况下不会崩溃但在添加一个字符后会崩溃的原因可能只是因为内存的分配方式。可能有一个最小分配增量（在本例中为 16）。因此，当您为 hello 分配前 8 个字符时，它实际上分配了 16 个。当您添加所有人时，它不超过 16，因此您可以取回原始块。但是对于 17 个字符，realloc 返回一个新的内存缓冲区。

尝试更改添加如下

```
 tmp = realloc(s->_str, s->_len + l + 1);
 if (!tmp) return 0;
 if (tmp != s->_str) {
     printf("Block moved!\n"); // for debugging
     s->_str = tmp;
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T10:06:37.960

在 function`adds`中，您假设`realloc`不会更改需要重新分配的内存块的地址：

```
tmp = realloc(s->_str, s->_len + l + 1);
if(!tmp) return 0;
memcpy(s->_str + s->_len, c, l); 
```

虽然这对于小型重新分配可能是正确的（因为您获得的内存块的大小通常会四舍五入以优化分配），但通常情况并非如此。当 realloc 返回一个新指针时，您的程序仍然使用旧指针，从而导致问题：

```
memcpy(s->_str + s->_len, c, l); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T01:01:46.523

可能应该发布代码，但是双重释放意味着你在同一个指针上调用了两次 free。

1.  您是否将 1 添加到 strlen 最后的 \0 字节？
2.  一旦你释放了一个指针，你是否将你的成员变量设置为 NULL，这样你就不会再次释放（或已知的错误指针，如 0xFFFFFFFF）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T01:07:02.767

为什么“我的 free() 是对标准库 free() 的两次调用”。你为什么打两次免费电话？您应该只需要调用一次。

请张贴您的 add(); 和 free() 函数。

# c++ - 我可以在程序中定义的函数上使用 execvp() 吗？

> ID：648917
> 
> 赞同：0
> 
> 时间：2009-03-16T01:01:26.523
> 
> 标签：c++, function, exec

由于我的程序的组织方式，我有一个想使用 execvp() 调用的 C++ 函数。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T01:14:42.843

包括 execvp() 在内的所有 exec 变体只能调用文件系统中可见的完整程序。好消息是，如果你想在你已经加载的程序中调用一个函数，你只需要 fork()。它看起来像这样的伪代码：

```
int pid = fork();
如果（pid == 0）{
    // 在这里调用你的函数。这是一个新的过程，任何
    // 您所做的更改不会反映回父级
    // 变量。小心文件和共享资源，例如
    // 数据库连接。
    _exit(0);
}
否则如果（pid == -1）{
    // 发生错误，fork() 失败。这是一个非常罕见的
    // 错误，但你必须处理它。
}
别的 {
    // 等待孩子完成。您可以使用信号处理程序
    // 如果孩子需要很长时间，则稍后再捕获它。
    waitpid(pid, ...);
}

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T01:06:35.153

[excecvp()](http://linux.die.net/man/3/execvp)意味着启动程序而不是函数。因此，您必须将该函数包装到已编译的可执行文件中，然后让该文件的 main 调用您的函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T17:15:13.380

创建流程可能是重量级的。如果您真的只想并行调用您的函数，为什么不使用线程。有许多独立于平台的库可以支持 C++ 的线程，例如[Boost](http://www.boost.org)、[QT](http://www.qtsoftware.com/products/)或[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)。

If you really need your function to be executed in another process you can use [fork](http://opengroup.org/onlinepubs/007908775/xsh/fork.html) or [vfork](http://opengroup.org/onlinepubs/007908775/xsh/vfork.html). vfork may not be available on every platform and it has it's [drawbacks](http://www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/avoid-vfork.html) so make sure if you can use it. If not just use fork.

# deadlines - 你什么时候必须使用糟糕的设计来完成一个项目？

> ID：648923
> 
> 赞同：0
> 
> 时间：2009-03-16T01:04:43.957
> 
> 标签：deadlines

有许多不同的不良做法，例如内存泄漏，很容易在意外中滑入程序中。有时，他们甚至可以一起陪审你的程序。

我现在正在做一个项目，如果我故意在我的代码中放置内存泄漏，它就会起作用。如果我把泄漏出来，代码就会崩溃。显然这很糟糕，需要（并且将会）尽快修复。

我的问题是，如果没有这些不良做法就无法及时发布代码，那么您什么时候决定在这种状态下交付代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-16T01:11:00.963

如果可以合理预期该问题对系统实际使用的影响不会或可以忽略不计，并且交付日期不能推迟，并且可以在问题影响变得可以忽略不计之前的时间范围内修复，则发货.

显然，这并不理想，甚至不推荐，但此时您显然被推到了一个角落。有时没有好的选择，但实用主义必须战胜形式上的正确性。如果应用程序发生内存泄漏，但我们可以合理地预期应用程序将被回收或机器重新启动或在泄漏成为真正问题之前发生的任何事情，有时这比延迟交付要好。这取决于协议的条件和客户。

至少*尝试*推迟交货日期总是更好，但我假设您已经尝试过，这不是一个选择。

应用程序交付后通常会忽略[技术债务](http://martinfowler.com/bliki/TechnicalDebt.html)并继续前进。开发人员有责任向利益相关者清楚地传达偿还部分债务的重要性，尤其是在这种情况下。

然而，鉴于客户似乎更关心交货日期而不是正确性，一旦你上线，任何人都不太可能被说服偿还任何债务。这是一个糟糕的情况。只有掌握所有事实的人才能做出正确的选择。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-16T01:23:22.027

“我的问题是，如果没有这些不良做法就无法及时发布代码，你什么时候决定在这种状态下交付代码？”

绝不。

相反，你要做的是：优先考虑和专注。

如果你的工作是真正的高优先级，而你设计错误，那么就必须牺牲一些低优先级的东西。通常，必须延迟某些功能，以便让您有时间专注于不起作用的高优先级功能。

如果你正在做的事情真的是低优先级的，你必须问为什么你不做更高优先级的事情。而且您仍然必须集中精力并确定优先级。有时必须牺牲优先级很低的东西。

当你不能做“所有事情”时，你必须选择你*可以*做的事情，这将是合理的无错误的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T01:13:56.370

您可能对[技术债务](http://martinfowler.com/bliki/TechnicalDebt.html)的概念感兴趣。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-16T01:40:27.927

假设开发人员数量固定：功能、质量和发布日期，在发布软件时你只能转动三个旋钮，打开一个意味着其他的被拒绝。

软件开发中最困难的事情之一就是在构建您的产品时，旋钮设置得恰到好处。例如，永远的毁灭公爵（Duke Nukem Forever）将功能和质量旋钮调到 11 位，并将发货日期旋钮扔出窗外。微软似乎经常将发货日期旋钮粘在适当的位置并根据需要调低功能旋钮，然后解开发货日期旋钮，将其向上转动一点，将其粘回并继续旋转另外两个。似乎有无穷无尽的产品一直在发布，但从未加入成功所需的功能。

最后，如果你不交付，你就不会得到报酬。从长远来看，质量差会严重伤害你；声誉很难重建。几乎总是正确的做法是在有太多错误的情况下削减功能。总是。

但是，错误分类与功能开发一样重要。我们在这里谈论什么样的泄漏？你在泄漏一个字节吗？一个小物件？一千个物体？整个DLL？在某些情况下，泄漏一点可能比未能交付产品更好。

你说的泄漏是什么意思？您的应用程序是否有明确定义的生命周期？您在启动时分配一次然后在进程终止之前永远不会释放它的地方？那么您的流程运行多长时间？您是否希望运行您的流程的多个副本？

显然，您永远*不想*泄漏，您应该努力开发将泄漏降至最低的最佳实践，但最终您必须做出判断。也许您可以向您的客户解释错误，解释影响，他们无论如何都会购买。也许你可以在一周后修补它。也许你真的需要修复它。但我们需要更多地了解它才能给出好的建议。

我会说我过去曾运送过已知的泄漏。我不会说什么产品或公司，但我有一个错误，即 DLL 依赖项和疯狂的生命周期管理使得我们几乎不可能在加载后正确释放对某个 DLL 的引用，所以最后我们只是泄露了它。而且我仍然认为这是正确的做法。其他时候，我看到故意泄露的东西是为了防止错误编写的第三方代码崩溃（尽管这是一个完全独立的争论）。

但最后我相信这种情况很少见，一旦你确定了内存泄漏的来源，修复它应该不会超过一天。实际上，我很少会附带已知的内存泄漏和已知的修复程序。它必须是需要进行重大重新架构的事情，涉及更改线程模型或重构大量代码，并且实际上必须在一两天后才能发布产品。那时我可能只是泄漏内存并承诺在对重新架构师进行适当测试后会在弱中提供补丁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T01:14:06.917

发布这样一个已知的错误，我会非常不舒服。它很可能以另一种方式发生。

您尚未指定您的环境或语言，但我建议您使用内存检查工具，例如：

[净化](http://www-01.ibm.com/software/awdtools/purify/)（可试用）

[边界检查器](http://www.compuware.com/products/devpartner/visualc.htm)

[瓦尔格林德](http://www.cprogramming.com/debugging/valgrind.html)

甚至是免费的[Visual Leak Detector](http://www.codeproject.com/KB/applications/visualleakdetector.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-16T01:36:17.453

也许，当您以后不打算维护代码时，您就不会关心您的客户/雇主，并且您的代码的任何后果都不会影响您。

换句话说，在你的职业编码生涯中，这从来都不是一个*好*主意。

如果您为比您更不关心代码质量的人工作，并且只是希望您不惜一切代价完成代码，那么我可以看到您将处于困境中。完成得更快但更差会让你立即获得奖励。您应该记住，即使未能满足您的雇主/客户对里程碑的期望只咬了你一次，你糟糕的代码可能会继续咬你到未来，不仅因为维护它的困难，还因为其他人的负面印象可能会形成你的轨道。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-16T01:15:24.027

如果它是一个单一的（或有限的）内存泄漏，并且它没有增长，并且说它只会在关闭时导致崩溃（这种情况最常见的情况），那么它取决于。如果它是一个客户端/桌面软件，并且用户每次出去时都会崩溃，我会把它作为一个超高优先级。如果它的服务器，并且唯一运行该服务器的是您，并且其他一切正常，我会说可以进入测试版。但是，如果泄漏增加，或者可能在“随机”时间导致崩溃，则需要尽快修复。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-16T09:53:17.103

为了超越一个内部里程碑，这是有争议的，尽管仍然没有什么可采取的。

释放，永远。它总是回来咬你。如果您的软件处于如此糟糕的空间中，以至于一个糟糕的设计将使其超出界限，那么您将*面临*更大的问题

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-17T21:20:57.733

**永远不要**，除非你不关心那些将在之后维护你工作的可怜的开发人员。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-07T19:09:05.223

最终，这样的决定应该由客户或项目经理做出。个人开发人员不应单独做出此类决定，或将这些信息保密。

告诉他们问题是什么，以及不解决问题的后果是什么。如果他们希望您按时运送损坏的产品，那是他们的决定。

如果你不想为接受劣质产品的人工作，那是你的决定，但认为开发人员有某种职业责任忽视他们的客户和老板的质量/成本/时间优先级是错误的。

如果你发布了糟糕的软件，有人可能真的死了，那么不要这样做，但如果最坏的情况是有人每天必须重新启动几次，那么按照你的指示去做或找到另一个工作。

# javascript - Javascript：模拟点击链接

> ID：648928
> 
> 赞同：5
> 
> 时间：2009-03-16T01:06:54.140
> 
> 标签：javascript, yui

我有一个附有监听器的链接（我正在使用 YUI）：

```
YAHOO.util.Event.on(Element, 'click', function(){ /* some functionality */}); 
```

我希望在不涉及用户点击的另一个场景中发生相同的功能。理想情况下，我可以模拟元素上的“点击”并自动触发该功能。我怎么能这样做？太糟糕了，这不起作用：

```
$('Element').click() 
```

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-16T04:21:27.353

MDC 有一个使用 dispatchEvent模拟点击事件的好[例子。](https://developer.mozilla.org/samples/domref/dispatchEvent.html)

下面是一些模拟单击元素的代码，该元素还检查是否取消了事件：

```
function simulateClick(elm) {
  var evt = document.createEvent("MouseEvents");
  evt.initMouseEvent("click", true, true, window,
    0, 0, 0, 0, 0, false, false, false, false, 0, null);
  var canceled = !elm.dispatchEvent(evt);
  if(canceled) {
    // A handler called preventDefault
    // uh-oh, did some XSS hack your site?
  } else {
    // None of the handlers called preventDefault
    // do stuff
  }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-16T04:15:42.563

您正在寻找[fireEvent](http://msdn.microsoft.com/en-us/library/ms536423(VS.85).aspx) (IE) 和[dispatchEvent](http://developer.mozilla.org/en/DOM/element.dispatchEvent) (其他)。

对于 YUI 3，这一切都很好地包含在[`Y.Event.simulate()`](http://developer.yahoo.com/yui/3/event/#eventsimulation)：

```
YUI().use("node", function(Y) {
    Y.Event.simulate(document.body, "click", { shiftKey: true })
}) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T01:14:44.963

您可以单独声明您的函数。

```
function DoThisOnClick () {
} 
```

然后像现在一样将其分配给 onclick 事件，例如：

```
YAHOO.util.Event.on(Element, 'click', DoThisOnClick) 
```

你可以随时调用它:-)

```
DoThisOnClick () 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-27T22:42:11.230

如果有人遇到这种情况，正在寻找一种与**框架无关**的方式来触发任何 HTML 和鼠标事件，请看这里：[如何使用 JavaScript 模拟鼠标点击？](https://stackoverflow.com/questions/6157929/how-to-simulate-mouse-click-using-javascript/6158050#6158050)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-30T17:33:12.637

1) 第一个解决方案

文章[http://mattsnider.com/simulating-events-using-yui/](http://mattsnider.com/simulating-events-using-yui/)描述了如何使用 YAHOO 模拟点击：

```
var simulateClickEvent = function(elem) {
    var node = YAHOO.util.Dom.get(elem);

    while (node && window !== node) {
        var listeners = YAHOO.util.Event.getListeners(node, 'click');

        if (listeners && listeners.length) {
            listeners.batch(function(o) {
                o.fn.call(o.adjust ? o.scope : this, {target: node}, o.obj);
            });
        }

        node = node.parentNode;
    }
}; 
```

如您所见，该函数循环遍历节点及其父节点，并为每个节点获取侦听器列表并调用它们。

2）第二个解决方案

还有另一种方法可以做到这一点。例如：

```
var elem = YAHOO.util.Dom.get("id-of-the-element");
elem.fireEvent("click", {}); 
```

其中函数用作

3) 第三种解决方案

YUI2 2.9 版本有更好的解决方案：http: [//yui.github.io/yui2/docs/yui_2.9.0_full/docs/YAHOO.util.UserAction.html](http://yui.github.io/yui2/docs/yui_2.9.0_full/docs/YAHOO.util.UserAction.html)

4）第四解决方案

YUI3 还有一个更好更干净的解决方案：http: [//yuilibrary.com/yui/docs/event/simulate.html](http://yuilibrary.com/yui/docs/event/simulate.html)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-16T01:15:32.903

当然 $('Element').click() 不起作用，但如果你包含 jquery，它可以与 yui 一起工作。

由于我未测试，您需要执行以下操作：

```
function myfunc(){
//functionality
}

YAHOO.util.Event.on(Element, 'click', myfunc); 
```

然后在需要发生其他事情时调用 myfunc 。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2009-03-16T01:49:07.533

无法模拟用户对任意元素的点击是故意的，原因很明显。

# iphone - UINavigationController 和 modalViewController 问题

> ID：648932
> 
> 赞同：1
> 
> 时间：2009-03-16T01:11:35.563
> 
> 标签：iphone, objective-c, cocoa-touch

您好我遇到了这个问题：

我在每个选项卡中有一个带有 UINavigationControllers 的 UITabBarController。

但是，我正在尝试实现一个动作，当我单击一个按钮时，应该以模态方式向我展示一个带有 UINavigationController 的新视图（因为它将是多视图）。

我尝试的是用 NavigationBar 实现一个新的 UIViewController。然后在按钮处理程序上我写了这样的东西：

```
SendMessageViewController *v = [[SendMessageViewController alloc] initWithNibName:@"SendMessageView" bundle:nil];
UINavigationController *t = [[UINavigationController alloc] initWithRootViewController:v];
[(UINavigationController *)[tabbar.viewControllers objectAtIndex:0] presentModalViewController:t animated:true]; // hardcoding 0, I know 
```

但是，被推送的模态视图显示有 2 个导航栏，一个是空的，另一个是在“SendMessageView”XIB 上定义的。

有没有办法解决这个问题？我不想创建一个 XIB 只是为了包含一个 UINavigationController.. 我想我可以通过编程来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T04:00:22.507

你想要做的是：

```
[tabBarController presentModalViewController:t animated:Y]; 
```

基本上，获取标签栏 ViewController 的句柄，然后您将拥有您正在寻找的单个导航栏。

# html - 如何在 Perl 中删除每三个 HTML 标记？

> ID：648933
> 
> 赞同：4
> 
> 时间：2009-03-16T01:11:37.217
> 
> 标签：html, regex, perl

这是一个快速编写的脚本，但由于不熟悉正则表达式和 Perl，我遇到了一些困难。

该脚本应该在 HTML 文件中读取。文件中有一个地方（本身），我有一堆 <div>。我想删除其中的每三分之一——它们分成四组。

我下面的脚本不会编译，更不用说运行了。

```
#!/usr/bin/perl
use warnings;
use strict;

&remove();

sub remove {
    my $input = $ARGV[0];
    my $output = $ARGV[1];
    open INPUT, $input or die "couldn't open file $input: $!\n";
    open OUTPUT, ">$output" or die "couldn't open file $output: $!\n";

    my @file = <INPUT>;
    foreach (@file) {
        my $int = 0;
        if ($_ =~ '<div class="cell">') {
        $int++;
        { // this brace was the wrong way
        if ($int % 4 == 3) {
        $_ =~ '/s\<div class="cell">\+.*<\/div>/;/g';
            }
    }
    print OUTPUT @file;
}
```

感谢你的帮助。我知道用正则表达式解析是错误的，但我只希望这个能正常工作。

事后分析：问题几乎解决了。我让那些告诉我正则表达式不好的人感到羞耻——我一开始就知道这一点。但话又说回来，我想要一些快速的东西，并编写了生成它的 XSLT。在这种情况下，我没有再次运行它的源代码，否则我会将它编程到 XSLT 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T02:17:47.480

我同意正则表达式不能真正解析 HTML，但是对于您知道格式的 HTML 的快速小技巧，正则表达式工作得很好。使用正则表达式进行重复替换的技巧是将重复放入正则表达式中。如果您不这样做，您将在将正则表达式匹配器的位置与您正在阅读的输入同步时遇到麻烦。

这是我编写 Perl 的简单粗暴的方式。即使它嵌套在前两个 div 中，它也会删除第三个 div 元素。读取整个文件，然后我使用“g”全局替换修饰符使正则表达式进行计数。如果您以前没有见过“x”修饰符，它所做的只是让您添加空格进行格式化——在正则表达式中空格会被忽略。

```
删除（@ARGV）；

子删除{
  我的（$输入，$输出）=@_；

  open(INPUT, "<", $input) 或 die "无法打开文件 $input: $!\n";
  open(OUTPUT, ">", $output) 或 die "无法打开文件 $output: $!\n";

  我的 $content = join("", <INPUT>);
  关闭（输入）；

  $content =~ s|(.*? <div \s+ class="cell"> .*? <div \s+ class="cell"> .*?)
                <div \s+ class="cell"> .*? </div>
                (.*? <div \s+ class="cell">)|$1$2|sxg;

  打印输出$内容；
  关闭输出；
}

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-16T01:54:19.503

当您的代码无法编译时，请阅读您收到的错误和警告消息。如果它们没有意义，请查阅[perldoc perldiag](http://perldoc.perl.org/perldiag.html)（或在您的代码中添加“使用诊断；”以自动为您执行此操作）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T01:30:28.420

好吧，你是对的，你不应该用正则表达式解析 HTML。既然是这样，它可能不会“正常工作”。

理想情况下，您需要使用 HTML 解析和操作库。不要将 HTML 视为您可以使用文本函数操作的大字符串：它是一种序列化、格式化的数据结构。您应该*只*使用为此目的的库来处理它。各种库已经修复了您可能面临的数百个错误，这使得针对它们编写的简单 HTML 操作例程“正常工作”的可能性增加了无数倍。大师级 Perl 程序员通常不会以这种方式解析 HTML，这并不是因为他们对代码质量和纯度过分执着和不理性——而是因为他们知道自己重新发明轮子不太可能产生像现有的机械。

我推荐 HTML::Tree，因为它的功能与我对 HTML（和 XML）的看法相同。我认为还有一些其他的库可能更受欢迎。

真实情况是，如果您甚至无法*编译*您的程序，您需要花更多时间（半天左右）弄清楚基础知识，然后再寻求帮助。您在使用 s///g 正则表达式替换运算符的语法中存在错误，您需要在继续之前找出它应该如何工作。这并不难，您可以从 Camel 书、perlretut 联机帮助页或其他几个来源中找到您需要的内容。如果您现在不学习如何调试您的程序，那么您在这里获得的任何帮助可能只会带您进入下一个您无法克服的语法错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-16T02:24:33.407

一旦你得到相互匹配的波浪括号，并开始正确使用替换正则表达式，你还需要移动

```
my $int = 0; 
```

在 for 循环之外 - 它当前在读取的每一行上都被重置，所以它只会有 0 或 1 的值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T01:57:37.763

子程序迷路了。首先看一下它的结构：

```
sub remove {                                   # First opening bracket
    my $input = $ARGV[0];
    my $output = $ARGV[1];
    open INPUT, $input or die "couldn't open file $input: $!\n";
    open OUTPUT, ">$output" or die "couldn't open file $output: $!\n";

    my @file = <INPUT>;
    foreach (@file) {                          # Second opening bracket
        my $int = 0;
        if ($_ =~ '<div class="cell">') {      # Third opening bracket
        $int++;
        {                                      # Fourth opening bracket
        if ($int % 4 == 3) {                   # Fifth opening bracket
        $_ =~ '/s\<div class="cell">\+.*<\/div>/;/g';
            }                                  # First closing bracket
    }                                          # Second closing bracket
    print OUTPUT @file;
}                                              # Third closing bracket
                                               # No fourth closing bracket?
                                               # No fifth closing bracket? 
```

我想你想要这个：

```
sub remove {
    my $input = $ARGV[0];
    my $output = $ARGV[1];
    open INPUT, $input or die "couldn't open file $input: $!\n";
    open OUTPUT, ">$output" or die "couldn't open file $output: $!\n";

    my @file = <INPUT>;
    foreach (@file) {
        my $int = 0;
        if ($_ =~ '<div class="cell">') {
          $int++;
        }
        if ($int % 4 == 3) {
          $_ =~ '/s\<div class="cell">\+.*<\/div>/;/g';
        }
    }
    print OUTPUT @file;
} 
```

这将编译，并将我们带到下一个问题：你为什么要单引号正则表达式？（另请参阅 Cebjyre 关于放置 的观点`my $int = 0`。）

（要了解 Ysth 的观点，您还可以随时运行脚本`perl -Mdiagnostics script-name`以获取更长的诊断消息。）

# .net - 如何编写代码分析 (FxCop) 规则以防止方法调用

> ID：648934
> 
> 赞同：6
> 
> 时间：2009-03-16T01:13:25.373
> 
> 标签：.net, fxcop

如何为vs2008编写代码分析工具，防止特定框架调用，如GC.WaitForFullGCComplete()或Application.DoEvents()

我尝试在我的自定义规则中覆盖 VisitMethodCall，但我无法弄清楚 Microsoft.FxCop.Sdk.MethodCall 参数中真正包含的内容。在网上找不到示例。

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-11-16T20:00:24.060

替换`System.Web.HttpUtility.HtmlEncode(System.String)`为您尝试查找和阻止的方法签名。

```
 public override ProblemCollection Check(Member member)
    {
        if (member is Method)
        {
            var callees = new List<Method>(Callees.CalleesFor((Method)member));
            foreach (var callee in callees)
            {
                if (callee.FullName == "System.Web.HttpUtility.HtmlEncode(System.String)")
                {
                    Problems.Add(new Problem(GetResolution()));
                }
            }
        }

        return Problems;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T06:44:49.867

我记得一[本调试书](http://www.amazon.co.uk/Debugging-Microsoft-NET-2-0-Applications/dp/0735622027) ，我认为其中有一章是关于 FXCop 规则并讨论了如何编写一个。对于我的生活，我找不到我的副本。我怀疑你需要反射器

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2010-10-19T12:35:07.650

编写 FxCop 规则的混乱的替代方法是使用工具 NDepend。该工具允许**在 C# LINQ 查询上编写代码规则，** [我们称之为 CQLinq](http://www.ndepend.com/Features.aspx#CQL)。*免责声明：我是该工具的开发人员之一*

默认提出超过[200 条代码规则。](http://www.ndepend.com/DefaultRules/webframe.html)*借助众所周知的*C# LINQ 语法，自定义现有规则或创建自己的规则非常简单。

> 如何为vs2008编写代码分析工具，防止特定框架调用，如GC.WaitForFullGCComplete()或Application.DoEvents()

对于这个特殊的需求，下面的简单 CQLinq 规则就足够了（注意[AllowNoMatch()](http://www.ndepend.com/API/webframe.html?NDepend.API~NDepend.Reserved.CQLinq.ExtensionMethodsCQLinqDependency~AllowNoMatch.html)的使用可以让这个规则在任何情况下都有效）：

```
// <Name>Don't call these methods</Name>
warnif count > 0
from m in Methods 
where m.IsUsing ("System.GC.WaitForFullGCComplete()".AllowNoMatch()) ||
      m.IsUsing ("System.GC.WaitForFullGCComplete(Int32)".AllowNoMatch()) ||
      m.IsUsing ("System.Windows.Forms.Application.DoEvents()".AllowNoMatch())
select m 
```

CQLinq 查询可以在 VisualStudio 中实时编辑，并提供即时结果，并具有结果浏览功能：

![在此处输入图像描述](https://i.stack.imgur.com/atRlF.png)

让我们准确地说，规则可以[在 Visual Studio 中实时](http://www.ndepend.com/Doc_VS_CQL.aspx)验证，并且在构建过程时，在[生成的 HTML+javascript 报告](http://www.ndepend.com/Doc_CI_Report.aspx#CQLRule)中。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2010-12-30T03:36:19.387

虽然它与 NDepend 甚至 FxCop 本身都不匹配，但我刚刚在这里发布了一个非常轻量级的方法，它适用于简单的事情，比如阻止对特定方法的调用：[http ://activesharp.codeplex.com/wikipage?title=使用%20ActiveSharp%20as%20a%20Unit%20Test%20工具](http://activesharp.codeplex.com/wikipage?title=Using%20ActiveSharp%20as%20a%20Unit%20Test%20Tool)

# c# - 打开文件而不（真的）锁定它？

> ID：648939
> 
> 赞同：7
> 
> 时间：2009-03-16T01:15:11.373
> 
> 标签：c#, .net, interop

是否可以以允许随后删除/重命名其父文件夹的方式打开文件？

我知道你可以这样做：

```
File.Open("foo.bar", FileMode.Open, FileAccess.Read, FileShare.Read | FileShare.Delete) 
```

这将允许在文件句柄关闭时删除文件。但是，如果它不允许删除父文件夹而不会出错。

我在框架中找不到任何东西。我是否忽略了某些东西，或者是否有可以互操作的本机 API。

注意：我不在乎在使用已删除文件的流时是否出现异常。事实上，这将是理想的。

**更新：**

所以最有希望的想法是[Hardlink](https://stackoverflow.com/questions/648939/open-file-without-really-locking-it/649372#649372)，但是我无法让它发挥作用。当我尝试删除父目录时，我仍然以拒绝访问结束。这是我的代码：

```
class Program
{
    [DllImport("kernel32.dll", SetLastError = true, CharSet = CharSet.Auto)]
    static extern bool CreateHardLink(string lpFileName, string lpExistingFileName, IntPtr lpSecurityAttributes);

    static void Main(string[] args)
    {
        string hardLinkPath = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName());
        string realPath = @"C:\foo\bar.txt";
        if (CreateHardLink(hardLinkPath, realPath, IntPtr.Zero))
        {
            using (FileStream stream = File.Open(hardLinkPath, FileMode.Open, FileAccess.Read, FileShare.Delete | FileShare.ReadWrite))
            {
                Console.Write("File locked");
                Console.ReadLine();
            }

            File.Delete(hardLinkPath);
        }
        else
            Console.WriteLine("LastError:{0}", Marshal.GetLastWin32Error());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T05:40:03.967

如果您使用的是 NTFS，您可以在临时位置创建另一个指向该文件的硬链接，您将避免文件复制开销，并且第一个链接应该仍然是可删除的（文件本身或包含目录）而不影响第二。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T01:15:35.693

我能想出的最佳解决方案是将文件复制到临时暂存位置。然后，打开临时文件，完成后将其删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-16T01:40:38.693

FileOpen在 Kernel32.dll 中使用[CreateFile 。](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)我不确定您是否能够实现 .NET 框架为您提供的任何东西，因为所有选项都已经存在，除非您将其作为[事务](http://msdn.microsoft.com/en-us/library/aa363859(VS.85).aspx)执行。

# arrays - 如何在 Axapta 3.0 中清空数组？

> ID：648943
> 
> 赞同：3
> 
> 时间：2009-03-16T01:15:48.923
> 
> 标签：arrays, axapta

有人可以详细说明如何在 Axapta 3.0 中清空数组吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-16T15:09:42.147

要释放 Array 对象，只需将 null 分配给它：

```
Array myArray = new Array(Types::Integer);
;
myArray = null; //remove reference to Array so it will be garbage collected 
```

要重置数组类型的所有元素，请为元素 0 赋值：

```
int myArray[10];
;
myArray[0]=0; //reset all elements of the array to their default value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T10:17:22.087

引用自 msdn [http://msdn.microsoft.com/en-us/library/aa653716.aspx](http://msdn.microsoft.com/en-us/library/aa653716.aspx)

> n X++, item zero[0] 用于清空数组！将值分配给数组中的索引 0 会将数组中的所有元素重置为默认值。例如，
> 
> 整数数组[0] = 0；//重置intArray中的所有元素

# asp.net - 服务器错误

> ID：648950
> 
> 赞同：-3
> 
> 时间：2009-03-16T01:21:29.940
> 
> 标签：asp.net, vb.net

在我的项目（ASP.NET，VB.NET）中，有时会显示服务器错误。当显示此错误时，用户无法提交他们的应用程序，因此他们必须重新输入完​​整的详细信息并再次提交。我怎样才能摆脱这些服务器错误。我认为原因可能是内存问题。因为如果用户尝试再次提交（在退出->登录后）然后他们可以提交。每天发生两次或三次错误。如果是这样我该如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T01:27:59.673

我认为您需要提供更多信息才能获得有意义的解决方案。

*   你有服务器日志吗？
*   当错误发生时，您可以通过应用程序进行调试吗？
*   错误发生在一天中的某个时间，还是在某个常规操作之后？
*   您的应用程序是否尝试写入可能无法访问的文件？
*   您是否可能遇到内存问题？

该列表可以继续，最好进行更多调查，如果出现更具体的问题，请使用额外的细节编辑您的问题。

**编辑后：**

从您提供的额外细节来看，我不会将其作为问题跳到记忆中，在注销并重新登录用户时，他们正在刷新他们的会话，因此一切都被重置了。如果您在日志中没有看到任何内容，则需要查看您的异常/错误处理。

您只是还没有提供足够的信息让我们解决根本问题，更不用说提出解决方案了。到目前为止，这就是您从这里的所有答案中看到的。找到事件日志信息，那里应该有一些可以帮助你的东西，或者至少还有一些东西可以在这里发布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T01:32:21.147

短语“服务器错误”中的“服务器”一词是指**您的**ASP.NET 代码。你是服务员！

如果您运行的是 .NET 2.0 或更高版本，您可以查看应用程序事件日志（使用事件查看器小程序）以获取来自“ASP.NET”的警告。它们将包括问题的详细信息。

您需要调试代码以找出导致此问题的原因，但事件日志将为您提供一个起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T02:26:49.207

“服务器错误”只是一条通用消息，表明服务器代码（您的代码）引发了未处理的异常。它向用户显示“服务器错误”而不是特定消息，因此不会向外部用户公开任何实现细节。换句话说，无需调试或查看日志文件或其他内容，您可以从“服务器错误”中得知任何类型的异常都被抛出。

抱歉，您提供的信息无助于确定问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-28T06:22:58.143

Save all your files and close your Visual Studio and now right click on Visual studio and run as administrator. It worked for me.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T01:26:37.290

尝试调试错误？服务器错误可能由多种原因引起。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T03:02:57.747

*   检查潜在的无限循环。
*   检查构造函数中可能失败的代码（尤其是对于 Web 服务）。

我想我遇到过这样的情况导致“服务器错误”。我假设您的意思是大红色的“服务器错误”消息？

# c++ - VisualStudio2008 上的 std::vector 似乎实现不理想 - 复制构造函数调用过多

> ID：648960
> 
> 赞同：7
> 
> 时间：2009-03-16T01:28:21.483
> 
> 标签：c++, stl

我一直在将流行的 XmlRpc 库的 STL 实现与主要避免 STL 的实现进行比较。STL 实现要慢得多——我将 47 秒缩短到 4.5 秒。我已经诊断出一些原因：部分原因是 std::string 被误用（例如，作者应该尽可能使用“const std::string&”——不要像他们一样只使用 std::string是Java字符串），但这也是因为每次向量超出其边界时都会不断调用复制构造函数，这种情况非常频繁。复制构造函数非常慢，因为它们对树（XmlRpc 值）进行了深度复制。

StackOverflow 上的其他人告诉我，std::vector 实现通常每次超出缓冲区大小时都会翻倍。在 VisualStudio 2008 上似乎并非如此：向 std::vector 添加 50 个项目需要 177 次复制构造函数调用。每次加倍应该调用复制构造函数 64 次。如果您非常关心保持低内存使用率，那么每次增加 50% 应该调用复制构造函数 121 次。那么177是从哪里来的呢？

我的问题是：（a）为什么经常调用复制构造函数？(b) 如果您只是*将*对象从一个位置移动到另一个位置，有什么方法可以避免使用复制构造函数？（在这种情况下，实际上在大多数情况下，一个 memcpy() 就足够了——这会产生很大的不同）。

（注意：我知道 vector::reserve()，我只是有点失望，应用程序程序员需要实现加倍技巧，因为这样的东西已经是任何好的 STL 实现的一部分。）

我的测试程序：

```
#include <string>
#include <iostream>
#include <vector>

using namespace std;

int constructorCalls;
int assignmentCalls;
int copyCalls;

class C {
    int n;

public:
    C(int _n) { n = _n; constructorCalls++; }
    C(const C& orig) { copyCalls++; n = orig.n; }
    void operator=(const C &orig) { assignmentCalls++; n = orig.n; }
};

int main(int argc, char* argv[])
{
    std::vector<C> A;

    //A.reserve(50);
    for (int i=0; i < 50; i++)
        A.push_back(i);
    cout << "constructor calls = " << constructorCalls << "\n";
    cout << "assignment calls = " << assignmentCalls << "\n";
    cout << "copy calls = " << copyCalls << "\n";
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-16T03:26:16.347

不要忘记将`push_back`临时`C`对象所需的复制构造函数调用计数到向量中。每次迭代将`C`至少调用一次 的复制构造函数。

如果添加更多打印代码，会更清楚发生了什么：

```
std::vector<C> A;
std::vector<C>::size_type prevCapacity = A.capacity();

for (int i=0; i < 50; i++) {
    A.push_back(i);
    if(prevCapacity != A.capacity()) {
       cout << "capacity " << prevCapacity << " -> " << A.capacity() << "\n";
    }
    prevCapacity = A.capacity();
} 
```

这具有以下输出：

```
capacity 0 -> 1
capacity 1 -> 2
capacity 2 -> 3
capacity 3 -> 4
capacity 4 -> 6
capacity 6 -> 9
capacity 9 -> 13
capacity 13 -> 19
capacity 19 -> 28
capacity 28 -> 42
capacity 42 -> 63 
```

所以是的，容量每次增加 50%，这占了 127 个副本：

```
1 + 2 + 3 + 4 + 6 + 9 + 13 + 19 + 28 + 42 = 127 
```

将 50 个调用中的 50 个额外副本添加到`push_back`177：

```
127 + 50 = 177 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-16T02:03:40.150

> 我的问题是：
> 
> (a) 为什么如此频繁地调用复制构造函数？

因为当向量重新调整大小时，您需要将旧缓冲区中的所有元素复制到新缓冲区中。这是因为向量保证对象存储在连续的内存位置。

> (b) 如果您只是将对象从一个位置移动到另一个位置，有什么方法可以避免使用复制构造函数？

不，没有办法避免使用复制构造函数。
这是因为该对象有几个需要正确初始化的成员。
如果您使用 memcpy，您如何知道该对象已为该对象正确初始化！

例如。如果对象包含智能指针。你不能只 memcpy 一个智能指针。它需要做额外的工作来跟踪所有权。否则，当原始对象超出范围时，内存将被删除，并且新对象有一个悬空指针。同样的原则适用于所有具有构造函数（复制构造函数）的对象，构造函数实际上做了所需的工作。

停止复制内容的方法是预留空间。
这使得 vector 为其将存储的所有对象分配足够的空间。因此它不需要不断地重新分配主缓冲区。它只是将对象复制到向量中。

> 每次加倍应该调用复制构造函数 64 次。如果您非常关心保持低内存使用率，那么每次增加 50% 应该调用复制构造函数 121 次。那么177是从哪里来的呢？

向量分配大小 = 1：
添加元素 1：（不重新分配）但将元素 1 复制到向量中。
添加元素 2：重新分配缓冲区（大小 2）：复制元素 1。将元素 2 复制到向量中。
添加元素 3：重新分配缓冲区（大小 4）：复制元素 1-2。将元素 3 复制到向量中。
添加元素 4：将元素 4 复制到向量
中 添加元素 5：重新分配缓冲区（大小 8）：复制元素 1-4。将元素 5 复制到向量中。
添加元素 6：将元素 6 复制到向量
中 添加元素 7：将元素 7 复制到向量
中 添加元素 8：将元素 8 复制到向量
中 添加元素 9：重新分配缓冲区（大小 16）：复制元素 1-8。将元素 9 复制到向量中。
添加元素 10：将元素 10 复制到向量
等中。

前 10 个元素采用 25 个复制结构。
如果您先使用储备，则只需要 10 次复制结构。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-16T02:28:10.310

STL 确实倾向于导致这种事情。该规范不允许 memcpy'ing，因为这并非在所有情况下都有效。有一个描述[EASTL](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2271.html)的文档，EA 进行了一系列更改以使其更适合他们的目的，它确实有一种方法可以声明一个类型对 memcpy 是安全的。不幸的是，它不是开源的 AFAIK，所以我们无法使用它。

IIRC Dinkumware STL（VS 中的那个）每次将向量增长 50%。

但是，对向量执行一系列 push_back 是一种常见的低效率。您可以使用 reserve 来缓解它（如果您显着高估，可能会浪费内存）或使用不同的容器 - deque 对于这样的一系列插入表现更好，但在随机访问中会慢一点，这可能/可能对你来说不是一个很好的权衡。

或者您可以查看存储指针而不是值，如果您存储大型元素，这将使调整大小更便宜。如果您要存储大型对象，这将始终获胜，因为您不必复制它们 - 您将始终为每个项目至少在插入时保存一个副本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T03:13:43.307

如果我没记错的话，C++0x 可能有移动语义（除了复制语义），也就是说，如果你真的想的话，你可以实现一个更有效的复制构造函数。

除非复制构造函数很复杂，否则它通常非常有效 - 毕竟，您应该做的不仅仅是复制对象，而且现在复制内存非常快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T03:19:41.590

看起来对 C++0x 的补充在这里会有所帮助；请参阅[Rvalue](http://en.wikipedia.org/wiki/C%2B%2B0x#Rvalue_reference_and_move_semantics)和[STL 升级](http://en.wikipedia.org/wiki/C%2B%2B0x#Upgrades_to_standard_library_components)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T03:44:22.593

为了规避这个问题，为什么不使用指针向量而不是对象向量呢？然后`delete`在破坏向量时的每个元素。

换句话说，`std::vector<C*>`而不是`std::vector<C>`. Memcpy'ing 指针*非常*快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-16T08:10:39.457

请注意，要小心添加指向向量的指针作为最小化复制成本的一种方式，因为

1.  *向量中指针的不良数据局部性使得具有连续对象的非指针版本在实际使用*向量时围绕指针版本运行。
2.  堆分配比堆栈分配慢。

你更经常*使用*向量还是向它*添加*东西？

# web-services - 为什么 lift web 框架是可扩展的？

> ID：648964
> 
> 赞同：53
> 
> 时间：2009-03-16T01:32:16.327
> 
> 标签：web-services, scala, frameworks, lift

我想知道lift web框架具有高性能和可扩展性的技术原因？我知道它使用 scala，它有一个演员库，但根据安装说明，它的默认配置是使用码头。那么它是否使用演员库进行缩放？

现在是开箱即用的可扩展性。只需添加额外的服务器和节点，它就会自动扩展，是这样工作的吗？它可以处理 500000+ 与支持服务器的并发连接。

我正在尝试为企业级创建一个 Web 服务框架，它可以击败现有的东西，并且易于扩展、可配置和可维护。我对扩展的定义只是添加更多服务器，您应该能够容纳额外的负载。

谢谢

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-04-12T18:02:19.343

Lift 的可扩展性方法是在一台机器内实现的。跨机器扩展是一个更大、更棘手的话题。简短的回答是：Scala 和 Lift 不会做任何事情来帮助或阻碍水平扩展。

就单个机器中的参与者而言，Lift 实现了更好的可扩展性，因为单个实例可以处理比大多数其他服务器更多的并发请求。为了解释，我首先必须指出经典的每请求线程处理模型中的缺陷。请耐心等待，这需要一些解释。

典型的框架使用线程来服务页面请求。当客户端连接时，框架会从池中分配一个线程。该线程然后做三件事：它从套接字读取请求；它进行一些计算（可能涉及到数据库的 I/O）；它在套接字上发送一个响应。几乎在每一步，线程最终都会阻塞一段时间。在读取请求时，它可以在等待网络的同时阻塞。在进行计算时，它可能会阻塞磁盘或网络 I/O。它也可以在等待数据库时阻塞。最后，在发送响应时，如果客户端接收数据缓慢并且 TCP 窗口被填满，它会阻塞。总体而言，线程可能会花费 30 - 90% 的时间被阻塞。然而，它把 100% 的时间都花在了这个请求上。

JVM 在真正变慢之前只能支持这么多线程。线程调度、共享内存实体（如连接池和监视器）的争用以及本机操作系统限制都对 JVM 可以创建的线程数量施加了限制。

那么，如果JVM的最大线程数是有限的，而线程数决定了一个服务器可以处理多少并发请求，那么并发请求数将由线程数决定。

（还有其他问题可以施加较低的限制——例如，GC 抖动。线程是一个基本的限制因素，但不是唯一的！）

Lift 将线程与请求分离。在 Lift 中，请求不会*占用*线程。相反，一个线程执行一个操作（例如读取请求），然后向参与者发送一条消息。演员是故事的重要组成部分，因为他们是通过“轻量级”线程安排的。线程池用于处理参与者中的消息。避免在actor内部阻塞操作很重要，因此这些线程会迅速返回到池中。（请注意，该池对应用程序不可见，它是 Scala 对参与者的支持的一部分。）例如，当前在数据库或磁盘 I/O 上阻塞的请求不会保持请求处理线程被占用。请求处理线程几乎立即可用，以接收更多连接。

这种将请求与线程分离的方法允许 Lift 服务器比一个线程请求服务器有更多的并发请求。（我还想指出，Grizzly 库支持类似的没有参与者的方法。）更多并发请求意味着单个 Lift 服务器可以支持比常规 Java EE 服务器更多的用户。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-06-06T13:31:20.037

在 mtnyguard

“Scala 和 Lift 不会帮助或阻碍水平扩展”

不太对。Lift 是高度有状态的框架。例如，如果用户请求一个表单，那么他只能将请求发布到表单来自的同一台机器上，因为表单处理操作保存在服务器状态中。

这实际上在某种程度上阻碍了可扩展性，因为这种行为与无共享架构不一致。

毫无疑问，lift 是高性能的，但性能和可扩展性是两个不同的东西。因此，如果您想通过提升水平扩展，您必须在负载均衡器上定义粘性会话，这将在会话期间将用户重定向到同一台机器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-16T18:15:16.070

Jetty 可能是入口点，但参与者最终会为请求提供服务，我建议看一下 twitter-esque 示例，“skitter”，看看您将如何创建一个非常可扩展的服务。IIRC，这是让推特人们注意到的事情之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-16T04:40:47.873

我真的很喜欢@dre 的回复，因为他正确地指出lift 的状态是水平可扩展性的一个潜在问题。

问题 - 我不再描述整个事情，而是查看这篇文章的讨论（不是内容）。[http://javasmith.blogspot.com/2010/02/automagically-cluster-web-sessions-in.html](http://javasmith.blogspot.com/2010/02/automagically-cluster-web-sessions-in.html)

解决方案是@dre 在前面的负载均衡器上说粘性会话配置并添加更多实例。但是由于 Lift 中的请求处理是在线程 + Actor 组合中完成的，因此您可以期望一个实例处理比普通框架更多的请求。这将比在其他框架中具有粘性会话提供优势。即单个实例处理更多的能力可以帮助您扩展

*   你有 Akka 电梯集成，这将是另一个优势。

# coding-style - 配置管理 - 代码注释中的历史

> ID：648972
> 
> 赞同：6
> 
> 时间：2009-03-16T01:39:15.763
> 
> 标签：coding-style, configuration-management, change-management

在问我的问题之前，让我先提供一些背景信息：

我最近加入了一个新的软件开发小组，该小组使用 Rational 工具进行配置管理，包括源代码控制和变更管理系统。除了这些工具之外，团队还有一个标准做法，即在代码中将任何代码更改作为注释记录，例如：

```
///<history>
   [mt] 3/15/2009  Made abc changes to fix xyz
///</history> 
```

他们对注释标准的官方目的是“注释提供从需求到代码修改的可追溯性”。

我准备提出一个论点，即这种做法是不必要和多余的；团队应该立即摆脱这个标准。

也就是说，变更管理系统是建立从需求到代码修改的可追溯性的地方，源代码控制可以通过在版本之间执行差异来提供详细的变更历史记录。签入源代码时，会注明相应的变更管理票证。解决 CM 票证后，我们会注意修改了哪些源代码文件。我相信这为所需的可追溯性提供了足够的交叉参考。

我想知道是否有人不同意我的论点。我是否错过了更改管理和源代码控制系统无法提供的注释源代码历史记录的一些好处？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-16T01:59:25.310

对我自己来说，我一直发现这样的评论比它们的价值更麻烦：它们可能导致合并冲突，当你试图隔离两个版本之间的差异时可能会显示为“误报”，并且可能会引用代码更改此后的更改已过时。

通常（不总是，但经常）可以更改版本控制系统而不会丢失元数据。如果您要将代码移动到**不**支持此功能的系统，那么在转换之前编写脚本将更改历史记录转换为注释并不难。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T01:44:10.667

注释允许您在代码中相关的地方找到所有更改及其原因，而无需深入研究差异和版本控制系统的复杂性。此外，如果您决定更改版本控制系统，评论将保留。

我参与了一个类似做法的大型项目，该项目曾两次更改源控制系统。没有一天我不高兴听到这些评论。

是多余的吗？是的。这是不必要的吗？不。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T08:08:36.653

我一直认为代码当然应该受版本控制，并且**当前源代码**（您今天可以打开和阅读的源代码）**应该只在现在时有效**。

过去的报告是否最多包含 3 个轴并不重要，而上个月您将其更新为最多支持 6 个轴。扩展一些功能或者修复一些bug都没有关系，只要当前版本容易理解即可。当您修复错误时，只需保留已修复的代码。

不过有一个例外。**如果（且仅当）固定代码对您来说看起来不如前一个不正确的代码那么直观；如果你觉得有人明天可能会来，并且仅仅通过阅读代码就想把它改回“看起来更正确”**的内容，那么最好添加一条评论：*“这样做是为了避免......呸呸呸。”* 另外，如果背后的问题是团队文化中臭名昭著的战争故事，或者由于某种原因错误报告数据库包含有关这部分代码的非常有趣的信息，我不会觉得添加*“（参见错误 ID 10005)”*到解释性评论。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T01:44:34.627

我突然想到的是供应商锁定。如果您曾经离开过 Rational，那么您需要确保在迁移期间维护了完整的变更历史——而不仅仅是工件的版本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T01:54:47.193

当您在代码中时，您需要知道为什么它的结构如此，因此在代码注释中。位于代码之外的工具，尽管它们可能很好，但需要在你的大脑中进行太多的上下文转换才能有用。除此之外，试图从文档和差异中逆向工程代码意图非常困难，我宁愿每天阅读一行评论。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T02:28:59.683

在我处理的代码中有一个阶段，早在 1994-96 年的时间框架内，就有在文件顶部插入更改历史注释的趋势。这些评论现在毫无意义和无用，我在编辑包含此类评论的文件时执行的许多标准清理之一就是删除它们。

相比之下，在进行更改的位置也有一些带有错误编号的注释，通常解释了为什么荒谬的代码是这样的。这些可能非常有帮助。错误编号使您可以在其他地方查找信息，并指出罪魁祸首（或受害者 - 它会有所不同）。

另一方面，像这样的物品 - 正品；上周打扫干净——让我咬紧牙关。

```
 if (ctab->tarray && ctab->tarray[i])
#ifndef NT
      prt_theargs(*(ctab->tarray[i]));
#else
      /* Correct the parameter type mismatch in the line above */
      prt_theargs(ctab->tarray[i]);
#endif /* NT */ 
```

NT队得到了正确的判罚；为什么他们认为这是特定于平台的修复程序超出了我的范围。当然，如果代码之前使用原型而不是无参数声明，那么 Unix 团队也必须修复代码。该评论是一种帮助-向我保证该错误是真实的-但令人恼火。

# c# - 从多个线程渲染到单个 Bitmap 对象

> ID：648975
> 
> 赞同：6
> 
> 时间：2009-03-16T01:41:26.943
> 
> 标签：c#, multithreading, graphics, bitmap, rendering

我正在做的是将多个位图渲染到单个位图。可能有数百个图像，并且被渲染的位图可能超过 1000x1000 像素。

我希望通过使用多个线程来加速这个过程，但由于 Bitmap 对象不是线程安全的，它不能直接并发渲染。我的想法是将大位图拆分为每个 cpu 的部分，分别渲染它们，然后在最后将它们重新组合在一起。我还没有这样做，以防你们有更好的建议。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-17T21:34:48.667

您可以使用 LockBits 并处理图像的各个部分。

有关如何完成此操作的示例，您可以查看 Paint.Net 源代码，尤其是[BackgroundEffectsRenderer](http://code.google.com/p/paint-mono/source/browse/trunk/src/Effects/BackgroundEffectRenderer.cs)（是的，它是单声道分支的链接，但 Paint.Net 主代码似乎仅在 zip 文件中可用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T01:55:31.340

Lee，如果您要使用 Image GDI+ 对象，您可能最终只需要完成所有工作两次。您在多个线程中生成的部分将需要在分而治之的方法结束时重新组合，这不会首先破坏划分的目的吗？

如果您在每个位图部分中执行相当复杂的操作，那么这个问题可能会得到解决，这将比简单地将图像子部分重新绘制到大位图上而无需费心费力地花费更多的处理时间。

希望有帮助。您计划进行什么样的图像渲染？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-07T02:55:26.860

一种方法是将所有小位图渲染到一个*ersatz*位图上，该位图只是一个二维`int`数组（`Bitmap`无论如何，这实际上是一种）。一旦所有的小位图组合到大数组中，您就可以从大数组一次性复制到`Bitmap`相同维度的实数中。

我一直使用这种方法（不包括多线程方面）来处理 Windows Mobile 设备上的复杂图形，因为可用于创建“真实”GDI+ 位图的内存非常有限。

您也可以`Bitmap`按照最初的意图使用 a 。 `Bitmap`不保证是线程安全的，但我不确定这是否会成为问题，只要您可以确保没有两个线程会覆盖位图的同一部分。至少我会试一试。

**更新：** 我刚刚重新阅读了您的问题，我意识到通过使它们成为多线程，您可能不会看到这些操作的整体速度有太多（如果有的话）改进。这是经典的九个女人不能在一个月内生孩子的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T01:47:29.377

您可以让每个线程写入一个字节数组，然后当它们全部完成后，使用单个线程从字节数组创建一个位图对象。如果所有其他处理都事先完成，那应该很快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T02:06:43.387

我做了类似的事情，在我的情况下，我让每个线程锁定 x（取决于图像的大小和线程数）图像中的许多行位，并对这些位进行写入，这样就没有线程了重叠了他们的写作。

# java - 随机数发生器

> ID：648976
> 
> 赞同：3
> 
> 时间：2009-03-16T01:41:35.163
> 
> 标签：java, random

我需要用Java编写一个程序来使用公式生成[0,1]范围内的随机数：

> X [i] = (aX [i-1] + b) mod m

假设 a、b 和 m 和 X 的任何固定 int 值[0] = 0.5（即 i=0）

我该怎么做呢？

我试过这样做，但这显然是错误的：

```
int a = 25173, b = 13849, m = 32768;
double X_[i];
for (int i = 1; i<100; i++)
   X_[i] = (a*(X_[i]-1) + b) % m;
double X_[0] = 0.5;
double double = new double();
System.out.println [new double]; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-16T01:46:57.570

这里有一些提示：

```
int a, d, m, x; 
```

乘法是`*`和**mod**是`%`。

### 更新

好吧，我再给你一点提示。你只需要一个 X，你不需要所有这些数组；因为你只使用整数，所以不需要任何浮点数或浮点数。

重要的代码行将是

```
x = (a * x + b) % m ; 
```

你不需要另一个`x`，因为`x`右边`=`是 OLD`x`或*x [i-1]*；左边的那个将是你的“新” `x`，或*x [i]*。

现在，从那里开始，您需要编写 Java 包装器，让您将其设为*方法*，这意味着编写一个*类*。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T01:45:25.560

听起来像家庭作业......所以我不会给你一个代码解决方案。

无论如何，您需要一个[线性同余生成器](http://en.wikipedia.org/wiki/Linear_congruential_generator)。

**提示：**你需要把这个数学公式写成一个函数。

**脚步：**

1.  做一堂课。
2.  将所需的状态作为成员添加到类中。
3.  在类中创建一个函数。让它根据需要接受输入。
4.  用 Java 编写同余生成器的公式（查找 Java 中的数学运算）。
5.  返回结果。

我的 Java 生锈了，所以我不能说我对此很确定，但这些可能是错误：

```
int a = 25173, b = 13849, m = 32768;
double X_[i];//You need to define a constant array or use perhaps a list, you can't use i without defining it
for (int i = 1; i<100; i++)
   X_[i] = (a*(X_[i]-1) + b) % m;
double X_[0] = 0.5;
double double = new double(); //You can't name a variable double, also types like double, don't need to be newed (I think)
System.out.println [new double]; //println uses () not [], in Java I think all functions need to use (), its not implied 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-17T12:32:11.270

线性同余生成器基本上是一个表达式，它修改给定值以产生系列中的下一个值。它采用以下形式：

x [i+1] = (a ^. x [i] + b) mod m

正如您已经指定的那样（略有不同：我被教导总是把 x [i+1]放在左边，25 年后我仍然害怕我的数学老师 :-)，其中`a`,`b`和`m`的值经过精心挑选，以给出一个体面的范围的价值观。请注意，使用`mod`运算符，您将始终得到一个介于`0`和`m-1`包含之间的值。

另请注意，这些值往往是整数而不是浮点数，因此如果根据您的要求，您需要一个 0-0.999 范围内的值...，您需要将整数值除以`m`得到它。

解释了它是如何工作的，这里有一个简单的 Java 程序，它使用 的值来实现它`a`，`b`并且`m`来自你的问题：

```
public class myRnd {
    // Linear congruential values for x(i+1) = (a * x(i) + b) % m.
    final static int a = 25173;
    final static int b = 13849;
    final static int m = 32768;

    // Current value for returning.
    int x;

    public myRnd() {
        // Constructor simply sets value to half of m, equivalent to 0.5.
        x = m / 2;
    }

    double next() {
        // Calculate next value in sequence.
        x = (a * x + b) % m;

        // Return its 0-to-1 value.
        return (double)x / m;
    }

    public static void main(String[] args) {
        // Create a new myRnd instance.
        myRnd r = new myRnd();

        // Output 20 random numbers from it.
        for (int i = 0; i < 20; i++) {
            System.out.println (r.next());
        }
    }   
} 
```

这是输出，无论如何对我来说都是随机的:-)。

```
0.922637939453125
0.98748779296875
0.452850341796875
0.0242919921875
0.924957275390625
0.37213134765625
0.085052490234375
0.448974609375
0.460479736328125
0.07904052734375
0.109832763671875
0.2427978515625
0.372955322265625
0.82696533203125
0.620941162109375
0.37451171875
0.006134033203125
0.83465576171875
0.212127685546875
0.3128662109375 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T01:50:02.570

编辑：邦格斯：

1.  [ ] 是特殊符号，如果您打算将变量命名为“X_[ i ]”，那将不起作用。如果你打算制作一个数组，那你就让它太复杂了。

2.  您需要弄清楚原始方程是 Xi - 1 还是 X(i-1)，因为这会对您的编程产生巨大影响。Xi - 1 仅比 Xi 小一。X(i-1) 是前一个随机数。

3.  尝试在线做一些初学者的java教程。[这是](http://www.cafeaulait.org/javatutorial.html#xtocid45973 "Java 教程")一个很好的起点。在继续解决您的问题之前，请真正尝试理解教程。

4.  这样想你的问题。[假设方程是 X(i-1)] 要生成第三个随机数 X3，你需要生成 X2，它需要 X1，它需要 X0。但是你有X0。所以对于任何 Xi，从 X0 开始，生成 X1，然后生成 X2，等等。直到 Xi。

您可能**不需要**像我最初建议的那样研究[递归。](http://www.java-samples.com/showtutorial.php?tutorialid=151 "java递归例子")

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-16T13:24:36.877

```
public class generate_random_numbers {

    public static void main(String[] args) {
        int a = 25173, b = 13849, m = 32768;
        Double[] X_ = new Double[100];
        X_[0] = 0.5;
        for (int i = 1; i < 100; i++) {
            X_[i] = (a * X_[i - 1] + b) % m;
            X_[i] = X_[i] / m;
            System.out.println("X_[" + i + "] = " + X_[i]);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T01:52:23.827

我将首先创建一个包含 a、b、m、最新 x（初始化为 0.5）和 getNextNumber() 之类的方法的类。

# c# - 正则表达式和“组”

> ID：648991
> 
> 赞同：0
> 
> 时间：2009-03-16T01:50:39.807
> 
> 标签：c#

我有一些文本，例如“项目编号 - 项目描述”，例如“13-40 - 电脑键盘”，我想将其拆分为项目编号和项目描述。

这是否可以使用 1 个正则表达式，或者我需要 2 个（一个用于项目，一个用于描述）？

我无法弄清楚如何“分组”它 - 就像项目编号可以是这样，描述可以是这样，而不是认为一切都是项目编号。例如：

```
(\w(\w|-|/)*\w)-.* 
```

将所有内容匹配为 1 匹配。

这是我正在使用的代码：

```
Regex rx = new Regex(RegExString, RegexOptions.Compiled | RegexOptions.IgnoreCase);
MatchCollection matches = rx.Matches("13-40 - Computer Keyboard");
Assert.AreEqual("13-40", matches[0].Value);
Assert.AreEqual("Computer Keyboard", matches[1].Value); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T02:16:58.947

从您发布的代码中，您使用的正则表达式错误。您应该有一个正则表达式模式来匹配整个产品，并使用匹配中的捕获来提取数字和描述。

```
string RegExString = @"(?<number>[\d-]+)\s-\s(?<description>.*)";
Regex rx = new Regex(RegExString, RegexOptions.Compiled | RegexOptions.IgnoreCase);
Match match = rx.Match("13-40 - Computer Keyboard");
Debug.Assert("13-40" == match.Groups["number"].Value);
Debug.Assert("Computer Keyboard" == match.Groups["description"].Value); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T01:58:55.810

这是一个在 Ruby 中工作的正则表达式 - 不确定 c# 正则表达式是否有任何差异：

```
/^([\d\-]+) \- (.+)$/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T02:00:34.137

```
([0-9-]+)\s-\s(.*) 
```

第 1 组包含项目编号，第 2 组包含描述。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T02:23:08.293

CaffeineFueled 的答案对于 C# 是正确的。

```
Match match = Regex.Match("13-40 - Computer Keyboard", @"^([\d\-]+) \- (.+)$");
Console.WriteLine(match.Groups[1]);
Console.WriteLine(match.Groups[2]); 
```

结果：

13-40
电脑键盘

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T02:00:57.800

如果您的文本总是用破折号分隔，并且您*不必*处理数据中的破折号，则不必使用正则表达式。

```
string[] itemProperties = item.Split(new string[] { "-" });
itemProperties = itemProperties.Select(p => p.Trim());
Item item = new Item()
{
  Number = itemProperties[0],
  Name = itemProperties[1],
  Description = itemProperties[2]
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T02:24:13.550

您似乎不想匹配组，但有多个匹配项。

也许这会做你想要的？

```
(:^.+(?=( - ))|(?<=( - )).+$) 
```

分开：

```
(:           Used to provide two possible matches
^.+          Match item ID text
(?=( - ))    Text must be before " - "
|            OR
(?<=( - ))   Test must be after " - "
.+$          Match description text
) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-16T02:47:34.443

这不像 CaffineFueled 的答案那么优雅，但对于正则表达式初学者来说可能更容易阅读。

```
String RegExString = "(\d*-\d*)\s*-\s*(.*)";
Regex rx = new Regex(RegExString, RegexOptions.Compiled | RegexOptions.IgnoreCase);
MatchCollection matches = rx.Matches("13-40 - Computer Keyboard");
Assert.AreEqual("13-40", matches[0].Value);
Assert.AreEqual("Computer Keyboard", matches[1].Value); 
```

甚至更具可读性：

```
String RegExString = "(\d*-\d*) - (.*)"; 
```

# asp.net - ASP.NET 中的会话超时

> ID：648992
> 
> 赞同：173
> 
> 时间：2009-03-16T01:50:48.217
> 
> 标签：asp.net, session, timeout

我在 IIS 6.0 中运行 ASP.NET 2.0 应用程序。我希望会话超时为 60 分钟，而不是默认的 20 分钟。我做了以下

1.  设置`<sessionState timeout="60"></sessionState>` 在`web.config`.
2.  在 IIS 管理器/网站属性/ASP.NET 配置设置中将会话超时设置为 60 分钟。
3.  在应用程序池属性/性能中将空闲超时设置为 60 分钟。

我仍然在 20 分钟时收到会话超时。还有什么我需要做的吗？

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2009-03-16T12:04:39.427

您是否使用表单身份验证？

表单身份验证使用它自己的超时值（默认为 30 分钟）。表单身份验证超时会将用户发送到会话仍处于活动状态的登录页面。这可能看起来像您的应用程序在会话超时时提供的行为，从而很容易将一个与另一个混淆。

```
<system.web>
    <authentication mode="Forms">
          <forms timeout="50"/>
    </authentication>

    <sessionState timeout="60"  />
</system.web> 
```

将表单超时设置为小于会话超时可以为用户提供一个窗口，在该窗口中重新登录而不会丢失任何会话数据。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-03-16T02:11:13.533

我不知道 web.config 或 IIS。但我相信从 C# 代码中你可以做到

```
Session.Timeout = 60; // 60 is number of minutes 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2011-12-14T07:04:13.887

在您的 web.config 文件中使用以下代码块。这里默认会话超时为 80 分钟。

```
<system.web>
 <sessionState mode="InProc" cookieless="false" timeout="80" />
</system.web> 
```

使用以下链接获取带有弹出警报消息的会话超时。

[会话超时示例](http://community.devexpress.com/blogs/aspnet/archive/2011/06/15/asp-net-how-to-show-a-popup-warning-before-session-timeout.aspx)

仅供参考：以上示例是使用 devexpress 弹出控件完成的，因此您需要使用普通弹出控件自定义/替换 devexpress 弹出控件。如果您使用 devexpress 无需自定义

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-10-23T11:01:17.763

在我的情况下，它是应用程序池。设置为空闲 xx 分钟后重新启动。当我将其设置为不重新启动时，它似乎使用了 Web Config 中的值。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-16T03:20:23.337

machine.config 中是否有任何可能生效的内容？在 web.config 中设置会话超时应该覆盖 IIS 或 machine.config 中的任何设置，但是，如果您在应用程序的子文件夹中的某处有一个 web.config 文件，该设置将覆盖应用程序根目录中的设置。

另外，如果我没记错的话，IIS 中的超时仅影响 .asp 页面，而不影响 .aspx。您确定 web.config 中的会话代码正确吗？它应该看起来像：

```
<sessionState
    mode="InProc"
    stateConnectionString="tcpip=127.0.0.1:42424"
    stateNetworkTimeout="60"
    sqlConnectionString="data source=127.0.0.1;Integrated Security=SSPI"
    cookieless="false"
    timeout="60"
/> 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-16T02:05:31.970

这通常就是你需要做的一切......

您确定在 20 分钟后，会话丢失的原因是因为空闲...

会话可能被清除的原因有很多。您可以为 IIS 启用事件日志记录，然后可以使用事件查看器查看会话被清除的原因......您可能会发现它可能是出于其他原因？

您还可以阅读[事件消息的文档](https://technet.microsoft.com/en-us/library/cc784734.aspx)和相关[的事件表](http://technet.microsoft.com/en-us/library/cc786887.aspx)。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-05-29T20:55:47.020

[https://usefulaspandcsharp.wordpress.com/tag/session-timeout/](https://usefulaspandcsharp.wordpress.com/tag/session-timeout/)

```
<authentication mode="Forms">
  <forms loginUrl="Login.aspx" name=".ASPXFORMSAUTH" timeout="60" slidingExpiration="true" />
</authentication>

<sessionState mode="InProc" timeout="60" /> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-03-19T19:52:48.283

If you are using Authentication, I recommend adding the following in web.config file.

In my case, users are redirected to the login page upon timing out:

```
<authentication mode="Forms">
    <forms defaultUrl="Login.aspx" timeout="120"/>
</authentication> 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-05-26T08:38:25.950

由于 ASP.Net 核心 1.0（vNext 或任何用于它的名称）会话的实现方式不同。我更改了会话超时值`Startup.cs`，`void ConfigureServices`使用：

```
services.AddSession(options => options.IdleTimeout = TimeSpan.FromSeconds(42)); 
```

或者，如果您想使用该`appsettings.json`文件，您可以执行以下操作：

```
// Appsettings.json
"SessionOptions": {
    "IdleTimeout": "00:30:00"
}

// Startup.cs
services.AddSession(options => options.IdleTimeout = TimeSpan.Parse(Config.GetSection("SessionOptions")["IdleTimeout"])); 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-02-22T23:11:37.483

您可以在 IIS 中找到此处的设置：

[![设置](https://i.stack.imgur.com/vxEgU.png)](https://i.stack.imgur.com/vxEgU.png)

它可以在“ASP”下的服务器级别、网站级别或应用级别找到。

我认为您可以在此处将其设置为 web.config 级别。请自己确认。

```
<configuration>
   <system.web>

      <!-- Session Timeout in Minutes (Also in Global.asax) -->
       <sessionState timeout="1440"/>

   </system.web>
</configuration> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-01-26T19:28:08.240

IIS 会话超时值仅适用于经典 .asp 应用程序，这由 IIS 配置控制。 **在您的情况下对于 ASP.NET 应用程序，只有 web.config 指定的超时值适用。**

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-12-10T13:24:28.217

默认会话超时在 IIS 中定义为 20 分钟

对托管在 IIS 8.5 Web 上的每个站点执行以下过程

[![IIS 超时配置](https://i.stack.imgur.com/3twp9.png)](https://i.stack.imgur.com/3twp9.png)

> 打开 IIS 8.5 管理器。
> 
> 单击站点名称。
> 
> 在“管理”部分下选择“配置编辑器”。
> 
> 从配置编辑器顶部的“Section:”下拉列表中，找到“system.web/sessionState”。
> 
> 将“超时”设置为“00:20:00 或更少”，根据应用程序使用可能的最小值。可接受的值是高价值应用程序 5 分钟，中等价值应用程序 10 分钟，低价值应用程序 20 分钟价值应用。
> 
> 在“操作”窗格中，单击“应用”。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-02-29T13:09:24.297

如果您希望网站的会话超时而不是删除

```
<authentication mode="Forms">
      <forms timeout="50"/>
</authentication> 
```

来自 web.config 文件的标记。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2016-09-18T13:26:41.523

Timeout 属性指定分配给应用程序的 Session 对象的超时期限，以分钟为单位。如果用户在超时期限内没有刷新或请求页面，则会话结束。

> IIS 6.0：允许的最小值为 1 分钟，最大值为 1440 分钟。

```
Session.Timeout = 600; 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2010-12-08T05:53:06.370

更改 IIS 中的会话超时值后，请重新启动 IIS。要实现这一点，请转到命令提示符。键入 IISRESET 并按 Enter。

# javascript - 如何监控 DOM 的变化？

> ID：648996
> 
> 赞同：17
> 
> 时间：2009-03-16T01:51:55.607
> 
> 标签：javascript, jquery, dom

有没有办法——使用 jQuery 或其他方式——监控 DOM 的插入、删除、样式更新等？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-16T02:04:55.747

请参阅此处的“MutationEvent”元素： [https](https://developer.mozilla.org/en/DOM/DOM_event_reference) ://developer.mozilla.org/en/DOM/DOM_event_reference但这些已被弃用。

jQuery 现在提供了一种将事件附加到与选择器相对应的现有和未来元素的方法：http: [//docs.jquery.com/Events/live#typefn](http://docs.jquery.com/Events/live#typefn)

由于缺少适当的 DOM 节点修改信息，这可能是一个技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T09:29:33.597

请参阅[突变摘要](http://code.google.com/p/mutation-summary/)库。它建立在名为 DOM Mutation Observers 的新浏览器 API 之上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T18:57:09.020

**这仅用于调试目的：**

Firebug 当前允许在 html 节点上设置断点。

你必须打开 html 检查器，右键单击一个节点，你有以下选项：

*   属性更改中断
*   子添加/删除中断
*   删除时中断

到达断点后，您还可以浏览调用堆栈。

谷歌浏览器也有类似的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-06T17:07:24.073

我最近写了一个插件，正是这样做的 - [jquery.initialize](https://github.com/AdamPietrasiak/jquery.initialize)

你使用它的方式和`.each`函数一样

```
$(".some-element").initialize( function(){
    $(this).css("color", "blue"); 
}); 
```

不同之处`.each`在于 - 在这种情况下，它需要您的选择器，`.some-element`并在将来等待带有此选择器的新元素，如果要添加这样的元素，它也会被初始化。

在我们的例子中，初始化函数只需将元素颜色更改为蓝色。因此，如果我们要添加新元素（无论是使用 ajax 还是 F12 检查器或其他任何东西），例如：

```
$("<div/>").addClass('some-element').appendTo("body"); //new element will have blue color! 
```

插件将立即启动它。插件还确保一个元素只初始化一次。因此，如果您添加元素，然后`.deatch()`从正文中添加，然后再次添加，它将不会再次初始化。

```
$("<div/>").addClass('some-element').appendTo("body").detach()
    .appendTo(".some-container");
//initialized only once 
```

插件基于`MutationObserver`- 它可以在 IE9 和 10 上运行，并在[自述文件页面](https://github.com/AdamPietrasiak/jquery.initialize)上有详细说明。

# c++ - C++ 是“浪费时间”吗？

> ID：648998
> 
> 赞同：23
> 
> 时间：2009-03-16T01:53:05.573
> 
> 标签：c++

我遇到了 C++ 的发明者 Bjarne Stroustrup 的这个所谓的采访。

[http://artlung.com/smorgasborg/Invention_of_Cplusplus.shtml](http://artlung.com/smorgasborg/Invention_of_Cplusplus.shtml)

> **Stroustrup** : 好吧，现在已经够久了，而且我相信大多数人自己都明白 C++ 是在浪费时间，但我必须说，他们花费的时间比我想象的要长得多......
> 
> **采访**者：是的，但 C++ 基本上是一种健全的语言。
> 
> **Stroustrup**：你真的相信，不是吗？您是否曾经坐下来从事过 C++ 项目？事情是这样的：首先，我已经设置了足够多的陷阱，以确保只有最琐碎的项目才能第一次工作。以运算符重载为例。在项目结束时，几乎每个模块都有它，通常是因为人们觉得他们真的应该这样做，就像在他们的培训课程中一样。同一个运算符在每个模块中意味着完全不同的东西。当你有一百个左右的模块时，试着把很多东西放在一起。至于数据隐藏，天哪，当我听到公司在让他们的模块相互通信时遇到的问题时，我有时会忍不住笑。

这是骗局吗？对于任何资深的 C++ 程序员来说，这些观点中的任何一个似乎都是正确的吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-03-16T02:06:29.457

你只需要检查[Stroustrup 的网站（FAQ 部分）](http://www.stroustrup.com/bs_faq.html#IEEE)就可以发现它是错误的 - Judah Himango 已经指出的一个众所周知的骗局：

> **你真的接受过 IEEE 的采访吗？**
> 
> 您在其中承认 C++ 被故意创建为一种糟糕的语言，用于编写无法维护的代码以增加程序员的薪水？当然不是。[阅读真正的 IEEE 采访。](http://www.stroustrup.com/ieee_interview.html)

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-03-16T01:54:52.510

这是一个[众所周知的骗局](http://jimmod.blogspot.com/2007/01/interview-with-bjarne-stroustrup-hoax.html)。

不，学习 C++ 不是浪费你的时间，这在 StackOverflow 上已经讨论过很多次了。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-03-16T02:11:38.960

如前所述，这是一个众所周知的骗局。

但它确实引发了一些有趣的观点。现在 C++ 是在浪费时间，除非你不能浪费时间。不那么不透明：C++ 是在浪费**开发时间**，除非你不能浪费**执行**时间。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-16T02:07:47.893

摘自 IEEE Computer Magazine Vol. 上题为“The Real Stroustrup Interview”的文章。31 第 6 期，第 110-114 页（1998 年 6 月）：

> 在过去的几个月里，Stroustrup 和 Computer 之间的恶作剧采访一直在网络空间中流传。虽然我们对这一事件感到遗憾，但它为我们提供了一个可喜的机会，让 C++ 之父分享他对标准 C++ 和软件开发的总体见解。我们还可以证明他持续的分寸感和幽默感——他认为，如果他自己写了这个虚构的采访，那将是一个更有趣的模仿。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-16T03:19:06.677

正如其他人所提到的，这次采访是骗局。

好吧，我是讨厌 C++ 并且通常不使用它的人之一，但学习它绝对不是浪费时间。至少现在我知道为什么我讨厌 C++ 并且我理解为什么其他人使用这种语言并认为它很好。

如果你想学习这门语言来了解它的概念、优点和缺点，能够阅读用它编写的代码，并且通常能够“谈论”它，那绝不是浪费时间。任何其他编程语言都一样。它会增加你的经验。例如，C++ 展示了一种常见的 OOP 方式——我不喜欢这种方式，但许多其他人都在使用这种方式。

但是如果你想学习它，因为“人们说它是最好的”（就像我有时读到的那样），那真的是浪费时间。任何其他编程语言都一样。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-11-06T15:03:42.613

被高级语言所吸引的程序员会为他们处理内存管理和其他任务，他们可能会觉得 C++ 是在浪费时间。
当然，如果您可以在更短的时间内使用另一种语言和更少的错误修复来实现相同的目标，并且不介意效率的缺点。
但我并不后悔学习并花费了这么多时间在 C/C++ 中进行编码，因为它是如此美丽的语言，并且可以让您产生许多其他语言无法实现的东西。

我的意思是，您不想使用编写操作系统和编译器的语言吗？从我的角度来看，这根本不是浪费时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-16T02:13:50.873

C++ 绝不是浪费你的时间。您将了解有价值的概念，这些概念将帮助您理解不同编程语言中的许多其他概念。即：VTABLE。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-06T06:04:31.147

没有**一个**框架可以使用 C++ 的所有语言特性。这给语言的**生态系统**带来了巨大的**不一致性**。

 **QT 是少数几个我称之为框架（或**很多**东西的 API）的 API 之一：
但它定义了自己的字符串、自己的数组……

当没有人可以以可移植和兼容的方式（从与其他 API**交互的方面）使用“标准”库时，它的意义何在？**

我知道，有**boost**，但与 QT 之类的 API 相比，什么是 boost？没有。

看看 Java：这是标准的 Java API，每个“外来”API 都使用它，完全兼容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-16T02:06:02.423

C++（和 Java）可能是学习理解 OOP 概念的最佳语言。我记得在大学里学习它让我受益匪浅。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-06T05:56:01.337

Stroustrup 没那么傻这么说！这绝对是个骗局！**********``***