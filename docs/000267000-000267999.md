# StackOverflow 问答 000267000-000267999

# java - 将 Java2D 保存为 SWF（闪存）

> ID：267001
> 
> 赞同：7
> 
> 时间：2008-11-05T22:38:18.967
> 
> 标签：java, flash

我正在尝试将 Java2D 中的矢量图像绘图的输出保存到 SWF 文件中。有很棒的库可以将 java2D 输出保存为 SVG (BATIK) 和 PDF(itext) 之类的东西，但我找不到 SWF 的库。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T18:15:00.573

我刚刚得到了一个使用Adob​​e [Flex 3中的](http://opensource.adobe.com/wiki/display/flexsdk/Downloads)[SpriteGraphics2D](http://opensource.adobe.com/svn/opensource/flex/sdk/trunk/modules/swfutils/src/java/flash/graphics/g2d/SpriteGraphics2D.java)对象的示例。仅供参考... Flex 3 现在是开源的。

> *（来自 SpriteGraphics2D javadoc）* [SpriteGraphics2D](http://opensource.adobe.com/svn/opensource/flex/sdk/trunk/modules/swfutils/src/java/flash/graphics/g2d/SpriteGraphics2D.java)是 Java2D 的 Graphics2D API 的 SWF 特定实现。对此类的调用将转换为可用于构造 SWF Sprite 的 TagList。

我通过查看这两个类[CubicCurveTest.java](http://opensource.adobe.com/svn/opensource/flex/sdk/trunk/modules/swfutils/test/java/flash/swf/builder/types/CubicCurveTest.java)和[SpriteTranscoder.java](http://opensource.adobe.com/svn/opensource/flex/sdk/trunk/modules/compiler/src/java/flash/svg/SpriteTranscoder.java)弄清楚了这一点。

运行此示例所需的唯一两个 jar 是 swfutils.jar 和 batik-awt-util.jar，可以在[此处下载](http://opensource.adobe.com/wiki/display/flexsdk/Downloads)。

这是我的示例代码...

```
 // Create the SpriteGraphics2D object
     SpriteGraphics2D g = new SpriteGraphics2D(100, 100);

     // Draw on to the graphics object
     Font font = new Font("Serif", Font.PLAIN, 16);
     g.setFont(font);         
     g.drawString("Test swf", 30, 30);         
     g.draw(new Line2D.Double(5, 5, 50, 60));
     g.draw(new Line2D.Double(50, 60, 150, 40));
     g.draw(new Line2D.Double(150, 40, 160, 10));

     // Create a new empty movie
     Movie m = new Movie();
     m.version = 7;
     m.bgcolor = new SetBackgroundColor(SwfUtils.colorToInt(255, 255, 255));
     m.framerate = 12;
     m.frames = new ArrayList(1);
     m.frames.add(new Frame());
     m.size = new Rect(11000, 8000);

     // Get the DefineSprite from the graphics object
     DefineSprite tag = g.defineSprite("swf-test");

     // Place the DefineSprite on the first frame
     Frame frame1 = (Frame) m.frames.get(0);
     Matrix mt = new Matrix(0, 0);
     frame1.controlTags.add(new PlaceObject(mt, tag, 1, null));

     TagEncoder tagEncoder = new TagEncoder();
     MovieEncoder movieEncoder = new MovieEncoder(tagEncoder);
     movieEncoder.export(m);

     //Write to file
     FileOutputStream fos = new FileOutputStream(new File("/test.swf"));
     tagEncoder.writeTo(fos); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T23:46:51.607

嗯，我知道一些输出 Flash 内容的库，比如或[Ming](http://www.libming.org/ "明")，甚至是[Haxe](http://haxe.org/)，一种可以“翻译”成 JavaScript、Flash 或 PHP 代码的语言……但我不知道 Java 库。

搜索了一下（我很好奇），我找到了一个商业[Java Graph Library](http://big.faceless.org/products/graph/index.jsp "Java 图形库")，可能是封闭源代码，Java 中的 Flash 播放器，用于操作 ActionScript 源代码或[字节码](http://www.badgers-in-foil.co.uk/projects/jactionscript/ "ActionScript 字节码")的库......啊，后者指向[JavaSWF2](http://www.anotherbigidea.com/javaswf/ "JavaSWF2")应该是能够生成SWF。我还发现了一个[DrawSWF](http://drawswf.sourceforge.net/ "DrawSWF")，它使用... JavaSWF2 库作为后端！

PS.：还发现了[Transform SWF](http://www.flagstonesoftware.com/transform/index.html "转换 SWF")。看起来很有希望。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T22:47:52.053

Flash 通常使用 SVG 作为其原生格式。您可以导出为 SVG，然后编写一个简单的 Flash 程序来嵌入和显示图像。但是为什么要使用 Flash 呢？现在大多数浏览器都能够显示 SVG。

**编辑**：我不知道为什么我被否决了一个明确正确的答案。我可以理解没有因为没有最佳答案而被投赞成票（我完全承认这个解决方案并不理想），但我真的认为它不值得投反对票。[您可以查阅本页](http://livedocs.adobe.com/flex/3/html/help.html?content=embed_4.html)中间有关在 Flex 程序中嵌入 SVG 的部分。对于那些不熟悉的人，Flex 是一个 adobe 工具包/库，可以生成在普通 Flash 播放器中运行的 SWF 程序。许多（全部？）正常的 Flash 库可供它使用。它使用动作脚本。对于怀疑者，这里有一个片段显示了你是如何做到的，它是从我编写的 Flex 程序中复制而来的。它应该放在一个 MXML 文件中。

```
<mx:Script><![CDATA[

[Embed(source="../images/down.svg")]
[Bindable]
protected var drillDownImage:Class;

]]></mx:Script>

<mx:HBox width="50%" horizontalAlign="right">
    <mx:Image id="drillDownButton" source="{drillDownImage}" height="20" width="20" click="drillDown();" />
</mx:HBox> 
```

现在你需要做的就是将它包装在一个适当的 MXML 文件中，也许为 HBox 和 Image 标签导入一些控件包，你就可以开始了。我提供的链接中的示例应该足以让您弄清楚。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T13:25:01.440

这可能不是您要寻找的，但我会将其作为建议提出-

您是否考虑过让您的 java 输出动作脚本使用 flash 绘图 API 绘制矢量并使用免费的 flex as3 编译器将其编译为 .SWF 文件？如果您不使用 flex 库，则它不包含任何内容。您的 java 代码只会输出由 actionscript 代码模板包围的绘图线。

这使得 Test.swf 可以绘制一个正方形并为我编译到 610 个字节。

如果您需要即时转换，那么这会很慢，但对于预转换的图纸，这会很简单。

```
package{
  import flash.display.Sprite;

  public class Test extends Sprite{
    public function Test (){

      // Start of lines generated by your java
      graphics.lineStyle(1, 0, 1);
      graphics.lineTo(100, 0);
      graphics.lineTo(100, 100);
      graphics.lineTo(0, 100);
      graphics.lineTo(0, 0);
      // End of lines generated by your java
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T10:31:05.220

据我所知，flash 根本不使用 SVG。我根本不相信提到这一点的答案是正确的。（但我不能随心所欲地将其添加为评论，因为我没有足够的积分......）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-13T18:28:51.470

查看[转换 SWF](http://www.flagstonesoftware.com/transform/)。API 需要一些时间来适应，但它附带了一些非常有用的示例来帮助您入门。我自己用过，效果很好。

我的建议是完全跳过 SVG 作为从 Java2D 到 SWF 的一种方式。Batik 生成的 SVG 与我尝试将 SVG 导入 Flash 的解决方案表现得非常糟糕。

# asp.net - 在 FormView 上进入编辑模式时出现问题

> ID：267003
> 
> 赞同：1
> 
> 时间：2008-11-05T22:39:27.983
> 
> 标签：asp.net, user-controls, postback

我遇到的问题是我担心的是设计问题，而不是编码问题，但无论如何我都会问这个问题。

我有一个 ASP.NET 2.0 Web 应用程序，它根据数据库中的值动态加载两个不同的用户控件。这些用户控件中的每一个基本上都是一个 FormView 控件和一个显示数据库值的 SqlDataSource 控件。其中一个控件仅用于显示数据（我使用了 FormView，因此我可以更轻松地控制布局），而另一个 FormView 我需要用户能够编辑。

在此页面上，用户可以选择一个下拉菜单来更改用于加载控件的“魔法值”。此下拉菜单启用了自动回发。

当回发发生时，动态加载控件后一切看起来都很好，但是当您单击编辑按钮时，它只是刷新页面而不将 FormView 置于“编辑”模式。您必须再次单击“编辑”按钮才能实现这一点。

所以，现在我的问题是，我怎样才能停止额外的鼠标点击？我认为这与回传中事物的构造方式有关，但我的大脑现在很紧张，我希望那里的某个人可能已经解决了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T02:47:58.340

您在哪里（什么事件）加载用户控件？很可能在加载控件时，您的编辑按钮已经连线（没有）...

编辑：在 page_load 和 selected_index_changed 上放置断点以查看它们何时发生；可能是 page_load 首先发生，它消除了连线；您是否正在加载由 !IsPostBack 保护的控件并且 ViewState 是否打开？Viewstate 可能会自动恢复您的控件，但随后您的 page_load 会再次将它们清除...

...没有代码很难确定。您可能还想打开跟踪并将一些跟踪输出添加到您的方法中以确切了解何时发生了什么，并查看生成的 html 树

# asp.net-mvc - 无法加载文件或程序集“System.Web.Mvc”

> ID：267006
> 
> 赞同：204
> 
> 时间：2008-11-05T22:40:34.983
> 
> 标签：asp.net-mvc

我的新 ASP.NET MVC Web 应用程序可以在我的开发工作站上运行，但不能在我的 Web 服务器上运行...

* * *

# “/”应用程序中的服务器错误。

* * *

## 配置错误

**说明：**处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。

**解析器错误消息：**无法加载文件或程序集“System.Web.Mvc，Version=1.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。该系统找不到指定的文件。

**源错误：**

```
Line 44:         <add assembly="System.Web.Abstractions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
Line 45:         <add assembly="System.Web.Routing, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
Line 46:         <add assembly="System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
Line 47:         <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
Line 48:         <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/> 
```

**源文件：** C:\inetpub\www.example.org\web.config **行：** 46

**程序集加载跟踪：**以下信息有助于确定为什么无法加载程序集“System.Web.Mvc, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35”。

```
警告：程序集绑定日志记录已关闭。
要启用程序集绑定失败日志记录，请将注册表值 [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) 设置为 1。
注意：有一些与程序集绑定失败日志相关的性能损失。
要关闭此功能，请删除注册表值 [HKLM\Software\Microsoft\Fusion!EnableLog]。

```

* * *

**版本信息：** Microsoft .NET Framework 版本：2.0.50727.3053；ASP.NET 版本：2.0.50727.3053

* * *

我需要在服务器上安装*AspNetMVCBeta-setup.msi*吗？或者是否有不同的服务器安装程序？

![在此处输入图像描述](https://i.stack.imgur.com/V21XS.gif)

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2008-11-05T22:47:20.697

我刚刚写了一篇博客文章来解决这个问题。你可以在你的服务器上安装 ASP.NET MVC 或者你可以按照[这里的步骤](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)。

* * *

**编辑：（由 jcolebrand）我浏览了这个链接，然后遇到了与**[下面的](https://stackoverflow.com/questions/267006/could-not-load-file-or-assembly-system-web-mvc/5481834#5481834)[Victor](https://stackoverflow.com/users/653855/victor-juri) 相同的问题，所以我建议你也添加这些：

```
* Microsoft.Web.Infrastructure
* System.Web.Razor
* System.Web.WebPages.Deployment
* System.Web.WebPages.Razor 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2011-03-30T04:25:00.320

我遇到了与 sgriffinusa 相同的问题。除了参考 Phil 的文章建议：[http](http://www.haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx) ://www.haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx 。我添加了这些：

```
* Microsoft.Web.Infrastructure
* System.Web.Razor
* System.Web.WebPages.Deployment
* System.Web.WebPages.Razor 
```

Godaddy 部署工作完美。关闭自定义错误并添加参考以更正错误。这应该会引导你朝着正确的方向前进。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2008-11-05T22:47:06.797

直接在您的 Web 服务器上安装 MVC 是一种选择，因为这样程序集将安装在 GAC 中。您还可以对程序集进行 bin 部署，这可能有助于在最终版本可用之前使您的服务器远离预发布程序集。

Phil Haack 几天前发表了一篇关于如何将 MVC 与您的应用程序一起部署的好文章，因此无需直接安装：

[http://www.haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx](http://www.haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2011-01-26T04:23:25.017

我在尝试在 GoDaddy 共享主机上部署我的 MVC3 Razor Web 应用程序时遇到了同样的问题。有一些额外的 .dll 需要被引用。详情在这里：[http ://paulmason.biz/?p=108](http://paulmason.biz/?p=108)

基本上，除了@Haacked 的帖子中列出的引用之外，您还需要添加对以下内容的引用，并将它们设置为按照描述在本地部署。

*   Microsoft.Web.Infrastructure
*   System.Web.Razor
*   System.Web.WebPages.Deployment
*   System.Web.WebPages.Razor

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-11-09T01:13:18.320

在 VS2010 中，右键单击解决方案资源管理器中的项目并选择“添加可部署依赖项”。然后在以下对话框中选中与 MVC 相关的复选框。

这会在项目中创建一个“_bin_deployableAssemblies”文件夹，其中包含其他答案中提到的所有 .dll 文件。我相信在创建部署包时这些会被复制到 bin 文件夹中。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-06-02T07:59:19.340

**快速简单的解决方案：**我在使用 Microsoft.AspNet.Mvc -Version 5.2.3 时遇到了这个问题，经过所有这些线程后，我找到了一个最简单的解决方案。

只需按照以下步骤操作：

1.  在 Visual Studio 中为您的项目打开 NuGet 包管理器
2.  搜索 Microsoft.AspNet.Mvc
3.  找到后，将操作更改为卸载并卸载它
4.  完成后，再次安装并立即尝试

这将自动修复所有引用问题。见下图：

[![在此处输入图像描述](https://i.stack.imgur.com/WrWK6.png)](https://i.stack.imgur.com/WrWK6.png)

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2012-08-15T15:21:15.817

简单的修复。在 VS2010 中，右键单击您的 MVC 项目，选择“Add Deployable Dependencies...”，选择您想要的选项并单击确定

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-01-27T11:38:47.697

有同样的问题并添加了他们所说的所有程序集，但仍然出现同样的错误。

原来你需要使“**特定版本**”= False。

![具体版本应该是假的。](https://i.stack.imgur.com/KMp9O.png)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-11-16T23:45:22.623

我们想要添加它，因为我们正在制作一个使用它的类库。

对我来说它就在这里...

`C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET MVC 4\Assemblies`

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-06-30T16:43:44.917

如果您不使用托管服务提供商，并且您可以访问要安装的服务器...然后安装 MVC 3 更新工具，请执行此操作...它将为您节省数小时在 windows 2003 服务器/IIS6 机器上的问题。，我在这里评论了这个页面 [Nuget.Core.dll 版本号不匹配](https://stackoverflow.com/questions/5831785/problem-deploying-nuget-server-with-deployable-dependencies/6529145#6529145)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-07-04T16:23:22.440

除了 Haack 的帖子，Hanselman 也有类似的帖子。 [BIN 将带有 Razor 的 ASP.NET MVC 3 部署到未安装 MVC 的 Windows 服务器](http://www.hanselman.com/blog/BINDeployingASPNETMVC3WithRazorToAWindowsServerWithoutMVCInstalled.aspx)

对我来说，“复制本地 = true”解决方案是不够的，因为我网站的项目引用不包括所有丢失的 dll。正如 Scott 在他的帖子中提到的，我还需要从我的开发框上的以下文件夹中获取额外的 dll：C:\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Pages\v1.0\Assemblies。错误消息告诉我缺少哪个 dll（System.Web.Infrastructure、System.Web.Razor 等）。我继续逐个添加每个缺少的 dll，直到它起作用。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-06-27T09:23:09.590

我已经在 Visual Studio 2015 中执行了“更新包 - 重新安装 Microsoft.AspNet.Mvc”来修复它。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-01-20T07:47:52.907

一个重要的考虑因素是 web.config 文件，一些包可能会破坏您的绑定重定向，从而造成破坏（流氓包是内部包，我没有从包中删除 web.config 或确保包中的 web.config没有任何绑定重定向。例如，通过删除重复和不正确的节点来解决此问题

```
 <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
            <dependentAssembly>
                <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31BF3856AD364E35" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-3.0.0.0" newVersion="3.0.0.0"/>
            </dependentAssembly>
            <dependentAssembly>

                <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="0.0.0.0-5.2.3.0" newVersion="5.2.3.0"/>
                <assemblyIdentity name="Microsoft.Owin" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-3.0.1.0" newVersion="3.0.1.0"/>
                <assemblyIdentity name="Microsoft.Owin.Security.OAuth" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <assemblyIdentity name="Microsoft.Owin.Security" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <assemblyIdentity name="Microsoft.Owin.Security.Cookies" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-9.0.0.0" newVersion="9.0.0.0"/>
                <assemblyIdentity name="WebGrease" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-1.6.5135.21930" newVersion="1.6.5135.21930"/>
                <assemblyIdentity name="Antlr3.Runtime" publicKeyToken="eb42632606e9261f" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-3.5.0.2" newVersion="3.5.0.2"/>

                <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="1.0.0.0-3.0.0.0" newVersion="3.0.0.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35"/>
                <bindingRedirect oldVersion="0.0.0.0-5.2.3.0" newVersion="5.2.3.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="Microsoft.Owin.Security" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-3.0.1.0" newVersion="3.0.1.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="Microsoft.Owin" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-3.0.1.0" newVersion="3.0.1.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-9.0.0.0" newVersion="9.0.0.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="WebGrease" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-1.6.5135.21930" newVersion="1.6.5135.21930"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="Microsoft.Owin.Security.Cookies" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-3.0.1.0" newVersion="3.0.1.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="Microsoft.Owin.Security.OAuth" publicKeyToken="31bf3856ad364e35" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-3.0.1.0" newVersion="3.0.1.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="SimpleInjector" publicKeyToken="984cb50dea722e99" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-3.3.2.0" newVersion="3.3.2.0"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="Antlr3.Runtime" publicKeyToken="eb42632606e9261f" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-3.5.0.2" newVersion="3.5.0.2"/>
            </dependentAssembly>
            <dependentAssembly>
                <assemblyIdentity name="HtmlAgilityPack" publicKeyToken="bd319b19eaf3b43a" culture="neutral"/>
                <bindingRedirect oldVersion="0.0.0.0-1.4.9.5" newVersion="1.4.9.5"/>
            </dependentAssembly>
        </assemblyBinding>
    </runtime> 
```

通过删除第 8 到 24 行来修复构建。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-11-16T00:37:57.863

**还要检查Views 文件夹**中 web.config 中的程序集版本，并确保它匹配。我有时会忘记该位置有第二个 web.config。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-04-19T09:53:42.727

将项目移动到另一个解决方案后，我在一堆汇编文件中遇到了同样的问题。

对我来说，该`web.config`文件试图添加这个程序集：

```
<add assembly="System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/> 
```

认为项目中的引用指向版本`3.0.0.0`（单击引用并滚动到属性的底部）。因此，我只是更改了`web.config`文件中的参考版本。

我不知道这是否只是某种错误。添加所有其他引用的问题是这些引用出现在配置文件中，但在项目中（在解决方案资源管理器中）实际上根本没有引用它，并且所需的文件没有与其余的项目文件一起复制，可能是因为没有`"copy local = true"`

现在，我无法在可添加程序集中找到这些程序集（通过右键单击引用并尝试从程序集或扩展中添加它们）。相反，我创建了一个新的 MVC 解决方案，它添加了我需要的所有程序集和引用，并在解决方案资源管理器的新项目引用下找到它们，并在属性窗口中找到它们的路径以供参考。

然后我只是将我需要的库复制到另一个项目中并引用它们。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-02-07T19:14:06.630

在尝试了一切但仍然失败之后，这是我的解决方案：我记得我上次在我的 Visual Studio 中更新 MVC 版本时出错，所以我从另一台 Visual Studio（不同的计算机）运行项目，然后上传 dll-s 并且它工作。也许它会帮助某人......

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-04-23T14:18:29.563

我正在将 Jenkins 与 .net 项目一起使用，并且在使用 MVC 4 引用时遇到了麻烦。

我终于通过使用基于注册表的.Net参考搜索引擎功能解决了我的问题：

“HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft.NETFramework\v2.0.50727\AssemblyFoldersEx”

例如，您可以创建子键并将默认键设置为“c:\myreferenceedir”。

它为我节省了 MVC 版本和 ASP.net 网页。

有用添加对“添​​加引用对话框”的引用

[http://dhakshinamoorthy.wordpress.com/2011/12/04/how-to-register-your-net-assembly-in-gac-and-make-it-show-in-add-reference-dialog/](http://dhakshinamoorthy.wordpress.com/2011/12/04/how-to-register-your-net-assembly-in-gac-and-make-it-show-in-add-reference-dialog/)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-03-02T21:34:05.573

我使用 Manage NuGet Packages 添加了“Microsoft ASP.NET Razor”。

使用 Add References，由于某种原因，我只有 System.Web.Helpers 1.0.0 和 2.0.0 ......但没有 3.0.0。

另一个对我有用的选项是删除对 System.Web.Mvc 和 System.Web.Http... 的引用，然后将它们重新添加到 csproj 文件中的包位置（您可以最轻松地使用文本编辑器）：

```
<Reference Include="System.Web.Http">
  <HintPath>..\packages\Microsoft.AspNet.WebApi.Core.5.2.3\lib\net45\System.Web.Http.dll</HintPath>

<Reference Include="System.Web.Mvc, Version=5.2.3.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35, processorArchitecture=MSIL">
  <HintPath>..\packages\Microsoft.AspNet.Mvc.5.2.3\lib\net45\System.Web.Mvc.dll</HintPath> 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-09-03T04:42:02.630

`Copy Local`正如其他人所提到的，将这些引用添加到设置为的视觉工作室`true`。（我也不得不补充`System.Web.Webpages`）

```
Microsoft.Web.Infrastructure
System.Web.Razor
System.Web.WebPages.Deployment
System.Web.WebPages.Razor
System.Web.Webpages 
```

# asp.net - ClientScriptManager.GetPostBackEventReference 方法

> ID：267011
> 
> 赞同：7
> 
> 时间：2008-11-05T22:41:32.987
> 
> 标签：asp.net, postback, msdn

我正在尝试理解这种方法的含义，因为我正在阅读[这篇](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.getpostbackeventreference.aspx)文章并想知道这可能有什么用途。我不太明白给出的例子。

谁能给它另一种解释。例子会有所帮助。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T00:14:34.873

最简单的示例是 LinkBut​​ton。在页面中放置一个并查看它生成的 HTML。你会看到类似的东西。

```
href="javascript:__doPostBack('ctl00$LinkButton1','')" 
```

GetPostBackEventReference 允许您获取那段 JavaScript，以便您可以从其他地方触发该回发。无论您运行那段 JavaScript，都会发生回发，并且 OnClick 事件将在服务器上触发，就像您单击了 LinkBut​​ton 一样。MSDN 上的示例将类似的 JavaScript 连接到链接以触发 GridView 上的服务器端事件。

更实际的用途是您想要在自定义控件中处理回发。您的控件实现[IPostBackEventHandler](http://msdn.microsoft.com/en-us/library/system.web.ui.ipostbackeventhandler.aspx)来处理服务器上的回发，并且您使用 GetPostBackEventReference 来获取将触发这些回发的 JavaScript。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T00:24:20.687

正如史蒂夫提到的，这可以用于

> GetPostBackEventReference 允许您获取那段 JavaScript，以便您可以从其他地方触发该回发。

举个例子，您可以使用此函数获取对按钮单击的 PostBack 事件的引用并将其添加到文本框的 onblur 中。

每当文本框失去焦点时，这将模拟按钮单击。

# java - 用 Java 读取 XLSX 文件

> ID：267025
> 
> 赞同：36
> 
> 时间：2008-11-05T22:48:02.113
> 
> 标签：java, excel, parsing

我需要在 Java 应用程序中读取 Excel 2007 XLSX 文件。有谁知道完成这项任务的好 API？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-10-29T11:35:26.937

[Apache POI](http://poi.apache.org/) 3.5 增加了对所有 OOXML（docx、xlsx 等）的支持。

查看[XSSF 子项目](http://poi.apache.org/spreadsheet/index.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T08:18:49.747

AFAIK 还没有可用的 xlsx 库。但是有一些旧的xls：

一个库是[jxls](http://jxls.sourceforge.net/)，它在内部使用已经提到的[POI](http://poi.apache.org/)。

2 其他链接：[处理 Excel 文件](http://www.rgagnon.com/javadetails/java-0516.html)、[Java 库以读取和写入 Excel XLS 文档文件](http://roide-textcube.blogspot.fr/2009/02/java-libraries-to-read-and-write-excel.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-18T09:53:05.127

试试这个：

1.  解压 XLSX 文件
2.  读取 XML 文件
3.  编写和使用数据

示例代码：

```
 public Workbook getTemplateData(String xlsxFile) {
    Workbook workbook = new Workbook();
    parseSharedStrings(xlsxFile);
    parseWorkesheet(xlsxFile, workbook);
    parseComments(xlsxFile, workbook);
    for (Worksheet worksheet : workbook.sheets) {
        worksheet.dimension = manager.getDimension(worksheet);
    }

    return workbook;
}

private void parseComments(String tmpFile, Workbook workbook) {
    try {
        FileInputStream fin = new FileInputStream(tmpFile);
        final ZipInputStream zin = new ZipInputStream(fin);
        InputStream in = getInputStream(zin);
        while (true) {
            ZipEntry entry = zin.getNextEntry();
            if (entry == null)
                break;

            String name = entry.getName();
            if (name.endsWith(".xml")) { //$NON-NLS-1$
                if (name.contains(COMMENTS)) {
                    parseComments(in, workbook);
                }
            }
            zin.closeEntry();
        }
        in.close();
        zin.close();
        fin.close();
    } catch (FileNotFoundException e) {
        System.out.println(e);
    } catch (IOException e) {
        e.printStackTrace();
    }
}

private void parseComments(InputStream in, Workbook workbook) {
    try {
        DefaultHandler handler = getCommentHandler(workbook);
        SAXParser saxParser = getSAXParser();
        saxParser.parse(in, handler);
    } catch (Exception e) {
        e.printStackTrace();
    }
}

private DefaultHandler getCommentHandler(Workbook workbook) {
    final Worksheet ws = workbook.sheets.get(0);
    return new DefaultHandler() {
        String lastTag = "";
        private Cell ccell;

        @Override
        public void startElement(String uri, String localName,
                String qName, Attributes attributes) throws SAXException {
            lastTag = qName;
            if (lastTag.equals("comment")) {
                String cellName = attributes.getValue("ref");
                int r = manager.getRowIndex(cellName);
                int c = manager.getColumnIndex(cellName);
                Row row = ws.rows.get(r);
                if (row == null) {
                    row = new Row();
                    row.index = r;
                    ws.rows.put(r, row);
                }
                ccell = row.cells.get(c);
                if (ccell == null) {
                    ccell = new Cell();
                    ccell.cellName = cellName;
                    row.cells.put(c, ccell);
                }
            }
        }

        @Override
        public void characters(char[] ch, int start, int length)
                throws SAXException {
            String val = "";
            if (ccell != null && lastTag.equals("t")) {
                for (int i = start; i < start + length; i++) {
                    val += ch[i];
                }
                if (ccell.comment == null)
                    ccell.comment = val;
                else {
                    ccell.comment += val;
                }
            }
        }
    };
}

private void parseSharedStrings(String tmpFile) {
    try {
        FileInputStream fin = new FileInputStream(tmpFile);
        final ZipInputStream zin = new ZipInputStream(fin);
        InputStream in = getInputStream(zin);
        while (true) {
            ZipEntry entry = zin.getNextEntry();
            if (entry == null)
                break;
            String name = entry.getName();
            if (name.endsWith(".xml")) { //$NON-NLS-1$
                if (name.startsWith(SHARED_STRINGS)) {
                    parseStrings(in);
                }
            }
            zin.closeEntry();
        }
        in.close();
        zin.close();
        fin.close();
    } catch (FileNotFoundException e) {
        System.out.println(e);
    } catch (IOException e) {
        e.printStackTrace();
    }
}

public void parseWorkesheet(String tmpFile, Workbook workbook) {
    try {
        FileInputStream fin = new FileInputStream(tmpFile);
        final ZipInputStream zin = new ZipInputStream(fin);
        InputStream in = getInputStream(zin);
        while (true) {
            ZipEntry entry = zin.getNextEntry();
            if (entry == null)
                break;

            String name = entry.getName();
            if (name.endsWith(".xml")) { //$NON-NLS-1$
                if (name.contains("worksheets")) {
                    Worksheet worksheet = new Worksheet();
                    worksheet.name = name;
                    parseWorksheet(in, worksheet);
                    workbook.sheets.add(worksheet);
                }
            }
            zin.closeEntry();
        }
        in.close();
        zin.close();
        fin.close();
    } catch (FileNotFoundException e) {
        System.out.println(e);
    } catch (IOException e) {
        e.printStackTrace();
    }
}

public void parseWorksheet(InputStream in, Worksheet worksheet)
        throws IOException {
    // read sheet1 sharedStrings
    // styles, strings, formulas ...
    try {
        DefaultHandler handler = getDefaultHandler(worksheet);
        SAXParser saxParser = getSAXParser();
        saxParser.parse(in, handler);
    } catch (SAXException e) {
        e.printStackTrace();
    } catch (ParserConfigurationException e) {
        e.printStackTrace();
    }
} 
```

其中工作簿类：

```
public class Workbook {
Integer id = null;
public List<Worksheet> sheets = new ArrayList<Worksheet>();} 
```

和工作表类：

```
public class Worksheet {
public Integer id = null;
public String name = null;
public String dimension = null;
public Map<Integer, Row> rows = new TreeMap<Integer, Row>();
public Map<Integer, Column> columns = new TreeMap<Integer, Column>();
public List<Span> spans = new ArrayList<Span>();} 
```

和行类：

```
public class Row {
public Integer id = null;
public Integer index = null;
public Row tmpRow = null;
public Style style = null;
public Double height = null;
public Map<Integer,Cell> cells = new TreeMap<Integer, Cell>();
public String spans = null;
public Integer customHeight = null;} 
```

和细胞类：

```
public class Cell {
public Integer id = null;
public Integer rowIndex = null;
public Integer colIndex = null;
public String cellName = null;
public String text = null;
public String formula = null;
public String comment = null;
public Style style = null;
public Object value = null;
public Cell tmpCell = null;} 
```

和列类：

```
public class Column {
    public Integer index = null;
    public Style style = null;
    public String width = null;
    public Column tmpColumn = null;
} 
```

和跨度类：

```
public class Span {
    Integer id = null;
    String topLeft = null;
    String bottomRight = null;
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-05T22:57:27.307

我必须在 .NET 中执行此操作，但我找不到任何 API。我的解决方案是解压缩 .xlsx，然后直接操作 XML。一旦你创建了你的助手类等等，它就不是那么糟糕了。

有一些“陷阱”，比如节点都必须按照 excel 期望的方式进行排序，我在官方文档中没有找到。Excel 有自己的日期时间戳，因此您需要制定一个转换公式。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-29T14:29:51.283

可能有点晚了，但是 beta POI 现在支持 xlsx。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-27T07:20:23.703

这个可能对你有用，它可以读/写 Excel 2007 xlsx 文件。 [SmartXLS](http://www.smartxls.com/indexj.htm)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-04T14:35:33.683

我对任何选项都不是很满意，所以我最终请求了 Excel 97 格式的文件。POI 对此非常有效。感谢大家的帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-05T22:57:37.710

你看过[那些混淆不清的 API](http://poi.apache.org)吗？

没关系：

> HSSF 是 POI 项目的 Excel '97(-2007) 文件格式的纯 Java 实现。它不支持不基于 OLE2 的新 Excel 2007 .xlsx OOXML 文件格式。

您可能会考虑改用[JDBC-ODBC 桥接器](http://www.javaworld.com/javaworld/javaqa/2001-06/04-qa-0629-excel.html)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-06T07:54:27.440

我不知道 Excel 2007 是否是最新的，但对于早期版本，我使用[JExcelAPI](http://jexcelapi.sourceforge.net/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-09-10T00:11:07.203

docx4j 现在也涵盖 xlsx。

“你为什么要使用 docx4j 来做这个”，我听到你问，“而不是专注于 xlsx 和二进制 xls 的 POI？”

可能是因为您喜欢 JAXB（而不是 XML Beans），或者您已经将 docx4j 用于 docx 或 pptx，并且还需要能够使用 xlsx 做一些事情。

另一个可能的原因是从 OpenXML 模式生成的 jar XML Beans 对于您的目的来说太大了。（为了解决这个问题，POI 提供了一个“精简”子集：“大”ooxml-schemas-1.0.jar 为 14.5 MB！但如果您需要支持任意电子表格，您可能需要完整的 jar）。相比之下，整个 docx4j/pptx4j/xlsx4j 的重量与 POI 的 lite 子集大致相同。

如果您只处理电子表格（即不是 docx 或 pptx），并且前面的段落不是您所关心的，那么您可能最好使用 POI。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-07-18T18:25:29.143

[Aspose.Cells for Java](http://www.aspose.com/categories/java-components/aspose.cells-for-java/default.aspx)支持 XLSX 格式。[您可以在Aspose.Cells for Java 文档](http://www.aspose.com/documentation/java-components/aspose.cells-for-java/index.html)中找到更多详细信息和进一步帮助。请看看这是否有帮助。

披露：我在 Aspose 担任开发人员布道师。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-11-06T14:54:13.500

您可以为此使用[Apache Tika](https://tika.apache.org/)：

```
String parse(File xlsxFile) {
    return new Tika().parseToString(xlsxFile);
} 
```

Tika 使用[Apache POI](https://poi.apache.org/)来解析 XLSX 文件。

以下是 Tiki 的一些[使用示例](https://tika.apache.org/1.11/examples.html)。

或者，如果您想单独处理电子表格的每个单元格，以下是使用 POI 执行此操作的一种方法：

```
void parse(File xlsx) {
    try (XSSFWorkbook workbook = new XSSFWorkbook(xlsx)) {
        // Handle each cell in each sheet
        workbook.forEach(sheet -> sheet.forEach(row -> row.forEach(this::handle)));
    }
    catch (InvalidFormatException | IOException e) {
        System.out.println("Can't parse file " + xlsx);
    }
}

void handle(Cell cell) {
    final String cellContent;
    switch (cell.getCellType()) {
        case Cell.CELL_TYPE_STRING:
            cellContent = cell.getStringCellValue();
            break;
        case Cell.CELL_TYPE_NUMERIC:
            cellContent = String.valueOf(cell.getNumericCellValue());
            break;
        case Cell.CELL_TYPE_BOOLEAN:
            cellContent = String.valueOf(cell.getBooleanCellValue());
            break;
        default:
            cellContent = "Don't know how to handle cell " + cell;
    }
    System.out.println(cellContent);
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-08-30T05:07:33.500

如果你想使用 xlsx，你必须使用这个`org.apache.poi.ss`包。这个包有XSSF类，可以用来解析xlxs文件。此示例代码适用于 Excel 2007 或更高版本 (.xlsx)

```
OPCPackage pkg = OPCPackage.open(new ByteArrayInputStream(data));
            Workbook wb = new XSSFWorkbook(pkg);
            Sheet sheet = wb.getSheetAt(0);
            Iterator<Row> rows = sheet.rowIterator();

        while (rows.hasNext()) {
            int j = 5;
            Person person= new Person ();
            Row row = rows.next();
            if (row.getRowNum() > 0) {
                person.setPersonId((int)(row.getCell(0).getNumericCellValue()));
                person.setFirstName(row.getCell(1).getStringCellValue());
                person.setLastName(row.getCell(2).getStringCellValue());
                person.setGroupId((int)(row.getCell(3).getNumericCellValue()));
                person.setUserName(row.getCell(4).getStringCellValue());
                person.setCreditId((int)(row.getCell(5).getNumericCellValue()));
            }

        }

Excel 1998-2003 file (.xls) - you may use HSSF library.
  just use :  Workbook wb = new HSSFWorkbook(pkg); 
```

# c++ - 简单的 C++ 代码不起作用

> ID：267026
> 
> 赞同：2
> 
> 时间：2008-11-05T22:48:03.050
> 
> 标签：c++, gcc, g++

这个非常简单的代码给了我很多错误：

```
#include <iostream>
#include <string>

int main() {
    std::string test = " ";
    std::cout << test;
} 
```

我试图通过在控制台上输入**gcc -o simpletest simpletest.cpp在 linux 上编译它。**我不明白为什么它不起作用。怎么了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T22:49:46.400

尝试使用“g++”而不是“gcc”。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-05T23:11:06.467

补充其他人所说的：`g++`是 GNU C++ 编译器。 `gcc`是 GNU 编译器集合（**不是**许多人认为的 GNU C 编译器）。 `gcc`用作`g++`编译 C++ 源代码时的前端。 `gcc`可以编译 C、C++、Objective-C、Fortran、Ada、汇编等。

它尝试编译失败的原因`gcc`是您需要在 C++ 标准库中进行链接。默认情况下，`g++`会这样做，但`gcc`不会。要使用 链接到 C++ 标准库`gcc`，请使用以下命令：

```
gcc -o simpletest simpletest.cpp **-lstdc++**
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-05T22:49:58.413

尝试：

```
g++ -o simpletest simpletest.cpp 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-05T22:50:44.637

尝试使用`g++ -o simpletest simpletest.cpp`. gcc 是 C 编译器，而 g++ 是 C++ 编译器，它还链接所需的 C++ 库。

此外，您必须在函数`return 0;`末尾添加一个。`main()`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T23:04:41.300

如果您的编译器很挑剔，您可能希望在最后添加所有重要`return 0;`的内容

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T22:49:46.277

您声明您`main()`的退货，`int`但您没有退货声明。添加`return 0;`并查看是否有帮助。如果这不能解决您的问题，请尝试编辑您的帖子以包含您遇到的错误中的一些代表性行，也许我们可以为您提供更好的帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-16T19:59:58.580

g++ 对我来说也是正确的答案，我投了赞成票，谢谢。

但是我的代码，自 1998 年 2 月 13 日（第一条评论）以来一直在使用的代码，用于计算我们孩子的保姆的有效总工资和预扣税，即使对于 g++ 来说也太简单了。就上面的例子而言，我的 Stroustrup-second-edition-compliant 恐龙去了：

```
// too simple!

#include <iostream.h>
#include <stdlib.h>

main() {
    cout << "Hello World!" << endl;
} 
```

这将为您提供一个完整的错误消息终端窗口。除花括号外的所有内容都是错误！而且它缺少返回线。时间是，这将在商业 C++ 开发环境中正确编译和运行......

踢它新学校，我现在正在使用：//足够简单

```
#include <iostream>
#include <stdlib.h>

int main(int argc, char* argv[] ) {
    std::cout << "Hello World!" << std::endl;
//  TODO - this ought to return success, 0
} 
```

最初的提问者有 std::cout 并使用了来自的字符串

```
 <string>... 
```

“简单”是一个相对术语...

账单

# .net - 为什么 MSBuild 没有像我期望的那样复制

> ID：267030
> 
> 赞同：8
> 
> 时间：2008-11-05T22:49:29.490
> 
> 标签：.net, msbuild

我需要编写我的构建脚本。我正在使用 MSBUILD，因为它与 VS.net 集成。我正在尝试将一些文件从构建环境复制到部署文件夹。我正在使用 MSBuild 的复制任务。但不是像我期望的那样复制目录树。它将所有内容复制到一个文件夹中。我重复目录树中的所有文件，最终都放在一个文件夹中。我需要它将文件夹和目录树复制到目标文件夹中。有什么我想念的吗？

这是我的构建脚本的相关部分：

```
<PropertyGroup>
    <TargetFrameworkVersion>v2.0</TargetFrameworkVersion>
    <Source>outputfolder</Source>
    <DestEnv>x</DestEnv>
    <DeployPath>\\networkpath\$(DestEnv)</DeployPath>
</PropertyGroup>
<ItemGroup>
    <TargetDir Include="$(DeployPath)\**\*" Exclude="**\web.config"></TargetDir>
    <SourceDir Include="$(Source)\**\*" />
</ItemGroup>    
<Target Name="Clean" >
    <!-- clean detail ... -->
</Target>
<Target Name="migrate" DependsOnTargets="Clean">
    <Copy DestinationFolder="$(DeployPath)" SourceFiles="@(SourceDir)" />
</Target> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-12T07:53:53.047

只是我们在调试有关复制的 MSBuild 问题时发现的一个宝石：

[http://blog.scrappydog.com/2008/06/subtle-msbuild-bug-feature.html](http://blog.scrappydog.com/2008/06/subtle-msbuild-bug-feature.html)

ItemGroups 在 Targets 之前被解析，因此当在脚本中进一步引用 ItemGroup 时，不会拾取任何创建新文件（例如编译！）的 Targets。

Eric Bowen 还描述了这个“功能”的变通方法，即**CreateItem**任务：

```
<Target Name="Copy" >
    <CreateItem Include="..\Source\**\bin\**\*.exe"
        Exclude="..\Source\**\bin\**\*.vshost.exe">
        <Output TaskParameter="Include" ItemName="CompileOutput" />
    </CreateItem>
    <Copy SourceFiles="@(CompileOutput)" 
        DestinationFolder="$(OutputDirectory)"></Copy>
</Target> 
```

给他很多赞！

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-05T23:15:48.207

当您为 Copy 任务指定 DestinationFolder 时，它会从 SourceFiles 集合中获取所有项目并将它们复制到 DestinationFolder。这是意料之中的，因为复制任务无法确定每个项目路径的哪一部分需要替换为 DestinationFolder 以保持树结构。例如，如果您的 SourceDir 集合定义如下：

```
<ItemGroup>
    <SourceDir Include="$(Source)\**\*" />
    <SourceDir Include="E:\ExternalDependencies\**\*" />
    <SourceDir Include="\\sharedlibraries\gdiplus\*.h" />
</ItemGroup> 
```

您希望目标文件夹树是什么样的？

要保留树，您需要进行身份转换并为 SourceFiles 集合中的每个项目生成一个目标项目。这是一个例子：

```
<Copy SourceFiles="@(Compile)" DestinationFiles="@(Compile->'$(DropPath)%(Identity)')" /> 
```

Copy 任务将获取 SourceFiles 集合中的每个项目，并将通过将源项目规范中 ** 之前的部分替换为 $(DropPath) 来转换其路径。

有人可能会争辩说 DestinationFolder 属性应该被编写为以下转换的快捷方式：

```
<Copy SourceFiles="@(Compile)" DestinationFiles="@(Compile->'$(DestinationFolder)%(Identity)')" /> 
```

唉，这将阻止您试图避免的深度复制到平面文件夹的情况，但其他人可能会在他们的构建过程中使用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-08T17:36:27.080

递归复制目录内容和结构的非常简单的示例：

```
<Copy SourceFiles="@(Compile)" DestinationFolder="c:\foocopy\%(Compile.RecursiveDir)"></Copy> 
```

@(Compile) 是您要复制的所有文件的 ItemGroup。可能是这样的：

```
 <ItemGroup>
      <Compile Include=".\**\*.dll" /> 
   </ItemGroup> 
```

Copy 任务会将所有文件复制到 c:\foocopy 中，就像 xcopy 一样。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-05T23:07:26.210

[我在MSDN](http://msdn.microsoft.com/en-us/library/3e54c37h.aspx)中的一个示例中找到了该示例，我不明白，但会在 stackoverflow 中为我的同行留下一个示例。这是上面迁移目标的固定版本：

```
<Target Name="migrate" DependsOnTargets="Clean">
    <Copy DestinationFiles="@(SourceDir->'$(DeployPath)\%(RecursiveDir)%(Filename)%(Extension)')" SourceFiles="@(SourceDir)" />
</Target> 
```

如果有人真正理解这个例子，请解释一下。祝你好运！

# c# - 使用 LINQ 获取序列的奇数/偶数部分

> ID：267033
> 
> 赞同：26
> 
> 时间：2008-11-05T22:49:49.707
> 
> 标签：c#, linq

假设我有一个 all 列表`Projects`，并且我将它们按`Category`如下方式分组：

```
var projectsByCat = from p in Projects
                    group p by p.Category into g
                    orderby g.Count() descending
                    select new { Category = g.Key, Projects = g }; 
```

现在我想在网页中将其显示为列表，首先我创建左侧 div，然后创建右侧 div。我按`Projects`每个中的数量排序`Category`以显示顶部`Categories`最多`Projects`的 - 因此我想分成`projectsByCat`两部分 - 如果我将所有“奇数`Categories`”类别放在左侧，“偶数”类别放在右侧，我我想我会得到一个相当理智的看法。

所以我想我可以这样做来获得奇数和偶数成员`projectsByCat`：

```
var oddCategories = projectsByCat.Where((cat, index) => index % 2 != 0);

var evenCategories = projectsByCat.Where((cat, index) => index % 2 == 0); 
```

它会编译 - 但是，当我运行它时，会出现如下异常：

> 用于查询运算符“Where”的不受支持的重载。

而且我认为我是安全的，因为它首先编译了.. ;)

有没有一种优雅的方式来做到这一点？而且，对于为什么我的创造性使用`Where()`不起作用，是否有一个优雅的解释？

提前致谢！

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-05T22:57:32.173

如果您使用 LINQ to SQL 或 LINQ to Entities，您应该首先将结果完全具体化到内存中：

```
var oddCategories  = projectsByCat.ToList().Where((c,i) => i % 2 != 0);
var evenCategories = projectsByCat.ToList().Where((c,i) => i % 2 == 0); 
```

在不使用游标的情况下，不可能使用索引器遍历数据库上的结果，而这两个 ORM 框架都**没有**。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-06T00:12:38.607

请注意，`.ToList()`为同一查询调用两次将查询数据库两次。

将结果缓存在中间列表中会更好，*然后*应用谓词过滤：

```
var projectsByCat =
    (from p in Projects
    group p by p.Category into g
    orderby g.Count() descending
    select new { Category = g.Key, Projects = g }).ToList();

var oddCategories = projectsByCat.Where((cat, index) => index % 2 != 0);
var evenCategories = projectsByCat.Where((cat, index) => index % 2 == 0); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-06-14T12:31:59.857

奇数类别和偶数类别是落后的。

索引从 0 而不是 1 开始

0 % 2 = 0

0 索引是奇数。

```
var oddCategories  = projectsByCat.Where((cat, index) => index % 2 == 0);

var evenCategories = projectsByCat.Where((cat, index) => index % 2 != 0); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-05-23T06:41:50.123

使用 LINQ 执行此操作并避免对输入进行多次枚举的正确方法是对每个项目是偶数还是奇数进行分组或类似操作。

一种使用重载的简单方法将索引与[索引](https://msdn.microsoft.com/en-us/library/bb534869(v=vs.100).aspx)`Select`相结合，可为您提供所需的内容：[`ToLookup`](https://msdn.microsoft.com/en-us/library/bb549211(v=vs.100).aspx)

```
var oddsAndEvens = input
    .ToList() // if necessary to get from IQueryable to IEnumerable
    .Select((item, index) => new { isEven = index % 2 != 0, item })
    .ToLookup(
        i => i.isEven,
        i => i.item); 
```

这将产生一个具有[以下好处](https://msdn.microsoft.com/en-us/library/bb292716(v=vs.100).aspx)[`Lookup<TKey, TElement>`](https://msdn.microsoft.com/en-us/library/bb460184(v=vs.100).aspx)的数据结构：

> 如果在集合中找不到键，则返回一个空序列。

这意味着在上述 LINQ 查询之后，您可以执行以下操作：

```
var evens = oddsAndEvens[true];
var odds = oddsAndEvens[false]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-03T10:44:44.920

您可以使用 linq 在您的视图中分离奇数和偶数。

```
//even 
@foreach (var item in Model.Where((item, index) => index % 2 == 0))
{
     //do the code
}

//odd
@foreach (var item in Model.Where((item, index) => index % 2 != 0))
{
     //do the code
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-11T17:07:30.187

```
var text = "this is a test <string> to extract odd <index> values after split";
var parts = text.Split(new char[] { '<', '>' });
IEnumerable words = parts.Where(x => parts.ToList().IndexOf(x) % 2 == 1) 
```

*单词*将包含“字符串”和“索引”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-18T02:29:21.983

您可以在没有 foreach 循环的情况下找到偶数奇数

```
static void Main(string[] args)
{
    List<int> lstnum = new List<int> { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };

    List<int> lstresult = lstnum.FindAll(x => (x % 2) == 0);

    lstresult.ForEach(x => Console.WriteLine(x));
} 
```

# oop - 同时拥有抽象类和接口有什么好处吗？

> ID：267045
> 
> 赞同：11
> 
> 时间：2008-11-05T22:52:40.310
> 
> 标签：oop, interface, abstract-class, ooad

我从一个名为 ILogin 的通用接口开始。这些接口要求您实现两个属性：UserID 和 Password。我有许多实现此接口的登录类型类。随着我的项目越来越大，我发现许多类都重复了 UserID 和 Password 代码。现在我决定我需要一个基本的登录类。

创建一个实现 ILogin 接口的抽象基本登录类并让我的所有具体类只从抽象类继承并在必要时覆盖是否合适？本来我以为这样不会有问题的。然后我开始认为 ILogin 可能是不需要的，因为它可能只会由我的抽象类实现。

保留抽象类和接口是否有好处？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-05T23:20:42.063

确实。让我们考虑一个具体的例子。

假设我们有一个抽象类`Animal`。比如说，我们创建了一些子类`Cat`、`Dog`、`Mosquito`和`Eagle`。我们可以实现它`Eat()`的抽象类的`Breathe()`方法。`Sleep()``Animal`

到现在为止还挺好。现在，假设我们想要拥有and类的`Fly()`方法。由于这两种生物的关系并不密切（一种是鸟，另一种是昆虫），因此很难为我们可以作为抽象类拥有的两种生物找到共同的祖先。这最好由一个接口来实现。`Mosquito``Eagle``IFly`

该`IFly`接口可以具有`Fly()`要实现的方法。`Mosquito`和`Eagle`类都可以是抽象类的子类并`Animal`实现接口，并且`IFly`能够在两个类之间不存在某种奇怪的祖先关系。`Eat()``Breathe()``Sleep()``Fly()`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T22:58:46.057

我通常在抽象类有意义时对抽象类进行编码，并在每个类（抽象或非抽象）中实现（并在外部合同程序集/库中创建）一个接口，因此我可以在必要时更轻松地实现 Windows Communication Foundation 或[控制反转](http://martinfowler.com/articles/injection.html)（这几乎总是用于嘲笑）。这已经成为我的第二天性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T22:59:04.447

绝对地。接口始终是正确的方法——这样任何东西都可以实现它（包括已经有父对象的东西）。

抽象类倾向于做到这一点，因此您不必重新实现该功能的某些部分。Swing 使用了一点，它们将有一个接口，然后是一个默认实现，供您仅覆盖 5 种方法中的一种，或者它可能会为您添加侦听器，但您不必使用该基类，如果您不想。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T23:10:10.713

如果您的抽象类是*唯一*实现接口的类，那么您总是可以只检查抽象类的实例，您不需要接口。但是，如果您希望将来与尚未编写的新类兼容，这些新类不会扩展抽象类但可以使用接口，那么现在继续使用接口。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T22:55:53.127

如果抽象类具有功能，那么保留它是明智的。但是如果它只包含抽象方法而没有字段。我认为保留两者没有用。

**编辑：**我处理带有大量抽象类的遗留代码。如果我有时间，我会添加接口，（并可能删除空的摘要）。因为使用接口极大地增加了可能性。他们通过精确定义接口来尊重他们的名字。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T23:11:10.413

我同意cfeduke。我总是从接口开始，过去使用实现接口并提供基本功能的抽象类来促进从抽象类继承的类之间的代码重用。Mocking 和 IOC 通常是依赖于接口的，仅出于这个原因，我会在我的设计中使用接口。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T00:38:25.603

您的接口定义了要被接受的对象必须履行的合同；您的抽象类定义了必须履行的合同并定义了一些具体的实现细节。

这样想；如果您认为任何人都可能希望以不同于抽象类草拟的方式（例如，使用不同的支持数据类型实现）来履行该合同，那么您应该同时拥有接口和抽象类实现这一点。

同时拥有抽象类和接口几乎没有任何开销；这种方法的风险主要涉及后来的编码人员遇到接口，没有意识到有一个实现接口的抽象类，并在不需要的地方从头开始创建整个实现。我想说这可以通过在你的接口文档中指定你的抽象类中有一个接口的“默认”实现来解决；虽然一些编码标准可能不赞成这种做法，但我认为它没有任何真正的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T23:15:03.450

我总是建议你使用接口。抽象类的优点是您可以添加默认功能，但要求用户使用它们的单一继承是非常激进的。

在许多情况下，Microsoft 类库偏爱抽象类而不是接口，因为它使它们能够修改底层类。向抽象类添加方法很少会破坏从它继承的人。向接口添加方法总是会破坏其实现者。但是，这提供了使用接口的最佳理由之一：Microsoft 可能已经用完您的一个继承。

但是，我建议在您的特定情况下，您可能希望重新审视您正在使用的设计模式。有很多“登录类型”类似乎是不寻常的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-05T23:16:08.203

我认为保留接口的好处是未来类能够实现多个接口，而一个类只能从一个抽象类继承。

您可以通过使用一组不同的方法创建一个新接口来扩展子类的功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T00:55:10.143

假设您特别询问接口和抽象类何时具有相同的签名......

... (If the members of the Interface are different in any way from the members of the abstract class then of course the answer is yes, there may be a need for both)

... but assuming the members are identical, then the only reason I can think of to need both is if you're coding in a system that does not allow multiple implementation inheritance there are two classes in your system that need to be polymorphically similar, but must inherit from different base classes...

# c# - 创建从 C 到 C# 的混合模式 C++ 桥？

> ID：267057
> 
> 赞同：4
> 
> 时间：2008-11-05T22:58:16.383
> 
> 标签：c#, c++, interop, mixed-mode

我希望有人可以帮助我，我主要是 C# 开发人员，所以我的 C 和 C++ 技能很差。我有一个本机 C dll，它是一个更大的应用程序的插件。我使用 gcc 为 linux 上的 windows 交叉编译了这个 dll。

在本机 dll 中，当我创建 D3DSurface 时，我想在混合模式 C++ dll 中调用一个函数，并将指向表面的指针与 Hwnd/句柄一起传递。然后，混合模式 C++ 应该调用我的 C# 托管代码。

举个例子，在 CI 中想要做以下事情；

```
Hwnd handle;
LPDIRECT3DSURFACE d3dtarg;
SurfaceCreated(handle, d3dtarg); 
```

在 C# 中，我希望从混合模式程序集中调用它

```
public static class D3DInterop
{
    public static void SurfaceCreated(IntPtr handle, IntPtr surface)
    {
        //do work
    }
} 
```

由于我不擅长 C++，我只想知道是否有人可以给我一个示例，说明我需要为混合模式 dll 编写什么代码。我也不想编译带有directx头文件的混合模式dll，那么有没有办法可以将'C' LPDIRECT3DSURFACE 转换为通用指针？在 C# 中我只是使用 IntPtr 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T07:31:49.327

创建一个托管 C++ (C++/CLI) DLL 项目，该项目可从 C 调用，并且还能够引用其他 .Net 程序集（即您的 C# 事物）。然后，您的所有 C++/CLI 桥接器所要做的就是将数据类型从 HWND 转换为 IntPtr 等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T01:01:43.560

你看过[微软 XNA](http://en.wikipedia.org/wiki/Microsoft_XNA)吗？据说它已经管理了 DirectX 的包装器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T14:16:28.840

您可以`void *`在混合模式 DLL 中使用。从指向任何东西的指针（包括指向 的指针`IDirect3DSurface`）到`void *`. 然后，您可以将该指针转换为`IntPtr`.

# .net - .NET 程序集引用编译时错误

> ID：267059
> 
> 赞同：2
> 
> 时间：2008-11-05T22:58:47.663
> 
> 标签：.net, assemblies, reference

我有一个带有类 Z 的程序集 A，它继承自程序集 B 中的类 X。现在在一个完全不同的解决方案中，我有使用类 Z 的程序集 C。

编译器会抱怨，除非程序集 C 引用了程序集 A 和 B。即使程序集 C 无论如何都不直接使用类 Z。

这是预期的吗？

在我看来，如果程序集 B 在运行时丢失，东西就会爆炸，但在编译时它不应该关心。

我在这里想念什么？

我的目标是我可以告诉我的客户依赖程序集 A 中的类 Z，但我可以在另一端完全重新配置我的程序集，并且在升级时对客户端完全没有影响。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T23:07:56.147

是的，这是意料之中的。

想一想——除非它知道基类是什么，否则汇编 C 怎么知道它可以用 Z 做什么？它怎么会知道 X 暴露的任何公共成员？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T23:00:31.277

预期行为；必须引用链上的所有组件

[我不喜欢这个，但似乎就是这样]

# asp.net - Asp.net - 在下拉列表顶部添加空白项

> ID：267064
> 
> 赞同：133
> 
> 时间：2008-11-05T23:00:11.870
> 
> 标签：asp.net, drop-down-menu

为什么下拉菜单没有首先显示我的空白项？这是我所拥有的

```
drpList.Items.Add(New ListItem("", ""))

With drpList
    .DataSource = myController.GetList(userid)
    .DataTextField = "Name"
    .DataValueField = "ID"
    .DataBind()
End With 
```

编辑〜我绑定到一个通用列表，这可能是罪魁祸首吗？

* * *

## 回答 #1

> 赞同：281
> 
> 时间：2008-11-05T23:05:45.557

数据绑定后：

```
drpList.Items.Insert(0, new ListItem(String.Empty, String.Empty));
drpList.SelectedIndex = 0; 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-11-28T02:57:16.520

您可以使用`AppendDataBoundItems=true`轻松添加：

```
<asp:DropDownList ID="drpList" AppendDataBoundItems="true" runat="server">
    <asp:ListItem Text="" Value="" />
</asp:DropDownList> 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-11-05T23:02:59.197

数据绑定发生在您添加空白列表项之后，它会替换已经存在的内容，您需要从控制器将空白项添加到列表的开头，或者在数据绑定之后添加。

编辑：

从 ASP.Net 2.0 开始快速搜索后，有一个“AppendDataBoundItems”true 属性，您可以将其设置为...附加数据绑定项。

详情见

[http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=281](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=281)或

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.appenddatabounditems.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listcontrol.appenddatabounditems.aspx)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-18T17:36:56.030

我认为更好的方法是先插入空白项，然后像你一直在做的那样绑定数据。但是，您需要设置`AppendDataBoundItems`列表控件的属性。

我们使用以下方法将任意数据源绑定到任意列表控件...

```
public static void BindList(ListControl list, IEnumerable datasource, string valueName, string textName)
{
    list.Items.Clear();
    list.Items.Add("", "");
    list.AppendDataBoundItems = true;
    list.DataValueField = valueName;
    list.DataTextField = textName;
    list.DataSource = datasource;
    list.DataBind();
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-10-30T20:14:05.380

就像“Whisk”所说，诀窍在于“AppendDataBoundItems”属性

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        DropDownList1.AppendDataBoundItems = true;
        DropDownList1.Items.Insert(0, new ListItem(String.Empty, String.Empty));
        DropDownList1.SelectedIndex = 0;
    }
} 
```

感谢“扫一扫”

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-05T23:04:49.180

进行数据绑定，然后添加以下内容：

```
Dim liFirst As New ListItem("", "")
drpList.Items.Insert(0, liFirst) 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-05T23:01:37.377

看起来您正在添加一个空白项，然后是数据绑定，这将清空列表；尝试在数据绑定后插入空白项

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-05-08T12:50:26.117

简单的

终于

```
ddlProducer.Items.Insert(0, ""); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-24T08:10:20.233

`ddlCategory.DataSource = ds;`
`ddlCategory.DataTextField = "CatName";`
`ddlCategory.DataValueField = "CatID";`

第一关：

`ddlCategory.Items.Add(new ListItem("--please select--", "-1"));`
`ddlCategory.AppendDataBoundItems = true;`
`ddlCategory.SelectedIndex = -1;`

`ddlCategory.DataBind();`

缓存 2：

`ddlCategory.Items.Insert(0, new ListItem("-- please select --", "0"));`

**（测试正常）**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-02T21:53:28.893

您还可以将空白选择与具有内容的选择结合起来：

```
select '' value, '' name
union
select value, name from mytable 
```

# java - 使用 displaytag JSP 选项卡库对 HTML 表进行排序

> ID：267071
> 
> 赞同：1
> 
> 时间：2008-11-05T23:02:27.297
> 
> 标签：java, html, jsp, jsp-tags, displaytag

我正在使用 JSP [displaytag](http://displaytag.sourceforge.net/11/)标签库来创建 HTML 表格。我希望用户能够单击列标题以对数据进行排序。我的 JSP 代码如下所示：

```
<display:table name="tableData" id="stat" sort="page">
  <display:column property="name" title="Name" sortable="true"/>
  <display:column property="age" title="Age" sortable="true"/>
</display:table> 
```

我认为这会导致数据在客户端（在 JavaScript 中）进行排序，但它实际上所做的是在返回服务器的列标题上创建一个损坏的超链接。

是否可以使用 displaytag 在客户端对数据进行排序？如果是这样，怎么做？

干杯，唐

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T01:07:06.810

据我所知，这是不可能的。JQuery 的表排序器可能适用于它用于示例的小表，但大多数表必须来自实际数据库。这个命中太大了，不能简单地检索所有数据，然后再将这些信息返回给客户端，然后允许对其进行排序。

Displaytag 有一个标签的“requestURI”元素，允许其请求转到您配置的 url-handler。

所以，如果你使用这个：

```
<display:table requestURI="yourUrlMappedController.yourExtension" ...> 
```

这将允许从控制器再次检索数据的权宜之计解决方案。

但最终，您将希望最终制定出一种策略，该策略使用 displaytag 排序参数作为“order by”子句中的选项，并从数据库中分页数据，而不是一次全部提取。这是一件棘手的事情，但前期的努力在性能方面可能是非常有益的。

displaytag 网站有三件事你应该经常检查以供参考，就像旁白一样。[标签参考](http://displaytag.sourceforge.net/11/displaytag/tagreference.html)、[配置指南](http://displaytag.sourceforge.net/11/configuration.html)，当然还有他们的（可下载的）[实时示例。](http://displaytag.homeip.net/displaytag-examples-1.1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T23:05:28.350

看看使用[jquery](http://jquery.com)及其出色的[tablesorter](http://tablesorter.com) API。这将允许您使用 Javascript 在客户端对表进行排序。

# c# - 在 C# 中可以使用正则表达式测试哪些对象

> ID：267076
> 
> 赞同：0
> 
> 时间：2008-11-05T23:03:08.777
> 
> 标签：c#, regex

有人可以告诉我可以在 C# 中使用正则表达式测试哪些对象类型吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T23:05:54.887

如果我理解正确并且您询问可以针对正则表达式测试哪些对象类型，那么答案是：字符串并且只有字符串。

因此，您的测试将是：

```
if(obj is string){...} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T23:10:12.443

正则表达式仅适用于字符串。将正则表达式应用于（例如）SqlConnection 意味着什么？

如果您需要某种其他类型的模式匹配（例如，能够匹配特定属性的值），您应该考虑并详细解释这些要求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T23:12:19.430

我想您总是可以对 Object.ToString() 使用正则表达式，如果您覆盖 ToString() 以提供有关您想要匹配的对象的信息，这可能会很有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T23:12:47.680

```
Regex.IsMatch() 
```

# hibernate - 将 SQL 转换为 HQL

> ID：267085
> 
> 赞同：3
> 
> 时间：2008-11-05T23:06:13.513
> 
> 标签：hibernate, hql

我正在尝试将以下 SQL 查询转换为 HQL，但遇到了一些问题。逐行转换不起作用，我想知道是否应该在 HQL 中使用内部联接？

```
 SELECT (UNIX_TIMESTAMP(cosc1.change_date) - UNIX_TIMESTAMP(cosc2.change_date)) 
        FROM customer_order_state_change cosc1  
        LEFT JOIN customer_order_state cos1_new on cosc1.new_state_id = cos1_new.customer_order_state_id  
        LEFT JOIN customer_order_state cos1_old on cosc1.old_state_id = cos1_old.customer_order_state_id  
        LEFT JOIN customer_order_state_change cosc2 on cosc2.customer_order_id = cosc1.customer_order_id  
        LEFT JOIN customer_order_state cos2_new on cosc2.new_state_id = cos2_new.customer_order_state_id  
        LEFT JOIN customer_order_state cos2_old on cosc2.old_state_id = cos2_old.customer_order_state_id 
        WHERE cos1_new.name = "state1" AND  cos2_new.name = "state2" and cosc2.change_date < "2008-11-06 09:00" 
AND cosc2.change_date > "2008-11-06 06:00" GROUP BY cosc1.change_date, cosc2.change_date ; 
```

查询返回客户订单状态更改之间的时间（以秒为单位）。

状态名称和日期会动态插入到查询中。

编辑：刚试过这个

```
"SELECT (UNIX_TIMESTAMP(cosc1.changeDate) - UNIX_TIMESTAMP(cosc2.changeDate))" + 
        " FROM" + 
        " " + CustomerOrderStateChange.class.getName() + " as cosc1" +
        " INNER JOIN " + CustomerOrderStateChange.class.getName() +  " as cosc2" +
        " WHERE cosc1.newState.name = ?" +
        " AND cosc1.order.id = cosc2.order.id" + 
        " AND cosc2.newState.name = ?" +
        " AND cosc2.changeDate < ?" +
        " AND cosc2.changeDate > ?" + 
        " GROUP BY cosc1.changeDate, cosc2.changeDate"; 
```

并收到异常“*外部或完全连接必须后跟路径表达式*”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T23:40:27.173

通常，您的 HQL 连接是使用对象上的属性指定的，例如，如果类 Foo 和 Bar 和 Foo.bar 是 Bar 类型，那么`from Foo f inner join f.bar as b`就是连接。据我所知，没有办法在 HQL 中执行自联接（我在这里可能是错的）。

也就是说，Hibernate 允许您使用`session.createSQLQuery(...)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T02:43:52.590

最终更改为使用本机 SQL 和 PreparedStatement，因为 Hibernate 的 session.createSQLQuery() 似乎只适用于托管实体。

# c# - 查看具有*很多*列的表的最佳方式？

> ID：267091
> 
> 赞同：14
> 
> 时间：2008-11-05T23:08:26.207
> 
> 标签：c#, database, reporting

冒着被降级的风险，我想问一下使用 C# 从具有*很多*列的表中查看数据的最佳机制（对于此处固有的实践违规而言，最好显然是主观的）。很多，我的意思是1000左右。

现在，在您获得所有点击满意或抛出诸如“您为什么会有这么多列的表格”之类的响应之前，让我说这实际上是设计要求的一部分。我们正在尽可能快地从 1000 个数据点收集数据。我们需要尽可能快地存储这些，因此是平面表。数据需要可以从 SQL Server 直接访问，因此需要数据库（我们使用 SQL Compact 和 table-direct）。

所以现在让我们忘记我们所学到的关于正确的数据库设计、规范化规则等的所有知识，只关注我有一个包含 1000 列的表并且我希望能够在屏幕以验证数据是否确实进入了那里。

我试过数据网格。它呕吐是因为（不足为奇）它不是为处理那么多列而设计的。

我试过在 Studio 中使用查看器。它在 256 之后呕吐，而且最终用户无论如何都不会安装 Studio。

目前，结果不需要漂亮，不需要可更新，也不需要对数据更改敏感 - 只是给定时间点表中数据的静态快照。

相关（或半相关）信息：

*   表有 1000 列（在点击满意之前阅读上文）
*   使用 SQL Compact 3.5 版
*   在桌面上运行
*   寻找托管代码的答案

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-06T05:24:42.563

如果你要实现自己的自定义用户控件，你可以像这样做一个鱼眼网格：

> [死图链接](http://img145.imageshack.us/img145/6793/nothingbettertodocd5.jpg)

这个例子展示了一个全尺寸的 3x4 面板在 9x10 的桌子内移动。因为（我假设）您不需要编辑这些数据，所以 UI 可能只是用户抓住面板并拖动它的地方。如果你真的很受虐和/或有很多空闲时间，你甚至可以在同一个网格上有多个鱼眼面板，让你可以同时比较网格的一个或多个区域。

更新： Silverlight显然[有其中之一。](http://objectpeddler.com/feg/FlickrFEGTestTestPage.aspx)有点。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-06T02:21:19.627

您可以将所有数字格式化为带有空格的 n 个字符串，然后以固定宽度的字体显示它们。

```
1       2       3       4       6      36     436    6346
2       3       4       6      36     436    6346       0
3       4       6      36     436    6346       3       4
4       6      36     436    6346     333     222     334 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-06T22:28:11.030

好的，对我来说正确的答案是使用[ReportViewer 控件](http://msdn.microsoft.com/en-us/library/ms251671(VS.80).aspx)，但没有以任何方式记录在 MSDN 中。问题是我有动态数据，所以我需要一个动态报告，并且所有的教程等似乎都假设您在设计时可以了解所有内容，因此您可以通过向导指向并单击自己的方式。

该解决方案最终需要几件。首先，我必须创建代码来动态生成 ReportViewer 用来描述报表布局以及哪些数据字段映射到什么的 RDLC。这就是我想出的：

```
public static Stream BuildRDLCStream(
    DataSet data, string name, string reportXslPath)
{
  using (MemoryStream schemaStream = new MemoryStream())
  {
    // save the schema to a stream
    data.WriteXmlSchema(schemaStream);
    schemaStream.Seek(0, SeekOrigin.Begin);

    // load it into a Document and set the Name variable
    XmlDocument xmlDomSchema = new XmlDocument();
    xmlDomSchema.Load(schemaStream);        
    xmlDomSchema.DocumentElement.SetAttribute("Name", data.DataSetName);

    // load the report's XSL file (that's the magic)
    XslCompiledTransform xform = new XslCompiledTransform();
    xform.Load(reportXslPath);

    // do the transform
    MemoryStream rdlcStream = new MemoryStream();
    XmlWriter writer = XmlWriter.Create(rdlcStream);
    xform.Transform(xmlDomSchema, writer);
    writer.Close();
    rdlcStream.Seek(0, SeekOrigin.Begin);

    // send back the RDLC
    return rdlcStream;
  }
} 
```

第二部分是我直接从[Dan Shipe 的博客](http://csharpshooter.blogspot.com/2007/08/revised-dynamic-rdlc-generation.html)中获取的 XSL 文件。那里的 RDLC 代码毫无价值，因为它都是为 Web 使用而设计的，但 XSL 是纯金的。为了完整起见，我把它放在这篇文章的底部，以防博客离线。

一旦我有了这两个部分，只需创建一个带有 ReportViewer 控件的表单，然后使用这段代码进行设置：

```
ds.DataSetName = name;

Stream rdlc = RdlcEngine.BuildRDLCStream(
    ds, name, "c:\\temp\\rdlc\\report.xsl");

reportView.LocalReport.LoadReportDefinition(rdlc);
reportView.LocalReport.DataSources.Clear();
reportView.LocalReport.DataSources.Add(
    new ReportDataSource(ds.DataSetName, ds.Tables[0]));
reportView.RefreshReport(); 
```

这里的关键是“ds”是一个 DataSet 对象，其中有一个 DataTable，其中包含要显示的数据。

同样，为了完整起见，这里是 XSL - 对大小感到抱歉：

```
 <?xml version="1.0"?>
    <!-- Stylesheet for creating ReportViewer RDLC documents -->
    <xsl:stylesheet version="1.0"
      xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
      xmlns:msxsl="urn:schemas-microsoft-com:xslt"
      xmlns:xs="http://www.w3.org/2001/XMLSchema"
      xmlns:msdata="urn:schemas-microsoft-com:xml-msdata"
      xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner"  xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition"
      >

     <xsl:variable name="mvarName" select="/xs:schema/@Name"/>
     <xsl:variable name="mvarFontSize">8pt</xsl:variable>
     <xsl:variable name="mvarFontWeight">500</xsl:variable>
     <xsl:variable name="mvarFontWeightBold">700</xsl:variable>

     <xsl:template match="/">
      <xsl:apply-templates select="/xs:schema/xs:element/xs:complexType/xs:choice/xs:element/xs:complexType/xs:sequence">
      </xsl:apply-templates>
     </xsl:template>

     <xsl:template match="xs:sequence">
      <Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
       <BottomMargin>1in</BottomMargin>
       <RightMargin>1in</RightMargin>
       <LeftMargin>1in</LeftMargin>
       <TopMargin>1in</TopMargin>
       <InteractiveHeight>11in</InteractiveHeight>
       <InteractiveWidth>8.5in</InteractiveWidth>
       <Width>6.5in</Width>
       <Language>en-US</Language>
       <rd:DrawGrid>true</rd:DrawGrid>
       <rd:SnapToGrid>true</rd:SnapToGrid>
       <rd:ReportID>7358b654-3ca3-44a0-8677-efe0a55c7c45</rd:ReportID>

       <xsl:call-template name="BuildDataSource">
       </xsl:call-template>

       <xsl:call-template name="BuildDataSet">
       </xsl:call-template>

       <Body>
        <Height>0.50in</Height>
        <ReportItems>
         <Table Name="table1">
          <DataSetName><xsl:value-of select="$mvarName" /></DataSetName>
          <Top>0.5in</Top>
          <Height>0.50in</Height>
          <Header>
           <TableRows>
            <TableRow>
             <Height>0.25in</Height>
             <TableCells>

              <xsl:apply-templates select="xs:element" mode="HeaderTableCell">
              </xsl:apply-templates>

             </TableCells>
            </TableRow>
           </TableRows>
          </Header>
          <Details>
           <TableRows>
            <TableRow>
             <Height>0.25in</Height>
             <TableCells>

              <xsl:apply-templates select="xs:element" mode="DetailTableCell">
              </xsl:apply-templates>

             </TableCells>
            </TableRow>
           </TableRows>
          </Details>
          <TableColumns>

           <xsl:apply-templates select="xs:element" mode="TableColumn">
           </xsl:apply-templates>

          </TableColumns>
         </Table>
        </ReportItems>
       </Body>
      </Report>
     </xsl:template>

     <xsl:template name="BuildDataSource">
      <DataSources>
       <DataSource Name="DummyDataSource">
        <ConnectionProperties>
         <ConnectString/>
         <DataProvider>SQL</DataProvider>
        </ConnectionProperties>
        <rd:DataSourceID>84635ff8-d177-4a25-9aa5-5a921652c79c</rd:DataSourceID>
       </DataSource>
      </DataSources>
     </xsl:template>

     <xsl:template name="BuildDataSet">
      <DataSets>
       <DataSet Name="{$mvarName}">
        <Query>
         <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
         <CommandText/>
         <DataSourceName>DummyDataSource</DataSourceName>
        </Query>
        <Fields>

         <xsl:apply-templates select="xs:element" mode="Field">
         </xsl:apply-templates>

        </Fields>
       </DataSet>
      </DataSets>
     </xsl:template>

     <xsl:template match="xs:element" mode="Field">
      <xsl:variable name="varFieldName"> 
       <xsl:value-of select="@name" />
      </xsl:variable>

      <xsl:variable name="varDataType">
       <xsl:choose>
        <xsl:when test="@type='xs:int'">System.Int32</xsl:when>
        <xsl:when test="@type='xs:string'">System.String</xsl:when>
        <xsl:when test="@type='xs:dateTime'">System.DateTime</xsl:when>
        <xsl:when test="@type='xs:boolean'">System.Boolean</xsl:when>
       </xsl:choose>
      </xsl:variable>

      <Field Name="{$varFieldName}">
       <rd:TypeName><xsl:value-of select="$varDataType"/></rd:TypeName>
       <DataField><xsl:value-of select="$varFieldName"/></DataField>
      </Field>
     </xsl:template>

     <xsl:template match="xs:element" mode="HeaderTableCell">
      <xsl:variable name="varFieldName"> 
       <xsl:value-of select="@name" />
      </xsl:variable>

      <TableCell>
       <ReportItems>
        <Textbox Name="textbox{position()}">
         <rd:DefaultName>textbox<xsl:value-of select="position()"/>
         </rd:DefaultName>
         <Value><xsl:value-of select="$varFieldName"/></Value>
         <CanGrow>true</CanGrow>
         <ZIndex>7</ZIndex>
         <Style>
          <TextAlign>Center</TextAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingBottom>2pt</PaddingBottom>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <FontSize><xsl:value-of select="$mvarFontSize"/></FontSize> 
          <FontWeight><xsl:value-of select="$mvarFontWeightBold"/></FontWeight> 
          <BackgroundColor>#000000</BackgroundColor> 
          <Color>#ffffff</Color>
          <BorderColor>
           <Default>#ffffff</Default>
          </BorderColor>
          <BorderStyle>
           <Default>Solid</Default>
          </BorderStyle>
         </Style>
        </Textbox>
       </ReportItems>
      </TableCell>
     </xsl:template>

     <xsl:template match="xs:element" mode="DetailTableCell">
      <xsl:variable name="varFieldName"> 
       <xsl:value-of select="@name" />
      </xsl:variable>

      <TableCell>
       <ReportItems>
        <Textbox Name="{$varFieldName}">
         <rd:DefaultName><xsl:value-of select="$varFieldName"/></rd:DefaultName>
         <Value>=Fields!<xsl:value-of select="$varFieldName"/>.Value</Value>
         <CanGrow>true</CanGrow>
         <ZIndex>7</ZIndex>
         <Style>
          <TextAlign>Left</TextAlign>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingBottom>2pt</PaddingBottom>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <FontSize><xsl:value-of select="$mvarFontSize"/></FontSize> 
          <FontWeight><xsl:value-of select="$mvarFontWeight"/></FontWeight> 
          <BackgroundColor>#e0e0e0</BackgroundColor> 
          <Color>#000000</Color> 
          <BorderColor>
           <Default>#ffffff</Default> 
          </BorderColor>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
         </Style>
        </Textbox>
       </ReportItems>
      </TableCell>
     </xsl:template>

     <xsl:template match="xs:element" mode="TableColumn">
      <TableColumn>
       <Width>0.75in</Width>
      </TableColumn>
     </xsl:template>

     <xsl:template name="replace-string">
      <xsl:param name="text"/>
      <xsl:param name="from"/>
      <xsl:param name="to"/>
      <xsl:choose>
       <xsl:when test="contains($text, $from)">
        <xsl:variable name="before" select="substring-before($text, $from)"/>
        <xsl:variable name="after" select="substring-after($text, $from)"/>
        <xsl:variable name="prefix" select="concat($before, $to)"/>
        <xsl:value-of select="$before"/>
        <xsl:value-of select="$to"/>
        <xsl:call-template name="replace-string">
         <xsl:with-param name="text" select="$after"/>
         <xsl:with-param name="from" select="$from"/>
         <xsl:with-param name="to" select="$to"/>
        </xsl:call-template>
       </xsl:when>
       <xsl:otherwise>
        <xsl:value-of select="$text"/>
       </xsl:otherwise>
      </xsl:choose>
     </xsl:template>
    </xsl:stylesheet> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-05T23:35:05.420

将数据存储在 csv 文件中怎么样，这将为您提供查看选项。如果您的用户有 excel 或 Open Office Calc，他们可以轻松导入数据（不确定 Calc 是否有列限制，但 excel 2007 可以容纳 16384 列）并通过该程序查看？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-05T23:24:43.337

你需要在一个表上查看多行吗？

我的*猜测*是这个数据是数字的，有什么办法可以将单行数据显示为 20*50 网格或类似的东西，然后只对行进行分页？

例如，第 1 行，第 1 列 = 数据库的第 1 列，第 2 行，第 1 列 = 数据库的第 21 列，等等

```
Id = 1
     1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20
----|--------------------------------------------------------
  0 |  
 20 |  
 40 |
 60 |
 80 |
100 |
120 |
etc | 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-05T23:14:57.007

尝试使用[非常小的字体的 html 表格]

如果您担心格式化表格，请使用 CSS：

```
td { font-size: 0.2em; text-align: right; } 
```

或者，如果您的所有数字大小相同，您也可以只生成“数字墙”显示，例如使用固定宽度的字体并在滚动面板中显示 5 个字符宽的列

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-05T23:36:38.787

这在一定程度上取决于它需要有多漂亮。如果这只是一个调试/抽查工具，您可以并排放置多个 DataGrid，每个 DataGrid 都显示一组列。会有点丑陋，但会是可行的。

OTOH，如果您需要一个半抛光的工具，您可能想提出一个自定义控件来处理它。基本上，您将加载正在查看的数据库部分，并带有一点缓冲区，当用户滚动当前加载的数据时，运行一个新查询。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-05T23:55:52.320

DataGrid（甚至是 ListView）应该能够处理具有 32 列和 32 行的表，这将允许您一次显示整个 DB 行的数据。这将允许您立即查看某些单元格是否缺少数据。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-05T23:16:57.517

即使提出这个建议我也觉得很脏，但你可以做一些类似的事情：

```
SELECT Field1 + ' - ' + Field2 + ... AS EvilMegaColumn FROM Table 
```

但我真的认为这属于“如果你遇到这个限制，你做错了什么”的范畴。我真的看不出有任何理由、速度或其他需要 1000 列...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-05T23:24:31.387

谁会读一个 1000 列的表？？？尝试想办法过滤或可视化数据。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-05T23:24:46.783

也许您应该研究一种不同类型的数据库。我听说面向列的数据库非常适合这种事情（而典型的 RDBMS 是面向行的）。此外，如果您在第一次插入行后不返回更新行，那么二进制平面文件可能比巨型表更好？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-05T23:29:10.363

我会把它作为一个向下钻取。在第一页（或页面顶部）中，您将拥有选择行的控件。在下一页（或页面底部）中，您将显示所选行中的数据。例如，根据所需的单元格宽度，您可以将其设置为 100 行 10 列或 1000 行 1 列。

作为动态客户端 javascript，这很容易做到——您甚至可以通过这种方式使其可编辑。我不确定这将如何在 C# 中工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-05T23:35:40.333

如果您只是在验证之后，您是否可以不以编程方式检查每个字段并报告整行都可以！然后，您需要一个非常简单的数据网格，其中列出了不太好的行。

然后可以通过可以应用于单行的任何技术来检查它们，因为在大多数情况下您不需要浏览这些字段。我在这里假设您已经可以以某种方式查看整行，并且正在寻找一种同时浏览多行以查找丢失数据的方法（自动化这将使其更加可靠）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-05T23:36:30.800

从一个倾斜的角度来看，我会问用户是否需要一次“加载”所有列？

如果用户愿意一次显示列的子集（例如，一次显示 100 个，或者一次显示特定的集合），那么我会使用某种数据网格（内置的一个或一个ListView，或者第三方）来显示子集，CheckedListView 停靠在一边，允许显示感兴趣的子集。

或者，您能否显示某种汇总数据，显示 100 列组的计数/平均值/xxx？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-06T05:43:00.513

我建议调查平面布局以外的其他内容。根据我的经验，数据库对列数和行字节大小有限制。

*   您的 SQL 可能允许定义 1000 列。
*   SQL 行不能超过行字节限制。

每个数据库实现都有一个页面大小（4k / 8k），并且单行必须适合这个数据大小。NULL 通常是免费的。这意味着 1000 个整数 1000 x 4 字节将*恰好*适合 4k 页面大小。

如果您正在使用 varchars 谈论数据，那么问题会更糟。每列有多少个字符？可以填写多少列？如果您平均有 10 个字符，并且您的页面大小为 8k，那么您会因 SQL 错误而丢失数据。

如果你必须笑的话，但这种情况确实发生在一个特别长的打字员在一个平面数据表中，我知道这是在突破极限。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-13T00:36:24.897

> .. 以验证数据是否确实进入了那里。

可能它已经过时了，但是您可以使用像素图，其中单个像素代表表格的单个单元格（屏幕大于 1000）或 10 个单元格代表一个像素，单击时缩放区域。

像素的颜色将取决于数据。对于空/数据，它可能是黑色/白色。或者它可以是颜色来显示价值随着每一行的增加或减少。或红色表示数据突然跳跃。您可以在数据网格中正常捕捉到的所有异常。

然后，您只需要捕捉感兴趣区域中的点击坐标，并使用小表格来显示表格的该部分，而无需任何滚动。

只需单击即可返回像素图。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-06-23T07:26:28.800

鉴于用户无论如何都必须水平滚动，您可以使用显示合理数量的列（例如，50）的常规数据网格。然后，您有一个位于网格下方的水平滚动条，用于选择要显示的列子集。当滚动条在左侧时，您会显示第 1-50 列，当您单击向右箭头时，您会转到 2-51 等。

这为您提供了滚动功能，而不必用数据重载网格控件。虽然您将失去在表格中自由光标或进行大型矩形选择的能力，但这听起来对这个应用程序来说不是一个问题。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2008-11-05T23:23:43.400

有多少数据对初始视图至关重要？我可以看到做一些类似于主/详细类型网格的操作，您将关键列（比如 10）放到数据网格上，当用户单击查看详细信息时，您可以获取剩余的列并将它们显示在“属性区”或这方面的东西。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2008-11-05T23:39:31.167

如果您只需要确保正在填充数据，那么为什么不让每一列都具有默认值，例如“void”、“blank”等。

然后，您可以在计算非默认值/总数时进行迭代以显示百分比。

现在您可以使用百分比值可视化数据完整性，甚至可以记录哪些列具有默认值（如列表/数组）以供进一步调查。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-11-05T23:59:53.530

您可能会考虑与您的用户群核对并查看他们真正需要查看的内容，然后为每个不同的需求设置视图，以使列倒计时。

另一种选择是读取数据，并从中创建一个巨大的静态 html 页面集。然后你可以从你的程序中调用浏览器来查看它。

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2008-11-06T02:30:24.100

有一个可滚动的窗格并一次显示 10 列（可以主动加载或缓存这些列或您需要的任何内容）。向左滚动时，显示前十个。向右滚动时，显示后面的列序列。所以总而言之，在任何给定点只有 10 列处于活动状态。在我看来，以任何其他方式尝试实际显示 1000 列都是疯狂的。PS：这无非是一个理想的猜测；我不确定这是否远程可行。

# model-view-controller - 使用 MVC 的多个表模型？

> ID：267094
> 
> 赞同：3
> 
> 时间：2008-11-05T23:09:30.043
> 
> 标签：model-view-controller, architecture, model

我刚刚开始使用 MVC，一旦我设法将我的想法转变为它，它似乎将是一个很好的方法。

我遇到的大多数材料似乎在模型、视图和表之间具有 1-1 的关系——即每个模型代表一个表并允许 CRUD，以及更复杂的功能。

如果我有一个允许创建和更新帐户的帐户模型怎么办？

我想使用 /signup 视图和控制器来创建（）帐户，但想使用 /members/account 视图和控制器来更新、更改密码等。

拥有一个注册模型会更好，还是我可以从多个位置使用我需要的任何模型？

另外，假设一个帐户可以有很多用户，但我想在注册时创建第一个用户。我想将帐户设置和用户创建作为事务运行。我应该有一个帐户模型和用户模型，并同时使用两者，还是只让帐户的注册创建（）函数创建默认用户？

我正在将 PHP 与 CodeIgniter 一起使用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T00:13:34.453

一般来说，您最有可能将您的表格视为模型下方的附加“层”；MVC 概念一般不会过多处理支持问题的实现；即您是否使用数据库表或平面文件存储或内存数据表示。

我的建议是将问题视为具有在表和应用程序之间进行交互的一层的问题之一；您的“数据对象”层。将其视为纯序列化。如果您使用的是对象模型，这将是您的 ORM 层。

然后你想要另一个定义“业务逻辑”的层；即您的数据与您的数据的交互。这与帐户如何与用户交互等有关。这里的封装基本上处理了您的高级交互。通过这种方式，您可以定义对您的业务需求最有意义的抽象，而无需依赖于实现；例如，您可以定义一个“UserAccount”模型，它将完成处理用户帐户所需的所有事情；定义您希望该抽象执行的所有操作。然后，一旦你把那个抽象下来，那就是你的模型；然后，您可以在该模型的内部工作中定义交互如何与您的持久性代码发生。

通过这种方式，您可以从实际的模型**接口**中抽象出模型的**持久性**和**实现**。因此，您可以将模型定义为执行您希望它执行的操作，而无需关心底层实现。这样做的好处是显着的；思考你想让你的模型做什么的过程，独立于它将做它的方式，可能是非常有指导意义的；同样，如果您的支持数据层发生更改，您的模型也不需要更改；例如，您可以使用平面文件进行原型设计。

 **# git - git-svn：有没有办法让它与子模块一起玩，或者忽略它们？

> ID：267101
> 
> 赞同：5
> 
> 时间：2008-11-05T23:11:16.967
> 
> 标签：git, version-control, git-svn

一旦你有一个包含子模块对象的提交，你几乎不能让 git-svn 提交过去。

任何想法，解决方法，任何不是“不要将子模块与 git-svn 一起使用”的东西？

到目前为止，答案似乎是一个很大的否定。

有没有办法至少允许包含子模块数据的现有 git 提交在没有子模块数据的情况下提交到 svn？即使这意味着重写树。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T03:31:46.517

您需要用`svn:externals`属性替换子模块才能很好地使用 Subversion。

```
svn propset svn:externals [...] 
```

我认为没有其他方法可以解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-12T22:58:59.697

如果您可以访问 SVN 服务器，则可以将[SubGit](http://subgit.com)安装到其中。它将创建一个链接的 Git 存储库，这样对 Git 存储库的任何推送都将被转换为 SVN，反之亦然。翻译是并发安全的，因此您可以将这对存储库视为与在 GitHub 上完成的相同存储库的 2 个接口（Git 和 SVN），不同之处在于翻译更加透明（所有分支都转换为分支, tags to tags, svn:ignore to .gitginore, svn:eol-style to .gitattributes value 等等）。

之后，您可以将子模块添加到生成的 Git 存储库中，而忘记 git-svn。

如果您无法访问我不知道解决方案的服务器，仅适用于 Git 的 svn:externals 支持（查看 SmartGit 和 .gitsvnextmodules 配置）。

# c# - 如何通过 WCF 实现继承的字典

> ID：267113
> 
> 赞同：7
> 
> 时间：2008-11-05T23:17:30.213
> 
> 标签：c#, wcf, c#-3.0

我正在尝试实现一个与 WCF 一起使用的字典。我的要求是：

*   等效于 Dictionary 的实际（私有变量或基类）类型
*   比较器 = `System.StringComparer.InvariantCultureIgnoreCase`
*   自定义（覆盖/新）添加（键，值）方法（包括验证）。
*   覆盖 ToString()
*   在客户端和主机上使用相同的类型

我尝试在 WCF 主机和客户端项目共享的公共项目中使用此类：

```
[Serializable]
public class MyDictionary : Dictionary<string, object>
{
  public MyDictionary()
    : base(System.StringComparer.InvariantCultureIgnoreCase)
  { }

  public new void Add(string key, object value)
  { /* blah */ }

  public override string ToString()
  { /* blah */ }
}

[DataContract]
[KnownType(typeof(MyDictionary))]
[KnownType(typeof(object[]))]
[KnownType(typeof(double[]))]
[KnownType(typeof(string[]))]
[KnownType(typeof(DateTime[]))]
public class ResultClass
{
  public object Value{ get; set; }
  /* More properties */
}
public class ParmData
{
  public object Value{ get; set; }
  /* More properties */
}
[DataContract]
[KnownType(typeof(MyDictionary))]
[KnownType(typeof(object[]))]
[KnownType(typeof(double[]))]
[KnownType(typeof(string[]))]
[KnownType(typeof(DateTime[]))]
public class ParameterClass
{
  public List<ParmData> Data{ get; set; }
  /* More properties */
}

[OperationContract]
ResultClass DoSomething(ParameterClass args); 
```

结果：

*   当我将 MyDictionary 作为 ParameterClass.Data.Value 元素之一传递时，我得到一个缺失的 KnownType 异常。
*   我可以在 ResultClass 中安全地返回 MyDictionary，但它不再是我的类型。它只是一个字典，不能转换为`MyDictionary`. 还有 comparer = `System.Collections.Generic.GenericEqualityComparer<string>`，而不是我正在寻找的不区分大小写的比较器。

我要求的帮助是修复我失败的尝试，或者以完全不同的方式来实现我的陈述要求。任何解决方案都不应涉及将一个字典复制到另一个字典。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T12:05:39.523

将 CollectionDataContract 添加到 Dictionary 类：

有关使用收集数据合约实现字典的更多信息，请查看此链接：

[http://msdn.microsoft.com/en-us/library/aa347850.aspx](http://msdn.microsoft.com/en-us/library/aa347850.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T05:04:28.983

序言：请注意，添加“新”`Add`并不能阻止人们`Add`简单地通过铸造来称呼旧的。此外，就“mex”而言，这是一个非常模糊的数据合同——它需要如此开放吗？（很多`object`等等……）

第一：你没有错过一些`[DataContract]`/`[DataMember]`标记吗？尤其：

*   结果类.值
*   参数数据
*   参数数据值
*   参数类数据

您能否*准确*说明您使用的是哪个版本的 .NET？`DataContractSerializer`等已通过服务包进行了调整。安装了 3.5 SP1（我唯一需要做的事情）它至少会通过`DataContractSerializer`（无 WCF 堆栈）进行序列化和反序列化，并`Add`调用正确的方法。

您能否检查以下内容是否适用于您的本地版本？（它适用于 3.5 SP1 并且缺少属性）[首先输出]：

```
1
MyDictionary
abc=123
def=ghi 
```

代码：

```
 // or long-hand in C# 2.0
        ParameterClass pc = new ParameterClass {
            Data = new List<ParmData> { new ParmData {
                Value = new MyDictionary  {
                    {"abc",123},
                    {"def","ghi"}
                }}}};
        DataContractSerializer dcs = new DataContractSerializer(pc.GetType());
        string xml;
        using(StringWriter sw = new StringWriter())
        using(XmlWriter xw = XmlWriter.Create(sw)) {
            dcs.WriteObject(xw, pc);
            xw.Close();
            xml = sw.ToString();
        }
        using(StringReader sr = new StringReader(xml)) {
            ParameterClass clone = (ParameterClass)dcs.ReadObject(XmlReader.Create(sr));
            Console.WriteLine(clone.Data.Count);
            Console.WriteLine(clone.Data[0].Value.GetType().Name);
            MyDictionary d = (MyDictionary)clone.Data[0].Value;
            foreach (KeyValuePair<string, object> pair in d)
            {
                Console.WriteLine("{0}={1}", pair.Key, pair.Value);
            }
        } 
```

显然这只是测试`DataContractSerializer`（没有整个 WCF 堆栈），但它似乎工作......所以：相同的代码是否适用于您的本地版本的 .NET？如果没有，是否可以选择安装最新的 3.0 服务包？（最好通过安装 3.5 SP1）。

有关信息，我得到 xml：

```
<?xml version="1.0" encoding="utf-16"?><ParameterClass xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/"><Data><ParmData><Value xmlns:d4p1="http://schemas.microsoft.com/2003/10/Serialization/Arrays" i:type="d4p1:ArrayOfKeyValueOfstringanyType"><d4p1:KeyValueOfstringanyType><d4p1:Key>abc</d4p1:Key><d4p1:Value xmlns:d6p1="http://www.w3.org/2001/XMLSchema" i:type="d6p1:int">123</d4p1:Value></d4p1:KeyValueOfstringanyType><d4p1:KeyValueOfstringanyType><d4p1:Key>def</d4p1:Key><d4p1:Value xmlns:d6p1="http://www.w3.org/2001/XMLSchema" i:type="d6p1:string">ghi</d4p1:Value></d4p1:KeyValueOfstringanyType></Value></ParmData></Data></ParameterClass> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T22:28:49.000

*   `CollectionDataContract`按照jezell的建议使用属性
*   使用 /collectionType 参数通过 SvcUtil 手动生成参考（代理）代码。vs2008 服务参考 GUI 不支持此参数。

来源：[WCF 集合类型分享](http://www.codeproject.com/KB/WCF/WCFCollectionTypeSharing.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-18T20:04:11.267

我终于找到了一种方法来做到这一点。我发现[这个链接](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/09eefbbc-bf63-4aa3-a0cb-01a9dbd7f496)指向了正确的方向，但我会尝试总结一下。

1.  确保您添加`[CollectionDataContract]`到您的自定义集合
2.  像往常一样通过 VS 添加服务引用
3.  展开服务引用并查找 Reference.svcmap 文件
4.  在客户端选项节点下，您将看到

> <CollectionMappings/>

Replace it with the following xml.

> <CollectionMappings>
>   <CollectionMapping TypeName="Full.Namespace.Here" Category="List" />
> </CollectionMappings>

5.  Right click on the Service Reference and click update. It should no longer generate that "proxy" class and will let you use your shared class.

# c - （字符串）文字的范围

> ID：267114
> 
> 赞同：32
> 
> 时间：2008-11-05T23:17:48.747
> 
> 标签：c, string, literals

我总是尽量避免返回字符串文字，因为我担心它们不是在函数之外定义的。但我不确定是否是这种情况。让我们以这个函数为例：

```
 const char *
return_a_string(void)
{
    return "blah";
} 
```

这是正确的代码吗？它对我有用，但也许它只适用于我的编译器（gcc）。所以问题是，（字符串）文字是否有范围，或者它们是否一直存在/定义。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-05T23:25:33.740

此代码适用于所有平台。该字符串作为静态字符串文字编译到二进制文件中。例如，如果您在 Windows 上，您甚至可以使用记事本打开 .exe 并搜索字符串本身。

由于它是一个静态字符串字面量，所以没关系。

**字符串池：**

需要注意的一件事是，在某些情况下，可以“汇集”相同的字符串文字以节省可执行文件中的空间。在这种情况下，每个相同的字符串文字可能具有相同的内存地址。你永远不应该假设它会或不会是这种情况。

在大多数编译器中，您可以设置是否将静态字符串池用于搅拌文字。

**字符串文字的最大大小：**

几个编译器对字符串文字有最大大小。例如，对于 VC++，这大约是 2,048 字节。

**修改字符串文字会产生未定义的行为：**

永远不应该修改字符串文字。它具有未定义的行为。

```
char * sz = "this is a test";
sz[0] = 'T'; //<--- undefined results 
```

**宽字符串文字：**

以上所有内容同样适用于宽字符串文字。

示例：L"这是一个宽字符串文字";

**C++ 标准规定：（** 部分 lex.string）

> 1 字符串文字是由双引号括起来的字符序列（定义在 *lex.ccon*中），可以选择以字母 L 开头，如 "..." 或 L"..."。不以 L 开头的字符串文字是普通字符串文字，也称为窄字符串文字。一个普通的字符串字面量具有“n const char 数组”类型和静态存储持续时间（*basic.stc*)，其中 n 是如下定义的字符串的大小，并使用给定的字符进行初始化。以 L 开头的字符串文字，例如 L"asdf"，是一个宽字符串文字。宽字符串文字的类型为“array of n const wchar_t”并具有静态存储持续时间，其中 n 是字符串的大小，定义如下，并使用给定的字符进行初始化。
> 
> 2 是否所有字符串文字都是不同的（即存储在不重叠的对象中）是实现定义的。尝试修改字符串文字的效果是未定义的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-09-07T09:21:05.020

我给你一个例子，让你的困惑变得有点清楚

```
char *f()
{
char a[]="SUMIT";
return a;
} 
```

这行不通。

但

```
char *f()
{
char *a="SUMIT";
return a;
} 
```

这行得通。

原因：`"SUMIT"`是一个具有全局范围的文字。而只是一个字符序列的数组`{'S','U','M','I',"T''\0'}` 具有有限的范围，一旦程序返回它就会消失。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-07T14:08:08.560

正如其他人所解释的，这在 C（或 C++）中是有效的。

我认为要注意的一件事是，如果您使用的是 dll，那么如果卸载了包含此代码的 dll，则指针将不会保持有效。

C（或 C++）标准不理解或不考虑在运行时加载和卸载代码，所以任何这样做都会面临实现定义的后果：在这种情况下，结果是字符串文字，它应该有静态存储持续时间，从调用代码的 POV 开始出现，不会在程序的整个持续时间内持续存在。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-05T23:25:39.120

是的，没关系。它们存在于一个全局字符串表中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-05T23:26:47.747

不，字符串文字没有范围，因此保证您的代码可以在所有平台和编译器上工作。它们存储在程序的二进制映像中，因此您可以随时访问它们。但是，尝试写入它们（通过丢弃`const`）将导致未定义的行为。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T23:28:04.640

您实际上返回了一个指向存储在可执行文件数据部分中的以零结尾的字符串的指针，该区域在您加载程序时加载。只是避免尝试更改字符，它可能会产生不可预知的结果......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T00:40:15.540

记下 Brian 提到的未定义结果非常重要。由于您已将函数声明为返回 const char * 类型，您应该没问题，但在许多平台上，字符串文字被放置在可执行文件的只读段（通常是文本段）中，修改它们会导致访问冲突在大多数平台上。

# silverlight - 从两个不同的服务器获取图像

> ID：267119
> 
> 赞同：0
> 
> 时间：2008-11-05T23:20:44.623
> 
> 标签：silverlight, silverlight-2.0

谁能告诉我在 Silverlight 2 中从不同服务器带来两个图像的过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T05:07:22.567

如果您有 url，您可以将其设置为图像控件。

img1.Source=new BitmapImage(new Uri(your_url_for_the_iamge)); //img1 是你的图像控件

如果您想下载它们然后使用，您需要使用 WebClient 类，并且一个 clientaccesspolicy.xml 文件应该存在于您从中下载图像的服务器中，并且该 xml 文件应该授予您访问 Silverlight 应用程序所在位置的权限。

# jquery - 在 jquery 中使用 X 登录关闭 load() 页面的最有效方法

> ID：267120
> 
> 赞同：1
> 
> 时间：2008-11-05T23:21:39.347
> 
> 标签：jquery, popup, load

我是 Jquery 的新手，我正在尝试使用 div 容器来加载 URL，但是，我想为用户提供一个选项，可以在右上角使用 X 符号关闭它，就像在 Amazon.com 中一样。实现这一目标的最佳方法是什么？

这是我所拥有的，并且似乎笨拙地找出右上角的位置并放置图像 X：

```
$("#url_link_details").click(function() {
    $("#details").load("tooltip_address.htm", function() {
        $(this).addClass("openwindow").show();
        $(".img_close").addClass("img_close_show").show();
    })
}); 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T01:05:21.213

一些html：

```
<div id="popup">
    <img src="x.gif" alt="Close" class="img_close" />
    <div class="details"></div>
</div> 
```

一些CSS：

```
#popup .img_close {
    float: right;
}

#details {
    clear: right; /* if you want there to be a "titlebar" area */
} 
```

一些 jQuery

```
$('#url_link_details").click(function() {
    $('#details').load('tooltip_address.htm', function() {
        $('#popup')
            .show()
            .find('.img_close')
            .click(function() {
                $('#popup').hide();
            })
        ;
    })
}) 
```

# c# - IE 中的 UpdatePanel 缓慢

> ID：267124
> 
> 赞同：5
> 
> 时间：2008-11-05T23:22:35.540
> 
> 标签：c#, jquery, asp.net, performance, updatepanel

我正在开发一个 ASP.Net 应用程序，并正在向它添加一些 Ajax 以加快某些领域的速度。我关注的第一个领域是出勤区，供老师报告孩子的出勤率（和其他一些数据）。这需要很快。

我创建了一个双控件设置，用户单击图标并通过 Javascript 和 Jquery 弹出第二个控件。然后我使用 __doPostBack() 刷新弹出控件以加载所有相关数据。

这是一个小视频片段来展示它是如何工作的：[http](http://www.screencast.com/users/cyberjared/folders/Jing/media/32ef7c22-fe82-4b60-a74a-9a37ab625f1f) ://www.screencast.com/users/cyberjared/folders/Jing/media/32ef7c22-fe82-4b60-a74a-9a37ab625f1f （：21并忽略音频背景）。

在 Firefox 和 Chrome 中，每次“弹出”需要 2-3 秒，这比我想要的要慢，但在 IE 中完全不可行，每次弹出和加载都需要 7-8 秒。这忽略了在更改数据后保存数据所需的任何时间。

这是处理弹出窗口的javascript：

```
function showAttendMenu(callingControl, guid) {
var myPnl = $get('" + this.MyPnl.ClientID + @"')
if(myPnl) {
    var displayIDFld = $get('" + this.AttendanceFld.ClientID + @"');
    var myStyle = myPnl.style;
    if(myStyle.display == 'block' && (guid== '' || guid == displayIDFld.value)) {
        myStyle.display = 'none';
    } else {
        // Get a reference to the PageRequestManager.
        var prm = Sys.WebForms.PageRequestManager.getInstance();

        // Unblock the form when a partial postback ends.
        prm.add_endRequest(function() {
            $('#" + this.MyPnl.ClientID + @"').unblock({ fadeOut: 0});
        });

        var domEl = Sys.UI.DomElement;
        //Move it into position
        var loc = domEl.getLocation(callingControl);
        var width = domEl.getBounds(callingControl).width;
        domEl.setLocation(myPnl, loc.x + width, loc.y - 200);

        //Show it and block it until we finish loading the data
        myStyle.display = 'block';
        $('#" + this.MyPnl.ClientID + @"').block({ message: null, overlayCSS: { backgroundColor:'#fff', opacity: '0.7'} }); 

        //Load the data
        if(guid != '') { displayIDFld.value = guid; } 
        __doPostBack('" + UpdatePanel1.ClientID + @"','');
    }
}} 
```

首先，我不明白为什么 __doPostBack() 在 IE 中引入了这样的延迟。如果我把它和 prm.add_endRequest 拿出来，它会非常快，因为没有回发发生。

其次，我需要一种方法来弹出这个控件并刷新数据，以便它仍然是交互式的。我没有与 UpdatePanel 结婚，但我无法弄清楚如何使用 Web 服务/静态页面方法来做到这一点。如您所见，此控件在同一页面上加载了很多次，因此页面大小和下载速度是一个问题。

我会很感激任何想法？

编辑：在 IE 6 或 7 中是一样的。我认为这与 IE 对 UpdatePanel 的处理有关，因为相同的代码在 FF 和 Chrome 中要快得多。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-11T17:48:53.620

如果速度/性能是您主要关心的问题，我强烈建议不要使用 UpdatePanels，因为它们会导致整页回发，将 ViewState 拖到标题中，除其他废话外，并强制页面每次都经历整个生命周期（即使用户没有看到这个）。

您应该能够（相对容易地）使用 PageMethods 来完成您的任务。

```
// In your aspx.cs define the server-side method marked with the 
// WebMethod attribute and it must be public static.
[WebMethod]
public static string HelloWorld(string name)
{
  return "Hello World - by " + name;
}

// Call the method via javascript
PageMethods.HelloWorld("Jimmy", callbackMethod, failMethod); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-01T16:11:41.590

它是仅 IE 的已知问题，请参阅[KB 2000262](http://support.microsoft.com/kb/2000262)。可以在[此处](http://blog.devlpr.net/2009/09/01/updatepanel-async-postsback-slow-in-ie-part-3/)找到解决方法/修复程序。我和他们一起编写了剧本，很遗憾他们无法提出真正的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-11T17:41:11.623

在之前的项目中注意到，当我们在页面上有堆（150+）文本框时，IE 变得非常慢，在与 fiddler 核对后，我们认为渲染引擎很慢。

（顺便说一句，在你们大喊之前，150 多个文本框是客户的明确要求，我们基本上在网络上重新创建了定制的 excel）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T23:37:48.893

要找出为什么需要这么长时间，我建议使用 Fiddler 来监视您的 IE 流量：[http ://www.fiddlertool.com/fiddler/](http://www.fiddlertool.com/fiddler/)

您将查看每条消息的响应，以了解它们有多大。如果消息大于 5kb 左右，那么 UpdatePanel 太小猪了。

这听起来像你试图做的一件相当简单的事情，所以我很难相信更新面板是罪魁祸首。测试它应该不会太难。在没有 UpdatePanel 的情况下进行测试的最简单方法是使用 PageMethod。这个页面上有一个很棒的教程： [http ://weblogs.asp.net/sohailsayed/archive/2008/02/23/calling-methods-in-a-codebehind-function-pagemethods-from-client-side-using -ajax-net.aspx](http://weblogs.asp.net/sohailsayed/archive/2008/02/23/calling-methods-in-a-codebehind-function-pagemethods-from-client-side-using-ajax-net.aspx)

您能否也发布您的 UpdatePanel 代码，以便我们获得更多详细信息？

编辑：谢谢！

你用的是什么版本的IE？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T23:48:17.750

这是弹出控件的代码（页面上只有一个由包含图标的所有控件共享）：

```
<script type="text/javascript" src="<%=Response.ApplyAppPathModifier("~/js/jquery-1.2.6.js") %>"></script>
<script type="text/javascript" src="<%=Response.ApplyAppPathModifier("~/js/jquery.blockUI.js") %>"></script>
<asp:Panel CssClass="PopOutBox noPrint" ID="MyPnl" style="display: none; z-index:1000; width:230px; position: absolute;" runat="server">
    <cmp:Image MyImageType="SmallCancel" CssClass="fright" runat="server" ID="CloseImg" AlternateText="Close" />
    <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">

        <ContentTemplate>
            <asp:HiddenField ID="AttendanceFld" runat="server"  />
            <asp:HiddenField ID="DatePickerFld" runat="server"  />
            <table width="100%">
                <tr>
                    <td valign="top">
                        <asp:RadioButtonList EnableViewState="false" ID="AttendRBL" runat="server" RepeatDirection="Vertical">
                            <asp:ListItem Selected="True" Text="On Time" Value="" />
                            <asp:ListItem Text="Late" Value="Late" />
                            <asp:ListItem Text="Absent" Value="Absent" />
                            <asp:ListItem Text="Cleaning Flunk" Value="Other" title="This is used for things like cubby flunks" />
                            <asp:ListItem Text="Major Cleaning Flunk" Value="Major" title="This is used for things like White Glove flunks" />
                        </asp:RadioButtonList>
                    </td>
                    <td valign="top" style="text-align: center; vertical-align: middle;">
                        <asp:CheckBox EnableViewState="false" ID="ExcusedCB" runat="server" />
                        <br />
                        <asp:Label ID="Label1" EnableViewState="false" AssociatedControlID="ExcusedCB" Text="Excused"
                            runat="server" />
                    </td>
                </tr>

                <tr>
                    <td colspan="2">
                        <asp:Label EnableViewState="false" ID="Label2" Text="Notes" runat="server" AssociatedControlID="DataTB" />
                        <cmp:HelpPopUp EnableViewState="false" runat="server" Text='Must include "Out Sick" to be counted as ill on reports and progress reports' />
                        <br />
                        <asp:TextBox ID="DataTB" EnableViewState="false" runat="server" Columns="30" /><br />
                        <div style="font-size: 10px; text-align:center;">
                            <a href="#" onclick="setAttendVal('<%=this.DataTB.ClientID%>','Out Sick');return false;">
                                (Ill)</a> <a href="#" onclick="setAttendVal('<%=this.DataTB.ClientID%>','In Ethics');return false;">
                                    (Ethics)</a> <a href="#" onclick="setAttendVal('<%=this.DataTB.ClientID %>','Warned');return false;">
                                        (Warned)</a>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <cmp:ImageButton ID="DeleteBtn" OnClientClick="showAttendMenu(this,'');" OnClick="DeleteAttendance" ButtonType="SmallDelete"
                            CssClass="fright" runat="server" />
                        <cmp:ImageButton ID="SaveBtn" OnClientClick="showAttendMenu(this,'');" OnClick="SaveAttendance" ButtonType="SmallSave" runat="server" />
                    </td>
                </tr>
            </table>
        </ContentTemplate>
    </asp:UpdatePanel>
</asp:Panel> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-10T06:07:15.567

使用 DOM 和 HTTP 请求本质上很慢，它是浏览器。加速它的最佳方法是减少 HTTP 请求（AJAX 或其他）的次数，并减少 DOM 操作、搜索、编辑、替换等的数量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-27T16:00:18.513

[我建议使用链接文本](http://ajax.dynatrace.com "dynaTrace AJAX 版")进行性能跟踪。它是 Internet Explorer 中用于 AJAX 性能分析的免费工具

# .net - 使用 Silverlight 的多个屏幕/监视器

> ID：267137
> 
> 赞同：1
> 
> 时间：2008-11-05T23:27:20.647
> 
> 标签：.net, silverlight, multiple-monitors

我想编写一个具有 2 个或更多“交互”浏览器窗口的 Silverlight 应用程序。

一个示例是父/详细信息显示，其中选择“父”列表中的项目（在一个浏览器窗口中）将在另一个窗口中显示该项目的详细信息。

要点是，在多显示器设置中，用户可以在一台显示器上拥有主屏幕，而在另一台显示器上拥有“工具”窗口。就像我如何使用 VS 一样。

这可能吗？任何链接/示例代码等？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T01:46:03.970

凉爽的。杰里米的答案出现在我面前。这是一个很好的可能解决方案。

您也可以使用 Web 服务来执行此操作。您可以使用轮询双工绑定在多个客户端之间进行通信。

这个[Silverlight 服务演示](http://petermcg.wordpress.com/2008/09/03/silverlight-polling-duplex-part-1-architecture/)可能很有趣……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T01:34:03.107

您应该能够通过使用 Silverlight 中的 javascript 桥接支持来完成此操作。使用这种方法，您可以使用 javascript 使用子窗口的 url 生成一个新窗口。那时您可以继续使用 javascript 在两个窗口之间进行通信。像这样的东西： http: [//codepunk.hardwar.org.uk/bjs12.htm](http://codepunk.hardwar.org.uk/bjs12.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-31T02:32:12.463

在 ScottGu 的[宣布 Silverlight 5](http://weblogs.asp.net/scottgu/archive/2010/12/02/announcing-silverlight-5.aspx "宣布 Silverlight 5")博客文章中，他说 OOB 应用程序将支持子窗口。

想我会分享并提出这个问题，因为它已经有一段时间了 - 任何允许 Silvelight 间（IE）窗口通信的框架？

# .net - URL 中的 ASP.NET aspxerrorpath

> ID：267138
> 
> 赞同：16
> 
> 时间：2008-11-05T23:27:25.327
> 
> 标签：.net, asp.net, iis, .net-3.5, iis-7

我有一个网站，我在 web.config 中使用 CustomErrors 来指定自定义错误页面，这很好用。自定义 404 页面也在 IIS 配置中指定（因为如果不是，我不会得到我的自定义 404 页面）。

但是，如果用户得到一个 404 来查看他们请求的 URL 并在适当的情况下提出导航建议，我有一些逻辑可以启动。此逻辑依赖于 aspxerrorpath 值。在我的开发 PC 上，aspxerrorpath 正确附加到 URL，如下所示： *[http://localhost:3092/FileNotFound.aspx?aspxerrorpath=/badpage.aspx](http://localhost:3092/FileNotFound.aspx?aspxerrorpath=/badpage.aspx)*，但在我的测试站点上，没有附加到 URL 的 aspxerrorpath，所以我所有的自定义逻辑都被绕过了，我的建议不起作用。我不确定这是 IIS 配置问题还是其他问题。Web 服务器是带有 IIS 7 的 Windows Server 2008。

有什么想法吗？

非常感谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-05T23:48:40.183

如果 .NET 捕获了错误（并且使用了 web.config 中指定的错误页面），则传递 aspxerrorpath 参数。如果您使用的是开发 Web 服务器，或者如果 IIS 配置为不检查文件是否存在，则会发生这种情况。

如果 IIS 检查文件是否存在，则使用 IIS 中配置的自定义错误，并且请求的 URL 包含在查询字符串中，如下所示

`http://example.com/FileNotFound.aspx?404;http://example.com/badpage.aspx`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T00:17:19.907

您可能需要将以下内容添加到 web.config

```
<customErrors mode="On">
  <error statusCode="404" redirect="~/error404.aspx" />
</customErrors> 
```

欲了解更多信息检查： http: [//geekswithblogs.net/shahed/archive/2007/10/23/116278.aspx](http://geekswithblogs.net/shahed/archive/2007/10/23/116278.aspx)

更新：我们可以利用 IIS7 功能使用 HTTPModules 显示自定义 404 错误页面，如[http://professionalaspnet.com/archive/2008/02/13/Enforcing-a-Custom-404-Page-in-ASP.NET中所述.aspx](http://professionalaspnet.com/archive/2008/02/13/Enforcing-a-Custom-404-Page-in-ASP.NET.aspx)

# java - 为什么 Javadoc 会生成不兼容的 XHTML？

> ID：267140
> 
> 赞同：5
> 
> 时间：2008-11-05T23:28:49.457
> 
> 标签：java, javadoc, xhtml

我只是将一些生成的 javadoc 粘贴到一个 eclipse 项目中，发现没有一个 HTML 是兼容的。

甚至有关闭标签从未打开的情况。

有没有办法解决这个问题？也许是“合规”的选择......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T23:32:54.240

经过一番谷歌搜索，我发现了 [XHTML Doclet 0.4](http://linux.softpedia.com/get/Documentation/XHTML-Doclet-28836.shtml)。

> XHTML Doclet 是Javadoc 标准HTML doclet 的符合标准的替代方案。该项目修改文档结构以排除过时的标签和内联样式，创建有效的 XHTML 标记，并为更灵活的 CSS 操作提供更好的挂钩。

好像有人做了一个插件。

有更好的选择吗？

**编辑：这是**[Sun 的 Javadoc FAQ](http://java.sun.com/j2se/javadoc/faq/index.html#xhtmldoclet)链接到的插件的[官方页面](http://xhtmldoclet.sourceforge.net/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T01:20:37.937

简短的回答是 JavaDocs 早于 XHTML。

Java Posse 组最近有一个有趣的线程，您可能会觉得有趣： [为什么 javadoc 停留在 1997 年？](http://groups.google.com/group/javaposse/browse_thread/thread/107ee3f67e0b7520)

# documentation - Doxygen 和汇编语言

> ID：267143
> 
> 赞同：4
> 
> 时间：2008-11-05T23:29:38.630
> 
> 标签：documentation, assembly, doxygen

我想使用 Doxygen 来记录混合了 C 和 x86 汇编语言的遗留代码。汇编语言不是内联的，而是在单独的仅汇编文件中。如何记录汇编语言部分？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T21:53:30.820

Doxygen FAQ 的问题 12 最终引导我找到了一个看起来很有前途的[Perl 过滤器。](http://rudy.mif.pg.gda.pl/~bogdro/inne/asm4doxy.txt)它将汇编代码转换为 Doxygen 可以解析的类似 C 的代码。谢谢！

原始[链接](http://rudy.mif.pg.gda.pl/~bogdro/inne/asm4doxy.txt)似乎已失效。然而，早在 2008 年，我就下载了一份**asm4doxy.pl**并将其隐藏起来。如果有人仍然感兴趣，我已经把它放在[Pastebin上。](http://pastebin.com/Z3ZmaEmU)我记得，我试过了，但当时它并没有真正对我有用，而是 YMMV。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T23:35:44.047

[请参阅Doxygen 常见问题解答](http://www.doxygen.nl/manual/faq.html)的问题 12 。您是在处理纯汇编文件还是 C 源代码中的内联汇编？假设是前者，您将不得不编写一个输入过滤器以将汇编代码转换为类似 C 的代码（更容易），或者编写一个新的解析器（更难）。

# math - 将 3 轴图绘制为网格

> ID：267151
> 
> 赞同：0
> 
> 时间：2008-11-05T23:34:28.293
> 
> 标签：math, matlab, 3d, graph, plot

我以前看过数据的 3d 曲面图，但我不知道我可以使用什么软件来制作它。

我有 3 系列数据（X、Y、Z），基本上我希望表上的每一行都是 3d 空间中的一个点，全部连接为一个网格。数据目前是 csv，但我可以更改格式，因为它是我自己生成的数据。

谁能帮忙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T00:34:30.543

如果您的 x 和 y 点在拓扑上位于网格上，则可以使用 MESH。它们不需要均匀的间距；它们只需要组织起来，以便 x(r:r+1,c:c+1) 和 y(r:r+1,c:c+1) 在网格上为每一行 r 和每一列定义一个四边形C。

如果您的数据不在网格上，但您知道面应该是什么，请查看 PATCH 函数。

如果只有点，对曲面一无所知，则需要先解决[曲面重建](http://www.compgeom.com/~piyush/rups.html)问题。我用过椰子；那里也有其他不错的包裹。一旦你有了重建的表面，你就可以使用 PATCH 来显示它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T23:42:40.880

你看过使用[vtk](http://www.vtk.org)吗？如果您有 Matlab，那么您应该能够使用*plot3d*或*surf*与*meshgrid*和*griddata*生成 3D 曲面图或*补丁*，如[Fooz 先生](https://stackoverflow.com/questions/267151/plot-a-3-axis-graph-as-a-mesh#267300)所建议的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T23:44:12.593

gnuplot 或[scilab](http://www.scilab.org/)

下面是我不久前为 SciLab 编写的脚本。它读取由制表符分隔的三列。您可以轻松更改此设置以满足您的需求，非常不言自明。[这是在 scilab 中读/写](http://spiff.rit.edu/classes/phys317/lectures/readwrite.html)的快速指南，我在下面参考的是[这里](http://spiff.rit.edu/classes/phys317/examples/plot_from_file.sci)：

```
function plot_from_file(datafile)
//
// Make a simple x-y-z plot based on values read from a datafile.
// We assume that the datafile has three columns of floating-point
// values seperated by tabs.

  // set verbose = 1 to see lots of diagnostics
  verbose = 1;

  // open the datafile (quit if we can't)
  fid = mopen(datafile, 'r');
  if (fid == -1) 
    error('cannot open datafile');
  end

  // loop over all lines in the file, reading them one at a time
  num_lines = 0;
  while (true)

    // try to read the line ...
    [num_read, val(1), val(2), val(3)] = mfscanf(fid, "%f\t%f\t%f");
    if (num_read <= 0)
      break
    end
    if (verbose > 0)
      fprintf(1, 'num_lines %3d  num_read %4d \n', num_lines, num_read);
    end
    if (num_read ~= 3) 
      error('didn''t read three points');
    end

    // okay, that line contained valid data.  Store in arrays
    num_lines = num_lines + 1;
    x_array(num_lines) = val(1);
    y_array(num_lines) = val(2);
    z_array(num_lines) = val(3);
  end

  // now, make the plot
  plot3d2(x_array, y_array, z_array);
  // close the datafile
  mclose(fid);

endfunction 
```

# javascript - Internet Explorer 中的“操作中止”错误是什么？

> ID：267160
> 
> 赞同：9
> 
> 时间：2008-11-05T23:38:14.837
> 
> 标签：javascript, internet-explorer

我最近在一个项目中添加了 JQuery 的日期选择器控件。在 Internet Exploder 中，我收到以下错误消息：

> Internet Explorer 无法打开 Internet 站点
> 
> [http://localhost/](http://localhost/)
> 
> 行动取消

是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-05T23:53:19.173

**今天早些时候有一个相关的问题**：

[**IE 中的操作中止错误**](https://stackoverflow.com/questions/266585/operation-aborted-error-in-ie7)

这是一个常见的问题。

当脚本在页面完成加载之前尝试修改 DOM 时，它会在 IE 中发生。

看看正在执行什么样的脚本。您会发现在页面加载完成之前有些事情已经开始了。您可以使用 window.onload 事件来纠正问题（或使用 onDomReady 库函数之一）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-10-22T11:26:56.347

只是详细说明Keparo的答案。

您可以将脚本放入以下函数之一（根据您使用的库），这将解决问题。

```
原型.js：
document.observe('dom:loaded', function () { /* 你的脚本放在这里 */ }),

jQuery：
jQuery(document).ready(function () { /* 你的脚本放在这里 */ })

工具：
document.addEvent('domloaded', function () { /* 你的脚本放在这里 */ })

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T23:45:21.327

发现这个可能相关的博客文章：http: [//blogs.msdn.com/ie/archive/2008/04/23/what-happened-to-operation-aborted.aspx](http://blogs.msdn.com/ie/archive/2008/04/23/what-happened-to-operation-aborted.aspx)

或者这个：[http ://weblogs.asp.net/infinitiesloop/archive/2006/11/02/Dealing-with-IE-_2600_quot_3B00_Operation-Aborted_2600_quot_3B002E00_-Or_2C00_-how-to-Crash-IE.aspx](http://weblogs.asp.net/infinitiesloop/archive/2006/11/02/Dealing-with-IE-_2600_quot_3B00_Operation-Aborted_2600_quot_3B002E00_-Or_2C00_-how-to-Crash-IE.aspx)

[似乎很常见](http://www.google.com/search?rlz=1C1GGLS_en-USUS297&sourceid=chrome&ie=UTF-8&q=internet+explorer+script+tag+operation+aborted)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T19:48:59.930

我能够在我今天遇到问题的几页上解决这个问题。

如果您有 JavaScript 修改了页面正文中的任何位置的 DOM，请尝试将其移动到`</body>`标记下方。

**例子：**

改变

```
...
<script>highlightSearchTerms();</script>
</body>
</html> 
```

到

```
...
</body>
<script>highlightSearchTerms();</script>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T00:54:20.410

谷歌地图经常出现这种情况（曾经让我发疯，因为它很难调试）。一种简单的解决方案是将`defer`属性添加到脚本标签中。他们不会以这种方式进行验证，但是，嘿，这就是我们正在谈论的现实生活。

# objective-c - Cocoa：NSURLConnection 未尝试 HTTP 请求

> ID：267163
> 
> 赞同：4
> 
> 时间：2008-11-05T23:40:01.323
> 
> 标签：objective-c, cocoa

我的 iPhone 应用程序在 NSURL、NSURL[Mutable]Request、NSURLConnection 方面取得了巨大成功。当试图编译一个独立的 Cocoa 应用程序时，10 行程序发出一个简单的 HTTP 请求，编译器错误或警告为零。该程序编译得很好，但从未向我的 Web 服务器发出 HTTP 请求（我正在运行 tcpdump 并并行查看 Apache 日志）。当我在 iPhone 应用程序中运行非常相似的代码时，基本上复制/粘贴是邪恶的，一切正常。

为了简单起见，我将 NSURLConnection 委托中的“obj”声明的代码保留在此代码片段之外。我还将以下内容传递给 gcc：

gcc -o foo foo.m -lobjc -framework cocoa

感谢您的任何见解。

```
#import <Cocoa/Cocoa.h>

int main (int argc, char *argv[])
{    

NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
NSString * urlstr = @"http://tmp/test.php";
[NSApplication sharedApplication];
NSObject *obj = [[NSObject alloc] init];
NSURL *url = [NSURL URLWithString: urlstr];      
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:url];

    if([request isKindOfClass:[NSMutableURLRequest class]])
    NSLog(@"request is of type NSMutableURLRequest");

[request setHTTPMethod:@"GET"];
[request setCachePolicy:NSURLRequestReloadIgnoringLocalAndRemoteCacheData];
NSURLConnection *connection = [[NSURLConnection alloc]
                             initWithRequest:request
                     delegate:obj
                 startImmediately:YES];

if(connection) 
    NSLog(@"We do have a connection.");

[pool release];
return 0; 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T01:24:12.907

另一张海报几乎为您回答了这个问题，但我想我会添加一些内容。

首先，您实际上不需要为此链接到 Cocoa，只需链接到 Foundation 框架就可以了。此外，由于您不需要连接到 Window Server，您可以摆脱 [NSApplication sharedApplicaiton] 调用。如果您只想开始一个简单的控制台测试应用程序，请使用您现在拥有的并在您的 [pool realease] 调用之前添加它：

[[NSRunLoop currentRunLoop] 运行];

但是请注意，这将阻止并且实际上可能永远不会返回。在调用它之前，如果您希望您的代码在后台实际执行某些操作，您可以添加一个计时器 :) 有关使用它的更多方法，请参阅 NSRunLoop 上的文档。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T00:21:49.460

`NSURLConnection`是一个异步 API，它依赖于`NSRunLoop`. 您发布的代码永远不会为要在其中运行的连接创建运行循环。因此，我认为 Cocoa 无法创建连接，因此返回 nil。要调查的事情：

1）控制台中有什么东西吗？是`NSURLConnection`抛出异常还是记录错误？

2) 如果你改用同步 API 会发生什么？+`[NSURLConnection sendSynchronousRequest:returningResponse:error:]`

3）这段代码有什么意义？Cocoa 不是为自己直接从 main() 函数运行而设计的。您不使用 Xcode 提供的用于设置运行循环、自动释放池等的应用程序模板是否有特殊原因？

# c# - Visual Studio 中的“将所有警告视为错误，除了...”

> ID：267168
> 
> 赞同：131
> 
> 时间：2008-11-05T23:41:50.680
> 
> 标签：c#, visual-studio, msbuild

在 Visual Studio 中，我可以选择“将警告视为错误”选项，以防止在出现任何警告时编译我的代码。我们的团队使用此选项，但我们希望保留两个警告作为警告。

有一个禁止警告的选项，但我们确实希望它们显示为警告，所以这不起作用。

似乎获得我们想要的行为的唯一方法是将每个 C# 警告编号的列表输入到“特定警告”文本框中，除了我们想要视为警告的两个。

除了维护麻烦之外，这种方法的最大缺点是一些警告没有数字，因此无法明确引用。例如，“无法解析此引用。无法找到程序集 'Data....'”

有谁知道更好的方法来做到这一点？

* * *

为那些没有立即明白为什么这是有用的人澄清。想想大多数警告是如何工作的。他们告诉你，你刚写的代码有些不对劲。修复它们大约需要 10 秒，这样可以保持代码库更干净。

“过时”警告与此有很大不同。有时修复它意味着只使用一个新的方法签名。但是，如果整个类已经过时，并且您在数十万行代码中分散使用它，则可能需要数周或更长时间才能修复。您不希望构建被破坏那么久，但您肯定希望看到有关它的警告。这不仅仅是一个假设的案例——这已经发生在我们身上。

文字“#warning”警告也是独一无二的。我经常*想*检查它，但我不想破坏构建。

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2009-01-22T05:52:49.140

您可以`WarningsNotAsErrors`在项目文件中添加 -tag。

```
<PropertyGroup>
    ...
    ...
    <WarningsNotAsErrors>618,1030,1701,1702</WarningsNotAsErrors>
</PropertyGroup> 
```

注意：`612`并且`618`都是关于过时的警告，不知道区别，但我正在处理的项目报告过时并带有警告 618。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-19T08:51:03.000

/warnaserror /warnaserror-:618

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-19T08:53:32.293

或更具体地说，在您的情况下：

/warnaserror /warnaserror-:612,1030,1701,1702

这应该将所有警告视为错误，除了逗号分隔列表中的警告

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-05-15T01:01:15.920

在 Visual Studio 2022 中，我们有一个新的项目属性 UI，其中包括一个编辑器。

正在*构建 | Errors and Warnings*如果将*Treat warnings as errors*设置为*All*，则会出现另一个属性，允许您免除特定警告被视为错误：

[![在此处输入图像描述](https://i.stack.imgur.com/nOUWX.png)](https://i.stack.imgur.com/nOUWX.png)

这会将以下属性添加到您的项目中：

```
<WarningsNotAsErrors>618,1030,1701,1702</WarningsNotAsErrors> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T02:21:25.850

为什么您希望不断看到您没有将其视为错误的警告？我对为什么这是可取的感到困惑-要么修复它们，要么不修复它们。

两个不同的构建/解决方案文件是否可以工作 - 或者一个脚本来复制一个然后修改警告/警告级别是合适的。似乎您可能希望编译器的某些执行发出尖叫声，但其他一些您想继续执行。

所以不同的编译器开关似乎是一个好方法。您可以使用不同的目标来执行此操作 - 一个标记为调试或发布，而其他标记适当地标记为警告。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-22T06:31:36.970

我正在使用将警告视为错误。

在极少数情况下，当出现一些可接受的警告时（即引用过时的成员，或缺少有关 XML 序列化类的文档），则必须**使用 #pragma disable 显式抑制**它（并且可以选择提供没有干净代码的原因作为评论）。

如果有一些问题，该指令的存在还允许找出**谁接受了这个警告违规（通过版本控制的“责备”操作）。**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-30T16:45:46.437

为什么不简单地制定一条规则：“任何签入除 612、1030、1701 或 1702 之外的任何警告的代码的人都必须到白板上写一百次‘我不会再签入带有不允许警告的代码。 '"

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-11-24T17:42:31.687

编译指示警告（C# 参考）

pragma warning 可用于启用或禁用某些警告。

[http://msdn.microsoft.com/en-us/library/441722ys(VS.80).aspx](http://msdn.microsoft.com/en-us/library/441722ys(VS.80).aspx)

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2008-11-10T18:22:31.837

在我看来，根本问题实际上是您将警告视为错误的组合，当它们显然不是时，以及您允许签入的明显政策违反了这一点。正如您所说，您希望能够在收到警告的情况下继续工作。您只提到了一些您希望能够忽略的警告，但是如果团队中的其他人引起了任何其他类型的警告，而这需要您同样长的时间来修复怎么办？难道你不想也能忽略它吗？

合乎逻辑的解决方案是 1) 如果代码无法编译，则不允许签入（这意味着创建警告的人必须修复它们，因为实际上他们破坏了构建），或者 2) 将警告视为警告。创建两个构建配置，一个将警告视为错误，可以定期运行以确保代码无警告，另一个仅将它们视为警告，即使其他人引入了警告也允许您工作。

# c++ - 嵌套模板 gcc 编译器 4.1.2 错误

> ID：267179
> 
> 赞同：2
> 
> 时间：2008-11-05T23:47:40.590
> 
> 标签：c++, linux, visual-c++, templates, compiler-construction

我正在尝试创建一个模板类来将用户与数据类型隔离开来。我更喜欢使用适配器类，但需要更改的函数签名需要模板。

在下面的代码示例中（不是实际项目，只是说明问题的简化版本），而在主例程中，我可以使用 ob_traits 接口。但是，当我尝试创建使用 ob_traits 作为基类的模板化 StructWrapper 时，出现错误并且 gcc 无法识别创建的 IntAdapter 类。这在 MSVC 8.0 上编译，但在 gcc 4.1.2 20070626 (Red hat 4.1.2-14) 上失败

所以首先有两个问题，你明白为什么编译失败并出现下面指定的错误吗？

其次，关于如何以更简单的方式实现这个概念的任何建议？

```
 #include <iostream>

    template <typename T >
    struct ob_traits
    {
        ob_traits( T& param ) { value = param; };
        T value;
    };

    struct GeneralStructure
    {
        int a;
        GeneralStructure(int param):a(param){}
    };

    struct DifferentStructure
    {
        GeneralStructure hidden;
        DifferentStructure( int param ):hidden(param){};
    }
    ;

    /*template< typename T > struct ob_traits
    {
    };
    */
    template<> struct ob_traits< GeneralStructure >
    {
        struct IntAdapter
        {
            IntAdapter( GeneralStructure& valueParam ):value(valueParam){}
            GeneralStructure value;
            int& getValue() { return value.a; };
        };
    };

    template<> struct ob_traits< DifferentStructure >
    {
        struct IntAdapter
        {
            IntAdapter( DifferentStructure& valueParam):value( valueParam ){}
            DifferentStructure value;
            int& getValue( ){ return value.hidden.a; };
        };
        void dump()
        {
            DifferentStructure testLocal(44);
            IntAdapter local( testLocal );
            std::cout << local.getValue()<<std::endl;
        }
    };

    template <typename T > struct StructWrapper:public ob_traits< T >
    {
        StructWrapper(){};
    /*main.cpp:60: error: 'IntAdapter' was not declared in this scope
    main.cpp:60: error: expected `;' before 'inner'
    main.cpp:60: error: 'inner' was not declared in this scope
    */
        void dumpOuter(const T& tempParam) { IntAdapter inner(tempParam); inner.dump(); };
    /*
    main.cpp: In member function 'void StructWrapper<T>::dumpOuterFailsAsWell(const T&)':
    main.cpp:66: error: expected `;' before 'inner'
    main.cpp:66: error: 'inner' was not declared in this scope
    */
        void dumpOuterFailsAsWell(const T& tempParam) { ob_traits<T>::IntAdapter inner(tempParam); inner.dump(); };
    };

    int main(int argc, char* argv[])
    {
        GeneralStructure dummyGeneral(22);
        ob_traits<struct GeneralStructure >::IntAdapter test(dummyGeneral);
        DifferentStructure dummyDifferent(33);
        ob_traits<struct DifferentStructure >::IntAdapter test2(dummyDifferent);
        std::cout << "GeneralStructure: "<<test.getValue()<<std::endl;
        std::cout << "DifferentStructure: "<<test2.getValue()<<std::endl;
        ob_traits<struct DifferentStructure > test3;
        test3.dump();
    std::cout << "Test Templated\n";
    return 0;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T16:07:47.897

`dumpOuter`失败，因为`IntAdapter`需要限定（如在引用的问题中）。`dumpOuterFailsAsWell`失败是因为 GCC 会解析这段代码，即使它不完整，所以它需要知道它是你的意思的类型：

```
void dumpOuterWorks(const T& tempParam) 
{ 
   typename ob_traits<T>::IntAdapter inner(tempParam); 
   inner.dump(); 
} 
```

没有`typename`这里，GCC 将假定 IntAdapter 是一个标识符，并期望您形成一个表达式而不是变量声明。

另请注意，您不必在方法主体之后放置分号！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T00:18:44.803

`StructWrapper`是继承自主类模板（即最不专业的），它没有定义IntWrapper，所以不能在这个类中使用。我不确定`StructWrapper`用一种更专业的类型实例化 a 是否会允许它工作，或者它是否在编译类定义本身时失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T09:23:30.770

编译失败，因为 IntAdapter 仅出现在专用模板中，因此在引用点不可见。

不清楚你会用它做什么？请说明情况。

# sharepoint - 如何以编程方式设置 SharePoint 的网站集搜索中心属性？

> ID：267185
> 
> 赞同：3
> 
> 时间：2008-11-05T23:48:54.067
> 
> 标签：sharepoint, search, properties, sitecollection

我有一个网站集，我想将搜索中心值设置为与另一个网站集相同。网站集是用代码创建的，所以我需要能够在网站集创建后设置属性。

我怎样才能以编程方式做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T08:59:54.780

此设置存储在 SPWeb 对象的属性包中。您可以按如下方式更新它：

```
using (SPSite site = new SPSite("http://server/site"))
using (SPWeb web = site.OpenWeb())
{
  web.AllProperties["SRCH_ENH_FTR_URL"] = "/searchcenter/pages";
  web.Update();
} 
```

# c++ - 在 C++ 中，如果成员函数是虚拟的，什么时候可以使用静态绑定？

> ID：267186
> 
> 赞同：5
> 
> 时间：2008-11-05T23:49:04.143
> 
> 标签：c++, binding, static

在 C++ 中，虚函数何时可以使用静态绑定？如果是通过指针访问，直接访问还是从不访问？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T00:20:10.243

当通过指针或引用调用虚方法时，使用动态绑定。任何其他时间，都会使用编译时绑定。前任：

```
class C;

void Foo(C* a, C& b, C c) {
  a->foo();  // dynamic
  b.foo();  // dynamic
  c.foo();  // static (compile-time)
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T00:12:56.827

如果要调用函数的基类版本，可以通过显式命名基类来实现：

```
class Base
{
public:
  virtual ~Base() {}
  virtual void DoIt() { printf("In Base::DoIt()\n"); }
};

class Derived : public Base
{
public:
  virtual void DoIt() { printf("In Derived::DoIt()\n"); }
};

Base *basePtr = new Derived;
basePtr->DoIt();  // Calls Derived::DoIt() through virtual function call
basePtr->Base::DoIt();  // Explicitly calls Base::DoIt() using normal function call
delete basePtr;
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T00:08:00.207

只有当对象的类型在编译时完全明确时，才能进行静态绑定。我只能想到抽象对象的类型明确的四个地方：在构造函数中，在析构函数中，在本地声明时以及在与动态分配相同的范围内时。我不太了解标准，所以我不能说出它对这四种可能性的看法（我会说前两个是静态绑定的，第三个可能是静态绑定的，最后一个不是；虽然它可能说它是未定义的或实现依赖）。除了这些点之外，通过基类指针访问的对象可能指向派生类，并且当前翻译单元无法知道，因此不可能进行静态绑定。

# asp.net - 如何从 Javascript 函数设置 ASP.NET 控件的“可见”属性？

> ID：267191
> 
> 赞同：17
> 
> 时间：2008-11-05T23:50:33.190
> 
> 标签：asp.net, javascript

基本上我想知道从 Javascript 函数隐藏/显示 ASP.NET 控件的最佳方法。我想我只需使用 Javascript 访问控件：

```
var theControl = document.getElementById("txtEditBox"); 
```

然后只需将控件的 Visible 属性设置为 true/false。它似乎不起作用，我似乎无法弄清楚如何将“可见”设置为真/假。我怎样才能做到这一点？此外，这是从 Javascript 函数隐藏/显示 ASP.NET 控件的最佳方式吗？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-05T23:54:10.093

ASP.NET 控件的“Visible”属性确定它是否将呈现在客户端（即发送到客户端）。如果页面渲染时为假，则永远不会到达客户端。

因此，从技术上讲，您不能设置控件的该属性。

也就是说，如果控件在客户端*上*呈现，因为在呈现页面时 Visible 属性为 true，那么您可以使用 javascript 隐藏它，如下所示：

```
var theControl = document.getElementById("txtEditBox");
theControl.style.display = "none";

// to show it again:
theControl.style.display = ""; 
```

这假定控件的`id`属性在客户端上确实是“txtEditBox”并且它已经可见。

> 此外，这是从 Javascript 函数隐藏/显示 ASP.NET 控件的最佳方式吗？

不一定有“最佳”方式，但更好的方法是使用 CSS 类定义：

```
.invisible { display: none; } 
```

当您想隐藏某些内容时，将该类动态应用于元素；当您想再次显示时，请将其删除。请注意，我相信这仅适用于`display`值以`block`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T23:57:59.447

而不是使用可见，将其 css 设置为 display:none

```
//css:
.invisible { display:none; }

//C#
txtEditBox.CssClass = 'invisible';
txtEditBox.CssClass = ''; // visible again

//javascript
document.getElementById('txtEditBox').className = 'invisible'
document.getElementById('txtEditBox').className = '' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-05T23:58:58.010

将样式设置为“显示：无”。

```
var theControl = document.getElementById("<%= txtEditBox.ClientID %>");
theControl.style.display = "none"; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-06T00:14:24.607

您不能隐藏/显示`ASP.NET`控件的版本，因为它只存在于服务器上下文中。要使用 JavaScript，您需要使用控件样式/可见性状态。

唯一的方法是将控件包装在 UpdatePanel 中并具有以下内容：

```
<asp:UpdatePanel ID="panel" runat="server">
  <ContentTemplate>
    <asp:TextBox ID="myTextBox" runat="server" />
  </ContentTemplate>
  <Triggers>
    <asp:AsynchronousPostbackTrigger ControlID="button" EventName="Click" />
  </Triggers>
</asp:UpdatePanel>
<asp:Button ID="button" runat="server" OnClick="toggle" Text="Click!" /> 
```

然后你需要在你的代码后面：

```
protected void toggle(object sender, EventArgs e){
  myTextBox.Visibility = !myTextBox.Visibility;
} 
```

现在，当您单击按钮时，会发生异步回发，它将刷新 UpdatePanel。

**注意：**这不是一个*好的*解决方案，因为这将是一个非常繁重的 AJAX 请求，因为您需要提交 ViewState。

此外，它可能不是 100% 正确的，我是凭记忆做到的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-05T23:58:41.487

这应该隐藏控件：

```
theControl.style.display = 'none'; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-05T23:59:13.763

您可以为此使用 display 属性。但正如 Jason 所指出的，这是一个 DHTML DOM（客户端）属性，它完全独立于控制渲染的 ASP.NET（服务器端）Visible 属性。

```
theControl.style.display = "none"; 
```

[显示属性](http://www.w3schools.com/css/pr_class_display.asp)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T00:00:25.870

您想将显示样式属性设置为“无”（隐藏）或`null`显示。

```
 var theControl = document.getElementById("txtEditBox");

   theControl.style.display = 'none';

   theControl.style.display = null; 
```

以 jQuery 方式进行操作：

```
 $('#txtEditBox').hide();

   $('#txtEditBox').show(); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-06-10T14:03:21.567

或者，如果您不想使用 css：

```
<asp:TextBox ID="txtBox" runat="server" style="display:none;"> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-01-24T15:28:01.137

我认为最好的解决方案是将您的 ASP 控件放在一个 div 中并将属性显示设置为 div 元素。

```
<div id="divTest">            
   <asp:TextBox ID="txtTest" runat="server"></asp:TextBox>
</div>

<script type="text/javascript">
    SIN JQuery
    document.getElementById('divTest').style.display = "none";

    CON JQuery
    $('#divTest').hide();
</script> 
```

# email - 自动化：通过电子邮件向自己发送文件

> ID：267193
> 
> 赞同：2
> 
> 时间：2008-11-05T23:51:20.207
> 
> 标签：email, send

我家里有一台电脑，工作时无法访问。我希望能够查看我的家用计算机产生的工作结果。我想出的最好的主意是在我的家用计算机上运行一个自动化脚本，它在完成后通过电子邮件将结果（来自文本文件或 stderr/out）发送给我自己。

我对 bash （我有一台*linux*机器）和 java 很满意，所以使用其中一个或两个的答案将是理想的，但如果有更简单的东西也可以。

我通常使用 gmail，但也有 yahoo 邮件。

我的问题是：解决这个问题的基本步骤是什么？我可以做一些琐碎的事情，但不能真正了解这样的事情是如何工作的。

请帮忙。

吉布

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-04T20:20:20.603

# 如何设置 ssmtp 以通过 Gmail 帐户发送

这里的一些步骤起初可能看起来很奇怪，但基本原理放在脚注中，希望能解释原因。

首先在 gmail 上创建一个备用帐户，您将仅用于发送电子邮件。例如，如果您的普通帐户是`user@gmail.com`，请使用新创建的密码创建一个帐户`user.noreply@gmail.com`，该密码仅用于此帐户 [1]。

设置新帐户以将所有电子邮件转发到普通帐户 [2] 并在帐户设置下添加您使用的所有其他电子邮件地址 [3]。

然后安装 ssmtp（在 Debian: 上`aptitude install ssmtp`）并编辑 ssmtp 的配置文件`/etc/ssmtp/ssmtp.conf`：

```
根=用户@gmail.com
mailhub=smtp.gmail.com:587
使用STARTTLS=YES
AuthUser=user.noreply
AuthPass=passwdusedonlyforthisaccount
FromLineOverride=YES

```

并通过编辑来配置本地邮件传递，`/etc/ssmtp/revaliases` 假设您的本地登录为`localuser`：

```
根：user@gmail.com:smtp.gmail.com:587
本地用户：user@gmail.com:smtp.gmail.com:587

```

确保所有应该能够发送电子邮件的用户都可以读取这两个配置文件 [4]。

通过例如`mailx`（在 Debian: 上`aptitude install bsd-mailx`）测试设置：

```
echo '测试，一，二' | mailx -s 'test 1' user@gmail.com

```

希望这可以帮助。

* * *

[1] 新的 gmail 用户名和密码将对所有可以登录您计算机的人可见，因此您不希望此帐户以任何方式成为关键，这意味着如果有人可以访问它，您可以立即关闭它.

[2] 如果您发送的某些电子邮件被退回给您，您可能想了解它，并且实际上存在会很乐意回复来自`johnsmith.noreply`.

`From`[3]如果 Gmail 无法识别地址，它将重写电子邮件的标题。

[4] Ssmtp 以发送邮件的本地用户身份运行，因此用户需要对配置文件具有读取权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T00:32:24.790

在我使用过的任何 Linux 上，从命令行发送邮件都很简单：

```
mail -s "My subject here" recipient@wherever.com <message_body.txt 
```

AFAIK 这充当 sendmail 的前端，您必须配置 sendmail 以将消息转发到您的 ISP 邮件服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T00:32:23.573

您无法从工作中访问您的家庭计算机，这排除了“远程支持”选项。

您可以访问 Internet 上的其他计算机吗？如果是这样，您可以简单地设置其中一个在线存储选项，然后从您的家用计算机 ftp 中的结果。这比尝试编写脚本或代码来生成带有附件或其他内容的电子邮件要简单得多。

然后，您可以查看工作中的外部计算机。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T00:37:59.070

如果您有 netcat，此命令将向您发送一封电子邮件：

给定一个这种格式的文件（来自维基百科）：

```
HELO relay.example.org
MAIL FROM:<bob@example.org>
RCPT TO:<alice@example.com>
RCPT TO:<theboss@example.com>
DATA
From: "Bob Example" <bob@example.org>
To: Alice Example <alice@example.com>
Cc: theboss@example.com
Date: Tue, 15 Jan 2008 16:02:43 -0500
Subject: Test message

Hello Alice.
This is a test message with 5 headers and 4 lines in the body.
Your friend,
Bob
.
QUIT 
```

然后将其 netcat 到您有权访问的 SMTP 服务器：

```
nc mail.somewhere.com 25 < file.txt 
```

这将发送电子邮件。您可以了解如何创建一个 Java 程序来为您执行此操作（只需执行命令）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T00:02:23.040

传统上，对于像 Linux 这样的 unix 系统，您的计算机上有一个 MTA，一个邮件传输代理，用于处理发送电子邮件。

这可能是一个完整的电子邮件服务器，如 exim，或者像 ssmtp 这样简单的东西，它只是将消息发送到中继 SMTP 服务器，如您的 ISP 提供的。

现在不再需要这种情况了，因为像 Thunderbird 这样的邮件客户端包括自己的 MTA，就像 Windows 上的邮件客户端一样。

但是，您的发行版可能会默认安装一些 MTA 或其他，如果没有其他原因，只是系统上的其他东西（如 cron）希望能够发送电子邮件。通常会有一个名为 sendmail 的命令行工具（sendmail 是最初的 MTA [需要引用]，其他 MTA 保持与其接口的兼容性，并且它已成为标准），可用于从 shell 脚本发送电子邮件邮件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T00:13:48.947

我的解决方案假设您有一个可用的 SMTP 服务器，它允许您以编程方式发送电子邮件。或者，您可以使用本地安装的 sendmail，该安装通常可用于大多数 linux 发行版。

创建一个独立的 java 程序来监视您的家庭计算机将文件保存到的目录。使用[JavaMail API](http://java.sun.com/products/javamail/)附加文件并将其发送到您希望的任何电子邮件。

如果您还熟悉[Spring 框架](http://www.springframework.org)，它有一个很好的抽象层用于处理 JavaMail，并使这类事情变得微不足道。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-04T20:21:39.320

当然，您的家庭 ISP 可能也阻止了公共 SMTP 端口。

# c# - 始终以基本形式处理 PreviewKeyDown 事件

> ID：267198
> 
> 赞同：2
> 
> 时间：2008-11-05T23:54:19.173
> 
> 标签：c#, winforms

我们需要在基本表单中处理此事件，而不管当前哪些控件具有焦点。无论控制焦点如何，我们都有几个全局键命令需要工作。

这通过正常处理表单中的 PreviewKeyDown 事件来工作。当我们向表单添加用户控件时，该事件不再触发。

我在这里错过了一些微不足道的事情吗？还是我们需要先处理用户控件中的事件？

谢谢你的帮助！

感谢因素。当我有更多时间时:) 我会让它“正常”工作！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-10T13:56:12.733

您正在使用的隐藏菜单适用于有效的菜单项快捷方式的快捷方式，但如果您想使用任何键作为快捷方式（例如 Page Up/Page Down），则需要不同的技巧。

另一种不涉及 P/Invoke 的方法是将`Form.KeyPreview`表单的属性设置为 true。这将导致首先将所有按键发送到表单，而不管哪个控件具有焦点。然后，您可以覆盖 OnKeyDown、OnKeyPress 和/或 OnKeyUp 以在您的任何控件之前处理按键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T01:55:48.273

PreviewKeyDown 仅在控件具有焦点时有效。听起来您应该查看应用程序级别的**挂钩**以获取特殊的快捷键。您必须使用 P/Invoke 来完成。[pinvoke.net 上的SetWindowsHookEx](http://pinvoke.net/default.aspx/user32/SetWindowsHookEx.html)是一个很好的例子。这是[一篇关于 c# 中鼠标钩子的 MS 知识库文章，在本文](http://support.microsoft.com/kb/318804)[中](http://blogs.msdn.com/toub/archive/2006/05/03/589423.aspx)似乎已扩展为键盘钩子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-03T21:34:48.650

我们最终这样做了：

我通过设置隐藏菜单项找到了解决方法：

```
ToolStripMenuItem.Visible = false 
```

（感谢[这篇文章）](http://blogs.msdn.com/jfoscoding/archive/2005/01/24/359334.aspx)。

似乎总是在表单的主菜单中搜索您的快捷键组合。无论 whick 控制是否具有焦点，这都有效

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T01:20:26.627

这可能不是最好的方法，而是想到的第一种方法。

在您的表单构造函数中，在您调用 InitializeComponent(); 之后 做这样的事情：

```
 foreach (Control control in this.Controls)
            {
                control.PreviewKeyDown += new PreviewKeyDownEventHandler(HandlePreviewKeyDown);
            } 
```

我认为这应该可以解决问题。在您的 HandlePreviewKeyDown 方法中，您可以完成您的工作，无论哪个控件具有焦点，它都应该触发。

# visual-studio - Visual Studio 解决方案文件夹作为真实文件夹

> ID：267200
> 
> 赞同：153
> 
> 时间：2008-11-05T23:54:44.023
> 
> 标签：visual-studio

我有一个 Visual Studio 解决方案。目前，它是一个空解决方案（=没有项目），我添加了一些解决方案文件夹。

解决方案文件夹似乎只是“虚拟文件夹”，因为它们并不是真正在文件系统中创建的，解决方案文件夹中的文件只是与 .sln 文件位于同一文件夹中。

是否有一个我忽略的设置告诉 Visual Studio 将解决方案文件夹视为“真实”文件夹，即在文件系统中创建它们并在我将解决方案中的文件移动到其中一个文件夹时将文件移动到其中？

**编辑：**谢谢。那就给VS2010提个建议吧：）

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2016-05-05T09:43:33.220

有**一种解决方法，它实际上按预期运行**。

1.  将**新**网站或**现有网站**添加到解决方案。（我通常创建一个新的。）
2.  只要确保它是在您的解决方案文件夹中创建的。（有时我什至会创建一个指向外部文件夹的“链接”，例如网络共享上的“Docs”或“Marketing”。在这种情况下，Git 当然会忽略它。）
3.  确保转到“项目”设置或配置管理器以**从构建和部署中排除此“网站”**！

**完毕。现在解决方案资源管理器将反映文件系统中的任何更改，反之亦然**（包括子文件夹）。

我（想念）将它用于团队内部共享的规范、文档、PM 和一些 DevOps 脚本。很容易选择，在源代码管理中包含或不包含什么，并且（如果设置正确）它不会与构建冲突。

我知道该功能不适用于该用例，但除了可能具有误导性的“项目”图标之外，我还没有发现该 hack 的任何不足之处。还有一些用例，其中 VS 提供的经典（虚拟）解决方案文件夹适合图片。你怎么看？

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-11-05T23:58:45.187

无特殊设置。我不认为它被支持。

您可以在解决方案的“项目”中创建真正的文件夹，但不能在解决方案本身中创建。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2018-01-17T13:29:07.183

在 Visual Studio 2017 中，单击解决方案资源管理器窗口中的“解决方案和文件夹”图标。此按钮从虚拟“解决方案”视图切换到与文件系统上的文件夹和文件布局相匹配的“源视图”。添加新文件夹时，该文件夹是在预期位置物理创建的。 [![解决方案和文件夹](https://i.stack.imgur.com/k71Ve.png)](https://i.stack.imgur.com/k71Ve.png).

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-04-14T13:47:41.107

选择的答案表明可以使用实际项目而不是解决方案文件夹，但并没有真正解释如何。我想我在这里描述的可能是实现这一目标的*最不尴尬*的方式...... :-P

*常规*项目文件的问题是它们最终将由`MSBUILD`. 如果你想要一个只包含不可编译文件的项目，那*将*是一个问题。

但是前段时间 Visual Studio 引入了一种新的项目类型：**共享项目**（.shproj 扩展名）。**默认情况下不会**编译此项目类型，但仅当（且仅当）它被另一个项目引用时。

所以这里的诀窍之一是**使用共享项目而不是解决方案文件夹**。显然可以添加一个*从未*被任何其他项目引用的共享项目，这意味着我们可以避免上述问题。

然后，通过`<None Include="**/*" />`在 .shproj 文件中使用子句，我们可以使其*自动*反映任何新文件和/或子文件夹。

所以基本上这样做：

*   在您的解决方案中创建一个新文件夹。
*   在这个新文件夹的根目录下添加一个新的 .shproj 文件。
*   在您的解决方案中引用新的 .shproj。

例如，在我的例子中，我创建了一个 DockerDev.shproj，因此我可以将一些仅在我们的开发机器上运行的与 docker 相关的脚本分组：

```
<?xml version="1.0" encoding="utf-8"?>
<!-- DockerDev/DockerDev.shproj -->
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <None Include="**/*" />
  </ItemGroup>
</Project> 
```

此 .shproj 文件将跟踪我的解决方案中此新文件夹的任何子文件夹*中*的*任何文件。*`DockerDev`

据我所知，这个解决方案的工作原理与 OP 所要求的非常相似：它将作为对文件夹的不可编译引用，并且会自动反映对其所做的任何更改。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-08-29T18:59:35.470

Sara Ford 贡献了一个宏来添加这样做。在 Visual Studio 2010 中，如果您打开宏资源管理器，您将看到一个名为“GenerateSlnFolderOnDirStructure”的宏。这将自动创建解决方案文件夹并添加文件。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-01-27T19:36:15.770

[Cecilia Wirén 的文件夹到解决方案文件夹 - CeciliaSHARP](https://marketplace.visualstudio.com/items?itemName=CeciliaWiren-CeciliaSHARP.FolderToSolutionFolder)

消除将多个文件添加到解决方案文件夹的麻烦。只需使用解决方案的上下文菜单，然后在创建新解决方案文件夹的选项下方，您现在可以找到“将文件夹添加为解决方案文件夹”。这将创建一个与您选择的名称相同的解决方案文件夹，并将该文件夹内的项目添加到解决方案文件夹中。这不会移动磁盘上的文件。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-06T00:04:35.783

不，不支持。正如您所怀疑的，解决方案文件夹只是 .sln 文件中的虚拟子条目，与文件系统无关。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2021-09-18T19:23:54.687

您可以同步新的*解决方案文件夹*嵌套级别，也可以使用实际的文件系统*文件夹*命名，它就像一个魅力！

### 现有项目：

*   创建实际文件夹
*   使用完全相同的名称创建解决方案文件夹
*   将您的项目文件夹复制到新文件夹中（实际文件系统）
*   （在解决方案资源管理器中） - 右键单击​​同一文件夹
*   添加 => 现有项目

### 添加新项目：

*   创建您的解决方案文件夹
*   （右键单击解决方案）=> 添加新项目
*   **将要添加的项目名称下的**位置地址*****更改为解决方案文件夹中完全相同的地址*****

 *** * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-05-04T15:56:04.490

Visual Studio 对此不提供支持。我做了一个扩展，它对 VS2013 做了类似的事情。它将解决方案文件夹映射到硬盘驱动器上的物理文件夹，尽管映射是一种方式（从硬盘驱动器到解决方案）。这意味着解决方案文件夹的内容将反映硬盘驱动器文件夹的内容，而不是相反。

有了这个，扩展可能仍然有用。它支持将解决方案文件夹映射到物理文件夹、基于正则表达式过滤文件和目录以及记住 .sln 文件中的映射。属性是非侵入性的，因此没有扩展的开发人员仍然可以打开 sln 而不会受到影响。

托管在视觉工作室画廊： [https ://visualstudiogallery.msdn.microsoft.com/69e19ea6-4442-4cb6-b​​300-044dd21f02bd](https://visualstudiogallery.msdn.microsoft.com/69e19ea6-4442-4cb6-b300-044dd21f02bd)

编辑：上传到 bitbucket。现在开源。麻省理工学院许可证。[https://bitbucket.org/LSS_NorthWind/physical-solution-folders](https://bitbucket.org/LSS_NorthWind/physical-solution-folders)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-02-09T11:26:44.867

**注意：是的，您可以在根目录上创建一个文件夹，但它有点棘手......**

通过付出一些额外的努力，你可以做到如何？让我们按照步骤——

*   1-创建文件夹，例如：根目录上的“ **newfolder** ”（您的 .sln 文件所在的位置）。
*   2.将您的项目复制并粘贴到文件夹中。
*   3.转到您的 sln 文件并找到已移动的项目并将 newfolder\ 添加到已移动项目的地址中。
*   4.保存sln文件。
*   5.打开您的项目并在git中提交存储库...
*   6.将存储库放在新位置。

    你完成了...

如果您仍然看不到您的文件夹 -----

*   1.添加解决方案文件夹xyz。
*   2.打开 sln 文件并用您的文件夹名称更改该文件夹名称。

恭喜你完成了。。

如果您遇到任何问题，请写信给我寻求帮助..

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-08-15T15:04:21.863

创建“解决方案文件夹”。这将创建逻辑文件夹，但不是物理文件夹。右键单击解决方案文件夹并打开一个新项目对话框。但在单击“确定”之前，您必须将项目位置更改为所需的物理文件夹，VS 将创建它并将项目放入其中。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2021-04-10T10:53:48.027

对于**Visual Studio 2019 中的 C#，**我使用了这种方式（[似乎与此答案相似，但至少在 C# 解决方案中不起作用](https://stackoverflow.com/a/66004927/1574221)）

1.  在解决方案资源管理器中单击`switch views`

[![在此处输入图像描述](https://i.stack.imgur.com/H9D1W.png)](https://i.stack.imgur.com/H9D1W.png)

2.  选择`folder view`

[![在此处输入图像描述](https://i.stack.imgur.com/mOhT3.png)](https://i.stack.imgur.com/mOhT3.png)

3.  您可以将单个文件夹添加到解决方案

[![在此处输入图像描述](https://i.stack.imgur.com/VPCKE.png)](https://i.stack.imgur.com/VPCKE.png)

4.  要返回解决方案资源管理器的常规视图，只需`switch views`再次单击并选择解决方案。

### 使用这种方式似乎有一个限制（来自@montonero 的评论）：

> ...只需打开一个包含多个项目的解决方案，然后尝试通过文件夹视图将项目移动到其他一些真实文件夹。问题是 VS 不会更新解决方案文件中项目的路径

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-09-07T22:39:52.707

我自己也想要这个功能几次，但归根结底，你真的**不**希望有能力做到这一点。将您的解决方案（文件）视为 Web 应用程序的根，并将解决方案文件夹视为虚拟目录（从字面上和功能上）。Web 虚拟目录的内容可能在物理上完全位于不同的服务器上。Visual Studio 混淆解决方案文件夹概念的地方是允许您在文件夹中创建新文件。添加内容时，您应该始终**“添加现有”**。添加现有文件时，它会创建指向文件源位置的链接。

但是，您不希望解决方案文件夹表现得像“物理”文件夹的原因是因为您的解决方案布局可能不一定使用与源代码管理布局相同的约定。解决方案文件夹允许您自定义项目的层次结构，以便您可以以任何您喜欢的方式将项目和项目组合在一起，然后决定您不喜欢它并再次更改它，而不必经历移动源代码管理项目的噩梦周围并激怒团队的其他成员。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-12-19T09:05:49.607

创建一个空解决方案，然后在编辑器中打开 .sln 文件并将这些代码行放在**MinimumVisualStudioVersion之后**

```
Project("{2150E333-8FDC-42A3-9474-1A3956D46DE8}") = "src", "src", "{9D8C3BB1-AEDB-4757-8559-995D12A4E6D0}" 
```

在 vs 中打开解决方案，您应该向其中添加相同的文件夹，现在您可以看到该文件夹​​并向其中添加一个项目，您在 windows 中有一个真实文件夹，在 vs 中有一个虚拟文件夹

确保您使用该路径创建了项目

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-04-03T01:06:48.153

您可以通过为 Visual Studio 项目文件选择“添加新过滤器”来添加真实文件夹。您还可以在现有文件夹下执行“添加新过滤器”。创建文件夹后，将其重命名并添加源文件或头文件或任何适合您项目的文件。这是我知道的一种方法，它可以让我们通过 Visual Studio IDE 创建真正的文件夹。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-06T00:26:44.817

如前所述，在解决方案下创建的文件夹将是虚拟的。也许这可能被称为一种解决方法，但您可以在添加新项目/项目之前或当您添加新项目/项目时在磁盘上物理创建文件夹，并且罗伯特应该是您父亲的兄弟姐妹。

ps-仔细看看也许我应该解释一下“鲍勃是你的叔叔”的意思是你的罚款/分类。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-11-10T11:45:40.570

**我对此有一些解决方法（它不是很好，但它有效）。**

1.  在您的解决方案中创建一个文件夹（即“Contoso”）
2.  右键单击解决方案，然后单击“在解决方案资源管理器中打开文件夹”
3.  在解决方案目录中创建物理文件夹（即“Contoso”）
4.  在物理文件夹中复制/创建文件。
5.  将文件拖到解决方案资源管理器中的虚拟文件夹中。

这不是很好，因为您需要手动维护文件引用，但它对我有用。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-02-02T06:56:13.847

# 是的，该项目可以在 Visual Studio 2019 中使用

虽然这是一个老话题，但我会添加我的答案，因为我遇到了同样的问题并搜索了解决方案，但似乎每个人都 100% 确定没有办法做到这一点。于是我开始尝试VS 2019，尝试了很多设置，最终找到了出路。

# 1 个按钮：D

您只需**单击**1 个按钮 - `Show All Files`，您将看到您的 Visual Studio 解决方案的物理结构：
[![VS 2019 - 显示所有文件按钮](https://i.stack.imgur.com/6ExuW.png)](https://i.stack.imgur.com/6ExuW.png)

# 现在您可以将文件和文件夹添加到项目中，它们将被添加到文件系统（物理上）

右键单击您的项目 → `Add`→`New Folder`
请注意，该选项已更改`New Filter`为`New Folder`
[![VS 2019 添加文件夹菜单](https://i.stack.imgur.com/yhJG4.png)](https://i.stack.imgur.com/yhJG4.png)

# 我对 C++ 的推荐

1.  在项目目录中创建一个根文件夹，其中将包含所有与应用程序相关的内容（代码、标题、数据、库...）。我给它取名`Project`
2.  根据您的需要添加子文件夹来构建您的代码。我更喜欢以下[布局](https://api.csswg.org/bikeshed/?force=1&url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#tld)：`include`、、、、`src`等`data``libs`

[![推荐的 VS 2019 项目结构](https://i.stack.imgur.com/jlbJZ.png)](https://i.stack.imgur.com/jlbJZ.png)

3.  现在设置 Visual Studio 以将这些文件夹识别为标头和源目录。
    1.  在解决方案资源管理器中单击您的项目。请注意，就我而言，它是`CrazyDemo`，而不是
        `Solution 'CreazyDemo' (1 of 1 project)`
    2.  转到项目属性菜单：`Project`→<code>Properties
    3.  打开`Configuration Properties`→<code>VC++ 目录选项卡
    4.  编辑`Include Directories`并设置为`$(ProjectDir)/Project/include;$(IncludePath)`
    5.  编辑`Library Directories`并设置为`$(ProjectDir)/Project/libs;$(LibraryPath)`
    6.  编辑`Source Directories`并设置为`$(ProjectDir)/Project/src;$(SourcePath)`

[![VS 2019 推荐项目属性](https://i.stack.imgur.com/lNXNQ.png)](https://i.stack.imgur.com/lNXNQ.png)

4.  `Scope to This`如果您想专注于 1 个项目，您可以使用该选项。只需右键单击`Project`文件夹并按`Scope to This`
    *   请注意，在此操作之后，为了打开`Project Properties`，您需要单击任何项​​目文件（如`main.cpp`示例中），然后单击可编辑的客户区（如您要更改代码时），然后才可以将能够看到
        `Project`→<code>CrazyDemo 属性选项。[Visual Studio 疯了 ‍♂️]

# 最后，你可能有这样的项目

[![VS 2019 推荐项目示例](https://i.stack.imgur.com/B7NGL.png)](https://i.stack.imgur.com/B7NGL.png)

# ruby-on-rails - 在 Rails 中显示主机名和数据库名

> ID：267219
> 
> 赞同：48
> 
> 时间：2008-11-06T00:01:56.693
> 
> 标签：ruby-on-rails

我想在视图中显示当前的主机名和数据库名。

我在哪里可以得到这些名字？

是否有一些预定义的环境或全局变量？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-07-12T04:54:10.737

使用 Rails 3，您可以使用

```
Rails.configuration.database_configuration[Rails.env] 
```

或者

```
Rails.application.config.database_configuration[Rails.env] 
```

或者

```
ActiveRecord::Base.connection_config 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2011-03-22T00:00:18.210

Rails::configuration.new 答案在 Rails 3 中不起作用

```
config   = Rails::Configuration.new
NoMethodError: undefined method `new' for Rails::Configuration:Module
[...] 
```

如果您使用的是 MySQL 或 Postgres，则此方法有效

```
ActiveRecord::Base.connection.current_database 
```

但这仅适用于已实现该方法的驱动程序。例如，它不适用于 SQLite。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-11-06T00:17:03.307

您可以创建一个 rails 配置对象并从中获取必要的信息：

```
config   = Rails::Configuration.new
host     = config.database_configuration[RAILS_ENV]["host"]
database = config.database_configuration[RAILS_ENV]["database"] 
```

有关详细信息，请参阅 Rails::Configuration 的[文档](http://edgedocs.planetargon.org/classes/Rails/Configuration.html)。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2011-08-05T08:03:18.480

在 Rails 3 上，这最容易通过 访问`Rails::Application.config`，如下所示：

```
 YourApplicationClassName::Application.config.database_configuration[::Rails.env] 
```

如果你尝试直接调用它`Rails`而不是`YourApplicationClassName`，rails 会给你一个弃用警告。如果您不知道您的应用程序常量是什么，请在您的应用程序`Rails.application.class.name`的 Rails 控制台中尝试。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-11-30T21:25:01.203

当您连接到多个数据库时，下面的方法很好。在 Sqlite3 和 Mysql2 上测试

```
MyModel.connection.instance_variable_get(:@config)[:database] 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-11-12T14:37:52.690

在 Rails 控制台中测试：

```
ActiveRecord::Base.connection.instance_variable_get(:@config) 
```

下一个信息应该出来：适配器、主机、编码、重新连接、数据库名称、用户名、通过

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-10-01T00:17:47.030

只是这应该工作 `ActiveRecord::Base.connection.database_name`

# perforce - Perforce 设置问题

> ID：267221
> 
> 赞同：1
> 
> 时间：2008-11-06T00:02:52.540
> 
> 标签：perforce

我已经设置了 Perforce 服务器，并安装了 P4V 客户端。我创建了一个新的仓库和一个新的工作区。根据文档，我已将工作区映射到仓库。到目前为止，一切都很好。

我现在有一个由我希望首次签入的外部应用程序创建的 .SQL 脚本。我将文件复制到我的工作区中，并且可以在客户端的工作区树窗口中看到该文件。然而，当我尝试将文件标记为添加时，我收到“文件未在此客户端上打开”错误。我尝试编辑更改列表以包含该文件，但更改列表编辑器没有“看到”该文件。

我已经阅读了文档（PDF 文件），但我只是看不到我缺少什么。我曾在商业环境中使用过其他 RCS 软件，但这是我第一次尝试设置和管理 RCS 系统以供个人使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T10:04:18.007

我认为您的问题可能与映射有关。这是一个相当普遍的问题。

获取您的详细信息

```
Workspace root: C:\Documents and Settings\wtansill\Perforce\wtansill_localhost_1666

File dir under root: C:\Documents and Settings\wtansill\Perforce\wtansill_localhost_1666\tunnel_files

View mappings:

//tunnel/... //wtansill_localhost_1666/tunnel/...

//tunnel/* //wtansill_localhost_1666/tunnel/* 
```

有了上面的细节，这条线

```
//tunnel/... //wtansill_localhost_1666/tunnel/... 
```

意味着您需要将要添加的文件放入工作空间的根目录以及目录隧道中，例如。

C:\Documents and Settings\wtansill\Perforce\wtansill_localhost_1666\tunnel

而不是

```
C:\Documents and Settings\wtansill\Perforce\wtansill_localhost_1666\tunnel_files 
```

你似乎把它们放在哪里。解决这个问题的方法是

1.  在正确的位置（以及任何子文件夹）创建隧道文件夹
2.  从工作区映射中删除最终文件夹，以便

    //tunnel/... //wtansill_localhost_1666/tunnel/... 变为 //tunnel/... //wtansill_localhost_1666/...

这将意味着任何

C:\Documents and Settings\wtansill\Perforce\wtansill_localhost_1666\tunnel_files

将映射到 //tunnel/tunnel_files 这是我认为你想要的。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T00:08:03.827

您确定您的文件规范包含您添加文件的目录吗？

也许您可以发布您的 ClientSpec 以及您的文件所在的目录？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T01:55:14.467

工作区根目录：C:\Documents and Settings\wtansill\Perforce\wtansill_localhost_1666

根目录下的文件目录：C:\Documents and Settings\wtansill\Perforce\wtansill_localhost_1666\tunnel_files

查看映射：

//隧道/... //wtansill_localhost_1666/隧道/...

//隧道/* //wtansill_localhost_1666/隧道/*

不过，这有点争议。上面的工作区是我安装 Perforce 时默认设置的。我删除了那个工作区并使用 P4V 客户端创建了一个新工作区，追溯了我原来的步骤，现在，瞧，它可以工作了！去搞清楚。

# .net - 通过 MTP C#/VB.net 将文件写入 WPD 设备

> ID：267222
> 
> 赞同：12
> 
> 时间：2008-11-06T00:03:33.117
> 
> 标签：.net, usb, wpd

我想编写一个将 MP3 文件复制到 SanDisk Sansa M240 的应用程序。SanDisk 没有驱动器号，使用 MTP 进行文件传输。我偶然发现了连接到设备的示例：http: [//blogs.msdn.com/dimeby8/archive/2006/09/27/774259.aspx](http://blogs.msdn.com/dimeby8/archive/2006/09/27/774259.aspx)

但是一旦连接，我无法弄清楚如何在设备上实际复制文件/创建文件夹。

我很惊讶这个 COM 库没有任何 .Net 包装器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-31T15:37:11.357

看起来 dimeby8 发布了一些处理数据传输的代码。查看他博客中的其他帖子，尤其是：

[通过 WPD 第 1 部分发送 MTP 命令](https://docs.microsoft.com/en-us/archive/blogs/dimeby8/sending-mtp-commands-through-wpd-part-1-without-a-data-phase)

[通过 WPD 第 2 部分发送 MTP 命令](https://docs.microsoft.com/en-us/archive/blogs/dimeby8/sending-mtp-commands-through-wpd-part-2-data-to-the-device)

[通过 WPD 第 3 部分发送 MTP 命令](https://docs.microsoft.com/en-us/archive/blogs/dimeby8/sending-mtp-commands-through-wpd-part-3-data-from-device)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-02T15:07:46.743

使用 C# 通过 MTP 传输文件：

1.  下载此 NuGet 包：[PortableDevices](https://www.nuget.org/packages/PortableDevices/)

2.  添加对这 4 个 COM 库的引用：

    *   便携式设备类扩展
    *   PortableDeviceConnectApi
    *   便携式设备类型
    *   便携设备接口
3.  将dll放在下面`obj\Debug`并将它们放入`bin\Debug`：

    *   Interop.PortableDeviceClassExtension.dll
    *   Interop.PortableDeviceConnectApiLib.dll
    *   Interop.PortableDeviceTypesLib.dll
    *   Interop.PortableDeviceApiLib.dll

* * *

现在您可以使用以下函数列出所有设备，尽管`FriendlyName`它似乎不起作用（它返回一个空字符串）：

```
 private IDictionary<string, string> GetDeviceIds()
    {
        var deviceIds = new Dictionary<string, string>();
        var devices = new PortableDeviceCollection();
        devices.Refresh();
        foreach (var device in devices)
        {
            device.Connect();
            deviceIds.Add(device.FriendlyName, device.DeviceId);
            Console.WriteLine(@"DeviceId: {0}, FriendlyName: {1}", device.DeviceId, device.FriendlyName);
            device.Disconnect();
        }
        return deviceIds;
    } 
```

下一步是从设备中获取内容，操作如下：

```
var contents = device.GetContents(); 
```

# php - 如何让 php 在继续之前等待 curl 完成？

> ID：267236
> 
> 赞同：1
> 
> 时间：2008-11-06T00:12:50.447
> 
> 标签：php, curl

看来如果我做类似的事情

```
$file = fopen($filepath, "w");
$CR = curl_init();
curl_setopt($CR, CURLOPT_URL, $source_path);
curl_setopt($CR, CURLOPT_POST, 1);
curl_setopt($CR, CURLOPT_FAILONERROR, true);
curl_setopt($CR, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($CR, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($CR, CURLOPT_FILE, $file);
$result = curl_exec( $CR );
$error = curl_error( $CR );
print filesize($filepath); 
```

我得到的结果与我只是跑步不同

```
print filesize($filepath); 
```

第二次。我的猜测是，当执行 filesize() 时，curl 仍在下载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T02:33:55.060

请注意，像 filesize() 这样的函数会缓存它们的结果，请尝试在“print filesize(...);”上方添加对 clearstatcache() 的调用。这是一个例子：

```
$file = '/tmp/test12345';
file_put_contents($file, 'hello');
echo filesize($file), "\n";
file_put_contents($file, 'hello world, this is a test');
echo filesize($file), "\n";
clearstatcache();
echo filesize($file), "\n"; 
```

见 www.php.net/clearstatcache

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:26:02.740

好吧，我有同样的问题。curl 应该是同步的，但是，取决于您如何使用它，它不是同步的。
如果您在 curl、print 或 echo 之后调用，则内容无效。有一个奇怪的延迟。但我会尝试这种方法 -

```
print_r(curls_getinfo($CR)); 
```

一步完成所有事情可能会解决问题。

# ruby - 在 Ruby 中对受保护和私有方法进行单元测试的最佳方法是什么？

> ID：267237
> 
> 赞同：144
> 
> 时间：2008-11-06T00:12:55.110
> 
> 标签：ruby, unit-testing, private, protected

`Test::Unit`使用标准 Ruby框架在 Ruby 中对受保护方法和私有方法进行单元测试的最佳方法是什么？

我敢肯定，有人会直言不讳地断言“你应该只对公共方法进行单元测试；如果它需要单元测试，它不应该是受保护的或私有的方法”，但我对争论这个并不感兴趣。我有几个受保护或私有的方法，这些方法**有**充分和正当的理由，这些私有/受保护方法相当复杂，类中的公共方法依赖于这些受保护/私有方法正常运行，因此我需要一种测试方法受保护/私有方法。

还有一件事......我通常将给定类的所有方法放在一个文件中，并将该类的单元测试放在另一个文件中。理想情况下，我希望将这种“受保护和私有方法的单元测试”功能实现到单元测试文件中，而不是主源文件中，以使主源文件尽可能简单明了。

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2008-11-06T01:31:58.493

您可以使用 send 方法绕过封装：

```
myobject.send(:method_name, args) 
```

这是 Ruby 的一个“特性”。:)

在 Ruby 1.9 开发过程中存在内部争论，考虑`send`尊重隐私并`send!`忽略它，但最终在 Ruby 1.9 中没有任何改变。忽略下面讨论`send!`和破坏事物的评论。

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2008-11-06T17:01:32.470

Here's one easy way if you use RSpec:

```
before(:each) do
  MyClass.send(:public, *MyClass.protected_instance_methods)  
end 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-11-06T18:29:52.727

只需重新打开测试文件中的类，然后将方法或方法重新定义为 public。您不必重新定义方法本身的内容，只需将符号传递给`public`调用即可。

如果你原来的类是这样定义的：

```
class MyClass

  private

  def foo
    true
  end
end 
```

在您的测试文件中，只需执行以下操作：

```
class MyClass
  public :foo

end 
```

`public`如果要公开更多私有方法，可以传递多个符号。

```
public :foo, :bar 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-11-06T01:36:17.470

`instance_eval()`可能有帮助：

```
--------------------------------------------------- Object#instance_eval
     obj.instance_eval(string [, filename [, lineno]] )   => obj
     obj.instance_eval {| | block }                       => obj
------------------------------------------------------------------------
     Evaluates a string containing Ruby source code, or the given 
     block, within the context of the receiver (obj). In order to set 
     the context, the variable self is set to obj while the code is 
     executing, giving the code access to obj's instance variables. In 
     the version of instance_eval that takes a String, the optional 
     second and third parameters supply a filename and starting line 
     number that are used when reporting compilation errors.

        class Klass
          def initialize
            @secret = 99
          end
        end
        k = Klass.new
        k.instance_eval { @secret }   #=> 99 
```

您可以使用它直接访问私有方法和实例变量。

您也可以考虑使用`send()`，它还可以让您访问私有和受保护的方法（就像 James Baker 建议的那样）

或者，您可以修改测试对象的元类，使私有/受保护的方法仅为该对象公开。

```
 test_obj.a_private_method(...) #=> raises NoMethodError
    test_obj.a_protected_method(...) #=> raises NoMethodError
    class << test_obj
        public :a_private_method, :a_protected_method
    end
    test_obj.a_private_method(...) # executes
    test_obj.a_protected_method(...) # executes

    other_test_obj = test.obj.class.new
    other_test_obj.a_private_method(...) #=> raises NoMethodError
    other_test_obj.a_protected_method(...) #=> raises NoMethodError 
```

这将允许您调用这些方法而不会影响该类的其他对象。您可以在测试目录中重新打开该类，并将它们公开给您的测试代码中的所有实例，但这可能会影响您对公共接口的测试。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-06T14:48:23.703

我过去做过的一种方法是：

```
class foo
  def public_method
    private_method
  end

private unless 'test' == Rails.env

  def private_method
    'private'
  end
end 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-07-18T01:19:38.493

> 我敢肯定，有人会直言不讳地断言“你应该只对公共方法进行单元测试；如果它需要单元测试，它不应该是受保护的或私有的方法”，但我对此并不真正感兴趣。

您还可以将它们重构为一个新对象，其中这些方法是公共的，并在原始类中私下委托给它们。这将允许您在规范中测试没有魔法元宝石的方法，同时保持它们的私密性。

> 我有几种受保护或私有的方法，这些方法有充分和正当的理由

这些正当的理由是什么？其他 OOP 语言可以完全不用私有方法（想到 smalltalk - 私有方法仅作为约定存在）。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-03-03T21:41:06.993

与@WillSargent 的响应类似，这是我在一个`describe`块中使用的特殊情况，用于测试一些受保护的验证器，而无需经历使用 FactoryGirl 创建/更新它们的重量级过程（您可以`private_instance_methods`类似地使用）：

```
 describe "protected custom `validates` methods" do
    # Test these methods directly to avoid needing FactoryGirl.create
    # to trigger before_create, etc.
    before(:all) do
      @protected_methods = MyClass.protected_instance_methods
      MyClass.send(:public, *@protected_methods)
    end
    after(:all) do
      MyClass.send(:protected, *@protected_methods)
      @protected_methods = nil
    end

    # ...do some tests...
  end 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-11-25T14:28:59.780

要公开所描述类的所有受保护和私有方法，您可以将以下内容添加到您的 spec_helper.rb 中，而不必触及任何规范文件。

```
RSpec.configure do |config|
  config.before(:each) do
    described_class.send(:public, *described_class.protected_instance_methods)
    described_class.send(:public, *described_class.private_instance_methods)
  end
end 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-06T15:15:18.737

您可以“重新打开”该类并提供一种委托给私有方法的新方法：

```
class Foo
  private
  def bar; puts "Oi! how did you reach me??"; end
end
# and then
class Foo
  def ah_hah; bar; end
end
# then
Foo.new.ah_hah 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-06T14:54:16.110

我可能倾向于使用 instance_eval()。然而，在我知道 instance_eval() 之前，我会在我的单元测试文件中创建一个派生类。然后我会将私有方法设置为公开的。

在下面的示例中， build_year_range 方法在 PublicationSearch::ISIQuery 类中是私有的。仅出于测试目的派生一个新类允许我将一个或多个方法设置为公开的，因此可以直接测试。同样，派生类公开了一个名为“result”的实例变量，该变量以前未公开。

```
# A derived class useful for testing.
class MockISIQuery < PublicationSearch::ISIQuery
    attr_accessor :result
    public :build_year_range
end 
```

在我的单元测试中，我有一个测试用例实例化 MockISIQuery 类并直接测试 build_year_range() 方法。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-05-14T18:10:49.973

在 Test::Unit 框架中可以写，

```
MyClass.send(:public, :method_name) 
```

这里“method_name”是私有方法。

&同时调用这个方法可以写，

```
assert_equal expected, MyClass.instance.method_name(params) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-03-01T22:22:25.110

要更正上面的最佳答案：在 Ruby 1.9.1 中，发送所有消息的是 Object#send，尊重隐私的是 Object#public_send。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-11-25T09:04:03.917

这是我使用的 Class 的一般补充。它比仅仅公开你正在测试的方法要多一点，但在大多数情况下它并不重要，而且它更具可读性。

```
class Class
  def publicize_methods
    saved_private_instance_methods = self.private_instance_methods
    self.class_eval { public *saved_private_instance_methods }
    begin
      yield
    ensure
      self.class_eval { private *saved_private_instance_methods }
    end
  end
end

MyClass.publicize_methods do
  assert_equal 10, MyClass.new.secret_private_method
end 
```

使用 send 访问受保护/私有方法在 1.9 中*被*破坏，因此不是推荐的解决方案。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-01-06T06:12:07.343

您可以使用单例方法代替 obj.send。它在您的测试类中多了 3 行代码，并且不需要更改要测试的实际代码。

```
def obj.my_private_method_publicly (*args)
  my_private_method(*args)
end 
```

在测试用例中，您可以`my_private_method_publicly`在想要测试时使用`my_private_method`。

[http://mathandprogramming.blogspot.com/2010/01/ruby-testing-private-methods.html](http://mathandprogramming.blogspot.com/2010/01/ruby-testing-private-methods.html)

`obj.send``send!`私有方法在 1.9 中被替换为，但后来又`send!`被删除了。所以`obj.send`效果很好。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-04-01T11:59:19.567

为此：

```
disrespect_privacy @object do |p|
  assert p.private_method
end 
```

你可以在你的 test_helper 文件中实现它：

```
class ActiveSupport::TestCase
  def disrespect_privacy(object_or_class, &block)   # access private methods in a block
    raise ArgumentError, 'Block must be specified' unless block_given?
    yield Disrespect.new(object_or_class)
  end

  class Disrespect
    def initialize(object_or_class)
      @object = object_or_class
    end
    def method_missing(method, *args)
      @object.send(method, *args)
    end
  end
end 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-02-16T23:38:31.087

我知道我迟到了，但不要测试私有方法....我想不出这样做的理由。可公开访问的方法是在某处使用该私有方法，测试该公共方法以及可能导致该私有方法被使用的各种场景。有东西进去，有东西出来。测试私有方法是一个很大的禁忌，它使以后重构代码变得更加困难。他们是私人的是有原因的。

# c# - 在 C# 中，如何像在 Excel 中一样在 DataGrid AutoFit Column Width 中制作列？

> ID：267239
> 
> 赞同：4
> 
> 时间：2008-11-06T00:13:27.247
> 
> 标签：c#, datagrid

在 C# 中，如何像在 Excel 中一样在 DataGrid AutoFit Column Width 中制作列？目前我的五列是固定宽度，但列标题可以改变，所以我希望列自动适应列的宽度。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T00:38:15.090

DataGridView 上有一个名为 AutoSizeColumnsMode 的属性，它是一个枚举。可用的值为：

所有细胞

AllCellsExceptHeader

列标题

显示单元格

DisplayedCellsExceptHeader

充满

没有任何

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T00:47:30.780

让 BFree 的回答更进一步：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.autoresizecolumns.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.autoresizecolumns.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-17T20:40:51.947

## **C# 这是我在表单上添加所有适合列的 DataGrid 的函数**

```
 public static DataGrid AddDataGrid(DataGrid DG, object Me, System.Data.DataTable DS)
    {

        try {
            DG.DataSource = DS;
            Me.Controls.Add(DG);
            DataGridTableStyle TblS = new DataGridTableStyle { MappingName = DS.TableName };
            DG.TableStyles.Clear();
            DG.TableStyles.Add(TblS);

            for (ColIndex = 0; ColIndex <= DS.Columns.Count - 1; ColIndex++) {
                int maxlength = 0;
                Graphics g = DG.CreateGraphics();

                // Take width of one blank space and add to the new width of the Column.
                int offset = Convert.ToInt32(Math.Ceiling(g.MeasureString(" ", DG.Font).Width));

                int i = 0;
                int intaux = 0;
                string straux = null;
                int tot = DS.Rows.Count;

                for (i = 0; i <= (tot - 1); i++) {
                    straux = DS.Rows[i][ColIndex].ToString();
                    // Get the width of Current Field String according to the Font.
                    intaux = Convert.ToInt32(Math.Ceiling(g.MeasureString(straux, DG.Font).Width));
                    if ((intaux > maxlength)) {
                        maxlength = intaux;
                    }
                }

                // Assign New Width to DataGrid column.
                DG.TableStyles(DS.TableName).GridColumnStyles(ColIndex).Width = maxlength + offset;

            }

        } catch (Exception ex) {
            Debug.WriteLine(ex.Message);
        } finally {
            DG.Show();
        }

        return DG;
    } 
```

**使用此功能的示例...**

```
 private void AddDataGrid(DataSet Ds)
    {
        AddDataGrid(new DataGrid { Dock = DockStyle.Fill }, this, Ds.Tables[0]);

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-17T21:02:52.233

**VB 这是我在表单上添加所有适合列的 DataGrid 的功能**

```
Shared Function AddDataGrid(ByVal DG As DataGrid, ByVal This As Object, ByVal DS As System.Data.DataTable) As DataGrid

        Try

            DG.DataSource = DS
            This.Controls.Add(DG)
            Dim TblS As New DataGridTableStyle() With {.MappingName = DS.TableName}
            DG.TableStyles.Clear()
            DG.TableStyles.Add(TblS)

            For ColIndex = 0 To DS.Columns.Count - 1

                Dim maxlength As Integer = 0
                Dim g As Graphics = DG.CreateGraphics()

                ' Take width of one blank space and add to the new width of the Column.
                Dim offset As Integer = Convert.ToInt32(Math.Ceiling(g.MeasureString(" ", DG.Font).Width))

                Dim i As Integer = 0
                Dim intaux As Integer
                Dim straux As String
                Dim tot As Integer = DS.Rows.Count

                For i = 0 To (tot - 1)
                    straux = DS.Rows(i)(ColIndex).ToString()
                    ' Get the width of Current Field String according to the Font.
                    intaux = Convert.ToInt32(Math.Ceiling(g.MeasureString(straux, DG.Font).Width))
                    If (intaux > maxlength) Then
                        maxlength = intaux
                    End If
                Next

                ' Assign New Width to DataGrid column.
                DG.TableStyles(DS.TableName).GridColumnStyles(ColIndex).Width = maxlength + offset

            Next

        Catch ex As Exception
            Debug.WriteLine(ex.Message)
        Finally
            DG.Show()
        End Try

        Return DG
    End Function 
```

**使用此功能的示例...**

```
Private Sub AddDataGrid(ByVal Ds As DataSet)

    AddDataGrid(New DataGrid With {.Dock = DockStyle.Fill}, Me, Ds.Tables(0))

End Sub 
```

# c++ - 通过负面警告摆脱 gcc shift

> ID：267248
> 
> 赞同：3
> 
> 时间：2008-11-06T00:15:14.887
> 
> 标签：c++, gcc

我有一些看起来像的代码：

```
template<unsigned int A, unsigned int B>
int foo() {
  int v = 1;
  const int x = A - B;
  if (x > 0) {
    v = v << x;
  }
  bar(v);
} 
```

gcc 会抱怨 x 对于 A、B 的某些实例是负数；但是，我确实进行了检查以确保它是非负数。解决这个问题的最佳方法是什么？我知道我可以`x`转换为`unsigned int`，但这会导致警告`x`大于宽度`v`（因为它将负数转换为正数）。我知道有一种解决方法涉及创建一个新的模板化`shift`函数，但如果可能的话，我想避免这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T01:40:21.987

由于 A 和 B 在编译时是已知的，因此您不仅可以摆脱警告，还可以摆脱 runtime `if`，而无需任何强制转换，如下所示：

```
#include <iostream>
using namespace std;

template< unsigned int A, unsigned int B >
struct my
{
    template< bool P >
    static void shift_if( int & );

    template<>
    static void shift_if< false >( int & ) {}

    template<>
    static void shift_if< true >( int & v ) { v <<= A - B; }

    static void op( int & v ) { shift_if< (A > B) >( v ); }
};

template< unsigned int A, unsigned int B >
int foo()
{
    int v = 1;
    my< A, B >::op( v );
    return v;
}

int main() {
    cout << foo< 1, 3 >() << endl;
    cout << foo< 3, 1 >() << endl;
    cout << foo< 300, 1 >() << endl;
    cout << foo< 25, 31 >() << endl;
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T00:18:56.737

为什么不将 x 设为 unsigned char 类型并进行强制转换呢？您肯定不需要移动超过 255 位吗？

```
const unsigned char x = static_cast<unsigned char>(A - B); 
```

或者也许使用掩码来确保移位在这样的范围内：

```
const unsigned int x = static_cast<unsigned int>(A - B) & 0x1f; // limit A-B to have a range of (0 - 31) 
```

编辑：

作为对评论的回应，这里有一个想法：

```
template<unsigned int A, unsigned int B>
int foo() {
  int v = 1;
  const int x = A - B;
  if (x > 0) {
    v = v << (static_cast<unsigned int>(x) & 0x1f);
  }
  bar(v);
} 
```

注意：您可以将 0x1f 替换为： (CHAR_BIT * sizeof(T) - 1)

编辑：响应最新评论，此代码不会发出任何警告编译： g++ -W -Wall -ansi -pedantic test.cc -o test

```
#include <iostream>

template<unsigned int A, unsigned int B>
int foo() {
  int v = 1;
  const int x = A - B;
  if (x > 0) {
    v = v << (static_cast<unsigned int>(x) & 0x1f);
  }
  return v;
}

int main() {
    std::cout << foo<1, 3>() << std::endl;
    std::cout << foo<3, 1>() << std::endl;
    std::cout << foo<300, 1>() << std::endl;
    std::cout << foo<25, 31>() << std::endl;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T00:18:46.907

这行得通吗？

```
const short unsigned int x = A - B; 
```

它切断了比需要切断更多的位，但如果你的 A - B 值足够小......

# windows - 如何在 Windows 上设置应用程序以响应 MAPISendMail 调用？

> ID：267249
> 
> 赞同：1
> 
> 时间：2008-11-06T00:16:34.387
> 
> 标签：windows, email, mapisendmail

MAPISendMail 功能在 Windows 上可用，因此应用程序可以请求发送电子邮件。Windows 会将请求路由到配置为默认提供程序的任何电子邮件客户端。

我如何编写一个应用程序，使其充当电子邮件客户端以接收 MAPISendMail 电子邮件？谁能指出我的 MSDN 文档？或者让我知道所涉及的所需接口和注册表项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-12T14:26:45.113

在注册表中添加一些东西到 HKEY_LOCAL_MACHINE\Software\Clients\Mapi

使用您的应用程序名称创建一个新密钥添加一个 REG_EXPAND_SZ 并将路径分配给您的 dll 创建一个名称为 shell 的新密钥 创建一个名称为 open 的新密钥 创建一个名称为命令的新密钥 将您的 exe 名称分配给它。

PS。对于 vista 和 windows 7，使用 HKEY_LOCAL_USER

在您的 DLL 中实现 MAPI-API。您需要设置 shell\open\command 值，否则客户端将不会显示在 Internet 设置的客户端列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T20:09:05.320

如果您不使用 Microsoft Exchange 传输提供程序，则可以实现 MAPI 后台处理程序挂钩提供程序。以下 Microsoft 知识库示例展示了如何创建 MAPI 后台处理程序挂钩提供程序：

[http://support.microsoft.com/kb/224362](http://support.microsoft.com/kb/224362)

# c - 等效于 Mac/Linux 崩溃的 Windows getch()

> ID：267250
> 
> 赞同：11
> 
> 时间：2008-11-06T00:16:52.030
> 
> 标签：c, macos, crash, getch

我正在使用`getch()`，我的应用程序立即崩溃。包括在做的时候：

```
int main()
{
    getch();
} 
```

我找不到链接，但据说问题是它需要关闭缓冲或沿着这些线奇怪的东西，我仍然想`cout`使用跨平台代码。

我被告知要使用`std::cin.get()`，但我希望应用程序在按下某个键时退出，而不是在用户输入字母或数字然后按 Enter 退出时退出。

这有什么功能吗？代码必须在 Mac（我的操作系统）和 Windows 下工作。

* * *

链接/编译不是[问题](https://stackoverflow.com/questions/267250/equivalent-to-getch-mac-linux-crash#comment14636199_267281)；我在 XCode 中包含`<curses.h>`并链接 with ，而 Windows 使用.`-lcurses``<conio.h>`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-06T01:13:17.547

您是否查看过`<curses.h>`该`getch()`功能的作用？

提示：OSX 和 Linux 与 Windows 不同。

具体来说，作为 中的宏`<curses.h>`，我们发现：

```
#define getch() wgetch(stdscr) 
```

现在，在您的系统上，`getch()`curses 库中似乎有一个实际函数，但它希望`stdscr`被设置，这是由 curses 初始化函数（`initscr()`和亲属）完成的，而这显然不是由您的代码完成的. 因此，您的代码通过在正确初始化完成之前调用 curses 例程来调用未定义的行为，从而导致崩溃。

（来自 dmckee 的好提示 - 它有助于将链接线从 acidzombie24 中取出，这很重要。）

为了达到可以读取单个按键并干净地终止程序的程度，您必须在 Unix（OSX、Linux）上做大量工作。您必须捕获终端的初始状态，安排一个`atexit()`函数 - 或一些类似的机制 - 来恢复终端的状态，将终端从熟模式更改为原始模式，然后调用一个函数来读取一个字符（可能只是`read(0, &c, 1)`），然后退出。可能还有其他方法可以做到这一点 - 但它肯定会涉及一些设置和拆卸操作。

一本可能有帮助的书是[高级 Unix 编程，](https://rads.stackoverflow.com/amzn/click/com/0131411543) Mark Rochkind 的第二版；它涵盖了所需级别的终端处理。或者，您可以`<curses.h>`正确使用 - 这将比您自己的解决方案更简单，并且可能更可靠。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T00:29:52.860

你没有展示过

```
#include <stdio.h> 
```

或者

```
#include <curses.h> 
```

或类似的线路。您确定要链接到*包含* `getch()`的库吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-21T23:23:32.200

例如使用 cin.get() 函数：

```
#include <iostream>

using namespace std;

int main()
{
  char input = cin.get();

  cout << "You Pressed: " << input;
} 
```

然后程序会等待你按下一个键。

一旦你有，你按下的键将被打印到屏幕上。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-06-27T22:19:02.107

该`getch`函数在类 Unix 系统上不可用，但您可以通过带有该`system`函数的编译器将其替换为控制台命令。

用法：

在 Windows 中，您可以使用`system("pause");`

在类 Unix 系统（如 OSX）中，您可以使用`system("read -n1 -p ' ' key");`

注意：`system`在`<stdlib.h>`.

# svn - 将多个 SVN 存储库合并为一个

> ID：267256
> 
> 赞同：60
> 
> 时间：2008-11-06T00:18:56.627
> 
> 标签：svn

在考虑了我之前的问题（[一个 SVN 存储库还是许多？](https://stackoverflow.com/questions/252459/one-svn-repository-or-many)）的答案之后，我决定采用我拥有的 4 个左右的存储库并将它们合并为一个。这当然会引出一个问题，**最好的方法是什么？**

有没有办法结合两个或多个存储库来维护两者的版本历史？

编辑：*我还应该指出我正在使用 Assembla.com，它不提供对 svnadmin 命令 AFAIK 的访问权限*

另一个编辑：*这甚至重要吗？如果 svnadmin 在 URL 上工作，那么就没有问题了。*

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-11-06T00:39:00.860

编辑：哦，好吧，问题编辑是在我打字的时候进行的。这是一个答案

> 有没有办法结合两个或多个存储库来维护两者的版本历史？

* * *

假如说

现有存储库的结构如下：

*   存储库根
    *   分支机构
    *   标签
    *   树干

你想要一个类似的结构：

*   存储库根
    *   项目A
        *   分支机构
        *   标签
        *   树干
    *   项目B
        *   分支机构
        *   标签
        *   树干

然后对于您的每个项目存储库：

```
svnadmin dump > project<n>.dmp 
```

然后对于每个转储文件：

```
svn mkdir "<repo url>/project<n>"
svnadmin load --parent-dir "project<n>" <filesystem path to repos> 
```

更复杂的操作是可能的，但这是最简单、最直接的。在转储/加载期间更改源存储库结构是危险的，但可以通过结合使用`svnadmin dump`、`svndumpfilter`、 手动编辑或其他文本过滤器和`svnadmin load`

* * *

**与第三方提供商打交道**

*   `svnadmin dump`为每个存储库请求文件。提供者应该愿意/能够提供这个 - 这*是* **你的**代码！
*   在本地创建一个 SVN 存储库。
*   对转储文件执行上面列出的操作。
*   使用您最喜欢的客户端验证存储库结构是否正确。
*   为组合存储库创建转储文件。
*   请求提供者从此转储文件填充新的存储库。

YMMV：这似乎是一个合理的方法，但我从未与这样的第三方提供商合作过。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-12-16T03:26:34.070

使用 Subversion 1.7，您现在可以远程进行转储。也就是说，无需访问本地文件系统和`svnadmin dump`命令。

您可以使用它`svnrdump`来获取远程存储库的完整转储。有关语法详细信息，请参阅文档。

请注意，服务器不必运行 1.7，只需运行客户端即可。

[http://svnbook.red-bean.com/en/1.7/svn.ref.svnrdump.c.dump.html](http://svnbook.red-bean.com/en/1.7/svn.ref.svnrdump.c.dump.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-06T00:31:15.557

是的，使用[svnadmin dump](http://svnbook.red-bean.com/en/1.5/svn.ref.svnadmin.c.dump.html)和[svnadmin load](http://svnbook.red-bean.com/en/1.5/svn.ref.svnadmin.c.load.html)。

假设您必须使用存储库，一个具有 HEAD 修订版 100，另一个具有 HEAD 修订版 150。

您转储第一个存储库并将其加载到新存储库中：您最终得到了第一个存储库的完整故事，从修订 0 到修订 150。

然后你转储第二个存储库并将其加载到新的存储库中：它会加载完整的历史记录，唯一改变的是实际的修订号。第二个存储库的历史将在新的存储库中表示，从修订版 151 到修订版 250。

两个存储库的完整历史记录都是保留者，只有第二个导入的存储库的修订号会更改。

当然，这同样适用于两个以上的存储库。

编辑：我在您编辑时发布了，所以我没有看到您的注释...

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-10T17:01:04.013

您可以通过以下步骤在一个存储库中加载多个转储文件。

存储库根：

```
 projectA
    branches 
    tags
    trunk
 projectB
    branches
    tags
    trunk 
```

首先，您必须在存储库根目录中创建目录（项目 A，项目 B），如下所示：

```
$ svn mkdir -m "Initial project root" \
file:///var/svn/repository_root/Project_A\
file:///var/svn/repository_root/Project_B\
file:///var/svn/repository_root/Project_C\

Revision 1 committed. 
```

之后，您可以加载转储文件：

使用参数`--parent-dir DIRECTORY`

```
$ svnadmin load /var/svn/repository_root --parent-dir Project_A < file-dump-PRJA.dump
…
$ svnadmin load /var/svn/repository_root --parent-dir Project_B < file-dump-PRJB.dump 
```

这样，您将拥有一个包含许多转储存储库的存储库。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-06T00:53:42.983

如果您无权访问 svnadmin，这将很难但可行。假设您有存储库 A 和 B，并希望将它们合并到存储库 C。这是您必须使用的步骤来完成此操作。

1.  将存储库 A 的修订版 1 检出到您的硬盘。

2.  在 C 存储库的根目录上创建一个名为 Repository_A 的目录，并将其签出到本地硬盘。

3.  将文件从您签出的 A（减去）.svn 文件复制到您签出的 C，在 Repository_A 文件夹中。

4.  在 C 上执行提交。

将存储库 A 的工作副本更新为修订版 2 ，并执行步骤 3 和 4，并在每个后续修订版中重复，直到到达头部。

现在对 B 做同样的事情。

这基本上与@Davide Gualano 建议的一样，不需要 svnadmin。您可能可以编写一个简单的脚本来为您执行此操作，如果没有很多修订，您可以手动执行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-29T00:17:43.030

这个问题的其他答案使我能够制作下面的脚本。为您的案例调整 REPOS 地图。此外，您可能希望将标签和分支移动到“预聚合”目录中，而不是直接移动到新的分支和主干中。

```
#!/bin/bash

NEWREPO=$(pwd)/newrepo
NEWREPOCO="${NEWREPO}_co"
DUMPS=repodumps
REV="0:HEAD"
REPOROOT=/data/svn/2.2.1/repositories/
TOOLDIR=/opt/svn/2.2.1/bin/
PATH=${PATH}:${TOOLDIR}

# Old Repository mapping 
declare -A REPOS=( 
    [BlaEntityBeans]='(
        [newname]="EntityBeans"
    )'
    [OldServletRepoServlet]='(
        [newname]="SpreadsheetImportServlet"
    )'
    [ExperimentalMappingXML]='(
        [newname]="SpreadsheetMappingXML"
    )'
    [NewImportProcess]='(
        [newname]="SpreadsheetImportProcess"
    )'    
)

dump() {
    rm -fr ${DUMPS}
    mkdir ${DUMPS}
    for repo in "${!REPOS[@]}"
    do
        local dumpfile=${DUMPS}/${repo}.dmp
    echo "Dumpimg Repo ${repo} to ${dumpfile}"
        svnadmin dump -r ${REV} ${REPOROOT}/${repo} > ${dumpfile}
    done
}

loadRepos() {
    # new big repo
    rm -fr ${NEWREPO}
    svnadmin create ${NEWREPO}
    svn mkdir file:///${NEWREPO}/trunk -m ""
    svn mkdir file:///${NEWREPO}/branches -m ""
    svn mkdir file:///${NEWREPO}/tags -m ""

    # add the old projects as modules
    for currentname in "${!REPOS[@]}"
    do  
        declare -A repo=${REPOS[$currentname]}
        local newname=${repo[newname]}
        echo "Loading repo ${currentname} soon to be ${newname}"
        dumpfile=${DUMPS}/${currentname}.dmp

        # import the current repo into a trmporary root position
        svn mkdir file:///${NEWREPO}/${currentname} -m "Made module ${currentname}"
        svnadmin load --parent-dir ${currentname} ${NEWREPO} < ${dumpfile}

        # now move stuff arround
        # first rename to new repo
        svn move file:///${NEWREPO}/${currentname} file:///${NEWREPO}/${newname} -m "Moved ${currentname} to ${newname}"
        # now move trunk, branches and tags
        for vc in {trunk,branches,tags}
        do
            echo "Moving the current content of $vc into ${NEWREPO}/${vc}/${newname}"
            svn move file:///${NEWREPO}/${newname}/${vc} file:///${NEWREPO}/${vc}/${newname} -m "Done by $0"
        done
    svn rm  file:///${NEWREPO}/${newname} -m "Removed old ${newname}"
    done
}

dump
loadRepos 
```

# c++ - Visual Studio 2008下的C++项目结构

> ID：267259
> 
> 赞同：3
> 
> 时间：2008-11-06T00:19:46.767
> 
> 标签：c++, project, structure

所以，我已经从事 Java 多年了，但现在我开始了一个 C++ 项目。我正在尝试确定设置所述项目的最佳实践。

在项目中，您通常如何构建他们的代码？您是否使用命名空间文件夹执行 Java 风格并以这种方式分解您的源代码？您是否将公共标头保存在包含目录中以便于参考？

我已经看到了这两种方法和其他方法，但是对于大型项目来说，什么是好的方法？

此外，您如何处理应用程序结构中的资源/文件夹？`log`最终项目安装一个用于存储日志的`lib`文件夹，可能是一个用于存储库文件的文件夹，可能是一个用于数据的文件夹，这一切都很好`data`，但是您如何管理项目中的这些位？有没有办法定义它，所以当您构建解决方案时，它会为您构建结构？或者，您是否只需进入您构建的配置文件夹（调试、发布等），并手动构建文件结构，从而确保您的 EXE 文件期望找到的路径正确定位？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T00:33:49.000

我在[这里](https://stackoverflow.com/questions/266202/how-to-organize-the-project-tree-for-a-c-project-using-nmake)也有一个相关但不同的问题。我说的是 nmake，但实际上它是任何构建系统：Scons、Bakefile、nmake、Ant、vcproj

我通常构建代码的方式是通过应用程序或 DLL 中的“模块”。我不倾向于使用命名空间，但这并不意味着你不应该。

在 IDE 中，我有这样的东西：

```
/solution
   /prj1
      /headers
        /module1
        /module2
      /resource
      /source
        /module 1
        /module 2
      /test
   /prj2
      /headers
        /module1
        /module2
      /resource
      /source
        /module 1
        /module 2
      /test 
```

在文件系统上，我有这样的东西：

```
/solution
    /prj1
       /bin
       /build
       /include
          /module1
          /module2
       /lib
       /res
       /src
          /module1
          /module2
       /test
    /prj2
       /bin
       /build
       /include
          /module1
          /module2
       /lib
       /res
       /src
          /module1
          /module2
       /test 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T00:46:28.177

我们倾向于使每个组件成为一个解决方案，包含一个或多个项目（或子组件）和一个测试项目。测试项目包含所有单元测试。

然后我们根据模块和组件将解决方案排列成树，例如：

```
//depot/MyProject/ASubSystem/AComponentOfTheSubSystem/ASubComponentWithAVSSolution 
```

然后，该解决方案将包含几个 Visual Studio 项目：

```
//depot/MyProject/ASubSystem/AComponentOfTheSubSystem/ASubComponentWithAVSSolution/Something
//depot/MyProject/ASubSystem/AComponentOfTheSubSystem/ASubComponentWithAVSSolution/SomethingElse
//depot/MyProject/ASubSystem/AComponentOfTheSubSystem/ASubComponentWithAVSSolution/TestTheSolution 
```

树的深度可能更大或更小，具体取决于组件/子组件的数量。我们也倾向于在子系统和子组件级别有一个“通用”解决方案，其中包含通用的可重复使用的东西。

然后，我们有一个子系统级解决方案，它将所有内容联系在一起以构建子系统。

我们不使用或导出到“包含”目录。我们让 Visual Studio 在我们的沙箱中构建和链接。我们有一个单独的“发布”沙箱，以确保我们不会意外链接错误的库。

# asp.net-mvc - 具有相同名称的 MVC 视图问题/错误

> ID：267262
> 
> 赞同：0
> 
> 时间：2008-11-06T00:21:11.473
> 
> 标签：asp.net-mvc, views

我一直在为一个新网站使用 ASP.net MVC。

我发现视图具有相同名称但位于不同文件夹中的一个小问题，即 Views/Home/Index.aspx 和 Views/Account/Index.aspx 当有定义时，代码隐藏文件就像是部分类对于相同的事件或函数（即 PageLoad 事件）。我通过显式为代码隐藏文件（使用文件夹名称）提供命名空间并更新标记页面中的引用来避免此问题。

但就像我说的，这很烦人。有什么我做的不对吗？或者这只是测试版软件中的一个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T00:30:23.267

不，这不是测试版软件中的错误。它与 MVC 或一般的 ASP.NET 无关。从本质上讲，您的问题归结为您希望拥有两个具有相同名称的不同类。这样做的唯一方法是将它们放在不同的名称空间中。

# opengl - glDrawPixels/glCopyPixels 获得放大视图，产生严重钳位的图像

> ID：267275
> 
> 赞同：0
> 
> 时间：2008-11-06T00:26:50.947
> 
> 标签：opengl, gldrawpixels

尽管有一个较早的问题（[问here](https://stackoverflow.com/questions/223894/opengl-rotation-using-gldrawpixels)），但我们的项目仅限于使用glDrawPixels，因此我们必须做一些hackery。

功能要求之一是能够在图像的单击区域上显示放大视图；所以，看着图像，我想点击鼠标，并在鼠标所在的位置显示 200% 的图像窗口。当我拖动光标时，窗口应该跟随光标。

上下文设置如下：

大红皮书的代码如下所示：

```
 Gl.glShadeModel(Gl.GL_FLAT);
        Gl.glClearColor(0.1f, 0.1f, 0.1f, 0.0f);
        Gl.glPixelStorei(Gl.GL_UNPACK_ALIGNMENT, 2);
        Gl.glPolygonMode(Gl.GL_FRONT_AND_BACK, Gl.GL_LINE);

        Gl.glDisable(Gl.GL_SCISSOR_TEST);
        Gl.glDisable(Gl.GL_ALPHA_TEST);
        Gl.glDisable(Gl.GL_STENCIL_TEST);
        Gl.glDisable(Gl.GL_DEPTH_TEST);
        Gl.glDisable(Gl.GL_BLEND);
        Gl.glDisable(Gl.GL_DITHER);
        Gl.glDisable(Gl.GL_LOGIC_OP);
        Gl.glDisable(Gl.GL_LIGHTING);
        Gl.glDisable(Gl.GL_FOG);
        Gl.glDisable(Gl.GL_TEXTURE_1D);
        Gl.glDisable(Gl.GL_TEXTURE_2D);
        Gl.glPixelTransferi(Gl.GL_MAP_COLOR, Gl.GL_TRUE);
        Gl.glPixelTransferf(Gl.GL_RED_SCALE, 1.0f);
        Gl.glPixelTransferi(Gl.GL_RED_BIAS, 0);
        Gl.glPixelTransferf(Gl.GL_GREEN_SCALE, 1.0f);
        Gl.glPixelTransferi(Gl.GL_GREEN_BIAS, 0);
        Gl.glPixelTransferf(Gl.GL_BLUE_SCALE, 1.0f);
        Gl.glPixelTransferi(Gl.GL_BLUE_BIAS, 0);
        Gl.glPixelTransferi(Gl.GL_ALPHA_SCALE, 1);
        Gl.glPixelTransferi(Gl.GL_ALPHA_BIAS, 0); 
```

然后调用使较小但缩放的图像看起来像

```
 int width = (int)((this.Width * 0.2)/2.0);
        Gl.glReadBuffer(Gl.GL_FRONT_AND_BACK);
        Gl.glRasterPos2i(0, 0);
        Gl.glBitmap(0, 0, 0, 0, mStartX - (width*2), mStartY, null);

        Gl.glPixelZoom(2.0f, 2.0f);
        Gl.glCopyPixels(mStartX - width, mStartY, width, width, Gl.GL_COLOR); 
```

其中 mStartY 和 mStartX 是点击发生的点。

问题是，显示的窗口实际上是在破坏查找表，并且实际上将图像压缩到本质上是黑白二值图像（即，没有灰色阴影）。

数据是一个黑白无符号短数组，并使用以下代码设置：

```
 float step = (65535.0f / (float)(max - min));
        mColorTable = new ushort[65536];
        int i;
        for (i = 0; i < 65536; i++)
        {
            if (i < min)
                mColorTable[i] = 0;
            else if (i > max)
                mColorTable[i] = 65535;
            else
                mColorTable[i] = (ushort)((float)(i - min) * step);
        }       
        .... //some irrelevant code

        Gl.glPixelMapusv(Gl.GL_PIXEL_MAP_R_TO_R, 65536, mColorTable);
        Gl.glPixelMapusv(Gl.GL_PIXEL_MAP_G_TO_G, 65536, mColorTable);
        Gl.glPixelMapusv(Gl.GL_PIXEL_MAP_B_TO_B, 65536, mColorTable); 
```

现在，根据[这个文档](http://www.ugrad.cs.ubc.ca/~cs414/opengl/glCopyPixels.html)，我应该使用 GL_PIXEL_MAP_I_TO_I 并将 INDEX_SCALE 和 INDEX_BIAS 设置为零，但这样做不会改变结果，即图像被严重钳位。所谓“严重钳制”，我的意思是它不是黑色就是白色，只有很少的灰色阴影，但原始未放大的图像看起来像预期的那样。

那么，如何避免放大视图的钳位呢？我应该创建一个跟随光标并用第一个控件的数据填充的第二个控件吗？这种方法似乎会将数组副本从图形卡带到 C# 中，这几乎按照定义会变慢，因此使控件无响应。

哦，我正在使用 C# 和 Tao 框架，如果这很重要的话。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-14T15:41:38.237

这是答案。问题是 LUT 被应用了两次，所以在调用副本之前，调用：

```
Gl.glPixelTransferi(Gl.GL_MAP_COLOR, Gl.GL_FALSE); 
```

然后，一旦完成，调用：

```
Gl.glPixelTransferi(Gl.GL_MAP_COLOR, Gl.GL_TRUE); 
```

这样，我所描述的“极端钳制”就被删除了。

@thing2k-您的解决方案导致复制发生在显卡外部，因此会减慢鼠标拖动时的绘图速度，但不能修复双钳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T07:37:03.577

拜托，非常拜托，在顶部和整个表面涂上大量的糖、糖浆、糖屑和高果糖玉米糖浆雾，解释*为什么*你不能只使用**纹理映射**来绘制这个图像。

纹理映射是 OpenGL 的核心、基本、日常、普通、普通、标准、典型、预期和一般不错的特性。它在 1.4 版中。为什么不以它为起点呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T22:40:56.140

如果我理解正确，那么这应该接近你所追求的，使用 glReadPixels 和 glDrawPixels。

抱歉，它是 C++ 而不是 C#，但 OpenGL 函数应该还是一样的。

```
// main.cpp
// glut Text

#ifdef __WIN32__
    #define WIN32_LEAN_AND_MEAN
    #include <windows.h>
#endif
#include <GL/glut.h>
#include <cstdio>

int WIDTH = 800;
int HEIGHT = 600;
int MouseButton, MouseY = 0, MouseX = 0;
const int size = 80;
char *image, rect[size*size*3];
int imagewidth, imageheight;

bool Init()
{
    int offset;
    FILE* file = fopen("image.bmp", "rb");
    if (file == NULL)
        return false;
    fseek(file, 10, SEEK_SET);
    fread(&offset, sizeof(int), 1, file);
    fseek(file, 18, SEEK_SET);
    fread(&imagewidth, sizeof(int), 1, file);
    fread(&imageheight, sizeof(int), 1, file);
    fseek(file, offset, SEEK_SET);
    image = new char[imagewidth*imageheight*3];
    if (image == NULL)
        return false;
    fread(image, 1, imagewidth*imageheight*3, file);
    fclose(file);
    return true;
}

void Reshape(int width, int height)
{
    WIDTH = width;
    HEIGHT = height;
    glViewport(0 , 0, width, height);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(0, width, 0, height);
}

void Display()
{
    int size2 = size/2;

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glRasterPos2i(0,0);
    glPixelZoom(1.f, 1.f);
    glDrawPixels(imagewidth, imageheight, 0x80E0/*GL_RGB*/, GL_UNSIGNED_BYTE, image);
    glReadPixels(MouseX-size2, MouseY-size2, size, size, GL_RGB, GL_UNSIGNED_BYTE, rect);
    glPixelZoom(2.f, 2.f);
    glRasterPos2i(MouseX-size, MouseY-size);
    glDrawPixels(size, size, GL_RGB, GL_UNSIGNED_BYTE, rect);
    glFlush();
    glutSwapBuffers();
}

void Mouse(int button, int state, int x, int y)
{
    if (state == GLUT_DOWN)
        MouseButton &= (1<<button);
    else
        MouseButton &= ~(1<<button);
}

void MouseMove(int x, int y)
{
    MouseX = x;
    MouseY = HEIGHT - y;
}

int main(int argc, char* argv[])
{
    glutInit(&argc, argv);
    if (Init() == false)
        return 1;
    glutInitWindowSize(WIDTH, HEIGHT);
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGBA);
    glutCreateWindow("glut_Text");
    glClearColor(0.25, 0.25, 0.25, 1.0);
    glutReshapeFunc(Reshape);
    glutDisplayFunc(Display);
    glutIdleFunc(Display);
    glutMouseFunc(Mouse);
    glutMotionFunc(MouseMove);
    glutPassiveMotionFunc(MouseMove);

    glutMainLoop();
    return 0;
} 
```

希望这可以帮助。

# unix - Unix C Shell 脚本 printf 帮助

> ID：267287
> 
> 赞同：2
> 
> 时间：2008-11-06T00:31:50.407
> 
> 标签：unix, shell

试图从正确对齐的 2 个不同变量中打印出一个值列表。

```
foreach finalList ($correctList $wrongList)
printf "%20s%s\n" $finalList
end 
```

这会将它们打印出来并对齐，但它是一个接一个。我如何让它遍历每个列表中的每个项目，然后转到新行？

我希望它们最终看起来像这样：

```
Correct    Incorrect
Good1      Bad1
Good2      Bad2
Good3      Bad3 
```

好的来自正确的列表 坏的来自错误的列表

摆脱 \n 使它像这样：

```
Good1     Bad1    Good2    Bad2 
```

我只想要2列。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T00:58:05.253

您可以像这样同时遍历两个列表：

```
# Get the max index of the smallest list
set maxIndex = $#correctList
if ( $#wrongList < $#correctList ) then
  set maxIndex = $#wrongList
endif

set index = 1
while ($index <= $maxIndex)
  printf "%-20s %s\n" "$correctList[$index]" "$wrongList[$index]"
  @ index++
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T00:42:07.127

尝试摆脱 \n

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T17:40:15.060

我相信带有 -m 选项的 pr(1) 命令会帮助你做你想做的事。查看其手册页以消除页眉/拖车选项并设置列宽。

另外，我建议您不要使用 C-Shell 编写脚本；您会发现 sh 语法 shell（sh、bash、ksh 等）更加一致且更易于调试。

# asp.net - RESTful URL、母版页和 PreviousPage 问题

> ID：267303
> 
> 赞同：0
> 
> 时间：2008-11-06T00:38:13.017
> 
> 标签：asp.net, javascript, asp.net-mvc, rest

我正在使用 MVC（预览版 5）构建我的 asp.net Web 应用程序，并且还在使用母版页概念。

我的 PageA 和 PageB 都是内容页面。我正在通过JavaScript从PageA到PageB的方法中提交表单。PageB 的 PreviousPageType 属性设置为 PageA，但是当我访问 PageB 中的 PreviousPage 属性时，它返回 null。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T06:31:12.100

我假设您想访问 PageB 中 PageA 的数据。您可以将数据包装在一个对象中，并使用 Scott Gu 的[Form Posting Scenarios](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)中所述的模型绑定器将其传递给控制器​​。然后，您可以重定向以显示 PageB。

高温下，

苏尼尔·乌尼坦

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T11:20:34.653

您可以使用 TempData 存储下一个请求需要访问的对象，这就是我避免在序列页面之间传递大块数据的方法。

# java - java.net 与 java.nio

> ID：267306
> 
> 赞同：16
> 
> 时间：2008-11-06T00:38:50.237
> 
> 标签：java, networking, io, nio

什么时候从 java.net 切换到 java.nio 更好？.net（不是微软实体）更容易理解和熟悉，而 nio 是可扩展的，并带有一些额外的漂亮功能。

具体来说，我需要针对这种情况做出选择：我们有一个控制中心管理多个远程站点的硬件（每个站点都有一台计算机管理多个硬件单元（收发器、TNC 和旋转器））。我的想法是在每台机器上编写一个服务器应用程序，作为从控制中心到无线电硬件的网关，每个单元都有一个插座。根据我的理解，NIO 是针对一台服务器，多台客户端，但我想的是一台客户端，多台服务器。

我想第三种选择是使用 MINA，但我不确定这是否会在一个简单的问题上投入过多。

* * *

每个远程服务器最多有 8 个连接，都来自同一个客户端（用于控制所有硬件和单独的 TX/RX 套接字）。但是，单个客户端将希望同时连接到多个服务器。与其将每个服务器放在不同的端口上，是否可以在客户端使用通道选择器，或者在客户端使用多线程 io 并以不同方式配置服务器是否更好？

* * *

实际上，由于远程机器仅用于与其他硬件交互，RMI 或 IDL/CORBA 会是更好的解决方案吗？真的，我只是希望能够从硬件发送命令和接收遥测数据，而不必编写一些应用层协议来做到这一点。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-06T23:56:03.397

避免使用 NIO，除非您有充分的理由使用它。 [这不是很有趣，也可能没有你想象的那么有益](http://blog.uncommons.org/2008/09/03/avoid-nio-get-better-throughput/)。一旦处理数以万计的连接，您可能会获得更好的可扩展性，但在较低的数量下，您可能会通过阻塞 IO 获得更好的吞吐量。不过，与往常一样，在做出您可能会后悔的事情之前，请先进行自己的测量。

还有一点需要考虑的是，如果你想使用 SSL，NIO 会非常痛苦。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-06T01:00:20.210

可扩展性可能会推动您选择软件包。java.net 每个套接字需要一个线程。编码它会容易得多。java.nio 效率更高，但编写代码可能很麻烦。

我会问自己，您希望处理多少个连接。如果它相对较少（例如，< 100），我会选择 java.net。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-10T01:54:07.700

现在几乎没有理由从头开始编写这种网络代码。[与手工制作的解决方案相比， netty.io 之](http://netty.io/)类的软件包几乎总能以更少的代码行数为您提供更可靠、更灵活的代码。此外，使用 Netty，您可以获得 SSL 支持，而不会使您的实施复杂化。像 netty 这样的库也几乎完全消除了“异步与线程”的问题，为您提供了良好的性能，并且仍然允许您根据需要调整线程模型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T01:42:08.893

你所说的连接数告诉我你应该使用java.net。确实，没有理由使用非阻塞 I/O 来复杂化您的任务。（除非您的远程系统功能不足，但是为什么要在它们上使用 Java？）

看看[Apache 的 XML-RPC](http://ws.apache.org/xmlrpc/)包。它易于使用，对您完全隐藏网络内容，并且可以通过良好的 HTTP 运行。无需担心协议问题……这一切看起来都像是对您的方法调用，在两端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T10:28:58.673

鉴于所涉及的连接数量很少，java.net 听起来是正确的解决方案。

其他张贴者谈到了使用 XML-RPC。如果要传送的数据量很小，这是一个不错的选择，但是在编写传送大量数据的进程间通信（例如，大请求/响应，或频繁的少量数据）。XML 解析的成本通常比更优化的有线格式（例如 ASN.1）高几个数量级。

对于低容量控制应用程序，XML-RPC 的简单性应该超过性能成本。对于大容量数据通信，最好使用更有效的有线协议。

# java - HashMap 和字典 ADT 的区别

> ID：267312
> 
> 赞同：64
> 
> 时间：2008-11-06T00:40:31.700
> 
> 标签：java, data-structures

哈希映射和字典 ADT 有什么区别。以及何时更喜欢一个。对于我的编程任务，我的导师要求使用其中之一，但我认为两者之间没有任何区别。该程序应该与一个巨大的没有。的字符串。有什么建议么？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-11-17T22:06:13.513

在 Java 中，类`HashMap`和类`Dictionary`都是“映射”抽象数据类型的*实现*。抽象数据类型并不特定于任何一种编程语言，Map ADT 也可以称为哈希、字典或关联数组（其他位于[http://en.wikipedia.org/wiki/Associative_array](http://en.wikipedia.org/wiki/Associative_array)）。（请注意，我们在`Dictionary`类和 Dictionary ADT 之间进行了区分。）

该类`Dictionary` *已*被标记为已过时，因此最好不要使用它。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-06T00:56:47.050

这篇 Stack Overflow 帖子很好地解释了主要区别：

[Java hashmap vs hashtable](https://stackoverflow.com/questions/40471/java-hashmap-vs-hashtable)

请注意，Hashtable 只是 Dictionary ADT 的一个实现。另请注意，Java 认为 Dictionary ["obsolete"](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Dictionary.html)。

Hashtable 是同步的这一事实对大多数用途来说并没有给你带来太多好处。使用哈希映射。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-06T00:54:54.730

在 Java 中，HashMap 实现了 Map 接口，而 Dictionary 没有。这使得 Dictionary 已过时（根据 API 文档）。也就是说，它们都执行类似的功能，所以你说得对，它们看起来非常相似...... HashMap 是一种字典。

不过建议您使用 HashMap。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-07T12:14:13.823

Map 是 Java 中 ADT 的接口，*与维护 <key, value> 对的通用语言无关的数据结构相同*，并在 Java 1.2 中引入。

Dictionary（不是 Map 的实现）是一个抽象类，目的与 JDK 1.0 中早先介绍的相同。它拥有的唯一子类是 Hashtable，它本身正在实现 Map。尽管如此，Dictionary 类现在已经过时了，你可能会忘记它。

Map 和 Dictionary 的函数成员之间存在差异，但是您可能会发现 HashMap 和 Hashtable 之间的差异更有用。[在这里](https://stackoverflow.com/questions/40471/differences-between-hashmap-and-hashtable)你可以找到不同之处。

# cocoa - 创建 OS X 服务

> ID：267318
> 
> 赞同：4
> 
> 时间：2008-11-06T00:46:24.043
> 
> 标签：cocoa, macos

我正在尝试创建 OS X 服务。我在 Apple 的文档中找到了[提供系统服务](http://developer.apple.com/documentation/Cocoa/Conceptual/SysServices/Tasks/providing.html#//apple_ref/doc/uid/20000853)，但是我发现它并不清楚我到底需要做什么。我目前正在使用应用程序来注册我的服务（认为这会更直接 - 最终我想创建一个 .service），但是即使在注销/登录后我的服务仍然没有出现在列表中菜单中的服务。

我缺少的链接文档中是否缺少某些步骤？我觉得有一些注册步骤，以便操作系统知道我的服务（除了该文档中列出的内容），但我找不到任何东西。

提前致谢。:)

编辑：这是我的 Info.plist 文件中的 NSServices 字典：

```
 <key>NSServices</key>
<array>
    <dict>
        <key>NSPortName</key>
        <string>POPrlTest</string>
        <key>NSMessage</key>
        <string>shortenUrlService</string>
        <key>NSSendTypes</key>
        <string>NSStringPboardType</string>
        <key>NSReturnTypes</key>
        <string>NSStringPboardType</string>
        <key>NSMenuItem</key>
        <dict>
            <key>default</key>
            <string>Shorten URL</string>
        </dict>
    </dict>
</array> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T05:22:49.227

确保你的 NSServices 字典有它需要的一切。如果您不确定，请发布它，以便我们告诉您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T20:48:17.410

确保您首先启动您的应用程序以让系统看到服务。确保您使用 setServicesProvider 在您的应用程序中注册服务处理程序：

此外，请检查控制台日志，因为这可能会为您提供一些有用的错误信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T01:06:51.023

您可能想查看一些商业产品来帮助您解决此问题。[请参阅Fun Script](http://pmougin.wordpress.com/2008/01/28/become-a-mac-os-x-services-ninja/)上的此帖子。

# visual-studio - 无法将文件拖到解决方案资源管理器

> ID：267323
> 
> 赞同：25
> 
> 时间：2008-11-06T00:48:55.163
> 
> 标签：visual-studio, visual-studio-2008

我遇到了一个不寻常的问题。我一直能够将文件和文件夹从我的桌面或资源管理器拖到 Visual Studio 中的解决方案资源管理器中，并将文件添加到我的项目中。不，当我尝试拖动文件时，我只会得到“停止”符号。

我正在使用在 Vista Home Premium 64 位上运行的 Visual Studio 2008。

有任何想法吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-08T21:25:47.727

如果只有其中一个窗口以管理员身份运行，Windows 将不允许您从一个窗口拖动到另一个窗口。

您是否以管理员身份运行 Visual Studio？

**简而言之：以****非管理员**身份运行 Visual Studio 。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-07T17:56:23.407

当您的项目正在运行时，您不能这样做。是吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-25T16:15:19.067

在管理模式下运行时，我也无法将文件从资源管理器拖放到 Visual Studio。

但请尝试从 Visual Studio 的解决方案资源管理器/管理器上下文菜单中打开“添加/现有项目...”，然后从该窗口拖放文件和文件夹。

使用 Visual Studio 2012 在我的机器上工作...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-28T12:53:01.030

我遇到了同样的问题，并注意到我正在从压缩的文件夹中提取文件。我解压缩了所有文件，并且能够很好地拖放到解决方案资源管理器中。确保您的文件不在压缩文件夹中的查看模式下。

# http - 如何在我的计算机发送到页面的原始 HTTP 中查看 POST 方法？

> ID：267326
> 
> 赞同：11
> 
> 时间：2008-11-06T00:51:15.080
> 
> 标签：http, post, methods

而已

当我执行 POST 方法时，没有办法查看浏览器发送到网站的原始文本文件吗？

就像是：

POST /path/script.cgi HTTP/1.0
来自：frog@jmarshall.com
用户代理：HTTPTool/1.0
内容类型：application/x-www-form-urlencoded
内容长度：32
home=Cosby&favorite+flavor=flies

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-06T00:53:18.460

您需要一个代理，例如[Fiddler](http://www.fiddlertool.com/)。Fiddler 是一个免费软件 HTTP 调试代理，它允许您检查所有 HTTP 流量、设置断点以及“摆弄”传入或传出数据。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T01:03:09.720

[Firebug](http://getfirebug.com/)也是 Firefox 的一个很好的补充，它可以让您查看 HTTP 流量以及页面的许多其他方面。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T01:06:18.763

在这种情况下可能有点矫枉过正，但您可能想查看[Wireshark](http://www.wireshark.org/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T00:59:20.757

结帐[HttpFox](https://addons.mozilla.org/en-US/firefox/addon/6647)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-06T01:04:00.547

[Live HTTP Headers](http://livehttpheaders.mozdev.org/)是一个不错的 Firefox 插件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T03:55:18.530

我不敢相信没有人提到[tcpdump](http://www.tcpdump.org/)或[wireshark](http://www.wireshark.org/)（以前称为 Ethereal 的工具）。也有一段时间，有几篇文章说每个网络管理员都应该有一台只运行 Etherpeek 的 Mac（现在称为[OmniPeek](http://www.wildpackets.com/products/overview)，在 windows 上运行而不是在 mac 上运行）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T01:07:16.983

还有用于 Firefox 的[Tamper Data](https://addons.mozilla.org/en-US/firefox/addon/966)插件

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T02:50:19.037

[TCPMon](http://ws.apache.org/commons/tcpmon/index.html)是一个基于 Java 的 TCP 代理，不像 Fiddler 看起来那样功能齐全，但可以在任何带有 JVM 的东西上运行。

# iphone - ScrollView 中的 UIWebView 不会重绘

> ID：267330
> 
> 赞同：3
> 
> 时间：2008-11-06T00:54:14.340
> 
> 标签：iphone, cocoa-touch

我在 UIScrollView 中有 UIWebView。然后当我滚动时，Web 视图正确显示了前两页，但只绘制了第三页的一半。如果我点击 web 视图，它会绘制内容，或者如果我调用`-[UIWebView reload]`，`-scrollViewDidEndDecelerating`它会显示内容。

有什么办法可以让网页视图正确绘制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T01:30:55.603

UIWebViews 不能同时加载。您必须加载一个，等待它完成，然后加载下一个，依此类推。

您可以在计时器上执行此操作，或者等到滚动的 UIWebView 具有焦点后再加载数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T09:53:02.630

所有 UIView 的大小限制为 1024x1024 像素。这在 UIView 文档的概述部分的末尾进行了说明。

如果您的 Web 视图必须包含超过 1024 像素的内容，则必须将其从父滚动视图中取出并让它自己管理滚动。

# compiler-construction - 使用语法导向的翻译方案将整数转换为罗马数字？

> ID：267351
> 
> 赞同：9
> 
> 时间：2008-11-06T01:03:20.233
> 
> 标签：compiler-construction, roman-numerals, translation-scheme

Dragon Book 包括一个使用语法指导的翻译方案将整数转换为罗马数字的练习。

这怎么能完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-10-22T15:48:10.130

接下来是表示从 1xxx 格式的数字到罗马数字的语法定向翻译的语法。

*数字 = 千位 3 位 2 位 1 | nzdigit3 digit2 digit1 | nzdigit2 digit1 | nzdigit1*

> 一千 -> 1 {print('M')}
> 
> digit3 -> 0 digit3 -> nzdigit3
> 
> nzdigit3 -> 1 打印('C') nzdigit3 -> 2 打印('CC') nzdigit3 -> 3 打印('CCC') nzdigit3 -> 4 打印('CCCC') nzdigit3 -> 5 打印('D') nzdigit3 -> 6 打印('DC') nzdigit3 -> 7 打印('DCC') nzdigit3 -> 8 打印('DCCC') nzdigit3 -> 9 打印('DCCCc')

以类似的方式为 2 和 1 位置的数字编写定义，您将需要翻译。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-09T07:10:46.373

另一种方法是将 1、5、10、50、100、500、1000 等罗马数字存储在二维数组中。示例（在 PHP 数组中）：

```
$roman = array(
  [0] = array( 1=>"I", 5=>"V", 10=>"X" ),
  [1] = array( 1=>"X", 5=>"L", 10=>"C" ),
  [2] = array( 1=>"C", 5=>"D", 10=>"M" ),
  [3] = array( 1=>"M", 5=>"^V", 10=>"^X" ),
); 
```

然后从右到左取每个数字并应用以下翻译。设置变量 $level = 0 并在处理完每个数字后将其值增加 1：

```
1 => $roman[$level][1]
2 => $roman[$level][1].$roman[$level][1]
3 => $roman[$level][1].$roman[$level][1].$roman[$level][1]
4 => $roman[$level][1].$roman[$level][5]
5 => $roman[$level][5]
6 => $roman[$level][5].$roman[$level][1]
7 => $roman[$level][5].$roman[$level][1].$roman[$level][1]
8 => $roman[$level][5].$roman[$level][1].$roman[$level][1].$roman[$level][1]
9 => $roman[$level][1].$roman[$level][10] 
```

（在 PHP 中，一个 '.' 连接两个字符串）

示例：1945 年

```
5 => $roman[0][5] = "V"
4 => $roman[1][1].$roman[1][5] = "XL"
9 => $roman[2][1].$roman[2][10] = "CM"
1 => $roman[3][1] = "M" 
```

所以翻译后的数字是“MCMXLV”

抱歉，这可能无法完全回答您的问题，但我希望它对您有所帮助..

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T03:49:51.053

我会考虑从右到左解析。

首先，我将映射单位列：

```
0 -> ''
1 -> 'I'
2 -> 'II'
3 -> 'III'
4 -> 'IV'
...
9 -> 'IX' 
```

然后，如果有第二列（例如，从右边数第二列 = 十列），我会用它来映射到

```
0 -> ''
1 -> 'X'
2 -> 'XX'
...
9 -> 'XC' 
```

这需要预先添加到初始输出中。

重复下一列（数百、数千），直到用完字母。

仔细检查数字不是“0”或负数。

# .net - .net 实体框架与 LinqToSql 相比如何？

> ID：267357
> 
> 赞同：10
> 
> 时间：2008-11-06T01:04:17.627
> 
> 标签：.net, linq, linq-to-sql, entity-framework, .net-3.5

我听说实体框架是矫枉过正，或者与 LinqToSql 相比，它很难学习。

我想知道以什么方式？我使用了 LinqToSql 并喜欢它。所以，我正在尝试 EF，而对于我正在做的事情，它们看起来几乎完全相同。命名空间和方法名称不同，但到目前为止，我没有看到任何使 EF 比 LinqToSql 更难的东西。

我敢肯定，如果我开始做更复杂的事情，它会变得更复杂。但话又说回来，我可能根本无法用 LinqToSql 做同样的事情，所以我认为这是 EF 的一个优点，以防万一我想做更复杂的事情。

EF 是否使用了比 LinqToSql 更多的资源，以至于如果我只需要类似 LinqToSql 的功能，我就不应该使用它？

更新：我做了一些测试，我的测试似乎表明 Linq to Entities 的性能优于 Linq to SQL。

我首先从单个表中删除 1000 条记录，添加 1000 条记录，编辑 1000 条记录，然后将它们数据绑定到 DataView。LinqToSQL：5 秒 LinqToEntities：2 秒

我使用两个连接表执行了相同的测试，结果相似。

我的测试似乎支持另一个帖子： [Linq To Sql vs Entity Framework Performance](https://stackoverflow.com/questions/257016/linq-to-sql-vs-entity-framework-performance)

更新 2：

感谢您的回复。在我看来，与 Linq to SQL 相比，Linq to Entities 并没有真正矫枉过正。在研究了更多之后，我认为使用 Linq to Entity 是要走的路。它似乎有更好的性能。

我相信我听到的“矫枉过正”的说法是因为 Linq to Entities 可以比 Linq To SQL 做更多的事情，而且它确实需要更多的配置（web.config 中大约多 1 行）。此外，Linq to Entities 所做的一些小事情与 Linq to SQL 不同，这可能会让某些人觉得 Linq to Entities 更复杂。但是一旦你学会了如何做事，Linq to Entities 似乎并不比 Linq to SQL 复杂。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-07T16:00:42.983

如果我错了，请纠正我，但实体框架应该只在您需要转换后端对象时发挥作用，例如当您组合来自不同数据源的表、拆分表等时。它添加了实体层所以你可以隐藏所有的管道，只处理你清理过的实体。如果您只是像在 LINQ to SQL 中那样对表使用 1 对 1，那么我确信您不使用的复杂层会减慢它的速度。听起来 LINQ to SQL 是适合您的工作的正确工具，直到您有更复杂的数据源需求。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-30T00:33:42.553

Linq to SQL 和实体框架在概念上是不同的野兽，您应该根据它们如何满足您的需求而不是微基准来做出选择。即使Entity Framework速度较慢，但​​它是微软ADO.NET团队的重点，并将多次改进。Linq-to-SQL 被有效地冻结。

从概念上讲，它们的不同之处在于 Linq-to-SQL 只是一种使用 Linq 执行数据库查询的方式。听起来很明显，但重点是：您正在访问根据其数据库模型结构化的数据。尽管 FK 被适当地转换，但您仍然有多余的对象，其中数据被规范化到不同的表中。您编写的每个查询都必须处理这种事情。

Entity Framework 允许您以声明方式构建一个层，该层以应在内存中表示的方式表示您的数据，将来自多个表的数据带到适当的单个对象中；将多对多关系表示为集合属性等。然后您编写的查询将针对此模型，并且目的更清晰，更明显（不再有 15 个表连接！）。

如果您不确定是否使用 Entity Framework，O'Reilly 将在 2009 年 1 月 15 日出版 Entity Framework 的综合性书籍（预览版现已在 Roughcuts 上提供） - 它的 MSDN 文档目前非常糟糕，这使得提出它变得更加困难. 我确实相信它值得长期使用，除了最微不足道的项目（而且就个人而言，如果我写一些微不足道的东西，我会直接使用 ADO.NET2 并忘记 Linq）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-02-16T10:16:15.973

不过要小心，如果您使用带有分组依据的查询，LinqToEntities 可以做一些非常有趣的事情。我从来没有设法让 LinqToEntities 将 group by 转换为实际的 SQL group by，而是生成一些非常无效的大量代码块。

例如，查看以下链接： [http ://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/bb72fae4-0709-48f2-8f85-31d0b6a85f68](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/bb72fae4-0709-48f2-8f85-31d0b6a85f68)

如果您尝试编写“非平凡的”查询，ObjectQuery.ToTraceString() 是您最好的朋友，以确保 EF 不会在您背后做一些非常愚蠢的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T01:17:32.733

我的回答：对执行简单的获取/编辑/更新序列所花费的时间进行简单的比较。我想你会发现 LINQ to SQL 的速度是原来的两倍。在调查差异时，我做了一个快速比较项目。
结果： 实体框架 8,700 毫秒 LINQ to SQL 3,100 毫秒 数据集 2,000 毫秒

所以对我来说这是一个简单的问题。使用 DataSets 或使用 Linq-Sql - 实体框架甚至没有考虑到它！

[链接文本](http://hackprogrammer.blogspot.com/2008/08/entity-framework-verses-linq-to-sql.html "实体框架与 linq to sql")

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-07T16:16:39.783

在深入了解 Linq To SQL 之前，请查看其项目经理的[这篇文章](http://blogs.msdn.com/adonet/archive/2008/10/31/clarifying-the-message-on-l2s-futures.aspx)。他提出了一个直截了当的问题“LINQ to SQL 死了吗？” 答案并不那么简单。这绝对不是“不”。在我看来更像是“可能”。

我建议您在深入研究 EF（现在称为 Linq To Entities）之前认真考虑 NHibernate，但这是我个人的偏见。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-08-09T18:46:07.133

为什么不用SqlDataReader 做一个普通的SQL 查询并将它们绑定到一个通用列表。似乎 SQL 比任何 ORM 都更加灵活和强大。反正在实践中！！SQL死了吗？这一定是最快的方法，缺点是 sql 字符串，但你工作得更接近金属，感觉比使用任何 ORM 有更多的控制权。感觉像 ORM:s 总是有一些错误，并且使更复杂的查询变得很痛苦，并且比你应该用纯 SQL 完成它们需要更长的时间来编写它们。还是只有我对 ORM:s 不熟悉？

# c# - WPF：消除网格单元格之间的透明度

> ID：267364
> 
> 赞同：1
> 
> 时间：2008-11-06T01:06:55.283
> 
> 标签：c#, .net, wpf

我在 WPF 中有一个网格。网格具有透明背景（必需），并且每个单元格可能具有不同颜色的纯色背景，或者可能没有背景。当我在这些单元格中放置任意内容时，当两个相邻的单元格都具有彩色背景（相同或不同颜色，没关系）时，通常（并且不可预测地）有一条细透明线将它们分开，让您可以看穿网格在那条线上。

有谁知道这怎么可能解决？

编辑：本意是在我的问题中提及它，但我尝试在任何地方和任何地方启用 SnapsToDevicePixels，但无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T01:16:55.217

在没有看到任何代码的情况下，我的猜测是您需要在网格中的元素上使用[SnapsToDevicePixels](http://msdn.microsoft.com/en-us/library/system.windows.uielement.snapstodevicepixels.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T08:36:01.490

这会产生相同的问题，但可能不是相同的确切原因。不过，如果我们能解决这个问题，它可能会为您的问题提供提示。

 `````
<Grid Background="Transparent">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="3*" />
            <RowDefinition Height="3*" />
            <RowDefinition Height="3*" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Label Grid.Column="0" Grid.Row="0" Background="PaleGoldenrod" />
        <Label Grid.Column="1" Grid.Row="0" Background="White" />
        <Label Grid.Column="2" Grid.Row="0" Background="PaleGoldenrod" />

        <Label Grid.Column="0" Grid.Row="1" Background="White" />
        <!-- This is in the significant cell -->
        <Label Grid.Column="1" Grid.Row="1" x:Name="SizeChangeLabel" Background="PaleGoldenrod">
            Watch this cell
        </Label>
        <Label Grid.Column="2" Grid.Row="1" Background="White" />

        <Label Grid.Column="0" Grid.Row="2" Background="PaleGoldenrod" />
        <Label Grid.Column="1" Grid.Row="2" Background="White" />
        <Label Grid.Column="2" Grid.Row="2" Background="PaleGoldenrod" />

        <Button x:Name="ReduceContentSize" Grid.Row="3" Grid.Column="0" Click="ReduceContentSize_Click">Reduce</Button>
        <Button x:Name="IncreaseContentSize" Grid.Row="3" Grid.Column="1"   Click="IncreaseContentSize_Click">Increase</Button>
        <TextBlock Grid.Row="3" Grid.Column="2" Foreground="White">
            The window is black
        </TextBlock> 
</Grid> 
```` 

单击事件调整中心单元格中标签的 MinWidth。当你碰到它时，你会得到我认为与你的问题相同的线条。

 `````
private const double _sizeChangeAmount = 150;

    private void IncreaseContentSize_Click(object sender, RoutedEventArgs e)
    {
        SizeChangeLabel.MinWidth = SizeChangeLabel.ActualWidth + _sizeChangeAmount;
        SizeChangeLabel.MinHeight = SizeChangeLabel.ActualHeight + _sizeChangeAmount;   
    }

    private void ReduceContentSize_Click(object sender, RoutedEventArgs e)
    {
        if (SizeChangeLabel.MinWidth > 150)
            SizeChangeLabel.MinWidth = SizeChangeLabel.ActualWidth - _sizeChangeAmount;

        if (SizeChangeLabel.MinHeight > 150)
            SizeChangeLabel.MinHeight = SizeChangeLabel.ActualHeight - _sizeChangeAmount;
    } 
````  `这是一个可以帮助解决问题的合理近似值吗？

# c++ - 在 C++ 中：是否可以在不同的文件中继续命名枚举？

> ID：267367
> 
> 赞同：2
> 
> 时间：2008-11-06T01:10:11.483
> 
> 标签：c++, enums, continue

例如：

基类头文件有：

```
enum FOO
{
FOO_A,
FOO_B,
FOO_C,
FOO_USERSTART
}; 
```

那么派生类有：

```
enum FOO
{
FOO_USERA=FOO_USERSTART
FOO_USERB,
FOO_USERC
}; 
```

只是为了清楚我的用法，它是用于拥有一个事件处理程序，其中基类具有事件，然后派生类可以添加事件。派生类事件处理程序将检查它的事件，如果事件不是它的，那么它会将事件传递给基类。

```
class Base
{
public:
    virtual void HandleFoo(FOO event);
};

class Derived: public Base
{
public:
    void HandleFoo(FOO event);
};

void Base::HandleFoo(FOO event)
{
     switch(event)
     {
     case FOO_A:
       /* do stuff */
     break;
     case FOO_B:
       /* do stuff */
     break;
     case FOO_B:
       /* do stuff */
     break;
     }
 }

void Derived::HandleFoo(FOO event)
{
     switch(event)
     {
     case FOO_USERA:
       /* do stuff */
     break;
     case FOO_USERB:
       /* do stuff */
     break;
     case FOO_USERB:
       /* do stuff */
     break;
     default:
          /* not my event, must be for someone else */
          Base::HandleFoo(event);
     break;
     }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T01:23:09.167

是的，只要枚举都是一个类的成员。如果不是，那么它们将属于同一类型，编译器会非常不高兴。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T10:46:02.447

不，编译器需要能够在看到 } 后决定枚举是否适合 char、short、int 或 long。

所以如果基类头有

```
enum Foo {
  A,
  B,
  MAX = 1<<15
}; 
```

编译器可能会决定枚举适合 16 位。然后它可以使用它，例如在布置基类时。如果您稍后能够将 1<<31 添加到枚举中，则基类枚举成员将无法保存枚举值之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T19:33:21.727

是的，这行得通。为了稍微简化您的代码，我建议使用这种更常见的“扩展”枚举方法：

```
enum FOO // Base class's FOO
{
FOO_A,
FOO_B,
FOO_C,
FOO_BASE_MAX // Always keep this as the last value in the base class
};

enum FOO // Derived class's FOO
{
FOO_USERA=FOO_BASE_MAX+1, // Always keep this as the first value in the derived class
FOO_USERB,
FOO_USERC
};
```

您仍然需要注意“乱序”枚举。（例如：FOO_A=15、FOO_B=11 等）

# web-config - 我可以安全地删除 web.config 的哪些区域？

> ID：267369
> 
> 赞同：1
> 
> 时间：2008-11-06T01:12:29.747
> 
> 标签：web-config, editing

当开始一个新的 web 项目时，我总是有点担心删除 web.config 的片段。Net 3.5 SP1 的条目似乎比以往任何时候都多。

对于以下情况，您会删除 .config 的哪些位：

*   WCF Web 服务，不支持 Javascript
*   简单的 MVC 网站

编辑 有人可以记录一个简单网站的 web.config 中留下和取出的基本列表吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T01:17:46.993

我通常只是从 web.config 中删除项目，直到事情破裂——这是一个反复试验的过程。

令人惊讶的是，您可以在不影响任何内容的情况下删除多少 web.config。它在 .NET 3.5 中变得相当糟糕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T03:33:06.733

很大程度上同意 Jeff 的观点，即对于可以从文件中删除的内容，这是一个反复试验的过程。

在调整运行时和 http 管道方面，它通常是一个向 web.config 添加东西的过程，以关闭这些东西。

开箱即用的配置为管道添加了很多模块，根据您的工作，您可能不需要其中的一半。

在 MSDN 上遇到过几篇关于此的文章，还有一篇[http://www.codeproject.com/KB/aspnet/10ASPNetPerformance.aspx](http://www.codeproject.com/KB/aspnet/10ASPNetPerformance.aspx)由 PageFlakes 的 Omar 撰写，这是我在我的（可怜的有组织的）书签，这是优化运行时的一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T05:13:48.557

这是我用于简单 WCF 服务的精简 Web.config

```
<?xml version="1.0"?>
<configuration>
    <system.web>
        <compilation debug="true">
          <assemblies>
            <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
          </assemblies>
        </compilation>
        <authentication mode="Windows" />
        <customErrors mode="RemoteOnly" defaultRedirect="error.htm">
            <error statusCode="403" redirect="NoAccess.htm" />
            <error statusCode="404" redirect="FileNotFound.htm" />
        </customErrors>
    </system.web>
    <system.codedom>
      <compilers>
        <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4"
                  type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
          <providerOption name="CompilerVersion" value="v3.5"/>
          <providerOption name="WarnAsError" value="false"/>
        </compiler>
      </compilers>
    </system.codedom>
  <system.serviceModel>
    <services>
      <service behaviorConfiguration="Service.ServiceBehavior" name="Service.Service">
        <endpoint address="" binding="basicHttpBinding" contract="Service.IService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="Service.ServiceBehavior">
          <serviceMetadata httpGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

我删除了很多额外的东西，尤其是我不需要的脚本模块

# sorting - 这些天您是否编写代码来对列表进行排序？

> ID：267374
> 
> 赞同：2
> 
> 时间：2008-11-06T01:13:51.400
> 
> 标签：sorting

java/.net 世界中的人们有提供排序列表方法的框架。

在 CS 中，我们可能都经历过 Bubble/Insertion/Merge/Shell 排序算法。这些天你写这些吗？

有了框架，您是否编写用于排序的代码？

你认为让人们在面试中编写代码进行排序有意义吗？（实习生/初级开发人员要求除外）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T01:35:43.600

我今天写了两段代码来对数据进行排序

```
list.Sort();
enumerable.OrderBy(x => x);  // Occasionally a different lambda is used 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T02:28:59.297

我在一家开发工具公司工作，因此有时我需要编写新的 RTL 类型和例程。排序是开发人员需要的，所以有时我需要编写。

不要忘记，所有这些库代码都不是从某个山上传下来的：某个地方的某个开发人员必须编写它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T01:19:43.180

我不编写排序算法，但我已经在 .Net 中为一些类实现了 IComparer，这在前几次很有趣。

在大多数情况下，考虑到框架中的内容，我不会编写用于排序的代码。应该了解为什么像快速排序这样的特定排序策略经常在 .Net 等框架中使用。

我可以看到给出或被给出一个排序问题，其中一些工作是实现 IComparer 并理解对类进行排序的不同方法。向某人展示冒泡排序并问：“为什么您不想在大多数应用程序中这样做？”这将是一件相当容易的事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T01:46:41.847

我可以 100% 肯定地说，自从离开大学以来，我还没有写过任何一种“传统”的排序程序。很高兴知道它背后的理论，但是将它们应用于无法通过其他方式完成的现实世界的情况并不经常发生（至少根据我的经验......）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T01:20:23.413

仅在雇主的面试/测试中 =)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T05:19:05.413

当我不得不使用自定义键比较对数 GB 的文件进行排序时，我编写了一个合并排序。我喜欢归并排序——它易于理解、稳定，并且具有最坏情况的 O(n log n) 性能。

我也一直在寻找尝试[基数排序](http://en.wikipedia.org/wiki/Radix_sort)的借口。它不像大多数排序算法那样通用，因此不会有任何库提供它，但在适当的情况下，它应该是一个很好的加速。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T01:17:56.930

就个人而言，我已经有一段时间不需要编写自己的排序代码了。

就面试问题而言，它将淘汰那些在CS课上没有注意的人。

您可以通过询问您将如何构建 Comparable (Capital C) 对象或类似的东西来测试 API 知识。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T02:38:07.687

在我看来，就像许多其他知识领域一样，编程也有理论和实践的方法。

“理论编程”领域为我们提供了快速排序、基数排序、Djikstra 算法和许多其他对计算进步绝对必要的东西。

“实际编程”领域涉及的事实是，在“理论编程”中创建的解决方案应该以更简单的方式被所有人轻松访问，以便理论思想可以得到很多很多创造性的用途。这为我们提供了像 Python 这样的高级语言，并允许几乎任何语言为最基本的操作（如排序或搜索）实现打包方法，并且性能足够好，几乎适合所有人。

一个人不能没有另一个人......我们大多数人不需要硬编码排序算法并不意味着没有人应该这样做。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-06T04:47:20.360

我最近不得不写一个排序。我有一个文本列表……最常见的十个必须根据它们被选中的频率出现。所有其他条目必须根据 alpha 排序显示。

这并不难做到，但我确实必须写一个类型来支持它。

我还必须对那些元素不容易使用开箱即用代码进行排序的对象进行排序。

搜索也是如此。我必须遍历文件并搜索静态大小的记录。当我找到一条记录时，我必须将一条记录移回，因为我在它之前插入。在大多数情况下，它非常简单，我勉强粘贴在二进制搜索中。需要进行一些更改以支持访问方法，因为我没有使用实际在内存中的数组.. 啊 c&@p.. 我可以把它当作流来对待.. 看看现在我想去回来看看。。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T01:21:14.973

伙计，如果有人在采访中问我最好的排序算法是什么，并且当我说“timsort”时没有立即理解，我会认真重新考虑我是否想在那里工作。

蒂姆索特

> 这描述了一种自适应的、稳定的、自然的归并排序，谦虚地称为 timsort（嘿，我赚到了）。它在多种部分有序数组上具有超自然的性能（少于所需的 lg(N!) 比较，并且少至 N-1），但速度与 Python 之前在随机数组上高度调整的采样排序混合一样快。
> 
> 简而言之，主程序从左到右遍历数组一次，交替识别下一次运行，然后“智能地”将其合并到先前的运行中。其他一切都是速度的复杂性，以及一些来之不易的内存效率衡量标准。

[http://svn.python.org/projects/python/trunk/Objects/listsort.txt](http://svn.python.org/projects/python/trunk/Objects/listsort.txt) [timsort 是通用的还是 Python 特定的？](https://stackoverflow.com/questions/154504/is-timsort-general-purpose-or-python-specific)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-06T01:42:16.130

除了编码练习和观察语言的有趣特性（例如如何在 Python 中的一行上进行快速排序）之外，我还没有真正实现过排序。

我认为这是在面试中提出的一个有效问题，因为它反映了开发人员是否考虑过这类事情……我觉得知道 list.sort() 在调用它时在做什么很重要。作为一名程序员，你应该了解一切背后的基础知识，这只是我理论的一部分。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-06T01:53:51.037

我从不写任何有图书馆例程的东西。我已经几十年没有编写过代码了。我也不会。使用直接可用的快速排序和 timsort，没有理由编写排序。

我注意到 SQL 会为我进行排序。

有很多东西我不写，排序只是其中之一。

我从不编写自己的 I/O 驱动程序。（虽然我过去有过。）

我从不编写自己的图形库。（是的，我也做过一次，在 80 年代）

我从不编写自己的文件系统。（避免了这一点。）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-06T04:49:00.700

是的。当您的列表最多只有几十条记录时，有时挖掘 Shell 排序会击败内置排序例程。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-06T02:16:00.917

绝对没有理由再编写一个代码了。我认为了解您正在使用的数据的效率很重要，以便您可以选择最适合您正在排序的数据的数据。

# sql-server - Sql Server Management Studio 2008 没有脚本表权限

> ID：267375
> 
> 赞同：3
> 
> 时间：2008-11-06T01:13:56.580
> 
> 标签：sql-server, ssms

即使我选择了脚本对象级权限的选项，Sql Server Management Studio 2008 也不是脚本表权限。这是一个错误还是有其他方法可以做到这一点？它正在为存储的过程创建权限，但不是为表创建权限。我是系统管理员。

如果它不起作用，是否有免费的 sql server 工具来编写权限脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T03:50:53.220

我在一个 SQL Server 论坛站点上遇到了这个方便的脚本，但如果我能再次找到它，我会很烦恼：

```
CREATE VIEW [dbo].[viw_DBPerms] AS
SELECT 
    CASE 
            WHEN o.type = 'P' THEN 'Stored Procedure' 
            WHEN o.type = 'TF' THEN 'Table Function' 
            WHEN o.type = 'FN' THEN 'Scalar Function' 
            WHEN o.type = 'U' THEN 'Table'
            WHEN o.type = 'V' THEN 'View' 
            WHEN o.type = 'SQ' THEN 'Service Queue'
            ELSE o.type
    END AS [Type],
    s.name AS [Schema], 
    o.name AS [Object],
    pr.name AS [User], 
    pe.permission_name AS Permission
FROM sys.database_permissions pe
LEFT JOIN sys.database_principals pr ON pe.grantee_principal_id = pr.principal_id
JOIN 
    (   SELECT [object_id] AS [id], [name], type, schema_id, 1 AS [class] FROM sys.objects 
        UNION 
        SELECT [service_id] AS [id], [name] COLLATE SQL_Latin1_General_CP1_CI_AS [name], 'Service', '0', 17 AS [class] FROM sys.services 
        UNION
        SELECT [service_cONtract_id] AS [id], [name], 'Service Contract', '0', 16 AS [class] FROM sys.service_contracts
        UNION
        SELECT [message_type_id] AS [id], [name], 'Message Type', '0', 15 AS [class] FROM sys.service_message_types
    ) o 
    ON pe.major_id = o.id AND pe.class = o.class
LEFT JOIN sys.schemas s ON o.schema_id = s.schema_id 
```

...然后只需使用：

```
SELECT Object, 
    SUM(CASE Permission WHEN 'SELECT' THEN 1 ELSE 0 END) AS 'SELECT',
    SUM(CASE Permission WHEN 'INSERT' THEN 1 ELSE 0 END) AS 'INSERT',
    SUM(CASE Permission WHEN 'UPDATE' THEN 1 ELSE 0 END) AS 'UPDATE',
    SUM(CASE Permission WHEN 'DELETE' THEN 1 ELSE 0 END) AS 'DELETE',
    SUM(CASE Permission WHEN 'ALTER' THEN 1 ELSE 0 END) AS 'ALTER'
FROM viw_DBPerms
WHERE [User] = '<sqluser>'
GROUP BY Object 
```

这适用于 SQL 2005，我希望它可以在 SQL 2008 上正常工作。

# regex - 如何仅将有效的罗马数字与正则表达式匹配？

> ID：267399
> 
> 赞同：184
> 
> 时间：2008-11-06T01:29:25.440
> 
> 标签：regex, roman-numerals

考虑到[我的另一个问题](https://stackoverflow.com/questions/267351/how-can-i-convert-from-integers-to-roman-numerals-using-a-syntax-directed-trans)，我决定我什至不能创建一个匹配罗马数字的正则表达式（更不用说生成它们的上下文无关语法了）

问题是只匹配有效的罗马数字。例如，990 不是“XM”，而是“CMXC”

我为此制作正则表达式的问题是，为了允许或不允许某些字符，我需要回顾一下。让我们以成千上万的例子为例。

我可以允许 M{0,2}C?M（允许 900、1000、1900、2000、2900 和 3000）。但是，如果匹配在 CM 上，我不能允许后面的字符是 C 或 D（因为我已经是 900 了）。

如何在正则表达式中表达这一点？
如果它在正则表达式中根本无法表达，那么它是否可以在上下文无关语法中表达？

* * *

## 回答 #1

> 赞同：360
> 
> 时间：2008-11-06T01:35:41.510

您可以为此使用以下正则表达式：

```
^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$ 
```

将其分解，`M{0,4}`指定千部分并基本上将其限制在`0`和之间`4000`。这是一个相对简单的：

```
 0: <empty>  matched by M{0}
1000: M        matched by M{1}
2000: MM       matched by M{2}
3000: MMM      matched by M{3}
4000: MMMM     matched by M{4} 
```

当然，如果你想允许更大的数字，你可以使用类似`M*`允许*任何数字（包括零）的东西。*

接下来是`(CM|CD|D?C{0,3})`，稍微复杂一点，这是针对数百个部分的，涵盖了所有可能性：

```
 0: <empty>  matched by D?C{0} (with D not there)
100: C        matched by D?C{1} (with D not there)
200: CC       matched by D?C{2} (with D not there)
300: CCC      matched by D?C{3} (with D not there)
400: CD       matched by CD
500: D        matched by D?C{0} (with D there)
600: DC       matched by D?C{1} (with D there)
700: DCC      matched by D?C{2} (with D there)
800: DCCC     matched by D?C{3} (with D there)
900: CM       matched by CM 
```

第三，`(XC|XL|L?X{0,3})`遵循与上一节相同的规则，但对于十位：

```
 0: <empty>  matched by L?X{0} (with L not there)
10: X        matched by L?X{1} (with L not there)
20: XX       matched by L?X{2} (with L not there)
30: XXX      matched by L?X{3} (with L not there)
40: XL       matched by XL
50: L        matched by L?X{0} (with L there)
60: LX       matched by L?X{1} (with L there)
70: LXX      matched by L?X{2} (with L there)
80: LXXX     matched by L?X{3} (with L there)
90: XC       matched by XC 
```

最后，`(IX|IV|V?I{0,3})`是单位部分，处理`0`方式`9`与前两个部分类似（罗马数字，尽管看起来很奇怪，但一旦你弄清楚它们是什么，就遵循一些逻辑规则）：

```
0: <empty>  matched by V?I{0} (with V not there)
1: I        matched by V?I{1} (with V not there)
2: II       matched by V?I{2} (with V not there)
3: III      matched by V?I{3} (with V not there)
4: IV       matched by IV
5: V        matched by V?I{0} (with V there)
6: VI       matched by V?I{1} (with V there)
7: VII      matched by V?I{2} (with V there)
8: VIII     matched by V?I{3} (with V there)
9: IX       matched by IX 
```

* * *

请记住，该正则表达式也将匹配一个空字符串。如果您不想要这个（并且您的正则表达式引擎足够现代），您可以使用积极的后视和前瞻：

```
(?<=^)M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})(?=$) 
```

（另一种选择是预先检查长度是否不为零）。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-11-06T01:51:36.237

实际上，你的前提是有缺陷的。990是“XM”，以及“CMXC” **。**

与你的三年级老师相比，罗马人对“规则”的关注程度要低得多。只要加起来就OK了。因此，对于 4，“IIII”与“IV”一样好。而“IIM”对于 998 来说非常酷。

（如果您对此有困难……请记住，英语拼写直到 1700 年代才正式化。在那之前，只要读者能弄清楚，就足够了）。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-04-12T14:33:52.537

只是为了保存在这里：

```
(^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$) 
```

匹配所有罗马数字。不关心空字符串（至少需要一个罗马数字字母）。应该在 PCRE、Perl、Python 和 Ruby 中工作。

在线 Ruby 演示：[http ://rubular.com/r/KLPR1zq3Hj](http://rubular.com/r/KLPR1zq3Hj)

在线转换：[http ://www.onlineconversion.com/roman_numerals_advanced.htm](http://www.onlineconversion.com/roman_numerals_advanced.htm)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-05-04T01:07:40.427

为避免匹配空字符串，您需要重复该模式四次，并依次将每个替换`0`为 a `1`，并考虑`V`,`L`和`D`：

```
(M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})|M{0,4}(CM|C?D|D?C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})|M{0,4}(CM|CD|D?C{0,3})(XC|X?L|L?X{1,3})(IX|IV|V?I{0,3})|M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|I?V|V?I{1,3})) 
```

在这种情况下（因为此模式使用`^`and `$`），您最好先检查空行，不要费心匹配它们。如果您使用[单词边界](http://www.regular-expressions.info/wordboundaries.html)，那么您没有问题，因为没有空词之类的东西。（至少正则表达式没有定义一个；不要开始哲学化，我在这里很务实！）

* * *

在我自己的特定（现实世界）案例中，我需要在词尾匹配数字，但我没有找到其他方法。我需要从纯文本文档中删除脚注编号，其中诸如“红海^(cl)和大堡礁^(cli) ”之类的文本已转换为`the Red Seacl and the Great Barrier Reefcli`. 但是我仍然对有效单词有问题，例如`Tahiti`and`fantastic`被擦洗成`Tahit`and `fantasti`。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-06T01:36:18.950

幸运的是，数字的范围被限制在 1..3999 左右。因此，您可以构建正则表达式零碎。

```
<opt-thousands-part><opt-hundreds-part><opt-tens-part><opt-units-part> 
```

这些部分中的每一个都将处理罗马符号的变幻莫测。例如，使用 Perl 表示法：

```
<opt-hundreds-part> = m/(CM|DC{0,3}|CD|C{1,3})?/; 
```

重复并组装。

*补充*：`<opt-hundreds-part>`可以进一步压缩：

```
<opt-hundreds-part> = m/(C[MD]|D?C{0,3})/; 
```

由于 'D?C{0,3}' 子句不能匹配任何内容，因此不需要问号。而且，最有可能的是，括号应该是非捕获类型 - 在 Perl 中：

```
<opt-hundreds-part> = m/(?:C[MD]|D?C{0,3})/; 
```

当然，它也应该不区分大小写。

您还可以扩展它以处理 James Curran 提到的选项（允许 XM 或 IM 用于 990 或 999，CCCC 用于 400 等）。

```
<opt-hundreds-part> = m/(?:[IXC][MD]|D?C{0,4})/; 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-10-31T07:11:17.950

```
import re
pattern = '^M{0,3}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$'
if re.search(pattern, 'XCCMCI'):
    print 'Valid Roman'
else:
    print 'Not valid Roman' 
```

[对于真正想理解逻辑的人，请看一下diveintopython](http://www.diveintopython.net/regular_expressions/roman_numerals.html) 3页上的逐步解释。

与原始解决方案（具有`M{0,4}`）的唯一区别是因为我发现 'MMMM' 不是有效的罗马数字（老罗马人很可能没有考虑过这个巨大的数字并且会不同意我的观点）。如果您是不同意的古罗马人之一，请原谅我并使用 {0,4} 版本。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-12-22T12:45:40.980

就我而言，我试图在文本中用一个单词查找和替换所有出现的罗马数字，所以我不能使用行的开头和结尾。所以@paxdiablo 解决方案发现了许多零长度匹配。我最终得到以下表达式：

```
(?=\b[MCDXLVI]{1,6}\b)M{0,4}(?:CM|CD|D?C{0,3})(?:XC|XL|L?X{0,3})(?:IX|IV|V?I{0,3}) 
```

我最终的 Python 代码是这样的：

```
import re
text = "RULES OF LIFE: I. STAY CURIOUS; II. NEVER STOP LEARNING"
text = re.sub(r'(?=\b[MCDXLVI]{1,6}\b)M{0,4}(?:CM|CD|D?C{0,3})(?:XC|XL|L?X{0,3})(?:IX|IV|V?I{0,3})', 'ROMAN', text)
print(text) 
```

输出：

```
RULES OF LIFE: ROMAN. STAY CURIOUS; ROMAN. NEVER STOP LEARNING 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-02-29T21:12:52.860

我见过多个不涵盖空字符串或使用前瞻来解决此问题的答案。而且我想添加一个新的答案，它确实涵盖了空字符串并且不使用前瞻。正则表达式如下：

`^(I[VX]|VI{0,3}|I{1,3})|((X[LC]|LX{0,3}|X{1,3})(I[VX]|V?I{0,3}))|((C[DM]|DC{0,3}|C{1,3})(X[LC]|L?X{0,3})(I[VX]|V?I{0,3}))|(M+(C[DM]|D?C{0,3})(X[LC]|L?X{0,3})(I[VX]|V?I{0,3}))$`

我允许无限`M`，`M+`但当然有人可以更改为`M{1,4}`只允许 1 或 4 如果需要。

下面是一个有助于理解它在做什么的可视化，前面有两个在线演示：

[调试演示](https://www.debuggex.com/r/zuVcMMzMYq-RsXMA)

[正则表达式 101 演示](https://regex101.com/r/7mw0Pe/1/)

![正则表达式可视化](https://www.debuggex.com/i/zuVcMMzMYq-RsXMA.png)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-06T03:03:07.433

正如杰里米和帕克斯在上面指出的那样...... '^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV |V?I{0,3})$' 应该是您想要的解决方案...

应该附加的特定 URL（恕我直言）是 [http://thehazeltree.org/diveintopython/7.html](http://thehazeltree.org/diveintopython/7.html)

例 7.8 是使用 {n,m} 的简写形式

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-12-12T18:50:05.040

我在这里回答这个问题[Python 中的罗马数字正则表达式，](https://stackoverflow.com/questions/59310128/regular-expression-in-python-for-roman-numerals)
因为它被标记为这个问题的完全重复。

它的名称可能相似，但这是一个特定的正则表达式问题/问题
，从这个问题的答案可以看出。

正在寻找的项目可以组合成一个单一的交替，然后封装在一个捕获组中，该组将使用 findall() 函数
放入一个列表中。 它是这样完成的：

```
>>> import re
>>> target = (
... r"this should pass v" + "\n"
... r"this is a test iii" + "\n"
... )
>>>
>>> re.findall( r"(?m)\s(i{1,3}v*|v)$", target )
['v', 'iii'] 
```

正则表达式修改因子并仅捕获数字是这样的：

```
 (?m)
 \s 
 (                     # (1 start)
      i{1,3} 
      v* 
   |  v
 )                     # (1 end)
 $ 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-09-07T09:28:29.713

以下表达式对我有用以验证罗马数字。

```
^M{0,4}(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$ 
```

这里，

*   `M{0,4}`将匹配数千
*   `C[MD]|D?C{0,3}`将匹配数百个
*   `X[CL]|L?X{0,3}`将匹配十
*   `I[XV]|V?I{0,3}`将匹配单位

下面是一个有助于理解它在做什么的可视化，前面有两个在线演示：

[调试演示](https://www.debuggex.com/r/Sf3WDxwcjtYHUZ1L)

[正则表达式 101 演示](https://regex101.com/r/5atuBs/1)

蟒蛇代码：

```
import re
regex = re.compile("^M{0,4}(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$")
matchArray = regex.match("MMMCMXCIX") 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-09-23T19:09:25.957

@paxdiablo 为了避免匹配空字符串而建议的**积极**的后视和前瞻对我来说似乎不起作用。

我已经通过使用**负**前瞻来修复它：

```
(?!$)M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3}) 
```

注意：如果您在正则表达式末尾附加一些内容（例如，“foobar”，那么显然您必须替换`(?!$)`为`(?!f)`（`f`“foobar”的第一个字符在哪里）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-06-22T19:26:33.570

Steven Levithan 在[他的帖子](http://blog.stevenlevithan.com/archives/javascript-roman-numeral-converter)中使用了这个正则表达式，它在“deromanizing”值之前验证罗马数字：

```
/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/ 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-02-29T03:36:24.040

这适用于 Java 和 PCRE 正则表达式引擎，现在应该适用于最新的 JavaScript，但可能不适用于所有上下文。

`(?<![A-Z])(M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3}))(?![A-Z])`

第一部分是残酷的负面回顾。但是，出于逻辑目的，它是最容易理解的。基本上，第一个`(?<!)`是说如果中间`([MATCH])`前面有字母，则不要匹配中间`([MATCH])`，最后一个是如果后面有字母，`(?!)`则不要匹配中间`([MATCH])`。

中间`([MATCH])`只是匹配罗马数字序列的最常用的正则表达式。但是现在，如果它周围有任何字母，你不想匹配它。

你自己看。 [https://regexr.com/4vce5](https://regexr.com/4vce5)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-07-20T07:15:42.770

这里有一些非常棒的答案，但没有一个适合我，因为我需要能够只匹配字符串中的有效罗马数字而不匹配空字符串，并且只匹配它们自己的数字（即不在一个单词中）。

让我向您介绍[Reilly 的现代罗马数字严格表达式](https://www.oreilly.com/library/view/regular-expressions-cookbook/9780596802837/ch06s09.html)：

```
^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})$ 
```

开箱即用它非常接近我所需要的，但它只会匹配独立的罗马数字，当更改为匹配字符串时，它将在某些点匹配空字符串（单词以大写 V、M 等开头）和还将给出无效罗马数字的部分匹配，例如 MMLLVVDD、XXLLVVDD、MMMMDLVX、XVXDLMM 和 MMMCCMLXXV。

所以，经过一些修改，我最终得到了这个：

```
(?<![MDCLXVI])(?=[MDCLXVI])M{0,3}(?:C[MD]|D?C{0,3})(?:X[CL]|L?X{0,3})(?:I[XV]|V?I{0,3})[^ ]\b 
```

添加的[负面后视](https://www.regular-expressions.info/lookaround.html#lookbehind)将确保它不会对无效罗马数字进行部分匹配，并将第一个 M 锁定为 3，因为这是[罗马数字标准形式](https://en.wikipedia.org/wiki/Roman_numerals#Standard_form)中的最高值。

到目前为止，这是唯一一个通过了我超过 4000 次测试的正则表达式，[其中](https://github.com/mekwall/romanizr/blob/main/src/__tests__/matchRomans.spec.ts)包括从 1 到 3999 的所有可能的罗马数字、字符串中的罗马数字和我上面提到的无效罗马数字。

这是来自[https://regex101.com/](https://regex101.com/)的截图： [![4](https://i.stack.imgur.com/TokEY.png)](https://i.stack.imgur.com/TokEY.png)

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2011-03-16T14:12:41.907

Jeremy 和 Pax 的解决方案的问题是，它也匹配“无”。

以下正则表达式需要至少一个罗马数字：

```
^(M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})|[IDCXMLV])$ 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2015-01-01T11:59:14.767

我会为我的工作编写函数。这是 PowerShell 中的两个罗马数字函数。

```
function ConvertFrom-RomanNumeral
{
  <#
    .SYNOPSIS
        Converts a Roman numeral to a number.
    .DESCRIPTION
        Converts a Roman numeral - in the range of I..MMMCMXCIX - to a number.
    .EXAMPLE
        ConvertFrom-RomanNumeral -Numeral MMXIV
    .EXAMPLE
        "MMXIV" | ConvertFrom-RomanNumeral
  #>
    [CmdletBinding()]
    [OutputType([int])]
    Param
    (
        [Parameter(Mandatory=$true,
                   HelpMessage="Enter a roman numeral in the range I..MMMCMXCIX",
                   ValueFromPipeline=$true,
                   Position=0)]
        [ValidatePattern("^M{0,3}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$")]
        [string]
        $Numeral
    )

    Begin
    {
        $RomanToDecimal = [ordered]@{
            M  = 1000
            CM =  900
            D  =  500
            CD =  400
            C  =  100
            XC =   90
            L  =   50
            X  =   10
            IX =    9
            V  =    5
            IV =    4
            I  =    1
        }
    }
    Process
    {
        $roman = $Numeral + " "
        $value = 0

        do
        {
            foreach ($key in $RomanToDecimal.Keys)
            {
                if ($key.Length -eq 1)
                {
                    if ($key -match $roman.Substring(0,1))
                    {
                        $value += $RomanToDecimal.$key
                        $roman  = $roman.Substring(1)
                        break
                    }
                }
                else
                {
                    if ($key -match $roman.Substring(0,2))
                    {
                        $value += $RomanToDecimal.$key
                        $roman  = $roman.Substring(2)
                        break
                    }
                }
            }
        }
        until ($roman -eq " ")

        $value
    }
    End
    {
    }
}

function ConvertTo-RomanNumeral
{
  <#
    .SYNOPSIS
        Converts a number to a Roman numeral.
    .DESCRIPTION
        Converts a number - in the range of 1 to 3,999 - to a Roman numeral.
    .EXAMPLE
        ConvertTo-RomanNumeral -Number (Get-Date).Year
    .EXAMPLE
        (Get-Date).Year | ConvertTo-RomanNumeral
  #>
    [CmdletBinding()]
    [OutputType([string])]
    Param
    (
        [Parameter(Mandatory=$true,
                   HelpMessage="Enter an integer in the range 1 to 3,999",
                   ValueFromPipeline=$true,
                   Position=0)]
        [ValidateRange(1,3999)]
        [int]
        $Number
    )

    Begin
    {
        $DecimalToRoman = @{
            Ones      = "","I","II","III","IV","V","VI","VII","VIII","IX";
            Tens      = "","X","XX","XXX","XL","L","LX","LXX","LXXX","XC";
            Hundreds  = "","C","CC","CCC","CD","D","DC","DCC","DCCC","CM";
            Thousands = "","M","MM","MMM"
        }

        $column = @{Thousands = 0; Hundreds = 1; Tens = 2; Ones = 3}
    }
    Process
    {
        [int[]]$digits = $Number.ToString().PadLeft(4,"0").ToCharArray() |
                            ForEach-Object { [Char]::GetNumericValue($_) }

        $RomanNumeral  = ""
        $RomanNumeral += $DecimalToRoman.Thousands[$digits[$column.Thousands]]
        $RomanNumeral += $DecimalToRoman.Hundreds[$digits[$column.Hundreds]]
        $RomanNumeral += $DecimalToRoman.Tens[$digits[$column.Tens]]
        $RomanNumeral += $DecimalToRoman.Ones[$digits[$column.Ones]]

        $RomanNumeral
    }
    End
    {
    }
} 
```

# sql-server - 当 Windows 身份验证不是一个选项时，MS-SQL 的最佳实践是什么？

> ID：267400
> 
> 赞同：4
> 
> 时间：2008-11-06T01:31:37.400
> 
> 标签：sql-server

使用 SQL Server 身份验证的 Windows 应用程序的最佳选择是什么？我是否应该创建一个 SQL 帐户并管理应用程序内的用户（使用用户表）。或者我应该为每个用户创建一个 SQL 服务器帐户。你的经验是什么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T01:46:37.200

取决于 SQL 服务器的用户名/密码是否会暴露给用户，以及这是否会成为问题。通常对于内部应用程序（在较小的组织中），人们会相信用户不会直接登录到 sql server。如果您有中间件层（即 web 服务），则可以对用户隐藏密码。

我更喜欢使用数据库的通用登录名并管理应用程序中的用户。即使您确实为每个应用程序用户创建了一个 sql 登录，他们仍然可以直接连接，所以为什么不使用更易于管理的通用 sql 登录。这当然是假设所有用户都具有相同的访问权限。

如果用户可能直接访问数据库，则一种好的做法是仅通过存储过程授予访问权限，而不是直接授予对表的访问权限，以便只能执行某些操作。避免在存储过程中编写业务逻辑或安全检查（基本检查除外）。

我可以解决您的问题的一种方法是编写一些 Web 服务来检查安全性并执行您的 CRUD（通过数据集等），但这又取决于应用程序和环境。

总之，如果您有中间层或所有用户都具有相同的访问权限，请在应用程序内管理用户并使用单个用户登录。否则，使用每个用户或角色的登录名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T01:37:10.493

如何根据任务所需的权限级别拥有 SQL 帐户。例如，如果您的系统有很多报告，您可以有一个只读帐户仅用于报告。您还需要一个具有写入权限的帐户，以便人们更改密码和其他用户管理任务。

如果您遇到某些用户只能访问某些数据的情况，我将为该数据设置单独的帐户。使用 1 个帐户的问题是您说应用程序中的任何地方都没有 SQL 注入。这是每个人都会努力的目标，但有时完美的安全性是不可能的，因此需要多管齐下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T01:43:01.497

我过去使用的一种选择是使用 ASP.NET Membership Provider。它使身份验证变得轻而易举。我看到的唯一缺点是它向您的数据库添加了一堆表。

使用它的代码非常简单。

这是一篇关于在 Windows 应用程序中使用它的博客文章。[http://msmvps.com/blogs/theproblemsolver/archive/2006/01/12/80905.aspx](http://msmvps.com/blogs/theproblemsolver/archive/2006/01/12/80905.aspx)这是另一篇更详细的文章。[http://www.c-sharpcorner.com/UploadFile/jmcfet/Provider-basedASP.NET10162006104542AM/Provider-basedASP.NET.aspx](http://www.c-sharpcorner.com/UploadFile/jmcfet/Provider-basedASP.NET10162006104542AM/Provider-basedASP.NET.aspx)

这是另一篇关于在 Windows 应用程序中使用它的文章：[http ://www.theproblemsolver.nl/usingthemembershipproviderinwinforms.htm](http://www.theproblemsolver.nl/usingthemembershipproviderinwinforms.htm)

谷歌搜索“ASP.NET 2.0 Membership Provider”，你会得到很多点击。

# .net - 如何将数据绑定到列表视图中的多个列？

> ID：267410
> 
> 赞同：5
> 
> 时间：2008-11-06T01:36:27.563
> 
> 标签：.net, winforms, data-binding, listview

我有一个要绑定到具有多列的列表视图的数据源。如何将我的数据源绑定到该列表视图

这是一些伪代码，无法帮助说明我正在尝试做的事情：

```
MyDataTable dt = GetDataSource();
ListView1.DataBindings.Add("Column1.Text", dt, "MyDBCol1");
ListView1.DataBindings.Add("Column2.Text", dt, "MyDBCol2"); 
```

- 编辑 -

对不起，我忘了提到它是winforms。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T06:22:02.290

WinForms ListView 控件的功能似乎存在缺陷（认为可以对新的 WPF ListBox进行[数据绑定）。](http://msdn.microsoft.com/en-us/library/ms750972.aspx#BindingDatatoaListView)

Nick Karnik 的这篇文章描述了如何向从 WinForms ListView 继承的自定义控件添加数据绑定功能 -[数据绑定 ListView](http://www.codeproject.com/KB/list/ListView_DataBinding.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T05:29:13.460

你能澄清一下这是winforms还是webforms吗？两者都有一个`ListView`。从`DataBindings.Add`我假设winforms。

会`DataGridView`是一个务实的选择吗？这将支持开箱即用的多列绑定？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T13:15:22.203

Listview 没有数据源，必须手动添加项目。

我建议使用 DatagridView 而不是 Listview。
特别是如果您有**很多物品**。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-11-06T02:19:03.407

查看[有关将数据源绑定到 listview 的此参考](http://geekswithblogs.net/rashid/archive/2007/09/09/Asp.net-ListView---DataBinding.aspx)。那是你要找的吗？

# java - Java中的默认HashMap探测

> ID：267414
> 
> 赞同：6
> 
> 时间：2008-11-06T01:39:46.743
> 
> 标签：java, data-structures, hashmap

Java 使用什么作为 HashMap 的默认探测方法？是线性的吗？链接还是其他？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T02:53:50.543

看起来像束缚我。代码：（[链接）](http://kickjava.com/src/java/util/HashMap.java.htm)

```
...
第724章 /**
725 * 创建新条目。
第726章
727条目（int h，K k，V v，条目n）{
第728章
第729章
730键=k；
第731章
第732章
...

...
795 void addEntry(int hash, K key, V value, int bucketIndex) {
第796章
第797章
...

```

也就是说，获取bucketIndex 处的条目，然后用一个新条目替换它，该条目的“下一个”字段是已经存在的条目（即链接它）。

# c++ - 优雅的模板专业化

> ID：267418
> 
> 赞同：4
> 
> 时间：2008-11-06T01:42:35.430
> 
> 标签：c++, templates

有没有一种优雅的方法可以根据模板参数之一专门化模板？

IE。

```
template<int N> struct Junk {
    static int foo() {
        // stuff
        return Junk<N - 1>::foo();
    }
};

// compile error: template argument '(size * 5)' involves template parameter(s)
template<int N> struct Junk<N*5> {
    static int foo() {
        // stuff
        return N;
    }
};

template<> struct Junk<0> {
    static int foo() {
        // stuff
        return 0;
    }
}; 
```

IE。我正在尝试根据可被 5 整除的参数来专门化模板。我似乎可以做到的唯一方法如下：

```
template<int N> struct JunkDivisibleBy5 {
    static int foo() {
        // stuff
        return N;
    }
};

template<int N> struct Junk {
    static int foo() {
        // stuff
        if ((N - 1) % 5 == 0 && N != 1)
            return JunkDivisibleBy5<N - 1>::foo();
        else
            return Junk<N - 1>::foo();
    }
};

template<> struct Junk<0> {
    static int foo() {
        // stuff
        return 0;
    }
}; 
```

但这明显不那么优雅，并且即使模板参数不需要它，也需要实例化所有模板。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-06T02:48:18.853

这个怎么样：

```
#include <iostream>
using namespace std;

template < typename T, T N, T D >
struct fraction {
    typedef T value_type;
    static const value_type num = N;
    static const value_type denom = D;
    static const bool is_div = (num % denom == 0);
};

template< typename T, T N, T D, bool P >
struct do_if {
    static void op() { cout << N << " NOT divisible by " << D << endl; }
};

template< typename T, T N, T D >
struct do_if< T, N, D, true > {
    static void op() { cout << N << " divisible by " << D << endl; }
};

template < int N >
void foo() {
    typedef fraction< int, N, 5 > f;
    do_if< typename f::value_type, f::num, f::denom, f::is_div >::op();
}

int main() {
    foo< -5 >();
    foo< -1 >();
    foo< 0 >();
    foo< 1 >();
    foo< 5 >();
    foo< 10000005 >();
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-11T11:53:23.230

使用 D 编程语言模板，可以将其编写为：

```
struct Junk(int N)
{
    static int foo()
    {
        static if (N == 0)
            return 0;
        else static if ((N % 5) == 0)
            return N;
        else
            return Junk!(N - 1).foo();
    }
} 
```

静态 if 在编译时执行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-06T07:59:39.723

所有计算都可以在编译时进行：

```
#include <iostream>

template<int N> struct Junk {
    enum { IsDivisibleBy5 = (N % 5 == 0) };
    template<bool D> struct JunkInternal {
        enum { Result = Junk<N-1>::Result };
    };
    template<> struct JunkInternal<true> {
        enum { Result = N };
    };
    enum { Result = JunkInternal<IsDivisibleBy5>::Result };
};

int main(int, char**)
{
    std::cout << Junk< 0 >::Result << std::endl;
    std::cout << Junk< 7 >::Result << std::endl;
    std::cout << Junk< 10 >::Result << std::endl;

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-08T21:50:48.050

代码

```
template<int A, bool = !(A % 5)>
struct select : select<A-1> { };

template<int A>
struct select<A, true> { static int const value = A; };

template<>
struct select<0, true> { static int const value = 0; };

int main() {
    std::cout << select<1>::value; // 0
    std::cout << select<7>::value; // 5
    std::cout << select<10>::value; // 10
} 
```

保持除数变量

```
template<int A, int D, bool = !(A % D)>
struct select : select<A-1, D> { };

template<int A, int D>
struct select<A, D, true> { static int const value = A; };

template<int D>
struct select<0, D, true> { static int const value = 0; };

int main() {
    std::cout << select<1, 3>::value; // 0
    std::cout << select<7, 3>::value; // 6
    std::cout << select<10, 3>::value; // 9
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T10:42:13.843

继承工作得很好：

```
template<int N> struct Junk : private JunkBase < N % 5 > { };

template<int N> struct JunkBase {
    static int foo() {
        // stuff
        return Junk<N - 1>::foo();
    }
};
template< > struct JunkBase<0> {
    static int foo() {
        return 0;
    }
}; 
```

如果您也需要 N/5，您可能需要将 N 传递给 JunkBase::foo。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T03:01:53.053

我很难称其为优雅，但这是我的代码版本，仅使用模板进行计算（以及测试内容）-

```
#include <iostream>

template < int N > struct JunkDivBy5 {
    static int foo() {
        return N;
    }
};

template < int N > struct Junk {
    template < int N1 > struct _JunkCond {
        enum { val = ( N1 != 1 && ( N1 - 1 ) % 5 == 0 ) ? 1 : 0 };
    };

    template < int M, int N1 > struct _JunkBranch { /* Error */ };

    template < int N1 > struct _JunkBranch< 1, N1 > {
        typedef JunkDivBy5< N1 - 1 > Type;
    };

    template < int N1 > struct _JunkBranch< 0, N1 > {
        typedef Junk< N1 - 1 > Type;
    };

    static int foo() {
        return _JunkBranch< _JunkCond< N >::val, N >::Type::foo();
    }
};

template <> struct Junk< 0 > {
    static int foo() {
        return 0;
    }
};

int main( int argc, char *argv[] ) {
    std::cout << Junk< 0 >::foo() << std::endl;
    std::cout << Junk< 5 >::foo() << std::endl;
    std::cout << Junk< 7 >::foo() << std::endl;
    std::cout << Junk< 25 >::foo() << std::endl;
} 
```

# tcl - TCL：Windows中线程之间的双向通信

> ID：267420
> 
> 赞同：4
> 
> 时间：2008-11-06T01:44:20.353
> 
> 标签：tcl

我需要在 Tcl 中的线程之间进行两种方式的通信，而我所能得到的只是一种方式，其中参数作为我唯一的 master->helper 通信通道传入。这是我所拥有的：

```
proc ExecProgram { command } {
    if { [catch {open "| $command" RDWR} fd ] } {
        #
        # Failed, return error indication
        #
        error "$fd"
    }
} 
```

调用 tclsh83，例如 ExecProgram "tclsh83 testCases.tcl TestCase_01"

在 testCases.tcl 文件中，我可以使用传入的信息。例如：

```
set myTestCase [lindex $argv 0] 
```

在 testCases.tcl 中，我可以输出到管道：

```
puts "$myTestCase"
flush stdout 
```

并使用进程 ID 接收放入主线程中的内容：

```
gets $app line 
```

...在一个循环内。

这不是很好。而不是双向的。

任何人都知道 Windows 中 2 个线程之间 tcl 的简单 2 路通信方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T13:00:04.000

这是一个小例子，展示了两个进程如何通信。首先关闭子进程（将其保存为 child.tcl）：

```
gets stdin line
puts [string toupper $line] 
```

然后是启动子进程并与之通信的父进程：

```
set fd [open "| tclsh child.tcl" r+]

puts $fd "This is a test"
flush $fd

gets $fd line
puts $line 
```

父进程使用 open 返回的值向子进程发送数据或从子进程接收数据；要打开的 r+ 参数打开读取和写入的管道。

由于管道上有缓冲，因此需要刷新；可以使用 fconfigure 命令将其更改为行缓冲。

还有一点；查看您的代码，您在这里没有使用线程，您正在启动一个子进程。Tcl 有一个线程扩展，它允许正确的线程间通信。

# asp.net - 如何获取 ASP.NET 应用程序的构建日期？

> ID：267421
> 
> 赞同：2
> 
> 时间：2008-11-06T01:44:54.910
> 
> 标签：asp.net, datetime, build

Jeff 不久前写过关于[获取文件版本/日期戳](http://www.codinghorror.com/blog/archives/000264.html)的文章。除非您关闭/重新打开解决方案，否则 Visual Studio 不会增加构建，因此获取时间戳似乎是验证您正在使用的构建的最佳方式。

我将解决方案移植到 C#

```
 // from http://www.codinghorror.com/blog/archives/000264.html
    protected DateTime getLinkerTimeStamp(string filepath){
        const int peHeaderOffset = 60;
        const int linkerTimestampOffset = 8;

        byte[] b = new byte[2048];
        Stream s = null;

        try {
            s = new FileStream(filepath, FileMode.Open, FileAccess.Read);
            s.Read(b, 0, 2048);
        }
        finally{
            if (s != null){
                s.Close();
            }
        }

        int i = BitConverter.ToInt32(b, peHeaderOffset);
        int secondsSince1970 = BitConverter.ToInt32(b, i + linkerTimestampOffset);
        DateTime dt = new DateTime(1970, 1, 1, 0, 0, 0);
        dt = dt.AddSeconds(secondsSince1970);
        dt = dt.AddHours(TimeZone.CurrentTimeZone.GetUtcOffset(dt).Hours);
        return dt;
    }

    protected DateTime getBuildTime()
    {
        System.Reflection.Assembly assembly = System.Reflection.Assembly.GetExecutingAssembly();
        return getLinkerTimeStamp(assembly.Location);
    } 
```

这似乎有效。是否有更好/更正式的方式来判断站点何时部署？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T03:56:10.400

我认为你最简单的方法是在你的 web.config 中有一个时间戳。

实际上有两种方法可以在 web.config 中更新它。第一种是使用自动化构建工具，例如 NAnt。它为您提供了根据需要修改 web.config 的选项。这是我使用的方法。

如果您不使用自动构建工具，您可以使用的另一个选项是在 Visual Studio 的预构建事件中添加代码，以便为您更新 web.config。这是一篇关于 Codeplex 的文章，可以帮助您入门。

[http://www.codeproject.com/KB/dotnet/configmanager_net.aspx](http://www.codeproject.com/KB/dotnet/configmanager_net.aspx)

# c++ - c++文件io&按分隔符分割

> ID：267427
> 
> 赞同：8
> 
> 时间：2008-11-06T01:49:32.060
> 
> 标签：c++, file-io, split

我有一个文件，其中列出的数据如下：

```
0,       2,    10
10,       8,    10
10,       10,   10
10,       16,   10
15,       10,   16
17,       10,   16 
```

我希望能够输入文件并将其拆分为三个数组，在此过程中修剪所有多余的空格并将每个元素转换为整数。

出于某种原因，我找不到在 C++ 中执行此操作的简单方法。我唯一的成功是将每一行输入到一个数组中，然后将所有空格正则表达式，然后将其拆分。整个过程花了我 20-30 行代码，修改另一个分隔符（例如空格）等很痛苦。

这是我想在 C++ 中拥有的 python 等价物：

```
f = open('input_hard.dat')
lines =  f.readlines()
f.close()

#declarations
inint, inbase, outbase = [], [], []

#input parsing
for line in lines:
    bits = string.split(line, ',')
    inint.append(int(bits[0].strip()))
    inbase.append(int(bits[1].strip()))
    outbase.append(int(bits[2].strip())) 
```

在 python 中这样做的易用性是我首先转向它的原因之一。但是，我现在需要在 C++ 中执行此操作，并且我不想使用我丑陋的 20-30 行代码。

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T05:30:44.190

在这个例子中没有真正需要使用 boost，因为流可以很好地完成这个技巧：

```
int main(int argc, char* argv[])
{
    ifstream file(argv[1]);

    const unsigned maxIgnore = 10;
    const int delim = ',';
    int x,y,z;

    vector<int> vecx, vecy, vecz;

    while (file)
    {
        file >> x;
        file.ignore(maxIgnore, delim);
        file >> y;
        file.ignore(maxIgnore, delim);
        file >> z;

        vecx.push_back(x);
        vecy.push_back(y);
        vecz.push_back(z);
    }
} 
```

虽然如果我要使用 boost 我更喜欢[tokenizer](http://www.boost.org/doc/libs/1_37_0/libs/tokenizer/tokenizer.htm)的简单性而不是正则表达式...... :)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T08:26:16.940

fscanf 确实没有什么问题，这可能是这种情况下最快的解决方案。它和 python 代码一样简短易读：

```
FILE *fp = fopen("file.dat", "r");
int x, y, z;
std::vector<int> vx, vy, vz;

while (fscanf(fp, "%d, %d, %d", &x, &y, &z) == 3) {
  vx.push_back(x);
  vy.push_back(y);
  vz.push_back(z);
}
fclose(fp); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T02:03:55.777

就像是：

```
vector<int> inint;
vector<int> inbase;
vector<int> outbase;
while (fgets(buf, fh)) {
   char *tok = strtok(buf, ", ");
   inint.push_back(atoi(tok));
   tok = strtok(NULL, ", ");
   inbase.push_back(atoi(tok));
   tok = strtok(NULL, ", ");
   outbase.push_back(atoi(tok));
} 
```

除了错误检查。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T09:02:50.640

为什么与 python 中的代码不同:)？

```
std::ifstream file("input_hard.dat");
std::vector<int> inint, inbase, outbase;

while (file.good()){
    int val1, val2, val3;
    char delim;
    file >> val1 >> delim >> val2 >> delim >> val3;

    inint.push_back(val1);
    inbase.push_back(val2);
    outbase.push_back(val3);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T02:39:53.660

std::getline 允许您读取一行文本，并且您可以使用字符串流来解析单独的行：

```
string buf;
getline(cin, buf); 
stringstream par(buf);

char buf2[512];
par.getline(buf2, 512, ','); /* Reads until the first token. */ 
```

一旦将文本行放入字符串中，您实际上可以使用任何您想要的解析函数，甚至 sscanf(buf.c_str(), "%d,%d'%d", &i1, &i2, &i3)，通过使用atoi 使用整数或通过其他方法在子字符串上。

如果您知道它们在那里，您还可以忽略输入流中不需要的字符：

```
if (cin.peek() == ',')
    cin.ignore(1, ',');
cin >> nextInt; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T03:31:18.953

如果您不介意使用 Boost 库...

```
#include <string>
#include <vector>
#include <boost/lexical_cast.hpp>
#include <boost/regex.hpp>

std::vector<int> ParseFile(std::istream& in) {
    const boost::regex cItemPattern(" *([0-9]+),?");
    std::vector<int> return_value;

    std::string line;
    while (std::getline(in, line)) {
        string::const_iterator b=line.begin(), e=line.end();
        boost::smatch match;
        while (b!=e && boost::regex_search(b, e, match, cItemPattern)) {
            return_value.push_back(boost::lexical_cast<int>(match[1].str()));
            b=match[0].second;
        };
    };

    return return_value;
} 
```

从流中提取行，然后使用 Boost::RegEx 库（带有捕获组）从行中提取每个数字。它会自动忽略任何不是有效数字的内容，但如果您愿意，可以对其进行更改。

s 仍然有大约 20 行，但您可以使用它从文件的行`#include`中提取*任何内容。*这是一个简单的例子，我使用几乎相同的代码从数据库字段中提取标签和可选值，唯一的主要区别是正则表达式。

编辑：哎呀，你想要三个独立的向量。试试这个轻微的修改：

```
const boost::regex cItemPattern(" *([0-9]+), *([0-9]+), *([0-9]+)");
std::vector<int> vector1, vector2, vector3;

std::string line;
while (std::getline(in, line)) {
    string::const_iterator b=line.begin(), e=line.end();
    boost::smatch match;
    while (b!=e && boost::regex_search(b, e, match, cItemPattern)) {
        vector1.push_back(boost::lexical_cast<int>(match[1].str()));
        vector2.push_back(boost::lexical_cast<int>(match[2].str()));
        vector3.push_back(boost::lexical_cast<int>(match[3].str()));
        b=match[0].second;
    };
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T09:29:12.913

如果您希望能够扩展到更难的输入格式，您应该考虑精神，提升解析器组合器库。

[这个页面](http://www.boost.org/doc/libs/1_37_0/libs/spirit/classic/doc/quick_start.html)有一个例子，它几乎可以满足你的需要（虽然有实数和一个向量）

# python - 如何将 ASCII 字符串视为 unicode 并在 python 中对其中的转义字符进行转义？

> ID：267436
> 
> 赞同：29
> 
> 时间：2008-11-06T01:55:40.317
> 
> 标签：python, unicode, ascii

例如，如果我有一个*unicode*字符串，我可以将其编码为*ASCII*字符串，如下所示：

```
>>> u'\u003cfoo/\u003e'.encode('ascii')
'<foo/>' 
```

但是，我有例如这个*ASCII*字符串：

```
'\u003foo\u003e' 
```

...我想变成与上面第一个示例相同的*ASCII*字符串：

```
'<foo/>' 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-11-06T02:26:05.433

我花了一段时间才弄清楚这一点，但[这个页面](http://www.egenix.com/www2002/python/unicode-proposal.txt)有最好的答案：

```
>>> s = '\u003cfoo/\u003e'
>>> s.decode( 'unicode-escape' )
u'<foo/>'
>>> s.decode( 'unicode-escape' ).encode( 'ascii' )
'<foo/>' 
```

还有一个“raw-unicode-escape”编解码器来处理指定 Unicode 字符串的另一种方式——查看链接页面的“Unicode 构造函数”部分了解更多详细信息（因为我不是那种 Unicode 知识）。

编辑：另见[Python 标准编码](http://www.python.org/doc/2.5.2/lib/standard-encodings.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-17T18:14:37.327

在 Python 2.5 上，正确的编码是“unicode_escape”，而不是“unicode-escape”（注意下划线）。

我不确定较新版本的 Python 是否更改了 unicode 名称，但这里只使用下划线。

无论如何，就是这样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-29T03:06:42.217

在某些时候，当您在要解码的字符串中遇到特殊字符（如汉字或表情符号）时，您会遇到问题，即如下所示的错误：

```
UnicodeEncodeError: 'ascii' codec can't encode characters in position 109-123: ordinal not in range(128) 
```

对于我的情况（推特数据处理），我解码如下，让我可以看到所有没有错误的字符

```
>>> s = '\u003cfoo\u003e'
>>> s.decode( 'unicode-escape' ).encode( 'utf-8' )
>>> <foo> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-01T12:29:51.557

*内德巴彻尔德*说：

> 根据字符串的来源，这有点危险，但是如何：
> 
> ```
> >>> s = '\u003cfoo\u003e'
> >>> eval('u"'+s.replace('"', r'\"')+'"').encode('ascii')
> '<foo>' 
> ```

实际上，这种方法可以像这样安全：

```
>>> s = '\u003cfoo\u003e'
>>> s_unescaped = eval('u"""'+s.replace('"', r'\"')+'-"""')[:-1] 
```

注意三引号字符串和结束三引号之前的破折号。

1.  使用 3 引号字符串将确保如果用户在字符串中输入 ' \\" '（为视觉清晰而添加的空格），它不会破坏评估器；
2.  最后的破折号是一个故障保护，以防用户的字符串以 ' \" ' 结尾。在我们分配结果之前，我们用 [:-1] 分割插入的破折号

因此，只要以原始格式捕获，就无需担心用户输入的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T02:01:12.740

根据字符串的来源，这有点危险，但是如何：

```
>>> s = '\u003cfoo\u003e'
>>> eval('u"'+s.replace('"', r'\"')+'"').encode('ascii')
'<foo>' 
```

# unit-testing - 对于基于 MSTest 的项目，如何管理可能在 x86 安装或 x64 安装上的部署项引用？

> ID：267439
> 
> 赞同：0
> 
> 时间：2008-11-06T01:58:02.247
> 
> 标签：unit-testing, reference, mstest

[与这个问题](https://stackoverflow.com/questions/245687/managing-reference-paths-between-x86-and-x64-workstations-in-a-team)非常相关，我们在我的团队中有一个场景，我们需要将一组库的文件夹的内容和所述库的配置文件复制到运行测试代码的文件夹中，作为测试的一部分部署步骤。

由于安装大小和其他因素，将此安装文件夹签入源代码管理以便在团队成员之间共享是不可行的。

该文件夹的安装路径是**/Program Files/InternalTool/**或**/Program Files (x86)/InternalTool/**，具体取决于安装的环境。我想设置我的 .testrunco​​nfig 文件，这样当人们获得最新版本的解决方案时，他们不必担心共享内部库套件路径的修复。

有没有办法让所有参与的成员都无缝衔接，如果是这样，如何才能做到这一点？

限制如下：

*   无法入住共享套房
*   共享套件没有安装路径覆盖

这可能吗，还是我要求太多了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T03:39:02.200

我们通过使用不同名称的不同配置文件并在需要时复制正确的配置文件来处理此类问题（我们的问题不相同但相似）。

在某些情况下，我们会在获取最新版本的批处理作业中自动执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T03:44:05.120

这实际上比我预期的要容易得多。

虽然 UI 不支持本地测试运行配置文件的许多内容，但我能够使用标准的 %ProgramFiles% 设置路径。

*   在 x86 系统上，这在大多数系统上解析为 C:\Program Files\。
*   在 x64 系统上，这在大多数系统上解析为 C:\Program Files\。

但！如果**调用方**是 32 位而不是 64 位或设置为 MSIL，则 %ProgramFiles% 将解析为 C:\Program Files(x86)\。由于没有 64 位 mstest，分辨率应该是无缝的。例如，这是从我的 LocalTestRun.testrunco​​nfig 文件中提取的，然后进行了适当的清理：

```
 <Deployment>
    <DeploymentItem filename="%ProgramFiles%\InternalSuite\" />
  </Deployment> 
```

虽然我还没有机会对此进行全面测试，但这应该可以很好地解决我们的问题。我在我的 32 位系统上对此进行了测试，发现它可以像雨一样解析。

希望这对其他人有帮助！

# .net - 如何使用 LINQ to XML 读取/写入加密的 XML 文件？

> ID：267451
> 
> 赞同：5
> 
> 时间：2008-11-06T02:08:10.540
> 
> 标签：.net, xml, linq, encryption, linq-to-xml

我想使用 LINQ to XML 读/写加密的 XML 文件。有谁知道如何使用 .NET Framework 中内置的加密算法来加密 XDocument 对象使用的 Stream？

我确实尝试过，但您不能将 CryptoStream 设置为读/写访问。它仅支持读取或写入，这会导致 LINQ to XML 引发异常。

更新：“即时”读/写文档会很好，但我只需要读取加密的 xml 文件，对其进行操作，然后再次将其写回加密。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T05:21:26.203

最简单的方法可能是 XDocument.Load()、Linq，然后是 XDocument.Save()。从一个快速测试应用程序（轻松处理非处置资源）：

```
XDocument writeContacts = new XDocument(
   new XElement("contacts",
      new XElement("contact",
         new XElement("name", "Patrick Hines"),
         new XElement("phone", "206-555-0144",
             new XAttribute("type", "home")),
         new XElement("phone", "425-555-0145",
             new XAttribute("type", "work")),
         new XElement("address",
            new XElement("street1", "123 Main St"),
            new XElement("city", "Mercer Island"),
            new XElement("state", "WA"),
            new XElement("postal", "68042")
         )
      )
   )
);

Rijndael RijndaelAlg = Rijndael.Create();

FileStream writeStream = File.Open("data.xml", FileMode.Create);
CryptoStream cStream = new CryptoStream(writeStream,
    RijndaelAlg.CreateEncryptor(RijndaelAlg.Key, RijndaelAlg.IV),
    CryptoStreamMode.Write);

StreamWriter writer = new StreamWriter(cStream);

writeContacts.Save(writer);

writer.Flush();
writer.Close();

FileStream readStream = File.OpenRead("data.xml");

cStream = new CryptoStream(readStream,
  RijndaelAlg.CreateDecryptor(RijndaelAlg.Key, RijndaelAlg.IV),
  CryptoStreamMode.Read);

XmlTextReader reader = new XmlTextReader(cStream);

XDocument readContacts = XDocument.Load(reader);

//manipulate with Linq and Save() when needed 
```

将您最喜欢的 ICryptoTransform 交换到 CryptoStream。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T05:21:38.623

[更新：向 Corbin March 致敬，他（在同一时间）写了同样的东西，但在代码中！]

大多数流*是*一种方式。我想你必须：

*   从（文件等）创建`CryptoStream`读数
*   读取数据（例如读入`XDocument`）
*   做你的代码（阅读文档，进行更改等）
*   对（文件等）进行新的`CryptoStream`写入[从相同的 IV 等开始）
*   将文档保存到流中

根据底层流是什么（`FileStream`,`MemoryStream`等），您可能还必须在读取和写入之间完全关闭/重新打开它（即，`CryptoStream`可能会感觉到基础流的所有权，并且会这样做`.Close()`）。

# c++ - C++ 跨平台 zlib simplifer-wrapper

> ID：267455
> 
> 赞同：10
> 
> 时间：2008-11-06T02:11:07.290
> 
> 标签：c++, zlib

我正在寻找一个将 zlib 提取为的包装器：

1.  打开压缩文件（）
2.  获取项目信息（n）
3.  UnzipItem(n) // 如果项目 n 是目录，则递归解压缩的奖励积分。

我在例如 codeproject.com 上看到很多 zlib 库的包装器，但它们都是特定于平台的，以便提供解压缩到文件/内存缓冲区/管道的附加平台特定功能。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-29T16:44:28.993

在 boost::iostreams 中可以使用 zlib、gzip 和 bzip2 格式。

您可以从[http://www.boost.org/找到它](http://www.boost.org/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T13:15:51.270

在 zlib 源代码存档中，有一个名为“minizip”的贡献。

“minizip”是一组可用于播放 .zip 文件的文件。您需要的基本服务已经存在：

*   解开
*   unzLocateFile
*   unzOpenCurrentFile
*   unzGetCurrentFileInfo
*   unzCloseCurrentFile
*   取消关闭

当然，这不是面向对象的（我确信这不是 minizip 的创建者的目标），但是编写一个简单的面向对象的包装器应该很容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-20T05:34:29.130

[firstobject 的简单 zlib](http://www.firstobject.com/easy-zlib-c++-xml-compression.htm)保持跨平台；它在单个文件 easyzlib.c 中包含 zlib，并且仅公开 ezcompress 和 ezuncompress 函数，并具有在分配确切大小之前确定内存需求的附加功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T14:11:25.387

您可以尝试从另一个 FOSS 项目中获取代码。例如，ScummVM 具有高度可移植的 Zlib 包装器（[实现](http://scummvm.svn.sourceforge.net/viewvc/scummvm/scummvm/trunk/common/unzip.cpp?revision=34899&view=markup)、[标头](http://scummvm.svn.sourceforge.net/viewvc/scummvm/scummvm/trunk/common/unzip.h?revision=34899&view=markup)），其中包含您需要的所有功能，以及用于与任何其他类型的存档进行通用接口的 OO 层。

也许这是一个很好的起点？包装函数是完全独立且可移植的（哎呀，它们甚至可以在 Nintendo DS 上工作），但是 OO 层依赖于许多自定义类，这些类可能很难添加到您自己的项目中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-02T01:12:52.910

这是一个旧线程，但我想我会加入 Boost 的 ZLib 包装器：

[http://www.boost.org/doc/libs/1_47_0/libs/iostreams/doc/classes/zlib.html](http://www.boost.org/doc/libs/1_47_0/libs/iostreams/doc/classes/zlib.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-05T06:29:18.370

如果您将使用 minizip——请注意，zlib 1.2.3 附带的版本有 2GB 导致的 zip 文件限制。IT 将生成大小 >2GB 的 zip - 但您将无法打开它们...

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-21T12:55:34.577

GZStream 值得一看。这是一个很好的围绕 ZLib 的跨平台包装器，它扩展了 STL iostream 类。

[http://www.cs.unc.edu/Research/compgeom/gzstream/](http://www.cs.unc.edu/Research/compgeom/gzstream/)

与其他一些包装器相比，此包装器的优点在于，如果您正在处理非常大的档案，则无需将整个数据集加载到内存中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-08-11T16:03:57.110

您还可以通过自动检测输入格式来检查这个 C++ Zlib 包装器： [https ://github.com/mateidav​​id/zstr](https://github.com/mateidavid/zstr)

# sql-server-2005 - 升级 SQL Server 2000

> ID：267458
> 
> 赞同：-2
> 
> 时间：2008-11-06T02:14:25.193
> 
> 标签：sql-server-2005, sql-server-2000, upgrade

如果我需要将安装在 citrix 中的 MSSQL 2000 升级到 MSSQL 2005

盒子。如何检查它是否兼容。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T03:25:05.737

要测试兼容性，您需要设置一个大致复制预期实时环境的测试环境。

也就是说，您需要设置一个与您的 live citrix 服务器具有相同设置的 Citrix 服务器，并在其上安装 SQL Server 2005，就像您希望将它安装在 live 服务器上一样，然后在 SQL 2005 服务器环境中运行您的应用程序。

这完全取决于您要测试的兼容性。

# db2 - 如何从 DB2 撤销 Windows 管理员用户的权限？

> ID：267465
> 
> 赞同：3
> 
> 时间：2008-11-06T02:18:27.493
> 
> 标签：db2

在 IBM DB2 v.9 windows 上，当有人通过 Server\Administrator 用户连接到数据库时，DB2 数据库会自动接受并授予该用户的所有权限吗？但是，在某些情况下，服务器的环境管理员不需要查看数据库中的所有数据。那么如何防止管理员使用连接数据库呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-04T19:06:09.470

在 9.5 和更早版本上，这是不可能的，因为运行您的实例的帐户是 SYSADM。此外，管理员至少可以重置本地帐户密码并获得对它们的访问权限，从而使更改实例所有者帐户毫无用处。

但是，在 9.7 及更高版本上，实例所有者将无法再访问数据。一种选择是升级到 9.7。此外，您可以为应用程序使用的连接设置 AD 帐户。本地管理员不一定能够更改为这些凭据。

尽管如此，管理员最终还是可以访问（通常是未加密的）数据库文件。您可以主要改进安全性的管理方面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-13T14:36:38.650

我认为在正常情况下不可能仅仅因为管理员在`sysadm`组中。

我能想到（但没有尝试过）的选项包括：

*   将 sysadm 组设置为其他内容（“db2 update dbm cfg using sysadm_group blah”）。执行此操作时检查文档以获取警告和陷阱，因为我确定有一些。
*   停止使用操作系统身份验证。使用不同的安全插件（仅限 8.2 及更高版本）。这会将身份验证和组移动到新位置（例如 LDAP 服务器）。然后，您只是不要将管理员添加到新位置，尤其是不要再次将管理员添加到 sysadm 组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T04:17:31.560

By default, DB2 databases are created with `CONNECT` authority granted to public. If you want to restrict some users from connecting, you need to do

```
GRANT CONNECT ON DATABASE TO <user1>, <user2>, ... 
```

Then revoke the CONNECT authority from PUBLIC

```
REVOKE CONNECT ON DATABASE FROM PUBLIC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T13:17:54.743

嗯...很多次我尝试用这个命令撤销，但是当我通过管理员帐户连接到数据库时，DB2 将再次自动授予管理员权限。

我会再试一次以确保。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-16T23:02:32.580

在 Windows 上，数据库管理器配置参数`SYSADM_GROUP`控制谁拥有`SYSADM`实例级别的权限。如果`SYSADM_GROUP`为空（Windows 上的默认设置），则 DB2 将默认使用本地机器上的 Administrators 组。

要解决此问题，您可以在 Windows 中创建一个新组，然后修改 的值`SYSADM_GROUP`以使用此新组。确保运行 DB2 服务的 ID 属于这个新组。进行此更改后，Administrators 组的成员将不再具有`SYSADM`权限。

正如 Kevin Beck 所说，您可能还想查看`CONNECT`对数据库的权限限制，因为默认情况下该`CONNECT`权限被授予 PUBLIC。

# google-app-engine - Google AppEngine 中 POST 请求中的文件名

> ID：267467
> 
> 赞同：3
> 
> 时间：2008-11-06T02:19:06.573
> 
> 标签：google-app-engine, post

给定html表单...

```
 <form id="mainform" action="/upload" enctype="multipart/form-data" method="post">
        <div>
            <input type="file" name="img"/>
        </div>
        <div>
            <input type="submit" value="Send">
        </div>
    </form> 
```

...和处理程序...

```
class Picture(db.Model):
  image = db.BlobProperty()

class Submission(webapp.RequestHandler):
    def post(self):
        picture = Picture()
        image = self.request.get("img")
        picture.image = db.Blob(image)
        picture.put()
        self.redirect('/') 
```

...处理程序中是否有任何方法可以获取用户为上传输入的文件名？在 PHP 中，我可以参考 $_FILES['img']['name']，但我看不出什么语法（如果有的话）适用于 request.get。在另一个问题中，另一位作者在他的 html 页面中使用 javascript 例程来提取用户每次发生 OnChange 事件时选择的文件名，然后在隐藏字段中单独传递。那有必要吗？PHP 似乎可以免费获得文件名。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T15:08:50.823

我[在 cgi 模块的文档中](http://python.about.com/od/cgiformswithpython/ss/pycgitut1_3.htm)发现了一个解决方案：

```
picture.local_filename = self.request.POST[u'img'].filename 
```

请求的 POST 对象是 FieldStorage 的集合，FieldStorage 对象有一个文件名属性。

# c++ - 为什么`_getstream`会失败？

> ID：267473
> 
> 赞同：1
> 
> 时间：2008-11-06T02:22:15.893
> 
> 标签：c++, file, fopen

例外提到

```
FILE* __cdecl _getstream 
```

我打电话`fopen`，它一直在崩溃。

```
AfxMessageBox("getting here 1");
FILE* filePtr = fopen(fileName, "rb");
AfxMessageBox("getting here 2"); 
```

出于某种原因，我从来没有到达过第二个消息框。有趣的是，当我处于调试模式时，该应用程序运行良好。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T13:44:39.887

我认为内存损坏。在 Windows 上（__cdecl 让我认为您正在使用它），有 Windows 调试工具附带的 gflags 实用程序。有了它，你可以让每个堆分配都有它自己的页面——这将有助于在问题发生时立即捕获内存溢出和双重释放。

我在我的博客上写了说明：

[http://www.atalasoft.com/cs/blogs/loufranco/archive/2007/02/06/6-_2200_Pointers_2200_-on-Debugging-Unmanaged-Code.aspx](http://www.atalasoft.com/cs/blogs/loufranco/archive/2007/02/06/6-_2200_Pointers_2200_-on-Debugging-Unmanaged-Code.aspx)

还有其他提示可以在那里找到这种错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T06:23:45.703

我怀疑你程序的那部分没有问题。最有可能的情况是，您在代码的早期出现了某种内存损坏，而这恰好是它出现的地方。

您是否尝试过在调试模式下通过程序的其余部分（在那部分之后）运行它？如果*是*某种内存损坏，调试模式分配器应该在释放损坏的内存区域时捕获它，如果不是更快的话。当然，假设您使用的是带有彻底调试内存分配器的编译器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-21T20:38:37.733

我怀疑这会影响很多人，因为这相当模糊，但如果你得到你的 FILE* 像这样：

```
HANDLE hMyFile = CreateFile(...);
FILE* pFile = _fdopen( _open_osfhandle((long)hMyFile, <flags>), "rb" );
CloseHandle(hMyFile); 
```

然后，您将为打开的每个文件泄漏一个流。在执行 _open_osfhandle 和 _fdopen 之后，您必须在 pFile 上调用 fclose() 来关闭您的句柄。CloseHandle 显然不够聪明，无法释放 fdopen 与您的句柄关联的垃圾，但 fclose 足够聪明，可以关闭您的句柄以及与 FILE* 相关的垃圾。

我正在开发的应用程序这样做是因为某个 API 在 HANDLE 周围传递，并且该 API 的特定实现者需要一个 FILE*，所以实现者做了 _fdopen/_open_osfhandle 的东西来获得一个 FILE*。然而，这意味着调用者的 CloseHandle 调用不足以完全关闭 HANDLE。修复方法是首先复制传入的 HANDLE，然后 FILE* 代码可以正确地 fclose() FILE* 而不会破坏调用者的 HANDLE。

示例损坏程序：

```
#include "stdafx.h"
#include <Windows.h>
#include <io.h>
#include <assert.h>
#include <fcntl.h>
int _tmain(int argc, _TCHAR* argv[])
{

  for(int x = 0;x < 1024; x++)
  {
    HANDLE hFile = CreateFile(L"c:\\temp\\rawdata.txt",GENERIC_READ,FILE_SHARE_READ,NULL,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,NULL);
    FILE* pFile =  _fdopen( _open_osfhandle((long)hFile, _O_RDONLY | _O_BINARY), "rb" );
    assert(pFile); // this assert will go off at x=509, because _getstream() only has 512 streams, and 3 are reserved for stdin/stdout/stderr
    CloseHandle(hFile);
  }

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-06T05:51:08.140

我猜 fileName 出了点问题（它是否有尾随零？）

尝试将*fopen*行注释掉，看看会发生什么。

# c++ - 使用虚拟参数的 C++ 类成员函数

> ID：267477
> 
> 赞同：2
> 
> 时间：2008-11-06T02:27:33.467
> 
> 标签：c++, parameters, destructor

我知道您可以使用虚拟“int”参数`operator++`并`operator--`覆盖这些运算符的后缀版本，但我隐约记得您可以在析构函数上声明的虚拟参数。有谁知道这一点，如果知道，那个虚拟参数做了什么？

这是在我十几岁时（即*很久*以前）阅读的旧 Turbo C++ 教程书籍中，所以我可能完全记错了它。那也是非常早期的 C++，在它被标准化之前，所以它可能是 Turbo C++ 特有的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T03:29:58.537

您可能正在考虑 operator delete 的放置和 nothrow 形式，它们具有以下签名：

```
void operator delete(void *, void *) throw();
void operator delete(void *, const std::nothrow_t&) throw();
void operator delete[](void *, void *) throw();
void operator delete[](void *, const std::nothrow_t&) throw(); 
```

这些在正常操作期间从不调用，但会在使用[placement new](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.10)构造的对象的构造函数引发异常的情况下使用。通常你不必定义它们，因为编译器已经在死对象的基类和成员上调用了析构函数，并且对于放置 new 没有要释放的内存。但是如果您重载placement new 并且需要相应的运算符，则可以存在。

第二个参数并没有真正使用，只是区分普通的签名：

```
void operator delete(void *) 
```

不过，这些不是 operator++ 的特殊虚拟参数。它们只是使用额外参数调用 new 的一般规则的一个实例，例如：

```
obj = new(x,y,z) Object(a,b,c) 
```

将生成隐式代码以清除将这些相同的附加参数传递给运算符 delete 的构造函数错误，其功能（大约）如下：

```
void *raw = operator new(sizeof(Object), x,y,z)
try {
    obj = new(raw) Object(a,b,c);
} catch(...) {
   operator delete(raw,x,y,z);
   throw;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T02:31:30.183

要么你记错了，要么你应该试着忘记它。析构函数没有参数、返回类型，它们不应该抛出异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T02:33:32.470

我发誓我听说过同样的事情，但[C++ FAQ 似乎说没有这种形式](http://www.parashift.com/c++-faq-lite/dtors.html#faq-11.4)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T02:44:32.980

也许您正在考虑安置新的？

```
class MyClass { /* ... */ };

char * raw_mem = new char [sizeof (MyClass)];
pMyClass = new (raw_mem) MyClass;
// ...
pMyClass-->(~MyClass());
delete[] raw_mem; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-19T03:02:20.170

你没疯。我之前肯定在析构函数中看到过 int 参数。在 OpenVMS 上使用 HP 的编译器，我编译了一个示例程序，如下所示。符号列表确实包含一个带有 int 参数的析构函数。我只能猜测这是特定于编译器的。

```
$ create foo.cxx
class foo
{
 ~foo() {}
};

$ cxx foo.cxx

$ type [.CXX_REPOSITORY]cxx$demangler_db.
CX3$_ZN3FOOD1EV31GNTHJ         foo::$complete$~foo()
CX3$_ZN3FOOD2EV30KQI3A         foo::$subobject$~foo()
CX3$_ZN3FOOD9EV36HH9SB         foo::~foo(int)
CXXL$_ZDLPV                    void operator delete(void *) 
```

# inversion-of-control - Castle Windsor 是否允许解析值类型？

> ID：267483
> 
> 赞同：3
> 
> 时间：2008-11-06T02:32:19.260
> 
> 标签：inversion-of-control, castle-windsor, castle

我正在尝试将参数传递给需要 System.TimeSpan 的组件。我只能解决“长滴答声” ctor。

这是配置文件的片段：

```
<component id="timeInForce" type="System.TimeSpan, mscorlib">
  <parameters>
    <hours>0</hours>
    <minutes>15</minutes>
    <seconds>0</seconds>
  </parameters>
</component>

<component id="FooSettings" type="Foo.FooSettings, Foo">
    <parameters>
        <tif>${timeInForce}</tif>
    </parameters>
</component> 
```

这是一个例外：

```
Castle.MicroKernel.Handlers.HandlerException : Cant create component 'timeInForce'
as it has dependencies to be satisfied. 
timeInForce is waiting for the following dependencies: 

Keys (components with specific keys)
    - ticks which was not registered. 
```

为组件参数传递刻度值是可行的，如下所示：

```
<parameters><tif>0</tif></parameters> 
```

但这违背了目的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T10:00:20.213

发生的事情（据我所见）是 ticks 属性被错误地标识为强制参数（因为它属于具有最少参数的构造函数），即使所有值类型都有一个默认的无参数构造函数。

但是，即使您提供了其他参数（即刻度），仍然会选择匹配最多参数的构造函数候选者，因此您可以通过在参数列表中包含刻度来解决此问题：

```
<component id="timeInForce"" type="System.TimeSpan, mscorlib">
<parameters>
  <ticks>0</ticks>
  <hours>0</hours>
  <minutes>15</minutes>
  <seconds>0</seconds>
</parameters>
</component> 
```

这是一个快速测试来验证它是否有效（通过城堡树干）：

```
string xml = @"<?xml version=""1.0"" encoding=""utf-8"" ?> 
<castle>
<components>
<component id=""timeInForce"" type=""System.TimeSpan, mscorlib"">
<parameters>
  <ticks>0</ticks>
  <hours>0</hours>
  <minutes>15</minutes>
  <seconds>0</seconds>
</parameters>
</component>
</components>
</castle>";

WindsorContainer container = new WindsorContainer(
  new XmlInterpreter(new StaticContentResource(xml)));

TimeSpan span = container.Resolve<TimeSpan>("timeInForce");

Assert.AreEqual(new TimeSpan(0, 15, 0), span); 
```

但是，我建议而不是您使用的方法是实现您自己的类型转换器，如[城堡文档](http://www.castleproject.org/container/documentation/trunk/usersguide/typeconverters.html)中所述。

这样，您可以为时间跨度开发自己的速记形式，即“15m”或“2h15m”或任何您喜欢的形式 - 使您的配置更易于阅读和维护，并解决您当前遇到的问题。

# delphi - 在 Delphi 7 中，如何在 Format 函数中转义百分号 (%)？

> ID：267487
> 
> 赞同：22
> 
> 时间：2008-11-06T02:33:40.990
> 
> 标签：delphi, format, escaping, delphi-7

我想做这样的事情：

```
SQL.Text := Format('select foo from bar where baz like ''%s%''',[SearchTerm]); 
```

但是 Format 不喜欢最后一个 '%'，当然。那么我该如何逃脱呢？`\%`? `%%`?

还是我必须这样做：

```
SQL.Text := Format('select foo from bar where baz like ''%s''',[SearchTerm+'%']); 
```

?

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-06T02:44:33.993

在格式字符串中使用另一个 %：

```
SQL.Text := Format('select foo from bar where baz like ''%s%%''',[SearchTerm]); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T02:40:56.030

%%，IIRC。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T10:27:54.370

强制性：http: [//xkcd.com/327/](http://xkcd.com/327/) :-)

根据上下文，您的方法可能容易受到 SQL 注入的影响。如果搜索词来自用户输入，那么使用参数化查询或至少尝试清理输入可能会更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-23T10:19:09.217

添加 2 个百分号以获得 1 个单 %
示例：

```
 Format('select foo from bar where baz like ''%%%s%%'',[SearchString]) 
```

给你

```
select foo from bar where baz like '%SearchString%' 
```

# vb.net - Linq to Sql：多个左外连接

> ID：267488
> 
> 赞同：161
> 
> 时间：2008-11-06T02:34:00.037
> 
> 标签：vb.net, linq, linq-to-sql, tsql, left-join

我在弄清楚如何使用 LINQ to SQL 使用多个左外连接时遇到了一些麻烦。我了解如何使用一个左外连接。我正在使用 VB.NET。下面是我的 SQL 语法。

**T-SQL**

```
SELECT
    o.OrderNumber,
    v.VendorName,
    s.StatusName
FROM
    Orders o
LEFT OUTER JOIN Vendors v ON
    v.Id = o.VendorId
LEFT OUTER JOIN Status s ON
    s.Id = o.StatusId
WHERE
    o.OrderNumber >= 100000 AND
    o.OrderNumber <= 200000 
```

* * *

## 回答 #1

> 赞同：249
> 
> 时间：2009-12-28T19:23:20.243

这可能更干净（**您不需要所有`into`语句**）：

```
var query = 
    from order in dc.Orders
    from vendor 
    in dc.Vendors
        .Where(v => v.Id == order.VendorId)
        .DefaultIfEmpty()
    from status 
    in dc.Status
        .Where(s => s.Id == order.StatusId)
        .DefaultIfEmpty()
    select new { Order = order, Vendor = vendor, Status = status } 
    //Vendor and Status properties will be null if the left join is null 
```

这是另一个左连接示例

```
var results = 
    from expense in expenseDataContext.ExpenseDtos
    where expense.Id == expenseId //some expense id that was passed in
    from category 
    // left join on categories table if exists
    in expenseDataContext.CategoryDtos
                         .Where(c => c.Id == expense.CategoryId)
                         .DefaultIfEmpty() 
    // left join on expense type table if exists
    from expenseType 
    in expenseDataContext.ExpenseTypeDtos
                         .Where(e => e.Id == expense.ExpenseTypeId)
                         .DefaultIfEmpty()
    // left join on currency table if exists
    from currency 
    in expenseDataContext.CurrencyDtos
                         .Where(c => c.CurrencyID == expense.FKCurrencyID)
                         .DefaultIfEmpty() 
    select new 
    { 
        Expense = expense,
        // category will be null if join doesn't exist
        Category = category,
        // expensetype will be null if join doesn't exist
        ExpenseType = expenseType,
        // currency will be null if join doesn't exist
        Currency = currency  
    } 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-11-06T04:22:55.683

无法访问 VisualStudio（我在我的 Mac 上），但使用来自[http://bhaidar.net/cs/archive/2007/08/01/left-outer-join-in-linq-to的信息-sql.aspx](http://bhaidar.net/cs/archive/2007/08/01/left-outer-join-in-linq-to-sql.aspx)看起来您可以执行以下操作：

```
var query = from o in dc.Orders
            join v in dc.Vendors on o.VendorId equals v.Id into ov
            from x in ov.DefaultIfEmpty()
            join s in dc.Status on o.StatusId equals s.Id into os
            from y in os.DefaultIfEmpty()
            select new { o.OrderNumber, x.VendorName, y.StatusName } 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-11-06T15:01:05.347

我想出了如何使用 LINQ to SQL 在 VB.NET 中使用多个左外连接：

```
Dim db As New ContractDataContext()

Dim query = From o In db.Orders _
            Group Join v In db.Vendors _
            On v.VendorNumber Equals o.VendorNumber _
            Into ov = Group _
            From x In ov.DefaultIfEmpty() _
            Group Join s In db.Status _
            On s.Id Equals o.StatusId Into os = Group _
            From y In os.DefaultIfEmpty() _
            Where o.OrderNumber >= 100000 And o.OrderNumber <= 200000 _
            Select Vendor_Name = x.Name, _
                   Order_Number = o.OrderNumber, _
                   Status_Name = y.StatusName 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-17T01:28:22.380

在 VB.NET 中使用函数，

```
Dim query = From order In dc.Orders
            From vendor In 
            dc.Vendors.Where(Function(v) v.Id = order.VendorId).DefaultIfEmpty()
            From status In 
            dc.Status.Where(Function(s) s.Id = order.StatusId).DefaultIfEmpty()
            Select Order = order, Vendor = vendor, Status = status 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-06T03:12:14.983

我认为您应该能够遵循本文中使用的[方法](http://blogs.msdn.com/vbteam/archive/2008/01/31/converting-sql-to-linq-part-8-left-right-outer-join-bill-horst.aspx)。它看起来真的很难看，但我认为你可以做两次并得到你想要的结果。

我想知道这是否真的是你最好使用`DataContext.ExecuteCommand(...)`而不是转换为 linq 的情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-08T07:53:57.577

我正在为我的应用程序使用这个 linq 查询。如果这符合您的要求，您可以参考这个。在这里，我加入了（左外连接）3 个表。

```
 Dim result = (From csL In contractEntity.CSLogin.Where(Function(cs) cs.Login = login AndAlso cs.Password = password).DefaultIfEmpty
                   From usrT In contractEntity.UserType.Where(Function(uTyp) uTyp.UserTypeID = csL.UserTyp).DefaultIfEmpty ' <== makes join left join
                   From kunD In contractEntity.EmployeeMaster.Where(Function(kunDat) kunDat.CSLoginID = csL.CSLoginID).DefaultIfEmpty
                   Select New With {
                  .CSLoginID = csL.CSLoginID,
                  .UserType = csL.UserTyp}).ToList() 
```

# c++ - 在 OSX 中查看/绘制 C 或 C++ 源文件的函数调用层次结构的工具

> ID：267507
> 
> 赞同：2
> 
> 时间：2008-11-06T02:46:21.977
> 
> 标签：c++, c, macos, diagram

OSX 有没有好的源代码分析工具。我对能够为 C 和 C++ 源文件绘制函数调用层次结构图的工具特别感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T02:48:20.553

你可以看看[doxygen](http://www.doxygen.nl/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T02:50:13.420

[doxygen](http://www.doxygen.nl/)可以做到这一点以及更多。

# javascript - 获取属性 HTMLDocument.body 的权限被拒绝

> ID：267517
> 
> 赞同：1
> 
> 时间：2008-11-06T02:49:46.260
> 
> 标签：javascript

我正在我的应用程序的一个页面中做一个隐藏的 http 帖子，它将通过 iframe 登录到另一个应用程序。

在该 iframe 中，我能够访问该应用程序的某些功能，但是当我尝试保存和更新某些内容时，我遇到了 javascript Permission denied to get property HTMLDocument.body in 该应用程序。

这种奇怪行为的任何原因以及如何解决此问题？

是的，我指的是另一个域。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T02:52:05.897

您是否 iframe 引用了另一个域？如果是这样，您可能会遇到浏览器的跨站点脚本防御。

# mysql - 在具有整数数据类型的数据库中表示无限

> ID：267521
> 
> 赞同：22
> 
> 时间：2008-11-06T02:51:09.597
> 
> 标签：mysql, types

我有一个表格可以保存一些帐户限制，例如用户。对于大多数行，此值将是一个整数。但是，我还需要支持将无限（无限）存储为值。这可能看起来很愚蠢，但是否有一个代表无限（无限）的通用整数值？我想继续将值存储为整数。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-06T02:53:33.490

*   使用零
*   使用 -1
*   使用空

我更喜欢 null，除非该字段不可为空，然后我更喜欢零，除非零是有效限制，然后我更喜欢 -1，除非 -1 是有效值，在这种情况下您需要*另一个字段*（例如，位字段) 表示“无限”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-11T17:40:57.170

你不可能真正拥有无限数量的帐户，因为没有无限数量的人。事实上，您可以拥有的帐户数量确实受到限制（如果您选择将值存储在单个数据库列中），因为任何可数事物的有限存储机制都有限制。我建议，使用@Tor Haugen，最好的方法是使用系统施加的限制（无论您的语言提供的最大整数或长度）。这样您就不必担心任何特殊情况进行比较。此外，我会使用数据库约束来防止在字段中存储负值。一个 64 位整数肯定可以容纳一个足够大的数字，对于您的应用程序实际上是无限的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T02:54:55.377

好吧，如果您从 .NET 访问数据库，整数类型具有常量成员 MaxValue 和 MinValue。我们有时用它们来表示无穷大。当然，这些值在您的 RDBMS 中没有特殊意义……

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T02:55:47.217

作为一个整数，无穷大将是困难的。几个选项：

1）-1，具有将其视为无限的相应程序逻辑（并假设负值实际上无效）。

2) 一个额外的列，其中包含一个指示有限/无限的标志。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-26T23:59:50.467

我认为没有完美的解决方案。所以这是我的建议：

创建表示可以存储在数据库中的最大值的常量，并将它们视为“无穷大”。

[http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html#integer-types](http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html#integer-types)

# sql - 查询：叉积而不是连接

> ID：267530
> 
> 赞同：1
> 
> 时间：2008-11-06T02:56:34.670
> 
> 标签：sql, cross-product

我有两个要加入的表，但我从 MySQL 收到一个错误

```
Table: books
bookTagNum ShelfTagNum
book1      1
book2      2
book3      2

Table: shelf
shelfNum   shelfTagNum
1          shelf1
2          shelf2 
```

我希望我的结果是：

```
bookTagNum ShelfTagNum shelfNum
book1      shelf1           1
book2      shelf2           2
book3      shelf2           2 
```

但相反，我也得到了一个额外的结果：

```
book1      shelf2           2 
```

我认为我的查询是做交叉产品而不是连接：

```
SELECT `books`.`bookTagNum` , `books`.`shelfNum` , `shelf`.`shelfTagNum` , `books`.`title`
FROM books, shelf
where `books`.`shelfNum`=`books`.`shelfNum`
ORDER BY `shelf`.`shelfTagNum` ASC
LIMIT 0 , 30 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T03:00:27.160

我想你想要

```
where `books`.`shelfTagNum`=`shelf`.`shelfNum` 
```

为了匹配`books`和`shelf`表中的行，您需要在`where`子句中包含每个中的术语 - 否则，您只是对 的行执行无操作检查`books`，因为每一行都`shelfNum`将等于它的`shelfNum`.

正如@fixme.myopenid.com 建议的那样，您也可以走明确的`JOIN`路线，但这不是必需的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T03:13:12.470

如果你想确定你是在做一个连接而不是一个交叉产品，你应该在 SQL 中明确声明它，因此：

```
SELECT books.bookTagNum,books.shelfNum, shelf.shelfTagNum, books.title
FROM books INNER JOIN shelf ON books.shelfNum = shelf.shelfTagNum
ORDER BY shelf.shelfTagNum 
```

（这将只返回两个表中都存在的那些行），或者：

```
SELECT books.bookTagNum,books.shelfNum, shelf.shelfTagNum, books.title
FROM books LEFT OUTER JOIN shelf ON books.shelfNum = shelf.shelfTagNum
ORDER BY shelf.shelfTagNum 
```

（这将返回书籍中的所有行），或者：

```
SELECT books.bookTagNum,books.shelfNum, shelf.shelfTagNum, books.title
FROM books RIGHT OUTER JOIN shelf ON books.shelfNum = shelf.shelfTagNum
ORDER BY shelf.shelfTagNum 
```

（这将返回架子上的所有行）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T04:24:13.543

仅供参考：如果你重写你的名字以保持一致，事情就会变得更容易阅读。

```
Table 1: Book
BookID     ShelfID  BookName
1          1        book1
2          2        book2
3          2        book3

Table 2: Shelf
ShelfID    ShelfName
1          shelf1
2          shelf2 
```

现在，将书籍提取到书架上的查询是

```
SELECT 
 b.BookName,
 s.ShelfName
FROM
 Book b
JOIN Shelf s ON s.ShelfID = b.ShelfID 
```

* * *

要回答原始问题：

```
> where `books`.`shelfNum`=`books`.`shelfNum`
>        ^^^^^--------------^^^^^------------- books repeated - this is an error 
```

正如所写的那样，该`WHERE`子句什么都不做，并且因为您的 where 子句不限制任何行，所以您确实得到了叉积。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T03:02:34.737

检查你的 SQL。您的 where 子句不可能是`books`。`shelfNum`= `books`。`shelfNum`

这些单引号是干什么用的？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T03:01:05.927

尝试这个：

```
SELECT `books`.`bookTagNum` , `books`.`shelfNum` , `shelf`.`shelfTagNum` , 
   `books`.`title`
FROM books, shelf
where `books`.`shelftagNum`=`shelf`.`shelfNum`
ORDER BY `shelf`.`shelfTagNum` ASC
LIMIT 0 , 30 
```

由于未正确说明隐式 JOIN 条件，因此结果是叉积。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-06T20:26:12.173

正如其他人所提到的，您面临的问题是您的 ON 条件。具体回答您的问题：

在 MySQL 中，如果省略 JOIN，则使用 INNER JOIN/CROSS JOIN。对于其他数据库，情况有所不同。例如，PostgreSQL 使用 CROSS JOIN，而不是 INNER JOIN。

回复：[http ://dev.mysql.com/doc/refman/5.7/en/join.html](http://dev.mysql.com/doc/refman/5.7/en/join.html)

“在 MySQL 中，JOIN、CROSS JOIN 和 INNER JOIN 是语法等价物（它们可以相互替换）。在标准 SQL 中，它们不等价。INNER JOIN 与 ON 子句一起使用，否则使用 CROSS JOIN。”

# php - 本机 PHP 函数将允许我直接访问字符串部分而无需创建临时数组？

> ID：267534
> 
> 赞同：-7
> 
> 时间：2008-11-06T03:01:46.643
> 
> 标签：php

我之前问过这个问题，但是在[这里](https://stackoverflow.com/questions/264441/does-a-native-php-5-function-exist-that-does-the-following-in-1-line)我认为我提出的问题很糟糕，并且得到了很多可能对某人有用但没有解决实际问题的回复，所以我再次提出这个问题。

php 中是否有单行本机方法可以让我执行以下操作。拜托，拜托，我知道还有其他方法可以做这个简单的事情，但我提出的问题是**PHP**中是否存在原生的东西，它可以**让我直接访问数组**值，**而无需创建临时数组**。

```
$rand_place = explode(",",loadFile("csvOf20000places.txt")){rand(0,1000)}; 
```

这是一个语法错误，但理想情况下，如果这有效，那就太好了！

目前，必须创建一个临时数组似乎是不可避免的，即

**以下是我要避免的：**

```
$temporary_places_array = explode(",",loadFile("csvOf20000places.txt"));
$rand_place = $temporary_places_array[rand(0,1000)]; 
```

另外，我必须注意，我的实际意图不是解析字符串，也不是从数组中随机提取。**我只是想在没有临时变量的情况下访问字符串**。这只是一个例子，我希望它很容易理解。很多时候，服务调用或您无法控制的事情会返回一个数组（例如 explode() 函数），而您只想访问它而无需创建临时变量。

**NATIVELY NATIVELY NATIVELY，我知道我可以创建一个函数来完成它。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T03:12:50.393

**不，没有办法在本地做到这一点。**

但是，您可以：

1.- 存储不可避免的数组而不是字符串。鉴于 PHP 的局限性，我认为这是最有意义的。

另外，别忘了你可以[unset()](http://php.net/unset)

2.- 使用 strpos() 和朋友将字符串解析成你需要的，如其他答案所示，我不会在这里粘贴。

3.- 创建一个函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T03:21:05.340

没有本地 PHP 方法可以做到这一点。

你可以做一个这样的函数：

```
function array_value($array, $key) {
    return $array[$key];
} 
```

然后像这样使用它：

```
$places = "alabama,alaska,arizona .... zimbabway"; 
$random_place = array_value(explode(",", $places), rand(0, 1000)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T04:03:21.433

我知道用一个问题来回答一个问题的形式很糟糕，但是你为什么要担心这个呢？这是一个挑剔的问题，还是一个优化问题？Zend 引擎将对此进行优化。

*但是，我要*指出您不必创建临时变量：

```
$rand_place = explode(",",loadFile("csvOf20000places.txt"));
$rand_place = $rand_place[rand(0,1000)]; 
```

由于类型可变性，您可以重用该变量。当然，您仍然没有跳过一步。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T04:09:35.927

```
list($rand_place) = array_slice(explode(',', loadFile("csvOf20000places.txt")), array_rand(explode(',', loadFile("csvOf20000places.txt"))), 1); 
```

**编辑：**好的，你是对的。这个问题*很难*理解，但我认为就是这样。上面的代码将从 csv 文件中提取随机项目，但是，要提取任何您想要的内容，请使用以下代码：

```
list($rand_place) = array_slice(explode(',', loadFile("csvOf20000places.txt")), {YOUR_NUMBER}, 1); 
```

用您要提取的值的数字键替换支架。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T03:13:21.300

如果是内存问题，还有其他方法可以解决这个问题，而不是拆分成一个数组。但是不，没有内置的东西可以处理这种情况。

作为替代方案，您可以尝试：

```
$pos = 0;
$num = 0;
while(($pos = strpos($places, ',', $pos+1)) !== false) {$num++;}
$which = rand(0, $num);
$num = 0;
while($num <= $which) {$pos = strpos($places, ',', $pos+1);}
$random_place = substr($places, $pos, strpos($places, ',', $pos+1)); 
```

我还没有对此进行测试，因此其中可能存在一些问题，但是您明白了。这可以通过缓存您在第一个循环中计算的位置来缩短（更快），但这会让您回到内存问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T03:42:13.860

你可以这样做：

```
<?php
function foo() {
    return new ArrayObject(explode(",", "zero,one,two"));
}
echo foo()->offsetGet(1);    // "one"
?> 
```

可悲的是你**不能**这样做：

```
echo (new ArrayObject(explode(",", "zero,one,two")))->offsetGet(2); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T04:04:54.517

去年我花了很多时间研究 PHP 的高级 CSV 解析，我承认随意在文件上随机搜索会很好。我的半死胡同之一是扫描一个已知文件，并对不在行首的所有已知 \n 的位置进行索引。

```
 //Grab and load our index
$index = unserialize(file_get_contents('somefile.ext.ind'));
//What it looks like
$index = array( 0 => 83, 1 => 162, 2 => 178, ....);

$fHandle = fopen("somefile.ext",'RB');
$randPos = rand(0, count($index));
fseek($fHandle, $index[$randPos]);
$line = explode(",", fgets($fHandle)); 
```

这是我可以看到它在任何接近你需要的地方完成的唯一方法。至于创建索引，那是基本的东西。

```
$fHandle = fopen('somefile.ext','rb');
$index = array();
for($i = 0; false !== ($char = fgetc($fHandle)); $i++){
      if($char === "\n") $index[] = $i;     
} 
```

# c - 远程登录服务器

> ID：267538
> 
> 赞同：5
> 
> 时间：2008-11-06T03:03:43.267
> 
> 标签：c, telnet

我想在 C 中实现一个 telnet 服务器。我将如何进行呢？我应该查看哪些 RFC？这对我很重要，我将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T03:07:10.110

对于非常基本的 telnet（只是 telnet 到端口和回显字节），没有什么可做的。从套接字读取，处理它（在回显服务器中，什么都不做），返回结果。您可以在不了解任何 RFC 的任何内容的情况下实现简单的 MUD 样式服务器。

但如果您真的关心 RFC，那么 RFC 854 可能是一个起点。

[http://www.faqs.org/rfcs/rfc854.html](http://www.faqs.org/rfcs/rfc854.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T07:12:44.450

如果您对网络编程很认真，我强烈推荐 Richard W. Stevens 的“ [UNIX 网络编程第 1 卷](https://rads.stackoverflow.com/amzn/click/com/0131411551)”——它比 RFC 具有很好的示例要好得多。

这是一本非常昂贵的书，但 eBay 上有便宜的平装本。即使你得到昂贵的精装版，它也值得你付出的每一分钱。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-07T07:52:29.893

请注意，真正的 telnet**不仅仅是**一个处理用户登录 shell`stdin`和的简单接口。`stdout`

“选项”中单独提供了许多附加功能，它们处理诸如设置`$TERM`环境变量、设置行/列（如果用户调整终端大小则重置它们）之类的事情。

如果您正在寻找*真正的*telnet，而不仅仅是一个简单的 TCP 服务器，那么 RFC 854 确实是您的起点。然而，还有更多相关的 RFC 描述了上面提到的那些选项，这些选项列在[http://en.wikipedia.org/wiki/Telnet](http://en.wikipedia.org/wiki/Telnet)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T04:41:08.843

如果您需要有关套接字编程等方面的帮助。

结帐beej的指南：[http ://beej.us/guide/bgnet/](http://beej.us/guide/bgnet/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-06-17T17:54:15.170

我建议安装[Wireshark](http://www.wireshark.org/)以使用现有的 Telnet 服务器监视 Telnet 流量。然后查看日志，您可以更好地了解服务器如何与客户端通信。然后，如果您不了解通过网络传输的任何命令，请使用 RFC 作为参考。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-07T07:07:48.190

了解套接字 API 在内部是如何工作的非常有用，因为它通常会通过高级语言进行非常小的更改来导出。

也就是说，您可能想要使用[GLib](http://gtk.org)提供的事件循环支持并使用相关的网络库[GNet](http://gnetlibrary.org)。

下面是如何使用 GNet 在端口 4000 上打开一个套接字，然后关闭与其建立的每个连接。这里有一点魔力，因为服务器将自己注册到默认的主上下文作为其创建的一部分。

```
#include <glib.h>
#include <gnet.h>

void client_connect(GServer G_GNUC_UNUSED *server, GConn *conn, gpointer G_GNUC_UNUSED user_data){
  g_print("Connection from %s\n", conn->hostname);
  gnet_conn_disconnect(conn);
  gnet_conn_unref(conn); conn = NULL;
}

int main(void){
  GMainLoop *loop = g_main_loop_new(NULL, FALSE);
  GServer *server;
  gnet_init();
  server = gnet_server_new(NULL, 4000, client_connect, NULL);
  g_main_loop_run(loop);
  g_main_loop_unref(loop); loop = NULL;
  return 0;
} 
```

# c++ - .访问冲突读取位置

> ID：267540
> 
> 赞同：0
> 
> 时间：2008-11-06T03:08:22.930
> 
> 标签：c++, boost, smart-pointers, access-violation

我遇到了一个非常奇怪的问题。

代码如下：

```
::boost::shared_ptr<CQImageFileInfo> pInfo=CQUserViewDataManager::GetInstance()->GetImageFileInfo(nIndex); 
Image* pImage=pInfo->m_pThumbnail;
if(pImage==NULL)
    pImage=m_pStretchedDefaultThumbImage;
else
{
    //
    int sourceWidth  = pInfo->GetWidth();
    int sourceHeight = pInfo->GetHeight();

    int destX = 0,
        destY = 0; 

    float nPercent  = 0;
    float nPercentW = ((float)GetThumbImageWidth()/(float)sourceWidth);;
    float nPercentH = ((float)GetThumbImageHeight()/(float)sourceHeight);

    if(nPercentH < nPercentW)
    {
        nPercent = nPercentH;
        destX    = (int)((GetThumbImageWidth() - (sourceWidth * nPercent))/2);
    }
    else
    {
        nPercent = nPercentW;
        destY    = (int)((GetThumbImageHeight() - (sourceHeight * nPercent))/2);
    }

    int destWidth  = (int)(sourceWidth * nPercent);
    int destHeight = (int)(sourceHeight * nPercent);
    rcShowImage=CRect(rc.left+destX, rc.top+destY,rc.left+destX+destWidth,rc.top+destY+destHeight);
}
ASSERT(pImage != NULL); // passed assertion...
graphics.DrawImage(pImage,rcShowImage.left,rcShowImage.top,
rcShowImage.Width(),rcShowImage.Height()); // problem happened here. 
```

我收到以下异常：

```
First-chance exception at 0x004095b0 in ec.exe: 0xC0000005: Access violation reading location 0xfeeefef2.
Unhandled exception at 0x004095b0 in ec.exe: 0xC0000005: Access violation reading location 0xfeeefef2. 
```

我已经检查了`pImage`，我确定什么时候`graphics.DrawImage`被调用，它不是`NULL`。

*   为什么会出现这样的问题？
*   是什么`0xfeeefef2`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-06T03:47:14.087

`0xfeeefeee`是 Windows 堆的调试版本（不是 C 运行时堆）用于未初始化内存的填充模式。`0xfeeefef2`是`0xfeeefeee+4`。听起来您正在取消引用位于（或复制自）从堆分配的内存块中的未初始化指针。

当您在调试器中启动程序时，调试堆会自动启用，而不是使用调试器附加到已经运行的程序。

Mario Hewardt 和 Daniel Pravat所著的*[Advanced Windows Debugging](http://www.advancedwindowsdebugging.com/)*一书提供了一些关于 Windows 堆的不错信息，事实证明，关于堆的章节[作为示例章节已在网站上发布](http://www.advancedwindowsdebugging.com/ch06.pdf)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T03:32:58.483

当你这样做

```
pImage=m_pStretchedDefaultThumbImage; 
```

m_pStretchedDefaultThumbImage 是否有可能未初始化？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T03:28:55.230

如果`pImage == NULL`在第三行粘贴会发生什么？在这种情况下，`rcShowImage`不分配值。

# apache-flex - String(value) 和 value as String 有什么区别？

> ID：267553
> 
> 赞同：5
> 
> 时间：2008-11-06T03:23:26.443
> 
> 标签：apache-flex, flash, actionscript-3

只是为了说明这一点 - 有什么区别：

```
String(value) 
```

和

```
value as String 
```

在哪些情况下您会使用其中一种？它们似乎可以互换...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T03:34:57.293

使用 Type(variable) 进行强制转换可能会导致运行时异常 (RTE)，而“作为类型的变量”将返回 null 而不是引发异常。

有关更多说明，请参阅[http://raghuonflex.wordpress.com/2007/07/27/casting-vs-the-as-operator/](http://raghuonflex.wordpress.com/2007/07/27/casting-vs-the-as-operator/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T14:49:58.380

String (value) 从字符串文字创建一个新的 String 对象。如果构造函数参数不是字符串文字，我假设它调用参数对象的 .toString() 方法。

如果 value 是 String 或 String 的子类，则 value as String 将简单地传回 value。如果 value 不是 String 类型，它将返回 null。

需要注意的重要一点是 String(val) 创建了一个新对象，而 value as String 只是引用 value（并测试与 String 的兼容性）。

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/String.html](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/String.html)

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/operators.html#as](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/operators.html#as)

# asp.net - 如何阻止 Google 索引我的自定义 404 错误页面？

> ID：267578
> 
> 赞同：3
> 
> 时间：2008-11-06T03:42:58.807
> 
> 标签：asp.net

我使用 ASP.Net，我有一个自定义的 404 页面。当用户粘贴未找到的 url 时，它将重定向到自定义 404 页面。但是谷歌索引我的自定义 404 页面。搜索 404（未找到页面）。

有人有解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T03:46:49.967

您可以将错误目录或每个文件添加到站点根目录中的 robots.txt 文件中，从而使 Google 无法访问它们。这实际上适用于您不希望谷歌索引的任何目录/文件。

有关 robots.txt 的更多信息，请访问[http://en.wikipedia.org/wiki/Robots.txt](http://en.wikipedia.org/wiki/Robots.txt) 或[http://www.robotstxt.org/](http://www.robotstxt.org/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T05:47:39.460

您可能希望确保您的“404 页面”实际上发送的是 HTTP 404 响应代码，而不仅仅是一个显示 404 但实际上以 HTTP 200 响应的页面。我不相信谷歌（或其他主要搜索引擎）会索引由以 404 响应的请求产生的页面。

更大的问题是蜘蛛如何到达您的 404 页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T05:20:17.860

您可以使用 robots 元标记来阻止 Google 将 404 页面编入索引。

```
<META NAME="ROBOTS" CONTENT="NOINDEX"> 
```

谷[歌网站管理员博客](http://googlewebmastercentral.blogspot.com/2007/03/using-robots-meta-tag.html)表明他们不会索引带有这个元标记的页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T03:45:47.927

您将始终看到 Google 的日志条目访问您的 404 页面。因为 Google 需要请求该页面才能知道它的状态为 404。但是，如果这就是您要问的，您应该永远不会在搜索结果中看到此页面？

# c# - 通过用户控件进行 ASP.NET MVC 数据反馈

> ID：267589
> 
> 赞同：0
> 
> 时间：2008-11-06T03:50:22.440
> 
> 标签：c#, asp.net-mvc

在我们的新产品中，我们有一些数据输入字段，要求您搜索正确的值以放置在该字段中。

当您输入此数据输入字段时，我想通过视图上的某些内容（可能是 Ajax 实现）提供一个搜索选项，并让它允许在数据库中搜索值，但是当结果返回时，我想保留现有值用于不受搜索影响的其他字段。

但我不知道如何用 MVC 做到这一点。有人对如何做到这一点有任何建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T13:34:10.063

以通常的方式为 ASP.NET MVC 视图编写数据输入页面。让它在没有 Ajax 的情况下工作（例如，当您只输入值时提交工作正常，没有自动完成）。

编写一个 JavaScript 方法的原型，当用户执行某个操作（例如，按下某个控件内的某个键）时，您将调用该方法。但这在您的 aspx 页面中的脚本标记内。不幸的是，堆栈溢出似乎在我的示例中“清理”了脚本标签，因此我无法演示该部分。但是你的 JavaScript 原型看起来像这样：

```
function startAutoComplete() {
} 
```

现在在用户界面控件上连接事件处理程序。你需要调用你刚刚为你的应用程序设计一个合适的事件处理程序原型的函数。根据您的描述，听起来您可能想使用[onkeydown](http://www.w3schools.com/jsref/jsref_onkeydown.asp)，但有[很多事件可供选择](http://www.w3schools.com/jsref/jsref_events.asp)。根据您的应用程序，您可能需要处理多个事件。

到目前为止，我们所做的一切都是标准的 aspx 和 JavaScript。在这一步中，我们将完成整个过程中唯一与 ASP.NET MVC 不同的部分。您需要向控制器添加一个操作，该操作将由您刚刚编写的 JavaScript 原型（间接）调用。该操作应接受适当的输入（例如，表示来自控件的文本的字符串，或适合您的应用程序的类似内容）并以 JSON 格式返回其结果。我将在这里展示一个非常简单的例子；随意在您的实际应用程序中替换更复杂的代码。

```
public ActionResult GetSuggestions(string searchText)
{
    return Json(new {SearchText = searchText});
} 
```

此示例仅返回一个包含一个属性的 JavaScript 对象，该属性包含传递给函数的值。就像你说的，你可以写一些对你的应用程序更有用的东西。

现在你需要在 JavaScript 中调用这个函数。URI 将类似于：

```
http://localhost/mycontroller/GetSuggestions?searchText=Foo 
```

可以在没有 JavaScript 库的情况下进行 Ajax 调用，但如果您使用 jQuery 或其他为您处理跨浏览器兼容性问题的库，则更容易。因为我碰巧喜欢 jQuery，所以我会证明这一点。让我们更新我们之前原型化的 startAutoComplete 方法：

```
function startAutoComplete() {
    var searchText = $("#myeditorid").text();
    $.getJSON("/mycontroller/GetSuggestions?searchText=" + searchText,
        null,
        autoCompleteResponse);
} 
```

第一行使用 jQuery 获取 ID 为 myeditorid 的控件中的文本。我们将把它作为 searchText 参数传递给 ASP.NET MVC 操作，方法是将其附加为查询字符串参数。

以 $.getJSON 开头的下一行调用一个 jQuery 函数，该函数对您指定的 URI 进行 Ajax 调用。我们传递了一个参数 autoCompleteResponse，它是在来自 Ajax 调用的响应成功时要调用的 JavaScript 方法的名称。现在我们必须编写 autoCompleteResponse。

```
function autoCompleteResponse(data) {
    if (data.SearchText)
    {
        $("#myeditorid").text(data.SearchText);
    }
} 
```

这表示，“如果返回的数据具有 SearchText 属性，请将控件的文本设置为该值。” 再次，对返回的数据执行任何适合您的应用程序的操作。

# c# - 绑定源是带有属性路径的字符串

> ID：267603
> 
> 赞同：7
> 
> 时间：2008-11-06T04:01:29.767
> 
> 标签：c#, wpf, binding

我不确定这是否可能，但我想我会问。首先，出于我的目的，我要求它在 C# 部分而不是 XAML 部分中工作。这就是我所拥有的并且它有效：

```
public partial class MyClass1 : Window
{
     public MyClass2 MyClass2Object { get; set; }

     public MyClass1()
     {
          InitializeComponent();
          MyClass2Object = new MyClass2();
          Binding binding = new Binding();
          binding.Source = MyClass2Object;
          binding.Path = new PropertyPath("StringVar");
          TextBoxFromXaml.SetBinding(TextBox.TextProperty, binding);
     }
}
public class MyClass2
{
     public string StringVar { get; set; }

     public MyClass2()
     {
          StringVar = "My String Here";
     }
} 
```

这将完全按照我的意愿绑定到我的 StringVar 属性。但是，我的问题是如果在设置绑定源时有文字字符串“MyClass2Object.StringVar”怎么办。我意识到我可以使用 split 函数将“MyClass2Object”和“StringVar”与较长的字符串分开。然后我可以用拆分的第二个结果替换新的 PropertyPath 行。但是，我将如何根据拆分的第一个结果替换 binding.Source 行。如果这是可能的，我将能够传递像“MyClass2Object.StringVar”这样的字符串并将TextBox的Text属性绑定到该属性，或者如果我传递像“AnotherClassObject.StringProperty”这样的字符串并拥有TextBox' ■ Text 属性绑定到在名为AnotherClassObject 的变量中实例化的对象的StringProperty 属性。我希望我说得通。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-06T04:27:04.800

听起来您希望 PropertyPath 为“Property.Property”，这将起作用，但要使绑定起作用，它需要第一个属性的源对象。我知道的两个选项是[DataContext](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.datacontext.aspx)或[Source](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.source.aspx)。

使用您的示例代码，另一种选择是：

```
public partial class Window1 : Window
{
    public MyClass2 MyClass2Object { get; set; }
    public Window1()
    {
        // use data context instead of source
        DataContext = this;

        InitializeComponent();

        MyClass2Object = new MyClass2();
        Binding binding = new Binding();
        binding.Path = new PropertyPath("MyClass2Object.StringVar");
        TextBoxFromXaml.SetBinding(TextBox.TextProperty, binding);
    }
}

public class MyClass2
{
    public string StringVar { get; set; }
    public MyClass2()
    {
        StringVar = "My String Here";
    }
} 
```

# proxy - 如何设置 SVK 的代理配置

> ID：267604
> 
> 赞同：3
> 
> 时间：2008-11-06T04:02:03.510
> 
> 标签：proxy, tortoisesvn, svk

我在代理后面工作，现在我正在尝试镜像远程颠覆存储库，然后命令`could not connect to server`出错`svn mirror`。

我在`svk`常见问题页面上找到了以下内容：

> 目前 svk 没有自己的配置文件。但是它会加载 subversion 使用的那个，它应该是 ~/.subversion/servers。它将在您第一次运行 svn 后创建

但我只是使用`tortoiseSVN`as my `svn client`，而`/.subversion/servers`我的 user中没有`dir`。

如何在我的情况下设置代理配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T10:07:43.150

手动创建文件。从[这个关于 svn 代理设置的 oracle 页面](http://blogs.oracle.com/venu/entry/svn_proxy_settings)：

创建一个文本文件`~/.subversion/servers`(Linux) 或`%HOME%\.subversion\servers`

添加这两行：

```
http-proxy-host = xxx.xxx.xxx.com
http-proxy-port = 8080 
```

为您的代理填写正确的值。

# vba - 如何在不暴露自己的情况下找出宏的作用？

> ID：267607
> 
> 赞同：8
> 
> 时间：2008-11-06T04:03:46.657
> 
> 标签：vba, security, ms-word

我收到了两个不同的 Microsoft Word 文档，我的病毒扫描程序警告我包含宏。这些应该是简单的文本文件，发送它们的人甚至不知道宏是什么；它们可能是他的错误，但它们可能是恶意感染的迹象。我安装的 OpenOffice.org 设置为根本不加载宏，因为我很少使用它们，所以我不担心系统的安全性。我想要做的是找出这些宏的作用，而不会使我的系统暴露于这些宏的任何恶意意图，以便告诉向我发送文件的人他是否正在传播感染。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-09-22T15:20:23.683

只是为了阐述这些以前的帖子 -

这是我遵循的过程-

1.  打开文件
2.  启用**编辑**以退出受保护的视图
3.  `Alt``F11`打开 Visual Basic 编辑器
    *   有时您显然可以在此处查看宏，但在我的 Word 2013 中却无法查看。
4.  最小化或关闭 VB 编辑器窗口。我们将在一分钟内重新开放
5.  **按住`Shift`**时单击`Enable Content`。这将阻止它运行 AutoOpen 宏。
6.  `Alt``F11`打开 Visual Basic 编辑器。
7.  现在您可能会看到以前没有看到的宏。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T04:40:48.003

我刚做了一个测试。我打开 Word (2007) 并：

1.  创建了一个简单的宏并与文档一起保存为“启用 Word 宏的文档 (.docm)”
2.  进入安全设置（Office Button 'File'\Word Options\Trust Center\Trust Center Settings\Macros Settings）并单击“禁用所有带有通知的宏”单选按钮，除非您单击按钮允许运行，否则宏将无法运行他们跑。
3.  打开 *.docm 文档并且宏没有运行，但我能够转到功能区控件上的“查看”选项卡并单击宏按钮并查看宏，然后编辑宏以打开 VBA IDE 以查看宏代码。

这一切都假设您使用的是 Word 2007，尽管我希望 Word 的最后一个或两个版本具有相同的功能。我在这个盒子上没有 Open Office，但是，我也希望它具有相同的功能。

祝你好运！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-01-16T08:33:32.923

.???x 只是一个 zip 格式。

解压缩文件，你最终会得到这样的结果：

```
.
├── [Content_Types].xml
├── docProps
│   ├── app.xml
│   ├── core.xml
│   └── custom.xml
├── _rels
└── word
    ├── document.xml
    ├── fontTable.xml
    ├── _rels
    │   ├── document.xml.rels
    │   └── vbaProject.bin.rels
    ├── settings.xml
    ├── styles.xml
    ├── theme
    │   └── theme1.xml
    ├── vbaData.xml
    ├── vbaProject.bin
    └── webSettings.xml 
```

现在您可以使用 Texteditor 或您选择的其他 VBA 编辑器分析 vbastuff。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T04:40:31.513

两种可能。为自己获取一份 VMWare 播放器的免费副本，并在其中安装 Windows 和 MS Office。然后加载文档并让宏运行。

另一种可能。我认为您可以将文档加载到 MS Word 中并自动禁用宏，但宏仍然存在，因此您可以使用 Word 本身查看它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-20T14:51:37.360

如果您想在**不**打开 word 文档来查看宏的情况下查看 word 宏，您可以使用[Dider Stevens的名为](https://blog.didierstevens.com)[oledump.py](https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py)的脚本。

获得脚本后，您可以执行以下操作：

```
python oledump.py "your_word.doc" -s a -v 
```

这应该返回 word 文档中所有宏的列表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-26T06:11:52.197

（我认为有人应该回答有关在全局禁用宏执行的情况下使用 OpenOffice 的原始问题；说“*打开代码编辑器*”是正确的，但对于新手来说确实需要更多的帮助；*我*确实花了很长时间才找到它时间。）

无论如何，根据[http://www.tutorialsforopenoffice.org/tutorial/Macros.html](http://www.tutorialsforopenoffice.org/tutorial/Macros.html)，您可以通过`Tools`→ `Macros`→ `Organize Macros`→查看（或编辑）宏`OpenOffice.org Basic`，这将打开`OpenOffice.org Basic Macros`窗口。

从那里只需单击树以查找文件中包含的任何宏，然后`Edit`查看每个宏中的内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-06T10:03:55.863

*   关于**VirusTotal**的检查，请注意仅显示每个“宏和 VBA 代码流” **的第一行（详细信息选项卡）。**
    *   举个例子（这个 .dotm 被报告为恶意软件，但我正在对其进行调查以了解它是否不是）：[https ://www.virustotal.com/gui/file/46dd48caaaf2a36902739ed1cc11b9f073f1b76fc27af4cfb2f0264ae1838f71/details](https://www.virustotal.com/gui/file/46dd48caaaf2a36902739ed1cc11b9f073f1b76fc27af4cfb2f0264ae1838f71/details)
*   关于这里的其他答案（我仍然没有足够的声誉来直接评论它们），请注意，**`Shift`密钥不会阻止**执行**“ActiveX 触发器”** ，如此处所述：http: [//www.decalage.info/vbashift](http://www.decalage.info/vbashift)所以在调查宏之前**不要单击“启用内容” 。**
*   这个其他答案对我有用（**“如果被问到，您可以“启用编辑”**，不会执行宏”）并且这样做我正在调查一个 .dotm 文件：[https ://stackoverflow.com/a/35663074/6390099](https://stackoverflow.com/a/35663074/6390099)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-26T22:41:39.487

在不运行宏的情况下查看宏内容的最安全方法是从包含宏内容的 Office 文档中打开 Visual Basic 编辑器。

**要打开 Visual Basic 编辑器**（Office 2010，可能是 2013 和 2016）：

1.  打开文档
2.  如果询问，您可以启用编辑，不会执行宏
3.  右键单击功能区（菜单） - 选择：自定义功能区
4.  在右侧部分中，选择“开发人员”，它将在功能区上添加一个“开发人员”选项卡。按确定。
5.  转到“开发人员”选项卡，然后单击“Visual Basic 编辑器”。

现在您可以看到所有宏。

希望它对您有所帮助，它适用于我的 excel 2010 版本。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-11-06T04:39:30.127

只需在不激活宏的情况下打开文档，然后打开代码编辑器查看它们的作用。

# blackberry - 移动应用程序的服务器端同步或客户端同步

> ID：267608
> 
> 赞同：4
> 
> 时间：2008-11-06T04:03:50.480
> 
> 标签：blackberry, java-me, mobile, synchronization, wireless

如果移动应用程序需要从多个服务器获取数据，是从移动设备调用每个服务器更好，还是调用一个服务器然后与所有其他服务器通信？

“应该由服务器发起同步还是由移动客户端发起？” 客户记账到什么程度。

说明在这两种情况下应用程序是移动电子邮件还是语音邮件客户端。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T10:35:08.787

个人信息移动同步的一些主要问题是手机的电池寿命和暂时失去连接。

这就是为什么做你所描述的通常方法是让服务器处理大部分复杂的逻辑和多个数据源来创建要同步的数据集，然后在服务器和客户端之间有一个专有协议来镜像那个数据集。

实际上，无论有多少人谈论“推送”电子邮件，与服务器的连接总是由客户端发起。您的客户端应用程序可以有一个用户选项，让电话在网络条件允许的情况下保持在线。服务器可以通过自动发送它需要与客户端同步的最新数据来对正在建立的连接做出反应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T04:31:05.993

非常模糊的问题，但我会说两者都是必要的。您的服务器应尽可能多地进行协调，以确保它们之间存储的数据保持一致。错误或恶意客户端不应导致服务器上存储的数据损坏或不一致。客户端应该进行它需要的任何同步，以确保数据的本地副本是一致的，并且不会将垃圾上传到服务器。

# jquery - 什么是“必备”的 jQuery 插件？

> ID：267609
> 
> 赞同：108
> 
> 时间：2008-11-06T04:04:15.253
> 
> 标签：jquery, plugins

我想知道什么是最有用的 JQuery 插件。我对那些可能对一般 UI 开发有用的东西特别感兴趣，例如[Tablesorter](http://tablesorter.com)，而不是那些满足不常见需求的东西。

如果您可以提供插件用途的非常简短的描述，那将非常有帮助。

谢谢，唐

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-11-06T05:07:05.907

我的列表：

*   [自动完成](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)
    *   输入字段使用户能够快速查找和选择一些值，利用搜索和过滤。
*   [JSON](http://mg.to/2006/01/25/json-for-jquery)
    *   JSON 插件检索检索和操作 json 数据。
*   [曲奇饼](http://plugins.jquery.com/project/cookie)
    *   用于读取、写入和删除 cookie 的简单轻量级实用程序插件。
*   [验证](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)
    *   用于验证表单输入数据。
*   [用户界面](http://ui.jquery.com/)
    *   功能齐全的主题和即用型小部件以及更多...
*   [界面](http://docs.jquery.com/Plugins:Interface)
    *   拖动、排序、拖放、即插即用组件和视觉效果。
*   [循环](http://www.malsup.com/jquery/cycle/)
    *   多功能且轻量级的图像幻灯片插件。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-11-06T15:42:10.023

我们目前使用：

印象最深

*   [布局（坞站、插针、分离器）——太棒了](http://layout.jquery-dev.net/demos/complex.html#)

jQuery UI 元素：

*   [选项卡](http://docs.jquery.com/UI/Tabs)- 选项卡式 UI
*   [自动完成](http://docs.jquery.com/UI/Autocomplete)- 来自 Web 服务的建议框
*   [DatePicker](http://docs.jquery.com/UI/Datepicker) - 不错的日历日期选择器

有用的社区插件：

*   [可滚动](http://www.flowplayer.org/tools/scrollable.html)- 滚动任何 div
*   [Scrollpane](http://www.kelvinluck.com/assets/jquery/jScrollPane/jScrollPane.html) - 控制滚动条的外观
*   [表排序器](http://tablesorter.com/docs/)- 任何简单表的表排序（客户端）
*   [QuickSearch](http://rikrikrik.com/jquery/quicksearch/) - 即时搜索表格内容
*   [Validate](http://jquery.bassistance.de/validate/demo/) - 表单验证（必需/类型/自定义正则表达式）
*   [HotKeys](http://jshotkeys.googlepages.com/test-static-01.html) - 快捷键的陷阱。捕获键盘上的每个键。惊人的。
*   [BlockUI](http://malsup.com/jquery/block/#demos) - 很棒的模态对话框
*   [Curvy Corners](http://blue-anvil.com/jquerycurvycorners/test.html) - 默认消除锯齿
*   [标记化输入（或带有 Xs 的 Facebook 自动完成）](http://loopj.com/2009/04/25/jquery-plugin-tokenizing-autocomplete-text-entry/) - Facebook 风格的标记化自动完成

更多内容，我将添加链接等...

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-11-06T14:17:14.970

我认为[Flot](http://code.google.com/p/flot/)插件（一个绘图库/插件）应该在这个“必备”列表中占有一席之地。

此外，这里使用它，在 StackOverflow 中，用于在用户帐户页面中显示信誉的直方图。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-06T04:17:42.387

我会列出一个我正在研究的...

[我的 jLINQ 插件](http://plugins.jquery.com/project/jLINQ)是 .NET LINQ 的 jQuery 版本。它用于处理内存中的集合（不直接与服务器对话），让您使用类似于以下的语法。

```
var results = $.from(data)
    .ignoreCase()
    .startsWith("firstName","m")
    .or("n")
    .isNot("administrator")
    .orderBy("lastName")
    .select(); 
```

它支持您在 LINQ 中找到的许多其他命令，用于排序和分组以及大多数选择命令，例如 contains、between、greaterThan 等...

[这是一个演示](http://www.hugoware.net/jLINQ)-**它很稳定，但仍在进行中**

也许不是必须有，但随着它的进展可能会有用......

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-11-11T17:44:59.743

我刚刚找到[jqGrid](http://www.secondpersonplural.ca/jqgriddocs/index.htm)，它看起来非常好。

它还有很多文档（现在是[99 页 pdf](http://www.trirand.com/jqgrid/jqgriddocs.pdf)）和[示例](http://trirand.com/jqgrid/jqgrid.html)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-11-06T04:26:33.727

*   jQuery 用户界面
    *   对于选项卡、可排序列表、自定义动画、拖放等。
*   AJAX 表单 ( [http://malsup.com/jquery/form/](http://malsup.com/jquery/form/) )
    *   更改您的表单，以便他们提交 AJAX 请求。
*   循环（[http://malsup.com/jquery/cycle/](http://malsup.com/jquery/cycle/)）
    *   用于创建轮播或在数据数组（图像、文本等）中循环的区域
*   验证（[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)）
    *   用于验证表单输入。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-07-18T09:53:03.177

对于在不永久影响页面内容的情况下向客户端发送消息的不显眼方式，我使用基于 OSX Growl 系统的[jGrowl 。](http://www.stanlemon.net/projects/jgrowl.html)

很多选项，设置，它保持页面干净:)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-09-30T19:32:27.003

我知道这是一篇旧帖子，但只是想我会投入 2 美分，以供将来参考。

[Colorbox](http://colorpowered.com/colorbox/) - 绝对是 Jquery 的最佳模态窗口/灯箱。

验证插件（前面提到过）也很好用。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-07-30T04:50:41.520

[Flowplayer](http://flowplayer.org/tools/)的 jQuery 工具真的很棒。我真的很喜欢暴露和覆盖插件。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-11T00:33:30.287

[Filament Group 的日期范围选择器](http://www.filamentgroup.com/lab/date_range_picker_using_jquery_ui_16_and_jquery_ui_css_framework/)给我留下了深刻的印象

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-11T00:13:09.820

[UI](http://ui.jquery.com/) - 没有更好的方法来做可拖动、可调整大小和其他一些。

[Slibox2](http://www.digitalia.be/software/slimbox2) - jQuery 的终极灯箱克隆，非常易于使用。

[iFixPng](http://plugins.jquery.com/project/iFixPng2) - 带有 alpha 的 IE6 PNG 的简单解决方案。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-05-07T23:36:39.837

我总是使用[Facebox](https://github.com/defunkt/facebox)向用户显示弹出表单和消息。它保持 UI 干净（我们的大多数用户使用 Facebook），但它不像使用`alert()`.

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-11T18:00:53.237

[UI](http://ui.jquery.com/)绝对是必备的。作为一个网格组件，我会推荐[jqGrid](http://www.trirand.com/blog/)。恕我直言，它比[flexiGrid](http://www.webplicity.net/flexigrid/)更好。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-09T15:50:30.690

[http://docs.jquery.com/Plugins/dimensions](http://docs.jquery.com/Plugins/dimensions)，它有很好的偏移量和外层功能......

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-06T06:25:24.327

如果您使用 Visual Studio 2008 编写 jQuery，则需要 Intellisense： [http ://weblogs.asp.net/bleroy/archive/2008/10/27/jquery-intellisense-documentation-file-available.aspx](http://weblogs.asp.net/bleroy/archive/2008/10/27/jquery-intellisense-documentation-file-available.aspx)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-06-25T13:48:08.303

[编辑] - 最近我一直在使用 JQuery 工具作为 JQueryUI 的替代品，JQuery 工具更加以 HTML5/CSS3 为中心： http: [//flowplayer.org/tools/index.html](http://flowplayer.org/tools/index.html)

我喜欢 JCarousel Lite（不是 JCarousel）[http://www.gmarwaha.com/jquery/jcarousellite/](http://www.gmarwaha.com/jquery/jcarousellite/)只做我需要的，仅此而已。

-fs

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-08-31T10:27:20.657

没有人提到这些，我发现它们非常有用：

*   [数据表](http://www.datatables.net/)- 向 HTML 表添加高级函数和交互控件
*   [BeautyTips](http://www.lullabot.com/files/bt/bt-latest/DEMO/index.html) - 向 HTML 元素添加可配置的工具提示

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-11T00:55:37.550

我是[jTemplates](http://jtemplates.tpython.com/)的忠实粉丝，它为您提供客户端模板。我发现它非常强大，尤其是在渲染结果方面。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-10-28T00:27:59.157

*   Jqgrid：[http](http://www.trirand.com/blog) ://www.trirand.com/blog ，**jQuery 可用的最佳网格插件**
*   pngFix： http: [//jquery.andreaseberhard.de/pngFix](http://jquery.andreaseberhard.de/pngFix)，**修复 IE 中 alpha 透明 PNG 图像的问题**

# java - 如何根据鼠标坐标（JavaFX）沿着围绕固定中心的圆形轨道定位节点？

> ID：267613
> 
> 赞同：0
> 
> 时间：2008-11-06T04:08:01.937
> 
> 标签：java, geometry, javafx, trigonometry, javafx-1

我试图进入一些基本的 JavaFX 游戏开发，但我对一些循环数学感到困惑。

我在 (x:250, y:250) 有一个半径为 50 的圆。

我的目标是根据鼠标的位置在上述圆圈的圆周上制作一个较小的圆圈。

我感到困惑的是坐标空间和它背后的Trig。

我的问题来自屏幕上的 X/Y 空间未以 0,0 为中心。但屏幕左上角是 0,0，右下角是 500,500。

我的计算是：

```
var xpos:Number = mouseEvent.getX();
var ypos:Number = mouseEvent.getY();

var center_pos_x:Number = 250;
var center_pos_y:Number = 250;

var length = ypos - center_pos_y;
var height = xpos - center_pos_x;

var angle_deg = Math.toDegrees(Math.atan(height / length));
var angle_rad = Math.toRadians(angle_deg);

var radius = 50;

moving_circ_xpos = (radius * Math.cos(angle_rad)) + center_pos_x;
moving_circ_ypos = (radius * Math.sin(angle_rad)) + center_pos_y; 
```

我让应用程序打印出我在移动鼠标时计算出的角度（angle_deg），我的输出如下：

当鼠标（以度为单位逆时针移动）时：

*   在圆的正上方并与中心水平对齐，角度为-0
*   向左垂直居中，角度为-90
*   在圆的正下方并与中心水平对齐，角度为 0
*   向右垂直居中，角度为 90

那么，我该怎么做才能使其成为 0、90、180、270？

我知道它一定是小东西，但我就是想不出它是什么......

感谢您的帮助（不，这不是任务）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T04:14:11.940

`atan(height/length)`是不够的角度。您需要补偿每个象限，以及“被零除”的可能性。大多数编程语言库都提供一个名为的方法`atan2`，该方法接受两个参数；`y`和`x`。此方法为您执行此计算。

有关维基百科的更多信息[：atan2](http://en.wikipedia.org/wiki/Atan2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T04:37:47.010

你可以在不计算角度的情况下离开。而是使用圆心 (250,250) 和鼠标位置 (xpos,ypos) 来定义一条线。当它的长度等于你的圆的半径时，这条线与你的圆相交：

```
// 计算中心到鼠标的距离。
xlen = xpos - x_center_pos;
ylen = ypos - y_center_pos;

line_len = sqrt(xlen*xlen + ylen*ylen); // 毕达哥拉斯：x^2 + y^2 = 距离^2

// 找到与圆的交点。
move_circ_xpos = x_center_pos + (xlen * radius / line_len);
move_circ_ypos = y_center_pos + (ylen * radius / line_len);

```

只需验证鼠标不在圆圈的中心，否则 line_len 将为零，鼠标将被吸入黑洞。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T04:45:32.970

有一[本名为“Graphics Gems”的好书](https://rads.stackoverflow.com/amzn/click/com/0122861663)可以帮助解决这类问题。它是算法和源代码的食谱（在 CI 思维中），允许您使用经过测试的功能快速解决问题。我完全建议您动手使用它 - 当我需要快速添加代码以对表面的法线和碰撞检测进行相当复杂的操作时，它为我节省了大量时间。

# jquery - 使用 jquery 在表单中聚焦第一个控件

> ID：267615
> 
> 赞同：35
> 
> 时间：2008-11-06T04:08:44.540
> 
> 标签：jquery

使用 jquery 如何在页面加载时关注表单中的第一个元素（编辑字段、文本区域、下拉字段等）？

就像是：

```
document.forms[0].elements[0].focus(); 
```

但使用jQuery。

另一个要求，当表单具有 class="filter" 时，不要关注第一个元素。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-11-06T04:32:01.217

```
$('form:not(.filter) :input:visible:enabled:first').focus() 
```

这将选择第一个不包含类的可见输入元素 ( `<input />`, `<select>`, ) 。`<textarea>``filter`

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-11-06T09:35:42.447

*作为背景，我在ruby​​ on rails*应用程序中使用了脚本。在尝试了所有答案并发现它们都**不起作用**之后，通过在谷歌上搜索我发现这个片段**有效**：

```
$(function() {
  $("form:not(.filter) :input:visible:enabled:first").focus();
}); 
```

事实证明，与*rails*在每个表单上插入`$('form :input:first')`的隐藏输入相匹配。

 ** * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-06T04:32:30.517

我喜欢用一个类标记我选择的元素并按类选择，而不是让它取决于页面上元素的顺序。我发现这比在选择可能隐藏也可能不隐藏、可能被框架注入也可能不被框架注入的元素时记住更新我的“真正的第一个元素是什么”算法要容易得多，......

```
 $(document).ready( function() {
     $('input.js-initial-focus:first').focus(); // choose first just in case
  }); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-02-23T19:45:48.443

这不是单行解决方案，但它考虑了**真正的**第一个用户输入字段（可能是 <input /> 或 <select> 标签）。

你只需要稍微调整一下，你就会得到你需要的东西。

PS：我已经在 FireFox、Chrome 和 IE6 中测试过这段代码。

```
function focusFirstFormField() {
    try {
        var selector = $("#formid");
        if (selector.length >= 1 && selector[0] && selector[0].elements && selector[0].elements.length > 0) {
            var elements = selector[0].elements;
            var length = elements.length;
            for (var i = 0; i < length; i++) {
                var elem = elements[i];
                var type = elem.type;

                // ignore images, hidden fields, buttons, and submit-buttons
                if (elem.style.display != "none" /* check for visible */ && type != "image" && type != "hidden" && type != "button" && type != "submit") {
                    elem.focus();
                    break;
                }
            }
        }
    }
    catch(err) { /* ignore error if any */ }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-02T06:46:08.720

```
$("form").find('input[type=text],textarea,select').filter(':visible:first').focus(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-05T22:57:56.713

我遇到了一些在页面上不可见但仍被选择器选中的 jQuery 对话框的问题：

```
$(":text:visible:enabled:first").focus(); 
```

在玩了很多之后，我终于想出了一个解决方案，通过在末尾添加一个“.not()”来排除具有 .dialog 类的 div 中的所有输入。这可能对其他人有用。这是我的选择器：

```
$(":text:visible:enabled:first").not("div .dialog input").focus(); 
```

# javascript - 了解 Firebug 探查器输出

> ID：267618
> 
> 赞同：34
> 
> 时间：2008-11-06T04:11:59.323
> 
> 标签：javascript, profiling, firebug, profiler

我一直在尝试使用 Firebug 的分析器来更好地了解我们看到的一些 JavaScript 性能问题的根源，但我对输出有点困惑。

当我分析一些代码时，分析器会报告**Profile (464.323 ms, 26,412 calls)**。我怀疑 464.323 毫秒是这 26,412 次调用的执行时间的总和。

但是，当我深入研究详细结果时，我看到*平均*执行时间大于 464.323 毫秒的单个结果，例如，平均时间最长的结果报告了以下详细信息：

```
Calls: **1**
Percent: **0%**
Own Time: **0.006 ms**
Time: **783.506 ms**
Avg: **783.506 ms**
Min: **783.506 ms**
Max: **783.506 ms** 
```

另一个结果报告：

```
Calls: **4**
Percent: **0.01%**
Own Time: **0.032 ms**
Time: **785.279 ms**
Avg: **196.32 ms**
Min: **0.012 ms**
Max: **783.741 ms** 
```

在这两个结果之间，时间结果的总和远远超过 464.323。

那么，这些不同的数字是什么意思呢？我应该信任哪些？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-02T03:10:07.147

如果您在 Firebug 中将鼠标悬停在每列上，则每列都有其含义的描述。我假设您可以自行阅读每列的工作原理。但是，您肯定遇到了一些需要解释的奇怪行为。

*自己的时间*是函数在其内部执行代码所花费的时间。如果该函数没有调用其他函数，那么*自己的时间*应该与*时间*相同。但是，如果有嵌套的函数调用，那么*time*也会计算执行它们所花费的时间。因此，*时间*几乎总是大于*自己的时间*，并且在大多数情况下加起来会超过分析器报告的总时间。

但是，任何**单个**函数的*时间*都不应大于分析器为 JavaScript 调用记录的总时间。这个问题绝对是一个错误，当 Firebug 为您提供如此自相矛盾的输出时，我可以理解为什么您无法信任它。我相信我已经找到了这个错误发生的原因：AJAX。

似乎 AJAX 调用导致计算嵌套函数调用的列报告不正确的信息。他们最终计算了 JavaScript 执行的时间**和**对服务器的请求。

您可以通过执行以下操作来重现此探查器错误：

1.  转到任何使用 AJAX 的站点。（我用过 [http://juicystudio.com/experiments/ajax/index.php](http://juicystudio.com/experiments/ajax/index.php)）
2.  启用控制台/脚本调试。
3.  打开探查器。
4.  进行 AJAX 调用。（多个可能更能说明问题。）
5.  停止探查器，检查输出。

在此示例中，关于*time*与*own time*，每个函数的*own time*加起来是分析器的总时间，但*time*列包含 AJAX 调用与服务器通信所花费的时间。这意味着如果您只是在寻找 JavaScript 执行的速度，那么*时间列是不正确的。*

最糟糕的是：因为*time*、*average time*、*min*和*max*都计算嵌套函数调用，如果你使用 AJAX，它们都是不正确的。最重要的是，任何最终使用 AJAX（在嵌套函数调用中）的函数也会错误地报告它们的时间。这意味着很多函数可能会报告不正确的信息！因此，在 Firebug 解决问题之前，暂时不要相信这些列中的任何一个。（他们可能希望这种行为是这样的，尽管这样离开它充其量是令人困惑的。）

如果您不使用 AJAX，那么另一个问题在起作用；让我们知道您是否是。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T07:35:40.083

如果我理解正确，它会是这样的：

在第一行，您会看到 Own 时间“只有 0.006 毫秒”。这意味着即使在该函数中花费的时间是 783.506 毫秒，但大部分时间都花在了从该函数调用的函数中。

当我使用 Firebug 优化代码时，我尝试减少被调用最多的函数的“自己的时间”。（显然还要检查是否有任何不必要的函数调用完全删除）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T04:05:41.317

来自[Firebug 教程 - 日志记录、分析和命令行（第二部分）](http://michaelsync.net/2007/09/10/firebug-tutorial-logging-profiling-and-commandline-part-ii)：（那里的例子很好）

> Profiler 的列和说明
> 
> **功能栏**：显示每个功能的名称。
> **调用列**：它显示了调用了多少特定函数的计数。
> **百分比列**：它以百分比显示每个函数的耗时。
> **时间栏**：显示从函数开始点到函数结束点的执行时间。
> **Avg 列**：显示特定函数的平均执行时间。如果您只调用一次函数，您将看不到差异。如果您多次调用，您会看到差异。
> 该列的公式是
> Avg = Own Ttime / Call；
> **最小列和最大列**：它显示了特定函数的最短执行时间。
> **文件列**：函数所在文件的文件名。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-16T03:51:50.770

据我了解，这是它的工作原理......总探查器时间是“自己的时间”列的总和。但是，您可能会注意到某些**单个**Time 值可能大于总探查器时间。这些加班是在 JavaScript 之外度过的，例如。在插件调用中。如果您的 JS 函数对 eg. 进行了插件调用，并等待插件函数返回 JS，那么这些等待时间将不会被总分析器时间报告，但会包含在 Time 列中。

# python - 从 VB 或 Python 编写 fruityloops 或 propellerheads 的原因？

> ID：267628
> 
> 赞同：10
> 
> 时间：2008-11-06T04:19:54.330
> 
> 标签：python, vb.net, audio-player

我的 Windows PC 上有 Fruityloops 和 Propellerheads Reason 软件合成器。

有什么方法可以从 Visual Basic 或 Python 获取和编写这些脚本？或者至少从代码向合成器发送 Midi 消息？

更新：尝试使用类似“midi-mapper”的东西（感谢链接MusiGenesis）似乎不起作用。我认为 Reason 或 FL Studio 不像标准的 GM Midi 合成器。

更新 2：如果您对此问题感兴趣，[也请查看](https://stackoverflow.com/questions/427037/scripting-lmms-from-python)此问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-15T11:55:02.300

这两个应用程序都支持 MIDI。只是他们看不到对方。

为了在应用程序之间通过 MIDI 发送消息，您需要安装一个**虚拟 MIDI 端口**。

有几个免费提供，但这个工作： http: [//www.midiox.com/zip/MidiYokeSetup.msi](http://www.midiox.com/zip/MidiYokeSetup.msi)

您将获得一个可以写入的虚拟 MIDI 输出端口，就好像它是一个普通的 MIDI 设备一样。在 Fruity Loops 或 Rebirth 中，您选择该端口作为输入。这就是连接程序所需要做的一切。

它会像这样工作：

`Your Application`--> `Virtual MIDI Port`-->`FruityLoops`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T04:40:03.947

我认为 FL Studio 和 Reason 都可以配置为默认的 MIDI 播放设备。要从 VB.NET 向其中任一方发送 MIDI 消息，您需要 PInvoke midiOutOpen、midiOutShortMsg 和 midiOutClose API 调用。这是代码示例的链接：

[http://www.answers.com/topic/midioutopen](http://www.answers.com/topic/midioutopen)

它们适用于 VB6，但它们应该很容易转换为 VB.NET。

我知道 FL Studio 可以从为 FL（或 VSTx 插件）编写的插件“驱动”，但我认为这些总是用 C 或 C++ 编写的。

编辑：我刚刚了解到 Windows Vista 放弃了 MIDI 映射器（这将使设置 FL 或 Reason 成为默认的 MIDI 设备变得简单）。惊人。这是我找到的替代解决方案的链接：

[http://akkordwechsel.de/15-windows-vista-und-der-midi-mapper/](http://akkordwechsel.de/15-windows-vista-und-der-midi-mapper/)

我刚刚尝试过（它只是一个 *.CPL 文件，您可以双击运行）并且它似乎可以工作（尽管 GM Synth 是我笔记本电脑上唯一可用的选项，所以我不确定它是否会选择up FL 或 Reason 作为选择）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T04:57:01.043

注意：此答案不能完全回答您提出的问题，但可能会达到您想要的结果:)

您可以使用 jVSTWrapper ( [http://jvstwrapper.sourceforge.net/](http://jvstwrapper.sourceforge.net/) ) 在 Java 中编写 VST 插件。如果你真的想使用 Python，你可以使用 Jython 来连接 java 并这样做。或者，您可以只用 Java 或其他用于 JVM 的脚本语言（如 Groovy）编写插件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-15T12:06:08.380

您需要的是一个 VST MIDI 脚本/脚本插件来创建可以发送到任何 MIDI 通道的 MIDI 事件逻辑。您需要在 FL 中为需要调整其值的 VST 乐器/效果设置一个 MIDI 通道。谷歌那里有一些插件，如果你发现任何有用的东西，请在这里分享它们:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-14T14:01:38.880

有一个开源音乐工作站，叫做 Frinika，你可以用 Javascript 编写脚本。（插入/删除音符，更改音高轮等 MIDI 效果。）它可以导入/导出常规 MIDI 文件，因此它可以与果味循环或您拥有的任何其他东西一起使用。

```
// Insert New

song.newLane("MyMidiLane", type("Midi"));
lane = song.getLane("MyMidiLane");

part = lane.newPart( time("10.0:000"), time("4.0:000") );

part.insertNote(note("c#3"), time("11.2:000"), time("2:0"), 120 );
part.insertNote(note("f3"), time("11.3:000"), time("1:0"), 100 );
part.insertNote(note("g#3"), time("11.3:000"), time("1:0"), 100 );
part.insertNote(note("b3"), time("11.3:000"), time("0:64"), 100 );
part.removeNote(note("f3"), time("11.3:000"));

part = song.newLane("MyTextLane",
type("Text")).newPart(time("24.0:000"), time("10.0:000"));
part.text = "This is the test text to be inserted.";
part.lane.parts[0].remove(); // remove initially inserted text-part 
```

阅读/更改笔记的另一个示例：

```
lane = song.getLane("MyMidiLane");
// a lane has a fixed instrument assigned

lane.parts[0].notes[0].duration=64
lane.parts[0].notes[1].duration=32
lane.parts[0].notes[1].startTick=120
// Parts are blocks of notes that you can drag around together in the Frinika GUI.
// They're like patterns in trackers.
for (i in lane.parts[0].notes){
  println("i: "+i+", n: "+noteName(lane.parts[0].notes[i].note));
  println("i: "+i+", dur: "+lane.parts[0].notes[i].duration);
  println("i: "+i+", startT: "+lane.parts[0].notes[i].startTick);
} 
```

[http://frinika.appspot.com/](http://frinika.appspot.com/) 它也有一个 Java Webstart 启动器，所以你甚至不必安装。

它过去也捆绑了 Javadoc 文档，但出于某种原因，他们的最新下载不包括该文档。很遗憾，因为那是记录 Javascript 绑定的地方。因此，现在您必须自己浏览源代码或构建 Javadoc。（它有一些可从脚本窗口访问的内置示例，您应该先检查它们。我的第一个示例来自那里。）

这是您可以找到 Javascript 文档的源文件：

[frinika Javascript 文档/源代码](http://www.google.com/url?sa=D&q=http://frinika.svn.sourceforge.net/viewvc/frinika/frinika/trunk/src/com/frinika/project/scripting/javascript/JavascriptScope.java%3Frevision%3D154%26view%3Dmarkup&usg=AFQjCNFQOlOjiUG76zrs_LxT8-P0mP_xZA)

但也有其他选择。您也可以查看[mingus](http://code.google.com/p/mingus/)，这是一个用于音乐理论和 midi 文件处理的 Python 库。它需要 Fluidsynth，演示应用程序也需要 GamePython，因此设置起来比 Frinika 复杂一些。

PS：Frinika 有一个特殊的错误：当拖动相邻的音符时，有些可能听起来不合适的长度。您可以通过前后移调连续音符（在钢琴卷帘视图中相当快）或前后拖动包含音符的部分来帮助实现这一点。重新启动 Frinika 也会有所帮助，但这是较慢的方法。所以这个错误不会影响保存的文件，也不会影响 midi 导出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T13:30:11.570

你可以写一个[Rewire](http://en.wikipedia.org/wiki/ReWire)主机。不过，您必须获得许可证（许可证是免费的，但您的应用程序必须是专有的，因此不能开源）。

或者，您可以通过 MIDI 消息进行交互。

最后，您可以实现一个虚拟音频设备，它将音频路由到您想要的任何位置或以某种方式处理它。我想所有这些都会相当困难。MIDI 可能是三者中最简单的（我不知道 Rewire 协议的使用有多难）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T09:30:56.823

说到 Reason，你可以用它做很多事情，因为它是封闭的架构——你可以使用 VST 插件（或任何其他类型，如 DirectX 插件）——你唯一的选择是使用 MIDI。

关于 Fruity Loops，您可以编写一个 VST 插件，该插件可以从脚本语言（VB、Python 或其他）中获取输入，但为了编写这样的东西，您必须使用 Delphi 或 C++。

或者，您可以查看[由 Cycling74 制作的 MAX——](http://www.cycling74.com/)它类似于音乐的 IDE；-)——我很确定您可以使用 Python。

# php - 你对 Doctrine ORM 有什么体验？

> ID：267629
> 
> 赞同：31
> 
> 时间：2008-11-06T04:21:37.743
> 
> 标签：php, orm, doctrine-orm, doctrine

[你对教义](http://www.doctrine-project.org/)有什么经验？我从来都不是那种 ORM 的人，我主要使用一些基本的数据库抽象层（如 adodb）进行管理。

但我了解它的所有概念和好处。因此，当一个需要 ORM 的项目出现时，我想我会尝试其中一个 ORM 框架。

我必须在原则和推进之间做出决定，所以我选择了原则，因为我不想处理 phing 要求。

我不知道我做错了什么。我带着正确的心态进来了。而且我绝不是“初级” php 小子。但我一直在与系统作斗争。有很多文档，但感觉有点杂乱无章。像 YAML 这样简单的东西到 db 表创建是行不通的，只是在没有错误或任何东西的情况下失败。许多其他的东西有点时髦，需要在工作之前进行额外的调整。

也许我在这里做了一些愚蠢的新手假设，一旦我发现它是什么，我就会有一个哈哈的时刻。但现在我完全讨厌这个系统。

是否有任何人可以提供的一些提示，或者可能将我指向有关该主题的良好资源或有关此问题的一些权威网站/人？或者也许只是推荐另一个“正常工作”的 ORM 框架？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2010-02-18T19:55:19.913

我有复杂的感觉。我是 SQL 的大师，只是因为它很容易验证。您可以快速测试 SELECT 语句，直到获得正确的结果。重构是一件轻而易举的事。

在 Doctorine 或任何 ORM 中，有很多抽象层，几乎看起来像是强迫症（强迫症/强迫症）。在我尝试 Doctrine 的最新项目中，我遇到了几堵墙。我花了几天的时间才找到解决方案，我知道我可以在几分钟内用 SQL 编写。这太令人沮丧了。

我脾气暴躁。SQL 社区非常庞大。对 Doctrine 的社区/支持是微不足道的。当然，您可以查看源代码并尝试弄清楚……而这些问题需要几天时间才能弄清楚。

底线：不要尝试 Doctrine 或任何 ORM，而无需计划大量时间自行摸索。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-05-29T14:52:43.450

我认为 mtbikemike 完美地总结了这一点：“我花了几天的时间才找到解决方案，我知道我可以在几分钟内用 SQL 编写。” 这也是我的经历。SAD（慢速应用程序开发）是有保证的。更不用说丑陋的代码和每个角落的限制。本来应该需要几分钟的事情需要几天的时间，而通常会更复杂并且需要几个小时或几天的事情是不可行的（或者不值得花时间）。生成的代码更加冗长和神秘（因为我们确实需要另一种查询语言 DQL 来降低可读性）。奇怪的错误无处不在，大部分时间都花在寻找它们并遇到限制和问题上。Doctrine（我只使用 v2.x）类似于徒劳的练习，绝对没有任何好处。它' 到目前为止，它是我当前系统中最讨厌的组件，也是唯一一个存在巨大问题的组件。进入一个新系统时，我总是在数据库和实体类之间来回切换，试图找出代码中不同位置的正确名称。一场彻头彻尾的噩梦。

我没有看到 Doctrine 的一个优点，只有缺点。我不知道它为什么存在，而且我每天都希望它不存在（至少在我的项目中）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-01-11T22:30:15.880

我们在 Symfony 中使用 Propel 已经 2 年了，在 Symfony 中使用 Doctrine 已经超过 1 年了。我可以说，使用 MVC 框架迁移到 ORM 是我们迈出的最好的一步。我建议坚持使用 Doctrine，尽管它需要一些时间来学习如何使用它。最后，您会发现您的代码更具可读性和灵活性。

如果您正在寻找从哪里开始，我会推荐 Symfony Jobeet 教程[http://www.symfony-project.org/jobeet/1_4/Doctrine/en/](http://www.symfony-project.org/jobeet/1_4/Doctrine/en/)（第 3、6 章涵盖基础知识）当然还有教义文件。

正如我在上面所写的，我们已经使用 Doctrine 有一段时间了。为了让我们的工作更舒适，我们开发了一个名为 ORM Designer (www.orm-designer.com) 的工具，您可以在其中在图形用户界面中定义 DB 模型（不再有 YAML 文件 :-)，顺便说一句，这还不错）。您还可以找到一些有用的教程。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-02-24T09:43:05.803

Propel and Doctrine 使用 PDO。PDO 在 Oracle 数据库中有很多未解决的错误。它们都与 CLOB 字段有关。如果您正在使用 Oracle，请在开始新项目之前记住这一点。这些错误自多年前就已开放。Doctrine 和 PDO 与 Oracle 和 CLOB 一起使用会崩溃

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-01-19T20:24:51.060

我的经历听起来和你的相似。我才刚刚开始使用教义，从未使用过 Propel。但是，我对教义非常失望。它的文档很糟糕。组织不善，而且相当不完整。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-07-29T11:50:30.870

我在一个中型项目中使用 Doctrine，我必须从我不拥有的预先存在的数据库中工作。它为您提供了许多内置功能，但我有一个主要的抱怨。

由于我必须从数据库生成模型，反之亦然，因此我的模型与数据库太接近：字段的名称与数据库列的名称非常相似，要获取对象，您必须在基本的 sql 中查询（其中我应该放那个代码，我该如何测试它？）等。

最后，我不得不为教义编写一个复杂的包装器，这让我质疑如果只使用旧的 dao/model 方法并将教义排除在外，会不会更容易。陪审团仍然没有定论。祝你好运！

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-10-06T19:10:13.043

2015 年使用 Doctrine 2.5。看起来进展顺利。直到我想使用两个实体（在一个 JOIN 中）。[在我掌握了 DQL 之后现在好多了]

好的：

*   为我生成 SQL
*   使用外键和参照完整性
*   默认情况下生成 InnoDB
*   使用教义命令行工具对 SQL 进行的更新

好的：

*   非常了解命名和映射以及如何命名以及如何将实体映射到实际表

坏的

*   花费大量时间 - 学习查询生成器的自定义 API。或者弄清楚如何做一个简单的 JOIN，想知道是否有更好的技术。如果你想做面向对象的查询，简单的 JOIN 似乎需要编写自定义函数。
*   [更新上面的第一印象] -- 我选择使用 DQL，因为它与 SQL 最相似

在我看来，该工具在概念上很棒，但它的正确执行需要开发人员的大部分时间来参与。我很想将它用于实体 SQL 生成，然后将 PDO 用于实际输入/输出。只是因为我还没有学习如何使用 SQL 进行外键和参照完整性。但是学习这些似乎比学习 Doctrine 的来龙去脉要容易得多，即使是简单的东西，比如相当于 JOIN 的实体。

**现有项目中的原则**

我（刚刚开始）使用 Doctrine 在现有项目上开发新功能。因此，我没有为该功能添加新的 mysql 表，而是添加了实体（它使用 Doctrine 模式生成为我创建了表）。在我更好地了解它之前，我保留不将 Doctrine 用于现有表。

如果我要在现有表上使用它，我会首先...清理表，其中包括：

*   添加作为主/代理键的 id 列
*   使用 InnoDb/transaction-capable 表
*   将其适当地映射到实体
*   运行 Doctrine 验证工具 ( `doctrine orm:validate-schema`)

这是因为 Doctrine 对您的表格做出了某些假设。而且因为您本质上是要通过代码来驱动您的表格。因此，您的代码和表格必须尽可能以 1:1 的比例达成一致。因此，Doctrine 通常不适用于任何“自由格式”表格。

但是，您也许可以在某些情况下小心谨慎地摆脱一些小事情，例如在您的实体中没有考虑额外的列（除非您要求，否则我认为 Doctrine 不会检查）。您将必须*知道*您正在逃避什么来构建您的查询。即，当您请求一个整体的“实体”时，Doctrine 会专门通过列名请求实体的所有字段。如果您的实际架构包含更多列名，我认为 Doctrine 不会介意（它不会，因为我已经通过在我的架构中创建一个额外的列来验证）。

所以是的，可以使用 Doctrine，但我会从小处着手。首先，您很可能必须转换表以支持事务并拥有代理索引（主键）。对于诸如外键和参照完整性之类的事情，您必须使用 Doctrine 来完善您的实体并将它们完美匹配。您可能必须让 Doctrine 重新构建您的模式以使用其自己的索引名称，以便它可以正确使用 FK 和 RI。您基本上放弃了对 Doctrine 表的一些控制，所以我相信它必须以自己的方式了解架构（比如能够使用自己的索引名称等）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-08-16T13:27:03.140

聚会有点晚了，但让我把我的两分钱扔在这里。我将与**Laravel**建立联系，因为那是我使用的框架。

## Active Record vs. 数据映射 vs. 正确的 OOP

Laravel 和许多其他框架都喜欢**Active Record**。它可能非常适合简单的应用程序，并且可以节省您进行琐碎的数据库管理的时间。但是，从 OOP 的角度来看，它是一种纯粹的**反模式**。*SoC*（关注点分离）刚刚被杀死。它在模型属性和 SQL 列名之间创建耦合。对于扩展和未来的更新来说很糟糕。

随着您的项目增长（是的，它会！），ActiveRecord 将越来越痛苦。甚至不要轻易考虑更新 SQL 结构。请记住，您的 PHP 代码中都有列名。

我被聘为一个项目，该项目的目标是在未来变得相当大。我看到了 ActiveRecord 的局限性。我坐了 3 周，使用 Data Mapper 重写了所有内容，它将 DB 与上面的层分开。

现在，回到**Data Mapper**以及**为什么我没有选择 Doctrine**。

**Data Mapper**的主要思想是，它将您的数据库与您的代码分开。从 OOP 的角度来看，这是正确的方法。SoC规则！我详细回顾了*Doctrine*，我立即不喜欢几个方面。

*   映射。为什么在世界上会有人使用评论作为命令？我认为这是一个非常糟糕的做法。为什么不直接使用 PHP 类来存储映射关系呢？
*   地图的 Yaml 或 XML。再次，为什么？当可以使用常规 PHP 类时，为什么要浪费时间解析文本文件。另外，一个类可以扩展、继承，可以包含方法，而不仅仅是数据。等等。
*   如果我们有一个映射器和一个携带数据的模型，那么它应该是存储模型的映射器。诸如`$product->save()`ar 之类的方法并不好。模型处理数据，它不应该关心将任何内容存储到数据库中。这是一个非常紧密的耦合。如果我们花时间构建一个映射器，那么为什么不拥有`$mapper->save($product)`. 根据定义，应该是映射器知道如何保存数据。

毫无疑问，Doctrine 或 Eloquent 等工具在开始时可以节省时间。但对于每个人来说，这是一个棘手的问题。/开发时间/未来更新/价格/简单性/遵循OOP原则/之间的正确妥协是什么？最后，由您来回答和正确决定。

**我自己的 DataMapper 而不是 Doctrine**

我最终开发了自己的 DataMapper，并且已经将它用于我的几个小项目。它工作得非常好，易于扩展和重用。大多数时候我们只是设置参数，不需要新代码。

以下是关键原则：

*   *模型*携带数据，类似于 Laravel 的模型。以下示例的示例变量`$model`。
*   *ModelMap*包含一个字段，该字段将 Model 的属性映射到 SQL 数据库中表的列。ModelMaps 知道表名、id 等。它知道哪些属性应该转换为json，哪些属性应该隐藏（例如deleted_at）。此 ModelMap 包含具有相同名称的列（连接表）的别名。示例变量：`$modelMap`.
*   *ModelDataMapper*是一个在控制器中接受*Model*和*ModelMap*并提供 store/getById/deleteById 功能的类。您只需调用即可`$modelMapper->store($model)`。
*   基本 DataMapper 还处理分页、搜索能力、将数组转换为 json、添加时间戳、检查软删除等。对于简单的用法，基本 DataMapper 就足够了。对于更复杂的事情，使用继承很容易对其进行扩展。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-06-06T15:52:09.353

在 2016 年使用 Doctrine ORM，大约有 2 - 2.5 年的经验。

**固有的不一致**

```
SELECT i, p            
FROM \Entity\Item i
JOIN i.product p
WHERE ... 
```

假设实体是`Item`和`Product`。它们通过 连接`Item.product_id`到`Product.id`，并`Product`包含`Product.model`我们要与 一起显示的内容`Item`。

这是从数据库中检索相同的“product.model”，使用上述 SQL 但不同的 SQL 参数：

```
//SELECT i, p
$ret[0]->getProduct()->getModel();          

//SELECT i as item, p as product
$ret[0]['item']->getProduct()->getModel();  

//SELECT i as item, p.model as model
$ret[0]['model']; 
```

我要说的是：

**根据您编写 DQL/ORM SELECT 语句的方式，输出结果集结构可能会发生巨大变化**。

从对象数组到关联对象数组，再到关联数组数组，取决于您想要的方式`SELECT`。想象一下，您必须对 SQL 进行更改，然后想象必须回到您的代码并重新执行与从结果集中读取数据相关的所有代码。*哎哟! 哎哟! 哎哟!* 即使是几行代码，你也依赖于结果集的结构，没有完全的解耦/通用标准。

**教义擅长什么**

在某些方面，它消除了处理 SQL、制作和维护自己的表。这并不完美。有时它会失败，您必须转到 MySQL 命令行并键入 SQL 以将内容调整到 Doctrine 和您满意的位置，Doctrine 认为列类型有效的位置以及您对列类型满意的位置。您不必定义自己的外键或索引，它会自动为您完成。

**教义不擅长什么**

每当您需要将任何非常高级的 SQL 转换为 DQL/ORM 时，您都可能会遇到困难。除此之外，您还可以处理上述不一致的情况。

**最后的想法**

我喜欢 Doctrine 为我创建/修改表，将表数据转换为对象，并将它们持久化，并使用准备好的语句和其他检查和平衡，使我的数据更安全。

我喜欢 Doctrine 从 PHP 的面向对象接口中处理持久存储的感觉。我有一种刺痛的感觉，我可以将我的数据视为我的代码的一部分，而 ORM 负责处理与数据库交互的脏东西。数据库感觉更像是一个局部变量，我很感激如果你照顾好你的数据，它会爱你。

我讨厌 Doctrine，因为它的不一致和艰难的学习曲线，当我知道如何用 SQL 编写东西时，我不得不查找 DQL 的专有语法。SQL 知识很容易获得，DQL 没有那么多专家在野外，也没有积累的知识体系（与 SQL 相比）可以在您遇到困难时为您提供帮助。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-08T22:02:33.347

我不是 Doctrine 方面的专家——我自己刚开始使用它，我不得不承认它的体验有点复杂。它对你有很大帮助，但如何告诉它做这个或那个并不总是很明显。

例如，当尝试将 YAML 文件与自动关系发现一起使用时，多对多关系没有正确转换为 php 模型定义。没有您提到的错误，因为它根本没有将其视为多对多。

我会说你可能需要时间来了解这种或那种做事方式以及元素如何相互作用。有时间一步一步地做事情是一件好事，并且在一种孤立的情况下一次一个地处理问题。一次尝试做太多事情可能会让人不知所措，并且可能会更难真正找到问题所在。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-07-18T03:05:38.630

在对 PHP 的各种 ORM 库进行了一些研究之后，我决定使用 PHP ActiveRecord（请参阅[phpactiverecord](/questions/tagged/phpactiverecord "显示标记为“phpactiverecord”的问题")）。我的决定归结为几乎没有配置、库的轻量级特性以及缺乏代码生成。教义对我的需要来说太强大了；PHP ActiveRecord 不能做什么我可以在我的包装层中实现。我建议花点时间检查一下您在 ORM 中的要求，看看是否有一个像 PHP ActiveRecord 这样的简单工具可以提供您需要的东西，或者家庭滚动的活动记录实现是否会更好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-06-11T08:39:47.613

现在我正在使用带有 Doctrine ORM 的 Symfony 框架，如何将 Doctrine 与普通查询一起使用？例如，来自 knpununiversity，我可以创建自定义存储库方法，例如：

```
 public function countNumberPrintedForCategory(Category $category)
    {
        $conn = $this->getEntityManager()
            ->getConnection();
        $sql = '
            SELECT SUM(fc.numberPrinted) as fortunesPrinted, AVG(fc.numberPrinted) as fortunesAverage, cat.name
            FROM fortune_cookie fc
            INNER JOIN category cat ON cat.id = fc.category_id
            WHERE fc.category_id = :category
            ';
        $stmt = $conn->prepare($sql);
        $stmt->execute(array('category' => $category->getId()));
        return $stmt->fetch();
... lines 30 - 37
    } 
```

我只是使用 Doctrine Entities 来创建一个处理表单，当我需要更复杂的查询时，我只是做简单的语句并获取我需要的值，从这个例子中我也可以将实体作为变量传递并获取它的值来进行查询。我认为这个解决方案很容易理解，构建表单、为表单传递数据和编写复杂查询所需的时间更少，不像用 Doctrine 编写它们那么难。

# sql - 如何从查询中生成 sql 脚本

> ID：267643
> 
> 赞同：0
> 
> 时间：2008-11-06T04:31:48.270
> 
> 标签：sql

有谁知道如何从查询中生成 SQL 脚本？

例如，

1.  编写一些表格的脚本。
2.  执行自定义操作 1。
3.  编写视图脚本。
4.  执行自定义操作 2。
5.  等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T04:38:10.987

听起来您想编写一个游标来执行自定义 SQL。这很常见，也很容易做到。您需要做的是指定一些事情来帮助我们更完整地回答您的问题：

1.  您使用的是什么类型的 SQL 服务器？（MSSQL、甲骨文、MySQL）
2.  你用什么语言写作？（Java、C++、PL/SQL、TSQL）

您可以编写代码 (Java / C++) 从查询中生成 SQL，也可以使用游标迭代记录集 (PL/SQL / TSQL)。您可以使用结果为您提供信息，然后这些信息可以通过 exec（取决于语言）作为 SQL 执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T04:47:42.107

...但请在实施动态 SQL 之前调查 SQL 注入。查看参数化查询...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T05:09:06.370

对于 Microsoft Sql Server，编写数据库对象脚本的最佳方式是使用[SMO](http://msdn.microsoft.com/en-us/library/ms162169.aspx)。Sql Management Objects 是 ac# api，但您始终可以使用 SqlClient 从 c# 执行 t-sql 脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T07:10:14.660

你可能想要类似的东西

```
select 'UPDATE '+table_name+ ' SET description=''(new!) ''+description WHERE description_date>''2008-11-01''' 
    from information_schema.tables where table_name like '%Description' 
```

（此查询生成查询，在虚构数据库中名称以“描述”结尾的每个表中的每个最近行的*描述*列的值前面加上“（新！）”）。

系统视图*INFORMATION_SCHEMA.TABLES包含有关所有数据库表的数据，在**[INFORMATION_SCHEMA](http://msdn.microsoft.com/en-us/library/ms186778.aspx)*表模式中还有*INFORMATION_SCHEMA.VIEWS*、*INFORMATIONS_CHEMA.COLUMNS*和其他系统视图。

希望这会有所帮助。

# mysql - 在 MySQL 4.0 中同时具有 Created 和 Last Updated 时间戳列

> ID：267658
> 
> 赞同：132
> 
> 时间：2008-11-06T04:41:16.427
> 
> 标签：mysql, mysql-error-1293

我有以下表格架构；

```
CREATE TABLE `db1`.`sms_queue` (
  `Id` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  `Message` VARCHAR(160) NOT NULL DEFAULT 'Unknown Message Error',
  `CurrentState` VARCHAR(10) NOT NULL DEFAULT 'None',
  `Phone` VARCHAR(14) DEFAULT NULL,
  `Created` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `LastUpdated` TIMESTAMP NOT NULL ON UPDATE CURRENT_TIMESTAMP,
  `TriesLeft` tinyint NOT NULL DEFAULT 3,
  PRIMARY KEY (`Id`)
)
ENGINE = InnoDB; 
```

它失败并出现以下错误：

```
ERROR 1293 (HY000): Incorrect table definition; there can be only one TIMESTAMP column with CURRENT_TIMESTAMP in DEFAULT or ON UPDATE clause. 
```

我的问题是，我可以同时拥有这两个领域吗？还是我必须在每次交易期间手动设置 LastUpdated 字段？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2008-11-06T04:52:08.260

[从**MySQL 5.5**文档](http://dev.mysql.com/doc/refman/5.5/en/timestamp-initialization.html)：

> 表中的一个 TIMESTAMP 列可以将当前时间戳作为初始化该列的默认值、作为自动更新值，或两者兼而有之。**不可能将当前时间戳设为一列的默认值，而将另一列的自动更新值设为默认值。**

[**MySQL 5.6.5**](http://dev.mysql.com/doc/relnotes/mysql/5.6/en/news-5-6-5.html)[的变化](http://dev.mysql.com/doc/relnotes/mysql/5.6/en/news-5-6-5.html)：

> 以前，每个表最多可以有一个 TIMESTAMP 列可以自动初始化或更新为当前日期和时间。**这个限制已经解除。**任何 TIMESTAMP 列定义都可以具有 DEFAULT CURRENT_TIMESTAMP 和 ON UPDATE CURRENT_TIMESTAMP 子句的任意组合。此外，这些子句现在可以与 DATETIME 列定义一起使用。有关详细信息，请参阅 TIMESTAMP 和 DATETIME 的自动初始化和更新。

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2009-04-30T15:48:48.530

[有两个时间戳的技巧](http://gusiev.com/2009/04/update-and-create-timestamps-with-mysql/)，但有一点限制。

您只能在一张表中使用其中一种定义。像这样创建两个时间戳列：

```
create table test_table( 
  id integer not null auto_increment primary key, 
  stamp_created timestamp default '0000-00-00 00:00:00', 
  stamp_updated timestamp default now() on update now() 
); 
```

请注意，有必要在以下`null`期间输入两列`insert`：

```
mysql> insert into test_table(stamp_created, stamp_updated) values(null, null); 
Query OK, 1 row affected (0.06 sec)

mysql> select * from test_table; 
+----+---------------------+---------------------+ 
| id | stamp_created       | stamp_updated       |
+----+---------------------+---------------------+
|  2 | 2009-04-30 09:44:35 | 2009-04-30 09:44:35 |
+----+---------------------+---------------------+
2 rows in set (0.00 sec)  

mysql> update test_table set id = 3 where id = 2; 
Query OK, 1 row affected (0.05 sec) Rows matched: 1  Changed: 1  Warnings: 0  

mysql> select * from test_table;
+----+---------------------+---------------------+
| id | stamp_created       | stamp_updated       | 
+----+---------------------+---------------------+ 
|  3 | 2009-04-30 09:44:35 | 2009-04-30 09:46:59 | 
+----+---------------------+---------------------+ 
2 rows in set (0.00 sec) 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-11-06T04:45:36.837

您可以同时拥有它们，只需在创建的字段上去掉“CURRENT_TIMESTAMP”标志。每当您在表中创建新记录时，只需使用“NOW()”作为值。

或者。

相反，删除“ON UPDATE CURRENT_TIMESTAMP”标志并为该字段发送 NOW()。这种方式实际上更有意义。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2011-06-24T15:53:26.387

如果你决定让 MySQL 处理时间戳的更新，你可以设置一个触发器来更新插入时的字段。

```
CREATE TRIGGER <trigger_name> BEFORE INSERT ON <table_name> FOR EACH ROW SET NEW.<timestamp_field> = CURRENT_TIMESTAMP; 
```

MySQL 参考：[http ://dev.mysql.com/doc/refman/5.0/en/triggers.html](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2013-05-07T08:14:17.300

这就是您如何使用触发器拥有自动和灵活的 createDate/lastModified 字段：

首先像这样定义它们：

```
CREATE TABLE `entity` (
  `entityid` int(11) NOT NULL AUTO_INCREMENT,
  `createDate` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
  `lastModified` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
  `name` varchar(255) DEFAULT NULL,
  `comment` text,
  PRIMARY KEY (`entityid`),
) 
```

然后添加这些触发器：

```
DELIMITER ;;
CREATE trigger entityinsert BEFORE INSERT ON entity FOR EACH ROW BEGIN SET NEW.createDate=IF(ISNULL(NEW.createDate) OR NEW.createDate='0000-00-00 00:00:00', CURRENT_TIMESTAMP, IF(NEW.createDate<CURRENT_TIMESTAMP, NEW.createDate, CURRENT_TIMESTAMP));SET NEW.lastModified=NEW.createDate; END;;
DELIMITER ;
CREATE trigger entityupdate BEFORE UPDATE ON entity FOR EACH ROW SET NEW.lastModified=IF(NEW.lastModified<OLD.lastModified, OLD.lastModified, CURRENT_TIMESTAMP); 
```

*   如果您在未指定 createDate 或 lastModified 的情况下**插入**，则它们将相等并设置为当前时间戳。
*   如果您在未指定 createDate 或 lastModified 的情况下**更新**它们，则 lastModified 将设置为当前时间戳。

但这是很好的部分：

*   如果您**insert**，您可以指定*比当前时间戳更早的 createDate*，从而允许从更早的时间进行导入（lastModified 将等于 createDate）。
*   如果你**update**，你可以指定一个*比前一个值更旧的 lastModified*（'0000-00-00 00:00:00' 效果很好），如果你正在进行外观更改，则允许更新条目（修复评论中的错字) 并且您想**保留旧的 lastModified**日期。这不会修改 lastModified 日期。

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2013-12-03T09:45:59.667

从 MySQL 5.6 开始，它很容易...试一试：

```
create table tweet ( 
    id integer not null auto_increment primary key, 
    stamp_created timestamp default now(), 
    stamp_updated timestamp default now() on update now(),
    message varchar(163)
) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-11-14T17:30:05.813

这个问题似乎在 MySQL 5.6 中得到了解决。直到 MySQL 5.5，我才注意到这一点；这是一个示例代码：

```
DROP TABLE IF EXISTS `provider_org_group` ;
CREATE TABLE IF NOT EXISTS `provider_org_group` (
  `id` INT NOT NULL,
  `name` VARCHAR(100) NOT NULL,
  `type` VARCHAR(100) NULL,
  `inserted` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `insert_src_ver_id` INT NULL,
  `updated` TIMESTAMP NULL ON UPDATE CURRENT_TIMESTAMP,
  `update_src_ver_id` INT NULL,
  `version` INT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `id_UNIQUE` (`id` ASC),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC))
ENGINE = InnoDB; 
```

在 MySQL 5.5 上运行它会给出：

```
ERROR 1293 (HY000): Incorrect table definition; there can be only one TIMESTAMP column with CURRENT_TIMESTAMP in DEFAULT or ON UPDATE clause 
```

在 MySQL 5.6 上运行它

```
0 row(s) affected   0.093 sec 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-02-09T11:50:13.527

```
create table test_table( 
id integer not null auto_increment primary key, 
stamp_created timestamp default '0000-00-00 00:00:00', 
stamp_updated timestamp default now() on update now() 
); 
```

[来源：http://gusiev.com/2009/04/update-and-create-timestamps-with-mysql/](http://i.stack.imgur.com/LlQMS.png)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-05-05T14:15:27.820

我认为这是对 stamp_created 和 stamp_updated 的更好查询

```
CREATE TABLE test_table( 
    id integer not null auto_increment primary key, 
    stamp_created TIMESTAMP DEFAULT now(), 
    stamp_updated TIMESTAMP DEFAULT '0000-00-00 00:00:00' ON UPDATE now() 
); 
```

因为当记录创建时，`stamp_created`应该由`now()`并且`stamp_updated`应该由`'0000-00-00 00:00:00'`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-06-14T14:58:03.427

对于 mysql 5.7.21，我使用以下内容并且工作正常：

CREATE TABLE `Posts`( `modified_at`timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, `created_at`timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-03-26T16:15:36.803

我的虚拟主机卡在 mysql 5.1 版上，所以像我这样没有升级选项的人可以按照以下说明进行操作：

[http://joegornick.com/2009/12/30/mysql-created-and-modified-date-fields/](http://joegornick.com/2009/12/30/mysql-created-and-modified-date-fields/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-09T13:15:52.223

这将添加两列用于创建和更新。两者都会在插入和更新时得到更新。

```
 create table users( 
      id integer not null auto_increment primary key, 
      created_date timestamp default now(), 
      modified_date timestamp default now() on update now() 
    ); 
```

# python - 如何以编程方式创建具有动画方面的图片

> ID：267660
> 
> 赞同：1
> 
> 时间：2008-11-06T04:44:47.183
> 
> 标签：python, image, graphics, animation, drawing

背景

一位客户要求我创建一张世界图片，其中包含从世界的一个地方到另一个地方的动画箭头/射线。

光线将是随机的，将代表一个交易，在它们发生后会淡出，并且会随着时间的推移而增加频率。光线将从一个国家的边界​​开始，并在另一个国家的边界​​结束。随着每个动画交易的发生，所有交易金额的不断更新的总和将显示在图像的底部。个别交易的金额将是随机的。图像上还会显示一年，每 n 秒递增一次。

随机化、求和和递增对我来说不是问题，但我不知道如何处理箭头/射线的动画。

**我的问题是最好的方法是什么？哪些框架/库最适合这项工作？**

我最精通python，所以python建议对我来说最容易，但我愿意接受任何优雅的方式来做到这一点。客户端将在 Windows 机器的演示文稿中将其呈现为幻灯片。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T05:07:21.070

> 客户端将在 Windows 机器的演示文稿中将其呈现为幻灯片

我认为这是你答案的关键。在进行 3d 实现并编写世界上所有的代码来创建此功能之前，您需要查看演示软件。很有可能，您的选择将归结为两件事：

1.  动画 Gif
2.  自定义演示脚本

显然，动画 gif 并不理想，因为它在渲染完成时会重复，并且要使其持续很长时间会产生很大的 gif。

自定义演示脚本可能是允许他在演示文稿中提出它而不运行任何辅助程序或做任何奇怪的事情的另一种方式。我不确定哪个演示应用程序是目标，但这可能是有价值的信息。

他听起来更像是非技术性的，并且要求一些他没有意识到的东西会很困难。我认为您应该提出一些选择，解释实施它们的困难，并提出另一种属于“物有所值”范围的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T04:53:21.363

这很大程度上取决于您要为此付出的努力，而是一种简单方法的基本轮廓。将加载箭头的图像，并使用绘图库对其进行着色并沿您想要指向的方向旋转（或使用形状/曲线绘制它）。

最后，实际动画它基于时间在坐标之间进行插值。

如果只是为了演示，我会使用 Macromedia Flash，或类似的动画程序。（会做和上面一样的事情，但你不需要编写任何东西）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T07:52:57.007

如果您喜欢冒险，请使用 OpenGL :)

You can draw bezier curves in 3d space on top of a textured plane (earth map), you can specify a thickness for them and you can draw a point (small cone) at the end. It's easy and it looks nice, problem is learning the basics of OpenGL if you haven't used it before but that would be fun and probably useful if your in to programing graphics.

You can use OpenGL from python either with [pyopengl](http://pyopengl.sourceforge.net/) or [pyglet](http://www.pyglet.org/).

If you make the animation this way you can capture it to an avi file (using [camtasia](http://www.techsmith.com/camtasia.asp) or something similar) that can be put onto a presentation slide.

# sql-server - 在 SQL 2000 上恢复数据库后如何恢复 DTS 权限

> ID：267664
> 
> 赞同：0
> 
> 时间：2008-11-06T04:45:41.767
> 
> 标签：sql-server, sql-server-2000, dts

作为我们为客户处理企业应用程序支持的方式的一部分，我们让他们备份他们的数据库，我在我们的服务器上恢复它，进行一些维护，备份它，然后让他们在他们的服务器上恢复它。这很好用，但我通常必须重置该数据库的用户权限。但目前我有一个客户端无法在该服务器上运行 DTS 包，因为数据库用户无法连接到数据库。我已经尝试查看所有可能的设置和选项，并检查并重新检查了该用户的权限，顺便说一下，该用户是 dbo 角色，但似乎没有任何效果。任何人都知道为什么即使用户具有正确的权限我也无法连接？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-22T07:38:49.440

数据库的所有者可能是错误的。我会首先通过确保所有者设置为他们网络上的用户或角色来检查这一点（或者如果他们不使用 Windows 身份验证，则为 sa）。

# excel - 如何在 Excel 中设置单选按钮？

> ID：267668
> 
> 赞同：0
> 
> 时间：2008-11-06T04:47:33.917
> 
> 标签：excel, user-interface, vba

我想使用 Excel 来捕获调查结果。我想要大量的问题，每个问题都有 5 个单选按钮，从优秀到差。每个单选按钮应对应于存储在某处的一组数据单元中的数值（例如，优秀 = 13、差 = 10、好 = 5 等）。我希望能够剪切和粘贴这些以帮助复制大量问题的控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T05:04:37.220

您可以转到查看 -> 工具栏 ->**表单**

然后您应该看到可以单击并添加到 Excel 工作表的单选按钮。

一个好主意是先放下一个“组框”，然后再向其中添加选项按钮。这样您就可以轻松地提出多组问题。

您还可以使用 Excel **CHOOSE**函数来设置选项按钮的值，就像您在问题中提到的那样......

请参阅：[此处](http://www.learn-ict.org.uk/materials/documents/course_notes/excel_interm/Controls/options.htm)了解更多详细信息。

# windows - Qt + win32 + mingw 上的原生 Windows API 链接问题

> ID：267672
> 
> 赞同：2
> 
> 时间：2008-11-06T04:48:55.257
> 
> 标签：windows, qt, mingw

我正在尝试使用 mingw 工具集将本机 Windows API 与 Qt 一起使用。某些功能存在链接问题。发生什么了？这是 mingw 名称修改的错误吗？

```
#ifdef Q_WS_WIN
    HWND hwnd = QWidget::winId();
    HDC hdcEMF  = CreateEnhMetaFile(NULL, NULL, NULL, NULL ) ;
    Rectangle(hdcEMF,100,100,200,200);
    HENHMETAFILE hemf = CloseEnhMetaFile(hdcEMF);
    OpenClipboard(hwnd);
    EmptyClipboard();
    SetClipboardData(CF_ENHMETAFILE,hemf);
    CloseClipboard();
#else 
```

错误：

对“CreateEnhMetaFileW@16”的未定义引用

未定义对“矩形@20”的引用

未定义对“CloseEnhMetaFile@4”的引用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T04:55:52.560

函数`CreateEnhMetaFileW()`和`CloseEnhMetaFile()`在静态库 Gdi32.lib 中定义，因此您必须确保链接到它。尝试添加`-lgdi32`到您用于编译的命令行的末尾。如果这不起作用，您可能必须通过添加来指定 Gdi32.lib 的完整路径`-L/path/to/folder/containing/the/library -lgdi32`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-09-08T18:13:39.727

如果您想在 Qt 应用程序中使用 Windows API，则无需声明 WinAPI 函数 extern "C"，只需包括：

```
#include <qt_windows.h> 
```

在您的项目文件 (.pro) 中添加您使用的库：

```
LIBS += -luser32 -lshell32 -lgdi32 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T04:59:29.477

可能包含这些函数，但由于 C++ 假设而受到破坏。

查看 extern C { } 声明。它旨在声明不应因多态性/重载而名称混乱的函数。（IE 两个函数同名）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-11T14:14:55.580

@torn 你的解决方案对我有用。

我想在我的 qt 应用程序中使用 win32 api 调用。

#include #include your-win32-api-header

最后是 LIBS += -llibrary 名称。

请注意，您可能也必须为正确的路径提供 -L 。

# debugging - 如何检查 GDB 中函数的返回值？

> ID：267674
> 
> 赞同：110
> 
> 时间：2008-11-06T04:49:29.903
> 
> 标签：debugging, cross-platform, gdb, return-value

假设返回值**未**分配给变量，是否可以检查 gdb 中函数的返回值？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2008-11-06T05:01:14.887

我想有更好的方法可以做到这一点，但是[完成](http://www.chemie.fu-berlin.de/chemnet/use/info/gdb/gdb_6.html#SEC37)命令会一直执行，直到当前堆栈帧被弹出并打印返回值——给定程序

```
int fun() {
    return 42;
}

int main( int argc, char *v[] ) {
    fun();
    return 0;
} 
```

你可以这样调试它——

```
(gdb) r
Starting program: /usr/home/hark/a.out 

Breakpoint 1, fun () at test.c:2
2               return 42;
(gdb) finish
Run till exit from #0  fun () at test.c:2
main () at test.c:7
7               return 0;
Value returned is $1 = 42
(gdb) 
```

该`finish`命令可简写为`fin`。不要使用命令`f`的缩写`frame`！

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-11-06T04:57:27.813

是的，只需`EAX`通过键入来检查寄存器`print $eax`。对于大多数函数，返回值存储在该寄存器中，即使它没有被使用。

例外情况是返回大于 32 位的类型的函数，特别是 64 位整数 ( `long long`)、`double`s 和`structs`or `classes`。

另一个例外是如果您不是在英特尔架构上运行。在这种情况下，您必须弄清楚使用了哪个寄存器（如果有）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-07-14T02:05:06.113

这是不使用符号的方法。

```
gdb ls
This GDB was configured as "ppc64-yellowdog-linux-gnu"...
(no debugging symbols found)
Using host libthread_db library "/lib64/libthread_db.so.1".

(gdb) break __libc_start_main
Breakpoint 1 at 0x10013cb0
(gdb) r
Starting program: /bin/ls
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
(no debugging symbols found)
Breakpoint 1 at 0xfdfed3c
(no debugging symbols found)
[Thread debugging using libthread_db enabled]
[New Thread 4160418656 (LWP 10650)]
(no debugging symbols found)
(no debugging symbols found)
[Switching to Thread 4160418656 (LWP 10650)]

Breakpoint 1, 0x0fdfed3c in __libc_start_main () from /lib/libc.so.6
(gdb) info frame
Stack level 0, frame at 0xffd719a0:
 pc = 0xfdfed3c in __libc_start_main; saved pc 0x0
 called by frame at 0x0
 Arglist at 0xffd71970, args:
 Locals at 0xffd71970, Previous frame's sp is 0xffd719a0
 Saved registers:
  r24 at 0xffd71980, r25 at 0xffd71984, r26 at 0xffd71988, r27 at 0xffd7198c,
  r28 at 0xffd71990, r29 at 0xffd71994, r30 at 0xffd71998, r31 at 0xffd7199c,
  pc at 0xffd719a4, lr at 0xffd719a4
(gdb) frame 0
#0  0x0fdfed3c in __libc_start_main () from /lib/libc.so.6
(gdb) info fr
Stack level 0, frame at 0xffd719a0:
 pc = 0xfdfed3c in __libc_start_main; saved pc 0x0
 called by frame at 0x0
 Arglist at 0xffd71970, args:
 Locals at 0xffd71970, Previous frame's sp is 0xffd719a0
 Saved registers:
  r24 at 0xffd71980, r25 at 0xffd71984, r26 at 0xffd71988, r27 at 0xffd7198c,
  r28 at 0xffd71990, r29 at 0xffd71994, r30 at 0xffd71998, r31 at 0xffd7199c,
  pc at 0xffd719a4, lr at 0xffd719a4 
```

格式有点乱，注意使用“信息框架”来检查框架，以及“框架#”将你的上下文导航到另一个上下文（在堆栈上下）

bt 还显示了一个简短的堆栈来提供帮助。

# java - Canvas3D 和 Swing

> ID：267685
> 
> 赞同：1
> 
> 时间：2008-11-06T05:01:00.770
> 
> 标签：java, macos, swing, 3d, java-3d

这个问题是关于 Mac OS X 中的性能问题

Canvas3D 对象嵌入在 JPanel 中；然后面板与 Swing 构建的应用程序的其余部分集成。在该画布中，我通过应用某些转换来渲染一个简单的立方体。在最初的启动它工作正常。但是当我尝试调整窗口大小或对垂直或水平拆分栏按钮执行一些操作时。Swing 组件需要一定的时间才能出现在屏幕上。首先出现一个闪亮的白色物体，然后会出现摆动组件？（完全说会发生闪烁的事情）。有没有办法解决这个问题？

请在这方面帮助我。

J3DSwinger

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T08:20:59.147

如果您对 的默认渲染有问题[`Canvas3D`](http://download.java.net/media/java3d/javadoc/1.5.2/javax/media/j3d/Canvas3D.html)，您应该尝试离屏渲染、双缓冲和使用计时器主动渲染。我会将渲染限制为一些合理的fps。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T16:11:56.357

Java3D 1.5 现在在实验包中包含一个名为 JCanvas3D 的组件，该组件执行离屏渲染、双缓冲和其他使 Java3D 在 Swing GUI 中运行良好所需的事情。

见 com.sun.j3d.exp.swing.JCanvas3D

# ftp - 通过卫星/高延迟连接的 FTP

> ID：267688
> 
> 赞同：2
> 
> 时间：2008-11-06T05:01:16.650
> 
> 标签：ftp, latency

我每天都使用 FTP 在多个网站上工作，但是当我尝试在家工作时，我该死的卫星互联网的延迟约为 1000 毫秒。（我知道它的服务很糟糕，但我住的地方没有其他选择。）因此，我想知道是否有一种方法可以连接到我的 Web 服务器并传输可以适应这种延迟的文件。

FTP“有效”，但它的通信速度非常非常慢，而且它是一个包含多个文件的噩梦。连接开始传输大约需要 10-15 秒，传输完成后又需要 5 秒。传输本身按预期进行得非常快，但握手过程却没有，因为服务器/客户端似乎需要进行大量通信来协商传输。更糟糕的是，似乎需要为每个单独的文件做这个握手的事情，这当然没有帮助。

有什么方法可以修改我的 FTP 以使其在高延迟连接上更好地工作？如果没有，我是否可以使用任何其他协议或传输服务来处理此类问题？这是我发现我的 ISP 的主要故障，而且我找不到太多可以解决的问题......

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T05:06:45.470

听起来像是使用 UDP 而不是基于 TCP 的协议的好案例 - 例如[uftp](http://uftp-multicast.sourceforge.net)

来自链接站点的引用：“对于通过卫星链路（双向通信）进行数据分发特别有用，其中固有的延迟使任何基于 TCP 的通信都非常低效”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T05:06:31.930

几个选项：

*   运动鞋网。使用 USB 密钥。
*   SCP。我几乎可以肯定它只会验证/握手一次。
*   通过 SSH 建立隧道。穷人的VPN。您将能够通过 SSH 连接通过隧道传输 FTP 或任何您喜欢的东西。它将与您获得的一样快，并且启动非常安全。

# .net - 如何强制 .NET 使用 GAC 中的程序集的本地副本

> ID：267693
> 
> 赞同：72
> 
> 时间：2008-11-06T05:06:15.953
> 
> 标签：.net, gac

我有一个 .NET 程序集（由于我无法控制的原因）*必须*在 GAC 中。但是，相同的程序集被另一个程序使用，该程序具有相同程序集的旧版本的自己的副本。它必须使用自己的副本，而不是 GAC 中的任何副本。在这种情况下，正确的版本控制可能比它的价值更麻烦，原因我不会讨论。我的问题是：**无论如何要告诉 .NET：只需使用此 DLL，就在此目录中 - 忽略您在 GAC 或其他任何地方找到的任何内容**。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-11-06T05:42:56.100

确保 GAC 程序集和本地程序集具有不同的版本号（至少通过在 AssemblyInfo 中通配您的 AssemblyVersion 来让您的内部版本号自动递增并不是一个坏主意：[assembly: AssemblyVersion("1.0.0.*" )])。然后，使用您的应用程序的配置重定向您的程序集绑定：

*   [http://msdn.microsoft.com/en-us/library/2fc472t2(VS.80).aspx](http://msdn.microsoft.com/en-us/library/2fc472t2(VS.80).aspx)
*   [http://msdn.microsoft.com/en-us/library/433ysdt1(VS.80).aspx。](http://msdn.microsoft.com/en-us/library/433ysdt1(VS.80).aspx)

在您的情况下，您不需要 assemblyBinding 配置的“appliesTo”属性。你只需要这样的东西：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity name="YourAssembly" publicKeyToken="AAAAAAAAAAAA" culture="neutral"/>
            <bindingRedirect oldVersion="0.0.0.0-5.2.1.0" newVersion="5.0.8.1"/>
        </dependentAssembly>
    </assemblyBinding>
</runtime> 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-11-06T05:53:20.010

如果他们有相同的版本号，答案是你不能。如果您尝试加载与 GAC 程序集具有相同完整程序集名称（名称、版本、密钥）的程序集，CLR 将每次选择 GAC 程序集。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-24T11:32:49.437

您可以设置 DEVPATH 以强制加载程序集，请参阅[链接文本](http://msdn.microsoft.com/en-us/library/cskzh7h6.aspx)

这并不能回答您的问题，因为它仅用于开发用途，即使如此也不真正推荐，因为它不反映生产用途。但是，我想无论如何我都会分享它，因为很高兴知道。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-08T04:11:16.787

我有一个类似的问题。`ildasm`我通过使用和`ilasm`生成一个新的 dll更改了目标 dll 的 publicKeyToken 。然后我在项目引用中更新它以指向新的 dll。我采取的步骤在[这里](https://stackoverflow.com/questions/1379954/how-i-do-a-sign-an-assembly-that-has-already-been-built-into-a-dll-specifically)。

这对我有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T05:21:05.377

您是否尝试过 Assembly.LoadFromFile()？这是一项手动操作，但应在需要之前将程序集加载到内存中。.NET 然后将使用内存中的那个而不是寻找它。

另一种方法是，如果本地程序集未签名，您可以这样区分它。

抢

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-11T19:33:38.910

绑定重定向不起作用的一个原因是 Oracle.ManagedDataAccess 提供程序对 dll 的搜索顺序与非托管提供程序不同。非托管提供程序从应用程序目录开始，然后查找注册表中的 dllpath，然后是 machine.config 中的 dll 路径，然后是 web.config 中的 dll 路径。根据 Oracle 文档，托管提供程序的搜索顺序如下：

> 托管驱动程序将使用以下搜索顺序引用这些程序集：

1.  全局程序集缓存
2.  Web 应用程序的 bin 目录或 Windows 应用程序的 EXE 目录
3.  x86 或 x64 子目录取决于应用程序是在 32 位还是 64 位 .NET Framework 中运行。如果应用程序是使用 AnyCPU 构建的，那么只要程序集可用，ODP.NET 就会使用正确的 DLL 位数。如果您的应用程序是 AnyCPU，Oracle 建议使用这种查找依赖程序集的方法。

[https://docs.oracle.com/en/database/oracle/oracle-database/12.2/odpnt/installODPmd.html#GUID-0E834EC7-21DF-4913-B712-2B0A07FD58FD](https://docs.oracle.com/en/database/oracle/oracle-database/12.2/odpnt/installODPmd.html#GUID-0E834EC7-21DF-4913-B712-2B0A07FD58FD)

因此，解决此问题的方法是取消注册 GAC 程序集，或者在您的 bin 和 web.config 中放置与 GAC 中不同版本的 Oracle.ManagedDataAccess，如果您无法卸载它。

# active-directory - 在 ActiveDirectory 中复制选定的帐户

> ID：267696
> 
> 赞同：0
> 
> 时间：2008-11-06T05:06:47.000
> 
> 标签：active-directory

是否可以在 Active Directory 域中复制选定对象（帐户）。我们需要通过防火墙将选定的帐户复制到位于 DMZ 中的 DC。我们不想将*所有*帐户复制到这台机器上，以防它被入侵。

任何建议、帮助或产品建议最受赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T05:11:14.260

这不是一个真正的编程问题，但无论如何......

除非您的 DMZ 上的 DC 位于不同的域中，否则您不需要复制任何内容，它已经拥有一切。如果它在不同的域中，您究竟想要复制什么，为什么？权限？设置？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-06T05:20:26.033

道歉 - 我刚刚与其中一位程序员澄清了需求（之前有轻微的沟通错误）。事实证明，我们只需要从 DMZ 域到内部域的单向信任，就可以访问一些内部对象（文件、SQL）。我认为他们需要验证 DMZ 上的一些内部用户 - 不是这样。

再次道歉，但事实证明这很简单。

感谢回复。

# c# - 什么是在 C# 中处理条件依赖的最佳方法

> ID：267703
> 
> 赞同：2
> 
> 时间：2008-11-06T05:11:35.460
> 
> 标签：c#, msbuild

我们正在构建一个 C# .NET 应用程序，它将在卡车内的计算机上运行。我们需要与卡车计算机上的数字 IO 端口进行通信，这些端口在我们的开发人员机器上不存在，因此我需要编写一个虚拟库，该库将包含在我们的开发版本中，但当我们使用实际的数字 IO 库替换时发布。我希望这个库替换能够通过构建过程自动化。

来自 Java 背景，我可以使用构建配置文件在 maven 中轻松完成此操作。有没有类似的方法可以使用 MSbuild 做到这一点？如果不是，那么在 C# microsoft 领域中处理此问题的最佳方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T05:26:39.203

我最近开发了类似的东西，我假设一个接口用于与一些操作伺服系统的嵌入式计算机进行通信。为了编写控制这些计算机的软件，我[使用 Moq 来模拟](http://code.google.com/p/moq/)我编写的接口，然后通过实现这些接口的[StructureMap 插入真实的类。](http://structuremap.sourceforge.net/Default.htm)

我还使用 Moq 为使用相同接口控制机器的软件编写单元测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T07:52:09.957

我会选择 IoC+Mock 方法，但如果你想用 msbuild 来做，请[在此处](http://realfiction.net/?q=node/164)查看有关 msbuild 条件的重要资源

# javascript - Javascript：在同一窗口中打开新页面

> ID：267704
> 
> 赞同：59
> 
> 时间：2008-11-06T05:13:58.840
> 
> 标签：javascript, window

是否有一种简单的方法可以修改此代码，以便在 SAME 窗口中打开目标 URL？

```
<a href="javascript:q=(document.location.href);void(open('http://example.com/submit.php?url='+escape(q),'','resizable,location,menubar,toolbar,scrollbars,status'));">click here</a>``
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2011-08-24T20:21:28.577

```
<script type="text/javascript">
window.open ('YourNewPage.htm','_self',false)
</script> 
```

见参考： [http ://www.w3schools.com/jsref/met_win_open.asp](http://www.w3schools.com/jsref/met_win_open.asp)

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2008-11-06T05:21:18.840

*window.open()*的第二个参数是一个字符串，表示目标窗口的名称。

将其设置为：“_self”。

```
<a href="javascript:q=(document.location.href);void(open('http://example.com/submit.php?url='+escape(q),'_self','resizable,location,menubar,toolbar,scrollbars,status'));">click here</a> 
```

**旁注：** 以下问题概述了将事件处理程序绑定到 HTML 链接的更好方法。

[**用js函数替换链接的最佳方法是什么？**](https://stackoverflow.com/questions/266327/whats-the-best-way-to-replace-links-with-js-functions#266443)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-06T05:16:02.830

```
<a href="javascript:;" onclick="window.location = 'http://example.com/submit.php?url=' + escape(document.location.href);'">Go</a>; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-07-19T13:26:06.070

试试这个，它在 ie 7 和 ie 8 中对我有用

```
 $(this).click(function (j) {
            var href = ($(this).attr('href'));
            window.location = href;
            return true; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-23T08:13:27.537

这对我有用：

```
<button name="redirect" onClick="redirect()">button name</button>
<script type="text/javascript">
function redirect(){
var url = "http://www.google.com";
window.open(url, '_top');
}
</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T06:24:48.417

如果我是你，我会采取稍微不同的方式。在页面加载时更改文本链接，而不是在单击时更改。我将在 jQuery 中给出示例，但它可以很容易地在 vanilla javascript 中完成（尽管 jQuery 更好）

```
$(function() {
    $('a[href$="url="]')    // all links whose href ends in "url="
        .each(function(i, el) {
            this.href += escape(document.location.href);
        })
    ;
}); 
```

并像这样编写您的 HTML：

```
<a href="http://example.com/submit.php?url=">...</a> 
```

这样做的好处是人们可以看到他们正在点击的内容（href 已经设置），并且它会从您的 HTML 中删除 javascript。

说了这么多，看起来您正在使用 PHP……为什么不将它添加到服务器端呢？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-03-03T21:37:48.180

那么通过在href末尾添加URL，每个链接都会在同一个窗口中打开？您也可以在 HTML 中使用 _BLANK 来做同样的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-17T04:17:18.907

尝试

```
<a href="#" 
   onclick="location='http://example.com/submit.php?url='+escape(location)"
   >click here</a>
```

# asp.net - 如何使用 json 将复杂类型传递给 ASP.NET MVC 控制器

> ID：267707
> 
> 赞同：33
> 
> 时间：2008-11-06T05:19:37.800
> 
> 标签：asp.net, jquery, asp.net-mvc, json

我有一个视图，允许用户输入/编辑新小部件的数据。我想将该数据形成一个 json 对象并通过 AJAX 将其发送到我的控制器，这样我就可以在服务器上进行验证而无需回发。

我已经完成了所有工作，只是我不知道如何传递数据，因此我的控制器方法可以接受复杂的 Widget 类型，而不是每个属性的单独参数。

所以，如果这是我的对象：

```
public class Widget
{
   public int Id { get; set; }
   public string Name { get; set; }
   public decimal Price { get; set; }
} 
```

我希望我的控制器方法看起来像这样：

```
public JsonResult Save(Widget widget)
{
   ...
} 
```

目前，我的 jQuery 看起来像这样：

```
var formData = $("#Form1").serializeArray();

$.post("/Widget/Save",
   formData,
   function(result){}, "json"); 
```

我的表单 (Form1) 为 Widget 上的每个属性（Id、Name、Price）都有一个输入字段。这很好用，但它最终将 Widget 的每个属性作为单独的参数传递给我的控制器方法。

有没有办法我可以“拦截”数据，也许使用 ActionFilterAttribute，并在调用我的控制器方法之前将其反序列化为 Widget 对象？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-06T15:29:45.493

谢谢杰夫，这让我走上了正确的道路。DefaultModelBinder 足够聪明，可以为我做所有的魔法……我的问题出在我的 Widget 类型上。在我匆忙中，我的类型被定义为：

```
public class Widget
{
   public int Id;
   public string Name;
   public decimal Price;
} 
```

请注意，该类型具有公共字段而不是公共属性。一旦我将它们更改为属性，它就起作用了。这是正确工作的最终源代码：

小部件.aspx：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" AutoEventWireup="true" CodeBehind="Widget.aspx.cs" Inherits="MvcAjaxApp2.Views.Home.Widget" %>
<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">
    <script src="../../Scripts/jquery-1.2.6.js" type="text/javascript"></script>   
    <script type="text/javascript"> 
    function SaveWidget()
    {
        var formData = $("#Form1").serializeArray();

        $.post("/Home/SaveWidget",
        formData,
        function(data){
            alert(data.Result);
        }, "json");
    }
    </script>
    <form id="Form1">
        <input type="hidden" name="widget.Id" value="1" />
        <input type="text" name="widget.Name" value="my widget" />
        <input type="text" name="widget.Price" value="5.43" />
        <input type="button" value="Save" onclick="SaveWidget()" />
    </form>
</asp:Content> 
```

HomeController.cs：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Web.Mvc.Ajax;

namespace MvcAjaxApp2.Controllers
{
    [HandleError]
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            ViewData["Title"] = "Home Page";
            ViewData["Message"] = "Welcome to ASP.NET MVC!";
            return View();
        }

        public ActionResult About()
        {
            ViewData["Title"] = "About Page";
            return View();
        }

        public ActionResult Widget()
        {
            ViewData["Title"] = "Widget";
            return View();
        }

        public JsonResult SaveWidget(Widget widget)
        {
            // Save the Widget
            return Json(new { Result = String.Format("Saved widget: '{0}' for ${1}", widget.Name, widget.Price) });
        }
    }
    public class Widget
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public decimal Price { get; set; }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-21T02:17:24.130

请注意（在*MrDustpan 的*解决方案中）MVC Action 方法中的参数*名称* **小部件必须与 ASPX 文件中***name*属性中使用的前缀匹配。

如果不是这种情况，那么 Action 方法将始终收到一个**空**对象。

```
<input type="text" name="widget.Text" value="Hello" /> - OK
<input type="text" name="mywidget.Text" value="Hello" /> - FAILS 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T14:04:20.797

[Phil Haack](http://www.haacked.com)有[一篇很好的](http://www.haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)关于模型绑定的博文，可能会有所帮助。不是 100% 您在这里谈论的内容，但我认为它可能会让您对 DefaultModelBinder 有更好的整体了解。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T05:43:50.667

您要做的是以与后端对象的结构相同的方式构建您的 javascript 表单对象：

```
{ Id : "id", Name : "name", Price : 1.0 } 
```

然后使用 toJSON 插件将其转换为上述字符串。您将此字符串发送到后端并使用 JayRock 库之类的东西将其转换为新的 Widget 对象。

# asp.net-mvc - 同时运行 ASP.NET MVC Preview 3（或 4 或 5）和 MVC Beta

> ID：267719
> 
> 赞同：0
> 
> 时间：2008-11-06T05:27:28.017
> 
> 标签：asp.net-mvc

我最近刚刚安装了 MVC 测试版。但是，我假设因为版本号已经改变，并且因为它现在使用 GAC 而不是 bin 文件夹，所以它不会破坏现有的应用程序。

但是，它有。

我需要遵循哪些步骤来确保我现有的预览版 3 应用程序使用 .dll 的 bin 副本并且不会因安装 Beta 版而损坏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T06:17:58.960

ASP.NET MVC beta 也可以进行 bin 部署，将以下 DLL 从 GAC 移动到应用程序的 bin 文件夹

```
* System.Web.Mvc
* System.Web.Routing
* System.Web.Abstractions 
```

[查看这篇文章了解更多信息](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T06:37:50.747

您需要从 GAC 强制卸载 (gacutil /u /f System.Web.Mvc) Beta DLL，然后对所有版本（包括 beta）使用 bin 部署。

# sql - Mysql 从 datetime 中剥离时间组件

> ID：267721
> 
> 赞同：101
> 
> 时间：2008-11-06T05:29:35.487
> 
> 标签：sql, mysql, datetime

我需要在 Mysql 中进行日期比较而不考虑时间组件，即我需要将 '2008-11-05 14:30:00' 转换为 '2008-11-05'

目前我正在这样做：

```
SELECT from_days(to_days(my_date)) 
```

有没有正确的方法来做到这一点？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2008-11-06T05:43:58.873

是的，使用[日期](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_date)功能：

```
SELECT date(my_date) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-06T05:52:35.877

`select date(somedate)`是最常见的。

如果需要适应其他格式，可以使用：

```
SELECT DATE_FORMAT(your_date, '%Y-%m-%d'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T05:45:14.503

在 PostgreSQL 中，您使用 TRUNC() 函数，但我没有在 MySQL 中看到它。从我简短的谷歌搜索来看，您似乎需要将 DATETIME 值转换为 DATE。

```
date_col = CAST(NOW() AS DATE) 
```

请参阅[http://dev.mysql.com/doc/refman/5.0/en/date-and-time-types.html](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-types.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-06T20:57:48.363

只是一种简单的方法`date("d F Y",strtotime($row['date']))`来自`$row['date']`您的查询

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2012-09-25T20:21:06.813

你可以使用`ToShortDateString();`

# c# - 为什么 XML-Serializable 类需要无参数构造函数

> ID：267724
> 
> 赞同：175
> 
> 时间：2008-11-06T05:33:43.700
> 
> 标签：c#, .net, xml-serialization

我正在编写代码来进行 Xml 序列化。具有以下功能。

```
public static string SerializeToXml(object obj)
{
    XmlSerializer serializer = new XmlSerializer(obj.GetType());
    using (StringWriter writer = new StringWriter())
    {
        serializer.Serialize(writer, obj);
        return writer.ToString();
    }
} 
```

如果参数是没有无参数构造函数的类的实例，则会抛出异常。

> 未处理的异常：System.InvalidOperationException：CSharpConsole.Foo 无法序列化，因为它没有无参数构造函数。在 System.Xml.Serialization.TypeDesc.CheckSupported() 在 System.Xml.Serialization.TypeScope.GetTypeDesc(Type type, MemberInfo source, Boolean directReference, Boolean throwOnError) 在 System.Xml.Serialization.ModelScope.GetTypeModel(Type type,布尔直接引用）在 System.Xml.Serialization.XmlSerializer..ctor(Type type, String defaultName space) 在 System.Xml.Serialization 的 System.Xml.Serialization.XmlReflectionImporter.ImportTypeMapping(Type type , XmlRootAttribute root, String defaultNamespace)。 XmlSerializer..ctor（类型类型）

为什么必须有一个无参数的构造函数才能让 xml 序列化成功？

编辑：感谢 cfeduke 的回答。无参数构造函数可以是私有的或内部的。

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2008-11-06T05:37:22.070

在对象的反序列化过程中，负责反序列化对象的类创建序列化类的实例，然后仅在获取要填充的实例后才继续填充序列化的字段和属性。

您可以制作您的构造函数`private`，或者`internal`如果您愿意，只要它是无参数的即可。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2008-11-06T08:02:33.320

这是一个限制`XmlSerializer`。请注意`BinaryFormatter`并且`DataContractSerializer` *不需要这样做*- 他们可以从以太中创建一个未初始化的对象并在反序列化期间对其进行初始化。

由于您使用的是 xml，因此您可能会考虑使用/ ]`DataContractSerializer`并标记您的类，但请注意这会更改架构（例如，没有等效的- 所有内容都成为元素）。`[DataContract]``[DataMember``[XmlAttribute]`

更新：如果你真的想知道，`BinaryFormatter`等人使用[`FormatterServices.GetUninitializedObject()`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatterservices.getuninitializedobject.aspx)创建对象而不调用构造函数。可能很危险；我不建议经常使用它；-p 另见 MSDN 上的注释：

> 因为对象的新实例被初始化为零并且没有运行构造函数，所以该对象可能不代表该对象认为有效的状态。当前方法仅应在用户打算立即填充所有字段时用于反序列化。它不会创建未初始化的字符串，因为创建不可变类型的空实例没有任何意义。

我有[自己的](http://code.google.com/p/protobuf-net/)序列化引擎，但我不打算使用它`FormatterServices`；我很喜欢知道构造函数（*任何*构造函数）已经实际执行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-11-02T19:57:13.313

答案是：***没有任何理由。***

与其名称相反，`XmlSerializer`该类不仅用于序列化，还用于反序列化。它对您的类执行某些检查以确保它能够正常工作，其中一些检查仅与反序列化有关，但无论如何它都会执行它们，因为它不知道您以后打算做什么。

您的课程未能通过的检查是仅与反序列化相关的检查之一。这是发生的事情：

*   在反序列化期间，`XmlSerializer`该类将需要创建您的类型的实例。

*   为了创建一个类型的实例，需要调用该类型的构造函数。

*   如果你没有声明一个构造函数，编译器已经提供了一个默认的无参数构造函数，但是如果你声明了一个构造函数，那么这是唯一可用的构造函数。

*   因此，如果您声明的构造函数接受参数，那么实例化您的类的唯一方法是调用接受参数的构造函数。

*   但是，`XmlSerializer`除了无参数构造函数之外，它不能调用任何构造函数，因为它不知道将哪些参数传递给接受参数的构造函数。所以，它会检查你的类是否有一个无参数的构造函数，因为它没有，所以它失败了。

因此，如果`XmlSerializer`该类的编写方式仅执行与序列化相关的检查，那么您的类将通过，因为绝对没有关于序列化的任何内容使得必须有一个无参数的构造函数。

正如其他人已经指出的那样，解决问题的快速方法是简单地添加一个无参数构造函数。不幸的是，这也是一个肮脏的解决方案，因为这意味着您不能`readonly`从构造函数参数初始化任何成员。

In addition to all this, the `XmlSerializer` class *could* have been written in such a way as to allow even deserialization of classes without parameterless constructors. All it would take would be to make use of ["The Factory Method Design Pattern" (Wikipedia)](https://en.wikipedia.org/wiki/Factory_method_pattern). From the looks of it, Microsoft decided that this design pattern is far too advanced for DotNet programmers, who apparently should not be unnecessarily confused with such things. So, DotNet programmers should better stick to parameterless constructors, according to Microsoft.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T05:47:08.477

首先，这是文档中所写的[内容](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)。我认为这是您的类字段之一，而不是主要字段-以及您希望反序列化器如何在没有无参数构造的情况下将其构造回来？

我认为有一种解决方法可以将构造函数设为私有。

# c# - 从 C# Windows 窗体启动系统屏幕保护程序

> ID：267728
> 
> 赞同：8
> 
> 时间：2008-11-06T05:39:36.387
> 
> 标签：c#, screensaver

希望这是一个简单的，但是任何人都可以提供一些简单的 c# 代码来启动当前配置的屏幕保护程序吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T05:47:09.507

这是一个很好的网站，展示了如何使用屏幕保护程序的各个方面。有关启动屏幕保护程序的代码，请参阅末尾的注释。

[http://www.codeproject.com/KB/cs/ScreenSaverControl.aspx](http://www.codeproject.com/KB/cs/ScreenSaverControl.aspx)

```
 [DllImport("user32.dll", EntryPoint = "GetDesktopWindow")]
    private static extern IntPtr GetDesktopWindow();

    [DllImport("user32.dll")]
    private static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, int wParam, int lParam);

    //...

    private const int SC_SCREENSAVE = 0xF140;
    private const int WM_SYSCOMMAND = 0x0112;

    //...

    public static void SetScreenSaverRunning()
    {
    SendMessage

(GetDesktopWindow(), WM_SYSCOMMAND, SC_SCREENSAVE, 0);
} 
```

# mfc - 如何在 MFC vs2005 中为调试模式编写代码

> ID：267737
> 
> 赞同：0
> 
> 时间：2008-11-06T05:47:51.517
> 
> 标签：mfc, debugging, macros

我想在调试模式下定义一些成员变量和一些代码，当更改为发布模式时，它们不会出现。

我知道我可以使用#ifdef xxx 来完成这项任务。

我的问题是：MFC 是否提供了任何方便的宏来执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T07:46:48.983

```
#ifdef _DEBUG 
```

Visual Studio 在构建应用程序的调试风格时定义了 _DEBUG 宏。

# java - 为 Java Webstart 启用 https

> ID：267738
> 
> 赞同：3
> 
> 时间：2008-11-06T05:48:30.987
> 
> 标签：java, https, java-web-start, jnlp

我在 HTTP Server 中部署了一个 Swing 应用程序。用户使用浏览器指向一个 URL 并使用 java webstart 安装客户端。现在我需要启用对部署在 HTTP 服务器上的应用程序的 https 访问。我使用 JDK 1.5 作为 jnlp 文件中支持的默认 jdk。暂时我使用自签名证书对 jar 进行签名（默认情况下使用 Sun 的 jarsigner、keytool 等工具创建）。

解决方案/步骤将不胜感激。

提前致谢

拉梅什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-04T21:35:00.187

You need to enable HTTPS on the web server. To get the certificate you need to provide credentials and the host name of the server to a certificate authority (CA) like VeriSign or Thawte. They can provide you with a server certificate signed by their root certificate or some intermediate certificate. This certificate must then be imported into the web server to enable HTTPS over SSL. The web clients, like a browser or webstart will then verify the certificate chain when accessing the server.

If you use a self signed jar, all your users will be presented with a warning message about potentially unsafe code. To avoid this you should get a code signing certificate from a CA, which would be somewhat similar to the web server certificate. This CA-provided certificate can be imported into the keystore and used in the same way you use the self signed certificate. The code signing certificate will be signed by the CA so that the certificate chain can be verified by webstart.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T07:16:01.760

据我了解您的问题，您不需要对客户端代码进行任何更改。如果您只想通过 HTTPS 访问 JNLP，您只需要重新配置分发 JNLP 的应用程序服务器，或者如果您在应用程序服务器前面有一个网络服务器（就像我们在这里所做的那样：用户 - https -> apache -> AJP -> tomcat）您需要重新配置网络服务器以允许通过 HTTPS 访问 JNLP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T19:12:04.703

您希望利用的 https 功能是什么？

*   签名/服务器身份验证是通过代码签名完成的，尽管您使用自签名证书破坏了这一点。
*   您的应用程序代码是否包含必须对窃听者隐藏的秘密？

正如您所说，您“需要启用”必须有一个潜在的原因。

我相信在您“需要 https”之前，您需要一个适当的代码签名证书。您可能想重新表述您的问题，以便可以解决您的潜在问题而不是非常具体的问题。

# java - Java 实例变量可访问性

> ID：267750
> 
> 赞同：4
> 
> 时间：2008-11-06T06:00:26.453
> 
> 标签：java, inheritance, variables, accessibility

Java中以下变量的可访问性有什么区别？

```
public class Joe {
    public int a;
    protected int b;
    private int b;
    int c;
} 
```

我最感兴趣的是最后一个在做什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T06:06:54.443

*   `public`: 任何人都可以读/写
*   `protected`**：对子类的实例和封闭包内的**实例可读/写
***   `private`**：对于类的任何**实例和内部或外部（封闭）实例都是可读/写的*   `int c`：包私有，对同一包内的所有类都可读/写**

 **有关详细信息，请参阅[JLS](http://java.sun.com/docs/books/jls/second_edition/html/names.doc.html#104285)

编辑：添加了受保护的注释，说明从同一个包内授予访问权限，你们是完全正确的。还添加了评论`private`。我想起来了... ;-）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T07:44:02.533

很抱歉回答对以前一个答案的更正，但我没有足够的声誉来直接修改......

*   `public`- 任何人都可以读/写
*   `protected`- 可读取/写入实例子类和同一包内的所有类
*   `int c`：包私有，对同一包内的所有类都可读/写
*   `private`- 对该类本身和内部类的任何成员（如果有）可读/写

最好以这种方式对访问修饰符进行排序，从最广泛的访问 ( `public`) 到最窄的 ( `private`)，知道从窄到宽时，您不会失去任何可能性。

这对于“受保护”尤其重要，因为在这种情况下，通常会误解同一个包中的类也可以访问一个类的受保护成员（不仅仅是它的子类）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T06:23:34.317

我尝试完全避免包级访问（您提到的最后一次访问）。

我喜欢让课程自成一体。如果另一个类需要访问我的类中的某些东西，它应该是`public`（并且它应该通过方法，而不是属性）。否则我觉得你已经破坏了[封装](https://stackoverflow.com/questions/99688/private-vs-public-members-in-practice-how-important-is-encapsulation#100035)，正如[Abstraction VS Information Hiding VS Encapsulation](https://stackoverflow.com/questions/24626/abstraction-vs-information-hiding-vs-encapsulation)中所解释的那样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T06:22:59.950

所有这些都是编译时保护，它们可以在运行时通过反射轻松覆盖。

# c# - 删除 Outlook AddIn 边栏标题

> ID：267751
> 
> 赞同：2
> 
> 时间：2008-11-06T06:00:43.193
> 
> 标签：c#, outlook, vsto

我正在使用 Visual Studio Tools for Office 为 Microsoft Outlook 开发侧边栏插件。但是，当我在 Outlook 中显示它时，我无法弄清楚如何摆脱我侧边栏上的标题 Outlook。这是显示标题的屏幕截图，其中包含文本“Sidebar Program”：[Sidebar Screenshot](http://img205.imageshack.us/my.php?image=stackoverflowquestionai8.jpg)。

我希望不显示该标题，以及我的侧边栏周围的边框。

我正在使用将控件添加到 Outlook（控件是 UserControl 的实例，托管 WPF 控件或 Windows 窗体控件）

`CustomTaskPane pane = Globals.ThisAddIn.CustomTaskPanes.Add(control, "Sidebar Program");`

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T18:18:23.417

使用 Office 2007 CustomTaskPanes 无法做到这一点。你必须像这样将你的窗口推到 Outlook 中：http: [//www.codeproject.com/KB/office/additional_panel_Outlook.aspx](http://www.codeproject.com/KB/office/additional_panel_Outlook.aspx)

# c++ - Boost Asio serial_port - 需要 io 帮助

> ID：267752
> 
> 赞同：15
> 
> 时间：2008-11-06T06:01:25.577
> 
> 标签：c++, boost

所以我一直在尝试学习 boost::asio 的东西，以便使用 RS232 与串行设备进行通信。文档很少，示例也不存在。无法弄清楚如何与设备进行通信。该设备无法发送数据，所以我需要做的就是编写，但其他项目需要实际的来回通信，因此将不胜感激。到目前为止我有什么代码。

```
#include <boost/asio/serial_port.hpp>
using namespace::boost::asio;

int main()
{
    io_service io;
    serial_port port( io, "COM3" );
    port.set_option( serial_port_base::baud_rate( 19200 ) );

    unsigned char commands[4] = { 1, 128, 240, 0 };

    // write the commands to the device

    return 0;
} 
```

简而言之：需要有关 serial_port 的 io 部分的帮助。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-06T15:36:31.407

除了波特率，您可能还需要设置其他选项，例如：character_size、flow_control、parity 和 stop_bits。要将数据写入串行端口，您可以执行以下操作：

```
boost::asio::write(port, boost::asio::buffer(commands, 4)); 
```

缓冲区类型的库接受非常灵活，您可能希望在此处进一步阅读该主题：[缓冲区](http://www.boost.org/doc/libs/1_36_0/doc/html/boost_asio/overview/core/buffers.html)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-08T02:44:33.387

感谢这里和其他地方的帮助，我得到了它的工作。写了一个小程序，可以帮助一些人弄清楚升压串行端口的东西。

[boostserialportdemo.cpp](http://www.college-code.com/blog/wp-content/uploads/2008/11/boost_serial_port_demo.cpp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-29T00:18:27.640

如果您想知道为什么他的示例给出了编译错误，请将两行的 CSIZE 更改为 C_SIZE。这可能是网络上唯一一个很好的示例程序。
[谢谢](https://stackoverflow.com/questions/12641149/serial-port-configuration-using-boost-asio)。

# google-maps - 最好的街道地址搜索服务是什么？

> ID：267754
> 
> 赞同：2
> 
> 时间：2008-11-06T06:05:21.810
> 
> 标签：google-maps, virtual-earth, street-address

微软虚拟地球街道地址搜索服务的简单性给我留下了深刻的印象。

我的要求是在一个简单的文本框中输入不带逗号分隔符的粗略地址信息，按下查找按钮，等待几秒钟，然后观察结果选择列表。

我[在这里](http://www.garyrusso.org/map.html)使用[虚拟地球 SDK 模拟](http://dev.live.com/virtualearth/sdk/)了一些东西。

谷歌地图有类似的 API 吗？

哪个街道地址搜索服务更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T10:12:49.487

是的。

这些相关问题中有一些信息：

[您如何执行地址验证？](https://stackoverflow.com/questions/134956/how-do-you-perform-address-validation) [如何以编程方式（合法）获取街道地址的经度和纬度](https://stackoverflow.com/questions/158474/how-to-obtain-longitude-and-latitude-for-a-street-address-programmatically-and)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T15:36:05.723

还有[雅虎地图API](http://developer.yahoo.com/maps/)

# ms-word - 如何创建 OLE 控件？

> ID：267755
> 
> 赞同：6
> 
> 时间：2008-11-06T06:05:53.883
> 
> 标签：ms-word, ms-office, ole

无需深入探讨[为什么我需要 OLE](https://stackoverflow.com/questions/137586/how-do-i-embed-a-custom-user-control-in-ms-word) .. 我需要将托管 C++ 自定义控件嵌入到 MS Word 2007 中（2003 也很好）。

## 所以问题是如何使这个托管（.net 3.5）控制符合 OLE 标准？

看来我需要做一些类似于实现接口的事情。但是事实证明很难找到最新的教程。

我已阅读有关 OLE 的维基百科文章。我可以搜索到的所有信息都是古老的（1994 年）和/或以 VB 为中心的（4.0-6.0）。任何对当前有意义的东西......请发布链接/书籍。

谢谢阅读..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-26T18:27:47.523

Andrew Whitechapel 将托管控件描述为 Office 文档中的 ActiveX 控件。你可以在这里阅读他的文章：http: [//blogs.msdn.com/andreww/archive/2008/11/24/using-managed-controls-as-activex-controls.aspx](http://blogs.msdn.com/andreww/archive/2008/11/24/using-managed-controls-as-activex-controls.aspx)。

更新：另请参阅此[相关问题](https://stackoverflow.com/questions/2023004/embedding-objects-into-microsoft-word-and-openoffice-writer/2023212#2023212)。

# entity-framework - 如何在实体框架中创建新的 EntityKey 时摆脱硬编码

> ID：267757
> 
> 赞同：0
> 
> 时间：2008-11-06T06:07:31.353
> 
> 标签：entity-framework, .net-3.5

如何在实体框架中创建新的 EntityKey 时摆脱硬编码

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T15:34:29.127

```
GetType(Model).Name
GetType(Account).Name 
```

意思是：

```
Public Shared Function GetName(Of TEntity As Type)() As String
    Dim type = GetType(TEntity)
    If Not type.IsSubclassOf(GetType(EntityObject)) Then Throw New Exception("Item must inherit from EntityObject.")
    Return GetType(ObjectContextName).Name & "." & type.Name
End Function 
```

如果您在 .NET 3.5 中复数了您的实体集（不存在复数服务），请使用：

```
private static string ObjectContextName = typeof(Rlp.Data.Entities).Name;
public static string GetEntityName<TEntity>([Optional, DefaultParameterValue(false)]bool pluralize) where TEntity : Type
{
    Type type = typeof(TEntity);
    if (!type.IsSubclassOf(typeof(EntityObject))) throw new Exception("Item must inherit from EntityObject.");
    string entitySet = type.Name;
    if (pluralize) entitySet = Pluralizer.ToPlural(entitySet);
    return ObjectContextName + "." + entitySet;
} 
```

甚至：

```
private static string ObjectContextName = typeof(Rlp.Data.Entities).Name;
private const string EntityIdSuffix = "Id";
public static EntityKey CreateEntityKey<TEntity>(string id , [Optional, DefaultParameterValue(false)]bool pluralize) where TEntity : Type
{
    Type type = typeof(TEntity);
    if (!type.IsSubclassOf(typeof(EntityObject))) throw new Exception("Item must inherit from EntityObject.");
    string entity = type.Name;
    string entitySet;
    entitySet = pluralize? Pluralizer.ToPlural(entity): entity;
    return new EntityKey(ObjectContextName + "." + entitySet, entity + EntityIdSuffix, id);  
} 
```

**Pluralizer 助手来自：[Simple English Noun Pluralizer in C#](http://blogs.msdn.com/dmitryr/archive/2007/01/11/simple-english-noun-pluralizer-in-c.aspx)**

# coding-style - 防御性编码实践

> ID：267763
> 
> 赞同：15
> 
> 时间：2008-11-06T06:18:54.763
> 
> 标签：coding-style

自从我第一次写

```
if ($a = 5) {
   #  do something with $a, e.g.
   print "$a";
} 
```

并经历了正常的令人费解的会议

*   为什么结果总是正确的
*   为什么 $a 总是 5

直到我意识到，我将 5 分配给了 $a，而不是进行比较。

所以我决定把上面的那种条件写成

```
 if (5 == $a) 
```

换句话说：

**始终将常量值放在比较运算符的左侧，如果您忘记添加第二个“=”符号，则会导致编译错误。**

我倾向于称之为**防御性编码**，并且倾向于相信它是**防御性编程的表亲**，不是在算法规模上，而是在关键字上。

您开发了哪些防御性编码实践？

* * *

**一周后：**

对所有回答或将来可能添加另一个答案的人表示“谢谢”。

不幸的是（或者说幸运的是！）没有一个正确的答案。为此，我的问题是广泛的，更多地询问意见或经验教训，而不是事实。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-06T06:43:00.720

始终使用大括号：

```
if(boolean)
    oneliner();
nextLineOfCode(); 
```

不一样：

```
if(boolean)
{
    oneliner();
}
nextLineOfCode(); 
```

如果 oneliner() 是一个#defined 函数，并且它没有被定义，那么你的下一行代码会突然受到 if() 的约束。同样的事情也适用于 for 循环等。使用大括号，下一段代码永远不会无意中成为 if/for 等的条件。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-06T06:47:06.127

我采用的前 3 种防御性编码实践是

1.  单元测试
2.  单元测试
3.  单元测试

没有比一个好的单元测试来支持你的代码质量更好的防御了。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-06T06:25:03.673

这是一个简单而明显的方法，但我永远不会在我的代码中重复相同的字符串常量两次，因为我知道如果我这样做我会拼错其中一个:) 使用常量，伙计们！

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-06T06:27:47.473

总是在 if/for/while ... 之后加上花括号，即使后面只有一个语句。BTW D. Crockford 也认为这更好：[所需的块](http://www.jslint.com/lint.html)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-06T08:32:21.793

当比较一个字符串和一个常量时，写

```
if ("blah".equals(value)){} 
```

代替

```
if (value.equals("blah")){} 
```

防止出现 NullPointerException。但这是我唯一一次使用建议的编码风格（因为“如果（a = 1）...”在 Java 中是不可能的）。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-06T08:41:57.157

One of the things I always try to remember when I am in the Javascript world is to always start the return value of a function on the same line as the return key word.

```
function one(){
    return {
        result:"result"
    };
}

function two(){
    return 
    {
        result:"result"
    };
} 
```

These 2 functions will not return the same value. The first function will return an Object with a property results set to "result". The second function will return `undefined`. It's a really simple mistake and it happens because of Javascript's over-zealous Semi-Colon Insertion strategy. Semi-colons are semi-optional in Javascript and because of this the Javascript engine will add semi-coons where it thinks it's should be. Because `return` is actually a valid statement a semi-colon will be inserted after the return statement and the rest of the function will essentially be ignored.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-06T08:48:02.903

From my blog:

1.  Think positive and return early plus avoid deep nesting. Instead of

    if (value != null) { ... do something with value ... } return

    write

    if (value == null) { return } ... do something with value ...

2.  Avoid "string constants" (i.e. the same text in quotes in more than one place). Always define a real constant (with a name and an optional comment what it means) and use that.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-06T07:15:23.963

*   始终初始化变量
*   `const`尽可能使用（不使用`mutable`）
*   避免动态分配内存或其他资源
*   始终使用花括号
*   在编码实现之前为任何类编码用例和测试
*   尽可能多地打开有用的警告（`-Wall -Wextra -ansi -pedantic -Werror`至少）
*   使用解决问题的最简单工具（在我当前的环境中，即`bash`-> `grep`-> awk -> Python -> C++）。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-11-06T07:58:59.850

就个人而言，我不喜欢这种防御风格，它使代码难以阅读。

VC 编译器警告级别 4 将发现这个（可能的）错误。
“警告 C4706：条件表达式中的赋值”

您可以在任何级别仅启用此特定的编译器警告：

```
#pragma warning(3,4706) 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-11-06T06:25:49.943

我停止使用你可以做的语言

```
if a = 5: print a 
```

这为我省去了很多麻烦=）。

`if`更严肃的一点...我现在总是在写完我的 s 和循环之后立即写花括号`for`，然后再填写它们。这确保我的括号始终对齐。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-06T06:29:05.460

返回可变对象的副本，即数组的副本，而不是可变对象本身。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-06T06:51:28.067

避免不必要的测试。例子

1.  如果（布尔 == 真）
2.  指针检查 if(pointer)

编辑： if(pointer) 不可读，所以现在我更喜欢 if(NULL != pointer)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-06T06:51:51.357

几件事：

*   是的，1 行块。使用大括号...哎呀，大多数优秀的 IDE 都会为您制作。
*   在编写代码后对其进行评论，或者如果您提前完成，请重新阅读您的评论。确保您的代码仍然按照评论所说的那样做。
*   单元测试是重新阅读代码的一个很好的后备方案。
*   总是记录一个异常......或者，永远不要在没有说明的情况下捕获一个异常，至少在调试中。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-24T01:32:14.953

安装了 Resharper ;) 如果我做错了什么，我不需要写“5 == a”来得到警告:)

# excel - 只需单击一个按钮即可将特定行从工作表选项卡复制到另一个工作表选项卡

> ID：267764
> 
> 赞同：-2
> 
> 时间：2008-11-06T06:19:32.220
> 
> 标签：excel, button, rows

我需要通过单击一个按钮将一组行从一个选项卡复制到同一 Excel 文档的另一个选项卡。

另外，我是否还可以获得有关如何复制一组隐藏的行并将其粘贴到同一选项卡中而不复制“隐藏”格式的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T21:21:03.367

如果“Copystart”是您的原始行，而“Copyend”是您要粘贴它们的位置，则使用命名范围：

```
Sub Copybutton_Click()

Range("Copyend").value = Range("Copystart").value
Range("Copyend").visible = True

End Sub 
```

如果您有多个具有相同名称的命名范围，则添加 [Sheetname]。在范围前面，其中 Sheetname 是您要引用的命名范围所在的工作表的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T21:34:49.233

Excel 中没有允许您执行此操作的本机函数。您需要编写一个宏并将其分配给按钮控件（您可以使用控件工具箱工具栏 - 视图 > 工具栏 > 控件工具箱将其拖放到工作表中）。

然后，您通常会通过双击按钮（当它仍在设计视图中时）并在新生成的“CommandButton_Click”事件中调用您的宏来将宏分配给该按钮。正如 Lance 所说，命名范围是最容易使用的。

要回答问题的最后一部分，以编程方式复制范围也不会复制格式或公式。它只取单元格的值。因此，无论您的源范围是否隐藏，目标都不需要显式设置其 `visible` 属性 - 复制时会忽略 hidden 属性。

# .net - parameterizedThreadstart、Threadstart和Thread的区别

> ID：267765
> 
> 赞同：9
> 
> 时间：2008-11-06T06:20:26.773
> 
> 标签：.net, multithreading

parameterizedThreadstart、Threadstart 和 Thread 有什么区别？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-06T06:25:57.697

ThreadStart 和 ParameterizedThreadStart 是委托类型，定义如下：

```
 public delegate void ThreadStart()
 public delegate void ParameterizedThreadStart(object state) 
```

它们都用于指定新线程将采取的操作。显然 ParamaterizedThreadStart 需要一个参数，而 ThreadStart 没有:) 这曾经是一种非常方便的方式，可以为新线程提供具有特定数据的任务 - 现在我只使用匿名函数作为闭包。

该类`Thread`代表执行线程本身 - 您创建一个（使用上述委托之一），启动它，然后让它运行。

有关更多详细信息，请参阅我[关于参数化线程的文章](http://pobox.com/~skeet/csharp/threads/parameters.shtml)- 尽管从这里开始它现在似乎已经关闭:(

# java - Java Swing GUI 主题

> ID：267766
> 
> 赞同：4
> 
> 时间：2008-11-06T06:20:47.100
> 
> 标签：java, swing, themes, look-and-feel

是否可以为 Swing 开发自定义 PLAF 主题？我将不胜感激这个主题的建设性建议谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T10:47:22.723

是的！但不要那样做。如果你只需要改变颜色。尝试 JGoodies 或 Substance 并遵守编写自己的 PLAF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T10:53:34.117

这取决于你到底想做什么。编写您自己的从 Java Basic 或 Metal 扩展的 LAF 需要大量工作，但可以完成。如果您有一些特殊的目标，例如为 Jtrees 绘制渐变背景或突出显示动画，这将变得很棘手，但也可以这样做。下载用于 swing 的开源 LAF 并查看源代码对于学习如何编写自己的 PLAF 也很有帮助。请看[这里](https://looks.dev.java.net/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-15T11:52:17.417

尝试 java 物质
[https://substance.dev.java.net/see.html](https://substance.dev.java.net/see.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T06:23:02.710

Infonode 提供了一个用于开发新外观的框架。他们有一个您可以使用的 GPL 库。

看到[这个](http://www.infonode.net/index.html?ilf)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-08T03:21:25.527

如果您想自定义 Swing 的外观和感觉 - 看看 PLAF 之外的库，例如 FUSE。这是下一代挥杆外观和感觉定制。

以下是一些截图： [http ://www.curious-creature.org/2006/02/12/fuseswing-demo/](http://www.curious-creature.org/2006/02/12/fuseswing-demo/)

这里是图书馆： [https ://fuse.dev.java.net/](https://fuse.dev.java.net/)

这是使用过的东西： [https](https://aerith.dev.java.net/) ://aerith.dev.java.net/ （还有一些很棒的截图）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T08:55:33.637

Sun provides an interesting [introduction for creating a custom PLAF](http://java.sun.com/products/jfc/tsc/articles/sce/index.html).

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T21:51:41.527

可以使用内置的 Synth Look-and-Feel 创建自定义 PLAF。它基本上是一个 PLAF，它允许您通过 XML 配置文件自定义所有组件的外观（或者只是通过组件命名的特定组件）。JavaDoc 包很好地概述`[javax.swing.plaf.synth][1]`了可能的情况，并且在 JavaDocs 中链接了其他文档以使用此 PLAF。

我以前在我自己的项目中使用过它，它很容易使用。您可以为所有组件使用自己的自定义图形图像，并且可以自定义几乎任何您想要的东西，而无需经历过去制作 PLAF 所需的所有繁琐的自定义编码

# javascript - SOAP - 谷歌地图和 Javascript - 连接到网络服务

> ID：267774
> 
> 赞同：1
> 
> 时间：2008-11-06T06:24:13.317
> 
> 标签：javascript, google-maps, soap

我需要使用 javascript 连接到 asmx 网络服务。网络服务接受并返回一个肥皂响应。我正在寻找如何使用 javascript 连接到 web 服务的示例代码。它返回经纬度详细信息，然后我将使用这些详细信息在谷歌地图上绘制标记。我也有跨域脚本的问题...

我应该提供肥皂反应的例子吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T06:36:30.857

有一些 JavaScript SOAP 客户端库：

*   [jQuery SOAP 客户端](http://plugins.jquery.com/project/jqSOAPClient)
*   [JavaScript SOAP 客户端](http://www.codeplex.com/JavaScriptSoapClient)

这些库将允许您轻松发出 SOAP 请求并处理结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T23:13:24.793

我强烈建议您在 Web 域上实现 SOAP 客户端。让 JS 调用你的服务器，然后再调用 ASMX。然后，Web 服务的响应应在您的服务器上转换为合适的 JSON，然后再将其发送到客户端。

这样，您就摆脱了跨域问题，无需在浏览器中加载 SOAP 客户端，向客户端传输的冗长数据更少，并且您可以选择在服务器上缓存 Web 服务调用以加快处理速度如果你愿意的话。

# java - Java 类可访问性

> ID：267781
> 
> 赞同：2
> 
> 时间：2008-11-06T06:27:26.290
> 
> 标签：java, class, accessibility

[与我的另一个问题](https://stackoverflow.com/questions/267750/java-instance-variable-accessibility)略有相关：以下内容有什么区别：

```
private class Joe
protected class Joe
public class Joe
class Joe 
```

再一次，最后两个之间的区别是我最感兴趣的。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-06T06:33:00.007

任何包中的类都可以访问公共类。

具有默认访问权限 ( `class Joe`) 的类仅对同一包中的其他类可见。

private 和 protected 修饰符只能应用于内部类。

私有类仅对其封闭类和同一封闭类中的其他内部类可见。

受保护的类对同一包中的其他类以及扩展封闭类的类可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T06:34:15.060

*   private：仅对外部类可见
*   protected：仅对外部类可见
*   public：对所有其他类可见
*   类：包私有，对同一包中的类可见

有关更多信息，请参阅[JLS](http://java.sun.com/docs/books/jls/third_edition/html/names.html#104285)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T06:54:13.507

[具有默认访问权限的类](http://java-expert.blogspot.com/2007/07/class-declarations-and-modifiers.html)在声明中前面没有修饰符。

[默认访问](http://java-expert.blogspot.com/2007/07/class-declarations-and-modifiers.html)是包级别的访问，因为具有默认访问权限的类只能被同一个包中的类看到。

如果一个类具有默认访问权限，**则另一个包中的类将无法创建该类的实例，甚至无法声明变量或返回类型**。编译器会抱怨。例如：

```
package humanity;
class Person {}

package family;
import humanity.Person;
class Child extends Person {} 
```

尝试编译这 2 个源。如您所见，它们位于不同的包中，编译将失败。

# oracle - oracle express 分离

> ID：267792
> 
> 赞同：0
> 
> 时间：2008-11-06T06:32:27.433
> 
> 标签：oracle, export, oracle-xe, detach

嗨，我是新手，我习惯于 MS SQL 管理器的附加/分离功能将数据库放入单个文件中，这样我就可以将其移动到其他计算机/SQL 实例。简而言之，这就是我想要做的。

我有一个大型 Oracle Express 数据库（实例名称 Zeus），我需要移动到其他 Oracle Express 实例（全新安装），然后我需要使用 Zeus 的数据库更新它们。

我该怎么做呢？我不明白如何导出数据库/模式 - 用户定义/权限、表定义和表数据。

多谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T07:35:05.887

我不相信您可以使用 Oracle（尤其是 XE 版）轻松做到这一点。

你通常会做一个[Import](http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/dp_import.htm#i1007653) / [Export](http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/dp_export.htm)。这会给出类似的东西：

`expdp system/password@XE DUMPFILE=expfull.dmp FULL=y
impdp system/password@XE DUMPFILE=expfull.dmp FULL=y`

expfull.dmp 文件将位于 Oracle XE 安装中名为 oradata/dpdump 的文件夹中。

您还可以使用[此处描述](http://download.oracle.com/docs/cd/B19306_01/server.102/b14223/transport.htm#sthref729)和总结[的可](http://www.psoug.org/reference/tts.html)[传输表空间](http://download.oracle.com/docs/cd/B19306_01/server.102/b14231/tspaces.htm#ADMIN01101)。

[另一种方法](http://www.dba-oracle.com/oracle_tips_db_copy.htm)涉及 10 个步骤，并且必须适应 Oracle XE。我在这里提到它以供参考。

# sql-server - SQL Server - 如何插入记录并确保它是唯一的

> ID：267804
> 
> 赞同：22
> 
> 时间：2008-11-06T06:43:43.793
> 
> 标签：sql-server, insert, unique

我试图找出将记录插入单个表的最佳方法，但前提是该项目尚不存在。在这种情况下，KEY 是一个 NVARCHAR(400) 字段。对于这个例子，让我们假装它是牛津英语词典中的一个*词*的名字/在这里插入你最喜欢的词典。另外，我猜我需要将 Word 字段设置为主键。（该表也将有一个唯一标识符 PK 也）。

所以..我可能会得到这些我需要添加到表中的词...

例如。

*   猫
*   狗
*   富
*   酒吧
*   皮尤
*   ETC...

所以传统上，我会尝试以下（伪代码）

```
SELECT WordID FROM Words WHERE Word = @Word
IF WordID IS NULL OR WordID <= 0
    INSERT INTO Words VALUES (@Word) 
```

IE。*如果该词不存在，则插入它。*

现在..我担心的问题是我们得到了很多点击..那么这个词是否有可能从另一个进程插入到 SELECT 和 INSERT 之间.. 然后会抛出一个约束错误? （即[竞争条件](http://en.wikipedia.org/wiki/Race_condition "比赛条件")）。

然后我认为我可能能够做到以下几点......

```
INSERT INTO Words (Word)
SELECT @Word
WHERE NOT EXISTS (SELECT WordID FROM Words WHERE Word = @Word) 
```

基本上，*当它不存在时插入一个单词。*

抛开语法错误不谈，我不确定这是好是坏，因为它如何锁定表（如果确实如此），并且在表上的性能不高，以至于它获得大量读取和大量写入。

那么 - 你的 Sql 大师认为/做什么？

我希望有一个简单的插入并“捕获”任何抛出的错误。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-06T07:31:11.670

您的解决方案：

```
INSERT INTO Words (Word)
    SELECT @Word
WHERE NOT EXISTS (SELECT WordID FROM Words WHERE Word = @Word) 
```

......几乎和它一样好。您可以将其简化为：

```
INSERT INTO Words (Word)
    SELECT @Word
WHERE NOT EXISTS (SELECT * FROM Words WHERE Word = @Word) 
```

...因为 EXISTS 实际上不需要返回任何记录，因此查询优化器不会费心查看您要求的字段。

但是，正如您所提到的，这并不是特别高效，因为它会在 INSERT 期间锁定整个表。除此之外，如果您在 Word 中添加唯一索引（它不需要是主键），那么它只需要锁定相关页面。

您最好的选择是模拟预期负载并使用 SQL Server Profiler 查看性能。与任何其他领域一样，过早优化是一件坏事。定义可接受的性能指标，然后在做任何其他事情之前进行测量。

如果这仍然不能为您提供足够的性能，那么数据仓库领域的许多技术可以提供帮助。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-10-20T16:05:52.010

我想我已经找到了一个更好（或至少更快）的答案。创建一个索引，如：

```
CREATE UNIQUE NONCLUSTERED INDEX [IndexTableUniqueRows] ON [dbo].[table] 
(
    [Col1] ASC,
    [Col2] ASC,

)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = ON, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY] 
```

包括所有定义唯一性的列。重要的部分是 IGNORE_DUP_KEY = ON。这会将非唯一插入变成警告。SSIS 会忽略这些警告，您仍然可以使用 fastload。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T07:33:19.993

如果您使用的是 MS SQL Server，则可以在需要唯一的表列上创建唯一索引（[在此处](http://msdn.microsoft.com/en-us/library/ms191166.aspx)记录）：

```
CREATE UNIQUE [ CLUSTERED | NONCLUSTERED ] INDEX <index_name>
    ON Words ( word [ ASC | DESC ]) 
```

指定`Clustered`或`NonClustered`，具体取决于您的情况。此外，如果您希望对其进行排序（以实现更快的搜索），请指定`ASC`或`DESC`作为排序顺序。

如果您想了解有关索引架构的更多信息，请参见[此处。](http://en.wikipedia.org/wiki/Index_(database))

否则，您可以使用[此处](http://msdn.microsoft.com/en-us/library/ms191166.aspx)`UNIQUE CONSTRAINTS`记录的内容：

```
ALTER TABLE Words
ADD CONSTRAINT UniqueWord
UNIQUE (Word); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T11:11:18.077

我有类似的问题，这就是我解决它的方法

```
insert into Words
( selectWord , Fixword)
SELECT word,'theFixword'
FROM   OldWordsTable
WHERE 
(
    (word LIKE 'junk%') OR
     (word LIKE 'orSomthing') 

)
and word not in 
    (
        SELECT selectWord FROM words WHERE selectWord = word
    ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T10:46:48.200

虽然唯一约束肯定是一种方法，但您也可以将其用于插入逻辑： [http ://www.sqlteam.com/article/application-locks-or-mutexes-in-sql-server-2005](http://www.sqlteam.com/article/application-locks-or-mutexes-in-sql-server-2005)

基本上，您不会在下表上放置任何锁，因此不必担心读取，而您的存在性检查将可以正常执行。

它是 sql 代码中的互斥锁。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T08:29:08.337

我不能谈论 MS SQL 的细节，但 SQL 中的一个主键的一点是确保唯一性。因此，根据通用 SQL 术语的定义，主键是表中唯一的一个或多个字段。虽然有不同的方法来强制执行此行为（用新条目替换旧条目而不是拒绝新条目）如果 MS SQL 都没有强制执行此行为的机制并且它不是拒绝新条目。只需确保将主键设置为 Word 字段，它*应该可以*工作。

不过，我再次声明这一切都来自我从 MySQL 编程和我的数据库课程中获得的知识，所以如果我对 MS SQL 的复杂性不感兴趣，我深表歉意。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-11-06T11:02:04.380

```
declare @Error int

begin transaction
  INSERT INTO Words (Word) values(@word)
  set @Error = @@ERROR
  if @Error <> 0 --if error is raised
  begin
      goto LogError
  end
commit transaction
goto ProcEnd

LogError:
rollback transaction 
```

# sql-server - 将 SDF 数据库转换为 MDF

> ID：267807
> 
> 赞同：5
> 
> 时间：2008-11-06T06:47:19.057
> 
> 标签：sql-server, vb.net, sql-server-ce

我有这个 SQL Server CE 数据库，我想将它转换为 SQL Server 2008 数据库，因为我希望它可以通过网络访问。我正在使用 SQL Server 2008 Express 和 VB9。

任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T06:51:35.117

一种简单的方法是进入 SQL Management Studio（我认为它可以连接到 SDF 文件？）并右键单击它，在操作中将有一个脚本数据库到文本文件。这将为您提供创建架构的 SQL 脚本，然后您可以在 SQL 2008 中创建它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T09:06:59.970

这完全取决于您使用的 SQL Server Management Studio 版本。如果您使用 SQL Server 2005 Management Studio Express，请确保您从该[链接](http://www.microsoft.com/downloads/details.aspx?FamilyID=6053c6f8-82c8-479c-b25b-9aca13141c9e&DisplayLang=en)下载带有 Service Pack2 的那个，而不是[这个](http://www.microsoft.com/downloads/details.aspx?familyid=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&displaylang=en)。Management Studio 2005 的完整版确实支持 sdf 文件。不过，我无法评论 2008 Express 版本。

# sql - SQL（MySQL）：匹配字符串中任何单词的首字母？

> ID：267808
> 
> 赞同：4
> 
> 时间：2008-11-06T06:47:57.840
> 
> 标签：sql, mysql

（注意：这是针对 MySQL 的 SQL，而不是 SQL Server。）

我有一个数据库列，其中包含“abc def GHI JKL”之类的值。我想编写一个 WHERE 子句，其中包括对以特定字母开头的任何单词的不区分大小写的测试。例如，该示例将测试字母 a、c、g、j 是否为真，因为每个字母都以“单词”开头。该应用程序用于提供查找仅包含以指定字母开头的单词的记录的搜索。另请注意，此表没有全文索引。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T08:06:38.540

你可以使用一个`LIKE`操作。如果您的单词是空格分隔的，请在字符串的开头附加一个空格，以使第一个单词有机会匹配：

```
SELECT
  StringCol
FROM
  MyTable
WHERE
  ' ' + StringCol LIKE '% ' + MyLetterParam + '%' 
```

哪里`MyLetterParam`可能是这样的：

```
'[acgj]' 
```

要查找不仅仅是空格作为单词分隔符，您可以扩展该技术。以下将 TAB、CR、LF、空格和 NBSP 视为单词分隔符。

```
WHERE
  ' ' + StringCol LIKE '%['+' '+CHAR(9)+CHAR(10)+CHAR(13)+CHAR(160)+'][acgj]%' 
```

这种方法具有作为标准 SQL 的良好感觉。它将在主要的 SQL 方言中保持不变。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T08:05:48.433

使用 REGEXP 运算符：

```
SELECT * FROM `articles` WHERE `body` REGEXP '[[:<:]][acgj]' 
```

它返回列体包含以 a、c、g 或 i 开头的单词的记录（不区分大小写）

但请注意：如果您期望任何重负载（不使用索引 - 它扫描每一行！），这不是一个好主意

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T06:53:20.217

检查 MySQL 参考手册的[模式匹配](http://dev.mysql.com/doc/refman/5.0/en/pattern-matching.html)和[正则表达式](http://dev.mysql.com/doc/refman/5.0/en/regexp.html)部分。

# c# - 使用 SDK 轻松编辑 Excel 电子表格

> ID：267823
> 
> 赞同：4
> 
> 时间：2008-11-06T07:03:09.930
> 
> 标签：c#, excel, sdk, openxml

有没有人使用 Microsoft Open XML SDK 2.0 来编辑 Excel 电子表格，我已经只使用 XML 方法编辑了 Open XML 文档，但是由于存在 SDK，有人知道是否真的有一些基本功能的简单方法? 例如在单元格中插入内容。此外，我认为 Open XML Power Tools（在 codeplex 上发布）主要使用 XML 对象。如果你有经验，你能给我一个例子或提示我可以找到有用的例子吗？我已经知道 openxmldeveloper.org 网站，但研讨会视频也对我没有帮助。

谢谢

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-25T14:23:54.070

Sebastian，我还没有使用过这个 API，但很快就会使用它。似乎有一些方法可以打开文档、更新/插入单元格。请查看 MSDN。此外，还有一个示例：http: [//msdn.microsoft.com/en-us/library/cc861607 (office.14).aspx](http://msdn.microsoft.com/en-us/library/cc861607(office.14).aspx)

祝你好运！

# c++ - 如何找到我的进程在 Linux 中打开的文件句柄？

> ID：267825
> 
> 赞同：12
> 
> 时间：2008-11-06T07:05:00.490
> 
> 标签：c++, c, linux, file-io

当我们在 Unix 中执行 fork 时，会继承打开的文件句柄，如果我们不需要使用它们，我们应该关闭它们。但是，当我们使用库时，可能会打开我们无权访问句柄的文件句柄。我们如何检查这些打开的文件句柄？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-06T07:30:11.030

在 Linux 中，您可以检查`/proc/<pid>/fd`目录 - 每个打开的 fd 都会有一个名为句柄的文件。我几乎可以肯定这种方式是不可移植的。

或者，您可以使用`lsof`- 适用于 Linux、AIX、FreeBSD 和 NetBSD，根据`man lsof`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-06T07:28:40.020

如果库正在打开你不知道的文件，你怎么知道他们在分叉后不需要它们？未导出的句柄是一个内部库细节，如果库想要关闭它们，它将注册一个 atfork() 处理程序来关闭它们。在一段代码后面走来走去关闭它的文件句柄将导致微妙的难以调试的问题，因为当库尝试使用它知道它正确打开但没有关闭的句柄时会意外出错。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-06T11:23:29.750

您可以从外壳执行以下操作：

`lsof -P -n -p _PID_`

其中*PID*是您的进程 pid。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-06T10:50:21.393

正如@Louis Gerbarg 的回答所提到的，这些库可能希望文件句柄保持打开状态`fork()`（毕竟，这应该是父进程的几乎相同的副本）。

大多数人遇到的问题是`exec()`经常跟在`fork()`. 在这里，正确的解决方案是让创建句柄的库将它们标记为 close-on-exec ( `FD_CLOEXEC`)。

在多线程程序使用的库中，在创建文件句柄和对其进行设置的库之间存在竞争条件（两个操作之间`FD_CLOEXEC`可以有另一个线程）。`fork()`为了解决这个问题，[`O_CLOEXEC`](http://udrepper.livejournal.com/20407.html)在 Linux 内核中引入了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T08:26:40.027

首先，您实际上并不需要非常关心您不知道的打开文件描述符。如果你知道你不会再写信给他们，关闭它们是个好主意而且不会有什么坏处——毕竟你只是做了一个 fork()，fds 打开了两次。但同样，如果你让它们打开，它们也不会打扰你——毕竟，你不知道它们，你大概不会随意给它们写信。

至于你的第三方库会做什么，无论哪种方式都有点折腾。有些人可能不希望遇到使用 fork() 的情况，并且最终可能会意外地从两个进程写入同一个 fd 而没有任何同步。其他人可能不希望您关闭他们的 fds。你必须检查一下。这就是为什么在库中随机打开文件描述符而不将其交给调用者管理是一个坏主意的原因。

综上所述，本着回答原始问题的精神，没有特别好的方法。您可以在文件描述符上调用`dup()`或；`dup2()`如果它已关闭，则调用将失败并显示`EBADF`. 所以你可以说：

```
int newfd = dup(oldfd);
if (newfd > 0)
{
    close(newfd);
    close(oldfd);
} 
```

但在这一点上，您最好`close(oldfd)`首先说并忽略任何 EBADF。

假设您仍然想要关闭所有内容的核选项，那么您需要找到可能的打开文件描述符的最大数量。假设 1 到 65,535 不是一个好主意。首先，fds 当然从 0 开始，但也没有定义特定的上限。为了便于移植，POSIX`sysconf(_SC_OPEN_MAX)`应该告诉您，在任何健全的 POSIX 系统上，尽管严格来说它是可选的。如果您感到偏执，请检查 -1 的返回值，尽管此时您大多不得不退回到硬编码值（1024 应该没问题，除非您正在做一些非常奇怪的事情）。或者，如果您对 Linux 特定感到满意，您可以在 /proc 中进行挖掘。

不要忘记不要关闭 fds 0、1 和 2 - 这真的会让人感到困惑。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T07:39:02.933

我同意其他人所说的关闭随机文件是危险的。您最终可能会为所有第三方工具提交一些非常有趣的错误报告。

也就是说，如果您*知道*不需要打开这些文件，您可以随时浏览所有有效的文件描述符（1 到 65535，IIRC）并关闭您不认识的所有文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T07:26:50.367

合理的库将始终具有释放它们分配的任何资源（例如文件句柄）的功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T07:29:37.007

只是一个链接，但似乎很有帮助：[打开了多少文件？](http://www.netadmintools.com/art295.html)在 netadmintools.com。似乎使用 /proc 调查来了解进程的打开文件，不确定这是唯一的方法还是是否有 API。为此类信息解析文件可能有点……混乱。此外， /proc 也可能被弃用，需要检查。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T07:42:54.327

这不是设计问题吗？在初始化打开这些文件的库之前，您的进程是否可以分叉？

# c# - 复制文件时如何防止此 System.IO.IOException？

> ID：267830
> 
> 赞同：1
> 
> 时间：2008-11-06T07:10:11.757
> 
> 标签：c#, io, ioexception

当我运行以下代码来测试复制目录时，我在调用 fileInfo.CopyTo 方法时收到 System.IO.IOException。错误消息是：“该进程无法访问文件 'C:\CopyDirectoryTest1\temp.txt'，因为它正被另一个进程使用。”

似乎 file1 ("C:\CopyDirectoryTest1\temp.txt") 上有一个锁，它是在发生错误的几行上方创建的，但如果是这样，我不知道如何释放它。有任何想法吗？

```
using System;
using System.IO;

namespace TempConsoleApp
{
    class Program
    {
        static void Main(string[] args)
        {
            string folder1 = @"C:\CopyDirectoryTest1";
            string folder2 = @"C:\CopyDirectoryTest2";
            string file1 = Path.Combine(folder1, "temp.txt");

            if (Directory.Exists(folder1))
                Directory.Delete(folder1, true);
            if (Directory.Exists(folder2))
                Directory.Delete(folder2, true);

            Directory.CreateDirectory(folder1);
            Directory.CreateDirectory(folder2);
            File.Create(file1);

            DirectoryInfo folder1Info = new DirectoryInfo(folder1);
            DirectoryInfo folder2Info = new DirectoryInfo(folder2);

            foreach (FileInfo fileInfo in folder1Info.GetFiles())
            {
                string fileName = fileInfo.Name;
                string targetFilePath = Path.Combine(folder2Info.FullName, fileName);
                fileInfo.CopyTo(targetFilePath, true);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-06T07:14:36.133

[`File.Create`](http://msdn.microsoft.com/en-us/library/system.io.file.create.aspx)返回一个打开[`FileStream`](http://msdn.microsoft.com/en-us/library/system.io.filestream.aspx)- 您需要关闭该流。

只是

```
using (File.Create(file1)) {} 
```

应该做的伎俩。

# c - 设置、清除和测试单个位的算法说明

> ID：267832
> 
> 赞同：5
> 
> 时间：2008-11-06T07:10:20.370
> 
> 标签：c, bit-manipulation

嘿，在 Programming Pearls 书中，有一个源代码用于设置、清除和测试 int 数组中的一些给定索引，实际上是一个集合表示。

代码如下：

```
#include<stdio.h>
#define BITSPERWORD 32
#define SHIFT 5
#define MASK 0x1F
#define N 10000000

int a[1+ N/BITSPERWORD];

void set(int i)
{
    a[i>>SHIFT] |= (1<<(i & MASK));
}

void clr(int i)
{
    a[i>>SHIFT] &= ~(1<<(i & MASK));
}

int test(int i)
{
    a[i>>SHIFT] & (1<<(i & MASK));
} 
```

有人可以解释一下 SHIFT 和 MASK 定义的原因吗？它们在代码中的用途是什么？

我已经阅读了之前的相关[问题](https://stackoverflow.com/questions/47981/how-do-you-set-clear-and-toggle-a-single-bit-in-c)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T07:22:27.443

VonC 通常发布了一个关于位掩码的好答案。下面是一些更具体到您发布的代码的信息。

给定一个表示位的整数，我们计算出数组的哪个成员持有该位。即：位 0 到 31 位于 中`a[0]`，位 32 到 63 位于 中`a[1]`，依此类推。`i>>SHIFT`所做的只是`i / 32`。这可以确定位中的哪个成员`a`。使用优化编译器，这些可能是等价的。

显然，现在我们已经找到了该位标志的哪个成员`a`，我们需要确保我们在该整数中设置了正确的位。这就是这样`1 << i`做的。但是，我们需要确保不要尝试访问 32 位整数中的第 33 位，因此移位操作受到使用`1 << (i & 0x1F)`. 这里的魔法`0x1F`是 31，所以我们永远不会左移`i`超过 31 个位置所代表的位（否则它应该在 的下一个成员中`a`）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T07:15:40.123

从[这里](http://bytes.com/forum/thread847594.html)（开始这个线程的一般答案）

位掩码是一个值（可以存储在变量中），使您能够隔离整数类型中的一组特定位。

通常，被屏蔽的位会将您感兴趣的位设置为 1，将所有其他位设置为 0。然后，掩码允许您隔离位的值、清除所有位或设置所有位或设置新值到位。

掩码（尤其是多位掩码）通常具有关联的移位值，该值是位需要左移的量，以便将最低有效掩码位移动到类型中的最低有效位。

例如，使用 16 位短数据类型假设您希望能够屏蔽位 3、4 和 5（LSB 是数字 0）。你的面具和转变看起来像

```
#define MASK 0x0038
#define SHIFT 3 
```

掩码通常以十六进制分配，因为与十进制相比，使用该基数的数据类型中的位更容易。历史上八进制也被用于位掩码。

如果我有一个变量 var，其中包含与掩码相关的数据，那么我可以像这样隔离这些位

```
var & MASK 
```

我可以像这样隔离所有其他位

```
var & ~MASK 
```

我可以像这样清除这些位

```
var &= ~MASK; 
```

我可以像这样清除所有其他位

```
var &= MASK; 
```

我可以像这样设置所有位

```
var |= MASK; 
```

我可以像这样设置所有其他位

```
var |= ~MASK; 
```

我可以像这样提取位的十进制值

```
(var & MASK) >> SHIFT 
```

我可以为这样的位分配一个新值

```
var &= ~MASK;
var |= (newValue << SHIFT) & MASK; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-06T07:25:38.717

当你想在数组中设置一个位时，你必须

1.  寻找正确的数组索引和
2.  在此数组项中设置适当的位。

一个数组项中有`BITSPERWORD`(=32) 位，这意味着必须将索引`i`分成两部分：

*   最右边的 5 位用作数组项中的索引，并且
*   其余位（最左边的 28 个）用作数组的索引。

你得到：

*   最**左边的 28 位通过丢弃最右边的五个**，这正是**`i>>SHIFT`**所做的，并且
*   通过屏蔽除最**右边的五位以外的任何内容来屏蔽最右边的五位**，这就是这样**`i & MASK`**做的。

我想你明白其余的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T07:29:09.427

[位运算](http://en.wikipedia.org/wiki/Bitwise_operation)和[Mask](http://en.wikipedia.org/wiki/Mask_(computing))的前几段是一个简洁的解释，并包含一些进一步研究的指针。

将 8 位字节视为来自 8 成员 Universe 的一组元素。当相应的位被设置时，一个成员**在集合中。**设置多一点不会修改[集合成员资格](http://en.wikipedia.org/wiki/Set_membership)（一个位只能有 2 个状态）。*C*中的[位运算符](http://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B#Bitwise_operators)通过*屏蔽*和*移位*提供对位的访问。

 **** * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T07:50:59.490

该代码试图`N`通过数组存储位，其中数组的每个元素包含`BITSPERWORD`(32) 位。

因此，如果您尝试访问 bit `i`，则需要计算存储它的数组元素的索引（`i/32`），这就是这样`i>>SHIFT`做的。

然后你需要访问我们刚刚得到的数组元素中的那个位。

`(i & MASK)`给出数组元素（字）的位位置. `(1<<(i & MASK))`使该位置的位被设置。

现在您可以设置/清除/测试该位`a[i>>SHIFT]`。`(1<<i & MASK))`

你也可能认为`i`是一个 32 位的数字，位 6~31 是存储它的数组元素的索引，位 0~5 代表字中的位位置。

# c++ - Windows 服务如何执行 GUI 应用程序？

> ID：267838
> 
> 赞同：53
> 
> 时间：2008-11-06T07:15:39.423
> 
> 标签：c++, winapi, windows-services

我编写了一个 Windows 服务，允许我远程运行和停止应用程序。这些应用程序使用 CreateProcess 运行，这对我有用，因为它们中的大多数只执行后端处理。最近，我需要运行将 GUI 呈现给当前登录用户的应用程序。如何在 C++ 中编码以允许我的服务定位当前活动的桌面并在其上运行 GUI？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-11-06T07:36:45.213

Roger Lipscombe 的回答是，使用[WTSEnumerateSessions](http://msdn.microsoft.com/en-us/library/aa383833.aspx)找到正确的桌面，然后[CreateProcessAsUser](http://msdn.microsoft.com/en-us/library/ms682429.aspx)在该桌面上启动应用程序（您将桌面句柄作为[STARTUPINFO](http://msdn.microsoft.com/en-us/library/ms686331.aspx)结构的一部分传递给它）是正确的。

但是，我*强烈*建议不要这样做。在某些环境中，例如具有许多活动用户的终端服务器主机，确定哪个桌面是“活动”桌面并不容易，甚至不可能。

但最重要的是，如果一个应用程序突然出现在用户的桌面上，这很可能发生在一个糟糕的时间（可能是因为用户根本没想到它，或者因为您试图在会话结束时启动应用程序） '尚未完全初始化，在关闭过程中，或其他）。

更传统的方法是在全球启动组中为您的服务放置一个小型客户端应用程序的快捷方式。然后，此应用程序将与每个用户会话一起启动，并可用于启动其他应用程序（如果需要），而无需处理用户凭据、会话和/或桌面。

此外，管理员可以根据需要移动/禁用此快捷方式，这将使您的应用程序的部署更加容易，因为它不会偏离其他 Windows 应用程序使用的标准......

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-06T08:05:25.733

简短的回答是“你不需要”，因为打开在另一个用户上下文下运行的 GUI 程序是一个安全漏洞，通常称为[Shatter Attack](http://en.wikipedia.org/wiki/Shatter_attack)。

看看这篇 MSDN 文章：[交互式服务](http://msdn.microsoft.com/en-us/library/ms683502(VS.85).aspx)。它为服务与用户交互提供了一些选项。

简而言之，您有以下选择：

*   使用 WTSSendMessage 函数在用户会话中显示一个对话框。

*   创建一个单独的隐藏 GUI 应用程序并使用 CreateProcessAsUser 函数在交互式用户的上下文中运行该应用程序。设计 GUI 应用程序以通过某种进程间通信 (IPC) 方法与服务进行通信，例如命名管道。该服务与 GUI 应用程序通信以告诉它何时显示 GUI。应用程序将用户交互的结果传回给服务，以便服务可以采取适当的行动。请注意，除非您使用适当的访问控制列表 (ACL)，否则 IPC 可以通过网络公开您的服务接口。

    如果此服务在多用户系统上运行，请将应用程序添加到以下项，以便它在每个会话中运行：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run。如果应用程序为 IPC 使用命名管道，则服务器可以通过根据会话 ID 为每个管道赋予唯一名称来区分多个用户进程。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T07:23:40.840

WTSEnumerateSessions 和 CreateProcessAsUser。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-06T07:51:14.717

有几个人建议使用 WTSEnumerateSessions 和 CreateProcessAsUser。我想知道为什么没有人建议 WTSGetActiveConsoleSessionId，因为您说您只想针对一个登录用户。

不过，有几个人确实建议 CreateProcessAsUser 是正确的。如果您按照您所说的方式调用普通的旧 CreateProcess，那么应用程序的 GUI 将使用您的服务权限而不是用户权限运行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-07T07:44:44.433

问题 Session 0 , Interactive Services , Windows Service Allow Service To Interact With Desktop on Windows 7 or Windows Vista

你可以阅读这篇文章 [http://www.codeproject.com/KB/vista-security/SubvertingVistaUAC.aspx](http://www.codeproject.com/KB/vista-security/SubvertingVistaUAC.aspx)

我尝试在这里解释它在 Windows 7 上运行

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T07:40:29.810

在 Win2K、XP 和 Win2K3 上，控制台用户在会话 0 中登录，服务所在的会话相同。如果服务配置为交互式，它将能够在用户桌面上显示 UI。

但是，在 Vista 上，没有用户可以在会话 0 中登录。从服务中显示 UI 有点棘手。您需要使用[WTSEnumerateSessions](http://msdn.microsoft.com/en-us/library/aa383833.aspx) API 枚举活动会话，找到控制台会话并以该用户身份创建进程。当然，您还需要一个令牌或用户凭据才能做到这一点。[您可以在此处](http://blogs.msdn.com/sripod/archive/2006/11/21/session-0-isolation-in-vista-and-application-compatibility.aspx)阅读有关此过程的更多详细信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T07:24:00.433

我认为只要您只有一个用户登录，它就会自动显示在该用户的桌面上。

无论如何，让服务启动 exe 时要非常小心。

如果对带有 exe 的文件夹的写访问权限不受限制，则任何用户都可以将该 exe 替换为任何其他程序，然后该程序将以系统权限运行。以 cmd.exe 为例（适用于所有 Windows 系统）。下次该服务尝试启动您的 exe 时，您将获得一个具有系统权限的命令外壳...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T07:31:47.267

如果您从服务启动 GUI，它将显示在当前活动的桌面上。

但前提是您调整了服务权限：您需要允许它[与桌面交互](http://technet.microsoft.com/en-us/library/cc782435.aspx)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-19T20:50:04.003

从 Windows Vista 开始，重要服务无法直接与用户交互。因此，不应在新代码中使用标题为“使用交互式服务”一节中提到的技术。

这取自： http: [//msdn.microsoft.com/en-us/library/ms683502 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms683502(VS.85).aspx)

# ruby-on-rails - 在 Rails 中获取渲染图像到浏览器

> ID：267841
> 
> 赞同：2
> 
> 时间：2008-11-06T07:18:14.457
> 
> 标签：ruby-on-rails, ruby

我正在编写一个将数据处理成图表的 Rails 应用程序（使用 Scruffy）。我想知道如何将图形呈现为博客/字符串，然后将博客/字符串直接发送到要显示的浏览器（而不将其保存到文件中）？还是我需要渲染它，将其保存到文件中，然后在浏览器中显示保存的图像文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T09:18:46.380

I think you will be able to use [send_data](http://www.railsbrain.com/api/rails-2.1.0/doc/index.html?a=M000271&name=send_data) for this purpose:

```
send_data data_string, :filename => 'icon.jpg', :type => 'image/jpeg', :disposition => 'inline' 
```

If you put this in a controller action - say show on a picture controller, then all you need do is include the following in your view (assuming RESTful routes):

```
<%= image_tag picture_path(@picture) %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T11:55:04.460

I wonder if sending direct to the browser is the best way? If there is the possibility that users will reload the page would this short circuit any cache possibilities? I ask because I really don't know.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-25T08:58:12.947

> “如果用户有可能重新加载页面，这种短路是否会导致任何缓存的可能性？”

否 - 无论您是从文件系统还是 send_data 提供服务都没有关系。无论如何，浏览器正在从您的服务器获取数据。只要确保你已经整理好你的 HTTP 缓存指令。

# java - Ant 构建脚本可以在没有完整路径详细信息的情况下引用 Eclipse 插件文件夹吗？

> ID：267842
> 
> 赞同：1
> 
> 时间：2008-11-06T07:19:50.007
> 
> 标签：java, eclipse, ant

我可以使用以下内容：

```
<fileset dir="C:\Program Files\eclipse\plugins\myplugin">
    <include name="extraStuff.jar" />
</fileset> 
```

但这会破坏未将 eclipse 安装到默认文件夹中的其他人的 PC 上的构建文件。

在我的情况下，如果没有硬文件夹引用，我就不能使用*basedir 。*

Eclipse 安装文件夹是否有“快捷方式”，我可以从 Eclipse 中运行的 ant 中使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T07:58:08.743

您可以使用 getOutputPath。看看[这个](https://sourceforge.net/projects/ant4eclipse/)。

# visual-studio - Visual Studio 编辑器不再在错误下划线

> ID：267843
> 
> 赞同：124
> 
> 时间：2008-11-06T07:21:44.463
> 
> 标签：visual-studio, editor, underline

我的 Visual Studio (2008) 编辑器已停止为错误加下划线（这条漂亮的波浪形红线）。我真的不知道什么时候，但它可能与 .Net Framework 3.5 SP 1 或 MVC Beta 的安装有关（我猜这不太可能）。此外，我是否出于评估目的安装和卸载了 CodeRush 和 Resharper（决定不保留其中任何一个）。

有谁知道问题以及如何再次恢复此功能？

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2008-11-06T07:27:25.233

您是否检查过`Tools`→<kbd>Options...→<kbd>Text Editor→<kbd>C#→<kbd>Advanced→<kbd>编辑器中的下划线错误？

我通常喜欢在弄乱插件后重置我的设置，因为它们往往会弄乱设置：`Tools`→<kbd>导入和导出设置...→<kbd>重置所有设置。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-05-31T20:29:47.577

**关于可能的原因。**

对于 VS 2012 和 2013，如果您在绑定到一个“实时”帐户的不同机器上拥有多个 Visual Studio 实例并在其中一个上安装了 ReSharper，它将禁用本机 IntelliSense 和错误下划线（用它自己的规则替换）这将通过您的帐户同步到另一台没有 ReSharper 的机器。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2021-01-19T09:22:55.217

在 Visual Studio 2019 中找到它：`Tools > Options > Text Editor > General > Show error squiggles`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-09-22T12:12:33.810

这在 Visual Studio中通常称为**禁用 Squiggl y 或波浪线。**

**您将如何在 Visual Studio 2013 中使用？**

**TOOLS** -> **Options** ... -> **Text Editor** -> **C/C++** -> **Advanced** -> **Disable Squiggles** : **True/False** (Under IntelliSense) -> Press **OK**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-09-29T19:34:54.147

我知道这是一个老问题，并且有各种解决方案，但我以不同的方式解决了它。我正在使用 VS2017 在我的 C# 代码上使用 Unity3D，突然 VS 决定在我输入时停止下划线错误。但是，如果我关闭文件选项卡并重新打开，它会突然取消错误。

例如：

```
class A { 
public int x; 
s;
} 
```

应该明显地为那个孤独的's'符号给出一个错误。但是，在我关闭并重新打开此文件选项卡之前，VS 不会给它加下划线。

**解决方案**：复制整个 Unity Project 文件夹（基本上就像普通的 VS 解决方案文件夹）并使用新文件夹，该问题已经消失。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-04-03T00:57:36.237

对于 Visual Studio 2017，请根据 HeeJae 在以下方面的评论行事：

[https://developercommunity.visualstudio.com/content/problem/113112/design-time-error-checking-isnt-working.html](https://developercommunity.visualstudio.com/content/problem/113112/design-time-error-checking-isnt-working.html)

IE：

你好。您可能遇到了一个已知问题。你能试试这个吗？

1.更新到最新版本如果还没有解决

2.转到工具\选项\项目和解决方案\常规并取消选中“允许并行项目初始化”。

3.关闭VS。

4.删除他们的解决方案文件旁边的“.vs”目录。

5.重新打开VS。

..

谢谢你

问题解决后，您可以重新启用“允许并行项目初始化”选项。

我尝试升级 VS，重置 VS 设置，清除 VS 缓存以及人们通常所做的一切，但他们都没有解决这个问题！最后，上述解决方案神奇地为我工作。

祝你好运

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-05-19T23:30:46.140

从解决方案中再次卸载和加载相同的项目就可以了。只需右键单击项目，然后单击“卸载项目”。卸载后，再次右键单击同一项目，然后单击“重新加载项目”。错误突出显示将返回。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-08T19:13:28.833

我在 2017 年遇到了同样的问题。有一个“禁用智能感知”选项，请确保将其设置为 false。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-01-13T11:40:11.947

对于每个想在 2021 年想知道的人..

在设置中搜索“ *C_Cpp.errorSquiggles* ”。

确保它对用户*以及工作区*都处于活动状态。无需重新启动 Visual Studio。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-09-02T11:19:03.930

对我来说（VS 2019），在尝试了其他答案之后，将分析范围从“当前文档”设置为“打开文档”带回了丢失的错误标记[![在此处输入图像描述](https://i.stack.imgur.com/6zkKZ.png)](https://i.stack.imgur.com/6zkKZ.png)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-20T16:13:10.993

只需转到设置并[在 Error Squiggles 中搜索错误和图像](https://i.stack.imgur.com/vS9eO.png)。您可以看到错误曲线（修改：工作区 - 现在您看不到它，因为我修改了它）。只需单击修改，您将看到禁用的选项。如果您错误地禁用了它，只需启用它，您就可以在代码中再次看到红线错误。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2021-09-01T20:17:28.643

只需在设置中搜索=>“squiggles”，您会发现“C_Cpp: Error Squiggles”选项使其启用

[在此处输入图像描述](https://i.stack.imgur.com/fjApE.png)

# digital-certificate - 是否允许 CA 在签名前修改 CSR？

> ID：267858
> 
> 赞同：1
> 
> 时间：2008-11-06T07:30:11.047
> 
> 标签：digital-certificate, pki, certificate-authority, csr

谁能告诉我是否允许证书颁发机构 (CA) 在使用自己的私钥实际签署证书之前对证书签名请求 (CSR) 进行修改？

具体来说，我想知道 CA 在添加签名之前将其他字段（例如 EKU）插入证书是否有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T12:58:05.223

是的

证书颁发机构负责通过其策略文件和模板执行组织的 PKI 安全策略。这可能包括 EKU（扩展密钥使用）属性。

实际上，您正在代表您的主题从 CA 请求某种类型的证书。由 CA 来强制执行它将颁发的证书类型（以及相关用途）。

CA 实际上并没有修改请求，而是发布了允许类型的证书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T07:54:39.640

我一般不能谈论 CA，但我曾经使用自己的 CA 运行 Windows Server 2003 网络，并且绝对有可能`certreq`（通过`-attrib`选项）在 CSR 到达 CA 之前向 CSR 添加其他字段。因此，在我看来，CA 本身也有可能做同样的事情。

你的旅费可能会改变。

# python - 如何将自动过滤器添加到与 SQLAlchemy 的关系中？

> ID：267861
> 
> 赞同：10
> 
> 时间：2008-11-06T07:33:11.167
> 
> 标签：python, sqlalchemy

我正在使用 SQLAlchemy 0.5rc，并且我想向关系添加一个自动过滤器，以便每次尝试获取该关系的记录时，如果它们被标记为“逻辑上已删除”，它将忽略“远程”记录"（子表的布尔字段）

例如，如果一个对象“父”有一个“子”关系，它有 3 条记录，但其中一条在逻辑上被删除，当我查询“父”时，我希望 SQLA 获取只有两个子的父对象。 .
我应该怎么做？通过向关系的primaryjoin参数添加“and”条件？（例如“ `Children.parent_id == Parent.id and Children.logically_deleted == False`”，但是这样写“and”是否正确？）

**编辑：**
我设法以这种方式做到了

```
children = relation("Children", primaryjoin=and_(id == Children.parent_id, Children.logically_deleted==False)) 
```

但是有没有办法将字符串用作primaryjoin？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-14T23:51:38.140

> 但是有没有办法将字符串用作primaryjoin？

您可以使用以下内容：

```
children = relationship("Children", primaryjoin="and_(Parent.id==Children.parent_id, Children.logically_deleted==False)" 
```

这对我有用！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-10T18:23:30.197

and_() 函数是在 SQLAlchemy 中与 & 运算符一起进行逻辑连接的正确方法，但要小心后者，因为它具有令人惊讶的优先级规则，即比比较运算符具有更高的优先级。

您还可以将字符串用作 text() 构造函数的主要连接，但这会使您的代码因急切加载和连接附带的任何表别名而中断。

对于逻辑删除，最好将整个类映射到忽略已删除值的选择上：

```
mapper(Something, select([sometable], sometable.c.deleted == False)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T08:48:54.257

我目前只是在再次开发 0.4.something，但我的建议如下：

```
db.query(Object).filter(Object.first==value).filter(Object.second==False).all() 
```

我想这就是你想要做的，对吧？

（注意：用网络浏览器编写，不是真正的代码！）

# macros - 是什么让 Lisp 宏如此特别？

> ID：267862
> 
> 赞同：335
> 
> 时间：2008-11-06T07:33:11.977
> 
> 标签：macros, lisp, homoiconicity

阅读[Paul Graham](http://www.paulgraham.com/articles.html)关于编程语言的文章会认为[Lisp 宏](http://wiki.c2.com/?LispMacro)是唯一的出路。作为一个忙碌的开发人员，在其他平台上工作，我没有使用 Lisp 宏的特权。作为一个想了解嗡嗡声的人，请解释一下是什么让这个功能如此强大。

还请将此与我从 Python、Java、C# 或 C 开发领域理解的内容联系起来。

* * *

## 回答 #1

> 赞同：351
> 
> 时间：2011-01-07T01:56:36.450

简而言之，宏用于定义 Common Lisp 或领域特定语言 (DSL) 的语言语法扩展。这些语言直接嵌入到现有的 Lisp 代码中。现在，DSL 可以具有类似于 Lisp 的语法（例如 Peter Norvig 的Common Lisp的[Prolog 解释器）或完全不同的语法（例如 Clojure 的中](http://norvig.com/paip/prolog.lisp)[缀符号数学](http://data-sorcery.org/2010/05/14/infix-math/)）。

这是一个更具体的示例：
Python 具有内置于语言中的列表推导。这为常见情况提供了简单的语法。线

```
divisibleByTwo = [x for x in range(10) if x % 2 == 0] 
```

生成一个包含 0 到 9 之间所有偶数的列表。早在[Python 1.5](https://www.python.org/download/releases/1.5/)天，还没有这样的语法；你会使用更像这样的东西：

```
divisibleByTwo = []
for x in range( 10 ):
   if x % 2 == 0:
      divisibleByTwo.append( x ) 
```

它们在功能上是等效的。让我们调用我们的怀疑暂停并假设 Lisp 有一个非常有限的循环宏，它只进行迭代并且没有简单的方法来完成列表推导的等价。

在 Lisp 中，您可以编写以下内容。我应该注意到这个人为的例子被选为与 Python 代码相同，而不是 Lisp 代码的一个很好的例子。

```
;; the following two functions just make equivalent of Python's range function
;; you can safely ignore them unless you are running this code
(defun range-helper (x)
  (if (= x 0)
      (list x)
      (cons x (range-helper (- x 1)))))

(defun range (x)
  (reverse (range-helper (- x 1))))

;; equivalent to the python example:
;; define a variable
(defvar divisibleByTwo nil)

;; loop from 0 upto and including 9
(loop for x in (range 10)
   ;; test for divisibility by two
   if (= (mod x 2) 0) 
   ;; append to the list
   do (setq divisibleByTwo (append divisibleByTwo (list x)))) 
```

在进一步讨论之前，我应该更好地解释一下宏是什么。它是*逐个*代码对代码执行的转换。也就是说，由解释器（或编译器）读取的一段代码，它将代码作为参数，操作并返回结果，然后就地运行。

当然，这是很多打字，程序员很懒惰。所以我们可以定义 DSL 来进行列表推导。事实上，我们已经在使用一个宏（循环宏）。

Lisp 定义了一些特殊的语法形式。引号 ( `'`) 表示下一个标记是文字。准引号或反引号 ( ```) 表示下一个标记是带有转义的文字。转义符由逗号运算符指示。文字`'(1 2 3)`相当于 Python 的`[1, 2, 3]`. 您可以将其分配给另一个变量或就地使用它。您可以将其``(1 2 ,x)`视为 Python 的`[1, 2, x]`where `x`is a variable 先前定义的等价物。这个列表符号是进入宏的魔法的一部分。第二部分是 Lisp 阅读器，它智能地用宏代替代码，但最好的说明如下：

所以我们可以定义一个叫做`lcomp`（列表理解的缩写）的宏。它的语法将与我们在示例中使用的 python 完全相同`[x for x in range(10) if x % 2 == 0]` -`(lcomp x for x in (range 10) if (= (% x 2) 0))`

```
(defmacro lcomp (expression for var in list conditional conditional-test)
  ;; create a unique variable name for the result
  (let ((result (gensym)))
    ;; the arguments are really code so we can substitute them 
    ;; store nil in the unique variable name generated above
    `(let ((,result nil))
       ;; var is a variable name
       ;; list is the list literal we are suppose to iterate over
       (loop for ,var in ,list
            ;; conditional is if or unless
            ;; conditional-test is (= (mod x 2) 0) in our examples
            ,conditional ,conditional-test
            ;; and this is the action from the earlier lisp example
            ;; result = result + [x] in python
            do (setq ,result (append ,result (list ,expression))))
           ;; return the result 
       ,result))) 
```

现在我们可以在命令行执行：

```
CL-USER> (lcomp x for x in (range 10) if (= (mod x 2) 0))
(0 2 4 6 8) 
```

很整洁吧？现在它不止于此。如果你愿意，你有一个机制，或者一个画笔。你可以有任何你可能想要的语法。就像 Python 或 C# 的`with`语法一样。或 .NET 的 LINQ 语法。最后，这就是 Lisp 吸引人们的地方——终极的灵活性。

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2008-11-06T07:45:13.620

[您将在此处找到有关 lisp 宏](http://lists.warhead.org.uk/pipermail/iwe/2005-July/000130.html)的全面辩论。

那篇文章的一个有趣的子集：

> 在大多数编程语言中，语法很复杂。宏必须分解程序语法，分析它，然后重新组合它。他们无法访问程序的解析器，因此他们必须依赖启发式和最佳猜测。有时他们的降价分析是错误的，然后他们就破产了。
> 
> 但 Lisp 不同。Lisp 宏*确实*可以访问解析器，它是一个非常简单的解析器。 **一个 Lisp 宏不是交给一个字符串，而是一个预先解析的以列表形式存在的源代码，因为 Lisp 程序的源不是一个字符串；这是一个列表。**Lisp 程序非常擅长分解列表并将它们重新组合在一起。他们每天都可靠地做到这一点。
> 
> 这是一个扩展示例。Lisp 有一个宏，叫做“setf”，它执行赋值。最简单的 setf 形式是
> 
> ```
>  (setf x whatever) 
> ```
> 
> 它将符号“x”的值设置为表达式“whatever”的值。
> 
> Lisp 也有列表。您可以使用“car”和“cdr”函数分别获取列表的第一个元素或列表的其余部分。
> 
> 现在，如果您想用新值替换列表的第一个元素怎么办？有一个标准函数可以做到这一点，令人难以置信的是，它的名字甚至比“汽车”还要糟糕。它是“rplaca”。但是你不必记住“rplaca”，因为你可以写
> 
> ```
>  (setf (car somelist) whatever) 
> ```
> 
> 设置 somelist 的汽车。
> 
> 这里真正发生的是“setf”是一个宏。在编译时，它检查它的参数，并发现第一个参数的形式为 (car SOMETHING)。它对自己说：“哦，程序员正在尝试设置汽车。为此使用的函数是'rplaca'。” 它悄悄地重写了代码：
> 
> ```
>  (rplaca somelist whatever) 
> ```

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2008-11-06T09:39:50.660

Common Lisp 宏本质上扩展了代码的“句法原语”。

例如，在 C 中，switch/case 构造仅适用于整数类型，如果您想将其用于浮点数或字符串，则剩下嵌套的 if 语句和显式比较。您也无法编写 C 宏来为您完成这项工作。

但是，由于 lisp 宏（本质上）是一个 lisp 程序，它将代码片段作为输入并返回代码以替换宏的“调用”，因此您可以根据需要扩展您的“原始”曲目，通常结束具有更易读的程序。

要在 C 中做同样的事情，您必须编写一个自定义预处理器，它会吃掉您的初始（不是完全 C）源代码并吐出 C 编译器可以理解的东西。这不是一个错误的方法，但它不一定是最简单的。

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2008-11-06T09:21:51.790

Lisp 宏允许您决定何时（如果有的话）评估任何部分或表达式。举一个简单的例子，想想C：

```
expr1 && expr2 && expr3 ... 
```

这说的是：评估`expr1`，如果它是真的，评估`expr2`等。

现在试着把它`&&`变成一个函数……没错，你不能。调用类似的东西：

```
and(expr1, expr2, expr3) 
```

无论是否为假`exprs`，都会在给出答案之前评估所有三个！`expr1`

使用 lisp 宏，您可以编写如下代码：

```
(defmacro && (expr1 &rest exprs)
    `(if ,expr1                     ;` Warning: I have not tested
         (&& ,@exprs)               ;   this and might be wrong!
         nil)) 
```

现在你有了一个`&&`，你可以像函数一样调用它，它不会评估你传递给它的任何形式，除非它们都是真的。

要了解这有什么用，请对比：

```
(&& (very-cheap-operation)
    (very-expensive-operation)
    (operation-with-serious-side-effects)) 
```

和：

```
and(very_cheap_operation(),
    very_expensive_operation(),
    operation_with_serious_side_effects()); 
```

您可以使用宏做的其他事情是创建新的关键字和/或迷你语言（查看[`(loop ...)`](http://www.ai.sri.com/pkarp/loop.html)宏以获取示例），将其他语言集成到 lisp 中，例如，您可以编写一个宏，让您说以下内容：

```
(setvar *rows* (sql select count(*)
                      from some-table
                     where column1 = "Yes"
                       and column2 like "some%string%") 
```

那甚至没有进入[阅读器宏](http://dorophone.blogspot.com/2008/03/common-lisp-reader-macros-simple.html)。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2011-01-07T00:58:55.527

我想我从来没有见过比这个家伙解释得更好的 Lisp 宏：http: [//www.defmacro.org/ramblings/lisp.html](http://www.defmacro.org/ramblings/lisp.html)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-11-06T11:32:01.433

Think of what you can do in C or C++ with macros and templates. They're very useful tools for managing repetitive code, but they're limited in quite severe ways.

*   Limited macro/template syntax restricts their use. For example, you can't write a template which expands to something other than a class or a function. Macros and templates can't easily maintain internal data.
*   The complex, very irregular syntax of C and C++ makes it difficult to write very general macros.

Lisp and Lisp macros solve these problems.

*   Lisp macros are written in Lisp. You have the full power of Lisp to write the macro.
*   Lisp has a very regular syntax.

Talk to anyone that's mastered C++ and ask them how long they spent learning all the template fudgery they need to do template metaprogramming. Or all the crazy tricks in (excellent) books like *Modern C++ Design*, which are still tough to debug and (in practice) non-portable between real-world compilers even though the language has been standardised for a decade. All of that melts away if the langauge you use for metaprogramming is the same language you use for programming!

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-11-06T10:27:52.123

lisp 宏将程序片段作为输入。这个程序片段表示一个数据结构，可以按照您喜欢的任何方式进行操作和转换。最后宏输出另一个程序片段，这个片段是在运行时执行的。

C# 没有宏工具，但是如果编译器将代码解析为 CodeDOM 树，并将其传递给一个方法，该方法将其转换为另一个 CodeDOM，然后将其编译为 IL，则相当于 C#。

这可用于实现“糖”语法，如`for each`-statement -clause `using`、linq -expressions`select`等，作为转换为底层代码的宏。

如果 Java 有宏，您可以在 Java 中实现 Linq 语法，而无需 Sun 更改基础语言。

以下是 C# 中用于实现的 lisp 样式宏的伪代码`using`：

```
define macro "using":
    using ($type $varname = $expression) $block
into:
    $type $varname;
    try {
       $varname = $expression;
       $block;
    } finally {
       $varname.Dispose();
    } 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2014-02-09T19:36:30.593

由于现有的答案提供了很好的具体示例来解释宏实现什么以及如何实现，也许它有助于收集一些关于为什么宏工具*相对于其他语言*具有显着优势的一些想法；首先来自这些答案，然后是来自其他地方的一个很好的答案：

> ...在 C 中，您必须编写一个自定义预处理器 [这可能有资格作为一个 [足够复杂的 C 程序](https://en.wikipedia.org/wiki/Greenspun%27s_tenth_rule)] ...

—[梵蒂冈](https://stackoverflow.com/a/268091/1234179)

> 与任何精通 C++ 的人交谈，并询问他们花了多长时间学习进行模板元编程所需的所有模板捏造（这仍然没有那么强大）。

—[马特·柯蒂斯](https://stackoverflow.com/a/268360/1234179)

> ...在Java中，您必须使用字节码编织来破解自己的方式，尽管像AspectJ这样的一些框架允许您使用不同的方法来做到这一点，但它基本上是一种破解。

—[米格尔·平](https://stackoverflow.com/a/268451/1234179)

> DOLIST 类似于 Perl 的 foreach 或 Python 的 for。作为 JSR-201 的一部分，Java 在 Java 1.5 中使用“增强的”for 循环添加了一种类似的循环结构。注意宏有什么不同。Lisp 程序员在他们的代码中注意到一个共同的模式，可以编写一个宏来为自己提供该模式的源代码级抽象。注意到相同模式的 Java 程序员必须让 Sun 相信这种特殊的抽象值得添加到语言中。然后 Sun 必须发布 JSR 并召集一个全行业的“专家组”来解决所有问题。根据 Sun 的说法，这个过程平均需要 18 个月。之后，编译器编写者都必须升级他们的编译器以支持新功能。甚至一旦 Java 程序员最喜欢的编译器支持新版本的 Java，在允许他们破坏与旧版本 Java 的源代码兼容性之前，他们可能“仍然”不能使用新功能。因此，Common Lisp 程序员可以在五分钟内自行解决的烦恼困扰了 Java 程序员多年。

— [Peter Seibel，在“实用的普通 Lisp”中](http://www.gigamonkeys.com/book/macros-standard-control-constructs.html)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-11-06T12:12:39.010

I'm not sure I can add some insight to everyone's (excellent) posts, but...

Lisp macros work great because of the Lisp syntax nature.

Lisp is an **extremely regular** language (think of everything is a **list**); macros enables you to treat data and code as the same (no string parsing or other hacks are needed to modify lisp expressions). You combine these two features and you have a very **clean** way to modify code.

**Edit:** What I was trying to say is that Lisp is [homoiconic](http://en.wikipedia.org/wiki/Homoiconic), which means that the data structure for a lisp program is written in lisp itself.

So, you end up with a way of creating your own code generator on top of the language using the language itself with all its power (eg. in Java you have to hack your way with bytecode weaving, although some frameworks like AspectJ allows you to do this using a different approach, it's fundamentally a hack).

In practice, with macros you end up building your own *mini-language* on top of lisp, without the need to learn additional languages or tooling, and with using the full power of the language itself.

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-11-06T14:31:30.603

Lisp 宏代表了一种几乎出现在任何大型编程项目中的模式。最终，在一个大型程序中，您有一段代码，您意识到编写一个将源代码输出为文本的程序会更简单，更不容易出错，然后您可以将其粘贴进去。

在 Python 中，对象有两个方法`__repr__`和`__str__`. `__str__`只是人类可读的表示。 `__repr__`返回一个表示是有效的 Python 代码，也就是说，可以作为有效 Python 输入解释器的东西。通过这种方式，您可以创建生成有效代码的 Python 小片段，这些代码可以粘贴到您的实际源代码中。

在 Lisp 中，这整个过程已经被宏系统形式化了。当然，它使您能够创建语法扩展并做各种花哨的事情，但上面总结了它的实际用处。当然，Lisp 宏系统允许您使用整个语言的全部功能来操作这些“片段”，这很有帮助。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-11-06T12:27:01.027

In short, macros are transformations of code. They allow to introduce many new syntax constructs. E.g., consider LINQ in C#. In lisp, there are similar language extensions that are implemented by macros (e.g., built-in loop construct, iterate). Macros significantly decrease code duplication. Macros allow embedding «little languages» (e.g., where in c#/java one would use xml to configure, in lisp the same thing can be achieved with macros). Macros may hide difficulties of using libraries usage.

E.g., in lisp you can write

```
(iter (for (id name) in-clsql-query "select id, name from users" on-database *users-database*)
      (format t "User with ID of ~A has name ~A.~%" id name)) 
```

and this hides all the database stuff (transactions, proper connection closing, fetching data, etc.) whereas in C# this requires creating SqlConnections, SqlCommands, adding SqlParameters to SqlCommands, looping on SqlDataReaders, properly closing them.

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2017-05-19T03:33:58.377

虽然以上都解释了宏是什么，甚至还有很酷的例子，但我认为宏和普通函数之间的主要区别在于 LISP 在调用函数之前首先评估所有参数。使用宏则相反，LISP 将未计算的参数传递给宏。例如，如果您将 (+ 1 2) 传递给函数，该函数将收到值 3。如果您将其传递给宏，它将收到 List(+ 1 2)。这可以用来做各种非常有用的事情。

*   添加新的控制结构，例如循环或列表的解构
*   测量执行传入函数所需的时间。对于函数，将在将控制权传递给函数之前评估参数。使用宏，您可以在秒表的开始和停止之间拼接代码。以下在宏和函数中具有完全相同的代码，并且输出非常不同。*注意：这是一个人为的示例，选择实现是为了更好地突出差异。*

    ```
    (defmacro working-timer (b) 
      (let (
            (start (get-universal-time))
            (result (eval b))) ;; not splicing here to keep stuff simple
        ((- (get-universal-time) start))))

    (defun my-broken-timer (b)
      (let (
            (start (get-universal-time))
            (result (eval b)))    ;; doesn't even need eval
        ((- (get-universal-time) start))))

    (working-timer (sleep 10)) => 10

    (broken-timer (sleep 10)) => 0 
    ```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-04-02T16:49:18.667

我从 The common lisp cookbook 中得到了这个，但我认为它解释了为什么 lisp 宏很好用。

“宏是一段普通的 Lisp 代码，它对另一段假定的 Lisp 代码进行操作，将其转换为（更接近于）可执行 Lisp 的版本。这听起来可能有点复杂，所以让我们举一个简单的例子。假设你想要一个setq 的版本，它将两个变量设置为相同的值。所以如果你写

```
(setq2 x y (+ z 3)) 
```

当`z=8`x 和 y 都设置为 11 时。（我想不出这有什么用，但这只是一个例子。）

很明显，我们不能将 setq2 定义为函数。如果`x=50`和`y=-5`，此函数将接收值 50、-5 和 11；它不知道应该设置哪些变量。我们真正想说的是，当您（Lisp 系统）看到`(setq2 v1 v2 e)`时，将其视为等同于`(progn (setq v1 e) (setq v2 e))`. 实际上，这并不完全正确，但现在可以了。宏允许我们通过指定将输入模式`(setq2 v1 v2 e)`“转换为输出模式”的程序来精确地做到这一点`(progn ...)`。

如果您认为这很好，您可以继续阅读这里： [http ://cl-cookbook.sourceforge.net/macros.html](http://cl-cookbook.sourceforge.net/macros.html)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-01-01T22:28:51.250

*单线答案：*

*最小语法 => 宏优于表达式 => 简洁 => 抽象 => 强大*

* * *

Lisp 宏无非就是以编程方式编写代码。也就是说，在扩展宏之后，你得到的只是没有宏的 Lisp 代码。因此，*原则上*，他们没有取得任何新成果。

但是，它们与其他编程语言中的宏的不同之处在于它们在表达式级别编写代码，而其他宏在字符串级别编写代码。由于括号，这是 lisp 独有的；或者更准确地说，是它们的[最小语法](http://blog.rongarret.info/2015/05/why-lisp.html)，这要归功于它们的括号。

正如该线程中的许多示例以及 Paul Graham 的*On Lisp*所示，lisp 宏可以成为使您的代码更加简洁的工具。当简洁达到一定程度时，它提供了新的抽象级别，使代码更加简洁。再次回到第一点，*原则上*它们不提供任何新东西，但这就像说因为纸和铅笔（几乎）形成了图灵机，我们不需要实际的计算机。

如果有人知道一些数学，想想为什么函子和自然变换是有用的想法。*原则上*，他们不提供任何新东西。但是，通过将它们扩展到较低级别的数学，您会发现一些简单的想法（就范畴论而言）的组合可能需要 10 页才能写下来。你更倾向哪个？

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2011-01-07T17:02:44.060

在 python 中，你有装饰器，你基本上有一个函数，它接受另一个函数作为输入。你可以做任何你想做的事情：调用函数，做其他事情，将函数调用包装在资源获取释放中，等等，但你不能窥视该函数的内部。假设我们想让它更强大，假设你的装饰器将函数的代码作为列表接收，那么你不仅可以按原样执行函数，而且现在可以执行它的一部分，重新​​排序函数的行等。

# asp.net - 身份验证问题或错误

> ID：267868
> 
> 赞同：1
> 
> 时间：2008-11-06T07:37:21.547
> 
> 标签：asp.net, authentication, asp-classic

有 3 个网络应用程序。

站点 A 和 B 都是具有 FormsAuthentications 配置的 ASP.NET Web 应用程序，并且站点 B 中有一个受保护的文件夹，该文件夹也在 web.config 中正确配置。站点 C 是一个经典的 ASP 网站，它通过 Session 保持身份验证状态。

现在请考虑以下步骤：

1、站点A的页面上有一个target="_blank"属性的链接，链接到站点B的受保护文件夹；

2、点击此链接，您应该在新的浏览器窗口中打开站点B并重定向到登录页面；

3、用你的凭据登录，然后正常重定向到受保护的页面，现在你当然可以浏览站点B的那个页面了；

4、现在关闭显示站点B受保护页面的浏览器窗口，您可以点击浏览器的关闭按钮或按Alt+F4；

5、然后再次点击站点A上的链接，此时无需重新登录即可访问站点B的受保护页面。

6、站点A的一个页面上还有一个target="_blank"的链接，链接到站点C的受保护页面，站点C是一个ASP站点；

7、首先打开站点C的受保护页面，正确登录；

8、登录站点C当然可以查看受保护的页面，然后关闭浏览器；

9、再次点击C站链接，可以发现自己已经在C站认证了。

哎呀。已经有10个步骤了，我觉得这些很无聊，但它们真的让我困惑了几天。

有人知道这个问题吗？十分感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T08:21:23.813

ASP 和 ASP.NET 都使用存储在浏览器进程内存中的会话 cookie。从链接打开新的浏览器窗口不会启动新进程，只会打开与原始窗口相同的进程所拥有的新窗口。

关闭窗口不会“注销”会话，因为会话 cookie 仍将在进程内存中，当另一个窗口访问该站点时，现有会话 cookie 将被发送，因此从站点的角度来看，这仍然是相同的会话这是正确的推断。

**编辑**：这个问题是在评论中提出的，“如何避免这种情况”。最好的答案是：不要避免它，将其作为正常操作吸收，并为自己省去一大堆麻烦。

您要求的是一种检测当前没有窗口显示特定应用程序内容的方法。这真的很难实现。即使您在应用程序上只有一个窗口（不能保证），您也必须确保所有页面都捕获窗口上的 onunload 事件，并通知服务器应用程序正在注销。

如果用户能够注销应用程序至关重要，那么最好通过在每个页面上的某个常见标题中提供一个注销链接来实现，就像您现在正在查看的这个页面一样。

通常，通过在会话对象中存储某种令牌，将 ASP 中的会话标记为“已登录”。构成该应用程序一部分的页面将检查该令牌，如果不存在则重定向到登录页面。

注销会话值被删除，客户端重定向到登录页面。

在 ASP.NET FormsAuthentication 中有 SignOut 和 RedirectToLoginPage 方法，Forms Authentication 会自动处理重定向到登录页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-22T15:43:45.757

例如，在 window.close 事件上使用 session.abandoned。

创建将在标题中加载的函数并捕获事件 window.close。不要忘记验证上一页是否来自同一个域/IP。因为您的用户可能忘记注销并转到其他网站，然后单击返回按钮...

# tomcat - 配置 Tomcat 以使用 Windows Active Directory 进行身份验证

> ID：267869
> 
> 赞同：34
> 
> 时间：2008-11-06T07:37:26.040
> 
> 标签：tomcat, ldap

配置 Tomcat 5.5 或更高版本以对来自 Windows Active Directory 的用户进行身份验证的最佳方法是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-06T08:03:10.637

**来自[www.jspwiki.org](http://www.jspwiki.org)**

请参阅：[ActiveDirectoryIntegration](https://web.archive.org/web/20130526124801/http://www.jspwiki.org/wiki/ActiveDirectoryIntegration)

使用您的 ldap-settings 在 server.xml 中尝试此操作：

```
<Realm className="org.apache.catalina.realm.JNDIRealm" debug="99"
    connectionURL="ldap://youradsserver:389"
    alternateURL="ldap://youradsserver:389"         
    userRoleName="member"
    userBase="cn=Users,dc=yourdomain"
    userPattern="cn={0},cn=Users,dc=yourdomain"
    roleBase="cn=Users,dc=yourdomain"
    roleName="cn"
    roleSearch="(member={0})"
    roleSubtree="false"
    userSubtree="true"/> 
```

并在你的应用程序的tomcat-users.xml和web.xml中定义角色

编辑`webapp_root/WEB_INF/Web.xml`文件如下：

```
<security-constraint>
   <display-name>your web app display name</display-name>
   <web-resource-collection>
     <web-resource-name>Protected Area</web-resource-name>
     <url-pattern>*.jsp</url-pattern>
     <url-pattern>*.html</url-pattern>
     <url-pattern>*.xml</url-pattern>
   </web-resource-collection>
   <auth-constraint>
     <role-name>yourrolname(ADS Group)</role-name>
   </auth-constraint>
 </security-constraint>
 <login-config>
   <auth-method>FORM</auth-method>
   <form-login-config>
     <form-login-page>/login.jsp</form-login-page>
     <form-error-page>/error.jsp</form-error-page>
   </form-login-config>
 </login-config>
 <security-role>
   <description>your role description</description>
   <role-name>yourrolename(i.e ADS group)</role-name>
 </security-role> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-05-02T18:25:00.773

Blauhr 的回答很好，但是`CN`用户的身份`AD`是基于他们的“显示名称”，而不是他们的`saMAccountName`（用户习惯于登录）。根据他的解决方案，看起来有人必须使用他们的显示名称登录，基于`userPattern`.

我个人使用过以下内容：

```
<Realm className="org.apache.catalina.realm.JNDIRealm" debug="99"
    connectionURL="ldap://DOMAIN_CONTROLLER:389"
    connectionName="USERID@DOMAIN.com"
    connectionPassword="USER_PASSWORD"
    referrals="follow"
    userBase="OU=USER_GROUP,DC=DOMAIN,DC=com"
    userSearch="(sAMAccountName={0})"
    userSubtree="true"
    roleBase="OU=GROUPS_GROUP,DC=DOMAIN,DC=com"
    roleName="name"
    roleSubtree="true"
    roleSearch="(member={0})"/> 
```

其他一切几乎都一样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-14T09:08:08.770

基于 LDAP 的身份验证无需任何额外步骤即可在任何操作系统上运行。

[http://spnego.sf.net](http://spnego.sf.net)可用于对登录到 Windows 域的用户进行静默身份验证。这需要在域中注册的域帐户对所提供的服务具有权威性。它适用于 Windows 和 Linux。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-19T10:39:05.950

“欢迎来到 SPNEGO SourceForge 项目 Integrated Windows Authentication in Java

该项目的目的是提供一个替代库（.jar 文件），应用程序服务器（如 Tomcat）可以将其用作验证客户端（如 Web 浏览器）的方法。

如果您的组织正在运行 Active Directory (AD)，并且您的所有 Web 应用程序都通过 Microsoft 的 Internet 信息服务 (IIS)，并且 IIS 启用了集成 Windows 身份验证，并且您组织中的每个人都在使用 Internet Explorer (IE)，那么这个项目**可能**对你没有任何兴趣。”

# asp.net - ASP.NET CompareValidator 问题

> ID：267872
> 
> 赞同：18
> 
> 时间：2008-11-06T07:39:20.700
> 
> 标签：asp.net, validation, .net-2.0, webforms

我有一个带有密码和确认密码文本框的网络表单。我有一个 RegularExpressionValidator 附加到第一个和 CompareValidator 到第二个。现在的问题是，当我在密码字段中有内容而在确认密码字段中没有任何内容时，它不会显示字段不匹配的错误。一旦我在“确认密码”字段中输入内容，它就会显示错误。我还想允许将两个字段都留空。

我正在使用 .NET 2.0

可能是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-06T07:59:31.800

FWIW，如果您将密码框设置为 ControlToValidate，并将确认密码框设置为 ControlToCompare，那么它将起作用，因为密码框将包含某些内容，因此将运行验证。

当然，这可以让他们提交带有空密码框和已填写确认框的表单，因此在两者上都设置必需的验证器可能是一个更好的主意。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-26T22:39:08.257

我有同样的问题。使用 CustomValidator 而不是 CompareValidator。（CustomValidator 有一个名为 ValidateEmptyText 的有用属性，CompareValidator 缺少该属性，至少在 ASP.NET 2.0 中是这样。）

您将需要编写适当的 ServerValidate 函数以及 ClientValidationFunction。javascript函数的函数签名与ServerValidate函数基本相同：source（对象），args（ServerValidateEventArgs）。

最棘手的部分是您需要编写自定义代码来访问“CompareTo”文本框，因为这不是 CustomValidator 的一部分。我的字段在 FormView 中；您可能需要调整代码以适应您的特定情况。在下面的代码中，“fv”是该 FormView 的名称。

客户端验证：

```
<script type="text/javascript">
<!--
  function cvPasswordRpt_Validate(source, args)
  {
    args.IsValid = (args.Value ==
                    document.getElementsByName("fv$tbPassword").item(0).value);
  }
//-->
</script> 
```

ASPX 代码：

```
<label>New Password:</label>
<asp:TextBox ID="tbPassword" runat="server" CssClass="stdTextField" 
             TextMode="Password" ValidationGroup="edit" />
<br />
<label>Repeat New Password:</label>
<asp:TextBox ID="tbPasswordRpt" runat="server" CssClass="stdTextField"
             TextMode="Password" ValidationGroup="edit" />
<asp:CustomValidator ID="cvPasswordRpt" runat="server" Display="Dynamic"
             EnableClientScript="true" ValidationGroup="edit"
             ControlToValidate="tbPasswordRpt" ValidateEmptyText="true"
             ErrorMessage="Your passwords do not match."
             ClientValidationFunction="cvPasswordRpt_Validate"
             OnServerValidate="cvPasswordRpt_ServerValidate" /> 
```

服务器端验证（VB.NET）：

```
Protected Sub cvPasswordRpt_ServerValidate(ByVal sender As Object, 
                                           ByVal e As ServerValidateEventArgs)
  Dim _newPassword As String = DirectCast(fv.FindControl("tbPassword"), 
                                          TextBox).Text
  e.IsValid = e.Value.Equals(_newPassword)
End Sub 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-06T07:45:12.093

您还需要使用RequiredFieldValidator。如果字段为空并且需要以这种方式与RequiredFieldValidator配对，则许多验证控件将通过。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T16:13:09.607

这个怎么样？

两个文本框字段 - txtEmail1（用于电子邮件地址）和 txtEmail2（用于确认）。

将 RegularExpressionValidator 附加到 txtEmail1 ——当为空白时，它不会触发。填充后，您的数据将得到验证。

将 CompareValidator 附加到 txtEmail1，将其数据与 txtEmail2 进行比较。然后，将 CompareValidator 附加到 txtEmail2，将其数据与 txtEmail1 进行比较。

*   当两个字段都为空时，三个验证器都不会触发。
*   填充 txtEmail1 时，它必须匹配正则表达式，并且它必须匹配 txtEmail2
*   填充 txtEmail2 时，它必须匹配 txtEmail1

这符合您的要求，即字段可以留空，但如果任一字段有数据，则会触发验证逻辑。

——乔

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T08:15:31.440

CompareValidator、RegularExpressionValidator 和 RangeValidator 验证控件正在处理非空字符串值。这对于我们有一个非必填字段需要在输入时满足某些条件的情况很有用。

例如，我们有一个包含两个字段的表单：必须输入的主电子邮件；以及不需要但输入时必须验证的替代电子邮件。为了验证这一点，我们将RequiredFieldValidator 和RegularExpressionValidator 添加到主电子邮件，并且只将RegularExpressionValidator 添加到第二个字段。

如果在空输入上触发了 RegularExpressionValidator，那么验证上述表单会很棘手，我们必须在第二个中更改正则表达式以允许空值，这非常难做和维护，而且不是那么明显的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-16T11:48:43.270

我遇到了同样的问题并尝试了 patmortech 的答案，该答案有效，但导致比较验证器在用户输入确认文本框（使用客户端验证时）之前显示，因此不太完美。

相反，我敲了一个自定义验证器，它只在密码框中输入了某些内容时才进行比较。下面的代码以防万一其他人在研究同一问题时遇到此问题。根据您的要求，在密码框上使用此验证器，带或不带必填字段验证器。

```
public class CompareIfRequiredPasswordValidator : BaseValidator
{
    private const string SCRIPTBLOCK = "UNIQUE1";

    private string controlToCompare;

    [Browsable(true)]
    [Category("Behavior")]
    [DefaultValue("")]
    [IDReferenceProperty]
    public string ControlToCompare
    {
        get { return controlToCompare; }
        set { controlToCompare = value; }
    }

    /// <summary>
    /// Server side validation function
    /// </summary>
    /// <returns></returns>
    protected override bool EvaluateIsValid()
    {
        TextBox txCompare = (TextBox)FindControl(ControlToValidate);
        TextBox txPassword = (TextBox)FindControl(ControlToCompare);
        if (txPassword.Text.Length == 0)
        {
            //No password entered so don't compare
            return true;
        }
        else
        {
            if (txCompare.Text == txPassword.Text)
            {
                return true;
            }
            else
            {
                return false;
            }
        }
    }

    protected override void OnPreRender(EventArgs e)
    {
        base.OnPreRender(e);
        if (EnableClientScript) { this.ClientScript(); }

    }

    //Add the custom attribute here
    protected override void AddAttributesToRender(HtmlTextWriter writer)
    {
        base.AddAttributesToRender(writer);
        if (this.RenderUplevel)
        {
            Page.ClientScript.RegisterExpandoAttribute(this.ClientID, "controltocompare", base.GetControlRenderID(ControlToCompare));
        }
    }

    //Generate and register the script for client side validation
    private void ClientScript()
    {
        StringBuilder sb_Script = new StringBuilder();
        sb_Script.Append("<script language=\"javascript\">");
        sb_Script.Append("\r");
        sb_Script.Append("function pw_verify(sender) {");
        sb_Script.Append("\r");
        sb_Script.Append("var txCompare = document.getElementById(document.getElementById(sender.id).controltovalidate);");
        sb_Script.Append("\r");
        sb_Script.Append("var txPassword = document.getElementById(document.getElementById(sender.id).controltocompare);");
        sb_Script.Append("\r");
        sb_Script.Append("if (txPassword.value == '')");
        sb_Script.Append("\r");
        sb_Script.Append("{");
        sb_Script.Append("\r");
        sb_Script.Append("return true;");
        sb_Script.Append("\r");
        sb_Script.Append("}");
        sb_Script.Append("\r");
        sb_Script.Append("else");
        sb_Script.Append("\r");
        sb_Script.Append("{");
        sb_Script.Append("\r");
        sb_Script.Append("if (txCompare.value == txPassword.value)");
        sb_Script.Append("\r");
        sb_Script.Append("{");
        sb_Script.Append("\r");
        sb_Script.Append("return true;");
        sb_Script.Append("\r");
        sb_Script.Append("}");
        sb_Script.Append("\r");
        sb_Script.Append("else");
        sb_Script.Append("\r");
        sb_Script.Append("{");
        sb_Script.Append("\r");
        sb_Script.Append("return false;");
        sb_Script.Append("\r");
        sb_Script.Append("}");
        sb_Script.Append("\r");
        sb_Script.Append("}");
        sb_Script.Append("\r");
        sb_Script.Append("}");
        sb_Script.Append("\r");
        sb_Script.Append("</script>");
        Page.ClientScript.RegisterClientScriptBlock(GetType(), SCRIPTBLOCK, sb_Script.ToString());
        Page.ClientScript.RegisterExpandoAttribute(ClientID, "evaluationfunction", "pw_verify");
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-16T15:06:59.463

我试图这样做：（由 patmortech 提供，非常感谢！）

> FWIW，如果您将密码框设置为 ControlToValidate，并将确认密码框设置为 ControlToCompare，那么它将起作用，因为密码框将包含某些内容，因此将运行验证。
> 
> 当然，这可以让他们提交带有空密码框和已填写确认框的表单，因此在两者上都设置必需的验证器可能是一个更好的主意。

为了避免留下空密码和填写确认框，我只是在密码框上放置了另一个比较验证器，并交换了 ControlToValidate 和 ControlToCompare 值。

# php - 如何在 PHP 中实现分页？

> ID：267892
> 
> 赞同：6
> 
> 时间：2008-11-06T07:55:11.340
> 
> 标签：php, pagination, resultset

PHP中通常如何实现分页结果？

我想要一个包含 10 个结果的结果页面。在导航中向前翻页会给我下一组和上一组。

有没有办法做到这一点？有人对入门有简单的建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T08:02:12.887

您需要对 PHP 有一定的了解，并且可能需要对关系数据库有所了解。

分页通常使用一些简单的查询参数来实现。

```
stackoverflow.com/myResults.php?page=1 
```

页面增加查询参数：

```
stackoverflow.com/myResults.php?page=2 
```

在后端，页面值通常对应于查询中用于生成结果的限制和偏移量。

**相关问题**：

*   [**没有 SQL 的 PHP 动态分页**](https://stackoverflow.com/questions/207223/php-dynamic-pagination-without-sql)
*   [**SQL Server 2005 中不同列的分页查询排序**](https://stackoverflow.com/questions/230058/paginated-query-using-sorting-on-different-columns-using-rownumber-over-in-sql)
*   [**智能分页算法**](https://stackoverflow.com/questions/163809/smart-pagination-algorithm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T09:04:49.187

It may be worth looking at the Zend Framework's Zend_Paginator object. It encapsulates a lot of the logic of generating next/previous/first/last type links.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T09:09:24.903

The [TinyButStrong](http://www.tinybutstrong.com) template system comes with a pagination extension. Very easy to use.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T02:07:16.220

对于服务器端分页，我使用 PEAR 的 Pager 包 ( [http://pear.php.net/package/Pager](http://pear.php.net/package/Pager) )。

查看 example.php 的基本用法，以及 Page_Wrapper.php（我从 Pager_Wrapper_DB 开始）。

最终用户文档非常全面： http: [//pear.php.net/manual/en/package.html.pager.intro.php](http://pear.php.net/manual/en/package.html.pager.intro.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T08:00:44.493

您所指的术语是“分页”。不幸的是，您必须提供更多信息才能获得更具体的答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T08:01:53.743

您要查找的内容称为[pagination](https://stackoverflow.com/search?q=pagination)。关于这个主题有几个关于 SO 的问题。由于您的问题非常广泛，请提供更多详细信息或参考已针对此主题提出的问题。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-11-06T09:48:22.937

如果数据库不是那么大 - 我在客户端实现分页。我推荐 jquery 插件 tablefilter - 它不仅为您提供分页，还为您提供过滤和排序。您可以轻松浏览给定的记录集。如果性能不是很重要，这是一个很好的解决方案。有页面： [http://ideamill.synaptrixgroup](http://ideamill.synaptrixgroup)。和 830 条记录的演示：http: [//ideamill.synaptrixgroup.com/jquery/tablefilter/largetabletest.htm](http://ideamill.synaptrixgroup.com/jquery/tablefilter/largetabletest.htm)

# debugging - 有没有办法自定义 Firebug 的键盘快捷键？

> ID：267893
> 
> 赞同：12
> 
> 时间：2008-11-06T07:56:12.367
> 
> 标签：debugging, firefox, keyboard-shortcuts, firebug

有没有办法自定义 Firebug 的键盘快捷键？我喜欢能够使用 Firebug 的*Script*面板单步执行 JavaScript 代码，但看起来我仅限于使用默认键盘快捷键来单步执行/进入/退出代码或使用鼠标单击相应的按钮。

我错过了什么吗？

**Firefox/Firebug 中的config** hack是否有一些秘密可以帮助我？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-01-14T02:44:55.323

您可以手动更改它们。转到此目录：

在最近的版本中，扩展名包含在一个扩展名为 XPI 的文件中。只需将其重命名为 ZIP，创建一个目录并将其内容提取到其中。

Linux：

```
.mozilla/firefox/*****.default/extensions/firebug@software.joehewitt.com/ 
```

视窗：

```
%APPDATA%\Mozilla\Firefox\Profiles\<profile>\extensions\firebug@software.joehewitt.com\ 
```

然后修改这个文件（这些是我的重映射设置）：

**内容/firebug/debugger/script/scriptPanel.js** (Firebug 2.0)

```
 this.keyListeners =
    [
        chrome.keyCodeListen("F5", Events.isShift, Obj.bind(this.rerun, this, context), true),
        chrome.keyCodeListen("F5", null, Obj.bind(this.resume, this, context), true),
        chrome.keyCodeListen("F6", null, Obj.bind(this.stepOver, this, context), true),
        chrome.keyCodeListen("F7", null, Obj.bind(this.stepInto, this, context)),
        chrome.keyCodeListen("F8", null, Obj.bind(this.stepOut, this, context))
    ]; 
```

**content/firebug/js/scriptPanel.js**（Firebug 2.0 之前）

```
 this.keyListeners =
    [
        chrome.keyCodeListen("F5", null, Obj.bind(this.resume, this, context), true),
        chrome.keyListen("/", Events.isControl, Obj.bind(this.resume, this, context)),
        chrome.keyCodeListen("F6", null, Obj.bind(this.stepOver, this, context), true),
        chrome.keyListen("'", Events.isControl, Obj.bind(this.stepOver, this, context)),
        chrome.keyCodeListen("F7", null, Obj.bind(this.stepInto, this, context)),
        chrome.keyListen(";", Events.isControl, Obj.bind(this.stepInto, this, context)),
        chrome.keyCodeListen("F8", null, Obj.bind(this.stepOut, this, context)),
        chrome.keyListen(",", Events.isControlShift, Obj.bind(this.stepOut, this, context))
    ]; 
```

在 2.0 之前的版本中，您还应该更改本地化文件，因此工具提示应该是正确的键：

**语言环境/en-US/firebug.properties**

```
firebug.Continue=Continue (F5)
firebug.StepOver=Step Over (F6)
firebug.StepInto=Step Into (F7)
firebug.StepOut=Step Out (F8) 
```

仅此而已。不幸的是，每次更新 Firebug 时都必须这样做。虽然已经有一个[请求允许他们直接在 Firebug 中进行自定义](https://github.com/firebug/firebug/issues/2665)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T08:02:58.733

如他们的[讨论论坛](https://groups.google.com/forum/#!topic/firebug/tgDCmsg89yE)所述，您可以尝试[keyconfig](http://forums.mozillazine.org/viewtopic.php?t=72994) ...否则，这是一个[已知的错误/限制](https://github.com/firebug/firebug/issues/2665)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-11T13:02:48.827

正如@VonC 提到的，对此有一张公开票。根据我的经验，keyconfig 不适用于此目的。我确实[编写了一个补丁](http://blog.kaeding.name/articles/2008/12/11/customize-firebug-shortcut-keys)，允许在 about:config 中自定义调试器执行控制键。如果您不想等待它被上游接受，和/或您不想自己构建它，我还发布了一个带有此修复的 XPI。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-13T10:15:05.587

另一种选择是在文件中手动配置快捷方式

```
%APPDATA%\Mozilla\Firefox\Profiles\<profile>\extensions\firebug@software.joehewitt.com\content\firebug\browserOverlay.xul 
```

例如，我通过注释相应部分删除了 F12 上的快捷方式，因为它与Tab Mix Plus的*Undo Closed Tab快捷方式冲突。*

缺点：Firebug 的更新会覆盖修改后的配置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-18T07:52:20.697

虽然可以[在 Firebug 的源代码中更改快捷方式](https://github.com/firebug/firebug/blob/master/extension/content/firebug/debugger/script/scriptPanel.js#L1552-L1556)，但还有一种方法可以为这些操作添加不同的键，而无需触及源代码。

为此，您必须安装一个扩展程序，它允许您定义自定义快捷方式，例如[Dorando keyconfig](https://addons.mozilla.org/firefox/addon/dorando-keyconfig/)。

**为该扩展执行的步骤：**

1.  转到附加组件管理器。
2.  单击扩展旁边的*选项按钮以打开自定义对话框。*
3.  单击*添加新密钥*按钮以打开密钥编辑器。
4.  给快捷方式一个合适的名字
5.  [将与操作 * 相关](https://github.com/firebug/firebug/blob/master/extension/content/firebug/firefox/firebugMenuOverlay.xul)的代码粘贴到代码字段中。
6.  点击*确定*
7.  单击进入快捷方式字段
8.  通过按键盘上的键添加自定义快捷方式
9.  单击*应用*按钮

**澄清截图：**

[![Dorando keyconfig 键自定义对话框](https://i.stack.imgur.com/IamfI.png)](https://i.stack.imgur.com/IamfI.png) [![Dorando keyconfig 密钥编辑器](https://i.stack.imgur.com/strS2.png)](https://i.stack.imgur.com/strS2.png)

* 那就是`oncommand`属性的值。因此，如果要添加恢复 JavaScript 执行的快捷方式，则需要`Firebug.Debugger.resume(Firebug.currentContext)`从`cmd_firebug_resumeExecution`命令中复制。

# fogbugz - fogbugz 中同步项目的发货日期

> ID：267903
> 
> 赞同：0
> 
> 时间：2008-11-06T08:02:23.680
> 
> 标签：fogbugz

我目前正在做两个项目，我正在使用 Fogbugz 来跟踪我的案例。我的问题是：如果我为每个项目输入一个月的估计工作量，Fogbugz 会估计这两个项目的发货日期是两个月后吗？

注意：这里有一个讨论[，](http://support.fogcreek.com/default.asp?fogbugz.4.23133.11)但我不知道它是否仍然相关。我什至不确定我是否理解正确呵呵。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-07T04:42:42.273

我决定将我的两个项目合并为一个。然后我为每个项目创建了一个区域。所以在我有两个项目之前，

*   项目A
*   项目 B

我现在有一个项目有两个领域，

*   项目：公司
    *   区域 1：项目 A
    *   区域 2：项目 B

这个项目的发货日期比项目合并前的原始发货日期晚了大约两周。我想这证实了 FogBugz 在计算项目的发货日期时忽略了在其他项目上花费的任何时间。

我可以解决这种情况的另一种方法是保留这两个项目，但将工作计划中的“花费在 FogBugz 任务上的时间百分比”更改为 50%。

# c++ - 污染全局命名空间

> ID：267908
> 
> 赞同：2
> 
> 时间：2008-11-06T08:03:54.833
> 
> 标签：c++, namespaces, typedef

我认为这里的大多数 C++ 程序员都会同意污染全局命名空间是一个坏主意，但是有时可以忽略此规则吗？

例如，我有一个需要在整个特定应用程序中使用的类型 - 我应该这样定义它：

```
mytypes.h

typedef int MY_TYPE;

foo.cpp

MY_TYPE myType; 
```

或者使用命名空间：

```
mytypes.h

namespace ns {
typedef int MY_TYPE;
}

foo.cpp

ns::MY_TYPE myType;
...
using namespace ns;
MY_TYPE myType; 
```

你喜欢哪个？有时可以接受使用第一种方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T08:12:36.267

您可以在单独的命名空间中定义您的类型，并使用

```
using ns::MY_TYPE; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T08:09:51.670

我使用命名空间将库代码与特定于应用程序的代码分开，并在一个大项目中对构成项目的各种模块进行分区。

因此，全局命名空间对于跨应用程序中的多个模块使用的特定于应用程序的类型和函数很有用。

因此，如果您`MY_TYPE`在整个应用程序中使用，请将其放在全局命名空间中，否则将其放在命名命名空间中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T13:53:34.703

图书馆不得，应用程序可以。

当多人处理一个应用程序时，当然需要明确的规则，最明确的规则是“不要”。然而，这并不是在所有情况下都是理想的。

“使用”语句应该只在 CPP 文件之上，而不是在头文件中——但这会使编写模板变得复杂，因为——对于不久的将来的大多数编译器——它们需要驻留在头文件中。

以我的经验（大多数是小型团队，拥有一个大型但分区良好的项目），只要您控制相应的代码并坚持使用描述性名称，命名空间污染就不是什么大问题。我记得的案件很少，而且很容易处理。但是，第三方库存在重大问题 - 即使有可用的源代码。

YMMV 拥有庞大的团队或大型项目，只需一次编译。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T08:12:08.560

我根本不同意使用全局命名空间（`main`当然，除了 ）。对于在整个应用程序中使用的东西，您可以简单地`using namespace`在文件顶部使用`.cpp`，在所有相关`#include`行之后。

# html - 你会认为 HTML + CSS + Webserver 是 MVC 吗？

> ID：267920
> 
> 赞同：1
> 
> 时间：2008-11-06T08:14:27.947
> 
> 标签：html, css, model-view-controller

简而言之，MVC 是将内容（模型）与表示（视图）分离的模式，并有一个机制（控制器）来定义如何收集两者。

如果您已经看到我的目标，我很想听听您对此事的看法。当然，MVC 适用于服务器端机制和所有内容，但请与我一起跳出框框思考一下。

网络的“访问者”，无论是人类还是机器人/谷歌，都可能会看到 HTML 及其附带的内容。多年来，编写结构化和有意义的 HTML 以及使用 CSS 将其与表示分离变得越来越重要，而 HTML5 等未来技术只会通过提供更以内容为中心的元素集和使用机制来促进这种分离。纯粹的视觉表现。

考虑到这一切，我想知道在某种程度上说 MVC 范式也适用于前端是否正确，其中：

*   该模型将是 HTML，就像它已成为的纯 httpwise 内容一样
*   视图是 CSS；它使您的内容以某种方式呈现
*   控制器是网络服务器和所有位于其下的东西，它收集和分离模型和视图，并执行所有决策

说得通？不是？

VonC 向我指出了一篇文章，该文章确实改变了我对控制器部分的看法。浏览器也占据了控制器的主要部分，因为它处理大量的用户交互以及模型和视图如何协同工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T10:27:29.987

如果你足够努力，你通常可以在任何东西中找到 MVC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T08:17:31.717

我会同意，尽管有人可以争论控制器。

[Jeff在他的帖子中](http://www.codinghorror.com/blog/archives/001112.html)说明了这一点，[ZenGarden](http://www.csszengarden.com/)

和：

*   模型 = HTML
*   视图 = CSS
*   控制器 = 浏览器（比网络服务器更“前端”）

实际上，这是从**客户端**的有效视角。

从**服务器端**（比简单的 html 页面服务器更复杂的服务器）来看，MVC 会有所不同。

以[ASP.Net 为例](http://www.asp.net/learn/mvc/tutorial-02-vb.aspx)；

*   模型 = 不包含在视图或控制器中的所有应用程序逻辑。该模型应该包含您所有的应用程序业务逻辑和数据库访问逻辑。例如，如果您使用 LINQ to SQL 访问您的数据库，那么您将在 Models 文件夹中创建您的 LINQ to SQL 类（您的 dbml 文件）
*   视图 = 发送到浏览器的 HTML 标记和内容，以及脚本
*   Controller = 负责控制用户与 MVC 应用程序交互的方式。当用户发出浏览器请求时，控制器确定向用户发送回什么响应。控制器只是一个类（例如，Visual Basic 或 C# 类）。

那是 MVC 的服务端视角

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T08:41:17.050

不，有点...

您的 HTML 也在您的表示层（视图），尽管您的 CSS 应该包含表示细节，如字体、颜色等。

您的模型必须包含您的数据 + 业务逻辑，我真的不希望您将这些存储在 HTML 中——这是用于真正的编程语言、存储过程和要处理的 DBMS。这些应该在服务器端。

但是按照您的思路，我建议：

*   模型：服务器端程序+DBMS
*   视图：HTML+CSS
*   控制器：网络服务器

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T08:51:45.517

我明白你的意思，但我认为我会将 HTML-CSS-Server/Browser 描述为 Document-Viewer 而不是 MVC。如果所有内容都是静态的，那么它是模型的表达，是的，但是模型嵌入在标记中。尽管我可以用 CSS 覆盖它，但 CSS 实际上只是 HTML 中描述的底层表示的过滤器。HTML 描述了数据的视图以及数据本身。也就是说，我可以关闭 CSS 并且仍然可以查看数据。在 MVC 中，这是不可能的。

您的 HTML 和 CSS 之间也存在紧密耦合——两者都需要非常了解对方。这违反了 MVC 的关键范例，其中组件松散耦合。特别是视图对模型没有任何约束（除了数据可见的限制）。HTML 设计者被限制在 CSS 域内操作或修改 CSS 以使其适用于 HTML 域。

此外，HTML 无法对数据进行操作以进行持久更改。该模型的一个关键方面是执行业务规则的能力。HTML 不会对静态内容执行此操作——Web 设计人员通过选择 HTML 编码来执行此操作。

这不会使它变坏或无用。并非所有东西都必须是 MVC。MVC 仅描述了一种组织数据和代码的特定方式。它在解耦架构和可测试性方面具有一些特殊优势，但这并不意味着它是唯一可用的有效架构模式。

在我看来，静态 HTML 内容不是 MVC，也不需要是。

**[编辑] 我并不是说您不能在浏览器设计中使用 MVC，或者 MVC 不适用于在浏览器中显示静态内容。我真的是从内容提供者的角度来看待这个问题，而不是浏览器程序员。MVC 可能是浏览器设计的完美逻辑选择。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T08:40:22.403

CSS 绝对不是视图。相反，浏览器的渲染（将 HTML/DOM 和 CSS 输入结合到 2d 布局中）是视图。HTML/DOM 是模型。控制器一半内置在浏览器 UI 中，但可以使用 javascript 进行扩展。

确实，在讨论内容/表示分离时，CSS 被认为是*表示层——但这是一个不同的（正交）模型。*

在 MVC 中，CSS 与 HTML/DOM 一起是模型的一部分，因为它是可以在不同视图中呈现的底层数据。例如，打印布局是基于相同模型的单独视图。

# sql-server - SQL Server 服务器中的正则表达式？

> ID：267921
> 
> 赞同：18
> 
> 时间：2008-11-06T08:15:03.967
> 
> 标签：sql-server, regex, sql-server-2005, sql-server-2008, sql-server-2000

是否可以使用完整的正则表达式功能集进行高效查询。

如果不是微软真的应该考虑这个功能。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-06T08:25:31.450

对于 SQL Server 2000（和任何其他 32 位版本的 SQL Server），有[xp_pcre](http://www.codeproject.com/KB/database/xp_pcre.aspx)，它将与 Perl 兼容的正则表达式作为一组扩展存储过程引入。我用过，效果很好。

较新的版本使您可以直接访问[.NET 集成的正则表达式](http://msdn.microsoft.com/en-us/magazine/cc163473.aspx)（此链接似乎已失效，这是另一个链接：[MSDN：如何：使用 CLR 数据库对象](https://msdn.microsoft.com/en-us/library/hh272683(v=vs.103).aspx)）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T15:32:59.653

答案是否定的，不是在一般情况下，尽管它可能取决于您所说的高效。出于这些目的，我将使用以下定义：“有效地使用索引并以合理的顺序连接”，这可能与任何定义一样好。

在这种情况下，“高效”查询是“s-arg”-able，这意味着它们可以使用索引查找来缩小搜索谓词。等式（t-join）和简单的不等式可以做到这一点。'AND' 谓词也可以做到这一点。之后，我们进入表、索引和范围扫描——即必须进行逐条记录（或索引键逐索引键）比较的操作。

Sontek 的回答描述了一种将正则表达式功能内联到查询中的方法，但操作仍然必须逐个记录地进行比较。[将它包装在一个函数中将允许一个基于函数的索引，其中计算的结果在索引中具体化（Oracle 支持这一点，您可以使用本文中](http://forums.microsoft.com/TechNet/ShowPost.aspx?PostID=3030008&SiteID=17)讨论的技巧在 SQL Server 中获得等效的功能）。但是，您不能对任意正则表达式执行此操作。

在一般情况下，正则表达式的语义不适合像索引那样修剪匹配集，因此将 rexegp 支持集成到查询优化器中可能是不可能的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T08:22:08.210

看看[这个](http://blogs.msdn.com/khen1234/archive/2005/05/11/416392.aspx)和[这个](http://www.sqlteam.com/article/regular-expressions-in-t-sql)。他们是关于如何做到这一点的好帖子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-04T12:27:48.117

我希望能够在 SQL Server 中本地调用正则表达式以进行即席查询并在存储过程中使用。我们的 DBA 不允许我们创建 CLR 函数，所以我一直使用[LINQ Pad](http://www.linqpad.net/)作为一种穷人的查询编辑器来处理临时的东西。在处理已保存到数据库的 JSON 或 XML 等结构化数据时，它特别有用。

而且我同意没有正则表达式支持似乎是一种疏忽，这似乎是查询语言的一个明显特征。希望我们会在未来的版本中看到它，但人们已经要求它很长时间了，但它还没有进入产品。

我看到的反对它的最常见原因是，格式不正确的表达式会导致[灾难性的回溯](http://www.regular-expressions.info/catastrophic.html)，这在 .NET 中不会中止，并且几乎总是需要重新启动机器。也许一旦他们在框架中解决了这个问题，我们就会看到它包含在 SQL Server 的未来版本中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T01:34:59.187

我想我们可以从 SQL Server 2008 中的新类型（层次结构、地理空间）中看到，如果微软确实添加了这个，它将以 SQL CLR 程序集的形式出现

如果您能够将程序集安装到您的数据库中，您可以通过在 Visual Studio 中创建一个新的 Database\SQL Server 项目来创建您自己的程序 - 这将允许您创建一个新的 Trigger / UDF / Stored Proc / Aggregate 或 UDT。您可以将 System.Text.RegularExpressions 导入类并从那里开始。

希望这可以帮助

# model-view-controller - MVC 模式与 DAL/BLL 设计模式有何不同（如果有的话）？

> ID：267924
> 
> 赞同：12
> 
> 时间：2008-11-06T08:17:13.883
> 
> 标签：model-view-controller, data-access-layer, bll

我正在浏览 Microsoft 的 ASP.NET 网站上的早期[数据访问教程](http://www.asp.net/learn/data-access/?lang=cs)，我突然想到，这一切似乎与我读到的关于使用[MVC 模式](http://en.wikipedia.org/wiki/Model-view-controller)分离逻辑和表示代码的内容非常相似。作为一个新手，我还没有实现 MVC 模式，但我很好奇这两种设计结构有何不同，以及我是否应该将注意力集中在其中一种上，尤其是在网页设计的背景下。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-06T09:16:03.890

MVC 解决的不仅仅是数据访问。在 MVC 中，DAL 和 BLL 都被合并到模型中。视图定义了模型数据如何呈现给用户，而控制器则响应用户输入（网络上的 GET/POST）。

MVC 的替代方案是经典的 N 层架构，其中您有一个表示层、一个业务层和一个数据访问层。在这种架构中，视图和控制器的组件被包装在表示层中。WebForms/WinForms 是 N 层架构的一个示例，而 ASP.Net MVC 是 Microsoft 空间中 MVC 的一个示例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T08:37:34.000

您为数据访问教程发布的链接是 MVC 模式的实现。MVC 模式是一个概念，实现可以不同；您在 ASP.NET 中有这个，而在 Java 中有一个称为[Struts](http://en.wikipedia.org/wiki/Apache_Struts)的框架，它是一种实现 MVC。

DAL & BLL 模式在概念上与 MVC 模式不同；但不是这个特定的实现。MVC 实际上是通过使用 DAL、BLL 和视图模式来实现的。

# ruby-on-rails - 活塞 git 支持？

> ID：267931
> 
> 赞同：0
> 
> 时间：2008-11-06T08:22:28.943
> 
> 标签：ruby-on-rails, ruby, ruby-piston

我发现活塞似乎是管理 Rails 插件的不错工具，但是当我尝试使用基于 git 的插件为我的项目进行活塞转换时，它完全死了，似乎它试图用 svn 工具寻找 .svn。

我在活塞 1.4.0 上，是原生支持 git 还是我必须从边缘构建？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T09:15:51.567

I'm using piston 1.9.x for exactly this reason - since 1.9, it has [supported Git importing](http://blog.teksol.info/2008/03/17/piston-1-9-0-official-preview-release.html).

Instructions on installing can be found [here](http://blog.teksol.info/2008/03/23/piston-1-9-1-import-goodness.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T17:05:44.177

看看[辫子](http://github.com/evilchelu/braid/tree/master)。

> 帮助跟踪 git 存储库中的 git 和 svn 供应商分支的简单工具

# ruby-on-rails - 是否应该在 before(:each) 部分中使用自定义方法

> ID：267938
> 
> 赞同：1
> 
> 时间：2008-11-06T08:27:07.313
> 
> 标签：ruby-on-rails, rspec

我在模型 Category 上有一个名为 create_main 的方法，用于创建主要类别。我是否应该在 before(:each) 部分中使用此方法，即使该方法本身必须经过测试，还是应该使用内置功能的 rails 手动创建主类别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T15:20:12.330

应该可以将您的示例划分为两个示例组，其中一组使用 create_main 调用 before(:each)，您可以使用它来测试除 create_main 之外的所有内容。然后，您有另一个子集，其中 before(:each) 不调用 create_main，在这里您测试 create_main。

就您而言，我认为您可以尝试以下方法：

```
describe Category, " without a main category" do
  before(:each) do
    # No call to create_main here
  end

  it "should create the main category" do
    # Here we test that create_main is working
  end
end

describe Category, " with a main category already created" do
  before(:each) do
    # This time, we do call create_main to set up the object as necessary
  end

  # More examples go here that depend on create_main
end 
```

试一试。我不是 100% 确定它是否有效，但我过去曾见过类似的设置。

# linux - 确定 Linux 中二进制文件的目标 ISA 扩展名（库或可执行文件）

> ID：267941
> 
> 赞同：60
> 
> 时间：2008-11-06T08:29:28.320
> 
> 标签：linux, shared-libraries, executable, cpu-architecture, instruction-set

我们有一个与在带有 Via C3 处理器的 Advantech POS 板上的（相当旧的）FC3 下运行的 Java 应用程序相关的问题。Java 应用程序有几个通过 JNI 访问的已编译共享库。

Via C3 处理器应该与 i686 兼容。前段时间在具有相同处理器的 MiniItx 板上安装 Ubuntu 6.10 后，我发现前面的说法并非 100% 正确。由于缺少C3处理器中设置的i686的一些特定和可选指令，Ubuntu内核在启动时挂起。在使用 i686 优化时，GCC 编译器默认使用 i686 集的 C3 实现中缺少的这些指令。在这种情况下，解决方案是使用 i386 编译版本的 Ubuntu 发行版。

Java 应用程序的基本问题是 FC3 发行版是通过从另一台 PC（这次是 Intel P4）的 HD 映像克隆而安装在 HD 上的。之后，该发行版需要进行一些黑客攻击才能使其运行，例如用 i386 编译版本替换一些软件包（例如内核）。

问题是工作一段时间后系统完全挂起，没有任何痕迹。我担心某些 i686 代码会留在系统中的某个位置，并且可以随时随机执行（例如从挂起模式恢复后或类似的情况）。

我的问题是：

*   是否有任何工具或方法可以找出二进制文件（可执行文件或库）需要哪些特定架构扩展？`file`没有提供足够的信息。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2010-05-25T07:04:51.533

unix.linux`file`命令对此非常有用。它通常可以检测给定二进制文件的目标架构和操作系统（并且自 1973 年以来一直保持开启和关闭。哇！）

当然，如果你不是在 unix/linux 下运行 - 你有点卡住了。我目前正在尝试找到一个可以在运行时调用的基于 java 的端口。但没有这样的运气。

unix`file`命令提供如下信息：

```
hex: ELF 32-bit LSB executable, ARM, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.4.17, not stripped 
```

（unix）命令提示了有关架构细节的更多详细信息，该`objdump -f <fileName>`命令返回：

```
architecture: arm, flags 0x00000112:
EXEC_P, HAS_SYMS, D_PAGED
start address 0x0000876c 
```

该可执行文件由 gcc 交叉编译器编译（在 i86 机器上编译，以 ARM 处理器为目标）

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-07-04T15:10:44.603

我决定为任何来到这里的人添加一个解决方案：就我个人而言，`file`和提供的信息`objdump`还不够，而且`grep`帮助不大——我通过`readelf -a -W`.

请注意，这为您提供了很多信息。与拱门相关的信息存在于最开始和最后。这是一个例子：

```
ELF Header:
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF32
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           ARM
  Version:                           0x1
  Entry point address:               0x83f8
  Start of program headers:          52 (bytes into file)
  Start of section headers:          2388 (bytes into file)
  Flags:                             0x5000202, has entry point, Version5 EABI, soft-float ABI
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         8
  Size of section headers:           40 (bytes)
  Number of section headers:         31
  Section header string table index: 28
...
Displaying notes found at file offset 0x00000148 with length 0x00000020:
  Owner                 Data size   Description
  GNU                  0x00000010   NT_GNU_ABI_TAG (ABI version tag)
    OS: Linux, ABI: 2.6.16
Attribute Section: aeabi
File Attributes
  Tag_CPU_name: "7-A"
  Tag_CPU_arch: v7
  Tag_CPU_arch_profile: Application
  Tag_ARM_ISA_use: Yes
  Tag_THUMB_ISA_use: Thumb-2
  Tag_FP_arch: VFPv3
  Tag_Advanced_SIMD_arch: NEONv1
  Tag_ABI_PCS_wchar_t: 4
  Tag_ABI_FP_rounding: Needed
  Tag_ABI_FP_denormal: Needed
  Tag_ABI_FP_exceptions: Needed
  Tag_ABI_FP_number_model: IEEE 754
  Tag_ABI_align_needed: 8-byte
  Tag_ABI_align_preserved: 8-byte, except leaf SP
  Tag_ABI_enum_size: int
  Tag_ABI_HardFP_use: SP and DP
  Tag_CPU_unaligned_access: v6 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-11-06T08:36:28.057

我认为您需要一个工具来检查每条指令，以确定它属于哪个集合。C3 处理器实现的特定指令集是否有正式名称？如果没有，那就更毛了。

如果您可以确定不允许的指令的位模式，那么快速的变体可能是在文件中进行原始搜索。只需直接测试它们，例如可以通过简单的`objdump | grep`链来完成。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-11-28T17:07:29.110

要回答 Via C3 是否是 i686 级处理器的歧义：不是，它是 i586 级处理器。

Cyrix 从未生产过真正的 686 级处理器，尽管他们在市场上声称使用 6x86MX 和 MII 部件。在其他缺失的指令中，他们没有的两个重要指令是 CMPXCHG8b 和 CPUID，它们是运行 Windows XP 及更高版本所必需的。

National Semiconductor、AMD 和 VIA 都生产了基于 Cyrix 5x86/6x86 内核（NxP MediaGX、AMD Geode、VIA C3/C7、VIA Corefusion 等）的 CPU 设计，这导致了奇特的设计，您拥有 586 级处理器使用 SSE1/2/3 指令集。

我的建议是，如果您遇到上面列出的任何 CPU 并且它不是用于老式计算机项目（即 Windows 98SE 和更早版本），那么请远离它。您将被困在缓慢的 i386/486 Linux 上，或者必须使用 Cyrix 特定的优化重新编译您的所有软件。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-11T19:50:35.183

扩展@Hi-Angel 的答案，我找到了一种检查静态库位宽的简单方法：

```
readelf -a -W libsomefile.a | grep Class: | sort | uniq 
```

`libsomefile.a`我的静态库在哪里。也应该适用于其他 ELF 文件。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-05-26T12:22:06.690

找到架构的最快方法是执行：

```
objdump -f testFile | grep architecture 
```

这甚至适用于二进制文件。

# c# - 对 LINQ 有一些困惑

> ID：267944
> 
> 赞同：0
> 
> 时间：2008-11-06T08:31:08.490
> 
> 标签：c#, .net, linq, linq-to-objects

一些背景资料；

*   LanguageResource 是基类
*   LanguageTranslatorResource 和 LanguageEditorResource 继承自 LanguageResource
*   LanguageEditorResource 定义了一个 IsDirty 属性
*   LanguageResourceCollection 是 LanguageResource 的集合
*   LanguageResourceCollection 在内部将 LanguageResources 保存在`Dictionary<string, LanguageResource> _dict`
*   LanguageResourceCollection.GetEnumerator() 返回`_dict.Values.GetEnumerator()`

我有一个 LanguageResourceCollection _resources，它只包含 LanguageEditorResource 对象，并且想使用 LINQ 来枚举那些脏的，所以我尝试了以下方法。我的具体问题以粗体显示。

1.  `_resources.Where(r => (r as LanguageEditorResource).IsDirty)`

    Intellisense 没有显示其他 LINQ 方法，但我还是对其进行了编码，并被告知“LanguageResourceCollection 不包含'Where'的定义并且没有扩展方法......”。

    **为什么 LanguageResourceCollection 实现 IEnumerable 的方式使其无法支持 LINQ？**

2.  如果我将查询更改为

    `(_resources as IEnumerable<LanguageEditorResource>).Where(r => r.IsDirty)`

    Intellisense，则会显示 LINQ 方法并且解决方案会编译。但是在运行时我得到一个 ArgumentNullException “值不能为空。参数名称：源”。

    **这是我的 LINQ 代码中的问题吗？
    类的一般设计有问题吗？
    如何深入研究 LINQ 生成的内容以尝试查看问题所在？**

我对这个问题的目标不是为特定问题找到解决方案，因为我现在必须使用其他（非 LINQ）方法来解决它，而是尝试提高我对 LINQ 的理解并学习如何改进设计我的课程可以更好地使用 LINQ。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T08:40:46.457

这听起来像您的收藏工具`IEnumerable`，而不是`IEnumerable<T>`，因此您需要：

```
_resources.Cast<LanguageEditorResource>().Where(r => r.IsDirty) 
```

请注意，它`Enumerable.Where`是在 上定义的`IEnumerable<T>`，而不是`IEnumerable`- 如果您有非泛型类型，则需要使用`Cast<T>`(或`OfType<T>`) 来获得正确的类型。不同之处在于，`Cast<T>`如果它发现不是 a 的东西，就会抛出异常`T`，而 where-as`OfType<T>`会简单地忽略任何不是 a 的东西`T`。由于您已声明您的集合*仅*包含，因此使用而不是静默删除数据`LanguageEditorResource`来检查该假设是合理的。`Cast<T>`

还要检查您是否有“使用 System.Linq”（并且正在引用 System.Core（.NET 3.5；否则 LINQBridge 与 .NET 2.0）以获取`Where`扩展方法。

实际上，实现你的集合是值得的`IEnumerable<LanguageResource>`——你可以很简单地使用`Cast<T>`方法或迭代器块 ( `yield return`)。

[编辑] 以 Richard Poole 的注释为基础 - 您可以在这里编写*自己的*通用容器，大概使用`T : LanguageResource`（并`T`在`Dictionary<string,T>`, 和实现`IEnumerable<T>`or中使用它`ICollection<T>`）。只是一个想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T09:02:26.600

除了 Marc G 的回答之外，如果您能够这样做，您可能需要考虑放弃您的自定义`LanguageResourceCollection`类以支持泛型`List<LanguageResource>`. 这将解决您当前的问题并摆脱讨厌的 .NET 1.1ish 自定义集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T16:25:30.170

> 如何深入研究 LINQ 生成的内容以尝试查看问题所在？

Linq 在这里没有生成任何东西。您可以使用调试器单步执行。

> 尝试提高我对 LINQ 的理解，并了解如何改进我的课程设计以更好地使用 LINQ。

System.Linq.Enumerable 方法严重依赖 IEnumerable<T> 协定。您需要了解您的类如何生成支持此协定的目标。T代表的类型很重要！

您可以将此方法添加到 LanguageResourceCollection：

```
public IEnumerable<T> ParticularResources<T>()
{
  return _dict.Values.OfType<T>();
} 
```

并通过以下方式调用它：

```
_resources
  .ParticularResources<LanguageEditorResource>()
  .Where(r => r.IsDirty) 
```

如果集合类没有针对相同的 _dict.Values 实现 IEnumerable< T >，则此示例将更有意义。重点是理解 IEnumerable<T> 和泛型类型。

# c - 结构之间的转换？

> ID：267949
> 
> 赞同：2
> 
> 时间：2008-11-06T08:33:01.653
> 
> 标签：c

我正在开发一个代码库，其中我们有几种可配置的类型。其中一种类型是 64 位整数。当我们为没有原生 64 位整数类型的平台进行编译时，我们使用类似于以下的结构简单地表示 64 位整数

```
typedef struct {
    unsigned int hi, lo;
} int64; 
```

为了使这种类型有用，所有常见的操作都定义为函数，例如

```
int64 int64_add(int64 x, int64 y); 
```

在可以使用本机 64 位整数类型的平台上，这些操作看起来像

```
#define int64_add(x, y) ((x) + (y)) 
```

无论如何，关于这个问题。我正在实现一些关于时间的功能，我想使用 64 位整数来表示我的时间：

```
typedef int64 mytime; 
```

我还希望 int64 类型可用的所有常见操作也可用于我的时间类型：

```
#define mytime_add(x, y) (mytime) int64_add((int64) (x), (int64) (y)) 
```

问题在于 C 中不允许类型 mytime 和 int64 之间的转换（据我所知）。有什么方法可以做到这一点，而不必重新实现 mytime 类型的所有 add、sub、mul、div 等函数？

一种选择当然是永远不要使用 mytime typedef 并在需要表示时间的任何地方简单地使用 int64。问题在于我不确定我是否总是想将时间表示为 64 位整数。然后还有可读代码的问题...... :-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T11:08:09.610

因为您使用的是 typedef，所以您根本不需要演员表。C 中的 Typedef 不会创建不同的类型，只会创建另一种类型的别名。编译器不区分它们。只需将 mytime_add 函数编写为：

```
#define mytime_add(x, y) int64_add((x), (y)) 
```

或者如果您的 C 编译器足以进行内联：

```
mytime mytime_add(mytime x, mytime y) { return int64_add(x, y); } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T09:30:54.907

你真的需要演员吗？gcc 正在编译以下示例而没有任何抱怨：

```
 typedef struct int64 int64;

struct int64
{
    unsigned int hi, lo;
};

typedef int64 mytime;

int64
add_int64(int64 a, int64 b)
{
    int64 c;
    /* I know that is wrong */
    c.hi = a.hi + b.hi;
    c.lo = a.lo + b.lo;

    return c;
}

int
main(void)
{
    mytime a = {1, 2};
    mytime b = {3, 4};
    mytime c;

    c = add_int64(a, b);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T08:40:51.840

你可以试试：

```
#define mytime int64 
```

而不是 typedef。

看起来它将为您提供透明转换和您正在寻找的可维护性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T08:56:59.670

看看 stdint.h 头文件。它包含 int64_t、uint64_t 等。这是标准且可移植的方式，您将无需实现数学函数:)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T10:01:14.907

对，所以我使用 typedefs 而没有强制转换。工作正常。尽管显式强制转换不会编译而隐式强制转换会编译，但这似乎很奇怪。如果由于编译器认为这两种类型是相同的类型，所以隐式强制转换根本不是强制转换，那么人们会认为在进行显式强制转换时同样的推理会起作用......

# tomcat - 如果它们位于两个 Web 应用程序中，Tomcat 是否会将相同的库文件两次加载到内存中？

> ID：267953
> 
> 赞同：53
> 
> 时间：2008-11-06T08:33:47.377
> 
> 标签：tomcat, shared-libraries

我在`tomcat/webapps`文件夹下有两个应用程序。

```
tomcat/webapps/App1
tomcat/webapps/App2 
```

两个应用程序共享相同的库。例如存储在`tomcat/webapps/App1/WEB-INF/lib`.

两个库是否都在内存中加载了两次？

我应该把这些共享库放进去`tomcat/server/lib`吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-06T08:37:52.143

正如您[在此处](http://tomcat.apache.org/tomcat-6.0-doc/class-loader-howto.html)看到的，Tomcat 在您的服务器上为每个 webapp 创建一个类加载器。因此，如果你有 webapp1 和 webapp2 共享同一个库，那么这个库确实会被加载两次。

如果您的 Tomcat 服务器上运行的**所有**Web 应用程序都共享该库，您最终可以将该库放在公共目录 (tomcat-dir/common/lib)中。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-11-06T10:13:15.383

我不建议将 jar 文件放在共享文件夹中。例如，假设您将来需要部署第三方应用程序，该应用程序在 WEB-INF 文件夹中有更新版本的 jar 文件。对于这个应用程序，jar 的类将被加载两次（即使它们具有相同的名称），一个来自共享文件夹，另一个来自 web 应用程序文件夹。这种情况可能会导致很难找到错误。

如果 jar 文件位于 web 应用程序文件夹中，则它们由单独的类加载器加载，并且不会相互干扰。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-06T08:49:04.570

从经验来看：这两个网络应用程序完全相互隔离——一个应用程序的库没有在另一个应用程序中使用——因此回答你最初的问题——是的，它们会被加载两次。

要回答您的第二个问题，您是否应该将这些库部署到 Tomcat 的共享目录中 - 我会说不，原因如下：

如果您将库 Jar 部署到共享位置（tomcat/server/lib），那么该版本的库将成为在该 Tomcat 实例下运行的所有 Web 应用程序的默认版本。正如您从[tomcat 体系结构的概述中看到的](http://www.scribd.com/doc/2675284/Tomcat-Architecture-4x)那样，类加载器“沿着链”工作，单个 web 应用程序的 lib 文件夹是它在引发未找到类的异常之前查看的最后一个位置。这在 Tomcat 6 和 Tomcat 7 中并非如此：web 应用程序库和类文件夹中的任何类*都将*在公共类之前解析，因此，这不会破坏在 war [2](http://tomcat.apache.org/tomcat-7.0-doc/class-loader-howto.html)中部署所有 jar 的其他应用程序。

因此，将共享库部署到该目录的问题在于，它破坏了各个应用程序相互隔离的体系结构。在您的初始示例中很好，但是如果您想要部署第三方应用程序（例如，如果您正在运行使用 Portlet 来处理特定内容的应用程序），您会立即遇到版本依赖性问题 - 您的库的共享版本可能对于第三方应用程序不正确，但由于包已经加载，你会在左右和中间抛出异常。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-07-01T15:46:11.320

我们正在使用**tomcat6**，并找到了一种让 tomcat 填充我们所有 webapps 所需的通用库的好方法。

**在conf/catalina.properties**中编辑**common.loader**条目。例如，附加一个附加文件夹，其中包含您喜欢共享的 jar 'mylibs'

```
common.loader=${catalina.base}/lib,${catalina.base}/lib/*.jar,
              ${catalina.home}/lib,${catalina.home}/lib/*.jar,
              {catalina.home}/mylibs/*.jar 
```

然后把所有的公共库放在那里。完毕。

为什么我们开始在所有 webapps（WAR 文件）中使用**mylibs文件夹而不是 WEB-INF/lib？**

WAR 突破 50MB 线后，部署开始成为一场噩梦！

当有一个没有 jar 版本的 webapp 时，您仍然可以将其放入**WEB-INF/lib**以覆盖您在**mylibs**中的内容。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-02-02T03:04:53.173

如果您不希望您的库加载两次，请将它们放入：

*   雄猫 6：`$CATALINA_HOME/lib`
*   雄猫 5：`$CATALINA_HOME/common/lib`

*（从问题中删除并复制到此处，以便对其进行投票/评论）*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-04T05:37:10.250

堆的 PermGen 空间用于存储 Java 中的类和关于类的元数据。

错误 java.lang.OutOfMemoryError: PermGen space 可能经常发生，因为我们在 apache tomcat 中加载了大量重复库，任何人都可以详细分享

# css - 查找为什么网页中的文本比使用 Firebug 应该大

> ID：267962
> 
> 赞同：1
> 
> 时间：2008-11-06T08:40:03.730
> 
> 标签：css, firebug

我有一些文本以比预期更大的字体显示。我使用了 Firebug，它显示文本是元素 CSS 中定义的 12px。然而，Web Developer 和 CSSViewer 都报告文本是 16 像素，这是当前显示的内容。

使用所有这些工具，我无法快速确定 16px 字体大小的来源。它应该是 12 像素。

使用这些工具（或其他工具）确定如何计算 16px 的最佳方法是什么？虽然我可以通过级联层次结构找到这一点，但我想知道是否有一种方法可以更轻松地获取信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T08:55:53.090

使用*Web 开发者工具包*时，您可以看到元素的 DOM 路径 - 只需查看较高元素之一是否具有不同的字体大小。Firebug 应该显示样式是从哪个元素继承的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T11:33:09.497

如果使用 Firebug 没有帮助，我会在您的 CSS 中全局搜索“16px”，暂时删除该属性，看看是否有帮助。CSS 并不总是按预期运行，尤其是在不同的浏览器中。例如，不正确的代码格式会触发非常奇怪的行为。

此外，验证您的 XHTML/HTML 和 CSS。我发现这可以立即解决很多问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-12T06:14:05.630

[自 1.10 版以来](https://getfirebug.com/wiki/index.php/Firebug_1.10_Release_Notes#Computed)， Firebug 的[*Computed*侧面板允许您展开每个计算值](https://getfirebug.com/wiki/index.php/Computed_Side_Panel#Style_Tracing)以查看它的级联层次结构，这使得了解它是如何计算的变得容易。

例子：

![<code>font-size</code> 属性计算值的样式跟踪](https://i.stack.imgur.com/Tt63S.png)

在此示例中，您可以看到字体大小基本上是在规则中使用 selector 定义的`.wmd-preview`。

# python - Python distutils and replacing strings in code

> ID：267977
> 
> 赞同：2
> 
> 时间：2008-11-06T08:50:09.137
> 
> 标签：python

I often find a need to put paths in my code in order to find data or in some cases tool-specific modules. I've so far always used autotools because of this--it's just so easy to call sed to replace a few strings at build time. However, I'd like to find a more Pythonic way of doing this, i.e. use distutils or some other blessed way of building/installing. I've never managed to find anything relating to this in distutils documentation though so how do other people solve this problem?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T08:58:39.527

For modules paths, a common practice is putting them in *.pth* files, as [documented here](http://docs.python.org/library/site.html#module-site). The *site* module provides a space for Site-specific configuration hooks, you can use it to tailor your environment.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T13:11:51.853

目前，将数据与代码捆绑在一起的最佳方式是使用[setuptools](http://peak.telecommunity.com/DevCenter/setuptools)方式并使用`pkg_resources`：

```
from pkg_resources import resource_filename, resource_stream
stream = resource_stream("PACKAGE", "path/to/data_f.ile") 
```

这还具有使用 Python 鸡蛋的优点。它具有（恕我直言）的缺点，您需要将数据文件放入代码目录中，这是公认的做法（我不同意的极少数做法之一）。

至于 Linux 发行版，我可以（合理地）向您保证，如果您使用`pkg_resources`. 我不了解 Fedora/openSUSE，但我认为它也可以工作。

它适用于 Windows，但目前不适用于 py2exe - 但是，有一些简单的解决方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T10:11:50.423

好吧，使用 distutils（在标准库中）你有“包数据”。这是存在于包本身内部的数据。[这里解释了如何做到这一点。](http://docs.python.org/distutils/setupscript.html#installing-package-data)这显然并不理想，因为您将不得不使用某种`__file__`技巧来在运行时查找数据的位置。

然后是 setuptools（不在标准库中），它还具有在运行时查找该数据位置的方法。[这里解释了如何做到这一点](http://peak.telecommunity.com/DevCenter/setuptools#including-data-files)。但同样有它自己的一系列问题，例如，它可能无法在已卸载的原始包上找到数据文件。

还有其他第三方工具。我使用的是[kiwi.environ](http://www.async.com.br/projects/kiwi/api/kiwi.environ.html)。它提供数据目录和运行时查找，但我不建议将它用于一般用途，因为它面向 PyGTK 开发和 Glade 文件位置。

我想周围还有其他第三方工具，其他人会详细说明。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T21:09:31.733

这里的OP，我终于没有设法使用我的OpenID登录。

@S.洛特

观点很好，但是对于某些 Linux 发行版，在特定位置安装特定于应用程序的数据和特定于应用程序的模块似乎是标准的。我认为让这些位置在构建/安装时可配置对于打包我的应用程序的人来说是一件好事。在这种情况下，AFAICS 的“pythonic 方式”将迫使这些打包程序将补丁应用到我的代码中。

我也有编写应用程序的习惯，其中可执行部分是应用程序特定模块中主要功能的微小包装。对我来说，将这个特定于应用程序的模块粘贴在`/usr/lib/python2.5/site-packages`.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-06T11:28:13.500

"I often find a need to put paths in my code" -- this isn't very Pythonic to begin with.

Ideally, your code lives in some place like site-packages and that's the end of that.

Often, we have an installed "application" that uses a fairly fixed set of directories for working files. In linux, we get this information from environment variables and configuration files owned by the specific userid that's running the application.

I don't think that you should be putting paths in your code. I think there's a better way.

[I just wrote our app installation tool, which does create all the config files for a fairly complex app. I used the Mako templates tool to generate all four files from templates.]

# user-interface - 我什么时候应该使用单选按钮？

> ID：267982
> 
> 赞同：6
> 
> 时间：2008-11-06T08:53:51.143
> 
> 标签：user-interface

恕我直言，单选按钮应该退役。ComboBox（下拉列表模式）应始终是首选。
下拉列表占用最少的屏幕空间，您可以通过编程方式添加/删除项目。
无需调整任何东西的大小（硬），或禁用不相关的选项（丑陋）。

你能想到单选按钮仍然有用的情况吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-06T09:01:31.050

应使用单选按钮：

*   当您需要使用标准视觉表示时
*   当您需要以组的形式直观地呈现选择组时
*   当您需要一起呈现所有选择时（在可访问性方面）

一般来说，根据 Jakob Nielsen 的指导方针，您应该更喜欢使用单选按钮而不是组合框，因为组合框很难被清晰地访问。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T08:56:56.520

When there is a limited number of options, radio buttons are usually preferred. 诸如在可预见的将来只有两种选择的选择性别之类的事情，我更喜欢单选按钮，因为它可以让您快速看到您的选择。

在大多数其他情况下，我同意，下拉菜单是首选。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-06T09:01:44.637

来自[咆哮](http://blog.alternativecontext.com/2006/06/radio-buttons-vs-combodropdown-boxes.html)：

> **当下拉菜单中的选项遵循某种顺序模式**时，应使用下拉菜单- 即日期、月份、地名、计数器、布尔值、电话号码类型（手机/家庭/工作）等。
> 
> **不应该使用它们的地方是每个选项都不适合序列，或者用户不能直接“猜测”选择**- 即选择不同的“状态”时，这通常需要用户选择下拉菜单并阅读每个选项，然后才能确定要输入的内容。

（意思：单选按钮在这种情况下更合适）

> 如果下拉列表包含不明显的选项，那么每次有人点击该页面时，他们可能必须选择下拉列表才能扫描可用选项，并确保他们选择了正确的选项。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-06T08:56:49.640

屏幕上没有太多内容的界面，例如向导页面或 10 英尺 UI（例如 Media Center）。

此外，对于触摸界面，点击单选按钮比浏览下拉列表更容易。

但我同意单选按钮占用潜在的宝贵屏幕空间 - 所以我只会在选项数量非常有限的情况下使用它们。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-10T13:14:40.040

与组合框相比，单选按钮有两个主要优点：

1.  它们对用户来说更快，只需单击一次而不是两次即可选择。典型的点击需要 1.2 到 2.4 秒。将其转换为等效的 CPU 周期，您会发现优化 UI 的少量工作值得大量优化代码的工作。

2.  它们提供了更好的控件自我文档，而无需单击任何内容。查看所有选项而不仅仅是默认选项可以告诉用户更多关于他们所看到或设置的内容。例如，看到“答案类型：右”是模棱两可的，而看到“答案类型：“(o) 右 – ( ) 左”更好。看到“优先级：高”与看到“优先级：( ) 严重 – (o) 高 – ( ) 中 – ( ) 低”具有不同的含义</p>

单选按钮和组合框都向用户显示当前选择。

从用户的角度来看，单选按钮的唯一缺点是它们占用的屏幕空间。因此，单选按钮比组合框*更*受欢迎，除非该房地产更好地用于其他用途。这与选项的数量无关，但显然，您拥有的选项越多，您可以将房地产用于更好的东西的机会就越大。

唯一的另一个考虑是，如果您有大量选项（例如，10 个或更多），组合框可以更轻松地读取当前值，因为用户不必在视觉上搜索页面的大部分/窗口找到它。

至于以编程方式添加选项所需的工作，我的理念是程序员应该努力工作，这样用户就不必这样做。

禁用会为用户提供重要信息，并且永远不应避免，因为它“丑陋”。禁用不等于删除。禁用表明可以使不可用的东西可用，而删除则表明它*永远*不可用。无法禁用组合框列表中的项目是组合框优于单选按钮的另一个缺点。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T09:03:00.500

单选按钮使用起来更快、更容易，因为您无需交互即可立即查看所有选项，并且只需单击一下即可选择您的选择。如果选项数量有限（比如 5 个或更少），收音机是更好的选择。

如果为五个单选按钮寻找屏幕空间是个问题，那么 UI 可能需要重新设计。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-06T09:04:31.060

简而言之，当可用的选择很少时，单选按钮非常有用。我立即想到的是是/否问题或调查中的问题，例如范围从强烈同意到强烈不同意。由于所有选项都显示在屏幕上（很可能是水平排列的），因此用户可以在其上提供答案。我不认为组合框看起来一样好

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-10T13:25:20.877

使用单选按钮

*   你有一小部分选择

*   选择是互斥的

*   你需要让用户一直看到所有的选择。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T08:58:01.587

单选按钮是从用户那里获得一个选项的好方法。

因此，您为您的用户创建了一个报表管理器，让他们查看今年、去年、本月或上月的销售额。

将这些放在您的经理的顶部，以便您的用户只选择一个。然后填写下拉列表等进行额外过滤

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T09:05:11.930

在以下情况下，您仍应使用它们：

1.  用户期望他们在那里（例如：许可对话框同意/拒绝，拒绝是默认设置。这是这种情况下最常见的布局，并迫使用户适应与该解决方案相同的不同解决方案他习惯了应该避免。`*`）
2.  您想立即向用户展示所有可用的选项。一个下拉列表需要他先单击它，并且该列表可能涵盖其他 GUI 元素。单选按钮提供了更好的概览。

从程序员的角度来看，我非常喜欢组合框；-)

`*`是的，我的意思是我们坚持下去，无论其他解决方案是否更好......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-06T09:13:12.883

标记“性别”的例子只是证明了我的观点。
产品发货后，客户/用户要求允许他们进行第三种选择：“未指定”。

虽然单选按钮可让您轻松查看可用选项，但下拉列表可让您轻松查看所选内容。大多数时候，用户只是查看设置，更改的频率较低。

# winforms - .NET 2.0 DataGridView ComboBox 列 - 显示项目缓慢

> ID：267987
> 
> 赞同：1
> 
> 时间：2008-11-06T08:56:53.243
> 
> 标签：winforms, performance, .net-2.0

有关如何使用大型项目​​集改进 DataGridViewComboBoxColumn 性能的任何建议？

我有一个 DataGridView，其中有几列类型为 DataGridViewComboBoxColumn。我将这些组合框列数据绑定到一个相当大的集合（10k+ 项）。结果显示项目非常慢（当我单击单元格上的向下箭头按钮时，显示项目大约需要 10 秒）。

我用标准的 ComboBox 控件测试了相同的项目集合，它运行得非常快。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-07T18:00:19.463

更好的解决方案是使用数据库中的值填充字符串数组并将列数据源设置为 null，然后将列的 Items 属性设置为您填充的值数组。这样，它不会在每次填充组合框时重新查询数据库。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T09:06:19.027

最好的方法是在 MS connect 上对[连接功能请求进行投票](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=117024):)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-11-14T21:19:15.727

您是将 10k 项数据绑定到组合框还是数据网格？

无论哪种方式，您都应该考虑设计的可用性。

如果它是数据网格，则使用分页并将绑定的数据源的大小削减到更合理的大小。

如果它位于组合框，那么您的解决方案将无法使用。您最好为您的用户提供一个自动完成框，例如来自 ajax 工具包（[http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)）的自动完成框或他们可以分页或弹出的弹出窗口搜索您的 10k 项。

# c++ - Qt QGraphicsScene 拷贝

> ID：267998
> 
> 赞同：5
> 
> 时间：2008-11-06T09:02:47.693
> 
> 标签：c++, qt

我有一个 QGraphicsScene 我想复制并附加到列表的开头。这样做的最佳方法是什么？

```
QGraphicsScene* m_scene = new QGraphicsScene();
QGraphicsScene* m_DuplicateScene;

QList<QGraphicsScene *>m_list; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-23T02:41:23.520

这样做会非常复杂，因为您对`m_scene`. 即使您为每种类型`dynamic_cast`创建了一个函数，您仍然需要记住其他人可以继承并创建他们自己类型的图形项，使它们无法被您克隆。`clone()``QGraphicsItem``QGraphicsItem`

基本上，不，你不能复制一个`QGraphicsScene`（克隆过程中的所有项目）。您甚至不能引用原始场景的孩子的孩子，因为 a`QGraphicsItem`只能有一个场景。

当然，除非我错过了方法调用。但是，搜索“克隆”、“复制”和“重复”没有产生任何结果。

在第二个问题上，使用`QList<T *>::push_front`. 因此，`m_list.push_front`( `m_DuplicateScene`);

（旁注：您添加到列表的开头，并添加到列表的末尾。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-18T10:27:20.577

我在我的项目中复制了 QGraphicsScene 的项目。我正在使用这种方式。可能会有所帮助。
我有这样的课：

```
class DiagramScene : public QGraphicsScene
{
[some datas]
} 
```

和这样的另一个类：

```
class DiagramItem : public QGraphicsItem
{
} 
```

在复制功能中，我使用这样的代码：

```
Diagram_Scene myScene;

foreach (QGraphicsItem *item, diagram_scene1->items()) 
{
    if(item->type() == DiagramItem::Type)
    {
        DiagramItem *di = qgraphicsitem_cast<DiagramItem*>(item);
        myScene.addItem(di);
    }
} 
```******```****