# StackOverflow 问答 10964000-10964999

# ios5 - 禁用视图控制器的 UIAppearance

> ID：10964001
> 
> 赞同：3
> 
> 时间：2012-06-09T19:39:01.133
> 
> 标签：ios5, uiappearance

我想禁用所选视图控制器的 UIAppearance 覆盖。

例如。我有一个与我的应用程序设计相匹配的亮橙色 uibarbutton（黑色导航栏）。但它不适合`MFMailComposeViewController`（蓝色）

有什么建议么？现在，UIAppearance 设置处于 Appdelegate 级别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T19:48:04.490

我只是更新选择器的色调作为解决方法。

```
MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];

picker.navigationBar.tintColor = [UIColor blackColor];
[picker.navigationBar setTranslucent:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-28T09:28:29.883

您可以使用协议`appearanceWhenContainedIn:`方法`UIAppearance`。`UINavigationController`例如，您甚至可以子类化，并为您的子类设置外观，而无需`UINavigationController`在其他 Apple 类上更改自身。

# silverlight - 业务逻辑在 MVVM 中位于何处？

> ID：10964003
> 
> 赞同：9
> 
> 时间：2012-06-09T19:39:13.097
> 
> 标签：silverlight, mvvm, silverlight-5.0

我习惯于使用 N 层架构进行开发，即数据访问层、业务逻辑层等

任何人都可以提供有关我的业务逻辑的最佳位置的任何建议或链接吗？

我是否将所有这些放入 Silverlight 应用程序的 Models 文件夹中的类中？

保罗

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-09T19:41:21.540

业务逻辑以及数据通常是 MVVM 中模型层的一部分。View 是视觉效果，而 ViewModel 是让您使用业务特定逻辑和数据的“粘合剂”。

任何特定于*领域或业务*的东西都应该可以被其他应用程序重用，使用其他架构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T14:54:34.987

我遇到了同样的问题并决定这样做：我在 MVC 中创建了控制器之类的类（对我的模型执行一些操作），并在所有 ViewModel 中使用它们。

例如：我们的应用程序有一个书籍列表。我们需要添加/编辑/删除它们。

所以我们有一个模型：

```
public class Book 
{
    public int BookId { get; set; }
    public string Title { get; set; }
    public string Author { get; set; }
} 
```

然后我们有一个控制器类：

```
public class BookController 
{
    string dbPath = ...;

    public void AddBook(string title, string author)
    {
        var book = new Book() { Title = title, Author = author };
        AddBook(book);
    }

    public void DeleteBook(int id)
    {
        using (var db = new SQLiteConnection(dbPath))
        {
            db.Delete<Book>(id);
        }
    }

    public void DeleteBook(Book book)
    {
        using (var db = new SQLiteConnection(dbPath))
        {
            DeleteBook(book.BookId);
        }
    }

    public List<Book> GetAllBooks()
    {
        using (var db = new SQLiteConnection(dbPath))
        {
            return db.Table<Book>().ToList();
        }
    }

    public Book FindBook(string title, string author, int id)
    {
        .....
    }
} 
```

现在我们可以在任何需要的地方使用它，例如：

```
public class BookListViewModel : ViewModelBase 
{
    public BookListViewModel() 
    {
        GetData();    
    }

    private void GetData()
    {
        BookController bc = new BookController(); // here we start using our controller. 
        _books = new List<Book>();
        _books = bc.GetAllBooks();
     }
} 
```

这种方法可以帮助我们：

1.  单独保留所有业务逻辑（在控制器类中）
2.  避免代码重复

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T09:34:42.560

这是一个很好的问题，答案部分取决于项目的复杂性和开发人员的品味。

我见过的一些 MVVM 项目将所有内容都放在 VM 部分，因此 View 的 .cs 文件是空的（因为*每个人都*知道 'code-behind' 是邪恶的</sarcasm>）并且 Model 文件包含被动的“存储类”（即 C基本上带有封装的结构）。

对于一些简单的项目（例如几乎没有任何逻辑的查看器），它可能是一个不错的选择。但它会导致类似 blob 的视图模型试图做所有事情，如果您的项目有任何复杂性，这是无法管理的。

* * *

Reed Copsey 的回答（业务逻辑/数据访问应该与 View/ViewModel 解耦）是具有任何显着复杂性的项目的最佳解决方案。

# javascript - 如何使用 JavaScript 将选择扩展到单词边界，仅一次？

> ID：10964016
> 
> 赞同：9
> 
> 时间：2012-06-09T19:40:46.907
> 
> 标签：javascript, html, dom, selection

我正在使用[此答案](https://stackoverflow.com/a/7381574/1309774)中显示的技术将网页的选择扩展到单词边界：

```
function snapSelectionToWord() {
    var sel;

    // Check for existence of window.getSelection() and that it has a
    // modify() method. IE 9 has both selection APIs but no modify() method.
    if (window.getSelection && (sel = window.getSelection()).modify) {
        sel = window.getSelection();
        if (!sel.isCollapsed) {

            // Detect if selection is backwards
            var range = document.createRange();
            range.setStart(sel.anchorNode, sel.anchorOffset);
            range.setEnd(sel.focusNode, sel.focusOffset);
            var backwards = range.collapsed;
            range.detach();

            // modify() works on the focus of the selection
            var endNode = sel.focusNode, endOffset = sel.focusOffset;
            sel.collapse(sel.anchorNode, sel.anchorOffset);
            if (backwards) {
                sel.modify("move", "forward", "word");
                sel.extend(endNode, endOffset);
                sel.modify("extend", "backward", "word");

            } else {
                sel.modify("move", "backward", "word");
                sel.extend(endNode, endOffset);
                sel.modify("extend", "forward", "word");
            }
        }
    } else if ( (sel = document.selection) && sel.type != "Control") {
        var textRange = sel.createRange();
        if (textRange.text) {
            textRange.expand("word");
            // Move the end back to not include the word's trailing space(s),
            // if necessary
            while (/\s$/.test(textRange.text)) {
                textRange.moveEnd("character", -1);
            }
            textRange.select();
        }
    }
}​ 
```

到现在为止还挺好。但是，如果您`snapSelectionToWord`在所选内容上多次调用该函数，则每次调用时它都会在两个方向上向外扩展一个单词，如果您想在选择文本时多次调用它，这并不好。

这是一个[现场 jsFiddle 示例](http://jsfiddle.net/inactivist/NSdXZ/)，它允许您重复单击“Snap”按钮，它演示了问题。

如果原始解决方案已经在单词边界上，如何修复原始解决方案以使其不扩展选择？

*   我更愿意对[原始解决方案](https://stackoverflow.com/a/7381574/1309774)发表评论，但遗憾的是，StackOverflow 业力旅还没有给我足够的业力——否则，我只会在那里问。而且我不确定如何解决这个问题，所以我不会编辑原始解决方案。

编辑：为每个请求添加代码片段

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T22:50:30.840

我写了那个样本。由于您指出的原因，我从未对它感到满意，并且还因为它在所有浏览器中（或在 Opera 中根本没有）都无法始终如一地工作。

我一直在为我的[Rangy](http://code.google.com/p/rangy)库开发一个跨浏览器的解决方案。当前版本被描述为 alpha，但运行良好。这是一个演示：

[http://rangy.googlecode.com/svn/trunk/demos/textrange.html](http://rangy.googlecode.com/svn/trunk/demos/textrange.html)

这是你的演示，修改为使用 Rangy：

[http://jsfiddle.net/timdown/RgZ8r/](http://jsfiddle.net/timdown/RgZ8r/)

关键线是

```
rangy.getSelection().expand("word"); 
```

如果您不想使用像 Rangy 这样重量级的东西（使用 TextRange 模块大约需要 50KB 的代码），那么可以改进原始代码（正如 Matt M 在他的回答中所说的那样），但它仍然有局限性。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-09T21:33:11.027

也许在你捕捉到单词之前尝试在任一方向弹出一个字符：

```
 if (backwards) {
            sel.modify("move", "backward", "character");
            sel.modify("move", "forward", "word");
            sel.extend(endNode, endOffset);
            sel.modify("extend", "forward", "character");
            sel.modify("extend", "backward", "word");

        } else {
            sel.modify("move", "forward", "character");
            sel.modify("move", "backward", "word");
            sel.extend(endNode, endOffset);
            sel.modify("extend", "backward", "character");
            sel.modify("extend", "forward", "word");
        } 
```

[http://jsfiddle.net/3RAkZ/](http://jsfiddle.net/3RAkZ/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-29T15:32:06.627

您的代码在阿拉伯语文本中无法正常工作您可以尝试使用此代码段代替

```
function snapSelectionToWord() {
    var sel;

    // Check for existence of window.getSelection() and that it has a
    // modify() method. IE 9 has both selection APIs but no modify() method.
    if (window.getSelection && (sel = window.getSelection()).modify) {
        sel = window.getSelection();
        if (sel.isCollapsed) {

           var rng2 = sel.getRangeAt(0);
           var startOffset = rng2.startOffset;
           startOffset = 0
           for (var i = rng2.startOffset; i >= 0; i--) {
              if (rng2.startContainer.data[i].match(/\S/) != null) {
                 startOffset++;
              } else
                 break;
           }
           var endOffset = rng2.endOffset;
           endOffset = 0;
           for (var i = rng2.endOffset; i < rng2.endContainer.data.length; i++)
              if (rng2.endContainer.data[i].match(/\S/)) {
                 endOffset++;
              } else
                 break;

           startOffset = rng2.startOffset - startOffset;
           startOffset = startOffset < 0 ? 0 : startOffset;

           endOffset = rng2.endOffset + endOffset;
           endOffset = endOffset >= rng2.endContainer.data.length ? rng2.endContainer.data.length - 1 : endOffset;

           rng2.setStart(rng2.startContainer, startOffset);
           rng2.setEnd(rng2.endContainer, endOffset);
           sel.removeAllRanges();
           sel.addRange(rng2);

        }
    } else if ( (sel = document.selection) && sel.type != "Control") {
        var textRange = sel.createRange();
        if (textRange.text) {
            textRange.expand("word");
            // Move the end back to not include the word's trailing space(s),
            // if necessary
            while (/\s$/.test(textRange.text)) {
                textRange.moveEnd("character", -1);
            }
            textRange.select();
        }
    }
}
```

# java - xslt 适用于 xalan cli，但不适用于 java 代码

> ID：10964019
> 
> 赞同：-1
> 
> 时间：2012-06-09T19:40:56.957
> 
> 标签：java, android, xslt, xhtml

我正在尝试使用 XSLT 将 html 内容抓取到 xml 结构中，我使用 XALAN（CLI）针对 html 测试了我的 xslt，当我对结果感到满意时，我获取了 xslt 文件并使用转换器从 java 代码中使用它（ javax.xml.transform.TransformerFactory），下面是看起来类似于真实代码和样式表的测试值。

我的 html 示例数据：

```
<html><body class='home'>
        <div >Welcome !!</div>
    <table border='0'><tr><td colspan='2'>asdas</td></tr>
        <tr><td class='footer' colspan='2' align='center'>Disclaimer: The information provided below is for informative purpose only and it is not a legal document.</td></tr>
        <tr><td colspan='2'>test;</td></tr>
    <tr><td class='Home' width='50%' aligh='center'> number:</td><td class='Home' width='50%' aligh='center'>515120</td></tr><tr><td class='Home' width='50%' aligh='center'>Connection :</td><td class='Home' width='50%' aligh='center'>123.23</td></tr><tr><td class='Home'>period (month / year):</td><td class='Home'>04/2012</td></tr><tr><td class='Home'>Date:</td><td class='Home'>APRIL     08,2012, 21:35</td></tr>  </table>
    </body>
    </html> 
```

我唯一的 xsl 模板是：

```
<xsl:template match="*">
<usage_channel>
<head><xsl:value-of select="//div/text()" /></head>
<body><xsl:value-of select="//td/font/text()" /></body>
<footer><xsl:value-of select="body/table/tr[contains(td,'number')]/td[1]/text()" /></footer>
</usage_channel>
</xsl:template> 
```

使用 XALAN (cli) 的结果：

```
<?xml version="1.0" encoding="UTF-8"?><usage_channel><head>Welcome !!</head><body/><footer> number:</footer></usage_channel> 
```

使用 Java 转换器的结果：

```
<?xml version="1.0" encoding="UTF-8"?>
<usage_channel>
   <head>Welcome !!</head>
   <body/>
   <footer/>
</usage_channel> 
```

我尝试了所有希望捕捉 td 中的值的组合，但我失败了，这里缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T08:53:52.033

我发现由于 HTMLCleaner 的使用，转换器使用的 HMTL 数据与原始数据略有不同，因此基于该问题，我的大多数 XSLT 选择查询不再有效。我不得不打印出 HTML 并发现问题：

被 HTMLCleaner 清理后修改的 HTML：

```
<html>
<head></head>
<body class="home">
   <div>Welcome !!
   <center>
   <table border="0">
     <tbody>
       <tr><td colspan="2">asdas</td></tr>
       <tr><td class="footer" colspan="2" align="center">Disclaimer: The information provided below is for informative purpose only and it is not a legal document.</td></tr>
       <tr><td colspan="2">test;</td></tr>
       <tr><td class="Home" width="50%" aligh="center">number:</td><td class="Home" width="50%" aligh="center">515120</td></tr>
       <tr><td class="Home" width="50%" aligh="center">Connection :</td><td class="Home" width="50%" aligh="center">123.23</td></tr>
       <tr><td class="Home">period (month / year):</td><td class="Home">04/2012</td></tr>
       <tr><td class="Home">Date:</td><td class="Home">APRIL     08,2012, 21:35</td></tr>    
    </tbody>
  </table>
  </center>
  </div>
</body>
</html> 
```

请注意新标签`<center>`，它破坏了我大部分依赖路径的查询`body/table/tr/td`，更改它们以`body/div/center/table/tr/td`解决问题。感谢 Dimitre 的评论！

# php - 如何获取此对象中的值？

> ID：10964020
> 
> 赞同：2
> 
> 时间：2012-06-09T19:41:00.367
> 
> 标签：php

我觉得问起来很傻，但是我如何获得`plan`这个对象的价值呢？`_object`受到保护，所以 PHP 告诉我我不能。我正在为 Recurly 使用 PHP 库。

```
object(Recurly_SubscriptionList)#47 (7) {
  ["_etag":"Recurly_Pager":private]=> NULL
  ["_position":"Recurly_Pager":private]=>int(0)
  ["_count":"Recurly_Pager":private]=>NULL
  ["_objects":protected]=> array(1) {
    [0]=> object(Recurly_Subscription)#50 (6) {
      ["_values":protected]=> array(11) {
        ["subscription_add_ons"]=> array(0) {}
        ["account"]=> object(Recurly_Stub)#54 (4) {
          ["objectType"]=> string(7) "account"
          ["_href":protected]=> string(37) "https://api.recurly.com/v2/accounts/1"
          ["_client":protected]=>NULL
          ["_links":protected]=>array(0) {}
        }
        ["plan"]=> hello 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T04:34:24.933

因此，由于我来自 Java 背景，因此我期待一个`getVar()`函数。事实证明，`__get()`如果您`__get()`正确地超载，PHP 的魔术方法允许我正常访问它。

因此，对于这种情况，对于可能偶然发现这一点的人来说，如果您使用的是 Recurly PHP 库，则必须使用它`foreach`来获取对象，然后才能`plan`正常访问。

例如，假设上面的对象是变量的值`$subscriptions`：

```
foreach($subscriptions as $subscription) {
      echo $subscription->plan;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:23:07.927

必须有某种对象方法可以将数据返回给您。阅读类文档。

# java - 将列表变成演员（Greenfoot）

> ID：10964021
> 
> 赞同：1
> 
> 时间：2012-06-09T19:41:20.057
> 
> 标签：java, list, collision

我正在为我的学校编程项目开发一款射击游戏，并使用与演员的碰撞检测。

后来我意识到我需要使用另一种方法来返回一个区域中的所有演员，但唯一的问题是它返回一个列表。我不知道如何使用列表，需要将列表的每个元素变成一个演员

这是代码的一部分：

```
MyWorld w = (MyWorld) getWorld();
    List<Actor> a = getObjectsInRange(20, null) ;
    //if it hits the soldier
    if ( a  instanceof Soldier)
    {
        Soldier s = (Soldier) a;
        //kill the enemy
        s.die();
        //add 100 score to the enemy
        w.addScore(100);
        //if the weapon is not laser
        if (weaponId != 2) 
        {
            //getting the world to make the bullet able to fire again
            w.setBulletLive(false); 
            //remove the bullet
            getWorld().removeObject(this); 

        }
    }
    // if it hits the enemy
    else if (a instanceof EnemyWeapon)
    {
        EnemyWeapon g = (EnemyWeapon) a; 
        //intercept the missile
        g.intercepted(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:04:59.413

如果要遍历演员列表，可以执行以下操作：

```
for (Actor actor : listActors) {
    // here you should put your logic.
    ...
} 
```

# android - 为什么通过 Eclipse 添加 JAR 后在 Android 上出现 NoClassDefFoundError？

> ID：10964024
> 
> 赞同：1
> 
> 时间：2012-06-09T19:41:33.337
> 
> 标签：android, eclipse, jar, noclassdeffounderror

我正在尝试将 ZXing 包含在我的 Android 应用程序中。

由于 ZXing 只提供 java 源代码，所以我自己创建了 jar 文件。

接下来，我通过将 JAR 拖到 Eclipse 中我的 Android 项目的 libs 文件夹中来添加它。

项目浏览器看起来像[这样](http://img171.imageshack.us/img171/853/unbenanntuyo.png)

构建路径如下[所示](http://img819.imageshack.us/img819/7205/unbenannt2uj.png)

在我自己的代码中，我尝试从该 JAR 实例化一个类：

```
IntentIntegratorV30 integrator = new IntentIntegratorV30(this); 
```

编译时没有错误。

但是在真实设备上运行时出现以下错误：

```
06-09 21:06:32.050: E/AndroidRuntime(1656): java.lang.NoClassDefFoundError: com.google.zxing.integration.android.IntentIntegratorV30 
```

完整的 LogCat 是：

```
06-09 21:06:32.010: I/ApplicationPackageManager(1656): cscCountry is not German : XEO
06-09 21:06:32.010: I/dalvikvm(1656): Could not find method com.google.zxing.integration.android.IntentIntegratorV30.parseActivityResult, referenced from method de.fzi.guideme.fragments.scanner.ScannerFragment.onActivityResult
06-09 21:06:32.010: W/dalvikvm(1656): VFY: unable to resolve static method 181: Lcom/google/zxing/integration/android/IntentIntegratorV30;.parseActivityResult (IILandroid/content/Intent;)Lcom/google/zxing/integration/android/IntentResult;
06-09 21:06:32.010: D/dalvikvm(1656): VFY: replacing opcode 0x71 at 0x0003
06-09 21:06:32.020: E/dalvikvm(1656): Could not find class 'com.google.zxing.integration.android.IntentIntegratorV30', referenced from method de.fzi.guideme.fragments.scanner.ScannerFragment.onCreateView
06-09 21:06:32.020: W/dalvikvm(1656): VFY: unable to resolve new-instance 67 (Lcom/google/zxing/integration/android/IntentIntegratorV30;) in Lde/fzi/guideme/fragments/scanner/ScannerFragment;
06-09 21:06:32.020: D/dalvikvm(1656): VFY: replacing opcode 0x22 at 0x002d
06-09 21:06:32.020: I/GuideMe(1656): Fragment: class de.fzi.guideme.fragments.scanner.ScannerFragment, manual: null, function: null, step: null
06-09 21:06:32.040: D/AndroidRuntime(1656): Shutting down VM
06-09 21:06:32.040: W/dalvikvm(1656): threadid=1: thread exiting with uncaught exception (group=0x401d2760)
06-09 21:06:32.050: E/AndroidRuntime(1656): FATAL EXCEPTION: main
06-09 21:06:32.050: E/AndroidRuntime(1656): java.lang.NoClassDefFoundError: com.google.zxing.integration.android.IntentIntegratorV30
06-09 21:06:32.050: E/AndroidRuntime(1656):     at de.fzi.guideme.fragments.scanner.ScannerFragment.onCreateView(ScannerFragment.java:47)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:735)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:926)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:909)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.FragmentManagerImpl.dispatchStart(FragmentManager.java:1584)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.Activity.performStart(Activity.java:4377)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1724)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1767)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.ActivityThread.access$1500(ActivityThread.java:122)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1005)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.os.Handler.dispatchMessage(Handler.java:99)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.os.Looper.loop(Looper.java:132)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at android.app.ActivityThread.main(ActivityThread.java:4028)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at java.lang.reflect.Method.invokeNative(Native Method)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at java.lang.reflect.Method.invoke(Method.java:491)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:844)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:602)
06-09 21:06:32.050: E/AndroidRuntime(1656):     at dalvik.system.NativeStart.main(Native Method) 
```

我使用带有 Android SDK Tools Rev. 19 的 Eclipse 3.7.2 和运行 Android 3.1 的三星 Galaxy Tab 10.1。

看起来 JAR 没有包含在 APK 文件中。有关如何解决此问题的任何建议？

编辑：回答我自己的问题（作为评论中讨论的结果）。我试图包含的 JAR 一定是错误的。正确构建 JAR 将在别处讨论。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T19:45:24.250

这昨天让我死了。我也没有构建错误，但运行错误。我认为这与 Android SDK 编译构建路径的方式有关。我终于重复了这些步骤并停止了错误：

1.  在您的 Android 项目的根目录中创建一个名为 libs 的文件夹。
2.  将 jar 添加到该文件夹​​。
3.  右键单击 jar 并单击以添加到构建路径。
4.  清理你的项目。
5.  构建项目。
6.  跑。

通过[android无法从外部jar中找到类](https://stackoverflow.com/questions/8231059/android-cant-find-class-from-external-jar)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-21T17:56:33.583

Android Studio 没有进行适当的清理和构建。

您必须遵循 Anna Billstrom 的指示，但需要注意以下几点：

*   打开你的命令行。
*   导航到您的项目根目录。
*   执行`./gradle clean`
*   返回 Android Studio 并运行/调试您的项目。
*   ?
*   利润。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T21:39:04.797

右键单击您的项目>properties->Java Build Path->Order and Export->检查ZXing.jar

然后清理项目并再次构建它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-16T20:18:08.660

我也遇到过这个错误。

事实证明，我是从外部项目中导出 jar 的。但是，由于 Eclipse 不知道我会将它用于我的 Android 项目，它会自动将编译器级别设置为 1.7。

Android 仅支持 1.6，因此解决方案是，在库项目中，在导出之前：

右键单击，`Properties`-> `Java compiler`-> `Compiler compilance level`-> 1.6

# video - iphone视频缩放功能

> ID：10964043
> 
> 赞同：0
> 
> 时间：2012-06-09T19:43:38.120
> 
> 标签：video, zooming, avfoundation

我正在使用 iOS 5 中的 AV Foundation Framework 在我的应用程序中拍摄一些视频。我想启用视频缩放，但我遇到了麻烦。我在想我应该在 captureOutput:didOutputSampleBuffer:fromConnection: 处对图像应用变换。如果这是正确的想法，我将如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T12:32:55.100

您可以尝试使用 UIScrollView 的缩放选项。只需在 ScrollView 上查看 Player。如果这不起作用，则使用 GPUImageView 和 GPUImageMovie。它对我来说就像一个魅力。如果您需要更多想法，请告诉我。

# r - RcppArmadillo中的QR分解

> ID：10964047
> 
> 赞同：3
> 
> 时间：2012-06-09T19:43:45.670
> 
> 标签：r, rcpp, decomposition, armadillo

真的很困惑为什么使用 RcppArmadillo 的 QR 输出与 R 的 QR 输出不同；犰狳文档也没有给出明确的答案。本质上，当我给 R 一个矩阵 Y 是 n * q (比如 1000 X 20 ) 时，我会得到 Q ，它是 1000 X 20 和 R 20 X 1000。这就是我需要的。但是当我在犰狳中使用 QR 求解器时，它让我返回 Q 1000 X 1000 和 R 1000 X 20。我可以调用 R 的 qr 函数吗？我需要 Q 有维度 nxq，而不是 qx q。下面的代码是我正在使用的（它是更大功能的一部分）。

如果有人可以建议如何在 RcppEigen 中执行此操作，那也会很有帮助。

```
library(inline)
library(RcppArmadillo)

src <- '
    Rcpp::NumericMatrix Xr(Xs);
    int q = Rcpp::as<int>(ys);

    int n = Xr.nrow(), k = Xr.ncol();
    arma::mat X(Xr.begin(), n, k, false);

    arma::mat G, Y, B;

    G = arma::randn(n,q);

    Y = X*G;

    arma::mat Q, R;
    arma::qr(Q,R,Y);

    return Rcpp::List::create(Rcpp::Named("Q")=Q,Rcpp::Named("R")=R,Rcpp::Named("Y")=Y);'

rsvd <- cxxfunction(signature(Xs="numeric", ys="integer"), body=src, plugin="RcppArmadillo") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T20:56:22.617

（注意：这个答案解释了为什么 R 和 RcppArmadillo 返回具有不同维度的矩阵，而不是如何让 RcppArmadillo 返回 R 所做的 1000*20 矩阵。为此，也许可以看看`qr.Q()`函数定义底部附近使用的策略.)

* * *

R 的`qr()`函数不直接返回 Q。为此，您需要使用`qr.Q()`，如下所示：

```
m <- matrix(rnorm(10), ncol=2)
qr.Q(qr(m))
#             [,1]        [,2]
# [1,] -0.40909444  0.05243591
# [2,]  0.08334031 -0.07158896
# [3,]  0.38411959 -0.83459079
# [4,] -0.69953918 -0.53945738
# [5,] -0.43450340  0.06759767 
```

请注意，它`qr.Q()`返回一个与 相同维度的矩阵`m`，而不是一个完整的 5*5 Q 矩阵。您可以使用`complete=`参数来控制这种行为，并获得一个全维的 Q 矩阵：

```
qr.Q(qr(m), complete=TRUE)
#             [,1]        [,2]       [,3]       [,4]        [,5]
# [1,] -0.40909444  0.05243591  0.3603937 -0.7158951 -0.43301590
# [2,]  0.08334031 -0.07158896 -0.8416121 -0.5231477  0.07703927
# [3,]  0.38411959 -0.83459079  0.2720003 -0.2389826  0.15752300
# [4,] -0.69953918 -0.53945738 -0.2552198  0.3453161 -0.18775072
# [5,] -0.43450340  0.06759767  0.1506125 -0.1935326  0.86400136 
```

在您的情况下，听起来 RcppArmadillo 正在返回完整的 1000x1000 Q 矩阵（就像`qr.Q(q(m, complete=FALSE))`会），而不仅仅是它的第 20 列（就像`qr.Q(q(m))`会）。

# mysql - Suitable environment for developing a Windows application connected to a MySQL database?

> ID：10964050
> 
> 赞同：-1
> 
> 时间：2012-06-09T19:43:59.700
> 
> 标签：mysql, wpf, database, wpfdatagrid, wpftoolkit

Herro!

I'm doing some pro bono developing for our local bookshop. I am to build an application to handle their book circle

The application would have one admin view where new books, members, memberships etc. can be added/edited/deleted and one super duper simple view for the customers to either scan their ID's and scan a book to loan it or just scan an already loaned book to return it. No rocket science.

I've set up a MySQL database with appropriate tables.

Now I wonder, is WPF suitable for an application like this, or are there better/simpler alternatives? I'd prefer C#, but it's not a must. A plus would be if it's simple to make a pretty UI.

Cheers / Fredde!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T19:48:02.993

I think what-ever stack you feel most comfortable developing in. C# and WPF can certainly be used to make this application, as well as any number of other development stacks. I don't think there really is a right or wrong answer for this, just use what your comfortable with.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T19:49:52.557

Go with what you're familiar with, and use C#. From the few details that you have given us, it sounds like it is capable of doing what you want.

Microsoft Visual C# Express would be an ideal IDE for you to use, and allows you to quickly prototype up a user interface by using drag-and-drop to position components where you need them.

Visual C# Express: [http://www.microsoft.com/visualstudio/en-us/products/2010-editions/express](http://www.microsoft.com/visualstudio/en-us/products/2010-editions/express)

# excel - 使用VBA在excel中给定可变长度的某个输入列的列中输出值

> ID：10964053
> 
> 赞同：0
> 
> 时间：2012-06-09T19:44:58.947
> 
> 标签：excel, vba

我希望 VBA 读取该列，然后根据条件将值输出到一个新列中：- 我想找到定义正在读取的列中值的前 33% 和底部 33% 值的值。例如，如果 A 列中的值介于 1、2、3、4、5、6 之间，我的答案是 2 和 5，将显示在 B 和 C 列中。我想将其用于可变长度的输入列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T03:31:05.487

一个解决方案是：

1.  拉取整数数组中的值
2.  使用某种排序算法对数组进行排序（如果值不是升序/降序）
3.  删除重复项（如果有）。
4.  使用涉及数组长度的简单公式获取值。
5.  将值放入所需的单元格中。

# bing-maps - 为什么必应地图 RouteResult 中存在不一致？

> ID：10964055
> 
> 赞同：0
> 
> 时间：2012-06-09T19:45:23.300
> 
> 标签：bing-maps

我正在使用 Bing Maps AJAX Control 7.0。

我正在点击地图，获取鼠标点击的位置，通过点击创建航点并计算行驶路线`DirectionsManager.calculateDirections()`

然后，当返回方向时，我调用`DirectionsManager.getRouteResult()`以获取对计算`Route`对象的引用。此时我的代码遇到了一个断点，因此我可以检查`Route`.

我注意到的是，总是有不一致的地方。

*   one 的最后一个 latitude 和 longitude`subLeg.routePath`往往与 next 的第一个 latitude 和 longitude 不匹配`subLeg.routePath`。通常它们相差 0.000001，所以我认为这是四舍五入的不一致。

*   与第`routeLeg.startWaypointLocation`一个 subLeg 开头的纬度和经度不匹配，`routePath`也不`routeLeg.endWaypointLocation`匹配最后一个 subLeg 的结尾`routePath`。

*   我可能不希望`startWaypointLocation`and`endWaypointLocation`匹配 lats 和 longs`routePath`但我当然希望`subLeg.actualStart`and`subLeg.actualEnd`与`routePath`. 他们不是，他们经常是不一样的。

*   最后在`routePath`,`actualStart`和`actualEnd`lats 和 longs 的精度上存在不一致。有时它们精确到小数点后 6 位，有时精确到浮点数。

似乎每次我计算一些方向时，结果中都会出现大部分或所有这些不一致。

有没有其他人注意到这一点？为什么会出现这些不一致？有什么可以做的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T08:33:30.353

我认为这是因为您按位置添加您的航路点并将它们的纬度调整到街道或道路上最近的点（反向地理编码）所以它可以命名您的起点和终点。也许我错了，但它似乎是那样的。

# css - 我们如何使用 css3 过渡创建 jQuery fancybox 弹性动画

> ID：10964061
> 
> 赞同：1
> 
> 时间：2012-06-09T19:45:44.973
> 
> 标签：css

通过更改宽度和高度属性可以轻松实现弹性效果。但是我们如何在视口中维护元素呢？

是的，花哨的盒子在弹出窗口中放置了一个全新的元素。但我希望我的原始元素在视口中缩放到不同的大小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T13:11:36.540

使用以下技术的组合来实现此效果：

*   [合身收缩](http://www.cssplay.co.uk/menu/fast.html)
*   [盒子架](http://www.cssplay.co.uk/menu/cssplayBox.html)

# asp.net - System.windows.media 程序集

> ID：10964063
> 
> 赞同：0
> 
> 时间：2012-06-09T19:46:26.753
> 
> 标签：asp.net, namespaces

如何将 System.windows.media 的程序集添加到配置为 asp.net 3.5 的站点。

我得到了错误：

> 编译器错误消息：CS0234：命名空间“System.Windows”中不存在类型或命名空间名称“Media”（您是否缺少程序集引用？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T06:00:23.410

我已经下载了 dll：presentationcore.dll 和 windowsbase.dll，它可以工作了！

# c# - 条件运算符不适用于继承相同基类型的两种类型

> ID：10964065
> 
> 赞同：13
> 
> 时间：2012-06-09T19:46:46.280
> 
> 标签：c#, asp.net-mvc, conditional-operator

为什么条件运算符 ( `?:`) 在与从单个基类型继承的两种类型一起使用时不起作用？

我的例子是：

```
ActionResult foo = (someCondition)? 
                      RedirectToAction("Foo","Bar") :
                      Redirect(someUrl); 
```

长格式工作正常的地方：

```
ActionResult foo;

if(someCondition)
{
  foo = RedirectToAction("Foo","Bar");
}
else
{
  foo = Redirect(someUrl);
} 
```

两种返回类型，`RedirectToRouteResult` 和`RedirectResult`，都继承自`ActionResult`.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-09T19:49:53.110

> 为什么条件运算符 (?:) 在与从单个基类型继承的两种类型一起使用时不起作用？

根据语言规范，条件表达式的类型必须*是*第二个操作数的类型*或第三个操作数的类型。*编译器不会尝试找到一个通用的基本类型，或者两个操作数都可以转换为的另一种类型。表达式的*使用*不会影响其类型的确定方式——因此变量赋值在这里无关紧要。

至于*为什么*这样定义语言 - 它使指定、实现、测试和预测变得相当简单。这在语言设计中相当普遍——从长远来看，保持语言简单通常是一个更好的选择，即使它在某些特定情况下会变得更加尴尬。

有关更多详细信息，请参阅 C# 4 规范的第 7.14 节。

将第二个或第三个操作数转换为条件表达式*实际*需要的类型是解决问题的方法。请注意，这经常出现的另一种情况是可为空的类型：

```
// Invalid
int? a = SomeCondition ? null : 10;

// All valid
int? a = SomeCondition ? (int?) null : 10;
int? b = SomeCondition ? default(int?) : 10;
int? c = SomeCondition ? null : (int?) 10; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T19:51:48.023

条件运算符无法根据其组件确定结果类型，这些组件可能是`RedirectToRouteResult`或`RedirectResult`。为了解决这个问题，您应该将其中一个（或两个）组件显式转换为基本类型：

```
ActionResult foo = (someCondition) ? 
                   (ActionResult)RedirectToAction("Foo","Bar") :
                   Redirect(someUrl); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T19:53:20.007

无论分配给哪个变量，条件部分都会尝试自行解析。编译器给出一个警告，它无法确定将哪个类用作返回值，因为就条件部分而言，RedirectToRouteResult 不能与 RedirectResult 相同。但是，如果只有一侧被转换为基类，另一侧也被隐式转换，因此转换第一个是有效的：

```
 var foo = (someCondition)? 
                  (ActionResult )RedirectToAction("Foo","Bar") :
                  Redirect(someUrl); 
```

但也只能选择替代方案：

```
 var foo = (someCondition)? 
    RedirectToAction("Foo","Bar") :
   (ActionResult)Redirect(someUrl); 
```

# php - PHP cURL 重定向到位置无法正常工作

> ID：10964068
> 
> 赞同：0
> 
> 时间：2012-06-09T19:47:02.710
> 
> 标签：php, curl

我正在尝试使用 curl 将一些值发送到远程 URL。但是远程站点重定向到另一个页面，这给我带来了麻烦。

例如，我将值从 www.mywebsite.com 发送到 url www.domain.com/index.php，index.php 重定向到 fetch.php 文件，但问题是它像 www.mywebsite.com/fetch 一样打开。 php 这给了我 404 not found 错误，因为此文件位于远程站点上，而不是我的。我怎样才能解决这个问题

这是我正在使用的代码

```
$postfields = "link=xxxxxx";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'domain.com/index.php');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 0);
curl_setopt($ch, CURLOPT_HEADER, 1);

curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $postfields);

curl_setopt($ch, CURLOPT_COOKIEJAR, 'rap.txt');
curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.1) Gecko/20061204 Firefox/2.0.0.1');
$content = curl_exec($ch);
curl_close($ch); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T19:51:43.813

您是否尝试设置[`CURLOPT_FOLLOWLOCATION`](http://www.php.net/manual/en/curl.constants.php#constant.curlopt-followlocation) 选项：

```
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T19:59:22.230

试试这个代码：

```
curl_setopt($ch, CURLOPT_URL, 'http://www.domain.com/index.php'); 
```

代替：

```
curl_setopt($ch, CURLOPT_URL, 'domain.com/index.php'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T19:59:31.577

我建议首先复制您作为用户要执行的操作。

即访问 URL 并查看它是如何工作的，即数据流如何从 1 个 URL 到下一个 URL 等。然后尝试通过将所需数据发布到正确的 URL 来复制它。

也可能是第一个 URL 正在检查引荐来源网址，以确保该页面没有被滥用。

# html - 根据两个元素之间的距离解析html

> ID：10964069
> 
> 赞同：1
> 
> 时间：2012-06-09T19:47:15.830
> 
> 标签：html, html-parsing

我正在尝试做一些 html 解析。我正在处理一些非常动态的数据，而且我的来源差异很大。如果更具体地说，我正在尝试从我事先不知道的页面解析产品信息，包括名称、价格和描述。

在这些页面中，唯一保持不变的基本信息是页面标题、我正在查询的项目名称（它们都相互匹配）和价格。在不同网站中唯一保持相同的真实逻辑是不同信息集之间的接近性。因此，价格标签将接近产品名称并接近其描述。

我正在寻找一个 html 解析器，它将使我能够根据不同 html 标记之间的像素距离缩小解析范围。

你知道这样的图书馆吗？有没有其他方法可以尝试解决这个问题？

编辑：

语言，操作系统和分辨率不匹配。你知道哪些工具可以帮助解决这个问题？如果我找到一个足够好的库，我可能会决定更改我的底层操作系统和语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T04:12:25.933

物品的价格通常以特定的特殊字符开头，该字符表示与在 a 中显示值的数字相同的标签内的货币，例如：

```
<div class="product_value">£ 10.99</div>
<div class="product_value">¥ 10.99</div>
<div class="product_value">$ 10.99</div> 
```

假设您正在使用搜索 API（如 google 或 bing）来获取包含特定产品名称的页面列表，然后打开该页面一个简单的正则表达式语句将能够检索货币标记（£、$、¥等) 和 div 或 span 的结尾。

但是，如果搜索结果抛出包含多个产品或多个价格标记的页面，则该系统可能无法正常工作。唯一可以确定的方法是为每个站点编写单独的爬虫例程，或者尝试爬取其他人的比较服务。

# c# - 在实体框架中自动刷新数据

> ID：10964070
> 
> 赞同：1
> 
> 时间：2012-06-08T20:46:17.503
> 
> 标签：c#, entity-framework

我使用 Visual Studio 2010 并使用实体框架和 SQL Server 2008 R2。我的表上有触发器，当在表中保存一条记录时，另一个表中的另一列发生了变化。是否可以在我的应用程序中更改自动更改的记录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T21:58:03.803

有一个 InsertOnSubmit 事件会触发，如此[处](http://msdn.microsoft.com/en-us/library/bb763516.aspx)所述，不确定是否会对您有所帮助..

但是在保存/修改实体时会触发各种事件，但是您必须将“触发”逻辑带入代码端，然后可能会智能地处理各种实体更改..这里有更多内容：[保存时如何执行业务逻辑变化](http://msdn.microsoft.com/en-us/library/cc716714.aspx)

在更深入地查看您的问题的标题之后，您似乎正在尝试从更新的表中获取数据..正如评论所暗示的..实体“上下文”范围之外的任何内容都会有被“重新加载”。现在，如果在您的“更改事件”处理中处理了“加载”代码，那么您可以完成此操作.. 那么为什么不将所有这些逻辑放在您的代码层中呢？对您的 2 个“实体”进行更新，然后一口气保存它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T08:23:52.840

虽然，这不是您想要的答案，但我认为您应该将“触发器”逻辑从数据库移动到应用程序代码。这将解决您的问题，并允许您编写一个单元测试来验证数据是否正确更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T10:31:25.327

我搜索这个问题并找到下面的代码来刷新 EF 中的数据： `MyModelEntities.Refresh(System.Data.Objects.RefreshMode.StoreWins, TbMyRecord);`

# ruby - class << self vs self.method with Ruby：什么更好？

> ID：10964081
> 
> 赞同：69
> 
> 时间：2012-06-09T19:48:32.233
> 
> 标签：ruby

这个[Ruby 风格指南](https://github.com/styleguide/ruby)告诉你最好使用`self.method_name`而不是`class method_name`. 但为什么？

```
class TestClass
  # bad
  class << self
    def first_method
      # body omitted
    end

    def second_method_etc
      # body omitted
    end
  end

  # good
  def self.first_method
    # body omitted
  end

  def self.second_method_etc
    # body omitted
  end
end 
```

是否存在性能问题？

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-06-09T20:04:15.320

`class << self`擅长将所有类方法保存在同一个块中。如果方法是以`def self.method`形式添加的，则不能保证（除了约定和一厢情愿）文件中稍后不会有额外的类方法。

`def self.method`擅长明确说明方法是类方法，而`class << self`你必须自己去寻找容器。

其中哪一个对您更重要是一个主观决定，并且还取决于有多少其他人正在处理代码以及他们的偏好是什么。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-06-09T20:35:42.407

通常，`class << self`在元编程中用于将类长时间设置为自我。如果我尝试编写 10 种方法，我会像这样使用它：

```
METHOD_APPENDICES = [1...10]
class << self
  METHOD_APPENDICES.each do |n|
    define_method("method#{n}") { n }
  end
end 
```

这将创建 10 个仅返回数字的方法（method1、method2、method3 等）。在这种情况下，为了清楚起见，我会使用`class << self`它，因为在元编程`self`中至关重要。在里面乱扔垃圾`self.`实际上会使事情变得*不那么*可读。

如果您只是正常定义类方法，请坚持下去，`self.class_method_name`因为可能会有更多人理解它。除非您希望您的听众理解它，否则无需引入元语法。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2015-01-09T18:09:21.907

如上所述，两种样式似乎是等效的，但是使用`class << self`允许将类方法标记为`private`或`protected`。例如：

```
class UsingDefSelf
  def self.a; 'public class method'; end
  private
  def self.b; 'public class method!'; end
end

class UsingSingletonClass
  class << self
    def a; 'public class method'; end
    private
    def b; 'private class method'; end
  end
end 
```

`private`只影响实例方法。使用单例类，我们定义了该类的实例方法，这些实例方法变成了包含类的类方法！

我们还可以将类方法标记`private`为`def self`：

```
class UsingDefSelf
  def self.a; 'private class method'; end
  def self.b; 'private class method!'; end
  private_class_method :a, :b
  # In Ruby 2.1 there is an alternative syntax
  private_class_method def self.c; 'private class method!'; end
end 
```

但是我们不能将它们标记为`protected`，没有`protected_class_method`。（但是，由于类是其单例类的唯一实例，因此私有类方法和受保护类方法几乎相同，只是它们的调用语法不同。）

而且它比使用`class << self`标记类方法更容易，因为您必须在每个私有类方法定义`private`中列出所有方法名称`private_class_method`或前缀。`private_class_method`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-09T23:14:39.923

随便你。两者都非常清楚您的工作。但我对此提出了一些建议。

**当只有一个类方法要定义时，** Use `def self.xxx`。因为只定义一种方法，增加缩进级别可能会变得混乱。

**当有多个类方法要定义时，** Use `class << self`。因为写作`def self.xxx`，`def self.yyy`而且`def self.zzz`肯定是重复。为这些方法创建一个部分。

**当一个类中的所有方法都是类方法时，**可以使用`module`with`module_function`代替`class`。这让您可以定义模块函数，只需使用`def xxx`.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-06-09T19:58:00.083

我认为他们认为`self.*`更好，因为您可以肯定地说，它是一个类或实例方法，而无需向上滚动并搜索此`class << self`字符串。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2015-01-16T09:42:25.317

到目前为止，问题和答案只讨论了这两个选项：

```
class MyClass
  def self.method_name
    ..
  end
end

class MyClass
  class << self
    def method_name
      ..
    end
  end
end 
```

对于类方法，还有第三种选择：

```
class MyClass
  def MyClass.method_name
    ..
  end
end 
```

它不流行并且更冗长，但它是最明确的选项。

如果您将`self`Python 和 Ruby 之间的行为混为一谈，也不会那么混乱。

# css - 子主题未正确显示页脚导航

> ID：10964083
> 
> 赞同：0
> 
> 时间：2012-06-09T19:48:52.577
> 
> 标签：css, navigation, footer

我只是不明白。它在某一时刻工作得很好，但不是它不起作用？我有一个页脚导航列表，我正试图将其从本地服务器移动到 Web 服务器，但它现在没有做任何事情。不管我如何设计它，我怎么称呼它或我做什么，它都不起作用。我正在使用萤火虫来解决它，但我找不到问题。

这是我的 HTML

```
<div id="footerbottom">
    <ul class="foot-navigation">
        <li>Home</li>   
        <li>Home</li>   
        <li>Home</li>   
        <li>Home</li>   
        <li>Home</li>   
    </ul>

</div> 
```

CSS

```
#footerbottom { width: 100%; height: 93px; background: url(../img/FOOTER-BG-bottom.jpg) repeat; background-color: #252525; color: #fff; margin-top: -30px; 
#footerbottom p { width: 600px; margin-left: 370px; height: 30px; font-size: 1em; line-height: 25px; color: #eee; margin-top: 40px; position: absolute;left: 50%; margin-left: -470px; }

.foot-navigation { width: 900px; height: 30px; text-transform: uppercase; font-size: 1em; letter-spacing: 1px; list-style:none;  position:relative; margin 10px auto; }
.foot-navigation li { float: left; margin-right: 15px; }
.foot-navigation li a { text-decoration: none; color: #fff; }
.foot-navigation li a:hover { color: #d80800; } 
```

![在此处输入图像描述](../Images/f996fe14180702188ebc5a7bc237bffc.png)

我正在从 TwentyTen 主题创建一个子主题，到目前为止还没有遇到任何麻烦。如果有人可以帮助我，我将不胜感激。我正在拔头发试图弄清楚这一点。如果您想查看它，[该站点就在这里。](http://fhlsociety.ca)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T19:59:30.640

你`foot-navigation`没有任何风格。请检查一下，你的 ul 有一个类`foot-navigation`，你从哪里得到的`.foot-navigation ul`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T20:43:31.907

谢谢你们的帮助。我找到了一个我不想做的工作，但它有效，所以我会做。我只是将无法正常工作的样式插入到 TwentyTen 主题的 style.css 表中。这是它起作用的唯一方法。有人告诉我，我可以导入 TwentyTen 主题的所有文件，并用我自己的样式表添加我自己的文件，但是在这种情况下，这是行不通的。

# javascript - 更改 jquery 插件

> ID：10964084
> 
> 赞同：1
> 
> 时间：2012-06-09T19:49:00.117
> 
> 标签：javascript, jquery, plugins

我正在使用[vegas 滑块](http://vegas.jaysalvat.com/)作为我正在构建的站点的背景图像。我让它工作并根据我的喜好进行配置，但是我的最终目标是能够在每个页面加载时随机加载图像。

我已经看到了如何单独执行此操作的方法，但我不太确定如何更改/添加到这个现有的 js 来实现它。

任何有用的链接或教程或建议将不胜感激。

提前致谢。

```
( function( $ ){
    var $background = $( '<img />' ).addClass( 'vegas-background' ),
        $overlay    = $( '<div />' ).addClass( 'vegas-overlay' ),
        $loading    = $( '<div />' ).addClass( 'vegas-loading' ),
        $current    = $(),
        paused = null,
        backgrounds = [],
        step = 0,
        delay = 5000,
        walk = function() {},
        timer,
        methods = {

        // Init plugin
        init : function( settings ) {
            var options = {
                src: getBackground(),
                align: 'center',
                valign: 'center',
                fade: 0,
                loading: true,
                load: function() {},
                complete: function() {}
            }
            $.extend( options, $.vegas.defaults.background, settings );

            if ( options.loading ) {
                loading();
            }

            var $new = $background.clone();
            $new.css( {
                'position': 'fixed',
                'left': '0px',
                'top': '0px'
            })
            .imagesLoadedForVegas( function() {
                if ( $new == $current ) {
                    return;
                }

                $( window ).bind( 'load resize.vegas', function( e ) {
                    resize( $new, options );
                });

                if ( $current.is( 'img' ) ) {

                    $current.stop();

                    $new.hide()
                        .insertAfter( $current )
                        .fadeIn( options.fade, function() {
                            $('.vegas-background')
                                .not(this)
                                    .remove();
                            $( 'body' ).trigger( 'vegascomplete', [ this, step - 1 ] );
                            options.complete.apply( $new, [ step - 1 ] );
                        });
                } else {
                    $new.hide()
                        .prependTo( 'body' )
                        .fadeIn( options.fade, function() {
                            $( 'body' ).trigger( 'vegascomplete', [ this, step - 1 ] );
                            options.complete.apply( this, [ step - 1 ] );    
                        });
                }

                $current = $new;

                resize( $current, options );

                if ( options.loading ) {
                    loaded();
                }

                $( 'body' ).trigger( 'vegasload', [ $current.get(0), step - 1 ] );
                options.load.apply( $current.get(0), [ step - 1 ] );

                if ( step ) {
                    $( 'body' ).trigger( 'vegaswalk', [ $current.get(0), step - 1 ] );
                    options.walk.apply( $current.get(0), [ step - 1 ] );
                }
            })
            .attr( 'src', options.src );

            return $.vegas;
        },

        // Destroy background and/or overlay
        destroy: function( what ) {
            if ( !what || what == 'background') {
                $( '.vegas-background, .vegas-loading' ).remove();
                $( window ).unbind( 'resize.vegas' );
                $current = $();
            }

            if ( what == 'overlay') {
                $( '.vegas-overlay' ).remove();
            }

            return $.vegas;
        },

        // Display the pattern overlay
        overlay: function( settings ) {
            var options = {
                src: null,
                opacity: null
            };
            $.extend( options, $.vegas.defaults.overlay, settings );

            $overlay.remove();

            $overlay
                .css( {
                    'margin': '0',
                    'padding': '0',
                    'position': 'fixed',
                    'left': '0px',
                    'top': '0px',
                    'width': '100%',
                    'height': '100%'
            });

            if ( options.src ) {
                $overlay.css( 'backgroundImage', 'url(' + options.src + ')' );
            }

            if ( options.opacity ) {
                $overlay.css( 'opacity', options.opacity );
            }

            $overlay.prependTo( 'body' );

            return $.vegas;
        },

        // Start/restart slideshow
        slideshow: function( settings, keepPause ) {
            var options = {
                step: step,
                delay: delay,
                preload: false,
                backgrounds: backgrounds,
                walk: walk
            };

            $.extend( options, $.vegas.defaults.slideshow, settings );

            if ( options.backgrounds != backgrounds ) {
                if ( !settings.step ) {
                    options.step = 0;
                }

                if ( !settings.walk ) {
                    options.walk = function() {};
                }

                if ( options.preload ) {
                    $.vegas( 'preload', options.backgrounds );
                }
            }

            backgrounds = options.backgrounds;
            delay = options.delay;
            step = options.step;
            walk = options.walk;

            clearInterval( timer );

            if ( !backgrounds.length ) {
                return $.vegas;
            }

            var doSlideshow = function() {
                if ( step < 0 ) {
                    step = backgrounds.length - 1;
                }

                if ( step >= backgrounds.length || !backgrounds[ step - 1 ] ) {
                    step = 0;
                }

                var settings = backgrounds[ step++ ];
                settings.walk = options.walk;

                if ( typeof( settings.fade ) == 'undefined' ) {
                    settings.fade = options.fade;
                }

                if ( settings.fade > options.delay ) {
                    settings.fade = options.delay;
                }

                $.vegas( settings );
            }
            doSlideshow();

            if ( !keepPause ) {
                paused = false;

                $( 'body' ).trigger( 'vegasstart', [ $current.get(0), step - 1 ] );
            }

            if ( !paused ) {
                timer = setInterval( doSlideshow, options.delay );
            }

            return $.vegas;
        },

        // Jump to the next background in the current slideshow
        next: function() {
            var from = step;

            if ( step ) {
                $.vegas( 'slideshow', { step: step }, true );

                $( 'body' ).trigger( 'vegasnext', [ $current.get(0), step - 1, from - 1 ] );
            }

            return $.vegas;
        },

        // Jump to the previous background in the current slideshow
        previous: function() {
            var from = step;

            if ( step ) {
                $.vegas( 'slideshow', { step: step - 2 }, true );

                $( 'body' ).trigger( 'vegasprevious', [ $current.get(0), step - 1, from - 1 ] );
            }

            return $.vegas;
        },

        // Jump to a specific background in the current slideshow
        jump: function( s ) {
            var from = step;

            if ( step ) {
                $.vegas( 'slideshow', { step: s }, true );

                $( 'body' ).trigger( 'vegasjump', [ $current.get(0), step - 1, from - 1 ] );
            }

            return $.vegas;
        },

        // Stop slideshow
        stop: function() {
            var from = step;
            step = 0;
            paused = null;
            clearInterval( timer );

            $( 'body' ).trigger( 'vegasstop', [ $current.get(0), from - 1 ] );

            return $.vegas;
        },

        // Pause slideShow
        pause: function() {
            paused = true;
            clearInterval( timer );

            $( 'body' ).trigger( 'vegaspause', [ $current.get(0), step - 1 ] );

            return $.vegas;
        },

        // Get some useful values or objects
        get: function( what ) {
            if ( what == null || what == 'background' ) {
                return $current.get(0);
            }

            if ( what == 'overlay' ) {
                return $overlay.get(0);
            }

            if ( what == 'step' ) {
                return step - 1;
            }

            if ( what == 'paused' ) {
                return paused;
            }
        },

        // Preload an array of backgrounds
        preload: function( backgrounds ) {
            var cache = [];
            for( var i in backgrounds ) {
                if ( backgrounds[ i ].src ) {
                    var cacheImage = document.createElement('img');
                    cacheImage.src = backgrounds[ i ].src;
                    cache.push(cacheImage);
                }
            }

            return $.vegas;
        }
    }

    // Resize the background
    function resize( $img, settings ) {
        var options =  {
            align: 'center',
            valign: 'center'
        }
        $.extend( options, settings );

        var ww = $( window ).width(),
            wh = $( window ).height(),
            iw = $img.width(),
            ih = $img.height(),
            rw = wh / ww,
            ri = ih / iw,
            newWidth, newHeight,
            newLeft, newTop,
            properties;

        if ( rw > ri ) {
            newWidth = wh / ri;
            newHeight = wh;
        } else {
            newWidth = ww;
            newHeight = ww * ri;
        }

        properties = {
            'width': newWidth + 'px',
            'height': newHeight + 'px',
            'top': 'auto',
            'bottom': 'auto',
            'left': 'auto',
            'right': 'auto'
        }

        if ( !isNaN( parseInt( options.valign ) ) ) {
            properties[ 'top' ] = ( 0 - ( newHeight - wh ) / 100 * parseInt( options.valign ) ) + 'px';
        } else if ( options.valign == 'top' ) {
            properties[ 'top' ] = 0;
        } else if ( options.valign == 'bottom' ) {
            properties[ 'bottom' ] = 0;
        } else {
            properties[ 'top' ] = ( wh - newHeight ) / 2;
        } 

        if ( !isNaN( parseInt( options.align ) ) ) {
            properties[ 'left' ] = ( 0 - ( newWidth - ww ) / 100 * parseInt( options.align ) ) + 'px';
        } else if ( options.align == 'left' ) {
            properties[ 'left' ] = 0;
        } else if ( options.align == 'right' ) {
            properties[ 'right' ] = 0;
        } else {
            properties[ 'left' ] = ( ww - newWidth ) / 2 ;
        }

        $img.css( properties );
    }

    // Display the loading indicator
    function loading() {
        $loading.prependTo( 'body' ).fadeIn();
    }

    // Hide the loading indicator
    function loaded() {
        $loading.fadeOut( 'fast', function() {
            $( this ).remove();
        });
    }

    // Get the background image from the body
    function getBackground() {
        if ( $( 'body' ).css( 'backgroundImage' ) ) {
            return $( 'body' ).css( 'backgroundImage' ).replace( /url\("?(.*?)"?\)/i, '$1' );
        }
    }

    // The plugin
    $.vegas = function( method ) {
        if ( methods[ method ] ) {
            return methods[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ) );
        } else if ( typeof method === 'object' || !method ) {
            return methods.init.apply( this, arguments );
        } else {
            $.error( 'Method ' +  method + ' does not exist' );
        }
    };

    // Global parameters
    $.vegas.defaults = {
        background: {
            // src:         string
            // align:       string/int
            // valign:      string/int
            // fade:        int
            // loading      bool
            // load:        function
            // complete:    function
        },
        slideshow: {
            // fade:        null
            // step:        int
            // delay:       int
            // backgrounds: array
            // preload:     bool
            // walk:        function
        },
        overlay: {
            // src:         string
            // opacity:     float
        }
    }

    /*!
     * jQuery imagesLoaded plugin v1.0.3
     * http://github.com/desandro/imagesloaded
     *
     * MIT License. by Paul Irish et al.
     */
    $.fn.imagesLoadedForVegas = function( callback ) {
        var $this = this,
            $images = $this.find('img').add( $this.filter('img') ),
            len = $images.length,
            blank = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==';

        function triggerCallback() {
            callback.call( $this, $images );
        }

        function imgLoaded() {
            if ( --len <= 0 && this.src !== blank ){
                setTimeout( triggerCallback );
                $images.unbind( 'load error', imgLoaded );
            }
        }

        if ( !len ) {
            setTimeout( triggerCallback, 200 );
            // triggerCallback();
        }

        $images.bind( 'load error',  imgLoaded ).each( function() {
            // cached images don't fire load sometimes, so we reset src.
            if (this.complete || this.complete === undefined){
                var src = this.src;
                // webkit hack from http://groups.google.com/group/jquery-dev/browse_thread/thread/eee6ab7b2da50e1f
                // data uri bypasses webkit log warning (thx doug jones)
                this.src = blank;
                this.src = src;
            }
        });

        return $this;
      };
})( jQuery ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:05:50.817

编写一个 jquery 函数，随机化图像数组并返回，然后分配返回的数组

```
 { src: 'images/background4.jpg', fade: 4000 },
        { src: 'images/background3.jpg', fade: 4000 },
        { src: 'images/background2.jpg', fade: 4000 },
        { src: 'images/background1.jpg', fade: 4000 } 
```

到插件的背景选项

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T19:55:39.607

您可以使用任何 img src 参数调用插件，如下所示：

```
$( function() {
  $.vegas({
    src:'/images/background.jpg'
  });
}); 
```

只需从 PHP/Ruby/Python 或任何您的后端获取随机文件名。或者，您可以创建一个 JavaScript 数组并从中选择一个随机项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T16:42:49.737

刚刚走了一条超级简单的路线并`<?php echo rand(1,7); ?>.jpg'`在 src 中使用：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-11T10:47:30.467

如果为时已晚，我不会，但我找到了解决这个问题的方法。

**第一步创建一个随机数组的函数：**

```
function shuffle(o) {
    for(var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
    return o;
} 
```

**第二步用你的图片源和参数创建一个数组，然后使用 shuffle 函数：**

```
var vegasArray = [
    { src: "/pic1.jpg", fade: 1000},
    { src: "/pic2.jpg", fade: 1000},
    { src: "/pic3.jpg", fade: 1000},
    ...
];
shuffle(vegasArray); 
```

**最后一步将您的数组添加到 vegas 滑块参数中：**

```
$.vegas(
    'slideshow', {
        delay: 13000,
        backgrounds: vegasArray
    })(
    'overlay', {
        src: 'img/overlay.png',
        opacity: 0.9
    }); 
```

正常就可以了！希望有帮助！:)

# django - 解决 Django 的 ManyToManyField 外键限制

> ID：10964085
> 
> 赞同：3
> 
> 时间：2012-06-09T19:49:12.490
> 
> 标签：django, django-models

我有一个 Django 应用程序，它必须使用另一个来源提供的数据库。 **我无法更改架构**。以下所有内容均由 inspectdb 生成：

```
class Family(models.Model):
    persistanceid = models.BigIntegerField(primary_key=True)

class Spouseref(models.Model):
    persistanceid = models.BigIntegerField(primary_key=True)

class Family_spouseref(models.Model):
    family_persistanceid = models.ForeignKey(Family, db_column='family_persistanceid')
    wiferefs_persistanceid = models.ForeignKey(Spouseref, unique=True, null=True, db_column='wiferefs_persistanceid', blank=True, related_name='wiferefs')
    husbandrefs_persistanceid = models.ForeignKey(Spouseref, unique=True, null=True, db_column='husbandrefs_persistanceid', blank=True, related_name='husbandrefs')
    childrefs_persistanceid = models.ForeignKey(Spouseref, unique=True, null=True, db_column='childrefs_persistanceid', blank=True, related_name='childrefs') 
```

ManyToManyField 在 Family 下不起作用，因为映射表 Family_spouseref 有多个外键到 Spouseref。给定这个模式，完成这样的事情的最有效方法是什么：

```
fam = Family.objects.get(persistanceid=id)
husbands = fam.husbands.all()
wives = fam.wives.all()
children = fam.children.all() 
```

**更新：**

根据要求...以下功能是我尝试在上面的家庭模型中添加的。

我尝试了这样的原始 SQL：

```
 def husbands(self):
        return Spouseref.objects.raw ('SELECT * FROM spouseref WHERE spouseref.persistanceid IN (SELECT husbandrefs_persistanceid FROM family_spouseref WHERE family_persistanceid=%s);', [self.persistanceid]) 
```

哪个有效，但原始 SQL 真的是最好的方法吗？看起来，我以这种方式失去了很多常用的对象方法。

当我尝试通过 ORM 执行此操作时，它一直想认为 Family_spouseref 表有一个列 id，而它显然没有。

```
Family_spouseref.objects.get(family_persistanceid=self.persistanceid) 
```

出品：

```
[DEBUG] django.db.backends: (0.001) SELECT "family_spouseref"."id", "family_spouseref"."family_persistanceid", "family_spouseref"."wiferefs_persistanceid", "family_spouseref"."husbandrefs_persistanceid", "family_spouseref"."childrefs_persistanceid" FROM "family_spouseref" WHERE "family_spouseref"."family_persistanceid" = 45036  LIMIT 21; args=(45036,)
DatabaseError: column family_spouseref.id does not exist
LINE 1: SELECT "family_spouseref"."id", "family_spouseref"."family_p... 
```

我也试过：

```
Family_spouseref.objects.get(Q(family_persistanceid=self.persistanceid) | Q(husbandrefs_persistanceid__isnull=False)) 
```

这产生了相同的 ID 错误，但确实尝试遵循 FK 关系：

```
[DEBUG] django.db.backends: (0.000) SELECT "family_spouseref"."id", "family_spouseref"."family_persistanceid", "family_spouseref"."wiferefs_persistanceid", "family_spouseref"."husbandrefs_persistanceid", "family_spouseref"."childrefs_persistanceid" FROM "family_spouseref" LEFT OUTER JOIN "spouseref" ON ("family_spouseref"."husbandrefs_persistanceid" = "spouseref"."persistanceid") WHERE ("family_spouseref"."family_persistanceid" = 45036  OR "spouseref"."persistanceid" IS NOT NULL) LIMIT 21; args=(45036,)
DatabaseError: column family_spouseref.id does not exist
LINE 1: SELECT "family_spouseref"."id", "family_spouseref"."family_p... 
```

通过调试看到它调用相同（错误）语句（8 次）的频率与它调用两次的原始 SQL 相比，我也感到震惊。（仍然，两次！）

我真的很想知道遍历这些表的官方 Django 方式，而不是完全忽略 ORM 并执行原始 SQL。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T01:10:04.777

您得到的错误是因为 Django 默认将“id”字段设置为主键，如果没有字段将“primary_key=True”声明为参数（例如，您在 Family 模型中这样做）。因此，当您尝试获取模型对象时，您总是会收到如下错误：

```
DatabaseError: column family_spouseref.id does not exist 
```

首先，给该模型一个主键。我敢打赌它有一个。如果没有，也许你只是想读[这个](https://stackoverflow.com/questions/840162/should-each-and-every-table-have-a-primary-key)。现在，关于您的效率问题，您可以这样做：

```
def husbands(self):
    husbandrefs_for_family = Family_spouseref.objects.filter(
        family_persistanceid=self.persistanceid,
    ).values_list('husbandrefs_persistanceid',flat=True)

    return Spouseref.objects.filter(
        persistanceid__in=husbandrefs_for_family,
    ) 
```

尽管您似乎正在执行 2 个查询，但您会看到 Django 只执行了一个（嗯，这是一个带有子查询的查询，就像您在 SQL 中所做的那样）。

子查询的`values_list`部分用于仅带入您想要的表的列。我是您想要的 SLQ 语句的`select husbandrefs_persistanceid`一部分。

希望能帮助到你！

# html - 如何将背景图像设置为具有 colspan 的表格单元格？

> ID：10964089
> 
> 赞同：0
> 
> 时间：2012-06-09T19:49:22.443
> 
> 标签：html, css

我使用 css 为单元格设置背景，但它不适用于整个单元格。

我正在尝试将背景图像设置为 First 和 last `<TR>`，但它的显示是这样的。

我正在尝试`.first`为 first 和 last 应用类属性`<tr>`。我应该怎么做才能适用于TR？

```
 <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Untitled Document</title>
    <style type="text/css">

 .excel{
         background:url(smallimage/excel.jpg);
          background-size:24px 24px;
          background-repeat:no-repeat;
          position: relative;
           margin:3px;
           left: 2px;
            top: 1px;
        }

        td.yellostar{
        background-image: url(smallimage/yellowstar.jpg);  /* forward slash for the path */
        width: 20px; /* use you own image size; */
        height: 20px; /* use you own image size; */
        background-repeat: no-repeat;
        background-position: center;
        text-align: center;
        vertical-align: top;
        } 
        .first{
        background-image:url(smallimage/trbackgr.jpg);
        background-repeat: repeat-x;
        }

    </style>
    </head>

    <body>
    <table width="95%" border="1" cellspacing="0" cellpadding="0">
        <tr class="first">
        <th colspan="2" class="first">chapter #|chapter Name</th>
        <th>Linkage</th>
        <th>project<br/>count</th>
        <th>Task<br>count</th>
        <th>issues<br> Open/All</th>
        <th>Action</th>

      </tr>
        <tr >
        <td>05</td>
        <td><div class="excel" > &nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp<u>Chapter 5:Data of Information</div></td>
        <td class="yellostar" ></td>
        <td><p align="center">3</p></td>
        <td><p align="center">21</p>
        </td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>06</td>
        <td><div class="excel">&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp<u>Chapter 6:Data Tabels and Amortization Tabels</div></td>
        <td class="yellostar">&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>07</td>
        <td><div class="excel" >&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp<u>Chapter 7:Data consolidation,Links and Formula Auditing</div></td>
        <td class="yellostar">&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>08</td>
        <td><div class="excel" >&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp<u></td>
        <td class="yellostar">&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>09</td>
        <td><div class="excel" >&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp<u></div></td>
        <td class="yellostar">&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>10</td>
        <td><div class="excel" >&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp<u></div></td>
        <td class="yellostar">&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr class="first">

        <td colspan="7" class="first" >&nbsp;</td>
      </tr>
    </table>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:10:45.023

您可以使用伪类`:first-child`和`:last-child`. 看我的例子：[jsfiddle](http://jsfiddle.net/Vs9NK/)

但`:last-child`不是跨浏览器，IE 需要修复。

并且您在为背景[w3schools](http://www.w3schools.com/cssref/pr_background-image.asp)指定参考图像时出错。

# php - Radio Button Name and Value From MySQL Fetch Array

> ID：10964094
> 
> 赞同：0
> 
> 时间：2012-06-09T19:49:57.717
> 
> 标签：php, mysql, forms, radio-button

I want to create simple form to validate each row of mysql_fetch_array if it's a 'good' or 'bad' row below :

```
<form action="activated.php" method="post">
<tbody>                                      
<?php
while($row = mysql_fetch_array($result))
{
echo "<tr>";
echo "<td>" . $row['ID'] . "</td>";
echo "<td>" . $row['AccountName'] . "</td>";
echo "<td>" . $row['Amount'] . "</td>";
echo "<td>" . $row['TransferTo'] . "</td>";
echo "<td>" . $row['DateTransfer'] . "</td>";
echo "<td><input name=\"".$row['ID']."\" type=\"radio\" value=\"OK-".$row['ID']."\" /></td>";
echo "<td><input name=\"".$row['ID']."\" type=\"radio\" value=\"BAD-".$row['ID']."\" /></td>";
echo "</tr>"; 
}
?>
</tbody> 
</table>
<input type="submit" value="Submit" class="submit" />
</form> 
```

my question is how to manage this dynamic value of radio button's name and value on activated.php? I mean, how to get each value of radio button so I can process it. I have no problem if the name of radio button is static. but in this case it's dynamic.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T19:57:50.837

cycle through the $_POST arguments. You might want to preface the radio names with something you can specifically search for the help you, like `echo '<input type="radio" name="radio-'.$row['ID'].'"...`

You can search each key returned in `$_POST` to see which ones begin with `radio-`

# xaml - XAML ListView，如何仅在项目可见时加载图像

> ID：10964095
> 
> 赞同：0
> 
> 时间：2012-06-09T19:50:09.203
> 
> 标签：xaml, mvvm, windows-8, microsoft-metro

我的 Windows 8 Metro 应用程序中有一个 XAML 列表框，这个列表框绑定到一个可观察的集合，并且可以有数百个项目。它也有一个图像，我只想在一个项目可见时加载图像（当用户滚动到该项目时）。我怎样才能做到这一点。?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T10:02:38.033

更改 ListBox 的 ItemPanelTemplate 以放置 VirtualizedStackPanel：控件将被虚拟化，并且只有屏幕上显示的项目才会加载到内存中。

# visual-studio-2012 - Visual Studio 11 (2012) beta 到 RC？

> ID：10964098
> 
> 赞同：2
> 
> 时间：2012-06-09T19:51:07.670
> 
> 标签：visual-studio-2012

Visual Studio 11 RC 与 beta 有什么区别？11 目前正在为我工​​作（不是完美无缺但还可以），我想知道它是否值得重新安装。

我特别使用 C++ 和 C#。大约 50-50 ATM。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:35:08.943

C++ 智能感知要好得多。例如，它不再抱怨基于范围的 for 循环。在早期的测试版中，我基本上只是忽略了红色的摆动，因为它们通常是错误的，我等着看编译器对此有什么看法。我也喜欢添加到工具栏的颜色。我不关心所有大写菜单，但您可以通过注册表编辑将其关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T10:22:17.623

此外，xaml 绑定调试又回来了（在 vs 2010 下使用 silverlight 5 可能，但在 vs 11 beta silverlight 5 下不可能）。请注意，Visual Studio 2012 的嵌入式混合似乎只能在 Windows 8 下使用。但如果需要，您可以安装 Silverlight 5 的混合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T19:52:34.187

我建议升级，如果没有其他原因，VS 2012 RC 将更接近最终的 RTM 版本。

在大多数情况下，主要的变化（除了一些视觉上的刷新）似乎是一些性能和错误修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T20:03:34.373

全新安装始终是最好的方法。您可能会遇到类似的问题：[从 Visual Studio 2012 Beta 升级到 RC 后出现“Invalid License Data”](http://blogs.msdn.com/b/heaths/archive/2012/06/04/how-to-fix-invalid-license-data-after-upgrading-from-visual-studio-2012-beta-to-rc.aspx)

Visual Studio 2012 RC 比 Beta 更稳定可靠。此外，性能似乎更好。例如，安装时间比测试版少 10 分钟。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-01T11:49:48.033

[我在 Programmers: VS 11 vs VS 2012](https://softwareengineering.stackexchange.com/questions/155026/vs-11-vs-vs-2012)上问了同样的问题，但没有得到任何答案。

无论如何，我决定安装 2012 RC，据我了解，您无需先卸载 VS 11 beta 即可运行安装程序。立即运行安装。

# javascript - 从链接调用 js 方法

> ID：10964105
> 
> 赞同：0
> 
> 时间：2012-06-09T19:52:04.773
> 
> 标签：javascript, html

在我的脑海里

```
<script src="/assets/application.js?body=1" type="text/javascript"></script> 
```

在我的身体里

```
<a href="remove_fields(this)">xremove</a> 
```

在我有的js中

```
function remove_fields(link) {
  ...
} 
```

单击我得到的 xremove 链接

```
No route matches [GET] "/recipes/1/remove_fields(this)" 
```

怎么了 ？

编辑 - 为简单起见更新了问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T19:58:51.477

不要使用内联 JavaScript。这完全违背了已知的最佳实践。

改用事件处理程序：

```
<a href="#" id="link">

<script>
document.getElementById('link').onclick = function() {
    // do whatever you want
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:14:10.300

看起来 Rails 正在为您的 onclick 生成无效的 Javascript 调用。函数调用有没有参数的逗号，这意味着 Rails 试图为这些参数输入的任何数据都必须为空。

检查你的 Rails 模板，看看它试图在那里填充什么。

更新：既然你改变了你的问题，这里有一个新的答案：

您不能直接在 href 中引用 javascript。您必须在函数调用前面附加“javascript:”，否则将其放入 onclick 处理程序中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T20:14:37.647

作为上述完全有效答案的替代方案，通过首先包含 Google CDN 托管的缩小库来利用 jQuery API 的极端简化：

```
<script type="text/javascript" 
   src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script> 
```

然后就像上面一样（但 jQuery 风格），更简单的 IMO：

```
<a href="#" id="link">

<script type="text/javascript">
$("#link").click(function (event)
{    
    // Handle event here. This code will be executed whenever event is triggered
    // ie. whenever you click the element with id link
}); 
```

我是一个经验不足的 Web 程序员，对函数式/解释型语言（如 javascript）的最佳实践的了解几乎没有我在本机领域（如汇编、C++、Java）的知识。但是，当您仅比较上面给出的答案的可写性/可读性和此处的 jQuery 版本时，我可以肯定地看到为什么 jQuery 如此受欢迎，即使在微软和谷歌等大型科技公司中也是如此。如果可以的话，我会坚持下去。

[这是关于 .click() 方法](http://api.jquery.com/click/)的优秀 jQuery 文档的链接。

# python - 从python中的长字符串中删除某些字符

> ID：10964106
> 
> 赞同：1
> 
> 时间：2012-06-09T19:52:08.010
> 
> 标签：python, string

我正在做一个项目，该项目涉及获取一些源代码并将其归结为页面上显示的单词。我可以让它删除所有的html标签，以及脚本标签之间的所有东西，但我不知道如何删除所有以反斜杠开头的字符。一个页面将包含 \t、\n 和 \x**，其中 * 似乎是任何小写字母或数字。

我将如何编写一个将字符串的所有这些部分替换为空格的代码？我在 python 中工作。

例如，这是来自网页的字符串：

```
\n\t\n\t\n\t\tApple - Wikipedia, the free encyclopedia\n\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\n\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\tLanguage:English\xd8\xa7\xd9\x84\xd8\xb9\xd8\xb1\xd8\xa8\xd9\x8a\xd8\xa9Aragon\xc3\xa9sAsturianuAz\xc9\x99rbaycanca\xe0\xa6\xac\xe0\xa6\xbe\xe0\xa6\x82\xe0\xa6\xb2\xe0\xa6\xbeB\xc3\xa2n-l\xc3\xa2m-g\xc3\xbaBasa Banyumasan\xd0\x91\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x80\xd1\x83\xd1\x81\xd0\xba\xd0 
```

会成为：

```
Apple - Wikipedia, the free encyclopedia Language:English sAsturianuAz rbaycanca Basa Banyumasan 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:07:30.067

```
s = repr('''\n\t\n\t\n\t\tApple - Wikipedia, the free encyclopedia\n\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\n\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\tLanguage:English\xd8\xa7\xd9\x84\xd8\xb9\xd8\xb1\xd8\xa8\xd9\x8a\xd8\xa9Aragon\xc3\xa9sAsturianuAz\xc9\x99rbaycanca\xe0\xa6\xac\xe0\xa6\xbe\xe0\xa6\x82\xe0\xa6\xb2\xe0\xa6\xbeB\xc3\xa2n-l\xc3\xa2m-g\xc3\xbaBasa Banyumasan\xd0\x91\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x80\xd1\x83\xd1\x81\xd0\xba\xd0''')
s =  re.sub(r'\\[tn]', '', s)
s =  re.sub(r'\\x..', '', s)
print s 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T19:56:53.663

编写一个[正则表达式](http://docs.python.org/library/re.html)以匹配所有所需的模式，然后用空格替换它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T20:25:47.123

鉴于纯文本单词至少包含三个字符：

```
' '.join(re.findall(r'\w{3,}', s)) # where s represents the string 
```

或者：

```
' '.join(re.findall(r'(?:\w{3,}|-(?=\s))', s)) # in order to preserve the dash char 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T21:08:34.273

维基百科使用 UTF-8 字符串编码。要转换为纯 ASCII，您必须

1.  从 UTF-8 转换为 Unicode
2.  从 unicode 转换为 ASCII，替换不可编码的字符
3.  将不可编码字符替换转换为空格
4.  将多个空格（制表符、换行符等）转换为单个空格
5.  去除前导和尾随空格

.

```
s = "\n\t\n\t\n\t\tApple - Wikipedia, the free encyclopedia\n\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\n\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\n\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\n\t\t\tLanguage:English\xd8\xa7\xd9\x84\xd8\xb9\xd8\xb1\xd8\xa8\xd9\x8a\xd8\xa9Aragon\xc3\xa9sAsturianuAz\xc9\x99rbaycanca\xe0\xa6\xac\xe0\xa6\xbe\xe0\xa6\x82\xe0\xa6\xb2\xe0\xa6\xbeB\xc3\xa2n-l\xc3\xa2m-g\xc3\xbaBasa Banyumasan\xd0\x91\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x80\xd1\x83\xd1\x81\xd0\xba"

import re
whitespaces = re.compile('\s+', flags=re.M)
def utf8_to_ascii(s, ws=whitespaces):
    s = s.encode("utf8")
    s = s.decode("ascii", errors="replace")
    s = s.replace(u"\ufffd", " ")
    s = ws.sub(" ", s)
    return s.strip()

s = utf8_to_ascii(s) 
```

最终导致字符串

```
Apple - Wikipedia, the free encyclopedia Language:English Aragon sAsturianuAz rbaycanca B n-l m-g Basa Banyumasan 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-10T09:37:13.557

假设默认的 ascii 编码，我们可以在一行中很好地做到这一点，**没有邪恶的正则表达式 ;)**，通过迭代字符串并使用基于它们的编码值删除值`ord(i) < 128`，或者我们选择的任何规范：

```
>>> ' '.join(''.join([i if ord(i) < 128 else ' ' for i in mystring]).split())
#Output:
Apple - Wikipedia, the free encyclopedia Language:English Aragon sAsturianuAz rbaycanca B n-l m-g Basa Banyumasan 
```

或者我们可以指定一串允许的字符并使用'in'，就像这样使用内置的 `string.ascii_letters`：

```
>>> import string
>>> ' '.join(''.join([i if i in string.ascii_letters else ' ' for i in mystring]).split())
#Output:
Apple Wikipedia the free encyclopedia Language English Aragon sAsturianuAz rbaycanca B n l m g Basa Banyumasan 
```

这也删除了标点符号（但如果我们愿意，我们可以通过将这些字符重新添加到字符串检查定义中来轻松避免这种情况，`check = string.ascii_letters + ',.-:'`）

# cakephp - 如果我使用 API 来验证数据，如何保存表单？

> ID：10964108
> 
> 赞同：0
> 
> 时间：2012-06-09T19:52:15.577
> 
> 标签：cakephp, cakephp-2.1

通常，如果我使用 CakePHP 的魔法并验证表单，那么它将“保留表单”，这意味着用户不必重新输入所有内容。此外，默认情况下，CakePHP 会标记所有未通过验证的字段。我的问题是，既然我将所有的表单数据发送到一个 API，我怎样才能仍然使用 CakePHP 的所有魔法？

我研究了自定义验证方法，但问题是我必须一次将所有数据发送到 API，并且我会立即返回所有错误（计费信息）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:36:14.323

那么你做错了。默认的“蛋糕”方式是保持表单 - 甚至（或特别是）在不成功的验证之后

但是，如果没有看到实际代码，就无法告诉您更多信息。查看烘焙模板以及它是如何正确完成的。那么您的问题会立即自行解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T13:53:47.767

也许您在错误验证后从数据库中设置了 $this->request->data ？仅在 GET 请求时检索模型数据。使用博客教程中的这个：

```
public function edit($id = null) {
    $this->Post->id = $id;
    if ($this->request->is('get')) {
        $this->request->data = $this->Post->read();
    } else {
        if ($this->Post->save($this->request->data)) {
            $this->Session->setFlash('Your post has been updated.');
            $this->redirect(array('action' => 'index'));
        } else {
            $this->Session->setFlash('Unable to update your post.');
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-08T12:06:06.487

如果您只是使用 api 来测试单个字段，那么为您的模型编写一个调用该 api 方法的自定义验证器。如果您的 api 正在验证整个模型或多个字段，您可以执行

$this->Model->set($this->data); if($this-Model->validates()) { /* Call Api */ if errors /*将 $this-Model->validationErrors 设置为与蛋糕验证相同的格式。否则重定向到成功页面。}

# javascript - 我如何访问由 javascript 中的操作传递的参数？

> ID：10964112
> 
> 赞同：2
> 
> 时间：2012-06-09T19:52:41.930
> 
> 标签：javascript, struts2, dojo

我正在使用 struts2 并在执行操作后触发此代码（通过 Ajax）：

```
 dojo.event.topic.subscribe("cambioProyecto", function() {
            var hola = json_entregables;
            alert("hola");
    } 
```

*json_entregables* 变量是通过 struts2 给出的参数。我可以在jsp中访问它，没问题。但我不能在脚本中。问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T04:08:27.850

我想出了一种方法来获得我想要的东西，但它相当不干净。由于匿名函数是来自 Ajax 进程的回调函数，因此我通过为该函数定义一个参数来捕获响应。该响应是带有响应的实际 html 的字符串。

现在，要访问参数，我必须将其值包含在 jsp 中作为隐藏元素。像这样：

```
<s:hidden id="hidden_json_entregables" value="%{json_entregables}"/></p> 
```

然后，我通过 jquery 得到它，如下所示：

```
dojo.event.topic.subscribe("cambioProyecto", function(jsp) {
        var o = $(jsp)
        var string_entregables = o.find("#hidden_json_entregables").text();
} 
```

无论如何，我认为这不是一个好方法，所以我不会推荐它。但它对我有用。感谢您的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T20:14:39.780

您的匿名函数是一个回调函数。当您的 ajax 调用完成时，它由 struts2 调用。我还没有研究过struts2，但它会发送你的回调函数参数。您需要在匿名函数定义中声明这些参数，以便您可以访问它们。

因此，如果 json_entragables 是从 struts2 返回到您的回调的对象，那么您需要像这样编写回调函数：

```
dojo.event.topic.subscribe("cambioProyecto", function(json_entregables) {
        //console.log(arguments)
        var hola = json_entregables;
        alert("hola");
} 
```

当然，在这种情况下，您可以将 json_entragables 重命名为您喜欢的任何内容。如果您不确定 struts2 发送什么，您可以使用您最喜欢的调试器检查函数参数数组并查看其中的内容。

# javascript - 无法使用 highlight.js 突出显示 xml 语法

> ID：10964115
> 
> 赞同：9
> 
> 时间：2012-06-09T19:52:56.237
> 
> 标签：javascript, html, xml, syntax-highlighting

我正在尝试在 html 页面上打印 xml。

例子：

<-- 语言：lang-xml -->

```
<pre><code class="xml">
    <?xml version="1.0"?>
    <response value="ok" xml:lang="en">
        <text>Ok</text>
        <comment html_allowed="true"/>
        <ns1:description><![CDATA[
        CDATA does <not> escape <tags like="this"></tags></not>.
        ]]></ns1:description>
        <a></a> <a/>
    </response>
</code></pre> 
```

我想使用[highlight.js 突出](http://softwaremaniacs.org/soft/highlight/en/)显示页面上的代码，但与 xml 和 html 存在冲突。

我只使用了一些 php 代码取得了成功`<pre><code class="php"></code></pre>`，还没有尝试使用其他语言。我发现显示 xml 代码的唯一方法是在 textarea 中，但我更喜欢用一些甜美的语法高亮显示 xml。

我做了一个[jsfiddle 来说明这个问题](http://jsfiddle.net/wgBzW/1/)。

希望你能帮忙。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-09T20:10:42.030

当您想按字面意思显示尖括号时，您应该使用`&lt;`and转义尖括号。`&gt;`否则，您的`<code>`元素中有浏览器尝试解释的实际标记。这与应用到它的任何 JavaScript 无关。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-08T12:11:08.840

值得一提的是，[Google Prettify](https://code.google.com/p/google-code-prettify/)确实可以正确呈现 XML 块（无需将它们编码为`&lt;`.

# jquery - 重叠使用 Jquery 创建的新 Div？

> ID：10964118
> 
> 赞同：0
> 
> 时间：2012-06-09T19:53:11.837
> 
> 标签：jquery, css, html, overlap

所以......这有点像以前的同样问题。我希望它在按下一个键时创建一个新的 div。它确实创造了它，但它把它放在了背景之外。

```
function attack() {
    $("body").append("<div class='proj'></div>");
    $(".proj").css("position", "absolute");
    $(".proj").css("width", "32px");
    $(".proj").css("height", "32px");
    $(".proj").css("background-color", "#00FFFF");
    $(".proj").css("left", playerPositionLeft);
    $(".prok").css("top", playerPositionTop);
    $(".proj").css("z-index", "2");
} 
```

![在此处输入图像描述](../Images/46c259bdd0b0ace733138740c55ff3ce.png)

青色框是 .proj 但我需要它位于红色方块的位置。

希望你能帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T21:34:41.423

不要`<div class='proj'></div>`在你的`body`. 将其附加到`div`包含大图像的内容中。`position:relative`请记得添加`div`

# xquery - XQIB XQuery - 尝试“让”变量时出错

> ID：10964119
> 
> 赞同：0
> 
> 时间：2012-06-09T19:53:13.960
> 
> 标签：xquery

我的 XQuery 知识非常缺乏，但我正在尝试使用 XQIB（浏览器中的 XQuery），但即使只是设置变量错误

```
let $foo := "bar" 
```

...产生错误

```
MXQuery output the following error during compilation:
Line 1, Column 18: err:XPST0003 Error while parsing FFLWOR Expr: 'return' expected!
let $foo := "bar"    ERROR                        
Unknown.anonymous(Unknown Source) 
```

我查看了 XQIB 站点上的示例，似乎`let`那里的语句总是在子例程中，例如警报或函数。这是否表明在 XQuery 中，代码必须始终存在于某种函数中，而不是独立存在的？

例如，他们的一个例子就是这样，这当然有效：

```
b:alert(
    let $x := <a><b>2</b><c>4</c></a>
    return xs:string($x/b * $x/c)
) 
```

但是这个，我的修改版本，没有。

```
let $x := <a><b>2</b><c>4</c></a>
b:alert(
    return xs:string($x/b * $x/c)
) 
```

后者是怎么回事？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:01:37.393

您的退货位置错误：

```
let $x := <a><b>2</b><c>4</c></a>
return
    b:alert(
        xs:string($x/b * $x/c)
    ) 
```

`return`如果您使用了某些（a 的一部分）flwor 表达式，则只需要 a 。`let`开始一个，所以你需要`return`它。由于您没有一个作为参数，因此您不需要（也不允许）将 a 放在`return`这里。

# ruby-on-rails-3 - 用 Cucumber 测试 Devise+Omniauth(Facebook)

> ID：10964121
> 
> 赞同：5
> 
> 时间：2012-06-09T19:53:42.387
> 
> 标签：ruby-on-rails-3, devise, cucumber, bdd, omniauth

这是我的**特点**：

```
 Scenario: Professor is not signed up and tries to sign in with Facebook
      Given I do not exist as a professor
      When I sign in as a professor with Facebook
      Then I should see a successful sign in message
      When I return to the site
      Then I should be signed in as a professor 
```

这是步骤**定义**`When I sign in as a professor with Facebook`

```
When /^I sign in as a professor with Facebook$/ do
  set_omniauth
  visit "/professors/auth/facebook"
end 
```

这是**set_omniauth**助手的定义：

```
def set_omniauth(opts = {})
  default = {:provider => :facebook,
             :uuid     => "1234",
             :facebook => {
                            :email => "foobar@example.com",
                          }
            }

  credentials = default.merge(opts)
  provider = credentials[:provider]
  user_hash = credentials[provider]

  OmniAuth.config.test_mode = true

  OmniAuth.config.mock_auth[provider] = {
    'uid' => credentials[:uuid],
    "extra" => {
    "user_hash" => {
      "email" => user_hash[:email],
      }
    }
  }
end 
```

所以......当我访问时`/professors/auth/facebook`，这个动作被称为

```
def facebook
    @professor = Professor.find_for_facebook_oauth(request.env["omniauth.auth"], current_professor)
    if @professor.persisted?
      flash[:notice] = "Welcome! You have signed up successfully."
      sign_in_and_redirect @professor, :event => :authentication
    else
      session["devise.facebook_data"] = request.env["omniauth.auth"]
      redirect_to new_professor_registration_url
    end
  end 
```

最后，**find_for_facebook_oauth**方法的定义是：

```
def self.find_for_facebook_oauth(access_token, signed_in_resource=nil)
    data = access_token["extra"]["raw_info"]
    if professor = self.find_by_email(data.email)
      professor
    else # Create a professor with a stub password. 
      self.create(:email => data.email, :password => Devise.friendly_token[0,20]) 
    end
  end 
```

运行此功能时，我收到以下错误消息：

```
undefined method `email' for {"email"=>"foobar@example.com"}:Hash (NoMethodError) 
```

所以，我检查了 Facebook 实际返回的内容：

```
#<Hashie::Mash email="myemail@gmail.com" ... 
```

但这是一个与普通哈希集不同的对象：

```
OmniAuth.config.mock_auth[provider] = {
    'uid' => credentials[:uuid],
    "extra" => {
    "user_hash" => {
      "email" => user_hash[:email],
      }
    } 
```

所以，我的问题是： **我将如何正确测试这个？** 我遵循[了 OmniAuth Integration Tetsing](https://github.com/intridea/omniauth/wiki/Integration-Testing)，他们设置了一个 Hash，而不是一个 Hashie。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-29T19:38:07.667

您需要使用内置的 OmniAuth 方法来创建 Hash，以创建 Hashie 对象：

```
OmniAuth.config.mock_auth[provider] = OmniAuth::AuthHash.new({
'uid' => credentials[:uuid],
"extra" => {
"user_hash" => {
  "email" => user_hash[:email],
  }
}) 
```

# php - 全文搜索，没有结果？

> ID：10964124
> 
> 赞同：0
> 
> 时间：2012-06-09T19:54:22.943
> 
> 标签：php, mysql, algorithm, codeigniter, search

我正在尝试通过使用 和 来实现`match`数据库`against`搜索`fulltext indexing`。因此，当我进行搜索时，它没有按预期工作，没有错误，也没有给出任何结果。我正在使用 Codeigniter 进行查询。

这是我的 PHP 查询代码：

```
$clean_keyword = trim($keywords); //$keyword is passed to the function`
$this->db->select('question, answer')
         ->from('QA')
         ->where('MATCH(question) AGAINST("'.$clean_keyword.'")', null, FALSE);  
$query = $this->db->get(); //execute the previous statement and save the result in a variable. 
```

没有给出来自 codeigniter/MySQL 的错误。

我尝试`$query`通过做来调试变量`var_dump($query)`，看看结果（*注意重要的部分是`result_array`with`size=0`*）：

```
object(CI_DB_mysql_result)[19]
  public 'conn_id' => resource(30, mysql link persistent)
  public 'result_id' => resource(38, mysql result)
  public 'result_array' => 
    array (size=0)
      empty
  public 'result_object' => 
    array (size=0)
      empty
  public 'custom_result_object' => 
    array (size=0)
      empty
  public 'current_row' => int 0
  public 'num_rows' => int 0
  public 'row_data' => null 
```

MySQL 表架构：

```
CREATE TABLE `QA` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `question` varchar(200) CHARACTER SET utf8 NOT NULL,
  `answer` varchar(500) CHARACTER SET utf8 NOT NULL,
  `u_id` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  FULLTEXT KEY `question` (`question`)
) ENGINE=MyISAM 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T05:27:32.477

我的代码/数据库架构或任何东西都没有错误，我刚刚意识到`FULLTEXT search`不显示仅包含 1 个单词的匹配项，例如：
如果我查询这个：
`SELECT * FROM QA WHERE MATCH(question) AGAINST('drive');`
并且有一个问题与单词`drive`ONLY，我将没有匹配项。
但是，如果我将`drive`问题列更改为类似`how to drive`ill get a match。

# ruby - 解析谷歌地图api时无法将字符串转换为整数

> ID：10964126
> 
> 赞同：0
> 
> 时间：2012-06-09T19:54:46.930
> 
> 标签：ruby, string, google-maps

我正在尝试按照[http://ruby.bastardsbook.com/chapters/methods-and-gems/获取特定位置的纬度和经度](http://ruby.bastardsbook.com/chapters/methods-and-gems/)

```
Here is the snippet:
require 'rubygems'
require 'rest-client'
require 'crack'

def get_coordinates_from_address(addr)
   base_google_url = "http://maps.googleapis.com/maps/api/geocode/xml?sensor=false&address="
   res = RestClient.get(URI.encode("#{base_google_url}#{addr}"))
   parsed_res = Crack::XML.parse(res)
   lat = parsed_res["GeocodeResponse"]["result"]["geometry"]["location"]["lat"]
   lng = parsed_res["GeocodeResponse"]["result"]["geometry"]["location"]["lng"]

   return "#{lat}, #{lng}"
end      

latlng = get_coordinates_from_address("1 Times Square, NYC")
puts latlng 
```

我得到以下堆栈跟踪：

```
/Users/archie/agile/latlang.rb:9:in `[]': can't convert String into Integer (TypeError)
    from /Users/archie/agile/latlang.rb:9:in `get_coordinates_from_address'
    from /Users/archie/agile/latlang.rb:15:in `<main>'
[Finished] 
```

可能的问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:13:24.347

我想我知道。[XML](http://maps.googleapis.com/maps/api/geocode/xml?address=1%20Times%20Square,%20NYC&sensor=false)有几个`result`s，所以`parsed_res["GeocodeResponse"]["result"]`实际上是一个数组。我真的不知道 Ruby 或破解，但我的直觉是你需要解决一个结果的索引（通常第一个结果是最好的，所以使用 0），然后写类似

```
parsed_res["GeocodeResponse"]["result"][0]["geometry"]["location"]["lat"] 
```

或许

```
firstResult = parsed_res["GeocodeResponse"]["result"][0]
lat = firstResult["geometry"]["location"]["lat"] 
```

^(我的符号可能是错误的，对不起！)

# c - 对单链表进行排序 - 我不明白

> ID：10964129
> 
> 赞同：1
> 
> 时间：2012-06-09T19:55:33.983
> 
> 标签：c, linked-list

[我正在查看来自http://publications.gbdirect.co.uk/c_book/chapter6/structures.html](http://publications.gbdirect.co.uk/c_book/chapter6/structures.html)的示例 6.7

（为了方便贴在这里）

```
struct list_ele *
sortfun( struct list_ele *list )
{

      int exchange;
      struct list_ele *nextp, *thisp, dummy;

      /*
       * Algorithm is this:
       * Repeatedly scan list.
       * If two list items are out of order,
       * link them in the other way round.
       * Stop if a full pass is made and no
       * exchanges are required.
       * The whole business is confused by
       * working one element behind the
       * first one of interest.
       * This is because of the simple mechanics of
       * linking and unlinking elements.
       */

      dummy.pointer = list;
      do{
              exchange = 0;
              thisp = &dummy;
              while( (nextp = thisp->pointer)
                      && nextp->pointer){
                      if(nextp->data < nextp->pointer->data){
                              /* exchange */
                              exchange = 1;
                              thisp->pointer = nextp->pointer;
                              nextp->pointer =
                                      thisp->pointer->pointer;
                              thisp->pointer->pointer = nextp;
                      }
                      thisp = thisp->pointer;
              }
      }while(exchange);

      return(dummy.pointer);
} 
```

我明白了基本的想法，但我无法真正解释那里发生了什么。有人可以更深入但以简单的方式解释该排序功能中发生了什么吗？

一般的一些问题：

*   为什么`dummy.pointer = list;`需要？`dummy`然后在函数末尾返回，为什么列表仍然排序？
*   评论`The whole business is confused by working one element behind the first one of interest.`是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:09:48.443

该算法通过列表查看每个列表项及其之后的项。如果它们出现故障，它们就会被调换。然后重复该过程。最终不会有任何不合适的地方，也没有任何东西被转换；到那时所有的工作都完成了（如`exchanged`保持为零所示）。换句话说，最后一次通过列表，没有任何东西可以互换。

dummy 用于跟踪列表本身（以防前 2 个列表项被切换）。它被使用（而不仅仅是一个简单的指向列表的指针，因为它也可以用作假的第一项，以便可以比较列表中的原始第一项。它消除了对结果列表的特殊情况的需要第一项与原始列表的第一项不同。

在纸上列出 1、2、3 和 4 个项目。然后你会看到它是如何工作的。当您完成它时，请尝试将列表按顺序排列并运行算法。然后交换列表中的 2 个项目，然后再做一次。

关于整个业务被混淆的评论，恕我直言，您必须跟踪单链表中的 3 个节点才能交换其中两个节点。如果列表中有 ACB 项（目标是列表为 ABC），当您交换 B 和 C 时，您还必须有权访问 A - 它的“下一个节点”指针必须从 C 更改为 B。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T20:06:34.263

`dummy`是一个局部变量，首先设置为列表的开头。临时变量`thisp`被设置为指向`dummy`，所以当它被更新时，指向的内容`dummy`也会被更新。因此，`dummy.pointer`最终将指向作为排序列表新开始的元素。 `list`仍将指向列表的原始开头，因此返回值以便可以更新头指针。

我认为他们混淆的意思是我们感兴趣的元素是`nextp`，而不是当前元素（或`thisp`）。也就是说，我们将列表中的下一个元素与当前元素进行比较，而不是将当前元素与前一个元素进行比较。我想这很*令人困惑*，但我真的不这么认为。

注意：这是[冒泡排序](http://en.wikipedia.org/wiki/Bubble_sort)。更好的排序算法是[Merge Sort ，在](http://en.wikipedia.org/wiki/Merge_sort)[http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html](http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html)上有一个实现。

# android - 如何抑制丢失的图标密度 lint 警告？

> ID：10964131
> 
> 赞同：3
> 
> 时间：2012-06-09T19:55:39.030
> 
> 标签：android, lint

当我包含一个没有不同密度版本的图标时，我会收到一个 lint 警告。也就是说，如果我`myIcon.png`在 drawable-mdpi 目录中添加一个图标 ， lint 会抱怨我`myIcon.png`在其他可绘制目录（drawable-hdpi、-xhdpi、-xxhdpi）中没有版本。

我想禁止此警告，无论是针对所有图标，还是专门针对`myIcon.png`.

`lint-config.xml`为了实现这些抑制，我需要添加什么语法？

示例`lint-config.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<lint>
  <issue id="MissingTranslation" severity="ignore" />
</lint> 
```

`lint-config.xml`in `build.gradle`（在我的 Android 手机中）的用法：

```
android {
    lintOptions {
        lintConfig file("lint-config.xml")
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-06-29T20:19:20.343

创建一个包含以下内容的 lint.xml：

```
<!-- Ignore the IconDensities issue in the given files -->
<issue id="IconDensities">
    <ignore path="**/res/drawable-mdpi/myIcon.png"/>
    <ignore path="**/res/drawable-hdpi/myIcon.png"/>
    <ignore path="**/res/drawable-xhdpi/myIcon.png"/>
    <ignore path="**/res/drawable-xxhdpi/myIcon.png"/>
</issue> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T20:08:29.957

请参阅此链接以了解图形设计师：

[http://developer.android.com/design/style/devices-displays.html](http://developer.android.com/design/style/devices-displays.html)

简而言之，他们建议创建多个图像，每个密度一个，以便在每个可能的密度上看起来都很完美（没有像素化或模糊）。

尺寸应如下：

*   ldpi - 原始图像大小的 75%
*   mdpi - 原始图像大小的 100%
*   hdpi - 原始图像大小的 150%
*   xhdpi - 原始图像大小的 200%

# c - 计算32位int的阶乘（模素数）比C中的O（n）更快？

> ID：10964139
> 
> 赞同：0
> 
> 时间：2012-06-09T19:56:35.380
> 
> 标签：c, algorithm, math

> **可能重复：**
> [计算 n 的快速方法！mod m 其中 m 是素数？](https://stackoverflow.com/questions/9727962/fast-way-to-calculate-n-mod-m-where-m-is-prime)

让：

```
int k = 99999989; 
```

`k`是一个素数。

给定一些 (32-bit) `int x`，我们要计算 x 阶乘 mod k。(x! % k)

一种方法如下：

```
int factmk(int x)
{
    long long t = 1;

    for (long long i = 2; i <= x; i++)
    {
         t *= i;
         t %= k;
    }

    return (int)t;
}; 
```

这需要 O(x) 时间和 O(1) 空间。

`factmk`在小于或等于 O(logx) 的空间中，是否有一种渐近更快的方法可以在直接 C 中实现？如果是，那是什么？如果没有，草图证明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:07:59.503

这不是一般的答案，但作为一种特殊情况，如果`x = k-1`，您可以使用[威尔逊定理](http://en.wikipedia.org/wiki/Wilson%27s_theorem)

```
(x)! = -1 mod k 
```

或者

```
(p-1)! = -1 mod p 
```

# navigation - 如何正确格式化航点 jquery 以实现粘性导航而没有“跳跃”下的内容？

> ID：10964140
> 
> 赞同：0
> 
> 时间：2012-06-09T19:56:45.240
> 
> 标签：navigation, sticky, jquery-waypoints

这是html和脚本。想出了如何让粘性导航标题正常工作，但是当我尝试将 if/else 语句合并到脚本中以防止在通过航点后内容“跳跃”时出现问题

```
 <div id="wrapper2">
        <!-- Header -->  
        <div id="top_header"></div> 
             <div id="header_nav">
                 <div id="header">
                <a id="header_logo" href="{$link->getPageLink('index.php')}" title="{$shop_name|escape:'htmlall':'UTF-8'}">
                    <img class="logo" src="{$img_dir}DOMS4SQRwht.png?{$img_update_time}" alt="{$shop_name|escape:'htmlall':'UTF-8'}" />
                </a>
                    <div id="header_right">
                    {$HOOK_TOP}
                    </div> 
                 </div>
             </div>

        <script type="text/javascript" src="{$js_dir}jquery-1.7.2.min.js"></script>
        <script type="text/javascript" src="{$js_dir}waypoints.min.js"></script>
        <script type="text/javascript">

        $(document).ready(function() {
            $('.top').addClass('hidden');
            $.waypoints.settings.scrollThrottle = 30;
            $('#wrapper2').waypoint(function(event, direction) {
                $('.top').toggleClass('hidden', direction === "up");
            }, {
                offset: '-100%'
            }).find('#header_nav').waypoint(function(event, direction) {
                $(this).parent().toggleClass('sticky', direction === "down");
                event.stopPropagation();
        if (direction == 'down')
          nav_container.css({ 'height':nav.outerHeight() });
        else
          nav_container.css({ 'height':'100%' });

            });
        });

        </script>

    Here's the CSS

        div#header {width:100%;margin-left:auto;margin-right:auto;height:49px;border-bottom:2px solid #ffffff;no-repeat;zoom:1;z-index:9999;background: url(../img/bg_meshdot.png)rgba(255,255,255,0.2);background-repeat:repeat;display:inline-block;}
        .sticky #header_nav {width:100%;position: fixed;top:0;margin-top:0;margin-bottom:0;box-shadow:0 0 7px rgba(0,0,0,.5);z-index:9;}
        div#top_header {width:100%;height:51px;display:inline-block;background: url(../img/bg_meshdot.png)rgba(255,255,255,0.2);position:relative;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T21:12:56.690

Note: This isn't perfect.

I was able to achieve something roughly the same with this.

```
$('div.checklist').waypoint({
    handler: function(event, direction) {
      var name = ".checklist";
      var menuYloc;
      var offset;
      $(window).scroll(function () {
        if(direction === "down"){
          menuYloc = 48;
        }else if(direction === "up"){
          menuYloc = 106;
        }
        offset = menuYloc+$(document).scrollTop()+"px";
        $(name).animate({top:offset},{duration:500,queue:false});
        event.stopPropagation();
      });
      event.stopPropagation();
    },
    offset: 45,
    scrollThrottle : 30
  }); 
```

There is a small bug where going up doesn't always refresh. I'm not entirely certain what is causing it. But the menu will be sticky enough. I borrowed some of this from [Nettuts](http://net.tutsplus.com/tutorials/html-css-techniques/creating-a-floating-html-menu-using-jquery-and-css/).

# c++ - 使已经绘制的内容透明？

> ID：10964141
> 
> 赞同：1
> 
> 时间：2012-06-09T19:56:49.977
> 
> 标签：c++, winapi, gdi+, transparency

我正在完成 Connect 4 游戏的最后一个。我想让图块实际下拉而不是只出现在插槽中，但是存在 z 排序问题。

为了绘制我的场景，我首先为电路板画了一个矩形，然后用背景颜色在上面画出一些洞。问题是瓷砖没有空间。我试过先画瓷砖。它掉下来了，但是你在洞后面看不到它，因为它们是在我的瓷砖上用纯黑色画在纯黄色上的。我不能在黑色之后画它，但也不能在黄色之前画，因为黄色是先画的。这是一张漂亮的图片：

![棋盘。](../Images/c001a8ff71e98e8d72c5a243a45010da.png)

我有一些解决方案的可能性，但每个都有问题：

1.  使用已经切出孔的电路板位图。

    *   我可以画瓷砖，然后用透明键画出形状奇特的框架。
    *   或类似的东西实际上会`StretchBlt`拉伸电路板以在不同的分辨率下看起来相同，包括不同的纵横比（我的意思是水平和垂直缩放以使每次都具有相同的比例）？参考图片，无论分辨率如何，它都适合这样的窗口。
2.  逐像素检查并检查要绘制的内容。

    *   这很简单，但是会不会很慢？我听说通过每个像素可能不会，但还没有在任何地方真正验证过。
3.  （我认为效果最好的那个） - 画板，但不是顶部的黑洞，而是使板在这些区域透明。

    *   这是最少的工作量，在效率方面应该没问题，但我该怎么做呢？

这些解决方案（尤其是第三种）是否合理？有没有一种简单的方法来解决这个 z 顺序问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T04:17:32.617

似乎最“正确”的方法（不一定是最好的方法）是填充一个带有孔的矩形形状，而不是稍后添加孔。

如果您使用 GDI 或 GDI+，您可以通过创建一个包含矩形和其中所有圆圈的路径，然后填充该路径来完成此操作。

要在 gdi32 中执行此操作，请调用 BeginPath，使用 Rectangle 和 Ellipse 函数将形状添加到路径中，然后调用 EndPath 来完成它。使用 SetPolyFillMode 将 HDC 设置为 ALTERNATE 模式。在 HDC 中选择适当的画笔，然后调用 FillPath。

在 GDI+ 中，以交替模式构建路径，使用 GraphicsPath::AddRectangle 和 GraphicsPath::AddEllipse 添加形状，并使用 Graphics::FillPath 填充它。

（您可以使用缠绕模式而不是交替模式来执行此操作，但是您必须小心在路径中形成形状的线条是顺时针还是逆时针。）

# google-apps-script - “范围”的谷歌应用程序脚本函数“breakApart”和“mergeAcross”有什么作用

> ID：10964147
> 
> 赞同：0
> 
> 时间：2012-06-09T19:57:28.430
> 
> 标签：google-apps-script

我在developers.google.com 上阅读“范围”对象的文档。对于函数“breakApart”，它说：

“再次将范围内的任何多列单元格分解为单个单元格。”

它说它返回一个“范围”对象。

我对它的作用感到困惑。我在文档中找不到“单元格”对象定义。所以我对它的作用感到困惑。

我说“另见mergeAcross”。这也不清楚。它指向“breakApart”。

有人用过这两个功能吗？他们做了哪些改变？它们如何影响返回的“范围”？我可以查看他们是采用一个“数组”范围并将它们组合成一个范围还是采用一个范围并返回一个范围数组。但它没有暗示这一点，因为它说它需要一个范围并返回一个范围。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:18:24.567

在下面的示例中，单元格 B3 C3 B4 和 C4 被合并，这意味着它们在电子表格中显示为块 C6 D6 也被合并。在脚本中，您可以定义一系列单元格，例如 C6:D6 并像这样合并它：

```
function myFunction() {
   var sh = SpreadsheetApp.getActiveSheet();
   sh.getRange('C6:D6').mergeAcross();
} 
```

结果将是您在 C6:D6 上看到的。breakApart 是精确的对称动作，只需在此示例函数中尝试一下，您将再次获得 2 个单元格... ![细胞筛盖](../Images/8012fa3e7ac03577f923ae993bb58a50.png)

如果其中一个单元格中存在任何值，则合并块中显示的值将是左上角单元格的值。

# design-patterns - 成对的类层次结构

> ID：10964148
> 
> 赞同：1
> 
> 时间：2012-06-09T19:57:43.493
> 
> 标签：design-patterns

有没有一个结构看起来像这样的设计模式。B 拥有对 A 的引用，并且还使用 A 做一些工作。此外，层次结构 B 中的每个子类都依赖于层次结构 A 中的子类来完成其工作。它的代码看起来像[https://codereview.stackexchange.com/questions/12412/two-related-hierarchies-of-classes](https://codereview.stackexchange.com/questions/12412/two-related-hierarchies-of-classes)

![在此处输入图像描述](../Images/b76f202813b2b67338625dc9d7d4dbc1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:22:32.657

这是一种并行继承层次结构，更常见的是被视为一种反模式。

[Ward 的 Wiki](http://c2.com/cgi/wiki?ParallelInheritanceHierarchies)和[Lambda the Ultimate](http://lambda-the-ultimate.org/node/1621)上对此进行了一些讨论，可能值得一读。

# ios - 尝试使用正交投影绘制正方形并遇到问题

> ID：10964153
> 
> 赞同：1
> 
> 时间：2012-06-09T19:58:25.217
> 
> 标签：ios, opengl-es, glkit

我在 iPhone 上运行此代码，并使用 Apple 为矩阵提供的 GLKit。在 iPhone 上，我只有一个灰色的屏幕，但我应该在角落有一个方形绘图，但它没有显示出来。

我没有看到我所做的有任何问题，并且调用 OpenGL 的 getError 返回 GL_NO_ERROR。

我的来源：

*   [视图控制器.m](http://pastebin.com/Bg3AxRqW)

*   [顶点着色器](http://pastebin.com/MPftvHFf)

*   [片段着色器](http://pastebin.com/kVjZs8Cy)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:21:13.000

那里有很多代码要处理，尽管我看到一个潜在的问题，就是你错过了对[`glEnableVertexAttribArray`](http://www.opengl.org/sdk/docs/man/xhtml/glEnableVertexAttribArray.xml).

你需要类似的东西：

```
glEnableVertexAttribArray(attributes[ATTRIB_VERTEX]); 
```

在您致电之前`glDrawElements`。不确定是否还有其他错误，但这是我看到的唯一内容。

# c# - DocumentOpen Word 事件不起作用

> ID：10964156
> 
> 赞同：0
> 
> 时间：2012-06-09T19:59:13.993
> 
> 标签：c#, events, ms-word

我有从我的 C# 应用程序打开一个 doc 文件的代码：

```
var wordApp = new Microsoft.Office.Interop.Word.Application();
wordApp.Documents.Open(FileName);
wordApp.Visible = true;
wordApp.ActiveWindow.View.FullScreen = true;
var events = (Microsoft.Office.Interop.Word.ApplicationEvents4_Event) wordApp;
events.DocumentOpen += delegate { MessageBox.Show("opended!"); };
events.Quit += delegate { MessageBox.Show("closed!"); }; 
```

但是文件打开了，我没有得到`MessageBox.Show("opended!")`但`MessageBox.Show("closed!")`工作正常。如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T20:11:02.463

因为您是在文档已经打开**之后**`DocumentOpen`附加事件，所以没有理由调用它。

 **`Quit`有效，因为，当它连接时，你还没有**退出。**`WordApplication`

`DocumentOpen`在调用打开文档之前附加这两个事件。**

# javascript - 对于正文中的每个元素类型

> ID：10964163
> 
> 赞同：20
> 
> 时间：2012-06-09T19:59:49.633
> 
> 标签：javascript, dom

例如

```
For each div in body
          div.innerHtml = "poo"
next div 
```

这显然是伪代码，但演示了我正在尝试做的事情。

* * *

编辑分享它让我非常高兴看到 9 岁的问题，看看我已经走了多远，这个问题仍然有益于其他人。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-06-09T20:00:59.210

```
var elements = document.getElementsByTagName('div');

for (var i = 0; i < elements.length; i++) {
    elements[i].innerHTML = "foo";
}​ 
```

[**现场演示**](http://jsfiddle.net/pyGhg/)

如果您只想查看`<body>`：

```
var elements = document.body.getElementsByTagName('div');

for (var i = 0; i < elements.length; i++) {
    elements[i].innerHTML = "foo";
}​ 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2015-09-19T04:52:57.633

**NodeList.forEach** ![铬图标](../Images/70fbda8432976a1dd0921cc93e1b2436.png) ![火狐图标](../Images/ac0576f7c2dd34af636afc39ca9dafa4.png) ![边缘图标](../Images/f0e7a63067aed7456857782c232fbe9b.png) ![歌剧图标](../Images/74b06d29e2f3e01db7250e89d7af5415.png) ![Safari 图标](../Images/d81296c649e1f4d4e82b3ab4867b5cdb.png)^(**10**)

`querySelectorAll`返回一个静态的非实时`NodeList`暴露`forEach`方法：

```
const elements = document.querySelectorAll('div');

elements.forEach( el => {
  el.innerHTML = "foo";
}); 
```

[Document.querySelectorAll ^(*MDN*)](https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll)
[NodeList.prototype.forEach() ^(*MDN*)](https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach)

* * *

**Array.from** ![铬图标](../Images/70fbda8432976a1dd0921cc93e1b2436.png) ![火狐图标](../Images/ac0576f7c2dd34af636afc39ca9dafa4.png) ![边缘图标](../Images/f0e7a63067aed7456857782c232fbe9b.png) ![歌剧图标](../Images/74b06d29e2f3e01db7250e89d7af5415.png) ![Safari 图标](../Images/d81296c649e1f4d4e82b3ab4867b5cdb.png)^(**9**)

```
const elements = document.querySelectorAll('div');

Array.from(elements).forEach( (el) => {
  el.innerHTML = "foo";
}); 
```

[Array.from() ^(*MDN*)](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/from)

* * *

**数组解构** ![铬图标](../Images/70fbda8432976a1dd0921cc93e1b2436.png) ![火狐图标](../Images/ac0576f7c2dd34af636afc39ca9dafa4.png) ![边缘图标](../Images/f0e7a63067aed7456857782c232fbe9b.png) ![歌剧图标](../Images/74b06d29e2f3e01db7250e89d7af5415.png) ![Safari 图标](../Images/d81296c649e1f4d4e82b3ab4867b5cdb.png)^(**9**)

```
const elements = document.querySelectorAll('div');

[...elements].forEach( el => {
  el.innerHTML = "foo";
}); 
```

[解构赋值^(*MDN*)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)
[Document.querySelectorAll() ^(*MDN*)](https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll)

* * *

**数组 forEach.call** ![铬图标](../Images/70fbda8432976a1dd0921cc93e1b2436.png) ![火狐图标](../Images/ac0576f7c2dd34af636afc39ca9dafa4.png) ![边缘图标](../Images/f0e7a63067aed7456857782c232fbe9b.png) ![IExplor 图标](../Images/3435ae0864a8bd748742df0a8bacfed7.png)^(**9**) ![歌剧图标](../Images/74b06d29e2f3e01db7250e89d7af5415.png) ![Safari 图标](../Images/d81296c649e1f4d4e82b3ab4867b5cdb.png)

```
var elements = document.querySelectorAll('div');

[].forEach.call(elements, function( el ) {
  el.innerHTML = "foo";
}); 
```

[Array.prototype.forEach() ^(*MDN*)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach)

* * *

**循环**

```
var elements = document.getElementsByTagName('div');

for (var i=0; i<elements.length; i++) {
  elements[i].innerHTML = "foo";
} 
```

[Element.getElementsByTagName() ^(*MDN*)](https://developer.mozilla.org/en-US/docs/Web/API/Element/getElementsByTagName)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-02-22T12:20:57.637

轻松的工作：

```
NodeList.prototype.forEach = HTMLCollection.prototype.forEach = Array.prototype.forEach; 
```

现在：

```
// VanillaJS / JavaScript puro
var lista_de_divs = document.querySelectorAll('div')
lista_de_divs.forEach(function (div, i) {
    // código...
    console.log(i, div)
})

// jQuery
$('div').forEach(function (div, i) {
    // código...
    console.log(i, div)
}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-23T19:56:11.217

ES2015 中具有新[`Array.from()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from)方法和[箭头函数的替代版本：](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)

```
Array.from(document.body.getElementsByTagName("div")).forEach(a=>a.innerHTML='foo');
```

```
<div></div>
<div></div>
<div>Test</div>
<div></div>
<div>Hello</div>
<div>World</div>
```

如果大小对您来说绝对至关重要，那么这个解决方案只有 84 个字节，而 @Roko 的答案为 113 字节，@gdoron 的答案为 120 字节。

在这种情况下，jQuery 可以进一步缩短：

```
$("body div").html('foo');
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<div></div>
<div></div>
<div>Test</div>
<div></div>
<div>Hello</div>
<div>World</div>
```

现在只有 26 个字节！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-02T09:13:02.603

对于 ES6

```
let elements = document.body.getElementsByTagName('div');

Array.prototype.forEach.call(elements, e => {
  e.innerHTML = "foo";
}); 
```

# php - 表格只显示一页，其他都不显示

> ID：10964165
> 
> 赞同：0
> 
> 时间：2012-06-09T19:59:52.077
> 
> 标签：php, html, forms

我现在有一个令我困惑的问题。我有一个用于在页面上发布帖子和上传图片的表单。该页面根据从数据库中检索到的用户填充不同的用户信息。该表单适用于一个配置文件，但不会显示在任何其他配置文件上，这让我感到困惑为什么会发生这种情况。这是表格：

```
<form enctype="multipart/form-data" name='newPost-<?=$username?>' method='post' action='utilities/newWallPost.php'>
    < textarea name="postText"></textarea>
    < br />
    < input type='file' id='upload' name='upload[]' multiple=""/>
    < input type='hidden' name='recipient' value='<?=$username?>'/>
    < input type='submit' value='Post' name='btn_upload'/>
    < /div>
    < div id="newPost">
        < a href="#" id="newPostLink">Create new post</a>
< /form> 
```

有没有人有什么建议？起初我认为这是表单的命名约定，所以我将其设置为将用户名附加到表单名称，但由于某种原因它仍然没有显示。

编辑：附加信息，当我尝试在未显示实际表单标签的配置文件上提交表单（显示其输入）时，系统尝试访问同一页面（而不是实用程序/wallNewWallPost .php）。奇怪的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:08:44.887

我将您输入的上述代码复制到一个新的 .html 文档中，但该表单未显示。

我相信由于标签中的空格，表格无法正常工作。

所以我稍微修改了一下，它对我有用： [link here](http://codepad.org/PSdUq4t4)

# java - 在 MVC 框架中应该在哪里进行日志记录？

> ID：10964169
> 
> 赞同：0
> 
> 时间：2012-06-09T20:00:04.707
> 
> 标签：java, model-view-controller, logging

我一直在做，或者至少在尝试做控制器内的所有日志记录。但是日志记录应该真正发生在哪里，特别是如果日志记录涉及服务器端和客户端日志记录端点？

注意：这不是家庭作业。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:03:30.800

记录应该发生在您正在尝试记录的地方。如果您正在运行查询，请在您的 DAO 类中添加日志记录。

看看[Logging in Java 和一般情况：最佳实践？](https://stackoverflow.com/questions/906233/logging-in-java-and-in-general-best-practices)一些最佳实践。

# css - 水平滚动页面上 100% 宽度的图像

> ID：10964170
> 
> 赞同：5
> 
> 时间：2012-06-09T20:00:05.123
> 
> 标签：css, image, width, horizontal-scrolling

我正在尝试为照片故事制作页面 - 它旨在水平滚动，但我也希望图像缩放到 100% 的高度和自动宽度（所以没有裁剪）。水平滚动和 100% 高度/自动宽度没有问题。但我无法正确间隔图像 - 它们一直重叠。见：http: [//i.imgur.com/nzOon.jpg](http://i.imgur.com/nzOon.jpg)

这可能吗？多年来一直在这方面工作，但我的想法已经不多了。

谢谢！

JS：

```
<script type="text/javascript" charset="utf-8">
    $(function(){
            $(".image").wrap("<td>");
    });
</script> 
```

CSS：

```
.image {
position:absolute;
width:auto;
height:100%;
} 
```

HTML：

```
<div id="page-wrap">
         <div class="image">
              <img src="images/Betty-001.jpg" id="image-contents" />  
         </div>

         <div class="image" style="margin-left:75%;">
               <img src="images/Betty-001.jpg" id="image-contents" />  
         </div>             
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T20:32:06.210

如果您允许，HTML 将为您完成滚动和图像宽度。

演示：http: [//jsfiddle.net/ThinkingStiff/sVa7S/](http://jsfiddle.net/ThinkingStiff/sVa7S/)

HTML：

```
<div id="scroll">
       <img src="http://thinkingstiff.com/images/priorities.png" /><!--
    --><img src="http://thinkingstiff.com/images/priorities.png" />
</div> 
```

CSS：

```
#scroll {
    height: 100%;
    overflow-x: scroll;    
    white-space: nowrap;
    width: 100%;
}

#scroll img {
    height: 100%;
    vertical-align: top;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:12:10.120

您可以使用以下 CSS：

```
html, body {
    width: 100%;
    height: 100%;
}

div {
    width: 100%;
    height: 100%;
    position: absolute;
    background-size: 100% 100%;
    background-repeat: no-repeat;
}

#image1 {
    background-image: url('image1');
}
#image2 {
    left: 100%;
    background-image: url('image2');
}
#image3 {
    left: 200%;
    background-image: url('image3');
}
#image4 {
    left: 300%;
    background-image: url('image4');
}​ 
```

使用 100% 宽度和 100% 高度的背景图像。

[你可以在这里](http://jsfiddle.net/WWUcD/5/)看到它工作的一个活生生的例子

# java - 使用从 URLConnection 读取的值的 Java If 语句不起作用

> ID：10964171
> 
> 赞同：0
> 
> 时间：2012-06-09T20:00:26.727
> 
> 标签：java, post, if-statement, urlconnection

我不知道为什么，但是当我使用 URLConnection 向 url 发送 http post 请求时，我可以很好地返回，但是当我在 if 语句中使用它时，它停止工作。该程序可以编译所有这些，但是如果我要使用它向包含 的网页发送 http 请求`yes`，并且我使用的代码`if(answer.toString == "yes")`它不会执行 if 部分中的代码。我知道这可能与行分隔符等有关，但谁能指出我如何解决它。

用于获取变量的代码`answer`：

```
String data="param1=test1&param2=test2";
try{
  URL lUrl=new URL("http://localhost/test.php");
  URLConnection conn=lUrl.openConnection();
  conn.setDoOutput(true);
  OutputStreamWriter writer=new OutputStreamWriter(conn.getOutputStream());
  writer.write(data);
  writer.flush();
  StringBuffer answer=new StringBuffer();
  BufferedReader reader=new BufferedReader(new InputStreamReader(conn.getInputStream()));
  String line;
  while((line=reader.readLine())!=null){
    answer.append(line);
  }
  writer.close();
  reader.close();
  if(answer.toString()=="yes"){
    System.out.print("1");
  }else{
    System.out.print(answer.toString());
  }
}catch(MalformedURLException ex){
  ex.printStackTrace();
}catch(IOException ex){
  ex.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:02:41.300

要比较 java 字符串，请使用`equals`方法，而不是`==`.

因为 == 只能检测两个字符串是否是同一个实例，而不是它们是否包含相同的值。

所以你的测试应该是：

```
if ("yes".equals(answer)) { 
```

请注意，我将“是”写为 equals 方法的接收者，因为`answer.equals("yes")`当答案为 null 时，写入会导致 NullPointerException。在这种情况下，没有答案为空的风险，但这是一个好习惯。

# python - Python / 解析：BeautifulSoup 错误“模块 obj 不可调用”，结果来自 Mechanize

> ID：10964172
> 
> 赞同：1
> 
> 时间：2012-06-09T20:00:36.243
> 
> 标签：python, beautifulsoup, mechanize

BeautifulSoup 和我没有认识到`br.response().read()`. 我已经导入 BeautifulSoup

```
#snippet:
# Select the first (index zero) form
br.select_form(nr=0)
br.form.set_all_readonly(False)
br['__EVENTTARGET'] = list_of_dates[0]
br['__EVENTARGUMENT'] = 'calMain'
br['__VIEWSTATE'] = viewstate
br['__EVENTVALIDATION'] = eventvalidation

response = br.submit()
print br.response().read() #*#this prints the html I'm expecting*

soup = BeautifulSoup(br.response().read()) #*#but this throws 
#TypeError: 'module' object is not callable.  
#Yet if I call soup = BeautifulSoup("http://page.com"), it's cool.*

selecttable = soup.find('table',{'id':"tblItems"})
#/snippet 
```

... 等等

所以我觉得我有错误的“对象”，但是，BeautifulSoup 想要什么样的“对象”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T20:08:07.977

利用

```
from BeautifulSoup import BeautifulSoup 
```

代替

```
import BeautifulSoup 
```

否则我认为你做的是对的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:15:43.993

你写了：

```
response = br.submit()
print br.response().read() #*#this prints the html I'm expecting*

soup = BeautifulSoup(br.response().read()) 
```

你为什么不试试：

```
response = br.submit()
soup = BeautifulSoup(response.read()) 
```

我怀疑这与您正在调用的事实`.read()`有关`br.response()`，在我使用 mechanize 的历史中，我总是保存`response()`到一个变量并`.read()`从那里调用。我不知道它会起作用，也不能完全解释为什么`print br.response().read()`起作用，但试一试。

或者，BeautifulSoup 的 HTML 解析器可能不喜欢提供它的机械化。您可以尝试使用[不同的解析器](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#installing-a-parser)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T21:19:47.673

您是否尝试过只读取一次对象然后保存结果。

例如：

```
raw = br.response().read()

soup = BeautifulSoup(raw) 
```

使用文件对象，您可以读取它们一次，然后必须重新打开它们才能再次读取。看起来您正在阅读它们两次。您应该做的另一件事是在阅读前后打印 br.response 的类型签名。

为了更容易调试，请尝试打印类型签名：

```
print type(response) # see the type of response from above
raw = br.response().read()
print type(raw)
print type(br.response().read()) # see what happens the second time :P 
```

此外，如果您也发布堆栈跟踪也会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T20:08:47.913

只需确认您的导入是这样的：

```
from BeautifulSoup import BeautifulSoup 
```

或 BeautifulSoup4

```
from bs4 import BeautifulSoup 
```

# mysql - mysql：如何删除字段开头或结尾的字符

> ID：10964173
> 
> 赞同：24
> 
> 时间：2012-06-09T20:00:48.043
> 
> 标签：mysql, replace

我有一个包含逗号分隔列表的字段。一些旧记录在字段的开头或结尾有逗号。我需要删除这些额外的逗号。

例子：

`,the,their,then`到`the,their,then`

或者

`the,their,then,`到`the,their,then`

编辑：我正在寻找一个 UPDATE 语句。我需要更改记录。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-09T20:06:18.913

检查[这个](http://www.mydigitallife.info/remove-or-trim-first-or-last-few-characters-in-mysql-database-with-sql/)网站

```
SELECT TRIM(TRAILING 'xyz' FROM 'barxxyz'); 
```

在你的情况下是 ',' 而不是 'xyz'

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2015-12-02T17:49:19.913

@codingbiz，感谢您提供网站链接：

快速示例：

```
SELECT TRIM(BOTH ',' FROM fieldname) from tablename

SELECT TRIM(LEADING ',' FROM fieldname) from tablename

SELECT TRIM(TRAILING ',' FROM fieldname) from tablename 
```

谢谢！

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2016-08-10T16:31:18.637

问题是如何删除前导和尾随字符我将向您展示一个更新查询的示例。

```
UPDATE your_table_name
SET your_record_name = TRIM(BOTH ',' FROM your_record_name) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-09T20:07:16.557

您正在寻找[`TRIM`功能](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_trim)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-04-07T15:50:07.310

为避免其他表受到影响，您应该使用 where 子句。这些只会更新带有尾随'，'的行

```
UPDATE table_name 
set field_name = TRIM(TRAILING ',' FROM field_name)
WHERE field_name LIKE '%,'; 
```

不放置 where 子句会影响我的空值行并使它们为空字符串

# c# - HTTPWebRequest 和 CookieContainer

> ID：10964177
> 
> 赞同：0
> 
> 时间：2012-06-09T20:01:02.453
> 
> 标签：c#, .net, windows

我创建了一个新的 HTTPWebRequest，但我无法为其分配 CookieContainer，这怎么可能？

```
CookieContainer = new CookieContainer();

//Create a WebRequest to get the file
HttpWebRequest fileReq = (HttpWebRequest)HttpWebRequest.Create(@"http://www.example.com/file.zip); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T20:23:53.470

下面是一个使用 CookieContainer 的简单示例

```
 public static void Main(string[] args)
        {   
            if (args == null || args.Length != 1)
            {
                Console.WriteLine("Specify the URL to receive the request.");
                Environment.Exit(1);
            }
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(args[0]);
            request.CookieContainer = new CookieContainer();

            HttpWebResponse response = (HttpWebResponse) request.GetResponse();

            // Print the properties of each cookie.
            foreach (Cookie cook in response.Cookies)
            {                    
                // Show the string representation of the cookie.
                Console.WriteLine ("String: {0}", cook.ToString());
            }
        } 
```

# c# - 部分灰度的 ColorMatrix

> ID：10964179
> 
> 赞同：1
> 
> 时间：2012-06-09T20:01:20.937
> 
> 标签：c#, gdi+

所以我正在使用我在网上找到的东西的变体将图像转换为灰度。我希望能够“淡化为灰色”，即逐渐淡化颜色，这样我就可以从全色到部分着色到纯灰色。

```
public static ColorMatrix ColorMatrixForGrayScale = new ColorMatrix(new[] {
                             new[] {.3f, .3f, .3f, 0, 0},
                             new[] {.59f, .59f, .59f, 0, 0},
                             new[] {.11f, .11f, .11f, 0, 0},
                             new float[] {0, 0, 0, 1, 0},
                             new float[] {0, 0, 0, 0, 1} });

    public static Bitmap MakeGrayscale(Image original, int percent = 100)
    {
        ColorMatrix matrix = GetMatrix(percent); // returns a variation of the above.

        //create a blank bitmap the same size as original
        var newBitmap = new Bitmap(original.Width, original.Height);

        //get a graphics object from the new image
        var g = System.Drawing.Graphics.FromImage(newBitmap);

        //create some image attributes
        var attributes = new ImageAttributes();

        //set the color matrix attribute
        attributes.SetColorMatrix(matrix);

        //draw the original image on the new image
        //using the grayscale color matrix
        g.DrawImage(original, new Rectangle(0, 0, original.Width, original.Height),
           0, 0, original.Width, original.Height, GraphicsUnit.Pixel, attributes);

        //dispose the Graphics object
        g.Dispose();
        return newBitmap;
    } 
```

所以问题是两个部分。首先，我可以为此使用矩阵吗？如果是，我有什么不同，如果不是，什么是可行的方法？我正在考虑创建全灰度，然后将其与彩色图像合并（以某种方式）。

谢谢

编辑：原文[开启代码](http://www.switchonthecode.com/tutorials/csharp-tutorial-convert-a-color-image-to-grayscale)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T08:22:44.187

[要更改饱和度，在http://www.codeproject.com/Tips/78995/Image-colour-manipulation-with-ColorMatrix](http://www.codeproject.com/Tips/78995/Image-colour-manipulation-with-ColorMatrix)上有一篇有趣的文章

# debugging - 节点在ubuntu中没有响应？

> ID：10964184
> 
> 赞同：-2
> 
> 时间：2012-06-09T20:02:01.607
> 
> 标签：debugging, node.js

我已经在 ubuntu 上安装了 nodejs。

```
username@username-VirtualBox:~$ cd node
username@username-VirtualBox:~/node$ node app.js 
```

如果我在我的代码中犯了错误，那么它会向我响应错误，但是当我的代码正在运行时，它不会响应我任何东西。就像人们已经表明“在 127.0.0.1230 上运行”一样。

我怎样才能让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T06:50:52.307

Here is an app.js that will show `running on 127.0.0.1230`:

```
console.log( 'running on 127.0.0.1230' ); 
```

When you run it like this: `node app.js`, you get `running on 127.0.0.1230`.

`console.log` logs something to the console.

# python - 使用 python 子进程将 SQLite 的输出通过管道传输到 7-zip

> ID：10964189
> 
> 赞同：0
> 
> 时间：2012-06-09T20:03:01.453
> 
> 标签：python, sqlite, subprocess

我正在尝试使用 Python 将 SQLite 数据库转储到 7-zip 存档中（在 Windows 下）。我有以下代码：

```
import os
import subprocess
DatabaseName = os.path.join('C:\\','Database.sqlite')
ArchiveName = os.path.join('C:\\','temp.7z')
FileName = 'trial.txt'
command = 'sqlite3 %s < C:\\\\SQLite3\\DumpToSTDout.txt | 7z a %s -si%s' % (DatabaseName, ArchiveName, FileName)
print command
DumpProc = subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
DumpProc.wait()
print DumpProc.stdout.read()
print DumpProc.stderr.read() 
```

C:\Sqlite3\DumpToStdout.txt 是一个文本文件，第一行是“.output stdout”，第二行是“.dump”。

当我运行此代码时，我收到以下错误：

```
sqlite3: Error: too many options: "C:\\SQLite3\DumpToSTDout.txt"
Use -help for a list of options. 
```

但是，如果我使用打印的命令并直接在命令窗口中运行它，它就会正确运行。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:04:52.650

由于您使用的是特定于 shell 的字符（`<`和`|`），因此您需要`shell=True`在`Popen()`调用中运行命令。

# ruby-on-rails-3 - 在 Rails 中找不到图像的路径

> ID：10964199
> 
> 赞同：0
> 
> 时间：2012-06-09T20:04:15.980
> 
> 标签：ruby-on-rails-3

我有点困惑，我通过 css 显示图像它工作正常。但是当我使用视图显示图像时，它不会显示。以下是我正在使用的简单代码。但是我找不到问题所在！

新的.html.erb

```
<h1>Users#new</h1>
<p>Find me in app/views/users/new.html.erb</p>
<img src='close.png'> 
```

我在控制台中收到此错误：

```
ActionController::RoutingError (No route matches [GET] "/users/close.png"):
  actionpack (3.2.3) lib/action_dispatch/middleware/debug_exceptions.rb:21:in `call'
  actionpack (3.2.3) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  railties (3.2.3) lib/rails/rack/logger.rb:26:in `call_app'
  railties (3.2.3) lib/rails/rack/logger.rb:16:in `call' 
```

这是项目的目录图像：

![在此处输入图像描述](../Images/7e41a3e2a3b418e8dcfcf3746203a401.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:07:41.840

使用辅助方法会更容易[`image_tag`](http://api.rubyonrails.org/classes/ActionView/Helpers/AssetTagHelper.html#method-i-image_tag)- 只要您将图像存储在资产管道期望的位置（您是），这将自动为您放入正确的 src 路径。例如

```
<%= image_tag 'close.png' %> 
```

# java - Android - 删除 JSONObject

> ID：10964203
> 
> 赞同：0
> 
> 时间：2012-06-09T20:04:52.923
> 
> 标签：java, android, json

我一直在搜索谷歌并实施不同的方法来尝试让它工作，但我似乎无法从内存中删除一个键-> 值。我想要实现的是，如果服务器发生某些事情（例如服务器重新启动），而不是当您向服务器发出请求时，它会以网络错误的形式返回。如果我停止服务器，发出请求，它会很好地工作。但是，如果我启动服务器，发出请求并收到良好的结果，然后杀死服务器并返回，它仍然保留以前的结果，所以它没有看到问题。希望这足够清楚。我的代码的一个例子是：

```
 JSONObject json;
  json = MF.geoLocal(address, city, state, postal);
        try {
              if(json == null || json.isNull("status")){
                    PopIt(getString(R.string.alert_network_error));
              } else {
                    if(json.getString("status").equals("OK")){
                          address = json.getString("address");
                          city = json.getString("city");
                          county = json.getString("county");
                          state = json.getString("state");
                          postal = json.getString("postal");
                          lat = json.getString("latitude");
                          lon = json.getString("longitude");
                          db.open();
                          String method = (db.isDatabaseSet())? "update" : "insert";
                          db.addUser(method, email, fname, mname, lname, address, apt, city, county, state, postal, lat, lon, phone, mobile, dob, gender);
                          db.close();
                    }
              }
        } 
```

geoLocat 的类是：

```
public JSONObject geoLocal(String address, String city, String state, String postal){
    JSONObject json = null;
    List<NameValuePair> params = new ArrayList<NameValuePair>();
    params.add(new BasicNameValuePair("address", address));
    params.add(new BasicNameValuePair("city", city));
    params.add(new BasicNameValuePair("state", state));
    params.add(new BasicNameValuePair("postal", postal));
    json = jsonParser.getJSONFromUrl(geoURL, params);
    return json;
} 
```

解析这些请求的类是：

```
static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

// constructor
public JSONParser() {

}

public JSONObject getJSONFromUrl(String url, List<NameValuePair> params) {

    // Making HTTP request
    try {
        // defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);
        httpPost.setEntity(new UrlEncodedFormEntity(params));

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        is = httpEntity.getContent();

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        json = sb.toString();
        Log.e("JSON", json);
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

} 
```

任何帮助将不胜感激，这已经困扰我好几天了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:31:22.460

好吧，如果其他人遇到同样的问题，请改为关注

```
static InputStream is = null;
static JSONObject jObj = null;
static String json = ""; 
```

到

```
InputStream is = null;
JSONObject jObj = null;
String json = ""; 
```

将解决信息未保存到内存中的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T09:08:35.277

## 静态成员变量每个类有1个，并且被类的所有对象共享。即使它的对象消失了，这个数据也保存在静态成员中，对于类的新创建的对象也是一样的。

例如：

```
 InputStream is = null;
  JSONObject jObj = null;
  String json = null; 
```

# ruby-on-rails - rails中的单表继承和has_many

> ID：10964207
> 
> 赞同：1
> 
> 时间：2012-06-09T20:05:39.677
> 
> 标签：ruby-on-rails, has-many, single-table-inheritance

我正在为有趣的人制作一个简单的金融应用程序。我使用单表继承对贷方和借方进行建模，两者都继承自交易。但是，每笔交易都属于一个用户：

```
class Transaction < ActiveRecord::Base
  belongs_to :user
end

class Debit < Transaction
end

class Credit < Transaction
end 
```

我可以为贷方和借方创建单独的控制器并执行以下操作：

```
@debit = current_user.debits.build(params[:debit])
...
@credit = current_user.credits.build(params[:credit])
... 
```

但是用户没有借方或贷方的方法，只有交易。或者，我可以定义一个事务控制器：

```
@transaction = current_user.transactions.build(params[:transactions]) 
```

但是类型为空，如果它受到大规模分配的保护，我应该如何设置它？无论哪种方式，它都有点咸菜。除了泡菜味道很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:55:22.897

您可以通过执行以下操作显式设置第二个示例中的事务类型：

```
@transaction = current_user.transactions.build(params[:transactions])
@transaction.type = "Debit"
@transaction.save 
```

唯一的问题是 @transaction 实例变量在保存并重新加载到不同的变量之前不会是借记类型。

# python-2.7 - 在计算机上轻松安装、Setuptools 和手动安装 Python 2.7.3：尝试升级 Trac

> ID：10964215
> 
> 赞同：0
> 
> 时间：2012-06-09T20:06:42.657
> 
> 标签：python-2.7, trac, setuptools, easy-install

我在服务器上工作，我在为 python 2.7.3 安装“easy-install”模块时遇到问题

这很不寻常，这就是我来找你们的原因（在互联网上找不到任何解决方案）

此服务器是 debian 2.6.32。租用它的公司可能有自己的软件包回购，因为当我尝试

```
apt-get install python 
```

我能得到的只是2.6版本。我手动安装了python。（为了完成安装，在 .bashrc 文件的末尾，我添加了以下行：

```
PATH=~/python/bin:$PATH 
```

我也安装了 python-setuptools。

当我尝试安装easy-install时，我从“locate easy_install”开始，它给了我以下输出：

```
/usr/bin/easy_install
/usr/share/pyshared/easy_install.py
/usr/share/pyshared/setuptools/command/easy_install.py
/usr/share/pyshared/setuptools/command/easy_install.pyc
/usr/share/pyshared/setuptools/tests/test_easy_install.py 
```

我试图安装它，但它没有工作。我可以通过以下命令使用“pyshared”中的那个：

```
python /usr/share/pyshared/easy_install.py trac 
```

但它不会比我试过的 Trac 0.11.70 更好：

```
python /usr/share/pyshared/easy_install.py --upgrade Trac==0.12 
```

正如 Trac 的文档中所建议的那样，但我收到“错误：无法识别的存档类型：/tmp/easy_install-t9u9P5/Trac-0.12.tar.gz”

trac 的手动安装不起作用：“ImportError：没有名为 setuptools 的模块”。当我尝试安装它（下载 .egg 文件）时，它的安装崩溃：`"zipimport.ZipImportError: can't decompress data; zlib not available".` “apt-get install zlib-bin”显示 zlib 已经安装。

哦，当我尝试以下操作时：

python easy_install.py 安装

（在上面的“setuptools/command”目录中），我得到：

```
Traceback (most recent call last):
  File "easy_install.py", line 15, in <module>
    from setuptools import Command, _dont_write_bytecode
ImportError: No module named setuptools 
```

所以看起来我几乎搞砸了......我尝试了我能找到的所有东西，但似乎我的电脑无法检测到某些包裹。可能是因为我手动安装了 python 2.7（apt-get install python 显示已经安装了 python 2.6）

有谁知道为什么它似乎不起作用以及我应该怎么做才能使它起作用？

非常感谢你 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T21:49:55.477

解决此问题： Traceback（最近一次调用最后一次）：文件“easy_install.py”，第 15 行，in from setuptools import 命令，_dont_write_bytecode ImportError: No module named setuptools

由于缺少python setuptools，你可以在这里下载setuptools 0.6c11： [https ://pypi.python.org/pypi/setuptools/0.6c11#downloads](https://pypi.python.org/pypi/setuptools/0.6c11#downloads)

并通过“python setup.py install”进行设置。然后你可以设置其他插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T13:07:27.857

Debian stable 6.0.x`Squeeze`支持 Python 2.5、2.6（默认）以及 3.0，因此您最初的立场不一定正确。这可能是分发本机软件包。到现在为止，即使使用 Python2.5 for Trac 也很好。顺便说一句，您对更高版本的 Python 有什么要求？

无论如何，如果您需要它，请尝试`python-virtualenv`更好地与 virtualenvwrapper 结合使用，并在虚拟环境中滚动您自己的库。弄乱系统范围内安装的库会导致你......，你已经注意到了。

仍然可以通过符号链接包含它来重新使用已经安装的 Python 内容。我通过[另一个 SO question找到了一个](https://stackoverflow.com/questions/4830670)[很好的指南](http://codersbuffet.blogspot.com/2009/09/mercurial-subversion-and-virtualenv.html)，我在自己的开发设置中取得了成功，以便在现成的虚拟环境中拥有不同版本的 Python、Trac 和 Trac 插件组合。

# objective-c - 使用 ARC 保留/释放让我放慢了速度

> ID：10964224
> 
> 赞同：4
> 
> 时间：2012-06-09T20:07:31.713
> 
> 标签：objective-c, automatic-ref-counting

我在我的 iOS 应用程序中使用 ARC。我已经介绍了下面的方法，尽管该算法非常幼稚和浪费，但 77% 的时间都花在了`objc_retain`和`objc_release`. 我认为它必须归结为我从中获取一个单元的行，`NSArray`并且 ARC 每次都小心地保留然后释放对象。

我正在寻找一个明智的建议：我如何优雅地修复它？

```
-(CGFloat)getUncertaintyForUnits:(NSArray*)units Position:(MKMapPoint)position Zoom:(MKZoomScale)zoomScale {

    CGFloat closest = MAXFLOAT; 

    for (int i = 0; i < [units count]; i++) {
        Unit *units = (Unit*)[units objectAtIndex:i];

        CGFloat distance = [self distanceBetweenMapPoints:unit.mapPoint And:position];

        if (distance < closest) {
            closest = distance;
        }
    }

    CGFloat max = 100 / zoomScale;
    return  (1\. - closest / max) * 0.9;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-09T20:15:47.457

你可以尝试[快速枚举](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/objectivec/Chapters/ocFastEnumeration.html)：

```
for (Unit *unit in units) {
    CGFloat distance = [self distanceBetweenMapPoints:unit.mapPoint And:position];
    if (distance < closest) {
        closest = distance;
    }
} 
```

这应该避免额外的保留/释放，因为在快速枚举中整个数组都被阻塞了。

> 使用快速枚举有几个优点：
> 
> *   例如，枚举比直接使用 NSEnumerator 更有效。
> *   语法简洁。
> *   枚举是“安全的”——枚举器有一个突变保护，因此如果您在枚举期间尝试修改集合，则会引发异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T21:00:12.440

除非您出于某种原因需要内存管理对象，否则一种更快的替代方法是将您的位置点存储在常规 C 数组（或结构数组）中。

Objective C 是常规 ANSI C 的超集。有时，OOP 超集构造的好处不超过对象运行时消息传递和内部循环管理的成本。

# matlab - 如何将图像转换为字符段？

> ID：10964226
> 
> 赞同：16
> 
> 时间：2012-06-09T20:07:36.730
> 
> 标签：matlab, opencv, computer-vision, ocr, image-segmentation

通常在 OCR 的过程中，图像文件本质上是被切割成段，每个字符都被识别为一个段。例如，![未分段的文本作为图像](../Images/52653965344687b7f08a318ab618cec9.png)

必须转换为类似的东西 ![文本已被分割并准备好进行 OCR 的图像](../Images/9dc4af78e15ec6948def55900073fdd3.png)

此外，是否有任何针对亚洲语言（如泰卢固语）的算法可用于此目的？如果没有，这对英语是怎么做的？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-06-10T16:51:46.340

使用 OpenCV 可以轻松完成。下面是一个示例代码：

```
import cv2
import numpy as np

# Load the image
img = cv2.imread('sof.png')

# convert to grayscale
gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)

# smooth the image to avoid noises
gray = cv2.medianBlur(gray,5)

# Apply adaptive threshold
thresh = cv2.adaptiveThreshold(gray,255,1,1,11,2)
thresh_color = cv2.cvtColor(thresh,cv2.COLOR_GRAY2BGR)

# apply some dilation and erosion to join the gaps
thresh = cv2.dilate(thresh,None,iterations = 3)
thresh = cv2.erode(thresh,None,iterations = 2)

# Find the contours
contours,hierarchy = cv2.findContours(thresh,cv2.RETR_LIST,cv2.CHAIN_APPROX_SIMPLE)

# For each contour, find the bounding rectangle and draw it
for cnt in contours:
    x,y,w,h = cv2.boundingRect(cnt)
    cv2.rectangle(img,(x,y),(x+w,y+h),(0,255,0),2)
    cv2.rectangle(thresh_color,(x,y),(x+w,y+h),(0,255,0),2)

# Finally show the image
cv2.imshow('img',img)
cv2.imshow('res',thresh_color)
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

输出将如下所示：

![在此处输入图像描述](../Images/988bbd24510f3ab627a6852babb113f4.png)![在此处输入图像描述](../Images/4a63e37fd3c274341735b7fb8bc48872.png)

# php - WebSocket Server PHP Chrome 意外压缩帧

> ID：10964227
> 
> 赞同：0
> 
> 时间：2012-06-09T20:07:43.743
> 
> 标签：php, google-chrome, compression, websocket

成功握手后，我尝试根据最新协议向 Chrome 发送消息。我以纯文本形式发送未屏蔽，未编码，并且未**用**`chr(0)`or包围`chr(255)`。第一条消息发送得很好，谷歌浏览器没有关闭连接（虽然它没有触发`onmessage`-event，但是当我发送第二条消息时，`Received unexpected compressed frame`发生-error并且连接被终止。为什么会这样，我该怎么办修理它？

编辑：我的猜测是我需要预先添加某种操作码，例如文本操作码`%x1`（无论它是什么意思，但它用 PHP 表示）并附加另一个操作码，用于消息结束。

编辑：最奇怪的事情发生了：我再次尝试了另一个问题的代码，但停用了 base64 编码：

```
private static function encode($text) {

    // $text = base64_encode($text);

    // 0x1 text frame (FIN + opcode)
    $b1 = 0x80 | (0x1 & 0x0f);
    $length = strlen($text);

    if ($length <= 125)
        $header = pack('CC', $b1, $length);
    elseif ($length > 125 && $length < 65536)
        $header = pack('CCn', $b1, 126, $length);
    else
        $header = pack('CCN', $b1, 127, $length);

    return $header . $text;

} 
```

现在它起作用了？！尽管编码应该无关紧要，因为无论如何它都在描述之后。不过，我不会抱怨。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T08:33:54.393

握手后消息不会以纯文本形式发送。有关详细信息，请参阅规范的[数据框架](https://www.rfc-editor.org/rfc/rfc6455#section-5.2)部分。或者查看[最近的问题](https://stackoverflow.com/questions/10805023/websocket-client-doesnt-receive-data)，了解如何编写 php 服务器的想法。（请注意，该问题中的代码已发布，因为它不太有效。您需要应用答案中建议的更改。）

编辑：请参阅规范的第 5.1 节。客户端必须屏蔽它的消息；服务器不能屏蔽它发送的消息。您可以尝试从服务器中删除掩码吗？

# asp.net - asp:HyperLink 未在浏览器上呈现

> ID：10964231
> 
> 赞同：2
> 
> 时间：2012-06-09T20:08:12.243
> 
> 标签：asp.net, html, visual-studio-2010, dom, asp.net-webcontrol

大家好，我遇到了这个奇怪的问题，`asp:HyperLink`控件没有在浏览器中呈现，它甚至不存在于发送到浏览器的最终 HTML 中。

**Home.aspx Asp.net 标记**

```
<div class="LoginBox">
    <div id="LoginViewBox" runat="server">
          <asp:HyperLink ID="linkLogout" runat="server" OnClick="LogOut"></asp:HyperLink>
    </div>
</div> 
```

**浏览器中的 Home.aspx**

```
<div class="LoginBox">
  <div id="ctl00_HeadHolder_LoginViewBox">&nbsp;Welcome&nbsp;owaisBhai&nbsp;
  </div>
</div> 
```

**主页.aspx.cs**

```
 protected void Page_Load(object sender, EventArgs e)
    {
       if(!IsPostBack)
       {
           LoginBoxManager.PopulateLoginBox(ref LoginViewBox, ref linkLogout);
       }
    } 
```

**登录框管理器.cs**

```
 public static class LoginBoxManager
{
    public static void PopulateLoginBox(ref HtmlGenericControl loginViewBox, ref HyperLink linkLogout)
    {
        string LogInUrl = "Login.aspx";
        string WelcomeGuest = String.Format("&nbsp;Welcome Guest&nbsp;<a href='{0}'>[LogIn]</a>", LogInUrl);
        string WelcomeUser = "";

        if (HttpContext.Current.Session.Count == 0)
        {
            //user not authenticated
            loginViewBox.InnerHtml = WelcomeGuest;
        }
        else
        {
            //user authenticated
            WelcomeUser = 
            String.Format("&nbsp;Welcome&nbsp; {0}&nbsp;"
                                ,SmartSession<User>.LiveSession.UserName);
            loginViewBox.InnerHtml = WelcomeUser;
            linkLogout.Text = "[LogOut]";
        }
    }
} 
```

**PS：**我想我已经很好地解释了情况，让我知道任何细节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:21:28.473

您的代码正在用文本替换 asp:HyperLink。问题行是这一行：

```
loginViewBox.InnerHtml = WelcomeGuest; 
```

通过设置 InnerHtml 属性，您将替换将出现在 LoginViewBox div 中的 HTML。

而不是这种方法，我建议在 div 中添加一个标签。这将为您提供以下最终结构：

```
<div id="LoginViewBox">
      <asp:Label ID="LoginLabel" runat="server"/>
      <asp:HyperLink ID="linkLogout" runat="server" OnClick="LogOut"></asp:HyperLink>
</div> 
```

（自从我直接完成 ASP.NET 以来已经有一段时间了，所以标签控件可能需要更多的属性）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:19:58.843

您似乎没有在`linkLogout.NavigateUrl`任何地方设置该属性。尝试设置。

# cordova - 如何在 Sencha Architect 2 中为 onTap 处理程序添加 phonegap 回调

> ID：10964232
> 
> 赞同：0
> 
> 时间：2012-06-09T20:08:18.083
> 
> 标签：cordova, sencha-touch-2, sencha-architect

我能够在没有 mac 的情况下从我的电脑上制作一个完整的 iphone 应用程序，在 iphone 上运行得很好。

我使用 openSSL 创建了认证和配置，使用 sencha Architect 试用版创建了应用程序，然后将 app.html 复制到 index.html，将其全部上传到 phonegap-build 网站，瞧，我得到了一个工作应用程序（它是一个复杂的应用程序) 在 Android 和 iphone 上运行。

但是，当我想为 phonegap 联系人添加代码时，我需要添加回调代码。我正在寻找一种快速的方法来检查我的 phonegap 联系人是否正常工作...... onKb1ButtonTapped 按钮（我对按钮的点击处理程序的名称）如下所示：

```
 options = new ContactFindOptions();
 //options.filter="bob"  'nothing will return if you don't have a bob.
 options.multiple=True;
 fields = ["displayName", "name"];
 navigator.contacts.find(fields, onContactsFound, onContactsError, options); 
```

现在我需要添加 onContactsFound 和 onContactsError 代码。

**我在 Architect2 的何处/如何执行此操作？**

**如果我们已经在讨论，如何使用数据存储和代理将联系人读入我的列表？**

在 Architect 中可用的存储和代理中，最相关的似乎是 REST 代理（需要重写哪些操作，调用新的创建读取更新和删除函数）**对吗？**

并且内存存储似乎是最好的存储（但我不确定 - 这是否意味着我将丢失 phonegap 返回的联系人对象，或者我应该使用模型，并且存储中返回的模型数组会丢失?

并且...最后但并非最不重要的一点是，Sencha 原生（包装）联系人对象何时需要？

Sencha，感谢您的出色工作！我喜欢你的产品。
和Phonegap的人一样！

摩西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T12:46:21.563

问题是 Sencha Architect 中的右大括号位于事件处理程序内部。

好的，我现在知道了两种方法：

一个。从这里回答 [http://www.sencha.com/learn/a-sencha-touch-mvc-application-with-phonegap/](http://www.sencha.com/learn/a-sencha-touch-mvc-application-with-phonegap/)

我可以使用内联函数。

而不是写：

```
 options = new ContactFindOptions();
 //options.filter="bob"  'nothing will return if you don't have a bob.
 options.multiple=True;
 fields = ["displayName", "name"];
 navigator.contacts.find(fields, onContactsFound, onContactsError, options); 
```

我只是使用这样的东西

```
 options = new ContactFindOptions();
 //options.filter="bob"  'nothing will return if you don't have a bob.
 options.multiple=True;
 fields = ["displayName", "name"];
 navigator.contacts.find(fields, 
      function(contacts){
            // do here whatever needed with contacts
      }, 
      function(contactsError){
            // do here whatever you want with error
      , options); 
```

=========

另一个选项是在 Architect 中转到控制器文件（您可能通过将事件绑定添加到按钮来创建该文件，然后将其转换为操作）并在那里覆盖代码。然后在覆盖代码中，在 main 方法之后添加您想要的任何内容。

# javascript - 在 Stackoverflow 上的关闭弹出窗口中插入指向欺骗的链接

> ID：10964236
> 
> 赞同：4
> 
> 时间：2012-06-09T20:08:40.500
> 
> 标签：javascript, jquery

我正在编写一些代码以在 SO close 问题弹出窗口中插入指向欺骗的链接：

![像骗子一样关闭](../Images/64ffa784b52690ab408f26269ef88b9b.png)

当您在文本框中手动插入指向问题的链接时，会发生一些 JS 启动并获取属于 URL 的问题的情况。但是，当我将使用 javascript（Chrome 扩展程序）的 URL 插入文本框时，SO javascript 永远不会启动以检索问题。我用来插入受骗者 URL 的代码是：

```
$(document).on('click', '.cvhelper-dupelist li', function() {
  var url = $('a', this).attr('href');
  var $dupeBox = $('#duplicate-question');

  $dupeBox.val(url);
}); 
```

上面的代码成功地将链接插入到文本框中，但是由于某种原因，SO javascript 永远不会启动来检索问题。

我还尝试了以下方法，可能会迫使它无济于事：

```
$dupeBox.change(); 
```

和

```
$dupeBox.keyup(); 
```

要测试正在发生的事情，您可以打开一个随机问题的关闭作为欺骗弹出窗口（如上）并运行：

```
$('#duplicate-question').val('http://stackoverflow.com/questions/8028957/headers-already-sent-by-php'); 
```

在浏览器控制台中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:57:22.987

我想我想出了一种方法，但它相当脆弱：

```
$dupeBox.data('events').keydown[1].handler({keyCode: 13}) 
```

这会触发该元素的第二个 keydown 事件处理程序。并为存根事件对象提供一个 keyCode。

**更新**

找到了更好的方法：

你可以构造一个[jQuery.Event](http://api.jquery.com/category/events/event-object/)对象：

```
var e = jQuery.Event("keydown", { keyCode: 64 }); 
```

并使用此对象触发事件：

```
$dupeBox.trigger(e) 
```

问题是 SO 代码检查了事件对象中是否有东西：

```
e(d).keydown(c).bind("paste", null, function(a) {
  a.which || c(this)
}) 
```

# linux - 如何在linux下添加posix hooks？

> ID：10964240
> 
> 赞同：0
> 
> 时间：2012-06-09T20:09:22.543
> 
> 标签：linux, overriding, hook, posix

我正在考虑向我正在开发的 linux 发行版的 posix API 添加一些自定义安全行为。

例如，如果程序要求 fopen() 一个它具有写访问权限但通常不应访问的目录，则提示用户进行身份验证。

在进行本机 linux 调用之前，是否有一种简单的方法可以将客户行为挂钩到 posix 调用，或者我只需要分支我自己的源代码，然后将一个函数放入实际的库中，然后执行标准行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:20:35.047

您可以使用 LD_PRELOAD 在其他系统库之前加载您自己的库。通过这个，您可以编写某种包装器 fopen() 等。有关更多信息，请参阅[此](https://stackoverflow.com/questions/426230/what-is-the-ld-preload-trick)链接。

# r - 通过匹配列表来过滤 R 中的矩阵

> ID：10964244
> 
> 赞同：1
> 
> 时间：2012-06-09T20:10:11.593
> 
> 标签：r, filter, merge

我有矩阵：

```
traits <- matrix(c(1,0,1, 1,0,0, 0,0,0), nrow = 3, ncol=3, byrow=TRUE,
           dimnames = list(c("sp1", "sp2", "sp3"),c("Tr1", "Tr2", "Tr3"))) 
```

和一份清单

```
species <-c("sp1", "sp2") 
```

如何过滤“特征”矩阵，使其仅返回匹配项，即

```
traits.filtered<-matrix(c(1,0, 1,1, 0,0), nrow = 2, ncol=3, byrow=TRUE,
           dimnames = list(c("sp1", "sp2"),c("Tr1", "Tr2", "Tr3"))) 
```

谢谢你，-伊丽莎白

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T20:23:17.617

```
traits[row.names(traits)%in%species,] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T20:26:01.673

`species`您可以直接使用`[`subsetting 函数按存储的行名进行索引：

```
> traits[species, ]
    Tr1 Tr2 Tr3
sp1   1   0   1
sp2   1   0   0 
```

在这种情况下，您通过字符向量而不是数字索引向量或逻辑向量进行索引。查看`?"["`更多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-10T00:39:52.823

一种明显的方法是`traits`使用以下方法对矩阵进行子集化`species`：

```
traits[species, ] 
```

但是，这仅在行名称是唯一的情况下才有效 - 如果不是，则仅返回第一个匹配项。

出于这个原因，我强烈建议使用更强大的：

```
traits[rownames(traits) %in% species, ] 
```

# ruby - 让用户编写和运行 ruby 代码？

> ID：10964245
> 
> 赞同：-2
> 
> 时间：2012-06-09T20:10:13.780
> 
> 标签：ruby

我正在为咯咯笑创建一个小的代码编写培训游戏。游戏应该是 ruby​​，我希望用户编写代码，然后让游戏查看它以及代码返回什么，有点像 _why 的hacky（但来自 cli）。

我找不到办法做到这一点，你知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:15:13.610

看一下[`eval`](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-eval)，它将 String 解释为 ruby​​ 代码。如果您想知道如何编写文本编辑器部分，那就更难了（并且超出了本网站的范围）。最简单的解决方案是在标准库中使用 readline，它可以让您创建类似 IRB 的提示。

# groovy - 休眠查询以从用户表中获取 4 个计数

> ID：10964246
> 
> 赞同：1
> 
> 时间：2012-06-09T20:10:14.747
> 
> 标签：groovy, hibernate-criteria

我有 users 表，我想使用 Hibernate 创建一个查询来计算正在离开和已经离开的员工和顾问。与雇员不同，顾问的employeeid 字段以“c_...”开头。同样离开的是在未来最多 30 天内具有“sunsetdate”字段值的用户，离开的用户是在今天日期之前具有日落日期字段值的用户。如果 Users 是具有employeeid 的域类，sunsetdate 作为字段，我可以通过一个查询来获取所有 4 个计数。现在我正在尝试使用 Criteria api 但有 4 个单独的查询来做到这一点。如下所示：（对于已离职的顾问）

```
 def resultList =   Users.createCriteria.list(){
          like('employeeid','c_%')
          le('sunsetdate',todaysDate)
          projections {
          count(employeeid)
             }
            } 
```

如果可能的话，我想将所有 4 个此类查询合并为 1 个单个查询 在此先感谢

# android - Android Google Maps 方向和应用程序内的道路路径

> ID：10964254
> 
> 赞同：0
> 
> 时间：2012-06-09T20:12:02.993
> 
> 标签：android, google-maps

我现在正在寻找几个小时，我似乎无法找到任何解决方案。我正在开发一个在地图中显示一些参考点的应用程序。我想在这些点之间绘制道路路径，并在我的应用程序中显示各自的方向。我不想启动谷歌地图应用程序来在那里显示这些信息。

这可能吗？如果是的话，你能指出一些教程吗？

提前Thks。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T13:10:58.403

KML 输出不再在谷歌地图上工作。您必须使用路线 API 从谷歌获取路线。

[http://maps.googleapis.com/maps/api/directions/xml?origin=](http://maps.googleapis.com/maps/api/directions/xml?origin=) {lat_lon_origin}&destination={lat_lon_dest}&ie=UTF8&oe=UTF8&0&om=0&sensor=false

有关信息，请参阅此帖子：

[Google Maps API 版本差异](https://stackoverflow.com/questions/11323500/google-maps-api-version-difference)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T23:36:54.127

当然这是可能的。网上有足够多的关于这方面的教程。一个搜索请求给了我以下结果：

在 Android 开发者网站上查看 API 演示：

[http://developer.android.com/resources/tutorials/views/hello-mapview.html](http://developer.android.com/resources/tutorials/views/hello-mapview.html)

作为实现 MapView 的起点。

在此堆栈溢出线程中，您可以找到有关在地图上绘制路线的问题的答案：

[如何在谷歌地图中显示两个地理坐标之间的路线？](https://stackoverflow.com/questions/2643993/how-to-display-a-route-between-two-geocoords-in-google-maps)

提示：在提问之前先在 Android 开发者网站和 stack-overflow 上搜索。

有好的发展！

氪

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T10:36:42.463

我已经在地图上绘制了路径并完成了步行和驾车路线。为此，我使用 2 个位置。1）当前位置 lat 和 lon 2）用户单击标记以显示点 1 和 2 之间的路径。为此，您只需要获取单击标记点的 lat 和 long 即可，而不是我的代码很有用。

```
 drawPath(Utils.ConvertToFloat(kiosk.Lat),
    Utils.ConvertToFloat(kiosk.Lon), true); 
```

功能是：

```
private void drawPath(final double lat, final double lon,
        final boolean isWalking) {
    new Thread() {
        @Override
        public void run() {
            double fromLat = 0, fromLon = 0, toLat, toLon;
            if (curLocation != null) {
                fromLat = curLocation.getLatitude();
                fromLon = curLocation.getLongitude();
            }
            toLat = lat;
            toLon = lon;
            // For Testing
            // fromLat = 36.00;
            // fromLon = -115.16116333007813;
            String url = RoadProvider.getUrl(fromLat, fromLon, toLat,
                    toLon, isWalking);
            InputStream is = getConnection(url);
            mRoad = RoadProvider.getRoute(is);
            mHandler.sendEmptyMessage(0);
        }
    }.start();
}
   Handler mHandler = new Handler() {
    public void handleMessage(android.os.Message msg) {

        MapOverlay mapOverlay = new MapOverlay(mRoad, mapView);
        List<Overlay> listOfOverlays = mapView.getOverlays();
        ArrayList<Overlay> objs = new ArrayList<Overlay>();

        for (Overlay o : listOfOverlays) {
            if (o instanceof MapOverlay) {
                objs.add(o);
            }
        }
        for (Overlay overlay : objs) {
            listOfOverlays.remove(overlay);
        }
        // listOfOverlays.clear();
        listOfOverlays.add(mapOverlay);
        mapView.invalidate();
    };
}; 
```

这是绘制路径的地方::

```
class MapOverlay extends com.google.android.maps.Overlay {
    Road mRoad;
    ArrayList<GeoPoint> mPoints;

    public MapOverlay(Road road, MapView mv) {
        mRoad = road;
        if (road.mRoute.length > 0) {
            mPoints = new ArrayList<GeoPoint>();
            for (int i = 0; i < road.mRoute.length; i++) {
                mPoints.add(new GeoPoint(
                        (int) (road.mRoute[i][1] * 1000000),
                        (int) (road.mRoute[i][0] * 1000000)));
            }
            int moveToLat = (mPoints.get(0).getLatitudeE6() + (mPoints.get(
                    mPoints.size() - 1).getLatitudeE6() - mPoints.get(0)
                    .getLatitudeE6()) / 2);
            int moveToLong = (mPoints.get(0).getLongitudeE6() + (mPoints
                    .get(mPoints.size() - 1).getLongitudeE6() - mPoints
                    .get(0).getLongitudeE6()) / 2);
            GeoPoint moveTo = new GeoPoint(moveToLat, moveToLong);

            MapController mapController = mv.getController();
            mapController.animateTo(moveTo);
            mapController.setZoom(13);
        }
    }

    @Override
    public boolean draw(Canvas canvas, MapView mv, boolean shadow, long when) {
        super.draw(canvas, mv, shadow);
        drawPath(mv, canvas);
        return true;
    }

    public void drawPath(MapView mv, Canvas canvas) {
        int x1 = -1, y1 = -1, x2 = -1, y2 = -1;
        Paint paint = new Paint();
        paint.setColor(Color.GREEN);
        paint.setStyle(Paint.Style.STROKE);
        paint.setStrokeWidth(3);
        if (mPoints != null && mPoints.size() > 0) {

            for (int i = 0; i < mPoints.size(); i++) {
                Point point = new Point();
                mv.getProjection().toPixels(mPoints.get(i), point);
                x2 = point.x;
                y2 = point.y;
                if (i > 0) {
                    canvas.drawLine(x1, y1, x2, y2, paint);
                }
                x1 = x2;
                y1 = y2;
            }
        }
    }
} 
```

您需要将这 3 个文件放在相同或不同的包中。

点.java

```
public class Point {
String mName;
String mDescription;
String mIconUrl;
double mLatitude;
double mLongitude; 
```

}

道路.java

```
public class Road {
public String mName;
public String mDescription;
public int mColor;
public int mWidth;
public double[][] mRoute = new double[][] {};
public Point[] mPoints = new Point[] {}; 
```

}

RoadProvider.java

```
 public class RoadProvider {

    public static Road getRoute(InputStream is) {
            KMLHandler handler = new KMLHandler();
            try {
                    SAXParser parser = SAXParserFactory.newInstance().newSAXParser();
                    parser.parse(is, handler);
            } catch (ParserConfigurationException e) {
                    e.printStackTrace();
            } catch (SAXException e) {
                    e.printStackTrace();
            } catch (IOException e) {
                    e.printStackTrace();
            }
            return handler.mRoad;
    }

    public static String getUrl(double fromLat, double fromLon, double toLat,
                    double toLon, boolean isWalking) {// connect to map web service
            StringBuffer urlString = new StringBuffer();
            urlString.append("http://maps.google.com/maps?f=d&hl=en");
            urlString.append("&saddr=");// from
            urlString.append(Double.toString(fromLat));
            urlString.append(",");
            urlString.append(Double.toString(fromLon));
            urlString.append("&daddr=");// to
            urlString.append(Double.toString(toLat));
            urlString.append(",");
            urlString.append(Double.toString(toLon));
            urlString.append("&ie=UTF8&0&om=0&output=kml");
            if(isWalking){
                urlString.append("&dirflg=w");
            }
            Utils.LogInfo(urlString.toString());
            return urlString.toString();
    }
    }

    class KMLHandler extends DefaultHandler {
    Road mRoad;
    boolean isPlacemark;
    boolean isRoute;
    boolean isItemIcon;
    private Stack mCurrentElement = new Stack();
    private String mString;

    public KMLHandler() {
            mRoad = new Road();
    }

    public void startElement(String uri, String localName, String name,
                    Attributes attributes) throws SAXException {
            mCurrentElement.push(localName);
            if (localName.equalsIgnoreCase("Placemark")) {
                    isPlacemark = true;
                    mRoad.mPoints = addPoint(mRoad.mPoints);
            } else if (localName.equalsIgnoreCase("ItemIcon")) {
                    if (isPlacemark)
                            isItemIcon = true;
            }
            mString = new String();
    }

    public void characters(char[] ch, int start, int length)
                    throws SAXException {
            String chars = new String(ch, start, length).trim();
            mString = mString.concat(chars);
    }

    public void endElement(String uri, String localName, String name)
                    throws SAXException {
            if (mString.length() > 0) {
                    if (localName.equalsIgnoreCase("name")) {
                            if (isPlacemark) {
                                    isRoute = mString.equalsIgnoreCase("Route");
                                    if (!isRoute) {
                                            mRoad.mPoints[mRoad.mPoints.length - 1].mName = mString;
                                    }
                            } else {
                                    mRoad.mName = mString;
                            }
                    } else if (localName.equalsIgnoreCase("color") && !isPlacemark) {
                            mRoad.mColor = Integer.parseInt(mString, 16);
                    } else if (localName.equalsIgnoreCase("width") && !isPlacemark) {
                            mRoad.mWidth = Integer.parseInt(mString);
                    } else if (localName.equalsIgnoreCase("description")) {
                            if (isPlacemark) {
                                    String description = cleanup(mString);
                                    if (!isRoute)
                                            mRoad.mPoints[mRoad.mPoints.length - 1].mDescription = description;
                                    else
                                            mRoad.mDescription = description;
                            }
                    } else if (localName.equalsIgnoreCase("href")) {
                            if (isItemIcon) {
                                    mRoad.mPoints[mRoad.mPoints.length - 1].mIconUrl = mString;
                            }
                    } else if (localName.equalsIgnoreCase("coordinates")) {
                            if (isPlacemark) {
                                    if (!isRoute) {
                                            String[] xyParsed = split(mString, ",");
                                            double lon = Double.parseDouble(xyParsed[0]);
                                            double lat = Double.parseDouble(xyParsed[1]);
                                            mRoad.mPoints[mRoad.mPoints.length - 1].mLatitude = lat;
                                            mRoad.mPoints[mRoad.mPoints.length - 1].mLongitude = lon;
                                    } else {
                                            String[] coodrinatesParsed = split(mString, " ");
                                            int lenNew = coodrinatesParsed.length;
                                            int lenOld = mRoad.mRoute.length;
                                            double[][] temp = new double[lenOld + lenNew][2];
                                            for (int i = 0; i < lenOld; i++) {
                                                    temp[i] = mRoad.mRoute[i];
                                            }
                                            for (int i = 0; i < lenNew; i++) {
                                                    String[] xyParsed = split(coodrinatesParsed[i], ",");
                                                    for (int j = 0; j < 2 && j < xyParsed.length; j++)
                                                            temp[lenOld + i][j] = Double
                                                                            .parseDouble(xyParsed[j]);
                                            }
                                            mRoad.mRoute = temp;
                                    }
                            }
                    }
            }
            mCurrentElement.pop();
            if (localName.equalsIgnoreCase("Placemark")) {
                    isPlacemark = false;
                    if (isRoute)
                            isRoute = false;
            } else if (localName.equalsIgnoreCase("ItemIcon")) {
                    if (isItemIcon)
                            isItemIcon = false;
            }
    }

    private String cleanup(String value) {
            String remove = "<br/>";
            int index = value.indexOf(remove);
            if (index != -1)
                    value = value.substring(0, index);
            remove = "&#160;";
            index = value.indexOf(remove);
            int len = remove.length();
            while (index != -1) {
                    value = value.substring(0, index).concat(
                                    value.substring(index + len, value.length()));
                    index = value.indexOf(remove);
            }
            return value;
    }

    public Point[] addPoint(Point[] points) {
            Point[] result = new Point[points.length + 1];
            for (int i = 0; i < points.length; i++)
                    result[i] = points[i];
            result[points.length] = new Point();
            return result;
    }

    private static String[] split(String strString, String strDelimiter) {
            String[] strArray;
            int iOccurrences = 0;
            int iIndexOfInnerString = 0;
            int iIndexOfDelimiter = 0;
            int iCounter = 0;
            if (strString == null) {
                    throw new IllegalArgumentException("Input string cannot be null.");
            }
            if (strDelimiter.length() <= 0 || strDelimiter == null) {
                    throw new IllegalArgumentException(
                                    "Delimeter cannot be null or empty.");
            }
            if (strString.startsWith(strDelimiter)) {
                    strString = strString.substring(strDelimiter.length());
            }
            if (!strString.endsWith(strDelimiter)) {
                    strString += strDelimiter;
            }
            while ((iIndexOfDelimiter = strString.indexOf(strDelimiter,
                            iIndexOfInnerString)) != -1) {
                    iOccurrences += 1;
                    iIndexOfInnerString = iIndexOfDelimiter + strDelimiter.length();
            }
            strArray = new String[iOccurrences];
            iIndexOfInnerString = 0;
            iIndexOfDelimiter = 0;
            while ((iIndexOfDelimiter = strString.indexOf(strDelimiter,
                            iIndexOfInnerString)) != -1) {
                    strArray[iCounter] = strString.substring(iIndexOfInnerString,
                                    iIndexOfDelimiter);
                    iIndexOfInnerString = iIndexOfDelimiter + strDelimiter.length();
                    iCounter += 1;
            }

            return strArray;
    } 
```

}

如果您需要任何其他代码，请告诉我..

# java - 绘图时JApplet加载屏幕

> ID：10964255
> 
> 赞同：0
> 
> 时间：2012-06-09T20:12:04.727
> 
> 标签：java, swing, loading, graphviz, japplet

在绘制图形之前，如何放置在 java 小程序中可见的加载屏幕？我的代码：

```
public class Test extends JApplet 
{
    GrappaPanel gp = null;
    JPanel jpanel = null;
    JEditorPane dataDisplayer = null;
    Graph graph = null;
    JProgressBar progressBar = null;

    public void init() {      
        Parser program =null;
        InputStream input;
            String sgraph = getGraph();
            try {
                input = new ByteArrayInputStream(sgraph.getBytes("UTF-8"));
                program = new Parser(input);
                program.parse();
            } catch (Exception e) {
                e.printStackTrace();
            }
            graph = program.getGraph(); 
            gp = new GrappaPanel(graph);
            JScrollPane jspg = new JScrollPane(gp,JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED,JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED);
            GridBagLayout gb = new GridBagLayout();
            jpanel = new JPanel(gb);
            setContentPane(jpanel);
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.fill = GridBagConstraints.BOTH;
            gbc.gridwidth = GridBagConstraints.REMAINDER;
            gbc.weightx = 1.0;
            gbc.weighty = 1.0;
            gb.setConstraints(jspg,gbc);
            jpanel.add(jspg);   
    }

    private String getGraph(){
    ...
    }

} 
```

在小程序中绘制图形占用了大部分加载时间。获取表示图形的字符串并将其解析为 Graph 对象相对便宜。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:46:21.280

在一张卡片中使用`CardLayout`带有 `JProgressBar`（或动画“加载”图标）的 a，在另一张卡片中使用图表。默认为“加载”卡，然后在`SwingWorker`. 返回结果后，准备图表，将其添加到另一张卡片并翻转到该卡片。

# jquery - 试图在 CSS 类/悬停状态之间循环 - Jquery

> ID：10964257
> 
> 赞同：0
> 
> 时间：2012-06-09T20:12:45.570
> 
> 标签：jquery, timer, hover, setinterval

我正在尝试在 JQuery 中创建一个函数，它可以无限期地为它们的非悬停状态和悬停状态之间的几个链接设置动画，直到我的`abortTimer`函数被触发。我想在相反的时间`a.mus-plr`和`a.earbuds`相反的时间制作动画，所以当一个元素`'.hover'`启用了它的类时，另一个元素不会`'.hover'`启用它的类。我希望每个元素每 3000 毫秒在其悬停状态之间切换一次。

任何帮助将非常感激！我似乎无法让它工作。我认为这可能是我定义 setInterval 计时器的问题。谢谢！！

**查询文件：**

```
$(document).ready(function(){
    var tid = setInterval(animateControls, 4000);
    function animateControls() {
        $("a.mus-plr").delay(2000).addClass('hover').delay(2000).removeClass('hover');
        $("a.earbuds").addClass('hover').delay(2000).removeClass('hover');
    }
    function abortTimer() {
        clearInterval(tid);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:16:12.897

每次间隔计时器到期时，您只需切换类，假设它们从一个具有悬停类而另一个没有悬停类开始[。](http://api.jquery.com/toggleclass/)`hover`

**编辑**以在元素悬停时停止自动切换。

```
$(function() {
     var doToggle = true;

     $('a.mus-plr').removeClass('hover');
     $('a.earbuds').addClass('hover');

     var tid = setInterval( function() {
          if (doToggle) $('a.mus-plr, a.earbuds').toggleClass('hover');
     }, 2000);

     setTimeout(function() {
        if (tid) clearInterval(tid);
        $('a.mus-plr,a.earbuds').removeClass('hover');
     }, 30000); // stop toggling after 30 seconds

     $('a.mus-plr,a.earbuds').hover( function() {
           doToggle = false;
     }, function() {
           doToggle = true;
     });
}); 
```

# jquery - yii RegisterScript, id 和 type

> ID：10964258
> 
> 赞同：1
> 
> 时间：2012-06-09T20:12:48.710
> 
> 标签：jquery, yii, jsrender

我正在尝试在 yii 应用程序上使用[jsrender](https://github.com/BorisMoore/jsrender)。我需要注册一个这样的脚本：

```
<script id="movieTemplate" type="text/x-jsrender">
    <div>
        {{:#index+1}}: <b>{{:name}}</b> ({{:releaseYear}})
    </div>
</script> 
```

通常我使用 CClientScript::registerScript(); 但它不允许指定 ID 或类型。谁能提出一个干净的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T04:31:20.330

`CClientScript::registerScript()`函数只注册 javascripts，它当然会有类型`text/javascript`......您正在注册的脚本不是浏览器可以理解的 javascripts，实际上它们被库构建器赋予自定义名称作为类型，（在您的情况下为 jsremder）..让浏览器避开它们，以便他们的javascript可以解析它。就像在underscore.js中我们有`type="text/template"`..

您需要手动包含它..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T07:09:37.290

只需将您的模板包含在视图文件中，ClientScript 不适合它。

# c++ - 什么可能导致我的 C++ win32 应用程序在后台运行？

> ID：10964259
> 
> 赞同：0
> 
> 时间：2012-06-09T20:12:58.393
> 
> 标签：c++, winapi, background, wm-paint

我已经在这个应用程序上工作了至少 3-4 个月，最近它还没有工作。

它从今天开始，因为昨天它运行良好且平稳。现在它运行了，但窗口不可见（我检查了任务管理器中的进程列表，它正在运行）。我已经确定 ShowWindow(hwnd, nFunsterStil); 没有被意外删除，但它仍然存在。

我认为问题出在 WM_PAINT 上，因为这是我在程序停止工作时正在处理的问题。

这是我在编译并开始不可见时所拥有的：

```
 PAINTSTRUCT ps;
    HDC hdc;
    case WM_PAINT: {
                    hdc = BeginPaint(hwnd, &ps); 
                    static RECT Background, Background2;
                    SetRect(&Background, 0, 0, 476, 555);
                    SetRect(&Background2, 300, 300, 200, 400);
                    FillRect(hdc, &Background, (HBRUSH) (INT_PTR)CreateSolidBrush(RGB(50,55,50)));
                    FillRect(hdc, &Background2, (HBRUSH) (INT_PTR)CreateSolidBrush(RGB(100,200,100)));
                    EndPaint(hwnd, &ps); 
                   } 
```

现在我尝试删除其中的一些行，将整个块变成评论，甚至完全删除它，但它没有任何帮助。我知道我可能弄乱了电脑的内存。所以我的问题是：出了什么问题，我该如何解决？提前感谢您的帮助。

这是完整的消息开关：

```
 LRESULT CALLBACK WindowProcedure (HWND hwnd, UINT message, WPARAM wParam, LPARAM lParam)
   {
switch (message)                  /* handle the messages */
{ 

       case WM_CTLCOLORSTATIC: {
                               HDC hdcStatic = (HDC) wParam;
                               SetTextColor(hdcStatic, RGB(50,255,50));
                               SetBkColor(hdcStatic, RGB(0,0,0));
                               return (INT_PTR)CreateSolidBrush(RGB(0, 0, 0));
                               }
       case WM_CTLCOLOREDIT: {
                             HDC hdcStatic = (HDC) wParam;
                             SetTextColor(hdcStatic, RGB(50,255,50));
                             SetBkColor(hdcStatic, RGB(0,0,0));
                             return (INT_PTR)CreateSolidBrush(RGB(0, 0, 0));
                             }
    case WM_CREATE:
         {
                   // ------------------MENU-------------------
                   HMENU hMenubar = CreateMenu();
                   HMENU hFile = CreatePopupMenu();
                   HMENU hCPP = CreatePopupMenu();
                   HMENU hHELP = CreatePopupMenu();
                   HMENU hCUSTOMIZE = CreatePopupMenu();

                   HMENU hTHEME = CreatePopupMenu();

                   HMENU hNEW = CreatePopupMenu();

                   AppendMenu(hFile, MF_STRING, ID_HOME, "Ho&me");
                   AppendMenu(hFile, MF_SEPARATOR, 0, 0);

                   AppendMenu(hFile, MF_POPUP, (UINT) hNEW, "N&ew...");
                   AppendMenu(hNEW, MF_STRING, ID_NEW, "Not&e");

                   AppendMenu(hFile, MF_STRING, ID_SAVE, "Sa&ve");
                   AppendMenu(hFile, MF_STRING, ID_SHOWCPP, "Ed&it");
                   AppendMenu(hFile, MF_SEPARATOR, 0, 0);
                   AppendMenu(hFile, MF_STRING, ID_CLOSE, "Cl&ose");

                   AppendMenu(hCPP, MF_STRING, ID_SHOWNOTES, "Li&st all notes");
                   AppendMenu(hCPP, MF_STRING, MENU_COREFILES, "Open 'Notes' fol&der");
                   AppendMenu(hCPP, MF_SEPARATOR, 0, 0);
                   AppendMenu(hCPP, MF_STRING, ID_SAVEFILE, "Sa&ve");
                   AppendMenu(hCPP, MF_STRING, ID_SHOWCPP, "Ed&it");

                   AppendMenu(hHELP, MF_STRING, 0, "Help Fil&es...");
                   AppendMenu(hHELP, MF_STRING, MENU_ABOUT, "Ab&out");
                   AppendMenu(hHELP, MF_SEPARATOR, 0, 0);
                   AppendMenu(hHELP, MF_STRING, 0, "Pro&duct Website");

                   AppendMenu(hCUSTOMIZE, MF_POPUP, (UINT) hTHEME, "Current& Theme");
                   AppendMenu(hTHEME, MF_STRING | MF_CHECKED, 0, "Pr&ompt");
                   AppendMenu(hTHEME, MF_STRING, 0, "No&te Pad");

                   AppendMenu(hMenubar, MF_STRING | MF_POPUP, (UINT) hFile, "Fi&le");
                   AppendMenu(hMenubar, MF_SEPARATOR, 0, 0);
                   AppendMenu(hMenubar, MF_SEPARATOR, 0, 0);
                   AppendMenu(hMenubar, MF_SEPARATOR, 0, 0);
                   AppendMenu(hMenubar, MF_STRING | MF_POPUP, (UINT) hCPP, "No&tes");
                   AppendMenu(hMenubar, MF_SEPARATOR, 0, 0);
                   AppendMenu(hMenubar, MF_SEPARATOR, 0, 0);
                   AppendMenu(hMenubar, MF_SEPARATOR, 0, 0);
                   AppendMenu(hMenubar, MF_STRING | MF_POPUP, (UINT) hHELP, "He&lp");
                   AppendMenu(hMenubar, MF_SEPARATOR, 0, 0);
                   AppendMenu(hMenubar, MF_SEPARATOR, 0, 0);
                   AppendMenu(hMenubar, MF_SEPARATOR, 0, 0);
                   AppendMenu(hMenubar, MF_STRING | MF_POPUP, (UINT) hCUSTOMIZE, "Custom&ise");

                   SetMenu(hwnd, hMenubar);

                   // WINDOW FEATURES!!!

                   TEST[1] = CreateWindow(TEXT("BUTTON"), TEXT("List all notes!"),
                   WS_VISIBLE | WS_CHILD | WS_BORDER,
                   200,375,150,25,
                   hwnd,(HMENU) ID_SHOWNOTES, NULL, NULL);

                   MAIN = CreateWindow(TEXT("edit"), TEXT(""),                       
                   WS_VISIBLE | WS_CHILD | WS_BORDER | ES_LEFT | ES_MULTILINE | ES_READONLY | SBS_RIGHTALIGN | WS_VSCROLL,
                   10,20,516,350,
                   hwnd,(HMENU) 5001, NULL, NULL);

                   EDIT = CreateWindow(TEXT("edit"), TEXT(""),                       
                   WS_VISIBLE | WS_CHILD | WS_BORDER | ES_LEFT | ES_MULTILINE | SBS_RIGHTALIGN | WS_VSCROLL,
                   10,20,516,350,
                   hwnd,(HMENU) 5001, NULL, NULL);
                   ShowWindow(EDIT, SW_HIDE);

                   NAME=CreateWindow(TEXT("edit"), TEXT("-> Title <-"),
                   WS_VISIBLE | WS_CHILD | WS_BORDER | ES_AUTOHSCROLL,
                   10, 0, 516, 20,
                   hwnd, (HMENU) ID_FILENAME, NULL, NULL);
                   ShowWindow(NAME, SW_HIDE);

                   TEST[2] = CreateWindow(TEXT("BUTTON"), TEXT("-> Home <-"),
                   WS_VISIBLE | WS_CHILD | WS_BORDER,
                   200,375,150,25,
                   hwnd,(HMENU) ID_SHOWHOME, NULL, NULL);
                   ShowWindow(TEST[2], SW_HIDE);
                   SetWindowText(MAIN, DEFTEXT);
         break;
         }
    case WM_COMMAND: {
         // MENU ITEMS!!!
                   //Close
              if( LOWORD(wParam) == ID_CLOSE ) {
                  PostQuitMessage (0);  
                  }
              if(LOWORD(wParam) == MENU_COREFILES) {
                                ShellExecute(NULL, "explore", "Notes", NULL, NULL, SW_SHOW);
                                }
              if(LOWORD(wParam) == MENU_ABOUT) {
                                MessageBox(hwnd, "© 2012 Joseph Meadows. \r\nThis program is essentially a reference guide for whatever you want. It can be used to store school notes, or things completely opposite.", "About:",
                                MB_ICONINFORMATION | MB_SYSTEMMODAL | MB_OK);
                                }
              if(LOWORD(wParam) == ID_SHOWCPP) {
                                if(home==3) {
                                            MessageBox(hwnd, "Error: 9026\. Cannot edit Home Page.",  "Invalid Action!", 
                                            MB_ICONERROR | MB_SYSTEMMODAL | MB_DEFBUTTON1 | MB_OK);
                                            }
                                 else if(home==1) {
                                                 MessageBox(hwnd, "Error: 6502 Cannot edit System pages.",  "Invalid Action!", 
                                                 MB_ICONERROR | MB_SYSTEMMODAL | MB_DEFBUTTON1 | MB_OK);
                                                 }
                                else {
                                     ShowWindow(EDIT, SW_SHOW);
                                     ShowWindow(NAME, SW_SHOW);
                                     ShowWindow(MAIN, SW_HIDE);
                                     SetWindowText(StatButts[0],"List all notes!");
                                     mode=2;
                                     }
                                     }
              if(LOWORD(wParam) == ID_SAVE) {
                                char* tittle=SaveFile(hwnd, NAME, EDIT);
                                SetWindowText(MAIN, tittle);
                                ShowWindow(EDIT, SW_HIDE);
                                ShowWindow(NAME, SW_HIDE);
                                ShowWindow(MAIN, SW_SHOW);
                                mode=1;
                                }
              if(LOWORD(wParam) == ID_HOME) {
                                if(mode==2){
                                            int Savebox=MessageBox(hwnd, "Would you like to save this page?",  "Save Page", 
                                            MB_ICONQUESTION | MB_SYSTEMMODAL | MB_DEFBUTTON1 | MB_YESNOCANCEL);
                                            switch(Savebox){
                                                            case IDYES: {
                                                                 ShowWindow(EDIT, SW_HIDE);
                                                                 ShowWindow(NAME, SW_HIDE);
                                                                 ShowWindow(MAIN, SW_SHOW);
                                                                 SetWindowText(StatButts[0],"List all notes!");
                                                                 int len = GetWindowTextLength(EDIT)+1;
                                                                 static char title[1000];
                                                                 GetWindowText(EDIT, title, len);
                                                                 SetWindowText(MAIN, title);
                                                                 mode=1;
                                                                 home=1;
                                                                 break;
                                                                 }
                                                            case IDNO: {
                                                                 ShowWindow(EDIT, SW_HIDE);
                                                                 ShowWindow(NAME, SW_HIDE);
                                                                 ShowWindow(MAIN, SW_SHOW);
                                                                 SetWindowText(StatButts[0],"List all notes!");
                                                                 SetWindowText(MAIN, DEFTEXT);
                                                                 mode=1;
                                                                 home=1;
                                                                 }
                                                            case IDCANCEL: {}
                                            }
                                }     
                                if(mode==1){        
                                            ShowWindow(EDIT, SW_HIDE);
                                            ShowWindow(NAME, SW_HIDE);
                                            ShowWindow(MAIN, SW_SHOW);
                                            SetWindowText(MAIN, DEFTEXT);
                                            SetWindowText(StatButts[0],"List all notes!");
                                }
              }
              if(LOWORD(wParam)==ID_NEW) {
                               if(mode==1) {
                                           ShowWindow(EDIT, SW_SHOW);
                                           ShowWindow(NAME, SW_SHOW); 
                                           ShowWindow(MAIN, SW_HIDE);
                                           SetWindowText(TEST[1],"List all notes!");
                                           SetWindowText(EDIT, "");
                                           mode=2;
                               }
              }
              if(LOWORD(wParam)==ID_SHOWHOME) {      
                                                     if(mode==1) {
                                                                 ShowWindow(MAIN, SW_SHOW);
                                                                 ShowWindow(NAME, SW_HIDE);
                                                                 ShowWindow(EDIT, SW_HIDE);
                                                                 ShowWindow(TEST[1], SW_SHOW);
                                                                 ShowWindow(TEST[2], SW_HIDE);
                                                                 home=1;
                                                                 SetWindowText(MAIN, DEFTEXT);
                                                                 SetWindowText(TEST[1], "List all notes!");
                                                                 }
                                                     if(mode!=1) {                  
                                                                 int Savebox=MessageBox(hwnd, "Would you like to save this page?",  "Save Page?", 
                                                                 MB_ICONQUESTION | MB_SYSTEMMODAL | MB_DEFBUTTON1 | MB_YESNOCANCEL);
                                                                 switch(Savebox){
                                                                                 case IDYES: {
                                                                                      ShowWindow(EDIT, SW_HIDE);
                                                                                      ShowWindow(NAME, SW_HIDE);
                                                                                      ShowWindow(MAIN, SW_SHOW);
                                                                                      ShowWindow(TEST[1], SW_SHOW);
                                                                                      ShowWindow(TEST[2], SW_HIDE);
                                                                                      SetWindowText(TEST[1],"List all notes!");
                                                                                      int len = GetWindowTextLength(EDIT)+1;
                                                                                      static char title[1000];
                                                                                      GetWindowText(EDIT, title, len);
                                                                                      SetWindowText(MAIN, title);
                                                                                      mode=1;
                                                                                      home=1;
                                                                                      break;
                                                                                      }
                                                                                 case IDNO: {
                                                                                      ShowWindow(EDIT, SW_HIDE);
                                                                                      ShowWindow(NAME, SW_HIDE);
                                                                                      ShowWindow(MAIN, SW_SHOW);
                                                                                      ShowWindow(TEST[1], SW_SHOW);
                                                                                      ShowWindow(TEST[2], SW_HIDE);
                                                                                      SetWindowText(TEST[1],"List all notes!");
                                                                                      mode=1;
                                                                                      home=1;
                                                                                      }

                                                                 }
                                                     }
                                               }
              if(LOWORD(wParam)==ID_SHOWNOTES) {
                                              if(mode==1) {
                                                                             std::string umm="";
                                                                             ShowWindow(NAME,SW_SHOW);
                                                                             ShowWindow(MAIN,SW_SHOW);
                                                                             ShowWindow(EDIT,SW_HIDE);
                                                                             ShowWindow(TEST[1], SW_HIDE);
                                                                             ShowWindow(TEST[2], SW_SHOW);
                                                                             SetWindowText(NAME, "-> Title <-");
                                                                             WIN32_FIND_DATA File_Buffer;
                                                                             HANDLE hFind = FindFirstFile(TEXT("Notes/*.NNF"), &File_Buffer);
                                                                             PTSTR Files[8999];
                                                                             int num=0;
                                                                             SetWindowText(MAIN, "");
                                                                             if(hFind != INVALID_HANDLE_VALUE) {
                                                                                      do {
                                                                                         PTSTR FileName = File_Buffer.cFileName;

                                                                                         Files[num] = FileName;
                                                                                         num=num+1;

                                                                                         string kkk(FileName);
                                                                                         stringstream nam(kkk);
                                                                                         string name;
                                                                                         getline(nam, name, '.');
                                                                                         umm = Stringadd(umm, name);
                                                                                         //================================================================================================
                                                                                         } while (FindNextFile(hFind, &File_Buffer));
                                                                             std::stringstream out;
                                                                             out << num;
                                                                             std::string numb=out.str();
                                                                             umm=umm+" \r\n \r\n "+"Number of Notes: "+numb;
                                                                             const char * lol=umm.c_str();
                                                                             SetWindowText(MAIN, lol);
                                                                             FindClose(hFind);
                                                             }
                                                             } 
                                                             if(mode!=1) {                  
                                                                 int Savebox=MessageBox(hwnd, "Would you like to save this page?",  "Save Page", 
                                                                 MB_ICONQUESTION | MB_SYSTEMMODAL | MB_DEFBUTTON1 | MB_YESNOCANCEL);
                                                                 switch(Savebox){
                                                                                 case IDYES: {
                                                                                      ShowWindow(EDIT, SW_HIDE);
                                                                                      ShowWindow(NAME, SW_HIDE);
                                                                                      ShowWindow(MAIN, SW_SHOW);
                                                                                      ShowWindow(TEST[1], SW_SHOW);
                                                                                      ShowWindow(TEST[2], SW_HIDE);
                                                                                      SetWindowText(TEST[1],"List all notes!");
                                                                                      int len = GetWindowTextLength(EDIT)+1;
                                                                                      static char title[1000];
                                                                                      GetWindowText(EDIT, title, len);
                                                                                      SetWindowText(MAIN, title);
                                                                                      mode=1;
                                                                                      home=1;
                                                                                      break;
                                                                                      }
                                                                                 case IDNO: {
                                                                                      ShowWindow(EDIT, SW_HIDE);
                                                                                      ShowWindow(NAME, SW_HIDE);
                                                                                      ShowWindow(MAIN, SW_SHOW);
                                                                                      ShowWindow(TEST[1], SW_SHOW);
                                                                                      ShowWindow(TEST[2], SW_HIDE);
                                                                                      SetWindowText(TEST[1],"List all notes!");
                                                                                      mode=1;
                                                                                      home=1;
                                                                                      }

                                                                 }
                                                     }
                                              }                          
         // BUTTONS!!!
                      //Show CPP
         break;
         }
         case WM_PAINT: {
                          PAINTSTRUCT ps;
                          HDC hdc;
                        hdc = BeginPaint(hwnd, &ps); 
                        static RECT Background;
                        SetRect(&Background, 0, 0, 476, 555);
                        FillRect(hdc, &Background, (HBRUSH) (INT_PTR)CreateSolidBrush(RGB(50,55,50)));
                        EndPaint(hwnd, &ps); 
                        break;
                        }
    case WM_DESTROY:
        PostQuitMessage (0);       /* send a WM_QUIT to the message queue */
    default:                      /* for messages that we don't deal with */
        break;
        return DefWindowProc (hwnd, message, wParam, lParam);
}

return 0;
   } 
```

以下是与制作窗户相关的部分：

```
 LRESULT CALLBACK WindowProcedure (HWND, UINT, WPARAM, LPARAM);

    /*  Make the class name into a global variable  */
    char szClassName[ ] = "WindowsApp";

    int WINAPI WinMain (HINSTANCE hThisInstance,
                HINSTANCE hPrevInstance,
                LPSTR lpszArgument,
                int nFunsterStil)

    {
    HWND hwnd, hwnd2;               /* This is the handle for our window */
    MSG messages;            /* Here messages to the application are saved */
    WNDCLASSEX wincl;        /* Data structure for the windowclass */

/* The Window structure */
wincl.hInstance = hThisInstance;
wincl.lpszClassName = szClassName;
wincl.lpfnWndProc = WindowProcedure;      /* This function is called by windows */
wincl.style = CS_DBLCLKS;                 /* Catch double-clicks */
wincl.cbSize = sizeof (WNDCLASSEX);

/* Use default icon and mouse-pointer */
wincl.hIcon = LoadIcon (NULL, IDI_APPLICATION);
wincl.hIconSm = LoadIcon (NULL, IDI_APPLICATION);
wincl.hCursor = LoadCursor (NULL, IDC_ARROW);
wincl.lpszMenuName = NULL;                 /* No menu */
wincl.cbClsExtra = 0;                      /* No extra bytes after the window class */
wincl.cbWndExtra = 0;                      /* structure or the window instance */
/* Use Windows's default color as the background of the window */
wincl.hbrBackground = (HBRUSH) (INT_PTR)CreateSolidBrush(RGB(0,0,0));

/* Register the window class, and if it fails quit the program */
if (!RegisterClassEx (&wincl))
    return 0;

/* The class is registered, let's create the program*/
hwnd = CreateWindowEx (
       0,                   /* Extended possibilites for variation */
       szClassName,         /* Classname */
       "VirtualNotes",       /* Title Text */
       WS_SYSMENU | WS_MINIMIZEBOX, /* default window */
       CW_USEDEFAULT,       /* Windows decides the position */
       CW_USEDEFAULT,       /* where the window ends up on the screen */
       554,                 /* The programs width */
       475,                 /* and height in pixels */
       HWND_DESKTOP,        /* The window is a child-window to desktop */
       NULL,                /* No menu */
       hThisInstance,       /* Program Instance handler */
       NULL                 /* No Window Creation data */
       );
/* Make the window visible on the screen */
ShowWindow (hwnd, nFunsterStil);

/* Run the message loop. It will run until GetMessage() returns 0 */
while (GetMessage (&messages, NULL, 0, 0))
{
    /* Translate virtual-key messages into character messages */
    TranslateMessage(&messages);
    /* Send message to WindowProcedure */
    DispatchMessage(&messages);
}

/* The program return- 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:40:28.453

您应该进行调查以确定问题。然后 - 寻求解决方案。

如果您正在创建一个标准的“重叠”窗口（即带有标题栏、系统菜单和最小/最大/关闭按钮） - 以上所有内容都应该由系统绘制，只有客户区（即内部窗口）在`WM_PAINT`处理中绘制。因此，如果您在屏幕上什么也看不到 - 问题可能出在其他地方。

MSVC 中有一个很好的工具，叫做 Spy++。使用它找到您的进程/线程，检查它是否*真的*创建了窗口，检查您的窗口样式和位置。

您还可以在`WM_PAINT`处理中添加断点。如果您的窗口确实存在并且可见，您就会到达那里。

关于您的代码的一些注释：

1.  没有错误检查（例如测试 retval `BeginPaint`）。你怎么知道你的窗口确实被创建了（或者至少它的类被注册了）？至少一些调试时宏（例如`ASSERT`）会有所帮助。
2.  如果有原因你为什么要使用`static RECT`？（在某些非常特殊的情况下，这可能会节省一些堆栈内存）。
3.  `CreateSolidBrush`给你一个刷柄，你**必须**释放它`DeleteObject`。实际上，您有资源泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:14:25.303

看起来您`break`在案件结束时遗漏了 a 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T20:39:38.833

当您填写`WNDCLASS`结构、注册并创建主窗口时，您可能会调用`ShowWindow(handle, SW_SHOW/SW_HIDE);`。确保这个电话没有说`SW_HIDE`

鉴于您当前的帖子中没有显示您的这部分代码，我可能是错的，但这是一个明智的选择。

**编辑：**在第 55 行，ShowWindow(); 将 nFunsterStil 更改为“SW_SHOW”，看看是否能解决您的问题。

@约瑟夫

# c# - 我如何在这段代码中放置一个保护属性？

> ID：10964260
> 
> 赞同：0
> 
> 时间：2012-06-09T20:12:59.267
> 
> 标签：c#, mvvm, caliburn.micro

我现在正在学习 MVVM。由于我看到很多教程或项目只使用 View 和 ViewModel，我有点困惑。这是我的代码。

**模型 ：**

```
public class StudentModel : PropertyChangedBase
{
    private String _firstName;
    public String FirstName
    {
        get { return _firstName; }
        set
        {
            _firstName = value;
            NotifyOfPropertyChange(() => FirstName);
        }
    }

    private Double _gradePoint;
    public Double GradePoint
    {
        get { return _gradePoint; }
        set
        {
            _gradePoint = value;
            NotifyOfPropertyChange(() => GradePoint);
        }
    }
} 
```

**看法 ：**

```
<UserControl x:Class="MVVMLearningWithCaliburnMicro.Views.StudentView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:cal="http://www.caliburnproject.org">
    <Grid Width="525" Height="300" Background="Lavender">
        <DockPanel>
            <TextBlock HorizontalAlignment="Center" Text="Student Data"
                       DockPanel.Dock="Top" FontSize="20" />
            <StackPanel Orientation="Vertical" HorizontalAlignment="Center"
                        VerticalAlignment="Stretch"
                        Margin="0,8" DockPanel.Dock="Top">
                <StackPanel Orientation="Horizontal" Margin="0,5">
                    <TextBlock Text="Name" FontSize="15" Margin="5,0" />
                    <TextBox Name="txtName" Text="{Binding Path=Student.FirstName}" Width="250" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,5">
                    <TextBlock Text="Grade" FontSize="15" Margin="5,0" />
                    <TextBox Name="txtGrade" Text="{Binding Path=Student.GradePoint}" Width="250" />
                </StackPanel>
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="0,5" HorizontalAlignment="Center"
                        VerticalAlignment="Bottom"
                        DockPanel.Dock="Bottom">
                <Button Name="btnSave" Width="100" Height="40"
                        cal:Message.Attach="SaveStudent">
                    <TextBlock Text="Save" FontSize="15" />
                </Button>
            </StackPanel>
        </DockPanel>
    </Grid>
</UserControl> 
```

**视图模型：**

```
public class StudentViewModel
{
    public StudentModel Student { get; set; }

    public void SaveStudent()
    {
        MessageBox.Show(String.Format("Saved: {0} - ({1})", Student.FirstName, Student.GradePoint));
    }

    public StudentViewModel()
    {
        Student = new StudentModel { FirstName = "Tom Johnson", GradePoint = 3.7 };
    }

    private Boolean CanSaveStudent()
    {
        return Student.GradePoint >= 0.0 || Student.GradePoint <= 4.0;;
    }
} 
```

**Q :**
1\. 我怎么把我的守卫财产`NotifyOfPropertyChange()`放在模型里？
2.（愚蠢的问题）我的 MVVM 模式是否指向了正确的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T21:17:05.687

一种解决方案是从 PropertyChangedBase 继承视图模型并订阅 StudentModel 的属性更改。然后将guard方法转换为属性，如下所示：

```
public class StudentViewModel: PropertyChangedBase
{
    public StudentModel Student { get; set; }

    public void SaveStudent()
    {
        MessageBox.Show(String.Format("Saved: {0} - ({1})", Student.FirstName, Student.GradePoint));
    }

    public StudentViewModel()
    {
        Student = new StudentModel { FirstName = "Tom Johnson", GradePoint = 3.7 };
        Student.PropertyChanged += delegate { NotifyOfPropertyChanged( () => CanSaveStudent)};
    }

    public Boolean CanSaveStudent
    {
        get 
        {
            return Student.GradePoint >= 0.0 || Student.GradePoint <= 4.0;
        }
    }
} 
```

希望它有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:03:21.407

通知事件*应该*出现在 中`view model`，因为它会从 中传达更改`model`并将它们推送到 UI，反之亦然。这是根据 MVVM 设计指南。

在您的特定情况下，您可以或保持原样，但删除不必要`view model`的，或将通知器移入`view model`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T05:29:07.767

好的，我的代码中有一个结论这
是我的灵感

@tsells——感谢第三个链接

@john polvora - 感谢您指出该属性
**重要提示：**它应该是**公共财产**

[使用 Caliburn.Micro 的保护](https://stackoverflow.com/q/6719291/1181782)[条款未触发保护条款错误](https://stackoverflow.com/q/6720196/1181782)

* * *

这是我的代码，我认为它们更干净

**模型 ：**

```
public class StudentModel
{
    public String FirstName { get; set; }
    public Double GradePoint { get; set; }
} 
```

**看法 ：**

```
<UserControl x:Class="MVVMWithCMTwo.Views.StudentView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:cal="http://www.caliburnproject.org">
    <Grid Width="525" Height="300" Background="Lavender">
        <DockPanel>
            <TextBlock HorizontalAlignment="Center" Text="Student Data"
                       DockPanel.Dock="Top" FontSize="20" />
            <StackPanel Orientation="Vertical" HorizontalAlignment="Center"
                        VerticalAlignment="Stretch"
                        Margin="0,8" DockPanel.Dock="Top">
                <StackPanel Orientation="Horizontal" Margin="0,5">
                    <TextBlock Text="Name" FontSize="15" Margin="5,0" />
                    <TextBox Name="txtName" Text="{Binding Path=StudentName}" Width="250" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,5">
                    <TextBlock Text="Grade" FontSize="15" Margin="5,0" />
                    <TextBox Name="txtGrade" Text="{Binding Path=StudentGrade}" Width="250" />
                </StackPanel>
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="0,5" HorizontalAlignment="Center"
                        VerticalAlignment="Bottom"
                        DockPanel.Dock="Bottom">
                <Button Name="btnSave" Width="100" Height="40"
                        cal:Message.Attach="SaveStudent">
                    <TextBlock Text="Save" FontSize="15" />
                </Button>
            </StackPanel>
        </DockPanel>
    </Grid>
</UserControl> 
```

**视图模型：**

```
public class StudentViewModel : PropertyChangedBase
{
    public StudentModel Student { get; set; }

    public String StudentName
    {
        get { return Student.FirstName; }
        set
        {
            Student.FirstName = value;
            NotifyOfPropertyChange(() => Student.FirstName);
        }
    }

    public Double StudentGrade
    {
        get { return Student.GradePoint; }
        set
        {
            Student.GradePoint = value;
            NotifyOfPropertyChange(() => Student.GradePoint);
            NotifyOfPropertyChange(() => CanSaveStudent);
        }
    }

    public void SaveStudent()
    {
        MessageBox.Show(String.Format("Saved: {0} - ({1})", Student.FirstName, Student.GradePoint));
    }

    public StudentViewModel()
    {
        Student = new StudentModel { FirstName = "Tom Johnson", GradePoint = 3.7 };
    }

    public Boolean CanSaveStudent
    {
        get { return Student.GradePoint >= 0.0 && Student.GradePoint <= 4.0; }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T23:31:51.233

您的通知更改应该在模型中，因为这也是您的约束。基本上，您的视图模型应该加载对象列表并为您的 UI 提供一个绑定集合来处理大多数事情。您上面的实现似乎是一个带有单个对象的详细面板（例如编辑模式）。

把它们加起来。

ViewModel - 应该实现 INotifyPropertyChangeed 接口 Model - 应该实现 INotifyPropertyChangeed 接口

要启用/禁用命令/按钮，您应该使用命令绑定。我有一个 WPF 和 Silverlight 教程，您可以参考。

[http://tsells.wordpress.com/2010/06/23/command-binding-with-wpf-and-silverlight-net-4-0-with-mv-vm/](http://tsells.wordpress.com/2010/06/23/command-binding-with-wpf-and-silverlight-net-4-0-with-m-v-vm/)

在过去的几年里，我还围绕这件事发布了一些教程。喜欢的话就去看看吧......

[http://tsells.wordpress.com/2011/02/08/using-reflection-with-wpf-and-the-inotifypropertychanged-interface/](http://tsells.wordpress.com/2011/02/08/using-reflection-with-wpf-and-the-inotifypropertychanged-interface/)

[http://tsells.wordpress.com/2010/06/02/wpf-model-view-viewmodel-mv-vm-example/](http://tsells.wordpress.com/2010/06/02/wpf-model-view-viewmodel-m-v-vm-example/)

# file - 如何在下面给出的代码中在 vbscript 中运行文件？

> ID：10964261
> 
> 赞同：0
> 
> 时间：2012-06-09T20:13:10.113
> 
> 标签：file, date, vbscript, copy

这是我找到的符合我的条件的代码。下面的代码用于将文件从源路径复制到目标路径。

隐含条件：仅当文件在目标路径上不存在或文件存在但较旧时，才会覆盖源路径和目标文件。

如何在此代码中运行目标文件，以便目标文件仅在文件被覆盖或目标文件被新复制时运行？

```
Option Explicit

Dim WshShell
Dim fso
Dim USERPROFILE
Dim srcPath
Dim tgtPath
On Error Resume Next

Set WshShell = WScript.CreateObject("Wscript.Shell")
Set fso = WScript.CreateObject("Scripting.FilesystemObject")
'USERPROFILE = WshShell.ExpandEnvironmentStrings("%USERPROFILE%")

srcPath = "C:\test.exe"
tgtPath = "D:\"

If Not fso.FileExists(tgtPath) Then
fso.CopyFile srcPath, tgtPath, True
ElseIf fso.FileExists(srcPath) Then
ReplaceIfNewer srcPath, tgtPath
End If

Sub ReplaceIfNewer(strSourceFile, strTargetFile)
Const OVERWRITE_EXISTING = True

Dim objFso
Dim objTargetFile
Dim dtmTargetDate
Dim objSourceFile
Dim dtmSourceDate

Set objFso = WScript.CreateObject("Scripting.FileSystemObject")
Set objTargetFile = objFso.GetFile(strTargetFile)
dtmTargetDate = objTargetFile.DateLastModified
Set objSourceFile = objFso.GetFile(strSourceFile)
dtmSourceDate = objSourceFile.DateLastModified
If (dtmTargetDate < dtmSourceDate) Then
objFso.CopyFile objSourceFile.Path, objTargetFile.Path,OVERWRITE_EXISTING
End If
Set objFso = Nothing
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T10:47:49.670

这是您脚本的改写和工作版本

```
option explicit 

dim WshShell, fso, srcPath, tgtPath , file, objFileSrc, objFileTgt
const OVERWRITE = true

set WshShell = WScript.CreateObject("Wscript.Shell") 
set fso = WScript.CreateObject("Scripting.FilesystemObject")

file = "test.exe"
srcPath = "c:\" 
tgtPath = "e:\" 

if fso.FileExists(srcPath & file) then
  if not fso.FileExists(tgtPath & file) then
    'target doesn't exist, just copy
    fso.CopyFile srcPath & file, tgtPath
    wscript.echo srcPath & file & " copied to " & tgtPath & file
  else
    Set objFileSrc = fso.getFile(srcPath & file)
    Set objFileTgt = fso.getFile(tgtPath & file)
    'target exists, compare dates
    if objFileSrc.DateLastModified > objFileTgt.DateLastModified then
      fso.CopyFile srcPath & file, tgtPath, OVERWRITE
      wscript.echo srcPath & file & " copied over " & tgtPath & file
    else
      wscript.echo srcPath & file & " not newer then " & tgtPath & file
    end if
  end if
else
  wscript.echo srcPath & file & " does not exist"
end if
set fso = Nothing 
```

# c++ - >> 和 << 以及 C++ 中的数据类型

> ID：10964265
> 
> 赞同：1
> 
> 时间：2012-06-09T20:14:21.950
> 
> 标签：c++, types, bit-shift

我已经查看了[这个答案](https://stackoverflow.com/questions/141525/absolute-beginners-guide-to-bit-shifting)中给出的指南，但我仍然不明白位移。特别是我对起作用的数据类型感到困惑。

以下：

```
unsigned int a = pow(2,31);
cout << (a << 1); 
```

确实像我预期的那样产生 0，因为它`int`是 32 位，所以`1`将它向左移动，将它推到空无一物。

但以下

```
unsigned int a = 1;
unsigned char b = (unsigned char)a;
cout << (unsigned int)(b<<8); 
```

产生 256。这是为什么呢？我的猜测是 a`char`是 8 位，因此将 1 向左移动 8 个位置应该为零。

有没有这样做的功能/班次？（即评估`1<<8`为 0）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T20:16:06.583

窄整数值被提升为`int`或`unsigned int`在被使用之前。这叫做*积分提升*。

# ruby-on-rails - 如果对象是从某个方法创建的，则跳过验证

> ID：10964271
> 
> 赞同：0
> 
> 时间：2012-06-09T20:15:01.513
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, omniauth

我正在尝试为 Twitter/FB 设置 Omniauth 登录。我创建了自己的身份验证系统，在创建用户时验证密码和电子邮件。但是，当我的用户通过 Twitter/Fb 登录时，我不想验证密码或电子邮件。

我创建了一个名为omniauth_login 的用户属性。我将它用作布尔值来测试我的 should_validate_password 中是否需要验证？方法。

用户.rb

```
attr_accessor :password, :updating_password, :omniauth_login
validates_presence_of :password, :if => :should_validate_password?
validates_confirmation_of :password, :if => :should_validate_password?

def should_validate_password?
  (updating_password || new_record?) && !(self.omniauth_login == 'true')
end

def self.create_with_omniauth(auth)
  create! do |user|
    user.provider = auth["provider"]
    user.uid = auth["uid"]
    user.name = auth["info"]["name"]
  end
end 
```

这是我用于创建用户的控制器：

session_controller.rb

```
def omniauth_create
  auth = request.env["omniauth.auth"]
  user = User.new
  user.omniauth_login = 'true'
  user = User.find_by_provider_and_uid(auth["provider"], auth["uid"]) ||         
         User.create_with_omniauth(auth)
  session[:user_id] = user.id
  redirect_to user
end 
```

当我尝试通过 twitter 登录来创建新用户时，我仍然收到验证错误：

```
Validation failed: Password can't be blank, Email can't be blank, Email is not valid. 
```

**如果我的对象是在 create_with_omniauth 方法中创建的，如何跳过密码和电子邮件的验证？**

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:28:03.060

我认为这里的问题是您有两个单独的用户实例，一个将omniauth_login 设置为“true”，另一个没有。第一个是从

```
user = User.new
user.omniauth_login = 'true' 
```

第二个是

```
User.create_with_omniauth(auth) 
```

. 此处创建的第二个实例没有将 omniauth_login 设置为“true”，因此它仍然运行验证。试试这个

```
user = User.find_by_provider_and_uid(auth["provider"], auth["uid"]) ||         
 User.create_with_omniauth(auth) 
```

并在 create_with_omniauth 中，添加`user.omniauth_login = 'true'` .

# python - 如何使用 PyQt4 将内容从 QListWidget 移动到 QStringList？

> ID：10964273
> 
> 赞同：0
> 
> 时间：2012-06-09T20:15:11.197
> 
> 标签：python, qt, pyqt4, qlistwidget

我有一个对话框，用户在其中选择需要的文件，它在 QListWidget 中添加（通过 QPushButton），我的问题是我需要从 QStringList 中的 QListWidget 恢复所有文件。

我试过这样，但出了点问题：

```
 self.file = QtCore.QStringList()
        archivos = self.file

        cuenta = self.ventana.listWidget.count()
        for index in range(cuenta):
            archivos.append(self.ventana.listWidget.item(index)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:40:47.007

我认为您`.text()`在该项目后失踪了：

```
 self.file = QtCore.QStringList()
    archivos = self.file

    cuenta = self.ventana.listWidget.count()
    for index in range(cuenta):
        archivos.append(self.ventana.listWidget.item(index).text()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T21:08:12.547

据我了解，您需要将所选项目文本值添加到 QStringList。这是如何做到的。

```
QStringList *mList = new QStringList();
QString currItem = ui->listWidget->currentItem()->text();
mList->append(currItem); 
```

# google-maps-api-3 - 谷歌地图可以显示45度的地形吗

> ID：10964279
> 
> 赞同：0
> 
> 时间：2012-06-09T20:16:02.407
> 
> 标签：google-maps-api-3

我需要地形视图，但似乎无法以 45 度显示它。我不想使用谷歌地球插件。这可以做到吗？如果没有：是否有其他地图 API 可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:41:44.770

Google Maps API 无法做到这一点。倾斜地图仅适用于卫星/航空瓷砖。

文档状态“ `setTilt()`：设置航空影像的入射角（可用于卫星和混合地图类型），以从视口平面到地图平面的度数为单位。唯一支持的值是 0，表示无入射角（无倾斜） , 和 45 表示倾斜 45 度。”

# javascript - 在 WebGL 中的曲面上绘制曲线

> ID：10964281
> 
> 赞同：1
> 
> 时间：2012-06-09T20:16:05.683
> 
> 标签：javascript, webgl, calculus

好吧，标题几乎说明了这一点。我希望能够在 Web GL 的表面上绘制曲线。例如，我想在球体表面画一条抛物线。

x = cos(theta)sin(phi); y = sin(theta)sin(phi); z = cos(phi)。

如果使 theta = theta(t) 和 phi = phi(t)，则可以在曲面上绘制曲线。

我想形状上的线条是我需要的。任何人都知道这在 Web GL 中是否可行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:34:17.727

抛物线是平面上与一条线和一个点（称为焦点）具有相同距离的点的集合。这里的重点是球体上的“线”是什么意思。请记住，抛物线延伸到无穷大，但您不能在球体上这样做，除非您在其上定义一些特定的度量。

无论如何，您使用了球体的参数化，在 theta 和 phi 方面。那挺好的。如果要在曲面上定义曲线，则应在 theta 和 phi 之间绑定，例如

```
phi = theta ^ 2 
```

会以某种方式绘制可以定义为“抛物线”的东西，即在球体上的投影，由参数化给出，它在平面上的表示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T12:19:53.613

您是否正在寻求有关如何在 WebGL 中执行此操作的帮助？在这种情况下，看看这个例子

[http://dl.dropbox.com/u/17612367/OpenGL%20to%20WebGL/example%202.3.1%20-%20line%20graph/code/index.html](http://dl.dropbox.com/u/17612367/OpenGL%20to%20WebGL/example%202.3.1%20-%20line%20graph/code/index.html)

您基本上会将位置加载到向量中，并使用带有 LINELOOP 的 drawArrays 或其他东西来绘制它...有关参数，请参阅此备忘单或谷歌 drawArrays 函数以获取更多信息：

[http://www.nihilogic.dk/labs/webgl_cheat_sheet/WebGL_Cheat_Sheet.pdf](http://www.nihilogic.dk/labs/webgl_cheat_sheet/WebGL_Cheat_Sheet.pdf)

祝你好运！

# php - 在部分数组中查找字符串的出现

> ID：10964285
> 
> 赞同：-1
> 
> 时间：2012-06-09T20:17:08.257
> 
> 标签：php, arrays

我有一个数组，我将类型填充为每个元素的字符串。例如：

类型数组

```
type1 | type2 | type2 | type3 | type2 | type1 | type3

$types = array('type1', 'type2', 'type2', 'type3', 'type2', 'type1', 'type3') 
```

现在我想在迭代数组时计算每种类型的出现次数。

例如：

当我在要返回的数组的第一个元素时：

```
type1 : 1
type2 : 0
type3 : 0 
```

当我处于第四个元素时，我想要：

```
type1 : 1
type2 : 2
type3 : 1 
```

实际上，我只想找到我正在寻找的元素类型的出现。例如：`fourth element`

```
type3: 1 
```

有没有一个php函数可以做到这一点？或者我将不得不迭代整个数组并计算类型的出现？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:29:48.377

没有本机功能可以执行此操作。但是我们可以写一个简单的：

```
$items = array(
        'type1',
        'type2',
        'type2',
        'type3',
        'type2',
        'type1',
        'type3'
    );

    foreach ($items as $order => $item) {
        $previous = array_slice($items, 0, $order + 1, true);
        $counts = array_count_values($previous);

        echo $item . ' - ' . $counts[$item] . '<br>';
    } 
```

此代码产生：

```
type1 - 1
type2 - 1
type2 - 2
type3 - 1
type2 - 3
type1 - 2
type3 - 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:24:41.087

我不确定我是否完全理解你的问题，但是如果你想计算一个数组的所有值，你可以使用[`array_count_values`](http://php.net/manual/en/function.array-count-values.php)函数：

```
<?php
 $array = array(1, "hello", 1, "world", "hello");
 print_r(array_count_values($array));
?> 

The above example will output:
Array
(
    [1] => 2
    [hello] => 2
    [world] => 1
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T20:29:07.207

这是正确的解决方案：

```
$index = 4;
$array = array('type1', 'type2', 'type2', 'type3', 'type2', 'type1', 'type3')
var_dump( array_count_values( array_slice( $array, 0, $index))); 
```

如果您使用`array_slice`抓取数组的一部分，然后将其运行到`array_count_values`，您实际上可以计算子数组的值。因此，对于任何`$index`，您都可以计算从`0`到的值`$index`。

这输出：

```
array(3) { ["type1"]=> int(1) ["type2"]=> int(2) ["type3"]=> int(1) } 
```

# c++ - 将类从应用程序解决方案移到静态库解决方案会创建未解决的外部符号链接错误

> ID：10964286
> 
> 赞同：1
> 
> 时间：2012-06-09T20:17:08.830
> 
> 标签：c++, visual-c++

我正在使用 Visual Studio 10 集来使用 v90 平台工具集。我有三个使用几个相同类的应用程序。因此，我不是每个类都拥有三个副本，而是试图将它们移到一个通用的静态库中。其中之一是给我链接问题。其他的似乎链接很好。这是问题类：

标题

```
#ifndef LIMIT_SINGLE_INSTANCE_INCLUDED
#define LIMIT_SINGLE_INSTANCE_INCLUDED

#include <windows.h> 

class CLimitSingleInstance
{
protected:
  DWORD  m_dwLastError;
  HANDLE m_hMutex;

public:
  CLimitSingleInstance(TCHAR *strMutexName);
  ~CLimitSingleInstance();
  BOOL IsAnotherInstanceRunning();
};
#endif 
```

身体

```
#include "LimitSingleInstance.h"

CLimitSingleInstance::CLimitSingleInstance(TCHAR *strMutexName)
{
  //Make sure that you use a name that is unique for this application otherwise
  //two apps may think they are the same if they are using same name for
  //3rd parm to CreateMutex
  m_hMutex = CreateMutex(NULL, FALSE, strMutexName); //do early
  m_dwLastError = GetLastError(); //save for use later
}

CLimitSingleInstance::~CLimitSingleInstance() 
{
  if (m_hMutex)  //Do not forget to close handles.
  {
     CloseHandle(m_hMutex); //Do as late as possible.
     m_hMutex = NULL; //Good habit to be in.
  }
}

BOOL CLimitSingleInstance::IsAnotherInstanceRunning() 
{
  return (ERROR_ALREADY_EXISTS == m_dwLastError);
} 
```

当这个类直接成为我的主要应用程序解决方案之一时，没有问题。我现在已将其移至我的静态库解决方案中，并且该解决方案构建良好。但是，我发现我无法再将我的主要应用程序解决方案与我的新静态库链接起来。这是尝试构建我的主应用程序的调试和发布版本的结果：

> ------ 重建全部开始：项目：WCCJ，配置：ReleaseTENA Win32 ------ CAssetEntity.cpp main.cpp ReadWCCJParameters.cpp
> WCCJ.cpp WCCJParameters.cpp 生成代码...
> DCTUtilsRel.lib(MessageWrapper.obj) : 找到 MSIL .netmodule 或使用 /GL 编译的模块；重新启动与 /LTCG 的链接；将 /LTCG 添加到链接命令行以提高链接器性能 创建库 ....\bin\WCCJ-TENA.lib 和对象 ....\bin\WCCJ-TENA.exp main.obj : error LNK2001: unresolved external symbol "public: __thiscall CLimitSingleInstance::CLimitSingleInstance(char *)" (??0CLimitSingleInstance@@QAE@PAD@Z) ....\bin\WCCJ-TENA.exe : 致命错误 LNK1120: 1 unresolved externals ----- - 重建全部开始：项目：WCCJ，配置：DebugTENA Win32 ------ CAssetEntity.cpp main.cpp ReadWCCJParameters.cpp
> WCCJ.cpp WCCJParameters.cpp 生成代码... CAssetEntity.obj : 警告 LNK4075: ignoring '/EDITANDCONTINUE' due to '/INCREMENTAL:NO' specification Creating library ....\bin\WCCJ-TENA-d.lib and object ....\bin\WCCJ-TENA-d.exp main.obj：错误 LNK2019：引用了未解析的外部符号“公共：__thiscall CLimitSingleInstance::CLimitSingleInstance(char *)”(??0CLimitSingleInstance@@QAE@PAD@Z)在函数“void _ *cdecl 'gSingleInstanceObj''(void)”的动态初始化程序中 (??* _EgSingleInstanceObj@@YAXXZ) ....\bin\WCCJ-TENA-d.exe : 致命错误 LNK1120: 1 unresolved externals == ========全部重建：0成功，2失败，0跳过==========

当我在二进制编辑器中打开 .lib 并搜索链接器想要的错误名称 (??0CLimitSingleInstance@@QAE@PAD@Z) 时，我发现它确实没有找到。我能找到的最接近的匹配是：

??0CLimitSingleInstance@@QAE@PA_W@Z

??1CLimitSingleInstance@@QAE@XZ

@CLimitSingleInstance@@QAEHXZ

有人能告诉我为什么会发生这种情况以及如何解决吗？提前致谢。

戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:29:44.527

好像没有 CLimitSingleInstance::CLimitSingleInstance(char_t *)。在你的图书馆。您是否检查了这两个项目的定义？

有 Microsoft 实用程序：`undname.exe`它是 VisualStudio 的一部分：

```
C:\Program Files\Microsoft Visual Studio\COMMON\Tools>UNDNAME.EXE
Microsoft(R) Windows NT(R) Operating System
UNDNAME Version 5.00.1768.1Copyright (C) Microsoft Corp. 1981-1998

usage: UNDNAME [-f] decorated-names...
       -f Undecorate fully.  Default is to only undecorate the class::member 
```

**所以链接器想要**：

```
>UNDNAME.EXE -f ??0CLimitSingleInstance@@QAE@PAD@Z
Microsoft(R) Windows NT(R) Operating System
UNDNAME Version 5.00.1768.1Copyright (C) Microsoft Corp. 1981-1998

>> ??0CLimitSingleInstance@@QAE@PAD@Z == public: __thiscall CLimitSingleInstance::CLimitSingleInstance(char *) 
```

**你在图书馆里有：**

```
>UNDNAME.EXE -f ??0CLimitSingleInstance@@QAE@PA_W@Z
Microsoft(R) Windows NT(R) Operating System
UNDNAME Version 5.00.1768.1Copyright (C) Microsoft Corp. 1981-1998

>> ??0CLimitSingleInstance@@QAE@PA_W@Z == public: __thiscall CLimitSingleInstance::CLimitSingleInstance(wchar_t *)

>UNDNAME.EXE -f ??1CLimitSingleInstance@@QAE@XZ
Microsoft(R) Windows NT(R) Operating System
UNDNAME Version 5.00.1768.1Copyright (C) Microsoft Corp. 1981-1998

>> ??1CLimitSingleInstance@@QAE@XZ == public: __thiscall CLimitSingleInstance::~CLimitSingleInstance(void) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T20:33:36.973

> 我能找到的最接近的匹配是：??0CLimitSingleInstance@@QAE@PA_W@Z

在该符号上使用 VS 命令行中的 undname.exe 实用程序：

```
C:\>undname ??0CLimitSingleInstance@@QAE@PA_W@Z
Microsoft (R) C++ Name Undecorator
Copyright (C) Microsoft Corporation. All rights reserved.

Undecoration of :- "??0CLimitSingleInstance@@QAE@PA_W@Z"
is :- "public: __thiscall CLimitSingleInstance::CLimitSingleInstance(wchar_t *)" 
```

请注意参数类型 wchar_t*，而不是 char*。你的 lib 项目有 UNICODE #defined，你的 exe 项目没有。相关设置为General + Character Set。

# java - jFormDesigner设计它不会显示？

> ID：10964297
> 
> 赞同：0
> 
> 时间：2012-06-09T20:18:55.623
> 
> 标签：java, eclipse, swing, jform-designer

```
import java.awt.*;
import javax.swing.*;
import javax.swing.GroupLayout;

/**
 * @author Ene Ion
 */
public class launcher extends JFrame {

        public launcher() {
        initComponents();
    }

    private void initComponents() {
        // JFormDesigner - Component initialization - DO NOT MODIFY  //GEN-BEGIN:initComponents
        // Generated using JFormDesigner Evaluation license - Ene Ion
        mbmlauncherfata = new JFrame();
        textField1 = new JTextField();
        checkBox1 = new JCheckBox();
        label1 = new JLabel();
        comboBox1 = new JComboBox();
        label2 = new JLabel();
        comboBox2 = new JComboBox();
        button1 = new JButton();
        button2 = new JButton();
        button3 = new JButton();
        progressBar1 = new JProgressBar();
        label3 = new JLabel();
        label4 = new JLabel();
        button4 = new JButton();
        button5 = new JButton();
        label5 = new JLabel();
        button6 = new JButton();

        //======== mbmlauncherfata ========
        {
            mbmlauncherfata.setTitle("MBMLauncher");
            mbmlauncherfata.setIconImage(new ImageIcon("E:\\Chituri\\MBMLauncherJava\\src\\resursele\\icon_4_64x64x32.png").getImage());
            mbmlauncherfata.setResizable(false);
            Container mbmlauncherfataContentPane = mbmlauncherfata.getContentPane();

            //---- textField1 ----
            textField1.setText("Username");
            textField1.setForeground(new Color(153, 0, 0));

            //---- checkBox1 ----
            checkBox1.setText("Remember Me");

            //---- label1 ----
            label1.setText("RAM Allocated");

            //---- comboBox1 ----
            comboBox1.setModel(new DefaultComboBoxModel(new String[] {
                "256M",
                "512M",
                "1024M",
                "2G",
                "3G",
                "4G"
            }));

            //---- label2 ----
            label2.setText("to");

            //---- comboBox2 ----
            comboBox2.setModel(new DefaultComboBoxModel(new String[] {
                "512M",
                "1024M",
                "2G",
                "3G",
                "4G",
                "5G",
                "6G"
            }));

            //---- button1 ----
            button1.setText("Play");
            button1.setFont(new Font("Snap ITC", Font.BOLD, 36));
            button1.setForeground(new Color(255, 102, 0));

            //---- button2 ----
            button2.setText("Update Game");

            //---- button3 ----
            button3.setText("Update Launcher");

            //---- label3 ----
            label3.setText("Download status:");

            //---- label4 ----
            label4.setText("Nothing in download");

            //---- button4 ----
            button4.setText("Texture Packs");

            //---- button5 ----
            button5.setText(".game");

            //---- label5 ----
            label5.setText("Drag and drop your texture\npack in the box *.zip files");
            label5.setIcon(new ImageIcon("E:\\Chituri\\MBMLauncherJava\\src\\resursele\\dasdasdasd.png"));

            //---- button6 ----
            button6.setText("Made By Malasuerte94");

            GroupLayout mbmlauncherfataContentPaneLayout = new GroupLayout(mbmlauncherfataContentPane);
            mbmlauncherfataContentPane.setLayout(mbmlauncherfataContentPaneLayout);
            mbmlauncherfataContentPaneLayout.setHorizontalGroup(
                mbmlauncherfataContentPaneLayout.createParallelGroup()
                    .addGroup(mbmlauncherfataContentPaneLayout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(mbmlauncherfataContentPaneLayout.createParallelGroup()
                            .addComponent(progressBar1, GroupLayout.Alignment.TRAILING, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(button1, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addGroup(mbmlauncherfataContentPaneLayout.createSequentialGroup()
                                .addComponent(button2, GroupLayout.PREFERRED_SIZE, 131, GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(button3, GroupLayout.DEFAULT_SIZE, 140, Short.MAX_VALUE))
                            .addGroup(mbmlauncherfataContentPaneLayout.createSequentialGroup()
                                .addComponent(button4, GroupLayout.PREFERRED_SIZE, 130, GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(button5, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(mbmlauncherfataContentPaneLayout.createSequentialGroup()
                                .addComponent(textField1, GroupLayout.PREFERRED_SIZE, 136, GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(checkBox1))
                            .addGroup(mbmlauncherfataContentPaneLayout.createSequentialGroup()
                                .addComponent(label1)
                                .addPreferredGap(LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(comboBox1, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(label2)
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(comboBox2, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                            .addGroup(mbmlauncherfataContentPaneLayout.createSequentialGroup()
                                .addComponent(label3, GroupLayout.PREFERRED_SIZE, 96, GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(label4))
                            .addComponent(label5, GroupLayout.PREFERRED_SIZE, 270, GroupLayout.PREFERRED_SIZE)
                            .addComponent(button6, GroupLayout.DEFAULT_SIZE, GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addContainerGap())
            );
            mbmlauncherfataContentPaneLayout.setVerticalGroup(
                mbmlauncherfataContentPaneLayout.createParallelGroup()
                    .addGroup(mbmlauncherfataContentPaneLayout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(mbmlauncherfataContentPaneLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                            .addComponent(checkBox1)
                            .addComponent(textField1, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(mbmlauncherfataContentPaneLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                            .addComponent(label2)
                            .addComponent(comboBox2, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE)
                            .addComponent(label1)
                            .addComponent(comboBox1, GroupLayout.PREFERRED_SIZE, GroupLayout.DEFAULT_SIZE, GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(button1)
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(mbmlauncherfataContentPaneLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                            .addComponent(button2)
                            .addComponent(button3))
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(progressBar1, GroupLayout.PREFERRED_SIZE, 18, GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(mbmlauncherfataContentPaneLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                            .addComponent(label4)
                            .addComponent(label3))
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(mbmlauncherfataContentPaneLayout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                            .addComponent(button4)
                            .addComponent(button5))
                        .addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(label5)
                        .addPreferredGap(LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(button6, GroupLayout.PREFERRED_SIZE, 22, GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(10, Short.MAX_VALUE))
            );
            mbmlauncherfata.setSize(305, 395);
            mbmlauncherfata.setLocationRelativeTo(null);
        }
        // JFormDesigner - End of component initialization  //GEN-END:initComponents
    }

    // JFormDesigner - Variables declaration - DO NOT MODIFY  //GEN-BEGIN:variables
    // Generated using JFormDesigner Evaluation license - Ene Ion
    private JFrame mbmlauncherfata;
    private JTextField textField1;
    private JCheckBox checkBox1;
    private JLabel label1;
    private JComboBox comboBox1;
    private JLabel label2;
    private JComboBox comboBox2;
    private JButton button1;
    private JButton button2;
    private JButton button3;
    private JProgressBar progressBar1;
    private JLabel label3;
    private JLabel label4;
    private JButton button4;
    private JButton button5;
    private JLabel label5;
    private JButton button6;
    // JFormDesigner - End of variables declaration  //GEN-END:variables

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                launcher GUI = new launcher();
                GUI.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                GUI.setVisible(true);
            }
        });
    }

} 
```

结果是一个空的 java 框.. [图片](http://img641.imageshack.us/img641/4373/wtfjp.jpg) 我试图解决这个问题，但我是 java 脚本的初学者，问题出在哪里，我该如何解决？坦克的帮助，并推荐我请一些好的 Eclipse 插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:56:33.167

这通常发生在框架未打包时。

试试这个：

```
launcher GUI = new launcher();
GUI.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
GUI.pack(); // <=========== PACK 
GUI.setVisible(true); 
```

[这](http://docs.oracle.com/javase/tutorial/uiswing/components/frame.html)是一个很好的教程，可以帮助您开始使用 Java 框架。

# ajax - 尝试在不更改 div 位置的情况下刷新页面上的一个 div 内容

> ID：10964298
> 
> 赞同：0
> 
> 时间：2012-06-09T20:19:07.307
> 
> 标签：ajax, html, position, refresh, css-float

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>

        <title>ajax div example</title>
<script type="text/javascript" src="jscripts/jquery-1.6.4.min.js"></script>
<script type="text/javascript">
    var dbn,machine_name;
function main_draw(d,m,r)
{
    dbn = d;
    machine_name = m;
    draw_charts();
    if ( r > 0 )
        {
            setRefreshid = setInterval("draw_pie()",r);
        }
}
function draw_charts()
{

document.getElementById('ajdiv4').innerHTML = "";
document.getElementById('ajdiv3').innerHTML = "";
document.getElementById('ajdiv2').innerHTML = "";
document.getElementById('ajdiv1').innerHTML = "";
draw_pie();
draw_line();
draw_space();
draw_backup();

}

function draw_pie()
{
setTimeout(function() {
    $.ajax( {

        url: 'JSCharts/graph_pie1.html',
        success: function(html)
        {
            $("#ajdiv4").html(html);
        }
    }); }, 100);
}

function draw_line()
{
setTimeout(function() {
    $.ajax( {

        url: 'JSCharts/graph_line1.html',
        success: function(html)
        {
            $("#ajdiv3").html(html);
        }
    });  }, 200);
}

function draw_space()
{
    setTimeout(function() {
    $.ajax( {

        url: 'JSCharts/space_graph.php',
        success: function(html)
        {
            $("#ajdiv2").html(html);
        }
    });  }, 300);
}

function draw_backup()
{
    setTimeout(function() {
    $.ajax( {

        url: 'JSCharts/backup_graph.php',
        success: function(html)
        {
            $("#ajdiv1").html(html);
        }
    });  }, 400);
}

</script>
</head>
<body>

<div id="ajdiv1" style="float:left"></div>
<div id="ajdiv2" style="float:left"></div>
<div id="ajdiv3" style="float:left"></div>
<div id="ajdiv4" style="float:left"></div>

<button id="b1" onclick="main_draw('CQ1','va2apsap010',10000)">Display Content</button>
</body>
</html> 
```

上面是一个完整的代码，它在单击“显示内容”时调用 AJAX，然后通过调用函数“draw_pie”刷新 div“ajdiv4”的内容。唯一的问题是，当它刷新时，它会将饼图一直向左移动。我希望它留在当前位置并更新它。如果有人知道这里发生了什么，请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:31:08.130

您是否尝试过指定 DIV 的尺寸？使用您当前的代码，您可能可以这样做：

```
<style>
#ajdiv1, #ajdiv2, #ajdiv3, #ajdiv4 {
    height:200px;
    width:200px;
} 
</style> 
```

或者，添加一个类属性来简化事情：

```
<style>
.chartContainer {
    height:200px;
    width:200px;
} 
</style> 
```

如果你有一个工作版本，或者可以在 JSfiddle 上发布一些东西，那会让事情更容易排除故障。

# windows-phone-7 - 如何获取从互联网上下载的图像的来源？

> ID：10964299
> 
> 赞同：2
> 
> 时间：2012-06-09T20:19:16.920
> 
> 标签：windows-phone-7, windows-phone-7.1

在我正在开发的应用程序中，向用户显示从网站获取的图像。我希望该应用程序可以选择将图像保存到图库。据我所知，由于图像显示在屏幕上（因此，已经“下载”到手机上），我不应该再次下载它以将其保存到手机中（主要是指定的 URL网站上的图像作为图像的来源）。有没有办法获取图像的源（路径）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T07:12:23.807

我之前写了一个应用程序，它是关于测试从网络上下载图像并将其放入图像控件中。令我惊讶的是 - 在第一次下载图像后，我能够关闭 wifi 并且该图像仍然显示。我认为 WP7 有很好的缓存或其他东西，也许如果你第二次询问相同的 URL，你会从缓存中接收临时文件，而不是再次下载它......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T06:47:50.920

我研究了一下，发现一旦从 url 下载了图像，它就不会再次下载，而是自动从缓存中检索。所以，这让我的问题得到了回答。你是正确的国王！

# jquery - IE 浮动元素无法完美显示

> ID：10964303
> 
> 赞同：0
> 
> 时间：2012-06-09T20:19:50.357
> 
> 标签：jquery, css, internet-explorer, drop-down-menu

我正在使用[Superfish jQuery 插件](http://users.tpg.com.au/j_birch/plugins/superfish/)来创建多级下拉菜单。但我有一些可怕的问题`IE6/7`。s 浮动到`li`右侧并在 Firefox 中显示在一行中（没问题），但在 IE 中，第一个（不包含链接 ( `a`) 标记）显示在右侧，其他显示在左侧（在 2/ 3行）一段代码：

[http://jsfiddle.net/Emhj4/8/](http://jsfiddle.net/Emhj4/8/)

我该怎么办？提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:00:52.247

那是因为您拥有顶级列表`display: block`的`A`元素。您只需要删除它并为您的其他“菜单级别”元素添加该属性。像这样的东西：

```
.menulevel1 a{color:#fff;position:relative;}

.menulevel1 li ul a{display:block;width:100%;background:#ccc;border:1px solid #000;padding:4px 5px;} 
```

[现场 jsFiddle 示例](http://jsfiddle.net/Emhj4/14/)

# mysql - 为什么这个简单的 MySQL 查询这么慢？

> ID：10964304
> 
> 赞同：5
> 
> 时间：2012-06-09T20:19:54.503
> 
> 标签：mysql, performance, indexing, where

所以这是一个非常简单的表'tbl'：

```
+---------+---------------------+------+-----+---------+----------------+
| Field   | Type                | Null | Key | Default | Extra          |
+---------+---------------------+------+-----+---------+----------------+
| val     | varchar(45)         | YES  | MUL | NULL    |                |
| id      | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
+---------+---------------------+------+-----+---------+----------------+ 
```

及其索引：

```
+--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table  | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| tbl    |          0 | PRIMARY  |            1 | id          | A         |   201826018 |     NULL | NULL   |      | BTREE      |         |
| tbl    |          1 | val      |            1 | val         | A         |      881336 |     NULL | NULL   | YES  | BTREE      |         |
+--------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+ 
```

我正在尝试这个简单的选择：

```
select val from tbl where val = 'iii'; 
```

结果：集合中有 86208 行（0.08 秒）

但是当我想稍微修改它时：

```
select id, val from tbl where val = 'iii'; 
```

结果是：集合中有 86208 行（47.30 秒）

我在指向的地方有一个索引，我正在修改的是结果行表示。为什么会有如此可怕的延迟？（我不得不说，我不能每次都重现这种延迟：即使在“重置查询缓存”或设置“查询缓存类型=关闭”命令之后也可以快速完成）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T00:24:13.527

如果不实际检查您的服务器配置，很难判断，但这是一个有根据的猜测。首先，MySQL 无需实际读取表数据即可满足您的查询。您要求的所有信息都可以仅从索引中检索到。请注意，`val`索引的基数仅为 10 ⁶行，并且索引中的行将非常短。

在第二种情况下，您要求提供不在索引中的数据`val`。现在引擎必须实际从数据中查找和读取行。这里的基数大约是 250 倍，并且由于索引将检索按 排序的行`val`，因此要找到相应的`id`值将需要在磁盘上的数百 gig 数据中跳来跳去。这将非常慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T20:33:37.793

尝试`ORDER BY`在查询中添加一个和 `LIMIT。这应该有很大帮助。

我认为如果您将查询更改为此它会更快：

```
select id, val from tbl where val = 'iii' order by val limit 10; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T20:42:04.943

您正在基于两列进行选择，但不存在两者的索引。尝试添加一个由id 和 val组成**的新索引。**

# jquery - 寻找用户界面来选择时间范围

> ID：10964306
> 
> 赞同：0
> 
> 时间：2012-06-09T20:20:06.327
> 
> 标签：jquery, jquery-ui

我的网站需要一个用户界面，允许用户在 1-24 小时范围内选择一个时间段（例如：6-8 小时）。不允许选择某些时间范围，因为它们可能会被保留（例如：7-9 小时）。因此只能允许用户从可用的时间范围中进行选择。我认为 jquery 滑块会很棒，但我找不到任何方法阻止滑块范围之间的一些范围。有没有简单的方法来实现我正在寻找的东西？

谢谢，拉维

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:25:02.257

就个人而言，我认为最用户友好的方法是向用户实际显示日历样式的视图，并使用颜色来指示特定时间段是否可用。

允许用户单击时间段以指定开始时间，如果您需要用户自定义此会议/约会的持续时间，请使用组合框要求他们指定持续时间。

# android - 在android中减去字符串数字值

> ID：10964310
> 
> 赞同：-1
> 
> 时间：2012-06-09T20:20:47.483
> 
> 标签：android, string, int, sharedpreferences

我正在制作一个 android 应用程序，其中我从 SharedPreferences 加载了一组字符串，以便我可以保存字符串。字符串仅包含数字，但它不是 int 值，而是字符串值。我更想知道如何减去那里的数字，因为通常我会使用类似 int value = value - value; 的东西。但这似乎不起作用，因为它是一个字符串而不是一个 int 值。即使它是一个字符串，我怎么能做到这一点？我知道我可以使用 int 值代替，但是因为我之前没有想到这一点，当我快完成时，更改与此相关的所有代码将是很多工作。请帮助我，并提前非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T20:22:55.410

您必须先将字符串转换为整数，然后对其进行操作，然后将字符串保存回来：

```
String value = preferences.getString("key:");
int intValue = Integer.valueOf(value);

intValue = intValue - 1;

preferences.edit().putString("key", Integer.toString(intValue)).commit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:23:01.647

尝试使用`Integer.valueOf(string)`或`Integer.parseInt(string)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T20:23:07.527

学习基本的编程和铸造的概念将对你有很大的帮助。可以使用基类将一种数据类型转换为另一种数据类型，基类通常处理字符串。例如查看整数文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T20:24:27.713

好吧，正如您所说，更改代码并将其保存为 int 需要做很多工作，我建议将字符串转换为整数，请参阅此链接以获取更多信息，有人询问有关将字符串转换为整数的问题，并且由于 Android 是基于 Java 的，因此这可以应用于您的项目：

[在Android上将字符串转换为整数](https://stackoverflow.com/questions/2709253/converting-a-string-to-an-integer-android)

希望这可以帮助。

# flash - 在 Flash Professional 中制作 .fla，然后导入 Flash Builder

> ID：10964311
> 
> 赞同：0
> 
> 时间：2012-06-09T20:20:48.080
> 
> 标签：flash, flash-builder, flash-cs5

我在具有 List 组件的 flash 专业 cs5 中制作了一个简单的 .fla。然后，我想将这个 .fla 从 flash 专业版导出到我有真实程序代码的 flash builder 中。

然后我希望能够动态地将文本元素添加到列表中，以及拥有一个事件侦听器。

我知道 cs5 中 List 的实例名称可以在 actionscript3 代码中使用，但我不确定我应该如何导出/导入它才能做到这一点。

我很感激任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T02:40:58.267

你有几个选择：

1.  创建一个 swf，并将整个 swf 编译到 Flex 项目中
2.  创建一个 swf 并将您正在使用的符号编译到 Flex 项目中
3.  创建一个 swf 并将其动态加载到 swfloader
4.  创建一个swc

对于嵌入解决方案，请[在此处查看](http://livedocs.adobe.com/flex/3/html/help.html?content=embed_4.html)

对于动态加载，请参见[此处](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7f9c.html#WS2db454920e96a9e51e63e3d11c0bf69084-7efa)和[此处](http://flexdiary.blogspot.com/2009/01/example-of-casting-contets-of-swfloader.html)

如果你想做一个swc，看[这里](http://www.brickabracka.com/jd/2008/09/exporting-swc-files-for-use-in-flex.html)

# java - 如何使用 PrettyFaces 重定向回同一页面？

> ID：10964313
> 
> 赞同：3
> 
> 时间：2012-06-09T20:20:53.050
> 
> 标签：java, jsf, prettyfaces

我想知道如何在操作调用中重定向到同一页面。

我有这个命令按钮：

```
<h:commandButton action="#{someBean.edit}" value="Edit" /> 
```

这是动作：

```
@Named
@RequestScoped
public class SomeBean {

    public String edit() {
        // some logic
        return "theSamePage?faces-redirect=true";
    }

} 
```

但它不会重定向到同一页面，它只是刷新它，所以当我尝试按 F5 键刷新页面时，会发生重复提交。这可以在正常情况下通过 post/redirect/get 解决。但是，当操作方法返回与发送请求的页面的 viewId 相同的 viewId 时，人脸不会发送重定向。

我用漂亮的面孔。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T22:49:27.647

```
return "pretty:"; 
```

几乎是你所需要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T20:24:52.297

我做了一些搜索和重写我的答案：

您可以通过以下方式获得漂亮面孔中的视图 ID：

```
 PrettyContext prettyContext = PrettyContext.newInstance((HttpServletRequest) request); 
      String viewId = prettyContext.getCurrentCalculatedViewId(); 
```

检查此以获取更多信息：[https ://groups.google.com/group/prettyfaces-users/browse_thread/thread/f50482709d7ec69b?pli=1](https://groups.google.com/group/prettyfaces-users/browse_thread/thread/f50482709d7ec69b?pli=1)

# ruby-on-rails - 如何在rails中向另一个用户发送通知

> ID：10964315
> 
> 赞同：0
> 
> 时间：2012-06-09T20:21:13.263
> 
> 标签：ruby-on-rails, push-notification

我试图创建一个类似于 stackoverflows 的徽章系统。我注意到 stackoverflow 能够向另一个用户发送通知。例如，如果我创建了一个问题，并且有 10 个人对我的问题进行了投票，我会收到一个徽章，而不是当前用户进行投票。

我怎么能在rails中做到这一点？似乎向另一个用户发送消息超出了 Flash 消息的范围。我做了一些研究，也许 faye gem 似乎是一种可能性？但是我并不积极。我在看railscasts，它似乎更适合聊天系统？推送通知是要走的路吗？

什么是这样做的好方法？谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:49:03.210

我可以建议使用这个 gem：[https ://github.com/dapi/gritter_notices](https://github.com/dapi/gritter_notices)

它很好地解决了这个问题，但它有两个缺点：

1.  俄语文档

2.  绑定到砂砾

如果您选择使用它，请查看您使用的 grinter 版本。我记得，原始砂砾的版本前进了一点。

[这部分代码可以满足您的需要。](https://github.com/dapi/gritter_notices_example/blob/master/app/controllers/welcome_controller.rb)

# php - Xpath 和 html 表单操作 post php

> ID：10964321
> 
> 赞同：0
> 
> 时间：2012-06-09T20:21:58.910
> 
> 标签：php, html, xpath, validation

我正在尝试为我创建一些辅助工具。因为我创建了一个交易聚合器，我需要将 xpath 放入我的数据库中，但首先我需要创建一些工具来帮助我进行验证。

我有一个 html 文件，我需要在其中放置 xpath，然后通过操作转到 generatexpath.php 文件，我需要在其中查看我使用 xpath 编写的内容。所以...

```
<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>Untitled Document</title>
</head>

<body>
<form name="form1" method="post" action="generatingxpath.php">

  <p>
    <label for="websource"></label>
    Web source:
    <input name="websource" type="text" id="websource" size="70">
  is:</p>
  <p>

    <label for="links"></label>
    Links:  
    <input name="links" type="text" id="links" size="77">
    OK!
  </p>
  <p>

    <label for="title"></label>
    Title:
    <input name="title" type="text" id="title" size="78">
  is:</p>
  <p>

    <label for="image"></label>
    Image:
    <input name="image" type="text" id="image" size="76">
  show:</p>
  <p>

    <label for="disscount"></label>
    Disscount:
    <input name="disscount" type="text" id="disscount" size="72">
  is:</p>
  <p>

    <label for="price"></label>
    Price:
    <input name="price" type="text" id="price" size="77">
  is:</p>
  <p>

    <label for="description"></label>
    Desription:
    <input name="desription" type="text" id="description" size="72">
  is:</p>
  <p>

    <label for="coordinates"></label>
    Coordinates:
    <input name="coordinates" type="text" id="coordinates" size="70">
  lat,lng is:</p>
  <p>
    <input type="submit" name="Submit" id="Submit" value="Preview">
or    
<input type="submit" name="Add to database" id="Add to database" value="Add To Database">
  </p>
  <p>&nbsp;</p>
</form>
</body>
</html> 
```

我的 php 文件是：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html>

<head>

<title>GENERATING XPATH</title>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

</head>

<body>

<?php

function curl($url){

        $ch = curl_init();

        curl_setopt($ch, CURLOPT_URL, $url);

        curl_setopt($ch, CURLOPT_ENCODING, "gzip");

        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

        $data = curl_exec($ch);

        curl_close($ch);

        return $data;

}

libxml_use_internal_errors(true);

$websource = $_POST["websource"];
$links = $_POST["links"];
$title = $_POST["title"];
$image = $_POST["image"];
$disscount = $_POST["disscount"];
$price = $_POST["price"];
$description = $_POST["description"];
$coordinates = $_POST["coordinates"];

//start generating xpath script

$dom = new DOMDocument(); 

@$dom->loadHTMLFile($websource); 

$xpath = new DOMXPath($dom); 

$entries = $xpath->query($links);

$output = array(); 

$i = 1;

foreach($entries as $e) {   

  $dom2 = new DOMDocument(); 

  @$dom2->loadHTMLFile($websource . $e->textContent); 

  $xpath2 = new DOMXPath($dom2); 

  $data = array();

  $data['websource']= ($websource . $e->textContent);

  $data['title'] = trim($xpath2->query($title)->item(0)->textContent); 

  $data['description'] = trim($xpath2->query($description)->item(0)->textContent); 

  $data['image'] = trim($xpath2->query($image)->item(0)->textContent); 

  $string = $xpath2->query($coordintes)->item(1)->textContent; 

  preg_match_all('#(([0-9-]+){1,3}.([0-9]+))#is', $string, $matches); 

  $data['lat']=$matches[1];
  $data['lng']=$matches[2];
  $data['disscount'] = trim($xpath2->query($disscount)->item(0)->textContent);
    $data['price'] = trim($xpath2->query($price)->item(0)->textContent);

//print to see that all is fine or need to change some xpath direction

  echo $data['websource'];
  echo $data['links'];
  echo $data['title'];
  echo $data['image'];
  echo $data['disscount'];
  echo $data['price'];
  echo $data['lat'];
  echo $data['lng'];
  echo $data['description'];

    $output[] = $data; 

} 

?>

</body>

</html> 
```

我首先在 67 行中遇到了几个错误。对于每个...等

是否有一些简单的解决方案可以让我在同一页面上获得结果，所以要使用 xpath 从某个网站获取文本，但要在 html 页面上显示... ajax？或者其他的东西？

我的问题的最佳解决方案是什么？如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:31:56.753

在 html 和 php 描述/描述不匹配。尝试改变

```
<label for="description"></label>
Desription:
<input name="desription" type="text" id="description" size="72"> 
```

进入这个：

```
<label for="description"></label>
Desription:
<input name="description" type="text" id="description" size="72"> 
```

您可以使用 jQuery $.ajax 从 generatexpath.php 加载文本，而无需重新加载页面。包括 jQuery，你可以在[这里](http://docs.jquery.com/Downloading_jQuery)得到它并使用`<script src="your/folder/jquery.js"></script>` 和加载文本：

```
$.post("generatingxpath.php", {var:$('#input').val()}, function(data) {
     $("#result").html(data);
}); 
```

如果您想使用 jQuery，我建议您阅读 jQuery.com 上的教程/文档

像这样[http://jsfiddle.net/VqPHJ/](http://jsfiddle.net/VqPHJ/)

# jquery - 如何将日期选择器应用于视图中的文本字段？

> ID：10964324
> 
> 赞同：0
> 
> 时间：2012-06-09T20:22:16.933
> 
> 标签：jquery, asp.net-mvc-3

我在我的视图中使用 jQuery datepicker。只要我在这样的 foreach 循环中，我就可以访问日期选择器

```
@foreach (var item in Model) {

    <td>
        @Html.DisplayFor(modelItem => item.AppointmentNo)
    </td>
} 
```

我想在 foreach 循环之外访问日期选择器。我以为我可以做这样的事情？

```
@DateTime.Now.GetDateTimeFormats() 
```

如何将日期选择器格式应用于循环外的输入字段？

以下是我尝试添加到 default.cshtml 和我想要使用它的视图中的文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T23:11:54.610

您是否在母版页中包含了 jquery UI 文件？像这样的东西？

`<script type="text/javascript" src="jquery.ui.all.js"></script>`

# jpa - 搜索 2x 实体 JPA

> ID：10964335
> 
> 赞同：0
> 
> 时间：2012-06-09T20:23:13.773
> 
> 标签：jpa, jpql, criteria-api, named-query

我有两个 JPA 实体，Game 和 GameScore 是连接的。如果玩家加入游戏，则会为他制作一个新的 GameScore。但我需要获得未加入玩家的游戏（没有 GameScore）。我怎么能这样做？我尝试了 NamedQueries 和 CriteraBulder 但没有结果。

游戏终结：

```
package prayForHunt.model;

import java.io.Serializable;
import java.util.Date;
import java.util.List;
import javax.persistence.*;
@Entity
@NamedQueries({
@NamedQuery(name = Game.Q_GET_ALL_GAMES, query = "SELECT c FROM Game c"),
})
  public class Game implements Serializable {

//--------------------------------------------
@Id
@GeneratedValue
private int gameId;
//--------------------------------------------      
@OneToMany(cascade = CascadeType.ALL, mappedBy = "game")
private List<GameScore> gameScore;
} 
```

GameScore 实体

```
package prayForHunt.model;

import java.io.Serializable;
import java.util.List;
import javax.persistence.*;
import javax.persistence.metamodel.SingularAttribute;

@Entity
@NamedQueries(
@NamedQuery(name = GameScore.Q_GET_ALL_GAMESCORE, query = "SELECT c FROM GameScore c")
)
public class GameScore implements Serializable {

@Id
@GeneratedValue
private int gameId;
@ManyToOne
protected Game game;
@ManyToOne
protected Player player;

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T06:07:24.667

因此，结果需要的是所有这样的 Game 实体实例，其中 gameScore**为空**。用于获取没有分数的游戏的 JPQL 查询是（也可以在命名查询中使用）：

```
SELECT g FROM Game g WHERE g.gameScore IS EMPTY 
```

等效条件查询如下：

```
CriteriaBuilder cb = em.getCriteriaBuilder();
CriteriaQuery<Game> cq = cb.createQuery(Game.class);
Root<Game> member = cq.from(Game.class);
cq.select(member)
  .where(cb.isEmpty(member.<Collection>get("gameScore")));        
em.createQuery(cq).getResultList(); 
```

# mysql - Sql 查询以保持“计数”已删除的行

> ID：10964337
> 
> 赞同：2
> 
> 时间：2012-06-09T20:23:41.113
> 
> 标签：mysql, sql, database

我有一个分类网站...我正在尝试进行一个 sql 查询来计算用户在过去 7 天内发布的广告数量，但我有一个问题...

我试图在用户个人资料中显示类似这样的内容，例如：*[用户名]在过去 7 天内发布了 30 个广告*

这是我的sql查询->

```
SELECT COUNT(*) 
FROM table_name 
WHERE user_id = '[user_id]' AND created_date > NOW() - INTERVAL 7 DAY 
```

因此，在我的情况下，“table_name”包含来自所有用户的所有广告，并且通过“ `user_id`='[user_id]'”我向用户 A 展示了他的广告数量，并向用户 B 展示了他的广告数量等......

所以这个查询有效，它正确计算了广告的数量，但是，如果例如用户在网站上输入并删除了 1,2 或他的广告的任何数量，这个数字将从“[用户名]已发布 30过去 7 天的广告”

1.  假设用户在过去 5 天内发布了 20 个广告 - 正确的结果是*[用户名] 在过去 7 天内发布了 20 个广告*
2.  现在用户进入网站并删除了 4 个广告 - 现在结果是*[用户名] 在过去 7 天内发布了 16 个广告*

有人可以帮我吗，我可以在查询中添加什么，以便计数仍然显示正确的广告数量（在我的情况下为 20 个广告），即使广告被删除..

谢谢干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T20:26:12.537

不要使用语句删除一行`DELETE ... WHERE ...`，而是添加一`deleted`列并使用`UPDATE`语句：

```
UPDATE ... SET deleted = 1 WHERE ... 
```

然后您的计数功能将无需修改即可工作。

当然，您现在必须修复所有其余代码以不显示已删除的广告。您可以通过添加`WHERE NOT deleted`到所有其他查询来做到这一点。您还可以创建一个仅显示未删除的广告的视图，并更新您的代码以查询此视图而不是原始表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T20:26:52.410

与其从系统中删除广告，不如添加一个“已删除”标志，或将它们移动到已删除的表格中。这样您就永远不会丢失他们的记录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T20:30:43.933

您无法向查询中添加任何内容来查找已删除的数据。您无需*删除*数据，而是向用户要删除的记录添加一个标记，以*表明*它已从显示中删除。

除了允许对记录进行计数之外，它还有一个**额外的优势**，即如果用户愿意，可以允许他恢复该广告。

# windows - 如何将一个图像的 URL 重定向到另一个（在 Windows 级别）？

> ID：10964340
> 
> 赞同：0
> 
> 时间：2012-06-09T20:23:59.430
> 
> 标签：windows, redirect

我不知道我的问题是否符合这个网站，因为我不询问服务器端重定向或 JavaScript 重定向。我询问有关 Windows 中的重定向，例如在描述规则的 hosts-file 中发生这种情况。但那里只能描述主机和 IP 的规则，而不是单独图像的 URL。

我需要的是一种替代品。当任何浏览器请求一张图片时，它会从本地或另一个 URL 获取另一张图片。

有人有什么想法吗？

# sql - PostgreSQL 的解释中的“宽度”字段是什么意思？

> ID：10964346
> 
> 赞同：31
> 
> 时间：2012-06-09T20:25:08.537
> 
> 标签：sql, postgresql

例如，来自[解释文档](http://www.postgresql.org/docs/8.3/static/using-explain.html)：

```
解释 SELECT * FROM tenk1;

                         查询计划
-------------------------------------------------- ------------
 tenk1 上的 Seq 扫描（成本=0.00..458.00 行=10000 宽度=244）

```

是什么`width=244`意思？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-09T20:27:50.050

这是“此计划节点输出的行的估计平均宽度（以字节为单位）”

基本上返回的每一行都是 244 字节。

有关详细信息，请参阅[解释。](http://www.postgresql.org/docs/current/static/using-explain.html)

# excel - Excel：小计的条件格式

> ID：10964347
> 
> 赞同：0
> 
> 时间：2012-06-09T20:25:14.020
> 
> 标签：excel

每当我在 Excel 中自动生成小计时，只会以粗体添加“小计”标签，而不是结果。我想用粗体显示完整的“小计”行。

我已经尝试过[这里](http://www.ozgrid.com/Excel/excel-bold-subtotals.htm)的教程，但由于某种原因，我根本无法让公式起作用，即没有任何反应。我自己尝试了其他一些公式，但即使是最简单的公式也不起作用。

我应该在条件格式中使用什么公式来在添加时以粗体显示完整的小计行？我正在使用 Excel 2010。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T18:01:38.297

好吧，这是一个相当简单的问题：我使用逗号而不是分号来分隔公式中的参数（我知道......）。很抱歉在问题上浪费了您的时间：一夜好眠就足够了：P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T08:55:00.857

使用此处描述的 USerDefined 函数 isBold：[http](http://www.excelforum.com/excel-programming/398006-checking-whether-a-field-is-bold.html) ://www.excelforum.com/excel-programming/398006-checking-whether-a-field-is-bold.html和通过公式的条件格式。

# iis - IIS SQL Server 凭据

> ID：10964357
> 
> 赞同：0
> 
> 时间：2012-06-09T20:27:33.737
> 
> 标签：iis, sql-server-2008-r2, credentials

我已经向 IIS 添加了一个网站，并且我已将 networkuser 和 IIS 用户设置为该属性，但是当我尝试浏览该站点时，每个静态页面都可以正常打开，但每个动态页面都不能正常打开。

我正在使用 SQL Server 2008 R2 并且我创建了一个用户名和密码来从我的应用程序连接到数据库，当我从 Visual Studio 运行网站时它可以正常工作，但从 IIS 却不能。我应该怎么办？

我已经在 SQL Server 中尝试了 sa 用户，但它没有用。

# matlab - MATLAB。8 球池 Flash 游戏的图像处理。小骗子。呵呵

> ID：10964363
> 
> 赞同：1
> 
> 时间：2012-06-09T20:28:08.633
> 
> 标签：matlab, image-processing

见下图。这是来自知名网站的 Flash 游戏 :)

[http://imageshack.us/photo/my-images/837/poolu.jpg/](http://imageshack.us/photo/my-images/837/poolu.jpg/)

我想使用 Matlab 逐帧捕捉图像，然后加长从 8 球开始的线，短球，所以我可以准确地看到它会去哪里。并显示另一个窗口，其中将显示确切的台球桌，但路径的行更长:)

我知道，或者可以很容易地发现，如何捕捉屏幕等等，问题是我不确定如何开始检测这些线条，看看它们走向的方向。任何人都可以提出如何实现这一目标的想法吗？我可以使用任何图像处理技术至少过滤掉除这些行之外的所有内容。不知道从哪里开始寻找，或者是为了什么。

是的，我知道这是个骗局。但是我有编程技能，为什么不把它们付诸实践呢？:D 帮帮我，这是一个有趣的项目 :)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:46:52.853

我会尝试在[Matlab 图像处理工具箱中使用](http://www.mathworks.com/help/toolbox/images/ref/hough.html)[霍夫变换](http://en.wikipedia.org/wiki/Hough_transform)。

EDIT1：基本上霍夫变换是一种检测图像中线性结构（线）的技术。

# java - net.sourceforge.jtds.jdbc.Driver 中的 setAutoCommit() 中是否存在“set chained”错误？

> ID：10964365
> 
> 赞同：1
> 
> 时间：2012-06-09T20:28:34.750
> 
> 标签：java, jdbc, transactions, sybase, jtds

我对方法中的`set chained`声明有些困惑`setAutoCommit()``net.sourceforge.jtds.jdbc.Driver`

[源代码](http://grepcode.com/file/repo1.maven.org/maven2/net.sourceforge.jtds/jtds/1.2.2/net/sourceforge/jtds/jdbc/ConnectionJDBC2.java)说：

```
2161  if (serverType == Driver.SYBASE) {
2162            if (autoCommit) {
2163                sql.append("SET CHAINED OFF");
2164            } else {
2165                sql.append("SET CHAINED ON");
2166            } 
```

但是，**它不应该倒退吗，并且对于 autoCommit==false 应该关闭链接？**

* * *

我遇到这个的原因如下：

我正在编写一个 Java 应用程序，它需要执行一些复杂的 SQL 并在其中任何一个失败时回滚所有这些：

*   使用打开 Sybase 连接`net.sourceforge.jtds.jdbc.Driver`

*   调用 setAutoCommit(false)

*   做 SQL1

*   调用存储过程“MySP1”

    *   存储过程 MySP1' 不在我的控制之下

    *   它有`EXEC sp_procxmode 'dbo.MySP1','unchained'`

*   做 SQL2

*   如果 SQL2 失败，则回滚所有内容（包括 SQL1），否则提交。

完成后，我从 MySP1 收到以下错误：

```
 Stored procedure 'MySP1' may be run only in unchained transaction mode. The 'SET CHAINED OFF' command will cause the current session to use unchained transaction mode. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T09:44:22.250

我遇到了几乎相同的问题，并通过运行以下 SQL 解决了它。希望它可以帮助你。

```
sp_procxmode your_stored_Procedure, 'anymode' 
```

在您的情况下**your_stored_Procedure = MySP1**那么您应该运行以下代码：

```
 sp_procxmode MySP1, 'anymode' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-04T22:43:58.953

以防万一有人在漫长的 7 年后看到这里，

我已经让它工作了

```
connection.setAutoCommit(false); // this is mandatory, as without it jTDS will commit each statement. 
```

在 java 中，并显式执行 SQL 代码：

```
SET CHAINED OFF
begin transaction 
```

# java - 从给定的 Map 到 json 字符串（或 JSONObject）

> ID：10964368
> 
> 赞同：0
> 
> 时间：2012-06-09T20:29:21.693
> 
> 标签：java, json, map

在 Java 中，我通过 post 传递了这些键/值对（例如）：

```
form_id=undefined

frmb[0][cssClass]=input_text

frmb[0][required]=checked

frmb[0][values]=First Name

frmb[1][cssClass]=input_text

frmb[1][required]=checked

frmb[1][values]=Last Name

frmb[2][cssClass]=textarea

frmb[2][required]=undefined

frmb[2][values]=Bio

frmb[3][cssClass]=checkbox

frmb[3][required]=undefined

frmb[3][title]=What's on your pizza?

frmb[3][values][2][baseline]=undefined

frmb[3][values][2][value]=Extra Cheese

frmb[3][values][3][baselise]=undefined

frmb[3][values][3][value]=Pepperoni

frmb[3][values][4][baseline]=undefined

frmb[3][values][4][value]=Beef

frmb[4][cssClass]=radio

frmb[4][required]=undefined

frmb[4][title]=Do you like pizza?

frmb[4][values][2][baseline]=checked

frmb[4][values][2][value]=Yes

frmb[4][values][3][baseline]=undefined

frmb[4][values][3][value]=No

frmb[5][cssClass]=select

frmb[5][multiple]=checked

frmb[5][required]=checked

frmb[5][title]=Select a pizza type:

frmb[5][values][2][baseline]=checked

frmb[5][values][2][value]=Margherita

frmb[5][values][3][baseline]=undefined

frmb[5][values][3][value]=Napoli

frmb[5][values][4][baseline]=undefined

frmb[5][values][4][value]=Marinara 
```

我必须创建以下 json：

```
[{"cssClass":"input_text","required":"checked","values":"First Name"},{"cssClass":"input_text","required":"checked","values":"Last Name"},{"cssClass":"textarea","required":"undefined","values":"Bio"},{"cssClass":"checkbox","required":"undefined","title":"What's on your pizza?","values":{"2":{"value":"Extra Cheese","baseline":"undefined"},"3":{"value":"Pepperoni","baseline":"undefined"},"4":{"value":"Beef","baseline":"undefined"}}},{"cssClass":"radio","required":"undefined","title":"Do you like pizza?","values":{"2":{"value":"Yes","baseline":"checked"},"3":{"value":"No","baseline":"undefined"}}},{"cssClass":"select","required":"checked","multiple":"checked","title":"Select a pizza type:","values":{"2":{"value":"Margherita","baseline":"checked"},"3":{"value":"Napoli","baseline":"undefined"},"4":{"value":"Marinara","baseline":"undefined"}}}] 
```

我该怎么办？

我没有成功**解析键**，对组成相同 JSONObject 的元素进行分组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:36:47.613

您可以为此使用[Gson](https://code.google.com/p/google-gson/)库。它不支持嵌套映射的序列化（我假设您的输出表示嵌套映射）。[您可以按照此线程](https://stackoverflow.com/questions/4547739/how-to-serialize-a-map-of-a-map-with-gson)中的说明编写自定义序列化器/反序列化器或创建自己的序列化方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:11:38.923

你可以这样做：

```
JSONArray jsonItems = new JSONArray();

for (int i = 0; i < frmb.size(); i++) {  

JSONObject json = new JSONObject();  
json.put("cssClass", frmb[i][cssClass]);  
json.put("required",frmb[i][required]);  
//put json object to json array  
jsonItems.put(json);   
} 
```

[在这里](http://fundapass.blogspot.in/2012/06/j-ason-in-java-nbthis-is-not.html)查看更多详情

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-16T19:33:46.723

我通过解析键和使用两个临时哈希表构建 JSONObjects 来解决。

# sql - 在 Microsoft Visual Studio 中学习 SQL

> ID：10964371
> 
> 赞同：0
> 
> 时间：2012-06-06T13:43:17.623
> 
> 标签：sql

首先，如果这个问题出现在错误的地方，我们深表歉意。

我是一名学生，昨天刚刚开始学习 SQL，使用 SQL*Plus 命令行界面。到目前为止这很好 - 我已经创建并填充了表，运行简单的查询并可以假脱机到文件等。但我想要一种更“可视化”的方法来帮助我理解（即我希望能够*在我处理“对象”时看到*它们（就像我开始学习 Java 时的 BlueJ）。任何免费软件都可以做到这一点吗？

我有 Microsoft Visual Studio Professional 2012（我是新手）——这有可能吗？我可以创建一个新的 SQL 文件，但如果没有“真实世界数据库”，我是否可以以与我一直在执行的命令行 SQL 类似的方式实际运行命令？

任何帮助都将是绝对惊人的。抱歉，如果我误解了任何内容或很简单 - 我已经使用 SQL*Plus 等几个小时了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T20:46:03.290

Visual Studio 确实支持设计 SQL 数据库。但是，我认为管理数据库的最佳选择是 SQL Server Management Studio。

大多数 SQL Server 安装都附带 SSMS，但如果未安装，则必须重新运行安装程序才能安装它。

SSMS 支持运行任意 SQL 查询，您可能已经习惯了。它还支持强大的 GUI 界面（基于 VS 界面），用于处理各种数据库对象。您可以完全设计和填充数据库，而无需手动编写任何 SQL。如果需要，您甚至可以进行更改，并查看生成的 SQL 以更改数据库。

试试看，祝你学习 SQL 好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T20:56:18.900

几个月前我刚在你的船上。我不得不使用 SQL Server、LINQ 和 C# 自学 SQL 的 .NET 方面，并希望与您分享我的经验。

事实上，[SQL Server Management Studio](http://en.wikipedia.org/wiki/SQL_Server_Management_Studio) (SSMS) 是建立在 Visual Studio 之上的。根据我的经验，我的计算机上同时安装了 SQL Server 2012 和 Visual Studio 2010/2012。在 Visual Studio 中查找名为“SQL Connect”的扩展。它支持表格的 GUI 构建。

至于免费软件，如果你是像我这样的学生，你应该有资格参加 Dreamspark 计划。Microsoft 慷慨地允许其几乎所有开发软件（包括一些免费赠品，如 Windows 7 Professional、OneNote 和 Lync 的免费副本）的学术许可证。

我强烈推荐的补充您学习的一本书是“SQL Visual Quickstart Guide (3rd Edition)”，这本电子书只需约 15 美元。此外，SQL Server 上的 Pluralsight 视频也有很大帮助，您将通过 Dreamspark 获得三个月的免费试用期。MSDN 网站上也有大量示例教您使用 Adventureworks 数据库，这些示例应该在 Microsoft [CodePlex](http://en.wikipedia.org/wiki/CodePlex)上。

快乐学习！

# haskell - Text.Printf 与 Data.Text？

> ID：10964375
> 
> 赞同：19
> 
> 时间：2012-06-09T20:30:19.333
> 
> 标签：haskell

`Data.Text`在将它们打印出来进行调试之前，我一直厌倦了解包实例，并认为只是`Text.Printf`用于此目的。不幸的是，我无法让它工作：

```
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE ScopedTypeVariables #-}
import Data.Text
import Text.Printf

--instance PrintfArg Text where
--  toUPrintf = toUPrintf . unpack

main :: IO ()
main = do
  let input :: Text = "abc"
  printf "Input: %s\n" input 
```

错误：

```
src/Main.hs:12:3:
    No instance for (PrintfArg Text)
      arising from a use of `printf'
    Possible fix: add an instance declaration for (PrintfArg Text)
    In a stmt of a 'do' block: printf "Input: %s" input
    In the expression:
      do { let input :: Text = "abc";
           printf "Input: %s" input }
    In an equation for `main':
        main
          = do { let input :: Text = ...;
                 printf "Input: %s" input } 
```

取消注释实例声明后：

```
src/Main.hs:7:7:
    `toUPrintf' is not a (visible) method of class `PrintfArg'
src/Main.hs:7:19: Not in scope: `toUPrintf' 
```

有任何想法吗？

已编辑

正如建议的那样，尝试了 TH，仍然不行：

```
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE ScopedTypeVariables #-}
{-# LANGUAGE TemplateHaskell #-}
import Data.Text
import Language.Haskell.TH
import Text.Printf

runQ [d| instance PrintfArg Text where toUPrintf = toUPrintf . unpack|]

main :: IO ()
main = do
  let input :: Text = "abc"
  printf "Input: %s\n" input 
```

错误：

```
src/Main.hs:9:40:
    'toUPrintf' is not a (visible) method of class 'PrintfArg'
src/Main.hs:9:52: Not in scope: 'toUPrintf' 
```

帮助！令人惊讶的是，鉴于默认情况下使用 Data.Text 的所有建议，这并不是开箱即用的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-09T23:27:44.757

**警告：文本格式未维护，作者在 2 年内没有回复。查看其他答案。**

* * *

我会看一下[text-format](http://hackage.haskell.org/package/text-format)包：它类似于`Text.Printf`，但专门为`Data.Text.Lazy`.

文本格式还有其他一些优点`Text.Printf`：

*   该类[`Buildable`](http://hackage.haskell.org/packages/archive/text-format/0.3.0.7/doc/html/Data-Text-Buildable.html)是公开的，因此可以对其进行扩展以支持新的参数类型。
*   它对可变参数使用了一种更简单的方法，从而回避`Text.Printf`了[访问返回值](http://www.serpentine.com/blog/2009/09/25/riddle-me-this/)时遇到的问题。
*   它应该更快，有几个原因：
    *   它永远不会转换为低效的`String`表示；
    *   它不构建中间数据类型，不像[`UPrintf`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/src/Text-Printf.html#UPrintf);`Text.Printf`
    *   它使用[双转换](http://hackage.haskell.org/package/double-conversion)包来渲染`Double`和`Float`，比 Prelude 的方法[快大约 30 倍。](http://www.serpentine.com/blog/2011/06/29/here-be-dragons-advances-in-problems-you-didnt-even-know-you-had/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-27T07:32:20.593

自从提出这个问题以来，`base`和`text`库已经更新以支持这一点。如果您有*base >= 4.7.0.0*和*text >= 1.2.2.0*，那么 OP 的 MWE 实际上可以工作：

```
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE ScopedTypeVariables #-}
import Data.Text
import Text.Printf

main :: IO ()
main = do
  let input :: Text = "abc"
  printf "Input: %s\n" input 
```

输出：

```
$ ghci
GHCi, version 8.2.2: http://www.haskell.org/ghc/  :? for help
Prelude> :l test.hs
[1 of 1] Compiling Main             ( test.hs, interpreted )
Ok, one module loaded.
*Main> main
Input: abc
*Main> 
Leaving GHCi. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T20:53:51.450

从文档中：

> HPrintfType 类为 hPrintf 提供了变量参数魔法。从这个模块中故意看不到它的实现。

虽然您可以使用 TH 生成 HPrintfType 实例（因为 TH 忽略导出限制），但最简单的解决方案可能是`printf'`类型函数：

```
printt :: PrintType r => Text -> r
printt = printf . Data.Text.unpack 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-02T11:37:42.293

另一个值得一试的包：[格式化](http://hackage.haskell.org/package/formatting/docs/Formatting.html)

> 文本的基于组合器的类型安全格式（如 printf() 或 FORMAT）。
> 
> 例子：
> 
> ```
> format ("Person's name is " % text % ", age is " % hex) "Dave" 54 
> ```

# php - 有什么函数可以在两个数组中获取共同元素？

> ID：10964376
> 
> 赞同：-2
> 
> 时间：2012-06-09T20:30:20.843
> 
> 标签：php

有没有做逆运算的函数`array_diff()`？

我的意思是，如果我有：

```
array(1,2,3)
array(3,4,5) 
```

我想那个函数返回`array(3)`，或者直接返回`3`。

注意：`array_intersect()`不适合我。

哈维尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T20:45:52.123

如果 `array_intersect() doesn't fit me`是因为它返回：

```
Array
(
    [2] => 3
) 
```

并不是：

```
Array
(
    [0] => 3
) 
```

或者 `3`

然后您可以轻松地将数组转换为可使用[array_values()](http://php.net/manual/en/function.array-values.php)的东西：

```
<?php 
$arr1 = array(1,2,3);
$arr2 = array(3,4,5);

$new = array_values(array_intersect($arr1,$arr2));
$new = $new[0];
print_r($new); //3
?> 
```

否则请说明您的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T20:36:22.127

尝试[array_intersect()](http://php.net/manual/en/function.array-intersect.php)这将计算数组的交集

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T20:50:46.157

由于您不想使用`array_intersect()`，请检查此低效方法：

```
$arr1= array(1,2,3);
$arr2= array(3,4,5);

function arr_intersect($array1, $array2)
{
    $array_result=array();
    $array_shared = array_diff($array1+$array2, array_diff($array1, $array2));
    $count=count($array_shared);

    return array_values($array_shared);
}

print_r(arr_intersect($arr1, $arr2)); 
```

# javascript - 使用名称 jquery 通过索引获取 id 值

> ID：10964378
> 
> 赞同：4
> 
> 时间：2012-06-09T20:30:49.477
> 
> 标签：javascript, jquery, html

**html**

```
<input id="1" name="myText" type="text" value="20"/>
<input id="2" name="myText" type="text" value="30"/>
<input id="3" name="myText" type="text" value="40"/> 
```

如何`index`使用名称获取 id 值？

以下代码段不起作用

```
var getVal = $('[name="myText"]').index(1); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-09T20:33:30.913

jQuery 像数组一样保存集合中的 DOM 元素，因此您可以使用索引 operator( ) 来获取元素，或者使用`.eq(n)``[]`获取包装所需元素的 jQuery 对象`:eq(n)`

```
$('input[name="myText"]:eq(1)').attr('id') 
```

你应该提到你认为是`index(1)`第一个或第二个的：

```
$('input[name="myText"]:eq(0)').attr('id') // First
$('input[name="myText"]:eq(1)').attr('id') // Second 
```

或者：

```
$('input[name="myText"]')[0].id // First 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T20:33:14.270

如果要第一个值，可以过滤，使用`attr`方法获取id属性的值。

```
var getVal = $('[name="myText"]:first').attr('id'); // first id 
```

如果您需要其他元素，您可以使用`eq`并选择集合中从零开始的元素。

```
var getVal = $('[name="myText"]:eq(1)').attr('id'); // second id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T20:32:59.597

我的回答是指通过索引访问 jQuery 结果对象中的元素。您可以使用[`:eq`](http://api.jquery.com/eq-selector/)其他答案中指示的选择器。

但是，您可以使用[`.get(1)`](http://api.jquery.com/get/)代替您的`index`.

```
var id = $('[name="myText"]').get(1).id; 
```

相当于

```
var id = $('[name="myText"]:eq(1)').attr('id'); 
```

示例：http: [//jsfiddle.net/HackedByChinese/UmKw6/1/](http://jsfiddle.net/HackedByChinese/UmKw6/1/)

第二种方法是首选路线，因为这意味着您永远不会离开`jQuery`结果对象，因此可以在一个语句中链接其他 jQuery 调用。

```
var id = $('[name="myText"]:eq(1)').css('color', 'red').attr('id'); // example of chaining jQuery methods. sets the text color to red and then returns the id. 
```

# c++ - 列表和多线程环境

> ID：10964383
> 
> 赞同：3
> 
> 时间：2012-06-09T20:31:28.827
> 
> 标签：c++, multithreading, list, stl

我对 C++ 标准库相当陌生，并且一直在使用标准库列表来实现特定的多线程实现。我注意到使用列表可能有一个技巧，我在任何教程/博客/论坛帖子上都没有见过，尽管对我来说似乎很明显，但似乎没有人考虑过。所以也许我太新了，可能错过了一些东西，所以希望比我更聪明的人可以验证我正在努力实现的目标或向我解释我做错了什么。

所以我们知道，一般标准库容器不是线程安全的——但这似乎更像是一个指导性声明而不是规则。对于列表，似乎对线程安全有一定程度的容忍度。让我解释一下，我们知道，如果我们从列表中添加/删除，列表不会失效。唯一无效的迭代器是已删除的项目 - 您可以使用以下代码行修复它：

```
it = myList.erase(it) 
```

所以现在假设我们有两个线程，分别称为线程 1 和线程 2。

线程 1 的职责是添加到列表中。它将它视为一个队列，因此它使用 std::list::push_back() 函数调用。

线程 2 的职责是将存储在列表中的数据作为队列处理，然后在处理后从列表中删除元素。

它保证线程 2 不会删除列表中刚刚在其处理期间添加的元素，线程 1 保证它将提前为线程 2 的处理排队必要的数据。但是，请记住，可以在线程 2 的处理过程中添加元素。

所以看起来这是在这个多线程环境中合理使用列表而不使用锁来保护数据。我之所以说它是合理的，是因为从本质上讲，线程 2 只会处理到目前为止的数据，以便它可以检索以下伪代码所示的当前结束迭代器：

```
Thread 2 {
    iter = myList.begin();
    lock();
    iterEnd = myList.end(); // lock data temporarily in order to get the current 
                            // last element in the list
    unlock();
    // perform necessary processing
    while (iter != iterEnd) {
        // process data
        // ...
        // remove element
        iter = myList.erase(iter);
    }
} 
```

线程 2 在很短的时间内使用锁只是为了知道在哪里停止处理，但在大多数情况下，线程 1 和线程 2 不需要任何其他锁定。此外，如果知道当前最后一个元素的范围是灵活的，线程 2 也可以避免锁定。

有人认为我的建议有什么问题吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T20:53:07.937

你的程序很活泼。作为一个明显的数据竞赛的一个例子： `std::list`不仅仅是一个双重链接节点的集合。例如，它还有一个数据成员，用于存储列表中的节点数（它不必是单个数据成员，但必须将计数存储在某处）。

您的两个线程将同时修改此数据成员。因为这些修改没有同步，所以你的程序很活泼。

标准库容器的实例不能在没有外部同步的情况下同时从多个线程中进行变异。

# database-design - 使用数组获取权限

> ID：10964384
> 
> 赞同：0
> 
> 时间：2012-06-09T20:31:36.357
> 
> 标签：database-design

我正在使用 Ruby on Rails，但我认为这个问题可以应用于任何数据库设计。我正在尝试开发自己的权限系统。

拥有一组用户可以编辑的内容是糟糕的设计吗？即 a`User`有一列`can_edit`值为`[Articles, Events, Costs]`或 a`User` `can_view`值为 `[All]`。

然后我可以检查正在编辑的内容。或者这是糟糕的设计？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T21:20:48.360

一般来说，您的数据库设计应该正确规范化。这意味着您不应该在一行中存储多个值。具有三张桌子的设计可能会为您提供更好的服务

*   `Permission`有列`permission_id`并且`permission_type`列出了有效的权限
*   `User`有一`user_id`列并列出了价值用户
*   `User_Permission`是两者之间的映射表。它有列`permission_id`，`user_id`这两个列分别被定义为`Permission`和`User`表的外键

# php - XMLHttpRequest 发送 XML 到 PHP 服务器

> ID：10964387
> 
> 赞同：0
> 
> 时间：2012-06-09T20:31:53.097
> 
> 标签：php, javascript, xml, post, xmlhttprequest

我想知道是否可以将一些数据以 XML 格式从客户端（使用 HTML5 画布的 2d 应用程序）发送到服务器端？

我试过这样的事情：

```
function send_xml_data_to_server(xml, url) {
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open("POST", url, true);
    xmlhttp.setRequestHeader('Content-Type', 'text/xml');
    xmlhttp.send(xml);

    xmlhttp.onreadystatechange = function() {
        callback_response_from_server(xmlhttp);
    }
} 
```

因为在我必须发送到服务器端的信息中，它包含一些文本，并且它似乎与 MIME 不太兼容：

```
xmlhttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); 
```

但是当我在服务器端时，我检查了 $_POST 但里面没有任何内容，对于 $_REQUEST 也是如此。

所以，最后，我想知道是否可以使用 XMLHttpRequest 将 XML 数据发送到服务器端 PHP？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T20:37:06.570

客户端没有任何问题，但`$_POST`包含一组已解析的键/值对，但这不是您发送到服务器的内容。使用这样的东西：

```
file_get_contents('php://input'); 
```

然后，您可以使用 SimpleXML 或任何您喜欢的方式解析字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:37:16.490

如果您不将数据作为 application/x-www-form-urlencoded 发送，$_POST 将为空。

你试过这个吗？

```
$xml = file_get_contents("php://input"); 
```

这样，您将以原始格式捕获数据并根据使用的 mime 类型对其进行解释。

# symfony - 覆盖注册 FOSUserBundle Symfony2

> ID：10964388
> 
> 赞同：4
> 
> 时间：2012-06-09T20:31:57.373
> 
> 标签：symfony

我正在尝试覆盖 FOSUserBundle 中的注册表单，但出现此错误：我已按照官方文档中的本教程进行操作： [链接](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/overriding_forms.md)

```
Could not load type "uae_user_registration" 
```

我的文件是：services.yml

```
# src/Uae/UserBundle/Resources/config/services.yml 
services:
    uae_user.registration.form.type:
        class: Uae\UserBundle\Form\Type\RegistrationFormType
        arguments: [%fos_user.model.user.class%]
        tags:
        - { name: form.type, alias: uae_user_registration } 
```

配置.yml：

# 应用程序/配置/config.yml

```
fos_user:
    db_driver:     orm                         
    firewall_name: main                       
    user_class:    Uae\UserBundle\Entity\User 
    registration:
            form:
                type: uae_user_registration 
```

注册表格类型：

```
<?php
#src/Uae/UserBundle/Form/Type/RegistrationType.php

namespace Uae\UserBundle\Form\Type;

use Symfony\Component\Form\FormBuilderInterface;
use FOS\UserBundle\Form\Type\RegistrationFormType as BaseType;

class RegistrationFormType extends BaseType
{
public function buildForm(FormBuilderInterface $builder, array $options)
{
    parent::buildForm($builder, $options);

    // add your custom field
    $builder->add('nom');
    $builder->add('prenom');
}

public function getName()
{
    return 'uae_user_registration';
}
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-11T16:19:40.067

我解决了我的问题：我刚刚导入了我在配置文件 app\config\config.yml 中创建的新服务

```
imports:
    - { resource: @UaeUserBundle/Resources/config/services.yml } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-13T23:39:38.137

您收到错误的原因是因为您没有针对特定捆绑包的 DependencyInjection。该程序不知道在哪里查找您的 services.yml 文件。

您需要在 User Bundle 下的 DependencyInjection 文件夹中添加 UaeUserExtension.php 和 Configuration.php。

解决这个问题的简单方法是通过 app/console generate:bundle 生成包。这样，它将自动为您创建 DependencyInjection。

手动解决方案是在您的 Uae/UserBundle 中创建一个 DependencyInjection 文件夹。在 DependencyInjection 中，创建一个名为 Configuration.php 的文件并将内容放在下面：

```
<?php

namespace Uae\UserBundle\DependencyInjection;

use Symfony\Component\Config\Definition\Builder\TreeBuilder;
use Symfony\Component\Config\Definition\ConfigurationInterface;

class Configuration implements ConfigurationInterface
{
    /**
     * {@inheritDoc}
     */
    public function getConfigTreeBuilder()
    {
        $treeBuilder = new TreeBuilder();
        $rootNode = $treeBuilder->root('uae_user');

        return $treeBuilder;
    }
} 
```

并在同一目录中创建一个名为 UaeUserExtension.php 的文件并将这些内容放入其中：

```
<?php

namespace Uae\UserBundle\DependencyInjection;

use Symfony\Component\DependencyInjection\ContainerBuilder;
use Symfony\Component\Config\FileLocator;
use Symfony\Component\HttpKernel\DependencyInjection\Extension;
use Symfony\Component\DependencyInjection\Loader;

class EnergyUserExtension extends Extension
{
    /**
     * {@inheritDoc}
     */
    public function load(array $configs, ContainerBuilder $container)
    {
        $configuration = new Configuration();
        $config = $this->processConfiguration($configuration, $configs);

        $loader = new Loader\YamlFileLoader($container, new FileLocator(__DIR__.'/../Resources/config'));
        $loader->load('services.yml');
    }
} 
```

# php - 保护远程服务器上的下载

> ID：10964399
> 
> 赞同：5
> 
> 时间：2012-06-09T20:33:16.593
> 
> 标签：php, wordpress

我有 2 台服务器。在服务器 1 上，我有一个 WordPress 网站。在服务器 2 上，我希望 WordPress 站点的成员能够下载大型 .zip 文件。

如何对这些用户进行身份验证，以便只有网站成员才能从第二台服务器下载文件？

是否可以使用 PHP，以便只有来自我的域的引用者才能访问这些文件？

注意：下载文件的链接在 wordpress 网站上受到保护，因此未登录的用户被重定向到加入页面。但是，当前和前成员仍然会知道下载所在的目录，并且可能会下载文件或共享链接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T21:07:33.683

有几种方法可以做到这一点。最安全的方法是在服务器 1 和服务器 2 之间进行一些后端通信。但这里有一个简单的替代方案：

**服务器 2：下载.php**

```
<?PHP
 $file = $_GET['f'];
 $code = $_GET['c']; 
 $ip = $_SERVER['REMOTE_ADDR'];

 if ($code != md5($ip . 'salt')) {
    die('authentication denied');
 }

 if(!file)
 {
     die('file not found');
 }

 // Set headers
 header("Cache-Control: public");
 header("Content-Description: File Transfer");
 header("Content-Disposition: attachment; filename=$file");
 header("Content-Type: application/zip");
 header("Content-Transfer-Encoding: binary");

 // Read the file from disk
 readfile('/files/downloads/' . $file);

?> 
```

**服务器 1：下载链接**

```
<?PHP
 echo '<a href="http://server2.com/download.php?f=text.txt&c=' . md5($_SERVER['REMOTE_ADDR'] . 'salt') / '">Download File</a>';
?> 
```

该系统通过创建一个链接来工作，该链接只能在为其生成的 IP 上使用。因此，注册用户无法在其他地方共享链接。这不是最安全的事情，但它很容易实现并且会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T22:06:36.173

一些巧妙的解决方案可能是使用基于当前时间的令牌系统。您可以获取一天中的当前时间并用一些盐对其进行哈希处理，并将其作为令牌放入查询字符串中。第二台服务器上的 php 脚本可能会检查查询字符串哈希是否相同，因为在服务器端使用相同的盐为一天中的当前时间生成哈希。

为确保用户不会达到小时切换时间，您也可以检查前一小时的哈希值。

它使您可以确定文件 url 的可用时间不会超过两个小时，并保证可用时间为一小时。

在服务器 1 上：

```
<?php
echo '<a href="server2.com/download.php?token='.md5(date('G')+'secret_word').'&file=file.zip">Link</a>';
?> 
```

在服务器 2 上：

```
<?php
current_hour_hash = md5( date('G').'secret_word' );
previous_hour_number = ( int(date('G')) - 1 ) % 24;
previous_hour_hash = md5( str(previous_hour_number).'secret_word' );
if($_GET['token']!= current_hour_hash and $_GET['token']!= previous_hour_hash){
    die();
}else{
    ... //code sending file here
} 
```

# c++ - 静态库隐藏其他静态库中的符号

> ID：10964405
> 
> 赞同：1
> 
> 时间：2012-06-09T20:33:43.253
> 
> 标签：c++, visual-c++

我的 .exe 项目依赖于外部静态库 A.lib 和 B.lib。

**问题**：库 B 内部也使用库 A 并导出其符号。但是使用的 A 版本与 A.lib 不同 - 并且与我的应用程序不兼容。

将我的应用程序与 A.lib 和 B.lib 链接时，B.lib 中包含的 A 符号隐藏了 A.lib 中的正确符号。虽然链接成功，但我的应用程序无法正常工作。

将 B.lib 的所有用法分解到另一个静态库 C.lib 中并没有帮助：C.lib 仍然从 B.lib 导出所有符号。

如果没有以下变通办法，这可以解决吗？

*   动态链接。

*   用我的 A.lib 版本重新构建 B。（我可以访问 B 的来源。）

    这可能会在 B 中引起未知的副作用。

（在我的具体情况下，A.lib 是[Freetype](http://freetype.sourceforge.net/index2.html)而 B.lib 是[SFML](http://www.sfml-dev.org/) - 但问题是普遍的。）

# android - Android：在新活动上暂停和重新启动音频，但在屏幕旋转时暂停和恢复

> ID：10964407
> 
> 赞同：1
> 
> 时间：2012-06-09T20:34:07.407
> 
> 标签：android, audio, rotation, restart

我有一个 android 应用程序，在我的主要活动中，我可以播放音乐 onCreate()、暂停音乐 onPause() 并重新启动音乐 onResume()。我正在使用媒体播放器。问题是当我在主活动上旋转屏幕时，我不希望音乐重新启动 onResume()。当我从另一个活动回到我的主要活动时，我只希望音乐重新开始。有什么建议么？

> 私人媒体播放器mp；
> 
> mp = MediaPlayer.create(MainActivity.this, R.raw.always_sunny); mp.setLooping(true); mp.start();
> 
> ```
> @Override
> protected void onPause() {
>   super.onPause();
>   mp.getCurrentPosition();
>   mp.pause();
> }
> 
> @Override
> protected void onResume() {
>   super.onResume();
>   mp.seekTo(0);
>   mp.start();
> } 
> ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T20:50:02.273

将以下属性添加到清单中的活动：

```
android:configChanges="keyboardHidden|orientation|screenSize" 
```

这将避免活动在方向更改或键盘出现时重新启动。

如果您需要在旋转发生变化时做一些事情（例如，在您的情况下更改图像），请将以下方法添加到您的活动中：

```
@Override
public void onConfigurationChanged (Configuration newConfig) {
  // Change here your image
} 
```

# unit-testing - 使用junit 4.10进行单元测试

> ID：10964427
> 
> 赞同：0
> 
> 时间：2012-06-09T20:37:23.230
> 
> 标签：unit-testing, junit4

在这里使用 JUnit 4.10 是我的测试。

```
package geometry;

import org.junit.Assert.*;
import org.junit.Test;

public class SegmentTest extends junit.framework.TestCase {

    @Test
    public void SegmentParallelTest() {
        Segment a = new Segment(10, 5, 20, 11);
        Segment b = new Segment(20, 6, 30, 11);
        assertFalse(a.isParallel(b));
    }

    public static junit.framework.Test suite() {
        return new junit.framework.JUnit4TestAdapter(SegmentTest.class);
    }

    public static void main(String args[]) {
        org.junit.runner.JUnitCore.main("geometry.SegmentTest");
    }
} 
```

这会产生以下错误消息...

```
junit.framework.AssertionFailedError: No tests found in geometry.SegmentTest
    at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:83)
    at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
    at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:83)
    at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:71)
    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:202)
    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:63)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

这种方法有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T20:55:52.917

您正在扩展`TestCase`which 期望测试方法以其名称开头`test`。删除`extends junit.framework.TestCase`它，它会正常工作。

```
package geometry;

import org.junit.Test;
import static org.junit.Assert.assertFalse;

public class SegmentTest {

    @Test
    public void segmentParallelTest() {
        Segment a = new Segment(10, 5, 20, 11);
        Segment b = new Segment(20, 6, 30, 11);
        assertFalse(a.isParallel(b));
    }

} 
```

# mysql - 根据 2 个输入的日期范围选择行

> ID：10964431
> 
> 赞同：0
> 
> 时间：2012-06-09T20:37:57.077
> 
> 标签：mysql

我想根据两个输入文本从数据库中选择一行，并命名为**date_start**和**date_end ，其中这两个输入位于名为****db_start**和**db_end**的行的两个字段的范围内。

2 输入必须恰好在 db_start 和 db_date 的范围内。

有人可以告诉我怎么做吗？

**输入 ：**

日期开始：2012-12-02

日期结束：2012-12-19

**数据库（1 行）**

db_start : 2012-01-01

db_end : 2012-12-12

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:47:12.620

```
SELECT * FROM table WHERE 
('2012-12-02' BETWEEN db_start AND db_end) AND
('2012-12-19' BETWEEN db_start AND db_end) 
```

这是你想要的吗？

# c# - StructureMap LifeCycle是新的ThreadLocalStorageLifeCycle不是线程本地的吗？

> ID：10964433
> 
> 赞同：0
> 
> 时间：2012-06-09T20:38:04.833
> 
> 标签：c#, multithreading, structuremap, thread-local-storage

我正在尝试使用 StructureMap 将两个相同类型的实例存储在两个不同的线程中。每个线程都应该有自己的实例：

```
 [TestMethod]
    public void ThatObjectFactoryReturnsDifferentTypesFromTwoThreadsWhenConfiguredThreadLocalStorage()
    {
        var t = new Thread(ConfigureThreadLocalStorageTest1);
        ITestObjectFactory test2 = new Test2();
        ObjectFactory.Configure(x => x.For<ITestObjectFactory>().LifecycleIs(new ThreadLocalStorageLifecycle()).Use(test2));

        t.Start();
        t.Join();
        test2 = ObjectFactory.GetInstance<ITestObjectFactory>();

        Assert.IsInstanceOfType(test2, typeof(Test2));
        Assert.IsInstanceOfType(_staticTest, typeof(Test1));
    }

    static void ConfigureThreadLocalStorageTest1()
    {
        System.Diagnostics.Debug.WriteLine(ObjectFactory.TryGetInstance<ITestObjectFactory>());
        ITestObjectFactory test1 = new Test1();
        ObjectFactory.Configure(x => x.For<ITestObjectFactory>().LifecycleIs(new ThreadLocalStorageLifecycle()).Use(test1));

        _staticTest = ObjectFactory.GetInstance<ITestObjectFactory>();
    }
}

public class Test2 : ITestObjectFactory
{
}

public class Test1 : ITestObjectFactory
{
}

public interface ITestObjectFactory
{
} 
```

但是，上述测试失败。另外，使用 LifecycleIs(new ThreadLocalStorage()) 配置，我希望 ConfigureThreadLocalStorageTest1 中的 ObjectFactory.GetInstance() 方法返回 null？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T14:37:09.377

我猜你看到这个是因为你正在重新配置你的`ITestObjectFactory`映射。您调用`ObjectFactory.Configure`了`ITestObjectFactory`两次，第二次调用时，StructureMap 不再考虑您第一次配置此映射的方式。

因此，当您`test2 = ObjectFactory.GetInstance<ITestObjectFactory>();`在`t.Join();`StructureMap 给您`test1`(of class `Test1`) 之后执行此操作时，因为这是最后配置的方式。

编写一个只配置一次映射并使用基于类的配置而不是将映射配置到特定实例的测试可能更有意义。IE`ObjectFactory.Configure(x => x.For<ITestObjectFactory>().LifecycleIs(new ThreadLocalStorageLifecycle()).Use<YourConcreteClass>();`

**编辑**

我已经按照上面的方法修改了你的代码，确实，它通过了！

```
 [TestMethod]
    public void ThatObjectFactoryReturnsDifferentTypesFromTwoThreadsWhenConfiguredThreadLocalStorage()
    {
        ObjectFactory.Configure(x => x.For<ITestObjectFactory>().LifecycleIs(new ThreadLocalStorageLifecycle()).Use<Test>());
        var test1 = ObjectFactory.GetInstance<ITestObjectFactory>();

        var t = new Thread(ConfigureThreadLocalStorageTest1);
        t.Start();
        t.Join();

        var test2 = ObjectFactory.GetInstance<ITestObjectFactory>();

        Assert.AreSame(test1, test2);
        Assert.AreNotSame(test1, _staticTest);
    }

    static void ConfigureThreadLocalStorageTest1()
    {
        System.Diagnostics.Debug.WriteLine(ObjectFactory.TryGetInstance<ITestObjectFactory>());
        _staticTest = ObjectFactory.GetInstance<ITestObjectFactory>();
    }

    private static ITestObjectFactory _staticTest;

    public class Test : ITestObjectFactory
    {
    }

    public interface ITestObjectFactory
    {
    } 
```

# java - 在 Java 中实现 ws-security UsernameToken 的密码摘要

> ID：10964434
> 
> 赞同：1
> 
> 时间：2012-06-09T20:38:12.293
> 
> 标签：java, soap, ws-security, usernametoken

我正在尝试从服务器调用 ws-security 安全 Web 服务，但不幸的是，该服务器本身不支持此功能。我采用的方法是实现一个 .jsp，它充当实际端点 URL 的反向代理，在此过程中添加带有 ws-security 元素的元素。

这似乎工作得很好，我相信我已经使用正确的名称空间等正确地构建了 XML。我通过将 XML 与 SOAP-UI 生成的 XML 进行比较来验证这一点。

问题在于实现密码摘要生成器。我没有得到与 SOAP-UI 使用相同的 NOnce、xsd:dateTime 和密码输入以及以下代码相同的结果。

```
StringBuffer passwordDigestStr_ = new StringBuffer();

// First append the NOnce from the SOAP header
passwordDigestStr_.append(Base64.decode("PzlbwtWRpmFWjG0JRIRn7A=="));

// Then append the xsd:dateTime in UTC timezone
passwordDigestStr_.append("2012-06-09T18:41:03.640Z");

// Finally append the password/secret
passwordDigestStr_.append("password");

System.out.println("Generated password digest: " + new String(com.bea.xbean.util.Base64.encode(org.apache.commons.codec.digest.DigestUtils.sha(passwordDigestStr_.toString())), "UTF-8")); 
```

我认为问题在于实现前两个元素的散列，如[http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0.pdf所解释](http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0.pdf)

> 请注意，nonce 使用其解码值的八位字节序列进行散列，而时间戳使用其在元素内容中指定的 UTF8 编码的八位字节序列进行散列。

如果有人能帮我解决这个问题，那就太好了，因为它开始让我发疯了！如果您可以提供源代码，那将是理想的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-10T00:13:02.073

我会在没有 SOAP-UI 的情况下尝试一下。散列函数的输入应该是字节，而不是字符串。`DigestUtils.sha()`将允许您使用字符串，但该字符串必须正确编码。当您编写 nonce 时，您正在调用[`StringBuffer.append(Object)`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuffer.html#append%28java.lang.Object%29)最终调用`byte[].toString()`. 这给了你类似的东西`[B@3e25a5`，绝对不是你想要的。通过到处使用字节，你应该避免这个问题。请注意，下面的示例使用`org.apache.commons.codec.binary.Base64`，而不是您使用的 Base64 类。没关系，那只是我手边的那个。

```
ByteBuffer buf = ByteBuffer.allocate(1000);
buf.put(Base64.decodeBase64("PzlbwtWRpmFWjG0JRIRn7A=="));
buf.put("2012-06-09T18:41:03.640Z".getBytes("UTF-8"));
buf.put("password".getBytes("UTF-8"));
byte[] toHash = new byte[buf.position()];
buf.rewind();
buf.get(toHash);
byte[] hash = DigestUtils.sha(toHash);
System.out.println("Generated password digest: " + Base64.encodeBase64String(hash)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T10:00:25.337

对延迟回复表示歉意，特别是考虑到您最初的快速回复。我现在已经能够使用您的方法的精髓使其工作，以避免任何字符编码问题。但是，`java.nio.ByteBuffer`给我带来了问题，所以我修改了代码以使用`byte[]`我结合使用的 basic s `System.arrayCopy()`。我面临的问题是，尽管 'buf.position()' 返回了适当数量的字节，但通过`java.nio.ByteBuffer`注入的所有字节都是 0！`byte[] toHash``buf.get(toHash)`

非常感谢您的帮助。

# php - PHP 删除 最后一行

> ID：10964435
> 
> 赞同：1
> 
> 时间：2012-06-09T20:38:20.637
> 
> 标签：php, scripting

目前我有这个代码：

```
<?php
echo '<meta name="robots" content="noindex">';
$arr = json_decode(file_get_contents("http://media1.clubpenguin.com/play/en/web_service/game_configs/    paper_items.json"),true);
foreach($arr as $item) {

$label = $item['label'];
$cost = $item['cost'];
$id = $item['paper_item_id'];
$member = $item['is_member'];

if ($member == "1") {
$member = "Yes";
}else{
$member = "No";
}

echo  "$label = $id = $member = $cost";
echo ",<br>";
}  
?> 
```

这段代码的作用是
在每一行之后添加一个标签。这是它发生的片段：

```
echo  "$label = $id = $member = $cost";
echo ",<br>"; 
```

我想要的是在最后一行`echo ",<br>";`不运行该行。我该怎么做呢？请帮忙！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T20:41:18.407

试试这个：

```
$result = array();

foreach($arr as $item) {
  ...

  $result[] =  "$label = $id = $member = $cost";
}

echo implode('<br />', $result); 
```

想法是在循环完成工作后将所有行存储在数组中并使用 BR 标签连接项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:43:08.723

试试这个：

```
<?php
$str = '';
$str .= '<meta name="robots" content="noindex">';
$arr = json_decode(file_get_contents("http://media1.clubpenguin.com/play/en/web_service/game_configs/    paper_items.json"),true);
foreach($arr as $item) {

$label = $item['label'];
$cost = $item['cost'];
$id = $item['paper_item_id'];
$member = $item['is_member'];

if ($member == "1") {
$member = "Yes";
}else{
$member = "No";
}

$str .= "$label = $id = $member = $cost";
$str .= ",<br>";
}  

echo substr($str, 0, -5);
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T20:45:24.163

我喜欢[ioseb 的爆炸解决方案](https://stackoverflow.com/a/10964445/398242)，但这是[另一种简单的方法](http://codepad.org/isZDVfNc)：

```
foreach($arr as $item) {

    $first = isset($first) && print ",<br>";

    // ...

    echo  "$label = $id = $member = $cost";
} 
```

这会打印除第一次迭代之外的所有换行符 - 但*在*文本之前，只需确保`$first`在运行之前未设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T20:43:50.937

我建议将您的所有项目存储在一个字符串中，而不是随时回显。然后你可以在完成后删除任何你想要的尾随字符，然后在最后用一个简单的正则表达式回显一次，比如......

```
echo preg_replace('/\<br\/\>$/','', $myTotalOutputString); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T20:44:51.867

对您的代码进行小幅改写：

```
<?php
echo '<meta name="robots" content="noindex">';
$arr = json_decode(file_get_contents("http://media1.clubpenguin.com/play/en/web_service/game_configs/paper_items.json"), true);
$outArray = array();
foreach($arr as $item) {
    $label = $item['label'];
    $cost = $item['cost'];
    $id = $item['paper_item_id'];
    $member = ($item['is_member'] == '1') ? "Yes" : "No";
    $outArray[] = "{$label} = {$id} = {$member} = {$cost}";
}  

echo implode(',<br>', $outArray);
?> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-06-09T20:48:19.483

使用 rtrim 快速单行：

```
echo rtrim('test <br />', '<br />'); 
```

但我投票支持上面的内爆答案。

# java - 如何解决“存储过程 'MySP1' 只能在非链式事务模式下运行”错误？

> ID：10964440
> 
> 赞同：4
> 
> 时间：2012-06-09T20:40:26.350
> 
> 标签：java, jdbc, transactions, sybase, jtds

我正在编写一个 Java 应用程序，它需要执行一些复杂的 SQL 并在其中任何一个失败时回滚所有这些：

*   使用打开 Sybase 连接`net.sourceforge.jtds.jdbc.Driver`
*   调用 setAutoCommit(false)
*   做 SQL1
*   调用存储过程“MySP1”
    *   存储过程 MySP1' 不在我的控制之下
    *   它有`EXEC sp_procxmode 'dbo.MySP1','unchained'`
*   做 SQL2
*   如果 SQL2 失败，则回滚所有内容（包括 SQL1），否则提交。

完成后，我从 MySP1 收到以下错误：

> **存储过程“MySP1”只能在非链式事务模式下运行。' `SET CHAINED OFF`' 命令将导致当前会话使用非链式事务模式。**

* * *

我尝试了以下方法，但都没有帮助：

1.  将“chained=false”添加到传递给`getConnection()`方法（[advice source](http://www.inetsoftware.de/documentation/jdbc-driver/other-dbms/sybase/manual.html)）的 Properties 对象。

    这没有效果，很可能是因为在我看来`net.sourceforge.jtds.jdbc.Driver`它**不**支持`chained`属性。

2.  将“chained=false”添加到传递给`getConnection()`方法（[advice source](http://www.inetsoftware.de/documentation/jdbc-driver/other-dbms/sybase/manual.html)）的 URL 字符串。

    这也没有效果

3.  之后调用`SET CHAINED OFF`SQL `setAutoCommit()`：

    ```
     PreparedStatement st = conn.prepareStatement("SET CHAINED OFF");
      st.execute(); 
    ```

    这没有效果。

4.  研究如何`setAutoCommit()`运作

    这使我相信驱动程序中可能存在[错误](https://stackoverflow.com/questions/10964365/is-there-a-bug-with-set-chained-in-setautocommit-in-net-sourceforge-jtds-jdb)。但是，如果是这种情况，#1-#3 应该已经解决了这个错误

5.  调用`setAutoCommit(true)`而不是`setAutoCommit(false)`.

    这修复了关于非链接模式的错误，但据我了解，这意味着我不能在最后回滚 100% 的 SQL，因为到那时第一个 SQL 语句已经被自动提交。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-20T08:36:47.257

我的理解是jdbc的“Autocommit”和Sybase链式模式是一回事。

自动提交 true 意味着在每条语句之后提交 - 这是未链接的：事务并非都在一个可以提交和回滚的“链”中。

所以你可能会被卡住。如果您无法更改该 SP，那么它将始终关闭链接模式。你得到一个合理的信息。它实际上是一条错误消息，还是只是您的jdbc代码没有处理它（即显示它或不显示它，但至少将其视为不是错误？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-04T22:51:17.647

以防万一这么多年后有人来看这里。

我偶然发现了同样的情况。您与方式 3 非常接近。但在这种情况下，jTDS 不会启动 tran（但在 Unchained 模式下是强制性的）。您可以通过执行手动执行

```
begin transaction 
```

刚跑完

```
SET CHAINED OFF 
```

# iphone - iPhone 无法从 MySQL 下载图像 (BLOB)

> ID：10964443
> 
> 赞同：0
> 
> 时间：2012-06-09T20:40:37.447
> 
> 标签：iphone, mysql, image, parsing, blob

我有一个 MySQL 数据库，其中包含我想下载到我的 iPhone 应用程序中的图像。图像存储为 BLOB。我有一个 PHP 脚本，它可以从数据库中抓取任何这些图像并将它们显示在网页上。为此，我使用：

```
$query  = "SELECT * FROM images WHERE imageName = '$nameOfImage'";
$result = mysql_query($query);
$image = mysql_fetch_array($result);

header('Content-type: ' . $image['mime_type']);
header('Content-length: ' . $image['file_size']);

echo $image['file_data']; 
```

这工作得很好，到目前为止一切都很好。

但是如何将这些图像放入我的*应用程序*中？我以前在我的应用程序中成功解析过 XML - 但我正在解析文本数据。你如何用 BLOBS 做到这一点？我需要什么 PHP 代码来生成 XML，然后我可以解析以获取 BLOB 数据？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:21:28.787

如果您使用以下方式下载图像`NSURLConnection`：

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    receivedData = [[NSMutableData alloc] init];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [receivedData appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    UIImage *downloadedImage = [[UIImage alloc] initWithData:receivedData];
    // deal with it!
} 
```

如果没有，你必须找到一个保存响应数据的属性（它可能被称为`responseData`），所以用它来初始化你的图像。

# python - 如何在文件顶部添加新的文本行？

> ID：10964444
> 
> 赞同：3
> 
> 时间：2012-06-09T20:40:39.970
> 
> 标签：python, file-io, python-2.7

我正在开发一个使 Python 脚本可执行的简单程序，并且我正在添加解释器路径（*#! /usr/bin/python*）的部分。我尝试这样做，但不是添加新行，而是替换当前行*并*删除下一行的一部分。我做错了什么？

我将源代码上传到 Ubuntu Pastebin：[http](http://pastebin.ubuntu.com/1032683/) ://pastebin.ubuntu.com/1032683/错误代码在第 28 行和第 31 行之间：

```
wfile = open(file, 'r+')
if wfile.readline() != "#! /usr/bin/python\n":
    wfile.seek(0)
    wfile.write("#! /usr/bin/python\n") 
```

将 Python 2.7.2 与 iPad 2（[适用于 iOS 的 Python](http://pythonforios.com/)）一起使用，同时在同一 iPad（Cydia 端口）中使用 2.5.1 进行测试。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T20:43:58.907

你不能做你想做的事。寻找文件的开头并进行写入将从该位置覆盖，而不是追加。

在文件中间（或开头）添加一行的唯一方法是写出一个新文件，并将数据插入到您想要的位置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T20:59:23.780

Joe 是正确的，因为您不能只在文件开头“插入”行。但是，这里有一个解决方案：

```
with open(my_python_script, "r+") as f:
    first_line = f.readline()
    if first_line != "#! /usr/bin/python\n":
        lines = f.readlines()
        f.seek(0)
        f.write("#! /usr/bin/python\n")
        f.write(first_line)
        f.writelines(lines) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T21:11:13.703

要添加/替换命令行给出的每个文件的第一行：

```
#!/usr/bin/env python
import fileinput

shebang = "#! /usr/bin/python\n"
for line in fileinput.input(inplace=1):
    if fileinput.isfirstline() and line != shebang:
       print shebang,
       if not line.startswith("#!"): 
          print line,
    else:
       print line, 
```

# c++ - 即使声明为全局，全局友元函数也无法访问私有范围

> ID：10964448
> 
> 赞同：2
> 
> 时间：2012-06-09T20:42:10.823
> 
> 标签：c++, class, function

我确信这是我忽略的非常容易的事情，但我正在为这个错误消息撕裂我的头发。我很少使用朋友功能。

```
error: 'LRESULT Window_Proc(HWND, UINT, WPARAM, LPARAM)' should have been declared inside '::' 
```

这是我的定义：

```
namespace rayc 
{
    class win32_window: public window {
    public:
        win32_window();
        ~win32_window();

        void show();
        void hide();
        void pump_message();

    private:
        friend LRESULT CALLBACK ::Window_Proc(HWND, UINT, WPARAM, LPARAM);

        void set_closed(bool);

        HWND hWin;
    };
} 
```

这个错误信息我不是很明白，它被定义为属于全局范围，不是吗？！

使用 MinGW-64 TDM 编译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T20:47:23.387

> 这个错误信息我不是很明白，它被定义为属于全局范围，不是吗？！

不是，除非您在该声明之前在全局命名空间中包含了前向*声明*`friend`。如果`friend`声明引入了新符号，则该符号位于包含它的*类的封闭**命名空间中。*

 *尝试添加

```
LRESULT CALLBACK Window_Proc(HWND, UINT, WPARAM, LPARAM); 
```

在全局命名空间中，在声明你的*class*之前。*

# php - 如何插入带有品牌名称的元数据和网址

> ID：10964449
> 
> 赞同：-3
> 
> 时间：2012-06-09T20:42:40.083
> 
> 标签：php, opencart

实际上我想在 opencart 中为我的站点地图页面添加元数据，那么我如何在站点地图页面中添加标题描述和关键字，请问在该页面中添加任何代码吗？

当我看到我的站点地图页面并在视图源中看到时，我的站点标题标签看起来像这样`<title></title>`，然后我看到这个标签没有任何单词，所以我想在那个标签之间添加一些标题

**第二个问题关于**

我需要更改网址

> Mysite.com/productname

至

> Mysite.com/category/brand/productname

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T10:14:29.123

确切地。您需要重新提出问题并费心搜索此站点。

```
OpenCart Admin -> Catalog -> Categories -> Name -> Data Tab -> SEO Keyword: 
```

品牌/类别（示例）绿洲/鞋子

```
OpenCart Admin -> Catalog -> Products -> Name -> Data Tab -> SEO Keyword: 
```

??-产品名称（产品 ID）

56-red-trainers

Nginx：（.htaccess 与 Apache 类似，也与 Apache .htaccess 在启用 Opencart SEO Urls 后这已经是标准配置，nginx 需要手动工作）

```
server {
    listen  80;
    server_name site.com www.site.com;
    root /var/www/www.site.com/web;
    index index.php index.html index.htm;
    location /admin {
        index index.php;
    }
    location / {
        try_files $uri @opencart;
        # cat
        rewrite ^/oasis/shoes?$ /index.php?route=product/category&path=1 last;

        # product
        rewrite ^/oasis/shoes/(.*)$ /index.php?route=product/product&path=2&product_id=$1 last;
    }
    location @opencart {
        rewrite ^/(.+)$ /index.php?route=$1 last;
    }
    location = /favicon.ico {
        log_not_found off;
        access_log off;
    }
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }         
    location ~* \.(engine|inc|info|ini|install|make|module|profile|test|po|sh|.*sql|theme|tpl(\.php)?|xtmpl)$|^(\..*|Entries.*|Repository|Root|Tag|Template)$|\.php_ {
        deny all;
    }
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    location ~*  \.(jpg|jpeg|png|gif|css|js|ico)$ {
        expires max;
        log_not_found off;
    }
    location ~ \.php$ {
        include /etc/nginx/fastcgi_params;
        fastcgi_pass    127.0.0.1:9000;
        fastcgi_param   SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }
} 
```

制作网址

```
site.com/oasis/shoes
site.com/oasis/shoes/56-red-trainers 
```

# regex - sed 正则表达式在第一场比赛中停止

> ID：10964455
> 
> 赞同：4
> 
> 时间：2012-06-09T20:43:56.910
> 
> 标签：regex, perl, sed, phpbb

我想替换以下 html 文本的一部分（一个大文件的摘录），将旧的论坛格式（由于 2 年前完成的一个非常糟糕的论坛移植工作）更新为常规的 phpBB 格式：

```
 &lt;blockquote id="quote"&gt;&lt;font size="1" face="Verdana, Arial, Helvetica" id="quote"&gt;quote:&lt;hr height="1" noshade id="quote"&gt;&lt;i&gt;written by User&lt;/i&gt; 
```

这应该被过滤成：

```
 [quote=User] 
```

我在 sed 中使用了以下正则表达式

```
 s/&lt;blockquote.*written by \(.*\)&lt;\/i&gt;/[quote=\1]/g 
```

这适用于给定的示例，但在实际文件中，这样的几个引号可以在一行中。在那种情况下，sed 太贪心了，将第一个和最后一个匹配项之间的所有内容都放在 [quote=...] 标记中。我似乎无法让它替换行中这种模式的每一次出现......（我认为没有任何嵌套引号，但这会使它变得更加困难）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:03:19.250

您需要一个使用 Perl 兼容的正则表达式的*sed* (1) 版本，以便您可以做一些事情，比如进行最小匹配，或者一个带有负前瞻的匹配。

最简单的方法就是首先使用 Perl。

如果您有一个现有的*sed脚本，您可以使用**s2p* (1) 实用程序将其转换为 Perl 。请注意，在 Perl 中，您确实希望`$1`在运算符的右侧使用`s///`。在大多数情况下，它`\1`是祖父的，但通常你想要`$1`那里：

```
s/&lt;blockquote.*?written by (.*?)&lt;\/i&gt;/[quote=$1]/g; 
```

请注意，我已经删除了括号前面的反斜杠。使用 Perl 的另一个优点是它使用健全的*egrep*风格的正则表达式（如*awk*），而不是丑陋的*grep*风格的正则表达式（如*sed*），它需要所有那些令人困惑（和不一致）的反斜杠。

使用 Perl 的另一个优点是您可以使用成对的、可嵌套的分隔符来避免难看的反斜杠。例如：

```
s{&lt;blockquote.*?written by (.*?)&lt;/i&gt;}
 {[quote=$1]}g; 
```

其他优点包括 Perl 与 UTF-8（现在是 Web 的多数编码形式）很好地相处，并且您可以进行多行匹配，而无需*sed*所需的极度痛苦。例如：

```
$ perl -CSD -00 -pe 's{&lt;blockquote.*?written by (.*?)&lt;/i&gt;}{[quote=$1]}gs' file1.utf8 file2.utf8 ... 
```

这`-CSD`使它将标准输入、标准输出和文件视为 UTF-8。`-00`使其一口气读取整个文件，并根据需要`/s`使点越过换行符边界。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:50:46.007

我认为不`sed`支持非贪婪匹配。您可以尝试 perl：

```
perl -pe 's/&lt;blockquote.*?written by \(.*\)&lt;\/i&gt;/[quote=\1]/g' filename 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T21:41:11.357

这可能对您有用：

```
sed '/&lt;blockquote.*written by .*&lt;\/i&gt;/!b;s/&lt;blockquote/\n/g;s/\n[^\n]*written by \([^\n]*\)&lt;\/i&gt;/[quote=\1]/g;s/\n/\&lt;blockquote/g' file 
```

解释：

*   如果一行不包含该模式，则跳过它。`/&lt;blockquote.*written by .*&lt;\/i&gt;/!b`
*   在整个行中将模式的前面全局更改为换行符。`s/&lt;blockquote/\n/g`
*   `[^\n]*`使用 a而不是全局替换换行符，然后是剩余的模式`.*`。`s/\n[^\n]*written by \([^\n]*\)&lt;\/i&gt;/[quote=\1]/g`
*   将那些未更改的换行符恢复为原始的前面模式。`s/\n/\&lt;blockquote/g`

# ruby-on-rails - RSpec 存根不适用于集成测试

> ID：10964460
> 
> 赞同：1
> 
> 时间：2012-06-09T20:45:07.000
> 
> 标签：ruby-on-rails, ruby, testing, rspec, factory-bot

在控制器测试中，我想测试登录时，控制器会呈现请求，否则如果未登录，它会重定向到 login_path。

第一个测试按预期顺利通过，没有用户登录，因此请求被重定向到 login_path。但是，我尝试了无数的 stub/stub_chain，但仍然无法通过测试来伪造正在登录的用户并呈现页面正常。

我会很感激一些让这个按预期工作的方向。

以下类和测试是保持问题简洁的基本要素。

## 应用控制器

```
class ApplicationController < ActionController::Base
include SessionsHelper

  private
  def current_user
    @current_user ||= User.find(session[:user_id]) if session[:user_id]
  end
  helper_method :current_user
end 
```

## 会话助手

```
 module SessionsHelper

  def logged_in?
    redirect_to login_path, :notice => "Please log in before continuing..." unless current_user
   end
end 
```

## 应用控制器

```
class AppsController < ApplicationController

  before_filter :logged_in?

  def index
    @title = "apps"
  end
end 
```

## apps_controller_spec.rb

```
require 'spec_helper'
describe AppsController do

  before do
    @user = FactoryGirl.create(:user)
  end

  describe "Visit apps_path" do
    it "should redirect to login path if not logged in" do
      visit apps_path
      current_path.should eq(login_path)
    end

    it "should get okay if logged in" do
      #stubs here, I've tried many variations but can't get any to work
      #stubbing the controller/ApplicationController/helper
      ApplicationController.stub(:current_user).and_return(@user)
      visit apps_path
      current_path.should eq(apps_path)
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T10:04:54.387

这不起作用，因为您`current_user`在`ApplicationController`类上存根方法，而不是该类的实例。

我建议在该类的实例上（正确地）*将*其存根，但您的测试似乎是集成测试而不是控制器测试。

然后我会做的是正如[Art Shayderov](https://stackoverflow.com/a/10964988/15245)提到的那样，在尝试访问需要经过身份验证的用户的地方之前模拟用户的登录操作。

```
visit sign_in_path
fill_in "Username", :with => "some_guy"
fill_in "Password", :with => "password"
click_button "Sign in"
page.should have_content("You have signed in successfully.") 
```

在我的应用程序中，我已将其移至测试的辅助方法中。这被放入一个文件中`spec/support/authentication_helpers.rb`，如下所示：

```
module AuthenticationHelpers
  def sign_in_as!(user)
    visit sign_in_path
    fill_in "Username", :with => user.username
    fill_in "Password", :with => "password"
    click_button "Sign in"
    page.should have_content("You have signed in successfully.")
  end
end

RSpec.configure do |c|
  c.include AuthenticationHelpers, :type => :request
end 
```

然后在我的请求规范中，我只需调用该方法以该特定用户身份登录：

```
sign_in_as(user) 
```

* * *

现在，如果您想使用标准控制器测试登录，Devise 已经为此提供了帮助。我通常将这些包含在同一个文件中 ( `spec/support/authentication_helpers.rb`)：

```
 RSpec.configure do |c|
   c.include Devise::TestHelpers, :type => :controller
 end 
```

然后您可以使用这样的助手登录：

```
 before do
   sign_in(:user, user)
 end

 it "performs an action" do
   get :index
 end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:18:52.997

它看起来不像控制器测试。它看起来更像是模拟浏览器的 rspec-rails 请求规范。所以刺伤控制器不起作用，你必须模拟登录（像这样）

```
visit sign_in
fill_in 'username', :with => 'username'
... 
```

或手动将 user_id 添加到会话中。

另一方面，如果您想单独测试控制器，您的测试应该如下所示：

```
get 'index'
response.should be_success 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T20:50:28.547

我会看看[http://ruby.railstutorial.org/chapters/sign-in-sign-out#sec:a_working_sign_in_method](http://ruby.railstutorial.org/chapters/sign-in-sign-out#sec:a_working_sign_in_method)。

作者描述了如何编写一个 sign_in 方法并在你的 rspec 测试中使用它。

# ios - iOS应用程序是否必须与所有日历一起使用

> ID：10964475
> 
> 赞同：1
> 
> 时间：2012-06-09T20:48:38.657
> 
> 标签：ios, nscalendar

我正在开发的一个 iOS 应用程序具有一些基于日期的功能。当日历设置为公历时它正在工作。但在设备中，如果我将日历更改为其他任何内容（即日语或佛教），它就不起作用。可能是因为我没有编码来解释它。

但是一般标准是什么。是否期望任何基于日期和时间的应用程序支持所有日历格式，做一个很大的不。的此类应用程序支持所有日历，或者如果某个应用程序不能与其他日历类型一起使用，它是否会被批准。如果它被批准，应该在哪里指定该应用程序仅适用于某种日历类型，以便用户知道它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T21:59:11.493

Apple 没有官方要求支持所有日历。使用常识并做对目标受众有意义的事情。如果您的目标受众是西方国家（或除少数日本人/佛教徒外的整个世界），那么只需支持公历。如果您的应用专为日本或远东地区设计，请支持这些日历。做适用于 90% 案例的事情，不要浪费时间优化边缘用例。我已经发布了许多利用日历和 NSDate 功能的应用程序，而且我从不支持任何东西，只支持公历。我从来没有听到过抱怨。

# asp.net - 如何修改 web.config 中的 maxJsonLength 属性？

> ID：10964476
> 
> 赞同：0
> 
> 时间：2012-06-09T20:48:41.837
> 
> 标签：asp.net, json, serialization, web-config

[尝试在此处](http://msdn.microsoft.com/en-us/library/bb763183.aspx)复制 msdn 引用不起作用并给出错误我想增加 json 序列化的允许长度

```
<configuration>

    <configSections>
      <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
        <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
          <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
          <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
            <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"  />
                  <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
            <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication" />
            <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication" />
          </sectionGroup>
        </sectionGroup>
      </sectionGroup>
    </configSections>  
... 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T20:52:18.237

```
<configuration>
  <system.web.extensions>
    <scripting>
      <webServices>
        <jsonSerialization maxJsonLength="204800"/>
      </webServices>
    </scripting>   
  </system.web.extensions>
</configuration> 
```

您需要在 Web 配置中设置 jsonSerialization 元素的[maxJsonLength](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.maxjsonlength.aspx)属性。

# c++ - 如何在 Windows 64 位上安装 cmake

> ID：10964477
> 
> 赞同：16
> 
> 时间：2012-06-09T20:48:44.197
> 
> 标签：c++, c, windows, visual-c++, cmake

cmake 的下载页面仅显示 Windows 的 32 位安装程序。知道如何在 64 个 Windows 系统上安装它。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-09T20:51:52.833

确实没有理由使用 64 位原生 CMake。CMake 只是构建*配置*，因此您可以使用它来构建 64 位软件的配置，即使是 32 位版本。

话虽如此，如果你真的想要一个 64 位的原生版本，你总是可以下载源代码并编译它。但是，没有 64 位安装程序。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-09T20:50:06.377

32 位版本即使在 64 位 Windows 上也能完美运行。我用过，效果很好。

编辑：看起来 CMake 现在有 32 位和 64 位两种版本。只需访问他们的网站，您就可以获得 64 位版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-10T15:05:56.980

现在可以从下载页面获得 64 位 Windows 安装程序：[https ://cmake.org/download](https://cmake.org/download)

# multithreading - 我应该在主管-工作者模型中使用内存栅栏吗？

> ID：10964484
> 
> 赞同：0
> 
> 时间：2012-06-09T20:49:45.800
> 
> 标签：multithreading, mutex, memory-fences

我正在为我的应用程序构建多线程支持。

在我的应用程序中，一个工作人员可能会访问另一个工作人员的“工作区”来完成自己的工作。我曾尝试使用 pthread 互斥锁来确保这一点安全，但结果证明它们非常慢，即使只有一个工作人员并且没有争用。

所以，我想出了另一个主意。让一个worker在可能的地方完成它的工作，然后将存在上述问题的工作添加到（per-worker，own）队列中：当所有工作人员都完成后，主监督线程将完成未完成的工作，在希望它们将比工人完成的工作数量少几个数量级。

我的问题是：在我将执行从主管转移到工人的那一刻，我是否应该设置记忆栅栏，反之亦然？

编辑：更多细节（代码在[github 上](https://github.com/pisto/laurea/blob/master/pool.cpp)，参见 pool::collision_wsc()）。每个线程从各种“单元”（基本上是 std::vector）读取指针，并对指向的对象应用一些操作（硬球体之间的碰撞）。

关键是一个细胞与它的（一些）邻居交互，但其中一些细胞可能是另一个工人的所有权（一个球体可能靠近一个细胞的边界，并与另一个细胞中的一个发生碰撞）。

# android - 如何使文本方向从右到左

> ID：10964488
> 
> 赞同：63
> 
> 时间：2012-06-09T20:50:23.760
> 
> 标签：android, textview, right-to-left

我想在 TextView 中用（从右到左的语言，即阿拉伯语）编写文本。但我想让文字书写方向从右到左。`gravity:right`只会将文本右对齐。我想从右到左对齐文本（使单词和数字出现在他输入的行中）。如何 ？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2015-05-23T17:54:52.547

另一种可以在旧版本的android中使用并且可以在字符串中的任何位置使用的聪明方法，即使在最新版本的android中也更方便，是在字符串中包含从右**到左的标记**甚至**从左到右的标记**需要时：

```
left-to-right mark: &lrm; or &#x200e; (U+200E)
right-to-left mark: &rlm; or &#x200f; (U+200F) 
```

它是这样下来的：

```
String rtl = "Hello \u200F(سلام)"; 
```

这种方法的好处是，您甚至可以在**(,{,[,! 等标点符号**后使用它，它们的位置不正确！示例：

```
سلام! // wrong position
سلام!‏ // right position by adding RLM after ! 
```

看看怎么样**！**正确定位在第二行，实际上后面有一个RLM，即使它不可见，您也可以复制粘贴它。

您看到的第二个好处是您可以在任何支持 RTL 的系统（如浏览器、word 等）中使用此方法（这些字符代码）。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-06-20T18:51:24.830

只需将此属性放在您的 TextView 中，一切都会正常运行，它会自动检测您的文本并相应更改

```
android:textDirection="anyRtl" 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-09-18T10:07:23.543

为时已晚，但`android:gravity="right"`奏效了。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-03-01T05:32:18.933

*在xml*中为 textview设置这一行：

```
 android:textDirection="locale" 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2015-03-30T00:31:16.747

尝试使用

```
 textview.setTextDirection(View.TEXT_DIRECTION_RTL); 
```

或者

```
 textview.setTextDirection(View.TEXT_DIRECTION_ANY_RTL); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-07-04T17:23:44.633

在正常编辑文本的情况下，这将起作用

```
 android:textDirection="rtl" 
```

但是在密码字段的情况下，这还不够，请遵循此；

```
 android:textDirection="rtl"
     android:gravity="right" 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2018-10-25T06:57:42.453

使用`android:layoutDirection="rtl"`and`android:textAlignment="viewStart"`使文本视图从右到左。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-09-13T03:51:29.743

试试这个，因为它对我有用`android:textDirection="rtl"`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-07-29T13:48:24.633

将这些添加到您的editText：

```
android:gravity="right"
android:textDirection="rtl" 
```

PS：`android:textDirection`需要 API 级别 17

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-05-31T07:55:50.513

只是添加我自己对此类问题的经验。在我的情况下，除了建议的解决方案之外，我还必须用这种字符 ״ 的 RTL（在我的情况下为希伯来语）表示替换英文 " 字符

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-08-10T17:20:47.253

通过在我的 xml 代码中奇怪地使用如下属性，我得到了一个从右到左的带有正确标点符号的文本。但这不是多语言文本的完美解决方案：

```
android:textDirection="ltr"
android:gravity="right" 
```

设置 ltr 可以纠正标点符号问题，例如右侧有点而不是左侧。

重力属性使文本从右向左流动。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-05-17T15:14:22.270

TextView 的最佳方式 textDirection，**不要使用 layoutDirection**

```
 <TextView
     android:id="@+id/viewCountTv"
     android:layout_width="wrap_content"
     android:layout_height="wrap_content"
     android:textDirection="anyRtl"
     android:gravity="center"/> 
```

# python - 在谷歌应用引擎中的“请求范围”存储对象

> ID：10964507
> 
> 赞同：0
> 
> 时间：2012-06-09T20:52:26.267
> 
> 标签：python, google-app-engine, scope, httprequest

使用谷歌应用引擎（python）时，我想在“请求范围”存储一些信息。我的意思是我想在第一次收到请求时初始化一些信息，然后能够在请求的整个生命周期内从任何地方访问它（并且只能从那个请求）。

例如，如果我在当前用户通过身份验证后将其保存在请求范围内。

我将如何去做这种事情？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T21:09:03.497

应用引擎本身使用的模式似乎是`threading.local`您可以在 SDK 代码中使用 grep 查找的模式。例如，使 os.environ 请求本地化是这样完成`runtime/request_environment.py`的。

一个粗略的例子：

```
import threading

class _State(threading.local):
    """State keeps track of request info"""
    user = None

_state = _State() 
```

在其他地方，您可以在处理程序代码中尽早进行身份验证。

```
from state import _state
if authentication_passed:
    _state.user = user 
```

并提供可用于代码其他部分的便利

```
from state import _state
def get_authenticated_user():
    user = _state.user
    if not user:
        raise AuthenticationError()
    return user 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:19:15.317

你需要这样的东西： -

```
class BaseHandler(webapp2.RequestHandler):
  #A function which is useful in order to determine whether user is logged in
  def initialize(self, *a, **kw):
    #Do the authentication
    self.username = username

class MainHandler(BaseHandler):
 def get(self):
   print self.username 
```

现在，如果您继承 BaseHandler 类，所有请求将首先通过 BaseHandler 类的初始化方法，并且由于在 BaseHandler 类中您正在设置用户名，而 MainHandler 从 BaseHandler 继承，您将定义 self.username 并且所有请求都将通过初始化方法。

# android - 打开图片 - Android

> ID：10964508
> 
> 赞同：0
> 
> 时间：2012-06-09T20:52:44.913
> 
> 标签：android, image, thumbnails, viewer

有谁知道任何教程或指出如何在 android 的新活动中打开缩略图的正确方向。我不希望它在画廊或任何东西中打开，只是一个新的活动，它将显示更大的图像。

因此，如果我在一项活动中将 20 张图像显示为缩略图，我们就说“缩略图”。当其中任何一个被点击时，它会在另一个活动中打开，比如说“查看器”。

我猜想我需要将数据从一个传递到另一个

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:58:51.733

阅读 Intent 文档并熟悉 ACTION_VIEW 及其工作原理。这将帮助您解决问题。

# html - chrome中的EaselJs错误

> ID：10964510
> 
> 赞同：6
> 
> 时间：2012-06-09T20:52:58.207
> 
> 标签：html, html5-canvas, easeljs

我正在使用 Easeljs 库。Everthing 在 Firefox 和 ie9 中运行良好，但在 google chrome 中鼠标事件不起作用，我收到此错误“未捕获的错误已发生。这很可能是由于使用本地或跨域图像读取画布像素数据的安全限制。”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T11:35:27.617

从 Web 服务器提供您的页面。不要在 chrome 中从磁盘打开文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-31T08:27:53.570

另一个可能有效的答案是：

```
var queue = new createjs.LoadQueue(true, null, true); 
```

从 v.0.4.1 开始，他们是这样说的：

> crossOrigin 标志已经包含在 v.0.4.1 的 LoadQueue() 构造函数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-25T01:10:23.597

只需使用 --reduce-security-for-testing 命令行参数运行 Chrome。因此，您可以在本地开发您的项目，而无需使用 Web 服务器。

# maven - 使用 maven 将独立 Spring 应用程序中的 cxf webservice 打包为 jar-with-dependencies

> ID：10964513
> 
> 赞同：1
> 
> 时间：2012-06-09T20:53:32.147
> 
> 标签：maven, xsd, cxf

运行“java -jar my-app-0.0.1-SNAPSHOT-jar-with-dependencies.jar”之类的打包应用程序时，出现以下错误：

```
org.springframework.beans.factory.xml.XmlBeanDefinitionStoreException: Line 47 in
XML document from URL [jar:file:/.../cxf/javafirst/target/my-app-0.0.1-SNAPSHOT-jar-with-dependencies.jar!/application-context.xml]
is invalid; nested exception is org.xml.sax.SAXParseException; lineNumber: 47; 
columnNumber: 61; cvc-complex-type.3.2.2: Attribute 'sendServerVersion'
is not allowed to appear in element 'httpj:engine'. 
```

这是由于 apache.org 上发布的过时的 http-jetty.xsd 架构造成的。那不是我的问题。我的问题是，在以下情况下不会发生这种情况：

```
maven jetty:run 
```

或者

```
maven exec:java 
```

该服务直接针对解压缩的二进制目录运行，并且显然找到了更新且正确的 http-jetty.xsd 模式文件。

我基本上想做一件事：

将 web 服务放入一个包含依赖项的 jar 中。这还应该包括所有 XML 模式文件，因为显然，使 Web 服务依赖于外部资源并不是一个好主意。

使用 maven 的最佳方法是什么？

我可能幼稚的解决方案是将 XML 模式文件手动复制到资源目录中，并告诉 CXF 在 jar 文件中解析它们。因此，我有两个更具体的问题：

1.) 是否可以让 maven 找到 XML 模式文件并将它们复制到适当的位置？2.) 让 CXF 在 jar 文件中查找模式文件的推荐方法是什么？

3.) 有没有更好的、最佳实践的解决方案来解决这个问题？

[我关于 maven 程序集插件的 maven 配置是http://maven.apache.org/plugins/maven-assembly-plugin/usage.html](http://maven.apache.org/plugins/maven-assembly-plugin/usage.html)最后两个部分的直接组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:05:41.453

Spring 有一个非常好的机制来解析它需要的模式文件——它通常根本不会从 Web 下载它，而是使用 jar 文件中的本地可用文件来获取模式并验证 xml，例如。考虑 Spring 中的上下文自定义命名空间模式，如果您查看 spring-context.jar 文件中的 META-INF/spring.schemas 文件，您将看到以下条目：

`http\://www.springframework.org/schema/context/spring-context-3.1.xsd=org/springframework/context/config/spring-context-3.1.xsd`

基本上它的意思是从类路径文件中解析 spring-context-3.1.xsd`org.springframework.context.config.spring-context-3.1.xsd`文件

这也适用于任何第三方库，在您的情况下是 http-jetty.xsd。

我想我会推荐的是简单地在 META-INF/ 文件夹中的 jar 文件中创建一个 spring.schemas 文件，为模式的完整路径添加一个条目，并将其替换为 http-jetty.xsd 的类路径版本。

# mysql - 如何改进一个复杂而糟糕的 SQL 查询

> ID：10964516
> 
> 赞同：0
> 
> 时间：2012-06-09T20:54:36.440
> 
> 标签：mysql, sql

我有以下表格用于消息传递应用程序：

```
`messaging_message`
 - thread_id
 - content
 - timestamp
 - sender_id 

`messaging_messagestatus`
 - thread_id # though redundant here, makes messaging queries much easier
 - message
 - recipient_id
 - status 
```

几点注意事项：

*   每条消息将有两个引用它的消息状态条目，一个用于消息线程中的每个用户。
*   单个消息线程中可能有多条消息。
*   一个用户可以删除一条消息（status='deleted'），一个用户删除一条消息显然不会为线程中的另一个用户删除相同的消息。

尽我最大的努力掌握 SQL 的基本知识，我创建了一个查询来获取：

**给定一个用户，获取所有不同的未删除线程，显示 1) thread_id; 2) message_id // 3) timestamp // 4) 该线程中最新消息的内容；5) 消息线程中的其他人是谁；6) 用户是否发送了最新消息**。这是我到目前为止所拥有的：

```
SELECT thread_id, message_id, timestamp, content,
(SELECT DISTINCT recipient_id FROM messaging_messagestatus ms WHERE ms.thread_id=thread_id     
  AND recipient_id !=4) as other_recipient,
(CASE WHEN sender_id=4 THEN True ELSE False END) as sent_last_message

FROM
( SELECT m.thread_id, recipient_id, timestamp, m.id as message_id, content, sender_id
    FROM messaging_messagestatus ms
    INNER JOIN messaging_message m
    ON ms.message_id = m.id
WHERE recipient_id = 4 AND m.thread_id NOT in 
    ( SELECT thread_id FROM messaging_messagestatus WHERE status='deleted' 
      AND recipient_id = 4)

ORDER BY timestamp DESC) combined GROUP BY thread_id 
```

这个查询确实有效，会给我类似的东西：

```
thread_id   message_id  timestamp       content         other_recipient   sent_last_message
2           3       2012-06-09 13:02:08 newest message  80                 1 
```

大约 20k 消息行 / 35k 状态行，第一个查询大约需要 14 秒！后续关于3s的查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:59:46.133

您应该合并这些表。拥有两个具有此类直接相关数据的单独表并不是好的编程。这将消除这两个数据源之间的任何连接，并使查询数据更容易和更快。

# objective-c - Objective C 在 system() 中使用 char 字符串

> ID：10964517
> 
> 赞同：0
> 
> 时间：2012-06-09T20:54:40.983
> 
> 标签：objective-c

所以我有这个代码

```
char processName[50] = {0};                  // init all to 0
printf("Enter the process to kill: ");
scanf("%s", processName);                    // read and format into the str buffer
printf("Attempting to kill %s\n", processName);    // print buffer
system("killall %s", processName); 
```

放这会导致错误“函数'系统'的参数太多”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T20:56:54.053

该函数`system`接受一个参数，即要执行的命令。您必须创建一个临时字符串来构建这样的命令。

```
char command[1024] = {};
sprintf(command, "killall %s", processName);
system(command); 
```

# java - 使用变量名访问和设置静态变量

> ID：10964527
> 
> 赞同：3
> 
> 时间：2012-06-09T20:57:13.410
> 
> 标签：java

我想要做的是使用字符串访问存储在一个类中的变量。例如我有

```
public class Values {
    public static boolean enabled;
} 
```

然后在项目的不同部分，我有对象和带有字段名称的字符串。如何获取和设置字段的值？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-09T21:03:34.447

如果您将名称作为字符串，则应使用反射：

```
import java.lang.reflect.Field;

public class Values {

    public static boolean enabled = false;

    public static void main(String[] args) throws Exception {           
        Values v = new Values();

        Field field = v.getClass().getField("enabled");

        field.set( v, true );

        System.out.println( field.get(v) );         
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:00:18.550

```
Values.enabled = true; 
```

或者

```
Values.enabled = false; 
```

或者，您可以为该类创建一个静态 getter 和 setter，`Values`然后调用这些静态方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T22:04:38.450

@Maricio Linhares 的回答非常好；但是，请注意反射非常缓慢。如果您经常这样做，您可能会遇到性能问题。另一种方法可能是使用地图。代码如下

```
public class Values {
    public static Map<string,bool> variableMap;

    public static void main(String[] args) throws Exception {           
        // adding a 'variable'
        variableMap = new YourFavoriteMapImplementation();
        variableMap.put("enabled",true);

        // accessing the 'variables' value
        bool val = variableMap.get("enabled");
        System.out.println(val);         
    }
} 
```

# c - “警告：控制到达非 void 函数的末尾”但实际上该函数被声明为 int 并返回一个 int

> ID：10964528
> 
> 赞同：1
> 
> 时间：2012-06-09T20:57:17.333
> 
> 标签：c, gcc

我有这个功能：

```
int firstHeapArray (IntHeapArray h) {
    if(!emptyHeapArray(h))
        return h.array[0];
} 
```

它被声明为 int，这是 IntHeapArray 结构：

```
typedef struct intHeapArray {
    int *array;
    int size;
} IntHeapArray; 
```

你能说为什么我在编译时收到这个警告吗？

```
heap-test.c: In function ‘firstHeapArray’:
heap.h:31:1: warning: control reaches end of non-void function 
```

非常感谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T20:58:39.100

错误消息表明您有一个不是`void`返回的方法，但是您到达终点但没有返回值。您需要返回一个有效的 int 值。

问题在这里：

```
int firstHeapArray (IntHeapArray h) {
    if(!emptyHeapArray(h))
        return h.array[0];

    // If emptyHeapArray(h) is true, you reach here...

   // You need to return SOMETHING here to remove the warning
   return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T20:58:11.490

如果`emptyHeapArray(h)`返回 true，则不返回任何内容。然后控制到达非空函数的末尾`firstHeapArray`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T20:58:21.413

编译器推断，当`if`测试失败时，如果可以执行，则没有 return 语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-09T21:18:30.600

如果确实`firstHeapArray`不返回`emptyHeapArray(h) == true`。

这是未定义的行为，这意味着任何事情都可能发生，很可能在堆为空时使用此函数的任何人都可能会收到一个随机值。

您可以处理这种情况，返回成功标志：

```
bool firstHeapArray (IntHeapArray h, int * out_value) {
   if(!emptyHeapArray(h))
   {
       *value = h.array[0];
       return true; //success
   }
   return false;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T20:59:00.770

无论哪种情况，此函数都必须返回值：

```
int firstHeapArray (IntHeapArray h) {
    if(!emptyHeapArray(h))
        return h.array[0];

    return 0;
} 
```

在您的示例中，它仅在满足某些条件时才返回值。

# regex - htaccess 正则表达式缩短 URL 异常

> ID：10964533
> 
> 赞同：0
> 
> 时间：2012-06-09T20:57:56.187
> 
> 标签：regex

现在，我有：

```
RewriteRule ^([^/\.]+)?$ index.php?id=$1 [L] 
```

匹配网站末尾的任何用户名，例如 www.mywebsite.com/username

如何使正则表达式对某些目录产生异常，例如

“流行/歌曲/”或“添加歌曲/列表/”

这样 www.mywebsite.com/popular/songs/ 不会指向名字为“流行”的人的个人资料？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:07:07.740

在此命令选项之前添加您需要转义。此条件转义从这些条件中的任何一个开始

```
RewriteCond $1 !^(popular|index\.php|content|scripts|upload|admin|robots\.txt) 
```

# php - MVC 设计 - 从 JS 控件到 PHP 视图

> ID：10964540
> 
> 赞同：-1
> 
> 时间：2012-06-09T20:58:59.813
> 
> 标签：php, javascript, model-view-controller

通常，如果我需要一些静态 HTML，我会将请求发送到 PHP 控制器，该控制器调用适当的视图并将其发送到客户端。

我最近意识到，如果我在 JavaScript 中需要静态 HTML，我可以直接使用文件的 ajax 获取请求来调用视图。

所以基本上我有我的 JavaScript 控制器调用一个 PHP 视图文件。

可以绕过 PHP 控制器直接从 JavaScript 控制器调用视图吗？

我只是想确保我在 PHP 和 JS 中都有可靠的 MVC 设计

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T21:01:19.880

> 可以绕过 PHP 控制器直接从 JavaScript 控制器调用视图吗？
> 
> 我只是想确保我在 PHP 和 JS 中都有可靠的 MVC 设计

绝对不。在 MVC 中绕过控制器是不行的。所有的交互都必须通过控制器来控制，这是一个非常简单的规则。否则你最终会得到一团糟而不是坚实的 MVC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T21:01:14.963

如果 PHP 只是包含一些静态 HTML 并发送它，我会建议绕过 PHP 来加速thinhs。

# android - ICS 上的蓝牙聊天示例看起来很乱

> ID：10964543
> 
> 赞同：0
> 
> 时间：2012-06-09T20:59:31.473
> 
> 标签：android, bluetooth, chat, android-4.0-ice-cream-sandwich

我是android编程的新手。我已经为我的应用程序编写了一个 GUI，并希望使用蓝牙功能来完成它。我使用了 2.1 中的蓝牙聊天示例，它在 ICS 中看起来确实很乱，似乎分辨率设置不正确，因此所有元素都被放大了。我试图更改 XML，但我无法解决问题。

有人有想法吗？

提前 THX 彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T06:32:48.817

这可能是因为 AndroidManifest.xml 中有 1 行，将其从

```
 <uses-sdk android:minSdkVersion="6"/> 
```

.. 到类似 ..

```
 <uses-sdk android:minSdkVersion="7"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-03T14:49:54.277

[请参阅我对stackoverflow](https://stackoverflow.com/questions/11082819/bluetooth-connection-on-android-ics-not-possible)的回复。

请参阅：[Android bugtracker 上报告的问题](http://code.google.com/p/android/issues/detail?id=34161)

# javascript - 从 Omnibar 搜索时，如何让 Chrome 不转义搜索词？

> ID：10964546
> 
> 赞同：0
> 
> 时间：2012-06-09T20:59:49.337
> 
> 标签：javascript, google-chrome, opensearch

目前 Chrome[在直接从 Omnibar 搜索](http://www.google.com/chrome/intl/en/webmasters-faq.html#osdd)`http://site.com/#!/search/search%20terms`时导航到。有没有办法让它导航到？（一个通常不会转义散列片段）`http://site.com/#!/search/search terms`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:03:08.447

> 有没有办法让它导航到[http://site.com/#!/search/search](http://site.com/#!/search/search)条款？

不

> （一个通常不会转义散列片段）

一个通常会。URL 中不允许使用原始空格。

# assembly - 如何让 GNU 汇编器输出 ELF 对象而不是 Mach-O 对象？

> ID：10964552
> 
> 赞同：1
> 
> 时间：2012-06-09T21:00:43.727
> 
> 标签：assembly, elf, gnu-assembler

我是操作系统开发的新手，我想将内核编译为 ELF 二进制文件。我有一个用汇编语言编写的加载器（GAS 语法）。`as`我使用（Apple Inc 版本 cctools-822，GNU 汇编器版本 1.38）在 Mac OS X 10.7 上编译它。

```
% as -arch i386 src/loader/x86.S -o src/loader/x86.o 
```

但是，`% file src/loader/x86.o`告诉我这是一个 Mach-O 文件。

```
% file src/loader/x86.o
src/loader/x86.o: Mach-O object i386 
```

我阅读了手册页，`as`但我不知道如何生成 ELF 对象而不是 Mach-O 对象。谷歌搜索也没有任何有用的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:07:31.347

最好的方法是按照[此处](https://stackoverflow.com/questions/8712352/linux-mach-o-disassembler)`binutils`所述安装 x86/x86-64 ELF 。

# recursion - 使用二进制递归对数组元素求和

> ID：10964557
> 
> 赞同：1
> 
> 时间：2012-06-09T21:01:50.143
> 
> 标签：recursion, binary, trace

我还没有开始理解线性递归，然后我想我练习排序算法，然后快速排序是我遇到递归问题的地方。所以我决定使用一个更简单的方法，例如我在网上找到的二进制和。我知道递归，就像所有函数调用一样，一次执行一次，而不是同时执行（这是多线程所做的，但在跟踪时我不关心）。所以我需要在递归调用B之前执行所有递归调用A，但我迷失了。有没有人介意完全追踪它。例如，我使用的大小为 n = 9，其中 elems 都是 1，以保持简单。

```
/**
 * Sums an integer array using binary recursion.
 * @param arr, an integer array
 * @param i starting index
 * @param n size of the array
 * floor(x) is largest integer <= x
 * ceil(x) is smallest integer >= x
 */
public int binarySum(int arr[], int i, int n) {
    if (n == 1)
        return arr[i];
    return binarySum(arr, i, ceil(n/2)) + binarySum(arr,i + ceil(n/2), floor(n/2));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T06:44:29.297

我个人做的是从一个大小为 2 的数组开始。有两个元素。

return binarySum(arr, i, ceil(n/2)) + binarySum(arr,i + ceil(n/2), floor(n/2)) 只会将数组拆分为 2 并添加两个元素。- 情况1

现在，这个微不足道的起点将是较高情况下递归的最低级别。

现在增加 n = 4。数组分为 2：索引从 0-2 和 2-4。

现在索引 0 到 2 内的 2 个元素添加到案例 1 中，索引 2-4 中添加的 2 个元素也是如此。

现在在这种情况下添加了这两个结果。

现在我们能够更深入地理解递归技术，有时像这种情况一样理解自底向上更容易！

现在对于您的问题，考虑一个包含 9 个元素的数组：1 2 3 4 5 6 7 8 9

n = 9 => ceil(9/2) = 5，地板(9/2) = 4

现在首先调用（顶部调用） binarySum(array, 0, 9)

现在 n = 大小不是 1

因此递归调用....

返回 binarySum(array, 0, 5) + binarySum(array, 5, 4)

现在第一个 binarySum(array, 0 ,5) 对数组的前 5 个元素进行操作，第二个 binarySum(array,5,4) 对数组的最后 4 个元素进行操作

因此数组划分可以这样看：1 2 3 4 5 | 6 7 8 9

第一个函数求元素之和：1 2 3 4 5

第二个函数求元素 6 7 8 9 的总和

并将这两个加在一起并作为顶部调用的答案返回！

现在这个 1+2+3+4+5 和 6+7+8+9 是如何工作的？我们再次递归......

所以追踪看起来像

```
 1 2 3 4 5 | 6 7 8 9

             1 2 3 | 4 5                          6 7 | 8 9

     1 2 | 3              4 | 5            6 | 7            8 | 9 
```

[1 | 2] ***_* __** [3] ***_* __** [4 5] ***_* __****[6 7]*****_ *_*** [8 9]***

 ***直到这我们都很好..我们只是递归地调用函数。

但是现在，我们达到了基本情况！

if (n == 1) 返回 arr[i];

[1 + 2] ***_* ___****[3]*****_ *_* _** [4 + 5] ***_* ___****[6 + 7]*****_ *_* _** [8 + 9]******

 ******[3 + 3] ***_* ___** **[9]* ****_ *_* _** [13 + 17]***

 ***```
 [6          +           9]                      [30]

                  [15                +                 30] 

                                   [45] 
```

这是总和。

所以为了理解，看看对问题的主要实例做了什么，你可以确定同样的事情也会发生在问题的次要实例上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-31T17:04:26.727

这个[例子](http://codebloodedvalley.blogspot.in/2014/07/recursion-binary-sum.html) 解释了 java 中带有跟踪的二进制和

跟踪基于数组的索引，其中 0 - 是您的起始索引，8 是数组的长度

![在此处输入图像描述](../Images/0cd9b640f30d2d559c5698310d7936ca.png)************

# php - 在进度条之外显示投票进度条的百分比

> ID：10964558
> 
> 赞同：0
> 
> 时间：2012-06-09T21:01:52.183
> 
> 标签：php, html, css

我正在使用此代码进行网络作业：
[http ://csstechniques.blogspot.sg/2007/05/super-simple-css-bars.html](http://csstechniques.blogspot.sg/2007/05/super-simple-css-bars.html)

但是我如何显示进度条外栏的百分比，如下所示：![在此处输入图像描述](../Images/2f8578b8e6cbc72f6c434e6447dd6e2d.png)？

我尝试了很多方法，这让我发疯。我也用谷歌搜索过，但大多数结果都是使用 jQuery 得出的，我不应该将其用于我的作业（仅 CSS、HTML 和 PHP）。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T21:18:37.797

你的html是这样的：

```
<div class="progress-container">
  <div style="width:95%"></div>
</div> 
```

您将需要其他元素来显示百分比文本，如下所示：

```
<div class="progress-container">
  <div style="width:95%"></div>
</div>
<p class="percentage-text">
  <span class="percentage-number">95</span>%
</p> 
```

然后您可以查询百分比数字元素并使用 JavaScript 更改文本，如下所示：

```
var number = 95; // this is the same number you are using to change the graph.
var perc = document.querySelector(".percentage-number");
perc.innerHTML = number; 
```

查看[MDN 文档中的](https://developer.mozilla.org/en-US/)[querySelector](https://developer.mozilla.org/en/DOM/Document.querySelector)、querySelectorAll、getElementById、getElementsByTagName 等。这将对您有很大帮助。顺便说一句，querySelector 和 querySelectorAll 仅适用于现代浏览器（包括 IE8+）。这就是人们使用 jQuery 来做这些事情的原因之一。

# css - IE9 中不显示背景图片

> ID：10964561
> 
> 赞同：2
> 
> 时间：2012-06-09T21:03:04.507
> 
> 标签：css, internet-explorer-9

其他浏览器（如 chrome）显示良好。IE9 只显示渐变没有图像。

代码 CSS

```
body {
background: 
 url('../images/adventure/background.png') 
background: url('../images/adventure/background.png'), -moz-linear-gradient(top,  rgba(255,255,255,0) 0%, rgba(255,255,255,0.4) 40%, rgba(149,147,160,1) 100%); /* FF3.6+ */
background: url('../images/adventure/background.png'), -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(255,255,255,0)), color-stop(40%,rgba(255,255,255,0.4)), color-stop(100%,rgba(149,147,160,1))); /* Chrome,Safari4+ */
background: url('../images/adventure/background.png'), -webkit-linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,0.4) 40%,rgba(149,147,160,1) 100%); /* Chrome10+,Safari5.1+ */
background: url('../images/adventure/background.png'), -o-linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,0.4) 40%,rgba(149,147,160,1) 100%); /* Opera 11.10+ */
background: url('../images/adventure/background.png'), -ms-linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,0.4) 40%,rgba(149,147,160,1) 100%); /* IE10+ */
background: url('../images/adventure/background.png'), linear-gradient(top,  rgba(255,255,255,0) 0%,rgba(255,255,255,0.4) 40%,rgba(149,147,160,1) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#00ffffff', endColorstr='#9593a0',GradientType=0 ); /* IE6-8 */ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T21:06:47.083

您需要在第一个这样的结束分号 ( `;`) ：`background`

```
background: url('../images/adventure/background.png'); 
```

# python - 如何结合 django 和 gevent 的基础知识？

> ID：10964571
> 
> 赞同：19
> 
> 时间：2012-06-09T21:04:44.023
> 
> 标签：python, django, comet, gevent

经过大量搜索和谷歌搜索，我回到了井边。我有 Django 1.4 并且正在寻找一个体面的*工作*示例来弄清楚让 Django 与 gevent 一起工作。我喜欢 Django 框架，但我需要它来处理长轮询。我已经有一个使用 gevent 的工作服务器，它可以处理长轮询请求以及通过 http 以大约 10 帧/秒的速度流式传输图像。我想使用 Django 中的所有好东西来为这部分提供一个框架。

有很多例子，但不幸的是，这些似乎都不是开箱即用的！有一个可行的例子来理解这两件事是如何协同工作的，真的很有帮助。

这是我到目前为止发现的问题和问题：

[http://codysoyland.com/2011/feb/6/evented-django-part-one-socketio-and-gevent/](http://codysoyland.com/2011/feb/6/evented-django-part-one-socketio-and-gevent/) 问题：ImportError：无法导入设置'webchat.settings'（它在sys.path上吗？） : 没有名为 webchat.settings 的模块

[https://github.com/codysoyland/django-socketio-example/blob/master/README.rst](https://github.com/codysoyland/django-socketio-example/blob/master/README.rst) 问题：安装失败，获取 gevent 的权限问题尝试从 git hub 手动获取它。该示例运行，但在浏览器连接时会生成这些错误。

这些内容提供信息，但不提供基本答案。 [需要帮助理解 Python 中的 Comet（使用 Django）](https://stackoverflow.com/questions/5614274/need-help-understanding-comet-in-python-with-django) [https://bitbucket.org/denis/gevent/src/tip/examples/webchat/chat/views.py](https://bitbucket.org/denis/gevent/src/tip/examples/webchat/chat/views.py) [http://blog.gevent.org/2009/10/10 /simpler-long-polling-with-django-and-gevent/](http://blog.gevent.org/2009/10/10/simpler-long-polling-with-django-and-gevent/)

我希望有人能解释一下（拜托，拜托......）是这样的：我有一个使用 Django 1.4 创建的基本站点-这里的教程[https://docs.djangoproject.com/en/1.4/intro/tutorial01/](https://docs.djangoproject.com/en/1.4/intro/tutorial01/)非常好。所以现在我需要了解要进行哪些更改才能使用 gevent 并能够处理异步事件。我相信这并不难——我只需要理解它的人来解释要做什么以及正在发生的事情（比如monkey_patch）。

谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-12T07:02:45.340

以下是我使用 gevent + Monkey 修补运行 Django 的方法：

1.  我已经修改`manage.py`所以第一行（在shebang之后）是`from gevent import monkey; monkey.patch_all()`

2.  我添加了一个新`run_production_server`脚本（见下文）。

最后，我将前端网络服务器配置为代理对端口`1234`（`run_production_server`正在侦听的端口）的请求。

```
from gevent import monkey; monkey.patch_all()
from gevent.wsgi import WSGIServer

from django.core.management import setup_environ    
import settings
setup_environ(settings)

from django.core.handlers.wsgi import WSGIHandler as DjangoWSGIApp
application = DjangoWSGIApp()
server = WSGIServer(("127.0.0.1", 1234), application)
print "Starting server on http://127.0.0.1:1234"
server.serve_forever() 
```

有些人可能会抱怨这个服务器不够“网络规模”。我怀疑他们能否提供基准来证明这一点，但如果您担心您也可以使用`gunicorn`或`uwsgi`用于您的服务器。但这对我来说很好。

# javascript - jQuery用逗号缩短长数字

> ID：10964572
> 
> 赞同：-1
> 
> 时间：2012-06-09T21:04:44.920
> 
> 标签：javascript, jquery

这可以通过以下方式完成`javascript/jQuery`：

```
<div class="number">99,123,123</div>
<div class="number">123,123,123</div>
<div class="number">1,123,123,123</div>
<div class="number">1,123,123,123,123</div> 
```

显示为

```
99,123,123 // (only start converting after > 8 total digits)
123M // M stands of million
1B
1T 
```

但我还需要保留实际数字，只显示转换后的数字。
我仍然需要访问未转换的号码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:21:53.510

```
$('div.number').each(function(){
    var num = this.innerHTML.replace(/\D/g, "");
    var result;

    if (num.length < 9)
        return true;
    else if (num.length == 9)
        result = num.substr(0, 3) + 'M';
    else if (num.length > 9 && num.length < 12)   
        result = num.substr(0, num.length - 9) + 'B';
    else if (num.length > 12 && num.length < 15)   
        result = num.substr(0, num.length - 12) + 'T';

    this.innerHTML = '<span class="hidden">' + this.innerHTML + '</span>' + result;
});​ 
```

[**现场演示**](http://jsfiddle.net/xtk7k/1)

您还可以使用 jQuery`data`函数保存初始值：

```
 ...
    else if (num.length > 12 && num.length < 15)   
        result = num.substr(0, num.length - 12) + 'T';

    $(this).data('previous-value', this.innerHTML);
    this.innerHTML = result;
}); 
```

[**现场演示**](http://jsfiddle.net/xtk7k/2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T21:22:32.870

如果你不擅长 Javascript 并且擅长 PHP，那就在服务器端做，或者：

a）将原始值存储在javascript var中
b）将值存储在隐藏的html元素中或：（imo最佳解决方案）
c）将原始值存储为`data`相应元素的-attribute。然后你可以像这样检索它：`$("your-element").data("original-value")`

只需显示您的 php 代码，我们就会找到一个解决方案来使其工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T21:22:14.440

这是我的做法：

```
var numbers = $('.number').map(function() {
  return $(this).text().replace(',', '');
});

for (i in numbers) {
  var number = parseInt(numbers[i], 10);
  var number_of_digits = numbers[i].length;

  // ...
} 
```

# c# - 如何开始在 Metro 应用程序中使用 MVVM？

> ID：10964577
> 
> 赞同：6
> 
> 时间：2012-06-09T21:05:43.483
> 
> 标签：c#, mvvm, mvvm-light, microsoft-metro

我正在观察有使用这种模式的应用程序。例如，Bewise.Cookbook 正在实现 Galasoft 的 MVVM 框架。

我想在 Windows 8 中研究一些实验室，但我对在 Metro Applications 中使用这种模式表示怀疑。

有人知道一个教你使用 Win8 和 MVVM 的好网站吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T09:57:33.563

MVVM 在 Windows 8 中没有什么特别之处。如果您没有找到任何有关在 Windows 8 中使用 MVVM 的教程，请尝试搜索有关使用 Silverlight 的 MVVM 的教程。

你也可以检查这个：

*   [在 MVVM 中为 Windows 8 中的 Metro 风格应用程序制作的地址簿应用程序（第 1 部分）](http://www.codeproject.com/Articles/391783/An-Address-Book-Application-Made-in-MVVM-For-Metro)
*   [在 MVVM 中为 Windows 8 中的 Metro 风格应用程序制作的地址簿应用程序（第 2 部分）](http://www.codeproject.com/Articles/393037/An-Address-Book-Application-Made-in-MVVM-For-Metro)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-06T21:23:03.460

我推荐[StyleMVVM](http://stylemvvm.codeplex.com)。这是一个为 Metro 平台从头开始设计的 MVVM 框架。它包括自己的基于属性的 IoC、实现`ICommand`和附加的命令行为，以及用于 Tiles、Badges、Toast 和设置窗格（魅力弹出）的服务。它还支持所有三种语言（C#、C++/CX 和 HTML/JS）。

为了让事情容易上手，有许多 C# 和 C++/CX 模板以及一个很好的示例天气应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T03:39:50.693

查看[适用于 Windows 8](http://w8mvvm.codeplex.com/)库的 MVVM。这很简单。您可以将其 NuGet 包添加到您的项目中。它还有一个用于 Visual Studio 的在线项目模板。所以很容易开始。它是库而不是框架，因此您只能使用您喜欢的功能。

# javascript - 如何用草坪椅js链接记录

> ID：10964578
> 
> 赞同：1
> 
> 时间：2012-06-09T21:05:53.213
> 
> 标签：javascript, database, cordova, nosql, lawnchair

我在我的 Phonegap 应用程序中使用来自[http://brian.io/lawnchair/](http://brian.io/lawnchair/)的 Lawnchair JS来管理我的数据库记录。我是文档存储的新手，但对传统的关系数据库有经验。如果我想在另一条记录上引用一条记录，我应该怎么做。例如：我有多个食品配料记录，我有多个食谱记录，在食谱 JSON 中，有没有办法引用配料记录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T19:13:06.150

要使用像草坪椅这样的 json 文档存储来实现您想要的，您只需将引用文档的键名存储在您的文档中。

例如，您将拥有这些食品成分文件：

```
{key:'fi_1', name: 'rice', id: 1}
{key:'fi_2', name: 'corn', id: 2} 
```

和那些配方文件：

```
{key:'r_332', ingredients: ['fi_1', 'fi_54'], name: 'risotto', id: 332}
{key:'r_333', ingredient: ['fi_12'], name:'cookie', id: 333} 
```

您可以将所有食谱的列表存储在一个文档中：

```
{key:'cookbook', recipes: ['r_1', 'r_2', .... 'r_332', 'r_333', .... ] } 
```

然后，您可以检索食谱文档：

```
store.get('cookbook', function(data) {
    var recipes = data.recipes;
    // do something with the list of all recipes
}); 
```

并寻找一个配方来检索其成分：

```
store.get('r_332', function(data) {
    var ingredients = data.ingredients;
    for (ingredient_key in ingredients) {
        store.get(ingredient_key, function(ingredient_data) {
             var name = ingredient_data.name;
             var id = ingredient_data.id;
             // do something with each ingredient
             alert('ingredient: ' + name + ' - id: ' + id);
        }
    }
}); 
```

在上面的列表中，您可以只存储它们的 id，而不是存储引用文档的完整键名，因为您应该知道它们的类型以及如何从中重新创建键名（食品成分：'fi_' 前缀后跟id, recipe : 'r_' 后跟 id..)。

# c# - C#中的类型转换，我的错误在哪里？

> ID：10964581
> 
> 赞同：0
> 
> 时间：2012-06-09T21:06:07.737
> 
> 标签：c#, data-structures

我在 Java 上“长大”，最近完全转向 C#。我只是在自学 ATM，然后回去重做我现在使用 C# 用 Ja​​va 编写的所有旧编程任务。这是我尝试使用泛型并实例化堆栈数组的特定代码行。

```
stack = (T[])(new object[def_cap]); 
```

这给了我这个编译器错误

```
Cannot convert type 'object[]' to 'T[]' (CS0030) 
Cannot implicitly convert type 'object[]' to 'T[]' (CS0029) 
```

我猜演员运算符在 C# 中的工作方式与在 Java 中不同，并且想知道是否有人可以启发我。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:08:31.823

改用就好`stack = new T[def_cap];`了。您已经拥有该类型并且可以直接使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:12:35.083

要将数组转换为另一种类型，您可以执行以下操作：

```
object[] objArr = new object[10];
T[] tArr = objArr.Cast<T>().ToArray(); 
```

请注意，如果无法将对象强制转换为 type `T`，它将`InvalidCastException`在运行时抛出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T21:30:34.130

C#仅支持引用类型的[数组协方差。](http://blogs.msdn.com/b/ericlippert/archive/2007/10/17/covariance-and-contravariance-in-c-part-two-array-covariance.aspx)因此，您必须将泛型参数 T 限制为类：

```
 public static void Foo<T>() where T:class
    {
        T[] stack = (T[])(new object[def_cap]);
    } 
```

但是在您的情况下，您将 object[] 转换为 T[]，除非 T 是 System.Object，否则您将在运行时获得 InvalidCastException，因为只有当 Y 与X 或者如果 X 是从 Y 派生的类（但不是如果 Y 是从 X 派生的）。

# iphone - 我应该担心苹果将在 iOS6 中停止使用谷歌地图的传闻吗？

> ID：10964585
> 
> 赞同：16
> 
> 时间：2012-06-09T21:06:55.983
> 
> 标签：iphone, ios, ios5, mapkit, ios6-maps

几乎所有主要新闻媒体都在报道苹果将在 iOS6 中停止使用谷歌地图服务。我认为没有人真正知道这些变化究竟是什么，何时推出，苹果将如何实施它们以及谷歌或苹果是否会开始为他们的服务收费。由于这些不确定性，我很难做出明智的决定，是否应该发布我已经研究了一年多的新公共巴士跟踪应用程序。我已将最初的硬性截止日期定为 2012 年 6 月 15 日。我知道最好的办法是等待，看看会有哪些变化以及 Apple 将如何实施这些变化。但是对于推迟发布日期，我有点不耐烦和压力，因为任何进一步的延迟都会以非常重要的方式影响我的许多其他计划。

有关该应用程序的更多信息：

它根据从第三方交通机构的 API 获得的信息提供实时公共交通信息。它在很大程度上依赖于 iOS MapKit 框架和 iOS 定位服务来实时显示给定路线上公交车的当前地理位置，并提供两个位置之间的交通信息。[根据 Apple](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MapKit_Framework_Reference/_index.html)的说法，iOS MapKit 框架使用 Google 服务来提供地图数据。某些功能会调用 Google 地图应用程序来提供交通规划和前往最近站点的转弯路线。

我的问题：

如果传闻属实，你认为 Apple 是否肯定会在不影响已经使用当前 MapKit 框架的应用程序的情况下实施任何更改？我应该为什么样的潜在问题做好准备？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-09T21:12:30.463

根据我使用 SDK 的经验，我可以告诉您：不，您不必担心，原因如下：

*   众所周知，Apple 会维护向后兼容的更新。
*   Map Kit API 是封装的，根本不应该改变。
*   即使实现地图和路线的技术发生变化，Apple 仍将保持相同的界面来访问这些功能。
*   任何 SDK 的大部分低级功能都是封装的，它们的公共接口（我们开发人员可以访问）是稳定的，不应更改。
*   这些接口的中断必须是非常难以想象的。
*   更改较低级别的实现不会更改 Map Kit API 的公共接口。
*   即使界面发生了变化，Apple 仍会保留旧界面并向其添加弃用元数据。这些接口仍然可以工作，并且可能会添加其他接口。

唯一的潜在问题是您需要考虑何时更新您的应用程序，这将是关于是否实施新 Map Kit 可能提供的新功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-09T21:49:51.000

我同意 Omar 的观点，即 Apple 可能会非常努力地确保`MapKit`开发人员免受破坏。但是，会有*一些*问题。

我看到的第一个问题是使用谷歌地图的未记录功能。Undocumented 并不一定与*Private APIs*相同，它很难潜入应用商店（尽管并非不可能）。

例如，[这种使用 URL 打开地图](https://stackoverflow.com/questions/576768/how-to-invoke-iphone-maps-for-directions-with-current-location-as-start-address)以显示路线的技术。这与 using 不同`MapKit`，但对于某些应用程序来说仍然可能是一个问题。

我看到的第二件事是与 Google 地图相关的潜在*法律问题。*如果我没记错的话，有谷歌地理编码网络服务，只要你在谷歌地图上显示结果，就可以免费使用。目前，iPhone 地图是谷歌地图（Maps.app 或`MapKit`地图）。将来，他们的地图不会。如果[您的应用依赖于使用 Google 地理编码服务的后端](https://stackoverflow.com/questions/10992595/can-i-still-use-google-maps-in-ios-6)，您可能需要进行一些返工。

无论如何，大多数与地图相关的代码不应该被破坏。我只是想举几个例子来说明可能存在问题的地方。

**更新：**另外，有报道称新的苹果地图在某些方面不如谷歌地图。虽然它可能仍然*有效*，但如果您的应用程序正在执行诸如路由到某个*地址*之类的操作，您可能会发现 Apple 的新地图应用程序在查找您提供的位置方面做得较差。因此，为了像以前*一样*正常工作，您可能需要重构您的应用程序以使用坐标，而不是地址。同样，小事情可能会在这里有所作为。

# bash - HDI：在 bash 中检查网站上某个项目的“库存”状态？

> ID：10964593
> 
> 赞同：1
> 
> 时间：2012-06-09T21:07:46.487
> 
> 标签：bash, scrape, webstore

我在一个网站上寻找一个有货的东西真是太难了。我一直错过它大约半小时左右。

我怎样才能拉出尼康商店页面（[http://shop.nikonusa.com/store/nikonusa/en_US/pd/productID.249538300](http://shop.nikonusa.com/store/nikonusa/en_US/pd/productID.249538300)）的内容并在灰色时向自己发送警报（address@gmail.com） “在哪里购买”按钮已替换为黄色的“立即购买”按钮（可在此处查看：[http](http://shop.nikonusa.com/store/nikonusa/en_US/pd/productID.226487200) ://shop.nikonusa.com/store/nikonusa/en_US/pd/productID.226487200 ）。这可能来自 bash 脚本，还是太复杂了？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:50:57.703

您可以使用[curl](http://linux.die.net/man/1/curl)抓取网页，然后使用 grep 搜索按钮的 alt 文本...

```
#!/bin/bash
#D800
x=$( curl -s http://shop.nikonusa.com/store/nikonusa/en_US/pd/productID.249538300 | grep 'alt="Buy Now"')
#D7000 (for testing)
#x=$( curl -s http://shop.nikonusa.com/store/nikonusa/en_US/pd/productID.226487200 | grep 'alt="Buy Now"')
if [ ! -n "$x" ]
then
    echo Not Available
    exit 1
fi
echo "Get clicking" | mail -s "D800 Available" you@example.com 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T08:54:16.137

我最终和 wget 一起丑化了一些东西。

如果有人遇到同样的问题，半消毒代码如下：

```
#!/bin/bash
while [ ! -f mailready ]
do
sleep 450
echo -e "\n Trying wget [URLHERE]"
wget -N [URLHERE]
        if grep -q buy-now [Downloaded URLfile]
        then
                echo -e "\n Buy now button found at [URL, DATE]\" > scriptbuffer
                cat mailheader scriptbuffer > mailready
                cat mailready| msmtp RECIPIENT@gmail.com
                echo -e "\nBuy-now button found... ending"
        else
                echo -e "\nNo Buy-now button found"
        fi
done 
```

它对我来说非常好，不知道我在做什么。我将其设置为大约每 7 分钟检查一次，两三个小时后，我就可以下订单了。

# java - 如何在 java 中克服这个 HTTP GET 404 错误？

> ID：10964596
> 
> 赞同：5
> 
> 时间：2012-06-09T21:08:15.807
> 
> 标签：java, apache, http, google-places-api

我正在使用[Apache HTTPClient 4.2](http://hc.apache.org/downloads.cgi)并尝试进行[Google Places API 查询](https://developers.google.com/maps/documentation/places/#PlaceSearchRequests)，但遇到了问题。

这是一个基本的片段来说明这个问题：

```
 //Web API related
  String apiKey = "API_KEY"; 
  //search params
  String location = "51.527277,-0.128625";//lat,lon
  int rad = 500;
  String types = "food";
  String name  = "pret";

  String getURL = "/maps/api/place/search/json?location="+location+"&radius="+rad+"&types="+types+"&name="+name+"&sensor=false&key="+apiKey;
  HttpHost host = new HttpHost("maps.googleapis.com",443,"https");
  HttpGet get = new HttpGet(host.toURI() + getURL);
  System.out.println("using getRequestLine(): " + get.getRequestLine());
  System.out.println("using getURI(): " + get.getURI().toString());

  DefaultHttpClient httpClient = new DefaultHttpClient(new ThreadSafeClientConnManager());
  try {
      HttpResponse response = httpClient.execute(get);
      System.out.println("response: " + response.getStatusLine().toString());
  } catch (Exception e) {
      System.err.println("HttpClient: An error occurred- ");
      e.printStackTrace();
  } 
```

我得到的这个输出看起来有点像这样（当然 API_KEY 除外）：

```
using getRequestLine(): GET https://maps.googleapis.com:443/maps/api/place/search/json?location=51.527277,-0.128625&radius=500&types=food&name=pret&sensor=false&key=API_KEY HTTP/1.1
using getURI(): https://maps.googleapis.com:443/maps/api/place/search/json?location=51.527277,-0.128625&radius=500&types=food&name=pret&sensor=false&key=API_KEY
response: HTTP/1.1 404 Not Found 
```

这有点令人费解，因为：

1.  我对 HTTP REST 调用没有太多经验
2.  [如果我在Simple REST Client Chrome 扩展](https://chrome.google.com/webstore/detail/fhjcajmcbmldlhcimfajhfbgofnpcjmb)中尝试 getRequestLine() url，我会得到状态 200，其中的数据如下所示：

    {“html_attributions”：[]，“结果”：[]，“状态”：“REQUEST_DENIED”}

但如果我使用 getURI() 版本，它工作正常。

我不确定问题是附加的“HTTP/1.1”还是其他问题。这是从 Java 进行 Google Places API 查询的正确方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:44:10.483

像这样手动构建 URL 可能会导致您的代码无法正确转义 API 密钥，并且如果主机是 HTTP 客户端上的 HTTPS，您也不需要添加 433，以下是一些有效的代码：

```
import java.net.URI;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpHost;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.utils.URIUtils;
import org.apache.http.client.utils.URLEncodedUtils;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.impl.conn.tsccm.ThreadSafeClientConnManager;
import org.apache.http.message.BasicNameValuePair;
import org.apache.http.util.EntityUtils;

public class GooglePlacesRequest {

    public static void main(String[] args) throws Exception {

        // Web API related
        String apiKey = "YOUR_API_KEY_HERE";
        // search params
        String location = "51.527277,-0.128625";// lat,lon
        String types = "food";
        String name = "pret";

        List<NameValuePair> parameters = new ArrayList<NameValuePair>();
        parameters.add(new BasicNameValuePair("location", location));
        parameters.add(new BasicNameValuePair("radius", "500"));
        parameters.add(new BasicNameValuePair("types", types));
        parameters.add(new BasicNameValuePair("name", name));
        parameters.add(new BasicNameValuePair("sensor", "false"));
        parameters.add(new BasicNameValuePair("key", apiKey));

        URL url = new URL(
                "https://maps.googleapis.com/maps/api/place/search/json");
        URI finalURI = URIUtils.createURI(
                url.getProtocol(), 
                url.getHost(),
                url.getPort(), 
                url.getPath(),
                URLEncodedUtils.format(parameters, "UTF-8"), 
                null);

        HttpGet get = new HttpGet(finalURI);
        System.out.println("using getRequestLine(): " + get.getRequestLine());
        System.out.println("using getURI(): " + get.getURI().toString());

        DefaultHttpClient httpClient = new DefaultHttpClient(new ThreadSafeClientConnManager());
        try {
            HttpResponse response = httpClient.execute(get);
            System.out.println("response: "
                    + response.getStatusLine().toString());
            System.out.println( "Response content is:" );
            System.out.println( EntityUtils.toString( response.getEntity() ) );
        } catch (Exception e) {
            System.err.println("HttpClient: An error occurred- ");
            e.printStackTrace();
        }

    }

} 
```

# java - 如何从源代码构建 Mojarra

> ID：10964606
> 
> 赞同：5
> 
> 时间：2012-06-09T21:10:08.627
> 
> 标签：java, maven, build, jar, mojarra

[我从这里](https://maven.java.net/content/repositories/releases/org/glassfish/javax.faces/2.1.9/)下载了 Mojarra 源代码。我还下载了 pom 文件来构建源代码文件。事实证明，代码结构与原来的不同，我需要创建目录和文件。

我创建了这个目录结构：

```
laptop@Laptop javax.faces-2.1.9-sources]$ tree

.
|-- pom.xml
`-- src
    `-- main
        |-- java
        |   |-- com
        |   |   `-- sun
        |   |       `-- faces ....(other sub directories)
        |   `-- javax
        |       `-- faces ....(other sub directories)
        `-- resources
            `-- META-INF
                `-- MANIFEST.MF 
```

我创建了目录`src`、和`main`，并将源代码目录放在了这些目录中，但它不起作用。将源代码文件放入包中的正确方法是什么？`java``resources`

最好的祝愿

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-09-28T14:38:47.893

自**2017 年 1 月 16 日起**，您可以使用以下步骤构建 Mojarra：

**注意：**构建 Mojarra 需要它`ant`并`maven`安装在您的系统上。它还要求您使用正确的 JDK 版本：

*   对于 Mojarra，请`2.3.x`使用 JDK `8`（或`1.8`）。
*   对于 Mojarra，请`2.2.x`使用 JDK `7`（或`1.7`）。
*   对于 Mojarra，`2.1.x`使用 JDK `6`（或`1.6`）（我还没有实际测试过）。

* * *

1.  下载源代码`git://java.net/mojarra~git`：

    ```
    git clone git://java.net/mojarra~git 
    ```

2.  导航到您的新**`mojarra~git`**目录：

    ```
    cd mojarra~git/ 
    ```

3.  复制**`build.properties.glassfish`**到**`build.properties`**：

    ```
    cp build.properties.glassfish build.properties 
    ```

4.  在文件中设置`jsf.build.home`属性**`build.properties`**：

    ```
    jsf.build.home=/path/to/mojarra 
    ```

    这是执行此操作的（GNU）`sed`命令：

    ```
    sed -i "s|jsf[.]build[.]home=.*|jsf.build.home=$PWD|" build.properties 
    ```

5.  **Mojarra`2.3.x`注意：** *跳过这一步。*

    运行`ant`以构建 Mojarra 构建工具：

    ```
    ant main clean main 
    ```

6.  运行以下`ant`命令之一来构建 Mojarra：

    1.  如果要将 Mojarra 构建为单个，请运行以下命令**`javax.faces.jar`**：

        ```
        ant clean main mvn.deploy.snapshot.local 
        ```

        新建的 Mojarra jar 将**`jsf-ri/build/mvn/target`**位于**`javax.faces-${mojarra.version}.jar`**.

        **Mojarra`2.3.x`注意：** *新建的 JSF/Mojarra API jar 将位于* *as***`jsf-api/build/mvn/target`** ***`javax.faces-api-${mojarra.version}.jar`****.***

    ***   **Mojarra`2.3.x`注意：** *此命令可能不适用于 Mojarra `2.3.x`。*

        如果要将 Mojarra 构建为两个 jar，请运行以下命令， **`jsf-api.jar`**并且**`jsf-impl.jar`**：

        ```
        ant clean main mvn.pre-maven-rename.deploy.snapshot.local 
        ```

        新建的 Mojarra API jar 将**`jsf-api/build.pre-maven-rename/mvn-pre-maven-rename/target`**位于**`jsf-api-${mojarra.version}.jar`**. 新建的 Mojarra jar 将**`jsf-ri/build.pre-maven-rename/mvn-pre-maven-rename/target`**位于**`jsf-impl-${mojarra.version}.jar`**.** 

 **Mojarra 快照 jar 也将安装在您的本地**`~/.m2/`**存储库中以用于 maven 目的。**

# javascript - 给我的谷歌地图上色

> ID：10964607
> 
> 赞同：1
> 
> 时间：2012-06-09T21:10:11.190
> 
> 标签：javascript, jquery, google-maps

我正在使用 Google Maps V3 API 来显示我的地图。

**问题：**我怎样才能给地图着色，比如蓝色，这样地图图块有蓝色，但标记和其他叠加层没有？我不希望在地图本身上使用自定义样式，这会导致我快速达到样式地图的谷歌地图使用限制。

我想添加一个不透明的蓝色多边形，但认为当您平移地图时多边形会移出屏幕。有没有更好的方法来达到这个效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:16:29.077

添加一个矩形对我来说看起来很有说服力，但有一个缺陷：放大和缩小地图时会闪烁。我没有彻底测试，但您可能会遇到分层问题，例如，无法单击矩形下方的线。我记得，标记位于不同的窗格中，因此可以单击。

**演示** [http://jsfiddle.net/yV6xv/27/](http://jsfiddle.net/yV6xv/27/)

```
bounds = new google.maps.LatLngBounds(
  new google.maps.LatLng(-84.999999, -179.999999), 
  new google.maps.LatLng(84.999999, 179.999999));

rect = new google.maps.Rectangle({
    bounds: bounds,
    fillColor: "#0000ff",
    fillOpacity: 0.3,
    strokeWeight: 0,
    map: map
}); 
```

旁注：我尝试了这样的 KML 叠加层：

```
 <ScreenOverlay>
    <name>Dynamic Positioning: Top of screen</name>
    <visibility>0</visibility>
    <Icon>
      <href>http://...blue.png</href>
    </Icon>
    <overlayXY x="0" y="1" xunits="fraction" yunits="fraction"/>
    <screenXY x="0" y="1" xunits="fraction" yunits="fraction"/>
    <rotationXY x="0" y="0" xunits="fraction" yunits="fraction"/>
    <size x="1" y="1" xunits="fraction" yunits="fraction"/>
  </ScreenOverlay> 
```

本来是赢家，但你不能拖动和滚动地图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T21:21:41.180

我将假设您的意思是将 API 嵌入到网页中。如果这是真的，你可以将 API 包装到一个 div 中，让我们说，然后使用一些 CSS 用你选择的蓝色填充 div，并将所述 div 的不透明度设置为 0.4 或（40%）。您的代码将如下所示：

HTML

```
<div id="mapwrapper">MAP API EMBEDDING CODE</div> 
```

CSS

```
#mapwrapper{
      opacity:0.4;
      filter:alpha(opacity=40); /* For IE8 and earlier */
      } 
```

[由w3schools.com](http://www.w3schools.com/css/css_image_transparency.asp)引用

我已将它用于网站上的社交媒体/社交网络连接。

同样，如果您要嵌入网站，我会特别询问您的意图，但是这该死的东西不会让我发表评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-16T14:14:04.737

实际上，我自己发现了一个比建议的解决方案更有效的解决方案。

我的解决方案也将防止闪烁。[**在这个线程中检查它！**](https://stackoverflow.com/questions/17638175/make-a-color-tinted-map-in-google-maps-v3)

# android - 如何解决错误“java.net.SocketException：操作超时”？

> ID：10964609
> 
> 赞同：0
> 
> 时间：2012-06-09T21:10:54.223
> 
> 标签：android, json, nullpointerexception

JSON解析器类

```
public class JSONParser {

    static InputStream is = null;
    static JSONObject jObj = null;
    static String json = "";

    // constructor
    public JSONParser() {

    }

    public JSONObject getJSONFromUrl(String url, List<NameValuePair> params) {

        // Making HTTP request
        try {
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(url);
            httpPost.setEntity(new UrlEncodedFormEntity(params));

            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent();

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(
                    is, "iso-8859-1"), 8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
              /*int i = 0,c; 
            while ((c = reader.read()) != -1) {
                sb.append((char)c);
                Log.d("test",String.valueOf(i++) + " " + (char)c);
            }*/
            is.close();
            json = sb.toString();
            Log.e("JSON", json);
        } catch (Exception e) {
            Log.e("Buffer Error", "Error converting result " + e.toString());
        }

        // try parse the string to a JSON object
        try {
            jObj = new JSONObject(json);
        } catch (JSONException e) {
            Log.e("JSON Parser", "Error parsing data " + e.toString());
        }

        // return JSON String
        return jObj;

    }
} 
```

[http://www.2shared.com/document/gH4zJsOO/log.html](http://www.2shared.com/document/gH4zJsOO/log.html)

将数据发送到 MySQL 数据库

```
06-09 21:46:02.650: D/dalvikvm(315): GC_FOR_MALLOC freed 6777 objects / 323848 bytes in 87ms
06-09 21:49:11.980: W/System.err(315): java.net.SocketException: The operation timed out
06-09 21:49:11.990: W/System.err(315):  at org.apache.harmony.luni.platform.OSNetworkSystem.connectStreamWithTimeoutSocketImpl(Native Method)
06-09 21:49:12.000: W/System.err(315):  at org.apache.harmony.luni.platform.OSNetworkSystem.connect(OSNetworkSystem.java:115)
06-09 21:49:12.000: W/System.err(315):  at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:244)
06-09 21:49:12.010: W/System.err(315):  at org.apache.harmony.luni.net.PlainSocketImpl.connect(PlainSocketImpl.java:533)
06-09 21:49:12.010: W/System.err(315):  at java.net.Socket.connect(Socket.java:1055)
06-09 21:49:12.020: W/System.err(315):  at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:119)
06-09 21:49:12.030: W/System.err(315):  at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:143)
06-09 21:49:12.030: W/System.err(315):  at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
06-09 21:49:12.040: W/System.err(315):  at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
06-09 21:49:12.050: W/System.err(315):  at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:348)
06-09 21:49:12.050: W/System.err(315):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
06-09 21:49:12.060: W/System.err(315):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
06-09 21:49:12.060: W/System.err(315):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
06-09 21:49:12.070: W/System.err(315):  at tn.pack.ordre.library.JSONParser.getJSONFromUrl(JSONParser.java:42)
06-09 21:49:12.080: W/System.err(315):  at tn.pack.ordre.library.UserFunctions.registerUser(UserFunctions.java:60)
06-09 21:49:12.090: W/System.err(315):  at tn.pack.ordre.EnregistrerActivity.onClickValider(EnregistrerActivity.java:49)
06-09 21:49:12.090: W/System.err(315):  at java.lang.reflect.Method.invokeNative(Native Method)
06-09 21:49:12.100: W/System.err(315):  at java.lang.reflect.Method.invoke(Method.java:521)
06-09 21:49:12.110: W/System.err(315):  at android.view.View$1.onClick(View.java:2067)
06-09 21:49:12.120: W/System.err(315):  at android.view.View.performClick(View.java:2408)
06-09 21:49:12.120: W/System.err(315):  at android.view.View$PerformClick.run(View.java:8816)
06-09 21:49:12.130: W/System.err(315):  at android.os.Handler.handleCallback(Handler.java:587)
06-09 21:49:12.140: W/System.err(315):  at android.os.Handler.dispatchMessage(Handler.java:92)
06-09 21:49:12.150: W/System.err(315):  at android.os.Looper.loop(Looper.java:123)
06-09 21:49:12.150: W/System.err(315):  at android.app.ActivityThread.main(ActivityThread.java:4627)
06-09 21:49:12.160: W/System.err(315):  at java.lang.reflect.Method.invokeNative(Native Method)
06-09 21:49:12.160: W/System.err(315):  at java.lang.reflect.Method.invoke(Method.java:521)
06-09 21:49:12.170: W/System.err(315):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
06-09 21:49:12.180: W/System.err(315):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
06-09 21:49:12.180: W/System.err(315):  at dalvik.system.NativeStart.main(Native Method)
06-09 22:13:27.330: E/Buffer Error(315): Error converting result java.lang.NullPointerException
06-09 22:13:27.360: E/JSON Parser(315): Error parsing data org.json.JSONException: End of input at character 0 of 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T17:56:05.050

问题出在 EasyPHP-5.3.9 我用 EasyPHP-2.0b1 更改了版本，它可以工作

# c# - 如何获得 WebResponse 的第一位的时间？

> ID：10964610
> 
> 赞同：3
> 
> 时间：2012-06-09T21:11:08.050
> 
> 标签：c#, .net, httpwebrequest, httpwebresponse

使用 C#，我需要确定开始接收来自 WebRequest 的响应所需的时间（目前，我并不担心下载完整响应所需的时间）。

据我了解，要做到这一点，我需要使用 WebRequest 的异步方法。这是我想出的：

```
public TimeSpan TimeToFirstBit(string url)
{
  HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
  request.Accept = "*/*";

  DateTime? firstBit = null;
  DateTime start = DateTime.Now;

  IAsyncResult asyncResult = request.BeginGetResponse(
      (async) => { firstBit = DateTime.Now; },
      null);

  asyncResult.AsyncWaitHandle.WaitOne();
  request.EndGetResponse(asyncResult);

  TimeSpan result = start - firstBit.Value; 
  // Previous line generates a System.InvalidOperationException: 
  // "Nullable object must have a value."

  return result; 
```

}

这导致“可空对象必须有一个值”。这似乎表明 WaitOne() 和 EndGetResponse 方法实际上并没有像我认为的那样等待异步调用完成。

那么我该如何等到 BeginGetResponse() 完成呢？这确实是确定请求响应时间的正确方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T06:33:58.570

如果您只想知道网络上请求和响应之间的延迟，请使用网络数据包嗅探器，例如 Fiddler。我对来自数据包级工具的计时数据比来自进程内计时器更有信心。由于包含 .net 堆栈开销，进程内测量可能会略有偏差。如果您想知道服务器的响应速度有多快，您就不想包括客户端开销。

# windows - 直观地指示活动控件（对于不显示焦点矩形的控件）

> ID：10964612
> 
> 赞同：-1
> 
> 时间：2012-06-09T21:11:26.890
> 
> 标签：windows, mfc, focus, indicator

我正在编写一个有两个列表视图控件的小 Windows 应用程序。我已经对其进行了设置，以便用户可以在两者之间进行制表符（焦点），但我需要一种直观地指示哪个是活动控件的方法。我不想麻烦地弄乱自绘控件，所以我尝试了一些不同的窗口样式，如*边框*和*客户端边缘*，但没有一个看起来不错。我决定切换*disabled*属性，因为它看起来最好并且易于使用。

现在的问题是我已经设置了控件，因此每当用户单击其中一个时，它都会抓住焦点（调用`SetFocus()`，设置自己的句柄等），但是当然，禁用的控件不会收到事件通知，例如鼠标点击。

有没有人对我如何保留活动控件的视觉区别以及如何用鼠标切换活动窗口有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T01:04:02.780

Hans 对使用 CTRLCOLOR 的建议让我想起了很久以前使用它来轻松地对控件的颜色进行一些更改，这让我想起了[`CustomDraw`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb761817%28v=vs.85%29.aspx).

我决定使用 CustomDraw 来指示当前活动的控件，因为它更容易，而且提供了更好的控制。

# wpf - 绑定评估机制

> ID：10964619
> 
> 赞同：1
> 
> 时间：2012-06-09T21:12:44.517
> 
> 标签：wpf, binding

鉴于：

```
<TextBox Text='{Binding MyCollection[MyIndex].MyProperty}'/> 
```

在哪里：

*   `MyCollection`是一个可观察的`MyClass`项目集合
*   `MyClass`实现`MyProperty`（`string`实际上）
*   `MyClass`工具`INotifyPropertyChanged`

那么，下次重新评估绑定时，究竟会`TextBox.Text`从哪里获得值？我可以想到两个可能的来源：

*   **`MyClass`MyCollection 中实际包含的**任一实例（即实际***调用集合索引器以获取更新的值*），**
***   **还是***在绑定设置发生时*集合中存在的实例，即使它已经在集合中不存在？**

 **如果结果是前一种情况，我可以以某种方式接近后一种行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:16:59.327

重新评估绑定时，将使用整个绑定语法，包括调用索引器。**

# python - Python 索引类似于 MATLAB 的 end/2

> ID：10964622
> 
> 赞同：3
> 
> 时间：2012-06-09T21:13:04.820
> 
> 标签：python, matlab, syntax

MATLAB 有一种非常方便的语法来获取列表的一半：

```
x(1:end/2) 
```

我知道 python 执行此操作的语法是

```
x[:len(x)/2] 
```

在这种情况下这很好，因为`len(x)`它很容易编写。但是，当列表的名称很长（有时需要如此）时，这种语法就变得不那么痛苦了，当有一个相似的长名称列表时更是如此。

我知道这是在黑暗中的真实镜头，但是 python 有像 MATLAB 那样的语法选项吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T21:13:55.053

没有专门的语法。如果你需要做很多，写一个函数：

```
def half_list(l):
    return l[:len(l)/2] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:22:18.860

不，python 中的列表没有这个概念 `end`（一个有点相似的概念是索引`-1`）。
一个简单（但不推荐）解决您的问题的方法是：

```
l = longnamelist
l[:len(l)/2] 
```

或复制/粘贴长名称...（一些编辑器有复制单词的快捷方式，这使得复制/粘贴长名称非常容易。）

# c++ - 使用复制算法在 C++ 中打印矢量的格式化问题

> ID：10964623
> 
> 赞同：1
> 
> 时间：2012-06-09T21:13:09.567
> 
> 标签：c++, printing, vector

作为参考，我在*C++ Solutions: Companion to The C++ Programming Language* by David Vandevoorde 在第 10 章练习 19 的答案中找到了这一点

为了输出函数的结果，他使用这段代码利用复制算法打印出向量

```
map<string, vector<int> > *index = make_line_index(cin, entries);
vector<string>::iterator p = entries->begin();
for(; p!=entries.end(); ++p) {
   cout << "Word " << *p << " appears in lines ";
   map<string, vector<int> >::iterator lines = index->find(*p);
   std::copy((*p).second.being(), (*p).second.end(),
             ostream_iterator<int>(cout, ", "));
   cout << ".\n";
} 
```

这似乎是打印出矢量的一种非常好的方法，但我唯一的问题是输出最终会出现一些我似乎无法摆脱的格式丑陋

示例输出：

```
 Word cat appears in lines 1, 2, .
 Word dog appears in lines 3, . 
```

我想知道是否有一种简单的方法可以解决这个问题并仍然使用该算法，或者最好回到使用 for 循环并使用 if 语句来确保我不会在最后一个条目之后打印“,” .

我研究了回滚 cout，但似乎那是不可能的。根据我收集的信息，seekp() 不适用于 cout。

或者，如果有人有另一种有趣的方式来打印矢量，我会很高兴听到它。

如果有人想查看 Vandervoorde 的其余解决方案或 Stroustrup 书中的练习，我很乐意发布它（除非在发布书中的完整练习和解决方案时出现任何版权问题）。我觉得没有必要发布 Vandervoorde 的其余代码

另外，这是我在这里的第一个问题，所以如果我做错了什么或不满意，请不要犹豫通知我。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:16:42.597

您可以使用不同的输出迭代器，例如，考虑这个非常有用的[`infix_ostream_iterator`](https://groups.google.com/group/comp.lang.c++/msg/a746a588cedfa44b)from comp.lang.c++ 实现。看起来[Jerry Coffin](https://stackoverflow.com/users/179910/jerry-coffin)也在 Stack Overflow 上发布了它，以回答[“使用逗号 C++ 打印列表”。](https://stackoverflow.com/a/3497021/151292)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:54:29.973

恕我直言，你们正在使一件简单的事情变得不必要地复杂化

```
//populate a vector
std::vector< int > vints;
for(int k= 0; k<4; k++ )
    vints.push_back( k );

// print out with commas between elements
// but not after last one
for( int k=0;k <vints.size()-1;k++)
    cout << vints[k] << ", ";
cout << vints.back() << endl; 
```

# sql-server - 尝试划分数据时除以零错误

> ID：10964627
> 
> 赞同：-2
> 
> 时间：2012-06-09T21:14:03.700
> 
> 标签：sql-server

这是我的代码：

```
SELECT CASHIER_ID AS SERVER, CONVERT(VARCHAR(10),[DATETIME],111) AS DATE, 
  SUM(GRAND_TOTAL) AS TOTAL_SALES, 
  SUM(NUM_PEOPLE_PARTY) AS NUMBER_SERVED,  
  SUM(GRAND_TOTAL) / SUM(NUM_PEOPLE_PARTY) AS CASHPERCUSTOMER 
FROM INVOICE_TOTALS 
WHERE [DATETIME] >= '2012-06-01' 
GROUP BY CASHIER_ID, CONVERT(VARCHAR(10),[DATETIME],111) 
```

一切都与代码完美配合，除了：

```
SUM(GRAND_TOTAL) / SUM(NUM_PEOPLE_PARTY) AS CASHPERCUSTOMER 
```

部分。如果我把这条线拿出来，那么一切都很完美，如果我把它放进去，我会收到以下错误：

> 消息：无法检索数据表。
> SELECT CASHIER_ID AS SERVER, ...上面的其余查询...
> 
> 堆栈跟踪：
> ...不相关的堆栈跟踪...
> 
> 消息：**除以零错误。**
> 
> 堆栈跟踪：
> ...无关的堆栈跟踪...

这是使用 SQL Server 的餐厅销售点 (POS) 系统中的 SQL。任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T21:17:30.007

您将需要以这种方式运行查询，并告诉我们是否有任何结果：

```
SELECT CASHIER_ID AS SERVER, 
  CONVERT(VARCHAR(10),[DATETIME],111) AS DATE, 
  SUM(GRAND_TOTAL) AS TOTAL_SALES,  
  SUM(NUM_PEOPLE_PARTY) AS NUMBER_SERVED
FROM INVOICE_TOTALS 
WHERE [DATETIME] >= '2012-06-01' 
GROUP BY CASHIER_ID, CONVERT(VARCHAR(10),[DATETIME],111) 
HAVING SUM(NUM_PEOPLE_PARTY) = 0; 
```

如果有结果，那么显然您的查询需要满足它们。例如：

```
SELECT SERVER, [DATE], TOTAL_SALES, NUMBER_SERVED,
  CASHPERCUSTOMER = TOTAL_SALES / NULLIF(NUMBER_SERVED, 0)
FROM
(
  SELECT CASHIER_ID AS SERVER, 
    CONVERT(VARCHAR(10),[DATETIME],111) AS DATE, 
    SUM(GRAND_TOTAL) AS TOTAL_SALES,  
    SUM(NUM_PEOPLE_PARTY) AS NUMBER_SERVED
  FROM INVOICE_TOTALS 
  WHERE [DATETIME] >= '2012-06-01' 
  GROUP BY CASHIER_ID, CONVERT(VARCHAR(10),[DATETIME],111) 
); 
```

但是你应该弄清楚为什么会有 0 的结果，因为这没有多大意义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T21:16:32.503

除法前检查 0：

```
SELECT
    ...,
    CASE WHEN SUM(NUM_PEOPLE_PARTY) = 0
         THEN NULL
         ELSE SUM(GRAND_TOTAL) / SUM(NUM_PEOPLE_PARTY) END AS CASHPERCUSTOMER,
    ... 
```

或者通过使用获得相同的结果[`NULLIF`](http://dev.mysql.com/doc/refman/5.6/en/control-flow-functions.html#function_nullif)：

```
SELECT
    ...,
    CASE SUM(GRAND_TOTAL) / NULLIF(SUM(NUM_PEOPLE_PARTY), 0) AS CASHPERCUSTOMER,
    ... 
```

# php - 会话不会持续，即使到下一行

> ID：10964628
> 
> 赞同：0
> 
> 时间：2012-06-09T21:14:11.100
> 
> 标签：php, session

我正在开发一个 PHP 登录/注册系统，登录会话是使用......你猜对了......会话完成的。

但是，会话根本*不起作用。*这是一个例子：

```
session_start();
$_SESSION['hi'] == "hi";
echo $_SESSION['hi']; 
```

它什么也不输出。

我的谷歌搜索除了关于`register_globals`. 我的主机[000webhost](http://000webhost.com "000网络主机")是否设置为`off`，这与它有什么关系吗？

好的，刚刚得到答案，我意识到我是多么愚蠢（这是一个错误，我知道）。无需发布更多答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:15:17.890

您需要使用 = 而不是 ==

== 比较，您的比较结果为 false，并且没有任何修改。但是用 = 你设置了新的值。

还有..打开错误！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T21:15:39.347

`=`是赋值运算符，`==`是比较运算符

将 == 更改为 =，您将不再有问题。
您应该只使用 == 来比较两个值以查看语句是真还是假。

# vbscript - 如何使用 VB 脚本将背景窗口模拟为活动状态？

> ID：10964630
> 
> 赞同：-1
> 
> 时间：2012-06-09T21:14:57.787
> 
> 标签：vbscript, window

如何使用 VB 脚本将背景窗口模拟为活动状态？

我需要将一些键码命令发送到某个背景窗口（我知道相关的 VB 函数），但它仅在窗口处于活动状态时才有效。如果窗口真的是活动的，我不能在前台做任何事情。

那么无论如何都要将窗口模拟为活动状态吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:28:25.907

是的，看这个例子

```
Dim oShell
Set oShell = CreateObject("WScript.Shell")
'bring the window to front
'title must be exactly what you see in the titlebar of the window
oShell.AppActivate "title of your window" 
WScript.Sleep 500 'give the window the time to activate, time is in miliseconds
oShell.SendKeys "{ENTER}" 'you can send keystrokes to this window
Set oShell = nothing 
```

如果您想最小化该窗口，您可以发送击键来执行此操作，但这取决于语言，因此请先手动尝试。以下从 miNimize 发送击键 Alt (%) 空格和 N。尝试在您的窗口中按下 Alt-Space 键以获取控制它的菜单

```
oShell.SendKeys "(% )N" 
```

# wcf - 与非 WCF 服务通信的最佳方式

> ID：10964632
> 
> 赞同：0
> 
> 时间：2012-06-09T21:15:27.460
> 
> 标签：wcf, web-services, soap

我有一个需要与之通信的非 WCF 服务。我有服务的 WSDL，它使用 WS-Security 1.0 和 UsernameToken 策略。

标头示例：

```
<S11:Envelope xmlns:S11="..." xmlns:wsse="...">
<S11:Header>
...
<wsse:Security>
 <wsse:UsernameToken>
 <wsse:Username>username</wsse:Username>
 <wsse:Password>password</wsse:Password>
 </wsse:UsernameToken>
</wsse:Security>
...
</S11:Header>
...
</S11:Envelope> 
```

与此服务进行通信的最佳方式是什么？

如果我使用 WCF，使标题看起来像我需要的 UsernameToken 将成为我所知道的问题，对吧？我怎样才能做到这一点？

另一方面，我可以制作一个非 WCF 代理，即使它已经过时了。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:33:42.443

如果服务使用 ssl，那么您可以像这样进行 wcf 配置：

```
<customBinding>
  <binding name="NewBinding0">
    <textMessageEncoding messageVersion="Soap11" />
    <security authenticationMode="UserNameOverTransport">
      <secureConversationBootstrap />
    </security>
    <httpTransport />
  </binding>
</customBinding> 
```

如果服务不使用 ssl，那么您应该使用[ClearUsernameBinding](http://webservices20.blogspot.com/2008/11/introducing-wcf-clearusernamebinding.html)

# node.js - Socket.io 和负载均衡器

> ID：10964636
> 
> 赞同：3
> 
> 时间：2012-06-09T21:16:11.907
> 
> 标签：node.js, websocket, socket.io, load-balancing

我正在使用 Socket.io 和 Node.js，并且在 Stingray 负载均衡器后面有两个实例。

负载均衡器是使用 Generic Streaming 设置的，并且在大多数情况下，似乎工作正常。但是，我注意到一些零星的行为。

基本上，一个人可以连接到两个实例，如果一个实例发射到所有套接字，另一个实例将看不到或得到这些发射。

这听起来准确吗？有谁知道如何确保将任一服务器完成的发射发送到连接到任何服务器的客户端？

谢谢！戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-01T19:47:07.170

[我在开发Mote.io](http://mote.io)时遇到了类似的问题，并决定使用托管解决方案而不是构建负载均衡器。处理这个问题非常困难，因为您需要跨服务器同步数据或将客户端负载平衡到同一个实例，以确保它们获得所有相同的消息。

Socket.io 不会有太大帮助。您需要实现 redis、其他一些数据同步或负载平衡应用程序。

PubNub 也会处理这个问题。后端负责在抽象级别同步消息、负载平衡等，因此您只需提供一个通道名称，PubNub 将确保该通道中的所有客户端都收到消息。

# 10 行代码中的实时聊天应用程序

![在此处输入图像描述](../Images/f27c18503912448f572a5c99799b8ba9.png)

```
Enter Chat and press enter
<div><input id=input placeholder=you-chat-here /></div>

Chat Output
<div id=box></div>

<script src=http://cdn.pubnub.com/pubnub.min.js></script>
<script>(function(){
var box = PUBNUB.$('box'), input = PUBNUB.$('input'), channel = 'chat';
PUBNUB.subscribe({
    channel  : channel,
    callback : function(text) { box.innerHTML = (''+text).replace( /[<>]/g, '' ) + '<br>' + box.innerHTML }
});
PUBNUB.bind( 'keyup', input, function(e) {
    (e.keyCode || e.charCode) === 13 && PUBNUB.publish({
        channel : channel, message : input.value, x : (input.value='')
    })
} )
})()</script> 
```

# c++ - 从文件读取磁盘部分错误

> ID：10964638
> 
> 赞同：0
> 
> 时间：2012-06-09T21:16:26.870
> 
> 标签：c++, c, winapi

我有以下代码可以正常工作到 DskPrt1.txt 的最后一行`assign letter=`。该文件按应有的方式写入。在下拉列表中，我选择一个驱动器号，将所选的字母发送到`FILE fp`，将其写出来，然后指示 diskpart 读取它。这是输出

> 第 1 卷是选定的卷
> 
> 为该命令指定的参数无效。

这告诉我它正在做所有事情，直到 DskPrt.txt 中的第二行。我已经`assign letter=X`手动复制并粘贴到 diskpart 中，它运行得很好。为什么它不适用于我的代码？

第1部分

```
SendMessage( 
(HWND) hWndDropMenu,    // handle to destination window 
CB_GETLBTEXT,           // message to send
(WPARAM) wParam,        // not used; must be zero
(LPARAM)tmpMsg          // not used; must be zero
); 
```

第2部分

```
FILE *fp;
fp = fopen("DskPrt1.txt", "wt");
char DskPrt11[] = "select volume 1";
char DskPrt12[] = "assign letter=";
fwrite (DskPrt11 , 1 , sizeof(DskPrt11) , fp );         //Line 1
fwrite("\n", sizeof(char), 1, fp);                      //New line
fwrite (DskPrt12 , 1 , sizeof(DskPrt12) , fp );         //Line 2
fwrite (tmpMsg , 1 , sizeof(tmpMsg) , fp );             //Letter
fclose(fp);

//Execute part 1 commands
std::wstring arrString[3] = {L"/C mkdir C:\\Users\\Andrew\\Desktop\\test",L"/C DISKPART /s C:\\Users\\Andrew\\Desktop\\DskPrt1.txt"};
LPWSTR cmd =L"C:\\Windows\\System32\\cmd.exe";
for(int i=0; i<2; i++)
{
    STARTUPINFO info={sizeof(info)};
    PROCESS_INFORMATION processInfo;
    CreateProcessW(cmd, &arrString[i][0], NULL, NULL, TRUE, CREATE_NO_WINDOW, NULL, NULL, &info, &processInfo);
    ::WaitForSingleObject(processInfo.hProcess, INFINITE);
    CloseHandle(processInfo.hProcess);
    CloseHandle(processInfo.hThread);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T20:20:06.240

因为这：

```
fwrite (DskPrt11 , 1 , sizeof(DskPrt11) , fp ); 
```

通过使用 sizeof()，您将包含终止空值。因此，您的文件最终会包含至少两个您不想要的空字节。请改用 strlen()。

# android - 如何将 SMS 和 MMS 排序在一起？

> ID：10964647
> 
> 赞同：4
> 
> 时间：2012-06-09T21:17:26.403
> 
> 标签：android, sms, mms

我正在实现这里讨论的方法：[如何在 Android 中读取彩信数据？](https://stackoverflow.com/questions/3012287/how-to-read-mms-data-in-android)

我正在尝试将 SMS 和 MMS 读入单个列表视图。我做得很好，但是当我尝试排序时，我将所有 SMS 排序在一起，然后将所有 MMS 排序在一起。

这是我的代码：

```
Cursor smsCursor = getContentResolver().query(Uri.parse("content://mms-sms/conversations/"), null, null, null, "date DESC"); 
```

谁能告诉我如何结合这两个来源或如何将 MMS 结合到 SMS 对话中，就像内置的 Android 应用程序一样？

编辑：我注意到短信的日期比彩信的日期多几个数字。

编辑2：像这样添加“julianday（）”：

```
Cursor smsCursor = getContentResolver().query(Uri.parse("content://mms-sms/conversations/"), null, null, null, "julianday(date) DESC"); 
```

使彩信显示在列表顶部。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-08T15:52:41.270

尝试`normalized_date desc`代替`date desc`订单。

它应该工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-01T09:40:28.340

这里真正的问题似乎是在数据库中，日期的存储方式与 SMS 和 MMS 的存储方式不同。

因此，您需要首先查询数据库以查找“日期”字段。（不是 normalized_date 会在某些设备上崩溃）。

然后在 Java 中以编程方式对您的列表进行排序，考虑到对于 MMS，日期需要乘以 1000，如下所述： [如何从 content://mms 中检索 mms 的日期。](https://stackoverflow.com/questions/21460486/how-do-the-retrieve-the-date-of-the-mms-from-content-mms)* 或者这里的 [mms 发送/接收日期始终是 1970](https://stackoverflow.com/questions/5562025/mms-sent-recive-date-is-always-in-1970)

# javascript - jQuery将页脚粘贴到页面底部

> ID：10964662
> 
> 赞同：0
> 
> 时间：2012-06-09T21:19:44.540
> 
> 标签：javascript, jquery, css

我花了很长时间尝试使用 CSS 将页脚粘贴到页面底部，并且几乎放弃了。

如果视口的高度小于 HTML 文档的高度，我想要的是页脚没有分配额外的 CSS 属性。

如果文档高度小于窗口高度，我希望将以下 CSS 分配给 div#thefooter：

```
position: fixed;
bottom: 0px;
margin-left: -5px; 
```

所以这是我的JS代码。它什么也不做，控制台日志什么也不显示。

```
$(document).ready(function(){

  $(window).bind("load", function(){ putFooter(); });
  $(window).resize(function(){ putFooter(); });

  function putFooter(){
    var wh = $(window).height();
    var dh = $(document).height();
    if(dh < wh) {
      $("#thefooter").css({"position": "fixed", "bottom": "0px", "margin-left": "-5px"});
      }
    }

}); 
```

编辑：这是我的 HTML 的样子：

```
<div id="allexceptfooter">
  <div id="themenu">...</div>
  <div id="actualcontent">...</div>
</div>
<div id="thefooter">...</div> 
```

如果您想查看全部内容，我的网站是 duncannz .com

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T21:22:37.157

看看这个，根本不需要javascript...

[http://www.cssstickyfooter.com](http://www.cssstickyfooter.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T02:29:05.370

好的，我知道了。不使用 CSS - 我已经花了很长时间尝试使用它。

但我有 jQuery 工作。问题是`$(document).height();`返回视口的高度，因为我`body{ height: 100%; }`在我的 CSS 中使用。答案是使用这个 HTML：

```
<body>
<div id="everything">
...
</div>
</body> 
```

并使用`$("#everything").height();`而不是`$(document).height();`. 不幸的是，仍然需要 JS，但总比没有好。没有 CSS 解决方案对我有用。

再次编辑：这是再次更新的代码：

```
$(document).ready(function(){

  function putFooter(){
    var wh = $(window).height();
    var dh = $("#everything").height();
    if(dh < wh - 104) { /*104: #thefooter height in px*/
      $("#thefooter").addClass("footerissticky");
      }
    else {
      $("#thefooter").removeClass("footerissticky");
      }
    }

  putFooter();
  $(window).bind("load", function(){ putFooter(); });
  $(window).resize(function(){ putFooter(); });

}); 
```

和CSS：

```
.footerissticky{
  position: fixed;
  bottom: 0px;
  width: 870px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T21:23:39.607

您可以使用这种技术完全避免使用 Javascript：

[http://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-18T20:40:24.717

JQuery 添加了*data-position="fixed"*来解决这个问题。已回答 - [jQuery Mobile：将页脚粘贴到页面底部](https://stackoverflow.com/questions/6861764/)

# .htaccess - 是否可以从 .htaccess 中调用 Coldfusion cfc 方法？

> ID：10964664
> 
> 赞同：0
> 
> 时间：2012-06-09T21:19:49.050
> 
> 标签：.htaccess, methods, coldfusion, cfc

我正在调用 htaccess 格式的 cfm 文件来对图像执行一些操作，如下所示：

```
<IfModule mod_rewrite.c>
    Options +FollowSymlinks
    RewriteEngine On
    ...
    RewriteRule   \.(jpg|jpeg|gif|png) services/adaptive-images.cfm
</IfModule> 
```

在 cfm 文件中，我正在调整图像的大小。

**问题：**
这也可以通过调用 cfc 文件中的方法来实现吗？像这样的东西：

```
 RewriteRule   \.(jpg|jpeg|gif|png) services/ai.cfc?method=resize 
```

有没有办法使这项工作？

感谢您提供任何信息！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T11:43:20.340

您提出的问题可以归结为几个组成部分：

1.  可以通过 HTTP 调用 CFC 方法吗？
2.  重写规则可以发出 HTTP 请求吗？

显然，第二个答案是“是”。而且 - 正如您似乎已经知道的那样 - 第一个答案也是“是”。您在 RewriteRule 中演示了此语法。

这里需要考虑的是 CF 只是从 Web 服务器接收请求以完成 HTTP 请求。CF 不知道（或关心）请求是否可以直接从 Web 服务器直接通过，或者它是否首先由重写模块重写。

所以...如果您遇到错误，那是另外一回事。从 Web 服务器/重写模块/CF 的角度来看，您尝试做的事情是完全可能的。

我建议您查看日志并查看导致 500 错误的原因。实际上，如果您启用了强大的异常处理，您应该会在屏幕上显示错误的原因。

如果你直接通过浏览器地址栏调用你正在重写的 URL 会发生什么？

# jquery - colorbox div不会显示

> ID：10964665
> 
> 赞同：3
> 
> 时间：2012-06-09T21:19:56.607
> 
> 标签：jquery, ajax, colorbox

我正在尝试在单击时在颜色框中显示隐藏的 div

我不知道如何在颜色框中显示 div

div 是隐藏的，但我希望它在明显地显示在颜色框内时可见

```
<div class="test">test</div> // on click

<div id="messageform" style="display: none;"> // show this in colorbox
TEST
</div>    

$('.test').click(function(){
$.colorbox({inline:true, width:"50%", open:true, href:"#messageform" }); 
}); 
```

这仅在表单消息表单未隐藏时才有效，但如何在颜色框中单击时显示？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T21:25:15.907

您可以将`messageform`具有的 div 包装在内部，也`display:none`可以将其设置为在单击时显示：

```
$('.test').click(function(){
  $('#messageform').show();
  $.colorbox({inline:true, width:"50%", open:true, href:"#messageform" }); 
}); 
```

这是一个带有设置为不显示的容器的演示：http: [//jsfiddle.net/fbenariac/4vuDC/](http://jsfiddle.net/fbenariac/4vuDC/)

您也可以使用颜色框事件来显示/隐藏：http: [//jsfiddle.net/lucuma/LK4tt/1/](http://jsfiddle.net/lucuma/LK4tt/1/)

```
$('.test').click(function(){

$.colorbox({inline:true, width:"50%", open:true, href:"#messageform",
            onClosed: function() {
                 $('#messageform').hide();
            },
            onOpen: function() {
                 $('#messageform').show();
            }
           }); 
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-21T10:35:30.237

1.  为您希望在弹出窗口中看到的基本 div 制作叠加层。
2.  添加样式以覆盖显示：无
3.  然后调用你的js。JS会在popupoverlay中弹出内容...

HTML

```
 <a id="openpopup" href="popup" class="button">Details</a>

    <div class="popupoverlay" style="display:none">
        <div id="popup">
         some content...
        </div>
    </div> 
```

JS

```
 $("#openpopup").colorbox({
        inline:true, 
        href: "#popup",
        width:666,
    }); 
```

# javascript - Ext JS - 如何滚动到 Textarea 的底部

> ID：10964667
> 
> 赞同：3
> 
> 时间：2012-06-09T21:20:27.453
> 
> 标签：javascript, extjs, extjs3

这是我下面的代码。如何滚动到文本区域的底部？它一定是这样的

```
Ext.getCmp('output').setScrollPosition(Ext.getCmp('output').getScrollHeight()); 
```

这是我的文本区域代码：

```
var myWin= new Ext.Window({
            height        :    340,
            title        :    'CHAT',
            modal        :    true,
            resizable    :    false,
            draggable    :    false,
            closable     :    false,
            width        :    477,
            layout       : 'absolute',
            bodyStyle    :    'padding : 10px',
            buttonAlign  : 'center',
            items        :    [
            {
                id           :    'output',
                xtype        :    'textarea',
                width        :    216,
                readOnly     :    true,
                autoScroll   :    true,
                height       :    234,
                x            :    10,
                y            :    10
            },
            item6,
            {
                id       :    'input',
                xtype    :    'textfield',
                width    :    443,
                y        :    249,
                x        :    10
            }] 
```

...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-10T12:00:52.163

我认为没有 ExtJs 方法可以滚动 textarea，但是您可以使用 HTML textarea 属性：

```
var t = Ext.getCmp('output'),
   t1 = t.getEl().down('textarea');
t1.dom.scrollTop = 99999; 
```

这是讨论的问题：[Dynamically Scrolling a Textarea](https://stackoverflow.com/questions/642353/dynamically-scrolling-a-textarea)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-08T11:09:25.557

```
var d = Ext.getCmp('output').getEl().down('textarea').dom;
d.scrollTop = d.scrollHeight - d.offsetHeight; 
```

# java - 使用 KAON2 Reasoner 打开本体

> ID：10964668
> 
> 赞同：0
> 
> 时间：2012-06-09T21:20:42.817
> 
> 标签：java, ontology

我有一个 KAON2 Reasoner，我想用它打开一个本体。这怎么可能？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T00:20:04.793

请参阅`Example01.java`分发中包含的内容：

```
public static void main(String[] args) throws Exception {
    OntologyManager ontologyManager=KAON2Manager.newOntologyManager();
    DefaultOntologyResolver resolver=new DefaultOntologyResolver();
    resolver.registerReplacement("http://kaon2.semanticweb.org/example01","file:src/ex01/example01.xml");
    ontologyManager.setOntologyResolver(resolver);
    Ontology ontology=ontologyManager.openOntology("http://kaon2.semanticweb.org/example01",new HashMap<String,Object>());
    ...
} 
```

其中第一行和最后一行是重要部分；第 2-4 行只是告诉`ontologyManager`从本地文件加载。

**编辑：如此**[处](http://www.neon-toolkit.org/pipermail/plugin-developers/2009-July/000256.html)所述，它不适用于较新的 java 版本。我用 JDK 1.6.12 对其进行了测试，结果很好。

# maven - 使用 Maven Shade 插件创建可执行 JAR

> ID：10964670
> 
> 赞同：3
> 
> 时间：2012-06-09T21:20:50.057
> 
> 标签：maven, maven-3, maven-assembly-plugin, maven-shade-plugin

我无法从一个简单的 Java 程序制作一个可执行的 jar。

我遵循[这些 Maven 说明](http://maven.apache.org/plugins/maven-shade-plugin/examples/executable-jar.html)并修改了我的`pom.xml`：

```
<plugins>
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-shade-plugin</artifactId>
    <version>1.7</version>
    <executions>
      <execution>
        <phase>package</phase>
        <goals>
          <goal>shade</goal>
        </goals>
        <configuration>
          <transformers>
            <transformer implementation= 
           "org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
              <mainClass>package.MyClass</mainClass>
            </transformer>
          </transformers>
        </configuration>
      </execution>
    </executions>
  </plugin>
</plugins> 
```

执行`install`目标时，我可以阅读以下行：

```
[INFO] Replacing /home/project-1.0.0.jar with /home/project-1.0.0-shaded.jar 
```

但是我在那个位置能找到的只是`project-1.0.0.jar`，实际上包含依赖项 - 并且具有正确的大小 - 但是当尝试用我的 jre 执行它时，它说：

```
The file '/home/project-1.0.0.jar' is not marked as executable. 
```

因此没有任何执行！

如何让我的 jar 正确执行？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-01T13:11:26.013

> 给定的是**pom.xml**来创建一个可执行的 jar 文件

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>org.executablejar</groupId>
<artifactId>demo</artifactId>
<packaging>jar</packaging>
<version>0.0.1-SNAPSHOT</version>
<name>demo Maven Webapp</name>
<url>http://maven.apache.org</url>

<properties>
    <java-version>1.8</java-version>
    <docker.image.prefix>springDemo</docker.image.prefix>
</properties>

<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>1.3.3.RELEASE</version>
</parent>

<dependencies>

    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>

    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-tomcat</artifactId>
    </dependency>

    <dependency>
        <groupId>org.apache.tomcat.embed</groupId>
        <artifactId>tomcat-embed-jasper</artifactId>
    </dependency>

</dependencies>

<build>
    <plugins>
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
        </plugin>
    </plugins>
    <finalName>demo</finalName>
</build> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-06-11T05:53:31.197

我有一个使用程序集插件的简单解决方案。此解决方案将制作一个 jar (target/${project.groupdId}-${project.artifactId}-${project.version}.jar)：

*   包含所有必需的依赖项
*   这是可执行的（通过 java -jar *.jar）

在你的 pom 文件中声明：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>

            <configuration>
                <appendAssemblyId>false</appendAssemblyId>

                <archive>
                    <manifest>
                        <mainClass>package.MyClass</mainClass>
                    </manifest>
                </archive>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
            </configuration>

            <executions>
                <execution>
                    <id>make-executable-jar</id>
                    <phase>package</phase>
                    <goals>
                        <goal>single</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

我希望我对你有帮助！干杯！

# c# - c# winforms - 子窗体上的不可访问控件

> ID：10964672
> 
> 赞同：1
> 
> 时间：2012-06-09T21:21:26.470
> 
> 标签：c#, winforms

关于twoForms的永恒问题：

```
frm02 frm02 = new frm02();
frm02.Text = "Objects";
ds02 = new DataSet();
ds02.ReadXml(path02);
frm02.dgv02.DataSource = ds02.Tables[0];  //error: dgv02 is inaccessible...
frm02.ShowDialog(); 
```

请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T21:22:45.173

你需要`dgv02` *公开*。默认情况下，当您通过设计器添加类型时，它们是不公开的。您可以在设计窗口中编辑它们的属性，并将可访问性级别更改为公共。

话虽如此，更好的选择可能是创建一个返回适当控件的公共属性，或者更好的是，允许您设置数据。例如，如果您将此方法添加到表单中：

```
public void SetDatasource(DataSet data)
{
     this.dgv02.DataSource = data;
} 
```

然后，您可以将其称为：

```
frm02.SetDatasource(ds02); 
```

# jquery - jQuery - 在垂直滚动文档中查找窗口顶部的 y 位置

> ID：10964673
> 
> 赞同：1
> 
> 时间：2012-06-09T21:21:27.643
> 
> 标签：jquery, offset

我有一个非常高并且垂直滚动的文档。我想在某个时间检测与完整文档相关的可见区域。

因此，如果`$('body').height()`是 6000 并且当我的函数触发时，它们会滚动 2/3，我希望能够取回数字`4000`。

我知道这很简单，我就是想不通。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T21:27:36.953

`$('body').scrollTop()`

> 垂直滚动位置与在可滚动区域上方的视图中隐藏的像素数相同。如果滚动条位于最顶部，或者元素不可滚动，则此数字将为 0。

从[.scrollTop()](http://api.jquery.com/scrollTop/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-19T06:55:36.047

I'd use `$(window).scrollTop()` instead of $('body').scrollTop().

Some browsers don't behave properly when 'body' is utilized, but using 'window' I never had such problems

# r - 如何将R中的向量组合成数据框？

> ID：10964675
> 
> 赞同：2
> 
> 时间：2012-06-09T21:21:29.253
> 
> 标签：r, dataframe

有没有更优雅的方法来做到这一点？a 和 b 并行运行，c 和 d 形成笛卡尔积

```
a <- c("a","b","c")
b <- c("A","B","C")
c <- c(1,2,3)
d <- c(11,22)
nrow_cd <- length(c)*length(d)
nrow_abcd <- length(a)*nrow_cd
abcd <- data.frame(
    a=rep(a, each=nrow_cd),
    b=rep(b, each=nrow_cd),
    c=rep(c, each=length(d)),
    d=rep(d, times=nrow_abcd)
)    

abcd
   a b c  d
1  a A 1 11
2  a A 1 22
3  a A 2 11
4  a A 2 22
5  a A 3 11
6  a A 3 22
7  b B 1 11
8  b B 1 22
9  b B 2 11
10 b B 2 22
11 b B 3 11
12 b B 3 22
13 c C 1 11
14 c C 1 22
15 c C 2 11
16 c C 2 22
17 c C 3 11
18 c C 3 22
19 a A 1 11
20 a A 1 22
21 a A 2 11
22 a A 2 22
23 a A 3 11
24 a A 3 22
25 b B 1 11
26 b B 1 22
27 b B 2 11
28 b B 2 22
29 b B 3 11
30 b B 3 22
31 c C 1 11
32 c C 1 22
33 c C 2 11
34 c C 2 22
35 c C 3 11
36 c C 3 22 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T21:42:16.133

你可以这样做：

```
bcd  <- rev(expand.grid(list(d=d,c=c,b=b)))
abcd <- data.frame(a = a[match(bcd$b, b)], bcd) 
```

它为您提供 18 行，即`length(b)*length(c)*length(d)`. 我不确定您是否打算在示例中重复。如果是这种情况，只需添加：

```
abcd <- rbind(abcd, abcd) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:42:54.977

你的意思是故意加倍你的数据框吗？第 1:18 行与第 19:36 行相同...

这是一个解决方案

```
a <- c("a","b","c")
b <- c("A","B","C")
c <- c(1,2,3)
d <- c(11,22)
nrow_cd <- length(c)*length(d)

ab <- sapply(list(a,b), rep, each=nrow_cd)
cd <- expand.grid(c,d)
out <- cbind(ab, cd[rep(rownames(cd),length=nrow(ab)),])
rownames(out) <- 1:nrow(out)
names(out ) <- letters[1:4]
out 
```

# php - 警告：pg_query() [function.pg-query]：查询失败：错误：未终止的带引号的字符串在或附近

> ID：10964678
> 
> 赞同：1
> 
> 时间：2012-06-09T21:21:55.993
> 
> 标签：php, postgresql

我有一个查询，我收到错误：

代码是：

```
$prefix = $data->sheets[0]['cells'][$row][2];
$fiyat = $data->sheets[0]['cells'][$row][3];
$increment = $data->sheets[0]['cells'][$row][4];
$tarih = $data->sheets[0]['cells'][$row][5];
$tarih = explode('.',$tarih);
$effective_date = $tarih[2] . "-" . $tarih[1] . "-" . $tarih[0]; 
```

所有变量都返回正确的值（和变量类型）。

```
$query_insert_to_rates = "INSERT INTO rates VALUES (nextval('routes_seq'), '$prefix', '$i_tariff', '$fiyat_orj', '$fiyat_orj', '$increment', '$increment', '$forbidden', 't', '0', '0', '$increment', '$increment', NULL, '$eff_date_ins', NULL);"; 
```

$result_insert_to_rates = pg_query($query_insert_to_rates);

```
INSERT INTO rates VALUES (nextval('routes_seq'), '21321', '8', '0.0470', '0.0470', '1', '1', 't', 't', '0', '0', '1', '1', NULL, '2012-06-01 00:00:00.000001+02', NULL); 
```

> 警告：pg_query() [function.pg-query]：查询失败：错误：在字符 50 处或附近的“'2”处或附近未终止的引号字符串.....

现在，当我在 PHP 中运行查询时，出现上述错误。我的 PHP 版本是 5.3.10。机器是Centos 5（VPS）。

但是，如果我通过 Navicat（连接到数据库）运行查询，那么我没有错误，并且查询执行得很好。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T07:02:02.227

这是可怕的代码：不安全和不安全。永远不要使用这种模式

```
$SQL = "INSERT ... ('$var1', '$var2') 
```

改用 PDO 参数化查询或 pg_escape_string 函数

[pg_escape_string](https://stackoverflow.com/questions/7266090/whats-does-pg-escape-string-exactly-do)

# php - 查找 img 是否有“alt”，如果没有，则从数组中添加（服务器端）

> ID：10964679
> 
> 赞同：0
> 
> 时间：2012-06-09T21:21:56.647
> 
> 标签：php, javascript, seo

首先我需要找到站点中的所有img，然后检查img是否具有“alt”属性，如果图像具有该属性，它将被转义，如果没有或alt为空，则字符串将是从列表或数组中随机添加到 img。

这里是你如何使用 javascript： [查找 img 是否在 jquery 中有 alt，如果没有，则从数组中添加](https://stackoverflow.com/questions/10735820/find-if-a-img-have-alt-in-jquery-if-not-then-add-from-array)

但它并没有帮助我，因为根据这个： [搜索引擎如何抓取 Javascript？](https://stackoverflow.com/questions/10963912/how-do-search-engines-crawl-javascript)

> 搜索机器人无法读取它，如果您使用 JavaScript，则需要使用服务器端语言将关键字添加到 img alt。

接下来是什么？php? 我可以用一个简单的代码来做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:25:38.030

好吧，将它导入到一个`DOMDocument`对象中并找到其中的所有图像。

似乎比较琐碎。查看**[`DOMDocument`课程](http://il.php.net/manual/en/class.domdocument.php)**

* * *

这是我的问题代码：

```
<?php

$html = <<<HTML
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title></title>
</head>
<body>

  <p>
  <img src="test.png">
  <img src="test.jpg" alt="Testing">
  <img src="test.gif">
  </p>

</body>
</html>
HTML;

$dom = new DOMDocument();
$dom->loadHTML($html);

$images = $dom->getElementsByTagName("img");
foreach ($images as $image) {
    if (!$image->hasAttribute("alt")) {
        $altAttribute = $dom->createAttribute("alt");
        $altAttribute->value = "Ready Value!";
        $image->appendChild($altAttribute);
    }
}
echo $dom->saveHTML(); 
```

# vim - 在 Vim 中启用降价高亮

> ID：10964681
> 
> 赞同：143
> 
> 时间：2012-06-09T21:22:14.290
> 
> 标签：vim, markdown

我在装有 OS X Lion 的 MacBook Air 上的终端中使用 Vim，但我似乎找不到用于 Markdown 语法突出显示的好插件。

到目前为止，我已经尝试过[plasticboy](https://github.com/plasticboy/vim-markdown/)插件和[Tim Pope 的插件](https://github.com/tpope/vim-markdown)。塑料男孩插件工作正常，但导致行尾的空白被突出显示，我还没有弄清楚如何关闭它。（这真的很烦人，因为每次`space`我在写作时都会突出显示角色。）

除了可能使用`###`. 代码块和项目符号被忽略。我可能会在那里遗漏一些东西。我确实`.md`在我的 Markdown 文件上使用了扩展名，所以它应该选择文件类型。

我还看到了对内置 Markdown 支持的 Vim 7.3 的引用，但是如果没有这两个插件中的一个，我根本没有任何突出显示。

这些中的任何一个都需要特定的配色方案才能工作吗？

* * *

## 回答 #1

> 赞同：313
> 
> 时间：2013-02-08T18:28:26.187

关于 markdown 的本机语法高亮，我认为它仅适用于`.markdown`默认具有扩展名的文件。
我的`.md`文件的降价语法突出显示有问题。
我试过了：

```
:set syntax=markdown 
```

它奏效了。所以我在我的中加入了以下行`.vimrc`：

```
au BufNewFile,BufFilePre,BufRead *.md set filetype=markdown 
```

现在我的 vim 有我的`.md`文件的语法高亮。

[:sav 需要](https://stackoverflow.com/a/27084243/588759)BufFilePre

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-09T21:51:35.113

这应该可以在使用 plasticboy mkd 插件时禁用行尾空格突出显示：

```
:syn clear mkdLineBreak 
```

您可以`autocmd`为必要的文件扩展名这样做，这样您就不必每次加载降价文件时都这样做。

**请注意**，之所以存在此特定突出显示，是因为 Markdown 通过插入 a 来特别处理以 2 个或更多空格字符结尾的行`<br>`，因此它很有用。

Plasticboy 插件`TODO`为此规则使用突出显示，这**有点**过分了，因为它的设计默认是非常花哨的 - 黄色背景 - 以便它脱颖而出。您可以通过更改该`highlight`规则来降低视觉冲击力。一种快速的方法是：

```
:hi link mkdLineBreak Underlined 
```

现在这些行尾空格将显示为下划线。尝试链接到其他`highlight`组以获取可能更吸引您的内容。除了使用`link`您还可以更具体地了解这些行尾空格：例如，您可以使用您自己的`highlight`命令指定自定义*ctermfg*、*ctermbg*、*guifg*来指定它们显示为比正常背景稍微亮/暗, *guibg*设置。

如上所述，您可以`autocmd`应用您的特定设置。

有关链接`highlight`组的更多信息，请键入：`:help group-name`，您将看到可以链接的组列表，这些组本身应该使用当前`highlight`规则进行显示。还有：`:help highlight`。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2015-05-08T00:23:52.280

# 原生语法高亮

Markdown 的本机语法突出显示默认情况下仅适用于`.markdown`文件扩展名。

以下行对和`.vimrc`均产生最佳结果：`vim``gvim`

```
autocmd BufNewFile,BufFilePre,BufRead *.md set filetype=markdown.pandoc 
```

解释：

## 1\. 指定你的 Markdown 风格！

如果您主要使用一种 Markdown 风格（例如[Pandoc](http://johnmacfarlane.net/pandoc/README.html)），请务必同时提及这一点！这样做，允许混合和匹配 Markdown 和 Pandoc 特定的 Vim 插件。例如：我发现[vim-pandoc-syntax](https://github.com/vim-pandoc/vim-pandoc-syntax)插件特别适合我的高亮需求。不过，我使用更通用的[vim-markdown-folding](https://github.com/nelstrom/vim-markdown-folding)进行 Markdown 折叠。

顺便说一句，只允许一种口味，用点分隔，例如：`filetype=markdown.pandoc`

## 2.`gvim`要求`BufFilePre`

`gvim`需要[`BufFilePre`](http://vimdoc.sourceforge.net/htmldoc/autocmd.html#BufFilePre)在自动命令行中使用该命令进行 Markdown 文件类型识别的附加功能`Save As… :sav`。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-02-02T20:45:46.073

在[Tim 的插件](https://github.com/tpope/vim-markdown)中，**.md**扩展名仅适用于**README.md** ，因为**filetype.vim**指定了。

```
" Markdown
au BufNewFile,BufRead *.markdown,*.mdown,*.mkd,*.mkdn,README.md  setf markdown 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-05-05T08:42:07.480

如果您不喜欢将所有配置放入 中，您可以使用以下内容`~/.vimrc`创建（或 Windows 上的等效项）。`~/.vim/ftdetect/markdown.md`

`au BufNewFile,BufRead *.md setf markdown`

# java - 尝试上传文件时使用 gdata docs java 库时抛出 NullPointerException

> ID：10964689
> 
> 赞同：-2
> 
> 时间：2012-06-09T21:24:01.710
> 
> 标签：java, nullpointerexception, google-api, gdata-api

基本上我得到了这个错误......

```
java.lang.NullPointerException: Null response body
com.google.gdata.util.ServiceException.setResponse(ServiceException.java:222)
    at com.google.gdata.client.http.GoogleGDataRequest.handleErrorResponse(GoogleGDataRequest.java:572)
    at com.google.gdata.client.http.HttpGDataRequest.checkResponse(HttpGDataRequest.java:560)
    at com.google.gdata.client.http.HttpGDataRequest.execute(HttpGDataRequest.java:538)
    at com.google.gdata.client.http.GoogleGDataRequest.execute(GoogleGDataRequest.java:536)
    at com.google.gdata.client.media.MediaService.insert(MediaService.java:400) 
```

我正在使用该`gdocs-3.0`库，它似乎在运行时都可以正常工作，除了在执行文件上传时失败。我正在使用 OAuth2 凭据系统，这可能是问题的原因吗？是因为我上传的是 mp3 之类的内容而不是文档吗？

是否有更好的库来访问文档列表 api 或者是这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T07:05:18.710

原来我得到这个的原因是我的应用程序不想上传大文档，而是需要使用可恢复的媒体上传。

# iphone - 如何在 SBJson 中解析某些数组

> ID：10964690
> 
> 赞同：0
> 
> 时间：2012-06-09T21:24:03.553
> 
> 标签：iphone, arrays, json, parsing, sbjson

嗨，我这里有这段代码

```
 - (void)viewDidLoad
{
    [super viewDidLoad];

    jsonURL = [NSURL URLWithString:@"http://oo.mu/json.php"];
    jsonData = [[NSString alloc] initWithContentsOfURL:jsonURL usedEncoding:nil error:nil];
    self.jsonArray = [jsonData JSONValue];

    SBJsonParser *parser = [[SBJsonParser alloc] init];
    NSDictionary *jsonObject = [parser objectWithString:jsonData error:NULL];
    NSArray *list = [jsonObject objectForKey:@"Dewan's Party"];
    for (NSDictionary *lesson in list)
    {
        // 3 ...that contains a string for the key "stunde"
        NSString *content = [lesson objectForKey:@"Street"];
        NSLog(@"%@", content);
    }

    // Do any additional setup after loading the view, typically from a nib.
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [jsonArray count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = (UITableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }

    return cell;
} 
```

我正在使用这个 JSon.php 文件。

```
{"Steffan's Party":{"Street":"774 Hoodwinked Avenue","City":"Sacramento","State":"California"},"Dewan's Party":{"Street":"2134 Statewide Lane","City":"New York","State":"New York"},"Austin's Party":{"Street":"9090 Gravink Court","City":"Woodland","State":"California"}} 
```

这是网站[http://oo.mu/json.php](http://oo.mu/json.php)的链接。

我在这里要做的是解析它自己的 UITableView 单元格中的每个数组。下面的示例，我该怎么做？

表格单元格 1：Steffan 的派对 774 Hoodwinked Ave Sacramento, California

表格单元格 2：Dewan 的派对 2134 Statewide Lane New York, New York

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:07:57.717

要从当前 json 中获取所有键和值，请在 viewDidLoad 中执行以下操作

```
NSString *yourJson = @"{\"Steffan's Party\":{\"Street\":\"774 Hoodwinked Avenue\",\"City\":\"Sacramento\",\"State\":\"California\"},\"Dewan's Party\":{\"Street\":\"2134 Statewide Lane\",\"City\":\"New York\",\"State\":\"New York\"},\"Austin's Party\":{\"Street\":\"9090 Gravink Court\",\"City\":\"Woodland\",\"State\":\"California\"}}";
SBJSON *json = [[SBJSON alloc] init];

NSDictionary *dic = [json objectWithString:yourJson error:NULL];

//NSMutableArray * keys; is defined in your interface .h file
//NSMutableArray * values; is defined in your interface .h file
keys = [[NSMutableArray alloc] init];
values = [[NSMutableArray alloc] init];    
for(NSString *key in dic.keyEnumerator)
{
    [keys addObject:key];
    [values addObject:[dic objectForKey:key]];
} 
```

现在你`cellForRowAtIndexPath`看起来像这样

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = (UITableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }
    //Steffan's Party 774 Hoodwinked Ave Sacramento, California
    NSString *partyName = [keys objectAtIndex:indexPath.row];
    NSDictionary *dicValues = [values objectAtIndex:indexPath.row];

    NSString *Street = [dicValues objectForKey:"Street"];
    NSString *City = [dicValues objectForKey:"City"];
    NSString *State = [dicValues objectForKey:"State"];

    //Steffan's Party 774 Hoodwinked Ave Sacramento, California
    NSString *fullString = [NSString stringWithFormat:@"%@ %@ %@ %@", partyName, Street, City, State];
    return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T21:51:13.160

你为什么用`SBJsonParser`？仅使用更容易`-JSONValue`！看：

```
NSDictionary *jsonDict = [jsonData JSONValue];
// you can declare it as ivar 
```

那么，在`-tableView:cellForRowAtIndexPath:`

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = (UITableViewCell *) [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];

    // that's how you can get key by index
    NSString *key = [[jsonDict allKeys] objectAtIndex:indexPath.row];

    NSDictionary *party = [jsonDict objectForKey:key];
    NSString *street = [party valueForKey:@"Street"];
    NSString *city = [party valueForKey:@"City"];
    NSString *state = [party valueForKey:@"State"];

    cell.textLabel.text = [NSString stringWithFormat:@"%@ %@ %@, %@", key, street, city, state];

    return cell;
} 
```

# python - 如何在 Mac OSX 上安装 Python 包/wxPython？

> ID：10964691
> 
> 赞同：1
> 
> 时间：2012-06-09T21:24:15.850
> 
> 标签：python, module, wxpython

我对 python 和任何非基本的计算机功能都很陌生，但我遇到了一个非常基本的问题，我不知道如何解决它。每当我从 Internet 下载一个模块并尝试在 python 中导入它时，我都会收到一条错误消息。例如，在我一直在使用的 Python 教程程序上被指示下载 wxPython 后，我刚刚下载了 wxPython，输入“import wx”后，我得到了：

```
Traceback (most recent call last):
  File "<pyshell#4>", line 1, in <module>
    import wx
ImportError: No module named wx 
```

我该如何解决这个问题，以便 python 可以找到我下载的模块？谢谢！！

Python 2.7.3 版本，我从网站上的下载链接下载了 wxPython。我注意到的另一件事：每当我在终端中输入 python setup.py install 时，我都会得到：

```
/Library/Frameworks/Python.framework/Versions/2.7/Resources/Python.app/Contents/MacOS/Python
can't open file 'setup.py': [Errno 2] No such file or directory 
```

这似乎是另一个大问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T21:39:40.213

您需要做一些事情来实际调试它：

1.  运行 python 并检查您正在运行的版本。
2.  键入`where python`并确定您是否同时运行多个版本的 python。
3.  使用`pip`or `easy_install`，阅读输出以检查他们在哪里安装包。它们很可能正在安装到系统范围的 Python 2.6，而不是您希望将其安装到的版本（Python 2.7）。
4.  如果你发现任何使用 3 安装在错误位置的软件包，请使用 卸载它们，`pip uninstall <packagename>`然后专门将它们重新安装到 2.7`easy_install-2.7`或`pip-2.7`安装。如果您没有看到`easy_install-2.7`or的选项`pip-2.7`，您需要使用您正在使用的特定 Python 版本[安装](http://pypi.python.org/pypi/distribute)并运行它的文件。`setup.py`
5.  确保您在运行时确实在目录中`setup.py`。例如要安装distribute，就需要`cd`进入相应的目录进行安装。

最后，单独说明：使用or安装软件包比单独下载它们要容易*得多。*你应该先尝试这样做。同样，[distribute](http://pypi.python.org/pypi/distribute)有更多信息。`easy_install``pip`

# c++ - C++：使用指向数组的指针

> ID：10964692
> 
> 赞同：1
> 
> 时间：2012-06-09T21:24:16.607
> 
> 标签：c++, arrays, pointers, hashtable

我正在努力使用声明、创建和操作指向列表对象数组的指针所需的语法。我正在为课程作业创建一个哈希表模板类，使用链接来处理有冲突。

我的哈希表应该是一个`list`对象数组。`std::list`是我被允许用于分配的唯一标准库数据类，因此向量已失效。

我的问题是：如何声明一个指向 std::list 数组的指针？我有：

```
private:
    std::list<T> * table; 
```

如何创建数组？我有：

```
table = new std::list<T>[3]; // start with table size 3 
```

我认为我有声明和构造的权利，但我不是 100% 确定。最后，我如何与列表交互？我有：

```
 for (int i = 0; i < _tableSize; i++) { // _tableSize is the array's size
        if (!table[0][i].empty()) {
            table[0][i].push_back(thing);
        }
    } 
```

`table`不知何故， table[0][i] 访问指向的数组单元格似乎是错误的。它应该是什么样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:32:33.617

既然`table`是`std::list*`,`table[i][j]`意味着`(table + i)->operator[](j)`; 也就是说，它在从 address 开始`j`的对象上调用成员函数（带有参数）。`std::list``table + i`

随之而来的是，因为`std::list`不重载`[]`，`table[0][i].empty()`所以是错误的（如果`T`in`std::list<T>`没有成员函数，则双重错误`empty`）。

很快，我认为你需要的是一个简单`table[list_index_on_array].empty()`的检查空虚的方法。

其他一切看起来都不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T00:18:00.053

如果类`Foo`有一个指向 T 列表数组的指针，它的声明将如下所示：

```
#define NUMBER_OF_LISTS 100

template <typename T>
class Foo {
    std::list<T> (*table)[NUMBER_OF_LISTS];
    Foo (std::size_t = 1);
}; 
```

而且，为了初始化它， Foo 的构造函数可以进行如下分配：

```
template <typename T>
inline Foo<T>::Foo (std::size_t entries)
    : table(new std::list<T>[entries][100]) {} 
```

现在，您必须访问的代码`table`将起作用，但您也可以这样做：

```
(*table)[i].push_back(something); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-09T21:28:40.133

你是用来做什么`[0]`的？就够`[i]`了。

# java - Java 嵌入 HTML

> ID：10964693
> 
> 赞同：14
> 
> 时间：2012-06-09T21:24:23.880
> 
> 标签：java, html, applet, embed

我确信这个问题已经被问过一百万次了，但是无论我进行多少次谷歌搜索，我都无法让它发挥作用。我基本上是在尝试将一个包含多个包的项目嵌入网页中。我做了一个测试程序，它只是让一些球在屏幕上弹跳并且能够让它运行。我将主类放在一个包中，将球类放在另一个包中只是为了测试它，它似乎运行良好。但是我在网页中实际需要的程序（只是称为 FinalProject）拒绝这样做。

我能做的最好的事情就是给我一个空白屏幕，没有给出错误，只是白色。如果我尝试单击应该没有任何反应的地方，我想是因为小程序在那里但只是显示为白色，所以我看不到它。我确实使用了这个`applet`标签，据我所知，它现在已经被贬值了，但我需要把这个项目放在一个网页上，这样老师才能看到它。我们已经测试过其他人的项目（使用该`applet`标签）可以正常工作，所以我现在试图坚持下去，并担心以后让它在每个浏览器上都能正常工作。虽然这很可能是问题所在。也许它可以在他的浏览器上工作，但不是我的。我尝试在 Google Chrome、Mozilla Firefox 和 Internet Explorer 上运行我的程序，但没有成功。

这是HTML代码：

```
<html>
<head>  

</head>  
<body>  
    <applet code = "main.FinalProject.class" width = "700px" height = "500px"></applet>  
</body>  
</html> 
```

写入此内容的 HTML 文件位于`[Eclipse Workspace]/FinalProject/bin/test.htm`. HTML 中引用的 FinalProject.class 文件存在于`[Eclipse Workspace]/FinalProject/bin/ main/FinalProject.class`. FinalProject.class 文件作为主类，所以我很确定这是我需要运行的。它具有 init()、actionPerformed()、paint() 方法和所有这些好东西。

目前我正在尝试在我的计算机上离线运行它，所以我认为不应该有任何网络 URL。我使用 Eclipse 编写 Java 代码，不知道这是否有什么不同。不幸的是，Java 代码相当大，无法在此处重现，如果您认为有什么具体问题，我可以查看并发布该小部分。

我的一些朋友设法让他们的工作正常，但是他们说他们必须删除所有的 .png 文件（很烦人，但对我的项目来说是可行的）。他们还说必须删除所有鼠标移动代码。我的程序有点依赖于此，我需要它才能正常工作。我知道必须有一种方法可以在线使用所有 MouseListener 和 MouseMoveListener 代码，但也许有点不同。我不知道这是否与此有关，但我想我会指出它只是为了安全。

在这里的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-09T21:32:40.300

基本上你问的是：[如何为当今的浏览器部署一个 Java 小程序（小程序、嵌入、对象）？](https://stackoverflow.com/questions/985754/how-to-deploy-a-java-applet-for-todays-browsers-applet-embed-object)

基于此，我认为您想要的是：

```
<object 
  classid="clsid:CAFEEFAC-0015-0000-0000-ABCDEFFEDCBA"
  style="height: 500px; width: 700px;">
  <param name="code" value="FinalProject.class">
    <comment>
      <embed code="FinalProject.class"
        type="application/x-java-applet"
        height="500" width="700">
        <noembed>
          This browser appears to lack support for Java Applets.
        </noembed>
      </embed>
    </comment>
  </object> 
```

现在，您`main.FinalProject.class`的代码中有一个文件名。似乎`FinalProject.class`更有可能。但你的可能是对的。在任何情况下，此 html 文件都需要与或位于同一文件夹中，`main.FinalProject.class`并且`FinalProject.class`可能还需要任何类。

现在，您可能还需要确保您的浏览器实际上可以运行小程序。请参阅：**[如何在 Web 浏览器中启用 Java？](http://java.com/en/download/help/enable_browser.xml)**

* * *

更新

根据 Andrew Thompson 的反馈，首选的解决方案是使用 Oracle 的 JavaScript，如下所示：

```
<script src="http://www.java.com/js/deployJava.js"></script>
<script>
    var attributes = {
        code:'FinalProject.class',
    width:700, height:500} ;
    var parameters = {}; // does the Applet take parameters?
    var version = '1.6' ; // does the Applet require a minimum version of Java
    deployJava.runApplet(attributes, parameters, version);
</script> 
```

这需要能够加载任意 JavaScript，但您也可以捕获该 deployJava.js 并将其设置为本地。也许值得一瞧。

# c++ - myvector 没有命名类型

> ID：10964694
> 
> 赞同：0
> 
> 时间：2012-06-09T21:24:25.380
> 
> 标签：c++, vector

### 主文件

```
#include <vector>
#include <iostream>
#include "normal.h"
using namespace std;
int main()
{
  return 0;
} 
```

### 正常的.h

```
#ifndef NORMAL_H
     #define NORMAL_H
#include <vector>
#include <iostream>
using namespace std;
vector < int > myvector;
myvector.push_back(12);//does not name a type
#endif 
```

我知道我需要以某种方式包括在内`vector<int> myvector`，`main.cpp`但无法找到方法。我查看了我以前的程序，不需要在`main.cpp`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:12:41.863

问题是代码 `myvector.push_back(12);`不在任何函数内。在函数之外，您只能声明（并且可能初始化）变量，不能放置其他代码。

因此，即使您可以在`.h`文件中声明您的向量（可能在许多文件中都可以使用它），您也应该将这一行移到 the`main()`或其他一些函数中。

# javascript - 提供具有多个参数的存储语句的最佳方法

> ID：10964698
> 
> 赞同：1
> 
> 时间：2012-06-09T21:25:38.093
> 
> 标签：javascript, sqlite, firefox-addon

提供具有多个参数的语句的“最佳”方法是什么？我想在 SQLite 数据库中插入一行。

适应[https://developer.mozilla.org/en/Storage#Binding_Parameters](https://developer.mozilla.org/en/Storage#Binding_Parameters)我认为以下方法可行：

```
var conn = Services.storage.openDatabase(dbfile); // Will also create the file if it does not exist
let statement  = conn.createStatement("INSERT INTO persons (name, email, city) VALUES (:name, :email, :city)");
statement.params.name = myName;
statement.params.email = myEmail;
statement.params.city = myCity; 
```

但显然我什至无法创建语句本身：

> 组件返回失败代码：0x80004005 (NS_ERROR_FAILURE) [mozIStorageConnection.createStatement]

之后我想异步执行它......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:11:01.017

There is nothing wrong with the code you show here - it works correctly. However, `createStatement` will validate the SQL code and throw an `NS_ERROR_FAILURE` error if that code is invalid. In your case either the table `persons` doesn't exist or not all of the fields `name`, `email` and `city` exist in it. You should take a look at the [`lastErrorString` attribute](https://developer.mozilla.org/en/mozIStorageConnection#Attributes) to see the error message:

```
let statement = null;
try
{
  statement = conn.createStatement("INSERT INTO persons (name, email, city) VALUES (:name, :email, :city)");
}
catch (e)
{
  Components.utils.reportError(conn.lastErrorString);
} 
```

# sql - 在非数字字段上使用 Group By

> ID：10964701
> 
> 赞同：-1
> 
> 时间：2012-06-09T21:26:35.513
> 
> 标签：sql, sql-server, sql-server-2008

如果我有这样的表：

```
 ID   |   Name  |  Age 
 1    |   Bill  |  30
 2    |   Jim   |  20
 3    |   Bill  |  30
 4    |   Bill  |  30 
 5    |   Bob   |  25 
```

我想返回这个：

```
ID   |   Name  |  Age
1    |   Bill  |  30
2    |   Jim   |  20
5    |   Bob   |  25 
```

我试过这个但它不起作用：

```
 SELECT ID,Max(Name),Age FROM TABLE
 GROUP BY ID,Age 
```

我该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T21:31:18.313

这应该有效：

```
select MIN(ID), NAME, AGE from TABLE group by NAME, AGE 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-09T21:34:30.223

按 ID 分组没有意义，因为 ID 已经是唯一的。

```
SELECT Max(Name), AGE
   FROM TABLE
   GROUP BY Age 
```

# android - 自定义数据库到项目中

> ID：10964705
> 
> 赞同：0
> 
> 时间：2012-06-09T21:26:55.377
> 
> 标签：android, database

我已经完成了安卓网站上的记事本教程。我这样做是因为我想为我的应用程序创建一个数据库。完成后，我发现数据在 DDMS 中的位置。然后.. 我下载了 SQLite 浏览器数据库，并创建了一个迷你数据库。知道我正在尝试将这些数据放入我的项目中。

我可以将这个新保存的数据库文件（我用浏览器制作）放入记事本数据库文件中并删除旧的。所以当模拟器加载它会加载我的数据。因为我用这个 SQLite 浏览器用 android 记事本制作了一个包含所有代码等的数据库，所以我认为代码是为我完成的（表，列，）

我想问你是不是我可以用 sql 浏览器制作一个完整的数据库，然后在我的项目中输入它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T04:15:00.657

您的数据库类需要特定于您的数据库，因此您不能只更改后端的数据库并期望您为前端的记事本教程编写的处理程序类可以正常使用它。

话虽如此，您可以创建一个处理程序来运行您的自定义数据库。不过，这有点绕。创建助手类后，您必须将数据库放入`assets`文件夹中。在您的数据库助手中，您需要代码将文件从资产中复制到应用程序数据目录中的正确主目录中。

[您可以在此处](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)找到有关如何设置数据库以便 Android 框架可以正确使用它的说明以及将其复制`assets`到您的数据目录的代码。

# android - android图片加载进度更新父视图

> ID：10964706
> 
> 赞同：1
> 
> 时间：2012-06-09T21:27:13.257
> 
> 标签：android, image, listview, progress, invalidation

我在android开发方面有点新，并且在更新视图时遇到了我自己无法解决的问题。

我所拥有的是mapview，在地图上我有带有listview 的滑动抽屉。列表视图由自定义适配器构建，该适配器放置一些文本并使用 imageLoader 对象从背景中的 url 加载图片。在 listview 行布局中，我还将 progresloader 放置在图片顶部的相对视图中。这是默认可见的，当加载的图片放入 imageview 时，它会在 imageloader 后台线程上消失。所以你明白了，它是显示加载图片的进度并将它们加载到后台以快速建立列表视图。

对于我的问题。滑动抽屉被定制为在关闭时显示其中的一部分（列表中的一项 + 下一项中的一点），并在打开时全屏显示。当用户点击下面有更多项目的地图图标时，它会在关闭的滑动抽屉中加载列表视图。其中的进度加载器不旋转，当我打开滑动抽屉时，加载进度正在旋转，移动抽屉时它们也在旋转，当抽屉关闭时它们也在旋转，并且与移动地图等 UI 有任何交互。试图弄清楚该怎么做，发现当我在滑动抽屉上的调度绘制上添加无效内容使其再次刷新滑动抽屉并再次触发调度绘制时，lstview中的加载进度正在旋转，但这不是很好好，基本上我创建了无限循环并永远更新滑动抽屉，这会耗尽所有 CPU。更新滑动抽屉或列表视图应该由进度加载器触发，但不知何故不是;o（它在打开抽屉和关闭时都工作得很好，但我必须与 UI 交互，而不是在滑块上触发调度绘制，重绘它的子项和 porgresses ar erotating。有人可以告诉我如何让抽屉在装载机可见时更新吗？非常感谢。

# c++ - 与 2,3 及更多整数的子集和相关的想法

> ID：10964708
> 
> 赞同：1
> 
> 时间：2012-06-09T21:27:34.750
> 
> 标签：c++, performance, algorithm, data-structures, subset-sum

我和其他人一样一直在努力解决这个问题，我很确定已经有足够多的帖子来解释这个问题。然而，就完全理解它而言，我想分享我的想法，并从这里所有与**子集和**问题相关的伟大人物那里获得更有效的解决方案。

我在互联网上搜索过它，实际上有很多来源，但我真的很愿意重新实现一个算法或找到我自己的算法以便完全理解。

我正在努力解决的关键问题是考虑到集合大小会很大的**效率。**（我没有限制，只是在概念上很大）。我试图实现想法的两个阶段是找到**两个**等于给定整数**T**的数字，找到**三个**数字并最终找到**K**个数字。我有一些想法；

对于**两个**整数部分，我基本上对数组**O(nlogn)**进行排序，并为数组中的每个元素搜索其负值。（即如果数组元素是**3**搜索**-3**）。也许哈希表包含可能会更好，提供**O(1)**索引元素？

对于**三个或更多**整数，我发现了一篇很棒的博客文章；http://www.skorks.com/2011/02/algorithms-a-dropbox-challenge-and-dynamic-programming/。然而，即使是作者自己也表示它不适用于大量数据。

所以我对**2**和**3 以及更多的**整数有什么想法可以应用于子集问题。我正在努力建立一种对大输入也有效的动态编程方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:34:37.657

实际上，您链接到的那篇[博客文章](http://www.skorks.com/2011/02/algorithms-a-dropbox-challenge-and-dynamic-programming/)看起来非常棒。毕竟，这是一个 NP 完全问题......

但我敢打赌，你可以进一步加快速度。我没有做过任何基准测试，但我猜他对矩阵的使用是他最大的时间消耗。首先，一些非常琐碎的输入会占用大量内存（例如：[-1000, 1000] 需要 2001 列！天哪！），然后你浪费了大量的周期扫描每一行寻找`"T"`s，这通常会非常稀疏。

所以改为：使用“集合”数据结构。这会将空间和迭代时间保持在最低限度，* 但也可以存储值：如果它在集合中，它就是`"T"`; 否则，它是一个`"F"`.

希望有帮助！

*：当然，“最小”不一定=“小”。

# python - PySerial 和微控制器

> ID：10964712
> 
> 赞同：2
> 
> 时间：2012-06-09T21:28:21.603
> 
> 标签：python, microcontroller, pic, pyserial, uart

我正在尝试使用 pySerial 通过 UART 与 MCU 通信。我使用 Arduino USB2Serial Light Converter 将数据从 PC 发送到我的 PIC33F。由于 Arduino 转换器，我不能使用 CTS 或 RTS。

我设法将数据发送到 MCU 并从中接收数据。但问题是数据并不总是应有的样子。

例如，我想将整个字符串从 MCU 发送到终端，但我得到的不是 MCU 程序代码中给出的字符串。另一个问题是字符之间没有比较有效。这意味着我向 MCU 发送一个字符，MCU 将它与一个字符进行比较以做出决定。

好的，现在来一些代码：

### 1\. 将字符串从 PIC33F 发送到 PC 并使用 pySerial 读取

```
putsU1("string");

// print a string

    int putsU1(char *s) {
     while(*s)
        putU1(*s++); 
    }

// print a character

    int putU1(int c) {
      while (_UTXBF);
        U1TXREG = c;
      return c; 
    } 
```

如果我通过阅读此代码，我得到的结果`pySerial`如下；

```
In [13]: ser = serial.Serial('/dev/ttyACM0', 9600, bytesize=7, xonxoff=0)

In [14]: while True:                                                     
            print(struct.unpack('s', ser.read()))
         ....:     
('\x7f',)
('c',)
('\x11',)
('\t',)
('e',)
('y',)
('=',)
('\x7f',) 
```

### 2\. 将数据发送到 PIC33F`pySerial`并回显

这个仅适用于单个字符，不适用于字符串。回显的字符也在大写和小写之间随机切换。

```
 getsnU1(s, BUF_SIZE);

     char *getsnU1(char *s, int len) {
        char *p = s;
        int cc = 0;
        do {
           *s = getU1();
           putU1(*s);

           if ((*s == 0x8) && (s > p)) {
              putU1(' ');
              putU1(0x8);
              len++;
              s--;
              continue;
           }

           if (*s == '\n')
              continue;

           if (*s == '\r')
              break;
           s++;
          len--;
       } while (len > 1);

      *s = '\0';

      return p;
    } 
```

UART配置：

```
#define FOSC            8000000
#define FCY             (FOSC/2)
#define BAUD            9600
#define U1BRGValue      (((FCY/BAUD)/16)-1)

void initUART1(void) {
/* general UART config */
RPINR18bits.U1RXR = U1RXPIN;            // set RP5 as UART1 RX
_RP6R = 0b00011;                        // set RP6 as UART Tx pin
U1RXPINTRIS = 1;                        // set RP5 (RB5) as input
U1MODEbits.PDSEL = DATAPARITY;           // set data bits and parity
U1MODEbits.STSEL = STOPBITS;            // set stop bits
U1MODEbits.ABAUD = 0;                   // auto-baud disabled
U1MODEbits.BRGH = 0;                    // low speed baud rate
U1BRG = U1BRGValue;                     // set baud value

/* enable interrupt on error */
IEC4bits.U1EIE = 1;                     // enable UART1 error interrupt
IPC16bits.U1EIP = 6;                     // set interrupt priority to 6

/* enable RX buffer interrupt */
IEC0bits.U1RXIE = 0;                    // enable UART1 RX interrupt
U1STAbits.URXISEL = 0b00;                // interrupt flag is set when buffer is 3/4 full
IPC2bits.U1RXIP = 6;                     // set interrupt priority to 6

/* enable TX interrupt */
IEC0bits.U1TXIE = 0;

/* enable UART1 module */
U1MODEbits.UEN = 0b00;
U1MODEbits.UARTEN = 1;
_UTXEN = 1;                             // enable UART Tx 
```

}

我有点沮丧，因为我无法弄清楚问题出在哪里。已经测试和阅读了几个小时，在任何地方都似乎很容易启动并运行它，但它不会在我的最后;（。我尝试将数据写入 PIC33F`serial.write('text'.encode('ascii'))`并且 `serial.write(struct.pack('s',('test')))`所有这些都产生相同的结果。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T08:01:03.713

我认为您不需要 bytesize=7 （除非您确切知道原因）。

此外，UART 的一个典型问题是单个字符可以工作，但整个字符串不能工作——这通常是当接收微控制器只在硬件中缓冲单个字符时。我不知道 PIC，但是在上面的代码中，你在 getU1() 后跟 putU1() 我猜 putU1() 等待一个字符的持续时间，所以当你稍后再次调用 getU1() 时你会错过一个字符（如果软件没有暂停就发送它）。

我通常的解决方法是：

```
def write(s):
    for c in s:
        ser.write(c)
        time.sleep(0.001) # often not required 
```

一般来说 pyserial 似乎对我所有的项目都可以正常工作，但你也应该检查一个普通的终端程序来确定。除此之外，我只能建议您仔细检查微控制器上的波特率和 FOSC。

# java - 新手创建游戏 - 尝试清洁代码 - 继承

> ID：10964713
> 
> 赞同：2
> 
> 时间：2012-06-09T21:28:24.923
> 
> 标签：java, inheritance

试图在编程方面做得更好。致力于构建一个愚蠢的游戏来自学，所以它就像一个 RPG 类型。

里面的主要：

```
String selection = "Warrior";
    if(selection == "Warrior")
    {
        Warrior war = new Warrior();
        characterCreation(player, war, 75, 200, "Black", 150, 90, 25);
    } 
```

只是为了创建一个通用字符：

```
private static void characterCreation(User player, Character type, int armour, int health, String colour, int height, int weight,
            int damage) {
        type.setType(type);

System.out.println("New "+ type.getType() +" Created!"); 
```

所以这个想法是你可以创造一个战士，治疗师，巫师你明白的:)

字符.java

```
 private Character type;
    public Character getType() {
        return type;
    }
    public void setType(Character type) {
        this.type = type;
    } 
```

然后清空扩展 Character 类的 Warrior.java 类。

打印时得到的输出是 New com.game.config.Warrior@6471d768 Created！

我在这里做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:35:26.463

给你的类一个可行的`public String toString()`方法——它返回一个描述当前对象及其状态的字符串。这将解决您的“com.game.config.Warrior@6471d768”问题，因为您看到的是从 Object 的`toString()`方法返回的默认字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T21:29:29.390

不要使用`selection == "Warrior"`

利用`selection.equals("Warrior")`

== 用于比较引用而不是对象的值

# ruby-on-rails - form_for 调用模型方法而不提交

> ID：10964714
> 
> 赞同：0
> 
> 时间：2012-06-09T21:28:30.460
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的项目管理部分有一个索引页

```
<% @reviews.each do |review| %>
  <p><%= review.header %></p>
  <p><%= review.body %></p>
  <%= form_for [:admin, review] do |f| %>
    <%= f.hidden_field :approve %>
    <%= f.submit "Approve" %>
  <% end %>
  <%= form_for [:admin, review] do |f| %>
    <%= f.hidden_field :reject %>
    <%= f.submit "Reject" %>
  <% end %>
<% end %> 
```

where`:approve`和`:reject`是`Review`模型中的公共实例方法。由于某种原因，当我加载此索引页面时，它会自动调用`review.reject`将相应`is_rejected`字段设置为`true`. 如果我用位删除，同样的行为也适用于`form_for`with 。`:approve``form_for``:reject`

`index`来自相应控制器的动作非常简单

```
def index
  @reviews = Review.all
end 
```

我意识到这一定是正常行为，但我希望`reject`只有在提交相应表单时才调用方法。有没有办法解决它？谢谢你。

**更新** 仅供将来参考（包括我自己的）：使用`button_to`helper 来做这样的事情更容易

```
<%= button_to "Approve", { :action => "update", :id => review.id, :review => { :approve => true } }, :method => :put %>
<%= button_to "Reject", { :action => "update", :id => review.id, :review => { :reject => true } }, :method => :put %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:51:05.767

表单构建器在您的模型上调用批准和拒绝，因为它试图确定将隐藏字段的值设置为什么。解决此问题的一种方法是不使用`f.hidden_field`并仅创建一个与您的模型无关的隐藏字段。你可以`hidden_field_tag`改用。

# java - JTA EntityManager 不能使用 getTransaction()

> ID：10964717
> 
> 赞同：24
> 
> 时间：2012-06-09T21:29:16.813
> 
> 标签：java, persistence, ejb-3.0

如何在我的非 ejb 应用程序中使用以下代码。该代码有效。

```
@Override
public void saveItems(Collection<T> items) {
    synchronized (em) {
        EntityTransaction tx = em.getTransaction();
        try {
            tx.begin();
            for (T item : items) {
                saveItem_((Class<T>) null, item);
            }
            tx.commit();
        } finally {
            if (tx.isActive()) {
                tx.rollback();
            }
        }
    }
} 
```

在一个新应用程序中，我正在使用 EJB3 + JSF，并希望重新使用包含上述代码的库。我的新应用程序的持久性单元如下所示：

```
 <persistence-unit name="myApp" transaction-type="JTA">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>MySQLConnection</jta-data-source>
  </persistence-unit> 
```

我的新应用程序在遇到此行时抛出异常：

```
 EntityTransaction tx = em.getTransaction(); 
```

例外是：

```
A JTA EntityManager cannot use getTransaction() 
```

这很清楚。问题是如何将我的代码转换为由容器管理的事务。大概我的bean方法需要适当地注释......问题是如何？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-10T09:22:43.373

`EntityTransaction`与资源本地类型的实体管理器一起使用。如果要使用JTA，则必须使用`UserTransaction`接口。

来自文档：***EntityTransaction*** *- 用于控制资源本地实体管理器上的事务的接口。EntityManager.getTransaction() 方法返回 EntityTransaction 接口。*

* * *

**编辑：**添加伪代码。

```
@Resource
private SessionContext sessionContext;

void execute(){

UserTransaction userTxn = sessionContext.getUserTransaction();

try{

 userTxn.begin();
 /**
  *  do-something
  */
 userTxn.commit();

  } catch(Throwable e){
   userTxn.rollback(); //-- Include this in try-catch 
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-10T08:10:31.497

在最简单的情况下 - 它只是工作。如果您将 EntityManager 注入 EJB 并且不使用特殊注释，则事务将在输入的第一个 EJB 方法中打开（这意味着如果 EjbA 调用 EjbB，然后又调用 EjbC，则在所有 EJB 方法中将只使用一个事务）。如果要修改事务的控制方式，请查找@Transaction。

进行回滚的最简单方法是抛出标有 @ApplicationException(rollback=true) 的异常

我可能错了，但从您的代码来看，您应该阅读 EXTENDED 和 NORMAL EntityManager 之间的区别。看起来您正在以一种非常尴尬的方式使用扩展 em（将循环移出事务将帮助您最终摆脱）。

**小编辑：**如果您尝试使用 UserTransaction，正如另一篇文章所建议的那样，您将收到错误消息，因为标准 EntityManager（您可能正在使用）使用所谓的 CMT（容器管理事务）。不要碰它，除非你了解三个基本的反对意见（如果你愿意，我可以详细说明，但坦率地说，你不需要它）：

*   容器管理的 EntityManager 与应用程序管理的 EntityManager，
*   容器管理事务与应用程序管理事务，
*   普通实体管理器和扩展实体管理器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-12-28T23:00:22.553

只是总结一下在 Jboss EAP6 和 Hibernate 4.2.18.Final 上对我有用的代码。

可以为某人节省时间。

持久性.xml

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
         version="2.0">
<persistence-unit name="myApp" transaction-type="JTA">
<provider>org.hibernate.ejb.HibernatePersistence</provider>
<jta-data-source>jdbc/MySQLConnection</jta-data-source>
<properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.MySQL5Dialect"/>
        <property name="hibernate.transaction.manager_lookup_class" value="org.hibernate.transaction.JBossTransactionManagerLookup"/>
        <!--
        <property name="hibernate.show_sql" value="true" />
        -->
    </properties>
</persistence-unit> 
```

爪哇

```
 import javax.annotation.Resource;
 import javax.persistence.EntityManager;
 import javax.transaction.UserTransaction;

public class MyClass {
@PersistenceContext(unitName = "myApp")
protected EntityManager em;
@Resource
UserTransaction utx;

public void execute(..) throws Exception {
    try {
        utx.begin();
        em.remove(..);
        em.merge(..);
        em.persist(..);
        utx.commit();
    } catch (Exception ex) {
        try {
            utx.rollback();
        } catch (Exception re) {
            throw new RollbackFailureException("An error occurred attempting to roll back the transaction.", re);
        }
        throw ex;
    }
} 
```

}

pom.xml

```
 <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>${hibernate.version}</version>
        <scope>provided</scope>
    </dependency> 
```

链接：

应用程序管理的实体管理器[https://docs.oracle.com/cd/E19798-01/821-1841/bnbra/index.html](https://docs.oracle.com/cd/E19798-01/821-1841/bnbra/index.html)

[UserTransaction 和 EntityManager 是如何交互的？](https://stackoverflow.com/questions/7617026/how-does-the-usertransaction-and-the-entitymanager-interact)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-03-20T07:39:59.407

> “可以为某人节省时间。”

它确实节省了我的时间！我希望我能在几天前​​找到您的解决方案。我一直在努力解决如何在 JTA 持久性单元的上下文中处理 bean 管理的事务。我们的大部分使用只是一个 bean 方法中的一次 JPA DML 调用。问题是在执行单个 DML 操作后，对存储过程的后续调用（在同一 bean 方法中）将失败，抱怨无法在正在运行的事务中启动另一个事务。文档详尽但繁琐。

这是关键：`@Resource UserTransaction utx;`

谢谢！

# performance - 如果文件大小没有减小并且图像质量受到影响，我为什么要在 Coldfusion 中调整图像大小？

> ID：10964720
> 
> 赞同：0
> 
> 时间：2012-06-09T21:29:40.917
> 
> 标签：performance, coldfusion, image-resizing, coldfusion-8

只是想知道：我正在尝试在 Coldfusion8中设置一个[自适应图像处理程序，它可以调整图像的大小以适应更小的屏幕尺寸。](https://github.com/cfjedimaster/Adaptive-Images)

我可以正常工作，目前正在使用[此处找到的不同调整大小选项](http://www.raymondcamden.com/index.cfm/2008/11/1/ColdFusion-8-Image-Resize-options)

我注意到无论我使用什么方法，它们都需要时间，降低图像质量而不是真正减小图像大小，例如：

```
 IMG 1                     IMG 2
Original             23K 900x360px             53K 900x360px
Blackman             22k 320x128px             52K 320x128px
highPerformance      21K 320x128px             32K 320x128px 
nearest              25K    "                  38K    " 
```

这个想法是为更小的显示器调整图像大小。现在我并没有真正减少任何东西，我只是在消耗处理器来调整大小并输出模糊图像和相同的文件大小。

**问题：**
那我为什么要费心调整大小呢？我还不如发送@900x360px @23K 的原始文件。至少与 320x1280 像素的调整大小的模糊图像相比，图像会更清晰。就文件大小和/或图像质量而言，有没有办法让 Coldfusion 中的图像大小调整变得有价值？

感谢您的投入！Cldfu

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:28:06.367

我认为你摆弄的是调整大小算法的质量/速度，而不是压缩。

要以更好的文件大小进行压缩，请使用属性设置 JPEG 压缩质量`quality`（默认为 0.75）

[http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7945.html](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7945.html)

如果 cfimage 不能满足您的需求，请使用[imagemagick](http://www.imagemagick.org)

# python - 如何在函数调用中间更新 Tkinter 画布？

> ID：10964721
> 
> 赞同：6
> 
> 时间：2012-06-09T21:29:58.790
> 
> 标签：python, tkinter

我正在使用 Tkinter 编写康威的生活游戏，我想要一个“开始”按钮，它允许动画开始，并继续自动步进直到终止。我正在使用 Canvas 来绘制环境，但由于“Go”按钮需要在更新画布之前完成函数调用，所以窗口会一直挂起，直到我终止进程。我试图在我想更新画布的地方使用`canvas.update_idletasks()`and `canvas.update()`（然后睡几秒钟），但这似乎没有奏效。有任何想法吗？下面是我的 GameOfLife 类，Environment 类只管理单元的“板”。

```
from Tkinter import *
from random import *
from time import time
from Environment import *

class GameOfLife(object):
    def __init__(self, master, envDim):
        self.unitSize = 10
        self.dimension = envDim * self.unitSize
        self.environment = Environment(envDim)
        self.environment.seedBoard()
        self.started = False

        frame = Frame(master)
        frame.pack()
        Button(frame, text = "Go", command = self.go_call).pack(side = LEFT)
        Button(frame, text = "Clear", command = self.reset_call).pack(side = LEFT)
        Button(frame, text = "Close", command = frame.quit).pack(side = RIGHT)
        canvas = self.drawCanvas(master, self.dimension)

def drawCanvas(self, master, dimension):
    self.canvas = Canvas(master, width = self.dimension, height = self.dimension)
    self.canvas.pack()
    return self.canvas

def go_call(self):
    print "<< Go Call >>"
    if self.environment.started == False:
        self.environment.seedBoard()

    self.drawState(self.environment)
    self.environment.nextBoard()
    self.started = True
    while True:
        self.environment.nextBoard()
        self.canvas.delete(ALL)
        self.drawState(self.environment)
        self.canvas.update_idletasks()
        sleep(4)

def reset_call(self):
    print "<< Reset Call >>"
    self.canvas.delete(ALL)
    self.environment = Environment(self.environment.dim)

def drawState(self, environment):
    size = self.unitSize
    for x in range(environment.dim):
        for y in range(environment.dim):
            if environment.matrix[x][y].alive == True:
                xs = x * size
                ys = y * size
                self.canvas.create_rectangle(xs, ys, xs+size, ys+size, fill = 'black')

envDim = 70
root = Tk()
gol = GameOfLife(root, envDim)
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T23:57:07.597

你不应该在你的 GUI 程序中放置一个无限循环，而且你绝对不应该调用 sleep。您已经运行了一个无限循环——事件循环——所以好好利用它。

制作这样的动画的方法是编写一个绘制动画一帧的函数（或游戏回合，选择你的比喻）。然后，让该函数通过`after`.

粗略地说，您的代码应如下所示：

```
def draw(self):
    # draw the board according to the current state
    ...
    # arrange for the next frame to draw in 4 seconds
    self.after(4000, self.draw)

def __init__(self, ...):
    ...
    self.go = tk.Button(self, text="Go", command=self.draw)
    ... 
```

如果你想添加一个停止按钮，它需要做的就是设置一个标志。然后，在 中`draw`，只需在调用之前检查标志`self.after`

# libusb-1.0 - libusb 数据传输

> ID：10964722
> 
> 赞同：1
> 
> 时间：2012-06-09T21:30:21.253
> 
> 标签：libusb-1.0

嗨，我必须编写一个代码来从 USB 驱动器读取数据，该驱动器可以是 pendrive，后来是数据采集卡。我写了这么多代码来检测所有 USB 连接 n 打印他们的信息。尽管我不知道如何进一步进行。我也很困惑从说 pendrive 读取数据意味着打开一些文件或什么？还请告诉我如何找到设备的端点，目前我正在使用 hit n trial 来找到它。请帮帮我。我已经阅读了有关同步和异步 I/O 的全部文档。

```
enter code here    

  #include <stdlib.h>
  #include <stdio.h>
  #include <string.h>
  #include <libusb-1.0/libusb.h>

 //=========================================================================
 // This program detects usb and print out their details
 //=========================================================================

  int main (int argc, char *argv)
   {
libusb_device                    **devList = NULL;
libusb_device                    *devPtr = NULL;
libusb_device_handle             *devHandle = NULL;
libusb_context                   *ctx = NULL;            //a libusb session
struct libusb_device_descriptor  devDesc;

unsigned char              strDesc[256];
ssize_t                    numUsbDevs = 0;      // pre-initialized scalars
ssize_t                    idx = 0;
 int                        retVal = 0;

//========================================================================
// test out the libusb functions
//========================================================================

 printf ("*************************\n USB Detection             Program:\n*************************\n");
 retVal = libusb_init (&ctx);

 if(retVal < 0) {
    printf ("%d",retVal," Init Error "); //there was an error
        return 1;
          }

  //========================================================================
 // Get the list of USB devices visible to the system.
 //========================================================================

   numUsbDevs = libusb_get_device_list (ctx, &devList);

//========================================================================
// Loop through the list, looking for the device 
//========================================================================

 while (idx < numUsbDevs)
  {
  printf ("\n\n[%d]\n", idx+1);

  //=====================================================================
  // Get next device pointer out of the list, use it to open the device.
  //=====================================================================

  devPtr = devList[idx];

  retVal = libusb_open (devPtr, &devHandle);
  if (retVal != LIBUSB_SUCCESS)
     break;

  //=====================================================================
  // Get the device descriptor for this device.
  //=====================================================================

  retVal = libusb_get_device_descriptor (devPtr, &devDesc);
  if (retVal != LIBUSB_SUCCESS)
     break;

  //=====================================================================
  // Get the string associated with iManufacturer index.
  //=====================================================================

  printf ("iManufacturer = %d", devDesc.iManufacturer);
  if (devDesc.iManufacturer > 0)
  {
     retVal = libusb_get_string_descriptor_ascii
              (devHandle, devDesc.iManufacturer, strDesc, 256);
     if (retVal < 0)
        break;

     printf ("     string = %s",  strDesc);
  }

  //========================================================================
  // Get string associated with iProduct index.
  //========================================================================

  printf ("  \niProduct      = %d", devDesc.iProduct);
  if (devDesc.iProduct > 0)
  {
     retVal = libusb_get_string_descriptor_ascii
              (devHandle, devDesc.iProduct, strDesc, 256);
     if (retVal < 0)
        break;

     printf ("     string = %s", strDesc);
  }

  //==================================================================
  // Get string associated with iSerialNumber index.
  //==================================================================

  printf ("  \niSerialNumber = %d", devDesc.iSerialNumber);
  if (devDesc.iSerialNumber > 0)
  {
     retVal = libusb_get_string_descriptor_ascii
              (devHandle, devDesc.iSerialNumber, strDesc, 256);
     if (retVal < 0)
        break;

     printf ("     string = %s", strDesc);
  }

  //==================================================================
  // Print product id and Vendor id
  //==================================================================

    printf ("  \nProductid     = %d", devDesc.idProduct);
    printf ("  \nVendorid      = %d", devDesc.idVendor);

  //========================================================================
  // Close and try next one.
  //========================================================================

  libusb_close (devHandle);
  devHandle = NULL;
  idx++;

  //========================================================================
  // Selection of device by user
  //========================================================================

     if(idx==numUsbDevs) 
            { printf("\n\nselect the device :  ");
              scanf("%d",&idx);
         if(idx > numUsbDevs)
             {printf("Invalid input, Quitting.............");
              break; }    

       devPtr = devList[idx-1];

       retVal = libusb_open (devPtr, &devHandle);
           if (retVal != LIBUSB_SUCCESS)
           break;

      retVal = libusb_get_device_descriptor (devPtr, &devDesc);
           if (retVal != LIBUSB_SUCCESS)
           break;
               printf ("  \nProductid     = %d", devDesc.idProduct);
               printf ("  \nVendorid      = %d", devDesc.idVendor);

         unsigned char data[4] ; //data to read

         //data[0]='a';data[1]='b';data[2]='c';data[3]='d'; //some dummy values

          int r; //for return values 
          r = libusb_claim_interface(devHandle, 1); //claim interface 0 (the first) of   device

      if(r < 0) {

    printf("\nCannot Claim Interface");

    return 1;
                }

    printf("\nClaimed Interface");

   int actual_length; //used to find out how many bytes were written

 r = libusb_bulk_transfer(devHandle,LIBUSB_ENDPOINT_IN, data, 2, &actual_length, 0);

      if (r == 0 && actual_length == sizeof(data)) {

              // results of the transaction can now be found in the data buffer
             // parse them here and report button press
          } 
      else {
             error();
           } 

 r = libusb_release_interface(devHandle, 1); //release the claimed interface

   if(r!=0) {

            printf("\nCannot Release Interface");

            return 1;
           }

    printf("\nReleased Interface");

            idx=numUsbDevs +2;
            }

   }  // end of while loop

   if (devHandle != NULL)
   {
  //========================================================================
  // Close device if left open due to break out of loop on error.
  //========================================================================

  libusb_close (devHandle);
 }   

   libusb_exit (ctx); //close the session

   printf ("\n*************************\n        Done\n*************************\n");
   return 0;
   }

//==========================================
// EOF
//==================== 
```

# objective-c - 我们应该在需要动态创建 UI 的情况下使用 Interface Builder 吗？

> ID：10964724
> 
> 赞同：0
> 
> 时间：2012-06-09T21:30:33.880
> 
> 标签：objective-c, xcode, interface-builder, dynamic-ui

我目前正在考虑项目，它基本上是解释来自许多抽象数据源的数据。

所以应用程序内部的通信是这样的

```
[UI] <-> [Controller / Delegate] <-> [Subclass of Abstract Data Source] 
```

这基本上是 MVC 模式。我的问题是什么，每个`[Subclass of Abstract Data Source]`人只能使用有限数量的`[UI]`，所以流程基本上是这样的：

*   创建数据源 (DS) 实例
*   从 DS 获取可能的 UI 列表
*   创建 UI 选择器并实例化预设 UI
*   让 DS 修改 UI
*   通过预定义的处理程序方法从 DS 填充 UI

示例 UI 是`NSTableView`、`NSOutlineView`、`NSCollectionView`等。

所以我基本上需要更改列名、顺序、控件样式，......不可能为每个设计独特的 NSWindow`Data Source`

现在的问题：

**如果我需要动态 UI 创建和自定义数据处理逻辑（没有绑定到 Core Data 等），我应该（甚至可以）使用 InterfaceBuilder 还是应该以编程方式实现所有视图逻辑？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:50:10.200

使用任何你喜欢的。*控制器*可以表示/处理任何变化/动态区域。在某种程度上，这意味着我建议将*动态*部分移动到控制器的代码中——但如果您愿意，您仍然可以使用 XIB 进行常见的高级设计。

因此，当一个视图不适合单个数据表示而用于多个时，可以将实现/变体移至控制器域。当实现/定义适用于所有人时，您可以在 XIB 或程序中定义它——无论您喜欢放在哪里。在这种情况下，您可以将 XIB（或代码）用于不变（骨架）视图。

# javascript - 覆盖 CSS 悬停的 Javascript 样式

> ID：10964729
> 
> 赞同：1
> 
> 时间：2012-06-09T21:31:11.040
> 
> 标签：javascript, css, onclick, styles, hover

为了使这一点更清楚，我将在下面使用我的代码：

我有一个分隔容器“c_container”：

```
<div id="c_container">
<div id="c_tab">Menu</div>
<div id="c_main">MenuContent</div>
</div> 
```

然后我有控制它的样式的CSS：

```
#c_container {
    width: 550px;
    height: 265px;
    position: fixed;
    left: -550px;
    margin-left: 35px;
    top: 50%;
    margin-top: -100px;
}
#c_container:hover{
    margin-left: 0px;
    left: -40px;
} 
```

然后在我使用 Javascript 从 onClick 函数更新样式后：

```
function hideForm(){
    var msg = document.getElementById("c_container");
    msg.style.left = "-550px";
} 
```

CSS 悬停只影响 margin 属性，不会像以前那样影响 left 属性。就像 javascript 锁定了它一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:41:11.247

***jQuery：***

```
//Normal: 
$('elementNameOrID').hover (function () {
    $(this).css('left', 0);
}, function () {
    $(this).animate('left', -500);
}); 

//Nice:
$('elementNameOrID').hover (function () {
    $(this).animate({left: 0});
}, function () {
    $(this).animate({left: -500});
}); 
```

***JS：***

```
onclick = function () {
    document.getElementById("div").style.left = '-550px';
}; 
```

*旁注：*用作`div`元素的名称不是一个好主意，并且在阅读代码时会非常混乱和误导。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T21:46:10.207

使用 JavaScript 样式添加的样式正在创建比您的样式表具有更高优先级的内联样式。要解决此问题，您可以添加`!important`到样式表中：

```
#c_container:hover{
    margin-left: 0px;
    left: -40px !important;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T21:37:16.010

onclick 函数中的逗号有问题...

```
onclick="document.getElementById('div').style.left='-550px;'" 
```

并且“div”不是 id 的好名字。

您的 CSS 令人困惑。对于应用 DIV 标签

```
div {
   position: fixed;
   left: -550px;
}
div:hover{
   left: 0px;
} 
```

或者

```
#DIV_ID { ... } 
```

或者

```
.CLASSNAME { ...} 
```

**编辑**

我recriate你的例子...... [http://jsfiddle.net/PAg9M/1/](http://jsfiddle.net/PAg9M/1/)并为我工作。你需要什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T22:15:24.173

You are facing this problem because inline css haves more priority than the one in"style" tag and javascript add inline css.

So should use only javascript to do this-

modify your html-

```
<div id="c_container" onmouseover="style.left='0'" onmouseout="style.left='-550'">
<div id="c_tab">Menu</div>
<div id="c_main">MenuContent</div>
</div> 
```

This will sort out your problem.

# animation - 精灵没有动画

> ID：10964735
> 
> 赞同：0
> 
> 时间：2012-06-09T21:32:10.227
> 
> 标签：animation, sprite, sfml

我写了两节课；动画，演员。由于某种原因，精灵图像不会改变。它始终保持第一帧。代码很好，我编译没有问题，我的逻辑在某个地方是错误的，它没有按照我的预期行事。

动画类声明：

```
class Animation
{
public:
        Animation(std::string path, int frames);
        ~Animation();
        void nextFrame();
        void gotoStart();
        bool loadFrames();
        sf::Texture& getActiveFrame();

private:
        int frameCount;
        std::string pathToAnimation;
        int currentFrame;
        sf::Texture frame[];
}; 
```

动画类实现：

```
Animation::Animation(std::string path, int frames)
{
        pathToAnimation = path;
        frameCount = frames;
}

Animation::~Animation()
{
        // destructor
}

void Animation::nextFrame()
{
        if(currentFrame < frameCount)
        {
            currentFrame = 1;
        }
        else
            currentFrame += 1;
}

void Animation::gotoStart()
{
        currentFrame = 1;
}

bool Animation::loadFrames()
{
        for(int i = 01; i < frameCount; i++)
        {
            if(!frame[i].loadFromFile(pathToAnimation + std::to_string(i) + ".jpg")) return false;
        }
        return true;
}

sf::Texture& Animation::getActiveFrame()
{
    return frame[currentFrame];
} 
```

演员类声明：

```
class Actor
{
public:
        Actor();
        ~Actor();
        void setActiveAnimation(std::shared_ptr<MaJR::Animation> anim);
        void draw(sf::RenderWindow& win);

private:
        sf::Sprite sprite;
        std::shared_ptr<MaJR::Animation> activeAnimation;
}; 
```

演员类实现：

```
Actor::Actor()
{
    // constructor
}

Actor::~Actor()
{
    // destructor
}

void Actor::setActiveAnimation(std::shared_ptr<MaJR::Animation> anim)
{
    activeAnimation = anim;
    activeAnimation->gotoStart();
}

void Actor::draw(sf::RenderWindow& win)
{
    sprite.setTexture(activeAnimation->getActiveFrame());
    win.draw(sprite);
    activeAnimation->nextFrame();
} 
```

这是测试它的代码：

```
int main()
{
    sf::RenderWindow Window(sf::VideoMode(800, 600), "MaJR Game Engine Sandbox");

    std::shared_ptr<MaJR::Animation> DroneStandNorth = std::make_shared<MaJR::Animation>("./Assets/Sprites/Zerg/Units/Drone/Stand/North/", 61);
    if(!DroneStandNorth->loadFrames()) return EXIT_FAILURE;
    MaJR::Actor Drone;
    Drone.setActiveAnimation(DroneStandNorth);

    while(Window.isOpen())
    {
        sf::Event Event;
        while(Window.pollEvent(Event))
        {
            if(Event.type == sf::Event::Closed)
                Window.close();
        }

        if(sf::Keyboard::isKeyPressed(sf::Keyboard::Escape))
            Window.close();

        Window.clear();
        Drone.draw(Window);
        Window.display();
    }

    return 0;
} 
```

我完全不知道这里出了什么问题。如果你想自己编译所有东西，这里是原始文件：[http](http://www.filedropper.com/animationtesttar) ://www.filedropper.com/animationtesttar一定要使用 -std=c++0x 或者你必须做的任何事情才能在你的编译器中使用 C++11 .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T03:04:33.810

在您的动画实现中，您有：

```
void Animation::nextFrame()
{
    if(currentFrame < frameCount)
    {
        currentFrame = 1;
    }
    else
        currentFrame += 1;
} 
```

由于 currentFrame 从 1 开始，所以会一直小于 frameCount，所以会一直设置为 1。改成：

```
void Animation::nextFrame()
{
    if(currentFrame >= frameCount)
    {
        currentFrame = 1;
    }
    else
        currentFrame += 1;
} 
```

这样，当 currentFrame 等于 frameCount 时（在您的测试用例 61 中），它将被重置。由于 nextFrame() 在 Actor 的 Draw() 之后被调用，最后一帧将被绘制，然后 currentFrame 将被重置回 1。

# objective-c - 在不使用指针的情况下在 Objective C 中表示可能类型的最佳方法，（指向指针的指针不是对象？）

> ID：10964737
> 
> 赞同：3
> 
> 时间：2012-06-09T21:32:21.160
> 
> 标签：objective-c, maybe

在不使用指针的情况下，在 Objective C 中表示可能类型的最佳方法是什么？我不能简单地使用指向对象的指针，因为指向对象的指针不是对象，我需要它是对象。

我知道做到这一点的一种方法是为我拥有的每个对象创建一个自定义类，这将产生诸如 MaybeEmployee、MaybeOrderStatus 之类的类以及更多自定义类。这会起作用，但它看起来很笨拙，根本不是一个很好的解决方案。

第二种方法，简单地使用一个 Maybe 类似乎也是错误的。缺乏类型安全是很糟糕的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T00:19:05.077

left2 有正确的想法。使用 NSNull 来表示“可能不是”的情况。

处理它的最简单方法是让您的方法返回一个类型为 id 的对象，但正如您所说，这会牺牲类型安全。

我建议创建一个祖先类 MaybeClass 并让您的所有类都从中派生。然后你可以创建一个特定的子类可能不是真的是一个 NSNull。

请注意，您也可以只使用标准对象，并在方法调用的结果为空时返回 nil。Objective C 比许多其他语言更干净地处理 nil 对象指针。向 nil 对象发送消息是完全有效的。他们只是被丢弃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T21:34:31.370

我不确定“可能类型”对您来说究竟意味着什么，但是有什么理由`id`不能满足您的需求吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T00:51:20.120

我也不确定您所说的“可能类型”是什么意思！协议可以是你想要的，有些类实现了协议，而另一些则不是。他们可以检查对象是否实现它[yourObject conformsToProtocol:@protocol(yourProtocol)]。我希望这会有所帮助，但如果没有更多的澄清会很好。

# c# - 从基类对象列表中调用子类的方法？

> ID：10964741
> 
> 赞同：0
> 
> 时间：2012-06-09T21:33:07.247
> 
> 标签：c#, list, class-hierarchy

在我提出问题之前，这是我的代码结构的示例：

```
abstract class Entity
{
    #region Declarations
    public string Name;
    public string Description;
    #endregion

    #region Constructor
    public Entity(string Name, string Description)
    {
        this.Name = Name;
        this.Description = Description;
    }
    #endregion
}

abstract class Item : Entity
{
    #region Declarations
    public bool SingleUse;
    #endregion

    #region Constructor
    public Item(string Name, string Description, bool SingleUse = false)
        :base(Name, Description)
    {
        this.SingleUse = SingleUse;
    }
    #endregion

    #region Public Methods
    public void NoUse()
    {
        Program.SetError("There is a time and place for everything, but this is not the place to use that!");
    }
    #endregion
}

class BrassKey : Item
{
    public BrassKey(string Name, string Description, bool SingleUse = false)
        :base(Name, Description, SingleUse)
    {
    }

    public void Use()
    {
        if (Player.Location == 2)
        {
            Program.SetNotification("The key opened the lock!");
            World.Map[2].Exits.Add(3);
        }
        else
        {
            NoUse();
            return;
        }
    }
}

class ShinyStone : Item
{
    public ShinyStone(string Name, string Description, bool SingleUse = false)
        : base(Name, Description, SingleUse)
    {
    }

    public void Use()
    {
        if (Player.Location == 4)
        {
            Player.Health += Math.Min(Player.MaxHealth / 10, Player.MaxHealth - Player.Health);
            Program.SetNotification("The magical stone restored your health by 10%!");
        }
        else
        {
            Program.SetNotification("The shiny orb glowed shiny colors!");
        }
    }
}

class Rock : Item
{
    public Rock(string Name, string Description, bool SingleUse = false)
        : base(Name, Description, SingleUse)
    {
    }

    public void Use()
    {
        Program.SetNotification("You threw the rock at a wall. Nothing happened.");
    }
} 
```

`Item`然后我在我的`World`类中构造一个对象列表。列表中的每个对象都属于它的类型。

```
public static List<Item> Items = new List<Item>();

private static void GenerateItems()
{
    Items.Add(new BrassKey(
        "Brass Key",
        "Just your generic key thats in almost every game.",
        true));

    Items.Add(new ShinyStone(
        "Shiny Stone",
        "Its a stone, and its shiny, what more could you ask for?"));

    Items.Add(new Rock(
        "Rock",
        "It doesn't do anything, however, it is said that the mystical game designer used this for testing."));
} 
```

然后我怎么能像这样调用每个特定项目类的使用方法：

```
World.Items[itemId].Use(); 
```

如果您对我的问题有什么不明白的地方，请随时问我！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T21:37:27.227

在您的 ItemClass 中定义 Use Method 并将其标记为虚拟。然后在你的子类中将该方法标记为覆盖，你应该能够做你想做的事

# java - 修改我的 java swing 计算器的图形

> ID：10964742
> 
> 赞同：0
> 
> 时间：2012-06-09T21:33:07.617
> 
> 标签：java, swing, graphics, jbutton, calculator

我最近在修改挥杆计算器上的按钮大小时遇到​​了问题。如果你运行它，你会看到一个几乎和普通 Windows 计算器一样好用的计算器。但我试图让它看起来**完全**像一个普通的 Windows 计算器。我已经记下了代码，我有几个问题。

1.  如果你按两次equals，你会发现文本上的数字将被设置为零。有人可以给我一个提示来解决这个问题吗？
2.  如果您按下两个连续的功能（exe. add 然后相乘），您会看到它通常执行第一个功能。它应该执行第二个功能。再一次，有人可以给我一个提示来解决这个问题吗？
3.  Ggraphics：你如何调整按钮的大小？我尝试调用buttons.resize()，它应该像在java API中一样工作，但由于某种原因它没有效果。
4.  如何将按钮上的文本设置为不同的颜色？

顺便说一句，我希望有人先回答图形问题，我相信我可以自己弄清楚功能。

```
 import java.awt.BorderLayout;
   import java.awt.Color;
   import java.awt.Container;
   import java.awt.FlowLayout;
   import java.awt.GridLayout;
   import java.awt.event.ActionEvent;
   import java.awt.event.ActionListener;
   import javax.swing.*;
   import java.awt.GridBagConstraints;
   import java.awt.Dimension;

    public class Calculator extends JFrame implements ActionListener
   {  
      JButton button1 = new JButton("1");
      JButton button2 = new JButton("2");
      JButton button3 = new JButton("3");
      JButton button4 = new JButton("4");
      JButton button5 = new JButton("5");
      JButton button6 = new JButton("6");
      JButton button7 = new JButton("7");
      JButton button8 = new JButton("8");
      JButton button9 = new JButton("9");
      JButton button0 = new JButton("0");

      JButton buttonAdd = new JButton("+");
      JButton buttonSub = new JButton("-");
      JButton buttonMult = new JButton("*");
      JButton buttonDiv = new JButton("/");
      JButton buttonEquals = new JButton("=");
      JButton buttonClear = new JButton("C");

      JButton plusOrMinus = new JButton("+/-");
      JButton decimal = new JButton(".");
      JButton squareRoot = new JButton("sqrt.");
      JButton inverse = new JButton("1/x");
      JButton mod = new JButton("%");
      JButton backSpace = new JButton("Backspace");
      JButton clearE = new JButton("CE");

      JButton memoryClear = new JButton("MC");
      JButton memoryRecall = new JButton("MR");
      JButton memoryStore = new JButton("MS");
      JButton memoryAdd = new JButton("M+");

      JPanel jBack = new JPanel();
      JLabel output = new JLabel("0");
      JPanel jSpacing = new JPanel();
      JPanel jMstr = new JPanel();
      JPanel buttonSpace = new JPanel();

      double firstNumber, memoryNumber;
      String opera = "0";
      boolean clear;

       public Calculator()
      {     
         output.setHorizontalTextPosition(JLabel.RIGHT);
         output.setBackground(Color.WHITE);
         output.setOpaque(true);

         getContentPane().add(output, BorderLayout.NORTH);

         jBack.setLayout(new GridLayout(1, 1, 2, 2));
         jBack.add(backSpace);

         jSpacing.setLayout(new GridLayout(1, 2, 2, 2));        
         jSpacing.add(clearE);
         jSpacing.add(buttonClear);

         buttonSpace.setLayout(new GridLayout(4, 5, 2, 2));

         buttonSpace.add(memoryClear);   
         buttonSpace.add(button7);
         buttonSpace.add(button8);
         buttonSpace.add(button9);
         buttonSpace.add(buttonDiv);
         buttonSpace.add(squareRoot);

         buttonSpace.add(memoryRecall);   
         buttonSpace.add(button4);
         buttonSpace.add(button5);
         buttonSpace.add(button6);
         buttonSpace.add(buttonMult);
         buttonSpace.add(inverse);

         buttonSpace.add(memoryStore);         
         buttonSpace.add(button1);
         buttonSpace.add(button2);
         buttonSpace.add(button3);
         buttonSpace.add(buttonSub);
         buttonSpace.add(mod);

         buttonSpace.add(memoryAdd);
         buttonSpace.add(button0);
         buttonSpace.add(plusOrMinus);
         buttonSpace.add(decimal);
         buttonSpace.add(buttonAdd);
         buttonSpace.add(buttonEquals);

         jMstr.setLayout(new BorderLayout());
         jMstr.add(jBack, BorderLayout.WEST);
         jMstr.add(jSpacing, BorderLayout.EAST);
         jMstr.add(buttonSpace, BorderLayout.SOUTH);

         getContentPane().add(jMstr, BorderLayout.SOUTH);

         button1.addActionListener(this);
         button2.addActionListener(this);
         button3.addActionListener(this);
         button4.addActionListener(this);
         button5.addActionListener(this);
         button6.addActionListener(this);
         button7.addActionListener(this);
         button8.addActionListener(this);
         button9.addActionListener(this);
         button0.addActionListener(this);

         buttonAdd.addActionListener(this);
         buttonSub.addActionListener(this);
         buttonMult.addActionListener(this);
         buttonDiv.addActionListener(this);
         buttonEquals.addActionListener(this);
         buttonClear.addActionListener(this);

         plusOrMinus.addActionListener(this);
         decimal.addActionListener(this);
         squareRoot.addActionListener(this);
         inverse.addActionListener(this);
         mod.addActionListener(this);
         backSpace.addActionListener(this);
         clearE.addActionListener(this);

         memoryClear.addActionListener(this);
         memoryRecall.addActionListener(this);
         memoryStore.addActionListener(this);
         memoryAdd.addActionListener(this);

         try
         {
            UIManager.setLookAndFeel("com.sun.java.swing.plaf.windows.WindowsLookAndFeel");
         }

             catch(Exception e)
            {
            }       

         SwingUtilities.updateComponentTreeUI(jMstr);       
      }

       public void actionPerformed(ActionEvent e)
      {
         double result = 0;

         if(e.getSource() == buttonEquals)
         {
            processEquals();
         }

         if(e.getSource() == button0)
         {
            putDigitOnLabel(0);
         }

         if(e.getSource() == button1)
         {
            putDigitOnLabel(1);
         }

         if(e.getSource() == button2)
         {
            putDigitOnLabel(2);
         }

         if(e.getSource() == button3)
         {
            putDigitOnLabel(3);
         }

         if(e.getSource() == button4)
         {
            putDigitOnLabel(4);
         }

         if(e.getSource() == button5)
         {
            putDigitOnLabel(5);
         }

         if(e.getSource() == button6)
         {
            putDigitOnLabel(6);
         }

         if(e.getSource() == button7)
         {
            putDigitOnLabel(7);
         }

         if(e.getSource() == button8)
         {
            putDigitOnLabel(8);
         }

         if(e.getSource() == button9)
         {
            putDigitOnLabel(9);
         }

         if(e.getSource() == plusOrMinus)
         {
            changeSign();
         }

         if(e.getSource() == decimal)
         {
            addDecimalPoint();
         }

         if(e.getSource() == buttonDiv)
         {
            if(getNumberInDisplay() == 0)
            {
               output.setText("Cannot divide a number by zero.");
            }
            operation("/");
         }

         if(e.getSource() == buttonMult)
         {
            operation("*");
         }

         if(e.getSource() == buttonSub)
         {
            operation("-");
         }

         if(e.getSource() == buttonAdd)
         {
            operation("+");
         }

         if(e.getSource() == squareRoot)
         {
            if(getNumberInDisplay() < 0)
            {
               output.setText("Cannot take the square root of a negative number.");
            }

            double num = Math.sqrt(Double.parseDouble(output.getText()));
            output.setText(Double.toString(num));

         }

         if(e.getSource() == inverse)
         {
            if(getNumberInDisplay() == 0)
            {
               output.setText("Cannot take the inverse of the number zero");
            }
            double num = 1/( Double.parseDouble(output.getText()));
            output.setText(Double.toString(num));
         }

         if(e.getSource() == mod)
         {
            result = getNumberInDisplay() / 100;
            displayResult(result);
         }

         if(e.getSource() == backSpace)
         {

     setTextOnOutput(getStringOnDisplay().substring(0, getStringOnDisplay().length()-1));   

         }

         if(e.getSource() == clearE)
         {
            clearEverythingButOperation();
         }

         if(e.getSource() == buttonClear)
         {
            clearEverything();
         }  

         if(e.getSource() == memoryRecall)
         {
            displayResult(memoryNumber);
         }

         if(e.getSource() == memoryStore)
         {
            memoryNumber = getNumberInDisplay();
         }

         if(e.getSource() == memoryAdd)
         {
            memoryNumber += getNumberInDisplay();
         }   

         if(e.getSource() == memoryClear)
         {
            memoryNumber = 0;
         }                          
      } 

       public void setTextOnOutput(String s)
      {
         output.setText(s);
      }

       public String getStringOnDisplay()
      {
         return output.getText();
      }

       public void putDigitOnLabel(int digit)
      {
         if(clear == true)
         {
            output.setText("");
         }

         if(getStringOnDisplay().indexOf("0") == 0)
         {
            setTextOnOutput(getStringOnDisplay().substring(1));
         }

         output.setText(getStringOnDisplay() + digit);

         clear = false;
      }     

       public void addDecimalPoint()
      {
         if(clear == true)
         {
            setTextOnOutput("");
         }

         if(getStringOnDisplay().indexOf(".") == -1)
         {
            setTextOnOutput(new String(getStringOnDisplay() + "."));
         }
      }

       public void changeSign()
      {
         if(Double.parseDouble(output.getText()) < 0)
         {
            setTextOnOutput(getStringOnDisplay().substring(1));
         }

         if(Double.parseDouble(output.getText()) > 0)
         {
            setTextOnOutput(Double.toString(getNumberInDisplay() * -1));
         }    
      } 

       public void clearEverythingButOperation()
      {
         setTextOnOutput("0");
         clear = true;      
      }

       public void clearEverything()
      {
         setTextOnOutput("0");
         opera = "0";
         firstNumber = 0;
         clear = true;
      }

       public double getNumberInDisplay()
      {
         String stuff = output.getText();
         return Double.parseDouble(stuff);
      }

       public void operation(String s)
      {      
         double number = getNumberInDisplay();

         if(!(opera.equals("0")))
         {         
            double result = processOperator();
            displayResult(result);
            firstNumber = result;
         }

         else
         {
            firstNumber = number;
         }

         clear = true;
         opera = s;
      }

       public void processEquals()
      {
         double result;

         result = processOperator();
         displayResult(result);

         opera = "0";
      }

       public double processOperator()
      {    
         double answer = 0;
         double number = getNumberInDisplay();

         if(opera.equals("*"))
         {

            answer = firstNumber * number;
         }

         if(opera.equals("-"))
         {
            answer = firstNumber - number;
         }

         if(opera.equals("+"))
         {
            answer = firstNumber + number;
         }

         if(opera.equals("/"))
         {
            answer = firstNumber / number;
         }

         return answer;
      }

       public void displayResult(double result)
      {
         setTextOnOutput(Double.toString(result));
         firstNumber = result;
         clear = true;
      }

       public static void main(String args[])
      {
         Calculator f= new Calculator();
         f.setTitle("Windows Calculator");
         f.setSize(300, 300);
         f.pack();
         f.setVisible(true);
         f.setResizable(false);
      } 
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:34:11.740

要更改组件的默认字体，您可以尝试使用 UIManager 方法，但您需要了解这些方法可能非常依赖外观，因此可能不适用于每个 L&F。例如，如果您希望 JButtons 具有更大的字体，您可以这样做：

```
Font btnFont = UIManager.getFont("Button.font");
float fontSize = 16f;
btnFont = btnFont.deriveFont(fontSize);
UIManager.put("Button.font", btnFont); 
```

我相信这可能需要在创建任何 JButton 之前调用。因此，调用它的一个地方可能是在创建 Calculator 对象之前的 main 方法中，或者另一个地方可能是在静态初始化程序块内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T22:26:20.777

回答 1 和 2：

您需要更好地跟踪您的操作员，可能在堆栈中或存储您需要的信息，直到您想要“清除”历史记录。这是一个制作类似程序的在线示例。

[Java：示例 - 简单计算器](http://www.leepoint.net/notes-java/examples/components/calculator/calc.html)

以下是有关代码中所需更改的一些细节...

在`processEquals()`函数的第 415 行，清除`opera`变量。这使得第二次按下等号什么也不做。如果您注释掉该行，它应该会更好。

在您的`operation(String)`函数的第 390 行，您可以`NumberInTheDisplay()`在操作中使用 for，但如果他们决定单击等号两次，您就不会坚持下去。您需要存储此值并使其可用于`processEquals()`.

通常，在进行故障排除或添加功能时，确定当前行为，确定所需行为并将差异分解为可管理的块。

还要为特定的功能和行为做一组单元测试，这样你就可以知道它什么时候工作，什么时候不工作。

除此之外，您将需要自己调试它。祝你好运。

回答3：

[如何使用 GridLayout 设置组件大小？有没有更好的办法？](https://stackoverflow.com/questions/4699892/how-to-set-the-component-size-with-gridlayout-is-there-a-better-way)

回答4：

[如何在 Java GUI 中设置按钮的背景颜色？](https://stackoverflow.com/questions/4172940/how-to-set-background-color-of-a-button-in-java-gui)

# .htaccess - 带有 LDAP 身份验证的 dokuwiki

> ID：10964746
> 
> 赞同：1
> 
> 时间：2012-06-09T21:33:47.357
> 
> 标签：.htaccess, ldap, openldap, dokuwiki

我已经在我的工作场所设置了 dokuwiki。我想将身份验证设置为 LDAP，但我无法让它工作。我的公司正在使用 OpenLDAP。

我不确定这是否可能，因为我可能没有足够的关于 LDAP 设置的信息。在我们的 FTP 服务器上，我们使用 .htaccess 进行身份验证

```
AuthType Basic
AuthName "Authentication"
AuthAuthoritative off
AuthLDAPURL "ldap://ldapref.domain.xx.xy/dc=domain,dc=xx,dc=xy?uid"
require valid-user 
```

我总是收到以下错误：

> LDAP：无法连接到 LDAP 服务器

我希望我能以某种方式简单地使用 dokuwiki 中的 .htaccess 设置通过 LDAP 进行身份验证。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T11:29:57.847

使用该`ldapsearch`工具来验证运行 LDAP 客户端的主机是否可以访问服务器，并进一步验证 LDAP 客户端是否可以进行身份​​验证。使用以下效果：

```
ldapsearch -H ldap://ldapref.domain.xx.xy \
  -b dc=domain,dc=xx,xy=at -s sub -x -LLL \
  '(uid=<the-user-id-to-authenticate>)' 1.1 
```

由于问题提到了 OpenLDAP，上述命令假定使用旧版 OpenLDAP 搜索语法。

如果搜索成功，则 LDAP 客户端应该能够使用相同的参数进行连接和验证。理想情况下，该`ldapsearch`工具应该在向 LDAP 服务器进行身份验证的同一系统上执行。

### 也可以看看

*   [LDAP：使用 ldapsearch](http://ff1959.wordpress.com/2011/07/27/mastering-ldapsearch/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-12T18:56:37.070

您在那里获得的信息应该足以配置至少部分 authldap 插件的日志记录。见[https://www.dokuwiki.org/plugin:authldap](https://www.dokuwiki.org/plugin:authldap)

当您使用相对常见的 OpenLDAP 设置时，组设置也应该相对简单。

此设置可能对您有用：

```
<?php
/* OpenLDAP config */
$conf['plugin']['authldap']['server']      = 'ldapref.domain.xx.xy';
$conf['plugin']['authldap']['usertree']    = 'uid=%{user}, ou=People,dc=domain,dc=xx,dc=xy';
$conf['plugin']['authldap']['grouptree']   = 'ou=Groups,dc=domain,dc=xx,dc=xy';
$conf['plugin']['authldap']['groupfilter'] = '(&(objectClass=posixGroup)(|(memberUid=%{uid})(gidNumber=%{gid})))'; 
```

# css - 图库在 IE7 中有太多的填充

> ID：10964747
> 
> 赞同：0
> 
> 时间：2012-06-09T21:34:17.620
> 
> 标签：css, internet-explorer, image-gallery

我的 Flickr 画廊在除 IE 7 之外的所有浏览器中看起来都不错。我还需要在我的 CSS 代码中添加什么才能使它在 IE 7 中看起来不那么不平衡。我添加了`display: block`但它没有做任何事情。

```
a img {
    display: block;
    *display: inline-block;
    float: left;
    border: none;
    padding: 3px; 
    background-color: #fff; 
    border: 1px solid green; 
    margin-right: 15px; 
    margin-bottom: 15px; 
} 
```

现在它看起来像这样。

![填充过多的 Flickr 页面的屏幕截图](../Images/a425b1f10d422d8aa610a2e90c7fb676.png)

我在 CSS 上做错了什么吗？我应该为 IE 添加一些东西以便它可以正确读取吗？

[这是我的网站](http://fhlsociety.ca)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:44:24.637

这看起来很像 ie step down 错误。

你试过添加`display: inline`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T00:44:01.233

我进行了更多搜索，发现了一个 IE bug arcticle，您必须确保父元素中的 line-height 设置为零。

# jquery - 如何访问 jquery 对象中的元素？

> ID：10964753
> 
> 赞同：1
> 
> 时间：2012-06-09T21:35:09.917
> 
> 标签：jquery

我有一个基本的 jQuery 问题。我从一个字符串中得到一个 jquery 对象：

```
var o = $(html_in_string) 
```

在这个 jquery 对象中，有一个我想要访问的元素。如果我有那个元素的 id，我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T21:36:25.697

如果我理解正确的话，`html_in_string`是一个包含 html 的字符串。在这种情况下，您可以使用`find()`.

```
var o = $(html_in_string).find("#some-id") 
```

# c++ - SSL 证书，不通过 thrift 进行身份验证，但可以通过浏览器进行身份验证

> ID：10964755
> 
> 赞同：8
> 
> 时间：2012-06-09T21:35:17.953
> 
> 标签：c++, ssl, openssl, thrift

这就是我生成 SSL 证书、密钥等的方式：

```
openssl genrsa -out server.key 1024
openssl rsa -in server.key -out new_key.pem
openssl req -new -key server.key -out server.csr
openssl x509 -req -days 10000 -in server.csr -signkey new_key.pem -out server.crt 
```

这行得通，我可以在 chrome 中看到输出，尽管我收到警告说我将首先感染病毒。

```
openssl s_server -cert server.crt -www -key new_key.pem 
```

这是来自服务器的片段。老实说，我不确定每一行都在做什么，尽管我有一个好主意：

```
socketFactory->server(true); // this is the server
socketFactory->authenticate(false); // no auth?
socketFactory->loadCertificate("server.crt"); 
socketFactory->loadPrivateKey("new_key.pem"); 
```

客户：

```
socketFactory->loadTrustedCertificates("server.crt");
socketFactory->authenticate(true); //auth? wierd, right? This guy does this:[1] 
```

[1] [http://permalink.gmane.org/gmane.comp.lib.thrift.user/1651](http://permalink.gmane.org/gmane.comp.lib.thrift.user/1651)

如果我在客户端中注释掉`loadTrustedCertificates`，那么我会得到一个 SSL 未经验证的证书异常。留下那条线，我得到一个身份验证失败异常。

这里有 2 个更长的代码片段，可以更好地了解上面的片段。
服务器：

```
shared_ptr<SkullduggeryHandler> handler(new SkullduggeryHandler());
shared_ptr<TBufferedTransportFactory> transportFactory =
        shared_ptr<TBufferedTransportFactory>(new TBufferedTransportFactory());
shared_ptr<TProtocolFactory> protocolFactory(new TBinaryProtocolFactory());
shared_ptr<TProcessor> processor(new SkullduggeryProcessor(handler));
shared_ptr<TSSLSocketFactory> socketFactory = 
      shared_ptr<TSSLSocketFactory>(new TSSLSocketFactory());
socketFactory->server(true);
socketFactory->authenticate(false);
socketFactory->loadCertificate("server.crt");
socketFactory->loadPrivateKey("new_key.pem");
shared_ptr<TSSLServerSocket> socket(new TSSLServerSocket(port, socketFactory));
TThreadedServer server(processor,
                               socket,
                               transportFactory,
                               protocolFactory);
server.serve(); 
```

客户：

```
shared_ptr <TSSLSocketFactory> socketFactory = shared_ptr<TSSLSocketFactory>(new TSSLSocketFactory());
socketFactory->loadTrustedCertificates("server.crt");
socketFactory->authenticate(false);
shared_ptr <TSSLSocket>socket = socketFactory->createSocket(configuration.ip, configuration.port);
shared_ptr<TBufferedTransport> transport(new TBufferedTransport(socket));
shared_ptr<TProtocol> protocol(new TBinaryProtocol(transport));
SkullduggeryClient client(protocol);
transport->open(); 
```

感谢您抽时间阅读。如果有明显的错误，我会很高兴听到的。这一直是我存在的祸根太久了。太长。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-03T21:59:36.167

您似乎正在生成自签名证书（这很好），但是您使用该`openssl`实用程序进行的操作令人困惑。

第 1 行没问题，它生成一个私钥。
第2行没用：输出键和输入键一样！（试试看`diff`这两个键）。
第 3 行生成一个 CSR，第 4 行实际上是对它进行自签名，因此我们可以将它们合并到一行中。

现在，让我们退后一步，试着理解我们在做什么:-)

您正在使用 SSL 对 Thrift 服务器和 Thrift 客户端之间的通信进行身份验证和加密。我假设你想要两者：

1.  保护客户端免受恶意服务器的侵害（您的代码试图做什么）
2.  保护服务器免受恶意客户端的侵害（这对我来说似乎更重要）。

打个比方 HTTPS，(1) 是经典的服务器证书，(2) 通常是用户的用户名/密码。但是使用 Thrift SSL，我们将通过向客户端颁发证书来获得相互身份验证。

我将制作的示例将使用自签名证书。它们可以很容易地适应由 openssl 管理的迷你 CA，我将其作为练习留给读者。

生成服务器私钥：
`openssl genrsa -out server-key.pem 2048`

生成关联的公钥并对其进行自签名：
`openssl req -new -x509 -key server-key.pem -out server-cert.pem -days 10000`

生成客户端私钥：
`openssl genrsa -out client-key.pem 2048`

生成关联的公钥并对其进行自签名：
`openssl req -new -x509 -key client-key.pem -out client-cert.pem -days 10000`

注意：当`openssl req`要求输入时`"Common Name (e.g. server FQDN or YOUR name)"`，输入 Thrift 程序将在其上运行的主机的 FQDN。这将允许不自定义 Thrift 的`AccessManager`类。另一方面，如果无法预先知道 FQDN，则需要相应地继承`AccessManager`和覆盖`verify()`方法。见`TSSLSocket.cpp`。

好，现在到代码。

在服务器端：

`socketFactory->server(true);`是多余的，删除它。

`socketFactory->authenticate(false)`有点误导。一个更好的名字本来是`authenticatePeer`。如果你说`false`，它不会对客户端进行身份验证，但我们在需要相互身份验证之前就决定了。

因此，服务器的 SSL 前导码是：

```
try {
    signal(SIGPIPE, SIG_IGN); // See README.SSL
    shared_ptr<TSSLSocketFactory> sslSocketFactory(new TSSLSocketFactory());
    sslSocketFactory->loadPrivateKey(myKey);
    sslSocketFactory->loadCertificate(myCert);
    sslSocketFactory->authenticate(true);
    sslSocketFactory->loadTrustedCertificates(trustedCerts);
    sslSocketFactory->ciphers("HIGH:!DSS:!aNULL@STRENGTH");
    ...
    } catch (TException& tx) {
        ....
    } 
```

where `myKey`is `server-key.pem`, `myCert`is `server-cert.pem`and `trustedCerts`is... 受信任 CA 的证书，或者，如果是自签名证书，则为客户端的证书。您可以`cat`在同一个文件中一个接一个地多个证书。在我们的示例中，我们将放置`client-cert.pem`我们之前创建的内容。

客户端的 SSL 前导码完全相同，具有正确的客户端私钥、客户端证书以及对`trustedCerts`等方的证书：`server-cert.pem`我们之前创建的。

就是这样 :-) 在开始编写代码之前尝试理解，如果您不清楚 SSL（相互）身份验证的工作原理，则很难理解错误消息。我展示的代码经过测试可以正常工作。

文档方面，不幸的是，Thrift 几乎没有。对于 SSL，您可以看到`lib/cpp/README.SSL`：`test/cpp/src/TestServer.cpp`和`test/cpp/src/TestClient.cpp`. 请注意，`TestServer.cpp`不进行相互身份验证，恕我直言，这是一个错误。

# c# - 从 .NET 向 Java webservice 发送 XML 字符串时遇到问题

> ID：10964757
> 
> 赞同：0
> 
> 时间：2012-06-09T21:35:24.060
> 
> 标签：c#, java, windows-phone-7, webservice-client

我正在尝试将一个非常基本的 XML 字符串从 Windows Phone 应用程序发送到使用 Java-WS（和 Provider 实现）运行的 Web 服务，并检索响应。我可以看到该字符串成功（通过服务器上的 TCP 监视器）并且看起来正确，但 Web 服务立即引发异常，指出源对象为空。请注意，使用 Java 作为客户端，我可以获得响应（与 TCP 监视器中列出的相同请求字符串），尽管我的实现略有不同。以下是我在 .NET 中的操作方式：

```
 string req = "<?xml version='1.0' encoding='UTF-8'?><request><requestor>WP7.1</requestor></request>";
 string url = "http://mywebservice/endpoint1test";

 WebClient wc = new WebClient();
 wc.Headers["ContentType"] = "text/xml";            
 wc.UploadStringCompleted += new UploadStringCompletedEventHandler(wc_UploadStringCompleted);
 wc.UploadStringAsync(new Uri(url), "POST", req);

void wc_UploadStringCompleted(object sender, UploadStringCompletedEventArgs e)
{
    Debug.WriteLine("Web service says: " + e.Result);
} 
```

结果始终为空字符串，因为服务器在异常时返回 null。我觉得我错过了一些简单的东西，比如标题或编码。如果它有用，这里是可用的客户端的 Java 版本：

```
 String data = "<?xml version='1.0' encoding='UTF-8'?><request><requestor>WP7.1</requestor></request>";

    // Send data
    URL url = new URL(testUrl);
    java.net.URLConnection conn = url.openConnection();
    conn.setDoOutput(true);
    conn.setRequestProperty("Content-Type","text/xml");
    OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
    wr.write(data);
    wr.close();

    // Get the response
    BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
    String line;
    while ((line = rd.readLine()) != null) {
        System.out.println(line);
    }
    rd.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T12:32:05.090

您必须更改此行：

```
wc.Headers["Content-Type"] = "text/xml"; 
```

你应该注意到你错过了一个破折号=）

# google-app-engine - 从 Appengine 下载数据

> ID：10964759
> 
> 赞同：6
> 
> 时间：2012-06-09T21:35:43.070
> 
> 标签：google-app-engine

我试图遵循这个解释： [https ://developers.google.com/appengine/docs/python/tools/uploadingdata#Downloading_and_Uploading_All_Data](https://developers.google.com/appengine/docs/python/tools/uploadingdata#Downloading_and_Uploading_All_Data)

但是当我添加到我的 app.yaml 中时：

```
- url: /remote_api
  script: $PYTHON_LIB/google/appengine/ext/remote_api/handler.py
  login: admin 
```

并尝试更新我的应用程序，我得到：

> 解析 yaml 文件时出错：对象无效：无法使用 CGI 处理程序启用线程安全：$PYTHON_LIB/google/appengine/ext/remote_api/handler.py

错误。

我究竟做错了什么？

谢谢！

顺便说一句，这是我的 app.yaml：

```
application: XXXX-my-application-name
version: 1
runtime: python27
api_version: 1
threadsafe: true

handlers:
- url: /static
  static_dir: static

- url: /remote_api
  script: $PYTHON_LIB/google/appengine/ext/remote_api/handler.py
  login: admin

- url: /favicon.ico
  static_files: static/favicon.ico
  upload: static/favicon.ico

- url: /.*
  script: main.app  # a WSGI application in the main module's global scope

libraries:
- name: django
  version: "1.3" 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-09T21:49:26.410

尝试类似的东西

```
- url: /remote_api
  script: google.appengine.ext.remote_api.handler.application
  login: admin 
```

这将使用 WSGI 应用程序而不是 main() 方法 CGI 样式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-10T05:57:51.077

除非您正在做一些非常特别的事情，否则您不应该更改远程 url。

只需将以下内容放入 app.yaml 中：

```
builtins:
- remote_api: on 
```

# php - 国际化 webapp javascript

> ID：10964766
> 
> 赞同：0
> 
> 时间：2012-06-09T21:37:42.150
> 
> 标签：php, javascript, ajax, internationalization, gettext

我正在开发一个 webapp，它使用自己的 API 来显示内容，它是通过 AJAX 实现的 javascript。
当我使用服务器端处理 (php) 时，我使用了 gettext，但现在我不知道如何翻译使用 javascript 生成的字符串。
我该怎么做？
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:40:26.737

如果您熟悉**Gettext**的使用，请使用它的 JS 实现

[http://jsgettext.berlios.de/](http://jsgettext.berlios.de/)

并通过调用 API 加载您的语言目录并`localStorage`用作缓存

# bash - 后台进程结束后杀死猫

> ID：10964767
> 
> 赞同：3
> 
> 时间：2012-06-09T21:37:58.023
> 
> 标签：bash, cat

在 Cent OS 下使用 mono 运行 C# 程序。有一个先进先出，允许外部输入进入该程序。

我还必须`cat`接受来自运行单声道程序的屏幕会话的输入。

```
#! /bin/bash -
echo "Starting server"
mono --gc=sgen Server-CLI.exe < $fifo &
echo $$ > $PIDFILE
cat > $fifo
echo "Server stopped. Cleaning up"
rm -f $fifo
rm -f $PIDFILE 
```

`cat`单声道程序退出时如何退出？现在，如果单声道程序退出，`cat`仍在运行，因此脚本永远不会到达 2nd `echo`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:12:02.113

保存 的 PID `mono`。在后台运行`cat`并保存其 PID。`wait`对于 的 PID `mono`。当满足这一点时，`kill`的 PID `cat`。

```
mono &
monoPID=$!
cat &
catPID=$!
wait "$monoPID"
kill "$catPID" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:10:15.890

你可以从$中得到它！

```
(cat > $fifo)& 
pid=$!

kill -9 "$pid" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T22:48:55.807

`cat`退出时不会立即死亡，`mono`因为它正在等待它的`stdin`. 一旦它有一些数据要发送，它就会带着`SIGPIPE`信号死掉，因为管道不再有连接到另一端的进程。

不幸的是，我不是一个坚定的`select`大师，所以我不知道是否有可能编写一个“更好”的版本`cat`来检查`stdin`并在另一端关闭时`stdout`立即死亡。`stdout`

# c# - 是否可以获得引用类型的变量名

> ID：10964768
> 
> 赞同：1
> 
> 时间：2012-06-09T21:38:30.190
> 
> 标签：c#

是否可以获得指向引用的变量的名称？举个例子：

```
private void FillArray(int[] array, int count)
{
    array = new int[count];

    for (int i = 0; i < array.Length; i++)
    {
        array[i] = i;
    }

    Debug.WriteLine("Array {0} is now filled up with {1} values", array.Name, count);
} 
```

`Name`将在上述方法中使用的数组没有属性。我知道一种解决方法是将另一个参数添加为字符串并为其分配名称，但是如何以编程方式执行此操作？我也知道我可以自己实现，但我很想知道这个特定问题的答案！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:40:20.767

> 是否可以获得指向引用的变量的名称？

否 - 可能有多个变量指向同一个引用。变量名与引用本身无关。

请注意，您*可以*使用表达式来获取属性的名称（可以是具有引用类型的支持字段的属性），使用类似于[此答案中](https://stackoverflow.com/a/672212/65358)的技术。在某些情况下，这可以避免要求您提供字符串，并简化重构，但受到限制（因为它只能通过属性等工作）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T21:40:37.270

> 是否可以获得指向引用的变量的名称？

不。

通常，可能有多个具有不同名称的变量都包含对同一对象的引用。运行时中没有存储这些名称的列表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T21:43:22.200

（本地）变量名称只是赋予存储位置的*语言名称。*编译后这些名称不再存在。所以一般来说，在运行时不可能得到*任何*变量名。

当然，对于可以查询类的字段、属性、方法和其他内容，这是不同的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-09T21:46:14.973

不，引用没有名称。

发送给方法的不是变量，而是变量值的引用。

如果甚至有一个变量，那就是。该方法也可以使用新创建的数组调用，因此根本没有变量：

```
FillArray(new int[4], 4) 
```

此外，您的方法将丢弃发送到其中的数组并创建一个新数组，因此您也可以在没有任何数组的情况下调用它：

```
FillArray(null, 4) 
```

您的方法不会更改变量以引用新数组，它只是丢弃新数组。您需要为此使用`ref`or`out`关键字：

```
private void FillArray(out int[] array, int count) {
  array = new int[count];
  for (int i = 0; i < array.Length; i++) {
    array[i] = i;
  }
} 
```

# caching - 清漆连接错误

> ID：10964769
> 
> 赞同：1
> 
> 时间：2012-06-09T21:38:32.163
> 
> 标签：caching, varnish, varnish-vcl

我有这个 vcl varnish 配置文件，但是当我想从应用程序服务器中清除它时它会引发错误。有什么问题吗？

我有 5 个应用程序服务器，除了管理员和论坛之外的所有内容都被缓存，但是，当我从应用程序服务器中清除用户时，它会引发此错误：无法在 192.168.11.41:6082 上连接到 varnishadm；“连接被拒绝”

```
backend app01 {
  .host = "app01.xxx.com";
  .port = "80";
  .connect_timeout = 0.7s;
  .first_byte_timeout = 30s;
  .between_bytes_timeout = 30s;
  .probe = {
    .url = "/";
    .interval = 5s;
    .timeout = 1s;
    .window = 5;
    .threshold = 3;
  }
}

backend app02 {
  .host = "app02.xxx.com";
  .port = "80";
  .connect_timeout = 0.7s;
  .first_byte_timeout = 30s;
  .between_bytes_timeout = 30s;
  .probe = {
    .url = "/";
    .interval = 5s;
    .timeout = 1s;
    .window = 5;
    .threshold = 3;
  }
}

backend app03 {
  .host = "app03.xxx.com";
  .port = "80";
  .connect_timeout = 0.7s;
  .first_byte_timeout = 30s;
  .between_bytes_timeout = 30s;
  .probe = {
    .url = "/";
    .interval = 5s;
    .timeout = 1s;
    .window = 5;
    .threshold = 3;
  }
}

backend app04 {
  .host = "app04.xxx.com";
  .port = "80";
  .connect_timeout = 0.7s;
  .first_byte_timeout = 30s;
  .between_bytes_timeout = 30s;
  .probe = {
    .url = "/";
    .interval = 5s;
    .timeout = 1s;
    .window = 5;
    .threshold = 3;
  }
}

backend app05 {
  .host = "app05.xxx.com";
  .port = "80";
  .connect_timeout = 0.7s;
  .first_byte_timeout = 30s;
  .between_bytes_timeout = 30s;
  .probe = {
    .url = "/";
    .interval = 5s;
    .timeout = 1s;
    .window = 5;
    .threshold = 3;
  }
}

director app_director round-robin {
  { .backend = app01; }
  { .backend = app02; }
  { .backend = app03; }
  { .backend = app04; }
  { .backend = app05; }   
}

#acl internal {
#  "localhost";
#  "127.0.0.1";
#}

acl purge {
        "localhost";
        "192.168.11.0"/24;
}

sub vcl_recv {

  if (req.request == "PURGE") {
    if (!client.ip ~ purge) {
      error 405 "Not allowed.";
    }
    return (lookup);
  }

  # Normalize the host header
  # --
  if (req.http.Host ~ "(?i)^(www.)?xxx.com") {
    set req.http.host = "www.xxx.com";
  }

  # Admin needs no cache
  # --
  if (req.http.Host ~ "(?i)^(admin.)?xxx.com") {
    return (pass);
  }

  # Requests to /no-cache/ needs no cache
  # --
  if (req.request == "GET" && req.url ~ "^/no-cache/") {
    return (pass);
  }
  if (req.request == "GET" && req.url ~ "^/rss/xxx/") {
    return (pass);
  }

  # xx.xxx.com and xxx.com/foro/ needs no cache
  # --
  if (req.http.host == "xx.xxx.com" || (req.http.host == "www.xxx.com" && req.url ~ "^/foro/" && req.http.Cookie ~ "(?i)(cookieAdmin)") ) {
    return (pass);
  } 

  set req.backend = app_director;

  # Use anonymous, cached pages if all backends are down.
  if (! req.backend.healthy) {
    unset req.http.Cookie;
    set req.grace = 1h;
  } else {
    set req.grace = 30s;
  }

  # Add the X-Forwarded-For header
  # --
  if (req.restarts == 0) {
    if (req.http.x-forwarded-for) {
      set req.http.X-Forwarded-For = req.http.X-Forwarded-For + ", " + client.ip;
    } else {
      set req.http.X-Forwarded-For = client.ip;
    }
  }

  # Sanely handle the request based on the type
  # --
  if (req.request != "GET" &&
   req.request != "HEAD" &&
   req.request != "PUT" &&
   req.request != "POST" &&
   req.request != "TRACE" &&
   req.request != "OPTIONS" &&
   req.request != "DELETE") {
    /* Non-RFC2616 or CONNECT which is weird. */
    return (pipe);
  }

  # Not sure what could match here, but it's in the default.vcl
  # --
  if (req.request != "GET" && req.request != "HEAD") {
    /* We only deal with GET and HEAD by default */
    # PURGE
    return (pass);
  }

  # Always cache the following file types for all users.
  if (req.url ~ "(?i)\.(png|gif|jpeg|jpg|ico|swf|flv|avi|mov|wmv|css|js|html|htm)(\?[a-z0-9]+)?$") {
    unset req.http.Cookie;
    return (lookup);
  }

  # Handle compression correctly. Different browsers send different
  # "Accept-Encoding" headers, even though they mostly all support the same
  # compression mechanisms. By consolidating these compression headers into
  # a consistent format, we can reduce the size of the cache and get more hits.=
  # @see: http:// varnish.projects.linpro.no/wiki/FAQ/Compression
  if (req.http.Accept-Encoding) {
    if (req.http.Accept-Encoding ~ "gzip") {
      # If the browser supports it, we'll use gzip.
      set req.http.Accept-Encoding = "gzip";
    }
    else if (req.http.Accept-Encoding ~ "deflate") {
      # Next, try deflate if it is supported.
      set req.http.Accept-Encoding = "deflate";
    }
    else {
      # Unknown algorithm. Remove it and send unencoded.
      unset req.http.Accept-Encoding;
    }
  }

  # Cache all requests by default, overriding the standard Varnish behavior
  if (req.request == "GET" || req.request == "HEAD") {
    /* We only deal with GET and HEAD by default */
    unset req.http.Cookie;
    return (lookup);
  }

  # If there's a cookie left aft this point do not cache
  # or is this easier to keep in the cookie deletion above?
  # --
  if (req.http.Authorization || req.http.Cookie) {
    /* Not cacheable by default */
    return (pass);
  }

  # If we get here, try the cache
  # --
  return (lookup);

}

sub vcl_pipe {
  return (pipe);
}

sub vcl_pass {
  return (pass);
}

sub vcl_hash {
  # Include cookie in cache hash.
  # This check is unnecessary because we already pass on all cookies.
  #if (req.http.Cookie) {
  #  #set req.hash += req.http.Cookie;
  #  hash_data(req.http.Cookie);
  #}
}

sub vcl_hit {
  if (req.request == "PURGE") {
    set obj.ttl = 0s;
    error 200 "Purged";
  }
}

sub vcl_miss {
  if (req.request == "PURGE") {
    error 404 "Not in cache";
  }
}

sub vcl_fetch {

  # remove all cookies
  # unset beresp.http.set-cookie;

  # cache for 12 hours
  # set beresp.ttl = 2h;

  # Don't allow static files to set cookies.
  if (req.url ~ "(?i)\.(png|gif|jpeg|jpg|ico|swf|css|js|html|htm)(\?[a-z0-9]+)?$") {
    unset beresp.http.set-cookie;
    set beresp.ttl = 12h;
  } else {
    unset beresp.http.set-cookie;
    set beresp.ttl = 30m;
  }

  # If the backend server doesn't return properly, don't send another connection to it
  # for 60s and try another backend via restart.
  #
  # https://www.varnish-cache.org/docs/trunk/tutorial/handling_misbehaving_servers.html
  # --
  if(beresp.status == 500) {
    set beresp.saintmode = 5m;
    if (req.request != "POST") {
      return(restart);
    } else {
      error 500 "Failed";
    }
  }

  # Allow items to be stale if needed.
  set beresp.grace = 1h;

}

sub vcl_deliver {
 # if (resp.http.magicmarker) {
 #   unset resp.http.magicmarker;
 #   set resp.http.age = "0";
 # }

  if (obj.hits > 0) {
    set resp.http.X-Cache = "HIT";
  } else {
    set resp.http.X-Cache = "MISS";
  }
  return (deliver);
}

# In the event of an error, show friendlier messages.
sub vcl_error {
  # Otherwise redirect to the homepage, which will likely be in the cache.
  set obj.http.Content-Type = "text/html; charset=utf-8";
  synthetic {"
<html>
<head>
  <title>Page Unavailable</title>
  <style>
    body { background: #303030; text-align: center; color: white; }
    #page { border: 1px solid #CCC; width: 500px; margin: 100px auto 0; padding: 30px; background: #323232; }
    a, a:link, a:visited { color: #CCC; }
    .error { color: #222; }
  </style>
</head>
<body onload="setTimeout(function() { window.location = '/' }, 5000)">
  <div id="page">
    <h1 class="title">Page Unavailable</h1>
    <p>The page you requested is temporarily unavailable.</p>
    <p>We're redirecting you to the <a href="/">homepage</a> in 5 seconds.</p>
    <div class="error">(Error "} + obj.status + " " + obj.response + {")</div>
  </div>
</body>
</html>
"};
  return (deliver);
}

sub vcl_init {
  return (ok);
}

sub vcl_fini {
  return (ok);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T21:07:18.080

仅通过将 app01-app06 添加到 httpd.conf 文件来修复此错误

# vb.net - 在实体框架中，我们可以先使用模型，先使用数据库，先使用代码，但是我们如何以编程方式创建表

> ID：10964772
> 
> 赞同：0
> 
> 时间：2012-06-09T21:39:14.833
> 
> 标签：vb.net, entity-framework, c#-4.0, ado.net, dynamically-generated

在**实体框架**中，我们可以使用**模型优先，代码优先，数据库优先**3种方法，但每种方法都需要手动触摸（意味着创建数据库或创建模型或编写POCO类代码或实体类代码）才能进行下一步（在上下文中使用 EF）。

**如果我想以编程方式创建数据库和表以及表关系，并且仍然希望拥有 EntityFramework 4.3 的功能怎么办。**

更具体地说，从这个示例[http://support.microsoft.com/kb/307283](http://support.microsoft.com/kb/307283)我们可以使用 SQL 命令创建数据库、表和所有内容，但我们不能拥有实体框架的优势。那么如果我们想拥有它，我们应该怎么做呢？

**要赋予创建动态表字段的能力，这些步骤是不够的。在所有 3 个步骤中，数据库、表和表列都是固定的。用户无法动态创建新表或列。[http://support.microsoft.com/kb/307283](http://support.microsoft.com/kb/307283)在这篇文章中，它展示了如何使用 SQL 创建手动数据库、表等，但它基于 ADO.NET，但我希望实体管理器这样做。它不会是魔法，当然，应该有编程（我想知道编程方法）。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T08:48:37.550

我相信您希望能够使用 SQL 命令创建数据库和数据库对象。然后将这些对象映射到 EntityFramework 上下文。根据您的项目，您可以有多个从 DBContext 派生的上下文，每个上下文都执行一些特定的角色。

如果是这样，则 DbContext 中的 Database 类具有执行 SQL 的功能。简单地在您的上下文对象上调用这些函数。

```
MyContext db = new MyContext() 
//Where MyContext :DbContext (MyContext derives from DbContext)

db.Database.ExecuteSqlCommand(sqlcommand, params);
//There are other method in this class like SqlQuery Read documentation.
//The SqlQury is also available on the entities like db.MyEntitySet.SqlQuery(...) 
```

如果您希望您的 EF 代码与现有数据库一起使用，那么您可以关注[此博客](http://weblogs.asp.net/scottgu/archive/2010/08/03/using-ef-code-first-with-an-existing-database.aspx)

如果您希望您的上下文使用数据库名称，那么您可以在构造函数中传递它，如下所示。您可以尝试将此类上下文与现有数据库一起使用。

```
public class MyContext : DbContext
{
        public MyContext():base("MyDatabase")
        {

        }
     .....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T21:46:20.250

如果您使用 EF 的 Code First 方法，DatabaseInitializer 默认策略是“如果不存在则创建数据库”。因此，基于连接字符串，DbContext 将检查数据库是否存在。如果未找到，EF 将运行必要的脚本来第一次为您创建数据库、表和关系。要运行的脚本将根据您的模型（POCO 类和映射配置/数据注释）生成。

假设您要创建 2 个表：Customers 和 Orders。

```
public class Customer
{
    public int Id { get;set; }
    public string Name { get;set; }

    public ICollection<Order> Orders { get; set; }
}

public class Order
{
    public int Id { get; set; }
    public int CustomerId { get; set; }
    public virtual Customer Customer { get; set; }
    /* ... more fields*/
}

public class MyContext: DbContext
{
    public DbSet<Order> Orders { get; set; }
    public DbSet<Customer> Customers { get; set; }

    public MyContext(): base("MyConnectionString")
    {
    }

} 
```

当您实例化 MyContext 类时，将创建表、字段和外键约束：

```
using (var ctx = new MyContext())
{
    /**/
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T10:38:41.110

我支持 Abhijit 对此的回答。我假设您已经准备好 SQL 队列（表、SProcs 等）。

现在要创建编写 EF 查询，您只需要访问 EF 中的 dbcontext 类。正如我们在 LINQ 中所做的那样。

这是 MSDN mag 中的一篇不错的文章：http: [//msdn.microsoft.com/en-us/magazine/gg232765.aspx](http://msdn.microsoft.com/en-us/magazine/gg232765.aspx)

希望能帮助到你！

# xcode - 为什么 Xcode 的 Info.plist 询问我的星座？

> ID：10964786
> 
> 赞同：1
> 
> 时间：2012-06-09T21:41:25.227
> 
> 标签：xcode, plist

不知何故，我的项目的 Info.plist 不再显示正确的键下拉列表：

![破碎的列表](../Images/0ced2e81f0050f39679148abd0ea3873.png) 它只有所有行的这 6 个条目；包括添加的新行。我已经尝试重新启动 Xcode ...我什至尝试将“成功概率”设置为 100% ...：/

可能很有趣……有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T21:51:08.997

右键单击属性列表编辑器。有一个名为“属性列表类型”的菜单项。鼠标悬停于此。有一堆子类型。您可能将您的设置为“示例结构”或“示例结构（已定义完整的十二生肖）”。您要重新选择 Info.plist。

![在此处输入图像描述](../Images/44e4cfa0d93860e10b2288bc75728dfe.png)

# ruby - User.all.each_with_index 的另一种说法？

> ID：10964787
> 
> 赞同：0
> 
> 时间：2012-06-09T21:41:30.543
> 
> 标签：ruby, mongodb

我不知道为什么，但是这个循环在一个用户身上翻滚

```
User.all.each_with_index do |user, i| 
```

即使我只是执行此循环来打印电子邮件，我也会得到：

```
MONGODB cursor.refresh() for cursor xxx 
```

当我为此添加更多计算时，它变得致命：

```
MONGODB cursor.refresh() for cursor yyy
rake aborted!
Query response returned CURSOR_NOT_FOUND. Either an invalid cursor was specified 
```

你认为可能有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:53:43.253

如果这是一个长时间运行的循环，则光标可能超时。MongoDB 游标默认在 10 分钟后超时。看：

[https://groups.google.com/group/mongodb-user/browse_thread/thread/e532dbefce643531](https://groups.google.com/group/mongodb-user/browse_thread/thread/e532dbefce643531)

[如何在不超时的情况下使用 mongoid/rails 查询 mongodb？](https://stackoverflow.com/questions/4018838/how-can-i-query-mongodb-using-mongoid-rails-without-timing-out)

# c - RBG 到 CbyCr 转换代码

> ID：10964788
> 
> 赞同：0
> 
> 时间：2012-06-09T21:41:38.253
> 
> 标签：c

我想知道为什么这段代码不起作用。基本上它应该在 RGB 和 CbYCr 之间转换。当我从 RGB 转换为 CbYCr 然后再转换回 RGB 时，我没有得到原始的 RGB 值。这段代码有什么问题？

```
 #define MIN(a,b) (((a)<(b))?(a):(b))
#define MAX(a,b) (((a)>(b))?(a):(b))

struct _rgb {
`int R;`
`int G;`
`int B;`
};

typedef struct _rgb rgb;

struct _cbycr {
`int Cb;`
`int Y;`
`int Cr;`
};

typedef struct _cbycr cbycr;

void cbycr2rgb(rgb *c, double Y, double Cb, double Cr) {
`int r = (int)(Y + 1.40200 * (Cr - 0x80));`
`int g = (int)(Y - 0.34414 * (Cb - 0x80) - 0.71414 * (Cr - 0x80));`
`int b = (int)(Y + 1.77200 * (Cb - 0x80));`
`c->R = MAX(0, MIN(255, r));`
`c->G = MAX(0, MIN(255, g));`
`c->B = MAX(0, MIN(255, b));`
}

void rgb2cbycr(cbycr *c, int R, int G, int B) {
`c->Y  = (int)(0.299   * R + 0.587   * G + 0.114   * B);`
`c->Cb = (int)(-0.16874 * R - 0.33126 * G + 0.50000 * B);`
`c->Cr =(int)(0.50000 * R - 0.41869 * G - 0.08131 * B);`
}

int main() {
`cbycr _cbycr;`
`rgb _rgb;`
`_rgb.R = 50;`
`_rgb.G = 50;`
`_rgb.B = 50;`
`rgb2cbycr(&_cbycr, _rgb.R, _rgb.G, _rgb.B);`
`cbycr2rgb(&_rgb, _cbycr.Y, _cbycr.Cb, _cbycr.Cr);`
`printf("rgb=%d %d %d\n", _rgb.R, _rgb.G, _rgb.B);`
`return 0;`
} 
```

输出：rgb=0 185 0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:37:53.597

JPEG 的 JFIF 使用允许 Y'CbCr，其中 Y'、Cb 和 Cr 具有 0-255 的完整 8 位范围。`0x80`它通过向Cb 和 Cr 值添加偏差来实现这一点。该`cbycr2rgb`函数（可能是正确的）试图从 Cb 和 Cr 中减去这个偏差值，但`rgb2cbycr`没有添加它，因此它无法返回原始 RGB 值。

# python - Python Flask、SQLAlchemy 关系

> ID：10964790
> 
> 赞同：5
> 
> 时间：2012-06-09T21:42:08.097
> 
> 标签：python, sqlalchemy, flask, flask-sqlalchemy

我已经尝试解决这个问题几个小时了，我无法让 SQLAlchemy 工作（它一直在工作，直到我放置了两个新功能，用户和注册）

```
from flask.ext.sqlalchemy import SQLAlchemy
from . import app
from datetime import datetime

db = SQLAlchemy(app)

class PasteCode(db.Model):
    id = db.Column(db.Integer, primary_key = True)
    codetitle = db.Column(db.String(60), unique = True)
    codebody = db.Column(db.Text)
    pub_date = db.Column(db.DateTime)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'))
    parent_id = db.Column(db.Integer, db.ForeignKey('paste_code.id'))
    parent = db.relationship('PasteCode', lazy = True, backref = 'children', uselist = False, remote_side = [id])

    def __init__(self, codetitle, codebody, parent = None):
        self.codetitle = codetitle
        self.codebody = codebody
        self.pub_date = datetime.utcnow()
        self.parent = parent

class User(db.Model):
    id = db.Column(db.Integer, primary_key = True)
    display_name = db.Column(db.String(30))
    #pastes = db.Column(db.Integer, db.ForeignKey('paste_code.id'))
    pastes = db.relationship(PasteCode, lazy = "dynamic", backref = "user")

class Registration(db.Model):
    id = db.Column(db.Integer, primary_key = True)
    username = db.Column(db.String(30), unique = True)
    password = db.Column(db.String(100), unique = False) 
```

这是它在运行时给我的回溯：

```
OperationalError: (OperationalError) no such table: paste_code u'SELECT paste_code.id AS paste_code_id, paste_code.codetitle AS paste_code_codetitle, paste_code.codebody AS paste_code_codebody, paste_code.pub_date AS paste_code_pub_date, paste_code.user_id AS paste_code_user_id, paste_code.parent_id AS paste_code_parent_id \nFROM paste_code' () 
```

我也试过这个：

```
from flask.ext.sqlalchemy import SQLAlchemy
from . import app
from datetime import datetime

db = SQLAlchemy(app)

class PasteCode(db.Model):
    id = db.Column(db.Integer, primary_key = True)
    codetitle = db.Column(db.String(60), unique = True)
    codebody = db.Column(db.Text)
    pub_date = db.Column(db.DateTime)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'))
    parent_id = db.Column(db.Integer, db.ForeignKey('pastecode.id'))
    parent = db.relationship('PasteCode', lazy = True, backref = 'children', uselist = False, remote_side = [id])

    def __init__(self, codetitle, codebody, parent = None):
        self.codetitle = codetitle
        self.codebody = codebody
        self.pub_date = datetime.utcnow()
        self.parent = parent

class User(db.Model):
    id = db.Column(db.Integer, primary_key = True)
    display_name = db.Column(db.String(30))
    pastes =  db.relationship(PasteCode, lazy = 'dynamic', backref = 'user')
    #pastes = db.relationship(PasteCode, lazy = "dynamic", backref = "user")

class Registration(db.Model):
    id = db.Column(db.Integer, primary_key = True)
    username = db.Column(db.String(30), unique = True)
    password = db.Column(db.String(100), unique = False) 
```

我得到了这个错误：

```
ArgumentError: Could not determine join condition between parent/child tables on relationship PasteCode.parent. Specify a 'primaryjoin' expression. If 'secondary' is present, 'secondaryjoin' is needed as well. 
```

任何的想法？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-12T00:16:30.483

我修复它的方法很简单，我补充说

```
__tablename__ = "paste_code" 
```

一切正常，我认为 SQLAlchemy 没有正确检查表名。

# objective-c - NSFetchedResultsControllerDelegate

> ID：10964794
> 
> 赞同：0
> 
> 时间：2012-06-09T21:42:30.517
> 
> 标签：objective-c, nsfetchedresultscontroller, nsfetchrequest

嗨，我正在尝试在 NSFetchedResultsController 委托旁边使用自定义委托，但我发现如果我实现我的 XMLParserDelegate 获取结果控制器不会填充 UITableview 但如果我删除 XMLParserDelegate 一切都会填充。

我似乎能够使其中一个或另一个工作，但不能同时使用任何想法？

我是 iphone 编程新手 :(

```
@interface FirstViewController : UITableViewController     <XMLParserDelegate,NSFetchedResultsControllerDelegate>

{
NSFetchedResultsController *fetchedResultsController;
NSManagedObjectContext *managedObjectContext;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T11:13:58.287

您必须将 XML 解析器中的数据连接到获取的结果控制器。

解析器完成后，将对象插入托管对象上下文并保存，然后可能重新加载表视图。现在应该显示解析的结果。

# c - 十六进制替换ELF二进制中较长的字符串？

> ID：10964795
> 
> 赞同：1
> 
> 时间：2012-06-09T21:42:36.680
> 
> 标签：c, linux, hex

如果 ELF 二进制文件中的字符串长度更小或相等，我可以替换它，但是在替换为更长的字符串时会发生段错误。为什么会出现段错误？还必须更改哪些其他内容才能正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:17:17.343

> 如果它小于或等于长度，我可以替换 ELF 二进制文件中的字符串

根据您是在谈论完全链接的二进制文件（`ET_EXEC`或`ET_DYN`）还是目标文件（`ET_REL`），您上面的陈述可能正确，也可能不正确。

您不能安全地编辑`.dynstr`完全链接二进制文件部分中的字符串，因为这样做会破坏动态符号哈希表。

> 但是用更长的字符串替换时会发生段错误。

你期待什么？ELF 二进制文件包含结构化数据。如果您破坏了该数据的结构，您应该会遇到*各种*问题。你很幸运，你有一个段错误。它可能会更糟（例如，它可能默默地破坏了您在磁盘上写入的数据）。

# c# - 如何用破折号或类似的东西划分组合框的项目

> ID：10964796
> 
> 赞同：1
> 
> 时间：2012-06-09T21:42:39.453
> 
> 标签：c#, asp.net, telerik, radcombobox

我有一个 RadComboBox 包装项目，如果它们比组合框的宽度长，所以我的组合框会显示如下：

```
All
White T Shirts
Black T Shirts
Blue T Shirts With
Images
Green T Shirts 
```

所以你可以看到带有图像的蓝色 T 恤包装，这很好，这正是我想要的……但现在我收到了一个请求，认为这是他们想要看到的，他们希望看到它像破折号一样分开像这样下划线：

```
All
--------------------
White T Shirts
--------------------
Black T Shirts
--------------------
Blue T Shirts With
Images
--------------------
Green T Shirts
-------------------- 
```

所以这是他们希望看到的或类似的东西，甚至可能像侧面的东西一样

```
* All
* White T Shirts
* Black T Shirts
* Blue T Shirts With
  Images
* Green T Shirts 
```

我不知道如何做到这一点，并会感谢任何有关如何做到这一点的帮助.. 现在这是我对下拉菜单的标记

```
 <telerik:RadComboBox ID="ddlTShirts" runat="server">
 </telerik:RadComboBox> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:50:10.793

尝试更改控件的项目模板。

```
<telerik:RadComboBox ID="RadComboBox1" runat="server">
    <ItemTemplate>
           <asp:CheckBox runat="server" ID="chk1" Checked="true"/>
            <asp:Label runat="server" ID="Label1" AssociatedControlID="chk1">
                <img src='...' />
            </asp:Label>            
    </ItemTemplate>
</telerik:RadComboBox> 
```

参考：[http ://demos.telerik.com/aspnet-ajax/combobox/examples/functionality/templates/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/combobox/examples/functionality/templates/defaultcs.aspx)

# c++ - 创建字符串的常量集集合c ++

> ID：10964802
> 
> 赞同：3
> 
> 时间：2012-06-09T21:43:37.923
> 
> 标签：c++, stl

这听起来像是一个基本问题，当然可以解决，但我正在寻找一个快速而优雅的解决方案。

我想为我的程序创建一组保留字： `{"apple", "orange", "peach"}`

它是恒定的，我希望能够在运行时检查字符串`s`是否是保留字（f`s`是集合的一部分）。

我考虑过使用`std::set`，但我不想手动将我的每个保留字添加到集合中。此外，我不需要 set 的全部功能，例如我不需要添加新元素或删除元素。

什么是优雅的做法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T21:46:46.267

您可以将单词存储在数组中，然后使用`std::set`范围构造函数：

```
char const* raw_words[] = { "apple", "orange", "peach" };

std::set<std::string> const words(std::begin(raw_words), std::end(raw_words)); 
```

这利用了 C++11 中的 new`begin`和`end`函数，但您也可以在 C++03 中使用指向数组的第一个元素和最后一个元素的指针来执行此操作。

在 C++11 中，您还可以使用初始化列表来初始化`std::set`，尽管并非所有编译器都支持此功能。

还要注意，如果单词集的内容永远不会改变，最好简单地使用 sorted `std::vector<std::string>`with`std::lower_bound`并`std::binary_search`查找元素。您可能会发现这会表现得更好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-09T21:49:53.590

在现代 c++ (c++11) 中：

```
const std::set<std::string> v = { "xyzzy", "plugh", "abracadabra" }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-09T21:50:50.137

> 我不想手动将我的每个保留字添加到集合中。

如果你的意思是你不想要看起来像这样的代码：

```
reserved_word.insert("apple");
reserved_word.insert("orange");
reserved_word.insert("peach"); 
```

在一些必须先运行的初始化代码中，您可以改为（在 C++11 中）：

```
const std::set<std::string> reserved_word = {"apple", "orange", "peach"}; 
```

尽管这仍然在运行时执行初始化。

您也可以简单地使用预先排序的`char const *reserved_word[] = { ... }`. 这将完全避免任何运行时初始化的需要。尽管您最好在源代码中正确排序，否则当您尝试使用排序序列搜索算法之一搜索单词时，您会遇到意外的行为。

> 此外，我不需要 set 的全部力量

我不认为这是避免它的好理由。避免某事的更好理由是它是否允许您想要禁止的事情。例如，如果你真的想防止添加和删除东西，那么使用非常量集就不是最好的选择。但是由于您可以使用 const set 来代替，因此无需避免 set。

# multithreading - 获取等待取消互斥锁的线程数

> ID：10964804
> 
> 赞同：1
> 
> 时间：2012-06-09T21:44:02.790
> 
> 标签：multithreading, thread-safety, mutex, semaphore

从没有办法以原子方式增加计数器并锁定互斥锁（或 ty 来获取它）的假设开始，是否有任何多线程库允许读取互斥锁上的等待线程数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:05:07.277

我不知道您使用哪种编程语言编写代码，但在 C# 中，您可以[尝试](http://msdn.microsoft.com/en-us/library/4tssbxcw)在不阻塞的情况下对对象进行排他锁，因此您的 Mutex 实现将如下所示：

```
class MyMutex
{
    public int LockedThreadsCount
    {
        get { lock (countLock) { return waitingThreads; } }
    }

    public void WaitOne()
    {
        if (!Monitor.TryEnter(mainLock))
        {
            lock (countLock) { waitingThreads++; }
            Monitor.Enter(mainLock);
            lock (countLock) { waitingThreads--; }
        }
    }

    public void Release()
    {
        Monitor.Exit(mainLock);
    }

    private int waitingThreads = 0;
    private object countLock = new object();
    private object mainLock = new object();
} 
```

# ruby-on-rails-3 - 如何通过 facebook redirect_uri user_omniauth_authorize_path？

> ID：10964806
> 
> 赞同：0
> 
> 时间：2012-06-09T21:44:16.257
> 
> 标签：ruby-on-rails-3, devise, omniauth

在我的 Rails 控制器中，我有类似的东西：

```
 def authenticate_user!
    if not current_user
      # TODO: after login user should go back to the place she tried to get, not ref url
      redirect_to user_omniauth_authorize_path(:facebook, :redirect_uri => 'http://localhost:3000/some-page-where-user-redirected-after-login')
    end
  end 
```

如何在 user_omniauth_authorize_path 中传递正确的 facebook redirect_uri？

我试过 ":redirect_uri => " 但它不起作用。

在她登录后，我需要将用户重定向到添加评论表单。登录仅通过 Facebook Omniauth Devise 完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-17T14:08:58.163

如果您当前以如下方式为用户签名：

```
 sign_in_and_redirect @user, :event => :authentication 
```

那么您可以更改为：

```
 sign_in @user, :event => :authentication
  @after_sign_in_url = 'url'
  render 'page to render' 
```

# php - 在正则表达式中选择几个项目

> ID：10964808
> 
> 赞同：1
> 
> 时间：2012-06-09T21:44:47.800
> 
> 标签：php, regex

我正在写一个刮板，我有以下代码：

```
 //Open link prepended with domain
        $link='http://www.domain.de/'.$link;
        $data=@file_get_contents($link);
        $regex='#<span id="bandinfo">(.+?)<br><img src=".*?"  title=".*?" alt=".*?" >&nbsp;(.+?)&nbsp;(.+?)<br>(.+?)<br><a href=".*?">Mail-Formular</a>&nbsp;<img onmouseover=".*?" onmouseout=".*?" onclick=".*?" style=".*?" src=".*?" alt=".*?">&nbsp;<br><a href="tracklink.php.*?>(.+?)</a></span>#';
        preg_match_all($regex,$data,$match2);
        foreach($match2[1] as $info) echo $info."<br/>"; 
```

如您所见，我需要在正则表达式中选择几项内容。但是，在我回显它的底部时，它总是只给出选择的第一件事。

我以为在数组中有所有选择的东西呢？我需要将它们保存在变量中，但不知道如何访问它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T21:53:52.240

`$match2[1]`仅包含一个匹配项。尝试使用`$match2`

```
foreach($match2 as $info) echo $info."<br/>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:57:45.933

您不应该使用正则表达式来解析 html，这是我放在一起的一个简单函数，它使用 domDocument 和 curl 更快。

示例刮：

查找`a`具有`onmouseout`值为 的属性的所有链接`return nd();`：

```
<?php 
$link = 'http://www.bandliste.de/Bandliste/';
$data=curl_get($link, $link);
$info = DOMParse($data,'a','onmouseout','return nd();');
print_r($info);
/*
Array
(
    [0] => Array
        (
            [tag] => a
            [onmouseout] => return nd();
            [text] => Martin und Kiehm
        )

    [1] => Array
        (
            [tag] => a
            [onmouseout] => return nd();
            [text] => Blues For Three
        )

    [2] => Array
        (
            [tag] => a
            [onmouseout] => return nd();
            [text] => Phrase Applauders
        )
 ...

 ...
*/
?> 
```

或第二个示例寻找`div`具有`class`名为的属性`bandinfo`：

```
<?php
$link = 'Bands/Falling_For_Beautiful/14469/';
$link='http://www.bandliste.de/'.$link;
$data=curl_get($link, $link);
$info = DOMParse($data,'div','class','bandinfo');
/*
Array
(
[0] => Array
(
[tag] => div
[class] => bandinfo
[text] => What? We are Falling For Beautiful and we make music. And basically  thats it. Sound? Rock. Indie. Alternative. Pop. Who? Adrianne (Vocals/Guitar) Nina (Guitar/Special Effects) Bianca (Bass) Marisa (Drums) When? Some of us started having a band in 2003  we played tons of gigs, covered tons of songs, started writing our own songs. In 2008 we decided to forget about that and founded FFB. So we started to write songs and arranged them. We made them sound simple and catchy focusing on lyrics. Our songs are about life.  Booking: Bianca Untertrifallerhttp://www.fallingforbeautiful.com
)

)
*/
?> 
```

或某些 javascript 中的 onclick 中包含的图像：

获取所有`img`标签`onclicks`

```
<?php
$img = DOMParse($data,'img','onclick');
//Then find the image we are looking for
function parse_img($array){
    foreach($array as $value){
        if(strstr($value['onclick'],"Band Foto")){
            preg_match('#window.open\(\'(.*?)\', \'Band Foto\'#',$value['onclick'],$match);
            return $match[1];
        }
    }
}
//echo parse_img($img); //bandfoto-14469.jpg
?> 
```

实际的dom函数：

```
<?php
function DOMParse($source,$tags,$attribute=null,$attributeValue=null){
    header('Content-Type: text/html; charset=utf-8');
    $return = array();
    $dom = new DOMDocument("1.0","UTF-8");
    @$dom->loadHTML($source);
    $dom->preserveWhiteSpace = false;

    foreach($dom->getElementsByTagName($tags) as $ret) {
        //No attribute to look for so return only nodeValue
        if($attribute==null){
            if(trim($ret->nodeValue)==''){continue;}
            $return[] = array('tag'=>$tags,'text'=>preg_replace('/\s+/', ' ',$ret->nodeValue));
        }else{
            //Attribute not null look for eg: src, href, class ect
            if(trim($ret->nodeValue)=='' && $ret->getAttribute($attribute)==''){continue;}

            //If we looking for specific value from an attribute containg an attibute value
            if($attributeValue!=null){
                if($ret->getAttribute($attribute)==$attributeValue){
                    $return[] = array('tag'=>$tags,$attribute=>$ret->getAttribute($attribute),'text'=>preg_replace('/\s+/', ' ',$ret->nodeValue));
                }
            }else{
                $return[] = array('tag'=>$tags,$attribute=>$ret->getAttribute($attribute),'text'=>preg_replace('/\s+/', ' ',$ret->nodeValue));
            }

        }
    }
    return $return;
}
?> 
```

和卷曲功能：

```
<?php
function curl_get($url, $referer){
    //check curl is installed or revert back to file_get_contents
    $return = (function_exists('curl_init')) ? '' : false;
    if($return==false){return file_get_contents($url);}

    $curl = curl_init();
    $header[0] = "Accept: text/xml,application/xml,application/json,application/xhtml+xml,";
    $header[0] .= "text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5";
    $header[] = "Cache-Control: max-age=0";
    $header[] = "Connection: keep-alive";
    $header[] = "Keep-Alive: 300";
    $header[] = "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7";
    $header[] = "Accept-Language: en-us,en;q=0.5";
    $header[] = "Pragma: ";

    curl_setopt($curl, CURLOPT_URL, $url);
    curl_setopt($curl, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0 Firefox/5.0');
    curl_setopt($curl, CURLOPT_HTTPHEADER, $header);
    curl_setopt($curl, CURLOPT_HEADER, 0);
    curl_setopt($curl, CURLOPT_REFERER, $referer);
    curl_setopt($curl, CURLOPT_ENCODING, 'gzip,deflate');
    curl_setopt($curl, CURLOPT_AUTOREFERER, true);
    curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($curl, CURLOPT_FOLLOWLOCATION, true);
    curl_setopt($curl, CURLOPT_TIMEOUT, 30);
    curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);

    $html = curl_exec($curl);
    curl_close($curl);
    return $html;
}
?> 
```

希望能帮助到你。

# c# - Xna C# - 窗口活动时节奏游戏音乐不同步

> ID：10964809
> 
> 赞同：2
> 
> 时间：2012-06-09T21:44:54.707
> 
> 标签：c#, xna, xna-4.0

我正在 XNA 中制作一个传统的节奏游戏，我有一个简单的公式来计算一个音符与该音符之间的距离，该距离相对于该音符被指定击中该音符的时间以及音符的速度。问题是笔记比指定的提前约 1-2 秒通过指导笔记。音符以每帧 1 像素的速度移动，我注意到当窗口处于活动状态时，音符的移动速度比预期的要快一些，并且提前通过了引导音符。当窗口处于非活动状态时（我将焦点放在任务栏上，以便我仍然能够看到游戏），笔记会在指定时间准确地到达引导笔记。如果您发现我不清楚，我会尽量提供尽可能详细的信息！谢谢！我忘了提到FPS在公式中也是相对的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-12T04:04:25.063

您遇到同步问题的原因是您的游戏基于 FPS，评论中这样说。

使用[GameTime](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.gametime.aspx)类来管理您的笔记，因为您的帧速率可能随时下降，通常是通过垃圾收集。

如果还有同步问题，MediaPlayer 有一个名为[TimePosition](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.media.mediaplayer.playposition)的属性，它是一个指示歌曲位置的 TimeSpan。

我希望这有帮助。

# delphi - 如何实现 IDispatch 方法？

> ID：10964810
> 
> 赞同：2
> 
> 时间：2012-06-09T21:45:01.403
> 
> 标签：delphi, com, delphi-xe2

我玩过一个通过 COM 接口访问的第三方库。
对于一些测试，我创建了主要形式：

```
TForm1 = class (TForm, IThirdParyCOMInterface) 
```

TForm1 实现了 IThirdParyCOMInterface 的所有方法，我得到了我需要的功能。

下一步是创建一个单独的类，仅用于处理此 COM 接口。
做这样的事情：

```
TMyClass = class (TInterfacedObject, IThirdParyCOMInterface) 
```

导致编译器错误：

> E2291 缺少接口方法 IDispatch.GetTypeInfoCount
> 的实现 E2291 缺少接口方法 IDispatch.GetTypeInfo 的实现
> E2291 缺少接口方法 IDispatch.GetIDsOfNames 的实现
> E2291 缺少接口方法 IDispatch.Invoke 的实现

( IThirdPartyCOMInterface = interface (IDispatch) )
似乎 TForm 已经实现了这些 IDispatch 方法，但我的新简单类没有。

我怎样才能为像上面这样的新课程做到这一点？
我应该从哪个类继承我的新类，以便这些 IDispatch 方法已经实现？

编辑：
我刚刚找到 TAutoIntfObject。那是我需要的吗？
（COM 让我有点困惑，我只是在这里猜测）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T02:50:26.187

在 COM 中要做的传统事情，特别是如果您正在编写一个用作自动化服务器（又名 DCOM 服务器）的 EXE 进程，就是将您的 COM 接口与您的表单分开。

哎呀，即使您正在编写不想变成巨型泥球的普通 Delphi 应用程序，这样做也是传统的做法。所以问问自己为什么要让 FORM 实现你的调度接口。即使在一个快速而肮脏的演示中，将 COM Server 类和表单混为一谈也很有趣，您不需要拥有。

双界面（自动化）对象通常构建为它们自己的类，它可能私下引用您的表单。我建议你检查一下这样做。

`IThirdPartyComInterface`应该由你自己的类实现`TThirdPartyComInterface`，并且应该是一个双COM（Native vtable + Dispatch）对象。

然后，您应该注册您的 COM 服务器对象，然后您就可以开展业务了。

有各种教程，但似乎都不是最新的。这是[Delphi 7 的一个。](http://www.delphisources.ru/pages/faq/master-delphi-7/content/LiB0123.html)

也许最好的去处是[DocWiki](http://docwiki.embarcadero.com/RADStudio/en/Creating_Simple_COM_Servers_-_Overview)，它将向您展示 Com 对象向导，您应该使用它来创建您的 TThirdPartyComInterface 类，该类将同时实现您的 IDispatch，以及本机 VTable COM（更高性能）。您可以将 IDispatch 入侵到您的 TForm 中，但每次您这样做时，我选择的子神或执政官都会执行我选择的小型毛茸茸的动物。不要这样做。想想你正在杀死的那些毛茸茸的小动物。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T13:32:55.770

尝试使用`TAutoObject`而不是`TInterfacedObject`. 前者实施`IDispatch`，后者只实施`IUnknown`。（在`ComObj`单位里）

# jquery - 鼠标悬停时jQuery输入值更改

> ID：10964811
> 
> 赞同：1
> 
> 时间：2012-06-09T21:45:21.200
> 
> 标签：jquery, forms, input, jquery-validate, validation

我想在我的表单中实现 jquery/js，并且我想让输入值动态化。基本上这个想法是，一旦单击该字段的值就会消失/模糊，并且 jquery 期望用户插入一个值，如果设置了一个值并且它与默认值不同，那么就可以了。但如果用户写入的值相同，则不接受并抛出错误，否则如果用户“输入”的值为空，则再次显示默认值。我相信这是有道理的，因为我认为我已经在很多网站上看到了这个功能实现。但我现在是一个 jquery 人，所以我不知道该怎么做。我可以在 php 中做同样的事情，但页面刷新是我想要避免的。所以假设我们有：

```
<input type="text" value="City" /> 
```

非常感谢你，博尔尼。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T21:57:48.287

像[这里这样？](http://jsfiddle.net/justeric/gbjvU/)

```
$(document).ready(function() {

    $('input[class="foo"]').attr('value', $(this).attr('placeholder')).focus(function() {
        if ($(this).val('placeholder')) {
            $(this).attr('value', '');
        }
    }).blur(function() {
        if ($(this).val() == '') {
            $(this).attr('value', $(this).attr('placeholder'))
        }
    });
}); 
```

编辑：更新代码并修改 Christopher Ramírez 提供的建议

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:52:32.560

您想要的称为“占位符”。它们在 Webkit 和 Mozilla 等现代浏览器中实现。我不确定是否新版本的 IE 实现了它们。

`input`要使用它们，请在元素中声明一个名为`placeholder`. 像这样：

```
<input type="text" name="fullname" placeholder="Type your full name" /> 
```

作为备份，当`placeholder`浏览器不支持属性时，[此arcicle](http://www.hagenburger.net/BLOG/HTML5-Input-Placeholder-Fix-With-jQuery.html)可能有助于到达您想要的位置

更新：[这是](http://webcloud.se/code/jQuery-Placeholder/)我刚刚找到的插件。看起来很容易使用。

# wsh - “WSH”和“WScript”对象有什么区别？

> ID：10964812
> 
> 赞同：-1
> 
> 时间：2012-06-09T21:45:26.580
> 
> 标签：wsh, windows-scripting

`WSH`对象和对象有什么区别`WScript`？

`this.wsf`：

```
<?xml version="1.0" encoding="utf-8"?>
<package>
    <job id="this">
        <?job error="true" debug="true"?>
        <script>
            this;
            debugger;
        </script>
    </job>
</package> 
```

双击 WSF 文件，或执行以下命令以使用 Visual Studio 进行调试：

```
wscript /d /x this.wsf 
```

在 Visual Studio 中，当您将鼠标悬停在 上时`this`，您会看到两个对象：`WSH`和`WScript`.

应该使用哪个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:14:49.943

它们是同一个对象，所以使用哪一个并不重要，但所有示例都使用 WScript。

# java - 捕获到异常但程序继续运行

> ID：10964821
> 
> 赞同：14
> 
> 时间：2012-06-09T21:47:42.600
> 
> 标签：java, exception-handling

我正在开发我的第一个 Java 项目，它实现了一个名为“HeartRates”的类，它获取用户的出生日期并返回他们的最大和目标心率。主测试程序中的所有内容都有效，除了一件事，我不知道在捕获异常后如何阻止其余代码打印。

我不太确定捕获异常的整个代码部分，因为它是从教授给我们的内容中复制和粘贴的。如果有人能告诉我如何在发生错误后终止程序，或者打印自定义错误消息并阻止程序进一步执行，我将不胜感激。

这是代码：

```
 import java.util.Scanner;
 import java.util.GregorianCalendar;

 import javax.swing.JOptionPane;

 public class HeartRatesTest {

public static void main(String[] args) {
    HeartRates test= new HeartRates();
    Scanner input = new Scanner( System.in );
    GregorianCalendar gc = new GregorianCalendar();
    gc.setLenient(false);

        JOptionPane.showMessageDialog(null, "Welcome to the Heart Rate Calculator");;
        test.setFirstName(JOptionPane.showInputDialog("Please enter your first name: \n"));
        test.setLastName(JOptionPane.showInputDialog("Please enter your last name: \n"));
        JOptionPane.showMessageDialog(null, "Now enter your date of birth in Month/Day/Year order (hit enter after each): \n");

        try{
            String num1= JOptionPane.showInputDialog("Month: \n");
            int m= Integer.parseInt(num1);
            test.setMonth(m);
                gc.set(GregorianCalendar.MONTH, test.getMonth());
            num1= JOptionPane.showInputDialog("Day: \n");
            m= Integer.parseInt(num1);
            test.setDay(m);
                gc.set(GregorianCalendar.DATE, test.getDay());
            num1= JOptionPane.showInputDialog("Year: \n");
            m= Integer.parseInt(num1);
            test.setYear(m);
                gc.set(GregorianCalendar.YEAR, test.getYear());

                gc.getTime(); // exception thrown here
        }

        catch (Exception e) {
            e.printStackTrace();
            }   

    String message="Information for "+test.getFirstName()+" "+test.getLastName()+": \n\n"+"DOB: "+ test.getMonth()+"/" +test.getDay()+ "/" 
            +test.getYear()+ "\nAge: "+ test.getAge()+"\nMax Heart Rate: "+test.getMaxHR()+" BPM\nTarget Heart Rate(range): "+test.getTargetHRLow()
            +" - "+test.getTargetHRHigh()+" BPM";
    JOptionPane.showMessageDialog(null, message);
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-09T21:50:12.747

不太确定为什么要在捕获异常后终止应用程序 - 修复任何错误不是更好吗？

无论如何，在您的 catch 块中：

```
catch(Exception e) {
    e.printStackTrace(); //if you want it.
    //You could always just System.out.println("Exception occurred.");
    //Though the above is rather unspecific.
    System.exit(1);
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-09T21:56:52.960

确实，return 会恰好停止该程序的执行（在 main 中）。更一般的答案是，如果您无法在方法中处理特定类型的异常，您应该声明您抛出所述异常，或者您应该用某种 RuntimeException 包装您的异常并将其抛出到更高层。

System.exit() 在技术上也有效，但在更复杂的系统的情况下应该避免（您的调用者可能能够处理异常）。

tl;博士版本：

```
catch(Exception e)
{
    throw new RuntimeException(e);
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-06-09T21:49:25.223

在`catch`块中，使用关键字`return`：

```
catch(Exception e)
{
    e.printStackTrace();
    return; // also you can use System.exit(0);
} 
```

或者也许你想把最后一个`JOptionPane.showMessageDialog`放在块的末尾`try`。

# c# - VS 2010 的“插件”，一个在智能感知下拉/片段中显示属性的类

> ID：10964827
> 
> 赞同：0
> 
> 时间：2012-06-09T21:49:31.453
> 
> 标签：c#, visual-studio-2010, class, intellisense

在下面的代码中，当您访问样式属性时，我希望它接受参数类型：顶部、左侧、宽度等...所以它会首先从智能感知插入，以免您有机会意外拼写错误，忘记了或者只是为了“自动化”，或者无论如何我们称之为，在智能感知中作为一个可供选择的选项。

代替：

```
objectID.Style.Add("property", "Value"); 
```

您将获得可用属性：

```
objectID.Style.Add(Top, "here you will hardcode manually"); 
objectID.Style.Add(Left, "100px");
objectID.Style.Add(Width, "230px"); // but every parameter that represents an object property 
        //such as: Top, Left Etc' ... i would like to have it as an option opposed, to hard coding it 
```

我很乐意就我的想法提供更详细的想法…… **再举一个例子：**

```
 DateTime fullDate = DateTime.Now;
    string ddays = fullDate.Day.ToString();
    string dmonth = fullDate.Month.ToString();
    string dyear = fullDate.Year.ToString(); 
```

如何使用上面的代码获取日期的一部分并将每个存储到一个表示日期、日、月、年的字符串中，然后将其放入一个类中，以便我可以在其他代码中重用它：

```
Label1.Text = Day; Label2.Text = Month; Label3.Text = Year; 
```

我再次想要实现的是，当 App_Code 具有我们构建的所谓“类”时，这些值将在智能感知中......

与该线程第一部分中的样式属性相同。

由于我是 oop 的新手，我想从该示例中更好地理解什么是字段属性类型（您自己的）和类，从这个角度来看（上面的代码）我将非常感谢正确/详细的答案，希望一个天，我也能帮助别人……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:58:38.080

对于您的第一个示例，枚举是完美的：

```
public enum StyleOptions { Top, Left, Width, etc }

objectID.Style.Add(StyleOptions.Top, "here you will hardcode manually"); 
```

对于第二个，我建议传递 a`DateTime`而不是单独`string`的 s。如果您想在单独的标签中显示单独的部分，那么在具有框的页面/表单/用户控件中，执行您的`Label1.Text = fullDate.Day.ToString();`（等）代码。

`DateTime`(a `struct`) 和`StyleOptions`(an `enum`) 都是类型。 `class`es 也是类型，（并且是您将在 C# 中看到的最常见的类型）但我不确定您在这里使用的是哪些类（无论您在其中获得代码片段的方法包含什么，几乎可以肯定是一个类你做了）。字段本质上是属于类型实例（如果是非静态）或类型本身（如果是静态）的变量。属性像字段一样被访问，但使用方法定义，因此您可以执行延迟加载等操作，并在获取和设置属性更改时通知。如果不太清楚，请参阅[C# 3.0+ 中的属性和字段之间的区别](https://stackoverflow.com/questions/653536/difference-between-property-and-field-in-c-sharp)以及[字段](http://msdn.microsoft.com/en-us/library/ms173118.aspx)和[属性](http://msdn.microsoft.com/en-us/library/x9fsa0sw)文档。

# android - TextView 在屏幕末尾被截断

> ID：10964838
> 
> 赞同：2
> 
> 时间：2012-06-09T21:50:21.710
> 
> 标签：android, textview

我的应用程序中的 TextView 有问题。到目前为止，它在我测试过的 3 部手机上都能正常工作，但不幸的是，它在运行 MIUI ROM 的手机上往往表现得很奇怪。

字符串在屏幕末尾被截断，而不仅仅是换行： ![在此处输入图像描述](../Images/7ea7cb3bc40417dee964057b916dd193.png)

它只是一个常规的 TextView ...顺便说一下，这是 XML 代码：

```
<ScrollView
android:id="@+id/scroll_view"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

    <LinearLayout
    android:id="@+id/linearLayout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    >
            <TextView
                android:id="@+id/question_text"
                android:text="@string/question"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_margin="10dp"
                android:textSize="24sp"
                > 
```

任何猜测，为什么它在特定的ROM中被切断？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-21T10:12:58.247

问题的可能原因是 ROM 使用了不同的字体，或者手机的显示屏尺寸较小，这导致您的字符串比字符串宽。

您可以使用该`ellipsize`参数来避免文本“损坏”。[这是文档。](http://developer.android.com/reference/android/widget/TextView.html#attr_android%3aellipsize)根据设置 - 您的文本视图可能在开头、中间、结尾有“...”符号，没有符号并在结尾处被切断，或水平动画（选取框）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:26:06.677

我会尝试：

```
android:singleLine="false" 
```

在你的文本视图中

# jquery - 如何在 jquery mobile 的嵌套列表（所有级别）中使用 data-filter="true" 过滤项目（搜索过滤器栏）

> ID：10964840
> 
> 赞同：0
> 
> 时间：2012-06-09T21:50:56.767
> 
> 标签：jquery, list, mobile, nested

我在 jquery mobile 中有一个嵌套列表。我可以通过设置属性搜索每个嵌套级别

```
data-role="listview" data-filter="true" 
```

在每个嵌套的。但是如何从顶层搜索整个列表？

我已经尝试添加

```
data-filtertext="" 
```

嵌套列表中所有的属性...没有成功:(

我想使用“搜索过滤栏”，但我不知道如何将其应用于整个列表！

谢谢，帕特里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T21:59:39.380

尝试这个：

```
$('[data-filter="true"]').each(function(){
   alert($(this).text())
}) 
```

# java - Jdbc DataSource 多线程未实现连接

> ID：10964842
> 
> 赞同：2
> 
> 时间：2012-06-09T21:51:06.500
> 
> 标签：java, multithreading, jdbc

我已经为此做了很多小时，但没有成功。我在多线程应用程序中实例化一个 DataSource。所有线程都从 DataSource 获取连接并在 finally 块中关闭它们（我逐行检查以确保释放连接）。我遇到的问题是，即使在每个连接上都调用了 close 方法，但它们并没有被 DataSource 释放。我知道这一点是因为我有一个从 DBCP 数据源打印**source.getNumActive()**的不同线程。

这是基本设置。

```
public class DataSourceHolder {
  private static DataSource source;
  static {
    get the data source either from jndi or created from scratch
  }
  public DataSource getDataSource() { return source; }
} 
```

我有一个简单的 JdbcPattern（像 springs JdbcTemplate 但非常简单）来封装所有样板代码。这是这样定义的：

```
public class JdbcPattern {
  private DataSource source;
  public JdbcPattern(DataSource source) {
    this.source = source;
  }
  public int executeMethods(....) {
    Connection c = source.getConnection();
    try {
      .. do the statements
    } finally {
      try { c.close(); } catch (SQLException ignore) { }
    }
  }
  public List<?> queryMethods(....) {
  }
} 
```

最后，我有四个线程在程序开始时启动。该线程会休眠一段时间，并在唤醒时使用 DataSourceHolder 提供程序 DataSource 实例化一个 JdbcPattern 并开始做一些事情。事情完成了，当连接关闭时，数据源并没有真正释放它。在 DataSource 最大连接数之后，由于无法实例化更多连接，程序冻结。

您将如何诊断？

编辑。这是在tomcat上运行的。所有常用方法都由 catalina common loader 加载，并且线程在其中一个 Web 应用程序中运行。我一直在想这可能是一个类加载器问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T00:30:37.360

您不应该忽略关闭失败。将其包装在未经检查的异常中或将其记录下来，但不要忽略。如果尝试释放与池的连接时出现一些奇怪的错误，您将不知道。

我建议为池数据源创建自己的包装器。您可以记录对 getConnection 的调用以及堆栈跟踪和连接的唯一标识符。当它调用 close 时，也以相同的方式在 JdbcPattern 中记录。查找未关闭的连接的标识符，注意从 getConnection 堆栈跟踪中将它们从池中取出的位置。您也可以让您的 DataSource 包装器在服务器内部进行此分析，但这需要更多代码和更多出错的机会。我会先尝试简单的日志记录。考虑将此日志记录保留在产品中，但低于正常的日志记录阈值。您将再次需要它。

# javascript - 通过字符串创建对象

> ID：10964848
> 
> 赞同：0
> 
> 时间：2012-06-09T21:51:54.880
> 
> 标签：javascript, jquery

这是一个快速的问题，我希望你能帮助我。

如何使用字符串导航到对象？

如果我有这个：

```
var string = something; 
```

像这样的对象：

```
var this = {
    something: {
        other: "okay"
    }
}​; 
```

然后我怎样才能使用字符串来做这样的事情：

```
this.+string+.other 
```

这将与以下内容相同：

```
this.something.other 
```

?? 也许不是很快，但你明白我要去哪里吗？:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:53:57.313

使用方括号表示法：

```
var this[something].other 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:54:07.193

尝试使用`[]`下面，

```
var _this = {
    something: {
        other: "okay"
    }
}​;

_this[string].other 
```

**注意：**将 var name 更改为`_this`as`var this = <..something..>`会引发错误。也`this`意味着 javascript 中的当前执行对象/窗口对象。

# html - tumblr 主题上的块引用边框

> ID：10964849
> 
> 赞同：0
> 
> 时间：2012-06-09T21:52:00.703
> 
> 标签：html, css, css-float, border

这是链接块的代码：

```
 {block:Link}
        <div class="post link">
            <h2>
             <a href="{URL}" class="name">{Name}</a></h2>

            <div class="content">
                {block:Description}{Description}{/block:Description}
                <span class="date">
                <a href="{Permalink}">{ShortMonth} {DayOfMonth}, {Year}
                </a>
                </span>
            </div>
        </div>
        {/block:Link} 
```

我想要做的是添加一个 10px 的左边框来阻止引号。当我尝试添加这种样式来阻止引号时，会发生这种情况： ![在此处输入图像描述](../Images/b93658e3bee5ffc75cac770e16b18deb.png)

块引用边框流入帖子标题，我不希望发生这种情况，我希望边框布局保持在内容 div 内。

我现在正在使用这个 CSS：

```
 div div div blockquote {
            border-left: 10px solid red;
        } 
```

在此先感谢您的帮助！

只是为了澄清`<div class="post link">`是在另一个`div`。

这是 tumblr：http: [//iamsomething-awesome.tumblr.com/](http://iamsomething-awesome.tumblr.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T16:37:36.253

`float: left;`从`div.post h2`规则中删除，你得到了它 ：![浮动：在blockquote上留下问题](../Images/b0f2434bc19dfb805b30bf699f63c3cf.png)

首先，我检查了`blockquote`它自己和它的几个父级（进一步文本中的*元素*）的负边距 - 并没有发现任何负边距。

然后我检查了属性*元素*的非标准值`display`，但没什么特别的。

然后我搜索了改变布局浮点数的指定属性，首先靠近 blockquote 元素是`div.post.h2`已`float`设置为`left`.

**答对了！**

# exception - CLR 与 OCaml 异常开销

> ID：10964851
> 
> 赞同：13
> 
> 时间：2012-06-09T21:52:32.030
> 
> 标签：exception, f#, clr, ocaml

阅读*开始 F# - Robert Pickering*我专注于以下段落：

> 来自 OCaml 背景的程序员在 F# 中使用异常时应该小心。由于 CLR 的架构，抛出异常非常昂贵——比在 OCaml 中要昂贵得多。如果您抛出大量异常，请仔细分析您的代码以确定性能成本是否值得。如果成本太高，请适当修改代码。

为什么，因为 CLR，抛出异常`F#`比 in更昂贵`OCaml`？在这种情况下，适当修改代码的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-09T21:56:24.860

CLR 中的异常非常丰富，并且提供了很多细节。Rico Mariani在 CLR 中发布了一篇（旧的但仍然相关的）关于[异常成本的帖子，其中详细介绍了其中的一些内容。](http://blogs.msdn.com/b/ricom/archive/2003/12/19/44697.aspx)

因此，在 CLR 中引发异常比在其他一些环境（包括 OCaml）中具有更高的相对成本。

> 在这种情况下，适当修改代码的最佳方法是什么？

如果您*希望*在正常、非异常情况下引发异常，您可以重新考虑您的算法和 API，以完全避免异常。例如，尝试提供一个替代 API，您可以在其中测试环境，然后再引发异常。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-10T18:35:44.330

> 为什么，因为 CLR，如果 F# 抛出异常比在 OCaml 中更昂贵？

OCaml 针对使用异常作为控制流进行了高度优化。相反，.NET 中的异常根本没有得到优化。

请注意，性能差异是*巨大的*。OCaml 中的异常比 F# 中的异常快大约 600 倍。根据我的基准测试，在这方面甚至 C++ 也比 OCaml 慢 6 倍左右。

尽管 .NET 异常据称提供了更多（OCaml 提供了堆栈跟踪，你还想要什么？）我想不出任何理由为什么它们应该像现在这样慢。

> 在这种情况下，适当修改代码的最佳方法是什么？

在 F# 中，您应该编写“总计”函数。这意味着您的函数应该返回一个联合类型的值，指示结果的种类，例如正常或异常。

特别是，`find`应将调用替换为`tryFind`返回`option`类型为`Some`值或`None`键元素不存在于集合中的值的调用。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-06-09T22:25:55.150

Reed 已经解释了为什么 .NET 异常的行为不同于 OCaml 异常。通常，.NET 异常仅适用于*异常*情况，并且是为此目的而设计的。OCaml 具有更轻量级的模型，因此它们也用于实现一些控制流模式。

举一个具体的例子，在 OCaml 中，您可以使用异常来实现循环中断。例如，假设您有一个函数`test`可以测试一个数字是否是我们想要的数字。下面遍历从 1 到 100 的数字并返回第一个匹配的数字：

```
// Simple exception used to return the result
exception Returned of int

try
  // Iterate over numbers and throw if we find matching number
  for n in 0 .. 100 do
    printfn "Testing: %d" n
    if test n then raise (Returned n)
  -1                 // Return -1 if not found
with Returned r -> r // Return the result here 
```

要毫无例外地实现这一点，您有两个选择。您可以编写一个具有相同行为的递归函数 - 如果您调用（并且它被编译为与在 C# 中使用内部循环`find 0`基本相同的 IL 代码）：`return n``for`

```
let rec find n = 
  printfn "Testing: %d" n
  if n > 100 then -1  // Return -1 if not found
  elif test n then n  // Return the first found result 
  else find (n + 1)   // Continue iterating 
```

使用递归函数的编码可能有点冗长，但您也可以使用 F# 库提供的标准函数。这通常是重写将使用 OCaml 异常进行控制流的代码的最佳方式。在这种情况下，您可以编写：

```
// Find the first value matching the 'test' predicate
let res = seq { 0 .. 100 } |> Seq.tryFind test
// This returns an option type which is 'None' if the value 
// was not found and 'Some(x)' if the value was found.
// You can use pattern matching to return '-1' in the default case:
match res with
| None -> -1
| Some n -> n 
```

如果您不熟悉选项类型，请查看一些介绍性材料。[F# wikibook 有很好的教程](http://en.wikibooks.org/wiki/F_Sharp_Programming/Option_Types)，[MSDN 文档也有有用的示例](http://msdn.microsoft.com/en-us/library/dd233245.aspx)。

使用`Seq`模块中的适当函数通常会使代码更短，因此是可取的。它可能比直接使用递归效率略低，但在大多数情况下，您不必担心这一点。

**编辑：**我对实际表现很好奇。如果输入是延迟生成的序列而不是列表（因为列表分配的成本），则使用版本`Seq.tryFind`会更有效。通过这些更改以及返回第 25 个元素的函数，在我的机器上运行代码 100000 次所需的时间是：`seq { 1 .. 100 }``[ 1 .. 100 ]``test`

```
exceptions   2.400sec  
recursion    0.013sec  
Seq.tryFind  0.240sec 
```

这是非常微不足道的示例，因此我认为使用的解决方案`Seq`通常不会比使用递归编写的等效代码慢 10 倍。速度变慢可能是由于分配了额外的数据结构（表示序列的对象、闭包......）以及额外的间接性（代码需要大量的虚拟方法调用，而不仅仅是简单的数字操作和跳转）。但是，异常的成本更高，并且不会以任何方式使代码更短或更易读……

# java - 使用 Java 创建 Snake

> ID：10964853
> 
> 赞同：4
> 
> 时间：2012-06-09T21:52:33.710
> 
> 标签：java, swing, user-interface, keylistener

我决定使用 Java 重新创建 Snake，但我有点卡住了。目前，我有一个正方形，用户可以使用箭头键在屏幕上移动。当您按一次 LEFT 时，方块开始使用计时器向左移动。您无需按住键或一直按住它；当您按下任何其他设置的键（右，上，下）时，它会改变方向。我的目标是使用 ArrayList 来保存构成蛇的方块。目前，我已经创建了一个 ArrayList，其中只有一个 Snake 对象，如果我将第二个 Snake 对象添加到列表中并将其添加到框架（第一个），则只有一个 Snake 对象是可见的并且键移动它不起作用。我正在寻找一些关于如何推进这个项目的想法 - 请不要给我完整的答案，因为我 我想自己解决大部分问题；我只是需要一些方向。在此先感谢 - 代码如下。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Snake extends JPanel implements KeyListener, ActionListener
{
int x = 0, y = 0, velx = 0, vely = 0;
Timer t = new Timer(250, this);

public Snake(int num1, int num2)
{
    t.start();
    addKeyListener(this);
    setFocusable(true);
    setFocusTraversalKeysEnabled(true);
    x = num1;
    y = num2;
}
public void paintComponent(Graphics g)
{   
    super.paintComponent(g);

    g.setColor(Color.blue);
    g.fillRect(x, y, 20, 20);
}
public void actionPerformed(ActionEvent e)
{
    repaint();
    x += velx;
    y += vely;
}
public void up()
{
    vely = -20;
    velx = 0;
}
public void down()
{
    vely = 20;
    velx = 0;
}
public void left()
{
    vely = 0;
    velx = -20;
}
public void right()
{
    vely = 0;
    velx = 20;
}
public void keyPressed(KeyEvent e)
{
    int code = e.getKeyCode();

    if(code == KeyEvent.VK_UP)
        up();
    else if(code == KeyEvent.VK_DOWN)
        down();
    else if(code == KeyEvent.VK_RIGHT)
        right();
    else if(code == KeyEvent.VK_LEFT)
        left();

}
public void keyReleased(KeyEvent e)
{

}
public void keyTyped(KeyEvent e)
{

}
}
//Driver Class
import javax.swing.*;
import java.awt.event.*;
import java.awt.*;
import java.util.*;

public class UserClass
{
private static JFrame frame = new JFrame("Snake");
private static ArrayList<Snake> mySnake = new ArrayList<Snake>();

public static void main(String[] args)
{
    frame.setSize(500,500);
    frame.setBackground(Color.black);
    frame.setVisible(true);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    mySnake.add(new Snake(20,20));
    frame.add(mySnake.get(0));
}
} 
```

PS当我在Mac上的Eclipse中输入相同的代码时，我的框架背景是黑色的，但在Windows上它是浅灰色的......有人知道为什么吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T22:10:17.947

你`paintComponent(...)`只画了一个矩形。相反，如果你想绘制多个矩形或椭圆形，或者其他什么，给你的类一个`List<Point>`or `List<Rectangle2D>`，然后在你的 Swing Timer 中，从列表中删除尾部并添加一个新的头部。然后`paintComponent()`使用 for 循环遍历列表，绘制列表中的所有矩形。

此外，您可能希望使用[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)而不是 KeyListener 来获取用户的按键，因为当其他组件窃取焦点时，这会更好地工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-09T22:12:01.460

要回答您的后记，请设置背景颜色或在其他所有内容后面制作一个 JPanel，并涂上颜色。

要推进项目，请考虑将其作为 MVC 框架中的练习。现在发生的事情是您的模型和视图链接在同一个类中 - 这使得很难遵循所有内容背后的逻辑。

您可以做的是首先将您的 Snake 与与视图有关的任何事情分开 - 用 an`ArrayList<Integer[]> segmentLocations`或其他东西制作一条蛇，以表示您定义的板上每个段位置的 (x,y) - 您可以使用绝对坐标，或者您可以在视图中创建任意网格并更改为绝对坐标（这更好地代表了 MVC 关系）。Snake 还应该有一个表示蛇所面对方向的字段——我会使用`enum Direction {N, S, E, W}`，但你可以选择，因为你也可以有一个表示方向的整数，或各种其他方式。

然后，您的 Snake 也将有方法进行自我更新 - move()，根据初始段的当前方向移动所有段的位置，并导致所有其他段跟随它之前的移动（这如果您考虑几分钟，这很容易）。

您的视图可能是一个 JFrame，其 GridLayout 由 JPanel 组成，这些 JPanel 轮询您的 Snake 实例并查看该位置是否有一个段，如果有，则绘制它，或许多其他选项。

您的控制器将是 KeyAdapter，当按下箭头键时，它会向您的 Snake 发送更新。

小提示，让您的生活更轻松：当您添加新段时，只需将其放在 Snake 的最后一段的位置即可。下次它移动时，新的段将在相同的位置，并且 Snake 的其余部分应该相应地移动。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-09T23:18:19.977

给定一个定义段几何的类，

```
class Segment {
    private int x, y, d;

    public Segment(int x, int y, int r) {
        this.x = x - r;
        this.y = y - r;
        this.d = 2 * r;
    }
} 
```

考虑一个段队列，

```
Queue<Segment> snake = new LinkedList<Segment>(); 
```

然后每次迭代都很简单

```
snake.remove();
snake.add(new Segment(...)); 
```

并`paintComponent()`包括这个循环

```
@Override
public void paintComponent(Graphics g) {
    ...
    for (Segment s : snake) {
        g.fillXxxx(s.x, s.y, s.d, s.d);
    }
    ...
} 
```

# c++ - 运行时的 win32 控件

> ID：10964855
> 
> 赞同：0
> 
> 时间：2012-06-09T21:53:02.527
> 
> 标签：c++, winapi, runtime

这似乎是一个微不足道的问题，而且答案没有明显的目的，但我纯粹是出于对知识和好奇心的兴趣。

我正在编写一个 Win32 GUI 应用程序，除了使用 Win32 API 扩展我的编程知识之外没有其他实际目的，我想知道在程序启动和 WM_CREATE 之后我将如何创建控件（特别是文本字段和按钮）已被调用。

我知道使用 UpdateWindow 会向窗口发送 WM_CREATE 消息，但如果我理解正确，这只会更新源中 WM_CREATE 中已经写入的内容？

我所追求的是一个在单击时添加另一个按钮的按钮和一个在单击时添加一个文本字段的按钮。

而且，虽然不是一个控件，但另一个按钮使用 TextOut() 或单击时绘制文本。

在过去的 2 个小时里，我一直在搜索谷歌寻找这个并且没有运气，我也看过[`UpdateWindow()`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145167%28v=vs.85%29.aspx)并且[`RedrawWindow()`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd162911%28v=vs.85%29.aspx)没有提供任何真正的帮助。

我不要求你们为我编写任何代码，尽管那会很棒：P 只是一些正确方向的指针和一些指导会很棒

提前致谢， 蒂米

另外，我正在使用带有 VS10 的 C++，请不要使用 .NET 或 MFC，只需纯 C++ :D

**编辑：**

> main.cpp，消息循环：

```
case WM_CREATE:
hedit = ctrls->createTextArea(100, 50, 100, 20, ghInstance, hWnd, hEdit1);
hedit2 = ctrls->createBtn(200, 50, 100, 20, ghInstance, hWnd, "button", btn1);
return 0; 
```

> ctrls 指的是控件类对象，该类中的 createTextArea 和 createBtn 如下所示：

```
HWND controls::createTextArea(int x, int y, int width, int height, HINSTANCE hInst, HWND parent, int id)
{
return CreateWindowEx(NULL,
            "Edit",
            "",
            WS_CHILD | WS_VISIBLE | ES_PASSWORD | WS_BORDER,
            x, y,
            width,height,
            parent, (HBRUSH)id,
            hInst,
            NULL);
}

HWND controls::createBtn(int x, int y, int width, int height, HINSTANCE hInst, HWND parent, LPCSTR btnText, int id)
{
    return CreateWindowEx(NULL,
            "Button",
            btnText,
            WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON,
            x, y,
            width, height,
            parent, (HBRUSH)id,
            hInst,
            NULL);
} 
```

**编辑二：**

> WM_COMMAND

```
 case WM_COMMAND:

        if( LOWORD(wParam) == btn1) // btn1 click
        {
            hBtn = CreateWindowEx(NULL,
                "Button",
                "Button2",
                WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON,
                400,50,100,20,
                hWnd, NULL,
                ghInstance,
                NULL);
            ShowWindow(hBtn, SW_SHOW);
            UpdateWindow(hWnd);
        }
            return 0; 
```

中的“btn1”是`if( LOWORD(wParam) == btn1)`指我单击以尝试制作另一个按钮的 ID，该 ID 由以下通过函数调用的代码有效创建：

```
CreateWindowEx(NULL,
            "Button",
            btnText,
            WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON,
            x, y,
            width, height,
            parent, (HMENU)id,
            hInst,
            NULL); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:29:05.640

> 我知道使用 UpdateWindow 会向窗口发送 WM_CREATE 消息

不，CreateWindow/Ex() 将发送该消息。UpdateWindow 只会强制发送和处理 WM_PAINT 消息。如果您的主窗口不可见，那么您可能忘记调用 ShowWindow()。

使用 Win32 项目模板生成的默认代码作为指导。首先验证它是否有效，然后逐步添加更改。在 64 位操作系统上编写 32 位代码时，请注意吞下的 SEH 异常。Debug + Exceptions，勾选“Win32 Exceptions”的Thrown复选框。

# c# - 可以查询 log4net 条目吗？

> ID：10964863
> 
> 赞同：2
> 
> 时间：2012-06-09T21:54:06.773
> 
> 标签：c#, debugging, log4net, event-log

我知道我可以写入 EventLog 并查询它。我想实现用户选择一个菜单项的功能，该菜单项将查询连接到我的应用程序的所有警告和错误消息并将它们发送给我。

我可以使用 C# 和事件日志来完成所有这些工作。log4net 也可以吗？显然我可以用 log4Net 记录警告和错误消息，但是我可以查询 log4Net“数据库”吗？或者日志消息甚至没有保存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:42:28.670

您可以选择在 log4net 中使用不同的文件附加程序来写入不同的日志文件。我目前有一个用于错误和一个用于跟踪记录，以便我可以记录我的代码活动。

查看此链接以获取有关如何实现此功能的示例 - [http://geekswithblogs.net/ontheledge/archive/2009/09/23/logging-with-log4net.aspx](http://geekswithblogs.net/ontheledge/archive/2009/09/23/logging-with-log4net.aspx)

此外，如果您希望解析文本日志文件，请参阅有关解析 log4net 文件以获取错误代码的旧 StackOverflow 问题 - [Parse log files in programmatically in .NET](https://stackoverflow.com/questions/3250635/parse-log-files-programmatically-in-net)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T21:57:12.150

使用 Log4net，您可以选择多种方式来编写日志。如果它们是文本文件，您可以解析它们并发送数据（显然无法查询文本文件）。

但是，您可以使用 log4net 登录到事件日志，这样您就可以保留事件日志实现以进行查询，并使用 log4net 登录到那里。

编辑：以下链接列出了您可以登录的不同内容。您可以登录到数据库。如果您想完全删除菜单选项并将所有日志输出发送回您的服务器，您甚至可以将输出发送到远程日志。[http://logging.apache.org/log4net/release/features.html](http://logging.apache.org/log4net/release/features.html)

我只使用 log4net 来记录文本文件和 Windows 事件日志。两者都很简单直接。我会推荐它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T22:32:07.200

您可以将 log4net 设置为登录到数据库表，然后您可以像查询任何数据库对象一样查询它：

[http://logging.apache.org/log4net/release/config-examples.html](http://logging.apache.org/log4net/release/config-examples.html)

# ruby-on-rails - 用户可定制的带有导轨的模板引擎

> ID：10964865
> 
> 赞同：1
> 
> 时间：2012-06-09T21:54:12.647
> 
> 标签：ruby-on-rails, templates

我想创建一个应用程序，它允许用户自定义他们的布局或开发他们自己的模板并像[Wordpress](http://wordpress.org/)一样安装。我想用[Rails](http://rubyonrails.org/)实现这个目标！这是rails中已解决的问题还是我需要从头开始开发的问题？任何有关如何实现这一目标的资源都将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T01:14:11.480

两种主要语言是 Liquid 和 Mustache。这里有一些关于该主题的内容：[Rails 最终用户模板引擎：Liquid vs Mustache vs. Others？](https://stackoverflow.com/questions/5129925/rails-end-user-templating-engines-liquid-vs-mustache-vs-others)

# android - 由于某种原因无法创建 ListView？

> ID：10964870
> 
> 赞同：1
> 
> 时间：2012-06-09T21:56:03.900
> 
> 标签：android

我一直在使用 Google 的教程编写 ListView，但由于某种原因，错误不断发生。我已经确保创建外部存储权限，就像我在另一篇文章中看到的那样，但仍然发生了一些事情。

主要活动：

```
public class FlashcardsActivity extends ListActivity {
private ListView mainList;
private final String[] listOptions = {"Test!","New Set", "Edit Existing"};
/** Called when the activity is first created. */
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
setListAdapter(new ArrayAdapter<String>(this, R.layout.list_row,listOptions));

mainList=(ListView)findViewById(R.id.mainList);
mainList.setTextFilterEnabled(true);

mainList.setOnItemClickListener(new OnItemClickListener(){
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
        Toast.makeText(getApplicationContext(), ((TextView)view).getText(),Toast.LENGTH_SHORT).show();
    }
});
}
} 
```

日志猫：

```
06-09 21:29:32.239: D/AndroidRuntime(221): Shutting down VM
06-09 21:29:32.239: W/dalvikvm(221): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
06-09 21:29:32.250: E/AndroidRuntime(221): Uncaught handler: thread main exiting due to uncaught exception
06-09 21:29:32.259: E/AndroidRuntime(221): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.aft.flashcards/com.aft.flashcards.FlashcardsActivity}: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.app.ActivityThread.access$2200(ActivityThread.java:119)
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.os.Handler.dispatchMessage(Handler.java:99)
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.os.Looper.loop(Looper.java:123)
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.app.ActivityThread.main(ActivityThread.java:4363)
06-09 21:29:32.259: E/AndroidRuntime(221):  at java.lang.reflect.Method.invokeNative(Native Method)
06-09 21:29:32.259: E/AndroidRuntime(221):  at java.lang.reflect.Method.invoke(Method.java:521)
06-09 21:29:32.259: E/AndroidRuntime(221):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
06-09 21:29:32.259: E/AndroidRuntime(221):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
06-09 21:29:32.259: E/AndroidRuntime(221):  at dalvik.system.NativeStart.main(Native Method)
06-09 21:29:32.259: E/AndroidRuntime(221): Caused by: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.app.ListActivity.onContentChanged(ListActivity.java:236)
06-09 21:29:32.259: E/AndroidRuntime(221):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:201)
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.app.Activity.setContentView(Activity.java:1622)
06-09 21:29:32.259: E/AndroidRuntime(221):  at com.aft.flashcards.FlashcardsActivity.onCreate(FlashcardsActivity.java:19)
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
06-09 21:29:32.259: E/AndroidRuntime(221):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
06-09 21:29:32.259: E/AndroidRuntime(221):  ... 11 more
06-09 21:29:32.290: I/dalvikvm(221): threadid=7: reacting to signal 3
06-09 21:29:32.290: E/dalvikvm(221): Unable to open stack trace file '/data/anr/traces.txt': Permission denied 
```

主.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<ListView android:id="@+id/list"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"/>

</LinearLayout> 
```

有谁知道问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T21:57:42.680

错误日志很清楚：

> 06-09 21:29:32.259: E/AndroidRuntime(221): Caused by: java.lang.RuntimeException: 您的内容必须有一个 ID 属性为“android.R.id.list”的 ListView

你的主布局中需要一个`ListView`with `android:id="@android:id/list"`。

# php - jquery加载没有结果

> ID：10964871
> 
> 赞同：0
> 
> 时间：2012-06-09T21:56:12.710
> 
> 标签：php, jquery, html, parameters

我正在与一个应该将一些评论加载到我的评论区域中的 jquery 加载事物作斗争。

我用这个

```
$("#designCommentsBox").load("pullcomment.php"); 
```

我的 pullcomment.php 看起来像这样：

```
<?php
define("INCLUDE_DIR", "includes/classes");

/* Autoload classes when used */
function __autoload($class_name) { include(INCLUDE_DIR.'/class.'. strtolower($class_name) . '.php'); } 

SQLHandling::SQLconnect();
Designs::GetCommentsForDesign(1); //Default value for testing
?> 
```

GetCommentsForDesign 函数是这样的：

```
function GetCommentsForDesign($design_id) {
        $sql = SQLHandling::selectSQL('*', 'tdic_comments', 'design_id = '. $design_id .'');
        $result = SQLHandling::SQLquery($sql);            

        $markers = array();

        $markers["###NUM_COMMENTS###"] = mysql_num_rows($result);

        if(mysql_num_rows($result) < 1) {
            $markers["###COMMENTS###"] = "No comments";           
        } else { 

        while($row = SQLHandling::SQLfetch($result)) {
            $markers["###COMMENTS###"] = '<div class="commentBox">';
                $markers["###COMMENTS###"] .= '<div class="commentLeft"><img src="ss.jpg" /></div>';
                $markers["###COMMENTS###"] .= '<div class="commentRight">';

                    if(!empty($row["website"])) {
                        $markers["###COMMENTS###"] .= '<span class="commentPoster"><a href="'. $row["website"] .'" target="_blank" rel="external nofollow">'. $row["name"] .'</a></span>';    
                    } else {
                        $markers["###COMMENTS###"] .= '<span class="commentPoster">'. $row["name"] .'</span>'; 
                    }
                    $markers["###COMMENTS###"] .= '<br /><span class="commentDate">'. date('d-m-Y', $row["date_added"]) .'</span>';    
                    $markers["###COMMENTS###"] .= '<p class="comment">'. $row["comment"] .'</p>';
                $markers["###COMMENTS###"] .= '</div>';
            $markers["###COMMENTS###"] .= '</div>';
        }
        }
        Main::GetMarkers($markers);

    } 
```

负载应该将所有评论加载到此，但我没有得到任何东西

```
<div id="designCommentsBox">
</div> 
```

奇怪的是，如果我`$row["comment"]`在 GetCommentsForDesign 函数中执行回显，该注释确实会被打印出来。

谁能看到我做错了什么？

第二个问题如何将 URL 参数传递给加载？像这样

```
$("#designCommentsBox").load("pullcomment.php?designid=1"); //From the URL 
```

然后将该参数传递给函数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:18:19.580

没关系！我的网站有一些糟糕的 javascript！有了它，一切都井井有条！对不起！

# jquery - 带有 jQ uery 的 DIV 预加载器

> ID：10964872
> 
> 赞同：0
> 
> 时间：2012-06-09T21:56:16.073
> 
> 标签：jquery, preload

我有一个用于 div 预加载的 Javascript 代码，但我需要使用 jQuery 进行预加载。这是我的代码：

```
<script type="text/javascript">
window.onload=function(){
        document.getElementById('preload').style.display = 'block';
        document.getElementById('ajax-loader').style.display = 'none';
    }
</script>

<style type="text/css">
div#preload{
        display:none;
        margin:0 auto;
  }
</style>

<img src="/images/ajax.gif" id="ajax-loader"  />
<div id="preload">Some text</div> 
```

如何使用 jquery 为 DIV 进行淡出预加载？感谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T21:58:56.400

这不完全等同于 javascript，但看起来它会做你想做的事：

工作演示：http: [//jsfiddle.net/lucuma/84j5S/](http://jsfiddle.net/lucuma/84j5S/)

```
$(document).ready(function() {
   $('#preload').show();
   $('#ajax-loader').hide();
}); 
```

等效的是：

工作演示：http://jsfiddle.net/lucuma/84j5S/2/

```
$(document).ready(functon() {
   $('#preload').css('display','block');
   $('#ajax-loader').css('display','none');
}); 
```

这些 jquery 解决方案与通过 css 执行此操作相同：

```
#preload {display:block}
#ajax-loader {display:none} 
```

尽管除非您打算将 jquery 添加到您的项目中，否则没有理由仅仅为此而包含该库。

# android - 应用错误计费

> ID：10964878
> 
> 赞同：-1
> 
> 时间：2012-06-09T21:57:14.160
> 
> 标签：android, billing, google-play

我在 google play 中使用应用内产品创建了一个测试应用程序。 [http://developer.android.com/guide/market/billing/billing_admin.html](http://developer.android.com/guide/market/billing/billing_admin.html)

我在我的应用程序中添加了计费部分。我还在 google play 中添加了一个产品。当我单击我的应用程序中的链接时。Google Play 商店以我的产品的正确名称作为午餐。2秒后，我得到了这个错误：

应用程序错误这个版本的应用程序没有配置通过google play进行计费。查看帮助文件以获取更多信息

![在此处输入图像描述](../Images/b31f1d18ffbd008499e20689a331b441.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:43:22.237

您需要使用您的实时证书签署您的 APK。然后将其安装到您的测试设备上。然后您可以测试 InAppBilling。

如果您使用的是 android.test.purchased，它将一直有效，但您的最终响应中不会包含 developerPayload。

如果您在应用程序项目中使用自己的草稿，您可以一路测试，但您*需要*付费，因此之后必须自己退款。

您不能使用与 google play 开发控制台相同的 gmail 帐户购买商品。

有关更多详细信息，请参见此处：[http ://blog.blundell-apps.com/simple-inapp-billing-payment/](http://blog.blundell-apps.com/simple-inapp-billing-payment/)

:D

# java - Java中捕获异常的顺序

> ID：10964882
> 
> 赞同：39
> 
> 时间：2012-06-09T21:57:47.540
> 
> 标签：java, exception

如果我没记错的话，应该首先捕获异常的子类。但是必须捕获任何 RuntimeException 和一个具体的检查异常，首先应该捕获它们？

```
try {
    ...
} catch(RuntimeException e) {
    ...
} catch(IOException e) {
    ...
} 
```

这个顺序是正确的吗？或者它是正确的但一个糟糕的选择？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-06-09T22:00:41.090

顺序是**首先匹配的，然后执行**（[正如 JLS 清楚地解释的那样](http://docs.oracle.com/javase/specs/jls/se7/html/jls-11.html#jls-11.3)）。

如果第一个 catch 与异常匹配，则执行，如果不匹配，则尝试下一个并不断尝试，直到有一个匹配或没有匹配。

因此，在捕获异常时，您希望始终先捕获**最具体**的异常，然后再捕获最通用的异常（如 RuntimeException 或 Exception）。例如，假设您想捕获[String.charAt(index)](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#charAt%28int%29)方法抛出的**[StringIndexOutOfBoundsException](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/StringIndexOutOfBoundsException.html)** ，但您的代码也可能抛出[NullPointerException](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/NullPointerException.html)，以下是捕获异常的方法：

```
String s = null;
try {
  s.charAt(10);
} catch ( NullPointerExeption e ) {
  System.out.println("null");
  e.printStackTrace();
} catch ( StringIndexOutOfBoundsException e ) {
  System.out.println("String index error!");
  e.printStackTrace();
} catch ( RuntimeException e ) {
  System.out.println("runtime exception!");
  e.printStackTrace();
} 
```

所以，按照这个顺序，我确保异常被正确捕获并且它们不会相互绊倒，如果它是**NullPointerException**它进入第一个捕获，如果是**StringIndexOutOfBoundsException**它进入第二个捕获，最后如果它是其他东西一个 RuntimeException （或从它继承，如**IllegalArgumentException**）它进入第三个捕获。

您的情况是正确的，因为 IOException 继承自 Exception 并且 RuntimeException 也继承自 Exception，因此它们不会相互绊倒。

首先捕获一个通用异常，然后再捕获它的一个后代，这也是一个编译错误，如下所示：

```
try {
  // some code here
} catch ( Exception e) {
  e.printStackTrace();
} catch ( RuntimeException e ) { // this line will cause a compilation error because it would never be executed since the first catch would pick the exception
  e.printStackTrace();
} 
```

所以，你应该先有孩子，然后才有父母例外。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-10T03:10:54.460

> 这个顺序是正确的吗？或者它是正确的但一个糟糕的选择？

两者都不。正如其他答案所说，编译器应该告诉您是否将简单的捕获按顺序排列，其中一个捕获另一个。

但是您的代码中还有另一个潜在的问题：您是否真的在捕捉`RuntimeException`。问题是未经检查的异常有很多来源/原因，其中许多来源/原因实际上是您的应用程序中的错误。

使用`catch`记录诊断作为紧急关闭的一部分是可以的，但是如果您捕获*并尝试从中恢复* `RuntimeException`，则需要注意不要在地毯下扫除严重的问题：

*   无论如何，请确保记录异常及其堆栈跟踪。

*   考虑尝试恢复是否*明智。*如果你有一个未知的错误，它可能会在触发异常之前造成不可预知的损害。您无法知道应用程序是否可以恢复，或者它是否会因尝试继续而造成更严重的损害。

同样的建议也适用于 catch`Exception`和`Throwable`/ `Error`。由于很可能已经发生的损害的性质，它对`Throwable`/更为关键。`Error`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T22:00:12.307

编译器将接受的任何顺序都是正确的。

# php - mysqli_query 和 mysqli_fetch_assoc 为空

> ID：10964884
> 
> 赞同：0
> 
> 时间：2012-06-09T21:58:04.843
> 
> 标签：php, mysqli

对于一个学校项目，我正在创建一个虚构的在线银行网站，该网站可以访问学校的数据库以获取虚构的帐户信息。每次查看帐户时，我都会收到两个 mysqli 错误。一个在 person.class.php 的第 26 行，另一个在 veiwaccounts.php 的第 52 行 我在我的 person 类中追踪了该错误的主要原因，但似乎无法以任何方式修复它。错误是

> 警告：mysqli_query() 期望参数 1 为 mysqli，在第 26 行的 .../person.class.php 中给出 null
> 警告：mysqli_fetch_assoc() 期望参数 1 为 mysqli_result，在 .../viewaccounts.php 中给出 null第 52 行

以下是 viewaccounts.php 文件中的一些代码示例：

```
if($currentMember)
{
    $currentMember = new Person($memberid);
    $accounts =  $currentMember->retrieve_all_accounts();

    //HERE IS WHERE THE PROBLEM IS $accounts = $currentMember->retrieve_all_accounts(); 

    //Loop through accounts
    while($account = mysqli_fetch_assoc($accounts)) {
        //Retrieve balance
        $bankaccount = new Bankaccount($account['BankAccountID']);
        $bankaccount->connection = $conn;
        $balance = mysqli_fetch_assoc($bankaccount->retrieve_current_balance()); 
```

以下是人员类文件的代码：

```
public function retrieve_all_accounts() {
    $accounts_query = "SELECT BankAccountID FROM BankAccount WHERE UserID = " .$this->memberid;
    $result = mysqli_query($this->connection, $accounts_query);
    return $result;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:08:01.157

您正在使用变量`person`中的成员 id实例化您的类。`$memberid`尝试在`$memberid`此处传递一个值[在其中传递一个值以实例化类的对象`person`]并用于`var_dump`调试它是否真的返回任何值。并`$currentMember->connection = $conn;`在实例化对象后放置。很可能您的问题是在这里引起的。您试图`person`在实例化它之前访问该类的公共变量连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T22:12:32.863

改变

```
 //Accounts
    $currentMember->connection = $conn;

    //instantiating class here since suggested code from video fails to do it.

if($currentMember)
{
    $currentMember = new Person($memberid);
    $accounts =  $currentMember->retrieve_all_accounts();

}else
{
    echo "<p>not working</p>";
} 
```

到

```
if(!$currentMember) {
  $currentMember = new Person($memberid);
}
$currentMember->connection = $conn;
$accounts =  $currentMember->retrieve_all_accounts(); 
```

为了便于阅读，我还将它转移到第一个 PHP 代码块中。

`Person`只有在`$currentMember`评估为时才实例化一个新对象`TRUE`- 如果`unserialize()`调用失败`$currentMember`将评估为`FALSE`，那就是您应该创建一个新对象的时候。

此外，您首先分配了`connection`属性，当您创建 new 时，该属性将被销毁，`Person`您可能每次都会这样做，否则您会看到更多警告。

`Person`您还应该重构测试是否保存在- 中的整个逻辑，`$_SESSION`首先，会话将序列化对象本身，因此您不需要调用`serialize()`/ `unserialize()`。相反，您应该做的是定义一个[`__autoload()`](http://uk.php.net/manual/en/function.autoload.php)函数并将对象实例存储在`$_SESSION`.

我还注意到您的开发服务器似乎已[`short_open_tag`](http://www.php.net/manual/en/ini.core.php#ini.short-open-tag)打开 - 将其关闭，使用它是不好的做法，因为它在现实世界中几乎无处不在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T22:17:41.280

看起来您的`Database`对象初始化连接有问题。它可能没有连接，因为错误表明您没有`mysqli`向`mysli_query()`.

尝试查看班级中的[mysqli_connect_error()](http://www.php.net/manual/en/mysqli.connect-error.php)和[mysqli_connect_errno()](http://www.php.net/manual/en/mysqli.connect-errno.php)以`Database`确定在连接和从那里工作时是否出现错误。

# ruby-on-rails - 在用户注册之前在会话或数据库中存储相对较大的文本？

> ID：10964885
> 
> 赞同：1
> 
> 时间：2012-06-09T21:58:10.923
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想创建一个页面流，允许用户在注册之前使用该服务，因此在此之前创建的数据必须以状态存储。

到目前为止，我的选择是

1.  内存中的会话
2.  饼干
3.  将数据直接存储到 db 中。

在这种情况下，使用期间生成的文本/字符串的大小可以达到 100k。考虑到可扩展性，哪种方法最好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:05:34.297

您不应该在会话变量或 cookie 中存储 100k 的数据。在性能和安全性方面存在缺点

您应该将它们存储在数据库中，无论是在暂存区域还是标记为初始的表单中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T23:21:34.650

只是想补充一点，我认为cookie存储限制是4kb，所以甚至不可能存储100kb。您是否研究过 HTML5 本地存储？我认为浏览器的限制是 2.5-5+ MB，给你更多的空间。

# php - MySQL 中的动态复选框和文本字段

> ID：10964891
> 
> 赞同：1
> 
> 时间：2012-06-09T21:59:37.533
> 
> 标签：php, mysql, arrays, forms, dynamic-data

我正在尝试创建一个库存跟踪器。我的问题是库存可以是从 1 件物品到 1 公制对接（给予或接受）物品的任何地方。基本形式是这样的：

**eq.issue.php**

```
<form name="form" method="post" action ="issue.e.php">
    <?
        $kit_query = mysql_query("SELECT * FROM eq_kit");
        while($fetch_kits = mysql_fetch_array($kit_query){
        $kitId = $fetch_kits['kit_id'];
        $kitSn = $fetch_kits['kit_sn'];
        $kitQty = $fetch_kits['kit_qty'];
    ?>
    <tr>
        <td>
            <input type="checkbox" name="kit_row[]" value="<?=$kitId?>" id="<?=$kitId?>">
        </td>
        <td>
            <input name="qty[]" type="text" id="<?=$kitQty?>" value="<?=$kitQty?>">
        </td>
        <td>
            <input name="sn[]" type="hidden" id="<?=$kitSn?>" value="<?=$kitSn?>"
        </td>
    </tr>
    <? } ?>
    <input type="submit" name="Submit" id="Submit" value="Submit">
</form> 
```

在接收方：

**问题.e.php**

```
<? // all the database crap

if(is_array($kit_row)){
    foreach($_POST['kitrow'] as $key=>$val){
        $sn=$_POST['sn'];
        $serial = $sn[$val];
        $qty = $_POST['qty'];
        $quant = $qty[$val];

    mysql_query("INSERT INTO eq_issue SET issue_sn = '$serial', issue_qty = '$quant'")or die(mysql_error()); 
```

这适用于单个项目以及连续项目。

以我的 eq.issue.php 表单为例：

```
|Check | Qty | SN  |
==================== 
| X    | 100 |12345| 
|      | 1   |23456| 
|      | 1   |98765| 
| X    | 999 |19283|
==================== 
|Submit| 
```

我的问题是，如果我选择第一个和第四个选项，例如，数组现在看起来像这样：

```
kit_row => Array
  0 => 4
  1 => 3

qty => Array
  0 => 100
  1 => 1
  2 => 1
  3 => 999

sn => Array
  0 => 12345
  1 => 23456
  2 => 98765
  3 => 19283 
```

因此，当我的脚本运行时，我将第 4 个选项的值设为 kit_row => 3 qty => 1 sn=> 23456，我希望它显示 kit_row=> 3 qty => 999 sn => 19283。

关于如何完成这项工作的任何建议？为了获得更好的视觉参考，我试图实现与 PHPMyAdmin 的多值插入页面相同的概念，使用复选框来说明我要插入的记录组（或行）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:00:33.083

您可以 foreach`$_POST['qty']`或`$_POST['sn']`代替`$_POST['kit_row']`.

或者使用 kit_id 作为表单字段的索引，这样可以在服务器端知道什么是什么：

```
<input type="checkbox" name="kit_row[<?=$kitId?>]" value="1">
<input name="qty[<?=$kitId?>]" type="text" id="<?=$kitQty?>" value="<?=$kitQty?>">
<input name="sn[<?=$kitId?>]" type="hidden" id="<?=$kitSn?>" value="<?=$kitSn?>"> 
```

这样，您可以使用数据库中的 ID 访问服务器上发布的数据，而不是像这样使用 0、1、2...：

```
if (is_array($_POST['kit_row']))
{
    foreach ($_POST['kit_row'] as $kitId => $val)
    {
        $sn=$_POST['sn'];
        $serial = $sn[$kitId];
        $qty = $_POST['qty'];
        $quant = $qty[$kitId]; 
```

也可以在每个复选框前面添加一个具有相同名称和值 0 的隐藏字段。不过，您必须将 kit_row[] 替换为真实索引：

```
<input type="hidden" name="kit_row[<?php echo $i; ?>]" value="0">
<input type="checkbox" name="kit_row[<?php echo $i++; ?>]" value="1"> 
```

这样，值在两种情况下都会被提交，勾选和取消勾选。

# c - %q 使用 -arch i386 进行内联汇编

> ID：10964893
> 
> 赞同：2
> 
> 时间：2012-06-09T21:59:46.510
> 
> 标签：c, assembly, cross-compiling, inline-assembly

我正在使用一个库（pulseaudio、src/pulsecore/svolume_mmx.c），它的代码类似于以下虚拟代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <inttypes.h>

int main(int argc, char *argv[]) {
  int32_t x = 5;
  int32_t *p_x = &x;
#if defined(__i386__)
  int32_t tmp;
#elif defined(__amd64__)
  int64_t tmp;
#endif

  __asm__ __volatile__ (
    " xor %1, %1                    \n\t"
    " movd (%q0, %1, 4), %%mm0      \n\t"
    " emms                          \n\t"
    : "+r" (p_x), "+r" (tmp)
  );
  printf("%"PRId32"\n", x);
  return 0;
} 
```

我正在尝试将其编译为 64 位 mac osx 上的 32 位库。当我正常编译它时，一切正常，但是当我使用 -arch 标志将它编译为所需的 32 位库时，会发生这种情况：

```
$ gcc -std=c99 -arch i386 -o main main.c
/var/folders/random_stuff_here.s:22:bad register name `%rcx, %edx,4)' 
```

读取 gcc 的汇编输出后，问题出在 movd 行。%q0 寄存器被填充为 %rcx，它是一个 64 位寄存器。汇编器试图从中创建 32 位输出，但失败了。

我找不到太多关于 %q0 中的 'q' 的含义，但我最终找到了[不同编译器](http://www.pgroup.com/doc/pgiug.pdf)的文档（第 194 页），它将 q 描述为“如果目标为操作数，则为操作数生成四字寄存器名称支持四字。否则，它会产生一个字寄存器名称。（例如，如果操作数 0 在寄存器 'a' 中，则 %q0 在 x86_64 上产生 %rax 或在 x86 上产生 %eax。）如果您使用 'q' 标志请求 asm 块输出 64 位寄存器，即使 -arch 标志指定 32 位输出也是如此。

除了 -arch i386 标志之外，使用 -m32 标志根本没有帮助。如何告诉 asm 代码生成器仅对 %qx 符号使用 32 位寄存器？我宁愿为 gcc 提供额外的标志，而不是修改这个库的源代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T11:06:22.217

看起来您拥有的 gcc 不喜欢在寻址表达式中显式混合 a`%q`和*普通*寄存器，和/或评估`%q`为 64 位 reg 名称，即使您正在显式编译 32 位（并且它在那里不存在） ）。

但是，`__asm__`由于您在寻址表达式中（错误）匹配使用（非）指针数据类型，因此在您/您的库特定表达式中使用它是相当虚假的。您可以相对容易地纠正它：

```
#include <stdint.h>    // has [u]intptr_t and "sized types" [u]int(8|16|32|64)_t
...
int myintval = 0;
int tmp = 0;

__asm__("mov (%0, %1, 4), ..."
    : : "r"((void*)(intptr_t)myintval), "r"((void*)(intptr_t)tmp)); 
```

即首先手动将数据类型强制为`[u]intptr_t`（与指针相同底层大小的整数类型，与您是在 32 位还是 64 位平台上无关），然后强制为实际指针（`void*`），您将其传递给输入寄存器约束.

这确保编译器将您的整数变量分配给可用于寻址操作的寄存器；该代码将在 32 位和 64 位 x86 中正常工作，并且无需使用显式寄存器宽度说明符。

成本/缺点 ? 好吧，在 64 位中，如果您*使用*寄存器而不是仅仅使用它们进行寻址，那么 eg`xor %...,%...`就变成了显式的`xorq %r...,%r...`（带有 REX 前缀），即使这不是严格要求的。如果您不能接受，请使用`#ifdef`/`#else`创建一个 32 位和一个 64 位代码块。

附带说明一下，如果您不能/不想修改库源代码，请尝试获取不同的 gcc 版本（下载更新的 XCode）。我无法用 gcc 3.4.5 和各种 4.[14567].x 重现您的问题，但手头没有任何 4.2.x。

# delphi - 慢速图像缩放的数学

> ID：10964902
> 
> 赞同：5
> 
> 时间：2012-06-09T22:00:58.730
> 
> 标签：delphi, delphi-xe

我有一个带有漫画书布局的 .bmp 图像。目前我的代码是这样工作的。如果我右键单击并按住鼠标按钮，我可以在漫画书页面上的一个框架周围绘制一个选取框类型框。当我释放按钮时，它将放大该帧。但它的瞬间。我希望它具有动画效果。

因此，不要将 PicRect 的值设置为“END VALUE”

```
PicRect.Left
PicRect.right
PicRect.top
PicRect.bottom 
```

如下面的代码所示，我需要一种方法来慢慢到达那里，某种 while 循环可以一次设置一些值，直到它达到“最终值”但我不能 100% 确定这个数学是如何计算的正在工作中。我的任何 while 循环尝试都不会做任何事情，只是放大得太远。这是程序。

```
procedure TZImage.MouseUp(Button: TMouseButton; Shift: TShiftState;
                      X, Y: Integer);
    var coef:Double;
    t:integer;
begin
   if FMouse=mNone then Exit;
   if x>ShowRect.Right then x:=ShowRect.Right;
   if y>ShowRect.Bottom then y:=ShowRect.Bottom;
   if FMouse=mZoom then begin  //calculate new PicRect
     t:=startx;
     startx:=Min(startx,x);
     x:=Max(t,x);
     t:=starty;
     starty:=Min(starty,y);
     y:=Max(t,y);
     FMouse:=mNone;
     MouseCapture:=False;
//enable the following if you want to zoom-out by dragging in the opposite direction}
    {     if Startx>x then begin
            DblClick;
            Exit;
         end;}
         if Abs(x-startx)<5 then Exit;
         if (x - startx < y - starty) then
         begin
           while (x - startx < y - starty) do
           begin
              x := x + 100;
              startx := startx - 100;
           end;
         end
         else if (x - startx > y - starty) then
         begin
            while (x - startx > y - starty) do
            begin
                y := y + 100;
                starty := starty - 100;
            end;
         end;

    //This is were it sets the zoom info. This is were
    //I have to change to slowly get the PICRECT.Left/right/top/bottom
         if (PicRect.Right=PicRect.Left)
         then
            coef := 100000
         else
            coef:=ShowRect.Right/(PicRect.Right-PicRect.Left);
         PicRect.Left:=Round(PicRect.Left+startx/coef);
         PicRect.Right:=PicRect.Left+Round((x-startx)/coef);
         if (PicRect.Bottom=PicRect.Top)
         then
            coef := 100000
         else
            coef:=ShowRect.Bottom/(PicRect.Bottom-PicRect.Top);
         PicRect.Top:=Round(PicRect.Top+starty/coef);
         PicRect.Bottom:=PicRect.Top+Round((y-starty)/coef);
       end;
       if FMouse=mDrag then begin
         FMouse:=mNone;
         Canvas.Pen.Mode:=pmCopy;
         Screen.Cursor:=crDefault;
       end;
       Invalidate;
    end; 
```

我相信这可以在上面的代码中完成。但也想添加这个以防万一它有帮助。

```
type
    TZImage = class(TGraphicControl)
  private
    FBitmap        : TBitmap;
    PicRect        : TRect;
    ShowRect       : TRect;
    FShowBorder    : boolean;
    FBorderWidth   : integer;
    FForceRepaint  : boolean;
    FMouse         : (mNone, mDrag, mZoom);
    FProportional  : boolean;
    FDblClkEnable  : boolean;
    startx, starty,
    oldx, oldy     : integer; 
```

感谢您为使其正常工作提供的任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T22:31:38.400

我有一些建议；我不确定它们是否足以解决您的问题，但我希望它可以帮助您实现目标。

首先，你的`while`循环做了很多有趣的摆弄：

```
if (x - startx < y - starty) then
     begin
       while (x - startx < y - starty) do
       begin
          x := x + 100;
          startx := startx - 100;
       end;
     end
else if (x - startx > y - starty) then
     /* similar code */ 
```

请注意，`x - start == y - starty`案例被完全忽略了。我不知道这是否重要。

其次，这可能会在没有循环的情况下重写。我在这里猜测，需要进行一些测试才能确定这是否正确，但这感觉像是正确的道路：

```
foo := (x - startx) - (y - starty)
if (foo > 200 || foo < -200)
    bar = foo / 200  # I assume integer truncation
    x += bar * 100
    startx += bar * 100 
```

我不完全确定您为什么要尝试`(x-startx) - (y-starty)`彼此相距 200 以内；可能还有更好的东西。

这部分代码有点混乱：

```
if (PicRect.Right=PicRect.Left)
     then
        coef := 100000
     else
        coef:=ShowRect.Right/(PicRect.Right-PicRect.Left);
     PicRect.Left:=Round(PicRect.Left+startx/coef);
     PicRect.Right:=PicRect.Left+Round((x-startx)/coef);
     if (PicRect.Bottom=PicRect.Top)
     then
        coef := 100000
     else
        coef:=ShowRect.Bottom/(PicRect.Bottom-PicRect.Top);
     PicRect.Top:=Round(PicRect.Top+starty/coef);
     PicRect.Bottom:=PicRect.Top+Round((y-starty)/coef);
   end; 
```

`coef`应该从前面的内容覆盖吗？或者，您是否应该计算 a `coefx`，`coefy`然后选择（更大？更小？接近 100000？）值来为`.Left`、`.Right`、`.Top`和`.Bottom`计算服务？我不得不认为，就目前而言，这段代码更有可能导致内容的尴尬拉伸，从而可能会惹恼用户和作者。

现在，要解决你在这里的*真正*原因，动画缩放 - 你可能需要彻底改变*一些东西*。我觉得你的`while`循环可能是为了进行缩放，但它们是*在*计算之后出现的`coef`，所以我认为它们是为了其他目的。但是，一旦您确定了将循环精确放置在何处以计算`coef`从“无缩放”到“最终缩放”范围内的不同值，您还需要添加调用以*重新绘制*显示 - 或者，取决于您的环境中，可能需要添加一些由计时器每 50 毫秒触发一次的回调代码，或者使用更新的`coef`值重新绘制。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-16T17:58:50.593

不要使用 while 循环来更新缩放级别，因为有两个问题：

1.  不同的动画时长，因为缩放操作的速度取决于代码的速度、当前的CPU使用率、CPU型号等...
2.  阻塞 te GUI，因为即使您使用延迟（例如使用`Sleep`），代码也在主线程中运行并且程序结果是无响应的。

就像[sarnold](https://stackoverflow.com/a/10965048/757830)和[Elling](https://stackoverflow.com/a/10967798/757830)已经说过的：使用计时设备（例如 a `TTimer`）在每个间隔上执行总缩放操作的一部分。现在，有两种方法可以计算这些*部分*：

1.  将要桥接的总距离划分为固定数量的小距离，将计时器的间隔设置为总持续时间除以该数字，并处理每个间隔上所有已处理距离的总和。这种方法的缺点是双重的：
    *   计时器的设置间隔是一个近似值，由于各种原因并不准确，其中一个原因是依赖于 Windows 消息传递系统，
    *   因此可能会出现粗糙或不流畅的动画。
2.  在每个间隔重新计算要桥接的部分距离。这样，无论下一个间隔是否需要两倍以上，动画都会始终显得流畅。

我在您的[相关问题的](https://stackoverflow.com/q/11058857/757830)[这个答案](https://stackoverflow.com/a/11060840/757830)中使用了第二个解决方案，从中提取了以下相关片段：

```
procedure TZImage.Animate(Sender: TObject); 
var 
  Done: Single; 
begin 
  Done := (GetTickCount - FAnimStartTick) / FAnimDuration; 
  if Done >= 1.0 then 
  begin 
    FAnimTimer.Enabled := False; 
    FAnimRect := FCropRect; 
  end 
  else 
    with FPrevCropRect do 
      FAnimRect := Rect( 
        Left + Round(Done * (FCropRect.Left - Left)), 
        Top + Round(Done * (FCropRect.Top - Top)), 
        Right + Round(Done * (FCropRect.Right - Right)), 
        Bottom + Round(Done * (FCropRect.Bottom - Bottom))); 
  Invalidate; 
end; 

procedure TZImage.Zoom(const ACropRect: TRect); 
begin 
  FPrevCropRect := FCropRect; 
  FAnimRect := FPrevCropRect; 
  FCropRect := ACropRect; 
  FAnimStartTick := GetTickCount; 
  FAnimTimer.Enabled := True; 
end; 
```

解释：

*   `FCropRect`是新的缩放矩形，`FPrevCropRect`是前一个，
*   `FAnimRect`是两者之间的矩形，取决于动画的进度，
*   `FAnimStartTick`是通过调用 开始缩放操作的时间`Zoom`，
*   在每个计时器间隔（设置为 15 毫秒，~67Hz 刷新率），`Animate`被调用，
*   `Done`是动画进度的百分比，
*   `Invalidate`触发将图形绘制到`FAnimRect`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-10T10:01:55.827

我写了一个回答你之前的问题（被一些可能是好意的stackoverflow版主永久删除）。

我之前的回答中的建议是您查看 glflow 代码示例：

[http://code.google.com/p/glflow/](http://code.google.com/p/glflow/)

该示例使用 GLScene 库，并说明了图像加载、图像缩放和动画。

即使你不使用 GLScene 库，我想你也可以通过查看代码示例对动画部分有所启发。

它的本质是您需要使用计时器来进行重绘。

首先将开始缩放级别和结束缩放级别之间的距离分成离散的步骤。然后使用计时器循环执行这些步骤并重绘每一步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T05:07:35.967

我实际上正在与 Glen 合作开展这个项目。我写了一些有问题的代码，所以我想澄清一下它的作用。我留下了评论，因为我很快就把它放在一起了。这里的大部分代码都是通过我们找到的开放许可证使用的。代码最初没有循环：

```
if (x - startx < y - starty) then
       begin
         while (x - startx < y - starty) do
         begin
            x := x + 100;
            startx := startx - 100;
         end;
       end
       else if (x - startx > y - starty) then
       begin
          while (x - startx > y - starty) do
          begin
              y := y + 100;
              starty := starty - 100;
          end;
       end; 
```

这就是我添加的内容，之所以添加它是因为原始代码没有按照我们认为的方式运行。基本上，您可以通过拖放选择区域。选定区域被放大，但不是显示选定的整个区域，而是适合查看区域的 x-startx 或 y-starty 中的较小者。因此，为了澄清这一点，如果您选择了一个 50pix 高和 100pix 宽的区域，它将缩放并从上到下填充 50pix 填充视图区域，但 100pix 会被剪裁。侧面从观看区域脱落。因此，此处添加的代码是通过使两者中较小的部分成为两者中的较大部分来解决问题。通过这样做，它实际上将适合原来的两者中较大的视图，现在是两者中的较小者。这是一个令人难以置信的草率修复，但它确实有效。您的方法也可以为我们解决这个问题，并且可能会以更好的方式解决。这一切的最大问题是，如果该区域是一个非常大的区域，那么 200pix 实际上可能不足以解决差异。出于我们的目的，它可能适用于 85% 以上，但不是全部，所以这段代码仍然需要工作。

您质疑的另一个代码实际上是之前让我们发疯的原因。整个文档完全没有评论，我们仍在努力拼凑出这一切的确切含义。coef实际上是让我发疯的原因。我什至不完全确定它首先意味着什么。我确实尝试了一个单独的 coefx 和 coefy ，这实际上打破了它。缩放框与想象的大不相同。据我所知，目前的方法没有增加奇怪的拉伸，至于我不确定的原因。

这是我们正在使用的代码的链接，但如果您想全面了解它。[http://www.torry.net/authorsmore.php?id=986](http://www.torry.net/authorsmore.php?id=986) Zimage 在那个页面上。

至于手头的实际问题，我们并不清楚 coef 究竟做了什么，因此对其进行更改会导致我们只是破坏事物而不是以试错的方式工作。如果您不介意看一下它，以便我们弄清楚它到底做了什么，这将使我们能够将其更改为正确的值，并在此过程中摆脱我的 slop 代码。这将允许我们前进到缩放动画。

添加关于动画的另一个问题。在这样做时，这是否也允许我们在从图像上的一个缩放点移动到另一个缩放点时添加动画。对于我们的应用程序，它将从一个漫画面板到另一个漫画面板，在下方或侧面，并且在大多数情况下也是不同的尺寸。在 left、right、top 和 bottom 的值之间加载是显示该类型动画的最佳方式吗？如果是这样，我认为这也适用于从完整图像移动到第一个缩放面板。

# sql - 在 sqlite 和/或 postgres/mysql 中存储不精确的日期

> ID：10964903
> 
> 赞同：0
> 
> 时间：2012-06-09T22:01:16.480
> 
> 标签：sql, cocoa, sqlite, datetime, date

我正在开发一个需要存储日期的应用程序。这很容易。但是，应用程序需要能够存储完全形成或缺失部分的日期。例如，用户可能有没有年的月和日，或者没有日的月和年。

确切的语言/后端尚未确定，但我可能会在 cocoa/sqlite 中创建一个 POC，以便我们可以与它们一起寻找答案。

我考虑了一个带有某种标志的三列表，一个 DATE/DATETIME 列和一个 TEXT 列，但这似乎......错了。

我相信我们只需要输入和显示数据，而不是比较或排序日期，但我现在并不完全确定。

想法？

编辑：感谢 Celada 的建议

该字段背后的想法是让用户输入过去可能发生的日期，因此可能不知道确切的日期。例如，用户可能知道某事件发生在 2001 年 3 月，或者生日是 1 月 3 日，而不是年份。

# android - 为什么我的 SMS 消息没有在我的列表中正确显示？

> ID：10964905
> 
> 赞同：2
> 
> 时间：2012-06-09T22:01:48.060
> 
> 标签：android, listview, arraylist, sms, contacts

我正在创建一个自定义 SMS 应用程序，例如 Handcent、Chomp、textPlus 和 Pansi SMS。我目前试图模仿的是这样的收件箱，但只有**联系人姓名**和在**textviews**中收到的**最新消息：http:** [//venturebeat.files.wordpress.com/2011/07/pinger_sms_free_inbox_android.png](http://venturebeat.files.wordpress.com/2011/07/pinger_sms_free_inbox_android.png)

 **在我的 SMSList 类（扩展 Activity）中，此方法被传递到我的 CustomAdapter 构造函数中：http: [//pastebin.com/TgsshJbc](http://pastebin.com/TgsshJbc)

在我的 CustomAdapter 类中，一个名为 elements 的数组列表保存来自上述方法的数据。所以什么时候这样做：

```
textview1.setText(elements.get(position); 
```

这将返回带有所有正确对应电话号码的所有短信。

***这是问题所在：***

我需要将电话号码分开并将其传递到**textview1**并将消息传递到**textview2。**我尝试过创建：

```
List<String> contactNo = new ArrayList<String>();
List<String> message = new ArrayList<String>();
ListIterator<String> it;
contactNo = elements;
message = elements;

it = contactNo.listIterator();
while (it.hasNext()) {
    it.set(it.next().split(" ")[0]); // Keep the number, discard the message
}

it = messages.listIterator();
while (it.hasNext()) {
    it.set(it.next().split(" ")[1]); // Keep the message, discard the number
} 
```

当我在 textview1 中尝试 contactNo 时，工作正常。但是 textview2 中的消息会导致列表错误并且什么也不显示。

***问题二：*** 以这种方式应用代码时（不使用除获取大小以外的元素），电话号码显示正确，但消息在第 7 条消息后重复出现。**请注意，我总共有 129 条短信，所以在我的 129 条项目列表中，前 7 条消息显示了 18 次：**

[http://pastebin.com/dJy2ie9g](http://pastebin.com/dJy2ie9g)

**目标：**

我的目标是在每个列表项的两个单独的文本视图中正确读取每个电话号码及其消息，就像将两者都读入一个文本视图一样。分离的原因是出于造型目的。有没有人知道为什么我在第一个和第二个问题上有错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T14:23:20.263

关于第二个问题：调用
`holder.latestSMS.setText(messages.get(position); // Display text message segment` 应该在 ' `if`' 语句之外（即它也应该被调用 when `convertView!=null`）

您不能假设`convertView`传递给的参数与参数`getView`匹配`position`**

# parsing - 获取Safari阅读器等网页的文章内容

> ID：10964906
> 
> 赞同：2
> 
> 时间：2012-06-09T22:02:04.550
> 
> 标签：parsing, safari, webpage

有没有人知道如何像 safari reader 或 evernote 一样获得网页的文章文本，以便我可以将文章文本用于进一步的工作？

# java - 无法登录网站

> ID：10964908
> 
> 赞同：0
> 
> 时间：2012-06-09T22:02:08.280
> 
> 标签：java, apache-httpclient-4.x, apache-httpcomponents

我正在尝试使用 java 和 eclipse 登录到带有 Http apache 客户端的站点。我尝试了许多编写代码的方法，但仍然无法正常工作：

```
CookieStore cookieStore = new BasicCookieStore();

HttpContext localContext = new BasicHttpContext();

localContext.setAttribute(ClientContext.COOKIE_STORE, cookieStore);

post = new HttpPost("http://www.biketrial.kiev.ua/forum/ucp.php?mode=login");

List<NameValuePair> params = new ArrayList<NameValuePair>(2);

String login = new String(log.getBytes("UTF-8"));

String pas =new String(password.getBytes("UTF-8"));

params.add(new BasicNameValuePair("username",login ));

params.add(new BasicNameValuePair("password", pas));

post.setEntity(new UrlEncodedFormEntity(params, "UTF-8"));

response = client.execute(post,localContext);

entity = response.getEntity();

BufferedReader br=new BufferedReader(new InputStreamReader(entity.getContent()));

String line="",ln="";

while((line=br.readLine())!=null){
    ln+=line+"\n";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:50:18.803

表单标签有一个独特的组件，每次登录尝试都会改变：

```
<form action="./ucp.php?mode=login&amp;sid=a1867e90f9f131fb99676a9db3892c95" method="post"> 
```

我不知道您还需要做什么，但至少，我希望您需要在尝试发布凭据之前加载登录页面并解析该操作 URL。另外，请注意，一些管理员不喜欢连接到供人类使用的站点的自动化系统。

# .net - 在 ViewModel 中获取 WPF ListView.SelectedItems

> ID：10964910
> 
> 赞同：15
> 
> 时间：2012-06-09T22:02:21.770
> 
> 标签：.net, wpf, listview, data-binding, mvvm

有一些帖子讨论了为`ListView.SelectedItems`大量代码添加数据绑定能力。在我的场景中，我不需要从 中设置它`ViewModel`，只需获取选定的项目以便对它们执行操作，它是由命令触发的，因此也不需要推送更新。

是否有一个简单的解决方案（就代码行而言），也许在代码隐藏中？只要不需要相互引用`View`，我就可以使用代码隐藏。`ViewModel`我认为这是一个更通用的问题：“ *VM 从按需查看数据的最佳实践*”，但我似乎找不到任何东西......

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-12T23:35:24.250

要获得`SelectedItems`仅在执行命令时，请使用`CommandParameter`并传入`ListView.SelectedItems`.

```
<ListBox x:Name="listbox" ItemsSource="{Binding StringList}" SelectionMode="Multiple"/>
<Button Command="{Binding GetListItemsCommand}" CommandParameter="{Binding SelectedItems, ElementName=listbox}" Content="GetSelectedListBoxItems"/> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-08-15T12:45:10.500

这可以使用交互触发器来实现，如下所示

1.  您将需要添加参考

    Microsoft.Expression.Interactions System.Windows.Interactivity

将以下 xmlns 添加到您的 xaml

```
xmlns:i="http://schemas.microsoft.com/expression//2010/interactivity"
xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" 
```

在您的 GridView 标记内添加下面的代码

```
<GridView x:Name="GridName">
<i:Interaction.Triggers>
   <i:EventTrigger EventName="SelectionChanged">
       <i:InvokeCommandAction Command="{Binding Datacontext.SelectionChangedCommand, ElementName=YourUserControlName}" CommandParameter="{Binding SelectedItems, ElementName=GridName}" />
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

ViewModel 中的代码在下面声明属性

```
public DelegateCommand<object> SelectionChangedCommand {get;set;} 
```

在 Viewmodel 的构造函数中初始化命令如下

```
SelectionChangedCommand = new DelegateCommand<object> (items => {
   var itemList = (items as ObservableCollection<object>).Cast<YourDto>().ToList();
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-10T06:03:44.533

我认为考虑“***视图和视图模型不需要相互了解***”是不正确的条件；*在 MVVM 视图中总是知道 ViewModel。*

我也遇到过这种情况，我必须在后面的视图代码中访问 ViewModel，然后填充一些数据（如所选项目），这在使用 ListView、DataGrid 等第三方控件时变得很有必要。

如果无法直接绑定 VM 属性，那么我将监听 ListViw.SelectionChanged 事件，然后在该事件中更新我的 ViewModels SelectedItems 属性。

**更新：**

要启用 VM 从视图中提取数据，您可以在视图上公开一个处理视图特定功能的接口，并且 ViewModel 将通过该接口引用您的视图；使用接口仍然使 View 和 ViewModel 在很大程度上解耦，但我一般不喜欢这样。

[MVVM，提供 View 到 ViewModel 的关联](http://blogs.msdn.com/b/davihard/archive/2010/05/10/repost-mvvm-providing-the-association-of-view-to-viewmodel.aspx)

我仍然更喜欢在 View 中处理事件并保持 VM 更新（使用所选项目）的方法，这样 VM 在执行任何操作之前不必担心提取数据，它只需要使用可用的数据（因为那将永远更新一个）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-22T02:06:55.140

我可以向您保证：**SelectedItems**确实可以绑定为 XAML **CommandParameter**

经过大量的挖掘和谷歌搜索，我终于找到了解决这个常见问题的简单方法。

要使其正常工作，您必须**遵循以下所有规则**：

1.  按照[Ed Ball 的建议](https://stackoverflow.com/a/336258/378115)，在您的 XAML 命令数据绑定上，在**Command**属性之前定义**CommandParameter**属性。这是一个非常耗时的错误。

***   确保您的**ICommand**的**CanExecute**和**Execute**方法具有**对象**类型的参数。这样，您可以防止数据绑定*CommandParameter*类型与命令方法的参数类型不匹配时发生的静默**强制转换**异常。

    ```
    private bool OnDeleteSelectedItemsCanExecute(object SelectedItems)  
    {
        // Your goes heres
    }

    private bool OnDeleteSelectedItemsExecute(object SelectedItems)  
    {
        // Your goes heres
    } 
    ```** 

 **例如，您可以将 listview/listbox 的**SelectedItems**属性发送给您的**ICommand**方法或它自己的 listview/listbox。太好了，不是吗？

希望它可以防止有人花费大量时间来弄清楚如何接收**SelectedItems**作为**CanExecute**参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-05T20:35:22.957

由于没有其他答案对我有帮助（一如既往地使用`SelectedItems`）`CommandParameter`，`null`因此这是通用 Windows 平台 (UWP) 应用程序的解决方案。它使用`Microsoft.Xaml.Interactivity`和工作`Microsoft.Xaml.Interactions.Core`。

这是视图：

```
<ListView x:Name="ItemsList">
    <Interactivity:Interaction.Behaviors>
         <Core:EventTriggerBehavior EventName="SelectionChanged">
             <Core:InvokeCommandAction Command="{x:Bind ViewModel.SelectedItemsChanged}" />
         </Core:EventTriggerBehavior>
    </Interactivity:Interaction.Behaviors>
    <!-- content etc. -->
</ListView> 
```

这是 ViewModel（`RelayCommand`是 MVVM Light 的一个类）：

```
private List<YourType> _selectedItems = new List<YourType>();

private RelayCommand<SelectionChangedEventArgs> _selectedItemsChanged;
public RelayCommand<SelectionChangedEventArgs> SelectedItemsChanged
{
    get
    {
        if (_selectedItemsChanged == null)
            _selectedItemsChanged = new RelayCommand<SelectionChangedEventArgs>((selectionChangedArgs) =>
            {
                // add a guard here to immediatelly return if you are modifying the original collection from code

                foreach (var item in selectionChangedArgs.AddedItems)
                    _selectedItems.Add((YourType)item);

                foreach (var item in selectionChangedArgs.RemovedItems)
                    _selectedItems.Remove((YourType)item);
            });
        return _selectedItemsChanged;
    }
} 
```

请注意，如果您要在选择完成后从原始集合中删除项目（用户按下按钮等），它也会从您的`_selectedItems`列表中删除项目！如果您在 foreach 循环中执行此操作，您将获得一个`InvalidOperationException`. 为避免这种情况，只需在标记的位置添加一个守卫，例如：

```
if (_deletingItems)
    return; 
```

然后在例如删除项目的方法中，执行以下操作：

```
_deletingItems = true;
foreach (var item in _selectedItems)
    YourOriginalCollection.Remove(item);
_deletingItems = false; 
```**

# drupal-7 - 如何将主题应用于 Drupal 功能？

> ID：10964912
> 
> 赞同：1
> 
> 时间：2012-06-09T22:02:26.557
> 
> 标签：drupal-7, drupal-theming, drupal-templates

我有一个由URL`_home()`调用的 Drupal 7 函数。`home`

在这个函数中，我想生成 HTML 输出并返回它。我需要向用户显示生成的 HTML。实际上，我在函数中嵌入了 HTML 标签（div、tables、b...）并返回给用户。它可以运行，但我认为必须有更好的方法来做到这一点，也许使用模板或主题。有没有办法将模板应用于`_home`函数，即使它不是节点/另一个 Drupal 对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T07:29:14.207

```
if the "home" url is being created using modules then the following might be useful for you.

In your module file create
function modulename_theme($existing, $type, $theme, $path)
   {
   $theme_hooks = array(
    'home' => array(
      'template' => 'home',//name of template file will be home.tpl.php
      'path' => $path . '/templates',
      'variables' => array(
      ),
    ));
     return $theme_hooks;
    }
    //As _home is the callback function for "home" url
    function _home($node)
    {
    return theme('home', array('node' => $node));
    }

Now under your module create a templates folder & in that create home.tpl.php & place your html in that file.. 
```

# c# - 将结果从 winform DataGridView 写入数据库表的速度非常慢

> ID：10964913
> 
> 赞同：0
> 
> 时间：2012-06-09T22:02:33.457
> 
> 标签：c#, winforms, sql-server-ce

我有一个未绑定到 SQL Server CE 中的表的 DataGridView (DGV)。WinForm 上的“更新数据库”按钮然后调用以下方法`PushFromDGV`。然后这会清除表`HelloWorld`，然后遍历 DGV 中的项目，将它们插入`HelloWorld`

DGV 中大约有 1000 行，运行需要几分钟。

我真的必须做 1000 次往返才能将数据写入 db 表，还是有一种方法可以一次完成？

```
 private void PushFromDGV()
    {
        ExecCommand(@"DELETE FROM HELLOWORLD");    
        for (int i = 0; i < uxExperimentDGV.RowCount-1; ++i)
        { //iterate for every row in the DGV
            ExecCommand(@"INSERT INTO HELLOWORLD SELECT '" + (string)uxExperimentDGV[0, i].Value + "'");
        }
    }  
    public void ExecCommand(string myCommand)
    {
        // Open the connection
        try
        {
            using (SqlCeConnection conn = new SqlCeConnection(ConfigurationManager.ConnectionStrings["DatabaseDGVexperiments.Properties.Settings.DatabaseDGVexperimentsConnStg"].ConnectionString)) // conn.Open();
            {// 1\. Instantiate a new command with a query and connection
                conn.Open();
                SqlCeCommand cmd = new SqlCeCommand(myCommand, conn);
                cmd.CommandText = myCommand;  // 2\. Set the CommandText property
                cmd.Connection = conn;  // 3\. Set the Connection property
                cmd.ExecuteNonQuery();  // 4\. Call ExecuteNonQuery to send command
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show((string)ex.Message);
            return;
        }
    } 
```

有人建议在循环之前只建立一次打开连接，然后在循环之后关闭它。我现在有以下内容。

这是一个准确的解释吗

?

```
 public SqlCeConnection conn = new SqlCeConnection(ConfigurationManager.ConnectionStrings["DatabaseDGVexperiments.Properties.Settings.DatabaseDGVexperimentsConnStg"].ConnectionString);

    private void PushFromDGV()
    {
        conn.Open();
        ExecCommand(@"DELETE FROM HELLOWORLD"); 
        for (int i = 0; i < uxExperimentDGV.RowCount - 1; ++i)
        { //iterate for every row in the DGV
            ExecCommand(@"INSERT INTO HELLOWORLD SELECT '" + (string)uxExperimentDGV[0, i].Value + "'");
        }
        conn.Close();
    }   

    public void ExecCommand(string myCommand) 
    {
        try
        {
             SqlCeCommand cmd = new SqlCeCommand(myCommand, conn);
             cmd.CommandText = myCommand;  
             cmd.Connection = conn;  
             cmd.ExecuteNonQuery();  
        }
        catch (Exception ex)
        {
            MessageBox.Show((string)ex.Message);
            return;
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T22:17:52.527

打开一次连接，然后执行所有命令，然后关闭数据库连接。这应该可以节省相当多的时间。

此外，您可以尝试创建事务并将所有命令作为事务的一部分运行。根据您使用的数据库引擎，这可能会进一步加快速度。

PS：什么是*DGV*？

# javascript - 关于向服务器提交正确数据的 javascript 的安全性

> ID：10964915
> 
> 赞同：0
> 
> 时间：2012-06-09T22:02:59.217
> 
> 标签：javascript, html, security

我想知道用户是否可以编辑页面上的 javascript。

例如，如果 javascript 中的提交按钮事件处理程序具有如下条件：

```
if (!txtName.match(/^[\w ]+$/)) {
    alert("Please use only letters, numbers, underscores and spaces in your name.");
    return;
} 
```

我是否还必须验证服务器上的名称，或者我可以相信不正确的名称不能发送到服务器？基本上，用户可以操纵 javascript 来绕过这种检查吗？

如果不是，是否可以使用数据包注入来提交无效名称？我对安全性了解不多，所以我只是对这些问题感到好奇....好的，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T22:05:46.887

> 我是否还必须验证服务器上的名称

是的

> 还是我可以相信不能将不正确的名称发送到服务器？

不

> 基本上，用户可以操纵 javascript 来绕过这种检查吗？

被操纵。

关掉。

在验证方面，它只能用于节省用户时间（但避免服务器往返），而不是安全性。

> 可以使用数据包注入来提交无效名称吗？

是的。

不过，手动构建 HTTP 请求会容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T22:04:31.133

您还必须执行服务器端验证。正如您所指出的，有许多方法可以注入信息。一方面，他们可以关闭 Javascript。或者，他们可以拦截和修改网络请求。

客户端应该只用于补充，而不是替代，服务器端验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T22:04:21.853

始终在服务器端进行验证。您永远不应信任发布到您的服务器的数据，这可能会导致严重的安全风险。

# batch-file - 批量读取带有特殊字符的文件

> ID：10964923
> 
> 赞同：3
> 
> 时间：2012-06-09T22:04:32.033
> 
> 标签：batch-file, for-loop, io, special-characters

如何在批处理中读取和解析带有特殊字符的文件？我有一个名为 test.txt 的文本文件`foo!!!bar`和一个批处理文件：

```
@echo off
setlocal enabledelayedexpansion enableextensions

FOR /F "tokens=* delims=" %%a IN (.\test.txt) DO (
    echo Unquoted is %%a
    echo Quoted is "%%a"
    set "myVar=%%a"
    echo myVar is still !myVar! or "!myVar!"
)
exit /b 0 
```

我希望并期望它以`foo!!!bar`某种方式输出，但这会输出：

```
Unquoted is foobar
Quoted is "foobar"
myVar is still foobar or "foobar" 
```

我当然可以`type test.txt`，但我想处理文件的每一行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T22:08:57.977

您的问题是批处理解析器及其阶段的副作用。

FOR 参数在延迟扩展阶段扩展之前扩展。
但是当`%%a`is时`foo!!bar`，延迟扩展将删除感叹号，因为`!!`它不是有效的变量扩展。

您需要切换延迟扩展，因为`%%a`只有在禁用延迟扩展的情况下扩展才是安全的。

```
@echo off
setlocal DisableDelayedExpansion enableextensions

FOR /F "tokens=* delims=" %%a IN (.\test.txt) DO (
    echo Unquoted is %%a
    echo Quoted is "%%a"
    set "myVar=%%a"

    setlocal enabledelayedexpansion 
    echo myVar is still !myVar! or "!myVar!"
    endlocal
) 
```

您还可以查看[CMD.EXE 如何解析...](https://stackoverflow.com/questions/4094699/how-does-the-windows-command-interpreter-cmd-exe-parse-scripts/4095133#4095133)

# google-apps-script - google-apps-script 在一个电子表格中有多个脚本

> ID：10964932
> 
> 赞同：1
> 
> 时间：2012-06-09T22:06:50.910
> 
> 标签：google-apps-script

我为 Google 电子表格应用程序开发了几个通用脚本函数。目前，我将每个功能保存在笔记本电脑上的单独文件中。为了将它们包含到电子表格中，我只知道一种方法。

将各个函数文件合并到一个文件中。然后将合并文件中的数据复制并粘贴到电子表格的脚本编辑器中，替换之前的内容。

如果有一种方法（例如使用“项目”）可以将单个函数文件保存一次，然后我可以在新脚本中根据需要引用这些函数，那就太好了。

不知道有没有这种可能。我在电子表格内容的树列表中只看到一个名为“代码”的节点。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T22:12:28.240

团队刚刚发布了一个新功能：[脚本库](https://developers.google.com/apps-script/guide_libraries)，请看看它是否符合您的要求。

编辑：这很简单：选择一个包含要添加到库中的脚本的电子表格，保存脚本的版本，将此版本添加到库中，然后将提供的密钥复制到某处（此密钥也是用于管理您的图书馆的网址）在另一个电子表格中转到“管理图书馆”，添加密钥并保存。从那里，只需键入库名称 + 点 + CTRL SPACE（自动完成），即可在新脚本中直接使用属于该库的所有函数。希望这足够清楚。查看示例的屏幕截图：Caltosheet 是库的名称，它也在字母 C 上自动完成）

![在此处输入图像描述](../Images/43426bc7393d7dd5bac1eb1e82ea791b.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T18:54:19.077

谢谢塞尔。我查看了“图书馆”，这是我发现的。

1.  任何包含一个或多个脚本项目的电子表格文件都可以作为库引用。script_project 构成了库定义。

2.  一个电子表格文件可以包含一个或多个 script_projects。

3.  脚本函数的接口位于电子表格文件的“工具”菜单下。此菜单包含与脚本相关的三 (3) 个条目：

    1.  脚本库（我还没有探索过这个条目）
    2.  脚本管理器 该条目提供了在每个“项目”中找到的所有项目和功能的列表视图。该列表按 function_name 排序，然后是 project_name。第三列是“服务”，我目前只找到“电子表格”的值。我还没有探索过其他类型的文档、“站点”和“服务”，以了解还会出现什么。湾。此显示的底部是一个菜单，其中包含您可以对列表条目执行的操作：运行、编辑、新建、关闭。
        - 运行：执行突出显示的脚本。- 编辑：打开所选项目/功能的“脚本编辑器”。这与“工具”菜单上的第三 (3) 个相同（见下文）。- 新的。在无标题（空）项目上打开“脚本编辑器”。当没有以前保存的脚本时，这与从“工具”菜单中选择“脚本编辑器”选项的操作相同。- 关闭：关闭脚本管理器窗口。这与按右上角的“X”按钮相同。
    3.  脚本编辑器。这使您可以访问用于操作的功能：LIBRARY - 具有已定义版本号的脚本 PROJECT b。PROJECT - 一个或多个文件的集合。C。FILE - 一个或多个 JavaScript FUNCTION 的集合。d。FUNCTION - 一组 JavaScript 语句，可由电子表格接口或另一个 JavaScript FUNCTION 引用（调用）。

        ```
         When the Script Editor is accessed from a new spreadsheet, it creates
         a new (untitled) PROJECT. The new project contains one FILE. The name 
         of the initial file is "Code". This is the initial "tree" entry under
         the "untitled project" root in the left column of the editor's screen.
         The contents of the "Code" file is listed in the right column "text_area".
         The text_area is initialized with an empty FUNCTION definition which has
         the name "myFunction".

         The text_area provides normal standard text editing functions that you find
         in other script editors (copy, paste, cut; overlay/insert typing text 
         selection replace(with paste) and delete. 

         The text_area shows the complete contents of the file. This may be
         one or more "function" definitions. 

         The major functions of the editor in managing PROJECTs and FILEs at
         a "higher" level are found under the "File" menu. 

         The "File" menu contains the following entries:

         1\. New - This allows you to insert a new PROJECT into the spreadsheet,
                  or a new FILE in the current PROJECT. It also allows you to 
                  create other types of documents. But I have not explored these
                  options.
         2\. Open - This sub-menu provides you with a list of PROJECTS contained
                   within the spreadsheet and allows you to switch projects, or
                   to access an additional file under a project. 

                   When a PROJECT is opened, The tree structure lists all of
                   the files contained in the project. The names of the files
                   are also listed in "tab" above the text_area. You can switch
                   between files by either clicking on the tree entry or the 
                   "tab" name.  
         3\. Revision History - provides you with a list of saved contents of 
                   the project. You can back-off changes using this option.

         4\. Rename - This sub-menu allows you to change the name of a FILE
                     within a PROJECT, or the name of the PROJECT. The object
                     that is renamed is determined by the entry selected in 
                     the "tree" in the left column.

         5\. Delete - This sub-menu allows you to delete either a FILE within
                     a PROJECT or the entire PROJECT. The object deleted is
                     determined by the high-lighted entry in the tree structure
                     in the left column.

         6\. Make A Copy - inserts a duplicate copy of the current file selected
                     in the tree structure, and switches access to the copied 
                     file's contents. If the current entry in the tree structure
                     is the PROJECT entry, then this and other sub-functions 
                     which do not apply at the PROJECT level are inactivated
                     (grayed out).

         7\. Save   - Marks the current contents of the selected file as a
                     restore point, and saves its contents so that it is
                     accessible the next time the editor manipulates this project.
                     You can have unsaved changes in multiple files. This option
                     only saves changes to the currently active file.

         8\. Save All - This saves the contents of all files that have unsaved
                       changes. The editor places a "red star" in front of the 
                       FILE's name in the "tab" for that file. As each file's
                       changes are saved. the "red star" is removed.

         9\. Manage Versions - This sub-menu allows you to assign a NEW version
                       number to a project. It really does not allow you 
                       to manage the current version definitions. It prompts
                       you for a description (a reason for creating a new version).

                       By defining a "version" number you make the PROJECT usable
                       as a library. 

        10\. Project Properties - This sub-menu provides access to a set of attributes
                       that are associated with the PROJECT object. I have not 
                       explored the use of "User Properties" and "Project Properties"
                       tabs. I expect that they are concerned with saving Key-value
                       pairs (as global variables) across spreadsheet access sessions.
                       But I will explore them later.

                       The important attribute on the "INFO" tab (for me) is the
                       "Project Key" attribute. This is the value that you must
                       copy/paste into another spreadsheet file, in order to access
                       the functions contained in this PROJECT without having to 
                       copy the actual function definitions into referencing 
                       spreadsheet file. 

         11\. Build a user interface - I have not explored this sub-menu.

         Now once you have assigned a "version" number to a project, that project
         can be used as a "reference" (i.e. LIBRARY) in another spreadsheet file.

         Here is how you do this:
            1\. Go to the spreadsheet file that contains the PROJECT (i.e.LIBRARY)
               that contains the PROJECT you want to "reference"
            2\. Access the "tools" menu to gain access to the project. Use either
               the "Script Manager", or the "Script Editor" options. If your 
               spreadsheet only has one PRJOECT, then the "Script Editor" will
               take you to that PROJECT. Otherwise, use the Script Manger, to
               select the PROJECT. (If you open the Script Editor, and the spreadsheet
               file has more than one PROJECT, it will prompt you to select which
               PROJECT that you want to access.
            3\. Go to the "File/Project Properties" sub-menu within the editor and
               select (high-light) the Project Key's attribute's value. and copy
               it to your "clip board" (i.e. CTRL-c). You can then close this
               spreadsheet file.
            4\. Open the spreadsheet file that contains the scripts that needs
               to reference the functions from the other PROJECT(LIBRARY). 
            5\. Access the PROJECT containing the functions that are to call
               the external functions from the LIBRARY.
            6\. In the editor go to the "Resourses/Manger Libraries" sub-menu.
               You will receive a panel with the title "INCLUDED LIBRARIES".
            7\. To add the new library reference, paste the copied Project Key
               value into the "Find a Library" field, and press the "SELECT"
               button. 
            8\. If you have not made an error, you will set the list of libraries
               updated to include your PROJECT added to the list. 

         Each row in the PROJECT (library) list contains 5 entries. Here
         is how they are used.

               1\. Title - This contains the name of the PROJECT from the other
                          spreadsheet file. This is the name that is associated
                          with the "Prject Key". You can not change this value,
                          within this referencing file. 
               2\. Version - This shows which version of the PROJECT resources that
                          you are allowed to access by this definition. The 
                          drop-down list shows you which versions are available
                          and the comment you entered when you created the version.
               3\. Identifer - This shows you the qualifier that you are to use
                          within your FUNCTION definitions to uniquely identify
                          which function you are calling.  You are allowed to 
                          change this value even after you have initially defined
                          it. This identifier is similar to a "namespace" qualifier
                          that is found in an XML document. If you change the 
                          qualifier value you must make a similar change to 
                          all code within your functions that reference this 
                          identifier, otherwise an error is thrown at execution
                          time (to the end user) that an undefined identifier has
                          been encountered.
               4\. Development Mode - This attribute impacts the execution of the
                          scripts in the current spreadsheet. It tells the spreadhseet
                          engine NOT TO SAVE the compiled image of the target 
                          (referenced) library. This will slow down the execution
                          of your script since the spreadsheet engine will compile
                          your script every time you execute it, and it will also
                          recompile the contents of the LIBRARY each time. You should
                          only use "Development mode" when you are debugging a problem
                          with a library script.
               5\. Remove - when clicked removes the "Library definition" from the list
                          of included libraries. 

            Library definition changes are automatically saved when you close the
            mangers access panel. At the bottom of the panel are two buttons.
            "SAVE" - allows you to save changes and continue to make Library 
            definitions. CANCEL - causes the manger function to exit. Any 
            changes since the last SAVE are discarded.

            To call a Library function in your script is similar to calling
            the "msgBox" method of the "Browser" object. For example to 
            call the msgBox function you include "Browser.msgBox('...')"
            clause.

            To call the "doSomething" function in a library (project) for
            which you assigned the "identifier" of "LETS", you would 
            code the clause "LETS.doSomthing(....)". 

        After discovering these "facts", I have come to the following 
        conclusions:

            1\. The purpose of the spreadsheet file should be to only hold the 
               LIBRARY function definitions.  

            2\. If you are going to use a PROJECT as a LIBRARY, then you probably
               will want to have multiple PROJECTs in the spreadsheet file that 
               contains the LIBRARY.  The primary PROJECT should hold the 
               function definitions that make up the LIBRARY. A second project
               should be defined that holds testing functions. Only the LIBRARY
               project should be given a version number.

            3\. The spreadsheet data in general will not be available to the
               scripts that references the LIBRARY. They can be made available
               but not without opening the libraries spreadsheet file as a 
               separate application.

            4\. I don't know (since I have not tested this), but I assume that
               the PROJECT PROPERTIES and USER PROPERTIES of the library (spreadsheet)
               file are NOT accessible to the library functions when they are called.
               I can see both, views which would allow and prohibit this access.
               For security reasons I would guess that they would not be available.
               (I could be wrong! - and generally I am).

            5\. I like the idea of using FILES. In fact, I plan to use one file 
               for each function.  From a Object Oriented Programming perspective,
               you will probably want to use a separate file for each Object's
               definition.  You must realize (at this time) the JavaScript language
               does not support "Object Definitions".  The use of FILES as a container
               seems to be the reason for creating the FILE construct. 

            6\. The FILE object also allows you to limit the scope of view and change
               to functions within the FILE. In this way, you cannot corrupt other 
               functions which are not in the file. 

            7\. I found a significant impact on execution time when a script is run
               that references one or more Libraries.  My guess is that execution
               performance can be improved over time, with the use of JIT and caching
               facilities.

            8\. From an end-user's perspective, it would be nice is a "clock" type
               cursor icon would appear to the end user when a script is executing.
               This is very important considering the time it takes to execute code
               that references library functions.

            9\. For script execution performance reasons, you may anticipate that
               you will have to make the library functions an actual part of your
               spreadsheet file.  Looking ahead to this possibility, I would 
               create dummy (skeleton) functions within my spreadsheet scripts
               which do nothing more that pass the input parameters to the 
               library functions with the proper namespace identifier. Then
               when I have to copy in the library functions I only have to 
               change the dummy functions. I would put these skeleton functions
               into a separate file. I would use one file for each library 
               reference definition. 
        ```

# azure - 如何从现实世界中的多个队列中读取？

> ID：10964933
> 
> 赞同：3
> 
> 时间：2012-06-09T22:06:52.800
> 
> 标签：azure, message-queue, azure-storage-queues, azure-servicebus-queues

这是一个理论问题：

当我使用消息队列构建应用程序时，我将需要多个队列支持不同的数据类型以用于不同的目的。假设我有 20 个队列（例如，一个用于创建新用户，一个用于处理新订单，一个用于编辑用户设置等）。

我将使用“最少”1 个 Web 角色和 1 个辅助角色将其部署到 Windows Azure。

如何以正确的方式从所有这 20 个队列中读取数据？这就是我的想法，但我对此几乎没有实际经验：

创建一个在工作角色“主”类中产生 20 个线程的类。让这些线程中的每一个执行一个方法来轮询不同的队列，并让所有这些线程在每次轮询之间休眠（当然还有增加休眠时间的退避机制）。

这导致有 20 个线程（或 21 个？）和 20 个正在被主动轮询的队列，从而导致大量浪费的消息（每次轮询一个空队列时，它都被计费为一条消息）。

你怎么解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-10T04:36:14.227

我阅读了其他答案（非常好的答案）并想对此发表自己的看法。

正如@Lucifure 所描述的，坚持使用 Windows Azure 队列：我真的不认为需要多个队列，除了两种情况：

*   你想要不同的优先级。您最不想要的就是一条高优先级消息被困在数百条低优先级消息后面。为这些创建一个高优先级队列。
*   消息读取+删除的数量将超过每秒 500 个事务的目标。在这种情况下，创建多个队列，将事务量分散到存储分区（存储帐户每秒将处理超过 5K 的事务）。

如果您坚持使用单个队列（基于存储，而不是服务总线），您可以一次读取消息块（最多 32 个）。您可以轻松制定一种格式来帮助您区分消息类型（可能带有简单的前缀）。然后，只需将消息交给适当的线程进行处理。服务总线队列没有多消息读取，尽管它们允许预取（这会导致缓冲消息被下载到缓存中）。

一个队列优于多个队列的优势：您消除（或大大减少）“许多队列没有消息，导致空读取”的问题。

如果您需要更高的吞吐量，您可以随时增加执行队列读取和分派的线程数。

请记住，每个删除都是原子的；没有批处理。就队列轮询而言：您考虑退避是正确的。成功阅读消息（或消息块）后，您无需后退。当你在尝试阅读后没有得到任何东西时，请退后。

与服务总线队列相比，一个很好的优势是：Windows Azure 队列为您提供了一个近似的消息计数（这在考虑向多个实例横向扩展时非常有用）。服务总线队列不提供此功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T22:48:07.430

另一种策略是使用单个或更少的队列，以便队列可以支持多于一种类型的消息。如果您的系统架构可以支持，这种方法更易于管理且成本更低。

在现实世界中，我已经成功地使用了多个队列（出于可扩展性目的），每个队列在由计时器事件触发的单独线程上读取。根据队列上的负载和应用程序的需要，定时器事件被更改为以动态变化的时间间隔为队列提供服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T22:31:00.023

如果存储队列的回退机制对您来说还不够，我建议您考虑使用服务总线队列。使用服务总线队列，您不必进行如此激进的轮询。

您仍然需要实现一个循环来轮询队列，但接收超时使其比使用存储队列时的持续轮询机制更轻。

在下面的示例中，我尝试从队列中接收消息。如果未找到消息，它将保持连接打开 30 秒，以查看是否有新消息进入。如果 30 秒后没有消息到达，则 Receive 方法将返回 null（我将有一个循环尝试再次调用 Receive）。请注意，最大超时为 24**天**。

```
MessagingFactory factory = MessagingFactory.Create(ServiceBusEnvironment.CreateServiceUri("sb", ServiceNamespace, string.Empty), credentials); 
QueueClient myQueueClient = factory.CreateQueueClient("TestQueue");
myQueueClient.Receive(new TimeSpan(hours: 0, minutes: 0, seconds: 30)); 
```

为要读取的每个队列弹出线程是一个好主意，但是看到 CLR 线程池的容量限制，您还应该考虑异步接收消息（例如使用**TaskFactory.FromAsync**）：http: [//msdn.microsoft。 com/en-us/library/windowsazure/hh851744.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh851744.aspx)

# css - 嵌套 div 的 CSS 溢出问题

> ID：10964935
> 
> 赞同：1
> 
> 时间：2012-06-09T22:07:01.363
> 
> 标签：css, html, overflow

我正在为客户创建一个音乐网站，并尝试使用单页布局，以便音乐播放器在导航期间不会被中断。我在每个部分的 div 上使用了 css 属性 overflow:hidden，但由于某种原因，当我在其中嵌套另一个 div 时，它无法识别 overflow:auto 元素。这是有问题的，因为有计划的内容不适合单个页面，例如评论、帖子和图像缩略图。

该页面位于此处： http: [//www.dennispiano.com](http://www.dennispiano.com)

和我的测试服务器（有一些未部署的内容）在这里：`http://205.209.87.168/DennisMusic/index.php`

我正在谈论的一个示例是图像部分（在测试服务器链接上，尚未部署到实时站点）

相关 HTML

```
<div class="contentbody">

<div id="images" class="pageSection">
     <h1 style="padding:0 0 0 10px; background-color:#00c7c0;">
     <img src="images/pageAssets/images.png" alt="Home" height="25" width="83" /></h1>
     <?php include('lib/php/thumbnails.php'); ?>
</div>

<!-- end .contentBody --></div> 
```

相关PHP

```
//Variable Declaration (remove after xml structure creation)
$images=80;
$thumblimit=5;
$imagelines=($images/$thumblimit);

//

echo '<div class="sectionContent">'; //<-- busted content scrolling div
//Display Thumbnail tiles
for($i=0;$i<$imagelines;$i++) {

     echo '<div>';
     for($ii=0;$ii<$thumblimit;$ii++) {
          echo '<div style="display:block; margin:0 10px 0 10px; border:1px solid #fff;     background-color:#c90; width:50px; height:50px; float:left;"></div>';
     }
     echo '</div><br /><br /><br /><br />';

}

echo '</div>';

?> 
```

相关CSS

```
.contentBody {
    overflow:hidden;
}

.pageSection {
        width:100%;
        min-height: 700px;
        display:block;
}

.sectionContent {
        overflow:auto;
        display:block;
        width:100%;
} 
```

# mediawiki - 垂直单元格填充

> ID：10964937
> 
> 赞同：0
> 
> 时间：2012-06-09T22:07:29.270
> 
> 标签：mediawiki

我可以像这样将单元格填充应用于单个单元格：

```
{| style="text-align: center;"
|-
| style="padding: 20px 100px 20px 50px"|test  || test2
|} 
```

有没有办法将填充应用于整行？还是表格中的所有单元格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T11:59:39.857

无法将 HTML 属性添加到每个表格单元格（手动重复它们除外）。您可以使用标准的 CSS 机制将样式应用于每个单元格（向表格添加一个类，为 添加一个 CSS 规则`table.someclass td`），但是您需要修改全局 CSS 或使用内联`<style>`标签（如果配置不小心，这是一个很大的安全风险） .

# python - python通过函数参数将变量传递给对象属性或方法

> ID：10964940
> 
> 赞同：2
> 
> 时间：2012-06-09T22:07:49.417
> 
> 标签：python, django

我一直在尝试构建一个通用函数（一个 Django 视图处理程序），其参数包含要在函数内部使用的特定对象属性

类似（简化）：

```
def some_function(arg, property):
    return Some_Object.property 
```

但是python试图将“属性”视为属性/方法名称，而不是将其视为变量。

我尝试了多种变体，但都没有奏效。（没有尝试 exec/eval 变种 - 我应该吗？似乎不太pythonic）

我知道我可以将函数或对象作为参数传递。但似乎没有在这里找到使用 python 2.7 和 2.6 的确切解决方案

具体的植入是一个 Django 问题，但我对此感到好奇

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T22:11:42.423

我认为你想要做的是使用 getattr 来检索属性：

```
def some_function(arg, property):
    return getattr(Some_Object, propery) 
```

您可以在此处查看文档：http: [//docs.python.org/library/functions.html#getattr](http://docs.python.org/library/functions.html#getattr)

# c++ - C ++不需要的中止原因？

> ID：10964947
> 
> 赞同：1
> 
> 时间：2012-06-09T22:09:14.480
> 
> 标签：c++, gdb, glibc, abort, backtrace

我的 C++ 代码中有一个非常奇怪的错误。

我必须告诉你这个故事才能理解整个故事。我正在通过 boost_thread 库使用线程。main 方法进行一些初始化，启动 3-4 个线程，然后永远等待：

```
while(true) sleep(1); 
```

所有线程的主要功能都有一些 catch 和 catch all 处理程序的尝试：

```
void do_work() {
  try {
    ..
  }
  catch (int ei) {
  }
  catch (...) {
    log("General error");
  }
} 
```

线程执行各种任务，例如

*   使用 execv 函数执行脚本，
*   使用 sqlite 库写入数据库，
*   通过 openssl 库与世界交流。

有时，不是通常，但经常会烦人程序被终止。

一切都在应该的时候被正确地释放和删除，所以这不是问题。我让它生成一个核心转储，以便有机会调试问题。

有趣的部分现在来了：GDB 的回溯看起来像这样：

```
(gdb) bt
#0  0x40281ae8 in raise () from /lib/libc.so.6
#1  0x402830ec in abort () from /lib/libc.so.6
#2  0x402830ec in abort () from /lib/libc.so.6
#3  0x402830ec in abort () from /lib/libc.so.6
#4  0x402830ec in abort () from /lib/libc.so.6
#5  0x402830ec in abort () from /lib/libc.so.6
#6  0x402830ec in abort () from /lib/libc.so.6
#7  0x402830ec in abort () from /lib/libc.so.6
#8  0x402830ec in abort () from /lib/libc.so.6
#9  0x402830ec in abort () from /lib/libc.so.6 
```

无休止的中止呼叫，我不知道是什么原因造成的。线程看起来像这样：

```
(gdb) info threads
  4 Thread 490  0x402e7bf4 in nanosleep () from /lib/libc.so.6
  3 Thread 489  0x4031b384 in accept () from /lib/libc.so.6
  2 Thread 501  0x402e7bf4 in nanosleep () from /lib/libc.so.6
* 1 Thread 486  0x40281ae8 in raise () from /lib/libc.so.6 
```

这也很有趣，因为线程 1 是具有无限睡眠循环的主要功能。

我的问题：我 **怎样才能找到流产的原因（因为我不能忽略它，如果我没记错的话）？**

在论坛、IRC 频道和谷歌上搜索它 - 但仍然没有。几周前我被困住了，所以非常感谢任何信息！

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:34:13.393

SIGABRT 通常在事情变得非常糟糕时发送，非常错误。它们可能很难追踪，因为堆栈很可能被丢弃。

从回溯来看，您似乎正在使用剥离（并且可能已优化）的可执行文件运行。您是否尝试过编译和链接，`-g`以便在获得 coredump 时获得更多洞察力？

# javascript - 如何使用 javascript 删除这个头部 css 样式？

> ID：10964950
> 
> 赞同：1
> 
> 时间：2012-06-09T22:09:40.647
> 
> 标签：javascript, jquery, css, dom

您将如何从中删除 00bf00 部分：

```
#main { background:#00bf00 00bf00 url('images/low.png') repeat;  } 
```

我需要动态地做到这一点，所以可能是javascript（或者如果你有想法的话）

我不想更改代码以正确输出，只是想看看是否有办法通过添加代码片段来删除它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T00:40:57.753

```
// for imported stylesheets
var cssRules = [];
for (var i = 0, il = document.styleSheets.length; i < il; i++) {
    if (document.styleSheets[0].cssRules)
        cssRules = document.styleSheets[0].cssRules;
    else if (document.styleSheets[0].rules)
        cssRules = document.styleSheets[0].rules​;
    for (var j = 0, jl = cssRules.length; j < jl; j++) {
        if (/^#main/.test(cssRules[j].cssText))
            cssRules[j].cssText = cssRules[j].cssText.replace(/[^#]00bf00/, '');
    }
}

// for style tags
​var styleTags = document.getElementsByTagName('style');
for (var i = 0, il = styleTags.length; i < il; i++) {
    styleTags[i].innerHTML = styleTags[i].innerHTML
                                         .replace(/(#main.*)[^#]00bf00/, '$1');
}​​ 
```

## [查看演示](http://jsfiddle.net/uP36d/)（用于样式标签）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:10:59.507

您不能直接在`head`标签内修改 css 属性，试试这个：

```
$('#main').css('background-color', "transparent"); 
```

或者：

```
document.getElementById('main').style.backgroundColor = 'transparent'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T22:14:56.357

正如昆汀所说，浏览器可能已经删除了这条规则，所以你不能真正编辑它。

另一方面，您可以查看客户端 css 解析。LESS 有一个客户端版本的 CSS 处理器，它本质上是查看可用的 CSS 源代码，并在将其返回给浏览器之前对其进行修改。LESS 源代码是开源的，因此您可以看到它是如何做到的。不幸的是，这是一个相当复杂的过程，并且对于这样的事情来说太过分了。在将 CSS 交付给浏览器之前修复它会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-10T00:25:09.933

如果您只想更改已经存在的元素的样式，那么只需执行

```
document.body.style.background = '#00bf00 url(\'images/low.png\') repeat'; 
```

如果您需要更改样式本身以使其适用于未来的元素，则使用正确的值覆盖选择器。

```
$('head').append('<style>#main { background:#00bf00 url(\'images/low.png\') repeat;  }  </style>') 
```

（本例假设现有样式在头部，所以在现有样式之后插入新样式）

# javascript - 使用backbonejs在我的网络应用程序中构建一个菜单

> ID：10964955
> 
> 赞同：1
> 
> 时间：2012-06-09T22:10:20.867
> 
> 标签：javascript, model-view-controller, backbone.js

我正在使用 Backbone.js 构建我的第一个 Web 应用程序。到现在为止还挺好。我正在寻找一些指导：

我有一个`<ul>`我想填充的`<li>`代表“产品”

这是我到目前为止所定义的：

*   1 个模型 -> 产品
*   1 个系列 -> 产品
*   1 个视图 -> view_product （表示单个产品的视图 - 一个`<li>`）

我通过传递一个代表我的产品的对象数组来创建集合的一个实例，我知道这会为集合中的每个产品创建模型的实例。

我对下一步该做什么感到困惑。我应该为每个模型循环使用`_.each()`、创建和实例的集合，然后尝试将它们附加到我的? 有人告诉我这是错误的想法。`view_product``products``<ul>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:51:25.270

> 我通过传递一个代表我的产品的对象数组来创建集合的一个实例，我知道这会为集合中的每个产品创建模型的实例。

你理解正确。

您可能希望为产品集合再添加一个视图，该视图将是 a`<ul>`并且它将管理每个产品的视图（它们是`<li>`s）：

```
var V = Backbone.View.extend({
    tagName: 'ul',
    initialize: function() {
        _.bindAll(this, 'render');
        this.collection.on('reset', this.render);
        // And other events as needed...
    },
    render: function() {
        var _this = this;
        this.collection.each(function(p) {
            var v = new view_product({ model: p });
            _this.$el.append(v.render().el);
        });
        return this;
    }
}); 
```

Collections 已经[混合了许多 Underscore 方法，](http://documentcloud.github.com/backbone/#Collection-Underscore-Methods)因此您不需要`_.each(collection.models, ...)`，`collection.each(...)`也可以正常工作并且更惯用。

然后，您将实例化并呈现您的每个集合视图之一：

```
var v = new V({ collection: your_existing_products_collection });
$(some_container).append(v.render().el); 
```

Backbone[`collection`专门对待视图的选项](http://documentcloud.github.com/backbone/#View-constructor)，这就是`this.collection`从哪里来的`initialize`。

每个产品的视图将负责绑定到产品的事件（例如名称、价格、数量、...更改），并负责从用户的购物车中添加/删除产品。每个集合视图负责涉及整个集合的任何事情：集合重置，添加新产品，删除产品，......

这是一个快速的'n'dirty演示，以帮助说明我在说什么：http: [//jsfiddle.net/ambiguous/SSstN/1/](http://jsfiddle.net/ambiguous/SSstN/1/)

# ruby-on-rails - 无方法错误 nil:NilClass 的未定义方法“保存”

> ID：10964965
> 
> 赞同：0
> 
> 时间：2012-06-09T22:13:01.233
> 
> 标签：ruby-on-rails, model-view-controller, methods, null

当我尝试通过 Lecture 控制器的 create 方法创建“Lecture”时出现此错误。这曾经可以工作，但我继续在应用程序的其他部分工作，然后我当然回来了，当用户尝试在我的应用程序中创建讲座时，现在有些东西会抛出这个错误。

我敢肯定它只是我忽略的一些小东西（已经做了一段时间了，可能需要休息一下）......但如果有人能让我知道为什么会发生这种情况，我将不胜感激......让我知道如果我需要发布其他任何内容...谢谢！

我得到的错误

```
NoMethodError in LecturesController#create

undefined method `save' for nil:NilClass
Rails.root: /Users/name/Sites/rails_projects/app_name

Application Trace | Framework Trace | Full Trace
app/controllers/lectures_controller.rb:13:in `create' 
```

我对创建新讲座的看法

意见/讲座/new.html.erb

```
<% provide(:title, 'Start a Lecture') %>

<div class="container">
  <div class="content-wrapper">

    <h1>Create a Lecture</h1>

     <div class="row">
       <div class="span 6 offset3">
         <%= form_for(@lecture) do |f| %>
           <%= render 'shared/error_messages', :object => f.object %>
           <div class="field">
             <%= f.text_field :title, :placeholder => "What will this Lecture be named?" %>
             <%= f.text_area :content, :placeholder => "Describe this Lecture & what will be learned..." %>
           </div>
          <%= f.submit "Create this Lecture", :class => "btn btn-large btn-primary" %>
         <% end %>
       </div>
     </div>
   </div>
 </div> 
```

然后我的控制器说错误来自哪里

控制器/lectures_controller.rb

```
class LecturesController < ApplicationController
before_filter :signed_in_user, :only => [:create, :destroy]
before_filter :correct_user,   :only => :destroy

def index
end

def new
  @lecture = current_user.lectures.build if signed_in?
end

def create
  if @lecture.save
   flash[:success] = "Lecture created!"
   redirect_to @lecture
  else
   @activity_items = [ ]
   render 'new'
  end
end

def show
 @lecture = Lecture.find(params[:id])
end

def destroy
  @lecture.destroy
  redirect_to root_path
end

private

  def correct_user
    @lecture = current_user.lectures.find_by_id(params[:id])
    redirect_to root_path if @lecture.nil?
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:22:38.623

您依靠 before 过滤器为后续操作设置实例变量。这行不通。您必须在需要它的控制器操作中显式设置它。before 过滤器的唯一目的是过滤哪些操作会运行，哪些不运行。

编辑：我误读了你的代码。我以为您在创建操作之前正在运行正确的用户。无论哪种方式，很高兴知道它现在有效！

# javascript - 在 JavaScript 中检测 IE 版本（v9 之前）

> ID：10964966
> 
> 赞同：252
> 
> 时间：2012-06-09T22:13:23.480
> 
> 标签：javascript, internet-explorer, user-agent, browser-detection

`Internet Explorer`如果他们使用的是 v9 之前的版本，我想将我们网站的用户退回到错误页面。只是不值得我们花时间和金钱来支持`IE pre-v9`。所有其他非 IE 浏览器的用户都很好，不应被退回。这是建议的代码：

```
if(navigator.appName.indexOf("Internet Explorer")!=-1){     //yeah, he's using IE
    var badBrowser=(
        navigator.appVersion.indexOf("MSIE 9")==-1 &&   //v9 is ok
        navigator.appVersion.indexOf("MSIE 1")==-1  //v10, 11, 12, etc. is fine too
    );

    if(badBrowser){
        // navigate to error page
    }
} 
```

这段代码能解决问题吗？

阻止一些可能会出现的评论：

1.  是的，我知道用户可以伪造他们的`useragent`字符串。我不担心。
2.  是的，我知道编程专业人员更喜欢嗅探功能支持而不是浏览器类型，但我认为这种方法在这种情况下没有意义。我已经知道所有（相关的）非 IE 浏览器都支持我需要的功能，而所有`pre-v9 IE`浏览器都不支持。在整个站点中逐个检查功能将是一种浪费。
3.  是的，我知道有人试图使用`IE v1`（或> = 20）访问该站点不会将'badBrowser'设置为true，并且警告页面不会正确显示。这是我们愿意承担的风险。
4.  是的，我知道微软有“条件注释”，可用于精确的浏览器版本检测。IE 不再支持条件注释`IE 10`，使这种方法完全没用。

还有其他明显的问题需要注意吗？

* * *

## 回答 #1

> 赞同：358
> 
> 时间：2012-06-09T22:38:20.997

这是我的首选方式。它提供了最大的控制。（注意：条件语句仅在 IE5 - 9 中支持。）

首先正确设置你的ie类

```
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>    <html class="lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>    <html class="lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html> <!--<![endif]-->    
<head> 
```

然后你可以只使用 CSS 来制作样式异常，或者，如果你需要，你可以添加一些简单的 JavaScript：

```
(function ($) {
    "use strict";

    // Detecting IE
    var oldIE;
    if ($('html').is('.lt-ie7, .lt-ie8, .lt-ie9')) {
        oldIE = true;
    }

    if (oldIE) {
        // Here's your JS for IE..
    } else {
        // ..And here's the full-fat code for everyone else
    }

}(jQuery)); 
```

感谢[保罗爱尔兰人](http://www.paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/)。

* * *

## 回答 #2

> 赞同：163
> 
> 时间：2013-04-13T01:01:53.767

返回 IE 版本或者如果不是 IE 返回 false

```
function isIE () {
  var myNav = navigator.userAgent.toLowerCase();
  return (myNav.indexOf('msie') != -1) ? parseInt(myNav.split('msie')[1]) : false;
} 
```

例子：

```
if (isIE () == 8) {
 // IE8 code
} else {
 // Other versions IE or not IE
} 
```

或者

```
if (isIE () && isIE () < 9) {
 // is IE version less than 9
} else {
 // is IE 9 and later or not IE
} 
```

或者

```
if (isIE()) {
 // is IE
} else {
 // Other browser
} 
```

* * *

## 回答 #3

> 赞同：118
> 
> 时间：2012-06-09T23:03:19.773

使用条件注释。您正在尝试检测 IE < 9 的用户，并且条件注释将在这些浏览器中运行；在其他浏览器（IE >= 10 和非 IE）中，注释将被视为普通的 HTML 注释，它们就是这样。

示例 HTML：

```
<!--[if lt IE 9]>
WE DON'T LIKE YOUR BROWSER
<![endif]--> 
```

如果需要，您也可以纯粹使用脚本执行此操作：

```
var div = document.createElement("div");
div.innerHTML = "<!--[if lt IE 9]><i></i><![endif]-->";
var isIeLessThan9 = (div.getElementsByTagName("i").length == 1);
if (isIeLessThan9) {
    alert("WE DON'T LIKE YOUR BROWSER");
} 
```

* * *

## 回答 #4

> 赞同：117
> 
> 时间：2012-06-09T22:34:49.467

如果没有其他人添加`addEventLister`- 方法并且您使用的是正确的浏览器模式，那么您可以检查 IE 8 或更低版本

```
if (window.attachEvent && !window.addEventListener) {
    // "bad" IE
} 
```

[旧版 Internet Explorer 和 attachEvent (MDN)](https://developer.mozilla.org/en/docs/Web/API/EventTarget.addEventListener#Compatibility)

* * *

## 回答 #5

> 赞同：61
> 
> 时间：2013-12-05T21:58:05.903

轻松检测 MSIE (v6 - v7 - v8 - v9 - v10 - v11)：

```
if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0) {
   // MSIE
} 
```

* * *

## 回答 #6

> 赞同：32
> 
> 时间：2015-07-08T12:54:12.823

这是 AngularJS[检查](https://github.com/angular/angular.js/blob/master/src/Angular.js#L165-L170)IE的方式

```
/**
 * documentMode is an IE-only property
 * http://msdn.microsoft.com/en-us/library/ie/cc196988(v=vs.85).aspx
 */
var msie = document.documentMode;

if (msie < 9) {
    // code for IE < 9
} 
```

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2014-06-25T12:27:45.863

为了可靠地过滤 IE8 和更早版本，可以使用[检查全局对象：](http://tanalin.com/en/articles/ie-version-js/)

```
if (document.all && !document.addEventListener) {
    alert('IE8 or lower');
} 
```

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2014-09-28T07:48:42.533

使用特性检测检测 IE 版本（IE6+，IE6 之前的浏览器被检测为 6，非 IE 浏览器返回 null）：

```
var ie = (function (){
    if (window.ActiveXObject === undefined) return null; //Not IE
    if (!window.XMLHttpRequest) return 6;
    if (!document.querySelector) return 7;
    if (!document.addEventListener) return 8;
    if (!window.atob) return 9;
    if (!document.__proto__) return 10;
    return 11;
})(); 
```

编辑：为方便起见，我创建了一个 bower/npm 存储库：[ie-version](https://github.com/gagle/js-ie-version)

**更新：**

更紧凑的版本可以写成一行：

```
return window.ActiveXObject === undefined ? null : !window.XMLHttpRequest ? 6 : !document.querySelector ? 7 : !document.addEventListener ? 8 : !window.atob ? 9 : !document.__proto__ ? 10 : 11; 
```

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2013-08-15T09:11:56.300

[使用条件注释检测 JS 中的 IE](http://james.padolsey.com/javascript/detect-ie-in-js-using-conditional-comments/)

```
// ----------------------------------------------------------
// A short snippet for detecting versions of IE in JavaScript
// without resorting to user-agent sniffing
// ----------------------------------------------------------
// If you're not in IE (or IE version is less than 5) then:
//     ie === undefined
// If you're in IE (>=5) then you can determine which version:
//     ie === 7; // IE7
// Thus, to detect IE:
//     if (ie) {}
// And to detect the version:
//     ie === 6 // IE6
//     ie > 7 // IE8, IE9 ...
//     ie < 9 // Anything less than IE9
// ----------------------------------------------------------

// UPDATE: Now using Live NodeList idea from @jdalton

var ie = (function(){

    var undef,
        v = 3,
        div = document.createElement('div'),
        all = div.getElementsByTagName('i');

    while (
        div.innerHTML = '<!--[if gt IE ' + (++v) + ']><i></i><![endif]-->',
        all[0]
    );

    return v > 4 ? v : undef;

}()); 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2014-05-16T14:56:09.490

`undefined`如果浏览器不是 Internet Explorer ，此函数将 IE 主要版本号作为整数返回。与所有用户代理解决方案一样，这很容易受到用户代理欺骗（自版本 8 以来一直是 IE 的官方功能）。

```
function getIEVersion() {
    var match = navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:)(\d+)/);
    return match ? parseInt(match[1]) : undefined;
} 
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2013-01-25T19:49:21.637

这对我有用。我将它用作重定向到一个页面，该页面解释了我们为什么不喜欢 < IE9 并提供指向我们喜欢的浏览器的链接。

```
<!--[if lt IE 9]>
<meta http-equiv="refresh" content="0;URL=http://google.com">
<![endif]--> 
```

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2012-06-09T22:25:10.697

您的代码可以进行检查，但正如您所想，如果有人尝试使用 IE v1 或 > v19 访问您的页面，则不会出现错误，因此使用 Regex 表达式进行检查可能更安全，如下面的代码：

```
var userAgent = navigator.userAgent.toLowerCase();
// Test if the browser is IE and check the version number is lower than 9
if (/msie/.test(userAgent) && 
    parseFloat((userAgent.match(/.*(?:rv|ie)[\/: ](.+?)([ \);]|$)/) || [])[1]) < 9) {
  // Navigate to error page
} 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2014-10-07T03:20:59.363

[如Microsoft 参考页面](http://msdn.microsoft.com/en-us/library/ie/hh801214(v=vs.85).aspx)所述，从版本 10 开始，IE 不再支持条件注释。

```
var ieDetector = function() {
  var browser = { // browser object

      verIE: null,
      docModeIE: null,
      verIEtrue: null,
      verIE_ua: null

    },
    tmp;

  tmp = document.documentMode;
  try {
    document.documentMode = "";
  } catch (e) {};

  browser.isIE = typeof document.documentMode == "number" || eval("/*@cc_on!@*/!1");
  try {
    document.documentMode = tmp;
  } catch (e) {};

  // We only let IE run this code.
  if (browser.isIE) {
    browser.verIE_ua =
      (/^(?:.*?[^a-zA-Z])??(?:MSIE|rv\s*\:)\s*(\d+\.?\d*)/i).test(navigator.userAgent || "") ?
      parseFloat(RegExp.$1, 10) : null;

    var e, verTrueFloat, x,
      obj = document.createElement("div"),

      CLASSID = [
        "{45EA75A0-A269-11D1-B5BF-0000F8051515}", // Internet Explorer Help
        "{3AF36230-A269-11D1-B5BF-0000F8051515}", // Offline Browsing Pack
        "{89820200-ECBD-11CF-8B85-00AA005B4383}"
      ];

    try {
      obj.style.behavior = "url(#default#clientcaps)"
    } catch (e) {};

    for (x = 0; x < CLASSID.length; x++) {
      try {
        browser.verIEtrue = obj.getComponentVersion(CLASSID[x], "componentid").replace(/,/g, ".");
      } catch (e) {};

      if (browser.verIEtrue) break;

    };
    verTrueFloat = parseFloat(browser.verIEtrue || "0", 10);
    browser.docModeIE = document.documentMode ||
      ((/back/i).test(document.compatMode || "") ? 5 : verTrueFloat) ||
      browser.verIE_ua;
    browser.verIE = verTrueFloat || browser.docModeIE;
  };

  return {
    isIE: browser.isIE,
    Version: browser.verIE
  };

}();

document.write('isIE: ' + ieDetector.isIE + "<br />");
document.write('IE Version Number: ' + ieDetector.Version);
```

然后使用：

```
if((ieDetector.isIE) && (ieDetector.Version <= 9))
{

} 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2014-02-09T14:50:42.090

对于即 10 和 11：

您可以使用js并在html中添加一个类来保持[条件注释](https://stackoverflow.com/questions/10964966/detect-ie-version-in-javascript)的标准：

```
 var ua = navigator.userAgent,
      doc = document.documentElement;

  if ((ua.match(/MSIE 10.0/i))) {
    doc.className = doc.className + " ie10";

  } else if((ua.match(/rv:11.0/i))){
    doc.className = doc.className + " ie11";
  } 
```

或者使用像 bowser 这样的库：

[https://github.com/ded/bowser](https://github.com/ded/bowser)

或用于特征检测的modernizr：

[http://modernizr.com/](http://modernizr.com/)

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2016-02-17T16:39:59.123

这已经被回答到死了，但这就是你所需要的。

```
!!navigator.userAgent.match(/msie\s[5-8]/i) 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-12-08T20:49:00.533

```
var Browser = new function () {
    var self = this;
    var nav = navigator.userAgent.toLowerCase();
    if (nav.indexOf('msie') != -1) {
        self.ie = {
            version: toFloat(nav.split('msie')[1])
        };
    };
};

if(Browser.ie && Browser.ie.version > 9)
{
    // do something
} 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2014-08-08T21:28:17.393

要检测 Internet Explorer 10|11，您可以在 body 标记之后立即使用这个小脚本：

在我的情况下，我使用加载在 head 中的 jQuery 库。

```
<!DOCTYPE HTML>
<html>
<head>
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
</head>
<body>
    <script>if (navigator.appVersion.indexOf('Trident/') != -1) $("body").addClass("ie10");</script>
</body>
</html> 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2014-04-17T10:31:40.310

根据[微软](http://msdn.microsoft.com/en-us/library/ms537509%28v=vs.85%29.aspx)的说法，以下是最好的解决方案，也很简单：

```
function getInternetExplorerVersion()
// Returns the version of Internet Explorer or a -1
// (indicating the use of another browser).
{
    var rv = -1; // Return value assumes failure.
    if (navigator.appName == 'Microsoft Internet Explorer')
    {
        var ua = navigator.userAgent;
        var re  = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
        if (re.exec(ua) != null)
            rv = parseFloat( RegExp.$1 );
    }
    return rv;
}

function checkVersion()
{
    var msg = "You're not using Internet Explorer.";
    var ver = getInternetExplorerVersion();

    if ( ver > -1 )
    {
        if ( ver >= 8.0 ) 
            msg = "You're using a recent copy of Internet Explorer."
        else
            msg = "You should upgrade your copy of Internet Explorer.";
      }
    alert( msg );
} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2014-01-17T21:08:00.510

我发现用于检查 IE 版本的最全面的 JS 脚本是[http://www.pinlady.net/PluginDetect/IE/](http://www.pinlady.net/PluginDetect/IE/)。整个库位于[http://www.pinlady.net/PluginDetect/Browsers/](http://www.pinlady.net/PluginDetect/Browsers/)。

IE10 不再支持条件语句。

在 IE11 中，用户代理不再包含 MSIE。此外，使用用户代理是不可靠的，因为它可以被修改。

使用 PluginDetect JS 脚本，您可以使用针对特定 IE 版本的非常具体且精心设计的代码来检测 IE 并检测确切的版本。当您确切关心您正在使用的浏览器版本时，这非常有用。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2015-07-02T15:27:32.147

我将建议不要无数次重写此代码。我建议您使用 Conditionizr 库 ( [http://conditionizr.com/](http://conditionizr.com/) )，它能够测试特定 IE 版本以及其他浏览器、操作系统，甚至是否存在 Retina 显示器。

仅包含您需要的特定测试的代码，并且您还可以获得经过多次迭代的测试库的好处（并且可以在不破坏代码的情况下轻松升级）。

它还与 Modernizr 很好地结合在一起，它可以处理所有那些你最好测试特定功能而不是特定浏览器的情况。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2015-08-21T18:23:47.207

我喜欢这样：

```
<script>
   function isIE () {
       var myNav = navigator.userAgent.toLowerCase();
       return (myNav.indexOf('msie') != -1) ? parseInt(myNav.split('msie')[1]) : false;
   }    
   var ua = window.navigator.userAgent;
   //Internet Explorer | if | 9-11

   if (isIE () == 9) {
       alert("Shut down this junk! | IE 9");
   } else if (isIE () == 10){
       alert("Shut down this junk! | IE 10");
   } else if (ua.indexOf("Trident/7.0") > 0) {
       alert("Shut down this junk! | IE 11");
   }else{
       alert("Thank god it's not IE!");
   }

</script> 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-08-31T14:17:42.470

这种检测 IE 的方法结合了 jKey 使用条件注释的答案和 Owen 使用用户代理的答案的优点并避免了缺点。

*   jKey 的方法适用于版本 9，并且不受 IE 8 和 9 中用户代理欺骗的影响。
*   Owen 的方法在 IE 5 和 6（报告 7）上可能会失败，并且容易受到 UA 欺骗，但它可以检测到 IE 版本 >= 10（现在还包括 12，这是 Owen 的回答之后的版本）。

    ```
    // ----------------------------------------------------------
    // A short snippet for detecting versions of IE
    // ----------------------------------------------------------
    // If you're not in IE (or IE version is less than 5) then:
    //     ie === undefined
    // Thus, to detect IE:
    //     if (ie) {}
    // And to detect the version:
    //     ie === 6 // IE6
    //     ie > 7 // IE8, IE9 ...
    // ----------------------------------------------------------
    var ie = (function(){
        var v = 3,
            div = document.createElement('div'),
            all = div.getElementsByTagName('i');

        while (
            div.innerHTML = '<!--[if gt IE ' + (++v) + ']><i></i><![endif]-->',
            all[0]
        );
        if (v <= 4) { // Check for IE>9 using user agent
            var match = navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:|Edge\/)(\d+)/);
            v = match ? parseInt(match[1]) : undefined;
        }
        return v;
    }()); 
    ```

这可用于为包含 IE 版本的文档设置有用的类：

```
 if (ie) {
        document.documentElement.className += ' ie' + ie;
        if (ie < 9)
            document.documentElement.className += ' ieLT9';
    } 
```

请注意，如果 IE 处于兼容模式，它会检测正在使用的兼容模式。另请注意，IE 版本对旧版本（<10）最有用；更高的版本更符合标准，最好使用诸如modernizr.js之类的东西来检查功能。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2016-05-23T19:11:34.623

我为此做了一个方便的下划线混合。

```
_.isIE();        // Any version of IE?
_.isIE(9);       // IE 9?
_.isIE([7,8,9]); // IE 7, 8 or 9? 
```

```
_.mixin({
  isIE: function(mixed) {
    if (_.isUndefined(mixed)) {
      mixed = [7, 8, 9, 10, 11];
    } else if (_.isNumber(mixed)) {
      mixed = [mixed];
    }
    for (var j = 0; j < mixed.length; j++) {
      var re;
      switch (mixed[j]) {
        case 11:
          re = /Trident.*rv\:11\./g;
          break;
        case 10:
          re = /MSIE\s10\./g;
          break;
        case 9:
          re = /MSIE\s9\./g;
          break;
        case 8:
          re = /MSIE\s8\./g;
          break;
        case 7:
          re = /MSIE\s7\./g;
          break;
      }

      if (!!window.navigator.userAgent.match(re)) {
        return true;
      }
    }

    return false;
  }
});

console.log(_.isIE());
console.log(_.isIE([7, 8, 9]));
console.log(_.isIE(11));
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2018-04-08T17:35:59.070

或者干脆

```
//   IE 10: ua = 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)'; 
//   IE 11: ua = 'Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko'; 
// Edge 12: ua = 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36 Edge/12.0'; 
// Edge 13: ua = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586'; 

var isIE = navigator.userAgent.match(/MSIE|Trident|Edge/)
var IEVersion = ((navigator.userAgent.match(/(?:MSIE |Trident.*rv:|Edge\/)(\d+(\.\d+)?)/)) || []) [1] 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-06-18T10:30:28.093

我意识到我在这里聚会有点晚了，但我一直在检查一种简单的单行方式来提供有关浏览器是否是 IE 以及它是 10 以后的版本的反馈。我没有为版本 11 编写此代码，因此可能需要对此进行一些修改。

然而，这是代码，它作为一个具有属性和方法的对象工作，并且依赖于对象检测而不是抓取导航器对象（它存在大量缺陷，因为它可以被欺骗）。

```
var isIE = { browser:/*@cc_on!@*/false, detectedVersion: function () { return (typeof window.atob !== "undefined") ? 10 : (typeof document.addEventListener !== "undefined") ? 9 : (typeof document.querySelector !== "undefined") ? 8 : (typeof window.XMLHttpRequest !== "undefined") ? 7 : (typeof document.compatMode !== "undefined") ? 6 : 5; } }; 
```

该用法是`isIE.browser`一个返回布尔值并依赖于条件注释的属性，该方法`isIE.detectedVersion()`返回一个介于 5 和 10 之间的数字。我假设任何低于 6 的值，你都处于严肃的老派领域，你会比一个班轮和任何高于 10 的班轮，你就进入了新的领域。我读过一些关于 IE11 不支持条件评论的内容，但我还没有完全调查，可能是以后的日期。

无论如何，就目前而言，它会涵盖 IE 浏览器和版本检测的基础知识。它远非完美，但它很小且易于修改。

仅供参考，如果有人对如何实际实现这一点有任何疑问，那么以下条件应该会有所帮助。

```
var isIE = { browser:/*@cc_on!@*/false, detectedVersion: function () { return (typeof window.atob !== "undefined") ? 10 : (typeof document.addEventListener !== "undefined") ? 9 : (typeof document.querySelector !== "undefined") ? 8 : (typeof window.XMLHttpRequest !== "undefined") ? 7 : (typeof document.compatMode !== "undefined") ? 6 : 5; } };

/* testing IE */

if (isIE.browser) {
  alert("This is an IE browser, with a detected version of : " + isIE.detectedVersion());
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2014-06-18T13:45:46.467

检测 IE 及其版本再简单不过了，您只需要一点原生/原版 Javascript：

```
var uA = navigator.userAgent;
var browser = null;
var ieVersion = null;

if (uA.indexOf('MSIE 6') >= 0) {
    browser = 'IE';
    ieVersion = 6;
}
if (uA.indexOf('MSIE 7') >= 0) {
    browser = 'IE';
    ieVersion = 7;
}
if (document.documentMode) { // as of IE8
    browser = 'IE';
    ieVersion = document.documentMode;
} 
```

这是一种使用它的方法：

```
if (browser == 'IE' && ieVersion <= 9) 
    document.documentElement.className += ' ie9-'; 
```

.

适用于所有 IE 版本，包括较低兼容性视图/模式的更高版本，并且`documentMode`是 IE 专有的。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2014-10-15T06:33:56.380

**如果您需要选择 IE 浏览器版本，则可以按照以下代码进行操作。此代码适用于 IE6 到 IE11 版本**

```
<!DOCTYPE html>
<html>
<body>

<p>Click on Try button to check IE Browser version.</p>

<button onclick="getInternetExplorerVersion()">Try it</button>

<p id="demo"></p>

<script>
function getInternetExplorerVersion() {
   var ua = window.navigator.userAgent;
        var msie = ua.indexOf("MSIE ");
        var rv = -1;

        if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer, return version number
        {               
            if (isNaN(parseInt(ua.substring(msie + 5, ua.indexOf(".", msie))))) {
                //For IE 11 >
                if (navigator.appName == 'Netscape') {
                    var ua = navigator.userAgent;
                    var re = new RegExp("Trident/.*rv:([0-9]{1,}[\.0-9]{0,})");
                    if (re.exec(ua) != null) {
                        rv = parseFloat(RegExp.$1);
                        alert(rv);
                    }
                }
                else {
                    alert('otherbrowser');
                }
            }
            else {
                //For < IE11
                alert(parseInt(ua.substring(msie + 5, ua.indexOf(".", msie))));
            }
            return false;
        }}
</script>

</body>
</html> 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-01-07T03:36:10.830

Window 运行 IE10 会自动更新到 IE11+ 并且会标准化 W3C

现在，我们不需要支持 IE8-

```
 <!DOCTYPE html>
    <!--[if lt IE 9]><html class="ie ie8"><![endif]-->
    <!--[if IE 9]><html class="ie ie9"><![endif]-->
    <!--[if (gt IE 9)|!(IE)]><!--><html><!--<![endif]-->
    <head>
        ...
        <!--[if lt IE 8]><meta http-equiv="Refresh" content="0;url=/error-browser.html"><![endif]--
        ...
    </head> 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2015-04-24T02:07:41.473

```
var isIE9OrBelow = function()
{
   return /MSIE\s/.test(navigator.userAgent) && parseFloat(navigator.appVersion.split("MSIE")[1]) < 10;
} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2015-11-12T06:56:56.930

```
if (!document.addEventListener) {
    // ie8
} else if (!window.btoa) {
    // ie9
}
// others 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2015-11-18T01:01:19.553

```
// Detect ie <= 10
var ie = /MSIE ([0-9]+)/g.exec(window.navigator.userAgent)[1] || undefined;

console.log(ie);
// Return version ie or undefined if not ie or ie > 10 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2016-09-06T07:04:56.377

下面的 codepen 在所有情况下识别 IE 版本（IE<=9、IE10、IE11 和 IE/Edge）

```
function detectIE() {
    var ua = window.navigator.userAgent;
    var msie = ua.indexOf('MSIE ');
    if (msie > 0) {
        // IE 10 or older => return version number
        return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);
    }
    var trident = ua.indexOf('Trident/');
    if (trident > 0) {
        // IE 11 => return version number
        var rv = ua.indexOf('rv:');
        return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);
    }
    var edge = ua.indexOf('Edge/');
    if (edge > 0) {
        // Edge (IE 12+) => return version number
        return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);
    }
    // other browser
    return false;
} 
```

参考：[https ://codepen.io/gapcode/pen/vEJNZN](https://codepen.io/gapcode/pen/vEJNZN)

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2017-05-18T14:19:50.813

不要把这些简单的事情复杂化。只需使用简单的 JScript 条件注释即可。它是最快的，因为它向非 IE 浏览器添加了零代码进行检测，并且它的兼容性可以追溯到支持 HTML 条件注释之前的 IE 版本。简而言之，

```
var IE_version=(-1/*@cc_on,@_jscript_version@*/); 
```

**当心缩小器：大多数（如果不是全部）会将特殊条件注释误认为是常规注释，并将其删除**

基本上，上面的代码将 IE_version 的值设置为您正在使用的 IE 版本，或者 -1 如果您不使用 IE。现场演示：

```
var IE_version=(-1/*@cc_on,@_jscript_version@*/);
if (IE_version!==-1){
    document.write("<h1>You are using Internet Explorer " + IE_version + "</h1>");
} else {
    document.write("<h1>You are not using a version of Internet Explorer less than 11</h1>");
}
```

这是基于条件注释仅在旧版本的 Internet Explorer 中可见的事实，并且 IE 设置`@_jscript_version`为浏览器的版本。例如，如果您使用的是 Internet Explorer 7，`@_jscript_version`则将设置为`7`，因此，将执行的后处理 javascript 实际上如下所示：

```
var IE_version=(-1,7); 
```

评估为 7。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2018-01-30T07:30:50.083

它帮助了我

```
function IsIE8Browser() {
  var rv = -1;
  var ua = navigator.userAgent;
  var re = new RegExp("Trident\/([0-9]{1,}[\.0-9]{0,})");
  if (re.exec(ua) != null) {
    rv = parseFloat(RegExp.$1);
  }
  return (rv == 4);
} 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2018-04-01T14:40:24.403

```
function getIEVersion(){
     if (/MSIE |Trident\//.test( navigator.userAgent )=== false) return -1;
    /**[IE <=9]*/
    var isIE9L = typeof ( window.attachEvent ) === 'function' && !( Object.prototype.toString.call( window.opera ) == '[object Opera]' ) ? true : false;
    var re;
    if(isIE9L){
        re = new RegExp( "MSIE ([0-9]{1,}[\.0-9]{0,})" );
        if(re.exec( navigator.userAgent ) !== null)
            return parseFloat( RegExp.$1 );
        return -1;
    }
    /**[/IE <=9]*/
    /** [IE >= 10]*/
    if(navigator.userAgent.indexOf( 'Trident/' ) > -1){
        re = new RegExp( "rv:([0-9]{1,}[\.0-9]{0,})" );
        if(re.exec( navigator.userAgent ) !== null)
            return parseFloat( RegExp.$1 );
        return -1;
    }
    /**[/IE >= 10]*/
    return -1;
}; 
```

在这里检查==>

```
var ieVersion = getIEVersion();

if(ieVersion < 0){
    //Not IE
}
//A version of IE 
```

了解有关浏览器导航器的更多信息 [https://developer.mozilla.org/en-US/docs/Web/API/Window/navigator](https://developer.mozilla.org/en-US/docs/Web/API/Window/navigator)

* * *

## 回答 #36

> 赞同：-1
> 
> 时间：2014-11-28T13:20:15.347

使用 JQuery：

[http://tanalin.com/en/articles/ie-version-js/](http://tanalin.com/en/articles/ie-version-js/)

使用 C#：

```
var browser = Request.Browser.Browser; 
```

* * *

## 回答 #37

> 赞同：-1
> 
> 时间：2015-02-20T18:01:22.427

简单的解决方案停止思考浏览器并使用一年。

```
var year = eval(today.getYear());
if(year < 1900 )
 {alert('Good to go: All browsers and IE 9 & >');}
else
 {alert('Get with it and upgrade your IE to 9 or >');} 
```

# java - 使用时间选择器作为计时器？

> ID：10964974
> 
> 赞同：0
> 
> 时间：2012-06-09T22:15:56.717
> 
> 标签：java, android, debugging, android-view, timepicker

无论如何使用时间选择器作为计时器......就像如果用户在时间选择器上选择 1 小时 30 分钟，它将从现在开始设置警报一小时 30 分钟，而不是像早上 1.30 那样？还有没有办法摆脱时间选择器的标题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:30:48.963

> 无论如何都可以使用`TimePicker`计时器......就像用户选择 1:30 一样，`TimePicker`它会在 1 小时 30 分钟后设置闹钟？

显示`TimePicker`时间，而不是数量。如果你真的想要，你可以用这种方式解释时间，但如果用户想设置闹钟，比如从现在起 25 小时，它就不是很有用了。

我建议您改为实施自己的`View`（或谷歌搜索已经制作的）。

> 有没有摆脱时间选择器的标题？

如果你的意思是`TimePickerDialog`，那么是的。你可以打电话[`setTitle(CharSequence title)`](http://tinyurl.com/ccswlcp)。

* * *

## 编辑：

在评论中，你问，

> 更改时间时如何防止标题自动更新？

看一下[源码](http://www.netmite.com/android/mydroid/frameworks/base/core/java/android/app/TimePickerDialog.java)，你会发现该`onTimeChanged`方法默认会像这样更新标题。为了防止标题被更新，您需要实现一个`TimePickerDialog.OnTimeSetListener`,

```
private OnTimeChangedListener mListener = new TimePicker.OnTimeChangedListener() {
    @Override      
    public void onTimeChanged(TimePicker view, int hourOfDay, int minute) {
        // do nothing when time is changed
    }
}; 
```

然后在实例[化](http://tinyurl.com/cswq5u9)`TimePickerDialog`.

# java - 使用 opencsv 将 csv 文件解析为类 getter 方法

> ID：10964975
> 
> 赞同：1
> 
> 时间：2012-06-09T22:16:48.510
> 
> 标签：java, arraylist, opencsv

我正在尝试使用 opencsv 传递一个 csv 文件。该 csv 文件有三列 (,)。如何使用各自的值将每一行解析为我的数组列表？请参阅下面的代码。

```
public class Customer { 

    private String accNum;  
    private String fName;   
    private String lName;   

    public Customer(String accNum, String fName, String lName) {        

    this.accNum = accNum;
    this.fName = fName;
    this.lName = lName;
     }

    //getters & setters
    ...
}

public class CustomerList{

public void getCustList(File file) throws IOException {     
    List <Customer> custList = new ArrayList <Customer>();
    CSVReader reader = new CSVReader (new FileReader (file));
    String [] header = reader.readNext();       
    List<String[]> cList = reader.readAll();

    for (int i =0 ; i < cList.size(); i++)
    {
        String[] line = cList.get(i); //not sure how to do this
        for (String list: line)
        {
            custList.add( new Customer (list));// constructor takes three arguments
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:26:48.903

我会将for循环修改为这样的

```
for(int i = 0; i < cList.size(); i++) {
    String[] line = cList.get(i);
    custList.add(new Customer(line[0], line[1], line[2]));
} 
```

当然，假设列的顺序是 accNum、fName、lName。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T22:27:06.513

它有点像 JDBC ResultSet。

```
List <Customer> custList = new ArrayList <Customer>();
CSVReader reader = new CSVReader (new FileReader (file));
String[] header = reader.readNext();
if (header == null)
{
    throw new RuntimeException("No header");
}

String[] row;
while ((row = reader.readNext()) != null)
{
    if (row.length != 3) {
        throw new RuntimeException("Unexpected number of entries: " + row.length);
    }
    custList.add(new Customer(row[0], row[1], row[2]));
} 
```

# regex - 有效布尔表达式的正则表达式

> ID：10964977
> 
> 赞同：1
> 
> 时间：2012-06-09T22:17:32.653
> 
> 标签：regex, boolean, expression, formula

我想在公式列表中搜索有效的布尔公式，例如 A'+BC(D+E)。对正则表达式有任何帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:18:57.640

没有这样的正则表达式。布尔表达式可以具有任意级别的嵌套括号，这使得它们成为一种非常规语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-16T21:58:35.503

我使用 python 使用一些独立的规则来实现它，例如：

*   检查表达式是否没有'and'后跟'or'，也没有'or'后跟'and'

*   开括号 '(' 后面必须跟除 'and'、'or' 以外的其他内容；并且必须跟在 'and' 或 'or' 之后（除非在开头计算）

*   右括号 ')' 必须跟在 'and' 或 'or' 或字符串结尾字符 '$' 之后，并且必须跟在 'or','and' 以外的其他内容之后

*   ......

这是一个使用 python 的示例（但假设我们使用 PCRE 正则表达式来支持可变宽度后视）：

```
 tmp= query
    tmp= re.sub("[(]", " (", query)
    tmp= re.sub(" +", " ", query)
    if re.search(r"\(( *and| *or| *\))", tmp) or re.search(r"(?<!\band|\bor) \(", tmp):
        return False

    if re.search(r"\)(?!( *or\b| *and\b|$))", tmp) or re.search(r"(\band *|\bor *)\)", tmp):
        return False

    if re.search(r"(\band|\bor)( and\b| or\b)", tmp) or re.search(r"(?<!\band|\bor) (?!and\b|or\b)", tmp):
        return False

    return True 
```

# javascript - Javascript变量--在变量后添加（）是什么意思？

> ID：10964979
> 
> 赞同：1
> 
> 时间：2012-06-09T22:17:51.857
> 
> 标签：javascript

[我刚开始从EloquentJavascript](http://eloquentjavascript.net/chapter3.html#p33f5c110)学习 js 我需要 2 个答案来帮助我通过这个例子：

```
function makeAddFunction(amount) {
  function add(number) {
    return number + amount;
  }
  return add;
}

var addTwo = makeAddFunction(2);
var addFive = makeAddFunction(5);
show(addTwo(1) + addFive(1)); 
```

## 问题一：

我们可以在变量含义之后添加（）来为变量所代表的函数添加参数吗？像 addTwo(1) 意味着 makeAddFunction(1)？

## 问题2：

makeAddFunction(2) 表示数量 = 2，那么数字的值是多少？如果我选择上述示例的一部分，下一部分将返回什么？

```
function makeAddFunction(2) {
  function add(number) {
    return number + 2;
  }
  return add;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T22:25:03.100

如果您查看返回类型，您的两个问题都会得到解答`makeAddFunction(amount)`。您正在返回一个函数`add(number)`。因此，通过定义`addTwo`as `makeAddFunction(2)`，您将返回以下函数：

```
function add(number) {
    return number+2;
} 
```

如果`addTwo`和`addFive`是函数，则 show(...) 将显示：`9`。(2+1)+(5+1)=9

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-09T22:26:41.947

> 我们可以在变量含义之后添加（）来为变量所代表的函数添加参数吗？像 addTwo(1) 表示 makeAddFunction(1)

没有。`addTwo(1)`等于`makeAddFunction(2)(1)`

> makeAddFunction(2) 表示数量 = 2，那么数字的值是多少？在以下 example2 中，将返回什么？

您另外通过它，当调用`addTwo`或`addFive`

# python - 为什么 file.read() 不读取第一行？

> ID：10964981
> 
> 赞同：0
> 
> 时间：2012-06-09T22:17:55.483
> 
> 标签：python, file-io, python-2.5

我不知道为什么，但是当我尝试使用 file.read() 读取文件时，Python 无法识别文件的第一行。这是解释器错误，还是我的错？

你有一个程序的副本在这里（显示读取结果）： http: [//pastebin.ubuntu.com/1032832/](http://pastebin.ubuntu.com/1032832/)

这是导致问题的代码：

```
if wfile.readline() != "#! /usr/bin/env python\n":
    before = wfile.read()
    wfile.seek(0)
    wfile.write('#! /usr/bin/env python\n' + before)
    wfile.close()
    os.chmod(file, 777) 
```

我用于测试的 Python 版本是 Python 2.5.1 for iOS（Cydia 端口）。我的设备是 iPad 2。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-09T22:19:26.427

您正在使用-statement`readline()`中的函数读取文件的第一行。`if`当您到达 时`read()`，第一行已经被阅读。

随后`write()`将写入`wfile.read()` 已读取的内容。

看起来您想检查文件的第一行是否包含适当的`#!/usr/bin/...`行。如果不是，你想在当前第一行之前插入它，然后在它下面写下原来的第一行。这将做到：

```
with open(file, 'r+') as wfile:
   before = wfile.readline()
   if before != "#! /usr/bin/env python\n":
      wfile.seek(0)
      wfile.write('#! /usr/bin/env python\n' + before) 
```

这样，您将原始的第一行保存在变量中`before`以供以后使用。

***注意***: using在您完成或遇到异常时`with` **自动为您关闭文件。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T00:34:30.237

```
import os

file_name = 'foo.py'
shebang = '#!/usr/bin/env python'

with open(file_name, 'r') as f:
    lines = f.read().splitlines()
if shebang not in lines[0]:
    lines.insert(0, shebang)
    with open(file_name, 'r+') as f:
        f.write('\n'.join(lines))

os.chmod(file_name, 777) 
```

# python - 在 save 方法中创建两个对象

> ID：10964982
> 
> 赞同：3
> 
> 时间：2012-06-09T22:17:57.180
> 
> 标签：python, mysql, django, django-models

我想覆盖一个保存方法，以便为每个保存创建两个对象而不是一个。我将如何执行以下操作？

```
class Message(models.Model):
    thread = models.ForeignKey('MessageThread')
    content = models.CharField(max_length=5000)
    sender = models.ForeignKey(UserProfile, related_name='message_sender')

    # filled in automatically on save()
    timestamp = models.DateTimeField(auto_now_add=True)
    recipient = models.ForeignKey(UserProfile, related_name='message_recipient')
    status = models.CharField(choices=MESSAGE_STATUS, max_length=64, default='unread')

    def save(self, *args, **kwargs):
        """
        When a message is created, this will save TWO objects of it.
        """
        sender = self.sender
        thread_initiator = self.thread.initiator
        thread_recipient = self.thread.recipient
        if sender == thread_recipient:
            self.recipient = thread_initiator
        else:
            self.recipient = thread_recipient
        self.status = 'unread' 
        super(Message, self).save(*args, **kwargs)

        # saving the second object creates an error
        Message.objects.create(thread=self.thread, content=self.content, sender=sender, recipient=sender, status='read')

--> RuntimeError: maximum recursion depth exceeded while calling a Python object 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T22:27:16.753

做两个`super`，如果有一个自动增量字段，不要忘记增加 pk 或`IntegrityError`将提高。

```
def save(self, *args, **kwargs):
    sender = self.sender
    thread_initiator = self.thread.initiator
    thread_recipient = self.thread.recipient
    if sender == thread_recipient:
        self.recipient = thread_initiator
    else:
        self.recipient = thread_recipient
    self.status = 'unread' 
    super(Message, self).save(*args, **kwargs)

    # instead of Message.objects.create(thread=self.thread, content=self.content, sender=sender, recipient=sender, status='read')
    self.pk +=1
    self.sender = sender
    self.recipient = sender
    self.status = 'read'
    super(Message, self).save(*args, **kwargs) 
```

# android - android从类传回变量

> ID：10964983
> 
> 赞同：0
> 
> 时间：2012-06-09T22:18:01.587
> 
> 标签：android, android-alertdialog

我正在尝试制作一个可重用的 UI 类。我承认我不明白它应该如何工作。我想要一个类，我将参数传递到其中，当用户进行选择时，它将返回选定的值。这实际上将是一个更复杂的自定义对话框，将被使用。为了进行测试，我将我找到的示例中的以下代码放在一起，它会执行所有操作，但会返回选定的值。

那么，我怎样才能在主程序中获取用户选择的值呢？

主模块包com.mine.zd；

```
import android.app.Activity;
import android.content.DialogInterface;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.Button;

public class ZDialogActivity extends Activity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Button btn1 = (Button) findViewById(R.id.btn1);
        btn1.setOnClickListener(new View.OnClickListener(){
            @Override
            public void onClick(View arg0){
                go();
            }
        });
    }

    private void go()
    {
       final String[] vOptions = { "One", "Two", "Three" } ;

       myOptions.getmenuOptions(
        ZDialogActivity.this, "Select Mode", vOptions,
            new android.content.DialogInterface.OnClickListener(){
               @Override
               public void onClick(DialogInterface dialog, int which) {
                  Log.w("TEST", "which=" + which );
               }
            }
       );
    }
} 
```

被称为模块

```
package com.mine.zd;

import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.util.Log;

public class myOptions {

    public static void getmenuOptions(Context context, String msg,
         String[] vOptions, OnClickListener neutralClickListener){

        new AlertDialog.Builder(context)
        .setTitle("Select Mode")
        .setItems(vOptions, new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {              
                Log.w("TEST", "item=" + whichButton );
                dialog.dismiss();
            }
        })
        .setNeutralButton("Cancel", neutralClickListener )
        .create().show();
    }
} 
```

我确实得到了返回的“取消”按钮值为-3，但我需要所选选项的 id。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T23:29:59.423

这里怎么样：

```
import android.R;
import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.View;

import com.your.package.MyOptions.MyDialogClickListener;

public class ZDialogActivity extends Activity implements View.OnClickListener, MyDialogClickListener {

    private MyOptions options;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        findViewById(R.id.btn1).setOnClickListener(this);

        String[] vOptions = { "One", "Two", "Three" };
        options = new MyOptions(vOptions, this);
    }

    @Override
    public void onClick(View v) {
        switch (v.getId()) {
        case R.id.btn1:
            go();
            break;
        default:
            Log.e("TEST", "Unhandled onClick");
            break;
        }
    }

    private void go() {
        options.getMenuOptions(this, "Select Mode");
    }

    @Override
    public void onMyDialogClick(String option){
        Log.d("TEST", "item=" + option);
    }
} 
```

还有你的助手类：

```
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;

public class MyOptions implements OnClickListener {

    private final MyDialogClickListener listener;
    private final String[] options;

    public interface MyDialogClickListener {
        void onMyDialogClick(String option);
    }

    public MyOptions(String[] options, MyDialogClickListener listener) {
        this.options = options;
        this.listener = listener;
    }

    public void getMenuOptions(Context context, String msg)  {
        new AlertDialog.Builder(context)
            .setTitle(msg)
            .setItems(options, this)
            .setNeutralButton("Cancel", this)
            .create()
            .show();
    }

    @Override
    public void onClick(DialogInterface dialog, int which) {
        if(listener != null)
            listener.onMyDialogClick(options[which]);
        dialog.dismiss();
    }
} 
```

1）以大写开头你的类名

2）不要使用静态辅助方法，实例化类在这种情况下更好的做法

3）然后您可以将不变的字段传递给构造函数

4) 使用接口在类之间发送消息（您的 Activity 充当对话框 onClick 事件的侦听器）

5）不要使用烦人的 onClick 监听器，让你的类实现它并打开视图 id 来确定哪个被点击

希望有帮助！

# c# - 在 lambda 表达式中使用 Action() 数组

> ID：10964985
> 
> 赞同：4
> 
> 时间：2012-06-09T22:18:02.650
> 
> 标签：c#

我想对使用 int 数组的方法进行一些性能测量，所以我编写了以下类：

```
public class TimeKeeper
{
    public TimeSpan Measure(Action[] actions)
    {
        var watch = new Stopwatch();
        watch.Start();
        foreach (var action in actions)
        {
            action();
        }
        return watch.Elapsed;
    }
} 
```

但我不能`Measure`为下面的例子调用 mehotd：

```
var elpased = new TimeKeeper();
elpased.Measure(
    () =>
    new Action[]
        {
            FillArray(ref a, "a", 10000),
            FillArray(ref a, "a", 10000),
            FillArray(ref a, "a", 10000)
        }); 
```

我收到以下错误：

```
Cannot convert lambda expression to type 'System.Action[]' because it is not a delegate type
Cannot implicitly convert type 'void' to 'System.Action'
Cannot implicitly convert type 'void' to 'System.Action'
Cannot implicitly convert type 'void' to 'System.Action' 
```

这是适用于数组的方法：

```
private void FillArray(ref int[] array, string name, int count)
{
    array = new int[count];

    for (int i = 0; i < array.Length; i++)
    {
        array[i] = i;
    }

    Console.WriteLine("Array {0} is now filled up with {1} values", name, count);
} 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-09T22:23:12.070

`Measure`期望它的第一个参数是一个`Action[]`，而不是一个返回一个的 lambda `Action[]`。并且 actions 数组希望您传递委托，而您实际上是在*调用* `FillArray`.

你可能想要这个：

```
elpased.Measure
(
    new Action[]
    {
        () => FillArray(ref a, "a", 10000),
        () => FillArray(ref a, "a", 10000),
        () => FillArray(ref a, "a", 10000)
    }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:36:24.307

> 无法将类型“void”隐式转换为“System.Action”

`Action`这个数组初始化器应该用方法返回的 s来填充数组，`FillArray`但事实并非如此。

```
new Action[]
        {
            FillArray(ref a, "a", 10000),
            FillArray(ref a, "a", 10000),
            FillArray(ref a, "a", 10000)
        }); 
```

相应地更改`FillArray`以返回一个`Action`而不是`void`

# javascript - 如何制作基于个人浏览器的动态 GUI

> ID：10964986
> 
> 赞同：1
> 
> 时间：2012-06-09T22:18:08.163
> 
> 标签：javascript, html, web-applications, browser

我有（我自己的）java 应用程序来控制和监控模型铁路。自然地，它基于 Swing 并且 GUI 会随着火车在布局中移动而动态变化。GUI（当然）与连接到运行应用程序的计算机的显示器相关联，该计算机连接到布局上的电子设备。

是否可以重新安排一些窗口，以便可以使用（WiFi 连接的）浏览器远程打开某些窗口，可能是在不支持 Java 的手持设备上，并且无需为每个可能的手持设备执行本机应用程序？

我需要绘制、擦除和移动：文本、线条和图像。每列火车都由一个小图像表示，随着火车的移动，它会逐像素移动，因此可能涉及很多更新。有关示例轨迹图窗口，请参见[http://groups.yahoo.com/group/mergtcc/ 。](http://groups.yahoo.com/group/mergtcc/)

显然，更改发生在没有用户交互的情况下，因此服务器（当前应用程序加上可能的附加功能）需要发送更改，因为它们最好在没有客户端轮询的情况下发生。

我想同时支持几个客户——也许每列火车在布局上只有一个手持设备。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T22:47:01.403

我只是脑残：

使用 html + javascript 动态重新定位代表火车的某些 html 元素。那应该有很好的浏览器支持。在大多数手持设备上，让它们足够频繁地移动以显示动画可能不会成为性能问题。使用 html canvas 绘制火车是另一种选择，具有相当好的支持。我不确定什么表现最好。

使用套接字连接。浏览器支持参差不齐。Socket.io 项目旨在在各种浏览器中实现类套接字连接的各种方式前面提供一个门面。拥有 socket.io 的跨浏览器界面来构建可能会节省大量时间并提高质量。我没有使用它，但看起来他们有一些 Java 服务器端实现，这似乎是你的胡同。

# php - 文本文件的精灵

> ID：10964990
> 
> 赞同：0
> 
> 时间：2012-06-09T22:19:18.797
> 
> 标签：php, javascript, html, css

可以将多个图像放入单个图像文件中，然后通过 CSS 单独引用。这减少了 GET 请求。

有没有人为 html、javascript 和 CSS 文件（即文本文件）做类似的事情？

基本上把它们放在服务器的一个静态文件中，作为1个Get请求发送给客户端，然后被解析成单独的文件插入到DOM中

这将减少多个 GET 请求，类似于 Sprites。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T22:22:28.730

有时会这样做。例如，Dojo Toolkit 包括通过[一个小型 Java 实用程序](http://dojotoolkit.org/)[创建自定义构建](http://dojotoolkit.org/reference-guide/1.7/quickstart/custom-builds.html)的功能，该实用程序收集所有需要的 JavaScript 组件，并将它们组合并压缩到一个文件中。它同样将所有包含的 CSS 复制到一个文件中，并内联任何`@import`调用。

除了像 Dojo 这样的高级功能之外，没有什么能阻止您简单地将所有 CSS 转储`<head><style/></head>`到`<head><script/></head>`. 但是，它不被认为是最佳实践，因为它可能会阻碍代码重用，除非您已配置 CMS 为您执行插入和样式内联（就像 Dojo 为 JS 和相关组件所做的那样）。

# jquery - 确定元素相对于其偏移父元素的定位祖先的位置

> ID：10964992
> 
> 赞同：5
> 
> 时间：2012-06-09T22:19:40.610
> 
> 标签：jquery, dom, position, offset

我想确定`#target`' 相对于`#a`以下 HTML 文档中的偏移量 - 即，我想找到 和 的`x`值`y`：

[http://dl.dropbox.com/u/2792776/screenshots/2012-06-09_1814.png](http://dl.dropbox.com/u/2792776/screenshots/2012-06-09_1814.png)

jQuery 有`position()`, 但`$("#target").position()`返回`#target`' 相对于其父偏移量的偏移量，即`#c`(not `#a`)

我需要一个等效于 的函数，`$.fn.position()`而是返回相对于目标的“偏移祖先”而不是其直接偏移父对象的位置。例如：`$("#target").positionRelativeTo("#a")`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T22:24:56.970

您可以根据偏移量计算它：

```
var topoffset = $('#target').offset().top - $('#a').offset().top;
var leftoffset = $('#target').offset().left - $('#a').offset().left; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T07:35:38.137

这是我为我们正在进行的项目制作的 jQuery 扩展。我想这可能是你正在寻找的。

```
$.fn.relativePositionToAncestor = function (ancestor) {
    var positionedAncestor = $(ancestor);
    var object = $(this);

    var relativeOffset = { left: 0, top: 0 };

    var leftSpacing = parseInt(object.css("margin-left"));
    var topSpacing = parseInt(object.css("margin-top"));

    relativeOffset.left -= leftSpacing;
    relativeOffset.top -= topSpacing;

    var offsetParent = object.offsetParent();

    while (offsetParent[0] !== positionedAncestor[0] && !offsetParent.is('html')) {
        var offsetParentPosition = offsetParent.position();

        var offsetParentPositionLeft = offsetParentPosition.left;
        var offsetParentPositionTop = offsetParentPosition.top;

        relativeOffset.top -= offsetParentPositionTop;
        relativeOffset.left -= offsetParentPositionLeft;

        leftSpacing = parseInt(offsetParent.css("margin-left"));
        leftSpacing += parseInt(offsetParent.css("border-left-width"));
        topSpacing = parseInt(offsetParent.css("margin-top"));
        topSpacing += parseInt(offsetParent.css("border-top-width"));

        relativeOffset.left -= leftSpacing;
        relativeOffset.top -= topSpacing;

        offsetParent = offsetParent.offsetParent();
    }
    return relativeOffset;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T22:31:05.343

您可以使用[.parentsUntil()](http://api.jquery.com/parentsUntil/)并以这种方式计算组合位置：

```
var x=0;
var y=0;
$('#target').add($('#target').parentsUntil($('#a').parent())).each(function(){
  x+=$(this).position().left;
  y+=$(this).position().top;
});
alert(x+':'+y);​ 
```

[http://jsfiddle.net/rDzpy/](http://jsfiddle.net/rDzpy/)

# html - 嵌入在 HTML 中的 PDF：用作超链接

> ID：10964993
> 
> 赞同：0
> 
> 时间：2012-06-09T22:20:18.327
> 
> 标签：html, pdf, hyperlink

我在 HTML 页面中嵌入了一个 PDF（实际上，它是一个 ASPX 表单）。PDF 显示在一个小的“嵌入”HTML 元素中，使其看起来像一个缩略图。现在，我想将它用作一个超链接，以全尺寸显示相同的 PDF。有没有办法让嵌入的 PDF 充当超链接，还是我要求太多？

以下是相关的 HMTL：

```
<embed id="framePdfPreview" runat="server" width="200" height="255" /> 
```

以及动态设置 PDF 的服务器代码：

```
framePdfPreview.Attributes("src") = myPdfUrl & "#toolbar=0&navpanes=0&scrollbar=0" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T06:03:21.740

小实验，我从来没有尝试过`<embed>`用 a 包装 a`<div>`来达到这个目的，但理论上它应该可以工作：

```
<div onclick="javascript: window.open('myPdfUrl ','Window Name')">
   <embed id="framePdfPreview" runat="server" width="200" height="255" />
</div> 
```

这行得通，100% 测试了分区本身，我只希望浏览器将您嵌入的 pdf 识别为一部分，`<div>`如果不是，您还可以将分区的高度和宽度调整为与 pdf 相同以确保“链接”涵盖了 pdf 的整个区域。

```
<div style="width:200px; height:255px" onclick="javascript: window.open('myPdfUrl ','Window Name')">
   <embed id="framePdfPreview" runat="server" width="200" height="255" />
</div> 
```

我们可以尝试在嵌入的 PDF 上添加一个分区。获取 pdf 的确切位置并使用绝对位置和 left 和 top 值创建一个相同大小的分区来计算 pdf 位置，添加`z-index:9999`onclick 属性并将其添加到这个新分区。请注意，pdf 在新 div 之外。

```
 <div style="width:200px; height:255px; z-index:99999; position:absolute; left:?px; top:?px" onclick="javascript: window.open('myPdfUrl ','Window Name')">&nbsp;</div>
    <div id="pdf"><embed id="framePdfPreview" runat="server" width="200" height="255" /></div> 
```

# java - Java + Miglayout - 上边距边框问题？

> ID：10964994
> 
> 赞同：4
> 
> 时间：2012-06-09T22:20:18.703
> 
> 标签：java, swing, border, padding, miglayout

我的保证金有问题。可能它很容易解决，但我不知道是什么原因。我有四个组件，三个 jscrollpanel 和一个 jpanel。组件放置如下：

![成分](../Images/f0cec7c95dbb2cd0bb2ac4b25e7e3702.png)

问题用红色椭圆标记。如何消除这个利润？我知道，这个问题与边框有关（即使我为每个组件使用相同的方法创建边框）。我用这个：

```
setBorder(BorderFactory.createTitledBorder("Sterowanie:")); 
```

但是当我没有为 JPanel 设置边框时（带有标签“Sterowanie”的组件），它会填充所有没有边距的地方。使用边框，它只填充有边框的区域。我用来放置组件的代码：

```
proxys = new ItemViewer("Numery:");
add(proxys, "height 65%, width 33%");

accs = new ItemViewer("Konta:");
add(accs, "height 65%, width 33%");

panel = new JPanel();
panelLayout = new MigLayout("insets 0 0 0 0");
panel.setBorder(BorderFactory.createTitledBorder("Sterowanie:"));
add(panel, "height 65%, width 34%, wrap");

log = new Log("Log:");
add(log, "height 35%, width 100%, span"); 
```

嗯？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-05T21:21:46.960

你使用 MigLayout 的方式对我来说有点奇怪（请不要冒犯，我刚刚学会了另一种方式）。尝试这个：

```
content.setLayout(new MigLayout("fill", "[sg, grow][sg, grow][sg, grow]", "[65%][35%]"));
content.add(topLeftComponent, "grow");
content.add(topMiddleComponent, "grow");
content.add(topRightComponent, "grow, wrap");
content.add(bottomComponent, "span 3, grow"); 
```

我知道这不是同一种“精神”，但我总是发现这种风格更容易建立。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-22T15:43:02.573

不知道为什么会这样（我的第一个猜测是 ItemView 与普通面板的垂直默认对齐方式不同），但可以通过使所有单元格在单元格或行约束中可生长来重现 - 和解决方法：

```
 JComponent comp = new JScrollPane(new JTable(20, 1));
    comp.setBorder(new TitledBorder("Some Item"));
    JComponent other = new JScrollPane(new JTable(10, 1));
    other.setBorder(new TitledBorder("Other items"));
    JComponent panel = new JPanel();
    panel.setBorder(new TitledBorder("Stewhatever"));
    JTextArea log = new JTextArea();
    log.setBorder(new TitledBorder("Log"));

    MigLayout layout = new MigLayout("wrap 3, debug"); //, "", "[fill, grow]"); 
    JComponent content = new JPanel(layout);
    String cc = "width 33%, height 65%, grow";
    content.add(comp, cc);
    content.add(other, cc);
    content.add(panel, cc);
    content.add(log, "height 35%, span, grow"); 
```

没有任何增长，该片段会重现您的屏幕截图，在 cc 或注释行约束中增长，所有上部组件都在顶部对齐。

不确定这是一个错误还是应该预料到的

# prolog - Prolog：查找不满足目标的列表

> ID：10964995
> 
> 赞同：2
> 
> 时间：2012-06-09T22:20:19.687
> 
> 标签：prolog, depth-first-search, goal-tracking

如果我有一个问题的边缘列表，例如“告诉我从一个被认为是危险的城市到一个被认为是安全的城市的路线”，那么......

```
dangerous(oakland).
safe(portland).

move(rome,plane,portland).
move(portland,plane,rome).
move(halifax,train,gatwick).
move(gatwick,car,rome).
move(portland,plane,newyork).
move(oakland,plane,rome).
move(oakland,plane,gatwick).
move(halifax,train,gatwick).
move(gatwick,plane,rome).
move(oakland,train,newyork). 
```

我可以通过使用以下深度优先搜索（在 SO 上找到）获得通向安全城市的路径列表...

```
dfs_start(Start, Goal, Path) :- phrase(dfs(Start, [], Goal), Path).

dfs(Node, _, Goal)   --> [Node], { call(Goal, Node) }.
dfs(Node0, Es, Goal) --> [Node0],
        { move(Node0,_,Node1), \+ member(Node1, Es) },
        dfs(Node1, [Node0|Es], Goal). 
```

但是，我要解决的问题是从危险城市中找到所有不会通向安全城市的路径（在这种情况下，只有一个奥克兰-> 纽约。）如果我调用上述函数。 ..

```
dfs_start(oakland,safe,Path). 
```

...我明白了

```
Path = [oakland, rome, portland] ;
Path = [oakland, gatwick, rome, portland] ;
Path = [oakland, gatwick, rome, portland] ; 
```

...但我想做的是调用类似...

```
dfs_start(oakland,unsafe,Path). 
```

……得到……

```
Path = [oakland, newyork] ; 
```

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T06:05:18.373

问题描述模棱两可，也许这就是您怀疑的原因。据我了解，`unsafe(X).`显然是错误的，因为消除了每个过滤条件。您可以尝试以这种方式简化规则（我已经注释掉了效率低下的规则，您可以将其删除）：

```
% unsafe(X) :- findall(Y,safe(Y),SafeList), member(X,SafeList), !, fail.
unsafe(X) :- \+ safe(X). 
```

**编辑**您与 Will Ness 交换的评论澄清了一点任务：当路径无法进一步扩展时，停止条件必须为真，并且禁止任何安全城市进入路径。我简化了一点代码，去掉了不必要的特性，所以你可以专注于逻辑：图是非循环的，所以访问路径不是必需的，而不是传递一个 Goal，只需使用所需的语句：

```
unsafe_path([Start|Path]) :-
    dangerous(Start),
    phrase(dfs(Start), Path).

dfs(Node) --> [Node1],
   {  move(Node, _, Node1),
      \+ lead_to_safe(Node1)
    } -> dfs(Node1) ; {true}.

lead_to_safe(Node) :- safe(Node).
lead_to_safe(Node) :-
    move(Node, _, Node1),
    lead_to_safe(Node1). 
```

测试：

```
?- unsafe_path(P).
P = [oakland, newyork]. 
```

如果我们添加一个虚构的城市，则路径会延长：

```
?- assertz(move(newyork,train,turin)).

?- unsafe_path(P).
P = [oakland, newyork, turin]. 
```

如果我们让都灵成为通往安全城市的门户：

```
?- assertz(move(turin,train,portland)).

?- unsafe_path(P).
P = [oakland]. 
```

# binary - Erlang 0 位串模式匹配

> ID：10964998
> 
> 赞同：1
> 
> 时间：2012-06-09T22:22:12.010
> 
> 标签：binary, erlang, pattern-matching, bitstring

你如何在erlang中模式匹配等于0的位串？换句话说，形式的模式：

```
<<0:17>>
<<0:1>>
<<0:N>> 
```

这是为了定义一个函数。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-10T02:34:44.477

这是一个解决方法，希望对您有所帮助：

```
-module(lab).
-compile(export_all).

is_zero_bitstring(BitString) ->
    Size = erlang:bit_size(BitString),
    <<0:Size>> =:= BitString. 
```

在 Erlang shell 中运行它：

```
1> c(lab).
{ok,lab}
2> lab:is_zero_bitstring(<<0:17>>).
true
3> lab:is_zero_bitstring(<<0:1>>). 
true
4> lab:is_zero_bitstring(<<0:123456>>).  
true
5> lab:is_zero_bitstring(<<7>>).   
false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T21:54:53.193

这可能是你想要的吗？

```
1> A = <<0:17>>.
<<0,0,0:1>>
2> B = <<0:1>>.
<<0:1>>
3>  C = <<0:3>>.
<<0:3>>
4> F = fun(<<0:17, 0:1, Rest/bitstring>>) -> ok end.
#Fun<erl_eval.6.82930912>
5> F(<<A/bitstring, B/bitstring, C/bitstring>>).
ok
6> F(<<A/bitstring, B/bitstring, C/bitstring, 0:5>>).
ok
7> 
```

乐趣将匹配 0 中的 17 位，0 中的 1 位，以及 0 中的以下（N 长度）。在 #5 中，它用 0 中的 3 个附加位进行测试，在 #6 中还有 5 个（8 个零位在全部的）

# node.js - 是否有 Node.js 的标志列表？

> ID：10964999
> 
> 赞同：15
> 
> 时间：2012-06-09T22:22:13.037
> 
> 标签：node.js, ecmascript-harmony

我正在尝试查找 Node.js 接受的所有标志的列表，特别是那些用于 ES6-Harmony 功能的标志，但我找不到任何标志。有这样的吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-09T23:22:09.010

运行`node --v8-options`。这显示了您可以设置以更改 V8 行为的各种标志

例如，和谐特征的标志出现在那里：

```
 --harmony_typeof (enable harmony semantics for typeof)
     type: bool  default: false
 --harmony_proxies (enable harmony proxies)
     type: bool  default: false
 --harmony_weakmaps (enable harmony weak maps)
     type: bool  default: false
 --harmony_block_scoping (enable harmony block scoping)
     type: bool  default: false 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-11T04:39:00.300

如果您`--help`从 shell 将 switch 应用到 node，您将获得可用标志的列表；

```
node --help 
```