# StackOverflow 问答 000119000-000119999

# sql-server - 无法从 BI VS 2005 连接到报表服务器，但报表服务器是可浏览的

> ID：119000
> 
> 赞同：0
> 
> 时间：2008-09-23T03:49:10.120
> 
> 标签：sql-server, reporting-services, business-intelligence

我已经配置了 IIS6，这样浏览到[http://localhost:8082/Reports](http://localhost:8082/Reports)可以获得报告服务默认主页，这一切都符合预期。但是，当我尝试通过 Microsoft Business Intelligence Visual Studio 2005 发布报表时，我收到以下错误：无法连接到报表服务器 [http://localhost:8082/Reports](http://localhost:8082/Reports)连接到报表服务器的尝试失败. 检查您的连接信息以及报表服务器是否为兼容版本。

我为报表服务器打开了 Windows 身份验证。这与无法发布项目有什么关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T11:58:11.520

您是否尝试过将您的报告发布到：

[http://localhost:8082/ReportsServer](http://localhost:8082/ReportsServer)

“/ReportsServer”是 Reporting Services 的 Web 服务。“/Reports”是前端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T13:20:01.417

我不能投票，但家伙是正确的。进入 Project->Properties 并将 TargetServerURL 更改为“ [http://localhost:8082/ReportsServer](http://localhost:8082/ReportsServer) ”。这应该可以缓解您的问题。

如果您需要部署到命名实例，请记住您的 URL 将是“ [http://servername/ReportServer](http://servername/ReportServer) $instancename”。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2014-03-19T12:10:34.083

第一步：登录对应服务器即可

第 2 步：在 Internet Explorer[IE] 浏览器中进行设置，工具 => Internet 选项 => 选择连接选项卡 => 单击 LAN 设置 => 只需选中复选框使用代理服务器

第 3 步：问题将得到解决

# ruby-on-rails - 关于颠覆，我应该如何处理供应商目录？

> ID：119006
> 
> 赞同：5
> 
> 时间：2008-09-23T03:51:00.350
> 
> 标签：ruby-on-rails, svn, capistrano

所以我有一个问题。我检查了我的冷冻宝石和铁轨，即使你不应该这样做。我认为这很容易，而且不会有那么大的问题。好吧，后来我更新了 rails 并删除了 vendor/rails 目录中的所有 .svn 文件。我听说我真正*应该*做的就是对我的供应商目录做一些与 svn:externals 相关的事情。我到底需要做什么，如果我的仓库中没有我的冷冻宝石，capistrano 还会使用它们吗？如果它不使用我冻结的宝石，我怎样才能正确地重新生成那些 .svn 文件，因为这*会*再次发生。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T03:55:18.110

就个人而言，我偏爱使用[Piston](http://piston.rubyforge.org/)来管理供应商目录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T18:42:09.413

1.  要恢复已删除的`.svn`目录，只需运行`svn update`. 他们会回来的。

2.  我只是检查出口的宝石。我`gem unpack <gemname>`在`vendor/gems`目录中使用，`svn add`然后`commit`从那里使用。

3.  我使用活塞跟踪的任何东西`vendor/plugins`。`vendor/rails`例如，这就是我在那里获取导轨的方式：

    `% piston import http://dev.rubyonrails.org/svn/rails/tags/rel_2-0-2/ vendor/rails`

得到活塞使用`gem install piston`。

Note I'm going to have to find a different/better solution to replace piston as Rails continues to use git and may not update the subversion repository.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T11:00:43.640

我不得不反对 svn:externals 有两个原因

1.  您可能正在部署到无法访问这些 svn 服务的环境中

2.  当您要部署并且那些 svn external 已关闭时会发生什么？

我的建议是使用活塞或宝石解包并管理供应商树中的生产依赖关系。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T05:14:54.360

免责声明：我不了解 Ruby/Rails，所以我不知道冻结的 gem 是什么（尽管我假设它们是编译的二进制文件或标记化的源），但我很了解 Subversion。

.svn 目录只保存 Subversion “簿记”。里面没有什么是无法挽回的。

删除 .svn 文件根本不是问题。如果缺少 .svn 目录的目录位于 subversion 工作副本的目录树中的某个位置（您签出的目录），只需删除这些目录，执行 svn 更新，它们就会被重新创建。

如果整棵树缺少 .svn 文件，请删除整棵树并再次执行 svn 签出。

svn:externals 就像一个“符号链接”。你有项目 A 和项目 B，它使用项目 A。你所做的是添加一个引用项目 A 的库目录的 svn:external 属性，所以每当你签出项目 B 时，它会自动从项目 A 中放置库目录在里面。例如，我经常有一个名为“thirdparty”的目录，其中包含来自其他地方的库的外部文件，包括 evn:external 对 subversion 中其他项目的引用。

解决此类版本问题的一个技巧是为库（或冻结的 gem）设置单独的发布目录，并在需要它们的项目中使用 svn:external 对适当发布目录的引用。随着新版本的发布，只需将 svn:external 属性更改为指向新的发布目录和 svn 更新。

# mysql - 无法连接到“localhost”上的 MySQL 服务器 (10061)

> ID：119008
> 
> 赞同：69
> 
> 时间：2008-09-23T03:52:34.090
> 
> 标签：mysql, localhost, mysql5, windows-firewall

我最近在 Windows 2003 上安装了 MySQL 5 并尝试配置一个实例。一切正常，直到我进入“应用安全设置”，此时它给了我上述错误（`Can't connect to MySQL server on 'localhost' (10061)`）。

我的防火墙中有一个用于“MySQL 服务器”的端口 3306 异常。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2011-10-11T04:18:40.903

在 Windows 上出现此错误是因为我的 mysqld.exe 没有运行。

Ran **"C:\Program Files\MySQL\MySQL Server 5.5\bin\mysqld" --install**从命令行将其添加到我的服务中，运行 services.msc (start -> run)，找到 MySQL 服务并启动它.

从那以后就不必担心了。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-03-12T12:55:44.733

要解决此问题：

1.  去任务管理器
2.  选择服务选项卡
3.  找到 MySql 服务
4.  跑步

就这样。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-09-23T03:58:44.747

您可能必须将表上的“localhost”权限授予用户。请参阅`'GRANT'`语法文档。这是一个示例（来自一些 C 源代码）。

> "将 %s 上的所有特权授予 '%s'@'localhost' 由 '%s' 识别";

这是 MySQL 最常见的访问问题。

除此之外，您可以检查您为创建实例而定义的用户是否具有完全权限，否则该用户无法授予权限。

另外，请确保 mysql 服务已启动。

确保您没有打开第三方防火墙或 Internet 安全服务。

除此之外，MySQL 论坛还有几个页面专门讨论这个问题： [http ://forums.mysql.com/read.php?11,9293,9609#msg-9609](http://forums.mysql.com/read.php?11,9293,9609#msg-9609)

试着读一下。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-01T01:13:25.030

我在通过标准端口 3306 上的 localhost 连接进行连接时访问 MySQL 时遇到了困难，当我为之前在 MySQL 和 Java 中学习的课程安装和配置它时，它运行良好。我收到诸如“错误 2003”和“无法连接到本地主机上的 MySql 服务器（10061）”之类的错误。我尝试从 MySQL Workbench (5.2.35 CE) 和 Netbeans (7.2) 进行连接。我正在使用 Windows 7 64 位专业版。

我尝试在开始菜单搜索框中输入 services.msc，这会打开服务对话框以显示 Windows 中安装的所有服务。我向下滚动到 MySQL 并启动了这项服务。随后尝试从 MySQL WorkBench 和命令提示符连接到 MySQL 成功。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-07-06T08:19:35.217

**英语：**

*   按`Windows`+`R`
*   写“services.msc”。然后按 Enter
*   搜索 MySQL57 并右键单击
*   点击启动服务

**法语：**

*   Appuyez sur la touche `Windows`+`R`
*   Écrire "services.msc" Puis appuyez sur Entrée
*   Recherchez MySQL57 et clic droit
*   Cliquez sur rédémarrer

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-10-02T12:57:14.160

1.  确保您的 Windows 主机文件（位于`c://windows/system32/drivers/etc.host`）具有以下行。如果没有，请在最后添加

    ```
    127.0.0.1 localhost
    ::1 localhost 
    ```

2.  有时mysql无法触发windows强制启动主机服务，如果防火墙阻止的话，请手动启动

`win`+ `run`>>services.msc，选择“MySQL_xx”，其中“xx”是您在设置期间分配给 MySQL 主机服务的名称。单击“开始”以从左侧出现的超链接开始。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-11-20T03:34:47.020

按`**Windows key + R**` 写“services.msc”输入搜索**“MYSQL56”** 写点击它并启动服务

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-07-06T21:17:47.193

试了苦芝茶娘客栈的方案，发现需要稍作改动。

MYSQL57 是一个网络服务。我曾多次尝试过，但没有成功。当我打开 services.msc 时，我为 localhost 找到了另一个服务：MySQL。我使用下面的过程开始了那个，它奏效了。

运行 > services.msc > 右键单击​​ MySQL > 属性 > 开始

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-07-01T15:02:03.373

当我的驱动器空间不足时出现此错误。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-08-24T06:12:05.383

转到**运行**类型`services.msc.`检查 MySQL 服务是否正在运行。如果没有，请手动启动它。启动后，键入`MySQL Show`以测试服务。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-08-16T19:46:48.987

要在本地连接到`MySql`，您不必使用入站规则设置防火墙。但是，即使您已经设置`iptables`允许`TCP`入站端口 3306 并授予用户访问本地数据库的权限，您可能必须在`my.cnf`文件中设置绑定地址，在那里编辑默认地址并放置服务器 IP 地址正在运行`MySql`服务。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-01-28T08:34:15.927

由于我一直在努力并在这里找到了一个略有不同的答案，所以它是：

我最近在我的新工作场所切换了本地（内部网）服务器。安装了LAMP；Debian、Apache、MySql、PHP。工作中的用户使用主机名连接服务器，我们称之为“intaserv”。我设置了一切，让它工作，但无论我做什么都无法远程连接我的 MySql。

不过，经过无数次尝试，我找到了答案。**你只能有一个绑定地址**，它不能是主机名，在我的例子中是“intranet”。

它必须是一个IP地址，例如。“绑定地址=192.168.0.50”。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-03-09T14:22:47.360

```
run > services.msc > rightclick MySQL57 > properties >set start type option to automatic 
```

重新启动计算机后

在 cmd

```
cd: C:\

C :\> cd "C:\Program Files\MySQL\MySQL Server 5.7\bin" 
```

它会变成

```
C:\Program Files\MySQL\MySQL Server 5.7\bin> 
```

类型`mysql -u root -p`

IE`C:\Program Files\MySQL\MySQL Server 5.7\bin> mysql -u root -p`

输入密码：`****`

就这样

这将导致

```
mysql> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-23T04:49:25.997

另一种可能：

MySQL 客户端可以通过两种方式连接到服务器：通过 TCP/IP 或使用套接字。您可能将 MySQL 服务器配置为支持套接字连接，但不支持网络连接。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-04-17T08:13:14.113

无事可做，只需“重置为默认值”您的防火墙设置就会开始工作。

我阅读了许多解决方案，但都没有正常工作，所以最后我重置了有效的防火墙设置。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-12-15T03:42:56.133

终于解决了这个..尝试在xammp中运行mysql。xammp 中mysql 的复选框应该没有被点击。然后启动它。之后，您现在可以打开 mysql，它现在将连接到 localhost

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-08-06T13:53:26.200

编辑您的“my-default.ini”文件（默认情况下它带有注释属性），如下所示。

```
basedir=D:/D_Drive/mysql-5.6.20-win32
datadir=D:/D_Drive/mysql-5.6.20-win32/data
port=8888 
```

有一篇很好的文章说明了创建用户、浏览表等的命令。

[http://www.ntu.edu.sg/home/ehchua/programming/sql/MySQL_HowTo.html#zz-3.1](http://www.ntu.edu.sg/home/ehchua/programming/sql/MySQL_HowTo.html#zz-3.1)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-02-12T21:54:53.457

我没有安装 Mysql 服务器，那个包丢失了，我从这个链接[https://dev.mysql.com/downloads/installer/得到它](https://dev.mysql.com/downloads/installer/)

* * *

## 回答 #19

> 赞同：-3
> 
> 时间：2016-08-11T07:28:17.547

1.  右键单击我的电脑
2.  点击管理
3.  转到服务和应用程序
4.  选择服务并找到 MySQL 服务
5.  右键单击 MySQL 并选择开始

# erlang - Erlang 服务的目录布局？

> ID：119009
> 
> 赞同：13
> 
> 时间：2008-09-23T03:52:37.927
> 
> 标签：erlang

在我们的 Java 应用程序中，我们通常使用 maven 约定（docs、src/java、test 等）。对于 Perl，我们遵循类似的约定，只使用易于添加到 Perl 的 @INC 的顶级“lib”。

我即将着手创建一个用 Erlang 编写的服务，对于 Erlang 应用程序来说，什么是好的源代码布局？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-23T06:46:34.500

Erlang 推荐的标准目录结构可以在[这里找到](http://erlang.org/doc/design_principles/applications.html#id80846)。

此外，根据您的项目，您可能还需要一些目录，常见的有（感谢 Vance Shipley）：

```
    lib：操作系统驱动程序库
    bin：操作系统可执行文件
    c_src：C 语言源文件（例如驱动程序）
    java_src：Java语言源文件
    示例：示例代码
    mibs：SNMP MIB

```

其他项目，如[Mochiweb](http://bob.pythonmac.org/archives/2007/12/17/using-the-mochiweb-project-skeleton/)有自己的结构，Mochiweb 甚至有一个脚本来为你创建它。其他项目如[Erlware](http://www.erlware.org)覆盖在标准结构上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-30T22:54:04.450

另一个关键目录是 priv 目录。在这里，您可以存储可以从您的应用程序中轻松找到的文件。

```
code:priv_dir(Name) -> string() | {error, bad_name} 
```

其中 Name 是您的应用程序的名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-07T01:41:20.800

Erlware 正在改变这一点——几天后，Erlware 的结构将与 Erlang OTP 完全相同。实际上，应用程序包的结构已经完全是 OTP 的结构，并且如上所述。将改变的是 Erlware 安装的目录结构将完全适合现有的 Erlang/OTP 安装（当然不需要安装 Erlware）Erlware 现在可以很容易地用于将软件包添加到现有的安装中。

干杯，马丁

# java - 我如何一般检测数据库是否为 Java 的“空”

> ID：119011
> 
> 赞同：1
> 
> 时间：2008-09-23T03:53:27.083
> 
> 标签：java, sql-server, database, oracle, derby

任何人都可以提出一种从 Java 中检测数据库是否为空的好方法（至少需要支持 Microsoft SQL Server、Derby 和 Oracle）？

空我的意思是在状态下，如果数据库是使用新的 create database 语句新创建的，尽管如果涵盖 99% 的情况，检查不需要是 100% 完美的。

我的第一个想法是做这样的事情......

```
tables = metadata.getTables(null, null, null, null);
Boolean isEmpty = !tables.next();
return isEmpty; 
```

...但不幸的是，这给了我一堆底层系统表（至少在 Microsoft SQL Server 中）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T04:08:04.210

有一些跨数据库 SQL-92 模式查询标准 - 当然，这方面的里程因供应商而异

```
SELECT COUNT(*) FROM [INFORMATION_SCHEMA].[TABLES] WHERE [TABLE_TYPE] = <tabletype> 
```

对这些的支持因供应商而异，表视图的列内容也是如此。信息模式文档的 SQL 实现在这里找到：

> [http://msdn.microsoft.com/en-us/library/aa933204(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa933204(SQL.80).aspx)

更具体地说，在 SQL Server 中，sysobjects 元数据早于 SQL92 标准倡议。

```
SELECT COUNT(*) FROM [sysobjects] WHERE [type] = 'U' 
```

上面的查询返回数据库中用户表的计数。此处有关 sysobjects 表的更多信息：

> [http://msdn.microsoft.com/en-us/library/aa260447(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa260447(SQL.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T04:12:04.963

我不知道这是否是一个完整的解决方案...但是您可以通过读取 getTables 返回的 ResultSet 的 table_type 列来确定表是否为系统表：

```
int nonSystemTableCount = 0;
tables = metadata.getTables(null, null, null, null);
while( tables.next () ) {
    if( !"SYSTEM TABLE".equals( tables.getString( "table_type" ) ) ) {
        nonSystemTableCount++;
    }
}
boolean isEmpty = nonSystemTableCount == 0;
return isEmpty; 
```

在实践中......我认为您可能需要非常努力地获得一个真正可靠、真正通用的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T04:01:41.417

您是否总是检查以相同方式创建的数据库？如果是这样，您也许可以简单地从您熟悉的表子集中选择来查找数据。

您可能还需要关注可能添加到查找表中的静态数据，这些数据粗略一瞥看起来像“数据”，但实际上可能不是真正意义上的“数据”。

您能否提供有关您要解决的具体问题的更多信息？我想知道是否可以通过更多数据提供更简单、更可靠的答案。

您正在创建这些数据库吗？
您是否每次都使用大致相同的构造函数创建它们？什么样的过程让这些家伙徘徊，那个构造函数可以破坏吗？

肯定有一个元数据过程来循环遍历表，只是通过可能存在更多自定义的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T05:24:28.783

至少在 Oracle 中，您可以从 USER_TABLES 中选择以排除任何系统表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-18T14:12:00.027

**我找不到标准的通用解决方案，因此每个数据库都需要自己的测试集。**

例如，对于 Oracle，我曾经检查表、序列和索引：

```
select count(*) from user_tables
select count(*) from user_sequences
select count(*) from user_indexes 
```

对于 SqlServer，我曾经检查表、视图和存储过程：

```
SELECT * FROM sys.all_objects where type_desc in ('USER_TABLE', 'SQL_STORED_PROCEDURE', 'VIEW') 
```

**我得到的最好的通用（和直观）解决方案是使用 ANT SQL 任务——我需要做的就是为每种类型的数据库传递不同的参数。**

即 ANT 构建文件如下所示：

```
<project name="run_sql_query" basedir="." default="main">
    <!-- run_sql_query: --> 
    <target name="run_sql_query">
        <echo message="=== running sql query from file ${database.src.file}; check the result in ${database.out.file} ==="/>
        <sql classpath="${jdbc.jar.file}" 
            driver="${database.driver.class}" 
            url="${database.url}" 
            userid="${database.user}" 
            password="${database.password}" 
            src="${database.src.file}"
            output="${database.out.file}"
            print="yes"/>
    </target>

    <!-- Main: --> 
    <target name="main" depends="run_sql_query"/>   
</project> 
```

更多详情请参考ANT：

[https://ant.apache.org/manual/Tasks/sql.html](https://ant.apache.org/manual/Tasks/sql.html)

# legacy - 你什么时候说代码是遗留代码？

> ID：119017
> 
> 赞同：5
> 
> 时间：2008-09-23T03:55:31.040
> 
> 标签：legacy

任何有用的指标都可以

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-23T03:57:33.517

我在代码中寻找的一件事是单元测试。这将给予重构它的自由。因此，如果代码没有测试，我认为它是遗留代码。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-23T04:00:36.647

如果代码：

1.  已被实现相同或功能或更好的更新代码取代
2.  当前系统未使用
3.  很快就会被其他东西完全取代
4.  由于历史原因已存档
5.  当供应商停止支持它时

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-23T04:17:49.397

我们使用术语“遗留”来指代任何仍在使用的代码，使用我们停止积极开发的技术开发。

我们宁愿使用更新的工具重写代码，也不愿在当前状态下修改代码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-23T03:57:36.933

Micheal Feathers，优秀的“有效地使用遗留代码”的作者，将其定义为任何没有测试的代码。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-23T04:05:17.617

一个更好的问题可能是将一段代码标记为非遗留代码。

对我来说，遗产意味着不可改变。因此，一旦您不再“能够”更改它，它就是遗产。

这种能力是否因固定要求、对损坏、知识丢失或其他影响的恐惧而被取消，在很大程度上是无关紧要的。

一个相关的说明是，我认为我永远不会使用确切的词“遗产”，因为它会激起太多的情绪而没有用处。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-23T04:02:47.747

我不相信有一个明确的答案，但我确实相信代码是遗留代码的可能性会随着不想接触它的人数的增加以及更改它会导致它崩溃的可能性而增加。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T03:57:36.137

术语“遗留代码”是主观的，可能是一个加载的术语。但总的来说，我认为遗留代码是不可单元测试的，因此难以重构。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-23T04:03:57.870

*   当代码足够老时，您永远不会遇到最初编写代码的开发人员。
*   当不再支持 3rd 方库时。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-23T05:19:57.860

在我看来，所有编写的代码都是遗留代码。最初的意图和所有关于代码的决定可能需要一些时间才能被遗忘，但迟早你无法想象他们在编写代码时的想法。您永远不会自己编写遗留代码，对吧？

使用单元测试或像开发人员离开大楼后的秒数这样的度量并不能真正衡量代码是否是遗留代码。遗留代码可能有一组很好的单元测试和注释，并且可能已经过严格的代码审查和其他分析。这并不意味着代码仍然与手头的程序相关。它只是表明代码可能写得相当好。如果它不再相关，代码实际上会使解决程序开发的问题变得更加困难。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-23T18:03:39.710

遗留代码在许多地方被定义为“没有测试的代码”。我不认为它们在测试类型中是特定的，但总的来说，如果你不能在不担心发生未知事情的情况下对代码进行更改，那么它很快就会转移。

请参阅“[有效使用遗留代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)”

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-23T03:59:05.777

我可能错了，但我认为没有一个既定的衡量标准。

通常一段代码被认为是遗留的，当它经历了至少 5-6 个发布周期（也许更多）。通常情况下，原始实现者不再存在，并且代码一直在维护。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-23T04:03:42.927

开发人员离开场地后几乎几秒钟。:)

如果...

银行里没有钱购买新功能

您找不到任何承认从事需要修复的项目的人

你拥有的项目的源代码已经消失了

...然后您正在处理遗留代码。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-23T08:41:27.483

通常，当代码是遗留代码时，它会以不同的方式进行更改。人们**害怕**改变它，但改变往往是**快速而肮脏**的，因为没有人了解全部后果。可能会出现代码重复问题，因为人们不想承担与更深层次的更改相关的风险。

因此，在这种情况下，情况**可能会**以越来越快的速度恶化。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-23T06:16:43.947

通常，当周围没有人熟悉或愿意维护代码时，人们将某些东西称为遗留代码。

单元测试使不熟悉代码的人更容易深入研究它，因此理论上它有助于防止代码成为“遗留”。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-09-23T04:00:12.590

我不知道有什么真正的指标可以用来确定某些东西是否是“遗留代码”，但是任何比刚刚编写的更早的东西都可以被认为是遗留的。遗留代码对不同的人/组织意味着不同的东西，所以它确实有点主观。

# web-services - 如何防止将 SoapExtensions 添加到我的 Web 服务应用程序中？

> ID：119018
> 
> 赞同：1
> 
> 时间：2008-09-23T03:55:58.387
> 
> 标签：web-services, soap

似乎任何人都可以窥探传入/传出的 .NET Web 服务 SOAP 消息，只需将一个简单的 SoapExtension 放入 bin 文件夹，然后使用以下命令进行检查：

```
<soapExtensionTypes>
  <add type="MyLoggingSoapExtension, SoapLoggingTools" priority="0" group="High" />
<soapExtensionTypes> 
```

有没有办法阻止 SOAP 扩展加载或在我的应用程序中被询问（通过事件或某种此类机制）是否可以加载？

@Hurst：感谢您的回答。我了解消息级加密/WS-Security，并希望不必走那条路。我们有使用该服务的经典 ASP 客户端，这打开了一个痛苦的小世界。网站上有运行 Web 服务的 SSL 证书，但我有点希望我能阻止客户端修补肥皂扩展，因为他们有一些有能力“玩”的开发人员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T04:57:43.543

我不确定您所说的扩展和 bin 文件夹是什么意思（我猜您使用的是 .NET），所以我无法回答它们正在加载等问题。

但是，请注意，SOAP 旨在允许中介读取标头，甚至可以修改它们。（搜索“SOAP Active Intermediaries”）。**据此判断，我认为技术没有理由通过阻止代码读取 SOAP 来避免窥探**。

保护自己的正确方法是使用“***消息级安全性***”。（这与不保护中介的*传输级安全性相反，例如 SSL）。***换句话说，在发送之前加密您自己的消息。**

用于实现消息级安全机制的一种可用标准是**WS-Security**协议。这使您可以将加密定位到有效负载和相关标头，而不管传输如何。它更复杂，但这就是您限制访问的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T05:05:52.870

完全同意@Hurst - 如果您想阻止其他人阅读您的消息，您需要使用消息级加密。否则，即使是简单的 NetMon 也可以破解有线流量。

当然，如果有人可以访问机器（给定对 /bin 等的访问权限），即使是密码学也可能不足以阻止窥探者使用调试器，例如在解密后读取内存中的消息表示。

物理访问机器 - 所有赌注都没有。

# linux - 如何为 Linux 设置我的应用程序的桌面图标：KDE、Gnome 等？

> ID：119031
> 
> 赞同：12
> 
> 时间：2008-09-23T03:58:22.547
> 
> 标签：linux, icons, gnome, kde

我有一个在 Windows、Linux 和 Macintosh 上运行的跨平台程序。我的 Windows 版本有一个图标，但我不知道如何为我的 Linux 版本制作一个图标。是否有 KDE、Gnome 等的标准格式，或者我必须为每个格式做一些特别的事情？

我的应用程序是 c++ 并作为源代码分发，因此最终用户将使用 gcc 编译它。

如果我可以将图标直接嵌入到我的 exe 二进制文件中，那将是最好的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-23T04:06:59.267

对于 Gnome 和 Kde，您可能希望在您的应用程序中包含一个桌面文件，该文件定义它将如何启动。规范可以在[这里](http://standards.freedesktop.org/desktop-entry-spec/latest/index.html)找到。如果您的应用程序中包含安装程序，您可能希望它生成此桌面文件并将其放在正确的位置以进行菜单条目等

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-18T16:32:19.810

如果您使用的是预烘焙的 F/OSS 构建系统之一，例如 KDE 的 CMake 支持，那么一旦您拥有 .desktop 文件，这真的相当容易：

安装（文件 myapp.desktop DESTINATION ${XDG_APPS_INSTALL_DIR}）kde4_add_app_icon（myapp_SRCS“${CMAKE_CURRENT_SOURCE_DIR}/hi*-app-myappname.png”）

如果您自己滚动，请考虑使用[xdg-utils](http://portland.freedesktop.org/wiki/)，其中包括方便的小脚本，例如 xdg-desktop-menu （安装桌面菜单项）和 xdg-desktop-icon （将图标安装到桌面）。

.desktop 标准已在第一条评论中指出，但您也可以只获取系统上已安装的标准并从那里进行修改。至于图标，通常支持 PNG 和 SVG，尽管 PNG 仍然倾向于提供最好的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-25T14:19:04.427

KDE 社区及其 KDE 4 系列开始使用 CMake 作为构建系统。他们开发了一个 CMake 宏，该宏知道如何为您的应用程序设置一个与平台无关的图标（windows（嵌入在 exe 中）、mac（.app 包）、linux（.desktop 文件）等）

也许你可以使用它。

# sharepoint - 我可以使 SharePoint 图像 Web 部件可单击以链接到另一个页面吗

> ID：119060
> 
> 赞同：4
> 
> 时间：2008-09-23T04:05:33.297
> 
> 标签：sharepoint, web-parts

图像 Web 部件似乎没有我可以设置的 href 属性。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T04:24:47.337

它必须是图像 Web 部件吗？如果不是，我会简单地使用[内容编辑器 Web 部件](http://office.microsoft.com/en-us/sharepointserver/HA100240461033.aspx)并将所需的 HTML 粘贴到那里。

```
<a href="http://www.google.com"><img src="urlToImage" /></a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-03T11:19:38.557

如果必须怎么办？用户需要有机会自己更改链接和图像，并且不要打扰管理员。

# c++ - 在 C++ 代码中应该使用哪个 CI/O 库？

> ID：119098
> 
> 赞同：34
> 
> 时间：2008-09-23T04:14:47.157
> 
> 标签：c++, iostream, stdio

在新的 C++ 代码中，我倾向于使用 C++ iostream 库而不是 C stdio 库。

我注意到一些程序员似乎坚持使用 stdio，坚持认为它更便携。

真的是这样吗？用什么比较好？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-23T04:52:19.813

回答最初的问题：
可以使用 stdio 完成的任何事情都可以使用 iostream 库完成。

```
Disadvantages of iostreams: verbose
Advantages    of iostreams: easy to extend for new non POD types. 
```

C++ 在 C 上的进步是类型安全。

*   iostreams 被设计为明确的类型安全。因此，对对象的赋值也显式检查了被赋值对象的类型（在编译器时）（如果需要，生成编译时错误）。从而防止运行时内存溢出或将浮点值写入 char 对象等。

*   另一方面，scanf()/printf() 和 family 依赖于程序员获取正确的格式字符串并且没有类型检查（我相信 gcc 有一个可以帮助的扩展）。结果，它是许多错误的根源（因为程序员的分析不如编译器完美[并不是说编译器比人类更完美]）。

只是为了澄清 Colin Jensen 的评论。

*   自上一个标准发布以来，iostream 库一直很稳定（我忘记了实际年份，但大约在 10 年前）。

澄清 Mikael Jansson 的评论。

*   他提到的其他使用格式样式的语言具有明确的保护措施，以防止 C stdio 库的危险副作用（在 C 但不是提到的语言中）导致运行时崩溃。

**注意**我同意 iostream 库有点冗长。但我愿意忍受冗长以确保运行时安全。[但是我们可以通过使用Boost Format Library](http://www.boost.org/doc/libs/1_36_0/libs/format/doc/format.html)来减轻冗长。

```
#include <iostream>
#include <iomanip>
#include <boost/format.hpp>

struct X
{  // this structure reverse engineered from
   // example provided by 'Mikael Jansson' in order to make this a running example

    char*       name;
    double      mean;
    int         sample_count;
};
int main()
{
    X   stats[] = {{"Plop",5.6,2}};

    // nonsense output, just to exemplify

    // stdio version
    fprintf(stderr, "at %p/%s: mean value %.3f of %4d samples\n",
            stats, stats->name, stats->mean, stats->sample_count);

    // iostream
    std::cerr << "at " << (void*)stats << "/" << stats->name
              << ": mean value " << std::fixed << std::setprecision(3) << stats->mean
              << " of " << std::setw(4) << std::setfill(' ') << stats->sample_count
              << " samples\n";

    // iostream with boost::format
    std::cerr << boost::format("at %p/%s: mean value %.3f of %4d samples\n")
                % stats % stats->name % stats->mean % stats->sample_count;
} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-23T04:32:44.150

这太冗长了。

考虑执行以下操作的 iostream 构造（与 scanf 类似）：

```
// nonsense output, just to examplify
fprintf(stderr, "at %p/%s: mean value %.3f of %4d samples\n",
    stats, stats->name, stats->mean, stats->sample_count); 
```

这将需要类似的东西：

```
std::cerr << "at " << static_cast<void*>(stats) << "/" << stats->name
          << ": mean value " << std::precision(3) << stats->mean
          << " of " << std::width(4) << std::fill(' ') << stats->sample_count
          << " samples " << std::endl; 
```

字符串格式化是一种可以而且应该回避面向对象的情况，转而支持嵌入在字符串中的格式化 DSL。考虑 Lisp 的`format`、Python 的 printf 样式格式，或 PHP、Bash、Perl、Ruby 和它们的字符串内插。

`iostream`因为那个用例充其量是被误导的。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-23T06:15:07.273

[Boost 格式库](http://www.boost.org/doc/libs/1_36_0/libs/format/doc/format.html "Boost 格式库")为 printf 样式的字符串格式提供了一个类型安全、面向对象的替代方案，并且是对 iostreams 的补充，它不会因巧妙地使用 operator% 而遭受通常的冗长问题。如果您不喜欢使用 iostream 的 operator<< 进行格式化，我建议您考虑使用普通 C printf。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-23T04:25:14.730

回到糟糕的过去，C++ 标准委员会一直在讨论这种语言，而 iostreams 是一个不断变化的目标。如果您使用 iostreams，那么您就有机会每年左右重写部分代码。正因为如此，我一直使用自 1989 年以来没有显着变化的 stdio。

如果我今天做事，我会使用 iostreams。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-23T04:23:51.677

如果像我一样，您在学习 C++ 之前学习了 C，那么 stdio 库似乎更易于使用。iostream 与 stdio 各有利弊，但在使用 iostream 时我确实想念 printf()。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-30T20:40:32.413

原则上我会使用 iostreams，实际上我做了太多格式化的小数等，这使得 iostreams 太不可读，所以我使用 stdio。Boost::format 是一种改进，但对我来说不够激励。实际上，stdio 几乎是类型安全的，因为大多数现代编译器都会进行参数检查。

这是一个我仍然对任何解决方案都不完全满意的领域。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-23T04:56:40.067

对于二进制 IO，我倾向于使用 stdio 的 fread 和 fwrite。对于格式化的东西，我通常会使用 IO Stream 虽然正如 Mikael 所说，非平凡（非默认？）格式可以是 PITA。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-11-24T11:12:43.953

我将比较 C++ 标准库中的两个主流库。

## 您不应该在 C++ 中使用基于 C 样式格式字符串的字符串处理例程。

有几个原因可以限制它们的使用：

*   不是类型安全的
*   您不能将非 POD 类型传递给可变参数列表（即，既不能传递给 scanf+co.，也不能传递给 printf+co.），或者进入未定义行为的黑暗堡垒
*   容易出错：
    *   您必须设法使格式字符串和“值参数列表”保持同步
    *   *您必须正确*保持同步

 *## 在偏远地区引入的细微错误

不仅 printf 本身不好。软件变旧并被重构和修改，并且可能从偏远的地方引入错误。假设你有

.

```
// foo.h
...
float foo;
... 
```

在某处......

```
// bar/frob/42/icetea.cpp
...
scanf ("%f", &foo);
... 
```

三年后，您发现 foo 应该是某种自定义类型...

```
// foo.h
...
FixedPoint foo;
... 
```

但在某个地方......

```
// bar/frob/42/icetea.cpp
...
scanf ("%f", &foo);
... 
```

...那么你的旧 printf/scanf 仍然可以编译，除了你现在得到随机的段错误并且你不记得为什么。

## iostream 的详细程度

如果您认为 printf() 不那么冗长，那么您有一定的可能性不会使用他们的 iostream 的全部力量。例子：

```
 printf ("My Matrix: %f %f %f %f\n"
          "           %f %f %f %f\n"
          "           %f %f %f %f\n"
          "           %f %f %f %f\n",
          mat(0,0), mat(0,1), mat(0,2), mat(0,3), 
          mat(1,0), mat(1,1), mat(1,2), mat(1,3), 
          mat(2,0), mat(2,1), mat(2,2), mat(2,3), 
          mat(3,0), mat(3,1), mat(3,2), mat(3,3)); 
```

将其与正确使用 iostreams 进行比较：

```
cout << mat << '\n'; 
```

您必须为 operator<< 定义一个适当的重载，它大致具有 printf-thingy 的结构，但显着的区别是您现在有了可重用和类型安全的东西；当然，您也可以为类似 printf 的内容制作一些可重复使用的东西，但随后您又拥有 printf（如果您用新的替换矩阵成员`FixedPoint`怎么办？），除了其他不重要的事情，例如您必须传递 FILE* 句柄.

## 对于 I18N，C 样式的格式字符串并不比 iostreams 更好

请注意，格式字符串通常被认为是国际化的救援，但在这方面它们并不比 iostream 更好：

```
printf ("Guten Morgen, Sie sind %f Meter groß und haben %d Kinder", 
        someFloat, someInt);

printf ("Good morning, you have %d children and your height is %f meters",
        someFloat, someInt); // Note: Position changed.

// ^^ not the best example, but different languages have generally different
//    order of "variables" 
```

即，旧式 C 格式字符串与 iostreams 一样缺少位置信息。

您可能需要考虑[boost::format](http://www.boost.org/doc/libs/1_46_1/libs/format/doc/format.html)，它支持在格式字符串中明确说明位置。从他们的示例部分：

```
cout << format("%1% %2% %3% %2% %1% \n") % "11" % "22" % "333"; // 'simple' style. 
```

一些 printf 实现提供了位置参数，但它们是非标准的。

## 我**不**应该使用 C 风格的格式字符串吗？

除了性能（正如 Jan Hudec 指出的那样），我看不出有什么原因。但请记住：

> “我们应该忘记小的效率，比如大约 97% 的时间：过早优化是万恶之源。然而，我们不应该放弃那关键的 3% 的机会。一个好的程序员不会因为这样的推理而自满，他会明智地仔细查看关键代码；但只有在识别出该代码之后” - Knuth

和

> “瓶颈出现在令人惊讶的地方，所以在你证明瓶颈在哪里之前，不要试图猜测并进行速度破解。” - 派克

是的，printf 实现通常比 iostream 快，通常比 boost::format 快（来自我写的一个小而具体的基准测试，但它应该在很大程度上取决于具体情况：如果 printf=100%，那么 iostream=160% , 和 boost::format=220%)

但不要盲目地忽略思考：你*真正*花多少时间在文本处理上？您的程序在退出之前运行了多长时间？回退到 C 风格的格式字符串、松散的类型安全性、降低可重构性、增加可能隐藏多年并且可能只会在您最喜欢的客户面前显露出来的非常微妙的错误的可能性是否完全相关？

就个人而言，如果我不能获得超过 20% 的加速，我不会退缩。但是因为我的应用程序几乎把所有时间都花在了字符串处理之外的其他任务上，所以我从来不需要这样做。我编写的一些解析器几乎将所有时间都花在了字符串处理上，但它们的总运行时间太小了，不值得进行测试和验证工作。

## 一些谜语

最后，我想预设一些谜语：

查找所有错误，因为编译器不会（他只能建议他是否很好）：

```
shared_ptr<float> f(new float);
fscanf (stdout, "%u %s %f", f) 
```

如果没有别的，这个有什么问题？

```
const char *output = "in total, the thing is 50%"
                     "feature  complete";
printf (output); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-11-23T07:26:18.543

虽然 C++ iostreams API 有很多好处，但一个重要的问题是 i18n。问题是参数替换的顺序可能因文化而异。经典的例子是这样的：

```
// i18n UNSAFE 
std::cout << "Dear " << name.given << ' ' << name.family << std::endl; 
```

虽然这适用于英语，但在中文中，姓氏是第一位的。

在为国外市场翻译代码时，翻译代码片段充满了危险，因此新的 l10ns 可能需要更改代码而不仅仅是不同的字符串。

boost::format 似乎结合了 stdio（一个可以以不同顺序使用参数然后它们出现的顺序的单个格式字符串）和 iostreams（类型安全、可扩展性）的优点。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-23T06:22:14.997

我使用 iostreams，主要是因为这使得以后更容易摆弄流（如果我需要的话）。例如，您可能会发现您想在某个跟踪窗口中显示输出——使用 cout 和 cerr 相对容易做到这一点。当然，您可以在 unix 上摆弄管道和其他东西，但这不是那么便携。

我确实喜欢类似 printf 的格式，所以我通常先格式化一个字符串，然后将它发送到缓冲区。对于 Qt，我经常使用[QString::sprintf](http://doc.trolltech.com/4.4/qstring.html#sprintf)（尽管他们建议使用[QString::arg](http://doc.trolltech.com/4.4/qstring.html#arg-10)代替）。我也看过[boost.format](http://www.boost.org/doc/libs/1_36_0/libs/format/doc/format.html)，但不能真正习惯语法（太多的 %'s）。不过，我真的应该看看。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-13T19:37:06.897

我对 iolibraries 怀念的是格式化的输入。

iostreams 没有复制 scanf() 的好方法，甚至 boost 也没有输入所需的扩展名。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-23T06:01:51.410

stdio 更适合读取二进制文件（例如将块读取到 vector<unsigned char> 并使用 .resize() 等）。[有关示例，请参见http://nuwen.net/libnuwen.html](http://nuwen.net/libnuwen.html)中 file.hh 中的 read_rest 函数。

读取二进制文件时，C++ 流可能会阻塞大量字节，从而导致错误的 eof。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-23T07:18:09.917

由于 iostreams 已经成为一种标准，因此您应该知道您的代码肯定可以与较新版本的编译器一起使用。我想现在大多数编译器都非常了解 iostreams，使用它们应该没有任何问题。

但如果你想坚持使用 *printf 函数，我认为没有问题。

# java - 你能推荐一些比 java.util.Properties 更高级的东西吗？

> ID：119099
> 
> 赞同：4
> 
> 时间：2008-09-23T04:16:42.037
> 
> 标签：java, configuration, properties

您是否知道任何类似于 java.util.Properties 的库，它们支持更高级的功能，如分组属性、存储数组等？我不是在寻找一些沉重的超级高级解决方案，只是对任何项目都轻而有用的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-23T04:19:31.467

[来自 apache 组的Commons Configuration](http://commons.apache.org/configuration/)听起来很像您正在寻找的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T04:21:27.827

我以前用过[`java.util.prefs`](http://java.sun.com/javase/6/docs/api/java/util/prefs/package-summary.html)，它似乎对我有用。你的旅费可能会改变。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T04:19:31.717

[Yaml](http://www.yaml.org/)是基本文本配置的一个简单步骤，它允许比属性文件更多的结构和数据类型（包括您提到的那些），并且对于许多语言（包括 Java: [Jyaml](http://jyaml.sourceforge.net/)）它甚至具有序列化支持，因此映射往返您的班级通常非常容易。

与一直使用 XML 相比，Yaml 的重量更轻，上手也更简单。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T04:20:18.953

我是用于配置对象和服务的[Spring 框架](http://static.springframework.org/spring/docs/2.5.x/reference/index.html)的忠实粉丝 。它使用 XML 格式并支持所有不同类型的 Java 集合和对其他对象的引用。入门并不难，但也有许多您永远不需要的强大功能。

此外，用于简单 XML 序列化的[XStream](http://xstream.codehaus.org/)非常简单易用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T04:25:48.893

我可能会考虑 JSON（JavaScript Object Notation）。它非常易读，并且用于读取和写入 JSON 格式数据的 Java 代码很容易获得。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T05:22:55.887

你可以看看来自 apache的[Commons Collections](http://commons.apache.org/collections/)

# testing - 在进行 XNA 开发时，有没有办法验证代码是否可以在 360 上运行？

> ID：119102
> 
> 赞同：5
> 
> 时间：2008-09-23T04:17:30.520
> 
> 标签：testing, xna, boo, xbox360

我正在 XNA 上开发一款休闲游戏，打算部署到 Xbox 360。我将在几周内无法访问硬件，而且我的截止日期很紧，所以我想测试一下一些东西——Boo 和一些自定义库——将在 360 上正常工作。如果他们不这样做，我需要尽快解决它们，所以测试这一点非常重要。

有了这个解释，在实际部署到 360 之前，我是否可以进入某种“模拟器”在 .NET Compact Framework for 360 上运行代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T04:24:10.287

好吧，您可以尝试为 Windows 智能手机编写一个快速应用程序，并在模拟器中运行它。显然，这不适用于 XNA 特定的代码；但是对于 Boo 或您在模拟器上使用的任何运行时库，它们*应该*在 Xbox 上运行。

对于您自己编写的 XNA 代码，只需针对 Xbox 360 目标进行编译。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T04:29:54.297

正如 TraumaPony 所说。只需将主游戏程序集加载到 Visual Studio 并尝试编译它。如果您尝试引用 360 附带的组件之外的组件，则不会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T13:39:07.503

除了确保库编译到 360 上之外，您还需要考虑项目的对象分配配置文件。由于紧凑框架使用不同的垃圾收集器，因此它对常量分配更加敏感。当它进行收集时，它需要遍历整个对象图，而不是桌面收集器如何使用代。因此，您需要确保在运行时尽可能少地**新建对象 :-)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T19:25:46.767

这里的关键是要了解只有 .Net 代码才能在 Xbox 360 上运行，因此您要使用的任何自定义库都*必须*是 .Net 程序集。要了解的第二件事是 Xbox 正在运行紧凑的框架，因此任何未包含在其中的东西都将不起作用。这很容易通过像上面的帖子那样为 360 编译项目来测试。

老实说，我快速浏览了一下 Boo，并不能确定它是内置的，所以我不确定它是否可以工作。我也不明白在 XNA 中使用 Boo 的意义，但这不是你真正要问的。

# ruby - 如何在 Ruby 中生成一个包含 n 个唯一随机数的列表？

> ID：119107
> 
> 赞同：36
> 
> 时间：2008-09-23T04:19:16.367
> 
> 标签：ruby, random

这是我到目前为止所拥有的：

```
myArray.map!{ rand(max) } 
```

然而，显然，有时列表中的数字并不是唯一的。如何确保我的列表只包含唯一编号，而不必创建一个更大的列表，然后从中选择 n 个唯一编号？

**编辑：**
我真的很想看到这个没有循环完成 - 如果可能的话。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-09-23T05:10:08.303

```
(0..50).to_a.sort{ rand() - 0.5 }[0..x] 
```

`(0..50).to_a`可以替换为任何数组。0 是“最小值”，50 是“最大值” x 是“我想要多少个值”

当然，不可能允许 x 大于 max-min :)

扩展它的工作原理

```
(0..5).to_a  ==> [0,1,2,3,4,5]
[0,1,2,3,4,5].sort{ -1 }  ==>  [0, 1, 2, 4, 3, 5]  # constant
[0,1,2,3,4,5].sort{  1 }  ==>  [5, 3, 0, 4, 2, 1]  # constant
[0,1,2,3,4,5].sort{ rand() - 0.5 }   ==>  [1, 5, 0, 3, 4, 2 ]  # random
[1, 5, 0, 3, 4, 2 ][ 0..2 ]   ==>  [1, 5, 0 ] 
```

### 脚注：

值得一提的是，在 2008 年 9 月最初回答这个问题时，[`Array#shuffle`](http://www.ruby-doc.org/core-2.1.5/Array.html#method-i-shuffle)我要么不知道，要么不知道，因此近似于[`Array#sort`](http://www.ruby-doc.org/core-2.1.5/Array.html#method-i-sort)

因此，对此有大量建议的编辑。

所以：

```
.sort{ rand() - 0.5 } 
```

可以更好，更短地表达现代 ruby​​ 实现使用

```
.shuffle 
```

此外，

```
[0..x] 
```

可以更明显地写成[`Array#take`](http://www.ruby-doc.org/core-2.1.5/Array.html#method-i-take)：

```
.take(x) 
```

因此，在现代红宝石上生成随机数序列的最简单方法是：

```
(0..50).to_a.shuffle.take(x) 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-23T04:36:53.173

这使用集合：

```
require 'set'

def rand_n(n, max)
    randoms = Set.new
    loop do
        randoms << rand(max)
        return randoms.to_a if randoms.size >= n
    end
end 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-03-27T03:03:25.643

Ruby 1.9 提供了 Array#sample 方法，它返回一个元素，或者从一个数组中随机选择的元素。#sample 的结果不会两次包含相同的 Array 元素。

```
(1..999).to_a.sample 5 # => [389, 30, 326, 946, 746] 
```

与该`to_a.sort_by`方法相比，该`sample`方法似乎要快得多。在一个简单的场景中，我与`sort_by`进行了比较`sample`，得到了以下结果。

```
require 'benchmark'
range = 0...1000000
how_many = 5

Benchmark.realtime do
  range.to_a.sample(how_many)
end
=> 0.081083

Benchmark.realtime do
  (range).sort_by{rand}[0...how_many]
end
=> 2.907445 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-09-23T17:25:58.113

只是为了让您了解速度，我运行了四个版本：

1.  使用 Sets，就像 Ryan 的建议一样。
2.  使用比需要稍大的 Array，然后执行 uniq! 在末尾。
3.  像凯尔建议的那样使用哈希。
4.  创建一个所需大小的数组，然后随机排序，就像 Kent 的建议一样（但没有多余的“- 0.5”，它什么都不做）。

它们在小范围内都很快，所以我让它们各自创建一个包含 1,000,000 个数字的列表。以下是时间，以秒为单位：

1.  套数：628
2.  数组 + uniq：629
3.  哈希：645
4.  固定数组+排序：8

不，最后一个不是错字。因此，如果您关心速度，并且数字可以是从 0 到任何值的整数，那么我的确切代码是：

```
a = (0...1000000).sort_by{rand} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-11-02T15:18:49.670

是的，可以在没有循环且不跟踪选择了哪些数字的情况下执行此操作。它被称为线性反馈移位寄存器： [创建无重复的随机数序列](https://stackoverflow.com/questions/693880/create-random-number-sequence-with-no-repeats)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-05-18T04:38:51.267

```
[*1..99].sample(4) #=> [64, 99, 29, 49] 
```

根据`Array#sample`文档，

> **通过使用随机和唯一**索引选择元素

如果您需要`SecureRandom`（使用计算机噪声而不是伪随机数）：

```
require 'securerandom'

[*1..99].sample(4, random: SecureRandom) #=> [2, 75, 95, 37] 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-24T07:03:49.800

玩这个怎么样？唯一的随机数，无需使用 Set 或 Hash。

```
x = 0
(1..100).map{|iter| x += rand(100)}.shuffle 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-23T04:24:26.527

您可以使用哈希来跟踪您迄今为止使用的随机数：

```
seen = {}
max = 100
(1..10).map { |n|
  x = rand(max)
  while (seen[x]) 
    x = rand(max)
  end
  x
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-23T04:24:49.037

与其将项目添加到列表/数组中，不如将它们添加到集合中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-23T06:41:42.857

如果您有一个可能的随机数的有限列表（即 1 到 100），那么 Kent 的解决方案很好。

否则，没有循环就没有其他好方法可以做到这一点。问题是如果你得到一个重复，你必须做一个循环。我的解决方案应该是有效的，并且循环不应超过数组的大小（即，如果您想要 20 个唯一的随机数，则平均可能需要 25 次迭代。）尽管迭代次数越多，您的数字越多需要和较小的最大值。这是我上面的代码修改以显示给定输入需要多少次迭代：

```
require 'set'

def rand_n(n, max)
    randoms = Set.new
    i = 0
    loop do
        randoms << rand(max)
        break if randoms.size > n
        i += 1
    end
    puts "Took #{i} iterations for #{n} random numbers to a max of #{max}"
    return randoms.to_a
end 
```

如果你愿意，我可以写这个代码看起来更像 Array.map :)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-01-16T05:00:38.093

基于上面肯特弗雷德里克的解决方案，这就是我最终使用的：

```
def n_unique_rand(number_to_generate, rand_upper_limit)
  return (0..rand_upper_limit - 1).sort_by{rand}[0..number_to_generate - 1]
end 
```

谢谢肯特。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-09-03T08:38:12.157

这种方法没有循环

```
Array.new(size) { rand(max) }

require 'benchmark'
max = 1000000
size = 5
Benchmark.realtime do
  Array.new(size) { rand(max) }
end

=> 1.9114e-05 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-23T04:44:39.753

这是一种解决方案：

假设您希望这些随机数介于`r_min`和之间`r_max`。对于列表中的每个元素，生成一个随机数`r`，然后生成`list[i]=list[i-1]+r`。这将为您提供单调递增的随机数，保证唯一性，前提是

*   `r+list[i-1]`不会溢出
*   `r`> 0

对于第一个元素，您将使用`r_min`而不是`list[i-1]`. 完成后，您可以对列表进行洗牌，这样元素的顺序就不会那么明显了。

这种方法的唯一问题是当你过去`r_max`并且仍然有更多的元素要生成时。在这种情况下，您可以将`r_min`和重置`r_max`为您已经计算的 2 个相邻元素，然后简单地重复该过程。这有效地在没有使用数字的区间内运行相同的算法。您可以继续这样做，直到您填充了列表。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-23T12:25:28.180

最好提前知道最大值，您可以这样做：

```
class NoLoopRand
  def initialize(max)
    @deck = (0..max).to_a
  end

  def getrnd
    return @deck.delete_at(rand(@deck.length - 1))
  end
end 
```

您可以通过这种方式获取随机数据：

```
aRndNum = NoLoopRand.new(10)
puts aRndNum.getrnd 
```

`nil`当所有值都从甲板上耗尽时，您将获得。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-10-19T13:46:43.357

## 方法一

使用 Kent 的方法，可以生成一个任意长度的数组，将所有值保持在有限范围内：

```
# Generates a random array of length n.
#
# @param n     length of the desired array
# @param lower minimum number in the array
# @param upper maximum number in the array
def ary_rand(n, lower, upper)
    values_set = (lower..upper).to_a
    repetition = n/(upper-lower+1) + 1
    (values_set*repetition).sample n
end 
```

## 方法二

另一种可能**更有效**的方法是从同一个肯特的[另一个答案](https://stackoverflow.com/a/88341/471214)修改而来的：

```
def ary_rand2(n, lower, upper)
    v = (lower..upper).to_a
    (0...n).map{ v[rand(v.length)] }
end 
```

## 输出

```
puts (ary_rand 5, 0, 9).to_s # [0, 8, 2, 5, 6] expected
puts (ary_rand 5, 0, 9).to_s # [7, 8, 2, 4, 3] different result for same params
puts (ary_rand 5, 0, 1).to_s # [0, 0, 1, 0, 1] repeated values from limited range
puts (ary_rand 5, 9, 0).to_s # []              no such range :) 
```

# c++ - 在家工作的条件编译

> ID：119114
> 
> 赞同：2
> 
> 时间：2008-09-23T04:21:39.870
> 
> 标签：c++

我使用 MS Dev Studio 编写 C++ 代码，每周有两天在家工作。我使用 CVS 使我的源在两台计算机之间保持同步，但机器所处的环境之间存在差异。

任何人都可以建议一种方法，我可以根据我是否在我的 home box 上编译，有条件地修改我的代码中的常量吗？

我所追求的是一种定义符号的方式，让我们自动将其称为_ATHOME，这样我就可以这样做：

```
#ifdef _ATHOME
#  define TEST_FILES  "E:\\Test"
#  define TEST_SERVER "192.168.0.1"
#else
#  define TEST_FILE   "Z:\\Project\\Blah\\Test"
#  define TEST_SERVER "212.45.68.43"
#endif 
```

*注意：这当然是出于开发和调试目的，我永远不会发布带有这样硬编码常量的软件。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T04:32:42.217

在您的家庭和工作机器上，设置一个环境变量`LOCATION`，“1”代表家庭或“2”代表工作。

然后在预处理器选项中，添加预处理器定义/DLOCATION=$(LOCATION)。这将评估为您在环境变量中设置的“home”或“work”字符串。

然后在您的代码中：

```
#if LOCATION==1
  // home
#else
  // work
#endif 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T14:27:50.193

如果工作和家庭之间的唯一区别是测试文件所在的位置......那么（恕我直言）你不应该用一堆静态路径和 IP 污染你的构建文件。

对于您展示的示例，我将简单地映射工作和家庭的驱动器。即在工作中映射一个驱动器T：指向\\212.45.68.43\Project\Blah\Test，在家里映射一个驱动器T：指向\\192.168.0.1\Test。

然后您的构建过程使用路径“T:\”来引用测试所在的位置。

当然，如果您需要进行更剧烈的更改，设置环境变量可能是最好的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T04:24:30.597

您可以在 Visual Studio 设置中的 properties->c++->preprocessor 中设置预处理器变量，
您可以使用 $(enviromentvariable)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T04:25:23.373

我通常使用配置文件，然后只创建一个指向适当配置的符号链接。

# web-services - 服务器生成的网页截图？

> ID：119116
> 
> 赞同：7
> 
> 时间：2008-09-23T04:22:50.943
> 
> 标签：web-services

我一直在玩弄的一个问题是一项服务，它要求我的服务器在给定的 url 处生成网页的屏幕截图。问题是我不知道我将如何做到这一点。我主要使用 LAMP 软件堆栈，因此考虑到这一点给出的答案将是最有帮助的。同样，基本要求是：给定一个 url，服务器需要在该 url 处生成呈现网页的图像文件。提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T04:48:31.087

您可能还想看看[webkit](http://webkit.org/)，它以更容易嵌入而闻名（Adobe 用于 AIR，Google 用于 Chrome，Apple 用于 iPhone ......）然后是其他渲染引擎。这可能需要更多的工作来设置，但它会比一些启动网络浏览器并截取屏幕截图的黑客更稳定。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T05:02:09.290

**如果**您的服务器是**Mac**，那么我推荐[webkit2png](http://www.paulhammond.org/webkit2png/)，这是一个利用 WebKit 的 Objective-C API 呈现 URL 的简短 python 程序。就个人而言，我将它与[WWW::Mechanize](http://search.cpan.org/dist/WWW-Mechanize/)结合使用来浏览我的开发站点并制作每个页面的屏幕截图——这对于测试功能、显示客户端和保持屏幕截图是最新的很有用。生成的屏幕截图非常完美，但有时对于长的滚动页面来说非常高。

**如果**您的服务器有一个安装了 KDE 的非基本**Linux**发行版，那么您可以尝试[khtml2png](http://www.babysimon.co.uk/khtml2png/index.html)。我自己没有尝试过，但在 webkit2png 页面上看到了它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-12T11:55:13.430

[PhantomJS](http://phantomjs.org/)是一个基于 WebKit 的无头（命令行）浏览器，可以轻松[编写脚本](http://pielmeier.blogspot.fi/2011/02/headless-html-page-rendering-with.html)以保存网页截图。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T05:15:46.403

我使用[http://webthumb.bluga.net](http://webthumb.bluga.net)服务生成缩略图。强大、强大、易于使用且价格非常合理。我有一个使用此服务的高流量制作网站，它运行良好。鉴于创建强大的 Web 屏幕截图服务的难度，让其他人来完成这项艰巨的工作真是太好了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T04:29:02.537

您实际上需要让服务器启动有问题的 Web 浏览器，并使用适当的库截取应用程序的屏幕截图。Apache 不会为您呈现页面，因此您必须拥有能够呈现该页面的软件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-23T04:34:44.880

是的，这就是我们所需要的。我在 asp.net 中执行此操作，并且实际上创建了一个 WebBrowser 对象，该对象可在 .Net 框架类库中使用以生成屏幕截图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T05:30:24.793

Java 的一个非免费解决方案是[WebRenderer](http://www.webrenderer.com/)。有趣的功能：它可以在渲染时模拟 Safari、IE 或 Firefox 浏览器。他们有桌面版本和无头服务器版本。他们还有示例代码显示如何呈现网页的屏幕截图图像。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T07:59:27.840

> 虚拟帧缓冲 X 服务器

我宁愿推荐[XVFB](http://en.wikipedia.org/wiki/Xvfb)（虚拟帧缓冲 X 服务器）是获取无头服务器屏幕截图的最佳解决方案。虚拟帧缓冲 X 服务器 xvfb 提供了一个 X 服务器，它可以在没有显示硬件和物理输入设备的机器上运行。我在我的服务器上使用它来测试 URL 并截取它的屏幕截图。我们正在使用 Ubuntu & XVFB + FIREFOX。它工作正常。根据您的需要进行修改。看看这些文章。它可能对你有用。

[http://www.semicomplete.com/blog/geekery/xvfb-firefox.html](http://www.semicomplete.com/blog/geekery/xvfb-firefox.html)

[http://linux.about.com/cs/linux101/g/xvfb.htm](http://linux.about.com/cs/linux101/g/xvfb.htm)

[http://www.xfree86.org/4.0.1/Xvfb.1.html](http://www.xfree86.org/4.0.1/Xvfb.1.html)

# c# - 从 Win32 可执行文件中提取 RT_RCDATA 部分（最好在 C# 中）？

> ID：119117
> 
> 赞同：-1
> 
> 时间：2008-09-23T04:23:07.370
> 
> 标签：c#, winapi, resources, pinvoke

如何从 Win32 可执行文件（最好在 C# 中）中提取 RT_RCDATA 部分？

我目前知道如何做到这一点的唯一方法是在 Visual Studio 中打开 EXE。如果可能的话，我希望能够完全在 C# 中做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T04:54:39.853

P/Invoke LoadResource 将是您最安全的选择。

否则，您将不得不编写自己的[P/E](http://en.wikipedia.org/wiki/Portable_Executable_Format)处理器，例如。[PE 处理器示例](http://www.devsource.com/c/a/Architecture/Retrieve-Resources-PE-II/)。处理器不是世界末日，但正如您所看到的，它比 P/Invoke 涉及更多。

差点忘了，就工具而言，大多数 P/E 浏览器都会为您执行此操作。例如。P/E Explorer，可用但尚未真正开发。我也用 IDA Pro 来处理这样的事情。一个快速的 IDA 插件可以很容易地做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T04:56:57.167

我假设您正在尝试从可执行文件中读取 RCDATA 类型的资源（请注意，“可执行部分”的含义不同——它指的是 PE 文件的 .text、.data、.rdata 等部分）。如果您想从当前程序集中读取它，这里有一个教程展示了如何：[使用 GetManifestResourceStream 访问嵌入式资源](http://www.attilan.com/2006/08/accessing-embedded-resources-u.php)，使用[GetManifestResourceNames](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getmanifestresourcenames.aspx)和[GetManifestResourceStream](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getmanifestresourcestream.aspx)方法。

如果您不想从当前可执行文件中读取它，可以使用类似于[此处](http://www.dreamincode.net/code/snippet1683.htm)显示的方法。

与 PInvoke 相比，这些方法的优势在于它们是 100% .NET，您不必费心将参数编组到平台数据类型或从平台数据类型中提取，并确保验证了所有返回值。

# c++ - 为什么结构的 sizeof 不等于每个成员的 sizeof 之和？

> ID：119123
> 
> 赞同：795
> 
> 时间：2008-09-23T04:24:47.820
> 
> 标签：c++, c, struct, sizeof, c++-faq

为什么`sizeof`运算符返回的结构大小大于结构成员的总大小？

* * *

## 回答 #1

> 赞同：737
> 
> 时间：2008-09-23T04:25:34.527

这是因为添加了填充以满足对齐约束。[数据结构对齐](http://en.wikipedia.org/wiki/Data_structure_alignment)会影响程序的性能和正确性：

*   未对齐的访问可能是一个硬错误（通常`SIGBUS`）。
*   未对齐的访问可能是一个软错误。
    *   要么在硬件中进行纠正，要么适度降低性能。
    *   或通过软件中的仿真进行纠正，以导致严重的性能下降。
    *   此外，原子性和其他并发保证可能会被破坏，从而导致细微的错误。

这是一个使用 x86 处理器的典型设置的示例（全部使用 32 位和 64 位模式）：

```
struct X
{
    short s; /* 2 bytes */
             /* 2 padding bytes */
    int   i; /* 4 bytes */
    char  c; /* 1 byte */
             /* 3 padding bytes */
};

struct Y
{
    int   i; /* 4 bytes */
    char  c; /* 1 byte */
             /* 1 padding byte */
    short s; /* 2 bytes */
};

struct Z
{
    int   i; /* 4 bytes */
    short s; /* 2 bytes */
    char  c; /* 1 byte */
             /* 1 padding byte */
};

const int sizeX = sizeof(struct X); /* = 12 */
const int sizeY = sizeof(struct Y); /* = 8 */
const int sizeZ = sizeof(struct Z); /* = 8 */ 
```

可以通过按对齐方式对成员进行排序来最小化结构的大小（按大小排序对于基本类型来说就足够了）（`Z`如上例中的结构）。

重要提示：C 和 C++ 标准都声明结构对齐是实现定义的。因此，每个编译器可能会选择不同的数据对齐方式，从而导致不同且不兼容的数据布局。因此，在处理将由不同编译器使用的库时，了解编译器如何对齐数据非常重要。一些编译器具有命令行设置和/或特殊`#pragma`语句来更改结构对齐设置。

* * *

## 回答 #2

> 赞同：235
> 
> 时间：2008-09-23T04:27:32.383

打包和字节对齐，如此处 C FAQ 中[所述](http://www.c-faq.com/struct/align.html)：

> 是为了对齐。许多处理器无法访问 2 字节和 4 字节的数量（例如整数和长整数），如果它们被塞满的话。
> 
> 假设你有这样的结构：
> 
> ```
> struct {
>     char a[3];
>     short int b;
>     long int c;
>     char d[3];
> }; 
> ```
> 
> 现在，您可能认为应该可以像这样将这个结构打包到内存中：
> 
> ```
> +-------+-------+-------+-------+
> |           a           |   b   |
> +-------+-------+-------+-------+
> |   b   |           c           |
> +-------+-------+-------+-------+
> |   c   |           d           |
> +-------+-------+-------+-------+ 
> ```
> 
> 但是如果编译器像这样安排它，那么处理器会容易得多：
> 
> ```
> +-------+-------+-------+
> |           a           |
> +-------+-------+-------+
> |       b       |
> +-------+-------+-------+-------+
> |               c               |
> +-------+-------+-------+-------+
> |           d           |
> +-------+-------+-------+ 
> ```
> 
> 在打包版本中，请注意您和我至少有点难以看到 b 和 c 字段是如何环绕的？简而言之，处理器也很难。因此，大多数编译器会像这样填充结构（就像使用额外的、不可见的字段一样）：
> 
> ```
> +-------+-------+-------+-------+
> |           a           | pad1  |
> +-------+-------+-------+-------+
> |       b       |     pad2      |
> +-------+-------+-------+-------+
> |               c               |
> +-------+-------+-------+-------+
> |           d           | pad3  |
> +-------+-------+-------+-------+ 
> ```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-09-23T07:06:14.547

如果您希望结构在 GCC 中具有一定的大小，例如使用[`__attribute__((packed))`](http://digitalvampire.org/blog/index.php/2006/07/31/why-you-shouldnt-use-__attribute__packed/).

[在 Windows 上，当使用带有/Zp 选项](http://msdn.microsoft.com/en-us/library/xh3e3fd0(VS.80).aspx)的 cl.exe 编译器时，您可以将对齐设置为一个字节。

通常 CPU 更容易访问 4（或 8）的倍数的数据，这取决于平台和编译器。

所以基本上是对齐的问题。

**你需要有充分的理由来改变它。**

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-09-23T04:31:41.610

这可能是由于字节对齐和填充导致结构在您的平台上出现偶数个字节（或字）。例如在 Linux 上的 C 中，以下 3 个结构：

```
#include "stdio.h"

struct oneInt {
  int x;
};

struct twoInts {
  int x;
  int y;
};

struct someBits {
  int x:2;
  int y:6;
};

int main (int argc, char** argv) {
  printf("oneInt=%zu\n",sizeof(struct oneInt));
  printf("twoInts=%zu\n",sizeof(struct twoInts));
  printf("someBits=%zu\n",sizeof(struct someBits));
  return 0;
} 
```

成员的大小（以字节为单位）分别为 4 字节（32 位）、8 字节（2x 32 位）和 1 字节（2+6 位）。上面的程序（在使用 gcc 的 Linux 上）打印大小为 4、8 和 4 - 最后一个结构被填充，使其成为一个单词（在我的 32 位平台上为 4 x 8 位字节）。

```
oneInt=4
twoInts=8
someBits=4 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-05-31T09:27:12.250

也可以看看：

对于 Microsoft Visual C：

[http://msdn.microsoft.com/en-us/library/2e70t5y1%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/2e70t5y1%28v=vs.80%29.aspx)

和 GCC 声称与微软的编译器兼容。：

[https://gcc.gnu.org/onlinedocs/gcc-4.6.4/gcc/Structure_002dPacking-Pragmas.html](https://gcc.gnu.org/onlinedocs/gcc-4.6.4/gcc/Structure_002dPacking-Pragmas.html)

除了前面的答案，请注意，无论包装如何，**C++ 中都没有 members-order-guarantee**。编译器可以（并且肯定会）将虚拟表指针和基本结构的成员添加到结构中。甚至虚拟表的存在也没有被标准保证（没有指定虚拟机制的实现），因此可以得出结论，这种保证是不可能的。

我很确定**C*****中*****保证了成员顺序***，但是在编写跨平台或跨编译器程序时，我不会指望它。*

 ** * *

## 回答 #6

> 赞同：10
> 
> 时间：2015-06-10T15:07:08.930

由于所谓的包装，结构的大小大于其各部分的总和。一个特定的处理器有一个可以使用的首选数据大小。大多数现代处理器的首选大小，如果是 32 位（4 字节）。当数据在这种边界上时访问内存比跨越该大小边界的东西更有效。

例如。考虑简单的结构：

```
struct myStruct
{
   int a;
   char b;
   int c;
} data; 
```

如果机器是 32 位机器并且数据在 32 位边界上对齐，我们会立即看到问题（假设没有结构对齐）。在这个例子中，让我们假设结构数据从地址 1024 开始（0x400 - 注意最低 2 位为零，因此数据与 32 位边界对齐）。对 data.a 的访问可以正常工作，因为它从边界 0x400 开始。对 data.b 的访问也可以正常工作，因为它位于地址 0x404 - 另一个 32 位边界。但是未对齐的结构会将 data.c 放在地址 0x405 处。data.c 的 4 个字节分别位于 0x405、0x406、0x407、0x408。在 32 位机器上，系统会在一个内存周期内读取 data.c，但只会获得 4 个字节中的 3 个（第 4 个字节在下一个边界上）。因此，系统必须进行第二次内存访问才能获得第 4 个字节，

现在，如果编译器不将 data.c 放在地址 0x405 上，而是将结构填充 3 个字节并将 data.c 放在地址 0x408 上，那么系统只需 1 个周期即可读取数据，从而缩短了对该数据元素的访问时间50%。填充将内存效率换成处理效率。鉴于计算机可以拥有大量内存（数 GB），编译器认为交换（速度超过大小）是合理的。

不幸的是，当您尝试通过网络发送结构或什至将二进制数据写入二进制文件时，这个问题就会成为一个杀手。在结构或类的元素之间插入的填充可能会破坏发送到文件或网络的数据。为了编写可移植的代码（一个将用于多个不同编译器的代码），您可能必须分别访问结构的每个元素以确保正确的“打包”。

另一方面，不同的编译器具有不同的管理数据结构打包的能力。例如，在 Visual C/C++ 中，编译器支持 #pragma pack 命令。这将允许您调整数据打包和对齐。

例如：

```
#pragma pack 1
struct MyStruct
{
    int a;
    char b;
    int c;
    short d;
} myData;

I = sizeof(myData); 
```

我现在应该有 11 的长度。没有编译指示，我可以是 11 到 14 之间的任何值（对于某些系统，多达 32 个），这取决于编译器的默认打包。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-05-04T15:38:27.733

**C99 N1256标准草案**

[http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)

*6.5.3.4 sizeof 运算符*：

> 3 当应用于具有结构或联合类型的操作数时，结果是此类对象中的总字节数，包括内部和尾随填充。

*6.7.2.1 结构和联合说明符*：

> 13 ...结构对象内可能有未命名的填充，但不是在其开头。

和：

> 15 在结构或联合的末尾可能有未命名的填充。

新的 C99[灵活数组成员功能](https://en.wikipedia.org/wiki/Flexible_array_member)( `struct S {int is[];};`) 也可能影响填充：

> 16 作为一种特殊情况，具有多个命名成员的结构的最后一个元素可能具有不完整的数组类型；这称为灵活数组成员。在大多数情况下，灵活数组成员被忽略。特别是，结构的大小就像省略了柔性数组成员一样，只是它可能具有比省略所暗示的更多的尾随填充。

*附件 J 可移植性问题*重申：

> 以下是未指定的：...
> 
> *   在结构或联合中存储值时填充字节的值 (6.2.6.1)

**C++11 N3337 标准草案**

[http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf)

*5.3.3 大小*：

> 2 当应用于一个类时，结果是该类的对象中的字节数，包括将该类型的对象放入数组中所需的任何填充。

*9.2 班级成员*：

> 指向标准布局结构对象的指针，使用 reinterpret_cast 进行适当转换，指向其初始成员（或者如果该成员是位字段，则指向它所在的单元），反之亦然。[注意：因此，标准布局结构对象中可能存在未命名的填充，但不是在其开头，这是实现适当对齐所必需的。——尾注]

我只知道足够的 C++ 来理解注释:-)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-23T04:27:07.347

如果您已隐式或显式设置结构的对齐方式，则可以这样做。对齐 4 的结构将始终是 4 字节的倍数，即使其成员的大小不是 4 字节的倍数。

此外，可以使用 32 位整数在 x86 下编译库，如果您手动执行此操作，您可能会在 64 位进程上比较它的组件会给您带来不同的结果。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-07-28T21:25:42.483

**C 语言让编译器对内存中结构元素的位置有一些自由：**

*   内存孔可能出现在任何两个组件之间，以及最后一个组件之后。这是由于目标计算机上某些类型的对象可能会受到寻址边界的限制。
*   “内存孔”大小包含在 sizeof 运算符的结果中。sizeof 仅不包括灵活数组的大小，在 C/C++ 中可用
*   该语言的一些实现允许您通过编译指示和编译器选项控制结构的内存布局

**C语言为结构中元素布局的程序员提供了一些保证：**

*   编译器需要分配一系列组件，增加内存地址
*   第一个组件的地址与结构的起始地址一致
*   未命名的位字段可能包含在结构中，以与相邻元素的所需地址对齐

**与元素对齐有关的问题：**

*   不同的计算机以不同的方式排列物体的边缘
*   位域宽度的不同限制
*   计算机在如何将字节存储在一个字中有所不同（英特尔 80x86 和摩托罗拉 68000）

**对齐的工作原理：**

*   结构占用的体积计算为此类结构阵列的对齐单个元素的大小。结构应该结束，以便下一个结构的第一个元素不违反对齐要求

ps 更多详细信息可在此处获得：“Samuel P.Harbison，Guy L.Steele CA 参考，(5.6.2 - 5.6.7)”

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-02-24T06:46:13.627

这个想法是出于速度和缓存考虑，操作数应该从与其自然大小对齐的地址中读取。为了实现这一点，编译器填充结构成员，以便后续成员或以下结构将对齐。

```
struct pixel {
    unsigned char red;   // 0
    unsigned char green; // 1
    unsigned int alpha;  // 4 (gotta skip to an aligned offset)
    unsigned char blue;  // 8 (then skip 9 10 11)
};

// next offset: 12 
```

x86 架构始终能够获取未对齐的地址。但是，它的速度较慢，并且当未对齐与两个不同的缓存线重叠时，当对齐的访问只会驱逐一条时，它会驱逐两条缓存线。

一些架构实际上必须捕获未对齐的读取和写入，以及 ARM 架构的早期版本（演变为当今所有移动 CPU 的架构）......好吧，它们实际上只是为这些返回了错误的数据。（他们忽略了低位。）

最后，请注意缓存行可以任意大，编译器不会尝试猜测这些行或进行空间与速度的权衡。相反，对齐决策是 ABI 的一部分，表示最终将均匀填充高速缓存行的最小对齐。

*TL；DR：*对齐很重要。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-23T13:38:11.797

除了其他答案之外，结构可以（但通常没有）具有虚函数，在这种情况下，结构的大小还将包括 vtbl 的空间。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-06-29T14:15:46.970

在有关内存对齐和结构填充/打包的其他解释清楚的答案中，我通过仔细阅读在问题本身中发现了一些东西。

> “*为什么`sizeof`结构不等于`sizeof`每个成员的总和？* ”
> 
> “*为什么`sizeof`运算符返回的结构大小大于结构成员的总大小*”？

这两个问题都暗示了一些明显的错误。至少在一个通用的、非示例的焦点视图中，这里就是这种情况。

`sizeof`应用于结构对象的操作数的结果**可以**等于分别`sizeof`应用于每个成员的总和。它不必更大/不同**。**

如果没有填充的原因，则不会填充内存。

* * *

大多数实现，如果结构只包含相同类型的成员：

```
struct foo {
   int a;   
   int b;
   int c;     
} bar; 
```

假设`sizeof(int) == 4`，结构的大小`bar`将等于所有成员的大小之和，`sizeof(bar) == 12`。这里没有填充。

例如这里也是如此：

```
struct foo {
   short int a;   
   short int b;
   int c;     
} bar; 
```

假设`sizeof(short int) == 2`和`sizeof(int) == 4`。和 的分配字节的总和`a`等于`b`分配的字节`c`，最大的成员，一切都完美对齐。因此，`sizeof(bar) == 8`.

这也是关于结构填充的第二个最受欢迎的问题的对象，这里：

*   [C 结构中的内存对齐](https://stackoverflow.com/questions/5435841/memory-alignment-in-c-structs)

# vb6 - Vista不允许一个.exe调用另一个.exe

> ID：119146
> 
> 赞同：0
> 
> 时间：2008-09-23T04:32:05.027
> 
> 标签：vb6, windows-vista, executable, shellexecute

我有一个在 Vista 上运行的旧版 VB6 可执行文件。此可执行文件将另一个旧版 MFC C++ 可执行文件脱壳。

在我们早期的 Vista 测试中，此调用将显示典型的 UAC 消息，以在运行第二个可执行文件之前获得用户的许可。这并不完美，但可以接受。但是，现在看起来这个调用被操作系统完全忽略了。

我该怎么做才能使这个电话正常工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T04:35:52.303

如果在计算机上禁用了 UAC，并且调用需要提升权限，则对 CreateProcess 的调用将失败。确保已启用 UAC。

此外，请按照[此处的指南将 UAC 清单添加到您的程序](https://stackoverflow.com/questions/90702/how-does-a-program-ask-for-administrator-privileges#90718)中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T04:38:54.307

这里也有一些关于问题和源示例的很好的讨论[。](http://www.codeproject.com/KB/vista-security/UAC__The_Definitive_Guide.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T18:26:09.543

这对我们在 Vista 下很有效

```
Private Declare Function CreateProcess Lib "kernel32" Alias "CreateProcessA" (ByVal lpApplicationName As String, ByVal lpCommandLine As String, lpProcessAttributes As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDriectory As String, lpStartupInfo As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long

Private Declare Function WaitForSingleObject Lib "kernel32" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long

Private Type PROCESS_INFORMATION
      hProcess As Long
      hThread As Long
      dwProcessId As Long
      dwThreadId As Long
End Type

Private Type STARTUPINFO
      cb As Long
      lpReserved As String
      lpDesktop As String
      lpTitle As String
      dwX As Long
      dwY As Long
      dwXSize As Long
      dwYSize As Long
      dwXCountChars As Long
      dwYCountChars As Long
      dwFillAttribute As Long
      dwFlags As Long
      wShowWindow As Integer
      cbReserved2 As Integer
      lpReserved2 As Long
      hStdInput As Long
      hStdOutput As Long
      hStdError As Long
End Type

    Dim ProcessInformation As PROCESS_INFORMATION
    Dim StartupInformation As STARTUPINFO
    Dim ReturnValue As Long
    Dim NullString As String
    Dim AppPathString As String

    StartupInformation.cb = Len(StartupInformation)

    ReturnValue = CreateProcess(NullString, AppPathString, ByVal 0&, ByVal 0&, 1&, NORMAL_PRIORITY_CLASS, ByVal 0&, NullString, StartupInformation, ProcessInformation)
    '
    'If you need to wait for the exe to finish
    '
    Do While WaitForSingleObject(ProcessInformation.hProcess, 0) <> 0
        DoEvents
    Loop 
```

# sql - 使用多个线程更新同一个数据库会更快吗？

> ID：119157
> 
> 赞同：2
> 
> 时间：2008-09-23T04:36:43.237
> 
> 标签：sql, database, multithreading

我编写了一个 Java 程序来从 MS Access 中添加和检索数据。目前它在约 3 分钟内依次通过约 200K 插入查询，我认为这很慢。我计划使用处理数十万条记录的不同部分的 3-4 个线程来重写它。我有一个复合问题：

*   由于工作负载分担，这是否有助于加快程序速度，还是因为线程仍必须按顺序访问数据库而相同？

*   你认为什么策略会加快这个过程（除了使用 Java 的preparedStatement 之外我已经做过的查询优化除外）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T04:39:46.380

1.  不知道。在不了解瓶颈是什么的情况下，我无法评论它是否会使其更快。如果数据库是限制器，那么更多线程可能会减慢它的速度。

2.  我会将访问数据库转储到一个平面文件中，然后批量加载该文件。批量加载允许比运行多个插入查询快得多的优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T13:13:23.120

首先，不要使用 Access。将您的数据移动到其他任何地方——SQL/Server——MySQL——任何东西。内部访问的数据库引擎（称为 Jet）慢得可怜。它不是一个真正的数据库；它适用于涉及少量数据的个人项目。它根本没有规模。

其次，线程很少有帮助。

JDBC 到数据库的连接是进程范围的资源。所有线程共享一个连接。

“但是等等，”你说，“我将在每个线程中创建一个唯一的 Connection 对象。”

高贵，但*有时也*注定失败。为什么？JVM 和数据库之间的操作系统处理可能涉及一个套接字，它是一个单一的、进程范围的资源，由所有线程共享。

如果您有一个跨所有线程共享的操作系统级 I/O 资源，您将看不到太多改进。在这种情况下，ODBC 连接是一个瓶颈。而 MS-Access 是另一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T04:43:00.257

使用 MSAccess 作为后端数据库，如果从 MSAccess 中进行导入，您可能会获得更好的插入性能。[另一种选择（因为您使用的是 Java）是使用像Jackess](http://jackcess.sourceforge.net/)这样的库直接操作 MDB 文件（如果您从头开始创建它并且没有其他并发用户 - MS Access 不能很好地处理）。

如果这些都不是适合您的解决方案，那么我建议在您的 Java 应用程序上使用分析器，看看它是否花费大部分时间等待数据库（在这种情况下添加线程可能无济于事）或者是否它正在处理和并行化将有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T05:07:37.530

Stimms 批量加载方法可能是您最好的选择，但一切都值得尝试一次。请注意，您的瓶颈将是磁盘 IO，并且多个线程可能会减慢速度。当多个用户敲击文件时，MS 访问也可能崩溃，而这正是您的多线程方法的行为（进行备份！）。如果性能仍然是一个问题，请考虑升级到[SQL express](http://www.microsoft.com/sql/editions/express/default.mspx)。

[MS 访问 SQL Server 迁移文档。](http://www.microsoft.com/sql/solutions/migration/access/default.mspx)

祝你好运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T22:52:30.020

我同意倾销 Access 将是最好的第一步。话说回来...

在 .NET 和 SQL 环境中，我肯定看到线程有助于最大化 INSERT 吞吐量。

我有一个应用程序接受异步文件删除，然后将它们处理到数据库中的表中。

我创建了一个解析文件并将数据放入队列的加载器。队列由一个或多个线程提供服务，我可以使用参数调整其最大值。我发现即使在具有典型 7200RPM 驱动器的单核 CPU 上，理想的工作线程数也是 3。它几乎成比例地缩短了加载时间。关键是要平衡它，使 CPU 瓶颈和磁盘 I/O 瓶颈平衡。

因此，在不能选择批量复制的情况下，应考虑使用线程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T04:41:15.877

在现代多核机器上，使用多个线程来填充数据库会有所作为。这取决于数据库及其硬件。试试看。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T04:43:25.840

试试看它是否有帮助。我猜不是因为瓶颈可能在于磁盘访问和表的锁定，除非您能找到一种方法将负载分配到多个表和/或磁盘上。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T22:54:33.993

IIRC 访问不允许多个连接到同一文件，因为它使用了锁定策略。

我完全同意转储 sql 的访问权限。

# c# - 有委托处理程序的事件和没有委托处理程序的事件有什么区别？

> ID：119160
> 
> 赞同：6
> 
> 时间：2008-09-23T04:37:18.087
> 
> 标签：c#, events

这有什么区别：

```
this.btnOk.Click += new System.EventHandler(this.btnOK_Click); 
```

还有这个？

```
this.btnOk.Click += this.btnOK_Click; 
```

他们都工作。前者是您使用代码片段时 Visual Studio 的默认设置。但似乎它只是在宣传多余的措辞，还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-23T04:41:36.967

没有不同。省略委托实例化只是语法糖；C# 编译器将在后台为您生成委托实例化。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T04:41:58.917

在 C# 3.0 及更高版本中，这没有区别。在 C# 3.0 之前，由于编译器限制需要 EventHandler，但随着 C# 3.0 的出现，除非您想非常明确，否则首选第二种形式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T04:39:03.793

我相信自 3.0 以来的 C# 已隐式添加了委托处理程序。但是，它可以帮助更明确，尤其是当有多种可能的委托类型时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T04:40:10.153

“+= Delegate_Name”是一种语法糖。编译器将为您创建新的包装器。

# python - 将代码添加到 __init__.py

> ID：119167
> 
> 赞同：94
> 
> 时间：2008-09-23T04:41:18.217
> 
> 标签：python, initialization, package

我正在研究 django 中的模型系统是如何工作的，我注意到一些我不明白的东西。

我知道你创建了一个空`__init__.py`文件来指定当前目录是一个包。并且您可以设置一些变量，`__init__.py`以便 import * 正常工作。

但是 django 添加了一堆 from ... import ... 语句，并在`__init__.py`. 为什么？这不是让事情看起来很乱吗？是否有需要此代码的原因`__init__.py`？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-09-23T04:47:51.010

`__init__.py`当您导入包含它的包（目录）时，所有导入都可用。

例子：

`./dir/__init__.py`：

```
import something 
```

`./test.py`：

```
import dir
# can now use dir.something 
```

编辑：忘了提一下，`__init__.py`第一次从该目录导入任何模块时，代码运行。所以它通常是放置任何包级初始化代码的好地方。

EDIT2：dgrant 在我的示例中指出了可能的混淆。in`__init__.py` `import something`可以导入任何模块，不需要从包中导入。例如，我们可以用 替换它`import datetime`，然后在我们的顶层`test.py`，这两个片段都可以工作：

```
import dir
print dir.datetime.datetime.now() 
```

和

```
import dir.some_module_in_dir
print dir.datetime.datetime.now() 
```

底线是：`__init__.py`无论何时导入包或包中的模块，在包命名空间中分配的所有名称，无论是导入的模块、函数还是类，都会自动可用。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-09-23T06:12:15.080

这只是个人喜好，与你的 python 模块的布局有关。

假设您有一个名为`erikutils`. 有两种方法可以将它作为一个模块，要么你有一个名为*erikutils.py*的文件，要么你有一个名为*erikutils*的`sys.path`目录，里面有一个空文件。然后假设您有一堆名为,的模块，并且您希望它们是 . 下的子模块。因此，您制作了一些名为*fileutils.py*、*procutils.py*和*parseutils.py*的 .py 文件：*`sys.path`*`__init__.py`*`fileutils``procutils``parseutils``erikutils`*

 ***```
erikutils
  __init__.py
  fileutils.py
  procutils.py
  parseutils.py 
```

也许您有一些不属于`fileutils`、`procutils`或`parseutils`模块的功能。假设您不想创建一个名为`miscutils`. 并且，您希望能够像这样调用该函数：

```
erikutils.foo()
erikutils.bar() 
```

而不是做

```
erikutils.miscutils.foo()
erikutils.miscutils.bar() 
```

所以因为`erikutils`模块是一个目录，而不是一个文件，我们必须在文件中定义它的函数*`__init__.py`*。

在 django 中，我能想到的最好的例子是`django.db.models.fields`. 所有 django *Field 类都在*django/db/models/fields*目录中的*`__init__.py`*文件中定义。我猜他们这样做是因为他们不想把所有东西都塞进一个假设的*django/db/models/fields.py*模型中，所以他们把它分成几个子模块（例如，*related.py 、* *files.py*）和他们将制作的 *Field 定义固定在 fields 模块本身中（因此，）。*****`__init__.py`*****

 *** * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-09-24T11:02:55.747

使用该`__init__.py`文件可以使内部包结构从外部不可见。如果内部结构发生变化（例如，因为您将一个胖模块分成两个），您只需调整`__init__.py`文件，而不是依赖于包的代码。您还可以使包裹的某些部分不可见，例如，如果它们还没有准备好用于一般用途。

请注意，您可以使用该`del`命令，因此典型的`__init__.py`可能如下所示：

```
from somemodule import some_function1, some_function2, SomeObject

del somemodule 
```

现在，如果您决定拆分`somemodule`新的`__init__.py`可能是：

```
from somemodule1 import some_function1, some_function2
from somemodule2 import SomeObject

del somemodule1
del somemodule2 
```

从外面看，包装仍然和以前一样。

# c# - 在为 datagridview 分配数据源时添加行

> ID：119168
> 
> 赞同：2
> 
> 时间：2008-09-23T04:41:36.187
> 
> 标签：c#, .net

我有一个 datagridview 为其分配了一个数据源。现在如何向该网格添加新行并从中删除一行？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-23T06:07:27.120

一种方法如下：

**步骤 #1**设置数据适配器、数据网格等：

```
// the data grid
DataGridView dataGrid;

// create a new data table
DataTable table = new DataTable();

// create the data adapter
SqlDataAdapter dataAdapter = new SqlDataAdapter(strSQL, strDSN);

// populate the table using the SQL adapter
dataAdapter.Fill(table);

// bind the table to a data source
BindingSource dbSource = new BindingSource();
dbSource.DataSource = table;

// finally bind the data source to the grid
dataGrid.DataSource = dbSource; 
```

**步骤 #2**设置数据适配器 SQL 命令：

这些 SQL 命令定义了如何通过适配器在网格和数据库之间移动数据。

```
dataAdapter.DeleteCommand = new SqlCommand(...);

dataAdapter.InsertCommand = new SqlCommand(...);

dataAdapter.UpdateCommand = new SqlCommand(...); 
```

**步骤 #3**从数据网格中删除选择行的代码：

```
public int DeleteSelectedItems()
{
    int itemsDeleted = 0;

    int count = dataGrid.RowCount;

    for (int i = count - 1; i >=0; --i)
    {
        DataGridViewRow row = dataGrid.Rows[i];

        if (row.Selected == true)
        {
            dataGrid.Rows.Remove(row);

            // count the item deleted
            ++itemsDeleted;
        }
    }

    // commit the deletes made
    if (itemsDeleted > 0) Commit();
} 
```

**步骤 #4**处理行插入和行更改：

这些类型的更改相对容易实现，因为您可以让网格管理单元格更改和新行插入。

您唯一需要决定的是何时提交这些更改。

我建议将提交放在 DataGridView 的**RowValidated**事件处理程序中，因为此时您应该拥有一整行数据。

**步骤#5**将更改保存回数据库的提交方法：

此函数将处理所有待处理的更新、插入和删除，并将这些更改从网格移回数据库。

```
public void Commit()
{
    SqlConnection cn = new SqlConnection();

    cn.ConnectionString = "Do the connection using a DSN";

    // open the connection
    cn.Open();

    // commit any data changes
    dataAdapter.DeleteCommand.Connection = cn;
    dataAdapter.InsertCommand.Connection = cn;
    dataAdapter.UpdateCommand.Connection = cn;
    dataAdapter.Update(table);
    dataAdapter.DeleteCommand.Connection = null;
    dataAdapter.InsertCommand.Connection = null;
    dataAdapter.UpdateCommand.Connection = null;

    // clean up
    cn.Close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T04:45:05.650

我相信您必须获取 Table 集合项并从中检索 Row 集合项。然后，您可以遍历这些行，或者您想要删除该行。

当然，您在绑定它之后执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T06:26:12.410

GridView 中的“Rows”属性没有Delete 方法，不能直接删除一行。您必须从数据源中删除项目，而不是重新制作 DataBind。您还可以将 Visibile = false 设置为该行，因此它将对用户显示为“已删除”。

# html - 在进行 Web 开发时，哪些工具可以让我跟踪 html 标签？

> ID：119180
> 
> 赞同：1
> 
> 时间：2008-09-23T04:48:16.703
> 
> 标签：html, tags, tracking

在进行 Web 开发时，哪些工具可以让我跟踪标签？例如，我希望能够快速找到我是否错过了关闭 div 标签。

目前我正在使用notepad++编写html。它突出显示了开始和结束标签，但是我可能需要一些时间来查看几乎所有标签以找出我出错的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T04:50:20.833

[HTMLTidy](http://tidy.sourceforge.net/)几乎是当今这类事物的事实上的标准

[整洁的 Windows 安装程序](http://dev.int64.org/tidy.html)

[整洁的常见问题](http://tidy.sourceforge.net/docs/faq.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T04:55:05.547

每当我从头开始编写页面时，我都会缩进标签，以便内部标签嵌套在外部标签中。

前任：

```
<body>
    <div>
       Content here...
    </div>
</body> 
```

我也是同时写出开始和结束标签，规划好页面布局，等后面再回去填写内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T04:50:43.017

您可以同时制作开始和结束标签。你可以缩进。在我看来，专门为此选择一个 IDE 或工具似乎有点矫枉过正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T04:51:17.337

恕我直言，您不能越过适当的缩进。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T02:53:43.677

Firefox的[Web Developer 插件](https://addons.mozilla.org/en-US/firefox/addon/60)非常方便。它为您提供了一种在页面上突出显示不同标签并使其易于可视化的好方法。还有太多工具要在这里列出，包括 HTML 和 CSS 验证器。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-23T05:11:57.207

缩进很有帮助。我还发现，一旦您在浏览器中查看页面，Firefox的[Html Validator扩展就可以方便地检查 HTML 问题（这对于检查服务器生成的 HTML 特别方便）。](http://users.skynet.be/mgueury/mozilla/ "Html 验证器")

# ruby-on-rails - Rails 方式 - 命名空间

> ID：119197
> 
> 赞同：30
> 
> 时间：2008-09-23T04:53:05.707
> 
> 标签：ruby-on-rails, namespaces

我有一个关于如何做“The Rails Way”的问题。对于具有面向公众的一面和管理界面的应用程序，Rails 社区对如何做到这一点的普遍共识是什么？

命名空间、子域或完全放弃它们？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-23T10:05:39.077

实际上，管理界面没有真正的“Rails 方式”——您可以在许多应用程序中找到所有可能的解决方案。DHH 暗示他更喜欢命名空间（使用 HTTP 基本身份验证），但这仍然是一个简单的暗示，而不是官方的 Rails 意见之一。

也就是说，我最近发现这种方法很成功（命名空间 + HTTP Basic）。它看起来像这样：

路线.rb：

```
map.namespace :admin do |admin|
  admin.resources :users
  admin.resources :posts
end 
```

管理员/users_controller.rb：

```
class Admin::UsersController < ApplicationController
  before_filter :admin_required
  # ...
end 
```

应用程序.rb

```
class ApplicationController < ActionController::Base
  # ...

  protected
  def admin_required
    authenticate_or_request_with_http_basic do |user_name, password|
      user_name == 'admin' && password == 's3cr3t'
    end if RAILS_ENV == 'production' || params[:admin_http]
  end
end 
```

条件 on`authenticate_or_request_with_http_basic`在生产模式或附加到任何 URL 时触发 HTTP 基本身份验证`?admin_http=true`，因此您可以在功能测试中对其进行测试，并在浏览开发站点时手动更新 URL。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T05:47:15.577

在一些较小的应用程序中，我认为您不需要分离管理界面。只需使用常规界面并为登录用户添加管理功能。

在更大的项目中，我会使用命名空间。出于某种原因，我觉得使用子域不合适。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T15:47:33.000

感谢所有回答我问题的人。如果您愿意，似乎共识是使用命名空间，因为没有 DHH 赞助的 Rails Way 方法。:)

再次感谢大家！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-06T17:53:32.513

回复肯定晚了，但我真的需要这个问题的答案：如何轻松地做管理区域？

以下是这些天可以使用的内容：[Active Admin](http://activeadmin.info/)，以及[Ryan Bates 的精彩介绍](http://railscasts.com/episodes/284-active-admin)。

# c# - 从c#切换到python好不好？

> ID：119198
> 
> 赞同：3
> 
> 时间：2008-09-23T04:53:13.227
> 
> 标签：c#, python

目前我正在使用 C# 在 .Net 环境中进行开发，但我想知道是否值得学习 python。我正在考虑学习 Django 框架。什么是更好的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-23T05:05:53.120

是的，你应该学习 Python，但这与 Python 或 C# 更好无关。这真的是为了让你成为一个更好的程序员。

学习 Python 会给你一个全新的视角来看待程序员以及如何解决问题。这就像举重，只是你在脑海中锻炼开发者的肌肉。

例如，如果您只使用静态类型语言进行编程，那么很难想象任何其他方式。学习 Python 会告诉你动态类型的替代方法。

有关 Python 优势的总结： [http ://www.cmswire.com/cms/enterprise-20/2007s-programming-language-of-the-year-is-002221.php](http://www.cmswire.com/cms/enterprise-20/2007s-programming-language-of-the-year-is-002221.php)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T05:02:16.700

我个人觉得你可以用任何语言编写好/坏的代码。我也坚信为了学习本身而[经常学习一门新语言。](http://www.linuxjournal.com/article/6536)基于这些理由，我说如果你有时间就去吧。Python 是一门伟大的语言，许多其他人都从中获得了灵感。

一种框架或语言是否更好取决于您对更好的定义。作为程序员，你想要更多的工作吗？您想快速开发业务应用程序，还是想计算 3D 矩阵变换？

回答完这些问题后，您可能会发现自己采取了完全不同的方向，如果您对金融或科学领域特别感兴趣，请说 F#。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T05:03:23.857

学习 Python 并没有什么坏处，特别是考虑到一些重量级人物（谷歌）真的在支持它。

至于实际使用，全看应用。使用最好的工具来完成这项工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T06:28:30.363

从未停止学习！

也就是说，你怎么能比较两者呢？.Net 中的 Python 支持有多好？Google App Engine 是否支持 C#？这真的取决于你的目标系统是什么。因此，您拥有的语言越多，您就越有能力应对不同的挑战。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T04:55:35.907

取决于你将使用它。如果您正在制作企业 Windows 窗体应用程序，我认为切换到 Python 不是一个好主意。

此外，仍然可以通过 IronPython 在 .NET CLR 上使用 Python。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T04:56:18.120

两者都可用于不同的目的。C# 是一个相当不错的多面手，python 的动态特性使其更适合站点构建等 RAD 体验。

如果你在这两个方面都能胜任，我认为你的职业生涯不会受到影响。要开始使用 Python，请考虑使用支持 Python 的 IDE，例如 Eclipse+PyDev 或 ActiveIDE 的 Komodo。（我发现在线订阅 Safari Bookshelf 也非常宝贵！）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T04:59:52.057

更好的东西本质上是主观的。如果你喜欢 Python 的语法 - 学习它。找到 Python 工作可能会更难，C# 和 .NET 通常似乎更受欢迎，但这可能会改变。

我还认为至少了解一种脚本语言是值得的，即使您的主要工作不需要它。Python 不是一个糟糕的候选者。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-05T16:35:48.327

我自己也一直在思考同样的问题。然而，我相信在我进入 Python 工作之前，C# 仍然可以提供很多我想要擅长的东西。因为 Python 更容易学习。我在语言中发现的一个优势不是语言本身，而是可用于学习它们的材料。例如，假设您可以使用 JavaScript 制作 3D 游戏，但您更有可能在 C++ 中找到资源。或者你可以用 PHP 制作手机应用程序，但 C# 或 Java 会有更多的材料来帮助你开发手机应用程序。就我个人而言，我知道当我擅长 C# 编程时，我将能够分支到其他语言。这是我选择将大部分时间花在这门语言上的主要原因。我也在学习一点 Java 和 C++，只是练习用其他语言思考。我认为未来 Python 会变得更流行，因为编码变得越来越流行，而 Python 是目前最简单的主流语言。

# migration - 迁移 clearcase 到 perforce

> ID：119204
> 
> 赞同：3
> 
> 时间：2008-09-23T04:55:11.100
> 
> 标签：migration, perforce, clearcase

我有大量需要迁移到 perforce 的 clearcase 数据。修订跨越了十年的大部分时间，我需要尽可能多地保留分支和标签信息。此外，我们广泛使用符号链接，在 clearcase 中支持但在 perforce 中不支持。你有什么建议或工具可以使这更容易？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T05:25:00.017

第一步是决定您是需要迁移所有内容，还是只迁移某些关键版本。如果您只迁移重要版本（版本和主要里程碑），您将在 Perforce 中获得更简单的历史，而不会丢失任何重要的东西。然后 ClearCase 可以作为历史档案保存以备不时之需。（除非 IBM 进行了更改，否则 ClearCase 许可证在维护结束时不会过期，您只会失去获得新升级和补丁的权利以及获得支持的权利）

请记住，Perforce 不会对目录进行版本控制，也不会保留完整的每个元素的版本树——这意味着不可能实现 1:1 的精确结果。重新创建重要的快照是一个更容易实现的目标。保留一切可能是不可能的，因为 Perforce 缺少 ClearCase 所依赖的功能。

要查看 Perforce 对 miration 的看法，请查看 [http://perforce.com/perforce/ccaseconv.html](http://perforce.com/perforce/ccaseconv.html) 这解释了关键差异并涵盖了您可以采取的一些方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T05:27:58.183

首先在 Google 上搜索[“clearcase to perforce conversion”](http://www.google.com/search?q=clearcase+to+perforce+conversion)。然后阅读[ClearCase 到 Perforce 的转换指南](http://perforce.com/perforce/ccaseconv.html)。一旦你哭完，你将不得不决定 (1) 你能承受多少努力，以及 (2) 作为转换的一部分，你真正需要捕捉什么。你不会得到这一切，所以你不妨只专注于获得重要的分支。

另一个考虑是将每个受支持分支的当前状态捕获为快照，将其导入 Perforce，然后关闭旧的 ClearCase 服务器，将其保存为当天需要从深沉、黑暗、Perforce 之前的日子……

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-07T07:14:58.287

其他答案已过时。现在您可以使用许多选项导入 CC->Perforce，同时保留历史记录。 [http://www.perforce.com/sites/default/files/pdf/migration-planning-guide-clearcase-to-perforce.pdf](http://www.perforce.com/sites/default/files/pdf/migration-planning-guide-clearcase-to-perforce.pdf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T07:38:55.210

您还必须记住一个事实，即您的 importerscript 可能会以不同于 clearcase 提交的顺序稍微提交（也许您正在遍历 dir，可能是文件的历史记录等）

因此，除非您将所有版本信息收集到（大型）数据库中并在之后对它们进行排序，否则您最终会得到不太有用的提交（当然，单个文件的历史记录除外）。当您（希望）更改您的提交策略以将原子更改提交到 perforce 时，它​​将在开发开始时可见：之前的提交对项目范围没有任何意义。

所以你真的应该考虑把 clearcase 历史抛在脑后。标签/分支创建也是一个不同的问题，因为您需要旧分支的旧配置规范。最后，您将在旧标签中得到错误的文件名（因为 perforce 不支持 dir-vers。）因此您将为此使用 clearcase（并且为文件的每个版本获取正确的文件名*非常棘手！）。*

您将遇到的最后一个问题：导入程序运行时间：如果您有大型 VOB（例如 10 年，50 GB 大小），您将等待导入程序收集所有信息并将其转换为漂亮的闪亮 perforce 存储库。这一天，您的开发团队将停止工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-31T18:07:06.327

简要说明一下我从 ClearCase 到 Perforce 的一次导入。
如[ClearCase 到 Perforce 转换指南](http://www.perforce.com/perforce/ccaseconv.html)中所述：

> Perforce 支持原子变更事务；ClearCase 没有。
> 
> 请注意，标签通常用于简单地表示特定易于指定的文件集的快照；由于 Perforce 使用原子更改事务和文件命名语法，这在 Perforce 中本质上很容易在不使用标签的情况下完成。
> 例如，`//depot/projecta`可以通过以下方式获得截至变更 42中所有文件的状态

```
p4 sync //depot/projecta/...@42 
```

这意味着导入的 ClearCase 项目是一个**[UCM](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.hlp.doc/cc_main/c_hood_ucm_concepts.htm)**项目，因为基线的概念紧跟全局修订的概念。
只有带有基线的文件被导入，其他版本被丢弃。

# ruby - 在 Ruby 中，'yield call out of block' 是什么意思？

> ID：119207
> 
> 赞同：3
> 
> 时间：2008-09-23T04:56:06.903
> 
> 标签：ruby, functional-programming

我是 Ruby 新手，我正在尝试以下方法：

```
mySet = numOfCuts.times.map{ rand(seqLength) } 
```

但我得到了“块外调用的产量”错误。我不确定他的意思。顺便说一句，这个问题是我[**在这里**](https://stackoverflow.com/questions/119107/how-do-i-generate-a-list-of-n-unique-random-numbers-in-ruby)问的一个更一般的问题的一部分。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-23T05:06:35.053

问题在于，times 方法期望得到一个块，它将让出控制权。但是，您还没有向它传递一个块。有两种方法可以解决这个问题。首先是不使用时间：

```
mySet = (1..numOfCuts).map{ rand(seqLength) } 
```

或者传递一个块给它：

```
mySet = []
numOfCuts.times {mySet.push( rand(seqLength) )} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T05:03:55.603

如果“numOfCuts”是一个整数，

```
5.times.foo 
```

是无效的

“times”需要一个块。

```
5.times{   code here   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T05:10:07.710

您正在组合似乎没有意义的函数——如果 numOfCuts 是一个整数，那么只使用时间和一个块将运行该块多次（尽管它只返回原始整数：

```
irb(main):089:0> 2.times {|x| puts x}
0
1
2 
```

map 是一个作用于范围和数组并返回数组的函数：

```
irb(main):092:0> (1..3).map { |x| puts x; x+1 }
1
2
3
[2, 3, 4] 
```

我不确定你想用代码实现什么 - 你想做什么？（而不是专门询问似乎无效的语法）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T13:01:17.063

宾果游戏，我刚刚发现这是什么。它是一个 JRuby 错误。

核磁共振下

```
>> 3.times.map
=> [0, 1, 2]
>> 
```

在 JRuby 下

```
irb(main):001:0> 3.times.map
LocalJumpError: yield called out of block
    from (irb):2:in `times'
    from (irb):2:in `signal_status'
irb(main):002:0> 
```

现在，我不知道 MRI（标准 Ruby 实现）是否在这里做正确的事情。它可能应该抱怨这没有意义，但是当在 MRI 中调用 n.times 时，它会返回一个 Enumerator，而 Jruby 抱怨它需要一个块。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T05:11:50.857

Integer.times 需要一个块。错误消息意味着方法`yield`内的语句`times`不能被调用，因为你没有给它一个块。

至于您的代码，我认为您正在寻找的是一个范围：

```
(1..5).map{ do something } 
```

这是[Integer.times](http://www.ruby-doc.org/core/classes/Integer.html#M001160)和[Range](http://www.ruby-doc.org/core-1.8.7/classes/Range.html)的 ruby​​doc 。

# php - PHP反序列化不断抛出相同的错误超过100次

> ID：119234
> 
> 赞同：0
> 
> 时间：2008-09-23T05:06:21.387
> 
> 标签：php, mysql, serialization

我有一个大型二维数组，我对其进行序列化和 base64_encode 并放入数据库中。在不同的页面上，我将数组拉出，当我`base64_decode`序列化数组时，我可以将其回显，它看起来确实有效。

但是，如果我尝试这样`unserialize(base64_decode($serializedArray))`做，只会引发相同的错误，以至于 Firefox 几乎崩溃。

错误是：

> 警告：`unserialize()`[function.unserialize]：第 24 行的 /var/www/dev/wc_paul/inc/analyzerTester.php 中不再存在节点

我会包含我回显的整个序列化数组，但上次我在这个表单上尝试它时它使我的 Firefox 崩溃。

有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T05:13:25.817

您确定您只是在序列化一个数组，而不是一个对象（例如 DOMNode？） 像资源一样，并非所有类都会对反序列化感到满意。作为 DOM 的示例（您的错误向我表明您正在使用它），每个节点都有对 parentNode 的引用，如果在节点被反序列化时 parentNode 不存在，它不能重新创建该参考和随之而来的问题。

我建议将 dom 树作为 XML 保存到数据库中，然后再将其加载回来。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T05:30:10.673

确保数据库字段足够大以容纳序列化数组。序列化数据在 PHP 中的空间效率**非常**低，许多数据库（如 MySQL）会默默地截断太长的字段值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T05:46:20.573

你的数组中有什么类型的元素？序列化/反序列化不适用于内置 PHP 对象，这通常是导致该错误的原因。

另外，根据您的评论，这不是您的问题，但是为了节省数据库中的空间，不要对数据进行 base64 编码，只需对其进行转义即可。即对于 mysql 使用 mysql_real_escape_string。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T10:43:51.077

确保你不序列化资源，它们不能被序列化。

[资源@php.net](http://www.php.net/manual/en/language.types.resource.php)

# .net - 在.Net中，从根目录递归查找所有文件的最快方法是什么？

> ID：119242
> 
> 赞同：5
> 
> 时间：2008-09-23T05:07:44.550
> 
> 标签：.net, search, filesystems

我想在目录中搜索与特定模式匹配的所有文件。令人惊讶的是，自从 vb6 (Dir) 以来，我就不必这样做了……我敢肯定，从那时起事情已经发生了变化！

-谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T05:10:34.590

使用**SearchOption.AllDirectories**参数：

```
using System.IO;

Directory.GetFiles(@"C:\", "*.mp3", SearchOption.AllDirectories); 
```

# java - 如何使 Loadtime-AspectJ 在小程序中工作

> ID：119245
> 
> 赞同：2
> 
> 时间：2008-09-23T05:09:23.673
> 
> 标签：java, applet, aspectj, load-time-weaving

由于 AspectJ LoadTime-Weaving 需要使用代理/它自己的类加载器加载 JVM - 有没有办法从我的小程序加载/更改用户的 JVM？或者可能就在加载小程序之前（使用父小程序？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-07T09:30:06.840

在 JVM 启动后可能会添加编织代理，请参阅： [如何在不停止 JVM 的情况下将 Javaagent 添加到 JVM？](https://stackoverflow.com/questions/4817670/how-can-i-add-a-javaagent-to-a-jvm-without-stopping-the-jvm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-29T22:24:44.183

恐怕你在那里完全不走运。根据[关于小程序类加载器的 Sun 文档](http://java.sun.com/sfaq/#appletCL)，“Web 浏览器仅使用一个类加载器，该类加载器在启动时建立。此后，系统类加载器无法扩展、重载、覆盖或替换。*小程序无法创建或引用自己的类加载器*”（强调我的）。

在这个问题上，您可能会在编译时编织方面取得更大的成功，除非有某种原因您不能这样做。

但是，如果小程序已签名，您也许可以解决此问题。AspectJ 并不清楚它对 Java 安全性的要求是什么。我会进入 AspectJ 邮件列表并询问。

# build - 使用 msbuild 复制所有文件和文件夹

> ID：119271
> 
> 赞同：103
> 
> 时间：2008-09-23T05:20:02.663
> 
> 标签：build, scripting, msbuild

只是想知道是否有人可以帮助我编写一些我正在尝试编写的 msbuild 脚本。我想做的是使用 msbuild 将所有文件和子文件夹从一个文件夹复制到另一个文件夹。

```
{ProjectName}
      |----->Source
      |----->Tools
              |----->Viewer
                       |-----{about 5 sub dirs} 
```

我需要做的是将所有文件和子文件夹从工具文件夹复制到应用程序的调试文件夹中。这是我到目前为止的代码。

```
<ItemGroup>
    <Viewer Include="..\$(ApplicationDirectory)\Tools\viewer\**\*.*" />
</ItemGroup>

<Target Name="BeforeBuild">
    <Copy SourceFiles="@(Viewer)" DestinationFolder="@(Viewer->'$(OutputPath)\\Tools')" />
</Target> 
```

构建脚本运行但不复制任何文件或文件夹。

谢谢

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2013-03-30T16:06:46.813

我也在寻找这方面的帮助。我花了一段时间，但这是我所做的，效果非常好。

```
<Target Name="AfterBuild">
    <ItemGroup>
        <ANTLR Include="..\Data\antlrcs\**\*.*" />
    </ItemGroup>
    <Copy SourceFiles="@(ANTLR)" DestinationFolder="$(TargetDir)\%(RecursiveDir)" SkipUnchangedFiles="true" />
</Target> 
```

这递归地将名为的文件夹的内容复制`antlrcs`到`$(TargetDir)`.

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2008-09-23T12:35:42.007

I think the problem might be in how you're creating your ItemGroup and calling the Copy task. See if this makes sense:

```
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="3.5">
    <PropertyGroup>
        <YourDestinationDirectory>..\SomeDestinationDirectory</YourDestinationDirectory>
        <YourSourceDirectory>..\SomeSourceDirectory</YourSourceDirectory>
    </PropertyGroup>

    <Target Name="BeforeBuild">
        <CreateItem Include="$(YourSourceDirectory)\**\*.*">
            <Output TaskParameter="Include" ItemName="YourFilesToCopy" />
        </CreateItem>

        <Copy SourceFiles="@(YourFilesToCopy)"
                DestinationFiles="@(YourFilesToCopy->'$(YourDestinationDirectory)\%(RecursiveDir)%(Filename)%(Extension)')" />
    </Target>
</Project> 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2010-01-03T01:05:57.440

我对 MSBuild 有点陌生，但我发现 EXEC 任务在这种情况下很方便。我在我的项目中遇到了同样的挑战，这对我有用，而且要简单得多。如果这不是一个好习惯，请告诉我。

```
<Target Name="CopyToDeployFolder" DependsOnTargets="CompileWebSite">
    <Exec Command="xcopy.exe  $(OutputDirectory) $(DeploymentDirectory) /e" WorkingDirectory="C:\Windows\" />
</Target> 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-10-30T09:33:27.503

```
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="3.5">
    <PropertyGroup>
        <YourDestinationDirectory>..\SomeDestinationDirectory</YourDestinationDirectory>
        <YourSourceDirectory>..\SomeSourceDirectory</YourSourceDirectory>
    </PropertyGroup>

    <Target Name="BeforeBuild">
        <CreateItem Include="$(YourSourceDirectory)\**\*.*">
            <Output TaskParameter="Include" ItemName="YourFilesToCopy" />
        </CreateItem>

        <Copy SourceFiles="@(YourFilesToCopy)"
                DestinationFiles="$(YourFilesToCopy)\%(RecursiveDir)" />
    </Target>
</Project> 
```

`\**\*.*`帮助从所有文件夹中获取文件。RecursiveDir 帮助将所有文件放在相应的文件夹中...

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-23T05:33:50.353

您是否尝试指定具体的目标目录而不是

```
DestinationFolder="@(Viewer->'$(OutputPath)\\Tools')" ? 
```

我对高级 MSBuild 语法不是很精通，但是

```
@(Viewer->'$(OutputPath)\\Tools') 
```

我觉得很奇怪。脚本看起来不错，所以问题可能出在`$(ApplicationDirectory)`和`$(OutputPath)`

这是一篇可能有用的博客文章：

[如何：使用 <Copy> 任务递归复制文件](https://docs.microsoft.com/en-us/archive/blogs/msbuild/how-to-recursively-copy-files-using-the-copy-task)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-10-29T06:39:49.400

这是有效的示例：

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

   <ItemGroup>
      <MySourceFiles Include="c:\MySourceTree\**\*.*"/>
   </ItemGroup>

   <Target Name="CopyFiles">
      <Copy
        SourceFiles="@(MySourceFiles)"
        DestinationFiles="@(MySourceFiles->'c:\MyDestinationTree\%(RecursiveDir)%(Filename)%(Extension)')"
       />
    </Target>

</Project> 
```

来源：[https ://msdn.microsoft.com/en-us/library/3e54c37h.aspx](https://msdn.microsoft.com/en-us/library/3e54c37h.aspx)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-10-20T14:28:56.787

这是我在自己的项目中使用的复制任务，它对我来说非常有效，可以将带有子文件夹的文件夹成功复制到目的地：

```
<ItemGroup >
<MyProjectSource Include="$(OutputRoot)/MySource/**/*.*" />
</ItemGroup>

<Target Name="AfterCopy" AfterTargets="WebPublish">
<Copy SourceFiles="@(MyProjectSource)" 
 OverwriteReadOnlyFiles="true" DestinationFolder="$(PublishFolder)api/% (RecursiveDir)"/> 
```

就我而言，我将项目的发布文件夹复制到另一个目标文件夹，我认为这与您的情况类似。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-04-26T14:28:12.870

我个人使用了 CopyFolder，它是 SDC 任务库的一部分。

[http://sdctasks.codeplex.com/](http://sdctasks.codeplex.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-09-27T17:17:08.367

如果您使用的是典型的 C++ 工具链，另一种方法是将文件添加到标准 CopyFileToFolders 列表中

```
<ItemGroup>
  <CopyFileToFolders Include="materials\**\*">
    <DestinationFolders>$(MainOutputDirectory)\Resources\materials\%(RecursiveDir)</DestinationFolders>
  </CopyFileToFolders>
</ItemGroup> 
```

除了简单之外，这是一个不错的方法，因为 CopyFilesToFolders 任务将生成适当的输入、输出甚至[TLog 文件](https://docs.microsoft.com/en-us/visualstudio/extensibility/visual-cpp-project-extensibility?view=vs-2017#tlog-files)，因此确保复制操作仅在输入文件之一发生更改或输出文件之一丢失时运行。使用 TLog，Visual Studio 还将正确地将项目识别为“最新”或不是（它为此使用单独的 U2DCheck 机制）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-04-28T05:24:22.373

使用 MSBuild 将文件从一个目录递归复制到另一个目录的最佳方法是使用带有 SourceFiles 和 DestinationFiles 作为参数的 Copy 任务。例如 - 将所有文件从构建目录复制到备份目录将是

```
<PropertyGroup>
<BuildDirectory Condition="'$(BuildDirectory)' == ''">Build</BuildDirectory>
<BackupDirectory Condition="'$(BackupDiretory)' == ''">Backup</BackupDirectory>
</PropertyGroup>

<ItemGroup>
<AllFiles Include="$(MSBuildProjectDirectory)/$(BuildDirectory)/**/*.*" />
</ItemGroup>

<Target Name="Backup">
<Exec Command="if not exist $(BackupDirectory) md $(BackupDirectory)" />
<Copy SourceFiles="@(AllFiles)" DestinationFiles="@(AllFiles-> 
'$(MSBuildProjectDirectory)/$(BackupDirectory)/%(RecursiveDir)/%(Filename)% 
(Extension)')" />
</Target> 
```

现在在上面的 Copy 命令中，遍历所有源目录并将文件复制到目标目录。

# database - informix 中查询的行号

> ID：119278
> 
> 赞同：5
> 
> 时间：2008-09-23T05:27:38.793
> 
> 标签：database, informix, row-number

我正在使用informix数据库，我想要一个查询，您还可以生成一个行号以及查询

喜欢

```
select row_number(),firstName,lastName 
from students;

row_number() firstName lastName
1            john      mathew
2            ricky     pointing
3            sachin    tendulkar 
```

这里 firstName, lastName 来自数据库，其中行号是在查询中生成的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-02T15:27:55.427

最好的方法是使用（新初始化的）序列。

```
begin work;
create sequence myseq;
select myseq.nextval,s.firstName,s.lastName from students s;
drop sequence myseq;
commit work; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T01:00:14.590

您可能无法在跨多个 DBSpace 分段的表中使用 ROWID，因此任何使用 ROWID 的解决方案都不是特别便携。也强烈反对。

如果您的源表中没有 SERIAL 列（这是将其作为一般概念实现的更好方法），请查看 [CREATE SEQUENCE](http://publib.boulder.ibm.com/infocenter/idshelp/v10/topic/com.ibm.sqls.doc/sqls264.htm#sii-02crprc-59441)，它或多或少相当于生成唯一数字的 Orrible 函数当 SELECTed from（与 SERIAL 相反，SERIAL 在插入行时生成唯一编号）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-07T01:11:43.330

给定一个名为 Table3 的表，其中包含 3 列：

```
colnum  name   datatype
======= =====  ===
1       no     text;
2       seq    number;
3       nm     text; 
```

注意：seq 是表中的一个字段，具有按升序排列的唯一值。这些数字不必是连续的。

这是返回行号（RowNum）以及查询结果的查询

```
SELECT table3.no, table3.seq, Table3.nm,
      (SELECT COUNT(*) FROM Table3 AS Temp
         WHERE Temp.seq < Table3.seq) + 1 AS RowNum
    FROM Table3; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T12:46:49.297

我认为最简单的方法是使用以下代码并相应地调整其返回。选择 rowid，* FROM 表

它对我有用，但请注意，它将返回数据库中的行号，而不是查询中的行号。

[PS这是专家交流](http://www.experts-exchange.com/Database/Informix/Q_23360872.html)的公认答案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-10-05T19:30:32.707

选择 sum(1) over (order by rowid) as row_number, M.* from systables M

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-02T20:04:26.393

我知道这是一个老问题，但是由于我刚刚遇到这个问题并且得到了这里没有提到的灵魂，我很难分享它，所以这里是：

1-您需要创建一个返回给定范围内的数字的函数：

```
CREATE FUNCTION fnc_numbers_in_range (pMinNumber INT, pMaxNumber INT)
RETURNING INT as NUMERO;
DEFINE numero INT;
LET numero = 0;
FOR numero = pMinNumber TO pMaxNumber   
    RETURN numero WITH RESUME;  
END FOR;    
END FUNCTION; 
```

2-你用你想要的表交叉这个函数的结果：

```
SELECT * FROM TABLE (fnc_numbers_in_range(0,10000)), my_table; 
```

唯一的事情是你必须事先知道你想要的行数，你可以用 COUNT(*) 函数得到这个。

这适用于我的 Informix 数据库，其他实现可能需要一些调整。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-30T10:30:01.837

使用 OLAP 表达式，你需要 OVER() 里面有一些东西，因为你不希望分区包含 SORT 子句，如下所示：

```
SELECT ROW_NUMBER() OVER(ORDER BY lastName, firstName) AS rn, firstName, lastName 
```

来自学生；

如果您不想按名称排序，您可以使用通过 ROWID 排序将记录输入系统的方式。

# php - 如何将 PHP 对象复制到不同的对象类型中

> ID：119281
> 
> 赞同：8
> 
> 时间：2008-09-23T05:30:17.430
> 
> 标签：php, oop

1.  新类是原始对象的子类

2.  它需要与php4兼容

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T06:11:57.860

您可以将您的类实例化为空，然后通过任意数量的方法加载。这些方法之一可以接受父类的实例作为参数，然后从那里复制其数据

```
class childClass extends parentClass
{
    function childClass()
    {
        //do nothing
    }

    function loadFromParentObj( $parentObj )
    {
        $this->a = $parentObj->a;
        $this->b = $parentObj->b;
        $this->c = $parentObj->c;
    }
};

$myParent = new parentClass();
$myChild = new childClass();
$myChild->loadFromParentObj( $myParent ); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T14:32:14.380

你可以用一些黑魔法来做到这一点，尽管我会严重质疑你**为什么**首先有这个要求。这表明您的设计存在严重问题。

尽管如此：

```
function change_class($object, $new_class) {
  preg_match('~^O:[0-9]+:"[^"]+":(.+)$~', serialize($object), $matches);
  return unserialize(sprintf('O:%s:"%s":%s', strlen($new_class), $new_class, $matches[1]));
} 
```

这受到与一般序列化相同的限制，这意味着对其他对象或资源的引用会丢失。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T12:45:09.833

php 对象与数组并没有太大的不同，而且由于所有 PHP 4 对象变量都是公共的，因此您可以做一些像这样的杂乱无章的事情：

```
function clone($object, $class)
{
     $new = new $class();
     foreach ($object as $key => $value)
     {
          $new->$key = $value;
     }
     return $new;
}
$mySubclassObject = clone($myObject, 'mySubclass'); 
```

它不漂亮，它当然不是我认为的好习惯，但它*是*可重复使用的，而且非常整洁。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T05:39:37.717

最好的方法是在子类上创建一个克隆方法，以便您可以执行以下操作：

```
$myvar = $subclass->clone($originalObject) 
```

或者，听起来您可以查看装饰器模式[php 示例](http://www.devshed.com/c/a/PHP/An-Introduction-to-Using-the-Decorator-Pattern-with-PHP/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T05:32:35.363

我想您将不得不发明某种“复制构造函数”。然后，您只需在传入原始对象的同时创建一个新的子类对象。

# .net - 将插入符号放置在 MaskedTextbox 中

> ID：119284
> 
> 赞同：22
> 
> 时间：2008-09-23T05:30:32.107
> 
> 标签：.net, winforms, user-interface, textbox

我希望能够覆盖将插入符号定位在蒙面文本框中的默认行为。

默认设置是将插入符号放置在单击鼠标的位置，由于掩码，被掩码的文本框已经包含字符。

我知道你可以像这篇[文章](https://stackoverflow.com/questions/44131/how-do-i-hide-the-input-caret-in-a-systemwindowsformstextbox)中提到的那样隐藏插入符号，当控件获得焦点时，是否有类似的东西可以将插入符号定位在文本框的开头。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-23T06:21:23.717

这应该可以解决问题：

```
 private void maskedTextBox1_Enter(object sender, EventArgs e)
    {
        this.BeginInvoke((MethodInvoker)delegate()
        {
            maskedTextBox1.Select(0, 0);
        });         
    } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-14T10:31:32.213

为了改进阿巴斯的工作解决方案，试试这个：

```
private void ueTxtAny_Enter(object sender, EventArgs e)
{
    //This method will prevent the cursor from being positioned in the middle 
    //of a textbox when the user clicks in it.
    MaskedTextBox textBox = sender as MaskedTextBox;

    if (textBox != null)
    {
        this.BeginInvoke((MethodInvoker)delegate()
        {
            int pos = textBox.SelectionStart;

            if (pos > textBox.Text.Length)
                pos = textBox.Text.Length;

            textBox.Select(pos, 0);
        });
    }
} 
```

此事件处理程序可以与多个框重复使用，并且它不会剥夺用户将光标定位在输入数据中间的能力（即当框不为空时不会强制光标进入第零位）。

我发现这更接近于模仿标准文本框。剩下的唯一故障（我可以看到）是在“Enter”事件之后，如果 xe 按住鼠标并拖动到末尾，用户仍然能够选择（空）掩码提示的其余部分。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-03-19T17:40:38.027

这是对 MaskedTextBoxes 的默认行为的一大改进。谢谢！

我对 Ishmaeel 的出色解决方案进行了一些更改。我更喜欢仅在需要移动光标时才调用 BeginInvoke。我还从各种事件处理程序中调用该方法，因此输入参数是活动的 MaskedTextBox。

```
private void    maskedTextBoxGPS_Click( object sender, EventArgs e )
{
    PositionCursorInMaskedTextBox( maskedTextBoxGPS );
}

private void    PositionCursorInMaskedTextBox( MaskedTextBox mtb )
{
  if (mtb == null)    return;

  int pos = mtb.SelectionStart;

  if (pos > mtb.Text.Length)
    this.BeginInvoke( (MethodInvoker)delegate()  { mtb.Select( mtb.Text.Length, 0 ); });
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-23T06:32:12.663

部分答案：您可以通过在 MouseClick 事件中为控件分配 0 长度选择来定位插入符号，例如：

```
MaskedTextBox1.Select(5, 0) 
```

...将插入符号设置在文本框中的第 5 个字符位置。

这个答案只是部分的原因，是因为我想不出一种普遍可靠的方法来确定插入符号*应该*在点击时定位的位置。这对于某些掩码可能是可能的，但在某些常见情况下（例如美国电话号码掩码），我真的想不出一种简单的方法来将掩码和提示字符与实际用户输入分开......

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-10T19:16:54.820

```
//not the prettiest, but it gets to the first non-masked area when a user mounse-clicks into the control
private void txtAccount_MouseUp(object sender, MouseEventArgs e)
{
  if (txtAccount.SelectionStart > txtAccount.Text.Length)
    txtAccount.Select(txtAccount.Text.Length, 0);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-03T19:15:45.120

这个解决方案对我有用。请试一试。

```
private void maskedTextBox1_Click(object sender, EventArgs e)
{

 maskedTextBox1.Select(maskedTextBox1.Text.Length, 0);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-18T22:32:05.247

我使用 Click 事件让我的工作......不需要 Invoke。

```
 private void maskedTextBox1_Click(object sender, EventArgs e)
{
     maskedTextBox1.Select(0, 0);              
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-22T17:56:09.870

该解决方案使用了像 Gman Cornflake 一样的 MaskedTextBox 的 Click 方法；但是，我发现有必要允许用户在 MaskedTextBox 内单击，一旦它包含数据并且光标停留在它所在的位置。

下面的示例关闭提示和文字，并评估 MaskedTextBox 中数据的长度，如果等于 0，则将光标置于起始位置；否则它只是绕过将光标放在起始位置的代码。

代码是用 VB.NET 2017 编写的。希望对您有所帮助！

```
Private Sub MaskedTextBox1_Click(sender As Object, e As EventArgs) Handles MaskedTextBox1.Click
    Me.MaskedTextBox1.TextMaskFormat = MaskFormat.ExcludePromptAndLiterals
    If Me.MaskedTextBox1.Text.Length = 0 Then
        MaskedTextBox1.Select(0, 0)
    End If
    Me.MaskedTextBox1.TextMaskFormat = MaskFormat.IncludePromptAndLiterals
End Sub 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-13T15:12:08.303

我知道这是一个老问题，但谷歌已经多次将我带到这里，但没有一个答案完全符合我的要求。
例如，当您使用`TextMaskFormat = MaskFormat.ExcludePromptAndLiterals`.

下面的方法使输入文本框时光标跳转到第**一个提示**。输入文本框后，您可以自由移动光标。它也适用于`MaskFormat.ExcludePromptAndLiterals`.

这就是为什么我认为值得把它留在这里:)

```
private void MaskedTextBox_Enter(object sender, EventArgs e)
{
    // If attached to a MaskedTextBox' Enter-Event, this method will
    // make the cursor jump to the first prompt when the textbox gets focus.
    if (sender is MaskedTextBox textBox)
    {
        MaskFormat oldFormat = textBox.TextMaskFormat;
        textBox.TextMaskFormat = MaskFormat.IncludePromptAndLiterals;
        string fullText = textBox.Text;
        textBox.TextMaskFormat = oldFormat;

        int index = fullText.IndexOf(textBox.PromptChar);
        if (index > -1)
        {
            BeginInvoke(new Action(() => textBox.Select(index, 0)));
        }
    }
} 
```

# ruby - 在 ruby 异常中捕获行号

> ID：119286
> 
> 赞同：51
> 
> 时间：2008-09-23T05:32:28.733
> 
> 标签：ruby, exception

考虑以下 ruby​​ 代码

测试.rb：

```
begin

  puts
  thisFunctionDoesNotExist
  x = 1+1
rescue Exception => e
  p e
end 
```

出于调试目的，我希望救援块知道错误发生在该文件的第 4 行。有没有一种干净的方法来做到这一点？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2008-09-23T05:48:03.877

```
p e.backtrace 
```

我在一个没有来源的 IRB 会话上运行它，它仍然提供了相关信息。

```
=> ["(irb):11:in `foo'", 
    "(irb):17:in `irb_binding'", 
     "/usr/lib64/ruby/1.8/irb/workspace.rb:52:in `irb_binding'", 
     "/usr/lib64/ruby/1.8/irb/workspace.rb:52"] 
```

如果你想要一个很好解析的回溯，下面的正则表达式可能会很方便：

```
p x.backtrace.map{ |x|   
     x.match(/^(.+?):(\d+)(|:in `(.+)')$/); 
    [$1,$2,$4] 
}

[
  ["(irb)", "11", "foo"], 
  ["(irb)", "48", "irb_binding"], 
  ["/usr/lib64/ruby/1.8/irb/workspace.rb", "52", "irb_binding"], 
  ["/usr/lib64/ruby/1.8/irb/workspace.rb", "52", nil]
] 
```

（正则表达式 /should/ 对函数名或目录/文件名中的奇怪字符是安全的）（如果你想知道 foo 来自哪里，我做了一个 def 来获取异常：

```
>>def foo
>>  thisFunctionDoesNotExist
>> rescue Exception => e 
>>   return e 
>>end     
>>x = foo 
>>x.backtrace 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-09-23T05:50:30.983

您可以从 Exception 对象访问回溯。要查看整个回溯：

```
p e.backtrace 
```

它将包含调用堆栈的文件和行号数组。对于像您问题中的脚本这样的简单脚本，它只包含一行。

```
["/Users/dan/Desktop/x.rb:4"] 
```

如果你想要行号，你可以检查回溯的第一行，并提取冒号后面的值。

```
p e.backtrace[0].split(":").last 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-03-06T11:26:10.040

通常回溯包含很多来自外部 gem 的行只查看与项目本身相关的行要方便得多

我的建议是按项目文件夹名称过滤回溯

```
puts e.backtrace.select { |x| x.match(/HERE-IS-YOUR-PROJECT-FOLDER-NAME/) } 
```

然后您可以解析过滤的行以提取其他答案中建议的行号。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-06-24T23:54:20.787

在这个旧线程上投入我的 0.02 美元——这是一个维护所有原始数据的简单解决方案：

```
print e.backtrace.join("\n") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-21T09:08:46.167

在 Ruby 1.9.3 中，您可能不仅能够以更结构化、更可靠和更简单的方式访问这些信息，而无需使用正则表达式来剪切字符串。

基本思想是引入一个调用框架对象，它可以访问有关调用堆栈的信息。

请参阅[http://wiki.github.com/rocky/rb-threadframe/](http://wiki.github.com/rocky/rb-threadframe/)，唉，这需要修补 Ruby 1.9。在 RubyKaigi 2010（2010 年 8 月下旬）安排了一次会议，讨论将框架对象引入 Ruby。

鉴于此，最早可能发生在 Ruby 1.9.3 中。

# sql-server - 来自 SharePoint 的 MS SQL 2005 DB 的直通身份验证？

> ID：119295
> 
> 赞同：0
> 
> 时间：2008-09-23T05:45:22.290
> 
> 标签：sql-server, sharepoint

在我们的 Active Directory 域中，我们有一个 MS SQL 2005 服务器和一个 SharePoint（我相信是 MOSS 3.0）服务器。两者都针对我们的 LDAP 服务器进行身份验证。希望允许这些经过身份验证的 SharePoint 访问者查看 MS SQL 数据库中的一些数据。主要挑战是身份验证。

有关使直通身份验证起作用的任何提示吗？我已经搜索（Google）要使用的正确连接字符串，但不断寻找具有嵌入式凭据或其他方案的连接字符串。我收集到 SSPI 是我想要使用的，但不知道如何实现。

澄清：我们还没有单点登录服务器（例如 Shibboleth）设置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T06:13:20.087

如果您使用 C#，则代码和连接字符串为：

```
using System.Data.SqlClient; 
... 
SqlConnection oSQLConn = new SqlConnection(); 
oSQLConn.ConnectionString = 
    "Data Source=(local);" + 
    "Initial Catalog=myDatabaseName;" +
    "Integrated Security=SSPI";
 //Or
 // "Server=(local);" + 
 // "Database=myDatabaseName;" + 
 // "Trusted_Connection=Yes";
oSQLConn.Open(); 
... 
oSQLConn.Close(); 
```

可以在[Carl Prothman 的博客](http://www.carlprothman.net/Default.aspx?tabid=81)中找到有关连接字符串的极好资源。Yoy 可能应该替换`(local)`为 SQL 服务器的名称。

您将需要配置 SQL 服务器以向域角色提供所需的访问权限。在 SQL Server 中，您需要转到 Security\Logins 并确保您拥有 Domain\User 角色（即 MyCompany\SharpointUsers）。在你的配置中你应该有

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-02T16:38:27.737

实际上，Windows 身份验证验证用户是否合法，而无需通过网络传递用户名和密码。而直通身份验证确实通过网络传递用户名和密码。它们不是同一件事。使用 Leo Moore 提供的连接字符串和代码会导致 SQL 使用默认情况下使用的 Windows 身份验证，而不是 OP 询问的直通身份验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T07:26:31.893

“SharePoint 的用户”是什么意思？

您的意思是他们想要查看 SharePoint 页面内部的数据吗？在这种情况下，您必须在该页面/应用程序中进行模拟，并可能正确设置 Kerberos。

然后，您必须在 SQL Server 上为这些 SharePoint 用户（或者更好的是他们的 AD 组）分配适当的权限。

# database - 如何获取受一组存储过程影响的表列表？

> ID：119308
> 
> 赞同：2
> 
> 时间：2008-09-23T05:50:45.103
> 
> 标签：database, stored-procedures

我有一个巨大的数据库，有大约 100 个表和大约 250 个存储过程。我想知道受存储过程子集影响的表列表。例如，我有一个包含 50 个存储过程的列表，共有 250 个，我想知道将受这 50 个存储过程影响的表的列表。除了读取所有存储过程并手动查找表列表之外，还有什么简单的方法可以做到这一点？

PS：我为此使用 SQL Server 2000 和 SQL Server 2005 客户端。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T06:33:02.147

这将是您的 SQL Server 查询：

```
SELECT
    [NAME]
FROM
    sysobjects
WHERE
    xType = 'U' AND --specifies a user table object
    id in
    (
        SELECT 
            sd.depid 
        FROM 
            sysobjects so,
            sysdepends sd
        WHERE
            so.name = 'NameOfStoredProcedure' AND 
            sd.id = so.id
    ) 
```

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T06:28:03.327

**sp_depends 'StoredProcName'**将返回存储过程所依赖的对象名称和对象类型。

**编辑：** 我更喜欢@KG 的回答。更灵活的恕我直言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T06:40:05.687

我会在 SQL 2005 中这样做（如果您只希望它用于特定的过程，请取消注释“AND”行）：

```
SELECT 
    [Proc] = SCHEMA_NAME(p.schema_id) + '.' + p.name,
    [Table] = SCHEMA_NAME(t.schema_id) + '.' + t.name,
    [Column] = c.name,
    d.is_selected,
    d.is_updated
FROM sys.procedures p
    INNER JOIN  sys.sql_dependencies d
        ON  d.object_id = p.object_id
        AND d.class IN (0,1)
    INNER JOIN  sys.tables t
        ON  t.object_id = d.referenced_major_id
    INNER JOIN  sys.columns c
        ON  c.object_id = t.object_id
        AND c.column_id = d.referenced_minor_id
WHERE   p.type IN ('P')
--  AND p.object_id = OBJECT_ID('MyProc')
ORDER BY 
    1, 2, 3 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-09-23T06:05:32.663

一个非常具有侵略性的选择是获取一个重复的数据库并在每个记录发生的事情的表上设置一个触发器。然后运行所有的SP。如果你不能对数据库做很多不工作的模组

此外，如果您还想要 SP 通过触发器影响的表，请务必将日志记录添加到现有触发器而不是用日志记录替换它们。

# url - URL：破折号与下划线

> ID：119312
> 
> 赞同：213
> 
> 时间：2008-09-23T05:51:50.857
> 
> 标签：url, seo, naming-conventions

应该是**/about_us**还是**/about-us**？

从可用性的角度来看，我个人认为**/about-us**对最终用户来说要好得多，但谷歌和大多数其他网站（和 javascript 框架）使用下划线命名模式。只是风格问题吗？破折号是否存在兼容性问题？

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2010-02-23T13:20:50.760

[来自 Google 网站管理员中心](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=76329)

> 考虑在 URL 中使用标点符号。URL [http://www.example.com/green-dress.html](http://www.example.com/green-dress.html) 比 [http://www.example.com/greendress.html](http://www.example.com/greendress.html)对我们有用得多。我们建议您在 URL 中使用连字符 (-) 而不是下划线 (_)。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2011-05-27T13:48:10.800

以下是支持破折号的几点：

*   Google 推荐使用破折号而不是下划线（[来源](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=76329)）。
*   最终用户更熟悉破折号。
*   破折号更容易在标准键盘上书写（无需 Shift）。
*   破折号不会隐藏在下划线后面。
*   破折号在 URL 的上下文中感觉更原生，因为它们在域名中是允许的。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2008-09-26T02:37:37.677

这不仅仅是破折号与下划线：

*   带空格的文字
*   没有空格的文本
*   编码%20spaces%20in%20URL
*   underscore_means_space
*   破折号意味着空间
*   加+手段+空格
*   骆驼香烟盒
*   帕斯卡案例
*   “带空格的引用文本” *（以及单引号与双引号）*
*   斜线/表示/空格
*   点表示空间

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-09-23T07:27:12.000

谷歌过去没有将下划线视为单词分隔符，我认为这很疯狂，但现在显然是这样。由于这段历史，破折号是首选。尽管从 SEO 的角度来看现在允许使用下划线，但我仍然认为破折号是最好的。

一个好处是，您的普通半电脑文盲网络冲浪者更有可能在键盘上键入破折号，他们甚至可能不知道下划线是什么。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2008-09-23T05:54:36.620

这只是一个猜测，但似乎他们选择了人们最可能**不会**在名称中使用的那个。这样，您可以拥有一个包含连字符的名称，并且仍然使用下划线作为单词分隔符，例如 UseTwo-wayLinks 可以转换为 use_two-way_links。

在您的示例中， /about-us 将是一个名为“about-us”连字符的目录（如果存在这样的词，并且 /about_us 将是一个名为“about us”的两个词短语转换为单个字符串的目录非白色字符。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2008-09-23T06:37:35.583

我以前一直使用下划线，现在我只将它们用于我不希望任何人直接链接的网站部分、js 文件、css 等。

从 SEO 的角度来看，破折号似乎是处理它的首选方式，详细解释，来自马嘴[http://www.mattcutts.com/blog/dashes-vs-underscores/](http://www.mattcutts.com/blog/dashes-vs-underscores/)。

另一个问题似乎发生在普通公众而不是程序员身上，即当带有下划线的超链接带有下划线时，您看不到下划线。高级用户会解决这个问题，但 Joe Public 可能不会。

尽管如此，仍然在代码中使用下划线而不是破折号 - 程序员理解它们，大多数其他人不理解。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-09-23T06:11:22.417

杰夫对此有一些想法：[https ://blog.codinghorror.com/of-spaces-underscores-and-dashes/](https://blog.codinghorror.com/of-spaces-underscores-and-dashes/)

两者都有缺点。我建议你选择一个并保持一致。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-09-23T06:09:09.300

我更喜欢下划线。首先，它们与我的常规编程经验相匹配`variable_names_are_not-subtraction`，其次，我相信已经提到过，单词可以有连字符，但它们从来没有下划线。举一个非常愚蠢的例子，“民族国家”与“民族国家”不同。前者翻译成“民族国家的土地”（想想“这里是枪支国家！最好继续前进，你听到了吗？”），而后者看起来像一个有时同义词的列表。`http://example.com/nation-state-country/`似乎与 的意思不同`http://example.com/nation-state_country/`，但是，如果连字符是分隔符/“空格”，除了单词中的字符，它可以。后者似乎更清楚实际目的，而前者看起来更像那个列表，如果有的话。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-09-23T14:38:57.640

SEO 大师[Jim Westergren](http://www.jimwestergren.com/seo-test-finalized-how-to-write-the-urls/)在 2005 年从严格的 SEO 角度对此进行了测试，得出的结论是 +（加号）实际上是最好的单词分隔符。但是，这似乎不合理，可能是由于搜索引擎算法中的错误。他建议 - （破折号）可读性和 SEO。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-09-23T06:13:38.963

下划线替换不允许空格的空格。破折号（连字符）可以是单词的一部分，因此将单词与已经包含连字符的连字符连接起来很难看/令人困惑。

坏的：

```
/low-budget-movies 
```

好的：

```
/low-budget_movies 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-23T05:53:59.243

从用户的角度来看，我认为 dash 更好，并且不会干扰 SEO。

不确定下划线约定的开始位置或原因。

知识渊博的[辩论](http://forums.searchenginewatch.com/showthread.php?t=6460)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-25T22:07:34.877

我更喜欢破折号，因为下划线可能会被链接下划线掩盖到一定程度。文本 URL 主要是为了一目了然而不是语法正确，因此保留破折号以用于连字符的论点是有限的。

文本 URL 的准确性很重要的地方是在向某人朗读时，在这种情况下，您不想将下划线与空格混淆（反之亦然）。

我还发现破折号在美学上更令人愉悦，如果这很重要的话。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-23T06:22:05.807

对于最终用户视图，我更喜欢“about-us”或“about us”而不是“about_us”

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-23T05:55:50.597

就个人而言，我会避免使用 about-us 或 about_us，而只使用 about。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-23T06:11:08.547

一些较旧的 Web 托管和 DNS 服务器实际上在解析 URL 的下划线时存在问题，因此这可能会在此类约定中发挥作用。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-23T06:35:35.790

我个人会避免使用所有破折号和下划线，如果它在代码中，则选择[camelCase](http://en.wikipedia.org/wiki/CamelCase)或[PascalCase 。](http://www.flexwiki.com/default.aspx/FlexWiki/PascalCase.html)

关于 camelCase 的维基百科文章解释了它的起源背后的一些原因。它们相当于

1.  不喜欢伸手去拿 _ 键的懒惰程序员
2.  关于可读性的潜在混淆
3.  施乐 PARC 的“Alto”​​键盘没有下划线键。

如果用户要查看字符串，那么我不会执行上述任何操作并使用“关于我们”。或者“AboutUs”，如果我不得不这样做的话，因为 camelCase 已经传播到某些领域的常见用法，例如产品名称。即 ThinkPad、TiVo

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-23T07:16:30.823

URL 中允许使用空格，因此您可以在链接中使用“/about us”（尽管这将被编码为“/about%20us”。但老实说，这始终是个人喜好，因此没有真正的答案在这里给出。

我会遵循破折号可以出现在单词中的约定，因此应该将空格转换为下划线。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-08-17T06:11:10.903

更好用。- / 作为分隔符，因为 _ 似乎不是分隔符。

[http://www.sistrix.com/blog/832-how-long-may-a-linktext-be.html](http://www.sistrix.com/blog/832-how-long-may-a-linktext-be.html)

# asp.net-mvc - 如何在 ASP.NET MVC Web 应用程序中传递上下文

> ID：119324
> 
> 赞同：1
> 
> 时间：2008-09-23T06:00:34.237
> 
> 标签：asp.net-mvc

好的，我是 ASP.NET Web 应用程序的新手……以及一般的 Web 应用程序。我只是在为工作中的内部工具做一些游戏应用程序。

鉴于本教程...

[http://www.asp.net/learn/mvc-videos/video-395.aspx](http://www.asp.net/learn/mvc-videos/video-395.aspx)

该示例基本上有一个全局任务列表。

因此，如果我想做同样的事情，但现在我想维护项目的任务。所以我现在选择一个项目，然后我得到该项目的任务列表。当我与任务交互时，如何保持我选择的项目的上下文？我是否以某种方式将其编码到链接中？还是您将其保存在某种会话数据中？或其他方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T13:13:47.773

听起来您有多个项目，每个项目都有多个任务，最好在 URL 中设置项目。这将需要一条路线，例如`"/projects/{project}/tasks"`. 它遵循 RESTful URL 原则（即 URL 描述内容）。

如果用户可能在多个浏览器窗口中打开了不同的项目，则使用会话状态将不起作用。假设我正在登录您的系统并选择在两个选项卡中打开的两个项目。首先将会话设置为第一个打开的选项卡的项目，但是一旦加载了第二个选项卡，会话将被覆盖到该项目。如果我随后在第一个选项卡中执行任何操作，它将被记录在第二个项目中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T22:08:51.037

我用：

*   应该持续多个请求的状态的会话状态，例如使用向导时。我会小心不要在这里放太多数据，因为它会导致可伸缩性问题。
*   TempData 适用于您只希望状态可用于下一个请求的场景（例如，当您重定向到另一个操作并且您希望该操作可以访问该状态，但您不希望它在那之后徘徊）
*   隐藏表单字段 [input type="hidden"] 用于与表单数据相关的状态并且我希望控制器知道，但我不希望显示该数据。也可用于将状态推送到客户端，以免服务器资源负担过重。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T06:36:01.217

好的，据我所知，最好的选择似乎是将其保存到会话数据中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T06:38:59.947

RESTful URL、隐藏字段和会话 cookie 是您的朋友。

# java - 一旦 UTF-8 编码，如何截断 java 字符串以适应给定的字节数？

> ID：119328
> 
> 赞同：40
> 
> 时间：2008-09-23T06:03:21.187
> 
> 标签：java, string, unicode, utf-8, truncate

我如何截断一个 java `String`，以便我知道一旦它被 UTF-8 编码，它将适合给定数量的字节存储？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-23T07:30:27.123

这是一个简单的循环，它计算 UTF-8 表示的大小，并在超出时截断：

```
public static String truncateWhenUTF8(String s, int maxBytes) {
    int b = 0;
    for (int i = 0; i < s.length(); i++) {
        char c = s.charAt(i);

        // ranges from http://en.wikipedia.org/wiki/UTF-8
        int skip = 0;
        int more;
        if (c <= 0x007f) {
            more = 1;
        }
        else if (c <= 0x07FF) {
            more = 2;
        } else if (c <= 0xd7ff) {
            more = 3;
        } else if (c <= 0xDFFF) {
            // surrogate area, consume next char as well
            more = 4;
            skip = 1;
        } else {
            more = 3;
        }

        if (b + more > maxBytes) {
            return s.substring(0, i);
        }
        b += more;
        i += skip;
    }
    return s;
} 
```

这*确实*处理出现在输入字符串中的[代理对。](http://en.wikipedia.org/wiki/UTF-16)Java 的 UTF-8 编码器（正确）将代理对输出为单个 4 字节序列而不是两个 3 字节序列，因此`truncateWhenUTF8()`将返回尽可能长的截断字符串。如果您在实现中忽略代理对，则截断的字符串可能会比它们需要的短。

我没有对该代码进行大量测试，但这里有一些初步测试：

```
private static void test(String s, int maxBytes, int expectedBytes) {
    String result = truncateWhenUTF8(s, maxBytes);
    byte[] utf8 = result.getBytes(Charset.forName("UTF-8"));
    if (utf8.length > maxBytes) {
        System.out.println("BAD: our truncation of " + s + " was too big");
    }
    if (utf8.length != expectedBytes) {
        System.out.println("BAD: expected " + expectedBytes + " got " + utf8.length);
    }
    System.out.println(s + " truncated to " + result);
}

public static void main(String[] args) {
    test("abcd", 0, 0);
    test("abcd", 1, 1);
    test("abcd", 2, 2);
    test("abcd", 3, 3);
    test("abcd", 4, 4);
    test("abcd", 5, 4);

    test("a\u0080b", 0, 0);
    test("a\u0080b", 1, 1);
    test("a\u0080b", 2, 1);
    test("a\u0080b", 3, 3);
    test("a\u0080b", 4, 4);
    test("a\u0080b", 5, 4);

    test("a\u0800b", 0, 0);
    test("a\u0800b", 1, 1);
    test("a\u0800b", 2, 1);
    test("a\u0800b", 3, 1);
    test("a\u0800b", 4, 4);
    test("a\u0800b", 5, 5);
    test("a\u0800b", 6, 5);

    // surrogate pairs
    test("\uD834\uDD1E", 0, 0);
    test("\uD834\uDD1E", 1, 0);
    test("\uD834\uDD1E", 2, 0);
    test("\uD834\uDD1E", 3, 0);
    test("\uD834\uDD1E", 4, 4);
    test("\uD834\uDD1E", 5, 4);

} 
```

**更新**了修改后的代码示例，它现在处理代理对。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-09-23T06:11:47.673

您应该使用[CharsetEncoder](https://docs.oracle.com/javase/8/docs/api/java/nio/charset/CharsetEncoder.html#encode-java.nio.CharBuffer-java.nio.ByteBuffer-boolean-)，尽可能多的简单`getBytes()`+ 复制可以将 UTF-8 字符减半。

像这样的东西：

```
public static int truncateUtf8(String input, byte[] output) {

    ByteBuffer outBuf = ByteBuffer.wrap(output);
    CharBuffer inBuf = CharBuffer.wrap(input.toCharArray());

    CharsetEncoder utf8Enc = StandardCharsets.UTF_8.newEncoder();
    utf8Enc.encode(inBuf, outBuf, true);
    System.out.println("encoded " + inBuf.position() + " chars of " + input.length() + ", result: " + outBuf.position() + " bytes");
    return outBuf.position();
} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-02-02T09:04:03.730

这是我想出的，它使用标准的 Java API，因此应该是安全的，并且与所有 unicode 怪异和代理对等兼容。解决方案取自[http://www.jroller.com/holy/entry/truncating_utf_string_to_the](http://www.jroller.com/holy/entry/truncating_utf_string_to_the)并带有检查添加用于 null 并在字符串的字节数少于**maxBytes**时避免解码。

```
/**
 * Truncates a string to the number of characters that fit in X bytes avoiding multi byte characters being cut in
 * half at the cut off point. Also handles surrogate pairs where 2 characters in the string is actually one literal
 * character.
 *
 * Based on: http://www.jroller.com/holy/entry/truncating_utf_string_to_the
 */
public static String truncateToFitUtf8ByteLength(String s, int maxBytes) {
    if (s == null) {
        return null;
    }
    Charset charset = Charset.forName("UTF-8");
    CharsetDecoder decoder = charset.newDecoder();
    byte[] sba = s.getBytes(charset);
    if (sba.length <= maxBytes) {
        return s;
    }
    // Ensure truncation by having byte buffer = maxBytes
    ByteBuffer bb = ByteBuffer.wrap(sba, 0, maxBytes);
    CharBuffer cb = CharBuffer.allocate(maxBytes);
    // Ignore an incomplete character
    decoder.onMalformedInput(CodingErrorAction.IGNORE)
    decoder.decode(bb, cb, true);
    decoder.flush(cb);
    return new String(cb.array(), 0, cb.position());
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-23T06:07:41.160

UTF-8 编码有一个简洁的特性，可以让您查看您在字节集中的位置。

在您想要的字符限制处检查流。

*   如果它的高位为0，它是一个单字节字符，只需将它替换为0就可以了。
*   如果它的高位是 1，下一位也是，那么你是在一个多字节字符的开头，所以只需将该字节设置为 0 就可以了。
*   如果高位为 1 但下一位为 0，那么您在一个字符的中间，沿着缓冲区返回，直到遇到高位中有 2 个或更多 1 的字节，然后将该字节替换为0。

示例：如果您的流是：31 33 31 C1 A3 32 33 00，您可以使字符串长度为 1、2、3、5、6 或 7 个字节，但不能为 4，因为这会将 0 放在 C1 之后，这是多字节字符的开始。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-10-24T06:53:13.290

你可以使用 -new String(data.getBytes("UTF-8") , 0, maxLen, "UTF-8");

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-23T07:47:41.373

您可以在不进行任何转换的情况下计算字节数。

```
foreach character in the Java string
  if 0 <= character <= 0x7f
     count += 1
  else if 0x80 <= character <= 0x7ff
     count += 2
  else if 0x800 <= character <= 0xd7ff // excluding the surrogate area
     count += 3
  else if 0xdc00 <= character <= 0xffff
     count += 3
  else { // surrogate, a bit more complicated
     count += 4
     skip one extra character in the input stream
  } 
```

您必须检测代理对（D800-DBFF 和 U+DC00–U+DFFF）并为每个有效代理对计算 4 个字节。如果你得到第一个范围内的第一个值，第二个范围内的第二个值，一切正常，跳过它们并加 4。但如果没有，那么它是一个无效的代理对。我不确定 Java 是如何处理这个问题的，但是在那种（不太可能的）情况下，你的算法必须正确计算。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-13T17:46:18.900

根据[billjamesdev 的回答](https://stackoverflow.com/a/119338/6404321)，我提出了以下方法，据我所知，这是最简单的方法，*并且*仍然适用于代理对：

```
public static String utf8ByteTrim(String s, int size) {
    final byte[] bytes = s.getBytes(StandardCharsets.UTF_8);
    if ((bytes[size-1] & 0x80) != 0) { // inside a multibyte sequence
        while ((bytes[trimSize-1] & 0x40) == 0) { // 2nd, 3rd, 4th bytes
            trimSize--;
        }
        trimSize--;
    }
    return new String(bytes, 0, size, StandardCharsets.UTF_8);
} 
```

一些测试：

```
String test = "Aæ尝试";
IntStream.range(1, 16).forEachOrdered(i ->
        System.out.println("Size " + i + ": " + utf8ByteTrim(test, i))
);

---

Size 1: A
Size 2: A
Size 3: A
Size 4: Aæ
Size 5: Aæ
Size 6: Aæ
Size 7: Aæ
Size 8: Aæ
Size 9: Aæ
Size 10: Aæ
Size 11: Aæ尝
Size 12: Aæ尝
Size 13: Aæ尝试
Size 14: Aæ尝试
Size 15: Aæ尝试 
```

# apache - ssl_error_rx_record_too_long 和 Apache SSL

> ID：119336
> 
> 赞同：272
> 
> 时间：2008-09-23T06:07:09.947
> 
> 标签：apache, configuration, ssl, webserver, mod-ssl

我有一位客户试图访问我的一个网站，但他们不断收到此错误 > ssl_error_rx_record_too_long

他们在所有浏览器、所有平台上都会遇到此错误。我根本无法重现该问题。

我和我的服务器位于美国，客户位于印度。

我用谷歌搜索了这个问题，主要来源似乎是 SSL 端口在 HTTP 中说话。我检查了我的服务器，但没有发生这种情况。我尝试[了这里提到的解决方案](http://support.servertastic.com/error-code-ssl-error-rx-record-too-long/)，但客户表示它没有解决问题。

谁能告诉我如何解决这个问题，或者我如何重现这个？？？

**解决方案**

原来客户的本地代理配置错误！

希望这有助于任何人发现这个问题试图在未来调试它。

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2011-01-21T19:31:32.447

[Subimage 提到](http://support.servertastic.com/error-code-ssl-error-rx-record-too-long/)的链接对我来说是正确的。它建议更改虚拟主机标签，即`<VirtualHost myserver.example.com:443>`从`<VirtualHost _default_:443>`

> 错误代码：`ssl_error_rx_record_too_long`
> 
> 这通常意味着您的服务器上的 SSL 实现不正确。该错误通常是由服务器管理员需要调查的服务器端问题引起的。
> 
> 以下是我们建议尝试的一些事情。
> 
> *   确保端口 443 在您的服务器上打开并启用。这是 https 通信的标准端口。
>     
>     
> *   如果 SSL 使用非标准端口，则 FireFox 3 有时会出现此错误。确保 SSL 在端口 443 上运行。
>     
>     
> *   如果使用 Apache2，请检查您是否使用端口 443 进行 SSL。这可以通过如下设置 ports.conf 文件来完成
>     
>     
>     
>     ```
>     Listen 80
>     Listen 443 https 
>     ```
>     
>     
> *   确保您没有多个 SSL 证书共享同一个 IP。请确保所有 SSL 证书都使用自己的专用 IP。
>     
>     
> *   如果使用 Apache2，请检查您的虚拟主机配置。一些用户报告了更改`<VirtualHost>`以`_default_`解决该错误。

这解决了我的问题。我很少在谷歌上搜索错误消息并获得正确答案的第一击！:-)

*除了上述之外*，这些是其他人发现导致问题的其他一些解决方案：

*   确保您的 SSL 证书未过期

*   尝试指定密码：

    `SSLCipherSuite ALL:!aNULL:!ADH:!eNULL:!LOW:!EXP:RC4+RSA:+HIGH:+MEDIUM:+SSLv3`

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2010-03-30T19:01:20.247

对我来说，解决方案是`default-ssl`在 apache 2 中没有启用......只是把`SSLEngine On`

我必须执行`a2ensite default-ssl`并且一切正常。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-05-20T11:13:12.347

就我而言，我必须将 <VirtualHost *> 改回 <VirtualHost *:80> （这是 Ubuntu 上的默认设置）。否则，端口 443 未使用 SSL，而是将纯 HTML 发送回浏览器。

您可以很容易地检查这是否是您的情况：只需连接到您的服务器[http://www.example.com:443](http://www.example.com:443)。如果您看到纯 HTML，则您的 Apache 根本没有在端口 443 上使用 SSL，很可能是由于 VirtualHost 配置错误。

干杯!

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-05-12T17:22:34.057

就我而言，我忘记`SSLEngine On`在配置中进行设置。像这样，

```
<VirtualHost _default_:443>
  SSLEngine On
  ...
</VirtualHost> 
```

[http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslengine](http://httpd.apache.org/docs/2.2/mod/mod_ssl.html#sslengine)

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-11-18T12:36:15.717

如果您在设置新的 https 虚拟主机后遇到错误并且配置似乎正确，请记住也链接`sites-enabled`。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-04-16T17:12:03.007

老问题，但对我来说是谷歌的第一个结果，所以这就是我必须做的。

**安装了 Apache 的 Ubuntu 12.04 桌面**

当我安装 Apache 时，所有配置和 mod_ssl 都已安装，但它还没有在正确的位置链接。注意：以下所有路径都是相对于**/etc/apache2/**

`mod_ssl`存储在`./mods-available`其中，并且 SSL 站点配置在其中`./sites-available`，您只需将这些链接到它们的正确位置，`./mods-enabled`并且`./sites-enabled`

```
cd /etc/apache2
cd ./mods-enabled
sudo ln -s ../mods-available/ssl.* ./
cd ../sites-enabled
sudo ln -s ../sites-available/default-ssl ./ 
```

重新启动 Apache，它应该可以工作。我试图访问[https://localhost](https://localhost)，因此您的结果可能因外部访问而异，但这对我有用。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-23T06:12:06.597

询问用户他们在浏览器中使用的确切 URL。如果他们输入[https://your.site:80](https://your.site:80)，他们可能会收到 ssl_error_rx_record_too_long 错误。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2011-07-14T22:00:32.487

就我而言，我在虚拟主机文件中的 IP 地址错误。监听是 443，节是，`<VirtualHost 192.168.0.1:443>`但是服务器没有 192.168.0.1 地址！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-07-30T13:21:00.717

请看[这个链接](http://www.errorhelp.com/index.php/search/details/69648/ssl_error_rx_record_too_long)。

我查看了所有 apache 日志文件，直到发现实际错误（我已将`<VirtualHost>`from更改`_default_`为 my `fqdn`）。当我修复此错误时，一切正常。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-01T14:36:53.230

在我的情况下，问题是 https 无法正确启动，因为 Listen 443 处于“IfDefine SSL”指令中，但我的 apache 没有以 -DSSL 选项开头。解决方法是更改​​我的 apachectl 脚本：

```
$HTTPD -k $ARGV 
```

到：

```
$HTTPD -k $ARGV -DSSL 
```

希望对某人有所帮助。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-21T14:07:20.273

我的问题是由于 VPN 连接上的 MTU 低。

```
netsh interface ipv4 show inter

Idx  Met   MTU   State        Name
---  ---  -----  -----------  -------------------
  1 4275 4294967295  connected    Loopback Pseudo-Interface 1
 10 4250   **1300**  connected    Wireless Network Connection
 31   25   1400  connected    Remote Access to XYZ Network 
```

修复： **netsh interface ipv4 set interface "Wireless Network Connection" mtu=1400**

非VPN连接也可能是一个问题......

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-30T14:34:36.940

我有一个混乱的虚拟主机配置。请记住，对于端口 80，您需要一台不带 SSL 的虚拟主机，而对于端口 443，您需要一台不带 SSL 的虚拟主机。您不能在一个虚拟主机中同时拥有这两种主机，就像 webmin 生成的配置试图做的那样。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-07-16T13:01:07.417

您也可以尝试修复主机文件。

将 vhost 文件保留在完全限定的域中，并将主机名添加到主机文件**/etc/hosts** (debian)

```
ip.ip.ip.ip name name.domain.com 
```

重新启动apache2后，错误应该消失了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-09-09T09:18:43.040

我在某些浏览器中访问我的 SSL 站点时遇到了同样的问题。我发现**我必须为 fireFox 提供正确的代理**（FireFox 直接访问互联网）。

根据局域网配置（隧道、过滤、代理重定向），FireFox 的“直接访问互联网”模式会引发此错误。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-09-26T17:01:21.483

对我来说，解决方案是我的 ddclient 没有正确 cronning ......

# ruby-on-rails - Rails 性能分析器

> ID：119349
> 
> 赞同：4
> 
> 时间：2008-09-23T06:13:35.810
> 
> 标签：ruby-on-rails, ruby, performance, plugins

监视和分析 Rails 应用程序性能的首选插件有哪些？如果可能的话，我正在寻找数据库/查询分析器和堆栈的其余部分，但不一定都在一个插件中。你推荐哪些？（免费的奖励积分:)

例如，[这个](http://railstips.org/2008/9/17/rails-app-monitoring)看起来很漂亮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T10:51:12.867

+1 新遗物。

也考虑五次运行，我没玩过，不过好像有开发模式的loopback模式，vs的新遗物生产模式

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T07:54:58.110

[RAWK](http://ckhsponge.wordpress.com/2006/10/11/ruby-on-rails-log-analyzer-rawk/)我曾经定期收到通过电子邮件发送给我的绩效报告。它通过分析 Rails 生产日志来工作，并且对我来说一直做得很好。

我最近从他们关于[rails monitoring的文章中了解了](http://blog.scoutapp.com/articles/2008/09/09/rails-monitoring-pillars)[Scout](http://scoutapp.com/)，但我还没有机会尝试它，看起来很有希望！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T20:13:11.133

[来自Scout](http://scoutapp.com)的 Derek - 我们添加了深度 Rails 工具作为插件。这意味着您将获得请求时间花费在哪里（db、rendering、other）的细分以及慢 MySQL 查询的优化建议。

您可以在我们的[免费计划中使用仪器](http://scoutapp.com/signup)

截图：http: [//img.skitch.com/20090513-fe4mnaqn5e7i3nsde5qdwrr6k5.png](http://img.skitch.com/20090513-fe4mnaqn5e7i3nsde5qdwrr6k5.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T06:24:44.413

这提供了 Rails 中查询分析器的信息

[http://ronnyml.wordpress.com/2008/07/03/query-analyzer-for-rails/](http://ronnyml.wordpress.com/2008/07/03/query-analyzer-for-rails/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-12T08:19:51.237

[https://github.com/igorkasyanchuk/rails_performance](https://github.com/igorkasyanchuk/rails_performance)

我有一个监控性能的选项，它使用 Redis 来存储请求信息，而不是向 3rd 方服务发送数据。

没什么特别的，只是一个简单的工具来获取最重要的报告（渲染时间、数据库查询、最流行的控制器#actions）

# notepad++ - 如何禁用烦人的“括号补全”？

> ID：119387
> 
> 赞同：46
> 
> 时间：2008-09-23T06:28:31.453
> 
> 标签：notepad++, code-completion

每当我键入 (、[ 或 { 时，Notepad++ 都会使用相应的右括号来完成它。我觉得这个“功能”很烦人，想禁用它。它似乎没有列在“首选项”对话框中，搜索在线文档没有产生任何有用的结果。这里有人知道这个选项隐藏在哪里吗？我目前使用的是 Notepad++ 5.0.3。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2014-08-07T17:49:22.060

从 6.6.8 版本开始：

转到设置 -> 首选项 -> 自动完成

在称为“自动插入”的第二组中，选中/取消选中相应的自动完成/插入。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-23T06:38:45.580

TextFX > TextFX 设置 > 取消选中 +Autoclose {([Brace

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-02T11:20:51.067

实际上它更有可能在 ConvertExt 插件中打开：Plugins->ConvertExt->Options Tab Notepad++: uncheck brackets autocompletion

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-21T13:40:29.087

设置 | 选项 | 自动完成

[![我的（德语）版本的屏幕截图..](https://i.stack.imgur.com/BcmDm.png)](https://i.stack.imgur.com/BcmDm.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-23T09:07:18.367

如果以上都没有帮助（如我的情况），还有一个名为 Xbrackets Lite 的插件。

插件 -> XBrackets Lite -> 取消选中自动完成括号。

我似乎记得安装它是因为其他两个（设置/自动完成和 TextFX .. AutoClose）不起作用。

记事本++ 7.3.3。

# asp.net-mvc - 如何在 ASP.NET MVC 中自定义目录结构？

> ID：119388
> 
> 赞同：1
> 
> 时间：2008-09-23T06:28:43.920
> 
> 标签：asp.net-mvc, project-structure

我开始工作的项目将有几十个控制器，因此最好将它们构造成逻辑目录和相应的命名空间，如“Controllers/Admin/”、“Controllers/Warehouse/Supplies/”等。

ASP.NET MVC 是否支持嵌套控制器目录和命名空间？如何管理到这些控制器的路由？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T06:58:02.710

您可以将控制器放在任何地方；路由不依赖于控制器的存储位置。它将能够在您的应用程序中找到任何实现 IController 的类。

我通常将我的控制器放在一个单独的项目中，例如一个 MyProject.Frontend 项目，以及一个 MyProject.Frontend.Application 项目，它是具有视图等的实际入口点 Web 项目。

# linux - 使用 mail 命令发送电子邮件时指定 from 用户

> ID：119390
> 
> 赞同：65
> 
> 时间：2008-09-23T06:29:09.393
> 
> 标签：linux, email, redhat

有谁知道在使用 mail 命令发送电子邮件时如何更改 from 用户？我已经浏览了手册页，但看不到如何执行此操作。

我们正在运行 Redhat Linux 5。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-09-23T07:03:54.037

您可以使用 -a 指定您可能需要的任何额外标题

```
$mail -s "Some random subject" -a "From: some@mail.tld" to@mail.tld 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-23T06:44:28.653

[http://www.mindspill.org/962](http://www.mindspill.org/962)似乎有一个解决方案。

本质上：

`echo "This is the main body of the mail" | mail -s "Subject of the Email" recipent_address@example.com -- -f from_user@example.com`

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-09-23T06:31:51.073

邮件 -r from@from.from -R from@from.com

-r = from-addr -R = 回复地址

作者表示他的邮件版本不支持此标志。但是，如果您有一个可以正常工作的版本。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-05-05T12:11:34.497

通过 SMTP 发送时，`mail`手册页建议以`from`这种方式设置变量（在 CentOS 6 上测试）：

```
mail -s Subject -S from=sender@example.com recipient@example.com 
```

`-a`您还可以使用以下选项附加文件：

```
mail -s Subject -S from=sender@example.com -a path_to_attachement recipient@example.com 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-10-04T20:58:45.470

这些都不适合我（Ubuntu 12.04），但最终经过反复试验，我得到了：

```
echo 'my message blabla\nSecond line (optional of course)' | 
mail -s "Your message title"
-r 'Your full name<yourSenderAdress@yourDomain.abc>'
-Sreplyto="yourReplyAdressIfDifferent@domain.abc"
destinatorEmail@destDomain.abc[,otherDestinator@otherDomain.abc] 
```

（全部在一行中，“-Sreplyto”中没有空格）

我从以下位置收到此邮件命令：

```
apt-get install mailutils 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-23T06:49:34.773

您可以通过先添加 -- 将 sendmail 选项附加到邮件命令的末尾。-f 是 sendmail 上设置发件人地址的命令。所以你可以这样做：

邮件收件人@foo.com -- -f 发件人@bar.com

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-01-14T13:13:40.743

以上都不适合我。我花了很长时间才弄清楚，希望这对下一个人有帮助。

我正在使用带有 mailutils v2.1 的 Ubuntu 12.04 LTS。

我在网上某处找到了这个解决方案，不知道在哪里，再也找不到了：

```
-aFrom:Servername-Server@mydomain.com 
```

使用的完整命令：

```
cat /root/Reports/ServerName-Report-$DATE.txt | mail -s "Server-Name-Report-$DATE" myemailadress@mydomain.com -aFrom:Servername-Server@mydomain.com 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-23T06:34:08.523

这是一个[解决方案](https://stackoverflow.com/questions/54725/change-the-from-address-in-unix-mail)。

-r 之后的第二个最简单的解决方案（即指定 From: 标头并通过像这样的换行符将其与正文分开

```
 $mail -s "Subject" destination@example.com
 From: Joel <joel@example.com>

 Hi!
 . 
```

仅在少数邮件版本中有效，不知道redhat 带有什么版本）。

PS：大多数版本的邮件都很烂！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-02-03T11:01:30.087

在 CentOs5 上：-r from@me.omg

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-04-15T21:42:08.877

```
echo "This is the main body of the mail" | mail -s "Subject of the Email" recipent_address@example.com -- -f from_user@example.com -F "Elvis Presley" 
```

或者

```
echo "This is the main body of the mail" | mail -s "Subject of the Email" recipent_address@example.com -aFrom:"Elvis Presley<from_user@example.com>" 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-02-06T15:21:01.443

大多数人在尝试正确伪造电子邮件上的发件人地址时需要更改两个值。第一个是发件人地址，第二个是原始地址。许多在线提供的解决方案只改变了其中一个值。

如果以 root 身份，我尝试一个简单的邮件命令给自己发送一封电子邮件，它可能看起来像这样。 `echo "test" | mail -s "a test" me@noone.com`

以及相关的日志： `Feb 6 09:02:51 myserver postfix/qmgr[28875]: B10322269D: from=<root@myserver.com>, size=437, nrcpt=1 (queue active) Feb 6 09:02:52 myserver postfix/smtp[19848]: B10322269D: to=<me@noone.com>, relay=myMTA[x.x.x.x]:25, delay=0.34, delays=0.1/0/0.11/0.13, dsn=2.0.0, status=sent (250 Ok 0000014b5f678593-a0e399ef-a801-4655-ad6b-19864a220f38-000000)`

尝试使用 - 更改发件人地址 `echo "test" | mail -s "a test" me@noone.com -- dude@thisguy.com`

这会更改 orig-to 值，但不会更改 from 值： `Feb 6 09:09:09 myserver postfix/qmgr[28875]: 6BD362269D: from=<root@myserver.com>, size=474, nrcpt=2 (queue active) Feb 6 09:09:09 myserver postfix/smtp[20505]: 6BD362269D: to=<me@noone>, orig_to=<dude@thisguy.com>, relay=myMTA[x.x.x.x]:25, delay=0.31, delays=0.06/0/0.09/0.15, dsn=2.0.0, status=sent (250 Ok 0000014b5f6d48e2-a98b70be-fb02-44e0-8eb3-e4f5b1820265-000000)`

接下来尝试使用 -r 和 -- 来调整 from 和 orig-to。 `echo "test" | mail -s "a test" -r dude@comeguy.com me@noone.com -- dude@someguy.com`

和日志： `Feb 6 09:17:11 myserver postfix/qmgr[28875]: E3B972264C: from=<dude@someguy.com>, size=459, nrcpt=2 (queue active) Feb 6 09:17:11 myserver postfix/smtp[21559]: E3B972264C: to=<me@noone.com>, orig_to=<dude@someguy.com>, relay=myMTA[x.x.x.x]:25, delay=1.1, delays=0.56/0.24/0.11/0.17, dsn=2.0.0, status=sent (250 Ok 0000014b5f74a2c0-c06709f0-4e8d-4d7e-9abf-dbcea2bee2ea-000000)`

这就是它为我工作的方式。希望这可以帮助某人。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-13T00:40:18.083

这适用于 Centos7

`echo "This is the main body of the mail" | mail -s "Subject of the Email" -r seneder_address@whatever.com recipent_address@example.com`

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-04-21T15:02:00.257

这是 2018 年关于 Debian 9 的答案。

请注意`-e`for echo 允许换行符，以及`-r`mailx 显示名称以及外发电子邮件地址：

```
$ echo -e "testing email via yourisp.com from command line\n\nsent on: $(date)" | mailx -r "Foghorn Leghorn <sender@yourisp.com>" -s "test cli email $(date)" -- recipient@somedomain.com 
```

希望这可以帮助！

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-08-30T11:18:07.397

对于 CentOS，这里是工作命令：

```
mail -s Subject -S from=sender@example.com recipient@example.com 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-09-21T18:36:54.120

多亏了所有示例提供者，有些提供者没有工作。下面是另一个对我有用的简单示例格式。

```
echo "Sample body" | mail -s "Test email" from=sender-addrs@example.com recepient-addres@example.com 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2016-08-22T23:08:37.053

我遇到了同样的问题。但我解决了这个问题，只是在**/ect/passwd**字段中设置 geko字段。Postfix 默认从用户登录发送邮件。假设您想从字段更改为警报。您只需要在您喜欢的任何编辑器中编辑 /ect/passwd 文件。

1.  vim /ect/密码

根：x：0：0：**警报**：/root：/bin/bash

2.  重启后缀。

现在检查结果。

3.  echo "这是邮件的主体" | mail -s "邮件主题" user@domain.com

现在在收件人。正如您在 geko 字段中指定的那样，发件人将显示为**警报。**希望这个解决方案对你有用。

# search - 最好的搜索方法是什么？

> ID：119391
> 
> 赞同：1
> 
> 时间：2008-09-23T06:29:34.963
> 
> 标签：search, lucene

我在我的项目中使用 lucene。这是我的问题：我应该使用lucene来替换已经用sql实现的整个搜索模块，使用大量`like`语句并通过id或sth进行准确搜索，还是应该在模糊搜索中使用lucene（我的意思是全文搜索)?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T06:32:36.733

除非 SQL 搜索非常高效，否则您可能应该使用 lucene。

我们现在正在迁移到 Solr（基于 Lucene），因为我们的搜索查询本质上很慢，并且无法使用我们的数据库加速......如果您有相当大的表，您的搜索查询将开始变得非常慢，除非DB 有某种高度优化的自由文本搜索机制。

因此，让 Lucene 做它最擅长的事情......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T06:32:28.137

我不认为滥用**like**语句是一个好主意。而且我相信lucene的性能会比数据库好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T22:05:15.837

Solr 实际上给我留下了深刻的印象，在工作中我们正在寻找替代我们的 Google Mini（它对于任何严肃的网站搜索都非常不合适）并且期待一些需要一段时间才能实现的东西。在安装 Solr 的 30 分钟内，我们完成了我们预计至少需要几天时间的工作，并为我们提供了比以前更强大的搜索界面。

除了简单的站点搜索之外，您还可以使用 Solr 做很多聪明的事情。

# java - 从 Java 生成动态 Excel

> ID：119392
> 
> 赞同：3
> 
> 时间：2008-09-23T06:30:10.500
> 
> 标签：java, excel

我们已经预先定义了**Excel**文档结构，其中包含许多公式和宏。

在下载 Excel 期间，我们通过 Java 应用程序在 Excel 中的某些单元格中填充数据。下载后，当用户打开**Excel**时，嵌入其中的宏和公式将读取预填充的数据并做出相应的行为。

我们现在正在使用**ExtenXLS**从 Java生成**动态 Excel文档。**许可证是基于 CPU 的，它不支持具有双核 CPU 的 Box。我们被迫购买更多的许可证。

有没有更好的工具我们可以看看它是免费的，产品和支持成本最低（必须支持），许可证很简单？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-23T06:33:39.460

我非常喜欢使用 Apache POI Project HSSF 库（[http://poi.apache.org/）——](http://poi.apache.org/)它相当容易使用。我没有深入使用它，但它似乎相当强大。此外，还有我没有使用过的 JExcelAPI ( [http://sourceforge.net/projects/jexcelapi/ )。](http://sourceforge.net/projects/jexcelapi/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T09:49:31.090

[我在一个名为XLLoop](http://xlloop.sourceforge.net/ "XLloop")的开源项目上工作——这个框架允许您将 POJO 函数公开为 Excel 函数。

因此，您可以创建一个下载数据并将其填充到位的函数，而不是用数据填充 Excel 工作表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T07:07:36.040

如果您的用户将拥有最新版本的 Excel，那么手动调整 XML 文件格式并不难。只需将现有文档另存为 XML，然后找到要替换的位置。

# svn - 源代码控制策略

> ID：119396
> 
> 赞同：8
> 
> 时间：2008-09-23T06:31:59.200
> 
> 标签：svn, version-control

我正在寻找有关不同源代码控制策略的概述。我只遇到了 Main-Line 政策，并希望在与团队合作之前更好地了解其他人。

有人可以提供一个概述链接，甚至给我一些政策名称，以便我可以在上面启动谷歌吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-23T07:06:11.270

没有空的提交消息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T07:20:11.267

论文[“流线：并行软件开发的分支模式”](http://www.cmcrossroads.com/bradapp/acme/branching/)是对分支模式（例如您提到的“主线”模式）的出色讨论-它以模式的形式列出了选项以及对反模式的讨论。其中一位作者是 Perforce 的 Robert Orenstein。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-24T14:10:00.337

我们在项目中使用了几个实用规则作为提交策略。这些规则帮助我们将每个修订版保持在准备部署状态。我们的规则类似于 KDE 提交策略，发布在这里：[http](http://techbase.kde.org/Policies/SVN_Commit_Policy) ://techbase.kde.org/Policies/SVN_Commit_Policy 。每个提交应该是（从高到低优先级）：

*   成功检查（编译、测试、审查、FxCop'ed 等）
*   原子的（应该只包含一个逻辑更改、单个错误修复、重构等）
*   非冗余（不应该添加未使用的代码，不要提交注释代码，删除它，不要提交意外的格式更改等）
*   正确且完整的评论
*   匹配的当前开发阶段（例如，版本支持分支中不应允许重构）
*   尽可能小以匹配以前的规则。

我们开发了一个简单的工具 SvnCommitChecker，它可以帮助我们在提交到 svn 之前检查其中的一些规则。我计划在不久的将来将它放到 sourceforge 中，并附上一篇关于保持良好 svn 更改历史的好处的文章。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T06:49:09.673

我已经很好地使用了[Practical Perforce](http://oreilly.com/catalog/9780596101855/)这本书。尽管您可能没有使用 Perforce，但我认为第 7 章（软件如何发展）和第 8 章（基本代码线管理）可能非常有用。您也许可以在[Google 图书](http://books.google.com)上浏览它们。

Perforce 也有很多关于这个主题的精彩文章。[软件生命周期建模](http://www.perforce.com/perforce/life.html)写了关于策略的文章。
Perforce 完整的[技术文档](http://www.perforce.com/perforce/technical.html)。

而且，不，我不为 Perforce 工作。

祝你好运，托马斯

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-24T19:06:42.823

这两个基本相同：
[多敏捷团队的版本控制](http://www.infoq.com/articles/agile-version-control)
[配置管理 分支策略](http://www.snuffybear.com/ucm_branch.htm)

我们正在使用这种策略来使主干稳定，并使开发人员能够在他们的分支上做他们需要的任何事情。

Subversion 存在一些问题，因为它无法处理[循环合并](http://feeds.feedburner.com/~r/Submerged/~3/334352142/subversion-merg.html)，但它可以通过在每次重新集成回主干后删除开发分支来解决（与其他版本控制系统无关）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T06:38:49.790

我最喜欢的策略是“没有不引用票证的颠覆提交 + 每次提交的 Auto Trac 评论”：[http ://trac.edgewall.org/browser/trunk/contrib/trac-post-commit-hook](http://trac.edgewall.org/browser/trunk/contrib/trac-post-commit-hook)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T07:12:50.257

**提交每个更改而不是每个文件。**

这具有以下优点：

*   您稍后可以看到为什么在这个确切的文件中更改了这一行（啊哈，这是错误 #123 的错误修复）。如果您按文件提交，那么提交消息往往会描述文件中所做的更改——无论如何您都可以通过 diff 看到这些更改。如果您提交每个更改，那么提交消息往往会首先解释为什么更改已经完成。
*   还原或合并更改/错误修复要容易得多。
*   当您清楚地专注于您正在处理的单个错误/功能/更改时，它有助于更​​好地组织您的工作。当你完成时，你承诺。

有些人认为这个策略会产生更多的提交，但根据我的经验，你得到的提交毕竟更少。例如，您正在进行影响 50 个文件的重构。重构后，您有一个带有消息“重构的 xyz 子系统”的提交。

对于更大的更改，您应该考虑**dev-branch-per-change**策略。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T07:44:22.647

不要签入/提交任何破坏构建的更改。

# version-control - 在合并方面，Python 的空白依赖项与源代码控制的交互效果如何？

> ID：119399
> 
> 赞同：1
> 
> 时间：2008-09-23T06:32:23.473
> 
> 标签：version-control, merge, whitespace

我想知道是否需要更改代码缩进以调整嵌套对合并像 SVN 这样的系统中的更改有任何不利影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T06:34:36.510

我已经将 python 与 SVN 和 Mercurial 一起使用，并且没有麻烦合并。

这完全取决于差异是如何完成的 - 我怀疑它是逐个字符的，这会注意到一个缩进级别和另一个缩进级别之间的差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T07:09:26.160

通常，源代码控制系统默认会逐行合并。我发现合并 Python 代码与合并任何其他合理缩进的源代码没有什么不同。如果一个程序员将​​一个代码块包装在一个`if`语句中（缩进整个块），而另一个程序员修改了块内的某些内容，那么就会发生合并冲突。幸运的是，这种情况下的冲突非常容易解决。

如果您使用外部合并工具，那么您的工具可能支持更详细的文本合并算法，这些算法会自动考虑上述情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T07:13:14.733

只要项目中的每个人都同意使用相同的空白样式（空格或制表符），它就可以正常工作。

但是我见过开发人员将整个文件从空格转换为制表符的情况（我认为 Eclipse 有这个功能，绑定到 Ctrl+Tab！），这使得发现差异几乎是不可能的。

# python - mp3文件的时间长度

> ID：119404
> 
> 赞同：19
> 
> 时间：2008-09-23T06:33:14.767
> 
> 标签：python, mp3, media, duration

**在不使用外部库**的情况下确定给定 mp3 文件的长度（以秒为单位）的最简单方法是什么？（高度赞赏python源）

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-23T06:37:50.947

您可以使用[pymad](http://spacepants.org/src/pymad/)。它是一个外部库，但不要落入 Not Invented Here 陷阱。您不想要任何外部库的任何特殊原因？

```
import mad

mf = mad.MadFile("foo.mp3")
track_length_in_milliseconds = mf.total_time() 
```

发现[这里](http://simonwillison.net/2003/Dec/4/mp3lengths/)。

--

如果您真的不想使用外部库，请查看[此处](http://ibofobi.dk/stuff/mp3/)并查看他是如何做到的。警告：这很复杂。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-02-20T18:49:58.853

为了谷歌追随者的缘故，这里还有一些外部库：

mpg321 -t

ffmpeg -i

midentify（基本上是mplayer）请参阅[使用mplayer确定音频/视频文件的长度](https://stackoverflow.com/questions/497681/using-mplayer-to-determine-length-of-audio-video-file)

mencoder （传递给它无效的参数，它会吐出一条错误消息，但也会为您提供有关文件的信息，例如 $ mencoder inputfile.mp3 -o fake）

mediainfo 程序[http://mediainfo.sourceforge.net/en](http://mediainfo.sourceforge.net/en)

exiftool

linux“文件”命令

mp3信息

短袜

参考文献： [https ://superuser.com/questions/36871/linux-command-line-utility-to-determine-mp3-bitrate](https://superuser.com/questions/36871/linux-command-line-utility-to-determine-mp3-bitrate)

[http://www.ruby-forum.com/topic/139468](http://www.ruby-forum.com/topic/139468)

[mp3 长度（以毫秒为单位）](https://stackoverflow.com/questions/993971/mp3-length-in-milliseconds)

（使其成为其他人添加的 wiki）。

和库：.net：naudio，java：jlayer，c：libmad

干杯!

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-23T07:37:41.740

> > 简单，解析 MP3 二进制 blob 以计算一些东西，在 Python 中

这听起来是一个很高的要求。我不了解 Python，但这里有一些我从我曾经尝试编写的另一个程序中重构的代码。

**注意：**它在 C++ 中（对不起，这是我所拥有的）。此外，它只处理恒定比特率的 MPEG 1 Audio Layer 3 文件。这*应该*涵盖大部分内容，但我不能保证它在所有情况下都能正常工作。希望这可以满足您的要求，并希望将其重构为 Python 比从头开始更容易。

```
// determines the duration, in seconds, of an MP3;
// assumes MPEG 1 (not 2 or 2.5) Audio Layer 3 (not 1 or 2)
// constant bit rate (not variable)

#include <iostream>
#include <fstream>
#include <cstdlib>

using namespace std;

//Bitrates, assuming MPEG 1 Audio Layer 3
const int bitrates[16] = {
         0,  32000,  40000,  48000,  56000,  64000,  80000,   96000,
    112000, 128000, 160000, 192000, 224000, 256000, 320000,       0
  };

//Intel processors are little-endian;
//search Google or see: http://en.wikipedia.org/wiki/Endian
int reverse(int i)
{
    int toReturn = 0;
    toReturn |= ((i & 0x000000FF) << 24);
    toReturn |= ((i & 0x0000FF00) << 8);
    toReturn |= ((i & 0x00FF0000) >> 8);
    toReturn |= ((i & 0xFF000000) >> 24);
    return toReturn;
}

//In short, data in ID3v2 tags are stored as
//"syncsafe integers". This is so the tag info
//isn't mistaken for audio data, and attempted to
//be "played". For more info, have fun Googling it.
int syncsafe(int i)
{
 int toReturn = 0;
 toReturn |= ((i & 0x7F000000) >> 24);
 toReturn |= ((i & 0x007F0000) >>  9);
 toReturn |= ((i & 0x00007F00) <<  6);
 toReturn |= ((i & 0x0000007F) << 21);
 return toReturn;     
}

//How much room does ID3 version 1 tag info
//take up at the end of this file (if any)?
int id3v1size(ifstream& infile)
{
   streampos savePos = infile.tellg(); 

   //get to 128 bytes from file end
   infile.seekg(0, ios::end);
   streampos length = infile.tellg() - (streampos)128;
   infile.seekg(length);

   int size;
   char buffer[3] = {0};
   infile.read(buffer, 3);
   if( buffer[0] == 'T' && buffer[1] == 'A' && buffer[2] == 'G' )
     size = 128; //found tag data
   else
     size = 0; //nothing there

   infile.seekg(savePos);

   return size;

}

//how much room does ID3 version 2 tag info
//take up at the beginning of this file (if any)
int id3v2size(ifstream& infile)
{
   streampos savePos = infile.tellg(); 
   infile.seekg(0, ios::beg);

   char buffer[6] = {0};
   infile.read(buffer, 6);
   if( buffer[0] != 'I' || buffer[1] != 'D' || buffer[2] != '3' )
   {   
       //no tag data
       infile.seekg(savePos);
       return 0;
   }

   int size = 0;
   infile.read(reinterpret_cast<char*>(&size), sizeof(size));
   size = syncsafe(size);

   infile.seekg(savePos);
   //"size" doesn't include the 10 byte ID3v2 header
   return size + 10;
}

int main(int argCount, char* argValues[])
{
  //you'll have to change this
  ifstream infile("C:/Music/Bush - Comedown.mp3", ios::binary);

  if(!infile.is_open())
  {
   infile.close();
   cout << "Error opening file" << endl;
   system("PAUSE");
   return 0;
  }

  //determine beginning and end of primary frame data (not ID3 tags)
  infile.seekg(0, ios::end);
  streampos dataEnd = infile.tellg();

  infile.seekg(0, ios::beg);
  streampos dataBegin = 0;

  dataEnd -= id3v1size(infile);
  dataBegin += id3v2size(infile);

  infile.seekg(dataBegin,ios::beg);

  //determine bitrate based on header for first frame of audio data
  int headerBytes = 0;
  infile.read(reinterpret_cast<char*>(&headerBytes),sizeof(headerBytes));

  headerBytes = reverse(headerBytes);
  int bitrate = bitrates[(int)((headerBytes >> 12) & 0xF)];

  //calculate duration, in seconds
  int duration = (dataEnd - dataBegin)/(bitrate/8);

  infile.close();

  //print duration in minutes : seconds
  cout << duration/60 << ":" << duration%60 << endl;

  system("PAUSE");
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-03-13T09:37:59.693

只需使用`mutagen`

```
$pip install mutagen 
```

在 python shell 中使用它：

```
from mutagen.mp3 import MP3
audio = MP3(file_path)
print audio.info.length 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-12T21:26:14.060

还可以看看 audioread（包括 ubuntu 在内的一些 linux 发行版有软件包），[https://github.com/sampsyo/audioread](https://github.com/sampsyo/audioread)

```
audio = audioread.audio_open('/path/to/mp3')
print audio.channels, audio.samplerate, audio.duration 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T06:43:57.970

您可以计算文件中的帧数。每个帧都有一个起始码，虽然我不记得起始码的确切值，而且我没有 MPEG 规范。每个帧都有一定的长度，对于 MPEG1 layer II，大约为 40ms。

这种方法适用于 CBR 文件（恒定比特率），而 VBR 文件的工作方式则完全不同。

从下面的文件：

对于第一层文件我们这个公式：

FrameLengthInBytes = (12 * 比特率 / 采样率 + 填充) * 4

对于第 II 层和第 III 层文件，请使用以下公式：

FrameLengthInBytes = 144 * 比特率 / 采样率 + 填充

[有关 MPEG 音频帧头的信息](http://mpgedit.org/mpgedit/mpeg_format/mpeghdr.htm)

# c++ - 您将如何对内存分配器进行单元测试？

> ID：119414
> 
> 赞同：7
> 
> 时间：2008-09-23T06:36:32.293
> 
> 标签：c++, c, unit-testing, testing

今天有很多人将单元测试作为开发的基础来推销。这甚至可能适用于面向算法的强例程。但是，您将如何进行单元测试，例如内存分配器（想想 malloc()/realloc()/free()）。生成满足指定接口的有效（但绝对无用）内存分配器并不难。但是如何为单元测试功能提供适当的上下文，这是绝对需要的，但不是合同的一部分：合并空闲块，在下一次分配时重用空闲块，将多余的空闲内存返回给系统，断言分配策略（例如first-fit) 确实受到尊重，等等。

我的经验是断言，即使复杂且耗时（例如遍历整个空闲列表以检查不变量）也比单元测试更可靠，尤其是。在编写复杂的、时间相关的算法时。

有什么想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T07:16:06.660

高度可测试的代码的结构往往与其他代码不同。

您描述了您希望分配器执行的几个任务：

*   合并空闲块
*   在下一次分配中重用空闲块
*   将多余的可用内存返还给系统
*   断言分配策略（例如，首次匹配）确实受到尊重

虽然您可能将分配代码编写得非常耦合，例如在一个函数体中执行其中的几件事，但您也可以将每个任务分解为可测试的代码块。这几乎是您可能习惯的反转。我发现可测试的代码往往非常透明，并且由更多的小​​块构建而成。

接下来，我想说的是，任何类型的自动化测试都比没有自动化测试要好。我肯定会更多地关注确保你的测试做一些有用的事情，而不是担心你是否正确使用了模拟，你是否确保它被正确隔离以及它是否是一个真正的单元测试。这些都是令人钦佩的目标，有望使 99% 的测试变得更好。另一方面，请使用常识和您最好的工程判断来完成工作。

如果没有代码示例，我认为我不能更具体。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-23T06:44:07.267

**如果其中有任何逻辑，则可以对其进行单元测试。**
如果您的逻辑涉及做出决策和调用操作系统/硬件/系统 API，则伪造/模拟设备相关调用并对您的逻辑进行单元测试，以验证是否在给定的一组前提条件下做出了正确的决策。在单元测试中遵循 Arrange-Act-Assert 三元组。
断言不能替代自动化单元测试。他们不会告诉你哪个场景失败了，他们不会在开发过程中提供反馈，他们不能用来证明代码都满足了所有规范等等。

**非模糊更新：** 我不知道确切的方法调用。我想我会“自己动手”假设您的代码检查当前条件，做出决定并根据需要调用操作系统。假设您的操作系统调用是（您可能有更多）：

```
void* AllocateMemory(int size); 
bool FreeMemory(void* handle);
int MemoryAvailable(); 
```

首先把它变成一个界面，`I_OS_MemoryFacade`. 创建此接口的实现以对操作系统进行实际调用。现在让你的代码使用这个接口——你现在已经将你的代码/逻辑与设备/操作系统解耦了。接下来在你的单元测试中，你使用一个模拟框架（它的目的是给你一个指定接口的模拟实现。然后你可以告诉模拟框架**期望**这些调用被进行，这些参数并在它们发生时返回它在测试结束时，您可以要求模拟框架验证是否满足所有期望。（例如，在此测试中，应调用 AllocateMemory 三次，参数为 10、30、50，然后调用 3 次 FreeMemory。检查如果 MemoryAvailable 返回初始值。）
由于您的代码依赖于接口，因此它不知道真实实现与您用于测试的假/模拟实现之间的区别。谷歌出“模拟框架”以获取更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T06:43:16.723

这两件事都有自己的位置。使用单元测试来检查接口的行为是否符合预期，并使用断言来检查合同是否得到遵守。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T08:35:36.033

您可能还想包括性能测试、**压力测试**等。它们不会是单元测试，因为它会测试整个事情，但在内存分配器的情况下它们非常有价值。

**单元测试不排除这些类型的测试。**最好同时拥有它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T12:49:46.617

我也认为单元测试被高估了。它们有其用处，但真正提高程序质量的是对其进行审查。另一方面，我真的很喜欢断言，但它们并不能取代单元测试。

我不是在谈论同行评审，而是简单地重新阅读您编写的内容，可能同时使用调试器单步执行并检查每一行是否完成了它应该做的事情，这将使软件质量飙升。

我建议测试一大块功能而不是微小的方法调用的“高级”单元测试。后者往往会使任何代码更改变得极其痛苦和昂贵。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T06:54:37.180

就我个人而言，我发现大多数单元测试都像别人的愿望而不是我的愿望。我认为任何单元测试都应该像普通程序一样编写，除了它除了测试库/算法或代码的任何部分之外什么都不做。

我的单元测试通常不使用[CUnit](http://cunit.sourceforge.net/)、[CppUnit](http://cppunit.sourceforge.net/)和类似软件之类的工具。我创建自己的测试。例如，不久前，我需要在通常情况下测试容器的新实现是否存在内存泄漏。单元测试不足以提供一个好的测试。相反，我创建了自己的分配器，并使其在一定（可调整）数量的分配后无法分配内存，以查看我的应用程序在这些情况下是否存在内存泄漏（并且它有:)）。

单元测试如何做到这一点？更加努力地使您的代码适合单元测试“模式”。

所以我强烈建议不要每次都使用单元测试，因为它是“流行的”，但只有当它真的很容易与你喜欢测试的代码集成时才使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-24T12:55:00.750

单元测试不仅仅是为了确保您的代码正常工作。这也是一种非常好的设计方法。如前所述，为了使测试有用，代码需要尽可能地解耦，例如在需要的地方使用接口。

我并不总是先写测试，但通常如果我在开始做某事时遇到困难，我会写一个简单的测试，对设计进行试验，然后从那里开始。此外，好的单元测试可以作为好的文档。在工作中，当我需要查看如何使用特定类或类似类时，我会查看它的单元测试。

请记住，单元测试*不是*集成测试。单元测试确实有其局限性，但总的来说，我认为这是一个非常好的工具，可以知道如何正确使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-16T13:34:12.150

因此，您遇到了一个问题，即您的分配器被测试框架使用，这可能会在您尝试测试时导致分配器状态出现问题。考虑为分配器函数添加前缀（请参阅[dlmalloc](http://gee.cs.oswego.edu/pub/misc/malloc.c)）。你写

```
prefix_malloc();
prefix_free(); 
```

进而

```
#ifndef USE_PREFIX
#define prefix_malloc malloc
#define prefix_free free
#endif 
```

现在，将您的构建系统设置为使用 -DUSE_PREFIX 编译库的一个版本。编写单元测试以调用 prefix_malloc 和 prefix_free。这使您可以将分配器的状态与系统分配器的状态分开。

如果您正在使用 sbrk 并且系统分配器使用 sbrk 如果任一分配器假定它可以完全控制断点，那么您可能会遇到麻烦。在这种情况下，您需要链接另一个分配器，您可以将其配置为仅使用 mmap，以便您的分配器可以有断点。

# java - Jar 文件命名约定

> ID：119426
> 
> 赞同：23
> 
> 时间：2008-09-23T06:41:24.543
> 
> 标签：java, jar, naming-conventions

命名 jar 文件是否有任何行业标准约定？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-23T06:42:25.570

我一直在使用

```
*Informative*-*name*-*M*.*m*.*b*.jar 
```

在哪里：

*M* = `major version number`（在不一定保持向后兼容性时更改）

*m* = `minor version number`（功能添加等）

*b* = `build number`（对于包含错误修复的版本）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-20T08:45:03.603

如果您的 jar 用于 JEE，那么[这些准则](http://www.oracle.com/technetwork/java/namingconventions-139351.html)适用：

> 模块名称用作 EJB 归档名称。默认情况下，模块名称应基于包名称，并且应以全小写的 ASCII 字母书写。如果发生冲突，模块名称应该是更具体的版本（包括包名称的其他部分）：
> 
> EJB 存档：-ejb.jar
> 
> EJB 客户端存档：-ejb-client.jar

# javascript - 在服务器上记录客户端 JavaScript 错误

> ID：119432
> 
> 赞同：104
> 
> 时间：2008-09-23T06:43:11.747
> 
> 标签：javascript, logging, error-handling

我正在运行一个 ASP.NET 站点，我无法通过手动测试找到一些 JavaScript 错误。

是否有可能在客户端捕获所有 JavaScript 错误并将它们记录在服务器上，即在 EventLog 中（通过 Web 服务或类似的东西）？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-09-23T07:12:28.917

[您可以尝试为onerror 事件](http://developer.mozilla.org/En/DOM:window.onerror)设置自己的处理程序并使用 XMLHttpRequest 告诉服务器出了什么问题，但是由于它不是任何规范的一部分，因此[支持有点不稳定](http://www.quirksmode.org/dom/events/error.html)。

[这是使用 XMLHttpRequest 记录 JavaScript 错误](http://www.the-art-of-web.com/javascript/ajax-onerror/)的示例：

```
window.onerror = function(msg, url, line)
{
  var req = new XMLHttpRequest();
  var params = "msg=" + encodeURIComponent(msg) + '&amp;url=' + encodeURIComponent(url) + "&amp;line=" + line;
  req.open("POST", "/scripts/logerror.php");
  req.send(params);
}; 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-09-14T11:30:12.257

**简短的回答：**是的，这是可能的。

**更长的答案：**人们已经写过如何（至少部分地）通过编写自己的代码来解决这个问题。但是，请注意，似乎有一些服务可以确保所需的 JS 代码在许多浏览器中都能正常工作。我发现了以下内容：

*   [http://trackjs.com](http://trackjs.com)
*   [https://www.atatus.com](https://www.atatus.com)
*   [http://jserrlog.appspot.com](http://jserrlog.appspot.com)
*   [http://muscula.com](http://muscula.com)
*   [https://sentry.io](https://sentry.io)
*   [https://rollbar.com](https://rollbar.com)
*   [https://catchjs.com](https://catchjs.com)

我不能代表任何这些服务，因为我还没有尝试过。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-23T12:20:42.590

我刚刚在工作中的项目上实现了服务器端错误日志记录。旧代码和使用[jQuery](http://jquery.com/)的新代码混合在一起。

我`window.onerror`将 jQuery 事件处理程序和 onready 函数与错误处理函数结合使用并包装起来（请参阅：[JavaScript 错误跟踪：为什么 window.onerror 不够](http://blogs.cozi.com/tech/2008/04/javascript-error-tracking-why-windowonerror-is-not-enough.html)）。

*   `window.onerror`: 捕获 IE 中的所有错误（以及 Firefox 中的大多数错误），但在 Safari 和 Opera 中不执行任何操作。
*   jQuery 事件处理程序：捕获所有浏览器中的 jQuery 事件错误。
*   jQuery 就绪函数：捕获所有浏览器中的初始化错误。

一旦我发现了错误，我会添加一些额外的属性（url、浏览器等），然后使用 ajax 调用将其发布回服务器。

在服务器上，我有一个小页面，它只接受发布的参数并将它们输出到我们的普通服务器日志框架。

*我想为此开源代码（作为 jQuery 插件）。有兴趣的可以私信我，有利于说服老板！*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-15T21:26:06.197

如果您使用 Google Analytics，您可以将 javascript 错误记录到 Google Analytics 事件中。

看到这个应用程序：[http ://siteapps.com/app/log_javascript_errors_with_ga-181](http://siteapps.com/app/log_javascript_errors_with_ga-181)

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T06:46:00.837

您可能会通过 try/catch 对服务器进行 Ajax 调用，但这可能是您能做的最好的事情。

我可以建议 JavaScript 单元测试吗？可能与[JSUnit](https://github.com/pivotal/jsunit)一起使用？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T07:21:40.983

另外我推荐使用[TraceTool](http://tracetool.sourceforge.net/)实用程序，它带有 JavaScript 支持，对于 JS 监控非常方便。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T07:42:39.840

如果您想将客户端错误记录回服务器，您将不得不进行某种服务器处理。最好的办法是拥有一个可以通过 JavaScript (AJAX) 访问的 Web 服务，并将错误日志信息传递给它。

不是 100% 解决问题，因为如果问题出在托管 Web 服务的 Web 服务器上，您遇到了麻烦，您的另一种选择是通过查询字符串通过标准页面发送信息，一种方法这样做是通过动态生成图像标签（然后将其删除），因为浏览器将尝试加载图像的源。不过，它很好地绕过了跨域 JavaScript 调用。请记住，如果有人关闭了图像，您将遇到麻烦；）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-03T19:15:32.563

我最近一直在使用[Appfail](https://appfail.net/)，它可以捕获 asp.net 和 JavaScript 错误

# javascript - 使用 jQuery 突出显示一个单词

> ID：119441
> 
> 赞同：103
> 
> 时间：2008-09-23T06:45:58.277
> 
> 标签：javascript, jquery, html

我基本上需要突出显示文本块中的特定单词。例如，假设我想在此文本中突出显示“dolor”一词：

```
<p>
    Lorem ipsum dolor sit amet, consectetuer adipiscing elit.
</p>
<p>
    Quisque bibendum sem ut lacus. Integer dolor ullamcorper libero.
    Aliquam rhoncus eros at augue. Suspendisse vitae mauris.
</p> 
```

如何将上述内容转换为以下内容：

```
<p>
    Lorem ipsum <span class="myClass">dolor</span> sit amet, consectetuer adipiscing elit.
</p>
<p>
    Quisque bibendum sem ut lacus. Integer <span class="myClass">dolor</span> ullamcorper
    libero. Aliquam rhoncus eros at augue. Suspendisse vitae mauris.
</p> 
```

jQuery可以做到这一点吗？

**编辑**：正如[Sebastian所](https://stackoverflow.com/users/9535/sebastian-hoitz) [指出的](https://stackoverflow.com/questions/119441/highlight-a-word-with-jquery#119450)，如果没有 jQuery，这很可能 - 但我希望可能有一种特殊的 jQuery 方法，它可以让你在文本本身上做选择器。我已经在这个站点上大量使用 jQuery，所以将所有内容都包含在 jQuery 中可能会使事情变得更整洁。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-09-23T06:58:58.743

~~试试[highlight: JavaScript text highlighting jQuery plugin](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)。~~ **警告：此页面上可用的源代码包含加密货币挖掘脚本，请使用以下代码或从从网站下载的脚本中删除挖掘脚本。**

```
/*

highlight v4

Highlights arbitrary terms.

<http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html>

MIT license.

Johann Burkard
<http://johannburkard.de>
<mailto:jb@eaio.com>

*/

jQuery.fn.highlight = function(pat) {
 function innerHighlight(node, pat) {
  var skip = 0;
  if (node.nodeType == 3) {
   var pos = node.data.toUpperCase().indexOf(pat);
   if (pos >= 0) {
    var spannode = document.createElement('span');
    spannode.className = 'highlight';
    var middlebit = node.splitText(pos);
    var endbit = middlebit.splitText(pat.length);
    var middleclone = middlebit.cloneNode(true);
    spannode.appendChild(middleclone);
    middlebit.parentNode.replaceChild(spannode, middlebit);
    skip = 1;
   }
  }
  else if (node.nodeType == 1 && node.childNodes && !/(script|style)/i.test(node.tagName)) {
   for (var i = 0; i < node.childNodes.length; ++i) {
    i += innerHighlight(node.childNodes[i], pat);
   }
  }
  return skip;
 }
 return this.length && pat && pat.length ? this.each(function() {
  innerHighlight(this, pat.toUpperCase());
 }) : this;
};

jQuery.fn.removeHighlight = function() {
 return this.find("span.highlight").each(function() {
  this.parentNode.firstChild.nodeName;
  with (this.parentNode) {
   replaceChild(this.firstChild, this);
   normalize();
  }
 }).end();
}; 
```

还可以尝试[原始脚本的“更新”版本](http://bartaz.github.com/sandbox.js/jquery.highlight.html)。

```
/*
 * jQuery Highlight plugin
 *
 * Based on highlight v3 by Johann Burkard
 * http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html
 *
 * Code a little bit refactored and cleaned (in my humble opinion).
 * Most important changes:
 *  - has an option to highlight only entire words (wordsOnly - false by default),
 *  - has an option to be case sensitive (caseSensitive - false by default)
 *  - highlight element tag and class names can be specified in options
 *
 * Usage:
 *   // wrap every occurrance of text 'lorem' in content
 *   // with <span class='highlight'> (default options)
 *   $('#content').highlight('lorem');
 *
 *   // search for and highlight more terms at once
 *   // so you can save some time on traversing DOM
 *   $('#content').highlight(['lorem', 'ipsum']);
 *   $('#content').highlight('lorem ipsum');
 *
 *   // search only for entire word 'lorem'
 *   $('#content').highlight('lorem', { wordsOnly: true });
 *
 *   // don't ignore case during search of term 'lorem'
 *   $('#content').highlight('lorem', { caseSensitive: true });
 *
 *   // wrap every occurrance of term 'ipsum' in content
 *   // with <em class='important'>
 *   $('#content').highlight('ipsum', { element: 'em', className: 'important' });
 *
 *   // remove default highlight
 *   $('#content').unhighlight();
 *
 *   // remove custom highlight
 *   $('#content').unhighlight({ element: 'em', className: 'important' });
 *
 *
 * Copyright (c) 2009 Bartek Szopka
 *
 * Licensed under MIT license.
 *
 */

jQuery.extend({
    highlight: function (node, re, nodeName, className) {
        if (node.nodeType === 3) {
            var match = node.data.match(re);
            if (match) {
                var highlight = document.createElement(nodeName || 'span');
                highlight.className = className || 'highlight';
                var wordNode = node.splitText(match.index);
                wordNode.splitText(match[0].length);
                var wordClone = wordNode.cloneNode(true);
                highlight.appendChild(wordClone);
                wordNode.parentNode.replaceChild(highlight, wordNode);
                return 1; //skip added node in parent
            }
        } else if ((node.nodeType === 1 && node.childNodes) && // only element nodes that have children
                !/(script|style)/i.test(node.tagName) && // ignore script and style nodes
                !(node.tagName === nodeName.toUpperCase() && node.className === className)) { // skip if already highlighted
            for (var i = 0; i < node.childNodes.length; i++) {
                i += jQuery.highlight(node.childNodes[i], re, nodeName, className);
            }
        }
        return 0;
    }
});

jQuery.fn.unhighlight = function (options) {
    var settings = { className: 'highlight', element: 'span' };
    jQuery.extend(settings, options);

    return this.find(settings.element + "." + settings.className).each(function () {
        var parent = this.parentNode;
        parent.replaceChild(this.firstChild, this);
        parent.normalize();
    }).end();
};

jQuery.fn.highlight = function (words, options) {
    var settings = { className: 'highlight', element: 'span', caseSensitive: false, wordsOnly: false };
    jQuery.extend(settings, options);

    if (words.constructor === String) {
        words = [words];
    }
    words = jQuery.grep(words, function(word, i){
      return word != '';
    });
    words = jQuery.map(words, function(word, i) {
      return word.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&");
    });
    if (words.length == 0) { return this; };

    var flag = settings.caseSensitive ? "" : "i";
    var pattern = "(" + words.join("|") + ")";
    if (settings.wordsOnly) {
        pattern = "\\b" + pattern + "\\b";
    }
    var re = new RegExp(pattern, flag);

    return this.each(function () {
        jQuery.highlight(this, re, settings.element, settings.className);
    });
}; 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-09-23T10:03:12.157

```
function hiliter(word, element) {
    var rgxp = new RegExp(word, 'g');
    var repl = '<span class="myClass">' + word + '</span>';
    element.innerHTML = element.innerHTML.replace(rgxp, repl);
}
hiliter('dolor'); 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2015-09-24T10:08:55.547

# 为什么使用自制的突出显示功能是个坏主意

从头开始构建自己的突出显示功能可能不是一个好主意，因为您肯定会遇到其他人已经解决的问题。挑战：

*   您需要删除带有 HTML 元素的文本节点以突出显示您的匹配项，而不会破坏 DOM 事件并一遍又一遍地触发 DOM 重新生成（例如，就是这种情况`innerHTML`）
*   如果要删除突出显示的元素，则必须删除 HTML 元素及其内容，并且还必须组合拆分的文本节点以进行进一步搜索。这是必要的，因为每个荧光笔插件都会在文本节点内搜索匹配项，如果您的关键字将被拆分为多个文本节点，它们将不会被找到。
*   您还需要构建测试以确保您的插件在您没有考虑过的情况下工作。我说的是跨浏览器测试！

听起来很复杂？如果您想要一些功能，例如忽略突出显示中的某些元素、变音符号映射、同义词映射、iframe 内搜索、分隔词搜索等，这将变得越来越复杂。

# 使用现有插件

使用现有的、良好实现的插件时，您不必担心上述命名的事情。Sitepoint 上的文章**[10 jQuery text highlighter plugins比较了流行的荧光笔插件。](https://www.sitepoint.com/10-jquery-text-highlighter-plugins/)**这包括这个问题的答案插件。

# 看看[mark.js](https://markjs.io/)

[mark.js](https://markjs.io/)就是这样一个用纯 JavaScript 编写的插件，但也可以作为 jQuery 插件使用。它的开发目的是提供比其他插件更多的机会，并提供以下选项：

*   单独搜索关键字而不是完整的术语
*   地图变音符号（例如，如果“justo”也应该匹配“justò”）
*   忽略自定义元素内的匹配项
*   使用自定义突出显示元素
*   使用自定义突出显示类
*   映射自定义同义词
*   也在 iframe 内搜索
*   收到未找到的条款

**[演示](https://markjs.io/configurator.html)**

或者你可以看到[这个 fiddle](https://jsfiddle.net/julmot/vpav6tL1/)。

**用法示例**：

```
// Highlight "keyword" in the specified context
$(".context").mark("keyword");

// Highlight the custom regular expression in the specified context
$(".context").markRegExp(/Lorem/gmi); 
```

它是在 GitHub 上免费开发的开源软件（[项目参考](https://github.com/julmot/mark.js)）。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-04-20T15:49:46.317

这是一个忽略并保留大小写的变体：

```
jQuery.fn.highlight = function (str, className) {
    var regex = new RegExp("\\b"+str+"\\b", "gi");

    return this.each(function () {
        this.innerHTML = this.innerHTML.replace(regex, function(matched) {return "<span class=\"" + className + "\">" + matched + "</span>";});
    });
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-06-25T08:54:25.933

[JSFiddle](https://jsfiddle.net/vanpeer/kdahpLck/)

使用`.each()`, `.replace()`, `.html()`. 使用 jQuery 1.11 和 3.2 测试。

在上面的示例中，读取要突出显示的 'keyword' 并将 span 标记附加到 'highlight' 类。文本“关键字”在`.each()`.

HTML

```
<body>
   <label name="lblKeyword" id="lblKeyword" class="highlight">keyword</label>
   <p class="filename">keyword</p>
   <p class="content">keyword</p>
   <p class="system"><i>keyword</i></p>
</body> 
```

JS

```
$(document).ready(function() {
   var keyWord = $("#lblKeyword").text(); 
   var replaceD = "<span class='highlight'>" + keyWord + "</span>";
   $(".system, .filename, .content").each(function() {
      var text = $(this).text();
      text = text.replace(keyWord, replaceD);
      $(this).html(text);
   });
}); 
```

CSS

```
.highlight {
    background-color: yellow;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-06-01T09:07:56.197

你可以使用我的高亮插件[jQuiteLight](https://github.com/iamwebdesigner/jQuiteLight)，它也可以使用正则表达式。

**要使用[npm](http://npmjs.com)类型安装：**

```
npm install jquitelight --save 
```

**要使用[凉亭](http://bower.io)类型安装：**

```
bower install jquitelight 
```

**用法：**

```
// for strings
$(".element").mark("query here");
// for RegExp
$(".element").mark(new RegExp(/query h[a-z]+/)); 
```

**更高级的用法[在这里](https://github.com/iamwebdesigner/jQuiteLight#advanced-usage-tricks)**

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-03-01T01:26:13.133

您可以使用以下**功能**突出显示文本中的任何单词。

```
function color_word(text_id, word, color) {
    words = $('#' + text_id).text().split(' ');
    words = words.map(function(item) { return item == word ? "<span style='color: " + color + "'>" + word + '</span>' : item });
    new_words = words.join(' ');
    $('#' + text_id).html(new_words);
    } 
```

只需*定位包含文本的元素*，选择要着色*的单词和选择的**颜色*。

这是一个**例子**：

```
<div id='my_words'>
This is some text to show that it is possible to color a specific word inside a body of text. The idea is to convert the text into an array using the split function, then iterate over each word until the word of interest is identified. Once found, the word of interest can be colored by replacing that element with a span around the word. Finally, replacing the text with jQuery's html() function will produce the desired result.
</div> 
```

**用法**，

```
color_word('my_words', 'possible', 'hotpink') 
```

[![在此处输入图像描述](https://i.stack.imgur.com/Ht1Ai.png)](https://i.stack.imgur.com/Ht1Ai.png)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-23T06:49:12.263

您需要获取 p 标签的内容并将其中的所有 dolors 替换为突出显示的版本。

您甚至不需要为此使用 jQuery。:-)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-21T16:12:53.620

我编写了一个非常简单的函数，它使用 jQuery 来迭代使用 .highlight 类包装每个关键字的元素。

```
function highlight_words(word, element) {
    if(word) {
        var textNodes;
        word = word.replace(/\W/g, '');
        var str = word.split(" ");
        $(str).each(function() {
            var term = this;
            var textNodes = $(element).contents().filter(function() { return this.nodeType === 3 });
            textNodes.each(function() {
              var content = $(this).text();
              var regex = new RegExp(term, "gi");
              content = content.replace(regex, '<span class="highlight">' + term + '</span>');
              $(this).replaceWith(content);
            });
        });
    }
} 
```

更多信息：

[http://www.hawkee.com/snippet/9854/](http://www.hawkee.com/snippet/9854/)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-10-12T20:14:34.963

**我已经创建了一个类似概念的[存储库](https://github.com/abe312/colors.js)，它改变了 html5 识别颜色的文本的颜色（我们不必使用实际的#rrggbb 值，可以只使用 html5 标准化的名称，其中大约 140 个）**

***[颜色.js](https://github.com/abe312/colors.js)*** [![颜色.js](https://i.stack.imgur.com/6W9eB.png)](https://i.stack.imgur.com/6W9eB.png)

```
$( document ).ready(function() {

	function hiliter(word, element) {
		var rgxp = new RegExp("\\b" + word + "\\b" , 'gi'); // g modifier for global and i for case insensitive 
		var repl = '<span class="myClass">' + word + '</span>';
		element.innerHTML = element.innerHTML.replace(rgxp, repl);

			};

	hiliter('dolor', document.getElementById('dolor'));
});
```

```
.myClass{

background-color:red;
}
```

```
<!DOCTYPE html>
<html>
	<head>
		<title>highlight</title>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

		 <link href="main.css" type="text/css"  rel="stylesheet"/>

	</head>
	<body id='dolor'>
<p >
    Lorem ipsum dolor sit amet, consectetuer adipiscing elit.
</p>
<p>
    Quisque bibendum sem ut lacus. Integer dolor ullamcorper libero.
    Aliquam rhoncus eros at augue. Suspendisse vitae mauris.
</p>
 <script type="text/javascript" src="main.js" charset="utf-8"></script>
	</body>
</html>
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-01-02T02:39:00.787

是否有可能得到上面的例子：

```
jQuery.fn.highlight = function (str, className)
{
    var regex = new RegExp(str, "g");

    return this.each(function ()
    {
        this.innerHTML = this.innerHTML.replace(
            regex,
            "<span class=\"" + className + "\">" + str + "</span>"
        );
    });
}; 
```

不要替换 html-tags 中的文本，否则会破坏页面。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2015-11-05T13:06:37.897

```
$(function () {
    $("#txtSearch").keyup(function (event) {
        var txt = $("#txtSearch").val()
        if (txt.length > 3) {
            $("span.hilightable").each(function (i, v) {
                v.innerHTML = v.innerText.replace(txt, "<hilight>" + txt + "</hilight>");
            });

        }
    });
}); 
```

[小提琴](https://jsfiddle.net/xs019c6z/)在这里

# git - 使用 git 版本控制系统锁定二进制文件

> ID：119444
> 
> 赞同：76
> 
> 时间：2008-09-23T06:46:41.270
> 
> 标签：git, version-control, binaryfiles, dvcs

一年半以来，我一直在关注 git 社区，希望能够摆脱 SVN。阻碍我的一个特殊问题是无法锁定二进制文件。在过去的一年里，我还没有看到这个问题的进展。我知道锁定文件违背了分布式源代码控制的基本原则，但我不知道当存在二进制文件冲突的可能性时，Web 开发公司如何利用 git 来跟踪源代码和图像文件的更改。

为了达到锁定的效果，必须确定一个“中央”存储库。不管 git 的分布式特性如何，大多数公司都会有一个软件项目的“中央”存储库。我们应该能够将文件标记为需要从指定地址的管理 git 存储库中锁定。也许这很困难，因为 git 跟踪文件内容而不是文件？

你们有没有处理过修改前应该锁定的 git 和二进制文件的经验？

注意：Source Gear 的新开源分布式版本控制项目 Veracity 似乎将锁定作为其目标之一。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-06-13T11:59:12.480

Subversion 有锁，它们不仅仅是建议性的。它们可以使用`svn:needs-lock`属性强制执行（但也可以在必要时故意破坏）。这是管理不可合并文件的正确解决方案。我工作的公司几乎存储了 Subversion 中的所有内容，并`svn:needs-lock`用于所有不可合并的文件。

我不同意“锁只是一种交流方式”。它们是比电话或电子邮件等推送通知更有效的方法。Subversion 锁是自记录的（谁拥有锁）。另一方面，如果您必须通过其他传统的推送通知渠道（例如电子邮件）进行通信，您会将通知发送给谁？除非您拥有整个开发团队的完整列​​表，否则您事先不知道谁可能想要编辑该文件，尤其是在开源项目中。所以那些传统的沟通方法几乎没有那么有效。

中央锁服务器虽然违反了 DVCS 的原则，但对于不可合并的文件来说是唯一可行的方法。只要 DVCS 没有中央锁定功能，我认为它会让我工作的公司继续使用 Subversion。

更好的解决方案是为所有二进制文件格式制作一个合并工具，但这是一个永远不会“完成”的长期和持续目标。

[这是有关该主题的有趣读物。](http://reddit.com/comments/6o8tt/do_you_use_a_dvcs_how_do_you_deal_with_binary)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-23T07:26:20.927

我同意锁定二进制文件是某些环境的必要功能。不过，我只是想到了如何实现这一点：

*   有一种将文件标记为“needs-lock”的方法（如“svn:needs-lock”属性）。
*   在结帐时，git 会将此类文件标记为只读。
*   一个新命令`git-lock`将联系在某处运行的中央锁服务器以请求锁定权限。
*   如果锁定服务器授予权限，则将文件标记为读写。
*   `git-add`将通知锁定服务器锁定文件的内容哈希。
*   锁定服务器将监视该内容哈希是否出现在主存储库的提交中。
*   当哈希出现时，释放锁。

这是一个非常不成熟的想法，到处都有潜在的漏洞。它也违背了 git 的精神，但它在某些情况下肯定是有用的。

在一个特定的组织中，这种事情也许可以使用脚本包装器和提交钩子的适当组合来构建。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-26T17:49:50.423

为了回应马里奥对二进制文件多个位置发生变化的额外担忧。所以场景是 Alice 和 Bob 同时对同一个二进制资源进行更改。他们每个人都有自己的本地仓库，从一个中央远程克隆。

这确实是一个潜在的问题。所以 Alice 先完成并推送到中央`alice/update`分支。通常，当这种情况发生时，Alice 会宣布应该对其进行审查。Bob 看到并对其进行了审查。他可以 (1) 自己将这些更改合并到他的版本中（从该版本分支`alice/update`并对其进行更改）或 (2) 将他自己的更改发布到`bob/update`. 他再次宣布。

现在，如果 Alice 改为`master`push ，Bob 在拉`master`并试图合并到他的本地分支时会进退两难。他与爱丽丝的冲突。但同样，同样的程序可以适用于不同的分支。即使 Bob 忽略了所有的警告并提交了 Alice 的，也总是有可能撤回 Alice 的提交来修复问题。这变成了一个简单的沟通问题。

由于（AFAIK）Subversion 锁只是建议性的，因此电子邮件或即时消息可以达到相同的目的。但即使你不这样做，Git 也会让你修复它。

不，本身没有锁定机制。但是锁定机制往往只是良好沟通的替代品。我相信这就是 Git 开发人员没有添加锁定机制的原因。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-04-26T03:05:45.250

[Git LFS 2.0](https://github.com/blog/2328-git-lfs-2-0-0-released)增加了对文件锁定的支持。

> 使用 Git LFS 2.0.0，您现在可以锁定您正在积极处理的文件，防止其他人推送到 Git LFS 服务器，直到您再次解锁文件。
> 
> 这将防止合并冲突以及在文件系统级别丢失不可合并文件的工作。虽然这似乎与 Git 的分布式和并行特性相矛盾，但文件锁定是许多软件开发工作流程的重要组成部分——尤其是对于使用二进制资产的大型团队而言。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-24T06:22:07.920

我们最近才开始使用 Git（之前使用过 Subversion），我发现对工作流程的更改可能有助于解决您的问题，而无需锁定。它利用了 git 的设计方式和分支的简单性。

基本上，它归结为推送到非主分支，对该分支进行审查，然后合并到主分支（或任何目标分支）。

git 是“打算”使用的方式，每个开发人员发布他们自己的公共存储库，他们要求其他人从中提取。我发现 Subversion 用户对此有问题。因此，相反，我们推送到中央存储库中的分支树，每个用户都有自己的分支树。例如，这样的层次结构可能会起作用：

```
users/a/feature1
users/a/feature2
users/b/feature3
teams/d/featurey 
```

随意使用您自己的结构。注意我还展示了主题分支，另一个常见的 git 习惯用法。

然后在用户 a 的本地存储库中：

```
feature1
feature2 
```

并将其发送到中央服务器（来源）：

```
git push origin feature1:users/a/feature1 
```

（这可能可以通过配置更改来简化）

无论如何，一旦 feature1 被审查，谁负责（在我们的例子中，它是功能的开发者，你可以让一个用户负责合并到 master），执行以下操作：

```
git checkout master
git pull
git merge users/name/feature1
git push 
```

拉取（拉取任何新的主更改*和*功能分支）并将主更新到中央存储库所拥有的内容。如果用户 a 完成了他们的工作并正确跟踪了 master，则合并应该没有问题。

所有这一切意味着，即使用户或远程团队对二进制资源进行了更改，它也会在合并到主分支之前得到审查。并且有一个清晰的描述（基于流程）关于什么时候进入主分支。

你也可以使用 git hooks 以编程方式强制执行这些方面，但同样，我还没有使用过这些，所以不能谈论它们。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-23T07:05:37.747

值得检查您当前的工作流程，看看是否真的需要锁定图像。两个人独立编辑图像是相对不寻常的，一点沟通可以走很长的路。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-23T20:59:52.407

当我使用 Subversion 时，我虔诚`svn:needs-lock`地为所有二进制文件甚至是难以编辑的文本文件设置了该属性。我实际上*从未*经历过任何冲突。

现在，在 Git 中，我不担心这些事情。请记住：Subversion 中的锁实际上并不是强制锁，它们只是通信工具。你猜怎么着：我不需要 Subversion 来沟通，我可以很好地处理电子邮件、电话和 IM。

我做的另一件事是用纯文本格式替换许多二进制格式。我使用 reStructuredText 或 LaΤ ΕΧ[代替]Word，CSV 代替 Excel，ASCII-Art 代替 Visio，YAML 代替数据库，SVG 代替 OO Draw，abc 代替 MIDI，等等。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-26T17:19:00.747

我已经在 git 讨论组上讨论过这个问题，并且得出的结论是，目前还**没有**就 git 集中文件锁定的方法达成一致。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-23T07:00:30.223

我不希望文件锁定成为 git 中的一项功能。您主要对哪种二进制文件感兴趣？您是否真的对锁定文件感兴趣，或者只是防止由于无法合并它们而引起的冲突。

我似乎记得有人谈论（甚至实现）在 git 中合并 OpenOffice 文档的支持。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-10-07T19:03:54.987

这不是一个解决方案，而是对为什么需要锁定机制的评论。在某些领域中使用了一些仅使用二进制格式的工具，这些格式对于任务至关重要，并且“使用更好/不同的工具”不是一种选择。没有可行的替代工具。即使您以 ascii 格式存储相同的信息，我熟悉的那些也不会成为合并的候选者。我听到的一个反对意见是您希望能够离线工作。我正在考虑的特定工具无论如何都不能离线工作，因为需要提取许可证，所以如果我在笔记本电脑上有数据，无论如何我都不能在火车上运行该工具。也就是说，如果我的连接速度很慢，git 会提供什么，我可以获得许可证并下拉更改，但拥有快速的本地副本来查看不同的版本。即使在这种情况下，这也是 DVCS 为您提供的一件好事。

一种观点是 git 根本不是要使用的工具，但它对所有使用它管理的文本文件都很好，而且需要为不同的文件使用不同的版本控制工具很烦人。

那种通过邮件锁定咨询的方法真的很臭。我已经看到了这一点，并且已经厌倦了源源不断的“我正在编辑它”“我已经完成编辑”的电子邮件，并且看到了因此而丢失的更改。我正在考虑的特殊情况是一组较小的 ascii 文件会更好，但这是一个问题。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-09-01T15:58:05.473

cad文件呢？如果文件未锁定，也保持只读状态，大多数 cad 程序只会打开它们更改任意位，任何 vcs 都将其视为新文件。因此，在我看来，锁定是传达您打算更改某些特定文件的理想方式。同样，它首先会阻止某些软件获得写入权限。这允许更新本地文件，而无需关闭软件或至少完全关闭所有文件。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-02-13T10:24:49.503

TortoiseGit 支持 Office 文档的完整 git 工作流，将差异委托给 Office 本身。它还可以将 OpenDocument 格式委托给 OpenOffice。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-12-29T21:37:14.387

我不建议在我的公司使用 git 来解决同样的问题。我们所有的设计都使用 EA，文档使用 microsoft word，我们事先不知道谁可以编辑特定文件，因此排他锁定是我们唯一的选择。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-01-06T18:02:42.790

git 在每个开发人员单独负责一段代码或文件的非团队环境中工作得很好，因为在这种情况下不需要关于锁的通信。

如果你的组织需要团队环境（通常是为了剥夺开发人员的工作保障），那么使用 svn，git 不适合你。Svn 提供了源代码控制和开发人员之间关于锁的通信。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-12-04T05:44:10.090

只需在 cc 中放入一个文本文件，其中包含您要锁定的文件，然后让更新挂钩拒绝它。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-05-18T07:31:32.733

重组项目有助于避免锁定可能是真的，但是：

*   团队还按其他优先级（位置、客户……）进行组织
*   其他目标也选择工具（兼容性、价格、大多数员工的易用性）
*   一些工具（因此存在二进制文件）是不可避免的，因为根本没有替代品可以完成相同的工作，以相同的价格满足公司的需求。

要求整个公司重新组织他们的工作流程并替换他们所有生成二进制文件的工具，只为了能够使用 git，因为没有锁，这听起来效率很低。

锁不符合 git 哲学（从来没有为二进制文件设计过），但在某些不可忽视的情况下，锁是解决此类问题的最有效方法。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2016-05-08T15:26:43.900

Git 没有提供任何锁定文件的命令，但我已经资助了一种使用 git 挂钩来实现该功能的方法。需要一个辅助服务器来存储锁信息。我们可以使用预提交挂钩来检查是否有任何已提交的文件被锁定。如果有人锁定了一个文件，程序应该告诉辅助服务器锁的信息和被锁定的文件。

# osx-leopard - 如何在 Quartz Composer 中使视频或图片的背景清晰？

> ID：119462
> 
> 赞同：1
> 
> 时间：2008-09-23T06:55:08.737
> 
> 标签：osx-leopard, composite, quartz-composer

我想从附加到精灵的图片中删除所有黑色，使其变得透明。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T20:21:43.923

如果链接失效，我将复制并粘贴：

*" 我使用了一个 'Color Matrix' 补丁，将 'Alpha Vector (W)' 和 'Bias Vector(X,Y,Z)' 设置为 1，其他设置为 0。然后您将在输入图像中找到 alpha 通道输出。”*

我以前发现过这个，但我不知道该怎么做。

我找到了另一个使用核心图像过滤器的解决方案：

```
kernel vec4 darkToTransparent(sampler image)
{
  vec4 color = sample(image, samplerCoord(image));
  color.a = (color.r+color.g+color.b) > 0.005 ? 1.0:0.;
  return color;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T23:08:10.757

这看起来可以解决问题：

[http://www.quartzcompositions.com/phpBB2/viewtopic.php?t=281](http://www.quartzcompositions.com/phpBB2/viewtopic.php?t=281)

# asp.net-mvc - 你如何构建你的 URL 路由？

> ID：119467
> 
> 赞同：8
> 
> 时间：2008-09-23T06:57:04.757
> 
> 标签：asp.net-mvc, url, routing

是否有开发人员通常遵循的特定模式？我以前在我的 Web 应用程序中从未真正考虑过它，但是 ASP.NET MVC 路由引擎几乎迫使您至少考虑到它。

到目前为止，我喜欢控制器/动作/索引结构（例如 Products/Edit/1），但我正在努力处理更复杂的 url。

例如，假设您有一个页面，其中列出了用户在其帐户中拥有的所有产品。你会怎么做？在我的脑海中，我可以想到列表页面和编辑页面的以下可能性：

1.  用户/{用户 ID}/产品/列表，用户/{用户 ID}/产品/编辑/{产品 ID}
2.  用户/{用户 id}/产品，用户/{用户 id}/产品/{产品 id}
3.  Products?UserID={user id}, Products/Edit/{product id}

我敢肯定还有很多其他我想念的。有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-23T21:14:19.313

我喜欢 RESTful、用户友好和可破解的 URL。

这是什么意思？让我们从*用户友好的 URL*开始。对我来说，用户友好的 URL 是易于键入且易于记忆`/Default.aspx?action=show&userID=140`的内容，但不满足任何这些要求。不过，像 `/users/troethom´ 这样的 URL 似乎是合乎逻辑的。

这导致了下一点。可*破解 URL*是用户可以修改并仍会显示结果的 URL。如果 URL 是可破解的并且我的个人资料的 URL`/users/troethom`是安全的，则删除我的用户名以获取用户列表 ( `/users`) 是安全的。

使用*RESTful URL*与我的其他建议背后的想法非常相似。您正在为用户而不是为机器设计 URL，因此 URL 必须与内容相关，而不是与网站的技术后端相关。'/users' 的 URL 比 '/users/list' 和 '/category/programming/javascript' 的 URL 更有意义（在 'programming' 类别中表示子类别 'javascript' 比 '/category/show 更好/12'。

省略 ID 确实更难，但在我的世界里，这是值得的。

另请参阅有关 W3C 的常见 HTTP 实现问题[的理解 URI 部分。](http://www.w3.org/TR/chips/#uri)它列出了设计 URI 时的常见陷阱。另一个很好的资源是[Resourceful Vs Hackable Search URLs](http://morethanseven.net/2008/04/18/resourceful-vs-hackable-search-urls/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T07:04:10.837

您可能想看看“[友好的 url 方案？](https://stackoverflow.com/questions/112695/friendly-url-scheme) ”这个问题。

特别是，[Larry.Smithmier 的回答](https://stackoverflow.com/questions/112695/friendly-url-scheme#112706)提供了在 ASP.NET 中使用 MVC 时的常见 URL 方案列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T07:21:38.987

此外，您可以考虑使用不同的动词来为不同的操作重用相同的路线。例如，对“Products/Edit/45”的 GET 请求将显示产品编辑器，而对同一 url 的 POST 将更新产品。您可以使用 AcceptVerb 属性来完成此操作：

```
[AcceptVerb("GET")]
public ActionResult Edit(int id)
{
    ViewData["Product"] = _products.Get(id);
    return View();
}

[AcceptVerb("POST")]
public ActionResult Edit(int id, string title, string description)
{
    _products.Update(id, title, description);
    TempData["Message"] = "Changes saved successfully!";

    return RedirectToAction("Edit", new { id });
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T08:10:20.960

Bill de hÓra 写了一篇非常好的文章，题为“[框架的 Web 资源映射标准”](http://www.dehora.net/journal/2007/08/web_resource_mapping_criteria_for_frameworks.html)，非常值得一读。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T07:38:13.697

要添加到 troethom 的评论中，RESTful 通常还意味着，例如，要创建一个新用户，您可以将一个表示放入 /users/newusername

RESTful 基本上使用 5 种标准 HTTP 方法（GET、PUT、POST、DELETE、HEAD）来控制/访问内容。

好的，这对于网络浏览器来说并不容易，但是您始终可以使用重载的 POST（发布到 /users/username 并代表用户更改一些细节等）。

这是一种很好的做事方式，我建议阅读[RESTFul Web 服务](https://rads.stackoverflow.com/amzn/click/com/0596529260)以获得更好的理解：D（这是一本非常好的书！）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-26T18:01:52.843

我已经看到了两种主要接受的方法来处理这个话题......

一种在[MvcContrib 项目文档中描述](http://www.codeplex.com/MVCContrib/Wiki/View.aspx?title=SimplyRestfulRouting&referringTitle=Documentation)

and the other one is described in a [blog post by Stephen Walther](http://weblogs.asp.net/stephenwalther/archive/2008/06/27/asp-net-mvc-tip-11-use-standard-controller-action-names.aspx) (which I personally prefer).

# windows - 是否可以在 Windows 中创建全屏颜色叠加效果？

> ID：119471
> 
> 赞同：5
> 
> 时间：2008-09-23T06:58:23.207
> 
> 标签：windows, colors, overlay

我记得我的旧 Radeon 图形驱动程序有许多叠加效果或滤色器（不管它们叫什么），它们会将屏幕渲染为棕褐色调或负色。我目前的 NVIDIA 卡似乎没有这样的功能，所以我想知道是否可以为 Vista 制作自己的卡。

我不知道是否有某种方法可以连接到窗口的渲染引擎，或者连接到 NVIDIA 的驱动程序来实现这种效果。虽然只能够修改颜色会很酷，但根据屏幕坐标修改颜色或执行其他更多样化的功能会更好。一个例子是颜色越不饱和，它们离屏幕中心越远。

我没有具体的使用场景，所以我无法提供更多信息。基本上，我只是好奇在这方面是否有任何工作要做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T08:31:07.417

您可以在所有内容之上有一个全屏[分层窗口](http://msdn.microsoft.com/en-us/library/ms997507.aspx)并通过单击事件。但是与通过在[WDM](http://en.wikipedia.org/wiki/Windows_Driver_Model)渲染器的 DirectX 上下文中获取挂钩可以完成的操作*相比，这很麻烦而且很慢。*然而，到目前为止这是不可能的，因为微软没有为此提供任何公共接口。

不过，Flip 3D 实用程序会执行此操作，但即使该功能不在程序中，它也在 WDM DLL 中，由序号调用（显然是隐藏/未记录的函数，因为它没有任何其他用途）。所以几乎是另一个死胡同，我没有费心去深入挖掘。

在这方面，我们能做的最好的就是等待某种官方 API。

# sql-server-2005 - SQL Server 2005 / XML 存储过程 - Unicode 到 ascii？（异常 0xc00ce508）

> ID：119477
> 
> 赞同：0
> 
> 时间：2008-09-23T07:00:52.377
> 
> 标签：sql-server-2005, tsql, stored-procedures, unicode

我这里有一个 MSSQL2005 存储过程，它应该将 XML 消息作为输入，并将其内容存储到表中。表字段是 varchars，因为我们的 delphi 后端应用程序无法处理 unicode。现在，传入的消息采用 ISO-8859-1 编码。一切都很好，直到超过 128 个标准集的字符被包括在内（在这种情况下，ÄÖäö，它是芬兰语的一个组成部分）。这会导致数据库服务器引发异常 0xc00ce508。数据库的默认值以及表和字段的排序规则设置为 latin1，这应该与 ISO-8859-1 相同。

使用 XML 子系统解析 XML 消息，如下所示：

```
ALTER PROCEDURE [dbo].[parse] @XmlIn NVARCHAR(1000) AS
SET NOCOUNT ON
DECLARE @XmlDocumentHandle INT
DECLARE @XmlDocument VARCHAR(1000)
BEGIN
SET @XmlDocument = @XmlIn
EXECUTE sp_xml_preparedocument @XmlDocumentHandle OUTPUT, @XmlDocument
BEGIN TRANSACTION
//the xml message's fields are looped through here, and rows added or modified in two tables accordingly
// like ...
DECLARE TempCursor CURSOR FOR
SELECT AM_WORK_ID,CUSTNO,STYPE,REFE,VIN_NUMBER,REG_NO,VEHICLE_CONNO,READY_FOR_INVOICE,IS_SP,SMANID,INVOICENO,SUB_STATUS,TOTAL,TOTAL0,VAT,WRKORDNO
FROM OPENXML (@XmlDocumentHandle, '/ORDER_NEW_CP_REQ/ORDER_NEW_CUSTOMER_REQ',8)
WITH (AM_WORK_ID int '@EXIDNO',CUSTNO int '@CUSTNO',STYPE VARCHAR(1) '@STYPE',REFE VARCHAR(50) '@REFE',VIN_NUMBER VARCHAR(30) '@VEHICLE_VINNO',
REG_NO VARCHAR(20) '@VEHICLE_LICNO',VEHICLE_CONNO VARCHAR(30) '@VEHICLE_CONNO',READY_FOR_INVOICE INT '@READY_FOR_INVOICE',IS_SP INT '@IS_SP',
SMANID INT '@SMANID',INVOICENO INT '@INVOICENO',SUB_STATUS VARCHAR(1) '@SUB_STATUS',TOTAL NUMERIC(12,2) '@TOTAL',TOTAL0 NUMERIC(12,2) '@TOTAL0',VAT NUMERIC(12,2) '@VAT',WRKORDNO INT '@WRKORDNO')
OPEN TempCursor
FETCH NEXT FROM TempCursor
INTO @wAmWork,@wCustNo,@wType,@wRefe,@wVIN,@wReg,@wConNo,@wRdy,@wIsSp,@wSMan,@wInvoNo,@wSubStatus,@wTot,@wTot0,@wVat,@wWrkOrdNo
// ... etc
COMMIT TRANSACTION
EXECUTE sp_xml_removedocument @XmlDocumentHandle
END 
```

以前，存储过程使用 nvarchar 进行输入，但由于这会导致古老的后端应用程序（Delphi 5 + ODBC）出现问题，我们不得不将字段切换为 varchars，此时一切都崩溃了。

我还尝试在开始时将 nvarchar 转换为 varchar，但结果是一样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T11:45:46.793

我会回答我自己的问题，因为我设法解决了这个不仅仅是神秘的问题......

1) 存储过程必须反映转换的正确代码页：

```
@XmlIn NVARCHAR(2000)
@XmlDocument VARCHAR(2000)
SELECT @XmlDocument = @XmlIn COLLATE SQL_Latin1_General_CP1_CI_AS 
```

2) XML 输入必须指定相同的字符集：

```
<?xml version="1.0" encoding="ISO-8859-1" ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T19:21:24.073

我不知道是否有足够权限编辑答案的人会看到这一点，但是虽然答案是正确的，但我想补充一点，在不明确指定排序规则的情况下，在这种情况下将使用数据库的默认排序规则，因为它是隐式的分配给每个没有排序规则语句的 varchar 变量。

所以

```
DECLARE @XmlDocument VARCHAR(2000) COLLATE SQL_Latin1_General_CP1_CI_AS 
```

也应该这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T08:28:18.733

您提到的错误代码似乎来自 MSXML 库。那是怎么回事？根据您的问题，我假设您将 varchar 参数传递给存储过程，然后使用该参数插入或更新 varchar 列。

但是，这与您的异常代码不匹配，因此它必须发生在实际存储过程之外，或者您在存储过程中基于 xml 执行其他操作。

请检查并相应地修改您的问题。

# .net - 使用 .NET 3.0 中的自定义消息/格式化程序将安全标头导入 WCF 服务

> ID：119478
> 
> 赞同：0
> 
> 时间：2008-09-23T07:01:10.893
> 
> 标签：.net, asp.net, wcf, web-services, soap

我们继承了具有自定义 MessageFormatter 的 WCF Web 服务，该服务在 SerializeReply 方法中构造自定义 Message 子类。

```
class OurMessageFormatter : MessageFormatter
{
  public Message SerializeReply(MessageVersion messageVersion, object[] parameters, object result)
  {
    OurResponse ourResponse = (OurResponse) result;

    // some validation here...

    OurMessage reply = new OurMessage(ourResponse, MessageVersion.Soap11);
    return reply;
  }

} 
```

我们面临的问题是自定义 Message 子类不会填充任何标题。我们试图查看 WCF 是否会开箱即用地填充通用的（MessageID、ResponseTo、Action 等），但没有运气。然后我们意识到自定义 Message 子类已经实现了 Headers 属性，就像这样......

```
class OurMessage : Message
{
  public override MessageHeaders Headers
  {
    get { return new MessageHeaders(MessageVersion.Soap11WSAddressing10); }
  }
} 
```

......原来是很多帮助！所以我们把它改写成这样......

```
class OurMessage : Message
{
  MessageHeaders headers;

  public OurMessage()
  {
    // ...

    headers = new MessageHeaders(MessageVersion.Soap11WSAddressing10);
  }

  public override MessageHeaders Headers
  {
    get { return headers; }
  }
} 
```

......仍然没有运气。

所以我们继续对标题进行手动编码；首先在格式化程序中...

```
class OurMessageFormatter : MessageFormatter
{

  public Message SerializeReply(MessageVersion messageVersion, object[] parameters, object result)
  {
    //...

    OurMessage reply = new OurMessage(ourResponse, MessageVersion.Soap11);
    ourMessage.MessageID = ...;
    ourMessage.ResponseTo = ...;
    ourMessage.Action = ...;
    // more headers set ...

    return reply;
  }

} 
```

...然后在消息本身中...

```
class OurMessage : Message
{
  public override MessageHeaders Headers
  {
    get
    {
      MessageHeaders headers = new MessageHeaders(MessageVersion.Soap11WSAddressing10);
      ourMessage.MessageID = ...;
      ourMessage.ResponseTo = ...;
      ourMessage.Action = ...;
      // more headers set ...

      return headers;
    }
  }
} 
```

我们尝试的每一种方式，我们都设法将 WS-Addressing 标头放入实际响应中，但永远无法获得 WS-Security 标头（实际上我们只是试图放入带有 TimestampID 和 Created/Expires 元素的安全标头）。每次我们在 Security 标头中添加 Security 标头时，服务都会在序列化期间意外断开连接（在 SerializeReply 调用完成之后）。

所以这是我的问题。有谁知道如何使用自定义 Formatter 和自定义 Message 实现将 WS-Security 标头放入 WCF 服务？

**更新 [2008 年 11 月 26 日]**：我们有一个突出的 MS 事件，我们从他们那里得到的最新更新是 WCF 的当前 MessageVersion 似乎不支持这些标头，需要自定义绑定实现。调查仍在继续寻找更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T20:15:50.373

我注意到 MessageHeaders 类有一个[构造函数](http://msdn.microsoft.com/en-us/library/ms404951.aspx "MessageHeaders 构造函数")，它将 MessageHeaders 集合作为参数。也许您可以传递您需要查看它是否有效的完整标题集合。我以前没有使用过 WS-Security 标头，所以我不确定这对他们来说是否可行。我知道他们将在自己的命名空间（wsse：[http](http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd) ://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd ）中为消息头定义。

我发现这篇[文章](http://msdn.microsoft.com/en-us/magazine/cc163447.aspx)很好地概述了消息传递基础知识。它有一个关于创建标题的示例。

# c++ - Visual C++ 2008 和 2005 之间的区别

> ID：119492
> 
> 赞同：2
> 
> 时间：2008-09-23T07:06:37.260
> 
> 标签：c++, visual-studio, visual-studio-2008, visual-studio-2005, compiler-construction

我在 Microsoft 的网站上找不到任何有用的信息，所以这里有一个问题：Visual C++ 2008 中的编译器自 2005 版本以来是否得到了显着改进？我特别在寻找更好的优化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T07:08:43.260

直接从马嘴里......

> [http://msdn.microsoft.com/en-us/library/bb384632.aspx](http://msdn.microsoft.com/en-us/library/bb384632.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T07:12:33.143

[Somasegar在这篇](http://blogs.msdn.com/somasegar)[博](http://blogs.msdn.com/somasegar/archive/2007/09/27/vs-2008-performance-improvements.aspx)文中有一些注释。主要是关于[增量构建改进](http://blogs.msdn.com/vcblog/archive/2007/03/02/managed-incremental-build.aspx)和[多核改进](http://blogs.msdn.com/vcblog/archive/2007/03/12/multi-processor-builds-in-orcas.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T07:09:19.780

根据我们的一位高级开发人员的说法，VS2008 具有对多核编译的扩展支持（我被告知是文件方式而不是项目方式），因此您的项目可能会有合理的性能优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T07:13:14.747

你看过[这里](http://accidentaltechnologist.com/microsoft/visual-studio/visual-studio-2008-now-running-side-by-side-visual-studio-2005/)、[这里](http://www.vistax64.com/software/122645-visual-studio-2005-vs-2008-a.html)还是[这里](http://weblogs.asp.net/cschittko/archive/2007/10/08/visual-studio-2005-or-2008-what-s-more-risk.aspx)？

如果是，并且没有任何信息，您可以首先检查编译器版本（cl.exe）和链接器版本（link.exe），然后进行一些性能（优化测试），看看谁是赢家。

通常更新版本的 cl.exe 会更好。关于 Visual Studio 的 UserInterface（至少根据我的经验），不能提及相同的事情。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-23T07:10:15.770

根据我的经验，编译器优化在不同版本之间的改进很少超过百分之几。如果你真的需要更高的性能，那几个百分点就不会削减它 - 如果你想要更多，你将不得不在代码中陷入困境。

请记住，编译器非常愚蠢，通常可以被聪明的程序员智取；唯一的问题是它是否值得您花时间和精力这样做。如果您有一个占 CPU 时间 90% 的单核功能，那肯定是这样。如果运行时平均分布在一万行代码中，可能不会。

当然，如果你的速度问题是由于算法慢，没有编译器可以拯救你。

# c# - 构造函数中的虚拟成员调用

> ID：119506
> 
> 赞同：1405
> 
> 时间：2008-09-23T07:11:30.337
> 
> 标签：c#, constructor, warnings, resharper, virtual-functions

我从 ReSharper 收到关于从我的对象构造函数调用虚拟成员的警告。

为什么这是不应该做的事情？

* * *

## 回答 #1

> 赞同：1222
> 
> 时间：2008-09-23T07:21:13.747

当一个用 C# 编写的对象被构​​造时，会发生初始化程序从最派生类到基类的顺序运行，然后构造函数从基类到最派生类的顺序运行（[详见 Eric Lippert 的博客）至于为什么会这样](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/why-do-initializers-run-in-the-opposite-order-as-constructors-part-two)）。

同样在 .NET 中，对象在构造时不会更改类型，而是从最派生的类型开始，方法表是最派生的类型。这意味着虚拟方法调用总是在最派生的类型上运行。

当你结合这两个事实时，你会遇到一个问题，如果你在构造函数中调用虚方法，并且它不是继承层次结构中最派生的类型，它将在构造函数尚未被调用的类上调用。运行，因此可能不处于调用该方法的合适状态。

当然，如果您将类标记为密封以确保它是继承层次结构中最派生的类型，这个问题当然会得到缓解——在这种情况下，调用虚方法是完全安全的。

* * *

## 回答 #2

> 赞同：727
> 
> 时间：2008-09-23T07:17:47.547

为了回答你的问题，考虑这个问题：当`Child`对象被实例化时，下面的代码会打印出什么？

```
class Parent
{
    public Parent()
    {
        DoSomething();
    }

    protected virtual void DoSomething() 
    {
    }
}

class Child : Parent
{
    private string foo;

    public Child() 
    { 
        foo = "HELLO"; 
    }

    protected override void DoSomething()
    {
        Console.WriteLine(foo.ToLower()); //NullReferenceException!?!
    }
} 
```

答案是实际上 a`NullReferenceException`会被抛出，因为`foo`它是 null。**对象的基本构造函数在其自己的构造函数之前被调用**。通过`virtual`在对象的构造函数中进行调用，您将引入继承对象在完全初始化之前执行代码的可能性。

* * *

## 回答 #3

> 赞同：166
> 
> 时间：2008-09-23T07:36:08.687

C# 的规则与 Java 和 C++ 的规则非常不同。

当您在 C# 中某个对象的构造函数中时，该对象以完全初始化（只是不是“构造”）的形式存在，作为它的完全派生类型。

```
namespace Demo
{
    class A 
    {
      public A()
      {
        System.Console.WriteLine("This is a {0},", this.GetType());
      }
    }

    class B : A
    {      
    }

    // . . .

    B b = new B(); // Output: "This is a Demo.B"
} 
```

这意味着如果您从 A 的构造函数调用虚函数，它将解析为 B 中的任何覆盖（如果提供了）。

即使您故意这样设置 A 和 B，充分了解系统的行为，您以后也可能会大吃一惊。假设您在 B 的构造函数中调用了虚函数，“知道”它们将由 B 或 A 酌情处理。然后时间过去了，其他人决定他们需要定义 C，并覆盖那里的一些虚函数。突然之间，B 的构造函数最终调用了 C 中的代码，这可能导致非常令人惊讶的行为。

无论如何，在构造函数中避免使用虚函数可能是一个好主意，因为C#、C++ 和 Java 之间的规则*是如此不同。*您的程序员可能不知道会发生什么！

* * *

## 回答 #4

> 赞同：90
> 
> 时间：2008-09-23T13:20:22.323

警告的原因已经描述了，但是您将如何解决警告？您必须密封类或虚拟成员。

```
 class B
  {
    protected virtual void Foo() { }
  }

  class A : B
  {
    public A()
    {
      Foo(); // warning here
    }
  } 
```

您可以密封 A 级：

```
 sealed class A : B
  {
    public A()
    {
      Foo(); // no warning
    }
  } 
```

或者您可以密封方法 Foo：

```
 class A : B
  {
    public A()
    {
      Foo(); // no warning
    }

    protected sealed override void Foo()
    {
      base.Foo();
    }
  } 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2008-09-23T07:21:04.107

在 C# 中，基类的构造函数在派生类的构造函数*之前*运行，因此派生类可能在可能被覆盖的虚拟成员中使用的任何实例字段都尚未初始化。

请注意，这只是**提醒**您注意并确保一切正常的警告。这种情况有实际的用例，您只需**记录虚拟成员的行为**，它不能使用在调用它的构造函数所在的派生类中声明的任何实例字段。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-12-28T01:19:13.467

上面有写得很好的答案，说明您为什么*不想*这样做。这是一个反例，您*可能*希望这样做（从Sandi Metz 的[Practical Object-Oriented Design in Ruby](https://rads.stackoverflow.com/amzn/click/com/0321721330)翻译成 C# ，第 126 页）。

请注意，`GetDependency()`它没有触及任何实例变量。如果静态方法可以是虚拟的，它将是静态的。

（公平地说，通过依赖注入容器或对象初始化器可能有更聪明的方法......）

```
public class MyClass
{
    private IDependency _myDependency;

    public MyClass(IDependency someValue = null)
    {
        _myDependency = someValue ?? GetDependency();
    }

    // If this were static, it could not be overridden
    // as static methods cannot be virtual in C#.
    protected virtual IDependency GetDependency() 
    {
        return new SomeDependency();
    }
}

public class MySubClass : MyClass
{
    protected override IDependency GetDependency()
    {
        return new SomeOtherDependency();
    }
}

public interface IDependency  { }
public class SomeDependency : IDependency { }
public class SomeOtherDependency : IDependency { } 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-23T07:15:32.027

是的，在构造函数中调用虚方法通常是不好的。

此时，对象可能还没有完全构建，方法所期望的不变量可能还不成立。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-08-14T19:50:17.520

一个重要的缺失是，解决这个问题的正确方法是什么？

正如[Greg 所解释](https://stackoverflow.com/a/119543/556595)的，这里的根本问题是基类构造函数会在派生类被构造之前调用虚拟成员。

以下代码取自[MSDN 的构造函数设计指南](https://msdn.microsoft.com/en-us/library/vstudio/ms229060(v=vs.100).aspx)，演示了这个问题。

```
public class BadBaseClass
{
    protected string state;

    public BadBaseClass()
    {
        this.state = "BadBaseClass";
        this.DisplayState();
    }

    public virtual void DisplayState()
    {
    }
}

public class DerivedFromBad : BadBaseClass
{
    public DerivedFromBad()
    {
        this.state = "DerivedFromBad";
    }

    public override void DisplayState()
    {   
        Console.WriteLine(this.state);
    }
} 
```

当创建一个新的实例时`DerivedFromBad`，基类构造函数调用`DisplayState`并显示`BadBaseClass`，因为该字段尚未被派生构造函数更新。

```
public class Tester
{
    public static void Main()
    {
        var bad = new DerivedFromBad();
    }
} 
```

改进的实现从基类构造函数中删除了虚方法，并使用了一个`Initialize`方法。创建一个新实例`DerivedFromBetter`显示预期的“DerivedFromBetter”

```
public class BetterBaseClass
{
    protected string state;

    public BetterBaseClass()
    {
        this.state = "BetterBaseClass";
        this.Initialize();
    }

    public void Initialize()
    {
        this.DisplayState();
    }

    public virtual void DisplayState()
    {
    }
}

public class DerivedFromBetter : BetterBaseClass
{
    public DerivedFromBetter()
    {
        this.state = "DerivedFromBetter";
    }

    public override void DisplayState()
    {
        Console.WriteLine(this.state);
    }
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-23T07:14:10.877

因为在构造函数完成执行之前，对象还没有完全实例化。虚函数引用的任何成员都可能不会被初始化。在 C++ 中，当您在构造函数中时，`this`仅指您所在构造函数的静态类型，而不是正在创建的对象的实际动态类型。这意味着虚函数调用甚至可能不会去你期望的地方。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-09-23T07:25:01.973

您的构造函数可以（稍后，在您的软件的扩展中）从覆盖虚方法的子类的构造函数中调用。现在不是子类的函数实现，而是基类的实现会被调用。所以在这里调用虚函数并没有什么意义。

但是，如果您的设计满足 Liskov 替换原则，则不会造成任何损害。可能这就是它被容忍的原因 - 警告，而不是错误。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-10-25T20:33:34.563

这个问题的一个重要方面，其他答案尚未解决，*如果派生类期望它这样做，那么*基类从其构造函数中调用虚拟成员是安全的。在这种情况下，派生类的设计者负责确保在构造完成之前运行的任何方法在这种情况下都尽可能地表现得尽可能合理。例如，在 C++/CLI 中，构造函数被包装在代码中，`Dispose`如果构造失败，它将调用部分构造的对象。在这种情况下调用`Dispose`通常是必要的，以防止资源泄漏，但`Dispose`必须为运行它们的对象可能尚未完全构造的可能性做好准备。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-08-28T18:25:48.513

该警告提醒您，虚拟成员可能会在派生类上被覆盖。在这种情况下，父类对虚拟成员所做的任何事情都将通过覆盖子类来撤消或更改。为了清楚起见，看一下小例子

下面的父类尝试在其构造函数上将值设置为虚拟成员。这将触发 Re-sharper 警告，让我们看看代码：

```
public class Parent
{
    public virtual object Obj{get;set;}
    public Parent()
    {
        // Re-sharper warning: this is open to change from 
        // inheriting class overriding virtual member
        this.Obj = new Object();
    }
} 
```

这里的子类覆盖了父属性。如果此属性未标记为虚拟，编译器会警告该属性隐藏了父类上的属性，并建议您添加“new”关键字（如果是有意的）。

```
public class Child: Parent
{
    public Child():base()
    {
        this.Obj = "Something";
    }
    public override object Obj{get;set;}
} 
```

最后是对使用的影响，下面例子的输出放弃了父类构造函数设置的初始值。 **这就是 Re-sharper 试图警告你**的，*在父类构造函数上设置的值是开放的，可以被子类构造函数覆盖，子类构造函数在父类构造函数之后调用*。

```
public class Program
{
    public static void Main()
    {
        var child = new Child();
        // anything that is done on parent virtual member is destroyed
        Console.WriteLine(child.Obj);
        // Output: "Something"
    }
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-10-05T19:15:39.147

谨防盲目听从 Resharper 的建议，让课程被封印！如果它是 EF Code First 中的模型，它将删除 virtual 关键字，这将禁用延迟加载它的关系。

```
 public **virtual** User User{ get; set; } 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-23T07:18:32.643

在这种特定情况下，C++ 和 C# 之间存在差异。在 C++ 中，对象未初始化，因此在构造函数中调用虚拟函数是不安全的。在 C# 中，当创建类对象时，其所有成员都初始化为零。可以在构造函数中调用虚函数，但如果您可能访问仍然为零的成员。如果您不需要访问成员，那么在 C# 中调用虚函数是非常安全的。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-10-14T16:23:58.093

只是为了补充我的想法。如果在定义私有字段时总是初始化它，应该避免这个问题。至少下面的代码就像一个魅力：

```
class Parent
{
    public Parent()
    {
        DoSomething();
    }
    protected virtual void DoSomething()
    {
    }
}

class Child : Parent
{
    private string foo = "HELLO";
    public Child() { /*Originally foo initialized here. Removed.*/ }
    protected override void DoSomething()
    {
        Console.WriteLine(foo.ToLower());
    }
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-12-11T11:55:40.360

我认为，如果您想让子类能够设置或覆盖父构造函数将立即使用的属性，那么忽略警告可能是合法的：

```
internal class Parent
{
    public Parent()
    {
        Console.WriteLine("Parent ctor");
        Console.WriteLine(Something);
    }

    protected virtual string Something { get; } = "Parent";
}

internal class Child : Parent
{
    public Child()
    {
        Console.WriteLine("Child ctor");
        Console.WriteLine(Something);
    }

    protected override string Something { get; } = "Child";
} 
```

这里的风险是子类从其构造函数设置属性，在这种情况下，值的更改将在基类构造函数被调用之后发生。

我的用例是我希望子类提供特定值或实用程序类（例如转换器），并且我不想在基础上调用初始化方法。

上面实例化子类时的输出是：

```
Parent ctor
Child
Child ctor
Child 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2017-12-13T21:14:46.317

我只需将 Initialize() 方法添加到基类，然后从派生构造函数中调用它。该方法将在所有构造函数执行后调用任何虚拟/抽象方法/属性:)

* * *

## 回答 #18

> 赞同：-3
> 
> 时间：2014-05-22T16:50:58.327

我发现的另一件有趣的事情是，ReSharper 错误可以通过执行以下类似的操作来“满足”，这对我来说是愚蠢的。但是，正如前面许多人提到的，在构造函数中调用虚拟属性/方法仍然不是一个好主意。

```
public class ConfigManager
{
   public virtual int MyPropOne { get; private set; }
   public virtual string MyPropTwo { get; private set; }

   public ConfigManager()
   {
    Setup();
   }

   private void Setup()
   {
    MyPropOne = 1;
    MyPropTwo = "test";
   }
} 
```

# .net - 是否可以从 .NET 的全局键盘挂钩中确定当前用户

> ID：119508
> 
> 赞同：3
> 
> 时间：2008-09-23T07:12:19.710
> 
> 标签：.net, windows

我想创建一个键盘和鼠标钩子，它将作为 Windows 服务启动。我想监控全天使用系统的各种用户的活动。即哪些用户在什么时间是*活跃的。*

是否可以确定哪个用户将接收事件？（该服务将作为单独的用户运行，因此 getCurrentUser 不合适）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T08:39:54.243

不，Environment.UserName 不起作用 - 挂钩过程不会在输入接收器的上下文中调用。

事实上，我认为这是不可能的——如果使用 .NET，您无疑会使用 _LL 钩子，它是低级钩子。在我看来，它们在 Windows 甚至确定哪个桌面/应用程序将接收事件之前就已经执行了。不过，我可能错了 - 我自己从未使用过 _LL 挂钩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T08:55:48.917

@TcKs - 嗯，快速用户切换怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T11:51:45.077

其他方式：

WTSGetActiveConsoleSessionId函数允许您[获取](http://msdn.microsoft.com/en-us/library/aa383835(VS.85).aspx)活动会话的 ID。具体的：

> WTSGetActiveConsoleSessionId 函数检索当前附加到物理控制台的终端服务会话。物理控制台是显示器、键盘和鼠标。请注意，此功能无需运行终端服务即可成功。

然后您可以使用[WTSQueryUserToken](http://msdn.microsoft.com/en-us/library/aa383840(VS.85).aspx)来获取用户的令牌，然后您应该能够使用令牌获取有关用户的信息。

此功能来自终端服务，但文档说：

> 请注意，此功能无需运行终端服务即可成功。

所以我认为，这可能是一种方式。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-09-23T08:58:00.347

我不知道这些钩子 - 它们是否从远程桌面键盘接收事件？如果他们只获得本地键盘，那么我认为您需要找到 WinSta0 的所有者。

# database - 业务逻辑：数据库或应用层

> ID：119540
> 
> 赞同：41
> 
> 时间：2008-09-23T07:20:27.663
> 
> 标签：database, oracle, business-logic

古老的问题。您应该将业务逻辑放在哪里，作为存储过程（或包）放在数据库中，还是放在应用程序/中间层？更重要的是，为什么？

假设数据库独立性不是目标。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-23T07:31:15.797

在确定业务逻辑的位置时，代码的可维护性始终是一个大问题。

集成调试工具和更强大的 IDE 通常使维护中间层代码比存储过程中的相同代码更容易。除非有真正的原因，否则您应该从中间层/应用程序中的业务逻辑开始，而不是在存储过程中。

但是，当您进行报告和数据挖掘/搜索时，存储过程通常是更好的选择。这要归功于数据库聚合/过滤功能的强大功能以及您在非常接近数据源的位置进行处理的事实。但这可能不是大多数人认为的经典业务逻辑。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-23T07:46:03.623

在数据库中放入足够多的业务逻辑，以保证数据的一致性和正确性。

但是不要担心必须在另一个级别上复制其中的一些逻辑来增强用户体验。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-09-23T07:40:36.227

对于非常简单的情况，您可以将业务逻辑放在存储过程中。通常，即使是简单的案例也会随着时间的推移而变得复杂。以下是我没有将业务逻辑放入数据库的原因：

将业务逻辑放在数据库中可以将其与数据库的技术实现紧密耦合。更改表将导致您再次更改许多存储过程，从而导致许多额外的错误和额外的测试。

通常，UI 依赖于业务逻辑来进行验证等操作。将这些东西放在数据库中会导致数据库和 UI 之间的紧密耦合，或者在不同的情况下会重复这两者之间的验证逻辑。

让多个应用程序在同一个数据库上工作会变得很困难。一个应用程序的更改将导致其他应用程序中断。这很快就会变成维护的噩梦。所以它并没有真正扩展。

更实际地，SQL 并不是一种以可理解的方式实现业务逻辑的好语言。SQL 非常适合基于集合的操作，但它错过了“大型编程”的构造，因此很难维护大量存储过程。现代 OO 语言更适合并且更灵活。

这并不意味着您不能使用存储的过程和视图。我认为有时在表和应用程序之间放置一层额外的存储过程和视图以将两者分离是个好主意。这样您就可以在不更改外部接口的情况下更改数据库的布局，从而允许您独立地重构数据库。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-23T07:42:55.877

这真的取决于你，*只要你是一致的*。

将它放在数据库层的一个很好的理由是：如果您相当确定您的客户永远不会更改他们的数据库后端。

将它放在应用程序层的一个很好的理由是：如果您的应用程序针对多种持久性技术。

您还应该考虑核心能力。您的开发人员主要是应用层开发人员，还是主要是 DBA 类型？

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-23T19:08:55.247

虽然在应用程序层拥有业务逻辑肯定有好处，但我想指出语言/框架似乎比数据库更频繁地更改。

我支持的一些系统在过去 10 到 15 年经历了以下 UI：Oracle Forms/Visual Basic/Perl CGI/ASP/Java Servlet。没有改变的一件事——关系数据库和存储过程。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-23T07:38:58.947

虽然没有一个正确的答案——这取决于所讨论的项目，但我会推荐Eric Evans在“[领域驱动设计”中提倡的方法。](https://rads.stackoverflow.com/amzn/click/com/0321125215)在这种方法中，业务逻辑被隔离在它自己的层——领域层——它位于基础设施层之上——可能包括你的数据库代码，在应用层之下，它将请求发送到领域层完成并听取他们完成的确认，有效地推动应用程序。

这样，业务逻辑被捕获在一个模型中，可以与除了技术问题之外了解业务的人讨论，并且应该更容易隔离业务规则本身的更改、技术实现问题和流程与业务（领域）模型交互的应用程序。

如果你有机会，我建议你阅读上面的书，因为它很好地解释了这个纯粹的理想是如何在真实的代码和项目的现实世界中得到近似的。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-23T14:12:50.417

任何影响数据完整性的东西都必须放在数据库级别。除了用户界面之外的其他事情通常会从数据库中放入、更新或删除数据，包括导入、批量更新以更改定价方案、热修复等。如果您需要确保始终遵循规则，请将逻辑置于默认值中和触发器。

这并不是说在用户界面中也有它不是一个好主意（为什么还要发送数据库不接受的信息），但是在数据库中忽略这些东西会招致灾难。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-23T14:32:05.927

数据库独立性（在这种情况下被提问者排除为考虑因素）是从数据库中取出逻辑的最有力论据。支持数据库独立性的最有力论据是能够将软件出售给自己偏爱数据库后端的公司。

因此，我认为将存储过程从数据库中取出的主要论点只是商业性的，而不是技术性的。可能有技术原因，但保留它也有技术原因——例如性能、完整性以及允许多个应用程序使用相同 API 的能力。

是否使用 SP 还受到您要使用的数据库的强烈影响。如果您不考虑数据库独立性，那么您将在使用 T-SQL 或使用 PL/SQL 时获得截然不同的体验。

如果您使用 Oracle 开发应用程序，那么 PL/SQL 是一种显而易见的选择。它与数据紧密耦合，在每个版本中不断改进，任何体面的开发工具都会将 PL/SQL 开发与 CVS 或 Subversion 等集成。

Oracle 基于 Web 的 Application Express 开发环境甚至 100% 使用 PL/SQL 构建。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-09-23T08:13:37.693

如果您需要数据库独立性，您可能希望将所有业务逻辑放在应用程序层中，因为应用程序层中可用的标准比数据库层可用的标准要普遍得多。

但是，如果数据库独立性不是#1 因素，并且您的团队的技能包括强大的数据库技能，那么将业务逻辑放入数据库可能是最好的解决方案。您可以让您的应用程序人员执行特定于应用程序的事情，并让您的数据库人员确保所有查询都能正常运行。

当然，能够将 SQL 语句放在一起和拥有“强大的数据库技能”之间存在很大差异 - 如果您的团队比后者更接近前者，那么使用这个世界上的 Hibernates 之一将逻辑放入应用程序中（或改变你的团队！）。

以我的经验，在企业环境中，您将拥有一个单一的目标数据库和该领域的技能——在这种情况下，您可以将所有可以放入数据库中。如果您从事软件销售业务，那么数据库许可成本将使数据库独立性成为最大的因素，并且您将在应用程序层中实现所有可以做的事情。

希望有帮助。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-12-21T19:28:42.787

现在可以提交以颠覆您存储的 proc 代码并使用良好的工具支持来调试此代码。

如果您使用结合 sql 语句的存储过程，您可以减少应用程序和数据库之间的数据流量，减少数据库调用次数并获得巨大的性能提升。

一旦我们开始在 C# 中构建，我们就决定不使用存储过程，但现在我们正在将越来越多的代码移动到存储过程。尤其是批处理。

但是不要使用触发器，使用存储过程或更好的包。触发器确实会降低可维护性。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-23T07:23:20.607

将代码放在应用程序层将产生一个独立于数据库的应用程序。

有时出于性能原因使用存储过程会更好。

它（像往常一样）取决于应用程序的要求。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-23T13:03:03.517

唯一进入数据库的是数据。

存储过程是维护的噩梦。它们不是数据，也不属于数据库。开发人员和 DBA 之间无休止的协调只不过是组织摩擦。

很难对存储过程保持良好的版本控制。数据库外的代码很容易安装——当你认为你有错误的版本时，你只需执行 SVN UP（可能是安装），你的应用程序就会回到已知状态。您拥有环境变量、目录链接和对应用程序的大量环境控制。

您可以通过简单的`PATH`操作，为不同的情况（培训、测试、质量保证、生产、客户特定的增强等）提供不同的软件

然而，数据库内的代码更难管理。没有合适的环境——没有“PATH”、目录链接或其他环境变量——来提供对正在使用的软件的任何可用控制；你有一套永久的、全球绑定的应用软件卡在数据库中，与数据结合。

触发器甚至更糟。它们既是维护又是调试的噩梦。我看不出他们解决了什么问题；它们似乎是一种解决设计不良的应用程序的方法，在这种应用程序中，人们不会费心正确地使用可用的类（或函数库）。

虽然有些人发现性能论据令人信服，但我仍然没有看到足够的基准数据来让我相信存储过程是如此之快。每个人都有一个轶事，但没有人有算法或多或少相同的并行代码。

[在我看到的例子中，旧的应用程序设计得很糟糕；编写存储过程时，重新设计了应用程序。我认为设计变更比平台变更的影响更大。]

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-23T07:34:52.217

业务逻辑应该放在应用程序/中间层作为首选。这样，它可以以域模型的形式表达，放置在源代码控制中，拆分或与相关代码组合（重构）等。它还为您提供了一些数据库供应商独立性。

面向对象的语言也比存储过程更具表现力，允许您更好、更轻松地在代码中描述应该发生的事情。

将代码放置在存储过程中的唯一充分理由是：如果这样做会产生显着且必要的性能优势，或者相同的业务代码需要由多个平台（Java、C#、PHP）执行。即使在使用多个平台时，也有可能更适合共享功能的替代方案，例如 Web 服务。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-12-21T18:47:15.083

以我的经验，答案在于通常由组织技能所在的一系列价值观中的某个地方。

DBMS是一个非常强大的野兽，这意味着适当或不适当的处理将带来巨大的利益或巨大的危险。可悲的是，在太多的组织中，主要关注的是编程人员。dbms 技能，尤其是查询开发技能（相对于管理）被忽略了。评估 dbms 技能的能力也可能缺失，这一事实加剧了这种情况。

很少有程序员充分了解他们对数据库的不了解。

因此，诸如 Active Records 和 LINQ 之类的次优概念很受欢迎（以引入一些明显的偏见）。但它们可能是此类组织的最佳答案。

但是，请注意，高度扩展的组织往往会更加关注数据存储的有效使用。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-23T07:24:37.310

这个问题没有独立的正确答案。这取决于您的应用程序的要求、开发人员的偏好和技能以及月相。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-23T07:25:54.623

业务逻辑将放在应用层而不是数据库中。原因是数据库存储过程始终依赖于您使用的数据库产品。这打破了三层模型的优点之一。除非您为此数据库产品提供额外的存储过程，否则您无法轻松更改为其他数据库。另一方面，有时将逻辑放入存储过程以优化性能是有意义的。

我想说的是业务逻辑要放到应用层，但也有例外（主要是性能原因）

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-23T08:09:40.743

业务应用程序“层”是：

## 1\. 用户界面

这实现了业务用户对 h(is/er) 工作的看法。它使用用户熟悉的术语。

## 2\. 加工

这是计算和数据操作发生的地方。任何涉及更改数据的业务逻辑都在这里实现。

## 3\. 数据库

这可能是：标准化的顺序数据库（标准的基于 SQL 的 DBMS）；一个面向对象的数据库，存储包装业务数据的对象；等等

## 去哪儿

在进入上述层时，您需要进行必要的分析和设计。这将表明业务逻辑的最佳实施位置：数据完整性规则和有关数据更新的并发/实时问题通常会尽可能靠近数据实施，与计算字段相同，这是一个很好的指针存储过程/触发器，其中数据完整性和事务控制是绝对必要的。

涉及数据含义和使用的业务规则大部分将在处理层中实现，但也将作为用户的工作流出现在用户界面中——以反映用户的工作。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-12-21T17:57:30.583

恕我直言。决定业务逻辑在关系数据库驱动的应用程序中的位置有两个相互矛盾的问题：

*   可维护性
*   可靠性

关于。可维护性：为了实现高效的未来开发，业务逻辑属于应用程序中最容易调试和版本控制的部分。

关于。可靠性：当存在重大的不一致风险时，业务逻辑属于数据库层。关系数据库可以设计为检查数据的约束，例如不允许在特定列中使用 NULL 值等。当您的应用程序设计中出现某些数据需要处于特定状态而无法用这些简单表示的特定状态时约束，在数据库层使用触发器或类似的东西是有意义的。

触发器很难保持最新状态，尤其是当您的应用程序应该在您甚至没有访问权限的客户端系统上运行时。但这并不意味着不可能跟踪它们或更新它们。S.Lott 在他的回答中认为这是一种痛苦和麻烦的论点是完全有效的，我会支持这一点并且也去过那里。但是，如果您在首次设计数据层时牢记这些限制，并避免将触发器和函数用于除绝对必需品之外的任何事情，那么它是可以管理的。

在我们的应用程序中，大多数业务逻辑都包含在应用程序的模型层中，例如，发票知道如何根据给定的销售订单进行初始化。当一组不同的东西被顺序修改以进行这样的一组复杂更改时，我们将它们汇总在一个事务中以保持一致性，而不是选择存储过程。总计等的计算都是通过模型层中的方法完成的。但是，当我们需要对某些东西进行非规范化以提高性能或将数据插入到所有客户端使用的“更改”表中以确定它们需要在会话缓存中过期的对象时，我们使用数据库层中的触发器/函数来插入新行并从此触发器发出通知（Postgres 监听/通知内容）。

在我们的应用程序在该领域使用了大约一年之后，每天有数百名客户使用，如果我们要从头开始，我唯一会改变的就是设计我们的系统来创建数据库函数（或存储过程，但是你想给他们打电话）从一开始就考虑到他们的版本控制和更新。

值得庆幸的是，我们确实有一些系统来跟踪模式版本，所以我们在此基础上构建了一些东西来处理替换数据库函数。如果我们从一开始就考虑更换它们的必要性，它现在会为我们节省一些时间。

* * *

当然，当您走出 RDBMS 的领域，进入像 Amazon SimpleDB 和 Google 的 BigTable 这样的元组存储系统时，一切都会发生变化。但这是一个不同的故事:)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-23T07:27:51.467

我们在存储过程中放置​​了很多业务逻辑——这并不理想，但通常它在性能和可靠性之间取得了很好的平衡。

我们知道它在哪里，而无需搜索大量的解决方案和代码库！

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-23T07:37:32.317

可伸缩性对于将业务逻辑在中间层或应用层而不是在数据库层进行处理也是非常重要的因素。应该理解，DatabaseLayer 仅用于与数据库交互而不是操作从数据库返回或从数据库返回的数据。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-23T07:56:27.390

我记得在某处读过一篇文章，指出一切都可以在某种程度上成为业务逻辑的一部分，因此这个问题毫无意义。

我认为给出的示例是在屏幕上显示发票。用红色标记过期的决定是一项商业决策......

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2011-08-05T19:33:37.213

这是一个连续体。恕我直言，最大的因素是速度。您如何才能让这个傻瓜尽快启动并运行，同时仍然坚持良好的编程租户，例如可维护性、性能、可伸缩性、安全性、可靠性等。SQL 通常是表达某些东西的最简洁的方式，而且恰好是性能最高的很多次，除了字符串操作等，但这就是您的 CLR Procs 可以提供帮助的地方。我的信念是在任何你认为最适合手头工作的地方自由地散布业务逻辑。如果您有一群应用程序开发人员在查看 SQL 时大吃一惊，那么让他们使用他们的应用程序逻辑。如果您真的想创建一个具有大型数据集的高性能应用程序，请将尽可能多的逻辑放入数据库中。解雇你的 DBA' s 并为开发人员提供对其开发数据库的最大自由。这项工作没有唯一的答案或最佳工具。您拥有多种工具，因此成为应用程序各个级别的专家，您很快就会发现您花费了更多时间编写良好的简洁表达 SQL，并在其他时间使用应用程序层。对我来说，最终，减少代码行数是导致简单性的原因。我们刚刚将一个只有 2500 行应用代码和 1000 行 SQL 的富 sql 应用程序转换为现在具有 15500 行应用程序代码和 2500 行 SQL 的域模型，以实现以前的富 sql 应用程序所做的事情。如果您可以证明代码增加 6 倍是“简化的”，那么请继续。您拥有多种工具，因此成为应用程序各个级别的专家，您很快就会发现您花费了更多时间编写良好的简洁表达 SQL，并在其他时间使用应用程序层。对我来说，最终，减少代码行数是导致简单性的原因。我们刚刚将一个只有 2500 行应用代码和 1000 行 SQL 的富 sql 应用程序转换为现在具有 15500 行应用程序代码和 2500 行 SQL 的域模型，以实现以前的富 sql 应用程序所做的事情。如果您可以证明代码增加 6 倍是“简化的”，那么请继续。您拥有多种工具，因此成为应用程序各个级别的专家，您很快就会发现您花费了更多时间编写良好的简洁表达 SQL，并在其他时间使用应用程序层。对我来说，最终，减少代码行数是导致简单性的原因。我们刚刚将一个只有 2500 行应用代码和 1000 行 SQL 的富 sql 应用程序转换为现在具有 15500 行应用程序代码和 2500 行 SQL 的域模型，以实现以前的富 sql 应用程序所做的事情。如果您可以证明代码增加 6 倍是“简化的”，那么请继续。最终，减少代码行数是导致简单性的原因。我们刚刚将一个只有 2500 行应用代码和 1000 行 SQL 的富 sql 应用程序转换为现在具有 15500 行应用程序代码和 2500 行 SQL 的域模型，以实现以前的富 sql 应用程序所做的事情。如果您可以证明代码增加 6 倍是“简化的”，那么请继续。最终，减少代码行数是导致简单性的原因。我们刚刚将一个只有 2500 行应用代码和 1000 行 SQL 的富 sql 应用程序转换为现在具有 15500 行应用程序代码和 2500 行 SQL 的域模型，以实现以前的富 sql 应用程序所做的事情。如果您可以证明代码增加 6 倍是“简化的”，那么请继续。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2013-08-14T17:43:50.120

这是一个很好的问题！在我已经问过一个类似的[问题](https://stackoverflow.com/questions/18216521/what-are-the-design-consideration-questions-in-determining-where-to-place-the-bu)后，我发现了这一点，但这更具体。它是我没有参与制定的设计变更决定的结果。

基本上，我被告知的是，如果您的数据库表中有数百万行数据，那么请考虑将业务逻辑放入存储过程和触发器中。这就是我们现在正在做的事情，将 Java 应用程序转换为存储过程以实现可维护性，因为 Java 代码变得复杂。

我在以下网站上找到了这篇文章：[The Business Logic Wars](http://www.avromroyfaderman.com/2008/06/the-business-logic-wars/) 作者还在一个表参数中创建了百万行，我觉得这很有趣。他还在 javascript 中添加了业务逻辑，这是客户端和业务逻辑层之外的。尽管我多年来一直使用 javascript 进行验证，以及服务器端验证，但我之前没有考虑过这一点。

我的观点是，您希望将应用程序/中间层中的业务逻辑作为经验法则，但不要忽视将其放入数据库中有意义的情况。

最后一点，我目前正在工作的另一个小组正在为研究做大量的数据库工作，他们处理的数据量是巨大的。尽管如此，对他们来说，他们在数据库本身中没有任何业务逻辑，而是将其保留在应用程序/中间层中。对于他们的设计，应用程序/中间层是它的正确位置，所以我不会将表的大小作为唯一的设计考虑因素。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-23T07:57:30.397

业务逻辑通常由对象以及封装、继承和多态的各种语言结构来体现。例如，如果银行应用程序正在传递金钱，则可能有一个 Money 类型，它定义了“金钱”是什么的业务元素。这与使用原始小数来表示货币相反。出于这个原因，精心设计的 OOP 是“业务逻辑”所在的地方——而不是严格意义上的任何层。

# c# - 在 .NET 的 Web 服务中写入单个文件的问题

> ID：119548
> 
> 赞同：6
> 
> 时间：2008-09-23T07:22:30.077
> 
> 标签：c#, web-services

我在 .net 2.0、C# 中创建了一个 web 服务。每当 Web 服务客户端调用不同的方法时，我都需要将一些信息记录到文件中。

当一个用户进程正在写入文件而另一个进程尝试写入文件时，就会出现问题。我收到以下错误：

> 该进程无法访问该文件，因为它正被另一个进程使用。

我尝试在 C# 中实现但失败的解决方案如下。

1.  实现了包含写入文件的代码的单例类。
2.  使用 lock 语句来包装写入文件的代码。
3.  我也尝试过使用开源记录器 log4net，但这也不是一个完美的解决方案。
4.  我知道记录到系统事件记录器，但我没有那个选择。

我想知道这样的问题是否存在完美完整的解决方案？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T07:32:55.043

锁定可能会失败，因为您的 Web 服务正在由多个工作进程运行。您可以使用跨进程共享的命名互斥锁来保护访问，这与您使用以下方式获得的锁不同`lock(someobject) {...}`：

```
Mutex lock = new Mutex("mymutex", false);

lock.WaitOne();

// access file

lock.ReleaseMutex(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T07:45:05.000

你没有说你的 web 服务是如何托管的，所以我假设它在 IIS 中。我不认为该文件应该由多个进程访问，除非您的服务在多个应用程序池中运行。不过，我想当一个进程中的多个线程尝试写入时，您可能会收到此错误。

我想我会选择你自己建议的解决方案，Pradeep，构建一个单独的对象来完成对日志文件的所有写入。在该对象内部，我有一个队列，所有要记录的数据都写入其中。我会有一个单独的线程从这个队列中读取并写入日志文件。在像 IIS 这样的线程池托管环境中，创建另一个线程似乎不太好，但它只是一个……请记住，内存中的队列不会在 IIS 重置后继续存在；当 IIS 进程停止时，您可能会丢失一些“正在进行中”的条目。

其他替代方案当然包括使用单独的进程（例如服务）来写入文件，但这会产生额外的部署开销和 IPC 成本。如果这对您不起作用，请使用单例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T07:26:11.487

也许写一个“队列行”来写入文件，所以当你尝试写入文件时，它会不断检查文件是否被锁定，如果是 - 它会一直等待，如果它没有被锁定 -然后写信给它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T07:26:59.753

您可以将结果推送到 MSMQ 队列中，并让 Windows 服务从队列中挑选项目并记录它们。它有点重，但它应该可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T07:33:36.633

乔尔和查尔斯。那很快！:)

Joel：当您说“队列行”时，您的意思是创建一个单独的线程，该线程在循环中运行以继续检查队列以及在文件未锁定时写入文件吗？

查尔斯：我知道 MSMQ 和 Windows 服务的组合，但就像我说的，我别无选择，只能从 Web 服务中写入文件 :)

感谢 pradeep_tp

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T07:43:56.843

到目前为止，所有尝试的问题都是多个线程可以输入代码。那是多个线程尝试获取和使用文件处理程序 - 因此出现错误 - 您需要工作线程之外的单个线程来完成工作 - 单个文件句柄保持打开状态。

可能最简单的事情是在应用程序启动期间在 Global.asax 中创建一个线程，并让它监听一个同步的内存队列 (System.Collections.Generics.Queue)。让线程打开并拥有文件句柄的生命周期，只有该线程可以写入文件。

ASP 中的客户端请求将暂时锁定队列，将新的日志消息推送到队列中，然后解锁。

记录器线程将定期轮询队列以获取新消息 - 当消息到达队列时，线程将读取数据并将其分派到文件中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T07:45:12.020

要知道我想在我的代码中做什么，以下是我在 C# 中实现的单音类

公共密封类 FileWriteTest {

```
private static volatile FileWriteTest instance;

private static object syncRoot = new Object();

private static Queue logMessages = new Queue();

private static ErrorLogger oNetLogger = new ErrorLogger();

private FileWriteTest() { }

public static FileWriteTest Instance
{
    get
    {
        if (instance == null)
        {
            lock (syncRoot)
            {
                if (instance == null)
                {
                    instance = new FileWriteTest();
                    Thread MyThread = new Thread(new ThreadStart(StartCollectingLogs));
                    MyThread.Start();

                }
            }
        }

        return instance;
    }
}

private static void StartCollectingLogs()
{

    //Infinite loop
    while (true)
    {
        cdoLogMessage objMessage = new cdoLogMessage();
        if (logMessages.Count != 0)
        {
            objMessage = (cdoLogMessage)logMessages.Dequeue();
            oNetLogger.WriteLog(objMessage.LogText, objMessage.SeverityLevel);

        }
    }
}

public void WriteLog(string logText, SeverityLevel errorSeverity)
{
    cdoLogMessage objMessage = new cdoLogMessage();
    objMessage.LogText = logText;
    objMessage.SeverityLevel = errorSeverity;
    logMessages.Enqueue(objMessage);

} 
```

}

当我在调试模式下运行此代码（仅模拟一个用户访问）时，我在队列出队的行收到错误“堆栈溢出”。

注意：在上面的代码中，ErrorLogger 是一个有代码写入文件的类。objMessage 是承载日志消息的实体类。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T08:20:57.503

或者，您可能希望将错误记录到数据库中（如果您正在使用一个）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T08:38:41.220

科特，

我已经实现了互斥锁，它消除了“堆栈溢出”错误。我还必须进行负载测试，然后才能断定它是否在所有情况下都能正常工作。

我在其中一个网站上阅读了有关 Mutex 对象的信息，其中说 Mutex 会影响性能。我想知道通过互斥锁锁定的一件事。

假设用户进程 1 正在写入文件，同时用户进程 2 尝试写入同一个文件。由于 Process1 已经锁定了代码块，Process2 会继续尝试还是在第一次尝试之后就死掉。

感谢 pradeep_tp

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T13:56:12.500

它将等到互斥锁被释放....

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-23T20:38:27.620

> Joel：当您说“队列行”时，您的意思是创建一个单独的线程，该线程在循环中运行以继续检查队列以及在文件未锁定时写入文件吗？

是的，我基本上就是这么想的。让另一个线程有一个while循环，直到它可以访问文件并保存，然后结束。

但是您必须以第一个开始查找的线程首先获得访问权的方式进行操作。这就是为什么我说队列。

# wcf - 我想使用 MSMQ 3.0 和 windows 2003 记录我的 wcf 服务正在丢弃的 Poison 消息

> ID：119550
> 
> 赞同：1
> 
> 时间：2008-09-23T07:22:47.267
> 
> 标签：wcf, msmq

我想使用 MSMQ 3.0 和 windows 2003 记录我的 wcf 服务正在丢弃的 Poison 消息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T13:52:40.763

您可以实现自定义[IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)并使用自定义行为将其与您的服务相关联。在您的实现中，检查引发的异常是否属于 MsmqPoisonMessageException 类型，如果是，则使用 System.Messaging,MessageQueue 从队列中获取消息并记录它。

有一个[示例](http://msdn.microsoft.com/en-us/library/ms751472.aspx)显示了大部分这些东西是如何完成的：它将消息移动到另一个队列，但修改它应该很简单，以便它只是将消息记录在某个地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T10:51:31.573

您可能可以添加如下服务，从毒药队列中读取消息并记录它们。

```
<service name="YourPosionMessageHandler"
   <endpoint
address="net.msq://localhost/private/YourServiceQueue;poison"
binding="netMsmqBinding"
    />
</service> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T08:20:27.793

在 MSDN 上有一个完美的例子。 [http://msdn.microsoft.com/en-us/library/ms751472.aspx](http://msdn.microsoft.com/en-us/library/ms751472.aspx)

# asp.net - 如何开始构建 ASP.NET Web 应用程序？

> ID：119555
> 
> 赞同：2
> 
> 时间：2008-09-23T07:24:06.640
> 
> 标签：asp.net

例如，您正在获得一个与数据库交互的 Web 应用程序项目。

你如何开始你的发展？您是从设计数据库、绘制简单的 ERD 并编写创建脚本开始的吗？您是否从设计 Web 应用程序的外观开始，可能使用 Photoshop，然后为其创建母版页？还是您从设计具有最小外观的域模型开始，然后再应用更先进的设计？

请分享您对此的想法...干杯...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T07:28:03.277

我倾向于做最后一个想法，“从设计你的领域模型开始，用最小的外观，然后应用更先进的设计”我喜欢让我的应用程序，任何类型，在我做之前花时间让它看起来很漂亮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T07:29:58.420

您首先要决定从哪种方式开始。不，但实际上，要给出一个普遍的答案取决于太多的因素。你是否使用敏捷开发的概念进行开发，是否有明确的功能设计，客户是否对你提出严格的要求，你自己的经验是什么等等。

通常，我们首先开发我们的业务对象，然后使用示例数据/假数据库或有时甚至是纯文本文件为它们创建视图。从那里开始，我们开始填充点点滴滴。如果没有设置所有要求，最好将数据库尽可能长时间地保留在您的开发之外。这样，您就不必每次都更改您的数据库、存储过程和与您的数据库的交互。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T07:29:56.503

首先弄清楚用户需要如何与您的网站进行交互。他们需要达到什么目标？

让这个定义您的 ERD，数据库模型将很快跟进。

然后，当您真正开始编码时，您将朝着正确的方向前进。

许多人还会说，先编写单元测试。这很难做到，但通常是值得的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T07:31:36.060

UI 和 DB，但这取决于哪个是真正的第一个。UI 是一件非常重要的事情，因为您的客户最终必须使用它（有人说可能有些开发人员有时会忘记......）。数据库设计是将（某些）结构放入所有业务需求中的一种非常好的方式，这些业务需求并不总是以严格和结构良好的方式指定。

这是初中的经验，我从 2004 年开始从事开发工作，从在开发公司的 4 年学徒开始。

干杯，马蒂亚斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T07:33:02.343

我从功能 UI 开始，从那里移动到业务层和 db（通常同时开始）。设计通常在某些方面由客户提供，所以我尝试尽早应用它，而不会让它妨碍。我喜欢在一个步骤中整理出域（稍后可以接受微小的更改），并在我的代码中创建我的脚本。

这听起来有点绕路，但它对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T09:16:20.130

我肯定从 UI 原型开始。客户在看到之前永远不知道他们真正想要什么。

UI 上的简单更改可以转化为系统核心组件的巨大变化。所以宁愿让用户玩一个漂亮的原型，直到他们确信这是他们正在寻找的东西，然后潜入系统对象和数据库设计。

关于数据库和系统对象，我发现很难决定走哪条路。先去数据库肯定会影响我的类设计，所以我尽可能地先去对象。它变成了更人性化的设计 IMO

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T15:07:35.147

取决于项目ID'说。通常最好有一个 Photoshop 模型来向您的客户展示他们得到了什么。

在小型无维护项目中，我尝试首先对数据库进行建模，以便更好地了解结构。然后围绕它创建一个 Web 应用程序通常很容易。

在更大的项目中，我通常从创建软件关键部分的（基本）原型开始。然后我把它们展示给客户，然后把它们扔掉。他们只是在那里帮助我更好地了解即将到来的挑战。

但如前所述，这是一个品味和项目的问题。

# c# - 确定文本文件中的行数

> ID：119559
> 
> 赞同：223
> 
> 时间：2008-09-23T07:25:31.473
> 
> 标签：c#, input, text-files

有没有一种简单的方法可以以编程方式确定文本文件中的行数？

* * *

## 回答 #1

> 赞同：425
> 
> 时间：2008-09-23T07:27:24.870

**严重迟到的编辑：如果您使用的是 .NET 4.0 或更高版本**

该类`File`有一个新[`ReadLines`](http://msdn.microsoft.com/en-us/library/dd383503.aspx)方法，它懒惰地枚举行，而不是贪婪地将它们全部读入一个像`ReadAllLines`. 因此，现在您可以通过以下方式既高效又简洁：

```
var lineCount = File.ReadLines(@"C:\file.txt").Count(); 
```

* * *

**原始答案**

如果你不太在意效率，你可以简单地写：

```
var lineCount = File.ReadAllLines(@"C:\file.txt").Length; 
```

对于更有效的方法，您可以这样做：

```
var lineCount = 0;
using (var reader = File.OpenText(@"C:\file.txt"))
{
    while (reader.ReadLine() != null)
    {
        lineCount++;
    }
} 
```

**编辑：回答有关效率的问题**

我说第二个更有效的原因是关于内存使用，不一定是速度。第一个将文件的全部内容加载到一个数组中，这意味着它必须分配至少与文件大小一样多的内存。第二个只是一次循环一行，因此它一次不必分配超过一行的内存。这对于小文件不是那么重要，但对于较大的文件，这可能是一个问题（例如，如果您尝试在 32 位系统上查找 4GB 文件中的行数，那么根本就不够用户模式地址空间来分配这么大的数组）。

就速度而言，我不希望它有很多。ReadAllLines 可能有一些内部优化，但另一方面它可能必须分配大量内存。我猜 ReadAllLines 对于小文件可能会更快，但对于大文件则要慢得多；尽管唯一的判断方法是使用秒表或代码分析器对其进行测量。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-23T07:28:07.007

最简单的：

```
int lines = File.ReadAllLines("myfile").Length; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-23T07:33:14.527

这将使用更少的内存，但可能需要更长的时间

```
int count = 0;
string line;
TextReader reader = new StreamReader("file.txt");
while ((line = reader.ReadLine()) != null)
{
  count++;
}
reader.Close(); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-23T07:29:43.070

如果简单是指易于破译但效率低下的代码行？

```
string[] lines = System.IO.File.RealAllLines($filename);
int cnt = lines.Count(); 
```

这可能是知道有多少行的最快方法。

你也可以这样做（取决于你是否正在缓冲它）

```
#for large files
while (...reads into buffer){
string[] lines = Regex.Split(buffer,System.Enviorment.NewLine);
} 
```

还有其他许多方法，但上述方法之一可能就是您要使用的方法。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-05-24T11:58:09.720

读取文件本身需要一些时间，垃圾收集结果是另一个问题，因为您读取整个文件只是为了计算换行符，

在某些时候，有人将不得不读取文件中的字符，无论这是框架还是您的代码。这意味着如果文件很大，您必须打开文件并将其读入内存，这可能会成为问题，因为内存需要被垃圾收集。

[Nima Ara 做了一个很好的分析，你可以考虑一下](http://www.nimaara.com/2018/03/20/counting-lines-of-a-text-file/)

这是建议的解决方案，因为它一次读取 4 个字符，计算换行字符并再次使用相同的内存地址进行下一个字符比较。

```
private const char CR = '\r';  
private const char LF = '\n';  
private const char NULL = (char)0;

public static long CountLinesMaybe(Stream stream)  
{
    Ensure.NotNull(stream, nameof(stream));

    var lineCount = 0L;

    var byteBuffer = new byte[1024 * 1024];
    const int BytesAtTheTime = 4;
    var detectedEOL = NULL;
    var currentChar = NULL;

    int bytesRead;
    while ((bytesRead = stream.Read(byteBuffer, 0, byteBuffer.Length)) > 0)
    {
        var i = 0;
        for (; i <= bytesRead - BytesAtTheTime; i += BytesAtTheTime)
        {
            currentChar = (char)byteBuffer[i];

            if (detectedEOL != NULL)
            {
                if (currentChar == detectedEOL) { lineCount++; }

                currentChar = (char)byteBuffer[i + 1];
                if (currentChar == detectedEOL) { lineCount++; }

                currentChar = (char)byteBuffer[i + 2];
                if (currentChar == detectedEOL) { lineCount++; }

                currentChar = (char)byteBuffer[i + 3];
                if (currentChar == detectedEOL) { lineCount++; }
            }
            else
            {
                if (currentChar == LF || currentChar == CR)
                {
                    detectedEOL = currentChar;
                    lineCount++;
                }
                i -= BytesAtTheTime - 1;
            }
        }

        for (; i < bytesRead; i++)
        {
            currentChar = (char)byteBuffer[i];

            if (detectedEOL != NULL)
            {
                if (currentChar == detectedEOL) { lineCount++; }
            }
            else
            {
                if (currentChar == LF || currentChar == CR)
                {
                    detectedEOL = currentChar;
                    lineCount++;
                }
            }
        }
    }

    if (currentChar != LF && currentChar != CR && currentChar != NULL)
    {
        lineCount++;
    }
    return lineCount;
} 
```

在上图中，您可以看到底层框架一次读取一个字符，因为您需要读取所有字符才能看到换行符。

如果您将其描述为 done bay Nima，您会发现这是一种相当快速且有效的方法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-23T07:27:38.317

您可以快速读取它并增加一个计数器，只需使用循环来增加，对文本不做任何事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T07:28:32.887

计算回车/换行。我相信在 unicode 中它们仍然分别是 0x000D 和 0x000A。这样你就可以随心所欲地高效或低效，并决定是否必须同时处理这两个角色

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-20T00:25:45.550

一个可行的选项，也是我个人使用的一个选项，是将您自己的标题添加到文件的第一行。我这样做是为了我的游戏的自定义模型格式。基本上，我有一个工具可以优化我的 .obj 文件，摆脱我不需要的废话，将它们转换为更好的布局，然后将线、面、法线、顶点和纹理 UV 的总数写入第一行。然后，在加载模型时，各种数组缓冲区会使用该数据。

这也很有用，因为您只需要循环一次文件来加载它，而不是一次计算行数，然后再次将数据读入您创建的缓冲区。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-09T14:24:18.203

用这个：

```
 int get_lines(string file)
    {
        var lineCount = 0;
        using (var stream = new StreamReader(file))
        {
            while (stream.ReadLine() != null)
            {
                lineCount++;
            }
        }
        return lineCount;
    } 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-10-07T14:18:05.863

```
try {
    string path = args[0];
    FileStream fh = new FileStream(path, FileMode.Open, FileAccess.Read);
    int i;
    string s = "";
    while ((i = fh.ReadByte()) != -1)
        s = s + (char)i;

    //its for reading number of paragraphs
    int count = 0;
    for (int j = 0; j < s.Length - 1; j++) {
            if (s.Substring(j, 1) == "\n")
                count++;
    }

    Console.WriteLine("The total searches were :" + count);

    fh.Close();

} catch(Exception ex) {
    Console.WriteLine(ex.Message);
} 
```

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2008-09-23T07:43:35.847

您可以启动“ [wc](http://unixhelp.ed.ac.uk/CGI/man-cgi?wc) .exe”可执行文件（[UnixUtils](http://unxutils.sourceforge.net/)附带，不需要安装）作为外部进程运行。它支持不同的行数方法（如 unix vs mac vs windows）。

# c# - 在 C#/WinForms 中制作多语言应用程序的最佳实践？

> ID：119568
> 
> 赞同：94
> 
> 时间：2008-09-23T07:26:46.027
> 
> 标签：c#, winforms, localization, internationalization

我一直在研究在 C# 中制作适用于多种语言的应用程序，因为我需要在这种情况下处理一个小项目。我发现基本上有两种方法可以做到这一点：

将表单的 Localizable 属性设置为 true，设置 Language 属性，填写所有标签等，就完成了。我在其中看到的主要缺点是：如何使不属于表单的其他内容为多种语言做好准备（例如弹出窗口、日志文件或窗口等）。

创建一个资源文件，例如“Lang.en-us.resx”，并为每种语言创建一个，例如“Lang.nl-nl.resx”，并用字符串填充它。IDE 似乎自动为我生成了一个类，所以在代码中我可以只使用 Lang.SomeText。我在其中看到的最大缺点是：对于每个表单，我都需要自己在代码中设置所有标签和其他标题（而且数据绑定似乎不适用于这些资源）。

但是，我敢肯定，还有其他方法可以做到这一点。

那么，最佳实践是什么？对于小型应用程序（一些表单、数据库连接等）来说什么是最简单的，对于大型应用程序来说什么是最适合的？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-23T07:49:18.140

我一直将资源文件用于多语言应用程序。
网上有很多文章解释了如何使用它们。

我使用了两种不同的方法：

*   每个表单一个资源文件
*   全局资源文件

资源文件/表单更容易实现，您只需在资源文件中输入值，但我发现这种方法更难维护，因为标签分散在整个应用程序中。

全局资源文件允许您将所有标签（图像等）集中在一个文件（每种语言）中，但这意味着在表单加载中手动设置标签。该文件也可用于错误消息等。

口味问题...

最后一点，我用英语和法语编写程序，我使用“en”和“fr”而不是“en-US”和“fr-FR”。不要使事情复杂化，英语的不同方言（美国，英语，澳大利亚等）几乎没有差异，只能使用一种（法语也是如此）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-23T13:28:00.713

我最近编写了一个同时支持德语和英语的程序。我惊讶地发现，如果我简单地命名我的英语资源 LanguageResources.resx 和我的德语资源 LanguageResources.de.resx，它会自动选择正确的语言。ResXFileCodeGenerator 为我处理了这一切。

请注意，两个文件中的字段相同，任何尚未输入的德语字段将在应用程序中显示为英语，因为最不特定的文件语言是默认文件。在查找字符串时，它会从最具体（例如 .de-DE.resx）到最不具体（例如 .resx）。

要获取您的字符串，请使用 ResourceManager.GetString 或 ResourceManager.GetObject 调用。该应用程序应该免费为您提供 ResourceManager。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-03-30T01:00:22.820

为了其他可能遇到此问题的人的利益（上一篇文章后 1 年多），我是专业本地化产品的作者，它使整个翻译过程变得非常容易。这是一个 Visual Studio 插件，可以从任意解决方案中提取所有“.resx”字符串，并将它们加载到一个文件中，该文件可以使用免费的独立应用程序进行翻译（翻译人员可以从我的网站下载）。然后，相同的加载项会将翻译后的字符串导入您的解决方案。非常易于使用，具有许多内置的保护措施、大量的花里胡哨和在线帮助（您不需要太多）。见[http://www.hexadigm.com](http://www.hexadigm.com)

# c++ - 禁用通过 _CRT_SECURE_NO_DEPRECATE 生成的警告

> ID：119578
> 
> 赞同：76
> 
> 时间：2008-09-23T07:28:06.537
> 
> 标签：c++, visual-studio, visual-c++

禁用生成的警告的最佳方法是什么`_CRT_SECURE_NO_DEPRECATE`，可以轻松恢复它们并且可以跨 Visual Studio 版本工作？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2008-09-23T08:06:15.760

如果您不想污染源代码（毕竟此警告仅在 Microsoft 编译器中出现），`_CRT_SECURE_NO_WARNINGS`请通过“项目”->“属性”->“配置属性”->“C/C++”将符号添加到项目设置中"->"预处理器"->"预处理器定义"。

您也可以在包含生成此警告的头文件之前定义它。你应该添加这样的东西

```
#ifdef _MSC_VER
#define _CRT_SECURE_NO_WARNINGS
#endif 
```

只是一个小评论，确保你理解这个警告代表什么，也许，如果你不打算使用除 MSVC 之外的其他编译器，考虑使用更安全的函数版本，即 strcpy_s 而不是 strcpy。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-09-23T15:01:02.440

您可以在警告出现的地方暂时禁用警告，方法是使用

```
#pragma warning(push)
#pragma warning(disable: warning-code) //4996 for _CRT_SECURE_NO_WARNINGS equivalent
// deprecated code here
#pragma warning(pop) 
```

所以你不要禁用所有警告，这有时可能是有害的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-23T10:58:17.577

我在一个多平台项目上工作，所以我不能使用 _s 函数，我不想用 Visual Studio 特定代码污染我的代码。
我的解决方案是禁用 Visual Studio 项目中的警告 4996。转到项目 -> 属性 -> 配置属性 -> C/C++ -> 高级 -> 禁用特定警告添加值 4996。
如果您还使用 mfc 和/或 atl 库（不是我的情况），请在包含 mfc _AFX_SECURE_NO_DEPRECATE 和在包括 atl _ATL_SECURE_NO_DEPRECATE 之前。
我在 Visual Studio 2003 和 2005 中使用这个解决方案。

ps 如果您仅使用 Visual Studio，则安全模板重载可能是一个很好的解决方案。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-23T09:27:03.537

您还可以使用[Secure Template Overloads](https://msdn.microsoft.com/en-us/library/ms175759(v=vs.140).aspx)，它们将帮助您在任何可以轻松推断缓冲区大小（静态数组）的地方用安全调用替换不安全调用。

只需添加以下内容：

```
#define _CRT_SECURE_CPP_OVERLOAD_STANDARD_NAMES 1 
```

然后使用 _s 函数手动修复剩余的警告。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-06-13T18:30:12.960

@[macbirdie] 和 @[Adrian Borchardt] 答案的组合。这被证明在生产环境中非常有用（不会弄乱以前存在的警告，尤其是在跨平台编译期间）

```
#if (_MSC_VER >= 1400)         // Check MSC version
#pragma warning(push)
#pragma warning(disable: 4996) // Disable deprecation
#endif 
//...                          // ...
strcat(base, cat);             // Sample depreciated code
//...                          // ...
#if (_MSC_VER >= 1400)         // Check MSC version
#pragma warning(pop)           // Renable previous depreciations
#endif 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-01-08T23:25:33.373

对于逐个警告案例的警告，明智的做法是在某个时候将其恢复为默认值，因为您是根据具体情况进行操作的。

```
#pragma warning(disable: 4996) /* Disable deprecation */
// Code that causes it goes here
#pragma warning(default: 4996) /* Restore default */ 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-01-01T03:42:02.583

最好的方法是通过简单的检查和评估。我通常会这样做：

```
#ifndef _DEPRECATION_DISABLE   /* One time only */
#define _DEPRECATION_DISABLE   /* Disable deprecation true */
#if (_MSC_VER >= 1400)         /* Check version */
#pragma warning(disable: 4996) /* Disable deprecation */
#endif /* #if defined(NMEA_WIN) && (_MSC_VER >= 1400) */
#endif /* #ifndef _DEPRECATION_DISABLE */ 
```

真正需要的是以下内容：

```
#pragma warning(disable: 4996) 
```

还没有让我失望；希望这可以帮助

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-12-17T04:42:21.213

您可以禁用安全检查。去

项目 -> 属性 -> 配置属性 -> C/C++ -> 代码生成 -> 安全检查

并选择禁用安全检查 (/GS-)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-23T07:38:58.057

您可以定义 _CRT_SECURE_NO_WARNINGS 符号来抑制它们并取消定义它以恢复它们。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-09-30T06:04:13.200

另一个迟到的答案......这是微软在他们的`wchar.h`. 请注意，他们还禁用[了警告 C6386](http://msdn.microsoft.com/en-us/library/ms182089%28v=vs.100%29.aspx)：

```
__inline _CRT_INSECURE_DEPRECATE_MEMORY(wmemcpy_s) wchar_t * __CRTDECL
wmemcpy(_Out_opt_cap_(_N) wchar_t *_S1, _In_opt_count_(_N) const wchar_t *_S2, _In_ size_t _N)
{
    #pragma warning( push )
    #pragma warning( disable : 4996 6386 )
        return (wchar_t *)memcpy(_S1, _S2, _N*sizeof(wchar_t));
    #pragma warning( pop )
} 
```

# asp.net-mvc - ASP MVC Preview 5 和 IIS 6 Windows 身份验证

> ID：119588
> 
> 赞同：4
> 
> 时间：2008-09-23T07:31:01.727
> 
> 标签：asp.net-mvc, authentication, iis-6

我刚刚构建了一个基本的 ASP MVC 网站，用于在我们的 Intranet 上进行部署。它希望用户与 IIS 框在同一个域中，如果您不是经过身份验证的 Windows 用户，则不应获得访问权限。

我刚刚将它部署到在 Server 2003 R2 SP2 上运行的 IIS6。Web 应用程序配置有它自己的池和它自己的池用户帐户。Web 应用程序的 IIS 目录安全选项仅设置为“Windows 集成安全”，并且 web.config 文件具有：

```
<authentication mode="Windows" /> 
```

从 IIS6 服务器本身的远程桌面会话中，如果通过[http://localhost/myapp](http://localhost/myapp)访问，IE7 浏览器窗口可以成功验证和导航 Web 应用程序。

但是，同样从服务器，如果通过服务器的名称（即[http://myserver/myapp](http://myserver/myapp)）访问，则 IE7 会显示一个凭据对话框，在尝试输入正确凭据三次后最终返回“HTTP 错误 401.1 - 未经授权：访问被拒绝，原因无效的凭据”。

当工作站浏览到 Web 应用程序 url（自然使用服务器的名称而不是“localhost”）时，也会出现同样的问题。

IIS6 服务器是我们拥有的唯一域的成员，并且没有启用防火墙。

有什么我没有正确配置的东西吗？

谢谢，

* * *

迄今为止，我尝试了 Matt Ryan、Graphain 和 Mike Dimmick 的建议，但没有成功。我刚刚使用 Server 2003 DC 和单独的 server 2003 IIS6 服务器构建了一个虚拟机测试实验室，我能够复制该问题。

当我第一次尝试通过非本地主机 URL（即[http://iis/myapp](http://iis/myapp)）访问该站点时，我在 IIS6 服务器的系统事件日志中看到了一个条目。FQDN url 也失败了。

> *来源：Kerberos，事件 ID：4*
> kerberos 客户端从服务器 host/iis.test.local 收到 KRB_AP_ERR_MODIFIED 错误。使用的目标名称是 HTTP/iis.test.local。这表明用于加密kerberos服务票据的密码与目标服务器上的密码不同。通常，这是由于目标领域 (TEST.LOCAL) 和客户端领域中的计算机帐户名称相同。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-25T08:53:08.907

经过广泛的谷歌搜索后，我设法在以下 MSDN 文章中找到了解决方案：
[如何：为 ASP.NET 2.0 应用程序创建服务帐户](http://msdn.microsoft.com/en-us/library/ms998297.aspx)

特别是附加注意事项部分，该部分描述了使用 Windows 支持工具中的 setspn 工具“为域帐户创建服务主体名称 (SPN)”：

> setspn -A HTTP/myserver MYDOMAIN\MyPoolUser
> setspn -A HTTP/myserver.fqdn.com MYDOMAIN\MyPoolUser

这解决了我在虚拟测试实验室和原始问题服务器上的问题。

文章中还有一个重要说明，即对自定义池用户使用 Windows 身份验证会将关联的 DNS 名称限制为仅由该池使用。也就是说，具有另一个身份的另一个池需要与不同的 DNS 名称相关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T08:23:16.530

听起来像是 Windows Server 2003 SP1 的新 Loopback 检查安全功能。据我了解，旨在防止特定类型的拦截攻击。

来自[http://support.microsoft.com/kb/896861](http://support.microsoft.com/kb/896861)

## 症状

当您使用完全限定域名 (FQDN) 或自定义主机标头浏览运行 Microsoft Internet 信息服务 (IIS) 5.1 或 IIS 6 的计算机上托管的本地网站时，您可能会收到一条错误消息，指出类似于以下内容： HTTP 401.1 - 未经授权：登录失败 当网站使用集成身份验证并且具有映射到本地环回地址的名称时，会出现此问题。

注意如果您尝试直接在服务器上浏览网站，您只会收到此错误消息。如果您从客户端计算机浏览该网站，该网站将按预期工作。

## 原因

如果您安装 Microsoft Windows XP Service Pack 2 (SP2) 或 Microsoft Windows Server 2003 Service Pack 1 (SP1)，则会出现此问题。Windows XP SP2 和 Windows Server 2003 SP1 包括一个环回检查安全功能，旨在帮助防止对您的计算机进行反射攻击。因此，如果您使用的 FQDN 或自定义主机标头与本地计算机名称不匹配，则身份验证将失败。

## 解决方法

*   方法一：禁用环回检查
*   方法 2：指定主机名

有关详细信息，请参阅[http://support.microsoft.com/kb/896861](http://support.microsoft.com/kb/896861)。

* * *

编辑 - 刚刚注意到您说您也从客户端 PC 看到了这个......这更不寻常。但我仍然希望测试其中一种解决方法，看看它是否解决了问题（如果是，可能表明您的 DNS 配置有问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T07:54:32.340

在我看来，你做的一切都是对的。

我确定你是，但你确定你使用“域\用户”作为用户帐户，而不仅仅是“用户”吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T11:05:12.943

IE7 仅在将服务器标识为位于 Intranet 上时才发送 Windows 凭据（NTLM、Kerberos）。IE7 还添加了 Intranet 区域锁定功能 - 如果您不在域中，默认情况下Intranet 区域中*没有*服务器。这样做是为了防止区域迁移攻击。

要更改此设置，请转到工具/Internet 选项、安全选项卡，然后单击本地 Intranet。然后，您可以手动添加应被视为 Intranet 的服务器，方法是单击“站点”按钮，然后单击“高级”，或者告诉 IE 不要自动检测您的 Intranet 并根据需要选择其他复选框。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-25T06:20:20.507

我刚刚遇到了相反的问题——我的网站在外部进行身份验证，但不是在本地进行身份验证。

我将它与我们工作的站点进行了比较，不同之处在于未能通过身份验证的站点使用的是 Windows 身份验证。

但是，我使用的其他站点（这是一个开发服务器）往往具有基本身份验证。

不知道为什么，但这解决了它。

但是，同时我注意到“默认域”和“领域”设置。

我知道这不太可能，但这些可能有帮助吗？

# linux - linux下路由的方法

> ID：119609
> 
> 赞同：0
> 
> 时间：2008-09-23T07:35:04.603
> 
> 标签：linux, routing, ip-address, ip, routes

我的 isp 有 20 个 ip。我将它们绑定到运行 centos 的路由器盒。我要设置什么命令，以什么顺序设置，以便我的局域网上的其他盒子，基于它们的 mac 地址或 192 ips，我可以让它们在特定 ips 上路由出我的盒子。例如，我希望 mac addy`xxx:xxx:xxx0400`出去`72.049.12.157`和`xxx:xxx:xxx:0500`出去`72.049.12.158`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T09:04:33.763

用于`iptables`设置`NAT`。

```
iptables -t nat -I POSTROUTING -s 192.168.0.0/24 -j SNAT --to-source 72.049.12.157
iptables -t nat -I POSTROUTING -s 192.168.1.0/24 -j SNAT --to-source 72.049.12.158 
```

这应该会导致`192.168.0.0`子网上的任何 ip 的“外部”ip 为`72.049.12.157`，`192.168.1.0`子网上的任何 ip 的“外部”ip 为`72.049.12.158`。对于 MAC 地址匹配，使用`-m mac --mac-source MAC-ADDRESS`代替`-s 192.168.0.0/24`参数

不要忘记激活 ip 转发：

```
cat /proc/sys/net/ipv4/ip_forward 
```

如果上面返回 a`0`那么它将不起作用，您必须启用它。不幸的是，这是特定于发行版的，我不知道 CentOS。
要快速破解，请执行以下操作：

```
echo 1 > /proc/sys/net/ipv4/ip_forward 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T09:35:51.363

用您提供的少量信息回答这个问题相当于在此处重写路由 Howto。你也可以

*   阅读有关路由和 IP 的一般信息（例如 Linux 系统管理员指南）或
*   向我们提供有关您获得的确切 IP 地址的更多信息。

上面使用 NAT 的答案绝对不是您在拥有公共 IP 地址时打算使用的答案。这个解决方案不会很好地扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T07:47:01.423

路由器软硬件版本是多少？

你想用一个linux盒子来做这个吗？现在停下来买个路由器。从长远来看，它将为您节省金钱。

# math - 哪里是复习数学的好地方？

> ID：119622
> 
> 赞同：5
> 
> 时间：2008-09-23T07:39:26.883
> 
> 标签：math, computer-science, algebra, discrete-mathematics

数学技能变得越来越重要，我想知道在继续学习更多 CompSci 特定内容之前，哪里是复习一些基础知识的好地方？

一个拥有大量视频和练习的网站将是双赢的，但我似乎找不到。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T07:47:37.863

这取决于你的数学水平。你应该从修改你应该知道的那一刻开始，然后进一步学习算法数学、几何（变换等）、统计等等。

互联网上有很多地方可以学习：

[http://www.math.cornell.edu/Courses/courses.html](http://www.math.cornell.edu/Courses/courses.html)

[http://ocw.mit.edu/OcwWeb/web/courses/courses/index.htm](http://ocw.mit.edu/OcwWeb/web/courses/courses/index.htm)

[http://mathworld.wolfram.com/](http://mathworld.wolfram.com/)

并且列表是开放的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T07:49:07.203

如果你想训练数论和离散数学，我推荐[Project Euler 。](http://projecteuler.net)很多有趣的练习，虽然你需要知道一点编程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T11:01:17.820

史蒂夫·耶格（Steve Yegge）有一篇很好的博文[《程序员数学》](http://steve-yegge.blogspot.com/2006/03/math-for-programmers.html)

引用其中的一部分：

> “但我最近了解到的一些事情可能会让你感到惊讶：
> 
> 1.  在你知道如何编程之后，数学就容易上手了。事实上，如果你是一个中规中矩的程序员，你会发现这几乎是轻而易举的事。
>     
>     
> 2.  他们在学校教数学都错了。方式，方式错误。如果你以正确的方式自学数学，你会学得更快，记住它的时间更长，而且它对你作为程序员来说更有价值。
>     
>     
> 3.  哪怕只知道一点正确的数学，你也可以编写一些非常有趣的程序，否则这些程序就太难了。换句话说，只要你有空闲时间，你就可以一次学习一点数学。
>     
>     
> 4.  没有人知道所有的数学，即使是最好的数学家也不知道。随着人们发明新的形式来解决自己的问题，该领域正在不断扩大。对于任何给定的数学问题，就像在编程中一样，有不止一种方法可以解决。你可以选择你最喜欢的一个。
>     
>     
> 5.  数学是……嗯，请不要告诉任何人我说过这句话；只要我活着，我就永远不会被邀请参加另一个派对。但是数学，嗯……我最好低声说，所以听好了：（这实际上有点有趣。）”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T07:56:07.703

我会很无聊，并建议实际参加大学数学课程。如果没有助理的讲座和课程，我知道我永远无法像我所拥有的那样学习。我只需要某种动力，因为高等数学真的很难。

也就是说，如果您正在寻找非常先进的东西并且实际上想要深入了解并且不想处理数字。处理数字是我们拥有 MATLAB 的原因；）

最好知道你的数学水平，以及你想用它做什么。但我想微积分、线性代数和离散数学是最有用的课程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T10:43:15.493

如果您无法参加数学课程，我建议您阅读带有良好教程的书籍。对于计算机科学相关的数学，Don Knuth 的[具体数学](https://rads.stackoverflow.com/amzn/click/com/0201558025)非常好。

显然，没有什么可以代替好老师，但是好的教程可以非常接近。你真的可以在我认为的教程中学习这个主题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-09T11:38:10.507

从 www.aduni.org 获取一些视频

数学课程

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-21T09:35:06.853

自从提出这个问题以来已经有几年了，但是现在有许多新的站点和资源可用：

*   [可汗学院](http://www.khanacademy.org/)最初是为小学生设计的，但后来扩大到包括在大学一年级课程中不会不合适的材料。它是审查和修复基本面的好方法。它有视频和练习，并跟踪您的进度。

*   [EdX](https://www.edx.org/)是 MIT 开放课件等计划的演变。它现在是麻省理工学院、伯克利和斯坦福大学等大学的联盟，提供免费的在线大学水平课程，包括视频教学和学习材料。我唯一的抱怨是他们的一些课程有你需要在其他地方学习的先决条件（比如单变量微积分），比如 Coursera，或者最初的[MIT OpenCourseWare](http://ocw.mit.edu/)网站。

*   [Coursera](http://coursera.org/)提供的课程比 EdX 多，其中许多课程更基础，涵盖预代数和预微积分等主题。学习界面不像 EdX 那样酷（它提供了一个可滚动的字幕界面以及大部分视频），但是涵盖基础知识的更广泛的主题和课程提供了您在 EdX 上找不到的学习。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T07:41:38.033

许多大学实际上会在线发布他们的讲座材料。所以你真正需要做的就是找到一个合适的主题，然后阅读讲座材料并做相关的工作。如果你真的很狡猾，你可能还可以去教程寻求帮​​助：P

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T07:47:07.177

[BetterExplained.com](http://betterexplained.com/articles/category/math/)有一些很棒的数学讲座。它不是视频讲座，而是作者对数学概念进行了易于理解的解释。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T10:28:58.973

不要忘记，iTunes 现在提供大量来自各个主流大学的数学讲座（和其他科目）——而且全部免费。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-12-09T18:49:46.663

既然你想复习你的数学

我建议你在线上对 UCCS 数学进行 G 搜索

或点击此链接，免费注册后即可浏览[档案](http://www.uccs.edu/~mathonline/)

我必须说，你会发现人们推荐课程 X 是很常见的。

但很少有人会完成他们推荐的课程..

所以在数论的情况下，你必须去上最新的课程，最后的课程没有高质量的视频..

也适用于离散数学->此站点上没有讲义

所以你必须弄清楚如何建立对应两个在线课程（6.042有很好的P集和笔记）和上面的离散数学数学课程。

我不鼓励您使用 YouTube（x 分钟）教程，因为它们中的大多数都像历史一样涵盖数学..

G搜索Harvard OlI可以找到一门不错的课程——

它有概率（非连续） - 有 P 个集合没有解决方案..

# c# - 将 xml 数据存储在 cookie 中

> ID：119627
> 
> 赞同：1
> 
> 时间：2008-09-23T07:40:45.367
> 
> 标签：c#, asp.net, serialization, cookies

我正在尝试将 xml 序列化对象存储在 cookie 中，但出现如下错误：

```
A potentially dangerous Request.Cookies value was detected from the client (KundeContextCookie="<?xml version="1.0" ...") 
```

当您尝试在表单输入字段中存储看起来像 javascript 代码的内容时，我从类似的案例中知道了问题。

这里的最佳做法是什么？有没有办法（就像我描述的表单问题）来抑制来自 asp.net 框架的这个警告，或者我应该用 JSON 序列化而不是二进制序列化它？在 cookie 中存储序列化数据时的常见做法是什么？

编辑：感谢您的反馈。我想在 cookie 中存储比 ID 更多的数据的原因是因为我真正需要的对象需要大约 2 秒才能从我无法控制的服务中检索。我制作了一个轻量级对象“KundeContext”来保存完整对象中的一些属性，但这些属性在 90% 的时间里都在使用。这样我只需要在 10% 的页面上调用慢速服务。如果我只存储 ID，我仍然必须在几乎所有页面上调用该服务。

我可以单独存储所有字符串和整数，但该对象还有其他轻量级对象，如“联系人信息”和“地址”，手动存储它们的每个属性会很乏味。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T07:51:11.070

在 cookie 中存储序列化数据是一个非常非常糟糕的主意。由于用户可以完全控制 cookie 数据，因此他们很容易使用这种机制来向您提供恶意数据。换句话说：反序列化代码中的*任何*弱点都会立即被利用（或者至少是一种使某些东西崩溃的方法）。

相反，只在您的 cookie 中保留最简单的标识符，其格式可以轻松验证的类型（例如，GUID）。然后，将您的序列化数据存储在服务器端（在数据库、文件系统上的 XML 文件或其他任何地方）并使用该标识符检索它。

编辑：另外，在这种情况下，请确保您的标识符足够随机，以使用户无法猜测彼此的标识符，并通过简单地更改自己的标识符来模拟对方。同样，GUID（或 ASP.NET 会话标识符）非常适合此目的。

问题所有者澄清场景后的第二次编辑：为什么在这种情况下使用您自己的 cookie？如果您在会话状态（会话对象）中保留对原始对象或轻量级对象的引用，ASP.NET 将以一种非常有效的方式为您处理所有实现细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T07:48:55.583

我不会在 cookie 中以 XML 格式存储数据 - 初学者的 cookie 大小有限制（包括 cookie 在内的*所有*标头过去都是 4K）。选择不那么冗长的编码策略，例如分隔符，而不是例如 a|b|c 或单独的 cookie 值。定界编码使解码值变得特别容易和快速。

您看到的错误是 ASP.NET 抱怨标头看起来像 XSS 攻击。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T07:51:11.943

查看[视图状态](http://msdn.microsoft.com/en-us/library/ms972976.aspx)。也许您希望在 ViewState 中的回发中保留数据，而不是使用 cookie。否则，您可能应该将 XML 存储在服务器上，并将该数据的唯一标识符存储在 cookie 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T08:38:51.203

您可能会考虑使用[会话状态](http://msdn.microsoft.com/en-us/library/ms972429.aspx)来存储值。您可以将其配置为使用 cookie 来存储会话 ID。这也更安全，因为该值在用户端既不可见也不可更改。

另一种选择是使用分布式缓存机制来存储值。我目前最喜欢的是[Memcached](http://www.codeplex.com/memcachedproviders)。

# c# - 在 C# 中运行脚本

> ID：119632
> 
> 赞同：6
> 
> 时间：2008-09-23T07:42:22.947
> 
> 标签：c#, scripting

我想在我的应用程序中运行 javascript/Python/Ruby。

我有一个应用程序可以根据用户的定义自动创建流程。该过程是在 C# 中生成的。我想让高级用户能够在预定义的位置注入脚本。这些脚本应该从 C# 进程运行。例如，创建的流程将有一些活动，在中间应该运行脚本，然后流程像以前一样继续。是否有从 C# 运行这些脚本的机制？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T08:04:51.550

基本上，您有两个问题：如何在生成的代码中定义注入点，以及如何从那里运行 python / ruby​​ / whatev 脚本。

根据您生成流程的方式，一种可能的解决方案是向每个可能的注入点添加一个函数。该函数将检查用户是否将任何脚本与给定点相关联，如果是，则通过调用[IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython) / [IronRuby](http://www.ironruby.net/)（可选给定参数）运行脚本。

缺点包括：从脚本到创建的进程的可访问性有限（基本上，只能访问作为参数传递的变量）；以及实现限制（IronPython 的当前版本省略了几个基本的系统函数）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T07:53:06.447

看看 IronPython 和 IronRuby —— 这些将允许您轻松地与 C# 进行互操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T07:52:08.943

**您可以使用CSharpCodeProvider**类从 C# 应用程序中编译 C# 代码。

如果编译成功，您可以运行通过**CompilerResults**类的**CompiledAssembly**属性返回的结果程序集。

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T08:24:37.493

很棒的 C# 脚本语言 - [Script.Net](http://www.codeplex.com/scriptdotnet)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T13:32:23.690

.NET 有一种脚本语言，包括 PowerShell 中的运行时引擎，可以嵌入到任何 .NET 应用程序中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T08:00:51.140

您可以“即时”将 C# 代码编译到内存程序集中。我认为 IronPython 和 IronRuby 也可以做到这一点。查看[CodeDomProvider.CreateProvider](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.codedomprovider.createprovider.aspx)方法。

如果您需要大量运行脚本，或者如果您的进程运行了很长时间，您可能希望将这些程序集加载到另一个 AppDomain 中。完成脚本后卸载 AppDomain。否则，您无法将它们从内存中删除。这对您项目中的其他类有一些后果，因为您必须编组所有调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T08:01:14.227

您是否考虑过 Visual Studio for Applications？自 .NET 1.1 以来，我还没有听到太多关于它的消息，但它可能值得一看。

[http://msdn.microsoft.com/en-us/library/ms974548.aspx](http://msdn.microsoft.com/en-us/library/ms974548.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T08:03:57.230

我最近刚刚做到了这一点——允许在运行时添加 C# 脚本。

一点都不难，这篇文章：

[http://www.divil.co.uk/net/articles/plugins/scripting.asp](http://www.divil.co.uk/net/articles/plugins/scripting.asp)

是一个非常有用的细节总结。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-09T07:46:11.180

Microsoft 针对 C# 中的 JavaScript 的解决方案之一是[ClearScript](https://github.com/microsoft/ClearScript/)，它使用[V8](https://en.wikipedia.org/wiki/V8_(JavaScript_engine))，Chrom 浏览器的 JavaScript 引擎。查看其简短的[常见问题解答](https://microsoft.github.io/ClearScript/Tutorial/FAQtorial)以获取代码示例。

它具有出色的双向集成 - 迭代器/枚举器、输出参数、可选参数、参数数组、委托、任务/承诺/异步/等待、bigint 等。

除此之外，我认为最显着的特点是它不依赖于 Rosyln 或动态语言运行时。这可能是好是坏 - 好是因为依赖项可能会少*很多*（取决于您的项目的目标），坏是因为您需要捆绑原生的、平台相关的 V8 dll。

如果没问题，您就可以享受尖端的 JavaScript / ECMAScript。您在 Chrome 上获得的一切，或截至 2022 年 2 月的[98% ES6](https://kangax.github.io/compat-table/es6/)，以及几个扩展。显然，速度与 Chrome 一样快，因此您可以充分利用 Google 和 Microsoft。

# language-agnostic - 英式英语到美式英语（反之亦然）转换器

> ID：119647
> 
> 赞同：12
> 
> 时间：2008-09-23T07:45:18.057
> 
> 标签：language-agnostic, converter

有谁知道将英式英语转换为美式英语的库或代码，反之亦然？

我不认为有太多差异（想到的一些例子是甜甜圈/甜甜圈、颜色/颜色、灰色/灰色、本地化/本地化），但能够提供本地化的网站内容会很好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-09-08T22:34:46.917

我一直在研究一种将美国英语转换为英国英语的方法。正如我发现的那样，实际上写一些东西来转换另一种方式要困难得多，但我希望有一天能够提供反向转换。

这不是完美的，但它不是一个坏的努力（即使我自己这么说）。它将大多数美国拼写转换为英国拼写，但有些单词英国英语保留了美国拼写（例如，“程序”指的是计算机软件）。它不会将诸如裤子之类的单词转换为裤子，因为我的主要目标只是使整个文档的拼写统一。

还有一些词，如 practice 和 license，英国英语使用这些词或 practice & licence，这取决于该词是用作动词还是名词。对于这两个示例，转换工具将突出显示它们，并且当您将鼠标悬停在它们上方时，屏幕左下方会弹出一个解释性说明。所有转换的单词模式都带有红色下划线，并且输出与原始输入并排显示。

它会很快地处理相当大的文本块，但我更喜欢一次只使用几个段落——从 Word 文档中复制它们。

它仍在进行中，因此如果有人有任何意见或建议，我将不胜感激，我可以使用反馈来改进它。

[http://www.us2uk.eu/](http://www.us2uk.eu/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T08:25:54.200

英国和美国英语之间的差异远远大于拼写差异。还有引擎盖/引擎盖、人行道/人行道、裤子/裤子的想法。

猜猜这取决于你需要走多远。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-09-17T20:50:48.413

我一直在寻找解决方案，但找不到解决方案，因此，我为它编写了自己的代码，使用 varcon 项目和语言专家免费提供的约 20,000 种不同拼写的主列表在wordworldwide：

[https://github.com/HoldOffHunger/convert-british-to-american-spellings](https://github.com/HoldOffHunger/convert-british-to-american-spellings)

因为我有两个源列表，所以我用它们来相互交叉检查，我发现了许多错误和拼写错误（varcon 将“preexistent”的英国等价物列为“preaexistent”）。我也可能不小心打错了字，但是，由于我在这里没有进行任何文字修饰，所以我不认为是这种情况。

例子：

```
require('AmericanBritishSpellings.php');
$american_british_spellings = new AmericanBritishSpellings();

$text = "Axiomatically ax that door, would you, my neighbour?";
$text = $american_british_spellings->SwapBritishSpellingsForAmericanSpellings(['text'=>$text]);

print($text);   // output: Axiomatically axe that door, would you, my neighbor? 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T08:38:21.207

我认为，如果您正在考虑从美式英语转换为英式英语，我个人不会打扰。无论如何，英国已经非常美国化了，我们在网上接受愚蠢的 yank 拼写:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-09-24T07:57:27.333

我最近遇到了类似的问题。我发现了以下工具，称为[VarCon](http://wordlist.aspell.net/varcon/)。我还没有测试过，但我需要一个粗略的转换器来处理一些文本数据。这是一个例子。

```
echo "I apologise for my colourful tongue ." | ./translate british american
# >> I apologize for my colorful tongue . 
```

看起来它适用于各种方言。请务必阅读自述文件并谨慎操作。

*注意：这只会更正拼写变化。

# python - 在两个二进制文件中查找匹配序列

> ID：119651
> 
> 赞同：2
> 
> 时间：2008-09-23T07:46:02.563
> 
> 标签：python, binary, diff, antivirus

让我从一些背景开始。

今天早上，我们的一位用户报告说，Testuff 的安装文件已被 CA 防病毒报告为感染了病毒。确信这是误报，我在网上查看，发现另一个程序 (SpyBot) 的用户报告了同样的问题。

现在，对于实际问题。

假设防病毒软件正在文件中寻找特定的二进制签名，我想在两个文件中找到匹配的序列，并希望找到一种方法来调整设置脚本以防止该序列出现。

我在 Python 中尝试了以下方法，但它已经运行了很长时间，我想知道是否有更好或更快的方法。

```
from difflib import SequenceMatcher

spybot = open("spybotsd160.exe", "rb").read()
testuff = open("TestuffSetup.exe", "rb").read()

s = SequenceMatcher(None, spybot, testuff)
print s.find_longest_match(0, len(spybot), 0, len(testuff)) 
```

有没有更好的 Python 库或其他语言可以做到这一点？也欢迎采用完全不同的方式来解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T08:00:13.137

请参阅[最长的公共子串问题](http://en.wikipedia.org/wiki/Longest_common_substring_problem)。我猜 difflib 使用了 DP 解决方案，这对于比较可执行文件来说肯定太慢了。使用后缀树/数组可以做得更好。

使用 perl [Tree::Suffix](http://search.cpan.org/~gray/Tree-Suffix-0.20/lib/Tree/Suffix.pm)可能是最简单的解决方案。显然它给出了指定长度范围内的所有常见子字符串：

```
@lcs = $tree->lcs;
@lcs = $tree->lcs($min_len, $max_len);
@lcs = $tree->longest_common_substrings; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T08:30:15.063

请注意，即使您确实以这种方式找到它，也不能保证最长的匹配实际上就是正在寻找的匹配。相反，您可能会发现由同一编译器添加的常见初始化代码或字符串表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T07:51:00.257

你为什么不联系 CA 并要求他们告诉他们他们正在寻找什么病毒？

或者，您可以复制文件并更改每个单独的字节，直到警告消失（可能需要一段时间，具体取决于大小）。

病毒检测可能比简单地查找固定字符串要复杂得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T07:55:47.890

最好不要怀疑这些算法需要的复杂性和时间。

如果您对此处[链接的此 .ps 文档](http://www.acm.org/jea/ARTICLES/Vol4Nbr2.ps)感兴趣，您可以找到对该主题的良好介绍。

如果存在这些算法的良好实现，我无法判断。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T12:14:51.543

我怀疑寻找二进制字符串对你没有帮助。安装程序可能会做一些“可疑”的事情。

您可能需要与 CA 和 spybot 讨论将您的安装程序列入白名单或触发警报的原因。

# asp.net - Winform 应用程序/ASP.NET 应用程序与 SAP 数据库的连接

> ID：119669
> 
> 赞同：2
> 
> 时间：2008-09-23T07:49:48.577
> 
> 标签：asp.net, sap, connectivity

如何从 SAP 数据库中获取 Winforms 应用程序或 ASP.NET 表单中的数据？使用的 .NET 框架是 2.0。，语言为 C#，SAP 版本为 7.10。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T09:44:11.873

不确定这是否适合您，但有一个 C 库，它可能可以从您的 C# 应用程序中使用，它提供了一个非常简单的 API 来调用 SAP 中的 BAPI。（不建议直接通过 SQL 访问底层数据库...最好使用 BAPI 或定制的支持 RFC 的功能模块。）参见[http://service.sap.com/rfc-library](http://service.sap.com/rfc-library)

您也可以使用“Microsoft .NET 的 SAP 连接器”（来自上面的同一链接），但它是使用 .NET 1.1 开发的，并且可能与 .NET 2.0 存在兼容性问题？！

更新 (2011)：自 2010 年 12 月以来，有一个新版本的“Microsoft .NET 的 SAP 连接器”可用，它适用于 .NET Frameworks 2.0、3.5 和 4.0。现在这将是您问题的完美解决方案！请参阅[http://service.sap.com/connectors](http://service.sap.com/connectors) ---> 适用于 Microsoft .NET 的 SAP 连接器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T23:13:29.087

为插件道歉....我为 ERP-Link 工作，我们有一个产品 iNet.BPS，它是一个 VS2005 插件，可帮助您创建代理对象，您的 .NET 代码可以使用这些代理对象来调用 BAPI在 SAP 系统上。iNet.BPS 允许您自定义 BAPI 方法调用，例如，它允许您省略应用程序未使用的可选参数，从而通过不必将十几个参数传递给 BAPI 来简化您的代码。该产品不依赖于 SAP AG 的 SAP Connector for .NET。

这是营销页面的链接，[http://www.erp-link.com/html/product/product-overview-iNetBPS_Overview.asp](http://www.erp-link.com/html/product/product-overview-iNetBPS_Overview.asp)

# sql - 表中的存储过程列表

> ID：119679
> 
> 赞同：8
> 
> 时间：2008-09-23T07:52:43.920
> 
> 标签：sql, sql-server, stored-procedures

我有一个包含 100 个表和存储过程的庞大数据库。使用 SQL Server 2005，如何获取对给定表执行插入或更新操作的存储过程列表。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-23T14:27:48.183

`sys.sql_dependencies`有一个具有依赖关系的实体列表，包括 sproc 在查询中包含的表和列。有关获取依赖项的查询示例，请参阅[这篇文章。](https://stackoverflow.com/questions/69923/stored-procedures-reverse-engineering#93967)下面的代码片段将通过存储过程获取表/列依赖项列表

```
select sp.name       as sproc_name
      ,t.name        as table_name
      ,c.name        as column_name
 from sys.sql_dependencies d
 join sys.objects t
   on t.object_id = d.referenced_major_id
 join sys.objects sp
   on sp.object_id = d.object_id
 join sys.columns c
   on c.object_id = t.object_id
  and c.column_id = d.referenced_minor_id
where sp.type = 'P' 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-23T08:02:49.903

```
select
  so.name,
  sc.text
from
  sysobjects so inner join syscomments sc on so.id = sc.id
where
  sc.text like '%INSERT INTO xyz%'
  or sc.text like '%UPDATE xyz%' 
```

这将为您提供所有存储过程内容的列表，其中包含特定表的 INSERT 或 UPDATE（您显然可以调整查询以适应）。此外，较长的过程将在返回的记录集中的多行中中断，因此您可能需要对结果进行一些手动筛选。

**编辑**：调整查询以返回 SP 名称。另外，请注意上述查询将返回任何 UDF 以及 SP。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T08:01:57.377

使用 sys.dm_sql_referencing_entities

请注意 sp_depends 已过时。

[MSDN 参考](http://msdn.microsoft.com/en-us/library/bb630351.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T07:56:42.507

您可以尝试将所有存储过程导出到文本文件中，然后使用简单搜索。

更高级的技术是使用正则表达式搜索来查找所有 SELECT FROM 和 INSERT FROM 条目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T08:08:09.513

这似乎有效：

```
select   
so.name as [proc],   
so2.name as [table],   
sd.is_updated   
from sysobjects so   
inner join sys.sql_dependencies sd on so.id = sd.object_id  
inner join sysobjects so2 on sd.referenced_major_id = so2.id  
where so.xtype = 'p' -- procedure  
and is_updated = 1 -- proc updates table, or at least, I think that's what this means 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T09:48:48.853

如果您从 Vyaskn 的网站下载 sp_search_code，它将允许您在数据库对象中找到任何文本。

[http://vyaskn.tripod.com/sql_server_search_stored_procedure_code.htm](http://vyaskn.tripod.com/sql_server_search_stored_procedure_code.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T08:00:36.037

```
SELECT Distinct SO.Name
FROM sysobjects SO (NOLOCK)
INNER JOIN syscomments SC (NOLOCK) on SO.Id = SC.ID
AND SO.Type = 'P'
AND (SC.Text LIKE '%UPDATE%' OR SC.Text LIKE '%INSERT%')
ORDER BY SO.Name 
```

[此链接](http://www.knowdotnet.com/articles/storedprocfinds.html)被用作 SP 搜索的资源。

# audio - 将音频转换为代码，反之亦然

> ID：119691
> 
> 赞同：3
> 
> 时间：2008-09-23T07:54:55.897
> 
> 标签：audio

刚刚在 Nintendo DS 游戏[Bangai-O Spritis上见证了](http://en.wikipedia.org/wiki/Bangai-O_Spirits)[Sound Load 技术](http://www.youtube.com/watch?v=PEnfpQa3nrI&feature=related)。我很好奇这项技术是如何工作的？有没有人有任何关于实现这种功能的链接、文档或示例代码，可以通过音频保存和加载应用程序的状态？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T08:05:19.630

它与 ZX Spectrum 时代使用的旧东西相同。您从磁带加载程序/游戏。只有音质和过滤器可能更好。

在我看来，蓝牙或 WiFi 之类的东西更好。您还可以发送可以放在某些存储上的文件，然后加载它们。我发现这些方法比声音容易得多，因为如果周围有很多噪音，你就无能为力了。

它只是将数据转换为音频，然后从音频转换回数据。

在 google 上搜索 Zotyocopy 和 Copy86M - 这些是用于将游戏加载到 zx 频谱上的内存后将其保存到磁带的实用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T08:21:01.370

如果您想通过空气将数据作为音频传递，则需要注意一些事项，例如扬声器和麦克风的交互方式。重要的是它们不会过多地扭曲或改变声音，因为您发送的实际上是原始字节。
一些音频软件会让您将任何文件作为音频打开，以便您收听。如果您将音频录制为数据，请不要对音频文件使用 mp3 等有损压缩！

# flash - 替换 SWF 中的字符串

> ID：119694
> 
> 赞同：7
> 
> 时间：2008-09-23T07:55:16.520
> 
> 标签：flash

我们已经为大型 Flash 项目的不同客户修改了数十个版本的 SWF，现在必须替换每个副本中嵌入脚本中的一些字符串。其中一些的 FLA 文件很难找到甚至丢失（我继承了这个烂摊子并且重构它目前不是一个选项）。

是否有（免费）工具可以替换 ActionScript 中使用的字符串？我尝试 swfmill 将文件转换为 XML 并返回，但它无法处理字符串中包含的国际字符，因此我只能部分转换它们。大多数字符串都已正确提取，因此另一个工具可能会完成这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-02T18:28:06.177

你可以试试 Burak 的[URL 动作编辑器](http://www.buraks.com/uae/)——它说的是 URL，但我很确定它可以让你编辑 SWF 中的任何文本。我没用过，但我用过他的 ActionScript Viewer，效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-25T11:09:20.980

您可以将[Apparat](http://apparat.googlecode.com/)用于此类任务。它允许您更改 SWF 和 SWC 文件中的 ActionScript 3 字节码。

对于您的任务，我更喜欢 Scala 源分支。基本上代码如下所示：

```
val swf = Swf from "in.swf"
for(tag <- swf.tags) {
  (Abc fromTag tag) match {
    case Some(abc) => {
      val strings = abc.cpool.strings
      for(i <- 1 until strings.length) {
        if(strings(i) == 'search) {
          strings(i) = 'replacement
        }
      }
      abc write tag
    }
    case None =>
}
swf write "out.swf" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T09:48:15.920

那么我能想出的唯一建议是修复 swfmill 以支持国际字符。您可能想在 swfmill 邮件列表（据我所知 swfmill@swfmill.org）中询问最佳方法，如果您了解 C/C++ 一点，应该不会太难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T20:31:01.133

如果文件使用 actionscript 2，也许您可​​以使用[http://flasm.sourceforge.net/](http://flasm.sourceforge.net/)进行反汇编和重组（当然：在重组之前修改字符串）。对于 as3，adobe 提供了一个反编译器，可以用来实现相同的目标，但如果你继承了它，我认为你的 flash 不会是 as3。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-02-26T19:12:03.053

这个也很好用，而且是免费的：

[http://www.free-decompiler.com/flash/](http://www.free-decompiler.com/flash/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T09:45:15.647

棘手 - 它可能不会更容易，但你可以将“锁定”的 swf 加载到你控制的一个，然后蜘蛛通过它的对象直到你点击 TextBox，使用一些 for...in 循环 - 这将是一个漫长而艰巨的将它们映射出来然后更改它们的过程，特别是如果以前的开发人员没有以有用的方式命名事物，但如果它是一个相当简单的 .swf 那么它可能太糟糕了......

此外，还有一个仅用于反编译 swfs 的 mac 实用程序，我记得有一个同事发誓，但我不记得这个名字......有人吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T11:24:22.133

艰难的——你试过[Sothink](http://www.sothink.com/)反编译器吗？如果这不起作用，我会说尝试将 swf 加载到另一个 swf 中，然后向下钻取并更改文本字段的内容 -`_root.loadedswf.clip1.box2.textField.text = "New text";` 显然，如果应用程序很复杂，这可能不起作用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-15T07:06:53.823

这个怎么样？ [http://code.google.com/p/swfreplacer/wiki/Intro](http://code.google.com/p/swfreplacer/wiki/Intro)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-25T10:43:12.877

在我看来，swfmill 已经更新了他们的工具以支持国际字符，至少对于拉脱维亚语言（需要 UTF-8）。字符串被编码为 HTML 实体。

解决了遗留 swf 文件的一些类似问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-15T11:41:42.323

您可以尝试[Swiffotron](https://github.com/izb/Swiffotron)，它包括在舞台和动作脚本中替换文本的能力。

这是[来自项目的单元测试输入文件，](https://github.com/izb/Swiffotron/blob/master/SwiffotronTest/res/TestTextReplace.xml)它显示了它是如何完成的：

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-26T18:39:14.310

Apparat 最终为此工作得很好（我有一些需要修改的旧文件）。我无法让 Joa 的 Scala 代码工作，所以我最终用 Java 实现了他的解决方案。

1.  下载[二进制文件](https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/apparat/apparat-1.0-SNAPSHOT-bin.tar.gz)。
2.  确保安装了 Scala（仍然需要这些库，即使解决方案是纯 Java 的）。
3.  使用适当的类路径（指向带有 Apparat 二进制文件以及您的 Scala 库的文件夹）编译并运行以下代码。
    1.  `javac -classpath ".;apparat/*;C:/path/to/scala/lib/*" SwfEditor.java`
    2.  `java -classpath ".;apparat/*;C:/path/to/scala/lib/*" SwfEditor`

```
import apparat.swf.Swf;
import apparat.abc.Abc;
import apparat.swf.SwfTag;
import scala.collection.Iterator;
import scala.Symbol;
import apparat.swf.DoABC;

class SwfEditor {

  public static void main(String[] args){
    Swf input = Swf.fromFile("in.swf");
    Iterator<SwfTag> iter = input.tags().iterator();
    while (iter.hasNext()) {
      SwfTag tag = iter.next();
      if(tag instanceof DoABC) {
        DoABC doABCTag = (DoABC) tag;
        Abc abc = Abc.fromTag(doABCTag).getOrElse(null);
        Symbol[] strings = abc.cpool().strings();
        for(int i=0; i<strings.length; i++) {
          String string = strings[i].toString();
          if(string == "'search")) {
            strings[i] = new Symbol("replacement");
          }
        }
        abc.write(doABCTag);
      }
    }
    input.write("out.swf");
  }
} 
```

# java - Vista皮肤l&f

> ID：119696
> 
> 赞同：3
> 
> 时间：2008-09-23T07:55:44.007
> 
> 标签：java, windows-vista, themes

网络上是否有免费的 Java Vista 外观和感觉主题包？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T10:17:40.123

我猜你想要的是使用系统的外观和感觉，不管你的应用程序是在什么平台上启动的。这可以通过

```
UIManager.setLookAndFeel( UIManager.getSystemLookAndFeelClassName() ); 
```

在 main() 方法上（当然，您必须处理可能的异常;-)。

由于我这里没有安装 vista，我无法检查 jvm 是否本机支持 vista laf ...

编辑：上面的陈述似乎是可能的。在 Java 论坛中查看此线程：

[http://forums.sun.com/thread.jspa?threadID=5287193&tstart=345](http://forums.sun.com/thread.jspa?threadID=5287193&tstart=345)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T08:00:59.390

如果您使用 SWT，它具有内置的原生 vista 外观和感觉。但是，如果您使用的是 swing，我真的不知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T20:44:39.180

在 Vista 上使用 Java6u13 显示了相当不错的 Windows LookAndFeel。它和 Java 一样免费。

Sun 有一个关于 LookAndFeel 用法的教程[，](http://java.sun.com/docs/books/tutorial/uiswing/lookandfeel/plaf.html)如果您想玩[SwingSet 演示](http://java.sun.com/products/jfc/jws/SwingSet2.jnlp)，它会向您展示 System LookAndFeel 并让您更改它。然后您可以了解 LookAndFeel 的外观。打电话

```
UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
```

正如[dhiller](https://stackoverflow.com/questions/119696/vista-skin-lf#120198)建议的那样，将根据您的系统设置外观。如果您想了解 Vista 的外观和感觉，您将需要 Vista。

如果您想要与金属外观和感觉不同的东西，另一种选择是使用[Substance](https://substance.dev.java.net/)或[Nimbus 。](https://nimbus.dev.java.net/)Substance 是一个单独的外观和感觉集合，Nimbus 在 6u10 版本中可用。

# winapi - 如何获取我自己代码的模块句柄？

> ID：119706
> 
> 赞同：14
> 
> 时间：2008-09-23T07:57:00.103
> 
> 标签：winapi, dll

> **可能重复：**
> [如何获取当前执行代码的 HMODULE？](https://stackoverflow.com/questions/557081/how-do-i-get-the-hmodule-for-the-currently-executing-code)

我正在尝试在我自己的模块中查找资源。如果这个模块是一个可执行文件，那很简单——`GetModuleHandle(NULL)`返回“主”模块的句柄。

然而，我的模块是一个由另一个可执行文件加载的 DLL。所以`GetModuleHandle(NULL)`会将模块句柄返回给那个可执行文件，这显然不是我想要的。

有没有办法确定包含当前运行代码的模块的模块句柄？在调用中使用 DLL 的名称`GetModuleHandle()`对我来说似乎是一种 hack（如果有问题的代码被移植到不同的 DLL 中，则不容易维护）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-23T08:04:42.987

在 DllMain 中将模块句柄提供给您时将其存储起来，然后在您实际需要时使用它。许多框架（例如，MFC）会自动执行此操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-10T16:29:29.917

如果 DLL 与 MFC 链接，那么有一种方法可以获取调用某些函数的 DLL 实例：

```
void dll_function()
  {
  AFX_MANAGE_STATE(AfxGetStaticModuleState());
  HINSTANCE dll_instance = AfxGetInstanceHandle();
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T23:59:16.453

如前所述，这可以通过保存传递给 DllMain 函数的模块句柄来完成。

但是还有其他原因应该保存句柄。

例如，如果您决定使用资源链接器将资源绑定到 DLL，则需要此模块句柄才能通过**LoadResource**函数 API 获取这些资源。

# database - 最大的缺点是什么 ?

> ID：119707
> 
> 赞同：3
> 
> 时间：2008-09-23T07:57:01.880
> 
> 标签：database, rdbms, platform-agnostic

我们都有自己喜欢的数据库。如果您客观地看待您选择的数据库，它有哪些缺点以及可以改进的地方？

规则：

*   每个缺点回复一个；
*   限制的简短描述，然后是；
*   更详细的描述，对如何做得更好的解释或不具有相同限制的另一种技术的示例。

*   不要diss任何您没有广泛使用的数据库。对其他技术进行攻击很容易，但我们希望从您的经验中学习，而不是您的偏见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T08:00:04.137

Oracle 数据库相当昂贵

甲骨文做得很好，但许可成本非常可怕。Oracle XE 的发布已经改善了这一点，但它的局限性意味着它是您解决方案的增长限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T09:00:29.687

**数据库**PostgreSQL

**缺陷**无 SQL Profiler

我们在最近的一次会议上向开发人员询问了这个问题，我知道他们现在正在寻求实施。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T08:19:19.237

**数据库**Microsoft SQL Server 2005

**缺少“插入或更新”的**缺陷****

 ****描述**

通常您需要在表中插入或更新记录，具体取决于记录是否存在。没有原子操作会导致不必要的事务。

MySQL 或 SQLServer 2008 不会发生这种情况。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T19:28:43.403

与其他数据库自动增量相比，我喜欢 Oracle 中序列的灵活性，但是无法将 seq.nextval 设置为 pk 列的默认值有点烦人，而且必须很容易修复。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-28T13:02:32.720

数据库：甲骨文

问题：表、过程、列等的名称不能超过 30 个字符。这真让人生气。

问题：这是草率的 JDBC 合规性。例如，存储过程不以符合 JDBC 的方式返回结果集，而是以专有的 OUT 参数类型返回。这意味着您不能使用更高级别的 JDBC 抽象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T16:19:52.967

**Database** Oracle

**Defect** Did not handle long datatype well for too long

**Description**

Oracle only had the long datatype until 9i (I believe) at which point it was deprecated in favor of the LOBs. There is a ton of code out there, however, which still has longs and all of the related restrictions. The biggest of which was that each table could only have one long column and it had to be at the end of the columns. See [here](http://arjudba.blogspot.com/2008/06/long-datatype-in-oracle.html) for a more exhaustive list of restricitons on the long.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T08:56:07.637

**数据库**MySQL 5.0.x 及以上

**缺陷**环复制错误导致不同节点上的数据不一致

**描述**

目前我们在生产中面临的最严重的问题是，在 MySQL 环中，环本身会产生错误并停止复制。

从 5.xx 开始可以构建环（或 Master-Master-replication）：您将数据库链接在一个“环”中，以便相互复制数据。每个数据库节点都从所有其他节点获取所有更改。

我们假设错误在于自动增量失败。这也可以从正常复制中得知，但在新版本中，错误日志中没有足够的错误消息。只要这里的问题没有解决，我强烈建议不要在 MySQL 中使用这个特性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-23T08:07:45.507

**数据库**Microsoft SQL Server 2005

**缺陷**糟糕的 UI 实现

**描述**

SQL Server 管理工作室不提供出色的用户体验：

*   选项卡行为很奇怪：您总是在寻找正确的选项卡
*   在 64 位版本上不断崩溃
*   缺少之前版本的一些特性，例如存储过程授权的概述

2000 版不会发生这种情况。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-23T08:13:10.970

**数据库**MySQL

**仅在某些表类型上支持**缺陷外键****

 ****描述**

说够了。它具有明显的维护意义。

来自[MySQL 手册](http://dev.mysql.com/doc/refman/5.0/en/innodb-foreign-key-constraints.html)

> 外键定义受以下条件约束：
> 
> *   两个表都必须是 InnoDB 表，并且不能是 TEMPORARY 表。

[在](http://dev.mysql.com/doc/refman/5.0/en/ansi-diff-foreign-keys.html)这里：

> 对于 InnoDB 以外的存储引擎，MySQL Server 解析 CREATE TABLE 语句中的 FOREIGN KEY 语法，但不使用或存储它。

任何其他主要数据库都不会发生这种情况。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-23T08:21:21.403

**数据库**MySQL
**缺陷**服务器将使用损坏的表启动
**描述**

如果 MySQL 有一个损坏的表 - 在写入期间被杀死或其他一些故障 - 它会非常高兴地启动并允许用户继续进行，就好像问题不存在一样. 当然，它会在日志中产生一些错误消息，但根据我的经验，当您试图找出应用程序行为异常的原因时，这无济于事。

大多数其他数据库将在启动时检测并修复错误，或者只是拒绝以任何形式的损坏启动。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-23T08:02:48.980

**数据库**Microsoft SQL Server

**缺陷**巨大的许可成本

**描述**

SQL Server 具有强大的功能，它与 .NET 开发集成得非常好。问题是，当您必须从共享数据库扩展到专用数据库时，许可成本非常高。实际上，这导致数据库应该真正运行在专用服务器上，托管在具有性能和安全问题的共享服务器上。

MySQL 或 PostgreSQL 不会发生这种情况。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-23T20:45:16.153

**数据库**甲骨文

**问题**临时表定义不是私有的

**描述**许多数据库（例如 Postgres 和 Sybase）允许您动态创建临时表、插入其中、添加索引（如果需要），然后从它们中查询。Oracle 有临时表，但临时表定义存在于全局名称空间中。因此临时表必须由 DBA 创建，您需要在他们使用的表定义和您的代码之间进行同步，如果两段代码需要相似（但不相同）的表定义，则它们需要使用不同的名称。这些差异使临时表对开发人员来说不太方便。

是的，我了解查询优化器拥有全局定义的好处。然而对我来说，缺乏便利性使得 Oracle 的临时表对我来说几乎毫无用处，而我在 Postgres 中非常密集地使用它们。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-23T16:09:58.263

**数据库**Postgres

**缺陷**无分析查询

**描述**

Oracle 引入的分析查询是 SQL 2003 标准的一部分。不幸的是，Postgres 还没有实现它们。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-23T08:07:22.263

**数据库**：Sql 精简版

**缺点**：不支持存储过程。

不管这个限制如何，这个数据库有它的用途，特别是作为可以是智能客户端或分发到移动平台的应用程序的客户端缓存。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-23T08:16:01.167

**数据库**甲骨文

**包上授予的**缺陷粒度****

 ****描述**

您只能授予对包的权限，而不能授予对包内的存储过程的权限。或者，您可以授予对单个存储过程的权限，然后将它们放在包之外。这需要您预先知道谁将使用哪个存储过程，并且很难重构。

SQL Server 不会发生这种情况。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-23T08:21:33.757

**数据库**Microsoft SQL Server 2005

**缺陷**缺少数组类型参数

**描述**

在搜索中很有用，很多时候您需要传递一系列要匹配的值。在 SQL 2005 中，您可以通过在 SQLServer 中使用 CLR 来解决问题。鉴于有用性，开箱即用此功能会更有意义。

SQL Server 2008 或 Oracle 不会发生这种情况。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-23T08:00:48.660

PostgreSQL 没有一个好的故障转移解决方案，但我知道他们正在努力解决这个问题。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-23T20:48:14.960

**数据库：PostgreSQL**

**问题：** 例如，用于 C# 的连接器并不是最新的，并且会因高级功能而崩溃。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-11-17T20:40:34.513

数据库：全部

缺点 - 那些认为在设计数据库时知道自己在做什么并不重要的人的糟糕设计。糟糕的设计在所有数据库中造成的问题比任何缺失的功能都多得多。所以我想他们都缺少“阅读我的想法并找出最佳解决方案而无需我思考”的功能。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-11-30T00:21:36.030

任何 SQL DBMS

缺陷：重复的行

关系模型的优点之一是它表示没有重复元组的所有内容，即使用具有键且没有重复的关系。不幸的是，SQL 不是这样构建的。这使数据库开发人员的生活变得不必要地困难。SQL 开发人员必须处理没有键的表并调试返回重复行的查询。

# xhtml - 输出有效的 HTML 是否值得开发时间？

> ID：119723
> 
> 赞同：13
> 
> 时间：2008-09-23T08:01:01.233
> 
> 标签：xhtml, strict

开发网站非常耗时。为了提高生产力，我会编写一个原型来展示给我们的客户。我不担心使原型符合标准。大多数时候，我们的客户会批准原型并给出不合理的截止日期。我通常最终在生产中使用原型（嘿，原型有效。不需要让我的工作变得更难。）

我可以重构代码以输出有效的 HTML。但是输出有效的 HTML 值得付出努力吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-23T08:13:53.167

只有当它给你带来实际的好处时，它才值得付出努力。坚持标准可能会更容易构建一个适用于大多数浏览器的网站。再说一次，如果您对网站在您关心的浏览器上的显示方式（可能是一个，也可能是全部）感到满意，那么费尽心思让它通过验证就是浪费时间。

此外，完全有效的 html 网站和大部分有效的 html 网站之间的 SEO 差异可以忽略不计。

所以总是寻找实际的好处，在某些情况下有一些，但不要仅仅为了它而这样做。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-23T08:04:06.717

是的。尝试处理不同的浏览器如何呈现有效的 HTML 已经够难的了，更不用说尝试预测它们将如何处理无效代码了。搜索引擎也是如此——HTML 中存在足够多的问题可能会导致网站没有被正确索引或根本没有被索引。

我想真正的答案是“这取决于 HTML 的无效之处”。如果无效部分与可访问性问题有关，如果您的客户出于商业目的使用该网站，您甚至可能会发现他们存在法律问题。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-23T08:04:32.223

如果您有一个不合规的网站并且时间紧迫，则可能不会。

但是，您不会相信我，因为我从一开始就不相信其他人，但是从一开始就使网站兼容更容易 - 它可以在浏览器兼容性、CSS 行为甚至 JavaScript 行为方面为您省去头疼的问题，并且它通常需要维护的标记较少。

网站合规性（至少是过渡性的）非常容易。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-23T08:42:15.843

生成兼容的 HTML 类似于确保您在编译期间没有警告 - 警告是有原因的，您可能没有意识到那个原因是什么，但忽略警告，在您知道自己在哪里之前，有很多，您无法发现与您要解决的问题相关的问题。

如果您使用 Firefox 查看您的网页，您会在右下角看到一个有用的绿色勾号或红叉，快速显示您是否已遵守。点击一个红十字会显示所有你犯错的地方。一些警告/错误可能看起来有点迂腐，但修复它们，你会在很多方面受益。

1.  您的页面更有可能与更广泛的浏览器一起使用。
2.  可访问性合规性将更容易（例如，您的图像上将具有“alt”属性）
3.  如果您选择 XHTML 作为标准，您的标记将更有可能在 AJAX 环境中有用。

不这样做会导致不可预测性。

Web 浏览器的最大问题之一是它们通过默默地纠正某些标记问题（例如无法关闭表格单元格和/或行）而使坏习惯永久存在（在某些情况下仍然如此）。这一事实导致了数以千计的网页不合规但“工作”，使他们的开发人员陷入一种虚假的安全感。

当您考虑网站有多少可能出错的地方时，在合规性方面懒惰只会给您的工作量增加更多问题。

编辑：再次阅读您的原始帖子后，我注意到您说您在制作原型时不关心合规性，然后您继续说您通常在生产中使用原型 - 这意味着它不是严格意义上的原型，而是一个候选人。这种情况下的正常情况是，一旦客户接受了候选人，就没有时间分配给错误修复或整理的时间，从而加强了首先使标记合规的论据。

如果以后不给你时间，现在就去做。

如果你以后有时间，那么无论如何你都有时间去做。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-23T08:19:10.987

如果您希望残障人士和非残障人士以及外部系统都能访问您的视力，那么是的，您绝对应该确保输出有效的 HTML。

[使用自动验证器](http://validator.w3.org/)很容易测试您的 HTML 。

我将补充迈克爱德华兹关于法律后果的说法，并提醒你你也有道德义务:)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-23T10:25:30.683

为什么不首先用有效的 (X)HTML 编写原型呢？我从来**没有**发现这比使用无效的 HTML 更费力。生成有效的 XHTML 应该是一项微不足道的任务。（另一方面，产生*语义上有意义的*XHTML 可能更费力。）

简而言之，我认为对原型使用无效的 HTML*没有任何好处*。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-23T08:35:07.953

老实说，我不知道为什么要做基于标准的 HTML 是额外的努力。这并不难，你应该把它作为一个专业的问题来做。

如果你花钱请人给你盖房子，他偷工减料，你当时没有注意到，但10年后你的墙上出现了裂缝，你会高兴吗？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-23T08:26:24.197

绝对地。无效代码会导致各种奇怪的行为，以及不会掩盖在您获得验证报告时所做的错误。

一个例子：

黄色背景从消息列表中溢出，并覆盖在下一个消息列表的标题上 - 但仅在 Internet Explorer 中。

为什么？背景应用于列表项，但编写页面的人将其编写为一个列表，中间有一个标题。*列表项之间*不允许使用标题，并且不同的浏览器尝试以不同的方式从中恢复。Internet Explorer 在看到下一个项目的开始（在标题之后）时结束了列表项（带有背景颜色），而其他浏览器在看到第一个列表项的结束标记时结束了它。

这是页面上唯一的有效性错误，因此只需几分钟即可找到问题并进行修复。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-23T08:31:25.467

有效的 HTML 只是为了能够在您的网站上拥有徽章 - 不。

在“适用于每个主要浏览器或浏览器引擎的 HTML”的意义上拥有“有效的 HTML”——是的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-23T10:34:53.047

因为，如果您坚持标准，您的工作将在未来兼容。用户代理将努力实现标准合规性，他们的怪癖不合规模式总是会发生变化。这是应该的方式。

除非您对他们想要默认启用的整个 IE8 破坏标准永久化感兴趣。——这是另一个论点。
Webkit、Gecko、Presto？（那是歌剧的引擎吗？），而其他人总是会变得更加顺从每个版本。

除非您的 html 工作在 IE 嵌入式浏览器控件中，否则只要呈现有效的 html，就没有理由输出它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-23T12:46:19.720

在我看来，关键标准是“适合目的”——如果您的客户想要一些适合小型/内部市场的东西（并且不在乎这是否会疏远有残疾或使用不太常见的浏览器的潜在客户），那么这就是他们的选择。

同时，我认为我们（作为开发人员）有责任确保他们了解其决策的含义——一些组织将受到法律要求的约束，即屏幕阅读器可以使用网站，这通常意味着符合标准的 HTML。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-22T07:28:35.967

我相信，如果您从一开始就训练自己编写有效的 html 代码，那么制作有效的 html 输出不会对您的开发时间造成太大影响。

一方面，不难知道元素中不允许使用哪些标签，并且标签中
的必需属性有时是您真正需要的属性 - 我相信这些是使您的 html 无效的主要错误，所以为什么如果您打算长期留在网络上，不只是尽早学习它们吗？
加上输出有效的 html 可以帮助提高您的网站排名

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2008-09-23T10:22:00.800

写网站有两条规则：

1.  该网站必须为您的用户工作。
2.  该网站必须为您的用户工作。

为了满足第一条规则，您必须编写代码以使您的网站在使用 Internet Explorer 时能够正确呈现。除非您可以自由更改您的网站设计以仅使用 IE 正确呈现的那些功能，否则这意味着编写无效的 HTML。

为了满足第二条规则，您必须编写代码，以使您的网站在使用屏幕阅读器和盲文屏幕时能够正确呈现。尽管一些较新的屏幕阅读器可以与以 IE 为目标的网站一起使用，但通常这意味着编写有效的 HTML。

如果您正在处理一个小型项目，或者您是大型团队的一员，您可以编写一个网站，为 IE 输出以 IE 为目标的 HTML，否则为有效的 HTML。但是，如果您要自己承担一个大中型项目，则必须决定要遵循哪条规则以及要忽略哪条规则。

更新：

这被认为您总是可以在 IE 中使用有效 HTML 的用户投票否决。如果您可以灵活地更改设计以解决 IE 的缺点，这可能是正确的，但是如果客户给了您一个设计并且您必须让它工作，您可能不得不求助于无效的 HTML。这很可悲，但这是真的，不管他们怎么想。

# continuous-integration - 在持续集成中，处理外部应用程序依赖关系的最佳方法是什么

> ID：119724
> 
> 赞同：1
> 
> 时间：2008-09-23T08:01:03.480
> 
> 标签：continuous-integration, dependencies, teamcity

在使用我们的 TeamCity 持续集成服务器时，我们发现了一些我们不确定最佳处理方式的问题。即如何在 CI 服务器上引用我们的应用程序需要的外部应用程序。

这最初是在对 Crystal Reports 的依赖中发现的，因此我们在服务器上安装了 Crystal Reports，以解决当前的问题。然而，随着我们将更多的应用程序转移到 CI 服务器上，我们发现了更多的依赖关系。

这里最好的策略是什么？是否继续在服务器上安装所需的应用程序？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T08:07:44.943

尽可能使外部依赖项成为构建系统的一部分。例如，将安装程序签入您的版本控制系统，并有一个步骤将其签出并在静默模式下运行（许多安装程序支持有时使用命令行 /s 的无用户操作模式）。

这样，如果您需要为分支或仅为新硬件设置另一台构建机器，一切都是可重复的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T16:53:31.533

如果您的构建需要实际的应用程序来完成构建，那么您可能应该继续在构建服务器上安装应用程序。

如果您只需要引用应用程序中的 dll 或程序集，那么我们在我公司所做的就是创建特定应用程序所需引用的可安装“SDK”，并将它们安装在我们的开发和构建机器上我们的解决方案引用的库目录。

在构建机器上，我们的预构建步骤会安装正确版本的依赖项，然后在完成后清理它们。

最近，我们开始将虚拟机用于我们的构建过程激活的构建机器。这些 VM 将 SDK 作为预构建安装在其上，然后在构建后恢复到它们的快照状态。我们有一些几乎不可能卸载的依赖项，因此每次都是一个干净的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T08:03:50.070

如果你使用 Maven 构建，你可以在 pom.xml 文件中定义你的依赖。如有必要，它们将被自动下载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T08:05:10.973

我不确定我是否正确遵循...

我假设您的应用程序在构建时依赖于这个外部应用程序？在那种情况下，它应该在机器上做 CI ......

# sql - 如何在 SQL Server 中对包含数字的 VARCHAR 列进行排序？

> ID：119730
> 
> 赞同：57
> 
> 时间：2008-09-23T08:01:51.590
> 
> 标签：sql, tsql

我`VARCHAR`在`SQL Server 2000`数据库中有一个可以包含字母或数字的列。这取决于如何在前端为客户配置应用程序。

当它确实包含数字时，我希望它按数字排序，例如“1”、“2”、“10”而不是“1”、“10”、“2”。仅包含字母或字母和数字（例如“A1”）的字段可以按字母顺序正常排序。例如，这将是可接受的排序顺序。

```
1
2
10
A
B
B1 
```

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2008-09-23T08:29:07.530

一种可能的解决方案是用前面的字符填充数值，以使所有数值具有相同的字符串长度。

这是使用该方法的示例：

```
select MyColumn
from MyTable
order by 
    case IsNumeric(MyColumn) 
        when 1 then Replicate('0', 100 - Len(MyColumn)) + MyColumn
        else MyColumn
    end 
```

`100`应该替换为该列的实际长度。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-23T08:13:26.677

有几种可能的方法可以做到这一点。

一个是

```
SELECT
 ...
ORDER BY
  CASE 
    WHEN ISNUMERIC(value) = 1 THEN CONVERT(INT, value) 
    ELSE 9999999 -- or something huge
  END,
  value 
```

ORDER BY 的第一部分将所有内容转换为 int（对于非数字具有巨大的价值，最后排序），然后最后一部分处理字母。

请注意，在大量数据上，此查询的性能可能至少适度可怕。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-23T08:19:11.033

```
select
  Field1, Field2...
from
  Table1
order by
  isnumeric(Field1) desc,
  case when isnumeric(Field1) = 1 then cast(Field1 as int) else null end,
  Field1 
```

这将按照您在问题中给出的顺序返回值。

进行所有这些转换后性能不会太好，因此另一种方法是向存储数据的整数副本的表中添加另一列，然后先按该列排序，然后按相关列排序。这显然需要对在表中插入或更新数据的逻辑进行一些更改，以填充两列。要么，要么在表上放置一个触发器，以便在插入或更新数据时填充第二列。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-01-13T20:55:28.707

```
SELECT *, CONVERT(int, your_column) AS your_column_int
FROM your_table
ORDER BY your_column_int 
```

*或者*

```
SELECT *, CAST(your_column AS int) AS your_column_int
FROM your_table
ORDER BY your_column_int 
```

我认为两者都相当便携。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-04-03T07:35:17.060

您始终可以将 varchar-column 转换为 bigint，因为整数可能太短...

```
select cast([yourvarchar] as BIGINT) 
```

但你应该始终关心字母字符

```
where ISNUMERIC([yourvarchar] +'e0') = 1 
```

+'e0' 来自[http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/isnumeric-isint-isnumber](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/isnumeric-isint-isnumber)

这会导致你的陈述

```
SELECT
  *
FROM
  Table
ORDER BY
   ISNUMERIC([yourvarchar] +'e0') DESC
 , LEN([yourvarchar]) ASC 
```

第一个排序列会将数字放在顶部。第二个按长度排序，所以 10 将在 0001 之前（这很愚蠢？！）

这导致了第二个版本：

```
SELECT
      *
    FROM
      Table
    ORDER BY
       ISNUMERIC([yourvarchar] +'e0') DESC
     , RIGHT('00000000000000000000'+[yourvarchar], 20) ASC 
```

第二列现在用“0”填充，因此自然排序将带有前导零的整数（0,01,10,0100 ...）以正确的顺序（正确！） - 但所有alpha都将用“0”增强-chars（性能）

所以第三个版本：

```
 SELECT
          *
        FROM
          Table
        ORDER BY
           ISNUMERIC([yourvarchar] +'e0') DESC
         , CASE WHEN ISNUMERIC([yourvarchar] +'e0') = 1
                THEN RIGHT('00000000000000000000' + [yourvarchar], 20) ASC
                ELSE LTRIM(RTRIM([yourvarchar]))
           END ASC 
```

现在数字首先用'0'字符填充（当然，长度 20 可以增强） - 对数字进行正确排序 - alphas 只会被修剪

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-07-21T09:09:52.170

我以一种非常简单的方式解决了这个问题，在“顺序”部分写了这个

```
ORDER BY (
sr.codice +0
)
ASC 
```

这似乎工作得很好，事实上我有以下排序：

```
16079   Customer X 
016082  Customer Y
16413   Customer Z 
```

所以`0`前面的`16082`被认为是正确的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-23T08:23:48.120

这似乎有效：

```
select your_column  
from your_table  
order by   
case when isnumeric(your_column) = 1 then your_column else 999999999 end,  
your_column 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-22T10:08:08.203

此查询对您有帮助。在此查询中，数据类型为 varchar 的列按良好顺序排列。例如 - 此列中的数据为：- G1、G34、G10、G3。因此，运行此查询后，您会看到结果：- G1,G10,G3,G34。

```
SELECT *,
       (CASE WHEN ISNUMERIC(column_name) = 1 THEN 0 ELSE 1 END) IsNum
FROM table_name 
ORDER BY IsNum, LEN(column_name), column_name; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-05-28T08:19:28.630

这可能会对你有所帮助，当我遇到同样的问题时，我已经尝试过了。

`SELECT * FROM tab ORDER BY IIF(TRY_CAST(val AS INT) IS NULL, 1, 0),TRY_CAST(val AS INT);`

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-23T08:18:09.600

```
SELECT FIELD FROM TABLE
ORDER BY 
  isnumeric(FIELD) desc, 
  CASE ISNUMERIC(test) 
    WHEN 1 THEN CAST(CAST(test AS MONEY) AS INT)
    ELSE NULL 
  END,
  FIELD 
```

根据[此链接](http://www.experts-exchange.com/Microsoft/Development/MS-SQL-Server/Q_23258510.html)，您需要先转换为 MONEY，然后再转换为 INT，以避免将“$”作为数字进行排序。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-05-10T16:33:05.767

```
 SELECT *,
       ROW_NUMBER()OVER(ORDER BY CASE WHEN ISNUMERIC (ID)=1 THEN CONVERT(NUMERIC(20,2),SUBSTRING(Id, PATINDEX('%[0-9]%', Id), LEN(Id)))END DESC)Rn ---- numerical
        FROM
            (

        SELECT '1'Id UNION ALL
        SELECT '25.20' Id UNION ALL

    SELECT 'A115' Id UNION ALL
    SELECT '2541' Id UNION ALL
    SELECT '571.50' Id UNION ALL
    SELECT '67' Id UNION ALL
    SELECT 'B48' Id UNION ALL
    SELECT '500' Id UNION ALL
    SELECT '147.54' Id UNION ALL
    SELECT 'A-100' Id
    )A

    ORDER BY 
    CASE WHEN ISNUMERIC (ID)=0                                /* alphabetical sort */ 
         THEN CASE WHEN PATINDEX('%[0-9]%', Id)=0
                   THEN LEFT(Id,PATINDEX('%[0-9]%',Id))
                   ELSE LEFT(Id,PATINDEX('%[0-9]%',Id)-1)
              END
    END DESC 
```

# java - 如何初始化通过远程方法调用获取的 Hibernate 实体？

> ID：119732
> 
> 赞同：6
> 
> 时间：2008-09-23T08:02:31.290
> 
> 标签：java, hibernate, remoting, rmi

当调用远程服务（例如通过 RMI）从使用 Hibernate 的数据库中加载实体列表时，您如何管理它以初始化客户端需要的所有字段和引用？

示例：客户端调用远程方法来加载所有客户。对于每个客户，客户希望初始化对客户购买物品列表的引用。

我可以想象以下解决方案：

1.  为每个特殊查询编写一个远程方法，初始化所需的字段（例如 Hibernate.initialize()）并将域对象返回给客户端。

2.  像 1\. 但创建 DTO

3.  将查询拆分为多个查询，例如一个用于客户，另一个用于客户的文章，并让客户管理结果

4.  remote 方法采用 DetachedCriteria，由客户端创建并由服务器执行

5.  开发自定义“预加载模式”，即客户端明确指定要预加载哪些属性的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T08:07:11.873

我过去使用过 1 并且效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T08:28:54.147

我认为数字 5 是 HQL 中存在“获取”子句的原因。您可以使用它还是问题更复杂？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T09:03:30.613

我曾在一个客户那里，在#5 上对其项目进行了标准化，并且效果非常好。服务调用的最后一个参数是要加载的所有属性的逗号分隔列表，例如：

```
CustomerService.getCustomerById(id, "parent, address, address.city") 
```

我相信他们为此使用了 fetch 子句。我曾经使用 PropertyUtils 为 jpa 实现了相同的想法来触发延迟加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T08:34:08.797

这个远程服务......它是同一个应用程序的另一部分吗？如果是这样，那么共享类和来回发送实例就没有问题（RMI 也是如此，使用存根）。

然后可以选择访问 Web 服务或类似的东西，其中两个通信的应用程序不共享类，这使事情变得更加棘手。我将在不久的将来面临这个问题，我很想知道答案。

无论如何，我的投票是支持 DTO。我认为它们在适用的情况下提供了最好和最简单的解决方案，并有助于保持代码简单和可维护。

尤瓦尔=8-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T09:27:34.533

如果您的远程服务仅用于为您的客户端提供数据，那么关闭所有 Hibernate 实体的延迟加载可能会有所帮助。

然而，就我个人而言，我认为 DTO 是正确的方法。通过用 DTO 来表达您的远程接口，您可以确定您得到了您需要的一切，并且没有您没有预料到的。

# c - 手动选择 TCP 上的接口发送数据

> ID：119745
> 
> 赞同：0
> 
> 时间：2008-09-23T08:05:00.303
> 
> 标签：c, linux, networking, tcp

我有一个仅在特定接口上侦听的 TCP 服务器。我希望在`accept()`调用之后，如果传入连接来自`xxx.xxx.xxx.0`子网，那么数据应该通过 intf1 否则数据应该通过我的服务器正在侦听的 intf2 发送。

两个接口具有相同的路由设置和优先级。所有网络都可以从这两个接口访问。

一种出路可能是通过 intf1 添加一条具有更高优先级的新路由，但我希望这是基于代码的决定。

代码是在 Linux 上用纯 C 语言编写的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T11:29:36.783

虽然它不完全是您正在寻找的纯 C 选项，但也许您可以在收到 accept() 时使用[iptables规则。](http://www.netfilter.org/)

（尽管快速浏览 /lib/iptables 表明您可能很幸运）

我正在想象一个规则，它将所有 tcp 流量重定向到您指定的设备。你甚至可以让规则知道套接字状态，这样你就不需要在 accept() 之后指定接口。

* * *

所有这些都适用，直到我发现计划中的明显缺陷，拍拍我的头说“D'oh！”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T08:52:32.577

不幸的是，您的选择有限，因为 TCP/IP 堆栈是在内核中实现的，而您的接口是路由表。最好的办法是手动分配路线。

您还可以使用 netlink 库即时添加/删除路由，但 TCP 数据包的某些部分将通过“错误”接口，直到进行调用。当具有原始接口地址的数据包通过另一个接口发出时，您可能会遇到路由问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T11:46:36.103

[您可以使用rtnetlink](http://linux.die.net/man/7/rtnetlink)更改程序中的路由。您可以修改所需的所有参数。另请参阅[网络设备](http://linux.die.net/man/7/netdevice)。

# ironpython-studio - IronPython Studio 和 PictureBox 的问题

> ID：119749
> 
> 赞同：1
> 
> 时间：2008-09-23T08:05:33.873
> 
> 标签：ironpython-studio

是的，所以我在 Iron Python Studio 尝试一下，因为我对 VS2005 非常熟悉，并且想尝试使用集成 GUI 设计器的 Python。但是，一旦我添加了一个 PictureBox，我就有麻烦了。在运行项目时，我收到有关 BeginInit 的投诉，很快表单设计器就停止工作。
这是因为我运行的是 .NET 3.5 还是其他一些兼容性问题？[在Iron Python Studio 网站上](http://www.codeplex.com/IronPythonStudio)找不到任何东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T19:13:59.587

我有同样的问题。您可以做的是手动删除 BeginInit() 和 EndInit() 调用，然后它应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-26T19:14:43.947

你查看过 MSDN 上的[IronPython 博客吗？](http://blogs.msdn.com/ironpython/)您可能可以从那里向下钻取并找到明确的答案。如果您这样做，请务必在此处更新您的问题！

# computer-vision - Approximate Nearest Neighbor 是计算机视觉中最快的特征匹配吗？

> ID：119751
> 
> 赞同：2
> 
> 时间：2008-09-23T08:06:05.807
> 
> 标签：computer-vision, sift, nearest-neighbor, approximate-nn-searching

使用特征描述符 [如 SIFT、SURF] 时，Approximate Nearest Neighbor 是在图像之间进行匹配的最快方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-18T20:39:28.343

您应该查看[金字塔匹配内核](http://groups.csail.mit.edu/vision/vip/papers/grauman_jmlr07.pdf)，这是迄今为止与局部特征进行图像匹配的最成功的算法之一。它具有线性时间复杂度，而不是将图像 A 中的每个特征与图像 B 中的每个特征进行比较，即 O(n^2)。还有一个免费的[实现](http://people.csail.mit.edu/jjl/libpmk/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T12:19:13.170

我会说基于欧几里得距离的最近邻是最容易实现的，但不一定是最快的。

我同意近似最近邻或“最佳箱优先”将最快地识别背景集中的哪个图像与探测图像最相似。

如果您尝试识别图像中的单个对象，事情会变得更加困难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-04T16:51:55.743

您还可以查看[FLANN - 近似最近邻的快速库](http://people.cs.ubc.ca/~mariusm/index.php/FLANN/FLANN)

# asp.net - 是否有任何与 Tomcat 等效的 IIS？

> ID：119753
> 
> 赞同：5
> 
> 时间：2008-09-23T08:06:20.783
> 
> 标签：asp.net, iis, cassini

我想测试 ASP.NET 应用程序来感受 MVC 扩展，并将其与我现在使用 Grails 或 Rails 可以做的比较。问题是在公司环境中，我不能在我的工作站上安装 IIS，也不能在我的 DEV 服务器上。而且 - 你猜对了 - 那时不考虑 Visual Studio（我想对于我的调查，我会暂时坚持使用[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)和 .NET SDK）。

在 Java 方面，我可以在任何文件夹中解压缩一些 Tomcat 发行版并点击 go。
在 IIS 世界中是否有任何等价物，例如轻量级 ASP.NET 主机？

谢谢，
罗洛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T08:09:25.753

[UltiDev Cassini Web 服务器](http://en.wikipedia.org/wiki/UltiDev_Cassini_Web_Server)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T08:08:59.590

卡西尼在本地运行。我给个链接。。

编辑：这是[Cassini](http://www.asp.net/Downloads/archived/cassini/) Web 服务器的链接

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-11T21:14:12.097

UltiDev 最近开始发布 Cassini 替代产品 - [UltiDev Web Server Pro](http://ultidev.com/Forums/yaf_postsm2726_Welcome-to-UltiDev-Web-Server-Pro.aspx)的测试版本。它需要提升/管理员权限才能安装，但可以免费下载。它相当先进，它比 Cassini 更接近 IIS。见[截图](http://ultidev.com/Forums/yaf_postst659_UWS-Screenshots.aspx)。

# java - 我在使用 Java Mail 发送的电子邮件中失去了月经

> ID：119754
> 
> 赞同：7
> 
> 时间：2008-09-23T08:06:32.950
> 
> 标签：java, smtp, email

我从 Java 服务器发送时事通讯，其中一个超链接到达时缺少一个句点，使其无用：

```
Please print your <a href=3D"http://xxxxxxx.xxx.xx.edu=
au//newsletter2/3/InnovExpoInviteVIP.pdf"> VIP invitation</a> for future re=
ference and check the Innovation Expo website <a href=3D"http://xxxxxxx.xx=
xx.xx.edu.au/2008/"> xxxxxxx.xxxx.xx.edu.au</a> for updates. 
```

在上面的示例中，第一个超链接上的 edu 和 au 之间的句点丢失了。

我们已经确定邮件正文被换行并且换行在句点处拆分行，并且在 SMTP 电子邮件中以句点开头的行是非法的：

[https://www.rfc-editor.org/rfc/rfc2821#section-4.5.2](https://www.rfc-editor.org/rfc/rfc2821#section-4.5.2)

我的问题是 - 我应该使用什么设置来确保包装是周期友好的和/或首先不执行？

更新：经过*大量*测试和调试，结果证明我们的代码很好——客户端的 Linux 服务器附带了一个*非常*旧的 Java 版本，旧的 Mail 类仍然在一个 lib 文件夹中，并且优先被拾取我们的。JDK 1.2 之前有这个错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T08:10:21.147

从 SMTP 的角度来看，您可以用句点开始一行，但您必须发送两个句点。如果您使用的 SMTP 客户端不这样做，您可能会遇到您描述的问题。

可能值得尝试使用 IP 嗅探器来查看问题的真正所在。发送该电子邮件可能涉及至少两个单独的 SMTP 事务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-07-14T01:54:48.473

我在 HTML 电子邮件中遇到了类似的问题：神秘的缺失句点，在一种情况下，还有一条奇怪的截断消息。JavaMail 使用quoted-printable 编码发送HTML 电子邮件，该编码在任何点（即不仅在空白处）换行，这样任何行都不会超过76 个字符。（它在行尾使用“=”作为软回车，因此接收者可以重新组合行。）这很容易导致一行以句点开头，应该加倍。（这称为“点填充”）如果不是，则接收 SMTP 服务器会吃掉句点，或者更糟的是，如果句点是一行中的唯一字符，则 SMTP 服务器会将其解释为信息。

我追踪到了 GNU JavaMail 1.1.2 实现（又名 classpathx javamail）。此实现没有更新版本，并且已经有 4 或 5 年没有更新了。查看源代码，它部分实现了点填充——它试图单独处理一行中的句点，但是有一个错误甚至阻止了这种情况的工作。

不幸的是，这是我们平台（Centos 5）上的默认实现，所以我想它也是 RedHat 上的默认实现。

Centos 的修复是安装 Sun 的（或者我现在应该说 Oracle 的？）JavaMail 实现（我使用 1.4.4），并使用 Centos*替代*命令安装它以代替默认实现。（使用*替代方案*可确保安装 Centos 补丁不会导致恢复到 GNU 实现。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T19:30:01.467

我遇到了类似的问题，但使用的是 ASP.NET 2.0。根据应用程序日志，电子邮件中的链接是正确的“ [http://www.3rdmilclassrooms.com/](http://www.3rdmilclassrooms.com/) ”但是客户端收到的电子邮件链接缺少句点“ [http://www3rdmilclassrooms.com](http://www3rdmilclassrooms.com) ”

我已尽我所能证明电子邮件是通过正确的链接发送的。我怀疑是电子邮件客户端或垃圾邮件过滤软件正在修改超链接。垃圾邮件过滤软件有可能做到这一点吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T08:42:08.543

通过引用可打印确保您的所有内容都是 RFC2045 友好的。在这样的方法中使用 MimeUtility 类。

```
 private String mimeEncode (String input)
    {
    ByteArrayOutputStream bOut = new ByteArrayOutputStream();
    OutputStream out;
    try
    {
        out = MimeUtility.encode( bOut, "quoted-printable" );
        out.write( input.getBytes( ) );
        out.flush( );
        out.close( );
        bOut.close( );
    } catch (MessagingException e)
    {
        log.error( "Encoding error occured:",e );
        return input;
    } catch (IOException e)
    {
        log.error( "Encoding error occured:",e );
        return input;
    }

    return bOut.toString( );
    } 

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T20:07:13.340

正如 Greg 指出的那样，问题出在您的 SMTP 客户端，它不进行点填充（将前导点加倍）。

电子邮件似乎被编码为quoted-printable。切换到 base64（我假设您可以使用当前的 java mime 实现）将解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-08T19:43:44.450

我在以编程方式向雅虎帐户发送电子邮件时遇到了类似的问题。他们会得到一行很长的文本并在 HTML 电子邮件中添加自己的换行符，认为这不会导致问题，但当然会。

诀窍是不要尝试发送这么长的线路。因为 HTML 电子邮件不关心换行符，你应该每隔几个块添加你自己的，或者就在有问题的行之前，以确保你的 URL 在这样的时间段不会被拆分。

我不得不将我的 ASP VB 从

```
var html;
html = "Blah Blah Blah Blah ";
html = html & " More Text Here...."; 
```

至

```
var html;
html = "Blah Blah Blah Blah " & VbCrLf;
html = html & " More Text Here...."; 
```

这就是清理输出所需要的全部内容，因为它们最终正在处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T08:16:51.443

我不确定，但看起来您的电子邮件好像正在被编码。0x3D 是十六进制字符 61，即等于字符 ('=')。

您使用什么类/库来发送电子邮件？检查有关编码的设置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T08:25:25.480

您是否将 Mime 类型设置为“text/html”？你应该有这样的东西：

```
BodyPart bp = new MimeBodyPart();
bp.setContent(message,"text/html"); 
```

# sql - NHibernate 事务和竞争条件

> ID：119762
> 
> 赞同：1
> 
> 时间：2008-09-23T08:08:22.713
> 
> 标签：sql, sql-server, nhibernate

我有一个 ASP.NET 应用程序，它使用 NHibernate 在用户操作时以事务方式更新一些表。涉及到一个日期范围，其中只能对表格“预订”进行一个条目，以便指定排他日期。

我的问题是如何防止竞争条件，即两个用户操作几乎同时发生并导致多个条目进入“预订”>1 日期。我不能在调用 .Commit() 之前检查，因为我认为这仍然会导致竞争条件？

我所能看到的只是在提交后进行检查并手动回滚更改，但这让我的嘴巴感觉很糟糕！:)

> booking_ref (INT) PRIMARY_KEY AUTOINCREMENT
> 
> 预订开始（日期时间）
> 
> 预订结束（日期时间）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T10:38:15.863

*   使您的事务 SERIALIZABLE ( `session.BeginTransaction(IsolationLevel.Serializable`) 的隔离级别，并检查并插入同一个事务。通常不应该将隔离级别设置为可序列化，只是在这种情况下。

或者

*   在检查并最终插入之前锁定表。您可以通过 nhibernate 触发 SQL 查询来做到这一点：

    session.CreateSQLQuery("SELECT null as dummy FROM Booking WITH (tablockx, holdlock)").AddScalar("dummy", NHibernateUtil.Int32); 这将在该事务期间仅锁定该表以进行选择/插入。

希望它有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-20T08:10:30.490

上述解决方案可以作为一个选项使用。如果我在事务级别可序列化时使用“Parallel.For”发送了 100 个请求，是的，没有重复的请求 ID，但 25 个事务失败。我的客户不能接受。因此，我们通过仅存储请求 ID 并在其他表上添加唯一索引作为临时索引来解决问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-12T16:19:03.407

您的数据库应该管理您的数据完整性。

您可以使您的“日期”列独一无二。因此，如果 2 个线程尝试获取相同的日期。一个将引发唯一的密钥违规，另一个将成功。

# windows - IIS 编程管理的架构参考

> ID：119774
> 
> 赞同：1
> 
> 时间：2008-09-23T08:12:41.203
> 
> 标签：windows, iis, schema

在哪里可以找到 IIS 对象架构？我从 MSDN 中找到的只是类层次结构的图片。

需要明确的是，我想通过 WMI 或 ADSI 配置 IIS，并且我正在寻找类似[Active Directory schema](http://msdn.microsoft.com/en-us/library/ms675085(VS.85).aspx)的东西，仅适用于 IIS。我想要一个我可以配置的所有对象的列表，它们可以包含在哪些对象中以及它们的属性是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-25T06:04:58.140

虽然我无法为您指出一个明确的文档，但您可能会发现这个更好：WMI 代码创建者： http: [//www.microsoft.com/downloads/details.aspx? FamilyID=2cc30a64-ea15-4661-8da4-55bbc145c30e&DisplayLang =zh](http://www.microsoft.com/downloads/details.aspx?FamilyID=2cc30a64-ea15-4661-8da4-55bbc145c30e&DisplayLang=en)

我已经使用此工具查询 IIS WMI 对象，它甚至会在 C# 中为您编写查询或 WMI 方法调用的脚本（我以它们为例）。

如果您在安装了 IIS 的机器上运行它，您将看到 root\MicrosoftIISv2 命名空间，其中包含大量可查询的对象，以及它们的所有属性和方法。您可能正在寻找类似 IIsWebVirtualDirSetting 对象的东西 - 尝试从它开始，因为它具有您将在 IIS 配置面板上看到的大部分属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T12:34:04.430

你不能在这里找到一些信息吗：http: [//msdn.microsoft.com/en-us/library/aa737439.aspx](http://msdn.microsoft.com/en-us/library/aa737439.aspx)？

# bash - 如何使用shell脚本比较两个不同目录中同名的文件

> ID：119788
> 
> 赞同：19
> 
> 时间：2008-09-23T08:15:57.967
> 
> 标签：bash, shell, diff

在继续使用 SVN 之前，我曾经通过简单地保留一个`/develop/`目录并在那里编辑和测试文件，然后将它们移动到该`/main/`目录来管理我的项目。当我决定迁移到 SVN 时，我需要确保目录确实是同步的。

那么，编写 shell 脚本 [ bash ] 以递归比较两个不同目录中同名文件的好方法是什么？

注意：上面使用的目录名称仅用于示例。我不建议将您的代码存储在顶层:)。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-23T08:21:57.610

diff 命令有一个 -r 选项来递归比较目录：

```
diff -r /develop /main 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-23T08:46:22.700

```
diff -rqu /develop /main 
```

它只会以这种方式为您提供更改的摘要:)

如果您只想查看*新的/丢失*的文件

```
diff -rqu /develop /main | grep "^Only 
```

如果你想让它们裸露：

```
diff -rqu /develop /main | sed -rn "/^Only/s/^Only in (.+?): /\1/p" 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-23T08:26:17.490

我可用的差异允许递归差异：

```
diff -r main develop 
```

但是使用 shell 脚本：

```
( cd main ; find . -type f -exec diff {} ../develop/{} ';' ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T08:22:06.673

[我在某处读到回答你自己的问题是可以的，所以这里是:)]

我试过这个，效果很好

```
[/]$ cd /develop/
[/develop/]$ find | while read line; do diff -ruN "/main/$line" $line; done |less 
```

您可以选择仅比较特定文件 [例如，仅 .php 文件]，方法是将上述行编辑为

```
[/]$ cd /develop/
[/develop/]$ find -name "*.php" | while read line; do diff -ruN "/main/$line" $line; done |less 
```

还有其他想法吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-18T23:55:50.940

这是我的一个（有些混乱的）脚本示例，[dircompare.sh](http://sdaaubckp.svn.sourceforge.net/viewvc/sdaaubckp/single-scripts/dircompare.sh?content-type=text%2Fplain)，它将：

*   在两个递归过程中，根据它们出现在（或两者）中的目录对数组中的文件和目录进行排序
*   两个目录中出现的文件在两个数组中再次排序，取决于是否`diff -q`确定它们是否不同
*   对于那些`diff`声称相等的文件，显示并比较时间戳

希望它可以有用 - 干杯！

EDIT2：（*实际上，它适用于远程文件 - 问题是在本地和远程文件之间的差异操作期间未处理的 Ctrl-C 信号，这可能需要一段时间；脚本现在更新了一个陷阱来处理这个问题 - 但是，留下下面的先前编辑供参考*）：

编辑：...除了它似乎使我的服务器崩溃以获取远程 ssh 目录（我尝试使用 over `~/.gvfs`）...所以这不再是`bash`了，但我想另一种方法是使用`rsync`，这是一个示例：

```
$ # get example revision 4527 as testdir1
$ svn co https://openbabel.svn.sf.net/svnroot/openbabel/openbabel/trunk/data@4527 testdir1

$ # get earlier example revision 2729 as testdir2
$ svn co https://openbabel.svn.sf.net/svnroot/openbabel/openbabel/trunk/data@2729 testdir2

$ # use rsync to generate a list 
$ rsync -ivr --times --cvs-exclude --dry-run testdir1/ testdir2/
sending incremental file list
.d..t...... ./
>f.st...... CMakeLists.txt
>f.st...... MACCS.txt
>f..t...... SMARTS_InteLigand.txt
...
>f.st...... atomtyp.txt
>f+++++++++ babel_povray3.inc
>f.st...... bin2hex.pl
>f.st...... bondtyp.h
>f..t...... bondtyp.txt
... 
```

注意：

*   要获得上述内容，您不能忘记`/`目录名称末尾的斜杠`rsync`
*   `--dry-run`- 仅模拟，不更新/传输文件
*   `-r`- 递归到目录
*   `-v`- 详细（但**与**文件更改信息无关）
*   `--cvs-exclude`- 忽略`.svn`文件
*   `-i`- “--itemize-changes：输出所有更新的变更摘要”

以下是`man rsync`解释由`-i`（例如，`>f.st......`上面的字符串）显示的信息的简短摘录：

```
The  "%i"  escape  has a cryptic output that is 11 letters long.
The general format is like the string YXcstpoguax,  where  Y  is
replaced  by the type of update being done, X is replaced by the
file-type, and the other letters represent attributes  that  may
be output if they are being modified.

The update types that replace the Y are as follows:

o      A  < means that a file is being transferred to the remote
       host (sent).

o      A > means that a file is being transferred to  the  local
       host (received).

o      A  c  means that a local change/creation is occurring for
       the item (such as the creation  of  a  directory  or  the
       changing of a symlink, etc.).

...
The file-types that replace the X are: f for a file, a d  for  a
directory,  an  L for a symlink, a D for a device, and a S for a
special file (e.g. named sockets and fifos).

The other letters in the string above  are  the  actual  letters
that  will be output if the associated attribute for the item is
being updated or a "." for no change.  Three exceptions to  this
are:  (1)  a newly created item replaces each letter with a "+",
(2) an identical item replaces the dots with spaces, and (3)  an
.... 
```

确实有点神秘 - 但至少它显示了基本的目录比较`ssh`。干杯!

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T18:45:54.133

经典的（System V Unix）答案是`dircmp dir1 dir2`，它是一个 shell 脚本，它会列出在 dir1 但不是 dir2 或在 dir2 但不是 dir1 中找到的文件（输出的第一页，来自`pr`命令，所以用标题分页)，然后将每个常见文件与分析进行比较（相同、不同、目录是最常见的结果）。

这似乎正在消失的过程中 - 如果您需要，我可以独立重新实现它。这不是火箭科学（`cmp`是你的朋友）。

# svn - Subversion Berkeley DB 损坏，恢复失败

> ID：119792
> 
> 赞同：2
> 
> 时间：2008-09-23T08:16:51.007
> 
> 标签：svn, recovery, berkeley-db

我有一个由 berkeley DB 支持的 Subversion 存储库。有时它会因为一些锁而崩溃，并且没有被释放，但是今天早上使用'svnadmin recover'命令是不可能恢复它的。相反，它失败并出现以下错误：

```
svnadmin: Berkeley DB error for filesystem 'db' while opening 'nodes' table:
Invalid argument
svnadmin: bdb: file nodes (meta pgno = 0) has LSN [1083][429767].
svnadmin: bdb: end of log is [1083][354707]
svnadmin: bdb: db/nodes: unexpected file type or format 
```

我将从最后一次已知的良好备份中恢复存储库，但很高兴知道是否有办法修复此存储库。

编辑：即使是 db_recover 实用程序也没有什么不同。它显示恢复已完成，但在使用 svnadmin 验证存储库时仍然存在相同的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T08:19:09.940

> 我有一个由 berkeley DB 支持的 Subversion 存储库。

很抱歉听到这个消息。我建议您尽早转储该存储库 ( `svnadmin dump`) 并将其重新加载到由 FSFS ( `svnadmin load`) 支持的新存储库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T09:00:16.690

对于想要尝试db_recover功能的人来说，首先需要找到正确的 [berkeley DB版本](http://subversion.tigris.org/faq.html#divining-bdb-version)，然后使用正确版本的[berkeley DB软件](http://www.oracle.com/technology/software/products/berkeley-db/db/index.html)。然后运行恢复实用程序：

```
db_recover -c -v -h <path to subversion db dir> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T08:35:03.117

你试过[db_recover](http://www.google.com/search?q=man+db_recover)吗？后者往往能够比 svnadmin 纠正更多的问题

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-17T18:34:33.910

我知道这个问题已经很老了，但是还有另一种方法对我有用： `svnadmin recover <svn path>`

# python - 在 python 中使用 **kwargs 和 SimpleXMLRPCServer

> ID：119802
> 
> 赞同：15
> 
> 时间：2008-09-23T08:19:44.587
> 
> 标签：python, simplexmlrpcserver, xmlrpclib

我有一个类，我希望使用 pythons SimpleXMLRPCServer 将其公开为远程服务。服务器启动如下所示：

```
server = SimpleXMLRPCServer((serverSettings.LISTEN_IP,serverSettings.LISTEN_PORT))

service = Service()

server.register_instance(service)
server.serve_forever() 
```

然后我有一个如下所示的 ServiceRemote 类：

```
def __init__(self,ip,port):
    self.rpcClient = xmlrpclib.Server('http://%s:%d' %(ip,port))

def __getattr__(self, name):
    # forward all calls to the rpc client
    return getattr(self.rpcClient, name) 
```

因此，对 ServiceRemote 对象的所有调用都将转发到 xmlrpclib.Server，然后再将其转发到远程服务器。问题是服务中采用命名可变参数的方法：

```
@useDb
def select(self, db, fields, **kwargs):
    pass 
```

@useDb 装饰器包装函数，在调用之前创建数据库并打开它，然后在调用完成后关闭它，然后返回结果。

当我调用此方法时，我收到错误“ **call** () got an unexpected keyword argument 'name'”。那么，是否可以远程调用采用变量命名参数的方法？或者我是否必须为我需要的每个方法变体创建一个覆盖。

* * *

感谢您的回复。我稍微改变了我的代码，所以这个问题不再是问题。但是，如果我确实需要实现位置参数并支持远程调用，现在我知道这一点以供将来参考。我认为 Thomas 和 praptaks 方法的结合会很好。通过 xmlrpclient 将 kwargs 转换为客户端上的位置参数，并在服务器端的方法上有一个包装器来解包位置参数。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-23T10:47:37.040

你不能用普通的 xmlrpc 来做到这一点，因为它没有关键字参数的概念。但是，您可以将其作为协议叠加在 xmlrpc 之上，该协议始终将列表作为第一个参数传递，将字典作为第二个参数传递，然后提供适当的支持代码，以便对您的使用变得透明，示例如下：

## 服务器

```
from SimpleXMLRPCServer import SimpleXMLRPCServer

class Server(object):
    def __init__(self, hostport):
        self.server = SimpleXMLRPCServer(hostport)

    def register_function(self, function, name=None):
        def _function(args, kwargs):
            return function(*args, **kwargs)
        _function.__name__ = function.__name__
        self.server.register_function(_function, name)

    def serve_forever(self):
        self.server.serve_forever()

#example usage
server = Server(('localhost', 8000))
def test(arg1, arg2):
    print 'arg1: %s arg2: %s' % (arg1, arg2)
    return 0
server.register_function(test)
server.serve_forever() 
```

## 客户

```
import xmlrpclib

class ServerProxy(object):
    def __init__(self, url):
        self._xmlrpc_server_proxy = xmlrpclib.ServerProxy(url)
    def __getattr__(self, name):
        call_proxy = getattr(self._xmlrpc_server_proxy, name)
        def _call(*args, **kwargs):
            return call_proxy(args, kwargs)
        return _call

#example usage
server = ServerProxy('http://localhost:8000')
server.test(1, 2)
server.test(arg2=2, arg1=1)
server.test(1, arg2=2)
server.test(*[1,2])
server.test(**{'arg1':1, 'arg2':2}) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T09:01:47.983

XML-RPC 实际上没有“关键字参数”的概念，因此 xmlrpclib 不会尝试支持它们。您需要选择一个约定，然后修改 xmlrpclib._Method 以接受关键字参数并使用该约定传递它们。

例如，我曾经使用 XML-RPC 服务器将关键字参数作为两个参数传递，“-KEYWORD”后跟实际参数，在一个平面列表中。我不再能够访问我为从 Python 访问 XML-RPC 服务器而编写的代码，但它相当简单，大致如下：

```
import xmlrpclib

_orig_Method = xmlrpclib._Method

class KeywordArgMethod(_orig_Method):     
    def __call__(self, *args, **kwargs):
        if args and kwargs:
            raise TypeError, "Can't pass both positional and keyword args"
        args = list(args) 
        for key in kwargs:
            args.append('-%s' % key.upper())
            args.append(kwargs[key])
       return _orig_Method.__call__(self, *args)     

xmlrpclib._Method = KeywordArgMethod 
```

它使用猴子补丁，因为这是迄今为止最简单的方法，因为在 ServerProxy 类中对模块全局变量和名称损坏的属性（例如 __request）的一些笨拙使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T08:56:03.283

据我所知，底层协议不支持命名可变参数（或任何命名参数）。解决方法是创建一个包装器，该包装器将采用 **kwargs 并将其作为普通字典传递给您要调用的方法。像这样的东西

服务器端：

```
def select_wrapper(self, db, fields, kwargs):
    """accepts an ordinary dict which can pass through xmlrpc"""
    return select(self,db,fields, **kwargs) 
```

在客户端：

```
def select(self, db, fields, **kwargs):
    """you can call it with keyword arguments and they will be packed into a dict"""
    return self.rpcClient.select_wrapper(self,db,fields,kwargs) 
```

免责声明：代码显示了总体思路，您可以将其做得更简洁（例如编写一个装饰器来做到这一点）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T10:26:43.753

使用上述建议，我创建了一些工作代码。

服务器方法包装器：

```
def unwrap_kwargs(func):
    def wrapper(*args, **kwargs):
        print args
        if args and isinstance(args[-1], list) and len(args[-1]) == 2 and "kwargs" == args[-1][0]:
            func(*args[:-1], **args[-1][1])
        else:
            func(*args, **kwargs)
    return wrapper 
```

客户端设置（执行一次）：

```
_orig_Method = xmlrpclib._Method

class KeywordArgMethod(_orig_Method):     
    def __call__(self, *args, **kwargs):
        args = list(args) 
        if kwargs:
            args.append(("kwargs", kwargs))
        return _orig_Method.__call__(self, *args)

xmlrpclib._Method = KeywordArgMethod 
```

我对此进行了测试，它支持具有固定、位置和关键字参数的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T09:06:05.257

正如 Thomas Wouters 所说，XML-RPC 没有关键字参数。就协议而言，只有参数的顺序很重要，它们可以在 XML 中调用任何东西：arg0、arg1、arg2 非常好，对于相同的参数，奶酪、糖果和培根也是如此。

也许您应该简单地重新考虑您对协议的使用？使用诸如文档/文字 SOAP 之类的东西比使用其他答案中提供的解决方法要好得多。当然，这可能不可行。

# java - 将 .HBM 模型转换为带注释的 pojos

> ID：119815
> 
> 赞同：1
> 
> 时间：2008-09-23T08:23:29.323
> 
> 标签：java, hibernate, domain-driven-design, hbm, mda

我们在生锈的旧 hbm 文件中声明了我们的域模型，我们希望移动到使用 javax.persistence.* 注释注释的 POJO。

有没有人有这样做的经验？

有没有我们可以使用的工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T11:04:37.220

您可以使用 hibernate-tools.jar 中的 hbm2java ant 任务。这是一个称为 Hibernate Tool 的工具。hbm2java 将从 hbm 文件生成 JPA 注释的 POJOS。

见[http://www.hibernate.org/hib_docs/tools/reference/en/html/ant.html](http://www.hibernate.org/hib_docs/tools/reference/en/html/ant.html)

# windows - 防病毒和文件访问冲突：良好的编程习惯？

> ID：119816
> 
> 赞同：4
> 
> 时间：2008-09-23T08:23:44.127
> 
> 标签：windows, file-io, antivirus

有时，由于**防病毒软件**在我们的程序想要写入/重命名/复制文件的同时处理文件，我们会尝试“拒绝访问”错误。

这种情况很少发生，但让我很沮丧，因为我没有找到处理的好方法：从技术上讲，我们的反应是更改我们的源代码以实现某种**重试**机制......但我们并不满意...... 闻起来有点……我们不能告诉我们的客户“请关闭你的杀毒软件，让我们的软件正常工作”……

因此，如果您已经尝试过此类问题，请告诉我您是如何处理的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T08:33:01.997

说“关闭avs”的余地确实很小。这在很多办公室都行不通，所以我们完全按照您所说的做了：建立一个重试队列。

被锁定的文件被添加到队列中。当原始操作结束时，我们暂停 1 秒，然后依次弹出队列。第二次失败的文件被添加到第二个队列中，第一次完成后，我们等待 3 秒并弹出第二个。

报告第二个队列（第三次尝试）失败的文件。

# javascript - 动态客户端脚本

> ID：119818
> 
> 赞同：0
> 
> 时间：2008-09-23T08:23:49.523
> 
> 标签：javascript, scripting, server-side-scripting

我需要写一个java脚本。这应该验证是否在页面中选中了复选框。这里的问题是复选框在网格内并且是动态生成的。原因是在设计时不知道需要呈现的复选框的数量。所以 id 只在服务器端知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T08:27:23.167

您也必须生成您的 javascript，或者至少一个 javascript 数据结构（数组）必须包含您应该控制的复选框。

或者，您可以创建一个包含元素，并在每个复选框类型的子输入元素上使用 js 循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T08:45:26.943

这是一个想法：

正如 Anonymous 所指出的，您可以生成 javascript，如果您在 ASP.NET 中，您可以使用 RegisterClientScriptBlock() 方法获得一些帮助。[MSDN 关于注入客户端脚本](http://msdn.microsoft.com/en-us/library/aa478975.aspx)

您还可以编写或生成一个 javascript 函数，该函数将复选框作为参数，并将 onClick 属性添加到调用您的函数并将自身作为参数传递的复选框定义中

```
function TrackMyCheckbox(ck)
{
     //keep track of state
}

<input type="checkbox" onClick="TrackMyCheckbox(this);".... /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T08:27:16.567

如果这是您唯一的复选框，您可以调用 getElementsByTagName() 来获取所有输入，然后遍历返回的数组以查找适当的类型值（即复选框）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T12:38:02.953

问题没有太多细节。但假设 HTML 网格是在服务器端生成的（不是在 javascript 中）。

然后将类添加到您要确保选中的复选框。并在 DOM 中循环查找具有该类的所有复选框。在[jQuery](http://jquery.com)中：

HTML：

```
<html>
...

<div id="grid">
   <input type="checkbox"  id="checkbox1" class="must-be-checked" />
   <input type="checkbox"  id="checkbox2" class="not-validated" />
   <input type="checkbox"  id="checkbox3" class="must-be-checked" />
   ...      
   <input type="checkbox"  id="checkboxN" class="must-be-checked" />
</div>

...
</html> 
```

Javascript：

```
<script type="text/javascript">

  // This will show an alert if any checkboxes with the class 'must-be-checked'
  // are not checked.
  // Checkboxes with any other class (or no class) are ignored
  if ($('#grid .must-be-checked:not(:checked)').length > 0) {
    alert('some checkboxes not checked!');
  }

</script> 
```

# tinymce - 如何在 TinyMCE 中覆盖 Ctrl+V

> ID：119819
> 
> 赞同：2
> 
> 时间：2008-09-23T08:24:02.253
> 
> 标签：tinymce, overriding, keypress

我需要将粘贴文本的 HTML 清理到 TinyMCE 中，方法是将其传递给 Web 服务，然后将其返回到 textarea。所以我需要覆盖 TinyMCE 中的 Ctrl+V 来捕获文本，执行后台请求，然后在返回时继续使用 TinyMCE 的粘贴处理程序。首先，TinyMCE 的 Ctrl+V 处理程序在哪里，有没有一种非破坏性的方法来覆盖它？（而不是更改源代码）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T08:44:17.713

您可以编写一个插件来处理 ctrl+v 事件并将其传递或修改粘贴插件。以下代码位于[plugins/paste/editor_plugin.js 中](http://source.ibiblio.org/trac/lyceum/browser/vendor/wordpress/trunk/wp-includes/js/tinymce/plugins/paste/editor_plugin.js?rev=1241)，它处理 ctrl+v 事件。

```
 handleEvent : function(e) {
          // Force paste dialog if non IE browser
          if (!tinyMCE.isRealIE && tinyMCE.getParam("paste_auto_cleanup_on_paste", false) && e.ctrlKey && e.keyCode == 86 && e.type == "keydown") {
             window.setTimeout('tinyMCE.selectedInstance.execCommand("mcePasteText",true)', 1);
             return tinyMCE.cancelEvent(e);
          }

          return true;
       }, 
```

以下是[有关为 tinyMCE 创建插件的更多信息](http://wiki.moxiecode.com/index.php/TinyMCE:Creating_Plugin)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-08T19:32:43.177

Tiny Editor 有一个名为“粘贴”的插件。

使用的时候可以在init-section定义两个函数

```
/**
 * This option enables you to modify the pasted content BEFORE it gets
 * inserted into the editor.
 */
paste_preprocess : function(plugin, args)
{
     //Replace empty styles
    args.content = args.content.replace(/<style><\/style>/gi, "");
} 
```

和

```
/**
 * This option enables you to modify the pasted content before it gets inserted
 * into the editor ,but after it's been parsed into a DOM structure.
 *
 * @param plugin
 * @param args
 */
paste_postprocess : function(plugin, args) {
    var paste_content= args.node.innerHTML;
    console.log('Node:');
    console.log(args.node);

} 
```

# javascript - 没有浏览器的javascript中的GUI应用程序？

> ID：119826
> 
> 赞同：11
> 
> 时间：2008-09-23T08:26:08.940
> 
> 标签：javascript, user-interface

我想使用 javascript 来开发通用的 GUI 应用程序。最初这些是在 Windows 上运行的，但我希望它们最终是跨平台的。

有没有办法做到这一点而不必让应用程序在浏览器中运行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T08:31:48.647

查看[Adob​​e AIR](http://en.wikipedia.org/wiki/Adobe_AIR)。

来自维基百科：

*Adobe AIR 是一个跨平台运行时环境，用于使用 Adob​​e Flash、Adobe Flex、HTML 或 Ajax 构建富 Internet 应用程序，可以将其部署为桌面应用程序。*

另请查看[Mozilla Prism（测试版）](http://labs.mozilla.com/2007/10/prism/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-21T16:30:27.870

### JsLibs

今天我遇到了这个：[http](http://code.google.com/p/jslibs/)
://code.google.com/p/jslibs/ （来自[DZone](http://www.dzone.com/links/rss/jslibs_standalone_javascript_development_runtime.html)）JS Libs 似乎符合我的要求。我去看看，如果我觉得有趣，我会在这里发帖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T08:34:58.560

您可以尝试将[SUN 的 Lively Kernel](http://research.sun.com/projects/lively/)与[Mozilla 的 Prism](http://labs.mozilla.com/projects/prism/)结合起来。

*   Lively Kernel 是一个完全用 JavaScript 编写的 GUI 堆栈，使用 SVG 进行显示。

*   Prism 是一种在不显示它们运行的​​浏览器的情况下启动 Web 应用程序的方法。

虽然非常前沿，但使用风险自负。:-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-23T09:49:43.843

[XUL Runner](http://developer.mozilla.org/en/XULRunner)可能是一个答案，但恐怕我不能凭经验说话。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-01T17:40:41.320

JScript .NET 或许能够做到。它是为 ASP .NET 设计的，而 .NET 可能不是您想要的跨平台。然而，更多的兴趣可能会带来更多的发展。

JScript .NET：http: [//msdn.microsoft.com/en-us/library/ms974588.aspx](http://msdn.microsoft.com/en-us/library/ms974588.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-29T23:35:23.017

普罗瓦[钛](http://www.appcelerator.com/)。它是一个开发平台，允许您使用常见的 Web 语言（html、javascript、php 等）为移动和桌面构建应用程序。

它是开源的！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-10T01:48:30.013

您可以使用 Mozilla 的 rhino JavaScript 解释器。它允许 JavaScript 访问任何 Java 库，包括用于 GUI 的 Swing。 [http://www.mozilla.org/rhino/](http://www.mozilla.org/rhino/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-12-17T04:38:59.117

您可以使用 nodeGUI 。通过它您可以使用nodejs的所有模块。您可以使用 css 为您的应用程序设置样式，而无需任何 html 文件。看看：- [https://docs.nodegui.org/](https://docs.nodegui.org/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T11:35:24.570

试试 AIR，你甚至可以使用你选择的 JS 工具包 将它与 dojo 一起使用，看看这个：[http ://dojocampus.org/content/2008/04/02/dojo-on-air-a-fancy-file-uploader/](http://dojocampus.org/content/2008/04/02/dojo-on-air-a-fancy-file-uploader/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-10-25T00:06:07.813

好吧，如果您不希望您的软件是跨平台的，那么您在 Windows 上有两个选择：

*   HTML 应用程序 (HTA) `.hta`（[教程](http://eddiejackson.net/go/hta/)）
*   Windows Script/Scripting Host (WSH) 和类似 Windows Script File (WSF)`.wsf`格式的 XML，混合 JScript 和 VBScript 并使用`cscript.exe`/运行它们`wscript.exe`（[示例](http://wsh2.uw.hu/ch08c.html)）

笔记：

*   选项一实际上使用 Internet Explorer 并`mshta.exe`在后台使用，所以我认为它不能满足您的要求。
*   选项二，JScript 不具备所有 VBScript GUI 功能。因此，在上面提供的示例中，您必须实际定义 VBScript`SUB`才能获取 GUI 元素。
*   Microsoft 的 JScript 和 JavaScript 的主流方言并不完全兼容。

**PS**关于 WSH、WSF、VBScript、JScript 的精彩教程……[在这里](http://wsh2.uw.hu/ch01d.html)

# java - 如何在 Eclipse 中默认 JUnit 启动配置的工作目录？

> ID：119832
> 
> 赞同：23
> 
> 时间：2008-09-23T08:26:32.170
> 
> 标签：java, eclipse, junit, eclipse-3.4

我们的 Java 代码（不是测试代码）从当前目录读取文件，这意味着我们在运行代码时需要正确设置工作目录。

从 Eclipse 中启动 JUnit 测试时，会自动创建启动配置。问题是，该启动配置中的工作目录默认始终是根项目目录，这总是错误的，测试失败，我必须打开启动配置对话框，更改工作目录并重新启动测试。这很烦人。当我运行一个测试方法时也会发生同样的事情。

我已经考虑过这些：

*   从测试代码更改当前目录 - 设计不可能。
*   打开文件时，传递父目录参数 - 太难了，因为这会影响很多地方。
*   使用 Eclipse 的*复制启动配置*功能从已经设置了正确工作目录的现有启动配置中创建新的启动配置。这在这里没有任何意义，因为我想快速启动测试或测试方法，只需调用“将此测试/方法作为 JUnit 测试运行”即可。

总而言之，它看起来像是 Eclipse 的责任，而不是代码。

有没有办法为**所有未来新创建**的JUnit 启动配置设置**默认**工作目录？

 *** * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T08:48:17.920

这是一个主观的答案：

我相信您做错了测试，您不应该使用相对或完整路径从 JUnit 加载文件，而是将它们作为项目中的资源（将它们添加到构建路径）并将它们作为资源加载在 JUnit 测试中。这样，如果文件系统发生更改，有人使用不同的文件系统或 IDE，但仍然将它们放在构建路径中（作为源文件夹），您不会有问题。

我不确定这是否是您的意思，但如果您真的想更改它，请转到运行配置选项 -> 您的 JUnit -> 参数选项卡，在底部（Eclipse 3.4）您会看到工作目录，单击“其他”并从那里改变它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-13T16:07:41.227

据我所知，在 Eclipse 3.4 中无法更改未来 JUnit 启动配置的默认工作目录。此问题也已[报告为](https://bugs.eclipse.org/bugs/show_bug.cgi?id=67585)Eclipse 错误数据库中的错误。

但是，在 IDEA 中是可能的。有*Edit Defaults*按钮，用于分别为每种启动配置类型设置各种默认值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T13:57:29.687

使用 Eclipse 3，您可以设置工作目录。转到运行/调试配置 -> 参数选项卡。在工作目录中选择“其他”并输入测试的根目录

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T08:53:50.137

我还没有找到这样做的可能性，但你可以做的是使用：

getClass().getResourceAsStream(文件名);

getClass().getClassLoader().getResourceAsStream(文件名);

此方法在类路径上定位资源。第一个是相对于类的位置，第二个是相对于任何类路径“根条目”。例如，您可以将项目根目录添加到类路径中。

但是，如果您也想写入文件，这不起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T09:01:08.873

如果您的测试依赖于当前的工作目录，我认为您的测试有责任正确设置该工作目录，并将您的要测试的类配置为指向该目录。

如果您的大多数测试都有一个超类，请在其中写入一个常量。或者：如果您的大多数测试都有一个超类，请编写一个 @Before 设置方法。或者：如果您的大多数测试都没有超类，请在测试代码库的某个类中编写一个常量。

# java - 如何学习 Java Web 服务

> ID：119838
> 
> 赞同：12
> 
> 时间：2008-09-23T08:28:28.920
> 
> 标签：java, web-services

请推荐一些好的资源来开始编写 Java Web 服务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T08:29:57.747

如果您使用的是 Spring 框架，我建议您使用[Spring-WS](http://static.springframework.org/spring-ws/sites/1.5/)。

有一个非常有用的[参考指南](http://static.springframework.org/spring-ws/sites/1.5/reference/html/index.html)可以帮助您入门。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T09:13:59.887

在 Java 中编写 Web 服务的标准方法是使用 Apache Axis。

如果你是生成web服务客户端，那么你需要国外web服务的WSDL（.xsd，.wsdl等），然后你可以使用wsdl2java（或者最好是axis-ant提供的ANT任务）来简单的生成代码来进行通信和模型。

如果您在服务器端生成 Web 服务，那么您可以使用 Java2WSDL 将 Java 模型转换为 Web 服务实现，尽管您必须在它生成的 Impl 类中对服务器端进行编码。然后，您可以使用 axis.war 和生成的 deploy.wsdd 脚本轻松地在 Tomcat 等上进行部署。

有很多文档可以提供帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T08:32:48.877

这是 REST 和 JAX-RS 的一个很好的起点：

[http://www.lunatech-research.com/archives/2008/03/20/restful-web-sevices-resteasy-jax-rs](http://www.lunatech-research.com/archives/2008/03/20/restful-web-sevices-resteasy-jax-rs)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T09:12:22.417

[Sang Shin 的在线课程](http://www.javapassion.com)是一个很好的起点。有一个活跃的在线小组以及很好的幻灯片、示例和练习来完成。这门课程的好处在于，课程的每个部分都设置了时间表，以帮助您弄清楚在特定概念上花费了多少时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T09:13:55.923

根据我的经验， Apache Axis ( [http://ws.apache.org/axis](http://ws.apache.org/axis) ) 易于使用且对基本 Web 服务非常有效。

用户指南应该可以帮助您入门：[http ://ws.apache.org/axis/java/user-guide.html](http://ws.apache.org/axis/java/user-guide.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T01:23:22.677

我强烈建议您从新规范 Jax-WS 2.0 开始。遵循标准是个好主意。Sun 提供了一个您可以使用的参考实现。尝试[JAX-WS 网站](https://jax-ws.dev.java.net/) ，然后您可以观看[Metro 网站](https://metro.dev.java.net/)以查看所有标准 ws-* 堆栈。

我正在使用这个工具来消费和提供服务。它快速、易于使用、可定制和标准。

好好享受！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T16:18:40.840

[简而言之](http://oreilly.com/catalog/9781565924833/ "简而言之 Java 企业版")，查看Java Enterprise，它有一个很好的关于 Web 服务的部分，描述了 J2EE 框架规范和 Apache Axis 实现。请记住，虽然它可能很流行，但 Axis 不是标准方法，而是在标准最终确定/完善时开发的。

# oop - 哪种设计模式最适合迭代开发？

> ID：119855
> 
> 赞同：3
> 
> 时间：2008-09-23T08:32:49.783
> 
> 标签：oop, design-patterns

在 TDD 或迭代模式中构建应用程序时，是否有最喜欢的设计模式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T09:07:24.303

我认为这个问题可以重写，所以用这些话更有意义：

*“在使用测试驱动和增量开发策略时，哪些架​​构模式和策略有助于实现灵活性？”*

我的回答是：帮助你解耦你的类和组件的模式，比如：

*   [控制反转和依赖注入](http://martinfowler.com/articles/injection.html)- 帮助您保持类和组件之间的依赖关系与特定实现分离，这些实现在运行时（或启动时间）之前解决，允许使用存根用于尚未实现的功能和单元测试。

*   [Facades](http://en.wikipedia.org/wiki/Facade_pattern) - 帮助您隔离组件，为它们之间的交互提供定义良好的接口，从而减少耦合。

*   工厂和其他[创建模式](http://en.wikipedia.org/wiki/Creational_pattern)- 它们在负责实例化对象的代码部分中为您提供了灵活性。

还请记住，增量和迭代开发的口号之一是[“做最简单的可能可行的事情”](http://www.artima.com/intv/simplestP.html)。不要过度设计。

根据您的要求，这有意义吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T09:00:46.220

请**不要混合**不同的东西。您可以在适用时使用模式，这样可以节省您的时间和精力，并使您的代码看起来更标准。**它与您的开发方法无关！**

但是，您可能想在应用程序架构中强调一些事情：

*   让事情变得非常模块化。拥抱**松散耦合。**
*   在模块之间定义清晰的**概念边界。**概念上的意思是一开始就应该很清楚，感觉自然。一个随机的程序员询问它应该回答“哇，很明显你是怎么做到的！”。
*   **从小处着手**。不要试图生产 ZOMG，这将是最好的和最通用的类​​库和程序等等。让事情发挥作用，然后扩展，但仅限于必要时。
*   说服自己 YAGNI（你不需要它）。不要做你不确定必须做的事情。这并不意味着拖延或什么。它的意思是不要做任何事情，因为“我不知道，它将来可能有用”、“它在技术上很花哨”、“我会包括它以防万一”。
*   干燥 -**不要重复自己。**确保您不会遇到代码重复问题。想想代码生成器、良好的抽象以及整个团队的高效沟通。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T08:39:14.073

我不确定这是一个有意义的问题。但我不会让这阻止我...

当应用程序在您选择的敏捷过程下发展时，特定模式很可能会变得明显适合应用程序设计的各个方面，但是（希望不会误会）引用[Ron Jeffries](http://www.xprogramming.com/)的话，“代码会告诉你”。

编辑：但如果你想要一个明确的答案，那就是 Bridge。这是一个很好的。或者访客，我也喜欢那个。或者大多数以“F”开头的。:)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-23T08:39:42.637

设计模式是帮助解决特定类型问题的工具。模式的使用受需求范围定义的问题支配，而不是受开发方法学支配。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-09-23T08:37:11.863

使用像 Python 或 Ruby 这样的动态语言进行开发：您不必与其他语言的许多问题作斗争，这些问题首先是“设计模式”的原因。

动态语言与自动化测试相结合将非常快速地给出结果，因此您知道要采取的方向。如果您意识到出于性能原因或任何可以翻译您已经构建的动态软件的原因，您应该使用静态语言。

# java - 当 Toolkit.getDefaultToolkit() 抛出 AWTError 时，如何在 Java 中读取图像？

> ID：119857
> 
> 赞同：6
> 
> 时间：2008-09-23T08:33:24.960
> 
> 标签：java, image, awt

我正在使用 Java 读取图像文件

```
java.awt.Image img = Toolkit.getDefaultToolkit().createImage(filePath); 
```

在某些系统上这不起作用，它会引发 AWTError 抱怨 sun/awt/motif/MToolkit。

您还能如何从图像文件创建 java.awt.Image 对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T08:35:32.163

[我使用ImageIO](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html)读取图像。

```
Image i = ImageIO.read(InputStream in); 
```

javadoc 也将提供更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T08:45:15.823

ImageIO 中有几个静态方法允许从不同来源读取图像。在您的情况下，最有趣的是：

```
BufferedImage read(ImageInputStream stream) 
BufferedImage read(File input)
BufferedImage read(InputStream input) 
```

我检查了里面的代码。它使用 ImageReader 抽象类，并且有 3 个实现者：JPEGReader。PNGReader 和 GIFReader。这些类和 BufferedImage 显然不使用任何本机方法，因此它应该始终有效。

似乎您拥有的 AWTError 是因为您在无头配置中运行 java，或者 Windows 工具包存在某种问题。不看具体的错误很难说。此解决方案将允许您读取图像（可能），但根据您想要对其执行的操作，稍后可能会在您尝试显示它时抛出 AWTError。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T09:50:53.027

在某些系统上，添加“-Djava.awt.headless=true”作为 java 参数可能会有所帮助。

# visual-studio-2008 - 在标记和代码之间切换的快捷方式

> ID：119860
> 
> 赞同：3
> 
> 时间：2008-09-23T08:34:51.090
> 
> 标签：visual-studio-2008, keyboard-shortcuts

使用 Visual Studio 2008 Team Edition，是否可以分配在标记和代码之间切换的快捷键？如果没有，是否可以分配一个从代码到标记的快捷键？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T08:40:44.820

以下是来自 Lozza 在[https://blog.codinghorror.com/visual-studio-net-2003-and-2005-keyboard-shortcuts/](https://blog.codinghorror.com/visual-studio-net-2003-and-2005-keyboard-shortcuts/)上的评论的宏。您只需要将其绑定到您选择的快捷方式：

```
Sub SwitchToMarkup()
  Dim FileName

  If (DTE.ActiveWindow.Caption().EndsWith(".cs")) Then
    ' swith from .aspx.cs to .aspx
    FileName = DTE.ActiveWindow.Document.FullName.Replace(".cs", "")
    If System.IO.File.Exists(FileName) Then
      DTE.ItemOperations.OpenFile(FileName)
    End If
  ElseIf (DTE.ActiveWindow.Caption().EndsWith(".aspx")) Then
    ' swith from .aspx to .aspx.cs
    FileName = DTE.ActiveWindow.Document.FullName.Replace(".aspx", ".aspx.cs")
    If System.IO.File.Exists(FileName) Then
      DTE.ItemOperations.OpenFile(FileName)
    End If
  ElseIf (DTE.ActiveWindow.Caption().EndsWith(".ascx")) Then
    FileName = DTE.ActiveWindow.Document.FullName.Replace(".ascx", ".ascx.cs")
    If System.IO.File.Exists(FileName) Then
      DTE.ItemOperations.OpenFile(FileName)
    End If
  End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-12T10:24:13.830

不确定这是否是您的意思，因为我自己不进行 ASPX 开发，但 F7（显示代码）和 Shift-F7（显示设计器）默认键绑定不会在代码和设计之间切换吗？它们在我的 VS2008（在 WinForms 可设计项目上）中使用了我使用的大部分默认 C# 键绑定。

# c# - 如何改进程序编码

> ID：119867
> 
> 赞同：2
> 
> 时间：2008-09-23T08:37:06.887
> 
> 标签：c#

我是一名 C# 开发人员。仍然在学习。我还没有学习 C# 2.0 的所有特性，现在新版本的 c# 正在发布。我们如何应对这种情况。应对最新编程技能的最佳选择是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T08:41:57.530

正如史蒂夫 M 所说：阅读。但不要止步于此。你还得写。

第一：写代码。试试你读到的东西。看看开源软件以及其他人是如何做的。试试这些新技术。

第二：写文字。写一篇博客文章或任何关于如何做某事的文章。你有一个问题并且你解决了它，现在写下问题是什么，你有什么解决方案的想法以及你选择的解决方案是什么原因。让人们发表评论，以这种方式对你自己的想法进行同行评审。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T09:30:18.710

1.  阅读高质量的代码。查找其他项目（您组织内的开源或专有项目）并查看其他工程师如何处理特定问题。寻找你认为特别好的习语、设计模式、风格，并在你的编码实践中采用它们。

2.  专注于基础。知道如何在 C# 中最好地执行特定操作固然很好，但知道如何以及何时抽象、避免重复、遵循样式规则以及为标识符提供适当的名称是更重要的技能。这些也更有价值，因为您可以将它们应用于任何语言。

3.  改进你的代码。当你在代码中发现一些复杂或次优的东西时，试着想一个更好的方法来编写它。例如，如果您编写了大量样板代码，请检查如何使用抽象机制（如子例程、方法或类）来避免代码重复。如果一个表达式特别长，想一想将其中的一些放到一个单独的函数中是否可以增加它的可读性。

4.  使用工具。有一些工具，比如 FindBugs，可以定位次优或完全错误的代码结构。养成让代码干净地通过这些工具以及编译器的最高警告设置的习惯。

5.  审查您的代码。找一位导师，让他或她检查你的代码。准备好接受批评并从这次经历中学习。后来通过担任导师来回报社区。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T08:39:06.447

一个很好的学习方法是查看语言规范的变化，然后自己用小程序进行尝试。搜索一些示例，尝试它们，更改它们并查看结果。有一段时间当你做一些“真正的”工作时，你会记住那些东西并认为“这可能真的有帮助”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T08:53:58.983

没有魔术或秘密忍者方法。如果你想成为一名优秀的程序员，那就*工作*吧。*工作很多而且很努力*。

如果您不在实践中使用新知识，阅读书籍不会使您成为专业人士。如果您不了解 .NET XYZ 的所有漂亮功能，请不要担心 努力工作，尝试解决不同的问题，请老板给您不同的任务，您就会成功。这很难，但这是唯一的出路。在空闲时间工作+学习，您将变得专业。

但是不要着急，记住专业是有代价的——你不可能同时精通许多不同的工作领域。选择一些你喜欢的、可以给你钱的技术，然后跟着它走。当需要改变的时候，你*会感觉到。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T08:38:23.670

阅读，阅读，当你完成阅读，阅读更多。阅读也有帮助。

但说真的，请注册相关的邮件列表和 RSS 提要，以便您可以随时更新。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T08:49:09.620

1) 我尝试参与我的**本地**c# 用户组，这将是一个 Microsoft 技术用户组

[http://www.microsoft.com/communities/usergroups/default.mspx](http://www.microsoft.com/communities/usergroups/default.mspx)

他们通常是一群志同道合的人，他们想了解某些工具的新功能。

微软通常非常擅长帮助资助这些团体，并且经常举办讲座和研讨会。通常与创建您想要了解更多信息的工具的开发人员一起。

2) 获取一些**RSS Feeds/News letter**到 c# 站点，例如[C# Corner](http://www.c-sharpcorner.com/)或[Channel 9](http://channel9.msdn.com/) 它们通常是这些地方

3）哦，正如其他人所提到的，**阅读很多东西并尝试一下**。跟上新功能的步伐并不容易，但要阅读它们，在小型独立项目中尝试它们并从中获得乐趣。我不了解你，但我从获得一些新的和酷的工作中获得了极大的满足感。

正如务实的程序员所说，始终改进您的工具带。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T08:52:03.340

阅读好的代码。

选择一个你支持的开源项目。开始定期阅读它，通过实际阅读代码来了解它是如何工作的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-23T08:59:20.390

学习编码的唯一方法是编码……通过观察比你更好的人，你会成为*更好的编码员。*

不要太担心语言中的新功能，一定要注意它们，但要专注于核心语言

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-23T09:06:21.123

跟上技术的步伐很有用，但更有用的是学习将应用您使用的任何开发工具的永恒技能。

为此，我建议阅读 Code Complete，然后阅读其他一些经典的编程书籍。

另一件事就是继续编码。我的经验是，您会在需要时选择特定的技术。有时你会通过查看其他人的代码，有时通过阅读有趣的文章或书籍，有时通过学习课程来做到这一点。但是，无论您怎么做，您都会在需要时找到所需的工具。

# c++ - C++ 中的 MSMQ 示例？

> ID：119869
> 
> 赞同：3
> 
> 时间：2008-09-23T08:37:35.217
> 
> 标签：c++, windows, msmq, message-queue

有人可以给我一些工作示例，说明如何从 C++ API 创建、添加消息、读取和销毁私有消息队列吗？我尝试了 MSDN 的代码片段，但我无法让它们正常工作。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T11:53:19.130

实际上这是我感兴趣的代码：

```
#include "windows.h"
#include "mq.h"
#include "tchar.h"

HRESULT CreateMSMQQueue(
                        LPWSTR wszPathName, 
                        PSECURITY_DESCRIPTOR pSecurityDescriptor,
                        LPWSTR wszOutFormatName,
                        DWORD *pdwOutFormatNameLength
                        )
{

  // Define the maximum number of queue properties.
  const int NUMBEROFPROPERTIES = 2;

  // Define a queue property structure and the structures needed to initialize it.
  MQQUEUEPROPS   QueueProps;
  MQPROPVARIANT  aQueuePropVar[NUMBEROFPROPERTIES];
  QUEUEPROPID    aQueuePropId[NUMBEROFPROPERTIES];
  HRESULT        aQueueStatus[NUMBEROFPROPERTIES];
  HRESULT        hr = MQ_OK;

  // Validate the input parameters.
  if (wszPathName == NULL || wszOutFormatName == NULL || pdwOutFormatNameLength == NULL)
  {
    return MQ_ERROR_INVALID_PARAMETER;
  }

  DWORD cPropId = 0;
  aQueuePropId[cPropId] = PROPID_Q_PATHNAME;
  aQueuePropVar[cPropId].vt = VT_LPWSTR;
  aQueuePropVar[cPropId].pwszVal = wszPathName;
  cPropId++;

  WCHAR wszLabel[MQ_MAX_Q_LABEL_LEN] = L"Test Queue";
  aQueuePropId[cPropId] = PROPID_Q_LABEL;
  aQueuePropVar[cPropId].vt = VT_LPWSTR;
  aQueuePropVar[cPropId].pwszVal = wszLabel;
  cPropId++;

  QueueProps.cProp = cPropId;               // Number of properties
  QueueProps.aPropID = aQueuePropId;        // IDs of the queue properties
  QueueProps.aPropVar = aQueuePropVar;      // Values of the queue properties
  QueueProps.aStatus = aQueueStatus;        // Pointer to the return status

  WCHAR wszFormatNameBuffer[256];
  DWORD dwFormatNameBufferLength = sizeof(wszFormatNameBuffer)/sizeof(wszFormatNameBuffer[0]);
  hr = MQCreateQueue(pSecurityDescriptor,         // Security descriptor
                     &QueueProps,                 // Address of queue property structure
                     wszFormatNameBuffer,         // Pointer to format name buffer
                     &dwFormatNameBufferLength);  // Pointer to receive the queue's format name length

  if (hr == MQ_OK || hr == MQ_INFORMATION_PROPERTY)
  {
    if (*pdwOutFormatNameLength >= dwFormatNameBufferLength)
    {
      wcsncpy_s(wszOutFormatName, *pdwOutFormatNameLength - 1, wszFormatNameBuffer, _TRUNCATE);

      wszOutFormatName[*pdwOutFormatNameLength - 1] = L'\0';
      *pdwOutFormatNameLength = dwFormatNameBufferLength;
    }
    else
    {
      wprintf(L"The queue was created, but its format name cannot be returned.\n");
    }
  }
  return hr;
} 
```

这大概会创建一个队列......但是有一些部分缺少这个工作，这就是为什么我需要一个简单的例子。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-23T11:35:53.400

不太确定您将如何创建或销毁消息队列。Windows 应该为每个线程创建一个。

如果您使用 MFC，则任何 CWinThread 和 CWnd 派生类都有一个易于访问的消息队列（使用 PostMessage 或 PostThreadMessage 和 ON_COMMAND 宏）。要使用 Windows API 执行类似的操作，我认为您需要编写自己的消息泵，例如 CWinApp 的 run 方法。

```
MSG msg;
BOOL bRet; 
while( (bRet = GetMessage( &msg, NULL, 0, 0 )) != 0)
{ 
    if (bRet == -1)
    {
        // handle the error and possibly exit
    }
    else
    {
        TranslateMessage(&msg); 
        DispatchMessage(&msg); 
    }
} 
```

...是 MSDN 文档中的示例。这是你用的吗？什么不起作用？

# .net - .Net 框架中是否提供 pi 和 e 的值？

> ID：119885
> 
> 赞同：4
> 
> 时间：2008-09-23T08:41:08.937
> 
> 标签：.net, math, constants

不[计算它们](https://stackoverflow.com/questions/19/fastest-way-to-get-value-of-pi "StackOverflow - 获取 pi 值的最快方法")，我的意思是？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-23T08:42:19.277

```
System.Math.PI;
System.Math.E; 
```

# gcc - 从 g++/gcc 3.2.3 到 4.2.4 的性能改进

> ID：119887
> 
> 赞同：3
> 
> 时间：2008-09-23T08:41:28.373
> 
> 标签：gcc, g++

我们一直在研究 g++ 版本 3.2.3 和 4.2.4。在 4.2.4 中，我们的一些代码库的性能改进非常显着。

我已经尝试搜索[gcc buzilla 数据库](http://gcc.gnu.org/bugzilla/)以找到有关哪些错误可能有如此显着改进的提示，但我没有找到任何作为候选者脱颖而出的单个错误。

这些改进是许多慢慢产生影响的小变化的结果吗？或者有没有说可能产生影响的前 5 项改进？

对于某些背景，我们的代码库确实很好地利用了 STL 容器和算法，以及诸如“inline”关键字之类的 C++ 特性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T08:45:40.143

以我的经验，3.4 是性能基本达到顶峰的地方；在我的项目中，4.2 实际上比 3.4 慢，4.3 是第一个大致等于 3.4 性能的版本。4.4 比 3.4 稍快。

我发现了一些特定的情况，旧版本的 gcc 在代码中做了一些令人难以置信的延迟事情——有一个特定的函数从 3.4 到 4.3 从 128 到 21 个时钟，但这显然是一个特殊情况（它是一个短循环，仅添加一些不必要的指令会严重损害性能）。

我个人使用 3.4 只是因为它编译得更快，使测试更快。我也尽量避免使用最新版本，因为它们似乎有错误编译代码的讨厌习惯；--march core2 最近的 gcc 版本会导致我的程序出现段错误，例如，因为它会发出自动向量化代码，试图对未对齐的地址执行对齐的访问。

总体而言，尽管差异很少很大；就性能变化而言，3-5% 是我见过的绝对*最多的。*

现在，请注意这是 C；C++ 中的情况可能有所不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T08:57:20.287

我相信优化器在 gcc4 系列中被彻底改造了。例如，请参阅此页面关于矢量化：

[http://gcc.gnu.org/projects/tree-ssa/vectorization.html](http://gcc.gnu.org/projects/tree-ssa/vectorization.html)

对于信息，我曾经用动态数组、静态数组和 std::vector 做了一个 c[i] = a[i] + b[i] 的基准测试，它是最快的 std::vector (w/ gcc 4.1）。性能差异 30%。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T08:52:44.353

流在 3.3 中非常慢，在 3.4 中变得更快。（[gcc 邮件列表上的消息](http://gcc.gnu.org/ml/libstdc++/2004-06/msg00272.html)）我敢打赌其他事情也有所改善。

# sql - 重复结果

> ID：119896
> 
> 赞同：1
> 
> 时间：2008-09-23T08:43:49.040
> 
> 标签：sql, sql-server

我正在 SQL server2005 中编写查询。这将在结果中返回给我一个重复的行。我可以以特定列作为键来消除这种重复吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-23T08:44:59.613

您可以使用 DISTINCT 关键字消除完整的重复行。如果有一些键列是重复的，但其余列不重复，那么您将不得不使用聚合函数和 GROUP BY 子句向 SQL Server 解释您想要返回的数据。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T08:46:53.523

SELECT DISTINCT 将消除重复的行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T12:39:45.510

正如其他评论中所建议的那样，您**可以**使用`SELECT DISTINCT`消除重复项，并且它现在可能工作得很好，但您可能会乞求未来的麻烦。太频繁了，如果没有 ，您无法获得唯一的结果，那么`SELECT DISTINCT`您的数据库模型已经被过度规范化，并且您的查询可能会因检索然后消除大量重复而陷入困境。（当然，规范化现有数据库模式很少是微不足道的......）

如果没有有关架构和查询的更多信息，就无法判断是否`SELECT DISTINCT`是可接受的解决方法，或者是否有更好的连接语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T08:46:29.750

您的结果可能同时包含关联数组和数值数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T08:50:02.550

如果你只想要一列：

```
SELECT DISTINCT MyColumn FROM MyTable; 
```

如果您想要各种列，可能返回最大值或总和，请尝试对其进行分组：

```
SELECT MyFirstColumn, MySecondColumn, MAX(SomeDate) AS MaxDate, SUM(Amount) AS TotalAmount 
FROM MyTable 
GROUP BY MyFirstColumn, MySecondColumn; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-25T04:44:59.143

正如您在评论中指出的那样，您正在使用存储过程。处理这种情况的一种方法是创建一个使用存储过程填充的临时表。然后从临时表中选择结果并使用 SELECT DISTINCT 或 GROUP BY 删除重复项。

# java - j_security_check 和 JAAS

> ID：119926
> 
> 赞同：4
> 
> 时间：2008-09-23T08:51:47.413
> 
> 标签：java, security, j-security-check

我被赋予了实现登录处理程序的任务。处理程序捕获的唯一细节是用户名和密码。最初我打算使用发布到 servlet 的 JSP。servlet 执行数据库查找并验证用户凭据的位置。成功登录后，您会被重定向，但不成功会将您带回 jsp 并显示相应的错误消息。

然而，在做一些研究后，我发现了 j_security_check 和 JAAS，但我不确定要使用哪个或是否要使用。

我将从这两种方法中获得什么好处，哪种方法最适合我的任务？?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-20T11:32:45.367

安全性由以下几个方面组成：

1.  验证
2.  授权
3.  传输层安全 - 加密

身份验证： - 这包括检查用户的凭据；大多数情况下，这是通过登录机制实现的。您创建登录页面的任务是身份验证的一部分。

授权： - 需要保护应用程序资源免受未经授权的访问，这意味着当用户请求受保护的资源时，应用程序需要确保用户具有适当的访问权限。这通常通过为用户分配角色并放置验证用户访问权限的请求过滤器来完成。这部分比较关键，需要详细的设计分析。仅对用户进行身份验证是不够的，您需要确保那些未经授权的用户不会访问受保护的资源。

传输层安全： - 系统架构需要确保通过网络传输的数据不会落入黑客或嗅探者手中。SSL/TSL 用于实现这一点

J2EE 容器和 Spring 安全等框架为每个安全方面提供通用功能。

您正在尝试开发的是简单的身份验证机制。当涉及到访问控制（即授权）时，应用程序的安全性要求更高。

安全性也需要可扩展，即随着业务需要更改以集成系统和安全性，您的系统应该能够适应单点登录 (SSO)、LDAP 身份验证等内容。

尽管 JAAS 和容器安全性对于扩展来说已经足够好了，但是它们几乎没有限制。例如，您需要依赖供应商特定的配置和适配器。您的应用程序将在部署描述符中声明安全需求，并且服务器管理员需要在服务器端配置安全领域。

我建议您评估 Spring Security（以前称为 Acegi Security）框架。我们在许多项目中都使用了相同的方法，并发现它很健壮、可定制且易于实施。它带有一组过滤器，可以拦截您的请求并提供访问控制。框架可用于根据各种用户存储库（如数据库、LADP 服务器、操作系统安全等）验证用户。它是可扩展的，可以与 SSO 服务器集成。它还提供了有用的标记库来控制对 JSP 页面中部分的访问。不仅如此，该框架还提供了可以通过 Spring AOP 框架在类级别施加的方法级别的安全性

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T10:45:10.090

使用您的容器提供的内容，不要实现您的数据库查找来执行此操作。当容器知道谁登录时，您可以使用角色来限制对某些页面的访问。还有[不同类型的身份验证。](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/Security5.html)

使用 JAAS 将使您能够灵活地使用另一种验证密码的方式（例如在活动目录中）。也可以用这个实现单点登录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T09:48:07.433

你不妨看看[Spring Security](http://static.springframework.org/spring-security/site/index.html)框架。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T09:21:25.843

*除非您正在做非常* 敏感的事情*，*否则更简单的方法就足够了。请记住最重要（也是最简单）的一点：在数据库中保留密码哈希，而不是真正的密码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-20T11:09:04.177

JAAS 减轻了您的负担，并允许您（或客户端）仅通过放入另一个模块来更改身份验证方法。例如，从 DB auth 到 LDAP 到 Kerberos 到 NT Domain - 你明白了。

# apache-flex - Flex中加载的SWF文件的帧率不同？

> ID：119927
> 
> 赞同：0
> 
> 时间：2008-09-23T08:51:58.503
> 
> 标签：apache-flex

使用 Adob​​e Flex 的加载器类，我加载了一个外部 SWF 文件。但是，加载的 SWF 文件的帧速率与我的应用程序不同。

是否可以让父应用程序和加载的子应用程序以不同的帧速率播放？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T10:46:41.677

[这是不可能的。](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/LoaderInfo.html#frameRate)

> Flash Player 或 Adob​​e AIR 在任何时候只对所有加载的 SWF 文件使用单一帧速率，并且该帧速率由主 SWF 文件的标称帧速率决定

有两种方法可以解决这个问题，改变主 swf 的帧率以匹配加载的帧率（这可以在运行时完成）或将动画与实际帧分离并使用事件将其向前推进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T16:23:36.500

如果您决定使用事件来驱动您的 swf 以近似不同的帧速率，我建议您使用[TweenLite/TweenMax 之](http://blog.greensock.com/tweenmaxas3/)类的补间引擎。

它是免费的（就像在啤酒中一样），过去我已经非常成功地将它用于基于帧的补间。

# sas - Storing SAS data (including table structure) in a single flat file

> ID：119929
> 
> 赞同：2
> 
> 时间：2008-09-23T08:52:05.697
> 
> 标签：sas, flat-file, table-structure

I need to convert SAS data tables into flat files (or "ASCII files" as they were called once, as opposed to binary files). And only one flat file for each original SAS table. The challenging thing is that I want the flat file to contain some structural information of the original SAS table also, specifically:

*   Variable/Column name
*   Variable/Column label
*   Variable/Column type
*   Variable/Column length
*   Variable/Column format
*   Variable/Column informat

Additional information:

*   I will only need to convert small data (< 100 obs).
*   Performance is not an issue (within reasonable limits).
*   The flat file should form a basis for recreating the original SAS table, I don't need to be able to use the file directly as a table in DATA or PROC steps.

The standard SAS tables, transport files, XPORT files, etc are all binary format files, and the standard XML table format in SAS and CSV-files don't preserve table structure. So obviously these options don't help.

What is my best option?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-26T04:01:24.480

I'm not aware of any easy solutions.

Possibly:

1.  Use PROC EXPORT to produce CSV file with the data in it.
2.  Use PROC DATASETS with ODS to produce a dataset with the names, types, etc.
3.  Produce another CSV file for this dataset.

Now you've got your ASCII description of the table (spread over two CSV files). Reversing the process would be more tricky. Basically you'd have to read in the description data set, then use CALL SYMPUT in a loop to create a bunch of macro variables with the information in them, then use your macro variables to build a PROC IMPORT for the CSV file...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T13:52:12.680

1.  Create the code to export the table to text (this is straightforward, just google it or look at 'The Little SAS Book' if you have a copy).

2.  Then append the 'meta' info from sashelp.vcolumn, which is where sas stores information (meta data) about sas datasets. It's a sas table itself, so you could do a proc sql union operation to join it with the actual columns that this table describes (though you will need to do a transpose type operation because the meta data about the columns is in rows, not columns).

You're not being completely specific about how you want to see the meta data in the text file, so that's as far as I can go.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T23:53:03.690

proc sql's describe syntax might be handy to get the metadata portion, including lengths, types, formats, indexes etc...

Code:

```
proc sql;
describe table sashelp.class;
quit; 
```

Log:

```
NOTE: SQL table SASHELP.CLASS was created like:

create table SASHELP.CLASS( bufsize=4096 )
  (
   Name char(8),
   Sex char(1),
   Age num,
   Height num,
   Weight num
  ); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-19T14:52:07.563

With SAS 9.2, you can create an XML file from a data set and the XML contains variable/column metadata, like format, label, etc... See the section of the SAS 9.2 XML LIBNAME Engine: User's Guide titled "Using the XML Engine to Transport SAS Data Sets across Operating Environments". A link to it is here:

[http://support.sas.com/documentation/cdl/en/engxml/61740/HTML/default/a002594382.htm](http://support.sas.com/documentation/cdl/en/engxml/61740/HTML/default/a002594382.htm)

Here's a section of code from the manual that shows using the XML92 libname engine and PROC COPY to create the XML:

```
libname myfiles 'SAS-library';
libname trans xml92 'XML-document' xmltype=export;
proc copy in=myfiles out=trans;
   select class;
run; 
```

In SAS 9.1.3, you may have to create a custom tagset to get the same operation. SAS Technical Support (support@sas.com) may be able to offer some help.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-18T15:43:53.633

BTW - you haven't said why you need to do this. In this case, there is no good reason (there might be a compelling reason, such as somebody with power saying 'do it, or be fired', but there's no *good* reason).

I'd give up the idea of merging the metadata and data in each file, unless there's some incredibly strong reason to do so. Go with exporting the metadata for data set A into a file called metadata_A; this will result in paired files. Anybody looking to use those files in a a database program or statistical program would have a clearly-labeled metadata file to work with.

# python - 在函数内部动态创建变量

> ID：119941
> 
> 赞同：2
> 
> 时间：2008-09-23T08:55:24.877
> 
> 标签：python

我想从字典中创建函数内部的变量。

假设我有一本字典

```
bar = {'a': 1, 'b': 2, 'c': 3} 
```

和功能

```
def foo():
  pass 
```

我想要做的是在函数内部创建“foo”变量，其中每个字典项名称的名称和值作为字典项值

所以最后它应该类似于

```
def foo():
  a = 1
  b = 2
  c = 3 
```

有可能吗？如果确实如此，该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T10:23:19.470

根据您的评论，您真正想要的也许是一堆对象：

```
class Bunch(object):
    def __init__(self, **kwargs):
        self.__dict__.update(kwargs)

b=Bunch(**form.cleaned_data)

print b.first_name, b.last_name 
```

（** 语法是因为 Bunch 类型的对象通常像 Bunch(foo=12, bar='blah') 一样使用 - 在您的情况下未使用，但为了与正常使用保持一致，我将其保留）

这确实需要一个“b”。前缀来访问你的变量，但如果你考虑一下，这并不是一件坏事。考虑一下如果有人制作了一个 POST 请求来覆盖您*不*希望被覆盖的变量会发生什么 - 它很容易产生崩溃和 DOS 攻击，并且很容易引入更严重的安全漏洞。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T09:08:06.093

你的问题不清楚。

如果您想在 foo 未运行时“设置”所述变量，不，您不能。还没有框架对象可以“设置”局部变量。

如果你想在函数体中这样做，你不应该（查看[python 文档](http://docs.python.org/lib/built-in-funcs.html)中的 locals()）。

但是，您*可以*执行 a `foo.__dict__.update(bar)`，然后您甚至可以从函数内部访问这些变量，如 foo.a、foo.b 和 foo.c。问题是：你为什么要这样做，为什么没有一个类更适合你的目的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T09:02:55.593

你为什么想做这样的事情？除非您实际上对函数内部的变量执行任何操作，否则仅分配几个变量然后丢弃它们的函数与 def foo(): pass 是无法区分的（优化器在生成完全相同的字节码时是合理的）。

如果您还想动态附加使用这些值的代码，那么您可以使用 exec 来执行此操作（尽管除非这确实是用户输入代码，否则几乎可以肯定有更好的方法来执行您想要的操作）。例如：

```
some_code = '  return a+b+c'
exec "def foo():\n  " + '\n  '.join('%s = %s' for k,v in bar.items()) + '\n' + some_code 
```

（请注意，您的代码必须缩进到同一级别。）

另一方面，如果您想将这些值实际分配给函数**对象**（因此您可以执行 foo.a 并获得 1 - 请注意您的示例代码不执行此操作），您可以通过以下方式执行此操作：

```
for key, val in bar.items():
    setattr(foo, key, val) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T09:46:57.313

谢谢各位，我明白了。我不应该做这样的事情。但是，如果您的古玩我试图做的是在 django 中以某种方式缩短我的视图函数中的行数。我有许多字段的表单，而不是接收以下形式的每个字段：

```
first_name = form.cleaned_data['first_name']
last_name = form.cleaned_data['last_name'] .. 
```

我正在考虑获取我的表单类的每个属性名称并循环它。像这样：

```
for name in ProfileRegistration.base_fields.__dict__['keyOrder']:
   # and here the variables that i tried to assign 
```

# apache-flex - 在 Flex 中使用 Flash 组件 SWC 文件

> ID：119947
> 
> 赞同：-1
> 
> 时间：2008-09-23T08:57:35.840
> 
> 标签：apache-flex, flash, components

我正在通过 Flex 3 中的 SWC 文件访问自定义 UIComponent。该组件在 Flash CS3 中工作正常，但在 Flex 中使用它会在 draw() 中产生一个奇怪的错误。

我在 Sprite（带有 addchild）中添加了 swc 组件，并将其添加到 LIB 路径中。

TypeError：错误＃1010：术语未定义且没有属性。

```
at com.xxxx.highscores::HighScores/draw()

at fl.core::UIComponent/callLaterDispatcher() 
```

这是这个 UI 组件的 draw() 函数：

覆盖受保护的函数 draw():void { isInitializing = false;

```
 page.Text.x = width / 2;
     page.Text.y = height / 2;

     drawBackground(); 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T13:45:45.490

只有该代码，它必须是页面，或者 page.Text 为空。

~~按名称，我猜 page 是您使用 AS 创建的 Flash 库对象？如果是这样，我猜想之前的错误在它被创建并被播放器吞噬之前被触发（如果调试器尚未附加，或者加载共享库出现问题，可能会发生）。在添加到显示列表之前不会为新显示对象设置“阶段”是常见的。~~

编辑：这是组件中的一个错误：`draw()`始终使用`highScoresModuleText`page: 上的属性，该属性仅在页面为 a 时设置`HighScoresTextPage`，而不是任何其他页面，例如：`HighScoresTablePage`，将其`showHighsSores()`设置为。这在 Flash 中有效，大概是因为对象在舞台上，或者至少在调用之前被创建`showHighScores()`，所以`draw()`首先被调用，并且由于组件不会失效，因此不会在之后调用。

在这种情况下，正确的方法是`show*()`设置一些属性，然后稍后再解决，但快速解决方法`invalidate()`是在. 更快的解决方法是尽早创建组件（如启动），然后再调用。`draw()``if (page.highScoresModuleText)``draw()``addChild()``showHighScores()`

这对我有用：

```
package
{
    import flash.display.Sprite;
    import com.novelgames.flashgames.highscores.HighScores;
    import flash.events.MouseEvent;

    public class As3_scratch extends Sprite
    {
        private var highscore : HighScores;

        public function As3_scratch()
        {
            highscore = new HighScores();
            addChild(highscore);
            stage.addEventListener(MouseEvent.CLICK, onClick);
        }

        private function onClick(event : MouseEvent) : void
        {
            highscore.showEnterHighScore(50);
        }
    }
} 
```

# unit-testing - 何时使用测试脚本而不是单元测试？

> ID：119949
> 
> 赞同：14
> 
> 时间：2008-09-23T08:58:14.853
> 
> 标签：unit-testing, testing

我目前正在从事一个已经投入生产两年多的项目。该项目广泛使用单元测试和脚本化 UI 测试。最初的单元测试涵盖了系统框架、业务规则和状态转换（或工作流程）。测试脚本用于黑盒测试。然而，随着时间的推移，维护我们全套单元测试的成本变得越来越昂贵，尤其是那些与状态相关的测试。

经过一番调查，我们发现测试脚本比与工作流相关的单元测试更有效（即提供更好的覆盖率）并且维护成本更低。这并不是说单元测试的价值已被完全否定，但它确实提出了这个问题，是否可以放弃某些类别的单元测试以支持测试脚本。

我们的项目在迭代增量模型上运行。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T10:51:34.583

在不止一个方面，我经历过与单元测试相同的痛苦，尤其是在成员对单元测试一点都不热情的项目中，他们中的许多人只是忽略或注释掉测试能够欺骗源代码控制，节省时间等。一位前同事甚至为此创造了“截止日期驱动开发”一词。

在我看来，当面对这种挑战时，以下是一些针对单元测试的指导方针：

*   **丢弃过时**的测试——如果它们本质上是不准确或不相关的，那么尝试更新数百到数千行测试是没有意义的。立即放弃测试。不要“忽略”它们，不要将它们注释掉。完全删除它们。
*   **为新功能编写测试**——任何新功能仍然需要进行单元测试并以可单元测试的方式编写。
*   **为错误修复编写测试**- 在对应用程序进行回归测试时，可能需要确保错误修复具有确保错误已得到修复的单元测试。
*   **代码覆盖率该死**- 我敢肯定，这可能会赢得一些反对意见，但[在确保功能和使用测试作为延迟工作的借口之间有一条很好的界限](http://dotnet.kapenilattex.com/?p=58)。重点应该放在确保核心功能上，而不是遵循任意代码覆盖率。

话虽如此，我仍然认为不应该完全放弃单元测试。测试脚本和单元测试有自己的用途。但是应该在过度热心地尝试维护 TDD 和面对企业应用程序开发的现实之间取得平衡。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T09:06:09.593

SO对“单元测试的局限性”问题的答案之一是，当单元测试用于测试与集成而不是功能有关的任何事情时，它会变得令人费解。连接和使用外部服务（数据库、SSH'ing 到另一台服务器等）和用户界面是使用的两个示例。

并不是说您不能对这些事情使用单元测试，只是因为覆盖所有基础所涉及的困难使得使用这种测试方法不值得，除非在可靠性至关重要的情况下。

我对所有自定义 JavaScript UI 代码（模板引擎、效果和动画等）都使用“脚本测试”，如果做得好，我发现它既快速又可靠。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T09:15:49.897

您通常使用单元测试来执行此操作：测试单元。更准确地说，测试一个单元是否符合其接口规范/合同。如果单元测试失败，你就知道问题出在哪里：它在被测试的单元内。这使得调试更容易，特别是因为单元测试的结果可以自动处理。这里想到了自动回归测试。

如果您想要离开单元测试的范围，或者想要测试无法通过单元测试很好地测试的东西，那么您可以开始使用脚本化 UI 测试。例如，当您测试与许多无法模拟的外部 API 接口的代码时。现在您可以引发某些错误，但要追踪故障在代码中的确切位置要困难得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T10:32:28.107

实际上，有四个级别的测试，其中三个可能涉及脚本，第一个不涉及。

*   单元测试：在完全隔离系统其余部分的情况下测试一个类或方法
*   组装测试：测试系统内的场景，与系统外部的其他组件（即来自不同的功能域）完全隔离
*   集成测试：测试系统，包括来自外部部分的输入，以及到外部其他系统（即来自其他功能域）的输出。
*   验收测试：最终验证，如 Gishu 所说，以检查正确的代码（即正确的功能）是否存在。

功能域示例：服务层总线，即所有项目（通常封装一些核心参考数据库）能够在总线上公开其服务。
你可以这样做：

*   发布者类的单元测试
*   与您的 SLB 的其他组件协作，对您的发布者机制进行组装测试
*   为您的 SLB 服务和在 SLB 之外开发的其他组件和您的服务的客户端进行集成测试
*   整个系统的验收测试。

如前所述，最后 3 种测试可能涉及繁重的脚本，并且可以快速覆盖更多代码。根据要进行单元测试的类/方法的绝对数量，一个好的组装测试可能是一种更好的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T09:14:03.507

两种不同的东西

*   单元测试 - 开发人员 - 验证代码是否正确
*   验收测试 - 客户/QA/BA - 验证是否开发了正确的代码。

这两个类别应该是不同的，并且都扮演着同样重要的角色。放弃一个并不是好兆头。您提到的测试脚本属于第二类。为此，我会推荐[FIT](http://fit.c2.com/) / [Fitnesse 之](http://fitnesse.org/)类的东西。如果那不可行，那么测试脚本/记录重播风格的工具。但是不要扔掉好的单元测试..“维护测试的成本变得昂贵”是什么意思？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-06T12:59:22.847

我的假设是你的单元测试的维护工作会增加，因为你的应用程序的架构被允许分崩离析。由于除了您之外没有人真正知道您的代码中有什么，您可能需要应用五个为什么方法来确定您真正的、基本的、根本问题是什么。只要您采用高度解耦、基于接口的架构，IME 单元测试的维护成本就不会很高。

# visual-studio - 如何将VS2008的字体和颜色导出到VS2005？

> ID：119960
> 
> 赞同：1
> 
> 时间：2008-09-23T09:00:48.187
> 
> 标签：visual-studio

我被迫在 Visual Studio 2005 中工作，并想从 Visual Studio 2008 中导出我的字体和颜色。但是，VS2005 抱怨导出文档版本错误。除了手动更改每种颜色和字体之外，还有什么好的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T09:09:42.410

我认为导出文件中有一个名为“applicationIdentity”的标签，到 2008 年将其设置为“9.0”，将其更改为“8.0”，文件应该导入。我不记得它会导致特定于 2k8 的设置出现任何问题，但请先备份您的设置！

更新：刚刚查看了一个导出文件，在 2k5 文件中确实有一个“<ApplicationIdentity version="8.0"/>”，所以在 2k8 文件中它应该是“9.0”（我的 PC 上没有 VS2k8毫无疑问地验证这一点）。

# html - 通过css设置标签的大小属性？

> ID：119961
> 
> 赞同：18
> 
> 时间：2008-09-23T09:01:06.767
> 
> 标签：html, css, html-select

通常你可以这样做：

```
<select size="3">
    <option>blah</option>
    <option>blah</option>
    <option>blah</option>
</select> 
```

它会呈现为一个选择框，其中所有三个选项都是可见的（不下拉）
我正在寻找一种从 css 设置这个大小属性的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-23T17:09:38.870

没有设置大小的选项，但如果您确实设置了大小，某些浏览器将允许您通过 CSS 将宽度/高度属性设置为您想要的任何值。

一些 = Firefox、Chrome、Safari、Opera。

虽然在 IE 中没有多少工作（不足为奇）

但是，如果您愿意，可以在 IE 中使用 CSS 表达式来检查是否设置了 size 属性，如果是，则运行 JS 将其（重新）设置为您想要的大小...例如

```
size = options.length; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T09:09:39.680

我不认为这是可能的。

CSS 属性非常通用（适用于任何元素）并且无法以任何方式改变元素的功能（仅外观）。

至少在 size = 1 / size != 1 的情况下，size 属性正在改变元素的功能。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-09T18:20:21.907

我不同意，我已经能够使用 CSS 设置选择宽度和高度，如下所示：

```
select { width: 5em; height: 5em; } 
```

在 IE(7) 中工作，我刚刚测试过它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-12T02:34:10.727

试试这个：

```
select[attr=size] {
    width:auto;
    height:auto;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-06T12:04:07.280

您可以使用以下 CSS 选择器为具有 size 属性的选择项设置样式：

```
select[size]{
/*your style here */
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T09:38:00.920

一般来说，您不能通过 CSS 添加在 html 中设置的属性。您可以使用伪选择器 :before 和 :after 添加到 html 中，但仅此而已，而且它们仍然不能在所有浏览器中兼容。如果你真的需要这样做，我认为你必须求助于 Javascript。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-09-23T09:06:31.857

我不相信这是可能的 不

# javascript - JavaScript 图表库

> ID：119969
> 
> 赞同：223
> 
> 时间：2008-09-23T09:04:18.880
> 
> 标签：javascript, charts

有人会推荐一个特定的 JavaScript 图表库——特别是一个根本不使用 Flash 的库吗？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2010-01-25T23:21:08.923

对于不需要 Flash 的纯 JavaScript 图表，有越来越多的开源和商业解决方案。在此回复中，我将仅介绍开源选项。

不需要 Flash 的图形的 JavaScript 解决方案主要有 2 类：

*   基于 Canvas，在 IE 中使用 ExplorerCanvas 渲染，而 ExplorerCanvas 又依赖于 VML
*   基于标准的浏览器上的 SVG，在 IE 中呈现为 VML

这两种方法各有利弊，但对于图表库，我推荐后者，因为它与 DOM 很好地集成，允许使用 DOM 操作图表元素，最重要的是设置 DOM 事件。相比之下，Canvas 图表库必须重新发明 DOM 轮来管理事件。因此，除非您打算构建没有事件处理的静态图，否则 SVG/VML 解决方案应该会更好。

对于 SVG/VML 解决方案，有许多选项，包括：

*   [Dojox Charting](http://docs.dojocampus.org/dojox/charting)，如果您已经使用[Dojo 工具包就好了](http://dojotoolkit.org/)
*   基于[Raphael的解决方案](http://raphaeljs.com/)

[Raphael](http://raphaeljs.com/)是一个非常活跃、维护良好且成熟的开源图形库，具有非常好的跨浏览器支持，包括 IE 6 到 8、Firefox、Opera、Safari、Chrome 和 Konqueror。Raphael 不依赖于任何 JavaScript 框架，因此可以与 Prototype、jQuery、Dojo、Mootools 等一起使用...

有许多基于 Raphael 的图表库，包括（但不限于）：

*   [gRaphael](http://g.raphaeljs.com/) , Raphael 图形库的扩展
*   [Ico](http://github.com/uiteoi/ico)，具有基于单个函数调用的直观 API 来创建复杂图表

披露：我是[github 上的一个 Ico 分叉](http://github.com/uiteoi/ico)的开发者。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2008-09-23T09:07:13.337

如果您使用 jQuery，我发现[flot](http://code.google.com/p/flot/)非常好 - 尝试这些[示例](http://people.iola.dk/olau/flot/examples/)以查看它们是否满足您的需求，但我发现它们可以完成我当前项目所需的大部分工作。

此外， [ExtJS 4.0](http://www.sencha.com/products/extjs/examples/#sample-3)引入了一组很棒的图表 - 非常强大，旨在处理实时数据。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2009-12-01T14:34:50.923

查看[http://www.highcharts.com](http://www.highcharts.com)！

Highcharts 是一个用纯 JavaScript 编写的图表库，提供了一种将交互式图表添加到您的网站或 Web 应用程序的简单方法。Highcharts 目前支持折线图、样条图、面积图、面积图、柱形图、条形图、饼图和散点图类型。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2008-09-23T09:08:49.417

它可能并不完全符合您的要求，但
[Google 的 Chart API](http://code.google.com/apis/chart/)非常酷且易于使用。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2011-02-16T19:00:40.267

还有另一个基于 SVG 的 javascript 库。它被称为[Protovis](http://vis.stanford.edu/protovis/)，来自斯坦福可视化小组

它还允许制作漂亮的交互式图形和可视化。

[http://vis.stanford.edu/protovis/ex/](http://vis.stanford.edu/protovis/ex/)

虽然它只适用于现代网络浏览器

**更新：** protovis 团队已经转移到另一个名为 d3.js（数据驱动文档）的库，正如他们所说：

*“Protovis 团队现在正在开发一个新的可视化库 D3.js，改进了对动画和交互的支持。D3 建立在 Protovis 中的许多概念之上”*

现在可以在以下位置找到新库：

[http://mbostock.github.com/d3/](http://mbostock.github.com/d3/)

**更新 2：**

“Rickshaw”是一个用于创建交互式时间序列图的 JavaScript 工具包。基于 d3.js，它大大简化了 d3.js 的工作，虽然功能稍逊一筹。

[http://code.shutterstock.com/rickshaw/](http://code.shutterstock.com/rickshaw/)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2011-04-19T12:54:56.027

我最近在寻找一个 javascript 图表库，并在最终确定非常符合我要求的[jqplot之前评估了一大堆。](http://www.jqplot.com/)正如让文森特的回答所提到的，您实际上是在基于画布和基于 svg 的解决方案之间进行选择。

在我看来，主要的利弊如下。如果您想构建高度动态/交互式图表，那么基于 SVG 的解决方案（如[Raphael （和分支））非常有用。](http://raphaeljs.com/)或者，如果您的图表要求非常超出规范（例如，您想要创建某种混合图表，或者您想出了一个其他人还没有想到的新可视化）。缺点是学习曲线和您必须编写的代码量。你不会在几分钟内敲出图表，准备投入一些真正的学习时间，然后编写大量代码来生成一个相对简单的图表。

如果您的图表要求是相当标准的，例如您想要一些折线图或条形图，或者可能是一两个饼图，但交互性有限，那么值得研究基于画布的解决方案。几乎没有任何学习曲线，您将能够在几分钟内获得基本图表，您无需编写大量代码，只需几行基本的 javascript/jquery 即可。当然，您将只能生成该库支持的特定类型的图表，通常仅限于各种风格的折线、条形、饼形。交互性选择将非常有限，也就是说，对于那里的许多库来说不存在，尽管一些有限的悬停效果可能与更好的库一起使用。

我选择了基于画布的解决方案 JQplot，因为我只需要一些标准类型的图表。根据我的研究和各种选择，我发现它功能齐全（如果您只使用标准图表）并且非常易于使用，因此如果您的要求相似，我会推荐它。

总结一下，现在简单又想要图表，那就用JQplot吧。复杂/不同，时间紧迫，然后与拉斐尔和朋友一起去。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-06-03T12:23:16.637

[jqPlot](http://www.jqplot.com/)很棒。如果您的要求相当“正常”并且您只想绘制一些图表，那么您可能会被 js 图表选项的数量所淹没。假设您不想进行数小时的研究，只需使用 jqPlot，因为它可能是您最好的选择。它很好地涵盖了大多数人的大多数用例。一些替代方案专门针对某种类型的图表或在考虑特定用例的情况下构建。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-03-16T06:26:34.923

作为某种迟到的答案，请尝试 d3.js
[http://mbostock.github.com/d3/](http://mbostock.github.com/d3/)

它是 protovis 的延续。
浮动的最大区别在于支持的功能数量。
虽然 flot 可能更简单，但 d3.js 肯定更强大。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-23T10:27:23.127

[Flotr](http://solutoire.com/flotr/)是另一个基于 Prototype 并受[Flot启发的纯 Javascript 图表库](http://code.google.com/p/flot/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-10-30T01:38:33.900

我推荐[gRaphaël](http://g.raphaeljs.com/)用于纯 JavaScript 图表以及它所构建的纯 JavaScript 矢量图形库 ( [Raphaël](http://raphaeljs.com/) )。

gRaphaël 目前支持 Firefox 3.0+、Safari 3.0+、Opera 9.5+ 和 Internet Explorer 6.0+。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-23T15:19:18.963

尝试[**PlotKit**](http://www.liquidx.net/plotkit/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-10-20T19:47:43.793

*   一个框架：[http ://www.simile-widgets.org/](http://www.simile-widgets.org/)

一个基本的： [http ://www.filamentgroup.com/examples/charting_v2/index_2.php](http://www.filamentgroup.com/examples/charting_v2/index_2.php)

好看： [http ://www.highcharts.com/](http://www.highcharts.com/)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-07-17T13:39:03.797

另一个是 RGraph：Javascript 图表和图形库：

[http://www.rgraph.net](http://www.rgraph.net)

基于画布，因此速度很快，并且大约有 20 种不同的图表类型。非商业用途也是免费的！

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-23T10:10:46.380

我最喜欢的（flot）已经提到过。

但一定要调查[Ortho](http://www.craic.com/ortho/ortho_home.html)。它非常适合树形图和时间表。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-01-02T18:20:43.690

We just bought a license of [TechOctave Charts Suite](http://techoctave.com/charts) for our new startup. I highly recommend them. Licensing is simple. Charts look great! It was easy to get started and has a powerful API for when we need it. I was shocked by how clean and extensible the code is. Really happy with our choice.

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-27T22:44:56.540

查看[Google Visualization API ，它是更简单的](http://code.google.com/apis/visualization/)[Chart API](http://code.google.com/apis/chart/)的一种概括

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-23T09:11:55.993

尝试可以制作成图表的 MIT 明喻时间线 - [http://simile.mit.edu/timeline/](http://simile.mit.edu/timeline/)

或最后一个，[http://code.google.com/p/gchart/](http://code.google.com/p/gchart/)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-23T11:34:12.030

dojo 图表库中有很多活动，很棒的是我在 AIR 应用程序中使用它也没有问题，非常酷！参见例如[http://www.sitepen.com/blog/2008/05/27/dojo-charting-event-support-has-landed/](http://www.sitepen.com/blog/2008/05/27/dojo-charting-event-support-has-landed/)

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2011-04-20T21:54:33.653

[http://code.google.com/apis/visualization/documentation/gallery.html](http://code.google.com/apis/visualization/documentation/gallery.html)

具有非常酷的交互选项，包括地图、仪表和图表。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-23T10:13:47.700

看看[布拉夫](http://bluff.jcoglan.com/)。它是用于 Ruby 的 Gruff 图形库的 JavaScript 端口。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-23T09:09:40.273

不是 Javascript 库，但它可能是一个合适的替代方案 - 查看[Google Charts](http://code.google.com/apis/chart/)，您可以在其中通过将查询字符串数据传递给他们的 Web 服务来生成图表。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-10-20T05:45:10.280

原型图就是你所需要的

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2011-04-13T11:05:35.740

对于更不寻常的图表：[http ://thejit.org/](http://thejit.org/)

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2011-02-28T13:35:40.043

Sencha 收购了 Raphael，现在他们的图表从版本 4 开始是纯 javascript。上面提到的 Emprise 和 HighCharts 是我最喜欢的两个。

[http://www.sencha.com/](http://www.sencha.com/)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2011-11-11T09:40:59.553

如果您只需要条形图。我发布了一些我在旧项目中使用的代码。有人告诉我，最近版本的 IE 上的 VML 实现被破坏了，但 SVG 应该可以正常工作。可能会回到项目并发布一些我已经拥有的服务器端渲染器，也许还有 WebGL 渲染层。有一个链接：[http ://blog.conquex.com/?p=64](http://blog.conquex.com/?p=64)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2011-08-25T09:44:36.930

我可以推荐[ArcadiaCharts](http://www.arcadiacharts.com)。适用于 JavaScript 和 GWT 的全新专业图表库。无需插件即可在所有浏览器中运行。使用简单快速：只需几行代码即可创建美观的图表。免费用于非商业用途。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2012-01-24T16:49:11.083

可能不是 OP 正在寻找的，但由于这个问题已成为 JS 图表库选项列表：[jQuery Sparklines](http://omnipotent.net/jquery.sparkline/)真的很酷。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2011-04-18T16:21:51.837

查看[ZingChart HTML5 Canvas、SVG、VML 和 Flash 图表](http://zingchart.com)。非常强大且兼容的库。我是 Zing 团队的一员 - 在推[特 @zingchart](http://twitter.com/zingchart)上提及我们或向 support@zingchart.com 提出任何问题。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2011-10-27T16:01:53.677

[Fusion chart](http://www.fusioncharts.com/demos/)有一个新的 javascript/jquery 库，看起来很有前途。

# selenium - Selenium RC 针对 Cassini 网络服务器

> ID：119971
> 
> 赞同：0
> 
> 时间：2008-09-23T09:04:42.157
> 
> 标签：selenium, cassini

我正在尝试针对在 Cassini 网络服务器上运行的 ASP.NET 代码运行 Selenium RC。

当我直接浏览 Web 应用程序时它可以工作，但是当我通过 Selenium 运行时我得到

HTTP 错误：403
禁止代理

* * *

运行 Selenium i 交互模式我开始一个新会话：

```
cmd=getNewBrowserSession&1=*iexplore&2=http://localhost:81/  
cmd=open&1=http://localhost:81/default.aspx&sessionId=199578

```

我在 Selenium 浏览器中收到上述错误，命令窗口告诉我 OK。

* * *

有输入吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T13:39:24.197

我认为问题在于 Selenium 和网络服务器都在 localhost 上运行。
如果我使用“iehta”而不是“iexplore”运行，它会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T16:32:58.630

我不确定这是否是问题的一部分，但是无法从另一台机器访问 cassini。它仅用于本地开发。我今天遇到了这个问题，正在尝试 UltiDev (cassini wrapper) 来解决它：[http ://www.ultidev.com/products/Cassini/index.htm](http://www.ultidev.com/products/Cassini/index.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T06:40:03.370

您的 Selenium 服务器和 Web 服务器应该运行不同的端口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-04T16:01:51.553

您是否尝试过使用 -proxyInjection 标志运行 RC？

# javascript - 通过javascript检测是否安装了Silverlight

> ID：119980
> 
> 赞同：10
> 
> 时间：2008-09-23T09:07:08.360
> 
> 标签：javascript, silverlight

是否有一个javascript函数可以用来检测当前浏览器中是否安装了特定的silverlight版本？

我对 Silverlight 2 Beta 2 版本特别感兴趣。我不想使用在 Silverlight 控件后面放置图像的默认方法，如果 Silverlight 插件未加载，则会显示该图像。

**编辑：**从接受的答案中提供的链接：

包括 Silverlight.js（来自 Silverlight SDK）

```
Silverlight.isInstalled("2.0"); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T09:10:53.967

包括 Silverlight.js（来自 Silverlight SDK）

`Silverlight.isInstalled("4.0")`

* * *

**资源：**

[http://msdn.microsoft.com/en-us/library/cc265155(vs.95).aspx](http://msdn.microsoft.com/en-us/library/cc265155(vs.95).aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-23T15:56:39.153

请实际使用[http://code.msdn.microsoft.com/silverlightjs](http://code.msdn.microsoft.com/silverlightjs)上提供的最新脚本以获取最新更新。这有几个修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T12:25:41.987

```
var hasSilverlight = Boolean(window.Silverlight);

var hasSilverlight2 = hasSilverlight && Silverlight.isInstalled('2.0'); 
```

ETC....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-10T13:25:05.417

下载此脚本：[http ://code.msdn.microsoft.com/silverlightjs](http://code.msdn.microsoft.com/silverlightjs)

然后你可以像这样使用它：

`if (Silverlight.isInstalled) { alert ("Congrats. Your web browser is enabled with Silverlight Runtime"); }`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-19T01:59:32.153

```
 if (Silverlight.isInstalled("1.0")) {
            try {
                alert("Silverlight Version 1.0 or above is installed");
            }
            catch (err) {
                alert(err.Description);
            }
        }
        else {
            alert("No Silverlight is installed");
        } 
```

从这个[视频](http://www.silverlight.net/learn/videos/all/how-to-determine-if-silverlight-is-installed/)。

Silverlight.isInstalled 始终为真，因此必须提供诸如“1.0”之类的版本字符串以使其有用。

# optimization - 是否应该在 Lucene 中的增量索引之后优化索引？

> ID：119994
> 
> 赞同：16
> 
> 时间：2008-09-23T09:11:16.727
> 
> 标签：optimization, lucene

我们每 7 天在 Lucene 索引上运行一次完整的重新索引（即从头开始创建索引），每 2 小时左右运行一次增量索引。我们的索引有大约 700,000 个文档，完整索引大约需要 17 个小时（这不是问题）。

当我们做增量索引时，我们只索引在过去两个小时内发生变化的内容，所以它花费的时间要少得多——大约半小时。但是，我们注意到其中很多时间（可能是 10 分钟）都花在了运行 IndexWriter.optimize() 方法上。

LuceneFAQ[提到](http://wiki.apache.org/lucene-java/LuceneFAQ#head-fd848c31f4dc7b91727be6f40a7f5fbe2c66cfb8)：

> IndexWriter 类支持压缩索引数据库并加快查询速度的 optimize() 方法。您可能希望在对文档集执行完整索引之后或在索引的增量更新之后使用此方法。如果您的增量更新频繁添加文档，您希望只偶尔执行一次优化以避免优化的额外开销。

...但这似乎没有对“经常”的含义给出任何定义。优化是 CPU 密集型和 IO 密集型的，所以如果我们可以侥幸逃脱，我们宁愿不这样做。在未优化的索引上运行查询的影响有多大（我在考虑特别是在完全重新索引后的查询性能方面，与在 20 个增量索引后相比，例如，50,000 个文档已更改）？我们应该在每个增量索引之后进行优化，还是性能损失不值得？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-23T11:16:40.450

Mat，由于您似乎很清楚当前过程需要多长时间，因此我建议您删除`optimize()`并衡量影响。

在这 2 小时的窗口中，许多文件是否发生了变化？如果只有一小部分（50,000/700,000 约为 7%）被增量重新索引，那么我认为您不会从`optimize()`.

一些想法：

*   根本不做增量`optimize()`。我的经验表明，无论如何您都没有看到巨大的查询改进。
*   每天做一次，`optimize()`而不是每两个小时做一次。
*   `optimize()`在低容量时间执行此操作（这是[javadoc](http://lucene.apache.org/java/2_2_0/api/org/apache/lucene/index/IndexWriter.html)所说的）。

并确保您进行测量。没有它们，这些变化可能是在黑暗中拍摄的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-24T00:57:21.607

一个`optimize`操作读取和写入整个索引，这就是为什么它如此 IO 密集的原因！

优化操作背后的想法是将 Lucene 索引中的所有不同段重新组合成一个段，这可以大大减少查询时间，因为您不必在每次查询时打开和搜索多个文件。如果您使用的是普通的 Lucene 索引文件结构（而不​​是组合结构），那么每次提交操作都会获得一个新段；与我假设的重新索引相同吗？

我认为[马特](https://stackoverflow.com/users/15790/matt-quail)有很好的建议，我会支持他所说的一切——由你拥有的数据驱动。实际上，我会更进一步，仅在需要时优化 a) 和 b) 在查询量较低时优化。

由于查询性能与索引中的段数密切相关，因此`ls -1 index/segments_* | count`在真正需要优化时，一个简单的指标可能是一个有用的指标。

或者，跟踪查询性能和数量并在达到不可接受的低性能和可接受的低数量时启动优化将是一个更好的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-06T07:59:10.550

在[此邮件](http://www.gossamer-threads.com/lists/lucene/java-dev/47895)中，如果您的索引不断更新，Otis Gospodnetic 建议*不要使用优化。*它是从 2007 年开始的，但调用`optimize()`本质上是一个 IO 繁重的操作。您可以考虑使用更逐步的方法；[合并调度](http://lucene.apache.org/java/3_0_2/api/all/org/apache/lucene/index/MergeScheduler.html)器

# c++ - 如何设置共享 ccache

> ID：119999
> 
> 赞同：10
> 
> 时间：2008-09-23T09:12:30.373
> 
> 标签：c++, c, compiler-construction, build-process

如何设置共享 ccache 而不会陷入权限问题？

我想运行具有最新更改的每晚或 CI 构建，并使用大型 ccache 存储库在整个研发过程中共享所有创建的二进制文件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-06-23T06:44:15.130

请参阅ccache 手册中新编写[的共享缓存部分。](https://ccache.dev/manual/3.7.11.html#_sharing_a_cache)本质上，使用相同的`CCACHE_DIR`设置，`CCACHE_UMASK`适当设置并考虑使用`CCACHE_BASEDIR`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T10:28:12.937

最简单的解决方案：创建一个新组（例如“devel”），并让所有开发人员成为其中的成员。为维护缓存的目录层次结构上的该组授予读/写权限。开发人员还需要修复他们的 umask。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-03T17:42:39.043

您还可以查看 Mozilla 的[sccache](https://github.com/mozilla/sccache)，这是一个类似 ccache 的工具，可以将构建工件存储在云存储（GCS/S3/Azure 或 redis/memcached）中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T10:52:27.733

如果您还使用相关的[distcc](http://distcc.samba.org/)，那么权限问题将在很大程度上消失，因为编译将在您设置的任何 compile-farm 主机上在它的控制下运行。

您还可以在 distcc 主机中包含开发人员的桌面机器，但代价是有一些重复的工作，其中一个文件可能会在多台机器上编译 - 尽管它永远不会返回一个过时的编译目标文件。它还将加快日常重新编译。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-25T06:10:16.527

请参阅[xcache](https://github.com/alibaba/xcache)。
是ccache-cloud，已经在阿里巴巴使用，效率很高。如果您使用的是 ccache，那么切换到 xcache 将非常容易。*****************