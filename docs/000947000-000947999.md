# StackOverflow 问答 000947000-000947999

# f# - F#：为什么选项类型与可空类型不兼容？

> ID：947003
> 
> 赞同：15
> 
> 时间：2009-06-03T20:23:21.513
> 
> 标签：f#, null

为什么像“int option”这样的选项类型不能与像“Nullable”这样的可空类型兼容？

我认为这种差异有一些语义上的原因，但我不知道那是什么。

> 当一个值可能存在或可能不存在时，使用 F# 中的一个选项。期权具有基础类型，可能持有该类型的价值，也可能没有价值。

[http://msdn.microsoft.com/en-us/library/dd233245%28VS.100%29.aspx](http://msdn.microsoft.com/en-us/library/dd233245%28VS.100%29.aspx)

这听起来确实像 Nullable 结构。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-10-07T10:10:16.963

由于`System.Nullable<'T>`.

Nullable 尝试通过空指针表示值的缺失，并通过指向这些值的指针来表示值。

```
(new System.Nullable<int>() :> obj) = null
|> printfn "%b" // true

(new System.Nullable<int>(1) :> obj).GetType().Name
|> printfn "%s" // Int32 
```

现在考虑字符串。不幸的是，字符串是可以为空的。所以这是有效的：

```
null : string 
```

但是现在`null`运行时值是模棱两可的——它可以指没有值或存在`null`值。因此，.NET 不允许构建`System.Nullable<string>`.

将此与以下内容进行对比：

```
(Some (null : string) :> obj).GetType().Name
|> printfn "%s" // Option`1 
```

**话虽**如此，我们可以定义一个双射：

```
let optionOfNullable (a : System.Nullable<'T>) = 
    if a.HasValue then
        Some a.Value
    else
        None

let nullableOfOption = function
    | None -> new System.Nullable<_>()
    | Some x -> new System.Nullable<_>(x) 
```

如果您观察类型，这些函数将被限制`'T`为结构并具有零参数构造函数。因此，也许 F# 编译器可以通过将 .NET 函数`Nullable<'T>`替换为 a 来公开接收/返回的.NET 函数`Option<'T where 'T : struct and 'T : (new : unit -> 'T)>`，并在必要时插入转换函数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T20:33:10.527

两者有不同的语义。仅举一个例子，Nullable 是一个幂等数据构造函数，仅适用于值类型，而 option 是一个普通的泛型类型。所以你不能有

```
Nullable<Nullable<int>> 
```

但你可以有一个

```
option<option<int>> 
```

一般来说，虽然有一些重叠的场景，但也有一些事情你可以用其中一种来做，但不能用另一种做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:31:49.467

关键区别在于必须测试选项类型以查看它是否具有值。有关其语义的良好描述，请参阅此问题：[选项类型如何在 F# 中工作](https://stackoverflow.com/questions/624116/how-does-the-option-type-work-in-f)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T20:32:48.950

同样，这是我有限的理解，但问题可能在于每个如何在 IL 中呈现。“可空”结构的处理方式可能与选项类型略有不同。

您会发现各种 .Net 语言之间的交互实际上归结为 IL 的呈现方式。大多数时候它工作得很好，但有时会引起问题。（[看看这个](http://www.nxtbook.com/nxtbooks/cmp/msdnmag0309/index.php?startid=34)）。就在您认为信任抽象级别是安全的时候。:)

# sql-server - 如何在 SQL SERVER 2005 中拥有一个带有“子数据”数据库的“主结构”数据库？

> ID：947006
> 
> 赞同：1
> 
> 时间：2009-06-03T20:24:20.480
> 
> 标签：sql-server, sql-server-2005, database-design, database-cloning

我一直在谷歌搜索，但我找不到这是否存在，或者我要求一些魔法 =P

好的，这就是交易。

我需要有一种方法来创建一个“主结构”数据库，它只包含模式、结构、表、存储过程、udfs 等，除了 SQL SERVER 2005 中的真实数据之外的所有内容（如果这在 2008 年可用，让我知道，我可以尝试说服我的客户支付它=P）

然后我想有几个实现这些模式、表等的主数据库的“孩子”，但每个人都有不同的数据。

所以当我需要创建一个新的存储过程或类似的东西时，我只是在主数据库上创建它（当然它在它的子数据库上可用）。

实际上我有几个不同的数据库具有相同的模式和不同的数据。但问题是要保持它们之间的一致性。每次我创建一个脚本来创建一些 SP 或添加一些索引或其他什么时，我必须在每个数据库中执行它，有时我可能会错过一个 =P

因此，假设您有一个 UNIVERSE（将是主 db），并且该 Universe 有 SPACES（每个都由一个子 db 表示）。所以我正在处理的应用程序需要动态“克隆”空间。为此，我们必须创建一个新数据库。现在，我正在创建正在克隆的数据库的备份，将其还原为新数据库并截断表。我希望能够创建“主”数据库的新“子”，它将维护模式和所有内容，但将从空数据开始。

希望很清楚...我的英语不是很完美，对此感到抱歉 =P 谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T20:50:29.273

您真正需要的是对数据库模式进行版本控制。

请参阅[do-you-source-control-your-databases](https://stackoverflow.com/questions/115369/do-you-source-control-your-databases)

如果您使用 SQL Server，我会推荐[dbGhost](http://www.innovartis.co.uk/) - 价格不贵，并且在以下方面做得很好：

*   同步2个数据库
*   区分2个数据库
*   从一组脚本创建一个数据库（我会推荐这个版本）。
*   批处理支持，以便您可以使用单个批处理升级所有数据库

您可以将此基础架构用于以下两者：

*   滚动开发版本以测试、集成和生产系统
*   将您的“更新”系统滚动到多个生产部署（尤其是在托管环境中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:32:08.530

我会将我的更改写为 sql 文件，并通过批处理文件使用 OSQL 或 SQLCMD，以确保我在所有数据库上重复执行而不考虑它。

作为替代方案，我会使用 VisualStudio Database Pro 工具或 RedGate SQL 比较工具来比较和传播更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:35:11.600

有一些问题，但处理这个问题的主流方法仍然是使用源代码控制（以及所有其他附带的好处。）而且 SQL Server 对 SCC 越来越友好。

此外，对于许多（最强大的）站点来说，每个服务器的问题与每个数据库的问题一样多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T20:30:31.233

您可以将东西放在像 SP 之类的 master 中，并从任何地方调用它们。至于表等其他对象，您可以[将它们放入模型中，新数据库将在您创建新数据库时获取它们](http://technet.microsoft.com/en-us/library/ms186388.aspx)。

但是，为了让新表在添加到父数据库后简单地弹出到子数据库中，什么都没有。

可以创建一些东西来查看数据库并从模板数据库编写脚本，并且还有一些商业工具可以帮助发现数据库之间的差异。您还可以在“主”数据库中有一个 DDL 触发器，当您创建一个新表时它会退出并执行此操作。

如果您保留了一个不错的 SPACES 模板，您可以编写脚本（没有数据）并创建新数据库 - 因此无需截断。您可以从 SQL 或外部工具编写脚本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T02:07:55.513

这里的小琐事。[mssqlsystemresource](http://msdn.microsoft.com/en-us/library/ms190940.aspx)数据库如您所描述的那样工作：定义一次并在每个数据库中“出现”为特殊`sys`模式。不幸的是，用户数据库无法使用此工作所需的特殊“魔法”。您必须使用部署技术来使您的架构保持同步。也就是说，将更改应用到每个数据库，就像已经建议的其他答案一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-04T03:21:05.897

理论上，您可以在 UNIVERSE.sysobjects 表上放置一个触发器（假设是 SQL Server），然后您可以枚举 master.dbo.sysdatabases 以查找所有子数据库。如果你有一个特殊的表表明它是一个子数据库，你可以参考 child.dbo.sysobjects 来找到它。

毫无疑问，这将很难实施。但这是你可以做到的一种方式。

# php - Plesk 9.01/Centos - 如何创建一个可以通过 PHP 上传到的目录？

> ID：947007
> 
> 赞同：0
> 
> 时间：2009-06-03T20:24:41.790
> 
> 标签：php, linux, plesk, uploading

考虑到我的所有 PHP.INI 文件都已正确设置为允许上传，我如何在 Plesk 中创建可以通过 PHP 上传到的目录？

分步说明将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-28T19:20:32.530

这是通过重新配置 php.ini 文件和设置文件夹权限来完成的。

# php - 动态代理类的自定义 foreach 结果 - 魔术方法？

> ID：947020
> 
> 赞同：4
> 
> 时间：2009-06-03T20:27:48.447
> 
> 标签：php, serialization, proxy, foreach

我需要序列化一个代理类。该类使用 __set 和 __get 将值存储在数组中。我希望序列化看起来只是一个平面对象。换句话说，我的课看起来像：

```
class Proxy
{
    public $data = array();
    public function __get($name)
    { 
        return $data[$name] 
    }
} 
```

当我说：

```
foreach($myProxy as $key) 
```

这可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T20:39:16.177

```
class Proxy implements IteratorAggregate
{
    public $data = array();
    public function __get($name)
    {
        return $data[$name];
    }
    public function getIterator()
    {
        $o = new ArrayObject($this->data);
        return $o->getIterator();
    }
}

$p = new Proxy();
$p->data = array(2, 4, 6);
foreach ($p as $v)
{
    echo $v;
} 
```

输出是：`246`。

有关更多详细信息，请参阅PHP 文档中的[对象迭代](http://ie2.php.net/manual/en/language.oop5.iterations.php)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T20:36:52.767

您想要实现[SPL 迭代器接口](http://uk.php.net/manual/en/class.iterator.php)

像这样的东西：

```
class Proxy implements Iterator
{
    public $data = array();

    public function __get($name)
    { 
        return $data[$name] 
    }

    function rewind()
    {
        reset($this->data);
        $this->valid = true;
    }

    function current()
    {
        return current($this->data)
    }

    function key()
    {
        return key($this->data)
    }

    function next() {
        next($this->data);
    }

    function valid()
    {
        return key($this->data) !== null;
    }
} 
```

# visual-studio - 创建 VS2008 集成包的好参考资料

> ID：947023
> 
> 赞同：0
> 
> 时间：2009-06-03T20:28:08.413
> 
> 标签：visual-studio, intellisense, vsinstaller

我正在寻找有关为 Visual Studio 2008 构建集成包的参考/教程材料。

我特别在寻找有关编辑器集成的信息，例如自定义语法（和包含的语言）的**智能感知和****源代码格式化/着色**。

我在 Microsoft MSDN 网站上找到[了一些信息](http://msdn.microsoft.com/en-us/library/bb166580(VS.80).aspx)，但与往常一样，在那里找到的信息造成的混乱多于启蒙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:42:31.520

您需要 Visual Studio SDK。[Visual Studio 可扩展性开发人员中心](http://msdn.microsoft.com/en-us/vsx/default.aspx)提供此资源和许多其他资源。

# sql-server - SQL 2005 性能：将 varchars 与 int 类型混合时的列顺序

> ID：947024
> 
> 赞同：0
> 
> 时间：2009-06-03T20:28:29.037
> 
> 标签：sql-server, sql-server-2005, performance

我有一张这样的桌子：

```
create table SomeTable (
   tableKey    int identity(1,1) not null
,  foreignKey  int               not null
,  longDesc    nvarchar(max)     not null
,  shortName   varchar(100)      null
) 
```

我需要在 where 子句中使用**shortName ：**

```
select 
    tableKey 
from 
    SomeTable 
where 
    foreignKey = @foreignKey 
and shortName = @shortName 
```

这需要很快——这个表有数百万行。我可以将它移到 longDesc 列上方并看到速度增加吗？我假设只要列的大小不变，数据库就可以简单地跳转到正确的字节偏移量。跳过 varchar 列肯定会导致某种性能损失，是吗？

或者，如果我制作 longDesc nchar(3784) 会怎样？（这应该使每一行填充一个 8KB 页面）这会提高速度吗？

我看到[这里的一个答案](https://stackoverflow.com/questions/34818/sql-server-does-column-order-matter/34859#34859)暗示了顺序在已用空间方面很重要的事实，但我不确定这如何转化为性能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T21:56:29.140

为了获得最大的速度，您将创建一个像 shortNameCrc = checksum(shortName) 这样的持久计算列，然后在 (foreignKey, checksum(shortName)) 上创建一个索引并包含 (shortName)。然后你会查询 where foreignKey = foreignKey and shortNameCrc = checksum(@shortName) and shortName = shortName

如果 SomeTable 没有聚集在 tableKey 上，那么您需要将 tableKey 添加为包含列。如果它聚集在 tableKey 上，则该值已经存在于覆盖索引中。

填充页面不应导致速度增加，这将使您消耗过多的内存，并且更有可能不得不访问磁盘。在某些情况下，对于同一物理区域中竞争非常激烈的工作负载，填充页面可能会更好地提高吞吐量。

制作 shortName char(100) 可能比 varchar(100) 更好。鉴于无限的内存，我怀疑它会是。在现实世界中，它可能取决于平均长度和缓存未命中的可能性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T20:53:25.757

> 我可以将它移到 longDesc 列上方并看到速度增加吗？

不，IIRC，nvarchar(max) 只在表本身中保留一个占位符/指针。正是出于这个原因，实际数据被移动到其他地方。出于同样的原因，更改 nvarchar(max) 的大小也无济于事。

您*应该*在foreignKey、shortName 和tableKey 上添加索引。然后您的查询可以完全满足索引。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T20:58:04.330

为了加快这个查询，你可以使用覆盖索引（ [http://www.devx.com/dbzone/Article/29530](http://www.devx.com/dbzone/Article/29530)），或者（foreignKey，shortName，tableKey）或者（shortName，foreignKey，tableKey）

尝试两者，看看哪个可以为您提供更好的性能

# c - 遵循原作者的编码风格？即使它很可怕/懒惰/让你的眼睛流血？

> ID：947029
> 
> 赞同：12
> 
> 时间：2009-06-03T20:28:39.007
> 
> 标签：c, open-source

当为一个非常古老且显然不再维护的开源或公共领域项目做出贡献时，是否建议遵循原作者的编码风格，即使它很糟糕？

更重要的是，是否有任何理由要遵循原作者的编码风格而不是对其进行大量清理？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-03T20:32:37.343

遵循原始的编码风格。*保持一致*要好得多，即使它对你来说并不漂亮。

如果您确实决定清理编码样式，请将其与任何其他更改分开进行。不要因为样式更改而弄乱源代码控制差异。进行一次（或多次）签入，您*唯一*要做的就是更改代码样式。不要将真正的更改与无意义的更改混在一起，这会导致在查看源代码控制提交时无法找到相关更改。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T20:31:03.323

如果您知道它没有维护，并且您正在对其进行更改，那么我怀疑您将成为事实上的所有者/维护者。

所以，也就是说，我会给原作者/维护者发电子邮件，看看他们对格式或风格变化的看法，然后继续前进。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T20:39:39.657

如果检查源代码控制，您可能希望不处理它，因为所有样式更改都将无法与以前的版本进行比较。

如果您确实想更改样式，请在进行任何其他更改之前使用基线代码进行更改，然后将其签入。

然后检查它并进行编码更改。这样，从您接管它的那一刻起就可以更轻松地跟踪您的更改。

除非您进行重大更改，否则我个人会单独保留样式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T20:31:34.290

如果您不提交补丁，那么不会。通过代码过滤器运行它并以您喜欢的样式自动格式化代码，然后破解。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T21:58:51.913

正如其他人所说，确保将任何样式修改与功能修改分开签入您的版本控制系统。

但是，我的建议是大胆地清理你认为合适的代码；“让露营地比你发现它时更干净”。俗气，但真实;）

只要确保您准备好捍卫您的更改；）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T20:49:42.553

见鬼！看在上帝的份上，无论你做什么都不会让事情*变得更糟*！

如果您要添加自己的代码，请以自己的风格进行。这至少会使部分代码库易于维护和理解。如果您正在对现有代码进行小幅更新，那么您可能希望遵循这种风格。

我在同一条船上，我必须维护一个古老的、业务关键的、基于 Access 2 的系统，这是一个完全混搭风格的系统。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T21:22:35.107

如果问题是：您在改造房屋时是否应该保持同样的劣质工艺？

如果您要在浴室中修复破损的墙砖，则不值得重新铺设整面墙，因为他们没有使用正确的干墙。

当你正在改造厨房时，你可能会纠正那个房间的管道或整理坏地板。那是因为它使您的其余工作变得更轻松。这就是它的全部意义，它给你带来了什么样的好处，而不是你/你的客户的成本。

您不会重新连接灯，因为它需要一个新灯泡。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T21:31:47.333

如果您正在按照公司定义的标准（甚至只是团队定义的标准）进行编码，并且您正在编写的代码与标准不匹配（或者太旧以至于与当前标准不匹配） )，那么如果您无论如何都要进行重大更改，请务必清理代码。（正如其他人提到的那样，对基线代码执行此操作，并将其签入。然后再次签出并进行您必须进行的更改以修复错误、添加功能等）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T20:32:50.027

好吧，我想说如果你只是在一个函数中做一个小的修改，那么与糟糕的风格一起使用可能会更清楚。

如果您创建新的方法、类、属性等，请使用清晰、高效的样式。您可以在这些部分的开头添加评论，以便其他人可以了解发生了什么。您甚至可以在顶部添加一个简短的注释，说明您何时开始编写代码，以及您使用的是不同的样式等。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-03T20:31:54.163

如果它甚至没有维护，你为什么要担心它？

我会使用我自己喜欢的风格来编写，并清理我必须使用的所有代码。我经常在工作中这样做，甚至...

# java - Hibernate *NOT* 抛出异常（我认为应该）

> ID：947038
> 
> 赞同：6
> 
> 时间：2009-06-03T20:30:25.587
> 
> 标签：java, hibernate

Hibernate JavaDoc 指出，`Session.update(Object o)`如果已经存在 的持久实例，则会引发异常`o`，对吗？

```
如果存在具有相同标识符的持久实例，则会引发异常。
```

但是，以下代码在我运行时不会抛出任何东西。我认为它应该！

```
Email email = new Email("andre", "girafa", "hi");

Session session = factory.openSession();
Transaction tx = session.beginTransaction();

session.save(email);
session.update(email);
session.update(email);

tx.commit();

// didn't throw... Let's try again

tx = session.beginTransaction();

session.update(email);
session.update(email);

tx.commit();
session.close();

// still nothing! :( 
```

正如你所说，我**两次**尝试做多个`update()`s，但 Hibernate 仍然对我很轻松。

有人有预感为什么？

**编辑：**它似乎只会抛出*另一个等效对象*，例如，`email2`具有相同的 ID `email`。我猜那里的文档有点草率。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T20:43:35.840

Hibernate 中的更新不是 SQL 语言中的更新。Hibernate通过 Session 对象中的状态缓存*自动*处理 SQL UPDATE 。

但它仅适用于当前会话中加载的实体。此方法**session.update(object)**用于将对象从另一层附加到当前会话以跟踪并可能在最后更新。

在你的情况下，这只是一个 NOOP。如果：

```
Email email = new Email("andre", "girafa", "hi");

Session session = factory.openSession();
Transaction tx = session.beginTransaction();

int id = session.save(email);
Email anotherEmail = new Email("", "", "");
anotherEmail.id = id;

session.update(anotherEmail);    // will throw 
```

[您可以在Hibernate 参考](http://docs.jboss.org/hibernate/stable/core/reference/en/html/objectstate-detached.html)上阅读有关更新方法语义的更多信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T20:55:17.813

没有错误，因为它与您正在更新的实例相同。

如果会话中存在不同的持久实例并且您尝试更新（），则会引发错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T20:44:21.283

您可以尝试使用 session.flush() 吗？查看是否会引发异常（有时提交可能不会根据刷新模式刷新数据）。

尽管我会说仅当对象在当前会话范围之外更新时才会引发异常，假设是由并发客户端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-02T05:47:15.790

我建议你总是坚持`EntityManager.merge`而不是Hibernate的`update`方法，`update`是相当混乱的。

我发现这篇[文章](http://www.baeldung.com/hibernate-save-persist-update-merge-saveorupdate)解释得很清楚，我总是提到。

> 与persist 和save 一样，update 方法是一种“原始” Hibernate 方法，早在添加merge 方法之前就已经存在。它的语义在几个关键点上有所不同：
> 
> *   它作用于传递的对象（其返回类型为 void）；update 方法将传递的对象从分离状态转换为持久
>     状态；
> *   如果您将瞬态实体传递给此方法，则会引发异常。
> 
> 在以下示例中，我们保存对象，然后将其从上下文中逐出（分离），然后更改其名称并调用更新。请注意，我们没有将更新操作的结果放在单独的变量中，因为更新发生在 person 对象本身上。基本上，我们将现有实体实例重新附加到持久性上下文中——JPA 规范不允许我们这样做。

```
Person person = new Person();
person.setName("John");
session.save(person);
session.evict(person);

person.setName("Mary");
session.update(person); 
```

> 尝试在瞬态实例上调用更新将导致异常。以下将不起作用：

```
Person person = new Person();
person.setName("John");
session.update(person); // PersistenceException! 
```

为了理解上面的部分，您需要了解`transient`和`detached`对象之间的区别。

# c# - 我的 ASP.NET 网站中的 aspnet_client 文件夹是什么？

> ID：947047
> 
> 赞同：4
> 
> 时间：2009-06-03T20:31:30.793
> 
> 标签：c#, asp.net, web, directory

我继承了一个网站，并在 Web 根目录中看到了该文件夹。我正在尝试清理旧垃圾，并想知道是否可以将其删除。

这个文件夹是用来做什么的？是自动生成的吗？是缓存吗？是什么创造了它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T20:35:15.297

它由 ASPNET_regiis /c 命令生成。我使用的大多数网站最终都将其包含在发行版中，因为系统管理员总是忘记安装它。它包含 .NET1.x 处理客户端回发事件模型所需的客户端 JavaScript 库。

如果您已升级到对脚本使用不同处理程序的 .NET 2（或者如果您准备重新创建它），则可以将其删除。但首先检查作者是否添加了其他文件，因为有时我有看到它用于额外的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:36:21.050

当您将客户端验证添加到服务器控件时，该文件夹用于存储自动生成的验证脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-29T20:44:19.247

该文件夹是用于存储服务器所有应用程序（.skin 文件）的默认主题的其他内容之一。

# c# - 有没有办法将 .aspx 页面用作从 winform 应用程序发送的电子邮件的模板？

> ID：947057
> 
> 赞同：1
> 
> 时间：2009-06-03T20:32:25.020
> 
> 标签：c#, asp.net, winforms, email

ASP.NET 非常适合创建 html。我们发送了大量的 html 电子邮件。过去，我们一直在加载带有替换键字符串的 .html 模板，以使电子邮件更加自定义（即，[[FirstName]] 将替换为“John Doe”）。然而，随着我们添加越来越多的电子邮件活动，自定义电子邮件的逻辑开始失控。我们的任务不是简单的 [[FirstName]] 字符串替换，而是类似 [[ScholarshipList]] 的任务，其中 ScholarshipList 对于我们发送电子邮件的每个用户都是不同的。

理想情况下，至少在我看来，这些电子邮件模板将是自包含的 .aspx 页面。并且会以类似的方式从我们的 winform 电子邮件应用程序中调用

```
IEmailTemplate template = EmailTemplates.Load("ScholarshipList.aspx");
template.UserID=1234;
string emailMessage = template.Render(); 
```

然后 ScholarshipList.aspx 页面看起来与任何其他 asp.net 页面相似，因为它可以具有服务器控件、runat="server" 脚本和数据绑定。

我看过这篇文章[http://www.west-wind.com/presentations/aspnetruntime/aspnetruntime.asp](http://www.west-wind.com/presentations/aspnetruntime/aspnetruntime.asp)看起来很有希望。以前有人用过吗？它使用一些理想情况下可以避免的远程处理，并且具有有限的错误处理机制。我想在我走得很远之前我会得到一些其他的反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T20:38:55.337

你也可以试试这种方法。[http://jamesewelch.com/2008/07/11/how-to-render-a-aspnet-user-control-within-a-web-service-and-return-the-generated-html/](http://jamesewelch.com/2008/07/11/how-to-render-a-aspnet-user-control-within-a-web-service-and-return-the-generated-html/)

如果您将模板托管在 Web 服务中，然后从您的应用程序中调用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T01:43:08.750

一种快速而肮脏的方法是对 url 执行 HttpWebRequest 并获取输出并使用它，但这不如 David 的分析器好......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-24T18:14:31.170

您还可以查看 Smart Code，这是一个基于 Asp.net 模板的代码生成开源项目。

[http://www.codeplex.com/smartcodegenerator](http://www.codeplex.com/smartcodegenerator)

它与 Nant 和 Cassini 集成，因此您可以从命令行或 WinForm 应用程序运行它。

但是对于电子邮件，更常见的是使用上面提到的简单 String.Replace，但如果您需要执行循环等，那么模板可能会更好。

要解决您在没有 asp.net 模板的情况下提到的 [[ScholarshipList]] 问题，您还可以使用如下文本文件：

```
Hello [[MemberSimpleReplace][FIRSTNAME]],
Here is your ScholarShipList:
[[ScholarShip]] 
```

然后使用工厂方法模式来实例化正确的工厂（这是伪代码，请多多包涵）

```
IEmailContentGenerator gen = EmailContentGenFactory.getGenerator("MemberSimpleReplace");
var params = {"FIRSTNAME"};
var stringToSubstitute = gen.Generate(params,context);
var gen2 = EmailContentGenFactory.getGenerator("ScholarShip");
var params2 = {};
var stringToSubstitute2 = gen2.Generate(params2,context); 
```

然后，当您可以轻松实现新的生成器时，生成器会获得一组参数和包含 UserId 以及可能还有其他一些值的上下文。

还要记住，Asp.net 不是 .net 中唯一生成 HTML 的模板工具，您可以查看 NVelocity 或 Asp.net MVC 的许多视图引擎。

# postgresql - 如何查找加载到 EnterpriseDB 中的语言？

> ID：947063
> 
> 赞同：0
> 
> 时间：2009-06-03T20:33:16.017
> 
> 标签：postgresql, metadata, plpgsql, spl, enterprisedb

如何找到 EnterpriseDB（PL/pgsql、SPL、Java）中加载了哪些语言？如果有人知道在 PostgreSQL 上找到加载的语言的方法，EnterpriseDB 是建立在 PostgreSQL 之上的。它应该工作相同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T21:01:50.453

安装的语言在 中注册`pl_language`，例如：

```
steve@steve@[local] =# select * from pg_language;
 lanname  | lanowner | lanispl | lanpltrusted | lanplcallfoid | lanvalidator | lanacl
----------+----------+---------+--------------+---------------+--------------+--------
 internal |       10 | f       | f            |             0 |         2246 |
 c        |       10 | f       | f            |             0 |         2247 |
 sql      |       10 | f       | t            |             0 |         2248 |
 plpgsql  |       10 | t       | t            |         73259 |        73260 |
(4 rows) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:47:48.033

检查[“pg_language”](http://www.postgresql.org/docs/current/static/catalog-pg-language.html)系统目录（希望 EDB 与 Postgres 没有什么不同）。

# database-design - 实时数据和草稿数据的数据库模型

> ID：947065
> 
> 赞同：8
> 
> 时间：2009-06-03T20:33:26.203
> 
> 标签：database-design

我一直在考虑在数据库中保存一组“实时”数据和一组草稿数据的最佳方式。实时版本显示在网站上，草稿版本一直在工作，直到准备好上线。该模型是关系模型，由许多表组成。

我目前的方法是拥有 2 个数据库，一个用于草稿，一个用于实时。当您将数据提升为实时数据时，SQL 只是将数据从草稿数据库复制到实时数据库。

这很好，但有点慢而且看起来很乱。并且经常 SQL 必须考虑这两组表。

另一种方法是将实时指标作为每个表的键的一部分，这样我就可以在同一个表中同时保存实时和草稿 - 并更新指标以使数据生效。- 我真的不相信这个想法。

*   DBMS 是 Sybase。

如果有人有任何其他建议，我将不胜感激。

嗯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T20:47:30.653

有一张桌子

```
DataTable
    DataKey
    DataMode
    Data... 
```

PK为DataKey+DataMode
校验约束：DataMode IN ('L','D') --live or draft

您首先使用 DataMode='D' --draft
进行插入，然后使用 INSERT SELECT 将其复制到同一个表中，设置 DataMode='L'
始终编辑 DataMode='D'，然后将其推送到 DataMode= 'L' 完成后。

当您想在模式中显示数据传递时，请使用 WHERE DataKey=@x AND DataMode=@Mode

我不确定您将如何处理删除（删除草稿然后将其推送到现场？）您可能想要添加一个状态列：

```
 DataStatus  --'A'ctive 'D'eleted 
```

在一个表中执行此操作允许所有 sql 共同用于“L”ive 或“D'raft。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T22:41:18.380

使用您已经使用的任何密钥，以及默认为 N 的布尔 is_live 列。当您要发布时，只需将该列更新为 Y。

完成这项工作将迫使您检查所有查询，以便在不应该看到草稿时过滤掉草稿，但可以让您不必维护 2 个具有相同格式的并行表等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T22:19:24.073

两种想法，视情况而定。

如果在草稿版本推出时某些数据仍然是最新的，并且您只想使新数据一次生效，您可以为每个数据元素设置一个版本号，并为当前活动的版本号设置一个配置选项。然后编写逻辑，使所选记录的版本号 <= 当前版本号（忽略更高的版本号）。这将是低中断，并且可能通过需要两个版本来处理您的意思。

如果要交换整个表，并且可以（非常）短暂地断开连接，请重命名表。可能比您描述的选项更具破坏性，并且还可以允许同时访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T22:07:41.833

我认为这是有效约会的主要候选人。为每个表添加开始日期和结束日期。如果当前日期在开始日期和结束日期之间，或者在开始日期之后并且结束日期为 NULL，则记录是活动的。其他任何内容都不会显示为实时，允许您拥有草稿数据。

如果数据是连续的并且要维护先前值的历史，这将允许多于一组草稿数据。或者，如果数据量是一个问题，请在数据库工作负载较低时运行一项作业，以删除结束日期小于当前日期的任何记录。

# delphi - 允许在顶部绘制主窗体的非模态子窗口 - Delphi

> ID：947068
> 
> 赞同：3
> 
> 时间：2009-06-03T20:34:16.000
> 
> 标签：delphi, non-modal

在 Delphi (2009 Pro) - 我有一个可以创建非模态子窗口的主窗体。我希望无论哪种形式都有焦点在上面绘制 - 即使它是具有焦点的主窗口。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-04T05:52:42.710

在 Delphi 2007/2009 中，VCL 改变了它关于表单父级的行为。在 Delphi 1-2006 中，表单的父级是隐藏的应用程序窗口 (Application.Handle)。在 Delphi 2007/2009 中，窗体的父级是主窗体，主窗体的父级是桌面。

如果要更改此设置，您可以将 *.dpr 行更改为`Application.MainFormOnTaskbar`恢复`False`旧行为的内容，但也会使您的应用程序在 Vista 和 Windows 7 中看起来很奇怪。或者您可以覆盖所有非虚拟 CreateParams 方法模态子窗体并将`Params.WndParent`字段设置为桌面 ( `HWND_DESKTOP`) 或仍然存在的`Application.Handle`.

```
type
  TMyChildForm = class(TForm)
  protected
    procedure CreateParams(var Params: TCreateParams); override;
  end;

procedure TForm1.CreateParams(var Params: TCreateParams);
begin
  inherited CreateParams(Params);
  Params.WndParent := Application.Handle;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T23:21:27.160

多个窗口不能同时获得焦点。我假设您的意思是，当只有 MainForm 具有焦点时，您希望您的非模态子窗体位于顶部。您是否尝试过将子窗体的 FormStyle 属性设置为 fsStayOnTop？

# java - JNA : Exception_Access_Violation

> ID：947069
> 
> 赞同：2
> 
> 时间：2009-06-03T20:34:24.360
> 
> 标签：java, jna

我在libpotrace.dll中使用JNA调用这个函数，这个函数是：

```
potrace_state_t *potrace_trace(const potrace_param_t *param,
const potrace_bitmap_t *bm); 
```

库中的参数为：

```
typedef unsigned long potrace_word;

struct potrace_bitmap_s {
  int w, h;              /* width and height, in pixels */
  int dy;                /* words per scanline (not bytes) */
  potrace_word *map;     /* raw data, dy*h words */
};
typedef struct potrace_bitmap_s potrace_bitmap_t;

struct potrace_param_s {
  int turdsize;        /* area of largest path to be ignored */
  int turnpolicy;      /* resolves ambiguous turns in path decomposition */
  double alphamax;     /* corner threshold */
  int opticurve;       /* use curve optimization? */
  double opttolerance; /* curve optimization tolerance */
  potrace_progress_t progress; /* progress callback function */
};
typedef struct potrace_param_s potrace_param_t; 
```

在我的java代码中，我有：

```
public class Potrace_bitmap_t extends Structure{
    public int w=36;
    public int h=2; /* width and height, in pixels */
    public int dy=2; /* words per scanline (not bytes) */   
    public long [] map =new long[dy*h];
}

public class potrace_param_t  extends Structure{    
    //public static class ByValue extends Nat implements Structure.ByValue { }

    public int turdsize=0;
    public int turnpolicy=0;
    public double alphamax=0;
    public int opticurve=0;
    public double opttolerance=0;   

}

potrace_param_t na=lib.potrace_param_default();/*This function returns a fresh set of tracing parameters, initialized to defaults.
Potrace_bitmap_t bm=new Potrace_bitmap_t();
bm.map[0]=1113215L;
bm.map[1]=4026531840L;
bm.map[2]=3276415L;
bm.map[3]=4026531840L;
Potrace_state_t pt=lib.potrace_trace(na, bm); 
```

当我执行 potrace_trace() 时，会发生此错误：

```
An unexpected error has been detected by Java Runtime Environment:

 EXCEPTION_ACCESS_VIOLATION (0xc0000005) at pc=0x6504fbee, pid=2728, tid=2436

 Java VM: Java HotSpot(TM) Client VM (1.6.0_03-b05 mixed mode, sharing)
 Problematic frame:
 C  [libpotrace.dll+0xfbee]

 An error report file with more information is saved as hs_err_pid2728.log

 If you would like to submit a bug report, please visit:
  http://java.sun.com/webapps/bugreport/crash.jsp 
```

我不懂为什么。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T10:18:17.900

但是在图书馆的文档中，我发现了这个

```
w = 36;
h = 12;
dy = 2;
map[22] = 0xfff0fc02; map[23] = 0x00000000;
map[20] = 0x7ff1fe02; map[21] = 0x00000000;
map[18] = 0x3ff3ff07; map[19] = 0x00000000;
map[16] = 0x1ff7ff87; map[17] = 0x00000000;
map[14] = 0x0ff7cf8f; map[15] = 0x80000000;
map[12] = 0x07f7878f; map[13] = 0x80000000;
map[10] = 0x03f7879f; map[11] = 0xc0000000;
map[8] = 0x01f7cf9f; map[9] = 0xc0000000;
map[6] = 0x00f7ffbf; map[7] = 0xe0000000;
map[4] = 0x0073ff3f; map[5] = 0xe0000000;
map[2] = 0x0031fe7f; map[3] = 0xf0000000;
map[0] = 0x0010fc7f; map[1] = 0xf0000000; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T01:30:54.403

Potrace_bitmap_t 的第四个字段应该是一个指针，而不是一个 64 位值的数组。您缺少 potrace_param_t 的最后一个字段。

# python - 在 linux 上使用 pyodbc 在 nvarchar mssql 字段中插入 unicode 或 utf-8 字符

> ID：947077
> 
> 赞同：22
> 
> 时间：2009-06-03T20:35:24.327
> 
> 标签：python, sql-server, unicode, utf-8, pyodbc

我正在使用**Ubuntu 9.04**

我已经安装了以下软件包版本：

```
unixodbc and unixodbc-dev: 2.2.11-16build3
tdsodbc: 0.82-4
libsybdb5: 0.82-4
freetds-common and freetds-dev: 0.82-4 
```

我是这样配置`/etc/unixodbc.ini`的：

```
[FreeTDS]
Description             = TDS driver (Sybase/MS SQL)
Driver          = /usr/lib/odbc/libtdsodbc.so
Setup           = /usr/lib/odbc/libtdsS.so
CPTimeout               = 
CPReuse         = 
UsageCount              = 2 
```

我是这样配置`/etc/freetds/freetds.conf`的：

```
[global]
    tds version = 8.0
    client charset = UTF-8 
```

`31e2fae4adbf1b2af1726e5668a3414cf46b454f`我已从中获取pyodbc 修订版并使用“ ”`http://github.com/mkleehammer/pyodbc`安装它`python setup.py install`

我的本地网络上有一台装有*Microsoft SQL Server 2000*的 Windows 机器，启动并监听本地 IP 地址 10.32.42.69。我有一个名为“Common”的空数据库。我有用户“sa”，密码为“secret”，拥有完全权限。

我正在使用以下 python 代码来设置连接：

```
import pyodbc
odbcstring = "SERVER=10.32.42.69;UID=sa;PWD=secret;DATABASE=Common;DRIVER=FreeTDS"
con = pyodbc.connect(s)
cur = con.cursor()
cur.execute('''
CREATE TABLE testing (
    id INTEGER NOT NULL IDENTITY(1,1), 
    name NVARCHAR(200) NULL, 
    PRIMARY KEY (id)
)
    ''')
con.commit() 
```

到目前为止一切**正常。**我在服务器上使用了 SQLServer 的企业管理器，新表就在那里。现在我想在表上插入一些数据。

```
cur = con.cursor()
cur.execute('INSERT INTO testing (name) VALUES (?)', (u'something',)) 
```

那失败了！！这是我得到的错误：

```
pyodbc.Error: ('HY004', '[HY004] [FreeTDS][SQL Server]Invalid data type 
(0) (SQLBindParameter)' 
```

由于我的客户端配置为使用 UTF-8，我想我可以通过将数据编码为 UTF-8 来解决。那行得通，但后来我得到了奇怪的数据：

```
cur = con.cursor()
cur.execute('DELETE FROM testing')
cur.execute('INSERT INTO testing (name) VALUES (?)', (u'somé string'.encode('utf-8'),))
con.commit()
# fetching data back
cur = con.cursor()
cur.execute('SELECT name FROM testing')
data = cur.fetchone()
print type(data[0]), data[0] 
```

这没有错误，但返回的数据与发送的数据不同！我得到：

```
<type 'unicode'> somÃ© string 
```

也就是说，pyodbc 不会直接接受 unicode 对象，但它会将 unicode 对象返回给我！并且编码被混淆了！

现在的问题：

我想要代码在 NVARCHAR 和/或 NTEXT 字段中插入 unicode 数据。当我查询回来时，我想要我插入回来的相同数据。

这可以通过以不同的方式配置系统，或者通过使用能够在插入或检索时正确地将数据转换为/从 unicode 的包装函数

这要求不高，是吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-08T13:06:21.500

我记得使用 odbc 驱动程序时遇到过这种愚蠢的问题，即使当时它是 java+oracle 的组合。

核心是 odbc 驱动程序在将查询字符串发送到数据库时显然对其进行了编码。即使该字段是 Unicode，并且如果您提供 Unicode，在某些情况下它似乎也无关紧要。

您需要确保驱动程序发送的内容与您的数据库（不仅是服务器，还有数据库）具有相同的编码。否则，您当然会得到时髦的字符，因为客户端或服务器在编码/或解码时会混淆。您对您的服务器用作解码数据的默认字符集（MS 喜欢说的代码点）有任何想法吗？

## 排序与此问题无关:)

例如，参见[那个 MS 页面](http://msdn.microsoft.com/en-us/library/aa174903(SQL.80).aspx)。对于 Unicode 字段，排序规则仅用于定义列中的排序顺序，**而不是**指定数据的存储方式。

如果您将数据存储为 Unicode，则有一种独特的方式来表示它，这就是 Unicode 的目的：无需定义与您将要使用的所有语言兼容的字符集 :)

这里的问题是“当我将数据提供给*不是*Unicode 的服务器时会发生什么？”。例如：

*   当我向服务器发送一个 UTF-8 字符串时，它是如何理解的？
*   当我向服务器发送一个 UTF-16 字符串时，它是如何理解的？
*   当我向服务器发送一个 Latin1 字符串时，它是如何理解的？

从服务器的角度来看，所有这 3 个字符串都只是一个字节流。服务器无法猜测您对它们进行编码的编码。这意味着如果您的 odbc 客户端最终将*字节字符串*（编码字符串）发送到服务器而不是发送*unicode数据，您**将*遇到麻烦：如果您这样做，服务器将使用预定义的编码（这是我的问题：什么编码服务器将使用？因为它不是猜测，它必须是一个参数值），如果字符串已经使用不同的编码*dzing*进行编码，数据将被破坏。

 ***这与在 Python 中的操作完全相同：

```
uni = u'Hey my name is André'
in_utf8 = uni.encode('utf-8')
# send the utf-8 data to server
# send(in_utf8)

# on server side
# server receives it. But server is Japanese.
# So the server treats the data with the National charset, shift-jis:
some_string = in_utf8 # some_string = receive()    
decoded = some_string.decode('sjis') 
```

就试一试吧。很有趣。解码后的字符串应该是“Hey my name is André”，但实际上是“Hey my name is Andrﾃｩ”。é 被日语 ﾃｩ 取代

因此我的建议是：您需要确保 pyodbc 能够直接以 Unicode 格式发送数据。如果 pyodbc 没有做到这一点，你会得到意想不到的结果。

我以客户端到服务器的方式描述了这个问题。但是当从服务器返回到客户端时，也会出现同样的问题。如果客户端无法理解 Unicode 数据，您可能会遇到麻烦。

## FreeTDS 为您处理 Unicode。

实际上，FreeTDS 会为您处理一切并将所有数据转换为 UCS2 unicode。（[来源](http://www.freetds.org/userguide/unicodefreetds.htm)）。

*   服务器 <--> FreeTDS : UCS2 数据
*   FreeTDS <--> pyodbc ：编码字符串，以 UTF-8 编码（来自`/etc/freetds/freetds.conf`）

因此，如果您将 UTF-8 数据传递给 pyodbc，我希望您的应用程序能够正常工作。事实上，正如这张[django-pyodbc 票](http://code.google.com/p/django-pyodbc/issues/detail?id=41)所说，django-pyodbc 以 UTF-8 与 pyodbc 通信，所以你应该没问题。

### 免费TDS 0.82

但是，[cramm0](http://code.google.com/p/django-pyodbc/issues/detail?id=41#c1)表示 FreeTDS 0.82 并非完全没有错误，并且 0.82 与官方修补的 0.82 版本之间存在显着差异，可在[此处](http://freetds.sourceforge.net/)找到。您可能应该尝试使用已修补的 FreeTDS

* * *

**编辑**：*删除旧数据，与 FreeTDS 无关，仅与 Easysoft 商业 odbc 驱动有关。对不起。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-05T01:28:17.420

我使用 UCS-2 与 SQL Server 交互，而不是 UTF-8。

更正：我更改了 .freetds.conf 条目，以便客户端使用 UTF-8

```
 tds version = 8.0
    client charset = UTF-8
    text size = 32768 
```

现在，绑定值适用于 UTF-8 编码的字符串。驱动程序在用于数据服务器端存储的 UCS-2 和提供给客户端/从客户端获取的 UTF-8 编码字符串之间进行透明转换。

这是运行 Python 2.5 和 FreeTDS freetds-0.82.1.dev.20081111 和 SQL Server 2008 的 Solaris 10 上的 pyodbc 2.0

```
导入pyodbc
test_string = u"""评论 ça va ? Très bien ?"""

打印类型（test_string），repr（test_string）
utf8 = 'utf8:' + test_string.encode('UTF-8')
打印类型（utf8），repr（utf8）

c = pyodbc.connect('DSN=SA_SQL_SERVER_TEST;UID=XXX;PWD=XXX')

cur = c.cursor()
# 这不起作用，因为 test_string 不是 UTF 编码的
尝试：
    cur.execute('INSERT unicode_test(t) VALUES(?)', test_string)
    c.commit()
除了 pyodbc.Error，e：
    打印 e

# 这个是：
尝试：
    cur.execute('INSERT unicode_test(t) VALUES(?)', utf8)
    c.commit()
除了 pyodbc.Error，e：
    打印 e    

```

这是测试表的输出（我通过 Management Studio 手动输入了一堆测试数据）

```
在 [41] 中：对于 i in cur.execute('SELECT t FROM unicode_test')：
   .....：打印我
   .....：
   .....：
（“这不是香蕉”，）
('\xc3\x85kergatan 24', )
('\xc3\x85kergatan 24', )
('\xe6\xb0\xb4 这是代码点 63CF', )
('Mich\xc3\xa9l', )
（'评论 va ? Trs bien ?', ）
('utf8:Comment \xc3\xa7a va ? Tr\xc3\xa8s bien ?', )

```

我能够通过“编辑前 200 行”对话框将一些 unicode 代码点直接从 Management Studio 放入表中，并输入 unicode 代码点的十六进制数字，然后按 Alt-X

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-28T12:59:48.193

我在尝试绑定 unicode 参数时遇到了同样的问题：'[HY004] [FreeTDS][SQL Server]Invalid data type (0) (SQLBindParameter)'

我通过将 freetds 升级到 0.91 版解决了这个问题。

我使用 pyodbc 2.1.11。我必须应用[此](http://code.google.com/p/pyodbc/issues/attachmentText?id=170&aid=1700009000&name=pyodbc_sqlwchar.patch&token=b1544dc75931626188818536df608f3d%20this)补丁才能使其与 unicode 一起使用，否则我偶尔会遇到内存损坏错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-15T03:50:11.117

您确定是 INSERT 导致无法阅读吗？pyodbc [Problem fetching NTEXT and NVARCHAR data](http://code.google.com/p/pyodbc/issues/detail?id=13)上存在一个错误。

# hl7 - Mirth：与频道源类型不同的入站消息模板

> ID：947078
> 
> 赞同：2
> 
> 时间：2009-06-03T20:35:41.660
> 
> 标签：hl7, mirth

问题是入站消息模板预期的类型与我想要指定或使用的类型不同。要求是有一个 SINGLE 通道将 HL7 v2 转换为 v3，调用 Web 服务，然后转换 SOAP 生成的 XML，并将其转换为 HL7 v2.x 并将其发送回原始调用者。**这必须异步完成**。

**设置：** 考虑 Mirth 频道中的情况：

*   源是 LLP 侦听器。类型为 HL7 v2.x。发件人是 HCIS（医疗保健信息系统）。
*   源变压器，与手头的问题无关。
*   4 个目的地（按顺序）：

    *   Javascript Writer - 调用代码模板来做一些数据库工作。
    *   SOAP Sender - 调用返回 HL7 v3 的 Web 服务。
    *   Javascript Writer - 包含少数调用代码模板的 Transformers DB 编写器。***问题就在这里。***
    *   Javascript Writer - 再次调用代码模板。
*   PostProcessor 生成自定义确认以发送回 HCIS。

**问题：** 入站消息模板需要 HL7 v2.x，因为它从源继承数据类型。我需要将 HL7 v3 模板映射到出站消息模板。出站模板工作正常，因为它没有绑定到任何东西。

```
 tmp['PID']['PID.5']['PID.5.1'] = msg['controlActProcess']['subject']['target']['identifiedPerson']['name']['family'].toString(); 
```

我已经在另一个使用 HL7 v3 作为传入数据类型的通道中测试了这个设置，它运行良好。

**问题：** 如何强制 Mirth 将我的入站消息模板识别为 HL7 v3，而不是继承通道的传入数据类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-04T22:19:52.410

有点晚了，我知道，但你能把它分成 2 个通道：一个 HL7 v2.x 到一个通道编写器，然后另一个设置为 HL7 v3.x 的一个通道读取器？

如果你已经解决了这个问题，我很想知道如何。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-15T17:34:50.163

好的，我是在你发布问题两年半后写这篇文章的，所以现在你已经以某种方式处理了它。但是，为了使信息可用，这里有一个答复。

您有一个输入为 HL7 v2.x 的输出连接器。您需要 XML 格式的输入数据（HL7 v3 是 XML），以便您可以使用 E4X 对其进行操作。

解决方案：Mirth Connect 会自动处理此问题。只要连接器具有过滤器或转换器，Mirth 就会将输入消息转换为 XML。您说此连接器具有转换器，因此您应该可以使用 HL7 输入消息的 XML 表示。

如果您使用没有过滤器和转换器的通道，您可以通过添加条件始终为真的过滤器来强制转换。

# c++ - 在 C++ 中将指针表示为字符串的最佳可移植方式是什么？

> ID：947079
> 
> 赞同：5
> 
> 时间：2009-06-03T20:35:41.707
> 
> 标签：c++, pointers

我需要将指针表示为用户的字符串。有时这些值可能会保存到一个文件中并传输到具有不同架构的计算机（32 位与 64 位是当前的主要问题）并从文本文件加载进行比较 - 我只会将加载的值*相互*比较，但我仍然更喜欢比较数字而不是字符串。

我目前正在使用：

```
SomeClass* p;
...
printf("%ld", (uintptr_t)p); 
```

但我想知道这是否是可移植的（不过，Windows 和 Linux 仅在这个阶段很重要），一旦 128 位系统出现，这是否会破坏？

**编辑**：除非我决定使用 uint64_t，并决定 64 位是屋顶，否则无法做到这一点，因为某些 64 位指针可能在 32 位整数范围之外。所以，我决定比较字符串会更安全，即使它比较慢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-03T20:36:32.720

对于指针，请始终使用`%p`--- 它是专门为以正确格式打印指针而设计的格式说明符。:-)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T20:37:54.400

我会这样做：

```
std::cout << p; 
```

如果您对 cstdio 有信心：

```
printf("%p", p); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-03T20:37:38.880

printf 有一个 %p 格式化程序，我认为它是标准化的：

```
printf( "%p", p ); 
```

但是当您使用 C++ 时，ostreams 已经重载了指针输出：

```
#include <iostream>
using namespace std;;

class A {};

int main() {
    A a;
    cout << &a << endl;
} 
```

产生：

```
0x22ff6f 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T20:38:46.897

您在寻找`%p`格式化字符串吗？

```
printf("%p", p); 
```

这将给出指针指向的十六进制编码地址（并且，我认为，格式`NULL`s 也适合你）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T20:48:05.347

我会这样做：

```
cout << p << endl; 
```

字符串（相同编码）是可移植的。如果要将它们作为指针进行比较，则必须将字符串解析回`unsigned long`第一个。

至于 128 位系统，它们还有很长的路要走。使用 64 位，您可以直接寻址 1680 万兆兆字节的 RAM。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-01T11:14:10.243

它也可以作为

printf("%#x", p);

这将确保跨平台的类似格式（0x ...）。

# .net - .NET WinForms HTML 编辑器组件

> ID：947098
> 
> 赞同：4
> 
> 时间：2009-06-03T20:39:07.020
> 
> 标签：.net, html, winforms, editor, html-editor

我们正在寻找用于在 WinForms 中进行 HTML 编辑的 .NET 组件。我看过[这篇](https://stackoverflow.com/questions/214124/winforms-html-editor)文章，这就是我们现在正在使用的那种，但它很旧而且很笨拙，我正在寻找一个更清洁的解决方案。我真的没有时间（或者现在没有时间）从头开始编写我们自己的......并且希望那里有一个商业/免费的解决方案。我看过 Netrix 组件，最初并没有给我留下太大的印象……还有其他东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T13:34:10.740

您可以尝试 SpiceLogic 的 .NET Win HTML Editor Control，它不是免费的，但功能强大。链接在这里：

[https://www.spicelogic.com/Products/NET-WinForms-HTML-Editor-Control-8](https://www.spicelogic.com/Products/NET-WinForms-HTML-Editor-Control-8)

这是一张带有功能亮点的图像。

[![在此处输入图像描述](https://i.stack.imgur.com/BxhFt.png)](https://i.stack.imgur.com/BxhFt.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T21:21:28.027

有一个相当不错的免费...

[http://windowsclient.net/articles/htmleditor.aspx](http://windowsclient.net/articles/htmleditor.aspx)

它有限制......但话又说回来......它是免费的。我已经将此控件用于几个非商业应用程序。

赛斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:47:54.053

我自己也喜欢[xstandard](http://www.xstandard.com)。不便宜，但对我用过的所有东西都很好。

# iphone - UIViewController 子类初始化

> ID：947102
> 
> 赞同：0
> 
> 时间：2009-06-03T20:40:00.590
> 
> 标签：iphone, objective-c, cocoa-touch

假设我有一个显示 s 列表的`FooController`子类。处理我的财产生命周期的最佳做法是什么？`UIViewController``Foo``foo`

我是否将其定义`@property`为读/写？它不是真的——一旦它被设置，改变它可能会导致不一致的状态。我是否创建`@property`as`readonly`并编写一个新的指定初始化程序，`initWithFoo:(Foo *) aFoo`它调用`initWithNibName:bundle:`？现在，每次控制器从堆栈中弹出时，我都必须创建一个新实例，并使用新的`foo`.

在我看来，后者喜欢采取的方法，但我从未见过有人这样做。那么标准做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T21:55:39.907

属性通常是要走的路。它们为您提供 KVC/KVO 的力量

您应该将该类设置为 Foo 属性 (KVO) 的观察者。然后每次更改 Foo 时，您都有机会处理它。无需担心不一致。

```
 [self addObserver:self forKeyPath:@"foo" options:0 context:@"fooChanged"]; 
```

然后观察变化：

```
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context{

     if([keyPath isEqualToString:@"foo"]){

       //do your thing

    }
} 
```

现在不管 foo 是在初始化器中设置还是稍后设置，您都可以处理它。您不希望通过强制任何对象以预定顺序与您的类一起工作来破坏您的代码。这是非常不灵活的做法，通常是不好的做法。这样你就可以优雅地处理这些变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:09:14.167

Objective-C 是动态语言。所以在封装上不要那么严格。这个 ivar 无论如何都可以通过 KVC 来实现。所以*@property（读写）没问题*。

# .net - 带有客户端凭据的 SSL 上的 HttpWebRequest

> ID：947103
> 
> 赞同：5
> 
> 时间：2009-06-03T20:40:13.990
> 
> 标签：.net, ssl, httpwebrequest, credentials

我正在尝试使用 HttpWebRequest 获取需要用户名和密码的 https URI。如果我将 URI 放入浏览器，它会弹出一个对话框，询问凭据然后工作。使用 HttpWebRequest 给我一个 401 Unauthorized 错误。

NetworkCredentials 的文档说它不支持 SSL，但我找不到我应该使用的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T21:00:37.023

服务器是使用 HTTP 基本身份验证还是其他类型的身份验证？如果它使用 HTTP 基本，那么您可以将`Credentials`Web 请求上的属性设置为包含正确用户名和密码的凭据，并将该`PreAuthenticate`属性设置为 true。

这是一个示例（未经测试，因此仅用作指导）：

```
var uri = new Uri("https://somesite.com/something");
var request = WebRequest.Create(uri) as HttpWebRequest;
request.Credentials = new NetworkCredential("myUserName","myPassword");
request.PreAuthenticate = true;

var response = request.GetResponse(); 
```

注意：根据我的经验，.NET 框架中有一些奇怪的行为。你会认为它应该按照代码所说的去做，但它实际上是这样做的：

*   向没有凭据的服务器发送请求
*   服务器响应 401
*   使用您提供的凭据重新发送请求
*   服务器接受请求。

我不知道它为什么会这样做，因为它似乎坏了，所以也许这是我机器的一个怪癖，也许它不会发生在你身上。

如果您的应用程序对性能不敏感，并且您的请求不是大数据的 POSTS，您可能不会注意到，但要绕过它，我必须手动构建 HTTP 基本身份验证标头并`HttpWebRequest`通过操作手动设置它`Headers`集合。

# jquery - 将一串动画定义为变量

> ID：947105
> 
> 赞同：0
> 
> 时间：2009-06-03T20:40:20.620
> 
> 标签：jquery, variables

是否可以将一串动画定义为变量？

例如（这是我的想法，但不起作用？）：

```
var speed = 500;
var dothis = $("#div").slideUp('speed');
$("#div").slideDown('speed');
$("#div").animate({ height: "0px" }, 'speed');
$("button").click(function () {
    $(this).dothis();
}); 
```

我不完全确定如何设置它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:43:32.563

看起来您正在尝试稍后执行一系列操作......在这种情况下，您可以将所有命令封装在一个函数中：

```
var dothis = function() {
    $("#div").slideUp('speed');
    $("#div").slideDown('speed');
    $("#div").animate({height: "0px"}, 'speed');
    $("button").click(function () { 
      $(this).dothis();
    });
} 
```

然后稍后您可以通过调用该函数一次执行所有命令：

```
dothis(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:55:07.533

您还可以通过给函数一个参数来扩展 Daniel 的函数以使用您传递给它的任何元素。例如，将元素或选择器传递给它：

```
var dothis = function(el) {
    $(el).slideUp('speed');
    [...] 
```

此外，将每个效果放在自己的行上或像 $(el).slideUp().slideDown().fade() 等链接它们之间并没有区别。

如果将它们放在不同的行上，它们将几乎同时执行，而将它们链接起来会使它们按顺序执行。

# sql - 在经典 ASP 中，打开和关闭多个连接是否会对性能产生重大影响？

> ID：947106
> 
> 赞同：2
> 
> 时间：2009-06-03T20:40:22.493
> 
> 标签：sql, asp-classic, ado, sqlconnection

我有一个类似于下面的代码片段，我想将其重构为两个不同的函数，每个函数都有自己的连接（为了更好的维护）：

```
Dim Conn, Sql, RS

Set Conn = Server.CreateObject("ADODB.Connection")
    Conn.Open ConnString

Sql = SELECT * FROM CLIENTS

Set RS = Conn.Execute(sql)
//'Do something with Clients

Set RS = Nothing

Sql = SELECT * FROM DEALERS

Set RS = Conn.Execute(sql)
//'Do something with Dealers

Set RS = Nothing

Conn.Close
Set Conn = Nothing 
```

是否有两个函数（例如 GetClients 和 GetDealers）分别打开和关闭自己的连接会对性能造成重大影响，相反只打开和关闭单个连接，如上图所示？如果是这样，您将如何重构代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T20:45:50.470

如果我没记错的话，连接是池化的，因此打开和关闭每个函数的连接几乎不需要任何成本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T21:58:34.223

1.  不要使用 select * 但指定您需要的列。
2.  [使用 getrows](http://forums.aspfree.com/code-bank-54/getting-away-from-recordsets-use-getrows-230953.html)。
3.  指定您希望从数据库中获得的内容（使用连接和 where 子句）。

当您完成所有这些操作时，您的代码将是最佳的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T20:47:32.947

在这种情况下，您不应该有任何性能问题，但是如果数据源相同，则使用单个连接是一种很好的做法。

更好的方法是将单个打开的连接对象传递给每个 GetClients 和 GetDealers 函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T20:53:22.997

连接是自动池化的，所以成本非常小。

然而，它不是零。每次从池中拉出连接并重新打开它时，都会向 SQL Server 发送 sp_reset_connection 命令。这是非常便宜的，所以我不会担心。

旁注：单个 ADODB.Connection 可能代表多个数据库连接。如果您尝试使用同一个记录集打开第二个记录集，同时仍在读取第一个记录集，则它有可能在后台创建一个新记录集。同样，这不是一个真正的问题，只是您应该知道的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T21:26:31.667

连接池可用于经典 ASP。我将重构该代码以使用接受连接字符串的方法，并在该方法中尽快打开和关闭连接。

至少与连接使用一样令人担忧的是，您没有使用断开连接的记录集（ADO.NET 默认实现该记录集）。断开连接的记录集允许您在完成查询后立即关闭连接并将其返回到池中，而不必等到您遍历记录集。

下面是在 JScript 中如何做到这一点；移植到 VBScript 应该很简单：

```
var sql = "select * from MyTable";
var cn = new ActiveXObject("ADODB.Connection");
var rs = new ActiveXObject("ADODB.Recordset");
var nothing = rs.ActiveConnection;
cn.Open(connectString);
rs.CursorLocation = 3; //adUseClient
rs.Open(sql, cn, 3, 1);
rs.ActiveConnection = nothing;
cn.Close();
//now do something with disconnected rs 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-05T13:26:37.000

连接应该被池化

# wpf - WPF：在绑定时指定 ValueConverter 的另一种方法

> ID：947109
> 
> 赞同：2
> 
> 时间：2009-06-03T20:41:33.723
> 
> 标签：wpf, binding, valueconverter

我遇到的为绑定指定值转换器的最常见方法是：
1\. 将值转换器的实例创建为具有键的资源。
2\. 使用 StaticResource 标记扩展引用实例：

```
<TextBlock Text="{Binding Converter={StaticResource myFormatter}" /> 
```

**Q：如下**使用静态实例有什么问题吗：****

 **```
<TextBlock Text="{Binding Path=Description, Converter={x:Static local:MyFormatter.Instance}}"/>

// where Instance is declared as:
public readonly static MyFormatter Instance = new MyFormatter(); 
```

在我的情况下，值转换器是不可变的。

**编辑：**另一种方法是[将转换器转换为扩展](http://www.codeproject.com/KB/WPF/MarkupExtensionsConverter.aspx) ，以便您使用标记扩展格式指定转换器：

```
<TextBlock Text="{Binding Converter={local:MyFormatter}}"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T20:53:43.293

从技术上讲它会很好，但在实践中我不喜欢它：

1.  如果您将转换器声明为资源，那么您有一个单一的参考点。如果您更改转换器的命名空间或类名，那么您只有一个地方可以更新。

2.  如果将其声明为静态，则需要`clr-namespace`在每个使用转换器的 xaml 文件的顶部引入。如果您将其声明为资源，则不会。

3.  `{Binding Converter={StaticResource myFormatter}`比静态的更短，更容易阅读。从长远来看，这将比您想象的更能帮助您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:50:51.987

只要格式化程序真的没有状态，这应该没问题。但它并不等同。在第一种情况下，每个基于 XAML 的控件实例都有一个类的实例。在第二种情况下，只会创建一个实例。

# java - Matcher.appendReplacement 与文字文本

> ID：947116
> 
> 赞同：16
> 
> 时间：2009-06-03T20:42:10.447
> 
> 标签：java, regex

我正在使用[Matcher.appendReplacement()](http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Matcher.html#appendReplacement(java.lang.StringBuffer,%20java.lang.String))并且它工作得很好，直到我的替换字符串中有一个 $2 ：

> 请注意，替换字符串中的反斜杠 (\) 和美元符号 ($) 可能会导致结果与将其视为文字替换字符串时的结果不同。如上所述，美元符号可以被视为对捕获的子序列的引用，并且反斜杠用于转义替换字符串中的文字字符。

是否有一种方便的方法可以用反斜杠转义所有反斜杠 \ 和美元符号 $？还是我必须自己写一个？听起来并不难，如果他们给你一个就好了>:(

**编辑：**因为他们给你一个，我需要`replace(">:(", ":-)");`

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-06-03T20:48:38.687

在替换字符串上使用[Matcher.quoteReplacement 。](http://java.sun.com/javase/6/docs/api/java/util/regex/Matcher.html#quoteReplacement(java.lang.String))

不幸的是，在这种情况下，“易用性”与强类型相冲突。[解释：Java 静态类型的对象`java.lang.String`是任何不可变的 s 序列`char`。它不会告诉你原始数据的格式。在这种情况下，我们有可能对用户有意义的文本，用迷你语言编码的文本用于替换，用迷你语言编码的文本用于模式。Java 类型系统无法区分这些（尽管您可以使用基于注释的类型检查器做一些有趣的事情，通常是为了避免 XSS 或 SQL/命令注入漏洞）。对于模式迷你语言，您可以转换为一种形式，`Pattern.compile`尽管这是一种特定用途，并且大多数 API 方法都会忽略它（为了便于使用）。等价的`ReplacementText.compile`可以写。此外，您可以忽略迷你语言并将库作为“DSL”。但这一切都无助于随意使用。]

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-04T02:54:16.920

这是另一种选择：

```
matcher.appendReplacement(stringbuffer, "");
stringbuffer.append(replacement); 
```

`appendReplacement()`处理在匹配之间复制文本的工作，然后`StringBuffer#append()`添加您的替换文本*而不*掺假。如果您正在动态生成替换文本，这将特别方便，例如在 Elliott Hughes 的[Rewriter](http://elliotth.blogspot.com/2004/07/java-implementation-of-rubys-gsub.html)中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-03T20:52:17.883

我让它与以下内容一起工作，但我更喜欢 Tom Hawtin 的解决方案:-)

```
private static Pattern escapePattern = Pattern.compile("\\$|\\\\");
replacement = escapePattern.matcher(replacement).replaceAll("\\\\$0");
matcher.appendReplacement(stringbuffer, replacement); 
```

汤姆的解决方案：

```
matcher.appendReplacement(stringbuffer, Matcher.quoteReplacement(replacement)); 
```

# .net - PHP（或其他 linux 友好）等效于 .Net System.Xml.Linq

> ID：947120
> 
> 赞同：0
> 
> 时间：2009-06-03T20:43:29.663
> 
> 标签：.net, php, xml, linq

我最近一直在使用 .net 中的 xml.linq 类。但可能需要为即将到来的项目使用 linux 友好的语言。

我最喜欢的东西是

1.  Xdocument，能够从文件加载或从字符串解析
2.  XElement，快速为页面特定数据创建自定义结构
3.  遍历孩子、父母、兄弟姐妹等
4.  Xml.Linq 通常通过 `Variable.Element("elementName").value() for Variable.Descandants("elementName").value()` 更不用说添加后代的属性和所有其他内置的好东西来获取和设置值。

**所以我的问题是。是否有另一种语言为 xml 内置了这些类型的功能？** 我想避免手动解析并具有动态生成的 xml 的灵活性。

奖励问题：其他语言是否具有类似于 Linq to Xml 的功能，用于查询 xDocument/xelement 等价物。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T20:50:03.567

**Python中的LINQ示例**

[http://themechanicalbride.blogspot.com/2007/03/linq-to-python.html](http://themechanicalbride.blogspot.com/2007/03/linq-to-python.html)

但是这个博客阐明了为什么不需要这样做：

**PHP 中的 LINQ**

[http://phplinq.codeplex.com/](http://phplinq.codeplex.com/)

**有关 LINQ 和类似事物的有趣观点**

[http://mail.python.org/pipermail/python-3000/2006-November/004575.html](http://mail.python.org/pipermail/python-3000/2006-November/004575.html)

听起来不错。但在 FOSS 场景中，似乎对这种事情有点抗拒（我可能是错的）。

Python中有大量的**XML**例程，例如 XPath、XSLT 等。

[如何在 Python 中使用 Xpath？](https://stackoverflow.com/questions/8692/how-to-use-xpath-in-python)

使用这些标准并远离 LINQ 可能是值得的，因为我看不到稳定的替代方案……**但是有些东西是功能性的，但理念不同**

# ruby-on-rails - 验证嵌套集中的节点移动

> ID：947129
> 
> 赞同：2
> 
> 时间：2009-06-03T20:45:19.957
> 
> 标签：ruby-on-rails, validation, plugins, nested-sets

我正在创建一个 Category 模型并使用[`awesome_nested_set`](http://github.com/collectiveidea/awesome_nested_set/tree/master)插件（替代`acts_as_nested_set`）来处理层次结构。使用`awesome_nested_set`，创建对象，然后保存，然后放置在集合中。同样`lft`，`rgt`和`parent_id`are`attr_protected`所以它们不能被直接写入。

将节点放入我希望能够捕获的集合中时，我遇到了两种情况，以便通知用户（可能还有更多我还没有想到的）：

1.  尝试将节点作为自己的子节点放置 ( `self.id == self.parent_id`)
2.  试图将一个节点移动到它自己的后代之下 ( `self.descendants.include? self.parent_id == true`)

在这两种情况下，移动都会失败，但`awesome_nested_set`只会引发`ActiveRecord::ActiveRecordError`异常，并且消息的描述性不如我希望能够给用户的那样。

`awesome_nested_set`有许多节点移动方法，它们都调用`move_to(target, position)`（其中`position`一个是`:root`、或`:child`，并且是所有s 的相关节点，但）。该方法会触发回调，但没有提供一种我可以看到的在移动发生之前验证移动的方法。为了验证移动，我需要访问回调未收到的目标和位置。`:left``:right``target``position``:root``before_move`

有谁知道验证移动的`awesome_nested_set`方法（通过一种方法将目标和位置传递给`before_move`另一种方法的回调），或者另一个可以让我验证的嵌套集插件？我不想分叉或编写自己的插件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-29T19:00:50.863

这是我想出的解决方案：

```
class Category < ActiveRecord::Base
  acts_as_nested_set :dependent => :destroy

  #=== Nested set methods ===

  def save_with_place_in_set(parent_id = nil)
    Category.transaction do
      return false if !save_without_place_in_set
      raise ActiveRecord::Rollback if !validate_move parent_id

      place_in_nested_set parent_id
      return true
    end

    return false
  end

  alias_method_chain :save, :place_in_set

  def validate_move(parent_id)
    raise ActiveRecord::RecordNotSaved, "record must be saved before moved into the nested set" if new_record?
    return true if parent_id.nil?

    parent_id = parent_id.to_i

    if self.id == parent_id
      @error = :cannot_be_child_of_self
    elsif !Category.all.map(&:id).include?(parent_id)
      @error = :given_parent_is_invalid
    elsif descendants.map(&:id).include? parent_id
      @error = :cannot_be_child_of_descendant
    end

    errors.add(:parent_id, @error) if @error
    return @error.nil?
  end

  def place_in_nested_set(parent_id)
    if parent_id.nil? || parent_id.blank?
      move_to_root
    else
      move_to_child_of parent_id
    end
    return true
  end
end 
```

现在，在控制器中，我只需要说父节点的ID`@category.save(parent_id)`在哪里，验证、节点放置和保存都在模型中处理。`parent_id``nil`

# wcf - WCF（参数加密和 .NET 1.1 客户端）

> ID：947130
> 
> 赞同：0
> 
> 时间：2009-06-03T20:45:25.307
> 
> 标签：wcf

我从 WCF 世界开始，想问问你对某事的看法。我需要实现一个服务来公开一个接收几个参数的方法。我希望从客户端中的表单提交到服务的参数在 SOAP 消息中加密发送。

该服务需要从 .NET 3.5 客户端和 1.1 访问。无法通过 Windows 服务安装 WCF 服务，它需要部署为 IIS 应用程序。

我的问题： - WCF 服务如何确保输入参数的加密？客户端中的证书还是有其他选择？- 通过 1.1 应用程序甚至其他非 .NET 客户端使用 WCF 服务是否有任何问题？- 你认为这个场景可以用 WCF 实现吗？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T20:50:16.950

.NET 1.1 应用程序无法调用 WCF 服务，除非该服务通过 basicHttpBinding 公开。该绑定只允许使用 SSL 进行加密。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:53:57.863

Web 服务主机上的 SSL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T21:00:55.133

.NET 1.1 不支持自动加密或 WS-Security。不过，您可以手动加密/解密参数。

# asp.net - ASP.NET MVC 中是否有嵌套母版页？

> ID：947134
> 
> 赞同：14
> 
> 时间：2009-06-03T20:45:52.543
> 
> 标签：asp.net, asp.net-mvc, master-pages

我想知道 MVC 框架是否可以利用嵌套母版页？如果是这样，有人知道如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-03T20:55:33.290

我们经常使用嵌套母版页，以便将布局与标准包含和站点范围的标记分开，如下所示：

Site.Master：

```
<%@ Master Language="C#" AutoEventWireup="true" Inherits="System.Web.Mvc.ViewMasterPage<PageViewModel>" %>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="language" content="en">
    <title><asp:ContentPlaceHolder ID="Title" runat="server"><%= Model.Page.Title %></asp:ContentPlaceHolder></title>

    <% Html.RenderPartial("Head"); %>

    <meta name="robots" content="index, follow">
    <meta name="robots" content="noodp">
    <asp:ContentPlaceHolder ID="ExtraHead" runat="server"></asp:ContentPlaceHolder>
</head>
<body >

    <asp:ContentPlaceHolder ID="MainContent" runat="server"></asp:ContentPlaceHolder>

</body>
</html> 
```

然后让另一个主人使用 Site.Master，

标准大师：

```
<%@ Master Language="C#" AutoEventWireup="true" Inherits="System.Web.Mvc.ViewMasterPage<PageViewModel>" MasterPageFile="Site.Master" %>
<asp:Content ContentPlaceHolderID="ExtraHead" runat="server">
    <asp:ContentPlaceHolder ID="ExtraHead" runat="server"></asp:ContentPlaceHolder>
</asp:Content>

<asp:Content ContentPlaceHolderID="MainContent" runat="server">

            <asp:ContentPlaceHolder ID="MainContent" runat="server"></asp:ContentPlaceHolder>

</asp:Content> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-03T20:49:45.423

是的。我刚刚在以下位置看到了一篇关于此的博客文章：http: [//jeffreypalermo.com/blog/asp-net-mvc-and-the-templated-partial-view-death-to-ascx/](http://jeffreypalermo.com/blog/asp-net-mvc-and-the-templated-partial-view-death-to-ascx/)

很酷的东西。

# iphone - 滚动超大视图？（苹果手机）

> ID：947136
> 
> 赞同：0
> 
> 时间：2009-06-03T20:46:07.397
> 
> 标签：iphone, cocoa-touch

我想这非常简单，但不知何故我无法让它工作：

**我需要显示一个包含一组控件（大约 800 像素高）的视图——它可以由用户垂直滚动，因为该视图太大而无法同时显示在屏幕上。**

就是这样。

我认为这可能意味着这样的事情：

> UIView [正常大小] > UIScrollView > UIView [过大的]
> ...然后启用垂直滚动等。

但不知何故，我错过了一些东西，因为我得到的最好的结果是第一个出现在屏幕上的屏幕，没有向下滚动的能力。

~~~

[注意：我知道这通常可以使用表格视图来完成，然后垂直滚动会发生“免费”。但这是一系列特殊用途的控件（各种 UISlider、UISwitches、UILabels、UIButtons 等的奇怪分类），如果不进行大量自定义，它们将无法轻松融入标准表格视图。它们也是静态的（即，不需要以编程方式更改）——因此它们可以完全在 IB 中构建，这就是我更愿意在这种情况下这样做的方式。我只需要允许通过滚动访问全部内容。

我也知道它们可以分成多个屏幕，如果绝对必要，我会这样做；但它们是一个统一的逻辑组，因此在这种情况下这不是最佳选择。]

有什么建议么？那（和/或代码片段）将非常感激。

提前谢谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T20:49:48.807

我最初的想法是......你有没有试过：

```
 [scrollView setContentSize:CGSizeMake( scrollWidth, scrollHeight)]; 
```

我的第二个想法是 UIScrollView 可能没有收到滚动命令，因为您实际上是在 UIView 上滚动，而不是直接在 UIScrollView 上滚动...您可能需要进行一些子类化才能使其可操作，但恐怕这有点超越我，因为我还是一个初学者。:)

我的第三个想法是 - 为什么要将 UIView 添加到 UIScrollView 而不是直接将控件添加到 UIScrollView？

# algorithm - 使用算法制作动画 GIF 的最佳方法是什么？

> ID：947138
> 
> 赞同：5
> 
> 时间：2009-06-03T20:46:28.800
> 
> 标签：algorithm, gif, movie

我有一个用于骑士在各种尺寸（大尺寸，如 100x100）的棋盘上旅行的算法，我想为结果制作动画。每次马移动到一个新的方格时，（方格）画布中的相应像素都会改变颜色，直到最终整个画布都被着色。生成的电影将可用于在有关算法的网页上查看。

如果我想要广泛的浏览器支持，动画 GIF 似乎是最好的方法（尽管欢迎其他建议）。最好的工具或库是什么？我很乐意使用 Linux 或 Mac 计算机上免费提供的任何东西。

实际的算法太长了，无法在这里做一个有用的例子（如果你真的很好奇，请参阅[这篇论文）但这里是一个（无聊的）](http://www.math.oregonstate.edu/~math_reu/Papers/Cull2004-1.pdf)*国王*在 8x8 板上的旅行的伪代码：

```
movie = new Movie()
frame = new Frame()
frame.fillRectangle((1,1), 8, 8, BLUE)
for row in [1..8] {
    if (row.isOdd()) { colrange = [1..8] } else { colrange = [8..1] }
    for col in colrange {
        frame.colourPixel(row, col, RED)
        movie.addFrame(frame)
    }
}
movie.saveAsGIF("tour.gif") 
```

*额外的问题：*我们可以利用这部电影的特殊功能来减少文件大小吗？维基[百科的文章](http://en.wikipedia.org/wiki/Graphics_Interchange_Format#Animated_.gif)表明，如果我们只改变一些像素，我们也许可以做到这一点——事实上，我们每帧只改变一个！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T21:33:53.460

您可以使用[giflib](http://sourceforge.net/projects/giflib/)来完成此操作。文档在下载中。

例如，[此页面](http://gassend.net/spaceelevator/breaks/index.html)包含使用 giflib 创建的动画 gif 以及用于生成动画的程序的源代码。了解如何将 giflib 用于动画可能会有所帮助。

*编辑：*如果您不介意一些后处理，另一种选择是使用简单的格式（[例如 PPM](http://netpbm.sourceforge.net/doc/ppm.html)）简单地输出您的帧，然后[使用 ImageMagick 制作动画 gif](http://www.imagemagick.org/Usage/anim_basics/)。

至于您的额外信用问题：ImageMagick 甚至可以为您进行[帧比较](http://www.imagemagick.org/Usage/anim_basics/#compare)以减少输出的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:38:49.443

针对您的额外信用问题，您可以通过仅在新框架上绘制图像的更改部分并将其余部分设置为透明来自己进行此改进。

# oracle - 如何在 Oracle 中找到对象的所有者？

> ID：947140
> 
> 赞同：21
> 
> 时间：2009-06-03T20:47:00.873
> 
> 标签：oracle

我想查找表的外键，但可能有多个用户/模式与同名表。如何找到当前登录用户看到的那个？是否有赋予其所有者的功能？如果有公共同义词怎么办？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-03T20:51:37.167

您可以查询 ALL_OBJECTS 视图：

```
select owner
     , object_name
     , object_type
  from ALL_OBJECTS
 where object_name = 'FOO' 
```

要查找同义词：

```
select *
  from ALL_SYNONYMS
 where synonym_name = 'FOO' 
```

澄清一下，如果~~用户~~用户的 SQL 语句引用了没有模式限定的对象名称（例如，'FOO'），Oracle FIRST 会检查用户的模式以查找具有该名称的对象（包括该用户模式中的同义词）。如果 Oracle 无法解析来自用户模式的引用，则 Oracle 会检查公共同义词。

如果您正在专门寻找特定 table_name 的约束：

```
select c.*
  from all_constraints c 
 where c.table_name = 'FOO'
 union all
select cs.*
  from all_constraints cs
  join all_synonyms s 
    on (s.table_name = cs.table_name
     and s.table_owner = cs.owner 
     and s.synonym_name = 'FOO'
       ) 
```

高温高压

——附录：

如果您的用户被授予访问 DBA_ 视图的权限（例如，如果您的用户被授予 SELECT_CATALOG_ROLE），您可以在前面的 SQL 示例中用 ' `DBA_`' 代替 ' '。`ALL_`这些`ALL_x`视图仅显示您已被授予权限的对象。视图将`DBA_x`显示所有数据库对象，无论您是否拥有它们的权限。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-03-06T22:37:53.557

我在谷歌搜索如何在 Oracle 中查找表的所有者时发现这个问题是最重要的结果，所以我想我会提供一个特定于表的答案以方便其他人。

要在 Oracle DB 中查找特定表的所有者，请使用以下查询：

```
select owner from ALL_TABLES where TABLE_NAME ='<MY-TABLE-NAME>'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T21:21:03.393

有趣的问题 - 我认为没有任何 Oracle 函数可以执行此操作（几乎就像 Unix 中的“which”命令），但您可以通过以下方式获取名称的解析顺序：

```
select * from 
(
 select  object_name objname, object_type, 'my object' details, 1 resolveOrder 
  from user_objects
  where object_type not like 'SYNONYM'
 union all
 select synonym_name obj , 'my synonym', table_owner||'.'||table_name, 2 resolveOrder
  from user_synonyms
 union all
 select  synonym_name obj , 'public synonym', table_owner||'.'||table_name, 3 resolveOrder
  from all_synonyms where owner = 'PUBLIC'
)
where objname like upper('&objOfInterest') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T21:27:52.570

要在 Oracle 会话中查找当前用户的名称，请使用该`USER`函数。

请注意，约束的所有者、包含外键的表的所有者和被引用表的所有者可能都不同。听起来它是您感兴趣的表所有者，在这种情况下，这应该接近您想要的：

```
select Constraint_Name
from All_Constraints
where Table_Name = 'WHICHEVER_TABLE'
  and Constraint_Type = 'R' and Owner = User; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T21:37:39.727

像 ALL_TABLES 和 ALL_CONSTRAINTS 这样的 Oracle 视图有一个所有者列，您可以使用它来限制您的查询。这些表也有以 USER 而不是 ALL 开头的变体，它们仅列出当前用户可以访问的对象。

[这些](http://www.techonthenet.com/oracle/sys_tables/index.php)视图之一应该有助于解决您的问题。对于类似的问题，他们总是对我很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-27T20:53:57.263

就像@entpnerd 说的，但我建议你使用upper() 子句：

```
select * 
from ALL_TABLES 
where upper(TABLE_NAME) = upper('<table_name>') 
```

# installation - 从 WiX 中的路径中删除尾部斜杠

> ID：947141
> 
> 赞同：10
> 
> 时间：2009-06-03T20:47:02.260
> 
> 标签：installation, path, wix

我正在使用 WiX 为我无法控制的软件安装插件。要安装插件，我必须将目标文件夹放在注册表项中：

```
<Directory Id="TARGETDIR" Name="SourceDir">
  <Directory Id="LocalAppDataFolder">
    <Directory Id="APPROOTFOLDER" Name="Foobar Plugin" />
  </Directory>
</Directory>

...

<DirectoryRef Id="APPROOTFOLDER">
  <Component Id="register" Guid="240C21CC-D53B-45A7-94BD-6833CF1568BE">
    <RegistryKey Root="HKCU" Key="Software\ACME\Plugins\FooBar">
      <RegistryValue Name="InstallDir" Value="[APPROOTFOLDER]" Type="string"/>
    </RegistryKey>
  </RegistryKey>
</DirectoryRef> 
```

安装后，注册表项`HKCU\Software\ACME\Plugins\FooBar\InstallDir`将包含安装目标路径，但带有一个尾随“ `\`”。不幸的是，由于一些奇怪的原因，主机应用程序（提供插件架构）因此而崩溃。如果没有斜线，一切正常！

WiX中有没有办法摆脱斜杠？

我正在考虑的一个解决方案是`.`在路径的末尾添加一个“”，但是，这在我的场景中似乎不起作用:(..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-04-08T22:41:53.680

您不应该在自定义操作中使用脚本，但是如果您可以限制为只有几行并且像这个示例一样简单，那么您应该没问题...

```
<CustomAction Id="VBScriptCommand" Script="vbscript">
  <![CDATA[         
    value = Session.Property("INSTALLFOLDER")

    If Right(value, 1) = "\" Then
      value = Left(value, Len(value) - 1) 
    End If

    Session.Property("SOME_PROPERTY") = value      
  ]]>
</CustomAction>

<InstallExecuteSequence>
  <Custom Action="VBScriptCommand" After="CostFinalize">NOT REMOVE</Custom>
</InstallExecuteSequence> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T07:18:12.833

您在 Windows Installer 中真正拥有的唯一字符串操作是格式化数据类型的操作。有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/aa368609(VS.85).aspx)。

Windows Installer 在设计上提供了一个尾随目录分隔符，因此除了自定义操作之外，没有任何方法可以将其删除。我建议向您正在为其开发插件的源代码包的开发人员提出一个错误，如果您遇到此错误，那么其他开发人员可能也是如此。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-04T15:46:33.253

你总是可以做这样的事情：

```
<Directory Id="TARGETDIR" Name="SourceDir">
  <Directory Id="LocalAppDataFolder">
    <Directory Id="APPROOTFOLDER" Name="Foobar Plugin" />
  </Directory>
</Directory>

...

<DirectoryRef Id="APPROOTFOLDER">
  <Component Id="register" Guid="240C21CC-D53B-45A7-94BD-6833CF1568BE">
    <RegistryKey Root="HKCU" Key="Software\ACME\Plugins\FooBar">
      <RegistryValue Name="InstallDir" Value="[LocalAppDataFolder]\Foobar Plugin" Type="string"/>
    </RegistryKey>
  </RegistryKey>
</DirectoryRef> 
```

并且不允许用户更改最终文件夹

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T21:15:31.017

据我所知，Windows Installer 本身不提供任何字符串操作，因此这需要自定义操作。

# asp.net - 使用 GridView asp:ButtonField 为更新面板设置异步触发器

> ID：947155
> 
> 赞同：0
> 
> 时间：2009-06-03T20:49:21.680
> 
> 标签：asp.net, gridview, updatepanel

什么是正确的 sytnax 用于设置`AsyncPostBackTrigger`一个来自一个控件`UpdatePanel`的一个？`asp:ButtonField``GridView`

我需要为我的每个 asp:ButtonField 设置一个“AsyncPostBackTrigger”`GridView`

这是我的源代码

```
<asp:UpdatePanel ID="MyUpdatePanel" runat="server" ChildrenAsTriggers="true" UpdateMode="Conditional">
    <Triggers>
    </Triggers>
    <ContentTemplate>
        <asp:GridView ID="MyGridView" runat="server" AutoGenerateColumns="false">       
            <Columns>        
                <asp:ButtonField ButtonType="Link" CommandName="Button1" SelectText="Click Me!" />        
                <asp:ButtonField ButtonType="Link" CommandName="Button2" SelectText="No Click Me!" />    
            </Columns>
        </asp:GridView>
    </ContentTemplate> 
</asp:UpdatePanel> 
```

**更新**

我需要将`UpdateMode`and`ChildrenAsTriggers`属性设置为 true，因为其中包含`UpdatePanel`不刷新`UpdatePanel`控件的其他按钮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T20:57:40.757

Lance Harper 提到的一切都是真的，但您还需要删除以下属性：

```
UpdateMode="Conditional" 
```

拥有该属性将阻止客户端事件的自动连接。本质上，您是在告诉 ASP.Net，您将自己做这件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:22:23.703

您可以使用模板字段而不是命令字段，并在单击命令按钮时强制更新（UpdatePanel.Update()）面板吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T20:53:21.467

ChildrenAsTriggers 属性设置为 true 将导致在更新面板中导致回发的任何控件使其刷新。如果您希望使用更新面板之外的控件来触发该更新面板的刷新，则只需要使用 triggers 元素。在这种情况下，您甚至不需要 triggers 元素。

# sql - 以 XML 作为数据类型的表的 T-SQL 查询的适当输出文件是什么

> ID：947160
> 
> 赞同：0
> 
> 时间：2009-06-03T20:49:50.413
> 
> 标签：sql, sql-server, xml, tsql

我创建了一个调用 T-SQL 文件并将其输出到文本文件的批处理脚本。T-SQL 文件包含一个表的 select 语句，用于获取以 XML 为数据类型的列的信息。然后，该文件将与内容作为电子邮件正文或附件一起发送。但是，当我打开文本文件时，我会看到一长串类似于下面的信息：

```
<`EVENT_INSTANCE><EventType>CREATE_INDEX</EventType <PostTime>2009-05-29T12:54:28.463... 
```

我期望看到的内容如下所示：

```
<EVENT_INSTANCE>
  <EventType>CREATE_INDEX</EventType>
  <PostTime>2009-05-29T12:54:28.463</PostTime>
  <SPID>54</SPID>
  <ServerName>SERVER\INSTANCE</ServerName>
  <LoginName>Domain\username</LoginName>
  <UserName>dbo</UserName>
  <DatabaseName>AdventureWorks</DatabaseName>
  <SchemaName>dbo</SchemaName>
  <ObjectName>ni_ChangeAttempt_DBUser</ObjectName>
  <ObjectType>INDEX</ObjectType>
  <TargetObjectName>ChangeAttempt</TargetObjectName>
  <TargetObjectType>TABLE</TargetObjectType>
  <TSQLCommand>
    <SetOptions ANSI_NULLS="ON" ANSI_NULL_DEFAULT="ON" ANSI_PADDING="ON" QUOTED_IDENTIFIER="ON" ENCRYPTED="FALSE" />
    <CommandText>CREATE NONCLUSTERED INDEX ni_ChangeAttempt_DBUser ON
dbo.ChangeAttempt(DBUser)
</CommandText>
  </TSQLCommand>
</EVENT_INSTANCE> 
```

如果上述情况不可行，我希望看到查询的输出如下所示：

```
Event             Post Time                   Server Name
-----             ---------                   -----------

CREATE INDEX      2009-05-29T12:54:28.463     Server\Instance 
```

我的问题是：将查询结果发送到哪个合适的输出文件，以便我可以对结果有更有意义和更有条理的视图？

添加：

请参阅下面的批处理脚本的内容：

```
osql -E -S SERVER\INSTANCE -d <database_name> -iD:\scripts\qryddl.sql -oD:\scripts\qryddl01.txt -w2000 -n -h

bmail -s <ip address> -t <email> -f <email> -h -a " Database Object Changes from <ServerName>" -m D:\scripts\qrydll.txt 
```

补充2：

qrydll.sql 仅包含以下内容：

```
use <database_name>
GO
SELECT EventData FROM dbo.ChangeAttempt 
```

表 dbo.ChangeAttempt 具有以下结构：

```
 Column Name     Data Type
 -----------     ---------
 EvenData       xml
 AttemptDate     datetime
 DBUser       char(50) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T20:55:12.463

你所缺少的只是空格，而空格与真正的 xml 无关。无论哪种读法，都会以同样的方式对待它。

# ruby - Merb 身份验证问题，_message 变量

> ID：947165
> 
> 赞同：0
> 
> 时间：2009-06-03T20:50:40.927
> 
> 标签：ruby, merb, merb-auth

我使用merb，并在身份验证后在url中得到奇怪的变量。我发现该变量包含 base64 编码数据，但无法理解为什么它会出现在那里，即使一切正常。只是好奇

它看起来像这样： http: [//foo.bar/](http://foo.bar/?_message=....data) ?_message=....data .... 这个变量有什么用，它有什么作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T21:25:40.640

_message 是 Merb 发送“flash”消息的方式。我相信它正在被编码以使其更难欺骗（即在您的网页上插入任意文本），但要保持 URL 中的状态

# ruby-on-rails - 安全地添加对我的 rails 网站的管理访问权限的最佳方式是什么？

> ID：947169
> 
> 赞同：4
> 
> 时间：2009-06-03T20:51:26.497
> 
> 标签：ruby-on-rails, security, authentication, administration

我认为答案是管理员登录，然后检查用户是否有管理员标志，但我也想到了一些其他相关的问题。

在与非管理员相同的用户表中拥有管理员标志（attr_protected）会更​​好吗？还是我应该有一个管理员用户表？

我应该为管理员用户创建一个单独的 Rails 应用程序吗？这可能有点矫枉过正，因为他们都必须访问同一个数据库（更不用说设置起来可能会很痛苦）。

还有其他建议吗？现在我只需要保护一两个页面，所以我什至将 HTTP 基本或摘要身份验证作为一种临时措施（受保护的内容实际上并不那么私密/重要）。但是...我不知道如何为特定操作实现 HTTP auth，我只看到了如何实现它以防止目录访问。

任何方向和讨论都会很棒。我相信其他 Stack Overflow 用户将从这次讨论中受益。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T21:05:41.927

瑞安·贝茨（Ryan Bates）有关于这个主题的三部分系列 Railscasts，应该会给你一些思考的食物：

*   第 1 部分：[管理的去向](http://railscasts.com/episodes/19-where-administration-goes)
*   第 2 部分：[限制访问](http://railscasts.com/episodes/20-restricting-access)
*   第 3 部分：[超级简单的身份验证](http://railscasts.com/episodes/21-super-simple-authentication)

还有三种关于不同身份验证技术的 Railscast：

*   [RESTful 身份验证](http://railscasts.com/episodes/67-restful-authentication)
*   [HTTP 基本身份验证](http://railscasts.com/episodes/82-http-basic-authentication)
*   [授权逻辑](http://railscasts.com/episodes/160-authlogic)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T21:05:21.350

为此，我正在使用[restful_authentication 插件。](http://github.com/technoweenie/restful-authentication/tree/master)限制对任何控制器或任何方法的访问非常简单。在控制器中的示例中添加此功能：

```
private
def authorized?
  user.admin?
end 
```

或者

```
private
def authorized?
  user.admin? if update? || create?
end 
```

我定义了管理员？我的用户模型中的方法。我也创建了更新？并创造？检查调用了哪个操作的方法。在restful_authentication 中授权？访问控制器时始终运行方法。

我会将所有内容放在一个应用程序和一张表中（不要创建用户和管理表）。您可以通过仅允许为现有管理员用户设置此值来保护用户控制器中的管理员标志。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T21:07:25.403

我认为这取决于管理的类型。

如果您的管理员对该站点的视图与普通用户的视图相同，但具有额外的权限，我会使用管理员标志。（或者，随着您的需求的扩大，一个完整的角色表。）在这种情况下，每个人都看到相同的内容，但管理员可以访问普通用户无法访问的各种操作（删除？编辑？禁止？等）。

如果您的管理员需要的视图与普通站点完全不同，我会推荐一个完全独立的 Rails 应用程序来访问相同的数据库。例如，如果您的“管理员”确实是要接听电话或处理帐单问题的服务台员工，那么他们可能对数据库有完全不同的视图（可能还有编辑数据的方法），而这些视图在常规应用。

拥有多个站点的缺点是模型（验证、关联等）可能不同步。拥有单个站点的缺点是，您最终可能会在站点以前易于理解的部分中插入各种丑陋的“if-admin”代码。哪个问题更容易处理取决于您的要求。

# ruby-on-rails - 文章表模式

> ID：947171
> 
> 赞同：4
> 
> 时间：2009-06-03T20:51:38.087
> 
> 标签：ruby-on-rails, database-design, schema

我需要为“文章”创建典型的 crud 应用程序，在这方面是否有标准或最佳实践？我知道每个应用程序和情况各不相同，但我的意思是一般。

其次，我对如何处理与特定文章相关联的多个图像有点困惑，我认为只是 img 标签散布在文章的正文中，而不是拥有一个图像表并引用图像和文章等等。只是寻找一些关于如何处理这种事情的提示和建议，因为我相信这里的大多数人都做过多次。

我的文章定义如下：

```
CREATE TABLE `articles` (
  `id` int(11) NOT NULL auto_increment,
  `issue_id` int(11) default NULL,
  `status` text,
  `updated_at` date default NULL,
  `body` text,
  `title` varchar(255) default NULL,
  `author` varchar(255) default NULL,
  `created_at` date default NULL,
  PRIMARY KEY  (`id`)
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-12T14:05:28.470

[Dublin Core](http://en.wikipedia.org/wiki/Dublin_Core)是文档和媒体的非正式标准属性集。属性是：

*   标题
*   创作者
*   主题
*   描述
*   出版商
*   贡献者
*   日期
*   类型
*   格式
*   标识符
*   资源
*   语
*   关系
*   覆盖范围
*   权利

运行文档/媒体管理应用程序多年的人在此列表后面有很多想法。我认为这是一个很好的资源，可以深入了解您的用户可能会发现您可能会错过的有价值的属性（例如创建者 vs 发布者 vs 贡献者 vs 来源）。我不会在不考虑它们是否相关的情况下将所有这些都转储到您的应用程序中。

我认为您确实想要一个将图像与文章相关联的表格。否则，如果您需要知道一篇文章使用了哪些图片，例如删除一篇文章及其图片，找到相关图片的唯一方法是解析文章正文本身。这使得使用字符串处理函数或强制在您的应用程序中进行处理的 SQL 变得笨拙，如果您需要一次处理一组文章，这两者都可能是性能问题。

但是，您仍然可以在文章正文中使用图像标签来布置图像，避免使用任何更复杂的自定义标记系统。只需编写您的模型，以便在您创建/编辑文章时解析图像标签并更新连接表。一点 nokogiri 和 attachment_fu （或他们的替代品）应该可以快速完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T21:02:41.263

**文章表：**

```
CREATE TABLE `articles` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `keyname` varchar(96) NOT NULL,
  `title` varchar(96) NOT NULL,
  `content` text NOT NULL,
  `tags` varchar(128) NOT NULL,
  `author` varchar(128) NOT NULL,
  `date_created` datetime NOT NULL,
  `date_updated` datetime default NULL,
  PRIMARY KEY (`id`)
) 
```

**文章图片：**

```
CREATE TABLE `articles_images` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `article_id` int(10) unsigned NOT NULL,
  `url_thumb` varchar(512) NOT NULL,
  `url_big` varchar(512) NOT NULL,
  `date_created` datetime NOT NULL,
  PRIMARY KEY (`id`),
  KEY `article_id` (`article_id`)
) 
```

url_thumb - 图片缩略图
url_big - 大图

您可以查看 Wordpress 的数据库模式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T17:18:41.270

如果您只想显示图像并使用 ftp 上传它们，那么图像标签就可以了

如果您想要一个网络界面来上传它们，将路径保存在数据库中非常方便

您不必将图像附加到文章本身，您可以有一个保存图像路径的表，然后使用连接模型或简单地通过图像标签指向图像

这使您可以使用像回形针（插件）这样方便的东西来处理上传和存储

# c# - 写入在 Excel 中打开的文件

> ID：947172
> 
> 赞同：2
> 
> 时间：2009-06-03T20:52:13.187
> 
> 标签：c#, file-io

假设我有一个程序正在运行，它会定期将信息添加到 .CSV 文件中。有没有办法在 Excel 中打开文件时写入文件？显然，在 Excel 中重新打开文件之前不会注意到这些更改，但就目前而言，我正在捕获 IOException 并且如果当前文件已经打开，则只是启动一个新的 .csv 文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T20:57:10.697

Excel似乎以独占模式打开文件，所以我能想到的唯一方法是将您的更改写入临时文件，然后用于`FileSystemWatcher`查看文件何时关闭并覆盖文件。

这不是一个好主意，因为您可能会丢失数据。excel 锁定文件的全部原因是您不会意外覆盖在 excel 中所做的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:55:57.017

听起来文件被锁定了。如果它在另一个进程中打开，我怀疑你是否能够写入该文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:57:46.560

作为一名前（和现在的）VB 程序员，我可以告诉你 Jared 是正确的——没有办法直接做到这一点。您可以先尝试复制文件，进行编辑，然后尝试将文件保存回其原始位置，直到锁定的文件变为可用。即使在锁定状态下，您也应该能够复制该文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T21:26:08.610

使用 Excel 的对象模型并自动将数据添加到打开的电子表格中怎么样？您可能需要以某种方式提示用户让他们知道发生了什么。

# wpf - 更改 GridView 的 ColumnHeader 的字体大小

> ID：947176
> 
> 赞同：4
> 
> 时间：2009-06-03T20:52:57.303
> 
> 标签：wpf, gridview, themes, styles, templating

有没有一种简单的方法来更改标题字体大小而不覆盖完全复制的 ColumnHeaderTemplate？

*注意：不确定是否相关，但我使用提供 ColumnHeaderTemplate 的应用程序主题 (PresentationFramework.Royale)。*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T21:01:29.750

如果您还没有将样式应用于列标题，则可以使用它。即使你是，通过在样式上设置 BasedOn 属性，你可以保持一切，除了你想改变的。

```
<ListView>
    <ListView.View>
        <GridView>
            <GridView.ColumnHeaderContainerStyle>
                <Style>
                    <Setter Property="TextElement.FontSize"
                            Value="32" />
                </Style>
            </GridView.ColumnHeaderContainerStyle>
            <GridViewColumn Header="Stuff"/>
            <GridViewColumn Header="More Stuff" />
        </GridView>
    </ListView.View>
</ListView> 
```

**编辑：**
我以前没有使用过内置主题，所以我对此进行了测试。PresentationFramework.Royale 主题实际上并未将模板应用于列标题。它正在应用一个 Style，它使用一个 setter 来应用[ControlTemplate，就像推荐](http://msdn.microsoft.com/en-us/library/ms745683.aspx)的一样。

因此，为了在列标题上保留 Royale 主题，我们确实需要使用我们创建的 Style 的 BasedOn 属性。这是更新后的样式定义，既允许您修改自己喜欢的内容，又保留皇家主题：

```
<Style TargetType="{x:Type GridViewColumnHeader}" BasedOn="{StaticResource {x:Type GridViewColumnHeader}}"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T21:02:40.827

GridViewColumnHeader 是一个内容控件，因此如果您将其内容设置为 TextBlock，其中您想要的文本大小合适，生活应该会很好。

# java - 如何探索从哪些 JAR 加载哪些类？

> ID：947182
> 
> 赞同：31
> 
> 时间：2009-06-03T20:53:52.217
> 
> 标签：java, profiling, classloader, jar

有没有办法确定在运行时从哪些 JAR 加载哪些类？

我敢肯定，我们之前都经历过 JAR 地狱。我在项目中遇到过很多故障排除`ClassNotFoundException`问题`NoClassDefFoundError`。我想避免在 JAR 中找到一个类的所有实例，并在代码上使用消除过程导致 CNFE 找到罪魁祸首。

任何分析或管理工具会为您提供此类信息吗？

这个问题非常烦人，纯粹是因为我们应该在类被加载时得到这些信息。必须有办法找到它，或者记录下来并找到它，但我不知道会这样做，是吗？

我知道 OSGi 和版本化的包/模块旨在使这成为一个非问题......但它似乎不会很快消失。

注意：我发现这个[问题](https://stackoverflow.com/questions/139534/classloader-issues-how-to-determine-which-library-versions-jar-files-are-load)是我与从版本化 jar 加载的类相关的问题的一个子集。

有点相关，这篇文章解释了在 JAR（在当前目录下）或 M2_REPO 中搜索类的策略： [JarScan，扫描所有子文件夹中的所有 JAR 文件以查找特定类](https://stackoverflow.com/questions/759923/jarscan-scan-all-jar-files-in-all-subfolders-for-specific-class)

也有点相关，[JBoss Tattletale](http://docs.jboss.org/tattletale/developerguide/en/html_single/)

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-06-03T20:59:35.497

`-verbose:class`将开关传递给`java`命令将打印每个加载的类以及加载它的位置。

[Joops](http://code.google.com/p/joops/)也是一个很好的工具，可以提前找到缺失的课程。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-03T21:04:19.310

从代码中您可以调用：

```
myObject.getClass().getProtectionDomain().getCodeSource() 
```

（注意，`getProtectionDomain`可能会不幸返回`null`（糟糕的设计），因此“正确的代码”会检查这一点。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-25T21:49:02.770

上面 Jason Day 提到的 JVM 标志有一个 MBean。

如果您使用 JBoss，您可以使用 JMX 按需调整它，如果您将本机 JMX MBean 服务器添加到您的配置中。添加以下-D：

```
-Dcom.sun.management.jmxremote.port=3333
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management.jmxremote.ssl=false
-Djboss.platform.mbeanserver 
-Djavax.management.builder.initial=org.jboss.system.server.jmx.MBeanServerBuilderImpl
-DJBOSS_CLASSPATH="../lib/jboss-system-jmx.jar" 
```

然后您可以在 java.lang:Classloading MBean 下看到此设置，并可以即时将其打开/关闭。如果您只希望在执行某段代码时打开它，这将很有帮助。

还有一个 MBean，它允许您输入一个完全限定的类名并查看它在类层次结构中的加载位置。MBean 称为 LoaderRepository，您需要调用 displayClassInfo() 操作，传入 FQCN。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-10T20:49:59.057

在 WebSphere (WAS) 中，您可以使用称为“类加载器查看器”的功能

首先通过单击服务器 > 服务器类型 > WebSphere 应用程序服务器 > server_name > 类加载器查看器服务启用类加载器查看器，启用该服务并重新启动服务器。

然后您可以转到疑难解答 > 类加载器查看器并搜索您的类或包名称。

[https://www-01.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.doc/ae/ttrb_classload_viewer.html?lang=en](https://www-01.ibm.com/support/knowledgecenter/SSAW57_8.5.5/com.ibm.websphere.nd.doc/ae/ttrb_classload_viewer.html?lang=en)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-08T14:17:09.547

您可以轻松导出 JMX 操作以访问进程中任何已加载类的包信息，例如：

```
 public static final class Jmx {

    @JmxExport
    public static Reflections.PackageInfo getPackageInfo(@JmxExport("className") final String className) {
      return Reflections.getPackageInfo(className);
    }
  } 
```

这是一个简单的单元测试来导出和调用它：

```
 @Test
  public void testClassLocator() throws IOException, InstanceNotFoundException, MBeanException, ReflectionException {
    Registry.export(Jmx.class);
    Reflections.PackageInfo info = (Reflections.PackageInfo) Client.callOperation(
            "service:jmx:rmi:///jndi/rmi://:9999/jmxrmi",
            Jmx.class.getPackage().getName(),
            Jmx.class.getSimpleName(), "getPackageInfo", Registry.class.getName());
    System.out.println(info);
    Assert.assertNotNull(info);
  } 
```

这一切都基于使用 spf4j ( [http://www.spf4j.org](http://www.spf4j.org) )中的一些小型实用程序库

[你可以](https://github.com/zolyfarkas/spf4j/blob/master/spf4j-core/src/test/java/org/spf4j/jmx/RegistryTest.java#L263)看到这段代码[和](https://github.com/zolyfarkas/spf4j/blob/master/spf4j-core/src/main/java/org/spf4j/base/Runtime.java#L669)测试

# javascript - jQuery UI Sortable -- 如何取消拖动/排序项目的点击事件？

> ID：947195
> 
> 赞同：66
> 
> 时间：2009-06-03T20:56:12.710
> 
> 标签：javascript, jquery, jquery-ui

我有一个[jQuery UI 可排序](http://docs.jquery.com/UI/Sortable)列表。可排序的项目还附加了一个点击事件。有没有办法防止在我拖动项目后触发点击事件？

```
$().ready( function () { 
 $('#my_sortable').sortable({
   update: function() { console.log('update') },
   delay: 30
 });    

 $('#my_sortable li').click(function () {    
   console.log('click');
 });                        

});
```

```
#my_sortable li {
          border: 1px solid black;
          display: block;
          width: 100px;
          height: 100px;    
          background-color: gray;
        }
```

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script>

<ul id="my_sortable">                 
  <li id="item_1">A</li>
  <li id="item_2">B</li>
  <li id="item_3">C</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2010-06-04T21:26:59.213

我遇到了同样的问题，因为我的可排序项目包含三个或四个可点击项目（并且数量是可变的），动态绑定/取消绑定它们似乎并不是一个选项。但是，偶然我指定了

```
helper : 'clone' 
```

选项，它在界面方面与原始可排序的行为相同，但显然不会在拖动的项目上触发点击事件，从而解决了问题。它和其他任何东西一样都是一个黑客，但至少它是简短而容易的..

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-03T21:57:29.047

如果你的 li 引用了 click 事件，你可以在 sortable update 方法中解绑它，然后使用 Event/one 重新绑定它。可以在重新绑定之前停止事件传播，从而防止触发您的原始点击处理程序。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head> 

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script>

  <script type="text/javascript" charset="utf-8">
    var myClick = function () {
        console.log('click');
    };

    $().ready( function () { 

       $('#my_sortable').sortable({
         update: function(event, ui) { 
            ui.item.unbind("click");
            ui.item.one("click", function (event) { 
                console.log("one-time-click"); 
                event.stopImmediatePropagation();
                $(this).click(myClick);
            }); 
            console.log('update') },
         delay: 30
       });    

       $('#my_sortable li').click(myClick);                        

     });
  </script>

  <style type="text/css" media="screen">
    #my_sortable li {
      border: 1px solid black;
      display: block;
      width: 100px;
      height: 100px;    
      background-color: gray;
    }
  </style>

</head>
<body>

      <ul id="my_sortable">                 
        <li id="item_1">A</li>
        <li id="item_2">B</li>
        <li id="item_3">C</li>
      </ul>   

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-11-17T14:35:01.707

如果你出于某种原因不想使用这个`helper:'clone'`技巧，这对我有用。它取消了被拖动项目的点击事件。jQuery 将类添加`ui-sortable-helper`到拖动的元素。

```
$('.draggable').click(clickCancelonDrop);
function clickCancelonDrop(event) {
    var cls = $(this).attr('class');
    if (cls.match('ui-sortable-helper'))
         return event.stopImmediatePropagation() || false;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-20T13:39:04.280

```
$('.selector').draggable({
    stop: function(event, ui) {
        // event.toElement is the element that was responsible
        // for triggering this event. The handle, in case of a draggable.
        $( event.toElement ).one('click', function(e){ e.stopImmediatePropagation(); } );
    }
}); 
```

这是有效的，因为*“一个听众”在**“普通”听众***之前** 被解雇。因此，如果一个监听器停止传播，它将永远不会到达您之前设置的监听器。

 ** * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-13T07:55:55.160

mercilor 的回答对我有一些警告。click 事件实际上是在句柄元素上，而不是在排序的项目本身上。不幸的是，ui 对象没有在更新事件中为您提供对句柄的引用（对 jquery ui 的功能请求？）。所以我必须自己去拿把手。此外，我还必须调用 preventDefault 来停止单击操作。

```
update: function(ev, ui) {
    var handle = $(ui.item).find('h3');
    handle.unbind("click");
    handle.one("click", function (event) {
                            event.stopImmediatePropagation();
                            event.preventDefault();
                            $(this).click(clickHandler);
                        });
    // other update code ... 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-15T22:52:41.053

更简单，使用 var 来知道元素何时被排序......

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head> 

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script>

  <script type="text/javascript" charset="utf-8">
    $().ready( function () {    
       $('#my_sortable').sortable({
         start: function() {
            sorting = true;
         },
         update: function() {
            console.log('update');
            sorting = false;
         },
         delay: 30
       });    

       $('#my_sortable li').click(function () {
         if (typeof(sorting) == "undefined" || !sorting) {
            console.log('click');
         }
       });                        

     });
  </script>

  <style type="text/css" media="screen">
    #my_sortable li {
      border: 1px solid black;
      display: block;
      width: 100px;
      height: 100px;    
      background-color: gray;
    }
  </style>

</head>
<body>

      <ul id="my_sortable">                 
        <li id="item_1">A</li>
        <li id="item_2">B</li>
        <li id="item_3">C</li>
      </ul>   

</body>
</html> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-08T11:43:47.160

我们还可以在停止事件上使用标志，并在点击事件上检查该标志。

```
var isSortableCalled = false;

$('#my_sortable').sortable({
         stop: function(event, ui){
              isSortableCalled = true;
         },
         update: function() { console.log('update') },
         delay: 30
});

$('#my_sortable li').click(function () {    
       if(!isSortableCalled){
            console.log('click');
       }
       isSortableCalled = false;

}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-12-31T05:37:48.110

感谢[Elte Hupkus](https://stackoverflow.com/users/358873/elte-hupkes)；

```
helper: 'clone' 
```

我已经实现了相同的，下面显示了一个示例。

```
$(document).ready(function() {
$("#MenuListStyle").sortable({
 helper:'clone',
 revert:true
}).disableSelection();
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-06-03T20:03:04.827

一种解决方案是使用 live() 而不是普通绑定，但是 Elte Hupkes 解决方案非常棒！！！！

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-02-19T17:57:08.220

```
$('.menu_group tbody a').click(function(){
    link = $(this).attr('href');
    window.location.href = link;
}); 
```

这个解决方案似乎对我有用。现在我可以点击可排序元素内的可点击内容。

注：`".menu_group tbody"`是`.sortable();`

# javascript - 使用为域设置的会话 cookie 启动 Firefox

> ID：947196
> 
> 赞同：1
> 
> 时间：2009-06-03T20:56:28.607
> 
> 标签：javascript, firefox, cookies

我尝试了以下各种排列：

`firefox.exe "javascript:document.location='http://site.com';document.cookies='key=val';"`

但没有好的结果；不会为 site.com 域添加 cookie。使用这种方法是否有可能完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T00:26:24.753

做那样的事情是不会发生的。JavaScript 不会以同步方式发生，这是一件好事，否则我们会遇到安全问题。试试[油脂猴](https://addons.mozilla.org/en-US/firefox/addon/748)

# asp.net - 在 Response.Redirect 中使用 endResponse

> ID：947197
> 
> 赞同：6
> 
> 时间：2009-06-03T20:56:33.583
> 
> 标签：asp.net

在 ASP.NET 页面中执行 response.redirect 时，我收到错误：
**错误：无法获取**
传入的两个变量的值（一个值从查询字符串中检索，另一个从视图状态中检索）

我从未见过这个错误之前，所以我做了一些调查，发现建议为“endResponse”使用“False”值，

例如 Response.Redirect("mypage.aspx", False)

这有效。

我的问题是：在 response.redirect 中对“endResponse”值使用“False”有什么副作用？
即对服务器的缓存有影响吗？页面是否会在内存中驻留一段时间？它会影响查看同一页面的不同用户吗？等

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2011-08-02T06:58:25.973

从[this other question](https://stackoverflow.com/questions/2777105/response-redirect-causes-system-threading-threadabortexception)和[this blog post](http://blogs.msdn.com/b/tmarq/archive/2009/06/25/correct-use-of-system-web-httpresponse-redirect.aspx)，推荐的模式是-

```
Response.Redirect(url, false);
Context.ApplicationInstance.CompleteRequest(); 
```

这避免了昂贵的 ThreadAbortException/Response.End。之后会执行一些代码`CompleteRequest()`，但是 ASP.Net 会在方便的时候关闭请求。

编辑-我认为[这个答案](https://stackoverflow.com/a/12957854/57311)给出了最好的概述。请注意，如果您使用上述模式，重定向后的代码仍将被执行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T21:08:46.103

可能会回答您的问题的[MSDN 博客文章](http://blog.jongallant.com/2006/06/cons-of-responseredirecturl-false/)：

> 使用 [Response.Redirect(url, false)] 的缺点是页面将继续在服务器上处理并发送到客户端。如果您在 Page_Init （或类似）中进行重定向并调用 Response.Redirect(url, false) 页面只会在当前页面完成执行后重定向。这意味着您在该页面上执行的任何服务器端处理都将被执行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-04T12:51:37.950

Response.Redirect(..., true) 导致 ThreadAbortException。根据您的异常处理设置，您的日志可能会为每个重定向填充一条错误消息。

# javascript - 渐进增强，页面未完全加载时的行为

> ID：947198
> 
> 赞同：0
> 
> 时间：2009-06-03T20:56:38.123
> 
> 标签：javascript, jquery, html, progressive-enhancement

我正在使用完全在 jQuery 中实现的渐进增强来开发网站。

例如，我正在动态添加 onclick 事件处理程序以锚定标签以使用 SoundManager “内联”播放链接的 MP3 文件，并通过 $(document).ready(function()) 弹出 Youtube 播放器的 Youtube 链接。

但是，如果用户在页面加载时单击它们，他们仍然会获得非增强版本。

我考虑过隐藏相关的东西（通过显示：无，或类似的东西）并在加载时显示它，或者放置一个模式“加载”对话框，但听起来都像黑客。

有更好的想法吗？我觉得我在这里遗漏了一些完全明显的东西。

问候，

亚历克斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T21:09:44.307

这个我没测试过，你可以试试[`live`](http://docs.jquery.com/Events/live)。想法是您可以将单击处理程序放在 document.ready 之外，以便它们立即执行。由于`live`使用[事件委托](http://www.sitepoint.com/blogs/2008/07/23/javascript-event-delegation-is-easier-than-you-think/)来实现其功能，因此您实际上不需要等待 DOM 准备好，并且在页面加载时进行的任何单击仍应由事件处理程序捕获。

如果这不起作用，您可以尝试将 Javascript 脚本标记直接放在需要绑定的任何内容下方。它不漂亮，但它几乎可以消除这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T21:02:51.013

假设您使用了良好的判断力并且人们仅仅因为延迟太长而爱上了非增强版本，那么我会使用**CSS 来禁用控件**。CSS 几乎会立即加载。然后使用 Javascript 我将切换 CSS，以便重新启用控件。

但是，我的第一反应是，如果用户可以在页面加载时单击它，那么您的页面或连接太慢了。但是，如果这种情况很少发生——不到 1% 的时间——那么你可以不理会它，只要用户能够实现他的目标，那就是听他的音乐。我这样说是因为一旦用户意识到更好的体验等待半秒后，他通常会等待 Javascript 渲染然后点击。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T21:08:54.120

关于使用 CSS，我与 aleemb 持相反的立场。如果您使用 css 禁用控件，那么禁用 javascript 或使用辅助功能软件的任何人都将无法使用这些控件，除非完全禁用您的样式表。

您可以在结束 body 标记之前使用非常小的内联 javascript 通过 js 非常快速地隐藏元素。如果它是内联的并且不需要加载外部资源，它会非常快，通常比用户点击要快。

但是，我*确实*同意 aleemb 的观点，如果您的用户能够在加载 js 之前对页面进行心理处理并使其成为他们想要单击的控件，那么您的页面加载方式可能存在更深层次的问题。寻找减少加载时间的方法：压缩图像文件、压缩 html/css/js 文件、缩小 javascript、将图像组合成 sprite 等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T21:56:43.120

我建议遵循[Paolo Bergantino 的建议](https://stackoverflow.com/questions/947198/progressive-enhancement-behavior-when-pages-are-not-fully-loaded-yet/947271#947271)- 事件委托是完全避免该问题的方法。

我有一个类似的问题，事件委托无法完成这项工作 - 你可以[在这里阅读](http://mercurial.intuxication.org/hg/js-hacks-docs/raw-file/tip/domcontentloaded-en.html)。

# c# - C# P/Invoke：如何为结构化参数的字段实现双重间接

> ID：947202
> 
> 赞同：1
> 
> 时间：2009-06-03T20:57:20.960
> 
> 标签：c#, interop, pinvoke, indirection, multiple-indirection

我正在从 C# 调用本机 dll。对于有问题的特定函数，我需要的参数之一是一个包含双重间接字段（指向指针的指针）的结构。

例如，采用以下 C 原型和结构：

```
int someFunc(SomeStruct* result);

struct SomeStruct
{
     DWORD foo;
     AnotherStruct** ppResultStruct;
}

struct AnotherStruct
{
     DWORD bar;
} 
```

以下 C# 代码只为字段 AnotherStruct 提供了一个间接级别，这是不正确的：

```
[DllImport("my.dll")]
public static extern int someFunc(SomeClass result);

[StructLayout(LayoutKind.Sequential)
public class SomeClass
{
    int foo;
    AnotherClass resultClass;
}

[StructLayout(LayoutKind.Sequential)]
public class AnotherClass
{
    int bar;
} 
```

如何实现此处所需的双重间接？我知道在函数的双重间接参数的情况下如何做到这一点，但我对它嵌入在结构中的事实感到困惑。

也许我应该将 AnotherClass 字段声明为 IntPtr，然后使用不安全代码为其分配适当的值。这是一种有效的方法，还有其他/更好的选择吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T21:19:43.850

如果没有自定义 marashaler，您将无法构建既包含标准内联结构定义又包含双重间接的类。这种类型的编组需要一点魔法才能实现。

解决此问题的最佳方法是将双重间接视为实际的指针。然后用漂亮的属性来照顾邪恶

```
[StructLayout(LayoutKind.Sequential)
public class SomeClass
{
    int foo;
    IntPtr resultPtr;
    AnotherStruct resultStruct { 
      get { 
        var temp = (IntPtr)Marshal.PtrToStructure(resultPtr, typeof(IntPtr));
        return (AnotherStruct)Marshal.PtrToStructure(temp, typeof(AnotherStruct));
      }
    }

}

[StructLayout(LayoutKind.Sequential)]
public class AnotherStruct
{
    int bar;
} 
```

# c++ - PIC 寄存器 (%ebx) 有什么作用？

> ID：947211
> 
> 赞同：11
> 
> 时间：2009-06-03T20:58:27.697
> 
> 标签：c++, gcc, assembly, x86, cpu-registers

我用 C++ 编写了一个“危险”程序，它从一个堆栈帧来回跳转到另一个堆栈帧。目标是从调用堆栈的最低级别跳转到调用者，做某事，然后再次向下跳转，每次跳过中间的所有调用。

我通过手动更改堆栈基地址（设置`%ebp`）并跳转到标签地址来做到这一点。它完全可以使用 gcc 和 icc ，完全没有任何堆栈损坏。这工作的那一天是凉爽的一天。

现在我正在使用相同的程序并用 C 重新编写它，但它不起作用。具体来说，它不适用于 gcc v4.0.1 (Mac OS)。一旦我跳转到新的堆栈帧（堆栈基指针设置正确），就会执行以下指令，就在调用`fprintf`. 此处列出的最后一条指令崩溃，取消引用 NULL：

```
lea    0x18b8(%ebx), %eax
mov    (%eax), %eax
mov    (%eax), %eax 
```

我已经进行了一些调试，我发现通过`%ebx`在切换堆栈帧时手动设置寄存器（使用我在离开函数之前观察到的值），我修复了这个错误。我读过这个寄存器处理 gcc 中的“位置无关代码”。

*什么是位置无关代码？位置无关代码如何工作？这个寄存器指向什么？*

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-03T21:13:15.717

`EBX` points to the Global Offset Table. See [this reference about PIC on i386](https://web.archive.org/web/20140911162958/http://www.greyhat.ch/lab/downloads/pic.html). The link explains what PIC is an how `EBX` is used.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T21:12:00.837

PIC 是在加载时动态重定位的代码。非 PIC 的代码在链接时设置了跳转和调用地址。PIC 有一个表，该表引用了存在此类值的所有位置，就像 .dll 一样。

加载图像时，加载器将动态更新这些值。其他方案引用定义“基”的数据值，目标地址是通过在基上执行计算来决定的。底座通常由装载机重新设置。

最后，其他方案使用各种调用已知相对偏移量的蹦床。相对偏移量包含由加载器更新的代码和/或数据。

选择不同方案有不同的原因。有些在运行时速度很快，但加载速度较慢。有些加载速度很快，但运行时性能较差。

# c++-cli - C++ CLI 错误 C3767：候选函数不可访问

> ID：947213
> 
> 赞同：16
> 
> 时间：2009-06-03T20:59:08.307
> 
> 标签：c++-cli

我是来自非托管 C++ 世界的 C++ CLI 的新手。

我收到此错误：

```
candidate function(s) not accessible 
```

当我将 std::string 作为方法参数的一部分传递时。

这是确切的代码：

**Lib 项目（编译为 .dll 项目）**

//lib.h

```
#pragma once

public ref class Lib
{
public:
  Lib(void);

public:
  void Extract( std::string& data_ );
}; 
```

//lib.cpp

```
#include "Lib.h"

Lib::Lib(void)
{
}

void Lib::Extract( std::string& data_ )
{
  data_.empty();
} 
```

**LibTest 项目（编译为 application.exe）**

// LibTest.h

```
#pragma once

ref class LibTest
{
public:
  LibTest(void);
}; 
```

// LibTest.cpp

```
#include "LibTest.h"

LibTest::LibTest(void)
{
  Lib^ lib = gcnew Lib;
  lib->Extract( std::string("test") );
}

int main()
{
  return 0;
} 
```

**编译器错误：**

```
1>------ Build started: Project: LibTest, Configuration: Debug Win32 ------
1>Compiling...
1>LibTest.cpp
1>.\LibTest.cpp(7) : error C3767: 'Lib::Extract': candidate function(s) not accessible 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-03T23:22:28.017

问题是 std::string 将编译为内部（非公共）类型。这实际上是 VS 2005+ 中的一个变化：

[http://msdn.microsoft.com/en-us/library/ms177253(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms177253(VS.80).aspx)：

*默认情况下，本机类型在程序集外是私有的 本机类型现在默认情况下在程序集外不可见。有关程序集外部类型可见性的详细信息，请参阅类型可见性。此更改主要是由使用其他不区分大小写语言的开发人员在引用以 Visual C++ 编写的元数据时的需求驱动的。*

您可以使用 Ildasm 或[reflector](http://www.red-gate.com/products/reflector/)确认这一点，您将看到您的 extract 方法编译为：

```
public unsafe void Extract(basic_string<char,std::char_traits<char>,std::allocator<char> >* modopt(IsImplicitlyDereferenced) data_) 
```

basic_string 编译为：

```
[StructLayout(LayoutKind.Sequential, Size=0x20), NativeCppClass, MiscellaneousBits(0x40), DebugInfoInPDB, UnsafeValueType]
internal struct basic_string<char,std::char_traits<char>,std::allocator<char> > 
```

注意*内部*.

不幸的是，您无法从不同的程序集中调用这样的方法。

在某些情况下有一种解决方法：您可以使用 make_public pragma 强制将本机类型编译为公共。

例如，如果您有一个方法 Extract2，例如：

```
void Extract2( std::exception& data_ ); 
```

您可以通过预先包含此 pragma 语句来强制将 std::exception 编译为公共：

```
#pragma make_public(std::exception) 
```

现在可以跨程序集调用此方法。

不幸的是，make_public 不适用于模板类型（std::string 只是 basic_string<> 的 typedef）我认为您无法做任何事情来使其工作。我建议在所有公共 API 中使用托管类型 System::String^。这也确保您的库可以轻松地从其他 CLR 语言（例如 c#）调用

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-19T11:29:38.203

如果您只是必须访问这些`internal`方法，则另一种解决方法是将项目制作为像这样的[Friend Assemblies](http://msdn.microsoft.com/en-us/library/vstudio/ms177208.aspx)：

//库项目

```
#pragma once

//define LibTest as friend assembly which will allow access to internal members
using namespace System;
using namespace System::Runtime::CompilerServices;
[assembly:InternalsVisibleTo("LibTest")];

public ref class Lib
{
 public:
  Lib(void);

 public:
  void Extract( std::string& data_ );
}; 
```

//LibTest项目

```
#pragma once

#using <Lib.dll> as_friend

ref class LibTest
{
  public:
    LibTest(void);
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-18T12:25:56.483

除了上述解决方案，还可以将模板化类型子类化以获得非模板化类型，并将其定义包含在两个项目中，从而克服上述一些问题。

# sqlite - 如何获取 Sqlite3 数据库上的列名列表？

> ID：947215
> 
> 赞同：485
> 
> 时间：2009-06-03T20:59:14.110
> 
> 标签：sqlite

我想将我的 iPhone 应用程序迁移到新的数据库版本。由于我没有保存某些版本，因此我需要检查某些列名是否存在。

这个[Stackoverflow 条目](https://stackoverflow.com/questions/685206/sqlite-how-to-get-a-list-of-column-names)建议进行选择

```
SELECT sql FROM sqlite_master
WHERE tbl_name = 'table_name' AND type = 'table' 
```

并解析结果。

这是常见的方式吗？备择方案？

* * *

## 回答 #1

> 赞同：703
> 
> 时间：2009-06-04T01:38:40.020

```
PRAGMA table_info(table_name); 
```

将为您提供所有列名的列表。

* * *

## 回答 #2

> 赞同：266
> 
> 时间：2009-06-12T08:26:43.263

If you have the sqlite database, use the sqlite3 command line program and these commands:

To list all the tables in the database:

```
.tables 
```

To show the schema for a given `tablename`:

```
.schema tablename 
```

* * *

## 回答 #3

> 赞同：259
> 
> 时间：2016-12-06T21:25:22.697

如果你这样做

```
.headers ON 
```

你会得到想要的结果。

* * *

## 回答 #4

> 赞同：132
> 
> 时间：2013-12-17T19:52:31.427

只是为了像我这样的超级菜鸟想知道人们的意思是什么

```
PRAGMA table_info('table_name') 
```

您想使用它作为您的准备语句，如下所示。这样做会选择一个看起来像这样的表，除了填充与您的表有关的值。

```
cid         name        type        notnull     dflt_value  pk        
----------  ----------  ----------  ----------  ----------  ----------
0           id          integer     99                      1         
1           name                    0                       0 
```

其中 id 和 name 是列的实际名称。因此，要获得该值，您需要使用以下方法选择列名：

```
//returns the name
sqlite3_column_text(stmt, 1);
//returns the type
sqlite3_column_text(stmt, 2); 
```

这将返回当前行的列名。要全部获取它们或找到您想要的，您需要遍历所有行。最简单的方法是采用以下方式。

```
//where rc is an int variable if wondering :/
rc = sqlite3_prepare_v2(dbPointer, "pragma table_info ('your table name goes here')", -1, &stmt, NULL);

if (rc==SQLITE_OK)
{
    //will continue to go down the rows (columns in your table) till there are no more
    while(sqlite3_step(stmt) == SQLITE_ROW)
    {
        sprintf(colName, "%s", sqlite3_column_text(stmt, 1));
        //do something with colName because it contains the column's name
    }
} 
```

* * *

## 回答 #5

> 赞同：98
> 
> 时间：2018-10-31T11:10:29.293

如果您希望查询的输出包含列名称并正确对齐为列，请在以下命令中使用`sqlite3`：

```
.headers on
.mode column 
```

你会得到如下输出：

```
sqlite> .headers on
sqlite> .mode column
sqlite> select * from mytable;
id          foo         bar
----------  ----------  ----------
1           val1        val2
2           val3        val4 
```

* * *

## 回答 #6

> 赞同：57
> 
> 时间：2019-03-02T20:50:23.520

获取此处未提及的列名列表的另一种方法是跨平台且不依赖于 sqlite3.exe shell，是从 PRAGMA_TABLE_INFO() 表值函数中进行选择。

```
SELECT name FROM PRAGMA_TABLE_INFO('your_table');
name      
tbl_name  
rootpage  
sql 
```

您可以通过查询来检查某个列是否存在：

```
SELECT 1 FROM PRAGMA_TABLE_INFO('your_table') WHERE name='column1';
1 
```

如果您不想从 sqlite_master 或 pragma table_info 解析 select sql 的结果，这就是您使用的。

请注意，此功能是实验性的，已在 SQLite 版本 3.16.0 (2017-01-02) 中添加。

参考：

[https://www.sqlite.org/pragma.html#pragfunc](https://www.sqlite.org/pragma.html#pragfunc)

* * *

## 回答 #7

> 赞同：39
> 
> 时间：2019-05-20T05:46:24.893

要获取列列表，您可以简单地使用：

```
.schema tablename 
```

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2019-09-07T17:01:31.107

我知道这是一个旧线程，但最近我需要它并找到了一个简洁的方法：

```
SELECT c.name FROM pragma_table_info('your_table_name') c; 
```

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2018-02-12T22:56:02.680

运行`sqlite3`cli 时，输入：

```
sqlite3 -header 
```

也会给出想要的结果

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2020-02-24T11:02:59.287

`.schema table_name`

这将列出数据库中表的列名。

希望这会有所帮助！！！

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2012-05-03T06:38:48.697

如果您正在搜索任何特定列，则可以使用 Like 语句

前任：

```
SELECT * FROM sqlite_master where sql like('%LAST%') 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2013-06-24T18:14:34.613

为了获取列信息，您可以使用以下代码段：

```
String sql = "select * from "+oTablename+" LIMIT 0";
Statement statement = connection.createStatement();
ResultSet rs = statement.executeQuery(sql);
ResultSetMetaData mrs = rs.getMetaData();
for(int i = 1; i <= mrs.getColumnCount(); i++)
{
    Object row[] = new Object[3];
    row[0] = mrs.getColumnLabel(i);
    row[1] = mrs.getColumnTypeName(i);
    row[2] = mrs.getPrecision(i);
} 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2013-09-28T10:25:51.537

```
//JUST little bit modified the answer of giuseppe  which returns array of table columns
+(NSMutableArray*)tableInfo:(NSString *)table{

    sqlite3_stmt *sqlStatement;

    NSMutableArray *result = [NSMutableArray array];

    const char *sql = [[NSString stringWithFormat:@"PRAGMA table_info('%@')",table] UTF8String];

    if(sqlite3_prepare(md.database, sql, -1, &sqlStatement, NULL) != SQLITE_OK)

    {
        NSLog(@"Problem with prepare statement tableInfo %@",
                [NSString stringWithUTF8String:(const char *)sqlite3_errmsg(md.database)]);

    }

    while (sqlite3_step(sqlStatement)==SQLITE_ROW)
    {
        [result addObject:
          [NSString stringWithUTF8String:(char*)sqlite3_column_text(sqlStatement, 1)]];
    }

    return result;
} 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2016-11-01T15:12:30.400

当你在桌子里时，sqlite 控制台中的 .schema 对我来说看起来像这样......

```
sqlite>.schema
CREATE TABLE players(
id integer primary key,
Name varchar(255),
Number INT,
Team varchar(255) 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2018-01-24T11:08:31.233

```
function getDetails(){
var data = [];
dBase.executeSql("PRAGMA table_info('table_name') ", [], function(rsp){
    if(rsp.rows.length > 0){
        for(var i=0; i<rsp.rows.length; i++){
            var o = {
                name: rsp.rows.item(i).name,
                type: rsp.rows.item(i).type
            } 
            data.push(o);
        }
    }
    alert(rsp.rows.item(0).name);

},function(error){
    alert(JSON.stringify(error));
});             
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-04-18T16:25:14.430

```
-(NSMutableDictionary*)tableInfo:(NSString *)table
{
  sqlite3_stmt *sqlStatement;
  NSMutableDictionary *result = [[NSMutableDictionary alloc] init];
  const char *sql = [[NSString stringWithFormat:@"pragma table_info('%s')",[table UTF8String]] UTF8String];
  if(sqlite3_prepare(db, sql, -1, &sqlStatement, NULL) != SQLITE_OK)
  {
    NSLog(@"Problem with prepare statement tableInfo %@",[NSString stringWithUTF8String:(const char *)sqlite3_errmsg(db)]);

  }
  while (sqlite3_step(sqlStatement)==SQLITE_ROW)
  {
    [result setObject:@"" forKey:[NSString stringWithUTF8String:(char*)sqlite3_column_text(sqlStatement, 1)]];

  }

  return result;
  } 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-05-02T17:45:33.950

我知道为时已晚，但这将对其他人有所帮助。

要查找表的列名，您应该执行`select * from tbl_name`，您将在`sqlite3_stmt *`. 并检查列迭代总提取列。请参考以下代码。

```
// sqlite3_stmt *statement ;
int totalColumn = sqlite3_column_count(statement);
for (int iterator = 0; iterator<totalColumn; iterator++) {
   NSLog(@"%s", sqlite3_column_name(statement, iterator));
} 
```

这将打印结果集的所有列名。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-03-01T11:46:57.773

## 在 Python 中使用 sqlite3

[最佳答案](https://stackoverflow.com/a/948204) `PRAGMA table_info()`返回一个元组列表，可能不适合进一步处理，例如：

```
[(0, 'id', 'INTEGER', 0, None, 0),
 (1, 'name', 'TEXT', 0, None, 0),
 (2, 'age', 'INTEGER', 0, None, 0),
 (3, 'profession', 'TEXT', 0, None, 0)] 
```

在 Python 中使用 sqlite3 时，只需在末尾添加一个**列表**推导即可过滤掉不需要的信息。

```
import sqlite3 as sq

def col_names(t_name):
    with sq.connect('file:{}.sqlite?mode=ro'.format(t_name),uri=True) as conn:
        cursor = conn.cursor()
        cursor.execute("PRAGMA table_info({}) ".format(t_name))
        data = cursor.fetchall()
        return [i[1] for i in data]

col_names("your_table_name") 
```

结果

```
["id","name","age","profession"] 
```

**免责声明：请勿在生产中使用，因为此代码段可能会受到 SQL 注入的影响！**

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-02-17T18:23:22.433

If all else fails, you can always submit a query, limiting the return rows to none:

```
select * from MYTABLENAME limit 0 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-01-25T18:41:52.273

我能够通过使用一个 sql 查询来检索具有相应列的表名，但列输出是逗号分隔的。我希望它可以帮助某人

```
SELECT tbl_name, (SELECT GROUP_CONCAT(name, ',') FROM PRAGMA_TABLE_INFO(tbl_name)) as columns FROM sqlite_schema WHERE type = 'table'; 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-12-23T12:10:04.927

如果您使用的是 SQLite3，则不支持 INFORMATION_SCHEMA。请改用 PRAGMA table_info。这将返回有关表的 6 行信息。要获取列名 (row2)，请使用如下的 for 循环

```
cur.execute("PRAGMA table_info(table_name)")  # fetches the 6 rows of data
records = cur.fetchall() 
print(records)
for row in records:
    print("Columns: ", row[1]) 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-09-14T20:04:55.907

```
 //Called when application is started. It works on Droidscript, it is tested
     function OnStart()
     {
     //Create a layout with objects vertically centered. 
     lay = app.CreateLayout( "linear", "VCenter,FillXY" );  

     //Create a text label and add it to layout.
     txt = app.CreateText( "", 0.9, 0.4, "multiline" )  
     lay.AddChild( txt );
     app.AddLayout(lay);

     db = app.OpenDatabase( "MyData" )  

     //Create a table (if it does not exist already).  
     db.ExecuteSql( "drop table if exists test_table" )
     db.ExecuteSql( "CREATE TABLE IF NOT EXISTS test_table " +  
       "(id integer primary key, data text, num integer)",[],null, OnError )  
        db.ExecuteSql( "insert into test_table values (1,'data10',100), 
        (2,'data20',200),(3,'data30',300)")
        //Get all the table rows.      
        DisplayAllRows("SELECT * FROM test_table");
        DisplayAllRows("select *, id+100 as idplus, 'hahaha' as blabla from 
        test_table order by id desc;") 
     }

//function to display all records 
function DisplayAllRows(sqlstring)  // <-- can you use for any table not need to 
                                //  know column names, just use a *
                                // example: 
{ 
//Use all rows what is in ExecuteSql  (try any, it will works fine)
db.ExecuteSql( sqlstring, [], OnResult, OnError ) 
} 
//Callback to show query results in debug.  
function OnResult( res )   
{  
var len = res.rows.length; 
var s = txt.GetText();  
// ***********************************************************************
// This is the answer how to read column names from table:
for(var ColumnNames in res.rows.item(0)) s += " [ "+ ColumnNames +" ] "; // "[" & "]" optional, i use only in this demo 
// ***********************************************************************
//app.Alert("Here is all Column names what Select from your table:\n"+s);
s+="\n";
for(var i = 0; i < len; i++ )   
{  
    var rows = res.rows.item(i) 
    for (var item in rows) 
        {
            s += "    " + rows[item] + "   ";
        }
    s+="\n\n";
} 
//app.Alert(s);
txt.SetText( s )  
}  
//Callback to show errors.  
function OnError( msg )   
{  
   app.Alert( "Error: " + msg )  
} 
```

# linux - 如何使用文件协议访问本地系统上的目录？

> ID：947228
> 
> 赞同：7
> 
> 时间：2009-06-03T21:01:29.643
> 
> 标签：linux, file, url, file-uri

喜欢`/usr/local`？

我试过`file:///usr/local`但失败了

```
[root@www2 robot]# cd file:///usr/local
-bash: cd: file:///usr/local: No such file or directory 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T21:10:25.350

如果您需要能够从 shell 访问通用 URL，请尝试使用 curl 作为 cat 的替代品：

```
curl file:///path/to/file.txt
curl http://www.domain.com/file.txt 
```

但正如其他发帖者所指出的，shell 本身不理解 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T21:21:30.880

如果您必须在命令行上处理 file:///usr/local，您可以删除“file://”部分。然后执行正常的命令，例如：

```
echo "file:///usr/local/" |  sed 's/file:\/\///' | cd 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T21:05:27.997

`file:///`不适用于`bash`或衍生外壳。

它可以在大多数浏览器中运行，并且可能`wget`，`curl`但`bash`不是网络浏览器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T21:05:51.053

据我所知，bash 和 cd 不能跨多个协议运行。如果您想通过其他协议访问内容，则必须将它们挂载到本地文件系统。

您不是在尝试 cd 到用户在某些 Web 表单上提供的某个位置，是吗？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-03T21:04:57.263

该`file:`协议仅存在于网络浏览器中。在 Firefox 中尝试，它应该可以工作。要在 shell 中执行此操作，只需使用

```
cd /usr/本地/

```

不要使用`file:`. 这和你做不到的原因是一样的

```
猫 http://www.google.com

```

这会很棒（但你必须使用类似`wget`or的东西`curl`）。

# asp.net - 两个文本框，一个或两个都是必需的

> ID：947234
> 
> 赞同：5
> 
> 时间：2009-06-03T21:02:21.480
> 
> 标签：asp.net

我在一个 asp.net 网页上有两个文本框，一个或两个都需要填写。两者都不能留空。如何在 asp.net 中创建验证器来执行此操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T21:04:01.353

你需要一个**CustomValidator**来完成它。

这是一些演示基本用法的代码。自定义验证器文本将在提交回调中调用 IsValid 后显示，并且将从 Response.Write 调用中显示一些文本。

**ASPX**

```
 <asp:TextBox runat="server" ID="tb1" />
    <asp:TextBox runat="server" ID="tb2" />

    <asp:CustomValidator id="CustomValidator1" runat="server" 
      OnServerValidate="TextValidate" 
      Display="Dynamic"
      ErrorMessage="One of the text boxes must have valid input.">
    </asp:CustomValidator>

    <asp:Button runat="server" ID="uxSubmit" Text="Submit" /> 
```

**代码背后**

```
 protected void Page_Load(object sender, EventArgs e)
    {
        uxSubmit.Click += new EventHandler(uxSubmit_Click);
    }

    void uxSubmit_Click(object sender, EventArgs e)
    {
        Response.Write("Page is " + (Page.IsValid ? "" : "NOT ") + "Valid");
    }

    protected void TextValidate(object source, ServerValidateEventArgs args)
    {
        args.IsValid = (tb1.Text.Length > 0 || tb2.Text.Length > 0);
    } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T21:06:03.160

试试[CustomValidator](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)。

您需要创建一个执行以下操作的方法来处理 ServerValidate 事件：

```
void ServerValidation (object source, ServerValidateEventArgs args)
 {
    args.IsValid = TextBox1.Text.Length > 0 || TextBox2.Text.Length > 0;
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T21:14:31.253

除了创建服务器端验证之外，您还可以使用[CustomValidator上的](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)[ClientValidationFunction](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.clientvalidationfunction.aspx)属性来提供客户端验证。这可能看起来像这样：

```
function(sender, args) {
    args.IsValid = document.getElementById('<%=TextBox1.ClientID%>').value != '' 
                   || document.getElementById('<%=TextBox2.ClientID%>').value != '';
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-03T21:20:18.230

Onclientclick 您的按钮或提交您的页面的任何内容都会调用这样的 javascript 函数

```
function valtxtbox(){

if (document.getElementById('<%=TextBox1.ClientID%>').value== '' && document.getElementById('<%=TextBox2.ClientID%>').value== '')
{

alert('You must enter in data!');
return false;
} 
```

# c# - 如何在 C# 中创建动态属性？

> ID：947241
> 
> 赞同：88
> 
> 时间：2009-06-03T21:03:28.873
> 
> 标签：c#

我正在寻找一种方法来创建具有一组静态属性的类。在运行时，我希望能够从数据库中向该对象添加其他动态属性。我还想为这些对象添加排序和过滤功能。

我如何在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-06-03T21:08:07.757

你可以用字典，比如说

```
Dictionary<string,object> properties; 
```

我认为在大多数情况下，类似的事情都是这样完成的。
在任何情况下，您都不会从使用 set 和 get 访问器创建“真实”属性中获得任何收益，因为它只会在运行时创建并且您不会在代码中使用它...

这是一个示例，显示了过滤和排序的可能实现（无错误检查）：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace ConsoleApplication1 {

    class ObjectWithProperties {
        Dictionary<string, object> properties = new Dictionary<string,object>();

        public object this[string name] {
            get { 
                if (properties.ContainsKey(name)){
                    return properties[name];
                }
                return null;
            }
            set {
                properties[name] = value;
            }
        }

    }

    class Comparer<T> : IComparer<ObjectWithProperties> where T : IComparable {

        string m_attributeName;

        public Comparer(string attributeName){
            m_attributeName = attributeName;
        }

        public int Compare(ObjectWithProperties x, ObjectWithProperties y) {
            return ((T)x[m_attributeName]).CompareTo((T)y[m_attributeName]);
        }

    }

    class Program {

        static void Main(string[] args) {

            // create some objects and fill a list
            var obj1 = new ObjectWithProperties();
            obj1["test"] = 100;
            var obj2 = new ObjectWithProperties();
            obj2["test"] = 200;
            var obj3 = new ObjectWithProperties();
            obj3["test"] = 150;
            var objects = new List<ObjectWithProperties>(new ObjectWithProperties[]{ obj1, obj2, obj3 });

            // filtering:
            Console.WriteLine("Filtering:");
            var filtered = from obj in objects
                         where (int)obj["test"] >= 150
                         select obj;
            foreach (var obj in filtered){
                Console.WriteLine(obj["test"]);
            }

            // sorting:
            Console.WriteLine("Sorting:");
            Comparer<int> c = new Comparer<int>("test");
            objects.Sort(c);
            foreach (var obj in objects) {
                Console.WriteLine(obj["test"]);
            }
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-03T21:11:14.333

如果您出于数据绑定的目的需要它，您可以使用自定义描述符模型来执行此操作...通过实现`ICustomTypeDescriptor`和`TypeDescriptionProvider`/或`TypeCoverter`，您可以在运行时创建自己的`PropertyDescriptor`实例。这是诸如 等控件`DataGridView`用于`PropertyGrid`显示属性的内容。

要绑定到列表，您需要`ITypedList`and `IList`; 基本排序：`IBindingList`; 用于过滤和高级排序：`IBindingListView`; 完整的“新行”支持（`DataGridView`）：（`ICancelAddNew`呸！）。

这是***很多***工作。`DataTable`（虽然我讨厌它）是做同样事情的廉价方式。如果您不需要数据绑定，只需使用哈希表；-p

这是一个[简单的例子](https://stackoverflow.com/questions/882214/data-binding-dynamic-data)- 但你可以做更多......

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2011-08-12T10:01:51.093

像 MVC 3 中的 ViewBag 一样使用[ExpandoObject 。](http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-03T21:05:15.627

创建一个名为“Properties”的哈希表并将您的属性添加到其中。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-06-03T22:47:24.140

**我不确定你真的想做你说你想做的事**，但这不是我的理由！

在 JITed 之后，您不能将属性添加到一个类。

您可以获得的最接近的方法是使用 Reflection.Emit 动态创建子类型并复制现有字段，但您必须自己更新对该对象的所有引用。

您也无法在编译时访问这些属性。

就像是：

```
public class Dynamic
{
    public Dynamic Add<T>(string key, T value)
    {
        AssemblyBuilder assemblyBuilder = AppDomain.CurrentDomain.DefineDynamicAssembly(new AssemblyName("DynamicAssembly"), AssemblyBuilderAccess.Run);
        ModuleBuilder moduleBuilder = assemblyBuilder.DefineDynamicModule("Dynamic.dll");
        TypeBuilder typeBuilder = moduleBuilder.DefineType(Guid.NewGuid().ToString());
        typeBuilder.SetParent(this.GetType());
        PropertyBuilder propertyBuilder = typeBuilder.DefineProperty(key, PropertyAttributes.None, typeof(T), Type.EmptyTypes);

        MethodBuilder getMethodBuilder = typeBuilder.DefineMethod("get_" + key, MethodAttributes.Public, CallingConventions.HasThis, typeof(T), Type.EmptyTypes);
        ILGenerator getter = getMethodBuilder.GetILGenerator();
        getter.Emit(OpCodes.Ldarg_0);
        getter.Emit(OpCodes.Ldstr, key);
        getter.Emit(OpCodes.Callvirt, typeof(Dynamic).GetMethod("Get", BindingFlags.Instance | BindingFlags.NonPublic).MakeGenericMethod(typeof(T)));
        getter.Emit(OpCodes.Ret);
        propertyBuilder.SetGetMethod(getMethodBuilder);

        Type type = typeBuilder.CreateType();

        Dynamic child = (Dynamic)Activator.CreateInstance(type);
        child.dictionary = this.dictionary;
        dictionary.Add(key, value);
        return child;
    }

    protected T Get<T>(string key)
    {
        return (T)dictionary[key];
    }

    private Dictionary<string, object> dictionary = new Dictionary<string,object>();
} 
```

我没有在这台机器上安装 VS，所以如果有任何严重的错误，请告诉我（嗯......除了大量的性能问题，但我没有写规范！）

现在你可以使用它了：

```
Dynamic d = new Dynamic();
d = d.Add("MyProperty", 42);
Console.WriteLine(d.GetType().GetProperty("MyProperty").GetValue(d, null)); 
```

您还可以在支持后期绑定的语言（例如，VB.NET）中将其用作普通属性

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-01-06T10:38:01.120

我使用 ICustomTypeDescriptor 接口和 Dictionary 完全做到了这一点。

为动态属性实现 ICustomTypeDescriptor：

我最近需要将一个网格视图绑定到一个记录对象，该对象可以具有可以在运行时添加和删除的任意数量的属性。这是为了允许用户向结果集添加新列以输入额外的数据集。

这可以通过将每个数据“行”作为字典来实现，其中键是属性名称，值是可以存储指定行的属性值的字符串或类。当然，拥有 Dictionary 对象列表将无法绑定到网格。这就是 ICustomTypeDescriptor 的用武之地。

通过为 Dictionary 创建一个包装类并使其符合 ICustomTypeDescriptor 接口，可以覆盖返回对象属性的行为。

看看下面数据“行”类的实现：

```
/// <summary>
/// Class to manage test result row data functions
/// </summary>
public class TestResultRowWrapper : Dictionary<string, TestResultValue>, ICustomTypeDescriptor
{
    //- METHODS -----------------------------------------------------------------------------------------------------------------

    #region Methods

    /// <summary>
    /// Gets the Attributes for the object
    /// </summary>
    AttributeCollection ICustomTypeDescriptor.GetAttributes()
    {
        return new AttributeCollection(null);
    }

    /// <summary>
    /// Gets the Class name
    /// </summary>
    string ICustomTypeDescriptor.GetClassName()
    {
        return null;
    }

    /// <summary>
    /// Gets the component Name
    /// </summary>
    string ICustomTypeDescriptor.GetComponentName()
    {
        return null;
    }

    /// <summary>
    /// Gets the Type Converter
    /// </summary>
    TypeConverter ICustomTypeDescriptor.GetConverter()
    {
        return null;
    }

    /// <summary>
    /// Gets the Default Event
    /// </summary>
    /// <returns></returns>
    EventDescriptor ICustomTypeDescriptor.GetDefaultEvent()
    {
        return null;
    }

    /// <summary>
    /// Gets the Default Property
    /// </summary>
    PropertyDescriptor ICustomTypeDescriptor.GetDefaultProperty()
    {
        return null;
    }

    /// <summary>
    /// Gets the Editor
    /// </summary>
    object ICustomTypeDescriptor.GetEditor(Type editorBaseType)
    {
        return null;
    }

    /// <summary>
    /// Gets the Events
    /// </summary>
    EventDescriptorCollection ICustomTypeDescriptor.GetEvents(Attribute[] attributes)
    {
        return new EventDescriptorCollection(null);
    }

    /// <summary>
    /// Gets the events
    /// </summary>
    EventDescriptorCollection ICustomTypeDescriptor.GetEvents()
    {
        return new EventDescriptorCollection(null);
    }

    /// <summary>
    /// Gets the properties
    /// </summary>
    PropertyDescriptorCollection ICustomTypeDescriptor.GetProperties(Attribute[] attributes)
    {
        List<propertydescriptor> properties = new List<propertydescriptor>();

        //Add property descriptors for each entry in the dictionary
        foreach (string key in this.Keys)
        {
            properties.Add(new TestResultPropertyDescriptor(key));
        }

        //Get properties also belonging to this class also
        PropertyDescriptorCollection pdc = TypeDescriptor.GetProperties(this.GetType(), attributes);

        foreach (PropertyDescriptor oPropertyDescriptor in pdc)
        {
            properties.Add(oPropertyDescriptor);
        }

        return new PropertyDescriptorCollection(properties.ToArray());
    }

    /// <summary>
    /// gets the Properties
    /// </summary>
    PropertyDescriptorCollection ICustomTypeDescriptor.GetProperties()
    {
        return ((ICustomTypeDescriptor)this).GetProperties(null);
    }

    /// <summary>
    /// Gets the property owner
    /// </summary>
    object ICustomTypeDescriptor.GetPropertyOwner(PropertyDescriptor pd)
    {
        return this;
    }

    #endregion Methods

    //---------------------------------------------------------------------------------------------------------------------------
} 
```

注意：在 GetProperties 方法中，我可以缓存 PropertyDescriptors 一次读取以提高性能，但由于我在运行时添加和删除列，我总是希望它们重建

您还将在 GetProperties 方法中注意到为字典条目添加的属性描述符是 TestResultPropertyDescriptor 类型。这是一个自定义的 Property Descriptor 类，用于管理如何设置和检索属性。看看下面的实现：

```
/// <summary>
/// Property Descriptor for Test Result Row Wrapper
/// </summary>
public class TestResultPropertyDescriptor : PropertyDescriptor
{
    //- PROPERTIES --------------------------------------------------------------------------------------------------------------

    #region Properties

    /// <summary>
    /// Component Type
    /// </summary>
    public override Type ComponentType
    {
        get { return typeof(Dictionary<string, TestResultValue>); }
    }

    /// <summary>
    /// Gets whether its read only
    /// </summary>
    public override bool IsReadOnly
    {
        get { return false; }
    }

    /// <summary>
    /// Gets the Property Type
    /// </summary>
    public override Type PropertyType
    {
        get { return typeof(string); }
    }

    #endregion Properties

    //- CONSTRUCTOR -------------------------------------------------------------------------------------------------------------

    #region Constructor

    /// <summary>
    /// Constructor
    /// </summary>
    public TestResultPropertyDescriptor(string key)
        : base(key, null)
    {

    }

    #endregion Constructor

    //- METHODS -----------------------------------------------------------------------------------------------------------------

    #region Methods

    /// <summary>
    /// Can Reset Value
    /// </summary>
    public override bool CanResetValue(object component)
    {
        return true;
    }

    /// <summary>
    /// Gets the Value
    /// </summary>
    public override object GetValue(object component)
    {
          return ((Dictionary<string, TestResultValue>)component)[base.Name].Value;
    }

    /// <summary>
    /// Resets the Value
    /// </summary>
    public override void ResetValue(object component)
    {
        ((Dictionary<string, TestResultValue>)component)[base.Name].Value = string.Empty;
    }

    /// <summary>
    /// Sets the value
    /// </summary>
    public override void SetValue(object component, object value)
    {
        ((Dictionary<string, TestResultValue>)component)[base.Name].Value = value.ToString();
    }

    /// <summary>
    /// Gets whether the value should be serialized
    /// </summary>
    public override bool ShouldSerializeValue(object component)
    {
        return false;
    }

    #endregion Methods

    //---------------------------------------------------------------------------------------------------------------------------
} 
```

要查看此类的主要属性是 GetValue 和 SetValue。在这里，您可以看到组件被转换为字典，并且其中的键值被设置或检索。重要的是，此类中的字典与 Row 包装器类中的类型相同，否则强制转换将失败。创建描述符时，键（属性名称）被传入并用于查询字典以获取正确的值。

摘自我的博客：

[动态属性的 ICustomTypeDescriptor 实现](http://wraithnath.blogspot.com/2011/01/implementing-icustomtypedescriptor-for.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-03T21:07:00.753

我不确定您的原因是什么，即使您可以使用 Reflection Emit 以某种方式实现它（我不确定您是否可以），这听起来也不是一个好主意。可能更好的主意是拥有某种字典，您可以通过类中的方法包装对字典的访问。这样，您可以将数据库中的数据存储在此字典中，然后使用这些方法检索它们。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-03T22:24:53.360

您应该查看 WPF 使用的 DependencyObjects，它们遵循类似的模式，可以在运行时分配属性。如上所述，这最终指向使用哈希表。

另一个有用的东西是[CSLA.Net](http://www.lhotka.net/cslanet/)。该代码是免费提供的，并使用了您所追求的一些原则\模式。

另外，如果您正在查看排序和过滤，我猜您将使用某种网格。一个有用的实现接口是 ICustomTypeDescriptor，它可以让你有效地覆盖当你的对象被反射时发生的事情，这样你就可以将反射器指向你的对象自己的内部哈希表。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-08T16:34:44.303

作为一些 orsogufo 代码的替代品，因为我最近自己用字典解决了同样的问题，这里是我的 [] 运算符：

```
public string this[string key]
{
    get { return properties.ContainsKey(key) ? properties[key] : null; }

    set
    {
        if (properties.ContainsKey(key))
        {
            properties[key] = value;
        }
        else
        {
            properties.Add(key, value);
        }
    }
} 
```

`[]=`使用此实现，如果字典中不存在新的键值对，setter 将在您使用时添加它们。

另外，对我来说`properties`是一个`IDictionary`并且在构造函数中我将它初始化为`new SortedDictionary<string, string>()`.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-03T21:05:49.540

为什么不使用具有属性名称的索引器作为传递给索引器的字符串值？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-03T21:08:07.977

难道你不能让你的类公开一个 Dictionary 对象吗？您可以在运行时简单地将数据（带有一些标识符）插入到字典中，而不是“将更多属性附加到对象”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-04-14T21:06:35.107

如果是用于绑定，则可以从 XAML 引用索引器

```
Text="{Binding [FullName]}" 
```

这里它使用键“FullName”引用类索引器

# c# - 编组链表

> ID：947265
> 
> 赞同：1
> 
> 时间：2009-06-03T21:08:18.317
> 
> 标签：c#, interop, linked-list, marshalling, dllimport

为重复发布道歉。

你好

我无法从 DLL 编组链接列表。

------C++结构和功能--------

```
struct localeInfo { 
   WCHAR countryName[BUFFER_SIZE];
   WCHAR localeName[BUFFER_SIZE]; 
   localeInfo *next; 
}

int GetSystemLocales(localeInfo **ppList); 
```

------------C#声明------------

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)] 
private struct LocaleInfo { 
   public string countryName; 
   public string localeName; 
   public IntPtr next; 
};

[DllImport("systemLocales.dll")]
private static extern int GetSystemLocales(ref IntPtr ppList);

int main() 
{ 
   var pListHead = Marshal.AllocHGlobal(Marshal.SizeOf(typeof(IntPtr))); 
   try 
   { 
       GetSystemLocales(ref pListHead); 
       var deref1(IntPtr)Marshal.PtrToStructure(pListHead, typeof(IntPtr)); 
       var deref2 = (LocaleInfo)Marshal.PtrToStructure(deref1, typeof(LocaleInfo)); 
   } 
   finally 
   { 
      Marshal.FreeHGlobal(pListHead); 
   }

} 
```

我在 deref2 声明时收到 FatalExecutionEngine 异常。我不知道如何取回链接列表并访问其内容。

这是我为获取链表而编写的 C++ 代码。我想要类似于在 C# 中工作的东西。

```
localeInfo *pHead = NULL; 
localeInfo *pTemp; 
GetSystemLocales(&pHead);

for(pTemp = pHead; pTemp!=NULL; pTemp = pTemp->next)
{
        wprintf(L"Display Name : %s (%s) \n", pTemp->countryName, pTemp->localeName);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T15:24:36.177

试试这个：

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
private struct LocaleInfo { 
   [MarshalAs(UnmanagedType.ByValTStr, SizeConst = BUFFER_SIZE)]
   public string countryName; 
   [MarshalAs(UnmanagedType.ByValTStr, SizeConst = BUFFER_SIZE)]
   public string localeName; 
   public IntPtr next; 
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T19:03:01.337

我按照这些思路回答了你的另一个问题。谢伊的`struct`定义是其中的一部分，但我也更正了`Main`。

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Unicode)]
private struct LocaleInfo
{
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = BUFFER_SIZE)]
    public string countryName;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = BUFFER_SIZE)]
    public string localeName;
    public IntPtr next;
};

[DllImport("systemLocales.dll")]
private static extern int GetSystemLocales(ref IntPtr ppList);

static void Main()
{ 
    IntPtr pList = IntPtr.Zero;
    GetSystemLocales(ref pList);
    while (pList != IntPtr.Zero)
    {
        var info = (LocaleInfo)Marshal.PtrToStructure(pList, typeof(LocaleInfo));
        Console.WriteLine("Display Name : {0} ({1}) ", info.countryName, info.localeName);
        Marshal.FreeHGlobal(pList);
        pList = info.next;
    }
} 
```

你真的应该关闭另一个问题 - 我只是幸运地注意到你也发布了这个问题。

# linux - 如何在 Linux/Qt/C++ 下检测 USB 设备断开连接

> ID：947267
> 
> 赞同：5
> 
> 时间：2009-06-03T21:08:51.017
> 
> 标签：linux, usb, disconnect

我正在编写一个系统（X-Platform Windows/Linux），它使用 FTDI USB 芯片与自定义设备通信。我使用他们的 D2XX 驱动程序来打开/关闭/读取/写入设备。到目前为止，一切都很好。

我需要知道设备何时断开，以便程序可以正常响应。目前，在 Windows 下，应用程序突然意外关闭。在Linux下，当设备断开连接时，会出现分段故障。

我在 Windows 下找到了关于监听 WM_DEVICECHANGE 消息的信息。但是，我还没有找到如何在 Windows 下检测到这个事件。有与内核交互的设备驱动程序级别的信息。但是，我无法弄清楚如何在应用程序级别执行此操作。FTDI 驱动程序不提供任何此类服务。

该系统是使用带有 C++ 的 Qt 框架编写的。设备驱动程序是 FTDI 的 D2XX 驱动程序。

谁能指出我正确的方向？

提前非常感谢！朱迪

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T21:21:25.873

您可能想要使用[HAL](http://www.freedesktop.org/wiki/Software/hal)（[freedesktop.org](http://www.freedesktop.org/wiki/Home)的硬件抽象层）。

将来您可能会想要使用[DeviceKit](http://www.freedesktop.org/wiki/Software/DeviceKit)。这是一个解决 HAL 的许多问题的项目。虽然它还没有被所有主要发行版采用（我认为只是 Fedora），所以你现在可能不想使用它。

编辑：正如 Jeach 所说，您也可以使用[udev](http://www.kernel.org/pub/linux/utils/kernel/hotplug/udev.html)。我不建议这样做，因为它的级别要低得多，而且更难编程，但如果延迟*非常*重要，这可能是最好的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-31T19:39:19.443

您显然必须为不同的操作系统编写不同的实现，除非您想创建一个线程来连续运行：

```
FT_ListDevices(&numDevs, nullptr, FT_LIST_NUMBER_ONLY); 
```

如果 numDevs 与之前的检查相比发生了变化，则枚举设备。

如果您像我一样，不喜欢在您的 USB 设备上进行这种连续轮询，那么您将不得不针对您的特定操作系统。

这是 FTDI 的一些示例代码的链接：http: [//www.ftdichip.com/Support/SoftwareExamples/CodeExamples/VC.htm](http://www.ftdichip.com/Support/SoftwareExamples/CodeExamples/VC.htm)

示例 7 显示了如何在 Windows 上检测 USB 插入和拔出：http: [//www.ftdichip.com/Support/Documents/AppNotes/AN_152_Detecting_USB_%20Device_Insertion_and_Removal.pdf](http://www.ftdichip.com/Support/Documents/AppNotes/AN_152_Detecting_USB_%20Device_Insertion_and_Removal.pdf)

在 Linux 上，我个人可以推荐使用 udev。

此代码用于枚举设备：

```
#include <sys/types.h>
#include <dirent.h>
#include <cstdlib>
#include <libudev.h>
#include <fcntl.h>

struct udev *udev = udev_new();
if (!udev) {
    cout << "Can't create udev" <<endl;
}

struct udev_enumerate *enumerate = udev_enumerate_new(udev);
udev_enumerate_add_match_subsystem(enumerate, "usb");
udev_enumerate_scan_devices(enumerate);
struct udev_list_entry *dev_list_entry, *devices = udev_enumerate_get_list_entry(enumerate);
struct udev_device *dev;
udev_list_entry_foreach(dev_list_entry, devices) {
    const char *path;
    path = udev_list_entry_get_name(dev_list_entry);
    dev = udev_device_new_from_syspath(udev, path);
    if( udev_device_get_devnode(dev) != nullptr ){
        string vendor = (std::string) udev_device_get_sysattr_value(dev, "idVendor");
        string product = (std::string) udev_device_get_sysattr_value(dev, "idProduct");
        string description = (std::string)udev_device_get_sysattr_value(dev, "product");
        cout << vendor << product << description << endl;
    }
    udev_device_unref(dev);
}
udev_enumerate_unref(enumerate); 
```

这段代码我放在一个单独的线程中，等待接收插入或删除事件

```
struct udev_device *dev;
struct udev_monitor *mon = udev_monitor_new_from_netlink(udev, "udev");
udev_monitor_filter_add_match_subsystem_devtype(mon, "usb", NULL);
udev_monitor_enable_receiving(mon);

int fd = udev_monitor_get_fd(mon);

int flags = fcntl(fd, F_GETFL, 0);
if (flags == -1){
    debugError("Can't get flags for fd");
}
flags &= ~O_NONBLOCK;
fcntl(fd, F_SETFL, flags);
fd_set fds;
FD_ZERO(&fds);
FD_SET(fd, &fds);

while( _running ){
    cout << "waiting for udev" << endl;
    dev = udev_monitor_receive_device(mon);
    if (dev && udev_device_get_devnode(dev) != nullptr ) {
        string action = (std::string)udev_device_get_action(dev);
        if( action == "add" ){
            cout << "do something with your device... " << endl;
        } else {
            string path = (std::string)udev_device_get_devnode(dev);
            for( auto device : _DevicesList ){
                if( device.getPath() == path ){
                    _DevicesList.erase(iter);
                    cout << "Erased Device from list" << endl;
                    break;
                }
            }
        }
        udev_device_unref(dev);
    }
}
udev_monitor_unref(mon); 
```

当您复制/粘贴此代码时，某些函数和变量显然没有定义。我保留检测到的设备列表以检查路径和其他信息，例如插入设备的位置 ID。稍后我需要通过 FT_OPEN_BY_LOCATION 将位置 ID 用于 FT_OpenEx。为了获取位置 ID，我阅读了以下文件的内容：

```
string getFileContent(string file ){
    string content = "";
    ifstream readfile( file );
    if( readfile.is_open() ){
        getline(readfile, content );
        readfile.close();
    }
    return content;
}
string usbdirectory = "/sys/bus/usb/devices";
string dev1content = getFileContent(usbdirectory+"/usb"+udev_device_get_sysattr_value(dev, "busnum" )+"/dev");
int dev1num = std::atoi(dev1content.substr(dev1content.find_first_of(":")+1).c_str());
string dev2content = (std::string)udev_device_get_sysattr_value(dev, "dev");
int dev2num = std::atoi(dev2content.substr(dev2content.find_first_of(":")+1).c_str());

int locationid = dev1num+dev2num+257; 
```

我不能保证 locationid 是正确的，但直到现在它似乎对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-24T19:44:07.930

我最近有一个项目涉及通过 FTDI 芯片进行读取。我也尝试使用 libftdi，但发现使用 /dev/ttyUSB* 进行读写要简单得多。这样，您就可以使用 QFile('/dev/ttyUSB*') 进行写入和读取。您还可以检查设备是否确实存在并且不会出现段错误。当然，这不是一种非常“平台独立”的方式。要获得独立于平台的方法，您可以使用 Qt 的串行库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T21:38:00.630

虽然我将要告诉你的内容不会直接回答你的问题，但它可能会给你一个关于下一步行动的提示。

我使用 '/etc/udev/rules.d/' 中配置的 udev 规则来运行各种脚本。当 USB 设备连接/断开时，我运行一个脚本，该脚本将 HUP 信号发送到我的二进制文件。由于我的要求可以处理一些滞后，因此对我来说非常好。

但我的观点是，也许有一个 udev 库可以链接到并以编程方式注册事件（而不是脚本）。

希望它有所帮助......祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T12:12:56.530

不要忘记这里有两个问题：

*   检测设备插入/移除
*   正确终止您的应用程序。

Zifre 解决了第一个问题。

但是第二个问题仍然存在：当设备被移除时，您的 Linux 应用程序不应该出现段错误，我认为这两个问题是不相关的：如果设备在写入或读取系统调用的中间被移除，那么这些系统调用将返回在您收到任何通知之前出现错误，这不应该使您的应用程序出现段错误。

# asp.net - 当我生成 HttpUnauthorizedResult 时，ASP.Net (MVC) 是否会重定向到登录表单？

> ID：947269
> 
> 赞同：1
> 
> 时间：2009-06-03T21:08:56.600
> 
> 标签：asp.net, asp.net-mvc, login, authorize

我实际上使用的是 ASP.Net MVC，但我认为这也适用于 ASP.Net。

调查授权是如何工作的，我得出的结论是 ASP.Net MVC 在用户未经授权且应该授权时生成一个 HttpUnauthorizedResult 。然后 ASP.Net 从我的 Web.config 中读取：

```
<authentication mode="Forms">
   <forms loginUrl="~/Account/LogOn" timeout="2880"/>
</authentication> 
```

并生成实际的 URL 和重定向结果。或者换一种说法：说 ASP.Net MVC 应用程序从不生成重定向 URL 是否正确？

我的问题是我想向重定向 URL 添加一些东西，但似乎我唯一能做的就是捕获 HttpUnauthorizedResult 并从头开始生成整个 URL 重定向。也许 ASP.Net 中有一种方法可以根据我的配置文件给我重定向，这样我就不必自己阅读配置文件了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T21:15:31.160

试试这个 - [System.Web.Security.FormsAuthentication.RedirectToLoginPage(string extraQueryString)](http://msdn.microsoft.com/en-us/library/6b0s62sw.aspx)，其中*extraQueryString* - 包含在重定向 URL 中的查询字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:50:28.373

没有添加任何自动内容的 URL，例如 ReturnURL，就像它的配置一样，可以通过以下方式检索：

```
System.Web.Security.FormsAuthentication.LoginUrl 
```

# database - 为日历应用程序布置数据库模式

> ID：947272
> 
> 赞同：54
> 
> 时间：2009-06-03T21:09:55.990
> 
> 标签：database, schema, calendar, normalization

我想写一个日历应用程序。确实是反复出现的项目对 DB 模式的工作造成了影响。我很想就如何组织这个问题提供一些意见。

如果用户创建一个事件，并输入它在星期一每个人都重复，永远？我如何将所有这些存储在数据库中？我无法创建无限事件。我是否只是在其中放置一个包含相关信息的表格，以便我可以计算所有事件的去向？如果是这样，每次用户查看日历的新部分时，我都必须计算它们。如果他们浏览了几个月，但他们有大量的经常性项目怎么办？

此外，当用户单击一个项目并说“编辑序列中的这个”时，模式需要处理，而不是序列中的所有项目。然后我是否将一个项目从序列中拆分出来？

**更新 1**

我根本没有看过 iCal。需要明确的是，我认为保存允许您计算重复项目的信息，并拆分任何与序列不同的信息是存储它以便能够传输它的好方法。但我认为在应用程序中，这太慢了，无法在所有地方进行日期数学运算。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-19T11:05:07.490

我一直在努力解决同样的问题，实际上我是在玩弄上面建议的“缓存表”想法，但后来我遇到了一个似乎还没有被代表的替代方案（[这里建议）。](https://allenbrowne.com/AppRecur.html)

建立一个包含所有事件的表

```
EventID (primary key)
Description
StartDate
PeriodType - days, weeks, months, years
PeriodFreq - # of days, weeks, etc between events
EndDate
... other attributes that can be modified 
```

然后为这些事件的**异常**添加一个表。此表使用一个复合键，由映射到事件表的 EventID 和一个实例 ID 组成，用于选择系列中的特定事件。

```
EventID (key)
InstanceID (key)
InstanceDate - the modified date of the exception 
IsCancelled - a flag to skip this date when traversing the series
... other attributes that can be modified 
```

它似乎保持事件表规范化，并避免拆分系列来处理异常。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-03T21:15:37.740

我最近创建了一个日历应用程序，这是我面临的众多挑战之一。

我最终想出了一个半黑客式的解决方案。我创建了一个`event_type`专栏。在该专栏中，我有：`daily`、`weekly`、`monthly`或`yearly`。我也有一个`start_date`和一个`end_date`专栏。其他一切都在实际的后端代码中处理。

如果用户只编辑了一个事件，我从不尝试拆分事件。在这种情况下没有必要。`start_date`但是，您可以通过更改第一个事件的 end_date 来拆分事件，使用新事件和原始事件创建一个新事件`end_date`，最后为您刚刚选择编辑的事件创建一个新事件。这个过程最终会创建 3 个事件。

我知道。当时我想不出一个聪明的方法来处理这个问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T21:21:07.637

正常保留事件表中的重复项目，但标记为具有适当开始/结束日期的重复项目。

如果用户修改了约会的单个实例，只需创建一个新事件，其“parentId”可能等于重复事件的 id。

构建逻辑，使日历使用具有匹配父 ID 的事件覆盖特定日期的任何重复事件。

您关于性能的问题基本上是旧的速度与存储问题。我真的不认为所需的计算会超过存储这么多约会的空间要求。只需阅读数据库优化 - 索引等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T21:24:57.800

你能用一个“缓存”表来连接这两个世界，你可以在其中预先计算接下来 X 天的事件价值吗？

所以三个表：

```
recurring_event_specs
one_time_events
cached_recurring_events 
```

对于今天 X 天内日历的任何部分，您的查询将 UNION`one_time_events`和`cached_recurring_events`.

然后，如果用户试图在未来 X 天以上查看日历的一部分，那么您只需进行即时日期计算。我想你可以找到一个理智的 X 来覆盖大部分的正常使用。

`cached_recurring_events`每当用户添加新的重复事件时，都需要更新该表 - 并且可能每天通过 cron-job/scheduled-task 离线一次。但仅限于没有创建新的重复事件的日子。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-07-05T10:31:44.787

为什么不使用 Google 日历作为此日历应用程序的数据库，依靠[Google 日历的 API](https://developers.google.com/google-apps/calendar/concepts/)来存储和检索日历事件？

Calendar API 是一个 REST API，可以通过显式 HTTP 调用进行访问；该 API 公开了 Google 日历 Web 界面中可用的大部分功能，因此您的日历应用程序可以提供与 Google 日历一样多的功能（很多功能！！！）。

您的应用程序只需要为 Google API 实现 OAuth 2.0，使用像[Auth0](https://auth0.com/)这样的单点登录服务来提供适当的访问令牌就可以轻松实现。然后，您的日历应用程序可以将这些令牌与日历 API 结合使用，以提供 JSON 格式的日历事件的无缝存储和检索。

用户在他们自己的“新日历”中创建事件。**此日历以专用于此应用程序的 gmail 帐户（应用程序的 gmail 帐户**）的形式与您共享。

基本上，Google 日历成为您的数据库，您可以让**应用程序的 gmail 帐户**不仅存储应用程序的所有事件，还允许您通过直观的界面查看和编辑这些事件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-16T05:33:59.353

最好的方法是存储基于标准的重复模式字符串 (iCal).. 如果它是单个事件，则留空。有一些 API 可以解析重复模式并创建可以绑定到 UI 元素的事件对象......所有事件都不需要存储在数据库中，只有初始事件（发生）......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-23T09:05:12.090

你不能用开始和结束时间存储每天的事件吗？它将为每天发生的事件生成大量数据（可能与此无关），但它会使查询更容易，并且可能会出现异常（例如事件地点被烧毁或员工罢工）。为了生成事件的日期，我建议在前端实现它，该前端源自一些 ICal-ish 模式。

# .net - WSE 服务更新；“wse”后缀问题

> ID：947277
> 
> 赞同：1
> 
> 时间：2009-06-03T21:10:40.280
> 
> 标签：.net, web-services

我有一个使用 WSE 3.0（VS2k5 和 .Net 2.0）引用 Web 服务的应用程序。该应用程序是第三方应用程序，包含对代理对象“ThisServiceWse”的引用，当我更新 Web 服务引用时，代理对象名称更改为“ThisService”，没有“Wse”后缀。这意味着即使项目属性另有说明，该项目也没有使用 WSE。有人见过这个吗？我如何解决它？我已经尝试卸载/重新安装 WSE 无济于事。

另外，作为一个附带问题。我无法升级此服务，因为它使用了“RequireMTOM”属性。是否可以在 .Net 3.5 Web 服务中设置此属性？希望从 WSE 3.0 升级。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2009-06-03T21:23:26.180

Ryan，WSE 已经过时了。在 WCF 发布的那一刻，它被 WCF 取代。WCF 它与 WSE 非常不同，因此“RequireMTOM”属性不太可能仍然以这种形式存在。

此外，如果您更新了“服务参考”，那么您没有在客户端上使用 WSE - 您在客户端上使用的是 WCF。

# c - c语言windows中的异步串口通信

> ID：947280
> 
> 赞同：2
> 
> 时间：2009-06-03T21:11:20.230
> 
> 标签：c, windows, asynchronous, serial-port

当我尝试运行对串行端口进行一些基本写入的 ac 文件时出现错误。我正在尝试异步运行它，因为写入有时需要很长时间才能传输。我的原始版本让它与运行良好的 WriteFile() 命令同步运行。我是使用 OVERLAPPED 的新手，我会很感激并为此提供意见。

我得到的错误是：

```
Debug Assertion Failed! 
<path to dbgheap.c> 
Line: 1317 
Expression: _CrtIsValidHeapPointer(pUserData) 
```

当调用第二个写入函数时。

主要：

```
 {
        //initialized port (with overlapped), DBC, and timeouts

        result = write_port(outPortHandle, 128);
        result = write_port(outPortHandle, 131);
    }

static void CALLBACK write_compl(DWORD dwErrorCode, DWORD dwNumberOfBytesTransfered, LPOVERLAPPED lpOverlapped) {
        //write completed. check for errors? if so throw an exception maybe?
        printf("write completed--and made it to callback function\n");
    }

int write_port(HANDLE hComm,BYTE* lpBuf) {

   OVERLAPPED osWrite = {0};

   // Create this write operation's OVERLAPPED structure's hEvent.
   osWrite.hEvent = CreateEvent(NULL, TRUE, FALSE, NULL);
   if (osWrite.hEvent == NULL)
      // error creating overlapped event handle
      return 0;

   // Issue write.
   if (!WriteFileEx(hComm, &lpBuf, 1, &osWrite, &write_compl )) {
      if (GetLastError() != ERROR_IO_PENDING) { 
         // WriteFile failed, but isn't delayed. Report error and abort.
          printf("last error: %ld",GetLastError());
          return 0; //failed, return false;
      }
      else {
         // Write is pending.
         WaitForSingleObjectEx(osWrite.hEvent, 50, TRUE);   //50 ms timeout

        return -1; //pending
      }
   }
   else {
        return 1; //finished
   }
} 
```

* * *

那不是完整的代码，对不起。我也使用了一个字节数组，而不是常量。但是系统（“暂停”）导致我的调试断言失败错误，仔细查看我的代码后，当 WriteFileEx() 成功时，它从未在重叠结构中的事件上设置警报/超时，所以回调函数永远不会被调用。我解决了这些问题。

我只需要处理/访问结构中的单个 BYTE 的帮助，该结构是在调用 ReadFileEx() 函数时分配的（用于存储读取的 BYTE 以便对其进行处理）。我需要知道如何使用偏移量访问该 BYTE 存储并使重叠结构为空。将重叠结构设置为 null 就像将其中的句柄设置为 INVALID_HANDLE_VALUE 一样简单吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T22:07:03.770

我认为你有几个问题：

* * *

您将整数作为指针传递（您的编译器应该对此发出警告，或者最好拒绝编译代码）：

> 结果 = write_port(outPortHandle, 128);

将此与 write_port 的定义进行比较：

> int write_port(HANDLE hComm,BYTE* lpBuf) {

上述说法不符。稍后，您通过获取 BYTE* -> "&lpBuf" 的地址将指向 lpBuf 的指针传递给 WriteFileEx 函数。这不会导致你认为它会做的事情。

* * *

即使您解决了这个问题，只要写入成功排队但不会在 50 毫秒超时内完成，您仍然会遇到潜在的生命周期问题。

使用重叠 I/O 时，需要确保读/写缓冲区和重叠结构保持有效，直到 I/O 完成、取消或关联设备关闭。在上面的代码中，您在调用 WriteFileEx 时使用指向位于堆栈上的 OVERLAPPED 结构的指针。如果 WriteFileEx 未在 50 毫秒内完成，则挂起的 I/O 将引用一个不存在的 OVERLAPPED 结构，并且您将（希望）发生访问冲突（或者更糟的是，在您的应用程序中某处默默地损坏了堆栈数据）。

处理这些生命周期问题（如果性能不是大问题）的规范方法是使用自定义结构，其中包括 OVERLAPPED 结构和一些用于读取/写入数据的存储。在发布写入时分配结构并从 I/O 完成例程中释放结构。将包含的 OVERLAPPED 结构的地址传递给 WriteFileEx，并使用例如 offsetof 从完成例程中的 OVERLAPPED 地址获取自定义结构的地址。

另请注意，WriteFileEx 实际上并不使用 hEvent 成员 IIRC。

* * *

编辑：添加代码示例，请注意：

1.  我实际上并没有尝试编译代码，代码可能存在拼写错误或其他问题。
2.  这不是发送数据的最有效方式（为发送的每个字节分配/释放内存块）。不过，它应该很容易改进。

```
    #include <stddef.h>
    #include <assert.h>
    #include <windows.h>

    // ...
    typedef 结构 _MYOVERLAPPED
    {
        重叠的；
        字节缓冲区；
    MYOVERLAPPED，*LPMYOVERLAPPED；
    // ...

    static void CALLBACK write_compl（DWORD dwErrorCode，DWORD dwNumberOfBytesTransfered，LPOVERLAPPED lpOverlapped）
    {
        如果（NULL == lpOverlapped）
        {
            断言（！“永远不会发生”）；
            返回;
        }

        LPBYTE pOlAsBytes = (LPBYTE)lpOverlapped;
        LPBYTE pMyOlAsBytes = pOlAsBytes - offsetof(MYOVERLAPPED, ol);
        LPMYOVERLAPPED pMyOl = (LPMYOVERLAPPED)pOlAsBytes;

        if ((ERROR_SUCCESS == dwErrorCode) &&
            (sizeof(BYTE) == dwNumberOfBytesTransfered))
        {
            printf("写入 %uc\n", pMyOl->buffer);
        }
        别的
        {
            // 处理错误
        }

        自由（pMyOl）；
    }

    int write_port（句柄 hComm，BYTE 字节）{

       LPMYOVERLAPPED pMyOl = (LPMYOVERLAPPED)malloc(sizeof(MYOVERLAPPED));

       ZeroMemory(pMyOl, sizeof(MYOVERLAPPED));
       pMyOl->缓冲区=字节；

       // 发出写入。
       if (!WriteFileEx(hComm, &pMyOl->buffer, sizeof(BYTE), pMyOl, &write_compl )) {
          if (GetLastError() != ERROR_IO_PENDING) {
             // WriteFile 失败，但没有延迟。报告错误并中止。
              自由（pMyOl）；
              printf("最后一个错误：%ld",GetLastError());
              返回0；//失败，返回false；
          }
          别的 {
            返回-1；//待办的
          }
       }
       别的 {
            自由（pMyOl）；
            返回 1；//完成的
       }
    }

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:53:44.827

> ```
>  result = write_port(outPortHandle, 128);
>     result = write_port(outPortHandle, 131); 
> ```

lpBuf 参数必须是指向缓冲区的指针，而不是常量。

例如

```
char buffer;
buffer = 128;
result = write_port(outPortHandle, &buffer);
buffer = 131;
result = write_port(outPortHandle, &buffer); 
```

您真正想要做的也是传递缓冲区长度。

例如

```
 char buffer[]  = { 128, 131 };
    result = write_port(outPortHandle, &buffer, sizeof(buffer));

int write_port(HANDLE hComm,BYTE* lpBuf, size_t length) {

   ...

   // Issue write.
   if (!WriteFileEx(hComm, &lpBuf, length, &osWrite, &write_compl )) {
   ... 
```

# sql-server - T-SQL 中的多列透视

> ID：947281
> 
> 赞同：16
> 
> 时间：2009-06-03T21:11:30.417
> 
> 标签：sql-server, tsql

我正在使用一个表格，其中有多行需要转为列。因此，枢轴是解决此问题的完美解决方案，并且当我只需要一个字段时效果很好。我需要根据枢轴返回几个字段。这是去掉了细节的伪代码：

```
SELECT 
  field1,
  [1], [2], [3], [4]
FROM
  (
  SELECT 
    field1, 
    field2, 
    (ROW_NUMBER() OVER(PARTITION BY field1 ORDER BY field2)) RowID
  FROM tblname
  ) AS SourceTable
PIVOT
  (
  MAX(field2)
  FOR RowID IN ([1], [2], [3], [4])
  ) AS PivotTable; 
```

上面的语法效果很好，但是当我需要在 field3, field4.... 中找到更多信息时，我该怎么办？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-04T05:31:49.733

使用 MAX(CASE...) 和 GROUP BY 重写：

```
select 
  field1
, [1] = max(case when RowID = 1 then field2 end)
, [2] = max(case when RowID = 2 then field2 end)
, [3] = max(case when RowID = 3 then field2 end)
, [4] = max(case when RowID = 4 then field2 end)
from (
  select 
    field1
  , field2
  , RowID = row_number() over (partition by field1 order by field2)
  from tblname
  ) SourceTable
group by 
  field1 
```

从那里您可以添加 field3、field4 等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T16:05:25.797

对 row_number 进行多次透视的技巧是修改该行号序列以存储序列号和字段号。这是一个使用多个 PIVOT 语句执行您想要的操作的示例。

```
-- populate some test data
if object_id('tempdb..#tmp') is not null drop table #tmp
create table #tmp (
    ID int identity(1,1) not null,
    MainField varchar(100),
    ThatField int,
    ThatOtherField datetime
)

insert into #tmp (MainField, ThatField, ThatOtherField)
select 'A', 10, '1/1/2000' union all
select 'A', 20, '2/1/2000' union all
select 'A', 30, '3/1/2000' union all
select 'B', 10, '1/1/2001' union all
select 'B', 20, '2/1/2001' union all
select 'B', 30, '3/1/2001' union all
select 'B', 40, '4/1/2001' union all
select 'C', 10, '1/1/2002' union all
select 'D', 10, '1/1/2000' union all
select 'D', 20, '2/1/2000' --union all

-- pivot over multiple columns using the 1.1, 1.2, 2.1, 2.2 sequence trick
select
    MainField,
    max([1.1]) as ThatField1,
    max([1.2]) as ThatOtherField1,
    max([2.1]) as ThatField2,
    max([2.2]) as ThatOtherField2,
    max([3.1]) as ThatField3,
    max([3.2]) as ThatOtherField3,
    max([4.1]) as ThatField4,
    max([4.2]) as ThatOtherField4
from
    (
        select x.*,
            cast(row_number() over (partition by MainField order by ThatField) as varchar(2)) + '.1' as ThatFieldSequence,
            cast(row_number() over (partition by MainField order by ThatField) as varchar(2)) + '.2' as ThatOtherFieldSequence
        from #tmp x
    ) a
    pivot (
        max(ThatField) for ThatFieldSequence in ([1.1], [2.1], [3.1], [4.1])
    ) p1
    pivot (
        max(ThatOtherField) for ThatOtherFieldSequence in ([1.2], [2.2], [3.2], [4.2])
    ) p2
group by
    MainField 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T21:48:53.853

我不确定您是否正在使用 MS SQL Server，但如果您是……您可能想看看引擎的 CROSS APPLY 功能。基本上，它将允许您将表值 UDF 的结果应用于结果集。这将要求您将数据透视查询放入表值结果集中。

[http://weblogs.sqlteam.com/jeffs/archive/2007/10/18/sql-server-cross-apply.aspx](http://weblogs.sqlteam.com/jeffs/archive/2007/10/18/sql-server-cross-apply.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-19T18:07:08.520

用类似的东西包装你的 sql 语句：

```
select a.segment, sum(field2), sum(field3) 
from (original select with case arguments) a
group by a.segment 
```

它应该将您的结果折叠成一行，在 field1 上分组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-05T17:58:34.863

可以在多个列上进行透视，但您需要小心跨多个透视重用透视列。这是关于这个主题的一篇很好的博客文章：

[http://pratchev.blogspot.com/2009/01/pivoting-on-multiple-columns.html](http://pratchev.blogspot.com/2009/01/pivoting-on-multiple-columns.html)

# c# - 具有扩展选择模式的 WPF 列表框上的取消选择

> ID：947285
> 
> 赞同：5
> 
> 时间：2009-06-03T21:13:01.647
> 
> 标签：c#, wpf, listbox

我有一个带有扩展选择模式的简单列表框。选择工作几乎完美无缺，就像它在资源管理器中工作一样。但是取消选择并不是真的那么好。我想要的是，当我单击列表框中元素范围之外的内容时，我希望取消选择所有元素。默认情况下，我似乎并没有那样做，我做了一个肮脏的黑客，涉及 selectionchanged 和 mouseup 来破解它。但必须有更好的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T21:39:43.823

添加取消选择功能并没有那么脏，而且您走在正确的轨道上。主要问题是，默认情况下，ListBox 内的 ListBoxItems 将一直延伸，使得**不**点击一个非常困难。

这是一个示例 ListBox，它修改了默认的 ItemContainerStyle，以便项目仅占据列表的左侧，并且项目之间也有一些间距。

```
<ListBox SelectionMode="Extended"
         Width="200" Mouse.MouseDown="ListBox_MouseDown">
    <ListBox.ItemContainerStyle>
        <Style TargetType="{x:Type ListBoxItem}">
            <Setter Property="Background"
                    Value="LightBlue" />
            <Setter Property="Margin"
                    Value="2" />
            <Setter Property="Padding"
                    Value="2" />
            <Setter Property="Width"
                    Value="100" />
            <Setter Property="HorizontalAlignment"
                    Value="Left" />
        </Style>
    </ListBox.ItemContainerStyle>
    <ListBoxItem >Item 1</ListBoxItem>
    <ListBoxItem >Item 2</ListBoxItem>
    <ListBoxItem >Item 3</ListBoxItem>
    <ListBoxItem >Item 4</ListBoxItem>
</ListBox> 
```

要取消选择选定的项目，我们只需在 EventHandler 中将 SelectedItem 设置为 null。当我们点击一​​个 ListBoxItem 时，它会处理 MouseDown/Click 等来设置 SelectedItem 或修改 SelectedItems。正因为如此，以及 RoutedEvents 的性质，我们只是在需要的时候准确地处理 ListBox 中的 MouseDown。当单击 ListBox 内不属于某个项目的某个位置时。

```
private void ListBox_MouseDown(object sender, MouseButtonEventArgs e)
{
    (sender as ListBox).SelectedItem = null;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-05T07:07:27.203

我用过 myListBox。**SelectedItems.Clear()**。大多数选定项集合是只读的，但不是列表框。

# c# - Silverlight - 通过 C# 加载 XAML 文件（就像在 WinForms 时代一样） - 如何？

> ID：947286
> 
> 赞同：1
> 
> 时间：2009-06-03T21:13:02.943
> 
> 标签：c#, silverlight, xaml

所以我是来自 WinForms 背景的 SL 新手，我可以像这样实例化 UserControl 或 Form：

```
MyForm frm = new MyForm();
frm.ShowDialog(); 
```

所以在 SL 中，我创建了一个简单的 Page.xaml 和第二个名为 Page2.xaml 的 xaml 文件 - 我在 Page.xaml 文件中放置了一个按钮，在该按钮的点击事件中，我尝试添加以下内容来调用第二个 xaml 文件：

```
private void btnLoad_Click(object sender, RoutedEventArgs e)
{
    Page2 frm2 = new Page2();
    frm2\.  // ?? don't know what write here ??
} 
```

如何调用 XAML 用户控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T21:27:43.363

为了导航到一个完全不同的 Silverlight 页面，您需要一个“容器”用户控件，其中包含您的主页。从那里您可以像这样设置您的内部 UserControl：

```
insideControl = new Page2(); 
```

欲了解更多信息： [http ://silverlight.net/learn/learnvideo.aspx?video=56933](http://silverlight.net/learn/learnvideo.aspx?video=56933)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-26T07:54:05.577

您可以使用 ChildWindow.Xaml 并在 Mainpage.xaml 中创建子控件的实例

```
ChildWindow chw = new ChildWindow();
chw.show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T23:03:40.347

[XamlReader](http://msdn.microsoft.com/en-us/library/system.windows.markup.xamlreader.aspx)类正是为此目的而开发的。使用其 Load 或 Parse 方法将返回您的 Xaml 生成的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T21:23:32.420

我相信在silverlight 中你真正需要做的是导航到一个单独的页面。

它是一个 web 平台，所以 Navigate 是 winforms 的 web 形式。显示（）方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-28T11:07:57.120

您必须从 page.xaml 和 page2.xaml 创建一个 UserControl.xaml 容器

这个容器有一个带有 x:Name="miGrid" 的网格：

< 网格 x:Name="miGrid" />

在您加载此控件的子项后，在本例中为用户控件的实例 frm2..

miGrid.Childrens.Clear(); miGrid.Childrens.Add(frm2);

# wpf - 使工具栏按钮样式应用于工具栏中的用户控件

> ID：947293
> 
> 赞同：7
> 
> 时间：2009-06-03T21:14:47.167
> 
> 标签：wpf, user-controls, toolbar

如何强制工具栏内的 WPF 中的用户控件使用工具栏的默认按钮样式？

我有一个名为 ImageButton 的简单用户控件，它的 XAML 如下所示：

```
<UserControl x:Class="myNameSpace.ImageButtonUserControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Name="imageButton"
    >
    <Button Style="{Binding ElementName=imageButton, Path=ButtonStyle}">
        <StackPanel Orientation="Horizontal">
            <Image Source="{Binding ElementName=imageButton, Path=ImageSource}"
                   VerticalAlignment="Center" 
                   />
            <TextBlock Text="{Binding ElementName=imageButton, Path=Text}" 
                       Style="{Binding ElementName=imageButton, Path=TextStyle}"
                       VerticalAlignment="Center"
                       />
        </StackPanel>
    </Button>
</UserControl> 
```

对于这些绑定路径，我在后面的代码中有一些依赖属性，并且一切正常。

直到我把它放在一个工具栏中。通常，当您将按钮放在 ToolBar 中时，它们会被 ToolBar 重新设置样式，使其看起来像工具栏按钮。我发现了如何更改此样式（请参阅[ToolBar.ButtonStyleKey](http://msdn.microsoft.com/en-us/library/system.windows.controls.toolbar.buttonstylekey.aspx)。但是如何将已定义的样式应用于我的用户控件的按钮样式依赖项属性？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-04T04:44:11.087

哦，对不起！我误解了你的问题。试一试：

```
<Button Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}">
    Hello, world!
</Button> 
```

该样式仅针对按钮，因此只能应用于按钮。（从您的评论来看，这不会是一个问题。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T23:01:59.540

我找到了一种似乎可行的方法，尽管我对解决此问题的其他方法感兴趣。

我向我的 UserControl 添加了一个加载的事件处理程序并将其放入其中。

```
if (button.Style == null && this.Parent is ToolBar)
{
    button.Style = (Style)FindResource(ToolBar.ButtonStyleKey);
} 
```

其中 button 是我的 UserControl 中按钮的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T22:20:34.817

你需要一些强大的黑魔法才能让它自动为你的用户控件创建一个有效的新样式。您可以添加到工具栏的每种类型的内置控件都有内置样式。（请注意 ToolBar.ButtonStyleKey 并不孤单。）您需要自己制作和应用与标准工具栏元素匹配的自己的样式。

# mysql - 如何使 MySQL 的 NOW() 和 CURDATE() 函数使用 UTC？

> ID：947299
> 
> 赞同：53
> 
> 时间：2009-06-03T21:15:37.930
> 
> 标签：mysql, timezone, utc

我想让它在 MySQL 查询中调用 NOW() 和 CURDATE() 以 UTC 格式返回日期。如何在不经历和更改使用这些函数的所有查询的情况下实现这一点？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-03T21:37:12.877

终于找到了我要找的东西...

在 my.cnf 中，

```
[mysqld_safe]
timezone = UTC 
```

我把这个选项放在 [mysqld] 下，mysql 无法启动。

调用“SET time_zone='+0:00';” 在每个页面加载上也可以工作，但我不喜欢在每个页面加载时调用该查询的想法。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-06-03T21:19:12.087

将服务器的时钟设置为 UTC。不完全是。

如果你能做到，就去做。

最令人头疼的问题之一是在本地时区运行的“cron”作业等，这意味着一些 cron 作业将每年错过一次，而其余所有作业在 GMT 的不同时间运行半年（我假设您所在的时区有夏令时）。

MySQL 支持时区，但它很疯狂而且很混乱。如果不需要，请不要使用它。只需将服务器的时钟设置为 UTC，时间就会开始正常工作。

我知道更改服务器时钟对于任何托管系统来说都是一项重大更改，并且您可能有大量服务器和服务可能会受到影响，但无论如何请尝试这样做。质量检查工作可能很重要，但请尝试。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2019-06-11T05:50:37.973

```
UTC_TIMESTAMP() 
```

以 'YYYY-MM-DD hh:mm:ss' 或 YYYYMMDDhhmmss.uuuuuu 格式返回当前 UTC 日期和时间，具体取决于函数是在字符串还是数字上下文中使用。

```
UTC_DATE() 
```

将当前 UTC 日期作为 'YYYY-MM-DD' 或 YYYYMMDD 格式的值返回，具体取决于函数是在字符串还是数字上下文中使用。

```
UTC_TIME() 
```

以 'hh:mm:ss' 或 hhmmss.uuuuuu 格式返回当前 UTC 时间，具体取决于函数是在字符串还是数字上下文中使用。

MySQL 参考：[https ://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_utc-timestamp](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_utc-timestamp)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-04-13T15:08:00.730

转到 /etc/mysql/my.cnf 文件并在 [mysqld] 部分下添加以下行

> 默认时区 = '+00:00'

然后重启你的mysql。现在选择 curtime(); 显示格林威治标准时间。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-03-03T05:08:07.320

如果更改正在运行的生产服务器上的时区或更新关键配置设置并重新启动 mysql 似乎不切实际和/或矫枉过正，请尝试以下操作：

```
CONVERT_TZ(NOW(), 'US/Pacific', 'UTC') 
```

`US/Pacific`您的`NOW()`通话返回时间的时区在哪里。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-03T21:23:57.710

正如 MarkR 所说，正确的方法是将服务器的时区更改为 UTC。

但是，也可以使用[SET time_zone](http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html)更改当前会话的时区。

从手册：

> 当前会话时区设置会影响对区域敏感的时间值的显示和存储。这包括由 NOW() 或 CURTIME() 等函数显示的值

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T21:21:39.790

您将需要使用 SET TIMESTAMP 语句将日期时间结果格式化为所需格式。这将意味着更改所有这些查询。sysdate() 不会遵守这一点。

# iphone - 我可以在没有源代码的情况下将应用程序安装到模拟器吗？

> ID：947317
> 
> 赞同：25
> 
> 时间：2009-06-03T21:20:22.240
> 
> 标签：iphone, cocoa-touch, xcode

我有一个客户只想拖放二进制文件以在模拟器中运行它。

我想构建模拟器应用程序并将其通过电子邮件发送给他们。

客户端可以做些什么来在模拟器中安装它？

这可能吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2015-12-18T05:13:04.953

您可以通过在终端应用程序中执行以下命令。

`xcrun simctl install {simulator_udid} {path of .app file}`

它将`.app`在引用的模拟器中安装文件。

注意：确保 .app 文件是为模拟器构建的（即`i386`或`x86_64`）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T21:52:25.750

只要它们与您的目标操作系统版本相同，就可以了。在您的本地计算机上查看此处：

~/图书馆/应用程序支持/iPhone模拟器/用户/应用程序/

那是存储应用程序的地方。

观看此目录并获取安装应用程序时添加的所有内容。然后，您可以压缩这些材料并让您的客户在同一路径下解压缩它们。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T06:13:22.093

正如我之前的海报所说，您将在此文件夹中找到应用程序：

~/图书馆/应用程序支持/iPhone模拟器/用户/应用程序/

我需要复制以下两个文件：

*   具有神秘名称的文件夹（接缝是一些哈希）
*   以及一个与文件夹同名且后缀为 .sb 的文件

将它们放在第二台计算机上的相同位置并在那里启动模拟器：

/Developer/Platforms/iPhoneSimulator.platform/Developer/Applications

我已经在我的工作计算机和没有安装证书的家用计算机上对此进行了测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-04T07:20:21.937

我有同样的需求，并在 iOS 5 模拟器中解决了这个问题。

您需要至少运行一次应用程序。然后你可以在文件夹路径下找到你的应用程序

~/Library/Application Support/iPhone Simulator/'模拟器版本'/Applications/

这些文件夹将有一个散列名称。找到包含您的应用程序的文件夹，然后从该文件夹中复制 AppName.app 文件。现在您可以将该文件发送给您的客户。

客户端将在与上述相同的文件夹路径下创建一个文件夹，并使用任何名称复制 AppName.app 文件并打开模拟器。瞧……他们会看到应用程序安装在模拟器中。

# grails - 使用 Apache Camel 插件安装 Grails

> ID：947330
> 
> 赞同：0
> 
> 时间：2009-06-03T21:21:48.447
> 
> 标签：grails, apache-camel

我无法让 Apache Camel 插件在 grails-1.1.1 中运行。这是我采取的步骤：

```
$ grails create-app camelapp
Welcome to Grails 1.1.1 - http://grails.org/
...

$ cd camelapp

$ grails run-app
...
Running Grails application..
Server running. Browse to http://localhost:8080/camelapp

$ grails install-plugin camel
...
Camel Route directory was created.
Plugin camel-0.2 installed
Plug-in provides the following new scripts:
------------------------------------------
grails create-route

$ grails run-app
...
[groovyc] org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed, Compile error during compilation with javac.
  [groovyc] /Users/abdullah/.grails/1.1.1/projects/camelapp/plugins/camel-0.2/src/java/org/ix/grails/plugins/camel/ClosureProcessor.java:22: method does not override a method from its superclass
  [groovyc]     @Override
  [groovyc]          ^
...
: Compilation Failed
    at org.codehaus.groovy.ant.Groovyc.compile(Groovyc.java:807)
    at org.codehaus.groovy.ant.Groovyc.execute(Groovyc.java:540)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at _GrailsCompile_groovy$_run_closure3_closure7.doCall(_GrailsCompile_groovy:102)
    at _GrailsCompile_groovy$_run_closure3_closure7.doCall(_GrailsCompile_groovy)
    at _GrailsSettings_groovy$_run_closure10.doCall(_GrailsSettings_groovy:274)
    at _GrailsSettings_groovy$_run_closure10.call(_GrailsSettings_groovy)
    at _GrailsCompile_groovy$_run_closure3.doCall(_GrailsCompile_groovy:89)
    at _GrailsCompile_groovy$_run_closure2.doCall(_GrailsCompile_groovy:55)
    at _GrailsPackage_groovy$_run_closure2_closure9.doCall(_GrailsPackage_groovy:79)
    at _GrailsPackage_groovy$_run_closure2_closure9.doCall(_GrailsPackage_groovy)
    at _GrailsSettings_groovy$_run_closure10.doCall(_GrailsSettings_groovy:274)
    at _GrailsSettings_groovy$_run_closure10.call(_GrailsSettings_groovy)
    at _GrailsPackage_groovy$_run_closure2.doCall(_GrailsPackage_groovy:78)
    at RunApp$_run_closure1.doCall(RunApp.groovy:28)
    at gant.Gant$_dispatch_closure4.doCall(Gant.groovy:324)
    at gant.Gant$_dispatch_closure6.doCall(Gant.groovy:334)
    at gant.Gant$_dispatch_closure6.doCall(Gant.groovy)
    at gant.Gant.withBuildListeners(Gant.groovy:344)
    at gant.Gant.this$2$withBuildListeners(Gant.groovy)
    at gant.Gant$this$2$withBuildListeners.callCurrent(Unknown Source)
    at gant.Gant.dispatch(Gant.groovy:334)
    at gant.Gant.this$2$dispatch(Gant.groovy)
    at gant.Gant.invokeMethod(Gant.groovy)
    at gant.Gant.processTargets(Gant.groovy:495)
    at gant.Gant.processTargets(Gant.groovy:480)
Caused by: org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed, Compile error during compilation with javac.
/Users/abdullah/.grails/1.1.1/projects/camelapp/plugins/camel-0.2/src/java/org/ix/grails/plugins/camel/ClosureProcessor.java:22: method does not override a method from its superclass
    @Override
         ^
...
Compilation error: Compilation Failed

$ java -version
java version "1.6.0_07"
Java(TM) SE Runtime Environment (build 1.6.0_07-b06-153)
Java HotSpot(TM) 64-Bit Server VM (build 1.6.0_07-b06-57, mixed mode) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-14T15:56:17.667

这个问题有一个[JIRA](http://jira.codehaus.org/browse/GRAILSPLUGINS-1253?page=com.atlassian.jira.plugin.system.issuetabpanels%3Aall-tabpanel) 。尝试只删除 ClosureProcessor.java 文件上的 @Override。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T17:55:02.907

看来您使用的是 JDK5，它不允许`@Override`接口实现。您需要将JDK6设置为默认JVM，JDK6允许`@Override`接口实现。

您还可以为 apache camel 插件所有者打开 jira 以删除注释，尽管 JDK5 不会持续太久。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-17T13:29:23.767

似乎用于 grails 开发的骆驼插件已被冻结。除此之外，它还使用了相当过时的骆驼 1.6.0。如果您计划有一天迁移到 camel2 - 您显然会在使用骆驼插件时遇到问题。

我不建议你在你的项目中使用它，最好手动添加骆驼支持，以及你需要的引导功能（例如sendMessage）。我已经这样做了。如果您需要更多提示，请与我联系。

# windows - 窗口内的 DirectX 覆盖

> ID：947343
> 
> 赞同：1
> 
> 时间：2009-06-03T21:24:26.117
> 
> 标签：windows, graphics, directx, overlay

我需要能够在屏幕上的任何位置设置覆盖图形区域（通过 DirectX/DirectDraw 方法），或者至少在窗口区域内使用它。任何人都能够做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T22:38:18.993

我认为您想要的是[“分层窗口”](http://msdn.microsoft.com/en-us/library/ms997507.aspx)。这是[一个示例](http://www.dhpoware.com/demos/layeredWindows.html)，展示了如何使用 DirectX（和 OpenGL）进行分层窗口。

分层窗口可让您使您的普通窗口框架透明（或半透明），以便您绘制的内容看起来“漂浮”在桌面和其他窗口上方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-20T03:24:22.033

我们最近创建了一个类似的应用程序，其中我们使用 C# 处理所有 GUI 内容，使用 DirectX 处理窗口内的快速 3D。C# 非常适合快速 GUI 开发，但 GDI+ 对我们的程序来说不够快。因此，我们在 C# 窗口内的 Panel 中覆盖了 WndPrc 函数，并将鼠标事件和绘画的所有控制权转移到 C++ dll。结果很顺利，让我们将快速应用程序开发的各个方面与复杂的 3D 后端结合在一起。

# iphone - 从 imagePickerController 中选择的 Quartz 拉伸图像

> ID：947344
> 
> 赞同：2
> 
> 时间：2009-06-03T21:24:27.210
> 
> 标签：iphone, cocoa-touch, quartz-graphics, uiimagepickercontroller

我有一个应用程序，允许用户从相机或照片库中选择图像。然后它将该图像放置在 ImageView 中。然后我使用 Quartz 从该图像视图中获取图像并将其与一些基本叠加层等一起渲染。

问题在于，当从相机或相机胶卷中拾取图像时，Quartz 会以 90 度旋转绘制图像并垂直拉伸图像。从照片库中选择任何其他照片时没有问题。如果allowImageEditing 设置为YES，则不会出现此问题。

如果有人可以阐明它会有所帮助，我是这方面的新手。

我的 CameraViewController 中的代码

```
#pragma mark -
- (IBAction)getCameraPicture {
     UIImagePickerController *picker = [[UIImagePickerController alloc] init];
     picker.navigationBar.barStyle = UIBarStyleBlackOpaque;
     picker.delegate = self;
     picker.allowsImageEditing = NO; //seems to fix the weird rotation & stretching issues if set to YES
     picker.sourceType = UIImagePickerControllerSourceTypeCamera;
     [self presentModalViewController:picker animated:YES];
     //[picker release];
}
- (IBAction)selectExistingPicture {
     if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypePhotoLibrary]) {
     UIImagePickerController *picker = [[UIImagePickerController alloc] init];
     picker.navigationBar.barStyle = UIBarStyleBlackOpaque;
     picker.delegate = self;
     picker.allowsImageEditing = NO; //seems to fix the weird rotation & stretching issues if set to YES (only with camera roll)
     picker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
     [self presentModalViewController:picker animated:YES];
     //[picker release];
     }
}
#pragma mark -
- (void)imagePickerController:(UIImagePickerController *)picker 
 didFinishPickingImage:(UIImage *)image
   editingInfo:(NSDictionary *)editingInfo {

     imageView.image = image;
     NSLog(@"imagePicker image size %.0f x %.0f", image.size.width, image.size.height);
     [picker dismissModalViewControllerAnimated:YES];
     [picker release];
     [quartzContextView setNeedsDisplay];
     [self setUpAndRenderImage];

}
- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker {
     [picker dismissModalViewControllerAnimated:YES];
     [picker release];
} 
```

绘制 Quartz 的视图中的代码

```
NSLog(@"Quartz image size %.0f x %.0f", drawImageTwo.size.width, drawImageTwo.size.height);
if (drawImageTwo.size.width >= drawImageTwo.size.height)
{
     scaleFactor = (insideHeight+5)/drawImageTwo.size.height;
     xOffset = (drawImageTwo.size.width*scaleFactor - insideWidth)/2;
     yOffset = 0;
     NSLog(@"Image is Landscaepe");
}
else if (drawImageTwo.size.width < drawImageTwo.size.height)
{
     scaleFactor = (insideWidth+5)/drawImageTwo.size.width;
     yOffset = (drawImageTwo.size.height*scaleFactor - insideHeight)/2;
     xOffset = 0;
     NSLog(@"Image is Portrait");
}

//draw Photo Base
CGRect baseRect = CGRectMake(0.0, 0.0, width, height);
CGContextDrawImage (context, baseRect, drawImage.CGImage);

//clip all further drawing to context clip
CGContextClipToRect(context, CGRectMake(leftOffset, (height-insideHeight-topOffset), insideWidth, insideHeight));

//draw Photo
CGRect photoRect = CGRectMake(leftOffset-xOffset, (height-insideHeight-topOffset)-yOffset, drawImageTwo.size.width*scaleFactor, drawImageTwo.size.height*scaleFactor);
CGContextDrawImage (context, photoRect, drawImageTwo.CGImage); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-02T21:33:38.183

您遇到的问题来自不同的坐标系和 UIKit 和 CoreGraphics 中图像方向的处理。

UIImage 知道它的方向，即第一次拍摄图像时相机的方向。只要您使用 UIKit 类，一切都会按预期工作，但是当您获得 UIImage 的原始 CGImage 时，您会丢失此信息。您必须通过转换 CGContext 的 CTM（当前转换矩阵）来为自己考虑图像方向。

但是，CoreGraphics 使用的坐标系不够多，原点位于屏幕左下角，而 UIKit 的原点位于左上角。请参阅 Quartz 2D 编程指南章节“图形上下文”。您必须将 CTM 缩放 0,-1 并将其转换为高度以解决此问题。

在您的示例中，由于您没有对图像进行花哨的处理，因此尝试 UIImages drawInRect: 方法似乎最合适，该方法已经解决了这两个问题。

# javascript - javascript：具有指定字段的多个表单

> ID：947345
> 
> 赞同：0
> 
> 时间：2009-06-03T21:24:30.593
> 
> 标签：javascript, html

这可能是一个非常基本的 javscript 问题，但在这里。说我有 2 个动态生成的表格

```
<form name=test1 method=get action=insertaction> 
    <input type=text name=desc value=2>
    <input type=button onclick="document.test1.submit();" value=submit>
</form>

<form name=test2 method=get action=insertaction> 
    <input type=text name=desc value=3>
    <input type=button onclick="document.test2.submit();" value=submit>
</form>
```

这两个表格上的代码有什么问题吗？他们似乎将 null 传递给动作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T21:49:50.137

首先，属性值应该用引号括起来：name="test1" 等。

表单动作是文件的路径吗？因为它应该作为表单在提交时传递给这个文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T22:06:50.883

当您单击提交按钮时，您的 onclick 会告诉您的表单提交。每当您提交表单时，您指定的操作决定了表单数据的处理方式。

您的 action=insertaction 应该类似于 action="processData.php"。这个 processData.php 文件是您在处理表单字段数据时放置逻辑的地方。您需要根据服务器上可用的技术以不同方式处理表单处理逻辑。我的示例表明 php 在服务器上可用。一些服务器将有一个 cgi-bin 并允许您使用 perl，或者您可能正在处理 asp。大多数托管 Web 文件的地方都会提供某种文档，让您知道可以使用什么，甚至应该有示例。

尝试 W3Schools 了解有关表单基础知识的更多信息：[W3Schools Form Info](http://www.w3schools.com/html/html_forms.asp)

# apache-flex - 如何按行分割文本

> ID：947347
> 
> 赞同：0
> 
> 时间：2009-06-03T21:24:46.757
> 
> 标签：apache-flex, flash, actionscript, mxml

弹性 3。

我创建了一个 TextArea 对象。然后我在里面输入了一些文字。然后我使用 TextArea.text 属性得到了这个文本。

如何拆分按行获得的文本并将其转换为字符串数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T23:13:03.433

如果“\n”对您不起作用，请尝试“\r”（回车）。这里有一些代码演示了它是如何工作的——只需在框中输入，你就会看到数组内容发生了变化：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" creationComplete="onCreationComplete(event)">

    <mx:Script>
        <![CDATA[

            import mx.events.CollectionEvent;
            import mx.collections.ArrayCollection;
            import mx.events.FlexEvent;

            [Bindable]
            private var ac:ArrayCollection;

            protected function onCreationComplete(event:FlexEvent):void
            {
                ac = new ArrayCollection();
                ac.addEventListener(CollectionEvent.COLLECTION_CHANGE, onCollectionChange);     
            }

            protected function onKeyUp(event:KeyboardEvent):void
            {
                ac.source = event.target.text.split("\r");
            }

            protected function onCollectionChange(event:CollectionEvent):void
            {
                contents.text = ac.source.join("\r");           
            }

        ]]>
    </mx:Script>

    <mx:TextArea id="input" x="19" y="22" width="273" height="175" keyUp="onKeyUp(event)" />
    <mx:TextArea id="contents" x="112" y="249" width="180" height="175" editable="false" />
    <mx:Label x="19" y="222" text="Array Length:" fontWeight="bold" />
    <mx:Label x="37" y="250" text="Contents:" fontWeight="bold" />
    <mx:Label x="111" y="222" text="{ac.length}" />

</mx:Application> 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:30:40.270

“按行分割”对您意味着什么？通常的做法是扫描文本以查找 textwidth 之前的最后一个空白，并将其称为一行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T21:31:53.810

根据[这个站点](http://livedocs.adobe.com/flex/3/html/help.html?content=textcontrols_03.html)，换行符的字符是“\n”。使用带有 "\n" 的 Split() 函数，您应该能够将字符串拆分为由换行符分隔的字符串数组。

# gmail - 如何在共享托管环境中从同名的网络服务器（使用 sendmail）向我的谷歌应用程序邮件服务器发送邮件？

> ID：947348
> 
> 赞同：1
> 
> 时间：2009-06-03T21:24:54.383
> 
> 标签：gmail, sendmail

我遇到了与[此问题中提出的问题类似的问题](https://stackoverflow.com/questions/524224/how-do-i-send-mail-to-my-google-apps-mail-server-from-the-webserver-with-the-same)。

sendmail（通过 PHP）将发送一封电子邮件，除非它的地址与其所在的服务器具有相同的域。

我知道这是因为 sendmail 正在尝试在本地发送电子邮件。

我对服务器的控制有限，因为它是一个共享的托管环境。我几乎仅限于配置 php.ini 和修改 php。在这些限制范围内，有没有办法告诉 sendmail 做我想做的事？

如果做不到这一点，我看到的唯一其他选择是使用 SMTP 并让谷歌发送电子邮件，这似乎有点矫枉过正，因为 sendmail 已经准备好使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-22T02:32:04.227

我不知道，但如果可以，请联系您的主机并要求他们从以下位置删除您的域名：

/etc/mail/本地主机名

如果您使用 qmail，请从

/var/qmail/control/虚拟域

（地点可能有所不同）

# sql-server - 聚合函数不能作为合并代表出版物中的文章使用

> ID：947350
> 
> 赞同：0
> 
> 时间：2009-06-03T21:25:17.690
> 
> 标签：sql-server, winforms, replication, aggregate-functions

我设置了合并复制，但我刚刚注意到我的订阅服务器上没有聚合函数。经过进一步调查，我发现出版物中甚至没有此选项。那里列出了其他功能，但不是那个。

想法？

有没有什么东西不允许聚合在复制方案中？如果是这样，我将如何将其发送给我当地的数据库？

下面是聚合函数的 CREATE TO。谢谢！

```
USE [Connect]
GO
/****** Object:  UserDefinedAggregate [dbo].[CommaDelimitedString]    Script Date: 06/03/2009 16:21:07 ******/
CREATE AGGREGATE [dbo].[CommaDelimitedString]
(@value [nvarchar](4000))
RETURNS[nvarchar](4000)
EXTERNAL NAME [SqlServerProject1].[SqlServerProject1.CommaDelimitedString]
GO
EXEC sys.sp_addextendedproperty @name=N'AutoDeployed', @value=N'yes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'AGGREGATE',@level1name=N'CommaDelimitedString'
GO
EXEC sys.sp_addextendedproperty @name=N'SqlAssemblyFile', @value=N'CommaDelimitedString.vb' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'AGGREGATE',@level1name=N'CommaDelimitedString'
GO
EXEC sys.sp_addextendedproperty @name=N'SqlAssemblyFileLine', @value=12 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'AGGREGATE',@level1name=N'CommaDelimitedString' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T20:10:05.777

对我来说，它看起来像是 CLR 用户定义的聚合。据我所知，这些无法使用复制进行传输，但必须事先安装在每个参与的数据库中。

# javascript - Javascript 闭包和数据可见性

> ID：947352
> 
> 赞同：12
> 
> 时间：2009-06-03T21:25:23.807
> 
> 标签：javascript, closures

我试图围绕类、数据可见性和闭包（特别是在 Javascript 中）的想法来思考，我在类型的 jQuery 文档页面上，它提到闭包用于隐藏数据：

> 该模式允许您使用对外部不可见的数据进行操作的方法来创建对象——这是面向对象编程的基础。

这个例子：

```
function create() {
  var counter = 0;
  return {
    increment: function() {
      counter++;
    },
    print: function() {
      console.log(counter);
    }
  }
}
var c = create();
c.increment();
c.print(); // 1 
```

通过使用关键字 var 声明变量 counter，它已经在函数/类定义中局部作用域。据我所知，从一开始就无法从外部访问它。从数据可见性的角度来看，我是否遗漏了一些东西。

其次，写上面的类和下面的类是否有优势：

```
function create() {
  var counter = 0;
  this.increment = function() {
      counter++;
  }
  this.print = function() {
      console.log(counter);
  }
  return this;
}
var c = create();
c.increment();
c.print(); // 1 
```

据我了解，这些在语义上或多或少是相同的——第一个只是更多的“jQuery 风格”。我只是想知道第一个例子中是否有我没有完全理解的优势或其他细微差别。如果我是正确的，这两个示例都创建了闭包，因为它们正在访问在自己的范围之外声明的数据。

[http://docs.jquery.com/Types#Closures](http://docs.jquery.com/Types#Closures)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T21:35:05.800

首先，两个版本都使用闭包是正确的。

第一个版本更干净（在我看来）并且在现代 javascript 中更受欢迎。第一种样式的主要潜在缺点是您无法有效地将对象分配给构造函数的原型，如果您要创建大量相同的对象，这很有用（并且更有效）。

第二种风格，我实际上从未在生产 Javascript 中见过。通常，您将使用 实例化`create`，而不是在函数`new`中返回，如下所示：`this``create()`

```
function create() {
  var counter = 0;
  this.increment = function() {
      counter++;
  }
  this.print = function() {
      console.log(counter);
  }
}
var c = new create();
c.increment();
c.print(); // 1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T21:42:06.003

> 通过使用关键字 var 声明变量 counter，它已经在函数/类定义中局部作用域。据我所知，从一开始就无法从外部访问它。从数据可见性的角度来看，我是否遗漏了一些东西。

`counter`并不是一开始就无法从函数外部访问该变量，而是在函数退出后它可以被`increment`and`print`函数访问，`create`这使得[闭包](http://www.jibbering.com/faq/faq_notes/closures.html)如此有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T21:39:03.827

好吧，我不在乎就如何在 JavaScript 中创建对象而陷入宗教战争，因为有些人强烈认为有正确和错误的方法来做到这一点。

但是，我想在您的第二组代码中指出一些不太有趣的东西 - 即，您正在为`this`关键字中包含的对象分配新属性这一事实 - 您是否意识到该对象是什么？除非您使用如下实例化语法，否则它不是空对象：

```
var c = new create(); 
```

当你这样做时，`this`构造函数主体内的关键字被分配了一个全新的对象，就好像主体中的第一行是这样的：

```
this = {}; 
```

但是当你`create()`作为一个函数调用时，就像你在那个例子中所做的那样，你正在改变函数定义之外的范围（正如@seanmonster 在评论中提到的那样）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T21:41:52.510

您应该将该示例与此代码段进行比较

```
function create() {
  this.counter = 0;
  this.increment = function() {
      this.counter++;
  };
  this.print = function() {
      console.log(counter);
  }
}

var c = new create();
c.increment();
c.print(); // 1 
```

因此，当调用 new create() 时，它会使用两种方法和一个实例变量（即：计数器）初始化新对象。Javascript 本身没有封装，因此您可以访问 c.counter，如下所示：

```
var c = new create();
c.increment();
c.counter = 0;
c.print(); // 0 
```

通过使用闭包（如您的示例所示），计数器现在不再是一个实例字段，而是一个局部变量。一方面，您不能从 create() 函数外部访问。另一方面， increment() 和 print() 可以访问，因为它们关闭了封闭范围。所以我们最终得到了一个很好的对象封装模拟。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T21:33:32.620

您的第二个示例仍然使用闭包，因为 increment 和 print 函数仍然作用于变量，否则超出范围 - 当您调用`c.increment()`create 函数时已经退出。

我喜欢第一个示例，因为它避免了 " `this`" 关键字，并且在 javascript 中 " `this`" 可能很棘手——它并不总是指它看起来应该的样子。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T21:40:47.410

Christian Heilmann 有一篇关于您描述[的模块模式](http://www.wait-till-i.com/2007/07/24/show-love-to-the-module-pattern/)的相当不错的文章，它可能会帮助您理解它以及它为什么有用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-31T08:09:10.107

对于来自 OOP 背景的我来说，这种语法更有意义：

```
Create = function {
  // Constructor info.

  // Instance variables
  this.count = 10;
}

Create.prototype = {

     // Class Methods
     sayHello : function() {
          return "Hello!";
     },

     incrementAndPrint : function() {
          this.count++;

          // Inner method call.
          this.print();
     },

     print : function() {
         return this.count;
     }

}

var c = new Create();
alert(c.incrementAndPrint()); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-06T03:15:50.133

```
MYAPP = (function(){
   var v1,v2;
   return {
    method1:function(){},
    method2:function(){}
   };
})(); 
```

我总是在我的应用程序中使用这样的闭包，就像这样做一样，我自己定义的所有方法都在 MYAPP 命名空间中，v1 和 v2 只能由 MYAPP 中的方法访问。在我的应用程序中，我经常只写一个“app.js”文件，里面有我所有的js代码。我想你可以定义一个名为“registy”的方法来定义 MYAPP 中的私有变量，然后你可以在你的方法中使用它。当你想在 html 文件中添加额外的代码时，所有额外的变量和方法都应该由 registy 方法定义，就像 JQuery.extend 方法一样。我听说如果在 IE 浏览器中使用过多的闭包，很容易导致堆栈溢出。（在我看来）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T21:54:33.810

在您的第二个示例中，当您`create()`在函数范围内调用 时，`this`是全局对象（当您调用“裸”函数时总是如此，而不将其用作构造函数或将其作为属性访问（例如“方法”调用））。在浏览器中，全局对象是`window`. 因此，当您随后调用 create 时，它​​会创建新的闭包，但随后您将它们分配给与以前相同的全局对象，覆盖旧函数，这不是您想要的：

```
var c = create(); // c === window
c.increment();
c.print(); // 1
var c2 = create(); // c2 === c === window
c.print(); // 0
c2.print(); // 0
increment(); // called on the global object
c.print(); // 1 
c2.print(); // 1 
```

正如其他人指出的那样，解决方案是使用`new create()`.

# php - AJAX 以及如何在 PHP 中最好地处理它的服务器端

> ID：947358
> 
> 赞同：2
> 
> 时间：2009-06-03T21:27:12.600
> 
> 标签：php, ajax, model-view-controller, codeigniter

我开始写很多 ajax 重的网站，但我从来没有真正阅读过最佳实践，现在我也想要我找不到一篇文章来解决我想知道的内容。我真正想了解的是处理 AJAX 调用服务器端，例如，是否所有数据都应该使用 JSON/XML 传回，.. 还是纯 HTML 很好，你是否应该尽量不要将两者混合用于单个功能根据结果​​调用。此外，由于我主要使用 CodeIgniter（一个 MVC 框架）进行编程，你如何最好地从 AJAX 结果中分离出正常的页面加载请求。

我可以制作 AJAX 网站，但我真的很想知道如何最好地制作 AJAX 网站，如果人们能提供一些启发或指出我正确的方向，我将非常感激。

谢谢汤姆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-04T18:01:13.910

我最近使用 CodeIgniter 完成了一个 AJAX 重度站点，并在此过程中学到了很多东西。这些是我学到的一些东西（阅读：我犯的错误）：

**不要从同一方法返回 html 页面和 json。**

起初，这样的设置似乎是个好主意：

/控制器/方法/格式

其中格式的默认值为“html”。我的想法是，我可以让 /object/view 之类的东西显示该对象的 html 页面，并让 /object/view/json 之类的东西返回该对象的 json 数据。

在实践中，这会使事情变得非常混乱。您最终在一个方法中混合了许多不同的功能，这使代码变得更加复杂。伊克。

相反，我现在要做的是在应用程序/控制器下添加一个“api”子文件夹。该子文件夹中的控制器仅返回 json 数据。干净多了。

**不要在 javascript 中重新实现你的模板**

通过 AJAX 调用获取内容时有两种方法。您可以返回某种编码数据（JSON、XML）并将其插入页面上的正确位置。或者您可以渲染一大块 html，然后将其插入到某个 div 中。

如果你走数据路线，请尝试坚持非常简单的标记结构，例如跨度或简单的无序列表。在我的例子中，我有一部分导航是从服务器作为 JSON 编码链接数组返回的。

然后，我的 javascript 会以正确的菜单结构将它们吐出。当菜单变得更复杂时，我的脚本包含了这种复杂性。现在该菜单的标记在 CI 模板和 javascript 中重复。

在这种情况下，最好让服务器返回一个包含菜单标记的 html 块，而不是尝试从客户端上的数据构建它。

**谨慎/谨慎/仅根据需要使用 AJAX**

您可以巧妙地使用 AJAX 请求来节省一些服务器资源。但是，如果您被带走 (*coughlikemecough*)，您很快就会发现自己在每个用户操作中运行多个 AJAX 请求。从性能的角度来看，这通常会更糟，因为每个请求都有自己的开销份额，而开销将抵消仅请求所需资源的好处。

如果您发现单击一个界面元素会触发多个 AJAX 请求，那就是一个危险信号，需要认真思考正在发生的事情。您可能会在没有好处的情况下创建复杂性。

**JSON编码很好**

您可以 json_encode() 数据库查询的结果，它会生成非常好的对象，您可以在脚本中使用这些对象。语法很简洁，并且与 CodeIgniter 的 db 函数返回的结果配合得很好。

希望你能找到一些有用的东西。当你能从*别人的*错误中吸取教训时，总是会更好！:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T21:49:34.600

## JSON / XML 或纯文本

我认为你必须自己做出选择。您可以使用 XML 或 JSON 或仅使用纯 html。它还取决于您的问题的复杂性。我会选择 json 因为 PHP5 有非常简单的方法来编码和解码 json。

*   [json_encode](http://nl.php.net/json_encode)
*   [json_decode](http://nl.php.net/manual/en/function.json-decode.php)

## 服务器端

*   只需将 AJAX 操作放在控制器中即可。使用 get 获取数据并使用 codeigniter post 函数将数据存储在服务器上。
*   我建议您查看[yahoo 的开发人员最佳实践](http://developer.yahoo.com/performance/rules.html)，这将确保您的网站能够以闪电般的速度运行。如果可能，还应缓存 ajax 请求。

## Javascript

[jquery](http://docs.jquery.com/Ajax)使 json 调用变得非常简单。您可以使用 jQuery.get 来检索信息并使用 Jquery.post 来存储数据。

## 例子

我也会尝试在网上放一个简单的例子给你看。

祝你好运，
阿尔弗雷德·韦斯特维尔德

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T23:35:02.143

如果您不了解如何使用 Jquery 和 CodeIgniter 设置调用，请记住您用于 AJAX 调用的 url 是由 Controller 构造的。您可以使用控制器方法为 AJAX 调用创建 URL。

有关更多信息，本指南作为 AJAX + CodeIgniter 的介绍帮助了我。

[http://www.mrforbes.com/thoughts/2009/01/28/a-quick-code-igniter-and-jquery-ajax-tutorial/](http://www.mrforbes.com/thoughts/2009/01/28/a-quick-code-igniter-and-jquery-ajax-tutorial/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T21:37:04.500

好吧，这取决于到底想做什么。因为使用 ajax 函数的简单方法——使用[jQuery](http://jquery.com/)框架。它有你需要的一切。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T21:37:40.740

如果您对所有内容都使用 AJAX，即使是页面请求，它也不是很有用。您会在后退按钮、书签、js-off 浏览器等方面遇到问题。您可以破解它，但不值得这样做。使用 AJAX 向用户发布小消息，或者正如您在这里所体验的那样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T21:43:25.813

使用 Ext JS 或 Jquery 看看他们提供了什么，那里有很多链接，看看他们做了什么。

在查看了这些产品的一些演示后，您可能会受到启发，在您的网站上使用其中一些东西。

除此之外，测量你的瓶颈在哪里，并尝试在有意义的地方进行并行加载。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T21:46:55.167

这取决于您尝试使用 AJAX 实现的目标。通常有一个足迹/复杂性权衡。

例如，您可以让 AJAX 调用从服务器检索整个生成的 HTML 列表，包括标记，然后将其注入到 div 之类的容器中。这很容易实现，但缺点是必须向浏览器发送更多字节。

另一方面，您可以让服务器发送一个 JSON 字符串以响应 AJAX 调用，并让客户端将每个位包装在适当的标记中并将其放置在页面中。这更复杂，但可能更适合某些情况。

这实际上取决于您要实现的目标，没有单一的通用规则来管理“实现 AJAX 的最佳方式”。

# c# - 寻找 C# 音频分析库

> ID：947362
> 
> 赞同：2
> 
> 时间：2009-06-03T21:27:49.090
> 
> 标签：c#, audio, signal-processing

我正在做一个软件项目，我们的团队需要录制火车喇叭的声音。我们已经购买了录音机；它保存为 .wav 文件。我们现在需要从文件中提取数据，如频率和幅度，以创建频谱分析和分贝水平图。有针对这种类型的 C# 库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-06T17:52:37.827

我们正在使用 Intel Performance Primitives 库来处理这些东西（如 FFT）。它有一个可用的 C# 包装器，或者您可以使用 P/Invoke 调用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:43:25.890

这篇[CodeProject](http://www.codeproject.com/KB/audio-video/SoundViewer.aspx?fid=448560&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2202971)文章有可以抓取幅度和频率的代码。不确定这是否涵盖了您需要的一切。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-21T13:56:28.033

我自己没有尝试过，但[外皮层](http://www.exocortex.org/dsp/)可能有用。

# objective-c - 无法在 GNUstep/Win32 环境中构建 OCUnit - 找不到 objc/runtime.h

> ID：947365
> 
> 赞同：3
> 
> 时间：2009-06-03T21:28:53.160
> 
> 标签：objective-c, mingw, gnustep, ocunit

我正在尝试对 MinGW shell 中构建的 Objective-C 类进行单元测试。由于 OCUnit 已被 Apple 用于 XCode，因此开发人员 Sen:te 现在似乎已经专注于这一点。因此，声称支持 GNUstep 的最后一个源发行版是 v27。

无论如何，我下载了 v27 压缩包并尝试在 MinGW 中构建。您首先必须使用名为 SenFoundation\GSmakefile 的文件构建 Sen:te 基础类。

它持续了一段时间，直到我得到：

```
 Compiling file SenInvocationEnumerator.m ...
 In file included from SenInvocationEnumerator.m:10:
 SenInvocationEnumerator.h:13:25: warning: objc/runtime.h: No such file or directory 
```

据我所知，在我的 GNUstep 树或驱动器上的其他任何地方都没有这样的文件。

有没有人在这方面取得了成功，或者至少知道 objc/runtime.h 来自哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-04T15:02:26.797

通过更改以下#import 语句，我终于能够使用 GNUstep 构建 SenFoundation 库：

在文件中：

*   SenClassEnumerator.h
*   SenInvocationEnumerator.h

    改变：

    > ```
    >  #import <objc/runtime.h> 
    > ```

    至：

    > ```
    >  #import <GNUstepBase/GSObjCRuntime.h> 
    > ```

在文件中：

*   NSInvocation_SenTesting.m
*   NSObject_SenRuntimeUtilities.m

    改变：

    > ```
    >  #import <objc/objc-class.h> 
    > ```

    至：

    > ```
    >  #import <GNUstepBase/../objc/Object.h> 
    > ```

在文件中：

*   SenClassEnumerator.m

    改变：

    > ```
    >  #import <objc/objc-runtime.h> 
    > ```

    至：

    > ```
    >  #import <GNUstepBase/../Foundation/NSObjCRuntime.h> 
    > ```

# debugging - 如何在 google 或 yahoo 或 bing 上搜索 $exception 和 $ev 特殊调试器变量

> ID：947370
> 
> 赞同：0
> 
> 时间：2009-06-03T21:30:54.653
> 
> 标签：debugging, search

我想了解更多关于 $ev 特殊变量和一般特殊变量的信息。任何人都知道如何搜索以确保[google](http://www.google.co.nz)、[bing](http://www.bing.com)或 yahoo 不会忽略 $ 符号。在单词前面使用 + 的通常帮助似乎无济于事，也无助于语音标记。

是的，我试过在谷歌搜索答案，堆栈溢出似乎有同样的问题:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T22:21:57.670

通过提供上下文（例如`Visual Studio Debugger exception variable`. 搜索引擎通常不会在查询中考虑标点符号，但有一些例外情况已被特别添加为规则。（您可以搜索“ `A+`”，但不能搜索“ `+A`”或“ `A+B`”。）

# python - 自定义简单 Python HTTP 服务器不提供 css 文件

> ID：947372
> 
> 赞同：8
> 
> 时间：2009-06-03T21:31:32.797
> 
> 标签：python, css, http

我发现用python写的，一个非常简单的http服务器，它的do_get方法是这样的：

```
def do_GET(self):
        try:
            self.send_response(200)
            self.send_header('Content-type', 'text/html')
            self.end_headers();
            filepath = self.path
            print filepath, USTAW['rootwww']

            f = file("./www" + filepath)
            s = f.readline();
            while s != "":
                self.wfile.write(s);
                s = f.readline();
            return

        except IOError:
            self.send_error(404,'File Not Found: %s ' % filepath) 
```

它工作正常，除了事实 - 它不提供任何 css 文件（它在没有 css 的情况下呈现）。有人对这个怪癖有建议/解决方案吗？

最好的问候， praavDa

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T21:44:24.830

您明确地将所有文件提供为`Content-type: text/html`，您需要将 CSS 文件提供为`Content-type: text/css`. 有关详细信息，请参阅[CSS-Discuss Wiki 上的此页面](http://css-discuss.incutio.com/?page=MozillaCssMimeType)。Web 服务器通常有一个查找表来从文件扩展名映射到 Content-Type。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T21:44:47.230

它似乎正在返回所有文件的 html mimetype：

```
self.send_header('Content-type', 'text/html') 
```

此外，它似乎很糟糕。你为什么对这个糟糕的服务器感兴趣？查看 cherrypy 或 paste 以获得 HTTP 服务器的良好 python 实现和学习的良好代码。

* * *

**编辑**：试图为你修复它：

```
import os
import mimetypes

#...

    def do_GET(self):
        try:

            filepath = self.path
            print filepath, USTAW['rootwww']

            f = open(os.path.join('.', 'www', filepath))

        except IOError:
            self.send_error(404,'File Not Found: %s ' % filepath)

        else:
            self.send_response(200)
            mimetype, _ = mimetypes.guess_type(filepath)
            self.send_header('Content-type', mimetype)
            self.end_headers()
            for s in f:
                self.wfile.write(s) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T22:28:02.667

查看[`SimpleHTTPServer.py`](http://hg.python.org/cpython/file/3481c6f36e55/Lib/SimpleHTTPServer.py)标准库以获得更安全、更健全的实现，您可以根据需要对其进行自定义。

# php - php/mysql：银行假期和圣诞节、复活节等活动的数据库

> ID：947373
> 
> 赞同：3
> 
> 时间：2009-06-03T21:31:43.373
> 
> 标签：php, mysql, date, time, calendar

我正在开发一个简单的日历应用程序，我希望在日历上显示上述事件[银行假期等]。

日历只是一个标准的月视图，有一个链接可以查看当月每一天的每一天，以及查看下/上个月和年份等的链接......

我可能会存储每个事件的 mktime，如果今天 == mktime 然后将其显示在日历上[或类似的东西]，但是我从哪里可以获得这些日期？

有什么建议么 ？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T22:39:44.063

[http://pear.php.net/package/Date_Holidays](http://pear.php.net/package/Date_Holidays)支持计算多个国家/地区的假期日期，包括英国、美国、德国等。看[例子](http://pear.php.net/manual/en/package.datetime.date-holidays.example.php)

# c# - 库中的 IoC 与全局变量

> ID：947378
> 
> 赞同：0
> 
> 时间：2009-06-03T21:32:17.380
> 
> 标签：c#, inversion-of-control, global-variables

假设我的类型在构造函数中带有一些参数，如下所示：

```
public MyType(IComObject wrapper,string table) {} 
```

现在 IComObject 是两个不同 COM 对象的包装器。我的所有（90%）类型都必须使用 IComObject，所以以良好的 DI 方式（以允许测试）我将 IComObject 传递给每个需要它的类型。

主要问题是，当有人使用我的 COM 包装库时，必须将 IComObject 的实例传递给他们所做的一切，这使得代码有点难以管理和维护。

我想知道是否应该使用用户可以设置的 IoC 容器或全局变量，这样他们就不必传递 IComOject 实例。例子：

```
public MyType(string table)
       : this(IoC.Resolve<IComObject>,table) {} 
```

或者

```
public MyType(string table)
   : this(StaticClass.ComInstance,table) {} 
```

这样用户就可以这样做：

```
//Set up Ioc container
COMObject object = new COMObject();
Ioc.Register(typeof(IComObject),object);
MyType mytype = new MyType("test.tab"); 
```

或者

```
COMObject object = new COMObject();
StaticClass.ComInstance = object;
MyType mytype = new MyType("test.tab"); 
```

你觉得在这种情况下我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T22:29:05.003

国际奥委会绝对是要走的路。全局变量并不是编程中最糟糕的事情，少量的全局变量也不是最糟糕的事情，但是 IoC 是一种很好的、​​干净的模式，从长远来看，它易于理解且更易于维护。IoC 的依赖关系也更加明确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:35:43.660

使用容器，这就是它们的重点。我只使用过 StructureMap，但我绝对可以推荐它。大量文档，而且它真的很容易启动和运行。一旦您对使用它感到满意，您就会喜欢它使事情变得多么容易。为胜利脱钩！

实际上，您的容器将是您查询对象的静态类，因此实际上没有选择:)

# sql - Reporting Services 订阅不允许修改收件人：字段

> ID：947379
> 
> 赞同：16
> 
> 时间：2009-06-03T21:32:28.347
> 
> 标签：sql, sql-server, sql-server-2008, reporting-services

我有一个小问题让我很头疼。我们的报表服务器是 Win 2008 服务器上的 SQL Ent 2008。当具有报表浏览器权限的用户尝试设置报表订阅时，收件人：字段将显示为灰色并预先填充了他们的用户名。他们无法更改此设置，并且不会发送到他们的电子邮件地址，即 username@domain.com。任何线索将不胜感激。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-04T06:12:07.903

“站点设置”..“配置项目级角色定义”..“浏览器”

他们只能“管理个人订阅”。SSRS 不允许更改电子邮件地址，因为他们可以在其中放置任何东西。

在 BOL 中，[管理订阅](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/ms157339(v=sql.105))...以及[如何：订阅报告（报告管理器）](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/ms157386(v=sql.105))，这导致为[电子邮件传递配置报告服务器](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2008-r2/ms159155(v=sql.105))。这说：

> 用于设置收件人：消息中的字段的配置选项
> 
> 根据管理个人订阅任务授予的权限创建的用户定义订阅包含基于域用户帐户的预设用户名。当用户创建订阅时，收件人：字段中的收件人姓名使用创建订阅的人的域用户帐户进行自寻址。
> 
> 如果您使用的 SMTP 服务器或转发器使用的电子邮件帐户与域用户帐户不同，则当 SMTP 服务器尝试将报告传递给该用户时，报告传递将失败。
> 
> 要解决此问题，您可以修改允许用户在“收件人：”字段中输入名称的配置设置：
> 
> 1.  使用文本编辑器打开 RSReportServer.config。
> 2.  将 SendEmailToUserAlias 设置为 False。
> 3.  将 DefaultHostName 设置为 SMTP 服务器或转发器的域名系统 (DNS) 名称或 IP 地址。
> 4.  保存文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-04T15:47:43.037

我意识到这是一篇已有 3 年历史的帖子（尽管在此帖子之前 5 个月前有活动），但我发现了另一个可能对其他试图解决此问题的人有用的花絮。

作为配置文件 RSReportServer.config 的一部分，如在*installdir* \Reporting Services\ReportServer\ 中找到的上述答案中提到的，文件的一部分，您可以将您的域名添加到与用户别名一起使用的部分。

要编辑的标签是Microsoft 文档中所述的**DefaultHostName** ，此值在设置为 true 时与**SendEmailToUserAlias标签一起使用。**

最终用户仍然有一个显示其 AD 用户别名的灰色收件人：字段，但是当他们设置订阅以通过电子邮件发送报告时，SMTP 服务器在执行时将指定的域（来自 DefaultHostName 标记）附加到别名。

我不想使用上一个答案中指定的循环工作，因为我不希望最终用户能够指定任何电子邮件地址。

这在 SSRS for SQL 2008 R2 中对我有用。来自 Microsoft 的文档 (http://msdn.microsoft.com/en-us/library/ms157273.aspx#bkmk_email_extension)

注意确保在更改文件之前关闭报告服务进程，在进行并保存更改后，重新启动进程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-21T15:39:58.420

我添加到 gbn 的解决方案版本。

1.使用文本编辑器打开 RSReportServer.config。

2.将 SendEmailToUserAlias 设置为 True。（所以 To: 不为空）

3\. 将 DefaultHostName 设置为 SMTP 服务器或转发器的域名系统 (DNS) 名称或 IP 地址。

4.保存文件。

此版本将在“收件人：”部分显示您的别名，电子邮件将立即通过。

# sharepoint - 需要适用于目录服务映射 (Active Directory) 的客户端证书吗？

> ID：947380
> 
> 赞同：2
> 
> 时间：2009-06-03T21:32:47.300
> 
> 标签：sharepoint, iis-6, sharepoint-2007

我的 MOSS 2007 实例 (IIS 6) 使用 Windows 身份验证和 IIS 的目录服务映射（针对 Active Directory），允许用户仅使用她的智能卡客户端证书进行身份验证，无需任何用户名/密码，无论是什么（如果有）域客户端工作站已加入。IIS 实例设置为需要客户端证书。

我的理解是，为了让 IIS（在 Active Directory 中）找到与客户端证书关联的帐户，它必须能够从中读取“用户主体名称”（有时称为“用户登录名”）。

我的用户的智能卡有两个由同一个根 CA 颁发的客户端证书。一个指定一个 UPN。另一个没有。访问该站点时，她可以从任一证书中进行选择。如果她选择了没有 UPN 的证书，认证肯定会失败。

如何使浏览器的证书选择对话框*仅*显示IIS 至少有*机会*与帐户匹配的证书（再次：DSM 和 AD）？

从技术上讲：如何将 MOSS 用户的客户端证书选择选项限制为在“主题备用名称”字段中具有 UPN 的选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-13T20:01:10.443

我不认为你可以改变这一点。我相信证书选择屏幕是 Internet Explorer 的一部分。

如果用户选择的证书没有关联 UPN，您可以提示用户选择另一个证书并重试。

编辑：由于利用 MOSS 安全框架可能很困难，因此您可以将其实现为 HTTPHandler 并将其添加到 MOSS 根 web.config。

当用户请求进入时，处理程序首先获得 dib，如果证书中缺少 UPN，则可以重定向到“重试”页面。

“重试”页面将不得不通过打开另一个窗口来重试请求以获取另一个证书提示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-10T15:55:42.010

快速思考一下，以防您愿意接受一种可能稍微不那么烦人的重新身份验证解决方案。当心：几个 IF！

*   如果您可以依赖用户的浏览器是 Internet Explorer 6 SP1 或更新版本
*   如果您可以假设他们的浏览器将运行脚本
*   如果您可以清除所有身份验证信息（即所有需要身份验证的站点都需要重新身份验证）

*   那么你也许可以隐含`document.execCommand('ClearAuthenticationCache')`javascript 代码。浏览器应通过清除身份验证缓存（所有缓存的用户名和密码、所有缓存的客户端证书等）来执行此代码。

如果用户不运行脚本或运行 IE 以外的其他东西，这将不会（据我所知）运行。请记住，所有其他选项卡（以及同一进程中的窗口）共享身份验证缓存。如果页面/站点需要身份验证，则此命令将要求用户重新进行身份验证，但至少，在关闭所有浏览器窗口后，他们不必再次导航到那里......

玩得开心！

PS - 它不应该影响存储的用户名/密码组合，也不应该影响任何可能为智能卡缓存的 PIN 码，但很可能需要用户按 OK 提交用户名/密码，或选择特定的再次证书。

# asp.net-mvc - 为什么是模型视图控制器而不是适配器视图控制器？“M”或模型缺乏清晰性

> ID：947389
> 
> 赞同：2
> 
> 时间：2009-06-03T21:35:28.840
> 
> 标签：asp.net-mvc, model-view-controller

我使用和阅读关于 ASP.NET MVC 的内容越多，似乎“M”或模型是一个似乎会引起大量混乱的主题。

MVC 框架真的应该重命名为 Adapter View Controller 吗？Adapter 负责将数据模型传递到视图的位置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T21:42:36.190

我认为这到底是什么名字并不重要。在大多数开发良好的应用程序中，data/model/whatever 层将是它自己的独立程序集，在应用程序中内置 ViewModels（您适当地标记为适配器）以支持该程序集中的对象。但它不一定适用于简单的应用程序，您可以在 MVC 项目中的模型中实现所有这些。我认为“模型”一词是一个足够通用的术语，可以灵活地解释这个含义。

它可能被命名为 MVC，因为这是一个流行语，而且流行语有利于营销和管理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T21:41:54.083

当涉及到域模型和 MVC 时，“模型”一词会导致很多混淆。现实情况是，如果您完全专注于开发领域模型，那么这就是 MVC 中的模型所指的内容。正如您所说，ViewModels 和 Presenters 等概念是适配器。我喜欢用**“ModelAdapter”、“ViewAdapter”或“EditAdapter”等术语来指代这些对象。**

领域模型旨在以行为为中心，它们本身并不适合绑定等 UI 活动。这正是 ModelAdapters (ViewModels) 的用途。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T21:44:15.670

MVC 中的“模型”真正代表了“模型”，它负责充当数据容器，在底层结构和视图之间承载数据。将模型交付给视图是控制器的责任。实际上，这是控制器的主要职责。

这不是 ASP.NET MVC 框架引入的新概念。该框架只是众所周知的 mvc 模式的实现，并且非常准确地命名，因为它遵循精确的模型-视图-控制器模式。

还有 MVP、MVVM 和 DMVVM 模式，您可以考虑将它们作为相同问题的其他替代方案。他们都没有忽略简单模型，因为应该遵循一个非常简单的数据保存模型。

# c++ - make_heap 的意义何在？

> ID：947394
> 
> 赞同：51
> 
> 时间：2009-06-03T21:36:51.443
> 
> 标签：c++, stl, language-design

有人可以告诉我 STL 堆函数模板的意义`std::make_heap`吗？为什么有人会使用它们？有实际用途吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-06-03T22:17:13.313

您的直接问题将由算法和数据结构方面的课程很好地回答。在计算机科学的算法中，堆被广泛使用。引用下面链接的 make_heap 函数，“堆是一棵树，其中每个节点都链接到不大于其自身值的值。” 虽然堆有很多应用程序，但我最常使用的应用程序是当您想要有效地跟踪 N 值的排序列表时的搜索问题。

当我第一次遇到 STL 堆函数时，我和你有类似的困惑。我的问题有点不同。我想知道“为什么 STL 堆与 std::vector 不在同一类数据结构中？” 我认为它应该像这样工作：

```
std::heap< int > my_heap;
my_heap.heap_insert( 7 );
my_heap.heap_insert( 3 ); 
```

STL 堆函数背后的想法是，它们允许您从几个不同的底层 STL 容器（包括 std::vector）中创建堆数据结构。如果您想传递容器以在程序的其他地方使用，这将非常有用。它也有点好，因为如果你选择使用 std::vector 以外的东西，你可以选择堆的底层容器。您真正需要的是以下内容：

```
template <class RandomAccessIterator>
  void make_heap ( RandomAccessIterator first, RandomAccessIterator last ); 
```

这意味着您可以将许多不同的容器放入堆中。比较器在方法签名中也是可选的，您可以阅读更多有关可以在 STL 页面中为 make_heap 函数尝试的不同内容的信息。

链接：

*   [堆数据结构](http://en.wikipedia.org/wiki/Heap_(data_structure))
*   [make_heap 函数](http://en.cppreference.com/w/cpp/algorithm/make_heap)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-03T21:41:52.087

如果你想从列表中创建一个[优先级队列，那么你可以使用 make_heap：](http://www.cplusplus.com/reference/algorithm/make_heap/)

> 在内部，堆是一棵树，其中每个节点都链接到不大于其自身值的值。在 make_heap 生成的堆中，一个元素在树中的具体位置，而不是由消耗内存的链接确定，是由它在序列中的绝对位置确定的，*first 始终是堆中的最大值。
> 
> 堆允许使用函数 push_heap 和 pop_heap 以对数时间从其中添加或删除元素，这些函数保留其堆属性。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-04T06:21:24.067

您应该与向量或数组`std::make_heap()`一起使用`std::push_heap()`并`std::pop_heap()`维护二进制堆；后两个函数保持堆不变。你也可以使用`std::heap_sort()`这样的堆来排序。虽然您确实可以将其`std::priority_queue`用于优先级队列，但它不会让您了解它的内部，而这可能是您想要做的。此外，`std::make_heap()`并`std::heap_sort()`一起制作了一种非常简单的在 C++ 中进行堆排序的方法。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-04-09T13:52:06.700

`std::make_heap`几乎不应该在实践中使用。虽然堆确实对优先级队列很有用，但这并不能解释为什么要手动维护结构。`std::priority_queue`如果您只需要一个优先级队列，则它具有更有用的界面。

如果您`make_heap`直接使用及其同级，则必须确保每次更改底层容器时都使用它们。我见过他们使用了两三次，而且*每次*都被错误地使用。

我自己只直接使用过一次堆操作，因为我需要使用一段时间作为优先级队列，然后对其进行排序。您很可能永远不需要`std::make_heap`.

如果您需要一个能够更改元素的优先级队列，您可以使用`std::set`. `*s.begin()`您可以使用or分别获取最小或最大元素，`*s.rbegin()`并通过删除旧值并插入新值来更新元素。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-06-04T20:56:22.867

基本上有两种方法可以构建[二进制]堆：创建一个空堆并将每个元素一次插入其中，或者获取一系列值并将它们堆起来。

堆上的每个推送操作都需要 O(logn) 时间，因此如果将 N 个项目推送到堆上，则需要 O(NlogN) 时间。然而，从一个值数组构建一个二进制堆只需要 O(N) 时间。

因此，将每个元素插入数组（或其他支持随机访问迭代器的容器）然后在数组上调用 make_heap() 比在插入时维护堆结构更有意义。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-03T21:50:24.490

除了上述之外，STL 的排序算法是[introsort](http://en.wikipedia.org/wiki/Introsort)，它是快速排序和堆排序的混合体（如果前者表现不佳，它会从快速排序故障转移到堆排序）。make_heap 创建一个堆结构，这是运行 heapsort 所需要的，这是 introsort 所需要的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-03T21:41:33.227

它们用于构建和维护[堆数据结构](http://en.wikipedia.org/wiki/Heap_(data_structure))

# debugging - 在调试模式下发布软件有什么问题吗？

> ID：947401
> 
> 赞同：37
> 
> 时间：2009-06-03T21:37:45.060
> 
> 标签：debugging

我们都知道“调试模式”应该用于开发，因为编译器会产生更多的调试信息，而“发布模式”应该用于生产版本，因为编译器会生成优化的代码。

但是，假设您正在制作一个**仅**在组织内部使用的软件，并且**代码性能不是一个大问题**，因为该软件需要执行大量文件 I/O 和数据库查询。在这种情况下，我很想在“调试模式”下发布软件，因为这些额外的调试信息使以后的维护更容易一些。

在这种情况下，是否还有任何令人信服的理由以发布模式发布软件？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-03T22:09:28.880

我能想到的两个问题：

1.  调试版本通常会向缓冲区添加填充。这就是为什么有时你得到的程序*似乎*在调试中工作但在发布时崩溃。似乎是这里的操作词，因为缓冲区溢出只是等待发生的意外。

2.  在调试版本中会发生奇怪的事情。我曾经做过一个长时间运行的应用程序，它每 20 天左右就会崩溃一次。事实证明，在 C 运行时中，每次执行 malloc/free 时都会增加一个计数器（用于帮助调试）。如果计数器发生溢出 - kaboom！仅出于这个原因，我永远不会建议任何人部署调试二进制文件——您永远不知道可能会等待您的客户有什么惊喜。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-06-03T21:44:18.090

可能的原因：

1.  Debug 通常不会为性能而编译
2.  调试应用程序大小（通常）比发布编译大很多。
3.  如果有人试图对您的应用程序进行逆向工程（无论出于何种原因），那么它就会变得容易得多。

更新： 4\. 正如所指出的，链接器性能，但我原以为会在列表中排名靠后 :p 与进行调试编译相比，您发布产品多少次？

如果您愿意放弃上述内容，那么没有真正的理由不这样做。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-03T21:42:53.740

您所问的这一事实表明您想利用调试模式的好处。如果这些好处超过了你的道德内疚，那么我说继续做吧。这些好处可能是机械的和信息性的，并且与您的工作相关，而缺乏内疚感并不能真正帮助您开发出更好的软件。它可能会帮助你睡得更好，但谁在乎呢？

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-03T21:38:59.363

我猜想那里安装的调试代码比我们（开发人员）愿意承认的要多得多。

就我个人而言，我知道有很多生产系统部署给客户，代码以调试模式编译。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-03T22:31:38.807

我对在内部发布 Debug 版本没有任何个人反对意见，只要它可以工作（一些 Debug 版本在非开发机器上无法工作，也没有安装相应的调试库......当我编写 C++ 时遇到了这个问题/MFC 代码）。

一种稍微复杂一点的方法是使用**符号服务器**，它会由您的构建过程自动使用符号更新。

如果您正在从客户端机器调试问题，请将**轻量级调试器**指向您的符号服务器（确保版本匹配），然后开始调试。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-03T23:12:44.137

使用发布模式，但在启用所有调试信息的情况下进行编译，并将 pdb 文件与可执行文件一起部署。您可以像调试二进制文件一样调试发布二进制文件 - 没有区别，您只需要在构建时生成 pdb 文件。

发布和运行调试版本可能很危险，因为它隐藏了代码中的错误，这些错误只会在发布模式下出现。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-03T22:08:22.470

我有一个模糊的回忆，如果你将在 Debug 下编译的二进制文件带到没有安装调试 C 运行时库的计算机上（这通常意味着它没有 IDE，所以大多数用户都属于这一类），它会barf 带有错误消息。我不知道这是否特定于 Windows 和/或 C++。我也可能记错了……但是您当然应该检查是否发生这种情况，好像我是对的，这将是在发布模式下编译的主要原因。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-03T22:02:42.920

> 额外的调试信息使以后的维护更容易一些。

这取决于您所说的“额外调试信息”是什么意思。

如果您的意思是调试消息，您可能应该使用`Trace`，而不是`Debug`，并使用配置文件中定义的跟踪开关和跟踪侦听器来控制运行时的日志记录行为。

如果您的意思是在发生异常时知道成员名称和行号，则无需分发调试版本即可获取该信息；只需将`.pdb`文件与您的可执行文件一起分发。无论您是否设置了任何编译常量，该类都使用文件中的信息`Exception`。`.pdb`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-03T21:43:06.470

**取决于用户**

**如果用户是技术人员**，为符号提供额外的调试包可能会帮助他们代表您进行调试或提交更多技术错误信息...**节省您的金钱/时间**。

**如果用户是家庭用户**......他们可能不会关心调试信息是否存在。如果你去掉所有的痕迹:)

**如果它是一家**正在寻找精益不臃肿机器的企业，那么就给他们一个精简版。

取决于您的业务/沟通目标和限制在哪里。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-03T21:54:44.590

您在问题中是独立于平台的，但是这个关于为什么不在 ASP.Net 上将调试模式投入生产的建议展示了不这样做的一些（诚然与性能相关的）原因。

1) ASP.NET 页面的编译耗时较长（因为禁用了一些批量优化）

2) 代码执行速度可能较慢（因为启用了一些额外的调试路径）

3) 运行时在应用程序中使用更多内存

4) 从 WebResources.axd 处理程序下载的脚本和图像不会被缓存

最后一点对于某些类型的控件来说是一个性能杀手，这些控件在 web2.0 世界中是“预期的”功能，即使对于内部应用程序也是如此。有关最后一点的成本的更多详细信息，请参阅[ScottGu](http://weblogs.asp.net/scottgu/archive/2006/04/11/442448.aspx)的文章。

总结反驳论点的最佳方法可能是“这取决于您如何定义代码性能”。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-03T21:55:21.857

在调试模式下编译任何应用程序会将代码添加到（几乎）由编译器或 IDE 专门用于调试、单步调试代码等的应用程序中。这些调试功能在现实生活中几乎没有用处。如果您想向公众发布应用程序，最好的办法是在发布模式下编译它。此外，发布构建的应用程序是...

*   更快更稳定
*   针对机器进行了优化
*   体积更小
*   更安全（更难反编译/破解）
*   在硬件上更高效、更轻松

如果您可以选择发布模式，为什么不使用它呢？您将始终拥有用于开发的调试版本，或者如果出现问题，您始终可以将调试构建的应用程序和/或源代码与发布构建的版本打包在一起。

此外，您还可以选择为某些平台构建应用程序。使用发布模式编译将简化该平台的应用程序，使其更加稳定。

**即使速度不是问题，编译时也没有理由不使用 Release 模式。**

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-03T23:25:06.840

调试版本主要有两个问题：

1.  调试信息可能是未来维护的一项重大且不必要的保险检查，可以通过其他方式避免。
2.  诊断是您的应用程序的一个方面，它应该与您正在构建的构建配置无关或依赖

我认为在您的应用程序中设计和保留仪器和诊断逻辑作为一个方面或横切关注点非常重要。如果您过于依赖代码的调试版本提供的信息：

*   你能保证每次发布你的应用程序的新版本时都会发布调试版本吗？糟糕的文档，其他人在做，等等。
*   应用程序的功能和复杂性都有增长的趋势。虽然由于调试版本而导致的应用程序的性能和大小目前可能不是问题。事情可能会加起来并导致潜在的问题。如果出现性能问题，您甚至可能不会将它们归因于调试版本。

您仍然可以在发布版本中收集有价值的信息。如果出现异常，堆栈跟踪应该仍然可用。您可能看不到源文件和行号，但您仍然可以看到调用了哪些方法。但是，您仍然应该为您的发布版本生成并保留调试符号。这些符号将允许您调试发布版本（您甚至可以设置符号服务器）。由于代码优化，调试信息很可能不会与 100% 的代码匹配，例如调试信息指的是优化后的语句等，但您仍然应该能够调试大部分内容。对于其他信息，例如用户输入数据、中间数据、执行的数据库代码等，调试版本无论如何都不会帮助您，因为它不会捕获这些信息。

如果您使用的是 .NET，可以查看[Tracing and Instrumentation](http://msdn.microsoft.com/en-us/library/zs6s4h68.aspx)。您还可以考虑使用现有的框架，例如 Microsoft Enterprise Library 或 log4net。如果是 .NET 应用程序，您还可以请求 JIT-compiler 为您的应用程序的发布版本生成跟踪信息作为选项。查看[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/9dd8z24x(vs.71).aspx)。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-04T02:34:28.037

除了已经提到的性能、大小和反编译...

**Security:** Debug builds and debugging information (e.g. pdb files) contain lots of information about the source code which not only makes decompiling much easier, but can also let users know internal details such as as filenames and network paths. Many companies may consider this information to be very sensitive.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-03T21:41:35.787

如果它是一个网站或服务并且性能不是问题，那么一定要以调试模式发布它。如果它是桌面应用程序，那么请考虑调试模式版本在处理错误方面是否对用户友好。如果是，那么我也会发布调试版本。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-03T22:01:16.510

我认为遵循良好的标准、实践和程序很重要。仅仅因为应用程序只在内部使用并不是让自己偷懒的好理由。虽然我对做事的“正确方式”有强烈的感觉，但我相信，从长远来看，编写好的软件的习惯胜过使用调试版本作弊的好处。添加一些异常处理，了解您正在编码的系统的缺陷 - 它将使您编写的所有代码都变得更好。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-03T22:14:49.603

我的决策树是这样的：

程序是用Java编写的吗？

是的 - 然后在调试模式下发布就可以了。JIT 将负责优化

否则 - 程序 CPU 密集型吗？

否 - 在调试模式下发布很好。

是 - 然后在发布模式下只编译热点。

基本原理：当错误报告是从与您在 IDE 中运行的程序*完全相同的程序中生成时，维护代码要容易得多。*在 IDE 中，您使用的是调试版本，因此您应该努力在调试模式下发布。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-03T23:26:31.113

你要发布软件吗？（这是一个“是”、“否”的问题，“是的，但是……”不算）

如果是这样，为什么不正确地做它并使其成为一个真正的版本，这样您就不必依赖对您的用户可用的调试符号......

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-04T02:09:28.180

这是我通常对需要存在调试信息的软件（通常是开发类型工具）所做的事情 - 我编译我的代码优化，但使用符号信息，并链接以便我保留符号信息。这样，当软件崩溃时，我至少可以得到一个中等水平的堆栈跟踪，并知道在我向客户提供完整调试版本时从哪里开始放置额外的日志信息。

有时优化器会导致错误，有时它会掩盖它们，但至少你有能力缩小问题的范围。这在诸如 Raytheon 之类的黑盒环境中为我创造了奇迹，在这些环境中获取核心转储是不可能的，并且堆栈跟踪是用大黑色标记传真过来的。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-04T03:21:54.367

release two versions, one labeled if bugs appear use this one ..

But depending upon the sensitive data lock the debug version away.

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-01-21T14:40:43.533

I personally believe in a median solution between debug and release, that is, you log enough so you can reproduce the error if it happens. When your app is stable enough, turn off your extra spicy logging with a parameter in your config file. I realise it cannot be done all the time, though. Most often when you have your app running in at one place only.

Also, one golden rule which I've tried hard to implement in my workplace (and have not fully succeeded yet in doing): never ever EVER let your code show. If the user is tech savvy, he'll know what's going on and think poorly of you. If your user is not, he'll think his computer is possessed by the devil, and think poorly of you.

# sed - sed 行范围，除了最后一行

> ID：947404
> 
> 赞同：37
> 
> 时间：2009-06-03T21:38:11.987
> 
> 标签：sed

您可以指定要操作的行范围。例如，要对所有行进行操作，（这当然是默认设置）：

```
sed -e "1,$ s/a/b/" 
```

但我需要对除最后一行之外的所有内容进行操作。您显然不能使用算术表达式：

```
sed -e "1,$-1 s/a/b/" 
```

（在这种情况下，我使用的是 cygwin，如果有区别的话）

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-06-03T21:51:36.297

```
sed -e "$ ! s/a/b/" 
```

这将匹配除最后一行之外的每一行。通过快速测试确认！

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-07-29T13:07:14.443

该命令也有效

```
sed '$d' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-08-08T12:40:04.747

我知道不是`sed`，但我觉得这`head`是最简单和最灵活的方式：

```
head -n -1 the-file 
```

使用 -2, -3... 而不是 -1，检索除最后两行之外的所有行，等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T21:47:30.003

好吧，你可以用这样的东西破解它：

```
sed -e "1,$(($(cat the-file | wc -l) - 1))s/a/b/" 
```

或者，您可以`tail`改用：

```
(tail +1 the-file) | sed -e s/a/b/; tail -1 the-file 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-21T16:56:02.983

在更一般的意义上，这个问题要求您通过指定一个范围来编辑流，其中一个范围限制是与文件结尾的偏移量。以下示例显示了如何执行此操作。在这个例子中，我打印出文件的所有行，从最后一行的第 5 行开始，到最后一行结束。在您的情况下，您可以设置`OFFSET = -1`而不是`OFFSET = -5`.

```
(( OFFSET = -5 )); (( N1 = $(cat pgen.c | wc -l) + OFFSET )); sed -n "$N1,\$p" thefile 
```

该命令可以在一行中输入。

# sqlite - Subsonic + Sqlite + Float 数据类型 == “无法保存：xxx 超出最大长度 8”

> ID：947406
> 
> 赞同：0
> 
> 时间：2009-06-03T21:38:31.440
> 
> 标签：sqlite, subsonic

我正在使用 Subsonic 2.2 构建一个数据加载器实用程序（Win 7 64bit、VS 2008、C#、.Net 3.5、Win Forms）。
我已经使用 SqlServer 完成了所有工作，现在我需要让它在 Sqlite 3 中工作。我已经解决了一些问题，但有一个我无法解决；
我有 2 列，纬度和经度，它们是 sqlite 中的 FLOAT 数据类型，而 Subsonic 生成为可为空的浮点数。代码生成很好，构建很好，但是当我尝试运行应用程序时，当对象被保存时，我收到错误消息，“无法保存：经度超过 8 的最大长度。”
我的猜测是，这是 Subsonic 中的一个验证问题，因为我的 Sqlite 数据库现在与我加载到这些列中的数据存在问题。
任何 Subsonic 或 Sqlite 的老手都有任何建议，我是 Subsonic 的新手，现在只使用 Sqlite 大约 6 个月。

谢谢，杰夫

导致错误的值是 -122.41082 超过 8 个字符，但我认为这不是 sqlite 中浮点数的限制。也许我在数据类型方面选择不当？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T07:21:54.247

这是一个 SQLite 问题，因为据我了解，SQLite 没有“类型”的概念——只有对值的推断：

[http://www.sqlite.org/faq.html#q3](http://www.sqlite.org/faq.html#q3) [如何更改 sqlite 列（iPhone）？](https://stackoverflow.com/questions/623044/how-to-alter-sqlite-column-iphone)

我在这里的猜测是，浮动翻译中的推断会丢失 - 如果您阅读文档，它会说很多：

> 具有 NUMERIC 关联的列可能包含使用所有五个存储类的值。将文本数据插入 NUMERIC 列时，会在存储之前尝试将其转换为整数或实数。如果转换成功（意味着转换不会丢失信息），则使用 INTEGER 或 REAL 存储类存储值。如果在不丢失信息的情况下无法执行转换，则使用 TEXT 存储类存储该值

因此，看起来您传入的值无法存储为 REAL（出于某种原因），并且正在尝试将其调整为 TEXT，长度限制为 8。这也是有道理的，因为它正在计算小数位 - 它不应该（只有当它是文本时才会出现）。

在这里阅读： [http ://www.sqlite.org/datatype3.html#affinity](http://www.sqlite.org/datatype3.html#affinity)

看起来这是您正在处理的问题。总而言之，SQLite 是一个“ducktyped”的数据库，很多人都被它咬过。

因此，简而言之，我认为您的答案可能是使用 Math.Round(3) 将值带入 8 个总数以下 + 小数（和负号），以便可以将其强制放入列中。

# java - java/.Net 的基本“代码工具集”

> ID：947411
> 
> 赞同：0
> 
> 时间：2009-06-03T21:39:11.827
> 
> 标签：java, .net, libraries

您在每个项目中都使用了哪些基本代码包，这些代码包未包含在 BCL 或 java 发行版中？

*   模拟/存根
*   单元测试
*   IOC / 依赖注入
*   日志记录
*   甲骨文
*   ...

您使用上述哪种实现？

我错过了哪些必需品？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T21:57:46.580

这是我的 Java 列表：

1.  Spring 用于依赖注入、AOP、处理配置和将系统粘合在一起
2.  Easymock 用于模拟。
3.  JUnit 用于测试 Log4j 的日志记录。
4.  为 ORM 休眠。
5.  CXF 用于 Web 服务。
6.  特别是 Apache Commons：
    *   用于编码/解码的编解码器（例如 Base64）
    *   朗为各种便利班
    *   用于增强文件处理的 IO。
7.  Google Collections 为其启用泛型的 Collection 功能。
8.  JIBX 用于很好的 XML 编组/解组
9.  用于一般缓存的 EhCache
10.  不是真正的 java 包，但我所有的项目都使用 Maven 进行依赖管理和构建自动化。
11.  所需的任何统计和随机数生成的不常见数学。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T21:44:17.170

*   [.NET Reflector (Red Gate)](http://reflector.red-gate.com/download.aspx)（反射，很明显）
*   [ELMAH](http://code.google.com/p/elmah/)（记录）
*   [Nunit](http://nunit.org)（单元测试）
*   [犀牛模拟](http://ayende.com/projects/rhino-mocks.aspx)（模拟）
*   [NHibernate](http://nhibernate.org)（或最近的 Linq-to-SQL）（ORM）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T21:49:39.373

*   起订量（模拟）
*   NUnit（单元测试）
*   Ninject（依赖注入）
*   NHibernate 与 Fluent NHibernate (OR/M)
*   Sonic.NET 迁移（迁移）
*   FinalBuilder（持续集成）
*   YUI 测试（JavaScript 单元测试）
*   WatiN（启用 JavaScript 单元测试的持续集成）
*   WatiN（集成测试）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T21:50:18.920

*   视觉工作室 - IDE
*   Resharper - IDE 增强功能
*   Visual SVN - IDE 增强功能
*   [RockScroll](http://www.hanselman.com/blog/IntroducingRockScroll.aspx) - IDE 增强功能
*   SVN - 源代码控制
*   .Net Reflector - 工具
*   NHibernate - ORM
*   最小起订量 - 模拟
*   NUnit - 测试
*   温莎城堡 - 国际奥委会
*   TeamCity - 持续集成

# firebug - 有没有办法让萤火虫同时显示控制台和 HTML 窗口？

> ID：947419
> 
> 赞同：4
> 
> 时间：2009-06-03T21:40:43.277
> 
> 标签：firebug

我经常测试操纵 DOM 的代码。我可以粘贴它并在控制台中运行它，然后切换到 HTML 选项卡以查看它是否具有所需的效果。然后当我切换回控制台视图时，我的代码消失了，我必须重新粘贴它。这是一种痛苦。

我真正想要的是将控制台放在右侧窗口中，将 HTML 视图放在左侧窗口中。然后，大概，我可以（理想情况下）运行我的代码并立即看到对左侧窗口中显示的 HTML 元素的影响。

有没有办法做到这一点？（或者可能是它的一些扩展）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T00:17:38.310

当您来回切换时，最新的 alpha 版本的 firebug 1.4 会保留最新的代码。它还有一些漂亮的功能，比如“break on next”——非常酷！我等不及它的测试版/成熟。*嗯...我想这是字面意思-我等不及了。我正在使用阿尔法。;)*

[抓取 firebug-1.4.0a31.xpi](http://getfirebug.com/releases/firebug/1.4/)

此外，由于这是 alpha 软件，因此我在[不同的配置文件](http://support.mozilla.com/en-US/kb/Managing+profiles)下运行它以进行开发，并且仅在需要/想要它们时才使用新功能。肯定还不稳定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T12:28:59.600

> 当我切换回控制台视图时，我的代码不见了，我必须重新粘贴它

您可以使用向上/向下键在 firebug 控制台中显示以前的命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T23:27:28.627

我知道这是一个老问题，但这仍然可能对那些发现这个问题的人有用。

您可以使用此小书签启动 Firebug Lite 的实例，例如：

```
javascript:(function(F,i,r,e,b,u,g,L,I,T,E){if(F.getElementById(b))return;E=F[i+'NS']&&F.documentElement.namespaceURI;E=E?F[i+'NS'](E,'script'):F[i]('script');E[r]('id',b);E[r]('src',I+g+T);E[r](b,u);(F[e]('head')[0]||F[e]('body')[0]).appendChild(E);E=new%20Image;E[r]('src',I+L);})(document,'createElement','setAttribute','getElementsByTagName','FirebugLite','4','firebug-lite.js','releases/lite/latest/skin/xp/sprite.png','https://getfirebug.com/','#startOpened'); 
```

然后，您可以在主 Firebug 扩展中拥有 HTML 面板，同时在 Firebug Lite 小书签中拥有一个控制台。

我通常将我的主 Firebug 放在右侧，这与 Firebug Lite 在底部渲染时效果很好，并且目前没有定位选项。

# algorithm - 一种从有向图计算线有向图的有效算法

> ID：947421
> 
> 赞同：2
> 
> 时间：2009-06-03T21:40:52.480
> 
> 标签：algorithm, graph-theory, linegraph

有谁知道从有向图计算线有向图的有效算法？请参阅[http://en.wikipedia.org/wiki/Line_graph](http://en.wikipedia.org/wiki/Line_graph)（维基百科文章在底部附近提到了二合字母案例（在概括部分中）。理想情况下，我希望在线性时间内做到这一点。

从那个部分：

*   如果 G 是有向图，则其有向线图或有向线图对 G 的每条边都有一个顶点。
*   当 v = w 时，表示 G 中从 u 到 v 和从 w 到 x 的有向边的两个顶点由线有向图中从 uv 到 wx 的边连接。

令 G 为有向图 令 L(G) 为有向线图

在给定 G 的情况下，我可以想出的生成 L(G) 的算法是：

*   遍历 G 的所有边以产生 L(G) 的节点
*   遍历 L(G) 中的所有节点对 (uv, wx) 并在 v = w 时连接

这是一个 O(n^2) 算法。

似乎应该有一种方法可以将其降低到 O(n) 时间。我要考虑一下，但我想我会问堆栈溢出，以防万一有一些我不知道的著名（或不那么著名）算法可以做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T21:57:53.287

嗯...我认为经过一番思考后可能会有一种更省时的算法...但是这样做需要大量的簿记和大量的额外内存。

我的基本想法是遍历 G 中的所有节点，并从连接到每个节点的边创建连接节点。通过一个额外的链接来跟踪 G(edge) 到 L(G)(node)，您可能只需一个循环通过 G 上的节点就可以逃脱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:03:52.713

您无法从 O(n^2) 中进行扩展，因为有些图具有线性图，其边的基数等于原始顶点的基数的平方：例如，在具有 n+1 个顶点的图，其中一个顶点连接到其他所有顶点：然后您必须构建一个具有 n 个顶点的集团，因此具有 (n-1)^2 条边。

算法的复杂性从底部开始受到它产生的输出大小的限制。

当然，这并不意味着我们不必寻找智能算法。我当时是这么想的：

```
LG(LN,LE) getLinearGraph(G(N,E)) {
  LN = EmptySet();
  LE = EmptySet();
  for (Vertex v : N) {
    verticesToAdd = EmptySet()
    for (Vertex i : out-degree(v) {
      toAdd += textual-rep((v,i));
    }
    LN += toAdd;
    LE += make-clique(toAdd);
  }
} 
```

# c++ - 异步 OLE 拖放可能吗？

> ID：947427
> 
> 赞同：0
> 
> 时间：2009-06-03T21:41:52.977
> 
> 标签：c++, asynchronous, drag-and-drop

我想知道是否有人知道是否有任何方法可以从 C++ Win32 应用程序启动 OLE 文件拖动而不会阻塞，直到拖动完成。

我目前正在使用[DoDragDrop()](http://msdn.microsoft.com/en-us/library/ms678486%28VS.85%29.aspx "MSDN 上的 DoDragDrop")开始拖动操作，但是该函数在拖动操作完成之前不会返回。问题是我的程序中的动画在拖动过程中停止。

我试图从一个新线程启动这个命令，但这没有用，即使我在这个线程中调用了 OleInitialize()。

我发现与此相关的唯一一件事是之后异步执行数据操作（例如复制/移动文件/数据）。在我的应用程序中，拖放不用于此类操作，因此这不是问题，主要问题是用户执行拖动时的块。编辑：要更清楚一点：DataObject 上的 IAsyncOperation 不是解决此问题的方法，因为它只会使操作在数据被删除后发生异步。我遇到的问题是从用户开始拖动直到他释放鼠标按钮的那一刻的阻塞行为。

确实想到了 2 个解决方案，但我希望有一种更简单或更好的方法来实现这一点。

1.  实现我自己的（非 ole）拖放。这将是更多的工作，我实际上发现它是一个很好的功能，它可以将文件从我的程序中拖到其他程序中。

2.  创建/启动一个新进程并从那里开始拖动操作。由于在我的应用程序中从 Windows 资源管理器中拖动文件时没有问题，我认为这可能有效。不过，拖动应该立即开始，我不知道创建一个新进程是否需要任何明显的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T23:11:21.533

如果您的 IDataObject 支持 IAsyncOperation 接口，则 IDropTarget 将具有允许 IDropTarget::Drop() 快速退出的选项，然后异步执行实际传输。但是，IDropTarget 不需要支持 IAsyncOperation。

此行为在[MSDN 的文档](http://msdn.microsoft.com/en-us/library/bb776904.aspx#async)中有所描述。此外，DoDragDrop() 在用户释放鼠标以启动拖放之前不会退出，因此当用户拖动鼠标时，调用 DoDragDrop() 的线程仍将被阻塞。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-25T14:48:29.533

在单独的线程中运行动画。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T00:06:57.427

雷米的回答是正确的。[The Old New Thing](http://blogs.msdn.com/oldnewthing/)还有一组关于实现[IDataObject](http://blogs.msdn.com/oldnewthing/archive/2008/03/20/8080229.aspx)的博客文章。它不会进入 IAsyncOperation，但它是一个开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T22:39:46.573

我遇到过这个。我会启动一个新线程并执行此操作。CreateProcess 确实需要时间，但可能不会很多。您总是可以提前创建线程或进程并对其进行同步，以便它在调用 DoDragDrop() 之前阻塞，然后从主应用程序中解除阻塞。

# python - 如何在 DJango 的每次页面刷新时重新加载全局变量

> ID：947436
> 
> 赞同：0
> 
> 时间：2009-06-03T21:43:37.640
> 
> 标签：python, django

这是我的问题。DJango 在第一次运行脚本后继续存储所有全局对象。例如，您在 views.py 中全局实例化的对象将一直存在，直到您重新启动应用服务器。这很好，除非您的对象绑定到一些可能超时的外部资源。现在我想纠正的方法是某种工厂方法，它检查对象是否被实例化，如果不是，则创建它，然后返回它。但是，由于该对象自上次页面请求以来就存在于那里，因此 this 失败，因此工厂方法始终返回在第一个请求期间实例化的对象。

我正在寻找的是一种在每个请求的基础上触发某些事情发生的方法。我已经看到了通过实现自己的中间件来做到这一点的方法，但我认为这太过分了。有谁知道一些保留方法或其他每个请求触发器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T21:56:42.933

简单：不要使用全局对象。如果您想要视图内的对象，请在视图内实例化它，而不是全局。这样，它将在视图结束后被收集。

# computer-algebra-systems - 有没有办法使 Pari/GP 中的小数合理化？

> ID：947445
> 
> 赞同：1
> 
> 时间：2009-06-03T21:45:20.927
> 
> 标签：computer-algebra-systems, pari-gp

我正在寻找一种在 PARI/GP 计算器 (gp) 中将十进制值转换为分数的自动化方法。比如我想把0.759765625变成389/512。我知道我可以通过输入“759765625/10^9”手动执行此操作，但我想要一种更简单的方法，例如“合理化（0.759765625）；” 将在千里马工作。

如果它不能直接做到这一点，也许有一个计算小数位数的功能？然后我可以将该函数的结果提高 10。（该函数必须计算 0 的前导小数位才有用。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-05T01:30:59.070

使用 bestappr() 函数；对于给出的示例，使用 bestappr(0.759765625,10^9)。（回答由 PARI/GP 邮件列表提供。）

这仍然有必须手动指定小数位数的缺点，但这可以克服：bestappr() 的第二个参数可以是 10 的非常大的幂，大于您将需要的最长小数“合理化”。

注意：确保在调用 bestappr 之前使用 \p 命令将精度设置得足够高。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T15:28:36.327

在 pari-2.5 中，您可以直接使用 bestappr(x)，而无需指定额外的位数参数。它将使用所有内部可用的数字：

```
? bestappr(Pi)
%1 = 17004845848539028973023/5412810546621363616752 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-08T11:25:42.683

两种很好的方法：

一）使用`lindep`：

```
x=Pi;digits=7;l=lindep([x,1],digits);-l[2]/l[1] 
```

b) 通过在遇到大的部分商时停止来使用连分数（下面，我将限制固定为 1000）：

```
x=Pi;maxquot=1000;p0=0;p1=1;q0=1;q1=0;a=floor(x);while(a<maxquot,p2=a*p1+p0;q2=a*q1+q0;p0=p1;p1=p2;q0=q1;q1=q2;x=1/frac(x);a=floor(x));p1/q1 
```

# jquery - 失去焦点时Ajax星级评分重置（jquery）

> ID：947463
> 
> 赞同：1
> 
> 时间：2009-06-03T21:51:23.067
> 
> 标签：jquery, ajax, rating

我正在为 AJAX 评级系统使用以下代码

```
jQuery.fn.rater = function(url, options)
{
    if(url == null) return;
    var settings = {
        url       : url, // post changes to 
        maxvalue  : 5,   // max number of stars
        curvalue  : 0    // number of selected stars
    };

    if(options) { jQuery.extend(settings, options); };
    jQuery.extend(settings, {cancel: (settings.maxvalue > 1) ? true : false});

    var container = jQuery(this);
    jQuery.extend(container, { averageRating: settings.curvalue, url: settings.url });

    var raterwidth = settings.maxvalue * 25;
    var ratingparent = '<ul class="star-rating" style="width:'+raterwidth+'px">';

    container.append(ratingparent);

    // create rater
    var starWidth, starIndex, listitems = '';
    var curvalueWidth = Math.floor(100 / settings.maxvalue * settings.curvalue);
    for(var i = 0; i <= settings.maxvalue ; i++) {
        if (i == 0) {
            listitems+='<li class="current-rating" style="width:'+curvalueWidth+'%;">'+settings.curvalue+'/'+settings.maxvalue+'</li>';
        } else {
            starWidth = Math.floor(100 / settings.maxvalue * i);
            starIndex = (settings.maxvalue - i) + 2;
            listitems+='<li class="star"><a href="#'+i+'" title="'+i+'/'+settings.maxvalue +'" style="width:'+starWidth+'%;z-index:'+starIndex+'">'+i+'</a></li>';
        }
    }
    container.find('.star-rating').append(listitems); // i am using find here, because the span wrapped in the small style would break children()

    if(settings.maxvalue > 1) // add a container for the ajax result
    {
        container.append('<span class="star-rating-result"></span>'); 
    }
    var stars = jQuery(container).find('.star-rating').children('.star');
    stars.click(function()
    {
        if(settings.maxvalue == 1) // on / off
        {
            settings.curvalue = (settings.curvalue == 0) ? 1 : 0;
            jQuery(container).find('.star-rating').children('.current-rating').css({width:(settings.curvalue*100)+'%'});
            jQuery.post(container.url, { "rating": settings.curvalue });

            return false;
        }
        else
        {

            settings.curvalue = stars.index(this) + 1;
            raterValue = jQuery(this).children('a')[0].href.split('#')[1];
            jQuery.post(container.url, { "rating": raterValue }, function(response){
                container.children('.star-rating-result').html(response)    
            });
            return false;
        }
        return true;
    });

    return this; 
} 
```

问题是当我点击星星以外的其他东西时，评级会自行重置。

**您能否提出一些方法来使评级在失去焦点时保持其价值？**

# user-interface - 支持一致/标准化用户体验的实际指标/分析

> ID：947468
> 
> 赞同：0
> 
> 时间：2009-06-03T21:52:45.357
> 
> 标签：user-interface, user-experience

我正在寻找有关使用标准化或一致（阅读：可访问且美观）用户体验/用户界面的实际研究/分析类型数据（实数）。

具体来说，这些信息将被引用来支持标准化和改造现有的（可怕的）Web 应用程序，但我很确定客户保留率和良好的用户体验指标适用于所有方面。

如果这还不够与编程相关，我道歉并接受投票结束。

**编辑：**看来我可能使用了不正确的术语。为了澄清一点，根据迄今为止的答案，我正在寻找“良好设计的好处”和“展示其优势的定量研究”。我认为结合这两个引用很好地总结了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T12:44:40.197

经验支持的网络可用性标准的黄金标准是[usability.gov](http://www.usability.gov/pdfs/guidelines.html)。每个标准都包括对量化研究的引用，以证明其优势。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T22:39:49.553

无论如何，这都是一个非常敏感的感觉数据。

只有当它应用于您的产品的普通用户时，它才真正与您相关。时间也是一个因素。过去，主要问题是让从未使用过计算机的人在日常工作生活中使用计算机。现在几乎每个人都使用计算机（并且主要是基于 Windows 的计算机）。因此，我相信，重点已经从低级标准化用户界面转变为流程、功能可发现性、用户体验等。

所以我看不出任何类型的“公共”数据会如何以任何方式帮助你，除非你用你的产品对一系列普通用户进行可用性测试，并以此为基础你的事实。

# c# - 从另一个线程（.Net）调用 Windows 窗体

> ID：947476
> 
> 赞同：5
> 
> 时间：2009-06-03T21:54:44.263
> 
> 标签：c#, .net, multithreading

嗨，我正在开发一个 .Net 应用程序，我想实现以下目标：

我有一个 winforms 应用程序和一个计时器（System.Timers.timer），它根据计划执行线程。问题是我无法从辅助线程（WorkerThread）访问 UI（Windows 窗体），错误说无法从没有创建它的线程访问组件之类的东西。

有什么办法可以做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T21:56:15.990

```
 formObject.Invoke(delegate { 
      // action to perform on UI thread
 }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T22:01:14.983

假设您的工作方法（您在线程中执行）是

```
DoWork(args)
{
    ...
    UpdateUI();
} 
```

处理计时器的 Elapsed 事件的方法应该这样做：

```
OnTimerElapsed(object sender, ElapsedEventArgs e)
{
    args = GetArgs();
    this.BeginInvoke(() => DoWork(args));
    // 'this' refers to form here.
    // You can also use BeginInvoke on a user control for updating it.
} 
```

这将在单独的线程中运行 DoWork，并且 DoWork 将具有更新 UI 的能力。

# php - PHP 5.2 和 PHP 5.3 在同一 Apache (Debian) 上的 vHost 中并排使用？

> ID：947485
> 
> 赞同：3
> 
> 时间：2009-06-03T21:56:38.453
> 
> 标签：php, apache2

是否有机会在不同的 vHost 中的同一台机器上运行各种版本的 PHP（现在我希望并排使用 5.2 和 5.3）？我正在运行 Debian 服务器，PHP 包来自 dotdeb.org - 有没有简单的方法来实现这样的设置？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T22:01:30.550

安装到不同的模块名称，例如

```
mod_php52
mod_php53 
```

如果您使用 ./configure 构建，请不要忘记指定不同的配置目录

在虚拟主机 1

```
LoadModule mod_php52 modules/mod_php52.so 
```

在虚拟主机 2

```
LoadModule mod_php53 modules/mod_php53.so 
```

**警告**我没有尝试过这个，可能会有各种各样的库问题，所以要小心两个模块不要尝试使用相同的库。尽可能多地将依赖项构建到不同的目录中。它可能会变得棘手！

# c++ - C++ 是否存在循环列表的标准实现？

> ID：947489
> 
> 赞同：26
> 
> 时间：2009-06-03T21:57:04.943
> 
> 标签：c++, data-structures, circular-list

我想使用一个循环列表。

没有实现我自己的（[就像这个人那样](http://cppcorner.3x.ro/circularlist.html)）我有什么选择？

具体来说，我想要做的是遍历对象列表。当我的迭代器到达列表的末尾时，它应该会自动返回到开头。（是的，我意识到这可能很危险。）

[请参阅 Vladimir 对 a 的定义`circular_iterator`](http://cppcorner.3x.ro/circularlist.html)：“circular_iterator 永远不会与 CircularList::end() 相等，因此您始终可以取消引用此迭代器。”

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-03T22:09:47.023

没有标准的循环列表。

但是，Boost 中有一个[循环缓冲区](http://www.boost.org/doc/libs/1_39_0/libs/circular_buffer/doc/circular_buffer.html)，这可能会有所帮助。

如果您不需要任何花哨的东西，您可以考虑只使用 a`vector`并使用索引访问元素。你可以只`mod`用你的索引和向量的大小来实现与循环列表大致相同的事情。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-03T23:05:11.653

如果你想要一个看起来像迭代器的东西，你可以自己滚动，看起来像

```
template <class baseIter>
class circularIterator {
    private:
        baseIter cur;
        baseIter begin;
        baseIter end;
    public:
        circularIterator(baseIter b, baseIter e, baseIter c=b)
            :cur(i), begin(b), end(e) {}
        baseIter & operator ++(void) {++cur; if(cur == end) {cur = begin;}}
}; 
```

（其他迭代器操作留给读者练习）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-05-03T17:33:48.697

```
list<int>::iterator circularNext(list<int> &l, list<int>::iterator &it)
{
    return std::next(it) == l.end() ? l.begin() : std::next(it);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-04-20T09:57:21.350

除了@captain-segfault 和@mahmoud-khaled 的以迭代器为中心的答案之外，您还可以`std::list`通过更改从中检索元素的操作将其用作循环列表。在处理列表时，使用[splice](https://en.cppreference.com/w/cpp/container/list/splice)将列表的一端移动到另一端。

```
template <typename T>
T & circularFront(std::list<T> & l)
{
  l.splice(l.end(), l, l.begin());
  return l.back();
}
template <typename T>
T & circularBack(std::list<T> & l)
{
  l.splice(l.begin(), l, l.rbegin());
  return l.front();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-19T11:03:40.597

我找到了这个解决方案。对我来说很好。

```
std::list<int> List{ 1,2,3,4,5,6 };

    auto it = List.end();

    it--;

    it._Ptr->_Next = List.begin()._Ptr; // Next Node of the last elemen is now first elemen of the List
    List.begin()._Ptr->_Prev = it._Ptr; // Prev Node of the first element is now Last node

    for (int num : List)
    {
        std::cout << num << '\n';
    } 
```

在这种情况下，我们将无限循环。也应该向后工作。

# **输出**

```
1
2
3
4
5
6
1
2
3
4
5
6
1
.
. 
```

# javascript - 从脚本授予 SeServiceLogonRight

> ID：947490
> 
> 赞同：1
> 
> 时间：2009-06-03T21:57:19.560
> 
> 标签：javascript, windows, scripting, cmd

我需要能够从脚本（批处理文件或 JScript 文件）向用户授予权限。特别是，我想将 SeServiceLogonRight 授予特定域帐户。我不能使用 NTRights.exe（并非在所有目标操作系统上都可用），并且我想避免为此必须在 C 中编写可执行文件。是否可以使用标准的 Windows 工具、WMI api 或任何其他可以从脚本中使用的东西来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T06:24:46.543

AFAIK，不。您需要 NTRIights.exe 或包含相应 LsaXXX WinAPI 函数的自定义工具或自动化对象。

# .net - 在 Windows 中添加全局键盘快捷键的最简单方法是什么？

> ID：947492
> 
> 赞同：7
> 
> 时间：2009-06-03T21:57:34.053
> 
> 标签：.net, windows, keyboard-shortcuts

我希望我的应用程序在未运行时检测键盘快捷键，但由于在 Windows 中似乎没有执行此操作的工具，因此合理的后备是拥有一个没有任何 UI 来侦听按键的后台进程。当应用程序不在.Net的前台时，是否可以监视按键？

看起来这篇[CodeProject 文章](http://www.codeproject.com/KB/vb/mclhotkeynet.aspx)有我需要的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T22:04:18.423

Windows 快捷方式可以有一个关联的热键——右键单击“开始”菜单中的任何程序，转到“属性”，您将看到一个“快捷键”框。然后，Windows 将代表您查找该热键，并在看到它时启动您的程序。（我用它来制作`Ctrl+Alt+C`启动计算器。）

要以编程方式进行设置，请使用[IShellLink](http://msdn.microsoft.com/en-us/library/bb774950(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T22:41:12.063

通过调用此 API：

注册热键

[http://msdn.microsoft.com/en-us/library/ms646309.aspx](http://msdn.microsoft.com/en-us/library/ms646309.aspx)

[http://www.pinvoke.net/default.aspx/user32/RegisterHotKey.html](http://www.pinvoke.net/default.aspx/user32/RegisterHotKey.html)

然后重写这个方法“WndProc”来监控按键。

```
protected override void WndProc(ref System.Windows.Forms.Message m)
    {
        // let the base class process the message
        base.WndProc(ref m);

        // if this is a WM_HOTKEY message, notify the parent object
        const int WM_HOTKEY = 0x312;
        if (m.Msg == WM_HOTKEY) ............... 
```

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.wndproc(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.wndproc(VS.71).aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T22:44:57.140

[这个库](http://www.codeproject.com/KB/system/globalsystemhook.aspx)也不错

EDIT: I recently created this library, which uses a different approach: [NHotkey](https://github.com/thomaslevesque/NHotkey)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T21:59:51.443

没有办法让它非侵入性。

添加全局键盘快捷键总是很麻烦。如果您无论如何都必须这样做，请确保它是一个选择加入，而不是选择退出功能。

# php - PHP 模板循环结果

> ID：947496
> 
> 赞同：0
> 
> 时间：2009-06-03T21:58:17.827
> 
> 标签：php, loops, include, templating

所以在工作中，我们有一个自制的模板系统，它重量轻，到目前为止对我们来说效果很好。

我们遇到的障碍是我们希望能够循环一个模板。用例类似于搜索结果。我们正在努力想办法做到这一点。我们现在想出了三种方法。首先是将 html 存储在循环中，然后循环遍历它并使用 concat 将变量放入 html 中。我们想到的第二种方法是重复包含一个文件。第三种方法是包含文件一次，使用输出缓冲来捕获其输出，将文本 echo " 添加到它，然后在其上使用 eval。（我的老板希望我们想出创造性的方法来做到这一点）。

好吧，我更喜欢包含重复方法，因为它允许我们将 html 与逻辑完全分离。eval 方法也可以做到这一点，但它似乎更骇人听闻。好吧，我们对此进行了一些时间测试，发现将 html 放在循环中（方法一）是最快的，紧随其后的是 eval 方法，包括多次进入最后。包括实际上比 eval 方法慢了大约 5-6 倍。（我们包含文件/评估文件 1000 次，并做了 100 次并对它们取平均值以获得我们的结果）。

有什么方法可以加快多重包含？（看起来每次我们执行 include php 都会再次访问文件系统。）

或者有没有人有办法完成这种事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-10T20:05:01.327

正如您的测试所示，优化脚本的最佳方法是将已经包含的 HTML 代码循环到您的脚本中。

影响时间来自：

*   eval() 调用 PHP 解析器来验证代码
*   include() 使用磁盘访问

然后，每个 include() 都会降低读取未更改文件磁盘的性能。优化此磁盘访问将是您的 eval() 选项：

*   include(): 初始解析器 + [磁盘访问 + 解析器]*N 循环；
*   eval()：初始解析器 + 磁盘访问 + 解析器*N 循环
*   内联 HTML：初始解析器

为了保持代码干净，您可以创建包含 HTML 的函数、使用全局变量或包含需要显示到 HTML 中的所有数据的单个对象或数组变量，例如

```
function html_comment ($comment)
{
    //global $comment;

    ?>
    <div class="comment">
        <div class="author"><?php echo $comment['author'] ?></div>
        <div class="date"><?php echo $comment['date'] ?></div>
        <div class="date"><?php echo $comment['content'] ?></div>
    </div>
    <?php
}

...
foreach ($comments as $comment)
    html_comment($comment); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-08T23:23:13.030

老问题，我知道。

无论如何，我建议在模板中使用一个简单的 for 或 foreach 循环。没有什么不妥。首先，因为在我看来循环遍历一些演示代码仍然是演示逻辑（因为这也使得将输出从列输出更改为行输出变得更容易——愚蠢的例子）。其次，PHP 仍然是一种模板语言。在模板中使用一些简单的控制结构并没有错。使用像 Smartys 这样的系统只是添加了另一层抽象（需要学习另一种语法），它具有 PHP 的大部分功能（因此会产生相当多的开销）。这在我看来是无稽之谈（旁注：对我来说，这是[内部平台效应](http://en.wikipedia.org/wiki/Inner-platform_effect "维基百科的内部平台效应")，一种反模式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T22:07:44.487

缓存最后一页。我的意思是把你所有的“块”（循环，片段，无论你想怎么称呼它们），并将它们加入到缓存中的一个 PHP 文件中，然后从那时起就包含它。这样，您每次请求只需访问文件系统一次，而不是 25 次。

# oracle - 如何将多个 SQL 查询结果集成到一个输出中（Oracle）

> ID：947504
> 
> 赞同：1
> 
> 时间：2009-06-03T22:00:14.017
> 
> 标签：oracle, plsql

我的服务器具有以下系统：

Windows 2003 R2 Ent Edition SP 2 Oracle 1.0.2.0.4.0 数据库：5

数据库的归档日志位于闪回恢复区，如 v$recovery_file_dest 的 NAME 列所示，也可以从 sqlplus 调用“show parameter db_recovery_file_dest”。我想使用 SQL 或 PLSQL 脚本监控每个数据库归档日志的空间使用情况。

如果我调用下面的查询：

```
SET LINESIZE 145
SET PAGESIZE 9999

COLUMN name               FORMAT a30                  HEADING 'Name'
COLUMN space_limit        FORMAT 99,999,999,999,999   HEADING 'Space Limit'
COLUMN space_used         FORMAT 99,999,999,999,999   HEADING 'Space Used'
COLUMN space_used_pct     FORMAT 999.99               HEADING '% Used'
COLUMN space_reclaimable  FORMAT 99,999,999,999,999   HEADING 'Space Reclaimable'
COLUMN pct_reclaimable    FORMAT 999.99               HEADING '% Reclaimable'
COLUMN number_of_files    FORMAT 999,999              HEADING 'Number of Files'

prompt 
prompt Current location, disk quota, space in use, space reclaimable by deleting files,
prompt and number of files in the Flash Recovery Area.
prompt 

SELECT
    name
  , space_limit
  , space_used
  , ROUND((space_used / space_limit)*100, 2) space_used_pct
  , space_reclaimable
  , ROUND((space_reclaimable / space_limit)*100, 2) pct_reclaimable
  , number_of_files
FROM
    v$recovery_file_dest
ORDER BY
    name
/ 
```

我会得到这样的输出：

```
Name                                   Space Limit          Space Used  % Used   Space Reclaimable % Reclaimable Number of Files                 
------------------------------ ------------------- ------------------- ------- ------------------- ------------- ---------------                 
D:\oracle\product\10.2.0\flash     107,374,182,400      34,239,603,712   31.89                   0           .00             804                 
_recovery_area\DBNAME 
```

我的问题是：如何将每个数据库中每个类似查询的结果整合到一个输出中？

输出将如下所示：

```
 Name                                   Space Limit          Space Used  % Used   Space Reclaimable % Reclaimable Number of Files                 
    ------------------------------ ------------------- ------------------- ------- ------------------- ------------- ---------------                 
  D:\oracle\product\10.2.0\flash     107,374,182,400      34,239,603,712   31.89                   0           .00             804                 
_recovery_area\DBNAME1   

D:\oracle\product\10.2.0\flash     107,374,182,400      34,239,603,712   31.89                   0           .00             804                 
    _recovery_area\DBNAME2

D:\oracle\product\10.2.0\flash     107,374,182,400      34,239,603,712   31.89                   0           .00             804                 
    _recovery_area\DBNAME3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T23:36:00.173

我假设您希望所有数据库结果都在一个结果集中，而不是只依次连接到每个结果集并将输出假脱机到同一个文件。您必须选择其中一个数据库并创建到其他四个的数据库链接（在每个数据库中选择或创建一个连接用户，该用户对 V$RECOVERY_FILE_DEST 具有 SELECT 权限。

然后你的查询变成

```
select ...
 from v$recover_file_dest
union all
select ...
from v$recover_file_dest@db2
union all
select ...
from v$recover_file_dest@db3
union all
select ...
from v$recover_file_dest@db4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T22:11:24.960

使用 UNION 将单独查询的结果连接到一个集合中。例如：

```
select name, space_limit, etc...
from v$recovery_file_dest
UNION
select name, space_limit, etc...
from v$recovery_file_dest  -- presumably a different value than the first one 
```

应该没问题，因为每个查询以相同的顺序返回相同的列集。

# asp.net - ASP.NET Membership - 当您在同一个 WebApp 中调用 WebService 时，经过身份验证的用户会丢失

> ID：947512
> 
> 赞同：0
> 
> 时间：2009-06-03T22:02:16.913
> 
> 标签：asp.net, wcf, web-services, asp.net-membership, forms-authentication

我正在使用 ASP.NET 登录控件进行身份验证。

我有一些用户，他们能够成功登录。经过身份验证后，我重定向到页面 helloworld.aspx。在 Page_Load 方法中，我首先调用 Membership.GetUser()。这将正确返回经过身份验证的用户。然后，我调用驻留在同一个 WebApplication 中的简单 WCF Web 服务。我的 WebService 调用的第一行是相同的 Membership.GetUser()。这一次虽然它返回 NULL。

有什么想法吗？

谢谢，贾斯汀

这是一些代码片段

贾斯汀佩奇.aspx

```
public partial class JustinPage : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        MembershipUser user = Membership.GetUser();
        // user is a valid user

        JustinService.JustinTestServiceClient justin = new CMS.WEB.JustinService.JustinTestServiceClient();
        justin.DoWork();
    }
} 
```

JustinTestService.svc.cs

```
[ServiceContract(Namespace = "")]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class JustinTestService
{
    [OperationContract]
    public void DoWork()
    {
        MembershipUser user = Membership.GetUser();
        // user is NULL ???  Why?
        return;
    }
} 
```

如前所述，服务源代码位于与 Justin.aspx 相同的 WebApplication 中，正如您从端点看到的那样（注意我的应用程序固定在端口 19003 上）...

端点地址="http://localhost:19003/Services/JustinTestService.svc" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_JustinTestService" contract="JustinService.JustinTestService" name="BasicHttpBinding_JustinTestService" /

绑定看起来像这样......

<绑定名称="BasicHttpBinding_JustinTestService" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false" bypassProxyOnLocal= "false" hostNameComparisonMode="StrongWildcard" maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true"> <readerQuotas maxDepth= "32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384" /> <security mode="None"> </安全> </绑定>

也许它与 <security mode="None"> 有关系？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T01:52:25.123

问题是 Web 服务调用不是来自用户经过身份验证的浏览器。相反，您是从您的应用程序发起 Web 服务调用（您的 Web 服务器正在向您的 Web 服务器创建一个 HTTP 请求！）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T02:09:39.693

获取 fiddler 并查看身份验证 cookie 是否正在通过网络发送。

如果不是，您可能需要将其捆绑在您对服务的请求中。

像这样的东西

```
Service1Client ws = new Service1Client(); // Name of webclient proxy
            using (OperationContextScope scope = new OperationContextScope(ws.InnerChannel))
            {
                HttpRequestMessageProperty httpRequest = new HttpRequestMessageProperty();
                OperationContext.Current.OutgoingMessageProperties.Add(HttpRequestMessageProperty.Name, httpRequest);

                HttpCookieCollection cc = Page.Request.Cookies;
                if (Request.Cookies[".ASPXAUTH"] != null)
                {
                    HttpCookie aCookie = Request.Cookies[".ASPXAUTH"];
                    String authcookieValue = Server.HtmlEncode(aCookie.Value);
                    httpRequest.Headers.Add("Cookie: " + ".ASPXAUTH=" + authcookieValue);
                }

                // Make call to webservice here
                ws.MyWCFCall();

                HttpResponseMessageProperty response = (HttpResponseMessageProperty)OperationContext.Current.IncomingMessageProperties[HttpResponseMessageProperty.Name];
            } 
```

# jquery - CSS/Jquery 显示隐藏子菜单

> ID：947513
> 
> 赞同：2
> 
> 时间：2009-06-03T22:02:22.827
> 
> 标签：jquery, css

仍在尝试找出 jQuery，我需要一些关于侧边栏列表的帮助。

在尝试了一些东西后，我正在编辑它。

我试图隐藏子菜单，直到将鼠标悬停在特定列表项上，然后另一个菜单出现在侧边栏的一侧，您可以将鼠标悬停在这些选择上。我到了一半，但是当您将鼠标移出时，它会在您将鼠标悬停在任何项目上之前消失。我将添加 hoverIntent 但我认为这不是问题，因为我需要整个隐藏块也成为显示该元素的触发器。我在下面尝试了 Steerpikes 解决方案，但它导致整个主列表在鼠标移出后消失。

这是现在的结构：

```
<ul>
<li>Always Showing Element</li>
<li class="trigger">Title that triggers Submenu
<ul>
<li>
Hidden Menu
</li>
</ul>
</li>
</ul> 
```

和脚本

```
$('li.trigger ul').hide();
 $('li.trigger').hover(function() {
$('li.trigger ul').show();
},
function() {
      $('li.trigger ul').hide();
}); 
```

那么，当我的鼠标悬停在 li.trigger ul li elementes 上时，如何保持它显示？

感谢您的帮助！

没关系......这现在有效，我刚刚关闭了定位，但现在它有点重叠，并且悬停意图增加了一点延迟，没有问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T22:11:02.543

以下应该工作。我刚刚在 3 分钟前写了类似的东西 :)

```
<ul id='menu'>
<li><a href="">Always showing</a></li>
<li><a href="">Always showing Title of Submenu</a>
<ul>
<li><a href="">Hidden until hover over Title </a></li>
</ul>
</li>

$('#menu li').hover(function() {
        $(this).find('ul').show();
    },
    function() {
      $(this).find('ul').hide();
}); 
```

请记住，这[`hover()`](http://docs.jquery.com/Events/hover)需要两个参数 - 鼠标移入时会发生什么以及鼠标移出时会发生什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T16:52:55.863

我会考虑使用 CSS 来执行此功能。由于这是一个菜单，您希望它易于访问。关闭了 javascript 的用户（也可以考虑移动浏览器）或任何使用屏幕阅读器的人将无法使用您的菜单。

尝试查看：[http ://www.htmldog.com/articles/suckerfish/dropdowns/](http://www.htmldog.com/articles/suckerfish/dropdowns/)

这是一个多下拉菜单的 CSS 解决方案，效果应该很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-21T10:42:14.873

对于那些使用 class 而不是使用 id 的人，这是对我有用的代码：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<div id='menu_box'>
<ul class='menu'>
<li><a href="">Always showing</a></li>
<li><a href="">Always showing Title of Submenu</a>
<ul>
<li><a href="">Hidden until hover over Title </a></li>
</ul>
</li>
</ul>
</div>
<script>
$('#menu_box ul li ul').hide(); 
$('#menu_box ul li').hover(function() {
        $(this).find('ul').show();
    },
    function() {
      $(this).find('ul').hide();
});
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T22:19:14.417

您可能会发现将根元素设为块级元素并在该上下文中执行事件处理很有用。

# javascript - 在 jQuery 中注入 HTML 的元素中使用 Javascript

> ID：947517
> 
> 赞同：1
> 
> 时间：2009-06-03T22:03:42.373
> 
> 标签：javascript, jquery, dom, xhtml, code-injection

我正在尝试通过 jQuery 的 .load() 函数在远程加载（注入）的 HTML 文件中引用一些 javascript 文件。我试图在加载的 HTML 文件中使用的 javascript 文件已经包含在加载的 HTML 的父 HTML 页面中。

最初，我认为在加载的 HTML 中引用这些文件会很好，因为它包含在页面中，但它似乎不起作用。

谁能告诉我如何在注入的 HTML 文件中使用 javascript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T22:12:34.070

如果我理解正确，听起来您需要使用[`getScript()`](http://docs.jquery.com/Ajax/jQuery.getScript)- 这加载并执行使用 HTTP GET 请求的本地 JavaScript 文件。

```
$.getScript( url, [callback] ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-15T23:19:26.677

我相信你正在寻找的是 .live()

.live() 允许您“将处理程序附加到与当前选择器匹配的所有元素的事件，现在或将来。”

例如：

```
$(".clickme").click(function(){
  $(this).fadeOut();
} 
```

此代码不适用于已使用 .load() 或 .get() 注入页面的任何元素

但如果你这样做：

```
$(".clickme").live('click', function(){
  $(this).fadeOut();
} 
```

...它甚至可以在通过 javascript 注入页面布局的元素上工作。

更多信息在[jQuery AP](http://api.jquery.com/live/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T00:01:23.540

如果脚本元素是您加载的 html 的一部分，那么您只需将其附加到正文即可。

例子：

```
$.ajax({
    //...
    //...
    success: function(response) {
        // assuming response is a full HTML page
        var r = $(response);
        // append your content
        $("#someContainer").append($("#someContent", r));
        // append the scripts
        $("body").append($("script", r));
    }
    //...
    //...
}); 
```

当然你可以使用你自己的选择器，这只是一个例子。让我知道这对你有什么影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-07T21:50:01.500

1.  如果 test1.htm 包含：

    $(document).ready(function() { $('.main').load('test2.htm', function() { $('.result').text('页面已检索'); } ); });

2.  而test2.html包含：<script type="text/javascript" src="exscript.js"></script>

在文档的头部。

3.  exscript.js 包含：

    警报（“嗨”）；

如果您加载 test1.htm，您会收到通知。再见！:)

# algorithm - 如何建模算法的执行时间？

> ID：947525
> 
> 赞同：3
> 
> 时间：2009-06-03T22:05:32.803
> 
> 标签：algorithm, language-agnostic, model, big-o, performance

存在哪些算法运行时间模型？

我们都期望归并排序比冒泡排序更快，并注意归并排序使得 O(n log n) 与 O(n ² ) 的冒泡排序进行比较。

对于其他算法，您可以计算其他操作（比较和交换除外），例如指针取消引用、数组查找、固定大小整数的算术等。

**还有哪些其他方法来模拟执行时间？**

我自己知道的一个是计算从磁盘读取和写入磁盘的块数；请参阅我对 Big-O 表示法何时失败的回答[？](https://stackoverflow.com/questions/941283/when-does-big-o-notation-fail)冗长的描述。

另一个是计算缓存未命中的数量。这通过查看内存层次结构的所有级别来扩展 I/O 模型。

第三，对于分布式算法（例如在安全多方计算中），是计算通过网络传输的数据量（通常以通信轮数或消息数来衡量）。

为了预测算法的性能，还有哪些其他有趣的事情可以计算（而不是计算！）？

另外，**这些模型有多好？** 据我所知，缓存遗忘算法与磁盘数据的 I/O 效率算法相比具有竞争力，但对于内存算法则不然。

特别是：这些模型在哪些特定情况下错误地预测了相对性能？根据我自己的实验，当数据小到足以放入内存时，斐波那契堆不会加速 Dijstra 的最短路径（相对于二进制堆）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T22:22:00.573

您必须定义一个计算模型，估算每个操作的成本，然后根据这些成本分析您的算法；当然，成本取决于特定环境和您要部署算法的底层机器的特性，所以这个问题实在是太笼统了。

在算法课程中，我们只是假设每个操作花费 1，所以我们只计算循环的次数；在与主存一起工作的算法中，我们假设每个操作，除了 I/O 的读/写，成本为 0（和读/写 1），依此类推。

这些模型与现实紧密吗？这取决于现实：您的环境和您的机器。

您的缓存未命中计算在双核上可能是正确的，但在单元处理器上是错误的，例如，您必须手动传输 SPE 内存的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T22:16:16.653

我认为无论您使用 O(n...) 符号对执行时间/空间进行建模的基础如何，您都在假设一个规范化的环境。我认为无论您指定什么模型，无论您测量多少变量来确定它......它只适用于标准化环境。因此，当磁盘 I/O 在竞争方面较低时，可能不需要 O(n...) 来考虑这些开销......如果你明白我的意思的话。

因此 O(n) 对输入 n 在标准化环境中的典型性能进行建模。

通过扩展，您可以说磁盘读取的顺序为 O(n)，或者内存分配的顺序为 O(n)，依此类推。增加压力的外部事件（例如调度）不应该在典型的时间/空间/任何事情发生的模型中发挥作用。

或者也许我错过了你的观点（我怀疑我可能是）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T22:31:18.743

对于我工作的实时平台，最近我发现复制大量数据（例如：在 KB 范围内，而不是 MB 范围内）实际上比我受过训练的预期要快得多。这可能与当今使用的大型缓存有关，或者可能只是处理器速度极快。但效果是，人们真的不应该再为了避免数据复制而过度扭曲自己的代码。

相反，我真正需要注意的是设备访问和上下文切换。这些越少越好。

“零缓冲”设备驱动程序与速度同义的时代已经结束。

# post - ColdFusion CFHTTP Post 正在执行第二个 GET 请求

> ID：947530
> 
> 赞同：4
> 
> 时间：2009-06-03T22:06:42.240
> 
> 标签：post, coldfusion, get, cfhttp

我正在使用 ColdFusion 8。

我正在向远程服务器发送 CFHTTP Post。远程站点查看了他们的日志，他们说我的代码正在执行 POST，然后立即执行第二个 GET 请求。

这是我的代码（网址已更改）：

```
<cfhttp url="https://www.theurlofthesite.com" method="POST" port="443" resolveurl="yes" redirect="yes">
<cfhttpparam type="FORMFIELD" name="type" value="SALES">
<cfhttpparam type="FORMFIELD" name="account" value="10003">
<cfhttpparam type="FORMFIELD" name="Submit" value="Submit+Request">
</cfhttp>

<Cfoutput>#cfhttp.fileContent#</CFOUTPUT>

<cfdump var="#cfhttp#"> 
```

有谁知道为什么他们在我的 POST 之后立即看到第二个 GET 请求？它正在破坏会话并且因此无法正确返回页面（我们认为）

我肯定不会做 GET，我只会做一个 POST。

谢谢，

富有的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-04T00:50:47.853

我猜您获得第二个 GET 的原因是您的 CFOUTPUT 将检索到的页面内容输出到浏览器中，然后当从检索到的页面呈现来自该内容的图像或某些内容时，它充当 GET。

请记住，CFHTTP 不是有状态的。我的意思是每个使用 CFHTTP 的请求都会创建一个新会话。您可以通过在请求中使用 CFHTTPPARAM 传入 CFID/CFTOKEN 来让 CFHTTP 继续现有会话。这可能会解释您的会话问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T22:26:59.673

```
redirect="false" //maybe? 
```

不确定...因为医生说...

> 如果响应头包含 Location 字段并且 ColdFusion 接收到 300 系列（重定向）状态代码，则指定是否将执行重定向到该字段中指定的 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T17:06:25.797

好的，我切换到 CF 5 服务器，它停止执行第二次 GET。它只是`POST`现在做的，所以它可能是 CF 8 的一个怪癖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-08T12:59:18.910

如果您使用的是 firefox，请确保您已为您的请求关闭了 firebug 和 ySlow。他们两次触发您的网址来设置他们的数据，当您不知道他们正在这样做时，这可能是一个真正的问题。

此外，除非您需要，否则请尝试关闭重定向。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-06-03T23:56:00.913

此代码是否在自定义 CF 标记内？如果是这样，那么打电话

```
<mytag>...</mytag> 
```

或者

```
<mytag /> 
```

两次调用自定义标签！（一次用于开始标签，一次用于结束。）

# automated-tests - Quicktest Pro - 匹配文本后找到第一个按钮

> ID：947543
> 
> 赞同：2
> 
> 时间：2009-06-03T22:10:47.083
> 
> 标签：automated-tests, qtp

我想使用动态对象识别（描述性编程）来找到在某些给定文本之后出现的第一个标记为“删除”的按钮（例如，出现在文本“项目 XYZ-123”之后的第一个删除按钮）。如果文本和按钮都在 webtable 的单行内，我有一种笨拙的方法，但我希望有一个更优雅或更可靠的解决方案（希望不依赖表格的解决方案）。

我宁愿避免使用 .Object 属性，因为文档声称 .Object 属性仅在您在 IE 中测试时返回 DOM 对象，而不是在 Firefox 中。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T14:22:37.207

假设没有更简单的方法可以做到这一点，您可以尝试解析 HTML。在 HTML 中找到搜索文本，然后从该点开始在 HTML 中搜索“删除”按钮。您应该能够从可用于描述性编程的 HTML 中提取 id 或其他标识属性。

您是否有示例 HTML 和 QTP 代码可供我们查看以了解更多详细信息？也许有更简单的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T08:04:14.033

这是一个使用该`sourceIndex`属性的解决方案，请注意这`sourceIndex`是一个仅限 IE 的属性，但 QTP 在 Firefox 上模拟它，因此相同的脚本将在两个浏览器上运行。您可以选择使用基于坐标的属性，例如`abs_x`，`abs_y`如果`source_index`不符合要求。

下面的代码回答了所提出的问题，使其成为一个通用函数，留给读者作为练习；o)

```
''#1\. Create description for locator text 
Set textD = Description.Create()
textD("micclass").Value = "WebElement"
textD("innertext").Value = ".*Item XYZ-123.*"

''#2\. Find locator sourceIndex
set texts = Browser("B").Page("P").ChildObjects(textD)
Set text = texts(texts.Count-1) ' Take last text '
textIdx = text.GetROProperty("source_index") ' works for FF too '

''#3\. Create description for button 
Set buttonD = Description.Create()
buttonD("micclass").Value = "WebButton"
buttonD("value").Value = "Delete"
Set btns = Browser("B").Page("P").ChildObjects(buttonD)

''#4\. Find first button after locator text 
For i = 0 To btns.Count
    If btns(i).GetROProperty("source_index") > textIdx Then
        btns(i).Click ' Or whatever you want to do with it '
        Exit For
    End If
Next 
```

**关于此解决方案的注意事项：**

*   它不对包含文本的元素做任何假设，如果您知道这是元素中的整个文本，您可以删除`.*`s 和/或添加“html 标签”以获得更好的性能。
    *   这就是为什么我们采用符合描述的最后一个元素，第一个元素将是`BODY`等。
*   在文本的描述中，我们必须指定“micclass”=“WebElement”，因为默认情况下会`ChildObject`过滤掉`WebElement`s 假设它们不感兴趣。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-13T18:42:14.330

让我先重新表述一下这个问题。

如果行号未知但您有唯一的键值来查找行，如何检索对 WebTable 中包含的对象的引用？

这适用于按钮、复选框、组合框和表格中的任何其他对象。

执行。

1) 查找行

intRow = objWebTable.GetRowWithCellText(sKeyValueText, "Item") 您可以按名称或编号指定列

2) 检索子对象

Set objButton = objWebTable.ChildItem(intRow, intCol, "WebButton", 0) 您只能按数字指定列。如果您在同一个单元格中有多个按钮，则最后一个参数将生效。

查看我的博客 ( [http://automationbeyond.wordpress.com/](http://automationbeyond.wordpress.com/) ) 中的一些其他技术示例。

# .net - WinForm 用户控件 - 拖放

> ID：947544
> 
> 赞同：2
> 
> 时间：2009-06-03T22:10:53.433
> 
> 标签：.net, winforms, user-controls

只是我……但我认为您可以将用户控件拖放到 WinForms 上？也不能将它们拖到工具栏上。也许我有一个 VB6 闪回。它一定是遗漏了一些简单的东西，我做错了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T22:14:50.353

您不能从解决方案资源管理器中拖放，不。当您构建解决方案时，控件应自动添加到工具箱中（在顶部的单独组中），您可以从该工具箱中添加它们，就像使用其他控件一样。

更新：只是为了任何偶然发现这个答案的人的完整性；这就是你要找的：

![替代文字](https://i612.photobucket.com/albums/tt209/fredrikmork/usercontrol-in-toolbox.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-31T16:37:12.227

但不是真的......事实上......工具栏上的控件没有排序......所以这可能是一个问题......

# c# - 如何使 TextBox 的自动完成列表可编辑？

> ID：947546
> 
> 赞同：3
> 
> 时间：2009-06-03T22:11:05.837
> 
> 标签：c#, .net, textbox, autocomplete

我有一个包含许多`TextBox`使用自动完成的控件的应用程序。每个都用于`AutoCompleteMode.CustomSource`从关联的`AutoCompleteStringCollection`.

每当用户在 中输入新值时`TextBox`，它都会被添加到关联的 中`AutoCompleteStringCollection`，并且在会话结束时，所有这些集合都会持久保存到用户主目录中的文件中。

问题是无法纠正这些集合中的错误。在 IE 中，带有自动完成控件的输入控件可让您滚动到自动完成列表中的某个项目，然后按下`Del`以将其删除。这在 .NET 控件中不起作用。

我真的很想避免为此实现我自己的 UI。我卡住了吗？有没有办法启用我没有看到的这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T00:34:32.893

开箱即用，不幸的是，没有什么可以为您做这件事。我尝试 P/Invoking the basic FindWindowEx / EnumChildWindows 以查看是否可以获取实际下拉列表的句柄，但没有成功（如果有人确实成功了，请告诉我！）。好消息是（不太好，但也不可怕）自动完成实际上并不是您完全必须自己实现的东西，实际上有一个名为[SHAutoComplete](http://msdn.microsoft.com/en-us/library/bb759862(VS.85).aspx)的 Win32 函数可以被 P/Invoked 以帮助您自动完成。不要太兴奋，因为它并不像 P/Invoking 它那么简单并完成它。但是，有一篇很棒的[CodeProject 文章](http://www.codeproject.com/KB/shell/csdoesshell4.aspx)应该可以极大地帮助您。

# c# - 从代码发送电子邮件 - 框架

> ID：947549
> 
> 赞同：0
> 
> 时间：2009-06-03T22:12:11.653
> 
> 标签：c#, asp.net, email

我目前正在编写一个 Web 应用程序，该应用程序使用 SmtpClient 和 MailMessage .net API 类发送带有动态文本内容的各种电子邮件 - 我只是发现我淹没在字符串构建器的海洋中。

是否有任何电子邮件/模板框架可以帮助解决此类问题？这也适用于**中等信任**。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T23:10:24.017

在某些特殊情况下，当我不能使用工具并且必须编写我的工具并且正如您所说的想要通过模板进行循环时。

我在我的项目中创建了一个普通的 aspx 页面，并将我需要的所有控件“服务器控件，数据绑定控件”放在那里

然后使用静默呼叫调用此页面：

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("MyASPXPage.aspx");
request.Method = "GET";
response = request.GetResponse();
reader = new StreamReader(response.GetResponseStream(), Encoding.UTF8);
result = reader.ReadToEnd(); 
```

之后，结果字符串变量将包含您可以作为邮件发送的所有页面。

我用过一次，效果很好。

但是可以肯定的是，如果你找到了一个工具来帮助你，这会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T22:14:20.760

我会使用像[NVelocity这样的模板框架](http://nvelocity.sourceforge.net/)

编辑：SourceForge NVelocity 似乎已经死了，但[Castle Project](http://www.castleproject.org/others/nvelocity/index.html)的人已经分叉了它。因为我将 Velocity 用于 Java，而 NVelocity 是 .NET 的端口，所以我推荐它；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T22:16:13.687

你可以看看[stringtemplate](http://www.stringtemplate.org/)

[NVelocity](http://nvelocity.sourceforge.net/)是我们在上一个项目中使用的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T22:20:09.797

如果您不想在项目中引入其他依赖项，请尝试[T4 。](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T22:34:26.803

我不使用模板框架，但我使用 HTML 页面作为我的电子邮件模板。然后，我将诸如“<#UserName#>”之类的变量放入 HTML 中，这些变量会在代码中被替换。这使我可以轻松地编辑电子邮件正文，而无需触摸代码……除非我想添加更多新变量。使用标准 HTML 页面作为我的模板的另一个好处是非程序员能够设计/管理电子邮件正文布局......

# cocoa - CALayer坐标系

> ID：947566
> 
> 赞同：0
> 
> 时间：2009-06-03T22:17:28.257
> 
> 标签：cocoa, transform, calayer, coordinate-systems

我对 Cocoa 很陌生，但想知道如何更改 CALayer 的坐标系。我阅读了Core Animation Programming Guide 中的[Layer Geometry and Transforms](https://web.archive.org/web/20090119140724/http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CoreAnimation_guide/Articles/Layers.html#//apple_ref/doc/uid/TP40006082)文章，但仍然需要一些实用的建议。

默认坐标系在左下角有 (0,0)。我想将其更改为图层的中心。那可能吗？

我尝试了什么：使用 CATransform3DTranslate 作为 sublayerTransform 到图层框架的 MidX 和 MidY，子图层显示在正确的位置。在 setFrameSize 事件中，翻译应该被重新计算并再次应用。我宁愿自动刷新（没有“步骤”）。

或者我应该使用 kCAConstraintMidX 将子层 MidX 与层 MidX 相关联并使用偏移量？实际上，我使用 CATextLayers 作为子图层，并且希望将文本居中对齐，从而将文本的中心相对于超级图层的中心定位。我试过这个，但是当我调整超级层的大小时它似乎没有自动刷新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T19:17:14.997

查看名为 oalTouch 的 Apple 示例代码。

```
// Convert the view point to our layer / sound stage coordinate system, which is centered at (0,0)
CGPoint pointInLayer = CGPointMake(pointInView.x - [self frame].size.width / 2., pointInView.y - [self frame].size.height / 2.); 
```

# quantum-computing - What is a QBit and how soon can I get a quantum computer?

> ID：947577
> 
> 赞同：4
> 
> 时间：2009-06-03T22:22:30.587
> 
> 标签：quantum-computing

How soon can I get a quantum computer? Is there any way to build a simple one? How many years out are they for early early adopters?

I'd like to understand from a high level what a QBit is, how many states it can have, and what types of algorithms will work well in this arena.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T23:51:51.140

There's been a good deal of hype about quantum computers over the last decade or two, but there a number of problems that will need to be resolved before they'll become practical.

Some of these are "just" engineering problems, like shrinking the size down from room-sized 6-qbit systems to something more like the density of an integrated circuit. Or figuring out a way to prevent thermal noise from scrambling the system, without requiring the customer to keep large stocks of liquid Nitrogen (or Helium!) on hand.

On the other hand, there appear to be some more fundamental problems with constructing quantum computers with large numbers of qbits.

Primary among these is error-correction. Part of the inherent nature of the entangled systems used for quantum computing is that they can lose "coherence" spontaneously. Great strides have been made in increasing the entangled lifetime, but you're still very limited in the number of operations that you can perform reliably.

Some techniques for error correction in quantum computations have been developed, but the last article I read on quantum EC indicated that the number of error-correcting qbits required goes up more-or-less logarithmically with the number of active qbits. Note that the initial constant factor may be quite large - it can take 5 physical qbits to represent 1 logical qbit.

To some extent (it remains to be seen how much), this growth in size is going to mitigate against the exponential advantage in speed that quantum computation is supposed to have over conventional computation.

Okay, so you can get a 6 qbit system today, which is way too small to tackle "interesting" problems with. Something like factoring a 2048-digit number is going to require systems with millions or billions of qbits. Sure, you'll get the answer "instantly", but there's no clear path to get anywhere near that level of performance using current techniques. Just loading the problem into the system would probably exceed the coherence lifetime.

Oh, to answer your other questions: I think that most folks are working with quantum storage systems with a single pair of states. In principle, most of these systems could store multiple non-overlapping states per storage unit, but I think a lot more effort is going into making the equipment work reliably at all, rather than maximizing efficiency.

Quantum algorithms are weird in the same way that quantum physics is. Rather than trying to explain how they work, here's an article on Shor's algorithm for factoring integers. [http://en.wikipedia.org/wiki/Shor's_algorithm](http://en.wikipedia.org/wiki/Shor's_algorithm)

And here's a reference on the error-correction issue: [http://en.wikipedia.org/wiki/Quantum_error_correction](http://en.wikipedia.org/wiki/Quantum_error_correction)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:25:01.877

[Quantum computers](http://en.wikipedia.org/wiki/Quantum_computer) will not be coming out for quite a long time. There is no easy way to build one.

[Qubit](http://en.wikipedia.org/wiki/Qubit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-01T23:22:55.693

I'd say they're already here. :)

The first "working" 3-qubit NMR quantum computer was built in 1998\. The field is still in infancy, and almost all progress is still theoretical and confined to academia, but in 2007 a company called D-Wave Systems presented a prototype of a working 16-qubit, and later during the year 28-qubit adiabatic quantum computer. Their effort is notable since they claim that their technology is commercially viable and scalable. As of 2010, they have 7 rigs, current generation of their chips has 128 qubits. They seem to have partnered with Google to find interesting problems to test their hardware on.

I recommend [this short 24-minute video](http://www.youtube.com/watch?v=56qR0iX5A4o) and [Wikipedia article](http://en.wikipedia.org/wiki/D-Wave_Systems) on D-Wave for a quick overview, and there a lot more resources on [this blog](http://dwave.wordpress.com/) written by D-Wave founder and CFO.

# .net - 如何在发布模式下记录异常

> ID：947580
> 
> 赞同：3
> 
> 时间：2009-06-03T22:24:41.080
> 
> 标签：.net, logging, exception-handling

在发布模式下部署 .net 程序集时，不会启用堆栈跟踪。所以我们无法从异常中获取堆栈跟踪并将其记录在生产环境中。

为了了解生产代码中发生异常的位置并记录它，我们使用了一种我不习惯的[奇怪方法](https://stackoverflow.com/questions/389575/how-to-deal-with-exceptions)，但我无法想出更好的解决方案来记录异常发生的确切方法。

请注意，日志记录机制也用于确定错误。因此，当引发 NullReferenceException 或 IndexOutOfBoundsException 时，仅获取异常类型和消息是没有帮助的，我们通常需要知道异常发生的确切位置。

你如何处理这个问题？发生异常时，您会在生产代码中记录哪些信息，以及如何通过该信息确定问题所在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T22:37:59.057

看看 ELMAH，我自己还没有实现它，但它似乎得到了一些关注。

[http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx](http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx)

将 ELMAH 放入正在运行的 Web 应用程序并进行适当配置后，您无需更改任何一行代码即可获得以下便利：

*   记录几乎所有未处理的异常。
*   用于远程查看重新编码异常的整个日志的网页。
*   用于远程查看任何记录的异常的完整详细信息的网页。
*   在许多情况下，即使关闭了 customErrors 模式，您也可以查看 ASP.NET 为给定异常生成的原始黄屏死机。
*   每个错误发生时的电子邮件通知。
*   来自日志的最后 15 个错误的 RSS 提要。
*   日志的许多后备存储实现，包括内存中、Microsoft SQL Server 和社区贡献的几个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:45:18.903

我们为发布代码记录堆栈跟踪没有问题，但是我们总是在发布时附带 .pdb 文件。如果没有 pdb，您将始终受限于程序集本身包含的符号信息，对于处于发布模式的程序集而言，这些信息不会太多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T22:47:48.930

我们所有的发布代码都有堆栈跟踪。我们唯一缺少的是行号，因为它们来自 .pdb。你在运行混淆器吗？

# .htaccess - 使服务器自动将@domain.com 附加到 ftp 帐户

> ID：947584
> 
> 赞同：0
> 
> 时间：2009-06-03T22:25:05.637
> 
> 标签：.htaccess, mod-rewrite, ftp, mediatemple

我有一个客户，她打印了 10,000 个广告，上面写着一个 FTP 帐户的特定密码，可以说： horses1，由于许多原因，我不得不将她迁移到新主机，她选择了 mediaTemple，并购买了一个帐户。

登录现在是 horses1@HER-DOMAIN.com，这是一个问题，因为她的所有平面广告。

我认为这可以用 mod_rewrite 和 htaccess 修复，但我很确定 apache2 和 ftp 是不同的程序......如果我不能解决这个问题，我真的搞砸了......

编辑：有没有办法创建一个 FTP 用户别名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T15:19:16.310

Apache 只是一个 HTTP 服务器。但也许[mod_ftp](http://httpd.apache.org/mod_ftp/mod/mod_ftp.html)及其[`StripHostname`选项](http://httpd.apache.org/mod_ftp/mod/mod_ftp.html#ftpoptions)可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T15:22:38.707

Apache 是一个 HTTP 服务器（由于它的魔力，它可以像你喜欢的任何类型的 TCP/IP 服务器一样工作，但几乎从来不是）所以不会负责 FTP。

几乎可以肯定 FTP 将由不同的服务器提供，您需要了解它是什么以及您对其拥有的配置控制级别，然后才能继续进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T15:31:30.937

需要@domain 的 FTP 站点几乎总是共享主机。

如果没有，您将无法进行配置更改以使其正常工作。

# java - 需要 Spring 版本# - 只有 spring.jar 文件

> ID：947586
> 
> 赞同：34
> 
> 时间：2009-06-03T22:25:38.537
> 
> 标签：java, spring

我继承了一个使用 Spring 的应用程序。原始开发人员不可用。Spring jar 文件只是“spring.jar”，所以文件名中没有版本号来帮助我。我想下载jar文件对应的Spring源码。MANIFEST.MF 文件具有“Spring-Version: 1.2”，但这还不够精确。我查看了 1.2.1 和 1.2.9 版本，但它并不完全匹配。关键是它`org.springframework.web.servlet.view.AbstractCachingViewResolver`有一个`prepareView`被调用的方法，`resolveViewName`它似乎不在 1.2.1 或 1.2.9 中。

有什么简单的方法可以找到正确的版本吗？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-06-03T22:46:29.697

这将做到：

```
import org.springframework.core.SpringVersion;

public class VersionChecker
{
    public static void main(String [] args)
    {
        System.out.println("version: " + SpringVersion.getVersion());
    }
} 
```

使用 CLASSPATH 中的 spring.jar 编译并运行它，它会为你显示版本。另请参阅[javadocs](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/core/SpringVersion.html)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-06-17T12:48:50.630

`<org.springframework-version>`您不能在标记中的 pom.xml 文件中检查它。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-08-11T14:19:20.797

真正简单的方法是获取存档的 MD5 总和并在 Google 上搜索。许多存储 .jar 档案的网站也会索引 MD5 和，然后 Google 很容易找到。这对于几乎所有 Java 组件都非常有效。

```
$ md5sum spring-2.5.5.jar
82a2134b227f717066da4f4b059925d3 
```

[http://www.google.com/search?q=82a2134b227f717066da4f4b059925d3](http://www.google.com/search?q=82a2134b227f717066da4f4b059925d3)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-08-11T15:13:32.930

如果您的项目使用 Maven，您可以在命令行运行以下命令来查看它：

```
$ mvn dependency:tree | grep org.springframework | grep 'spring-core:jar' 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T22:28:28.470

如何校验 JAR 文件并将其与 SpringSource 发行版中的 spring.jar 文件进行比较？下载可能需要一个小时左右，但应该是确定的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T22:59:54.490

根据[mvnrepository.com](http://www.mvnrepository.com/artifact/org.springframework/spring) 1.2.9 的重量为 2.2MB 和 1.2.1 的重量为 2.0MB，该页面也有一个下载链接。我认为重量差异足以比较文件。如果您看不到差异，只需校验和。如果您看不到与 1.2.1 和 1.2.9 的关系，您可以使用该页面快速下载任何其他版本（我经常使用它）

注意：如果你的 JAR 低于 2.0MB，那么恐怕 duffymo 有理由，你的 JAR 是 1.2

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-05T08:17:57.310

您可以尝试在 META-INF 目录中查看 jar 的 MANIFEST.MF - 它应该指示您正在使用的版本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-15T13:51:30.013

打开罐子并检查 spring.jar > META-INF > MANIFEST.MF

[![在此处输入图像描述](https://i.stack.imgur.com/wtiMd.png)](https://i.stack.imgur.com/wtiMd.png)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-07-24T17:33:39.230

转到 MATA-INF 目录并打开清单文件。它将在那里您使用的版本。

# iphone - 我的 iPhone 游戏是否需要 OpenGL？

> ID：947589
> 
> 赞同：10
> 
> 时间：2009-06-03T22:26:54.447
> 
> 标签：iphone, opengl-es

在 iPhone 上：

如果我正在编写一个具有多个级别的游戏，具有多个动画（图像序列）、jpg 和 png（透明），有些是全屏的，有些不是，有些是循环的，有些只玩一次。最好的方法是什么？每个级别可能有多达 10MB 的图像。添加到此音乐和视频（过场动画）。所有 2D 图形，没有 3D 模型。

需要OpenGL吗？或者这可以通过 Quartz 或 Core Animation 来实现吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T23:02:09.337

我使用 UIViews 和一些核心图形（Quartz 2D）做类似的事情，它工作正常。我发现 Core Graphics 中的自定义绘图将其推得更远，尽管 UIView 在给定图像时效果最好，而不是必须自己绘制。还要注意大量的透明胶片。不过，您可能会发现大型或长（多帧）动画将成为杀手。有一些技术可以最大限度地减少动画的影响，包括允许它在没有立即显示的情况下从内存中清除图像（我忘记了设置）。这可能会导致您的动画不像其他情况那样流畅（但不确定 Open GL ES 是否会有所帮助）。

您可能应该使用 UIViews 进行原型设计，然后决定是否值得为 OpenGL ES 做额外的工作。此外，如果您还不熟悉 OpenGL/Open GL ES，那么这将是一个陡峭的学习曲线。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-04T00:11:50.583

我在 iPhone 上使用 Quartz 和 OpenGL 来做图形，虽然 OpenGL 的学习曲线要​​高得多，但它提供的性能比 Quartz 好得多。假设您有一个场景，其中涉及在彼此之上绘制 6 个大的、半透明的图像。Quartz 会做到这一点，但你最多可能会得到 15fps。OpenGL 利用了 iPhone 的 PowerVR 芯片，并且绘图是硬件加速的——因此您可以将这些图像加载到 OpenGL 纹理中并以 25-30fps 的速度进行渲染。

不过，我会同意 Phil 的观点 - 尝试使用 Quartz 来做，看看它是否满足您的需求。OpenGL 非常强大，但它的 API 缺少 Quartz 的一些便利功能（例如保存/恢复图形状态）。

另请注意，您可能想看看 Unity 的 iPhone 开发工具 ( [http://unity3d.com/#iphone](http://unity3d.com/#iphone) )。他们利用 OpenGL，但为您提供了一个 IDE 来创建您的游戏。它抽象出所有图形级代码，因此您可以专注于高级游戏玩法。我的兄弟用它来写iPhone游戏，非常酷。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-04T00:17:05.830

我推荐看看[Cocos2D iPhone](http://code.google.com/p/cocos2d-iphone/)。

> cocos2d for iPhone 是一个用于构建 2D 游戏、演示和其他图形/交互应用程序的框架。它基于 cocos2d 设计：它使用相同的 API，但不是使用 python，而是使用 Objective-c。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-03T22:35:08.143

最有可能是OpenGL。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-05T11:01:13.627

使用 OpenGL ES 的一个优势是学习该技术的时间投资可以应用于其他平台/上下文，并且您的游戏可能更适合移植。这些对你来说可能并不重要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T22:40:28.537

我建议使用石英。OpenGL ES 真的是最适合 3d 的东西。但是两者都工作得很好，所以如果你已经知道 OpenGL ES，那么使用它就可以了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-21T18:05:23.307

你应该考虑在你的游戏中使用更少的资源，Apple 建议不要为 openGL 应用程序使用超过 10 mb 的纹理。

尝试纹理图集、重用图形、基于平铺的图形……但避免使用过多的图形资源。

# .net - 一起运行 asp.net 1.1 和 2.0 时出错

> ID：947594
> 
> 赞同：1
> 
> 时间：2009-06-03T22:28:26.860
> 
> 标签：.net, asp.net, iis, windows-server-2003

所以这是我试图帮助朋友解决的错误（我认为我不会尝试这个）。他有一个旧的 Asp.net 1.1 应用程序。他已经在他的应用程序中添加了一些 ASP.NET 2.0 功能。他的应用程序在 Windows 2003 服务器上运行。他的主应用程序在 1.1 应用程序池中运行。在其中一个子文件夹中是所有 .Net 2.0 功能所在的位置，因此他向 IIS 添加了第二个 Web 应用程序，该应用程序指向子文件夹并将此应用程序放入 2.0 应用程序池中。他的应用程序大部分时间运行良好，但用户间歇性地出现“白屏”并且整个应用程序正在关闭（他 95% 确定是 1.1 应用程序池正在关闭）。他怎么能解决他的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T23:20:12.060

查看服务器上的应用程序和系统事件日志。您应该 W3SVC 崩溃并说明原因。双重和三重检查没有应用程序池包含运行两个运行时的应用程序。此外，如果 IIS 以 32 位模式运行，则只能在 IIS 上并行运行 ASP.NET 1.1 和 2.0，因为 .NET 1.1 仅为 32 位。

# sql - 列表和 MySQL 查询

> ID：947599
> 
> 赞同：0
> 
> 时间：2009-06-03T22:30:28.387
> 
> 标签：sql, mysql, list

是否可以运行 MySQL 查询，从表中提取位置名称，将它们插入下拉菜单，然后自动为每个位置生成一个 URL，例如 `blablabla.bla/index.php?location=blablabla`每次加载页面时？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T22:34:36.413

当然，您只需运行查询，通过循环解析结果，在该循环中，您将从返回的值构建链接——将结果文本连接到链接的其他部分。

```
<select name='locations'>
<?php
while ($row = mysql_fetch_assoc($result))
{
    echo "<option value='".$row['location']."'>".$row['location']."</option>";
}
?>
</select> 
```

# javascript - 在 Sitefinity 的单个页面上包含一些 Javascript 的最佳方法

> ID：947611
> 
> 赞同：0
> 
> 时间：2009-06-03T22:32:20.083
> 
> 标签：javascript, sitefinity

通常，我只想在单个页面上放置一些 jQuery。鉴于我对 Sitefinity 的早期了解，我认为...

1.  我不能轻易将 JS 放在 <head> 中。

2.  我可以将 JS 放在通用内容控件中，但是我的 JS 位于 <body> 中。也许我需要放松一下，但我通常不喜欢在 <body> 中放太多 JS。

感觉这种场景是事后才想到的。JS 是 Sitefinity 的二等公民吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T00:30:57.177

JavaScript 并不存在于头脑中。雅虎甚至[表示](http://developer.yahoo.net/blog/archives/2007/07/high_performanc_5.html)性能更好

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-04T01:14:18.057

我同意 epascarello 的观点，你真的不应该把你的 javascript 放在头上。

以防万一您不知道这一点，[jQuery 框架是 Sitefinity 的一部分](http://blogs.sitefinity.com/GeorgiChokov/Posts/09-03-25/How_to_use_jQuery_and_other_JavaScript_Libraries_in_Sitefinity.aspx)。本文还向您展示了如何从项目的任何位置将外部库包含在 sitefinity 中，无论是母版页还是用户控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-12T23:51:00.137

为什么不将 jQuery 代码放在单独的 .js 文件中并使用不显眼的 JavaScript？使用 jQuery，您可以很好地分离行为和标记，以至于您不必再将 JavaScript 包含在您的头部或身体中。

只需使用 jQuery 中的标准 onLoad 函数并将所有初始化代码放在那里。

试试吧，我想你会喜欢的！如果你喜欢使用 CSS 来分离表示和标记，那么 jQuery 可以对行为和标记做同样的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-17T19:26:38.370

这是一个老问题，但你现在可以做到的一种方法是：

添加一个 Javascript 块（在 Scripts & Styles 下），然后将 URL 粘贴到 jquery 代码中：

```
http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js 
```

然后使用您的 jquery 添加另一个 Javascript 块，例如：

```
$(document).ready(function() {
alert("hello");
}); 
```

或者您也可以将 URL 粘贴到您的 js 文件中。

# search - 如何在 Google 中搜索代码和其他与编程相关的关键字？似乎去掉了特殊字符

> ID：947612
> 
> 赞同：4
> 
> 时间：2009-06-03T22:32:52.500
> 
> 标签：search, character

我在使用 Google 时遇到的一个问题是，它似乎去除了点、逗号和其他一些特殊字符等特殊字符，而这通常是我在尝试查找任何与编程相关的内容时所寻找的

例如：**`django @ sign`**返回不相关的数据。也许您知道使这成为可能的方法（或替代方法/技术）？

> ### 相关问题
> 
> *   [有效的谷歌搜索短名称](https://stackoverflow.com/questions/930488/effective-googling-for-short-names)
> *   [为什么 M# 比 C# 更难谷歌？](https://stackoverflow.com/questions/932915/why-would-m-be-harder-to-google-than-c/932948#932948)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T22:38:30.430

如果您正在寻找实际的代码示例，可以尝试 code.google.com。否则，最安全的选择是找到您有疑问的任何语言的主网站并在那里四处寻找，尽管稍微挖掘一下可能会在谷歌上打开它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-13T17:08:34.637

您是否尝试过[http://www.google.com/codesearch](http://www.google.com/codesearch)？

# wpf - 以编程方式更改标签属性

> ID：947614
> 
> 赞同：8
> 
> 时间：2009-06-03T22:33:06.773
> 
> 标签：wpf, wpf-controls, label

问题是我需要以编程方式更改 Label FontWeight 和 FontStyle 但似乎没有任何效果......这是我迄今为止尝试过的：

```
label.FontWeight = FontWeight.FromOpenTypeWeight(99); 
```

对于 label.FontStyle 我不知道，我被困在这里：

```
label.FontStyle = new FontStyle(); 
```

我不知道从那里开始做什么。我疯狂地用谷歌搜索，但一无所获。

提前感谢您的任何建议！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-03T22:48:56.633

对于 FontStyle，您可以在代码隐藏中使用 FontStyles 类，对于 FontWeight 使用 FontWeights。

```
 private void Button_Click(object sender, RoutedEventArgs e)
    {
        uiLabel.FontWeight = FontWeights.Bold;
        uiLabel.FontStyle = FontStyles.Italic;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:44:17.563

看看[这个 SO question](https://stackoverflow.com/questions/637636/using-a-system-drawing-font-with-a-wpf-label)。它本身对标签没有帮助，但它确实允许您使用 TextBlock 控件更改文本的属性。

# asp.net - 在 HTML 中呈现的 asp .net 验证器是什么？

> ID：947615
> 
> 赞同：1
> 
> 时间：2009-06-03T22:33:15.293
> 
> 标签：asp.net, tags, validation, html

是否所有 asp net 验证器都呈现为 <span> 标签？

这一点很重要，因为在样式中使用了跨度，并且有一个严格的 css heiracrchy，我不想在运行时渲染的内容周围添加多余的 <span> 标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T08:43:16.533

当您使用 ASP.NET 时，不仅仅是验证器用 span 包装。RadioButtonList 也有一个环绕项目的跨度。有时很烦人。

# php - 如何最好地存储用户信息和用户登录名和密码

> ID：947618
> 
> 赞同：34
> 
> 时间：2009-06-03T22:34:20.780
> 
> 标签：php, mysql, security, passwords

我正在使用 Mysql，我假设最好将用户个人信息及其登录名和密码分开到两个不同的表中，然后在两者之间引用它们。

**注意**：为了澄清我的帖子，我了解保护密码的技术（哈希、盐等）。我只知道，如果我遵循我生活中其他部分（投资、数据备份，甚至个人存储）的做法，那么在最坏的情况下（包括表格或火灾），在表格之间拆分信息可以保护您的附加数据。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-06-03T22:37:48.387

不要存储密码。如果它曾经放在磁盘上，它可能会被盗。相反，存储密码哈希。 [使用正确的散列算法](https://security.stackexchange.com/questions/211/how-to-securely-hash-passwords)，例如 bcrypt（包括盐）。

**编辑**： OP 回应说他理解上述问题。

无需将密码存储在与登录名不同的物理表中。如果一个数据库表被破坏，访问同一个数据库中的另一个表并不是一个很大的飞跃。

如果您足够关注安全性和深度安全性，您可能会考虑将用户凭据存储在与您的域数据完全分开的数据存储中。一种常用的方法是将凭据存储在 LDAP 目录服务器中。这也可能有助于您以后进行的任何单点登录工作。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-06-03T23:04:44.807

密码应存储为加密哈希，这是一种不可逆的操作，可防止读取纯文本。在对用户进行身份验证时，对输入的密码进行相同的哈希处理，并比较哈希值。

避免使用 MD5 或 SHA1 等快速廉价的散列；目标是让攻击者计算彩虹表（基于哈希冲突）变得昂贵；快速哈希抵消了这一点。对于身份验证场景，使用昂贵的散列不是问题，因为它不会影响散列的单次运行。

除了散列，用随机生成的值对散列进行加盐；一个随机数，然后将其存储在数据库中并在散列之前与数据连接。这增加了计算碰撞时必须生成的可能组合的数量，从而增加了生成彩虹表的整体时间复杂度。

您的密码哈希列可以是固定长度；您的加密散列应该输出可以编码为固定长度的值，这对于所有散列都是相同的。

尽可能避免滚动您自己的密码验证机制；使用现有的解决方案，例如`bcrypt`.

[可以在http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-](http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/)找到有关如何处理密码以及您需要关注的内容的精彩说明[需要知道安全密码方案](http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/)。

最后一点，请记住，如果攻击者获得了对您数据库的访问权限，那么您最关心的应该是他们可能访问的任何敏感或个人身份信息，以及他们可能造成的任何损害。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-06-03T22:36:16.300

将它们放在同一张桌子上并没有错。事实上，它会更快，所以我强烈推荐它。我不知道你为什么要把它分开。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-03T22:44:19.590

我会尝试回答你原来的问题。除非您只需要收集大量个人信息，否则将所有内容放在一张桌子上就可以了。在这种情况下，拆分它可能是有意义的。该决定应根据您正在处理的个人信息量以及需要访问的频率来做出。

我会说大多数时候我会在一张桌子上做这样的事情：

```
UserID, FirstName, LastName, Email, Password, TempPassword 
```

但是……如果你收集的远不止这些。假设您正在收集电话、传真、出生日期、传记等。如果大多数信息很少被访问，那么我可能会将其放在自己的表格中，并通过一对一的关系将其连接起来。毕竟，表上的列越少，对该表的查询就越快。有时简化最常访问的表是有意义的。尽管每当您确实需要访问该个人信息时，JOIN 都会对性能造成影响，因此您必须考虑这一点。

编辑——你知道吗，我只是想到了一些事情。如果您在用户名或电子邮件字段（无论您喜欢哪个）上创建索引，它几乎可以完全消除在用户表中创建如此多列的性能缺陷。我这么说是因为每当您登录时，如果用户名有索引，WHERE 子句实际上会非常快速地找到用户名，并且该表中是否有 100 列也没关系。 **所以我改变了看法。我会把它们都放在一张桌子上。;)**

无论哪种情况，由于安全似乎是一个热门话题，因此密码应该是一个哈希值。我建议使用 SHA1（如果您真的很担心，建议使用 SHA256）。TempPassword 也应该使用散列，它只用于忘记密码功能。显然，使用哈希您无法解密并向用户发送其原始密码。因此，您可以生成一个他们可以登录的临时密码，然后强制他们在登录后再次更改密码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-04T01:24:32.420

所有这些数据都会与用户保持 1:1 的关系吗？如果您可以预见允许用户拥有多个地址、电话号码等，那么您可能希望将个人信息拆分到单独的表格中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-03T23:02:38.243

首先，要说明（希望）显而易见，如果您可以以任何方式避免存储用户名和密码，请这样做；这是一项重大责任，如果您的凭据存储遭到破坏，它可能会为同一用户提供对许多其他地方的访问权限（由于密码共享）。

如果您必须存储凭据：

*   不要存储可逆形式；使用公认的算法（如 SHA-256）存储哈希。使用来自信誉良好的可信赖来源的加密软件 - 不要试图自己动手，你可能会弄错。
*   对于每个凭证集，将盐与散列数据一起存储；这用于“初始化”哈希，以便两个相同的密码不会产生相同的哈希 - 因为这会泄露密码是相同的。
*   使用安全的随机生成器。弱随机性是与加密相关的安全失败的第一大原因，而不是密码算法。

如果您必须存储*可逆*凭证：

*   选择一个好的加密算法 - AES-256、3DES（过时）或公钥密码。使用来自信誉良好的可信赖来源的加密软件 - 不要试图自己动手，你可能会弄错。
*   对于每个凭证集，将盐（未加密）与加密数据一起存储；这用于“启动”加密密码，以使两个相同的密码不会产生相同的密文——因为这表明密码是相同的。
*   使用安全的随机生成器。弱随机性是与加密相关的安全失败的第一大原因，而不是密码算法。
*   将加密/解密密钥与您的数据库分开存储在一个操作系统安全文件中，该文件只能由您的应用程序运行时配置文件访问。这样，如果您的数据库被破坏（例如通过 SQL 注入），您的密钥不会自动受到攻击，因为这通常需要访问 HDD。如果您的操作系统支持与配置文件绑定的文件加密，请使用它——它只会提供帮助，而且通常是透明的（例如 NTFS 加密）。
*   如果可行，请存储使用主密码加密的密钥本身。这通常意味着您的应用程序。将需要在启动时键入该密码 - 在脚本的参数中提供它没有好处，因为如果您的硬盘被破坏，您必须假设可以查看密钥文件和脚本。
*   如果用户名不是查找帐户记录所必需的，则对用户名和密码进行加密。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-04T01:07:47.163

以我个人的经验，在这种情况下，将个人信息和登录信息存储在单个数据库中是最佳做法。原因是如果发生 SQL 注入，它仅限于（除非渗透者知道数据库的内部布局）数据所属的表，而不是提供对整个数据集团的访问。

但是，请注意，这可能是以需要执行更多查询为代价的，因此会影响性能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T22:38:39.820

您应该将它们存储在同一张表中，并使用单向加密。MD5 可以工作，但很弱，所以您可以考虑使用 SHA1 或其他方法。将 2 个项目存储在单独的表中没有任何好处。

# c++ - 如何在 C++ 中将 long 转换为字符串？

> ID：947621
> 
> 赞同：69
> 
> 时间：2009-06-03T22:34:36.350
> 
> 标签：c++

如何在 C++ 中将a 转换`long`为 a ？`string`

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2015-03-07T03:56:33.617

在 C++11 中，<string> 中实际上有[std::to_string](https://en.cppreference.com/w/cpp/string/basic_string/to_string)和[std::to_wstring](https://en.cppreference.com/w/cpp/string/basic_string/to_wstring)函数。

```
string to_string(int val);
string to_string(long val);
string to_string(long long val);
string to_string(unsigned val);
string to_string(unsigned long val);
string to_string(unsigned long long val);
string to_string(float val);
string to_string(double val);
string to_string (long double val); 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-06-03T22:37:09.170

您可以使用字符串流。

```
#include <sstream>

// ...
std::string number;
std::stringstream strstream;
strstream << 1L;
strstream >> number; 
```

标准库中通常有一些专有的 C 函数供您的编译器执行。不过，我更喜欢更“便携”的变体。

C 方法是使用 sprintf，但这不是很安全。在某些库中，有新版本，例如 sprintf_s，可以防止缓冲区溢出。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-06-03T22:43:01.183

好吧，如果你是复制粘贴的粉丝，这里是：

```
#include <sstream>

template <class T>
inline std::string to_string (const T& t)
{
    std::stringstream ss;
    ss << t;
    return ss.str();
} 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-06-03T22:50:43.463

`boost::lexical_cast<std::string>(my_long)` 更多在这里[http://www.boost.org/doc/libs/1_39_0/libs/conversion/lexical_cast.htm](http://www.boost.org/doc/libs/1_39_0/libs/conversion/lexical_cast.htm)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2017-03-27T12:40:38.547

您可以在 C++11中使用[**std::to_string**](http://en.cppreference.com/w/cpp/string/basic_string/to_string)

```
long val = 12345;
std::string my_val = std::to_string(val); 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-06-03T22:41:46.523

```
int main()
{
    long mylong = 123456789;
    string mystring;
    stringstream mystream;
    mystream << mylong;
    mystring = mystream.str();
    cout << mystring << "\n";
    return 0;
} 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-06-03T22:45:35.347

我不知道这是什么样的作业，但很可能老师不想要一个你只调用“神奇”现有函数的答案（即使这是推荐的方法），但他想看看如果您可以自己实现。

以前，我的老师常说“我想看看你能不能自己编程，而不是你能不能在系统里找到它”。好吧，他错了；）..

无论如何，如果你的老师是一样的，这是*很难*做到的。

```
std::string LongToString(long value)
{
  std::string output;
  std::string sign;

  if(value < 0)
  {
    sign + "-";
    value = -value;
  }

  while(output.empty() || (value > 0))
  {
    output.push_front(value % 10 + '0')
    value /= 10;
  }

  return sign + output;
} 
```

您可能会争辩说 using`std::string`不是“困难的方式”，但我猜在实际算法中什么才是最重要的。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-06-03T22:42:56.303

有几种方法。阅读[Manor Farm 的字符串格式化](http://www.gotw.ca/publications/mill19.htm)程序进行深入比较。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-03T22:37:48.480

```
 #include <sstream>

   ....

    std::stringstream ss;
    ss << a_long_int;  // or any other type
    std::string result=ss.str();   // use .str() to get a string back 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-03T22:36:35.393

退房`std::stringstream`。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-03T23:41:31.770

到目前为止，任何人都没有涉及到的一件事，以帮助您进一步思考这个问题，即当它被转换为字符串时应该长时间采用什么格式。

只需看一下电子表格程序（如 Calc/Excel）。您是否希望它四舍五入到最接近的百万，如果它是负数，则使用括号，始终显示符号......这个数字是否真的代表其他东西，您应该用 Oractal 还是 Hex 显示它？

到目前为止的答案为您提供了一些默认输出，但可能不是正确的。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-06-03T22:41:20.127

我通常这样做的方式是使用 sprintf。因此，假设您在 32 位架构上，您可以长时间执行以下操作：

```
char buf[5] = {0}; // one extra byte for null    
sprintf(buf, "%l", var_for_long); 
```

# asp.net - ASP.NET 在中等信任中使用 Twitterizer

> ID：947633
> 
> 赞同：1
> 
> 时间：2009-06-03T22:36:35.893
> 
> 标签：asp.net, medium-trust, twitterizer

使用[Twitterizer](http://code.google.com/p/twitterizer/)框架的人是否有在中等信任环境中运行它的经验？我不断收到安全异常...

> 安全异常
> 描述：应用程序试图执行安全策略不允许的操作。要授予此应用程序所需的权限，请联系您的系统管理员或在配置文件中更改应用程序的信任级别。
> 
> 异常详细信息：System.Security.SecurityException：该程序集不允许部分受信任的调用者。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T22:38:24.937

我在 GoDaddy 上使用它，不得不找到一家替代托管公司，折扣 asp.net ......

我很确定 Twitterizer 的问题是您需要能够进行反射工作，以便程序集确定哪些操作是可能的。中等信任不允许反射起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:46:45.920

Godaddy 没办法，请查看他们在其网站上所说的内容：

[什么是中等信任级别以及它如何影响我的托管帐户？](http://help.godaddy.com/article/1039)

所以你只有两种方法：

*   更改 Twitterizer 信任模式。

或者

*   检查另一家托管公司。

[有关 ASP.NET 信任级别的更多信息](http://msdn.microsoft.com/en-us/library/wyts434y.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-17T15:20:45.223

我正在修改和测试 Twitterizer 以在中等信任下工作，并将在我的 GoDaddy 主机上进行测试。

如果您遇到特定问题，请不要犹豫，创建问题单或给我们的 Google 小组发送电子邮件。

-Ricky（Twitterizer 库的所有者）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-02T04:18:44.443

它适用于 godaddy.com 标准 Windows 帐户。一个更易读的来源是[here](http://www.thesupermedia.com/blog/content/binary/twitterizer.txt)。

`Default.aspx`：

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="Default.aspx.vb"
         Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:TextBox ID="txtSendTweet" runat="server"
                     style="margin-bottom: 0px" Width="396px"></asp:TextBox>
        <br />
        <asp:Button ID="cmdSendTweet" runat="server" Text="Send Tweet" />

    </div>
    </form>
</body>
</html> 
```

后面的代码：

```
Imports Twitterizer.Framework
Imports System.Configuration
Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim TwitterUserName As String = ConfigurationManager.AppSettings.Get("TwitterUserName")
        Dim TwitterPassWord As String = ConfigurationManager.AppSettings.Get("TwitterPassWord")

        Dim twit As Twitter = Nothing
        twit = New Twitter(TwitterUserName, TwitterPassWord, "Web")
        Dim followers As TwitterUserCollection = twit.User.Followers()

        For Each follower As TwitterUser In followers
            Response.Write(follower.ScreenName.ToString())
            Response.Write(follower.Status.Text.ToString())
            Response.Write(follower.NumberOfFollowers.ToString())
        Next
        Dim paras As New TwitterParameters()
        paras.Add(TwitterParameterNames.ScreenName, "Twit_er_izer")
        paras.Add(TwitterParameterNames.Since, Convert.ToDateTime("1/1/2009"))
        paras.Add(TwitterParameterNames.Page, 1)
        paras.Add(TwitterParameterNames.Count, 5)
        paras.Add(TwitterParameterNames.SinceID, 1)

        Dim usersStatus As TwitterStatusCollection = twit.Status.UserTimeline(paras)

        Response.Write("Other User")
        For Each status As TwitterStatus In usersStatus
            Response.Write(String.Format("User {0}: {1}", status.TwitterUser.ScreenName, status.Text))
            Response.Write("<br><p>")
        Next

    End Sub
    Protected Sub cmdSendTweet_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmdSendTweet.Click
        Dim TwitterUserName As String = ConfigurationManager.AppSettings.Get("TwitterUserName")
        Dim TwitterPassWord As String = ConfigurationManager.AppSettings.Get("TwitterPassWord")
        Dim TwitterMessage As String = txtSendTweet.Text
        Dim t As New Twitterizer.Framework.Twitter(TwitterUserName, TwitterPassWord)
        t.Status.Update(txtSendTweet.Text)
        Dispose()
    End Sub
End Class 
```

`Web.config`：

```
<?xml version="1.0"?>
<!-- 
    Note: As an alternative to hand editing this file you can use the 
    web admin tool to configure settings for your application. Use
    the Website->Asp.Net Configuration option in Visual Studio.
    A full list of settings and comments can be found in 
    machine.config.comments usually located in 
    \Windows\Microsoft.Net\Framework\v2.x\Config 
-->
<configuration>
 <configSections>
  <sectionGroup name="system.web.extensions" type="System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
   <sectionGroup name="scripting" type="System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
    <section name="scriptResourceHandler" type="System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
    <sectionGroup name="webServices" type="System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
     <section name="jsonSerialization" type="System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="Everywhere"/>
     <section name="profileService" type="System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
     <section name="authenticationService" type="System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
     <section name="roleService" type="System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" allowDefinition="MachineToApplication"/>
    </sectionGroup>
   </sectionGroup>
  </sectionGroup>
 </configSections>
 <appSettings>
  <add key="TwitterUserName" value="thesupermedia" />
  <add key="TwitterPassWord" value="yourpassword" />
 </appSettings>
 <connectionStrings/>
 <system.web>
  <!-- 
            Set compilation debug="true" to insert debugging 
            symbols into the compiled page. Because this 
            affects performance, set this value to true only 
            during development.

            Visual Basic options:
            Set strict="true" to disallow all data type conversions 
            where data loss can occur. 
            Set explicit="true" to force declaration of all variables.
        -->
  <authentication mode="Forms" />
  <customErrors defaultRedirect="" />
  <compilation debug="false" strict="false" explicit="true">
   <assemblies>
    <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
    <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
   </assemblies>
  </compilation>
  <pages>
   <namespaces>
    <clear/>
    <add namespace="System"/>
    <add namespace="System.Collections"/>
    <add namespace="System.Collections.Generic"/>
    <add namespace="System.Collections.Specialized"/>
    <add namespace="System.Configuration"/>
    <add namespace="System.Text"/>
    <add namespace="System.Text.RegularExpressions"/>
    <add namespace="System.Linq"/>
    <add namespace="System.Xml.Linq"/>
    <add namespace="System.Web"/>
    <add namespace="System.Web.Caching"/>
    <add namespace="System.Web.SessionState"/>
    <add namespace="System.Web.Security"/>
    <add namespace="System.Web.Profile"/>
    <add namespace="System.Web.UI"/>
    <add namespace="System.Web.UI.WebControls"/>
    <add namespace="System.Web.UI.WebControls.WebParts"/>
    <add namespace="System.Web.UI.HtmlControls"/>
   </namespaces>
   <controls>
    <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
    <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
   </controls>
  </pages>
  <!--
            The <authentication> section enables configuration 
            of the security authentication mode used by 
            ASP.NET to identify an incoming user. 
       <authentication mode="Windows"/>
        -->

  <!--
            The <customErrors> section enables configuration 
            of what to do if/when an unhandled error occurs 
            during the execution of a request. Specifically, 
            it enables developers to configure html error pages 
            to be displayed in place of a error stack trace.

        <customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
            <error statusCode="403" redirect="NoAccess.htm" />
            <error statusCode="404" redirect="FileNotFound.htm" />
        </customErrors>
        -->
  <httpHandlers>
   <remove verb="*" path="*.asmx"/>
   <add verb="*" path="*.asmx" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
   <add verb="*" path="*_AppService.axd" validate="false" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
   <add verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" validate="false"/>
  </httpHandlers>
  <httpModules>
   <add name="ScriptModule" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
  </httpModules>
 </system.web>
 <system.codedom>
  <compilers>
   <compiler language="c#;cs;csharp" extension=".cs" warningLevel="4" type="Microsoft.CSharp.CSharpCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
    <providerOption name="CompilerVersion" value="v3.5"/>
    <providerOption name="WarnAsError" value="false"/>
   </compiler>
   <compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" warningLevel="4" type="Microsoft.VisualBasic.VBCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
    <providerOption name="CompilerVersion" value="v3.5"/>
    <providerOption name="OptionInfer" value="true"/>
    <providerOption name="WarnAsError" value="false"/>
   </compiler>
  </compilers>
 </system.codedom>
 <!-- 
        The system.webServer section is required for running ASP.NET AJAX under Internet
        Information Services 7.0\.  It is not necessary for previous version of IIS.
    -->
 <system.webServer>
  <validation validateIntegratedModeConfiguration="false"/>
  <modules>
   <remove name="ScriptModule"/>
   <add name="ScriptModule" preCondition="managedHandler" type="System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
  </modules>
  <handlers>
   <remove name="WebServiceHandlerFactory-Integrated"/>
   <remove name="ScriptHandlerFactory"/>
   <remove name="ScriptHandlerFactoryAppServices"/>
   <remove name="ScriptResource"/>
   <add name="ScriptHandlerFactory" verb="*" path="*.asmx" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
   <add name="ScriptHandlerFactoryAppServices" verb="*" path="*_AppService.axd" preCondition="integratedMode" type="System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
   <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
  </handlers>
 </system.webServer>
 <runtime>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
   <dependentAssembly>
    <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
    <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
   </dependentAssembly>
   <dependentAssembly>
    <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
    <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
   </dependentAssembly>
  </assemblyBinding>
 </runtime>
</configuration> 
```

# php - 为什么从我的 Web 服务器提供的图像没有缓存在客户端上？

> ID：947638
> 
> 赞同：2
> 
> 时间：2009-06-03T22:37:39.107
> 
> 标签：php, apache, caching

我将所有图像存储在 webroot 后面（之前`/var/www/`），这意味着 Web 服务器无法为我的图片发回缓存标头。我需要添加什么才能使用户的网络缓存正常工作？目前，这每次都会被同一个浏览器击中。

我`<img>`页面上的路径如下所示：

```
<img src="pic.php?u=1134&i=13513&s=0"> 
```

**编辑：**可能是因为“ `pic.php?u=1134&i=13513&s=0`”不是有效的文件名或其他什么？

```
// pic.php
<?php

    // open the file in a binary mode
    $user = $_GET['u'];
    $id = $_GET['i'];
    $s = $_GET['s'];

    if (!isset($user) && !isset($s) && $isset($id))
    {
        // display a lock!
        exit(0);
    }

    require_once("bootstrap_minimal.php"); //setup db connection, etc

    // does this image_id belong to the user?
    $stmt = $db->query('SELECT image_id, user_id, file_name, private FROM images WHERE image_id = ?', $id);
    $obj = $stmt->fetchObject();

    if (is_object($obj))
    {
        // is the picture is the users?
        if ($obj->user_id != $_SESSION['user_id'])
        {
            // is this a private picture?
            if ($obj->private == 1)
            {
                // check permissions...
                // display a lock in needed!
            }
        }
    }
    else
    {
        // display a error pic?!
        exit(0);
    }

    if ($s == 0)
    {
        $picture = $common->getImagePathThumb($obj->file_name);
    }
    else
    {
        $picture = $common->getImagePath($obj->file_name);
    }

    // send the right headers
    header("Content-Type: image/png");
    header("Content-Length: " . filesize($picture));

    $fp = fopen($picture, 'rb');

    // dump the picture and stop the script
    fpassthru($fp);
    exit;
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T22:48:15.777

您需要添加以下内容：

```
$expiry = 3600*24*7; // A week
header('Expires: ' . gmdate('D, d M Y H:i:s' time() + $expiry) . ' GMT');
header('Cache-control: private, max-age=' . $expiry); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T22:45:39.150

Apache 默认只缓存静态文件。您需要通过该`header()`函数发送缓存控制标头。[这篇文章](http://www.mnot.net/cache_docs/#IMP-SCRIPT)有很多关于这个主题的信息。

或者，您可以使用 PHP 文件重定向到图像的实际位置。（如果您对标头一无所知，这可能是最简单的方法。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T22:49:49.503

你可以试试：

```
header("Cache-Control: max-age=3600"); 
```

这应该在文件上发送一小时的缓存超时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T22:46:16.857

在您的情况下，我会做的是使用 .php 文件流式传输图像的字节。不要直接链接到图片；相反，链接到一个 php 文件： - 输出缓存头 - 从磁盘上读取文件，从 webroot 后面 - 将图像位发送到网络中

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T22:48:22.470

简单的答案：您没有告诉用户的浏览器缓存它

# .net - 用于分析 .NET 程序的函数执行时间的工具

> ID：947658
> 
> 赞同：2
> 
> 时间：2009-06-03T22:41:35.570
> 
> 标签：.net, benchmarking, profiling

有哪些工具可用于通过测量函数执行时间和生成图表来分析 .NET 程序，以可视化调用图表中各个点所花费的时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T22:45:31.727

它会花费你，但[Ants Performance Profiler](http://www.red-gate.com/products/ants_performance_profiler/index.htm)会完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:47:08.807

[CLR 探查器](http://www.hanselman.com/blog/MeasureTwiceCutOnceCLRProfiler20.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T23:14:34.053

[AQTime](http://www.automatedqa.com/products/aqtime/)和[dotTrace](http://www.jetbrains.com/profiler/)是两个非常好的商业分析器。

一个免费的选项是[ProfileSharp](http://www.softprodigy.net/)，尽管我运气不佳。

Microsoft 也提供了[CLR Profiler](http://www.microsoft.com/downloads/details.aspx?FamilyId=86CE6052-D7F4-4AEB-9B7A-94635BEEBDDA&displaylang=en)，它运行良好，但功能较少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T22:57:12.060

有一个免费的 C# IDE [SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/Download/) 3.1，它集成了[分析器](http://community.sharpdevelop.net/blogs/siegfried_pammer/archive/2009/04/04/introducing-a-new-tool-in-sharpdevelop-the-profiler.aspx)，它与 Visual Studio 解决方案兼容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-06T16:49:19.553

目标是什么？您是否只想 1) 查看带有时间的漂亮调用图，或者 2) 找到成本点以进行优化以使您的程序更快？

如果答案是 (2)，并且您不介意免费的东西，您可以[试试这个](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)。

[这](https://stackoverflow.com/questions/926266/performance-optimization-strategies-of-last-resort/927773#927773)给出了如何使用它的示例。

# c# - 禁用时可以更改asp.net文本框的背景颜色吗？

> ID：947665
> 
> 赞同：0
> 
> 时间：2009-06-03T22:43:41.293
> 
> 标签：c#, asp.net

当我将 Enabled 设置为 false 时，它​​将文本框的背景设置为灰色，可以更改吗？现在，带有黑色文本的灰色背景使它有点难以阅读。

或者，我必须改用 readonly 属性并自己设置背景色，这是正确的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T23:02:28.027

有几种方法可以实现这一点：

1) 使用 CSS 更改所有输入控件的外观。只需在 CSS 文件中输入“input[disabled] {border:solid 1px red;}”即可。

2) 使用 ASP.NET 皮肤，在皮肤文件中你可以写：

```
<asp:TextBox runat="server" SkinID="disabled" CssClass="disabled"></asp:TextBox> 
```

这将仅为该 TextBox 设置禁用的 CSS 类

3) 手动将 CSS 类分配给您想要禁用的文本框，例如：

```
<asp:TextBox runat="server" ID="x" Enabled="false" CssClass="disabled"></asp:TextBox> 
```

4）创建从 TextBox 继承的自定义控件并以这种方式进行配置。

# c# - ProtoInclude 属性是什么意思（在 protobuf-net 中）

> ID：947666
> 
> 赞同：20
> 
> 时间：2009-06-03T22:43:43.943
> 
> 标签：c#, .net, protocol-buffers, protobuf-net

在[ProtoBuf-Net](http://code.google.com/p/protobuf-net/)实现中，**ProtoInclude**属性是什么意思，它有什么作用？

一个例子将不胜感激。

我[在这篇文章中](https://stackoverflow.com/questions/675349/deserialize-unknown-type-with-protobuf-net)看到了它，但我不确定它的作用。这个例子是：

```
[Serializable,
 ProtoContract,
 ProtoInclude(50, typeof(BeginRequest))]
abstract internal class BaseMessage
{
  [ProtoMember(1)]
  abstract public UInt16 messageType { get; }
}

[Serializable,
 ProtoContract]
internal class BeginRequest : BaseMessage
{
    [ProtoMember(1)]
    public override UInt16 messageType
    {
        get { return 1; }
    }
} 
```

另外，有没有办法使用**protogen**工具生成这种继承？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-11T23:30:59.617

对不起，我不是故意错过这个 - 唉，我没有看到一切。

鉴于问题中的细节，我将假设您至少对 .proto 非常熟悉；如果我错了，请纠正我。

`[ProtoInclude]`工作原理很像`[XmlInclude]`for `XmlSerializer`- 或`[KnownType]`for `DataContractSerializer`- 它允许它在（反）序列化期间识别类型的子类。唯一额外的事情是它需要一个标签（数字）来标识每个子类型（必须是唯一的，并且不与父类型中的任何字段冲突）。

再原生质：不；*底层规范（由 google 提供）根本*没有提供继承，因此 protogen（通过 .proto）没有表达这一点的机制。protobuf-net 作为*扩展*提供继承支持，但这样做的方式仍然使消息与其他实现保持兼容。在推动下，*也许*我可以通过谷歌规范中的新扩展属性添加 protogen 支持，但我还没有这样做。

所以; 看例子；表示`BaseMessage`和之间的继承关系`BeginRequest`；无论您是否这样做：

```
Serialize<BaseMessage>(...)
Serialize<BeginRequest>(...) 
```

*   无论哪种方式，它将从底部 ( `BaseMessage`) 开始并向上工作；这并不*完全*正确 - 它以开头写入*数据*`BeginRequest`（以便它知道我们`BeginRequest`在反序列化期间尽早拥有 a ）。重要的是包含来自任何父合约类型的字段，并且序列化程序会查看传入的*实际*对象 - 而不仅仅是您*所说*的类型。

同样，在反序列化期间，无论您是否使用：

```
Deserialize<BaseMessage>(...)
Deserialize<BeginRequest>(...) 
```

你会得到你实际序列化的类型（大概是 a `BeginRequest`）。

在引擎盖下，出于兼容性目的（使用宽协议缓冲区规范），这类似于编写类似的内容（请原谅任何错误，我的 .proto 是生锈的）：

```
message BaseMessage {
    optional BeginRequest beginRequest = 50;
    optional uint32 messageType = 1;   
}
message BeginRequest {        
} 
```

（覆盖可能不应该指定`[ProtoMember]`，顺便说一句。

通常，它会按标签升序写入字段，但为了进行有效的反序列化，引擎厚颜无耻地选择首先写入子类数据*（*规范明确允许） - 即它写入类似（你必须想象二进制...）：

```
[tag 50, string][length of sub-message][body of sub-message][tag 1, int][value] 
```

（在这种情况下，子消息的正文为空）

这覆盖它吗？

# c# - 将自定义对象传递给 Web 服务

> ID：947680
> 
> 赞同：13
> 
> 时间：2009-06-03T22:46:36.140
> 
> 标签：c#, .net, web-services

我需要将自定义对象传递给远程 Web 服务。我已经读过可能有必要实现 ISerializable，但我已经做到了，我遇到了困难。C# 中将自定义对象传递给 Web 服务方法的正确方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T23:32:53.923

作为服务请求的一部分作为参数提供的对象必须用 [Serializable] 标记，并且根据我之前发布的一些答案，您还需要确保您的自定义对象不包含构造函数中的任何参数。

另外请记住，您在类中拥有的任何逻辑都不会在客户端创建的代理类中创建。您将在客户端看到的只是默认构造函数和属性。因此，如果您向自定义对象添加方法，请记住客户端将看不到它们或无法使用它们。

同样的事情也适用于您可能放入任何属性的任何逻辑。

例子

```
[Serializable]
public class Customer
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T22:58:29.873

看起来像这个[问题的重复](https://stackoverflow.com/questions/347047/passing-a-custom-object-to-the-web-service)

无论如何，WS 交互中涉及的所有对象都应该是 XML 可序列化的，而不是 ISerializable（这是二进制序列化）。此外，它们应该在服务合同 (WSDL) 中进行描述，否则客户端将无法使用它们。[本文](http://msdn.microsoft.com/en-us/library/564k8ys4(VS.85).aspx)应该有助于理解 XML Web Services 的 XML 序列化。

但是，如果您谈论的是**真正的自定义**对象（即任何类型）。您应该考虑以二进制形式传递它们：作为 base64 编码或作为附件。我链接到的问题有一个答案如何做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T22:51:53.693

编辑：删除了关于 [Serializable] 的部分

您是在创建服务还是在使用它？

要创建一个可以作为 web 方法的参数传递的对象，您不必做任何特别的事情。也就是说，如果您正在创建一个 asmx 网络服务。

OTOH，如果您正在创建 WCF 服务，那么您必须使用 [DataContract] 标记该类，并使用 [DataMember] 标记您想要序列化的所有成员。

如果您正在使用 Web 服务，则应在添加服务引用时生成要传递的对象的代理类。你只需要使用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T23:28:36.490

查看这个[问题](https://stackoverflow.com/questions/710856/how-do-you-send-complex-objects-using-wcf-does-it-work-is-it-good/710944#710944)以了解如何为您的自定义对象实现 XML 序列化

# class - 访问与其他两个类相关的类

> ID：947686
> 
> 赞同：1
> 
> 时间：2009-06-03T22:47:40.380
> 
> 标签：class, class-design, oop

给定下表：用户、试用版、用户试用版。如果用户有多个试用版，试用版不会在内部映射到任何用户并包含**有关试用版的**详细信息（名称、描述、设置），而 UserTrial 包含特定于**用户试用版实例的**信息（例如到期日期） . MVC 应用程序的控制器访问有关 UserTrial 的数据的正确方法是什么？

# 额外细节

*   没有ORM
*   每个类都有双重用途，可用于创建新的或加载现有的用户、试用版或用户试用版。构造函数在传递 ID 时加载数据并使用方法 ->save() 将其持久化

似乎有两种选择：

# 1

User.SetTrial() User.GetUserTrial()

# 2

UserTrial.SetUser() UserTrial.SetTrial() UserTrial.GetSomeData()

哪种用法最合适？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T23:02:53.517

我不认为你的选项 1 会起作用，因为如果每个用户可以有多个试用版，那么你需要像 User.AddTrial(Trial)、User.RemoveTrial(Trial)、User.getUserTrails() 这样的东西。

您选择哪种设计选项取决于您是否要将 UserTrial 对象设为“一流”。您是否希望将用户和试用对象视为主要对象，而 UserTrial 对象只是粘合以保持关系，或者您是否希望 UserTrial 对象也是主要对象？如果是前者，您将需要类似于选项 1 的东西；如果是后者，你会想要像你的选项 2 这样的东西。

# crystal-reports - Crystal Reports Excel export with worksheets

> ID：947687
> 
> 赞同：0
> 
> 时间：2009-06-03T22:47:46.573
> 
> 标签：crystal-reports

Is there a way to convince Crystal Reports to export a page / group / whatever to separate worksheets when exporting to Excel (Data Only)? I'm using the CR that came with VS2008 (version 10.5)

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T22:55:01.160

According to the documentation you cannot export a report directly to multiple worksheets in a single Excel workbook.

When the limit of 65536 rows in Excel is reached though, the exporter does create a new worksheet, but you are not in control :)

**update**
To create your own Excel merger:

PRE: Make sure you have the Office (Excel) SDK libraries installed.
PRE: Place the files that need to be merged in a single directory.

In a VS2008 solution:

*   Create a new empty Excel Workbook (variable: **objNewWorkbook**)
*   Loop through the files in the directory (where you placed the Excel files) and for each item:
    1.  Load the file as a Excel Workbook (variable: **objWorkbookLoop**)
        *   Create a new Worksheet in **objNewWorkbook** (optionally: with the filename of **objWorkbookLoop**) (variable: **objNewWorksheetLoop**)
        *   Copy the data from (probably sheet1 in) **objWorkbookLoop** to **objNewWorksheetLoop**
*   Finally save **objNewWorkbook** to a file.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T23:57:13.550

One of the things everybody ignores is that excel automation is not an acceptable solution. Yes it works ( almost always) , but even Microsoft recommends to not use it for unattended execution : [http://support.microsoft.com/kb/257757](http://support.microsoft.com/kb/257757) The only safe way I know to export a crystal report to multiple worksheets is by creating a grouped report and burst it using R-Tag report manager. This tool is not using Excel automation so you can run your reports at any time and on the server but if you are currently using another software to run your reports you will need to switch to this one (it is not an extension).

I know this thread is an old one, but I can see links to it without a real answer. Hopefully this will help somebody.

# apache-flex - Flex 调试模式不一致，为什么？

> ID：947689
> 
> 赞同：1
> 
> 时间：2009-06-03T22:48:09.240
> 
> 标签：apache-flex, flash, debugging, versions

我在一个大型 flex 应用程序上遇到了这个非常奇怪的问题，如果用户安装了调试闪存，它可以在调试 swf 下运行良好，但对于使用标准版本闪存的人来说会有一些差异。

这些差异包括：

*   没有弹出窗口

*   松开所有事件捕获

*   奇怪的按钮位置

我在某处读到 updatedisplaylist 的处理方式不同？现在我将尝试导出发布方式而不是 bin-debug swf，并返回提交以查看转折点是什么。

有没有类似的经历？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T01:07:39.537

我已经使用 Flex 很长时间了，从未听说过与使用 Flash 播放器的调试版本和标准版本有关的任何问题，但我遇到了与您遇到的类似的问题。

当您的应用程序中发生异常时，例如尝试访问空类中的某些内容或尝试访问只有 9 的数组中的元素 10，调试播放器将弹出一个窗口，说明发生了异常并给您一个堆栈跟踪，即使您没有主动调试应用程序。标准播放器没有，因此用户无法知道出了什么问题。

根据我的经验，在发生未捕获的异常后，它会使从那时起所有正在运行的代码非常不稳定，从而导致您列出的所有问题等等。

我怀疑您的问题与标准播放器之外的两个不同播放器有关，没有给您有关应用程序状态的任何反馈。

# jquery - outerHeight 不是函数吗？

> ID：947692
> 
> 赞同：2
> 
> 时间：2009-06-03T22:48:49.160
> 
> 标签：jquery

这个 jQuery 函数有问题：

```
$("#content").siblings().each(function(i){
  heightOfSiblings = heightOfSiblings + this.outerHeight();     
}); 
```

错误是“outerHeight 不是函数。”

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T22:54:51.880

我认为您将需要 $(this).outerHeight();

[http://docs.jquery.com/CSS/outerHeight](http://docs.jquery.com/CSS/outerHeight)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T22:52:51.650

outerHeight 是一个属性

```
heightOfSiblings = heightOfSiblings + this.outerHeight; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-20T10:29:38.233

老东西，但我最近遇到了同样的问题，解决方案是使用最新版本的 jQuery :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-13T10:51:37.620

如果您正在评估的元素为空，也可能会收到此错误消息。

即：如果没有带有“elem”类的元素，则会出现此错误（“outerHeight 不是函数”）：

```
$(".elem").outerHeight(); 
```

# c++ - C++ 类实例

> ID：947696
> 
> 赞同：1
> 
> 时间：2009-06-03T22:49:30.313
> 
> 标签：c++

我正在做介绍 c++ 的作业，但我被卡住了。

```
Account *GetAccount(int an);

int main()
{
Account *a1,*a2,*b1;
a1=GetAccount(123);
a2=GetAccount(456);
b1=GetAccount(123);
if(a1==b1)
  cout<<"YES"<<endl;
else
  cout<<"NO"<<endl; 
```

GetAccount 方法应该检查是否已经存在具有相同帐号的实例，如果存在，则返回该实例。

我能想到的唯一方法是创建帐户数组并搜索帐户，然后如果它不存在，则在数组中插入新帐户。如果存在，则返回指向数组的指针。

这种方法对我来说似乎并不有效，还有其他方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T22:55:14.890

是的。使用地图而不是数组。它在空间方面的填充效率更高，而且速度几乎一样快。

您可以使用 STL 并将您的帐户保存在 std::map 中，这是以下变体之一：

```
map<int, Account> or
map<int, Account*> 
```

在第一种情况下，您将帐户保留在地图中，在第二种情况下，您保留指向帐户的指针，并负责创建/删除。哪种变体更合适？这取决于您创建/初始化帐户的方式。

* * *

**STL map 使用简短教程**

当您将指针保留在地图中时，我将解释这种情况。

这是您声明地图的方式：

```
map<int, Account*> accounts; 
```

这是向地图添加新帐户的方法：

```
int account_id = 123; // or anything else

Account* account = new Account(...paramters for the constructor...)
// any additional code to initialize the account goes here

accounts[account_id] = account;  // this adds account to the map 
```

这是您检查具有 account_id 的帐户是否在地图中的方法：

```
if (accounts.find(account_id) != accounts.end()) {
  // It is in the map
} else {
  // it is not in the map
} 
```

这是您从地图中获取指向帐户的方法：

```
Account* ifoundit = accounts[account_id]; 
```

最后，在程序结束的某个地方，您需要清理地图并删除所有帐户对象。即使没有清理，该程序也可以正常工作，但重要的是要自己清理。我将此作为练习留给您:) 了解如何迭代地图的所有元素，并适当地应用删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T23:17:52.050

> 这种方法对我来说似乎并不有效，还有其他方法吗？

是的，正如其他人所提到的，使用数组以外的数据结构有更有效的方法。但是，如果您最近一直在课堂上学习数组和循环，那么您描述的方法可能就是您的讲师所期望的。我不会试图比你的导师*走得太远*，因为数组和循环方法可能是你参加考试时需要非常熟悉的东西。在您继续前进之前，在基础知识方面打下坚实的基础也是一个好主意。（不过，不要让这阻止您在这里提出更高级的问题。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T22:53:15.173

考虑[哈希表](http://en.wikipedia.org/wiki/Hash_table)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T22:53:14.957

您可以使用[std::map](http://www.cplusplus.com/reference/stl/map/)而不是简单的数组。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-05T04:25:02.093

您提出的方法，即您遍历和测试的一组 id，是一种非常简单的方法。但是，我会使用 std::vector，而不是数组，因为这样您就不必担心大小。否则，您只需声明一个大数组，并在添加时测试它是否未满。

就效率而言，对一个小数组（数百个）进行线性搜索非常快，并且可能比其他解决方案（如地图和集合）更快。但是，它不能很好地扩展。

试着写好你的代码，但在你知道你有问题之前不要担心优化它。我宁愿我的程序员编写干净、易于维护的代码，也不愿追求最佳速度。如果需要，我们总是可以在以后加快速度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T22:54:16.013

创建帐户的 std::map # => Account 对象。

# oracle - Reporting Services 中的必需参数 - 从 Oracle 返回错误

> ID：947697
> 
> 赞同：0
> 
> 时间：2009-06-03T22:49:45.353
> 
> 标签：oracle, reporting-services

我需要处理一些有些复杂的参数验证要求。我们对 Oracle 8.1 DB 使用 SQL 报告 2005。

用户不能选择超过一年的日期范围 必须提供 FooParm 或必须提供 Codes 并且 CodeStart 和 CodeEnd 之间的差异必须小于 1001

以伪代码格式

```
(dateStart and dateEnd DIFF < 1 year AND !=0) 

AND 

(
   (FooParm !=0) 
   OR 
   (CodeStart AND CodeEnd < 1001 AND CodeStart!='' AND CodeEnd!='')
) 
```

据我所见，实现这一目标的唯一方法是使用自定义前端，但我们已经有了一个，并且不会针对此请求进行修改。

我想创建一个 Oracle 过程来检查并返回一个说明问题的错误。

是否会向用户提出错误？我假设它只会被写入错误日志，并且将向用户显示默认错误页面。

我可能会返回一个包含相关错误消息的记录集。

还有其他想法吗？我不是报告专业人士，所以我可能会说这一切都错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T06:26:38.427

我会认为对 RAISE_APPLICATION_ERROR 的调用会成为用户的方式？

```
BEGIN
    IF <your-parameter-validation> THEN
        RAISE_APPLICATION_ERROR (
            num=> -20501,
            msg=> 'Parameters are incorrect etc.');
    END IF;

   <continue-your-code>

   ... 
```

当我们使用 Crystal Reports 调用 PL/SQL 函数时，这对我们有用……希望对您有用。

# f# - F#：实际上，“字符串”和“字符串选项”有什么区别？

> ID：947710
> 
> 赞同：5
> 
> 时间：2009-06-03T22:53:04.533
> 
> 标签：f#

实际上，“字符串”和“字符串选项”有什么区别？

除了轻微的 sytnax 问题之外，我看到的唯一区别是您可以将“null”传递给字符串，而字符串选项需要“none”。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-06-03T23:44:28.737

我不是特别喜欢我在下面打出的答案，因为我认为读者要么将其视为“向合唱团讲道”或“一些复杂的废话”，但我还是决定将其发布在如果它邀请富有成果的评论讨论。

首先，值得注意的是

```
let x : string option = Some(null) 
```

是一个有效值，表示存在（而不是不存在）一个值（Some 而不是 None），但该值本身为 null。（这种值的含义取决于上下文。）

如果你正在寻找我认为“正确”的心理模型，它会是这样的......

“所有引用类型都承认一个‘空’值”的整个概念是 .Net 和 CLR 的最大和最昂贵的错误之一。如果今天从头开始重新设计该平台，我认为大多数人都同意默认情况下引用不可为空，并且您需要一个明确的机制来选择为空。就目前的情况而言，有数百甚至数千个 API 采用例如“string foo”并且不想要 null（例如，如果您传递 null，则会抛出 ArgumentNullException）。显然，这是由类型系统更好地处理的。理想情况下，“字符串”意味着“非空”，并且*对于**少数*API*想要空值，你把它拼出来，例如“Nullable<string> foo”或“Option<string> foo”或其他什么。因此，现有的 .Net 平台就是这里的“怪人”。*

 *许多函数式语言（例如 ML，F# 的主要影响之一）一直都知道这一点，因此将它们的类型系统设计得“正确”，如果你想承认一个“空”值，你可以使用泛型类型构造函数来明确表示可以有意将“价值损失”作为合法价值的数据。在 ML 中，这是通过“'t option”类型完成的 - 'option' 是解决这个问题的一个很好的通用解决方案。F# 的核心与 OCaml（一种 ML 方言）兼容（交叉编译），因此 F# 从其 ML 祖先继承了这种类型。

但是F#也需要和CLR集成，并且在CLR中，所有的引用都可以为null。F# 尝试走一条稍微好一点的路线，因为您可以在 F# 中定义新的类类型，并且对于这些类型，F# 的行为类似于 ML（并且不容易将 null 作为值接受）：

```
type MyClass() = class end
let mc : MyClass = null  // does not compile 
```

但是，在 C# 程序集中定义的相同类型将允许 null 作为 F# 中的正确值。（而且 F# 仍然允许后门：

```
let mc : MyClass = Unchecked.defaultof<_> // mc is null 
```

有效地绕过正常的 F# 类型系统并直接访问 CLR。​​）

这一切开始听起来很复杂，但基本上 F# 系统允许您以“ML”风格编写大量 F#，您无需担心 null/NullReferenceExceptions，因为类型系统可以防止您做错事这里。但是 F# 必须与 .Net 很好地集成，因此源自非 F# 代码的所有类型（如“字符串”）仍然允许空值，因此在使用这些类型进行编程时，您仍然必须像往常一样进行防御性编程CLR。关于 null，实际上 F# 提供了一个避风港，可以轻松地进行“没有 null 的编程，按照上帝的意图”，但同时与 .Net 的其余部分进行互操作。

I haven't really answered your question, but if you follow my logic, then you would not ask the question (or would unask it, a la Joshu's MU from "Godel, Escher, Bach").

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T22:59:02.057

我认为您可以将其重新分类为更一般的问题

> option random ref type 和 just a random ref type 有什么区别

不同之处在于一个选项，您提供了一个明确的空值案例。这是一种声明方式，表示“我可能不会提供价值”。值为 None 的选项明确表示缺少值。

人们经常使用 null 来表示缺少值。不幸的是，这对普通读者来说是模棱两可的，因为不知道 null 是表示有效值还是缺少值。选项消除了这种歧义。

# java - 如何使用 JSP 列出服务器目录的内容？

> ID：947730
> 
> 赞同：11
> 
> 时间：2009-06-03T22:58:32.947
> 
> 标签：java, jsp, file

在编写 JSP 文件时，如何在运行时获取该文件的**当前目录**
（以便能够迭代目录并列出其内容）？

是否会因为某些安全问题而限制某些文件 I/O 操作？

*我更喜欢不访问某些特定于实现的服务器变量/属性的解决方案。*

**编辑：**
我不会问它是否像 一样简单*`new File(".")`*，因为这只会给出服务器可执行文件的目录。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-18T11:13:44.357

```
 <%@page import="java.io.*" %> 
        <%@page import="java.util.*" %> 
        <%!        public void GetDirectory(String a_Path, Vector a_files, Vector a_folders) {
                File l_Directory = new File(a_Path);
                File[] l_files = l_Directory.listFiles();

                for (int c = 0; c < l_files.length; c++) {
                    if (l_files[c].isDirectory()) {
                        a_folders.add(l_files[c].getName());
                    } else {
                        a_files.add(l_files[c].getName());
                    }
                }

            }
        %> 

        <%
            Vector l_Files = new Vector(), l_Folders = new Vector();
            GetDirectory("C:/mydirectory/", l_Files, l_Folders);

            //folders should be left out... 
            //for( int a = 0 ; a<l_Folders.size() ; a++ ) 
            //out.println( "[<b>"+l_Folders.elementAt(a).toString() + "</b>]<br>") ; 

            //generate files as XML 
            out.println("<music>");

            for (int a = 0; a < l_Files.size(); a++) {
                out.println("<file>" + l_Files.elementAt(a).toString() + "</file>");
            }

            out.println("</music>");
        %> 
```

将**“C:/mydirectory/”**替换为您的目录

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-04T01:10:10.483

您应该知道 Web 应用程序中 jsp 的路径，以便将其传递给 getRealPath()

```
File jsp = request.getRealPath(pathToJspInWebapp);  //eg. /WEB-INF/jsp/my.jsp
File directory = jsp.getParentFile();
File[] list = directory.listFiles(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-08-04T16:48:03.840

从 Java Servlet API 的 2.1 版开始，使用：

```
File jsp = new File(request.getSession().getServletContext().getRealPath(request.getServletPath()));
File dir = jsp.getParentFile();
File[] list = dir.listFiles(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-06T12:49:16.200

一个正确/有效的例子：

```
File jsp = new File(request.getRealPath(request.getServletPath()));
File dir = jsp.getParentFile();
File[] list = dir.listFiles(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-23T12:00:17.493

这个我用过

```
File jspFile = new File(request.getRealPath(request.getServletPath()));
        File dir = jspFile.getParentFile();
        String requestURL = request.getRequestURL().toString();
        String urlDir = requestURL.substring(0, requestURL.lastIndexOf('/'));

        File[] files = dir.listFiles(new FilenameFilter() {
            @Override
            public boolean accept(File dir, String name) {
                return name.endsWith(".ipa");
            }
        }); 
```

# sql-server - 在 SQLServer 中保存日期

> ID：947732
> 
> 赞同：9
> 
> 时间：2009-06-03T22:59:37.970
> 
> 标签：sql-server, datetime

我有一个遗留应用程序，其中输入是日期字符串，即：

> 2009 年 6 月 12 日

输入的格式总是一个字符串，并且是一致的，总是dd/mm/yyyy

目前，旧版应用程序只是将其插入到 DateTime 字段中。显然，如果服务器的本地化文化设置发生变化，**我们就有了一个错误**。

两个问题：

*一*：

**在这种情况下，在 SQLServer 中存储日期的最安全方法是什么？**

**无论日期和月份的顺序如何，是否存在始终正确解释的格式？**

*二：*

**哪些设置准确地决定了 SQLServer 数据库的文化，是操作系统设置，还是该数据库的设置，还是什么？**

干杯

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T23:02:15.500

格式`YYYY-MM-DD`是明确的，这意味着 SQL Server 在将字符串值转换为`DATETIME`. （我从来没有遇到过使用四位数年份的格式进行隐式转换的问题。）

在 SQL Server 中存储日期值的“最安全”（也是最方便）的方法是使用 DATETIME 数据类型。

在和字符串之间进行转换时，使用该`CONVERT`函数显式指定输入和输出格式。`DATETIME`

SQL Server 2005 关于 CONVERT***样式***参数值的文档：

[http://msdn.microsoft.com/en-us/library/ms187928(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms187928(SQL.90).aspx)

要将字符串表示形式转换为 DATETIME 数据类型：

```
select CONVERT(datetime, '2009-06-03', 20) 
```

第一个参数是要转换的数据类型，第二个参数是要转换的表达式，第三个参数是*样式*。

（*样式*20 是 ODBC 规范格式 = `'YYYY-MM-DD HH:MI:SS'`（24 小时制）

* * *

[跟进]

将 DATETIME 表达式（例如 getdate() 转换为 VARCHAR`'YYYY-MM-DD'`格式：

```
select CONVERT(varchar(10), getdate(), 20) 
```

请注意，指定 varchar(10) 只会获取 etnire`'YYYY-MM-DD HH:MM:SS'`格式的前 10 个字符。

[/跟进]

* * *

至于什么决定了默认格式，这将是研究。我们通过指定格式来避免默认格式引起的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T23:09:49.570

我建议在将所有日期放入数据库时​​将它们存储为 UTC 时间。这样会保持一致。

像这样存储日期似乎效果很好......

```
YYYY-MM-DD 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T23:14:51.713

请参阅[设置日期格式](http://msdn.microsoft.com/en-us/library/ms189491.aspx)。SQL 'culture' 由[SET LANGUAGE](http://msdn.microsoft.com/en-us/library/ms174398(SQL.90).aspx)在会话级别设置。SQL Server 有自己的日期格式设置，独立于宿主操作系统。这有几个原因： ANSI 合规性，为了防止操作系统更改影响使用该主机上托管的数据库的应用程序，尤其是兼容性，SQL 早于操作系统当前运行的时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-04T07:05:43.827

请记住，数据不是它的介绍。在这种情况下，DATA 是 DATE 或 DATETIME，无论您如何显示它们。
至于插入/更新/比较日期时间值，我引用了 BOL：

> 在比较中或为 INSERT 或 UPDATE 语句的输入指定日期时，请使用对所有语言设置解释相同的常量：ADO、OLE DB 和 ODBC 应用程序应使用以下 ODBC 时间戳、日期和时间转义子句：
> { ts 'yyyy-mm-dd hh:mm:ss[.fff] '} 如：{ ts '1998-09-24 10:02:20' }
> { d 'yyyy-mm-dd'} 如：{ d '1998-09-24' }
> { t 'hh:mm:ss'} 如：{ t '10:02:20'}

我可以向您保证，如果您使用这种格式，它们将始终有效，无论您的服务器的语言环境如何

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T01:20:22.973

在这些问题上我有点保守，但我更喜欢在表中使用单独的年/月/日字段，而不是使用特定于 DBMS 数据类型的日期字段。它当然需要更多空间，但对我来说，没有歧义和增加便携性是值得的。

您付出的代价是您没有获得免费的日期/时间算术和排序，但您自己或通过稍微复杂的“ORDER BY”子句很容易做到。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-20T22:45:18.270

我同意 spencer7593 的建议，但请注意，在没有格式的情况下使用 cast 或 convert 会产生意想不到的结果。此 T-SQL 查询返回 12，而不是 1。

```
set language British
select month(CAST('2016-01-12' AS datetime)) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-08T04:04:43.107

通常我更喜欢插入为

```
insert into tbl values('yyyyMMdd') 
```

然后，它将基于 db 以适当的格式插入。

# c++ - 调试命令行应用程序

> ID：947742
> 
> 赞同：1
> 
> 时间：2009-06-03T23:02:21.660
> 
> 标签：c++, visual-studio-2008, debugging

我想知道是否可以在 Visual Studio 2008 中调试命令行应用程序（主要接收参数 argc 和 **argv）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T23:05:23.060

您可以在 Visual Studio 中的“配置属性”下的“调试”屏幕中轻松地将命令参数设置为可执行文件（至少 2005 年是这样）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T23:04:46.680

是的; 它的工作方式与 GUI 应用程序相同。在某处设置断点，然后点击调试开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T23:04:56.617

当然！只需在 上设置一个断点`main`，然后转到您的项目属性（如果我没记错的话，在 Debug 部分下），然后设置您要调试的命令行参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T23:05:55.630

为什么不可能？设置断点并开始调试。

# iphone - 访问 iPhone 上 UIView 中的每个按钮

> ID：947768
> 
> 赞同：3
> 
> 时间：2009-06-03T23:10:07.527
> 
> 标签：iphone

我想要做的是理想地遍历 UIView 中的所有按钮（我有很多，超过 40 个按钮），并根据标签更改按钮显示的图像。有谁知道我该怎么做？

谢谢！！！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-12-22T01:15:40.313

我会说使用该`subviews`属性，正如 Devilaether 所说，但在对它进行任何其他操作之前，请进行额外检查以确保子视图是 UIButton：

```
for(UIView *view in [rootView subviews]) {
    if([view isKindOfClass:[UIButton class]]) {
        if([view tag] == 0) {
            // First image
        } /* ... */
        else {
            NSLog(@"didn't recognize tag");
        }
     } else {
        NSLog(@"view is not a button");
     }
}
```

如果您将 NSArray 与您想要迭代的 UIButtons 一起存储在某个地方，您也可以让您的生活更轻松；这将取出`isKindOfClass:`支票。有关详细信息，请参阅[NSObject 协议](http://developer.apple.com/iphone/library/documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/doc/uid/20000052-BBCBFBDJ)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T23:49:16.870

使用包含按钮的 UIView 的*subview*属性。对于该 NSArray 中的每个 UIView 元素，检查*tag*属性。如果标签符合您的逻辑需求，请更改该 UIView 实例中显示的图像 - 在本例中是按钮之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-22T06:55:33.293

```
for(i=0; i<numberOfTags; i++){ 
UIButton *tempBtn = [yourView viewWithTag:i];
[tempBtn setImage:yourImage]; 
```

}

# javascript - 如何检测 iframe 内的网格点击？

> ID：947773
> 
> 赞同：0
> 
> 时间：2009-06-03T23:11:40.753
> 
> 标签：javascript, asp.net-mvc, iframe

我必须在 iframe 中放置一个网格。我选择一行，然后将详细信息加载到托管该框架的主页中。怎么做？

一张图片胜过1000字。我想重现像 wufoo 这样的主从视图。“黑色”网格位于 iframe 内部。所以网格总是在顶部。选择一行，详细页面将在后面加载。

当在 iframed-grid 中触发行单击事件时，如何在主页上发布帖子，在 asp.net mvc 中？

[![替代文字](https://i.stack.imgur.com/X7elh.png)](https://i.stack.imgur.com/X7elh.png)
[（来源：[flickr.com](https://farm2.static.flickr.com/1310/1468761989_e9f91d2cbb_o.png)）]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T00:18:28.980

在 iframe 内：

“top”变量（或 window.top 或 self.top）应该引用主框架。您可以使用类似 top.location = nextUri;

或者，链接上有一个“目标”属性，可以指定备用帧。链接标记类似于`<a href="uri1" target="_top">`. 您可以使用 document.getElementsByTagName("a")[0].click() 将行中的点击事件转发到链接，假设链接是行中的第一个。（`<base>`也可以使用该元素。）

请记住，更换主框架将需要重新加载 iframe。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T02:35:43.510

这不是您实际问题的答案，但是如果您使用适当大小的 div 和“溢出：自动”的 CSS，您可以获得相同的布局，而无需跨帧进行通信。

# python - 从 Python 中的字符串中去除所有非数字字符（“.”除外）

> ID：947776
> 
> 赞同：66
> 
> 时间：2009-06-03T23:12:00.160
> 
> 标签：python

我有一个很好的工作代码片段，但我想知道是否有人对如何做到这一点有更好的建议：

```
val = ''.join([c for c in val if c in '1234567890.']) 
```

你会怎么办？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-06-03T23:14:46.067

您可以使用正则表达式（使用[**`re`**](https://docs.python.org/2/library/re.html)模块）来完成同样的事情。下面的示例匹配`[^\d.]`（任何不是十进制数字或句点的字符）的运行并将它们替换为空字符串。请注意，如果使用`UNICODE`标志编译模式，则生成的字符串仍可能包含[非 ASCII 数字](http://www.fileformat.info/info/unicode/category/Nd/list.htm)。此外，删除“非数字”字符后的结果不一定是有效数字。

```
>>> import re
>>> non_decimal = re.compile(r'[^\d.]+')
>>> non_decimal.sub('', '12.34fe4e')
'12.344' 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-04T06:24:02.283

另一种“pythonic”方法

`filter( lambda x: x in '0123456789.', s )`

但正则表达式更快。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-06-03T23:44:12.497

这是一些示例代码：

```
$ cat a.py
a = '27893jkasnf8u2qrtq2ntkjh8934yt8.298222rwagasjkijw'
for i in xrange(1000000):
    ''.join([c for c in a if c in '1234567890.']) 
```

* * *

```
$ cat b.py
import re

non_decimal = re.compile(r'[^\d.]+')

a = '27893jkasnf8u2qrtq2ntkjh8934yt8.298222rwagasjkijw'
for i in xrange(1000000):
    non_decimal.sub('', a) 
```

* * *

```
$ cat c.py
a = '27893jkasnf8u2qrtq2ntkjh8934yt8.298222rwagasjkijw'
for i in xrange(1000000):
    ''.join([c for c in a if c.isdigit() or c == '.']) 
```

* * *

```
$ cat d.py
a = '27893jkasnf8u2qrtq2ntkjh8934yt8.298222rwagasjkijw'
for i in xrange(1000000):
    b = []
    for c in a:
        if c.isdigit() or c == '.': continue
        b.append(c)

    ''.join(b) 
```

以及计时结果：

* * *

```
$ time python a.py
real    0m24.735s
user    0m21.049s
sys     0m0.456s

$ time python b.py
real    0m10.775s
user    0m9.817s
sys     0m0.236s

$ time python c.py
real    0m38.255s
user    0m32.718s
sys     0m0.724s

$ time python d.py
real    0m46.040s
user    0m41.515s
sys     0m0.832s 
```

* * *

到目前为止，看起来正则表达式是赢家。

就个人而言，我发现正则表达式与列表理解一样具有可读性。如果你只做几次，那么你可能会在编译正则表达式时受到更大的打击。做适合你的代码和编码风格的事情。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2016-02-22T11:34:56.510

一个简单的解决方案是使用正则表达式

```
import re 
re.sub("[^0-9^.]", "", data) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-01-03T21:15:16.417

```
import string
filter(lambda c: c in string.digits + '.', s) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-04T16:49:37.100

如果字符集较大，则使用如下集可能会更快。事实上，这比 a.py 慢一点。

```
dec = set('1234567890.')

a = '27893jkasnf8u2qrtq2ntkjh8934yt8.298222rwagasjkijw'
for i in xrange(1000000):
    ''.join(ch for ch in a if ch in dec)
```

至少在我的系统上，您可以通过在 a.py 中使用生成器表达式而不是列表推导来节省一点时间（如果您的字符串足够长，还可以节省内存）：

```
a = '27893jkasnf8u2qrtq2ntkjh8934yt8.298222rwagasjkijw'
for i in xrange(1000000):
    ''.join(c for c in a if c in '1234567890.')
```

哦，这是迄今为止我在这个测试字符串上找到的最快的方法（比正则表达式快得多），如果你这样做很多次并且愿意忍受构建几个字符表的开销。

```
chrs = ''.join(chr(i) for i in xrange(256))
deletable = ''.join(ch for ch in chrs if ch not in '1234567890.')

a = '27893jkasnf8u2qrtq2ntkjh8934yt8.298222rwagasjkijw'
for i in xrange(1000000):
    a.translate(chrs, deletable)
```

在我的系统上，它在 ~1.0 秒内运行，而正则表达式 b.py 在 ~4.3 秒内运行。

# unix - 仅使用某些列进行排序

> ID：947788
> 
> 赞同：2
> 
> 时间：2009-06-03T23:14:42.573
> 
> 标签：unix, sorting

我有一个 600MB 的制表符分隔文件，只需要使用前两列进行排序。这些列已按顺序排列的任何行都应保持现有顺序。我努力使用`sort`并且`--key`似乎一直按其他列对行进行排序。

这是未排序文件的示例：

```
1244072768 7234 Z
1244072768 7234
1244072768 7234 乙
1244072768 7234
1244072768 7234一
1244072768 7341 C
1244072768 7341一
1244072768 7234 -
1244072768 7341
1244072768 7341吨
1244072768 7341 -
1244072769 4237 瓦
1244072769 4237一
1244072769 4237 秒
1244072769 4237小时
1244072769 4237 -

```

结果应该是这样的：

```
1244072768 7234 Z
1244072768 7234
1244072768 7234 乙
1244072768 7234
1244072768 7234一
1244072768 7234 -
1244072768 7341 C
1244072768 7341一
1244072768 7341
1244072768 7341吨
1244072768 7341 -
1244072769 4237 瓦
1244072769 4237一
1244072769 4237 秒
1244072769 4237小时
1244072769 4237 -

```

我已经尝试过`sort -k 1n -k 2n test.log;`，`sort -k 1 -k 2 test.log;`并且`sort -k 1,2 test.log;`所有这些都按整行排序。有没有办法使用标准的 linux/unix 命令行工具仅按前两列对该文件进行排序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T23:21:02.963

您应该添加`-s`以获得[稳定的排序](http://en.wikipedia.org/wiki/Sorting_algorithm#Stability)：

```
sort -k 1,2 -s test.log 
```

从手册页：

```
-s，--稳定
       通过禁用最后的比较来稳定排序

```

# python - 如何从 Django 中包含 urls.py 的 get_absolute_url 获取准确的绝对 url？

> ID：947797
> 
> 赞同：0
> 
> 时间：2009-06-03T23:16:41.943
> 
> 标签：python, regex, django, url, models

我现在正在构建一个应用程序，我正试图与我的 Django 项目中的其他应用程序保持适当的解耦（请随时教我保持 Django 应用程序解耦，我很乐意随时/一直了解更多信息）。

我的问题是：**我编写的 get_ absolute_url() 方法正在返回**基于我的视图的相对路径。我认为必须在项目 urls.py 中添加一个特殊的命名视图是错误的，这样我才能在我的应用程序中拥有绝对 url，而且我不知道我做错了什么。因此，如果有人可以帮助我，我将非常感激（并在我释放这个傻瓜时提及你！）

我有一个项目级 urls.py，其中包含另一个基于 URL 模式的 urls.py（名称仅在本示例中是冗长的）：

项目-urls.py

```
urlpatterns = patterns('',
    ('^$', direct_to_template, {'template': 'base.html'}),
    (r'^app', include('project.app.urls')),
) 
```

应用程序 urls.py

```
urlpatterns = patterns('',
    url(r'(?P<slug>[-\w]+)?/?$', 'app.views.home', name='app_home'),
) 
```

现在，在我的模型中，我有这样的东西：

```
class AppModel(models.Model):
    title               = models.CharField(_('title'), max_length=100)
    slug                = models.SlugField(_('slug'), unique=True)

    @permalink
    def get_absolute_url(self):
        return ('app_home', None, {'slug': self.slug}) 
```

当我在模板中调用**{{ AppInstance.get_ absolute_url }}**时，我得到如下信息：

```
/slug-is-here 
```

根据我的 urls.py，这不是绝对的并且是有意义的。我应该改变什么来获得一个真正的绝对网址，同时保持这个应用程序干净并且不要将它与项目耦合得太深？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T01:52:26.077

韦尔普，

事实证明，当我看到这个时：

```
/slug-is-here 
```

我应该仔细看看。真正发生的是：

```
/app-pathslug-is-here 
```

在我的项目 urls.py 中，我的应用程序正则表达式上缺少一个斜杠。

所以是的。让这成为你们所有人的一个教训。

# git - 是否可以信任第三方主机进行闭源/私有源代码管理？

> ID：947798
> 
> 赞同：8
> 
> 时间：2009-06-03T23:16:42.413
> 
> 标签：git, github, version-control, hosting

对于许多公司来说，他们项目的源代码对他们来说非常有价值——源代码被盗可能会付出高昂的代价。在本地网络上严格控制源代码是帮助保护它的一种方法。

但是，在外部托管源代码也有优势，无论是简单地托管在 dreamweaver 上的 subversion 或 git 服务器，还是像 github 或 cvsdude 这样的完整解决方案。

在大多数情况下，员工或其他内部人员有可能访问您公司的完整源代码和历史记录，尽管这种风险可能相对较小。

这些是真正的恐惧，还是公司不应该担心它们，而是利用第三方主机的优势？

目前是否有任何大型成功的公司在第三方源代码管理网站之一上托管他们的私有存储库？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T23:58:59.377

我认为这完全取决于一家公司在多大程度上愿意外包。有很多常见的 IP 工作需要外包。以下是一些，以及知识产权的风险：

*   开发：合约程序员可能对你的IP了解很多
*   托管：您的 Web 主机拥有您的所有代码
*   会计：会计师知道有关您财务的所有详细信息
*   法律：律师了解有关收购、预申请专利等的所有细节。
*   制造：合同制造商拥有与生产您的产品相关的所有知识产权
*   电子邮件：外包电子邮件为您的主机提供了一个包含所有通信的单一数据库
*   电话：您的电话公司可以窥探您的线路

从本质上讲，源代码托管与外包 IP 堆栈的任何其他部分没有什么不同——只是它更新了，所以人们没有时间进行调整。每家公司在外包堆栈的每个部分的舒适度方面都有不同的平衡，但现实是，你外包的每一件事都是有人窃取你的知识产权的机会。归根结底，它归结为找到一个值得信赖的供应商。即使是出了名的偏执的苹果也找到了制造合作伙伴来生产他们的硬件。

IMNSHO 外包源代码托管的原因与公司外包任何东西的原因相同：这不是他们的核心业务。将存储库托管外包一年可能与开发人员 2-3 小时的时间相同；如果他花费的时间超过一年维护存储库的时间，那么您基本上就亏本了。（即使他没有按小时计酬也是如此，因为在他花更多的时间在 Twitter 上花更多的工作时间之前，你只能偷走他这么多的周末）。

免责声明：我在 ProjectLocker 工作，这是一家源代码托管公司。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T23:19:06.400

大概如果公司违反了他们的服务条款并窃取或暴露了您的知识产权，您可以对他们提起法律诉讼吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T23:43:09.317

坦率地说，我认为将贵公司的宝贵代码存储在第三方服务器上没有任何好处，只有潜在的问题......可能会有很多可怕的场景，我什至不会尝试去想象它们。

除了安装和维护例如 SVN 服务器的工作量大大减少外，为此目的使用专用服务器的成本也大大降低，因此我认为没有任何理由不存储您自己的代码。

如果您没有技能或没有钱购买服务器或其他任何东西，您可能会被迫使用第三方，但故意选择此选项......这对我来说是一个明确的 NO-NO。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T23:44:07.753

任何业务关系都需要一定程度的信任。如果您不想自己做，因为这样做可能会更昂贵，您将不得不信任某人，我们一直都在做。

如前所述，您可以通过确保存在严格的保密和责任协议来对冲一些风险，您的律师可以确信扣篮案件可以追回损失。与不受您控制的第三方打交道时，您永远无法消除风险。事实上，大多数公司永远不会同意对问题负责。

如果您无法应对风险或承担风险，您应该简单地在内部进行，而不是在发生某些事情时寻求起诉。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-20T13:47:17.517

也许，但信任可能不是基于任何正式的东西。例如，GitHub 服务条款 ( [https://help.github.com/articles/github-terms-of-service](https://help.github.com/articles/github-terms-of-service) ) 没有提及“私人”、“机密”或“安全”等词，除了

```
GitHub does not warrant that 
(i) the service will meet your specific requirements, 
(ii) the service will be uninterrupted, timely, secure, or error-free,
... 
```

# c++ - Lua / c++ 处理命名数组条目的问题

> ID：947802
> 
> 赞同：0
> 
> 时间：2009-06-03T23:18:46.510
> 
> 标签：c++, lua

我正在尝试编写一些用于与 LUA 交互的 c++ 类，但我对以下内容感到困惑：

在以下示例中：Wherigo.ZCommand 返回一个“Command”对象，zcharacterFisherman.Commands 也是一个 Command 对象数组：

使用以下 LUA 代码，我理解它并且它可以正常工作（luaL_getn 在 zcharacterFisherman.Commands c++ set newindex 函数中返回 3）：

```
zcharacterFisherman.Commands = {
  Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
  Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
  Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
} 
```

但是，当使用以下 LUA 代码定义数组时，语法略有不同，luaL_getn 返回 0。

```
zcharacterFisherman.Commands = {
  Talk = Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
  Talk2 = Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
  Talk3 = Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
} 
```

所有对象都在 c++ 中定义，并且 c++ 对象包含所有对象成员，所以我试图将 LUA 连接到那些 c++ 对象。这足够了吗，还是我需要发布一些代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T21:30:54.250

### 卢亚是正确的。

您的第一个示例正在形成一个表，该表正好包含三个索引为 1、2 和 3 的条目，其中没有一个是明确指定的。在这种情况下`table.maxn()`，`#`运算符和`lua_objlen()`所有人都同意存在三个数组元素。

您的第二个示例正在形成一个表，其中正好包含三个索引为“Talk”、“Talk2”和“Talk3”的条目，所有这些条目都明确指定，但没有一个是整数。在这种情况下， `table.maxn()`，`#`运算符和`lua_objlen()`所有人都同意数组元素为零。

### 为什么这是正确答案？

Lua`table`是一个关联数组，可以将任何类型的值（除了`nil`）映射到任何类型的值（同样，除了`nil`）。Lua 中没有其他通用容器类型，因此表基本上用于所有内容。该实现不是 Lua 规范的一部分，但在实践中，表被索引为哈希表，并且键没有自然排序。

但是，表的一个常见用例是作为一个容器，其行为类似于传统数组。这样的容器具有连续的整数索引，并且可以按顺序迭代。表实现使得这对于从 开始的整数键特别有效`1`。表中的这些条目在物理上分配为一个连续的数组，并且键既不散列也不存储。这节省了分配开销和根本不存储某些键的存储空间。它还节省了运行时间，因为访问是通过直接计算而不是通过计算哈希和验证匹配值来实现的。

由于数组只是表，因此表初始化程序语法旨在使这种情况变得简单明了，并支持其他常见用例，其中键是恰好是有效标识符的字符串。

### Lua 5.1 与 Lua 5.0

在当前的 Lua 版本（5.1.4，但所有 5.1 版本中都是如此）中，Lua 5.0 函数`table.getn()`、`table.setn()`、`luaL_getn()`、 和`luaL_setn()`都已[弃用](http://www.lua.org/manual/5.1/manual.html#7)，因为通常使用数组的表字段`n`来指示其数组长度。该`table.getn()`函数由`#`运算符替换，`luaL_getn()`并由`lua_objlen()`. `setn()`由于 Lua 现在在后台管理数组大小，因此没有等效的函数。

该`#`运算符被定义在一个表上以返回一个整数，以便通过下一个更大的整数索引该表返回`nil`。对于空数组（例如`a = {}`），它返回 0，因为`a[1] == nil`. 对于普通数组，它返回正在使用的最大索引。但是，如果一个数组有空洞（缺少元素），那么它可以返回任何空洞之前的索引或最后一个正在使用的索引。如果需要实际使用的最大整数索引，则`table.maxn()`可以使用新函数，但它必须遍历所有表条目以找到最大值，因此只能在 using `#`can't 时使用。

这导致了一个现在常见的向数组添加元素的习惯用法：`a[#a+1] = "some new value"`. 现在经常推荐使用此成语来代替`table.insert()`扩展表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-04T00:05:02.393

luaL_getn 用于获取Lua中*数组的最高数值元素。*数组是只有整数索引的表。当你在 Lua 中定义一个表（第一个例子）而不显式设置索引时，你会得到一个包含元素 1、2 和 3 的数组。自然，luaL_getn 在这里返回一个 3。luaL_getn 未定义为返回表中元素的数量，它被定义为返回表中的最高数字索引（参见[http://www.lua.org/manual/5.1/manual.html#pdf-table.最大](http://www.lua.org/manual/5.1/manual.html#pdf-table.maxn)）

第二个例子没有使用数字索引，而且这个表不是 Lua 数组——它更像是一个哈希表。由于 luaL_getn 仅适用于真正的数组，因此您不会期望它在这里工作。

不幸的是，没有简单的方法来获取表中的元素数量（lua_objlen 解决了一个相关问题，但没有解决这个问题）。唯一的方法是：

1.  始终使用数组表示法。永远不要使用其他任何东西作为表中的键。通过这种方式，您将获得很多加速。
2.  当您想知道表格的大小时，遍历您的表格并计算元素的数量。该语言不提供获取完整表大小的单行方法，因为通用表是使用散列实现的，并且不跟踪它们的元素计数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T00:12:41.207

Lua 表结合了哈希表和标准数组。

您的第一个示例等效于：

```
zcharacterFisherman.Commands = {
  [1] = Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
  [2] = Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
  [3] = Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
} 
```

getn 帮助您找到一个空的数字条目。如果 t[1]==nil 那么很可能 table.getn(t) == 0。在第二个示例中，您没有分配 zcharacterFisherman.Commands[1]，这就是您得到 0 的原因。

```
zcharacterFisherman.Commands = {
  [1] = Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
  [2] = Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
  [3] = Wherigo.ZCommand{a="Talk", b=false, d=true, c="Nothing available"},
}
zcharacterFisherman.Commands[1]=nil
print(table.getn(zcharacterFisherman.Commands)) 
```

此代码将打印 0（或可能是数字 >=3）

一般来说，如果不迭代它们（例如使用pairs()），就无法直接获取表的哈希表部分中的元素数量

# c# - 创建导入的 MEF 零件的多个实例

> ID：947807
> 
> 赞同：11
> 
> 时间：2009-06-03T23:19:42.280
> 
> 标签：c#, .net, mef

目前我的 WPF 应用程序导入这样的部分

```
[Import(typeof(ILedPanel)]
public ILedPanel Panel { get; set; } 
```

但这给了实现 ILedPanel 的类的单一实例。我真正想做的是能够创建我需要的尽可能多的实例。请注意，在任何给定时间，软件都只包含一个用于 ILedPanel 的导出。

（如果我使用带有 List 的导入，它为每个实现 ILedPanel 的类提供一个实例）

有什么建议么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-04T11:06:08.350

我不确定这是否是 Nicolas 所指的，但您可以导入工厂类而不是实例类，如下所示：

```
[Import(typeof(ILedPanelFactory)]
public ILedPanelFactory PanelFactory { get; set; } 
```

...然后在您的代码中...

```
ILedPanel panel = PanelFactory.BuildPanel(); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-11-20T12:37:17.670

所有其他答案都很老了，所以他们没有提到 MEF 中一个相对较新的功能，称为[`ExportFactory`](http://msdn.microsoft.com/en-us/library/ff382807(v=vs.110).aspx). 这个泛型类允许您在需要时导入`ExportFactory<ILedPanel>`和创建任意数量的实例，因此您的代码如下所示：

```
[Import(typeof(ILedPanel)]
public ExportFactory<ILedPanel> PanelFactory { get; set; }

public ILedPanel CreateNewLedPanelInstance()
{
    return PanelFactory.CreateExport().Value;
} 
```

此方法还满足创建部件所具有的任何导入。[您可以在此处](https://mef.codeplex.com/wikipage?title=PartCreator)阅读有关使用`ExportFactory`该类的更多信息。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-03T23:39:45.860

今天在 MEF 中没有对此的“内置”支持，但在恢复到服务定位器之前，您可能会在这里找到一些灵感：http: [//blogs.msdn.com/nblumhardt/archive/2008/12/27/container -托管应用程序设计-前奏-哪里-容器-belong.aspx](http://blogs.msdn.com/nblumhardt/archive/2008/12/27/container-managed-application-design-prelude-where-does-the-container-belong.aspx)

基本思想是将容器“导入”到需要进行动态实例化的组件中。

我们正在探索对这种情况的更直接支持。

缺口

**更新：** MEF 现在对此有实验性支持。有关更多信息，请参阅[此博客文章](http://blogs.msdn.com/nblumhardt/archive/2009/08/28/dynamic-part-instantiation-in-mef.aspx)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-24T13:32:47.817

除非我误解了这个问题，否则它看起来可以通过简单地使用 CreationPolicy.NonShared 来解决。

这假设声明面板的代码存在于您想要面板的任何地方。您将在具有此声明（导入）的每个类的每个实例中获得一个新的 ILedPanel 实例。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-10T02:22:30.220

查看 MEF 附带的形状游戏示例，有 ShapeFactory 类：

```
[Export]
public class ShapeFactory
{
    private readonly Random random = new Random((int)DateTime.Now.Ticks);

    [Import]
    private ICompositionService CompositionService { get; set; }

    public IShape GetRandomShape()
    {
        var shapeRetriever = new ShapeRetriever();

        CompositionService.SatisfyImports(shapeRetriever);

        int randomIndex = random.Next(shapeRetriever.PossibleShapes.Length);

        return shapeRetriever.PossibleShapes[randomIndex].GetExportedObject();
    }

    private class ShapeRetriever
    {
        [ImportMany(RequiredCreationPolicy = CreationPolicy.NonShared)]
        public Export<IShape, IShapeMetadata>[] PossibleShapes { get; set; }
    }
} 
```

这演示了“按需”创建随机形状实例......我认为在你的场景中你可以在不选择随机实现的情况下做类似的事情，因为你建议只有一个 ILedPanel 实现注册。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T23:24:54.580

我认为你的意思是你想在这种情况下使用 MEF，比如服务定位器，而不是依赖注入容器。尝试查看 ValueResolver 的示例

# python - 如何保存 Python 交互式会话？

> ID：947810
> 
> 赞同：443
> 
> 时间：2009-06-03T23:21:02.667
> 
> 标签：python, shell, read-eval-print-loop, interactive-session

我发现自己经常使用 Python 的解释器来处理数据库、文件等——基本上是对半结构化数据进行大量手动格式化。我没有像我想的那样经常正确地保存和清理有用的位。有没有办法将我的输入保存到 shell 中（db 连接、变量分配、少量 for 循环和一些逻辑）——交互式会话的一些历史记录？如果我使用类似的东西，`script`我会得到太多的标准输出噪音。我真的不需要腌制所有的对象——尽管如果有一个解决方案可以做到这一点，那就没问题了。理想情况下，我只剩下一个脚本，该脚本作为我以交互方式创建的脚本运行，我可以删除我不需要的位。有没有这样的包，或者DIY方法？

* * *

## 回答 #1

> 赞同：436
> 
> 时间：2009-06-03T23:34:21.330

[如果您喜欢使用交互式会话， IPython](https://ipython.org/)非常有用。例如，对于您的用例，有[一个`%save`魔术命令](http://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-save)，您只需输入`%save my_useful_session 10-20 23`以将输入的第 10 行到第 20 行和第 23 行保存到`my_useful_session.py`（为了帮助解决这个问题，每一行都以它的编号为前缀）。

此外，文档指出：

> 此函数对输入范围使用与[%history](http://ipython.readthedocs.io/en/5.x/interactive/magics.html#magic-history)相同的语法，然后将行保存到您指定的文件名。

例如，这允许引用较旧的会话，例如

```
%save current_session ~0/
%save previous_session ~1/ 
```

查看[演示页面上的视频](https://ipython.org/presentation.html)以快速了解这些功能。

* * *

## 回答 #2

> 赞同：193
> 
> 时间：2012-03-15T13:06:35.877

来自 Andrew Jones 的网站（[存档](https://web.archive.org/web/20130218140009/http://www.andrewhjon.es:80/save-interactive-python-session-history)）：

```
import readline
readline.write_history_file('/home/ahj/history') 
```

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2009-06-03T23:23:20.947

有[办法](http://docs.python.org/tutorial/interactive.html?highlight=atexit)做到这一点。将文件存储在`~/.pystartup`...

```
# Add auto-completion and a stored history file of commands to your Python
# interactive interpreter. Requires Python 2.0+, readline. Autocomplete is
# bound to the Esc key by default (you can change it - see readline docs).
#
# Store the file in ~/.pystartup, and set an environment variable to point
# to it:  "export PYTHONSTARTUP=/home/user/.pystartup" in bash.
#
# Note that PYTHONSTARTUP does *not* expand "~", so you have to put in the
# full path to your home directory.

import atexit
import os
import readline
import rlcompleter

historyPath = os.path.expanduser("~/.pyhistory")

def save_history(historyPath=historyPath):
    import readline
    readline.write_history_file(historyPath)

if os.path.exists(historyPath):
    readline.read_history_file(historyPath)

atexit.register(save_history)
del os, atexit, readline, rlcompleter, save_history, historyPath 
```

然后`PYTHONSTARTUP`在你的 shell 中设置环境变量（例如 in `~/.bashrc`）：

```
export PYTHONSTARTUP=$HOME/.pystartup 
```

您还可以添加它以免费获得自动完成功能：

```
readline.parse_and_bind('tab: complete') 
```

请注意，这只适用于 *nix 系统。因为 readline 仅在 Unix 平台上可用。

* * *

## 回答 #4

> 赞同：77
> 
> 时间：2015-04-30T17:56:37.033

如果您使用的是[IPython](http://ipython.org/) ，您可以使用带有*-f*参数 pe的魔术函数*[%history将您之前的所有命令保存到一个文件中：](http://ipython.org/ipython-doc/2/api/generated/IPython.core.magics.history.html#IPython.core.magics.history.HistoryMagics)*

 *```
%history -f /tmp/history.py 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2014-10-30T21:12:47.807

安装[Ipython](http://ipython.org/)并通过运行以下命令打开 Ipython 会话后：

```
ipython 
```

从您的命令行，只需运行以下 Ipython 'magic' 命令即可自动记录整个 Ipython 会话：

```
%logstart 
```

这将创建一个唯一命名的 .py 文件并存储您的会话，以供以后用作交互式 Ipython 会话或在您选择的脚本中使用。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-06-04T00:28:21.567

此外，[reinteract](http://blog.fishsoup.net/2007/11/10/reinteract-better-interactive-python/)为您提供了一个类似于笔记本的 Python 会话界面。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-06-04T01:03:36.813

除了 IPython，类似的实用程序[bpython](http://bpython-interpreter.org/)具有“将您输入的代码保存到文件”功能

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2014-08-22T12:47:02.743

我不得不努力寻找答案，我对 iPython 环境非常陌生。

这将起作用

如果您的 iPython 会话看起来像这样

```
In [1] : import numpy as np
....
In [135]: counter=collections.Counter(mapusercluster[3])
In [136]: counter
Out[136]: Counter({2: 700, 0: 351, 1: 233}) 
```

你想保存从 1 到 135 的行，然后在同一个 ipython 会话中使用这个命令

```
In [137]: %save test.py 1-135 
```

这会将所有 python 语句保存在当前目录（您启动 ipython 的位置）中的 test.py 文件中。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-02-06T03:48:30.647

有 %history 魔法打印和保存输入历史（以及可选的输出）。

要将当前会话存储到名为的文件中`my_history.py`：

```
>>> %hist -f my_history.py 
```

历史 IPython 存储您输入的命令和它产生的结果。您可以使用向上和向下箭头键轻松浏览以前的命令，或者以更复杂的方式访问您的历史记录。

您可以使用 %history 魔术函数来检查过去的输入和输出。以前会话的输入历史保存在数据库中，IPython 可以配置为保存输出历史。

其他几个魔术函数可以使用您的输入历史记录，包括 %edit、%rerun、%recall、%macro、%save 和 %pastebin。您可以使用标准格式来引用行：

```
%pastebin 3 18-20 ~1/1-5 
```

这将占用当前会话的第 3 行和第 18 到 20 行，以及前一会话的第 1-5 行。

查看 % 历史记录？对于 Docstring 和更多示例。

此外，一定要探索[%store 魔术](http://ipython.org/ipython-doc/rel-0.12/config/extensions/storemagic.html)的功能，以便在 IPython 中实现变量的轻量级持久性。

> 在 IPython 的数据库中存储变量、别名和宏。

```
d = {'a': 1, 'b': 2}
%store d  # stores the variable
del d

%store -r d  # Refresh the variable from IPython's database.
>>> d
{'a': 1, 'b': 2} 
```

要在启动时自动恢复存储的变量，`c.StoreMagic.autorestore = True`请在 ipython_config.py 中指定。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-05-06T21:25:47.880

只是把另一个建议放在碗里： [Spyder](https://github.com/spyder-ide/spyder)

[![在此处输入图像描述](https://i.stack.imgur.com/kh91E.png)](https://i.stack.imgur.com/kh91E.png)

它有*历史日志*和*变量资源管理*器。如果您使用过 MatLab，那么您会看到相似之处。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-04-19T19:43:32.623

该`%history`命令很棒，但不幸的是，它不会让您将 %paste 的内容保存到 sesh 中。要做到这一点，我认为你必须`%logstart` [在一开始](https://stackoverflow.com/a/31749395/4549682)就这样做（尽管我还没有确认这是否有效）。

我喜欢做的是

`%history -o -n -p -f filename.txt`

这将在每个输入之前保存输出、行号和“>>>”（o、n 和 p 选项）。[在此处](http://ipython.org/ipython-doc/2/api/generated/IPython.core.magics.history.html#IPython.core.magics.history.HistoryMagics)查看 %history 的文档。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-05-14T14:45:52.523

就 Linux 而言，可以使用`script`命令来记录整个会话。它是`util-linux`软件包的一部分，因此应该在大多数 Linux 系统上。您可以创建将调用`script -c python`并将保存到`typescript`文件中的别名或函数。例如，这里是一个此类文件的重印本。

```
$ cat typescript                                                                                                      
Script started on Sat 14 May 2016 08:30:08 AM MDT
Python 2.7.6 (default, Jun 22 2015, 17:58:13) 
[GCC 4.8.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> print 'Hello Pythonic World'
Hello Pythonic World
>>> 

Script done on Sat 14 May 2016 08:30:42 AM MDT 
```

这里的小缺点是`script`记录所有内容，甚至换行，每当你点击退格等。所以你可能想用它`col`来清理输出（见[这篇关于 Unix&Linux Stackexchange 的帖子](https://unix.stackexchange.com/q/86901/85039)）。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-06-26T16:03:33.993

还有另一种选择——pyslice。在“wxpython 2.8 docs demos and tools”中，有一个名为“pyslices”的开源程序。

你可以像编辑器一样使用它，它也支持像控制台一样使用——像交互式解释器一样执行每一行，并立即回显。

当然，所有的代码块和每个块的结果都会自动记录到一个txt文件中。

结果记录在相应的代码块后面。很方便。

![pyslices概述](https://i.stack.imgur.com/VsJ1w.png)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-04-26T14:46:37.153

如果您使用**bpython**，您的所有命令历史记录默认保存到`~/.pythonhist`.

要保存命令以供以后重用，您可以将它们复制到 python 脚本文件：

```
$ cp ~/.pythonhist mycommands.py 
```

然后编辑该文件以清理它[并将其放在 Python 路径下](http://djangotricks.blogspot.com/2008/09/note-on-python-paths.html)（全局或虚拟环境的站点包、当前目录、在 *.pth 中提及或其他方式）。

要将命令包含到您的 shell 中，只需从保存的文件中导入它们：

```
>>> from mycommands import * 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-07-17T07:22:22.460

在[IPython](https://ipython.org/)中，我首先使用

```
In [2]: %hist 
```

查看我过去的代码。我选择要保存的块，然后`my_file.py`使用`%%file`魔法（缩写[`%%writefile`](https://ipython.org/ipython-doc/dev/interactive/magics.html#cellmagic-writefile)）将其粘贴到文件中

```
In [3]: %%file my_file.py
   ...: # paste code here 
   ...:  
   ...: 
```

最后击中返回两次。

要附加到文件，请使用选项`-a`: `%%file -a my_file.py`。

如果需要，我可以使用感叹号在底层命令行中列出、编辑等文件

```
In [5]: !ls -l my_file.py
In [6]: !vi my_file.py 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-07-26T15:14:54.853

一些评论询问如何一次保存所有 IPython 输入。对于 IPython 中的 %save 魔法，您可以如下所示以编程方式保存所有命令，以避免出现提示消息并避免指定输入数字。currentLine = len(In)-1 %save -f my_session 1-$currentLine

该`-f`选项用于强制文件替换，并`len(IN)-1`在 IPython 中显示当前输入提示，允许您以编程方式保存整个会话。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-12-23T16:09:11.777

对于那些使用`spacemacs`, 以及`ipython`附带的`python-layer`, save magic 会产生很多不需要的输出，因为在后台工作的恒定自动完成命令，例如：

```
len(all_suffixes)
';'.join(__PYTHON_EL_get_completions('''len'''))
';'.join(__PYTHON_EL_get_completions('''all_substa'''))
len(all_substantives_w_suffixes)
';'.join(__PYTHON_EL_get_completions('''len'''))
';'.join(__PYTHON_EL_get_completions('''all'''))
';'.join(__PYTHON_EL_get_completions('''all_'''))
';'.join(__PYTHON_EL_get_completions('''all_w'''))
';'.join(__PYTHON_EL_get_completions('''all_wo'''))
';'.join(__PYTHON_EL_get_completions('''all_wor'''))
';'.join(__PYTHON_EL_get_completions('''all_word'''))
';'.join(__PYTHON_EL_get_completions('''all_words'''))
len(all_words_w_logograms)
len(all_verbs) 
```

为避免这种情况，只需像通常保存任何其他缓冲区一样保存 ipython 缓冲区：`spc f s`

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-06-08T01:00:49.200

我想建议另一种通过 linux 上的 tmux 维护 python 会话的方法。您运行 tmux，将您自己附加到您打开的会话（如果直接打开后未附加）。执行 python 并做任何你正在做的事情。然后从会话中分离。从 tmux 会话中分离不会关闭会话。会议保持开放。

**这种方法的优点：** 您可以从任何其他设备附加到此会话（如果您可以 ssh 您的电脑）

**此方法的缺点：** 此方法不会放弃打开的 python 会话使用的资源，直到您实际存在 python 解释器。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-02-06T07:44:47.687

**在 XUbuntu 上保存输入和输出**：

1.  在 XWindows 中，从 Xfce 终端应用程序运行 iPython
2.  单击`Terminal`顶部菜单栏并`save contents`在下拉菜单中查找

我发现这可以保存输入和输出，一直到我打开终端时。这不是 ipython 特定的，并且可以与 ssh 会话或从终端窗口运行的其他任务一起使用。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2020-08-08T05:38:02.483

您可以使用内置函数 open：我在需要存储一些历史记录（包括计算器等）的所有程序中都使用它，例如：

```
#gk-test.py or anything else would do
try: # use the try loop only if you haven't created the history file outside program
    username = open("history.txt").readline().strip("\n")
    user_age = open("history.txt").readlines()[1].strip("\n")
except FileNotFoundError:
    username = input("Enter Username: ")
    user_age = input("Enter User's Age: ")
    open("history.txt", "w").write(f"{username}\n{user_age}")
#Rest of the code is secret! try it your own! 
```

我要感谢所有喜欢我评论的人！谢谢您阅读此篇！

# html - Colspan 不适用于宽度设置？(IE7)

> ID：947815
> 
> 赞同：5
> 
> 时间：2009-06-03T23:22:11.463
> 
> 标签：html, html-table

当我使用固定宽度（IE 7）时，我无法让 colspan 工作？为什么？！

示例代码：

 `````
<html>
  <head>
    <style>
    .inputGroup td
    { width:250px; }    
    </style>
  </head>
<body>
<table class="inputGroup">
  <tr>
    <td>cell1</td>
    <td>cell2</td>
  </tr>
  <tr>
    <td colspan="2">This should span two columns but it doesnt</td>
  </tr>
  <tr>
    <td>cell1</td>
    <td>cell2</td>
  </tr>
</table>
</body>
</html> 
````  `帮助任何人？:(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T23:27:19.130

确实如此，但是您限制了宽度。如果需要，请尝试创建另一个名为 '.doubleSpanInputGroup' 的类或宽度为 500 的类，并将该类设置到跨越列上。

例如。

```
<html>
  <head>
    <style>
    .inputGroup td
    { width:250px; }   
    .inputGroup td.doubleInputGroup
    { width:500px; } 
    </style>
  </head>
<body>
<table class="inputGroup">
  <tr>
    <td>cell1</td>
    <td>cell2</td>
  </tr>
  <tr>
    <td colspan="2" class="doubleInputGroup">This should span two columns but it doesnt</td>
  </tr>
  <tr>
    <td>cell1</td>
    <td>cell2</td>
  </tr>
</table>
</body>
</html> 
```

编辑：使新风格更具层次感

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T23:31:43.940

尝试使规则应用于`tr`而不是`td`使宽度为 500px，如下所示：

```
.inputGroup tr { width: 500px; } 
```

您遇到的问题是因为您设置了`td`最多 250px 宽的限制，所以浏览器只是按照您的说明进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T18:32:52.330

一般情况下：

```
table tr:first-child td:first-child{ width:86px; } 
```

如果这是唯一的宽度，所有第一列都采用这个宽度，并且 ie7 中的 colspan 将起作用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-11T16:36:29.163

我尝试将 colspan 单元格的宽度设置为自动，似乎在 IE7/8/9 中工作正常

```
.yourColSpanTD { width: auto !important; } 
```

# javascript - Jquery 在 Firefox 但不能在 Internet Explorer 中工作

> ID：947823
> 
> 赞同：4
> 
> 时间：2009-06-03T23:24:37.840
> 
> 标签：javascript, jquery, internet-explorer, firefox

我在此页面上使用 jQuery Cycle 插件 ( [malsup.com/jquery/cycle/)：http://artandculturecenter.org](http://artandculturecenter.org)

它在 Firefox 和其他浏览器中按预期工作，但在我尝试过的任何版本的 IE 中都没有——浏览器显示所有 div，而不是循环浏览它们。我假设这是因为 jQuery 根本无法工作/加载，因为 IE 不喜欢某种语法、版本不兼容等。

但我不知道，因为我对 javascript 的工作原理有点无知。任何可以向我指出解决此问题的方法的人将不胜感激！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T23:47:01.650

在插件选项列表的末尾有一个额外的逗号。这不是 python ;-)

Firefox 对这类事情非常宽容，而 IE 则不然。删除它，它应该摆脱杀死你的 js 的错误。

```
$("#slideshow").after('<div id="slideshownav">').cycle({ 
        fx: 'fade', 
        timeout: 9000, 
        speed: 1250, 
        pause:  1,
        pager: '#slideshownav'
    }); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-20T02:57:23.137

一个对我有很大帮助的工具是[JSLint](http://www.jslint.com/)。帮助您找到缺少的逗号等。试一试。

[请参阅我在此答案](https://stackoverflow.com/questions/1149172/how-do-you-stay-on-top-of-a-complex-javascript-project/1149246#1149246)中编写的其他一些工具和提示。

希望这些提示能有所帮助。

# python - Python Opencv Ubuntu 没有创建 Windows

> ID：947829
> 
> 赞同：1
> 
> 时间：2009-06-03T23:27:53.373
> 
> 标签：python, macos, ubuntu, opencv

我在 Ubuntu 上运行 opencv 有一个奇怪的问题。我从 apt 源安装了 OpenCV。大多数示例都可以正常工作。

但是在我使用 Mac OS 的程序中，没有创建任何窗口。

以下代码在我的 Mac 上显示了一个窗口和一个图像，但在我的 Ubuntu 驱动的机器上没有

```
import time
from opencv import highgui

if __name__ == '__main__':

    highgui.cvNamedWindow('Image', highgui.CV_WINDOW_AUTOSIZE)
    highgui.cvMoveWindow('Image', 10, 40)
    image = highgui.cvLoadImage("verena.jpg", 1)
    highgui.cvShowImage('Image', image)
    time.sleep(3) 
```

代码取自实际在两台机器上运行的示例之一。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T00:35:26.997

如果我在创建窗口之前添加一个 highgui.cvStartWindowThread() 调用，则该代码有效。

现在下一个问题是为什么程序可以在没有启动windowThread 的情况下在mac os 上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T19:55:29.013

对于新绑定，我的意思是`cv2`. 代码是`cv2.startWindowThread()`

# c# - 用于生成层次结构的 C# 算法

> ID：947831
> 
> 赞同：21
> 
> 时间：2009-06-03T23:28:07.943
> 
> 标签：c#, algorithm, hierarchy, hierarchical-data

我有一个看起来像这样的文本文件：

```
{ Id = 1, ParentId = 0, Position = 0, Title = "root" }
{ Id = 2, ParentId = 1, Position = 0, Title = "child 1" }
{ Id = 3, ParentId = 1, Position = 1, Title = "child 2" }
{ Id = 4, ParentId = 1, Position = 2, Title = "child 3" }
{ Id = 5, ParentId = 4, Position = 0, Title = "grandchild 1" } 
```

我正在寻找一个通用的 C# 算法，它将从中创建一个对象层次结构。如果您愿意，可以使用“层次化”功能将此数据转换为对象层次结构。

有任何想法吗？

*编辑*我已经将文件解析为 .NET 对象：

```
class Node
{
    public int Id { get; }
    public int ParentId { get; }
    public int Position { get; }
    public string Title { get; }
} 
```

现在我需要将对象实际排列到对象图中。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-04T17:01:35.633

非常感谢 Jon 和 mquander——你们给了我足够的信息来帮助我以一种适当的、通用的方式解决这个问题。这是我的解决方案，一个将对象转换为层次结构形式的通用扩展方法：

```
public static IEnumerable<Node<T>> Hierarchize<T, TKey, TOrderKey>(
    this IEnumerable<T> elements, 
    TKey topMostKey, 
    Func<T, TKey> keySelector, 
    Func<T, TKey> parentKeySelector, 
    Func<T, TOrderKey> orderingKeySelector)
{
    var families = elements.ToLookup(parentKeySelector);
    var childrenFetcher = default(Func<TKey, IEnumerable<Node<T>>>);
    childrenFetcher = parentId => families[parentId]
        .OrderBy(orderingKeySelector)
        .Select(x => new Node<T>(x, childrenFetcher(keySelector(x))));

    return childrenFetcher(topMostKey);
} 
```

利用这个小节点类：

```
public class Node<T>
{
    public T Value { get; private set; }
    public IList<Node<T>> Children { get; private set; }

    public Node(T value, IEnumerable<Node<T>> children)
    {
        this.Value = value;
        this.Children = new List<Node<T>>(children);
    }
} 
```

它足够通用，可以解决各种问题，包括我的文本文件问题。漂亮！

****更新****：这是您使用它的方式：

```
// Given some example data:
var items = new[] 
{
   new Foo() 
   {
      Id = 1,
      ParentId = -1, // Indicates no parent
      Position = 0
   },
   new Foo() 
   {
      Id = 2,
      ParentId = 1,
      Position = 0
   },
   new Foo() 
   {
      Id = 3,
      ParentId = 1,
      Position = 1
   }
};

// Turn it into a hierarchy! 
// We'll get back a list of Node<T> containing the root nodes.
// Each node will have a list of child nodes.
var hierarchy = items.Hierarchize(
    -1, // The "root level" key. We're using -1 to indicate root level.
    f => f.Id, // The ID property on your object
    f => f.ParentId, // The property on your object that points to its parent
    f => f.Position, // The property on your object that specifies the order within its parent
    ); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T23:44:05.960

嗯...我不太明白它是如何工作的。2 和 5 怎么会有 parent=1，position=0？5 应该有父 2、3 还是 4？

好的，这个新版本会遍历所有节点三遍：

*   加载所有节点并将它们放入地图
*   将每个节点与其父节点关联
*   按位置对每个节点的子节点进行排序

它没有很好的封装，很好的错误检查等 - 但它有效。

```
using System;
using System.Collections.Generic;
using System.IO;

public class Node
{
    private static readonly char[] Braces = "{}".ToCharArray();
    private static readonly char[] StringTrim = "\" ".ToCharArray();

    public Node Parent { get; set; }
    public int ParentId { get; private set; }
    public int Id { get; private set; }
    public string Title { get; private set; }
    public int Position { get; private set; }
    private readonly List<Node> children = new List<Node>();
    public List<Node> Children { get { return children; } }

    public static Node FromLine(string line)
    {
        Node node = new Node();
        line = line.Trim(Braces);
        string[] bits = line.Split(',');
        foreach (string bit in bits)
        {
            string[] keyValue = bit.Split('=');
            string key = keyValue[0].Trim();
            string value = keyValue[1].Trim();
            switch (key)
            {
                case "Id":
                    node.Id = int.Parse(value);
                    break;
                case "ParentId":
                    node.ParentId = int.Parse(value);
                    break;
                case "Position":
                    node.Position = int.Parse(value);
                    break;
                case "Title":
                    node.Title = value.Trim(StringTrim);
                    break;
                default:
                    throw new ArgumentException("Bad line: " + line);
            }
        }
        return node;
    }

    public void Dump()
    {
        int depth = 0;
        Node node = this;
        while (node.Parent != null)
        {
            depth++;
            node = node.Parent;
        }
        Console.WriteLine(new string(' ', depth * 2) + Title);
        foreach (Node child in Children)
        {
            child.Dump();
        }
    }
}

class Test
{       
    static void Main(string[] args)
    {
        var dictionary = new Dictionary<int, Node>();

        using (TextReader reader = File.OpenText("test.txt"))
        {
            string line;
            while ((line = reader.ReadLine()) != null)
            {
                Node node = Node.FromLine(line);
                dictionary[node.Id] = node;
            }
        }
        foreach (Node node in dictionary.Values)
        {
            if (node.ParentId != 0)
            {
                node.Parent = dictionary[node.ParentId];
                node.Parent.Children.Add(node);
            }
        }

        foreach (Node node in dictionary.Values)
        {
            node.Children.Sort((n1, n2) =>
                               n1.Position.CompareTo(n2.Position));
        }

        Node root = dictionary[1];
        root.Dump();
    }
} 
```

示例文本文件：

```
{ Id = 5, ParentId = 4, Position = 0, Title = "grandchild 1" }
{ Id = 2, ParentId = 1, Position = 0, Title = "child 1" }
{ Id = 4, ParentId = 1, Position = 2, Title = "child 3" }
{ Id = 3, ParentId = 1, Position = 1, Title = "child 2" }
{ Id = 1, ParentId = 0, Position = 0, Title = "root" } 
```

输出：

```
root
  child 1
  child 2
  child 3
    grandchild 1 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T23:45:13.243

解析完文件后，您可以关注此[博客](http://weblogs.asp.net/okloeten/archive/2006/07/09/Hierarchical-Linq-Queries.aspx)，了解如何使用 LINQ 将对象组装成层次结构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T23:58:29.987

```
class Node {
    public int Id { get;set;  }
    public int ParentId { get;set;  }
    public int Position { get;set;  }
    public string Title { get;set;  }
    public IEnumerable<Node> Children { get; set; }

    public override string ToString() { return ToString(0); }
    public string ToString(int depth) {
        return "\n" + new string(' ', depth * 2) + Title + (
            Children.Count() == 0 ? "" :
            string.Join("", Children
                .Select(node => node.ToString(depth + 1))
                .ToArray()
            );
    }
}
class Program {
    static void Main(string[] args) {
        var data = new[] {
            new Node{ Id = 1, ParentId = 0, Position = 0, Title = "root" },
            new Node{ Id = 2, ParentId = 1, Position = 0, Title = "child 1" },
            new Node{ Id = 3, ParentId = 1, Position = 1, Title = "child 2" },
            new Node{ Id = 4, ParentId = 1, Position = 2, Title = "child 3" },
            new Node{ Id = 5, ParentId = 3, Position = 0, Title = "grandchild 1" }
        };
        Func<Node, Node> transform = null;
        transform = node => new Node {
            Title = node.Title,
            Id = node.Id,
            ParentId = node.ParentId,
            Position = node.Position,
            Children = (
                from child in data
                where child.ParentId == node.Id
                orderby child.Position
                select transform(child))
        };
        Console.WriteLine(transform(data[0]));
    }
} 
```

结果：

```
root
  child 1
  child 2
    grandchild 1
  child 3 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T23:58:45.917

我假设您的示例错误地为对象 #5 提供了错误的父 ID。这应该涵盖它。注意事项：假设“最顶层”节点的父 ID 始终为零。忽略最终不是从最顶层节点下降的任何节点。如果出现重复的 ID，行为会很奇怪。

```
public class FlatObj
{
    public int Id;
    public int ParentId;
    public int Position;
    public string Title;
}

public class Node
{
    public int ID;
    public string Title;
    public IList<Node> Children;

    public Node(FlatObject baseObject, IList<Node> children)
    {
        this.ID = baseObject.Id;
        this.Title = baseObject.Title;
        this.Children = children;
    }
}

public static Node CreateHierarchy(IEnumerable<FlatObject> objects)
{
    var families = objects.ToLookup(x => x.ParentId);
    var topmost = families[0].Single();

    Func<int, IList<Node>> Children = null;

    Children = (parentID) => families[parentID]
        .OrderBy(x => x.Position)
        .Select(x => new Node(x, Children(x.Id))).ToList();

    return new Node(topmost, Children(topmost.Id));
}

public static void Test()
{
    List<FlatObj> objects = new List<FlatObj> {
    new FlatObj { Id = 1, ParentId = 0, Position = 0, Title = "root" },
    new FlatObj { Id = 2, ParentId = 1, Position = 0, Title = "child 1" },
    new FlatObj { Id = 3, ParentId = 1, Position = 1, Title = "child 2" },
    new FlatObj { Id = 4, ParentId = 1, Position = 2, Title = "child 3" },
    new FlatObj { Id = 5, ParentId = 2, Position = 0, Title = "grandchild" }};

    var nodes = CreateHierarchy(objects);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T23:38:06.940

你确定最后一行的 ParentID 是 1 吗？标题说孙子，但如果我没看错的话，它会是“根”的孩子。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-04T03:04:39.153

这是@baran 要求的示例：

```
var lHierarchicalMenuItems = lMenuItemsFromDB.Hierarchize(0, aItem => aItem.Id, aItem => aItem.ParentId, aItem => aItem.Position); 
```

# iphone - iPhone：通过 Internet 连接到数据库？

> ID：947835
> 
> 赞同：3
> 
> 时间：2009-06-03T23:28:57.490
> 
> 标签：iphone, mysql, database, oracle

我一直在与某人谈论 iPhone 开发合同演出的可能性。在这一点上，我真正知道的是，有一家公司想要制作一款能够访问其内部数据库的 iPhone 应用程序。我不确定数据库类型是什么（Oracle、MySQL 等）。

我想知道数据库类型是 Oracle 还是 MySQL，是否有很大的学习曲线可以通过 Internet 连接到其中一个？

如果真的很痛苦，我可能会在接受合同之前做更多的研究。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-03T23:35:21.780

我建议不要直接从 iPhone 应用程序访问数据库。

通常，您会创建一个访问数据库的 Web 服务，然后从 iPhone 应用程序使用该 Web 服务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T12:06:28.620

创建网络服务。这使您可以使 iphone 应用程序更像是一个瘦客户端。让应用程序将命令推送到 Web 服务以进行处理并与数据库交互，仅返回应用程序所需的数据。

此选项更适合应用程序、数据库和客户的安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T23:33:13.127

您可以像在本地一样轻松地通过 Internet 执行连接，但是如果数据库接受来自任何远程 IP 地址的通信，您将打开数据库以遭受攻击。通常，您只需通过打开的套接字通过开放端口连接到服务器的远程 IP 地址，MySQL 的默认端口是 3306。

我一般建议不要使用这种系统，除非出于某些关键原因，他们希望将内部数据库暴露给世界黑客社区。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T23:38:40.450

我正在做的是使用[Sinatra](http://sinatrarb.com)创建一个 Web 服务来访问在线数据库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-18T01:54:56.540

2009 年的那些答案现在大多已经过时了。

[http://ODBCrouter.com/ipad](http://ODBCrouter.com/ipad)（新）具有 XCode 客户端 ODBC 库、头文件和多线程 Objective C 对象，可让您的应用程序将 SQL 发送到服务器端 ODBC 驱动程序并返回二进制结果！这减少了停止和单独维护 SOAP/REST 服务器的需要，这些服务器在维护一段时间后会变得非常可怕。

The XML schemes were okay for transferring static configurations to mobile devices "every once in a while", but XML was meant for infrequent inter-company type transfers in a "server environment" (with power cords, wired networks and air conditioning) and is definitely not efficient for frequent database queries coming in from n-copies of a mobile app. There are third-party JSON libraries that help things, but even with JSON, everything has to be encoded (and decoded) from the binary representation in the database to text representation on the server (only fine if it's going to be shown to the user in a web browser anyway, but not fine if the mobile app is going to translate it right back into binary so that it can perform calculations "behind the scenes" to what is going on with the user). Aside from the higher network overhead and battery power the mobile CPU will draw with XML and JSON, it will also make you buy more RAM and CPU power on the back-end server faster than just using an ODBC connection to the database.

# c++ - 调试断言错误

> ID：947864
> 
> 赞同：0
> 
> 时间：2009-06-03T23:43:54.213
> 
> 标签：c++, debugging

我一直在摸不着头脑，当我第一次使用 cmd 进入 project\debug 文件夹然后在那里运行程序时，这段代码运行良好。然后我添加了 if(in) 和 else 部分，然后它开始给我“调试断言失败”错误 mbstowcs.c

表达式 s != NULL

这对我来说没有任何意义..

我在cmd中使用了这个命令：prog.exe test.txt nuther.txt

这两个文件都存在于调试文件夹和主项目文件夹中。

有任何想法吗？

```
 int main(int argc, char **argv)
        {
        parse_opts(argc, argv); //parse the arguments

        return 0;
    }

    void parse_opts(int argc, char **argv)
    {
        string compl_out;

        if( argc > 1 )
        {
            for( int i = 1; i < argc; i++ )
            {
                if( argv[i][0] = '>' )
                {
                    ofstream out_file(argv[i+1]);
                    out_file << compl_out;
                    out_file.close();
                    break;
                }

                ifstream in(argv[i]);
                string buff;

                if(in)
                {
                    while(getline( in, buff ))
                    cout << buff << endl;

                    compl_out.append(buff); 
                }
                else
                {
                    cout << "Can't open file: " << argv[i] 
                            << ", file doesn't exist or is locked in use. " << endl;
                }
            }
        }
        else
        {
            usage();
        }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T23:51:09.673

第一印象：

```
if( argv[i][0] = '>' ) 
```

应该：

```
if( argv[i][0] == '>' ) 
```

您正在分配而不是比较。

我想您也可能打算将**compl_out.append**放在 while 循环内？因为它不会向该缓冲区附加任何内容：

```
while(getline( in, buff ))
{
    cout << "buf" << buff << endl;
    compl_out.append(buff); 
} 
```

# apache-flex - 弹性项目结构

> ID：947873
> 
> 赞同：0
> 
> 时间：2009-06-03T23:45:41.353
> 
> 标签：apache-flex, reference, project, structure

我正在尝试创建一个大型弹性项目。该项目由一个 CORE 应用程序和其他子应用程序组成。

CORE 应用程序应包含将由所有其他项目共享的信息（例如，链接到数据库、从数据库加载数据的数据管理器、应用程序信息，如高度宽度颜色字体......等）。

每个子应用程序都有特定的任务。每个子应用程序本身就是一个大项目，所以我认为将所有代码放在一个巨大的项目中并不是一个好主意。

CORE 项目应该运行主应用程序，通过导航菜单，我应该能够单击并运行其他子应用程序。

有没有办法创建 CORE 应用程序来引用这些子应用程序，以便我可以在 CORE 中运行它们。同时，那些子应用程序是否应该引用 CORE 应用程序来获取与数据库的 NetConnection 以及它们可能共享的其他重要信息？

构建这个项目的最佳方式是什么？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T00:54:32.697

您最好的选择是将您建议的 CORE 内容放入库项目中。将应用程序的前端保留在 Flex 应用程序项目中，但所有需要共享的数据和方法都可以轻松地用于主应用程序和所有其他模块或应用程序。

然后在您的主应用程序和其他应用程序的项目设置中，您可以链接到库项目。

如果您计划使用框架，您还可以查看 PureMVC 多核库。它比我上面提供的解决方案要复杂一些，但它是专门为允许在不同的应用程序之间共享数据和通知而构建的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T12:39:07.477

有两个因素需要考虑。

1.  代码在哪里
2.  该代码的编译输出在哪里。

将所有源代码放在一个代码树中可能是个好主意。这样维护起来更容易。您可以将每个子应用程序放在单独的 AS3 包中。

分离该代码的编译输出也可能是一个好主意。使您的核心应用程序成为主要的弹性应用程序，然后使每个子应用程序成为弹性模块。核心应用程序可以加载模块并像任何其他基于 AS3 的类一样操作它们。这样做的好处是，在调试期间，您可以选择仅构建您当时关心的有限模块集。

我强烈建议您通过某种自动化的 ANT 构建脚本而不是通过 Flex Builder 来构建您的版本。

我们有一个超过 150k 行代码的项目就是这样管理的。这在软件工程方面并不大，但在 Flex 世界中却相当大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-06T17:36:07.417

听起来您想使用 Flex 模块来保持子应用程序自包含但仍能够与核心应用程序交互。

[http://livedocs.adobe.com/flex/3/html/help.html?content=modular_2.html](http://livedocs.adobe.com/flex/3/html/help.html?content=modular_2.html)

这将允许您保持核心应用程序 SWF 相当小并按需加载子应用程序。

通常，模块与主应用程序存储在同一个项目中，但每个应用程序/模块都由 Flex Builder 或自动构建工具（如 Ant 或 Maven）编译成单独的 SWF。

# language-agnostic - 什么是功能分解？

> ID：947874
> 
> 赞同：36
> 
> 时间：2009-06-03T23:45:50.450
> 
> 标签：language-agnostic

功能分解，它有什么用，它的优点/缺点是什么？哪里有一些关于如何使用它的工作示例？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-06-03T23:51:14.917

功能分解是将复杂的过程分解成更小、更简单的部分的过程。

例如，考虑使用 ATM。您可以将过程分解为：

1.  走到自动取款机

2.  插入您的银行卡

3.  输入您的密码

嗯……你明白了。

您可以考虑以相同的方式进行编程。想想运行该 ATM 的软件：

1.  读卡代码

2.  密码验证

3.  转移处理

每一个都可以进一步细分。一旦你到达了一个子系统中最分解的部分，你就可以考虑如何开始对这些部分进行编码。然后你将这些小部分组合成更大的整体。看看这篇维基百科文章：

[分解（编程）](http://en.wikipedia.org/wiki/Decomposition_(computer_science))

功能分解的好处是，一旦你开始编码，你就可以在你的应用程序中使用最简单的组件。因此，开发和测试这些组件变得更加容易（更不用说您能够更好地构建代码和项目以满足您的需求）。

明显的缺点是时间投入。在开始编码之前，对复杂系统执行功能分解需要花费大量时间。

就个人而言，我认为这段时间非常值得。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-04T15:07:52.823

它与 WorkBreakDown Structures (WBS)、思维导图和自上而下的开发相同——基本上是将一个大问题分解为更小、更易于理解的子部分。

优点

*   允许一种主动的编程方法（抵制编码的冲动）
*   有助于识别项目的复杂和/或风险领域（在 ATM 示例中，安全性可能是更复杂的组成部分）
*   帮助识别项目的所有组件 - 项目/代码失败的第一大原因（通过 Capers Jones）丢失了部分 - 直到项目后期才想到的事情（天哪，我没有意识到我必须检查这个人的平衡在分发 $ 之前）
*   允许组件解耦，以实现更好的编程、代码共享和工作分配

缺点 - 进行分解没有真正的缺点，但是有一些常见的错误

*   没有分解到足够远或分解到很远 - 每个人都需要确定所需的详细程度，以便为他们提供对组件的洞察力而不会过度（不要分解成编程代码行......）
*   不考虑使用预先存在的模式/代码模块（返工）
*   未与客户一起审查以确保范围正确
*   在实际编码时不使用故障（例如设计房子而不是忘记计划并开始将一些板钉在一起）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T23:58:14.217

这是一个示例：您的 C 编译器。

首先是预处理器：它处理`#include`和`#define`所有的宏。你给它一个文件名和一些选项，它会返回一个很长的字符串。让我们调用这个函数`preprocess(filename)`。

然后是词法分析器。它需要一个字符串并将其分解为标记。调用它`lex(string)`。解析器获取标记并将它们变成一棵树，称为它`parse(tokens)`。然后有一个将树转换为块的 DAG 的函数，调用它`dag(tree)`。调用代码发射器`emit(dag)`，它接受一个 DAG 块并吐出汇编程序。

那么编译器是：

```
emit(dag(parse(lex(preprocess(filename))))); 
```

我们已经将一个大的、难以理解的函数（`compile`函数）分解成一堆更小的、更容易理解的函数。您不必将其作为管道进行，您可以将程序编写为：

```
process_data(parse_input(), parse_config()) 
```

这个比较典型；编译器是相当深的程序，相比之下，大多数程序都很宽泛。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-04T00:08:26.677

功能分解是一种基于需要执行的任务而不是数据关系将复杂问题分解为更简单问题的方法。该术语通常与较早的面向过程的设计相关联。

[关于面向过程和面向对象设计之间区别的简短描述。](http://wiki.answers.com/Q/What_is_difference_between_procedure_oriented_and_Object_Oriented)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-20T22:11:43.753

在创建功能需求文档之前，功能分解很有帮助。如果你需要软件做某事，功能分解回答了“这个软件必须提供什么功能”这个问题。需要分解来定义细粒度函数。“我需要能效测量软件”太笼统了。这就是为什么我们将其分解成更小的部分，直到我们清楚地了解系统需要提供的所有功能为止。这可以在以后用作系统完整性的检查表。

功能需求文档 (FD) 基本上是功能分解的文本表示。直接从 FD 编码对于过程语言可能是可以的，但对于面向对象的解决方案来说还不够好，因为它不能识别对象。两者都不适合可用性规划和测试。

我的意见是你应该花一些时间来创建一个 FD，但不要过多地使用它。请咨询每个了解您在系统中遵循的过程的人，以找到所需的所有功能。

我在软件设计、开发和销售方面有丰富的经验，我将功能分解作为开发的第一步。我用它作为合同的基础，所以客户知道他们会得到什么，我知道我必须提供什么。

# iphone - iPhone SDK 2：以编程方式添加信息按钮

> ID：947877
> 
> 赞同：1
> 
> 时间：2009-06-03T23:47:07.577
> 
> 标签：iphone, button

我正在尝试向我的应用程序添加一个信息按钮以提供自定义帮助。

我没有将按钮添加到笔尖并将事件（touchUpInside）链接到控制器，而是决定以编程方式添加按钮。按钮出现。当我添加触摸按钮时要执行的目标事件处理程序时，它不起作用。触摸按钮时没有调用我的方法（doHelp）。

当我调试它时，该事件未使用按钮注册！虽然代码没有抛出任何异常。

这是视图中的代码片段：

```
 // Create a Button to get Help      
    UIButton *helpButton =  [UIButton buttonWithType:UIButtonTypeInfoDark ] ;
    buttonRect = helpButton.frame;

    // CALCulate the bottom right corner
    buttonRect.origin.x = rect.size.width - buttonRect.size.width - 8;
    buttonRect.origin.y = rect.size.height - buttonRect.size.height - 8; 
    [helpButton setFrame:buttonRect];

    [helpButton addTarget:self action:@selector(doHelp:) forControlEvents:UIControlEventTouchUpInside];
    [helpButton setEnabled:TRUE];
    [self addSubview:helpButton]; 
```

...........

```
// Another METHOD ELSEWHERE in the VIEW object
-(void)doHelp:(id)Sender
{
    [self setHelpNeeded:TRUE];
    [self setNeedsDisplay];
} 
```

请问我做错了什么？我查看了 SDK 帮助和示例，真的很困惑！我希望另一双眼睛会有所帮助！:-)

如果您需要知道，此代码片段位于视图对象中。我刚刚添加了 doHelp 来帮助前 2 名响应者...谢谢。

** 2009 年 6 月 4 日更新 ** - 我整晚都在尝试，但没有任何效果。我认为我设置方法选择器的方式有问题，因为我的方法永远不会被调用。其他一切看起来都很好。即使使用 NIB 文件也不起作用。我已经标记了按钮，检索它并添加了方法选择器，但无济于事。我做错了一些基本的事情......啊！ *任何想法，任何人？*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-14T00:05:03.233

终于解决了！！！并学到了一些东西作为回报。我花了几天时间才弄清楚这一点。

我的 UIButton 对象不起作用的原因是因为我发现在 UIIMageView 对象的情况下：

“initWithImage：此方法调整接收器的框架以匹配指定图像的大小。它还默认禁用图像视图的用户交互。”

**并且我的 UIButton 已被分配为 UIImageView 控件的子视图！**

没有错误/警告。它只是悄悄地被禁用。

**解决方案**：创建一个容器 UIView 对象，该对象现在包含 UIImageView 和按钮，以便按钮显示为覆盖在图像上，但它实际上是图像的兄弟姐妹和虚拟容器 UIView 的子视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T23:58:42.500

已经有一段时间了，但我认为您的 addTarget 需要获取包含 doHelp: 选择器的对象，如下所示：

```
[helpButton addTarget:self action:@selector(doHelp:)]; 
```

假设您在同一个视图中的某个地方：

```
- (void)doHelp: { } 
```

将 nil 传递给 addTarget 意味着您将该选择器发送给没有收件人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T00:00:25.833

问题出在你`addTarget:nil`那里。你给它的选择器只是一个它会发送给它的目标的消息。你没有给它一个目标，所以它不知道如何处理该消息。你可能想通过`self`而不是`nil`那里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-22T03:45:32.923

我在谷歌搜索解决同一问题时遇到了这个问题。至少对于 3.x SDK，您所要做的就是将 UIImageView 的 UserInteractionEnabled 属性设置为 YES。

感谢您发布有关该问题的发现，我什至没有想过要查看那个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-13T09:02:00.260

我有一个类似的问题，按钮在视图之外并且没有收到点击消息

有什么帮助是设置父视图的背景颜色，以查看该按钮在它之外：

```
...
[buttonParentView addSubview: myButton];
buttonParentView.backgroundColor = [UIColor cyanColor]; 
```

# html - HTML是否仍然在页面布局中起作用？

> ID：947881
> 
> 赞同：1
> 
> 时间：2009-06-03T23:49:23.873
> 
> 标签：html, css, layout

我认为理想的情况是纯粹将 CSS 用于布局和展示，而将 HTML 用于内容。但是，假设公司想要将“相关文章”框从页面底部更改为页面顶部。在这种情况下，单独使用 CSS 不是一个理想的解决方案，但最好还是更改 HTML？那么就目前情况而言，HTML 仍然在页面布局和呈现中发挥作用吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T23:54:22.837

事物仍然以与它们在 html 中相同的顺序出现 - 它不像我们可以使用绝对位置和相对位置那样具有限制性，但这些都是不可取的 - 最好使用 dom 流来处理放置，这意味着是的，您应该在 html 中移动节点。

正如 Jason 所说，CSS 用于样式化内容，内容本身及其顺序由数据 (html) 定义，因为顺序对于信息的上下文是必要的，因此它牢牢地位于我们所做的“数据”部分而不是“显示”

编辑：我应该这样说：如果您希望您的数据完全独立于显示，您应该考虑将您的页面仅定义为 xml 并使用 xsl 来定义布局。xsl 结合 css 将显示从数据中完全抽象出来。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T23:57:38.977

它在两个层面上进行：

首先，元素的顺序仍然很重要。CSS 浮动在布局中被大量使用，但它们也要求元素按一定的顺序排列，以便将内容放在正确的位置。例如，假设您有两个按钮：

```
<input type="button" value="Click Me">
<input type="button" value="No, Click Me!"> 
```

这些是彼此相邻的。假设有人要求您将第二个按钮移到最右边。这就是你的做法：

```
<input type="button" value="No, Click Me!" style="float: right">
<input type="button" value="Click Me"> 
```

如果您不这样做，第二个（浮动）按钮将出现在另一个下方。

HTML 仍然很重要的第二种方式是，仍有一些事情需要 HTML 表格，因为这些事情根本无法在纯 CSS 中以与浏览器兼容的方式（通常意味着 IE6 支持）或轻松完成。这不是纯 CSS 狂热者喜欢听到的东西，但不管你喜不喜欢，在现实世界中它仍然是真实的。

对于 HTML 电子邮件尤其如此。如果你认为浏览器对 CSS 的支持很糟糕，那么邮件程序的支持就**更糟了**。一般来说，你完全避免使用 HTML 电子邮件和 CSS，只是假装它仍然是 1999 年。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T23:53:50.153

HTML 仍然定义元素的层次结构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T23:54:41.900

HTML 将您的页面划分为逻辑部分。然后 CSS 将特定的外观/感觉/样式应用于这些部分。

如果您想更改页面布局以在另一个页面中包含一个部分，您别无选择，只能修改您的 HTML，因为 HTML 在页面布局中具有作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T23:55:33.910

您实际上可以使用 CSS 来移动块。妥协总是归结为你的 CSS 技能有多好，以及你所追求或关心的与旧浏览器的兼容性有多大。CSS 可以做的事情是有限度的，所以是的，HTML 肯定仍然可以发挥作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T23:55:41.163

可以更改 div 的“源顺序”或使用 css 更改位置。但是，如果只更改 html 更实际，那么就没有其他办法了。归根结底，如果它的内容更重要，那么来源应该出于语义原因反映它。

# data-structures - 是否有任何允许快速合并的地图数据结构？

> ID：947893
> 
> 赞同：1
> 
> 时间：2009-06-03T23:52:14.790
> 
> 标签：data-structures, merge, binary-tree, big-o

是否有至少具有`O(log n)`插入、删除、访问和合并的地图数据结构？

大多数[自平衡二叉树，](http://en.wikipedia.org/wiki/Self-balancing_binary_search_tree)例如[AVL 树](http://en.wikipedia.org/wiki/AVL_tree)和[红黑树](http://en.wikipedia.org/wiki/Red-black_tree)，都具有这些属性中的大部分，但我相信它们具有`O(n log n)`合并功能。有没有合并速度更快的数据结构？

编辑：我环顾四周，找不到这样的东西。如果没有这样的数据结构，我很想了解为什么这是不可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T00:23:05.320

我会看看张开的树。您可能最终会在此过程中支付合并成本，但您应该能够注入另一棵树并将成本推迟到以后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-03T10:48:17.270

您是否需要为仅定义了比较的任意键类型创建树，或者如果它仅适用于具有固定大小二进制表示的类型（int、long、float、double ......），是否可以？如果是后者，那么二叉基数树是一种具有非常有效的合并的数据结构（如果幸运的话，O(1)，最坏的情况是 O(N)）。

有关数据结构的详细信息，请参阅Chris Okasaki 和 Andrew Gill 的[Fast Mergeable Integer Maps](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.37.5452)。

Scala Collections Library 包含一个[ints](http://www.scala-lang.org/api/current/index.html#scala.collection.immutable.IntMap)和[longs](http://www.scala-lang.org/api/current/index.html#scala.collection.immutable.LongMap)的实现。所有其他java 原始类型都可以转换为int 或long，例如使用java.lang.Double.doubleToLongBits for Double。

# f# - 如何将“字符串”转换为“选项 "

> ID：947895
> 
> 赞同：7
> 
> 时间：2009-06-03T23:53:11.997
> 
> 标签：f#

我有一个函数声明为

```
let GetLength (value : option<string>) = 
    if value.IsSome then value.Value.Length else 0 
```

我有变量

```
let a : string = "tom" 
```

如何将 a 传递给函数 GetLength？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-11T10:28:07.487

接受的答案没有编译，并产生......

```
GetLength Some a;; 
```

^^^^^^^^^^^^^^ 错误FS0003：此值不是函数，不能应用

F# 认为您正在构建一个函数`(GetLength Some)`以应用于 value `a`。那是因为它是一种函数式语言。

正确的形式是

```
GetLength (Some a);; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T23:54:26.347

你不投。您需要使用`Some`构造函数：

```
GetLength Some a 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-07-12T20:08:05.530

括号的替代方法：

```
GetLength <| Some a 
```

我认为解决这个问题很重要：

> 当您可以在一行上使用 12 个令牌获得完全相同的东西时，为什么有人愿意在 3 行上键入 18 个令牌？

编写代码不仅仅是为了简洁——它还关乎可读性和可维护性。假设您需要处理 is 的`a`情况`null`。使用模式匹配，您可以这样做：

```
let GetLength (value : string option) =
    match value with
    | Some s -> s.Length
    | _ -> 0 
```

对此：

```
let GetLength (value : string option) =
    match value with
    | Some s when s <> null -> s.Length
    | _ -> 0 
```

对于 F# 程序员来说，含义很清楚。修复你的实现看起来像这样：

```
let GetLength (value : option<string>) = 
    if value.IsSome && value.Value <> null then value.Value.Length else 0 
```

结果可能是一样的，但我发现并不是特别容易一眼看出正在发生的事情。

如果模式匹配没有引起您的共鸣，那很好，但是随着逻辑的发展，简单情况下的额外“成本”通常会被多次弥补。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-13T04:04:10.433

要回答转换为的一般问题`'a`，`option<'a>`如果您想安全地进行转换而不只是将对象应用于`Some`构造函数，我会使用一个简单的函数：

```
let to_option = function
  | null -> None
  | obj -> Some obj 
```

# fluent-nhibernate - Fluent NHibernate 有很多对很多约定问题

> ID：947896
> 
> 赞同：6
> 
> 时间：2009-06-03T23:53:33.913
> 
> 标签：fluent-nhibernate, nhibernate-mapping, many-to-many, conventions

我是流利的 nhibernate 和 nhibernate 的新手。我想编写一个流畅的 nhibernate autopersistence 约定来处理为我的实体创建多对多映射。

这就是我现在所拥有的：

```
using System;
using FluentNHibernate.Conventions;
using FluentNHibernate.Mapping;

namespace Namespace
{
    public class HasManyToManyConvention : IHasManyToManyConvention
    {
        public bool Accept(IManyToManyPart target) {
            return true;
        }

        public void Apply(IManyToManyPart target) {
            var parentName = target.EntityType.Name;
            var childName = target.ChildType.Name;
            const string tableNameFmt = "{0}To{1}";
            const string keyColumnFmt = "{0}Fk";
            string tableName;

            if (parentName.CompareTo(childName) < 0) {
                tableName = String.Format(tableNameFmt, parentName, childName);
            }
            else {
                tableName = String.Format(tableNameFmt, childName, parentName);
            }

            target.WithChildKeyColumn(String.Format(keyColumnFmt, childName));
            target.WithParentKeyColumn(String.Format(keyColumnFmt, parentName));
            target.WithTableName(tableName);
            target.Cascade.All();
        }
    }
} 
```

它似乎有效，但我觉得有更好的方法来做到这一点。

现在我的问题：

1.  你有更好的方法来做到这一点吗？
2.  你通常想要这里的级联行为吗？
3.  除了确保此关联的双方最终使用相同的表名之外，我是否需要担心一些事情？

# shell - Shell 脚本中的块注释

> ID：947897
> 
> 赞同：298
> 
> 时间：2009-06-03T23:53:34.367
> 
> 标签：shell

有没有一种简单的方法可以在 shell 脚本中注释掉一段代码？

* * *

## 回答 #1

> 赞同：407
> 
> 时间：2009-06-04T00:02:58.200

在 bash 中：

```
#!/bin/bash
echo before comment
: <<'END'
bla bla
blurfl
END
echo after comment 
```

分隔符周围的and`'`很重要，否则块内的内容（例如）将被解析和执行。`'``END``$(command)`

有关解释，请参阅[this](https://stackoverflow.com/questions/32126653/how-does-end-work-in-bash-to-create-a-multi-line-comment-block)和[this](https://unix.stackexchange.com/questions/37411/multiline-shell-script-comments-how-does-this-work/) question。

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2009-06-04T00:28:47.913

shell 脚本没有块注释。

使用`vi`(yes, `vi`) 您可以轻松地从第*n*行评论到*m*

```
<ESC>
:10,100s/^/#/ 
```

*（即从第 10 行到第 100 行替换行以 # 符号开头 (^)。）*

和联合国评论

```
<ESC>
:10,100s/^#// 
```

*（即从第 10 行到第 100 行替换行开始 (^) 后跟 # 并注明 //。）*

`vi`几乎在任何有`/bin/sh`.

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2019-06-28T04:35:11.310

用于`: '`打开和`'`关闭。

例如：

```
: '
This is a
very neat comment
in bash
' 
```

这是来自维加斯在[这里找到的例子](https://stackoverflow.com/questions/43158140/way-to-create-multiline-comments-in-bash/43158193)

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2013-04-10T15:26:13.367

您可以使用：

```
if [ 1 -eq 0 ]; then
  echo "The code that you want commented out goes here."
  echo "This echo statement will not be called."
fi 
```

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2013-10-16T16:58:56.953

以下应该适用于`sh`、`bash`和。`ksh``zsh`

要注释的代码块可以放在`BEGINCOMMENT`and中`ENDCOMMENT`：

```
[ -z $BASH ] || shopt -s expand_aliases
alias BEGINCOMMENT="if [ ]; then"
alias ENDCOMMENT="fi"

BEGINCOMMENT
  echo "This line appears in a commented block"
  echo "And this one too!"
ENDCOMMENT

echo "This is outside the commented block" 
```

执行上述代码将导致：

```
This is outside the commented block 
```

* * *

为了取消注释因此*注释*的代码块，比如说

```
alias BEGINCOMMENT="if : ; then" 
```

代替

```
alias BEGINCOMMENT="if [ ]; then" 
```

在上面的例子中。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2013-10-15T07:23:28.917

如果你能避开单引号：

```
__='
blah blah comment.
' 
```

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2009-06-04T00:30:39.517

在 Vim 中：

1.  转到您要评论的块的第一行
2.  `shift-V`（进入视觉模式），向上向下突出显示块中的行
3.  在选择时执行以下操作`:s/^/#/`
4.  该命令将如下所示：

    ```
     :'<,'>s/^/# 
    ```

5.  点击进入

例如

```
shift-V
jjj
:s/^/#
<enter> 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-02-06T23:02:14.167

你可以使用 Vi/Vim 的 Visual Block 模式，它是为这样的东西设计的：

```
Ctrl-V  
Highlight first element in rows you want commented  
Shift-i  
#  
esc 
```

取消注释将是：

```
Ctrl-V  
Highlight #'s  
d  
l 
```

这是 vi 做这种事情的交互式方式，而不是计算或读取行号。

最后，在 Gvim 中，您使用 ctrl-q 而不是 ctrl-v 进入 Visual Block 模式（因为这是粘贴的快捷方式）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-02-27T15:35:08.350

老实说，为什么这么多过度工程......

我认为编写主动代码来生成被动代码确实是一种不好的做法。

我的解决方案：大多数编辑器都有块选择模式。只需使用它将 # 添加到您要注释掉的所有行。有什么大不了的...

记事本示例：

要创建： Alt - 鼠标向下拖动，按#。

删除：Alt-mousedrag down, shift-right arrow, delete。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-02-15T11:04:10.407

Sunny256 接受的答案中的 here-doc 技巧的一个变体是使用 Perl 关键字进行注释。如果您的注释实际上是某种文档，那么您可以开始在注释块中使用 Perl 语法，它允许您将其打印出来并格式化，将其转换为手册页等。

就外壳而言，您只需要替换`'END'`为`'=cut'`.

```
echo "before comment"
: <<'=cut'
=pod

=head1 NAME
   podtest.sh - Example shell script with embedded POD documentation

etc.

=cut
echo "after comment" 
```

（在“[在 shell 脚本中嵌入文档](http://bahut.alma.ch/2007/08/embedding-documentation-in-shell-script_16.html)”中找到）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-08-06T05:17:23.357

您可以将代码放在函数内进行注释。这样做的好处是您可以通过在定义之后调用函数来“取消注释”。

除非您打算通过调用函数来“取消注释”，否则函数内的文本不必在语法上是正确的。

```
ignored() {
  echo this is  comment
  echo another line of comment
} 
```

许多 GUI 编辑器允许您选择一个文本块，然后按“{”自动在所选代码块周围放置大括号。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-09-10T13:23:17.173

另一种模式是：如果您的编辑器没有块评论选项，

1.  打开编辑器的第二个实例（例如 File=>New File...）
2.  从您正在处理的上一个文件中，仅选择您想要评论的部分
3.  将其复制并粘贴到新临时文件的窗口中...
4.  打开 Edit 菜单，选择 REPLACE 并输入要替换的字符串 '\n'
5.  输入为替换字符串：'\n#'
6.  按下按钮“全部替换”

完毕

它适用于任何编辑器

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-03-08T15:50:07.367

我喜欢单行打开和关闭：

```
if [ ]; then ##
    ...
    ...
fi; ## 
```

'##' 帮助我轻松找到块注释的开始和结束。如果我有一堆，我可以在“##”后面加上一个数字。要关闭评论，我只需在“[]”中添加一个“1”。我还避免了在注释块中使用单引号时遇到的一些问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-07T06:24:20.890

让我们结合所有这些想法和建议中的精华。

```
alias _CommentBegin_=": <<'_CommentEnd_'" 
```

如前所述，单引号非常重要，因为没有它们 $(commandName) 和 ${varName} 将被评估。

您可以将其用作：

```
_CommentBegin_
echo "bash code"
or 
none code can be in here
_CommentEnd_ 
```

别名使用法更明显，更好看。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-10-04T12:16:15.800

在 vscode `ctrl`++中（`K`++取消注释）。`C``ctrl``K``U`

# asp.net - ScriptReference 的顺序在运行时是否始终保持不变？

> ID：947899
> 
> 赞同：0
> 
> 时间：2009-06-03T23:54:05.503
> 
> 标签：asp.net, scriptmanager

过去，`Page.RegisterClientScriptBlock`在糟糕的旧 .Net 1.1 天里，注册的 JS 没有以稳定的顺序从机器到机器发出，这让我感到很痛苦。现在，我正在编写一组`<asp:ScriptManager/>`用于引用 JS 的用户控件，尽管到目前为止我还没有遇到任何问题——`<asp:ScriptReference>`标签之间的顺序似乎总是被保留的——我对此感到有点害羞。MSDN 似乎对这个话题保持沉默，并且各种博主似乎表示排序在 .Net 2.0+ 中是稳定的，但我还没有找到任何明确的参考资料。

一个存在吗？我在开发机器上观察到的脚本的包含顺序是否保证是我在 webapp 运行的所有其他上下文中看到的顺序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-09T00:22:48.967

进一步分析得出的结论是，至少在我的特定生产和开发环境中它们是。

# ruby-on-rails - 红宝石日历日期选择

> ID：947905
> 
> 赞同：0
> 
> 时间：2009-06-03T23:55:31.850
> 
> 标签：ruby-on-rails, ruby, gem

嘿，我在日历日期选择 gem 的时间部分遇到问题。以下代码将日期限制为今天之后/之后的任何一天。我需要为时间执行此操作，将用户限制在 24 小时或比现在更长的时间。我不知道 :valid_date_check 中使用的代码是 SQL、Javascript 还是什么。谷歌和 IRC 也想不通。有没有人有这个 gem 的经验，并且成功地做到了，或者知道代码是什么，所以我可以自己去实现它。

```
<%= calendar_date_select_tag "time", "", :popup => :force, :time => true, :valid_date_check => "date > (new Date()).stripTime()" %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T02:45:12.523

它应该是Javascript。它肯定不是 Ruby 或 SQL，因为它们不使用 new Date()。此外， :valid_date_check 看起来是一个指向要运行以验证客户端日期的 javascript 检查的指针。

有时查看生成的实际 HTML 可以对此有所帮助。如果代码在 HTML 中，那么您就知道它是 Javascript。

# java - 覆盖 JCS 事件

> ID：947910
> 
> 赞同：1
> 
> 时间：2009-06-03T23:56:12.177
> 
> 标签：java, jcs

我在我们的应用程序中使用 Apache JCS 在应用程序启动时缓存常用数据。但是，如果缓存中的某些数据直到空闲时间才使用，我想手动从数据库中重新加载该值。

所以，基本上我想覆盖 JCS 事件，以便我的 java 程序知道从缓存中删除密钥的瞬间，因为密钥达到其空闲时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T00:33:24.737

创建一个抽象类来注册您有兴趣捕获的事件。这对我来说可以捕捉这两个事件。

```
private static final Set<Integer> EVENTS = new HashSet<Integer>();
{
  EVENTS.add(IElementEventHandler.ELEMENT_EVENT_EXCEEDED_IDLETIME_BACKGROUND);
  EVENTS.add(IElementEventHandler.ELEMENT_EVENT_EXCEEDED_MAXLIFE_BACKGROUND);
}
@Override
 public synchronized void handleElementEvent(IElementEvent event) {
 // Check for element expiration based on EVENTS.
 LOG.debug("Handling event of type : " + event.getElementEvent() + ".");
 if (EVENTS.contains(event.getElementEvent())) {
  ElementEvent elementEvent = (ElementEvent)event;
  CacheElement element = (CacheElement)elementEvent.getSource();
  handleEvent(element);
   }

 }
// Abstract method to handle events
 protected abstract void handleEvent(CacheElement element);
} 
```

将此抽象事件处理程序添加到 jcs 工厂定义中，如下所示

```
 JCS jcs = JCSCacheFactory.getCacheInstance(regionName);
 IElementAttributes attributes = jcs.getDefaultElementAttributes();
 attributes.addElementEventHandler(handler);
 jcs.setDefaultElementAttributes(attributes); 
```

# php - 如何在php中对查询结果进行排序？

> ID：947923
> 
> 赞同：0
> 
> 时间：2009-06-03T23:59:31.123
> 
> 标签：php, mysql

我正在尝试将查询结果排序到一个数组中。

我有以下查询。

```
"select s.*, a.* from students left join addresses as a"; 
```

它返回

```
s.id
s.name
a.id
a.student_id
a.address 
```

我想将上面的结果变成一个带有 s 和一个键的数组。

```
array(
  "s"=>array("id"=>"value","name"=>"value")
  ,"a"=>array("id"=>"value","student_id"=>"value","address"=>"value)
) 
```

我必须创建自己的功能才能做到这一点还是有内部功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T00:02:26.190

如果在 PHP 中无法从查询结果中识别表之外，您必须自己进行操作。你只得到列名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T00:30:36.787

旁白：*在您当前的代码中，如果您选择行作为关联数组，我相信 s.id 将被 a.id 覆盖。*

现在，关于一种可能的方法......

如何返回结果的一个方面是您丢失了该列来自的表。如果您发现自己想要对结果集进行后处理，也许您可​​以通过像这样重命名每列来为其设置别名：

```
$query = "SELECT
    s.id         AS s_id
    s.name       AS s_name
    a.id         AS a_id
    a.student_id AS a_student_id
    a.address    AS a_address
    ... "; 
```

一旦你有了它，你可以根据 substr($key,0,1) 组织数据并使用 substr($key,2) 获取“基础列名。

一旦你有了这些，你就可以在每一行内循环来创建你想要使用的数据结构。

# mysql - 如何像黑客新闻一样排序

> ID：947933
> 
> 赞同：6
> 
> 时间：2009-06-04T00:01:50.590
> 
> 标签：mysql, database, database-design

我正在尝试为 bbPress（开源论坛软件）编写一个插件，该插件将类似于 Hacker News ( [http://news.ycombinator.com/](http://news.ycombinator.com/) )。

具体来说，我想使用以下算法对论坛线程的顺序（bbPress 称它们为“主题”）进行排序：

```
sort_value = (p - 1) / (t + 2)^1.5
where p = total votes for each topic from users
t = time since submission of each topic in hours 
```

我希望能够使用 MySQL 通过这个计算的 sort_value 对主题进行排序。

表中的相关字段`topics`如下所示：

```
topic_id            bigint(20)
topic_start_time    datetime 
```

这是悬而未决的，但我在想会有另一个表来存储用户的个人投票，这样我们就可以知道用户是否已经投票了。另一个表将存储每个主题的当前投票总数。也许该表中会有另一个字段存储最新计算的 sort_Value？

为了 100% 准确，sort_value 应该在*每次*新投票后更新。但是，这会给数据库服务器增加太多负载，尤其是当我们尝试更新所有主题时。如果必须，我们可以通过仅计算最后 X # 个主题的 sort_value 来限制数据集。我们还可以通过仅定期更新 sort_value 来限制负载（例如，通过 cron 作业每 5 分钟一次）。

这些快捷方式可能会使负载可接受，但我更喜欢可以更好地扩展的更优雅的解决方案。

你会如何构建这个？:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T03:36:17.727

在这方面需要考虑许多权衡。你已经在你的问题中暗示了他们。及时性和精确性与负载和规模。

如果不需要及时性和精确性并且系统遇到高写入负载，批处理计算是减少负载和增加规模的最佳方法。

您确实必须检查系统的使用情况并确定需要优化的区域。优化写入与优化读取具有不同的约束。数据的及时性或准确性也是如此。

确定哪些对您的应用程序最重要，并做出适当的权衡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T03:20:22.933

好的，这是我的想法。我将首先创建一个`old_table`包含 X 行主题和 sort_value 字段的主题。

我想避免在单个表上使用大量 UPDATE 语句，因此我会定期用新计算的表替换旧表。据我所知，MySQL 不支持“替换表”语法，因此每隔 Y 分钟，我将通过 cron 创建该表的更新版本，名为`new_sort_value`. 然后我将执行以下命令序列：

*   降低`old_table`
*   重命名`new_table`为`old_table`

这看起来是一种有效的方法吗？

# c# - 选择枚举类的常量时出现问题

> ID：947941
> 
> 赞同：0
> 
> 时间：2009-06-04T00:07:00.440
> 
> 标签：c#, rdf, owl, rowlex

我最近遇到了一个关于在 .net 中枚举类的常量之间循环的问题（由 Rowlex OwlGrinder 从我的 OWL 类创建）。通过使用 .net 反射解决了问题（感谢亲爱的 Jon Skeet 先生的大力帮助）： [stackoverflow:problem-cycling-enum-class-values](https://stackoverflow.com/questions/938828/problem-cycling-enum-class-values)

通过解决这个问题，我开始使用它。在将 dropDownList 选定值与枚举类实例之一匹配后，我必须通过谓词 (=hasLanguage) 将选定对象 (=Language) 声明给我的 RDF 主题 (=learningResource)。

```
//learningResource is a new RDF subject, hasLanguage is predicate, and there
        //is a new value for it - Language.

        System.Reflection.FieldInfo[] resLanFields =
            typeof(Language).GetFields();

        for (int i = 0; i < resLangFields.Length; i++)
        {
            if (resLanFields[i].Name.Equals(dropDownList_lang.SelectedValue))
                learningResource.hasLanguage = ??? //i-th constant of Language
        } 
```

现在问题出现了；我不能使用 Language[i]（或类似的东西来选择 Language 类的第 i 个常量）分配给 hasLanguage。有没有办法选择枚举类的第 i 个常量（如引用）？在这种情况下有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T07:19:37.217

Language 类不是 C# 术语中的枚举。它是一个具有公共 const 字符串字段的普通类。ROWLEX 有意生成枚举模仿类而不是原生枚举，原因有两个：

1.  原生 C# 枚举的值是整数，而公共 const 字符串字段可以采用 OWL 类实例的 URI。
2.  该类可以有一个额外的公共静态字符串，即“URI”，它一致地表示每个 ROWLEX 生成的类的类 URI。

这就是背景。如果我正确理解了您的问题，那么您在将下拉列表中显示的选定名称绑定回 URI 时遇到问题，并且您想使用您创建的数组中元素的位置。我不会那样做。DropDownLists 通常具有每个列表项的 ID 和 Value 字段（可以以不同的组件命名）。ID 应该是唯一的对象，而 Value 应该包含人类可读的内容。使用“枚举”字段的 URI 设置 ID，并按照您所做的那样设置值。这就是您填充下拉列表的方式：

```
System.Reflection.FieldInfo[] resLanFields = typeof(Language).GetFields();
foreach(FieldInfo field in resLanFields)
{
  ListItem item = new ListItem();
  item.ID = field.GetValue(null); // takes the URI value of the const field
  item.Value = field.Name; // takes the name of the const field
  dropDownList_lang.AddItem(item);
} 
```

当用户做出他/她的选择时，这就是你读出结果的方式：

```
learningResource.hasLanguage = (string) dropDownList_lang.SelectedItem.ID; 
```

由于在 ROWLEX 枚举模仿类 (string=>Language) 上实现了隐式转换运算符，您可以安全地将三重主题设置为字符串。应该编译没有问题。很简单，不是吗？;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T00:14:01.343

我会说

```
resLanFields[i].GetValue(null) 
```

但如果这可行，请不要投票给我，这是乔恩的原始答案。

# c++ - 模板化类型也是模板的模板特化

> ID：947943
> 
> 赞同：5
> 
> 时间：2009-06-04T00:07:31.733
> 
> 标签：c++, templates

我为字符串转换创建了一个小型实用程序函数，这样我就不必到处创建 ostringstream 对象了

```
template<typename T>
inline string ToString(const T& x)
{
    std::ostringstream o;
    if (!(o << x))
        throw BadConversion(string("ToString(") + typeid(x).name() + ")");
    return o.str();
} 
```

我想为字符串流没有默认重载 << 运算符的实例（即 std::pair、std::set、我自己的类）提供这种方法的一些特化，并且我在模板方面遇到了困难。如果我希望能够，我将用 std::pair 示例进行说明

```
string str = ToString(make_pair(3, 4)); 
```

我能想到的唯一方法是为 int 定义显式专业化

```
template<>
inline string ToString(const pair<int,int>& x)
{
    std::ostringstream o;
    if (!(o << "[" << x.first << "," << x.second << "]"))
        throw BadConversion(string("ToString(pair<int,int>)"));
    return o.str();
} 
```

有没有办法可以为一般情况定义这个？

```
template<>
inline string ToString(const pair<T1,T2>& x)
{
    std::ostringstream o;
    if (!(o << "[" << x.first << "," << x.second << "]"))
        throw BadConversion(string("ToString(pair<T1,T2>)"));
    return o.str();
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-04T00:16:01.090

不要专门化模板，而是重载它。编译器将根据函数参数类型的特殊化对它们进行排序（这称为部分排序），从而确定要采用的函数模板。

```
template<typename T1, typename T2>
inline string ToString(const std::pair<T1, T2>& x) {
    std::ostringstream o;
    if (!(o << "[" << x.first << "," << x.second << "]"))
        throw BadConversion(string("ToString(pair<T1,T2>)"));
    return o.str();
} 
```

一般来说，部分排序会得到你所期望的结果。更详细地说，考虑拥有这两个功能

```
template<typename T> void f(T);
template<typename T, typename U> void f(pair<T, U>); 
```

现在，要查看一个是否至少与另一个一样专业，我们对两个函数模板进行以下测试：

1.  为每个模板参数选择一些独特的类型，将其替换到函数参数列表中。
2.  将该参数列表作为参数，对另一个模板进行参数推导（使用这些参数对另一个模板进行虚拟调用）。如果推演成功并且不需要转换（加const就是这样）。

上述示例：

1.  将某种类型代`X1`入`T`给我们某种类型，称之为`X1`。`X1`反对的论点推论是 `pair<T, U>`行不通的。所以第一个模板至少不像第二个模板那样专业。
2.  代入类型`Y1`和收益。对第一个模板进行参数推导工作：将推导为. 所以第二个至少和第一个一样专业。`Y2``pair<T, U>``pair<Y1, Y2>``T``T``pair<Y1, Y2>`

规则是，一个函数模板 A 比另一个 B 更特化，如果 A 至少和 B 一样特化，但 B 至少不像 A 那样特化。所以，在我们的示例中，第二个获胜：它更特化，如果我们原则上可以调用两个模板函数，它将被选中。

恐怕，那个概述很匆忙，我只为类型参数做了它并跳过了一些细节。查看`14.5.5.2`C++ 标准规范以查看血淋淋的细节。G

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T07:25:53.943

使用类型特征将不同类型序列化到流中怎么样：

```
template<typename T>
struct Traits {
  static inline bool ToStream(std::ostringstream& o, const T& x) {
    return o << x;
  }
};

template<typename T1, typename T2>
struct Traits<std::pair<T1, T2> > {
  static inline bool ToStream(std::ostringstream& o, const std::pair<T1, T2>& x) {
    return o << "[" << x.first << "," << x.second << "]";
  }
};

template<typename T>
inline std::string ToString(const T& x)
{
  std::ostringstream o;
  if (!Traits<T>::ToStream(o, x))
    return "Error";
  return o.str();
} 
```

注意：专业化部分的“template<>”是可选的，没有它，代码编译得很好。您可以在异常消息的特征中进一步添加方法。

# objective-c - 如何确定在任意 NSDate 期间是否发生了 NSTimeInterval？

> ID：947947
> 
> 赞同：0
> 
> 时间：2009-06-04T00:08:32.353
> 
> 标签：objective-c, cocoa, cocoa-touch

我有一个 NSTimeInterval，我想知道该时间戳是否介于日期的开始和结束之间。基本上我需要能够做类似的事情：

```
NSDate *today = [NSDate date];
NSTimeInterval myInterval = someInterval;

[date returnYesIfFallsThisDate:myInterval]; 
```

是否有直接的方法来确定我的 NSTimeInterval 是否与 NSDate 对象在同一天？

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T00:18:00.883

从概念上讲，您需要两个日期来构成相关目标日期的“开始”和“结束”。然后，您可以直接针对这些日期的相应时间间隔测试时间间隔。

例如，如果我住在旧金山，那么我希望“开始”是太平洋时间上午 12 点，结束是太平洋时间晚上 11:59:59.99999。

一旦确定了要考虑将哪些时区/等作为起点和终点，您就可以使用时间间隔进行测试：

```
if ((myInterval >= [earlyMorningDate timeIntervalSinceReferenceDate]) && 
    (myInterval <= [lateEveningDate timeIntervalSinceReferenceDate]))
{
    NSLog(@"Whoo hoo - it's the right date!");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T01:15:35.887

请记住，NSDate 不代表任何形式的“一天”，只是一个时间点。您必须对 NSDateComponents 做一些工作，使用 NSCalendar（通常是用户的默认日历）进行转换，以计算出 NSDate 的开始和结束值，并比较使用这些值来比较您的时间间隔。

我将首先获取您一天内的 NSDate，并将其转换为 NSDateComponents，但没有小时、分钟或秒。这是一个快速（未经测试）的示例，可帮助您入门：

```
NSDateComponents *comps = [[NSCalendar currentCalendar] components:(NSYearCalendarUnit | NSMonthCalendarUnit |  NSDayCalendarUnit) fromDate:[NSDate date]];
NSDateComponents *day = [[[NSDateComponents alloc] init] autorelease];
[day setDay:1];
NSDate *start = [[NSCalendar currentCalendar] dateFromComponents:comps];
NSDate *end = [[NSCalendar currentCalendar] dateByAddingComponents:day toDate:start options:0]; 
```

然后您可以比较 Jalkut 先生建议的时间间隔（或另一种方法，NSDate 可以以几种不同的方式与 NSTimeIntervals 一起使用）。我肯定会花一些时间在文档中查看 NSCalendar 和 NSDateComponents，但您可能会找到比我建议的更好的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T02:52:02.540

NSTimeInterval 只是几秒钟。要将其与 NSDate 进行比较，您需要解释相对于某个参考点的时间间隔，然后使用结果创建 NSDate，然后比较两个 NSDate。

有两个标准参考日期：[2001-01-01](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/occ/clm/NSDate/dateWithTimeIntervalSinceReferenceDate:)和[1970-01-01](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/occ/clm/NSDate/dateWithTimeIntervalSince1970:)（后者是“UNIX 时间”）。如果这些都不是正确的参考日期，请使用 NSCalendar 为正确的参考日期创建一个 NSDate，然后[创建与该日期相关的您感兴趣的 NSDate](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDate_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDate/initWithTimeInterval:sinceDate:)。

现在进行比较。

如果您只关心日历上的日期，那么您将创建 NSDate，然后使用 NSCalendar 获取日期的 NSDateComponents。具体来说，您将获得年、月和日，然后进行比较。

无需担心“开始”和“结束”时间；事实上，如果您只关心日历上的日期，您可以完全忽略时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-04T09:27:05.337

只是我还是 OP 似乎认为 NSTimeInterval 是从 A 到 B 的时间间隔的表示？即从日期 A 到日期 B 的绝对距离（以秒为单位）。

需要解决原始问题以说明您需要根据参考日期找到它。像这样的东西：

```
NSDate *refDate = someReferenceDate;
NSTimeInterval interval = someInterval;
NSDate *today = [NSDate date];
BOOL isInRange = false;

isInRange = [today isInterval:interval inRangeFromReference:refDate]; 
```

然后，该方法将使用 Damiel、Peter 和 Marc 上面提到的一些（或部分）策略。

# ruby-on-rails - 使用 Selenium 进行 Rails 测试，每个人的密码都错误

> ID：947949
> 
> 赞同：1
> 
> 时间：2009-06-04T00:09:54.753
> 
> 标签：ruby-on-rails, selenium

我有一个包含一堆黄瓜测试的应用程序，我今天尝试使用硒。花了一点时间，但我让它运行起来了，它启动了 selenium，使用了正确的数据库和一切，但每个人的密码都错误。

我可以看到用户被创建，我可以记录密码并看到它是正确的密码，但是每个测试用户都会被重定向回登录页面，并出现错误的用户名/密码错误。

这是硒问题，还是其他一些依赖系统，或者我错过了什么？它适用于标准 :rails webrat 模式。

我将任务运行为

```
rake features 
```

*   Ubuntu 9.04
*   机械师 0.3.1
*   硒 1.1.14
*   火狐 3.0.10
*   红宝石 1.8.7-p160
*   黄瓜 0.3.7

编辑：现在，重新启动（办公室重组）后，它根本不会运行测试。Firefox 刚启动，然后关闭，然后一切都失败了。

```
14:13:25.141 错误 - 无法启动新的浏览器会话，关闭浏览器并清除所有会话数据
org.openqa.selenium.server.RemoteCommandException：等待窗口“空”出现超时
```

我已经尝试从最新版本更新 selenium-server.jar，但没有骰子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T22:59:32.887

```
Cucumber::Rails.use_transactional_fixtures 
```

是罪魁祸首。在 selenium 中你不能有事务性的固定装置，所以编写黄瓜步骤会更有趣，但无论如何。注释掉上面的行可以解决密码问题。

# string - 字符串常量是否被高估了？

> ID：947952
> 
> 赞同：4
> 
> 时间：2009-06-04T00:11:33.237
> 
> 标签：string, constants

`0`很容易忘记,`1`或等奇数`5`。当我编写低级 C 代码时，我曾经对此非常严格。随着我更多地处理涉及 XML 和 SQL 的所有字符串文字，我发现自己经常打破在代码中嵌入常量的规则，至少在字符串文字方面是这样。（我仍然擅长数字常量。）

字符串与数字不同。创建一个与其值（例如）具有相同名称的编译时常量感觉乏味且有点愚蠢`const string NameField = "Name";`，尽管在许多位置重复相同的字符串文字似乎有风险，但由于复制，错字的可能性很小和粘贴，当我重构时，我通常会进行全局搜索，这不仅涉及更改事物的名称，还包括如何在功能上相对于周围事物进行处理。

所以，假设您没有一个好的 XML 序列化程序（或者没有心情设置一个）。您个人会使用以下哪一项（如果您不想在某些代码审查中屈服于同行压力）：

```
static void Main(string[] args)
{
    // ...other code...

    XmlNode node = ...;

    Console.WriteLine(node["Name"].InnerText);
    Console.WriteLine(node["Color"].InnerText);
    Console.WriteLine(node["Taste"].InnerText);

    // ...other code...
} 
```

或者：

```
class Fruit
{
    private readonly XmlNode xml_node;

    public Fruit(XmlNode xml_node)
    {
        this.xml_node = xml_node;
    }

    public string Name
    { get { return xml_node["Name"].InnerText; } }

    public string Color
    { get { return xml_node["Color"].InnerText; } }

    public string Taste
    { get { return xml_node["Taste"].InnerText; } }
}

static void Main(string[] args)
{
    // ...other code...

    XmlNode node = ...;
    Fruit fruit_node = new Fruit(node);

    Console.WriteLine(fruit_node.Name);
    Console.WriteLine(fruit_node.Color);
    Console.WriteLine(fruit_node.Taste);

    // ...other code...
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-04T00:21:44.543

定义的常量更容易重构。如果“Name”最终被使用了 3 次，而您将其更改为“FullName”，则更改常量是一次更改而不是三次更改。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-04T00:21:35.027

对于类似的事情，这取决于常量的使用频率。如果按照您的示例仅在一个地方，那么硬编码就可以了。如果它在许多不同的地方使用，一定要使用常量。如果您不小心，一个错字可能会导致数小时的调试，因为您的编译器不会注意到您输入的是“Tsate”而不是“Taste”，而它会注意到您输入的是fruit_node.Tsate 而不是fruit_node。品尝。

编辑：我现在看到您提到了复制和粘贴，但是如果您这样做，您可能还会因为一开始就没有创建常量而浪费了您节省的时间。借助智能感知和自动完成功能，您只需敲几下键就可以得到常量，而不必经历复制/粘贴的麻烦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T00:18:04.957

正如你可能猜到的那样。答案是：这取决于上下文。

这取决于示例代码的一部分。如果它只是一个小型丢弃系统的一部分，那么对常量进行硬编码可能是可以接受的。

如果它是大型复杂系统的一部分，并且常量将在多个文件中使用，我会更倾向于第二种选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T00:19:52.830

与许多编程问题一样，这是一个品味问题。正确编程的“法则”是从经验中创造出来的——许多人被全局变量所困扰，导致命名空间或清晰度问题，所以全局变量是邪恶的。许多人使用了幻数，但后来发现这个数字是错误的或需要更改。文本搜索不适合更改这些值，因此代码中的常量是邪恶的。

但两者都是允许的，因为有时它们*并不*邪恶。您需要自己做出决定——这会导致更清晰的代码？哪个对维护者更好？原始规则背后的推理是否适用于我的情况？如果我以后必须阅读或维护这段代码，我宁愿如何编写它？

良好的编码风格没有绝对的规律，因为没有两个程序员的思维方式完全相同。规则是尽可能写出最清晰、最干净的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-04T00:20:00.490

就个人而言，我会提前从 XML 文件中加载水果——比如：

```
public class Fruit
{
    public Fruit(string name, Color color, string taste)
    {
        this.Name = name;  this.Color = color; this.Taste = taste;
    }

    public string Name { get; private set; }
    public Color Color { get; private set; }
    public string Taste { get; private set; }
}

// ... In your data access handling class...
    public static FruitFromXml(XmlNode node) 
    { 
            // create fruit from xml node with validation here 
    }
} 
```

这样，“水果”就不会真正与存储相关联。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-04T00:22:36.303

我会选择常数。这是一个多*一点*的工作，但没有性能影响。即使您通常复制/粘贴这些值，我也确实遇到过我在键入时更改代码并且没有意识到 Visual Studio 具有焦点的情况。我*更*喜欢这些导致编译错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-04T00:24:05.660

对于给出的示例，其中字符串用作映射或字典的键，我倾向于使用`enum`（或其他对象）来代替。与使用常量字符串相比，使用枚举通常可以做更多的事情。此外，如果某些代码被注释掉了，IDE 在进行重构时经常会错过它。此外，注释中对 String 常量的引用可能包含在重构中，也可能不包含在重构中。

当字符串将在多个位置使用时，我将为字符串创建一个常量，字符串很长或很复杂（例如正则表达式），或者当一个正确命名的常量会使代码更明显时。

我更喜欢我的拼写错误、不完整的重构和其他此类错误无法编译，而不是无法正常运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-04T20:36:42.673

像许多其他重构一样，它可以说是一个可选的附加步骤，它使您的代码维护风险较小，并且更容易被“下一个人”理解。如果您处于奖励那种事情的情况（我正在做的大部分事情），那就去做吧。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-12-16T17:57:47.727

是的，差不多。

我认为静态类型语言的开发人员对任何动态的东西都有一种不健康的恐惧。几乎动态类型语言中的每一行代码实际上都是字符串文字，而且它们多年来一直很好。例如，在 JavaScript 技术上是这样的：

```
var x = myObject.prop1.prop2; 
```

相当于这个：

```
var x = window["myObject"]["prop1"]["prop2"]; // assuming global scope 
```

但这样做绝对*不是*JavaScript 的标准做法：

```
var OBJ_NAME = "myObject";
var PROP1_NAME = "prop1";
var PROP2_NAME = "prop2";

var x = window[OBJ_NAME][PROP1_NAME][PROP2_NAME]; 
```

那将是荒谬的。

尽管如此，它仍然取决于，比如如果一个字符串在很多地方使用并且输入起来相当麻烦/丑陋（“name”与“my-custom-property-name-x”），那么它可能值得制作一个常量，即使在单个类中（此时最好在类中保持内部一致并使所有其他字符串也成为常量）。

此外，如果您确实打算让其他外部用户使用这些常量与您的库进行交互，那么定义可公开访问的常量并记录用户应该使用这些常量与您的库进行交互也是一个好主意。但是，通过魔术字符串常量进行交互的库通常是一种不好的做法，您应该考虑以一种不需要使用魔术常量与之交互的方式来设计您的库。

我认为在您给出的具体示例中，字符串的键入相对简单，并且可能没有您的 API 的外部用户希望使用这些字符串值来使用它（即它们仅用于内部数据操作），可读代码比可重构代码更有价值，所以我只会将文字直接内联。同样，这是假设我具体了解您的确切用例。

似乎没有人注意到的一件事是，一旦您定义了一个常量，它的范围就变成了需要维护和思考的东西。这实际上*是*有代价的，它不像每个人都认为的那样免费。考虑一下：

在我的课堂上应该是私有的还是公开的？如果其他命名空间/包需要相同的值怎么办，我现在应该将常量提取到某个全局静态常量类吗？如果我现在在其他程序集/模块中需要它，我应该进一步提取它吗？所有这些都使代码的可读性越来越差，更难维护，使用起来更不愉快，而且更复杂。一切都是为了可重构性？

通常，这些“伟大的重构”永远不会发生，当它们发生时，无论如何都需要使用所有新字符串进行完全重写。如果你在这个伟大的重构之前使用了一些共享模块（如上一段），它没有你现在需要的这些新字符串，那么怎么办？您是否将它们添加到相同的常量共享模块中（如果您无权访问此共享模块的代码怎么办）？还是您将它们保留在本地，在这种情况下，现在有多个分散的字符串常量存储库，都在不同的级别，冒着代码中重复常量的风险？一旦你达到了这一点（相信我，我已经看到了），重构就变得没有意义了，因为虽然你会得到*你**的*常量的所有用法，但你'*人们*对其*常量的使用，即使这些常量与您的常量具有相同的逻辑值，并且您实际上是在尝试更改所有这些常量。*

 *# linux - 如何让 cp 命令创建任何必要的文件夹以将文件复制到目标

> ID：947954
> 
> 赞同：524
> 
> 时间：2009-06-04T00:11:41.257
> 
> 标签：linux, bash, cp

将文件复制`cp`到可能存在或不存在的文件夹时，如果需要，如何`cp`创建文件夹？这是我尝试过的：

```
[root@file nutch-0.9]# cp -f urls-resume /nosuchdirectory/hi.txt
cp: cannot create regular file `/nosuchdirectory/hi.txt': No such file or directory 
```

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2012-12-29T19:24:50.433

为了扩展[克里斯蒂安的答案](https://stackoverflow.com/a/947969/4298200)，唯一可靠的方法是结合`mkdir`和`cp`：

```
mkdir -p /foo/bar && cp myfile "$_" 
```

顺便说一句，当您只需要在现有层次结构中创建单个目录时，`rsync`可以在一个操作中完成。事实上，我非常喜欢`rsync`一个更通用的`cp`替代品：

```
rsync -a myfile /foo/bar/ # works if /foo exists but /foo/bar doesn't.  bar is created. 
```

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2009-06-04T00:15:52.107

我不知道你可以用cp做到这一点。

你可以用 mkdir ..

```
mkdir -p /var/path/to/your/dir 
```

**编辑** 请参阅 lhunath 的合并 cp 的[答案](https://stackoverflow.com/a/14085147/102616)。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2014-02-09T15:22:16.207

```
 mkdir -p `dirname /nosuchdirectory/hi.txt` && cp -r urls-resume /nosuchdirectory/hi.txt 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2012-11-14T18:34:42.433

也可以使用命令`find`：

```
find ./ -depth -print | cpio -pvd newdirpathname 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-06-04T00:16:46.533

没有这样的选择。您可以做的是在复制文件之前运行*mkdir -p*

我制作了一个*非常酷*的脚本，您可以使用它来将文件复制到不存在的位置

```
#!/bin/bash
if [ ! -d "$2" ]; then
    mkdir -p "$2"
fi
cp -R "$1" "$2" 
```

现在只需保存它，授予它权限并使用它运行它

```
./cp-improved SOURCE DEST 
```

我放了 -R 选项，但它只是一个草稿，我知道它可以，你会在很多方面改进它。希望对你有帮助

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-05-23T05:59:19.037

rsync 是工作！

```
#file:
rsync -aqz _vimrc ~/.vimrc

#directory:
rsync -aqz _vim/ ~/.vim 
```

* * *

## 回答 #7

> 赞同：-8
> 
> 时间：2013-03-29T16:07:08.800

```
cp -Rvn /source/path/* /destination/path/
cp: /destination/path/any.zip: No such file or directory 
```

如果路径中有源文件，它将在目标中不创建现有路径。这不会创建空目录。

刚才我看到 xxxxxxxx：没有这样的文件或目录，因为我的可用空间用完了。没有错误信息。

同上：

```
ditto -V /source/path/* /destination/path
ditto: /destination/path/any.zip: No space left on device 
```

一旦释放空间`cp -Rvn /source/path/* /destination/path/`按预期工作

# svn - Media Temple DV上的多域颠覆部署

> ID：947960
> 
> 赞同：0
> 
> 时间：2009-06-04T00:12:58.367
> 
> 标签：svn, dns, symlink, vhosts, mediatemple

这是一个非常特定于 Media Temple DV 服务器的问题，但我希望有人能提供帮助。我们在 DV 服务器上的部署过程包括 ssh'ing 并在名为“svn”的文件夹中执行 Subversion 签出，然后在“httpdocs”中创建一个符号链接以指向该“svn”文件夹中的发布文件夹。我想知道是否可以在指向同一文件夹的*单独域上创建一个符号链接（本质上，两个站点共享一个代码库但具有不同的 httpdocs）。*看起来像：

```
/vhosts
    /my-domain/
        /httpdocs (symlink points to svn)
        /svn
    /my-other-domain
        /httpdocs (symlink points to svn in my-domain) 
```

这在任何情况下都可能吗？如果是，是否可以在 Media Temple DV 服务器上使用？我似乎无法让它工作（在上面的例子中，我可以让“我的域”正常工作，但不能做“跨域”符号链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T00:27:40.350

你应该能够做到这一点。您是否符号链接到完整路径？(/var/www/vhosts/my-domain/svn/ ... ) 你遇到了什么错误？

为什么不将 SVN 签出到单独的目录（/var/www/vhosts/svn），然后进行符号链接呢？(ln -s /var/www/vhosts/svn/文件夹/var/www/vhosts/my-domain/httpdocs)

在我的 MT DV 上，我有多个域从中央目录中提取相同的核心 PHP 库。为此，我必须在 vhost.conf 中设置 openbasedir 指令，并使用包含的库的完整路径。

# c# - 如何在 ASP.NET 中动态创建新的超链接？

> ID：947973
> 
> 赞同：4
> 
> 时间：2009-06-04T00:16:57.783
> 
> 标签：c#, .net, asp.net, visual-studio, hyperlink

我将解释我想要实现的目标：

我希望有一种情况，我可以通过在后面的代码中循环创建控件来创建任意数量的控件。我可以在使用 PHP 时通过混合 PHP 代码和 HTML 代码来做到这一点。这允许我动态生成实际的 HTML 标签。

在 ASP.NET 中，我还没有找到复制此功能的方法。

我曾考虑在 Init() 函数之类的代码后面使用循环来创建 new() 对象数组，设置它们的属性并希望将其传递到 aspx 文件中，但它没有用。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-04T04:54:36.033

如果您想动态创建 ASP.Net 超链接控件，您可以简单地执行以下操作：

```
HyperLink hyp = new HyperLink();
    hyp.ID = "hypABD";
    hyp.NavigateUrl = "";
    Page.Controls.Add(hyp); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-04T00:22:51.343

好吧，请记住 ASP.Net 中的超链接和链接按钮之间存在区别

如果您只想要超链接，您可以通过创建 HyperLink 对象、创建新对象然后将它们添加到某些控件的控件集合（如面板或跨度等）来创建任意数量的对象。

LinkBut​​tons 有点不同。如果要创建回发到服务器的链接，则必须使用中继器控件。（好吧，您不必这样做，但另一种选择是黑客工作。）

也可以使用 Repeater 控件创建超链接，如果可能的话，我会推荐这种方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-04T00:24:58.407

在 asp.net中有*很多*方法可以做到这一点：

1.  如果你真的想要，你可以将使用`<% %>`标签的循环直接放入 aspx 标记中，就像使用 php 或经典 asp 一样。*不*建议这样做。
2.  您可以在表单上放置一个占位符或面板控件，在后面的代码中创建任意数量的超链接控件或锚标记，并将它们添加到占位符的控件集合中。这稍微好一点，但仍然不是最佳的。
3.  您可以在页面上放置合理数量的超链接控件，将其`visible`属性默认设置为 false，并“启用”您需要的超链接控件。这比 #2 更受欢迎，因为 asp.net 页面生命周期有些奇怪。
4.  这些链接来自*某个地方*，而那个地方通常是数据库或其他合理的数据源。所以让它成为数据驱动的——将该数据源绑定到一个控件，如转发器、网格视图、详细信息视图或类似的。这可能是您最好的选择。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-04T00:31:21.980

如果您想动态生成控件并且不需要将这些回发到服务器（即当单击/更改控件时，它将返回到同一页面） - 您可以使用**System.Web.UI 中的控件。 HtmlControls**命名空间。

例如

```
HtmlAnchor link = new HtmlAnchor();
link.href = "www.stackoverflow.com";
Page.Controls.Add(link);
```

希望这能给你足够的背景。

编辑：您可以在循环中使用上述代码并将固定值替换为来自数据库/对象的值。

# mysql - 如何处理数据以避免 MySQL“不正确的字符串值”错误？

> ID：947975
> 
> 赞同：4
> 
> 时间：2009-06-04T00:17:14.800
> 
> 标签：mysql, ruby-on-rails, ruby, encoding, character-encoding

我正在尝试使用 Rake 任务将一些遗留数据从 MS Access 迁移到 MySQL。我正在使用 Ruby 1.8.6 在 Windows XP 上工作。

我将 Rails 的编码设置为“utf8” `database.yml`。

此外，MySQL 的默认字符集是 utf8。

99% 的数据都很好，但我会时不时地得到一个列值，它会给我一个类似这样的错误：

```
Mysql::Error: Incorrect string value: '\x92 Comm...' for column 'name' 
  at row 1: 
  INSERT INTO `organizations` ( [...] ) 
  VALUES('Lawyers’ Committee', [...] ) 
```

看起来给 MySQL 带来麻烦的东西是紧跟在“Lawyers”一词中的“s”之后的撇号。

这是另一个...

```
Mysql::Error: Incorrect string value: '\x99 aoc' for column 'department' 
  at row 1: 
  INSERT INTO `addresses` 
[...]
  'TRInfo™ aoc'
[....] 
```

看起来它在“TRInfo”之后在“TM”上窒息。

是否有任何 Ruby 或 Rails 方法可以让我运行数据以清除 MySQL 会阻塞的任何字符？

理想情况下，最好用更可口的字符替换它们——用单引号替换撇号，用字符串“(TM)”替换 TM 符号。

或者，如果我能以某种方式配置 MySQL 以按原样存储这些字符而不会出现错误，那也很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-04T02:37:10.807

看起来您的输入数据不在 utf-8 中。

我做了一些调查，Lawyer's 中使用的样式引用在 Windows-1252 编码中被编码为 \x92，但对于 utf-8 来说是无意义的（当我将其解码并将其编码为 utf8 时，我得到了 \xe2\x80\ x99)。

因此，您需要将输入字符串从 windows-1252 转换为 utf-8（或 unicode）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-30T15:39:41.957

将 UTF-16 编码文件的内容（通常每个 16 位块存储一个字符）放入 mysql 表时，我遇到了同样的问题。问题在于 UTF-16 编码的字符串包含所谓的*代理对*。这意味着两个连续的 16 位 UTF-16 块编码一个特殊字符，但不能单独转换为相应的 UTF-8 编码。请参阅[维基百科](http://en.wikipedia.org/wiki/UTF-16/UCS-2)以获取更多说明。

解决方案是简单地用空格替换这些字符。这是您可能希望从字符串中删除的字符范围：U+D800–U+DFFF

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T13:12:34.063

通常，当您将字符串插入编码/排序规则不兼容的列时，就会发生这种情况。

当我有 TRIGGER 时出现此错误，由于某种原因它继承了服务器的排序规则。mysql 的默认值是（至少在 Ubuntu 上）带有瑞典排序规则的 latin-1。即使我将数据库和所有表都设置为 UTF-8，我还没有设置`my.cnf`：

/etc/mysql/my.cnf ：

```
[mysqld]
character-set-server=utf8
default-character-set=utf8 
```

这必须列出所有带有 utf8-* 的触发器：

```
select TRIGGER_SCHEMA, TRIGGER_NAME, CHARACTER_SET_CLIENT, COLLATION_CONNECTION, DATABASE_COLLATION from information_schema.TRIGGERS 
```

并且这里列出的一些变量也应该有 utf-8-* （没有 latin-1 或其他编码）：

```
show variables like 'char%'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T00:33:24.160

看起来您的旧数据库是一种字符串格式（utf8？），而您的 rails 正在期待其他东西。如果您输入的是 utf8，您是否尝试过[配置您的 rails 以支持它？](http://blog.dotkam.com/2008/09/14/configure-rails-and-mysql-to-support-utf-8/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-25T16:54:43.580

```
我今天遇到了同样的问题。
经过多次尝试，我终于找到了原因并修复了它。
对于使用默认 MySQL 字符集和排序规则（latin1、latin1_swedish_ci）存储数据的应用程序，因此您需要在创建数据库或表时将字符集和排序规则指定为 utf8/utf8_general_ci。
例如：
        $sql = "创建表" 。$table_name 。" (
        id mediumint(9) NOT NULL AUTO_INCREMENT,
        书名 varchar(128) NOT NULL,
        作者 varchar(64) NOT NULL,
        主键（id），
        KEY（书名）
        )字符集 utf8 整理 utf8_general_ci;";

参考：
《mysql建表问题？解决了！！！！！！！！！！！”
http://forums.mysql.com/read.php?121,193883,193883
《10.1.5\. 为应用程序配置字符集和排序规则》
http://dev.mysql.com/doc/refman/5.0/en/charset-applications.html

希望这可以帮助你。

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-23T18:57:15.793

在怪异列之前添加二进制可以解决问题。

就我而言，我在 tableA 上有一个更新触发器，可以将数据插入到其他表中。列怪异列中有一些特殊字符，更新失败并显示消息：“ERROR 1366 (HY000): Incorrect string value: '\xE7....'”

在我挖了很多之后，我通过在字符串列名之前添加二进制，或者使用 cast(weirdcolumn as binary); 找到了解决方案。

希望这能有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-27T16:41:16.953

我在使用 PHP 将数据从 SQL Server 导入 MySql 时遇到了同样的问题。我的解决方案是`utf8_encode()`插入 MySql 并`utf8_decode()`在从 MySql 检索以显示到浏览器时使用。在这里，您有我的完整代码，效果很好。

```
//For string values
$Gro2=(is_null($row["GrpNm"]))?"NULL":"\"".mysql_escape_string(utf8_encode($row["GrpNm"]))."\"";

$sqlMy ="INSERT INTO `tbl_name` VALUES ($Gro2)"; 
```

请注意：对于新项目，请使用

```
mysqli_escape_string() 
```

[关联](http://php.net/manual/en/function.mysql-escape-string.php)

# amazon-s3 - S3 GET 没有签名（明文可能？）

> ID：947990
> 
> 赞同：0
> 
> 时间：2009-06-04T00:21:55.137
> 
> 标签：amazon-s3, amazon-web-services, amazon

有没有办法通过发送明文 Accesskey:Secret 而不是签名/HMAC 从 Amazon S3 获取对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T00:26:37.917

除非 ACL 设置为匿名读取访问，否则不会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-14T05:23:10.173

另一种选择是对您的 URL 使用 Amazon S3 查询字符串身份验证。大多数 Amazon S3 客户端都可以生成它。

您还可以使用[S3fm](http://s3.amazonaws.com/s3fm/index.html)，它是 Amazon S3 的在线文件管理器。只需在上下文菜单中选择 Web URL 并生成一个带有到期日期的 URL。

# c# - 在多次写入文件时获取 IOException

> ID：947995
> 
> 赞同：0
> 
> 时间：2009-06-04T00:22:58.627
> 
> 标签：c#, csv, ioexception

我已经实现了一个 csv 文件构建器，它接收一个 xml 文档，对其应用 xsl 转换并将其附加到一个文件中。

```
public class CsvBatchPrinter : BaseBatchPrinter
{
    public CsvBatchPrinter() : base(".csv")
    {
        RemoveDiatrics = false;
    }

    protected override void PrintDocuments(System.Collections.Generic.List<XmlDocument> documents, string xsltFileName, string directory, string tempImageDirectory)
    {
        base.PrintDocuments(documents, xsltFileName, directory, tempImageDirectory);

        foreach (var file in new DirectoryInfo(tempImageDirectory).GetFiles())
        {
            var destination = directory + file.Name;
            if (!File.Exists(destination))
                file.CopyTo(destination);
        }
    }

    protected override void PrintDocument(XmlDocument document, string xsltFileName, string directory, string tempImageDirectory)
    {
        StringUtils.EscapeQuotesInXmlNode(document);
        if (RemoveDiatrics)
        {
            var docXml = StringUtils.RemoveDiatrics(document.OuterXml);
            document = new XmlDocument();
            document.LoadXml(docXml);
        }

        using (var writer = new StreamWriter(string.Format("{0}{1}{2}", directory, "batch", FileExtension), true, Encoding.ASCII))
        {
            Transform(document, xsltFileName, writer);
        }
    }

    public bool RemoveDiatrics { get; set; }
} 
```

我有大量的 xml 文档要添加到这个 csv 文件中，在多次调用它之后，它偶尔会抛出一个 IOException`The process cannot access the file 'batch.csv' because it is being used by another process.`

这会是某种锁定问题吗？

是否可以通过以下方式解决：

```
lock(this)
{
    using (var writer = new StreamWriter(string.Format("{0}{1}{2}", directory, "batch", FileExtension), true, Encoding.ASCII))
    {
        Transform(document, xsltFileName, writer);
    }
} 
```

**编辑：**

这是我的堆栈跟踪：

```
at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy)
at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)
at System.IO.StreamWriter.CreateFile(String path, Boolean append)
at System.IO.StreamWriter..ctor(String path, Boolean append, Encoding encoding, Int32 bufferSize)
at System.IO.StreamWriter..ctor(String path, Boolean append, Encoding encoding)
at Receipts.Facade.Utilities.BatchPrinters.CsvBatchPrinter.PrintDocument(XmlDocument document, String xsltFileName, String directory, String tempImageDirectory) in CsvBatchPrinter.cs:line 37
at Receipts.Facade.Utilities.BatchPrinters.BaseBatchPrinter.PrintDocuments(List`1 documents, String xsltFileName, String directory, String tempImageDirectory) in BaseBatchPrinter.cs:line 30
at Receipts.Facade.Utilities.BatchPrinters.CsvBatchPrinter.PrintDocuments(List`1 documents, String xsltFileName, String directory, String tempImageDirectory) in CsvBatchPrinter.cs:line 17
at Receipts.Facade.Utilities.BatchPrinters.BaseBatchPrinter.Print(List`1 documents, String xsltFileName, String destinationDirectory, String tempImageDirectory) in BaseBatchPrinter.cs:line 23
at Receipts.Facade.Modules.FinanceDocuments.FinanceDocumentActuator`2.printXmlFiles(List`1 xmlDocuments, String tempImagesDirectory) in FinanceDocumentActuator.cs:line 137 
```

和我的基类：

```
public abstract class BaseBatchPrinter : IBatchPrinter
{
    private static readonly ILog Log = LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);
    protected readonly string FileExtension;

    protected BaseBatchPrinter(string fileExtension)
    {
        FileExtension = fileExtension;
    }

    public void Print(List<XmlDocument> documents, string xsltFileName, string destinationDirectory, string tempImageDirectory)
    {
        Log.InfoFormat("Printing to directory: {0}", destinationDirectory);
        PrintDocuments(documents, xsltFileName, destinationDirectory, tempImageDirectory);
    }

    protected virtual void PrintDocuments(List<XmlDocument> documents, string xsltFileName, string directory, string tempImageDirectory)
    {
        foreach (var document in documents)
        {
            PrintDocument(document, xsltFileName, directory, tempImageDirectory);
        }
    }

    /// <summary>
    /// Needs to Call Transform(XmlDocument document, string xsltFileName, string directory)
    /// </summary>
    protected abstract void PrintDocument(XmlDocument document, string xsltFileName, string directory, string tempImageDirectory);

    protected void Transform(XmlDocument document, string xsltFileName, StreamWriter writer)
    {
        //TODO: look into XslCompiledTransform to replace the XslTransform
        var xslTransform = new XslTransform();
        xslTransform.Load(xsltFileName);
        xslTransform.Transform(createNavigator(document), null, writer);
    }

    protected string CreateFileName(string directory, XmlDocument doc)
    {
        var conId = createNavigator(doc).SelectSingleNode(Config.SELECT_CONSTITUENT_ID_XPATH).Value;
        return string.Format(@"{0}{1}{2}", directory, conId, FileExtension.IndexOf('.') > -1 ? FileExtension : "." + FileExtension);
    }

    protected XPathNavigator createNavigator(XmlDocument document)
    {
        return document.DocumentElement == null ? document.CreateNavigator() : document.DocumentElement.CreateNavigator();
    }
} 
```

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T00:31:44.617

只有一件事会导致这种情况。另一个进程正在写入文件。另一个过程甚至可以是你自己的。

我建议您在可以写入该文件的区域周围添加 try/catch 块。在 catch 块中，抛出一个新异常，添加完整的文件路径：

```
var filePath = string.Format("{0}{1}{2}", directory, "batch", FileExtension);
try {
    using (var writer = new StreamWriter(filepath, true, Encoding.ASCII)) {
        Transform(...);
    }
}
catch (IOException ex) {
    throw new Exception(
        String.Format("Exception while transforming file {0}", filePath),
        ex);
} 
```

发布您收到的完整异常，包括任何 InnerException 和堆栈跟踪。

您还想确定您的文件副本是否甚至可以写入 batch.csv。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T12:54:39.443

如果您愿意，不妨尝试对代码进行以下修改，以帮助更多地找出故障，而不是作为永久性修复。

为打印文档添加一个重载，该文档采用 StreamWriter 参数。修改 base.PrintDocuments 如下：

```
using ( var writer = new StreamWriter ( string.Format ( "{0}{1}{2}", directory, "batch", FileExtension ), true, Encoding.ASCII ) )
{
    foreach ( var document in documents )
    {
        PrintDocument ( document, xsltFileName, directory, tempImageDirectory, writer );
    }
}

protected override void PrintDocument ( XmlDocument document, string xsltFileName, string directory, string tempImageDirectory, StreamWriter writer )
{
    if ( RemoveDiatrics )
    {
        var docXml = document.OuterXml;
        document = new XmlDocument ( );
        document.LoadXml ( docXml );
    }

   Transform ( document, xsltFileName, writer );        
} 
```

如果这失败了......总是悲观主义者......我会将Transform视为可能的罪魁祸首，尽管我知道它对TextWriter没有任何作用，除了，好吧，用它写。无论如何，如果您有时间，请尝试一下，创建一次作家可能是解决方案（快速修复），让我们知道它是否有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T23:07:02.900

嘿，谢谢你的回复。

我想出了一个适合我的解决方案。有点hacky，但它可以完成工作。

```
protected override void PrintDocument(XmlDocument document, string xsltFileName, string directory, string tempImageDirectory)
{
    StringUtils.EscapeQuotesInXmlNode(document);
if (RemoveDiatrics)
{
    var docXml = StringUtils.RemoveDiatrics(document.OuterXml);
    document = new XmlDocument();
    document.LoadXml(docXml);
}

IOException ex = null;
for (var attempts = 0; attempts < 10; attempts++)
{
    ex = tryWriteToFile(document, directory, xsltFileName);
    if (ex == null)
        break;
}

if (ex != null)
    throw new ApplicationException("Cannot write to file", ex);
}

private IOException tryWriteToFile(XmlDocument document, string directory, string xsltFileName)
{
try
{
    using (var writer = new StreamWriter(new FileStream(string.Format("{0}{1}{2}", directory, "batch", FileExtension), FileMode.Append, FileAccess.Write, FileShare.Read), Encoding.ASCII))
    {
        Transform(document, xsltFileName, writer);
    writer.Close();
    }
    return null;
}
catch (IOException e)
{
    return e;
}
} 
```

基本上它背后的想法是尝试运行它几次，如果问题仍然存在，则抛出错误。

让我解决问题

# f# - 带参数约束的 F# 函数

> ID：947997
> 
> 赞同：1
> 
> 时间：2009-06-04T00:23:23.073
> 
> 标签：f#

我遇到了一个类似于hubfs 上的[这个](http://cs.hubfs.net/forums/thread/7824.aspx)论坛帖子的错误，它解决了我的问题，但引发了一些关于该线程中代码的问题。

```
让测试 x = printfn "n"
让 finall x = x : 'a -> 单位
让 ix = finall 测试 x

```

有人可以向我解释第 2 行正在完成什么吗？我看到的类型`finall`是

```
finall: ('a -> unit) -> ('a -> unit)
```

所以它只是一个接受一个函数并返回该函数的函数。执行第 2 行和第 3 行的原因是什么？你以后可以定义一个函数体`finall`吗？看来您不必在第三行加上括号，这是第 2 行的结果吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T00:33:03.663

是的，该线程上的代码没有多大意义。'finall' 基本上是恒等函数（让 id x = x），除了它将其参数限制为函数返回单元而不是某个任意值。基本上它没有做任何有用的事情，你可以很容易地写

```
let test x = printfn "n"
let i x = test x 
```

我希望这个片段可能来自一个人，他从一个他们不理解的错误消息开始，并试图将其剥离为一个微小的样本再现。

（关于函数调用，在 F# 中调用 let-bound 函数永远不需要括号：

```
f x 
```

是一个调用，函数应用程序以正常的方式工作以支持柯里化，这意味着

```
f x y 
```

方法

```
(f x) y 
```

这就是“finall test x”行上发生的事情。）*``********