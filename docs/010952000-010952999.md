# StackOverflow 问答 10952000-10952999

# oracle - 如何在 Oracle SQL Developer 中创建重复连接

> ID：10952003
> 
> 赞同：7
> 
> 时间：2012-06-08T15:43:43.443
> 
> 标签：oracle, oracle-sqldeveloper

在 SQL Developer 中，没有基于现有连接创建连接的命令，只需更改一些连接属性，如用户名和密码。编辑-> 复制被禁用。那么如何做到这一点呢？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-08T15:43:44.080

1.  单击“连接”选项卡中的绿色 + 按钮。
2.  选择要复制的连接
3.  只需编辑连接的名称。如果您按照以下步骤操作，这不会重命名连接，而是会创建一个新连接。
4.  根据需要编辑其他连接参数。
5.  单击测试，然后检查在对话框左下角附近隐藏的成功消息。
6.  单击连接

您的新连接现在将被连接。这不是很直观，但它确实有效。

# c# - C# 全局页面变量

> ID：10952012
> 
> 赞同：1
> 
> 时间：2012-06-08T15:44:10.587
> 
> 标签：c#, mysql, variables, web-config, global

我知道如何在 PHP 中执行此操作，但我现在才回到 C#，所以请原谅我。

基本上，我有两个变量 - 名称和电子邮件，需要将它们设置在同一文件夹内的页面之间普遍可访问的位置。显然，一种解决方案是将它们存储在 MySQL 数据库中，但在这种情况下，我只有一个表字段。这似乎……愚蠢。不必要地访问该字段并连接到数据库似乎是多余的，因为我确信还有另一种更好的方法可以做到这一点。

你可以在 C# 的范围内更改 web.config 变量而不写对 web.config 的支持吗？还有另一种方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:45:56.907

您可能想查看该[`Global.asax`文件](http://msdn.microsoft.com/en-us/library/1xaas8a2%28v=vs.71%29.aspx)。您可以将会话和应用程序范围的变量添加到此对象的成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:08:43.977

不，您不能更改 web.config 变量而不能更改 web.config 文件。无论如何，这是一个坏主意，因为对 web.config 的更改将导致您的 Web 应用程序重新启动。

有一些选项可以将信息保存在不同的范围级别。

1.  将信息存储在 Session 中（参见[HttpContext.Session Property](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.session.aspx)、[HttpSessionState.Item Property (String)](http://msdn.microsoft.com/en-us/library/8dhkksh8.aspx)、[Page.Session Property](http://msdn.microsoft.com/en-us/library/system.web.ui.page.session.aspx)）。这些项目是每个用户的，并且在该用户会话期间是持久的。
2.  将信息存储在缓存中。（请参阅[缓存类](http://msdn.microsoft.com/en-us/library/system.web.caching.cache)）此类项目在应用程序的生命周期内是持久的。
3.  创建一个基类，您的页面从该基类继承并向基类添加属性。

# php - 从给定的参数迭代 PHP 中的 IP

> ID：10952022
> 
> 赞同：0
> 
> 时间：2012-06-08T15:44:33.630
> 
> 标签：php, ip, iteration

我有以下代码：

```
$ipgiven = $argv[1];
//REGEX PATTERNS
$patternone = "/^\d{1,3}\.$/";
$patterntwo = "/\d{1,3}\.\d{1,3}\./";
$patternthree = "/\d{1,3}\.\d{1,3}\.\d{1,3}\./";

if(preg_match($patternthree, $ipgiven)){
echo "found depth of 3\r\n";
while($i!=255){
$ipo = $ipgiven . $i;

while($j!=255){
$ipd = $ipo . $j;

while($k!=255){
$ipt = $ipd . $k;
$checkme = $prefix . $ipt . $find;
checkurl($checkme);
$k++;
}

$j++;
}

$i++;
}
}

if(preg_match($patterntwo, $ipgiven)){
echo "found depth of 2\r\n";
while($i!=255){
$ipo = $ipgiven . $i;

while($j!=255){
$ipd = $ipo . $j;
$checkme = $prefix . $ipd . $find;
checkurl($checkme);
$j++;
}

$i++;
}
}

if(preg_match($patternone, $ipgiven)){
echo "found depth of 1\r\n";
while($i!=255){
$ipo = $ipgiven . $i;
$checkme = $prefix . $ipo . $find;
checkurl($checkme);
$i++;
}
} 
```

如果某个目录存在，我想用它来检查 iprange。我已经制定了 curl 代码，但是我缺少的是我的 IP 生成算法。

我想通过以下方式调用脚本：php script.php 1.2.3。

然后脚本将遍历 1.2.3.1 -> 1.2.3.255 这可行，但是调用：php script.php 1.2。只进行 1.2.1 -> 1.2.255 的交互，这并不是真正的 iprange，这有点破坏我的程序。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:16:46.273

我冒昧地修改了您的代码：

```
function scan_ips($ip) {

  $depth = preg_match_all('/\d{1,3}\./', $ip, $m);

  for($i=1; $i<=255; $i++) {
    if($depth < 3) {
      scan_ips($ip."$i.");
    } else {
      checkurl($ip.$i);
    }
  }
}

scan_ips($argv[1]); 
```

这应该可以按您的预期工作。

### 编辑

这个怎么运作：

```
$depth = preg_match_all('/\d{1,3}\./', $ip, $m) 
```

返回在 ip 中被找到的次数`\d{1,3}\.`，当前深度。

```
if($depth < 3) 
```

如果深度已经是3，我们只需要再增加一个数字就可以生成一个有效的ip。如果不是，我们需要添加更多数字。这些数字是通过递归调用添加的：

```
scan_ips($ip."$i."); 
```

这会再次调用相同的函数，但使用的 ip 长一个数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:19:53.573

用法：`php ips.php 253.168.11.2 253.168.11.3`。适用于任何范围，包括 1.1.1.1 到 2.3.1.255。

```
<?php
if(!isset($argv[1]) || !isset($argv[2]))
{
    echo PHP_EOL."Invalid usage. Valid usage example: php ips.php 253.168.0.1 253.168.11.255".PHP_EOL;
    exit(1);
}
if(
    !filter_var($argv[1], FILTER_VALIDATE_IP, FILTER_FLAG_IPV4)
    || !filter_var($argv[2], FILTER_VALIDATE_IP, FILTER_FLAG_IPV4)
)
{
    echo PHP_EOL."Invalid IPv4 dotted format. Valid usage example: php ips.php 192.168.0.1 192.168.11.255".PHP_EOL;
    exit(1);
}

//IPv4 addresses are 32bit unsigned and the PHP integer is 32bit signed. 
//Because IPs greater than 0x7fffffff cannot be represented using int, string + BC Math functions are used instead of int + normal math operators.

//get string representation of unsigned integer
$strIPv4Start=sprintf("%u", ip2long($argv[1]));
$strIPv4End=sprintf("%u", ip2long($argv[2]));
$strIPv4Current=$strIPv4Start;

while(bccomp($strIPv4Current, $strIPv4End)<=0)
{
    $strIPv4Current=bcadd($strIPv4Current, "1");

    echo long2ip($strIPv4Current).PHP_EOL;
} 
```

# javascript - 将 InfoWindows 放置在 Google 地图标记上的问题

> ID：10952024
> 
> 赞同：0
> 
> 时间：2012-06-08T15:44:45.750
> 
> 标签：javascript, google-maps, google-maps-api-3

我正在尝试使用 JSON 在 Google 地图上放置多个标记，并将 InfoWindows 绑定到每个标记。不幸的是，只出现了一个标记，即 JSON 中的最后一个值。不会显示其他标记，并且漫画气球样式的箭头不会出现在信息窗口的尾部。已经尝试了很长时间来解决这个问题，但似乎没有任何效果。

这是代码：

```
var stories = {{story_Json|safe}};

var map;

function loadMarkers(stories){
    for (i=0;i<stories.length;i++) {
        var story = stories[i];
        var point = new google.maps.LatLng(story.latitude, story.longitude);
        var marker = new google.maps.Marker({position: point, map: map});
        var infowindow = new google.maps.InfoWindow({
            content: '<div >'+
                '<div >'+
                '</div>'+
                '<h2 class="firstHeading">'+story.headline+'</h2>'+
                '<div>'+
                '<p>'+story.copy+'</p>'+

                '</div>'+
                '</div>'

        });
        google.maps.event.addListener(marker, 'click', function() {
          infowindow.open(map,marker);
        });

    }
}

 function mainMap(position)
 {
       // Define the coordinates as a Google Maps LatLng Object
       var coords = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);

       // Prepare the map options
       var mapOptions =
      {
                  zoom: 15,
                  center: coords,
                  mapTypeControl: false,
                  navigationControlOptions: {style: google.maps.NavigationControlStyle.SMALL},
                  mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        // Create the map, and place it in the map_canvas div
        map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

        // Place the initial marker
        var marker = new google.maps.Marker({
                  position: coords,
                  map: map,
                  title: "Your current location!"
        });

        loadMarkers(stories);

    } 
```

对这些问题的任何见解都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:16:09.423

InfoWindow 使用 i 的最后一个值保持引用（因为循环结束，我们看到 JSON 的最后一个值）。这与 Javascript 中的函数作用域而不是块作用域有关。

获得所需结果的一种方法是引入一个新`story`的来引用每个信息窗口的故事的每个值。这可以通过一个新的匿名函数作用域来完成：

```
function loadMarkers(stories){
    for (i=0;i<stories.length;i++) {
        var story = stories[i];

        (function(story) {
          var point = new google.maps.LatLng(story.latitude, story.longitude);
          var marker = new google.maps.Marker({position: point, map: map});
          var infowindow = new google.maps.InfoWindow({
            content: '<div >'+
                '<div >'+
                '</div>'+
                '<h2 class="firstHeading">'+story.headline+'</h2>'+
                '<div>'+
                '<p>'+story.copy+'</p>'+

                '</div>'+
                '</div>'

          });
          google.maps.event.addListener(marker, 'click', function() {
            infowindow.open(map,this);
          });
        })(story);
    }
} 
```

忘记了信息窗口箭头，它是否显示不正确，例如模糊或变形？也许这是一个 CSS 的东西，添加这些行可能会对你有所帮助。

```
#map_canvas label { width: auto; display:inline; }
#map_canvas img { max-width: none; max-height: none; } 
```

# jpa - 用于 dev/qa/stage/production 的 JPA 多个持久性单元

> ID：10952032
> 
> 赞同：7
> 
> 时间：2012-06-08T15:45:10.383
> 
> 标签：jpa, eclipselink, persistence.xml

我一直在寻找答案，但找不到任何答案，所以向这个非常合适的社区提出这些问题！

1.  我有一个独立的 Java 应用程序，可以部署在许多环境中：dev、qa、stage、production。因此，每个环境都有自己的数据源/数据库，并且有一些属性文件根据应用程序运行的环境管理不同的属性。因此，在我的 persistence.xml 中，我为 dev 定义了一个持久性单元。在同一个文件中，我还想为其他环境定义持久性单元。这样做时，Eclipse（Indigo - 最新）抱怨如下：**“定义了多个持久性单元 - 只有第一个持久性单元将被识别”。** 我*假设*我所做的是合法的，这是一个 Eclipse 问题.. 任何人都可以确认吗？还，
2.  我假设任何标有 @Entity 注释的实体 bean 都会自动被拾取，而不必像这样在 persistence.xml 文件中显式定义它`<class>com.mycompany.model.MyEntityBean</class>`：如果我在文件中省略了实体类的显式包含，实体 bean（尽管已注释）会引发错误： **“类“com.mycompany.model.MyEntityBean”已映射，但未包含在任何持久性单元中”** 我我假设错了吗？
3.  我的最后一个问题是关于 db 凭据：将我的 db 凭据以纯文本形式放在 persistence.xml 文件中是最佳实践吗？有没有更安全的替代方案？

谢谢社区！

ps - 我使用 EclipseLink 作为 JPA 供应商，这不重要吗？

这是我的 persistence.xml 的示例

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
    <persistence-unit name="Development">
        <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
        <class>com.mycompany.model.MyEntityBean</class>
        <properties>
            <property name="javax.persistence.jdbc.driver" value="com.ibm.db2.jcc.DB2Driver" />
            <property name="javax.persistence.jdbc.url" value="jdbc:db2://xxxxxxx" />
            <property name="javax.persistence.jdbc.password" value="xxxxxx" />
            <property name="javax.persistence.jdbc.user" value="xxxxxxxx" />
        </properties>
    </persistence-unit>
    <persistence-unit name="QA">
        <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
        <class>com.mycompany.model.MyEntityBean</class>
        <properties>
            <property name="javax.persistence.jdbc.driver" value="com.ibm.db2.jcc.DB2Driver" />
            <property name="javax.persistence.jdbc.url" value="jdbc:db2://xxxxxxx" />
            <property name="javax.persistence.jdbc.password" value="xxxxxx" />
            <property name="javax.persistence.jdbc.user" value="xxxxxxxx" />
        </properties>
    </persistence-unit>
</persistence> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T17:31:38.007

1.  “定义了多个持久性单元 - 只有第一个持久性单元将被识别”是 Eclipse (Dali) 问题。您可以从[错误 231527](https://bugs.eclipse.org/bugs/show_bug.cgi?id=231527)中找到有关主题的更多信息。

2.  因为您有独立的 Java SE 应用程序，所以实体应该列在 persistence.xml 中。在规范中，这被阐明如下：

> ```
>  To insure the portability of a Java SE application, it is necessary
>       to explicitly list the managed persistence classes that are included 
>       in the persistence unit using the class element of the persistence.xml 
>       file. 
> ```

1.  如果您不想使用纯文本形式的密码，可以从[EclipseLink 文档](http://wiki.eclipse.org/Configuring_a_Data_Source_Login_%28ELUG%29#Configuring_Password_Encryption)中找到有关替代方案的一些信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-29T22:47:22.447

您可以通过执行以下操作来关闭错误警告。这些说明适用于 Eclipse Luna。

```
Project Properties => JPA => Errors/Warnings 
```

查看`Enable project specific settings`

展开`Project`组

更改`Multiple persistence units defined:`为`Ignore`。

# objective-c - 如何将文件上传到存储在 ios 中我的文档文件夹中的服务器？

> ID：10952034
> 
> 赞同：2
> 
> 时间：2012-06-08T15:45:24.660
> 
> 标签：objective-c, ios

我想上传存储在我的应用程序文档文件夹中的文件（不同格式）。我在选择一行时列出了​​表格视图中的所有文件，我试图上传该行中的文件。这是我的代码

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
 {
   NSString *urlString;
if (indexPath.section == 0)
    {
       fileUrlToUpload = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:documents[indexPath.row] ofType:nil]];
}
else
{
fileUrlToUpload = [self.documentURLs objectAtIndex:indexPath.row];

}
[self setupDocumentControllerWithURL:fileUrlToUpload];

urlString =   [[fileUrlToUpload path] lastPathComponent];
printf("\n the string is :%s",[urlString UTF8String]);
[self publishToServer:urlString]; 

 -(void)publishToServer:(NSString *)str
  {
if([str length] > 0) 
{

    NSString *urlPath=@"";
    urlPath= str;
    NSString *urlString = @"http://162.108.0.8:8080/Path/upload_path.jsp?";
    NSMutableURLRequest *request =[[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];

    NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

    NSMutableData *postBody = [NSMutableData data];

    [postBody appendData:[[NSString stringWithFormat:@"--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    [postBody appendData:[[NSString stringWithString:@"Content-Disposition: form-data; name=\"path\"\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [postBody appendData:[[NSString stringWithString:urlPath] dataUsingEncoding:NSUTF8StringEncoding]];
    [postBody appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];

[postBody appendData:[[NSString stringWithFormat:@"\r\n--%@--",boundary] dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES]];

    [request setHTTPBody:postBody];
     NSLog(@"request ===  %@",request);

    NSData *returnData =nil;
    returnData= [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];

    NSLog(@"returnData ===  %@",returnData);

    NSString * string=[[NSString alloc]initWithData:returnData encoding:NSUTF8StringEncoding];
  } 
```

1）当我试图从模拟器发布文件时，一个空值存储在服务器数据库中，我收到“上传成功”作为响应。
2）当我尝试从设备发布文件时，我什至没有在服务器中获得空值。

请帮我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T16:24:18.083

不确定文件类型，但是我可以上传的图像，顺便说一句，我在这里尝试了所有可能的示例，但没有一个有效（我的 $_FILES 数组为空），所以我必须根据示例构建我自己的并且它有效：

```
- (void) uploadLog :(NSString *) filePath
{
NSData *data = [[NSData alloc] initWithContentsOfFile:filePath];
NSString *urlString =[NSString stringWithFormat:@"http://www.yoursite.com/accept.php"];
// to use please use your real website link.
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
[request setURL:[NSURL URLWithString:urlString]];
[request setHTTPMethod:@"POST"];

NSString *boundary = @"_187934598797439873422234";
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
[request setValue:contentType forHTTPHeaderField: @"Content-Type"];
[request setValue:@"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" forHTTPHeaderField:@"Accept"];
[request setValue:@"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/536.26.14 (KHTML, like Gecko) Version/6.0.1 Safari/536.26.14" forHTTPHeaderField:@"User-Agent"];
[request setValue:@"http://google.com" forHTTPHeaderField:@"Origin"];

NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"Content-Length %d\r\n\r\n", [data length] ] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"picture\"; filename=\"%@.png\"\r\n", @"newfile"] dataUsingEncoding:NSUTF8StringEncoding]];

[body appendData:[@"Content-Type: application/octet-stream\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];

[body appendData:[NSData dataWithData:data]];

[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];

[request setHTTPBody:body];
[request addValue:[NSString stringWithFormat:@"%d", [body length]] forHTTPHeaderField:@"Content-Length"];

NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];
NSLog(@"%@", returnString);
} 
```

这是适用于我的 php 部分（对不起，我不熟悉 jsp）：

```
<?php
    $target_path = "./uploads/";  

    $target_path = $target_path . basename( $_FILES['picture']['name']);  

    if(move_uploaded_file($_FILES['picture']['tmp_name'], $target_path)) {  
    echo "The file ".  basename( $_FILES['picture']['name'])." has been uploaded";  
    } else{  
    echo "There was an error uploading the file, please try again!";  
    } 
 ?> 
```

# c# - ASP.net 菜单 - 如何更改悬停时弹出的图像

> ID：10952039
> 
> 赞同：1
> 
> 时间：2012-06-08T15:45:40.803
> 
> 标签：c#, asp.net, css

我在 ASP.net 菜单中有一个弹出图像设置，用于具有子下拉菜单的菜单项。问题是我希望能够在悬停时更改该图像，并且不确定我是否可以通过 CSS 或 C# 来实现。

带有箭头图像的菜单项：![在此处输入图像描述](../Images/6c0b08cdc38e99a6c8d1b379842c42dc.png)

ASPX 代码：

```
<asp:Menu ID="Menu1" StaticPopOutImageUrl="~/Sites/0/PageLayouts/Images/Horizontal_Main_Arrow.jpg" ItemWrap="false" runat="server" Orientation="Horizontal">
<DataBindings>
    <asp:MenuItemBinding DataMember="MenuItem" TextField="Title" NavigateUrlField="URL" />
</DataBindings>
<StaticMenuStyle CssClass="TopStaticMenuStyle" />
<StaticSelectedStyle CssClass="TopStaticSelectedStyle" />
<StaticMenuItemStyle CssClass="TopStaticMenuItemStyle" />
<DynamicHoverStyle CssClass="TopDynamicHoverStyle" />
<DynamicMenuStyle  CssClass="TopDynamicMenuStyle" />
<DynamicSelectedStyle CssClass="TopDynamicSelectedStyle" />
<DynamicMenuItemStyle CssClass="TopDynamicMenuItemStyle" />
<StaticHoverStyle CssClass="TopStaticHoverStyle" /> 
```

页面来源：

```
<td onmouseover="Menu_HoverStatic(this)"
    onmouseout="Menu_Unhover(this)"
    onkeyup="Menu_Key(event)"
    id="ctl00_ContentPlaceHolder1_ctl00_ctl00_ctl00_Menu1n1">
  <table class="TopStaticMenuItemStyle ctl00_ContentPlaceHolder1_ctl00_ctl00_ctl00_Menu1_4"
         cellpadding="0" cellspacing="0" border="0" width="100%">
    <tr>
      <td style="white-space:nowrap;">
        <a class="ctl00_ContentPlaceHolder1_ctl00_ctl00_ctl00_Menu1_1 TopStaticMenuItemStyle ctl00_ContentPlaceHolder1_ctl00_ctl00_ctl00_Menu1_3"
           href="Home.aspx" target="_self"
           style="border-style:none;font-size:1em;"
         >Our Expertise</a>
      </td>
      <td style="width:0;">
        <img src="../Sites/0/PageLayouts/Images/Horizontal_Main_Arrow.jpg"
             alt="Expand Our Expertise"
             style="border-style:none;vertical-align:middle;" />
      </td>
    </tr>
  </table>
</td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:54:40.917

您可以使用 Javascript 执行此操作 - 只需将以下属性添加到您的 img 标签：

> onmouseover="this.src='../Sites/0/PageLayouts/Images/Horizo​​ntal_Main_Arrow_Highlighted.jpg';"
> 
> onmouseout="this.src='../Sites/0/PageLayouts/Images/Horizo​​ntal_Main_Arrow.jpg';"

（或者你的其他 jpg 是什么！）

# php - 使用递归函数构建多维数组

> ID：10952041
> 
> 赞同：1
> 
> 时间：2012-06-08T15:45:51.277
> 
> 标签：php, mysql, sql, arrays, recursion

**问题：**

我正在尝试使用 MySQL 中的函数和数据构建递归树。然而，结果并不如预期。

**PHP代码：**

```
function buildTree($root, $next = array()) 
{
    // Sanitize input
    $root = (int) $root;

    // Do query
    $query = "SELECT CID, Item, Parent FROM betyg_category WHERE Status = '1' AND Parent = '{$root}'";
    $result = mysql_query($query) or die ('Database Error (' . mysql_errno() . ') ' . mysql_error());

    // Loop results
    while ($row = mysql_fetch_assoc($result)) 
    {
      $next[$row['CID']] = array (
                                'CID' => $row['CID'], 
                                'Item' => $row['Item'], 
                                'Parent' => $row['Parent'], 
                                'Children' => buildTree($row['CID'], $next)
                            );
    }

    // Free mysql result resource
    mysql_free_result($result);

    // Return new array
    return $next;
}

$testTree = buildTree(0);

echo "<xmp>".print_r($testTree, true)."</xmp>"; 
```

**数据库中的表如下所示：**

![在此处输入图像描述](../Images/9ee750fc6f58d2624092f756f633c36e.png)

**我希望数组是这样的：**

```
Array
(
    [1] => Array
    (
        [CID] => 1
        [Item] => Litteratur
        [Parent] => 0
        [Children] => Array
            (
                [2] => Integration av källorna
                [3] => Belysning av egna resultat
                [4] => Referenser
            )

    )

    and so forth..
) 
```

也就是说，对于每个父母=>生孩子，然后转到下一个父母等等。提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:53:58.197

这里不需要递归。事实上，这将是非常低效的，因为您最终会遇到 SELECT N+1 问题。只需按父级排序结果集：

```
$query = "SELECT CID, Item, Parent FROM betyg_category WHERE Status = '1' ORDER BY Parent";
$result = mysql_query($query);

$tree = array();
while($row = mysql_fetch_assoc($result)) {
    if($row['Parent'] == 0) {
        $row['Children'] = array();
        $tree[$row['CID']] = $row;
    } else {
        $tree[$row['Parent']]['Children'][] = $row;
    }
} 
```

这将产生以下内容：

```
Array
(
    [1] => Array
        (
            [CID] => 1
            [Item] => Litteratur
            [Parent] => 0
            [Children] => Array
                (
                    [0] => Array
                        (
                            [CID] => 2
                            [Item] => Integration av källorna
                            [Parent] => 1
                        )

                    [1] => Array
                        (
                            [CID] => 3
                            [Item] => Belysning
                            [Parent] => 1
                        )

                    [2] => Array
                        (
                            [CID] => 4
                            [Item] => Referenser
                            [Parent] => 1
                        )

                )

        )

    [5] => Array
        (
            [CID] => 5
            [Item] => Validitet
            [Parent] => 0
            [Children] => Array
                (
                    [0] => Array
                        (
                            [CID] => 6
                            [Item] => Huvudsyfte
                            [Parent] => 5
                        )

                )

        )

) 
```

如果您只想要每个孩子的名字，请更改，使用`$tree[$row['Parent']]['Children'][] = $row['Item']`; 反而。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:05:26.320

试试这个：

```
$array = array();
while ($row = mysql_fetch_assoc($result)) 
{
    if($row['parent'] == '0')
    {
        $array[$row['parent']] = '';
        $array[$row['parent']]['CID'] = $row['CID'];
        $array[$row['parent']]['Item'] = $row['item'];
        $array[$row['parent']]['Parent'] = $row['parent'];
        $array[$row['parent']]['Children'] = '';

    }
    else
    {
        $array[$row['parent']]['Children'][$row['CID']] = $row['item'];
    }
}
echo "<pre>";
print_r($array); 
```

* * *

首先在您的查询中。`ORDER BY CID ASC` 然后添加

```
$count = array_keys($array);
foreach($count as $arr)
{
    ksort($array[$arr]['Children']);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:27:59.337

所有评论的最终解决方案：

```
$query = "SELECT * FROM betyg_category WHERE Status = '1' ORDER BY CID ASC";
$result = mysql_query($query) or die ('Database Error (' . mysql_errno() . ') ' . mysql_error());

$tree = array();

while($row = mysql_fetch_assoc($result)) 
{
    if($row['Parent'] == 0) 
    {
        $row['Children'] = array();
        $tree[$row['CID']] = array(
                                'CID' => $row['CID'], 
                                'Item' => $row['Item'], 
                                'Parent' => $row['Parent']
                            );
    } 
    else 
    {
        $tree[$row['Parent']]['Children'][$row['CID']] = $row['Item'];
    }
}

$count = array_keys($tree);

foreach ($count as $array)
{
    ksort($tree[$array]['Children']);
}

echo "<xmp>".print_r($tree, true)."</xmp>"; 
```

# facebook - Like 按钮不会触发 edge.create 或 edge.remove

> ID：10952042
> 
> 赞同：1
> 
> 时间：2012-06-08T15:45:53.033
> 
> 标签：facebook, facebook-like

我是一个非常初学者......

单击喜欢按钮时，我无法获取`edge.create`或触发。`edge.remove`我看到其他人也发布了这个问题，回到 2011 年，我看不到任何解决方案。

我的代码如下......

```
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Untitled Document</title>
</head>

<body>
<div id="fb-root"></div>
<script>

(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=XXX";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));

FB.Event.subscribe('edge.create',
    function(response) {
        alert('You liked the URL: ' + response);
    }
);

FB.Event.subscribe('edge.remove',
    function(response) {
        alert('You UNliked the URL: ' + response);
    }
);

</script>
<fb:like href="https://www.facebook.com/XXX" send="true" width="450" show_faces="true"></fb:like>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T17:13:06.900

你只是不耐烦...... :-)

在您的代码中，您无需等待 Facebook SDK 加载，这是以您将其放入代码中的方式异步完成的。因此，当调用 FB.Event.subscribe 时，SDK 还没有初始化，所以就失败了。（它是静默失败，还是您只是忘记查看浏览器错误控制台……？）

将 SDK 加载后的代码放入 window.fbAsyncInit 处理程序中，如下所示：[https ://developers.facebook.com/docs/reference/javascript/](https://developers.facebook.com/docs/reference/javascript/)

# php - PHP getimagesize()：IMAGETYPE 还是 MIME 类型？

> ID：10952044
> 
> 赞同：1
> 
> 时间：2012-06-08T15:45:58.277
> 
> 标签：php, image-processing, getimagesize

我有一个简单的图像大小调整脚本，它适用于 JPEG，但不适用于 GIF 或 PNG。第一步是获取正确的图像类型，以便我可以相应地处理它。

我的问题是：getimagesize() 似乎同时返回 IMAGETYPE 和 MIME 类型...那么我应该使用哪个来确定图像是 JPEG、PNG 还是 GIF？

PHP 为您提供了两种执行此操作的方法，这似乎很奇怪，所以我认为它们各有其指定的用途？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:53:55.010

这主要是为了方便，尽管在某些情况下多个 IMAGETYPE 对应于相同的 MIME 类型。例如`IMAGETYPE_JPC`，`IMAGETYPE_JPX`和`IMAGETYPE_JB2`都具有 MIME 类型`application/octet-stream`。

要确定图像是 JPEG、PNG 还是 GIF，您可以使用其中任何一种，但我通常会使用 IMAGETYPE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:48:52.510

文档说：

> mime 是图像的对应 MIME 类型。此信息可用于交付具有正确 HTTP 内容类型标头的图像

我相信 IMAGETYPE 是有效的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:09:39.863

我不确定您的问题是否足够清楚，但为什么不能先使用简单的 IF 语句检查图像类型？

例如，我可以在一行中检查 3 种基本的 mime 类型和图像大小，即：

```
if ( (($_FILES["file"]["type"] == "image/gif") || 
     ($_FILES["file"]["type"] == "image/jpeg") || 
     ($_FILES["file"]["type"] == "image/png")) && 
     ($_FILES["file"]["size"] < 1000000) )
{    
// your re-size script    
} else {     
echo "Wrong image mime type!";   
} 
```

这是 mime 类型列表：[http ://www.php.net/manual/en/function.mime-content-type.php#87856](http://www.php.net/manual/en/function.mime-content-type.php#87856)

# map - PigLatin 映射键值

> ID：10952048
> 
> 赞同：1
> 
> 时间：2012-06-08T15:46:21.400
> 
> 标签：map, hadoop, apache-pig

我第一次使用一些 PigLatin 代码，并希望能够通过首先将键值生成为 chararray，然后使用该键来访问映射中的值。例如，categoryIds 是我的地图，

```
catIds = foreach filteredContexts generate elementId,SUBSTRING(categoryAndConfidence,0,2) as catId;
categoryNames = foreach catIds generate elementId, categoryIds#catId as catName; 
```

这是我收到的错误：ERROR 1000: Error during parsing。在第 28 行第 64 列遇到“”catId“”。期待以下之一：“null”…………“null”……

我想做的事是不可能的吗？每次使用地图时是否需要明确说明键值（例如：categoryIds#'51'）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-11T03:05:28.720

据我所知，Pig 没有提供任何内置方法来从地图中获取密钥。对于 map 字段，您只能使用 SIZE 函数获取其大小，使用 IsEmpty 函数检查它是否为空，或使用 map_field#'key' 查找给定键的值。

我自己写了一些 UDF 来帮助我更好地处理地图数据类型。我的一个功能可能对您有用 - MapToBag - 它可以将地图转换`:map[value_type]`为包`:bag{:tuple(key:chararray, value:value_type)}`。有了包，你既可以拿到钥匙，也可以申请 FLATTEN 操作。

```
package com.XXX.YYY.ZZZ;

import org.apache.pig.EvalFunc;
import org.apache.pig.FuncSpec;
import org.apache.pig.data.*;
import org.apache.pig.impl.logicalLayer.FrontendException;
import org.apache.pig.impl.logicalLayer.schema.Schema;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

public class MapToBag extends EvalFunc<DataBag> {

    @Override
    public DataBag exec(Tuple input) throws IOException {
        if (input == null || input.size() == 0) {
            return null;
        }

        @SuppressWarnings("unchecked")
        Map<String, Object> map = (Map<String, Object>) input.get(0);
        if (map == null || map.isEmpty()) {
            return null;
        }

        DataBag bag = bagFactory.newDefaultBag();
        for (String key : map.keySet()) {
            Object value = map.get(key);
            Tuple oneKeyTuple = tupleFactory.newTuple(2);
            oneKeyTuple.set(0, key);
            oneKeyTuple.set(1, value);
            bag.add(oneKeyTuple);
        }

        return (bag.size() == 0) ? null : bag;
    }

    @Override
    public Schema outputSchema(Schema input) {
        try {
            Schema innerSchema = new Schema();
            innerSchema.add(new Schema.FieldSchema("key", DataType.CHARARRAY));
            innerSchema.add(getMapValueSchema(input));
            Schema tupleSchema = new Schema(new Schema.FieldSchema(null, innerSchema, DataType.TUPLE));
            return new Schema(new Schema.FieldSchema(null, tupleSchema, DataType.BAG));
        } catch (FrontendException e) {
            return new Schema(new Schema.FieldSchema(null, DataType.BAG));
        }
    }

    protected Schema.FieldSchema getMapValueSchema(Schema input) throws FrontendException {
        if (input == null || input.size() == 0) {
            return null;
        }
        Schema.FieldSchema mapField = input.getField(0);
        if (mapField.type != DataType.MAP) {
            return null;
        }

        Schema valueSchema = mapField.schema;
        if (valueSchema == null || valueSchema.size() == 0) {
            return null;
        }
        Schema.FieldSchema valueField = valueSchema.getField(0);
        valueField.alias = "value";
        return valueField;
    }

    @Override
    public List<FuncSpec> getArgToFuncMapping() throws FrontendException {
        List<FuncSpec> funcList = new ArrayList<FuncSpec>();
        funcList.add(new FuncSpec(this.getClass().getName(), new Schema(new Schema.FieldSchema(null, DataType.MAP))));
        return funcList;
    }

    private static TupleFactory tupleFactory = TupleFactory.getInstance();
    private static BagFactory bagFactory = BagFactory.getInstance();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:00:41.823

在您的代码中，`catIds`只有两个字段 -`elementId`和`catId`, 并且您尝试`categoryIds`在第二行中访问。所以它不会工作。请修复它。

具体到如何访问地图值，您需要将键括在引号中，例如`categoryIds#'catId'`

# javascript - 动态更改推特 URL

> ID：10952049
> 
> 赞同：0
> 
> 时间：2012-06-08T15:46:22.613
> 
> 标签：javascript, twitter

据我了解，当页面呈现时，Twitter Javascript API 将所有具有“twitter-share-button”类的按钮呈现为 Twitter 按钮。将包含在推文中的 url 在按钮的“data-url”属性中定义。

呈现页面时，该元素将替换为来自 Twitter 的元素。

是否有可能动态设置要包含在推文中的 URL？

我知道使用 jQuery，您可以动态加载脚本等，以使 twitter 脚本在稍后阶段呈现按钮。但是，设置动态 URL 不是很多人想要做的正常事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T01:38:32.350

我也一直在尝试为此找到一个好的解决方案。现在我将只插入 Twitter API 将生成的内容（为便于阅读而修改）：

```
 <iframe
    allowtransparency="true"
    frameborder="0"
    scrolling="no"
    src="http://platform.twitter.com/widgets/tweet_button.1355514129.html"
        "#_=1355791911176&amp;"
        "count=horizontal&amp;"
        "id=twitter-widget-0&amp;"
        "lang=en&amp;"
        "original_referer=" YOUR_SITE_URL "&amp;"
        "size=m&amp;"
        "text=" YOUR_TWEET_TEXT "&amp;"
        "url=" YOUR_URL_TO_TWEET
    style="width: 107px; height: 20px;"
    title="Twitter Tweet Button"
    data-twttr-rendered="true"
    class="twitter-share-button twitter-count-horizontal"
  >
  </iframe> 
```

根据需要修改其他参数以使其看起来像您想要的那样。每次要更改文本时，都必须删除旧文本`iframe`并使用更新后的值重新插入。

# nhibernate - System.ArgumentException：Nhibernate 3.3.0.4000 程序集中的动态模块名称重复

> ID：10952051
> 
> 赞同：1
> 
> 时间：2012-06-08T15:46:36.173
> 
> 标签：nhibernate, fluent-nhibernate, nuget

我遇到了无法重现且无法追踪的问题。它只发生在站点的一个区域、一个环境中的一个客户身上。

> System.ArgumentException ：程序集中的动态模块名称重复。

**堆栈跟踪**

```
at System.Reflection.Emit.AssemblyBuilderData.CheckNameConflict(String strNewModuleName) at System.Reflection.Emit.AssemblyBuilder.DefineDynamicModuleInternalNoLock(String name, Boolean emitSymbolInfo, StackCrawlMark& stackMark) at 
System.Reflection.Emit.AssemblyBuilder.DefineDynamicModuleInternal(String name, Boolean emitSymbolInfo, StackCrawlMark& stackMark) at 
System.Reflection.Emit.AssemblyBuilder.DefineDynamicModule(String name) at 
NHibernate.Proxy.DynamicProxy.DefaultProxyAssemblyBuilder.DefineDynamicModule(String moduleName) at NHibernate.Proxy.DynamicProxy.ProxyFactory.CreateUncachedProxyType(Type baseType, Type[] baseInterfaces) at 
NHibernate.Proxy.DynamicProxy.ProxyFactory.CreateProxyType(Type baseType, Type[] interfaces) at NHibernate.Proxy.DynamicProxy.ProxyFactory.CreateProxy(Type instanceType, IInterceptor interceptor, Type[] baseInterfaces) at 
NHibernate.Proxy.DefaultProxyFactory.GetProxy(Object id, ISessionImplementor session) 
```

有很多帖子说这是一个问题，`Castle.DynamicProxy`但我使用的 nhibernate 版本不需要/使用城堡库。我正在使用 NuGet 作为`FluentNHibernate`参考，一切都是最新的。

我检查了服务器上的 bin，没有城堡 dll。nhibernate dll 是正确的版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T05:45:51.937

这是 NHibernate 中的竞争条件错误，请参阅[https://nhibernate.jira.com/browse/NH-3172](https://nhibernate.jira.com/browse/NH-3172)。

它已在 3.3.1GA 中修复，应该可以在几个小时内下载。

# symfony - Symfony2 Sonta Admin 捆绑包不起作用

> ID：10952052
> 
> 赞同：0
> 
> 时间：2012-06-08T15:46:41.040
> 
> 标签：symfony, symfony-sonata

所以过去两天我一直在使用奏鸣曲管理包。我完全按照说明@ [http://sonata-project.org/bundles/admin/2-0/doc/reference/installation.html](http://sonata-project.org/bundles/admin/2-0/doc/reference/installation.html)

这是我得到的错误：

[Symfony\Component\DependencyInjection\Exception\ParameterNotFoundException] 你请求了一个不存在的参数“doctrine.connections”。

我还没有找到一个适用于以下文档的 symfony 2 捆绑包。它令人沮丧，但我别无选择，只能使用 symfony2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T03:50:47.073

我遇到了同样的问题，并在运行更新供应商脚本后从我的所有 Sonata 捆绑包的 deps 文件中删除“version=origin/2.0”修复了该问题。

# javascript - 显示 Facebook Like 按钮计数

> ID：10952053
> 
> 赞同：-5
> 
> 时间：2012-06-08T15:46:44.733
> 
> 标签：javascript, jquery, facebook, facebook-like, pinterest

Facebook Like 按钮默认显示没有喜欢计数，如何加载它以默认显示计数，即使为 0？

```
 <fb:like href="url" send="false" layout="button_count" width="100px" show_faces="false" font=""></fb:like> 
```

还有Pinterest怎么样？这是一个类似的概念。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:59:18.110

iframe 版本包含显示计数，即使它为零。

```
<iframe src="//www.facebook.com/plugins/like.php?href=YOUR_URL&amp;send=false&amp;layout=button_count&amp;width=450&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;appId=401883116500986" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:450px; height:21px;" allowTransparency="true"></iframe> 
```

# tsql - 为什么强制转换在 case 语句中存在？

> ID：10952055
> 
> 赞同：2
> 
> 时间：2012-06-08T15:46:57.410
> 
> 标签：tsql, case

为什么，当你运行它时，你会得到*2.00*作为答案？

```
declare @temp int  = 2
select CASE WHEN @temp = 1 THEN cast(@temp as decimal(5, 2))
         WHEN @temp = 2 THEN  @temp
         ELSE NULL
    END 
```

但是如果你运行这个，当你选择 @temp2 时，你会得到*2*作为答案

```
declare @temp2 int = 2
select CAST(@temp2 as decimal(5,2))
select @temp2 
```

桥是正确的：

从 result_expressions 和可选的 else_result_expression 的类型集中返回优先级最高的类型。（[来源](http://msdn.microsoft.com/en-us/library/ms181765.aspx)）

[数据类型优先级](http://msdn.microsoft.com/en-us/library/ms190309.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:55:06.460

请参阅[http://msdn.microsoft.com/en-us/library/ms181765.aspx](http://msdn.microsoft.com/en-us/library/ms181765.aspx) 部分返回类型。采用最高优先级的类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T15:52:08.947

我相信 case 语句的每个可能输出的返回值必须是相同的数据类型。它考虑可能的输出，并尝试将它们全部转换为相同的类型。

第一个可能的返回值是 type `decimal(5, 2)`，第二个是 type `int`。它选择可以保存两个值的具有最高优先级的数据类型，并自动为您将所有输出转换为该类型。

您的第二个脚本按预期运行。你实际上得到两个值输出：

*   `2.00`- 这是第二行演员的结果
*   `2`- 这是 @temp2 的值 - 这是一个 int，您在第一行分配了它

# rest - 测试对基于 REST 的 Web 服务器的并发请求

> ID：10952057
> 
> 赞同：18
> 
> 时间：2012-06-08T15:47:09.477
> 
> 标签：rest, testing, concurrency

如何模拟对基于 REST 的 Web 服务器的数千个 GET 和 PUT 请求？是否有可用的工具？如果有，有哪些可用的工具？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-08T15:50:10.310

ab - Apache HTTP 服务器基准测试工具[http://httpd.apache.org/docs/2.0/programs/ab.html](http://httpd.apache.org/docs/2.0/programs/ab.html)

这是测试 REST API 的绝佳工具。

例子：

```
ab -c 100 -n 100 http://service/path/to/resource 
```

在这个例子中：

*   “-c 100”表示 100 个并发请求，并且
*   “-n 100”表示 100 个请求

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-10-25T08:05:40.570

我知道这是一个老问题，但是我需要一个简单的基于 AJAX 的脚本来测试多个并发连接。如果你们中的任何人有类似的要求，那么您也可以像这样使用这个来进行测试。

[![模拟多个 Ajax 请求的 JS 代码快照](../Images/9c39fbf1a45756017ec04a5b97092a02.png)](https://i.stack.imgur.com/IXyKS.png)

请查看[这个 js fiddle 链接](https://jsfiddle.net/vibs2006/urxpjzs8/)或查看附件（无论哪个适合您，因为两者都指向相同的 javascript 代码）

```
var interval;
            var queue = [];
            var globalElapsedTime;

             function getUrl() {
                    return $.trim($("#txtAjayUrl").val());
                }

             $("#btnLaunchRequests").on("click", function () {
                    queue = [];
                    $("#divTimeElapsed").html("<i>calculating</i>");                    
                    globalElapsedTime = window.performance.now();
                    $("#divRequestStatus").show();
                    $("#btnLaunchRequests").prop("disabled", true);
                    var totalRequests = 50;
                    var inputValue = $("#txtNumberOfConcurrentRequests").val();
                    totalRequests = inputValue.trim();

                    $("#divTotalNumberOfProcessed").html(totalRequests.toString());
                    if (interval != null && interval != undefined) {
                        clearInterval(interval);
                    }
                    interval = window.setInterval(function () {
                        $("#divNumberOfCurrentRequests").text(queue.length);
                    }, 500);

                    for (let i = 1; i <= totalRequests; i++) {
                        console.log("Loop No. " + i);
                        if (i == totalRequests) {
                            $.get(getUrl(), function (data) {
                                queue.push("1");
                                $("#btnLaunchRequests").prop("disabled", false);
                                $("#divNumberOfCurrentRequests").text(queue.length);
                                //clearInterval(interval);
                            }).always(function () {
                                $("#btnLaunchRequests").prop("disabled", false);
                                globalElapsedTime = window.performance.now() - globalElapsedTime;
                                globalElapsedTime = Math.round((globalElapsedTime / 1000) * 100) / 100;                                                                
                                console.log("%cLast Result Processed in " + globalElapsedTime + " Seconds.", "color:green");
                                $("#divTimeElapsed").text(globalElapsedTime + " seconds");
                            });
                        }
                        else {
                            $.get(getUrl(), function (data) {
                                queue.push("1");
                            });
                        }
                    }
                });
```

```
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
      <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

      <div class="container">
        <div class="row" style="padding-top:50px;">
            <div class="col-sm-12">
                <h3>HTTP GET Concurrent Requests Tester</h3>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <ul>
                    <li>Sample Ajax URL for concurrent request testing: <input type="text" id="txtAjayUrl" value="http://localhost:4500/Api/Home/GetCustomerDetails/36603/Test" style="width:100%"> <br><br>
                    </li>                    

                    <li><input type="number" value="50" id="txtNumberOfConcurrentRequests"> <input type="button" value="Launch Concurrent Requests" id="btnLaunchRequests"> <br></li>

                </ul>
            </div>
        </div>

        <div class="row" id="divRequestStatus" style="">
            <div class="col-sm-12">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>
                                Total Number of Requests
                            </th>
                            <th>
                                Total Number of Requests Processed
                            </th>
                            <th>
                                Total Time Elapsed
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <div id="divTotalNumberOfProcessed"></div>
                            </td>
                            <td>
                                <div id="divNumberOfCurrentRequests" style="font-weight: bolder;"></div>
                            </td>
                            <td>
                                <div id="divTimeElapsed"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T17:33:13.350

试试jmeter，有第三方REST插件：[http ://smartrics.blogspot.co.uk/2009/04/jmeter-to-test-robustness-of-system.html](http://smartrics.blogspot.co.uk/2009/04/jmeter-to-test-robustness-of-system.html)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-06-10T04:14:51.743

几乎任何 HTTP 性能测试工具，无论是商业的还是开源的，都可以用来对 REST 接口进行性能测试。

# javascript - 使用 setTimer 的表单提交延迟

> ID：10952058
> 
> 赞同：0
> 
> 时间：2012-06-08T15:47:12.457
> 
> 标签：javascript, jquery, forms

我只是试图延迟表单提交并为用户提供某种正在发生的动作的感觉，而不仅仅是即时表单提交。下面链接的 jsfiddle 准确地显示了我正在尝试做的事情（减去我想要为其提供消息的客户端中发生的操作）。

简而言之，我想使用 setTimeout 作为一种将表单提交延迟 N 秒的方法，例如

```
// display message indicating we're doing something
$("#container").html("<p>Processing...</p>");

setTimeout(function () {
    // display message indicating we're ready to submit the form
    $("#container").html("<p>Submitting...</p>");
    // trigger form submit action
    form.submit();
    return true; // needed?
}, 2000); 
```

正如您在此处看到的，我将“提交...”消息和实际的表单提交触发器包装在 setTimeout 中。这一切都在一个更大的`$("#theForm").submit()`包装中。

这要么完全失败（挂起），要么在表单通过但 POST 失败的地方执行某种伪“部分提交”。

我不同意这个想法......如果有另一种延迟表单提交几秒钟以提高用户体验的方法，我想知道。

[http://jsfiddle.net/t4tqy/](http://jsfiddle.net/t4tqy/)

测试的浏览器：Chrome、IE 8、Windows 下的 FF 12……这就是我可以访问 ATM 的全部内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:05:51.747

尽管*您为什么要引起延迟而不是消除任何发生的...*

使用：

```
<div id="formMessage"></div>
<div id="formContainer"> 
```

和：

```
#formMessage {
    display: none;
} 
```

并添加/编辑：

```
$("#formContainer").hide();
$("#formMessage").html("Processing...").show();

....

$("#formMessage").html("Submitting...."); 
```

它可以工作，就像在这个（公认的迂回）演示中一样，在尝试提交之前，您不会`form`从元素中删除 。`#formContainer`

[http://jsfiddle.net/userdude/t4tqy/1/](http://jsfiddle.net/userdude/t4tqy/1/)

现在，我可能会建议一些改进，例如使用缓存而不是多次调用同一元素选择器等。另外，您还可以`#formMessage`仅在需要时创建元素，而不是在源代码中添加不必要的标记。

```
$(function () {
    var $email = $("#emailAddr"),
        $form = $("#emailForm"),
        $container = $('#formContainer'),
        $message = $('<div id="formMessage">');

    $email.val('bogus.user@email.cc');

    $form.submit(function (ev) {
        ev.preventDefault();

        var form = this,
            ea = $email.val(),
            allowSubmit = false;

        // cheap email validation
        if (ea.length !== 0 && ea.indexOf("@") !== -1) {
            allowSubmit = true;
        }

        if (allowSubmit === true) {
            // indicate action of some sort
            $container.hide().before($message);
            $message.html("Processing...").show();

            setTimeout(function () {
                // indicate we're submitting form
                $message.html("Submitting...");
                // engage
                form.submit();
                return true;
            }, 2000);

        } else {
            alert("form not ok, not allowing submission...");
        }  
    });
}); 
```

[http://jsfiddle.net/userdude/t4tqy/3/](http://jsfiddle.net/userdude/t4tqy/3/)

# batch-file - 批处理 - 将重复代码转换为循环？

> ID：10952059
> 
> 赞同：1
> 
> 时间：2012-06-08T15:47:14.630
> 
> 标签：batch-file

我有一个批处理文件，我在其中创建了许多这样的快捷方式：

```
SET VBFILE=createshortcut.vbs
SET INSTALLPATH=%userprofile%\desktop
SET NETWORKPATH=I:\Program Files\app\Exec

SET TARGET_A=%NETWORKPATH%\myapp-CS.exe
SET LNKNAME_A=The name of the app CS

FOR /F "tokens=1* delims=;" %%B IN ("Set oWS = WScript.CreateObject("WScript.Shell")") DO ECHO %%B>>%INSTALLPATH%\%VBFILE% 
FOR /F "tokens=1* delims=;" %%B IN ("sLinkFile = "%INSTALLPATH%\%LNKNAME_A%.lnk"") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("Set oLink = oWS.CreateShortcut(sLinkFile)") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   oLink.TargetPath = "%TARGET_A%"") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   '   oLink.Arguments = """) DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   '   oLink.WorkingDirectory = "%NETWORKPATH%"") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   oLink.Save") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%

CSCRIPT %INSTALLPATH%\%VBFILE%
DEL %INSTALLPATH%\%VBFILE%

SET TARGET_B=%NETWORKPATH%\myapp-BD.exe
SET LNKNAME_B=The name of the app BD

FOR /F "tokens=1* delims=;" %%B IN ("Set oWS = WScript.CreateObject("WScript.Shell")") DO ECHO %%B>>%INSTALLPATH%\%VBFILE% 
FOR /F "tokens=1* delims=;" %%B IN ("sLinkFile = "%INSTALLPATH%\%LNKNAME_A%.lnk"") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("Set oLink = oWS.CreateShortcut(sLinkFile)") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   oLink.TargetPath = "%TARGET_B%"") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   '   oLink.Arguments = """) DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   '   oLink.WorkingDirectory = "%NETWORKPATH%"") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   oLink.Save") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%

CSCRIPT %INSTALLPATH%\%VBFILE%
DEL %INSTALLPATH%\%VBFILE% 
```

有没有办法减少重复代码并将其放入 GOTO 语句或 for 循环中？

使用 GOTO，我无法找到返回调用 GOTO 的位置​​的方法。在 for 循环中，我想不出在每次迭代中用新值覆盖变量的好方法。

你有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:06:42.993

您可以使用`call`它作为替代，`goto`它会在函数完成时自动返回调用代码。

```
@echo off
echo Starting batch file
call :RepeatFunction
echo Finished

:RepeatFunction
FOR /F "tokens=1* delims=;" %%B IN ("Set oWS = WScript.CreateObject("WScript.Shell")") DO ECHO %%B>>%INSTALLPATH%\%VBFILE% 
FOR /F "tokens=1* delims=;" %%B IN ("sLinkFile = "%INSTALLPATH%\%LNKNAME_A%.lnk"") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("Set oLink = oWS.CreateShortcut(sLinkFile)") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   oLink.TargetPath = "%TARGET_A%"") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   '   oLink.Arguments = """) DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   '   oLink.WorkingDirectory = "%NETWORKPATH%"") DO ECHO %%B>>%INSTALLPATH%\%VBFILE%
FOR /F "tokens=1* delims=;" %%B IN ("   oLink.Save") DO ECHO %%B>>%INSTALLPATH%\%VBFILE% 
```

# python - 用 matplotlib.pyplot (Python) 绘制椭圆

> ID：10952060
> 
> 赞同：27
> 
> 时间：2012-06-08T15:47:18.353
> 
> 标签：python, matplotlib, ellipse

对不起，如果这是一个愚蠢的问题，但是有没有一种简单的方法可以`matplotlib.pyplot`在 Python 中绘制一个椭圆？我希望会有类似的东西`matplotlib.pyplot.arrow`，但我找不到任何东西。

`matplotlib.patches`使用with`draw_artist`或类似的东西是唯一的方法吗？我希望有一个更简单的方法，但文档并没有提供太多帮助。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-08-13T20:19:05.523

matplotlib 椭圆演示很好。但是如果没有 for 循环，我无法在我的代码中实现它。我得到一个轴图错误。这是我所做的，当然 xy 中心是我自己的坐标，其宽度和高度基于我绘制椭圆的图像。

```
from matplotlib.patches import Ellipse

plt.figure()
ax = plt.gca()

ellipse = Ellipse(xy=(157.18, 68.4705), width=0.036, height=0.012, 
                        edgecolor='r', fc='None', lw=2)
ax.add_patch(ellipse) 
```

此代码部分基于[此页面](http://nickcharlton.net/posts/drawing-animating-shapes-matplotlib.html)上的第一个代码框。请参阅上面 Chris 的回复以获取`matplotlib.patches.Ellipse`.

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2018-01-23T19:56:31.920

如果不想使用面片，可以使用椭圆的参数方程：

x = u + a cos(t) ; y = v + b sin(t)

```
import numpy as np
from matplotlib import pyplot as plt
from math import pi

u=1\.     #x-position of the center
v=0.5    #y-position of the center
a=2\.     #radius on the x-axis
b=1.5    #radius on the y-axis

t = np.linspace(0, 2*pi, 100)
plt.plot( u+a*np.cos(t) , v+b*np.sin(t) )
plt.grid(color='lightgray',linestyle='--')
plt.show() 
```

这使： [![带参数方程的 x 向椭圆](../Images/bf4ec513ecece618725a25f8e51283e2.png)](https://i.stack.imgur.com/x5IcR.png)

由于二维旋转矩阵，椭圆可以旋转：

```
import numpy as np
from matplotlib import pyplot as plt
from math import pi, cos, sin

u=1\.       #x-position of the center
v=0.5      #y-position of the center
a=2\.       #radius on the x-axis
b=1.5      #radius on the y-axis
t_rot=pi/4 #rotation angle

t = np.linspace(0, 2*pi, 100)
Ell = np.array([a*np.cos(t) , b*np.sin(t)])  
     #u,v removed to keep the same center location
R_rot = np.array([[cos(t_rot) , -sin(t_rot)],[sin(t_rot) , cos(t_rot)]])  
     #2-D rotation matrix

Ell_rot = np.zeros((2,Ell.shape[1]))
for i in range(Ell.shape[1]):
    Ell_rot[:,i] = np.dot(R_rot,Ell[:,i])

plt.plot( u+Ell[0,:] , v+Ell[1,:] )     #initial ellipse
plt.plot( u+Ell_rot[0,:] , v+Ell_rot[1,:],'darkorange' )    #rotated ellipse
plt.grid(color='lightgray',linestyle='--')
plt.show() 
```

回报： [![带参数方程的旋转椭圆](../Images/9016c68faf476cce1d64bdb92f6358dc.png)](https://i.stack.imgur.com/0MJId.png)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-06-08T15:55:24.363

你看过[matplotlib 椭圆演示](http://matplotlib.sourceforge.net/examples/pylab_examples/ellipse_demo.html)吗？他们在这里使用[`matplotlib.patches.Ellipse`](http://matplotlib.sourceforge.net/api/artist_api.html#matplotlib.patches.Ellipse).

# php - PHPMailer 缺少英文文件

> ID：10952061
> 
> 赞同：2
> 
> 时间：2012-06-08T15:47:18.633
> 
> 标签：php, phpmailer

这里有人使用phpmailer吗？我下载了 phpmailer 5.2.1 的文件（我认为是最新版本），它似乎缺少英文文件。有没有人有这个文件或者知道我在哪里可以得到它？我正在从这里下载文件：[http ://code.google.com/a/apache-extras.org/p/phpmailer/downloads/list](http://code.google.com/a/apache-extras.org/p/phpmailer/downloads/list)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:48:51.253

[http://code.google.com/a/apache-extras.org/p/phpmailer/source/browse/branches/phpmailer-2.0/language/phpmailer.lang-en.php](http://code.google.com/a/apache-extras.org/p/phpmailer/source/browse/branches/phpmailer-2.0/language/phpmailer.lang-en.php)

# cakephp - CakePHP：如何（如果可能）在控制器、模型和视图中使用一个类？

> ID：10952064
> 
> 赞同：0
> 
> 时间：2012-06-08T15:47:33.550
> 
> 标签：cakephp, classloader

假设我有一个带有随机字符串方法的 StringerHelper(Component|Helper|Behaviour).php 类。

我可能需要在控制器、模型和视图中使用它。如何在需要的地方加载它？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:34:13.873

你可以把它变成一个 lib 并把它放进`app/Lib`. 如果它只是辅助方法，请将方法设为静态。

对于 2.x

```
app/Lib/Stringer.php
App::uses('Stringer', 'Lib'); 
```

对于 1.x，命名有点不同

```
app/lib/stringer.php
App::import('Lib', 'Stringer'); 
```

用法：

```
Stringer::myHelperMethod([args]); 
```

# ios - 修改目录中的现有文件，并替换它（iPhone）

> ID：10952065
> 
> 赞同：0
> 
> 时间：2012-06-08T15:47:35.030
> 
> 标签：ios, xcode, json

在我的应用程序中，每次用户创建新组时，都会创建以下代码（JSON）：

```
{"group a":"0864797073"} 
```

...然后代码保存在目录中名为 groups.txt 的文件中

...但是当用户创建另一个组时，我希望以这种方式修改文件：

```
{"group a":"0864797073"} 
{"group b":"0864797073"} 
```

...进而...

```
{"group a":"0864797073"} 
{"group b":"0864797073"} 
{"group c":"0864797073"} 
```

...所以添加一个新行，而不是替换文件。

我怎样才能做到这一点？？

在此先感谢您的帮助。

编辑2：

NSString *destDir = [NSString stringWithFormat:@"/Apps/Quick Homework & business/%@/", namegroup.text];

```
 NSString *filename5 = namegroup.text;
    NSString *filename6 = @"group";

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,     NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *groupPath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"%@", filename6]];

    NSMutableArray *titles = [NSMutableArray array];
    [titles addObject:filename5];

    NSMutableArray *keys = [NSMutableArray array];
    [keys addObject:filename6];

    NSDictionary *dict = [NSDictionary dictionaryWithObjects:titles forKeys:keys];

    NSString *jsonString = [dict JSONRepresentation];
    NSData *jsonData = [jsonString dataUsingEncoding: NSUTF8StringEncoding];

    NSFileHandle *myHandle = [NSFileHandle fileHandleForUpdatingAtPath:groupPath];
    [myHandle seekToEndOfFile];
    [myHandle writeData:jsonData];
    [myHandle closeFile];

    [jsonData writeToFile: groupPath atomically: YES];

    [[self restClient] uploadFile:filename6 toPath:destDir
                    withParentRev:nil fromPath:groupPath]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:09:27.377

如果您只想在现有文件的末尾添加一行，可以使用以下代码。

```
NSData *newGroupData = [newGroupString dataUsingEncoding:NSUTF8StringEncoding];

NSFileHandle *myHandle = [NSFileHandle fileHandleForUpdatingAtPath:filePath];
[myHandle seekToEndOfFile];
[myHandle writeData:newGroupData];
[myHandle closeFile]; 
```

由您来设置`newGroupString`和`filePath`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:50:55.017

您执行以下操作

*   读取旧文件的内容
*   将你的新行附加到读取的内容，所以现在你有一个包含旧文件 + 用户添加的新行的集合
*   将集合写入文件，这将写入所有旧内容+新行

# postgresql - 您可以使用分叉在应用程序之间迁移 heroku 数据库吗？

> ID：10952067
> 
> 赞同：5
> 
> 时间：2012-06-08T15:47:44.843
> 
> 标签：postgresql, heroku

我们有一个生产数据库，我们想将它的定期快照保存到我们的暂存数据库中。

我知道如何使用 pgbackups 来做到这一点，我想知道是否有人知道如何使用新的 HerokuPostgres fork 函数来做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-10T14:25:23.003

是的，您可以直接从一个应用程序数据库到另一个应用程序数据库创建分叉。为此，请从主应用程序中获取 DATABASE_URL 的值，然后在以下命令中使用它：

```
heroku addons:add heroku-postgresql:ronin --fork postgres://username:password@ec2.../database --app yourstagingapp 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T19:39:42.173

添加到克雷格的答案中，这是[freeformz 的一个脚本，](https://gist.github.com/3374606)它完成了整个工作。

```
app=${1}
db_type=${2:-ronin}

old_db=`heroku config -a ${app}-staging | grep ^HEROKU_POSTGRESQL | cut -d : -f 1 | sed s/_URL//`
heroku addons:add heroku-postgresql:${db_type} --fork `heroku config -a ${app} | grep ^DATABASE_URL | cut -d : -f 2-5` -a ${app}-staging
new_db=`heroku config -a ${app}-staging | grep ^HEROKU_POSTGRESQL | grep -v ${old_db} | cut -d : -f 1 | sed s/_URL//`
heroku pg:wait -a ${app}-staging
heroku pg:promote ${new_db} -a ${app}-staging
#Remove the old db
if [ ! -z "${old_db}" ]l; then
  heroku addons:remove ${old_db} -a ${app}-staging --confirm ${app}-staging
fi 
```

# android - 使用 DDMS 连接调试器时，有时会忽略断点

> ID：10952069
> 
> 赞同：1
> 
> 时间：2012-06-08T15:47:56.073
> 
> 标签：android, eclipse, breakpoints, ddms

当使用 DDMS 通过选择进程并单击调试图标来手动将调试器连接到正在运行的进程时，有时会忽略所有断点。LogCat 报告调试器处于活动状态。

此问题经常发生但并非始终如一。我唯一的解决方法是在调试模式下从头开始。

有没有其他人看到这个问题并提出更好的解决方法？

# iphone - 在 iOS 上构建 OpenCV 项目时，为什么 CvStereoBMState 未声明？

> ID：10952071
> 
> 赞同：0
> 
> 时间：2012-06-08T15:48:06.557
> 
> 标签：iphone, ios, image-processing, opencv, disparity-mapping

我正在使用 OpenCV 开发一个 iOS 项目。我正在尝试创建图像的视差图。在实现这一点时，Xcode 显示`CvStereoBMState`为未声明的标识符。

![在此处输入图像描述](../Images/69cf7abb731107cf30ac0fc1697dc6a4.png)

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T07:31:53.003

查看文档：CvStereoBMState 是旧的 C 样式，似乎不受支持，但您现在可以使用新的 C++ 接口。

如需更多信息，请查看[相机校准和 3D 重建 - StereoBM](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#stereobm)。

# c# - asp.net 自动完成和 IE 自动完成

> ID：10952074
> 
> 赞同：0
> 
> 时间：2012-06-08T15:48:28.603
> 
> 标签：c#, asp.net, autocomplete, ajaxcontroltoolkit

所以我有一个 asp:AutoCompleteExtender 可以正常工作，但是有没有办法从 Internet Explorer 中关闭自动完成功能，因为当我在文本框中输入文本时，两个自动完成功能都会出现，一个在另一个之上。

我只想关闭一个文本框而不是整个系统的 IE 自动完成功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:03:47.090

```
<asp:TextBox id="txtname" runat="server" AutoCompleteType="disabled"></asp:TextBox> 
```

或者

```
<asp:TextBox id="txtname" runat="server" AutoCompleteType="none"></asp:TextBox> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:51:19.513

您可以使用以下代码禁用 IE 的自动完成功能：

```
<INPUT NAME="Foo" AUTOCOMPLETE="off" /> 
```

更多信息：http: [//msdn.microsoft.com/en-us/library/ie/ms533486%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/ie/ms533486%28v=vs.85%29.aspx)

# c - 结构中的字符初始化

> ID：10952086
> 
> 赞同：1
> 
> 时间：2012-06-08T15:48:52.850
> 
> 标签：c, struct, char

我有下面的代码。我在构建它时收到“警告：初始化器 [-Wmissing-braces] 周围缺少大括号”警告。

```
struct routing {
    int hop_distance;
    char timeinfo[13];
    char sender_ID[16];
    char gateway[16];
};

struct routing user_list[40]  =  { [0]={0,0,0,0}}; 
```

我想我会因为 char 初始化而收到警告，我应该如何初始化它？

```
struct routing user_list[40]  =  { [0]={0,{0},{0},{0}}}; 
```

或者

```
struct routing user_list[40]  =  { [0]={0,'\0','\0','\0'}}; 
```

或其他方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:02:34.040

您正在初始化数组的元素 0。所以：

```
 struct routing user_list[40] = { [0]={...} }; 
```

到目前为止，你做对了。在此元素中，您将初始化四个成员：

```
 struct routing user_list[40] = { [0]={..., ..., ..., ...} }; 
```

也很好。

元素 1 是一个`int`，所以你可以用一个数字来初始化它，比如 0。

元素 2、3 和 4 是 的数组`char`，因此您可以像初始化 的数组一样初始化它们`char`。`{0}`，`{'\0'}`或者`""`他们都工作：

```
 struct routing user_list[40] = { [0]={0, {0}, {'\0'}, ""} }; 
```

请注意，上面是一个示例，显示您可以使用所有三种方法。实际上，您采用一种方法并在所有三种方法中都使用它。

您收到警告的原因是因为您尝试使用`0`, 而不是`{0}`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:04:57.370

您必须用花括号括住数组：

```
struct routing user_list[40] = {
    [0] = { 0, { 0 }, { 0 }, { 0 } }
}; 
```

# visual-studio-2010 - 如何在新的 Windows Server 2008 上为与 Visual Basic 2010 应用程序之间的电子邮件设置 SMTP

> ID：10952091
> 
> 赞同：1
> 
> 时间：2012-06-08T15:49:11.213
> 
> 标签：visual-studio-2010, smtp, windows-server-2008, pop3

问题 1 - 外发电子邮件：如何配置 Windows 以发送存储在 \inetpub\mailroot\pickup\ 中的电子邮件

我的 Visual Basic 应用程序在发送出站电子邮件时将电子邮件文件存储到pickup\。

问题 2 - 收到的电子邮件：如何配置 Windows 以将收到的电子邮件接收到目录？就像在 \inetpub\mailroot\mailbox...

我的 Visual Basic 应用程序持续监视目录，并在电子邮件文件进入时读取它们。

这一切在我以前的 Windows Server 2003 中运行良好。

但我看不到在 Win Serv 2008 中添加 POP3 邮箱目录的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T08:18:19.433

您必须使用“Internet 信息服务 (IIS) 6.0 管理器”，但不能使用新的“Internet 信息服务 (IIS) 管理器”。确保您添加了“SMTP 服务器工具”作为服务器功能。

# r - r 在数据框中选择某个值以下和之后的值

> ID：10952092
> 
> 赞同：1
> 
> 时间：2012-06-08T15:49:25.293
> 
> 标签：r, time, dataframe, data.table, xts

我有一个问题如何从表中选择某些值。我有一个包含时间和值的表，我想在一段时间后得到下面的行。

示例-Data.Frame。

```
Time   Value
02:51  0.08033405 
05:30  0.43456738 
09:45  0.36052075 
14:02  0.45013807 
18:55  0.05745870
....# and so on 
```

时间编码为字符，但可以格式化。现在我有例如时间“6:15”，并且想从表中获取该时间之前和之后的时间值（0.43456738 和 0.36052075）。数据库实际上非常庞大，我有很多时间值。任何人都有一个很好的建议如何做到这一点？

谢谢鹬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:00:44.380

```
value_before <- example_df[which(example_df$time=="09:45")-1, ]$value
value_after <- example_df[which(example_df$time=="09:45")+1, ]$value

# This could become a function

return_values <- function(df,cutoff) {
value_before <- df[which(df$time==cutoff)-1, ]$value
value_after <- df[which(df$time==cutoff)+1, ]$value
return(list(value_before, value_after))
}

return_values(exmaple_df, "09:15") 
```

# 大型数据集的解决方案。

```
library(data.table)
df <- data.frame(time = 1:1000000, value = rnorm(1000000))
# create a couple of offsets
df$nvalue <- c(df$value[2:dim(df)[1]],NA)
df$pvalue <- c(NA,df$value[2:dim(df)[1]])
new_df <- data.table(df)
setkey(new_df,"time")

new_df[time==10]
 time      value     pvalue     nvalue
[1,]   10 -0.8488881 -0.1281219 -0.5741059

> new_df[time==1234]
     time      value   pvalue     nvalue
[1,] 1234 -0.3045015 0.708884 -0.5049194 
```

# coldfusion - Coldfusion 与 memcached 客户端在 270 次左右调用后返回错误

> ID：10952093
> 
> 赞同：1
> 
> 时间：2012-06-08T15:49:30.180
> 
> 标签：coldfusion, memcached

我的问题似乎与这个有关：

[Coldfusion memcached 连接](https://stackoverflow.com/questions/8225948/coldfusion-memcached-connections)

但是，我一直无法解决它。

如果我将此代码放在 application.cfm 中：

```
<cfif not IsDefined("application.memcached")>   
  <cfset application.memcachedFactory = createObject("component","memcachedFactory").init("192.168.2.91:11211")>
  <cfset application.memcached = application.memcachedFactory.getmemcached()>
</cfif> 
```

该页面可能适用于 270 次通话。然后它将开始失败，并出现错误“对象实例化异常”代码正在与 memcached 正确对话。我可以发送和接收数据。似乎java的东西用完了..线程、套接字、某种句柄。我对java知之甚少，并且被卡住了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:18:41.630

这对我来说似乎是错的，唐。为什么在第一次调用后这段代码会再次运行？它应该运行 1 次，之后您可以引用您的对象。您的 application.cfm 的其余部分是什么样的？您是否添加了带有“名称”的 cfapplication 标签？

如果您未能设置应用程序“名称”（通过 cfapplication 标记或 application.cfc 中的“this.name”），“application.x”变量将被视为常规变量。页面请求结束后，它将“消失”并要求下一个请求重新实例化对象。

在这种情况下，“isDefined()”的目的是确保它只运行一次 - 为您提供一个单例（单一引用），您可以一次又一次地使用它而无需重新实例化它。听起来您不在应用程序的“内部”。

# javascript - Javascript IF 语句，检测 null 不起作用

> ID：10952094
> 
> 赞同：3
> 
> 时间：2012-06-08T15:49:34.903
> 
> 标签：javascript

我有一个行为奇怪的空变量。出于某种原因，我似乎无法检测到它是否为空！var 被称为`emailFromUrl`.

```
 console.log(emailFromUrl); //returns null
   console.log(emailFormUrl.toString()); //returns null
   console.log(emailFromUrl === null); //false!
   console.log(emailFromUrl != null); //true!
   console.log(typeof emailFromUrl); //string
   console.log(!emailFromUrl); //false!
   console.log(emailFromUrl === ""); //false 
```

这到底是怎么回事？

**答案：**

```
 console.log(emailFromUrl === 'null'); //true! 
```

未经过滤的控制台日志：

```
Test71 | emailFromUrl : null | emailFromUrl === null : false | emailFromUrl != null : true | emailFromUrl.toString() : null | typeof emailFromUrl : string | !emailFromUrl : false | emailFromUrl === "" : false | emailFromUrl === "null" : true 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T16:02:15.970

也许`emailFromurl`value 只是一个文字`null`字符串？) 我认为这将解释您在问题中得到的所有结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:58:48.400

=== 运算符检查值和类型。emailFromUrl 是 string not null 类型，这就是为什么它在那里评估为 false 的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:53:21.220

除非您想要基于它为空的特定逻辑，否则您可以检查对象是否“虚假”（如果对象未定义，0 或空）

```
if(!emailFromUrl) {
    // handle the null scenario
} 
```

# javascript - Javascript附加；什么被认为是最佳实践？

> ID：10952096
> 
> 赞同：0
> 
> 时间：2012-06-08T15:49:43.327
> 
> 标签：javascript, append

谁能解释在 javascript 中附加的最佳实践是什么？

```
var element = document.createElement('p');
element.innerHTML = 'This is appended' ;
var div = document.getElementById('div');
div.appendChild(element); 
```

或者

```
var div = document.getElementById('div');
div.innerHTML = '<p>This is appended</p>'; 
```

我看到很多人在 jQuery 中这样做：

```
$('#div').append('<p>This is appended</p>'); 
```

但我一直这样做：

```
var element = document.createElement('p');
element.innerHTML = 'This is appended' ;
$('#div').append(element); 
```

先感谢您

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T15:52:47.807

如果你使用 jQuery，绝对没有错：

`$('#div').append('<p>This is appended</p>');`

它的代码更少，步骤更少。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T16:09:29.037

IMO，当您使用 DOM 时，请将其视为 DOM 而不是字符串。

换句话说，不要使用*标记*来创建元素或文本节点。使用 DOM 创建方法。

```
document.getElementById('div')
        .appendChild(document.createElement('p'))
        .appendChild(document.createTextNode('This is appended')); 
```

* * *

微软的`.innerHTML`发明可能很诱人，也许在紧要关头很有用，但我通常会避免它。

您可以使用助手减少上述方法的冗长性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T15:52:28.700

我通常使用 jQuery 构建一个元素。

```
var paragraph = $("<p />", {
  className : "someClass",
  text : "this is appended"
})

div.append(paragraph) 
```

我相信这种方法比直接注入 HTML 更受欢迎，因为它对 DOM 的侵入性较小。

# xcode - 如何在 xcode 中查看 Objective-C 库头文件

> ID：10952097
> 
> 赞同：2
> 
> 时间：2012-06-08T15:49:44.427
> 
> 标签：xcode, header-files

在我一生中做过的所有编程中，我发现自己把头撞在墙上大喊“给我看头文件！给我看头文件！” 我决定放暑假，只在 iPhone 的 Xcode 中编写objective-c。我希望能够阅读各种objective-c库的头文件，以便熟悉它们。我现在想要的是 UITouch.h，但实际上我只是希望能够查看我需要了解更多信息的任何“.h”文件。有什么简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:55:55.567

打开一个新项目，导入框架，或打开当前项目的框架文件夹。标头将位于这些包内。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:01:29.523

Cmd-shift-O 快速打开，然后开始输入类名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:58:42.700

您的代码应该有一个#import 或#include 语句来导入/包含头文件。按住 Command 键，单击导入/包含语句以查看标题。此外，您可以按住 Command 键单击符号以跳转到定义它的头文件。

或者，您可以选择跳转栏最左侧的下拉菜单，然后进入“包含”子菜单并选择要查看的头文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:06:27.593

右键单击符号并在弹出菜单中选择**跳转到定义。**这会将您带到定义符号的头文件。

# java - 通过java中的反射访问抽象类中的子字段

> ID：10952098
> 
> 赞同：2
> 
> 时间：2012-06-08T15:49:54.200
> 
> 标签：java, inheritance, reflection, field

我有 2 节课：

```
public abstract class AbstractTestClass {
    private String abstractString = "abstract";
    public void showFields() throws IllegalAccessException{
        for (Field field : this.getClass().getDeclaredFields()) {
            System.out.println(field.get(this));
        }
    }
}

public class TestClass extends AbstractTestClass {
    private String concreteString = "concreteString";
} 
```

并测试：

```
public class MainTest {
    public static void main(String[] args) throws IllegalAccessException{
        TestClass test = new TestClass();
        test.showFields();
    }
} 
```

运行此测试会导致下一个异常：

```
java.lang.IllegalAccessException: Class AbstractTestClass can not access a member of class TestClass with modifiers "private" 
```

当我调试代码时，它包含 TestClass 的实例。

问题：

1.  为什么会这样？
2.  如何使此代码工作，而不是使用 Field.setAccessible() 或更改文件的可见性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:56:26.290

> 如何使此代码工作，而不是使用 Field.setAccessible() 或更改文件的可见性？

你不能，你必须使该字段可访问才能使用它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:29:24.313

我相信你犯了我刚开始时犯的同样的错误：抽象类和扩展类是两部分焊接在一起形成一个单一的类，可以访问彼此的所有字段和方法等。

可悲的是，这不是真的：继承是在普通父子对象中更紧密的关系，但仍然必须遵守访问规则，例如，如果`protected`在抽象类中声明了一个方法并且扩展类在不同的包中，那么它无法访问（反之亦然）。

因为该方法`showFields()`是在 中定义的`AbstractTestClass`，所以它只能访问该类中的字段。里面的田地`TestClass`基本上被围起来了。

我能想到的唯一解决方法是覆盖`showFields()`in `TestClass`，吞下任何关于无法访问私有字段的异常，然后`super.showFields()`再次调用并吞下任何异常。不漂亮。

```
public abstract class AbstractTest {
  private String abstractString = "abstract";
  public void showFields() throws IllegalAccessException {
    for (Field field : this.getClass().getSuperclass().getDeclaredFields()) {
      try {
        System.out.println(field.get(this));
      }
      catch (IllegalAccessException e) { 
        // swallow 
      }
    }
  }
}

public class MyTest extends AbstractTest
{
  private String concreteString = "concreteString";
  @Override public void showFields() throws IllegalAccessException {
    for (Field field : this.getClass().getDeclaredFields()) {
      try {
        System.out.println(field.get(this));
      }
      catch (IllegalAccessException e) {  
        // swallow
      }
    }
    super.showFields();
  }
} 
```

我怀疑这就是你的想法......

# wcf - 将资源和配置复制到 IIS 目录而不是 Visual Studio 中的二进制文件

> ID：10952099
> 
> 赞同：0
> 
> 时间：2012-06-08T15:49:55.170
> 
> 标签：wcf, resources, directory, copy, config

当使用大量 mobules 的 WCF 服务将资源和配置文件复制到二进制目录时，我遇到了一个问题。但我需要将它们复制到 IIS 目录。
任何人都可以请建议是否有任何 Visual Studio 设置？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:51:40.117

我不完全确定您在问什么，但听起来您在问如何更改构建输出以转到指定目录。如果是这种情况，您可以在项目的“属性”页面中执行此操作。右键单击项目，然后选择属性。

选择Build选项卡，在Output下你会看到一个设置输出路径（Output path）的地方。

如果这不是你要问的，你能澄清你的问题吗？

# python - Python 继承：init 的参数数量有问题

> ID：10952104
> 
> 赞同：1
> 
> 时间：2012-06-08T15:50:07.890
> 
> 标签：python, django, class, inheritance

我正在为我的 Django 项目开发一个基本的 python 类子类系统，但我遇到了一个奇怪的问题。

首先，类的定义：

文件类.py

```
class BaseAd(object):
    """ base class for all the ads, with common parameters """

    def __init__(self, dom, web, loc, cc, a, c, date, desc, hl, **kwargs):
        self.domain = self.doDomain(dom)
        self.url = self.doUrl(web)
        self.description = self.doDescription(desc, hl)
        self.location = self.doLocation(a, c, loc)
        self.date = self.doDate(date) 
```

文件作业.py

```
class JobAd(BaseAd):
    """ extends BaseAd with more parameters """

    def __init__(self, domain, url, location, countrycode, area, city, 
                 index_date, description, 
                 contract_multivalue, salary_min, company, job_title, **kwargs):

        self.contract_type = self.doContract(contract_multivalue)
        self.salary = self.doSalary(salary_min)
        self.company = self.doCompany(company)
        self.title = self.doTitle(job_title)

        """ Super constructor call """
        super(JobAd, self).__init__(
            domain,
            url,
            location,
            countrycode,
            area,
            city,
            index_date,
            description,
            **kwargs
        ) 
```

这两个类都有各自的方法（域、doSalary 等），这些方法现在无关紧要，因为它们只是返回作为输入获得的字符串（将来会更好地实现，现在只是不需要）。kwargs 仅用于存储一些无用但仍返回原始 dict 的参数（否则我会收到错误消息）

JobAd 类用作我们的 python-to-solr 接口 sunburnt 的构造函数[参数](https://github.com/tow/sunburnt)。在您定义一个类并将其传递给该方法后，它会将 solr 响应中定义的字段（它只是一个 dict）转换为该类。因此，在 JobAd 的 init 中定义的参数必须与它们在 solr 模式中的定义具有相同的名称。

这是实际的构造函数调用：

```
/path/to/myapp/resultsets/views_json.py in job_search_json
        #lines splitted for better reading
        #res is a solr search object

        items = res.paginate(start=start, rows=res_per_page)
        .sort_by("-index_date")
        .sort_by("-score")
        .sort_by("-md5")
        .sort_by("-posted_date")
        .execute(constructor=JobAd) 
```

堆栈跟踪中的下一个是：

```
/path/to/sunburnt-0.6-py2.7.egg/sunburnt/search.py in execute

        return self.transform_result(result, constructor)

    ...

▼ Local vars
Variable         Value
self             sunburnt.search.SolrSearch object at 0x7f8136e78450
result           sunburnt.schema.SolrResponse object at 0x7f8136e783d0
constructor      class 'myapp.models.jobs.JobAd' 
```

最后

```
/path/to/sunburnt-0.6-py2.7.egg/sunburnt/search.py in transform_result

            result.result.docs = [constructor(**d) for d in result.result.docs] 
```

在最后一个“本地变量”选项卡中，有结果字典（只是结构，而不是带有值的完整字典）：

```
self    sunburnt.search.SolrSearch object at 0x7f8136e78450
d      {'area': 
        'city': 
        'contract_multivalue': 
        'country': 
        'countrycode': 
        'currency': 
        'description': 
        'district': 
        'domain': 
        'fileName': 
        'index_date':
        'job_experience':
        'job_field_multivalue':
        'job_position_multivalue': 
        'job_title':
        'job_title_fac':
        'latitude': 
        'location': 
        'longitude': 
        'md5':
        'salary_max': 
        'salary_min': 
        'study':
        'url':
        'urlPage':
        }

constructor    class 'tothego_frontend.sito_maynard.models.jobs.JobAd' 
```

在 django.log 文件中，没有其他错误，除了 DogSlow 陷阱只告诉被困行。

这是我得到的错误：

```
TypeError at /jobs/us/search/

__init__() takes exactly 13 arguments (12 given) 
```

我期望的行为不是我实际遇到的行为：我的类没有调用其父类的构造函数（10 个参数），而是使用自己的 init（14 个参数）。

我也一直在尝试使用旧的 python 类定义：超类中没有“对象”；在子类的 init 中，父类被初始化为 BaseAd。**初始化**（自我，...）；我也一直在尝试将超级方法称为子类 init（a la java）中的第一条语句，但似乎没有任何改变。

我在这里做错了什么？

编辑：我固定了第二个初始化行的长度，有点太多了！

**来自 DJANGO 的堆栈跟踪的附加信息**

最新技术：我开始假设 sunburnt 不支持类继承，即使文档中没有关于它的内容。

**新编辑**：经过今天的一些测试，这就是我发现的（到目前为止）

*   晒伤允许继承
*   我有 3 个参数不同步，更新了代码和错误

现在它总是缺少一个论点。也许是“自我”？我真的不知道在哪里看，错误和以前一样（相同的堆栈跟踪）只是不同的错误参数。

**实际上发现了问题**，向 init 参数添加一些默认值帮助我发现了真正的错误：输入中缺少字段。对不起，你们浪费了你们的时间，再次感谢你们的咨询

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:14:23.887

我已经采用了您的代码（`do*`从 s 中删除了方法`__init__`）并变成了一个更简单的示例，以尝试在您陈述问题时重新创建您的问题。

```
class BaseAd(object):
    """ base class for all the ads, with common parameters """

    def __init__(self, dom, web, loc, cc, a, c, date, desc, hl, **kwargs):
        self.domain = dom
        self.url = web
        self.description = desc
        self.location = loc
        self.date = date

class JobAd(BaseAd):
    """ extends BaseAd with more parameters """

    def __init__(self, domain, url, location, countrycode, area, city, 
                 index_date, description, solr_highlights, 
                 contract_type, salary, company, job_title, **kwargs):

        self.contract_type = contract_type
        self.salary = salary
        self.company = company
        self.title = job_title

        """ Super constructor call """
        super(JobAd, self).__init__(
            domain,
            url,
            location,
            countrycode,
            area,
            city,
            index_date,
            description,
            solr_highlights,
            **kwargs
        )

j = JobAd(1,2,3,4,5,6,7,8,9,10,11,12,13,kwarg1="foo",kwarg2="bar") 
```

运行 python 2.7.2 时，它执行得很好，没有错误。我建议`__init__`错误中提到的可能`JobAd`不是 super 的，因为`JobAd`init 实际上有 14 个参数，这就是错误所抱怨的。我建议尝试找到一个`__init__`调用 JobAdd 时参数数量不足的地方。

正如其他人所说，发布完整的堆栈跟踪并展示 JobAd 的使用方式对于确定根本原因非常宝贵。

# macos - 将自定义 NSManagedObjectContexts 与 NSPersistentDocument 一起使用

> ID：10952108
> 
> 赞同：0
> 
> 时间：2012-06-08T15:50:24.813
> 
> 标签：macos, core-data, nspersistentdocument

我有一个 NSPersistentDocument。当我使用默认的 managedObjectContext 时，它的行为符合预期：添加新对象时，窗口显示文档已“编辑”，当我退出新的无标题文档时，会出现“另存为”表。

但是，当我用我自己创建的一个（私有队列）替换默认 managedObjectContext 时，所有这些行为都消失了。当对文档进行编辑时，文档似乎无法识别，并且新的、无标题的文档只是关闭而没有出现“另存为”表。尽管 [managedObjectContext hasChanges] == YES，这一切都发生了。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:46:46.273

我想通了：我没有将文档的 undoManager 设置为我的自定义 managedObjectContext。现在事情按预期工作。

# iphone - Objective C 在图像顶部绘制自由形状

> ID：10952109
> 
> 赞同：1
> 
> 时间：2012-06-08T15:50:34.817
> 
> 标签：iphone, objective-c, ios, draw

我正在开发一个 iOS 5 iPhone 项目，用户可以在他们的设备上选择一个图像，然后在图片中追踪一个对象（从水果篮的图片中追踪一个苹果），然后图片需要上传“标记”的对象，以便以后可以将其拉下。然后其他人将拉下图像并尝试找到标记对象在图片中的位置（想想“Waldo 在哪里？”）。

我一直在试图找出追踪对象的最佳方法。之前，我让用户按下对象周围的左上、右上、左下和右下点，然后在对象周围创建一个方形视图。该视图的信息已上传，然后被拉下以供用户查找对象。缺点是所有对象显然都不是正方形/矩形，所以我需要做一个自由形状。

我正在考虑允许用户在对象上绘制，然后以某种方式我需要能够分辨出跟踪内部的内容（例如，他们跟踪的圆圈内部），但我预见到的一个问题是确保他们制作的痕迹是封闭的，所以我可以填写形状（这完全没有问题）。

欢迎任何关于开始这个的最佳方式的建议。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:56:39.877

[UIBezierPath](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIBezierPath_class/Reference/Reference.html)在这里可能是一个非常有用的朋友。它允许您创建所需的任何形状，并且支持绘图和命中检测。我最近为一本故事书做了一个实现，我可以用他们的手指勾勒出一个形状，将其冻结，然后使用该形状进行敲击检测。

基本思想是这样的：

当您的手指触摸屏幕时，开始记录位置。丢弃任何与前一个位置太接近的位置（例如，仅在距离上一个记录点 >min-distance 时才记录一个点）。执行此操作时，您可以绘制 UIBezierPath，以便查看正在追踪的内容。通过向其添加点来修改 UIBezierPath，而不是每次都重新创建它。* 当您抬起手指时，关闭贝塞尔路径。非常简单。

现在，这将产生一个多边形（即直边）。*如果您的最小距离足够低，或者如果您将其用于命中检测（如您所说）*，那并不重要。但是，如果您想平滑路径，则必须使用曲线到方法，这会使它稍微复杂化 - 但如果您希望进一步了解这一点，请阅读样条曲线和从点序列生成样条曲线。

*注意：否则在绘制大型形状时会出现延迟，因为从越来越多的点系列重新创建贝塞尔路径会变得昂贵。修改现有路径会使它变得更快、更快。

# javafx-2 - 带有多行表头的 JavaFX 2.0 表

> ID：10952111
> 
> 赞同：8
> 
> 时间：2012-06-08T15:50:47.327
> 
> 标签：javafx-2

是否可以使用多行标题制作 javaFX 2.0 表？我在网上找到的所有示例都有表格，其中列标题宽度 = 其文本大小，没有换行。我有什么，我需要什么的例子显示在屏幕上：![在此处输入图像描述](../Images/1b058fc5631aac14950736ff6b219893.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2017-01-16T13:45:10.073

找到了不使用标签的解决方案。在 Scene Builder 8.3.0 (Gluon) 和 JavaFX 8 中，鼠标悬停时会出现一个按钮，位于 Text 字段的右侧，可以从菜单中选择多行。

[![多行模式菜单](../Images/5ba7c6e51ff0e75ee1b0e21bb6ddffb9.png)](https://i.stack.imgur.com/gcMAw.png)

这会产生以下 XML 代码：

```
<TableColumn fx:id="prodDisc" editable="false" prefWidth="50.0" text="Prod &#10;Disc" /> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-08T21:34:11.187

我想出了以下功能：

```
private void makeHeaderWrappable(TableColumn col) {
  Label label = new Label(col.getText());
  label.setStyle("-fx-padding: 8px;");
  label.setWrapText(true);
  label.setAlignment(Pos.CENTER);
  label.setTextAlignment(TextAlignment.CENTER);

  StackPane stack = new StackPane();
  stack.getChildren().add(label);
  stack.prefWidthProperty().bind(col.widthProperty().subtract(5));
  label.prefWidthProperty().bind(stack.prefWidthProperty());
  col.setGraphic(stack);
} 
```

[此要点中](https://gist.github.com/2898196)有一个完整的可执行示例（至少需要[2.2 开发人员预览版](http://www.oracle.com/technetwork/java/javafx/downloads/devpreview-1429449.html)）。

```
import javafx.application.Application;
import javafx.beans.property.SimpleStringProperty;
import javafx.collections.FXCollections;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.control.cell.PropertyValueFactory;
import javafx.scene.layout.Pane;
import javafx.scene.layout.StackPane;
import javafx.scene.layout.VBox;
import javafx.scene.text.TextAlignment;
import javafx.stage.Stage;

public class TableWrappedHeaders extends Application {
  public static void main(String[] args) { launch(args); }

  @Override public void start(Stage stage) {
    TableColumn firstNameCol = new TableColumn("First Name (which is a really long name)");
    makeHeaderWrappable(firstNameCol);
    firstNameCol.setPrefWidth(100);
    firstNameCol.setCellValueFactory(new PropertyValueFactory<Person,String>("firstName"));
    TableColumn lastNameCol = new TableColumn("Last Name");
    lastNameCol.setPrefWidth(100);
    lastNameCol.setCellValueFactory(new PropertyValueFactory<Person,String>("lastName"));

    TableView table = new TableView();
    table.getColumns().addAll(firstNameCol, lastNameCol);
    table.setItems(FXCollections.observableArrayList(
      new Person("Jacob", "Smith"),
      new Person("Isabella", "Johnson"),
      new Person("Ethan", "Williams")
    ));
    table.setPrefSize(250, 200);

    Pane layout = new VBox(10);
    layout.setStyle("-fx-padding: 10;");
    layout.getChildren().addAll(table);
    stage.setScene(new Scene(layout));
    stage.show();
  }

  private void makeHeaderWrappable(TableColumn col) {
    Label label = new Label(col.getText());
    label.setStyle("-fx-padding: 8px;");
    label.setWrapText(true);
    label.setAlignment(Pos.CENTER);
    label.setTextAlignment(TextAlignment.CENTER);

    StackPane stack = new StackPane();
    stack.getChildren().add(label);
    stack.prefWidthProperty().bind(col.widthProperty().subtract(5));
    label.prefWidthProperty().bind(stack.prefWidthProperty());
    col.setText(null);
    col.setGraphic(stack);
  }

  public static class Person {
    private final SimpleStringProperty firstName;
    private final SimpleStringProperty lastName;

    private Person(String fName, String lName) {
      this.firstName = new SimpleStringProperty(fName);
      this.lastName = new SimpleStringProperty(lName);
    }

    public String getFirstName() { return firstName.get(); }
    public void setFirstName(String fName) { firstName.set(fName); }
    public String getLastName() { return lastName.get(); }
    public void setLastName(String fName) { lastName.set(fName); }
  }
} 
```

可能有更好的方法可以做到这一点，但上面的功能至少在我的测试用例中对我有用。

我认为这可以通过简单的 css 样式实现，但我无法仅通过 css 使其工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-06-04T20:00:41.943

在列的标题图形中使用标签更容易：

1.  在列标题图形中添加标签（如果列有一些文本作为标题，请删除它）。
2.  设置标签以允许换行文本（场景生成器 -> 转到标签的属性并选择换行文本或在代码中 -> label.setWrapText(true)）
3.  设置我们希望的标签宽度和高度

注意：在 FXML（使用 Scene Builder）中比在代码中更容易做到这一点。

下面的例子：

```
 public class TableColumnLongTextLabel extends Application {

    @Override
    public void start(Stage stage) {
        TableView table = new TableView();
        TableColumn tableColumnData1 = new TableColumn(),
                tableColumnData2 = new TableColumn("Long Title without Text Wrap");

        tableColumnData1.setCellValueFactory(new PropertyValueFactory<SomeStructure, String>("data1"));
        tableColumnData2.setCellValueFactory(new PropertyValueFactory<SomeStructure, String>("data2"));

        table.getColumns().addAll(tableColumnData1, tableColumnData2);

        Label columnTitle = new Label("Long Title with Text Wrapped");
        columnTitle.setPrefWidth(125);
        columnTitle.setPrefHeight(50);
        columnTitle.setWrapText(true);
        columnTitle.setTextAlignment(TextAlignment.CENTER);
        tableColumnData1.setGraphic(columnTitle);

        table.setItems(FXCollections.observableArrayList(
                new SomeStructure("Java", "FX", 1),
                new SomeStructure("Java", "Swing", 0),
                new SomeStructure("Java", "Sample", 2),
                new SomeStructure("Some", "Other", 10)
        ));

        Pane layout = new VBox(10);
        layout.getChildren().addAll(table);
        stage.setScene(new Scene(layout, 350, 350));
        stage.show();
    }

    public static class SomeStructure {

        private final SimpleStringProperty data1;
        private final SimpleStringProperty data2;
        private final SimpleIntegerProperty data3;

        private SomeStructure(String data1, String data2, Integer data3) {
            this.data1 = new SimpleStringProperty(data1);
            this.data2 = new SimpleStringProperty(data2);
            this.data3 = new SimpleIntegerProperty(data3);
        }

        public String getData1() {
            return data1.get();
        }

        public void setData1(String data1) {
            this.data1.set(data1);
        }

        public String getData2() {
            return data2.get();
        }

        public void setData2(String data2) {
            this.data2.set(data2);
        }

        public Integer getData3() {
            return data3.get();
        }

        public void setData3(Integer data3) {
            this.data3.set(data3);
        }
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

使用 FXML 的示例（无需代码 :)）：

```
<TableView prefHeight="251.0" prefWidth="556.0" xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1">
       <columns>
          <TableColumn editable="false" maxWidth="90.0" prefWidth="70.0" sortable="false" text="Player">
             <columns>
                <TableColumn editable="false" maxWidth="80.0" prefWidth="50.0" text="ID" />
                <TableColumn editable="false" maxWidth="200.0" prefWidth="180.0" text="Name" />
             </columns>
          </TableColumn>
          <TableColumn maxWidth="80.0" minWidth="50.0" prefWidth="60.0" text="Game" />
          <TableColumn editable="false" maxWidth="160.0" minWidth="125.0" prefWidth="135.0" sortable="false" text="Team" visible="false" />
          <TableColumn editable="false" maxWidth="160.0" minWidth="107.0" prefWidth="107.0" sortable="false">
             <graphic>
                <Label alignment="CENTER" text="Individual Points (Big Team)" textAlignment="CENTER" wrapText="true" />
             </graphic>
          </TableColumn>
          <TableColumn editable="false" maxWidth="160.0" minWidth="99.0" prefWidth="102.0" sortable="false">
             <graphic>
                <Label alignment="CENTER" text="Team Points (Small Maps)" textAlignment="CENTER" wrapText="true" />
             </graphic>
          </TableColumn>
          <TableColumn editable="false" maxWidth="116.0" minWidth="55.0" prefWidth="55.0" sortable="false">
             <graphic>
                <Label text="Total Points" textAlignment="CENTER" wrapText="true" />
             </graphic>
          </TableColumn>
       </columns>
    </TableView> 
```

![在此处输入图像描述](../Images/746cab008556ed65104b5f42ebd63969.png)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-10-06T14:34:50.233

对齐标题文本最简单的方法是使用 CSS 样式，如下所示：

```
.table-view .column-header .label {
  -fx-text-alignment: center;
} 
```

在标题文本字符串中使用换行符“\n”将其拆分为多行。

# spring-mvc - 字段 'SYSTEM_PROPERTIES_MODE_ENVIRONMENT' 和 PropertyPlaceHolderConfigurer 有什么关系？

> ID：10952114
> 
> 赞同：12
> 
> 时间：2012-06-08T15:50:53.287
> 
> 标签：spring-mvc

我正在将 spring 3.0.6-RELEASE 用于基于基本表单的 webapp，并在使用 PropertyPlaceHolderConfigurer 启动时遇到以下错误。不确定是什么导致了这种情况，因为注入属性 pre-mvc3 是通过 bean 完成的，现在使用注释，并且至少从文档/其他帖子中看起来非常简单。

然而，在 tomcat 服务器启动期间的异常抱怨 org.springframework.core.ConstantException: Field 'SYSTEM_PROPERTIES_MODE_ENVIRONMENT' not found in class [org.springframework.beans.factory.config.PropertyPlaceholderConfigurer]

这是我在 spring-servlet.xml 中的内容

```
<context:property-placeholder location="/WEB-INF/classes/spring.properties"/> 
```

和我的控制器类

```
@Controller
@RequestMapping("/home")

public class HomeController {

    // @Resource(name="broomManager")
    @Autowired
    private broomManager broomManager;
    private @Value("${spring.broom.maxFileSize}") String inMemoryMaxFileSize;
    private @Value("${spring.broom.fileDestination}") String destFilePath; 
```

..

spring.properties

```
broom.maxFileSize=100000
broom.fileDestination=/Users/foobar/broom/files/ 
```

启动时异常

```
2012-06-08 02:51:31,900 [ContainerBackgroundProcessor[StandardEngine[Catalina]]] ERROR org.springframework.web.servlet.DispatcherServlet - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.beans.factory.config.PropertyPlaceholderConfigurer#0': Error setting property values; nested exception is org.springframework.beans.PropertyBatchUpdateException; nested PropertyAccessExceptions (1) are:
PropertyAccessException 1: org.springframework.beans.MethodInvocationException: Property 'systemPropertiesModeName' threw exception; nested exception is org.springframework.core.ConstantException: Field 'SYSTEM_PROPERTIES_MODE_ENVIRONMENT' not found in class [org.springframework.beans.factory.config.PropertyPlaceholderConfigurer]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1361)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1086)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:293)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:290)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:196)
    at org.springframework.context.support.AbstractApplicationContext.invokeBeanFactoryPostProcessors(AbstractApplicationContext.java:626)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:407)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:467)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:483)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:358)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:325)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:127)
    at javax.servlet.GenericServlet.init(GenericServlet.java:212)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1139)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:966)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:3956)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4230)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:760)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:740)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:544)
    at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:831)
    at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:720)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:490)
    at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1217)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:293)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:120)
    at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1306)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1570)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1579)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1559)
    at java.lang.Thread.run(Thread.java:680)
Caused by: org.springframework.beans.PropertyBatchUpdateException; nested PropertyAccessExceptions (1) are:
PropertyAccessException 1: org.springframework.beans.MethodInvocationException: Property 'systemPropertiesModeName' threw exception; nested exception is org.springframework.core.ConstantException: Field 'SYSTEM_PROPERTIES_MODE_ENVIRONMENT' not found in class [org.springframework.beans.factory.config.PropertyPlaceholderConfigurer]
    at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:102)
    at org.springframework.beans.AbstractPropertyAccessor.setPropertyValues(AbstractPropertyAccessor.java:58)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1358)
    ... 33 more 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-18T22:07:50.380

可能会发生以下情况：

*   您的 Spring 配置文件指向 3.1 模式。
*   您正在使用 3.0.6 JAR。

他们需要匹配。

# java - Swing form database connection

> ID：10952117
> 
> 赞同：0
> 
> 时间：2012-06-08T15:51:06.170
> 
> 标签：java, database, swing, database-connection

I am new to Java and [NetBeans](http://en.wikipedia.org/wiki/NetBeans), and I am attempting to create a form that

1.  connects to a database using [JDBC](http://en.wikipedia.org/wiki/Java_Database_Connectivity) connection
2.  reads information from seven columns and displays them on a jTable component already on the form

I already have this working. I am now trying to optimize my code and use a better architecture to separate the database connection and the user interface (UI forms) code so that I can have a separate class to perform the connection and then simply call the method from this class in the code behind the button. The problem with using NetBeans and forms is that I don't know where to instantiate this class and such. Below is a cope of the class that I have created to perform the JDBC connection

```
public class ConnectionManager {
private static String url = "jdbc:mysql://localhost:3306/prototypeeop";
private static String driverName = "com.mysql.jdbc.Driver";
private static String username = "root";
private static String password = "triala";
private static Connection con;
private static String url;

public static Connection getConnection() {
    try {
        Class.forName(driverName);
        try {
            con = DriverManager.getConnection(url, username, password);
        } catch (SQLException ex) {
            // log an exception. fro example:
            System.out.println("Failed to create the database connection.");
        }
    } catch (ClassNotFoundException ex) {
        // log an exception. for example:
        System.out.println("Driver not found.");
    }
    return con;
} 
```

}

This is already a `.java` file. I have a JForm, and I need to call this method behind the button. Here is how I do it in the form currently without using a connection class:

```
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {
    DefaultTableModel model=(DefaultTableModel)jTable1.getModel();
    model.setRowCount(0);
    String sql="Select * from eopdata";
    try
    {
        Class.forName("com.mysql.jdbc.Driver");
        Connection con=(Connection)DriverManager.getConnection("jdbc:mysql://localhost:3306/prototypeeop","root","jakamuga");
        Statement stmt=con.createStatement();
        ResultSet rs=stmt.executeQuery(sql);
        while(rs.next())
        {
            String Year=rs.getString("Year");
            String Month=rs.getString("Month");
            String Day=rs.getString("Day");
            String MJD=rs.getString("MJD");
            Double xarcsec=rs.getDouble("xarcsec");
            Double yarcsec=rs.getDouble("yarcsec");
            Double UT1UTCsec=rs.getDouble("UT1UTCsec");
            model.addRow(new Object[] { Year, Month, Day, MJD,xarcsec,yarcsec,UT1UTCsec});
        }
    }
    catch(Exception e) {
        JOptionPane.showMessageDialog(this, e.getMessage());
    } 
```

How can I use the class instead of hard coding in the connection? I have already created the class but where do I instantiate it. Do I do it in the main of the form or do I do it in the actionevent code with the following code?

```
private Connection con = null;
private Statement stmt = null;
private ResultSet rs = null;

con = ConnectionManager.getConnection();
stmt = con.createStatement();
rs = stmt.executeQuery(sql); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:57:31.980

To literally answer your question: your `getConnection` method is a `public static` method so you can call this from anywhere. Just call `ConnectionManager.getConnection()` where-ever you need that connection.

Some other remarks about your code:

*   You shouldn't query a database in the `actionPerformed` method. This method is called on the EDT, and doing a database query and looping over the results is a long-running task. Doing this task on the EDT will block your UI. Consult the [Concurrency in Swing](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/) tutorial for more info about Swing and threading
*   Consider caching the `Connection` object
*   Do not forget to close your resources. If I remember correctly, a `ResultSet` must be closed afterwards. Do this in a finally block

# html - 什么是典型的设备像素比？

> ID：10952127
> 
> 赞同：1
> 
> 时间：2012-06-08T15:51:46.247
> 
> 标签：html, mobile-website

作为 Web 开发人员，我应该针对哪些设备像素比进行设计？我只遇到过 1.5 和 2.0，我应该知道其他的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:00:38.357

通常 1.5 和 2.0 会覆盖你的基地。没有任何设备可以使用超过“2”像素比的任何设备，并且无法显示完美“2”的设备仍将比低分辨率图像显示更好。

# java - Swing 中的本地化加速器（JMenuItem 热键）

> ID：10952130
> 
> 赞同：1
> 
> 时间：2012-06-08T15:51:52.150
> 
> 标签：java, swing, internationalization, keystroke, acceleratorkey

我正在使用西班牙语操作系统的德语笔记本电脑上的英语应用程序工作。

即使我在我的应用程序开始时明确设置 Locale.setDefault(Locale.ENGLISH) ，我在菜单中看到的 hotkexs 为

```
CTRL + Mayúsculas + C 
```

代替

```
CTRL + SHIFT + C 
```

我传递给 KeyStroke 对象。

不仅这个词没有像我指定的那样本地化为英语，而且它还将 SHIFT 键映射到 MAYUS（英语中的 CAPS LOCK），所以我想这不仅是语言问题，也是键盘映射的问题。

那么我怎样才能为所有的 GUI 组件强加英语呢？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:23:51.193

您必须确保在执行任何工具包代码之前设置语言环境。以下代码显示了效果：如果将 移动`Locale.setDefault(Locale.GERMAN);`到任何其他行，它将再次显示默认的加速器名称。

除了在代码中设置语言环境，您还可以将以下参数附加到 VM：

```
-Duser.language=DE 
```

![语言环境菜单](../Images/765526d5287e104f258c2e975209de0f.png)

```
public class MenuLocale {

    public static void main(String[] args) {
        Locale.setDefault(Locale.GERMAN);
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                JFrame f = new JFrame();
                f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

                JMenuBar menubar = new JMenuBar();
                JMenu menu = new JMenu("Menu");
                JMenuItem menuitem = new JMenuItem("Menuitem");    
                menuitem.setAccelerator(KeyStroke.getKeyStroke('X', KeyEvent.CTRL_MASK | KeyEvent.SHIFT_MASK));

                f.setJMenuBar(menubar);
                menubar.add(menu);
                menu.add(menuitem);

                f.pack();
                f.setVisible(true);
            }
        });
    }
} 
```

# ios - iOS自定义后退按钮，无需在每个视图控制器中调用方法

> ID：10952131
> 
> 赞同：1
> 
> 时间：2012-06-08T15:51:57.350
> 
> 标签：ios, cocoa-touch, back-button, objective-c-category

我想要一个更优雅的解决方案来更改应用程序导航栏的后退按钮。我看到的所有答案都只谈论自定义一个按钮，然后向每个视图控制器添加至少一行代码以显示新按钮。

我有一个类别，我可以在其中修改导航栏的背景和标题。它是 的一个类别`UINavigationBar`。`willMoveToWindow:`每次在导航控制器上推送新视图时，类别调用调用方法。

因此，创建新按钮的代码如下所示：

```
- (void)applyCustomButton{
    UIButton *backButton = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, 26, 26)];
    [backButton setImage:[UIImage imageNamed:@"arrow-left"] forState:UIControlStateNormal];
    [backButton setShowsTouchWhenHighlighted:TRUE];
    [backButton addTarget:self action:@selector(popViewControllerAnimated:) forControlEvents:UIControlEventTouchDown];

    UIBarButtonItem *barButtonItem = [[UIBarButtonItem alloc] initWithCustomView:backButton];
    [self.navigationItem setLeftBarButtonItem:barButtonItem];    
} 
```

这里的问题是在这里`self.navigationItem`行不通。我不想让你对我尝试分类的所有事情感到厌烦，但该属性仅适用于视图控制器（我认为）？

您不必为上面的代码提供解决方案，也许您有更好的方法来自定义导航栏上的后退按钮，而不必在我拥有的每个 View Controller 类上编写代码。我只是讨厌重复，因为维护这样的代码很糟糕。

提前致谢。

# xml - 存储、检索和显示大量文本

> ID：10952138
> 
> 赞同：0
> 
> 时间：2012-06-08T15:52:22.157
> 
> 标签：xml, database, ruby-on-rails-3, json, text

我选择了存储在特定标记标准中的文件，这些文件组合起来构成了整个文本量。该文本有多种不同的语言版本，并且每个文件都针对该语言进行了复制。

为了通过 Web 应用程序存储、检索然后向潜在的大量用户显示该信息，我需要实现最合适的方法。目前我的思路是：

将文件转换为 XML（标记语言旨在使这很容易），然后在用户想要查看该部分时加载相关文件。我正在使用 Rails 和 Ember.js 来显示结果，因此（我认为）要求数据采用 JSON 格式。

我的问题是：

我应该将 XML 转换为 JSON 并将其存储在文件中，还是每次请求时都转换 XML 更好？我应该将数据存储在文件中还是应该将它们移动到数据库中？鉴于文本的每个部分都可以有脚注和其他参考，如果我沿着数据库路线走，对于每种语言，将每个部分存储为表中的一个字段会更好吗？还是每种语言都应该有自己的表格？我是否应该进一步分解并为一种语言中的每个部分提供一个表格，然后该表格包含段落、脚注、参考等字段？

我正在寻找实现这一点的最佳方法的答案，而不是能够实现它的实际方法。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:24:07.217

我使用[eXist](http://exist-db.org)来存储 XML 文档，它对我来说效果很好。它是一个 XML 数据库，允许您存储 XML 文档并通过 XPATH 和 XQUERY 查询它们。还有一些用于基于文本的搜索的 Lucene 集成。如果您正在考虑存储 XML，您可能需要研究一下。

# c# - 数组和线程安全访问

> ID：10952146
> 
> 赞同：4
> 
> 时间：2012-06-08T15:52:53.777
> 
> 标签：c#, .net, arrays

如果我有一个可以/将在任何给定时间点由多个线程访问的数组，究竟是什么导致它是非线程安全的，以及为确保该数组在大多数情况下是线程安全的而采取的步骤情况？

我在互联网上进行了广泛的查看，几乎没有发现关于这个主题的信息，一切似乎都是特定的场景（例如，这个数组，这两个线程正在像这样访问线程安全，等等）。我真的很希望有人可以回答我在顶部列出的问题，或者是否有人可以指出解释上述项目的好文件。

编辑：在 MSDN 上环顾四周后，我找到了 ArrayList 类。当您使用 synchronize 方法时，它会为给定列表返回一个线程安全的包装器。在列表中设置数据时（即 list1[someNumber] = anotherNumber;），包装器会自动处理锁定列表，还是仍然需要锁定它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T16:23:02.877

当两个线程访问完全相同的资源（例如，不是本地副本，而是实际上是同一资源的相同副本）时，可能会发生很多事情。在最明显的情况下，如果 Thread #1 正在访问资源并且 Thread #2 在读取过程中对其进行了更改，则可能会发生一些不可预知的行为。即使使用像整数这样简单的东西，也可能会出现逻辑错误，因此请尝试想象不正确地使用更复杂的东西可能导致的恐怖，例如声明为静态的数据库访问类。

处理这个问题的经典方法是锁定敏感资源，这样一次只有一个线程可以使用它。所以在上面的例子中，线程#1 会请求一个资源的锁并被授予它，然后进入读取它需要读取的内容。线程#2 会在读取过程中出现并请求锁定资源，但由于线程#1 正在使用它而被拒绝并被告知等待。当线程 #1 完成时，它会释放锁，线程 #2 可以继续进行。

还有其他情况，但这说明了最基本的问题和解决方案之一。在 C# 中，您可以：

1) 使用由框架管理为可锁定的特定 .NET 对象（如 Scorpion-Prince[到 SynchronizedCollection 的链接](http://msdn.microsoft.com/en-us/library/ms668265.aspx)）

2) 使用[[MethodImpl(MethodImplOptions.Synchronized)]](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.methodimploptions.aspx)指示执行危险操作的特定方法一次只能由一个线程使用

3) 使用[lock 语句](http://msdn.microsoft.com/en-us/library/c5kehkcz%28v=vs.71%29.aspx)隔离正在执行潜在危险的特定代码行

哪种方法最好取决于您的情况。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T16:14:04.033

> 如果我有一个可以/将在任何给定时间点由多个线程访问的数组，究竟是什么导致它是非线程安全的，以及为确保该数组在大多数情况下是线程安全的而采取的步骤情况？

一般而言，数组不是线程安全的事实是，如果您不同步访问数组，则两个或多个线程可能正在修改数组的内容。

一般来说，例如，假设您有线程 1 执行此工作：

```
for (int i = 0; i < array.Length; i++)
{
   array[i] = "Hello";
} 
```

线程 2 做这项工作（在同一个共享数组上）

```
for (int i = 0; i < array.Length; i++)
{
   array[i] = "Goodbye";
} 
```

没有任何东西可以同步线程，因此您的结果将取决于哪个线程首先赢得比赛。它可以是“Hello”或“Goodbye”，以某种随机顺序排列，但始终至少是“Hello”或“Goodbye”。

CLR 保证字符串“Hello”或“Goodbye”的实际**写入**是原子的。也就是说，值'Hello'的写入不能被试图写入'Goodbye'的线程中断。一个必须发生在另一个之前或之后，绝不能介于两者之间。

所以你需要创建某种同步机制来防止数组相互踩踏。您可以通过使用`lock`C# 中的语句来完成此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T15:55:39.893

C# 3.0 及更高版本提供了一个名为[SynchronizedCollection](http://msdn.microsoft.com/en-us/library/ms668265.aspx)的泛型集合类，它“提供了一个线程安全的集合，其中包含由泛型参数指定的类型的对象作为元素。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-01T08:50:24.190

数组是线程安全的，如果它被命名`public`并且`static`关键字 - 不保证即时 - 因为它`System.Array`实现了`ICollection`定义一些同步方法以支持同步机制的接口。

但是，通过数组项进行枚举的编码是不安全的，开发人员应执行`lock`语句以确保在数组枚举期间不会更改数组。

前任：

```
Array arrThreadSafe = new string[] {"We", "are", "safe"};
lock(arrThreadSafe.SyncRoot)
{
   foreach (string item in arrThreadSafe)
   {
     Console.WriteLine(item);
   }
} 
```

# c++ - 如何使用 C++ 从 Windows 上的注册表中获取具有完整路径的“打开方式”程序？

> ID：10952148
> 
> 赞同：0
> 
> 时间：2012-06-08T15:53:02.790
> 
> 标签：c++, windows, qt, registry

我正在使用 Qt，它有一个非常有用的`QSettings`类，可以轻松访问 Windows 注册表：

```
QSettings s("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FileExts\\.html\\OpenWithList", QSettings::NativeFormat); 
```

`s.value("a").toString()`返回`"chrome.exe"`。

Chrome 不在我电脑的 PATH 中。在终端中运行`chrome.exe`会导致未找到错误。所以我不能只在我的 C++ 应用程序中运行它。

我也无法获得它的图标，因为我需要完整路径。

那么我如何找到这个完整的路径呢？（在 Chrome 的情况下是`C:\Users\Administrator\AppData\Local\Google\Chrome\Application\chrome.exe`）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:00:17.153

不要直接弄乱注册表 -[`FindExecutable`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776419.aspx)旨在准确生成您想要/需要的内容。

# identity - 我的 Sybase CREATE TABLE 语法有什么问题？

> ID：10952154
> 
> 赞同：0
> 
> 时间：2012-06-08T15:53:25.627
> 
> 标签：identity, sap-ase, auto-increment, squirrel-sql

我的语法有什么问题？我严格遵守[Sybase 参考中的规则](http://infocenter.sybase.com/archive/index.jsp?topic=/com.sybase.infocenter.dc00170.1260/html/iqapg/iqapg491.htm)

```
CREATE TABLE dashlogactions (
    action_id SMALLINT NOT NULL DEFAULT IDENTITY PRIMARY KEY,
    action_name VARCHAR(64) NOT NULL UNIQUE
) 
```

SQuirrel SQL 客户端（3.3.0 版）报错：

```
Error: Incorrect syntax near the keyword 'DEFAULT'.

SQLState:  ZZZZZ
ErrorCode: 156 
```

SQuirrel 还以红色显示 IDENTITY 和 KEY 字样，当我将鼠标悬停在它们上方时，它表示`Invalid ColumnDefault`IDENTITY 和`EOF expected`KEY。

如果我用 AUTOINCREMENT 替换 IDENTITY 这个词，我会得到相同的结果。

我使用的是 Sybase Adaptive Server Enterprise，虽然我不确定版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:56:39.537

如果使用默认值，则需要提供默认值。[请参阅文档。](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.commands/html/commands/commands28.htm)

# passwords - 检查单个字符术语的密码规则

> ID：10952155
> 
> 赞同：0
> 
> 时间：2012-06-08T15:53:33.310
> 
> 标签：passwords

我们有一个检查用户属性的密码规则。问题是有时属性可能是单个字符，例如“a”。在这种情况下，任何包含“a”的密码都将被拒绝。这通常是如何处理的？根据属性值检查长度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:58:27.040

长度检查听起来很棒！在拒绝之前，请确保该属性超过 5 个字符（3？4？6？）并且包含在密码中。这是你的选择。

# xaml - XAML：背景设置器在 CustomControl 页面中被忽略

> ID：10952157
> 
> 赞同：1
> 
> 时间：2012-06-08T15:53:51.290
> 
> 标签：xaml, background, custom-controls

我创建了一个从 Page 派生的自定义控件。

```
namespace The_Toolbox
{
  public class BlancoPageControl : Page
  {
    static BlancoPageControl()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(BlancoPageControl), new FrameworkPropertyMetadata(typeof(BlancoPageControl)));
    }
  }
} 
```

在 Generic.xaml 中，我可以设置前景色。但由于我不明白的原因，我无法设置背景颜色。

```
<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="clr-namespace:The_Toolbox">
  <Style TargetType="{x:Type local:BlancoPageControl}">
    <Setter Property="Foreground" Value="White"/>
    <Setter Property="Background" Value="Violet"/>

    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type local:BlancoPageControl}">
                ...
            </ControlTemplate>
        </Setter.Value>
    </Setter>
  </Style>
</ResourceDictionary> 
```

测试页.xaml：

```
<local:BlancoPageControl 
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
  xmlns:local="clr-namespace:The_Toolbox"
  xmlns:res="clr-namespace:The_Toolbox.LocalResources"
  mc:Ignorable="d"
  x:Class="The_Toolbox.TestPage">
    <StackPanel>
        ....
    </StackPanel>
</local:BlancoPageControl> 
```

我希望页面会变成紫色，但会忽略颜色设置。为什么？当然我可以添加边框并在其中添加背景颜色，但 Page 也支持背景画笔...

# c# - 如何写入非标准配置文件？

> ID：10952158
> 
> 赞同：0
> 
> 时间：2012-06-08T15:53:54.613
> 
> 标签：c#, configuration, app-config, configuration-files, config

我有一个名为 middle.config 的文件，它与 exe 部署在同一目录中，但我需要更新此文件中的值。这意味着我必须转到 C:\Program Files (x86)\ 目录才能访问该文件。尽管它被命名为 .config 文件，但它并不遵循 .config 文件的通常架构。它看起来像这样：

```
<configuationSettings>     
  <middleSettings      
   groupName="XYZ"     
   forkName="SomeDbName"     
   dbServerName="123.123.123.123"     
   cnnTimeoutSeconds="30"     
   cmdDefaultTimeoutSeconds="30"     
   cmdMediumTimeoutSeconds="60"     
   cmdLongTimeoutSeconds="480"     
   />     
 <userKeys>     
   <Assemblies value="C:\assemblies\" />     
 </userKeys>     
 <friendlyDbName value="NiceData"/>     
</configuationSettings> 
```

我可以使用 Xml 读取和操作内容，但是当我尝试将文件保存回来时，会引发“无权限”错误。我无法重新定位文件。我被这个遗留架构困住了，所以我不能像使用 ConfigurationManager.OpenExeConfiguration 的普通 .config 文件一样对待它。我无法在此架构上定义部分或组（无论如何我都无法）。我所有的用户都是他们本地机器上的管理员。

当它位于受保护的目录中时，如何覆盖或删除和替换此文件（我对权限错误的假设）？如果做不到这一点，有没有办法使用 ConfigurationManager.OpenExeConfiguration 以某种方式访问​​此架构。

{编辑从这里开始}

在这种情况下，有三个应用程序**A**、**B**和我的**C**。应用程序**A**不知道任何其他应用程序。**它可以连接到很多很多数据库，它会删除一个文件“middle.config”，其中包含指向上一个应用程序A**会话使用的最后一个数据库位置的指针信息。应用程序**B**，我们称之为导入/导出应用程序，仅在最后一个应用程序**A**数据库位置上运行。应用程序**B**读取“middle.config”文件以获取数据库指针信息，然后针对该数据库执行控制台命令。它对数据库的选定部分执行批量转储或批量导入。

这就是我来构建应用程序**C**时的情况，该应用程序使用导入/导出应用程序**B**来获取数据块并将它们返回到数据库。因此，为了让应用程序**C** 对任何数据库使用应用程序**B ，应用程序****C**必须修改“middle.config”文件，以便应用程序**B**找到正确的数据库。应用程序**C**是新的，另外两个是旧的。我要么找到一种方法来完成这项工作，要么强制用户启动 Application **A**并指向感兴趣的数据库，然后关闭 Application **A**。这是非常不方便的。

{编辑到此结束}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:58:51.743

不建议将数据文件写入程序文件目录，因为这需要提升权限。授予程序提升的权限只是为了更新配置文件与 Principal of Least Privilege 冲突，该[Principal of Least Privilege](http://en.wikipedia.org/wiki/Principle_of_least_privilege)指出

> 在计算环境的特定抽象层中，每个模块（例如进程、用户或程序，取决于主题）必须能够仅访问其合法目的所必需的信息和资源

仅仅为了更新配置文件而赋予进程提升的权限（可以允许它做许多有害的事情）不是“合法目的”。MS 推荐的做法是在别处写那种类型的数据。

相反，请考虑将配置文件存储在[ApplicationData 文件夹的子文件夹](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:05:48.453

您对受保护目录的假设是正确的。Program Files 有一个访问控制列表，可以防止以标准用户身份运行的进程进行修改，在 Vista 上，甚至可以防止未运行提升的管理员进程进行修改。使用标准配置类访问文件不会解决这个问题。

如果您绝对不能移动文件（Eric J. 说安装后写入程序文件是一个坏主意是正确的），那么您可以[在配置文件编辑程序中嵌入一个清单，该程序将尝试强制提升启动时的 UAC 提示](https://stackoverflow.com/a/4084620/351301)。当然，最好的解决方案包括 a) 使用标准配置模式和 b) 将用户数据保存在用户可写的位置，但有时由于遗留原因这是不可能的。

不幸的是，我不知道有什么方法可以说服 ConfigurationManager 读取非标准架构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:11:57.350

建议您的应用在 AppData 位置文件夹下为当前用户创建自己的位置，而不是写入应用安装位置下的文件（尤其是在非常严格的 Program Files 下）。不建议强制用户以管理员身份运行您的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:54:41.697

将逻辑移至单独的进程，并使用当前应用程序的管理员权限启动它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T17:04:49.753

从另一个角度来看：[Writing custom section into app.config](https://stackoverflow.com/questions/2502091/writing-custom-sections-into-app-config)

我发现链接的文章非常有用。不确定它是否会回答你所有的问题。

# wpf - 将数据从 WPF 应用程序传输到 Word 文档

> ID：10952163
> 
> 赞同：1
> 
> 时间：2012-06-08T15:54:07.087
> 
> 标签：wpf, ms-word, transfer

我正在寻找的是正确方向的一点。我正在自学 Visual Studios 2010。我有一个带有文本框的 WPF 应用程序。我想做的是将这些数据传输到 Word 文档中，然后打印出来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:14:39.053

[此链接](http://nishantrana.wordpress.com/2007/11/03/creating-word-document-using-c/)中的以下代码应该会有所帮助，它将允许您使用文本“Hello World”创建一个 Word 文档并将其保存到“D:\MyWord.doc”

```
 object missing = System.Reflection.Missing.Value;
        object Visible=true;
        object start1 = 0;
        object end1 = 0;

        ApplicationClass WordApp = new ApplicationClass();
        Document adoc = WordApp.Documents.Add(ref missing, ref missing, ref missing, ref missing);
        Range rng = adoc.Range(ref start1, ref missing);

        try
        {              
            rng.Font.Name = “Georgia”;
            rng.InsertAfter(“Hello World!”);
            object filename = @”D:\MyWord.doc”;
            adoc.SaveAs(ref filename, ref missing, ref missing, ref missing, ref missing, ref missing,
            ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing);
            WordApp.Visible = true;
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        } 
```

# ruby-on-rails - 如何在 Rails 应用程序下为域提供 html 树？

> ID：10952166
> 
> 赞同：0
> 
> 时间：2012-06-08T15:54:21.147
> 
> 标签：ruby-on-rails

我有一个运行 example.com 的 rails 应用程序

我有一个非常简单且完全独立的站点，example-1.com。我有一个静态 html/css 树。

从 /public 为该域提供服务的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-20T11:00:02.353

You should try to do t with `iframe` html tag. I had the same issue. You can take a look at [this](https://stackoverflow.com/questions/28608656/how-to-serve-static-html-pages-with-rails)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:35:02.523

我假设您想在 Rails 应用程序中提供静态页面？

有几种方法可以做到这一点，但最简单的方法之一是使用[high_voltage gem](https://github.com/thoughtbot/high_voltage)，这使得管理静态页面及其路由变得容易，但你自己也不是很难做到。

不直接从 /public 为它们提供服务的主要优点是您的视图可以使用已经为您的站点定义的布局。

如果您想在 CMS 中维护页面，请查看[comfy-mexican-sofa](https://github.com/comfy/comfortable-mexican-sofa)，它是一个 CMS，但可以轻松集成到现有应用程序中以处理静态页面。

# c# - 是否可以在 wpf 中的两个项目之间添加组合框项目？

> ID：10952168
> 
> 赞同：1
> 
> 时间：2012-06-08T15:54:31.023
> 
> 标签：c#, wpf

```
<Window
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
x:Class="Trainning.Mycombobox"
x:Name="Window"
Title="Mycombobox"
Width="640" Height="480">

<Grid x:Name="LayoutRoot">
    <ComboBox x:Name="com_friends" Height="32" Margin="223,102,264,0" VerticalAlignment="Top">
        <ComboBoxItem Content="Chandru"/>
        <ComboBoxItem Content="Arul"/>
        <ComboBoxItem Content="Anbu"/>
    </ComboBox>
</Grid> 
```

在上面的代码中，我在组合框中添加了三个项目。之后，我将一项动态添加到同一个组合框中。这是我写的代码。

```
public partial class Mycombobox : Window
{
    public Mycombobox()
    {
        this.InitializeComponent();

        // Insert code required on object creation below this point.

        com_friends.Items.Add("Bala");
    }
} 
```

它的输出将是这样的

![组合框](../Images/4a32337fe58911da8781ca0748ff007b.png) 但我想在“Anbu”和“Arul”之间添加项目“Bala”。这可能吗？

请帮我...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:02:44.173

```
 com_friends.Items.Insert(2,"Bala"); 
```

其中第一个参数是您要插入新对象的索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:02:44.190

```
com_friends.Items.Insert(index, "Bala"); 
```

应该做你正在寻找的东西。

# c# - Visual Web Developer Putting Drowdown Menus in Table Cells

> ID：10952172
> 
> 赞同：0
> 
> 时间：2012-06-08T15:54:44.853
> 
> 标签：c#, events, event-handling, visual-web-developer

I have created a web page that displays a table. Most of the cells of the table are already filled in but some of them require user input. I would like to put drop down menus in some of these table cells such that the cell will be populated with the selection from the menu and the drop down list will disappear.

I have gotten this to work in a single cell. However, when I tried to get it to work in a second cell everything broke. I have hacked around so much trying to find the problem that I am not even sure I remember how I got the first one working now. :-)

Here is the relevant code:

```
protected void Page_Load(object sender, EventArgs e)
{

    // Create a DropDownList control.
    DropDownList DropList = new DropDownList();

    // Set the properties for the DropDownList control.
    DropList.ID = "TrendList";
    DropList.AutoPostBack = true;

    // Manually register the event-handling method for the 
    // SelectedIndexChanged event.
    DropList.SelectedIndexChanged += new EventHandler(this.Selection_Change);

    // Because the DropDownList control is created dynamically each
    // time the page is loaded, the data must be bound to the
    // control each time the page is refreshed.

    // Specify the data source and field names for the Text and 
    // Value properties of the items (ListItem objects) in the
    // DropDownList control.
    DropList.DataSource = CreateDataSource();
    DropList.DataTextField = "ColorTextField";
    DropList.DataValueField = "ColorValueField";

    // Bind the data to the control.
    DropList.DataBind();

    // Set the default selected item when the page is first loaded.
    if (!IsPostBack)
    {
        DropList.SelectedIndex = 0;
    }

    // Add the DropDownList control to the Controls collection of 
    // the PlaceHolder control.
    p1.Controls.Add(DropList);
    p2.Controls.Add(DropList);
}

ICollection CreateDataSource()
{

    // Create a table to store data for the DropDownList control.
    DataTable dt = new DataTable();

    // Define the columns of the table.
    dt.Columns.Add(new DataColumn("ColorTextField", typeof(String)));
    dt.Columns.Add(new DataColumn("ColorValueField", typeof(String)));

    // Populate the table with sample values.
    dt.Rows.Add(CreateRow("GreenUp", "GreenUp", dt));
    dt.Rows.Add(CreateRow("GreenFlat", "GreenFlat", dt));
    dt.Rows.Add(CreateRow("GreenDown", "GreenDown", dt));
    dt.Rows.Add(CreateRow("YellowUp", "YellowUp", dt));
    dt.Rows.Add(CreateRow("YellowFlat", "YellowFlat", dt));
    dt.Rows.Add(CreateRow("YellowDown", "YellowDown", dt));
    dt.Rows.Add(CreateRow("RedUp", "RedUp", dt));
    dt.Rows.Add(CreateRow("RedFlat", "RedFlat", dt));
    dt.Rows.Add(CreateRow("RedDown", "RedDown", dt));
    dt.Rows.Add(CreateRow("ClearUp", "ClearUp", dt));
    dt.Rows.Add(CreateRow("ClearFlat", "ClearFlat", dt));
    dt.Rows.Add(CreateRow("ClearDown", "ClearDown", dt));

    // Create a DataView from the DataTable to act as the data source
    // for the DropDownList control.
    DataView dv = new DataView(dt);
    return dv;

}

DataRow CreateRow(String Text, String Value, DataTable dt)
{

    // Create a DataRow using the DataTable defined in the 
    // CreateDataSource method.
    DataRow dr = dt.NewRow();

    // This DataRow contains the ColorTextField and ColorValueField 
    // fields, as defined in the CreateDataSource method. Set the 
    // fields with the appropriate value. Remember that column 0 
    // is defined as ColorTextField, and column 1 is defined as 
    // ColorValueField.
    dr[0] = Text;
    dr[1] = Value;

    return dr;
}

void Selection_Change(Object sender, EventArgs e)
{
    // Retrieve the DropDownList control from the Controls
    // collection of the PlaceHolder control.
    DropDownList DropList1 = (DropDownList)p1.FindControl("TrendList");
    DropDownList DropList2 = (DropDownList)p2.FindControl("TrendList");
    switch (sender.ToString())
    {
        case "p1":
            s1.InnerHtml = DropList1.SelectedItem.Value;
            break;
        case "p2":
            s2.InnerHtml = DropList2.SelectedItem.Value;
            break;
    }
} 
```

And here is the relevant snippet from the table:

```
<td><span id="s1" runat="server"><asp:PlaceHolder ID="p1" runat="server"></asp:PlaceHolder></span>
<td><span id="s2" runat="server"><asp:PlaceHolder ID="p2" runat="server"></asp:PlaceHolder></span> 
```

Now I realize that the switch control is all wrong since sender does not represent the id of the caller. But I need some way to distinguish which drop down menu is the caller so I know which HTML to replace. Also, I can only get one drop down menu to display at a time.

Any advice is appreciated.

Regards.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T02:30:07.373

This code solved the problem:

```
public void EditTable()
{
    ICollection trends = CreateDataSource();
    for (int x = 1; x <= 27; x++)
    {
        DropDownList ddl = new DropDownList();
        string index = x.ToString();
        ddl.ID = "TrendList" + index;
        ddl.AutoPostBack = true;
        ddl.SelectedIndexChanged += new EventHandler(this.Selection_Change);
        ddl.DataSource = trends;
        ddl.DataTextField = "TrendTextField";
        ddl.DataValueField = "TrendValueField";
        ddl.DataBind();
        if (!IsPostBack)
        {
            ddl.SelectedIndex = 0;
        }
        HtmlGenericControl span = (HtmlGenericControl)form1.FindControl("s" + index);
        PlaceHolder placeHolder = (PlaceHolder)span.FindControl("p" + index);
        if (placeHolder != null)
        {
            placeHolder.Controls.Add(ddl);
        }
    }
} 
```

# c++ - 如何用 dll 和库打包 C++

> ID：10952174
> 
> 赞同：7
> 
> 时间：2012-06-08T15:54:50.837
> 
> 标签：c++, release

我想知道如何“打包”一个 C++ 项目以进行发布。它使用各种库，我不希望用户必须进行与我相同的设置，将正确的文件放在正确的位置等等。我很难研究这个，因为我不确定这个问题的技术术语。如果我在 Linux 上使用命令行编译，有没有简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T16:14:28.713

您的处理方法在 Windows 和 Linux 上会有所不同，因为每个操作系统都以不同的方式处理它。我对 Linux 比较熟悉，所以我的回答仅限于 Linux 方面。

当您使用 -l 标志将可执行文件与库链接时，链接器默认查找正常的系统库目录，因此这里有四种方法。

1.  要求用户自己正确安装库。但是，听起来您不想这样做。

2.  让用户将库位置添加到 LD_LIBRARY_PATH 变量。

3.  您的第三个选项是强制链接器使用 -rpath 标志在特定路径中查找库。例如，要让应用程序在其工作目录中查找共享库，您可以使用以下命令进行编译：`g++ -rpath ./ -l SomeLib -o MyApp myapp.cpp`

4.  另一种选择是将您的代码与其库静态链接，这样您只需分发一个可执行文件。如果存在静态库，您可以使用它`g++ -static -l SomeLib -o MyApp myapp.cpp`来告诉 gcc 静态链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:44:14.017

在 Windows 上，我建议使用 wix [http://wix.sourceforge.net/](http://wix.sourceforge.net/)创建 .msi 安装程序，我想指出，.dll 的查找路径我建议将所有 .dll 与您的 .exe 放在同一个文件夹中，因为这具有最高优先级

但是，vc crt（c/c++ 运行时库）应该使用来自 microsoft 的重新分发包安装 -> 自动更新[http://www.microsoft.com/de-de/download/details.aspx?id=5555](http://www.microsoft.com/de-de/download/details.aspx?id=5555)

Wix 可以将再分发包包含在同一个 .msi 中，因此您只需部署一个安装程序文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T16:10:34.070

你是说安装工？
在 Windows 上，您运行以安装新应用程序的程序，该程序将正确目录中的所有内容都删除，创建开始菜单并让您卸载它？

Visual Studio 中有一个安装程序生成器（可能不在免费快递版本中），它生成 .msi 安装程序文件。它很容易用于简单的任务，但做更多的事情变得很复杂。

或者，要创建传统的 setup.exe 类型安装，我使用出色的免费[Innosetup](http://www.jrsoftware.org/isinfo.php)

在 linux 上，您通常会使用您的发行版使用的任何格式（.deb / .rpm）创建一个包。有很多关于每个细节的说明，并且这样做的工具可能已经安装在你的 Linux 系统中

# iphone - 通过 paulirish 获得 Infinite-Scroll 以在 iPhone 上工作

> ID：10952179
> 
> 赞同：2
> 
> 时间：2012-06-08T15:55:17.793
> 
> 标签：iphone, ios, infinite-scroll

我一直在我的网站上实施 Paul Irish 的 Infinite-Scroll。它适用于桌面浏览器，但在移动设备（特别是 iPhone）上却不能立即使用。解决方法是稍微放大，这会触发触发无限滚动的滚动事件。

另请参阅此处的问题报告： [https ://github.com/paulirish/infinite-scroll/issues/3](https://github.com/paulirish/infinite-scroll/issues/3)

我的问题是：有解决方案吗？

我注意到 Tumblr 可以在没有解决方法的情况下进行无限滚动。

如果您要在 iPhone 上查看[http://youworkit.tumblr.com/](http://youworkit.tumblr.com/)，然后从移动设备切换到标准桌面视图，无限滚动确实可以在不放大的情况下工作。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-22T08:13:02.093

这对我有用：

[JQuery检测底部滚动](https://stackoverflow.com/questions/8220267/jquery-detect-scroll-at-bottom)

```
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"> 
```

# visual-studio-2012 - 在 VS2012 中禁用文件预览

> ID：10952185
> 
> 赞同：465
> 
> 时间：2012-06-08T15:55:47.687
> 
> 标签：visual-studio-2012

在 VS2012 中，当您在解决方案资源管理器中选择文件时，它会自动在特殊的“预览”选项卡中打开文件。

也许我的电脑不够快，但是这个预览对我来说太慢了。

如何禁用此功能？

* * *

## 回答 #1

> 赞同：617
> 
> 时间：2012-06-08T16:00:20.740

在工具 > 选项 > 环境 > 选项卡和 Windows 中，您可以通过取消选中“预览”选项卡下的“解决方案资源管理器”来禁用它。

我发现它使用“快速启动”新功能。只需键入“预览”，就会提示设置链接。VS的伟大新功能

* * *

## 回答 #2

> 赞同：205
> 
> 时间：2012-08-10T04:56:00.150

您还可以在解决方案资源管理器工具窗口本身中切换文件预览：

![在此处输入图像描述](../Images/ed7a3093f5e46f86a7bce9eae9c3cb98.png)

这可能是在 7 月更新中添加的，因为在那之前我没有注意到它。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-08-10T04:53:34.600

解决方案资源管理器顶部的按钮之一切换是否启用。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-03-23T16:21:39.197

在 Visual Studio 2013 上，我通过这个 Icon 做到了这一点：

![在此处输入图像描述](../Images/99ba20641590fe9d3236344f6157d48b.png)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-07-17T12:56:28.813

一个更好的解决方案 IMO 是**完全禁用文件预览功能**（不仅仅是解决方案资源管理器）：

1.  打开工具 > 选项
2.  导航到环境 > 选项卡和窗口
3.  取消选中“允许在预览选项卡中打开新文件”

[![在此处输入图像描述](../Images/9688d7773f961b493cad5f6d53b2917b.png)](https://i.stack.imgur.com/wTYxJ.png)

这也可以防止诸如转到定义 ( `F12`) 之类的内容使用预览选项卡。

# visual-studio-2010 - 如何从 VS 中的代码中删除此“...”字符？

> ID：10952189
> 
> 赞同：1
> 
> 时间：2012-06-08T15:56:25.753
> 
> 标签：visual-studio-2010

当我尝试按下`CTRL+D+E`组合键时，我输入了一个错误的组合，将我的代码转换为 VS：

![在此处输入图像描述](../Images/65b3d3cb8ef3ad2edcc2391ab44a8224.png)

这些字符的目的是什么，如何删除它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T15:57:43.257

这些是空间字符。

你按下了`Ctrl`+ `E`, `S`(Edit, Advanced, Show White Space)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:00:10.610

点表示空白字符。按 Ctrl+R、Ctrl+W 隐藏它们。

# dsl - 在 Drools 的 DSL 中使用 from {x}.field

> ID：10952191
> 
> 赞同：1
> 
> 时间：2012-06-08T15:56:30.373
> 
> 标签：dsl, drools

我有以下 Drools DSL“句子”：

```
[when]The field {field} in the module {module} contains value {value}=$a : {module} ( {field} != null)
      String( this.equalsIgnoreCase("{value}") ) from $a.{field} 
```

其中`field`是`Set`字符串的一个。

现在，如果我有两个这样的规则，它显然不会起作用，因为变量`$a`出现了两次。所以我想改进规则以使变量变得可变：

```
[when]The field {field} in the module {module} contains value {value} as {a}={a} : {module} ( {field} != null)
      String( this.equalsIgnoreCase("{value}") ) from {a}.{field} 
```

这不起作用，我不能使用损坏的部分`{a}.`。

所以，我的问题是：有没有办法重写规则或允许`{variable}.`符号工作？或者，是否有一个`contains`不区分大小写的运算符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T07:46:11.270

订阅 Drools-Users 邮件列表后，我得到了答复：

[http://drools.46999.n3.nabble.com/rules-users-Using-from-x-field-in-DSL-tt4017872.html](http://drools.46999.n3.nabble.com/rules-users-Using-from-x-field-in-DSL-tt4017872.html)

摘要：DSL 解析器中的错误，作为一种解决方法，在 RHS 上的变量后添加一个额外的字母：`... as {a}={a}x (...) ... from {a}x.{field}`

# android - Unity for Android 的最低要求？

> ID：10952192
> 
> 赞同：5
> 
> 时间：2012-06-08T15:56:32.953
> 
> 标签：android, unity3d, minimum-requirements

使用 Unity 开发 android 应用程序的最低要求是什么——android 操作系统版本、硬件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T16:05:42.407

*   安卓操作系统 2.0 或更高版本
*   由 ARMv7（Cortex 系列）驱动的设备
*   建议 CPU GPU 支持 OpenGLES 2.0

请参阅： [http ://unity3d.com/unity/system-requirements](http://unity3d.com/unity/system-requirements)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:05:10.823

从[网页](http://unity3d.com/unity/system-requirements)：

Unity 创作的系统要求
•Windows：XP SP2 或更高版本；Mac OS X：英特尔 CPU 和“Leopard”10.5 或更高版本。请注意，Unity 未在 Windows 和 OS X 的服务器版本上进行测试。
•具有 64 MB VRAM 和像素着色器或 4 个纹理单元的显卡。在这个千年制作的任何卡都应该可以工作。
•使用Occlusion Culling 需要GPU 支持Occlusion Query（一些Intel GPU 不支持）。
•其余的只取决于您的项目的复杂性！。

Unity Android 创作的系统要求
• 除了 Unity 创作的一般系统要求
• Windows XP SP2 或更高版本；Mac OS 10.5.8 或更高版本
• Android SDK 和 Java 开发工具包 (JDK)

# javascript - 链接到单独选项卡中的 div

> ID：10952195
> 
> 赞同：0
> 
> 时间：2012-06-08T15:56:39.983
> 
> 标签：javascript, jquery, jquery-selectors

我正在尝试链接到单独选项卡中的 div。目前侧边导航链接是这样的：

```
var loc = window.location.hash;
if (loc == "#bargain") {
    jQuery('.tab-2').click();
    App.SetBaseLine();
    jQuery('#bargain').addClass('activeListColor');
};

      <li><a href="default.aspx#bargain">Bargain Packages</a></li>

    <!-- start of tabHolder -->
    <div id="tabHolder">
        <ul class="tabs_new buttons">
            <li class="liOuter" id="tab1"><a href="#" class="current tab-1">Buyers' Guide</a></li>
            <li class="liInner" id="tab2"><a href="#" class="tab-2">Pricing Guide</a></li>
        </ul> 
```

不幸的是，这并没有把我带到第二个标签下。我试图让用户单击链接，它会打开选​​项卡并锚定到 div 位置。

我愿意接受建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:09:27.537

你可以这样做：

```
<ul class="tab">
    <li><a href="#tab1">One</a></li>
    <li><a href="#tab2">Two</a></li>
    <li><a href="#tab3">Three</a></li>
</ul>
<div class="tabs">
    <div id="tab1">Content 1</div>
    <div id="tab2">Something here</div>
    <div id="tab3">Omg! Three</div>
</div> 
```

**脚本**为：

```
$(document).ready(function(){
    $(".tab > li > a").click(function(){
        var tab = $(this).attr('href');
        $(".tab > li > a").removeAttr("style");
        $(this).css("background-color", "#ccc");
        $('.tabs > div:visible').hide(function(){
            $(tab).show();
        });
        return false;
    });
    $('.tabs > div').hide();
    $('.tabs > div:first-child').show();
}); 
```

**CSS：**

```
body {overflow: hidden;}
ul li {display: inline-block; *display: inline; *zoom: 1;}
a {text-decoration: none; color: #f60; border-radius: 5px; padding: 5px; display: inline-block; *display: inline; *zoom: 1;}
div {padding: 5px;} 
```

[小提琴](http://jsfiddle.net/U3KLs/1/)！希望这是使用标签的最佳方式。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:00:22.910

您可以使用以下 jQuery 来实现类似“选项卡”的效果

```
​$('a').click(function() {
    $('div').hide();
    var destination = '#' + $(this).attr('data-tab');
    $(destination).toggle();
});​ 
```

看这个[活生生的例子](http://jsfiddle.net/RCbgV/)

这是一个[更新的示例](http://jsfiddle.net/RCbgV/1/)，其中 div 包含在无序列表中

或者，您可以使用“当前”类并使用以下代码在单击时切换它：

```
$('a').click(function() {
    $('.tabs div').removeClass('current');
    var destination = '#' + $(this).attr('data-tab');
    $(destination).toggleClass('current');
});​ 
```

另一个[活生生的例子](http://jsfiddle.net/RCbgV/2/)在这里

# jquery - ScriptSharp - 将数据作为名称-值集合发布

> ID：10952198
> 
> 赞同：1
> 
> 时间：2012-06-08T15:56:55.040
> 
> 标签：jquery, ajax, script#

我正在尝试使用 jQuery.AjaxRequest 方法使用 Script# 发布数据：

```
jQueryAjaxOptions options = new jQueryAjaxOptions();
options.Url = "/Server/Login.ashx";
options.Data = new LoginRequest(username, password);
jQuery.AjaxRequest<LoginResponse>(options); 
```

如何避免生成 LoginRequest 类？我可以将数据作为某种名称-值集合传递吗？或者让 LoginRequest “导入”？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T20:32:47.483

您也许可以使用 ScriptName 属性。像这样：

```
[Imported]
[IgnoreNamespace]
[ScriptName("Object")] // this will make Script# emit this as {}
public class LoginRequest
{
    public string username { get; set; }

    public string password { get; set; }
} 
```

我只是在这里从臀部射击（我还没有在我的机器上测试过这个）但是试一试。

# r - R glmnet family = 0-1 之外的二项式预测值

> ID：10952199
> 
> 赞同：5
> 
> 时间：2012-06-08T15:56:57.937
> 
> 标签：r, regression, glmnet, regularized

我试图在 R 中找到一个用于正则化逻辑回归的包，该包可以预测 0 - 1 之间的值。不过，我没有太多运气，尝试过这个`lars`包，现在又尝试了这个`glmnet`包。

下面是 glmnet 包参考手册中示例的代码，我不明白输出。

```
library(glmnet)

set.seed(1010)
n=1000;p=100
nzc=trunc(p/10)
x=matrix(rnorm(n*p),n,p)
beta=rnorm(nzc)
fx= x[,seq(nzc)] %*% beta
eps=rnorm(n)*5
y=drop(fx+eps)
px=exp(fx)
px=px/(1+px)
ly=rbinom(n=length(px),prob=px,size=1)
set.seed(1011)
cvob2=cv.glmnet(x,ly,family="binomial")
plot(cvob2) # had to add this comment to allow edit
coef(cvob2)
predict(cvob2,newx=x[1:5,], s="lambda.min")

             1
[1,] -1.721438
[2,]  0.914219
[3,]  1.111685
[4,]  1.805725
[5,] -4.200433 
```

我不明白为什么输出不是全部在 0 - 1 范围内。

我在这里误解了什么吗？

任何人都可以推荐一个易于使用的正则化逻辑回归包吗？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-08T16:23:36.950

检查 predict.glmnet 文档：默认情况下，它是 type="link"，即链接转换。

```
predict(cvob2,newx=x[1:5,],type="response", s="lambda.min") 
```

# c++ - 将字符串数组传递给系统函数？

> ID：10952210
> 
> 赞同：2
> 
> 时间：2012-06-08T15:58:12.727
> 
> 标签：c++, c

我有一个包含 3 个不同命令行命令的字符串数组。我没有写出 3 个系统函数，而是尝试学习如何在 for 循环中将保存这些命令的字符串数组传递给系统函数（或类似的函数，即 exec()）。我在试图弄清楚如何一次将这个字符串数组传递给系统函数时遇到了麻烦。目标是获得每个的退出状态，并在返回错误时打破 for 循环。

```
 std::string arrString[3] = {"something","another thing","a final thing"}
            int i;
            for(i=0; i<3; i++)
            {
                if (system(/*Something*/))
                ;//Do something...
            } 
```

**编辑：**这输出发生了错误，但它不应该。

```
 std::string arrString[4] = {"cmd","cmd","cmd"};
            int i;
            for(i=0; i<3; i++)
            {
                if (system(arrString[i].c_str())==0) {
                    OutputDebugStringW(L"It works!");
                }
                else
                {
                    OutputDebugStringW(L"It doesnt work :(");
                }
            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:00:58.513

[`system`](http://www.cplusplus.com/reference/clibrary/cstdlib/system/)需要`char*`，因此您需要调用[`c_str`](http://www.cplusplus.com/reference/string/string/c_str/)数组的每个元素：

```
std::string arrString[3] = {"something","another thing","a final thing"}
int i;
for(i=0; i<3; i++) {
    if (system(arrString[i].c_str())) {
        //Do something...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:00:50.803

```
system(arrString[i]) 
```

然后检查退出代码并在适当的情况下中断循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:01:26.000

您必须使用以下函数转换`std:string`为第一个：`char*``c_str()`

`system(arrString[i].c_str())`

# sql-server - 为 SQL Server 中的字段生成唯一哈希

> ID：10952213
> 
> 赞同：3
> 
> 时间：2012-06-08T15:58:22.497
> 
> 标签：sql-server, tsql

我正在编写一个会员提供程序，用于我们现有的会员基础。我使用 EF4.1 进行所有数据库访问，我遇到的问题之一是最初设置数据库时，关系是以编程方式而不是在数据库中完成的。如果需要在我们所有用户都不需要的列上建立关系，但为了使关系确实需要是唯一的（根据我的理解）。

我认为可行的解决方案是对 userid 字段进行 MD5 散列（这是唯一的......这将/应该保证该字段中的唯一值）。我在 sql server 上遇到问题的部分是在不替换存储在 employeeNum 字段（有问题的字段）中的现有值的情况下执行此操作的查询。

所以简而言之，我的问题是。在尚未存在值的所有行上获取字段中唯一值`employeeNum`（可能基于字段的 md5 哈希）的最佳方法是什么。`userid`此外，在次要/主要程度上......这听起来像是一个好计划吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-08T17:43:53.133

如果您的问题只是如何为用户 ID 生成哈希值，您可以使用计算列以这种方式进行（或生成此值作为插入过程的一部分）。我不清楚您是否知道[HASHBYTES](http://msdn.microsoft.com/en-us/library/ms174415%28v=sql.100%29.aspx)函数或当您说“最佳”时您正在查看的其他标准。

```
DECLARE @foo TABLE
(
  userid INT, 
  hash1 AS HASHBYTES('MD5',  CONVERT(VARCHAR(12), userid)),
  hash2 AS HASHBYTES('SHA1', CONVERT(VARCHAR(12), userid))
);

INSERT @foo(userid) SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 500;

SELECT userid, hash1, hash2 FROM @foo; 
```

结果：

```
userid  hash1                               hash2
------  ----------------------------------  ------------------------------------------
1       0xC4CA4238A0B923820DCC509A6F75849B  0x356A192B7913B04C54574D18C28D46E6395428AB
2       0xC81E728D9D4C2F636F067F89CC14862C  0xDA4B9237BACCCDF19C0760CAB7AEC4A8359010B0
500     0xCEE631121C2EC9232F3A2F028AD5C89B  0xF83A383C0FA81F295D057F8F5ED0BA4610947817 
```

在 SQL Server 2012 中，我强烈建议至少使用 SHA2_256 而不是上述任何一种。（您忘记提及您使用的版本 - 总是有用的信息。）

尽管如此，我仍然想提请注意我在评论中提出的观点：这里的“最佳”解决方案是修复模型。如果`employeeNum`是可选的，则不应让 EF 认为它是必需的或唯一的，如果它实际上不是某种标识符，则不应在关系中使用它。如果您首先为关系使用正确的属性，为什么用户会关心之间的冲突`employeeNum`？`userid`

**根据 OP 的要求进行**编辑****

 **所以说有什么不对`UPDATE table SET EmployeeNum = 1000000 + UserID WHERE EmployeeNum IS NULL`呢？如果`EmployeeNum`将保持在以下，`1000000`那么您保证没有冲突并且您完全避免了散列。

如果`employeeNum`可能包含一个字符串，您可以生成类似的填充，但又是 EF 促进了这些可怕的列名吗？为什么带有`Num`后缀的列会包含除数字之外的任何内容？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T18:02:43.500

您还可以使用**uniqueidentifier**将默认值设置为**(newid())**

创建一个新列 EmployeeNum 作为 uniqueidentifer，然后：

```
UPDATE Employees SET EmployeeNum = newid() 
```

然后设置为主键。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T17:47:10.483

```
UPDATE EMPLOYEE
    SET EMPLOYEENUM = HASHBYTES('SHA1', CAST(USERID AS VARCHAR(20)))
WHERE EMPLOYEENUM IS NULL 
```**

# magento - Magento Magmi 图像处理器错误

> ID：10952218
> 
> 赞同：0
> 
> 时间：2012-06-08T15:58:30.893
> 
> 标签：magento, magmi

我刚刚开始使用 MAGMI 图像属性处理器并且遇到了一些问题。

最初，我遇到了 open_basedir 错误，但我（我认为！！）暂时禁用了域的 open_basedir。

但是，现在我得到以下信息：

```
error creating /media/catalog/product/d: 2,mkdir(): No such file or directory 
```

对于所有正在处理的图像。

我的配置如下：

*   服务器设置在 Plesk 10 VPS 上。
*   MAGMI 中文件系统路径的值：'/httpdocs'
*   图像处理器本地图像存储：'media/import/'
*   Magmi 版本 0.7.17

dweeves 的其他帖子建议文件系统路径的值错误，但是当我尝试将完整的文件系统路径输入到字段中（即 /var/www/vhosts/domain.com/httpdocs）时，这将被简单地替换为“httpdocs”，暗示 magmi知道它已经在那里了。

有任何想法吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T20:15:15.903

如果您在新安装的 magento 上运行它并且之前从未添加过图像，则“目录/产品”目录将不存在，因此您必须创建它。图像插件假定存在。

# c++ - 如何摆脱完全专用功能模板的多个定义？

> ID：10952219
> 
> 赞同：3
> 
> 时间：2012-06-08T15:58:34.447
> 
> 标签：c++, linker, static-libraries

我在链接我的一个 C++ 应用程序的对象时遇到问题。源文件全部编译成目标文件，但其中许多依赖于同一个库，该库具有完全专用的函数模板。链接器在尝试将它们链接在一起时会抱怨。我明白为什么会这样，但我*不*明白如何解决它。

我找到[了这个](http://www.velocityreviews.com/forums/t290309-fully-specialized-function-template-and-multiple-definition.html)，它准确地解释了这个问题，但是论坛帖子从来没有达到 OP 要求解决方案的地步。呜呜呜呜

如何编译所有源文件，但只从库中获取专用函数一次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:02:56.763

问题在于，专业化在标题中也有实现，这是错误的。

您应该将实现移至源文件，或将方法标记为`inline`.

# c - 逐行读取，段错误

> ID：10952220
> 
> 赞同：0
> 
> 时间：2012-06-08T15:58:37.720
> 
> 标签：c, segmentation-fault

这段代码给出了一个即时的段错误，我尝试将 printf 全部放置，我什至尝试在 int=0 之后打印一些东西；行，但无论我做了什么，除了分段错误之外，它不会打印任何内容。该文件存在，它的位置也与我执行的位置相同。该文件包括城市名称，每行一个名称，仅此而已，我如何读取它们并将它们存储在数组中：/如果每个城市后面都有一个数字，读数是否仍然相同？

```
NewYork 5
LosAngeles 12
California 7 
```

和代码；

```
 int i=0;

    char **city_names = malloc(sizeof(char*));

    FILE* fp;
    fp = fopen("abc.txt","r");

    while(!feof(fp)){

        city_names[i] = realloc(city_names[i],sizeof(char)*255);
        fscanf(fp,"%s",city_names[i]);
        i++;
    }

    fclose(fp); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:01:23.693

您只在 malloc 中分配一个 char * 内存，然后在 while 循环中访问它之外。

如果你要做一个二维`malloc`数组，你需要`malloc`每个指针，然后`malloc`将一个分配给每个指针`malloc`到最大字符串大小（yuck）。

```
char **city_names = malloc(sizeof(char *) * kNumCities);

for(int i = 0; i < kNumCities; i++)
  city_names[i] = malloc(sizeof(char) * kMaxStringSize); 
```

或者做一些类似的事情`char city_name[3][256]`来让它启动并运行。

我还想补充一点，这种阅读方式非常不安全。您正在将未知数量的字节读入固定的缓冲区大小。如果您读入的字符串超过 255 个字节，您将破坏内存。你最好使用`fread()`一个固定大小的缓冲区类型解决方案（或者`ftell()`然后文件并一次读取它以获得最佳效率），然后从缓冲区中读取。更不用说`malloc`and的所有开销`realloc`（它们确实加起来了）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:33:38.067

`while(!feof(fp))`逻辑也是错误的；对于一个空文件，它仍然会尝试扫描一些东西并增加`i`.

**在阅读 C 之前不要测试 EOF。阅读后测试。**

在 C 中迭代 stdin 上的字符的惯用代码是

```
int c; /* NOT char. */

while ((c = getchar()) != EOF) {
  /* do something with c */
} 
```

遍历行：

```
char line[MAXLINE];
while (fgets (line, sizeof line, stdin) != NULL) {
   /* do something with line */
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T17:24:38.350

```
 int i=0;
    char **city_names = malloc(sizeof(char*));
    FILE* fp;
    fp = fopen("data.txt","r");

    while(!feof(fp)){
        city_names[i] = (char*)malloc(sizeof(char)*255);
        if(1!=fscanf(fp,"%s %*d",city_names[i]))break;
        ++i;
        city_names = (char**)realloc(city_names, (i+1)*sizeof(char*));
    }

    fclose(fp); 
```

# java - Eclipse 没有在新建项目向导中创建新的 .java 文件？

> ID：10952221
> 
> 赞同：1
> 
> 时间：2012-06-08T15:58:40.650
> 
> 标签：java, eclipse, wizard

好的，我有一个非常基本的（读起来很愚蠢）问题。我刚刚开始 Java 编程，并且正在使用 Eclipse 3.7.2。我已经做了一些没有任何问题的开始项目。突然之间，当我使用向导创建一个新项目时，它并没有创建 src/.java 文件。当我在创建项目后尝试手动添加它时，我最终会收到一些神秘的错误消息。

1.  我已经重新跟踪了几个关于项目创建的演练，以寻找关于我可能不小心取消选中并且没有运气的任何选项的线索。
2.  谷歌搜索答案会为不相关的更高级问题带来结果。
3.  我已经梳理了偏好，但看起来没有什么明显的，并且
4.  我已经开始寻找我可以删除的任何用户应用程序数据以强制清空。
5.  我什至在不同的目录中创建了一个新的 Eclipse 实例，但结果仍然相同。
6.  我儿子的实例在同一台计算机上仍然从向导创建 .java 文件。唯一的区别是我的实例安装了 Android SDK（我正在尝试创建基本的 Java 项目而不是 Android 项目）。

我很茫然，并且已经浪费了很多时间试图纠正这种情况。**我需要做什么才能在 Eclipse 中重新启用 src/.java 文件的创建？**

截图（点击图片查看大图）：

[![在此处输入图像描述](../Images/afef84641a3c15c05cb8f90c63651918.png)](https://i.stack.imgur.com/1T1Kd.png) [![在此处输入图像描述](../Images/80e8dab9a07d4ddaec6e4d6e022ba595.png)](https://i.stack.imgur.com/XrcaQ.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:33:32.050

如何将 eclipse 更改为指向新的工作区。这可能会删除android设置。在文件菜单下，选择切换工作区并选择一个新位置。这很可能是新安装无法修复它的原因。该工作区中可能包含 android 设置，因此请更改为其他地方的新文件夹以对其进行测试，例如 c:\workspace2\

这是我发现的一个很好的教程，它也可能有所帮助。

[eclipse java项目教程](http://www.cs.umd.edu/class/spring2006/cmsc132/EclipseTutorial/project.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:13:35.270

确保您从向导中的正确文件夹中选择了一个 java 项目。听起来它正在创建一个 android java 项目，这可能是您的 src 文件夹丢失的原因。查看向导中的示例项目下是否也有一个 helloworld 项目，这也可以帮助您入门。屏幕截图可能对我们有所帮助。我想看看您选择的项目类型以及它所在的文件夹。

# javascript - 如何将自定义隐藏/关闭链接添加到使用 lightbox2 显示的模式框？

> ID：10952222
> 
> 赞同：0
> 
> 时间：2012-06-08T15:58:41.510
> 
> 标签：javascript, lightbox, lightbox2

我正在使用[http://lokeshdhakar.com/projects/lightbox2/](http://lokeshdhakar.com/projects/lightbox2/)。它的角落有一个“X”按钮，用于关闭模式框。我想在窗口中添加另一个关闭链接（文本链接）。

```
<a href="#" onclick="closeLightboxWindow('lightboxId')">Close</a> 
```

如何实现 closeLightboxWindow()？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:07:03.480

关联：

```
<a class="closeLightbox2" href="javascript:none;">Close</a> 
```

在 lightbox.js 字符串中查找：

```
$lightbox.find('.lb-loader, .lb-close').on('click', function(e) { 
```

像这样添加你的班级

```
$lightbox.find('.lb-loader, .lb-close, .closeLightbox2').on('click', function(e) { 
```

就是这样，不要忘记清除浏览器缓存

# macos - 有没有办法让我的沙盒 Mac 应用程序只读访问 ~/Library 中的文件？

> ID：10952225
> 
> 赞同：14
> 
> 时间：2012-06-08T15:58:46.413
> 
> 标签：macos, sandbox, mac-app-store

我对沙盒有点困惑。这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-06-08T21:01:54.153

是的，但它需要“临时例外”权利。“临时”意味着它可能会在操作系统的某些未来版本中消失，但这并没有太大的风险。更大的问题是“例外”这个词：这意味着您必须证明您使用该权利的合理性，否则 App Store 评论者可能会拒绝您。

提交一份错误报告，准确解释您认为应该能够做什么，但今天如果没有访问权限就无法做到`~/Library`，并且最好还启动一个关于该主题的论坛帖子。他们可能会建议使用解决方法而不是访问`~/Library`（甚至可能使用私有 API），在这种情况下，按照他们所说的去做。或者他们可能会说暂时使用临时例外，在这种情况下，请这样做。或者他们可能没有响应，在这种情况下，您使用临时例外并交叉手指。在任何情况下，请确保您的 App Store 提交评论注释包含指向错误报告和/或论坛主题的链接。

您必须手动编辑项目的权利 plist 才能做到这一点，但这并不难。用一个字符串创建一个`com.apple.security.temporary-exception.files.home-relative-path.read-only`数组，`"/Library/"`. 像这样：

```
<key>com.apple.security.temporary-exception.files.home-relative-path.read-only</key>
<array>
    <string>/Library/</string>
</array> 
```

最后的额外`/`内容是沙盒如何知道您要访问目录而不是文件。如果您将其关闭，您将可以访问 中的所有文件`~/Library`，这是您要求的，但不能访问 的（递归）子目录中的文件`~/Library`，例如，`~/Library/LaunchAgents/com.mycompany.myapp.myoldagent.12345678-ABCD-EF00-1234-567890ABCDEF.plist`这可能是您想要的。请参阅权利密钥参考文档中的[文件访问临时扩展](http://developer.apple.com/library/mac/#documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/AppSandboxTemporaryExceptionEntitlements.html%23//apple_ref/doc/uid/TP40011195-CH5-SW7)。

另外，请注意，您已经可以“免费”访问 下的某些内容`~/Library`，因为它们被复制到您的容器中，或者在您使用适当的 API 而不是使用路径时间接访问。因此，可能有更好的方法来完成您正在做的事情——例如，读取您的应用程序以前的非沙盒版本留下的文件，您可能能够将它们迁移到容器中并在那里读取它们。

还有一件事：仅仅访问 ~/Library 并不会改变什么`NSHomeDirectory()`,`URLsForDirectory:inDomains:`等会返回——你仍然会得到`~/Containers/com.mycompany.myproduct/Data/Library`。Apple 的半官方建议处理这个问题是使用 BSD API 来获取用户的真实主目录，最简单的方法是：

```
const char *home = getpwuid(getuid())->pw_dir;
NSString *path = [[NSFileManager defaultManager] 
                  stringWithFileSystemRepresentation:home
                  length:strlen(home)];
NSURL *url = [NSURL fileURLWithPath:path isDirectory:YES]; 
```

几点注意事项：

*   打电话`getpwuid`太频繁通常不是一个好主意。最好的解决方案是提前调用此代码一次，然后缓存生成的`NSURL`.
*   这显然也可以用来获取其他用户的主`Library`目录（因此也是 ），但 App Store 几乎肯定不会允许任何实际尝试这样做的软件。
*   图书馆所在的事实`~/Library`被认为是一个“实施细节”，可能有一天会改变，这是另一个原因（除了权利之外），这必须被视为一种临时解决方法，直到 Apple 为您的更高级别提供真正的解决方案 -水平问题，可能值得在您的评论笔记中提及。

# java - 使用 ActiveMQ 和 Spring 的 JMS 独立使用者

> ID：10952232
> 
> 赞同：5
> 
> 时间：2012-06-08T15:58:57.320
> 
> 标签：java, spring, tomcat, activemq

从历史上看，我将我的 JMS 消费者应用程序部署为部署在 Tomcat（Windows 框）下的 Spring webapps。然后，这些消费者将在同一个 Tomcat 实例下与我的其他 Web 应用程序一起运行。然而，随着我使用的消费者数量的增加，我意识到这正在变成一场维护噩梦。

我的解决方案是将这些 webapps 转换为部署为 jar 的“主要方法”独立应用程序。事实上，我能够成功地将它们打包在一起，以尝试尽可能多地重用资源（DAO、依赖项等）。

这是我的主要方法的样子：

```
public static void main(String[] args) {

    ApplicationContext context = new ClassPathXmlApplicationContext("applicationContext.xml");

    try {
        FooListener fooListener = (FooListener) context.getBean("fooListener");

        fooListener.start();
    } catch (Exception e) {
        logger.error(e.getMessage(), e);
    }

    try {
        BarListener barListener = (BarListener) context.getBean("barListener");

        barListener.start();
    } catch (Exception e) {
        logger.error(e.getMessage(), e);
    }
} 
```

我的问题：

1.  我是否需要做任何特别的事情来关闭我的主方法应用程序中的 JMS 连接，或者它们会在应用程序终止时正常关闭？
2.  是否有人对是否使用 tomcat 或作为独立应用程序部署 jms 消费者有任何个人偏好或其他方面？

编辑：

更多信息：FooListener 和 BarListener 扩展了以下抽象类。它们从 applicationContext.xml 文件中的相应 bean 继承它们的值，并且它们都覆盖 onMessage() 方法以异步使用消息。

```
public abstract class TextMessageListener implements MessageListener {

    protected ConnectionFactory connectionFactory;

    protected String queueName;

    protected String selectors;

    public void start() throws JMSException {
        Connection connection = connectionFactory.createConnection();

        Session session = connection.createSession(false, Session.CLIENT_ACKNOWLEDGE);

        MessageConsumer consumer = session.createConsumer(session.createQueue(queueName), selectors);

        consumer.setMessageListener(this);

        connection.start();
    }

    public abstract void onMessage(Message message);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T16:16:30.447

您必须以这种方式为您的应用程序上下文注册一个关闭挂钩：

```
context.registerShutdownHook(); 
```

这将确保当 jvm 关闭时，上下文也被优雅地关闭。

我个人的偏好总是将它部署到容器中——即使是像这样的独立应用程序，这是因为以下原因：

*   管理更容易 - 部署/取消部署应用程序战争，启动/停止容器运行时。
*   如果您需要构建任何类型的监控 - 正在消耗多少消息，使用此设置会更容易，您可以添加显示相关信息的网页，而不是使用带有独立应用程序的 jmx。

另外，为什么要显式调用 listener.start()，Spring 容器会自动执行此操作？

# sql - 组内数据样本 - Teradata

> ID：10952238
> 
> 赞同：2
> 
> 时间：2012-06-08T15:59:29.700
> 
> 标签：sql, teradata, sample-data

发现了一个类似的问题，但没有成功的答案。

我需要在单个表中选择每种状态类型的 50 个样本。

### 表格1

```
MEMBER  STATUS
1234       A
1324       A
3424       R
3432       S
3232       R
2783       A
2413       S
4144       R
2387       S 
```

我试过：

> SEL 成员，来自 TABLE1 的状态 Qualify Row_Number ( ) OVER (PARTITION BY status ORDER BY random (1,10000)) <=50

正如上一个问题/答案中所建议的，但 Teradata 不喜欢聚合或有序分析函数中的 RANDOM。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T16:31:05.043

因为，正如你在评论中所说，你不需要使用`random`你可以这样做：

```
SEL     Member, status 
FROM    TABLE1 
QUALIFY ROW_NUMBER() OVER (
            PARTITION BY status 
            ORDER BY NULL) <= 50; 
```

* * *

编辑：基于与假脱机空间错误相关的评论中的问题，当表很大时我们可以尝试的一种方法是使用原始表中的部分记录创建一个临时表。

```
CREATE MULTISET VOLATILE TABLE tmp_tbl AS (
    SEL     Member, status
    FROM    TABLE1
    WHERE   somefield = 'somecriterion'
) WITH DATA 
ON COMMIT PRESERVE ROWS; 
```

然后再试一次：

```
SEL     Member, status 
FROM    tmp_tbl /* now from temporary table */
QUALIFY ROW_NUMBER() OVER (
            PARTITION BY status 
            ORDER BY NULL) <= 50; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-10T23:37:38.710

如果您有离散数量的 Status 值，则在 Teradata 评估 WHERE 子句之后处理 TOP 运算符的情况下，以下方法*可能有效。*`TOP n`实际上是优于 Window Aggregate 方法的首选方法，`QUALIFY ROW_NUMBER() OVER()`或者`QUALIFY RANK () OVER()`最好提供更好的性能或在最坏的情况下提供可比性能：

```
SELECT TOP 50 
       Member
     , Status
FROM Table1
WHERE Status = 'A'
UNION ALL
SELECT TOP 50 
       Member
     , Status
From Table1
WHERE Status = 'R'
UNION ALL
SELECT TOP 50 
       Member
     , Status
FROM Table1
WHERE Status = 'S'; 
```

您也可以成功使用多个查询，其中`SAMPLE`子句通过您希望采样的状态代码过滤每个查询。

# java - Android 列出联系人同步源

> ID：10952239
> 
> 赞同：0
> 
> 时间：2012-06-08T15:59:29.927
> 
> 标签：java, android

有谁知道如何在android中获取联系人同步源？像谷歌来源、脸书来源或来自电话联系人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:41:31.757

是的。

不过，这取决于“同步源”的含义。

各个原始联系人按帐户名称和帐户类型同步。“名称”是“类型”（例如 Google 或 Facebook）的用户登录名。电话联系人将始终是 Google，即使用户*没有*同步它们。

有关更多说明，请参阅

[Contacts Provider 的参考文档](http://developer.android.com/reference/android/provider/ContactsContract.RawContacts.html)

和

[联系人提供者指南](http://developer.android.com/guide/topics/providers/contacts-provider.html)

# .net - Quartz .NET 作业类型配置问题

> ID：10952240
> 
> 赞同：1
> 
> 时间：2012-06-08T15:59:34.737
> 
> 标签：.net, quartz.net

我怀疑我在设置 Quartz .NET 配置文件时的疏忽让我目瞪口呆。我已经在论坛中搜索了类似的帖子，这篇帖子' [quartz.net from config xml in asp.net](https://stackoverflow.com/questions/10296383/quartz-net-from-config-xml-in-asp-net) '是最相关的，但不幸的是它没有帮助。我会很感激人们能想到的任何帮助或建议。

我正在尝试加载配置文件以使用 Quartz 版本 1 安排一些作业。我的 app.config 文件定义了 Quartz 配置：

```
<quartz>
        <add key="quartz.scheduler.instanceName" value="QuartzScheduler" />
        <!-- Configure Thread Pool -->
        <add key="quartz.threadPool.type" value="Quartz.Simpl.SimpleThreadPool, Quartz" />
        <add key="quartz.threadPool.threadCount" value="10" />
        <add key="quartz.threadPool.threadPriority" value="Normal" />
        <!-- Configure Job Store -->
        <add key="quartz.jobStore.type" value="Quartz.Simpl.RAMJobStore, Quartz" />
        <add key="quartz.plugin.xml.type" value="Quartz.Plugin.Xml.JobInitializationPlugin, Quartz" />
        <add key="quartz.plugin.xml.fileNames" value="~/configuration/quartz_jobs.config" />
        <add key="quartz.plugin.xml.scanInterval" value="10" />
    </quartz> 
```

然后我的quartz_jobs.config 文件定义了这些工作：

```
<?xml version="1.0" encoding="UTF-8"?>
<quartz xmlns="http://quartznet.sourceforge.net/JobSchedulingData"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                version="1.0"
                overwrite-existing-jobs="true">

    <job>
        <job-detail>
            <name>jobName1</name>
            <group>jobGroup1</group>
            <description>jobDesciption1</description>
            <job-type>FundDataImportScheduler.Jobs.FsdImportJob, FundDataImportScheduler</job-type>
            <volatile>false</volatile>
            <durable>true</durable>
            <recover>false</recover>
        </job-detail>

        <trigger>
            <cron>
                <name>cronName1</name>
                <group>cronGroup1</group>
                <description>CronTriggerDescription</description>
                <job-name>jobName1</job-name>
                <job-group>jobGroup1</job-group>
                <cron-expression>0 0/1 * * * ?</cron-expression>
            </cron>
        </trigger>
    </job>
</quartz> 
```

请注意quartz_jobs.config 文件中的节点。我正在尝试加载实现 IJob 的类：

```
public class FsdImportJob : IJob
{
   public void Execute(JobExecutionContext context)
   {
     Console.WriteLine("FsdImportJob triggered");
   }
} 
```

我遇到的问题是，当节点等于“FundDataImportScheduler.Jobs.FsdImportJob，FundDataImportScheduler”时，未加载作业。如果我在节点中使用“Quartz.Job.NativeJob，Quartz”的值进行测试，则会加载一个作业（虽然不是我想要的）。

FundDataImportScheduler.Jobs.FsdImportJob 是 FsdImportJob 类的确切命名空间，FundDataImportScheduler 是它编译成的 dll。

为了完整起见，我用来构建 Quartz SchedulerFactory 并加载配置的代码是：

```
ISchedulerFactory schedulerFactory = new StdSchedulerFactory();
IScheduler scheduler = schedulerFactory.GetScheduler();
scheduler.Start(); 
```

我将不胜感激任何关于我哪里出错的指示。

非常感谢，

赤马

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T12:59:52.917

好吧，现在我觉得有点傻 - 问题是因为我最初在控制台应用程序中有 FsdImportJob 类。Quartz 期待 FundDataImportScheduler.dll，但当然只有 FundDataImportScheduler.exe。

一旦我将 FsdImportJob 移到类库中，Quartz 就能够加载库编译的 .dll，从而加载 FsdImportJob 类。

非常感谢，

赤马

# mysql - 顺序数据数据库

> ID：10952242
> 
> 赞同：2
> 
> 时间：2012-06-08T15:59:44.117
> 
> 标签：mysql, database, qt, embedded, real-time

我对数据库完全陌生，所以请原谅这个问题的简单性。我们有一个嵌入式 Linux 系统，需要存储在几个小时的时间跨度内收集的数据。数据需要可按顺序搜索，包括 GPS、环境数据等数据。这些数据需要保存在可移动 SSD 上的文件夹中，并标记为“任务”。单个 SSD 上可以存在多个“任务”，不应混合在一起，因为用户需要自行决定将它们单独复制和保存到外部媒体。数据将每秒保存 10 次，并且由于可能出现断电，因此需要非常可靠。

数据需要在创建它的系统上是可搜索的，而且在可移动磁盘被带到另一个系统（也是 Linux）之后，它也需要在那里加载和使用。过去我们已经完成了自定义文件来存储数据，但似乎数据库可能是最好的选择。MySQL 等数据库的可移植性如何？用户是否可以轻松移除带有数据库的磁盘并将其插入新机器以不费力气地使用？我们的查询将主要是基于时间的，因为用户将在以大约 10 倍的收集率收集数据后“播放”数据。此外，我们的基本代码是用 Qt (C++) 编写的，因此我们需要以这种方式与数据库进行交互。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:11:48.660

我会选择 SQLite。它又小又轻。它将所有数据存储到一个文件中。您可以将文件复制或移动到另一台计算机并在那里阅读。您的数据编写者可以重新制作文件，当它检测到今天的 ssd 还没有文件时为空。

还值得一提的是，SQLite的[测试](http://www.sqlite.org/testing.html)水平只有少数安全关键软件才能提供。测试套件虽然部分是自动生成的，但却是惊人的 1 亿行代码。就健壮性而言，它一点也不精简。我更信任 SQLite，而不是随机的自制数据库实现。

SQLite 用于经过认证的航空电子设备 AFAIK。

# android - 三星平板电脑应用外壳

> ID：10952245
> 
> 赞同：-1
> 
> 时间：2012-06-08T15:59:53.133
> 
> 标签：android, samsung-mobile

我想知道是否有人可以就有人问我的这个问题向我提供一些见解，我发现它缺乏细节，所以我想知道你是否可以帮我回答这个问题。

1.  三星如何在平板电脑上安装应用程序（仅限谷歌商店的应用程序），或者我可以手动将应用程序放在桌面上（即内部应用程序）。

如果是这样，向平板电脑添加内部应用程序是否有任何缺点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:15:34.543

我不确定您对第二个问题的要求是什么。但我可以告诉你，应用程序 APK 文件存储在系统内的“/data/app/”中。除非设备已root，否则用户无法访问此文件夹。在有根设备上，您可以通过将 apk 粘贴到该文件夹​​中来绕过包安装程序。

预装的应用程序有时会放在 /system/app/ 中，这样用户就无法卸载它。

希望能给你一个更清晰的画面。

# iphone - 如何将ipa文件添加到Windows机器的iTunes中？

> ID：10952246
> 
> 赞同：3
> 
> 时间：2012-06-08T15:59:56.017
> 
> 标签：iphone, windows, ipa, provisioning-profile

我为我的应用程序创建了一个**配置文件**和一个 .ipa。我不得不将此发送给使用 Windows 机器的客户。我知道如何在 MAC 机器中添加 .ipa 文件，但是对于**Windows 机器**，我无法在 iTunes 窗口的左侧栏中找到 App 部分。**所以我无法将配置文件和 .ipa 文件从 Windows 机器**拖放到 iTunes 中。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:13:42.180

让您的客户从 App Store 下载免费应用程序，可能目标库中没有任何应用程序会使 iTunes 认为它​​不应该在菜单中显示该项目。

我还认为您可以打开/关闭 iTunes 首选项中的单个菜单项，所以也许检查一下？

![在此处输入图像描述](../Images/508a4125725a6d81aaff691a3f14e30d.png)

# sql-server - 在 SQL Server 中，将嵌入在字符串中的空字符 Char(0) 替换为其十六进制代码

> ID：10952252
> 
> 赞同：4
> 
> 时间：2012-06-08T16:00:10.463
> 
> 标签：sql-server, replace, hex, nul

SQL Server T-SQL 中的什么构造将`Char(0)`用其十六进制代码替换嵌入在字符串中的空字符？

IE

```
 REPLACE('t'+Char(0)+'t', Char(0), REPLACE(master.dbo.fn_varbintohexstr(0), '000000', '')) 
```

不返回`'t0x00t'`，是什么？（这已经适用于 1 到 31。）

这个[问题](https://stackoverflow.com/questions/2298412/replace-null-character-in-a-string-in-sql)有解释问题是排序规则的答案。

这个[答案](https://stackoverflow.com/a/5172100/256431)显示`master.dbo.fn_varbintohexstr(0)`将返回`0x00000000`。

当我手动将内部简化`Replace`为 时`'0x00'`，只需添加一个`Collate`子句就可以让它工作，就像上面建议的问题的答案一样，但是我找不到适用于完整表达式的版本（然后可以用于所有 n , 0 到 31，跳过 9、10 和 13)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T05:31:51.650

What you want might be this.

```
SELECT REPLACE('t'+Char(0)+'t', Char(0), CONVERT(VARCHAR(10),REPLACE(master.dbo.fn_varbintohexstr(0), '000000', ''))) 
```

You need to convert it explicitly to VARCHAR

and if you want the full expression remove inner replace

```
SELECT REPLACE('t'+Char(0)+'t', Char(0), CONVERT(VARCHAR(10),master.dbo.fn_varbintohexstr(0))) 
```

# c# - 正确处理 WPF UserControl 上的控件

> ID：10952254
> 
> 赞同：1
> 
> 时间：2012-06-08T16:00:13.973
> 
> 标签：c#, wpf, user-controls

我得到了一个包含五个条目和五个用户控件的组合框。

当我选择 ComboBox 条目时，我想将第一个 UserControl 分配给我的网格。在第二个 ComboBox 条目上、第二个 UserControl 上、在第三个条目上......等等。

现在每个 UserControl 都包含一堆控件，例如 TextControls、ComboBoxes 和 CheckBoxes。

让我们想象下面的伪代码：

```
combobox_SelectedIndexChanged()
{
    if(comboBox.SelectedIndex == 1)
       grid.Content = new UserControlOne();
    else if(comboBox.SelectedIndex == 2)
       grid.Content = new UserControlTwo();
    else if(comboBox.SelectedIndex == 3)
       grid.Content = new UserControlThree();
    [...]
} 
```

在单击按钮时，我想获取分配控件的值，但我不知道如何访问 UserControl。

```
buttonSave_click()
{
    //TODO: Get Values of a UserControl and assign it to the Model-Class    
} 
```

如何访问 UserControl 的控件并获取它们的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:21:24.080

就个人而言，我会使用 MVVM 设计模式做这样的事情

将`ComboBox`绑定到`ViewModel`或`Model`对象的集合

所以你会有

```
<ComboBox ItemsSource="{Binding SomeCollection}" 
          SelectedItem="{Binding SelectedViewModel}"
          DisplayMemberPath="DisplayName" /> 
```

where`SomeCollection`是`object`您的`ViewModel`, 的集合，`SelectedViewModel`是`object`保存所选项目的属性

```
SomeCollection = new ObservableCollection<object>();
SomeCollection.Add(new ViewModelA());
SomeCollection.Add(new ViewModelB());
SomeCollection.Add(new ViewModelC());
SomeCollection.Add(new ViewModelD());
SomeCollection.Add(new ViewModelE());

SelectedViewModel = SomeCollection[0]; 
```

现在您`SaveCommand`可以访问通过使用选择的任何内容`SelectedViewModel`并将其转换为基于`typeof(SelectedViewModel`)的适当类型

就个人而言，我会使用通用接口`IViewModel`而不是`object`，并让它包含一些通用属性（例如`DisplayName`）和方法。根据您的功能，您甚至可以让它包含它自己的保存逻辑，因此您可以在保存命令中执行它：

```
SelectedViewModel.Save(); 
```

至于显示正确的 View/UserControl，我会使用`ContentControl`,`Content`绑定到你的`SelectedViewModel`, 并使用隐式数据模板告诉 WPF 如何绘制每个对象

```
<ContentControl Content="{Binding SelectedViewModel}">
    <ContentControl.Resources>
        <DataTemplate DataType="{x:Type local:ViewModelA}">
            <local:UserControlA />
        </DataTemplate>
        <DataTemplate DataType="{x:Type local:ViewModelB}">
            <local:UserControlB />
        </DataTemplate>
        <DataTemplate DataType="{x:Type local:ViewModelC}">
            <local:UserControlC />
        </DataTemplate>
        <DataTemplate DataType="{x:Type local:ViewModelD}">
            <local:UserControlD />
        </DataTemplate>
        <DataTemplate DataType="{x:Type local:ViewModelE}">
            <local:UserControlE />
        </DataTemplate>
    </ContentControl.Resources>
</ContentControl> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:02:39.070

将依赖属性添加到的类，并将它们绑定到您希望向世界公开`UserControl`的控件的属性。`UserControl`这使您`UserControl`可以向外界呈现一个合适的界面，同时在其内部环境的安全范围内做任何需要做的事情。

# asp.net-mvc - 刷新的部分视图结果中的 MVC 3 不显眼的 javascript 链接

> ID：10952255
> 
> 赞同：2
> 
> 时间：2012-06-08T16:00:14.507
> 
> 标签：asp.net-mvc, asp.net-mvc-partialview, unobtrusive-javascript

我注意到，如果您在可刷新的局部视图中添加不显眼的链接，例如

```
<a href="/" data-delete-chapter="@Model.Chapter.ChapterId" class="delete-chapter" >
    Delete
</a> 
```

在 javascript 文件中连接以执行（不那么难看的）Jquery 弹出删除确认）：

```
$("[data-delete-chapter]").each(function () {
    $(this).click(  ... 
```

然后在通过 ajax 刷新部分视图时，这些 javascript 处理程序将消失，因此您最终不得不在每次 ajax 调用时刷新它们。您可以使用 OnSuccess AjaxOption: 或直接在 html 中作为 data-ajax-success 执行此操作，例如我的页面上一个按钮：

```
<a data-ajax="true" data-ajax-loading="#chapterAjaxImage" data-ajax-method="GET"
data-ajax-mode="replace" data-ajax-update="#chapterContainer"
href="ScrollChapterPrev/@(Model.VideoId)?pageNumber=@(Model.PageNumber)"
data-ajax-success="afterChapterRefresh()" class="gallery-prev">
    <img src="@Url.Content("~/Content/Images/play/chapter-slider-prev.png")" alt="prev"     />
</a> 
```

但是我觉得在刷新我的章节列表的多个地方有 data-ajax-success="afterChapterRefresh()" 并不比让我的原始删除链接使用 javascript 更不显眼，从而避免需要引用刷新 JS 函数：

```
<a href="javascript:deleteChapter(10)" class="delete-chapter" >
    Delete
</a> 
```

在这种特殊情况下，有没有更好的方法，或者我是否尽可能不引人注目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-12T01:01:07.487

通过 ajax 加载内容意味着，在事件（点击或其他）有界之后，您正在向 DOM 注入一些东西。所以新注入的元素不会有那个事件绑定。

jQuery`on`会有所帮助。on 将处理当前元素和未来元素

改变这个

```
$("[data-delete-chapter]").each(function () {
     $(this).click(function(){
      //do something
     });
}); 
```

对此

```
$(document).on("click","[data-delete-chapter]"(function(){
  //do something
}); 
```

# php - 如何在不使用参数的情况下使用 MVC 加载页面？

> ID：10952256
> 
> 赞同：1
> 
> 时间：2012-06-08T16:00:17.093
> 
> 标签：php, codeigniter, url-parameters, codeigniter-routing

我目前有一个网站，我还没有实现 MVC，但正在测试水域，看看它是否是我想做的事情。我在网上环顾四周，并没有找到我的问题的明确答案。我有点理解MVC的概念；但是，我想知道如何使用 MVC 处理用户制作的页面。

目前，我主要根据参数加载页面。用户可以添加自己的报价并将其插入数据库。然后，为了显示他们添加的作者的引语，用户将访问例如 mysite.com/author.php?quotee=Randy+Pausch。

理想情况下，我想转换我的网站，使 URL 看起来像 mysite.com/authors/Randy-Rausch 或类似的东西。

这是我对 MVC 不了解的地方。我是否需要以某种方式为每个作者创建一个视图，如果需要，我该怎么做？还是 URL 的最后一部分实际上是一个参数，即使它不使用“？quotee=Some+Author”语法？我觉得我不理解 MVC 的一个基本部分。

如果有人能为我的问题提供一个好的方法或一个好的教程，我将不胜感激。我看过关于静态页面的教程，但想要一个基于可由站点用户创建的页面的教程。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:51:41.957

您创建处理所有应用程序逻辑的“控制器”。在这种情况下，它会查看您请求的作者，并决定显示哪个“视图”。您的控制器可以通过“模型”查找每个作者的数据库信息。然后，您的“控制器”可以将此作者信息发送到将显示它的“视图”。

您只需要一个“视图”即可显示作者页面。它会是这样的：

```
Author name: <?php echo $author_name?>
Book title: <?php echo $book_title?>
Category: <?php echo $category?> 
```

然后在你的控制器中你会有类似的东西

```
$data['author_name'] = $this->your_model->get('author_name');
$data['book_title'] = $this->your_model->get('book_title');
$data['category'] = $this->your_model->get('category');
$this->load->view('authors_page', $data); 
```

显然还有更多的东西——但希望这能给你一个粗略的想法。

# javascript - JavaScript 在某处更改内容和滚动菜单错误

> ID：10952259
> 
> 赞同：1
> 
> 时间：2012-06-08T16:00:20.837
> 
> 标签：javascript, html, css, dhtml

[这个问题是我之前提出](https://stackoverflow.com/questions/10949579/simulate-cleartimeout-action-within-a-settimeout-function)的问题的后续问题（有不同的转折）：

我不确定如何恰当地描述我的问题：这是一个错误，只需要调试。

这是我的 jsFiddle：http: [//jsfiddle.net/Wagtail/b6Juh/18/](http://jsfiddle.net/Wagtail/b6Juh/18/)

我需要能够滚动项目 A、项目 B 和项目 C，而不是在鼠标离开项目 A 时完全消失。为什么会发生这种情况？

为了方便起见，这里复制了 JavaScript、HTML 和 CSS 代码：

**HTML**

```
<table id="headMenu">
    <tr>
        <td id="head1">Item 1</td>
        <td id="head2">Item 2</td>
        <td id="head3">Item 3</td>
    </tr>
</table>
<table id="subMenu">
    <tr>
        <td>Dynamic Content!</td>
    </tr>
</table>​ 
```

**CSS 代码：**

```
#headMenu{background:rgb(142,180,227);width:90%;height:50px;color:white;font-weight:bold;text-align:center;margin:20px 5%  0px 5%%;vertical-align:middle;}
#subMenu{background:rgb(195,214,155);width:90%;height:50px;color:white;font-weight:bold;text-align:center;margin:1px 5% auto 5%;vertical-align:middle;}
#headMenu td:hover{background:rgb(162,200,240);}
#subMenu td:hover{background:rgb(210,230,170);}​ 
```

**JavaScript 代码：**

```
var a = 500, head1 = document.getElementById('head1'), subMenu = document.getElementById('subMenu'), timeout;

head1.onmouseover = function(displayMenu) {
    subMenu.innerHTML = '<tr><td>Item A</td><td>Item B</td><td>Item C</td></tr>';
    head1.onmouseout = function(getScroll) {
        subMenu.onmouseover = function(breakTimeout) {
            clearTimeout(timeout);
            subMenu.onmouseout = function(endFunction) {
                subMenu.innerHTML = '<tr><td>Dynamic Content!</td></tr>';
            };
        };
        timeout = setTimeout(function() {
            document.getElementById("subMenu").innerHTML = '<tr><td>Dynamic Content!</td></tr>';
        }, a);
    };
}; 
```

提前感谢任何答案！如果您需要澄清，我很乐意回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:31:26.693

当鼠标从一个子菜单表格单元格移动到另一个时，将触发您的 subMenu.onmouseout 函数。解决此问题的一种简单方法是添加另一个超时以在单元格之间移动。

我已经更新了您的 jsfiddle 示例以说明我的意思：

[http://jsfiddle.net/b6Juh/22/](http://jsfiddle.net/b6Juh/22/)

# java - java正则表达式：查找1个或多个数字的模式，后跟一个

> ID：10952264
> 
> 赞同：11
> 
> 时间：2012-06-08T16:00:28.793
> 
> 标签：java, regex

我遇到了 java 正则表达式问题。

如何找到 1 个或多个数字后跟单个 . 在一个字符串中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T16:05:26.240

```
"^[\\d]+[\\.]$"

^     = start of string
[\\d] = any digit
+     = 1 or more ocurrences
\\.   = escaped dot char
$     = end of string 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-08T16:06:17.337

我认为这是您问题的答案：

```
String searchText = "asdgasdgasdg a121341234.sdg asdg as12..dg a1234.sdg ";
searchText.matches("\\d+\\.[^.]"); 
```

这将匹配“121341234”。和“1234”。但不是“12”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-08T16:02:46.573

```
(\\d)+\\. 
```

`\\d`代表任何数字
`+`表示一个或多个

请参阅此[http://www.vogella.com/articles/JavaRegularExpressions/article.html](http://www.vogella.com/articles/JavaRegularExpressions/article.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T16:34:58.057

在正则表达式中，元字符`\d`用于表示整数，但在 Java 代码中将其表示为正则表达式，`\\d`因为对它们执行双重解析，因此必须使用它。

首先是一个字符串解析器，它将其转换为`\d`，然后是正则表达式解析器，它将它解释为一个整数元字符（这是我们想要的）。

对于“一个或多个”部分，我们使用`+`贪婪量词。

由于双重解析场景，`.`我们使用来表示 a 。`\\.`

所以最后我们有了`(\\d)+(\\.)`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T16:05:09.640

`\\d+)\\.`

`\\d`代表数字，`+`代表一个和更多，`\\.`代表点。如果在匹配*任何*`.`字符之前没有反斜杠写入。

# c# - 控制 EditorForModel 填充数据的方式

> ID：10952270
> 
> 赞同：0
> 
> 时间：2012-06-08T16:00:39.137
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, html-helper

我遇到了这样一种情况，即 EditorForModel 通过将提交的数据填充到我的模型中来进入我的方式。让我向您展示那个让我陷入困境的用例。

一方面，我有一个可以保存到数据库中的表单：

```
public class Person {
    [HiddenInput(...)]
    public int Id {get; set;}

    public string Name {get; set;}
} 
```

在我的控制器的另一边，我有一些动作可以让我记录用户：

```
public class PersonsController {

     public ActionResult User(bool SaveAsNew, Person p)
     {
          if (SaveAsNew)
          {
               myRepository.Add(p);
               myRepository.SaveChange();
               // p.Id is now a new Value.
          }
          else {
               Person updateMe = myRepository.Query()
                        .Where(repoP => repoP.Id = p.Id)
                        .First();
               updateMe.UpdateWith(p)
               myRepository.SaveChange();
          }
           return PartialView(p);
     }
} 
```

在视图方面，我调用了`@Html.EditorForModel()`一些 Javascript，这些 Javascript 会根据您单击“保存”或“另存为新”来更新隐藏的输入。

但是我在这里遇到了麻烦，因为`EditorForModel`从发布的数据中填充数据，所以当用户点击“另存为新”时，Id 永远没有机会改变。

所以我想知道是否有某种方法可以清除提交的数据。就像是：

```
 if (SaveAsNew)
          {
               myRepository.Add(p);
               myRepository.SaveChange();
               Request.ClearPostData();
               // p.Id is now a new Value.
          } 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-19T10:12:21.090

好吧，有几种方法可以做到这一点。您可以查看提交表单时使用了哪个按钮，但这有点复杂。

在您的情况下，您可能只需在表单中添加一个隐藏字段，然后在单击添加为新按钮时使用一些 javascript 来设置该字段。像这样的东西（未经测试，但应该是这样的）：

```
@using(Html.BeginForm()) {
    @Html.Hidden("SaveAsNew", "false")

    <input type="submit" value="Save As New" onclick="$('#SaveAsNew').val('true');" />
    <input type="submit" value="Save Normally"/>
} 
```

# batch-file - 从 Jenkins 执行 windows 批处理命令失败，但在 cmd.exe 中运行良好

> ID：10952280
> 
> 赞同：18
> 
> 时间：2012-06-08T16:01:07.203
> 
> 标签：batch-file, cmd, jenkins, xcopy

我试图在 MSbuild 之后在 jenkins 中运行这个命令

```
xcopy "C:\Program Files (x86)\Jenkins\workspace\trunk\Projects\results\results\obj\Debug\Package\PackageTmp" "Y:\Extraction_Zone\Jenkins\" /E 
```

Y：是映射的网络驱动器。这在 cmd.exe 中运行良好，但是当尝试在 Jenkins 中运行它时，我得到了错误`Invalid drive specification`。

这是詹金斯的输出：

```
Time Elapsed 00:00:04.03
[trunk] $ cmd /c call C:\Windows\TEMP\hudson3389873107474371072.bat

C:\Program Files (x86)\Jenkins\workspace\trunk>xcopy "C:\Program Files (x86)\Jenkins\workspace\trunk\Projects\results\results\obj\Debug\Package\PackageTmp" "Y:\Extraction_Zone\Jenkins\" /E 
Invalid drive specification
0 File(s) copied

C:\Program Files (x86)\Jenkins\workspace\trunk>exit 4 
Build step 'Execute Windows batch command' marked build as failure
Finished: FAILURE 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-08T16:05:15.680

我也曾经有过类似的问题。尝试在下面授予 Jenkins 服务“以此帐户登录”，`services.msc`并确保您在此处键入的帐户与您用于运行的帐户相同`cmd.exe`。

![在此处输入图像描述](../Images/62221bb8855473527e4c97d4d85a8f2c.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-06T16:36:43.107

这些基于 Java JAR 文件的命令对我有用：
cmd
net use x: \\
xcopy "dist\" x:\ /Y

就是这样！我花了很多时间来解决这个问题，直到我写了 CMD 和 NET USE！
我既不需要更改对 jenkins 服务的权限，也不需要使用 runas 命令。

但我必须提到，每个人都对网络驱动器具有读写权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-17T05:48:39.033

我的 Windows 任务运行批处理文件时遇到了同样的问题（我知道它不完全相同），我试图将文件复制到网络位置，即共享驱动器。我也使用了 UNC 路径和映射驱动器，但错误是一样的。对我来说，这是错误号 4 - MS DOS 错误代码。解决方案是使用**net use**命令！希望它有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-27T20:47:36.753

大多数事情都很容易解决。

1.  使用您尝试运行的内容创建一个批处理命令，filename.bat 并在其中包含命令提示符文本。
2.  为批处理命令创建一个普通的 Windows 快捷方式，编辑快捷方式高级属性并检查“以管理员身份运行”（棘手棘手）。
3.  现在从 jenkins 命令行调用中运行 filename.lnk 快捷方式，这将使您了解所有爵士乐。

:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-19T11:59:39.030

我已经用[CIFS 插件](https://wiki.jenkins-ci.org/display/JENKINS/Publish+Over+CIFS+Plugin)解决了我的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-14T09:51:00.433

adarshr 的解决方案（即修改服务的登录凭据）对我来说解决了部分问题：就我而言，这使我能够成功签出一个 mercurial 存储库（使用 ssh 协议），我可以使用“本地系统帐户”时不这样做。

但是，在运行命令行脚本或从构建部分中的 jenkins 'execute shell' 脚本运行相同的脚本之间，我仍然有不同的行为。就我而言，我编译了一个 Python 扩展。在 Jenkins 中，我无法导入扩展（我没有看到任何错误，但执行只是停止了，所以我怀疑它崩溃了）。

如果我卸载该服务并将从代理作为 Java Web Start 运行，我会得到相同的行为。这对我来说是一个临时修复，但这意味着当我重新启动 Windows 构建机器时，我必须手动重新启动 Java Web Start 应用程序。

所以 - 至少在我的情况下 - 很明显这是一个凭证问题。

凭证使用文档：[https ://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI](https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-25T10:50:48.490

遇到类似问题，找到了两种解决方法。

类型 1：告诉 Jenkins 映射驱动器。1.转到 -> 管理 Jenkins -> 脚本控制台（Groovy 脚本）。2.运行以下命令

```
 def mapdrive = "net use Y: \\\\copy_nework_address"
 mapdrive.execute();
 println "net use".execute().getText() 
```

类型：2 1.Goto -> cmd -> 运行“net use”以了解网络地址

```
xcopy "C:\Program Files (x86)\Jenkins\workspace\trunk\Projects\results\results\obj\Debug\Package\PackageTmp" "Copy_Network_Address\Extraction_Zone\Jenkins\" /E 
```

结论：- 我更喜欢第二种类型，因为每次重新启动后我都应该运行 Groovy 脚本。

# firefox - Firefox 不会通过 Amazon cloudfront 加载 .eot 文件

> ID：10952282
> 
> 赞同：0
> 
> 时间：2012-06-08T16:01:12.980
> 
> 标签：firefox, amazon-s3, amazon-cloudfront

我在亚马逊 S3 和云端托管字体文件。

使用 Firefox 显示我的网页时，我可以看到正在加载字体文件，但下载永远不会结束。

如果我停用 CDN，firefox 会正常从我的主机服务器获取文件。

它在有和没有 CDN 的 chrome、safari 和 IE 上也能正常工作。

我就是想不通这个问题。一些帮助将不胜感激！

[火狐网络面板截图](http://i.stack.imgur.com/9pnDs.png)

[我的网站在这里](http://www.escapar.com.co)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T02:10:01.040

大概您的 CDN 没有发送正确的响应标头以允许跨域链接？CSS 字体规范需要 Firefox 行为。见[http://dev.w3.org/csswg/css3-fonts/#default-same-origin-restriction](http://dev.w3.org/csswg/css3-fonts/#default-same-origin-restriction)

# mysql - 在 perl 中执行过程查询

> ID：10952287
> 
> 赞同：2
> 
> 时间：2012-06-08T16:01:26.263
> 
> 标签：mysql, perl

我有这样的查询

```
set @valid_total:=0;
set @invalid_total:=0;
select week as weekno, measured_week,project_id as project, 
role_category_id as role_category,
valid_count,valid_tickets,
(@valid_total := @valid_total + valid_count) as valid_total, 
invalid_count,invalid_tickets, 
(@invalid_total := @invalid_total + invalid_count) as invalid_total
from metric_fault_bug_project 
where measured_week = yearweek(curdate())
and role_category_id = 1 and project_id = 11; 
```

它在 heidi（MySQL 客户端）中执行得很好，但是当涉及到 perl 时，它给了我这个错误

```
DBD::mysql::st execute failed: You have an error in your SQL syntax; check the m
anual that corresponds to your MySQL server version for the right syntax to use
near ':=0;
                                set :=0;
                                select week as weekno, measured_week,project_id
as project' at line 1 at D:\Mx\scripts\test.pl line 35.
Can't execute SQL statement: You have an error in your SQL syntax; check the man
ual that corresponds to your MySQL server version for the right syntax to use ne
ar ':=0;
                                set :=0;
                                select week as weekno, measured_week,project_id
as project' at line 1 
```

问题似乎在`set @valid_total := 0;`一线。

我对 Perl 相当陌生。任何人都可以帮忙吗？

这是完整的 perl 代码

```
#!/usr/bin/perl

#use lib '/x01/home/kalpag/libs';

use DBI;
use strict;
use warnings;

my $sid = 'issues';
my $user = 'root';
my $passwd = 'kalpa';
my $connection = "DBI:mysql:database=$sid;host=localhost";

my $dbhh = DBI->connect( $connection, $user, $passwd) ||
            die "Database connection not made: $DBI::errstr";

my $sql_query = 'set @valid_total:=0;
         set @invalid_total:=0;
         select week as weekno, measured_week,project_id, 
                 role_category_id as role_category,
         valid_count,valid_tickets,
             (@valid_total := @valid_total + valid_count) as valid_total, 
                 invalid_count,invalid_tickets, 
         (@invalid_total := @invalid_total + invalid_count) as invalid_total
         from metric_fault_bug_project 
         where measured_week = yearweek(curdate())
         and role_category_id = 1 and project_id = 11';

 my $sth = $dbhh->prepare($sql_query) or die "Can't prepare SQL statement:     $DBI::errstr\n";

 $sth->execute() or die "Can't execute SQL statement: $DBI::errstr\n";

while ( my @memory = $sth->fetchrow() )
{
            print "@memory \n";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:13:21.163

您可能使用双引号字符串作为查询字符串，在这种情况下 perl 会查找变量`@valid_total`和`@invalid_total`. 这意味着您没有使用

```
use strict;
use warnings; 
```

因为否则你已经知道错误了。结果是 perl 将变量替换为空，这反映在您的错误中。

您需要做的是单引号字符串：

```
my $query = 'set @valid_total:=0;
set @invalid_total:=0;
select week as weekno, measured_week,project_id as project, 
role_category_id as role_category,
valid_count,valid_tickets,
(@valid_total := @valid_total + valid_count) as valid_total, 
invalid_count,invalid_tickets, 
(@invalid_total := @invalid_total + invalid_count) as invalid_total
from metric_fault_bug_project 
where measured_week = yearweek(curdate())
and role_category_id = 1 and project_id = 11'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:15:31.210

请始终使用严格和警告。如果您没有变量@valid_total，则警告会警告您

```
Possible unintended interpolation of @valid_total in string 
```

严格甚至会死。

在双引号字符串中，您必须转义 @ 符号：

```
"set \@valid_total:=0;" 
```

如果您根本不需要插值，最好使用单引号。

编辑：在我看到 perl 代码之后：

而不是做

```
my $sql_query = 'set @valid_total:=0;
         set @invalid_total:=0;
...';
 my $sth = $dbhh->prepare($sql_query) 
```

你应该做：

```
my $sql_query = 'set @valid_total:=0';
my $sth = $dbhh->prepare($sql_query);
$sth->execute;
$sth->finish;

$sql_query = 'set @invalid_total:=0'
$sth = $dbhh->prepare($sql_query);
$sth->execute;
$sth->finish;
... 
```

您不能在一个查询中执行多个语句。

# javascript - 如何通过 JQuery/Javascript 正确地将选定的下拉菜单值传递给 JSON 函数

> ID：10952288
> 
> 赞同：0
> 
> 时间：2012-06-08T16:01:28.103
> 
> 标签：javascript, jquery, html, json, jquery-mobile

我正在使用 JQuery Mobile、Javascript、HTML、JSON、AJAX、PHP 和 MySQL 将数据库中的值动态显示到网页上。

我有几个元素一起工作。首先是填充列表视图的下拉菜单。下拉菜单元素是从数据库中获取的。这是通过“on change”方法完成的，当被激活时，它会将选定的选项和下拉菜单的 ID 传递给 JSON 函数，该函数负责在 PHP 和函数的帮助下从数据库中检索数据。我还有一个单选按钮，可用作从数据库中检索并显示在列表视图中的结果类型的过滤器。

我的问题希望比看起来更简单。我正在尝试将下拉菜单中所选选项的值传递给我的 JSON 函数。我知道 JSON 需要一个对象，但我在这样做时遇到了问题。

为了说明我是如何尝试这样做的，假设我有一个包含水果的下拉列表，我有一个单选按钮，允许您从红色水果或绿色水果中进行选择，还有一个列表视图来显示我的结果：

```
<div data-role="fieldcontain">
    <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">

        <input type="radio" name="radio" id="red" value="1" checked="checked" onchange="change_fruit_color('red');"/>
        <label for="red">Red Fruits</label>
        <input type="radio" name="radio" id="green" value="2" onchange="change_fruit_color('green');"/>
        <label for="green">Green Fruits</label>

    </fieldset>
</div>

<li>
    <label for="fruit" class="select">Fruits</label>
    <select name="fruit" id="fruit" data-mini="true" onclick="populate_list('fruit', this);" onchange="clear_dropdown('fruit'); refresh_dropdown('fruit');">
        <option value=""></option>
    </select>
</li> 
```

请注意，我有一些额外的函数，refresh_dropdown() 和 clear_dropdown() 处理刷新我的下拉列表项，无需担心。populate_list 函数也很好用。问题是关于 change_fruit_color() 函数的逻辑：

```
function change_fruit_color(fruit_color)
{
    var selected_value = $("#fruits option:selected").text();

    if(selected_value)
    {
        switch(fruit_color)
        {
            case "red":
            populate_list('red', selected_value);
            break;

            case "practice":
            populate_list('green', selected_value);
            break;
        }
        clear_dropdown("fruit");
        refresh_dropdown("fruit");
    }
}

function populate_list(selected_fruit, this_menu)
{
    var find_fruit_url = server_root_url + 'fruit/find_fruit.php';
    var value = this_menu.options[this_menu.selectedIndex].value;

    var params = {
        control: selected_fruit,
        value: value
    };

    $.ajax({
    type: "POST",
    url: find_fruit_url,
    async:false,
    data: params,
        success: function(json){
            json_populate(json, selected_fruit, value);
        }
    });            
} 
```

如您所见，我可以调用 populate_list 三次；一次在下拉列表的“onclick”函数中，另一个在通过单选按钮框中的“onchange”事件调用的 change_fruit_color 中。这就是问题所在。

我试图为我的一般问题制作一个示例，以便我编写更少的代码供大家阅读。任何有关如何进行的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:56:51.700

您将`selected_value`作为第二个参数传递给`populate_list`，但您的第二个参数 ( `this_menu`) 应该是`select`如果您想获得`options`它的属性。我会将`this_menu`参数重命名为`selected_value`并使用它，而不是从`select`再次获取值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:04:08.820

请发布您的 json_populate 函数以检查那里发生了什么。也许可以节省时间的是您正确格式化 JSON 数组的方式。请记住，在处理 JSON 数组时，您必须使用以下表示法...

```
var myJsonArray = {
                    "name_1": value1,
                    "name_2": value2
                  }; 
```

所以也许你的参数的 var 应该是这样的：

```
var params = {
    "control": selected_fruit,
    "value": value
}; 
```

希望这可以帮助。路易斯·M。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-24T03:01:54.613

我通过使用此代码解决了类似的问题：

```
$.post(urlpath,formData,'json')

    .done(function(data) {

    $.each(data.collection, function (key, value) {
    $("#priorityid").append("<option value='"+value.codemaster_detls_name+"'>" + value.codemaster_detls_name + "</option>");

}) 
```

Priorityid 是特定列表的 id，codemaster_detls_name 是我从中检索数据的 mysql 表名。

# string - Adobe模式搜索算法

> ID：10952291
> 
> 赞同：0
> 
> 时间：2012-06-08T16:02:02.650
> 
> 标签：string, algorithm, data-structures

adobe reader 在其查找功能中使用哪种排序算法，以便能够在几秒钟内从非常大的文档中搜索任何模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:20:09.540

我不确定 Adob​​e 正在使用什么，但我猜想它可能是一些已知的快速字符串匹配算法（可能是 Rabin-Karp、Boyer-Moore 或 KMP）可能同时在所有文档页面上并行运行。对于短文本字符串，这应该非常非常快。

希望这可以帮助！

# android - 多个服务共享一个进程，有多少个“主”线程？

> ID：10952296
> 
> 赞同：3
> 
> 时间：2012-06-08T16:02:26.217
> 
> 标签：android, multithreading, android-service

假设我有两个应用程序共享相同的用户 ID 和相同的进程，通过在它们中声明`AndroidManifest.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" 
    package="com.myapp.appname1" 
    android:sharedUserId="com.myapp.sharedUserId">

    <application android:process="com.myapp.sharedProcess">
        ...
        ... 
```

和

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" 
    package="com.myapp.appname2" 
    android:sharedUserId="com.myapp.sharedUserId">

    <application android:process="com.myapp.sharedProcess">
        ...
        ... 
```

如果每个应用程序都定义了一个服务并且两者都在同时运行，尽管它们在同一个进程下运行，它们是否会为每个应用程序获得一个“主”线程？或者他们也共享一个“主”线程？

任何启示将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:49:31.463

每个清单不能有多个应用程序。两个应用程序通常不能共享同一个进程，但您可以使用 android:process 属性覆盖它（见下文）。

此外，Service 中的代码与应用中的 Activities 运行在同一个线程中，即 UI 线程。

如果您在同一个应用程序中有多个服务，它们与应用程序在同一个进程中，都在同一个线程上。

要解决此问题，您可以为应用程序指定进程名称，也可以为服务指定进程名称。请参阅 android:process 属性。

这将为每个服务提供一个单独的线程，因为每个进程当然都有自己的线程。

但是，根据您使用服务的目的，您可能更喜欢拥有多个 IntentService 类。它们都在与您的应用程序相同的*进程*中运行，但它们都有自己的*线程*，不同于 UI 线程。

当然，您也可以为同一个 Service 手动编写多个线程，但这更难正确实现。

# php - php 运算符优先级

> ID：10952299
> 
> 赞同：0
> 
> 时间：2012-06-08T16:02:36.687
> 
> 标签：php, math

我无法理解 php 如何计算标准数学函数。在一个具体的例子中，我有这个计算：

225 + 154 * 256 + 138 * 256 * 256 + 81 * 256 * 256 * 256 （正确，没有括号）

用 php 执行时会产生这个数字：1,368,038,113

现在，当我从逻辑上看这个并从左到右计算总和时，这个数字甚至都没有接近。使用便宜的简单计算器，它放弃了在 256 的最后两次乘法之前尝试计算它，因为这个数字太大了。

用 6 次乘以 256 的计算怎么可能得到这么小的数字呢？

对 php 实际如何得出这个答案的分解会很棒。

ps 我通读了这个页面：[http](http://www.homeandlearn.co.uk/php/php2p8.html) ://www.homeandlearn.co.uk/php/php2p8.html上面的内容仍然没有帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T16:10:27.187

```
225 + 154 * 256 + 138 * 256 * 256 + 81 * 256 * 256 * 256 
```

=>

```
225 
+ 
154 * 256 = 39,424
+ 
138 * 256 * 256 = 9,043,968
+ 
81 * 256 * 256 * 256 = 1,358,954,496 
```

=>

```
225 + 39,424 + 9,043,968 + 1,358,954,496 
```

=>

```
225 
+ 
39,424 
+ 
9,043,968 
+ 
1,358,954,496 
```

=>

```
1,368,038,113 
```

**编辑**

为什么我认为你在做：

```
225 + 154 * 256 + 138 * 256 * 256 + 81 * 256 * 256 * 256 
```

=>

```
225 + 154 = 379
* 
256 = 97,024
+ 
138 = 97,162
* 
256 = 24,873,472
* 
256 = 6,367,608,832
+ 
81 = 6,367,608,913
* 
256 = 1,630,107,881,728
* 
256 = 417,307,617,722,368
* 
256 = 106,830,750,136,926,208 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T16:13:02.607

结果是正确的。PHP 将先执行乘法，然后执行加法。它看起来像这样：

```
$res = 225 + (154 * 256) + (138 * 256 * 256) + (81 * 256 * 256 * 256)
$res = 225 + 39424       + 9043968           + 1358954496
$res = 1368038113 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T16:08:52.577

数学运算的基本顺序是：乘法/除法然后加法/减法。

使用一个超级简单的计算器，它一次只做一个运算。因此，一个简单的计算器可能会将您的输入视为这个凌乱的字符串：

`(((((((((225 + 154) * 256) + 138) * 256) * 256) + 81) * 256) * 256) * 256)`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T16:10:44.150

PHP 遵循数学规则：

BODMAS（括号、命令、除法、乘法、加法、减法）

所以在你的情况下，它会像这样评估：

```
225 + 154 * 256 + 138 * 256 * 256 + 81 * 256 * 256 * 256
225 + 39424 + 9043968 + 1358954496
1368038113 
```

如果您想以不同的顺序执行此操作，请使用括号。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-08T16:11:33.230

像往常一样，乘法优先于加法。我已经计算了方程并且它是正确的，所以我不明白你的问题是什么......？

“这个数字甚至没有接近” <== 没错，因为它是准确的：

```
225 + 154 * 256 + 138 * 256 * 256 + 81 * 256 * 256 * 256
=225 + 39424 + 9 043 968 +1 358 954 496
=1 368 038 113 
```

你期望的数字是多少？你是怎么数的？

# jquery - jQuery 选择器中的正则表达式

> ID：10952303
> 
> 赞同：3
> 
> 时间：2012-06-08T16:02:44.857
> 
> 标签：jquery, jquery-selectors

我有以下 HTML：

```
" <div class="questionItem"> 
<input data-val="true" data-val-number="字段 MappingId 必须是数字。" 
       data-val-required="MappingId 字段是必需的。" 
      id="answers_2__MappingId" name="answers[2].MappingId" type="hidden" value="23" /> 
<input id="answers_2__Item" name="answers[2].Item" type="hidden" value ="B0300" /> 
<input id="answers_2__SetAnswer" name="answers[2].SetAnswer" type="hidden" value="^" /> 
</div>

```

jQuery 将为我提供所有的 questionItems：

```
var coll = $('.questionItem'); 
```

我不需要所有这些，我只需要具有名称`answers[/d+].SetAnswer`和值的子输入的 questionItems `?`。

如何构建该`has()`子句？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:06:25.543

它应该是这样的：

```
var coll = $(".questionItem").filter(function() {
    return $(this).find(":input").filter(function() {
        return /^answers\[\d+\]\.SetAnswer$/.test(this.name) && this.value == "?";
    }).length > 0;
}); 
```

**演示：http:** [//jsfiddle.net/nUNJd/](http://jsfiddle.net/nUNJd/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:14:54.550

这里不需要正则表达式。只需使用`:has`和属性选择器：

```
$(".questionItem:has(input[name$='.SetAnswer'][value='?'])"); 
```

小提琴：http: [//jsfiddle.net/jonathansampson/S8kft/](http://jsfiddle.net/jonathansampson/S8kft/)

# windows - 为什么可执行二进制文件中有一些错误消息

> ID：10952307
> 
> 赞同：0
> 
> 时间：2012-06-08T16:02:55.963
> 
> 标签：windows, executable

在回答关于如何将 const 字符串数据存储在可执行文件中的另一个问题时，出现了一个问题：为什么运行时错误消息存储在可执行文件中而不是由操作系统生成？

`!This program cannot be run in DOS mode.`
看起来很合理，不能指望 DOS 检测到较新的 Windows 应用程序并生成适当的错误消息。当您的程序处于无法与操作系统函数可靠通信的状态时，也可能会发生有关堆栈帧损坏的其他一些问题

但有些是没有意义的：
`- Attempt to use MSIL code from this assembly during native code initialization...etc..`
如果我试图调用 .Net 程序集（我没有 - 这是纯 C++ 代码），.Net 或 OS 运行时肯定可以自己生成错误消息。

并且文件系统错误消息也在exe中。当然，我希望操作系统在运行时生成这些错误 - 如果应用程序在非英语版本的 Windows 上运行，我不希望系统错误反映该语言而不是我用来编译它的语言吗？

[只是一个周五下午的问题，但Raymond Chen 的网站](http://blogs.msdn.com/b/oldnewthing/)上似乎没有任何相关内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:57:13.747

The examples I know of are stubs that are placed specifically because there isn't a good way for the OS or some runtime to produce the error. Also, they are fundamental problems with the implementation, not the types of errors a user should ever see.

The DOS one is a perfect example. There's no way for DOS to recognize a Windows program and produce a reasonable error, so the stub code is included in Windows programs.

Your MSIL one is very similar. How can the runtime produce this error if the runtime isn't actually loaded (because the program is still initializing)?

Another example I can think of are "Pure virtual function called" in C++ programs. The abstract base class vtables are filled with stubs that emit this message. I suppose they *could* be stubs that make an OS call to produce the same message, but that seems like overkill for something that's never supposed to happen.

There's a similar problem if you try to call into the floating point library from a native C or C++ program that isn't actually linked against the floating point library. This is essentially a floating-point implementation detail of the language runtime library (in cooperation with the compiler and the linker). It's not an OS-level issue (in the sense that something like "file not found" is).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:25:35.810

这样您就可以全球化您的应用程序。

例如，即使它运行在法语操作系统上，Ivan 也可以用俄语显示错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:48:00.553

我猜这是 CRT 引入的代码，尝试编译一个不与[默认库](http://msdn.microsoft.com/en-us/library/f1tbxcxh%28v=vs.100%29)链接的测试应用程序并使用 mainCRTstartup 作为入口点，那么唯一的字符串应该是 DOS 存根中的错误消息。

# c++ - c++中if语句的替代

> ID：10952310
> 
> 赞同：-2
> 
> 时间：2012-06-08T16:03:04.227
> 
> 标签：c++, algorithm, optimization

我正在研究一种算法，并希望使我的代码更高效。我的代码使用简单的算术和比较语句。但是，我想替换 if 语句，因为它们可能很耗时。这段代码将运行超过一百万次，因此，即使是最轻微的改进也是值得赞赏的。请回答！这是代码-

```
int_1024 sqcalc(int_1024 s,int_1024 f){
    f=f*20;
    s=s-81;
    s=s-(f*9);
    if(s>=0){
        return 9;
    }
    s=s+f;
    s=s+17;
    if(s>=0){
        return 8;
    }
    s=s+f;
    s=s+15;
    if(s>=0){
        return 7;
    }
    s=s+f;
    s=s+13;
    if(s>=0){
        return 6;
    }
    s=s+f;
    s=s+11;
    if(s>=0){
        return 5;
    }
    s=s+f;
    s=s+9;
    if(s>=0){
        return 4;
    }
    s=s+f;
    s=s+7;
    if(s>=0){
        return 3;
    }
    s=s+f;
    s=s+5;
    if(s>=0){
        return 2;
    }
    s=s+f;
    s=s+3;
    if(s>=0){
        return 1;
    }
    s=s+f;
    s=s+1;
    if(s>=0){
        return 0;
    }
} 
```

我希望替换 if 检查，因为我“认为”它们会使算法变慢。有什么建议吗？int_1024 是一个具有 1000 位的 ttmath 变量，所以保存它可能是一个不错的选择？这么大的数字可能会除法或乘法慢点，所以我尝试使用加法，但无济于事。请帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T16:15:42.203

我不知道它是否更快，但它要短得多（并且更容易分析）。

```
int k[] = { 17, 15, 13, 11, 9, 7, 5, 3, 1 };
int r = 0;
f *= 20;
s -= 81;
s -= f * 9;
while (s < 0) {
    s += f;
    s += k[r];
    if (++r == 9) break;
}
if (s >= 0) return 9-r; 
```

**编辑：** 事实上，最初的发布者想出了一个聪明的方法来优化这个循环，通过预先计算`k`数组中常量的总和，并与`s`总和进行比较，而不是逐步将它们添加到`s`.

**编辑：** 我遵循了月影的分析技术，但得出了不同的方程式。原始的 TeX 格式替换为 ASCII 艺术（我试图让 MathJax 为我渲染 TeX，但它不起作用）：

```
S[0] = s                      >= 0 => 9 - 0
S[1] = S[0]   + f + 19 - 2*1  >= 0 => 9 - 1
S[2] = S[1]   + f + 19 - 2*2  >= 0 => 9 - 2
...
S[i] = S[i-1] + f + 19 - 2*i  >= 0 => 9 - i 
```

所以要计算`S[n]`：

```
 S[n] = S[n-1] + f + 19 - 2n
               .-- n
=>  S[n] = s +  >      (f + 19 - 2*i)
               `-- i=1       .-- n
=>  S[n] = s + n(f + 19) - 2  >      i
                             `-- i=1
=>  S[n] = s + n(f + 19) - n(n+1)
                            2
=>  S[n] = s + n(f + 18) - n 
```

因此，不等式`S[n] >= 0`是 中的二次方程`n`。假设`s < 0`，我们想`n`成为二次解的上限。

```
 +--                         --+
    |               _____________ |
    |             /        2      |
    | f + 18 - . / (f + 18) + 4s  |
    |           `                 |
n = | --------------------------- |
    |             2               | 
```

所以例程看起来像：

```
f *= 180;
s -= 81;
s -= f;
if (s >= 0) return 9;
f /= 9;
f += 18;
s *= 4;
int1024_t ff = f;
ff *= f;
ff += s;
ff = ff.Sqrt();
f -= ff;
f += f.Mod2();
return 9 - f/2; 
```

但是，我不确定在大整数对象上执行这些操作的费用是否值得实现以替换上面显示的简单循环。（除非您希望扩展该功能并且需要更长的循环。）

为了比循环更快，大整数平方根实现必须始终在 4 次迭代内收敛，以超过现有 while 循环的平均预期 4.5 次迭代。但是，该`ttmath`实现似乎并未计算整数平方根。它似乎计算一个浮点平方根，然后对结果进行四舍五入，我猜这会比循环慢得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T16:33:24.563

首先，我注意到如果final的条件`if()`为false，则返回值是未定义的。你可能想解决这个问题。

现在，函数以

```
f=f*20;
s=s-81;
s=s-(f*9);
if(s>=0){
    return 9;
} 
```

其余的看起来令人难以置信的重复。让我们看看我们是否可以使用这种重复。让我们建立一个不等式表 - s 的值与最终结果：

```
s + (f+17) >= 0: 8
s + (f+17) + (f+15) >= 0: 7
s + (f+17) + (f+15) + (f+13) >= 0: 6
.
.
s + (f+17) + (f+15) + (f+13) + ... + (f+1) >= 0: 0 
```

因此，每一行都测试 s + f 的某个倍数 + 某个常数是否大于 0。返回的值、常数和 f 的倍数看起来都相关。让我们尝试表达这种关系：

`(s + ((9-n)*f) + (2*n)-1 >= 0)`

让我们重新排列，所以 n 在一侧。

`(s + (9*f) - (n*f) + (2*n)-1 >= 0)`

`(s + (9*f) +1 >= (n*f) - (2*n))`

`(s + (9*f) +1 >= n*(f - 2))`

`n <= ((s + (9*f) +1) / (f - 2)`

现在，该函数具有针对不同输入的一系列返回值。事实上，我们对`n`0..8 范围内的值感兴趣：所提供的函数对于会产生的输入是未定义的`n < 0`（见上文）。序言确保我们永远不会看到会产生的输入`n > 8`。所以我们只能说

```
int_1024 sqcalc(int_1024 s,int_1024 f){
    f=f*20;
    s=s-81;
    s=s-(f*9);
    if(s>=0){
        return 9;
    }
    return (s + (9*f) +1) / (f - 2);
} 
```

对于结果未定义的所有情况，行为应该与旧版本相同，不需要大量条件或循环。

[在http://ideone.com/UzMZs](http://ideone.com/UzMZs)上展示了准确性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-10T16:50:52.823

我尝试求解二次方程，它使函数对于较大的数字变慢。按照@user315052 的答案，我编写了这个代码。

```
 int_1024 sqcalc(int_1024 s,int_1024 f){
int k[] = { 0, 17, 32, 45, 56, 65, 72, 77, 80, 81 };
f=f*20;
s=((f*9)+81)-s;
int i=0;
while(s>k[i]){
s-=f;
i++;
}
return 9-i;
} 
```

在这段代码中，我不是减去一个数字然后与零进行比较，而是直接将它与数字进行比较。到目前为止，这会产生最快的结果。虽然我可以进行二进制搜索....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-09T18:52:21.740

根据 OP 的评论，该函数试图找到满足不等式的所有值：

```
N * ((20 * F) + N) <= S 
```

对于所有 N，给定一个 F 和 S。

使用代数，可以得出：

```
1) N^2 + 20Fn - S <= 0  (where N^2 is N*N or sqr(N)) 
```

OP 应该对 F 和 N 使用一些常数并以代数方式求解（sp？）或在网上搜索“C++ 查找根二次方程”。

选择一个功能，然后分析功能并在必要时进行优化。

# geometry - 在 Cg 着色器中对球体进行纹理处理

> ID：10952315
> 
> 赞同：1
> 
> 时间：2012-06-08T16:03:24.950
> 
> 标签：geometry, mapping, textures, cg

所以我需要从 Cg 中的像素/片段着色器中将纹理映射到球体。

我在每次传递中作为“输入”的是笛卡尔坐标 x、y、z，用于球体上我希望对纹理进行采样的点。然后我将这些坐标转换为球坐标，并分别使用角度 Phi 和 Theta 作为 U 和 V 坐标，如下所示：

```
u = atan2(y, z)
v = acos(x/sqrt(x*x + y*y + z*z)) 
```

我知道这个简单的映射会在球体的两极产生接缝，但目前，我的问题是纹理在球体上重复了几次。我想要和需要的是整个纹理恰好围绕球体缠绕一次。

我已经摆弄了着色器并搜索了几个小时，但我找不到解决方案。我想我需要在某处应用某种缩放，但在哪里？或者，也许我完全走错了路，我对 Cg 和着色器编程很陌生……感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:39:08.680

由于反三角函数的结果是角度，因此它们将在`[-Pi, Pi]`for`u`和`[0, Pi]`for 中出现`v`（尽管您至少可以通过从学校获得的三角学基本知识搜索数小时）。所以你只需要适当地缩放它们。`u /= 2*Pi`并且`v /= Pi`应该这样做，假设您具有`GL_REPEAT`（或等效的 D3D）作为纹理坐标包装模式（您的描述听起来像）。

# android - Android：JavaCv 从相机获取 IplImage

> ID：10952317
> 
> 赞同：2
> 
> 时间：2012-06-08T16:03:29.160
> 
> 标签：android, opencv, javacv

```
protected IplImage processImage(byte[] data, int width, int height) {
    int f = 4;// SUBSAMPLING_FACTOR;

    // First, downsample our image and convert it into a grayscale IplImage
    IplImage grayImage = IplImage.create(width / f, height / f, IPL_DEPTH_8U, 1);

    int imageWidth = grayImage.width();
    int imageHeight = grayImage.height();
    int dataStride = f * width;
    int imageStride = grayImage.widthStep();
    ByteBuffer imageBuffer = grayImage.getByteBuffer();
    for (int y = 0; y < imageHeight; y++) {
        int dataLine = y * dataStride;
        int imageLine = y * imageStride;
        for (int x = 0; x < imageWidth; x++) {
            imageBuffer.put(imageLine + x, data[dataLine + f * x]);
        }
    }

    return grayImage;
} 
```

我应该从 onPreviewFrame(byte[] data, Camera camera) 得到一个 IplImage。以我在那里写的方式，我得到一个比原始图像小得多的 iplimage。有什么方法可以在新的 iplimage 上保持相同的尺寸？我应该避免二次抽样因素吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T08:57:15.427

是的，只需设置`f = 1`，它就不会进行二次采样。

# windows-phone-7.1 - 如何使用 Expensify WP7 处理 MessageBoxes？

> ID：10952323
> 
> 赞同：3
> 
> 时间：2012-06-08T16:03:57.117
> 
> 标签：windows-phone-7.1, wp7test

我有一个 Windows phone 7.1 应用程序，我正在尝试使用 Expensify 的 WP7Test 框架和 SpecFlow 的 Gherkin 功能实现 som UI 测试。我在测试我的应用程序在第一次运行时是否正确启动时遇到了真正的麻烦，因为我在显示主屏幕之前用 MessageBox 提示用户访问 GPS 和 Internet。首先，这段代码（相当粗略地）在“App”类构造函数中——我尝试将它移动到 MainPage 的“OnNavigatedTo”方法，结果相同。

```
 Trace:->Command timed out waiting for send              
 Trace:->Command timed out waiting for send              
 Trace:->Command timed out waiting for send              
 Trace:->Command timed out waiting for send              
 Trace:->Command timed out waiting for send              
 Trace:->Command timed out waiting for send              
 Trace:->Command timed out waiting for send              
 -> error:   App is not yet alive 
```

当我将消息框注释掉时，它工作得很好，但我也真的想测试它们——我的 MainPage 会根据这些提示的答案呈现！

我在场景中尝试了很多不同的步骤来启动应用程序：

```
Given my app is clean installed and running    /
Given my app is running within 20 seconds      /
Then my app is running                        / 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T17:58:10.247

因为测试框架与 ui 元素交互，所以它必须使用 ui 线程 - 所以我猜你的 messagebox 在这里以某种方式阻塞了 ui 消息泵。

也许这种情况是在这里引起的，因为这是您的第一页......但我需要做一些测试来检查。

一种简单的解决方法可能是为您的功能使用异步消息框方法 - 但这需要您稍微重新组织页面初始化功能。

* * *

如果这对您来说是一个严重的问题，请在 github 中记录问题和示例测试。

# jquery-ui - 在对话框显示上延迟加载 OpenLayers 地图？

> ID：10952324
> 
> 赞同：2
> 
> 时间：2012-06-08T16:04:02.113
> 
> 标签：jquery-ui, optimization, lazy-loading, openlayers

我正在开发一个网站，用户将在对话框中选择 OpenLayers 地图上的一个点（使用 jQuery UI 显示），然后根据地图上选择的点在页面的其余部分执行某些操作。用户还可以随时调用对话框来选择新点。

我的地图对话框和经纬度的回传工作得很好，但我的问题是页面加载优化。我最初的所有地图代码都在我的`$(document).ready()`函数中，而我的 OpenLayers.js 调用就在`<head>`页面的右侧。为了稍微改进一下，我将地图代码移到了它自己的 .js 文件中，并将链接（`<script>`标签）放在了两者的最底部`<body>`标签。它似乎稍微好一点，虽然我确实注意到地图的导航元素（缩放控件等）在屏幕上短暂闪烁，但我认为在样式表告诉它们隐藏之前。有什么办法可以强制地图仅在即将显示对话框时加载，因为我觉得稍微延迟会比主界面加载延迟更理想（可能很微妙）？也许更重要的是，走这条路有意义吗？对我来说，这听起来会是一种更好的做事方式，但我也愿意接受其他意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T09:17:32.173

您既可以加载 OpenLayers.js 库，也可以在对话框的打开事件中创建地图。这样页面加载速度会更快，如果用户从不打开对话框，您将跳过加载 OpenLayers.js。

```
var scriptAlreadyLoaded = false;

$("#dialog" ).bind("dialogopen", function(event, ui) {
  if(!scriptAlreadyLoaded){
    $.getScript("/scripts/OpenLayers.js", function() {
       //Instantiate OpenLayers map when script is loaded
       //...
    });
  }
  else{
    //It's second time user opens dialog so script is already loaded
    //and map instantiated.
  }
}); 
```

# vim - 在 Vim 中打开 mac 格式文件的命令行选项

> ID：10952327
> 
> 赞同：7
> 
> 时间：2012-06-08T16:04:11.843
> 
> 标签：vim, file-format

我有一个 mac 格式的文件，我知道我可以`:e! ++ff=mac`用来更改为正确的文件格式。我想知道的是，当我打开文件以使用正确的文件格式直接打开它时，是否可以通过命令行选项。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T16:05:57.497

您*可以*使用命令行执行此操作，尝试：

```
$ vim -c "set fileformat=mac" 
```

`-c <command>`在加载第一个文件之前执行。正如 jammessan 所指出的，这只会影响加载的第一个文件，后续文件将要求您`fileformat`为每个缓冲区进行更改。

如果这不起作用，您还可以尝试：

```
$ vim -c "e ++ff=mac" 
```

但最好在该机器上的 .vimrc 中进行设置：

```
set fileformats=mac,unix,dos 
```

指定启动新缓冲区时要尝试的格式。这也会影响`fileformat`为现有文件选择的内容。

请参阅`help file-formats`和`:help 'fileformat'`了解`:help 'fileformats'`更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:13:22.460

更好的解决方案是让 Vim 自动识别该格式的文件。你可以通过更新`'fileformats'`你的选项来做到这一点`~/.vimrc`

```
set fileformats=unix,dos,mac 
```

这将使 Vim 在确定文件的格式时检查所有三种格式。

# scala - 斯卡拉玩！使用 anorm 或 ORM

> ID：10952330
> 
> 赞同：12
> 
> 时间：2012-06-08T16:04:45.350
> 
> 标签：scala, orm, playframework, anorm

看来 Play 提供的所有示例应用程序！框架利用 anorm 进行持久化。选择 anorm 而不是 ORM 的原因是什么？如果您使用的是 ORM，您使用的是什么，为什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-09T15:20:25.993

[anorm](https://github.com/playframework/Play20/wiki/ScalaAnorm)是*Anorm is Not an Object Relational Mapper*的元首字母缩写词，因此它不是 ORM。

答案就在这里——它是为我们这些想要亲身体验他们的 SQL 查询的人准备的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-10T20:59:17.710

我认为 anorm 的大多数参数都列在文档的[相应页面](http://www.playframework.org/documentation/2.0.1/ScalaAnorm)上。

目前我个人更喜欢 Scala 和 Play 独立的数据访问层，因此我使用的是 Ebean（如果它是推荐的默认值，我也会使用 JPA）。

在我看来，能够在没有任何 Play 依赖的情况下使用模型是一个巨大的优势。此外，Anorm 似乎没有提供太多的数据库独立性，因为查询是用原生 SQL 表示的。

# neo4j - 如果关系不存在则返回节点

> ID：10952332
> 
> 赞同：97
> 
> 时间：2012-06-08T16:04:52.737
> 
> 标签：neo4j, cypher

我正在尝试使用密码创建一个查询，该查询将“查找”厨师可能拥有的缺失成分，我的图表设置如下：

```
(ingredient_value)-[:is_part_of]->(ingredient) 
```

`(ingredient)`将具有名称 =“染料颜色”的键/值。 `(ingredient_value)`可能具有 value="red" 和“是”的键/值`(ingredient, name="dye colors")`。

```
(chef)-[:has_value]->(ingredient_value)<-[:requires_value]-(recipe)-[:requires_ingredient]->(ingredient) 
```

我正在使用此查询来获取`ingredients`食谱所需的所有，但不是它们的实际值，但我希望只返回`ingredients`厨师没有的，而不是每个食谱所需的所有成分。我试过了

```
(chef)-[:has_value]->(ingredient_value)<-[:requires_value]-(recipe)-[:requires_ingredient]->(ingredient)<-[:has_ingredient*0..0]-chef 
```

但这什么也没返回。

这是可以通过 cypher/neo4j 完成的事情，还是最好通过返回所有成分并自己对它们进行分类来处理？

奖励：还有一种方法可以使用 cypher 将厨师拥有的所有值与食谱所需的所有值相匹配。到目前为止，我只返回了 a 返回的所有部分匹配项，`chef-[:has_value]->ingredient_value<-[:requires_value]-recipe`并自己汇总了结果。

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2013-01-10T09:09:41.337

**2013 年 1 月 10 日更新：**

在 Neo4j **2.0**参考中遇到了这个：

*尽量不要使用可选关系。首先，*

***不要像这样使用它们：***

*`MATCH a-[r?:LOVES]->() WHERE r IS NULL`您只需确保它们不存在即可。*

***而是这样做：***

```
MATCH a WHERE NOT (a)-[:LOVES]->() 
```

* * *

使用密码检查关系是否不存在：

```
...
MATCH source-[r?:someType]-target
WHERE r is null
RETURN source 
```

这 ？标记使关系可选。

或者

在 neo4j 2 中：

```
...
OPTIONAL MATCH source-[r:someType]-target
WHERE r is null
RETURN source 
```

现在您可以检查不存在的（空）关系。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-12-08T07:31:48.917

用于获取没有任何关系的节点

这是检查关系是否存在的好选择

```
MATCH (player)
    WHERE NOT(player)-[:played]->()
    RETURN player 
```

您还可以为此检查多个条件它将返回所有没有“已播放”或“未播放”关系的节点。

```
MATCH (player) 
 WHERE NOT (player)-[:played|notPlayed]->()
 RETURN player 
```

获取没有任何关系的节点

```
MATCH (player) 
WHERE NOT (player)-[r]-()
RETURN player 
```

它将检查没有任何传入/传出关系的节点。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-05-08T13:25:03.263

如果您需要“条件排除”语义，您可以通过这种方式实现。

从 neo4j 2.2.1 开始，您可以使用`OPTIONAL MATCH`子句并过滤掉 unmatched( `NULL`) 节点。

在and`WITH`子句之间使用子句也很重要，这样第一个子句定义了可选匹配的条件，第二个子句的行为类似于过滤器。`OPTIONAL MATCH``WHERE``WHERE``WHERE`

假设我们有 2 种类型的节点：`Person`和`Communication`. 如果我想获取所有从未通过电话交流但可能以其他方式交流的人，我会提出以下查询：

```
MATCH (p: Person) 
OPTIONAL MATCH p--(c: Communication) 
WHERE c.way = 'telephone'
WITH p, c 
WHERE c IS NULL 
RETURN p 
```

匹配模式将匹配所有人员与他们的通信，其中`c`将`NULL`用于非电话通信。然后过滤器（`WHERE`后`WITH`）将过滤掉电话通信而留下所有其他通信。

参考：

[http://neo4j.com/docs/stable/query-optional-match.html#_introduction_3](http://neo4j.com/docs/stable/query-optional-match.html#_introduction_3) [http://java.dzone.com/articles/new-neo4j-optional](http://java.dzone.com/articles/new-neo4j-optional)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-11T07:12:10.800

我使用 gremlin 完成了这项任务。我做了

```
x=[]

g.idx('Chef')[[name:'chef1']].as('chef')
.out('has_ingredient').as('alreadyHas').aggregate(x).back('chef')
.out('has_value').as('values')
.in('requires_value').as('recipes')
.out('requires_ingredient').as('ingredients').except(x).path() 
```

这返回了所有缺失成分的路径。我无法用密码语言来表述这一点，至少对于 1.7 版来说是这样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-09T08:49:51.463

最后一个查询应该是：

```
START chef = node(..)
MATCH (chef)-[:has_value]->(ingredient_value)<-[:requires_value]-(recipe)-[:requires_ingredient]->(ingredient)
WHERE (ingredient)<-[:has_ingredient]-chef
RETURN ingredient 
```

这种模式：`(ingredient)<-[:has_ingredient*0..0]-chef`

是它没有返回任何东西的原因。`*0..0`意味着关系的长度必须为零，这意味着成分和厨师必须是同一个节点，但它们不是。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-02-23T14:13:40.967

我写了一个要点，展示了如何使用 Cypher 2.0 很自然地做到这一点

[http://gist.neo4j.org/?9171581](http://gist.neo4j.org/?9171581)

关键是对可用成分使用可选匹配，然后比较以过滤缺失（空）成分或具有错误值的成分。

请注意，该概念是声明性的，不需要描述算法，您只需写下您需要的内容。

# deployment - Seam Hello World 不能通过 Eclipse 工作

> ID：10952333
> 
> 赞同：0
> 
> 时间：2012-06-08T16:04:55.367
> 
> 标签：deployment, jboss, seam

我正在尝试按照 Internet 上的任何教程来创建 Seam“hello world”应用程序。

我已经安装了 Seam 2.2.Final，并在我的 JBoss 5.1 服务器上使用 ant 部署了它的一些教程。他们工作。

现在，我想从 Eclipse 中运行其中的任何一个（甚至是一个空项目），但这是无法完成的。

所以，我在 Eclipse 中所做的是：

文件 -> 新建 -> Seam Web 项目

在 Seam Facet 配置中，我为我的 mysql 数据库创建了一个连接配置文件，使用我下载的 mysql 驱动程序：mysql-connector-java-5.1.10-bin.jar

当我测试连接时，ping 返回成功。

接下来我完成项目向导并重新启动我的 JBoss 5.1 服务器。

它返回 3 个异常：

```
 17:51:35,334 ERROR [[/SeamPr2]] Exception sending context initialized event to listener instance of class org.jboss.web.jsf.integration.config.JBossJSFConfigureListener
        com.sun.faces.config.ConfigurationException: CONFIGURATION FAILED! org.jboss.seam.jsf.SeamApplicationFactory
            at com.sun.faces.config.ConfigManager.initialize(ConfigManager.java:213)
            at com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureListener.java:196)
            at org.jboss.web.jsf.integration.config.JBossJSFConfigureListener.contextInitialized(JBossJSFConfigureListener.java:60)
            at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3910)
            at org.apache.catalina.core.StandardContext.start(StandardContext.java:4393)
            at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeployInternal(TomcatDeployment.java:310)
            at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeploy(TomcatDeployment.java:142)
            at org.jboss.web.deployers.AbstractWarDeployment.start(AbstractWarDeployment.java:461)
            at org.jboss.web.deployers.WebModule.startModule(WebModule.java:118)
            at org.jboss.web.deployers.WebModule.start(WebModule.java:97)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
            at java.lang.reflect.Method.invoke(Method.java:597)
            at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:157)
            at org.jboss.mx.server.Invocation.dispatch(Invocation.java:96)
            at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
            at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
            at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:668)
            at org.jboss.system.microcontainer.ServiceProxy.invoke(ServiceProxy.java:206)
            at $Proxy38.start(Unknown Source)
            at org.jboss.system.microcontainer.StartStopLifecycleAction.installAction(StartStopLifecycleAction.java:42)
            at org.jboss.system.microcontainer.StartStopLifecycleAction.installAction(StartStopLifecycleAction.java:37)
            at org.jboss.dependency.plugins.action.SimpleControllerContextAction.simpleInstallAction(SimpleControllerContextAction.java:62)
            at org.jboss.dependency.plugins.action.AccessControllerContextAction.install(AccessControllerContextAction.java:71)
            at org.jboss.dependency.plugins.AbstractControllerContextActions.install(AbstractControllerContextActions.java:51)
            at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
            at org.jboss.system.microcontainer.ServiceControllerContext.install(ServiceControllerContext.java:286)
            at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
            at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
            at org.jboss.system.ServiceController.doChange(ServiceController.java:688)
            at org.jboss.system.ServiceController.start(ServiceController.java:460)
            at org.jboss.system.deployers.ServiceDeployer.start(ServiceDeployer.java:163)
            at org.jboss.system.deployers.ServiceDeployer.deploy(ServiceDeployer.java:99)
            at org.jboss.system.deployers.ServiceDeployer.deploy(ServiceDeployer.java:46)
            at org.jboss.deployers.spi.deployer.helpers.AbstractSimpleRealDeployer.internalDeploy(AbstractSimpleRealDeployer.java:62)
            at org.jboss.deployers.spi.deployer.helpers.AbstractRealDeployer.deploy(AbstractRealDeployer.java:50)
            at org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:171)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.doDeploy(DeployersImpl.java:1439)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1157)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1178)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.install(DeployersImpl.java:1098)
            at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
            at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
            at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.process(DeployersImpl.java:781)
            at org.jboss.deployers.plugins.main.MainDeployerImpl.process(MainDeployerImpl.java:702)
            at org.jboss.system.server.profileservice.repository.MainDeployerAdapter.process(MainDeployerAdapter.java:117)
            at org.jboss.system.server.profileservice.repository.ProfileDeployAction.install(ProfileDeployAction.java:70)
            at org.jboss.system.server.profileservice.repository.AbstractProfileAction.install(AbstractProfileAction.java:53)
            at org.jboss.system.server.profileservice.repository.AbstractProfileService.install(AbstractProfileService.java:361)
            at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
            at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
            at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
            at org.jboss.system.server.profileservice.repository.AbstractProfileService.activateProfile(AbstractProfileService.java:306)
            at org.jboss.system.server.profileservice.ProfileServiceBootstrap.start(ProfileServiceBootstrap.java:271)
            at org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:461)
            at org.jboss.Main.boot(Main.java:221)
            at org.jboss.Main$1.run(Main.java:556)
            at java.lang.Thread.run(Thread.java:680)
        Caused by: java.lang.InstantiationException: org.jboss.seam.jsf.SeamApplicationFactory
            at java.lang.Class.newInstance0(Class.java:340)
            at java.lang.Class.newInstance(Class.java:308)
            at javax.faces.FactoryFinder.getImplGivenPreviousImpl(FactoryFinder.java:537)
            at javax.faces.FactoryFinder.getImplementationInstance(FactoryFinder.java:405)
            at javax.faces.FactoryFinder.access$400(FactoryFinder.java:135)
            at javax.faces.FactoryFinder$FactoryManager.getFactory(FactoryFinder.java:717)
            at javax.faces.FactoryFinder.getFactory(FactoryFinder.java:239)
            at com.sun.faces.config.processor.FactoryConfigProcessor.verifyFactoriesExist(FactoryConfigProcessor.java:186)
            at com.sun.faces.config.processor.FactoryConfigProcessor.process(FactoryConfigProcessor.java:131)
            at com.sun.faces.config.ConfigManager.initialize(ConfigManager.java:203)
            ... 71 more 
```

这是第二个：

```
 17:51:40,811 ERROR [AbstractKernelController] Error installing to Start: name=jboss.web.deployment:war=/SeamPr2 state=Create mode=Manual requiredState=Installed
        org.jboss.deployers.spi.DeploymentException: URL file:/Users/nataliazon/devel/jboss-5.1.0.GA/server/default/tmp/5c4o13-6fo297-h37fm7za-1-h37fmra7-v/SeamPr2.war/ deployment failed
            at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeployInternal(TomcatDeployment.java:331)
            at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeploy(TomcatDeployment.java:142)
            at org.jboss.web.deployers.AbstractWarDeployment.start(AbstractWarDeployment.java:461)
            at org.jboss.web.deployers.WebModule.startModule(WebModule.java:118)
            at org.jboss.web.deployers.WebModule.start(WebModule.java:97)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
            at java.lang.reflect.Method.invoke(Method.java:597)
            at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:157)
            at org.jboss.mx.server.Invocation.dispatch(Invocation.java:96)
            at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
            at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
            at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:668)
            at org.jboss.system.microcontainer.ServiceProxy.invoke(ServiceProxy.java:206)
            at $Proxy38.start(Unknown Source)
            at org.jboss.system.microcontainer.StartStopLifecycleAction.installAction(StartStopLifecycleAction.java:42)
            at org.jboss.system.microcontainer.StartStopLifecycleAction.installAction(StartStopLifecycleAction.java:37)
            at org.jboss.dependency.plugins.action.SimpleControllerContextAction.simpleInstallAction(SimpleControllerContextAction.java:62)
            at org.jboss.dependency.plugins.action.AccessControllerContextAction.install(AccessControllerContextAction.java:71)
            at org.jboss.dependency.plugins.AbstractControllerContextActions.install(AbstractControllerContextActions.java:51)
            at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
            at org.jboss.system.microcontainer.ServiceControllerContext.install(ServiceControllerContext.java:286)
            at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
            at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
            at org.jboss.system.ServiceController.doChange(ServiceController.java:688)
            at org.jboss.system.ServiceController.start(ServiceController.java:460)
            at org.jboss.system.deployers.ServiceDeployer.start(ServiceDeployer.java:163)
            at org.jboss.system.deployers.ServiceDeployer.deploy(ServiceDeployer.java:99)
            at org.jboss.system.deployers.ServiceDeployer.deploy(ServiceDeployer.java:46)
            at org.jboss.deployers.spi.deployer.helpers.AbstractSimpleRealDeployer.internalDeploy(AbstractSimpleRealDeployer.java:62)
            at org.jboss.deployers.spi.deployer.helpers.AbstractRealDeployer.deploy(AbstractRealDeployer.java:50)
            at org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:171)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.doDeploy(DeployersImpl.java:1439)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1157)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1178)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.install(DeployersImpl.java:1098)
            at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
            at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
            at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.process(DeployersImpl.java:781)
            at org.jboss.deployers.plugins.main.MainDeployerImpl.process(MainDeployerImpl.java:702)
            at org.jboss.system.server.profileservice.repository.MainDeployerAdapter.process(MainDeployerAdapter.java:117)
            at org.jboss.system.server.profileservice.repository.ProfileDeployAction.install(ProfileDeployAction.java:70)
            at org.jboss.system.server.profileservice.repository.AbstractProfileAction.install(AbstractProfileAction.java:53)
            at org.jboss.system.server.profileservice.repository.AbstractProfileService.install(AbstractProfileService.java:361)
            at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
            at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
            at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
            at org.jboss.system.server.profileservice.repository.AbstractProfileService.activateProfile(AbstractProfileService.java:306)
            at org.jboss.system.server.profileservice.ProfileServiceBootstrap.start(ProfileServiceBootstrap.java:271)
            at org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:461)
            at org.jboss.Main.boot(Main.java:221)
            at org.jboss.Main$1.run(Main.java:556)
            at java.lang.Thread.run(Thread.java:680) 
```

第三个：

```
 17:51:40,830 ERROR [AbstractKernelController] Error installing to Real: name=vfsfile:/Users/nataliazon/devel/jboss-5.1.0.GA/server/default/deploy/SeamPr2.war/ state=PreReal mode=Manual requiredState=Real
        org.jboss.deployers.spi.DeploymentException: URL file:/Users/nataliazon/devel/jboss-5.1.0.GA/server/default/tmp/5c4o13-6fo297-h37fm7za-1-h37fmra7-v/SeamPr2.war/ deployment failed
            at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeployInternal(TomcatDeployment.java:331)
            at org.jboss.web.tomcat.service.deployers.TomcatDeployment.performDeploy(TomcatDeployment.java:142)
            at org.jboss.web.deployers.AbstractWarDeployment.start(AbstractWarDeployment.java:461)
            at org.jboss.web.deployers.WebModule.startModule(WebModule.java:118)
            at org.jboss.web.deployers.WebModule.start(WebModule.java:97)
            at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
            at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
            at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
            at java.lang.reflect.Method.invoke(Method.java:597)
            at org.jboss.mx.interceptor.ReflectedDispatcher.invoke(ReflectedDispatcher.java:157)
            at org.jboss.mx.server.Invocation.dispatch(Invocation.java:96)
            at org.jboss.mx.server.Invocation.invoke(Invocation.java:88)
            at org.jboss.mx.server.AbstractMBeanInvoker.invoke(AbstractMBeanInvoker.java:264)
            at org.jboss.mx.server.MBeanServerImpl.invoke(MBeanServerImpl.java:668)
            at org.jboss.system.microcontainer.ServiceProxy.invoke(ServiceProxy.java:206)
            at $Proxy38.start(Unknown Source)
            at org.jboss.system.microcontainer.StartStopLifecycleAction.installAction(StartStopLifecycleAction.java:42)
            at org.jboss.system.microcontainer.StartStopLifecycleAction.installAction(StartStopLifecycleAction.java:37)
            at org.jboss.dependency.plugins.action.SimpleControllerContextAction.simpleInstallAction(SimpleControllerContextAction.java:62)
            at org.jboss.dependency.plugins.action.AccessControllerContextAction.install(AccessControllerContextAction.java:71)
            at org.jboss.dependency.plugins.AbstractControllerContextActions.install(AbstractControllerContextActions.java:51)
            at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
            at org.jboss.system.microcontainer.ServiceControllerContext.install(ServiceControllerContext.java:286)
            at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
            at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
            at org.jboss.system.ServiceController.doChange(ServiceController.java:688)
            at org.jboss.system.ServiceController.start(ServiceController.java:460)
            at org.jboss.system.deployers.ServiceDeployer.start(ServiceDeployer.java:163)
            at org.jboss.system.deployers.ServiceDeployer.deploy(ServiceDeployer.java:99)
            at org.jboss.system.deployers.ServiceDeployer.deploy(ServiceDeployer.java:46)
            at org.jboss.deployers.spi.deployer.helpers.AbstractSimpleRealDeployer.internalDeploy(AbstractSimpleRealDeployer.java:62)
            at org.jboss.deployers.spi.deployer.helpers.AbstractRealDeployer.deploy(AbstractRealDeployer.java:50)
            at org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:171)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.doDeploy(DeployersImpl.java:1439)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1157)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1178)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.install(DeployersImpl.java:1098)
            at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
            at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
            at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
            at org.jboss.deployers.plugins.deployers.DeployersImpl.process(DeployersImpl.java:781)
            at org.jboss.deployers.plugins.main.MainDeployerImpl.process(MainDeployerImpl.java:702)
            at org.jboss.system.server.profileservice.repository.MainDeployerAdapter.process(MainDeployerAdapter.java:117)
            at org.jboss.system.server.profileservice.repository.ProfileDeployAction.install(ProfileDeployAction.java:70)
            at org.jboss.system.server.profileservice.repository.AbstractProfileAction.install(AbstractProfileAction.java:53)
            at org.jboss.system.server.profileservice.repository.AbstractProfileService.install(AbstractProfileService.java:361)
            at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
            at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1631)
            at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1082)
            at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
            at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
            at org.jboss.system.server.profileservice.repository.AbstractProfileService.activateProfile(AbstractProfileService.java:306)
            at org.jboss.system.server.profileservice.ProfileServiceBootstrap.start(ProfileServiceBootstrap.java:271)
            at org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:461)
            at org.jboss.Main.boot(Main.java:221)
            at org.jboss.Main$1.run(Main.java:556)
            at java.lang.Thread.run(Thread.java:680) 
```

请帮我。我不知道错误来自哪里，因为在同一 JBoss5.1 和 Seam 2.2 上的 ant 部署工作正常，我一步一步地按照教程进行操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:52:09.093

我从来没有运气好通过 Eclipse 创建 Seam 项目。使用 seam-gen 在 eclipse 工作区中创建项目更简单，打开 Eclipse 并使用与您刚刚在 seam-gen 中创建的项目相同的名称创建一个新项目（不是 seam 项目，只是一个普通项目）。然后可以通过eclipse构建和配置项目。关于使用 2.2 和 JBoss 5 的建议 - 如果您打算继续使用 Seam，您可能需要考虑 Seam 3 或至少使用 JBoss 7 的 Beta Seam 2.3。除了少数人（Marek Novotny 放在一起 2.3）Seam 2 不再维护。Seam 3 不能与 JBoss 5 一起使用，Seam 2 需要很大的变形才能与 JBoss 7 一起使用。过渡处理得不好，看起来不会随着 Seam 3 - Apache Delta Spike 移动而改善。

# apache-flex - Flex 4.5 flex 不打开

> ID：10952335
> 
> 赞同：0
> 
> 时间：2012-06-08T16:04:57.620
> 
> 标签：apache-flex, flash-builder

“它说不是一个有效的存档文件” 实际上我正在尝试从源书代码打开 Flex4.5 培训。但是打开时会出现以下错误

# java - 单击列表视图项目时在 Android 活动之间切换

> ID：10952337
> 
> 赞同：0
> 
> 时间：2012-06-08T16:05:08.640
> 
> 标签：java, android

我搜索了几个小时以找到有关单击列表视图项时在 Android 活动之间切换的好教程。所有教程都描述了为单击的不同列表视图项调用不同的活动，但我想运行相同的活动而不考虑单击了什么项目这是我使用的代码，但这不起作用。

```
 list.setOnItemClickListener(new OnItemClickListener() {

     public void onItemClick(AdapterView<?> paramAdapterView, View paramView, int paramInt,
                        long paramLong) {
                    Intent newActivity = new Intent(getApplicationContext(), OrderDetails.class);     
                    startActivity(newActivity);
                }
                }); 
```

Manifest.xml 中调用的活动

```
</activity>
    <activity android:name=".OrderetDetails"></activity>
</application> 
```

如果可能的话，我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:17:17.393

您需要使用[onListItemClick](http://developer.android.com/reference/android/app/ListActivity.html#onListItemClick)而不是 onItemClick。

像这样的东西：

```
public void onListItemClick( final ListView l, final View v, final int position, final long id ) {
    Intent newActivity = new Intent(getApplicationContext(), OrderDetails.class);     
    startActivity(newActivity);
} 
```

# javascript - 我在使用来自 Pixastic 的 HTML5 Canvas 和 Javascript 过滤器处理我的图像时遇到问题，我做错了什么？

> ID：10952343
> 
> 赞同：0
> 
> 时间：2012-06-08T16:05:15.623
> 
> 标签：javascript, html, image-processing, html5-canvas, pixastic

Javascript "pixastic.custom (5) 文件是从 Pixastic 创建的，仅使用核心代码和 "lighten" 过滤器。该代码用于在 Mozilla 浏览器中重绘画布中的图像，但它没有过滤它。HTML5 是对画布进行编码，在画布上绘制图像，并且应该通过 Javascript 过滤器将图像重绘到画布上，然后将其变亮。这些有什么意义吗？

下面是我的代码：

```
<!DOCTYPE HTML>
<html>
<head>
    <script type="text/javascript" charset="utf-8" src="pixastic.custom  (5).js"></script>
    <style>
        body {
            margin: 0px;
            padding: 0px;
        }
        #myCanvas {
            border: 1px solid #9C9898;
        }
    </style>
    <script>
        window.onload = function() {
            var canvas = document.getElementById("myCanvas");
            var context = canvas.getContext("2d");
            var imageObj = new Image();
            imageObj.onload = function() {
                var options ={};
                Pixastic.process(imageObj, "lighten", options)
                    {amount : .5
                };
                options.resultCanvas;
                context.drawImage(imageObj, 80, 60);
            }

            imageObj.src = "IMAG8703.jpg";
        };
    </script>
</head>
<body>
    <canvas id="myCanvas" width="2000" height="4000"></canvas>
</body>
    </html> 
```

感谢您查看我的代码...我真的不知道为什么它不起作用。一切都在同一个目录中，一切都匹配。该代码是从 PIXASTIC 网站与 HTML5 Canvas 框架相结合的，一切都应该顺利运行......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:11:04.507

问题出在脚本标签的第 7 行。不知道你要做什么，但会有一个错误。

这是合法的。

```
Pixastic.process(imageObj, "lighten", {amount : .5}); 
```

# c# - 是否可以用 C# 编写一个将在 Windows 8 Metro 环境中运行的 Ping 类？

> ID：10952346
> 
> 赞同：5
> 
> 时间：2012-06-08T16:05:16.910
> 
> 标签：c#, windows, networking, windows-8, windows-runtime

由于 Windows 8 上的 Metro 环境缺少大部分 .NET 框架类库或包含大幅缩减的版本，是否可以从 Metro 风格应用程序执行“ping”？套接字支持，所以我想有希望，但我不知道从哪里开始，因为每个“C# Ping”示例都使用[`System.Net.NetworkInformation.Ping`](http://msdn.microsoft.com/en-us/library/system.net.networknformation.ping.aspx)并且在 WinRT 中不可用。

我还查看了 Mono 的源代码，他们的 ping 实现会启动 ping.exe 并从命令行的标准输出窗口返回结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T23:03:58.340

不，很遗憾没有。WinRT 不支持 ICMP：`IcmpCreateFile`相关的 Win32 API 仅在“桌面”API 分区中可用。ICMP 可以使用原始套接字实现，但由于 WinRT 不支持这些（并且通常需要提升，无论如何），您也无法使用此选项。

作为 Windows 应用商店网络扫描工具 ( [http://lanscan.rcook.org/](http://lanscan.rcook.org/) ) 的开发人员，我很想能够做到这一点。

# php - 将 Css 文件拆分为多维数组

> ID：10952352
> 
> 赞同：0
> 
> 时间：2012-06-08T16:05:34.113
> 
> 标签：php, arrays

我有以下CSS代码

```
header{
  color:#00F; 
  font-weight:bold
}
/* This is some comment */
body{
  font-size:11px;
} 
```

我想把它分成一个多维数组，比如

```
Array (
  [header] => array (
    [color] => "#00F",
    [font-weight] => "bold"
  )
  [body] => array (
    [font-size] => "11px"
  )
) 
```

我该怎么做呢？

非常感谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-08T16:08:27.040

使用正则表达式解析它。

对于“外部”块：一旦在每个表达式`([^{])+{([^}]+)}` 中都有文本，请使用：`selector {...}``([-\w]+):([^;]+);`

对于实际代码，请使用[preg_match(...)](http://php.net/manual/en/function.preg-match.php)

# applescript - 将网页内容保存为 PDF 的 AppleScript 引发错误：“无法将窗口“保存”设置为……”

> ID：10952353
> 
> 赞同：0
> 
> 时间：2012-06-08T16:05:39.127
> 
> 标签：applescript

我正在尝试将我在 Safari 中打开的 URL 的 Web 内容保存为 PDF。我能够通过 Automator 成功实现它，但我想要一个 AppleScript 来做到这一点。

这是我试图运行的脚本，它给我一个错误：

```
error "System Events got an error: Can’t set window \"Save\" to \"~/Desktop/Reports/\"." number -10006 from window "Save" 
```

我做的步骤：

1.  为另存为 PDF 创建了快捷方式...
2.  打开有一些网页内容的 Safari
3.  运行以下脚本：

    ```
    set destination_folder to "/Users/swatt/Desktop/Reports"
    tell application "System Events"
        keystroke "p" using {command down} -- activate print menu item
        delay myDelay
        keystroke "p" using {command down, option down, control down} -- to select the Save as PDF… option
        keystroke "g" using {shift down, command down} -- to select the folder location

        set value of text field 1 of sheet of window "Save" to destination_folder

        -- Now click the Go button
        click button "Go" of sheet of window "Save"
        delay myDelay

        -- Now that we are in our desired folder, set the file name and save
        set value of text field 1 of window "Save" to "TestResults.pdf"

        --click button "Save" of window "Save"
        click button "Go"
    end tell 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T14:09:14.033

键盘快捷键适用于最前面的应用程序，但对于 UI 元素（**窗口**、**文本字段**等），您必须指定进程

```
tell application "System Events"
    tell application process "Safari"
        keystroke "p" using {command down} -- activate print menu item
        --  other lines
        --
    end tell
end tell 
```

# php - 查找真实IP地址

> ID：10952354
> 
> 赞同：1
> 
> 时间：2012-06-08T16:05:39.427
> 
> 标签：php, ip

两部分问题。

首先，当我尝试在隐藏的输入字段中回显 IP 地址时，我的表单停止提交。我有 jquery 来验证一些输入，当 IP 地址出现在该字段中时，它都会停止。

其次，我获得的 IP 地址不是我在终端签入时找到的 IP 地址。为什么我的网站（通过 Godaddy 托管）显示的是代理 ip 而不是我的机器 ip？

这是我正在使用的代码。

```
function ipCheck() {
    if (getenv('HTTP_CLIENT_IP')) {
        $ip = getenv('HTTP_CLIENT_IP');
    }
    elseif (getenv('HTTP_X_FORWARDED_FOR')) {
        $ip = getenv('HTTP_X_FORWARDED_FOR');
    }
    elseif (getenv('HTTP_X_FORWARDED')) {
        $ip = getenv('HTTP_X_FORWARDED');
    }
    elseif (getenv('HTTP_FORWARDED_FOR')) {
        $ip = getenv('HTTP_FORWARDED_FOR');
    }
    elseif (getenv('HTTP_FORWARDED')) {
        $ip = getenv('HTTP_FORWARDED');
    }
    else {
        $ip = $_SERVER['REMOTE_ADDR'];
    }
    //$ip = str_replace('.','', $ip);
    return $ip;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T19:12:02.193

您的代码允许任何调用者指定他们想要的任何 IP 地址（也称为 IP 欺骗）。

攻击者所要做的就是发出带有附加 HTTP 标头的请求，例如`X-Forwarded-For: 123.123.123.123`.

此代码会降低您的安全性，以至于我可以假装我是 localhost (127.0.0.1) 或“圣诞老人”，因为这些值未经验证以包含实际的 IP 地址。

另请注意，例如，X-Forwarded-For HTTP 标头可以包含多个 IP 地址，而不仅仅是一个（以逗号分隔）。

`$_SERVER['REMOTE_ADDR']`是您唯一的选择。

# android - 将同一视图多次添加到视图中具有不同信息的 ViewFlipper

> ID：10952356
> 
> 赞同：0
> 
> 时间：2012-06-08T16:05:44.497
> 
> 标签：android, viewflipper

我有一个 viewflipper，我想多次填充相同的布局，但在每个布局中，我需要根据某个数组显示不同的文本和不同的背景图像。到目前为止，它只是每次都用不同的文本/背景替换第一个视图。现在，我已经预定义了数组。任何帮助是极大的赞赏。

取景器的代码：

```
private int numcards = 3;
private String creditnum[] = {"***********2451", "***********2452", "***********2453"};
private int carddraw[] = {R.drawable.fullcredit_blue, R.drawable.fullcredit_green, R.drawable.fullcredit_silver};

public void onCreate(Bundle savedInstanceState){
super.onCreate(savedInstanceState);
    this.requestWindowFeature(Window.FEATURE_NO_TITLE);
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.show_cards);
    viewFlipper = (ViewFlipper) findViewById(R.id.viewflipper);

    gestureDetector = new GestureDetector(this);
    for (int i = 0; i < numcards; i++)
    {
        viewFlipper.addView(View.inflate(this, R.layout.card_scroll_item, null), new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
        Typeface tf = Typeface.createFromAsset(getAssets(),"fonts/credit.otf");
        Button creditbtn = (Button) findViewById(R.id.credit_button);
        creditbtn.setBackgroundResource(carddraw[i]);
        TextView txtname = (TextView) findViewById(R.id.credit_type);
        txtname.setText("Visa");
        TextView txtnumber = (TextView) findViewById(R.id.credit_number);
        txtnumber.setText(creditnum[i]);
        txtnumber.setTypeface(tf);

    }
} 
```

我正在膨胀的视图的 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<Button
    android:id="@+id/credit_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="30dp"
    android:layout_marginRight="30dp"
    android:layout_marginTop="104dp" android:layout_marginBottom="220dp" android:layout_alignParentBottom="true"/>

<TextView
    android:id="@+id/credit_type"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignRight="@+id/credit_button"
    android:layout_alignTop="@+id/credit_button"
    android:layout_marginRight="22dp"
    android:layout_marginTop="21dp"
    android:text="Large Text"
    android:textAppearance="?android:attr/textAppearanceLarge" android:typeface="normal"/>

<TextView
    android:id="@+id/credit_number"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/credit_button"
    android:layout_alignRight="@+id/credit_type"
    android:layout_centerVertical="true"
    android:text="Medium Text"
    android:textAppearance="?android:attr/textAppearanceMedium" android:layout_marginLeft="15dp" android:layout_marginBottom="30dp"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T07:11:30.730

问题是您没有保留要添加的视图，因此在 Activity 的内容视图上调用 findViewById，它将始终返回具有该 ID 的第一个视图。试试这个：

```
View view = View.inflate(this, R.layout.card_scroll_item, null);
viewFlipper.addView(view);
Button creditbtn = (Button) view.findViewById(R.id.credit_button);
creditbtn.setBackgroundResource(carddraw[i]);
TextView txtname = (TextView) view.findViewById(R.id.credit_type);
txtname.setText("Visa");
TextView txtnumber = (TextView) view.findViewById(R.id.credit_number);
txtnumber.setText(creditnum[i]);
txtnumber.setTypeface(tf); 
```

这些布局参数是多余的，因为您在 XML 中定义了它们。

# python - Django [+Celery] 应用程序产生的进程数

> ID：10952359
> 
> 赞同：0
> 
> 时间：2012-06-08T16:05:53.027
> 
> 标签：python, django, deployment, redis, process

我已经开发了一个 Django 应用程序，现在我想将它托管在某个地方。我发现了一个基于流程的有趣提议。我正在考虑的两个报价如下：

1.  > 6 个进程，64MB 地址空间
    > 6 个进程，48MB 地址空间（建议用于 cron 和 ssh）

2.  > 9 个进程，64MB 地址空间
    > 6 个进程，48MB 地址空间（建议用于 cron 和 ssh）

考虑到我的应用程序运行如下：

1.  [`supervisord`](http://supervisord.org/)首先运行以管理其他进程。开始：
    1.  `nginx`
    2.  [`uWSGI`](http://projects.unbit.it/uwsgi/)
    3.  `redis`（需要[`RQ`](http://python-rq.org/)）
    4.  rqworker（来自[`django-rq`](https://github.com/ui/django-rq)，它是 Django 和 RQ 之间的桥梁）

我使用 PostgreSQL 作为数据库。你认为它可以适合第一个报价吗？如果我正确计算进程，它们是 6，但在 wiki 中我读到：

> PostgreSQL 需要 8 个 64MB 的进程。

如果这是真的，我想我需要切换到第二个offer，因为我的申请不再适合第一个offer。除此之外，我必须有一个进程来运行 ssh。

或者，我可以选择容器方法，这意味着我可以选择容器应该有 多少*物理内存并在其中运行我的所有进程。*

您认为哪种方法更适合我的应用程序？

谢谢你，
魔方

# ruby-on-rails - 有没有人使用过带有 Chosen.js 下拉菜单的 client_side_validations gem？

> ID：10952361
> 
> 赞同：2
> 
> 时间：2012-06-08T16:06:05.540
> 
> 标签：ruby-on-rails, client-side-validation, jquery-chosen

我正在使用 selected.js ( [http://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/) )。我想知道是否有人能够一起使用选择的选择框和 client_side_validations。

问题是，当我们使用 selected 时，它会隐藏原始 select 元素并呈现自己的下拉列表，当我们关注时不会调用验证，并且当显示验证消息时，它会与原始 select 元素一起显示，因此定位错误也不正确。

什么可能是处理这个问题的好方法，我是我们可以更改其中的一些代码`ActionView::Base.field_error_proc`，目前看起来像

```
 ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|
   unless html_tag =~ /^<label/
     %{<div class="field_with_errors">#{html_tag}<label for="#{instance.send(:tag_id)}" class="message">#{instance.error_message.first}</label></div>}.html_safe
   else
     %{<div class="field_with_errors">#{html_tag}</div>}.html_safe
   end
 end 
```

有任何想法吗 ？

编辑1：

我现在有以下对我有用的解决方案。

*   将类“chzn-dropdown”应用于我选择的所有选择
*   使用了 client_side_validations Gem 提供的以下回调

```
clientSideValidations.callbacks.element.fail = function(element, message, callback) {

  if (element.data('valid') !== false) {

    if(element.hasClass('dropdown')){

      chzn_element = $('#'+element.attr('id')+'_chzn');

      console.log(chzn_element);

      chzn_element.append("<label class='message-chzn'>"+message+"</label>");
  }
  else{
    callback();
  }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T11:55:42.333

关于选择更改时验证根本不运行的问题，您可以尝试以下操作：

```
selectbox.change(function() { setTimeout(function() { selectbox.focusout() }) }); 
```

我仍在寻找有关验证消息定位的解决方案，因为我真的很想避免篡改客户端验证 javascript。

**编辑**：

毕竟，这似乎是一个很好的解决方案，为了更接近客户端验证 api，我想出了以下内容（*它可能关心的人*）：

```
var settings = {
    type: 'ActionView::Helpers::FormBuilder',
    input_tag: '<div class="field_with_errors"><span id="input_tag" /><label class="message validationError" /></div>'
};

clientSideValidations.callbacks.element.fail = function (element, message, addError) {
    if ($(element).data('chosen') != null) {
        var chosen = $('#' + element.attr('id') + '_chzn');

        clientSideValidations.formBuilders[settings.type].add(chosen, settings, message);

        // Point the label back to the select box
        $('label[for="' + chosen.attr('id') + '"]').attr('for', element.attr('id'));

        // Mark it as invalid
        chosen.data('valid', false);
    } else {
        addError(element, message);
    }
};

clientSideValidations.callbacks.element.pass = function (element, removeError) {
    if (element.data('chosen') != null) {
        var chosen = $('#' + element.attr('id') + '_chzn');

        clientSideValidations.formBuilders[settings.type].remove(chosen, settings);

        // Un-mark it from invalid
        chosen.data('valid', null);
    } else {
        removeError(element);
    }
}; 
```

请注意，我使用数据属性 ( `data-chosen`) 来初始化选择框。同样对于标签单击以打开选择的工作，我在标签单击时明确打开列表框：

```
// element is the select box

// Delegate click event from related labels to element (this is already done on "good" browsers)
$('label[for="' + element.attr('id') + '"]').click(function() { element.click() });

// Delegate click event on original element and any related labels to open the list
$(element).click(function() { setTimeout(function() { element.trigger('liszt:open'); }, 0); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-12T10:47:48.527

尝试这个：

告诉 gem 你想要验证选择标签：

```
ClientSideValidations.selectors.inputs += ', select'; 
```

当 Chosen 的 Dropbox 更改时强制验证：

```
$('#form_field').chosen().change(function(e) {
  var settings = window.ClientSideValidations.forms[this.form.id];
  $(this).isValid(settings.validators);
}); 
```

由于 Chosen 隐藏了该字段，因此您需要在视图中明确启用该字段的验证：

```
<%= form_for ..., :validate => true do |f| %>
...
  <%= f.validate :form_field %>
...
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:45:58.997

```
 clientSideValidations.callbacks.element.fail = function(element, message, callback){
    if(element.data("valid") !== false) {
      callback();
      if(element.is("select") && $("#" + element.attr("id") + "_chzn").length > 0){
        element.parent().prepend($("#" + element.attr("id") + "_chzn"));
      }
    }
  } 
```

# c# - 试图从静态方法获取会话，但得到 NULL

> ID：10952368
> 
> 赞同：0
> 
> 时间：2012-06-08T16:06:30.683
> 
> 标签：c#, asp.net, .net, httpcontext

我正在尝试从静态函数获取当前用户会话，但 usObj 始终为空。

这就是我正在做的事情：

```
public static List<RequestTypeBL> GetRequestType(string itemNo, int requestTypeID, int claimID) {
    UserSession usObj = (UserSession)HttpContext.Current.Session["UserSessionObj"];
    RequestTypeBL reqTypeBL;
    reqTypeBL= SERT_BO.RequestTypeBL.GetClaimRequestType(claimID, requestType, usObj.UserID, itemNo); 
```

我错过了什么吗？请帮忙。

我可以从常规功能中执行以下操作：

```
return (UserSession)Session["UserSessionObj"]; 
```

我只在我们的生产环境中看到这种行为，当相同的代码在开发中运行时，一切正常。它可能与某种 IIS 设置有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:56:30.873

我曾经发生过类似的事情，这是因为应用程序池正在使用的工作线程数量，开发网络服务器只使用了一个。请求并不总是由同一个线程回答。我不记得在 IIS 上在哪里配置它，也不确定您是否使用 IIS。希望能帮助到你。

# java - JAXB：是否可以处理未知元素

> ID：10952378
> 
> 赞同：2
> 
> 时间：2012-06-08T16:07:25.890
> 
> 标签：java, tags, jaxb

我得到这样的xml内容：

```
<data>
   <randomtagname>
      <name>....</name>
      <description>.....</description>
      <description>.....</description>
   </randomtagname>
   <anotherrandomtagname>
      <name>....</name>
      <description>.....</description>
   </anotherrandomtagname>
   <thirdridiculousrandomtagname>
      <name>....</name>
      <description>.....</description>
      <description>.....</description>
   </thirdridiculousrandomtagname>
       .
       .
       .
</data> 
```

是否可以在不使用 @XmlAnyElement 的情况下创建一个带注释的 java 类并使用 jaxb 取消/编组该文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:19:09.073

对我来说，它看起来像是一个对象列表。制作一个具有

```
 List<Object> data
```

多变的。你不应该需要注释。

基本上，您希望您的 xml 接口足够通用，以接受可能具有不同字段的不同对象的列表。一旦这个接口接受了一个 java 对象列表，它就由你的 java 代码来确定它们是什么并将它们转换为正确的类类型。对该部分使用 instanceOf。其中一些在 java 泛型中进行了描述，您可以在其中传递任何对象，但您必须确定它是什么来转换它。我认为只要它以真正的类形式发送，instanceof 就可以工作。您不会发送对象列表，而是发送字符串、整数或自定义类（如 Myclass1、Myclass2）的列表。然后，一旦您阅读了该列表，请使用 instanceof 来确定列表中每个对象的对象类型，它是 String、Myclass1、Myclass2 等的实例......并适当地进行转换。

Reading your question closer I may be missing what you really need to know. Maybe this link hasbsomething that would help. [jaxb help](http://roseindia.net/jaxb/r/jaxb.shtml)

# jquery - JQuery 多个 id 隐藏 1 个 div

> ID：10952379
> 
> 赞同：0
> 
> 时间：2012-06-08T16:07:36.290
> 
> 标签：jquery

我正在做一个个人项目，只是遇到了一些麻烦。

我正在尝试制作一个简单的悬停菜单。

这个想法是，当用户将鼠标悬停在列表元素上时，它会显示一个 div，而当他们将鼠标悬停在 div 上或最初悬停在 div 上的元素消失时。

例如。

当您将鼠标悬停在其中一个上时，会出现一个 div。

```
<ul>
<li>Link 1</li>
<li>Link 2</li>
</ul>

<div id="link1div"><div id="link1innercontent"></div></div>
<div id="link2div"></div> 
```

现在，当您将鼠标悬停在 li 上时，会出现 div，当您将鼠标悬停在 div 上时，div 会消失。

我想要做的是当你用 li 或 div 鼠标移出时，div 消失了。我遇到了麻烦，因为当我尝试这样做时，两个 div 都消失了。

我的代码如下：

```
<div id="menu">
<ul>
                        <li id="link_1">Link 1</li>
                        <li id="link_2">Link 2</li>
                    </ul>
</div>

 <div id="link_1"><div id="link1innercontent"></div></div>
    <div id="link_2"></div>

$("#menu li").hover(function(){
var name1 = $(this).attr('id'); //ignore these, they are for selecting appropriate ids
var name = name1.split('_'); //ignore these, they are for selecting appropriate ids
openMenu(name[1]);
$("#m_"+name[1]).mouseleave(function(){ // I have tried $("#m_"+name[1]+",#"+name1) but it 
closeMenu(name[1]);                     // hides the div before you can access it.
});
});

function openMenu(name){
$("#m_"+name).slideDown();  
}

function closeMenu(name){
$("#m_"+name).slideUp();    
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:23:35.770

你这里有奇怪的 JavaScript。:) 这就是我的想法：你想`div`在鼠标离开时消失，`div`或者`li`？因此，由于您不能同时超过两者（将鼠标从一个传递到另一个将触发`mouseleave`事件），因此您必须执行以下操作：

`var t = setTimeout(...)`鼠标离开时设置超时变量`div`OR `li`（例如 500 毫秒）。此后隐藏 div（在`setTimeout`处理程序中执行此操作）。

现在，当您将鼠标移到`div`或`li`清除此超时时：`clearTimeout(t);`. 我认为这是大多数人这样做的方式（还有其他方式吗？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:21:17.960

你不能对两个元素使用一个 ID，你应该使用 class 代替：

```
<div id="menu">
<ul>
<li class="link_1">Link 1</li>
<li class="link_2">Link 2</li>
</ul>
</div>

<div class="link_1"><div id="link1innercontent"></div></div>
<div class="link_2"></div>

$("#menu li").hover(function(){
  var name1 = $(this).attr('class'); 
  var name = name1.split('_'); //ignore these, they are for selecting appropriate ids
  $('div.' + name[1]).slideDown() 
  }, function() {
    $('div.' + name[1]).slideup()
 }); 
```

# javascript - 如何让 Facebook 的 Chrome 扩展程序重复执行？

> ID：10952381
> 
> 赞同：1
> 
> 时间：2012-06-08T16:07:44.753
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在尝试编写我的第一个非常简单的 Google Chrome 扩展程序，作为一个朋友的笑话。我希望它用“give a $h1t”替换“like”的实例（我知道这似乎并不成熟，但这只是为了好玩）。

到目前为止，这是我的 Javascript 函数；

```
function giveASh!t(){
document.body.innerHTML = document.body.innerHTML.replace(new RegExp("Like", "g"), "Give a sh!t");
} 
```

据我了解，通过 HTML 搜索用我的替代方法替换“Like”的每个实例。这行得通。

但是，我面临的问题是，当您向下滚动浏览新闻提要时，新生成的内容不会被更改，“喜欢”的任何新实例都不会被修改。

我知道一旦初始页面完成加载，就会执行此代码，并且一旦执行它就不会重新运行。

我玩过 setInterval() 方法，这会导致一些奇怪的错误。我将它设置为 10 秒的间隔，但它会影响页面上其他内容（例如聊天部分）的加载，并且也不太好，因为页面会“卡顿”，就像正在刷新一样。最终页面会中断，并且无法进一步向下滚动新闻源。

我的主要观点是；我怎样才能让这个javascript以一种很好的方式连续运行？也许更好的方法是监听滚动事件，然后运行 ​​javascript？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T02:02:52.470

使用 jQuery 的[livequery()](http://docs.jquery.com/Plugins/livequery)插件，它允许您在将新 div 添加到 DOM 时更新 HTML：

```
$("#<id of divs that get added>").livequery(function(){giveAShit();}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:40:23.617

```
function giveASh!t(){
document.body.innerHTML = document.body.innerHTML.replace(new RegExp("Like", "g"), "Give a sh!t");
}
window.setInterval(giveASh!t, 1000); 
```

# .net - Kalitt 动态仪表板小部件编辑器位置

> ID：10952383
> 
> 赞同：0
> 
> 时间：2012-06-08T16:07:53.973
> 
> 标签：.net

我正在使用来自[http://dynamicdashboards.net/](http://dynamicdashboards.net/)的 kalitte 工具包，我们请求将小部件编辑器/配置模式弹出位置更改为顶部而不是居中。

浏览 Class widgetControlInfo 我找不到任何可以更改配置模式位置的东西。

如何将配置模式移动到视图顶部？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T10:00:27.917

如果您在包含仪表板的页面中覆盖样式，则可以实现此目的。示例如下所示。

```
.x-window { top: 0px !important; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T09:28:45.807

我们目前不支持此功能。

我们将在下一个版本中添加此功能。

我还添加了我的任务。

问候

电子邮件：berkay@dynamicdashboards.net

# arrays - 循环内的错误计算

> ID：10952384
> 
> 赞同：0
> 
> 时间：2012-06-08T16:07:57.497
> 
> 标签：arrays, excel, vba, loops, immediate-window

总而言之，我还没有遇到过像以前那样令人沮丧的事情。非常感谢您对这个 EXTREMELY NAIVE 问题的帮助。看起来问题很简单，但是我太投入了，以至于我的眼睛无法捕捉到愚蠢的错误。

（示例代码粘贴在下面 - 我使用了简化版本）。我只是有一个两列数组 X，我使用一个简单的循环填充这个数组中的值。所有参数 s、t、N 都是常数，我从工作表中的其他单元格中检索它们，因此您可以忽略它们。

**问题** 在**第二个**循环中，我填充数组 X 的元素。我用线性增加的值 (0.01, 0.02, 0.03, ...., 30) 填充第二列，第一列应该是这些函数第二列中的值和常数 N、s、t。听起来很简单！

**问题是**第一列中的值由于某种原因出现错误！！我在 Excel 和 Matlab 中都验证了它。例如，我取常数 N、s、t 的值，并插入 0.01 并在 Excel 和 Matlab 中计算第一列的值，它们都给出了相同的正确结果（-0.1113）。当我运行 VBA 代码时，它给出了不同的值（0.36 - 我 500% 确定 -0.1113 是正确答案）。 **更奇怪**的是，我在***Next j***语句中插入了一个**BREAK POINT**，对于 j = 1，我验证了所有常量的所有值，都正确，但 X(j,1) 仍然是 0.36。**让我抓狂**的是，当我粘贴我在 X(j,1) 的代码中使用的相同公式并将其粘贴到*****立即窗口**，它给出了正确的值（-0.113）..**非常相同的公式.. 零变化！！！！*****

 ***是否有任何直观的原因可能导致此问题？我检查了我的代码 100 万次，以确保参数名称没有重复，或者某些参数不会被重置。没有什么！

**任何 **输入将不胜感激。非常感谢你，我很抱歉这是一个愚蠢的问题。

```
Sub Misc()

Dim N As Integer                
Dim s As Integer                
Dim t As Integer                
Dim j As Integer                
Dim i As Integer                
Const Step As Double = 0.01     
Const B As Integer = 30         
Dim X() As Double               

N = Range("AB1").End(xlDown).Row                      
s = WorksheetFunction.RoundDown(Sheets("Replacement").Range("AB1"), -1)     ' Compute S (Smallest meter reading, rounded down to nearest 10)
t = WorksheetFunction.RoundUp(Sheets("Replacement").Range("AB" & N), -1)    ' Compute T (Largest meter reading, rounded upto nearest 10)
Sheets("Replacement").Range("AD1").Value = s                                ' Export S and T to Sheet "Replacement" for subsequent use in Goal Seek
Sheets("Replacement").Range("AE1").Value = t

        For i = 1 To N Step 1
            Sheets("Replacement").Range("AC" & i).Formula = "=ln(AB" & i & ")"       ' Logarithm of the meter readings
        Next i

        ReDim X(1 To (B / Step), 1 To 2) As Double                                  ' Second column has values of Beta, First column has F(Beta), where F() is given by Beta MLE

        For j = 1 To (B / Step)
             X(j, 2) = j * Step
             X(j, 1) = (X(j, 2) * (((N / ((t ^ X(j, 2)) - (s ^ X(j, 2)))) * ((t ^ X(j, 2) * (WorksheetFunction.Ln(t))) - (s ^ X(j, 2) * (WorksheetFunction.Ln(s))))) - (WorksheetFunction.Sum(Range("AC1:AC" & N))))) - N

        Next j

Range("A1").Resize(Ubound(X,1),Ubound(X,2)).Value = X

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T22:32:27.797

功能

```
WorksheetFunction.Sum(Range("AC1:AC" & N)) 
```

将返回活动工作表中指定范围的总和。尝试设置活动工作表（或在表达式中指定）以确保引用正确的工作表。***

# c++ - 区分 C++ 静态方法是由类调用还是由对象调用

> ID：10952385
> 
> 赞同：2
> 
> 时间：2012-06-08T16:07:57.470
> 
> 标签：c++, class, function, static

有没有办法判断一个类的静态方法是通过调用类方法还是通过来自对象的调用调用的？

```
class mertz
{
   static int x(void) {....}
   ....
}

int main( ... )
{
   int c = mertz::x();
   mertz     fred;  
   ind d = fred.x();
} 
```

x 能否区分它在 for c 和 d 中的调用？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T16:15:07.980

不是以可移植的方式，在大多数 C++ 实现中可能根本不是。

静态方法确实只是一个名字很有趣的全局函数。理论上，您可以检查调用堆栈以查找调用的来源......但是编译器生成的机器指令很可能对于两者都是相同的

```
mertx::x(); 
```

和

```
fred.x(); 
```

因为只需要实例的静态类型来查找要调用的方法，并且此信息在编译时可用。因此，在这两种情况下，调用代码都只会调用函数，而无需引用`fred`实例。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T16:09:17.960

不，没有办法区分。这两个调用是相同的。

出于好奇，您有什么理由尝试这样做吗？

希望这可以帮助！

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-08T18:09:41.787

您可以同时拥有同名的静态和非静态函数

```
class mertz 
{ 
   static int x(void) {....} 
   int x(void) {....}
}; 
```

否则，正如已经指出的那样，x 没有机会告诉它是如何被调用的。

# javascript - 使用 Selenium 修改 JavaScript 变量

> ID：10952396
> 
> 赞同：5
> 
> 时间：2012-06-08T16:09:20.893
> 
> 标签：javascript, selenium

我有一个名为的布尔 JavaScript 变量`foo`，我想将其值从 true 更改为 false。该变量具有全局范围。

在 Selenium 中，如何更改此变量的值？

（对用户隐藏的变量禁用了导致 Selenium 阻塞的 CPU 密集型功能。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-08T20:33:34.567

您没有指定语言和 Selenium 工具，所以...

Java + Selenium WebDriver

```
// assuming JS is enabled for this driver instance
((JavascriptExecutor)driver).executeScript("window.foo = false;"); 
```

Java + Selenium RC

```
selenium.getEval("window.foo = false;") 
```

C# + Selenium WebDriver

```
((IJavaScriptExecutor)driver).ExecuteScript("window.foo = false;"); 
```

# c# - 将两个表组合成一个实体类型

> ID：10952405
> 
> 赞同：0
> 
> 时间：2012-06-08T16:10:08.870
> 
> 标签：c#, entity-framework

所以我有两个相关表的旧系统，orders 和 orderextras。订单表的主键为 Id，标量属性为客户名称，外键为 orderextra_Id。orderextra 只有两个属性，作为其主键的 Id 和一个称为 extrainfo 的 varchar。

现在我刚刚开始阅读 EF 4.0 食谱，并且一开始它演示了将两个表组合成一个实体（所以基本上，我希望 extrainfo 出现在 order-entity 上，而不是将 orderextra 作为实体完全）。但是，在示例中，两个表共享相同的 PK。当他们有单独的 PK 并且其中一个表引用另一个表时，是否可以这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:17:33.153

在设计器中，在其中一个实体上，从两个表中添加所需的列，然后转到“映射详细信息”窗口。

从那里，您应该会看到 Tables -> "Maps to XXX table"。在此之下，您可以添加另一个表并以这种方式映射列，这样您就可以将多个表添加到您想要的属性中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:23:35.810

尝试这个：

```
modelBuilder.Entity<Order>()
    .Map(m =>
    {
        m.Properties(t => new { /* order columns */ });
        m.ToTable("order");
    })
    .Map(m =>
    {
        m.Properties(t => new { /* orderextra columns */ });
        m.ToTable("orderextra");
    }); 
```

# nhibernate - 在 nhibernate 中映射具有相同名称的两列

> ID：10952410
> 
> 赞同：1
> 
> 时间：2012-06-08T16:10:41.267
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping, hibernate-mapping

我遇到过一个案例，我们有一个列映射了两次（我们不知道..），现在更新抛出“参数 +1 不存在错误”。

有什么合适的方法可以实现以下映射？

（请注意，这是一个继承的数据库......）

```
 References(x => x.Matter).Columns(new[] { "c_client", "c_matter" }).NotFound.Ignore();
        References(x => x.Client).Column("c_client"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T14:31:11.100

您可以选择将 Client 列标记为只读。

```
References(x => x.Matter).Columns(new[] { "c_client", "c_matter" }).NotFound.Ignore();
References(x => x.Client).Column("c_client").ReadOnly(); 
```

这应该使 NHiberante 不会尝试更新它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T23:27:27.443

这是一个无效的映射。您不能两次使用同一列。

我的建议是您将`c_matter`和映射`c_client`为标量属性并使用查询来检索相应的事项和客户。

# asp.net - 如何使用我的 Web 应用程序部署 XML 文件？

> ID：10952413
> 
> 赞同：0
> 
> 时间：2012-06-08T16:10:54.270
> 
> 标签：asp.net, xml, deployment

我编写了一个 ASP.net Web 应用程序。为了遵循“实用程序员”中的建议来配置应用程序逻辑，我编写了一个描述各种业务规则的大型 XML 文件。

当我在本地开发工作站上测试应用程序时，我将文件复制到`c:\xxxxx\myfile.xml`然后编写代码以从该位置读取文件。

将此 xml 文件部署为我的 Web 应用程序的一部分以便从部署 Web 应用程序的目录中读取它的正确方法是什么？

**更新：**有问题的 XML 文件用于服务器端配置，并且**永远**不能下载给最终用户。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T16:24:58.493

如果您不将此作为资源嵌入，您应该：

1.  创建该文件所在的目录。
2.  创建文件并将其构建操作设置为内容。
3.  在该目录中创建一个 web.config 文件，该文件禁止访问该目录，这样您就不会将业务规则暴露给 Internet。
4.  在应用程序的主 web.config 中添加一个设置，该设置提供此文件相对于应用程序根目录的路径，即“~/MySecureFolder/MyBusinessRules.Xml”。
5.  有一些代码调用[HttpServerUtility.MapPath 方法](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath.aspx)将值从 web.config 中的设置转换为虚拟路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:16:32.443

我不知道这是否是您想要的 - 单击 XML 文件，然后打开属性窗口并找到“构建操作”属性。将值设置为“嵌入式资源”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:19:40.700

我认为你需要做的是：

1.  将 XML 文件添加到 Visual Studio 中的 Web 应用程序项目
2.  右键单击文件并选择“属性...”
3.  将**构建操作**设置为“内容”并将**复制到输出目录**设置为“不复制”

这将确保您的 XML 文件与您的 Web 应用程序的其余部分一起部署。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-08T16:17:56.170

如果您希望通过 http 请求将 XML 文件提供给您的服务器，您应该将它放在您的 Web 发布文件夹中。

此 ASP 指令应该可以帮助您找到发布路径：Request.ServerVariables("APPL_PHYSICAL_PATH")

# oracle - oracle中如何导出和导入BLOB数据类型

> ID：10952414
> 
> 赞同：4
> 
> 时间：2012-06-08T16:10:58.590
> 
> 标签：oracle, blob

如何使用任何工具在 oracle 中导出和导入 BLOB 数据类型。我想把它作为释放

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-04-23T18:26:59.470

回答，因为即使它是 5 岁的问题，它也有不错的观看次数。

由于这个问题是 5 年前提出的，因此有一个名为 SQLcl 的新工具（[http://www.oracle.com/technetwork/developer-tools/sqlcl/overview/index.html](http://www.oracle.com/technetwork/developer-tools/sqlcl/overview/index.html)）

我们将 SQLDEV 中的脚本引擎分解为 cmd 行。SQLDev 和这是基于 java 的，它允许使用 nashorn/javascript 引擎来编写客户端脚本。这是一个选择 3 列的简短示例。ID 只是表 PK ，命名要创建的文件的名称，并包含要从数据库中提取的 BLOB。

script 命令触发此脚本。我将此代码放在下面的名为 blob2file.sql 的文件中

所有这些加起来为零 plsql，零目录，而只是一些混合了 javascript 的 sql 脚本。

```
script
// issue the sql
// bind if needed but not in this case
var binds = {}
var  ret = util.executeReturnList('select id,name,content from images',binds);

// loop the results
for (i = 0; i < ret.length; i++) {
   // debug messages
    ctx.write( ret[i].ID  + "\t" + ret[i].NAME+ "\n");

   // get the blob stream    
     var blobStream =  ret[i].CONTENT.getBinaryStream(1);

   // get the path/file handle to write to
   // replace as need to write file to another location
     var path = java.nio.file.FileSystems.getDefault().getPath(ret[i].NAME);

   // dump the file stream to the file
     java.nio.file.Files.copy(blobStream,path);
}
/ 
```

结果是我的表被清空到文件中（我只有 1 行）。只需像任何普通的 sql 脚本一样运行。

```
SQL>  @blob2file.sql
1   eclipse.png
blob2file.sql   eclipse.png

SQL> 
```

# java - JFreeChart 创建分层时间序列

> ID：10952415
> 
> 赞同：1
> 
> 时间：2012-06-08T16:11:00.843
> 
> 标签：java, jfreechart

我需要将时间序列数据显示为分层条形图。JFreeChart可以吗？任何指针都会非常有帮助。

数据将是一个列表：（TS，X1，X2），其中我必须为给定的时间戳（TS）绘制 X1，X2 基本上将用作 X1 的给定值的标签。

编辑：另外，对于相同的 TS，可能存在不同的 X1 值。想法是将所有这些 X1 值表示为针对同一 TS 的分层条。

这是我想要的一个例子：

[![图表图像](../Images/6ea47b027f15285a132867c0eef1855a.png)](https://i.stack.imgur.com/o9rCo.png) .

（所以不是类别，我将在 X 轴上有 TS）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T14:12:26.010

听起来您想要一个条形图（x 轴由时间确定），条形图标有它们的值。您无需为标签添加新的数据系列，而是修改绘图的渲染。

这是一个简单的例子：

```
public class LabelledBarChartTest {
  public static void main(String[] args) {
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    DefaultCategoryDataset dataset = new DefaultCategoryDataset();
    dataset.addValue(10.0, "Series", new Integer(2010));
    dataset.addValue(20.0, "Series", new Integer(2011));
    dataset.addValue(30.0, "Series", new Integer(2012));
    JFreeChart chart = ChartFactory.createBarChart(null,null,null,dataset,
      PlotOrientation.VERTICAL,true,true,false);
    CategoryPlot plot = (CategoryPlot) chart.getPlot();
    CategoryItemRenderer renderer = plot.getRenderer();

    // label the points
    NumberFormat format = NumberFormat.getNumberInstance();
    format.setMaximumFractionDigits(2);
    CategoryItemLabelGenerator generator = new StandardCategoryItemLabelGenerator(
        StandardXYItemLabelGenerator.DEFAULT_ITEM_LABEL_FORMAT, format, format);
    renderer.setBaseItemLabelGenerator(generator);
    renderer.setBaseItemLabelsVisible(true);

    frame.setContentPane(new ChartPanel(chart));
    frame.pack();
    frame.setVisible(true);
  }
} 
```

信用到期 - 我从这个[例子](https://sites.google.com/site/drjohnbmatthews/jfreechartdemo)中得到了标签示例。

# perl - 如何指导 Perl 脚本检查网站响应？

> ID：10952418
> 
> 赞同：0
> 
> 时间：2012-06-08T16:11:46.907
> 
> 标签：perl

我正在 ping 一个网站并检查可用性并仅在它关闭时发送电子邮件。（根据下面的代码，这部分工作得很好。）

```
require LWP::UserAgent;
my $ua = LWP::UserAgent->new;
$ua->timeout(20);
my $response = $ua->get('https://www.Mysite.net/websuite/');
if (! $response->is_success) {
    #print 'CMM Is up and Running';  
    $path = "C:\\prac\\send_email_failure.ps1";
    $pwspath = "c:\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe";
    system("$pwspath -command $path"); #using powershell to invoke email utility      
} 
```

现在，我正在尝试扩展脚本以查看是否

1.  它可以在它关闭时检查并发送电子邮件（它现在正在这样做）并且在它被购买之前不发送电子邮件。顺便说一句，我使用 Windows 任务调度程序每 20 分钟运行一次脚本。

2.  在它看到网站启动后，它应该进入正常过程，检查网站是否再次关闭并发送电子邮件（例如，网站关闭然后重新购买并再次关闭）。我使用任务调度程序每 20 分钟运行一次脚本。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:12:02.133

如果您的脚本是从某种调度程序执行的，您将需要以某种方式保持上一个请求的状态。例如，您可以创建一个将最后状态标记为“关闭”的文件。

或者您可以简单地将您的脚本作为守护程序运行并安排每 20 分钟检查一次（例如使用[AnyEvent](https://metacpan.org/module/AnyEvent)）。这样您就不必处理与文件系统相关的问题。

```
use LWP::UserAgent;
use AnyEvent;

my $previous = 1;
my $watch = AnyEvent->timer(interval => 1200, cb => sub {
        if(check_status() == 0) {
            if($previous == 1) {
                # send e-mail
            }
            $previous = 0;
        }
        else {
            $previous = 1;
        }
    });

AnyEvent->condvar->recv;

sub check_status {
    my $ua = LWP::UserAgent->new(timeout => 20);
    my $response = $ua->get('...');
    return $response->is_success ? 1 : 0;
} 
```

# c# - 要在专用数据访问层类中使用的 DataContract？

> ID：10952423
> 
> 赞同：1
> 
> 时间：2012-06-08T16:12:11.517
> 
> 标签：c#, .net, wcf, datacontract, circular-reference

我正在玩 WCF 4.0。我有一个简单的服务，其中包含以下 DataContract：

```
[DataContract]
public class WeeklySchedule
{
    [DataMember]
    public DateTime DateMon;
    [DataMember]
    public string DishMon;
    [DataMember]
    public DateTime DateTue;
    [DataMember]
    public string DishTue;
    [DataMember]
    public DateTime DateWed;
    [DataMember]
    public string DishWed;
    [DataMember]
    public DateTime DateThu;
    [DataMember]
    public string DishThu;
    [DataMember]
    public DateTime DateFri;
    [DataMember]
    public string DishFri;
} 
```

我想建立一个单独的类库来保存数据库访问方法。我希望这些方法返回 WeeklySchedule 对象。

我怎样才能避免循环引用？

如果我将 DAL 类引用到 WCF 服务，我可以使用 db 方法，但 DAL 类不能“看到”DataContract 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:08:57.883

我们添加了第三个“层”，我们称之为应用程序。它可以访问 DTO（您在问题中定义的类）和数据层。然后，应用程序层充当拥有一切视图的层。它从数据层获取数据，并负责在将数据合约返回给调用者之前填充数据合约。因此，它将完成您的大部分服务工作。

这避免了您的循环引用。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T20:46:20.923

由于我缺乏知识，我认为如果我将 DataContract 和 ServiceContract 类与 WCF 服务类分开，我会遇到问题。

我的问题的解决方案是为合约创建一个通用类库，并让 WCF 类或数据访问层类访问它们。

# c# - 在安装期间解压缩和重新压缩 XAP 文件以修改配置文件时出现问题

> ID：10952425
> 
> 赞同：1
> 
> 时间：2012-06-08T16:12:38.003
> 
> 标签：c#, silverlight, zip, installshield, dotnetzip

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T07:31:21.120

## 选项 2

解决 1603 错误。

我在[此页面](http://kb.flexerasoftware.com/selfservice/viewContent.do?externalId=Q107182&sliceId=1)上找到的一条注释说：

> 验证 InstallScript 自定义操作的入口点函数声明的正确原型语法（如果设置中包含任何内容）。
> 
> 一个正确原型的例子是：`export prototype MyFunction(HWND);`
> 
> 注意：必须在原型中专门引用 HWND。通过自定义操作调用的所有 InstallScript 函数都必须接受 HWND 参数。此参数是 Microsoft Windows Installer (MSI) 数据库的句柄。

## 选项 1（不是选项）

*在这里戴上我务实的帽子：*

如果您只有两种情况，例如混合绑定和“正常”，我建议您在项目中简单地生成两个 ZAP 文件并只安装一个，或者（我的偏好）安装两者并动态决定将哪个 ZAP 文件名注入在运行时托管页面（如果您可以识别 MVC Web 应用程序中的运行模式）。

这使安装程序保持简单，并且在连接到同一个 Web 项目的两个 Silverlight 项目中的每个项目中都有一些共享主文件不会增加太多工作。

您可以使用共享的 TT 包含文件来使用*大多数*共享的配置模板生成任何配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T20:59:05.367

好的，我终于用 PowerShell 弄明白了。事实证明，我无法让任何 CopyHere 标志参数设置起作用，并且 CopyHere 不会覆盖 zip 文件夹对象中的文件，除非标志参数告诉它这样做。

最简单的解决方案是将所有 CopyHere 方法更改为 MoveHere 方法。这样，我就不必尝试覆盖文件，也不必删除我的工作文件，因为它被移回了 Zip 文件夹。

感谢您所有的帮助。

肯金克斯

# arrays - CUDA：固定大小的数组存储在哪个内存空间中？

> ID：10952433
> 
> 赞同：6
> 
> 时间：2012-06-08T16:12:53.960
> 
> 标签：arrays, cuda

在内核中设置固定大小的数组时，例如：

```
int my_array[100]; 
```

数组最终在哪个内存空间中？

特别是，我想知道这样的数组是否可以存储在 >= 2.0 设备上的寄存器文件或共享内存中，如果可以，要求是什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-09T02:39:36.310

对于 Fermi（可能还有更早的架构），要将数组存储在寄存器文件中，必须满足以下条件：

1.  数组仅用常量索引
2.  有可用的寄存器
3.  希望编译器也进行一些分析以确定对整体性能的影响

(1) 的原因是寄存器索引直接在 SASS 指令中编码。没有办法间接寻址寄存器。

限制（2）的寄存器数量的主要因素是：

*   SASS 指令仅包含 6 位用于寄存器索引，这将内核中可以使用的寄存器数量限制为 64 个。实际数量为 63，因此保留一个用于某些用途。
*   一个 SM 有一个寄存器块，由同时运行的所有线程共享。
*   保存变量也需要寄存器，因此编译器必须平衡寄存器的使用以获得最佳的整体性能。

(1) 的潜在解决方法是循环展开。如果循环使用循环计数器作为数组的索引，则展开循环（使用`#pragma unroll`或手动）会导致数组索引变为常量，因为现在每个数组访问都有单独的 SASS 指令。

部分基于此 NVIDIA 演示文稿：[本地内存和寄存器溢出](http://developer.download.nvidia.com/CUDA/training/register_spilling.pdf)。该文档还详细介绍了变量和数组的位置如何影响性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T16:19:12.940

内核中的本地数组，正如您定义的那样，当没有足够的寄存器时，分配在寄存器和本地内存中。

如果要在共享内存中分配数组，则必须按如下方式指定：

```
__shared__ int my_array[100]; 
```

# php - 用“yyyy-mm-05 hh:ii:ss”替换“yyyy-mm-dd hh:ii:ss”格式的日期的最短方法？

> ID：10952434
> 
> 赞同：4
> 
> 时间：2012-06-08T16:13:00.980
> 
> 标签：php, date, time

用 替换`'yyyy-mm-dd hh:ii:ss'`格式中的日期的最短方法是什么`'yyyy-mm-05 hh:ii:ss'`？

我需要更改日期天数，而不是从日期中减去几天。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T16:20:24.280

```
$date = '2012-06-08 11:15:00';
echo date('Y-m-05 H:i:s', strtotime($date)); // 2012-06-05 23:15:00 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T16:18:32.400

你可以去：

```
$dt = new DateTime('2012-06-08 12:00:00');
$dt->setDate($dt->format('Y'), $dt->format('m'), 5);
echo $dt->format('Y-m-d H:i:s'); 
```

也许不是最短的，但这是一种可靠的方法

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T16:20:53.507

使用正则[表达式](http://www.regular-expressions.info/php.html)，这将是最短的方式

同意@DaveRandom。这是最短的方式

```
preg_replace('/-\d{2} /','-05 ',$str) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-23T15:16:15.910

最有效的方法（不是最好的方法）是使用 substr_replace() 函数。

```
$input = '2012-06-08 11:15:00';
$output = substr_replace($input, '05', 8, 2);
echo($output); 
```

# android - Context.obtainStyledAttributes() 警告

> ID：10952440
> 
> 赞同：7
> 
> 时间：2012-06-08T16:13:06.593
> 
> 标签：android, android-widget, android-theme

我只是在这个问题上浪费了 3 个小时，所以我希望这可以节省一些时间。

```
public TypedArray obtainStyledAttributes (AttributeSet set, int[] attrs, int defStyleAttr, int defStyleRes) 
```

第二个参数`attrs` **必须**包含严格递增顺序的属性标识符，否则属性值将无法解析并且调用将静默失败，就好像属性不存在一样。

这不是我可以看到的记录，我花了很长时间才弄清楚出了什么问题。

# php - phpMailer - 你如何删除收件人

> ID：10952441
> 
> 赞同：56
> 
> 时间：2012-06-08T16:13:07.250
> 
> 标签：php, email, phpmailer

关于这个主题有很多 StackOverflow 问题，但我找不到能够帮助解决我遇到的问题的问题。我正在编写的脚本向具有不同消息内容的不同收件人发送多封电子邮件。

我可以通过多次重新初始化`phpMailer`对象来完成这项工作，但我想做的是一次创建对象，然后重新分配以下字段：

```
$mail->AddAddress($email);
$mail->Subject = $subject;
$mail->IsHTML(false);
$mail->Body = $message; 
```

这样我就可以运行那四行代码，然后根据需要一次又一次地发送邮件。、和字段很容易更改`Subject`，所以我遇到的问题出在函数中。`IsHTML``Body``AddAddress`

正如您可能猜到的，在我发送第一封电子邮件后，更改未来电子邮件的收件人将导致这些收件人堆叠到当前收件人列表中。

简而言之，*如何删除与我的`$mail`对象关联的电子邮件地址，以便在删除旧地址时每次都可以分配它们？*

`AddAddress`除了我可以使用的其他功能之外，还有其他功能可以分配地址吗？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2012-06-08T16:20:48.733

您可以使用[clearAllRecipients( )](https://phpmailer.github.io/PHPMailer/classes/PHPMailer-PHPMailer-PHPMailer.html#method_clearAllRecipients)

`$mailer->clearAllRecipients( ); // clear all`

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-06-08T16:20:16.167

我总是在向收件人发送电子邮件之前使用它：

```
// clear addresses of all types
$mail->ClearAddresses();  // each AddAddress add to list
$mail->ClearCCs();
$mail->ClearBCCs(); 
```

然后我这样做：（不使用 CC 或 BCC，**$toaddress**只是一个收件人数组）

```
foreach($toaddress as $key=>$val) { $mail->AddAddress( $val ); } 
```

我正在使用 PHPMailer **5.2**

# wordpress - 测试 WP_Query 对象是否为空

> ID：10952442
> 
> 赞同：6
> 
> 时间：2012-06-08T16:13:13.310
> 
> 标签：wordpress

如何测试 WP_Query 对象是否不返回任何匹配项？我希望能够做这样的事情，这是一个模板：

```
<?php
    $my_query = new WP_Query(array('post_type' => 'biographies'))
    if( ***HOW DO I TEST $my_query HERE*** ) {
        //if $my_query finds anything loop through it here
    } else {
        //if $my_query does not find anything            
    }
?> 
```

# 编辑

更好的例子，如果查询找到任何东西，我只想显示 h2：

```
<?php
    $outside_leasing_query = new WP_Query(array( 'post_type' => 'resin_biographies', 'tax_query' => array(
        'relation' => 'AND',
        array( 'taxonomy' => 'resin_buildings', 'field' => 'slug', 'terms' => $page_slug ),
        array( 'taxonomy' => 'resin_leasing_companies', 'field' => 'slug', 'terms' => 'rubenstein-partners', 'operator' => 'NOT IN' )
    ) )); // resin_buildings taxonomy term slug must match page slug
?>

<h2>Outside Leasing Contacts</h2>

<?php while ( $outside_leasing_query->have_posts() ) : $outside_leasing_query->the_post(); ?>

    <article <?php post_class('group'); ?>>
        <?php
        if( get_post_meta( $post->ID, '_biography_headshot', true ) != '' ) {
            echo '<img class="contact-thumb" src="' . get_post_meta( $post->ID, '_biography_headshot', true ) . '" alt="'. get_the_title() .'" />';
        } else {
            echo '<img class="contact-thumb-placeholder" src="' . get_bloginfo('template_url') . '/images/default_headshot.jpg" alt="'. get_the_title() . '" />';
        }
        ?>
        <div class="contact-info">
            <hgroup>
                <?php the_title( '<h3>', '</h3>' ); ?>
                <h4 class="contact-title"><?php echo get_post_meta( $post->ID, '_biography_title', true ); ?></h4>
            </hgroup>
            <div class="contact-address"><?php echo wpautop( get_post_meta( $post->ID, '_biography_address', true ) ); ?></div>
            <div class="contact-tel"><span>T</span> <?php echo get_post_meta( $post->ID, '_biography_tel', true ); ?></div>
            <?php if( get_post_meta( $post->ID, '_biography_fax', true ) != '' ) { ?>
                <div class="contact-fax"><span>F</span> <?php echo get_post_meta( $post->ID, '_biography_fax', true ); ?></div>
            <?php } ?>
            <div class="contact-email"><a href="mailto:<?php echo get_post_meta( $post->ID, '_biography_email', true ); ?>"><?php echo get_post_meta( $post->ID, '_biography_email', true ); ?></a></div>
        </div>
    </article>

<?php endwhile; ?>
<?php wp_reset_postdata(); ?> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T17:07:13.337

标准的 Wordpress 循环使用 have_posts() 为您执行此操作。

```
<?php
$my_query = new WP_Query(array('post_type' => 'biographies'));
if($my_query->have_posts()) : while($my_query->have_posts()) : $my_query->the_post();
?>
<!-- YOUR POST(S) -->
<?php endwhile; else : ?>
<p>No posts found</p>
<?php endif; ?> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-08T15:37:51.163

我想你可以使用：

!($my_query->have_posts())

所以：

```
<?php
    $my_query = new WP_Query(array('post_type' => 'biographies'))
    if( !($my_query->have_posts())) {
        //if $my_query finds anything loop through it here
    } else {
        //if $my_query does not find anything            
    }
?> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2015-06-22T18:13:58.360

In your first example, where you have the comment:

```
//if $my_query does not find anything 
```

Just set a parameter like this:

```
$my_query_found_something = 'not'; 
```

Then use it wherever you need like this:

```
if ($my_query_found_something == 'not') {
// keep looking
} 
```

# java - 字符串常量池内存扇区和垃圾回收

> ID：10952443
> 
> 赞同：4
> 
> 时间：2012-06-08T16:13:13.847
> 
> 标签：java, memory-management, garbage-collection

我在网站上阅读了这个问题[java 内存池是如何划分的？](https://stackoverflow.com/q/1262328/1376167)我想知道“字符串常量池”属于这些扇区中的哪一个？

池中的文字是否也`String`曾被 GC 处理过？

该方法从池中返回文字`intern()`的基本链接。`String`

如果池确实被 GCed，那么它不会对字符串池的想法适得其反吗？将再次创建新的`String`文字以使 GC 无效。

（假设池中只存在一组特定的文字，它们永远不会过时，迟早会再次被需要）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:18:45.023

据我所知，字符串文字最终出现在非堆 JVM 内存的“Perm Gen”部分。Perm Gen 空间仅在 Full GC 运行期间检查（而不是 Partials）。

在早期的 JVM 中（我承认我必须查一下，因为我不确定），字符串池中的字符串文字[从未被](http://www.javaranch.com/journal/200409/ScjpTipLine-StringsLiterally.html)GC 处理过。在较新的 JVM 中，[WeakReferences](http://mindprod.com/jgloss/interned.html)用于引用池中的字符串，因此实习字符串实际上可以进行 GC，但仅在完全垃圾收集期间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:26:03.083

阅读 String.intern() 的 JavaDoc 并没有给出实现的提示，但是根据[这个页面](http://mindprod.com/jgloss/interned.html)，实习字符串由弱引用保存。这意味着如果 GC 检测到除了包含实习字符串的存储库之外没有对实习字符串的引用，则允许收集它们。当然，这对外部代码是透明的，因此除非您使用自己的弱引用，否则您永远不会知道垃圾收集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-28T12:21:39.087

**字符串池**

> 字符串池（有时也称为字符串规范化）是用一个共享的字符串对象替换多个具有相同值但不同标识的字符串对象的过程。您可以通过保留自己的地图（根据您的要求可能使用软或弱引用）并将地图值用作规范化值来实现此目标。或者您可以使用 JDK 提供给您的 String.intern() 方法。
> 
> 在 Java 6 中使用 String.intern() 时，许多标准都禁止使用，因为如果池失控，很可能会出现 OutOfMemoryException。字符串池的 Oracle Java 7 实现发生了很大变化。您可以在 [http://bugs.sun.com/view_bug.do?bug_id=6962931](http://bugs.sun.com/view_bug.do?bug_id=6962931)和 [http://bugs.sun.com/view_bug.do?bug_id=6962930](http://bugs.sun.com/view_bug.do?bug_id=6962930)中查找详细信息。

**Java 6 中的 String.intern()**

> 在过去的美好时光里，所有的实习字符串都存储在 PermGen 中——堆的固定大小部分，主要用于存储加载的类和字符串池。除了显式内嵌的字符串，PermGen 字符串池还包含您程序中之前使用的所有文字字符串（这里使用了重要的词——如果从未加载/调用过类或方法，则不会加载其中定义的任何常量）。
> 
> Java 6 中这种字符串池的最大问题是它的位置——PermGen。PermGen 的大小是固定的，不能在运行时扩展。您可以使用 -XX:MaxPermSize=96m 选项进行设置。据我所知，默认 PermGen 大小在 32M 到 96M 之间变化，具体取决于平台。您可以增加它的大小，但它的大小仍然是固定的。这种限制需要非常小心地使用 String.intern——你最好不要使用这种方法来实习任何不受控制的用户输入。这就是为什么在 Java 6 时代字符串池主要是在手动管理的映射中实现的。

**Java 7 中的 String.intern()**

> Oracle 工程师对 Java 7 中的字符串池逻辑进行了极其重要的更改——将字符串池重新定位到堆中。这意味着您不再受单独的固定大小内存区域的限制。所有字符串现在都位于堆中，就像大多数其他普通对象一样，这允许您在调整应用程序时仅管理堆大小。从技术上讲，仅此一项就足以成为重新考虑在 Java 7 程序中使用 String.intern() 的充分理由。但还有其他原因。

**字符串池值被垃圾收集**

> 是的，如果您的程序根目录中没有对它们的引用，JVM 字符串池中的所有字符串都可以进行垃圾回收。它适用于所有讨论过的 Java 版本。这意味着如果您的实习字符串超出范围并且没有其他对它的引用 - 它将从 JVM 字符串池中被垃圾收集。
> 
> 有资格进行垃圾收集并驻留在堆中，JVM 字符串池似乎是您所有字符串的正确位置，不是吗？理论上这是真的——未使用的字符串将从池中被垃圾收集，使用的字符串将允许您节省内存，以防万一您从输入中获得相等的字符串。似乎是一个完美的内存节省策略？几乎如此。在做出任何决定之前，您必须知道字符串池是如何实现的。

[资源。](http://java-performance.info/string-intern-in-java-6-7-8/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:37:38.103

字符串，即使它们是不可变的，仍然像 Java 中的任何其他对象一样。对象是在堆上创建的，字符串也不例外。所以，`Strings that are part of the "String Literal Pool" still live on the heap, but they have references to them from the String Literal Pool.`

更多请参考此链接

```
 `http://www.javaranch.com/journal/200409/ScjpTipLine-StringsLiterally.html` 
```

新编辑：

```
public class ImmutableStrings

                {

                    public static void main(String[] args)

                   {
                        String one = "someString";
                        String two = new String("someString");

                        one = two = null;
                    }
                 } 
```

就在 main 方法结束之前，有多少对象可用于垃圾回收？0? 1？2？

答案是 1。与大多数对象不同，字符串文字总是从字符串文字池中引用它们。这意味着它们始终具有对它们的引用，因此没有资格进行垃圾收集。

我们的局部变量，一个或两个，都没有引用我们的 String 对象，仍然有来自 String Literal Pool 的引用。因此，该对象不适合进行垃圾回收。通过使用 intern() 方法始终可以访问该对象

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T16:19:34.893

`String`文字不会在运行时创建到池中。我不确定他们是否获得了 GC，但我怀疑他们没有这样做有两个原因：

*   在一般情况下检测何时不再使用文字将非常复杂
*   可能有一个静态代码段存储在其中以提高性能。其余数据可能围绕它构建，其中边界也是静态的

# ruby-on-rails - 过滤和排序 Rails 应用程序

> ID：10952449
> 
> 赞同：0
> 
> 时间：2012-06-08T16:13:34.260
> 
> 标签：ruby-on-rails, ruby, sorting, filter

我目前有一个部署的应用程序（fortworth.herokuapp.com），我正在尝试按标题和发布日期对电影进行排序，并按评级进行过滤。

我解决了能够过滤的问题（点击复选框然后点击刷新 - 页面开始为空）。但是，我也想对这些电影进行排序。现在，当您单击“标题”或“发行日期”时，所有电影都会消失。

`movies_controller#index`我相信我应该设置哈希以`session[]`记住设置。我`link_to`的标题和发布日期的方法如下：

```
link_to title, {:sort => column} 
```

如何实现 session[] 哈希以记住在排序之前选择的电影？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:22:02.927

我会做这样的事情：

```
class MoviesController < ApplicationController
  def index
    if session[:movies_sort_column].present? && params[:sort].nil?
      redirect_to movies_path(sort: session[:movies_sort_column]) and return
    end

    # yours implementation here
    @movies = Movie.order(params[:sort]).all
  end
end 
```

# wpf - 每个状态带有图像的自定义按钮

> ID：10952450
> 
> 赞同：1
> 
> 时间：2012-06-08T16:13:34.823
> 
> 标签：wpf, binding, user-controls, imagesource

我正在尝试创建一个像按钮一样的自定义用户控件，但我希望它为每个状态（正常、悬停、按下）使用不同的图像。用户控件包含一个用于显示图像的图像控件。我想在运行时更改 Image 控件的 Source，因此当 OnMouseEnter 事件触发时，我会将图像源更改为 HoverChange (ImageSource) 属性。

所以我尝试向用户控件添加 3 个 ImageSource 属性（NormalState、HoverState 和 PressedState），以便在需要时更改图像。（来自 WinForms）但问题是属性没有在代码中设置（WinForms 行为），所以我不能将它们分配给我的图像。但是当我在我的程序中使用用户控件时，我可以通过属性面板设置它们，但我不能在代码中使用它们（它们保持为 NULL）。

这是我想要达到的一些（伪）代码：

```
public partial class ThreeStateButton : UserControl
{

    public enum ButtonState
    {
        Normal,
        Hover,
        Pressed
    }

    public ImageSource NormalState { get; set; }
    public ImageSource HoverState { get; set; }
    public ImageSource PressState { get; set; }

    public ThreeStateButton()
    {
        InitializeComponent();
        SetState(ButtonState.Normal);
     }

    public void SetState(ButtonState state)
    {
        switch (state)
        {
            case ButtonState.Normal:
                imgButton.Source = NormalState;
                break;
            case ButtonState.Hover:
                imgButton.Source = HoverState;
                break;
            case ButtonState.Pressed:
                imgButton.Source = PressState;
                break;
        }
    }

    protected override void OnMouseEnter(MouseEventArgs e)
    {
        base.OnMouseEnter(e);

        SetState(ButtonState.Hover);
    }

    protected override void OnMouseLeave(MouseEventArgs e)
    {
        base.OnMouseLeave(e);

        SetState(ButtonState.Normal);
    }

    protected override void OnMouseLeftButtonDown(MouseButtonEventArgs e)
    {
        base.OnMouseLeftButtonDown(e);

        SetState(ButtonState.Pressed);
    }

    protected override void OnMouseLeftButtonUp(MouseButtonEventArgs e)
    {
        base.OnMouseLeftButtonDown(e);

        SetState(ButtonState.Hover);
    }
} 
```

主要问题是初始化后没有设置 ImageSource 属性（是的，通过编辑器中的属性面板设置了），我知道 WPF 中的工作方式有点不同，但我怎么能让这个工作方式我试试？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T21:18:22.323

我以更 WPF 风格的方式做到了。我创建了 3 个图像源属性，并为每个属性创建了一个 DependencyProperty。我还在我的 xaml 代码中添加了 3 个图像控件，并使用它们的注册名称作为 DependencyProperty 将这些图像源属性绑定到我的图像控件的图像源属性。然后只需隐藏图像或将它们设置为正确状态即可。

# c# - 具有固定值的多对一缺失列

> ID：10952454
> 
> 赞同：3
> 
> 时间：2012-06-08T16:13:57.250
> 
> 标签：c#, fluent-nhibernate, fluent-nhibernate-mapping

我正在处理一个具有锁定模式的遗留数据库。我面临的问题是，许多表都是以已知/固定/硬编码的实体类型 Id 值为键的，而不是具有列值。这意味着我不能使用普通的 References 构造。

对于具有 ENTITY_TYPEID 的表，我可以这样做：

```
public class EntityMap : ClassMap<Entity>
{
   public EntityMap()
   {
      References(x => x.Type)
         .Columns("ENTITY_SECTION","ENTITY_TYPEID");
   }
} 
```

它愉快地填充了 Entity.Type。

对于固定/已知/硬编码类型的表，我需要映射到硬编码值而不是 ENTITY_TYPE 列，因此在代码中解释：

```
public class EntityXMap : ClassMap<EntityX>
{
   public EntityXMap(int entityType)
   {
      References(x => x.Type)
         .Columns("ENTITY_SECTION", "ENTITY_TYPE = 123" );
   }
} 
```

HasMany() 有一个 Where() 构造，我可以在这种情况下使用它......

任何想法如何在这里实现类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:52:03.623

也许矫枉过正，但你可以试试

```
// add to config
var typemap = new TypeMap();
typemap.Id(x => x.Section, "ENTITY_SECTION");
typemap.Where("ENTITY_TYPE = 123");
typemap.EntityName("Type for EntityX");

References(x => x.Type)
   .Column("ENTITY_SECTION")
   .EntityName("Type for EntityX"); 
```

# java - 比较 Java 中的堆栈弹出和队列出列（回文）

> ID：10952455
> 
> 赞同：4
> 
> 时间：2012-06-08T16:14:03.633
> 
> 标签：java, linked-list, palindrome

**完全披露：这是一个作业，所以请不要发布实际的代码解决方案！**

我有一个任务要求我从用户那里获取一个字符串并将其传递到一个堆栈和一个队列中，然后使用这两个来比较字符以确定该字符串是否是回文。我已经编写了程序，但某处似乎存在一些逻辑错误。以下是相关代码：

```
public static void main(String[] args) {

    UserInterface ui = new UserInterface();
    Stack stack = new Stack();
    Queue queue = new Queue();
    String cleaned = new String();
    boolean palindrome = true;

    ui.setString("Please give me a palindrome.");
    cleaned = ui.cleanString(ui.getString());

    for (int i = 0; i < cleaned.length(); ++i) {
        stack.push(cleaned.charAt(i));
        queue.enqueue(cleaned.charAt(i));
    }

    while (!stack.isEmpty() && !queue.isEmpty()) {
        if (stack.pop() != queue.dequeue()) {
            palindrome = false;
        }
    }

    if (palindrome) {
        System.out.printf("%s is a palindrome!", ui.getString());
    } else
        System.out.printf("%s is not a palindrome :(", ui.getString());

    stack.dump();
    queue.clear();

}

 public class Stack {

   public void push(char c) {
    c = Character.toUpperCase(c);
    Node oldNode = header;
    header = new Node();
    header.setData(c);
    header.setNext(oldNode);
  }

  public char pop() {
    Node temp = new Node();
    char data;
    if (isEmpty()) {
        System.out.printf("Stack Underflow (pop)\n");
        System.exit(0);
    }
    temp = header;
    data = temp.getData();
    header = header.getNext();
    return data;
  }

}

public class Queue {

  public void enqueue(char c) {
    c = Character.toUpperCase(c);
    Node n = last;
    last = new Node();
    last.setData(c);
    last.setNext(null);
    if (isEmpty()) {
        first = last;
    } else n.setNext(last);     
  }

  public char dequeue() {
    char data;
    data = first.getData();
    first = first.getNext();
    return data;
  }

}

public String cleanString(String s) {
    return s.replaceAll("[^A-Za-z0-9]", "");
} 
```

基本上，当通过 Eclipse 中的调试器运行我的代码时，我的 pop 和 dequeue 方法似乎只选择某些字母数字。我`replaceAll("[^A-Za-z0-9]", "")`用来“清理”用户的任何非字母数字字符（！、？、& 等）的字符串。当我说它只选择某些字符时，似乎没有任何我可以辨别的模式。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:20:27.703

我建议使用调试器来查看正在比较的确切内容，或者至少吐出一些打印行：

```
while (!stack.isEmpty() && !queue.isEmpty()) {
    Character sc = stack.pop();
    Character qc = queue.dequeue();
    System.out.println(sc + ":" + qc);
    if (sc != qc) {
        palindrome = false;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:01:31.697

假设您的队列和堆栈是正确的，您的一般算法可以正常工作（我使用 jdk 中的 Deque 实现进行了尝试）。由于您的任务涉及数据结构，我几乎只是采用了您的主要逻辑并用 ArrayDequeue 替换了数据结构，所以我不觉得我在为您回答这个问题。

```
 String word = "ooffoo";

    word = word.replaceAll("[^A-Za-z0-9]", "");

    Deque<Character> stack = new ArrayDeque<Character>(word.length());
    Deque<Character> queue = new ArrayDeque<Character>(word.length());

    for (char c : word.toCharArray()) {
        stack.push(c);
        queue.add(c);
    }

    boolean pal = true;

    while (! stack.isEmpty() && pal == true) {
        if (! stack.pop().equals(queue.remove())) {
            pal = false;
        }
    }

    System.out.println(pal); 
```

# ios - AudioQueueStart 发布消息以杀死 mediaserverd

> ID：10952469
> 
> 赞同：0
> 
> 时间：2012-06-08T16:15:15.033
> 
> 标签：ios, avaudioplayer

我有一个钢琴应用程序。它工作正常，有一点错误。如果我同时快速弹奏几个键，声音会消失几秒钟，并在控制台中收到以下消息

> AudioQueueStart 发布消息以杀死 mediaserverd

以下是相关代码：

```
-(IBAction)playNoteFromKeyTouch:(id) sender{

    [NSThread detachNewThreadSelector:@selector(playNote:) toTarget:self withObject:[NSString stringWithFormat:@"Piano.mf.%@",[sender currentTitle]]];

}

-(void)playNote:(NSString *) note{
    NSError *err;
    NSString *path = [[NSBundle mainBundle] pathForResource:note ofType:@"aiff"];
    AVAudioPlayer *p = [[AVAudioPlayer alloc ] initWithContentsOfURL:[NSURL fileURLWithPath:path] error:&err];
    p.delegate = self;
    if (err) {
        NSLog(@"%@", err);
    }else{
        [p prepareToPlay];
        [p play];
    }
}

- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag
{
    [player release];
} 
```

我用 Instruments 测试过，没有任何内存泄漏。如果有人能想到避免这个错误，我们将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T17:26:36.403

我遇到了类似的问题。

我花了很长时间试图解决这个问题，我认为我的特定问题发生在以下情况：

1.  我所在的 AudioCategory 不允许在静音开关打开时播放声音。
2.  我开始播放声音（我实际上并没有在应用程序中这样做，但这是我可以可靠再现的方式）。
3.  在声音仍在播放的情况下，我切换到另一个在静音开关打开时不允许播放声音的 AudioCategory。

从这一点开始，我从 AudioSession API 中调用的各个点中得到“发布消息以杀死 mediaserverd”。应用程序挂起，设备挂起，我努力让设备恢复正常运行状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T19:08:13.127

根据[此消息](https://devforums.apple.com/message/583670#583670) **，它是设备的静音开关。**

> 事实证明，通过设备的物理开关将 iPad 静音是导致我的应用出现问题的原因。只要按钮没有打开，问题就不会发生。

嘘。如何以编程方式覆盖？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T03:23:25.570

我使用 SoundBankPlayer 而不是 AVAudioPlayer “解决”了这个问题。[SoundBanker 信息](http://www.hollance.com/2011/02/soundbankplayer-using-openal-to-play-musical-instruments-in-your-ios-app/)。

# c# - 我真的想返回最短日期吗？

> ID：10952470
> 
> 赞同：21
> 
> 时间：2012-06-08T16:15:18.660
> 
> 标签：c#, datetime, resharper, default-value

一位老同事曾经引用他父亲关于工具的话说，“你必须比它更聪明。”

在下面的代码中，Resharper 告诉我，“分配的值不用于任何执行路径”（指向第一行）。如果我接受它的帮助，则不会为 dt 分配值（“今天”）。

这是“我必须比它更聪明”并忽略他们的警告的情况，还是工具比我更聪明的情况，而我只是不理解它？

我对这种情况的看法是，如果 if 语句失败，则返回当前日期（我想要的默认值），但如果我默认 Resharper 的“要求”，它将返回 Datetime 的默认值，即最小日期，我假设是 7/4/1776 或 1/1/0000 左右。

```
DateTime dt = DateTime.Now;
if (!(DateTime.TryParse(substr, out dt))) {
    using (var dtpDlgForm = new ReturnDate("Please select the Date that the file was created:")) {
        if (dtpDlgForm.ShowDialog() == DialogResult.OK) {
            dt = dtpDlgForm.ReturnVal;
        } 
    }
}
return dt; 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-06-08T16:17:22.140

您接受的答案显示了您*应*该做什么，但没有解释*为什么*Resharper 首先抱怨。由于此解释可能对发现您的问题的其他人有用，因此这里是：

您*应该*遵循 Resharper 的建议并将第一行更改为：

```
DateTime dt; 
```

这声明了变量`dt`，但没有为其分配任何值。这里不需要赋值，因为[`out`关键字](http://msdn.microsoft.com/en-us/library/ee332485.aspx)肯定会在下一行赋值。从文档中：

> 尽管作为`out`参数传递的变量在传递之前不必初始化，**但被调用的方法需要在方法返回之前赋值**。

强调我的。分配该值`DateTime.Now`是不必要且具有误导性的，因为永远不会使用该值。

> 我对这种情况的看法是，如果 if 语句失败，则返回当前日期

这不是您的代码所做的。从[文档](http://msdn.microsoft.com/en-us/library/ch92fbc1.aspx)中：

> result：当此方法返回时，如果转换成功，则包含与 s 中包含的日期和时间等效的 DateTime 值，如果**转换失败，则包含 MinValue。**

如果解析失败，则使用您发布的代码`dt`将包含该值`DateTime.MinValue`而不是`DateTime.Now`您分配的值。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-06-08T16:19:30.867

您的*预期*逻辑允许三个可能的返回值`DateTime`（按优先顺序）：

1.  的解析值`substr`。
2.  从对话框中选择的值。
3.  当前日期和时间。

`return`您可以通过在条件成功时执行单独的语句来实现此逻辑：

```
DateTime dt;
if (DateTime.TryParse(substr, out dt))
    return dt;

using (var dtpDlgForm = new ReturnDate(
    "Please select the Date that the file was created:")) 
{
    if (dtpDlgForm.ShowDialog() == DialogResult.OK)
        return dtpDlgForm.ReturnVal;
}

return DateTime.Now; 
```

**编辑**：有关为什么不应将值分配给将用作`out`参数的变量的解释，请参阅[Mark Byers 的答案](https://stackoverflow.com/a/10952501/1149773)。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-06-08T16:19:21.813

这是因为您正在为 dt 分配一个值，然后将其作为[out param](http://msdn.microsoft.com/en-us/library/t3c3bfhx%28v=VS.71%29.aspx)传递。如果变量作为输出参数传入：

*   必须先在该函数内分配一个值，然后才能在其中使用
*   必须在该函数返回之前为其赋值

在您的情况下，您可以通过将第一行更改为：

```
DateTime dt; 
```

> 我对这种情况的看法是，如果 if 语句失败，则返回当前日期

这不是真的。无论您传入的 DateTime 对象的值如何，它都将始终返回[DateTime.MinValue 。](http://msdn.microsoft.com/en-us/library/system.datetime.minvalue.aspx)

从[MSDN - DateTime.TryParse(string, out DateTime)](http://msdn.microsoft.com/en-us/library/ch92fbc1.aspx)：

> *结果*
> 
> 类型：System.DateTime%
> 
> **当此方法返回时，如果转换成功，[result] 包含**与 s 中包含的日期和时间等效的 DateTime 值，如果**转换失败，则包含****[MinValue](http://msdn.microsoft.com/en-us/library/system.datetime.minvalue.aspx)**。如果 s 参数为空、为空字符串 ("") 或不包含日期和时间的有效字符串表示形式，则转换失败。此参数未初始化传递。

（重点补充）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-08T16:19:59.397

`out`参数始终具有分配给它的值。始终保证被调用函数在返回之前为其分配一个值。因此，无论如何它都会覆盖最初分配的值。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-06-08T16:20:41.363

这里的重点是使用[out 参数修饰符](http://msdn.microsoft.com/en-us/library/ee332485.aspx)：

> 尽管作为输出参数传递的变量在传递之前不必初始化，但被调用的方法需要在方法返回之前分配一个值。

`DateTime.TryParse`无论如何都会分配一个默认值`dt`，如果它无法解析`substr`，则结果`dt`将具有最小日期时间的值。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-08T16:21:33.363

```
DateTime.TryParse(substr, out dt); 
```

可以返回 false 但仍会修改`dt`. 它将`dt`尽其所能完成，尽可能地初始化一些值。在 c# 中使用`out`修饰符时，您是在告诉程序对其进行初始化，并且您不应期望保留传入的值。

你能做的是

```
DateTime dt;
if (!(DateTime.TryParse(substr, out dt))) {
    using (var dtpDlgForm = new ReturnDate("Please select the Date that the file was created:")) {
        if (dtpDlgForm.ShowDialog() == DialogResult.OK) {
            dt = dtpDlgForm.ReturnVal;
        } 
        else {
            dt = DateTime.Now;
        }
    }
}

return dt; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-06-08T17:58:03.197

此代码将使警告消失。但我认为道格拉斯的答案更容易阅读。

```
DateTime dt;
if (!(DateTime.TryParse(substr, out dt))) {
    dt = DateTime.Now;
    using (var dtpDlgForm = new ReturnDate("Please select the Date that the file was created:")) {
        if (dtpDlgForm.ShowDialog() == DialogResult.OK) {
            dt = dtpDlgForm.ReturnVal;
        } 
    }
}
return dt; 
```

# scala - 如何在 Lift 中更改表单的操作

> ID：10952482
> 
> 赞同：2
> 
> 时间：2012-06-08T16:15:58.647
> 
> 标签：scala, lift

我正在构建一个 Lift 应用程序，其中一个页面基于 Lift 演示中的“文件上传”示例，网址为：http: [//demo.liftweb.net/file_upload](http://demo.liftweb.net/file_upload)。

如果您查看[该页面的源代码](https://github.com/lift/examples/blob/master/combo/example/src/main/webapp/file_upload.html)......您会看到有一个 Lift“snippet”标签，围绕着两个“choose”标签：

```
<lift:snippet type="misc:upload" form="post" multipart="true">

<choose:post>
<p>
File name: <ul:file_name></ul:file_name><br >
MIME Type: <ul:mime_type></ul:mime_type><br >
File length: <ul:length></ul:length><br >
MD5 Hash: <ul:md5></ul:md5><br >
</p>
</choose:post>

<choose:get>
Select a file to upload: <ul:file_upload></ul:file_upload><br >
<input type="submit" value="Upload File">
</choose:get>

</lift:snippet> 
```

这个想法是，当用户第一次点击页面（即 GET 请求）时，Lift 将显示用于上传文件的表单。当用户提交表单（即对同一页面的 POST 请求）时，Lift 会显示正在处理的文件的结果。

对于我的应用程序，新的问题是我的“结果”POST 视图**还**需要包含一个表单。我想为用户提供一个文本输入以输入电子邮件地址，以及一个提交按钮，按下该按钮将通过电子邮件发送有关已处理文件的信息：

```
...
<choose:post>
<p>
File name: <ul:file_name></ul:file_name><br >
MIME Type: <ul:mime_type></ul:mime_type><br >
File length: <ul:length></ul:length><br >
MD5 Hash: <ul:md5></ul:md5><br >
</p>

<!-- BEGIN NEW STUFF -->
Output: <br/>
<textarea rows="30" cols="100"><ul:output></ul:output></textarea>
<br/><br/>
Email the above output to this email address:<br/>
<ul:email/><br/>
<input type="submit" value="Email"/>
<!-- END NEW STUFF -->

</choose:post>
... 
```

但是，此页面的 GET 和 POST 版本都由同一个 Lift 生成的表单包装，在这两种情况下，它的“操作”设置为相同的代码段。如何更改此设置，以便在 POST 版本中，表单的操作更改为不同的代码段？

在一个典型的 Web 框架中，我会使用“onclick”事件和两行基本的 JavaScript 来处理这样的事情。然而，我什至还没有开始思考 Lift 的……呃，关于在 Scala 中编写 JavaScript 的有趣概念。也许我需要走那条路，或者也许有更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T16:50:38.770

首先，我建议您使用 Lift 的新设计友好 CSS 绑定而不是自定义 XHTML 标记。

当您使用 Lift 的代码片段时，您应该记住的一件事是它是递归的，您可以将提升代码片段放在另一个代码片段的 HTML 块中。

例如，如果您希望在 POST 之后有另一个表单，那么只需将其放入块中。

```
<choose:post>
<p>
File name: <ul:file_name></ul:file_name><br >
MIME Type: <ul:mime_type></ul:mime_type><br >
File length: <ul:length></ul:length><br >
MD5 Hash: <ul:md5></ul:md5><br >
</p>
<!-- 
    The following is same as <lift:snippet type="EMailForm" form="post" multipart="true"> 
-->
<form action="" method="post" data-lift="EMailForm">
    <input type="text" name="email"/>
    <input type="submit" />
</form>
</choose:post> 
```

然后处理片段类 EMailForm 中的电子邮件表单操作。

最后，您可以使用隐藏的表单元素或 SessionVar 传递文件名/矿工类型和其他信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-10T10:40:00.710

我同意 Brian 的观点，使用 Lift 的新设计师友好的 CSS 绑定。

使用两种单独的表格，一种用于文件上传，另一种用于提交电子邮件。当第一个表单完成处理后，使用 S.seeOther 将用户重定向到第二个表单。

我也更喜欢新的 'data-lift' HTML 属性。

文件上传 HTML：

```
<div data-lift="uploadSnippet?form=post">
    <input type="file" id="filename" />
    <input type="submit" id="submit" />
</div 
```

文件上传片段：

```
class uploadSnippet {
    def processUpload = {
        // do your processing
        ....
        if (success)
            S.seeOther("/getemail")

        // if processing fails, just allow this method to exit to re-render your 
        // file upload form
    }

    def render = {
        "#filename" #> SHtml.fileUpload(...) &
        "#submit" #> SHtml.submit("Upload", processUpload _ )
    }
} 
```

获取电子邮件 HTML：

```
<div data-lift="getEmailSnippet?form=post">
    <input type="text" id="email" />
    <input type="submit" id="submit" />
</div 
```

获取电子邮件片段：

```
class getEmailSnippet {
    def processSubmit = {
       ....
    }

    def render = {
        "#email" #> SHtml.text(...) &
        "#submit" #> SHtml.submit("Upload", processSubmit _ )
    } 
```

在我关于使用 RequestVar 的博客文章中有更多关于表单处理的内容：http: [//tech.damianhelme.com/understanding-lifts-requestvars](http://tech.damianhelme.com/understanding-lifts-requestvars)

如果您想要更多详细信息，请告诉我。

希望这有用

干杯

达米安

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T20:22:33.053

如果有人在接下来的几天内提出更优雅（或“Lift-y”）的方法，那么我会接受他们的回答。但是，我自己想出了一个解决方法。

我保留了当前布局，其中视图有一个 GET 块和一个 POST 块都提交到相同的片段函数。片段函数仍然有一个`if-else`块，根据它是 GET 还是 POST 以不同方式处理每个请求。

但是，现在我在 POST`if-else`块*内也有一个辅助块。*此内部`if-else`查看单击的提交按钮的名称。如果提交按钮是用于上传文件的按钮，那么代码片段将处理文件的上传和处理。否则，如果它是在第一个 POST 之后显示的发送电子邮件提交按钮，则代码段会处理电子邮件的发送。

不是特别迷人，但效果很好。

# php - 使用 PHP 的 mcrypt 解密 AES

> ID：10952483
> 
> 赞同：1
> 
> 时间：2012-06-08T16:16:09.250
> 
> 标签：php, openssl, aes, rijndael

简短的问题：我使用 openssl 命令行工具使用 AES-256 加密了一个字符串。如何使用 PHP 的 openssl 库解密？（由于 Rijndael-256 和 AES-256 不一样，没有 AES-256 选项）

在此先感谢，乔里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:49:54.617

您应该使用`MCRYPT_RIJNDAEL_128`而不是，`MCRYPT_RIJNDAEL_256`但您应该使用 256 位密钥，最好是您用来加密数据的那个。

X in`MCRYPT_RIJNDAEL_X`是密码的*块大小*。Rijndael 有多种块和密钥大小，但只有块大小为 128 位和密钥大小为 128、192 或 256 位（以及密钥大小特定向量和轮数）的 Rijndael 应称为 AES。

确保您还匹配加密模式（不安全的 ECB 或 CBC 编码）并确保您的（未）填充是正确的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-08T16:31:28.423

只要解密AES-256，使用任何例程解密不应该是可以接受的吗？

试试这个，以前在 stackoverflow 上看到过......它只是一个谷歌...... [PHP AES 加密/解密](https://stackoverflow.com/questions/3422759/php-aes-encrypt-decrypt)

# django - django 测试套件的 Postgres 特定性能提示

> ID：10952485
> 
> 赞同：3
> 
> 时间：2012-06-08T16:16:12.687
> 
> 标签：django, postgresql, testing

我通常在内存中的 SQLite3 DB 上运行我的测试套件。但是，我有一些项目绝对需要 postgres 并使用 SQLite3 引发异常。在这些情况下，我该如何提高速度？

我有一个测试配置，在 sqlite 中运行 2.97 秒，而在 postgres 中运行 89.71 秒。我的意思是这太疯狂了。

我在 postgres 中关闭了 fsync - 这让我从 101.59s 到 89.71s。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:06:58.093

您的服务器配置肯定会对这个速度产生影响，关闭 fsync 将使表创建速度更快，这是初始启动成本的很大一部分。

另一部分是 Django 如何处理固定装置，如果您有大量固定装置，这可能会严重影响性能。Django 为每个测试方法（不是每个测试类）加载固定装置并回滚事务。有一个第三方应用程序[django-fasttest](https://github.com/machinalis/django-fasttest)在夹具加载后使用保存点来优化此加载。[django-nose](https://github.com/jbalogh/django-nose)对重用以前创建的数据库和夹具捆绑有类似的优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:00:01.263

你目前的配置是什么？也检查[维基](http://wiki.postgresql.org/wiki/Tuning_Your_PostgreSQL_Server)。

并开始记录慢查询以找出真正的问题。

# ruby-on-rails - Rails 迁移错误 database_authenticable

> ID：10952486
> 
> 赞同：0
> 
> 时间：2012-06-08T16:16:12.540
> 
> 标签：ruby-on-rails, database-migration

-- create_table(:admin_users) rake 中止！发生错误，此迁移和所有后续迁移均已取消：

未定义的方法 `database_authenticable' for #

任务：TOP => db:migrate 如何解决？谢谢！

移民

```
create_table(:admin_users) do |t|
      t.database_authenticatable :null => false
      t.recoverable
      t.rememberable
      t.trackable
      t.timestamps
end 
```

在 gemfile 中拥有所有 gem 并安装

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:44:09.163

确保您已在 Gemfile 中设计并安装了捆绑包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:07:46.260

答案是简单的设备团队很烂！！！为了解决这个需求，在 GEMFILE gem 'devise', "~> 1.5" 中做 cnanges

因为在 1.5 中支持 database_authenticable 类型，而在 2.1.0 中仅支持兼容性而不是创建具有此类型的字段，谢谢大家。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-08T11:38:10.907

如果您刚刚开始使用设计（而不是从以前的版本更新），您可能在做之前错过了以下步骤`rake db:migrate`

```
rails generate devise:install 
```

这创造了

```
create  config/initializers/devise.rb
create  config/locales/devise.en.yml 
```

它定义了上面抱怨的方法 rake 。

来源： [https ://github.com/plataformatec/devise](https://github.com/plataformatec/devise)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:48:17.590

[使用 Devise 2.0 和更新版本，迁移辅助方法（例如t.database_authenticable](https://github.com/plataformatec/devise/wiki/How-To%3a-change-an-already-existing-table-to-add-devise-required-columns)）不可用（如 wiki 上所述）如果您正在为用户制作新模型，只需使用 devise 迁移生成器，如下所示：

```
rails g devise admin_users (If you're installing devise on your app) 
```

如果您将必填字段添加到现有用户模型，您应该[在设计 wiki 上查看此页面](https://github.com/plataformatec/devise/wiki/How-To%3a-Upgrade-to-Devise-2.0-migration-schema-style)。

查看 devise 的[主要 README](https://github.com/plataformatec/devise)，其中包含有关在 Rails 上安装最新版本的 devise 的最新信息。

# tfs - 基于先前的构建在 TFS 中执行构建

> ID：10952489
> 
> 赞同：1
> 
> 时间：2012-06-08T16:16:27.573
> 
> 标签：tfs

我们使用 TFS 来遵循一个非常标准的敏捷构建过程：

1.  Nightly 从最新的源代码构建
2.  每 2 周构建到登台服务器
3.  每 4 周构建到生产服务器

我在 TFS 中设置了 1 和 2 并且工作得很好。但是，我在#3 上有点挣扎。如果我只是设置一个“正常”构建，它将提取最新的源代码并使用它来推送到生产服务器。但我真正想要的是将代码从第 2 步移到生产服务器，因为它已经过 QA 团队的审查。

我考虑过使用 XCopy 或类似的东西做一个自定义构建模板，但问题是如何更新配置字符串。

我正在关注这篇文章，这似乎正是我想要的，[http://www.asp.net/web-forms/tutorials/deployment/configuring-team-foundation-server-for-web-deployment/deploying-a -specific-build](http://www.asp.net/web-forms/tutorials/deployment/configuring-team-foundation-server-for-web-deployment/deploying-a-specific-build)，但它不起作用。

你们都是如何做到这一点的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T16:28:27.463

所以这是实现 3 的一种稍微简单的方法。如果你已经实现了 2。

让您的生产构建定义保持原样。但是，要编译与步骤 2 中用于编译暂存构建的相同变更集（现已由 QA 审查），当您将产品构建排队时，然后在参数选项卡上展开高级部分并找到“获取版本”属性如下所示。

![在此处输入图像描述](../Images/eea2bdd26a06063b362a48864f1324a1.png)

在这里，您可以指定用于在步骤 2 中构建您的构建的相同 TFS 变更集。假设此变更集是数字 84，您将编写（完全正确）

C84

如果您编译标签，那么对于名为“For build xyz”的标签，您指定

LFor 构建 xyz

请注意，上面的“C”和“L”是故意的。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:35:28.703

我们有一个不同的生产分支，代码只有在通过问答后才会合并到生产分支。

这使我们可以在生产分支上直接对生产代码进行热修复（这些更改最终将反向集成到 main 然后 dev 中），同时在开发分支上继续开发。

一旦开发分支中的代码准备好进行问答，它就会被合并到主干中。

CI 和夜间构建在开发分支上完成 - 不同之处在于夜间构建具有更全面的自动化测试

# devexpress - AspxGridView：如何减少编辑表单中的列间距？

> ID：10952492
> 
> 赞同：0
> 
> 时间：2012-06-08T16:16:34.207
> 
> 标签：devexpress

我正在使用 DevExpress v 2010.2。我有一个带有 AspxGridView 网格控件的 ASP.NET Web 应用程序。我的编辑表单存在以下问题：其列之间的空间（控件位于 2 列中）太大。

我可以以某种方式减少间距吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T17:25:34.663

使用[此](http://www.devexpress.com/Support/Center/p/Q406165.aspx)DX 知识库文章中的建议来完成此任务。

# ruby - 检测从文档中提取的文本中的“噪声”

> ID：10952494
> 
> 赞同：1
> 
> 时间：2012-06-08T16:16:37.070
> 
> 标签：ruby, text, text-processing

*   我正在从 PDF 文档中检索可读内容（即文本），其中大部分是科学期刊文章。
*   我正在使用 Poppler 文本实用程序将 PDF 转换为文本格式。
*   文本提取得很好，但不幸的是，文章的其他组成部分（例如数字表）也是如此，无法以纯文本正确呈现。
*   例如，我可能会在文章中间得到以下输出：

    字符分布随机 Hmax

    1 2 3 4

    组织 c) （特征超过物种的）

    一个

    乙

    A 0 0 0 + C

    B + + + +

    C + + + + A

    乙 4+

    H 字符分布非随机 Hobs

    熵

    3+ 2+ 1+

    （物种的特征多样性

我的问题是：我将如何识别这种“噪音”并将其与正常的文本块区分开来？有没有现成的算法？我正在使用 Ruby，但任何语言的代码都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T01:54:14.287

您可以使用**朴素贝叶斯分类**器对有效线与无效线进行建模。

[这是一篇关于 Ruby 的文章](http://blog.saush.com/2009/02/11/naive-bayesian-classifiers-and-ruby/)；Python 的[nltk](http://nltk.org)中有一个很好的实现。

要设置它，您需要给它一些示例，例如，用好的行填充一个文件，用坏的行填充一个文件。这与垃圾邮件过滤器使用的模型相同。

这个用例的一个技巧是，许多基本的朴素贝叶斯分类器使用单词出现模型来表示特征，而在这里重要的不是词汇表。您可以使用行长、空格百分比（四舍五入到 5% 或 10% 间隔）或各种标点符号的百分比（四舍五入但精度更高）。希望您的分类器能够了解到“没有句点和 30% 空格的行是不好的”或“没有标点符号且每个单词都以大写字母开头的行是不好的”。

但是，仅根据上面的示例，您可能会拒绝任何空格比例过高或完全没有句子标点符号（例如逗号和句点）的行。

# zend-framework - Zend_Rest_Client 是否支持传统的对象 API 工作，例如 PUT 对象、GET 和对象、POST 对象

> ID：10952498
> 
> 赞同：0
> 
> 时间：2012-06-08T16:17:00.900
> 
> 标签：zend-framework, rest, zend-rest, zend-rest-route

我想知道我们是否可以使用 Zend Framework 来支持 REST API？

Zend_Rest_Client 是否支持传统的对象 API 工作，例如

PUT 一个对象，GET 和对象，POST 一个对象

我见过的大多数 REST API 大多是面向对象管理的，而不是服务或方法。

帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T12:00:58.310

这是参考手册的摘录，希望能回答您的问题。（简短的回答是肯定的。）

> 24.5.7.6。Zend_Rest_Route Zend_Rest 组件包含一个用于 Zend_Controller_Router_Rewrite 的 RESTful 路由。此路由提供了一个标准化的路由方案，通过将 HTTP 方法和 URI 转换为模块、控制器和操作来路由请求。下表概述了请求方法和 URI 的路由方式。
> 
> 表 24.1。Zend_Rest_Route 行为

```
Method URI Module_Controller::action 
GET /product/ratings/ Product_RatingsController::indexAction() 
GET /product/ratings/:id Product_RatingsController::getAction() 
POST /product/ratings Product_RatingsController::postAction() 
PUT /product/ratings/:id Product_RatingsController::putAction() 
DELETE /product/ratings/:id Product_RatingsController::deleteAction()  
POST /product/ratings/:id?_method=PUT Product_RatingsController::putAction() 
POST /product/ratings/:id?_method=DELETE Product_RatingsController::deleteAction() 
```

并来自[Zend_Rest_Client API](http://framework.zend.com/apidoc/1.11/)

```
restDelete( string $path,  $data = null ) : \Zend_Http_Response
Performs an HTTP DELETE request to $path.

restGet( string $path, array $query = null ) : \Zend_Http_Response
Performs an HTTP GET request to the $path.

restPost( string $path, mixed $data = null ) : \Zend_Http_Response
Performs an HTTP POST request to $path.

restPut( string $path, mixed $data = null ) : \Zend_Http_Response
Performs an HTTP PUT request to $path. 
```

# bash - 如何配置 bash 以打印 utf8 错误消息？

> ID：10952505
> 
> 赞同：1
> 
> 时间：2012-06-08T16:17:40.690
> 
> 标签：bash, utf-8, freebsd

bash 中奇怪的 UTF-8 处理。

```
$ á
bash: $'\303\241': command not found 
```

当运行 tcsh 时，所以

```
$ tcsh   #or exec tcsh
> á
á: Command not found. 
```

有什么问题？如何为 utf8 正确设置 bash？

^(在将此问题标记为重复之前，请阅读下一个：)

我的`.inputrc`：

```
set meta-flag on
set input-meta on
set output-meta on
set convert-meta off

set show-all-if-ambiguous On

"\e[A": history-search-backward
"\e[B": history-search-forward

set -o vi 
```

我的环境：

```
LOCALE=UTF-8;           export LOCALE
LESSCHARSET='utf-8';    export LESSCHARSET
LANG=en_US.UTF-8;       export LANG
LC_ALL=en_US.UTF-8;     export LC_ALL 
```

IMO，我已经完成了在 bash 中处理 utf8 必须做的所有事情。

bash 版本：

```
bash --version
GNU bash, version 4.2.28(0)-release (amd64-portbld-freebsd9.0) 
```

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:59:36.023

这是 Bash 4.2 中的新功能。看到[这个](http://old.nabble.com/UTF8-conversion-issues-in-bash-4.2-td31367363.html)。

> 如果 isprint() 对字符串中的任何字符失败，bash-4.2 中有一个更改，它使用 ANSI-C 转义符在错误消息中打印字符。它旨在使文件名中的 \r 等内容可见。它来自 cygwin，但通常很有用。
> 
> 切特

Chet Ramey 是 Bash 的维护者。

# jqgrid - jqGrid：当editurl无效时，navGrid reloadAfterSubmit不会添加新行

> ID：10952506
> 
> 赞同：1
> 
> 时间：2012-06-08T16:17:41.243
> 
> 标签：jqgrid

我正在尝试测试在 jqGrid 中添加新行和删除行，我发现网格在添加/删除行后不会刷新以显示新行或删除已删除的行。服务器端部分还没有用于添加/删除，所以我只是提供了与我用来将数据加载到网格中相同的 url 的 editurl。

```
.navGrid('#' + id + '-pager',
            {addtext: 'Add Code Value', deltext: 'Delete Code Value', edit:false,add:true,del:true,search:false, refresh:false},
            {closeAfterAdd: true, reloadAfterSubmit: true} /* Edit options */,
            {closeAfterAdd: true, reloadAfterSubmit: true} /* Add options */,
            {reloadAfterSubmit: true} /* Delete options */); 
```

我在这里错过了什么吗？我认为 reloadAfterSubmit 应该使用添加/删除的行更新网格？

谢谢。

**编辑**：我的自定义添加功能，这是不必要的复杂是（注意：这应该只是客户端添加）

```
addfunc = function() {
//Find dirty unsaved row if any and add to the grid before adding empty row

                var dirtyRow = jQuery('#' + id).find('tr[editable]');
                var dirtyRowId = dirtyRow.attr('id');
                if (dirtyRow.length > 0) {
                    dirtyRow.addClass('data-isDirty', true);
                    var rowData = jQuery('#' + id).jqGrid('getRowData', dirtyRowId);
                    jQuery('#' + id).jqGrid('addRowData', rowId, dirtyRowId);
              //The row when added to the grid should not be editable but a normal row

                dirtyRow.find('input').each(function() {
                        var text = jQuery(this).attr('value');
                        jQuery(this).replaceWith(text);
                    });
                }
                var rowId = Math.floor(Math.random()*1000) + 'add_new';
                jQuery('#' + id).jqGrid('addRowData', rowId, that.getEmptyRow(colModel), 'first');
                var firstRowId = jQuery('#' + id).jqGrid('getDataIDs')[0];

                            //Add an empty editable row at the top
                jQuery('#' + id).jqGrid('editRow', firstRowId);
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:15:30.537

如果您使用*虚拟*URL，那么它可能不会响应 HTTP POST 请求。`mtype: "GET"`您可以通过使用选项来解决问题。在这种情况下，您可以使用来自同一站点的任何现有服务器 URL，例如`"/"`：

```
.navGrid('#' + id + '-pager',
    {addtext: 'Add Code Value', deltext: 'Delete Code Value',
        edit:false,add:true,del:true,search:false, refresh:false},
    {mtype: "GET", closeAfterAdd: true, reloadAfterSubmit: true} /* Edit options */,
    {mtype: "GET", closeAfterAdd: true, reloadAfterSubmit: true} /* Add options */,
    {mtype: "GET", reloadAfterSubmit: true} /* Delete options */); 
```

作为`editurl`jqGrid 的参数，您可以使用任何现有的 URL，例如`editurl: "/"`

# python - os.environ['foo'] 什么时候不匹配 os.getenv('foo')？

> ID：10952507
> 
> 赞同：38
> 
> 时间：2012-06-08T16:17:47.083
> 
> 标签：python, windows, environment-variables, freebsd

我有一个小型 Python 应用程序，通过 启动`subprocess.Popen`，它以环境变量的形式接受一些参数。我通过将环境结构传递给`Popen`调用来做到这一点。然后程序通过 读取变量`os.getenv`。

或者更确切地说，它曾经以这种方式阅读它们。在 Windows 上，它运行良好。但是在我们的 FreeBSD 服务器上，`os.getenv`返回`None`我们传入的所有参数。奇怪的是，`os.environ`它的值很好——事实上，只需将所有`os.getenv('foo')`调用切换到*两个*平台`os.environ['foo']`上都可以正常工作。

 *为什么这些值不同？什么时候一个比另一个合适？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-08T17:06:50.367

`os.environ`在导入`os`模块时创建，除非直接修改，否则不会反映之后发生的环境更改。然而，有趣的是，`os.getenv()`实际上也没有获得最新的环境变量，至少在 CPython 中没有。你看，在 CPython 中，`os.getenv()`显然只是一个包装器`os.environ.get()`（参见[http://hg.python.org/cpython/file/6671c5039e15/Lib/os.py#l646](http://hg.python.org/cpython/file/6671c5039e15/Lib/os.py#l646)）。因此，使用所述实现的主要原因似乎是，当您希望在的键`os.getenv()`中找不到环境变量名称时返回默认值，而不是抛出 a 或其他任何东西，并且您想保存一些人物。`os.environ``KeyError`

完全有可能 FreeBSD 上的实现有一些奇怪的噱头导致它的行为不同，但我不确定为什么会这样。`os.py`如果可以，请查看您使用的一台 FreeBSD 机器上的副本。*

# google-chrome-extension - 如何以编程方式从指定域的 chrome 扩展中删除所有本地存储

> ID：10952513
> 
> 赞同：5
> 
> 时间：2012-06-08T16:18:06.877
> 
> 标签：google-chrome-extension

我想用我的 chrome 扩展删除指定域的所有 localStorage

当我打开 google chrome 时，我可以通过设置 -> 所有 cookie 将其删除，然后通过域名找到本地存储，然后手动将其删除。

这是我得到的：

```
server.myserver.test.com

Local Storage

Source: https://server.myserver.test.com
Disk Size:  5,0 KB
Last modification:  Saturday... 
```

假设我有权访问指定服务器的 cookie，我需要在我的 chrome 扩展程序中执行此操作。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-18T18:56:53.647

我认为您可以为该特定域运行内容脚本并通过调用删除本地存储数据：

```
localStorage.clear(); 
```

Chrome Cookies API 仅删除 cookie。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-31T06:53:04.573

使用以下功能

```
 chrome.storage.local.clear() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-10T09:56:04.750

您可以从油脂猴子运行用户脚本..并使用..清除所有 localStorage 元素

```
// ==UserScript==
// @name        clearLocalStorage
// @namespace   stackoverflow.com
// @include     http://stackoverflow.com/
// @version     1
// ==/UserScript==
localStorage.clear(); 
```

# python - telnetlib python 示例

> ID：10952514
> 
> 赞同：16
> 
> 时间：2012-06-08T16:18:09.657
> 
> 标签：python, telnetlib, python-2.4

所以我正在尝试python文档给出的这个非常简单的例子：

```
import getpass
import sys
import telnetlib

HOST = "<HOST_IP>"
user = raw_input("Enter your remote account: ")
password = getpass.getpass()

tn = telnetlib.Telnet(HOST)

tn.read_until("login: ")
tn.write(user + "\n")
if password:
   tn.read_until("Password: ")
   tn.write(password + "\n")

tn.write("ls\n")
tn.write("exit\n")
print tn.read_all() 
```

我的问题是它挂在 read_all() 的末尾......它没有打印出任何东西。我以前从未使用过这个模块，所以我试图让这个非常基本的例子在继续之前工作。顺便说一句，我正在使用 python 2.4 谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-08T16:37:04.060

好的，我找到了解决方案。在输入 ls 并退出之前，我需要先指定终端类型。添加

```
tn.write("vt100\n") 
```

在“ls”为我解决问题之前。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-29T11:18:19.590

如果您使用的是 Windows，请务必`\r`在换行符之前添加回车 ( )：

```
tn.write(user.encode('ascii') + "\r\n".encode('ascii')) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-03-15T11:48:05.063

我知道这是迟到了，但可能会帮助其他人。我也很难做到这一点，但这是我的一段代码。我的 telnet 会遵循某些流程，就像它要求的那样，`loginID`然后`Password`您必须等待此处显示特定的字符串，就我而言，`"DB>"`您可以继续执行命令和所有操作。我的输出将保存在`"out"`变量中

```
import os,re,telnetlib
host = "10.xxx.xxx.xxx"
port = 23

telnet = telnetlib.Telnet()
telnet.open(host, port)
telnet.write('loginID\r\n')
telnet.write('Password\r\n')
out = telnet.read_until("DB>", 5)
telnet.write('show cable modem reg\r\n') #Mycommand
out = telnet.read_until("DB>", 5)
telnet.write('quit\r\n')
telnet.close() 
```

如需更多变化和帮助，请查看网站[nullege](http://nullege.com/codes/search/telnetlib.Telnet.open)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-08T16:41:57.560

我没有要测试的 telnet 服务器，但我认为问题在于，在您编写的每个命令之后，您都没有在提示符下读取服务器响应。

```
PROMPT = ':~$'
tn = telnetlib.Telnet(HOST)
tn.read_until('login: ')
tn.write(user + '\n')
if password:
   tn.read_until('Password: ')
   tn.write(password + '\n')
tn.read_until(PROMPT)
tn.write('ls\n')
print tn.read_until(PROMPT)
tn.write('exit\n') 
```

顺便说一句，telnetnetlib 可能很棘手，并且取决于您的 FTP 服务器和环境设置。您最好研究一下[pexpect 之](http://pexpect.sourceforge.net/pexpect.html)类的东西，以通过 telnet 自动登录和用户交互。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-13T02:22:17.870

我挣扎了一段时间试图写入 SynAccess 电源板。我是这样做的：

```
import sys
import telnetlib
HOST = < your SynAccess switch ip address >
user = < user name >
password = < password >

tn = telnetlib.Telnet(HOST, 23, 5)
tn.write("login\r\n")
tn.write(user + "\r\n")
tn.write(password + "\r\n")
tn.write("rb 3\r\n") # this reboots plug 3
tn.write("rb 1\r\n") # this reboots plug 1
tn.write("logout\r\n")
tn.close 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-30T04:50:02.173

使用 python 2.7 或在最后一行使用带有“（”，“）”的更高版本

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-09T18:48:41.420

如果这些答案都不起作用，您也可以尝试：

```
 tn.read_until(b"Password: ")
 tn.write(password.encode('utf-8') + b"\n")
 tn.read_until(b"Terminal type?", 5)
 tn.write("vt100\n".encode('utf-8'))
 tn.read_until(b">", 5) 
```

尽管我从未见过打印终端类型的实际请求，但这篇文章似乎有效。

# ubuntu - c/c++ syslog 到自定义文件（不是 /var/log/syslog 而是 /var/log/mylog） - ubuntu 12.04

> ID：10952515
> 
> 赞同：6
> 
> 时间：2012-06-08T16:18:16.927
> 
> 标签：ubuntu, syslog

我在 ubuntu 12.04 上成功测试了以下系统日志“hello world”示例：

```
// gcc giuspexample.c -o giuspexample

#include <syslog.h>

int  main()
{
    setlogmask(LOG_UPTO (LOG_NOTICE));

    openlog("atm", LOG_CONS | LOG_PID | LOG_NDELAY, LOG_LOCAL0);

    syslog(LOG_NOTICE, "Program started by User %d", getuid ());
    syslog(LOG_INFO, "A tree falls in a forest");

    closelog();
    return 0;
} 
```

我可以阅读 /var/log/syslog 中的条目。我按照[http://www.codealias.info/technotes/syslog_simple_example](http://www.codealias.info/technotes/syslog_simple_example)关于如何更改目标文件路径的说明进行操作

```
echo "local0.*  /var/log/mylog" >> /etc/syslog.conf 
```

但试图跑

```
sudo /etc/init.d/syslog restart 
```

不起作用（找不到命令）并且无论如何重新启动电脑都不会开始在 /var/log/mylog 上写入，但仍在 /var/log/syslog 上。有人知道出了什么问题吗？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-12T08:50:03.063

在`/etc/rsyslog.d`目录中，有两个文件：

1.  `20-ufw.conf`
2.  `50-default.conf`

我添加了`/etc/rsyslog.d/30-mycustomname.conf`带有`sudo nano`以下内容的文件：

```
# Log QSD Centro generated log messages to file
if $programname == 'centro' then /var/log/centro.log
# Uncomment the following to stop logging anything that matches the last rule.
& ~ 
```

然后我检查文件`/var/log/centro.log`不存在

```
sudo rm -f /var/log/centro.log 
```

然后我重新启动服务

```
sudo service rsyslog restart 
```

最后以下代码有效：

```
// gcc centro.c -o centro

#include <stdio.h>
#include <syslog.h>

int  main(int argc, char *argv[])
{
    openlog(NULL, 0, LOG_USER);

    syslog(LOG_INFO, "MORTACCI TUA!!!");

    closelog();
    return 0;
} 
```

# php - 如何在 CodeIgniter 中插入方法之前过滤数据？

> ID：10952517
> 
> 赞同：0
> 
> 时间：2012-06-08T16:18:25.423
> 
> 标签：php, codeigniter, filtering

在 Codeigniter 上，如果您使用注册表单创建成员并将数据发送到模型成员中的插入方法，您如何过滤数据？

我正在寻找最好的 MVC 方法来做到这一点，因为我不想保存复选框“我同意...”的值，也不想保存安全问题的值或此类事情。

在我的控制器中，可以这样做（在发送到模型方法之前）：

```
$posts = $this->input->post();
unset($posts['abcdef']);
... 
```

但也可以在我的模型中做到这一点（在使用插入方法之前）：

```
function insert($data){
unset($data['abcdef']);
...
} 
```

那么，如何过滤数据呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:47:36.420

您发布工作的两种方式 - 但它们是“黑名单”。

您应该在模型中使用“白名单”。这意味着您的模型将只寻找它想要的信息，并丢弃其余的信息。这可以防止人们将附加的 $_POST 数据插入到您的表单中，而这并不是您所期望的。

在模型中，我做了类似的事情

```
function insert($inputs)
{
    $white_list = array ('field1', 'field2', ... ,'field9');
    foreach ($inputs as $post_id => $input)
    {
        if ( ! in_array ($post_id, $white_list))
        {
            unset($inputs[$post_id]);
        }
     }
    // Now insert data here and sleep easy at night
 } 
```

# jquery - 获取新建元素的属性

> ID：10952518
> 
> 赞同：0
> 
> 时间：2012-06-08T16:18:28.277
> 
> 标签：jquery

我正在尝试获取`src`加载后已添加到页面的图像的属性，但结果不断返回`undefined`。

```
$('#qtr').change(function() {
    data = {
        'img': $('#edit_image').attr('src'),
        'degrees': '90'
    };
    $.post('/ajax/ajax_images/rotate', data, function(response) {
        if (response.error != 0) {
            alert('Unable to rotate image');
        }
        else {
            $('#edit_image').attr('src', response.html);
            new_image = response.html;
            var start = new_image.lastIndexOf('/') + 1;
            new_image = new_image.substr(start);
        }
    }, 'json');
});​ 
```

`$('#edit_image')`是新创建的图像。我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:17:00.793

问题是一旦加载 DOM 对您的 DOM 进行任何修改，jquery 需要被明确告知这些更改。因此，根据您的 jquery 版本，使用回调函数查看 .bind() 或 .live() 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:13:26.363

尝试：

```
$('img:last' ).attr('src') 
```

;-)

# css - 在 CSS 中插入背景图片（Twitter Bootstrap）

> ID：10952523
> 
> 赞同：24
> 
> 时间：2012-06-08T16:18:44.843
> 
> 标签：css, twitter-bootstrap

如何将图像背景添加到我的网站？

```
body {
     margin: 0;
     background: url(background.png);
     background-size: 1440px 800px;
     background-repeat:no-repeatdisplay: compact;
     font: 13px/18px "Helvetica Neue", Helvetica, Arial, sans-serif; 
```

我做了那么多，但我的页面上没有任何显示。我是 CSS 初学者。

更新：

```
body {
 margin: 0;
 background-image: url(.../img/background.jpg);
 background-size: 1440px 800px;
 background-repeat:no-repeat;
 display: compact;
 font: 13px/18px "Helvetica Neue", Helvetica, Arial, sans-serif; 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-06-08T16:20:59.850

将背景网址放在引号中。

它应该是`background: url('background.png');`

有关工作演示，请参见[此处。](http://jsfiddle.net/h8SBh/1/)

您还遇到`background-repeat line`两个语句之间缺少分号的问题。如果你的背景真的很小，你不会因为这个问题而看到它。

只是为了更新解决方案，在其他问题中，背景文件`.../background.jpg`在它应该被引用的时候被引用`../background.jpg`（2 个点，而不是 3 个）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T16:25:55.213

不是问题，以下行不正确，因为 for 的语句`background-repeat`在下一个 for 语句之前没有关闭`display`...

```
background-repeat:no-repeatdisplay: compact; 
```

这不应该是

```
background-repeat:no-repeat;
display: compact; 
```

如果 URL 正确，添加或删除引号（根据我的经验）没有区别。图片的路径是否正确？**如果你在 CSS 中给出资源的相对路径，它是相对于 CSS 文件的，而不是包含 CSS 的文件。**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T16:31:34.063

您的图像是否与您的 css 文件位于同一文件夹/目录中？如果是这样，您的图片网址是正确的。否则，它不是。

如果你的文件夹结构是这样的......

网页
-index.html
-css
- - style.css
- images
- - background.png

然后要引用您的 css 文件中的图像，您应该使用以下路径：

../图像/背景.png

所以这将是背景： url('../images/background.png');

逻辑很简单：通过键入“../”（根据需要多次）上一个文件夹。通过指定您要进入的文件夹来进入一个文件夹。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-30T03:21:10.387

在 html、body 或 wrapper 元素上添加背景图像以实现背景图像会导致填充问题。在 github 上查看这张票[https://github.com/twitter/bootstrap/issues/3169 。](https://github.com/twitter/bootstrap/issues/3169)ShaunR 的评论也是创作者对此的回应之一。created ticket 中的给定解决方案并不能解决问题，但如果您不使用响应式功能，它至少可以让事情顺利进行。

假设您使用的容器没有响应式功能，并且宽度为 960px，并且想要实现 10px 的内边距，您设置：

```
.container {
   min-width: 940px;
   padding: 10px;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-04T10:41:12.500

```
body {
    background-image: url(your image link);
    background-position: center center;
    background-repeat: no-repeat;
    background-attachment:fixed;
    background-size: cover;
    background-color: #464646;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-20T22:49:24.840

如果你不能重复背景图像（出于审美原因），那么这个方便的 JQuery 插件将拉伸背景图像以适应窗口。

回弹 [http://srobbin.com/jquery-plugins/backstretch/](http://srobbin.com/jquery-plugins/backstretch/)

效果很好...

~干杯！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-13T12:15:42.787

如果添加以下内容，则可以设置背景颜色或图像（您的 css）

```
 html { 
     background-image: url('http://yoursite/i/tile.jpg');
     background-repeat: repeat; 
 }

 .body {
     background-color: transparent; 
 } 
```

这是因为 BS 对背景颜色和`.container`类应用了 css 规则。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-31T16:34:45.600

为了更加模块化，并且如果您有许多背景图像要合并到任何您想要的位置，您可以为每个图像创建一个类：

```
.background-image1  
{
background: url(image1.jpg);
 }
.background-image2  
{
background: url(image2.jpg);
 } 
```

然后通过添加 div 将图像插入到任何你想要的地方

```
<div class='background-image1'>
    <div class="page-header text-center", style='margin: 20px 0 0px;'>
         <h1>blabaaboabaon</h1>
    </div>
</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-30T18:46:20.943

问题也可能是样式表导入的顺序。我不得不将自定义样式表导入移到引导导入下方。

# javascript - Phonegap - 确定确切的活动元素

> ID：10952524
> 
> 赞同：3
> 
> 时间：2012-06-08T16:18:45.010
> 
> 标签：javascript, jquery, html, jquery-mobile, cordova

我需要更改我的 phonegap 项目的后退按钮功能，我已经成功地做到了，没有任何问题。现在唯一的问题是，我需要根据用户是否选择了某个字段来进一步更改功能。

基本上，如果用户单击了 id 为“date-selector1”的字段，我需要完全禁用后退按钮。

我试图使用document.activeElement，但它只返回元素的类型（在这种情况下为输入），但我仍然希望功能在它们处于一般输入中时工作，但在它们处于输入时不工作一个特定的 ID。

**编辑** 我尝试了下面的所有建议，并最终得到了以下代码，但仍然没有成功。

```
function pluginDeviceReady() {
document.addEventListener("backbutton", onBackKeyDown, false);
}

function onBackKeyDown() {
    var sElement = document.activeElement;
    var isBadElement = false;
    var eList = ['procedure-date', 'immunization-date', 'lab-test-done', 'condition-onset', 'condition-resolution', 'medication-start-date', 'medication-stop-date', 'reaction-date'];
   console.log("[[ACTIVE ELEMENT: --> " + document.activeElement + "]]");
   for (var i = 0;i < eList.length - 1;i++) {
        if (sElement == $(eList[i])[0]) {
            isBadElement = true;
        }
    }
    if (isBadElement) {
        console.log('Back button not allowed here');
    } else if ($.mobile.activePage.is('#main') || $.mobile.activePage.is('#family') || $.mobile.activePage.is('#login')) {
        navigator.app.exitApp();
    } else {
        navigator.app.backHistory();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:30:36.417

如果您正在收听后退按钮，则可以添加以下 if 语句：

```
if (document.activeElement == $("#date-selector1")[0]) { 
    /*disable button here, return false etc...*/ 
} 
```

甚至更好（感谢 Jonathan Sampson）

```
if (document.activeElement.id === "date-selector1") { 
    /*disable button here, return false etc...*/ 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:23:56.403

您可以在用户单击某个字段时设置一个标志，或者您可以在用户单击应该禁用后退按钮的字段时设置一个单击事件（或任何其他类型的事件）。

从文档中可以看出，对于特定页面，后退按钮是有条件的，您可以`back-btn=true`删除该后退按钮。

[http://jquerymobile.com/test/docs/toolbars/docs-headers.html](http://jquerymobile.com/test/docs/toolbars/docs-headers.html)

如果您需要复杂的条件功能，您可以在页眉或页脚中创建自己的按钮，使用 jquery-mobile 小部件设置样式并实现您自己的点击功能。

# sockets - libevent 发送 POST 而不是 GET

> ID：10952526
> 
> 赞同：1
> 
> 时间：2012-06-08T16:18:58.470
> 
> 标签：sockets, networking, virtual-machine, libevent

我编写了一个简单的程序，使用 libevent 和这个示例代码同时连接到 Web 服务器

```
#include <stdio.h>
#include <event2/event.h> 
#include <evhttp.h>
#include <unistd.h>
#include <time.h>
#include <pthread.h>

int success_count = 0;
int failure_count = 0;
time_t start,end;

void _reqhandler(struct evhttp_request *req, void *state)
{
   printf("in _reqhandler. state == %s\n", (char *) state);
   if (req == NULL) {
       printf("timed out!\n");
       failure_count ++;
    } else if (req->response_code == 0) {
    printf("connection refused!\n");
    failure_count++;
    } else if (req->response_code != 200) {
    printf("error: %u %s\n", req->response_code, req->response_code_line);
    failure_count++;
    } else {
    printf("success: %u %s\n", req->response_code, req->response_code_line);
    success_count++;
    }
    evhttp_connection_free((evhttp_connection*)state);
}

void* thread_func(void* arg)
{
   printf("starting event loop..\n");
   sleep(1);
   event_base_dispatch((struct event_base*)arg);
   printf("returning");
}
int main(int argc, char *argv[])
{
    struct event_base* base = event_init();
    printf("Using Libevent with backend method %s.",event_base_get_method(base));   
    pthread_t id;
    int ret = pthread_create(&id,NULL,thread_func,base);
    int x = 10;
    start = time (NULL);
    while(x--){
        printf("%s\n","adding");
        const char *addr = "74.125.131.103";
        unsigned int port = 80;
        struct evhttp_connection *conn;
        struct evhttp_request *req;

        //printf("initializing libevent subsystem..\n");

        conn = evhttp_connection_new(addr, port);
        evhttp_connection_set_timeout(conn, 5);
        req = evhttp_request_new(_reqhandler, (void *)conn);
        evhttp_add_header(req->output_headers, "Host", addr);
        evhttp_add_header(req->output_headers, "Content-Length", "0");
        evhttp_make_request(conn, req, EVHTTP_REQ_GET, "/");
    }
    pthread_join( id, NULL);
    end = time(NULL);
    double dif = difftime(end,start);
    printf("total seconds taken: %.2lf for %d success connections and %d failed  
    connections\n", dif, success_count,failure_count);
    return 0;
} 
```

我在一个带有 centos 的 vmware fusion 上运行它。问题是当我运行它时，我只得到服务器拒绝的连接。在对wireshark的进一步调查中，我意识到这段代码是从后面发出HTTP POST请求而不是GET请求，因此连接被拒绝。现在相同的代码在我的 mac 或 ubuntu 机器上运行良好。这似乎是虚拟操作系统的配置问题。谁能指出它可能是什么？这是我的虚拟操作系统发出的：

```
 POST / HTTP/1.1
 Host: 74.125.131.103
 Content-Length: 0

 HTTP/1.1 405 Method Not Allowed 
```

# adb - Android adb shell 错误：找不到 'android_reboot' - Busybox 不工作？

> ID：10952527
> 
> 赞同：2
> 
> 时间：2012-06-08T16:18:59.200
> 
> 标签：adb, busybox

在我的扎根星系 S2 中，busybox 似乎发生了一些事情。对于我在 adb shell 中运行的每个命令，我得到：

reloc_library[1312]: 9098 无法找到“android_reboot”...无法链接可执行文件

我尝试推送另一个busybox，但我无法将其直接推送到/sbin/（只读），并且我无法运行adb shell 以使用mount 命令直接推送到/sbin/（因为它给出了相同的错误...... ）。

我不知道该怎么办...

任何帮助都非常受欢迎，非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T10:10:00.653

# codeigniter - CodeIgniter - 动态页面 - 默认控制器 url

> ID：10952530
> 
> 赞同：1
> 
> 时间：2012-06-08T16:19:02.827
> 
> 标签：codeigniter, codeigniter-2, php

**编辑**

我在 routes.php 中的解决方案：

```
$route['news'] = 'news_controller';
$route['gallery'] = 'gallery_controller';
$route['(:any)'] = 'sites/$1'; 
```

在我的网站控制器中：

```
function index($site_id = '') {
  //sanitize $site_id.
  $this->site = $this->sites_model->get_site($site_id);
  //etc.
} 
```

THX 转 YAN

**问题：**

所以我用 CodeIgniter 写了一个小 CMS。管理员可以创建站点。当 url 的段类似于数据库中的段时，该站点会自动打开。例如 mysite.com/sites/about 将调用“关于”站点。这很好用。

现在我的网址有问题。我想要这个网址

[http://www.mysite.com/sites/about](http://www.mysite.com/sites/about)

转向这个：

[http://www.mysite.com/about](http://www.mysite.com/about)

问题是，我不能使用 routes.php 并为每个站点设置通配符。（因为它们是动态的，我不知道客户将创建哪个站点 - 我不想为他将创建的每个站点编辑 routes.php 文件 - 这应该自动完成）

问题是我也有其他修复控制器，比如新闻、画廊或联系人：mysite.com/news、mysite.com/gallery，......它们工作正常

所以这是我的站点控制器：

```
class Sites extends Public_Controller {

public $site;
public $url_segment;

public function _remap($method)
{
    $this->url_segment = $this->uri->segment(2);

    $this->load->model('sites_model');
    $this->site = $this->sites_model->get_site($this->url_segment);

    if($this->site !== FALSE)
    {
        $this->show_site($this->site);
    }
    else
    {
        show_404($this->url_segment);
    }
}

public function show_site($data)
{
    $this->template->set('site', FALSE);
    $this->template->set('site_title', $data['name']);
    $this->template->set('content',$data['content']);
    $this->template->load('public/template','sites/sites_view', $data);
}} 
```

这是检查数据库的 Site_model ......如果 url_segment 适合数据库中的标题：

```
class Sites_model extends CI_Model {

public function get_site($site_url)
{
    if($site_url != ""){
        $this->db->where('name', $site_url);
        $query = $this->db->get('sites', 1);

        if($query->num_rows() > 0){
            return $query->row_array();
        }
        else
        {
            return FALSE;
        }
    }else{
        return FALSE;
    }
} } 
```

我想我需要一些东西来检查控制器是否存在（url的第一段），而不是调用站点控制器并检查站点是否在数据库中，如果是假的，然后调用 404。

有什么建议可以解决吗？

顺便说一句：对不起我的英语

关于GN

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:33:53.970

您可以`routes.php`通过以下方式处理，只需将`(:any)`值保留在最后即可：

```
$route['news'] = 'news_controller';
$route['gallery'] = 'gallery_controller';
$route['(:any)'] = 'sites/$1'; 
```

在您的站点控制器中，使用 URL 中的数据路由到特定站点。

```
function index($site_id = '') {
    //sanitize $site_id.
    $this->site = $this->sites_model->get_site($site_id);
    //etc.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:28:37.047

我无法理解问题的全部意图，但是，据我所知，您是否只需要添加：

```
if ($this->uri->segment(1) != 'sites')
     ... // handle malformed URL 
```

# json - 使用杰克逊解析一个非模式化 json 的大文件？

> ID：10952539
> 
> 赞同：0
> 
> 时间：2012-06-08T16:19:36.583
> 
> 标签：json, jackson, file-processing

我在磁盘上有一个非常大的 .json 文件。我想使用 Jackson 解析器将其实例化为 Java 对象。

该文件如下所示：

```
[ { "prop1": "some_value",
    "prop2": "some_other_value",
    "something_random": [
      // ... arbitrary list of objects containing key/value 
      //     pairs of differing amounts and types ...
    ]
  },
  // ... repated many times ...
  {
  }
] 
```

基本上它是一个很大的对象数组，每个对象都有两个标识它的字符串属性，然后是另一个内部对象数组，其中每个对象是属性和值的随机集合，这些属性和值主要是字符串和整数，但也可能包含数组。

由于这种对象布局，我没有可以用来轻松实例化这些对象的集合模式。使用 org.json 处理器需要尝试为整个文件分配一个字符串，这通常由于其大小而失败。所以我想使用流解析器，但我完全不熟悉它。

最后我想要的是一个 Map，其中 String 是 prop1 的值， SomeObject 是保存整个对象数据的东西（顶级数组条目）。也许只是 JSON 可以稍后在需要时进行解析？

无论如何，欢迎有关如何为此编写代码的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-10T01:56:02.983

由于您不想将整个事物绑定为单个对象，因此您可能希望`readValues()`使用`ObjectReader`. 如果单个值的结构是通用的，您可能希望将它们绑定为`java.util.Map`s 或`JsonNode`s（杰克逊树模型）。所以你会做这样的事情：

```
ObjectMapper mapper = new ObjectMapper();
ObjectReader reader = mapper.reader(Map.class); // or JsonNode.class
MappingIterator<Map> it = reader.readValues(new File("stuff.json"));
while (it.hasNextValue()) {
   Map m = it.nextValue();
   // do something; like determine real type to use and:
   OtherType value = mapper.convertValue(OtherType.class);
} 
```

迭代整个事情。

# sql - 获得发生次数的最佳方法

> ID：10952545
> 
> 赞同：-1
> 
> 时间：2012-06-08T16:19:54.967
> 
> 标签：sql, count

我有以下数据结构：

```
FIRSTNAME    AGE    NICKNAME
Jack         28     Benny
Robert       30     Benny
Pascal       20     Benny
Charles      19     Lence
Anthony      20     Lence 
```

第一列是唯一的。这个想法是我必须计算“昵称”被使用了多少次，并且我想输出它，这样我才能得到以下结果：

```
Benny    3
Lence    2 
```

知道我有数百万行的最佳性能方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:23:21.940

试试这个：

```
SELECT NICKNAME,COUNT(NICKNAME)
FROM MyTable
GROUP BY NICKNAME 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:21:51.863

SELECT NICKNAME, SUM(1) 从表 GROUP BY NICKNAME

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:22:44.023

按名字聚合计数组，没有其他解决方案。

顺便说一句，benny 昵称只出现了 3 次，而不是 4 次。

# php - PHP 提交时刷新页面，编辑 SQL 查询

> ID：10952552
> 
> 赞同：0
> 
> 时间：2012-06-08T16:20:29.537
> 
> 标签：php, mysql

我有一个用 PHP 编写的页面，它在所有月份和两个特定年份运行 MySQL 查询。当您转到该页面时，会出现一个包含结果数据的表格。

我想做的是，在给用户这个默认数据之后，让他们选择他们想要查看数据的月份/年份。所以，我需要让他们的下拉选择（默认为 2011 年 1 月到 2012 年 12 月）影响显示的数据。我正在使用 WordPress，但这不是 WordPress 特定的。

所以，我现在在 PHP 中运行的查询（一些字段被匿名以保护无辜者）是：

```
 SELECT * 
    FROM database.table
    Where MonthNum >=1
    AND MonthNum <=12
    AND Year >=2011
    AND Year <=2012 
```

但我想做的是在运行查询的 HTML 中创建四个输入字段作为下拉菜单。它们是 MonthMin（默认 1）、MonthMax（默认 12）、YearMin（默认 2011）、YearMax（默认 2012）。因此，查询将是：

```
 SELECT * 
    FROM database.table
    Where MonthNum >= MonthMin
    AND MonthNum <= MonthMax
    AND Year >= YearMin
    AND Year <= YearMax 
```

而且因为它是从默认日期提取的，所以输出将与第一个查询相同。但是，我想做的是允许用户选择一组不同的日期，比如将 MonthMin 设置为 2，从而忽略一月，然后点击“提交”，然后页面应该重新加载但使用用户定义的数据在查询中而不是默认值。

不要担心教我 SQL 注入，我也在努力！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T19:01:28.827

明白了。你有几个选择。您可以“提交”而无需使用 ajax 刷新整个页面......或者您可以使用提交 get/post 传递选定的值，并在页面加载时在 $_REQUEST 中检查它们是否存在。如果它们被传入，则使用传入的值，只有当页面加载时 $_REQUEST 中不存在新值时，才默认它们。

# arrays - sqlite + flex 4.6 + 数组的疑惑

> ID：10952553
> 
> 赞同：0
> 
> 时间：2012-06-08T16:20:31.253
> 
> 标签：arrays, apache-flex, sqlite, arraycollection

这是一个灵活的新手。我已经测试了来自的“答案 2”代码

[将 Flex 连接到 SQLite](https://stackoverflow.com/questions/10392469/connecting-flex-to-sqlite)

但我对其进行了修改：抛出一个按钮，其目的是在被点击后用数据填充列表；结果是半成功，取回了列表中的“[object Object]”而不是数据；如何克服这个问题？Flex是4.6，代码如下：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
    xmlns:s="library://ns.adobe.com/flex/spark" 
    title="">
<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>
<s:layout>
    <s:VerticalLayout paddingTop="10" paddingLeft="10"/>
</s:layout>
<fx:Script>

    <![CDATA[
        import flash.data.SQLConnection;
        import flash.data.SQLStatement;
        import flash.filesystem.File;
        import flash.filesystem.FileMode;

        import mx.collections.ArrayCollection;
        private function getData():ArrayCollection 
        {
            var stmt:SQLStatement = new SQLStatement();
            stmt.sqlConnection = new SQLConnection();

            stmt.sqlConnection.open(File.applicationStorageDirectory.resolvePath("assets/test.sqlite"));
            stmt.text = "SELECT one, two FROM zero";
            stmt.execute();
            var result:Array = stmt.getResult().data;
            resultArr =  new ArrayCollection();
            if (result)
            {      
                resultArr.source = result;           
            }
        return resultArr;
        }
        [Bindable]private var resultArr:ArrayCollection = new ArrayCollection();

        protected function button1_clickHandler(event:MouseEvent):void
        {
            // TODO Auto-generated method stub
            getData();
        }

    ]]>
</fx:Script>
<s:Button label="OK" click="button1_clickHandler(event)"/>
<s:List width="302" height="234" dataProvider="{resultArr}"></s:List>
</s:View> 
```

感谢任何想帮助我的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:29:27.180

您得到 是`[object Object]`因为返回的数据有多个值（第一列和第二列）。您需要告诉应用程序您想要显示的内容。

尝试设置 labelField 参数，看看你得到了什么：

```
<s:List width="302" height="234" dataProvider="{resultArr}" labelField="one"></s:List> 
```

# silverlight - 带有扩展名和文件名的 Silverlight OpenFileDialog 过滤器属性

> ID：10952554
> 
> 赞同：0
> 
> 时间：2012-06-08T16:20:32.927
> 
> 标签：silverlight, filter, filenames, openfiledialog

在 Silverlight 中设置 OpenFileDialog 控件的过滤属性时，有什么办法可以通过扩展名和部分文件名过滤文件？例如，如果我只想显示以字母 A 开头并具有扩展名 .dat 的文件，如何设置过滤器属性。请记住，我可能有其他具有相同扩展名的文件以不同的字母开头。我不想展示那些。感谢您的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-06-12T09:22:41.167

非常老的问题，但我有类似的问题，这对我来说是这样的：

```
 private void BrowseExcelFileButton_Click(object sender, RoutedEventArgs e)
    {
        //This needs to be before try statement othervise exception is thrown ("Dialogs must be user-initiated")
        OpenFileDialog openFileDialog = new OpenFileDialog();
        try
        {

            openFileDialog.Filter = "Excel Files (*.xls,*.xlsx)|*.xls;*.xlsx|All Files (*.*)|*.*";
            openFileDialog.FilterIndex = 1;

            if (openFileDialog.ShowDialog() == true)
            {
               ...
            }
        }
        catch (Exception ex)
        {
            ...
        }
    } 
```

# javascript - 将 URL 加载到 iframe 中并查找刚刚加载的 HTML 的值 - Jquery

> ID：10952563
> 
> 赞同：0
> 
> 时间：2012-06-08T16:21:03.253
> 
> 标签：javascript, jquery, html

我正在尝试通过执行以下 jquery 代码将 URL 加载到 iframe 中。问题是当我尝试查找刚刚加载的 iframe 的元素时，它总是返回在上一次单击中加载的内容。第一次点击总是空的。有人可以帮我解决这个问题吗？谢谢

```
$(document).ready(function() {

    $('.Popup').click(function() {

        $('#myiframe')
                .attr('src', $(this).attr('href'))
                .attr('frameborder', '0')

        return false;
    });
    alert($('#myiframe').contents().find('.name').html())
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:27:55.027

您需要等待获取的 URL 加载到 iframe 中，然后才能从中获取内容。您可以使用[jquery .load() 函数](http://api.jquery.com/load-event/)来执行此操作。像这样的东西：

```
$(document).ready(function() {

 $('.Popup').click(function() {

        $('#myiframe')
                .attr('src', $(this).attr('href'))
                .attr('frameborder', '0')
                .load(function() {
                     alert($(this).contents().find('.name').html())
                })

        return false;
    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:26:40.413

可能的原因是您在*注册 onclick 事件句柄*后发出警报。你应该做的是这个，我猜：

```
$(document).ready(function() {

    $('.Popup').click(function() {

        $('#myiframe')
                .attr('src', $(this).attr('href'))
                .attr('frameborder', '0');
        $($("#myIframe").get(0).contentDocument).ready(function() {
            alert($('#myiframe').contents().find('.name').html())
        });
        return false;
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:27:12.660

看起来您只需要等待 iFrame 在警报响起之前加载。您可以使用该`load`功能。

```
$("#myiframe").load(function() {
    alert("iFrame has loaded. You can now get content out of it");
}); 
```

# perl - Perl 通过目录递归

> ID：10952566
> 
> 赞同：1
> 
> 时间：2012-06-08T16:21:23.877
> 
> 标签：perl, directory

所以基本上我要做的是浏览一个目录并对所有文件执行一个操作，在这种情况下，子 searchForErrors。这个子工作。到目前为止，我所拥有的是：

```
sub proccessFiles{
    my $path = $ARGV[2];

    opendir(DIR, $path) or die "Unable to open $path: $!";
    my @files = readdir(DIR);
    @files = map{$path . '/' . $_ } @files;
    closedir(DIR);

    for (@files){
        if(-d $_){
            process_files($_);
        }
        else{
        searchForErrors;
    }
}
}

proccessFiles($path); 
```

任何帮助/建议都会很棒。再说一次，我是 Perl 的新手，所以解释越多越好。谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-08T16:29:40.583

您应该使用该[`File::Find`](http://search.cpan.org/perldoc?File::Find)模块而不是尝试重新发明轮子：

```
use strict;
use warnings;
use File::Find;

my @files;
my $start_dir = "somedir";  # top level dir to search
find( 
    sub { push @files, $File::Find::name unless -d; }, 
    $start_dir
);
for my $file (@files) {
    searchForErrors($file); 
} 
```

您当前代码的一个问题是您在递归搜索中包含`.`和`..`目录，这无疑会导致`deep recursion`错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T17:55:40.443

[`Path::Class`](https://metacpan.org/module/Path%3a%3aClass)我认为除了 TLP 的解决方案之外，展示一个解决方案会很有用[`File::Find`](https://metacpan.org/module/File%3a%3aFind)。

我认为这几乎是不言自明的。

```
use strict;
use warnings;

use Path::Class 'dir';

my $root = dir 'C:\path\to\root';

$root->recurse(callback => sub {
  my $file = shift;
  searchForErrors($file) unless $file->is_dir;
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T09:15:19.773

`File::Find`在不使用大量内存的情况下使用的更好方法是：

```
use strict; use warnings;
use File::Find;

find(
    sub { 
        searchForErrors($File::Find::name) unless -d
    }, 
    "/tmp/"
); 
```

这是更多的迭代器风格。

# ruby - ActiveSupport::Notifications 从块内部访问有效负载

> ID：10952568
> 
> 赞同：0
> 
> 时间：2012-06-08T16:21:32.443
> 
> 标签：ruby, notifications, activesupport

我最近发现了[ActiveSupport::Notifications](http://api.rubyonrails.org/classes/ActiveSupport/Notifications.html)。我认为这是监控您的应用程序的好工具。

我目前在 Rails 之外使用它来监控我的 Sinatra 应用程序，它运行良好。

但是我经常使用它来检测自定义查询，并希望以某种方式通知查询的结果：

```
my_input = "some_query"
ActiveSupport::Notifications.instrument("myapp.create", :input => my_input) do
  #stuff
  result = search_for my_input
  #stuff
  result
end 
```

现在我可以订阅它并且还可以获得已执行的查询（在有效负载哈希中可用）。但我也想在我的订阅者中看到结果。

那么有没有办法在我执行块时向有效负载添加任何自定义值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T09:43:53.443

当我在寻找同样的东西时，偶然发现了你的问题。

您可以简单地传入一个块变量，它将代表您的有效负载，并且您可以在块中填充它

```
my_input = "some_query"
ActiveSupport::Notifications.instrument("myapp.create", :input => my_input) do |instrument|
  #stuff
  result = search_for my_input
  instrument[:my_result] = result
  #stuff
  result
end 
```

在您的订阅者中，从传递的参数创建一个新事件：

```
ActiveSupport::Notifications.subscribe("myapp.create") do |*args|
  event = ActiveSupport::Notifications::Event.new(*args)
  Rails.logger.info event.payload
end 
```

# node.js - 使用 MongoDB 的 Node.js Express 路由

> ID：10952571
> 
> 赞同：3
> 
> 时间：2012-06-08T16:21:47.993
> 
> 标签：node.js, routing, express, mongoose

下午好，

我最近开始使用 Node.js + Express + MongoDB。我设置了一个简单的应用程序，其中包含：

```
/**
 * Module dependencies.
 */

var express = require('express')
  , routes = require('./routes')
  , mongoose = require('mongoose')
  , models = require('./models')
  , Document
  , db;

// lots of conf ...

models.defineModels(mongoose, function() {
  app.Document = Document = mongoose.model('Document');
  db = mongoose.connect(app.set('db-uri'));
})

// Routes

app.get('/', routes.home);
app.get('/documents.:format?', routes.list);

// classical end of app.js 
```

我在“routes”文件夹中也有一个相应的“index.js”文件，其中包含：

```
exports.home = function(req, res){
  res.render('index', { title: 'Indx' })
};

exports.list = function(req, res){
    Document.find().all(function(documents) {
        switch (req.params.format) {
            case 'json':
                res.send(documents.map(function(d) {
                    return d.__doc;
                }));
            break;
            default:
                res.render('index', { title: 'Indx' });
        }
    });
}; 
```

路由部分没问题，这意味着当我将浏览器指向 localhost:3000 时，我会看到（生成的 Jade 模板）“索引”视图。当我指向 localhost:3000/documents 时，路由工作正常，并且代码正在尝试为我的“index.js”路由的“列表”部分提供服务。但是，我希望我在主应用程序中创建的“文档”猫鼬模型能够在“index.js”中被识别，但显然情况并非如此，因为我不断收到以下错误：

```
Express
500 ReferenceError: Document is not defined
at C:\PERSO\DEV\indxjs\routes\index.js:23:2
at callbacks (C:\PERSO\DEV\indxjs\node_modules\express\lib\router\index.js:272:11)
at param (C:\PERSO\DEV\indxjs\node_modules\express\lib\router\index.js:246:11)
at param (C:\PERSO\DEV\indxjs\node_modules\express\lib\router\index.js:243:11)
at pass (C:\PERSO\DEV\indxjs\node_modules\express\lib\router\index.js:253:5)
at Router._dispatch (C:\PERSO\DEV\indxjs\node_modules\express\lib\router\index.js:280:4)
at Object.handle (C:\PERSO\DEV\indxjs\node_modules\express\lib\router\index.js:45:10)
at next (C:\PERSO\DEV\indxjs\node_modules\express\node_modules\connect\lib\http.js:204:15)
at Object.methodOverride [as handle] (C:\PERSO\DEV\indxjs\node_modules\express\node_modules\connect\lib\middleware\methodOverride.js:35:5)
at next (C:\PERSO\DEV\indxjs\node_modules\express\node_modules\connect\lib\http.js:204:15) 
```

I could obviously define my routing from within the 'app.js' with something like :

```
app.get('/documents.:format?', loadUser, function(req, res) {
    // ...
} 
```

But can anyone see a way of talking with mongoose while retaining the elegant './routes/index.js' separation from the 'app.js' ?

Thanks a lot

EDIT : following kind answer from Wes, I added the following code to 'index.js':

```
var Document;
function defineRoutes(mongoose, fn) {
  Document = mongoose.model('Document');
  fn();
}
exports.defineRoutes = defineRoutes;
// then the same as in initial post 
```

And I enclosed the routing definitions within this function in 'app.js' :

```
routes.defineRoutes(mongoose, function() {
  app.get('/', routes.home);
  app.get('/documents.:format?', routes.list);
}) 
```

Everything is ok when I point to localhost:3000, but when I point to /documents, the browser keeps loading, loading ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T12:40:58.237

Thanks to Wes Johnson, I found my way out. I was blindly following a dated tutorial, which used deprecated methods from MongoDb. Below is the code snippet I finally used to implement the 'list documents' feature:

```
exports.list = function(req, res){
    Document.find({},function(err, documents) {
        switch (req.params.format) {
            case 'json':
                res.send(documents.map(function(d) {
                    return d.toObject();
                }));
            break;
            default:
                res.render('index', { title: 'Indx' });
        }
    });
}; 
```

Once again, thanks Wes !

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:39:50.257

Node modules are self-contained in terms of variable scope. Your `Document` object is not accessible from `index.js` as you mention. You need to pass this along to your routes logic, or pass along mongoose itself.

`require` calls are cached for the most part, so requiring mongoose in your `index.js` file and getting an instance of `Document` there is one option.

Since you don't really use `Document` in your `app.js`, you could always move the db configuration to another module and export the important references back to the scripts that need them.

# mysql - 同一张表上的MySQL多个子查询

> ID：10952573
> 
> 赞同：0
> 
> 时间：2012-06-08T16:21:57.527
> 
> 标签：mysql

我有以下结构的表

```
ID | Amount | Bank (1 or 2)
---+--------+------
1  | 100000 | 1
2  | 256415 | 2
3  | 142535 | 1
1  | 214561 | 2
2  | 123456 | 1
1  | 987654 | 2 
```

我想要这样的结果（来自同一张表）：

```
ID | sum(Bank 1) | sum(Bank 2)
---+-------------+------------
1  | 100000      | 1202215
2  | 123456      | 256415
3  | 142535      | 0 
```

实现这一目标的最简单查询是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:37:20.053

ANSI 解决方案：

```
Select Id
  , Sum( Case When Bank = 1 Then Amount End ) As Bank1Total
  , Sum( Case When Bank = 2 Then Amount End ) As Bank2Total
From SourceTable
Group By Id 
```

[SQL Fiddle 版本](http://sqlfiddle.com/#!2/4a6e2/5)（使用 MySQL）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:31:22.940

此 SQL 查询将提取您要查找的信息：

```
select ID, 
       SUM(IF(Bank=1, Amount, 0)) AS Bank1,
       SUM(IF(Bank=2, Amount, 0)) AS Bank2
from TableName
group by ID ASC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T16:32:13.347

使用[sqlFiddle](http://sqlfiddle.com/#!3/fd1bb/6)和 tsql 我能够想出：

```
select distinct t.id,
      isnull((select sum(t1.amount) 
         from temp as t1
         where t.id = t1.id and t1.bank = 1), 0) as 'bank 1 sum',
      isnull((select sum(t1.amount) 
         from temp as t1
         where t.id = t1.id and t1.bank = 2), 0) as 'bank 2 sum'
  from temp as t 
```

其中 temp 是您的表名。对于 mySQL（感谢评论中的@JakeFeasel）：

```
select distinct t.id,
      ifnull((select sum(t1.amount) 
         from temp as t1
         where t.id = t1.id and t1.bank = 1), 0) as 'bank 1 sum',
      ifnull((select sum(t1.amount) 
         from temp as t1
         where t.id = t1.id and t1.bank = 2), 0) as 'bank 2 sum'
  from temp as t 
```

# asp.net-mvc - 如何使无序列表出现在 MVC3 Razor 的 foreach 循环中？

> ID：10952578
> 
> 赞同：2
> 
> 时间：2012-06-08T16:22:14.500
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

我有以下代码：

```
@foreach (Content topic in Model.Topics)
{
    if (topic.RowKey.Substring(2, 2) == "00")
    {
        <h3>@topic.RowKey.Substring(0, 2).TrimStart('0') - @Html.Raw(topic.Title)</h3>
    }
    else
    {
        <p>@String.Format("{0}.{1}",topic.RowKey.Substring(0, 2).TrimStart('0'),topic.RowKey.Substring(2, 2).TrimStart('0').PadLeft(1, '0')) - @Html.Raw(topic.Title)</p>
    }
} 
```

我的输入数据（topic.RowKey 的值）如下所示：

```
0100 <- This is topic 1
0101 <- This is topic 1.1
0102 <- This is topic 1.2
0103 <- This is topic 1.3
0200 <- This is topic 2
0201 <- This is topic 2.1
etc.... 
```

这可行，但我真正想做的是每次 RowKey 的前两位数字更改时都有一个 h3 标题，然后在接下来和下一个 h3 标题之间我想要一个无序列表而不是`<p>xxx</p>`. 我尝试了很多不同的组合，但没有任何效果。这甚至可能与 Razor 相关吗？我遇到的巨大问题是如何让`<ul>`and `</ul>`s 正确显示？我知道我可以`<ul>`在 the 之后放置一个，`<h3>`但我该如何放置`</ul>`呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T16:42:44.620

没有签入剃须刀，这里或那里可能缺少@，但是......

```
@var groupedTopics = Model.Topics.GroupBy(t => t.RowKey.Substring(0, 2));

@foreach (var group in groupedTopics) {
  var firstTopic = group.First();
  <h3>@firstTopic.RowKey.Substring(0, 2).TrimStart('0') - @Html.row(firstTopic.Title)</h3>
  <ul>
  @foreach (var topic in group.Skip(1)) {
      <li>@String.Format("{0}.{1}",topic.RowKey.Substring(0, 2).TrimStart('0'),topic.RowKey.Substring(2, 2).TrimStart('0').PadLeft(1, '0')) - @Html.Raw(topic.Title)</li>
  }
  </ul>

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:33:52.230

```
 @{bool isFirst = true;}
    @foreach (Content topic in Model.Topics)
    {
        if (topic.RowKey.Substring(2, 2) == "00")
        {
            if(!isFirst) {
               <text></ul></text>
               isFirst = false
            }
            <h3>@topic.RowKey.Substring(0, 2).TrimStart('0') - @Html.Raw(topic.Title)</h3>
        }
        else
        {   
            <li>
            <p>@String.Format("{0}.{1}",topic.RowKey.Substring(0, 2).TrimStart('0'),topic.RowKey.Substring(2, 2).TrimStart('0').PadLeft(1, '0')) - @Html.Raw(topic.Title)</p></li>
        }
    }

    </ul> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:44:25.370

创建模型父子模型会更容易，在将其发送到视图之前填充

该模型

```
public class topic {

        //everything else
        public List<topic> subtopic{ get; set; }

    } 
```

风景

```
@foreach (Content topic in Model.Topics)
{
    <h3>@topic.RowKey.Substring(0, 2).TrimStart('0') - @Html.Raw(topic.Title)</h3>
    if (topic.subtopic.count > 0)
    {
        <ul>
            @foreach (Content subtopic in topic.subtopic)
            { 
                <li>@String.Format("{0}.{1}", topic.RowKey.Substring(0, 2).TrimStart('0'), topic.RowKey.Substring(2, 2).TrimStart('0').PadLeft(1, '0')) - @Html.Raw(topic.Title)</li>
            }
        </ul>
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:44:39.177

它与剃须刀无关，这是您可以使用任何渲染引擎、Web 或 Windows 窗体或其他任何东西来解决的问题。

```
@model List<Topic>
@{
int currentKey = 0;
bool withinUL = false;
foreach (Topic topic in Model) 
{ 
    if (topic.RowKey != currentKey)   
    {
        currentKey = topic.RowKey;
        if (withinUL)
        {
            withinUL = false;
            @:</ul>
        }

        @:<h3>@topic.RowKey - @Html.Raw(topic.Title)</h3>     

    }   
    else   
    {       
        if (!withinUL)
        {
            withinUL = true;
            @:<ul></ul>
        }
          @:<li>@topic.RowKey - @Html.Raw(topic.Title)</li>  
    }
}
} 
```

# javascript - jquery如何在使用json更改attr src时淡出和淡入图像

> ID：10952579
> 
> 赞同：0
> 
> 时间：2012-06-08T16:22:14.427
> 
> 标签：javascript, jquery, json

当使用 jquery 和 json 更改 attr src 时，我对如何淡入和淡出图像感到困惑。我已经正确更改了图像，但想添加褪色过渡。

任何帮助和建议将不胜感激。

下面是我的代码

```
function(){
                $j(".screenshots ul li#screen1").show();

                $j(".items div a").click(function (event) {
                    var id = $j(this).attr("href");
                    //$j(".screenshots ul li img").fadeOut();

                    $j.ajax({
                        url: "/?func=square_images/get_json&IMAGE_ID="+id,
                        dataType: "json",
                        success: function(data) {
                            $j("#screen1 img").attr("src", data.medium_medium_src);
                        }
                    });

                    event.preventDefault();
                });

            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:28:47.693

您可以在成功功能中尝试此操作

```
success: function(data) {
    $j("#screen1 img").fadeOut(100, function() {
       $(this).attr('src', data.medium_medium_src).load(function() {
          $(this).fadeIn();
       });
    })
} 
```

# wicked-pdf - wicked_pdf 车把/小胡子支持

> ID：10952580
> 
> 赞同：0
> 
> 时间：2012-06-08T16:22:21.537
> 
> 标签：wicked-pdf

我以前使用 wicked_pdf 和 erb，但我现在想使用 wicked_pdf 利用把手作为我的模板引擎。

这应该只适用于 wicked_pdf 吗？我看到带有haml标签的问题，所以我假设是的。只是想知道是否有人尝试过。

附带说明 - 有人使用带有 wicked_pdf 的演示者吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T09:45:49.117

当我使用 haml 时，我会执行以下操作，也许车把可能会发生类似的事情。

```
def [action-name]
  ...
  respond_to do |format|
    format.html
    format.pdf do
      render :pdf => 'filename',
             :handlers => [:haml]
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T14:26:29.147

它应该工作。

WickedPdf 只是挂钩到 Rails 的“渲染”方法，所以它可以做的任何事情都可以用 wicked_pdf 完成。

# php - PHP替代在HEREDOC内循环

> ID：10952581
> 
> 赞同：0
> 
> 时间：2012-06-08T16:22:22.610
> 
> 标签：php, sql, ajax, pdo, heredoc

我正在尝试在 php 中的 HEREDOC 内创建循环。我知道这样做是不可能的，但这是我告诉我需要帮助的最佳方式。这是我的代码：

```
<?
$sth = $dbh->prepare("SELECT field1, field2 FROM table WHERE id = '".$_GET['id']."'");
$sth->execute();
echo <<<HERE_DOC
    [
    while($row = $sth->fetch()){ 
        echo '{"optionValue":"'.$row['field1'].'", "optionDisplay": "'.$row['field2'].'"},'; 
    }
    ]
HERE_DOC;
?> 
```

它告诉我这个

```
 Parse error: syntax error, unexpected T_ENCAPSED_AND_WHITESPACE, expecting T_STRING or T_VARIABLE or T_NUM_STRING in /public_html/test.php on line 7 
```

我认为它会返回这个，因为不可能在 HEREDOC 内创建循环 - 但否则我该怎么做..？

该脚本由 AJAX 使用此脚本驱动：

```
<script type="text/javascript">
$(function(){
  $("select#state").change(function(){
    $.getJSON("test.php",{id: $(this).val(), ajax: 'true'}, function(j){
      var options = '';
      for (var i = 0; i < j.length; i++) {
        options += '<option value="' + j[i].optionValue + '">' + j[i].optionDisplay + '</option>';
      }
      $("select#city").html(options);
    })
  })
})
</script> 
```

原来的test.php是这样的：

```
if ($_GET['id'] == "1234") {
  echo <<<HERE_DOC
    [
    {"optionValue":"000", "optionDisplay": "a"},
    {"optionValue":"300", "optionDisplay": "s"},
    {"optionValue":"600", "optionDisplay": "d"},
    {"optionValue":"700", "optionDisplay": "cr"},
    {"optionValue":"500", "optionDisplay": "Gı"},
    {"optionValue":"400", "optionDisplay": "K"},
    {"optionValue":"800", "optionDisplay": "S"},
    {"optionValue":"900", "optionDisplay": "ik"},
    {"optionValue":"350", "optionDisplay": "Tu"}
    ]
HERE_DOC;
else if ($_GET['id'] == "2345") { etc...... 
```

问题是我已经拥有 SQL 数据库中的所有数据，我只想根据之前选择列表中的 id 返回数据，因为有很多选项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:25:19.553

不要自己制作 JSON，使用[`json_encode`](http://php.net/json_encode).

```
<?
$json = array();
$sth = $dbh->prepare("SELECT field1, field2 FROM table WHERE id = '".$_GET['id']."'");
$sth->execute();
while($row = $sth->fetch(PDO::FETCH_ASSOC)){ // added PDO::FETCH_ASSOC
    $json[] = array(
        'optionValue' => $row['field1'],
        'optionDisplay' => $row['field2']
    );
}
echo json_encode($json);
?> 
```

PS 不要那样`$_GET`直接使用。您很容易受到 SQL 注入的攻击。您已经在使用 PDO，请正确使用它。你应该这样做：

```
$sth = $dbh->prepare("SELECT field1, field2 FROM table WHERE id = ?");
$sth->execute(array($_GET['id'])); 
```

# python - 将 python cgi.print_environ() 和 cgi.print_form() 的输出写入文件

> ID：10952582
> 
> 赞同：1
> 
> 时间：2012-06-08T16:22:38.557
> 
> 标签：python, cgi

我正在尝试捕获输出`cgi.print_form()`并将`cgi.print_environ()`它们写入文件以供以后阅读，但它的行为似乎不像我预期的那样。

我希望这只是将模块的输出写入指定的路径，但我得到的是`cgi.print_form()`显示到页面的输出，没有 from `cgi.print_environ()`，`formpath`文件为空，并且`envpath`文件没有被创建。

当我将模块包装进去时，`str()`我得到`None`了两个文件。

这应该是一个快速测试，看看我从远程托管的表单中得到了什么，但它只是不起作用。

这是python 2.7.2

```
formfile = open(formpath, 'w')
formfile.write(cgi.print_form(form))
formfile.close()
envfile = open(envpath, 'w')
envfile.write(cgi.print_environ())
envfile.close() 
```

编辑：刚刚决定编写我自己的循环，但我仍在寻找一种方法来捕获`print_form`和`print_environ`函数输出。

```
for item in form:
     key = form.getfirst(item)
     fileitem = form[item]
     if fileitem.filename:
          formfile.write("%s is file %s\n" % (item, fileitem.filename))
          filepath = '../fmtmp/%s_%s_%s' % (tstamp, item, fileitem.filename)
          open(filepath, 'w').write(fileitem.file.read())
     else:
          formfile.write("%s = %s\n" % (item, key))
formfile.close()
envfile = open(envpath, 'w')
for var in os.environ:
     envfile.write("%s = %s\n" % (var, os.environ[var]))
envfile.close() 
```

这给了我将上传的任何内容保存为文件的额外好处。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:47:04.623

请注意，`x = cgi.print_environ()`如果在交互式提示中运行，仍然会输出内容（x 将为无）。CGI 通过标准输入/输出与 Web 服务器交互。print_environ() 只是打印到标准输出。重点是通过在浏览器中打印环境来轻松调试环境。

编辑：实际上将其发送到文件有点棘手。你可以试试：

```
f = open('file', 'w')
old = sys.stdout
sys.stdout = f
cgi.print_environ()
f.flush()
sys.stdout = old
f.close() 
```

# python - 用python制作一个基本的乘法程序

> ID：10952584
> 
> 赞同：0
> 
> 时间：2012-06-08T16:22:50.913
> 
> 标签：python, input, python-2.7

该程序的目标是让两个小于 12 的随机数相乘并让用户猜测答案。到目前为止我有这个。. .

```
import random

g=0
while g<10:
    variable_1 = random.randint (0,13)
    variable_2 = random.randint (0,13)

    answer = variable_1 * variable_2
    guess = input("What is 'variable_1' x 'variable_2'?")

    if guess == answer:
        print "Correct!"
    else:
        print "Incorrect!" 
```

问题是输入框字面意思是“什么是 Variable_1 x Variable_2？”。但是，我希望它在输入框中具有变量的值。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T16:35:52.923

试试这个：

```
guess = input("What is %d x %d?" % (variable_1, variable_2)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:29:35.527

```
querystr="What is "+str(variable_1)+" x "+str(variable_2)+"?"; 
```

那么你也能

```
guess=input(querystr); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T16:49:47.433

```
from random import randint

def val(lo=1, hi=12):
    return randint(lo, hi)

def main():
    right = 0
    reps = 10
    for rep in range(reps):
        v1, v2 = val(), val()
        target = v1 * v2

        guess = int(raw_input("What is {} * {}?".format(v1, v2)))

        if guess==target:
            print("Very good!")
            right += 1
        else:
            print("Sorry - it was {}".format(target))

    print("You got {} / {} correct.".format(right, reps)) 
```

# android - android着色自定义按钮

> ID：10952589
> 
> 赞同：0
> 
> 时间：2012-06-08T16:23:16.390
> 
> 标签：android, button

我创建了一个带有选择器的自定义按钮：

```
 <?xml version="1.0" encoding="utf-8"?>
    <selector xmlns:android="http://schemas.android.com/apk/res/android">
        <item android:drawable="@drawable/button_np"
            android:state_enabled="false"/>
        <item android:drawable="@drawable/button_np_pressed"
            android:state_pressed="true"/>
        <item android:drawable="@drawable/button_np"
            android:state_focused="true"/>
        <item android:drawable="@drawable/button_np"/>
    </selector> 
```

我希望能够通过使用灰色按钮作为图像来为该按钮着色，然后用我定义的颜色对其进行着色。

那可能吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:42:59.793

确实有可能（至少在代码中），您设置了一个滤色器。

```
import android.graphics.PorterDuff;

Button.getBackground().setColorFilter(0xFF00FF00,PorterDuff.Mode.MULTIPLY);  //  Green
Button.getBackground().setColorFilter(0xFFFF0000,PorterDuff.Mode.MULTIPLY);  // Red 
```

只需选择您的颜色并将它们放在 setColorFilter 参数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T09:43:56.047

是的，它工作得很好，我在我的中使用它，只需创建一个[9Patch](http://developer.android.com/tools/help/draw9patch.html "http://developer.android.com/tools/help/draw9patch.html")按钮并将图像的名称放在您拥有“@drawable/button_np”的位置，“button_pn”是您的按钮图像的名称

# database - 将带有 CLOB 的 SQLite 表批量加载到 Oracle 数据库中的有效方法

> ID：10952602
> 
> 赞同：1
> 
> 时间：2012-06-08T16:23:57.203
> 
> 标签：database, oracle, sqlite, import, export

我有 SQLite 数据库，其中包含要推送到 Oracle 数据库中的数据。一些 SQLite 表比较大，有几十万行，所以一次插入一行是非常缓慢的。我知道 SQL*Loader for Oracle 之类的工具~~，但我认为有些 CLOB 表会导致 SQL*Loader 出现问题（这似乎需要一个分隔的平面文件和某种控制文件）。~~为了使事情变得更复杂，一些数据可能存在于 Oracle 数据库中，所以我希望它进行合并而不是插入。

从 SQLite 中获取数据（除了 CSV，由于 CLOB 而无法工作）并将其导入 Oracle 的最有效方法是什么？**编辑**：似乎 SQL*Loader 是我将数据导入 Oracle 的最佳选择，并且确实可以以多种不同方式处理导入 CLOB。有人对从 SQLite 数据库创建控制和数据文件有任何提示吗？

# spring - Maven 下载 Spring-AOP 3.0.0.RC3 而不是 3.1.1.Final

> ID：10952603
> 
> 赞同：1
> 
> 时间：2012-06-08T16:24:00.647
> 
> 标签：spring, maven, aop

我正在尝试从 Maven 升级 spring-aop。我试图从我的 .m2 存储库中删除所有 Spring 文件，但是，当我运行 mvn dependency:tree 时，我看到 3.0.0.RC3 而不是 3.1.1.final ...

依赖树：

```
[INFO] com.abercrombie.loyalty:LoyaltyProvider:war:0.0.1-SNAPSHOT
[INFO] +- org.springframework:spring-aop:jar:3.0.0.RC3:compile
[INFO] +- org.springframework:spring-beans:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-context:jar:3.1.1.RELEASE:compile
[INFO] |  \- org.springframework:spring-asm:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-context-support:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-core:jar:3.1.1.RELEASE:compile
[INFO] |  \- commons-logging:commons-logging:jar:1.1.1:compile
[INFO] +- org.springframework:spring-expression:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-jdbc:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-orm:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-tx:jar:3.1.1.RELEASE:compile
[INFO] |  \- aopalliance:aopalliance:jar:1.0:compile
[INFO] +- org.springframework:spring-web:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-test:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-webmvc:jar:3.1.1.RELEASE:compile
[INFO] +- com.thoughtworks.xstream:xstream:jar:1.3.1:compile
[INFO] |  \- xpp3:xpp3_min:jar:1.1.4c:compile
[INFO] +- com.ibm.db2:db2jcc:jar:2.10.113:compile
[INFO] +- com.ibm.db2:db2jcc_license:jar:2.10.113:compile
[INFO] +- org.hibernate:hibernate-core:jar:3.5.6-Final:compile
[INFO] |  +- antlr:antlr:jar:2.7.6:compile
[INFO] |  +- commons-collections:commons-collections:jar:3.1:compile
[INFO] |  +- dom4j:dom4j:jar:1.6.1:compile
[INFO] |  |  \- xml-apis:xml-apis:jar:1.0.b2:compile
[INFO] |  +- javax.transaction:jta:jar:1.1:compile
[INFO] |  \- org.slf4j:slf4j-api:jar:1.5.8:compile
[INFO] +- org.hibernate:hibernate-annotations:jar:3.5.6-Final:compile
[INFO] |  +- org.hibernate:hibernate-commons-annotations:jar:3.2.0.Final:compile
[INFO] |  \- org.hibernate.javax.persistence:hibernate-jpa-2.0-api:jar:1.0.0.Final:compile
[INFO] +- commons-dbcp:commons-dbcp:jar:1.4:compile
[INFO] |  \- commons-pool:commons-pool:jar:1.5.4:compile
[INFO] +- org.slf4j:slf4j-simple:jar:1.5.6:compile
[INFO] +- javassist:javassist:jar:3.12.1.GA:compile
[INFO] +- cglib:cglib:jar:2.2.2:compile
[INFO] |  \- asm:asm:jar:3.3.1:compile
[INFO] +- com.sun.xml.bind:jaxb-impl:jar:2.1.12:compile
[INFO] |  \- javax.xml.bind:jaxb-api:jar:2.1:compile
[INFO] |     +- javax.xml.stream:stax-api:jar:1.0-2:compile
[INFO] |     \- javax.activation:activation:jar:1.1:compile
[INFO] +- com.sun.jersey:jersey-core:jar:1.11:compile
[INFO] +- com.sun.jersey:jersey-server:jar:1.11:compile
[INFO] \- com.sun.jersey.contribs:jersey-spring:jar:1.11:compile
[INFO]    \- com.sun.jersey:jersey-servlet:jar:1.11:compile 
```

POM 依赖项

```
<spring.version>3.1.1.RELEASE</spring.version>
<dependency>
   <groupId>org.springframework</groupId>
   <artifactId>spring-aop</artifactId>
   <version>${spring.version}</version>
</dependency>
<dependency>
   <groupId>org.springframework</groupId>
   <artifactId>spring-beans</artifactId>
   <version>${spring.version}</version>
</dependency>
<dependency>
   <groupId>org.springframework</groupId>
   <artifactId>spring-context</artifactId>
   <version>${spring.version}</version>
   </dependency>
<dependency> 
```

如何使用 3.1.1.Final 获得它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T20:15:52.120

您的其他依赖项之一几乎肯定是传递性地引入不同版本的 spring。我确认如果我添加对 jersey-spring 的依赖项，我会得到一个旧版本的 spring-aop。您只需添加一个`dependencyManagement`部分即可修复它。为了演示这个问题，请尝试将以下内容放入一个空的 maven 项目中：

```
<dependencies>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-aop</artifactId>
        <version>3.1.1.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>com.sun.jersey.contribs</groupId>
        <artifactId>jersey-spring</artifactId>
        <version>1.11</version>
    </dependency>
</dependencies>
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aop</artifactId>
            <version>3.1.1.RELEASE</version>
        </dependency>
    </dependencies>
</dependencyManagement> 
```

看看输出`mvn dependency:tree`。您将看到正确的 spring-aop 版本。然后删除该`dependencyManagement`部分。这将是一个旧版本。删除对 j​​ersey-spring 的依赖，你又得到了正确版本的 spring-aop。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T20:19:44.203

My guess would be that you may have dependency declared somewhere else (e.g. dependencyManagement section in this or parent project). Try to run `mvn help:effective-pom` to see the actual pom and then work from there.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-23T10:01:46.020

Spring AOP 依赖于其他 jar 使用**mvn dependency:tree**来查看完整的细节。哪个罐子取决于其他罐子。

# java - 关于“冗余'静态'修饰符”警告

> ID：10952605
> 
> 赞同：15
> 
> 时间：2012-06-08T16:24:02.360
> 
> 标签：java

在`public interface Constants`我宣布

```
static final boolean        TREAT_AS_SOURCE     = true 
```

并收到一条消息，它是一个冗余声明为`static`.

帮助我理解这是为什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-08T16:24:56.903

接口中声明的所有字段成员都默认为`public`，`static`因此`final`，再次说它是多余的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T16:26:31.163

`public, static and final`默认情况下，接口中的字段。

# php - PHP 参考（和号）

> ID：10952608
> 
> 赞同：3
> 
> 时间：2012-06-08T16:24:08.373
> 
> 标签：php, reference

我正在学习PHP，我想问一下参考资料，

**我的问题：** 当你用 (&) 定义函数和当你用 (&) 调用函数时，参数有什么区别，换句话说，当我把 (&) 放在我调用函数之间的定义时有什么区别/ 带 (&) 的参数，谢谢大家，祝您有美好的一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:46:51.860

> 当您想使用函数查找应该将引用绑定到哪个变量时，按引用返回很有用。不要使用按引用返回来提高性能。引擎会自行自动优化。仅在您有正当的技术理由时才返回参考资料。要返回引用，请使用以下语法：

来自 PHP 手册[Returning References](http://php.net/manual/en/language.references.return.php)

# php - 性能：PHP 中的空字符串或 null

> ID：10952612
> 
> 赞同：2
> 
> 时间：2012-06-08T16:24:41.897
> 
> 标签：php, types, null, string

由于 PHP 在字符串操作和输出中平等对待它们，我想知道什么是最佳实践，分配/连接一个`null`值或一个空字符串：

```
$lang = 'lang';
$suffix = null;
$lang .= $suffix; 
```

或者

```
$desc = 'name';
$suffix = '';
$desc .= $suffix; 
```

内联条件也可能是这种情况：

```
<div class="item<?= $is_selected ? ' selected' : null ?>"></div> 
```

或者

```
<div class="item<?= $is_selected ? ' selected' : '' ?>"></div> 
```

我知道它不会影响整体性能，但它可以与使用双引号或单引号相比吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T17:28:27.813

```
> php --version
PHP 5.3.12 with Suhosin-Patch (cli) (built: May  9 2012 11:44:31) 
Copyright (c) 1997-2012 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2012 Zend Technologies
    with Suhosin v0.9.33, Copyright (c) 2007-2012, by SektionEins GmbH 
```

```
php > $start = microtime(true); for( $i = 0; $i < 1000000; ++$i ) { $str = 'foo'; $str .= null; } printf('%.5f', microtime(true) - $start);
0.15258
php > $start = microtime(true); for( $i = 0; $i < 1000000; ++$i ) { $str = 'foo'; $str .= ''; } printf('%.5f', microtime(true) - $start);
0.11397 
```

跑了几次，每次都得到非常相似的结果。

结论：

*   将空字符串附加到字符串比附加到空字符串要**快得多**`null`。
*   除非您在具有**数十亿**次迭代的循环中执行此操作，否则从性能的角度来看这并不重要，因此请使用具有更好语义意义的循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:33:47.403

空字符串和空字符串在 PHP 中并不完全相同。

[Null（请参阅 PHP 文档）](http://www.php.net/manual/en/language.types.null.php)基本上是“没有价值”，应该在尚未设置某些内容时使用。当某事是`null`，`is_null($var)`将是真实的。

一个空字符串仍然是一个字符串，只是长度为 0。当你知道你有一个字符串但它没有内容时，你应该使用它。

所以真的取决于你的情况使用哪一个。当它们显示为字符串或回显时，两者都不会打印任何内容，但在内部它们仍然不同。在我看来，虽然对于这种情况，我会使用空字符串：

```
<div class="item<?= $is_selected ? ' selected' : '' ?>"></div> 
```

# javascript - 如何找到数字的长度？

> ID：10952615
> 
> 赞同：215
> 
> 时间：2012-06-08T16:24:57.687
> 
> 标签：javascript, jquery

我想在 JavaScript 或 jQuery 中获取数字的长度？

我试过`value.length`没有任何成功，我需要先将它转换为字符串吗？

* * *

## 回答 #1

> 赞同：400
> 
> 时间：2012-06-08T16:26:21.813

```
var x = 1234567;

x.toString().length; 
```

这个过程也适用于也适用`Float Number`于`Exponential number`。

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2012-06-08T16:36:20.563

好的，这么多答案，但这是一个纯粹的数学答案，只是为了好玩或记住数学很重要：

```
var len = Math.ceil(Math.log(num + 1) / Math.LN10); 
```

这实际上给出了数字的“长度”，即使它是指数形式。`num`这里应该是一个非负整数：如果是负数，取其绝对值，然后调整符号。

## ES2015 更新

现在这[`Math.log10`是一件事](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/log10)，你可以简单地写

```
const len = Math.ceil(Math.log10(num + 1)); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2017-06-26T17:53:20.030

也可以使用模板字符串：

```
const num = 123456
`${num}`.length // 6 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-06-08T16:27:08.617

您必须将数字变为字符串才能获取长度

```
var num = 123;

alert((num + "").length); 
```

或者

```
alert(num.toString().length); 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-03-13T23:18:34.237

我一直在 node.js 中使用这个功能，这是我迄今为止最快的实现：

```
var nLength = function(n) { 
    return (Math.log(Math.abs(n)+1) * 0.43429448190325176 | 0) + 1; 
} 
```

它应该处理正整数和负整数（也是指数形式），并且应该以浮点数返回整数部分的长度。

以下参考资料应提供对该方法的一些见解： [Weisstein, Eric W. “Number Length”。来自 MathWorld--Wolfram 网络资源。](http://mathworld.wolfram.com/NumberLength.html)

我相信一些按位运算可以代替 Math.abs，但是 jsperf 表明 Math.abs 在大多数 js 引擎中都可以正常工作。

**更新**：如评论中所述，此解决方案存在一些**问题**:(

**Update2（解决方法）**：我相信在某些时候会出现精度问题，并且`Math.log(...)*0.434...`行为会出乎意料。但是，如果 Internet Explorer 或移动设备不是您的一杯茶，您可以将此操作替换为该`Math.log10`功能。在 Node.js 中，我使用该函数编写了一个快速的基本测试，`nLength = (n) => 1 + Math.log10(Math.abs(n) + 1) | 0;`并且`Math.log10`它按预期工作。请注意，这`Math.log10`不是普遍支持的。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-03-12T20:24:29.027

你应该选择最简单的（stringLength），可读性总是胜过速度。但是，如果您关心速度，以下是一些。

三种不同的方法都以不同的速度。

```
// 34ms
let weissteinLength = function(n) { 
    return (Math.log(Math.abs(n)+1) * 0.43429448190325176 | 0) + 1;
}

// 350ms
let stringLength = function(n) {
    return n.toString().length;
}

// 58ms
let mathLength = function(n) {
    return Math.ceil(Math.log(n + 1) / Math.LN10);
}

// Simple tests below if you care about performance.

let iterations = 1000000;
let maxSize = 10000;

// ------ Weisstein length.

console.log("Starting weissteinLength length.");
let startTime = Date.now();

for (let index = 0; index < iterations; index++) {
    weissteinLength(Math.random() * maxSize);
}

console.log("Ended weissteinLength length. Took : " + (Date.now() - startTime ) + "ms");

// ------- String length slowest.

console.log("Starting string length.");
startTime = Date.now();

for (let index = 0; index < iterations; index++) {
    stringLength(Math.random() * maxSize);
}

console.log("Ended string length. Took : " + (Date.now() - startTime ) + "ms");

// ------- Math length.

console.log("Starting math length.");
startTime = Date.now();

for (let index = 0; index < iterations; index++) {
    mathLength(Math.random() * maxSize);
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-12-11T01:34:15.703

有三种方法可以做到这一点。

```
var num = 123;
alert(num.toString().length); 
```

更好的表现一（在ie11中表现最好）

```
var num = 123;
alert((num + '').length); 
```

数学（在 Chrome、Firefox 中性能最好，但在 ie11 中最慢）

```
var num = 123
alert(Math.floor( Math.log(num) / Math.LN10 ) + 1) 
```

这里有一个jspref [http://jsperf.com/fastest-way-to-get-the-first-in-a-number/2](http://jsperf.com/fastest-way-to-get-the-first-in-a-number/2)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-06-08T16:27:40.923

首先将其转换为字符串：

```
var mynumber = 123;
alert((""+mynumber).length); 
```

向其添加空字符串将隐式导致`mynumber`变成字符串。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-06-08T16:28:49.167

好吧，无需将整数转换为字符串，您就可以制作一个时髦的循环：

```
var number = 20000;
var length = 0;
for(i = number; i > 1; ++i){
     ++length;
     i = Math.floor(i/10);
}

alert(length);​ 
```

演示：http: [//jsfiddle.net/maniator/G8tQE/](http://jsfiddle.net/maniator/G8tQE/)

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2019-03-22T18:24:00.773

我在一次测试中被问到类似的问题。

> 查找数字的长度而不转换为字符串

```
const numbers = [1, 10, 100, 12, 123, -1, -10, -100, -12, -123, 0, -0]

const numberLength = number => {

  let length = 0
  let n = Math.abs(number)

  do {
    n /=  10
    length++
  } while (n >= 1)

  return length
}

console.log(numbers.map(numberLength)) // [ 1, 2, 3, 2, 3, 1, 2, 3, 2, 3, 1, 1 ] 
```

添加了负数使其更加复杂，因此使用了 Math.abs()。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-12-10T12:57:10.443

一种整数或整数部分长度的方法，无需平庸转换为`string`：

```
var num = 9999999999; // your number
if (num < 0) num = -num; // this string for negative numbers
var length = 1;
while (num >= 10) {
   num /= 10;
   length++;
}
alert(length); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-10-05T19:54:31.797

我想更正@Neal 答案，这对整数来说非常好，但在前一种情况下，数字 1 将返回长度 0。

```
function Longueur(numberlen)
{
    var length = 0, i; //define `i` with `var` as not to clutter the global scope
    numberlen = parseInt(numberlen);
    for(i = numberlen; i >= 1; i)
    {
        ++length;
        i = Math.floor(i/10);
    }
    return length;
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-04-07T09:33:41.567

我对将给定数字转换为字符串感到困惑，因为这样的算法不会很健壮并且容易出错：它会显示出它的所有局限性，尤其是在它必须评估非常长的数字的情况下。事实上，在将长数转换为字符串之前，它会“折叠”成等效的**指数符号**（例如：1.2345e4）。此表示法将被转换为字符串，并将评估此结果字符串以返回其长度。所有这些都会给出错误的结果。所以我建议不要使用这种方法。

查看以下代码并运行代码片段以比较不同的行为：

```
let num = 116234567891011121415113441236542134465236441625344625344625623456723423523429798771121411511034412365421344652364416253446253446254461253446221314623879235441623683749283441136232514654296853446323214617456789101112141511344122354416236837492834411362325146542968534463232146172368374928344113623251465429685;
let lenFromMath;
let lenFromString;

// The suggested way:
lenFromMath = Math.ceil(Math.log10(num + 1)); // this works in fact returns 309

// The discouraged way:
lenFromString = String(num).split("").length; // this doesn't work in fact returns 23

/*It is also possible to modify the prototype of the primitive "Number" (but some programmer might suggest this is not a good practice). But this is will also work:*/

Number.prototype.lenght = () => {return Math.ceil(Math.log10(num + 1));}

lenFromPrototype = num.lenght();

console.log({lenFromMath, lenFromPrototype, lenFromString});
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-06-08T16:28:26.230

试试这个：

```
$("#element").text().length; 
```

[它的使用示例](http://jsfiddle.net/USpYk/)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-12-27T15:41:19.820

是的，您需要转换为字符串才能找到长度。例如

```
var x=100;// type of x is number
var x=100+"";// now the type of x is string
document.write(x.length);//which would output 3. 
```

# c# - 如何从 interface.System.Linq.IQueryable 更改 var 到类 System.Collections.generic.List

> ID：10952617
> 
> 赞同：0
> 
> 时间：2012-06-08T16:25:00.833
> 
> 标签：c#

我有以下代码：

```
var allWorkorders =

            (from wo in context.WORKORDERs
            join wot in context.WORKORDERTYPEs on wo.wot_oi equals wot.wotyoi
            join pri in context.PRIORITies on wo.prio_oi equals pri.priooi
            join s in context.SITEs on wo.BEparn_oi equals s.siteoi
            where wo.audt_created_dttm.Value.Year >= now.Year - 3 && wo.audt_created_dttm.Value.Year >= 2006
                && wo.audt_created_dttm < timeframe && (s.id == "NM" || s.id == "TH") &&
                (wo.clsdt_date ?? new DateTime(3000, 01, 01)) < DateTime.Now
            group pri by new {s.id, pri.prioid, MonthNum = (wo.clsdt_date ?? new DateTime(3000, 01, 01)).Year * 100 +
                (wo.clsdt_date ?? new DateTime(3000, 01, 01)).Month} into groupItem
            orderby groupItem.Key.MonthNum, groupItem.Key.id
            select new {groupItem.Key.id, groupItem.Key.prioid, groupItem.Key.MonthNum, Unit = groupItem.Count()});

            allWorkorders.GroupBy(x => new { x.id, x.MonthNum }).Select(x => new {x.Key.id, x.Key.MonthNum,
            Denominator = x.Sum(y => y.Unit), Numerator = x.Where(y => SqlMethods.Like(y.prioid, "1%") || 
            SqlMethods.Like(y.prioid, "6%")).Sum(y => y.Unit), Data_Indicator = DATA_INDICATOR,
            Budgeted = budgetedPlannedOutageHrs, Industry_Benchmark = INDUSTRY_BENCHMARK,
            Comments = comments, Executive_Comments = executiveComments, 
            Fleet_Exec_Comments = fleetExecComments}).ToList(); 
```

我想创建一个 for 循环：

```
for (int counter = 0; counter < allWorkorders.Count; counter++)
{
    var item = allWorkorders[counter];
    ...... 
```

但是，我收到以下错误：“‘<’不能应用于‘int’和‘方法组’类型的操作数”

因此，即使我将 allWorkorders 转到 ToList()，它也不会被识别为列表。

我究竟做错了什么？我过去曾这样做过，最大的不同是在过去的情况下，我的 ToList 位于 select 语句的末尾。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:32:19.557

它正在尝试使用 LINQ 扩展方法方法`Count()`而不是`List<T>.Count`

这样做的原因是您没有将结果分配`ToList()`给任何东西。这整个语句基本上被忽略了，因为你没有使用返回值

```
allWorkorders.GroupBy(x => new { x.id, x.MonthNum }).Select(x => new {x.Key.id, x.Key.MonthNum,
Denominator = x.Sum(y => y.Unit), Numerator = x.Where(y => SqlMethods.Like(y.prioid, "1%") || 
SqlMethods.Like(y.prioid, "6%")).Sum(y => y.Unit), Data_Indicator = DATA_INDICATOR,
Budgeted = budgetedPlannedOutageHrs, Industry_Benchmark = INDUSTRY_BENCHMARK,
Comments = comments, Executive_Comments = executiveComments, 
Fleet_Exec_Comments = fleetExecComments}).ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:33:00.887

您没有将第二行（带有 ToList() 的那一行）分配给任何内容。您结束了 allWorkOrders 的分配：“Unit = groupItem.Count()});”

删除 ToList() 将使其返回一个列表，但是由于您没有将其分配给任何内容，因此它会立即超出范围并丢失它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T16:32:09.463

ToList() 返回一个结果。你需要类似的东西

```
var newList = allWorkorders.GroupBy(x => ...).Select(x => ...).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:31:39.257

您可以改用 foreach 循环，也可以将 () 添加到 Count, `for (int counter = 0; counter < allWorkorders.Count(); counter++)`。`.Count`在这种情况下，Count 不是属性，而是您在 IEnumerable 上调用的 Linq 扩展方法，这就是为什么当您只给出方法组而不是调用方法时它会抱怨方法组`.Count()`。

此外，您在那里有两个单独的语句，并且似乎没有将您正在执行的部分存储在`.ToList()`任何地方。

# php - 禁止查看 Apache 上的特定文件

> ID：10952623
> 
> 赞同：0
> 
> 时间：2012-06-08T16:25:36.807
> 
> 标签：php, apache, file, .htaccess, file-permissions

在我的站点中，我的应用程序使用了一些文件，其中放置了日志信息。例如，一个日志文件是“access.log”，我用 PHP 写入。如果访问者访问 www.mysite.ext/access.log ，可以看到文件和其中的所有信息。我怎么能禁止这个？多谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T16:29:21.787

把这个放在你的`.htaccess`

```
<FilesMatch "\.(htaccess|htpasswd|pinc|ini|phps|fla|psd|log|sh)$">
 Order Allow,Deny
 Deny from all
</FilesMatch> 
```

将阻止`.log`您不希望人们访问的其他常见文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T16:29:58.597

如果您想在 Apache 中执行此操作，您可以将以下内容添加到您的 .htaccess 中：

```
<files access.log>
deny from all
</files> 
```

# nunit - Jenkins NUnit/XUnit 测试说明：如何将它们导入结果中？

> ID：10952625
> 
> 赞同：1
> 
> 时间：2012-06-08T16:25:48.277
> 
> 标签：nunit, xunit, jenkins-plugins

问候和问候：

我正在寻找如何确保当您单击给定的测试结果时，我已验证的测试描述会显示在测试结果中。示例：我有一个测试“My_Test_One”，其描述为“这是测试之一”。当 Jenkins 用户单击测试结果并向下钻取到 My_Test_One 时，他们将看到描述。我如何将该描述输入詹金斯？

我一直在寻找以下两个插件来解决这个问题：

*   詹金斯 NUnit 插件
*   xUnit 插件

在查看 Jenkins JIRA 网站和许多 Google 搜索几天后，我不得不承认我被难住了。任何你有任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T02:47:14.653

xUnit 插件似乎去掉了描述。

我正在使用 NUnit，并且在我的测试中正确地有一个[描述属性。](http://nunit.org/index.php?p=description&r=2.5)

NUnit 的 XML 输出显示了描述，但是当 XUnit 聚合我的测试结果时，它会删除描述字段。

NUnit 也支持[ProperyAttributes](http://nunit.org/index.php?p=property&r=2.5)，但 XUnit 插件也将这些去掉。

我还尝试使用[TestCaseSourceAttributes](http://nunit.org/index.php?p=testCaseSource&r=2.5)以某种方式即时修改测试的名称，这导致测试甚至没有显示在测试结果中。

由于我们已经准备好使用 Jenkins 进行测试运行（因为我们将它用于所有构建和环境维护），所以我将寻求获取我们的原始 NUnit XML 输出并从中生成一些 SSRS 报告以供测试人员使用。

# java - 带有 Mockito.when() 和泛型类型推断的奇怪泛型边缘案例

> ID：10952629
> 
> 赞同：9
> 
> 时间：2012-06-08T16:26:09.040
> 
> 标签：java, generics, mockito

我正在编写一个使用`java.beans.PropertyDescriptor`using Mockito 的测试用例，并且我想模拟`getPropertyType()`返回任意`Class<?>`对象（在我的情况下为`String.class`）的行为。通常，我会通过调用来做到这一点：

```
// we already did an "import static org.mockito.Mockito.*"
when(mockDescriptor.getPropertyType()).thenReturn(String.class); 
```

然而，奇怪的是，这不会编译：

```
cannot find symbol method thenReturn(java.lang.Class<java.lang.String>) 
```

但是当我指定类型参数而不是依赖于推断时：

```
Mockito.<Class<?>>when(mockDescriptor.getPropertyType()).thenReturn(String.class); 
```

一切都很好。在这种情况下，为什么编译器不能正确推断 when() 的返回类型？我以前从来没有像那样指定参数。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-08T17:00:38.913

`PropertyDescriptor#getPropertyType()`返回一个 的对象`Class<?>`，其中的`?`意思是“这是一种类型，但我不知道它是什么”。我们称这种类型为“X”。因此`when(mockDescriptor.getPropertyType())`创建了一个`OngoingStubbing<Class<X>>`，其方法`thenReturn(Class<X>)`只能接受 的对象`Class<X>`。但是编译器不知道这个“X”是什么类型，所以它会抱怨你传入*任何*类型的 a `Class`。我认为这与编译器抱怨调用.*`add(...)``Collection<?>`*

 *当您明确指定方法`Class<?>`上的类型时`when`，您并不是说`mockDescriptor.getPropertyType()`返回 a `Class<?>`，而是说`when`返回 a `OngoingStubbing<Class<?>>`。然后，编译器检查以确保您传入的任何内容都是`when`匹配的类型`Class<?>`；由于`getPropertyType()`返回`Class<X>`我前面提到的“”，它当然与`Class<?>`您指定的匹配。

所以基本上

```
// the inferred type is Class<"some type">
Mockito.when(mockDescriptor.getPropertyType())

// the specified type is Class<"any type">
Mockito.<Class<?>>when(mockDescriptor.getPropertyType()) 
```

在我的 IDE 中，原始代码的错误消息是

```
The method thenReturn(Class<capture#1-of ?>) in the type OngoingStubbing<Class<capture#1-of ?>> is not applicable for the arguments (Class<String>) 
```

那`capture#1-of ?`就是我上面描述的“X”。*

# java - 尝试使用 Ajax、Spring、REST 和 JAXB 但出现错误

> ID：10952630
> 
> 赞同：0
> 
> 时间：2012-06-08T16:26:08.883
> 
> 标签：java, ajax, spring, spring-mvc, jaxb

尝试使用 Ajax、Spring、REST 和 JAXB 但出现错误......我正在尝试从 Ajax 到 Spring 的 REST 调用。我收到以下错误..

这是我的 JSP：

```
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>This is a project to show how to use RESTful</title>
</head>
<body>
<script type="text/javascript">var contexPath = "<%=request.getContextPath()%>";</script>
<script src="<%=request.getContextPath()%>/js/jquery.js"></script>

<script type="text/javascript">
function doAjaxPost() {  

    alert("doAjaxPost Called");

     var queryString = $('#htmlform').serialize();

       $.ajax({
            contentType : "application/json",
            dataType : 'json',
            type : "PUT",
            url : contexPath + "/service/employee",
            data : queryString, //json serialization (like array.serializeArray() etc)

            success : function(data) {
                alert("Thanks for submitting.  \n\n" + response.result);
               // response
            },
            error : function(request, status, error) {
                   alert('Error: ' + e); 
            }
        });
    }  
</script>

<H1>Add Employee</H1>

<p>
<form name="htmlform">
<table border=1>
    <thead><tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
    </tr></thead>

    <tr>
        <td><input  type="text" name="ID" maxlength="5" size="3"></td>
        <td><input  type="text" name="Name" maxlength="10" size="10"></td>
        <td><input  type="text" name="Email" maxlength="10" size="10"></td>
    </tr>

</table>
<input type="button" value="Save Employee" onclick="doAjaxPost();" />
<p>
<p>
</form>
[<a href="http://localhost:8080/RESTful/service/employees">List all Employees</a> | <a href="add.jsp">Employee Form Test</a>]

</body>
</html> 
```

这是我的控制器中的代码：

```
@RequestMapping(method=RequestMethod.PUT, value="/employee")
    public ModelAndView updateEmployee(@RequestBody String body) {
        System.out.println("in put");
        Source source = new StreamSource(new StringReader(body));
        Employee e = (Employee) jaxb2Mashaller.unmarshal(source);

        System.out.println(e.toString());

        return new ModelAndView(XML_VIEW_NAME, "object", e);
    } 
```

现在是错误....

```
2012-06-08 12:21:58,280 [http-8080-2] DEBUG org.springframework.web.bind.annotation.support.HandlerMethodInvoker - Invoking request handler method: public org.springframework.web.servlet.ModelAndView dw.spring3.rest.controller.EmployeeController.updateEmployee(java.lang.String)
in put
2012-06-08 12:21:58,300 [http-8080-2] DEBUG org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerExceptionResolver - Resolving exception from handler [dw.spring3.rest.controller.EmployeeController@7b0b23cf]: org.springframework.oxm.UnmarshallingFailureException: JAXB unmarshalling exception; nested exception is javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.]
2012-06-08 12:21:58,303 [http-8080-2] DEBUG org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver - Resolving exception from handler [dw.spring3.rest.controller.EmployeeController@7b0b23cf]: org.springframework.oxm.UnmarshallingFailureException: JAXB unmarshalling exception; nested exception is javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.]
2012-06-08 12:21:58,303 [http-8080-2] DEBUG org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver - Resolving exception from handler [dw.spring3.rest.controller.EmployeeController@7b0b23cf]: org.springframework.oxm.UnmarshallingFailureException: JAXB unmarshalling exception; nested exception is javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.]
2012-06-08 12:21:58,303 [http-8080-2] DEBUG org.springframework.web.servlet.DispatcherServlet - Could not complete request
org.springframework.oxm.UnmarshallingFailureException: JAXB unmarshalling exception; nested exception is javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.]
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.convertJaxbException(Jaxb2Marshaller.java:761)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:682)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:665)
    at dw.spring3.rest.controller.EmployeeController.updateEmployee(EmployeeController.java:49)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:436)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:424)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:800)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:640)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:679)
Caused by: javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.]
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.createUnmarshalException(AbstractUnmarshallerImpl.java:335)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.createUnmarshalException(UnmarshallerImpl.java:481)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:199)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:168)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:157)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:125)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:678)
    ... 27 more
Caused by: org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:198)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:177)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:391)
    at com.sun.org.apache.xerces.internal.impl.XMLScanner.reportFatalError(XMLScanner.java:1391)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:1034)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:625)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:116)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:488)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:819)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:748)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1208)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:525)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:195)
    ... 31 more
Jun 8, 2012 12:21:58 PM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet rest threw exception
org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 1; Premature end of file.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:198)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:177)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:391)
    at com.sun.org.apache.xerces.internal.impl.XMLScanner.reportFatalError(XMLScanner.java:1391)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:1034)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:625)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:116)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:488)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:819)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:748)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1208)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:525)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:195)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:168)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:157)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:125)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:678)
    at org.springframework.oxm.jaxb.Jaxb2Marshaller.unmarshal(Jaxb2Marshaller.java:665)
    at dw.spring3.rest.controller.EmployeeController.updateEmployee(EmployeeController.java:49)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:436)
    at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:424)
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:923)
    at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    at org.springframework.web.servlet.FrameworkServlet.doPut(FrameworkServlet.java:800)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:640)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:679) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:18:04.670

看起来您正在以 json 格式发送对象并尝试使用 jaxb (xml) 对其进行解组。它显然给了你一个例外。

如果类路径中有 jackson，则从 JSON 中解组应该是自动的。你只需要一个参数`@RequestBody Employee employee`而不是`@RequestBody String body`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T20:05:45.363

这可能会有所帮助.. [http://blog.springsource.org/2010/01/25/ajax-simplifications-in-spring-3-0/](http://blog.springsource.org/2010/01/25/ajax-simplifications-in-spring-3-0/)

# c# - 分割 WPF 窗口

> ID：10952636
> 
> 赞同：2
> 
> 时间：2012-06-08T16:26:50.400
> 
> 标签：c#, .net, wpf, xaml, window

我想将我的窗口（wpf）分成三列：左列必须是`DockPanel`（我认为`StackPanel`不会起作用`Canvas`），右列应该是另一个`DockPanel`持有 a `listbox`，中间我需要有一个`Canvas`.

这就是我所做的，我对左列有问题，因为它不可扩展。我需要左列作为自定义对象的持有者，以便用户可以将它们拖放到画布上。请指教。

```
<DockPanel LastChildFill="True" Background="LightGray" Margin="5">
   <Expander Header="Controls" Background="Gray" Margin="2" 
             Content="{StaticResource FC}" DockPanel.Dock="Top" 
             IsExpanded="True" Width="200" />
</DockPanel>

<GridSplitter Focusable="False" Width="2" Background="LightGray"
              VerticalAlignment="Stretch" HorizontalAlignment="Right"/>

<lib:MyCanvas x:Name="myCanvas" FlowDirection="LeftToRight"  
         Background="White" AllowDrop="True" 
         Mouse.MouseMove="MyCanvas _MouseMove">
</lib:MyCanvas > 
```

另外，右侧应该使用什么控件才能容纳列表框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:43:41.280

您**可以**在网格内嵌入另一个网格、画布或其他类型的容器，您不必这样做。但是根据定义，您有一个`GridSplitter`so ，它需要放在 a 内`Grid`以提供其功能，否则它不会做任何事情。

听起来你想做这样的事情：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="5" />
        <ColumnDeifnition Width="*" />
        <ColumnDefinition Width="100" /> <!-- whatever size you need here --->
    </Grid.ColumnDefinitions>

    <DockPanel LastChildFill="True" Background="LightGray" Margin="5" Grid.Column="0">
      <Expander Header="Controls" Background="Gray" Margin="2" 
           Content="{StaticResource FC}" DockPanel.Dock="Top" 
                  IsExpanded="True" Width="200" />
   </DockPanel>
   <GridSplitter Focusable="False" Width="2" Background="LightGray" Grid.Column="1"
                    VerticalAlignment="Stretch" HorizontalAlignment="Stretch" ResizeDirection="Columns"/>

    <lib:MyCanvas x:Name="myCanvas" FlowDirection="LeftToRight"  Grid.Column="2"
         Background="White" AllowDrop="True" 
               Mouse.MouseMove="MyCanvas _MouseMove">
    </lib:MyCanvas >

    <ListBox Grid.Column="3" ... />
</Grid> 
```

此布局为您提供 3 列，第 2 列是您的拆分器，可让您调整前 2 列的大小（在它们之间来回滑动），并且您的第 3 列是固定大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T18:24:06.417

查看您提出的各种问题，您似乎正在考虑构建类似于 Visual Studio 的应用程序。我建议您查看 CodeProject 上与您的要求类似的一系列精彩文章，即拥有工具箱、各种工具箱项目、设计器、在设计器上拖放项目等 -

WPF 图表设计器 -[第 4](http://www.codeproject.com/Articles/24681/WPF-Diagram-Designer-Part-4)部分、[第 3](http://www.codeproject.com/Articles/23871/WPF-Diagram-Designer-Part-3)部分、[第 2](http://www.codeproject.com/Articles/23265/WPF-Diagram-Designer-Part-2)部分、[第 1 部分](http://www.codeproject.com/Articles/22952/WPF-Diagram-Designer-Part-1)

您只需在右侧添加一个 PropertyGrid 并将您在设计器中选择的 ToolBox 项目与它绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:42:11.813

`Grid`用 3创建一个`columns`。对于第一个和第三个把一个`DockPanel`作为孩子。

我认为一般规则是不要把别人置于 之下`canvas`，而不是反过来。

# macos - 根据 NSOutlineView 高度动态调整 NSWindow 大小

> ID：10952643
> 
> 赞同：2
> 
> 时间：2012-06-08T16:27:26.060
> 
> 标签：macos, cocoa, nsview, nswindow, appkit

我已经阅读了许多有关动态调整 NSWindows 大小的问题的答案，但还没有什么效果。

我已经构建了一个类似“弹出框”的窗口，以便从菜单栏显示，我不能使用 NSPopover，因为它在设计方面不够可定制。我的视图层次结构当前如下所示：

```
NSWindow Subclass
  - NSView (clears the titlebar rendering, draws popover arrow)
     - NSView (contentView)
        - NSOutlineView (main table of content)
        - NSView (window footer) 
```

我需要的是使窗口随着 NSOutlineView 中的项目扩展和收缩而扩展和收缩，以便窗口始终是大纲视图、页脚和顶部弹出箭头的正确高度。

我有方法可以根据内容计算大纲视图所需的高度。到目前为止，我一直在尝试重新计算在`awakeFromNib`内容视图控制器上调用时的大小，然后再次在委托方法上`outlineViewItemDidCollapse:`重新计算大小`outlineViewItemDidExpand:`，但我永远无法正确调整窗口大小。

我尝试了很多不同的方法，但都没有奏效。有没有“规范”的方法来做到这一点？我见过人们谈论`-[NSWindow frameForContentRect:]`这类问题，但我不太清楚这是怎么回事。

也许我正在以完全错误的方式解决这个问题，但我希望不会。看起来这应该是可能的，它只是在正确的地方得到正确的东西。不幸的是，GUI 编程对我来说不是一个强项。我会很感激人们有任何想法或解决方案。

谢谢。

**编辑：**这已解决，部分原因是标记的答案，部分原因是其他一些原因。清除 NSView 没有自动调整大小的掩码，所以我将其设置为向各个方向扩展，这有助于解决一些调整大小的问题。此外，我用于计算所需高度的方法并不完全正确，并且存在一些问题。

通过提供的答案，在某些情况下找到所需高度的方法很好，但我没有可以测量的“根”项目。这是可能需要考虑的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T21:16:19.390

这是我的方法，效果很好，但可能有比这更好的方法。

```
- (void)outlineViewItemDidExpand:(NSNotification *)notification {
    [self resizeWindowHeight];
}
- (void)outlineViewItemDidCollapse:(NSNotification *)notification {
    [self resizeWindowHeight];
}
- (void)resizeWindowHeight {
    NSRect wRect = [myWindow frame];
    NSRect oRect = [myoutlineView rectOfRow:([myoutlineView numberOfRows] - 1)]; //get rect of last row
    CGFloat n = oRect.origin.y + oRect.size.height + 22;
    wRect.origin.y = wRect.origin.y + (wRect.size.height - n);
    wRect.size.height = n;
    [myWindow setFrame:wRect display:YES animate:YES];
} 
```

数字**22**是：（顶部窗口 - 顶部大纲）+ 大纲标题的高度 + 水平滚动条的高度 +（底部窗口 - 底部大纲）+ 工具栏的高度

我在**IB**中的这个例子的设置：没有水平滚动条和没有标题，Outline 的高度 = 窗口的 contentView 的高度，所以 22 是窗口边框。

如果您有工具栏或水平滚动条被自动隐藏，您需要在代码中添加条件来检查（工具栏和滚动条）的可见性并相应地更改高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T18:40:34.803

一种方法是记录轮廓视图的初始高度和窗口的初始高度，然后随着轮廓视图高度的变化，计算窗口的新高度=旧高度+（新轮廓高度-旧轮廓高度）。通过仅根据初始状态的更改工作，它使事情变得更加灵活。如果您从头开始重新计算事物的大小，您不必在代码中复制整个布局。您可以使用 IB 对窗口进行布局，它应该保留该布局，而无需代码了解太多细节。您可以在 IB 中更新布局，并且代码仍然有效。

否则，我建议您展示您尝试过的内容并解释它是如何不正确的。

# c++ - boost::shared_ptr 的析构函数阻塞了唯一的线程

> ID：10952645
> 
> 赞同：3
> 
> 时间：2012-06-08T16:27:28.350
> 
> 标签：c++, boost, locking, shared-ptr

我正在将一个 C++ 程序从 FreeBSD 移植到 RHEL。当我测试我的程序时，我发现调用 boost::shared_ptr::~shared_ptr() 时进程会挂起。

我使用 gdb 附加挂起进程，堆栈跟踪是：

```
(gdb) bt
#0  0x00e01430 in __kernel_vsyscall ()
#1  0x00bd8d96 in __pause_nocancel () from /lib/libpthread.so.0
#2  0x00bd30b2 in __pthread_mutex_lock_full () from /lib/libpthread.so.0
#3  0x04a60a26 in pthread_mutex_lock () from /lib/libc.so.6
#4  0x08069b61 in boost::detail::lightweight_mutex::scoped_lock::scoped_lock(boost::detail::lightweight_mutex&) ()
#5  0x080699d3 in boost::detail::sp_counted_base::release() ()
#6  0x08069999 in boost::detail::shared_count::~shared_count() ()
#7  0x08069952 in boost::shared_ptr<SS::Conf::SSConfNode>::~shared_ptr() ()
#8  0x00124fde in SS::Conf::SSConfManager::createConfFile(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) () from /home/y/lib/libSS_conf.so.1
#9  0x00125e0c in SS::Conf::SSConfManager::createAllConfFiles() () from /home/y/lib/libSS_conf.so.1
#10 0x0012946b in SS::Conf::SSConfManager::initFromDisk(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) () from /home/y/lib/libSS_conf.so.1
#11 0x00129c3b in SS::Conf::SSConfManager::configure(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) () from /home/y/lib/libSS_conf.so.1
#12 0x00156d0c in SS::Init::configure() () from /home/y/lib/libSS_init.so.1
#13 0x0805ac63 in SS::Main::init() ()
#14 0x0807117e in main () 
```

而我的进程只包含一个线程：

```
(gdb) info thread
* 1 Thread 0xf77a8a40 (LWP 16724)  0x00c54430 in __kernel_vsyscall () 
```

当我在头文件中取消定义**BOOST_HAS_THREADS**并重建程序时，一切顺利。

boost 版本是 1.32，我在 RHEL4.8 上使用 gcc 3.4.6-11。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T17:29:19.217

我不确定问题是什么，但这可能是[1.32 文档](http://www.boost.org/doc/libs/1_32_0/libs/smart_ptr/shared_ptr.htm#ThreadSafety)中的相关部分：

> `shared_ptr`用于`Boost.Config`检测实现是否支持线程。如果您的程序是单线程的，但您的平台被自动检测`Boost.Config`为支持多线程，`#define BOOST_DISABLE_THREADS`以消除线程安全开销。

因此，考虑使用`#define BOOST_DISABLE_THREADS`而不是 undefined `BOOST_HAS_THREADS`。

这是[1.33 及更高版本的文档](http://www.boost.org/doc/libs/1_42_0/libs/smart_ptr/shared_ptr.htm#ThreadSafety)：

> 从 Boost 版本 1.33.0 开始，`shared_ptr`在以下平台上使用无锁实现：
> 
> *   x86 或 x86-64 上的 GNU GCC；
> *   IA64 上的 GNU GCC；
> *   PowerPC 上的 Metrowerks CodeWarrior；
> *   PowerPC 上的 GNU GCC；
> *   视窗。
> 
> 如果您的程序是单线程的并且没有链接到任何可能在其默认配置中使用 shared_ptr 的库，您可以`#define`在项目范围内使用宏`BOOST_SP_DISABLE_THREADS`切换到普通的非原子引用计数更新。
> 
> （`BOOST_SP_DISABLE_THREADS`在某些（但不是全部）中定义翻译单元在技术上违反了单一定义规则和未定义的行为。然而，实现尝试尽最大努力满足在这些翻译单元中使用非原子更新的请求。不保证， 尽管。）
> 
> 您可以定义宏`BOOST_SP_USE_PTHREADS`以关闭特定于平台的无锁实现并回退到`pthread_mutex_t`基于通用的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:07:38.273

最后我找到了原因。我的主程序使用 boost 1.32 构建，但我的 .so 文件之一是使用 boost 1.38 构建的。运行我的程序并导致此问题时，有 2 个 shared_ptr 实现。在我用 boost 1.32 重建我的 so 文件后，程序运行良好。

# sharepoint - 自定义 FieldRenderingControl Sharepoint 2010

> ID：10952649
> 
> 赞同：0
> 
> 时间：2012-06-08T16:27:38.150
> 
> 标签：sharepoint, sharepoint-2010, custom-fields

我已经在空共享点项目中创建了一个自定义字段，并且我已经覆盖了 FieldRenderingControl，因此我可以在显示列表中的项目时创建自己的表格布局。

我遇到的问题是渲染控件类中的 ItemFieldValue 始终为空。

如何获取要显示的字段的字段值？

这是我的自定义字段类

```
namespace CustomFieldDefinitions.Fields
{
    public class AttributeField : SPField
    {
        #region Constructors

        /// <summary>
        /// This is a constuctor with two parameters.
        /// </summary>
        /// <param name="fields"></param>
        /// <param name="fieldName"></param>
        public AttributeField(SPFieldCollection fields, string fieldName)
            : base(fields, fieldName)
        {
        }

        /// <summary>
        /// This is a contructor with three parameters.
        /// </summary>
        /// <param name="fields"></param>
        /// <param name="typeName"></param>
        /// <param name="displayName"></param>
        public AttributeField(SPFieldCollection fields, string typeName, string displayName)
            : base(fields, typeName, displayName)
        {
        }

        #endregion

        #region Overridden Properties

        /// <summary>
        /// This ties the control used to support this field with the current implementation of it.
        /// </summary>
        public override BaseFieldControl FieldRenderingControl
        {
            [SharePointPermission(SecurityAction.LinkDemand, ObjectModel = true)]
            get
            {
                BaseFieldControl fieldControl = new AttributeFieldControl();
                fieldControl.FieldName = this.InternalName;
                return fieldControl;
            }
        }

        public override object GetFieldValue(string value)
        {
            return base.GetFieldValue(value);
        }

        #endregion

    }
} 
```

还有我的 FieldRenderingControl 类

```
namespace CustomFieldDefinitions.FieldControls
{
    public class AttributeFieldControl : BaseFieldControl
    {
        protected Label AttributeValueForDisplay;
        protected TextBox AttributeValueTextbox;

        public override string DisplayTemplateName
        {
            get
            {
                 return "AttributeFieldDisplayControl";
            }
            set
            {
                base.DisplayTemplateName = value;
            }
        }

        protected override string DefaultTemplateName
        {
            get
            {
                 if (this.ControlMode == SPControlMode.Display)
                {
                    return this.DisplayTemplateName;
                }
                else
                {
                    return "AttributeFieldControl";
                }
            }
        }

        protected override void CreateChildControls()
        {
            if (this.Field != null)
            {
                 base.CreateChildControls();

                 this.AttributeValueForDisplay = (Label)TemplateContainer.FindControl("lblAttValue");
                 this.AttributeValueTextbox = (TextBox)TemplateContainer.FindControl("txtAttValue");

                 if (ControlMode == SPControlMode.New || ControlMode == SPControlMode.Edit)
                 {
                     AttributeValueTextbox.Text = Convert.ToString(this.ListItemFieldValue);
                 }
                 else
                 {
                     AttributeValueForDisplay.Text = Convert.ToString(this.ListItemFieldValue);
                 }
            }
        }
    }
} 
```

最后是标记

```
<%@ Assembly Name="$SharePoint.Project.AssemblyFullName$" %>
<%@ Assembly Name="Microsoft.Web.CommandUI, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Register Tagprefix="SharePoint" Namespace="Microsoft.SharePoint.WebControls" Assembly="Microsoft.SharePoint, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Register Tagprefix="Utilities" Namespace="Microsoft.SharePoint.Utilities" Assembly="Microsoft.SharePoint, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Register Tagprefix="asp" Namespace="System.Web.UI" Assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" %>
<%@ Import Namespace="Microsoft.SharePoint" %> 
<%@ Register Tagprefix="WebPartPages" Namespace="Microsoft.SharePoint.WebPartPages" Assembly="Microsoft.SharePoint, Version=14.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Control Language="C#" %>
<SharePoint:RenderingTemplate ID="AttributeFieldDisplayControl" runat="server">
    <Template>
        <asp:Label ID="lblAttValue" runat="server" BorderColor="Red"></asp:Label>
    </Template>
</SharePoint:RenderingTemplate>
<SharePoint:RenderingTemplate ID="AttributeFieldControl" runat="server">
    <Template>
        <asp:TextBox ID="txtAttValue" runat="server" BorderColor="Red"></asp:TextBox>
    </Template>
</SharePoint:RenderingTemplate> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T18:10:02.993

请在附件中找到这个问题的答案。我是个大白痴。当我的 BdcModel 的 ReadItem 方法被调用时，我没有设置传递给显示页面的对象的“AttributeValue”属性。

因此，一旦我补充说一切正常。感谢所有看过这篇文章的人。我很抱歉浪费了你的时间。

# c++ - 在 C++/Python 代码中更改参数值

> ID：10952652
> 
> 赞同：3
> 
> 时间：2012-06-08T16:27:53.800
> 
> 标签：c++, python, boost-python

我的问题如下：我有一个无法随意修改的 C++ 代码（不是由我编写的，并且在某些知识产权限制下）。我必须通过 Python main 将它与 Python 代码链接起来。我使用 boost::python 进行反射。在代码中的某个位置，C++ 函数使用 C++ 函数的 Python 重载函数来修改参数。这个函数在 Python 中使用时效果很好。但是当被 C++ 函数调用时，在 C++ 中不会考虑对参数的修改。为了对问题进行建模，我编写了一个简化版本，旨在隔离我的问题。

以下是 C++ 类：

```
#include <iostream>
using namespace std;
#include <boost/ref.hpp>

//Class aimed at modeling a C++ user's type that should be used in Python
class C
{
public:
    double myC;
    C(){}
    ~C(){}

    void setValue(double val) {
        myC = val;
    }

    double getValue() {
        return myC;
    }
};

/*
    This class will be derived in Python
    We want to be sure that:
    - void (g) and non void (f) functions are properly reflected and extended in Python
    - a function (h) with a local type (C) will properly use the python overloaded     function of a C++ function (g)
*/

class A
{
public:
    A(){int A_x=0;}
    virtual ~A(){}
    virtual int f(int Ivar){
        Ivar = 0;
        return Ivar;
    }
    virtual void g(C * myC){
        C calledC;
        cout << "I should not be here" << endl;   //When B::setparam call g, it should be the Python g, not the virtual function from base class
        calledC.setValue(0.);
        //return *myC;
    }
    C h(){                  //This function wont be overloaded in Python
        C myC;
        //myC.setValue(0.);
        this->g(&myC);      //We want myC to be modified, and the python overloaded version of g to be used
        cout << "Value back in C++: " << myC.getValue() << endl; //We want to verify if myC has been modified back in C++
        return myC;
    }
};

/*
    This class will be called from a main in Python.
    It's function setparam is aimed at ensuring that Python extension of a C++ class is supported properly
*/

class B
{
public:
    B(A & a){
        setparam(a); 
    }
    B(){
        int u;
        u = 0;
    }
    virtual ~B(){}
    void setparam(A & a){
        a.h();              //Here the code should call the h overloaded function of the derived class of A in Python
    }
}; 
```

boost::python 包装器：

```
#include <boost/python.hpp>
#include <Python.h>
#include <object.h>
#include "ClassA.h"

#include <boost/python/module.hpp>
#include <boost/python/def.hpp>
#include <boost/python/implicit.hpp>
#include <iostream>
using namespace std;

using namespace boost::python;

/*
    A wrapper is used to allow overload of virtual A function
*/
struct WrapperClassA : A, boost::python::wrapper<A>{
    int f(int Ivar){
        if(override f = this->get_override("f")){
            return f(Ivar);
        }
        else {
            return A::f(Ivar);
        }
    }
    int default_f(int Ivar){
        return this->A::f(Ivar);
    }

    void g(C * myC){
        if(override g = this->get_override("g")){
                    g(myC);
        }
        else {
            A::g(myC);
        }
    }
    void default_g(C * myC){
        this->A::g(myC);
    }
};

/*
    Refection of necessary classes and functions for Python
*/
BOOST_PYTHON_MODULE(myWrapper){
    class_<WrapperClassA, boost::noncopyable>("A", init<>())
    .def("f", &A::f, &WrapperClassA::default_f)
    .def("g", &A::g, &WrapperClassA::default_g)
    ;

    class_<B, boost::noncopyable>("B", init<>())
    .def("setparam", &B::setparam)
    ;

    class_<C>("C", init<>())
    .def("setValue", &C::setValue)
    .def("getValue", &C::getValue)
    .def_readwrite("myC", &C::myC)
    ;
} 
```

蟒蛇代码：

```
from math import *
# C++ library
from myWrapper import *

"""
    Extension of C++ class A
    APy should be used when A type argument is called
    g should be able to use a C++ C type object and to modify it
    The constructor call g in order to verify that myC is treated as mutable within Python
"""
class APy(A):
    def __init__(self):
        A.__init__(self)
        n = 0
        x = 0.
        myC = C()
        self.g(myC)
        print("value after a 1st call within Python: " + repr(myC.getValue()))

    def f(self, n):
        n = 5
        return n

    def g(self, myC):
        x = 7.0
        myC.setValue(x)
        print("value in Python: " + repr(myC.getValue()))

"""
    Main
    myB.setparam should be able to pass a APy argument
"""
myA = APy()
myB = B()
myB.setparam(myA) 
```

当我运行代码时， print("python 中的值：" + repr(myC.getValue())) 打印 7，但 cout << myC.getValue() << endl print 0 而我希望变量位于7\. 感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T14:54:02.530

这里的问题是，当您`C`在 call 中将实例转换为 Python 时`g(myC)`，Boost.Python 使用的是按值转换器而不是浅转换器（即它复制`C`实例），即使您已经传递了一个指针。

这是设计使然：当您将 C++ 指针传递给 Python 时，Boost.Python 会确保 Python 代码不必担心其他 C++ 代码会在 Python 层仍然可以访问它的情况下删除它，因为这可以导致危险的记忆错误。确保这一点的唯一方法是复制对象。

如果您想强制 Boost.Python`myC`通过引用传递对象，请使用`g(boost::python::ptr(myC))`（或者`g(boost::ref(*myC))`如果您知道它不为空），但请注意这是危险的；您需要确保 Python 的实现`g()`不会试图在其生命周期之外保留其参数。

您可以在这里找到更多信息：

[http://www.boost.org/doc/libs/1_48_0/libs/python/doc/v2/callbacks.html](http://www.boost.org/doc/libs/1_48_0/libs/python/doc/v2/callbacks.html)

您还可以使用`boost::shared_ptr`将参数传递给 Python，而无需以安全的方式进行复制：

[boost python：如何调用 C++ 虚函数](https://stackoverflow.com/questions/10539373/boost-python-how-to-call-a-c-virtual-function/10568175#10568175)

# jquery - 如何在 $.each() 期间检查当前 JSON 元素是哪个用户定义类型？

> ID：10952654
> 
> 赞同：1
> 
> 时间：2012-06-08T16:27:57.730
> 
> 标签：jquery, json, google-maps, google-maps-api-3

JSON 文件的结构如下：

```
({condos:[{Address:'123 Fake St.', Lat:'56.645654', Lng:'23.534546'},{... another condo ...},{...}],houses:[{Address:'1 Main Ave.', Lat:'34.765766', Lng:'27.8786674'},{... another house ...}, {...}]}) 
```

所以，我在一个大的 JSON 数组中有一个*公寓*和*房屋的列表。*

我想将它们全部绘制在我的地图上，但我想为*公寓*和*房屋提供*不同的标记图标（*公寓*的**蓝色**标记，*房屋的***绿色**标记）。

 ****`$.each()`我遇到的问题是 - 当我通过它们时弄清楚如何区分标记类型。我将如何`if`检查我目前是在*公寓*还是*房子里*工作？

```
var markers = null;
$('#map').gmap(mapOptions).bind('init', function(){
    $.post('getMarkers.php', function(json){
        markers = json;
        $.each(markers, function(type, dataMembers) {
            $.each(dataMembers, function(i, j){
                //if house use house.png to create marker
                $('#map').gmap('addMarker', { 'position': new google.maps.LatLng(parseFloat(Lat), parseFloat(Lng)), 'bounds':true, 'icon':'house.png' } );
                //if condo use condo.png
                $('#map').gmap('addMarker', { 'position': new google.maps.LatLng(parseFloat(Lat), parseFloat(Lng)), 'bounds':true, 'icon':'condo.png' } );
            });
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:36:48.710

您有一个嵌套集合 - 一个具有两个成员（公寓和房屋）的对象，每个成员都包含多个子对象。您似乎已经将该类型作为外部`each()`循环的一部分，所以只需使用它：

```
...
        markers = json;
        $.each(markers, function(type, dataMembers) { // <- right here
            $.each(dataMembers, function(i, j){
                if (type == 'house') {
                    $('#map').gmap('addMarker', { 'position': new google.maps.LatLng(parseFloat(Lat), parseFloat(Lng)), 'bounds':true, 'icon':'house.png' } );
                }
                else if (type == 'condo') {
                    $('#map').gmap('addMarker', { 'position': new google.maps.LatLng(parseFloat(Lat), parseFloat(Lng)), 'bounds':true, 'icon':'condo.png' } );
                }
            });
        });
... 
```****

# android - Android，如何在图像上添加电影标记（符号）？

> ID：10952658
> 
> 赞同：3
> 
> 时间：2012-06-08T16:28:16.517
> 
> 标签：android, imageview, watermark

在我的应用程序中，我有一个明亮的视图。每行包括左侧的缩略图和右侧的一些文本。

我可以从服务器获取图像并膨胀行。关于列表的一切都是正确的。就像这张图片：

![在此处输入图像描述](../Images/ff36398358cbdbdcf6fd91d7905c575e.png)

当用户点击行视频将播放。我需要为图像添加视频符号，例如： ![在此处输入图像描述](../Images/51344e68827a4bfcc0412bfd0e5c3d88.png) 在每个图像的顶部。是否可以将此图像添加到我的图像视图之上？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T16:41:13.927

说，你的播放图标是透明的，然后使用覆盖技术在你的 imageview 图像上绘制这个播放图标。只需使用以下功能：

```
 public Bitmap putOverlay(Bitmap bmp1, Bitmap overlay) {
        Bitmap bmOverlay = Bitmap.createBitmap(bmp1.getWidth(), bmp1.getHeight(), Bitmap.Config.ARGB_8888);
        Canvas canvas = new Canvas(bmOverlay);
        Paint paint = new Paint(Paint.FILTER_BITMAP_FLAG);

            canvas.drawBitmap(bmp1, 0, 0, null); 
            canvas.drawBitmap(overlay, 0, 0, null);       

        return bmOverlay;
    } 
```

传递相应图像视图的图像和另一个图像（例如：播放图标），它返回一个合并的图像，您可以将其设置为您的图像视图。您还可以扩展 ImageView 类并重写 onDraw 方法来完成它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-05T06:48:39.580

您可以像这样添加 moive simbol/icon

```
 public Bitmap putOverlay(Bitmap source) {
    Canvas canvas = new Canvas(source);
    Bitmap icon = BitmapFactory.decodeResource(MainApplication.getInstance().getResources(), R.drawable.video_icon);

    float left = (source.getWidth() / 2) - (icon.getWidth() / 2);
    float top = (source.getHeight() / 2) - (icon.getHeight() / 2);

    canvas.drawBitmap(icon, left, top, null);   

    return source;
} 
```

# php - 2 单元测试控制器以验证操作是否创建了新记录

> ID：10952664
> 
> 赞同：0
> 
> 时间：2012-06-08T16:28:40.367
> 
> 标签：php, unit-testing, cakephp

当我对成员控制器的注册操作进行单元测试时，如何断言在我的成员的测试数据库中创建了一条新记录？

我正在尝试使用 getLastInsertID 但我不知道如何加载 Member 模型来进行调用。

我已经对我的会员模型进行了涵盖注册和激活的测试，但是当我完成激活过程时出现错误。我想在控制器中使用测试来验证是否可以注册新成员，然后使用两个测试激活。

**更新** 我添加`App::uses('Member', 'Model');`到我的控制器测试，还有

```
 public function setUp() {
    parent::setUp();
    $this->Member = ClassRegistry::init('Member');
  } 
```

在函数 testRegister 我有：

```
 $data = array(
      'Member' => array(
        'first_name' => 'Foo',
        'last_name' => 'Bar',
        'email' => 'foobar@example.org',
        'password' => 'password',
        'password_confirmation' => 'password',
        'security_question' => 0, // Your father's middle name?
        'security_answer' => 'Randolf the great',
      ),
    );
    $result = $this->testAction(
      '/Members/register',
      array('data' => $data, 'method' => 'post')
    );
    debug($result);

    $this->assertTrue($this->Member->validationErrors);
    $this->assertTrue($this->Member->getLastInsertId()); 
```

断言显示“无法断言 array() 为真”和“无法断言 null 为真”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:54:15.103

I was able to find enough information in `$this->vars` to find the record with my Model. Everything tests out now.

# c# - 如何仅在最少字符后检查密码强度？

> ID：10952665
> 
> 赞同：3
> 
> 时间：2012-06-08T16:28:44.000
> 
> 标签：c#, asp.net, .net, asp.net-mvc, asp.net-ajax

我正在使用 AjaxControlToolKit 的 PasswordStrength 控件。一旦用户开始在控件中输入任何内容，它就会开始显示密码很弱的消息。我希望此消息仅在输入最少字符数后出现。我在控件上看不到任何允许此功能的内容。关于我应该如何处理这个问题的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:36:20.290

附加到文本输入的客户端事件。在那里，您可以在（如果您使用文本）中添加/删除一个特殊的 CSS 类，只需一条规则：（使用文本长度作为条件）。~~`change`~~ `keyup``TextCssClass``display: none`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:59:13.493

您可能需要为此推出自己的解决方案，如果您考虑一下，这是有道理的。通过隐藏两个字符的密码很弱的视觉提示，但为三个字符的密码显示它似乎意味着两个字符的密码就足够了。

话虽这么说，你*可能*会写一些类似于这样的hack：

```
<script language="javascript">
  function onPasswordChange(textBox) {
      var passwordLabel = document.getElementById([labelID]);
      if(textBox.value.length < [constant]){
          passwordLabel.style.display = 'none';
      }
      else{
          passwordLabel.style.display = 'inline';            
      } 
  }
</script> 
```

然后，您可以附加此函数，控件~~更改~~onKeyUp 或 onKeyDown 事件，以便如果密码字段的长度小于您想要的长度，它将隐藏包含未达到强度的消息的标签。这是未经测试的，只是一个想法。您可能会遇到工具包 javascript 与此脚本冲突的问题，但很难说。

此外，labelID 看起来是 [controlIDName]_PasswordStrength。

编辑：

您可能希望像这样（代码后面）将~~onchange onKeyUp 或 onKeyDown 事件添加到您的控件中：~~

~~control.Attributes.Add("onchange", "onPasswordChange(this)");~~

```
 control.Attributes.Add("onKeyDown", "onPasswordChange(this)"); 
```

编辑2：就黑客而言，这非常混乱，但它确实有效。客户端：

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>

<asp:TextBox ID="password" runat="server"></asp:TextBox>
<div id="PasswordStrengthContainer"></div>
<asp:PasswordStrength ID="PS" runat="server"
TargetControlID="password"  
DisplayPosition="RightSide"  
StrengthIndicatorType="Text"  
PreferredPasswordLength="10"  
PrefixText="Strength:"  
TextCssClass="TextIndicator_TextBox1"  
MinimumNumericCharacters="0"  
MinimumSymbolCharacters="0"  
RequiresUpperAndLowerCaseCharacters="false"  
TextStrengthDescriptions="Very Poor;Weak;Average;Strong;Excellent"  
TextStrengthDescriptionStyles="cssClass1;cssClass2;cssClass3;cssClass4;cssClass5"  
CalculationWeightings="50;15;15;20"
/>

 <script language="javascript">

function onPasswordChange(textBox) {
    var passwordLabel = document.getElementById("MainContent_password_PasswordStrength");
    var container = document.getElementById("PasswordStrengthContainer");

    if (passwordLabel != null) {
        document.getElementById("PasswordStrengthContainer").appendChild(
            document.getElementById("MainContent_password_PasswordStrength"));
    }

    if (textBox.value.length < 4) {
        container.style.display = 'none';
    }
    else {
        container.style.display = 'inline';
    }
}
 </script> 
```

服务器端：

```
 password.Attributes.Add("onKeyDown", "onPasswordChange(this)");
 password.Attributes.Add("onBlur", "onPasswordChange(this)"); 
```

此代码效率不高，可以清理，但可用于演示目的。javascript 函数非常基本，但是您会注意到这一行：

```
 if (passwordLabel != null) {
        document.getElementById("PasswordStrengthContainer").appendChild(
            document.getElementById("MainContent_password_PasswordStrength"));
    } 
```

不幸的是，工具包的 javascript 函数将在您的函数之后触发，因此将显示设置为“无”会被工具包清除。这段代码所做的是从页面中删除标签并将其放在 div 中，然后我们只需将 div 的 display 属性设置为任何内容，这将有效地隐藏标签。但是有一个单一的错误：当按退格键删除字符时，div 在某些情况下不会消失。我真的没有时间追查这个问题，但你应该很容易解决它。

此外，我在 Chrome 中的 onChange 上遇到了一些问题，所以选择了 onKeyDown，正如上面@Adriano 指出的那样。

# ruby - 在文件 $RUBY_HOME/rubygems/version.rb 上运行 gem 时“无法修改冻结的字符串”

> ID：10952669
> 
> 赞同：0
> 
> 时间：2012-06-08T16:28:51.000
> 
> 标签：ruby, rubygems

我在 RedHat RHEL 5.2 上从源代码编译了 ruby​​ 1.9.3-p134。

一切都很顺利，除了两件事。

**1** 当尝试从命令行运行 ruby​​ 时，它说在 /usr/bin/ruby 中找不到，但`which ruby`指向`/usr/local/bin/ruby`. 所以我创建了一个软链接`ln -s /usr/local/bin/ruby /usr/bin/ruby`，但是......

**2** gem 给我以下错误：

`$ gem`

```
/usr/local/lib/ruby/1.9.1/rubygems/version.rb:191:in `strip!': can't modify frozen String (RuntimeError)
       from /usr/local/lib/ruby/1.9.1/rubygems/version.rb:191:in `initialize'
       from /usr/bin/gem:14:in `new'
       from /usr/bin/gem:14:in `<main>' 
```

没有运气谷歌搜索，因为“无法修改冻结的字符串”是一个常见的 ruby​​ 错误。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:47:57.380

我可能有冲突的 gem 安装。

`find / -name gem 2>/dev/null`

```
/home/muradan/install_ruby/ruby-1.9.3-p194/bin/gem
/usr/lib64/ruby/gems/1.8/gems/rubygems-update-1.3.6/bin/gem
/usr/share/locale/gem
/usr/bin/gem        <----- which gem, doesn't work
/usr/local/bin/gem  <----- works 
```

所以我删除并软链接到/usr/local/bin/gem。

现在我遇到了其他 gem 的问题，比如 gemlocks（它不存在于 /usr/local/bin 或除非工作 /usr/bin 之外的任何其他地方）

啊！！为什么linux不一致！将应用程序安装到 /usr/bin 和一些安装到 /usr/local/bin 的意义何在？FML

# php - PHP JSON 响应数组

> ID：10952671
> 
> 赞同：0
> 
> 时间：2012-06-08T16:28:58.690
> 
> 标签：php, android, arrays, json

我有这个 php 代码。如您所见，我通过函数 showallevents 查询 mysql 数据库。我将 $result 返回到 $event 变量。使用while循环，我将从事件获得的值分配给响应数组，每次循环发生时，行都存储在数据数组中。我肯定在某个地方失败了，因为尽管我得到了正确数量的响应，但我在 json 获得的所有值都是“空”的。它还告诉我一些关于 JSONarray 无法转换为 jsonobject 的信息

```
 if (isset($_POST['tag']) && $_POST['tag'] != '') 
 {
// get tag
$tag = $_POST['tag'];

// include db handler
require_once 'include/DB_Functions.php';
$db = new DB_Functions();

// response Array
$response = array("tag" => $tag, "success" => 0, "error" => 0);

// check for tag type
if ($tag == 'showallevents') 
{
    // Request type is show all events
    // show all events
    $event = $db->showallevents();
    if ($event != false)
    {
    $data = array();
    while($row = mysql_fetch_assoc($event)) 
        {
        $response["success"] = 1;
        $response["uid"] = $event["uid"];
        $response["event"]["date"] = $event["date"];
        $response["event"]["hours"] = $event["hours"];
        $response["event"]["store_name"] = $event["store_name"];
        $response["event"]["event_information"] = $event["event_information"];
        $response["event"]["event_type"] = $event["event_type"];
        $response["event"]["Phone"] = $event["Phone"];
        $response["event"]["address"] = $event["address"];
        $response["event"]["created_at"] = $event["created_at"];
        $response["event"]["updated_at"] = $event["updated_at"];
        $data[]=$response;

        }
        echo json_encode($data);            
    }
    else 
    {
        // event not found
        // echo json with error = 1
        $response["error"] = 1;
        $response["error_msg"] = "Events not found";
        echo json_encode($response);
    }
}
  else 
 { 
echo "Access Denied"; 
 }
}
?> 
```

DB_Functions.php

```
 <?php

    class DB_Functions 
   {

private $db;

//put your code here
// constructor
function __construct() 
{
    require_once 'DB_Connect.php';
    // connecting to database
    $this->db = new DB_Connect();
    $this->db->connect();
}

// destructor
function __destruct()
{

}

/**
 * Select all events that are after yesterday.
 */
public function showallevents()
{
   $result = mysql_query("SELECT * FROM events WHERE date >= CURDATE()");
   return($result);
   }

   }

  ?> 
```

好的，帮助我将所有数据放入数组的代码是这样的

```
 $data = array();
            while($row = mysql_fetch_assoc($event)) 
        {
        $response["success"] = 1;
        $response["event"]= $row;
        $data[]=$response;
        }
        echo json_encode($data); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:32:50.437

你的`$response`变量是什么？在 PHP 中创建关联数组，你使用`=>`而不是`=`

例如：

```
$array = ('key1' => 'value1', 'key2' => 'value2'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:37:42.300

您合并了两段独立的代码，结果一团糟，结果不清楚。

您可以通过两种方式创建关联数组：

```
$array = (key=>value, key2=>value2); 
```

您还可以使用：

```
$array[key]=value;
$array[key2]=value2; 
```

请注意，“键”和“值”都只是变量；你可以在那里使用字符串，或者从其他地方传入一个变量。

在做类似的事情时，我使用以下方法：

```
 $response["success"] = 1;
    $response["uid"] = $event["uid"];
    $response["event"]["date"] = $event["date"];
    $response["event"]["hours"] = $event["hours"];
    $response["event"]["store_name"] = $event["store_name"];
    $response["event"]["event_information"] = $event["event_information"];
    $response["event"]["event_type"] = $event["event_type"];
    $response["event"]["Phone"] = $event["Phone"];
    $response["event"]["address"] = $event["address"];
    $response["event"]["created_at"] = $event["created_at"];
    $response["event"]["updated_at"] = $event["updated_at"];
    $data[]=$response; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:47:05.180

如果您只想返回所有数组，您可以使用 mysql_fetch_assoc 代替 mysql_fetch_row 吗？

```
 if ($tag == 'showallevents') 
{
    // Request type is show all events
    // show all events
    $event = $db->showallevents();
    if ($event != false)
    {
    $data = array();
    while($row = mysql_fetch_assoc($event)) 
        {
        $data[] = $row;
        echo json_encode($data);            
    }
    else 
    {
        // event not found
        // echo json with error = 1
        $response["error"] = 1;
        $response["error_msg"] = "Events not found";
        echo json_encode($response);
    }
}

     else
    {
echo "Access Denied";
   }
   }
  ?> 
```

# php - 使用 PHP 对不同于 1.05 的浮点数进行舍入

> ID：10952676
> 
> 赞同：3
> 
> 时间：2012-06-08T16:29:24.043
> 
> 标签：php

是否可以对一个数字进行四舍五入，如果它是 0.5，就留下它，任何低于 0.5 的向下舍入，高于 0.5 的任何向上舍入？

例如：

*   `5.0 * 1.35 = 6.75 // leave it`
*   `5.2 * 1.35 = 7.02 // round down to 7.00`
*   `5.5 * 1.35 = 7.56 // round up to 8.00`

我已经格式化了`round($n,0, PHP_ROUND_HALF_UP)`$n 是上面 calc 的乘积，它留下 6.75 但为下一个返回 7.02。我也尝试过`round($n,-1, PHP_ROUND_HALF_UP)`，它在第二次计算中给了我 7.00，但当然不会为第一次返回 6.75，而是返回 680。

这是一个票据标记计算，用户输入第一个数字并乘以第二个数字。我实际上删除了小数，因为他们不想看到它，并且他们希望对结果进行这种自定义的舍入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:36:51.043

在 PHP 中确定给定浮点数的最后一个非零数字的值的唯一方法是将其转换为字符串。

```
$str = (string) $float;
$result = ($str[strlen($str) - 1] == 5) ? $float : round($float); 
```

[例子](http://codepad.org/rjihTjgD)

当然，无论你做什么，都会因为[浮点精度](http://php.net/manual/en/language.types.float.php)问题而产生很小的误差。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:48:00.387

```
function myround($num, $prec) {
  $rhu = round($num, $prec, PHP_ROUND_HALF_UP);
  $rhd = round($num, $prec, PHP_ROUND_HALF_DOWN);

  return ($rhu + $rhd) / 2;
} 
```

适用于您喜欢的任何精度。对于百位，如示例中所示，`$prec`需要为 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:38:12.673

```
$n = round($n, 2);
if($n % .05 != 0 || $n % .1 == 0)
{
  $n = round($n);
} 
```

这对你有用吗？我假设`5`你说的是百分之一，如果不是，`5`那么你想要一个整数。

# ruby-on-rails-3 - Rails 中的 .gitignore 文件是通用的/全局的吗？

> ID：10952677
> 
> 赞同：0
> 
> 时间：2012-06-08T16:29:24.453
> 
> 标签：ruby-on-rails-3, git, github

我是 RoR 的菜鸟，因此感谢您提供任何帮助/澄清。

Rails 中的 .gitignore 文件是对所有 Rails 通用/全局的，还是每个项目/应用程序都有自己的 .gitignore？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:31:24.860

`.gitignore`是一个 Git 文件，它与 Rails 无关。

文件`.gitignore`将应用于它所在的目录和任何子目录。您可以在子目录中创建`.gitignore`文件以使它们仅适用于这些子目录及其后代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:33:09.383

`.gitignore`当您创建一个新的 Rails 应用程序时，会创建一个默认值。该文件告诉 git 忽略默认 Rails 应用程序中可能应该忽略的内容。

如果在您的特定应用程序中应该忽略其他文件，您可以对`.gitignore`. 如果您不使用 git，则可以完全删除该文件。

它基本上是为了鼓励最佳实践，但绝不需要运行 Rails 应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-14T12:48:39.237

在您的 ~/ 目录中有一个 .gitignore_global 文件，每个 git 实例都引用该文件。Git 独立于 Rails。.gitignore 文件仅限于初始化的存储库。

# php - 具有相同输入 ID 的多个表单仅使用 Ajax 发送第一个值

> ID：10952678
> 
> 赞同：0
> 
> 时间：2012-06-08T16:29:26.693
> 
> 标签：php, javascript, ajax

我正在使用 ajax 函数来使用表单和输入 type=hidden 插入数据库，但是当我在同一页面中放置多个表单时，它总是只取第一个表单中的第一个值

这是代码：

Ajax 函数

```
<script language="javascript" type="text/javascript">
   //Browser Support Code
   function ajaxFunction(){
      var ajaxRequest; // The variable that makes Ajax possible!  
      try{
         // Opera 8.0+, Firefox, Safari
         ajaxRequest = new XMLHttpRequest();
      } catch (e){
         // Internet Explorer Browsers
         try{
             ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
             } catch (e) {
                try{
                   ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
                } catch (e){
                  // Something went wrong
                  alert("Your browser broke!");
                  return false;
                }
            }
       }
       // Create a function that will receive data sent from the server
       ajaxRequest.onreadystatechange = function(){
       if(ajaxRequest.readyState == 4){
          var ajaxDisplay = document.getElementById("ajaxDiv");
          ajaxDisplay.innerHTML = ajaxRequest.responseText;
       }
    }
    var in1 = document.getElementById("in1").value;
    var queryString1 = "?in1=" + in1;

    //ajaxRequest.open("GET", "/sites/all/php/check.php" + queryString, true);
    ajaxRequest.open("GET", "/sites/all/php/check.php" + queryString1, true);
    ajaxRequest.send(null);
}
//–&gt;
</script> 
```

这是html表单

```
 <form name="myForm1">
         <input type="hidden" value="1" id="in1">
         <a onclick="ajaxFunction()" class="folloo"></a> 
         <form name="myForm2">
               <input type="hidden" value="2" id="in1">
               <a onclick="ajaxFunction()" class="folloo"></a> 
               <form name="myForm3">
                     <input type="hidden" value="3" id="in1">
                     <a onclick="ajaxFunction()" class="folloo"></a>
               </form>
         </form>
   </form> 
```

这是执行数据库查询的 check.php 代码

```
<?php
   //Connect to MySQL Server
   //connect to your database ** EDIT REQUIRED HERE **
   mysql_connect("localhost","admin","123456") or die('Cannot connect to the database
                 because: ' . mysql_error());

   //specify database ** EDIT REQUIRED HERE **
   mysql_select_db("dbname") or die("Unable to select database"); 
   //select which database we're using

   // Retrieve data from Query String
   $in1 = $_GET['in1'];

   // Escape User Input to help prevent SQL Injection
   $in1 = mysql_real_escape_string($in1);

   //Build and run a SQL Query on our MySQL tutorial
   if($in1){
       mysql_query("INSERT INTO test (name)
                  VALUES ('" . $in1\. "')");
   }

?> 
```

当我点击任何链接时，它总是发送第一个值。

cah 有人告诉我这里有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:33:02.593

`id`值[**在页面上必须是唯一的**](http://www.w3.org/TR/html5/elements.html#the-id-attribute)。您已经证明您有多个`input type="hidden"`具有相同`id`值 ( `"in1"`) 的元素。如果您有多个具有相同`id`值的元素，当您尝试查找它时（例如，使用`getElementById`），大多数浏览器会给您第一个，但这是未定义的行为，因为标记/DOM*无效*。

解决方法是修复 ID 以使其唯一，或者根本不使用 ID 并使用不需要唯一的东西*，*例如`name`或`class` - 但随后您需要使用`querySelectorAll`或类似的方式检索它，并且处理您有多个匹配元素的事实。

# wpf - 如何在 XAML 中公开控件

> ID：10952684
> 
> 赞同：4
> 
> 时间：2012-06-08T16:29:57.980
> 
> 标签：wpf, xaml, wpf-controls

我是 WPF 的新手，我正在创建一个控件。此控件包含一个 DataGrid 和一些其他 WPF 控件。

我创建了我的控件，如下所示：

```
<UserControl x:Class="MyControls.MyControl" 
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="329" d:DesignWidth="535" >
<Grid>
    <DataGrid Margin="6,25,6,35" Name="dataGrid" SelectionUnit="CellOrRowHeader" x:FieldModifier="public" HeadersVisibility="All"/>
    <OtherControl HorizontalAlignment="Left" x:Name="otherControl" Height="34" VerticalAlignment="Bottom" Width="523" x:FieldModifier="private"/>
    <Label Content="caption" Height="24" HorizontalAlignment="Left" Name="captionLabel" VerticalAlignment="Top" Foreground="#FF2626D1" x:FieldModifier="private"/>
</Grid>
</UserControl> 
```

因此，到目前为止一切顺利，然后我创建了一个容器 UserControl，其中包含我之前创建的控件：

```
<UserControl x:Class="MyContainers.MyContainer"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="300" d:DesignWidth="300" xmlns:my="clr-namespace:MyControls">
<Grid>
    <my:MyControl>

    </my:MyControl>
</Grid> 
```

我不能做的是以下几点：

```
<my:MyControl>
    <my:MyControl.dataGrid>

    </my:MyControl.dataGrid>
</my:MyControl> 
```

我之前将数据网格的属性设置为`FieldModifier`as`public`以便在另一个 xaml 中访问它，但它会从 Visual Studio 引发错误。

我需要“公开”我的 dataGrid 以便能够添加列及其样式。

我希望能够做这样的事情：

```
<my:MyControl.dataGrid.Columns >
    <DataGridTextColumn />
    <DataGridTextColumn />
    ...
    <DataGridTextColumn />
</my:MyControl.dataGrid.Columns> 
```

`FieldModifier`那么，将数据网格的属性设置为as还不够`public`吗？

我需要做其他事情吗？我怎样才能做到这一点？这甚至可能吗？

我希望有一个人可以帮助我。先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T17:02:28.397

您不能访问孩子，`DataGrid`因为没有名为“dataGrid”的属性。 `MyControl.dataGrid``MyControl`

您可以尝试添加类型的依赖属性`ObservableCollection<DataGridColumn>`to `MyControl`，并在该集合更改时修改 dataGrid 列。

编辑：为您准备了一个简单的示例：

用户控制代码：

```
public partial class UserControl1 : UserControl
{
    public static readonly DependencyProperty ColumnsProperty = DependencyProperty.Register("Columns", typeof(ObservableCollection<DataGridColumn>), typeof(UserControl1));
    public ObservableCollection<DataGridColumn> Columns
    {
        get { return (ObservableCollection<DataGridColumn>)GetValue(ColumnsProperty); }
        set { SetValue(ColumnsProperty, value); }
    }

    public UserControl1()
    {
        Columns = new ObservableCollection<DataGridColumn>();
        Columns.CollectionChanged += (s, a) =>
            {
                dataGrid.Columns.Clear();
                foreach (var column in this.Columns)
                    dataGrid.Columns.Add(column);
            };
        InitializeComponent();
    }
} 
```

用户控件 xaml：

```
<UserControl x:Class="WpfApplication1.UserControl1"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008">
<Grid>
    <DataGrid x:Name="dataGrid" AutoGenerateColumns="False"/>
</Grid> 
```

所以你可以像这样使用它：

```
<Grid>
    <l:UserControl1>
        <l:UserControl1.Columns>
            <DataGridTextColumn Header="Col1"/>
            <DataGridTextColumn Header="Col2"/>
        </l:UserControl1.Columns>
    </l:UserControl1>
</Grid> 
```

# trello - 自动导出（备份）Trello 板

> ID：10952685
> 
> 赞同：15
> 
> 时间：2012-06-08T16:29:58.223
> 
> 标签：trello

在浏览器中登录 trello 后，您可以通过点击如下 URL 轻松备份板： [https ://trello.com/board/replaceWithMyBoardId/my-board-name.json](https://trello.com/board/replaceWithMyBoardId/my-board-name.json)

我想编写一个脚本，该脚本将通过一组给定的板并自动存档 json 导出。

我已经有了一个开发者密钥，并且我已经有了一个 oauth 令牌。我可以成功访问[https://api.trello.com/1/board/replaceWithMyBoardId?key=replaceWithMyKey&token=replaceWithMyToken](https://api.trello.com/1/board/replaceWithMyBoardId?key=replaceWithMyKey&token=replaceWithMyToken)但这只会给我基本的董事会信息。我想像通过浏览器一样获得全板导出。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-12T02:34:40.957

如果您想为所有 Trello.com 板自动下载 .json 文件，我编写了一个使用 API 执行此操作的小脚本：[Github 上的 Trello-backup](https://github.com/mattab/trello-backup)

我将脚本设置为作为日常任务运行，并且我所有有价值的 trello 板/卡/列表都会自动保存在我的计算机上作为 JSON 文件。有利于安心！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-20T11:32:42.473

刚刚在我的博客上写了一篇关于这个的[帖子。](http://www.shesek.info/general/automatically-backup-trello-lists-cards-and-other-data)

您只是缺少一些使 API 返回更多信息的选项。检查他们的[API 文档](https://trello.com/docs/api/board/index.html)以获取可用选项列表，或者尝试添加：

```
actions=all&actions_limit=1000&cards=all&lists=all&members=all&member_fields=all&checklists=all&fields=all 
```

获取尽可能多的信息（据我所知）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-07T14:47:06.203

这些似乎是两个最简单的选择 -

*   设置此 Google Drive 脚本以运行并将所有卡片数据保存到电子表格 - [http://www.littlebluemonkey.com/online-scrum-tools-part-4-trello-backup/](http://www.littlebluemonkey.com/online-scrum-tools-part-4-trello-backup/)

*   github 上有一个 php 脚本，您可以在 cron 上进行设置 - [https://github.com/mattab/trello-backup](https://github.com/mattab/trello-backup)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T03:26:30.907

看起来不会那么难。只需使用您的 trello 调用，并使用您选择的脚本语言将它们指向一个文件。使用 javascript/jquery 你可以使用 parseJson 我想。

```
var callToTrello = 'http://trello.com/1/boards/someBoard/whateverelse
var obj = jQuery.parseJSON(callToTrelllo);
 //then just write to the local system using 

set fso = CreateObject("Scripting.FileSystemObject");  
set s = fso.CreateTextFile("C:\\trello.txt", True);
s.writeline(obj);
s.Close(); 
```

或类似的规定。一旦它在文件中，你总是可以使用 jsbeautifier 让它看起来很漂亮。但这会将其放入文件中。我明天会测试它并确保它有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-23T14:01:56.470

嗨，这篇文章已被删除（不知道为什么，因为我认为这与马特的帖子（第二个答案）甚至选择的答案没有什么不同，只是提供了 2 个可能的解决方案的链接，但我会尝试详细说明。

该应用程序将按照操作要求执行并提供方便的解决方案，因为它不需要 php。它将自动备份您的所有组织板，并且易于使用 Windows 调度程序进行调度。它可以通过代理工作，并具有一个邮件模块，可与您选择的邮件平台集成，以通过电子邮件发送每日报告和错误日志。

该应用程序是免费和开源的，代码在 github 存储库中提供，可以修改以适应目的（虽然我认为这没有必要）

[https://github.com/matthall103/TrelloBackup](https://github.com/matthall103/TrelloBackup)

如果这个答案仍然不合适，请告诉我原因，我会确保我以后不会犯同样的错误。

谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-04T12:08:58.763

在[Trello Business Class](https://trello.com/business-class)中有一个按钮可以[批量导出](http://help.trello.com/article/714-business-class-user-guide#Bulk%20data%20export%20&%20Export%20history)您的所有看板，包括附件。使用例如[Selenium](http://www.seleniumhq.org/)、[PhantomJS](http://phantomjs.org/)、[ghost.py](http://jeanphix.me/Ghost.py/)或[Splinter](https://splinter.readthedocs.org/en/latest/)的非常简单的脚本就足够了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-12T07:03:10.343

加上我的两分钱。

github.com/jtpio/trello-full-backup 和 github.com/mattab/trello-backup 都不适合我。一种尝试创建名称过长的文件，另一种尝试创建名称中带有反斜杠的文件（当板标题有反斜杠时）。

这是用于正确转储/备份（无需解析）的自行式 AutoHotkey_L 脚本：[https](https://github.com/AntonD-mobilmir/Share-config/blob/master/Backup-Scripts/Dropbox/Backups/Trello/Backup.ahk) ://github.com/AntonD-mobilmir/Share-config/blob/master/Backup-Scripts/Dropbox/Backups/Trello/Backup.ahk （它需要来自同一 repo 的[Lib文件夹中的一些文件）。](https://github.com/AntonD-mobilmir/Share-config/tree/master/config/_Scripts/Lib)

有俄语的字符串，但如果有任何兴趣，我会翻译。

一些特点：

1.  如果没有 args，它会请求所有用户团队的用户板和板的列表。
2.  然后它请求这些板的所有 API 可访问资源，将所有请求分批分组以保存 API 调用（按 10，因为它是 API 批处理的最大值）：
    *   行动
    *   清单
    *   标签
    *   列表
    *   会员
    *   插件？过滤器=启用
3.  然后将所有响应转储到 NNN.json 文件中。如果你需要一些东西，它很容易解析。
4.  将它看到的所有板保存到boards.json，并且仅在上次操作日期已更改（或者如果板是新的）时备份板。要再次进行完整备份，只需重命名/删除此文件。该文件永远不会缩小，它始终是脚本看到的任何板的完整列表，甚至不再可用（用户访问被撤销或板被删除）。旁边有`boards.txt`，只是更易读的数据，和json里一样。您可以查看它以检查曾经见过的板脚本。脚本从不真正读取 txt，只是在每次运行时覆盖它。
5.  要了解转储的内容，每个转储目录都有`boards.txt`转储板列表。

待办事项/修复：

*   第一个保存的批次总是空的。这肯定是脚本错误，但我还没有时间理解原因（备份仍然完整且很好，只是多余的空文件很烦人）。
*   附加资源不会被转储
*   不解析转储，提取数据进行恢复是不方便的。除了转储之外，还需要更易于人类阅读的备份结构。

PS 俄语相同的解释：www.logicdaemon.ru/projects/trello-backup

# vb.net - 如何在自动生成的 XSD 代码中修复 CLS 兼容

> ID：10952687
> 
> 赞同：1
> 
> 时间：2012-06-08T16:30:09.527
> 
> 标签：vb.net, cls-compliant

我们有一个数据集，其中一列是 VB 关键字。生成的代码会自动在 *.designer.vb 中的属性名称前加上下划线。这是对 CLS-Compliance 的警告。现在我们想删除警告并将警告作为错误打开。我知道如何正常解决这个问题，但如果我这样做，迟早会有人触摸设计器，重新生成代码并删除修复。此时我无法更改列名，为时已晚。有没有办法解决这个困境？

# ant - 如何在 Apache Ant 构建脚本中使用 dirset 目录的属性？

> ID：10952688
> 
> 赞同：0
> 
> 时间：2012-06-08T16:30:09.677
> 
> 标签：ant

我的脚本在使用属性值时失败，但在使用文字字符串指定目录的路径时不会。

这失败了：

```
 <target name="build">
            <echo>${dir.intermediate}</echo>
            <echo>${dir.source}</echo>
        <copy todir="${dir.intermediate}" includeEmptyDirs="true">
            <dirset dir="${dir.source}" excludes="${file.default.exclude}, ${file.exclude}"/>
        </copy>
    </target> 
```

这有效：

```
<target name="build">
        <echo>${dir.intermediate}</echo>
        <echo>${dir.source}</echo>
    <copy todir="${dir.intermediate}" includeEmptyDirs="true">
        <dirset dir="/Users/michaelprescott/path" excludes="${file.default.exclude}, ${file.exclude}"/>
    </copy> 
```

如果我在属性或文字的目录中指定绝对或相对路径似乎并不重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:01:12.143

哇。这是一个非常难以识别的问题。查看属性文件时路径显示正确。它在 echo 语句中看起来是正确的。从 ant 失败消息中复制它并将其粘贴到“ls”中时，它甚至看起来是正确的。最后，我注意到目录字符串后面有一个空格。

在属性文件中是：

```
"./path " 
```

将其更改为以下固定它：

```
"./path" 
```

# licensing - 从一种语言移植到另一种语言的代码 - 许可

> ID：10952689
> 
> 赞同：11
> 
> 时间：2012-06-08T16:30:15.663
> 
> 标签：licensing

我将一些代码从 C 移植到 C#，并且还在移植的代码中添加了一些新功能。原始代码在 MPL 许可下。

这是原始源代码许可条款：

```
/*
 * file name
 * Version .....
 *
 * Copyright (c) 2004-2012 by XXX YYY
 *
 * The contents of this file are subject to the Mozilla Public License Version
 * 1.1 (the "License"); you may not use this file except in compliance with
 * the License. You may obtain a copy of the License at
 * http://www.mozilla.org/MPL/
 *
 * Software distributed under the License is distributed on an "AS IS" basis,
 * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
 * for the specific language governing rights and limitations under the
 * License.
 *
 * The Original Code is file.c
 *
 * The Initial Developer of the Original Code is XXX YYY.
 *
 * Portions created by XXX YYY are Copyright (C) 2004-2012
 * XXX YYY. All Rights Reserved.
 *
 */ 
```

**我可以更改移植代码的许可证并以这种方式包含原始源代码的原始源代码许可条款：**

```
//
// test.cs
//
// Author:
//   "My Name" (my@email.com) 
//
// Copyright (c) 2012 My Name
//
// Permission is hereby granted, free of charge, to any person obtaining
// a copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to
// permit persons to whom the Software is furnished to do so, subject to
// the following conditions:
//
// The above copyright notice and this permission notice shall be
// included in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
// 
// Parts of this source code are ported from C to C# by "My Name".
//
// The Original Code is file.c (http://original-source-code-link.com);
// and under Mozilla Public License Version 1.1 (http://www.mozilla.org/MPL/) 
// The Initial Developer of the Original Code is XXX YYY (xxxyyy@email.com). 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T23:36:18.470

移植一些代码就是翻译一些代码（与翻译别人的书相比），因此受版权保护。您正在创作衍生作品。

顺便说一句。永远不要更改作者信用和版权说明。那是不行的，你这样做是在合法地自找麻烦。因此，逐字复制最初的陈述，不要削弱它。

此外，您通常不能将文件放在类似 MIT 的许可证下，而文件的一部分在 MPL AFAIK 但在 IANAL JASD 下。

为什么不只许可 MPL 下的文件呢？这可能是一个可以给你的最好的建议。对于其他一切，你应该直接去找你的律师。

[http://en.wikipedia.org/wiki/Mozilla_Public_License](http://en.wikipedia.org/wiki/Mozilla_Public_License)

* * *

如果您真的想将属于您的作品的那部分作品置于您的许可之下，您必须使您的作品在哪里以及原始作品在哪里变得非常明显。

我发现端口/翻译很难使其可见，我怀疑这是可能的。

这只是技术上的，因为即使你能够做到，这也没有说明许可证的兼容性。当然，您还需要具有许可证兼容性。

[所以由于这两个原因，你真的应该考虑在与 MPL 拥有copyleft](http://www.gnu.org/copyleft/)相同的许可下发布它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-13T15:02:37.517

移植只是对代码的修改。

您违反了 MPL 的第 3.1 和 3.4 节，它们分别规定：

> 所有以源代码形式分发的涵盖软件，包括您创建或贡献的**任何修改，都必须遵守本许可的条款。**您必须告知收件人，涵盖软件的源代码表格受本许可条款的约束，以及他们如何获得本许可的副本。您不得尝试更改或限制接收者在源代码表单中的权利。

...

> 您不得删除或更改包含在涵盖软件的源代码形式中的任何许可通知（包括版权通知、专利通知、免责声明或责任限制）的内容，除非您可以更改任何许可通知以纠正已知的事实不准确所需的范围。

所以答案是否定的，你的代码必须保持 MPL 的条款，并保持原来的注释块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-17T15:44:44.373

通过说您正在**移植**代码，您显然是在制作衍生作品，在这种情况下，您需要遵守原始代码的许可。

**但是，可以对API**进行“无尘室重新实现” ，您可以在其中使用您想要的任何许可证。这基本上意味着您打印 Doxygen 文档，并且仅基于此编写代码。如果有人质疑您的方法，您将需要证明您是如何进行的，即。使用 SCM 提交记录等。通常不值得这样做，因为它需要与开发原始软件一样多的工作。

移植只是开发工作的一小部分；您不必设计，并且引入错误的机会很小。那么你为什么要承担所有的功劳呢？我打赌 XXX YYY 会生气的。我会 ！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T08:27:56.410

从 MPL[常见问题解答](http://www.mozilla.org/MPL/2.0/FAQ.html)：

> **Q9：我想分发（在我的组织之外）我修改过的 MPL 许可源代码。我需要做什么？**
> 
> 要查看完整的要求集，请阅读许可证。但是，一般来说：
> 
> *   您必须通知接收者，根据 MPL（第 3.1 节）的条款，包括您创建的任何修改（如第 1.10 节中定义），向他们提供源代码。
>     
>     
> *   您必须进行许可第 2 节中所述的授权。
>     
>     
> *   您必须遵守在源代码中删除或更改通知的限制（第 3.4 节）。

由于您首先移植了源代码，然后对其进行了更改，因此您需要**获得原作者的许可才能移植**。完成后，您需要遵循上述答案中的指南，因为您修改了代码。

您可能还想看看这个[问题](https://softwareengineering.stackexchange.com/questions/58338/when-porting-code-must-i-follow-the-original-license)。

# php - 9:30 在我的 mysql 数据库中放入什么数据类型

> ID：10952690
> 
> 赞同：0
> 
> 时间：2012-06-08T16:30:26.233
> 
> 标签：php, mysql, sql

我几乎完成了为学校系统构建一个 php Web 应用程序，例如添加课程并在 schdule 中显示的功能，学生可以查看日程安排和添加课程。我的问题是我把 INT 几个小时（例如：9-12）我想把 9:30 到 12:00 我必须在我的 mysql 数据库中将数据类型更改为 VARCHAR

此外，是否有 jquery 或 javascript 自动弹出小时。现在我让用户把上午 9 点到下午 12 点（例如）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:31:52.333

为此使用[`TIME`数据类型](http://dev.mysql.com/doc/refman/5.0/en/time.html)

# jquery - 如何在单选按钮上获得 onchange 回调，但只有一个被设置的按钮

> ID：10952691
> 
> 赞同：6
> 
> 时间：2012-06-08T16:30:30.127
> 
> 标签：jquery, jquery-mobile, radio-button, onchange

我有一组名称相同但值不同的单选按钮。我想做类似的事情：

```
$("#langs").on("change", "[name=locale]", myfunction); 
```

这可行，但是当我单击一个新的单选按钮时，我的函数会被调用两次：一次用于自动取消选中的“旧”单选按钮，一次用于我单击的新单选按钮。

将 onchange 更改为 onclick 不是解决方案，因为我将它与 jquery-mobile 一起使用，并且它使用标签包装输入，因此标签被点击，而不是输入。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T17:07:00.110

您可以`$(this)`作为参数传递给`myfunction`然后`myfunction`检查单选按钮是否被选中

`$("#langs").on("change", "[name=locale]", function() { myfunction($(this)); } );`

```
function myfunction(elem) {
    if(elem.is(':checked')) {
        // code here
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T17:23:04.457

这对你有用吗？遵循[jQM 文档](http://jquerymobile.com/demos/1.1.0/docs/forms/radiobuttons/events.html)

*   [示例 1](http://jsfiddle.net/FhcrK/)
*   [示例 2](http://jsfiddle.net/FhcrK/1/)（有趣）

HTML：

```
<div data-role="page"> 
    <fieldset data-role="controlgroup">
        <legend>Choose a language:</legend>
        <input type="radio" name="langs" id="english-lang" value="en" />
        <label for="english-lang">English</label>
        <input type="radio" name="langs" id="korean-lang" value="ko" />
        <label for="korean-lang">Korean</label>
    </fieldset>
</div>​ 
```

JS：

```
$("input[name=langs]:radio").bind( "change", function(event, ui) {
    console.log('Lang: '+$(this).val());

    // Call function here
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:57:45.080

试试类似的东西怎么样：

```
<div data-role="fieldcontain">
     <fieldset data-role="controlgroup" data-type="horizontal">
     <input type="radio" name="langs" id="first" value="1" onchange="myfunction();"/>
     <label for="first">First</label>
     <input type="radio" name="langs" id="second" value="2" onchange="myfunction();"/>
     <label for="second">Second</label>
     </fieldset>
</div> 
```

接着：

```
function myfunction(){
    if($("#langs option:selected")){
    //do something, for example
        alert($("#langs option:selected").text());
    }
} 
```

这应该只调用一次函数，因为它**包含**在需要使用它的元素中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:51:37.790

据我所知，在标签中使用带有 jquery 的 onclick evente 没有任何限制。如果你有一个 id，你可以使用它。假设您有以下 html：

```
<label for="foo" id="whatever1">foo</label><input type="radio" name="radiogroup_0" value="foo" >
<label for="bar" id="whatever2">bar</label><input type="radio" name="radiogroup_1" value="bar" > 
```

在您的 jquery 中，您可以添加：

```
$('#whatever1').click(
  function(){
    //paste your code inside
  }
); 
```

与其他单选按钮的标签相同

```
$('#whatever1').click(
  function(){
    //paste your code inside
  }
); 
```

希望这可以帮助。路易斯·M。

# data-structures - 如何使用 HashSet 实现 HashTable

> ID：10952692
> 
> 赞同：2
> 
> 时间：2012-06-08T16:30:34.733
> 
> 标签：data-structures, hashtable

我被问到以下面试问题：

> 假设您有一个提供其普通接口的 HashSet 实现。您如何使用一个或多个 HashSet 实例来实现一个提供普通 HashTable 接口的 HashTable 以及它通常的时间限制？

我问了两次，但他们的意思是这样而不是相反（使用 HashTable 实现 HashSet 非常简单，例如 Java 就是这样做的）。

我回答说不可能。这个答案似乎没有让面试官满意，所以我正在寻找更好的答案。即使在 Internet 和 Stack Overflow 上搜索时，我也找不到解决方案。

我认为这是一个棘手的问题，但要确保我在 SO 上发布了这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T16:35:15.660

做到这一点的一种标准方法是将哈希表视为键/值对的哈希集，其中键/值对的哈希码纯粹是键的哈希码，相等比较函数表示任意两个键/value 对在它们的键相等时恰好相等。这样，正常的散列集操作将以一种方式存储键/值对

*   不会存储具有相同键的两个键/值对，并且
*   在哈希表中查找键将找到具有该键的键/值对对象，从中可以查找值。

希望这可以帮助！

# android - 从另一个活动中调用类

> ID：10952694
> 
> 赞同：0
> 
> 时间：2012-06-08T16:30:43.517
> 
> 标签：android

我有活动 1 和活动 2。活动 2 有一个 GeoCoder 类（公共类 GeoCoder 扩展 AsynTask）有什么办法可以从活动 1 执行 GeoCoder 类？

screen1.java

```
public class screen1 extends Activity implements View.OnClickListener {

ProgressDialog dialog, dialog2, dialog3;

LayoutInflater inflater;
SharedPreferences.Editor editor;
SharedPreferences preferences;

// Strings
String username, password, firstName, lastName, lastLatitudeUpdate;
int checkedin, Minute, Hour, Time;

Timer EnableLocationonResume;

Vibrator vib;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.screen1);   
    vib = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);

    ///// Calls String from AgentPortalActivity class to pass through to screen1 class  //////////////////////////////////////////////////////////////////////                                                                                                                                              
    Intent i = getIntent();                                                                                                                                 //
    username = i.getExtras().getString("uid");                                                                                                              //
    password = i.getExtras().getString("pwd");                                  ////// Boolean for Check-In Button Sharedpreferences///////////             //
    firstName = i.getExtras().getString("firstName");                           preferences = getPreferences(MODE_PRIVATE);                  //             //
    lastName = i.getExtras().getString("lastName");                             final boolean tgpref; tgpref = preferences.getBoolean("tgpref", true);      //                                                          
    lastLatitudeUpdate = i.getExtras().getString("lastLatitudeUpdate");         checkinbutton.setChecked(tgpref);                            //             //
    checkedin = i.getExtras().getInt("checkedin");                              ///////////////////////////////////////////////////////////////             //  
    Minute = i.getExtras().getInt("Minute");                                                                                                                //
    Hour = i.getExtras().getInt("Hour");                                                                                                                    //
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

    //////////////////////// Gets Time since last GPS Update and compares LastUpdate time to Current Time (-60 Minutes) and displays Update GPS status if nessecary //////////
    SimpleDateFormat parserSDF=new SimpleDateFormat("M/d/yyyy h:m:s a"); // <--- Correct format to read "lastLatitudeUpdate"                                                //
    try {                                                                                                                                                                   //
        Date d = parserSDF.parse(lastLatitudeUpdate);                                                                                                                       //
                                                                                                                                                                            //
        Calendar now = Calendar.getInstance();                                                                                                                              //
        // Go back 1 Hour.                                                                                                                                                  //
        now.add(Calendar.MINUTE, -60);                                                                                                                                      //
        Date HourAgo = now.getTime();                                                                                                                                       //
                                                                                                                                                                            //
        if (d.before(HourAgo))  {                                                                                                                                           //
          GPSUPDATE.setText("Please update your gps to stay current on standby list");                                                                                      //
        }                                                                                                                                                                   //
    } catch (java.text.ParseException e1) {                                                                                                                                 //
        // TODO Auto-generated catch block                                                                                                                                  //
        e1.printStackTrace();                                                                                                                                               //
    }                                                                                                                                                                       //
    //////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

        ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     //////
        //-------------------------------------------------------Checks to see if Driver is Currently Checked-In or Checked-Out and toggles checkinbutton respectively------------------------------------------------------//
        //----------------------------------------------------------------------Also Changes "information.settext" to display either hello or goodbye-----------------------------------------------------------------------//
        if (checkedin == 0) {                                                                                                                                                                                               
            String text = "<font color=\"grey\"> You are currently Checked-Out </font>";                                                                                                                                    //
            checkin.setText(Html.fromHtml(text), BufferType.SPANNABLE);                                                                                                                         
                                                                                                                                                                                                                            //
            // Boolean Preferences for Checkinbutton ToggleButton Remembers Toggle State Checked
            editor = preferences.edit();                                                                                                                                                                                    //
            checkinbutton.setChecked(false);
            editor.putBoolean("tgpref", true);          editor.commit();                                                                                                                                                    //

            information.setText("Thank you for todays hard work, " + (firstName) + " " + (lastName) + "!" + "\n" + " You have checked out for the day ");                                                                   //
        } 
                                                                                                                                                                                                                            //
        if (checkedin == 1) {
            String text = "<font color=\"#A2E8\"> You are currently Checked-In </font>";                                                                                                                                    //
            checkin.setText(Html.fromHtml(text), BufferType.SPANNABLE);
                                                                                                                                                                                                                            //
            // Boolean Preferences for Checkinbutton ToggleButton Remembers Toggle State Checked
            editor = preferences.edit();                                                                                                                                                                                    //
            checkinbutton.setChecked(true);
            editor.putBoolean("tgpref", true);          editor.commit();                                                                                                                                                    //

            information.setText("Welcome back, " + (firstName) + " " + (lastName) + "!" + "\n" + " Your last GPS update was on " + (lastLatitudeUpdate));                                                                   //
        }//----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
        ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     ///     //////

    //-------------------------------------------------------Check IN ToggleButton-------------------------------------------------------//
    checkinbutton.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {       

            vib.vibrate(40);

            //---------------------------Only Displays Mile-in Zip-in and submitin Button---------------------------------------//
            if (checkinbutton.isChecked()) {                                                                                    //
                milein.setVisibility(View.VISIBLE);                                     mileout.setVisibility(View.GONE);       //
                submitin.setVisibility(View.VISIBLE);                                   submitout.setVisibility(View.GONE);     //                  
                CancelIN.setVisibility(View.VISIBLE);                                   CancelOUT.setVisibility(View.GONE);     //
                zipin.setVisibility(View.VISIBLE);                                      zipout.setVisibility(View.GONE);        //
                dispatch.setVisibility(View.GONE);                                      dispatchnum.setVisibility(View.GONE);   //
                donotcallus.setVisibility(View.GONE);                                   googletalk.setVisibility(View.GONE);    //
                csr.setVisibility(View.GONE);                                           csrnum.setVisibility(View.GONE);        //
                it.setVisibility(View.GONE);                                            itnum.setVisibility(View.GONE);         //
                thoughts.setVisibility(View.GONE);                                      feed.setVisibility(View.GONE);          //
                send.setVisibility(View.GONE);                                          information.setVisibility(View.GONE);   //
                checkinbutton.setEnabled(false);                                                                                //
            //------------------------------------------------------------------------------------------------------------------//  

                // Boolean Preferences for Checkinbutton ToggleButton Remembers Toggle State Checked
                editor = preferences.edit();
                preferences = getPreferences(MODE_PRIVATE);

                checkinbutton.setChecked(tgpref);                                       checkinbutton.setChecked(false);
                editor.putBoolean("tgpref", true);                                      editor.commit();

                String text = "<font color=\"#CC0000\"> Checking-In... </font>";
                checkin.setText(Html.fromHtml(text), BufferType.SPANNABLE);

            } else {
                mileout.setVisibility(View.VISIBLE);                                    milein.setVisibility(View.GONE);
                zipout.setVisibility(View.VISIBLE);                                     zipin.setVisibility(View.GONE);
                submitout.setVisibility(View.VISIBLE);                                  submitin.setVisibility(View.GONE);
                CancelOUT.setVisibility(View.VISIBLE);                                  CancelIN.setVisibility(View.GONE);
                dispatch.setVisibility(View.GONE);                                      dispatchnum.setVisibility(View.GONE);
                csr.setVisibility(View.GONE);                                           csrnum.setVisibility(View.GONE);
                it.setVisibility(View.GONE);                                            itnum.setVisibility(View.GONE);
                donotcallus.setVisibility(View.GONE);                                   googletalk.setVisibility(View.GONE);
                thoughts.setVisibility(View.GONE);                                      feed.setVisibility(View.GONE);
                send.setVisibility(View.GONE);                                          information.setVisibility(View.GONE);
                checkinbutton.setChecked(true);                                         

                vib.vibrate(80);

                //-------------------------------------------------------Custom Layout View for Check-Out Checkbox-------------------------------------------------------//
                inflater = getLayoutInflater();
                final View checkboxLayout = inflater.inflate(R.anim.verify, null);
                final CheckBox AgreeCheckBox = (CheckBox) checkboxLayout.findViewById(R.id.checkBox);

                //-------------------------------------------------------AlertDialog Meal-Periods Button Configurations-------------------------------------------------------//
                AlertDialog alertDialog = new AlertDialog.Builder(screen1.this).create();
                alertDialog.setCancelable(false);
                alertDialog.setTitle("            Rest Periods");
                alertDialog.setView(checkboxLayout);

                //-------------------------------------------------------FLAG_BLURBEHIND TO BLUR BACKGROUND-------------------------------------------------------//
                WindowManager.LayoutParams lp = alertDialog.getWindow().getAttributes(); 
                //alertDialog.getWindow().addFlags(WindowManager.LayoutParams.FLAG_BLUR_BEHIND); // <--Blurring is no longer supported, Draws from hardware. Too many rendering issues and unresponsiveness with certain phones
                alertDialog.getWindow().addFlags(WindowManager.LayoutParams.FLAG_DIM_BEHIND);
                lp.dimAmount = .35f;
                alertDialog.getWindow().setAttributes(lp);
                alertDialog.setButton("Agree", new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog,
                                    int which) {

                                if (AgreeCheckBox.isChecked()) {
                                    // If CheckBox is Checked
                                    String text = "<font color=\"#CC0000\"> Checking-Out... </font>";
                                    checkin.setText(Html.fromHtml(text),BufferType.SPANNABLE);
                                    checkinbutton.setEnabled(false);

                                } else {
                                    // If CheckBox Isnt Checked
                                    String text = "<font color=\"#A2E8\"> You are currently Checked-In </font>";
                                    checkin.setText(Html.fromHtml(text),BufferType.SPANNABLE); 
```

状态页.java

```
 public class statuspage extends MapActivity {

//////////////////////////    Map and MapView Initializers    //////////////////////////////////////////////     
LocationManager locationManager;        MapView mapView;        Criteria criteria;      Vibrator vib;    ///
Location location;                      Geocoder gc;                                    Address address; ///
MapController mapController;            MyLocationOverlay myLocation;                                    ///
////////////////////////////////////////////////////////////////////////////////////////////////////////////

StringBuilder sb;
String username, password, bestProvider, firstName, lastName, lastLatitudeUpdate;
String LOCATION_SERVICE = "location", addressString = "Searching for nearest address";

int checkedin, Minute, Hour;
Timer EnableLocationonResume;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    setContentView(R.layout.statuspage);
    vib = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);    

public class GeoCoder extends AsyncTask<Void, Void, Void> {

    String lat = "Acquiring", lng ="Acquiring";

    // scrollview will be used to view jobs using a listview Latitude and Longitude TextView
    TextView YourLocation = (TextView) findViewById(R.id.YourLocation);
    TextView etlongitude = (TextView) findViewById(R.id.etlongitude);
    TextView etlatitude = (TextView) findViewById(R.id.etlatitude);

    @Override
    protected Void doInBackground(Void... params) {

        if (location != null) {

            //double latitude = myLocation.getMyLocation().getLatitudeE6();         double longitude = myLocation.getMyLocation().getLongitudeE6(); 
            double latitude = location.getLatitude();                               double longitude = location.getLongitude();
                    lat = ("" + (latitude));                                                lng = ("" + (longitude));

            Geocoder gc = new Geocoder(getBaseContext(),Locale.getDefault());
            try {
                List<Address> addresses = gc.getFromLocation(latitude,longitude, 1);

                sb = new StringBuilder();
                if (addresses.size() > 0) {
                    address = addresses.get(0);
                    int noOfMaxAddressLine = address.getMaxAddressLineIndex();
                    if (noOfMaxAddressLine > 0) {
                        for (int i = 0; i < address.getMaxAddressLineIndex(); i++) {
                            sb.append(address.getAddressLine(i)).append("\n");
                        }
                        addressString = sb.toString();
                    }
                }
            } catch (Exception e) {
                addressString = "Sorry, we are trying to find information about your location";
            }
        }
        return null;
    }

    @Override
    protected void onPostExecute(Void result) {

        /////////   Animates the map to GPS Position   ////////////////////
        myLocation.runOnFirstFix(new Runnable() {                       //
            @Override                                                  //
            public void run() {                                       //
                mapController.animateTo(myLocation.getMyLocation()); //
        //////////////////////////////////////////////////////////////
            }
        });

        runOnUiThread(new Runnable() {
            public void run() {

                ////////////////TODO TextView to display GeoCoder Address TODO///////////////////////////////////////////
                                    YourLocation.setGravity(Gravity.CENTER);                                          //
                YourLocation.setText("Your location:" + "\n" + "(Accurate to 500 meters)" + "\n" + (addressString)); //
                                                                                                                    //
                ////////TODO Latitude and Longitude TextView Display Coordinates TODO////////////////////////////////
                etlatitude.setText(lat);                                    etlongitude.setText(lng);             //
                                         Log.d("Address", (addressString));                                      //
            }   //////////////////////////////////////////////////////////////////////////////////////////////////
        });
        super.onPostExecute(result); 
        return;
    }
}                                                                                                                                                                                   

private final LocationListener locationListener = new LocationListener() {
    @Override
    public void onLocationChanged(Location location) {
        new GeoCoder().execute();       
    }
    @Override
    public void onProviderDisabled(String provider) {
    }
    @Override
    public void onProviderEnabled(String provider) {
    }
    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
};

///////////// Class EnableLocation is a Timer Created To Start GPS and GeoCode Updates ///////////////////////////////
public class EnableLocation extends TimerTask {                                                                     //
                                                                                                                    //
//*************************** Uses runOnUiThread to Keep UI updating in Background *********************************//  
    @Override                                                                                                       //
    public void run() {                                                                                             //
        runOnUiThread(new Runnable() {                                                                              //
            @Override                                                                                               //
            public void run() {                                                                                     //
                myLocation.enableMyLocation();                                                                      //
                //location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);                    //
            locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1000L, 500.0f, locationListener);  //
                new GeoCoder().execute();                                                                           //
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////          
            }
        });
    }
}

// Class DisableLocation is a Timer Created to Stop GPS Updates then Toasts NewLocation
class DisableLocation extends TimerTask {

    // Uses runOnUiThread to Keep UI updating in Background
    @Override
    public void run() {
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                myLocation.disableMyLocation();
                locationManager.removeUpdates(locationListener);

                // get your custom_toast.xml ayout
                LayoutInflater inflater = getLayoutInflater();
                View layout = inflater.inflate(R.anim.custom_toast,(ViewGroup) findViewById(R.id.custom_toast_layout_id));
                // set a dummy image
                ImageView image = (ImageView) layout.findViewById(R.id.image);
                image.setImageResource(R.drawable.toastjet);

                // set a message
                TextView text = (TextView) layout.findViewById(R.id.text);
                text.setGravity(Gravity.CENTER);
                text.setText("Location has changed to" + "\n" + (addressString));

                // Toast...
                Toast location = new Toast(getApplicationContext());
                location.setDuration(Toast.LENGTH_LONG);
                location.setView(layout);
                location.show();
            }
        });
    }
}

@Override
protected void onResume() {
    super.onResume();
    myLocation.enableMyLocation();

    // Fires GPS Updates
    EnableLocationonResume = new Timer();
    EnableLocation myTimerTask1 = new EnableLocation();
    EnableLocationonResume.scheduleAtFixedRate(myTimerTask1, 100, 10000);

    overridePendingTransition(R.anim.fadein, R.anim.fadeout);

}

@Override
protected void onPause() {
    super.onPause();

    EnableLocationonResume.cancel();
    myLocation.disableMyLocation();
    locationManager.removeUpdates(locationListener);

    //////////////////// Fires GPS Updates ///////////////////////////////
    Timer EnableLocationonPause = new Timer();                          //
    EnableLocation myTimerTask = new EnableLocation();                  //
    EnableLocationonPause.scheduleAtFixedRate(myTimerTask, 0, 2280000); //
    //////////////////////////////////////////////////////////////////////

    //////////////////// Kills GPS Updates ///////////////////////////////////////
    Timer DisableLocationonPause = new Timer();                                 //
    DisableLocation disableLocation = new DisableLocation();                    //
    DisableLocationonPause.scheduleAtFixedRate(disableLocation, 10000, 2370000);//
    //////////////////////////////////////////////////////////////////////////////

    overridePendingTransition(R.anim.fadein, R.anim.fadeout);
}

@Override
public void onBackPressed() {

    EnableLocationonResume.cancel();
    myLocation.disableMyLocation();
    locationManager.removeUpdates(locationListener);

    // 2280000 Milliseconds = 38 Minutes
    // 2370000 Milliseconds = 39.5 Minutes
    // 2400000 Milliseconds = 40 Minutes
    // 2490000 Milliseconds = 41.5 Minutes
    // 2520000 Milliseconds = 42 Minutes
    // 2700000 Milliseconds = 45 Minutes
    // 2790000 Milliseconds = 46.5 Minutes
    // 2820000 Milliseconds = 47 Minutes
    // 2850000 Milliseconds = 47.5 Minutes

    ///////////////// Fires GPS Updates //////////////////////////
    Timer EnableLocation = new Timer();                         //
    EnableLocation EnableLocationTask = new EnableLocation();   //
    EnableLocation.scheduleAtFixedRate(EnableLocationTask, 0, 2280000);// <--- 2280000 = 38 Minutes
    //////////////////////////////////////////////////////////////

    ///////////////////// Kills GPS Updates ////////////////////////////////
    Timer DisableLocation = new Timer();                                  //
    DisableLocation disableLocation = new DisableLocation();              //
    //---------------------------------------------Delays for 10,000 Milliseconds (10 Seconds) to Continue to Poll for  GPS--------------------------------------------//
    DisableLocation.scheduleAtFixedRate(disableLocation, 10000, 2370000); // <--- 2370000 = 39.5 Minutes
    ////////////////////////////////////////////////////////////////////////

    vib.vibrate(40);

    // Send username and password strings into screen1 class
    Intent i = new Intent(statuspage.this, screen1.class);
    i.putExtra("uid", username);    i.putExtra("pwd", password);    i.putExtra("firstName", firstName);     i.putExtra("lastName", lastName);   
    i.putExtra("checkedin", checkedin); i.putExtra("lastLatitudeUpdate", lastLatitudeUpdate);   i.putExtra("Minute", Minute);   i.putExtra("Hour", Hour);   startActivity(i);
    startActivity(i);

    /** Fading Transition Effect */
    overridePendingTransition(R.anim.fadein, R.anim.fadeout);

    return;

} 
```

}

编辑：基本上我想知道是否有任何方法可以从 screen1.java 执行 GeoCoder 类

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:40:24.500

您可以按以下方式访问它：

```
Activity1.GeoCoder coder = new Activity1.GeoCoder(); 
```

或使用任何合适的构造函数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:42:58.997

由于您`GeoCoder`不是`static`，因此您需要先实例化一个`Activity2`对象才能访问它。

内部`Activity1`：

```
Activity2 myActivity2 = new Activity2();
GeoCoder myGeoCoder = myActivity2.new GeoCoder(); 
```

但是，如果您制作`GeoCoder`as `static`，则可以通过以下方式访问它：

```
GeoCoder myGeoCoder = new Activity2.GeoCoder(); 
```

编辑：我建议不要`AsyncTask`从另一个调用 an `Activity`。s 被设计为与它们所附着`AsyncTask`的密切相关。`Activity`相反，`AsyncTask`在您的`Activity1`.

# sql - 如何进行区分大小写的 GROUP BY？

> ID：10952696
> 
> 赞同：40
> 
> 时间：2012-06-08T16:30:50.867
> 
> 标签：sql, sql-server, sql-server-2008, group-by

如果我执行下面的代码：

```
with temp as
(
  select 'Test' as name
  UNION ALL
  select 'TEST'
  UNION ALL
  select 'test'
  UNION ALL
  select 'tester'
  UNION ALL
  select 'tester'
)
SELECT name, COUNT(name)
FROM temp
group by name 
```

它返回结果：

```
TEST   3
tester 2 
```

有没有办法让 group by 区分大小写，以便结果是：

```
Test   1
TEST   1
test   1
tester 2 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-08T16:32:58.837

您需要将文本转换为二进制（或使用区分大小写的排序规则）。

```
With temp as
(
  select 'Test' as name
  UNION ALL
  select 'TEST'
  UNION ALL
  select 'test'
  UNION ALL
  select 'tester'
  UNION ALL
  select 'tester'
)
Select Name, COUNT(name)
From temp
Group By Name, Cast(name As varbinary(100)) 
```

使用排序规则：

```
Select Name Collate SQL_Latin1_General_CP1_CS_AS, COUNT(name)
From temp
Group By Name Collate SQL_Latin1_General_CP1_CS_AS 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-06-08T16:36:56.750

您可以使用区分大小写的排序规则：

```
with temp as
(
  select 'Test' COLLATE Latin1_General_CS_AS as name
  UNION ALL
  select 'TEST'
  UNION ALL
  select 'test'
  UNION ALL
  select 'tester'
  UNION ALL
  select 'tester'
)
SELECT name, COUNT(name)
FROM temp
group by name 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2018-06-18T23:52:06.720

简单地：

```
SELECT count(*), CAST(lastname as BINARY) AS lastname_cs 
FROM names 
GROUP BY lastname_cs; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-10-14T01:01:24.773

在 MySQL/MariaDB 中，如果您不想使用排序规则或强制转换为二进制，只需使用：

```
SELECT MAX(name), COUNT(name)
FROM (
  select 'Test' as name
  UNION ALL
  select 'TEST'
  UNION ALL
  select 'test'
  UNION ALL
  select 'test'
  UNION ALL
  select 'tester'
  UNION ALL
  select 'tester'
) as tmp
group by MD5(name) 
```

# ios - iOS应用程序中的所有方法通常都在一个线程中吗？（用于比赛状态预防）

> ID：10952698
> 
> 赞同：17
> 
> 时间：2012-06-08T16:31:05.810
> 
> 标签：ios, race-condition

我们可以有许多处理程序：触摸处理程序、UIControl 处理程序（按钮、滑块）、performSelector、CADisplayLink、NSTimer 事件、手势识别器、加速度计处理程序和*UIView 动画完成块*，以及其他一些。

他们都在同一个线程中吗？也就是只能同时运行其中一个？

其他一些方法或处理程序是否可以成为另一个线程的一部分，因此可以创建竞争条件？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-08T18:10:23.813

通常，您会发现 iOS 上的大多数简单应用程序都倾向于在主线程上执行几乎所有操作。正如您所指出的，在您将多线程引入图片的那一刻，您添加了另一组需要注意的棘手问题。许多开发人员不想为这种增加的复杂性而烦恼，或者不熟悉 GCD 或一般的线程，因此他们避免在后台线程或 GCD 队列上做任何事情。

您在问题中列出的几个项目涉及与 UIKit 的交互，通常这些交互必须发生在主线程上（不过，iOS 4.x 添加了在后台执行一些绘图功能的能力）。您在主线程上收到触摸和其他相关事件。如果您希望更新界面的大多数方面，那么安全的方法是在主线程上执行这些更新。

计时器（NSTimer、CADisplayLink）可以通过将它们附加到在该后台线程上运行的 NSRunLoop 来在后台线程上触发它们的更新。你很少看到人们这样做，但它可以做到。通常，人们在主运行循环上配置计时器，这会导致回调在主线程上传递。

执行动画时，动画本身将在后台线程上运行（您会看到，当您用其他东西阻塞主线程时它们不会停止），但您几乎总是会在主线程上收到完成块或回调完成后线程。如果我没记错的话，会有一两个例外，它们在 Apple 的文档中都有说明。在与可能没有意识到幕后发生的事情的开发人员打交道时，在主线程上触发这些回调是一种安全的方法。

综上所述，有很好的理由要为您的应用程序添加多线程。因为所有用户界面更新和触摸交互都发生在主线程上，如果你有一些计算量很大的东西或者只是需要很多时间来执行，如果你在你的主线程上运行它，你似乎已经冻结了你的应用。这是一种糟糕的用户体验，因此您希望将此任务移至后台线程，以便用户可以在此过程中继续与您的应用程序交互。此外，越来越多的 iOS 设备每天都在出货，其中包含多个内核，并且在这些内核之间平衡您的工作负载并高效使用此硬件需要一定程度的并发处理。

人们已经写过有关编写多线程代码时的最佳实践的书籍，您可以在这里找到很多关于此的问题，因此我不会过多详细说明。我可以告诉你的是，你应该阅读 Apple 的[并发编程指南](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html)并观看过去两年处理 Grand Central Dispatch 的 WWDC 视频。借助 GCD，Apple 以高效且（相对）安全的方式将多线程添加到您的应用程序变得更加容易，我鼓励您为自己的应用程序研究这一点。

例如，我有一个开源 iOS 应用程序，它可以执行分子结构的详细渲染。我在后台 GCD 队列上渲染每一帧，因为有时它们需要超过 1/60 秒的时间来处理，在这些情况下，如果这一切都在主线程上，它们会导致触摸事件被丢弃并且界面卡顿. 此外，当在较新的多核设备上运行时，我已经看到了高达 40% 的性能提升。为了避免竞争条件，我将与共享数据结构和上下文的交互包装在串行调度队列中，这样无论特定块在哪个线程上运行，一次只能有一个操作使用资源。这只需要添加几行代码，但性能和用户体验的好处是巨大的。

# batch-file - executing all the .reg files from batch file

> ID：10952703
> 
> 赞同：1
> 
> 时间：2012-06-08T16:31:32.473
> 
> 标签：batch-file, batch-processing

I have following script that executes all the .reg files in the current directory. the problem is i also have sub directories in that folder and i want to execute those reg files as well. I am not sure what switch i am supposed to use. i tries using `/s` which returns all the .reg files of the drive.

this is how my batch file looks like:

```
rem @echo off
cls
SET folder=%~dp0
for %%i in ("%folder%*.reg") do (regedit /s "%%i")
echo done
pause
EXIT 
```

This is how file/directory structure looks like:

```
Folder1
   batchfile.bat -> user double clicks or executes from command prompt
   1.reg
   2.reg
   3.reg
   Folder2
      4.reg
      5.reg 
```

what am i missing here?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:37:04.133

I think that you need a recursive `for` loop using the `/R` switch:

```
for /R "%folder%" %%i in (*.reg) do (regedit /s "%%i") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T18:37:47.710

You didn't actually say what your problem was, so instead of fixing your script here's what I would have done:

```
@echo off
set folder=%~dp0
for /f "usebackq" %%i in (`dir /s /b *.reg`) do (
        regedit /s "%%i"
) 
```

And the `/s` script on regedit is for silent mode. It tells regedit not to ask the user for confirmation with a dialog box. The `for` loop is what causes the batch file to loop through all subdirectories, not the `/s` switch on regedit.

From [Microsoft's Knowledge Base](http://support.microsoft.com/kb/82821):

```
[/s|-s]
When a filename is specified on the command line, this switch is used to 
suppress any informational dialog boxes that would normally be displayed.
This is useful when the Setup program for an application wants to execute
REGEDIT.EXE with a .REG file, but does not want the user to be confused by
any dialog boxes that are displayed. 
```

# java - 使用 JButton 的 actionListener 向 JTable 添加行

> ID：10952708
> 
> 赞同：0
> 
> 时间：2012-06-08T16:31:41.797
> 
> 标签：java, jtable, jbutton, actionlistener, defaulttablemodel

以下是我尝试添加创建 JButton 的代码，它将向连接的 JTable 添加一行。

我的变量如下所示，表和 tbm 已创建，但在当前未显示的程序的另一部分中初始化。这些都是实例变量。

```
int currentUser = 0;
JTable[] tables = new JTable[5];
DefaultTableModel[] tbm = new DefaultTableModel[5];
JButton[] addRow = new JButton[5] 
```

这是使用动作侦听器创建 JButton 的代码。

```
for(int i=0;i<tbm.length;i++) {
addRow[i] = new JButton("Add Row");
selectionModel = tables[i].getSelectionModel();
currentUser=i;
addRow[i].addActionListener(new ActionListener() {public void actionPerformed(ActionEvent e) {
Object[] temp = {"",""};
tbm[currentUser].addRow(temp);
selectionModel.setSelectionInterval(tbm[currentUser].getRowCount()-1,tbm[currentUser].getRowCount()-1);
}});
} 
```

我稍后使用从 0-tables.length 运行的 for 循环将 JTable 和 JButton 组装到 JPanel 中，并将其放入相应的 JFrame 中。这里的问题是，当我按下按钮时，会触发错误的 actionListener。例如，在第 0 帧中按下“Add Row”应该会触发 addRow[0]，但会触发 addRow[4]。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:45:12.087

`tables[currentUser]`每当单击任何按钮时，您都会在表格中添加一行。听起来您想`table[X]`在单击按钮 X 时添加一行。这是快速而肮脏的方法：

```
for(int i=0;i<tbm.length;i++) {
    final int tblIdx = i;
    addRow[i] = new JButton("Add Row");
    selectionModel = tables[i].getSelectionModel();
    currentUser=i;
    addRow[i].addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e) {
            Object[] temp = {"",""};
            tbm[tblIdx].addRow(temp);
            selectionModel.setSelectionInterval(tbm[tblIdx].getRowCount()-1,tbm[tblIdx].getRowCount()-1);
        }
    });
} 
```

你不能`i`直接传递给你的匿名`ActionListener`变量，因为它不是一个最终变量，所以在循环的每次迭代开始时，都会`tblIdx`创建一个临时的最终变量并将其设置为`i`当前的任何值。

我个人会通过子类化`ActionListener`并将表索引作为参数传递给构造函数来实现这一点，但这只是我。

# python - 在 python 中测试数据生成框架？

> ID：10952710
> 
> 赞同：4
> 
> 时间：2012-06-08T16:31:44.590
> 
> 标签：python, testing, test-data, data-generation

有没有专门针对 Python 的“测试数据”生成框架？

为了清楚起见，我不想从头开始编写脚本，用随机用户和其他实体填充我的数据库，我想知道是否有任何工具/框架可以使它更容易，

更清楚地说，我不是在寻找测试框架，我想生成测试数据来“加载”我的应用程序。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T15:34:13.857

[http://code.google.com/p/fake-data-generator/](http://code.google.com/p/fake-data-generator/) 看起来像你想要的。我倾向于只使用具有适当上限和下限的范围以及自由使用列表。如果您需要您的测试数据来匹配您的人口分布，那么您需要做更多的工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-17T04:16:52.293

如果您不想编写任何代码，请尝试[Mockaroo](http://mockaroo.com "莫卡罗")。这是一个免费的网络应用程序，可让您生成多种不同格式的随机测试数据表，例如 XML、JSON、Excel、CSV。您最多可以免费生成 1000 行。

# c# - Control.BeginInvoke 执行顺序

> ID：10952711
> 
> 赞同：0
> 
> 时间：2012-06-08T16:31:48.883
> 
> 标签：c#, begininvoke

调用 BeginInvoke() 时，委托会按照调用方法的顺序返回吗？还是不能保证哪些代表会先回来？

```
 public Form1()
    {
        InitializeComponent();

        for (int i = 0; i < 100; i++)
        {
            Thread t = new Thread(DisplayCount);
            t.Start(i);
        }
    }

    public void DisplayCount(object count)
    {
        if (InvokeRequired)
        {
            BeginInvoke(new Action<object>(DisplayCount), count);
            return;
        }

        listBox1.Items.Add(count);
    } 
```

并且整数列表将乱序返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:21:40.943

[`Control.BeginInvoke()`](http://msdn.microsoft.com/en-us/library/ae5kdt95)将异步执行操作，但在 UI 线程上。

如果您`BeginInvoke()`使用不同的操作多次调用，它们将按完成最快的顺序返回。

作为旁注，您可能应该在调用周围使用某种同步机制`listBox1.Items.Add(count)`，也许锁定它的`SynchRoot`属性。

来自[MSDN - ListBox.ObjectCollection 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.objectcollection.aspx)

> 此类型的任何公共静态（在 Visual Basic 中为 Shared）成员都是线程安全的。不保证任何**实例成员都是线程安全**的。

（重点补充）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:42:45.377

如果你多次调用同一个函数，那么它们应该以相同的顺序返回，也许！如果您有一个分析 1 TB 数据集的函数，而另一个函数只是进行一些日志记录，那么我认为它们不会以相同的顺序返回。它还取决于您为 BeginInvoke 设置的[DispatcherPriority 。](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherpriority.aspx)低优先级 like`SystemIdl`将稍后执行，然后执行更高优先级 like `Send`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-31T14:13:51.427

如果您使用启动线程`Thread.Start()`，则线程函数的执行在该调用之后的随机时间异步发生。这就是我认为你得到随机数的原因。

# r - 重新编码字符字段中的缺失数据

> ID：10952714
> 
> 赞同：1
> 
> 时间：2012-06-08T16:31:59.650
> 
> 标签：r

注意：标题可能具有误导性。如果您理解我的问题并想到更具描述性的内容 - 请更改它。

我遇到了一个奇怪的情况，调查的回答都是字符，而不是数字。看来R，真的不喜欢这样。假设我问了一个问题：

```
Q. In what area do you work? 
East
West
Central
North
South
None of the above 
```

但受访者仅来自东部、西部和中部。

```
dat <- rep(c("East", "West", "Central"),100) 
```

现在，出于演示目的，重要的是我包括北、南和以上都不是，即使它们都不是。然而，将这些因素考虑在内是具有挑战性的。

咱们试试吧：

```
fac1 <- factor(dat, labels=c("East","West","Central","North","South","None of the above"))

Error in factor(dat, labels = c("East", "West", "Central", "North", "South",  : 
  invalid labels; length 6 should be 1 or 3 
```

基本上，我想做的是将这些数据与缺失值结合起来。因此，当我输入类似 summary(fac1) 的内容时，它会显示他们在该类别中有 0 个响应。

必须有一个更简单的方法来做到这一点！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:35:28.740

差不多好了。您需要使用以下`levels`参数：

```
fac1 <- factor(dat, levels=c("East","West","Central","North","South","None of the above"))
str(fac1)
 Factor w/ 6 levels "East","West",..: 1 2 3 1 2 3 1 2 3 1 ... 
```

* * *

`levels`和之间的区别`labels`是这样的：

*   `levels`定义数据中的因子水平
*   `labels`允许您一次性重命名因子水平。

例如：

```
fac2 <- factor(
  dat, 
  levels=c("East","West","Central","North","South","None of the above"),
  labels=c("E", "W", "C", "N", "S", "Other")
)
str(fac2)
Factor w/ 6 levels "E","W","C","N",..: 1 2 3 1 2 3 1 2 3 1 ... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:43:21.733

不是专家，但这有帮助吗？

```
fac1 <- factor(dat, levels = 
               c("East","West","Central","North","South","None of the above"))
summary(fac1) 
```

# c++ - 更改 QGraphicsView 中的光标

> ID：10952715
> 
> 赞同：9
> 
> 时间：2012-06-08T16:32:00.310
> 
> 标签：c++, qt, qt4, qgraphicsview

我正在尝试更改一段`QGraphicsView`时间的光标`ScrollHandDrag`，但它似乎不起作用。如果我禁用光标，我可以更改光标，`ScrollHandDrag`但在它处于活动状态时不这样做，我看不出我可能做错了什么......

波纹管是重现问题的一部分代码：

```
QApplication app(argc, argv);
QGraphicsScene scene;
QRect rectangle(-8, -4, 100, 100);
QPen pen(Qt::blue, 1, Qt::SolidLine);
scene.addRect(rectangle, pen);
scene.setBackgroundBrush(Qt::white);
QGraphicsView vue(&scene);
vue.setFixedSize(250, 250);
//vue.setDragMode(QGraphicsView::ScrollHandDrag);
vue.setCursor(Qt::CrossCursor);
vue.show();

return app.exec(); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-08T17:54:10.133

`QGraphicsView`拖动时会自动更改光标，但您可以通过重新实现一些功能轻松解决此问题：

```
class CoolView : public QGraphicsView
{
protected:
    void enterEvent(QEvent *event)
    {
        QGraphicsView::enterEvent(event);
        viewport()->setCursor(Qt::CrossCursor);
    }

    void mousePressEvent(QMouseEvent *event)
    {
        QGraphicsView::mousePressEvent(event);
        viewport()->setCursor(Qt::CrossCursor);
    }

    void mouseReleaseEvent(QMouseEvent *event)
    {
        QGraphicsView::mouseReleaseEvent(event);
        viewport()->setCursor(Qt::CrossCursor);
    }
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T16:45:43.397

从 Qt 的源代码中查看，当您进入拖动模式时，它们似乎控制了该光标，并且无法阻止它们尝试。

我知道的唯一解决方法是使用`QApplication::setOverrideCursor()`并将`QApplication::restoreOverrideCursor()`全局设置光标。不幸的是，这意味着您必须在鼠标光标进入/离开时进行大量管理，`QGraphicsView`以防止您的整个应用程序在任何地方都被同一个光标卡住。

还值得注意的是光标是在视口级别设置的，所以这样做会稍微合适一些`vue.viewport()->setCursor(Qt::CrossCursor)`

参考文档：

[QApplication::setOverrideCursor](http://foo.com "标题")

[QApplication::restoreOverrideCursor](http://qt-project.org/doc/qt-4.8/qapplication.html#restoreOverrideCursor)

[QApplication::changeOverrideCursor](http://qt-project.org/doc/qt-4.8/qapplication.html#changeOverrideCursor)

# r - 当列表项失败或花费太长时间时，如何使 lapply 超时？

> ID：10952724
> 
> 赞同：12
> 
> 时间：2012-06-08T16:32:26.363
> 
> 标签：r, multicore, plyr

对于我目前参与的几项工作，我正在通过一系列函数运行具有大量参数组合的大型数据集。这些函数有一个包装器（所以我可以`mclapply`），以便在集群上进行操作。但是，我遇到了两个主要挑战。

a) 我的参数组合很大（想想 20k 到 100k）。有时特定的组合**会**失败（例如，生存率太高而死亡率太低，因此模型永远不会收敛为假设情景）。我很难提前确定哪些组合会失败（如果我能做到这一点，生活会更轻松）。但现在我有这种类型的设置：

```
failsafe <- failwith(NULL, my_wrapper_function)
# This is what I run
# Note that input_variables contains a list of variables in each list item
results <-  mclapply(input_variables, failsafe, mc.cores = 72)
# On my local dual core mac, I can't do this so the equivalent would be:
results <-  llply(input_variables, failsafe,  .progress = 'text') 
```

我的包装函数的骨架如下所示：

```
my_wrapper_function <- function(tlist) {
    run <- tryCatch(my_model(tlist$a, tlist$b, tlist$sA, tlist$Fec, m = NULL) , error=function(e) NULL)
...
return(run)
} 
```

这是最有效的方法吗？如果由于某种原因变量的特定组合使模型崩溃，我需要它返回 a`NULL`并继续其余的。但是，我仍然有这样的问题，即它失败得不够优雅。

b) 有时某些输入组合**不会**使模型崩溃，但需要很长时间才能收敛。我对集群上的计算时间设置了限制（比如 6 小时），所以我不会将资源浪费在卡住的东西上。如何包含超时，以便如果函数调用在单个列表项上花费的时间超过 x 时间，它应该继续？计算花费的时间是微不足道的，但不能中断模拟中间的函数来检查时间，对吧？

任何想法，解决方案或技巧都值得赞赏！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-08T17:23:39.167

您很可能能够使用包的组合`tryCatch()`和`evalWithTimeout()`来自`R.utils`包的组合来管理优雅退出。 [另请参阅这篇文章](https://stackoverflow.com/questions/8652681/limiting-the-time-that-a-function-processes-in-an-r-for-loop/8653049#8653049)，它提供了类似的代码*并*更详细地对其进行了解包。

```
require(R.utils)

myFun <- function(x) {Sys.sleep(x); x^2}

## evalWithTimeout() times out evaluation after 3.1 seconds, and then
## tryCatch() handles the resulting error (of class "TimeoutException") with 
## grace and aplomb.
myWrapperFunction <- function(i) {
    tryCatch(expr = evalWithTimeout(myFun(i), timeout = 3.1), 
             TimeoutException = function(ex) "TimedOut")
}

sapply(1:5, myWrapperFunction)
# [1] "1"        "4"        "9"        "TimedOut" "TimedOut" 
```

# php - 将php值发送到extjs中的另一个文件

> ID：10952725
> 
> 赞同：0
> 
> 时间：2012-06-08T16:32:34.383
> 
> 标签：php, extjs4

我需要使用 extjs4 将 php 变量的值传递给另一个文件，我在页面顶部有这个：

```
$userid = $_POST['userid']; 
```

这是我的 extjs 代码

```
echo("
{
    title: 'Users',
    xtype: 'gridpanel',
    autoScroll: true,
    layout: 'fit',
    store: {
        storeId: 'test',
        fields: [
            {name: 'ID', type: 'string'},
            {name: 'Name', type: 'string'},
            {name: 'Admin', type: 'string'}
        ],
        proxy: {
            type: 'ajax',
            url : 'GetScripts/getUsers.php',
            reader: 'json'
        },
        autoLoad: true
    }, 
```

我需要将 $userid 传递给 getUsers.php。我可以得到一些帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:39:12.643

在您的代理中，您可以像这样指定 URL 参数：

```
echo("
{
    title: 'Users',
    xtype: 'gridpanel',
    autoScroll: true,
    layout: 'fit',
    store: {
        storeId: 'test',
        fields: [
            {name: 'ID', type: 'string'},
            {name: 'Name', type: 'string'},
            {name: 'Admin', type: 'string'}
        ],
        proxy: {
            type: 'ajax',
            url : 'GetScripts/getUsers.php',
            reader: 'json',
            extraParams: { 
               userid: " . $userid . "
            }
        },
        autoLoad: true
    }, 
```

此外，当您加载商店时，您也可以传递参数

```
store.load({
    params : {
       userid : whateverUserId
    }
}); 
```

# c++ - 错误 C2661：“CObject::operator new”：没有重载函数需要 4 个参数

> ID：10952731
> 
> 赞同：3
> 
> 时间：2012-06-08T16:33:06.707
> 
> 标签：c++, memory-leaks, mfc, compiler-errors, memory-leak-detector

我有一个内存泄漏，我正试图在我的 mfc 程序中寻找它。通常，我会执行以下操作：

头文件

```
// Leak Detection
#if defined(WIN32) && defined(_DEBUG)
     #define _CRTDBG_MAP_ALLOC
     #include <stdlib.h>
     #include <crtdbg.h>
#endif 
```

.cpp 文件

```
// Leak detection
#if defined(WIN32) && defined(_DEBUG) && defined(_CRTDBG_MAP_ALLOC)
    #ifdef DEBUG_NEW 
        #undef DEBUG_NEW
    #endif
    #define DEBUG_NEW new( _NORMAL_BLOCK, __FILE__, __LINE__ )
    #define new DEBUG_NEW
#endif 
```

这种技术适用于大多数文件，但是当我将它包含在某些文件（例如我的文档）中时，我收到错误：错误 C2661：'CObject::operator new'：没有重载函数需要 4 个参数

这里有什么解决方案？我应该在某个地方#undef-ing 新事物吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T12:15:14.830

我也使用与您相同的功能来进行泄漏检测。

假设您不再需要它来捕获内存泄漏，您可以注释掉或删除 DEBUG_NEW 定义块。或者，如果您仍然需要它，请保持原样并使用

```
#ifdef _DEBUG
#undef new
    CMyOject* pMyObjectInst = new CMyObject();
#define new DBG_NEW
#endif 
```

因此，您在创建对象之前取消定义 new（请参阅错误列表中的行号）并在之后立即重新定义它，以便在此对象创建之后发生的任何内存泄漏仍然可以识别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-18T08:23:10.573

我在 .cpp 文件中放置了`#define new DEBUG_NEW`before语句导致了类似的问题。`#include ...`更改顺序解决了我的问题。

# linux - Perl 中的 SVN 预提交符号链接路径

> ID：10952732
> 
> 赞同：0
> 
> 时间：2012-06-08T16:33:06.883
> 
> 标签：linux, svn, unix, symlink

在我的工作场所，每次有人尝试为 10-20 个项目中的任何一个将文件签入到 SVN 存储库时，都会在 Unix 机器上运行一个 Perl 脚本。

它的工作方式是每个项目都有自己的“Hooks”文件夹，其中包含一个名为“pre-commit”的文件，当有人签入某些东西时，SVN 会自动执行该文件。除了“预提交”文件实际上是所有项目通用的一个中央 Perl 脚本的符号链接，因此如果需要对 Perl 脚本进行更改，则不需要对每个项目都进行更改。

所以我的问题是这样的：我需要在每个项目的“钩子”目录中放置一个文本文件，每个文件都包含一些特定于该项目的设置。因此，在它们各自的“钩子”目录中将有 10-20 个设置文件（每个项目一个）。

问题是我需要在 Perl 脚本中打开这些文本文件并从中读取，但我在让 Perl 知道在哪里找到它时遇到了问题。我尝试使用 $0 参数，它应该告诉我从哪里执行脚本，但因为它是一个符号链接，它只是说“不是目录”并且脚本终止。我需要获取“钩子”目录的路径，以便找到文本文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T02:51:12.077

SVN 预提交脚本应该以存储库的路径作为其第一个参数来调用。在 Perl 脚本中，该参数应该以`$ARGV[0]`. 您应该能够通过简单地附加到存储库路径来构建到相应的**钩子**目录或该目录内的文件的路径，如下所示：

```
$repopath = $ARGV[0];
$hookspath = $repopath . "/hooks";
$myfilepath = $hookspath . "/myfile"; 
```

尽管为了获得最大的可移植性，使用 File::Spec 模块中的路径名操作函数来执行此操作会更简洁。

如果这种方法不起作用，那么您将不得不详细说明如何调用您的 Perl 脚本。例如，如果您的预提交脚本实际上是一个最终调用的 shell 脚本包装器，`perl`那么它可能没有正确传递预提交参数。

向我们展示您当前失败的代码也是一件好事。

# qt - QML 从单击的矩形缩放到另一个 UI 元素

> ID：10952733
> 
> 赞同：2
> 
> 时间：2012-06-08T16:33:09.227
> 
> 标签：qt, qml, qt-quick

我在带有Repeater的主QML表单上有9：9的矩形元素矩阵。我想要实现的是，如果用户单击其中一个矩形，它会缩放到 TextEdit 小部件，该小部件在 Esc 按下时会缩小。

1.  QML可以吗？
2.  如果是，我应该如何将 Rectangle 转换为 TextEdit 并缩放此 TextEdit 以填充父级？

刚开始使用 QML，还不能从[http://doc.qt.nokia.com/4.7-snapshot/qdeclarativeanimation.html](http://doc.qt.nokia.com/4.7-snapshot/qdeclarativeanimation.html)得到答案。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-21T15:09:28.960

1）当然！这或多或少是 QML 的用途。

2）这是一个例子，你可以做你想做的事（不是唯一的方法）：

```
Rectangle {
  id: parentRect
  width: 500; height: 500

  // Every item in the grid should look like this
  Rectangle {
    id: singleItem
    color: "red"
    state: "closed"

    // Hidden text input, shown when user clicks
    TextInput {
      id: textInput
      anchors.fill: parent
      text: "Input here"
      cursorVisible: true
    }

    // MouseArea that will catch the user click
    MouseArea {
      anchors.fill: parent
      onClicked: singleItem.state = "open"
    }

    // Item states
    states: [
      State {
        name: "closed"
        PropertyChanges {target: singleItem; width: 25; height: 25}
        PropertyChanges {target: textInput; opacity: 0}
      },
      State {
        name: "open"
        PropertyChanges {target: singleItem; width: parentRect.width; height: parentRect.height}
        PropertyChanges {target: textInput; opacity: 1; focus: true}
      }
    ]

    // Transitions between states
    transitions: Transition {
      ParallelAnimation {
        NumberAnimation {
          target: singleItem
          properties: "width,height"
          duration: 1000
        }
        NumberAnimation {
          target: textInput
          property: "opacity"
          duration: 1000
        }
      }
    }
  }

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-11T04:19:59.500

Even I'm new to qt-quick. I don't think it is possible to zoom unless we write our code to do such. I'm not sure though. :-)

This effect is good and it will b nice to see in coming versions. Try to give a feature request to the community <3

# objective-c - 获取 UIView 中的所有对象？

> ID：10952735
> 
> 赞同：0
> 
> 时间：2012-06-08T16:33:23.267
> 
> 标签：objective-c, ios, xcode, uiview

是否可以获取我从一个视图控制器传递到另一个视图控制器的 UIView 的所有对象（无需从父视图控制器获取它们）？就像是

```
NSArray *objects = [myView getAllObjects]; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T16:42:43.660

子视图？是的：

`NSArray *subviews = myView.subviews`

[UIView 属性的 Apple Doc：子视图](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW17)

如果那不是你的意思，你将不得不进一步澄清你的问题......

* * *

**编辑：**一些快速提示...

请记住，您可以`for(UIView *subview in myView.subviews) {...}`轻松地遍历它们。

我*真的*不建议挂在单个方法之外/之外的指向该子视图数组（或任何副本）的指针。

# python - 在 python 中出现名称错误。当另外两个名字起作用时，一个名字不起作用..！

> ID：10952736
> 
> 赞同：0
> 
> 时间：2012-06-08T16:33:23.957
> 
> 标签：python

我是 Python 的初学者；如果我写这段代码，它会显示：

```
 Traceback (most recent call last):
  File "C:/Python32/ultimate tym remaining.py", line 37, in <module>
    print("so the reamining time is %d hour, %d minutes and %d seconds" %(hr,minr,sr))
 NameError: name 'minr' is not defined 
```

我的代码是：

```
hg=12
mg=00
sg=00
hn=10
mn=47
sn=49

if(mg>mn & hg>hn):
    hr=hn+24-hn-1
elif(mg<mn & hg>hn):
    hr=hn+24-hg
elif(mg>mn & hg<hn):
    hr=hn-hg-1
elif(mg<mn & hg<hn):
    hr=hn-hg
elif(hg==hn):
    hr=0

if(sg<sn & mg>mn):
    minr=mn+60-mg
elif(sg<sn & mg<mn):
    minr= mn-mg
elif(sg>sn & mg>mn):
    minr=mn+60-mg-1
elif(sg>sn & mg<mn):
    minr=mn-mg-1
elif(mg==mn):
    minr=0

if(sg>sn):
    sr=sn+60-sg
elif(sg<sn):
    sr=sn-sg
elif(sf==ss):
    sr=0

print("so the reamining time is %d hour, %d minutes and %d seconds" %(hr,minr,sr)) 
```

为什么会这样？为什么是`hr`和`sr`工作，`minr`而不是？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T16:35:40.090

以下`if`构造定义`minr`：

```
if(sg<sn & mg>mn):
    minr=mn+60-mg
elif(sg<sn & mg<mn):
    minr= mn-mg
elif(sg>sn & mg>mn):
    minr=mn+60-mg-1
elif(sg>sn & mg<mn):
    minr=mn-mg-1
elif(mg==mn):
    minr=0 
```

发生的事情很简单：没有一个条件恰好是`True`，`minr`未定义。这甚至可以在修复逻辑 AND 运算符之后发生 -正如 Amber 指出的那样， 它是`and`, not 。可能会成立，而.`&``sg == sn``mg != mn`

# php - 未设置 PHP 会话变量

> ID：10952740
> 
> 赞同：0
> 
> 时间：2012-06-08T16:33:47.193
> 
> 标签：php, session

我有一个奇怪的问题。

我有一个我管理的车展网站的注册脚本，但旧代码无缘无故被破坏。我知道它以前有效，但现在不行。

我正在正确设置会话变量。我将整个变量数组保存到会话中，并且我知道一旦表单被提交，会话就会工作，因为表单会重新加载到新页面，并且我会显示注册信息以进行确认。但是，该脚本随后会继续到 PayPal 页面，在该页面中它会引导用户完成付款流程。然后，它会在付款过程完成后重定向回将注册信息提交到 MySQL 数据库的站点。

但是，当用户返回到提交数据的确认页面时，会话变量是完全空白的。我已经回显了所有变量，但那里什么都没有。

为了测试它的中断位置，我在填写表单后在您被带到的页面上放置了一个链接，该链接直接链接到信息被转储到 SQL 服务器的确认页面。当您链接链接时，信息仍然存在。但是，如果您要使用相同的 URL 并将其粘贴到地址栏中（也就是不使用链接），则变量为空白。

所以在这一点上，我不知道为什么当您链接并单击页面时变量很好，但当您将相同的 url 传递到地址栏中而不单击链接时却没有。会话在每个页面上开始，并且都在同一个域名上。

有什么帮助吗？！

===== 编辑 ===== 测试代码（给出一个粗略的想法）

我如何设置会话变量。session_start(); 在加载此站点上的每个页面时调用该函数，以便在其他页面之间保持连续性：

```
$storedVars = array(1 => $name, $email, $state, $year, $make, $model, $generation, $color, $now, $paymentType);
$_SESSION['registration']=$storedVars; 
```

在将信息发送到数据库的 PayPal 之后的确认页面上，运行以下代码（同样，session_start()；已调用）：

```
$storedVars = $_SESSION['registration'];
$name = $storedVars[1];
$email = $storedVars[2];
$state = $storedVars[3];
$year = $storedVars[4];
$make = $storedVars[5];
$model = $storedVars[6];
$generation = $storedVars[7];
$color = $storedVars[8];
$now = $storedVars[9]; 
```

第 10 个数组变量，paymentType，此时不需要，因为它只用于表单提交后的页面）

在按照贝宝上的步骤或在填写表格后将正确的 URL 粘贴到地址栏中后，在确认页面上回显这些变量时，什么都没有。但是.. 当您在提交表单后单击数据验证页面上的链接时，变量仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-22T19:35:36.077

您的最后一条评论让我相信您的会话设置在[http://yoursite.com/](http://yoursite.com/)并且您发送给 PayPal 的返回 url 是[http://www.yoursite.com/](http://www.yoursite.com/)（反之亦然）。“www”实际上是您的基本域的子域，就您的浏览器而言，它被认为是不同的主机。

长话短说，在使用 paypal 设置您的令牌时，使用以下内容作为返回 url：

```
$_SERVER["HTTP_HOST"] . "/Path/To/PaypalReturnPage.php" 
```

# c++ - 无法找到异常来源：内存位置的 cudaError_enum

> ID：10952742
> 
> 赞同：3
> 
> 时间：2012-06-08T16:33:47.677
> 
> 标签：c++, cuda

我正在尝试确定 Microsoft C++ 异常的来源：

> test_fft.exe 中 0x770ab9bc 处的第一次机会异常：Microsoft C++ 异常：内存位置 0x016cf234 处的 cudaError_enum ...

我的构建环境是：

*   IDE：Microsoft Visual C++ 2010 Express
*   英伟达驱动程序：301.27
*   CUDA：NVIDIA CUDA 工具包 v4.2（32 位）
*   SDK：NVIDIA GPU 计算 SDK 4.2（32 位）

**问题范围**：我试图将 CUFFT 包装在 C++ 类后面。这样，我可以隐藏从一种数据类型到 cufftComplex 的转换、FFT 的执行和调用代码的内存传输。

**类头**：

```
#ifndef SIGNAL_PROCESSING_FFT_HPP
#define SIGNAL_PROCESSING_FFT_HPP

#include "signal_processing\types.hpp"

#include <boost/cstdint.hpp>

#include <cufft.h>

#include <vector>

namespace signal_processing {

    class FFT {
    public:

        FFT ( boost::uint32_t size );

        virtual ~FFT();

        void forward ( ComplexVectorT const& input, ComplexVectorT& output );

        void reverse ( ComplexVectorT const& input, ComplexVectorT& output );

    private:

        cufftComplex* m_device_data;

        cufftComplex* m_host_data;

        cufftHandle m_plan;

        boost::uint32_t m_size;
    };

}

#endif // SIGNAL_PROCESSING_FFT_HPP 
```

FFT构造函数：

```
FFT::FFT ( boost::uint32_t size )
        : m_size ( size )
    {
            CudaSafeCall ( cudaMalloc((void**)&m_device_data, sizeof(cufftComplex) * m_size ) );
            m_host_data = (cufftComplex*) malloc ( m_size * sizeof(cufftComplex) );
            CufftSafeCall ( cufftPlan1d ( &m_plan, m_size, CUFFT_C2C, 1 ) );
    } 
```

在调用 cudaMalloc 的第一行的 FFT 构造函数中引发了 Microsoft C++ 异常。只有当我使用带有 Visual Studio 调试器的 FFT 类运行代码时，才会出现此错误。

* * *

## **参考**

**CudaSafeCall 定义**

```
#define CudaSafeCall(err) __cudaSafeCall ( err, __FILE__, __LINE__ ) 
```

**__cudaSafeCall 定义**

```
inline void __cudaSafeCall ( cudaError err, const char* file, const int line )
{
#ifdef CUDA_ERROR_CHECK
        if ( cudaSuccess != err )
        {
            std::cerr << boost::format ( "cudaSafeCall() failed at %1$s:%2$i : %3$s\n" )
                % file
                % line
                % cudaGetErrorString ( err );
            exit(-1);
        }
#endif
        return;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-08T12:47:57.077

您所做的观察与在 CUDA 库中正确捕获和处理的异常有关。在某些情况下，这是 CUDA GPU 操作的正常部分。我相信在这种情况下您的应用程序不会返回任何 API 错误。如果您不在可以报告此问题的 VS 环境中，则根本不会观察到这一点。

这被认为是 CUDA 下的正常行为。我相信在 CUDA 5.5 中有一些消除它的尝试。您可能希望尝试这样做，尽管这两种方式都不被视为问题。

# sql-server - SQL Server BIDS OLE DB 输入

> ID：10952745
> 
> 赞同：0
> 
> 时间：2012-06-08T16:33:59.890
> 
> 标签：sql-server, bids

我有一个脚本组件和一个 OLE DB 目标。我的脚本有 3 列要返回。如何将这 3 列中的每一列映射到 OLE DB 目标？

每当我将连接器从脚本组件拖到 OLE DB 时，它都会让我恰好选择 1 个输出列。当我再次尝试使用另一个输出列时，BIDS 告诉我 OLE DB 目标没有可用的输入列。

是否可以有多个输入到 OLE DB 目标？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:59:21.540

您需要在脚本转换中创建输出列。在输入和输出选项卡中展开 Output0 并指定您想要的列。

![脚本](../Images/aeb795c01cd841bdca6e03d4854515ba.png)

# c3p0 - c3p0 的 JdbcProxyGenerator 是如何工作的（Java 中的元编程‽）？

> ID：10952746
> 
> 赞同：2
> 
> 时间：2012-06-08T16:34:00.397
> 
> 标签：c3p0

几年来我一直在使用 c3p0 和休眠。在查看异常堆栈跟踪时，我会看到`com.mchange.v2.c3p0.impl.NewProxyPreparedStatement`堆栈中的类。我去寻找这些类的源代码并遇到了好奇的`com.mchange.v2.c3p0.codegen`包。

特别是，看起来[JdbcProxyGenerator](http://grepcode.com/file/repo1.maven.org/maven2/c3p0/c3p0/0.9.1.2/com/mchange/v2/c3p0/codegen/JdbcProxyGenerator.java "grepcode.com - c3p0 - JdbcProxyGenerator")是 Java 中的元编程。我很难理解代码生成机制以及使用它的原因。构建的 jar 包含这些生成的类，所以我假设这些类是在构建过程中构建的，可能是两阶段构建的一部分。codegen 包似乎不在生成的 jar 中。

出于我自己的好奇心，任何见解都会受到赞赏。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T22:54:46.557

是的，你是完全正确的。

c3p0 使用代码生成来生成大型 JDBC 接口的非反射代理实现、具有大量属性的“java bean”类以及一些包含调试和日志标志的类（在构建中设置条件编译）。

您总是可以通过在源代码分发中键入 ant codegen 来查看生成的类，然后查看 build/codebase 目录。[c3p0 (0.9.2-pre2) 的最新二进制发行版在 src.jar 文件中包含生成的源代码，您也可以在http://repo1.maven.org/maven2/com/mchange/](http://repo1.maven.org/maven2/com/mchange/c3p0/0.9.2-pre2-RELEASE/c3p0-0.9.2-pre2-RELEASE-sources.jar)上找到它作为 maven 工件[c3p0/0.9.2-pre2-RELEASE/c3p0-0.9.2-pre2-RELEASE-sources.jar](http://repo1.maven.org/maven2/com/mchange/c3p0/0.9.2-pre2-RELEASE/c3p0-0.9.2-pre2-RELEASE-sources.jar)

我希望这有帮助！

* * *

# java - JTextArea - 向上或向下滚动时突出显示文本

> ID：10952747
> 
> 赞同：1
> 
> 时间：2012-06-08T16:34:04.063
> 
> 标签：java, swing, jscrollpane, jtextarea

我正在尝试使用添加到 JScrollPane 的不可编辑的 JTextArea。我希望当用户单击该特定行时突出显示该行。我可以使用以下代码来实现这部分：

```
public static void initHighlightOption(final JTextArea textArea){

    textArea.setFont(new Font("Courier New", Font.PLAIN, 12));
    textArea.setEditable(false);

    final Action selectLine = getAction(textArea, DefaultEditorKit.selectLineAction);

    textArea.addMouseListener(new MouseAdapter() {

        @Override
        public void mouseClicked(MouseEvent e) {
            if (SwingUtilities.isLeftMouseButton(e) && e.getClickCount() == 1) {
                selectLine.actionPerformed(null);
            }
     });

    textArea.setSelectionStart(0);
    textArea.setSelectionEnd(0);
}

public static Action getAction(JTextArea textArea, String name) {
    Action action = null;
    Action[] actions = textArea.getActions();

    for (int i = 0; i < actions.length; i++) {
        if (name.equals(actions[i].getValue(Action.NAME).toString())) {
            action = actions[i];
            break;
        }
    }

    return action;
} 
```

我要补充的是，一旦突出显示一行并且用户使用键盘向上/向下键向上/向下滚动，我希望突出显示当前行。这可以通过添加 keyListener 来实现吗？我被困在向上滚动时如何突出显示数据。

文本区域包含如下数据：

```
Line1
Line2

Line3

Line4
Line5 
```

（即两个特定数据行之间可能有新行）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:30:20.477

你的要求不是那么容易做到的。首先使用 JTextPane 而不是 JTextArea，它会更容易处理。您将需要从中获取 Highlighter 对象

```
Highlighter hl = textPane.getHighlighter(); 
```

并且每次用户使用箭头键滚动时，您可能必须跟踪插入符号的位置。这样做时，您需要以编程方式更改亮点；就像是：

```
Highlighter.Highlight myHighlight = null;
Highlighter.Highlight[] highlights = textPane.getHighlighter().getHighlights();
myHighlight = highlights[0]; //assuming there is one only

try {
      hl.changeHighlight(myHighlight, myHighlight.getStartOffset()+1, myHighlight.getEndOffset());
}
catch(BadLocationException e) {
      e.printStackTrace();
} 
```

你可以把它放在你的 onKeyReleased() 方法中。你有点明白你将要做什么。阅读在 Java API 文档中使用 JTextPane 和 Highlighter 类，它真的会帮助你很多。

# java - Elastic beanstalk 中的简单 C 程序

> ID：10952749
> 
> 赞同：3
> 
> 时间：2012-06-08T16:34:24.637
> 
> 标签：java, c, amazon-web-services, java-native-interface, amazon-elastic-beanstalk

我认为对于任何知道自己在做什么的人来说，我正在尝试做的事情应该是非常容易的，但是我编写过的几乎毫无例外的唯一语言是 C。我做得很差。我正在尝试在与 C 程序对话的弹性 beantalk 上创建一个 webapp。我目前的计划是使用 JNI 创建一个本机函数，当有人填写表单并按下按钮时，我可以在主 jsp 页面上调用该函数。

到目前为止，在 C 端，我已经编写了一个函数，其中包含 C 程序执行所需的所有操作所需的 7 个输入变量和 7 个输出变量。我不需要访问数据库或做任何困难的事情，我只需要传入 7 个变量和 7 个变量。

我已经设置了一个具有本机方法的 java 类。我给了它一个主函数，它插入虚拟变量并打印出结果。当我在一个没有任何包名或任何使其复杂化的目录中编译它时，JNI 就可以工作（我无法让它与包名一起使用。）所以我有一个 .so 文件和一个 .class 文件等等作品。

另一方面，我采用了 AWS 为您提供的初步介绍 webapp。将它下载到我的机器上并解压缩war文件（Eclipse添加了一堆样板和结构，我不相信我有能力使用ant等新工具进一步复杂化它或进行编译（我对javac非常满意） ，javah和jar，非常感谢））。我在索引 .jsp 页面上创建了一个表单，一些接受输入变量的 javascript 对它们执行一个函数，然后将输出数据粘贴到表单上。

据我所知，我现在需要做的就是从 .jsp 调用 java 类，这应该将整个事情联系在一起。我知道可能有更好的方法来做到这一点。如果我违反了 webapp 编程的一些深层原则或存在安全问题，请告诉我。（例如，我将继续清理我的数据输入）。我似乎无法弄清楚该怎么做。一个 hello world 的例子会很有帮助。我需要在 web.xml 文件中添加任何内容吗？我隐约知道 .class 文件位于 classes 目录中。.so 文件在哪里？

总结：有没有更简单的方法来做我正在做的事情（更少的语言/程序/代码行？）（我知道有*更好*的方法）我正在做的事情以某种方式危险吗？如何从 index.jsp 调用 java 类？web.xml 必须有什么吗？如何编译 JNI 以在 .class 文件以外的其他位置找到 .so 文件？我可以将 .so 文件与类文件一起粘贴吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T01:06:40.850

我会将 .so 文件放在 $CATALINA_HOME/shared/lib 文件夹中的任何位置。

如果你不想把它放在那里，也许你想指定 java.library.path 的值作为传递给 java 运行时环境的选项之一（例如 java -Djava.library.path=/path/to/ my.so ... )，这意味着您可能需要破解 tomcat 启动器，或者您可以将此选项添加到 JAVA_OPTS 环境变量中。

# javascript - 带有动态表单的jQuery验证插件

> ID：10952750
> 
> 赞同：2
> 
> 时间：2012-06-08T16:34:35.333
> 
> 标签：javascript, jquery, ajax, jquery-validate

如果尚未创建表单，如何使用此代码（来自[演示）：](http://jquery.bassistance.de/validate/demo/ajaxSubmit-intergration-demo.html)

```
jQuery("#form").validate({
  submitHandler: function(form) {
    jQuery(form).ajaxSubmit({
      target: "#result"
    });
  }
}); 
```

一种不起作用的方法是`on('click',`像这样调用验证：

```
$(document.body).on('click', '.submitBtn', function(){
   var $form =$('form'+this.id);
       $form.validate({
         submitHandler: function($form) {
           $form.ajaxSubmit({
             target: "#result"
           });
         }
       });
}); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T16:39:24.130

`jQuery("#form").validate().form()`创建表单后 尝试使用。[http://docs.jquery.com/Plugins/Validation/Validator/form](http://docs.jquery.com/Plugins/Validation/Validator/form)

```
$(document.body).on('click', '.submitBtn', function(){
   var $form =$('#form'+this.id);
       $form.validate({
         submitHandler: function($form) {
           $($form).ajaxSubmit({  //need to properly refer to jQuery object
             target: "#result"
           });
         }
       }).form();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:35:57.100

我认为这个类似问题的答案可以帮助你很多[https://stackoverflow.com/a/4359915/351366](https://stackoverflow.com/a/4359915/351366)

这是使其更具体到您的代码的一个镜头

创建一个自定义事件以在您的表单出现在页面上时触发

```
$(document).bind('bindForm', function (e) {
    jQuery("#form").validate({
        submitHandler: function(form) {
          jQuery(form).ajaxSubmit({
             target: "#result"
          });
        }
    });
}); 
```

然后当你的表单被加载时，触发你的自定义事件

```
$(document).trigger('bindForm'); //trigger our validate form 
```

当您想检查您的表单在另一个函数中是否有效时

```
$(".submitBtn").live("click",function() {
    if (!$("#form").validate().form()) {
        return;
    }
}); 
```

# c++ - 我如何知道像素相对于相机的位置（以厘米或毫米为单位）？

> ID：10952751
> 
> 赞同：1
> 
> 时间：2012-06-08T16:34:54.177
> 
> 标签：c++, visual-studio-2010, image, image-processing, opencv

为了计算图像中像素的 3D 位置，我如何知道像素相对于相机的位置（以厘米或毫米为单位）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:51:33.273

尝试几个这样的网站

[http://insight3d.sourceforge.net/](http://insight3d.sourceforge.net/)

[http://autodesk.blogs.com/between_the_lines/2011/10/from-iphone-4s-photo-to-3d-model.html](http://autodesk.blogs.com/between_the_lines/2011/10/from-iphone-4s-photo-to-3d-model.html)

[https://superuser.com/questions/30053/is-there-any-free-open-source-software-that-c​​onverts-photos-to-3d-models](https://superuser.com/questions/30053/is-there-any-free-open-source-software-that-converts-photos-to-3d-models)

从这里开始！！！

# .net - DTO 和 IQueryable：组装和拆卸 DTO

> ID：10952756
> 
> 赞同：3
> 
> 时间：2012-06-08T16:35:15.807
> 
> 标签：.net, asp.net-mvc, entity-framework, telerik, dto

我正在开发一个项目，该项目使用汇编器模式将 LinqToEntity 实体组装成服务级别的数据传输对象，然后将其传递给客户端层以供使用。该方法已将实体对象转换为提供特定于服务调用的信息的简化的平面对象。

例如。

```
// Original Entity looks something like this
public class PersonEntity
{
   public int Id { get; set; }
   public string FirstName { get; set; }
   public string LastName { get; set; }
   public int MotherId { get; set; }  
   public PersonEntity Mother { get; set; }
   // lots of other properties
}

// Flattened DTO
public class PersonSummaryInfo
{
  public int Id { get; set; }
  public string FullName { get; set; }
  public string MothersFullName { get; set; }
} 
```

在此示例中，汇编器将创建 PersonSummaryInfo，构建流程的 FullNames 部分。

我现在面临一些第 3 方控件（Telerik ASP.NET MVC GridControl）的问题，其中控件设置为根据其模型的属性进行过滤（使用 IQueryable）。似乎您有一个单层设计并将您的数据库实体直接泵入视图，我无法忍受。

试图将其合并到我的逻辑中，GridControl 绑定到我的 DTO 而不是实体，这一切都很好，直到它尝试对任何东西进行排序。我以非常通用的方式将所有 IQueryable 的东西都推到了我的服务中，以使其对此负责。排序尝试排序，比如 DTO 上的 MothersFullName（它的行为是将“MothersFullName”作为字符串传递给您的排序逻辑），这被推送到我的服务，该服务通过反射尝试对实体进行排序，利用 IQueryable 惰性加载，但当然在执行查询时，会抛出异常，因为“MothersFullName”不是原始实体的属性。

是否有一个很好的策略来处理这种实现？一旦 DTO 回到应用程序的服务层，将其有效地“分解”回其 ORM 实体是一种好习惯吗？还是传递更丰富的对象更好，这些对象对它们有更多的了解（例如如何使用 FirstName 和 LastName 对全名进行排序）？

我的要求的关键是：

*   使用花哨的 Telerik 控件，因为他们喜欢它
*   服务级别的延迟加载结果（即不带回 200 万条记录，只显示 10 条）
*   支持过滤、分页等
*   完善的架构实现

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T17:42:45.980

你有几个选择。首先，确实能够绑定到 IQueryable，因为当然就开发时间而言，这是最快（也是最常见）的方式。

在您的情况下（ORM 之上的完整服务层）情况有点不同。我个人建议您深入挖掘并为您的网格提供[自定义绑定。](http://www.telerik.com/help/aspnet-mvc/telerik-ui-components-grid-data-binding-custom-binding.html)您将获得一个 GridCommand 对象，您可以查询该对象以进行排序和过滤，并使用该对象向您的服务层询问数据。这是一个很好的地方来提及解决您面临的问题的简单方法（这是您的表达式基于 DTO 属性）。您可以尝试使用[Dynamic Linq](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)。只需从表达式构造您的字符串查询并将它们传递给您的 DAL。

事实上，这是 Telerik 的另一个产品 OpenAccess ORM 建议的最佳实践。[OpenAccess SDK](http://www.telerik.com/products/orm/features/sdk.aspx)包含几个示例（尤其是 WCF 普通服务），它们使用与您的架构相似的架构。该产品还提供了一个[代码生成工具](http://blogs.telerik.com/openaccessteam/posts/12-05-31/take-the-shortcut-to-web-services-in-q2-12-with-the-add-openaccess-service-wizard.aspx)，可提供整个服务层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T20:36:48.187

您是否仅将 RadGrid 用于其开箱即用的排序功能？我遇到了同样的问题，最后只使用了 RadListView 并将寻呼机/排序插入其中。使用模板，您可以通过 SortExpession 属性准确地告诉它要排序的内容。然后它只是关于触发正确的事件。这是我的事件处理程序，你可以设置任何你能拿到的东西来触发它。我不确定这是否是一个解决方案，但希望它可以帮助您找到一个：

```
protected void SortSearchTickets(object sender, RadComboBoxSelectedIndexChangedEventArgs e)
    {
        var selectedValue = e.Value;
        lsvSearchResults.SortExpressions.Clear();
        var sortExp = new RadListViewSortExpression();

        switch (selectedValue)
        {
            case "ID":
                sortExp.FieldName = "TicketID";
                break;
            case "TicketType":
                sortExp.FieldName = "TypeDescription";
                break;
            case "Subject":
                sortExp.FieldName = "Subject";
                break;
            case "Status":
                sortExp.FieldName = "Status.Key";
                break;
            case "DueDateDesc":
                sortExp.FieldName = "DueDate";
                sortExp.SortOrder = RadListViewSortOrder.Descending;
                break;
            case "DueDateAsc":
                sortExp.FieldName = "DueDate";
                sortExp.SortOrder = RadListViewSortOrder.Ascending;
                break;
            case "Assigned To":
                sortExp.FieldName = "AssignedTo.Key";
                break;
            case "Assigned By":
                sortExp.FieldName = "AssignedBy.Key";
                break;
            default:
                break;
        }
        lsvSearchResults.SortExpressions.AddSortExpression(sortExp);
        lsvSearchResults.Rebind();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T16:07:07.343

用这个解决方案。

创建包含 Grid 特定列的 sql 视图。然后使数据传输对象使用与视图完全匹配的属性。这不是实现这一目标的最干净或最强大的方法，但至少它可以从我不需要的项目中获取我的数据引用。

没有使用动态 linq，而是保留了我的通用方法并使用反射来获取列名以进行匹配。没有因为我们已经实现了整个服务层而选择 Telerik 的 Open Access，但这听起来是一个不错的解决方案。

它仍然是 IQueryable，因此它非常有效地运行良好（仅依赖于开发人员来确保 GridViews 与 GridViewModels 匹配，属性的属性）。

# c - C中的逻辑相等

> ID：10952759
> 
> 赞同：9
> 
> 时间：2012-06-08T16:35:23.273
> 
> 标签：c, boolean, equality

[好像很奇怪这个不存在，所以如果它是重复的，请提前道歉]

我想测试 C 中的逻辑相等性。换句话说，我想知道如果两个值都以与逻辑表达式相关的正常方式进行转换，两个值是否相等。

在 C99 中，我认为

```
(bool)a == (bool)b 
```

给我想要的。那是对的吗？用传统 C 写这个的正常方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-08T16:37:08.387

您通常会看到：

```
if ((a == 0) == (b == 0)) 
```

或者

```
if (!!a == !!b) 
```

`!!a`如果 a 为非零，则为 1，否则为 0 。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T16:40:02.753

在 C 中，零是错误的。如果您想将任何值转换为其等效的布尔值，标准方法（嗯，除了几乎不需要它）是在表达式`!!`前面加上`!!a`. 在你的表达的情况下， `!!a == !!b` 可以简化为 `!a == !b`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T16:43:57.193

在 C99 之前的 C 中，“转换为 bool”的传统惯用方式是使用`!!`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T16:39:14.517

传统的c中没有`(bool)`。True/False 使用`int`s 处理。您可以检查布尔相等性

```
a ? b : !b 
```

# erlang - ?_assertEqual 失败时显示完整的预期和值信息

> ID：10952767
> 
> 赞同：5
> 
> 时间：2012-06-08T16:36:07.027
> 
> 标签：erlang, eunit

我正在编写一个单元测试，其中生成了一个（相当长的）二进制文件，我想断言生成的二进制文件等于我期望生成的那个。我正在通过“ **rebar eunit** ”运行 eunit。

问题是，当这个断言失败时，输出会缩写为“ **...** ”，我想查看完整的输出，以便找出不同之处。

我现在使用“ **?debugFmt()** ”作为临时解决方案，但我想知道是否有替代方案（可以应用于“ **?_assertEqual()** ”的配置选项或参数，所以输出仅在断言失败时显示）。

提前致谢！

编辑：由于**legoscia的**回答，我包括一个使用测试生成器的测试样本，有多个断言：

```
can_do_something(SetupData) ->
    % ... some code ... 
    [?_assertEqual(Expected1, Actual1), ?_assertEqual(Expected2, Actual2)]. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-15T16:57:37.540

我能想到的在控制台中实际显示值的最好方法是这样的：

```
Actual =:= Expected orelse ?assert(?debugFmt("~p is not ~p", [Actual, Expected])) 
```

`?debugFmt`返回`ok`，这是不正确的，因此断言将始终失败。

或者，要将其用作测试生成器，可以将整个东西放在里面`?_assert`：

```
?_assert(Actual =:= Expected orelse ?debugFmt("~p is not ~p", [Actual, Expected])) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-15T16:44:34.400

我通常实现这一点的方法是让 Eunit 输出 XML 文件（以“Surefire”格式，又名“Junit”格式）。XML 文件对术语打印深度有更高的限制，因此可能包含您需要的信息。

将此添加到您的`rebar.config`：

```
{eunit_opts, 
 [verbose,
  %% eunit truncates output from tests - capture full output in
  %% XML files in .eunit
  {report,{eunit_surefire,[{dir,"."}]}}]}. 
```

然后你可以在 中找到模块的`foo`结果`.eunit/TEST-foo.xml`。我发现这些文件在文本编辑器中可读性很强。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-02-15T02:49:59.440

1）。打开你的 eunit 源。在我的系统中：

```
cd /usr/lib/erlang/lib/eunit-2.3.2/src 
```

2）。以这种方式编辑 eunit_lib.erl：

```
diff

54c54
<     format_exception(Exception, 20).
---
>     format_exception(Exception, 99999). 
```

3）。`sudo erlc -I ../include eunit_lib.erl`

4）。`mv eunit_lib.beam ../ebin`

5）。祝你有美好的一天））

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-03-25T16:08:15.730

[此 PR](https://github.com/erlang/otp/pull/2532)介绍了以下`print_depth`选项`eunit:test/2`：

```
eunit:test(my_test, [{print_depth, 200}]). 
```

它应该从 OTP-23 开始可用。

设置`print_depth`为较大的数字将减少输出的截断。

# ruby-on-rails - Rails 通过 respond_to format.json 显示 XML 文件中的数据

> ID：10952769
> 
> 赞同：0
> 
> 时间：2012-06-08T16:36:09.763
> 
> 标签：ruby-on-rails, xml, json

我有一个 XML 文件，其中包含需要向用户显示的文本数据。我正在使用 ember.js，因此需要以 json 格式提供我的响应。

我最初的想法是加载 XML 文件并使用 XSLT 将其转换为 json，然后渲染它。但是，我并不完全理解 respond_to format.json 方法是如何工作的。猜测一下，我会说它将实例变量的结果转换为 json，所以如果我的数据已经在 json 中，使用这种方法会不会给我带来任何问题？

将我的 XML 文件呈现为 json 视图的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:17:33.703

如果你想结合 json 和 xml 特性，你可以使用 rabl： [https ://github.com/nesquena/rabl](https://github.com/nesquena/rabl)

# python - 从多个字典中提取到 csv

> ID：10952770
> 
> 赞同：1
> 
> 时间：2012-06-08T16:36:17.043
> 
> 标签：python, list, csv, dictionary

我目前有一个字典列表，其中字典包含按这样的关键字排序的列表。每个字典中的列表长度相同，但因字典而异，并且每个字典中的关键字数量相同。

```
dicts[file1] = {Header1:[1,2,3], Header2:[4,5,6],... etc}
dicts[file2] = {Header1:[7,8,9,0], Header2:[4,3,7,7],... etc}
...
dicts[filen] = {...} 
```

我想从每个字典中提取两个列表（比如“Header1”和“Header5”），并将它们并排放入一个 .csv 文件中，并为那些没有其他列表长的列表填充空格。

我几乎 100% 确定要使用 izip_longest，但我正在努力使用 izip_longest 的正确格式来完成此操作。我想我的主要问题是我不知道在 *args 中放入什么来正确循环。

任何帮助将不胜感激。

编辑：按要求编码。

```
writefiel = open(somefile.csv, delimiter=',')
xcolumn = 'Header1'
ycolumn = 'Header5'
for i in len(dicts):
    for lines in izip_longest(*dicts[i][xcolumn], fillvalue=['']*2):
        writefile.writerow([dicts[i][xcolumn],dicts[i][ycolumb]]) 
```

这只是行不通，但是我一直在努力解决格式问题，并且无法弄清楚我做错了什么。

csv 输出我想看起来像这样。

```
Header1,Header5,Header1,Header5,Header1,Header5,...
1,2,4,6,3,8...
1,2,,,3,8,... 
```

回答：

首先感谢大家帮助我。这就是我最终的结果。如果您看到任何可以改进它的方法，我很乐意听到它，这样我就可以提高我的技能。

```
xhold =(list(izip_longest(*(d[xcolumn] for d in dicts), fillvalue='')))
yhold =(list(izip_longest(*(d[ycolumn] for d in dicts), fillvalue='')))

writefile.writerow([xcolumn, ycolumn, '']*len(xhold))
for i in range(len(xhold)):
    row=[]
    for j in range(len(xhold[i])):
        row=row+[xhold[i][j],yhold[i][j],'']
    writefile.writerow(row) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:38:09.130

也许这个？

```
import itertools
itertools.izip_longest([1,2,3,4],[7,8])

lists_to_extract = ['Header1','Header2']
long_list_of_dicts = [{'Header1':[1,2,3], 'Header2':[4,5,6], 'Header3':[7,8,9]},
             {'Header1':[7,8,9,0], 'Header2':[4,3,7,7], 'Header3':[14,13,17,17]}]

print [list(itertools.izip_longest(*(d[key] for d in long_list_of_dicts),
             fillvalue=' ')) for key in lists_to_extract]
#Output:
[[(1, 7), (2, 8), (3, 9), (' ', 0)], [(4, 4), (5, 3), (6, 7), (' ', 7)]] 
```

# linq - 使用 ASP.NET 将三级数据层次结构呈现到 HTML 表中

> ID：10952771
> 
> 赞同：0
> 
> 时间：2012-06-08T16:36:16.917
> 
> 标签：linq, nested

假设我在 C# 中有一些 Airport、Aeroplane、Passenger 和 Seat 类。乘客的 id 是飞机，飞机的 id 是机场。乘客也有一个座位的 ID。

我将如何编写一个 linq 查询以将它们构建到层次结构中，然后将它们呈现到 HTML 表中？

我需要它看起来像：

```
 1      2      3
Gatwick  
747       July   Kim    Ben
767       Neal   Toby
A380      Becky

Hong Kong
747       Gary   Steve  Gary
MiG-35    Ted

etc.. 
```

（座位号在顶部）

多年来，我一直在 LinqPad 前摸不着头脑，但我只能在层次结构中获得一层。我想我可能需要使用嵌套的 GridViews 或者编写一个自定义控件来呈现结果对象，但不确定最好的方法。

理想情况下，我想用一个查询来获取所有数据（以前的程序员已经使用每个单元格一个查询完成了它，页面需要一分钟才能加载！）

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:41:05.667

这将需要 2 个 LINQ 查询：

1.  您必须按座位号分组（或使用 .Distinct() 获取座位号）。使用它来输出列；
2.  然后按机场分组，然后按飞机分组，然后在每个飞机分组中，您都有乘客 - 您将 .Join() 他们与您的座位集合。

    ```
    passengers
      .GroupBy(p => p.Aeroplane)
      .GroupBy(p => p.Airport)
      .Join(seats, p=>p.Seat, s=>s, (p,s)=>new { Passenger = p, Seat = seat }) 
    ```

这将为您在每架飞机和每个机场提供一系列乘客和他们各自的座位。

# ajax - Apache Solr：从 solrconfig.xml 为 CORS 设置 HTTP 响应标头

> ID：10952777
> 
> 赞同：8
> 
> 时间：2012-06-08T16:36:39.413
> 
> 标签：ajax, solr, http-headers, cors

是否可以从文件中设置自定义 HTTP 响应标头的发送`solrconfig.xml`？我认为可能可以向该`<requestDispatcher>`部分添加一些配置，因为它控制缓存标头。

我确信这在 servlet 容器配置（Jetty、Tomcat 等）中是可能的，但如果可能的话，我想在 Solr 的配置文件中执行此操作。

如果这有什么不同，我正在尝试为`Access-Control-Allow-Origin`来自不同主机的 CORS AJAX 请求设置标头。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T17:04:36.837

您可以改用 JSONP。有关示例，请参见此链接

*   [Solr 和 JSONP](http://xplus3.net/2010/09/21/solr-and-jsonp/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-09T15:07:24.880

最简单的方法是编写自定义`javax.servlet.Filter`并在那里添加`Access-Control-Allow-Origin`标题。有关处理 HTTP 处理的代码，请参见`org.apache.solr.servlet.SolrDispatchFilter`类。

这是您继续进行的最简单方法。如果您查看 SolrDispatchFilter 中的 doFilter - 对 HTTP 标头的唯一操作是缓存它们，并且没有地方以某种方式接触它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T02:40:06.850

前端 solr 与 apache，并 conf apache 发回标头。例如，

```
Header set X-Server-Name "abc0.com" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-28T22:20:16.783

我发现[这](https://gist.github.com/Wavewash/70532f2cc945a830627e)很有帮助。您需要添加几个码头 jar 和 webdefault.xml 更改才能启用 CORS。

我在这里复制文本：

* * *

在示例 solr 项目中，当您通过调用以下行启动它时：

java -jar 启动

您正在本地机器上启动一个 Jetty 服务器，它将提供 solr 结果。此服务器无法进行 CORS（跨源资源共享）。这意味着如果您尝试从与服务器本身不同来源的网页进行 AJAX 调用，您将被拒绝响应。

要解决此问题，您首先需要获取适当的 jar 以允许跨域资源共享。

我使用了以下罐子： [http ://repo1.maven.org/maven2/org/eclipse/jetty/jetty-servlets/8.1.10.v20130312/](http://repo1.maven.org/maven2/org/eclipse/jetty/jetty-servlets/8.1.10.v20130312/)

但是您可能需要获得适合您的码头版本的版本： [http ://repo1.maven.org/maven2/org/eclipse/jetty/jetty-servlets/](http://repo1.maven.org/maven2/org/eclipse/jetty/jetty-servlets/)

您可以通过以下方式找到您正在使用 solr 示例运行的 Jetty 版本：java -jar start --version

您将看到如下转储： C:\Users\username\Desktop\solr-4.8.0\example>java -jar start.jar --version Active Options: [default, *] 18 个条目的版本信息类路径。注意：此处显示的顺序是它们在类路径中的显示方式。对 OPTIONS=[option,option,...] 命令行选项的更改将反映在他身上。

```
0:                (dir) | ${jetty.home}\resources
 1:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-xml-8.1.10.v20130312.jar
 2:  3.0.0.v201112011016 | ${jetty.home}\lib\servlet-api-3.0.jar
 3:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-http-8.1.10.v20130312.jar
 4:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-continuation-8.1.10.v20130312.jar
 5:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-server-8.1.10.v20130312.jar
 6:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-security-8.1.10.v20130312.jar
 7:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-servlet-8.1.10.v20130312.jar
 8:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-webapp-8.1.10.v20130312.jar
 9:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-deploy-8.1.10.v20130312.jar
10:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-servlets-8.1.10.v20130312.jar
11:                1.7.6 | ${jetty.home}\lib\ext\jcl-over-slf4j-1.7.6.jar
12:                1.7.6 | ${jetty.home}\lib\ext\jul-to-slf4j-1.7.6.jar
13:               1.2.16 | ${jetty.home}\lib\ext\log4j-1.2.16.jar
14:                1.7.6 | ${jetty.home}\lib\ext\slf4j-api-1.7.6.jar
15:                1.7.6 | ${jetty.home}\lib\ext\slf4j-log4j12-1.7.6.jar
16:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-util-8.1.10.v20130312.jar
17:     8.1.10.v20130312 | ${jetty.home}\lib\jetty-io-8.1.10.v20130312.jar 
```

查找 ${jetty.home}\lib\jetty-server 行（在第 5 行上方的转储中），您应该能够看到您的版本。

您还需要为您的码头版本获取“jetty-util”：http: [//mvnrepository.com/artifact/org.mortbay.jetty/jetty-util](http://mvnrepository.com/artifact/org.mortbay.jetty/jetty-util)

您应该可以在那里找到您的版本。我使用了 jetty-util-8.1.10.v20130312.jar。

现在将您下载的 servlet.jar 和 util.jar 文件放入以下文件夹：solr-4.8.0\example\lib

对于您的版本，它可能会有所不同，但您希望它位于示例目录下的 lib 文件夹中。

最后，为了让这些更改生效，您需要打开 solr-4.8.0\example\etc\webdefault.xml

并在之前添加以下行`</web-app>`：

```
 <filter>
       <filter-name>cross-origin</filter-name>
       <filter-class>org.eclipse.jetty.servlets.CrossOriginFilter</filter-class>
   </filter>
   <filter-mapping>
       <filter-name>cross-origin</filter-name>
       <url-pattern>/*</url-pattern>
   </filter-mapping> 
```

现在重新启动您的服务器，您应该启用了 CORS。

注意：如果您开始喜欢并在 solr 示例码头服务器上运行多个 web 应用程序，那么这将影响所有这些 web 应用程序。请注意，您已将 url 模式设置为识别任何对生产设置有危险的域。这仅用于本地测试。

此外，我确实尝试更改 webapps 文件夹中的 web.xml 文件，以便这些更改将保持在本地，但经过数小时的尝试后，我放弃了，发现将它放在全局 webdefault 中是可行的。

# javafx-2 - 场景生成器中的编码

> ID：10952785
> 
> 赞同：0
> 
> 时间：2012-06-08T16:37:12.427
> 
> 标签：javafx-2

我使用 Scene Builder 生成了一个 FXML 文件。我需要它包含一些西里尔文字。

当我使用 Scene Builder 编辑此文件时，我可以看到正常的西里尔字母[（屏幕 1）](https://dl.dropbox.com/u/45422316/scene%20builder/sb1.PNG)

用这个 FXML 文件编译并运行我的程序后，我看不到西里尔字母，而是一些人工制品[（屏幕 2）](https://dl.dropbox.com/u/45422316/scene%20builder/sb4.PNG)

但是，正如您在[屏幕 3](https://dl.dropbox.com/u/45422316/scene%20builder/sb2.PNG)上看到的，它的 xml 文件编码是 UTF-8。此外，您可以在那里看到它以 ANSI 格式保存。

我尝试使用其他编辑器（默认 eclipse 和 sublime text 2）打开它，但它们也使用了错误的编码。（[屏幕 4](https://dl.dropbox.com/u/45422316/scene%20builder/sb5.PNG)和[屏幕 5](https://dl.dropbox.com/u/45422316/scene%20builder/sb3.PNG)）

起初，我尝试将其从 ansi 转换为 utf-8（使用 notepad++）。

之后 eclipse 和 sublime text 2 开始显示西里尔字母，因为它们必须是。

但。当我试图用它打开这个文件时，场景生成器给出了一个错误：

```
Error loading file 
C:\eclipse\workspace\pr\src\main\java\ru\i\ava\pr\test.fxml.
C:\eclipse\workspace\pr\src\main\java\ru\i\ava\pr\test.fxml:1: ParseError 
at [row,col]:[1,1]
Message: Content is not allowed in prolog. 
```

java编译器给了我一个错误：

```
 июн 08, 2012 8:11:03 PM javafx.fxml.FXMLLoader logException
 SEVERE: javax.xml.stream.XMLStreamException: ParseError at [row,col]:[1,1]
 Message: Content is not allowed in prolog.
 /C:/eclipse/workspace/pr/target/classes/ru/i/ava/pr/test.fxml:1
 at javafx.fxml.FXMLLoader.load(Unknown Source)
 at javafx.fxml.FXMLLoader.load(Unknown Source)
 at javafx.fxml.FXMLLoader.load(Unknown Source)
 at javafx.fxml.FXMLLoader.load(Unknown Source)
 at javafx.fxml.FXMLLoader.load(Unknown Source)
 at javafx.fxml.FXMLLoader.load(Unknown Source)
 at ru.i.ava.pr.PrFX.start(PrFX.java:22)
 at com.sun.javafx.application.LauncherImpl$5.run(Unknown Source)
 at com.sun.javafx.application.PlatformImpl$4.run(Unknown Source)
 at com.sun.javafx.application.PlatformImpl$3.run(Unknown Source)
 at com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
 at com.sun.glass.ui.win.WinApplication.access$100(Unknown Source)
 at com.sun.glass.ui.win.WinApplication$2$1.run(Unknown Source)
 at java.lang.Thread.run(Unknown Source)

 Exception in Application start method
 Exception in thread "main" java.lang.RuntimeException: Exception in Application start method
at com.sun.javafx.application.LauncherImpl.launchApplication1(Unknown Source)
at com.sun.javafx.application.LauncherImpl.access$000(Unknown Source)
at com.sun.javafx.application.LauncherImpl$1.run(Unknown Source)
at java.lang.Thread.run(Unknown Source)
 Caused by: javafx.fxml.LoadException: javax.xml.stream.XMLStreamException: ParseError at    
 [row,col]:[1,1]
 Message: Content is not allowed in prolog.
at javafx.fxml.FXMLLoader.load(Unknown Source)
at javafx.fxml.FXMLLoader.load(Unknown Source)
at javafx.fxml.FXMLLoader.load(Unknown Source)
at javafx.fxml.FXMLLoader.load(Unknown Source)
at javafx.fxml.FXMLLoader.load(Unknown Source)
at javafx.fxml.FXMLLoader.load(Unknown Source)
at ru.i.ava.pr.PrFX.start(PrFX.java:22)
at com.sun.javafx.application.LauncherImpl$5.run(Unknown Source)
at com.sun.javafx.application.PlatformImpl$4.run(Unknown Source)
at com.sun.javafx.application.PlatformImpl$3.run(Unknown Source)
at com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
at com.sun.glass.ui.win.WinApplication.access$100(Unknown Source)
at com.sun.glass.ui.win.WinApplication$2$1.run(Unknown Source)
... 1 more
    Caused by: javax.xml.stream.XMLStreamException: ParseError at [row,col]:[1,1]
    Message: Content is not allowed in prolog.
at com.sun.org.apache.xerces.internal.impl.XMLStreamReaderImpl.next(Unknown Source)
at javax.xml.stream.util.StreamReaderDelegate.next(Unknown Source)
... 14 more 
```

因此，我已将其转换回 ANSI。

并且，在 ANSI 中拥有此文件，手动将其“人工”文本更改为西里尔字母。

现在我在运行程序时可以看到普通文本，但是当我通过 Scene Builder 打开这个固定文件时，

Scene Builder 向我展示了一些“人为的”文本[（屏幕 7）](https://dl.dropbox.com/u/45422316/scene%20builder/sb7.PNG)。

那么，我该如何解决这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T07:07:43.400

我刚刚发现[新版本](http://www.oracle.com/technetwork/java/javafx/downloads/devpreview-1429449.html)的 Scene Builder 没有这样的问题。

# parallel-processing - Cilk 或 Cilk++ 或 OpenMP

> ID：10952789
> 
> 赞同：4
> 
> 时间：2012-06-08T16:37:32.510
> 
> 标签：parallel-processing, openmp, cilk, cilk-plus

我正在 Linux 中创建一个多线程应用程序。这是场景：

假设我有一个类的 x 实例`BloomFilter`并且我有一些 y GB 的数据（大于可用内存）。我需要在每个布隆过滤器实例中测试这 y GB 数据的成员资格。很明显，并行编程将有助于加快任务速度，因为我只读取数据，因此它可以在所有进程或线程之间共享。

现在我对使用 Cilk、Cilk++ 还是 OpenMP（哪个更好）感到困惑。此外，我对多线程或多处理选择哪一个感到困惑

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-09T16:07:07.827

Cilk Plus 是英特尔当前对 Cilk 的实施。它们都是多线程环境，即在执行期间产生多个线程。

如果您不熟悉并行编程，OpenMP 可能更适合您，因为它允许更轻松地并行化已开发的顺序代码。您是否已经有代码的顺序版本？

OpenMP 使用 pragma 指示编译器哪些部分的代码必须并行运行。如果我正确理解你的问题，你可能需要这样的东西：

```
 #pragma omp parallel for firstprivate(array_of_bloom_filters)
   for i in DATA:
      check(i,array_of_bloom_filters); 
```

不同的布隆过滤器的实例在每个线程中复制，以避免在线程之间共享数据时发生争用。

**更新：** 本文实际上考虑了一个非常不平衡的应用程序，即不同的任务（分配在不同的线程上）可能会产生非常不同的工作负载。引用你提到的论文“一个高度不平衡的任务图，挑战调度、负载平衡、终止检测和任务粗化策略”。考虑到为了平衡线程之间的计算，有必要减少任务大小，从而增加同步所花费的时间。换句话说，良好的负载平衡总是要付出代价的。您的问题的描述不是很详细，但在我看来，您遇到的问题是相当平衡的。如果不是这种情况，那就选择 Cilk，它的工作窃取方法可能是不平衡工作负载的最佳解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-20T14:08:50.167

在发布此消息时，英特尔正在大力推动 Cilk(tm) Plus；最近，一些工作已转向 OpenMP 4.0。通常很难将 OpenMP 与 Cilk(tm) Plus 进行对比。
如果不可能在线程之间均匀分配工作，可能会在 OpenMP 版本中设置 schedule(runtime)，然后在运行时尝试环境变量的各种值，例如 OMP_SCHEDULE=guided、OMP_SCHEDULE=dynamic,2 或 OMP_SCHEDULE=汽车。这些是与 Cilk(tm) Plus 窃取工作方式最接近的 OpenMP 类比。英特尔 MKL 库中的一些稀疏矩阵函数实际上会首先扫描作业并确定分配给每个线程的数量以平衡工作。为了使这种方法有用，串行扫描和分配所花费的时间必须低于并行工作所花费的时间。工作窃取或动态调度可能会失去 OpenMP 在提升缓存局部性方面的许多潜在优势，例如通过 OMP_PROC_BIND=close 来固定具有缓存局部性的线程。在 NUMA 架构上，糟糕的缓存局部性成为一个更大的问题，它可能导致在远程内存访问上花费大量时间。OpenMP 和 Cilk(tm) Plus 都具有在串行和并行执行之间切换的功能。

# ruby-on-rails - ActionMailer::Base.deliveries 在 Rspec 中始终为空

> ID：10952799
> 
> 赞同：5
> 
> 时间：2012-06-08T16:38:16.473
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, rspec2, rspec-rails

我正在尝试使用 rspec 测试一些邮件程序，但交付始终是空的。这是我的 rspec 测试：

```
require "spec_helper"

describe "AccountMailer", :type => :helper do
  before(:each) do
    ActionMailer::Base.delivery_method = :test
    ActionMailer::Base.perform_deliveries = true
    ActionMailer::Base.deliveries = []
  end

  it "should send welcome email to account email" do
    account = FactoryGirl.create :account
    account.send_welcome_email

    ActionMailer::Base.deliveries.empty?.should be_false
    ActionMailer::Base.deliveries.last.to.should == account.email
  end
end 
```

它失败了：

```
1) AccountMailer should send welcome email to account email
     Failure/Error: ActionMailer::Base.deliveries.empty?.should be_false
        expected true to be false 
```

我的 send_welcome_email 函数如下所示（这是我的模型）：

```
def send_welcome_email 
    AccountMailer.welcome self
end 
```

还有我的邮件：

```
class AccountMailer < ActionMailer::Base
  default from: APP_CONFIG['email']['from']

  def welcome data
    if data.locale == 'es'
      template = 'welcome-es'
    else
      template = 'welcome-en'
    end

    mail(:to => data.email, :subject => I18n.t('welcome_email_subject'), :template_name => template)
  end
end 
```

有任何想法吗？我不确定如何进行。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-08T18:09:40.680

您是否在实际运行应用程序时测试过它是否正常工作？也许您的测试失败是正确的。

我注意到`deliver`当你创建邮件时你从来没有打电话，所以我怀疑测试失败了，因为实际上没有发送电子邮件。我希望你的`send_welcome_email`方法看起来更像

```
def send_welcome_email 
  AccountMailer.welcome(self).deliver
end 
```

# android - NumberPickerPreference - 未加载默认值

> ID：10952801
> 
> 赞同：0
> 
> 时间：2012-06-08T16:38:17.453
> 
> 标签：android, preferenceactivity, dialog-preference

我想使用 NumberPicker 首选项。

基本上代码按预期工作。一个带有 NumberPicker 的对话框打开。可以选择该值并将其保存到 defaulSharedPreferences。

但是在第一次启动 PreferenceActivity 时，默认值没有加载，我不知道为什么。

行为是这样的：当我打开 PreferenceActivity 时，NumberPickerPreference 的摘要显示-1。当我关闭 Activity 并再次重新打开它时，值保持在 -1 （只要 defaultSharedPreferences 在存储的键下没有值）。一旦用户选择了一个值（或者一个值通过键下的代码保存到 defaultSharedPreferences 中），一切都会起作用，并且在 PreferenceActivity 启动时加载该值。

```
 public class NumberPickerPreference extends DialogPreference implements NumberPicker.OnValueChangeListener
    {
        private static final String NAMESPACE="http://schemas.android.com/apk/res/android";

        private NumberPicker mNumberPicker;
        private TextView mTvDialogMessage;
        private Context mCtx;

        private String mDialogMessage;
        private int mDefault;
        private int mMax;
        private int mValue = 0;

        public NumberPickerPreference(Context ctx, AttributeSet attr) { 
            super(ctx, attr); 
            mCtx = ctx;

            //Get XML attributes
            mDialogMessage = attr.getAttributeValue(NAMESPACE,"dialogMessage");
            mDefault = attr.getAttributeIntValue(NAMESPACE,"defaultValue", 2);
            mMax = attr.getAttributeIntValue(NAMESPACE,"max", 20);
        }

        @Override 
        protected View onCreateDialogView() {
            //Create Views
            LinearLayout dialogLayout = new LinearLayout(mCtx);
            mTvDialogMessage = new TextView(mCtx);
            mNumberPicker = new NumberPicker(mCtx);

            //Set View attributes
            dialogLayout.setOrientation(LinearLayout.VERTICAL);
            if (mDialogMessage!=null)
                mTvDialogMessage.setText(mDialogMessage);
            dialogLayout.addView(mTvDialogMessage);
            mNumberPicker.setOnValueChangedListener(this);
            dialogLayout.addView(mNumberPicker, new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT));
            if (shouldPersist())
                mValue = getPersistedInt(mDefault);
            mNumberPicker.setMaxValue(mMax);
            mNumberPicker.setMinValue(1);
            mNumberPicker.setValue(mValue);
            return dialogLayout;
        }

        @Override 
        protected void onBindDialogView(View v) {
            super.onBindDialogView(v);
            mNumberPicker.setMaxValue(mMax);
            mNumberPicker.setMinValue(1);
            mNumberPicker.setValue(mValue);     
            setSummary(mValue);
        }

        @Override
        protected void onSetInitialValue(boolean restore, Object defaultValue)  
        {
            super.onSetInitialValue(restore, defaultValue);
            if (restore) 
                mValue = shouldPersist() ? getPersistedInt(mDefault) : 2;
            else 
                mValue = (Integer)defaultValue;
            if (mNumberPicker!=null)
                mNumberPicker.setValue(mValue);
            setSummary(mValue);
        }

        public void setSummary(int value) {
            CharSequence summary = getSummary();
            value=getPersistedInt(-1);
            if (summary == null) {
                setSummary(Integer.toString(value));
            } else {
                setSummary(String.format(summary.toString(), value));
            }
        }

        public void onValueChange(NumberPicker picker, int oldVal, int newVal) {
            setSummary(newVal);
            if (shouldPersist())
                persistInt(newVal);
            callChangeListener(new Integer(newVal));    
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T04:09:56.727

我遇到了同样的问题。不确定它是否正确，但打电话

设置默认值（对象）；

我在 Preference 构造函数中的默认值似乎解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T03:43:39.263

尝试在 persistInt(newVal) 之后添加 notifyChanged()

# javascript - onChange 事件不会触发

> ID：10952804
> 
> 赞同：5
> 
> 时间：2012-06-08T16:38:47.493
> 
> 标签：javascript, sharepoint-2007

我使用 Internet Explorer 8 和 Sharepoint 2007。

简报：我有一个 NewForm，其中包含列表中的各个字段。我需要使用 javascript 从其中一个字段获取用户引入的值（在文本框中），然后使用 onChange 将其粘贴到同一页面中的其他字段（其他文本框）上。

问题：我是一个 JavaScript 新手，我不能设置事件 'onChange' 来触发我的函数，或者至少触发 'alert("Test") ......或者只是我做错了不知道为什么（更有可能）...

假设我要使用的字段为 FieldName="IDTeam"、type="text" 和 id="id_TeamField"。

```
//My JS below "PlaceHolderMain"

_spBodyOnLoadFunctionNames.push("setTxtBoxesValues");

function setTxtBoxesValues()
{    
   //snipped

   getField('text','IDTeam').onChange = function(){alert('Test')}; 
   //"getField('text', 'IDTeam).onChange = function(){myFunction()};" 
   //If I want to call myFunction() when onChange event is triggered    
    } 
```

此外，而不是 getField，尝试了这个：

```
document.getElementById('id_TeamField').onChange = function(){alert('Test')}; 
```

如果我想在触发 onChange 事件时调用 myFunction()

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T17:01:22.620

onchange 是一个事件，因此您可以像这样将其放在标签中：

```
<input type="text" id="IDTeam" onchange="(call function here)" /> 
```

或者您将 addEventListener 应用于该 DOM 对象：

```
document.getElementById("IDTeam").addEventListener("change", function() {//call function here}); 
```

在 IE6 中你可能需要：（不确定它是否有效，因为现在很少有人使用 ie6）

```
document.getElementById("IDTeam").attachEvent("onchange", function() {//call function here} ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:44:07.873

做这个：

```
window.onload = function() { 
    document.getElementById('id_TeamField').addEventListener('change', function() {
        alert('test');
    });
}; 
```

或者使用 jQuery：

```
$('#id_TeamField').on('change', function() {
    alert('test');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T17:27:10.607

你可以这样做

**添加事件监听器**

```
document.getElementById('id_TeamField').addEventListener('change', function(){alert('test');}); 
```

或者

**将 onChange 添加到标签**

```
<select onChange='function() { alert('test');}' name='IDTeam' id='id_TeamField' >
   <option>option1</option>
   <option>option2</option>
   <option>option3</option>
</select> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-20T23:18:30.520

这与其他人所说的有点多余，但分享一下，因为它更直接：

```
const select = document.getElementById('select')
const newText = document.getElementById('newText')

select.addEventListener("change", e => {
  console.log(e.target.value)
  newText.value = e.target.value
})
```

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Bin</title>
</head>
<body>
  <select id="select">
    <option value="url1">tool_ver1</option>
    <option value="url2">tool_ver2</option>
    <option value="url2" selected >tool_ver3</option>
  </select>
  <button type="submit">Retrieve New Release App Options</button>
<div class="textInput spacer">
  <h2>New Release App Options</h2>
  <textarea id="newText"></textarea>
</div>

</body>
</html>
```

# http - IIS7 Rest，在发送数据之前发送“收到请求”响应？

> ID：10952805
> 
> 赞同：0
> 
> 时间：2012-06-08T16:38:53.287
> 
> 标签：http, rest, iis-7

我希望有人能把我推向正确的方向。

我们的 android 平板电脑有问题（我们已将其追溯到平板电脑上的固件，该公司的开发人员正在一起修复，但可能需要几个月的时间才能解决）这是由我们的 IIS7 服务器引起的没有足够快地响应请求。

我们有一个带有 1 个参数的 get 方法，它将执行一个存储的过程并返回该信息。存储过程需要 3 秒才能执行（我们无法提高此性能）。由于 3 秒延迟，平板电脑出现故障。

我想发生的是 IIS 在开始从存储的过程中发送数据之前不会发回任何东西。

我可以做些什么来让 IIS 发送某种确认请求已收到？（并等待数据？）

# javascript - 异步数据库调用 ORMnomnom 的 Nodeunit 测试挂起

> ID：10952806
> 
> 赞同：2
> 
> 时间：2012-06-08T16:39:00.380
> 
> 标签：javascript, unit-testing, node.js, nodeunit

我正在尝试为异步数据库调用编写单元测试。我正在使用带有*ORMnomnom包的**NodeJS* ，安装为 orm db access 和*nodeunit*进行单元测试。但它挂起这个简单的测试：

这是代码 test\test1.js

```
modelsdb = require('../model/model_db')

exports['test db'] = function (test) {
  test.expect(1);
  console.log('test db');
  modelsdb.MyTable.objects.all( function (err, data) { 
    test.ok(true, "this assertion should pass"); 
    test.done();
    console.log('test must finish here!');
  });
}

exports.testSomething = function(test){
  console.log('testSomething');
  test.expect(1);
  test.ok(true, "this assertion should pass");
  test.done();
}; 
```

当我运行这个测试时，所有断言都通过了，我在控制台中看到了我的消息：'test db''test must finish here！' 'testSomething'（意味着 test.done() 到达回调函数内部）但测试没有完成。我需要手动停止它，得到：'进程完成，退出代码 1'。如果我更改为 test.ok(false,"")，那么我会得到 AssertionError 但测试也没有完成。如果我删除“test db”并只留下 testSomething 函数 - 测试按预期完成，所有断言都通过了。

我还尝试了基于*nodeunit的**testpilot*包。它给

 *```
test1
   FAIL : test db
      an error occurred during test:
         Error: timed out waiting for test 
```

有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-30T03:30:40.820

向您的导出添加一个[`tearDown`](https://github.com/caolan/nodeunit#groups-setup-and-teardown)方法以关闭 mongoose 的连接池。只要它仍然打开，测试就不会退出。

你没有展示你是如何打开你的猫鼬连接的，而是这样的：

```
exports.tearDown = function (callback) {
    mongoose.disconnect(callback);
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T02:52:50.927

我在 nodeunit 和 q/mongoose 上遇到了类似的问题 -已经为它打开了一个[错误。](https://github.com/caolan/nodeunit/pull/162)我`process.exit(0)`在调用 后尝试做可怕的事情`test.done()`，但是任何待处理的日志都可能不会被刷新，所以它并不理想。最终不得不调用`process.exit(0)`超时块。*

# java - 使用 JSuggestField 输入一个单词后自动完成停止 - 附加 SSCCE

> ID：10952814
> 
> 赞同：0
> 
> 时间：2012-06-08T16:39:44.560
> 
> 标签：java, xml, swing, user-interface, autocomplete

我在我的项目中添加了自动完成的元素；但在用户输入一个单词后，自动完成算法停止。我可以添加更多字符，但是没有自动完成的建议。

我正在使用[`JSuggestField`](http://www.rakudave.ch/jsuggestfield)（将 jar 添加到我的项目中），这里是说明问题的**SSCCE ：**

```
import javax.swing.*;

import ch.rakudave.suggest.JSuggestField;

import java.awt.*;
import java.util.Vector;

public class Classic extends JFrame {

public static final String CHILD = "/child::";
public static final String DESCENDANT = "/descendant::";
public static final String FOLLOWING_SIBLING = "/following-sibling::";
public static final String DESCENDANT_OR_SELF = "/descendant-or-self::";
public static final String SELF = "/self::";
public static final String PRECEDING_SIBLING = "/preceding-sibling::";
public static final String ANCESTOR_OR_SELF = "/ancestor-or-self::";
public static final String ANCESTOR = "/ancestor::";
public static final String FOLLOWING = "/following::";
public static final String PRECEDING = "/preceding::";

public Classic() {
    initComponents();
}

private void initComponents() {

    Vector<String> vector = new Vector<String>();
    vector.add(DESCENDANT);
    vector.add(FOLLOWING_SIBLING);
    vector.add(DESCENDANT_OR_SELF);
    vector.add(SELF);
    vector.add(PRECEDING_SIBLING);      
    vector.add(ANCESTOR_OR_SELF);  
    vector.add(ANCESTOR);
    vector.add(FOLLOWING);
    vector.add(PRECEDING);
    JSuggestField jsuggest= new JSuggestField(this,vector );

    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setSize(200, 200);

    Container container = getContentPane();
    container.setLayout(new FlowLayout(FlowLayout.LEFT));

    JTextField textField = new JTextField(15);
    jsuggest.setPreferredSize(new Dimension(100, 20));

    //
    // Right justify the JTextField contents
    //
    jsuggest.setHorizontalAlignment(JTextField.RIGHT);

    container.add(jsuggest);

    textField = jsuggest;
}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            new Classic().setVisible(true);
        }
    });
}
} 
```

这是一个快照：![第一次自动完成](../Images/057dbff8c2e1ede75f4f031dc0b008fd.png)。

这很好，但我希望每次用户输入字符后自动完成功能都会起作用`/`，因此一个自动完成功能是不够的。

知道如何使用`JSuggestField`或其他方法解决此问题吗？

谢谢。

# mysql - 为什么在 Doctrine 1.1.2 (USING leftJoin) 中使用 DQL 将“sd IS NULL”添加到我的 where 子句中？

> ID：10952818
> 
> 赞同：2
> 
> 时间：2012-06-08T16:39:54.520
> 
> 标签：mysql, doctrine, null, left-join, doctrine-query

我正在使用 MySQL 数据库和 Doctrine 1.1.2。

我正在尝试使用 leftJoin 编写查询，并且我试图理解结果，因为它多次给我带来了问题。在我运行了几个不同的测试之后，它似乎几乎是断断续续的，我不相信它会这样。

下面，我将粘贴 DQL 以创建查询以及它们的输出。这四个是我在试图理解为什么有时会添加“s.id IS NULL”以及为什么有时会添加“s.id IN ('184158')”时创建的示例。如果两者都没有添加我会很好，但是有人可以向我解释为什么它在那里，也许我怎么能告诉 DQL 我不想要它？

根据我所做的一些研究，我推测它可能是关于此查询是否包含子查询的错误修复 (#1868) 的一部分。但是，由于这没有子查询，我不知道如何确定测试该问题。

这是来自于教义/lib/Doctrine/Query.php 中的错误修复 #1868 的代码

```
// FIX #1868: If not ID under MySQL is found to be restricted, restrict pk column for null  
//            (which will lead to a return of 0 items)  
$limitSubquerySql = $this->_conn->quoteIdentifier($field)  
    . (( ! empty($subquery)) ? ' IN (' . $subquery . ')' : ' IS NULL')  
    . ((count($this->_sqlParts['where']) > 0) ? ' AND ' : ''); 
```

谢谢，麻烦您了。

```
$query = Doctrine_Query::create()  
    ->select('s.id, p.id')  
    ->from('Submission s')  
    ->leftjoin('s.Products p ON s.product_id = p.id')  
    ->where('s.id = ?',$id)  
    ->limit(1);  
echo $query->getSqlQuery() . '< br />';  

$query = Doctrine_Query::create()  
    ->select('s.id, p.id, p.field1')  
    ->from('Submission s')  
    ->leftjoin('s.Products p ON s.product_id = p.id')  
    ->where('s.id = ?',$id)  
    ->limit(1);  
echo $query->getSqlQuery() . '< br />';  

$query = Doctrine_Query::create()  
    ->select('s.id, p.id, p.field1, p.field2')  
    ->from('Submission s')  
    ->leftjoin('s.Products p ON s.product_id = p.id')  
    ->where('s.id = ?',$id)  
    ->limit(1);  
echo $query->getSqlQuery() . '< br />';  

$query = Doctrine_Query::create()  
    ->select('s.id, p.id, p.field1, p.field2, p.field3')  
    ->from('Submission s')  
    ->leftjoin('s.Products p ON s.product_id = p.id')  
    ->where('s.id = ?',$id)  
    ->limit(1);  
echo $query->getSqlQuery() . '< br />';    

**-- OUTPUT --**  
**-- $id = 184158**  

SELECT s.id AS s__id, p.id AS p__id  
FROM submission s   
LEFT JOIN products p   
ON (s.prodid = p.id)   
WHERE **s.id IS NULL** AND (s.id = 184158) **<-- Notice the s.id IS NULL**  

SELECT s.id AS s__id, p.id AS p__id, p.field1 AS p__field1   
FROM submission s   
LEFT JOIN products p   
ON (s.prodid = p.id)   
WHERE **s.id IN ('184158')** AND (s.id = 184158) **<-- Notice the s.id IN ('184158')**  

SELECT s.id AS s__id, p.id AS p__id, p.field1 AS p__field1, p.field2 AS p__field2   
FROM submission s   
LEFT JOIN products p   
ON (s.prodid = p.id)   
WHERE **s.id IS NULL** AND (s.id = 184158) **<-- Notice the s.id IS NULL**  

SELECT s.id AS s__id, p.id AS p__id, p.field1 AS p__field1, p.field2 AS p__field2, p.field3 AS p__field3   
FROM submission s   
LEFT JOIN products p   
ON (s.prodid = p.id)   
WHERE **s.id IN ('184158')** AND (s.id = 184158) **<-- Notice the s.id IN ('184158')** 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T15:25:51.177

发生这种情况有几个原因：

1）Doctrine 处理的对象不是“行”，所以当你添加一个 Join 时，它会立即需要超过一个简单的限制比如说，你想要一个具有一对多关系的表的单个（fetchOne）对象，这些关系添加到 SQL 中的行数，因此 Doctrine 分两个阶段进行。

```
table1.id table2.id
1,11
1,12
2,11
2,13
2,22
3,33 
```

假设您要求`fetchOne`那么它将获得 2 行，但 1 个对象将被水合（对于“id = 1”行）

2）如果您的查询什么也没找到，那么 DQL 将知道什么都不会匹​​配，所以它添加`id = NULL`，或者如果它找到它添加的东西`IN (id-that-is-first)`

我遇到了同样的问题，把我带到了这里，结果发现查询没有返回任何东西。希望这可以帮助。

# c++ - 检查模块是否与多线程 dll (/MD) 库链接

> ID：10952821
> 
> 赞同：0
> 
> 时间：2012-06-08T16:40:13.523
> 
> 标签：c++, visual-studio-2008

是否可以检查 c++ dll 是否与多线程 dll (/MD) 库链接？有什么工具可以检查吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:50:02.583

只需使用 Dumpbin.exe /imports 来查看导入。如果它是使用 /MD 构建的，那么您将看到正在使用 msvcrXXX.dll 中的函数。其中 XXX 是 VS 版本号（90 = VS2008、100 = VS2010 等）。

# ruby-on-rails - RoR 教程 Hartl 第 9.3 章

> ID：10952825
> 
> 赞同：1
> 
> 时间：2012-06-08T16:40:39.413
> 
> 标签：ruby-on-rails, ruby

我真的被这个教程困住了，并且一直在慢慢地把它拉回原形。（我是 2 周的新手）。当我跑

```
bundle exec rspec spec/requests/user_pages_spec.rb -e "edit page" 
```

我明白了

```
sis-macbook-pro:sample_app Lagaspi$ bundle exec rspec spec/requests/user_pages_spec.rb -e "edit page"
Run options: include {:full_description=>/(?-mix:edit\ page)/}
FFF

Failures:

1) User pages signup with valid information edit page 
 Failure/Error: before { visit edit_user_path(user) }
 ActionView::Template::Error:
   undefined method `model_name' for NilClass:Class
 # ./app/views/users/edit.html.erb:6:in `_app_views_users_edit_html_erb___432836341465923353_70096274496380'
 # ./spec/requests/user_pages_spec.rb:96:in `block (5 levels) in <top (required)>'

2) User pages signup with valid information edit page 
 Failure/Error: before { visit edit_user_path(user) }
 ActionView::Template::Error:
   undefined method `model_name' for NilClass:Class
 # ./app/views/users/edit.html.erb:6:in `_app_views_users_edit_html_erb___432836341465923353_70096274496380'
 # ./spec/requests/user_pages_spec.rb:96:in `block (5 levels) in <top (required)>'

3) User pages signup with valid information edit page 
 Failure/Error: before { visit edit_user_path(user) }
 ActionView::Template::Error:
   undefined method `model_name' for NilClass:Class
 # ./app/views/users/edit.html.erb:6:in `_app_views_users_edit_html_erb___432836341465923353_70096274496380'
 # ./spec/requests/user_pages_spec.rb:96:in `block (5 levels) in <top (required)>'

Finished in 0.29628 seconds
3 examples, 3 failures

Failed examples:

rspec ./spec/requests/user_pages_spec.rb:99 # User pages signup with valid information edit page 
rspec ./spec/requests/user_pages_spec.rb:100 # User pages signup with valid information edit page 
rspec ./spec/requests/user_pages_spec.rb:101 # User pages signup with valid information edit page 
```

这是我的 /spec/requests/user_pages_spec.rb

```
require 'spec_helper'

describe "User pages" do

subject { page }

describe "profile page" do
let(:user) { FactoryGirl.create(:user) }
before { visit user_path(user) }

it { should have_selector('h1', text: user.name) }
it { should have_selector('title', text: user.name) }
end

describe "signup page" do
before { visit signup_path }

it { should have_selector('h1', text: 'Sign up') }
it { should have_selector('title', text: full_title('Sign up')) }
end

describe "signup" do

before { visit signup_path }

describe "with invalid information" do
  it "should not create a user" do
    expect { click_button "Create my account" }.not_to change(User, :count)
  end

  describe "error messages" do
    before { click_button "Create my account" }

    it { should have_selector('title', text: 'Sign up') }
    it { should have_content('error') }
  end
end

  describe "with valid information" do
  before do
    fill_in "Name", with: "Example User"
    fill_in "Email", with: "user@example.com"
    fill_in "Password", with: "foobar"
    fill_in "Confirmation", with: "foobar"
  end

  it "should create a user" do
    expect do
      click_button "Create my account"
    end.to change(User, :count).by(1)
  end

  describe "after saving the user" do
    before { click_button "Create my account" }
    let(:user) { User.find_by_email('user@example.com') }

    it { should have_selector('title', text: user.name) }
    it { should have_selector('div.alert.alert-success', text: 'Welcome') }
    it { should have_link('Sign out') }
   end
 end
end

describe "signup page" do
before { visit signup_path }

it { should have_selector('h1', text: 'Sign up') }
it { should have_selector('title', text: full_title('Sign up')) }
end

    describe "signup" do

before { visit signup_path }

let(:submit) { "Create my account" }

describe "with invalid information" do
  it "should not create a user" do
    expect { click_button submit }.not_to change(User, :count)
  end
end

describe "with valid information" do
  before do
    fill_in "Name", with: "Example User"
    fill_in "Email", with: "user@example.com"
    fill_in "Password", with: "foobar"
    fill_in "Confirmation", with: "foobar"
  end

  it "should create a user" do
    expect { click_button submit }.to change(User, :count).by(1)
  end
  describe "edit" do
    let(:user) { FactoryGirl.create(:user) }
    before { visit edit_user_path(user) }

    describe "page" do
      it { should have_selector('h1', text: "Update your profile") }
      it { should have_selector('title', text: "Edit user") }
      it { should have_link('change', href: 'http://gravatar.com/emails') }
    end

    describe "with invalid information" do
      before { click_button "Save changes" }

      it { should have_content('error') }
      end
    end
   end
 end
end 
```

有任何想法吗？

users_controller.rb

```
class UsersController < ApplicationController

def show
@user = User.find(params[:id])
end

def new
@user = User.new
end

def create
@user = User.new(params[:user])
if @user.save
  sign_in @user
  flash[:success] = "Welcome to the Sample App!"
  redirect_to @user
else
  render 'new'
   end
 end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T16:59:51.020

您的问题似乎是您没有编辑操作。添加这个

```
def edit
    @user = User.find(params[:id])
end 
```

到您的用户控制器。

# wso2 - WSO2ESB SAML SSO 管理控制台注销

> ID：10952827
> 
> 赞同：0
> 
> 时间：2012-06-08T16:40:39.567
> 
> 标签：wso2, single-sign-on, wso2esb, esb, saml

我正在使用 WSO2 ESB 4.0.3 版，安装了一些功能，例如：身份提供者、身份 SAML2.0 单点登录、身份 XACML、BPEL、数据服务托管等。

按照[此处](http://docs.wso2.org/wiki/display/identity/Configuring+Single+Sign-On+Across+Different+Carbon+Servers)的说明，我为 ESB 管理控制台设置了 SSO 身份验证。登录工作正常，但不是退出。在日志中，我可以看到以下信息：

```
TID: [] [WSO2 ESB] [2012-06-08 18:12:59,592]  
INFO {org.wso2.carbon.identity.authenticator.saml2.sso.SAML2SSOAuthenticator} -  
'admin' logged out at [2012-06-08 18:12:59,0592] 
{org.wso2.carbon.identity.authenticator.saml2.sso.SAML2SSOAuthenticator} 
```

在我得到错误之后。此外，在浏览器中显示我仍在登录。

以下是我得到的错误：

```
TID: [] [WSO2 ESB] [2012-06-08 18:13:03,581]  
WARN {org.wso2.carbon.server.admin.module.handler.AuthenticationHandler} -  
Illegal access attempt at [2012-06-08 18:13:03,0581] from IP address : 
Service is RegistryAdminService {org.wso2.carbon.server.admin.module.handler.AuthenticationHandler}

TID: [] [WSO2 ESB] [2012-06-08 18:13:03,584] 
ERROR {org.apache.axis2.engine.AxisEngine} -  
Access Denied. Please login first. {org.apache.axis2.engine.AxisEngine}
...

TID: [] [WSO2 ESB] [2012-06-08 18:13:03,599] 
ERROR {org.wso2.carbon.ui.clients.RegistryAdminServiceClient} -  
Error occurred while checking registry mode {org.wso2.carbon.ui.clients.RegistryAdminServiceClient}
org.apache.axis2.AxisFault: Access Denied. Please login first.
...

TID: [] [WSO2 ESB] [2012-06-08 18:13:03,879] 
ERROR {org.wso2.carbon.server.admin.ui.ServerAdminClient} -  
Cannot get server data. Backend service may be unavailable {org.wso2.carbon.server.admin.ui.ServerAdminClient} 
org.apache.axis2.AxisFault: Access Denied. Please login first. 
```

我在配置中遗漏了什么吗？如果没有，有人可以解释发生了什么吗？

注意：错误重复出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T12:04:28.570

这些重复的错误意味着您从后端注销，它会尝试通过调用相应的 BE 服务来刷新像 Carbon 主页或统计页面这样的页面。

WSO2 是作为单独的节点运行，还是在 ESB 中安装了必要的 IdP 功能？

*   蒂丽娜

# php - 将mysql结果输出为形式的数组（列名=>列名的可能值）

> ID：10952828
> 
> 赞同：1
> 
> 时间：2012-06-08T16:40:47.093
> 
> 标签：php, mysql, associative-array

我有数据库，如

![](../Images/e562406a529670a2b9e0b2512becb1ed.png)

我想创建一个关联数组，以便每个`att_name`值都与其可能的值相关联`att_value`：

```
array('att_name' => array('att_value_1', 'att_value_2', 'att_value_3')) 
```

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:05:18.767

虽然很容易做到这一点，只需选择您想要的结果并在 PHP 中迭代它们以创建您想要的数据结构，您可以将一些工作分给 MySQL [`GROUP_CONCAT()`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)：

```
$query = "
  SELECT att_name, GROUP_CONCAT(att_value SEPARATOR ',') AS values
  FROM table_name
  GROUP BY att_name
";
$result = mysql_query($query);

$array = array();
while ($row = mysql_fetch_assoc($result)) {
  $array[$row['att_name']] = explode(',', $values);
}

print_r($array); 
```

当然，这仅在您的值永远不会包含您`SEPARATOR`在 MySQL 查询中使用的字符（或字符序列）时才有效，因此更安全的纯 PHP 方法是：

```
$query = "
  SELECT att_name, att_value
  FROM table_name
";
$result = mysql_query($query);

$array = array();
while ($row = mysql_fetch_assoc($result)) {
  $array[$row['att_name']][] = $row['att_value'];
}

print_r($array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:49:59.517

试试下面：

```
$sql = "SELECT * from tablename";
$result = mysql_query($sql,$con);
$final_array=array();
 while ($row = mysql_fetch_object($result))
   {
      $final_array[$row->att_name][0]=$row->att_value_1;
      $final_array[$row->att_name][1]=$row->att_value_2;
      ....
      ....
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T17:03:24.900

This way :

```
SELECT
    item,
    att_name,
    GROUP_CONCAT(att_value SEPARATOR "<!>") AS att_value
FROM
    table
GROUP BY
    att_name 
```

Will give you something like that :

```
item    att_name    att_value
-----------------------------
books   height      150 mm<!>250 mm
books   price       rs:20<!>Rs:20
books   size        15 pg<!>30 pg<!>60 pg
books   width       300 mm<!>400 mm 
```

You have to explode the result from `att_value` by a `<!>`. I use this `<!>` so it highly impossible to have a value inside `att_value` with this. If you think you would someday use this, take another separator. Example : `[{--}]`, `_SEPARATOR_`, `[_-CUT-_]`, etc. Something you are sure at 100% you won't use a choice but always as a separator to split the text.

So example :

```
$SQL = 'SELECT item, att_name, GROUP_CONCAT(att_value SEPARATOR "<!>") AS att_value FROM table GROUP BY att_name';
$Query = mysql_query($SQL) or die('MySQL Error : '.mysql_error());

while($Assoc = mysql_fetch_assoc($Query)){
    $Assoc['att_value'] = ($Assoc['att_value'] != '' ? explode('<!>', $Assoc['att_value']) : NULL);
    print_r($Assoc);
} 
```

# sql-server-2008 - SSRS 不接受表类型 (integer_list_tbltype) 作为参数

> ID：10952829
> 
> 赞同：4
> 
> 时间：2012-06-08T16:40:56.417
> 
> 标签：sql-server-2008, reporting-services, ssrs-2008

我有一个存储过程，其输入参数为 integer_list_tbltype。我可以像这样运行proc

```
DECLARE @mylist integer_list_tbltype
INSERT @mylist(n) VALUES(1),(2),(3),(4)
exec <Proc_Name> @mylist 
```

当我尝试在 SSRS（Sql 报告服务 2008）下将其添加为共享数据库时，出现错误。

**操作数类型冲突：nvarchar 与 integer_list_tbltype 不兼容**

有什么解决方法吗？

韦德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:25:43.700

我最近对同样的问题感到沮丧。我*认为*发生这种情况是因为 SSRS 在实际调用报告需要运行的查询时总是将每个参数作为 nvarchar 发送。SQL Server 无法将 nvarchar 正确解释为您尝试使用的表类型，因此您会收到该错误。

我刚刚在博客中介绍了一个潜在的解决方案/解决方法，您可以在其中使用自定义代码块在调用存储过程之前填充表变量：

[http://geekswithblogs.net/GruffCode/archive/2012/06/21/using-table-valued-parameters-with-sql-server-reporting-services.aspx](http://geekswithblogs.net/GruffCode/archive/2012/06/21/using-table-valued-parameters-with-sql-server-reporting-services.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-16T13:25:31.177

唉，SSRS 中的多值参数不能像您预期的那样工作，它的行为不像表格或类似的东西。

相反，SSRS 将用逗号分隔的所有值列表替换 SQL 查询中的参数。因此，您的示例将像这样发送到 SQL Server：

```
exec <Proc_Name> 1,2,3,4 
```

在 SSRS 中使用多值参数的方法（[例如，参见 this](http://msdn.microsoft.com/en-us/library/aa337396%28v=sql.105%29.aspx)）如下：

```
SELECT * FROM MyNumbers WHERE MyNumbers.Nmbr IN (@mylist) 
```

发送到 SQL Server 为：

```
SELECT * FROM MyNumbers WHERE MyNumbers.Nmbr IN (1,2,3,4) 
```

* * *

PS。您发布的错误消息也可能表明您的参数类型在 SSRS 中设置为“文本”，您的意思似乎是“整数”。

# r - ggplot2：geom_text() 生成的锯齿状、质量差的文本是否有修复？

> ID：10952832
> 
> 赞同：56
> 
> 时间：2012-06-08T16:41:01.287
> 
> 标签：r, ggplot2

在向绘图添加注释文本时，我注意到`geom_text()`生成了难看的锯齿状文本，同时`annotate()`生成了平滑、美观的文本。有谁知道为什么会发生这种情况以及是否有任何解决方法？我知道我可以在`annotate()`这里使用，但在某些情况下可能`geom_text()`更可取，我想找到一个修复方法。此外，`geom_text()`不能*打算*给出看起来很糟糕的文本，所以要么我做错了什么，要么我遇到了某种微妙的副作用。

这是一些假数据和生成图表的代码，以及显示结果的图像。

```
library(ggplot2)
age = structure(list(age = c(41L, 40L, 43L, 44L, 40L, 42L, 44L, 45L, 
        44L, 41L, 43L, 40L, 43L, 43L, 40L, 42L, 43L, 44L, 43L, 41L)), 
        .Names = "age", row.names = c(NA, -20L), class = "data.frame")
ggplot(age, aes(age)) + 
  geom_histogram() +
  scale_x_continuous(breaks=seq(40,45,1)) +
  stat_bin(binwidth=1, color="black", fill="blue") +
  geom_text(aes(41, 5.2, 
            label=paste("Average = ", round(mean(age),1))), size=12) +
  annotate("text", x=41, y=4.5, 
           label=paste("Average = ", round(mean(age$age),1)), size=12) 
```

![在此处输入图像描述](../Images/bacecadaec9d35ec22d94c8372e5821d.png)

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-06-08T17:00:40.583

`geom_text`，尽管没有直接使用`age`data.frame 中的任何内容，但仍将其用作其数据源。因此，它在绘图上放置了 20 个“Average=42.3”副本，每行一个。正是多次覆盖使它看起来如此糟糕。 旨在将文本放在信息来自 data.frame 的图上（在原始调用`geom_text`中直接或间接给出）。专为像您这样的简单一次性添加而设计（它创建一个，负责数据源）。`ggplot``annotate``geom_text`

如果你真的要使用`geom_text()`，只需重置数据源：

```
ggplot(age, aes(age)) + 
  scale_x_continuous(breaks=seq(40,45,1)) +
  stat_bin(binwidth=1, color="black", fill="blue") +
  geom_text(aes(41, 5.2, 
            label=paste("Average = ", round(mean(age$age),1))), size=12,
            data = data.frame()) +
  annotate("text", x=41, y=4.5, 
           label=paste("Average = ", round(mean(age$age),1)), size=12) 
```

![在此处输入图像描述](../Images/1c054991368e43f8bfd8da590700031e.png)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2019-06-06T23:32:08.957

## 试试`geom_text(..., check_overlap = TRUE)`*

从 docs`?geom_text`说`check_overlap`：

> 如果为 TRUE，则不会绘制与同一层中先前文本重叠的文本。

```
library(ggplot2)
age = structure(list(age = c(41L, 40L, 43L, 44L, 40L, 42L, 44L, 45L, 
                             44L, 41L, 43L, 40L, 43L, 43L, 40L, 42L, 43L, 44L, 43L, 41L)), 
                .Names = "age", row.names = c(NA, -20L), class = "data.frame")

ggplot(age, aes(age)) + 
  geom_histogram() +
  stat_bin(binwidth=1) +
  geom_text(aes(41, 5.2, label=paste("Average = ", round(mean(age),1))), 
            size=12, 
            check_overlap = TRUE) 
```

*[这基本上是 Dave Gruenewald 在对 Brian 出色答案的评论中发布的答案。我只是想让这个答案更明显！]

# redis - Redis 发布/订阅：查看当前订阅了哪些频道

> ID：10952837
> 
> 赞同：15
> 
> 时间：2012-06-08T16:41:14.933
> 
> 标签：redis, publish-subscribe

我目前有兴趣查看我拥有的 Redis 发布/订阅应用程序中订阅了哪些频道。当客户端连接到我们的服务器时，我们将它们注册到如下所示的通道：

`user:user_id`

这样做的原因是我希望能够看到谁“在线”。我目前在不知道客户是否在线的情况下盲目地向频道发送消息，因为他们接收这些类型的消息并不重要。

为了使我的应用程序更智能，我希望能够发现客户端是否在线或不使用 pub/sub API，如果他们离线，将他们的消息缓存到一个单独的 redis 队列，我可以推送当他们重新上线时发给他们。

这不一定是 100% 准确，但越准确越好。我假设订阅频道时不会创建通用密钥，所以我不能做一些微不足道的事情：

`redis-cli keys user*`查找所有在线用户。

我想到的另一个策略是在用户发布或从频道中删除自己时维护我自己的 Redis Set（当他们在线并关闭应用程序时客户端会自动处理）。这将是我需要管理的另一层复杂性，我希望有一种更简单的方法来处理已经可用的数据。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-08-01T06:04:25.110

从 Redis 2.8 开始，您可以执行以下操作：

```
PUBSUB CHANNELS [pattern] 
```

该[`PUBSUB CHANNELS`命令](http://redis.io/commands/pubsub)具有 O(N) 复杂度，其中 N 是活动通道的数量。

所以在你的情况下：

```
redis-cli PUBSUB CHANNELS user* 
```

会给你想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T06:56:54.463

目前没有命令通过订阅来显示哪些频道“存在”，但存在“已批准”问题和实现此功能的拉取请求。

[https://github.com/antirez/redis/issues/221](https://github.com/antirez/redis/issues/221)
[https://github.com/antirez/redis/pull/412](https://github.com/antirez/redis/pull/412)

由于这个调用的性质，它不是可以扩展的，因此是一个“DEBUG”命令。

但是，还有其他一些方法可以解决您的问题。如果您有理由相信某个频道可能已被订阅，您可以向其发送消息并查看结果。结果是收到消息的订阅者数量。如果你得到 0，你知道他们不在那里。

假设您`user_ids`是增量的，您可能有兴趣使用`SETBIT`将 1 或 0 设置为用户的偏移位来跟踪存在。然后，您可以做一些很酷的事情，比如 new`BITCOUNT`来查看有多少用户在线，并`GETBIT`确定特定用户是否在线。

我过去更具体地解决您的问题的方法是向订阅管理器发出我已订阅频道的信号。然后，管理器通过发送空白消息来“ping”频道以确认有订阅者，并在此后偶尔 ping 频道以确定用户是否仍然在线。不理想，但比`DEBUG CHANNELS`在生产中使用更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-17T08:33:23.507

从 2.8.0 版本开始，redis 有一个 pubsub 命令，在这种情况下会有所帮助：

[http://redis.io/commands/pubsub](http://redis.io/commands/pubsub)

备注：目前2.8.0的状态还不稳定（RC2）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T22:48:59.147

我不知道有任何特定方法可以查询正在订阅哪些频道，并且您是正确的，发生这种情况时没有创建任何密钥。另外，无论如何我都不会`KEYS`在生产中使用该命令，因为它实际上是一个调试命令。

您有一个正确的想法，即在用户在线时使用集合添加用户，然后查询此`SISMEMBER <set> <user_id>`信息以确定是否应将消息发送给他们或添加到 Redis 列表中以便在他们上线后进行处理。

您需要弄清楚用户何时注销，以便将其从在线用户列表中删除，但我对您的系统了解得不够多，无法确切知道您将如何处理。

如果连接的客户端能够发回消息以通知服务器消息已被使用，您可以使用它来跟踪应存储哪些消息以供以后检索。

干杯，迈克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-04T03:12:31.780

*** PUBSUB NUMSUB [channel-1 ... channel-N]**
返回指定频道的订阅者数量（不包括订阅模式的客户端）。 [https://redis.io/commands/pubsub](https://redis.io/commands/pubsub)

# asp.net-mvc - 使用 AutoMapper 将对象展平为 int

> ID：10952840
> 
> 赞同：6
> 
> 时间：2012-06-08T16:41:31.633
> 
> 标签：asp.net-mvc, automapper

我在 AutoMapper 中有以下地图：

```
AutoMapper.Mapper.CreateMap<MySourceObject, Int32>()
    .ForMember(d => d, o => o.MapFrom(s => s.Id)); 
```

我正在尝试将`Id`源对象的属性映射到`int`作为目标。

不幸的是，上面给出了以下错误：

```
Custom configuration for members is only supported for
              top-level individual members on a type 
```

有任何想法吗？

当我只需要`Id`绑定到 a时，我想要实现的是不必将整个复杂对象传递给 ViewModel `DropDownList`，因为返回的 POSTed 表单不会重新创建复杂对象，只需返回 int。`int`我只需要一个:)

现在，我可以自己在代码中执行此操作，但这会降低使用自动映射器的意义。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-08T16:47:50.430

```
Mapper.CreateMap<MySourceObject, int>().ConstructUsing(source => source.Id); 
```

# opencv - 如何在opencv中检测（2或3）行数

> ID：10952842
> 
> 赞同：0
> 
> 时间：2012-06-08T16:41:47.340
> 
> 标签：opencv

有多少种方法可以判断opencv中的照片（几行）

在下面的示例中，该行有 3

[http://www.uploadimage.co.uk/images/1511642.jpg](http://www.uploadimage.co.uk/images/1511642.jpg)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:12:44.793

首先尝试扩大图像的白色部分。这将使黑色条更薄。一旦它比较薄，您可以使用霍夫线变换，它返回它找到的线数组。然后，任务就像计算数组中元素的数量一样简单。当然，在将适当的参数传递给 Hough 变换时，您必须进行大量试验和错误，以免它返回代表图像中相同区域的间隔很近的线。您可能还需要根据斜率和截距对线进行分组。

# windows-phone-7 - 应该包含 12 个元素的列表突然包含 16 个元素，为什么？

> ID：10952843
> 
> 赞同：0
> 
> 时间：2012-06-08T16:41:48.623
> 
> 标签：windows-phone-7

我要声明如下列表，然后向其中添加 12 项：

列表 lstPolygonWkt = new List();

foreach (var i in items) lstPolygonWkt.Add(i.PolygonWkt);

**人们应该认为该列表现在包含 12 个元素，对吗？但令我惊讶的是，列表突然包含 16 个项目，然后最后 4 个项目为空。我不明白为什么我应该是 12 项的清单突然变成了 16 项。知道为什么吗？以及如何使列表中只有 12 个项目？**

我将粘贴几个屏幕截图：

![在此处输入图像描述](../Images/0f33de836d67c67f91d46d69f2c08815.png)

![在此处输入图像描述](../Images/134013bc9857e053479265b00b1f0ecf.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T16:44:45.280

每次需要增加容量时，该列表都会以块的形式保留内存。因此容量报告 16，但计数仅报告 12。空项目有助于计数。

列表类提供了`TrimExcess`删除未使用空间的方法。

此外，在构造函数中预先指定容量只会导致一次内存占用（假设您没有超过该容量）。

您的屏幕截图显示计数为 12，容量为 16。如果内存可用，列表会尝试将其大小加倍（或者至少绝对默认为 4，然后变为 8，然后变为 16）。由于您有 12 个项目，因此您触发了容量从 8 到 16 的跳跃。

# php - 计算下一个工作日

> ID：10952845
> 
> 赞同：-2
> 
> 时间：2012-06-08T16:41:53.210
> 
> 标签：php, zend-framework

给定 Zend_Date 和下午 5 点的截止时间，我如何计算下一个工作日？工作日为 MF（工作日）。

示例：周五下午 4 点应返回相同日期周六任何时间应返回下周一周二下午 8 点应返回周三

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:45:10.153

我认为这已经被问过，[PHP 中给定日期的下一个工作日](https://stackoverflow.com/q/5532002/961455)，但这里使用的是 Zend_Date：

```
$now = new Zend_Date();
if (($now->get(Zend_Date::WEEKDAY_DIGIT) % 6 == 0)
 || ($now->isLater('17:00:00', Zend_Date::TIMES))
) { 
    $now->set(
        strtotime('+1 weekday', $now->toString(Zend_Date::TIMESTAMP)),
        Zend_Date::TIMESTAMP
    );
}   
echo $now->toString(Zend_Date::W3C); 
```

# javascript - IE8 javascript错误onmouseover错误

> ID：10952847
> 
> 赞同：0
> 
> 时间：2012-06-08T16:41:59.380
> 
> 标签：javascript, css, internet-explorer, magento

设法最终让我们的滑块完美地工作，尽管原型错误仍然存​​在，这显然是目前的常态。

但是，当您将鼠标悬停在类别栏上的“主页”按钮上时，IE8 中会显示另一个错误：

```
消息：预期对象
线路：111
字符：1
代码：0
网址：http://foscam-uk.com/index.php
```

代码是：

```
<li class="home css3" 
    onmouseout="toggleMenu(this,0)" 
    onmouseover="toggleMenu(this,1)">
    <a href="http://foscam-uk.com/" title="Home">
        <span>Home</span>
    </a>
</li> 
```

更新：谢谢大家，javascript文件没有被调用。现在它以以下形式产生了更多错误：

消息：'className' 为空或不是对象

消息：“长度”为空或不是对象

如果有人可以提供帮助，那就太好了。谢谢

```
function toggleMenu(el, over)
{
    if (over) {
        Element.addClassName(el, 'over');
    }
    else {
        Element.removeClassName(el, 'over');
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:52:41.410

如错误所示：

```
SCRIPT5009: 'toggleMenu' is undefined 
index.php, line 111 character 1 
```

您正在调用`toggleMenu`，但您没有该名称的函数。这也与 IE 无关，因为在 Chrome 中可以看到相同的错误。缺失的功能就是缺失的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:55:48.597

以下是 FF 的报道：

时间戳：6/8/2012 9:54:02 AM
错误：toggleMenu 未定义
源文件：[http](http://foscam-uk.com/index.php)
://foscam-uk.com/index.php 行：1

因此，要么您忘记链接该 js 文件，要么您根本忘记编写该函数...

# php - TCPDF 的 getNumLines() 有时是错误的

> ID：10952848
> 
> 赞同：2
> 
> 时间：2012-06-08T16:42:01.153
> 
> 标签：php, pdf, tcpdf

我用`getNumLines()`在写文本之前估计行数，因为它必须相应地定位。似乎 getNumLines() 为文本计算了比`MultiCell()`实际需要的更多空间。一条长线，在写作时仍然适合单元格，`MultiCell()`似乎被软包装`getNumLines()`：

```
$lines = $pdf->getNumLines($text, $width);
$pdf->MultiCell($width, 50, $text, 0, "L"); 
```

在我的测试`$lines`中是 3，而只打印了 2 行。如果我稍微增加 $width ，我会得到正确的值。第一行较长。所以它不能是最后被包装的非打印字符。

也许是因为我传递给的对齐参数“L” `MultiCell()`？但是没有这样的`getNumLines()`......有什么建议吗？

TCPDF 版本：5.9.156

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T11:34:18.253

在tcpdf 的 bugtracker 的[这张票](http://sourceforge.net/tracker/index.php?func=detail&aid=2935534&group_id=128076&atid=710532)的评论中描述了另一种技术，这听起来很有希望：

> 如果您想知道确切的行数，则必须使用以下技术：

```
// store current object
$pdf->startTransaction();
// get the number of lines
$lines = $pdf->MultiCell($w, 0, $txt, 0, 'L', 0, 0, '', '', true, 0, false,true, 0);
// restore previous object
$pdf = $pdf->rollbackTransaction(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T11:21:48.513

哈！发现错误：`getNumLines()`计算换行符和回车的空间。

为了避免这种情况，我编辑了字体定义文件：有一个称为`$cw`定义每个字符宽度的数组。我添加了两个条目：`10 => 0, 13 => 0`将换行符和回车符的宽度设置为零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-02T21:33:22.630

最后为 TCPDF 中的“脏”html 字符串表修复了同样的错误。JohJoh 关于 10 => 0, 13 => 0 的回答让我朝着正确的方向前进。我将其更改为 10 => 8750, 13 => 8750 以将其他 td 的内容向下推送适量。

# javascript - 数字的规模和精度

> ID：10952852
> 
> 赞同：6
> 
> 时间：2012-06-08T16:42:37.443
> 
> 标签：javascript, jquery

我希望从以下示例中的数字中获取比例和精度。

`var x = 1234.567;`

我没有看到任何`.scale`内置`.precision`功能，我不确定正确的最佳方法是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-11-25T14:45:10.733

您可以使用：

```
var x = 1234.56780123;

x.toFixed(2); // output: 1234.56
x.toFixed(3); // output: 1234.568
x.toFixed(4); // output: 1234.5680 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T16:48:33.307

```
var x = 1234.567;

var parts = x.toString().split('.');

parts[0].length; // output: 4 for 1234

parts[1].length; // output: 3 for 567 
```

### 笔记

Javascript 具有**[toPrecision()](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number/toPrecision)**方法，该方法提供具有指定长度的数字。

例如：

```
var x = 1234.567;

x.toPrecision(4); // output: 1234

x.toPrecision(5); // output: 1234.5

x.toPrecision(7); // output: 1234.56 
```

但

```
x.toPrecision(5); // output: 1235

x.toPrecision(3); // output: 1.23e+3 
```

等等。

### 根据评论

有没有办法检查字符串是否包含`.`？

```
var x = 1234.567

x.toString().indexOf('.'); // output: 4 
```

### 笔记

`.indexof()`返回目标 else 的第一个索引`-1`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-08T16:58:44.690

另一个高级解决方案（如果我正确理解你所说的*scale*和*precision*的意思）：

```
function getScaleAndPrecision(x) {
    x = parseFloat(x) + "";
    var scale = x.indexOf(".");
    if (scale == -1) return null;
    return {
        scale : scale,
        precision : x.length - scale - 1
    };
}

var res = getScaleAndPrecision(1234.567);

res.scale;       // for scale
res.precision;   // for precision 
```

如果 number 不是 float 函数返回`null`.

# mercurial - Mercurial API：通过 https 读取配置

> ID：10952853
> 
> 赞同：2
> 
> 时间：2012-06-08T16:42:38.273
> 
> 标签：mercurial, mercurial-api

在 Mercurial API 中，是否有任何方法可以读取与您通过 HTTPS 访问的存储库关联的配置值？存储库的`ui`对象似乎没有容纳它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T17:59:10.440

最简洁的答案是不”。无法使用 Mercurial API 通过 HTTP 从存储库中读取配置值。这些值永远不会通过网络传输。更详细的解释如下。

* * *

该类`ui.ui()`提供对系统、用户和本地存储库配置值的访问。

```
>>> from mercurial import hg, ui
>>> u = ui.ui()
>>> u.configlist('ui', 'username')
['Your', 'Name', '<your@email.com>'] 
```

存储库对象的构造函数需要提供一个`ui`对象和一个`path`。

来自的值`ui`被复制到 repo 对象中。

如果`path`是本地存储库，则该存储库的配置设置可以通过`repo.ui`. 但是，如果`path`是 URL，API 不会查询远程服务器的配置设置。在这种情况下，`repo.ui`仅包括系统和用户设置。

```
>>> repo = hg.repository(ui.ui(), '.')
>>> repo.ui.configlist('paths', 'default')
['https://www.mercurial-scm.org/repo/hg']

... start an hg serve session at http://localhost:8000 ...

>>> repo = hg.repository(ui.ui(), 'http://localhost:8000')
>>> repo.ui.configlist('paths', 'default')
[] 
```

# c# - LINQ - 按多个属性对列表进行分组并返回具有数组成员的对象

> ID：10952854
> 
> 赞同：2
> 
> 时间：2012-06-08T16:42:37.990
> 
> 标签：c#, arrays, linq, group-by, google-visualization

这将是一个两部分的问题。

我正在尝试构建一个用于 Google Charts API（特别是他们的数据表）的数据结构。

这是我现在的代码：

```
return Json.Encode(
    RMAs
    .Where(r => r.CreatedDate.Year > DateTime.Now.Year - 4) //Only grab the last 4 years worth of RMAs
    .GroupBy(r => new { Problem = r.Problem, Year = r.CreatedDate.Year, Quarter = ((r.CreatedDate.Month) / 3) })
    .Select(r => new { Problem = r.Key.Problem, Year = r.Key.Year, Quarter = r.Key.Quarter, Count = r.Count() })
); 
```

这让我非常接近。这让我得到一个类似于以下的数组：

```
{"Problem":"It broke!","Year":2012,"Quarter":2,"Count":3},
{"Problem":"It broke!","Year":2012,"Quarter":1,"Count":1} 
```

但是，我想要的是通过“问题”属性进一步对数据进行分组，以便季度是每个问题的数组（这使得数据结构更容易迭代）。所需结构的示例：

```
{"Problem":"It broke!",
    {"Year":2012,"Quarter":2,"Count":3},
    {"Year":2012,"Quarter":1,"Count":1}
},
{"Problem":"Some other problem",
    {"Year":2012,"Quarter":1,"Count":31}
} 
```

问题的第二部分：如何确保每个季度都有数据（同样，这使得使用 API 构建数据表的迭代*变得更加*容易），即使其中没​​有出现“问题”四分之一？使用与上次相同的示例：

```
{"Problem":"It broke!",
    {"Year":2012,"Quarter":2,"Count":3},
    {"Year":2012,"Quarter":1,"Count":1}
},
{"Problem":"Some other problem",
    {"Year":2012,"Quarter":2,"Count":0}
    {"Year":2012,"Quarter":1,"Count":31}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:02:36.507

感谢[TA 先生](https://stackoverflow.com/users/428811/mr-ta)的启发，并向我展示了您可以对分组使用 LINQ。

我已经在本地环境中对此进行了测试，LINQ 确实返回了与年/季度分组数组相关的问题列表，其中包含总计数。我不知道 Json.Encode 是否以正确的格式对其进行编码。

以下 LINQ 应返回符合您所需格式的匿名类型：

**编辑：**查询现在为至少发生一个问题但未发生指定问题的季度返回 count=0

```
var quarters = RMAs
    .Where(rma => rma.CreatedDate.Year > DateTime.Now.Year - 4)
    .GroupBy(rma => new { 
        Year = rma.CreatedDate.Year, 
        Quarter = ((rma.CreatedDate.Month) / 3) 
    });

return Json.Encode(
    RMAs
        //Only grab the last 4 years worth of RMAs
        .Where(r => r.CreatedDate.Year > DateTime.Now.Year - 4)
        // Group all records by problem     
        .GroupBy(r => new { Problem = r.Problem })
        .Select(grouping => new
            {
                Problem = grouping.Key.Problem,
                Occurrences = quarters.Select(quarter => new
                    {
                        Year = quarter.Key.Year,
                        Quarter = quarter.Key.Quarter,
                        Count = grouping
                                .GroupBy(record => new
                                {
                                    Year = record.CreatedDate.Year,
                                    Quarter = ((record.CreatedDate.Month) / 3)
                                })
                                .Where(record => 
                                    record.Key.Year == quarter.Key.Year 
                                    && record.Key.Quarter == quarter.Key.Quarter
                                ).Count()
                    }).ToArray()
            })); 
```

**更新：**感谢[JamieSee](https://stackoverflow.com/users/1015164/jamiesee)更新示例 JSON 输出：

这是 JSON 输出的示例：

```
[{"Problem":"P","Occurrences":[{"Year":2012,"Quarter":4,"Count":2},{"Year":2012,"Quarter":2,"Count":1},{"Year":2012,"Quarter":1,"Count":1}]},{"Problem":"Q","Occurrences":[{"Year":2012,"Quarter":3,"Count":1},{"Year":2012,"Quarter":2,"Count":1},{"Year":2012,"Quarter":1,"Count":1}]}] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:59:31.790

1.  将以下内容添加到您的查询中：

    ```
    .GroupBy(x => x.Problem)
    .ToDictionary(g => g.Key, g => g.Select(x=>new { Year=x.Year, Quarter=x.Quarter, Count = x.Count })); 
    ```

2.  您必须在上面的 .ToDictionary() 之前插入以下内容：

    ```
    .Select(g =>
      new { 
        Key = g.Key, 
        Items = 
          g
            .GroupBy(r => r.Year)
            .SelectMany(gy =>
              gy.Concat(
                Enumerable.Range(1,5)
                  .Where(q => !gy.Any(r=>r.Quarter == q))
                  .Select(q => new { Problem = g.Key, Year = gy.Key, Quarter = q, Count = 0 })
              )
            )
      }
    ) 
    ```

我想...试试看:)

但是，我建议不要遵循这种方法，并在客户端上创建“空”记录，以避免过度使用带宽。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T17:57:58.217

这是满足您所有标准的完整重述：

```
public static IEnumerable<DateTime> GetQuarterDates()
{
    for (DateTime quarterDate = DateTime.Now.AddYears(-4); quarterDate <= DateTime.Now; quarterDate = quarterDate.AddMonths(3))
    {
        yield return quarterDate; 
    }
}

public static void RunSnippet()
{
    var RMAs = new[] {
        new { Problem = "P", CreatedDate = new DateTime(2012, 6, 2) },
        new { Problem = "P", CreatedDate = new DateTime(2011, 12, 7) },
        new { Problem = "P", CreatedDate = new DateTime(2011, 12, 8) },
        new { Problem = "P", CreatedDate = new DateTime(2011, 8, 1) },
        new { Problem = "P", CreatedDate = new DateTime(2011, 4, 1) },
        new { Problem = "Q", CreatedDate = new DateTime(2011, 11, 11) },
        new { Problem = "Q", CreatedDate = new DateTime(2011, 6, 6) },
        new { Problem = "Q", CreatedDate = new DateTime(2011, 3, 3) }
    };

    var quarters = GetQuarterDates().Select(quarterDate => new { Year = quarterDate.Year, Quarter = Math.Ceiling(quarterDate.Month / 3.0) });

    var rmaProblemQuarters = from rma in RMAs
            where rma.CreatedDate > DateTime.Now.AddYears(-4)
            group rma by rma.Problem into rmaProblems
            select new {
                            Problem = rmaProblems.Key,
                            Quarters = (from quarter in quarters
                                        join rmaProblem in rmaProblems on quarter equals new { Year = rmaProblem.CreatedDate.Year, Quarter = Math.Ceiling(rmaProblem.CreatedDate.Month / 3.0) } into joinedQuarters
                                        from joinedQuarter in joinedQuarters.DefaultIfEmpty()
                                        select new {
                                                        Year = quarter.Year,
                                                        Quarter = quarter.Quarter,
                                                        Count = joinedQuarters.Count()
                                                   })
                       };

    string json = System.Web.Helpers.Json.Encode(rmaProblemQuarters);
    Console.WriteLine(json);
} 
```

产生：

```
[{"Problem":"P","Quarters":[{"Year":2008,"Quarter":2,"Count":0},{"Year":2008,"Quarter":3,"Count":0},{"Year":2008,"Quarter":4,"Count":0},{"Year":2009,"Quarter":1,"Count":0},{"Year":2009,"Quarter":2,"Count":0},{"Year":2009,"Quarter":3,"Count":0},{"Year":2009,"Quarter":4,"Count":0},{"Year":2010,"Quarter":1,"Count":0},{"Year":2010,"Quarter":2,"Count":0},{"Year":2010,"Quarter":3,"Count":0},{"Year":2010,"Quarter":4,"Count":0},{"Year":2011,"Quarter":1,"Count":0},{"Year":2011,"Quarter":2,"Count":1},{"Year":2011,"Quarter":3,"Count":1},{"Year":2011,"Quarter":4,"Count":2},{"Year":2011,"Quarter":4,"Count":2},{"Year":2012,"Quarter":1,"Count":0},{"Year":2012,"Quarter":2,"Count":1}]},{"Problem":"Q","Quarters":[{"Year":2008,"Quarter":2,"Count":0},{"Year":2008,"Quarter":3,"Count":0},{"Year":2008,"Quarter":4,"Count":0},{"Year":2009,"Quarter":1,"Count":0},{"Year":2009,"Quarter":2,"Count":0},{"Year":2009,"Quarter":3,"Count":0},{"Year":2009,"Quarter":4,"Count":0},{"Year":2010,"Quarter":1,"Count":0},{"Year":2010,"Quarter":2,"Count":0},{"Year":2010,"Quarter":3,"Count":0},{"Year":2010,"Quarter":4,"Count":0},{"Year":2011,"Quarter":1,"Count":1},{"Year":2011,"Quarter":2,"Count":1},{"Year":2011,"Quarter":3,"Count":0},{"Year":2011,"Quarter":4,"Count":1},{"Year":2012,"Quarter":1,"Count":0},{"Year":2012,"Quarter":2,"Count":0}]}] 
```

# javascript - 我可以通过Javascript中第一个元素的值选择二维数组的第二个元素吗？

> ID：10952858
> 
> 赞同：1
> 
> 时间：2012-06-08T16:42:47.477
> 
> 标签：javascript, jquery, arrays, json, multidimensional-array

我有这样的 JSON 响应：

```
 var errorLog = "[[\"comp\",\"Please add company name!\"],
                 [\"zip\",\"Please add zip code!\"],
                  ... 
```

我像这样反序列化：

```
 var log = jQuery.parseJSON(errorLog); 
```

现在我可以访问这样的元素：

```
 log[1][1] > "Please add company name" 
```

**问题**：
如果我有第一个值**comp**，有没有办法通过执行以下操作直接获得第二个值：

```
 log[comp][1] 
```

无需遍历整个数组。

感谢帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:46:32.647

不。除非第一个数组的“值”（也许我应该说，第一个维度或第一行），它也是**key**。也就是说，除非它是这样的：

```
log = {
    'comp': 'Please add a company name'
                   .
                   .
                   .
} 
```

现在，`log['comp']`or`log.comp`是合法的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:50:07.323

有两种方法可以做到这一点，但都没有避免循环。第一种是每次访问项目时循环遍历数组：

```
var val = '';
for (var i = 0; i < errorLog.length; i++) {
    if (errorLog[i][0] === "comp") {
        val = errorLog[i][1];
        break;
    }
} 
```

另一种是将您的数组加工成一个对象并使用对象表示法访问它。

```
var errors = {};
for (var i = 0; i < errorLog.length; i++) {
    errors[errorLog[i][0]] = errorLog[i][1];
} 
```

然后，您可以使用 访问相关值`errors.comp`。

如果你只看一次，第一个选项可能更好。如果您可能不止一次查看，最好使用第二个系统，因为 (a) 您只需要执行一次循环，这样效率更高，(b) 您不会重复循环代码，(c ) 你想做什么就很明显了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T17:20:22.430

无论您要以某种方式循环遍历数组，即使它被 jQuery 之类的工具对您来说有点模糊。

您可以像这样建议的那样从数组创建一个对象：

```
var objLookup = function(arr, search) {
    var o = {}, i, l, first, second;

    for (i=0, l=arr.length; i<l; i++) {
        first = arr[i][0]; // These variables are for convenience and readability.
        second = arr[i][1]; // The function could be rewritten without them.

        o[first] = second;
    }

    return o[search];
} 
```

但更快的解决方案是遍历数组并在找到值后立即返回：

```
var indexLookup = function(arr, search){
   var index = -1, i, l;

    for (i = 0, l = arr.length; i<l; i++) {
        if (arr[i][0] === search) return arr[i][1];
    }

    return undefined;
} 
```

然后，您可以在代码中像这样使用这些函数，这样您就不必在所有代码的中间进行循环：

```
var log = [
    ["comp","Please add company name!"],
    ["zip","Please add zip code!"]
];

objLookup(log, "zip"); // Please add zip code!
indexLookup(log, "comp"); // Please add company name! 
```

这是一个[jsfiddle](http://jsfiddle.net/pseudosavant/MAm4n/)，显示了这些在使用中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:48:28.187

你看过 jQuery 的`grep`或`inArray`方法吗？

看到这个讨论

[是否有任何 jquery 功能可以以与 DOM 类似的方式查询多维数组？](https://stackoverflow.com/questions/3191199/are-there-any-jquery-features-to-query-multi-dimensional-arrays-in-a-similar-fas)

# biztalk - Biztalk 平面文件--忽略页眉和页脚

> ID：10952867
> 
> 赞同：2
> 
> 时间：2012-06-08T16:43:29.637
> 
> 标签：biztalk, biztalk-2010

我相信我对如何执行此操作的步骤有一个大致的了解，但是我正在努力使模式正确，无论是使用平面文件模式生成器还是调整配置后记。

我将在下面给出一个数据示例，但一般来说，它以一个多行标题开头，该标题可以有可变文本，但总是以相同的确切行结束（“START-OF-DATA”）。下一部分由分隔数据行组成（这是我需要带入 Biztalk 的文件的唯一部分）。最后，还有一个多行页脚，它始终具有相同的开始结束行（“END-OF-Data”和“END-OF-FILE”）。

示例——我的评论用括号括起来：

```
START-OF-FILE (this is always here)

(. . . variable number of lines that contain info I don't need . . .)

START-OF-DATA (this is always here)
(many lines of delimited data that I DO need)
END-OF-DATA (this is always here)

(. . . variable number of lines that contain info I don't need . . .)

END-OF-FILE (this is always here) 
```

我使用平面文件生成器创建了三个模式（页眉/细节/页脚），目的是只映射细节。我创建了一个管道并将三个模式分配给反汇编阶段。

我正在寻找关于我的方法可能有什么问题的一般提示，或者我应该注意什么。但是我在运行时遇到的错误是：

> 管道组件属性上指定的拖车规范不包含互换拖车。

我已经用谷歌搜索了这个错误，并且（按照建议）尝试将子订单从 Infix 更改为 Postfix，但这没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T21:05:07.617

我认为这个博客应该可以帮助你： http: [//maddcoder.wordpress.com/2012/06/14/using-biztalk-to-parse-a-flatfile-with-multi-line-header-and-trailers/](http://maddcoder.wordpress.com/2012/06/14/using-biztalk-to-parse-a-flatfile-with-multi-line-header-and-trailers/)

# c++ - 我可以使用 memcpy 指向我之前 new 的指针吗？

> ID：10952868
> 
> 赞同：4
> 
> 时间：2012-06-08T16:43:40.267
> 
> 标签：c++, pointers, memcpy

例如，我尝试编写自己的`vector`，所以我只是这样写它的`assign`函数

```
template <typename T>
void Vector<T> :: assign(T *start, T *end)
{
    if (end - start > _capacity)
    {
        resize(end - start);
    }
    _size = end - start;
    delete []ptr;
    ptr = new T[_capacity];
    memcpy(ptr, start, end - start);
} 
```

我之前有新的指针`ptr`，但我可以复制指针`start`和`end`

为什么？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T16:55:44.237

第一个问题是这只适用于简单类型（读取 POD）。
任何带有构造函数/析构函数的东西都需要调用它们。

其次，这不是例外安全的。
它甚至不提供基本保证，更不用说强有力的保证了。

在修改对象之前，您需要完成所有异常不安全的工作。这意味着`new`必须在修改对象**之前**完成（并且绝对是在释放之前）。否则，您可能会抛出使对象处于无效状态（这可能看起来不错，但是如果您捕获异常并继续，您现在有一个包含指向已释放内存的指针的对象）。

所以即使你使用`std::copy()`你仍然做错了事。
我个人认为 std::copy() 的建议是红鲱鱼。它会正确地复制数据，但你的方法仍然很糟糕。您需要在复制和交换 idium 上使用扭曲。

```
template <typename T>
void Vector<T> :: assign(T *start, T *end)
{
    Vector<T> tmp(start, end);  // construct a temp object that allocates the memory.

    swap(tmp);                  // Swap the current object and the tmp objects data.
                                // When the tmp object goes out of scope it will delete
                                // what was the current objects data

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T16:45:50.300

以这种方式重用指针完全没问题，但在这里使用 memcpy***并不***安全，因为你不知道 T 是什么类型。如果 T 是字符串或向量之类的对象类型，则会导致未定义的行为。

要解决此问题，请将行更改为

```
std::copy(start, end, ptr); 
```

这是安全的 C++ 方法。

希望这可以帮助！

# file-sharing - Windows 防火墙阻止从 linux 挂载

> ID：10952870
> 
> 赞同：2
> 
> 时间：2012-06-08T16:43:54.857
> 
> 标签：file-sharing, windows-firewall

我正在尝试在 linux (machine2) 下挂载一个 windows 文件夹 (machine1)。计算机在同一个专用网络中。

为此，我使用：

```
mount -t cifs -o user=... PATH_ON_MACHINE1 PATH_ON_MACHINE2 
```

我花了一些时间只获得超时，我突然想到可能是防火墙阻止了连接。我关闭了防火墙并能够连接到我的共享文件夹。不幸的是，我不能就这样离开它。

我转到“具有高级安全性的 Windows 防火墙”窗口并启用了“文件和打印机共享”组中的所有内容，但是我仍然遇到超时。

所以我的问题是：
我应该启用哪些其他服务才能从 linux 连接到共享文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:37:58.783

只针对有同样问题的其他人。

该服务称为：`Netlogon Service/Inbound Rules`。

# android - 一个高密度文件夹而不是三个文件夹

> ID：10952874
> 
> 赞同：0
> 
> 时间：2012-06-08T16:44:09.513
> 
> 标签：android, android-layout

这是 android 支持多种屏幕尺寸的典型领域。基本上，在我的纸牌游戏中，为 3 个文件夹（ld、md、hd）提供重复的 52 张卡片集实在是太多了。原因是应用程序大小增加了很多。

所以我想知道，如果我只提供高密度文件夹，那么设备会将图像缩小到适当的密度。我的意思是，如果我之前所做的只是缩小图像大小，那么设备的缩小比例将是相同的。正确的？

如果我这样做（仅提供高密度文件夹），图像最终会在低密度屏幕上采用相同的物理尺寸（我使用高密度，因为它通常是按比例缩小而不是放大）。

谢谢

PS：请不要给我android网站。我想要你的答案/经验

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:03:39.613

I have a game card too and i have put all my high-res cards in res.raw. It should be the same in drawable-nodpi.

On all the device tested, the cards render very good. The phone just scale the cards up or down depending on the screen size.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:05:19.737

答案是，它*会*为您缩小它们，但生成的图像质量将低于以正确密度提供的图像，具体取决于缩小的方式和百分比。根据图形类型的不同，它可能会也可能不会那么明显，但细线和单像素细节将是最明显的不同。

# ruby-on-rails - 为什么我应该使用 Asset Pipeline 来提供图像？

> ID：10952876
> 
> 赞同：13
> 
> 时间：2012-06-08T16:44:27.947
> 
> 标签：ruby-on-rails, asset-pipeline

在资产管道的 Ruby on Rails 指南中，它说

> 公共下的任何资产都将由应用程序或 Web 服务器作为静态文件提供。您应该将 app/assets 用于在提供之前必须经过一些预处理的文件。

[http://guides.rubyonrails.org/asset_pipeline.html](http://guides.rubyonrails.org/asset_pipeline.html)

对我来说，这意味着图像应该保存在公共目录中，因为它们可以由我的 Web 服务器静态提供，并且不需要预处理。

把你的图片放进去有什么好处`assets/`吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T17:21:03.640

资产预编译将唯一的哈希值附加到图像文件名，这允许用户获取最新版本，尽管服务器上的缓存或过期设置。当您想在网站设计中更改图像时，这很有用。

您不想`/assets/images`用于不太可能更改的图像（例如用户上传）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T16:48:17.097

因为它会损害资产管道的多功能性。

通过资产管道提供图像，如果您更改资产管道（例如，将文件上传到 S3），您将不得不通过其他任务同步您的图像。

可能还有其他更深层次的原因，但这就是让我停下来的原因。

编辑：旁注：在生产中感谢资产：预编译 /assets/ 中的所有内容都将由公共提供。

# mysql - 在 MySQL 数据库中存储货币值

> ID：10952879
> 
> 赞同：12
> 
> 时间：2012-06-08T16:44:45.973
> 
> 标签：mysql, currency

这个问题之前已经被问过很多次了，但是我发现关于这个话题的意见相互矛盾，所以我想我会再次提出这个问题，希望能有一个更统一的结论。

我想在我的数据库中存储一个货币值。假设所有条目都是相同类型的货币（例如美元），并且允许正值和负值。

我最初的想法是将值存储为相关货币的最小单位的有符号整数。例如，如果我想存储价值 $1.25，我会插入`125`数据库，因为 USD 的最小单位是 $0.01。这种方法的好处是 MySQL 会自动舍入到最接近的整数。例如，如果美元值为 1.259 美元，我可以插入`125.9`，它会自动四舍五入并存储为`126`1.26 美元。

所以你怎么看？这是一种合理的方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-08T17:03:01.367

Financial data can be stored as `DECIMAL(p,s)` where p is the number of significant digits, and s is the scale (number of places to the right of the decimal point). See [The MySQL documentation](http://dev.mysql.com/doc/refman/5.5/en/fixed-point-types.html).

Also from O'Reilly's [High Performance MySQL](http://shop.oreilly.com/product/0636920022343.do), chapter 3:

> "...you should use DECIMAL only when you need exact results for fractional numbers--for example, when storing financial data."

From O'Reilly's [Learning MySQL](http://shop.oreilly.com/product/9780596008642.do):

> `DECIMAL` is, "...A commonly used numeric type. Stores a fixed-point number such as a salary or distance..."

And [MySQL Pocket Reference](http://shop.oreilly.com/product/9780596514266.do):

> `DECIMAL` "...Stores floating-point numbers where precision is critical, such as for monetary values."

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:57:16.810

你描述的方法没有错。这个问题没有对错之分。

您必须记住，要向用户显示 $ 值，您需要始终进行除法运算或某种格式设置。

如果一切都以美分或美元为单位，调试公式/计算会更容易吗？你会以美分或美元显示价值吗？等等

保持简单，但无论哪种方式，您都必须使用小数。

# javascript - Javascript/JQuery - 无法在特定元素上触发 keydown 事件

> ID：10952883
> 
> 赞同：0
> 
> 时间：2012-06-08T16:45:18.390
> 
> 标签：javascript, jquery, javascript-events

我试图在我的 Web 应用程序的特定上下文中按下 Delete 键时触发“keydown”事件。例如，我实现了一个在线文件系统，当使用该视图时，我希望 keydown 事件处于活动状态。

但是，当执行某些操作时，我也会在页面上弹出某些弹出窗口。当这些弹出窗口可见时，我希望禁用 keydown 事件，因为该事件会干扰它们的功能。我目前拥有的工作事件代码不这样做：

```
$(document).keydown(function(event){
   if(event.which === 46 && ($('.selected').size() > 0)){
       saveDelete();
   }
}); 
```

有没有办法让这个 keydown 事件在某些条件下停止触发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:49:22.007

我想你想要 .length （没有括号）而不是 .size() ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:51:06.047

1.  更改您的代码以使用[`.length`](http://api.jquery.com/length/)而不是大小。

2.  当您的弹出窗口可见时，您可以通过调用取消绑定事件处理程序[`.off`](http://api.jquery.com/off/)，当您的弹出窗口不可见或用户关闭它时，您可以再次通过调用重新附加 keyevent [`.on`](http://api.jquery.com/on/)，如果您使用 jQuery 1.7 早期版本，这将起作用，您将不得不使用[`.bind`](http://api.jquery.com/bind/)和[`.unbind`](http://api.jquery.com/unbind/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T17:03:05.370

I am not 100% sure but try this-

```
window.onkeydown(function(){
//code goes here
}); 
```

# c# - 要验证模拟，是否需要返回来验证

> ID：10952885
> 
> 赞同：1
> 
> 时间：2012-06-08T16:45:38.577
> 
> 标签：c#, unit-testing, mocking, moq

我无法让我的验证在数据库调用中工作。

我有一个方法，我只是想验证是否进行了数据库调用。

我不能发布真正的代码，但这是一个很接近的例子。

```
 protected void ReportDB(uint waitTimeInMinutes)
    {
        //check database connection
        Status dbStatus = Status.Ok;
        string dbComment = "ok";
        try
        {
            Data.GetActive("1");
        }
        catch (Exception ex)
        {
            dbComment = "Unable to access the database: " + ex.Message;
            dbStatus = Status.Critical;
        }

        //Report Status.
    } 
```

所以基本上 GetActive() 方法只是进行数据库调用。如果它没有抛出异常，那么我们就很好，连接性就很好了。

我的测试方法是。

```
 [TestMethod]
    public void ReportDBStatusTest()
    {
        _fakeData.Setup(s => s.Data.GetActive(It.IsAny<string>()));

        _unitUnderTest = new Service();
        _unitUnderTest.ReportDB(0);

        _fakeData.Verify(s => s.Data.GetActive(It.IsAny<string>()), Times.Once());
    } 
```

我调试并调用了该方法以及所有内容，但验证说它被称为 Times.Never。我想我可能只是误解了如何正确地做到这一点。

错误：

预期在模拟上调用一次，但为 0 次： s => s.Data.GetActive(It.IsAny()) 配置的设置和调用：

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T16:52:56.160

该错误是预期的。这是因为“ReportDB”对象内的“Data”对象与“_fakeData”对象内的“Data”对象不同。

一种解决方法是将“报告数据库”对象中的“数据”对象外部化，以便对其进行模拟。否则，您需要更改单元测试。

# java - 亚马逊简单的工作流-并行处理任务，只有在前一阶段的所有并行流程完成后才进入下一阶段

> ID：10952888
> 
> 赞同：1
> 
> 时间：2012-06-08T16:45:46.983
> 
> 标签：java, amazon-swf

我正在努力创建一个应用程序，其中有多个阶段 - 在第一阶段有多个任务要并行执行......一旦该阶段的所有任务都已完成，只有这样处理才能进入下一阶段。

从我读到的关于决策者的内容中，决策者可以从下一阶段的许多可能选项中进行选择。

但是只有当当前阶段的所有并行进程都完成时，我才想进入下一个阶段。

这是否意味着我应该设置每个并行进程来调用下一个阶段，并且在下一个阶段初始化时，它应该检查上一个阶段的所有并行进程是否完成，然后才真正开始处理？这意味着第一阶段的所有并行进程都将调用corresp。第二阶段的并行进程，其中只有一个将实际进行处理（因为这将是发现前一阶段的所有进程都完成的进程）。

有没有更好的方法来实现这一点？这样下一个阶段的过程只被调用一次？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T17:15:09.140

这可以使用[流框架](http://docs.amazonwebservices.com/amazonswf/latest/awsflowguide/welcome.html?r=1431)中的活动返回的 Promise 对象来解决。

在您的决策程序代码中，为 stage1 提供一个函数，该函数将并行执行多个活动，每个活动都返回一个 Promise 对象。将所有这些 Promise 对象添加到 a 中`List<Promise<>>`，并将此 List 传递给处理阶段 2 的异步方法。

这是一个示例决策程序代码。`stage1()`并行执行三个活动并调用异步方法`stage2(@Wait List<Promise<Void>> promiseList)`。除非promiseList 中的所有promise 都满足，否则stage2 不会启动，即除非stage1 中的所有三个活动都已完成。

```
private void stage1() {
    List<Promise<Void>> promiseList = new ArrayList<Promise<Void>>();
    Promise<Void> promise1 = activityClient.activity1();
    Promise<Void> promise2 = activityClient.activity2();
    Promise<Void> promise3 = activityClient.activity3();

    promiseList.add(promise1);
    promiseList.add(promise2);
    promiseList.add(promise3);

    stage2(promiseList);
}

@Asynchronous
private void stage2(@Wait List<Promise<Void>> promiseList) {
    activityClient.activity4();
} 
```

# php - 为什么这个 PHP 构造不是数组，顺便说一句，如果不是数组，它是什么？

> ID：10952891
> 
> 赞同：0
> 
> 时间：2012-06-08T16:45:51.920
> 
> 标签：php, arrays

我的阵列有问题。

```
$mini_one = array(
    "in" => "#pp1",
    "ot" => "the-r1",
    "fn" => "the_r1()",
    "js" => "$('the-r1').val($('#pp1').val());",
    "ep" => "not tested"
);

$mini_two = array(
    "in" => "#pp1",
    "ot" => "the-r1",
    "fn" => "the_r1()",
    "js" => "$('the-r1').val($('#pp1').val());",
    "ep" => "not tested"
);
//these are different but i just c/p it to show more than one array 
//inside of $big_array

$big_array = array($mini_one,$mini_two); 
```

但是当我用 is_array() 测试 big_array 时它返回 false，它在我的 foreach 循环中也不起作用。

我想知道为什么它不是一个数组？，我怎样才能把它变成一个正确的数组？，现在，它被认为是什么类型的构造？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:49:56.020

代码是正确的

```
print_r($big_array);

if(is_array($big_array)) echo 'is array'; else echo 'not array'; 
```

将输出“是数组”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:56:50.960

您需要粘贴确切的数组以便我们查看发生了什么。我尝试使用您上面的代码片段，它可以工作。您的 $big_array 将如下所示

```
Array
(
    [0] => Array
        (
            [in] => #pp1
            [ot] => the-r1
            [fn] => the_r1()
            [js] => $('the-r1').val($('#pp1').val());
            [ep] => not tested
        )

    [1] => Array
        (
            [in] => #pp1
            [ot] => the-r1
            [fn] => the_r1()
            [js] => $('the-r1').val($('#pp1').val());
            [ep] => not tested
        )

)

so its multidimensional to loop through it with foreach you need to do the following.
foreach($big_array as $k=>$v) {
foreach($v as $v1) {
echo $v1."<br>";
}
} 
```

# android - Android 中的自定义字体在不同 API 中的呈现方式不同

> ID：10952894
> 
> 赞同：32
> 
> 时间：2012-06-08T16:46:28.623
> 
> 标签：android, api, fonts, rendering, typeface

我在我的 android 应用程序中使用自定义 .ttf 字体。我以通常的方式加载它：

```
myTypeface = Typeface.createFromAsset( getAssets(), "myTypeface.ttf"); 
```

然后我在我的活动中分配我的字体......非常简单的东西：

```
TextView tv = (TextView) findViewById(R.id.sample_text);
tv.setTextSize(12);
tv.setTypeface(App.myTypeface); 
```

我遇到的问题是在某些使用更高版本的 API 的设备上（我在华硕 Transformer 的模拟器中特别注意到它），文本看起来稍微粗一点，宽度不太均匀，垂直对齐更混乱。最后一部分我的意思是一些字符垂直放置比其他字符高或低一些，给文本带来一点过山车的感觉。

考虑下面的屏幕截图

这是在模拟器上呈现的文本，其分辨率和 dpi 与 Transformer 相同，但使用的是 Google API 级别 8。

![i45.tinypic.com/142toud.png](../Images/5b447ba130152d8e5636e406cf92b034.png)

看起来很标准，对吧？

现在考虑在具有相同分辨率和 dpi 但使用 Google API 级别 15 的模拟器中呈现的文本：

![i47.tinypic.com/24zhekn.png](../Images/208cd1711cc9272d8c16d679de87204f.png)

起初，文本可能看起来很相似，但您可能会注意到它看起来有点粗体。但是，请看“quick”中的“c”。你会注意到它比第一个渲染中的“c”更低，更高。您还会注意到，如果您查看单词“quick”中字符的底部，它们并没有在底部对齐。

这些问题可能看起来很小，但在有大量文字的屏幕上，它开始显得非常不专业。

有人看到这个，或者有解释吗？我想让文本在以后的 API 中看起来统一。

非常感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-06-08T17:41:37.687

好的，所以它似乎在两种情况下都应用了以下标志：

```
Paint.DEV_KERN_TEXT_FLAG
Paint.ANTI_ALIAS_FLAG 
```

尝试这样做，看看结果是否有任何不同（不一定有所改善，但甚至根本不明显）：

```
textView.setPaintFlags(textView.getPaintFlags() | Paint.SUBPIXEL_TEXT_FLAG); 
```

# ios - 从应用程序中删除了核心位置，但仍被要求提供用户位置

> ID：10952897
> 
> 赞同：5
> 
> 时间：2012-06-08T16:46:39.480
> 
> 标签：ios, core-location

我从现有的 iOS 应用程序中删除了 Core Location 框架。我删除了所有需要核心位置的相关代码。

即使从设备中删除构建并部署新构建后，我仍然会收到询问我位置的提示。

我之前遇到过类似的问题，不得不格式化设备。问题是，这是已经发布的应用程序的第 2 版。如果我不打算使用核心位置，我不希望用户提示它。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T17:59:01.693

你检查过你的 Info.plist 文件吗？您可能在“所需的后台模式”部分中有“应用程序注册位置更新”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T02:44:58.780

你的应用程序`startMonitoringSignificantLocationChanges`或你使用过`startMonitoringForRegion:desiredAccuracy:`吗？如果你这样做了，操作系统可能仍然会为这些注册你的应用程序。然后你只需要停止这些，它应该可以工作。

# google-api - 在 Google Apps 脚本中使用 Usermanager.getUser() 捕获错误

> ID：10952901
> 
> 赞同：0
> 
> 时间：2012-06-08T16:47:07.987
> 
> 标签：google-api, google-apps-script

我正在使用 Google 电子表格创建一个脚本文件，该文件必须处理获取我的 Google Apps 域上的用户信息。我拥有管理员权限并且启用了 Provisioning API。在我的代码中，我试图在 Google Apps 域（未找到用户）上查找特定用户时捕获错误，而是显示一条消息并继续执行程序的其余部分。当用户没有错误时，我在这里使用的 try-catch 语句有效。但是，当检索用户时出现错误时，我收到错误：“序列化继续时出现意外异常”。这是我的代码：

```
function testOfDomainAccess() {

var i=0;
var anArray= ["johhn.smith", "susan.que]; //john smith misspelled
var user;

for (i=0; i < anArray.length; ++i)
{ 
Logger.log("\nThe current user being processed is " + anArray[i]);

try 
{
user = UserManager.getUser (anArray [i]);
}
catch (error)
{
  Browser.msgBox("Error: " + error.name + "\n Check your spreadsheet for misspellings of " + anArray[i] + " and We will continue to the next user.");
  user = null;
}

if (user != null) {
//Perform tasks 
}

else
  Logger.log("User not found in domain. Moving on the next item in the array.");
} 
```

如果有人可以帮助解决这个问题，我将不胜感激。我是 Google Apps 脚本和配置 API 的新手。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T19:05:47.837

看起来与[http://code.google.com/p/google-apps-script-issues/issues/detail?id=980](http://code.google.com/p/google-apps-script-issues/issues/detail?id=980)报告的错误相同。

解决方法是用 Logger.log() 替换 Browser.msgBox() 调用，您的脚本应该按预期运行。

# tfs - TFS 设置相关问题

> ID：10952904
> 
> 赞同：2
> 
> 时间：2012-06-08T16:47:21.480
> 
> 标签：tfs, tfsbuild

是否有任何关于使用 TFS 实现以下目标的重点文档。我发现自己必须通读 MSDN 上的大量文档，但我发现主题下没有列出任何内容，或者我可能不知道要查找什么。除了签入和签出文件之外，我在 TFS 方面没有经验，我仍在尝试了解这些文件的含义以及如何在文档中找到它，但运气不佳。

1.  选择项目的门控签入+持续构建。
2.  其他选定项目的门控签入 + 预定构建。
3.  用于选择个人或组的仪表板和报告
4.  测试团队成员只能访问分配给他们的 TFS 项目的选择性工作项创建。他们应该能够获得最新版本的代码并能够记录工作项错误、工作项问题、工作项测试用例，但他们不应该能够创建例如。工作项：用例。
5.  测试人员不应该能够修改代码。
6.  将邮件发送给分配了工作项的人员，并附上选定人员的副本。
7.  向分配了错误的任何人发送电子邮件。当错误关闭时，提出错误的人应该通过电子邮件收到通知。
8.  在项目的构建失败时，向 TFS 中某处定义的项目的关键人员发送邮件。

如果有人已经做过上面列出的任何一点的事情，那么你能告诉我这些步骤吗？不知何故，文档跳过了太多链接并进入了各种切线。

感谢您的时间和耐心..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:52:31.113

为了：

1.  访问 Microsoft TFS 站点[http://msdn.microsoft.com/en-us/vstudio/ff637362.aspx](http://msdn.microsoft.com/en-us/vstudio/ff637362.aspx)。寻找培训视频。你想要的大部分东西都被覆盖了。

2.  [http://vsarbranchingguide.codeplex.com/](http://vsarbranchingguide.codeplex.com/)上的*Visual Studio Team Foundation Server 分支和合并指南*是一个很好的指南。

3.  http://www.microsoft.com/en-us/download/details.aspx?id=27152上的*Visual Studio Team Foundation Server 2010 培训工具包简介*很有帮助[。](http://www.microsoft.com/en-us/download/details.aspx?id=27152)

# c# - 将 ImageList 与其键重新关联

> ID：10952905
> 
> 赞同：0
> 
> 时间：2012-06-08T16:47:24.057
> 
> 标签：c#, serialization, icons, client-server

我有一个客户端和一个服务器。服务器从其桌面检索应用程序列表（每个都包含路径、名称和图标）。然后它将应用程序发送回客户端，以显示在带有 LargeIcons 的 ListView 中，以便客户端可以双击列表视图中的桌面图标并在服务器上打开该应用程序。（当完成以下错误时，这可以 100% 工作......）

但是，有一个 Microsoft 错误，其中反序列化时序列化的图标会降级 ( [http://support.microsoft.com/kb/814735](http://support.microsoft.com/kb/814735) )

我正在尝试遵循那里给出的建议，以恢复高质量的图标。

这是我正在做的事情：

```
//Get the list of Applications, which will include an icon, which we'll ignore due to the bug.
List<App> apps = client.ServiceProxy.getDesktopShortcuts();
// Get the ImageListStreamer (The serializable portion of the ImageList) and assign it to our Image List
ImageListStreamer il = client.ServiceProxy.getDesktopIcons();

foreach (App app in apps){
    ListViewItem item = new ListViewItem(app.name);
    item.ImageKey = app.path;
    lv.Items.Add(item);
} 
```

当我在 getDesktopIcons() 中将图标添加到 ImageList 时，我执行以下操作：

```
il.Images.Add(app.path, app.icon); 
```

以使应用程序的路径成为关键。但是，我相信当我只将图像流发送回客户端时，它会丢失该关键信息。我在每个 App 对象中都有应用程序的路径，那么如何按顺序将它们与图像列表中的相应图标相关联？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:00:02.020

答案很简单。由于我的 List 和 ImageList 都是按相同的顺序构建的，因此可以安全地假设，当我遍历给定的应用程序时，Apps[0] 将对应于 ImageList[0]。

因此，我只需要使用

```
il.Images.SetKeyName(i, app.path); 
```

与要设置的图像的索引（对应于应用程序）。

# ruby - Sass：Listen 已经退回到轮询

> ID：10952906
> 
> 赞同：16
> 
> 时间：2012-06-08T16:47:26.853
> 
> 标签：ruby, sass

我正在尝试使用 sass，当我编译我的文件时它给了我一个错误。它可以工作（.scss 文件被编译成 .css 文件）但是我收到了这个警告： `WARNING: Listen has fallen back to polling, learn more at https://github.com/guard/listen#fallback.`

当然我阅读了给出的链接，但是除了重新启动操作系统之外，我不知道其他解决方案是什么。如果需要，这里有一些关于版本的信息： ruby​​：1.9.3 sass：3.1.19 mac 上的一切。

有人可以帮助我吗？谢谢

（哦，我仍然有这个问题=> [Ruby 没有在 mac os x 上启动](https://stackoverflow.com/questions/10873759/ruby-not-starting-on-mac-os-x)）

**编辑** 我找到了解决方案......听没有安装（是的，我很惭愧）。

所以你可以忽略我的问题，但如果你知道我正在听的关于红宝石的旧问题（不是双关语）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-12T08:38:44.343

你可以试试：

```
 sudo gem install  listen 
```

其次是：

```
 gem install --version '~> 0.8.8' rb-inotify 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-28T07:32:29.730

Debian 7 的默认安装只有`ruby`1.8.7，新版本的`listen`. [Github 票证](https://github.com/rubygems/rubygems/issues/798)意味着`listen`1.3.1 是`ruby`.

```
$ ruby --version
ruby 1.8.7 (2012-02-08 patchlevel 358) [x86_64-linux]

$ sudo gem install --version '1.3.1' listen 
```

`gem`应该`rb-inotify`作为`listen`.

# c# - 如何在 Nant 0.91 中使用正则表达式调用 C#

> ID：10952911
> 
> 赞同：3
> 
> 时间：2012-06-08T16:47:39.903
> 
> 标签：c#, nant

在 Nant 0.85 中，您可以调用 C# 脚本，它会导入`System.Text.RegularExpressions`命名空间。现在在 0.91 中不再是这种情况，我似乎无法`System.Text.RegularExpressions`正确导入。我尝试添加以下内容

```
<imports>
  <import namespace="System.Text.RegularExpressions" />
</imports> 
```

我看到`System.Text.RegularExpressions`被添加到 using 语句中，但我不断收到错误消息：

> 命名空间“System.Text”中不存在类型或命名空间名称“RegularExpressions”（您是否缺少程序集引用？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T20:11:37.890

您需要添加对以下内容的引用`System.dll`：

```
<references>
  <include name="System.dll" />
</references> 
```

# gerrit - Gerrit - 应用程序错误 - 由于服务器错误，行内差异不可用

> ID：10952912
> 
> 赞同：2
> 
> 时间：2012-06-08T16:47:47.890
> 
> 标签：gerrit

对于我们的一个 gerrit 项目，在浏览文件差异时，我们会收到以下错误：

应用程序错误

由于服务器错误，行内差异不可用

[继续]

并非所有项目都会发生这种情况，目前我们仅在一个项目上检测到错误。

我查看了 Google 和 gerrit 文档。在他们的源代码上找到了参考，但不知道是什么原因造成的以及如何解决。

出现错误的网页包含“继续”按钮。单击后，它将带您进入您选择的文件，但错误很烦人。

你知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-18T09:25:04.920

这是在缓存一个文件的行内差异时引起的，在两次提交之间进行比较时。默认超时值为 5 秒。如果文件很大，并且计算时间超过超时，工作线程将终止，显示错误消息，并且文件对不显示行内差异。

一个解决方案可以解决这个问题。

1.  在 gerrit.conf 中添加配置。

    [缓存“diff_intraline”]

    timeout = 15000 ms # 或者你想要的其他时间长度。

2.  重启 Gerrit 服务
3.  使用具有 ViewCaches 全局功能的用户运行 SSH 命令“gerrit flush-caches”。

    *ssh -p 端口 userxxx@host gerrit 刷新缓存*

然后它会工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:31:35.483

错误原因：

这是因为 Gerrit 花费了太长时间来比较文件，并将其缓存之一中的差异标记为不可用。

相关的错误日志在这里：[2012-06-08 11:14:08,547] WARN com.google.gerrit.server.patch.IntraLineLoader：在提交 354dd67ad54578cf801d8cda64a4ae8484ebb0b7 比较路径 xxxxxxx.java 时，项目 xxxxxxx 中的 IntraLineDiff 达到 5000 毫秒超时bf9fbc21520af7bfd0841c8b9f955ca6e215b059..f6b9c7992c12cfdca253acd033966f98f70f3543。杀死 IntraLineDiff-6

# wpf - WPF中的自定义日期时间字符串格式

> ID：10952913
> 
> 赞同：9
> 
> 时间：2012-06-08T16:47:48.713
> 
> 标签：wpf, datetime, binding, string-formatting

我无法让我的自定义 DateTime 字符串格式在我的绑定中工作。我希望格式为“mmmm, yyyy”（例如“June, 2012”）。

以下不起作用。我得到一个短日期格式（m/d/yyyy）。

```
<TextBlock Text="{Binding ElementName=ThisWindow,
                          Path=Date,
                          StringFormat={}{0:MMMM\, yyyy}"/> 
```

我考虑过使用转换器，但我更喜欢纯 XAML 方法。

**编辑：**

为清楚起见，我有一个类型`Window`为依赖属性`Date`的`DateTime`。在我的 XAML 中，我将窗口命名为“Thiswindow”。

**编辑2：**

我回顾了我的实际代码，我有一个`Label`，而不是`TextBlock`. 我将其更改为 TextBlock，它工作正常。

```
<Label Content="{Binding ElementName=ThisWindow,
                 Path=Date,
                 StringFormat={}{0:MMMM\, yyyy}"/> 
```

任何人都知道为什么它不起作用`Label`？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-08T17:15:16.890

`ContentControls`具有覆盖原始格式的[`ContentStringFormat`属性。](http://msdn.microsoft.com/en-us/library/system.windows.controls.contentcontrol.contentstringformat.aspx)

（当我看到你的问题时，我以为这实际上是问题，但一开始却很惊讶地发现`TextBlock`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T17:02:20.283

Your month needs to be in uppercase:

```
{Binding Source={x:Static sys:DateTime.Now}, StringFormat={}{0:MMMM\, yyyy}} 
```

EDIT:

The Label problem is probably because Label has Content, not Text.

Change the Text="{Binding ...}" to Content="{Binding ...}"

# c++ - 我如何比较 HKL 和 char[]？

> ID：10952921
> 
> 赞同：0
> 
> 时间：2012-06-08T16:48:19.640
> 
> 标签：c++, char, compare

我有

```
DWORD dwThreadID = GetCurrentThreadId();
HKL hCurKeyboard = GetKeyboardLayout(dwThreadID); 
```

返回HKL当前键盘我需要将它与一些字符进行比较

```
char defaultLanguage[64]="0x04090409"; 
```

我如何将 HKL`hCurKeyboard`与`defaultLanguage`

或者我怎样才能用这个值创建一些 HKL`"0x04090409"`

```
 char defaultLanguageLayout[64] = "0x04090409";
        DWORD dwThreadID = GetCurrentThreadId();
        HKL hCurKeyboard = GetKeyboardLayout(dwThreadID);
//->>       if(hCurKeyboard!=defaultLanguageLayout) 
        {

            UINT i;
            HKL hklCurrent;
            UINT uLayouts;
            HKL * lpList;

            uLayouts = GetKeyboardLayoutList(0, NULL);
            lpList = (HKL*) malloc(uLayouts * sizeof(HKL));
            uLayouts = GetKeyboardLayoutList(uLayouts, lpList);

            for(i=0; i<uLayouts; i++)
            {
                hklCurrent = *(lpList + i);

//->>               if(hklCurrent == defaultLanguageLayout){
                    ActivateKeyboardLayout(hklCurrent, 0);
                }
            } 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:12:57.727

根据[http://msdn.microsoft.com/en-us/library/windows/desktop/ms646305(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646305(v=vs.85).aspx)，最好的做法是：

```
 HKL defaultLanguageLayout = LoadKeyboardLayout("0x04090409", KLF_SUBSTITUTE_OK);
    DWORD dwThreadID = GetCurrentThreadId();
    HKL hCurKeyboard = GetKeyboardLayout(dwThreadID);
    if(hCurKeyboard!=defaultLanguageLayout) { 
```

但是我对键盘布局的了解还不够，无法知道第二个参数是否正确。

# model - JavascriptMVC：使用静态 json 的 findAll

> ID：10952922
> 
> 赞同：0
> 
> 时间：2012-06-08T16:48:21.837
> 
> 标签：model, javascriptmvc, findall

我有一个有趣的情况。我有一个控制电话的人

```
 Todo.Models.PersonAddress.findAll({
                personId:personId
            }, this.callback('list')); 
```

在我们得到的模型中：

```
findAll: function( params, success, error ){
    $.ajax({
        url: '/person/get-address-json',
        type: 'post',
        dataType: 'json',
        data: params,
        success: this.callback(['wrapMany',success]),
        error: error
    });
}, 
```

论文工作完美。但是，我想更改我的模型以带来我当前代码中已有的 JSON 字符串。它看起来像：

```
findAll: function( params, success, error ){

    var source = jQuery.parseJSON($('#address-personData').val());
    var person_addresses = this.wrapMany(source);
    this.callback(person_addresses, success);
} 
```

但是 callback() 根本不起作用，也不会给出任何错误提示。有人可以帮我解决这个问题吗？我想要的只是带来与 $.ajax 相同的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T11:10:00.487

您可以在这里调用成功方法。试试`success()`；

# c# - 如何使用 BeginExecuteReader

> ID：10952927
> 
> 赞同：6
> 
> 时间：2012-06-08T16:48:37.770
> 
> 标签：c#, .net, ado.net

再会。

请帮助我了解如何使用通用列表使用 SqlCommand 类的三种方法 BeginExecuteReader()。我用BeginExecuteReader做了一个方法，但我不知道这是否是最好的使用方式

```
public class Empresa {
    public Empresa() {
        PkEmpresa = -1;
        CodigoEmpresa = "";
        Descripcion = "";
        PkCategoriaEmpresa = -1;
    }

    public int PkEmpresa { get; set; }
    public string CodigoEmpresa { get; set; }
    public string Descripcion { get; set; }
    public int PkCategoriaEmpresa { get; set; }

    public Empresa ShallowCopy() {
        return (Empresa)this.MemberwiseClone();
    }
}

public class AsyncronousDAL {
    private static string getConexion() {
        return "Data Source=DATABASE;Initial Catalog=DATA_BASE;Integrated Security=True;Asynchronous Processing=True";
    }

    public static List<Empresa> ConsultaAsincrona() {
        List<Empresa> _resultados = new List<Empresa>();

        using (SqlConnection conexion = new SqlConnection(getConexion())) {
            using (SqlCommand commando = new SqlCommand("[dbo].[pruebaAsync]", conexion)) {
                commando.CommandType = System.Data.CommandType.StoredProcedure;
                conexion.Open();
                IAsyncResult resultado = commando.BeginExecuteReader();
                using (SqlDataReader reader = commando.EndExecuteReader(resultado)) {
                    while (reader.Read()) {
                        _resultados.Add(new Empresa() {
                            PkEmpresa = Convert.ToInt32(reader["PkEmpresa"]),
                            CodigoEmpresa = reader["CodigoEmpresa"].ToString(),
                            Descripcion = reader["Descripcion"].ToString(),
                            PkCategoriaEmpresa = Convert.ToInt32(reader["PkCategoriaEmpresa"])
                        });
                    }
                }
            }
        }

        return _resultados;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T17:07:16.927

如果您不熟悉异步模式，网上有很多教程和示例。这是旧的，但仍然相关： http: [//msdn.microsoft.com/en-us/library/aa719595 (v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa719595(v=vs.71).aspx)

当您调用`BeginExecuteReader`该工作时，最终将被推送到工作线程，从而允许您的 main 继续执行。当你调用`EndExecuteReader`这将导致你的主线程阻塞，直到该任务完成。

如果您立即调用 EndExecuteReader - 您并没有真正获得任何好处（实际上，您正在引入额外的开销）。

看看这里的例子：http: [//msdn.microsoft.com/en-us/library/7szdt0kc.aspx](http://msdn.microsoft.com/en-us/library/7szdt0kc.aspx)

> BeginExecuteReader 方法立即返回，但在代码执行相应的 EndExecuteReader 方法调用之前，它不得执行任何其他对同一 SqlCommand 对象启动同步或异步执行的调用。在命令执行完成之前调用 EndExecuteReader 会导致 SqlCommand 对象阻塞，直到执行完成。

这是代码的相关部分：

```
 // Although it is not required that you pass the 
            // SqlCommand object as the second parameter in the 
            // BeginExecuteReader call, doing so makes it easier
            // to call EndExecuteReader in the callback procedure.
            AsyncCallback callback = new AsyncCallback(HandleCallback);
            command.BeginExecuteReader(callback, command); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:59:03.740

如果您要立即阻止（调用`EndExecuteReader`），您应该只使用[ExecuteReader](http://msdn.microsoft.com/en-us/library/bb352798)而不是`BeginExecuteReader`.

# ios - iOS 开发者计划和/或 Mac 开发者计划

> ID：10952928
> 
> 赞同：4
> 
> 时间：2012-06-08T16:48:53.140
> 
> 标签：ios, macos, iphone-developer-program

我已经为 Mac 和 iOS 编写了应用程序，我觉得它们已经接近完成了。我想在他们各自的应用商店上发布它们......我是否必须为此购买 Mac 和 iOS 开发者计划的会员资格？如果我能帮上忙，我真的不想支付 198 美元……另外，假设我只获得了 iOS 开发者计划：除了发布到 App Store 和 iOS 测试版的能力之外，我还能得到什么吗？例如，我可以访问 Mountain Lion 测试版吗？同样，如果我加入了 Mac 开发者计划，除了能够发布到 Mac App Store 或访问 OS X 测试版之外，我还能获得什么吗？

基本上，这两个开发人员计划之间是否有任何重叠？还是它们是两个完全不同的东西？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T16:50:54.977

不幸的是，您必须支付两次费用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T16:51:11.413

是的，您必须同时拥有两个会员资格

*   如果你有 ios 你就不能有山狮
*   如果你有 mac，那么在 beta 版中你不能有 ios6

我只有 iOS 会员，无法下载山狮

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-26T18:50:21.253

Apple 合并两个程序已经有一段时间了，但无论如何，你可以花 99 美元购买这两个程序。

# visual-studio - 在视觉工作室的主要项目之前运行一个项目

> ID：10952929
> 
> 赞同：1
> 
> 时间：2012-06-08T16:49:02.520
> 
> 标签：visual-studio, build

我有一个项目，用于将输入文本文件转换为 css。我想每次运行我的 MVC 项目时都运行这个项目，以便它生成最新的 css 文件。

我知道我可以在 BeforeBuild 中运行一个任务来实现这一点，但它需要我链接到我的项目的 dll 文件。（这是一个问题，因为如果我使用 dll 文件，那么我将不得不手动更新 dll 文件

有没有办法可以构建和运行我的第一个项目，然后启动 MVC？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:55:04.320

右键单击解决方案中的MVC项目并选择`Project Dependencies`，然后选中您要先构建的项目

![在此处输入图像描述](../Images/3ab03ba273df8838be5f7204f89a6844.png)

这将确保依赖项目首先构建。

然后右键单击解决方案，选择属性并选择多个启动项目以运行两个项目

# c# - 如何通过 2 字段订购

> ID：10952930
> 
> 赞同：3
> 
> 时间：2012-06-08T15:59:08.693
> 
> 标签：c#, entity-framework

我使用 Entity Frameword 并希望列出按 2 个字段排序的对象。我的表达如下：

```
TbCusromers.OrderBy(x->x.Family, x.Name); 
```

如何按家庭和姓名对列表顺序进行排序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T16:02:14.647

```
TbCusromers.OrderBy(x=>x.Family).ThenBy(x=>x.Name); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T12:08:04.003

虽然我赞成上述答案，但您可能还想考虑这一点。

```
TbCusromers.OrderBy( x=> x.Family + x.Name ) 
```

这将允许您按两个字段的连接版本进行排序。

# javascript - 使用 Javascript 有没有办法抓取由线性或径向渐变呈现的背景图像？

> ID：10952932
> 
> 赞同：1
> 
> 时间：2012-06-08T16:49:11.427
> 
> 标签：javascript, jquery, image, background-image, gradient

我对渐变特别感兴趣，但我想这个问题适用于使用任何方法渲染的图像，例如 data:image/svg+xml;...

是否可以？

预计到达时间：

这可以通过将渐变渲染到画布上来实现。对于任何有兴趣保存 CSS3 线性或径向渐变的 .png 的人，请访问：

[http://www.visualcsstools.com/gradient-generator.htm](http://www.visualcsstools.com/gradient-generator.htm)

设计您的渐变，单击 CVS（画布）按钮并右键单击渐变预览以将其保存为图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:01:10.377

具有 CSS 渐变背景的 DOM 元素，如果没有屏幕截图实用程序，就无法做到这一点。

但是，如果您在画布元素（以及画布元素中的任何其他图形）中绘制渐变，则可以在浏览器中使用 JavaScript 将画布元素的图形导出为 JPG 或 PNG。[看到这个问题](https://stackoverflow.com/questions/8780628/outputting-html5-canvas-as-an-image-howto)。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-08T16:50:25.443

也许通过截图？

# jquery - 更改照片滑动的背景颜色

> ID：10952933
> 
> 赞同：1
> 
> 时间：2012-06-08T16:49:15.983
> 
> 标签：jquery, css, jquery-plugins, photoswipe

[http://www.photoswipe.com/latest/examples/04-jquery-mobile.html](http://www.photoswipe.com/latest/examples/04-jquery-mobile.html) 我正在使用这个例子。我已经很久了，但不知道背景颜色在哪里。任何帮助都会很棒。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-27T07:34:17.907

它现在位于**photoswipe.css**文件中 - 请参阅类的“背景”属性：

**.pswp__bg**

您可以将其更改为您需要的任何颜色。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-10-23T20:00:21.080

在文档中。例如，将 bgOpacity 设置为 0.85。

[http://photoswipe.com/documentation/options.html](http://photoswipe.com/documentation/options.html)

```
var options = {  index: 0, bgOpacity: 0.85 }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-06-11T19:11:21.350

我正在使用 Cargo Collective 构建网站，他们的内置灯箱使用 photoswipe。我必须将以下内容添加到自定义 CSS 以更改背景颜色：

```
}
.pswp__bg {
    background-color: #fff !important;
}
.Pswp_bg image-zoom-background {
    background-color: #fff !important; 
```

# javascript - jQuery fullcalendar 到波斯语

> ID：10952938
> 
> 赞同：6
> 
> 时间：2012-06-08T16:49:32.613
> 
> 标签：javascript, jquery, jquery-plugins

我想将 jquery fullcalendar 更改为波斯日历。

我正在使用这段代码：

```
 isRTL: true,
    monthNames: ['فروردين', 'ارديبهشت', 'خرداد', 'تير', 'مرداد', 'شهريور',
                'مهر', 'آبان', 'آذر', 'دي', 'بهمن', 'اسفند'],
    monthNamesShort: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'],
    dayNames: ['يکشنبه', 'دوشنبه', 'سه‌شنبه', 'چهارشنبه', 'پنجشنبه', 'جمعه', 'شنبه'],
    dayNamesShort: ['يکشنبه', 'دوشنبه', 'سه‌شنبه', 'چهارشنبه', 'پنجشنبه', 'جمعه', 'شنبه'],
    dayNamesMin: ['يکشنبه', 'دوشنبه', 'سه‌شنبه', 'چهارشنبه', 'پنجشنبه', 'جمعه', 'شنبه'],
    weekHeader: 'هفته',
    dateFormat: 'yy/mm/dd',
    firstDay: 6, 
```

我的用户界面已更改，但日历可能不是波斯语

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-29T14:34:36.493

[jalali-fullcalendar](https://github.com/faravaghi/jalali-fullcalendar) may help you. Even if you don't use PHP or Yii you can take a look and extract the methods you need.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-29T18:00:45.980

您可以使用 javascripts 函数和类，使用该示例将公历转换为波斯语或反向并在 js 中呈现月份，请遵循此存储库：

[mpdatepicker](https://github.com/4xmen/mpdatepicker)

例如功能：

```
getPersianWeekDay // return persian weekday
gDate2Timestamp // Gregorian to timestamp
pDate2Timestamp // persian to timestamp
pGetLastDayMonth // for find last persian month day
ShowMonth // show a persian months
Persian2Gregorian 
Gregorian2Persian 
```

# php - 如何为每个用户构建未读项目警报的数据库

> ID：10952939
> 
> 赞同：8
> 
> 时间：2012-06-08T16:49:34.553
> 
> 标签：php, mysql, database-design, cookies

我只有一个一般的数据库理论问题。我需要做一些类似于显示用户查看或未查看的帖子/项目（例如在论坛中）或未读电子邮件的内容。我所拥有的是多个用户可以查看的帖子，但它需要由实际查看过的用户分开。因此，如果用户 A 查看了帖子 1，它将不再显示帖子 1 是要查看的新项目，但对于用户 B，它仍然会显示帖子 1 是要查看的新项目。

我已经搜索了其他想法，其中一个是获取用户上次登录时间的时间戳，但我实际上需要跟踪他们看到的帖子，而不是他们上次登录后发生的帖子.

如果可能的话，我想要一个 MySQL 数据库解决方案，但如果这是必须的，我愿意接受 cookie。我可以自己做这件事并弄清楚，但我会很感激任何关于如何正确构建表格以使其最有效的建议。此外，带宽和存储也不是问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T17:10:01.080

在查看[phpBB 的相关架构时](https://github.com/phpbb/phpbb3/blob/develop/phpBB/install/schemas/mysql_41_schema.sql#L819)，我发现了以下内容：

```
# Table: 'phpbb_topics_track'
CREATE TABLE phpbb_topics_track (
    user_id mediumint(8) UNSIGNED DEFAULT '0' NOT NULL,
    topic_id mediumint(8) UNSIGNED DEFAULT '0' NOT NULL,
    forum_id mediumint(8) UNSIGNED DEFAULT '0' NOT NULL,
    mark_time int(11) UNSIGNED DEFAULT '0' NOT NULL,
    PRIMARY KEY (user_id, topic_id),
    KEY topic_id (topic_id),
    KEY forum_id (forum_id)
) CHARACTER SET `utf8` COLLATE `utf8_bin`; 
```

和：

```
# Table: 'phpbb_forums_track'
CREATE TABLE phpbb_forums_track (
    user_id mediumint(8) UNSIGNED DEFAULT '0' NOT NULL,
    forum_id mediumint(8) UNSIGNED DEFAULT '0' NOT NULL,
    mark_time int(11) UNSIGNED DEFAULT '0' NOT NULL,
    PRIMARY KEY (user_id, forum_id)
) CHARACTER SET `utf8` COLLATE `utf8_bin`; 
```

然后我[在他们的 wiki 中查看](http://wiki.phpbb.com/Table.phpbb_topics_track)：

> 该表记录访问过的主题，以便将它们标记为已读或未读。我们使用 mark_time 时间戳和主题 x 的最后一篇文章的时间戳来了解主题 x 是否被读取。
> 
> 为了准确判断一个主题是否被阅读，还必须检查 phpbb_forums_track。

所以本质上他们有一个查找表来存储与用户查看主题（线程）相关的数据，然后将其与论坛视图表中的时间戳进行检查，以确定用户是否查看了该主题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T16:56:04.973

只需创建一个简单的交叉引用表（`read_posts`或其他东西）：

```
user_id|post_id
----------------
2      | 132
53     | 43
.... 
```

确保这两个列都被索引（特别重要的`user_id`是被索引），然后使用连接（或子查询）为登录用户选择未读帖子。例如，如果您只是想显示未读帖子列表，则只需运行：

```
SELECT * FROM `posts` WHERE `post_id` NOT IN (
    SELECT `post_id` FROM `read_posts` WHERE `user_id`='[$USER ID]')
ORDER BY [your ordering clause] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T16:57:31.103

根据这个描述，我会使用一个可能有 3 列的简单表格。

1.  用户身份
2.  帖子编号
3.  首次查看的时间戳

当用户查看帖子时，在表格中添加一行。如果给定用户/帖子 ID 组合的表中不存在一行，则他们没有查看该帖子。

# facebook - Facebook Open Graph：发布操作时视频未显示

> ID：10952944
> 
> 赞同：0
> 
> 时间：2012-06-08T16:50:04.913
> 
> 标签：facebook, facebook-graph-api

这与[之前的问题](https://stackoverflow.com/questions/10933183/youtube-instead-of-pic-on-facebook-feed-thru-ios-sdk)类似，但现在我想在从网页发布操作时包含 youtube 视频，而不是从移动设备上的提要对话框发布。

我下面的代码是基于[官方 facebook 教程](https://developers.facebook.com/docs/opengraph/tutorial/)。我添加了基于[另一个 facebook 文档页面](https://developers.facebook.com/docs/opengraph/define-objects/#video)的视频元标记。我已经对应用程序进行了身份验证，并在单击“发布”按钮时收到了成功警报框。但是，当我转到[https://www.facebook.com/[MY](https://www.facebook.com/[MY) USERNAME]/activity/[MY ACTION ID] 时，帖子显示标题和 url 和描述都很好，但我没有看到视频缩略图。 ..

```
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US"
xmlns:fb="https://www.facebook.com/2008/fbml">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# [MY NAMESPACE]: http://ogp.me/ns/fb/[MY NAMESPACE]#">
  <meta property="fb:app_id" content="[MY APP ID]" /> 
  <meta property="og:type"   content="[MY NAMESPACE]:[MY OBJECT]" /> 
  <meta property="og:url"    content="[MY LINK]" /> 
  <meta property="og:title"  content="Sample Object" /> 
  <meta property="og:image" content="http://i4.ytimg.com/vi/k86xpd26M2g/hqdefault.jpg">
  <meta proprety="og:video" content="http://www.youtube.com/v/=yO7B9ERbqdY" />
  <meta property="og:video:secure_url" content="https://www.youtube.com/v/yO7B9ERbqdY" />
  <meta property="og:video:type" content="application/x-shockwave-flash">
  <meta property="og:video:width" content="398">
  <meta property="og:video:height" content="224">
  <meta property="og:site_name" content="YouTube">
  <meta property="og:description" content="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam quis eros metus. Etiam vehicula, eros quis     ultrices pulvinar, sapien orci malesuada sem, malesuada hendrerit lacus massa nec eros. Nullam eget volutpat nunc. Phasellus quis mattis massa. Sed     dolor lacus, rhoncus ut imperdiet ut, euismod eu ipsum." />
  <script type="text/javascript">
  function postDialog()
  {
    FB.api(
     '/me/[MY NAMESPACE]:[MY ACTION]',
     'post',
     { dialog: '[MY OBJECT URL]' },
     function(response) {
       if (!response || response.error) {
          alert("Error Type: " + response.error.type + "\n\nMessage: " + response.error.message);
        } else {
          alert('Cook was successful! Action ID: ' + response.id);
        }
      }
    );
  }
  </script>
</head>
<body>
  <div id="fb-root"></div>
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '[MY APP ID]', // App ID
        status     : true, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        xfbml      : true, // parse XFBML
        oauth      : true,
      });
    };

    // Load the SDK Asynchronously
    (function(d){
      var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
      js = d.createElement('script'); js.id = id; js.async = true;
      js.src = "//connect.facebook.net/en_US/all.js";
      d.getElementsByTagName('head')[0].appendChild(js);
    }(document));
  </script>
  <form>
    <input type="button" value="Post" onclick="postDialog()" />
  </form>
</body>
</html> 
```

问题：

1）我做错了什么？如何让视频在帖子中显示？

2）稍微不相关的[问题](https://stackoverflow.com/questions/10945533/facebook-open-graph-action-only-shows-up-in-recent-activity-not-as-individual)：我的帖子只显示在我的个人资料页面上的“最近的活动”中，因此不显示描述文本，但我真的希望我的时间轴中的帖子作为单独的帖子。这是否与我尚未提交此操作以供批准有关？

整个下午和晚上都在努力争取这个......提前非常感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:11:13.203

您`og:url`指向 youtube，它应该指向元标记所在的同一页面

# system.reactive - 使用 Rx 链接多个 2 步文件上传

> ID：10952948
> 
> 赞同：1
> 
> 时间：2012-06-08T16:50:28.930
> 
> 标签：system.reactive

我正在尝试将多个文件从 Silverlight 客户端直接上传到 Amazon S3。用户从标准文件打开对话框中选择文件，我想链接上传，以便它们一次连续发生一个。这可能发生在应用程序中的多个位置，因此我试图将其包装在一个不错的实用程序类中，该实用程序类接受所选文件的 IEnumerable 在上传文件时公开文件的 IObservable，以便 UI 可以相应地响应每个文件完成了。

由于 Silverlight 和 AmazonS3 的所有安全要求，它相当复杂。我将尝试简要解释我的整个环境的上下文，但我已经用一个小型控制台应用程序重现了这个问题，我将把代码发布到下面。

我有一个第 3 方实用程序，可以处理从 Silverlight 上传到 S3 的操作，该实用程序公开了基于标准事件的异步方法。我为每个上传的文件创建该实用程序的一个实例。它创建一个未签名的请求字符串，然后我将其发布到我的服务器以使用我的私钥进行签名。该签名请求通过服务代理类发生，该类也使用基于事件的异步方法。获得签名请求后，我将其添加到上传程序实例并启动上传。

我尝试过使用 Concat，但最终只有第一个文件通过该过程。当我使用 Merge 时，所有文件都可以正常完成，但以并行方式而不是串行方式完成。当我使用 Merge(2) 时，所有文件都从第一步开始，但只有 2 个文件通过并完成。

显然我错过了与 Rx 相关的一些东西，因为它的行为不像我预期的那样。

```
namespace RxConcat
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Reactive.Linq;
    using System.Timers;

    public class SignCompletedEventArgs : EventArgs
    {
        public string SignedRequest { get; set; }
    }

    public class ChainUploader
    {
        public IObservable<string> StartUploading(IEnumerable<string> files)
        {
            return files.Select(
                     file => from signArgs in this.Sign(file + "_request")
                             from uploadArgs in this.Upload(file, signArgs.EventArgs.SignedRequest)
                             select file).Concat();
        }

        private IObservable<System.Reactive.EventPattern<SignCompletedEventArgs>> Sign(string request)
        {
            Console.WriteLine("Signing request '" + request + "'");
            var signer = new Signer();
            var source = Observable.FromEventPattern<SignCompletedEventArgs>(ev => signer.SignCompleted += ev, ev => signer.SignCompleted -= ev);
            signer.SignAsync(request);
            return source;
        }

        private IObservable<System.Reactive.EventPattern<EventArgs>> Upload(string file, string signedRequest)
        {
            Console.WriteLine("Uploading file '" + file + "'");
            var uploader = new Uploader();
            var source = Observable.FromEventPattern<EventArgs>(ev => uploader.UploadCompleted += ev, ev => uploader.UploadCompleted -= ev);
            uploader.UploadAsync(file, signedRequest);
            return source;
        }
    }

    public class Signer
    {
        public event EventHandler<SignCompletedEventArgs> SignCompleted;

        public void SignAsync(string request)
        {
            var timer = new Timer(1000);
            timer.Elapsed += (sender, args) =>
            {
                timer.Stop();
                if (this.SignCompleted == null)
                {
                    return;
                }

                this.SignCompleted(this, new SignCompletedEventArgs { SignedRequest = request + "signed" });
            };
            timer.Start();
        }
    }

    public class Uploader
    {
        public event EventHandler<EventArgs> UploadCompleted;

        public void UploadAsync(string file, string signedRequest)
        {
            var timer = new Timer(1000);
            timer.Elapsed += (sender, args) =>
            {
                timer.Stop();
                if (this.UploadCompleted == null)
                {
                    return;
                }

                this.UploadCompleted(this, new EventArgs());
            };
            timer.Start();
        }
    }

    internal class Program
    {
        private static void Main(string[] args)
        {
            var files = new[] { "foo", "bar", "baz" };
            var uploader = new ChainUploader();
            var token = uploader.StartUploading(files).Subscribe(file =>   Console.WriteLine("Upload completed for '" + file + "'"));
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:20:39.450

为每个文件处理两步上传的基本 observable 永远不会“完成”，这会阻止链中的下一个文件启动。在调用 Concat() 之前向该 observable 添加一个 Limit(1) ，它将正常工作。

```
return files.Select(file => (from signArgs in this.Sign(file + "_request")
                             from uploadArgs in this.Upload(file, signArgs.EventArgs.SignedRequest)
                             select file).Take(1)).Concat(); 
```

# sql - LISTAGG 等价于加窗子句

> ID：10952950
> 
> 赞同：10
> 
> 时间：2012-06-08T16:50:55.833
> 
> 标签：sql, oracle, oracle11g

在 oracle 中，该函数允许我通过子句`LISTAGG`分析地使用它。`OVER (PARTITION BY column..)`但是，它不支持使用带有`ROWS`or`RANGE`关键字的窗口。

我有一个来自存储寄存器的数据集（针对问题进行了简化）。请注意，登记表的数量始终为 1 - 一项，一项交易行。

```
TranID TranLine ItemId OrderID Dollars Quantity
------ -------- ------ ------- ------- --------
1      101      23845  23      2.99    1
1      102      23845  23      2.99    1
1      103      23845  23      2.99    1
1      104      23845  23      2.99    1
1      105      23845  23      2.99    1 
```

我必须将此数据“匹配”到特殊订单系统中的表，其中项目按数量分组。请注意，系统可以在多行上具有相同的项目 ID（即使项目相同，订购的组件也可能不同）。

```
ItemId OrderID Order Line Dollars Quantity
------ ------- ---------- ------- --------
23845  23      1          8.97    3
23845  23      2          5.98    2 
```

我可以匹配此数据的*唯一*方法是通过订单 ID、项目 ID 和美元金额。

基本上我需要得到以下结果。

```
ItemId OrderID Order Line Dollars Quantity Tran ID  Tran Lines
------ ------- ---------- ------- -------- -------  ----------
23845  23      1          8.97    3        1        101;102;103
23845  23      2          5.98    2        1        104;105 
```

我并不特别关心 tran 行是否以任何方式排序，我只关心美元金额是否匹配，并且我不会“重复使用”寄存器中的一行来计算特殊订单的总数。我不需要将 tran 行分解为表格 - 这是出于报告目的，并且粒度永远不会回到注册事务行级别。

我最初的想法是，我可以使用分析函数来执行此操作，以进行“最佳匹配”，以识别与订购系统中的美元金额和数量匹配的第一组行，从而为我提供如下结果集：

```
TranID TranLine ItemId OrderID Dollars Quantity CumDollar  CumQty
------ -------- ------ ------- ------- -------- --------   ------
1      101      23845  23      2.99    1        2.99       1
1      102      23845  23      2.99    1        5.98       2
1      103      23845  23      2.99    1        8.97       3
1      104      23845  23      2.99    1        11.96      4
1      105      23845  23      2.99    1        14.95      5 
```

到现在为止还挺好。但我随后尝试将 LISTAGG 添加到我的查询中：

```
SELECT tranid, tranline, itemid, orderid, dollars, quantity, 
       SUM(dollars) OVER (partition by tranid, itemid, orderid order by tranline) cumdollar,
       SUM(quantity) OVER (partition by tranid, itemid, orderid order by tranline) cumqty
       LISTAGG (tranline) within group (order by tranid, itemid, orderid, tranline) OVER (partition by tranid, itemid, orderid)
FROM table 
```

我发现它总是返回一个完整的 agg 而不是累积的 agg：

```
TranID TranLine ItemId OrderID Dollars Quantity CumDollar  CumQty ListAgg
------ -------- ------ ------- ------- -------- --------   ------ -------
1      101      23845  23      2.99    1        2.99       1      101;102;103;104;105
1      102      23845  23      2.99    1        5.98       2      101;102;103;104;105
1      103      23845  23      2.99    1        8.97       3      101;102;103;104;105
1      104      23845  23      2.99    1        11.96      4      101;102;103;104;105
1      105      23845  23      2.99    1        14.95      5      101;102;103;104;105 
```

所以这没什么用。

如果可能的话，我更愿意在 SQL 中执行此操作。我知道我可以用游标和程序逻辑来做到这一点。

有没有办法用 LISTAGG 分析函数进行窗口化，或者可能是另一个支持这个的分析函数？

我在 11gR2 上。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T19:36:19.523

我能想到的唯一方法是使用相关子查询：

```
WITH CTE AS
(   SELECT  TranID, 
            TranLine, 
            ItemID, 
            OrderID, 
            Dollars, 
            Quantity, 
            SUM(dollars) OVER (PARTITION BY TranID, ItemID, OrderID ORDER BY TranLine) AS CumDollar, 
            SUM(Quantity) OVER (PARTITION BY TranID, ItemID, OrderID ORDER BY TranLine) AS CumQuantity
    FROM    T
)
SELECT  TranID, 
        TranLine, 
        ItemID, 
        OrderID, 
        Dollars, 
        Quantity, 
        CumDollar, 
        CumQuantity, 
        (   SELECT  LISTAGG(Tranline, ';') WITHIN GROUP(ORDER BY CumQuantity)
            FROM    CTE T2
            WHERE   T1.CumQuantity >= T2.CumQuantity
            AND     T1.ItemID = T2.ItemID
            AND     T1.OrderID = T2.OrderID
            AND     T1.TranID = T2.TranID
            GROUP BY tranid, itemid, orderid
        ) AS ListAgg
FROM    CTE T1; 
```

我意识到这并没有给出你所要求的确切输出，但希望它足以克服累积 LISTAGG 的问题并让你继续前进。

我已经设置了一个[SQL Fiddle](http://sqlfiddle.com/#!4/c7f0a/5)来演示该解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T09:59:04.730

在您的示例中，您的商店登记表包含 5 行，您的特殊订单系统表包含 2 行。您的预期结果集包含您的特殊订单系统表中的两行，并且应在“Tran Line”列中提及您的商店寄存器表的所有“tranlines”。

这意味着您需要将这 5 行聚合为 2 行。这意味着您不需要 LISTAGG 分析函数，但需要 LISTAGG 聚合函数。

您的挑战是将商店寄存器表的行连接到特殊订单系统表中的右侧行。通过计算美元和数量的运行总和，您的进展顺利。唯一缺少的步骤是定义美元和数量的范围，您可以通过这些范围将每个商店登记行分配给每个特殊订单系统行。

这是一个例子。首先定义表：

```
SQL> create table store_register_table (tranid,tranline,itemid,orderid,dollars,quantity)
  2  as
  3  select 1, 101, 23845, 23, 2.99, 1 from dual union all
  4  select 1, 102, 23845, 23, 2.99, 1 from dual union all
  5  select 1, 103, 23845, 23, 2.99, 1 from dual union all
  6  select 1, 104, 23845, 23, 2.99, 1 from dual union all
  7  select 1, 105, 23845, 23, 2.99, 1 from dual
  8  /

Table created.

SQL> create table special_order_system_table (itemid,orderid,order_line,dollars,quantity)
  2  as
  3  select 23845, 23, 1, 8.97, 3 from dual union all
  4  select 23845, 23, 2, 5.98, 2 from dual
  5  /

Table created. 
```

和查询：

```
SQL> with t as
  2  ( select tranid
  3         , tranline
  4         , itemid
  5         , orderid
  6         , sum(dollars) over (partition by itemid,orderid order by tranline) running_sum_dollars
  7         , sum(quantity) over (partition by itemid,orderid order by tranline) running_sum_quantity
  8      from store_register_table srt
  9  )
 10  , t2 as
 11  ( select itemid
 12         , orderid
 13         , order_line
 14         , dollars
 15         , quantity
 16         , sum(dollars) over (partition by itemid,orderid order by order_line) running_sum_dollars
 17         , sum(quantity) over (partition by itemid,orderid order by order_line) running_sum_quantity
 18      from special_order_system_table
 19  )
 20  , t3 as
 21  ( select itemid
 22         , orderid
 23         , order_line
 24         , dollars
 25         , quantity
 26         , 1 + lag(running_sum_dollars,1,0) over (partition by itemid,orderid order by order_line) begin_sum_dollars
 27         , running_sum_dollars end_sum_dollars
 28         , 1 + lag(running_sum_quantity,1,0) over (partition by itemid,orderid order by order_line) begin_sum_quantity
 29         , running_sum_quantity end_sum_quantity
 30      from t2
 31  )
 32  select t3.itemid "ItemID"
 33       , t3.orderid "OrderID"
 34       , t3.order_line "Order Line"
 35       , t3.dollars "Dollars"
 36       , t3.quantity "Quantity"
 37       , t.tranid "Tran ID"
 38       , listagg(t.tranline,';') within group (order by t3.itemid,t3.orderid) "Tran Lines"
 39    from t3
 40         inner join t
 41           on (   t.itemid = t3.itemid
 42              and t.orderid = t3.orderid
 43              and t.running_sum_dollars between t3.begin_sum_dollars and t3.end_sum_dollars
 44              and t.running_sum_quantity between t3.begin_sum_quantity and t3.end_sum_quantity
 45              )
 46   group by t3.itemid
 47       , t3.orderid
 48       , t3.order_line
 49       , t3.dollars
 50       , t3.quantity
 51       , t.tranid
 52  /

    ItemID    OrderID Order Line    Dollars   Quantity    Tran ID Tran Lines
---------- ---------- ---------- ---------- ---------- ---------- --------------------
     23845         23          1       8.97          3          1 101;102;103
     23845         23          2       5.98          2          1 104;105

2 rows selected. 
```

问候，
罗布。

# c - 使用英特尔 SSE 内在函数优化代码以进行矢量化

> ID：10952951
> 
> 赞同：14
> 
> 时间：2012-06-08T16:50:58.180
> 
> 标签：c, sse, sse3, sse4

这是我第一次使用 SSE 内在函数。我正在尝试使用英特尔 SSE 内在函数（最高 SSE4.2）将一段简单的代码转换为更快的版本。我似乎遇到了一些错误。

代码的标量版本是：（简单的矩阵乘法）

```
 void mm(int n, double *A, double *B, double *C)
     {
        int i,j,k;
        double tmp;

        for(i = 0; i < n; i++)
            for(j = 0; j < n; j++) {
                    tmp = 0.0;
                    for(k = 0; k < n; k++)
                            tmp += A[n*i+k] *
                                   B[n*k+j];
                    C[n*i+j] = tmp;

              }
            } 
```

这是我的版本：我已包含`#include <ia32intrin.h>`

```
 void mm_sse(int n, double *A, double *B, double *C)
      {
        int i,j,k;
        double tmp;
        __m128d a_i, b_i, c_i;

        for(i = 0; i < n; i++)
            for(j = 0; j < n; j++) {
                    tmp = 0.0;
                    for(k = 0; k < n; k+=4)
                            a_i = __mm_load_ps(&A[n*i+k]);
                            b_i = __mm_load_ps(&B[n*k+j]);
                            c_i = __mm_load_ps(&C[n*i+j]);

                            __m128d tmp1 = __mm_mul_ps(a_i,b_i);
                            __m128d tmp2 = __mm_hadd_ps(tmp1,tmp1);
                            __m128d tmp3 = __mm_add_ps(tmp2,tmp3);
                            __mm_store_ps(&C[n*i+j], tmp3);

            }
         } 
```

我哪里错了？我收到几个这样的错误：

mm_vec.c(84)：错误：“int”类型的值不能分配给“__m128d”类型的实体 a_i = __mm_load_ps(&A[n*i+k]);

这就是我的编译方式： icc -O2 mm_vec.c -o vec

有人可以帮我准确转换此代码。谢谢！

更新：

根据您的建议，我做了以下更改：

```
 void mm_sse(int n, float *A, float *B, float *C)
       {
         int i,j,k;
         float tmp;
         __m128 a_i, b_i, c_i;

         for(i = 0; i < n; i++)
            for(j = 0; j < n; j++) {
                    tmp = 0.0;
                    for(k = 0; k < n; k+=4)
                            a_i = _mm_load_ps(&A[n*i+k]);
                            b_i = _mm_load_ps(&B[n*k+j]);
                            c_i = _mm_load_ps(&C[n*i+j]);

                            __m128 tmp1 = _mm_mul_ps(a_i,b_i);
                            __m128 tmp2 = _mm_hadd_ps(tmp1,tmp1);
                            __m128 tmp3 = _mm_add_ps(tmp2,tmp3);
                            _mm_store_ps(&C[n*i+j], tmp3);

            }
        } 
```

但现在我似乎遇到了分段错误。我知道这可能是因为我没有正确访问数组 A、B、C 的数组下标。我对此很陌生，不知道如何进行。

请帮助我确定处理此代码的正确方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T17:07:25.450

您看到的错误是因为函数名称中有太多下划线，例如：

```
__mm_mul_ps 
```

应该：

```
_mm_mul_ps // Just one underscore up front 
```

所以 C 编译器假设它们返回`int`，因为它没有看到声明。

除此之外，尽管还有其他问题-您似乎正在混合对同一指令的双浮点变体和单浮点变体的调用。

例如，您有：

> ```
> __m128d a_i, b_i, c_i; 
> ```

但你打电话：

> ```
> __mm_load_ps(&A[n*i+k]); 
> ```

它返回一个`__m128`not a `__m128d`- 你想调用：

```
_mm_load_pd 
```

反而。如果您希望他们处理成对的双打，其他说明也是如此。

* * *

如果您在 SSE 代码中看到无法解释的分段错误，我倾向于猜测您遇到了内存对齐问题 - 传递给 SSE 内在函数的指针（主要是¹）需要 16 字节对齐。您可以在代码中[使用简单的断言来检查这一点](https://stackoverflow.com/a/7146898/168175)，或者在调试器中检查它（如果指针正确对齐，您希望指针的最后一位为 0）。

如果它没有正确对齐，您需要确保它是正确的。对于没有分配的东西`new`/`malloc()`您可以使用编译器扩展来执行此操作（例如[使用 gcc](http://gcc.gnu.org/onlinedocs/gcc/Variable-Attributes.html)）：

```
float a[16] __attribute__ ((aligned (16))); 
```

前提是您的 gcc 版本具有足够大的最大对齐以支持这一点以及有关堆栈对齐的其他一些注意事项。对于动态分配的存储，您需要使用特定于平台的扩展，例如[`posix_memalign`](http://pubs.opengroup.org/onlinepubs/009604499/functions/posix_memalign.html)分配合适的存储：

```
float *a=NULL;
posix_memalign(&a, __alignof__(__m128), sizeof(float)*16); 
```

（我认为使用 C++11 可能会有更好、更便携的方法，但我还不能 100% 确定这一点）。

¹有一些指令允许您执行未对齐的加载和存储，但与对齐的加载相比，它们非常慢，如果可能的话，值得避免。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T19:31:55.347

您需要确保您的加载和存储始终访问 16 字节对齐的地址。或者，如果由于某种原因您不能保证这一点，那么使用`_mm_loadu_ps`/`_mm_storeu_ps`代替`_mm_load_ps`/ `_mm_store_ps`- 这会降低效率，但不会在未对齐的地址上崩溃。

# javascript - 为 AJAX 序列化表单值

> ID：10952953
> 
> 赞同：0
> 
> 时间：2012-06-08T16:51:08.517
> 
> 标签：javascript, ajax, forms, wordpress, serialization

通过 WordPress，我构建了一个带有成功 AJAX 响应的表单。但是数据库中的字段是**空**的！我猜这是因为我没有序列化我的值：

```
// JavaScript Document
jQuery(document).ready(function($){
    jQuery('#newFeedbackForm').submit(function(){
        var topic = $('#topic').val();
        var name = $('#name').val();
        var email = $('#email').val();
        var no_results_feedback = $('#no_results_feedback').val();

        var post_data = {
            action: 'addFeedback',
            topic: topic,
            name: name,
            email: email,
            no_results_feedback: no_results_feedback
        };

        $.post(av_feedback_vars.ajaxurl, post_data, function(response){
                        if(response == 'success'){
                            $('#feedback').text('Thank you for your comment.');
                        }else{
                            alert(av_feedback_vars.error_message);
                        }
        });
        return false;
    });
}); 
```

在这种情况下我将如何使用序列化？感谢您帮助菜鸟（第一次在这里使用 ajax）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:53:35.723

正如您在[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)上看到的那样，数据不必被序列化。jQuery 将正确格式化它。

你确定所有的表单数据都在那里吗？您应该检查一个工作的、非 ajax 请求并查看发送了哪些发布数据以找出使用 ajax 发送的内容（然后也检查该请求）。

Chrome 开发工具和 Firebug 非常适合“请求检查”。显然 IE 开发工具也是如此，但我不知道 †</p>

# java - 单元测试时如何获取新对象的句柄？

> ID：10952957
> 
> 赞同：0
> 
> 时间：2012-06-08T16:51:43.617
> 
> 标签：java

我将如何测试在 SomeClass 中动态创建的这个 ValueObject 而不会使用 PowerMock 等将它存根？

```
class ValueOBject {
    private String x, y;
    getters
    setters
}
class SomeClass {
    public void  foo () {
       ValueObject vo = new ValueObject();
       vo.setX("some string 1");
       vo.setY("some string 2");

       faa(vo);
    }

    public void faa(ValueObject vo) {
        // do some more logic on vo here
    }
}

class SomeClassTest extends TestCase{
   public void testFoo() {
       SomeClass s = new SomeClass();
       s.foo();
       // HOW TO DO THIS?
       verify(faa(VAlueObject that is created during foo's run));
   }
} 
```

我不想使用 PowerMockito 或类似的库来返回 MOCKED 对象！而是在方法 foo() 执行期间创建的 REAL 对象：

```
//    DONT WANT A MOCKED OBJECT
//    @Mock
//    private ValueOBject vo;
//     henNew(GetEmailInformation.class).withNoArguments().thenReturn(getEmailInformation); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:42:52.263

所以看起来你想要断言在中创建`foo()`并传递给的 ValueObject `faa(vo)`？

创建单元测试实例化预期的 ValueObject 并将其传递给`faa(vo)`. 然后将 this 的结果与您刚刚调用时发生的结果进行比较`foo()`。

例如：

```
// in your unit test:
ValueObject testVo = new ValueObject();
// set values as needed
// testVo should represent what you expect the ValueObject instantiated by foo to 
// hold *before* it gets passed to faa

faa(testVo);
// assertions against results of faa method

foo();
// assertions *comparing* the results of foo with the results of your manual faa 
```

因此，例如，如果我希望`foo`创建一个 X=1 和 Y=1 的 ValueObject，然后`faa`对它们施展魔法，使 ValueObject 的最终结果是 X=-1 和 Y=2，那么您的单元测试将看起来像像这样：

```
ValueObject testVo = new ValueObject();
testVo.setX(1);
testVo.setY(1);

faa(testVo);
// assertions using your testing library of choice to verify getX() returns -1 and
// getY() returns 2

foo();
// assertions that the end values after foo()'s faa call are -1 and 2 respectively 
```

现在在上面的虚拟示例中，`foo`和`faa`都是 void 方法，因此没有返回值。我假设它`faa`实际上*做*了一些可测试的事情——例如。设置字段、更改值等。

在您对其他答案留下的一些评论中，您注意到您涉及一些私有和/或受保护的字段和方法。如果是这种情况，您将需要研究[Java 反射](http://java.sun.com/developer/technicalArticles/ALT/Reflection/)以了解如何检索这些值。

`foo()`但是对于在传递给之前专门删除其中实例化的 ValueObject `faa(vo)`，这是不可能的。正如我上面所描述的，最好的办法是测试您对*期望*在其中创建的 ValueObject 的行为的期望`foo()`，并将传递给它的结果`faa(vo)`与实际发生的结果进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:04:20.767

ValueObject 是在内部创建的，因此它只能依赖于对象状态。你不需要测试内部，你只需要测试你所做的调用的副作用。

在这种情况下，您不需要测试 foo 因为您知道 foo 做了什么，它只是 faa 的包装器。因此，您需要测试 faa 是否存在由全局状态和 ValueObject 输入引起的操作和副作用。

如果您想测试 foo() 是否符合您的预期，您必须测试 foo() 导致的副作用是否与 faa(expectedObject) 具有相同。

换句话说：如果 foo 和 faa 是公共的，并且公共接口说 foo 是具有固定参数的 faa 的包装器，则您需要测试 foo 是否与 faa 对您期望的固定参数所做的完全一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T16:56:29.757

这告诉您该设计具有紧密耦合，因此可能会将对象注入到方法中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T17:03:54.763

您可能需要考虑`faa()`使用 in进行测试`foo()`。从 OOP 的角度来看，我宁愿调用者`foo()`永远不需要知道`faa()`甚至存在。`faa()`需要公开吗？

# c++ - 如何使用我的 Qt 应用程序发送传真？

> ID：10952963
> 
> 赞同：5
> 
> 时间：2012-06-08T16:52:18.653
> 
> 标签：c++, windows, api, fax

我有一个需要能够发送传真的 Qt 应用程序。我想知道是否有任何我可以使用的传真库。我还没有找到一个明显的解决方案，所以我很感激你的帮助。

该应用程序必须在 windows xp / windows 7 上运行。

如果我不清楚/您需要更多信息，请告诉我。

**编辑**

会有传真机。我不确定传真驱动程序是如何工作的，但该应用程序应该支持每台传真机。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-14T23:13:06.843

Windows 具有传真服务扩展 COM API

完成代码示例。

配置 [http://msdn.microsoft.com/en-us/library/windows/desktop/ms692969(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms692969(v=vs.85).aspx)

发送 [http://msdn.microsoft.com/en-us/library/windows/desktop/ms693482(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms693482(v=vs.85).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T18:04:21.917

我会确保您安装的传真机有一个打印机驱动程序，可以让您打印到它。然后使用 QT 打印 API：http: [//qt-project.org/doc/qt-5.0/printing.html](http://qt-project.org/doc/qt-5.0/printing.html)

我会先尝试使用打印对话框，然后手动选择传真机。

然后检查[QPrinter中的所有数据](http://qt-project.org/doc/qt-5.0/qprinter.html)

看哪个有传真号码。我希望它可能是[OutPutFileName](http://qt-project.org/doc/qt-5.0/qprinter.html#outputFileName)。

* * *

另一种方法可能是使用 Microsoft Scripting 发送传真，包裹在[QtActiveX 模块中](http://doc-snapshot.qt-project.org/5.0/qaxcontainer-module.html)

* * *

最后我用谷歌搜索了这个：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms693482 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms693482(v=vs.85).aspx)

* * *

抱歉，这不是一个完整的答案。我希望它可以为您指明正确的方向。

# java - getter 和 setter 的 Eclipse 模板变量

> ID：10952968
> 
> 赞同：4
> 
> 时间：2012-06-08T16:52:59.573
> 
> 标签：java, eclipse, casting, getter, eclipse-templates

我有一个小问题。我正在尝试为 Eclipse 中的变量创建 getter 模板。我想要在我的 getter 方法中做的是检查变量是否为空。如果它是空的，我想给它赋值。但是问题是我需要将方法的返回值转换为 getter 返回类型。我无法管理它。这是我想要的代码：

```
Integer someInt;
Double someDoub;
Long someLong;

public Integer getSomeInt(){
    if(someInt == null) someInt = (Integer) new Generator().evaluate();
    return someInt;
}

public Double getSomeDoub(){
    if(someDoub == null) someDoub = (Double) new Generator().evaluate();
    return someDoub;
} 
```

这是我要生成的代码。这是我作为模板输入的内容：

```
if( ${field} == null){
    ${field} = ( ${return_type} ) new Generator().evaluate();
}
return ${field}; 
```

我一输入这个。Eclipse 说 return_type 是未知的。请帮忙。

非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:31:34.650

这将完成你的工作：

```
 if( ${field} == null){
        ${field} =   ${field}.getClass().cast( new Generator().evaluate());
    }
    return ${field}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:35:04.963

Eclipse 没有提供在 getter/setter 代码模板（即“生成 Getter 和 Setter”工具使用的模板）中执行此操作的方法。“插入变量”列表中的变量是唯一受支持的变量。

`${return_type}`仅可用于常规模板（即，您可以使用代码完成热键调用的类型）。

作为一种可能的解决方法，您可以创建一个通用的静态工厂方法来生成默认对象，从而避免强制转换：

```
public class MyBean {
    Integer someInt;
    Double someDoub;

    public Integer getSomeInt(){
        if (someInt == null) someInt = GeneratorUtil.createAndEvaluate();
        return someInt;
    }

    public Double getSomeDoub(){
        if (someDoub == null) someDoub = GeneratorUtil().createAndEvaluate();
        return someDoub;
    }
}

public class GeneratorUtil {
    @SuppressWarnings("unchecked")
    public static <T> T createAndEvaluate() {
        return (T) new Generator().evaluate();
    }
} 
```

您的`Generator`班级是否使用某种类型的反射来确定要生成哪种类型的对象？

# c# - MvcSiteMapProvider 不更新站点地图标题

> ID：10952970
> 
> 赞同：1
> 
> 时间：2012-06-08T16:53:03.400
> 
> 标签：c#, asp.net-mvc-3, mvcsitemapprovider

我目前正在使用 MVCSiteMapProvider 为我的网站生成面包屑。我通过在 SiteMapTitle 属性中传递 viewData 值来创建站点地图标题。当我第一次访问链接时，它会根据需要创建面包屑，但是当我尝试重新访问我网站上的任何其他链接时，它会显示标题的 Viewdata 的第一次访问值。代码看起来像这样

```
[SiteMapPreserveRouteData] 
    [SiteMapTitle("atlas")]
    public ActionResult Index(string id ,string Atlas)
    {
        if (!string.IsNullOrEmpty(Atlas))
        {
            ViewData["atlas"] = Atlas;
        }
        Taxonomy taxonomy = db.GetTaxonomy(new Guid(ConfigurationManager.AppSettings["TherapyId"]));

        var atlasList = taxonomy.GetTerms(id, 2);

        return View(atlasList);
    } 
```

站点地图看起来像这样

```
<mvcSiteMapNode title="Home" controller="Home" action="Index" changeFrequency="Always" updatePriority="Normal" >

<mvcSiteMapNode title="Therapy"  controller="Therapy" action="Index"  >
  <mvcSiteMapNode title=""  controller="Atlas" action="Index" >
    <mvcSiteMapNode title=""  controller="Specialties" action="Index">
      <mvcSiteMapNode title=""  controller="Specialties" action="ViewImage"  />      
    </mvcSiteMapNode>        
  </mvcSiteMapNode>
</mvcSiteMapNode> 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T21:22:54.457

这可能是因为提供者实现了缓存。您可以尝试将 cacheduration（在 web.config 中）设置为 0，以禁用缓存，但这会对性能产生很大影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T09:06:42.560

您应该升级到 MvcSiteMapProvider v4。这是一个缓存错误，现已修复。此外，您不应使用 SiteMapPreserveRouteDataAttribute，因为它现在已被弃用。为了保留路由值，您应该在 ISiteMapNode 对象上使用preservedRouteParameters。

有关如何使用preservedRouteParameters 的示例，请参阅标题为[如何使MvcSiteMapProvider 记住用户位置](http://www.shiningtreasures.com/post/2013/09/02/how-to-make-mvcsitemapprovider-remember-a-user-position)的博客文章。

# sql - 在 SQL Server 中，创建排除部分重复的联合查询的最佳方法是什么

> ID：10952971
> 
> 赞同：0
> 
> 时间：2012-06-08T16:53:03.880
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2008-r2

我有两个具有相同架构的表。我想创建所有字段的联合，但我想根据某些字段的相等性排除重复项，但不是所有字段。在 SQL Server (2008r2) 中实现这一目标的最佳方法是什么？

[我看到了这种答案](https://stackoverflow.com/questions/3407031/t-sql-not-in-with-multiple-columns)，但是有更好的选择吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:07:37.517

您也许可以使用 RANK() 函数来做到这一点，尽管正如@Tim 所说，它只会丢弃分区中未使用的所有字段中的任何差异。下面，如果您有六行共有 B 和 C，那么无论 A 和 D 列中的值如何，它们中只有一个会存在：

```
SELECT *
FROM (
    SELECT A, B, C, D,
        RANK() OVER(PARTITION BY B, C ORDER BY B, C) AS MYRANK    
    FROM (
        SELECT A, B, C, D
        FROM TABLE_A
        UNION
        SELECT A, B, C, D
        FROM TABLE_B
    ) T1
WHERE T1.MYRANK = 1 
```

# python - 如何从不同的类中导入变量

> ID：10952973
> 
> 赞同：0
> 
> 时间：2012-06-08T16:53:32.927
> 
> 标签：python

我有一个类的实例，我在名为“Greek_gods”的模块中名为“zeus”的类中将值设置为“self.world”。我在模块名称“世界”中有另一个类名称“世界”。

我如何告诉 zeus 去“世界”并获取实例 self.world？

```
#module named World
class World():

    def __init__(self):
        self.world = Atlas()

#module named Greek_gods
class zeus():

    def __init__(self) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:02:05.680

You can't, because you cannot know the world instance to be added in `Zeus` at the moment you create Zeus.

However, you can pass an instance of `World` for `Zeus`. There are various ways to do it:

*   Pass `World` as a parameter to the constructor:

    ```
    #module named greek_gods
    class Zeus(object):
        def __init__(self, world):
            self.world = Atlas()

    world = World()
    zeus = Zeus(world) 
    ```

*   You can make `World` to create `Zeus`:

    ```
    #module named World
    class World(object):
        def __init__(self, world):
            self.world = Atlas()
        def create_zeus(self):
            zeus = Zeus()      # It would be better to pass it as a constructor 
            zeus.world = world # parameter but let us leave it simple

     # Using your classes:
     world = World()
     zeus = World.create_zeus() 
    ```

*   You can create *one* special instance of `World` in the world module:

    ```
    #module named World
    class World(object):
        def __init__(self):
            self.world = Atlas()
    greek_world = World()

    #module named Greek_gods
    import world
    class Zeus(object):
        def __init__(self):
            self.world = world.greek_world 
    ```

I would recommend to use the second solution; after that, the first one. The third one, however, can be very useful, too, specially if, *by default*, you need just one world in your application (the so-called [singletons](http://en.wikipedia.org/wiki/Singleton_pattern)).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:00:40.020

```
# module World
class World(object):
    def __init__(self, name):
        self.name = name
        self.gods_here = set()

    def leave(self, god):
        self.gods_here.remove(god)
        return True

    def enter(self, god):
        self.gods_here.add(god)
        return True

# module Greek_Gods
class God(object):
    def __init__(self, name, world=None):
        self.name = name
        self.world = None
        self.go_to_world(world)

    def go_to_world(self, world):
        if self.world is not None:
            self.world.leave(self)
        if world is not None:
            if world.enter(self):
                self.world = world
        else:
            self.world = None

earth = World("Earth")
mars = World("Mars")

zeus = God("Zeus", mars)
zeus.go_to_world(earth) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T17:02:29.147

It does exactly what you asked for - it goes to `World` module and takes `World`'s instance's `world` attribute:

```
#module named World
class World():
    def __init__(self):
        self.world = Atlas()

#module named Greek_gods
from World import World

class zeus():    
    def __init__(self)
        self.world = World().world 
```

Although it may be done cleaner, if you could tell us what is the reason to do so. You can even shorten the code, if you assign `Atlas()` to the class'es property `world`. It will be shorter to reference it and cleaner, but will work almost the same.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T17:02:21.007

It looks like you want to use a single instance of a `World` class across several modules, which you can do easily by creating an instance of the `World` class at the top level of your `World` module, like this:

```
#module named World
class World():
    def __init__(self):
        self.world = Atlas()

world = World() 
```

Now when you `import World` in any of your other modules, you can use `World.world` as the only instance of your `World` class. This gets a little confusing, because `World.world.world` is now the instance of `Atlas` that the `World` class creates, I would strongly suggest renaming something there.

Here is how your `Greek_gods` module might look:

```
#module named Greek_gods
import World

class zeus():
    world = World.world.world 
```

Note that instead of putting `world` into the initializer for the `zeus` class, I made it a class attribute. This is because it looks like you want to share this `Atlas` instance (which for some reason is called `world`) among all `zeus` instances. For an example of how this would look, check out the following code (which you could put into your `Greek_gods` module to test):

```
z1 = zeus()
z2 = zeus()
assert World.world.world is z1.world is z2.world 
```

# asp.net-mvc - 如何在复杂的 Web 应用程序中支持用户编辑的内容？

> ID：10952976
> 
> 赞同：3
> 
> 时间：2012-06-08T16:53:57.417
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

我正在构建一个网站（使用 ASP.NET、MVC 3、Razor）并且我没有使用现成的 CMS。这是因为我评估了很多现有的 CMS，发现它们都具有巨大的学习曲线，大量我不需要的功能，它们迫使您进入面向页面的模型。“面向页面的模型”是指您可以指定一般的页面布局和样式表，但用户可以编辑的对象是整个页面，例如显示在中央面板中，也许您可​​以自定义侧边栏也是如此。

但是这个网站非常以设计为中心，需要比这更加流畅和细化。“以设计为中心”是指该网站是由一位平面设计师在 Photoshop 中构建的，并且大量使用图像和复杂的样式将设计映射到 HTML/css/js。此外，网站上的每个页面都完全不同。还有诸如手风琴面板之类的 UI 元素，我们需要用户能够在其中编辑每个面板的内容，但肯定不是支持手风琴的 jQuery+HTML。用户是主题专家，但非常非技术性。

因此，我将有一个包含许多复杂布局和样式的页面，我不希望用户访问这些页面，但其中会有一个`div`包含文本，我希望用户能够编辑。

我怎样才能最好地做到这一点？

到目前为止，我通过将片段（HTML 的小单元）存储在外部文件中来实现这一点，用户可以对其进行编辑。在运行模式下，这些内容被加载并内联显示（如果您已登录并具有权限，则带有一个小的“编辑此内容”按钮）。如果单击“编辑”按钮，您会看到一个所见即所得的小编辑屏幕，您可以在其中编辑和保存更改。所以我可以控制所有乱七八糟的东西，并为用户可编辑的内容放置小占位符。但这对我来说并不完全简单，我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-30T07:28:47.640

并不是要解决这个问题，但这似乎是与我目前正在研究的最相关的问题。我最近构建了与您上面描述的类似的东西，但是我从数据库而不是静态文件中提取数据。对于控制器中的每个页面（如 /about 或 /contact），我以 Json 字符串键/值对的形式从数据库中提取该页面的数据。Key 是占位符标签，Value 是.. 值。反序列化后，我只需填充一个列表并将其分配给 ViewBag，然后在 CSHTML 中我 ViewBag.List.Keyname 来抓取文本。

我有一个小的管理控制面板，它允许我修改数据库中的文本。不过，像您一样进行小悬停是个好主意！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T13:23:44.720

好吧，我坚持我原来的计划：

> 到目前为止，我通过将片段（HTML 的小单元）存储在外部文件中来实现这一点，用户可以对其进行编辑。在运行模式下，这些内容被加载并内联显示（如果您已登录并具有权限，则带有一个小的“编辑此内容”按钮）。如果单击“编辑”按钮，您会看到一个所见即所得的小编辑屏幕，您可以在其中编辑和保存更改。所以我可以控制所有乱七八糟的东西，并为用户可编辑的内容放置小占位符。但这对我来说并不完全简单，我想知道是否有更好的方法。

它现在工作得相当好。

# facebook - 来自 Facebook 个人资料的访客位置

> ID：10952977
> 
> 赞同：0
> 
> 时间：2012-06-08T16:54:06.697
> 
> 标签：facebook, geolocation

我想通过以下方式知道我网页的访问者来自哪个城市：

```
 1\. If the visitor has a public Facebook profile,
       then return her Facebook location.
    2\. Otherwise, return her location based on the IP address. 
```

我知道该怎么做（2）。但是有没有办法做（1）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:09:15.073

没有他们授权您的应用程序，不。

否则，`/USER_ID`API 中的基本调用将返回其语言环境

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T22:15:01.307

您可以使用 MaxMind API 根据用户的 IP [http://www.maxmind.com/app/ip-location获取用户的位置](http://www.maxmind.com/app/ip-location)

要从他的个人资料中获取用户的位置，您可以使用 Graph API [https://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T17:16:18.740

只需质疑 user.location 的 Graph API – [https://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/)

# c# - 在 mvc3 中将值从动作转发到视图到动作

> ID：10952980
> 
> 赞同：0
> 
> 时间：2012-06-08T16:54:15.393
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, c#-4.0

我有一个场景，我希望将一个值“选项卡”从一个操作带到它的视图，然后从视图到另一个操作。我已将选项卡值放在要在视图中访问的 viewdata 中。请建议我如何在视图中访问此“选项卡”值，然后将其转发到“身份验证”操作。

我正在开发 mvc3 2010。下面是我的代码：

```
 public ActionResult Index(string tab)
    {
        try
        {
            ViewData["tab"] = tab;
            return View("Authorize");
        }
        catch (Exception ex)
        {
            return View("EmptySearch");
        }
    }

@using (Html.BeginForm("Authenticate", "Authorization"))
{
<div>
    <fieldset>
        <legend>User Information</legend>

        <div class="editor-label">
            @Html.Label("Password")

            @Html.TextBox("password")
            @Html.ValidationMessageFor(m => m.password)
        </div>
        <p>
            <input type="submit" value="Submit" />
        </p>

    </fieldset>
</div>
}

    [AcceptVerbs("POST")]
    public ActionResult Authenticate(FormCollection collection)
    {
        try
        {
            string password = collection["password"];

            password = password.Trim();

            //ViewData["BatchNumber"] = password;

            //dynamicsContext.CommandTimeout = 180;

            //List<BatchMember> batchMemberList =
              //  Queries.compiledBatchQuery(dynamicsContext, password).ToList<BatchMember>();

            return RedirectToAction("Index", "GreatPlains");
        }
        catch (Exception ex)
        {
            return View("EmptySearch");
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T17:01:33.307

将其保存在表单中的`Hidden`字段中，它将在您的 Post 操作方法中可用

```
@using (Html.BeginForm("Authenticate", "Authorization"))
{
<div>
    <fieldset>
        <legend>User Information</legend>

        <div class="editor-label">
            @Html.Label("Password")
            @Html.TextBox("password")
            @Html.ValidationMessageFor(m => m.password)
        </div>
        <p>
            @Html.Hidden("Tab", ViewData["tab"])
            <input type="submit" value="Submit" />
        </p>

    </fieldset>
</div>
} 
```

在你的`HttpPOST`Action 方法中

```
[HttpPost]
public ActionResult Authenticate(FormCollection collection)
{
  var tabValue=collection["Tab"]
  //remaining code
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:56:35.847

您可以使用 TempData、Session 或 cookie，也可以将选项卡的值添加为表单中的隐藏字段并继续使用 ViewData。

# html - GWT HTML 报告打印

> ID：10952989
> 
> 赞同：0
> 
> 时间：2012-06-08T16:55:18.657
> 
> 标签：html, gwt, printing, report, extjs

我目前正在开发一个需要打印报告的 GWT 应用程序。用户可以从屏幕上选择报告参数，单击打印后，我们希望在生成文件时显示该文件。目前我们有生成 HTML 并将其写入文件的服务器端代码。当用户单击打印时，将进行 RPC 将报告参数传递给服务器并开始报告。在报告开始获取报告的 URL 后进行第二次 RPC。从这里开始，我们将创建一个 Frame 并将 URL 设置为第二个 RPC 检索到的 URL。

我遇到的问题是，当调用 setUrl 时，它只显示调用时文件中包含的 HTML。仅刷新包含 HTML 报告的框架的最佳方法是什么？看起来对 setUrl 的后续调用每次都传入相同的 Url 可以解决问题，但它实际上似乎不包含自上次调用以来编写的附加内容。它还每次将垂直滚动条的位置重置回条的顶部，这是我想阻止的其他事情。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:20:49.157

我认为最好从 GWT 请求 HTML 块并在它们到达时呈现它们。使用 ajax 而不是批量刷新，可以更好地使用滚动条，消除闪烁，解决缓存问题，还可以让您添加一些反馈，如进度条、估计剩余时间等。

这需要更多的基础设施，但您建议的解决方案似乎不太适合该任务。

# objective-c - 为什么这段代码会给出 EXC_BAD_ACCESS（使用 IMP）

> ID：10952996
> 
> 赞同：7
> 
> 时间：2012-06-08T16:56:05.107
> 
> 标签：objective-c, objective-c++, objective-c-runtime

这段代码给了我 EXC_BAD_ACCESS，为什么？

```
NSMutableDictionary  *d = [[NSMutableDictionary alloc] init];
IMP imp= [d methodForSelector:@selector(setObject:forKey:) ];
imp(d,  @selector( setObject:forKey:), @"obj", @"key"); 
```

我刚开始使用 IMP，首先尝试.. 没有运气。不知道为什么我会收到错误，也..过去，当我收到 EXC_BAD_ACCESS 时，在控制台上打印了消息，这次错误行被突出显示。

一些注意事项：ARC已启用，XCode 4.3.2，项目使用Objective-C++作为de默认语言/编译器，此代码在项目的最开始

多谢你们

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-08T17:26:45.373

您需要正确转换函数指针，否则 ARC 不知道它应该做什么。IMP 是一个通用函数指针，它接受一个 id、一个选择器和可变数量的其他未定义参数并返回一个 id。您尝试调用的方法实现需要一个 id，一个选择器后跟两个 id 参数，并且返回类型为 void。您可以通过更改为以下代码来修复它：

```
NSMutableDictionary* dict = [[NSMutableDictionary alloc] init];
void (*imp)(id, SEL, id, id) = (void(*)(id,SEL,id,id))[dict methodForSelector:@selector(setObject:forKey:)];
if( imp ) imp(dict, @selector(setObject:forKey:), @"obj", @"key"); 
```

在取消引用之前，您应该始终检查您是否确实获得了函数指针，因为这也会崩溃。上面的代码甚至可以在 ARC 环境中工作。此外，即使您不使用 ARC，您也应该始终将函数指针转换为实际原型而不是 IMP。你永远不应该使用 IMP。其他会导致主要问题的地方是该方法是否返回一个结构或该方法是否采用浮点参数等。

好习惯：如果你发现函数指针语法不和谐，总是转换你的函数指针或为它们制作 typedef。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:36:24.340

问题是 IMP 的返回类型为“id”，ARC 将尝试对其进行管理。您需要将函数指针转换为具有 void 的返回类型（与您正在调用的方法一致）：

```
 NSMutableDictionary  *d = [[NSMutableDictionary alloc] init];
    IMP imp= [d methodForSelector: @selector(setObject:forKey:)];
    void (*func)(__strong id,SEL,...) = (void (*)(__strong id, SEL, ...))imp;
    func( d,  @selector(setObject:forKey:), @"obj", @"key" ); 
```

# xquery - 通过 XQuery 删除节点但保持内部值不变

> ID：10952999
> 
> 赞同：1
> 
> 时间：2012-06-08T16:56:16.630
> 
> 标签：xquery, exist-db

我有一个 content.xml 建模如下

```
<root>
  <childnode>
    Some text here
  </childnode>
</root> 
```

我正在尝试删除`<childnode>`并仅使用它的值更新 content.xml，因此输出看起来像

```
<root>
  Some Text here
</root> 
```

我编写了一个函数来执行此操作，但每当我运行它时，它都会给我一个错误，如“意外令牌：修改”。我正在考虑一种不使用 functx 函数来完成此任务的方法。

```
xquery version "1.0";    

declare namespace request="http://exist-db.org/xquery/request";  
declare namespace file="http://exist-db.org/xquery/file";  
declare namespace system="http://exist-db.org/xquery/system";
declare namespace util="http://exist-db.org/xquery/util";
declare namespace response="http://exist-db.org/xquery/response";

declare function local:contentUpdate()  {
    let $root := collection('/lib/repository/content')//root/childNode
    let $rmChild := for $child in $root
    modify
    (
    return rename node $child as ''
    )
};

local:updateTitle() 
```

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T15:21:13.500

eXist-db 的 XQuery 更新语法记录在[http://exist-db.org/exist/update_ext.xml](http://exist-db.org/exist/update_ext.xml)中。请注意，此语法早于[XQuery Update Facility 1.0](http://www.w3.org/TR/xquery-update-10/)的发布，因此语法是不同的，并且对于 eXist-db 来说仍然是唯一的。

在 eXist-db 中做你想做的事情的方法如下：

```
xquery version "1.0";

declare function local:contentUpdate()  {
    let $root := doc('/db/lib/repository/content/content.xml')/root
    return
        update value $root with $root/string()
};

local:contentUpdate() 
```

与您的原始代码相比，主要更改是：

1.  为您的更新插入了 eXist-db 语法
2.  在您的集合名称前添加 ' `/db`'，因为 /db 是 eXist-db 中数据库的根；用`collection()`调用替换了`doc()`调用，因为您声明您正在对单个文件 content.xml 进行操作
3.  改为`//root`，`/root`因为“root”是根元素，所以`//`(descendant-or-self) 轴是无关的
4.  替换`updateTitle()`为函数的实际名称 contentUpdate
5.  删除了无关的命名空间声明

有关我为什么使用的更多信息`$root/string()`，请参阅[http://community.marklogic.com/blog/text-is-a-code-smell](http://community.marklogic.com/blog/text-is-a-code-smell)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:54:32.783

您的查询存在多个问题：

1.  更新函数必须声明为`updating`.
2.  您正在调用另一个函数而不是您定义的（可能您没有注意到，因为仍然存在语法错误）。
3.  `Rename node`期望某个元素（或处理指令、属性）作为目标，不允许使用空字符串。
4.  在将代码定义为 XQuery 1.0 时，至少 BaseX 不允许更新语句。也许存在不关心这个，如果你需要知道的话，尝试添加它。

您不想重命名，而是将所有`<childnode />`s 替换为其内容，使用`replace node`.

这段代码解决了所有这些问题：

```
declare updating function local:contentUpdate()  {
  let $root := collection('/lib/repository/content')
  return 
    for $i in $root//childnode
    return
      replace node $i with $i/data()
};

local:contentUpdate() 
```