# StackOverflow 问答 10983000-10983999

# matlab - fft/ifft：信号的采样频率和长度

> ID：10983000
> 
> 赞同：5
> 
> 时间：2012-06-11T15:20:22.070
> 
> 标签：matlab, signal-processing, fft, ifft

这部分取自 Matlab fft 文档：

```
Fs = 30;                    % Sampling frequency
T = 1/Fs;                   % Sample time
L = 130;                    % Length of signal
t = (0:L-1)*T;              % Time vector

x = sin(2*pi*1*t);          % 1 Hz sinus

plot(real(ifft(abs(fft(x))))); % fft then ifft

% Fs = 30, L = 60 / 90 / 120 ... : ok
% Fs = 20, L = 60 / 80 / 100 ... : ok
% Fs = 30, L = 50 / 70 / 80 ... : not ok 
```

在我看来，只要信号的长度是采样频率的倍数，正弦曲线就会被正确重建（除了一些偏移），例如这里`Fs = 30, L = 60`：

![在此处输入图像描述](../Images/62c8ad8dc0a0c85834ba66347e2c6a8d.png)

但是，如果例如`Fs = 30, L = 80`（不是倍数），结果看起来很奇怪：

![在此处输入图像描述](../Images/a67cfae0439a1930a31eb529866071e5.png)

这种行为正确吗？为什么会发生这种情况，我该如何避免这种情况？只是扔掉信号的一部分，使长度“适合”采样频率？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-11T15:22:37.623

当您在 ifft 中使用 abs(fft()) 时，您仅使用信号的幅度并丢弃所需的相位信息。

使用整个信号（删除 abs）：

```
plot(real(ifft(fft(x)))); % fft then ifft 
```

# javascript - 无法在 Ajax Truclient 中使用 window.setTimeout

> ID：10983002
> 
> 赞同：0
> 
> 时间：2012-06-11T15:20:24.363
> 
> 标签：javascript, firefox-addon, xpcom, firefox3.6, loadrunner

我想使用 window.setTimeout 每 0.1 秒在 TruClient (Firefox) 中运行一个函数：

```
function foobar(delay_accumulator){
    if(delay_accumulator >= 100)//10 seconds
        return;

    //do something
    window.setTimeout(function() { foobar(delay_accumulator+1); }, 100);
}
foobar(0); 
```

但是，该步骤失败，出现以下错误：

> ** 2：评估 JavaScript 代码函数 foobar(delay_accumula...OBAR"); foobar(0); ** 失败 - 发生异常：NS_ERROR_NOT_AVAILABLE：组件返回失败代码：0x80040111 (NS_ERROR_NOT_AVAILABLE) [nsIDOMJSWindow.setTimeout]

为什么 setTimeout 不可用？我可以使用其他解决方案吗？

编辑：Truclient 在工具箱中有一个“等待”功能，但它的最小粒度为 1 秒，而不是 setTimeout 的毫秒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T00:29:47.507

试试 nsiTimer：[https ://developer.mozilla.org/en/nsITimer](https://developer.mozilla.org/en/nsITimer)

# objective-c - UIButton 选择器错误

> ID：10983005
> 
> 赞同：0
> 
> 时间：2012-06-11T15:20:31.700
> 
> 标签：objective-c, ios, cocoa-touch

我正在向 UIScrollview 添加四到五个视图。

我正在运行时动态创建该视图。

所有这些视图都包含一个按钮。

```
{

    UIButton *button=[UIButton buttonWithType:UIButtonTypeCustom];

    [button addTarget:self action:@selector(category_selected:) forControlEvents:UIControlEventTouchUpInside];

} 
```

视图已成功添加，但是当我单击按钮时，会显示“*发送到实例 0x657e850 的无法识别的选择器*”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T15:28:30.247

您需要`category_selected:`在控制器中实现该方法。签名应如下所示：

```
- (void)category_selected:(UIButton*)sender
{
    // The sender is the button that was pressed.
} 
```

当您像这样设置按钮时：

```
[button addTarget:self action:@selector(category_selected:) forControlEvents:UIControlEventTouchUpInside]; 
```

我假设您从控制器调用它，控制器也是如此`self`，这是必须`category_selected:`实现的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:24:17.520

您是否在您的班级中定义了方法 category_selected:

[按钮 addTarget:self action:@selector(category_selected:) forControlEvents:UIControlEventTouchUpInside];

category_selected：方法应该在您设置上述操作的类中定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T05:36:40.320

我有 Category_Selected 方法。我打电话给category_selected。

那就是我有第一个字母以大写字母开头的方法，但我正在调用第一个字母小写的方法。

# excel - apache POI 3.8 出现不可读的内容错误

> ID：10983006
> 
> 赞同：0
> 
> 时间：2012-06-11T15:20:34.480
> 
> 标签：excel, jsp, excel-2007, apache-poi

我正在使用 Apache POI 3.8。我有一个生成 excel (.xslx) 文件的 JSP。我在本地开发的，文件可以毫无问题地打开。然后，我在 Dev 环境中部署了该应用程序，当我在那里打开生成的 excel 文件时，会出现一个警告框：“Excel 在 ausencias.xlsx 中发现了不可读的内容。你想恢复这个工作簿的内容吗？如果你信任此工作簿的来源，单击是。” 如果单击“是”，则会出现以下警告：“无法使用 Microsoft Excel 打开此文件。是否要在 Microsoft Office Online 网站上搜索可以打开该文件的转换器？” 如果我单击否，则文件已正确打开。但我不知道为什么会出现这些错误。

即使我生成一个简单的空 .xslx 文件，它也会发生：

```
<%@page import="java.io.FileOutputStream"%>
<%@page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%>
<%@page import="java.io.IOException"%>
<%@page import="javax.servlet.*"%>

<%@page import="org.apache.poi.ss.usermodel.*"%>    
<%@page import="org.apache.poi.ss.util.CellRangeAddress"%>
<%@page import="org.apache.poi.xssf.usermodel.*"%>

<%
    response.setHeader ("Content-Disposition", "attachment;filename=\"ausencias.xlsx\"");
    response.setContentType("application/vnd.ms-excel");

    Workbook wb = new XSSFWorkbook();

    Sheet sheet = wb.createSheet("Ausencias");

    ServletOutputStream fout = response.getOutputStream();

    wb.write(fout);
    fout.flush();
    fout.close();
%> 
```

在我的本地机器上，我有 Microsoft Office Excel 2007 (12.0.6661.5000) SP2 MSO (12.0.6562.5003) 在开发环境中，我有 Microsoft Office Excel 2007 (12.0.6611.1000) SP3 MSO (12.0.6607.1000)

有谁知道解决方案或解决方法？

谢谢。

编辑：我已经添加了整个 JSP 代码。我知道有些进口商品可能无法使用；当我裁剪原始代码以查找问题时，我只是将它们留在那里。

编辑 2：我已经在我的本地机器上打开了在开发环境中生成的文档，它会抛出相同的警告。所以问题出在文件中，而不是在 Excel 版本中。似乎有些东西正在篡改 Dev Env 中的文件。有任何想法吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T01:19:00.267

the reason you are getting this error is because the MIME type is wrong. instead of

"application/vnd.ms-excel"

you need to use

"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"

for XLSX documents

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-12T06:08:24.533

我发现每当将二进制文件作为 http 响应发回时，您都应该始终设置内容长度。尽管有时您可以在不设置长度的情况下逃脱，但浏览器通常无法可靠地自动确定文件的长度。

通常，我这样做的方式是首先将我的输出文件写入 ByteArrayOutputStream。这让我可以计算输出文件有多大。然后我将 ByteArrayOutputStream 字节写入响应对象。

这是一个示例，基于您的原始代码：

```
 // generate the xlsx file as a byte array
    Workbook wb = new XSSFWorkbook();
    Sheet sheet = wb.createSheet("Ausencias");
    ByteArrayOutputStream bout = new ByteArrayOutputStream();
    wb.write(bout);
    bout.close();

    // send byte array as response
    response.setHeader ("Content-Disposition", "attachment;filename=\"ausencias.xlsx\"");
    response.setContentType("application/vnd.ms-excel");
    response.setContentLength(bout.size());
    ServletOutputStream fout = response.getOutputStream();
    fout.write(bout.toByteArray());
    fout.flush();
    fout.close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-20T13:06:00.783

这是我解决它的方式：

```
String name = "Name_of_file.xlsx";

ByteArrayOutputStream bout = new ByteArrayOutputStream();
workbook.write(bout);
bout.close();

response.setHeader("Set-Cookie", "fileDownload=true; path=/");
response.setHeader("Content-Disposition", "attachment; filename=" + name);
response.setContentLength(bout.size());

ServletOutputStream out = response.getOutputStream();

out.write(bout.toByteArray());
out.flush();
out.close(); 
```

我认为与其他答案的区别在于我没有使用 response.setContentType 指令，而且我不知道它起作用的确切原因......但它起作用了。不再有“Excel 发现无法读取的内容...”消息。

# android - 在构建 android 系统时如何将我的应用程序设置为默认应用程序

> ID：10983007
> 
> 赞同：1
> 
> 时间：2012-06-11T15:20:40.923
> 
> 标签：android, build

我正在开发一个安卓应用程序。我的所有应用程序都已安装并正在运行。现在我需要将我的主应用程序设置为默认应用程序并在启动时运行它。

有谁知道我该怎么做？

```
LOCAL_PATH:= $(call my-dir)

include $(CLEAR_VARS)

LOCAL_SRC_FILES := $(call my-dir/src/)

LOCAL_PACKAGE_NAME := BLT

include $(BUILD_PACKAGE) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:50:54.783

为了安全起见，如果没有在根电话上进行黑客攻击，这是不可能的。Android 不允许应用在未经用户确认的情况下将自己设置为默认值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T15:16:54.420

如果添加该行：

`LOCAL_OVERRIDES_PACKAGES := Launcher2`

到您的 Android.mk 文件，则 Launcher2（默认主屏幕）将不会包含在您的最终图像中。您需要像这样修复您的 AndroidManifest.xml（[使用我自己的 Android 应用程序/apk 作为启动器/主屏幕替换](https://stackoverflow.com/questions/8248213/use-my-own-android-app-apk-as-launcher-home-screen-replacement)），但是当您安装图像并启动手机时，您的应用程序将成为默认的主屏幕应用程序。

希望这可以帮助！

# c# - 使用 SynchronizationContext 时方法名称预期错误

> ID：10983023
> 
> 赞同：1
> 
> 时间：2012-06-11T15:21:28.487
> 
> 标签：c#, delegates, synchronization

我有一个线程，我需要像这样调用一个 void ：

```
makegraph(toplot, ite, mm_0) 
```

但是，如果我想同步，我应该使用 SynchronizationContext 并执行以下操作：

```
SynchronizationContext mContext = null;
mContext.Post(new SendOrPostCallback(makegraph(toplot, ite, mm_0)),null); 
```

但我有以下错误：方法名称预期。我知道我应该使用委托，但我不熟悉语法。

你能帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T15:44:33.117

首先，您的`mContext`变量永远不会设置为 的实例`SynchronizationContext`，它被初始化为 null。

[SynchronizationContext.Post()](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.post.aspx)函数需要两个参数，一个是[SendOrPostCallback](http://msdn.microsoft.com/en-us/library/system.threading.sendorpostcallback.aspx)类型，一个是 object 类型。

*   如果您查看 SendOrPostCallback 的文档，它是一个返回 void 并期望单个对象参数作为输入的委托。
*   Post 函数的`object state`参数是将传递给第一个参数中指定的委托的参数。

这意味着，您将需要创建一个`makegraph`与 SendOrPostCallback 委托的签名匹配的新函数，然后将所有参数传入单个对象中，如下所示：

```
public class MakeGraphState()
{
    // These don't have to be objects, but I don't know
    // what types your toplot, ite, and mm_0 paramters are
    public object toplot { get; set; }
    public object ite { get; set; }
    public object mm_0 { get; set; }
}

public static void makegraph(object state)
{
    // Convert state to a MakeGraphState so we can get
    // all of the input paramters
    MakeGraphState myState = (MakeGraphState)object;
    makegraph(myState.toplot, myState.ite, myState.mm_0);
} 
```

然后，您可以像这样使用此代码：

```
SynchronizationContext mContext = new SynchronizationContext();
// TODO: Initialize your SynchronizationContext
MakeGraphState state = new MakeGraphState(toplot, ite, mm_0);
mContext.Post(new SendOrPostCallback(makegraph), state); 
```

此外，您可以将委托的方法名称作为快捷方式传递：

```
SynchronizationContext mContext = null;
// TODO: Initialize your SynchronizationContext
MakeGraphState state = new MakeGraphState(toplot, ite, mm_0);
mContext.Post(makegraph, state); 
```

有关委托的详细信息，请参阅 MSDN 文章[委托（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms173171%28v=VS.80%29.aspx) 。

# wordpress - Wordpress - 将媒体上传到不同的服务器

> ID：10983026
> 
> 赞同：1
> 
> 时间：2012-06-11T15:21:43.560
> 
> 标签：wordpress

我已将 WP 站点上的资源拆分为两台服务器：服务器 A 与管理文件，服务器 B 与公共文件。它们由数据库连接。

有什么方法会导致我从服务器 A 上的 WP 管理员安装上传的媒体存储在服务器 B 上？这样，该媒体将从服务器 B（“公共站点”）提供。

如果可能，除了通过 FTP 连接之外，我的客户不希望在公共站点中使用 FTP :-(

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T21:52:03.463

首先，创建一个远程存储服务，您可以在其中发布文件并返回指向服务器 B 上文件的 URL。然后您可以使用 wp 过滤器从服务器 A 获取 url。

您可以连接到此过滤器：“wp_handle_upload”

```
 apply_filters{
      'wp_handle_upload'
       array( 'file' => $new_file, 'url' => $url, 'type' => $type ), 'upload' 
     ) 
```

只需将 URL 替换为新的

# meteor - 流星中多个视图的最佳实践方法？

> ID：10983029
> 
> 赞同：15
> 
> 时间：2012-06-11T15:21:53.463
> 
> 标签：meteor

我可以为流星找到的每个教程/示例都显示了一个单一的视图应用程序。我想构建一些更复杂的东西。我不清楚如何处理多个视图......最好以某种可扩展的方式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T22:39:05.077

[Iron-router](https://github.com/EventedMind/iron-router)包允许您通过漂亮的、REST 式的、[人性化的干净 URL](http://en.wikipedia.org/wiki/Clean_URL)访问不同的视图（布局） 。它支持 URL 中的参数，“加载”模板，等待订阅完成加载，`before`以及`after`钩子等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-12T01:48:24.593

此时您只能使用 Meteor 创建单页应用程序。请注意，单页并不意味着您不能拥有多个视图 - 为此使用[Iron-router](https://stackoverflow.com/a/14740242/1269037)。

但是按照设计，Meteor 为浏览器提供了一个巨大的、独特的 JavaScript/HTML/CSS 应用程序，尽管有一个允许[增量加载](https://trello.com/c/24s6vyxo/55-incremental-loading)的功能请求。然后由应用程序（或更准确地说，JavaScript 框架）来动态呈现其视图以显示不同的“页面”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-09T06:33:34.657

我想知道同样的事情，我花了太多时间开始做某事。通过使用 Backbone 视图和路由，我终于得到了一个分页应用程序，因此我创建了一个简单的样板项目，以便将来更容易地设置这样的应用程序。

现场演示：[backbone-boilerplate.meteor.com](http://backbone-boilerplate.meteor.com/)

源代码在这里：[github.com/justinmc/meteor-backbone-boilerplate](https://github.com/justinmc/meteor-backbone-boilerplate)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T23:06:50.167

你看过[madewith.meteor.com](http://madewith.meteor.com)吗？

一堆应用程序有多个使用 Backbone 的视图创建[britto的 Jonathan Kingston 已经启动了名为](http://github.com/jonathanKingston/britto)[Stellar](http://github.com/jonathanKingston/stellar)的简单流星框架

在游戏的这个阶段，不确定是否真的有最佳实践。但这两个似乎是当前的流动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-08T03:38:55.100

您还可以为多个视图创建一个选项卡式界面。这里有一个包项目“Smart package for generate a tabbed interface with pushState”github项目：[https ://github.com/possibilities/meteor-tabs](https://github.com/possibilities/meteor-tabs)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-09T22:53:49.990

现在最好的解决方案是使用路由包（路由器是基本的但可以工作）。工作流程是这样的：

*   声明路线；返回每个路由的模板名称
*   将包提供的响应式助手放在你的 body 标签中
*   反应式助手将返回与该路由关联的模板
*   您为每条路线创建一个模板，并可选择设置自定义发布功能

路由器将为您提供浏览器历史记录（客户端）。

请注意，此时 Meteor 处理 html/js 的方式存在一些限制。它们同时加载。好的一面是，一旦加载应用程序，页面转换将是即时的。

# delphi - 如何访问不受支持的 UI 元素？

> ID：10983031
> 
> 赞同：2
> 
> 时间：2012-06-11T15:21:58.193
> 
> 标签：delphi, ui-automation, coded-ui-tests

我想用 Coded UI Tests 测试一个 Delphi 应用程序，但是我遇到了一些问题。我想访问 UI 中的某些元素，但无法访问所有元素。

屏幕上有一个包含一些行的列表（根据搜索参数），我想访问这些行以检查值的一致性。但是通过 Coded UI Test Builder 的交叉，我无法访问应用程序上的行。如何访问行？

我现在只找到了一个解决方案：为 Coded UI Tests 开发一个扩展，以便与我的 Delphi 应用程序正确交互，就像[Microsoft 网站上的示例](http://msdn.microsoft.com/en-us/library/ff398055)一样。它是 Excel 的扩展，可让您访问每个单元格。但这听起来很困难，而且我必须测试的应用程序也非常复杂。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:05:15.000

如果你的界面是普通的 VCL，你可以通过使用它们下面的`HWND`句柄来访问大多数组件。它会为`TEdit TMemo TComboBox TCheckBox`等一个人工作。但是某些图形组件将无法从 GDI 消息中访问，例如`TLabel`或`TGrid`.

所以我猜你必须在你的应用程序中使用 Delphi 插件，才能访问 VCL 组件级别。使用（通过递归调用）的`ComponentCount + Components[]`属性`TForm`来访问要测试的组件。然后将其属性发布到要编写的 Coded UI Tests 扩展。

我在这里谈论一个“插件”，因为我认为我们可能不容易访问所有要监视/修改的类。在测试阶段，一些“插件”架构可以帮助应用程序像往常一样工作，或者在“编码 UI 测试模式”下工作。出于测试目的进行单独编译可能更好：您应该更好地测试最终编译的可执行文件。如果您只想要单元测试，您可以重新编译、存根和模拟您的应用程序以仅测试给定的表单。但是您需要对表单进行编码以便轻松进行单元测试（使用依赖注入等），这在默认的 Delphi 世界中远非易事（与其他 RAD 方法一样）。

启动一个开源项目（包含在 DUnit 中？）来开发这样一个平台可能会很有趣。或者使用现有的 Delphi UI 测试框架作为基础。我们工作的很多公司都在混合 .Net 和 Delphi 技术，并且会受益于这样的工具。

# validation - 验证失败时，Backbone Validate 正在发送请求

> ID：10983033
> 
> 赞同：4
> 
> 时间：2012-06-11T15:22:07.210
> 
> 标签：validation, backbone.js

根据有关验证的主干文档，它指出：

> 如果 validate 返回错误，set 和 save 将不会继续，模型属性也不会被修改。

因此，如果验证失败，我读取该设置或保存的方式不应该运行。但这不是我得到的结果。即使验证失败，它仍然会发送 POST/PUT 请求。我是在阅读文档错误还是在代码中做错了什么？

这是我的相关代码： [https ://gist.github.com/80f6ef0099fbe96025dc](https://gist.github.com/80f6ef0099fbe96025dc)

```
App.Models.Test = Backbone.Model.extend(
    urlRoot: '/api/test'

    validate: (attrs) ->
        errors = []
        if attrs.to is ''
            errors.push
                name: "to"
                field: "js-to"
                message: "You must enter a to address"
        if attrs.subject is ''
            errors.push
                name: "subject"
                field: "js-subject"
                message: "You must enter a subject"

        # Return our errors array if it isn't empty
        errors  if errors.length > 0
)

App.Views.Details = Backbone.View.extend(
    initialize: ->
        @model.bind "error", @error, this

    events:
        "click #js-save": "saveItem"

    saveItem: (e) ->
        e.preventDefault()

        # Set the model then save it.
        @model.set
            subject: $("#js-subject").val()
            message: $("#js-message").val()
            mailbox_id: $("#js-from").val()
            to: $("#js-to").val()
            cc: $("#js-cc").val()
            bcc: $("#js-bcc").val()
            tags: App.Helpers.tagsToObject $('#js-tags').val()
            scope: $('#js-scope').val()
            attachments: attachments

        @model.save null,
            success: (model, response) =>
                App.Helpers.showAlert "Success!", "Saved Successfully", "alert-success"
                @next()
            error: (model, response) ->
                App.Helpers.showAlert "Error", "An error occurred while trying to save this item", "alert-error"

    # Show the errors based on validation failure.
    error: (model, error) ->
        App.Helpers.displayValidationErrors error 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T17:58:06.780

你这样做是为了保存你的模型：

```
@model.save null,
    success: -> ...
    error:   -> ... 
```

那`null`是您的麻烦，使用`{}`和事情将开始表现得更好的根源；如果你结合你的`@model.set`和`@model.save`电话，事情会更好：

```
attrs =
    subject: $("#js-subject").val()
    #...
@model.save attrs,
    success: -> ...
    error:   -> ... 
```

[`save`](http://documentcloud.github.com/backbone/#Model-save)调用如下所示：

> **save** `model.save([attributes], [options])`
> [...]**属性**散列（如 中）应包含您要更改的
> 属性**`set`**

 **所以传递一个`null`for`attributes`意味着你想按原样保存模型。

当你[`save`](http://documentcloud.github.com/backbone/#Model-save)是一个模型时，验证主要是留给[`set`](http://documentcloud.github.com/backbone/#Model-set)，[代码如下所示](https://github.com/documentcloud/backbone/blob/master/backbone.js#L360)：

```
if (attrs && !this.set(attrs, options.wait ? silentOptions : options)) {
  return false;
} 
```

你的`attrs`意志不会`null`被`set`召唤；但是，如果你让`save`处理你的`set`，你会得到你所追求的行为。如果您通过了该`wait: true`选项，`save`将[手动](https://github.com/documentcloud/backbone/blob/master/backbone.js#L353)对传递的属性运行验证：

```
if (options.wait) {
  if (!this._validate(attrs, options)) return false;
  ...
} 
```

内部[`_validate`](https://github.com/documentcloud/backbone/blob/master/backbone.js#L524)方法是一个包装器，用于`validate`进行一些簿记和错误处理。您没有使用`wait: true`，因此这不适用于您，但我认为无论如何都值得一提。

考虑一个`validate`总是失败的模型的简单示例。如果你这样说：

```
@model.on 'error', @error
@model.save attrs,
    success: -> console.log 'AJAX success'
    error:   -> console.log 'AJAX error' 
```

then`@error`将被调用，因为`save`最终会调用`set`一些[属性](https://github.com/documentcloud/backbone/blob/master/backbone.js#L343)并将`set`调用`validate`. 演示：http: [//jsfiddle.net/ambiguous/HHQ2N/1/](http://jsfiddle.net/ambiguous/HHQ2N/1/)

但是，如果你说：

```
@model.save null, ... 
```

这`null` [将导致`set`呼叫被跳过](https://github.com/documentcloud/backbone/blob/master/backbone.js#L360)。演示： http: [//jsfiddle.net/ambiguous/6pX2e/](http://jsfiddle.net/ambiguous/6pX2e/)（这里的 AJAX 会失败）。

您`@model.set`之前的调用`@model.save`应该触发您的错误处理程序，但如果您不检查`@model.set`返回的内容，执行将盲目地继续`save`调用并与您的服务器对话。

* * *

总之，这里发生了三件事：

1.  你没有`save`像你应该那样称呼他们。
2.  您忽略了`@model.set`返回值并失去了捕获验证错误的机会。
3.  Backbone 的参数处理`save(null, ...)`可能会更好，但我不知道是否值得努力处理一种奇怪的调用方式。

您应该将您的`set`/`save`对组合成一个`save`或检查`set`返回的内容。**

# c++ - 行数，如何处理 CRLF？

> ID：10983034
> 
> 赞同：1
> 
> 时间：2012-06-11T15:22:08.007
> 
> 标签：c++, windows, carriage-return, linefeed

我正在编写一个简单的包装类，用于逐个字符地扫描字符流。

```
Scanner scanner("Hi\r\nYou!");
const char* current =  scanner.cchar();
while (*current != 0) {
    printf("Char: %d, Column: %d, Line: %d\n", *current, scanner.column(), scanner.line());
    current = scanner.read();
}

C:\Users\niklas\Desktop>g++ main.cpp -o main.exe
C:\Users\niklas\Desktop>main.exe
Char: 72, Column: 0, Line: 0
Char: 105, Column: 1, Line: 0
Char: 13, Column: 0, Line: 1
Char: 10, Column: 0, Line: 2
Char: 89, Column: 1, Line: 2
Char: 111, Column: 2, Line: 2
Char: 117, Column: 3, Line: 2
Char: 33, Column: 4, Line: 2 
```

这个例子已经显示了我遇到的问题。可以解释`\r`为换行符，也可以理解为`\n`. 但是在一起（`\r\ n`）它们也只是一个*新*行！

处理行号和列号的函数是这样的：

```
void _processChar(int revue) {
    char chr = _source[_position];
    if (chr == '\r' or chr == '\n') {
        _line += revue;
        _column = 0;
    }
    else {
        _column += revue;
    }
} 
```

当然，我可以只查看出现在当前位置的字符*之后的字符，***但是**：我*不*检查源上的 NULL 终止，因为我希望能够处理可能包含`\0`字符而不被终止的字符流那一点。

我怎样才能以这种方式处理 CRLF？

**编辑1**：DOH！这似乎工作正常。这在任何情况下都是安全的还是我在某个地方有问题？

```
void _processChar(int revue) {
    char chr = _source[_position];

    bool is_newline = (chr == '\r' or chr == '\n');
    if (chr == '\n' and _position > 0) {
        is_newline = (_source[_position - 1] != '\r');
    }

    if (is_newline) {
        _line += revue;
        _column = 0;
    }
    else {
        _column += revue;
    }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T15:31:43.173

大多数现代系统`\n`作为当前目标平台的换行符处理，因此如果您只检查`\n`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T15:34:39.133

您可能需要将状态保留在流包装器中——正如您所注意到的，无状态包装器根本*无法*做到这一点，因为每个输出都可以（根据定义）依赖于先前的输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:51:47.017

这对我来说似乎是合法的：

```
void _processChar() {
    char chr = _source[_position];

    // Treat CRLF as a single new-line
    bool is_newline = (chr == '\r' or chr == '\n');
    if (chr == '\n' and _position > 0) {
        is_newline = (_source[_position - 1] != '\r');
    }

    if (is_newline) {
        _line += 1;
        _column = 0;
    }
    else {
        _column += 1;
    }
} 
```

在`\n`处理 a 时，它会检查*前一个*字符是否为回车符 ( `\r`)。如果是这样，*则不*增加行号。

此外，在检查前一个字符之前，它会测试是否*确实*存在前一个字符 ( `and _position > 0`)。

*我已经删除了这个* `int revue` *论点，因为我只是注意到我想要实现的目标是不可能的，因为我试图实现它。我希望能够在源代码中倒退，但是我无法从上一行检索列号。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T15:28:48.300

您`_processChar`似乎没有增加流读取位置。更改后，您可以实施完整的换行检查：

```
void _processChar(int revue) {
    char chr = _source[_position];
    if (chr != '\r' and chr != '\n') {
        _column += revue;
        return;
    }
    if (if chr == '\r' and _source[_position + 1] == '\n')
        ++_position;
    _line += revue;
    _column = 0;
} 
```

# c# - 基于使用 NamedNetPipes Binding 解析 Endpoint Address 动态创建 WCF ServiceHost

> ID：10983035
> 
> 赞同：2
> 
> 时间：2012-06-11T15:22:10.873
> 
> 标签：c#, wcf

需要一种方法让知名端点上的服务返回相对地址的字符串。然后客户端可以使用这些相对地址连接到端点。显然，这在某些方面类似于 REST，但在这种情况下，使用 NetNamedPipeBinding for IPC 运行 Windows 服务，因此不需要 HTTP。

不想提前创建端点，因为可能会有大量的相对地址，只有其中一些是客户感兴趣的。

所有合同都是事先知道的。

尝试使用[AddressFilterMode](http://msdn.microsoft.com/en-us/library/system.servicemodel.addressfiltermode.aspx)找到解决方案，但不确定如何设置新的 Binding 以便客户端连接到[UriTemplate](http://msdn.microsoft.com/en-us/library/system.uritemplate.aspx)但不想使用 HTTP 框架。由于受限于 .Net 3.5，因此尚未研究[RoutingService 。](http://msdn.microsoft.com/en-us/library/system.servicemodel.routing.routingservice.aspx)

客户端的伪代码如下所示...

```
namespace Testing
{
    class RunTest
    {
        static void Test()
        {
            NetNamedPipeBinding namedpipe = new NetNamedPipeBinding();
            ChannelFactory<Contracts.IRoot> factoryRoot =
                new ChannelFactory<Contracts.IRoot>(
                namedpipe
                , new EndpointAddress("net.pipe://localhost/root");
            );
            Contracts.IRoot root = factoryRoot.CreateChannel();
            ICommunicationObject commsRoot = root as ICommunicationObject;
            commsRoot.Open();

            // Service examines address and creates Endpoint dynamically.
            string address = root.SomeFunctionWhichGetsARelativeAddress();

            // IBar service routes endpoint requests internally based on
            // "address" variable.
            ChannelFactory<Contracts.IBar> factoryBar = 
                new ChannelFactory<Contracts.IBar>(
                namedpipe
                , new EndpointAddress("net.pipe://localhost/root/IBar/" +
                                       address)
            );
            Contracts.IBar bar = factoryBar.CreateChannel();
            bar.DoSomething();
        }
    } // Ends class RunTest
} // Ends namespace Testing 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T12:35:30.880

[AddressFilterMode.Prefix](http://msdn.microsoft.com/en-us/library/system.servicemodel.addressfiltermode.aspx)可能就足够了。可以通过 [OperationContext](http://msdn.microsoft.com/en-us/library/system.servicemodel.operationcontext.aspx)在 Service 方法中检查实际使用的 Endpoint 。[当前](http://msdn.microsoft.com/en-us/library/system.servicemodel.operationcontext.current.aspx). [IncomingMessageHeaders](http://msdn.microsoft.com/en-us/library/system.servicemodel.operationcontext.incomingmessageheaders.aspx)。[至](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.messageheaders.to.aspx)

辅助代码可以解析端点并从那里进行任何必要的内部处理。希望服务器端有一些可扩展性，可以简化该代码。

主机伪代码：

```
namespace Services
{
    [System.ServiceModel.ServiceBehavior(AddressFilterMode =
         System.ServiceModel.AddressFilterMode.Prefix)]
    class BarService : Contracts.IBar
    {
        #region IBar Members

        public void DoSomething()
        {
            System.Uri endpoint = System.ServiceModel.OperationContext.Current.IncomingMessageHeaders.To;
            Console.WriteLine("DoSomething endpoint: {0}", endpoint);
        }
    } // Ends class BarService
} // Ends namespace Services
class RunHost
{
    static void HostIBar()
    {
        System.Uri uriBase = new System.Uri("net.pipe://localhost");
        System.ServiceModel.ServiceHost hostBar =
            new System.ServiceModel.ServiceHost(
            typeof(Services.BarService),
            uriBase);
        hostBar.AddServiceEndpoint(
              typeof(Contracts.IBar) // Type implementedContract
            , namedpipeBinding // System.ServiceModel.Channels.Binding binding
            , "root/IBar" //string address
        );
        hostBar.Open();

        Console.WriteLine("Press <ENTER> to stop...");
        Console.ReadLine();
    }
} 
```

更正：我最初说过这不会将`"net.pipe://localhost/root/IBar/1"`and`"net.pipe://localhost/root/IBar/2"`视为不同的端点，但确实如此。每个都会创建和调用自己的 WCF 服务实例。

另一个变化是对 URL 样式查询参数中的数据进行编码，而不是将其嵌入到路径中。例如：`"net.pipe://localhost/root/IBar?something=1&somethingelse=11"`并`"net.pipe://localhost/root/IBar?something=2&somethingelse=22"`使用[HttpUtility.ParseQueryString](http://msdn.microsoft.com/en-us/library/ms150046.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T16:16:50.140

消息过滤器是要走的路。您可以使用“前缀”或创建自定义。

[WCF 深度寻址](http://msdn.microsoft.com/en-us/magazine/cc163412.aspx)

从文章的*消息过滤器*部分：

> ...它使用消息过滤器来确定匹配的端点（如果存在）。您可以选择使用哪个消息过滤器，也可以提供自己的过滤器。这种灵活性允许您在使用 Windows Communication Foundation 实现传统 SOAP 以外的事物时摆脱传统的调度模型 - 例如，此处描述的技术使您能够在 Windows Communication Foundation 消息传递基础上实现 REST/POX 样式的服务。

顺便说一句，好问题。我学到了一些东西试图解决这个问题。

# jquery - stackexchange 主页上使用什么滑块？

> ID：10983043
> 
> 赞同：0
> 
> 时间：2012-06-11T15:22:30.517
> 
> 标签：jquery, sliders

哪个滑块用于滚动浏览 Stackexchange 网站上的网站？我认为它是任何滑块，但似乎无法找到它的实施位置和方式。

谁能给我看一个例子或其他类似的脚本？

提前致谢。

这是我的意思的截图 - [http://grab.adrianfraguela.com/e6ds](http://grab.adrianfraguela.com/e6ds)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:25:20.840

看起来像任何滑块。[cdn.sstatic.net/stackexchange/js/home.js?v=3a6605ce6125](http://cdn.sstatic.net/stackexchange/js/home.js?v=3a6605ce6125)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:25:54.320

它绝对是任何滑块。

容器 div 有一个类`anythingSlider`

并且包含在其中的 home.js 文件中`head`有anythingSlider javascript。

# javascript - 包含不同对象的数组好吗？

> ID：10983045
> 
> 赞同：2
> 
> 时间：2012-06-11T15:22:46.973
> 
> 标签：javascript, arrays

我需要一个可以容纳不同对象类型的数组，并认为我需要使用某种形式的继承，但后来意识到它已经在 J​​avascript 中默认工作：

```
var someArray = [];

someArray.push("Hello World");
someArray.push(12);
someArray.push(false);

alert(someArray.pop());
alert(someArray.pop());
alert(someArray.pop()); 
```

似乎在 JSFiddle 中工作。这可能是一个愚蠢的问题，但是这样做有什么问题吗？在我的 C、C++、C#、VB .NET 等背景中，数组需要是单一类型的，所以这种事情对我来说似乎很神奇。这种事情可以做吗，还是只会导致虫子和拉扯头发？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T15:24:46.647

数组在javascript中不是强类型的，所以没有问题......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T15:25:18.207

Javascript 是一种动态语言，它的数组不是强类型的，所以没问题。
这样做也是如此：

```
var x = 12;     // Number
    x = "12";   // String
    x = {};     // Object
    x = [];     // Array.
    ... 
```

每个变量都可以保存每种类型的对象，不仅仅是数组......
当您使用以下`typeof`运算符时：

```
if (typeof x === "string") 
```

**您不是在“查询” x 变量类型，而是它持有的值。**

*   `C#, java, c++ ...`：必须声明可变数据类型（静态类型）。
*   `Javascript`：未声明变量数据类型（动态类型）。

# iphone - 如何使用 MKStoreKit 恢复购买

> ID：10983050
> 
> 赞同：0
> 
> 时间：2012-06-11T15:23:01.050
> 
> 标签：iphone, objective-c, ios, xcode, ipad

我的应用程序被苹果拒绝，因为它没有恢复按钮，但我使用的是 MKStoreKit，所以如果购买了应用程序并且设备被擦除并且用户再次单击我的购买按钮，它会重新下载并“恢复” ' 应用程序。

那么，有人可以解释他们要我做什么吗？我以为 MKStoreKit 为我处理了这个。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-03T20:48:01.117

打电话`restorePreviousTransactionsOnComplete`

```
#import "MKStoreManager.h"

-(void)restorePreviousPurchase{
    [[MKStoreManager sharedManager]restorePreviousTransactionsOnComplete:^{NSLog(@"RESTORED PREVIOUS PURCHASE");} onError:nil];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T05:03:10.237

```
- (IBAction) RestoreCompletedTransactions:(id)sender
{
[[SKPaymentQueue defaultQueue] addTransactionObserver:self];
[[SKPaymentQueue defaultQueue] restoreCompletedTransactions];
} 
```

虽然不确定按钮，我猜我的总是显示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T15:28:23.320

您需要在应用程序的某处添加一个恢复按钮，这将允许用户恢复以前的购买。

`MKStoreKit`完成所有这些，但您需要将按钮添加到`UI`您自己。然后你可以调用该`restorePreviousTransactionsOnComplete:onError:`方法`MKStoreManager`

# javascript - 如何使用 Dojo.fromJson 反序列化包含控制字符的 Json 对象

> ID：10983056
> 
> 赞同：0
> 
> 时间：2012-06-11T15:23:21.193
> 
> 标签：javascript, json, dojo

我正在使用 Dojo.fromJson 将 json 字符串转换为 javascript 对象，但抛出异常。因为，`',\n,\r`在 json 字符串中有控制字符。

如何在道场中解决这个问题？将 json 字符串转换为 javascript 对象，即使有控制字符。

我使用 Newtonsoft.JsonConvert.SerializeObject 将 C# oject 转换为 json 数据。Json Object：`{"name":"'\"abc\n123\r"}`然后，我使用`Dojo.fromJson(' {"name":"'\"abc\n123\r"}')`将 json 数据转换为 javascript 对象。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T11:24:30.293

问题，我相信应该用三重反斜杠转义的双引号。您可以使用“本机浏览器 JSON 解码”作为“dojo fromJson”同义词的搜索词。

在不了解 C# 的情况下 - 我没有测试过，但我相信以下应该可以工作：

```
string c_sharp_name = "'\"abc\n123\r";
// C#Object.name
c_sharp_name = c_sharp_name.
  replace('"', '\\"'). // maybe add a slash on serverside
  replace('\n', '\\\n').
  replace('\r', '\\\r'); 
```

自从

*   虽然这失败了：
*   {"name":"'\"abc\n123\r"} // 你的单反斜杠
*   这会起作用：
*   {"name":"'\\\"abc\\\n123\\\r"} // 工作三反斜杠转义

# vbscript - mstsc 远程桌面问题

> ID：10983062
> 
> 赞同：0
> 
> 时间：2012-06-11T15:23:35.777
> 
> 标签：vbscript, rdp, mstsc

目前，为了改善日常流程中的一些低效率，我正在尝试编写 ac# Winform 应用程序，它将用户输入与 VBscripts 结合起来，这将加快以前所有用户输入的过程，即查看 excel 文件和移动文件从 VSS 到某些服务器的某些文件夹。

我希望以正确的方式回答一些问题：

使用命令行或其他解决方法而不是手动，

1) 是否可以使用智能卡/pin 登录到 2003 远程桌面？

2）是否可以通过您机器上的命令在远程桌面上运行文件/启动进程？

感谢您的帮助和时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:15:13.250

我只有第二个问题的经验。您可以使用远程脚本或 SysInternals PsExec [http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)等实用程序来执行此操作， 这里是一个远程启动 ipconfig 命令并将其重定向到文本文件的 vbscript 请注意，您无法启动这样的交互式进程，它们会启动但不会显示

```
Dim sComputer   'computer name
Dim sCmdLine    'command line of the process
Dim sCurDir   'working directory of the process
Dim oProcess    'object representing the Win32_Process class
Dim oMethod   'object representing the Create method
sComputer = "." 'this is the local computer, use a pcname or ip-adress to do it remote
sCmdLine = "cmd /c ipconfig.exe > c:\ipconfig.txt"
Set oProcess    = GetObject("winmgmts://" & sComputer & "/root/cimv2:Win32_Process")
Set oMethod     = oProcess.Methods_("Create")
Set oInPar    = oMethod.inParameters.SpawnInstance_()
oInPar.CommandLine  = sCmdLine
oInPar.CurrentDirectory = sCurDir
Set oOutPar     = oProcess.ExecMethod_("Create", oInPar)
If oOutPar.ReturnValue  = 0 Then
  WScript.Echo "Create process method completed successfully"
  WScript.Echo "New Process ID is " & oOutPar.ProcessId
Else
  WScript.Echo "Create process method failed"
End If 
```

# css - 使用带有“位置：绝对”的全宽不包括溢出滚动条

> ID：10983066
> 
> 赞同：7
> 
> 时间：2012-06-11T15:24:07.387
> 
> 标签：css, google-chrome, overflow, css-position

我想在另一个具有`overflow: scroll`. 我希望 jsFiddle 说清楚：http: [//jsfiddle.net/mCYLm/2/](http://jsfiddle.net/mCYLm/2/)。

问题是红色 div 与滚动条重叠。我猜是指;`right: 0`的右手边 `div.wrapper`它不会减去 的滚动条`div.main`。当我移动`overflow: scroll`into`div.wrapper`时，红色横幅的大小正确（[小提琴](http://jsfiddle.net/mCYLm/3/)）。但是，它不再处于固定位置（向下滚动会使横幅向上滚动）。

我怎样才能同时实现以下两件事？

*   [红色的旗帜像这把小提琴](http://jsfiddle.net/mCYLm/2/)一样在固定的位置。
*   [除了这个小提琴](http://jsfiddle.net/mCYLm/3/)中的滚动条之外，红色横幅具有全宽。

我想让这个在谷歌浏览器中工作。

HTML：

```
<div class="wrapper">
    <div class="red-banner"></div>
    <div class="main">
        <div class="item">foo</div>
        <div class="item">foo</div>
        <div class="item">foo</div>
        <div class="item">foo</div>
    </div>
</div>​ 
```

CSS：

```
div.wrapper {
    position: relative;
}

div.main {
    height: 200px;
    overflow-y: scroll;
}

div.item {
    border: 1px solid black;
    margin: 20px;
    padding: 20px;
}

div.red-banner {
    background-color: red;
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    height: 20px;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T17:05:29.180

似乎这对于纯 CSS 是不可能的，所以这里有一个 JavaScript (jQuery) hack：

```
$(function() {
  var $container = $("<div>").css({ height: 1, overflow: "scroll" }).appendTo("body");
  var $child = $("<div>").css({ height: 2 }).appendTo($container);
  window.SCROLLBAR_WIDTH = $container.width() - $child.width();
  $container.remove();
}); 
```

然后：

```
$("div.red-banner").css({
  right: SCROLLBAR_WIDTH
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T15:38:40.413

**HTML**

```
<div class="scroller">
    <div class="banner-wrapper">
        <div class="banner"></div>
    </div>
</div>

<div class="main">
    <div class="item">foo</div>
    <div class="item">foo</div>
    <div class="item">foo</div>
    <div class="item">foo</div>
</div>​ 
```

**CSS**

```
* { margin: 0; padding: 0 }
body {
    padding-top: 30px;
}

div.main {
    height: 200px;
    width: 100%;
    overflow-y: scroll;
    position: absolute;
    z-index: 50;
    background: -webkit-gradient(linear, center top, center bottom, from(white), to(rgba(255,255,255,0)));
}

div.item {
    border: 1px solid black;
    margin: 20px;
    padding: 20px;
}

div.scroller {
    height: 20px;
    width: 100%;
    position: absolute;
    z-index: 100;
    overflow: hidden;
}

div.banner-wrapper {
    background: transparent;
    position: relative;
    height: 20px;
    overflow-y: scroll;
    left: 0;
    margin-right: -20px;
}
div.banner {
    height: 20px;
    background: -webkit-gradient(linear, center top, center bottom, from(white), to(rgba(255,255,255,0)));;
    margin-left: 20px;
    margin-right: 40px;
} 
```

开发版：http: [//jsfiddle.net/mCYLm/13/](http://jsfiddle.net/mCYLm/13/)
最终版：http: [//jsfiddle.net/mCYLm/14/](http://jsfiddle.net/mCYLm/14/)

适用于缩放和可变视口宽度。
**！BUG**：右上角的滚动条按钮不可访问/不可点击。

测试：

*   IE6、7、8、9（Windows）
*   FF11（视窗）
*   谷歌浏览器 18 (ubuntu)
*   Safari 5.1 (OSX)

# z3 - Z3 4.0 模型中的额外输出

> ID：10983067
> 
> 赞同：4
> 
> 时间：2012-06-11T15:24:09.143
> 
> 标签：z3

当我试图获取模型字符串以及我定义的变量时，我会在模型中获得额外的输出 -

```
 z3name!0=3, z3name!1=-2, z3name!10=0, z3name!11=0, z3name!12=0, z3name!13=0, z3name!14=0, z3name!15=0, z3name!2=0, z3name!3=0, z3name!4=2, z3name!5=2, z3name!6=0, z3name!7=-3, z3name!8=2, z3name!9=0 
```

我想知道这是错误的输出吗？还是 Z3 正在使用的一些中间变量？

因为我定义的变量的值对我来说似乎没问题。我以前没有见过任何这样的输出，因此我有这个疑问。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T15:32:54.470

Z3 有几个预处理步骤。其中一些引入了新变量。新变量通常会从结果模型中删除。如果不是，这是一个错误。但是，此错误不会*影响*正确性。这只是一个不便。

如果您可以发布您的问题，那就太好了。我们将能够确定哪个预处理步骤没有消除引入的辅助变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-18T22:58:25.997

我意识到这是一个古老的话题，但我发现自己有与莱昂纳多所说的相同的“错误”。由于 OP 没有发布他的代码，我认为我的代码可能会帮助修复它（尽管只要确实保留了正确性，这个额外的输出对我来说不是问题）。

看来，如果我将最终断言中的“/”更改为“+”运算符，问题就会消失。

```
(declare-fun fun0!0 () Int)
(declare-fun fun0!-1 () Int)
(declare-fun var0 () Int)

(assert (and
    (and
        (or (= fun0!0 0) (= fun0!0 1) (= fun0!0 2))
        (or (= fun0!-1 0) (= fun0!-1 1) (= fun0!-1 2))
        (or (= var0 1) (= var0 -1))
    )
    (and (or (= var0 0) (= var0 -1)))
))

(define-fun fun0 ((i! Int)) Int
    (ite
        (= i! 0)
        fun0!0
        (ite
            (= i! -1)
            fun0!-1
            (- 0 1)
        )
    )
)

(assert (=
    (fun0 var0)
    (/ var0 var0)
))
(check-sat) 
```

# jquery - iframe 和它们之间的通信

> ID：10983071
> 
> 赞同：0
> 
> 时间：2012-06-11T15:24:39.223
> 
> 标签：jquery, html, css

我有一个页面索引，它具有以下内容和 iframe 设置：

索引页：

```
<html>
<body>

<iframe src=".." id="leftFrame"></frame>
<iframe src="mainFrame.html" id="mainFrame"></frame>

</body>

</html> 
```

mainFrame.html:

```
<div class="hidden" id="hiddenStuff">
....
</div> 
```

现在在 mainFrame 中，我正在一个隐藏的 div 中加载一些内容。

是否可以从 mainFrame.html 获取该内容并将其显示在索引中，**这是通过 javascript 从 mainFrame 触发的**？

即，一旦 mainFrame 加载，它将通过 javascript 调用父 iframe 以获取 #hiddenStuff 的内容，然后将其显示在索引页面中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:22:02.890

是的，如果 parent 和 mainFrame 都在同一个域上，这是可能的。

**父/索引：**

```
<html>
<body>

<script type="text/javascript">

function updateContent(content)
{
    $('#content').html(content);
}

document.domain = "yourdomain.com";

</script>

<iframe src=".." id="leftFrame"></frame>
<iframe src="mainFrame.html" id="mainFrame"></frame>

<div id="content"> </div>

</body>

</html> 
```

**主框架/子：**

```
<script type="text/javascript">

document.domain = "yourdomain.com";

$(document).ready(function(){

    // on page load, trigger the update
    var content = $('#hiddenStuff').html();

    try
    {
        parent.updateContent(content);
    }
    catch(e)
    {
        // couldn't call the parent, handle the exception
    }

});

</script>

<div class="hidden" id="hiddenStuff">
....
</div> 
```

请记住，在将原始 HTML 处理为元素时，如果任何内容来自用户输入，则需要考虑 XSS 的可能性。

# android - Android活动切换动画背景

> ID：10983073
> 
> 赞同：3
> 
> 时间：2012-06-11T15:24:44.137
> 
> 标签：android, animation

我想要实现的是从活动到活动时的翻转动画。

我在某处看到了一个建议，我应该在一个活动中使用适当的布局动画，在没有任何动画的情况下切换到下一个，然后在第二个活动中执行动画的后半部分。

我想它可以工作，还没有尝试过。但困扰我的是更笼统的方面——我相信应该可以通过活动过渡动画达到相同的效果，但是......

某处（我猜是这样，但我现在找不到它）我读过在活动过渡动画期间，背景应该始终被动画活动完全覆盖。我不知道为什么 - 我可以看到我所有设备上的背景总是黑色的，并且在动画期间使其可见似乎是无害的。

但也许不能保证？有人可以确认该要求吗？哪里有官方说明？

# hyperlink - 如何从 MediaWiki 链接运行 windows 命令？

> ID：10983076
> 
> 赞同：2
> 
> 时间：2012-06-11T15:24:58.597
> 
> 标签：hyperlink, cmd, mediawiki, exe

我想在 Mediawiki 页面上发布一个链接，单击该链接会打开 PUTTY 控制台并通过 ssh 连接到服务器。例如，

```
[file:%SystemRoot%\system32\Cmd.exe /c putty -ssh <some server>] 
```

这被呈现为纯文本。此命令文本`%SystemRoot%\system32\Cmd.exe /c putty -ssh <some server>`在 Windows+Run 时完美运行。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:38:58.620

编写一个简单的控制台应用程序，在命令行 args[0] 上接受您的输入，然后注册一个协议（例如 foo://）并将页面中的参数传递给它。

请参阅：[MSDN：将应用程序注册到 URL 协议](http://msdn.microsoft.com/en-us/library/aa767914%28v=vs.85%29.aspx)

# c++ - C++：什么（a< 我有一个 C++ 头文件，其中包含以下定义： #define CACHE_NUM_WAYS (1<<1) #define CACHE_DATA_SIZE (1<<8) 它在其余代码中用作整数。 这是什么意思？它的价值是什么？ 问问题

> ID：10983078
> 
> 赞同：21
> 
> 时间：
> 
> 标签：c++, operators

我有一个 C++ 头文件，其中包含以下定义：

```
#define CACHE_NUM_WAYS    (1<<1)
#define CACHE_DATA_SIZE   (1<<8) 
```

它在其余代码中用作整数。

这是什么意思？它的价值是什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-06-11T15:29:46.050

1 << 1 表示：

```
00000000 00000001 changes to 00000000 00000010 
```

1 << 8 表示：

```
00000000 00000001 changes to 00000001 00000000 
```

这是一个位移操作。对于右侧的每个 1，您可以将自己视为将左侧的值乘以 2。因此，2 << 1 = 4 和 2 << 2 = 8。这比 1 * 2 更有效。

此外，您可以将 4 >> 1 = 2 （并且 5 >> 1 = 2 因为您向下舍入）作为逆运算。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-11T15:29:08.540

`<<`如果您有 32 位整数，则按位左移（也有`>>`按位右移）

```
1      = 00000000 00000000 00000000 00000001 = 1
1 << 1 = 00000000 00000000 00000000 00000010 = 2
1 << 8 = 00000000 00000000 00000001 00000000 = 256 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-11T15:32:42.133

`a<<b`对于整数意味着“左移”。的按位表示`a`是左移位`b`。这与乘以 (2 的`b`) 的幂相同。

所以在你的例子中，`(1<<1)`is `1*(2^1)`is `2`，`(1<<8)`is `1*(2^8)`is `256`。

值得指出的是，一般来说，与 c++ 中的其他运算符一样，`<<`可能会被重写以执行其他功能。默认情况下，输入/输出流会覆盖此运算符，以便您编写简洁的代码以将一堆参数发送到流。所以你可能会看到这样的代码：

```
cout << something << somethingelse 
```

在这种情况下，`<<`并不*意味着*左移。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-11T15:27:22.597

这些是按位移位运算符。

[http://msdn.microsoft.com/en-us/library/336xbhcz(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/336xbhcz(v=vs.80).aspx)

<< 向左移动，因此对于 << 1 它实际上乘以 2，对于 << 8 乘以 2^8。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-11T15:28:49.363

该运算符`<<`是按位左移运算符。

因此，当您编写 时`1<<17`， 的二进制表示`1`将左移`17`一位，如下所示：

```
//before (assume 1 is represented by 32-bit)
1 << 17  
0000 0000 0000 0000 0000 0000 0000 0001 << 17 (before - binary representation)

//after
0000 0000 0000 0010 0000 0000 0000 0000       (after - binary representation) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-12T04:31:04.910

1<<8

这就是我的理解。以最通俗的方式，将其理解为二进制数系统中的 1 (00000001) 现在从之前的位置提升到 8 个位置（位），并且对于我们所知道的每个位置，它都会移动值（二进制中的 2）以指数方式相乘，因此变为 1*(2^8)=256。

所以 1<<6 将是 1*(2^6)= 64 等等

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2022-01-07T07:50:44.883

**a<<b** *表示* ***(a * pow(2,b))-> a * 2^b*** //***左筛选运算符 <<***

**a>>b** *表示* ***(a / pow(2,b))-> a / 2^b*** //***右筛选运算符 >>***

# c - C：数组初始化段错误取决于大小和对 printf() 的调用

> ID：10983084
> 
> 赞同：3
> 
> 时间：2012-06-11T15:25:26.323
> 
> 标签：c, arrays, segmentation-fault, printf

另一个学生问我他的 C 代码有什么问题。我成功地重现了错误行为，完全不知道为什么会出现这种段错误。考虑这个微型 C 程序：

```
#include <stdio.h>

int main(void) {
    int N = 590;
    double A[N][N];
    double B[N][N];
    double C[N][N];
    printf("done");
} 
```

*   设置`N`为 <= 590 的值：
    运行时不会出现错误，无论有无输出。
*   设置`N`为 > 590 的值：
    *   删除输出线后运行完美。
    *   编译并运行输出：*分段错误*

这是什么原因？谁能解释一下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T15:32:24.457

您的应用程序可用的堆栈数量非常依赖于系统，并且自动变量（例如您的双数组）会占用堆栈空间。调用函数需要额外的堆栈空间（用于其变量，以及诸如保存的寄存器和返回点之类的内务管理）。您正在离开堆栈的末尾并尝试访问您被禁止访问的内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T15:32:22.223

您尝试分配比堆栈上可用的内存更多的内存，这会导致**堆栈溢出**。`malloc`通常使用,`calloc`或动态分配像这样的巨大数组要好得多`realloc`。`free`当你完成它时，不要忘记通过调用来释放这个内存:)

这些问题也会对您有所帮助：
[C/C++ 程序的最大堆栈大小](https://stackoverflow.com/q/1825964/1168156)
[Segmentation Fault on create an array in C](https://stackoverflow.com/q/7541415/1168156)
[Segmentation Fault When Using Variable To Initiate Array](https://stackoverflow.com/q/7987672/1168156)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:32:29.693

你得到一个堆栈溢出。但是，无论是否`printf`使用 VC++，我都可以在这里重现它。我最好的猜测是，将参数推送到`printf`堆栈上的操作会导致错误出现。如果你调用一个不带参数的函数，它仍然会发生吗？

# jquery - jQuery 模式内的 jQuery ujs 不起作用

> ID：10983086
> 
> 赞同：0
> 
> 时间：2012-06-11T15:25:28.583
> 
> 标签：jquery, ruby-on-rails-3, jquery-ui

我在一个 jquery 对话框模式框中几乎都有不同控制器的所有表单，我遇到的问题是，当加载这些模式时，ujs 链接（数据远程、数据确认等）被完全忽略通过jQuery。我在想，当这些部分通过 ajax 加载时，事件不会冒泡以包含那些由 ajax 添加到 dom 的新链接。有没有人遇到过这个？我似乎无法找到解决方法。如果这不是很清楚，我可以发布一些代码......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T01:00:52.510

如果标记是动态添加的，那么事件只有在您使用事件委托时才会起作用。

这里有一篇很好的关于 jQuery 中事件委托的基础知识的文章 - [http://jqueryfordesigners.com/simple-use-of-event-delegation/](http://jqueryfordesigners.com/simple-use-of-event-delegation/)。基本上，您需要将通过创建的处理程序切换`bind`为使用`on`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:29:26.660

尝试将 ujs 的 init 移动到对话框上的 open 回调。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T17:09:34.630

好的，所以我用这个修复了它，使用自定义 jquery ui 对话框我现在可以在远程真实链接上进行自定义确认

```
var myCustomConfirmBox;
$.rails.allowAction = function(element) {
  var answer, callback, message;
  message = element.data("confirm");
  answer = false;
  callback = void 0;
  if (!message) {
    return true;
  }
  if ($.rails.fire(element, "confirm")) {
    myCustomConfirmBox(message, element);
  }
  return false;
};
myCustomConfirmBox = function(message, callback) {
  $("#dialog-confirm .content").html(message);
  return $("#dialog-confirm").dialog({
    resizable: false,
    height: 180,
    modal: true,
    buttons: {
    Continue: function() {
      $.rails.handleRemote(callback);
      return $(this).dialog("close");
    },
    Cancel: function() {
      return $(this).dialog("close");
    }
  }
});
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-27T12:49:37.173

我尝试了Magicmarkker的方法，只需在模态视图页面中添加版本化的js导入代码，就可以了，干杯！

```
 <script type="text/javascript" src="/assets/jquery_ujs.js?body=1"></script> 
```

# c# - 更新 asp.net 网格视图

> ID：10983087
> 
> 赞同：0
> 
> 时间：2012-06-11T15:25:35.030
> 
> 标签：c#, asp.net

我正在使用 asp.net 网格视图。

我调用一些 sql-server 存储过程和

将其附加到gridView：

```
 gvResults.DataSource = dr;
                    gvResults.DataBind(); 
```

我想让特定的列可编辑。

如何将更新 sp 附加到视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:34:14.047

为 gridview 尝试 Rowdatabound 的处理程序：

```
 protected void Gridview1_RowDataBound(object sender, GridViewRowEventArgs e)
{       
    try
    {
        HyperLink hlControl = new HyperLink();
        hlControl.Text = "Info";
        hlControl.NavigateUrl = e.Row.Cells[3].Text;
        e.Row.Cells[3].Controls.Add(hlControl);
    }
    catch
    {
    }
} 
```

我写这个是为了将特定列中数据源的响应更改为超链接控件，您可以对列执行任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:34:57.153

您可以使用更新命令

[http://msdn.microsoft.com/en-us/library/ms972948.aspx](http://msdn.microsoft.com/en-us/library/ms972948.aspx)

# asp.net - 带有 asp.net mvc 的 log4net - 无法查看文件的更改

> ID：10983088
> 
> 赞同：0
> 
> 时间：2012-06-11T15:25:35.660
> 
> 标签：asp.net, asp.net-mvc, logging, powershell, log4net

`get-content .\log.log -Wait`因此，在控制台 .Net 应用程序中，我可以使用类似于 linux命令的（powershell 命令）观看我的所有 log4net 事件流，`tail`并且我假设在后台使用 FileSystemWatcher。

出于某种原因，每当我有一个 asp.net Mvc 应用程序时，这都不起作用。需要明确的是，日志文件被写入。我可以`get-content .\log.log`根据需要多次获得最新结果，但是使用`-wait`参数我永远看不到更改滚动过去。

有人对这里可能发生的事情有任何见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T17:07:59.093

**更新：**为我的案例找到了一个可行的解决方案，不确定这是否会对您有所帮助。

我没有使用 PowerShell，而是下载[了 win-bash](http://sourceforge.net/projects/win-bash/)，现在我正在使用这个熟悉的 Unix 命令，它非常适合我。

```
tail -f access.log 
```

我对.Net 编程不太熟悉。在您的情况下，使用 win-bash 项目的 bash.exe 而不是 PowerShell 可能是一个可行的解决方案吗？

* * *

尝试在 PowerShell 中“跟踪”Apache 访问日志时遇到类似问题。

```
Get-Content .\access.log -Wait 
```

我注意到，当我的 Apache HTTP 服务器运行时，它有一个对 acccess.log 开放的句柄，并且 -Wait 不起作用。停止 HTTP 服务器会释放句柄，当我使用文本编辑器对 access.log 进行手动更改时，我的 PowerShell 窗口会立即在控制台中反映更改。

所以我假设如果其他程序有一个打开文件的句柄，更改不会反映到控制台。不幸的是，到目前为止我还没有找到解决这个问题的方法。

# ios - CoreAnimation 旋转一个对象并同时改变它的位置

> ID：10983091
> 
> 赞同：0
> 
> 时间：2012-06-11T15:25:43.460
> 
> 标签：ios, core-animation

我想要做的是左右旋转视图，同时上下移动它的位置。

这是我的代码：

```
CGAffineTransform leftWobble = CGAffineTransformRotate(CGAffineTransformIdentity, RADIANS(-12.0));
CGAffineTransform rightWobble = CGAffineTransformRotate(CGAffineTransformIdentity, RADIANS(12.0));

flyingGuy.transform = leftWobble;  // starting point

[UIView beginAnimations:@"wobble" context:flyingGuy];
[UIView setAnimationRepeatAutoreverses:YES];
[UIView setAnimationRepeatCount:1000];
[UIView setAnimationDuration:1.3];
[UIView setAnimationDelegate:self];
[UIView setAnimationDidStopSelector:@selector(wobbleEnded:finished:context:)];

flyingGuy.transform = rightWobble;
CGRect frame = flyingGuy.frame;
frame.origin.y += 10;
[flyingGuy setFrame:frame];

[UIView commitAnimations];

- (void)wobbleEnded:(NSString *)animationID finished:(NSNumber *)finished context:(void *)context  {
    if ([finished boolValue]) {
        UIView* item = (UIView *)context;
        item.transform = CGAffineTransformIdentity;
    }
} 
```

使用当前代码，视图大小会随着向上或向下移动而变化。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T15:27:38.087

*设置变换后不要*设置或获取帧！

从文档：

> **警告**如果该`transform`属性不是恒等变换，则该属性的值是未定义的，因此应该被忽略。

* * *

## 你应该做什么

更改`center`视图的属性。无论如何，您只是在更改位置，并且在应用了变换时这是安全的。

# ipad - iPad 摄像头是否可以在不显示摄像头馈送的情况下进行人脸检测？

> ID：10983095
> 
> 赞同：3
> 
> 时间：2012-06-11T15:26:00.950
> 
> 标签：ipad, ios5, face-detection, core-image

我正在创建一个将在公共信息亭中使用的 iPad 应用程序，并且正在使用不同的方式来了解用户何时存在、何时离开或新用户出现。因此，我想知道是否可以使用 iOS 5 Core Image 检测脚本来实现这一点，但我需要能够在不实际向用户显示的情况下使用相机供稿。这有可能吗？

# java - 添加 BigDecimal 以获得运行总计

> ID：10983096
> 
> 赞同：0
> 
> 时间：2012-06-11T15:26:05.133
> 
> 标签：java, numbers, bigdecimal, cumulative-sum

我想为您挑选有关 BigDecimal 的布赖恩。我有一个方法，它应该有一个累计到期总金额的方法。这里是：

```
private BigDecimal addUpTotal(BillRec bill, BigDecimal runningTotal) {
    BigDecimal result = new BigDecimal(0);

    if (bill.getBillInfo().getBillSummAmtSize() > 0) {
        for (int x = 0; x < bill.getBillInfo().getBillSummAmtSize(); x++) {
            if ("TotalAmtDue".equals(bill.getBillInfo().getBillSummAmt(x).getBillSummAmtCode().getCode().toString())) {
                result = runningTotal.add(bill.getBillInfo().getBillSummAmt(x).getAmt());                  
            }
        }
    }      
    return result;
} 
```

问题是我怎么称呼它？意思是当我调用它时，我如何跟踪总数？请注意，您可以看到我将 runningTotal 作为参数传递，但不确定如何将值保留在我将调用它的方法中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T15:31:33.287

我*怀疑*你的意思是这样的：

```
private BigDecimal addUpTotal(BillRec bill, BigDecimal runningTotal) {
    if (bill.getBillInfo().getBillSummAmtSize() > 0) {
        for (int x = 0; x < bill.getBillInfo().getBillSummAmtSize(); x++) {
            if (...) {
                runningTotal = runningTotal.add(...);
            }
        }
    }      
    return runningTotal;
} 
```

您可以使用局部变量来调用它来保持运行总数：

```
BigDecimal runningTotal = BigDecimal.ZERO;

for (BillRec bill : bills) {
    runningTotal = addUpTotal(bill, runningTotal);
} 
```

# web-applications - 黑莓应用程序如何向 BIS 和 BES 用户发送推送通知？

> ID：10983097
> 
> 赞同：1
> 
> 时间：2012-06-11T15:26:06.393
> 
> 标签：web-applications, blackberry, push-notification

几天来，我一直在努力整理我正在制作的移动应用程序的黑莓版本。尽管 BB 开发的其他部分一直令人沮丧，但没有什么能比得上实现推送通知。

我已经阅读了 RIM 提供的有关推送通知的所有 PDF 和其他文档页面，但似乎它们故意对所有重要细节含糊其辞。每个 PDF 中都有页面和页面试图在他们的 Push Plus 服务上向您推销，然后是关于实际重要细节的一两句话。我也看过他们很少的样本，但他们都是真的做作，并没有真正的帮助。

我无法得到答案的一个问题（在我看来这对于移动开发者来说是一个很常见的问题）是：

是否可以为黑莓编写一个公共应用程序——一个普通人的应用程序，而不是一些疯狂的公司特定的东西——BIS 和 BES（个人和公司）用户都可以安装和使用推送通知？

答案似乎是肯定的，Facebook 使用推送通知，我当然会假设这两种用户都可以使用 Facebook——但文档非常清楚你将如何制作一个可以向其发送通知的公共应用程序BES 用户。

如果可能的话，这是我必须解决的问题，所以如果这意味着我必须编写一些特殊的组件，我会这样做，但我什至不知道这是否可能。

我使用 Urban Airship 为 iOS 和 Android 做通知（到目前为止，两者的实现都比 BB 快 1000 倍），但他们的文档说他们不支持 BES 用户（根本）。

我一直希望找到一份神奇的文件，清楚地说明所有这些东西是如何工作的，但我认为它不存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T05:22:17.907

许多 BES 用户也有 BIS，因此使用标准的 BlackBerry 推送服务应该涵盖这两组用户。

要专门使用 BES 推送，我认为您需要为您想要使用的每个 BES 管理员设置代码——这不是一个站得住脚的方法。

# date - 批处理文件 - 计划运行与 cmd 运行 - 正确日期

> ID：10983100
> 
> 赞同：1
> 
> 时间：2012-06-11T15:26:26.200
> 
> 标签：date, batch-file

我在批处理文件中有以下几行：

```
@echo off 
echo Running dump...
"D:\wamp\bin\mysql\mysql5.5.16\bin\mysqldump" --host="localhost" --user="****" --password="****" database> "D:\wamp\backup\mysql\"back.%date:~0,2%.sql
echo Done! 
```

假设它应该创建一个今天的日期为01、02、03、...、31的备份文件，即

```
back.01.sql
back.02.sql
back.03.sql 
```

当我从 CMD 运行它时，它实际上按预期创建它，但是当它从调度程序运行时，它看起来像：

```
back.Mo.sql
back.Tu.sql
back.We.sql 
```

我应该使用什么日期格式来确保它实际上是用月份中的天数创建的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T15:55:28.360

在 Windows 批处理中处理日期和时间是一件痛苦的事情。

最强大的解决方案是使用 WMIC 获取本地日期和时间。它返回以下格式的值：

```
YYYYMMDDhhmmss.dddddd-ttt

YYYY   = year
MM     = month
DD     = day
hh     = hour in 24 hour format
mm     = minutes
ss     = seconds
dddddd = fractional seconds
ttt    = time zone (minutes difference from Greenwich Mean Time) 
```

*因此，您可以使用以下内容在变量Edit*中获取当前日期 - 更正了从 7 到 6 的起始子字符串位置

 *```
set curDate=
for /f "skip=1" %%x in ('wmic os get localdatetime') do if not defined curDate set curDate=%%x
set day=%curDate:~6,2% 
```

这种技术的一大优势是它可以在世界上的任何 Windows 机器上工作，无论区域设置如何。

* * *

这是插入技术的代码
*编辑 - 更正了从 7 到 6 的起始子字符串位置*

```
@echo off
echo Running dump...
set curDate=
for /f "skip=1" %%x in ('wmic os get localdatetime') do if not defined curDate set curDate=%%x
set "day=%curDate:~6,2%"
"D:\wamp\bin\mysql\mysql5.5.16\bin\mysqldump" --host="localhost" --user="****" --password="****" database> "D:\wamp\backup\mysql\back.%day%.sql"
echo Done! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:59:48.703

`dd.MM.yyyy`只需为运行任务的帐户设置区域设置。（至少使用 Windows XP 的控制面板或注册表 HKCU\Control Panel\International\sShortDate。*

# android - Android - Bing Maps API 演示在执行时崩溃

> ID：10983101
> 
> 赞同：0
> 
> 时间：2012-06-11T15:26:29.547
> 
> 标签：android, crash, bing-maps

我正在尝试学习使用适用于 Android 的 Bing Maps API。我从 CodePlex 站点下载了 SDK，但是当我尝试在我的 Eclipse 模拟器上运行它时，该应用程序似乎崩溃了。我根本没有接触过代码，所以我想知道在安装/下载中是否遗漏了一个步骤或其他什么。

这是我的 LogCat。

```
06-11 15:26:27.760: D/dalvikvm(5092): GC_EXTERNAL_ALLOC freed 5K, 51% free 2675K/5379K, external 1800K/2127K, paused 15ms
06-11 15:26:27.810: W/webcore(5092): Can't get the viewWidth after the first layout
06-11 15:26:27.840: D/gralloc_goldfish(5092): Emulator without GPU emulation detected.
06-11 15:26:28.100: W/dalvikvm(5092): JNI WARNING: jarray 0xb6ceee40 points to non-array object (Ljava/lang/String;)
06-11 15:26:28.100: I/dalvikvm(5092): "WebViewCoreThread" prio=5 tid=8 NATIVE
06-11 15:26:28.100: I/dalvikvm(5092):   | group="main" sCount=0 dsCount=0 obj=0xb6c70ac8 self=0x8ea4588
06-11 15:26:28.100: I/dalvikvm(5092):   | sysTid=5101 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=149572152
06-11 15:26:28.100: I/dalvikvm(5092):   at android.webkit.JWebCoreJavaBridge.sharedTimerFired(Native Method)
06-11 15:26:28.100: I/dalvikvm(5092):   at android.webkit.JWebCoreJavaBridge.sharedTimerFired(Native Method)
06-11 15:26:28.100: I/dalvikvm(5092):   at android.webkit.JWebCoreJavaBridge.fireSharedTimer(JWebCoreJavaBridge.java:91)
06-11 15:26:28.100: I/dalvikvm(5092):   at android.webkit.JWebCoreJavaBridge.handleMessage(JWebCoreJavaBridge.java:108)
06-11 15:26:28.100: I/dalvikvm(5092):   at android.os.Handler.dispatchMessage(Handler.java:99)
06-11 15:26:28.100: I/dalvikvm(5092):   at android.os.Looper.loop(Looper.java:130)
06-11 15:26:28.100: I/dalvikvm(5092):   at android.webkit.WebViewCore$WebCoreThread.run(WebViewCore.java:629)
06-11 15:26:28.100: I/dalvikvm(5092):   at java.lang.Thread.run(Thread.java:1019)
06-11 15:26:28.100: E/dalvikvm(5092): VM aborting 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:42:40.997

> 没有检测到 GPU 仿真的仿真器。

在模拟器中添加 GPU 仿真。打开 AVD 管理器 > 选择模拟器 > 编辑 > 硬件部分 > 新建 > GPU 仿真 > 设置为是

[http://developer.android.com/guide/developing/devices/emulator.html#accel-graphics](http://developer.android.com/guide/developing/devices/emulator.html#accel-graphics)

# c# - Appdomain 刷新/重启

> ID：10983102
> 
> 赞同：2
> 
> 时间：2012-06-11T15:26:29.913
> 
> 标签：c#, .net

我正在编写一个 web 服务并有以下观察结果：即使我只是将一个文本文件添加到存储 web 服务引用的所有 dll 的目录 (bin) 中，appdomain 也会刷新。

这会导致存储在字典（在其中一个 dll 中）中的所有用户会话被删除。

例如，如果上面的字典包含在一个 dll 中，比如 sessiondict.dll，而我正在用 sessiondict.dll 替换另一个没有任何依赖关系的 dll，那么为什么要丢失这些数据呢？

我错过了什么吗？

**编辑：**

虽然我正在阅读更多关于 AppDomain 重启的信息，但是，我还没有弄清楚为什么设计是这样的，即使在 bin 文件夹中添加一个文本文件也会导致 appdomain 重启。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T15:46:47.437

这是标准行为 - 任何时候 bin 目录中的任何内容（以及 web.config 等其他位置）被触及，那么您的 appdomain 将被回收。

您不应该将数据存储在 bin 目录中。您还应该知道，IIS 默认情况下会定期回收 appdomain，除非您告诉它不要这样做（我相信默认情况下每天一次）。

由于无论如何您都无法替换应用程序的一部分，因此我不确定这样做的正当理由是什么？

[这篇文章](http://blogs.msdn.com/b/tess/archive/2006/08/02/asp-net-case-study-lost-session-variables-and-appdomain-recycles.aspx)很好地解释了可能导致 AppDomain 回收的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:56:50.250

`Dictionary`存储在 App 域内存中的局部变量中。当 bin 文件夹中的内容更新时，AppDomain 将被回收。回收意味着 .NET 卸载现有的 AppDomain（擦除存储在所有加载的类中的所有本地变量使用的内存）并构造新的 AppDomain 并启动新的类（这可能会`Dictionary`在您的代码中创建一个空）。

DLL是否更改都没有关系。的实例`Class`被破坏，因为 ASP.NET 认为 bin 文件夹中的任何更改都会影响配置，并且应该使用新配置重新启动站点。

要解决此问题，您可以：

1.  将关键的 Session 变量存储在持久存储中（首选）
2.  不要更新 BIN 文件夹的内容。

# java - 这个工具应该采用哪种模式？

> ID：10983105
> 
> 赞同：1
> 
> 时间：2012-06-11T15:26:36.393
> 
> 标签：java, spring, design-patterns, implementation

我正在覆盖 Spring 的 MessageSource 以从数据库（当前 SQLite）获取消息源。

正如您在 CachedMessageSourceDao.java (Subject) 中看到的，每当 insertMessage 调用 CachedMessageSource.java(Observer) 时都会收到通知。因为它是观察者模式！！

除了初始化 CachedMessageSourceDao.java （主题）之外，所有工作正常。

DualKeyMap MESSAGES <--即使一开始没有通知，也应该填写。

但我不知道如何实现。你能告诉我哪种设计模式应该适用于此吗？

* * *

**应用程序上下文.xml**

```
<bean id="cachedMessageSourceDao" class="org.springframework.context.support.CachedMessageSourceDao">
        <constructor-arg name ="dataSource" ref="dataSource" />
        <constructor-arg name="DATABASE" value="BytoCms"/>
        <constructor-arg name="TABLE" value="MessageSource"/>
        <constructor-arg name="USE" value="1" type="int"/>
        <constructor-arg name="NOT_IN_USE" value="0" type="int"/>
        <constructor-arg name="ALL" value="99" type="int"/>
        <constructor-arg name="messageSource" ref="messageSource" />
    </bean>

    <bean id="messageSource" class="org.springframework.context.support.CachedMessageSource" /> 
```

* * *

**CachedMessageSource.java（观察者）**

```
public class CachedMessageSource implements MessageSource, Observer {

    /** Message Storage */
    private static DualKeyMap<String, Locale, String> MESSAGES;

    ...more

@Override
public void update(Observable o, Object arg) {
    try {
        MESSAGES = ((CachedMessageSourceDao) o).selectAllMessages();
    } catch (SQLException e) {
        System.out.println("Message Initializing Failed");
        e.printStackTrace();
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

* * *

**CachedMessageSourceDao.java（主题）**

```
public class CachedMessageSourceDao extends Observable {
    private DataSource dataSource;
    private String DATABASE;
    private String TABLE;
    private int USE;
    private int NOT_IN_USE;
    private int ALL;

    public CachedMessageSourceDao(
            DataSource dataSource, 
            String DATABASE, 
            String TABLE,
            int USE,
            int NOT_IN_USE,
            int ALL,
            CachedMessageSource messageSource) {

        this.dataSource = dataSource;
        this.DATABASE = DATABASE;
        this.TABLE = TABLE;
        this.USE = USE;
        this.ALL = ALL;
        this.NOT_IN_USE = NOT_IN_USE;

        addObserver(messageSource); //★add Observer★
        notifyObservers(); //★This for initializing★
    }

    ...more

    public synchronized void insertMessage(String code, String value, String language) throws Exception {
        //Duplicate Message Check
        if(selectMessage(code, language) != null) throw new SQLException("Duplicate message exists for code: " + code + " and" + "language: " + language);

        String sql = "INSERT INTO " + TABLE + " (code, value, language, flag) values (?, ?, ?, " + USE + ")";

        Connection conn = null;
        PreparedStatement pstmt = null;

        try {
            conn = dataSource.getConnection();
            conn.setAutoCommit(true);
            pstmt = conn.prepareStatement(sql);
            pstmt.setString(1, code);
            pstmt.setString(2, value);
            pstmt.setString(3, language);
            pstmt.execute();

        } catch(SQLException ex) {

            ex.printStackTrace();

        } finally {

            try {

                if(pstmt != null) pstmt.close();
                if(conn != null) conn.close();

            } catch (SQLException e) {

                e.printStackTrace();

            }

        }
        notifyObservers(); //Realtime apply to MessageSource
    } 
```

# asp.net - 以特定用户身份从 ASP.NET 项目调用 COM DLL 函数

> ID：10983108
> 
> 赞同：2
> 
> 时间：2012-06-11T15:26:47.060
> 
> 标签：asp.net, iis, dll, windows-authentication

我正在尝试从 ASP.NET 项目中调用旧的 VB6 dll（没有可用的源代码）。dll 使用 Windows 身份验证连接到服务器，因此我需要以特定用户的身份调用函数，而不是现在的 NETWORKSERVICE。

这最好在调用时确定，而不是在加载时确定，因为我正在模拟远程用户，并希望这是调用函数的用户，而不是应用程序用户，而不是现在的 NETWORKSERVICE。

因此，浏览器以 USER 身份运行，连接到模拟 USER 的应用程序，以 USER 身份调用 dll，但 dll 试图以 NETWORKSERVICE 而不是 USER 身份连接到远程服务器。

是否可以让这个 dll 以 USER 身份连接到远程服务器？或者，如果没有别的，以应用程序用户身份连接？

编辑：
通过调用`Impersonate()`远程用户的`WindowsIdentity`. 我工作的公司有一个习惯`SecurityPrincipal`，`SecurityIdentity`所以我必须如何去获得它有点奇怪`WindowsIdentity`（它比 更深入一点`User.Identity`），但我之前成功地使用过这种方法，并且`System.Security.Principal.WindowsIdentity.GetCurrent().Name` 在冒充。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T23:19:34.590

我会首先尝试找出 DLL 如何以不同的用户身份连接（[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)可以帮助解决这个问题）。DLL 是否可能与在以 NETWORKSERVICE 登录的机器上运行的服务（或其他进程）通信？如果是这样，您可以[将该服务更改为以其他用户身份运行](https://stackoverflow.com/questions/178633/minimum-rights-required-to-run-a-windows-service-as-a-domain-account)。只是抓住稻草，希望你能解决！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T19:10:56.673

我最终确实找到了问题（这只会导致其他问题，但无论如何）结果是我`AspCompat="true"`在我的页面上丢失了一个。实际上问题是我使用的是“处理程序”而不是“页面”。处理程序没有 Pages 所具有的 STA 能力。发生的事情是每次我尝试访问 COM 组件时，都会发生线程切换（模拟丢失），因为应用程序在 MTA 中运行并且 COM 组件必须在 STA 中运行。

# c# - A-Star (A*) 和通用查找方法

> ID：10983110
> 
> 赞同：3
> 
> 时间：2012-06-11T15:26:59.087
> 
> 标签：c#, generics, point, a-star

我无法有效地实现 Eric Lippert 推荐的这种通用方法。他的博客概述了一种非常简单有效的创建 A Star 算法的方法（[可在此处找到](http://blogs.msdn.com/b/ericlippert/archive/2007/10/02/path-finding-using-a-in-c-3-0.aspx)）。这是快速运行。

实际路径查找的代码：

```
class Path<Node> : IEnumerable<Node>
{
    public Node LastStep { get; private set; }
    public Path<Node> PreviousSteps { get; private set; }
    public double TotalCost { get; private set; }
    private Path(Node lastStep, Path<Node> previousSteps, double totalCost)
    {
        LastStep = lastStep;
        PreviousSteps = previousSteps;
        TotalCost = totalCost;
    }
    public Path(Node start) : this(start, null, 0) { }
    public Path<Node> AddStep(Node step, double stepCost)
    {
        return new Path<Node>(step, this, TotalCost + stepCost);
    }
    public IEnumerator<Node> GetEnumerator()
    {
        for (Path<Node> p = this; p != null; p = p.PreviousSteps)
            yield return p.LastStep;
    }
    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
}

class AStar
{

    static public Path<Node> FindPath<Node>(
        Node start,
        Node destination,
        Func<Node, Node, double> distance,
        Func<Node, double> estimate)
        where Node : IHasNeighbours<Node>
    {
        var closed = new HashSet<Node>();
        var queue = new PriorityQueue<double, Path<Node>>();
        queue.Enqueue(0, new Path<Node>(start));
        while (!queue.IsEmpty)
        {
            var path = queue.Dequeue();
            if (closed.Contains(path.LastStep))
                continue;
            if (path.LastStep.Equals(destination))
                return path;
            closed.Add(path.LastStep);
            foreach (Node n in path.LastStep.Neighbours)
            {
                double d = distance(path.LastStep, n);
                if (n.Equals(destination))
                    d = 0;
                var newPath = path.AddStep(n, d);
                queue.Enqueue(newPath.TotalCost + estimate(n), newPath);
            }
        }
        return null;
    }

    /// <summary>
    /// Finds the distance between two points on a 2D surface.
    /// </summary>
    /// <param name="x1">The IntPoint on the x-axis of the first IntPoint</param>
    /// <param name="x2">The IntPoint on the x-axis of the second IntPoint</param>
    /// <param name="y1">The IntPoint on the y-axis of the first IntPoint</param>
    /// <param name="y2">The IntPoint on the y-axis of the second IntPoint</param>
    /// <returns></returns>
    public static long Distance2D(long x1, long y1, long x2, long y2)
    {
        //     ______________________
        //d = &#8730; (x2-x1)^2 + (y2-y1)^2
        //

        //Our end result
        long result = 0;
        //Take x2-x1, then square it
        double part1 = Math.Pow((x2 - x1), 2);
        //Take y2-y1, then sqaure it
        double part2 = Math.Pow((y2 - y1), 2);
        //Add both of the parts together
        double underRadical = part1 + part2;
        //Get the square root of the parts
        result = (long)Math.Sqrt(underRadical);
        //Return our result
        return result;
    }

    /// <summary>
    /// Finds the distance between two points on a 2D surface.
    /// </summary>
    /// <param name="x1">The IntPoint on the x-axis of the first IntPoint</param>
    /// <param name="x2">The IntPoint on the x-axis of the second IntPoint</param>
    /// <param name="y1">The IntPoint on the y-axis of the first IntPoint</param>
    /// <param name="y2">The IntPoint on the y-axis of the second IntPoint</param>
    /// <returns></returns>
    public static int Distance2D(int x1, int y1, int x2, int y2)
    {
        //     ______________________
        //d = &#8730; (x2-x1)^2 + (y2-y1)^2
        //

        //Our end result
        int result = 0;
        //Take x2-x1, then square it
        double part1 = Math.Pow((x2 - x1), 2);
        //Take y2-y1, then sqaure it
        double part2 = Math.Pow((y2 - y1), 2);
        //Add both of the parts together
        double underRadical = part1 + part2;
        //Get the square root of the parts
        result = (int)Math.Sqrt(underRadical);
        //Return our result
        return result;
    }

    public static long Distance2D(Point one, Point two)
    {
        return AStar.Distance2D(one.X, one.Y, two.X, two.Y);
    }
} 
```

优先队列代码：

```
class PriorityQueue<P, V>
{
    private SortedDictionary<P, Queue<V>> list = new SortedDictionary<P, Queue<V>>();
    public void Enqueue(P priority, V value)
    {
        Queue<V> q;
        if (!list.TryGetValue(priority, out q))
        {
            q = new Queue<V>();
            list.Add(priority, q);
        }
        q.Enqueue(value);
    }
    public V Dequeue()
    {
        // will throw if there isn’t any first element!
        var pair = list.First();
        var v = pair.Value.Dequeue();
        if (pair.Value.Count == 0) // nothing left of the top priority.
            list.Remove(pair.Key);
        return v;
    }
    public bool IsEmpty
    {
        get { return !list.Any(); }
    }
} 
```

**以及获取附近节点的接口：**

```
interface IHasNeighbours<N>
{
    IEnumerable<N> Neighbours { get; }
} 
```

这是我无法有效实施的部分。我可以创建一个能够被路径查找使用的类，但是查找附近的节点变得很痛苦。本质上，我最终要做的是创建一个类，在这种情况下，它被视为单个图块。但是，为了获取所有附近的节点，我必须将一个值传递给该图块，其中包含所有其他图块的列表。这非常麻烦，让我相信一定有更简单的方法。

这是我使用 System.Drawing.Point 包装器的实现：

```
class TDGrid : IHasNeighbours<TDGrid>, IEquatable<TDGrid>
{
    public Point GridPoint;
    public List<Point> _InvalidPoints = new List<Point>();
    public Size _GridSize = new Size();
    public int _GridTileSize = 50;

    public TDGrid(Point p, List<Point> invalidPoints, Size gridSize)
    {
        GridPoint = p;
        _InvalidPoints = invalidPoints;
        _GridSize = gridSize;
    }

    public TDGrid Up(int gridSize)
    {
        return new TDGrid(new Point(GridPoint.X, GridPoint.Y - gridSize));
    }
    public TDGrid Down(int gridSize)
    {
        return new TDGrid(new Point(GridPoint.X, GridPoint.Y + gridSize));
    }
    public TDGrid Left(int gridSize)
    {
        return new TDGrid(new Point(GridPoint.X - gridSize, GridPoint.Y));
    }
    public TDGrid Right(int gridSize)
    {
        return new TDGrid(new Point(GridPoint.X + gridSize, GridPoint.Y));
    }

    public IEnumerable<TDGrid> IHasNeighbours<TDGrid>.Neighbours
    {
        get { return GetNeighbours(this); }
    }

    private List<TDGrid> GetNeighbours(TDGrid gridPoint)
    {
        List<TDGrid> retList = new List<TDGrid>();
        if (IsGridSpotAvailable(gridPoint.Up(_GridTileSize)))
            retList.Add(gridPoint.Up(_GridTileSize)); ;
        if (IsGridSpotAvailable(gridPoint.Down(_GridTileSize)))
            retList.Add(gridPoint.Down(_GridTileSize));
        if (IsGridSpotAvailable(gridPoint.Left(_GridTileSize)))
            retList.Add(gridPoint.Left(_GridTileSize));
        if (IsGridSpotAvailable(gridPoint.Right(_GridTileSize)))
            retList.Add(gridPoint.Right(_GridTileSize));
        return retList;
    }

    public bool IsGridSpotAvailable(TDGrid gridPoint)
    {
        if (_InvalidPoints.Contains(gridPoint.GridPoint))
            return false;

        if (gridPoint.GridPoint.X < 0 || gridPoint.GridPoint.X > _GridSize.Width)
            return false;
        if (gridPoint.GridPoint.Y < 0 || gridPoint.GridPoint.Y > _GridSize.Height)
            return false;

        return true;
    }

    public override int GetHashCode()
    {
        return GridPoint.GetHashCode();
    }

    public override bool Equals(object obj)
    {
        return this.GridPoint == (obj as TDGrid).GridPoint;
    }

    public bool Equals(TDGrid other)
    {
        return this.GridPoint == other.GridPoint;
    }
} 
```

List _InvalidPoints 是我失败的地方。我可以将它传递给每个创建的 TDGrid，但考虑到所有其余代码的简单程度，这似乎是一种巨大的资源浪费。我知道这是我缺乏知识，但我无法搜索它。

必须有另一种实现方式：

```
interface IHasNeighbours<N>
{
    IEnumerable<N> Neighbours { get; }
} 
```

有人对此有任何想法吗？

编辑——这是路径查找代码：

```
 public void FindPath(TDGrid start, TDGrid end)
    {
        AStar.FindPath<TDGrid>(start, end, (p1, p2) => { return AStar.Distance2D(p1.GridPoint, p2.GridPoint); }, (p1) => { return AStar.Distance2D(p1.GridPoint, end.GridPoint); });
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T21:53:13.130

听起来您在这里有两个不同的问题。您需要表示节点和节点本身之间的路径。您可能会发现分别表示这两个概念最容易。

例如，在下面的代码中，Grid 类跟踪节点的连接方式。这可以像存储作为墙壁（即被阻挡）的瓷砖的散列集一样简单。要确定一个节点是否可达，请检查它是否在哈希集中。这只是一个简单的例子。还有许多其他方式可以表示图表，请参阅[Wikipedia](https://en.wikipedia.org/wiki/Graph_%28data_structure%29)。

单个节点可以表示为 Grid 上的两个坐标，只需要三个值：行、列和 Grid 本身。这允许动态创建每个单独的节点（[享元模式](https://en.wikipedia.org/wiki/Flyweight_pattern)）。

希望有帮助！

```
class Grid
{
    readonly int _rowCount;
    readonly int _columnCount;

    // Insert data for master list of obstructed cells
    // or master list of unobstructed cells

    public Node GetNode(int row, int column)
    {
        if (IsOnGrid(row, column) && !IsObstructed(row, column))
        {
            return new Node(this, row, column);
        }

        return null;
    }

    private bool IsOnGrid(int row, int column)
    {
        return row >= 0 && row < _rowCount && column >= 0 && column < _columnCount;
    }

    private bool IsObstructed(int row, int column)
    {
        // Insert code to check whether specified row and column is obstructed
    }
}

class Node : IHasNeighbours<Node>
{
    readonly Grid _grid;
    readonly int _row;
    readonly int _column;

    public Node(Grid grid, int row, int column)
    {
        _grid = grid;
        _row = row;
        _column = column;
    }

    public Node Up
    {
        get
        {
            return _grid.GetNode(_row - 1, _column);
        }
    }

    public Node Down
    {
        get
        {
            return _grid.GetNode(_row + 1,_column);
        }
    }

    public Node Left
    {
        get
        {
            return _grid.GetNode(_row, _column - 1);
        }
    }

    public Node Right
    {
        get
        {
            return _grid.GetNode(_row, _column + 1);
        }
    }

    public IEnumerable<Node> Neighbours
    {
        get
        {
            Node[] neighbors = new Node[] {Up, Down, Left, Right};
            foreach (Node neighbor in neighbors)
            {
                if (neighbor != null)
                {
                    yield return neighbor;
                }
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T16:36:51.983

这是我最终使用的实现，与 Special Touch 的解决方案非常相似。SpacialObject 是一个点。

```
public class Tile : SpacialObject, IHasNeighbours<Tile>
{
    public Tile(int x, int y)
        : base(x, y)
    {
        CanPass = true;
    }

    public bool CanPass { get; set; }

    public Point GetLocation(int gridSize)
    {
        return new Point(this.X * gridSize, this.Y * gridSize);
    }

    public IEnumerable<Tile> AllNeighbours { get; set; }
    public IEnumerable<Tile> Neighbours { get { return AllNeighbours.Where(o => o.CanPass); } }

    public void FindNeighbours(Tile[,] gameBoard)
    {
        var neighbours = new List<Tile>();

        var possibleExits = X % 2 == 0 ? EvenNeighbours : OddNeighbours;
        possibleExits = GetNeighbours;

        foreach (var vector in possibleExits)
        {
            var neighbourX = X + vector.X;
            var neighbourY = Y + vector.Y;

            if (neighbourX >= 0 && neighbourX < gameBoard.GetLength(0) && neighbourY >= 0 && neighbourY < gameBoard.GetLength(1))
                neighbours.Add(gameBoard[neighbourX, neighbourY]);
        }

        AllNeighbours = neighbours;
    }

    public static List<Point> GetNeighbours
    {
        get
        {
            return new List<Point>
            {
                new Point(0, 1),
                new Point(1, 0),
                new Point(0, -1),
                new Point(-1, 0),
            };
        }
    }

    public static List<Point> EvenNeighbours
    {
        get
        {
            return new List<Point>
            {
                new Point(0, 1),
                new Point(1, 1),
                new Point(1, 0),
                new Point(0, -1),
                new Point(-1, 0),
                new Point(-1, 1),
            };
        }
    }

    public static List<Point> OddNeighbours
    {
        get
        {
            return new List<Point>
            {
                new Point(0, 1),
                new Point(1, 0),
                new Point(1, -1),
                new Point(0, -1),
                new Point(-1, 0),
                new Point(-1, -1),
            };
        }
    }
} 
```

然后在我使用的主程序中：

```
 private void InitialiseGameBoard()
    {
        GameBoard = new Tile[_Width, _Height];

        for (var x = 0; x < _Width; x++)
        {
            for (var y = 0; y < _Height; y++)
            {
                GameBoard[x, y] = new Tile(x, y);
            }
        }

        AllTiles.ToList().ForEach(o => o.FindNeighbours(GameBoard));

        int startX = 0, endX = GameBoard.GetLength(0) - 1;
        int startEndY = GameBoard.GetLength(1) / 2;
        _StartGridPoint = new Point(startX, startEndY);
        _EndGridPoint = new Point(endX, startEndY);
        //GameBoard[startX, startEndY].CanPass = false;
        //GameBoard[endX, startEndY].CanPass = false;
    }

    private void BlockOutTiles()
    {
        GameBoard[2, 5].CanPass = false;
        GameBoard[2, 4].CanPass = false;
        GameBoard[2, 2].CanPass = false;
        GameBoard[3, 2].CanPass = false;
        GameBoard[4, 5].CanPass = false;
        GameBoard[5, 5].CanPass = false;
        GameBoard[5, 3].CanPass = false;
        GameBoard[5, 2].CanPass = false;
    }

    public IEnumerable<Tile> AllTiles
    {
        get
        {
            for (var x = 0; x < _Width; x++)
                for (var y = 0; y < _Height; y++)
                    yield return GameBoard[x, y];
        }
    } 
```

# java - 带有小程序的 Java ProcessBuilder

> ID：10983113
> 
> 赞同：0
> 
> 时间：2012-06-11T15:27:15.590
> 
> 标签：java, applet, processbuilder

我正在尝试构建一个小程序，它在[JAR](http://en.wikipedia.org/wiki/JAR_file)文件所在的服务器上启动进程构建器，而不是在运行浏览器的本地计算机上。我环顾四周，似乎找不到我想要的东西......

```
ProcessBuilder builder = new ProcessBuilder(command);
builder.redirectErrorStream(true);
builder.directory(new File("////server.IP//")); 
```

我知道这不起作用，但这是我想做的一个例子。有没有办法做到这一点？它会使客户端-服务器应用程序变得更好，并从客户端发送命令吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:36:38.760

你做错了。如果要在客户端/服务器之间传输消息，则可能需要 JMS。或者你可以尝试使用 web 服务来做到这一点。

# asp.net-mvc-3 - MVC 3 Razor-模型的部分验证

> ID：10983118
> 
> 赞同：0
> 
> 时间：2012-06-11T15:27:29.750
> 
> 标签：asp.net-mvc-3, razor, validation, entity-framework-mapping

我目前正在 MVC 3 中的一个项目中工作，我正在利用实体框架将一个数据模型保存在两个视图上，每个视图都包含一个 HTML 表单（类似于基于向导的设计）。

然而，在用户在第一个 View 上填写适当的字段并提交表单后，整个模型的客户端验证被触发，并且在第二个 View 实例化之前甚至无法输入的字段显示验证错误。

我目前已经实现了一种解决方法，我只是完全关闭了第一个视图的客户端验证，但我当然不热衷于用根本没有经过验证的数据填充我的模型的想法。这是不好的。好吧。

有没有办法部分验证第一个视图上的字段而不触发整个数据模型的验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T14:42:20.943

感谢大家的输入。但是，我能够以非常简单的方式获得解决方案。通过将以下代码放在第一个视图的 HttpPost 元素中...

`if (ModelState.IsValidField("FirstField") && ModelState.IsValidField("SecondField")) return RedirectToAction ("NameOfAction", model); else return View();`

...我能够实现部分现场验证。但是，这种特定于字段的方法仅适用于第一个视图上的提交按钮具有“取消”类并且生成的附加验证错误（对于第一个视图上不存在的字段）在上述操作之前手动清除if 语句。为此，请使用：

```
ModelState["FieldName"].Errors.Clear(); 
```

架构没有重大变化。没有部分意见。不移交未经验证的数据。

效果很好...

注意：如果第二个视图加载时出现验证错误，请使用：

`ModelState.Clear();`

在最初调用第二个视图的操作中。这将使第二个视图加载干净且无错误，同时在最终表单提交后仍显示验证错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:36:32.717

这就是 ViewModel 的用武之地。您应该在它们之上创建视图模型并绑定到视图，而不是直接将域模型与视图绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:03:15.520

如果您不需要直接对 EF 模型进行验证，则可以根据需要使用[MetadataType](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.metadatatypeattribute.aspx)进行部分验证。看看我[在 stackoverflow 上的长示例](https://stackoverflow.com/questions/8157889/asp-net-mvc-3-model-validation/8158716#8158716)。

# objective-c - 映射核心数据关系的正确方法

> ID：10983119
> 
> 赞同：0
> 
> 时间：2012-06-11T15:27:35.393
> 
> 标签：objective-c, ios, core-data

我有两个对象需要在 Core Data 中创建关系。我不确定如何建立关系。当我尝试然后运行我的应用程序时，它会永远循环并崩溃（猜测循环引用）。

主对象.h

```
NSString *userId;
NSString *thing;
NSString *descr;
NSString *title; 
```

authObject.h

```
NSString *userId;
BOOL     alive;
BOOL     authCode; 
```

如何在 CD 中设置这种关系？mainObject 可以有多个 authObject。如何在 CD 中将两个对象上的 userId 相互关联？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T13:21:06.397

我正在使用restkit，我的场景与[此相同](https://stackoverflow.com/questions/9318565/restkit-object-mapping-relationships-without%E2%80%8C%E2%80%8B-kvc/9318745#9318745)

至于 CoreData 方面，我通过阅读那篇文章并填补空白找到了答案。主要是，我说得很对，但那篇文章证实了我的怀疑。

不知道如何将此标记为已回答。

# android - cancelDiscovery 一直返回 false

> ID：10983120
> 
> 赞同：1
> 
> 时间：2012-06-11T15:27:35.753
> 
> 标签：android, bluetooth

我找到所有可用的蓝牙设备，然后当用户单击列表中的一个元素时，我想将我的设备与所选地址配对，并取消发现。但是，我对蓝牙适配器的 cancelDiscovery() 调用总是返回 false。在 android 文档中，它说适配器必须处于 STATE_ON 才能使 cancelDiscovery() 返回 true。但是，当我调用 btAdapter.getState() 时，它返回值 12，即 STATE_ON。我的代码在下面，有人知道还有什么问题吗？

当当前状态为 STATE_ON 时，我不明白 cancelDiscovery() 如何返回 false。文档说，如果状态为 STATE_ON，它应该返回 true，而对于所有其他值，它应该返回 false。

```
 private static final UUID MY_UUID = UUID.randomUUID();

private static final int REQUEST_ENABLE_BT = 1;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    btnScanDevice = (Button) findViewById( R.id.scandevice );

    stateBluetooth = (TextView) findViewById( R.id.bluetoothstate );
    startBluetooth();

    listDevicesFound = (ListView) findViewById( R.id.devicesfound );
    btArrayAdapter = new ArrayAdapter<String>( AndroidBluetooth.this,
            android.R.layout.simple_list_item_1 );
    listDevicesFound.setAdapter( btArrayAdapter );

    CheckBlueToothState();

    btnScanDevice.setOnClickListener( btnScanDeviceOnClickListener );

    registerReceiver( ActionFoundReceiver, new IntentFilter( BluetoothDevice.ACTION_FOUND ) );

    listDevicesFound.setOnItemClickListener( new OnItemClickListener()
    {
      public void onItemClick(AdapterView<?> arg0, View arg1,int arg2, long arg3) 
      {
          Log.i("Discovery: ", Integer.toString( myBtAdapter.getState() ) );
          boolean success = myBtAdapter.cancelDiscovery();
          myBtDevice = btDevicesFound.get( arg2 );
          try {
              btSocket = myBtDevice.createRfcommSocketToServiceRecord( MY_UUID );
              iStream = btSocket.getInputStream();
              oStream = btSocket.getOutputStream();
          } catch ( IOException e ) {
              Log.e( "Bluetooth Socket", "Bluetooth not available, or insufficient permissions" );
          } catch ( NullPointerException e ) {
              Log.e( "Bluetooth Socket", "Null Pointer One" );
          }
          CheckBlueToothState();
          try {
              btSocket.connect();
          } catch ( IOException e ) {
              Log.e( "Bluetooth Socket", "Problems arose while attempting to connect." );
          } catch ( NullPointerException e ) {
              Log.e( "Bluetooth Socket", "Null Pointer Two" );
          }
      }

  });
}

private void CheckBlueToothState() {
    if( myBtAdapter == null ) {
        stateBluetooth.setText("Bluetooth NOT supported" );
    } else {
        if( myBtAdapter.isEnabled() ) {
            if( myBtAdapter.isDiscovering() ) {
                stateBluetooth.setText( "Bluetooth is currently " +
                        "in device discovery process." );
            } else {
                stateBluetooth.setText( "Bluetooth is Enabled." );
                btnScanDevice.setEnabled( true );
            }
        } else {
            stateBluetooth.setText( "Bluetooth is NOT enabled" );
            Intent enableBtIntent = new Intent( BluetoothAdapter.ACTION_REQUEST_ENABLE );
            startActivityForResult( enableBtIntent, REQUEST_ENABLE_BT );
        }
    }
}

private Button.OnClickListener btnScanDeviceOnClickListener = new Button.OnClickListener() {
    public void onClick( View arg0 ) {
        btArrayAdapter.clear();
        myBtAdapter.startDiscovery();
    }
};

@Override
protected void onActivityResult( int requestCode, int resultCode, Intent data ) {
    if( requestCode == REQUEST_ENABLE_BT ) {
        CheckBlueToothState();
    }
}

private final BroadcastReceiver ActionFoundReceiver = new BroadcastReceiver() {
    public void onReceive( Context context, Intent intent ) {
        String action = intent.getAction();
        if( BluetoothDevice.ACTION_FOUND.equals( action ) ) {
            BluetoothDevice btDevice = intent.getParcelableExtra( BluetoothDevice.EXTRA_DEVICE );
            btDevicesFound.add( btDevice );
            btArrayAdapter.add( btDevice.getName() + "\n" + btDevice.getAddress() );
            btArrayAdapter.notifyDataSetChanged();
        }           
    }
};
public static void startBluetooth(){
    try {
        myBtAdapter = BluetoothAdapter.getDefaultAdapter();
        myBtAdapter.enable();
    } catch ( NullPointerException ex ) {
        Log.e( "Bluetooth", "Device not available" );
    }
}

public static void stopBluetooth() {
    myBtAdapter.disable();
}
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-12T14:22:56.103

我清理了我的项目，对于任何查看此线程以寻求答案的人来说，它都可以正常工作。

# jquery - 为什么要通过摇晃来获得淡入淡出效果？

> ID：10983124
> 
> 赞同：-2
> 
> 时间：2012-06-11T15:27:51.910
> 
> 标签：jquery, jquery-ui, accordion, jquery-ui-accordion

我有这个代码：

[http://jsfiddle.net/yF9bB/1/](http://jsfiddle.net/yF9bB/1/)

一切正常。但是当点击一个按钮时，有几秒钟的震动。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:43:35.740

指定缓动类型似乎解决了这个问题。尝试如下，

```
$('caption').click(function() {        
    $(this).nextAll().toggle('fade');
}); 
```

**演示：http:** [//jsfiddle.net/skram/yF9bB/6/](http://jsfiddle.net/skram/yF9bB/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:40:56.210

在 IE9 中，只有表格在消失之前似乎增加了一秒钟的高度（摇晃）。我认为这是一个 IE 错误，因为其他浏览器似乎可以正确切换表格。

# maven - Maven 路径中是否可以接受非字母数字字符？

> ID：10983125
> 
> 赞同：0
> 
> 时间：2012-06-11T15:27:54.897
> 
> 标签：maven, naming-conventions

[Maven 坐标](http://maven.apache.org/pom.html#Maven_Coordinates)中组和工件名称的约定是什么？我应该坚持使用字母数字字符吗？

我知道点 ( `.`) 表示组名中的子组，破折号 ( `-`) 是单词分隔符。

工具会因非字母数字字符而窒息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:36:26.620

通常，您可以使用任何字符，只要它们可以在您运行 Maven 的操作系统上的文件名中使用。groupId、artifactId 和 version 可以成为文件系统上文件或文件夹的名称，所以名称应该是合法的。

例如，使用标准的本地 Maven 存储库布局，组 id 为 org.apache.maven.plugins 和 artifactId maven-compiler-plugin 和版本 2.3.2 的工件将成为具有如下路径的文件：

```
org\apache\maven\plugins\maven-compiler-plugin\2.3.2\maven-compiler-plugin-2.3.2.jar 
```

# php - 将预定的 XML 解析到 SQL 数据库中的最简单方法是什么？

> ID：10983126
> 
> 赞同：0
> 
> 时间：2012-06-11T15:27:58.140
> 
> 标签：php, mysql, sql-server, xml, cron

所以，好吧，我在我的网站上使用 PHP，假设我知道很多 MySQL 和一点点 MS SQL。现在，我想用 PHP/USD 汇率解析一些 XML 并将其存储在数据库中。

人们能想到的最简单的方法可能是：

```
$XMLContent=file("http://www.webservicex.net/CurrencyConvertor.asmx/ConversionRate?FromCurrency=USD&ToCurrency=PHP");

foreach($XMLContent as $line){
$a=&strip_tags($line);
if (is_numeric($a))
{
    // output the exchange rate
    echo $a;
    // THen I would probably go like this:
    mssql_query('update table set xchange_rate='.(float)floatval($a));
    // break cycle once found;
    break;
}
} 
```

那将是完美的……如果由于外部 XML GET 请求而运行此脚本不需要 0.8 秒。

所以我想我应该使用 Windows Scheduler，并运行一个任务，假设每小时更新一次记录。现在的问题是，我不知道我会使用什么脚本。我的意思是，我不能简单地用 PHP 脚本运行浏览器——那太荒谬了。

那么，让脚本/应用程序在 PHP 之外运行它的最简单方法是什么，而无需实际打开浏览器。

谢谢！

**编辑** 好点，现在我正在 Win7 上测试它，但稍后它将在 Windows Server（2008？）上实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:37:56.553

php 也有一个二进制可执行解释器。在 win 上，它被称为 php.exe

[http://php.net/manual/en/features.commandline.php](http://php.net/manual/en/features.commandline.php)

首先从 shell 提示符下让它工作，然后为它制定一个计划任务。请记住，它与通过网络服务器运行脚本时获得的 php 不同。有些设置不同，版本可能不同，可能使用不同的 php.ini 文件（因此可能加载了不同的扩展名）。

考虑使用绝对文件路径开始，直到你让事情正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:36:19.470

您不需要浏览器来运行 PHP 脚本。PHP 可以愉快地作为控制台应用程序运行。在不知道您将其部署在哪个系统上（即哪个操作系统）的情况下，很难为您提供更多指导。例如，在类 unix 系统（UN*X、linux、OS X 等）上，您可以创建 PHP 文件：

一些文件.php

```
<?php

.....

?> 
```

例如，将此文件保存到某个预定义的目录中，`/opt/myproject`然后将其安排在 /etc/crontab 中（假设您的 php 安装在 /usr/bin 中）：

```
7 * * * *    /usr/bin/php /opt/myproject/somefile.php 
```

这将使用 PHP 运行您的脚本，无需任何浏览器，每小时一次，每小时 7 分钟。

**编辑**如果您要在 Windows 服务器上部署它，您可以`at`在命令提示符下使用命令或使用`Task Scheduler`管理单元`Server Manager`来配置您的作业。PHP 脚本将保存在您喜欢的位置（例如 D:\Projects\MyProject\myfile.php），您计划运行的命令将是 C:\WAMP\bin\php.exe - 或者您的 php 所在的位置.exe 位于）。

# asp.net - 回发所有值/索引后的 DropDownList 丢失

> ID：10983128
> 
> 赞同：0
> 
> 时间：2012-06-11T15:28:00.297
> 
> 标签：asp.net, vb.net, asp.net-2.0

我在使用gridview 和下拉列表时遇到了一个小问题。我可以让下拉列表最初加载，但是当它自动回发时，它返回时没有任何值。我正在填充 RowEditing 子中的下拉列表。我猜我必须以某种方式重新绑定 RowDataBound 子，但不知道该怎么做。如果我试图找到控件的 SelectedValue 我最终什么都没有。

VB代码

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
  If Not IsPostBack Then
    bindGridView()
  End If
End Sub
'Menu Click

'bindGridView
Public Sub bindGridView(Optional ByVal sortExp As String = "", Optional ByVal sortDir As String = "")
  Dim strConnString As String = ConfigurationManager.ConnectionStrings("WEBConnectionString").ConnectionString
  Dim conn As SqlConnection = New SqlConnection(strConnString)
  conn.Open()
  Dim strProgramNumber As String = 5
  Dim strRecordType As String = "Input Source"
  Dim strProgramInformation As String = "\\path\to\file"
  Dim sql As String
  Dim cmd As SqlCommand = New SqlCommand()
  cmd.Connection = conn
  If sortExp <> String.Empty Then
    sortExp = (sortExp & " " & sortDir).ToString
    sql = "SELECT tblPrgTrackPrograms.ProgramNumber, " & _
          "tblPrgTrackPrograms.ProgramName, " & _
          "tblPrgTrackPrograms.ProgramStatus, " & _
          "tblPrgTrackProgramDocumentation.RecordType, " & _
          "tblPrgTrackProgramDocumentation.ProgramInformation  " & _
          "FROM tblPrgTrackPrograms INNER JOIN tblPrgTrackProgramDocumentation ON " & _
          "tblPrgTrackPrograms.ProgramNumber = tblPrgTrackProgramDocumentation.ProgramNumber ORDER BY " & _
          "@sortExp"
    cmd.Parameters.AddWithValue("sortExp", sortExp)

  Else
    sql = "SELECT tblPrgTrackPrograms.ProgramNumber, " & _
          "tblPrgTrackPrograms.ProgramName, " & _
          "tblPrgTrackPrograms.ProgramStatus, " & _
          "tblPrgTrackProgramDocumentation.RecordType, " & _
          "tblPrgTrackProgramDocumentation.ProgramInformation  " & _
          "FROM tblPrgTrackPrograms INNER JOIN tblPrgTrackProgramDocumentation ON " & _
          "tblPrgTrackPrograms.ProgramNumber = tblPrgTrackProgramDocumentation.ProgramNumber"
  End If
  cmd.CommandText = sql
  Dim myDataSet As New DataSet()
  Dim mySQLAdapter As New SqlDataAdapter(cmd)
  mySQLAdapter.SelectCommand.Connection = conn
  mySQLAdapter.Fill(myDataSet)
  conn.Close()
  gvProgramDetails.DataSource = myDataSet
  gvProgramDetails.DataBind()
End Sub
'ProgramDetails Load
Protected Sub gvProgramDetails_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles gvProgramDetails.Load
  bindGridView()
End Sub
'ProgramDetails Paging
Protected Sub gvProgramDetails_PageIndexChanging(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewPageEventArgs) Handles gvProgramDetails.PageIndexChanging
  gvProgramDetails.PageIndex = e.NewPageIndex
  bindGridView()
End Sub
'ProgramDetails Sorting
Protected Sub gvProgramDetails_Sorting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewSortEventArgs) Handles gvProgramDetails.Sorting
  Dim SortDirection As String
  If Session("SortDirection") = vbNullString Then
    Session("SortDirection") = "DESC"
  Else
    SortDirection = Session("SortDirection").ToString
    If SortDirection = "ASC" Then
        SortDirection = "DESC"
    ElseIf SortDirection = "DESC" Then
        SortDirection = "ASC"
    Else
        SortDirection = "ASC"
    End If
    bindGridView(e.SortExpression, Session("SortDirection"))
    'Need to store sort info in view state    
    Session("SortDirection") = SortDirection
  End If
End Sub

'ProgramDetails RowEditing
Protected Sub gvProgramDetails_RowEditing(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewEditEventArgs) Handles gvProgramDetails.RowEditing
  Dim lbl As Label = CType(gvProgramDetails.Rows(e.NewEditIndex).FindControl("lblRecordType"), Label)
  Dim strValue As String = lbl.Text
  gvProgramDetails.EditIndex = e.NewEditIndex
  bindGridView()
  Dim row As GridViewRow = gvProgramDetails.Rows(e.NewEditIndex)
  Dim strConnString As String = ConfigurationManager.ConnectionStrings("CSPaperWEBConnectionString").ConnectionString
  Dim ddlRecordType As DropDownList = CType(row.FindControl("ddlRecordType"), DropDownList)
  Dim conn As SqlConnection = New SqlConnection(strConnString)
  conn.Open()
  Dim sql As String
  Dim cmd As SqlCommand = New SqlCommand()
  cmd.Connection = conn
  sql = "select RecordType from [tblPrgTrackValidRecordTypes] "
  cmd.CommandText = sql
  Dim myDataSet As New DataSet()
  Dim mySQLAdapter As New SqlDataAdapter(cmd)
  mySQLAdapter.SelectCommand.Connection = conn
  mySQLAdapter.Fill(myDataSet)
  conn.Close()
  If ddlRecordType IsNot Nothing Then
    ddlRecordType.DataTextField = "RecordType"
    ddlRecordType.DataValueField = "RecordType"
    ddlRecordType.DataSource = myDataSet
    ddlRecordType.SelectedValue = strValue
    ddlRecordType.DataBind()
  End If
End Sub
Protected Sub gvProgramDetails_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles gvProgramDetails.RowDataBound
  If e.Row.RowType = DataControlRowType.DataRow Then
    Dim ctrl As Control = e.Row.FindControl("ddlRecordType")
    If ctrl IsNot Nothing Then
      Dim ddlRecordType As DropDownList = ctrl
      MsgBox(ddlRecordType.SelectedValue)

    End If
  End If
End Sub
'ProgramDetails RowUpdating
Protected Sub gvProgramDetails_RowUpdating(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewUpdateEventArgs) Handles gvProgramDetails.RowUpdating
  Dim ddlRecordType As DropDownList = gvProgramDetails.Rows(e.RowIndex).FindControl("ddlRecordType")
  MsgBox(ddlRecordType.SelectedValue)
  gvProgramDetails.EditIndex = -1
  bindGridView()
End Sub
'ProgramDetails RowCancelingEdit
Protected Sub gvProgramDetails_RowCancelingEdit1(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewCancelEditEventArgs) Handles gvProgramDetails.RowCancelingEdit
  gvProgramDetails.EditIndex = -1
  bindGridView()
End Sub
'ProgramDetails RowDeleting
Protected Sub gvProgramDetails_RowDeleting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewDeleteEventArgs) Handles gvProgramDetails.RowDeleting
  Dim strConnString As String = ConfigurationManager.ConnectionStrings("WEBConnectionString").ConnectionString
  Dim conn As SqlConnection = New SqlConnection(strConnString)
  conn.Open()
  Dim strProgramNumber As String = 5
  Dim strRecordType As String = "Input Source"
  Dim strProgramInformation As String = "\\path\to\file"
  Dim sql As String = "delete from tblPrgTrackProgramDocumentation where ProgramNumber = @ProgramNumber and RecordType = @RecordType and ProgramInformation = @ProgramInformation"
  Dim cmd As SqlCommand = New SqlCommand()
  cmd.Connection = conn
  cmd.CommandText = sql
  cmd.Parameters.AddWithValue("ProgramNumber", strProgramNumber)
  cmd.Parameters.AddWithValue("RecordType", strRecordType)
  cmd.Parameters.AddWithValue("ProgramInformation", strProgramInformation)
  cmd.ExecuteNonQuery()
  cmd.Dispose()
  bindGridView()
End Sub 
```

ASP前端

```
<ajx:UpdatePanel ID="ajaxpanel" runat="server">   
  <ContentTemplate>        
    <asp:GridView ID="gvProgramDetails" runat="server" AutoGenerateColumns="False" 
    CssClass="gridview" DataKeyNames="ProgramNumber" AllowPaging="True" PageSize="3" AllowSorting="True" >
      <Columns>
        <asp:TemplateField ShowHeader="False">
          <ItemTemplate>
            <asp:LinkButton ID="LinkButton1" runat="server" CausesValidation="False" 
            CommandName="Delete" Text="Delete" OnClientClick="return confirm('Are you sure you want to delete this record');"></asp:LinkButton>
          </ItemTemplate>
          <EditItemTemplate>
          </EditItemTemplate>
          <ControlStyle CssClass="button delete" />
        </asp:TemplateField>
        <asp:CommandField ControlStyle-CssClass="button save" ShowEditButton="True">
          <ControlStyle CssClass="button save" />
        </asp:CommandField>
        <asp:BoundField DataField="ProgramNumber" HeaderText="ProgramNumber" 
          InsertVisible="False" ReadOnly="True" SortExpression="ProgramNumber" />
        <asp:BoundField DataField="ProgramName" HeaderText="ProgramName" ReadOnly="True"
          SortExpression="ProgramName" />
        <asp:BoundField DataField="ProgramStatus" HeaderText="ProgramStatus" ReadOnly="True"
          SortExpression="ProgramStatus" />
        <asp:TemplateField HeaderText="RecordType" SortExpression="RecordType">
          <EditItemTemplate>
            <asp:DropDownList ID="ddlRecordType"  runat="server" autopostback="True">
            </asp:DropDownList>
          </EditItemTemplate>
          <ItemTemplate>
            <asp:Label ID="lblRecordType" runat="server" Text='<%# Bind("RecordType") %>'></asp:Label>
          </ItemTemplate>
        </asp:TemplateField>
        <asp:BoundField DataField="ProgramInformation" HeaderText="ProgramInformation" 
          SortExpression="ProgramInformation" />
      </Columns>
    </asp:GridView>
    <asp:SqlDataSource ID="SqlDataSource2" runat="server" ConnectionString="<%$ ConnectionStrings:WEBConnectionString %>"
    SelectCommand="SELECT * FROM [tblPrgTrackValidRecordTypes]"></asp:SqlDataSource>
  </ContentTemplate>
</ajx:UpdatePanel> 
```

对于那些回答的人，请不要将控件从工具箱中拖入，创建数据源并设置 bind("RecordType")。我已经尝试过这种方式，并且无论 Recordtype 是什么，该值总是会发回。所以除非你能解决[这个gridview的那个版本，](https://stackoverflow.com/questions/10955155/dropdownlist-doesnt-maintain-viewstate)否则不要使用拖放控制解决方案。我正在绞尽脑汁解决这个问题。

* * *

**更新**

* * *

我在 App_Code Process/ddlRecordType.vb 下创建

```
Imports Microsoft.VisualBasic
Namespace processes.ProgramTrack.dllRecordType
   Public Class ddlRecordType
        Public Sub ddlRecordType()

        End Sub
        Public Function GetRecords() As DataSet
            Dim conn As New SqlConnection
            Dim cmd As New SqlCommand
            conn.ConnectionString = ConfigurationManager.ConnectionStrings("WEBConnectionString").ConnectionString.ToString
            cmd.CommandText = "select RecordType from [tblPrgTrackValidRecordTypes] "
            cmd.Connection = conn
            Dim myDataSet As New DataSet()
            Dim mySQLAdapter As New SqlDataAdapter(cmd)
            mySQLAdapter.Fill(myDataSet)
            Return myDataSet
        End Function
    End Class
End Namespace 
```

然后我的标记看起来像这样。

```
<asp:DropDownList ID="ddlRecordType" DatasourceID="odsRecordType" DataTextField="RecordType" DataValueField="RecordType" runat="server" autopostback="True"   >                          </asp:DropDownList>                                     
<asp:ObjectDataSource ID="odsRecordType" runat="server" TypeName="processes.ProgramTrack.dllRecordType.ddlRecordType" SelectMethod="GetRecords"></asp:ObjectDataSource> 
```

然后我遇到了与以前一样的问题，即 DDL 在回发时没有保持它的价值。我应该开始一个新问题还是继续这个问题？

更新以修复 DDL 不维护。禁用网格视图的视图状态。

```
<asp:GridView ID="gvProgramDetails" runat="server" AutoGenerateColumns="False" CssClass="gridview"DataKeyNames="ProgramNumber" AllowPaging="True" PageSize="10" EnableViewState="False" AllowSorting="True"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:51:31.477

尝试为 DDL 创建一个 objectDataSource，并使用它。问题是 DDL 必须在页面加载或页面初始化时或通过 DataSource 控件进行初始化。如果您没有使用 Ajax UpdatePanel（继续，将其取出，观察您的代码工作，无论如何它应该），那么您可以这样做。

如果您要引入一个 ObjectDataSource（并且您也可以将参数传递给它），那么您最终应该得到您想要的。

### 编辑：

我将提供我的一个项目的代码，以便您了解我是如何使用它的。此代码不会完美满足您的需求，但会向您展示如何做您想做的事情。

```
namespace Appropriate.Namespace.Here {
  public class MyType {
    public List<KeyValuePair<string, string>> GetRoles() {
      List<KeyValuePair<string, string>> l = new List<KeyValuePair<string, string>>();

      l.Add( new KeyValuePair<string, string>( "Level1", "Analyst" ) );
      l.Add( new KeyValuePair<string, string>( "Level2", "Customer Service" ) );
      l.Add( new KeyValuePair<string, string>( "Level3", "Customer Service Manager" ) );
      l.Add( new KeyValuePair<string, string>( "Level4", "Full-Access User" ) );
      l.Add( new KeyValuePair<string, string>( "Level5", "Super User" ) );

      return l;
    }
  }
}

<asp:DropDownList ID="cmbRoles" runat="server" AutoPostBack="False" DataSourceID="odsRoles" DataTextField="Value" DataValueField="Key" />
<asp:ObjectDataSource ID="odsRoles" runat="server" TypeName="Appropriate.Namespace.Here.MyType" SelectMethod="GetRoles" /> 
```

请注意命名空间和类型名如何协同工作以提供`SelectMethod`? 我没有提供对选择参数的覆盖，尽管你可以。您可以在页面支持代码中执行此操作，我也可以对此提供一些见解，但我试图不要完全过于复杂。

注意我是如何从方法中返回一个列表的？我只是用那种方法定义它？您可以在那里轻松地进行数据库调用。

# html - 如何在`中水平居中和对齐图像 `元素？

> ID：10983130
> 
> 赞同：1
> 
> 时间：2012-06-11T15:28:04.593
> 
> 标签：html, css

我有一个`<div>`盒子，里面有一张或多张图片。

这些图像应该水平居中，并且两个或多个图像之间的距离应该始终相等。所以，当只有一张图片时，左右空格应该相等，当有多个时，图片之间的所有空格，`<div>`元素的边框应该相等。

这是`<div>`元素的 CSS 代码：

```
div.bild {
    text-align:center;
    position:absolute;
    bottom: 0;
    margin-left: -30px;
    margin-bottom: 30px;
    width: 100%;
} 
```

这是他`<img>`标签的CSS：

```
img {
    margin: auto;
} 
```

这是相关的 HTML 摘录：

```
<div id="box1" class="box">
    <h2><a name="box1">(title)</a></h2>
    <p>(text)</p>
    <div class="bild">
        <img id="imgleft" src="images/Comic-1.png"/>
        <img id="imgright" src="images/Comic-2.png"/>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T16:14:11.007

使用“inline-block”可以让你拥有文本元素的居中优势和块元素的定位优势。（在您的情况下是固定保证金）

[http://jsfiddle.net/meo/bYb8y/](http://jsfiddle.net/meo/bYb8y/)

```
div.bild {
    text-align:center;
    position:absolute;
    bottom: 0;
    margin-left: -30px;
    margin-bottom: 30px;
    width: 100%;
}

img {
    display: inline-block;
    margin: 20px;
}​ 
```

如果您希望每个图像都在新行上，请使用显示块。我不是 100% 确定它是否是您想要的，如果不是，最好提供一个代表期望行为的图像。您能否告诉我们这些图像是否可以彼此相邻，或者它们是否必须始终垂直堆叠？

# c++ - 这个代码在 C++ 中是否存在内存泄漏？

> ID：10983134
> 
> 赞同：-3
> 
> 时间：2012-06-11T15:28:15.483
> 
> 标签：c++, memory-leaks

我有这堂课：

```
class Base{
     private:
        char *message;
     public:
        Base(string message`);
        ~Base();    
}; 
```

编辑：对不起，我忘了给我的构造函数！
当我实现如下的析构函数时：

```
Base::Base(string message1){
     message = new char[message1.size() + 1]
     message[message1.size()] = '\0';
     memcpy(message, message1.c_str(), message.size());
}
Base::~Base(){
     delete message;  
} 
```

有时系统会`stop working`出错，但如果不是`delete message`，我使用`message = NULL`，一切都会好起来的！那么，如果我只是`message = NULL`在我的析构函数中声明，我的程序会出现内存泄漏吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-11T15:46:46.637

绝对没有理由在`new`这里使用。构造函数获取 a`std::string`然后*手动*将其内容复制到一个新的动态分配数组中`char`。这是完全没有价值的。相反，如果构造函数只是将它复制到另一个`std::string`中，则`std::string`复制构造函数也会这样做，但有很多免费的好处：异常安全、[没有内存泄漏](https://stackoverflow.com/questions/8839943/why-does-the-use-of-new-cause-memory-leaks-in-c/8840302#8840302)和[正确的复制语义](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)。

```
class Base{
     private:
        string message;
     public:
        Base(string message);
        // maybe a virtual destructor is desirable if this is a polymorphic base class
        // virtual ~Base() {}
};

Base::Base(string message1) : message(message1) {} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-11T15:43:30.233

您的问题是`delete`在使用`new[]`. 它需要`delete[] message`正确释放字符串。

将指针设置为 NULL 只是掩盖了问题，并且*确实*泄漏了内存。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T15:44:48.903

存在内存泄漏*。*您分配了一个`char`数组，因此您需要适当地删除它，如下所示：

```
Base::~Base(){
     delete[] message;  
} 
```

如果将指针设置为 NULL 则无关紧要，指针本身在调用析构函数后无论如何都会被释放。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T15:29:58.483

使用此处显示的代码，没有内存泄漏。但是，`NULL`在任何情况下，对指针的影响都不会删除它。你只是失去了对它的引用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-11T15:42:38.383

是的，如果您没有在构造函数中`delete`动态分配内存，那就是内存泄漏。`new`

你必须使用`delete[] message`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-11T15:33:38.117

你为什么要使用`delete`？您不是在堆上分配内存，您只是在创建一个指针。但是，除非您在构造函数的堆上分配内存，考虑到您选择不共享代码，我们无法知道...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-11T16:06:59.277

存在内存泄漏，因为只需执行 message = NULL，您只会使指针的地址无效。保存在内存中的内容仍然存在，没有被删除。

# arrays - 寻道时间与顺序读取

> ID：10983135
> 
> 赞同：3
> 
> 时间：2012-06-11T15:28:18.690
> 
> 标签：arrays, hard-drive, seek, sequential

假设在硬盘上我有一些非常大的字符序列数据文件：

> 阿布兹....

我的问题如下，如果头部位于文件的开头，并且我需要每 1000 个位置间隔 5 个字符，最好是做一个 Seek （因为我知道在哪里看）或者只是有一个大缓冲区只是顺序读取然后在内存中完成工作。

我天真地回答说，阅读“A”然后寻求阅读“V”比 >> 阅读所有文件直到位置 200（“V”的位置）要快。好的，这只是一个例子，因为最小的 I/O 是 512 字节。

编辑：我之前的自我天真回答在以下情况下得到了部分证明：给定一个 100Gb 的文件，我需要第一个和最后一个字符；在这里，我显然会寻求....对吗？

也许在搜索“多长时间”与要检索多少数据之间进行权衡？

有人可以向我澄清这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:55:20.520

**[更新]** 通常，如果您的步数小于您的块大小的 2 倍，则每 1000 个中的 5 个（假设 5 个字节是 1000 的一部分，因此使您的步数为 1000）答案是一个很好的解释。一旦超过 HD 块大小的 2 倍，它确实会变得更加棘手，因为那时，您很容易浪费读取时间，而您可以通过寻找过去未使用的（或就此而言不必要的）来加速) 高清块。

**[原创]** 嗯，这是一个非常有趣的问题，我相信这是一个同样有趣的答案（也有些复杂）。我认为这实际上归结为其他几个问题，例如您在驱动器（或您的软件将要运行的驱动器）上实现的块大小有多大。如果您的块大小为 4KB，那么您的硬盘驱动器一次将为您获得的（真实）最小值是 4096 字节。在您的情况下，如果您确实每 1000 个字符需要 5 个字符，那么如果您使用所有磁盘 IO 执行此操作，那么您实际上将重新读取相同的块 4 次，并在其间进行 3 次查找（真的没有效率）。

我个人的信念是，您可以（如果您想提高驱动效率）在您的代码中，尝试了解您正在使用的驱动器的块大小是多少，然后使用该大小数字来了解您一次有多少字节应带入 RAM。这样你就不必有一个巨大的 RAM 缓冲区，但同时也不必真正地寻找，你不会浪费（或执行）任何额外的读取。

这是最有效的吗？我不认为它是最有效的，但它可能足以满足您需要的性能，谁知道呢。我确实认为，即使读取头在您想要的位置，如果您在每个块读取的中间执行算法工作，而不是一次读取整个文件，您将浪费时间等待驱动盘片的下一次旋转。然而，如果您要一次读取所有文件，则驱动器应该能够一次对文件的所有部分执行顺序读取。再次不是那么简单，就像您的文件确实超过 1 个块一样，在旋转驱动器上，如果您的驱动器没有进行碎片整理，您可能会受到影响，因为它可能必须执行随机搜索才能到达下一个块。

抱歉，对于冗长的答案，但通常情况下，您的情况没有简单的答案。

我确实认为，如果您一次读取整个文件，整体性能可能会更好。无法确保这一点，因为每个系统的驱动器设置等参数都不同......

# ios - 需要使用 Xcode 仪器的指南

> ID：10983136
> 
> 赞同：0
> 
> 时间：2012-06-11T15:28:20.993
> 
> 标签：ios, memory-management, xcode-instruments

我正在按照本指南[开发人员仪器指南](https://developer.apple.com/library/mac/#documentation/developertools/conceptual/InstrumentsUserGuide/ViewingandAnalyzingData/ViewingandAnalyzingData.html)和[RayWenderlich 的教程](http://www.raywenderlich.com/2696/how-to-debug-memory-leaks-with-xcode-and-instruments-tutorial)使用仪器查看和分析数据，我想知道是否有人可以建议任何其他指南教程，因为我仍然不清楚某些方面（例如，如何确定哪些类存在于内存中特定帧及其内存占用）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-18T17:41:26.103

自从我发布这个问题以来已经有几天了，同时我发现[这篇](http://allseeing-i.com/Performance-tips-for-Cocos2d-for-iPhone)非常有用的帖子给出了关于仪器的基本介绍以及我在不完全理解为什么的情况下所做的其他与性能相关的优化:).. 非常有用！

# python - 当进程收到 SIGSTOP 和 SIGCONT 时如何处理超时？

> ID：10983139
> 
> 赞同：3
> 
> 时间：2012-06-11T15:28:27.983
> 
> 标签：python, multithreading

我有一些 Python 代码使用 threading.Timer 为操作实现 60 秒超时。

问题是这段代码在作业控制环境中运行，它可能会被更高优先级的作业抢占。在这种情况下，它将被发送 SIGSTOP，然后是一段时间后，SIGCONT。我需要一种方法来以某种方式注意到这已经发生并重置超时：显然，如果操作已暂停整个 60 秒，则该操作并没有真正超时。

我试图为 SIGCONT 添加一个信号处理程序，但这似乎是在提供给 threading.Timer 的代码执行后执行的。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T06:35:16.750

发布此消息后我想到的一个相当简单的答案是将计时器简单地分解为多个子计时器，例如有 10 个 6 秒计时器，而不是每个计时器启动链中的下一个计时器。这样，如果我被暂停，我只会丢失一个计时器，并且在超时之前仍然可以等待大部分时间。

这当然不是万无一失的，特别是如果我反复暂停和重新启动，但这很容易做到，而且似乎已经足够好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T15:58:13.743

您需要重新考虑您的要求；超时反映经过的时间（墙上时间）；您想知道您的流程使用的时间。

幸运的是，您可以使用以下方法进行测量`getrusage`：[http ://docs.python.org/library/resource.html](http://docs.python.org/library/resource.html)

您仍然需要设置超时；当它返回时，测量自操作开始以来用户或系统时间使用的增加，如果超过限制则终止操作，否则适当地重新安排超时时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T17:00:06.140

如果您的应用程序是多线程的，[则文档](http://docs.python.org/library/signal.html)说：

> 只有主线程可以设置新的信号处理程序，并且主线程将是唯一接收信号的线程

确保您正在处理来自主线程的信号。

# ios5 - 无法使用 XCode 安装 iOS 应用程序（没有开发人员帐户）

> ID：10983142
> 
> 赞同：0
> 
> 时间：2012-06-11T15:28:47.827
> 
> 标签：ios5, xcode4.3

我正在尝试为我的 iPad 构建[Mini vMac](https://github.com/pgodwin/minivmac-iphone)。由于我没有开发者帐户，我创建了一个虚假证书，但我仍然无法为 iPad 构建它或将其存档在 IPA 中，因为我没有该应用程序的临时证书（我有一个TestFlight beta，但显然它不起作用）。我应该怎么办？

电脑：iMac 21'5'' Late 2009, OS X 10.7.4 Lion, XCode 4.3.2

iDevice：iPad 2 32 GB Wi-Fi，iOS 5.0.1（带苦艾酒越狱）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:21:23.230

您将不得不购买开发人员许可证或越狱您的 iPad。这些确实是您仅有的两个选择。

# xml - 如何标记特定图像？

> ID：10983144
> 
> 赞同：0
> 
> 时间：2012-06-11T15:28:48.430
> 
> 标签：xml, adobe-indesign, extendscript

我想在我的文档中标记特定的内联图像，但我却停留在实际的标记部分。我已经拥有的是以下内容：

```
var myDoc = app.activeDocument;
var myItems = myDoc.allPageItems;
var foundInlineImages = Array();

// loop through the page and find all inline objects (images).
// Name has to be Rectangle to exclude grouped objects.

for(var i = 0, len = myItems.length; i < len; i++)
{
    if( (myItems[i].constructor.name=="Rectangle") && (myItems[i].parent instanceof Character) )
    {
        foundInlineImages.push(myItems[i]);
    }
}

// encapsulate all array entries with [Image] tag

for(var i = 0; i < foundInlineImages.length; i++)
{
   // I need here something like foundInlineImages[i].changeTextPreferences.markupTag="Image";
   // unfortunatly this doesn't work ...
} 
```

有人可以引导我使用正确的语法来用标签（在本例中为“图像”）封装数组中找到的每个对象吗？

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T04:40:56.570

@Wokoman -- 如您所说，用 XML 标记封装图像：

> *   首先为每个图像创建一个名为“Image”的 XML 标签
> *   从该标记创建一个 XML 元素
> *   然后将每个图像插入 XML 元素

您正在尝试更改 Image 对象的属性，但  `Image`  没有这些属性  `changeTextPreference.markupTag`  （请参阅[InDesign 对象模型 --> Image](http://jongware.mit.edu/idcs5js/pc_Image.html)以供参考）。

 `Application`  具有这些属性  `changeTextPreference.markupTag` （请参阅[InDesign 对象模型 --> changeTextPreference](http://jongware.mit.edu/idcsjs5.5/pc_ChangeTextPreference.html)以供参考）。

* * *

所以，试试这个（**这是未经测试**的，基于[InDesignCS5_ScriptingGuide_JS](http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/products/indesign/pdfs/InDesignCS5_ScriptingGuide_JS.pdf)的第 168 页）：

```
var xmlImageTag = "";
var xmlImageElement = "";

for(var i = 0, len = foundInlineImages.length; i < len; i++)
{
    // each Image tag created here
    xmlImageTag = myDoc.xmlTags.add("Image");

    // each Image element created here, from the Image tag
    xmlImageElement = myDoc.xmlElements.item(i).xmlElements.add(xmlImageTag);

    // inserting each image into each new Image element
    xmlImageElement.contents = foundInlineImages[i];
} 
```

# sql - 日期范围之间的字段值

> ID：10983146
> 
> 赞同：1
> 
> 时间：2012-06-11T15:28:52.050
> 
> 标签：sql, postgresql, postgresql-9.1

请，有人可以帮助我，如何获取文档状态的信息...通常，我需要给定的时间段（开始日期，结束日期过滤器）来检查文档是活动（A）还是非活动（I）

```
Table Documents
ID  Doc    Date    Status
1   11    1.1.2012\.  A
2   11    1.4.2012\.  I
3   11    25.4.2012\. A
4   11    1.6.2012\.  I
5   22    18.4.2012\. A
6   22    30.4.2012\. I

Dynamic filters: @start,@end

Example: 
@start= 2.3.2012
@end=5.5.2012
Result should be 
11  2.3.-1.4\. Status=A 
    1.4.-25.4 Status=I 
    25.4.-5.5\. Status=A 
22  2.3.-18.4\. 'not exist'
    18.4-30.4\. Status=A 
    30.4.-5.5\. Status=I 

    If filter is 
@start= 1.2.
@end= 28.2.
Result should be 
11 'A'  
22 'not exist'

If filter is 
@start= 18.4.
@end= 20.4.
Result should be 
11 'I'
22 'A' 
```

**编辑：**

抱歉，我不想听起来像是“为我做”......我尝试过这样的事情

```
WITH a AS (
   SELECT documents.*,lag(date) OVER (PARTITION BY doc ORDER BY DATE) AS pre_date
 FROM documents ORDER BY DATE
)
SELECT a.* from a
WHERE (@start between a.pre_date AND a.date) AND (@end between a.pre_date AND a.date) 
```

这不是我所需要的。这也是 sql fiddle [sqlfiddlelink](http://sqlfiddle.com/#!1/d84ae/1)中的示例。我更改过滤器表以测试 @start 和 @end 的不同值

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T02:01:50.897

此查询似乎生成了您正在寻找的内容，使用您在 sqlfiddle 上定义的“过滤器”表。它不包括“不存在”行。我不确定你是否真的想要那个，或者你只是想表明它不存在。我假设后者。否则我猜过滤器表中的一些额外时间段将需要“联合”。

这个想法是首先创建一个时期，就像你试图用“滞后”做的那样，但是用“领先”来表示这个时期的结束是下一个时期的开始。可能想从领先中减去 1 天以使结束日期不包含在内，但我不想让这个更复杂。

*   如果没有结束期，则使用过滤器结束期（合并）
*   任何早于过滤器开始日期的开始日期都将上升到过滤器开始日期（最大）
*   任何大于过滤器结束日期的结束日期都会减少到过滤器结束日期（最小）

询问：

```
SELECT id, doc, status, from_date, to_date
  FROM ( SELECT id, doc, status, GREATEST(d.date, f.start_date) AS from_date
               ,LEAST( COALESCE( lead(date) OVER (PARTITION BY doc ORDER BY date)
                                ,f.end_date
                               )
                       ,f.end_date ) AS to_date
           FROM documents d
               ,filter f
        ) d
  WHERE from_date < to_date
  ORDER BY doc, from_date; 
```

设置：

```
CREATE TABLE documents(id int, doc int, date date, status varchar (1));

insert into documents values(1, 11, to_date('2012-01-01', 'yyyy-mm-dd'),'A');
insert into documents values(2, 11, to_date('2012-04-01', 'yyyy-mm-dd'),'I');
insert into documents values(3, 11, to_date('2012-04-25', 'yyyy-mm-dd'),'A');
insert into documents values(4, 11, to_date('2012-06-01', 'yyyy-mm-dd'),'I');
insert into documents values(5, 22, to_date('2012-04-18', 'yyyy-mm-dd'),'A');
insert into documents values(6, 22, to_date('2012-04-30', 'yyyy-mm-dd'),'I');

CREATE TABLE filter(start_date date, end_date date); 
```

跑：

```
postgres=#     insert into filter values(to_date('2012-02-03', 'yyyy-mm-dd'), to_date('2012-05-05', 'yyyy-mm-dd'));
INSERT 0 1
postgres=#     SELECT id, doc, status, from_date, to_date
postgres-#       FROM ( SELECT id, doc, status, GREATEST(d.date, f.start_date) AS from_date
postgres(#                    ,LEAST( COALESCE( lead(date) OVER (PARTITION BY doc ORDER BY date)
postgres(#                                     ,f.end_date
postgres(#                                    )
postgres(#                            ,f.end_date ) AS to_date
postgres(#                FROM documents d
postgres(#                    ,filter f
postgres(#             ) d
postgres-#       WHERE from_date < to_date
postgres-#       ORDER BY doc, from_date
postgres-# ;
 id | doc | status | from_date  |  to_date
----+-----+--------+------------+------------
  1 |  11 | A      | 2012-02-03 | 2012-04-01
  2 |  11 | I      | 2012-04-01 | 2012-04-25
  3 |  11 | A      | 2012-04-25 | 2012-05-05
  5 |  22 | A      | 2012-04-18 | 2012-04-30
  6 |  22 | I      | 2012-04-30 | 2012-05-05
(5 rows)

postgres=#     truncate table filter;
TRUNCATE TABLE
postgres=#     insert into filter values(to_date('2012-01-02', 'yyyy-mm-dd'), to_date('2012-02-28', 'yyyy-mm-dd'));
INSERT 0 1
postgres=#     SELECT id, doc, status, from_date, to_date
postgres-#       FROM ( SELECT id, doc, status, GREATEST(d.date, f.start_date) AS from_date
postgres(#                    ,LEAST( COALESCE( lead(date) OVER (PARTITION BY doc ORDER BY date)
postgres(#                                     ,f.end_date
postgres(#                                    )
postgres(#                            ,f.end_date ) AS to_date
postgres(#                FROM documents d
postgres(#                    ,filter f
postgres(#             ) d
postgres-#       WHERE from_date < to_date
postgres-#       ORDER BY doc, from_date;
 id | doc | status | from_date  |  to_date
----+-----+--------+------------+------------
  1 |  11 | A      | 2012-01-02 | 2012-02-28
(1 row)

postgres=#     truncate table filter;
TRUNCATE TABLE
postgres=#     insert into filter values(to_date('2012-04-18', 'yyyy-mm-dd'), to_date('2012-04-20', 'yyyy-mm-dd'));
INSERT 0 1
postgres=#     SELECT id, doc, status, from_date, to_date
postgres-#       FROM ( SELECT id, doc, status, GREATEST(d.date, f.start_date) AS from_date
postgres(#                    ,LEAST( COALESCE( lead(date) OVER (PARTITION BY doc ORDER BY date)
postgres(#                                     ,f.end_date
postgres(#                                    )
postgres(#                            ,f.end_date ) AS to_date
postgres(#                FROM documents d
postgres(#                    ,filter f
postgres(#             ) d
postgres-#       WHERE from_date < to_date
postgres-#       ORDER BY doc, from_date;
 id | doc | status | from_date  |  to_date
----+-----+--------+------------+------------
  2 |  11 | I      | 2012-04-18 | 2012-04-20
  5 |  22 | A      | 2012-04-18 | 2012-04-20
(2 rows)

postgres=# 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T22:57:06.207

基本上，@Glenn 的回答涵盖了它。我投了赞成票。我仅发布此内容以展示其他详细信息 - 太多无法放入评论：

*   使用多行`INSERT`语法。

*   [在CTE](http://www.postgresql.org/docs/current/interactive/queries-with.html)中提供过滤器，这比为此创建额外的表要方便得多。

*   此查询可以一次处理多个过滤器。

*   用于[`lead(date,1,'infinity')`](http://www.postgresql.org/docs/current/interactive/functions-window.html#FUNCTIONS-WINDOW-TABLE)消除对`COALESCE`.

*   演示一种不那么复杂的方式来输入日期文字 - ISO 8601 格式在*任何*`'yyyy-mm-dd'`语言环境中都是明确的：

     *```
    '2012-02-03'::date 
    ```

    或者

    ```
    date '2012-02-03' 
    ```

    代替：

    ```
    to_date('2012-02-03', 'yyyy-mm-dd') 
    ```* 
**   把它放在一个噪音更小、更易读的格式中* 

 *```
CREATE TEMP TABLE documents (id int, doc int, date date, status "char");

INSERT INTO documents VALUES
 (1,'11','2012-01-01','A')
,(2,'11','2012-04-01','I')
,(3,'11','2012-04-25','A')
,(4,'11','2012-06-01','I')
,(5,'22','2012-04-18','A')
,(6,'22','2012-04-30','I');

WITH filter(filter_id, start_date, end_date) AS( 
    VALUES
     (1, '2012-04-18'::date, '2012-04-20'::date)
    ,(2, '2012-03-02'::date, '2012-05-05'::date)
    )
    , d AS (
    SELECT doc, status, date AS d1
          ,lead(date,1,'infinity') OVER (PARTITION BY doc ORDER BY date) AS d2
    FROM   documents
    )
SELECT f.filter_id, d.doc
      ,GREATEST(f.start_date, d.d1) AS start
      ,LEAST(f.end_date, d.d2) AS end
      ,d.status
FROM   filter f, d
WHERE  f.start_date <= d.d2
AND    f.end_date   >= d.d1
ORDER  BY f.filter_id, d.doc, d.d1; 
```*

# c - 用于数值优化的 c 回调函数

> ID：10983148
> 
> 赞同：0
> 
> 时间：2012-06-11T15:29:06.033
> 
> 标签：c, optimization, callback, scope, nested-function

我的应用程序库需要调用一个优化例程：

```
 err = optim(int n, double *x, double *f, void *obj) 
```

然后该例程将调用目标函数来请求目标函数值。

```
 void obj(int n, double *x, double *f) 
```

optim() 是外部库的一部分。optim() 和 obj() 的签名是固定的。

该函数`obj()`需要访问单个对象“模型”中包含的数据。所有其他函数都传递指向模型对象的指针。因此，运行优化器的调用可能类似于：

```
 err = doOptimize(model) 
```

`doOptimize()`将设置问题并致电`optim()`

```
 err= optim(model->n, model->x, model->f, model->obj) 
```

问题是，除了、和之外，`obj()`函数还能访问对象中的变量吗？函数需要调用需要对象进行实际计算的其他函数：`model``n``x``f``obj()``model`

```
 updateParms(model);
    computeF(model); 
```

我不确定在`obj()`没有实际句柄的情况下如何进行这些调用？以下可以工作吗？

```
 updateParms();
    computeF(); 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:57:35.697

是的，没有。

当然，您的函数`obj`可以像访问任何其他内存一样访问模型，但我没有看到任何机制让它知道`model`.

您需要添加另一个参数`obj`来传递`model`指针。

在 C++ 中，您可能会通过`obj`创建`Class Model`. 然后编译器将添加一个名为`this`（它为所有成员函数执行此操作）的隐藏参数，该参数将包含指向对象实例“模型”的指针。如果你想在纯 C 中实现同样的效果，那么你必须传递你自己的`this`指针（但你可以随意调用它）。

所以，像这样：

```
... doOptimize (... model)
{
  ....
  optim (model->n, model->x, model->x, model)
  ....
}

... optim (int n, double *x, double *f, ... model)
{
  ....
  model->obj (n, x, f, model);
  ....
}

void obj (int n, double *x, double *f, ... model)
{
   /* use n, x, and f */
   /* use model->stuff */
} 
```

当然，如果你*总是*使用相同的，`n`那么你只需要 pass 。`x``f``model`

顺便说一句，不要`void *`用于函数指针：这不是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T08:08:13.373

由于您无法修改`optim()`或`obj()`您将需要创建一个中间步骤来执行对您的`obj()`函数的真正调用。根据需要一次进行多少优化调用，这可能与保存模型指针的全局/静态变量一样简单，例如：

```
void obj(struct model *m, int n, double *x, double *f)
{
    /* Access to all information here */
}

static struct model *optim_model;

void obj_caller(int n, double *x, double *f)
{
    obj(optim_model, n, x, f);
}

int doOptimize(struct model *m)
{
    optim_model = m;
    return optim(m->n, m->x, m->f, obj_caller);
} 
```

或者，如果您需要更高级或不喜欢拥有单个全局，并且可以使用 n 参数作为标识符，您可以使用它来突破以调用多个优化模型：

```
void obj(struct model *m, int n, double *x, double *f)
{
    /* Access to all information here */
}

#define MAX_MODELS (10)
static struct model *optim_models[MAX_MODELS] = {0};

void obj_caller(int n, double *x, double *f)
{
    for (int i = 0; i < MAX_MODELS; i++)
    {
        if (optim_models[i]->n == n)
        {
            obj(optim_models[i], n, x, f);
            break;
        }
    }
}

int doOptimize(struct model *m)
{
    return optim(m->n, m->x, m->f, obj_caller);
}

int main(void)
{
    struct model m1;
    struct model m2;

    m1.n = 1;
    optim_models[0] = &m1;

    m2.n = 2;
    optim_models[1] = &m1;

    int err = doOptimize(&m2);
} 
```

我敢肯定，如果需要，您会找到一种更合适的方法来存储多个模型，例如具有真实标识符的链表。

# postgresql - Postgresql 现有用户不会进行身份验证

> ID：10983156
> 
> 赞同：0
> 
> 时间：2012-06-11T15:29:34.427
> 
> 标签：postgresql, fedora, postgresql-9.1

我正在尝试在 Fedora 17 上安装 postgresql 9.1。

yum 安装它很麻烦，但我很难连接到它。

我已经对 pg_hba.conf 进行了更改，我知道我已经创建了用户（\l 显示了我的用户），但是由于某种原因，当我尝试使用 pgAdmin 进行连接时，它不会进行身份验证。

这是我的 pg_hba.conf：

```
#Allow any IP to connect, with a password:
host    all         all         0.0.0.0          0.0.0.0      trust
host    all         all         ::1/128                       trust
local   all         all                                       trust 
```

还有其他人经历过这样的事情吗？还需要进行一些其他更改吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T16:19:06.293

像这样（或类似的东西）通过 yum 安装 postgresql 服务器后：

```
yum install postgresql91-server postgresql91-contrib 
```

您应该执行以下操作：

```
service postgresql-9.1 initdb
chkconfig postgresql-9.1 on 
```

[此页面](http://www.postgresql.org/download/linux/redhat/)有更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T16:32:50.137

如果上述两个命令不起作用，请尝试以下操作：

```
postgresql-setup initdb 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T04:51:33.640

我认为 0.0.0.0 应该是 0.0.0.0/0

然后尝试重新启动 PostgreSQL。我发现有时重新加载不起作用。

# git - 在 Ubuntu Linux 和 Windows 7 上使用 Git 进行源代码管理

> ID：10983159
> 
> 赞同：-1
> 
> 时间：2012-06-11T15:29:42.433
> 
> 标签：git, eclipse-plugin

1.  我有一个使用 Eclipse Helios EE 构建的 Java 代码库。

2.  我们要设置如下开发环境：将存放源代码存储库的 Ubuntu Linux Git 服务器 b. 开发将在 Windows 7 下的 Eclipse Helios 上完成

3.  我需要安装哪些工具才能使此设置正常工作？这是我的列表，请告知是否完整：a) Linux 服务器上的 Git b) Windows 7 笔记本电脑上的 Eclipse Helios c) 我需要 Eclipse 上的任何 Git 插件吗？或者 Eclipse Helios 可以直接与 Ubuntu Linux 服务器上的 Git 存储库互操作吗？d) 我在 Windows 7 笔记本电脑上是否需要 Windows Git？

4.  欢迎任何指向教程或详细说明的指针！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:39:16.960

只是为了确认一下：您想在 Windows 7 上使用 Eclipse 进行开发并将存储库托管在您的 Ubuntu 服务器上？

然后你需要在 Windows 机器或任何开发机器上：

*   [Git](http://git-scm.com)本身，以任何方式使用它，因为 Git 是分散的并且在您的机器上本地工作。
*   如果您想使用 Eclipse，显然是 Eclipse，但这与 Git 完全无关。
*   如果您不想使用命令行，而是想从 Eclipse 中访问 Git 功能，则可以选择使用Eclipse的[Git 插件。](http://www.eclipse.org/egit/)

在您的 Linux 服务器上，您需要：

*   吉特，再一次。
*   根据您希望与服务器通信的方式，您可能需要一些其他工具，但仅使用 SSH 和 Git 就可以正常工作。另请参阅Git 手册[中的“服务器上](http://git-scm.com/book/en/Git-on-the-Server)的 Git”部分。

一般来说，请查看[Git 书籍](http://git-scm.com/book)以获取一般 Git 帮助（因为您似乎错过了 Git 的确切工作原理）。

# ios - UITextView 文本拟合大小

> ID：10983160
> 
> 赞同：0
> 
> 时间：2012-06-11T15:29:43.367
> 
> 标签：ios, xcode, cocoa-touch, uitextview

我有可变大小的 UITextView。根据大小，我只想使用适合 UITextView 框架的文本部分（来自长字符串）。我不想调整 UITextView 的大小以适合字符串，我不想更改文本大小以适合框架。我想从文本中提取尽可能多的字符，因为我可以在给定的框架中放入 UITextView。

我怎样才能做到这一点？我被困在这个问题上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:52:21.047

我在这里找到了解决此问题的正确方法： [如何截断 UITextView 内容以适应减小的大小？](https://stackoverflow.com/questions/7057707/how-to-truncate-uitextview-contents-to-fit-a-reduced-size?rq=1)

这是followben的答案。可惜不接受。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:49:55.537

尝试这个。将字符串大小截断为您想要的大小。在这里，我将截断为 20 个字母

```
str = [str substringToIndex: MIN(20, [str length])]; 
```

# input - 如何使用 Telerik RadControls 添加带小数点和百分比符号的百分比文本框

> ID：10983171
> 
> 赞同：0
> 
> 时间：2012-06-11T15:30:25.110
> 
> 标签：input, telerik, decimal, percentage

如何使用 Telerik RadControls 添加带**小数点**和**百分比符号的百分比文本框？**

我的意思是 Telerik`MaskedTextBox`还是 Telerik `NumericTextBox`？

哪一个以及如何？

我写了下面的aspx代码：

```
<telerik:RadNumericTextBox ID="RadNumerictxtPercent_Taliya" runat="server"
                Type="Percent" Width="60px" EnableEmbeddedSkins="False" Skin="BlackByMe" ValidationGroup="C"
                MaxValue="20" MinValue="0">
                <NumberFormat DecimalDigits="2" ZeroPattern="n %" />
</telerik:RadNumericTextBox> 
```

但我不能使用键盘增加和减少百分比（小数区域）！

此外，该aspx代码中的百分比符号似乎也存在问题！

我该如何修复它们？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:40:09.287

你需要 NumberFormat-DecimalDigits="2"

```
<telerik:RadNumericTextBox ID="RadNumericTextBox1" runat="server" Type="Percent"
    Width="60px" NumberFormat-DecimalDigits="2" MaxValue="20" MinValue="0">
</telerik:RadNumericTextBox> 
```

# ios - 带有 UUID 的 Web 视图

> ID：10983174
> 
> 赞同：0
> 
> 时间：2012-06-11T15:30:29.240
> 
> 标签：ios, xcode, xcode4

我如何将 UUID 或某种唯一 ID 添加到 xcode 中的 URL 中？

```
[Launch loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://somewebsite.com/app/launch.php?&edit&uuid="]]]; 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T15:44:29.750

试试这个

```
NSString* uuid = [[UIDevices currentDevice] uniqueIdentifier];
NSString* StringUrl =[NSString stringWithFormat: @"http://somewebsite.com/app/launch.php?&edit&uuid=%@", udid ];

[Launch loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString: StringUrl]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:36:38.120

UUID 是指与设备相关的唯一标识符，还是只是唯一的 GUID？

以下链接可帮助您创建与设备无关的唯一 UUID 或 GUID：

[http://blog.ablepear.com/2010/09/creating-guid-or-uuid-in-objective-c.html](http://blog.ablepear.com/2010/09/creating-guid-or-uuid-in-objective-c.html)

而且，这是您的代码，已更新为设备 UDID 中的格式：

```
NSString* udid = [[UIDevices currentDevice] uniqueIdentifier];

[Launch loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString: [NSString stringWithFormat: @"http://somewebsite.com/app/launch.php?&edit&uuid=%@", udid ]]]; 
```

但是请注意，uniqueIdentifier 已被弃用，Apple 不会接受使用它的应用程序。您可以改为使用 OpenUDID 创建的标识符： [https ://github.com/ylechelle/OpenUDID](https://github.com/ylechelle/OpenUDID)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-11T15:35:43.113

Apple 不再允许开发人员使用 UDID。但是，据说他们今天发布了一个替代方案，因此开发人员仍然可以收集分析数据，请参阅[http://www.macrumors.com/2012/06/08/apple-to-launch-new-app-usage-tracking-tools -for-developers-to-balance-user-privacy/](http://www.macrumors.com/2012/06/08/apple-to-launch-new-app-usage-tracking-tools-for-developers-to-balance-user-privacy/)

# ajax - 如何从链接中获取值并使用 mootools 发送表单？

> ID：10983175
> 
> 赞同：0
> 
> 时间：2012-06-11T15:30:41.177
> 
> 标签：ajax, mootools, response, mootools-events

我有一个这样的表格，里面有很多链接：

```
<form name="myform" action="" method="get" id="form">

<p>
<a href="getValue('A')" class="del">My link</a> 
</p>
<p>
<a href="getValue('B')" class="del">My link 2</a> 
</p>
<p>
<a href="getValue('C')" class="del">My link 3</a> 
</p>

<input type="hidden" name="division" value="" />        
</form> 
```

我想将表单的值从单击的链接发送到 php 脚本并获取响应（不重新加载页面）。

我正在尝试编写一个从链接获取值的函数：

```
<script type="text/javascript">
window.addEvent('domready', function() {
getValue = function(division)
{
var division;
division=$('form').getElements('a');        
}
</script> 
```

但我不知道如何以正确的方式编写它。接下来我想发送表格：

```
$$('a.del').each(function(el) {
    el.addEvent('click', function(e) {
    new Event(e).stop();

    $('form').submit(); 

    });
}); 
```

我应该如何发送它以从不重新加载页面的 php 文件中获取响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:03:51.420

我建议不要在 HTML 中嵌入 javascript，而是使用委托事件。我还将使用 ajax 调用而不是表单提交来发送表单。

```
<form id="form">
    <a data-value="A">My link</a>
    ...
</form>

<script>
    var formEl = document.id('form');
    formEl.addEvent('click:relay(.del)', function() {
        var value = this.getProperty('data-value');
        new Request.JSON({
            url: '/path/to/your/listener',
            onSuccess: function(data) {
                // ...
            }
        }).get({
            value: value
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T07:11:36.130

这对我有用：

```
<form id="form">
<a data-value="A">My link</a>
...
</form>

<script>
 var links = document.id('form').getElements('a');
 links.each(function(link) {

link.addEvent('click', function(e) {
    e.stop();  

    var value = link.getProperty('data-value');

var req = new Request.HTML({
url: "/path/to/your/listener", 
data: value,
onRequest: function(){
$('display').set('text', 'Search...');
  },
onComplete: function() { 

},
update    : $('display') 
}).get( 
{data: value}   
);  
});
})      
</script> 
```

# jquery - jQuery 函数在 Chrome 或 FF 中无法使用 Internet Explorer

> ID：10983176
> 
> 赞同：2
> 
> 时间：2012-06-11T15:30:43.033
> 
> 标签：jquery

我有获取表格 ID 并将内容复制到剪贴板的功能。该功能在 IE 中正常工作，但在 Chrome 或 FF 中不能正常工作。

请任何人帮忙。谢谢！

```
function clipBoard(tbID) {
    var div = document.getElementById(tbID);
    div.contentEditable = 'true';
    var controlRange;
    if (document.body.createControlRange) {
        controlRange = document.body.createControlRange();
        controlRange.addElement(div);
        controlRange.execCommand('Copy');
    }
   div.contentEditable = 'false';
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T15:44:57.677

Chrome 和 FF（以及所有其他非 IE 浏览器）不允许您使用`execCommand()`.

事实上，由于允许任意访问剪贴板的安全问题，没有单一的跨平台方法可以复制到剪贴板。

一些站点通过使用基于 Flash 的[`zeroclipboard`](http://code.google.com/p/zeroclipboard/).

# macos - 可加载捆绑包的图标

> ID：10983178
> 
> 赞同：1
> 
> 时间：2012-06-11T15:30:47.970
> 
> 标签：macos, icons, bundle

我有一个可加载的捆绑包；不是应用程序。我将 icns 文件存储在 Resource 目录中，并且 Info.plist 具有 CFBundleIconFile 的正确条目。我怎么知道？我在测试应用程序上使用了相同的技术和不同的图标。我什至重建了“lsregister”。10.6.x 或 10.7.x 都不会在 Finder 中显示图标。

我已经使用复制/粘贴到“获取信息”图标中更改了 Finder 中的图标。这会生成一个隐藏文件，其中包含一个名为 Icon^M 的资源分支。

问题：1）有没有办法让图标出现在可加载的包中？2) 是否有外壳程序或方法可以以编程方式更改“获取信息”图标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T19:13:32.787

解决方案在于 NSWorkspace 类的 -iconForFile 方法。我构建了一个命令行工具来获取我需要的图像并使用上述方法设置图标。

```
[[NSWorkspace sharedWorkspace] setIcon:content forFile:targetFile options: NSExclude10_4ElementsIconCreationOption ]; 
```

其中 content 是图标的 NSImage 内容，targetFile 是目标包的路径。

# android - 我的应用程序在模拟器 2.1/2.2 上运行良好，但在 2.2 设备上运行良好

> ID：10983180
> 
> 赞同：0
> 
> 时间：2012-06-11T15:31:01.193
> 
> 标签：android, build, sdk, screen

我编写了一个应用程序并将构建目标设置为 Gingerbread。我遵循了最初的 android 游戏书，所以我使用的 opengles 是 v1.0。我没有编写任何需要 v2.3 或更高版本的特定功能。min sdk 是 v7，目标是 10。该应用程序可以在我的姜饼手机和 ICS 平板电脑上完美运行。它在 2.1 和 2.2 模拟器上运行良好。但在 2.2 设备（摩托罗拉）上。该应用程序安装正常但挂在白屏上？有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:35:16.760

在您的手机上启用 USB 调试，然后在您的手机而不是模拟器上运行您的应用程序。并查看 cat 日志中出现的错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T10:20:35.270

我发现了问题。我以为我的纹理尺寸是两个值的幂。但我没有。重新调整，它工作正常

# ios - 入门 - 创建一个通过蓝牙命令控制另一个（非 iOS）设备的 iPhone 应用程序

> ID：10983182
> 
> 赞同：1
> 
> 时间：2012-06-11T15:31:06.033
> 
> 标签：ios, bluetooth

全部，

提前道歉 - 这个问题对于 SO 来说可能过于开放。

无论如何...我的一个朋友（一位工程师和企业家）正在建造一台高科技实验室设备。他问我构建一个允许用户通过蓝牙控制设备的 iPhone/iPad/iPod 应用程序的可行性，所以我正在帮助他收集一些信息。我希望得到一些关于如何开始的指示。具体来说：

1.  这是否需要原生应用程序，或者这可以通过 HTML5 来完成（有或没有 PhoneGap 之类的东西？）

2.  你能给我指出一个关于蓝牙网络的好入门吗？我发现的所有东西都假定了非常高水平的预先存在的知识。

3.  如何完成这样的事情的基础是什么？对于一个设备如何“控制”另一个设备，是否有一个单一的、已建立的协议，或者蓝牙更像 SSL - 只是一个允许您传达任何类型消息的管道？

我意识到这个问题非常广泛和详细 - 所以我并不是真的在寻找细节。但明显的谷歌搜索并没有出现太多，否则我很难找到一个好的起点。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:01:52.540

您可以通过两种方式通过蓝牙进行通信：一种是使用 iOS 5 和更新的 iPhone/ipad 的低功耗蓝牙功能。

[https://developer.apple.com/library/ios/#documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/_index.html#//apple_ref/doc/uid/TP40011295](https://developer.apple.com/library/ios/#documentation/CoreBluetooth/Reference/CoreBluetooth_Framework/_index.html#//apple_ref/doc/uid/TP40011295)

不幸的是，文档很少，需要一些修改。如果你选择这条路线，我会考虑从这里开始，并在侵入框架之前尽可能多地了解协议的工作原理：

[http://developer.bluetooth.org/gatt/services/Pages/ServicesHome.aspx](http://developer.bluetooth.org/gatt/services/Pages/ServicesHome.aspx)

此路由的局限性在于它可能不适合发送大量数据。我只构建了发送简单命令的东西，它确实非常适合。

另一种选择是外部附件框架。这将要求您从苹果获得 mfi 许可证（不好玩）。您还需要支付版税。但它会做你想做的事。如果您使用它，您将无需过多关注底层协议，该框架提供了一个友好的 api 用于处理流。

[http://developer.apple.com/library/ios/#documentation/ExternalAccessory/Reference/ExternalAccessoryFrameworkReference/_index.html](http://developer.apple.com/library/ios/#documentation/ExternalAccessory/Reference/ExternalAccessoryFrameworkReference/_index.html)

# php - 将 php POST 数组分配给 Javascript 数组

> ID：10983186
> 
> 赞同：1
> 
> 时间：2012-06-11T15:31:17.900
> 
> 标签：php, javascript, json

我知道这听起来可能与过去的一些 Q/A 相似，但我认为我的略有不同。我有一个网页，我想动态加载文本文件信息。我通过 iframe 上传文本文件，我想将此信息从 php 保存到 Javascript。每当我尝试将其保存为常规变量时，它都不起作用，因此我尝试通过将此信息保存为 $_POST 数组的一部分，在名为 $_POST['hidden_​​form'] 的隐藏表单下。每当我尝试将 php 读入 Javascript 时，我都会收到错误消息“Unexpected token ILLEGAL”。我尝试了以下两个代码：

```
for($i=0;$i< count($_POST['hidden_form']) ;$i++)
{
  echo "saved_form[$i]='" . $_POST['hidden_form'][$i]. "';\n";
} 
```

和 `saved_form = <?php echo json_encode($_POST['hidden_form']); ?>;`

[将 php 数组分配给 javascript 数组](https://stackoverflow.com/questions/8167620/assigning-a-php-array-into-a-javascript-array)

我认为该错误与指定数组所需的“'”有关，但不确定。我不知道从这里去哪里，所以任何帮助都将不胜感激。如果有更好的方法可以做到这一点，请告诉我。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:39:20.103

```
saved_form = '<?php echo addslashes(json_encode($_POST['hidden_form'])); ?>'; 
```

或者

```
for($i=0;$i< count($_POST['hidden_form']) ;$i++)
{
  echo "saved_form[$i]='" . addslashes($_POST['hidden_form'][$i]) . "';\n";
} 
```

两者都应该工作，可能有引号破坏了什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:48:33.653

我用过的最好的方法是，

文本/javascript

```
var saved_form = <?php echo json_encode($_POST['hidden_form']) ?> 
```

请注意，php 周围没有引号，因此您的 saved_form 是一个对象而不是字符串 json 字符串女巫会要求您使用`var form_object = eval(saved_form)`

@Lee 可能是这个意思？

只是一个注释，虽然我不会使用 Raw $_POST 将它传递给一个可以循环的函数，并 addSlashes 帖子中的每个值，比如

```
<?php
function arr_addSlashes($array){
    $ret = array();
    foreach($array as $k => $v){
        $ret[$k] = addSlashes($v);
    }
    return $ret;
}
?> 
```

# magento - 有没有办法将 Magento 动态分面搜索页面更改为静态页面？

> ID：10983191
> 
> 赞同：1
> 
> 时间：2012-06-11T15:31:33.850
> 
> 标签：magento, dynamic, seo, magento-1.4, faceted-search

我刚刚获得了扭转网站搜索引擎优化下降的任务。他们的问题之一是，由于它们现在被显示为动态多面搜索选项的一部分，因此它们排名良好的深层产品现在已被切断。它不能也不会被编入索引，分面搜索对于他们展示产品所需的方式很重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:44:35.757

您可以创建一个重写规则，使其看起来像是静态页面，但我建议不要这样做。

问问自己 Google 是否想要抓取搜索结果页面：可能不会。NOINDEX、NOFOLLOW 搜索结果和标签页面很常见，因为它们在内容方面质量低下。

[这是一个免费的扩展程序，可帮助您实现这一目标。](http://www.magentocommerce.com/magento-connect/Yoast/extension/920/yoast-metarobots)

[这是一篇关于 SEO 与 Magento 相关的有用文章。](http://yoast.com/articles/magento-seo/#noindexnoncontent)

听起来他们被熊猫/企鹅击中了。您应该专注于建立指向您的主要类别和主页的链接。清理质量差的页面（例如搜索结果页面）。建立指向性能良好的产品的深层链接，但会显着改变您的锚标签。如果没有链接，我们无法提供更多建议。

# sql - 使用复合主键插入 SELECT 失败 SQL Server 2008

> ID：10983196
> 
> 赞同：1
> 
> 时间：2012-06-11T15:32:01.777
> 
> 标签：sql, tsql

我有一个非常大的、未标准化的表，我正在修复它。从那个大表中，我正在对数据进行规范化。我使用了 SQL 语句

```
INSERT INTO smallTable(patientID, admissionDate, dischargeDate)
select distinct patientID, admissionDate, dischargeDate
FROM largeTable 
```

所以我的 smallTable 填充了正确的行数。还有另一列，`drgCode`我想添加到我的 smallTable 中。我尝试了以下查询来做到这一点

```
INSERT INTO smallTable(drgCode)
select drgCode from
(
SELECT DISTINCT patientID, admissionDate, dischargeDate, drgCode from largeTable) as t 
```

我收到的错误是`cannot insert the value NULL into patientID, column does not alloq nulls, insert fails`.

`drgCode`正确选择的唯一方法`select distinct`是使用查询的某些变体。当必须包含其他字段以缩小搜索范围时，如何仅插入一个字段。

我知道如果我清空我的 smallTable，我可以做到这一点，但我认为必须有办法解决它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T15:48:11.727

```
 with    drg as (SELECT DISTINCT patientID, admissionDate, dischargeDate, drgCode from largeTable)
    update  s
    set     s.drgCode = l.drgCode
    from    smallTable s join drg l on 
                s.patientId = l.patientId and
                s.admissionDate = l.admissionDate and
                s.dischargeDate  = l.dischargeDate 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T15:37:56.960

根据我的理解，如果您在两个表中都有“PatientID”是唯一的，您可以执行以下操作。

```
Update S
SET S.drgCode = L.drgCode
FROM
    SmallTable S
INNER JOIN
    LargeTable T
   ON S.PatientID = T.PatientID 
```

希望这可以帮助！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T15:50:02.000

当您对表执行插入操作时，查询中未指定的任何值都将填充为该列的默认值。如果列上没有默认值，将使用 NULL。您收到了该特定错误消息，因为您的列不允许 NULL 并且没有默认值。

鉴于您对 Praveen 的回复，也许您应该进一步规范化并将 drgCodes 放入单独的表中。

# git - 在收到错误“找到多个合并基础”后从一个 Git 分支合并到另一个分支

> ID：10983200
> 
> 赞同：0
> 
> 时间：2012-06-11T15:32:14.450
> 
> 标签：git, egit

我有一个 Git 存储库，其中包含三个分支，master、2.x 和 3.x。2.x 和 3.x 源自 master。每周从主分支发布到生产环境。2.x 和 3.x 包含将在未来发布的工作。从主分支发布生产版本后，我们立即从主分支合并到 2.x 和 3.x，以便最新的生产代码也进入 2.x 和 3.x。此外，我们经常从 2.x 合并到 3.x 以及在 3.x 上开发的功能最终需要与在 2.x 上开发的功能集成。

上周，我们从master合并到2.x和3.x之后，我们发现刚刚结束的master合并和之前的master合并之间没有人对3.x进行任何更改。现在，当我们尝试从 2.x 合并到 3.x 时，合并操作失败并出现错误“找到多个合并基”。

既然我们处于这种情况，是否可以从 2.x 合并到 3.x？我们使用 EGit 和 Eclipse Indigo 作为 Git 客户端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T09:25:20.050

谢谢@jthill。我使用 Linux 命令行客户端合并，合并成功。

# c++ - C中的动态大小数组

> ID：10983201
> 
> 赞同：0
> 
> 时间：2012-06-11T15:32:17.843
> 
> 标签：c++, c, arrays, pointers

这是我正在使用的代码片段：

```
int *a;
int  p = 10;

*(a+0) = 10;
*(a+1) = 11;
printf("%d\n", a[0]);
printf("%d\n", a[1]); 
```

现在，我希望它打印出来

```
10
11 
```

但是，会出现一个窗口，显示 program.exe 已停止工作。如果我注释掉第二行代码`int p = 10;`，然后再次调整代码，它就可以工作。

为什么会这样？（我想做的是创建一个动态大小的数组。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-11T15:35:35.563

可能至少有 50 个重复项，但找到它们可能并非易事。

无论如何，您正在定义一个指针，但没有内存可以指向*.* 您正在写入指针在启动时碰巧包含的任何随机地址，从而产生未定义的行为。

~~此外，您的代码不会编译，因为`int *a, int p = 10;`在语法上不正确——逗号需要变成分号（或者您可以去掉第二个`int`，但我不会真的推荐）。~~

在 C 中，您可能想要使用数组而不是指针，除非您需要动态分配空间（哎呀，重读，您显然确实想要——所以你需要使用`malloc`来分配空间，比如`a = malloc(2);`——但是你还想在使用前检查返回值——至少理论上`malloc`可以返回一个空指针）。在 C++ 中，您可能希望使用 a`std::vector`而不是数组或指针（它将为您管理动态分配）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T15:34:03.503

*没有为 分配内存*，`a`它只是一个*未初始化的指向*int 的指针（所以有两个问题）。

因此，当数据存储在该位置时，行为是**undefined**。这意味着您有时甚至可能不会遇到分段错误/程序崩溃，或者您可能 -> 未定义。（由于 C 不做任何边界检查，它不会提醒你这些问题。不幸的是，C 的优点之一也是它的主要弱点之一，它会很乐意做你所要求的）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T15:35:06.997

你甚至没有分配内存，所以你正在访问无效的内存......

使用 malloc 为您的数组分配足够的内存：

```
int* a = (int*) malloc(sizeof(int)*arraySize);
//Now you can change the contents of the array 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T15:50:28.407

您将需要使用 malloc 为该数组分配内存。

如果您希望动态调整大小，则每次希望增加数组大小时都需要使用 realloc 而不破坏已经存在的数据

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-11T15:38:05.343

首先 a 尚未初始化。它指向什么？没什么，希望为零，但你不知道。

然后您将 1 添加到它并访问该字节。如果 a 为 0，则 a+1 将为 1。内存位置 1 中是什么？

此外，您正在通过一个可寻址的内存单元来增加地址。这可能是也可能不是该机器上整数的大小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-11T15:34:16.640

您必须为阵列分配存储空间。`malloc`如果你在 C 中使用，`new`如果它是 C++，或者`std::vector<int>`如果你真的需要动态数组大小，则使用 C++。

# regex - 正则表达式：依次检测多次出现的换行符并替换为换行符

> ID：10983208
> 
> 赞同：-2
> 
> 时间：2012-06-11T15:32:46.200
> 
> 标签：regex

我需要一个正则表达式，它将按顺序检测多次出现的换行符并用一个新行替换。这可能吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:35:23.610

是的，例如：

```
(\r?\n)+ 
```

替换为第一个捕获组的内容。

# entity-framework-4.1 - ObjectParameter 的返回值为 null

> ID：10983210
> 
> 赞同：0
> 
> 时间：2012-06-11T15:33:04.923
> 
> 标签：entity-framework-4.1, odp.net

首先，我为我糟糕的英语道歉。

我正在使用实体框架来映射 Oracle 数据库上的存储过程。下面的代码是我写的调用存储过程并使用ObjectParameter返回值。

```
ObjectParameter p_TotalCount = new ObjectParameter("TOTALCOUNT", typeof(int));
ObjectParameter p_TotalCountPos = new ObjectParameter("TOTALCOUNT_POS", typeof(int));

ObjectResult<EVENT_FULLTEXT_RESULT> res = ctx.GET_EVENTS_FULLTEXT2(p1, p2, ..., p_TotalCount, p_TotalCountPos);

totalCount = Convert.ToInt32(p_TotalCount.Value);
totalCountPos = Convert.ToInt32(p_TotalCountPos.Value); 
```

与我从 PLSQL 开发人员调用存储过程时返回的结果不同，在这种情况下 p_TotalCount.Value 返回 null。

遵循为该存储过程生成的实体框架的映射

```
<FunctionImport Name="GET_EVENTS_FULLTEXT2" ReturnType="Collection(Model.EVENT_FULLTEXT_RESULT)">
        <Parameter Name="p1" Mode="In" Type="String" />
        ...
        ...

        <Parameter Name="TOTALCOUNT" Mode="Out" Type="Decimal" />
        <Parameter Name="TOTALCOUNT_POS" Mode="Out" Type="Decimal" />
      </FunctionImport> 
```

# maven - 如何处理 Maven 中的版本？

> ID：10983213
> 
> 赞同：1
> 
> 时间：2012-06-11T15:33:09.013
> 
> 标签：maven, maven-3

我在父 pom 和子 pom 中都有所有这些版本号，包括像这样的父参考

```
 <parent>
     <groupId>com.cigna.ifp</groupId>
     <artifactId>ifp-core</artifactId>
     <version>${parent.version}</version>
  </parent> 
```

以及对其他子项目的依赖引用，就像这样

```
<dependency>
  <groupId>com.cigna.ifp</groupId>
  <artifactId>ifp-shared</artifactId>
  <version>1.0-SNAPSHOT</version>
</dependency> 
```

最后是我们正在构建的东西版本的声明

```
 <modelVersion>4.0.0</modelVersion>
  <groupId>com.company</groupId>
  <artifactId>artifcat</artifactId>
  <version>1.0-SNAPSHOT</version>
  <packaging>jar</packaging>
  <name>ifp-shared</name>
  <url>http://maven.apache.org</url> 
```

根据一些解决了一半问题的答案进行编辑...

我们希望所有版本都是 ${project.version} 因为它实际上只是一个具有一个发行号的项目。

我似乎可以在依赖项中执行 ${project.version} ，但这在上面的父 xml 代码中不起作用。还有其他方法吗？（伙计，我真的应该切换到 gradle）。

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:37:32.233

```
<parent>
 <groupId>com.cigna.ifp</groupId>
 <artifactId>ifp-core</artifactId>
 <version>1.2.3-SNAPSHOT</version> <!-- real version-->
</parent>

<artifactId>blah</artifactId>
<!-- No version here, will be inherited -->

<dependency>
  <groupId>com.cigna.ifp</groupId>
  <artifactId>ifp-shared</artifactId>
  <version>${project.version}</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:36:43.643

project.version 是你想要的。不是父版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:52:26.467

您需要使用dependencyManagement 标记将依赖项的父pom 中的版本居中。

看到这个问题和答案

[maven中依赖管理和依赖的区别](https://stackoverflow.com/questions/2619598/differences-between-dependencymanagement-and-dependencies-of-maven)

对于您自己的模块，一些属性是从父 pom 继承的。您需要在每个孩子中声明父版本，但如果您希望它们与其父版本相同，则不需要在您的孩子 pom 中声明 groupId/version。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T12:48:31.850

我们切换到了 gradle，它现在工作得非常好。每个自动构建一个新版本都作为 1.2.x 发布，其中 x 是下一个构建号。下游，项目依赖 1.2.+。这使得每个版本都是官方的，因此 QA 可以对其进行测试、拒绝或继续，是的，构建 1.2.568 是我们将向全世界发布的版本。项目可以依赖于 1.2。但是他们没有得到错误修复。当您给 QA 一个快照并且他们批准并且您必须更改并进行另一个构建时，这似乎比所有那些快照废话要好得多。我们希望每个构建看起来都是官方的，这样他们就可以发布恰好通过所有 QA 测试的构建。

# google-maps - 谷歌地图相关的自定义标记

> ID：10983214
> 
> 赞同：0
> 
> 时间：2012-06-11T15:33:14.610
> 
> 标签：google-maps, google-maps-markers

我正在尝试制作自定义地图，但我不知道是否需要“Google Maps JavaScript API”。情况如下：

我需要在地图特定区域的某些位置放置几个标记并单击这些标记中的任何一个，它将显示其他相关标记（标记子标记）并隐藏与此父标记无关的其他标记。

我考虑过创建几个地图，一个主地图会出现父地图，并且每个父标记都会显示一个带有父标记的地图及其

孩子们。我可以在没有这个 API 的情况下做到这一点，但我不知道如何单击父标记，并且子标记与父标记一起出现。

我考虑在每个标记的描述中创建一个链接，该链接将定位到“我的页面”，并根据链接的参数显示请求的地图，但问题是此链接生成一个空白目标而不是自我。

有谁知道我在做什么，我在正确的轨道上还是应该改变推理？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:01:24.177

您将需要使用 API。

我认为基本方法是这样的：

1.  将所有标记加载到 JS 数组或对象中，以便您以后可以引用它们，跟踪父/子关系（或者如果需要，您可以在步骤 3 中 AJAX 加载子项）。
2.  使用 显示所有父标记`.setMap(yourmap)`。
3.  为父标记添加一个点击监听器，它将调用`.setMap(null)`所有其他父标记，并调用`.setMap(yourmap)`父标记的子标记。

看：

[API 文档](https://developers.google.com/maps/documentation/javascript/reference)

[叠加指南](https://developers.google.com/maps/documentation/javascript/overlays)

# linux - 使用 SATA HDD 作为块设备

> ID：10983215
> 
> 赞同：1
> 
> 时间：2012-06-11T15:33:31.257
> 
> 标签：linux, driver, linux-device-driver, hdd, block-device

我对 Linux 内核完全陌生，所以我可能把事情搞混了。但任何建议都会对我有所帮助；）

我有一个通过 PCIe SATA 卡连接的 SATA HDD，我尝试在块设备上使用`read`和喜欢。`write`我还希望将数据断电保存在 HDD 上 - 不缓存。最后我必须分析我在每个 linux 堆栈层中浪费了多少时间。而是一步一个脚印。

目前，我尝试`open`使用 *O_DIRECT* 访问设备。但是我真的不明白在哪里可以找到该设备。它显示为`/dev/sdd`，我创建了一个分区`/dev/sdd1`。

*   `open`并`read`在分区`/dev/sdd1`工作。`write`*O_DIRECT* 失败（但我确定我有正确的块大小）
*   `open` `read`并`write`呼吁`/dev/sdd`完全失败。
*   是否有另一个文件`/dev/`代表我在块层上的设备？
*   我的错误和错误假设是什么？

这是我当前的测试代码

```
int main() {
    int w,r,s;
    char buffer[512] = "test string mit 512 byte";

    printf("test\n");

    // OPEN
    int fd = open("/dev/sdd", O_DIRECT | O_RDWR | O_SYNC);
    printf("fd = %d\n",fd);

    // WRITE
    printf("try to write %d byte : %s\n",sizeof(buffer),buffer);
    w = write(fd,buffer,sizeof(buffer));
    if(w == -1) printf("write failed\n");
    else printf("write ok\n");

    // RESET BUFFER
    memset(buffer,0,sizeof(buffer));

    // SEEK
    s = lseek(fd,0,SEEK_SET);   
    if(s == -1) printf("seek failed\n");
    else printf("seek ok\n");

    // READ
    r = read(fd,buffer,sizeof(buffer));
    if(r == -1) printf("read failed\n");
    else printf("read ok\n");

    // PRINT BUFFER
    printf("buffer = %s\n",buffer);

    return 0;
} 
```

编辑：我在电源架构上使用 3.2 内核 - 如果这很重要。

非常感谢您的宝贵时间，Fabian

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T03:39:09.340

根据您的 SDD 的块大小（可能是 512 位或 4K），您只能读取/写入该大小的多个。

另外：使用 O_DIRECT 标志时，您需要确保缓冲区与块边界正确对齐。您不能确保使用普通的 char 数组，而是使用 memalign 来分配对齐的内存。

# javascript - DynaTree ContextMenu 复制/粘贴不起作用

> ID：10983218
> 
> 赞同：0
> 
> 时间：2012-06-11T15:33:55.653
> 
> 标签：javascript, jquery, contextmenu, dynatree

我遇到了 DynaTree 的问题，这是一个 jQuery 插件，它允许我从无序列表生成树视图。问题是我试图用它来实现一个上下文菜单，就像[这里](http://wwwendt.de/tech/dynatree/doc/samples.html)的菜单一样，不管我做什么，这行：

```
var node = $.ui.dynatree.getNode(el); 
```

拒绝正常工作，这意味着无论如何，当我通过chrome的“检查元素”视图查看节点对象时，它始终为空。我想知道是否有人以前遇到过这个问题，如果他们可以帮助我。谢谢。

或者，如果有人知道如何选择或至少从我刚刚右键单击/鼠标悬停的元素中获取数据，那也可以很好地工作。非常感谢，提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:11:12.030

我假设你看过 [http://wwwendt.de/tech/dynatree/doc/sample-contextmenu.html](http://wwwendt.de/tech/dynatree/doc/sample-contextmenu.html)

`el`应该是一个 DOM 元素，可以通过 event.target 获得，或者由上下文菜单的回调处理程序传递。

# ruby-on-rails - image_tag 经常导致图片无法加载

> ID：10983220
> 
> 赞同：0
> 
> 时间：2012-06-11T15:33:59.080
> 
> 标签：ruby-on-rails, image, asset-pipeline

我刚刚开始在 rails 3 中正确使用资产管道，并且正在使用 image_tag 助手而不是硬编码`<img>`。几乎在每次页面加载时，布局中的许多图像都不会加载。如果我刷新几次，它们就会加载，但结果是大多数时候页面都是一团糟。有没有人有这方面的经验，我该如何让它停止？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:31:18.110

image_tag*本身*除了使用正确的路径等为您生成标签之外没有做任何事情`<img>`。如果您查看提供给浏览器的源代码，那么您的图像标签之间不应该有任何显着差异，无论它们是'是否已被硬编码。

当你得到一个乱七八糟的页面时，查看源代码并将路径复制到其中一个损坏的图像。完全构造该 url 并将其放入浏览器中，以查看是否可以使用 html 图像标记中给出的路径仅检索图像。如果图像检索不完整，那么这与您的资产的服务方式有关，而不是 rails image_tag 帮助程序。

还要查看是否正在进行任何缓存 - 可能某些图像在正确保存之前被缓存，并且浏览器已经缓存了存在“丢失图像”的事实，并且未来对该图像的请求被破坏。硬刷新页面是否有助于加载损坏的图像？

# file - Tomcat环境下Java JSP应用文件定位的最佳实践

> ID：10983229
> 
> 赞同：2
> 
> 时间：2012-06-11T15:34:26.553
> 
> 标签：file, jsp, tomcat

我的 Java JSP 应用程序需要在 Tomcat Web 服务器上存储永久文件。目前我将文件保存在系统的“/ temp”文件夹中。但是这个文件夹会不时被清除。此外，当前的解决方案是硬编码的，这使得它不太灵活（例如，当移动到另一台服务器时）。

我想现在是否有在此配置中*定义*和*访问*永久目录的最佳实践。详细地说，定义应用程序文件目录的最佳位置在哪里，我如何从我的 java 应用程序中访问它？此设置的目标是在 (a) 更新应用程序（即放置一个新的 war 文件）和 (b) 从一台服务器移动到另一台服务器和操作系统（例如 Unix、Windows、MacOS）时尽量减少工作量。

到目前为止，我对该主题所做的研究表明，以下是解决方案（可能包括其他）：

1.) 使用 Tomcat 安装目录中的自定义子目录。

*   如果我通过 war 文件在 tomcat 上部署新版本，文件会怎样？
*   我在哪里定义要从我的 Java 应用程序中访问的目录？

2.) 在文件系统的单独目录中。

*   在不了解系统的情况下，哪些是好的位置或获取位置的方法？
*   我在哪里定义要从我的 Java 应用程序中访问的目录？

感谢您的意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:39:17.107

本质上，您正在以某些文件的形式创建“数据库”。在 Java EE 和 servlet 容器的世界中，唯一真正通用的方法是通过 JNDI 配置这样的资源。Tomcat 和其他容器没有“为 Web 应用提供持久存储空间”的概念。如果 webapp 需要持久存储，则需要通过 JNDI 或 -D 或您通过向其发布内容来告诉它的内容对其进行配置。没有可以借鉴的惯例或标准做法。

您可以按照约定选择文件系统路径名并记录该约定（例如 Linux 上的 /var/something，Windows 上类似的东西）。但你不一定会与其他人正在做的事情保持一致。

# java - Android AsyncTask 确保所有数据都已加载

> ID：10983230
> 
> 赞同：0
> 
> 时间：2012-06-11T15:34:27.770
> 
> 标签：java, android, multithreading, android-asynctask

嗨，我正在尝试创建一个运行两个函数的 Asynctask，当它们完成加载时，然后用数据填充 UI。目前出于某种原因，它仅使用来自某个函数的数据填充 UI，并且哪个函数首先完成加载。

例如

我有两个函数 LoadNewsFeed() 和 LoadResultsFeed() 目前 loadResultsFeed() 显示数据而不是 loadNews() 中的任何内容但是如果我注释掉 LoadResultsFeed() 来自 loadNews 的数据填充 UI 而不是来自 loadResultsFeed

有没有一种方法可以将其设置为如果完成加载，加载另一个而不是执行 FillData() 函数？

这是我到目前为止所拥有的

公共类 PostTask 扩展 AsyncTask {

```
 @Override
    protected Boolean doInBackground(Void... params) {
        boolean result = false;

        loadNewsFeed();

        publishProgress("method1");
        loadResultsFeed();
        publishProgress("method2");
        return result;
    }

    protected void onProgressUpdate(String... progress) {
        StringBuilder str = new StringBuilder();
            for (int i = 1; i < progress.length; i++) {
                str.append(progress[i] + " ");

            }
    }

        @Override
    protected void onPostExecute(Boolean result) {
        super.onPostExecute(result);
        Log.v("BGThread", "begin fillin data");
         FillData();
    }
} 
```

这是我的 FillData() 函数

```
public void FillData(){ 

     if (ChosenMethod.equals("Team")) {

        arrayAdapter = new ArrayAdapter<String>(this, R.layout.single_item, newsList);

         String[] mStrings = (String[]) imageList.toArray(new String[imageList.size()]);
         String[] news = (String[]) newsList3.toArray(new String[newsList3.size()]);

         arrayAdapter3 = new LazyAdapter(this, mStrings, news);

            ListView list = getListView();
               list.setTextFilterEnabled(true);

               LayoutInflater inflater = (LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE );
                View header = inflater.inflate( R.layout.homeheader, list, false);
                View header2 = inflater.inflate( R.layout.homeheader2, list, false);
                View header3 = inflater.inflate( R.layout.homeheader3, list, false);

        //setListAdapter (arrayAdapter);

                 resultsView = LayoutInflater.from(getBaseContext()).inflate(R.layout.resultscell,
                         null);

               TextView homeTeam = (TextView) resultsView.findViewById(R.id.HomeTeam);
               homeTeam.setText(HomeTeam);

               TextView awayTeam = (TextView) resultsView.findViewById(R.id.AwayTeam);
               awayTeam.setText(AwayTeam);

               TextView homeScore = (TextView) resultsView.findViewById(R.id.HomeScore);
               homeScore.setText(HomeScore);

               TextView awayScore = (TextView) resultsView.findViewById(R.id.AwayScore);
               awayScore.setText(AwayScore);

               TextView attendance = (TextView) resultsView.findViewById(R.id.Attendence);
               attendance.setText("Att:" + Attendance);

               TextView division = (TextView) resultsView.findViewById(R.id.Division);
               division.setText(Division);

               Log.v("BGThread", "Filled results");

            adapter = new MergeAdapter();
            adapter.addView(header);
            adapter.addAdapter(arrayAdapter);
            adapter.addView(header2);
            adapter.addView(resultsView);
            adapter.addView(header3);
            adapter.addAdapter(arrayAdapter3);
            setListAdapter(adapter);

            Log.v("BGThread", "Filled Merge Adapter Team");

     } else {

         arrayAdapter = new ArrayAdapter<String>(this, R.layout.single_item, newsList);
            arrayAdapter2 = new ArrayAdapter<String>(this, R.layout.single_item, newsList2);
            //arrayAdapter3 = new ArrayAdapter(this, R.layout.complex_item, newsList3);

             String[] mStrings = (String[]) imageList.toArray(new String[imageList.size()]);
             String[] news = (String[]) newsList3.toArray(new String[newsList3.size()]);

             arrayAdapter3 = new LazyAdapter(this, mStrings, news);

                ListView list = getListView();
                   list.setTextFilterEnabled(true);

                   LayoutInflater inflater = (LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE );
                    View header3 = inflater.inflate( R.layout.homeheader3, list, false);

            //setListAdapter (arrayAdapter);

                adapter = new MergeAdapter();
                adapter.addView(header3);
                adapter.addAdapter(arrayAdapter3);
                setListAdapter(adapter);

                Log.v("BGThread", "Filled Merge Adapter League");
         } 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:27:19.197

如果使用 AsyncTask 并不重要，我建议使用 Thread 类和 Handler，

1.  您可以使用`join`具有这两个方法的类，让它`implement Runnable`接口，然后您可以创建该类的对象并将其传递给 Thread 构造函数。然后在线程上使用join，这意味着直到并且除非线程死亡它不会执行下面的行，并且在join之后，使用这些行将数据放在UI上。

2.  你也可以`CountDownLatch`从`java.util.Concurrent`包中，等待具体工作完成，然后进一步执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:47:01.883

一种快速简便的方法是向您的类添加一个布尔字段，这最初是正确的：

```
private boolean bothFeedsLoaded = true; 
```

然后在 onPostExecute 中切换它的值：

```
bothFeedsLoaded = !bothFieldsLoaded; 
```

在您的 FillData 方法中：

```
if (!bothFeedsLoaded){return;} 
```

由于 bothFeedsLoaded 最初为 true，因此对 onPostExecute 的第一个回调（在先加载哪个 feed 之后）会将其更改为 false。因此，您的 fillData 方法将不做任何事情而返回。当第二个提要完成加载时， onPostEexcute 会将其更改回 true 并且您的 fillData 将执行此操作。

或者（也许在 6 个月内更容易阅读）是使用整数：

```
private int feedsLoaded = 0;

.....

feedsLoaded ++;

.....

if (feedsLoaded != 2) {return;} 
```

有更好的方法，例如为每个加载任务创建单独的类，然后在它们各自的 onPostExecute 回调中将它们与信号量同步，但这应该可行。

# jquery-mobile - jquery mobile Mobipick - 将最小日期设置为从今天开始的 4 天

> ID：10983234
> 
> 赞同：0
> 
> 时间：2012-06-11T15:34:43.967
> 
> 标签：jquery-mobile, datepicker

我最近发现了 mobipick 日历，我非常喜欢它，因为它的性能很快。
但是，我在设置从现在起四天后的最短日期时遇到了一些麻烦。
如果你去 mobipick 网站，你可以在 html 属性中添加 min="..." ，但它没有指定今天的日期。
以下代码也可以在网站上找到，我该如何实现？

**Javascript/Jquery**

```
<script type="text/javascript">
$(document).ready(function () {
    var picker = $("#picker", this);
    picker.mobipick();

    picker.bind("change", function () {
        var date = $(this).val();

        // formatted date                   
        var dateObject = $(this).mobipick("option", "date");
    });
});
</script> 
```

**HTML**

```
<input id="picker"  type="text" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T21:16:31.623

为了设置从现在起四天后的最小日期，请创建一个输入元素

```
<input type="text" /> 
```

并添加这个 JavaScript

```
$( selector ).mobipick({
    minDate: (new XDate()).addDays( 4 )
}); 
```

[您需要 0.6 版本才能在 GitHub https://github.com/sustainablepace/mobipick](https://github.com/sustainablepace/mobipick)上运行、下载或分叉此示例。我还在[http://mobipick.sustainablepace.net/demo-advanced.html](http://mobipick.sustainablepace.net/demo-advanced.html)添加了一个工作示例，请参阅“具有动态最小日期的日期选择器”部分。

让我知道这是否适合您。

# java - 自动调整大小的 JFrame 容器

> ID：10983236
> 
> 赞同：0
> 
> 时间：2012-06-11T15:34:44.810
> 
> 标签：java, swing, jframe, resize

如何使我的`JFrame`自动调整大小？大小取决于框架中现有的组件，但用户可以动态添加更多组件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T15:37:52.893

您可以使用该[`JFrame.pack()`](http://docs.oracle.com/javase/7/docs/api/java/awt/Window.html#pack%28%29)方法，根据文档：

> 使此 Window 调整大小以适合其子组件的首选大小和布局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:36:15.623

有关动态添加的组件（使用按钮添加的标签 - 在滚动窗格中）以及可调整大小的 GUI，请参阅[嵌套布局示例。](https://stackoverflow.com/a/5630271/418556)

![](../Images/f9e492eec81701d836e83834a893afb0.png)

# c# - 以编程方式更改 web.config 中的会话超时

> ID：10983238
> 
> 赞同：1
> 
> 时间：2012-06-11T15:34:54.733
> 
> 标签：c#, asp.net, .net, web-config, session-timeout

我有一个要求，我必须以编程方式更改连接字符串和会话超时，两者都需要写入 web.config 并保存在硬盘上。我可以如下更改连接字符串，但努力为会话超时完成相同的操作，可以以某种方式完成吗？

```
 var configuration = WebConfigurationManager.OpenWebConfiguration("~");
 var section = configuration.GetSection("connectionStrings");
 section.ConnectionStrings["MyConnectionString"].ConnectionString = "Data Source=...";
 configuration.Save(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T20:45:40.743

这个简短的问答字符串显示[了如何以编程方式设置超时](http://forums.asp.net/t/319449.aspx/1)。就像其他人说的那样，我不确定为什么你会被要求这样做，但如果你是，你就是。

# windows-phone-7 - Windows Phone 磁贴动画，如 Xbox Live

> ID：10983241
> 
> 赞同：1
> 
> 时间：2012-06-11T15:34:56.883
> 
> 标签：windows-phone-7

Windows Phone 中的 Xbox Live 磁贴动画比我能够制作的所有磁贴动画更加动态。

是否可以在我的动态磁贴中以某种方式模仿该动画？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:38:29.463

您不能拥有那种程度的动画动态磁贴，目前只有第一方应用程序可以访问此功能。

[http://www.opinionatedgeek.com/Blog/BlogEntry=000554/BlogEntry.aspx](http://www.opinionatedgeek.com/Blog/BlogEntry=000554/BlogEntry.aspx)

您在主桌面上获得的唯一动画是背景/前景瓷砖翻转动画，但这又是由操作系统控制的。

这在一定程度上是有道理的，否则来自第三方应用程序的动画动态磁贴的数量可能会迅速降低您的电池电量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T20:26:17.007

在 Microsoft Silverlight for Windows Phone Toolkit 7.1 ( [http://silverlight.codeplex.com/](http://silverlight.codeplex.com/) ) 中有一个名为**HubTitle**的控件，它允许一些额外的（非常酷的）图块模板......

# javascript - 不确定 .on() 方法

> ID：10983244
> 
> 赞同：5
> 
> 时间：2012-06-11T15:34:58.700
> 
> 标签：javascript, jquery

我正在使用`$.click()`触发某些事件的方法。但是我需要在元素被声明之前为一些 HTML 元素设置一些事件。让我们以此为例：

```
<script>
    $('div.hide').click(function() {
        $('div.hide').css({'display' : 'none'});
     });
</script>
<div class="hide">some text</div> 
```

缺点是设置`.click()`方法时，`div.hide`元素不存在，所以没有设置触发器。

所以我转向了这个`.on()`方法，就像这样：

```
<script>
    $('div.hide').on('click', function() {
        $('div.hide').css({'display' : 'none'});
    });
</script>
<div class="hide">some text</div> 
```

但这也行不通。我认为调用`.on()`会使所有现有和未来`div.hide`的元素触发`'click' function()`.

我设法克服了这种不便，但就我自己的知识而言，我想知道我做错了什么。有没有办法为未来的 HTML 元素分配触发器？

我的解决办法是：

```
<script>
    $(document).ready( function() {
        $('div.hide').click(function() {
            $('div.hide').css({'display' : 'none'});
        });
    });
</script>
<div class="hide">some text</div> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-11T15:35:57.653

您错过了三参数版本：

```
$('body').on('click', 'div.hide', function() { ... }); 
```

That puts the handler on the `<body>` but it catches the events that bubble and invokes the handler when the target element matches the selector (the second argument).

The handler doesn't have to go on the `<body>`; it can be any parent container element of your `<div>`.

The "on" method replaces the older "live" and "delegate" methods, as well as "bind" itself.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-11T15:53:31.840

Use [jQuery.live method](http://api.jquery.com/live/) to attach an event handler for all elements which match the current selector, now and in the future

# jquery - jQuery：淡化 CSS 悬停在静态按钮顶部？

> ID：10983250
> 
> 赞同：0
> 
> 时间：2012-06-11T15:35:32.910
> 
> 标签：jquery, css, button, navigation

我正在创建一个导航，并且已经为按钮创建了 CSS 属性。

我想淡入静态按钮属性之上的悬停属性。

这样做最有效的方法是什么？

CSS看起来像这样：

```
<div id="nav">
    <form method="post" action="">
        <a>Home</a>
        <a>Link2</a>
        <a>Link3</a>
    </form>
</div>

#nav {
position:absolute;
margin-top:96px;
margin-left:30px;
height: 450px;
width: 140px;
font-family:"Book Antiqua";}

#nav a {
background:url(Images/Button.png);
height:28px;
width:130px;
font-family:"Book Antiqua";
font-size:14px;
text-align:center;
color:#C60;
text-decoration:none;
background-position:center;
margin:auto;
display:block;
position:relative;
line-height:190%;
}

#nav a:hover {
background:url(Images/Button%20Hover.png);
height:34px;
width:140px;
font-family:"Book Antiqua";
font-size:16px;
text-align:center;
color:#C60;
text-decoration:none;
margin:-3px;
z-index:2;
line-height:210%;
text-indent:-10px;}

#nav a:active {
background:url(Images/Button%20Hover.png);
height:34px;
width:140px;
font-family:"Book Antiqua";
font-size:14px;
text-align:center;
color:#862902;
text-decoration:none;
margin:0 -3px;
z-index:2;} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:39:11.157

使用`transition`css的属性...

```
-webkit-transition:all .3s;
-moz-transition:all .3s;
-o-transition:all .3s;
-ms-transition:all .3s; 
```

将此添加到`#nav a`...

这适用于 Google Chrome、Mozilla Firefox、Opera 和最新的 IE...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:46:21.330

如果你想用 jQuery 来做，那么给你一个悬停状态类。像这样：

```
#nav a:hover, #nav a.j-hover { .... } 
```

现在在 jQuery 中使用[toggleClass](http://docs.jquery.com/UI/Effects/toggleClass)函数，如下所示：`hover`

```
$('#nav a').hover(function () {
      $(this).toggleClass("js-hover", 1000);
}); 
```

# objective-c - 在 Interface Builder 中使 NSButton 跟随 ScrollView

> ID：10983254
> 
> 赞同：0
> 
> 时间：2012-06-11T15:35:40.113
> 
> 标签：objective-c, macos, cocoa, osx-lion, osx-snow-leopard

我目前有一个 NSOutlineView，上面有一个 NSButton。当 NSOutlineView 滚动时，NSButton 保持原位。也就是说，它仍然在文本之上，覆盖它下面的任何东西。

我试图将 NSButton“固定”到 NSScrollView 上的一个点，这样当滚动视图时，NSButton 会跟随内容。

有没有办法在 Interface Builder 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:38:16.437

您必须使按钮成为滚动视图的子视图。打开 Interface Builder 左侧的大纲视图，将 UIButton 拖到 scrollView 上，使其缩进

1.  打开大纲视图
2.  拖动按钮使其位于滚动视图下方 - 它不是它的子视图

![在此处输入图像描述](../Images/3ba389946880c31e978ec19b1fef463a.png)

# c# - XNA Tcp 网络

> ID：10983267
> 
> 赞同：0
> 
> 时间：2012-06-11T15:36:38.197
> 
> 标签：c#, sockets, networking, tcpclient, multiplayer

我已经为我正在开发的 XNA 游戏设置了一个成功的 Tcp 服务器，我已经在代码中实现了客户端，但是我在接收消息时遇到了问题。我知道它必须为收到的每条消息进行更新，但只要我更新接收，XNA 就会冻结？我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:38:51.757

尝试使消息调用异步。你在使用 WCF 吗？

如果您使用的是 TcpClient （您的其他问题提到了它......）然后尝试查看 BeginConnect 方法（http://msdn.microsoft.com/en-us/library/ms145193.aspx）并传入一个 AsyncCallback 对象- AsyncCallback 上的 MSDN 页面（此处 - [http://msdn.microsoft.com/en-us/library/system.asynccallback.aspx](http://msdn.microsoft.com/en-us/library/system.asynccallback.aspx)）有一个异步 TcpClient 调用的示例。

这应该会阻止 XNA 在等待响应时冻结。

# c# - 在 ASP.NET/C# 中更改 MenuItem 文本

> ID：10983269
> 
> 赞同：2
> 
> 时间：2012-06-11T15:36:43.173
> 
> 标签：c#, asp.net

我有一个这样的 ASP 菜单：

```
<asp:Menu ID="NavigationMenu" runat="server" 
 EnableViewState="False" IncludeStyleBlock="False"
 Orientation="Horizontal" meta:resourcekey="NavigationMenuResource1">
       <Items>
             <asp:MenuItem NavigateUrl="~/Default.aspx" Text="<% MenuItemResource1 %>" meta:resourcekey="MenuItemResource1"/>
             <asp:MenuItem NavigateUrl="~/Products.aspx" Text="Products" meta:resourcekey="MenuItemResource2" />
       </Items>
</asp:Menu> 
```

我想要做的是根据用户语言选择（CultureInfo）更改 MenuItem 文本。例如，“产品”部分在法语中应称为“产品”。

我为英语和法语添加了一个 .resx 文件。如果我使用带有 Id 的 < div> 元素，则可以正常工作。问题是 asp MenuItem 似乎没有 ID，所以我无法访问它。像示例一样，我尝试将第一个 MenuItem 文本设置为“资源”项，但是当我更改语言时，文本并没有改变。

如何更改该文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T08:32:58.430

If you want to change the Menu Item Text Dynamically, Try this.

```
Menu1.Items[0].Text="Home"; // For Text
Menu1.Items[0].NavigateUrl="~/Default.aspx"; // For Url 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:44:28.557

在页面加载时，您设置文本，导航 url

```
NavigationMenu.Items.Add(new MenuItem
        {
            Text = "Your text goes here",
            NavigateUrl = "Your URL goes here"
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:45:28.610

```
 System.Reflection.FieldInfo[] fi = 
    this.GetType().GetFields(BindingFlags.Public | 
    BindingFlags.Instance | BindingFlags.NonPublic);

for (int i = 0; i < fi.Length; ++i)
{
    FieldInfo info = fi[i];

    //info can be Button, Menuitem, ToolbarButton.....
    //info.Name returns true name of control
    //        - menuItem1, btnChangelanguage....
    if (typeof(MenuItem) == info.FieldType)
    {
        MenuItem item = (MenuItem)info.GetValue(this);
        item.Text = resources.GetString(info.Name + ".Text");
    }
} 
```

[http://www.codeproject.com/Articles/14615/Dynamically-changed-menu-items-according-to-Cultu](http://www.codeproject.com/Articles/14615/Dynamically-changing-menu-items-according-to-Cultu)

# javascript - 关于 CPU 消耗的 JavaScript 命名函数和事件处理程序

> ID：10983271
> 
> 赞同：0
> 
> 时间：2012-06-11T15:36:53.347
> 
> 标签：javascript, dom-events, cpu-usage

在按照@FlorianMargaine 的建议（在 JavaScript 聊天对话中）重构我的代码后，我得到了如下所示的内容：

```
body.addEventListener( 'mousedown', action1);
function action1(){
    //Start selecting event
    body.addEventListener( 'mousemove', selectOver);
}
function selectOver(e){
    //after the user has selected and done a mouse up event show a box:
    body.addEventListener( 'mouseup', showBox );
}
function showBox(e){
    //Show box
    box.addEventListener( 'click', actionAlert('clicked on interface after selected text') );
}
function actionAlert(d){
    alert(d);
} 
```

主要问题是我认为它在途中使用了大量的 CPU，我怎样才能最大限度地减少它？我读了一些关于删除事件处理程序的能力，这是解决方案吗？以及如何将该解决方案有效地集成到代码中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T15:44:14.250

（在使用“addEventListener”时**编辑**这是不正确的，但我将把它留在这里作为历史的好奇：）你的“action1”事件处理程序每​​次调用它时都会重新绑定“mousemove”处理程序。反过来，该处理程序为“mouseup”绑定一个新的处理程序。过了一会儿，就会有成百上千的冗余处理程序。

所以，教训是：不要在其他事件处理程序中绑定事件处理程序（除非你真的有充分的理由）。（**编辑**——抱歉；正如我在上面所写的，有人指出这都是不正确的。我习惯于使用 jQuery 绑定处理程序，并且该库的行为方式不同。）

另外：您的“showBox”函数，如所写，绑定调用“actionAlert”方法的结果，该方法没有返回值。我想你想要的是：

```
box.addEventListener( 'click', function() {
  actionAlert('clicked on interface after selected text');
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T15:44:42.917

`mouseup`您不应该为每个添加事件侦听器`mousemove`，也不应该在每次 mousedown 时**重新**注册 mousemove 而是：

```
body.addEventListener( 'mousedown', action1, false);
function action1(){
    //Start selecting event
    body.addEventListener( 'mousemove', selectOver, false);
    body.addEventListener( 'mouseup', showBox, false );
    body.addEventListener( 'mouseup', function(){
      body.removeEventListener( 'mousemove', selectOver, false );
    });
}
function selectOver(e){
    // Not sure what this function is for.
}
function actionAlert(d){
    alert(d);
} 
```

我还添加了显式的第三个参数as`false`是`addEventListener`某些（所有？）版本的 Firefox 所要求的。

# c# - 范围：如何使用几种方法中使用的随机数

> ID：10983274
> 
> 赞同：0
> 
> 时间：2012-06-11T15:37:23.893
> 
> 标签：c#, scope

尝试通过编写我的第一个程序来学习 som C#。我有一个关于变量范围的问题。

我想要做的是生成一个介于 10000 和 99999 之间的随机数，并将结果用于同一类中的多个独立事件中。

我生成随机数没有问题：

```
 public string shuffle()
        {
            Random RandomNumber = new Random();
            int shuffleUdTemp = RandomNumber.Next(10000, 99999);
            string shuffleUd = shuffleUdTemp.ToString();
            return shuffleUd;
        } 
```

可以说 shuffle() 结果为 48532 - 我如何在同一类的几个独立事件中使用这个数字（Windows 形式）？

请注意，我是 C# 的初学者，所以我可能使用了一些不精确/错误的词。

提前谢谢:)

/托本

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T15:43:16.983

您可以将其存储在字段中

```
class MyRandomClass
{
    public void Foo()
    {
        Random RandomNumber = new Random();
        mRandomNumber = RandomNumber.Next(10000, 99999);
    }

    public void Foo2()
    {
        //do something with mRandomNumber
    }

    private int mRandomNumber;
} 
```

MyRandomClass 当然可以是您的应用程序、窗口或任何其他类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T15:39:42.740

您需要返回该数字，然后将其传递给使用该数字的函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:42:35.387

您可以将其存储在**静态**成员中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T15:43:41.957

将其保存在变量或字段中。IE。

```
class Test
{
    private string random = (new Random()).Next(10000, 99999).ToString();
    private string saver = "";
    public void Method()
    {
        Console.WriteLine(random);
    }
    protected void otherMethod()
    {
        saver += random;
        Console.WriteLine(saver);
    }
} 
```

# bash - 将脚本应用于子目录

> ID：10983278
> 
> 赞同：1
> 
> 时间：2012-06-11T15:37:32.560
> 
> 标签：bash

我读过很多次，如果我想在所有子目录上执行某些东西，我应该运行类似以下之一的东西：

`find . -name '*' -exec command arguments {} \;`

`find . -type f -print0 | xargs -0 command arguments`

`find . -type f | xargs -I {} command arguments {} arguments`

问题是它与 corefunctions 一起工作得很好，但当命令是用户定义的函数或脚本时，它就不像预期的那样。如何解决？

所以我正在寻找的是一行代码或一个脚本，我可以在其中替换`command`or`myfunction`并且`myscript.sh`它从当前目录转到每个子目录并在那里执行这样的函数或脚本，无论我提供什么参数。

以另一种方式解释，我希望在所有子目录上都可以像`for file in *; do command_myfunction_or_script.sh arguments $file; done`在当前目录上一样工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:34:36.257

而不是`-exec`，尝试`-execdir`。

在某些情况下，您可能需要使用`bash`：

```
foo () { echo $1; }
export -f foo
find . -type f -name '*.txt' -exec bash -c 'foo arg arg' \; 
```

最后一行可能是：

```
find . -type f -name '*.txt' -exec bash -c 'foo "$@"' _ arg arg \; 
```

取决于什么 args 可能需要扩展以及何时扩展。下划线代表`$0`。

如果需要，您可以`-execdir`在我拥有`-exec`的地方使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T15:48:31.313

可能有一些方法可以将 find 与函数一起使用，但它不会非常优雅。如果你有 bash 4，你可能想做的是使用 globstar：

```
shopt -s globstar
for file in **/*; do
    myfunction "$file"
done 
```

如果您正在寻找与 POSIX 或更旧版本的 bash 的兼容性，那么当您调用 bash 时，您将被迫获取定义您的函数的文件。所以是这样的：

```
find <args> -exec bash -c '. funcfile;
    for file; do
        myfunction "$file"
    done' _ {} + 
```

但这只是丑陋的。当我达到这一点时，我通常只是将我的函数放在我的脚本中`PATH`并使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:04:58.053

您提供的示例，例如：

```
find . -name '*' -exec command arguments {} \; 
```

不要从当前目录转到每个子目录并在`command`那里执行，而是从当前目录执行`command`，并将 find 列出的每个文件的路径作为参数。

如果您想要实际更改目录并执行脚本，您可以尝试以下操作：

```
STDIR=$PWD; IFS=$'\n'; for dir in $(find . -type d); do cd $dir; /path/to/command; cd $STDIR; done; unset IFS 
```

此处保存当前目录，`STDIR`并将 bash 内部字段分隔符设置为换行符，因此名称不会在空格上拆分。然后对于返回的每个目录 ( `-type d`) `find`，我们`cd`到该目录，执行命令（在此处使用完整路径，因为更改目录会破坏相对路径），然后 cd 回到起始目录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T17:45:33.947

如果您想使用 bash 函数，这是一种方法。

```
work ()
{
  local file="$1"
  local dir=$(dirname $file)
  pushd "$dir"
    echo "in directory $(pwd) working with file $(basename $file)"
  popd
}
find . -name '*' | while read line;
do
   work "$line"
done 
```

# xslt - 嵌套 xsl:when 在 xsl:call-template

> ID：10983279
> 
> 赞同：0
> 
> 时间：2012-06-11T15:37:41.690
> 
> 标签：xslt, nested

```
<xsl:call-template name="myfield">              
                    <xsl:with-param name=A/>
                    <xsl:with-param name=B/>
                    <xsl:with-param name=C/>
                    <xsl:if test="not(starts-with(specialTest))">
                        <xsl:with-param name="TEST" select="'someFunction'"/>
                    </xsl:when>                     
                    <xsl:with-param name="D"/>              
                    <xsl:with-param name="E"/>                      
</xsl:call-template> 
```

我试图在生成此 xsl 样式表时设置一个 xsl:when 条件，即使测试条件失败，我也希望调用其他参数 ABCDE。但是，XSL 编译器抱怨 xsl:if 不能是 xsl:call-template 的子级。

任何建议或任何关于 XSL 什么可以嵌套和什么不能嵌套的综合表格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T20:34:58.880

在 W3C XSLT 规范中，每个元素都有一个语法摘要，说明它可能包含哪些其他元素。例如，`xsl:choose`可能只包含`xsl:when`and `xsl:otherwise`; `xsl:call-template`可能只包含`xsl:with-param`. 有许多元素（例如`xsl:element`和）包含 XSLT 2.0 所称`xsl:attribute`的`xsl:if`“序列构造函数”（XSLT 1.0 正式称其为“模板”，但没有人使用具有该含义的术语）。序列构造函数是一个指令序列，并且有一个 XSLT 元素列表，这些元素被归类为指令，例如`xsl:if`、`xsl:element`、`xsl:value-of`、`xsl:comment`等。

所以嵌套规则在规范中有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T15:40:54.923

`<xsl:when>`只能在`<xsl:choose>`元素内使用 - 但是，唯一可用的元素`<xsl:call-template>`是`<xsl:with-param>`.

试试这个（未经测试）...

```
<xsl:call-template name="myfield">              
  <xsl:with-param name=A/>
  <xsl:with-param name=B/>
  <xsl:with-param name=C/>
  <xsl:with-param name="TEST">
    <xsl:if test="not(starts-with(specialTest))">your value</xsl:if>
  </xsl:with-param>
  <xsl:with-param name="D"/>              
  <xsl:with-param name="E"/>                      
</xsl:call-template> 
```

（此外，您的示例中有前导`<xsl:if>`但尾随`<\xsl:when>`......这无济于事。）

# iphone - 移动 - 离线网络应用程序和音频剪辑存储

> ID：10983280
> 
> 赞同：0
> 
> 时间：2012-06-11T15:37:43.450
> 
> 标签：iphone, web-applications, offline

我为 Android 构建了一个简单的音板免费应用程序。一些客户问我该应用程序何时也可用于 iPhone。现在，我正在考虑将音板开发为离线工作的网络应用程序。有可能吗？网络应用程序是否可以在本地永久存储一些音频文件？

这些音频文件的大小从 16kb 到 150kb 不等，总共 2.5mb（50 个音频剪辑）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:03:02.213

您可以通过在第一次安装应用程序时将视频文件下载到文档文件夹并从那里显示来做到这一点

# mysql - MySQL IF/查询转换为 PostgreSQL

> ID：10983286
> 
> 赞同：2
> 
> 时间：2012-06-11T15:37:58.700
> 
> 标签：mysql, sql, postgresql

我正在将一个站点从 mysql 迁移到 PostgreSQL（到目前为止我真的很喜欢），但我对某个查询有疑问。请注意，这不是一个存储函数——这是一个在 python 脚本中手动传入的字符串（我知道这是一种糟糕的做法，但它仅适用于内部应用程序）。在 mysql 中，查询的结构如下：

```
SELECT 
  name,
  SUM(IF(is_correct, 1, 0)) AS correct,
  SUM(IF(is_correct, 0, 1)) AS wrong
FROM
  k_p AS p JOIN
  k_v AS v ON (variable_id=v.id)
WHERE
  content_type_id=%s %s %s
GROUP BY
  v.id
ORDER BY sort_order 
```

is_correct 只是一个带有布尔数据的列，要么是 0 要么是 1。我意识到你不能像在 mysql 中那样在 postgres 中做直接的 IF。文档似乎表明最好的转换是使用 case/when 语句。我试过没有成功。SUM/IF 语句让我失望——查询的其余部分应该没问题。任何建议将不胜感激！

奖励问题：如果其中一个查询包括：

```
 SUM(IF(ISNULL(is_correct), 0, 1)) AS wrong 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T15:39:48.073

你想要你的`CASE`构造：

```
SELECT 
  name,
  SUM(case when is_correct = 1 then 1 else 0 end) AS correct,
  SUM(case when is_correct = 1 then 0 else 1 end) AS wrong
FROM
  k_p AS p JOIN
  k_v AS v ON (variable_id=v.id)
WHERE
  content_type_id=%s %s %s
GROUP BY
  v.id
ORDER BY sort_order 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:19:24.250

```
select name, correct, wrong
from (
    SELECT 
      id,
      name,
      count(nullif(is_correct, false)) AS correct,
      count(nullif(is_correct, true)) AS wrong
    FROM
      k_p AS p JOIN
      k_v AS v ON (variable_id=v.id)
    WHERE
      content_type_id=%s %s %s
    GROUP BY
      v.id, name
)
ORDER BY sort_order 
```

# java - JavaFX 平铺/流窗格动画

> ID：10983289
> 
> 赞同：2
> 
> 时间：2012-06-11T15:38:09.073
> 
> 标签：java, animation, javafx-2

我只是在玩 JavaFX 2 并为自己的娱乐开发一个小应用程序。

从我目前所见，我喜欢它，现在我想玩一些动画和效果属性。

我正在设计的应用程序使用大量图像来显示信息，我想设计一个动画 GUI 来显示图像。我的想法是这样的：

[http://www.youtube.com/watch?v=LK3B7cpZlGM](http://www.youtube.com/watch?v=LK3B7cpZlGM)

谁能提供有关如何实现类似目标的任何信息？我猜布局是流程图，但我不知道动画是如何工作的。是否有某种排序算法在起作用？

任何建议或信息将不胜感激。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T15:36:50.027

有几篇关于JavaFX动画的文章：

*   视频： http: [//medianetwork.oracle.com/video/player/1193110454001](http://medianetwork.oracle.com/video/player/1193110454001)
*   教程：[http ://docs.oracle.com/javafx/2/animations/jfxpub-animations.htm](http://docs.oracle.com/javafx/2/animations/jfxpub-animations.htm)
*   Ensemble[示例](http://www.oracle.com/technetwork/java/javafx/samples/index.html)在动画部分有几个示例，以及在视频中制作简单版本动画的“展示架”示例。

# java - 在 wicket 中看到 http 请求

> ID：10983293
> 
> 赞同：2
> 
> 时间：2012-06-11T15:38:26.803
> 
> 标签：java, web, wicket

我正在使用 Apache Wicket，我想查看 http 请求本身（请求的确切文本，无需任何处理！）。我应该怎么办？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T10:36:03.633

在 Wicket 1.4 中，您可以`HttpServletRequest`使用以下代码获取对象（这是请求的 servlet 表示形式，是您可以获得的最原始的）：

```
HttpServletRequest req = ((WebRequest)RequestCycle.get().getRequest()).getHttpServletRequest(); 
```

但是，“没有任何处理”部分将无法工作，原因有两个：servlet 引擎本身将进行一些处理（如解码 url 参数），并且 Wicket 将消耗包含请求实体的输入流。

如果要监视原始请求，则必须在网络服务器级别拦截它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T15:47:09.710

对于 Wicket 1.5，您可以获取底层请求对象并将其转换为 HttpServletRequest：

```
HttpServletRequest request = ((HttpServletRequest) getRequest().getContainerRequest()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:58:17.580

```
final Request request = RequestCycle.get().getRequest(); 
```

# java - Java：维护压缩文件修改日期

> ID：10983301
> 
> 赞同：3
> 
> 时间：2012-06-11T15:38:45.587
> 
> 标签：java, zip, unzip

我正在使用的专有程序会压缩并提取某些文件，而不会在解压缩时更改文件的修改日期。我还根据程序中的源代码创建了我自己的压缩和提取工具，但是当我解压缩文件时，所有压缩文件的修改日期都显示为解压缩时间和日期。这是我提取的代码：

```
public static int unzipFiles(File zipFile, File extractDir) throws Exception 
{
        int totalFileCount = 0;
        String zipFilePath = zipFile.getPath();

        System.out.println("Zip File Path: " + zipFilePath);

        ZipFile zfile = new ZipFile(zipFile); 
        System.out.println("Size of ZipFile: "+zfile.size());

        Enumeration<? extends ZipEntry> entries = zfile.entries(); 

        while (entries.hasMoreElements()) 
        { 
          ZipEntry entry = entries.nextElement(); 
          System.out.println("ZipEntry File: " + entry.getName());
          File file = new File(extractDir, entry.getName()); 
          if (entry.isDirectory()) 
          { 
            System.out.println("Creating Directory");
            file.mkdirs(); 
          } 
          else 
          { 
            file.getParentFile().mkdirs(); 
            InputStream in = zfile.getInputStream(entry); 
            try 
            { 
              copy(in, file); 
            } 
            finally 
            {   
              in.close(); 
            } 
          } 
          totalFileCount++;
        }
        return totalFileCount; 
      } 

private static void copy(InputStream in, OutputStream out) throws IOException 
```

{

```
 byte[] buffer = new byte[1024]; 
  System.out.println("InputStream/OutputStram copy");
  while (true) 
  { 
    int readCount = in.read(buffer); 
    if (readCount < 0) 
    { 
      break; 
    } 
    out.write(buffer, 0, readCount); 
   } 
} 
```

我确信除了进行输入流/输出流复制之外，还有更好的方法来做到这一点。我确定这是罪魁祸首，因为使用 winRAR 进行提取不会更改我压缩文件的日期。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-11T15:46:02.767

完成复制后，使用 ZipEntry.getTime 获取上次修改时间，并使用 File.setLastModified 在文件上设置它。

# java - JRuby：启动浏览器时 Watir 挂起

> ID：10983307
> 
> 赞同：4
> 
> 时间：2012-06-11T15:39:04.463
> 
> 标签：java, ruby, jruby, watir

我有 Windows 7 Enterprise，我正在尝试运行 JRuby。我已经为 Ruby (1.9.3)、Java (jdk - 1.6.7) 和 JRuby (1.7preview) 设置了我的环境变量。我有一个网络驱动器，但我创建了一个似乎正在工作的 HOME 系统变量，因为我可以成功下载 Ruby 和 JRuby 的 gem，并将它们保存到我的本地驱动器。

当我尝试启动浏览器（即 firefox、chrome）时，它似乎为 JRuby 挂起，但不是 Ruby。这是**JRuby**在尝试执行 10 分钟后的跟踪：

```
irb(main):003:0> require 'rubygems'
=> false
irb(main):004:0> require 'watir-webdriver'
=> true
irb(main):005:0> b = Watir::Browser.new :ie
IRB::Abort: abort then interrupt! *<--Note I killed the process after 10 minutes*
    from c:/Ruby/jruby-bin-1.7.0.preview1/jruby-1.7.0.preview1/lib/ruby/gems
    /shared/gems/selenium-webdriver-2.22.2/lib/selenium/webdriver/common 
    /port_prober.rb:24:in `free?'       
    from c:/Ruby/jruby-bin-1.7.0.preview1/jruby-1.7.0.preview1/lib/ruby/gems
    /shared/gems/selenium-webdriver-2.22.2/lib/selenium/webdriver/common  
    /port_prober.rb:5:in `above'        
    from c:/Ruby/jruby-bin-1.7.0.preview1/jruby-1.7.0.preview1/lib/ruby/gems
    /shared/gems/selenium-webdriver-2.22.2/lib/selenium/webdriver/ie/bridge.rb:17:in
   `initialize'
    from org/jruby/RubyHash.java:1429:in `delete'
    from c:/Ruby/jruby-bin-1.7.0.preview1/jruby-1.7.0.preview1/lib/ruby/gems
    /shared/gems/selenium-webdriver-2.22.2/lib/selenium/webdriver/ie/bridge.rb:17:in
    `initialize'
    from c:/Ruby/jruby-bin-1.7.0.preview1/jruby-1.7.0.preview1/lib/ruby/gems
    /shared/gems/selenium-webdriver-2.22.2/lib/selenium/webdriver/common/driver.rb:3
    5:in `for'
    from c:/Ruby/jruby-bin-1.7.0.preview1/jruby-1.7.0.preview1/lib/ruby/gems
    /shared/gems/selenium-webdriver-2.22.2/lib/selenium/webdriver.rb:65:in `for'
    from c:/Ruby/jruby-bin-1.7.0.preview1/jruby-1.7.0.preview1/lib/ruby/gems
    /shared/gems/watir-webdriver-0.6.1/lib/watir-webdriver/browser.rb:35:in   
    `initialize'
    from (irb):5:in `evaluate'
    from org/jruby/RubyKernel.java:1037:in `eval'
    from org/jruby/RubyKernel.java:1353:in `loop'
    from org/jruby/RubyKernel.java:1146:in `catch'
    from org/jruby/RubyKernel.java:1146:in `catch'
    from c:\Ruby\jruby-bin-1.7.0.preview1\jruby-1.7.0.preview1\bin\irb:13:in
    `(root)' 
```

JRuby 似乎挂起，因为它正在寻找一个开放的端口。我们必须为我们的网络使用 HTTP 代理，我也为此设置了一个系统变量。我真的不知道为什么 Watir 会为 Ruby 而不是 JRuby 工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T13:13:51.127

我有类似的问题 -`selenium-webdriver`使用 JRuby 和 Java 6 时没有打开浏览器，但它适用于 Java 7。

我发现 Java 6 似乎对 IPv6 有一些问题，并且在 IPv6 接口上找不到空闲端口。

解决方案是尽可能`-Djava.net.preferIPv4Stack=true`告诉`JAVA_OPTS`Java 更喜欢 IPv4 而不是 IPv6。

# java - 用于简单外观的 JUnit 测试

> ID：10983318
> 
> 赞同：0
> 
> 时间：2012-06-11T15:39:42.317
> 
> 标签：java, junit

尝试为以下外观提出 JUnit 测试 - 我知道这应该很简单，但我一直空白。任何能让我朝着正确方向前进的想法。它不需要很复杂——我只需要完成它。

```
package business;

import domain.Items;
import services.exceptions.ItemNotFoundException;
import services.itemservice.IItemsService;

public class Itemmgr {

    @SuppressWarnings("static-access")
    public void store(Items item) {
        Factory factory = Factory.getInstance(IItemsService.NAME);

        IItemsService storeItem = (IItemsService)factory.getInstance(IItemsService.NAME);

        storeItem.storeItem(item);
    }

    public void get(Items item) throws ClassNotFoundException, ItemNotFoundException { 
        Factory factory = Factory.getInstance(IItemsService.NAME);

        @SuppressWarnings("static-access")
        IItemsService getItem = (IItemsService)factory.getInstance(IItemsService.NAME);

        try {
            getItem.getItems("pens", 15, "red", "gel");
        } catch (ClassNotFoundException | ItemNotFoundException e) {
            e.printStackTrace();
            System.out.println("Error - Class or Item Not Found");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:40:36.887

正如其他人所说，您可以编写一个首先存储 some 的单元测试`Items`，然后在同一个测试中检索`Items`并确保您返回的内容与您最初存储的内容“等效”。

例如（如果我可以大胆猜测一下），在我看来，您的`Itemmgr`课程可能会被扩展为包括易失性和持久性版本（可能一个版本在 RAM 中，可能一个在磁盘上）。您的测试可以确保`item1 == item2`在 RAM 常驻版本中`item1 != item2 && item1.equals(item2)`返回 true，但在持久测试中返回 true，以确保 item2 已序列化或从某处复制，而不仅仅是从`Map`某种类型的 a 中检索原始. 只是一些想法。

# asp.net-mvc-3 - 具有由多个类实现的接口的依赖注入

> ID：10983321
> 
> 赞同：9
> 
> 时间：2012-06-11T15:39:49.067
> 
> 标签：asp.net-mvc-3, oop, dependency-injection, dry

**更新：**有没有办法在 Windsor 以外的 IoC 框架中实现我想要做的事情？Windsor 会很好地处理控制器，但不会解决其他任何问题。我确定这是我的错，但我正在逐字遵循教程，并且对象没有通过 ctor 注入解析，尽管进行了注册和解析，它们仍然为空。我已经废弃了我的 DI 代码并暂时进行手动注入，因为该项目对时间很敏感。希望在截止日期前完成 DI。

* * *

我有一个解决方案，它有多个类都实现了相同的接口

举个简单的例子，`Interface`

```
public interface IMyInterface {
    string GetString();
    int GetInt();
   ...
} 
```

具体类

```
public class MyClassOne : IMyInterface {
    public string GetString() {
        ....
    }
    public int GetInt() {
        ....
    }
}

public class MyClassTwo : IMyInterface {
    public string GetString() {
        ....
    }
    public int GetInt() {
        ....
    }
} 
```

现在这些类将在需要的地方注入到它们上面的层中，例如：

```
public class HomeController {

    private readonly IMyInterface myInterface;

    public HomeController() {}

    public HomeController(IMyInterface _myInterface) {
        myInterface = _myInterface
    }
    ...
}

public class OtherController {

    private readonly IMyInterface myInterface;

    public OtherController() {}

    public OtherController(IMyInterface _myInterface) {
        myInterface = _myInterface
    }
    ...
} 
```

两个控制器都注入了相同的接口。

在我的 IoC 中使用适当的具体类解决这些接口时，我如何区分`HomeController`需要一个实例`MyClassOne`和`OtherController`需要一个实例`MyClassTwo`？

如何将两个不同的具体类绑定到 IoC 中的同一个接口？我不想创建 2 个不同的接口，因为这违反了 DRY 规则并且无论如何都没有意义。

在温莎城堡中，我会有 2 行这样的：

```
container.Register(Component.For<IMyInterface>().ImplementedBy<MyClassOne>());
container.Register(Component.For<IMyInterface>().ImplementedBy<MyClassTwo>()); 
```

这行不通，因为我只会得到一个副本，`MyClassTwo`因为它是为接口注册的最后一个。

就像我说的，如果不为每个具体实例创建特定的接口，我不知道如何做到这一点，这样做不仅违反了 DRY 规则，而且也违反了基本的 OOP。我如何实现这一目标？

* * *

**根据 Mark Polsen 的回答进行更新**

* * *

这是我目前的 IoC，`.Resolve`声明会去哪里？我在 Windsor 文档中看不到任何内容

```
public class Dependency : IDependency {

    private readonly WindsorContainer container = new WindsorContainer();

    private IDependency() {
    }

    public IDependency AddWeb() {
        ...

        container.Register(Component.For<IListItemRepository>().ImplementedBy<ProgramTypeRepository>().Named("ProgramTypeList"));
        container.Register(Component.For<IListItemRepository>().ImplementedBy<IndexTypeRepository>().Named("IndexTypeList"));

        return this;
    }

    public static IDependency Start() {
        return new IDependency();
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-11T16:00:49.710

我希望您可以使用[服务覆盖](http://docs.castleproject.org/Default.aspx?Page=Registering-components-one-by-one&NS=Windsor&AspxAutoDetectCookieSupport=1#Supplying_the_component_for_a_dependency_to_use_Service_override_9)。

前任。

```
container.Register(
    Component.For<IMyService>()
        .ImplementedBy<MyServiceImpl>()
        .Named("myservice.default"),
    Component.For<IMyService>()
        .ImplementedBy<OtherServiceImpl>()
        .Named("myservice.alternative"),

    Component.For<ProductController>()
        .ServiceOverrides(ServiceOverride.ForKey("myService").Eq("myservice.alternative"))
);

public class ProductController
{
    // Will get a OtherServiceImpl for myService.
    // MyServiceImpl would be given without the service override.
    public ProductController(IMyService myService)
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-11T16:01:38.000

您应该能够通过命名组件注册来完成它。

```
container.Register(Component.For<IMyInterface>().ImplementedBy<MyClassOne>().Named("One"));
container.Register(Component.For<IMyInterface>().ImplementedBy<MyClassTwo>().Named("Two")); 
```

然后解决它们

```
kernel.Resolve<IMyInterface>("One"); 
```

或者

```
kernel.Resolve<IMyInterface>("Two"); 
```

[请参阅：指定组件的名称](http://stw.castleproject.org/Default.aspx?Page=Registering-components-one-by-one&NS=Windsor&AspxAutoDetectCookieSupport=1)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-23T09:06:59.073

通常 DI 容器遵循 Register、Resolve 和 Release 模式。在注册阶段有两个步骤。第一个是按照您的操作指定映射。第二步是指定规则，这些规则控制在哪里注入。

当我们尝试使用装饰器解决横切关注点时，这个问题很常见。在这些情况下，您有多个类（装饰器）实现一个接口。

简而言之，我们需要实现 IModelInterceptorsSelector，它允许您编写命令式代码来决定将哪个 Interceptor 应用于哪些类型或成员。

这在 Mark Seemann 所著的 .Net 中的 Dependency Injection 一书中进行了详细描述。寻找第9章拦截或搜索上述接口。

我不是这方面的专家，但正在寻找完全相同的问题并在上面的书中找到了答案。

希望这可以帮助。

问候 Dev1

# c# - 我是否在循环中泄漏内存？

> ID：10983322
> 
> 赞同：4
> 
> 时间：2012-06-11T15:39:59.050
> 
> 标签：c#, loops, memory-leaks

我是一个新的程序员，我只是想出了一个内存泄漏的问题。如果我在循环中声明一个变量以使其一次又一次地声明，我是否会泄漏内存？例如，我有

```
while(true)
{
    Image<Gray, Byte> MyImage = new Image<Gray, Byte> (1024, 768);
    //do something else
} 
```

我知道这是一个无限循环，但我的问题是关于内存的。在这个循环中，内存使用量增长得很快吗？我应该手动释放 MyImage 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T15:42:12.073

使用后需要打电话`MyImage.Dispose()`。

另一种方法是将代码更改为：

```
while(true)
{
    using(Image<Gray, Byte> MyImage = new Image<Gray, Byte> (1024, 768)){
        //do something else
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T16:23:30.523

垃圾收集器 (GC) 最终会为您完成这项工作。在您建议的情况下，您必须小心，因为在这种情况下，GC 将尝试管理它花费在垃圾收集上的时间与应用程序内存消耗（工作集）。因此，应用程序可能会消耗比它需要的更多的内存，尤其是在您说明的情况下。

CLR 完全自动处理此内存，您永远不会自己释放托管内存。例如考虑以下

```
public void Test()
{
    byte[] myArray = new Byte[1000];
    // ...
} 
```

执行时`Test`，在内存堆上分配一个容纳 1000 字节的数组。该数组由变量引用`myArray`，存储在局部变量堆栈中。当这个方法退出时，这个局部变量会弹出范围，这意味着没有任何东西可以引用内存堆上的数组。然后，孤立的数组就有资格被 GC 回收。但是，此收集可能不会立即发生，因为 CLR 决定是否收集是基于许多因素（可用内存、当前内存分配、自上次收集以来的时间等）。这意味着在垃圾收集前所用的时间。

鉴于上述情况，在您描述的情况下，您将在循环/包含方法的持续时间内大量增加内存消耗。在这里使用`using`语句要好得多

```
while (true)
{
    using (Image<Gray, Byte> MyImage = new Image<Gray, Byte> (1024, 768))
    {
        // ...
    }
} 
```

或在每个循环后调用`dispose()`对象`Image`。

```
while (true)
{
    Image<Gray, Byte> MyImage = new Image<Gray, Byte> (1024, 768);
    // ...
    MyImage.Dispose();
} 
```

*另外：您始终可以通过查询性能计数器（使用 System.Diagnostics）自己检查此类内存消耗（测试进程的实际内存消耗）：*

```
string procName = Process.GetCurrentProcess().ProcessName;
using (PerformanceCounter pc = new PerformanceCounter("Process", "Private Bytes", procName))
    Console.WriteLine(pc.NextValue()); 
```

*注意：读取性能计数器需要管理员权限。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T15:43:35.757

> 如果我在循环中声明一个变量以使其一次又一次地声明，我是否会泄漏内存？

不，您没有，其他人提到的问题可能是 Image 是否包装了 Image 对象

但是对于您的问题，在循环内声明一个变量并在每次迭代时为其分配一个新值并不是问题

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T15:44:01.183

在某些情况下，紧密的循环会导致 OOM 问题。但是，`Image`实现`IDisposable`，因此请务必通过`using`语句调用它，以便在您完成资源时可以释放资源。

```
using (Image<Gray, Byte> MyImage = new Image<Gray, Byte>(1024, 768))
{
  //do stuff
} 
```

如果实现任何托管对象，请确保`Image<T,U>`实现。`IDisposable``Image<T,U>`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-11T15:48:49.793

在您问题的一般形式中，您本身并没有泄漏内存，但您增加内存占用的速度可能比 GC 减少它的速度更快（取决于您正在使用的对象的确切行为和内存占用）。如果是这样，这将产生很多类似内存泄漏的影响。

在您的具体示例中，Image 对象包含非托管资源，其中可能包括内存（或文件句柄或 GDI 对象等）。正如其他答案所指出的，如果您不处置，这些非托管资源将不会被回收（或者如果它们具有终结器，则可能会在 GC 的第二次通过时被回收）。

# msbuild - 如何为包目标指定根文件夹？

> ID：10983323
> 
> 赞同：12
> 
> 时间：2012-06-11T15:40:01.013
> 
> 标签：msbuild

我通过调用以下命令使用 msbuild 发布我的 Web 应用程序：

```
msbuild myweb.csproj /T:Package /P:PackageLocation=obj\Output\myweb.zip 
```

zip 文件的内容始终具有深层文件夹结构，其中包含从驱动器根目录到项目文件夹的完整路径。有什么办法让它更平整吗？我想在 zip 中有一个像 root 这样的项目文件夹。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-12T00:49:03.733

您可以使用类似 IIS 的平面结构`_PackageTempDir`来代替`PackageLocation`，但是如果您想保留 .zip 和 .cmd 与清单，那么不，如果不重写 Microsoft.Web.Publishing.targets 或由于使用 var 的方式，自定义任务。

```
<_PackageTempDir>$(PackageTempRootDir)\PackageTmp</_PackageTempDir>
<_PackageTempDirFullPath>$([System.IO.Path]::GetFullPath($(_PackageTempDir))</_PackageTempDirFullPath>
<_MSDeployDirPath Include="$(_PackageTempDir)" />
<_MSDeployDirPath_FullPath>@(_MSDeployDirPath->'%(FullPath)')</_MSDeployDirPath_FullPath> 
```

但是，您可以通过使用本地共享隐藏绝对路径来欺骗 msbuild 并将其展平，如下所示：

```
net share foo=D:\Temp
msbuild WebApplication1.csproj /t:Package /p:PackageTempRootDir=\\localhost\foo 
```

这会将您的深层本地路径更改为类似`obj\Debug\Package\WebApplication1.zip\Content\_S_Slocalhost_Sfoo\PackageTmp`

# c# - WCF 数据服务 | 如何使用嵌套属性处理可为空的属性？

> ID：10983324
> 
> 赞同：0
> 
> 时间：2012-06-11T15:40:10.040
> 
> 标签：c#, wcf-data-services

当我将 BarCodeId FK 更改为允许 ContactDocument 中的 null 时。之后，如果 ContactDocument 中的任何实体的 BarCodeId 为空，我就会开始在客户端出现错误。如果我删除最后三个扩展，一切都会起作用，但我不会得到与 BarCode 对象相关的实体。有什么帮助吗？

```
IQueryable<ScanDocument> result = Context.CreateQuery<ScanDocument>("DocumnetsWithNotRemovedContacts")
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ScanDocumentPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.BarCodePropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.ContactPropertyName + "/" + Contact.ContactDocumentsPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.ScanDocumentDetailPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.ContactPropertyName + "/" + Contact.ContactSourcePropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.ContactPropertyName + "/" + Contact.ElectionDistrictPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.ContactPropertyName + "/" + Contact.ContactTypePropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.ContactPropertyName + "/" + Contact.ContactSalutationPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.ContactPropertyName + "/" + Contact.ContactGroupsPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.ContactPropertyName + "/" + Contact.CategoryInterestsPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.BarCodePropertyName + "/" + BarCode.ContactDocumentsPropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.BarCodePropertyName + "/" + BarCode.BarCodeActionTypePropertyName)
        .Expand(ScanDocument.ScanDocumentDetailsPropertyName + "/" + ScanDocumentDetail.ContactDocumentsPropertyName + "/" + ContactDocument.BarCodePropertyName + "/" + BarCode.ScanDataTypePropertyName)
        .OrderByDescending(document => document.ID); 
```

在服务器端，我开始使用类似的东西来获取嵌套属性。

```
CurrentDataSource.ScanDocumentDetails
             .Include(ScanDocumentDetail.ScanDocumentPropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.BarCodePropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.ContactPropertyName + "." + Contact.ContactDocumentsPropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.ScanDocumentDetailPropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.ContactPropertyName + "." + Contact.ContactSourcePropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.ContactPropertyName + "." + Contact.ElectionDistrictPropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.ContactPropertyName + "." + Contact.ContactTypePropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.ContactPropertyName + "." + Contact.ContactSalutationPropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.ContactPropertyName + "." + Contact.ContactGroupsPropertyName)
             .Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.ContactPropertyName + "." + Contact.CategoryInterestsPropertyName)
            //.Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.BarCodePropertyName + "." + BarCode.ContactDocumentsPropertyName)
            //.Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.BarCodePropertyName + "." + BarCode.BarCodeActionTypePropertyName)
            //.Include(ScanDocumentDetail.ContactDocumentsPropertyName + "." + ContactDocument.BarCodePropertyName + "." + BarCode.ScanDataTypePropertyName)
            .Where(c => ids.Contains(c.ScanDocumentID ?? 0)).ToList();

        foreach (var scanDocumentDetail in y)
        {
            foreach (var contactdocuments in scanDocumentDetail.ContactDocuments)
            {
                if (contactdocuments.BarCode != null)
                {
                    int barCodeActionTypeId = contactdocuments.BarCode.BarCodeActionTypeId;
                    contactdocuments.BarCode.BarCodeActionType =
                        CurrentDataSource.BarCodeActionTypes.FirstOrDefault(p => p.ID == barCodeActionTypeId);

                    if (contactdocuments.BarCode.ScanDataTypeID.HasValue)
                    {
                        int scanDataTypeId = contactdocuments.BarCode.ScanDataTypeID.Value;
                        contactdocuments.BarCode.ScanDataType =
                            CurrentDataSource.ScanDataTypes.FirstOrDefault(p => p.ID == scanDataTypeId);
                    }
                }
            }
        } 
```

**UPD** 异常：“处理响应流时出错。服务器失败并显示以下消息：\r\n处理此请求时出错。” 来源：System.Data.Services.Client 状态码：500

堆栈跟踪：

```
at System.Data.Services.Client.Xml.XmlAtomErrorReader.Read()
   at System.Xml.XmlSubtreeReader.Read()
   at System.Xml.Linq.XContainer.ReadContentFrom(XmlReader r)
   at System.Xml.Linq.XContainer.ReadContentFrom(XmlReader r, LoadOptions o)
   at System.Xml.Linq.XElement.ReadElementFrom(XmlReader r, LoadOptions o)
   at System.Xml.Linq.XElement.Load(XmlReader reader, LoadOptions options)
   at System.Data.Services.Client.AtomParser.XElementBuilderCallback(XmlReader reader)
   at System.Data.Services.Client.AtomParser.ParseCurrentEntry(AtomEntry& targetEntry)
   at System.Data.Services.Client.AtomParser.Read()
   at System.Data.Services.Client.AtomMaterializer.Read()
   at System.Data.Services.Client.MaterializeAtom.MoveNextInternal()
   at System.Data.Services.Client.MaterializeAtom.MoveNext()
   at System.Linq.Enumerable.<CastIterator>d__b1`1.MoveNext()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   at ClientDataServices.MailProcessingManagmentService.GetDocuments(Expression`1 filter) in D:\...\MailProcessingManagmentService.cs:line 41
   at ClientDataServices.MailProcessingManager.GetEntries(Expression`1 predicate) in D:\...\MailProcessingManager.cs:line 24
   at MailProcessingModule.ViewModels.MailProcessingViewModel.RefreshEntityHandler() in D:\...\MailProcessingViewModel.cs:line 113
   at BaseModule.BaseGridViewModel`1.<>c__DisplayClass1a.<ListEntities>b__d(Object e) in D:\...\BaseGridViewModel.cs:line 178
   at System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   at System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem()
   at System.Threading.ThreadPoolWorkQueue.Dispatch()
   at System.Threading._ThreadPoolWaitCallback.PerformWaitCallback() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T19:04:16.910

WCF 数据服务对允许的扩展数量有服务器端限制。我认为它是 14，所以您上面的查询可能会失败。

如果您发布确切的错误消息，则可能有助于确认问题的根本原因。

扩展为 null 的属性应该可以正常工作，不会有任何结果，但这是可以预料的。

# c# - 使用 ASP 按钮 OnClick 打开 jQuery Colorbox

> ID：10983325
> 
> 赞同：0
> 
> 时间：2012-06-11T15:40:11.523
> 
> 标签：c#, jquery, asp.net, oracle

我对使用 jQuery 做任何事情还是很陌生，但过去我很幸运能够链接到 Colorbox iFrames。

现在，我正在尝试链接一个通用的 ASP 按钮来打开一个 Colorbox 窗口。我已经尝试过搜索，但似乎找不到我需要的确切答案。这是我到目前为止所拥有的，这绝对是行不通的。

```
 <div id="openColorbox">
        <asp:Button ID="NewRecordBTN" runat="server" Text="New Material Movement Request" onclick="NewRecordBTN_Click" />
 </div>

 <script type="text/javascript">
    $(document).ready(function () {
        $("#openColorbox").click(function(){
            $.colorbox({ 
                  iframe: true, 
                   width: "80%", 
                  height: "80%", 
              transition: "fade" }));
    }); 
```

试图让 jQuery .click() 函数监视我创建并在单击时打开的“openColorbox”div。我还想在此过程中将 iFrame 指向另一个 URL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:43:26.677

尝试处理按钮上的[OnClientClick](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.onclientclick.aspx)事件

编辑：

像这样的东西：

```
 <asp:Button ID="New`enter code here`RecordBTN" runat="server" Text="New Material Movement Request" onclick="NewRecordBTN_Click" OnClientClick="OpenColorBox()" />

<script type="text/javascript">
  function OpenColorBox()
  {
    $.colorbox({ iframe: true, width: "80%", height: "80%", transition: "fade" });
  }    

</script> 
```

我不确定您是否需要服务器端事件处理？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T14:03:40.947

通过以下代码完成事务后，我能够发送到 jQuery Colorbox 中的 URL 并重新加载父页面：

```
 <script type="text/javascript">
    function OpenCBox() 
    {
        $.colorbox({ href: "NewMMR.aspx", iframe: true, width: "40%", height: "70%", transition: "elastic", onClosed: function () { parent.location.reload(true); } });
    }
</script> 
```

这将在重新加载时重新加载父页面。它还会在完成后将其发送到 NewMMR.aspx。

# sql - 使用联接的 SQL 函数中的算术

> ID：10983326
> 
> 赞同：0
> 
> 时间：2012-06-11T15:40:11.640
> 
> 标签：sql, left-join

我是 SQL 新手。我正在尝试使用 SQL 函数执行一些算术运算。

我有三张桌子：

表格1

```
Table1_ID
Table2_ID
Value 
```

表2

```
Table2_ID
Switch 
```

表3

```
Table3_ID
Table1_ID
Table2_ID
X_Column 
```

我将表 3 中 X_Column 的内容作为输入开始，这将是我的函数的输入。这些是条件：

1) 多个 Table2_ID 可以有相同的 X_Column 输入，反之则不行

2）多个Table1_ID可以有相同的Table2_ID，反之则不行

3) 每个 X_Column 输入都有一个或多个 Table2_ID；每个 Table2_ID 都有一个或多个 Table1_ID

我要做的就是**乘以**并返回 Table1 中字段**Value**的内容，每当输入特定的输入 X_Column 时，Table1 有一个 Table1_ID、一个对应的 Table2_ID、一个对应于输入 X_Column 的对应 Table3_ID。

我无法理解如何做到这一点。我认为可以使用联接或视图。我还没有任何相关代码可以在这里发布。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:21:46.760

我猜是列数据类型...

通过**Table2_ID**列连接表。连接不同表的行时，可以将列相乘：**Table1.Value * Table3.X_Column**

```
-- sample tables
declare @Table1 table (Table1_ID int, Table2_ID int, Value numeric(18,2));
declare @Table2 table (Table2_ID int, Switch bit);
declare @Table3 table (Table3_ID int, Table1_ID int, Table2_ID int, X_Column numeric(18,2));

-- sample data
insert @Table1 values(100, 200, 5.00);
insert @Table1 values(100, 201, 10.00);
insert @Table2 values(200, 0);
insert @Table2 values(201, 1);
insert @Table3 values(300, 100, 200, 2.0);
insert @Table3 values(300, 100, 201, 2.5);

declare @X_Column numeric(18,2);
set @X_Column = 2.0;

select
    t1.Value * t3.X_Column
from @Table1 t1
join @Table2 t2 on t2.Table2_ID = t1.Table2_ID
join @Table3 t3 on t3.Table2_ID = t2.Table2_ID
where t3.X_Column = @X_Column 
```

# java - JUnit，动态加载的测试类

> ID：10983328
> 
> 赞同：0
> 
> 时间：2012-06-11T15:40:17.293
> 
> 标签：java, unit-testing, testing, dynamic, junit

我有几个动态加载的类（的实例`Class<TestCase>`）。我需要通过 Maven ( `mvn verify`) 运行这些测试。现在我想知道该怎么做。我只知道我能做到：

```
Class<TestCase>[] classes = createTests();
JUnitCore junit = new JUnitCore();
junit.addListener(new TextListener(System.out));
junit.run(classes); 
```

这只是将结果打印到控制台。我想要所有测试用例的单独测试报告（例如在 Jenkins 中，例如使用 Parameterized runner）。你能指出我正确的方向吗？我想我必须创建自定义跑步者。

测试类是从 3rd 方库生成的。不幸的是，以下内容不起作用（它什么都不做）：

```
((TestCase) classes[0].newInstance()).run() 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:09:31.930

所以我做了一些 RTFM 并提供了简单的解决方案。我创建了具有 RunNotifier 字段的 RunListener 类，覆盖了所有方法并委托给通知程序中的等效 fire* 方法，使用以下运行方法创建了自定义 Runner：

```
@Override
public void run(RunNotifier runNotifier) {
    try {
        Class<?>[] classes = createTests();
        JUnitCore junit = new JUnitCore();
        junit.addListener(new MyListener(runNotifier));
        junit.run(classes);
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

并且测试从这个类开始：

```
@RunWith(MyRunner.class)
public class SomeTest {
} 
```

# sencha-touch-2 - 如何在 sencha touch 中创建自定义工具栏？

> ID：10983330
> 
> 赞同：0
> 
> 时间：2012-06-11T15:40:30.750
> 
> 标签：sencha-touch-2, sencha-touch-theming

我想要一个背景颜色作为渐变的自定义工具栏。我尝试过 sass。但它仍然不起作用..我做了什么，我正在一步一步地写它：

1.  我在当前项目中的资源文件夹上创建。
2.  我在那里保存了主题和图像文件夹。
3.  我在资源文件夹中创建了 css 和 sass 文件夹。

在 sass 文件夹中，我创建了 app.scss 文件，其中包含以下代码：

```
 $base-color: #588aad; // go big blue!$include_default_icons: false;
@import 'sencha-touch/default/all';
@include sencha-panel;
@include sencha-buttons;
@include sencha-sheet;
@include sencha-picker;
@include sencha-tabs;
@include sencha-toolbar;
@include sencha-toolbar-forms;
@include sencha-indexbar;
@include sencha-list;
@include sencha-layout;
@include sencha-form;
@include sencha-msgbox;
@include sencha-loading-spinner;

@include pictos-iconmask("bookmarks");
@include pictos-iconmask("compose");
@include pictos-iconmask("trash");
@include pictos-iconmask("search");
@include pictos-iconmask("bookmark2");

@include sencha-toolbar-ui('charcoal', #333333,'glossy'); 
```

1.  然后我用这段代码创建了 config.rb 文件：

    dir = File.dirname( **FILE** ) load File.join(dir, '..', 'themes') sass_path = dir css_path = File.join(dir, "..", "css") environment = :production output_style = : 压缩

    1.  然后我在命令提示符下运行 compass compile app.scss
    2.  在 css 文件夹中，运行命令后已创建 app.css 文件。7.然后我更改工具栏的代码：

    xtype：“工具栏”，停靠：“顶部”，ui：“木炭”，标题：“设置合规目标”

    但是在那之后，当我运行项目时，在模拟器中，工具栏带有白色背景..请帮助..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-12T17:44:30.727

根据您使用的 ST 版本，您可能需要使用 Sencha Cmd。让它变得容易得多。

在 Sencha Cmd 中，您可以通过构建一个空的应用程序来创建一个起点。完成后，您可以`sencha app watch`从应用程序根文件夹运行命令，任何 sass 更改都将与许多其他进程一起自动编译。

```
MyApp/resources/sass/app.scss --> compiles to --> MyApp/resources/css/app.css

// THIS WILL OVERRIDE THE DEFAULT SENCHA TOOLBAR UI THEMES
@include sencha-toolbar-ui('normal',         $base-color,   'glossy'); 
@include sencha-toolbar-ui('dark',           $second-color, 'matte' );

// THIS ONE USES A CUSTOM UI. THERES COMPASS MIXINS IN THE INCLUDED
// TO MAKE A GRADIENT OUT OF THIS COLOR.
@include sencha-toolbar-ui('custom-ui-name', $third-color,  'glossy'); 
```

这对我有用。如果你想控制渐变，那么你可以在这里查看文档[http://docs-origin.sencha.com/touch/2.4/2.4.1-apidocs/#!/api/Ext.Toolbar-css_mixin-sencha -工具栏-ui](http://docs-origin.sencha.com/touch/2.4/2.4.1-apidocs/#!/api/Ext.Toolbar-css_mixin-sencha-toolbar-ui)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:53:03.363

检查您的 Web 浏览器的检查器，确定 css 的目标是 x-toolbar。清空您的浏览器缓存可能会有所帮助。也可能是您的 config.rb 配置错误[- 这是 config.rb 指南针设置的一个很好的资源](http://www.sencha.com/forum/showthread.php?127607-Mastering-the-Compass-SASS-Setup-with-Sencha-Touch)

# php - CI：创建一个可以被多个控制器访问的类？

> ID：10983335
> 
> 赞同：0
> 
> 时间：2012-06-11T15:41:14.650
> 
> 标签：php, codeigniter

我正在制作网站，将由 2 种不同的用户类型使用。两种类型都有不同的控制器。但是有些事情对两个用户来说都是共同的，特别是我想创建一个类，其中包含将在任一用户登录时运行的方法（它会检查一些东西，比如电子邮件确认等等等。）

无论如何，我尝试创建新库，并且有点工作.. 但是有问题，因为 $this 不可用，我需要使用 $CI，需要在每个方法上重新声明.. 所以有点的痛苦。

有什么更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:50:09.357

扩展控制器类。看看这里：

[Codeigniter MY_Controller](http://codeigniter.com/wiki/MY_Controller_-_how_to_extend_the_CI_Controller/)

# ruby-on-rails - 多个 has_many 相同的模型 Rails 3.2.1

> ID：10983337
> 
> 赞同：0
> 
> 时间：2012-06-11T15:41:30.250
> 
> 标签：ruby-on-rails, model, has-many

型号：类别

```
class Category < ActiveRecord::Base
   has_and_belongs_to_many :postings
   has_and_belongs_to_many :volunteers
end 
```

型号：张贴

```
class Posting < ActiveRecord::Base
   has_and_belongs_to_many :categories
   has_many :volunteers, :through=>:signed_postings
end 
```

型号：志愿者

```
class Volunteer < ActiveRecord::Base
   has_and_belongs_to_many :categories
   has_many :postings, :through=>:signed_postings
end 
```

* * *

现在这是我要解决的问题。

我想找出志愿者感兴趣的类别的所有帖子。志愿者可能对多个类别感兴趣，并且发布的帖子可能被分配了多个类别。

## **附加信息**

我还有另一个模型 SignedPosting：

```
class SignedPosting < ActiveRecord::Base

  belongs_to :volunteer
  belongs_to :posting

end 
```

**现在，按照jdoe**在志愿者模型中的建议添加关联**has_many 张贴， :through=> :categories, uniq=> :true**后，我有两个从志愿者到发布模型的**has_many 关联，但具有不同的****:through**。

 ******## 我不知道如何解决这个问题，因为 rails 对同一模型的两个 has_many 关联不满意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:10:28.790

你可以加：

```
# in Volunteer class
has_many postings, through: :categories, uniq: :true 
```

然后只需调用：

```
Volunteer.find(1).postings 
```

# 解决冲突

发生碰撞时（如果您已经有`postings`assoc.），请执行以下操作：

```
# name 'postings_via_cats' isn't obligation. Name it as you want.
has_many postings_via_cats, through: :categories, source: :postings, uniq: :true 
                 ---------                        ----------------- 
```******

# c++ - 从 BSTR 中删除 XML 声明的最佳方法

> ID：10983338
> 
> 赞同：2
> 
> 时间：2012-06-11T15:41:34.323
> 
> 标签：c++, visual-c++, atl, msxml, msxml4

我想知道是否有人可以帮助我尝试从包含 XML 文档的字符串中删除 XML 声明。任何帮助，将不胜感激。我们使用的是 MSXML 4.0，但我在使用它时遇到了困难，最后只做了一个子字符串。我对 ATL 和其他 Microsoft SDK 不是很熟悉。它有效，但我的一小部分死在里面，我更愿意以一种不那么脆弱的方式完成这件事。

编辑：目前我在第一次出现换行符时做一个子字符串。我试图在 XML 声明的“？>”上标记化或子字符串，但在获取字符匹配时遇到问题（使用 wcstok 和子字符串）。我试过“\?>”、“\?>”和“?>”。理想的解决方案是将文档加载到 XMLDocument 对象中，然后只获取消息正文的文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T22:06:18.513

查找 XML 规范，尤其是以下的语法[`prolog`](http://www.w3.org/TR/REC-xml/#sec-prolog-dtd)：

> [22] 序言 ::= XMLDecl？杂项*（doctypedecl杂项*）？
> 
> [23] XMLDecl ::= '<?xml' VersionInfo EncodingDecl? SDDecl? 年代？'?>'

因此，您的手动代码应该能够解析`VersionInfo`，`EncodingDecl`以及`SDDecl`XML 声明标记的开始和结束标记。有关这些单个项目的更多信息，请参阅规范。

但是，我的建议是为正确的工作使用正确的工具：使用 XML 工具包/解析器。（解析器和工具包的区别主要在于工具包将支持高级操作，例如 DTD 验证、命名空间处理、XPath 等）。

MSXML4 已经很老了。MSXML6 是最新的。但是，MSXML6 对除了小的 XML 文件之外的任何东西都毫无用处。因此，根据您的输入文件大小（如果性能很重要）选择解析器。有免费可用的库，如 Xerces、RapidXML、pugixml 等，它们的性能*要好得多*。

另外，您能否具体说明您在使用 MSXML4 时遇到了哪些困难？

# .htaccess - .htaccess 使用查询字符串重定向

> ID：10983339
> 
> 赞同：1
> 
> 时间：2012-06-11T15:41:37.340
> 
> 标签：.htaccess

我正在尝试做一个非常简单的重定向。我们正在从独立的 Wordpress 安装转移到多站点 Wordpress 安装，我正在尝试让重定向适用于带有查询字符串的页面。这是我到目前为止的代码：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.domain\.com$ [NC]
RewriteRule ^advise/index_pt(.*)$ http://domain.com/advise/pennies-to-millions/$1 [NE,L,R=301] 
```

基本上，这就是我想要的：（有或没有 www）

*.domain.com/advise/index_pt.php?(参数) => *.domain.com/advise/pennies-to-millions/?(参数)

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:06:26.680

查询字符串不是用于在`RewriteRule`指令中匹配的 URI 的一部分。因此，您不能使用正则表达式在`RewriteRule`. 如果您需要匹配它们，您可以`RewriteCond %{QUERY_STRING} <regex>`在规则之前使用 a。但是，如果您不使用**?创建任何新的查询字符串，无论如何都会自动附加查询字符串。**在规则的目标中。*您可以删除规则中的所有反向引用，并在www*周围添加括号以使其可选。

```
RewriteCond %{HTTP_HOST} ^(www\.)?domain\.com$ [NC]
RewriteRule ^advise/index_pt.php$ http://domain.com/advise/pennies-to-millions/ [NE,L,R=301] 
```

# .net - 实例验证错误：不是 Xml 反序列化的有效值

> ID：10983340
> 
> 赞同：4
> 
> 时间：2012-06-11T15:41:38.080
> 
> 标签：.net, vb.net, xml-serialization

我希望有人能在这里指出我正确的方向，因为这个错误消息完全没有意义。我在 VB.NET 库中声明了一个枚举值，如下所示。

```
<Serializable()> Public Enum OptionDataType
    <Xml.Serialization.XmlEnum("0")> None = 0
    <Xml.Serialization.XmlEnum("1")> Option1 = 1
    <Xml.Serialization.XmlEnum("2")> Option2 = 2
    <Xml.Serialization.XmlEnum("3")> Option3 = 3
    <Xml.Serialization.XmlEnum("4")> Option4 = 4
    <Xml.Serialization.XmlEnum("5")> Option5 = 5
    Option6 = 6
End Enum 
```

当我尝试反序列化此对象的 XML 表示时，我收到一条错误消息：

```
"Instance validation error: 'None' is not a valid value for OptionDataType." 
```

正如您在上面看到的，“无”显然是一个有效值。更令人沮丧的是，这个错误只会出现在某些 XML 文件中。以相同方式序列化并具有“无”值的其他文件将反序列化而不会出现任何问题。我已经将工作文件与无数次抛出错误的文件进行了比较，并且 XML 结构完全相同。

下面是序列化 XML 的片段。

```
<Key>0</Key>
<OptionType>None</OptionType>
<TypeId>0</TypeId> 
```

我怀疑存在更深层次的问题，但 CLR 抛出了一个谎言错误而不是有用的东西。有人可以指出我找出实际问题的正确方向吗，或者如果这是一个有效的错误，请向我解释为什么以及出了什么问题？此外，值得一提的是，反序列化发生在 C# 库中。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T03:07:05.877

您应该发布其余代码，因为缺少一些代码。您的序列化 XML 引用“OptionType”作为字段，但枚举类型上没有更改其名称的 XmlElement 声明。

在您的代码中往上看，在将枚举作为属性的类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-21T04:51:21.773

我认为 XmlEnum 属性决定了用于序列化目的的有效值。尝试更改为以下内容：

```
<Xml.Serialization.XmlEnum("None")> None = 0 
```

# parsing - 查看日志文件的最后 15 行以检查重复 3 次的“错误”并执行命令

> ID：10983342
> 
> 赞同：0
> 
> 时间：2012-06-11T15:42:00.390
> 
> 标签：parsing, unix, text, logfile

我想要一个可以读取文本文件最后 15 行的脚本，如果“错误”一词出现超过 3 次，它将执行命令。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-05T11:44:08.180

```
#!/bin/bash
if [ `tail -15 <file> | grep error | wc -l` -gt 3 ]
then
   echo "Too many errors..."
else
   echo "Everything is fine."
fi 
```

或者在命令行上：

```
if [ `tail -15 <file> | grep error | wc -l` -gt 3 ]; then echo "Too many errors..."; else echo "Everything is fine."; fi 
```

# c# - 整数后一位数

> ID：10983344
> 
> 赞同：0
> 
> 时间：2012-06-11T15:42:06.683
> 
> 标签：c#, formatting

要格式化我的数字，我使用以下语法：

```
move.ToString("+0.#;-0.#;0.0") 
```

它工作正常，但如果我有一个整数，它不会显示有意义的 0，例如：3 而不是 3.0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T15:42:50.100

是的：

```
move.ToString("+0.0;-0.0;0.0") 
```

# html - Firefox (v10) 中的文件拖放

> ID：10983347
> 
> 赞同：5
> 
> 时间：2012-06-11T15:42:21.180
> 
> 标签：html, file-upload, drag-and-drop

我正在尝试在 Firefox 中进行文件拖放，并正在采取婴儿步骤开始。现在，我只是想将一些文件拖到一个放置区并获取已放置文件的列表。在这一点上，我还不想对文件做任何事情。

当我将文件（在本例中为图像，但无论文件类型如何，都会发生相同的事情）从 finder 拖动到 dropzone 时，我可以看到 dragenter 和 dragexit 事件正在触发。当我将文件放入放置区时，放置事件不会触发。相反，浏览器会自行打开图像（例如，地址显示为 file://path/to/my/image.png）。

我的 javascript 看起来像这样：

```
 dropbox = document.getElementById("standard_file_dropzone");

  dropbox.addEventListener("dragenter", function(){console.log('standard enter');}, false);
  dropbox.addEventListener("dragexit", function(){console.log('standard exit');}, false);
  dropbox.addEventListener("dragover", $.noop, false);
  dropbox.addEventListener("drop", function ( event ) {
                                     console.log('standard dropped');
                                     event.stopPropagation();
                                     event.preventDefault();

                                     if(( typeof event.dataTransfer.files !== 'undefined' ) &&
                                        ( event.dataTransfer.files.length > 0 )) {
                                       console.dir( event.dataTransfer.files );

                                     }
                                     return false;
                                   }, false); 
```

我的 HTML 如下所示：

```
 <div id="standard_file_dropzone" style="height:150px; width:150px; border:solid;">
      Standard Drop Files Here
    </div> 
```

所以我想知道我在这里做错了什么？上面的代码似乎没有任何问题（至少对我来说很明显）。dragenter/exit 事件正在触发，为什么不是 drop 事件？为什么浏览器试图打开文件本身？

需要注意的一点是，当我在 Chrome 中打开我的页面时，它按预期工作，所以这是一个 Firefox 特定的问题。

谢谢，克里斯托夫

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T17:30:03.537

问题是使用 $.noop 作为拖动处理程序。用一个实际上停止传播和冒泡的函数替换它，它开始按预期工作。

我有时就是个白痴。:p

# batch-file - NANT 复制所有具有相似名称的文件

> ID：10983348
> 
> 赞同：0
> 
> 时间：2012-06-11T15:42:23.510
> 
> 标签：batch-file, copy, nant, xcopy

我正在将现有的批处理脚本转换为 nant 脚本。

批处理文件最初进行了此调用，这似乎将所有具有相同前缀的文件复制到一个目录中。

```
xcopy /y /s "paths\name*.exe" Directory\ 
```

我知道如何在 nant 中复制文件夹树，但这是不同的。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:18:07.443

好的，我想通了。我用这个：

```
<copy todir="target\similars" >
    <fileset basedir="source\similars">
        <include name="similar*.txt" />
    </fileset>
</copy> 
```

`*`元素中的通配符`include`让我可以指定文件名的差异。

# ios - UIView 上的手势

> ID：10983355
> 
> 赞同：1
> 
> 时间：2012-06-11T15:42:47.157
> 
> 标签：ios, uigesturerecognizer, paint, user-interaction

我正在绘制一个`UIView`被调用的`paintingView`对象，我可以从滚动视图中拖动一些图像视图；但我不会直接在paintingView 上拖动这些对象，而是在一个`UIView`称为“over”的上方。这个“结束”有`userinteractionenabled = NO`，所以这样我就可以毫无问题地画画了。

这是我的问题：要让这些对象“结束”，我应该添加一些手势（双击或长按）；但是这个“结束”`userinteractionenabled = NO`所以手势不起作用你知道如何为这些对象添加手势吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:01:06.303

为您的“over”视图创建 UIView 的子类并覆盖`hitTest:withEvent:`。

如果您触摸到拖入的视图，请处理它（返回拖入的视图），否则返回`[super hitTest:withEvent:];`.

（并`userInteractionEnabled`再次打开）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:05:00.143

或者另一个想法：

将`UITapGestureRecognizer`with minimumTouches: of two 放到您的绘画视图上并检查触摸是否在拖入的视图中。如果是这样处理它在这里。但你可能会用这种方法意外绘制。

您也可以自己识别双击。你可能已经覆盖了`touchesBegan:`等等。你可以在那里识别它，通过你的“over”视图的子视图并检查它是否在图像的范围内。如果是这样，请处理它，不要为那种触摸而画画。

# java - 从 Maven 有条件地运行 JUnit 测试

> ID：10983361
> 
> 赞同：4
> 
> 时间：2012-06-11T15:43:10.753
> 
> 标签：java, maven, junit

在 Maven 中，是否有某种方法可以指定 JUnit 测试仅在有一些源代码更改时运行？

例如，我看到这条消息

```
[INFO] --- maven-compiler-plugin:2.3.2:testCompile (default-testCompile) @ my_project ---
[INFO] Nothing to compile - all classes are up to date 
```

现在 - 因为没有编译代码（因为上次编译没有更改），我宁愿不运行任何测试。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T22:12:50.350

Your project setup should be broken up into separate modules. However if you can not do that you could set the maven.test.skip property in your profiles in which you want no tests to be run. See [more about skipping tests on the site](http://maven.apache.org/plugins/maven-surefire-plugin/examples/skipping-test.html).

You are talking about a war project. Typically a war project should NOT have any code in it, but rather just some configuration and stuff like html, jsp, css and java script and bundle jar projects, that contain java code. The jar projects will have the code. And if you do integration tests a good practice is to have them in separate modules.

Different war configs can be in profiles or potentially also in separate modules using the war overlay feature of the maven war plugin.

# php - 合并 SQL 查询的结果

> ID：10983362
> 
> 赞同：0
> 
> 时间：2012-06-11T15:43:12.350
> 
> 标签：php, mysql, sql, whmcs

我有点紧张。我正在使用 WHMCS 并构建自定义报告，但我的一个查询遇到了麻烦。这是一个概述：

我有 2 张桌子；tblinvoices 包含发票的小计、税款、总计等，tblinvoiceitems 包含发票上出现的各个行项目。我想运行一个查询，返回我能够做到的所有单个行项目及其价格。当我执行“GROUP BY”并按发票编号对结果进行分组时遇到问题，然后它只返回每张发票的第一个行项目。我想按发票编号对它们进行分组，因此报告中只有 1 行。这是我的查询：

```
$query = "SELECT date_format(tblinvoices.datepaid,'%m-%d-%Y') AS datepaid,
    tblinvoices.userid,
    tblinvoices.id,
    tblinvoices.subtotal,
    tblinvoices.credit,
    tblinvoices.tax,
    tblinvoices.tax2,
    tblinvoices.total,
    tblinvoices.taxrate,
    tblinvoices.taxrate2,
    tblinvoiceitems.description,
    tblinvoiceitems.amount,
    tblinvoices.status,
    FROM tblinvoices
    INNER JOIN tblinvoiceitems ON tblinvoices.id = tblinvoiceitems.invoiceid
    GROUP BY tblinvoices.id";
$result = mysql_query($query);

# Math Operations
$statement = array();
$count = 0;

if ($result !== false) {
    while ($data = mysql_fetch_object($result)) {
        $invoiceid = $data->id;
        $datepaid = $data->datepaid;
        $description = $data->description;
        $item_amount = $data->item_amount;
        $subtotal = $data->subtotal;
        $credit = $data->credit;
        $tax = $data->tax;
        $tax2 = $data->tax2;
        $total = $data->total;

        if ($export != true) {
            $client_link = '<a href=clientssummary.php?userid='.$data->userid.'>'.$data->userid;
            $invoice_link = '<a href=invoices.php?action=edit&id='.$data->id.'>'.$data->id;
        }
        else {
            $client_link = $data->userid;
            $invoice_link = $data->id;
        }
        if (strpos($description, 'Setup') !== false) {
            $setup = $item_amount;
        }
        else {
            $setup = 0;
        }
        if (strpos($description, 'Addon') !== false) {
            $addon = $item_amount;
        }
        else {
            $addon = 0;
        }
        if (strpos($description, 'Tax Guide: No => Yes') !== false) {
            $taxguide = $item_amount;
        }
        else {
            $taxguide = 0;
        }
        if (strpos($description, 'Reading Rack Bundle') !== false) {
            $reading = $item_amount;
        }
        else {
            $reading = 0;
        }
        if (strpos($description, 'Toolkit Bundle') !== false) {
            $toolkit = $item_amount;
        }
        else {
            $toolkit = 0;
        }
        $hosting = $subtotal - $setup - $addon - $taxguide - $reading - $toolkit;

        $statement[$invoiceid."_".$count] = array($datepaid,$client_link,$promo,$dtn,$company,$state,$invoice_link,$setup,$addon,$taxguide,$reading,$toolkit,$hosting,$subtotal,$credit,$tax+$tax2,$total);
        $count++;
    }
}

foreach ($headings AS $k=>$v) {
    $reportdata["tableheadings"][] = $v;
}

//ksort($statement);
foreach ($statement AS $invoiceid=>$entry) {
    $reportdata["tablevalues"][] = array(
        $entry[0], // datepaid
        $entry[1], // clientid
        $entry[2], // promocode
        $entry[3], // dtn
        $entry[4], // companyname
        $entry[5], // state
        $entry[6], // invoiceid
        formatCurrency($entry[7]), // setup
        formatCurrency($entry[8]), // addon
        formatCurrency($entry[9]), // taxguide
        formatCurrency($entry[10]), // reading
        formatCurrency($entry[11]), // toolkit
        formatCurrency($entry[12]), // hosting
        formatCurrency($entry[13]), // subtotal
        formatCurrency($entry[14]), // credit
        formatCurrency($entry[15]), // tax
        formatCurrency($entry[16]) // total
    );
}
mysql_free_result($result); 
```

如果有帮助，我将很乐意提供任何其他信息/代码。我虽然这可能是一个更一般的类型问题......谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:52:40.170

所以尝试按 invoice.id 和 invoice.userid 分组，然后可能是 invoice.subtotal....

如果您以后决定汇总任何内容，但应该这样做，可能会遇到一些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:53:58.723

根据您描述的结果集，您的结果集将如下所示：

```
userid | id | subtotal | credit | tax | status | desc | amount
______________________________________________________________

     1 |  1 |       20 |      0 |  .7 |      1 | item1|     10
     1 |  1 |       20 |      0 |  .7 |      1 | item2|     10
     1 |  2 |       30 |      0 | 2.1 |      1 | item3|     15
     1 |  2 |       30 |      0 | 2.1 |      1 | item3|     15
     1 |  3 |       10 |      0 |  .7 |      0 | item1|     10
     1 |  4 |        1 |      0 | .07 |      0 | item4|      1 
```

这是你想要的？

# css - 是否可以使用 CSS 删除 a href 标签？

> ID：10983366
> 
> 赞同：3
> 
> 时间：2012-06-11T15:43:27.660
> 
> 标签：css, href

我在这里有代码，我想通过 CSS 使 a href 不可点击：

```
<div id="header" 
     style="background: url(/uploads/header/derivativesheader.gif)" 
     class="header-link">
  <h1 id="logo" class="notext">
    <a href="/">Title</a>
  </h1> 
</div> 
```

我无法删除硬编码的 href 标记，但想知道是否可以使用 CSS hack 覆盖它的操作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-11T15:50:10.510

[`pointer-events`](https://developer.mozilla.org/en/CSS/pointer-events)您可以使用属性禁止单击事件：http: [//jsfiddle.net/NnEXn/](http://jsfiddle.net/NnEXn/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T18:17:58.003

```
<a href="/" class="hide">

.hide {
   visibility: hidden;
} 
```

这将阻止可点击的操作

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T15:46:34.677

*删除*没有。*隐藏*是的。

```
#logo a { 
    display: none;
} 
```

然而，这可能不是想要的结果，因为它也会隐藏锚的内部内容（即*Title*）。因此，JavaScript 解决方案可能更适合。但要*回答*这个问题，这*是*一种仅使用 CSS 的方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T15:46:57.290

我认为这是不可能的（纯 CSS）。我知道使链接不可点击的唯一方法是在链接上放置另一个元素（zindex，仍然是纯 CSS），并且是透明的，以便单击更高的元素而不是链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-27T12:06:28.397

也许您不能这样做（正如您所说，您不能删除硬编码标签），但如果您可以向 DOM 添加元素，我只需添加一个不带 href 的重复链接并将另一个链接设置为“display:none”。这将保留页面的流程和链接的视觉呈现。

# android - 通过从其他应用程序中提取信息来利用 Twitter / Facebook 凭据

> ID：10983374
> 
> 赞同：0
> 
> 时间：2012-06-11T15:43:40.990
> 
> 标签：android, facebook, twitter

我被问到是否有可能通过从已安装和验证的应用程序中提取帐户信息来利用 facebook 和 twitter 凭据。

这意味着：一个应用程序正在运行，并且用户通过 FB 或 TW 登录。然后，它启动我的应用程序。可以获取这些凭据并让用户也登录我的应用程序吗？我认为这样做可能不太好，但他们要求我回答。

我做了研究，没有发现任何相关的东西，所以我认为这是不可能的。

谁能证实这一点或告诉我如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:57:02.427

如果您只想从您的应用程序将数据共享到 Twitter 或 Facebook，您应该使用共享 Intent 来执行此操作。通过这种方式，您可以将数据推送到任何应用程序（FB 或 Twitter，或其他应用程序，如电子邮件和消息传递），同时用户选择他们选择在哪个应用程序上发布此数据。在此处的开发人员博客中查看更多信息：[http ://android-developers.blogspot.com/2012/02/share-with-intents.html](http://android-developers.blogspot.com/2012/02/share-with-intents.html)

和这里的教程：http: [//mobile.tutsplus.com/tutorials/android/android-sdk-implement-a-share-intent/](http://mobile.tutsplus.com/tutorials/android/android-sdk-implement-a-share-intent/)

如果您想使用经过身份验证的帐户做特定的事情，例如检索用户的时间线或墙上的帖子，我认为您无法从另一个应用程序借用该经过身份验证的令牌。您必须在每个社交网络上注册您的应用程序，询问用户他/她的凭据并获取令牌。然后您可以从这些服务中获取数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:09:26.843

不，你不能。每个应用程序必须在各自的社交网络上注册，以获得应用程序密钥和应用程序机密。然后，您必须从社交网络的服务器请求授权令牌。由于令牌基于特定的应用程序密钥和秘密，即使您能够利用此授权令牌（例如在根设备上），它对您也无用，因为您还必须知道密钥和秘密。并且 Facebook 将应用签名匹配为额外的安全层。

简单明了没有:)

# javascript - 在制作动画之前存储定位数据

> ID：10983376
> 
> 赞同：0
> 
> 时间：2012-06-11T15:43:57.047
> 
> 标签：javascript, jquery, jquery-animate

我想用 jQuery 为 DIV 设置动画`animate()`，通过 ajax 加载新内容并将动画返回到原始位置。为了稍后返回动画，我通过`data()`.

这是到目前为止的代码：

```
(function($){
    //Transition Out
$.fn.ajaxTransitionOut = function() {
    var origin = this.css('left');      
    var amount = $(window).width()*-1;

    return $(this).data('origin',origin).stop().animate({left:amount, opacity:0}, 400);

};

})(jQuery); 
```

第二次尝试：

```
(function($){
    //Transition Out
$.fn.ajaxTransitionOut = function() {
    var origin = $(this).css('left');
    $(this).data('origin',origin)       
    var amount = $(window).width()*-1;

    return $(this).data('origin',origin).stop().animate({left:amount, opacity:0}, 400);

};

})(jQuery); 
```

问题：旧位置的存储太慢，并且在数据中“原点”是动画对象时的一个值。（任何负值）

如果我延迟动画，则存储正确的值，但这不是我想要的。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:48:39.433

如果您改用 load，您可以在加载完成后触发一个函数。此外，使用 ajax 您还可以选择之前、成功和完成等选项。这是文档中的加载示例。

```
$('#result').load('ajax/test.html', function() {
  alert('Load was performed.');
}); 
```

# json - 在 C# Visual Studio 中发生 422（无法处理的实体）错误时如何读取 json 响应

> ID：10983379
> 
> 赞同：1
> 
> 时间：2012-06-11T15:44:07.143
> 
> 标签：json, visual-studio-2010, c#-4.0, rest, httpwebresponse

我正在使用“PUT”方法将一些 JSON 数据发送到 Web 服务，但出现*422 无法处理的实体*错误。
我怎样才能真正看到 JSON 中的服务器响应？我深入研究了异常，但仍然找不到 json 响应。

前任：

JSON请求：

```
{
  customer:
  {
    name: "asd",
    address: "test"
  }
} 
```

如果一切正常，它应该响应我一些 JSON 数据。

前任：

```
{
  customer:
  {
    id: 1,
    name: "asd",
    address: "test"
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-28T00:23:09.013

您可以捕获 WebExpection 并从中获取响应并提取正确的错误消息：

代码 ：

```
catch (WebException ex)
{
    using (var sr = new StreamReader(ex.Response.GetResponseStream()))
    {
       var data = sr.ReadToEnd();                    
       throw new ApplicationException(data);
    }                
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:43:41.707

[您可以使用Fiddler](http://www.fiddler2.com/fiddler2/)手动测试此休息服务。
422 HTTP错误解释：*请求格式正确，但由于语义错误而无法执行*。
因此，例如检查您发送的 JSON 数据的格式是否正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-14T15:41:38.483

回答您的问题：您无法在指定语法错误的 json 中得到详细的答案。找出错误将是一个手动试错过程。

正如 user3470814 所提到的，您应该捕获这种错误并在您的应用程序中对其进行处理。

正如 lucask 所提到的，Fiddler 将帮助您查看请求中发送的确切字符串。

# css - 将鼠标悬停在图像 B 上时如何更改图像 A 没有 JavaScript 仅 CSS

> ID：10983380
> 
> 赞同：1
> 
> 时间：2012-06-11T15:44:09.287
> 
> 标签：css

我想知道当我只使用 CSS 将鼠标悬停在图像 B 上时如何更新图像 A，这可能吗？如果不是，我将如何仅使用纯 JavaScript（无库）来做到这一点。但是css真的是我想要使用的......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T17:37:12.490

正如我在评论中指出的那样，这完全取决于您的加价。在没有看到任何可以使用的标记的情况下，我只能发布一些一般性建议；但是重要的是要注意，您想要影响的元素 ( `F`) 必须在 DOM 中出现的时间比您要与之交互`F`的元素晚（是元素的子元素，或者是后续兄弟元素，或者后续兄弟元素的后代） 。`E`

也就是说，以下方法将起作用，并带有相关的标记：

### 基于兄弟姐妹的选择：

悬停在第一个`img`内部`#a`切换`display`后续`img`元素，使用`E ~ F`（通用兄弟）组合器：

```
<div id="a">
    <img src="http://www.lorempixel.com/200/400/nature" />
    <img class="first" src="http://www.lorempixel.com/200/400/people" />
    <img class="second" src="http://www.lorempixel.com/200/400/sports" />    
</div>​​​​​

#a img.second,
#a img.first:hover ~ img.second {
    display: none;
}

#a img:hover ~ img.first {
    display: none;
}

#a img:hover ~ img.second {
    display: inline-block;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/JsX8x/1/)。

将鼠标悬停在更改上会使用（直接兄弟）组合`#a`器切换`.first`和`.second`内部的图像的显示：`#b``E + F`

```
<div id="a">
    <img src="http://www.lorempixel.com​​​​​​​​​​​​​​​​​​​​​​​​/200/400/nature" />
</div>
<div id="b">
    <img class="first" src="http://www.lorempixel.com/200/400/people" />
    <img class="second" src="http://www.lorempixel.com/200/400/sports" />    
</div>​​​​​​​​​​​​​​​​​

#a,#b {
    float: left;
    border: 1px solid #000;
    padding: 0.2em;
}

img.second {
    display: none;
}

#a:hover + #b img.first {
    display: none;
}
#a:hover + #b img.second {
    display: inline-block;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/JsX8x/)。

### 基于后代的选择：

使用`E F`一般的后代组合器（我实际上并不完全确定空格字符*是*组合器，但无论如何......它是基于`F`作为的后代`E`）：

```
<div id="a">
    <img class="first" src="http://www.lorempixel.com/200/400/people" />
    <img class="second" src="http://www.lorempixel.com/200/400/sports" />    
</div>​

#a img.second {
    display: none;
}

#a:hover img.first {
    display: none;
}

#a:hover img.second {
    display: inline-block;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/JsX8x/2/)。

使用`E > F`直接子/直接后代组合器：

```
<div id="a">
    <img class="first" src="http://www.lorempixel.com/200/400/people" />
    <div>
        <img class="second" src="http://www.lorempixel.com/200/400/sports" />
    </div>
</div>​    div {
    display: inline-block;
}

img {
    display: none;
    border: 1px solid #000;
    padding: 0.2em;
}

#a > img {
    display: inline-block;
}

#a:hover img {
    display: inline-block;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/JsX8x/4/)。

* * *

还有机会使用伪元素和 css 生成*的*内容（在兼容/最新的浏览器中）：

```
<div id="a"></div>​

#a {
    width: 200px;
    height: 400px;
    background-image: url(http://www.lorempixel.com/200/400/people);
    background-repeat: none;
    background-position: 50% 50%;
    position: relative;
}

​#a:hover::after {
    content: url(http://www.lorempixel.com/200/400/animals);
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 100%;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/JsX8x/5/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T15:59:21.277

在您的特定情况下，这很容易，因为`#bg`是`#hv`

只需将悬停选择器从您所拥有的更改为：

`#bg:hover #hv {...}`

在这里查看我的小提琴叉：http: [//jsfiddle.net/xJSQt/](http://jsfiddle.net/xJSQt/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T15:59:36.427

`#hv`要在悬停外部元素时更新内部元素的背景位置`#bg`，您可以：

请参阅此[工作小提琴](http://jsfiddle.net/zuul/bxXJU/1/)示例！

```
#bg:hover #hv {
   ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T15:50:26.083

简单的。假设你有一个这样的 div：

```
<div class="myImage"> 
```

因此，在 CSS 中设置正常的背景图像，然后使用 :hover 伪元素将其更改为所需的翻转图像。就像是：

```
.myImage{ background-image: url(imageA.jpg);} /*Set the normal image*/
.myImage:hover{ background-image: url(imageB.jpg);} /*Set the rollover image*/ 
```

# iis - 在 IIS 上设置 Kudu

> ID：10983385
> 
> 赞同：10
> 
> 时间：2012-06-11T15:44:22.917
> 
> 标签：iis, kudu

几天前，微软发布[了他们用于将 git 部署到 Azure 的引擎](https://github.com/projectkudu/kudu)。一段时间以来，我的 TODO 列表中有一项任务是在我的 DEV IIS 服务器上设置这种功能，因此我有兴趣为此目的尝试 Kudu。

“[入门](https://github.com/projectkudu/kudu/wiki/Getting-started)”文档显示了如何运行 Web 前端，但其中的所有内容都使用“ [http://localhost:PORTNUMBER](http://localhost:PORTNUMBER) ”类型的 git 存储库、站点 URL 等 URL。

我意识到这可能远远领先于他们，但我想知道是否有人有关于如何使用“常规”IIS 上的真实域而不是所有 localhost 位来设置它的指针？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-10-21T17:03:04.153

这是一个老问题，所以我给出了一个更新的答案，包含更多最新信息，因为我刚刚在内部部署服务器上设置了 Kudu。当前选择的答案仅适用于您在开发环境中直接运行 Kudu 的情况。

如果您要部署到“生产”类型的环境并且不想在目标服务器上安装 Visual Studio，那么在 github 上的项目网站上有一个很好的指南。

[https://github.com/projectkudu/kudu/wiki/Deploying-to-a-server](https://github.com/projectkudu/kudu/wiki/Deploying-to-a-server)

在目标服务器上，您需要安装：

*   MSBuild ( [http://go.microsoft.com/fwlink/?LinkId=309745](http://go.microsoft.com/fwlink/?LinkId=309745) ) - 随 Visual Studio
*   NodeJS ( [http://nodejs.org](http://nodejs.org) )
*   Git ( [http://git-scm.com/downloads](http://git-scm.com/downloads) )

回到您的开发机器上，克隆 git 存储库并使用“build.cmd”文件进行构建，按照上面链接中的说明进行操作。

在运行 build.cmd 时，我遇到了几个测试失败，这些失败阻止了构建生成工件。这些都与我们不使用的 Mercurial 有关。安装 Mercurial 客户端并没有让它们神奇地消失，所以我禁用了测试而不是花费大量时间调试我的环境。

您的构建输出将指示失败。我通过注释掉 [Fact] 属性来禁用。这些是我禁用的测试：

*   测试/Kudu.Core.Test/HgRepositoryFacts.cs（所有测试）

一旦成功构建并创建了工件中的所有项目，您就可以开始部署 Kudu 网站和 Web 服务代码。以下说明用于设置不同的 Web 应用程序实例，而不是将所有内容转储到 c:\inetpub\wwwroot 中，这就是说明的读取方式。

1.  将“artifacts\Release\KuduWeb”复制到您的网站将运行的服务器上的目标区域。我使用单独的主机头运行我的 kudu 安装，但您可以轻松地使用单独的端口或作为根网站运行。此目录将是您的 Web 应用程序的根目录。

2.  在 KuduWeb 文件夹下创建一个空的“App_Data”文件夹。

3.  将“artifacts\Release\SiteExtensions\Kudu”复制到与步骤1中的文件夹相同的级别并重命名为“Kudu.Services.Web”。该位置在 KuduWeb web.config 文件中设置为相对路径 - 设置 serviceSitePath。

4.  打开 IIS Admin 并创建一个指向步骤 1 中的“KuduWeb”文件夹的网站。

5.  将第 4 步中的应用程序池配置为作为“LocalSystem”运行。这是管理 IIS 站点所必需的。

6.  在与 KuduWeb 相同的级别创建一个新文件夹“apps”。这是将发送部署的地方。注意：这个位置在 KuduWeb web.config 文件中控制 - 设置“sitesPath”

7.  更改文件系统权限以授予“用户”对上述步骤中创建的“应用程序”文件夹的完全访问权限。

在启动我的 Kudu 网站时，我收到以下错误。

解析器错误消息：无法加载文件或程序集“System.Web.Mvc，Version=5.1.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。该系统找不到指定的文件。

由于某种原因，它没有将适当的 MVC 版本复制到部署工件中。

如果遇到此错误，可以通过 NuGet 获取 MVC 5 文件。我发现我的源代码是针对 5.1.0 构建的，所以这是适当的链接：

[https://www.nuget.org/packages/Microsoft.AspNet.Mvc/5.1.0](https://www.nuget.org/packages/Microsoft.AspNet.Mvc/5.1.0)

为了提取 dll，我建立了一个新的虚拟项目，并使用 NuGet 通过包管理器控制台拉下 dll。

> 安装包 Microsoft.AspNet.Mvc -Version 5.1.0

获得二进制文件后，将其从包目录（ .\packages\Microsoft.AspNet.Mvc.5.1.0\lib\net45\System.Web.Mvc.dll ）复制到目标计算机上的网站 bin 目录。

此时您已启动并运行。使用 Web 界面创建您的应用程序。它将在“apps”目录下创建一个子文件夹，其中的树应该是不言自明的。它还将为您的应用程序创建两个新网站：

*   kudu_{您的应用程序名称}
*   kudu_service_{您的应用程序名称}

在生产情况下，您应该创建一个在适当的端口/主机标头上运行的附加网站，该标头指向：.\apps\\site\wwwroot

现在您可以为您的部署添加一个 git 远程。在 git 控制台（例如：Git Bash）中转到您的源位置并添加 Kudu 标识的远程。注意：您可能需要将 url 中的 localhost 更改为适当的服务器名称。

> git 远程添加部署 http://:52711/your-app-name.git

将您的代码推送到新的“部署”遥控器，看看会发生什么。您应该看到所有正常的推送消息，以及构建输出。

> git push 部署大师

由于“节点”未被识别，我的初始推送未能构建和部署。它在路径中，因此服务器重置使路径环境变量被刷新。您可能会发现需要解决的其他错误。例如，我遇到了导入 MSBuild 并导致打嗝的问题。

错误 MSB4019：找不到导入的项目“C:\Program Files (x86)\MSBuild\Microsoft\Visual Studio\v11.0\WebApplications\Microsoft.WebApplication.targets”。

YMMV，但现在这些都是可以解决的问题。良好的持续部署！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-11T01:29:45.740

The project automatically sets up two websites on IIS for each application you add using the web front end. Kudu doesn't automatically map the bindings for them but it's relatively easy to open IIS and find the two sites named "kudu_appname" and "kudu_appname_service". The service website is the one that you point GIT too and the other one is the site itself. Just add public bindings to them by right-clicking and "edit bindings". You can then add public hostnames to them.

This is the easy part. The hard part that I'm still working on is getting authentication working so any random Joe isn't able to push to my kudu repository!

# xml - 解析与验证

> ID：10983386
> 
> 赞同：3
> 
> 时间：2012-06-11T15:44:24.687
> 
> 标签：xml, validation, parsing

验证和解析有什么区别？

我知道解析检查文件结构（语法），所以可能在解析函数中检查为 OK，但在验证过程中可能是错误的，因为没有像“pink”这样的 attr 值？我对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T15:52:06.847

用 xml 术语解析是从 xml 数据构建文档树

验证是根据模式检查该树的内容

所以如果你有

```
<Document>Me.txt<\Document> 
```

它可以被解析，因为它有一个根节点并且所有打开和关闭标签都匹配等

如果您针对表示根节点是 Form 的模式进行验证，尽管它是无效的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T20:30:02.840

解析检查输入是否符合 XML 规范中的规则，例如每个开始标记都有一个匹配的结束标记。

验证检查输入是否符合特定 XML 词汇表的规则，例如，表是否恰好包含一个 thead 和一个 tbody。

# c# - 过滤 P4 .Net 文件列表

> ID：10983389
> 
> 赞同：3
> 
> 时间：2012-06-11T15:44:31.607
> 
> 标签：c#, perforce, getfiles

我有一个程序填充组合框，其中包含 perforce 库中选定目录中包含的文件的详细信息。

相关的代码是这样的：

```
PerforcePath dir = _ctlProductSelect.SelectedItem as PerforcePath;

_ctlServicePackSelect.Items.Clear();

if (dir != null)
{
    foreach (P4.File file in _perforce.GetFiles(null, P4.FileSpec.DepotSpec(dir.Path + "/*.sp")))
    {
       _ctlServicePackSelect.Items.Add(new PerforcePath(file.DepotPath.Path));
    }
} 
```

问题是这还包括标记为已删除的文件。有什么方法可以从`GetFiles`方法返回的列表中过滤已删除的文件？我在 P4_dotNet API 文档中找不到任何可能的嫌疑人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T14:49:35.163

使用 P4API.NET，您可以将`-e`选项添加到`GetFiles`：

```
 IList filesToFind = new List();
FileSpec fileToFind = new FileSpec(new DepotPath("//depot/..."), null, null, VersionSpec.Head);
filesToFind.Add(fileToFind);
Options o = new Options();
o.Add("-e", "");
IList filesFound = pRep.GetFiles(filesToFind, o);
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T14:32:27.227

我最终得到的工作是在 foreach 循环中执行此操作：

```
foreach (P4.File file in _perforce.GetFiles(null, P4.FileSpec.DepotSpec(dir.Path + "/*.sp")))
{
    if (_perforce.GetFileMetaData(null, file)[0].HeadAction.ToString() != "MoveDelete")
    _ctlServicePackSelect.Items.Add(new PerforcePath(file.DepotPath.Path));
} 
```

基本上在将每个文件添加到组合框之前检查它的元数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T08:03:18.853

```
IList<FileSpec> filesToFind = new List<FileSpec>();
FileSpec fileToFind = new FileSpec(FileSpec.DepotSpec("//depot/...").DepotPath, Revision.Head);
filesToFind.Add(fileToFind);
Options o = new Options();

o.Add("-m", "changelistid");
IList<File> FilesFound = rep.GetFiles(filesToFind, o) 
```

# symfony - 在 Symfony2 中，如何刷新页面，只更改 GET 字符串的一个参数？

> ID：10983392
> 
> 赞同：2
> 
> 时间：2012-06-11T15:44:41.310
> 
> 标签：symfony, get, request, query-string

如何刷新页面，更改 GET 字符串的一个参数？

假设我在这个页面上：

```
/my/page?foo=bar&asd=qwe 
```

在控制器中，我有这个变量：

```
$var = array('foo' => 'woof'); 
```

如何使用该变量重定向到此页面？：

```
/my/page?foo=woof&asd=qwe 
```

或者，如果我在此页面上：

```
/my/page 
```

使用该变量，我如何访问此页面？：

```
/my/page?foo=woof 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T15:52:38.690

如果我理解得很好，你想要做的是：

```
public function myAction()
{
    $request = $this->getRequest();
    $params = $request->query->all();  // get the original GET parameters

    $var = array('foo' => 'woof');
    $newParams = array_replace($params, $var); // only replaces the 'foo' parameter, keeping the rest as is

    $url = '/my/page?'.http_build_query($newParams); // you can also use $this->generateUrl() if you use routing (which would be a good idea)

    return $this->redirect($url);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T11:23:39.210

```
public function onKernelRequest(GetResponseEvent $event) {
    $request = $event -> getRequest();
    $routes = $this -> router -> getRouteCollection();
    $routeName = $request -> get("_route");
    $params = $request -> query -> all();
    $route = $routes -> get($routeName);
    preg_match_all("/{(.+)}/", $route -> getPattern(), $routeParams);
    $routeParams = $routeParams[1];
    foreach ($routeParams as $key => $value) {
        $params[$value] = $request -> get($value);
    }

    if (array_key_exists("to_remove", $params)) {
        unset($params['to_remove']);
        $url = $this -> router -> generate($routeName, $params);
        $event -> setResponse(new RedirectResponse($url));
    }
} 
```

# python - for - else vs for elif

> ID：10983394
> 
> 赞同：10
> 
> 时间：2012-06-11T15:44:48.273
> 
> 标签：python, for-loop, python-2.7, if-statement

我以为 elif: 是

```
else:
     if: 
```

但不可能使用

对于 - elif：

只要

对于 - 否则：如果：

在这段代码中：

```
for line in source:
    change_next = False
    for dataset,artnr,revision in datasets:
        if dataset in line:
            change_next = True
            print "  **  " + dataset + " found"
            datasets.remove((dataset,artnr,revision))
            break
    else:
        if line.startswith("DstID:"):
            print line.replace("DstID:","").rstrip()

    if change_next and "Partno:" in line:
        destination.write("Partno: " + artnr + "\n")
        print "Partno: " + artnr
    elif change_next and "Revno:" in line:
        destination.write("Revno:" + revision + "\n")
        print "Revno:" + revision
    else:
        destination.write(line) 
```

感谢您到目前为止的回复，我现在的问题是：这是这样做的方法吗？如果一行中没有任何（已知的）数据集，那么如果它是数据集，我想打印它吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-11T15:48:17.160

`elif:`不是扩展为 的宏`else: if`，它是仅在[`if:`语句](http://docs.python.org/reference/compound_stmts.html#the-if-statement)的上下文中有效的句法元素。通常，`else: if`会打开一个新`if`区块；但是，`elif:`不这样做。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-11T15:47:56.003

是[`for` `else`](http://docs.python.org/reference/compound_stmts.html#the-for-statement)特例用法，与[`if` `elif`](http://docs.python.org/reference/compound_stmts.html#the-if-statement)结构不一样。 无论如何，`elif`在上下文中并没有真正的意义，因为它的含义是“如果我们在没有中断的情况下完成了循环，就做这件事”。这就是二元逻辑。 在这个二元决策的背景下没有意义。`for``for` `else``elif`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-11T15:47:02.640

正确的。`else`in 也是如此`try .. except .. else`。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-11T15:50:23.973

您所指的“else”与“for”命令相关，而不是“if”命令。'elif' 仅在与 'if' 命令一起使用时才有意义。

使用 'for' 命令，只有当 'for' 块没有被 'break' 命令提前结束时，才会执行 'else' 块，参见[第 4.4 段](http://docs.python.org/tutorial/controlflow.html)。

# android - 片段 onCreateView 和 onActivityCreated 调用了两次

> ID：10983396
> 
> 赞同：105
> 
> 时间：2012-06-11T15:44:50.657
> 
> 标签：android, android-fragments, android-4.0-ice-cream-sandwich

我正在使用 Android 4.0 ICS 和 Fragments 开发应用程序。

考虑 ICS 4.0.3（API 级别 15）API 的演示示例应用程序中的这个修改示例：

```
public class FragmentTabs extends Activity {

private static final String TAG = FragmentTabs.class.getSimpleName();

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    final ActionBar bar = getActionBar();
    bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    bar.setDisplayOptions(0, ActionBar.DISPLAY_SHOW_TITLE);

    bar.addTab(bar.newTab()
            .setText("Simple")
            .setTabListener(new TabListener<SimpleFragment>(
                    this, "mysimple", SimpleFragment.class)));

    if (savedInstanceState != null) {
        bar.setSelectedNavigationItem(savedInstanceState.getInt("tab", 0));
        Log.d(TAG, "FragmentTabs.onCreate tab: " + savedInstanceState.getInt("tab"));
        Log.d(TAG, "FragmentTabs.onCreate number: " + savedInstanceState.getInt("number"));
    }

}

@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putInt("tab", getActionBar().getSelectedNavigationIndex());
}

public static class TabListener<T extends Fragment> implements ActionBar.TabListener {
    private final Activity mActivity;
    private final String mTag;
    private final Class<T> mClass;
    private final Bundle mArgs;
    private Fragment mFragment;

    public TabListener(Activity activity, String tag, Class<T> clz) {
        this(activity, tag, clz, null);
    }

    public TabListener(Activity activity, String tag, Class<T> clz, Bundle args) {
        mActivity = activity;
        mTag = tag;
        mClass = clz;
        mArgs = args;

        // Check to see if we already have a fragment for this tab, probably
        // from a previously saved state.  If so, deactivate it, because our
        // initial state is that a tab isn't shown.
        mFragment = mActivity.getFragmentManager().findFragmentByTag(mTag);
        if (mFragment != null && !mFragment.isDetached()) {
            Log.d(TAG, "constructor: detaching fragment " + mTag);
            FragmentTransaction ft = mActivity.getFragmentManager().beginTransaction();
            ft.detach(mFragment);
            ft.commit();
        }
    }

    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        if (mFragment == null) {
            mFragment = Fragment.instantiate(mActivity, mClass.getName(), mArgs);
            Log.d(TAG, "onTabSelected adding fragment " + mTag);
            ft.add(android.R.id.content, mFragment, mTag);
        } else {
            Log.d(TAG, "onTabSelected attaching fragment " + mTag);
            ft.attach(mFragment);
        }
    }

    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        if (mFragment != null) {
            Log.d(TAG, "onTabUnselected detaching fragment " + mTag);
            ft.detach(mFragment);
        }
    }

    public void onTabReselected(Tab tab, FragmentTransaction ft) {
        Toast.makeText(mActivity, "Reselected!", Toast.LENGTH_SHORT).show();
    }
}

public static class SimpleFragment extends Fragment {
    TextView textView;
    int mNum;

    /**
     * When creating, retrieve this instance's number from its arguments.
     */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.d(FragmentTabs.TAG, "onCreate " + (savedInstanceState != null ? ("state " + savedInstanceState.getInt("number")) : "no state"));
        if(savedInstanceState != null) {
            mNum = savedInstanceState.getInt("number");
        } else {
            mNum = 25;
        }
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        Log.d(TAG, "onActivityCreated");
        if(savedInstanceState != null) {
            Log.d(TAG, "saved variable number: " + savedInstanceState.getInt("number"));
        }
        super.onActivityCreated(savedInstanceState);
    }

    @Override
    public void onSaveInstanceState(Bundle outState) {
        Log.d(TAG, "onSaveInstanceState saving: " + mNum);
        outState.putInt("number", mNum);
        super.onSaveInstanceState(outState);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        Log.d(FragmentTabs.TAG, "onCreateView " + (savedInstanceState != null ? ("state: " + savedInstanceState.getInt("number")) : "no state"));
        textView = new TextView(getActivity());
        textView.setText("Hello world: " + mNum);
        textView.setBackgroundDrawable(getResources().getDrawable(android.R.drawable.gallery_thumb));
        return textView;
    }
} 
```

}

以下是运行此示例然后旋转手机检索到的输出：

```
06-11 11:31:42.559: D/FragmentTabs(10726): onTabSelected adding fragment mysimple
06-11 11:31:42.559: D/FragmentTabs(10726): onCreate no state
06-11 11:31:42.559: D/FragmentTabs(10726): onCreateView no state
06-11 11:31:42.567: D/FragmentTabs(10726): onActivityCreated
06-11 11:31:45.286: D/FragmentTabs(10726): onSaveInstanceState saving: 25
06-11 11:31:45.325: D/FragmentTabs(10726): onCreate state 25
06-11 11:31:45.340: D/FragmentTabs(10726): constructor: detaching fragment mysimple
06-11 11:31:45.340: D/FragmentTabs(10726): onTabSelected attaching fragment mysimple
06-11 11:31:45.348: D/FragmentTabs(10726): FragmentTabs.onCreate tab: 0
06-11 11:31:45.348: D/FragmentTabs(10726): FragmentTabs.onCreate number: 0
06-11 11:31:45.348: D/FragmentTabs(10726): onCreateView state: 25
06-11 11:31:45.348: D/FragmentTabs(10726): onActivityCreated
06-11 11:31:45.348: D/FragmentTabs(10726): saved variable number: 25
06-11 11:31:45.348: D/FragmentTabs(10726): onCreateView no state
06-11 11:31:45.348: D/FragmentTabs(10726): onActivityCreated 
```

我的问题是，为什么 onCreateView 和 onActivityCreated 被调用了两次？第一次使用带有已保存状态的 Bundle，第二次使用 null savedInstanceState？

这会导致在旋转时保留片段状态的问题。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-07T08:07:28.297

我也为此摸不着头脑，由于戴夫的解释有点难以理解，我将发布我的（显然是工作的）代码：

```
private class TabListener<T extends Fragment> implements ActionBar.TabListener {
    private Fragment mFragment;
    private Activity mActivity;
    private final String mTag;
    private final Class<T> mClass;

    public TabListener(Activity activity, String tag, Class<T> clz) {
        mActivity = activity;
        mTag = tag;
        mClass = clz;
        mFragment=mActivity.getFragmentManager().findFragmentByTag(mTag);
    }

    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        if (mFragment == null) {
            mFragment = Fragment.instantiate(mActivity, mClass.getName());
            ft.replace(android.R.id.content, mFragment, mTag);
        } else {
            if (mFragment.isDetached()) {
                ft.attach(mFragment);
            }
        }
    }

    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        if (mFragment != null) {
            ft.detach(mFragment);
        }
    }

    public void onTabReselected(Tab tab, FragmentTransaction ft) {
    }
} 
```

如您所见，它与 Android 示例非常相似，除了在构造函数中不分离，并且使用**replace 而不是 add**。

经过多次头疼和反复试验后，我发现在构造函数中找到片段似乎使双重 onCreateView 问题神奇地消失了（我假设当通过 ActionBar.setSelectedNavigationItem() 路径调用 onTabSelected 时它最终为 null保存/恢复状态）。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-09-30T17:52:33.187

我在一个只携带一个片段（有时会被替换）的简单活动中遇到了同样的问题。然后我意识到我只在片段中使用 onSaveInstanceState（和 onCreateView 来检查 savedInstanceState），而不是在活动中。

在设备上，包含片段的活动重新启动并调用 onCreated。在那里我确实附上了所需的片段（在第一次开始时是正确的）。

在设备上，Android 首先重新创建了可见的片段，然后调用了我的片段所附加的包含活动的 onCreate，从而替换了原来的可见片段。

为了避免这种情况，我只是更改了我的活动以检查 savedInstanceState：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

if (savedInstanceState != null) {
/**making sure you are not attaching the fragments again as they have 
 been 
 *already added
 **/
 return; 
 }
 else{
  // following code to attach fragment initially
 }

 } 
```

我什至没有覆盖活动的 onSaveInstanceState。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2012-06-12T12:27:15.510

好的，这就是我发现的。

我不明白的是，当配置更改发生（手机旋转）时附加到活动的所有片段都会重新创建并添加回活动。（这是有道理的）

TabListener 构造函数中发生的情况是，如果找到该选项卡并将其附加到活动，则该选项卡将被分离。见下文：

```
mFragment = mActivity.getFragmentManager().findFragmentByTag(mTag);
    if (mFragment != null && !mFragment.isDetached()) {
        Log.d(TAG, "constructor: detaching fragment " + mTag);
        FragmentTransaction ft = mActivity.getFragmentManager().beginTransaction();
        ft.detach(mFragment);
        ft.commit();
    } 
```

稍后在 onCreate 活动中，从保存的实例状态中选择了先前选择的选项卡。见下文：

```
if (savedInstanceState != null) {
    bar.setSelectedNavigationItem(savedInstanceState.getInt("tab", 0));
    Log.d(TAG, "FragmentTabs.onCreate tab: " + savedInstanceState.getInt("tab"));
    Log.d(TAG, "FragmentTabs.onCreate number: " + savedInstanceState.getInt("number"));
} 
```

选择选项卡后，它将在 onTabSelected 回调中重新附加。

```
public void onTabSelected(Tab tab, FragmentTransaction ft) {
    if (mFragment == null) {
        mFragment = Fragment.instantiate(mActivity, mClass.getName(), mArgs);
        Log.d(TAG, "onTabSelected adding fragment " + mTag);
        ft.add(android.R.id.content, mFragment, mTag);
    } else {
        Log.d(TAG, "onTabSelected attaching fragment " + mTag);
        ft.attach(mFragment);
    }
} 
```

附加的片段是对 onCreateView 和 onActivityCreated 方法的第二次调用。（第一次是当系统重新创建活动和所有附加的片段时） onSavedInstanceState Bundle 第一次会保存数据，但第二次不会。

解决方案是不在 TabListener 构造函数中分离片段，只需将其保持连接即可。（您仍然需要通过它的标签在 FragmentManager 中找到它）此外，在 onTabSelected 方法中，我在附加之前检查片段是否已分离。像这样的东西：

```
public void onTabSelected(Tab tab, FragmentTransaction ft) {
            if (mFragment == null) {
                mFragment = Fragment.instantiate(mActivity, mClass.getName(), mArgs);
                Log.d(TAG, "onTabSelected adding fragment " + mTag);
                ft.add(android.R.id.content, mFragment, mTag);
            } else {

                if(mFragment.isDetached()) {
                    Log.d(TAG, "onTabSelected attaching fragment " + mTag);
                    ft.attach(mFragment);
                } else {
                    Log.d(TAG, "onTabSelected fragment already attached " + mTag);
                }
            }
        } 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-01-12T16:44:18.300

这里的两个赞成的答案显示了具有导航模式的 Activity 的解决方案`NAVIGATION_MODE_TABS`，但我对`NAVIGATION_MODE_LIST`. 当屏幕方向改变时，它导致我的 Fragment 莫名其妙地失去了它们的状态，这真的很烦人。谢天谢地，由于他们有用的代码，我设法弄明白了。

基本上，当使用列表导航`onNavigationItemSelected()`时，无论您喜欢与否，都会在您的活动被创建/重新创建时自动调用。为了防止你的 Fragment`onCreateView()`被调用两次，这个初始的自动调用`onNavigationItemSelected()`应该检查 Fragment 是否已经存在于你的 Activity 中。如果是，立即返回，因为无事可做；如果不是，那么只需像往常一样构造 Fragment 并将其添加到 Activity 中。执行此检查可防止您的 Fragment 被不必要地再次创建，这就是导致`onCreateView()`被调用两次的原因！

请参阅`onNavigationItemSelected()`下面的实现。

```
public class MyActivity extends FragmentActivity implements ActionBar.OnNavigationListener
{
    private static final String STATE_SELECTED_NAVIGATION_ITEM = "selected_navigation_item";

    private boolean mIsUserInitiatedNavItemSelection;

    // ... constructor code, etc.

    @Override
    public void onRestoreInstanceState(Bundle savedInstanceState)
    {
        super.onRestoreInstanceState(savedInstanceState);

        if (savedInstanceState.containsKey(STATE_SELECTED_NAVIGATION_ITEM))
        {
            getActionBar().setSelectedNavigationItem(savedInstanceState.getInt(STATE_SELECTED_NAVIGATION_ITEM));
        }
    }

    @Override
    public void onSaveInstanceState(Bundle outState)
    {
        outState.putInt(STATE_SELECTED_NAVIGATION_ITEM, getActionBar().getSelectedNavigationIndex());

        super.onSaveInstanceState(outState);
    }

    @Override
    public boolean onNavigationItemSelected(int position, long id)
    {    
        Fragment fragment;
        switch (position)
        {
            // ... choose and construct fragment here
        }

        // is this the automatic (non-user initiated) call to onNavigationItemSelected()
        // that occurs when the activity is created/re-created?
        if (!mIsUserInitiatedNavItemSelection)
        {
            // all subsequent calls to onNavigationItemSelected() won't be automatic
            mIsUserInitiatedNavItemSelection = true;

            // has the same fragment already replaced the container and assumed its id?
            Fragment existingFragment = getSupportFragmentManager().findFragmentById(R.id.container);
            if (existingFragment != null && existingFragment.getClass().equals(fragment.getClass()))
            {
                return true; //nothing to do, because the fragment is already there 
            }
        }

        getSupportFragmentManager().beginTransaction().replace(R.id.container, fragment).commit();
        return true;
    }
} 
```

[我从这里](https://stackoverflow.com/a/9696739/963396)借鉴了这个解决方案的灵感。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-06-11T16:57:50.947

在我看来，这是因为您每次都在实例化您的 TabListener ......所以系统正在从 savedInstanceState 重新创建您的片段，然后您在 onCreate 中再次执行此操作。

您应该将其包装在 a 中，`if(savedInstanceState == null)`以便仅在没有 savedInstanceState 时才会触发。

# node.js - 尝试重新连接显式断开的 socket.io 套接字

> ID：10983407
> 
> 赞同：1
> 
> 时间：2012-06-11T15:45:41.590
> 
> 标签：node.js, tcp, websocket, protocols, socket.io

在客户端调用后`socket.disconnect()`，我尝试重新连接该客户端，`io.connect("http://localhost:8000")`但似乎没有创建套接字。这可以在没有页面刷新的情况下完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T15:50:01.190

如果您有一个使用类似的东西创建的套接字

```
var connection = io.connect(); 
```

在您的客户端 JS 中，您可以通过重新连接

```
connection.socket.connect(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T17:30:56.453

一个典型的用例是

```
var socket;
var firstconnect = true;

function connect() {
  if(firstconnect) {
    socket = io.connect();
    ... do something else

    firstconnect = false;
  }
  else {
    socket.socket.reconnect();
  } 
```

# c++ - 使用 saveFileDialog (C++) 保存 txt 文件

> ID：10983411
> 
> 赞同：0
> 
> 时间：2012-06-11T15:45:53.623
> 
> 标签：c++, iostream, savefiledialog

我无法使用“saveFileDialog”保存文本文件。我查看了许多论坛和教程，但我都无法从中获得正确的信息。到目前为止，我已经设法打开“保存文件”对话框，它实际上保存了一个具有正确名称和路径的空文本文件，但是，这是我遇到问题的部分，它是空的，我不知道你在哪里显示什么信息保存文件和使用什么方法！

这是代码：

```
private: System::Void button3_Click(System::Object^  sender, System::EventArgs^  e) {
         saveFileDialog1->ShowDialog();
     }
private: System::Void saveFileDialog1_FileOk(System::Object^  sender, System::ComponentModel::CancelEventArgs^  e) {
         System::IO::FileStream ^ fs = safe_cast<System::IO::FileStream^>(saveFileDialog1->OpenFile());
         } 
```

那么有人可以告诉我如何以及该怎么做吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:54:00.090

您使用保存文件对话框来获取保存文件的路径。所以基本上你需要

```
saveFileDialog.showDialog();
String filename = saveFileDialog.FileName;
System.IO.StreamWriter file = new System.IO.StreamWriter(filename)

file.writeLine("This is a test");
file.close(); 
```

这只是一个简单的例子：D

# c++ - 如何更新终端中的输出字段而不输出新行？

> ID：10983414
> 
> 赞同：22
> 
> 时间：2012-06-11T15:45:56.923
> 
> 标签：c++, shell, terminal

> **可能重复：**
> [如何在不重新打印的情况下更新终端中的打印消息（Linux）](https://stackoverflow.com/questions/1337529/how-to-update-a-printed-message-in-terminal-without-reprinting-linux)

我有 c++ 代码，执行一些模拟。

我想显示我的模拟百分比，但我不想每一步都输出一个新行，比如

%1

%2

%3

...

有没有办法在 c++ 或 shell 脚本中显示进度而不创建新行？

谢谢

## 编辑 1

有人知道如何在不刷新整个页面的情况下更新我的个人网页上的号码吗？

谢谢

## 编辑 2

```
double N=0;
forAll (internalIDs_, i) {
    N++;
    double percent = 100*N/internalIDs_.size();
    // Info<< "\rProgress: " << percent << "%" << endl;
    printf("\r[%6.4f%%]",percent);} 
```

终端光标一直在数字循环闪烁，很烦人，如何摆脱这个？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-11T15:48:48.593

用于此的技巧是返回到当前行的第一个位置，而不是前进到下一行。

这是通过将`\r`字符（回车）写入终端/标准输出来完成的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-06-11T15:53:58.423

```
cout << "\r%1";
cout << "\r%2";
cout << "\r%3"; 
```

...

\r - 在行首移动；

但！如果 ：

```
cout << "\rsomelongmessage";
cout << "\rshort"; 
```

然后你出去：

```
shortongmessage 
```

因为：

```
somelongmessage
^^^^^
short 
```

但是你可以：

```
cout << "\rsomelongmessage";
cout << "\rshort          "; 
```

然后你最终得到：

```
short 
```

# javascript - jQuery 和 Javascript - 检测 iPad 键盘何时关闭

> ID：10983417
> 
> 赞同：1
> 
> 时间：2012-06-11T15:46:11.213
> 
> 标签：javascript, ipad

如果有一个在用户单击文本字段外部时触发的事件，这也会自动隐藏 iPad 键盘。

但是，当用户从键盘本身上检测到的按钮关闭键盘时，我也想触发此功能，因此当用户完成编辑时可以达到相同的效果。

是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:57:47.393

正如安德烈正确评论的那样，这实际上是通过 完成的`onblur`，并且工作得很好。

# java - Multipart/form - 从复选框创建一个字符串并发送到数据库

> ID：10983418
> 
> 赞同：0
> 
> 时间：2012-06-11T15:46:16.557
> 
> 标签：java, forms, jsp, checkbox, multipart

我有一个 multipart/form-data 表单，其中包含文件上传部分和其他字段，例如复选框。我想根据复选框中的信息创建一个字符串，用“;”分隔 以便将其发送到数据库。

我的 UploadServlet 看起来像这样：

```
try {
        // parses the request's content to extract file data
        List formItems = upload.parseRequest(request);
        Iterator iter = formItems.iterator();

        // iterates over form's fields
        while (iter.hasNext()) {

            FileItem item = (FileItem) iter.next();
            // processes only fields that are not form fields
            if (!item.isFormField()) {

                                    //doSomething 

                String fileName = new File(item.getName()).getName();
                String filePath = uploadPath + File.separator + fileName;
                File storeFile = new File(filePath);    

                // saves the file on disk
                item.write(storeFile);

            }
            else
            {

            // Process regular form field (input type="text|radio|checkbox|etc", select, etc).
                String fieldname = item.getFieldName();
                String fieldvalue = item.getString();
                // Do anotherThing

               // Can I create a string from the checkbox inputs here?

            } 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:50:52.160

对于 Apache Commons FileUpload，您提交的多部分表单中的每个 HTML 元素始终有一个项目。

因此，如果您有多个具有相同名称的复选框，您将获得多个具有相同字段名称的项目。换句话说，对于许多复选框，您会发现许多项具有相同的字段名称，但具有不同的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:22:55.627

您需要自己收集多个具有相同名称的字段。假设这些复选框的输入字段名称是`checkboxName`，这是一个启动示例：

```
List<String> checkboxValues = new ArrayList<String>(); 

// ... while looping over all items.

String fieldname = item.getFieldName();
String fieldvalue = item.getString();

if ("checkboxName".equals(fieldname)) {
    checkboxValues.add(fieldvalue);
}

// ... after looping over all items.

StringBuilder builder = new StringBuilder();

for (String checkboxValue : checkboxValues) {
    if (builder.length() > 0) builder.append(";");
    builder.append(checkboxValue);
}

String semicolonSeparatedCheckboxValues = builder.toString();
// Save in DB. By the way, why not just using a separate table with a FK?
// Storing multiple values delimited in a single DB column is a bad practice. 
```

# php - 将数组的值回显到 jQuery

> ID：10983423
> 
> 赞同：0
> 
> 时间：2012-06-11T15:46:31.290
> 
> 标签：php, javascript, jquery, flot

所以我使用 FLOT 来生成一些条形图，它使用一些 javascript 数组来允许数据。我有一个查询，它会吐出正确的标签和值，如下所示：

```
while ($row = mysql_fetch_array($chart_stats)){

printf("Race is: %s Percentage: %s", $row['Race'],$row['Percentage'] ."<br/>"); 
```

}

我的问题是我可以将我的数组的值从 php 获取到 Javascript 的数组中（如果有意义的话）

```
 var d1 =[0, 72]; //instead of static value maybe var d1 = [0,<?printf($row['Percentage'])?>];
    var d2 =[1,3];
    var d3 = [2,40]; 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:50:08.163

是的，你可以`echo`在任何你喜欢的地方使用 PHP。但是，在将其放入 JavaScript 块时，您必须注意：

*   结果输出始终是有效代码
*   无法将用户生成的输入放入代码中并运行

第二个很简单：永远不要把你得到的任何东西`$_POST`放入`<script>`标签中。

至于第一个，[`json_encode`](http://php.net/json-encode)是很大的帮助。有了它，您几乎可以将任何类型的 PHP 变量输出为有效的 JavaScript 变量。

# ruby-on-rails-3 - 使用 Jbuilder 和 Rails 3 提高渲染性能

> ID：10983424
> 
> 赞同：10
> 
> 时间：2012-06-11T15:46:33.677
> 
> 标签：ruby-on-rails-3, json, performance, rendering

我正在开发的应用程序使用 JSON 对象或其集合响应大多数请求。我们正在使用[Jbuilder](https://github.com/rails/jbuilder)来构建这些响应。呈现的数据量相当大（各种嵌套结构中的数千个对象 - 一旦格式化并完全展开，典型响应就有多达 10,000 行 JSON）。根据 NewRelic 的说法，这种渲染需要大量时间——大约是总请求时间的 1/3。

我正在寻找某种指南、一组技巧或其他资源，以帮助我确保从 JBuilder 中获得最佳性能。我也很好奇是否有 Jbuilder 与[RABL](https://github.com/nesquena/rabl)或其他类似工具的性能比较。

编辑：我发现了一个抱怨 Jbuilder 性能的[GitHub 问题，但任何人提出的唯一实际建议是“不要使用 Jbuilder”。](https://github.com/rails/jbuilder/issues/45)好吧，实际上，他们使用了稍微强一些的语言，但是仍然没有关于Jbuilder*为何*如此缓慢的消息，如果有的话，可以做些什么来绕过它，或者对于相同任务的其他工具如何比较。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-14T16:22:45.130

jbuilder 构建一个包含您的数据的大哈希，然后`ActiveSupport::JSON`将其转换为 json。如下微基准测试所示，有更快的 json 发射器（确保您安装了 multijson 和 yajl-ruby gem）

```
require 'benchmark'
require 'active_support'
require 'multi_json'
sample = {menu: {
    header: "SVG Viewer",
    items: [
        {id: "Open"},
        {id: "OpenNew", label: "Open New"},
        nil,
        {id: "ZoomIn", label: "Zoom In"},
        {id: "ZoomOut", label: "Zoom Out"},
        {id: "OriginalView", label: "Original View"},
        nil,
        {id: "Quality"},
        {id: "Pause"},
        {id: "Mute"},
        nil,
        {id: "Find", label: "Find..."},
        {id: "FindAgain", label: "Find Again"},
        {id: "Copy"},
        {id: "CopyAgain", label: "Copy Again"},
        {id: "CopySVG", label: "Copy SVG"},
        {id: "ViewSVG", label: "View SVG"},
        {id: "ViewSource", label: "View Source"},
        {id: "SaveAs", label: "Save As"},
        nil,
        {id: "Help"},
        {id: "About", label: "About Adobe CVG Viewer..."}
    ]
}}

MultiJson.engine = :yajl
Benchmark.bmbm(5) do |x|
  x.report 'activesupport' do
    1000.times {ActiveSupport::JSON.encode(sample)}
  end
  x.report 'yajl' do
    1000.times {MultiJson.encode(sample)}
  end
end 
```

在我的机器上，这会产生

```
 user     system      total        real
activesupport   1.050000   0.010000   1.060000 (  1.068426)
yajl            0.020000   0.000000   0.020000 (  0.021169) 
```

即对样本对象进行 1000 次编码，主动支持花费了 1 秒多的时间，MultiJson（使用 yajl 引擎）花费了 21 毫秒。

JBuilder 被硬编码为使用 ActiveSupport::JSON，但是 MultiJSON（一个允许您在 json 库之间切换的 gem）是一个微不足道的插件，并且已经是 ActiveSupport 的依赖项 - 请参阅我[的 jbuilder 的分支](https://github.com/fcheung/jbuilder/)。我已经打开了一个拉取请求，但在那之前你可以尝试使用这个 fork（或创建你自己的 - 这是一个单行更改）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T11:26:17.190

考虑切换到 Rabl 并添加一些[缓存](https://github.com/nesquena/rabl/wiki/Caching-in-RABL)。鉴于嵌套结构中有数千个对象，生成的 JSON 的某些节点可以呈现为部分并缓存 - 性能提升可能是巨大的。

除此之外，Rabl 的性能略好于 JBuilder 的性能，但我发现 Rabl 语法有时令人困惑，一旦它实现了片段缓存，我就会切换到 JBuilder。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-02T23:23:11.873

如前所述，[JBuilder](https://github.com/rails/jbuilder)构建一个散列，然后将该散列序列化为 JSON。

与缓存相同，有主散列，缓存的散列合并到仍需要转换为 JSON 的主散列中。

我的解决方案是[TurboStreamer](https://github.com/malomalo/turbostreamer)。TurboStreamer 直接输出到 IO/Stream/String，因此跳过了 JBuilder 的序列化步骤（乍一看，这仍然适用于[Rabl](https://github.com/nesquena/rabl)和 to_json ，具体取决于使用情况）。

对我们来说，这显着减少了渲染时间和 GC 时间（由于在 jbuilder 中构建哈希），并允许我们在获得结果时开始将 JSON 流式传输到客户端。缺点是 TurboStreamer 更加冗长和明确。

性能测试 A（不涉及缓存）：

*   [来源](https://gist.github.com/rolftimmermans/3638182)
*   [结果](https://user-images.githubusercontent.com/1018543/33420617-3e3f59b6-d5ea-11e7-991e-68a87d237aa4.png)

性能测试 B（主要是所有缓存）：

*   [来源](https://gist.github.com/dirk/4048df31641f5dab1c67)
*   [结果](https://user-images.githubusercontent.com/1018543/33420610-38f10068-d5ea-11e7-80fe-971180272fec.png)

# matlab - Matlab：两个时间序列数据集的总和？

> ID：10983426
> 
> 赞同：0
> 
> 时间：2012-06-11T15:46:35.283
> 
> 标签：matlab, join, matrix, time-series

当两个时间序列数据集都有基于 YEAR 和 DOY 的观察时，我喜欢总结它们的观察。当任一数据集为 0 时，我也喜欢跳过总和，并且只对 DOY 中的最大观察值求和。

下面是示例：data_1 和 data_2。

### 数据_1

```
% YEAR  DOY  OBS_1

1994    109 0.42
1994    110 0.73    
1994    111 0.69    
1994    113 0.8    
1994    114 0.43    
1994    115 0.75    
1994    123 0.6    
1994    127 0.2    
1994    131 0.44    
1994    131 0.43    
1994    131 0.63    
1994    132 0.99    
1994    132 0.51    
1994    133 0.71    
1994    133 0.99    
1994    134 0.65    
1994    134 0.69    
1994    134 0.97    
1994    134 0.03    
1994    134 0    
1994    134 0    
1994    135 0.68    
1994    135 0.72    
1994    136 1.22    
1994    136 0    
1994    136 0    
1994    136 1.28    
1994    136 1.34 
```

### 数据_2：

```
% YEAR  DOY  OBS_2    
1994    110 0.92    
1994    111 0.34    
1994    113 0.42    
1994    114 0.37    
1994    115 0.38    
1994    122 0.22    
1994    127 0.32    
1994    131 0.34   
1994    131 0.2    
1994    132 0.51    
1994    132 0.43
1994    132 0.4    
1994    133 0.4    
1994    134 0.32    
1994    134 0.39    
1994    135 0.35    
1994    135 0.38    
1994    135 0.34    
1994    135 1.83    
1994    135 0.22    
1994    135 0.36    
1994    135 0.39    
1994    135 0.24    
1994    135 0.39    
1994    136 0.42    
1994    136 0.29    
1994    136 0.3    
1994    136 0.4    
1994    136 0.54    
1994    136 0.4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:49:01.747

这是第一次尝试：

```
%# maximum day of year
sz = max(max(data_1(:,2)),max(data_2(:,2)));
doy = (1:sz)';

%# get max value for each DOY in each dataset
v1 = accumarray(data_1(:,2), data_1(:,3), [sz 1], @max);
v2 = accumarray(data_2(:,2), data_2(:,3), [sz 1], @max);

%# compute the sum
v = v1 + v2;

%# keep entries where none of the values were zeros
idx = (v1~=0 & v2~=0);
v = [doy(idx(:)) v(idx(:))]; 
```

结果：

```
>> v
v =
          110         1.65
          111         1.03
          113         1.22
          114          0.8
          115         1.13
          127         0.52
          131         0.97
          132          1.5
          133         1.39
          134         1.36
          135         2.55
          136         1.88 
```

我没有考虑该`year`字段，因为它`1994`涵盖了您的所有数据...

# objective-c - 如何更改 iOS 5 平台的导航栏颜色？

> ID：10983429
> 
> 赞同：0
> 
> 时间：2012-06-11T15:46:42.413
> 
> 标签：objective-c, ios5, uinavigationcontroller

我在更改 XCode 4.3.2 中 iOS 5 平台的导航栏背景时遇到了一些麻烦。我更喜欢不将背景设置为图像。有人可以发布如何执行此操作以及如何为整个应用程序更改它吗？我想把它改成浅蓝色。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:59:29.960

在`application:DidFinishLaunchingWithOptions:`您的应用程序委托中，添加以下内容：

```
[[UINavigationBar appearance] setTintColor:[UIColor blueColor]]; 
```

替换你最喜欢的颜色。有关您可以调整的更多内容，请参阅[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationBar_Class/Reference/UINavigationBar.html)。这会更改应用程序中所有导航栏的外观。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:55:26.320

查看 iOS 5 的[UIAppearance](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html)协议。它仅适用于 iOS 5，但为您提供了自定义大量 UIKit 元素的非常好的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:00:02.777

您可以使用 tintColor 属性。

# google-maps - 如何在谷歌地图静态 API 中抓取相邻的地图图像

> ID：10983433
> 
> 赞同：1
> 
> 时间：2012-06-11T15:46:48.157
> 
> 标签：google-maps, google-maps-api-3

我正在使用 Google Maps 静态 API 来检索图像。我正在尝试找出一种方法来获取直接位于北方的图像，如果它是地图，则基本上是下一个图块。我知道它将基于缩放，但我真的不知道从哪里开始。有什么建议么？

# c - Graph的C结构，帮助理解结构

> ID：10983441
> 
> 赞同：1
> 
> 时间：2012-06-11T15:47:27.410
> 
> 标签：c, graph

我正在尝试在 C 中创建一个数据结构来表示图形。我发现这个非常有用的链接：

[http://pine.cs.yale.edu/pinewiki/C/Graphs](http://pine.cs.yale.edu/pinewiki/C/Graphs)

在我看来，这是一个很好的起点。但是我在理解数据结构时遇到了一些问题。

```
struct graph {
    int n;              /* number of vertices */
    int m;              /* number of edges */
    struct successors {
        int d;          /* number of successors */
        int len;        /* number of slots in array */
        char is_sorted; /* true if list is already sorted */
        int list[1];    /* actual list of successors */
    } *alist[1];
}; 
```

我不明白为什么结构后继者按原样声明而不是以这种方式声明：

```
struct graph {
    int n;              /* number of vertices */
    int m;              /* number of edges */
    struct successors {
        int d;          /* number of successors */
        int len;        /* number of slots in array */
        char is_sorted; /* true if list is already sorted */
        int *list;    /* actual list of successors */
    } *alist;
}; 
```

正如我在创建图表的后续函数中看到的那样：

```
Graph
graph_create(int n)
{
    Graph g;
    int i;

    g = malloc(sizeof(struct graph) + sizeof(struct successors *) * (n-1));
    assert(g);

    g->n = n;
    g->m = 0;

    for(i = 0; i < n; i++) {
        g->alist[i] = malloc(sizeof(struct successors));
        assert(g->alist[i]);

        g->alist[i]->d = 0;
        g->alist[i]->len = 1;
        g->alist[i]->is_sorted= 1;
    }

    return g;
} 
```

它为 alist 分配了更多空间，我不明白为什么将其声明为 alist[1]。你能解释一下这是如何工作的吗？

我希望这个问题很清楚，因为我自己也很困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:55:11.170

```
 struct successors {
     /*
     */
     int list[1];    /* actual list of successors */
 } *alist[1]; 
```

对成员使用双重间接（每个指针 op `*`/`&`和下标运算符`[]`是一个间接级别，并且需要额外的内存访问）`alist`以使每个索引都可以`malloc`'d。

```
struct successors {
     /*
     */
    int *list;    /* actual list of successors */
} *alist; 
```

才不是。

另外，从您的链接：

```
 /* basic directed graph type */
 typedef struct graph *Graph; 
```

该链接有很多代码。

我不完全理解如何`->list`使用，但你的方法只保留空间，`int *`而原始保留指针和目标`int`。

的分配

```
g = malloc(sizeof(struct graph) + sizeof(struct successors *) * (n-1)); 
```

只有 allocs 才能`successors *`使每个`successors`对象（理论上）可以粗略地扩展为指向 more `int`。

# git - 如何将 Accurev 导出到另一个 VCS？

> ID：10983442
> 
> 赞同：9
> 
> 时间：2012-06-11T15:47:28.457
> 
> 标签：git, mercurial, accurev

有谁知道将Accurev“仓库”及其*完整历史*导出到例如git或mercurial的简单方法？或者甚至通过第 3 方系统？除非我错过了明显的东西，否则我无法通过谷歌找到任何东西。

如果没有，一个额外的问题，是否可以基于具有特定时间戳的补丁构建一个 git/mercurial 存储库？换句话说，只需让 accurev 将其历史记录转储为一组补丁并将它们导入存储库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T14:50:30.410

*@jtalbott 关于将 AccuRev 仓库的历史完全*转换为另一个 SCM（包括 git）的难度绝对是正确的。但是，如果您愿意接受转换单个流（无论是您的仓库的“根”流还是您决定用作转换基础的任何其他流），请查看[https://github.com/rlaneve /accurev2git/](https://github.com/rlaneve/accurev2git/)。请注意，这是一个非常*非常*幼稚的实现，对于任何大型软件仓库都将花费相当多的时间，并且会在转换过程中过度破坏您的硬盘驱动器。但是，它确实有效，而且我已经使用它来将至少几十个 AccuRev 软件仓库转换为 git 存储库。

免责声明：几年前我写了这个工具，因为我找不到现有的工具。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-03T00:45:41.533

查看[ac2git](https://github.com/orao/ac2git)，这是一个比[ryan-laneve](https://stackoverflow.com/users/492317/ryan-laneve)的[accurev2git](https://github.com/rlaneve/accurev2git/)功能更全面的 Python 转换工具，尽管我们相信他的原始概念。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T16:21:19.550

迁移到另一个工具的最佳选择是从流（或快照）中提取并导入另一个工具。您不会有事务性注释、日志等，但您将能够以这种方式建立历史记录，并保留 AccuRev，以防您需要检查未专门迁移的内容。

AccuRev 的 Timesafe 架构保证您可以使用必要的历史记录，但就像迁移*到*AccuRev 传统上是通过基线导入完成的一样，我怀疑您进行反向操作的成本/收益比不会导致完整的历史记录作为选项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T16:01:00.653

由于 AccuRev 范式不同于传统的分支和标签工具，因此将完整历史记录从 AccuRev 库导出到任何其他工具将是一项挑战。数据当然可以从 AccuRev 获取，但您必须编写一个全面的、符合逻辑的提取例程才能将其拉入另一个系统。任何其他人所做的任何事情都可能非常适合他们的特定需求。使用来自 AccuRev 流的时间点配置的基线导出将更加可行和直接。

请问最终目的是什么？是完全从 AccuRev 迁移，还是您只是希望能够让用户或团队使用 Git 作为客户端而不是 AccuRev？我提出这个是因为 AccuRev 最近刚刚推出了一个完整的 Git 集成平台，称为 Kando。你可以自己阅读它，但它可能是你正在寻找的。

问候，〜詹姆斯

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-08-04T15:01:34.780

AC2GIT 转换是我见过的从 accurev 到 git 迁移的最佳转换工具之一。非常稳定 [https://github.com/orao/ac2git](https://github.com/orao/ac2git)

# php - 如何将数据放入数组？

> ID：10983449
> 
> 赞同：-1
> 
> 时间：2012-06-11T15:47:52.133
> 
> 标签：php

我有一个字段格式：

```
{"2G Network":"GSM 850","3G Network":"HSDPA 850"} 
```

如何以格式将数据放入数组中：

```
array(["2G Network"]=>"GSM 850", ["3G Network"]=>"HSDPA 850"); 
```

这个想法如何

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T15:50:56.877

```
$data = '{"2G Network":"GSM 850","3G Network":"HSDPA 850"}';

$myArray = json_decode( $data, true ); //true to make it associative array 
```

[http://php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T15:50:46.130

你想用[`json_decode()`](http://www.php.net/manual/en/function.json-decode.php)

```
$json = '{"a":1,"b":2,"c":3,"d":4,"e":5}';

var_dump(json_decode($json, true));

array(5) {
    ["a"] => int(1)
    ["b"] => int(2)
    ["c"] => int(3)
    ["d"] => int(4)
    ["e"] => int(5)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:59:31.583

```
$text = '{"2G Network":"GSM 850","3G Network":"HSDPA 850"}';
$myArray = json_decode($text, true); 
```

采用：

```
echo $myArray['2G Network']; 
```

# magento - Magento - 自定义模型

> ID：10983453
> 
> 赞同：0
> 
> 时间：2012-06-11T15:48:04.800
> 
> 标签：magento, magento-1.4, magento-1.5, magento-1.6

我正在使用免费的 magento 扩展（WebForms）来进行自定义调查，所以我已经安装并修改了它。扩展的模型不使用 EAV，有涉及的表：

```
| webforms                                    |
| webforms_fields                             |
| webforms_fieldsets                          |
| webforms_results                            |
| webforms_results_values                     | 
```

我添加了三个自定义属性：rating (int) 到 webforms_results_values，is_customer_survey (tinyint) 到 webforms，view_on_frontend (tinyint) 到 webforms_results。该模块的Models有：Webforms（映射webforms）、Fields（映射webforms_fields）、Fieldsets（映射webforms_fieldsets）、Results（映射webforms_results）。现在 webforms_results_values 没有映射到模型上，我需要轻松地操作我的自定义属性，所以我做了以下更改：

//在 WebForms/Model 上添加了一个名为 Results 的目录，并在其中添加了一个文件 Values.php (app/code/local/Custom/WebForms/Model/Results/Values.php class Custom_WebForms_Model_Results_Values extends Mage_Core_Model_Abstract { public function _construct() { parent: :_construct(); $this->_init('webforms/results_values'); } }

```
//added two files in app/code/local/Custom/WebForms/Model/Mysql4:
//app/code/local/Custom/WebForms/Model/Mysql4/Results/Values.php
class Custom_WebForms_Model_Mysql4_Results_Values
extends Mage_Core_Model_Mysql4_Abstract
{
    public function _construct(){
        $this->_init('webforms/results_values','id');
    }

}  

//app/code/local/Custom/WebForms/Model/Mysql4/Results/Values/Collection.php
class Custom_WebForms_Model_Mysql4_Results_Values_Collection
extends Mage_Core_Model_Mysql4_Collection_Abstract
{

    public function _construct(){
        parent::_construct();
        $this->_init('webforms/results_values');
    }
} 
```

然后我修改了 etc/config.xml 的部分：

```
 <models>
        <webforms>
            <class>Custom_WebForms_Model</class>
            <resourceModel>webforms_mysql4</resourceModel>
        </webforms>
        <results>
            <class>Custom_WebForms_Model</class>
            <resourceModel>webforms_mysql4</resourceModel>
        </results>
        <fields>
            <class>Custom_WebForms_Model</class>
            <resourceModel>webforms_mysql4</resourceModel>
        </fields>
        <fieldsets>
            <class>Custom_WebForms_Model</class>
            <resourceModel>webforms_mysql4</resourceModel>
        </fieldsets>
                    <results_values>
                            <class>Custom_WebForms_Model</class>
                            <resourceModel>webforms_mysql4</resourceModel>
                    </results_values>
        <webforms_mysql4>
            <class>Custom_WebForms_Model_Mysql4</class>
            <entities>
                <webforms>
                    <table>webforms</table>
                </webforms>
                <fields>
                    <table>webforms_fields</table>
                </fields>
                <fieldsets>
                    <table>webforms_fieldsets</table>
                </fieldsets>
                <results>
                    <table>webforms_results</table>
                </results>
                <results_values>
                    <table>webforms_results_values</table>
                </results_values>
            </entities>
        </webforms_mysql4>
    </models> 
```

现在有了这些更改，我可以使用 save() 在 'webforms/results_values' 模型上编写和保存评分，当我使用 Mage::getModel('webforms/results_values') 检索该模型的集合时，没有任何痕迹新属性（所有 previos 属性都存在，但不是新属性）。它是与 Collection.php 还是其他东西有关？有什么帮助解决这个问题吗？

谢谢！卢克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T09:20:07.127

Try to remove var/cache folder.
Magento caches table description. So if you have added fields right, magento has no idea if they exist.

# python - 如何从 Music21 制作的音乐中生成实时音频输出？

> ID：10983462
> 
> 赞同：6
> 
> 时间：2012-06-11T15:48:24.233
> 
> 标签：python, music21, audio

如何从 Music21 制作的音乐中生成实时音频输出。如果做不到这一点，我如何通过开源软件从 Music21 制作的音乐中产生任何音频输出？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-27T05:34:28.860

如您所见，music21 并非旨在成为音乐播放系统，但它旨在嵌入其他播放系统或从系统内调用它们。我们不打算在播放系统上投入太多工作（因为硬件支持，我们是一个小型研究实验室，音乐分析方面的工作仍需完成等），但您的解决方案非常优雅，以至于现在作为music21.midi.realtime 模块包含在所有版本的music21（v1.1 后）中。下面是一个例子，它利用了 music21 动态分配具有不同弯音对象的 midi 通道以模拟微音播放（大多数 midi 播放的主要问题）的能力：

```
#  Set up a detuned piano 
#  (where each key has a random 
#  but consistent detuning from 30 cents flat to sharp)
#  and play a Bach Chorale on it in real time.

from music21 import *
import random
keyDetune = []
for i in range(0, 127):
    keyDetune.append(random.randint(-30, 30))

b = corpus.parse('bach/bwv66.6')
for n in b.flat.notes:
    n.microtone = keyDetune[n.midi]
sp = midi.realtime.StreamPlayer(b)
sp.play() 
```

StreamPlayer 的 .play() 函数还可以采用 busyFunction 和 busyArgs 和 busyWaitMilliseconds 参数，它们指定一个函数，最多在每个 busyWaitMilliseconds 调用一个函数（如果您的系统较慢，可能会更多）。最后还有一个 endFunction 和 endArgs 将被调用，以防您想设置某种线程播放。——Myke *Cuthbert（Music21 创作者）*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-12T19:44:28.263

所以这就是我发现的。这是一个适用于 Windows XP 的 python 脚本。除了music21，它还需要pygame。

```
# genPlayM21Score.py Generates and Plays 2 Music21 Scores "on the fly".
#
# see way below for source notes

from music21 import *

# we create the music21 Bottom Part, and do this explicitly, one object at a time.

n1 = note.Note('e4')
n1.duration.type = 'whole'
n2 = note.Note('d4')
n2.duration.type = 'whole'
m1 = stream.Measure()
m2 = stream.Measure()
m1.append(n1)
m2.append(n2)
partLower = stream.Part()
partLower.append(m1)
partLower.append(m2)

# For the music21 Upper Part, we automate the note creation procedure

data1 = [('g4', 'quarter'), ('a4', 'quarter'), ('b4', 'quarter'), ('c#5', 'quarter')]
data2 = [('d5', 'whole')]
data = [data1, data2]
partUpper = stream.Part()

def makeUpperPart(data):
    for mData in data:
        m = stream.Measure()
        for pitchName, durType in mData:
            n = note.Note(pitchName)
            n.duration.type = durType
            m.append(n)
        partUpper.append(m)
makeUpperPart(data)        

# Now, we can add both Part objects into a music21 Score object.  

sCadence = stream.Score()
sCadence.insert(0, partUpper)
sCadence.insert(0, partLower)

# Now, let's play the MIDI of the sCadence Score [from memory, ie no file  write necessary] using pygame

import cStringIO

# for music21 <= v.1.2:
if hasattr(sCadence, 'midiFile'):
   sCadence_mf = sCadence.midiFile
else: # for >= v.1.3:
   sCadence_mf = midi.translate.streamToMidiFile(sCadence)
sCadence_mStr = sCadence_mf.writestr()
sCadence_mStrFile = cStringIO.StringIO(sCadence_mStr)

import pygame

freq = 44100    # audio CD quality
bitsize = -16   # unsigned 16 bit
channels = 2    # 1 is mono, 2 is stereo
buffer = 1024    # number of samples
pygame.mixer.init(freq, bitsize, channels, buffer)

# optional volume 0 to 1.0
pygame.mixer.music.set_volume(0.8)

def play_music(music_file):
    """
    stream music with mixer.music module in blocking manner
    this will stream the sound from disk while playing
    """
    clock = pygame.time.Clock()
    try:
        pygame.mixer.music.load(music_file)
        print "Music file %s loaded!" % music_file
    except pygame.error:
        print "File %s not found! (%s)" % (music_file, pygame.get_error())
        return
    pygame.mixer.music.play()
    while pygame.mixer.music.get_busy():
        # check if playback has finished
        clock.tick(30)

# play the midi file we just saved
play_music(sCadence_mStrFile)

#============================

# now let's make a new music21 Score by reversing the upperPart notes
data1.reverse()
data2 = [('d5', 'whole')]
data = [data1, data2]
partUpper = stream.Part()
makeUpperPart(data)        
sCadence2 = stream.Score()
sCadence2.insert(0, partUpper)
sCadence2.insert(0, partLower)

# now let's play the new Score
sCadence2_mf = sCadence2.midiFile
sCadence2_mStr = sCadence2_mf.writestr()
sCadence2_mStrFile = cStringIO.StringIO(sCadence2_mStr)
play_music(sCadence2_mStrFile)

## SOURCE NOTES
## There are 3 sources for this mashup:

# 1\. Source for the Music21 Score Creation http://web.mit.edu/music21/doc/html/quickStart.html#creating-notes-measures-parts-and-scores

# 2\.  Source for the Music21 MidiFile Class Behaviour http://mit.edu/music21/doc/html/moduleMidiBase.html?highlight=midifile#music21.midi.base.MidiFile

# 3\.  Source for the pygame player: http://www.daniweb.com/software-development/python/code/216979/embed-and-play-midi-music-in-your-code-python 
```

# ruby-on-rails-3 - 捆绑安装未在 gem 列表中找到 gem

> ID：10983465
> 
> 赞同：1
> 
> 时间：2012-06-11T15:48:35.863
> 
> 标签：ruby-on-rails-3, rubygems, gem, ruby-on-rails-3.2, bundle-install

我正在尝试将设计添加到我的应用程序和 gem install 工作，但是每次我运行捆绑安装时，它都没有在我的 gemlist 中找到设计。我已经尝试包含 git 链接并使用特定版本，但它仍然无法在我的 gemfile 中找到它。

**终端**
$bundle install `$Using rake (0.9.2.2) Using i18n (0.6.0) Using multi_json (1.3.6) Using activesupport (3.2.5) Using builder (3.0.0) Using activemodel (3.2.5) Using erubis (2.7.0) Using journey (1.0.3) Using rack (1.4.1) Using rack-cache (1.2) Using rack-test (0.6.1) Using hike (1.2.1) Using tilt (1.3.3) Using sprockets (2.1.3) Using actionpack (3.2.5) Using mime-types (1.18) Using polyglot (0.3.3) Using treetop (1.4.10) Using mail (2.4.4) Using actionmailer (3.2.5) Using arel (3.0.2) Using tzinfo (0.3.33) Using activerecord (3.2.5) Using activeresource (3.2.5) Using coffee-script-source (1.3.3) Using execjs (1.4.0) Using coffee-script (2.2.0) Using rack-ssl (1.3.2) Using json (1.7.3) Using rdoc (3.12) Using thor (0.15.2) Using railties (3.2.5) Using coffee-rails (3.2.2) Using jquery-rails (2.0.2) Using bundler (1.1.4) Using rails (3.2.5) Using sass (3.1.19) Using sass-rails (3.2.5) Using sqlite3 (1.3.6) Using uglifier (1.2.4) Your bundle is complete! Use`bundle show [gemname]`to see where a bundled gem is installed.`

**宝石文件**

```
source 'https://rubygems.org'

gem 'rails', '3.2.5'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

gem 'devise'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'debugger' 
```

# xml - SOAP 请求多个股票价格

> ID：10983467
> 
> 赞同：0
> 
> 时间：2012-06-11T15:48:39.437
> 
> 标签：xml, soap, wsdl, soapui

[我需要从GetStockQuote WSDL](http://www.webservicex.net/stockquote.asmx)中查找股票列表并将所有字段保存到数据库中。

现在我正在尝试编写将返回多只股票结果的 SOAP 消息。使用以下代码，我可以查找一只股票，但如何更改它以查找多只股票？例如，如果我想要 IBM、ALJ 和 AJG？我正在使用soapUI 来执行请求。

要求：

```
<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope"  xmlns:web="http://www.webserviceX.NET/">
   <soap:Header/>
   <soap:Body>
      <web:GetQuote>
     <web:symbol>'IBM'</web:symbol>
      </web:GetQuote>
   </soap:Body>
</soap:Envelope> 
```

回报：

```
<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   <soap:Body>
      <GetQuoteResponse xmlns="http://www.webserviceX.NET/">
         <GetQuoteResult><![CDATA[<StockQuotes><Stock><Symbol>IBM</Symbol>  <Last>194.1399</Last><Date>6/11/2012</Date><Time>11:08am</Time><Change>-1.0001</Change><Open>196.60</Open><High>196.70</High><Low>194.00</Low><Volume>1033982</Volume><MktCap>223.9B</MktCap><PreviousClose>195.14</PreviousClose><PercentageChange>-0.51%</PercentageChange><AnnRange>157.13 - 210.69</AnnRange><Earns>13.407</Earns><P-E>14.56</P-E><Name>International Bus</Name></Stock></StockQuotes>]]></GetQuoteResult>
      </GetQuoteResponse>
   </soap:Body>
</soap:Envelope> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T15:56:57.050

如您提供的页面所示，该特定 Web 服务对每个请求只有一个符号的函数调用。您将不得不发出多个 SOAP 请求。

# javascript - 如何在three.js中重新定向三角形面

> ID：10983473
> 
> 赞同：2
> 
> 时间：2012-06-11T15:49:01.137
> 
> 标签：javascript, webgl, three.js

***用更好的例子编辑***

我使用 Three.js 显示 MRI 胃图像的外壳；船体从外部文件加载为 vtk 格式。这是一个演示：[http](http://www.menne-biomed.de/uni/3d/alphahull.html) ://www.menne-biomed.de/uni/3d/alphahull.html ；使用空间来切换。

[这些是从体素计算出来的 alpha-hull，就像http://www.menne-biomed.de/uni/3d](http://www.menne-biomed.de/uni/3d)中显示的 three.js 一样。我喜欢这些图片。**感谢日志，杜布先生！**

示例 1-3 来自几乎空腹的情况；4-6 来自饱腹。

(1) 和 (4) 是单面的，以表明三角形在 vtk 文件中的方向不一致。

(2) 和 (5) 显示了使用 doubleSided 时产生的问题；丑陋的斑块最好在平坦的一侧看到，那里的胃在 MRI 边界处被切开。我看起来在双面上的照明不是对称的。

(3) 和 (6) 是我的解决方法：我使用 doubleSided=false，并复制了具有不同方向的多边形：例如，原始中的 1 2 3 增加了 1 3 2。

该解决方案对我来说很好，但我不确定是否有更简单的出路。

# magento - Magento：选择语言后重定向到同一页面？

> ID：10983475
> 
> 赞同：0
> 
> 时间：2012-06-11T15:49:16.400
> 
> 标签：magento, magento-1.4

当客户单击 Magento 电子商务网站中的语言图标/标志之一时，它将“例如”重定向到：`http://www.magento-site.com/?lang=en`更改为客户要求的语言，问题是当客户选择一种语言时，Magento 重定向客户在设置新语言后回到主页，这会导致客户失去他/她原来所在的页面，所以假设客户在`http://www.magento-site.com/customer/account/login`更改语言后他/她将在`http://www.magento-site.com/`“主页”不是他/她所在的页面“ `http://www.magento-site.com/customer/account/login`”，更改语言后如何将客户重定向到他/她所在的页面。

PS：我在 Magento 1.4 的配置中没有任何改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T21:17:09.357

```
$_lang->getCurrentUrl() 
```

在 app/design/frontend/base/default/template/page/switch/languages.phtml

但是，这是默认情况下发生的，所以听起来您在安装或自定义的某个地方出了问题。

[http://demo.magentocommerce.com/catalog/category/view/s/ebooks/id/37/?___store=default&___from_store=pl_PL](http://demo.magentocommerce.com/catalog/category/view/s/ebooks/id/37/?___store=default&___from_store=pl_PL)的示例

# php - Mp3 流/下载网站 - apache 服务器内存问题

> ID：10983482
> 
> 赞同：0
> 
> 时间：2012-06-11T15:49:50.033
> 
> 标签：php, apache, html, audio

我有一个网站，用户可以在其中上传 mp3 文件（uploadify），使用 html5 播放器（jplayer）流式传输它们并使用 php 脚本（www.zubrag.com/scripts/）下载它们。

当用户上传歌曲时，音频文件的路径保存在数据库中，我正在使用该数据来播放并显示歌曲的下载链接。我遇到的问题是，根据我的主机，这种方法在服务器上使用了大量内存，这是专用的。

脚本链接：http: [//pastebin.com/Vus8SRa7](http://pastebin.com/Vus8SRa7)

我应该如何正确处理脚本？找出问题的最佳方法是什么？关于清理代码的任何想法？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:58:51.607

我建议将您的文件存储在磁盘上（命名为随机的 [检查冲突！] 或顺序的，没有文件扩展名，并且在 doc 根目录之外），并且只将信息存储在您的数据库中。以这种方式从磁盘流式传输文件比从数据库结果中传输文件要容易得多。

当您从数据库结果中检索整个文件的内容时，该数据必须在内存中。 `readfile()`没有这个问题。如果您愿意，在将文件发送回客户端时使用标头返回原始文件名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:58:42.553

我建议您在将 MP3 的二进制数据写入 HTTP 输出时不要缓冲内容。这样您就可以节省大量的物理和虚拟内存使用量。

# eclipse - 日食非常不稳定

> ID：10983484
> 
> 赞同：0
> 
> 时间：2012-06-11T15:49:54.897
> 
> 标签：eclipse

我不断收到此错误

> VM java/lang/NoClassDefFoundError: java/lang/ref/FinalReference 初始化时出错

我的代码中没有主要方法，这是我之前收到它的唯一原因。为什么会出现这种情况。我不能给你看日志，因为它在加载任何代码之前就崩溃了。

我想知道今天是否添加了 Galaxy 标签。我使用了 android 版本 10 并构建了一个完整的软件，并且没有遇到任何问题。

# android - Android应用程序中的FPS测试

> ID：10983486
> 
> 赞同：10
> 
> 时间：2012-06-11T15:49:55.937
> 
> 标签：android, testing, frame-rate

android 应用程序开发人员如何为他们的应用程序测试 FPS（每秒帧数）？我说的是一般应用，不是游戏。

它可以在模拟器或手机上。

我一直在寻找这个，但还没有找到方法。如果任何开发人员能够阐明这一点，那就太好了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-12T10:51:29.200

正如 Guykun 和 kcoppock 所提到的，如果您只使用 View 小部件或 Canvas，您通常不会寻找 FPS 来确定视觉性能。

由于除了“不是游戏”之外你没有提到你在做什么，你可能想回顾一下 Android 是如何绘图的。

[http://developer.android.com/guide/topics/graphics/2d-graphics.html](http://developer.android.com/guide/topics/graphics/2d-graphics.html)

大多数性能问题来自于在 UI 线程上做的事情。使用严格模式查找问题。

[http://android-developers.blogspot.com/2010/12/new-gingerbread-api-strictmode.html](http://android-developers.blogspot.com/2010/12/new-gingerbread-api-strictmode.html)

还可以使用工具查找性能热点：

[https://developer.android.com/topic/performance](https://developer.android.com/topic/performance)

[https://developer.android.com/topic/performance/rendering/inspect-gpu-rendering](https://developer.android.com/topic/performance/rendering/inspect-gpu-rendering)

[https://developer.android.com/topic/performance/rendering/optimizing-view-hierarchies](https://developer.android.com/topic/performance/rendering/optimizing-view-hierarchies)

如果您想了解更多幕后情况的详细信息，请参阅 Google IO 会议，了解他们为硬件加速渲染所做的工作

[Google I/O 2011：加速 Android 渲染](http://www.youtube.com/watch?v=v9S5EO7CLjo)

Google 在 UI 性能方面做了额外的工作，并在 Youtube 上提供了 Google IO 会议：

[Google I/O 2012 - 黄油或更糟：平滑 Android UI 中的性能](http://www.youtube.com/watch?v=Q8m9sHdyXnE)

[Google I/O 2013 - Android 图形性能](https://youtu.be/vQZFaec9NpA)

[Android 性能：用户界面（Google I/O '17）](https://youtu.be/9HtTL_RO2wI)

[引出：Android 的呈现方式（Google I/O '18）](https://youtu.be/zdQRIYOST64)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-25T09:43:18.187

您可以使用[TinyDancer](https://github.com/brianPlummer/TinyDancer)

有关详细信息，请[在此处查看我的答案](https://stackoverflow.com/a/34989267/1116058)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-17T09:18:34.453

市场上有可以测量其他游戏 FPS 的应用程序。请以 GameBench 为例，它可以显示 FPS。

【免责声明】：我是GameBench的创始人之一。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-01-31T07:58:21.977

我使用[GameBench](https://play.google.com/store/apps/details?id=com.gamebench.metricscollector)对 Android 应用程序进行 FPS 分析（它不是游戏，我想在我的应用程序的动画开始运行时检查 FPS）。GameBench 捕获关键帧率 (FPS) 指标，这是 UX 流动性的最佳客观指标。

我的要求是在我的 android 应用程序的动画启动时验证 FPS 为 30FPS。

我已经通过 GameBench 工具提供的图表报告验证了以下内容，

*   动画开始时，FPS 从 0 FPS 变为 30FPS。
*   当动画结束时，FPS 从 30FPS 移动到 0 FPS

见截图。

[![在此处输入图像描述](../Images/25787a977bfae22ffb8b892ec8b91a2b.png)](https://i.stack.imgur.com/6KIo1.png)

要使用此工具，您必须安装一个 android 应用程序和一个桌面启动器。

1.  在您的安卓设备中安装 GameBench 应用程序。
2.  使用电子邮件地址注册 GameBench 并安装桌面应用程序。
3.  下载并安装 GameBench 桌面启动器。
4.  将设备与桌面连接。您可能会在设备上收到一个弹出窗口，要求您允许 USB 调试
5.  在 GameBench Android 应用程序中，您可以选择应用程序（我已经安装在平板电脑上）进行分析。
6.  然后您可以记录每秒帧数并生成报告（它也可在 Web 仪表板、FPS、屏幕截图、性能、电池等中获得）。

参考：

1.  [https://play.google.com/store/apps/details?id=com.gamebench.metricscollector](https://play.google.com/store/apps/details?id=com.gamebench.metricscollector)
2.  [https://www.gamebench.net/](https://www.gamebench.net/)
3.  [https://docs.gamebench.net/web-dashboard/getting-started](https://docs.gamebench.net/web-dashboard/getting-started)

作为旁注，

我也使用过[FPS Meter 应用程序](https://play.google.com/store/apps/details?id=com.ftpie.fpsmeter&hl=en)，但在我的情况下似乎不准确。当我在 android 应用程序中的动画启动时，得到 29FPS 到 31 FPS。预期 FPS 为 30FPS。

[https://play.google.com/store/apps/details?id=com.ftpie.fpsmeter&hl=en](https://play.google.com/store/apps/details?id=com.ftpie.fpsmeter&hl=en)

# python - 将变量从python实时传递到C的最佳方法

> ID：10983488
> 
> 赞同：0
> 
> 时间：2012-06-11T15:49:58.203
> 
> 标签：python, c, variables, media-player

我有一个用 C 语言创建的媒体播放器，它与我用 Python 编写的服务器一起运行。服务器接受命令来修改驻留在 SQLite 数据库中的播放列表。

一旦 python 代码更新了数据库（这发生在媒体播放器播放时的后台），它需要让播放器知道数据库中有一个新的播放列表，以便它可以开始播放新文件。

我打算在数据库中设置一个标志，玩家可以不断地轮询这个标志，但我认为这不是最好的方法。我能想到的所有选项都涉及媒体播放器不断检查某些内容。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:02:26.177

有很多方法可以做到这一点：

1.  Signals - 从 Python 向播放器发送 SIGUSR1 信号。
2.  套接字 - 播放器在某个端口上侦听，Python 在该端口上发送一些数据（在这种情况下，UDP 将是最简单的）。
3.  Fifo - `mkfifo`Linux 机器上有。以这种方式创建的文件类似于套接字。

我会推荐UDP套接字。它比信号简单、快速且更优雅。Python 代码大概只有 3 行代码。

示例 Python 代码：

```
sock = socket.socket()
sock.connect(('localhost', 9999))
sock.sendall('update')
sock.close() 
```

示例 C UDP 服务器： [http ://www.cs.ucsb.edu/~almeroth/classes/W01.176B/hw2/examples/udp-server.c](http://www.cs.ucsb.edu/~almeroth/classes/W01.176B/hw2/examples/udp-server.c)

# php - mysql自动将字符串转换为整数

> ID：10983499
> 
> 赞同：5
> 
> 时间：2012-06-11T15:50:17.503
> 
> 标签：php, mysql

我刚刚注意到，如果我执行这样的 MySQL 请求：

```
SELECT 1 FROM myTable WHERE id = 'asdf' 
```

然后字符串 'asdf' 被强制转换为`0`. 这意味着我有一条带有 id 的记录，`0`这将匹配。该`id` 字段的格式是`int(8).`

最好的方法是什么：

*   我需要检查（例如通过 PHP）我的值是否仅为数字？
*   有一种 MySQL 方法可以做到这一点吗？
*   我必须用 id 删除我的记录`0`吗？（坏的）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T15:56:39.400

只需编写您的查询，这样它们就不会像使用文本字段一样使用数字字段。

如果`id`是数字字段，那么您的`where`子句永远不会有用。是的，如果 MySQL 主动抱怨它会很好——但从根本上说，你不应该编写一开始就运行错误查询的代码。

该查询是如何进入您的系统的？该`'asdf'`部分是直接用户输入吗？您可以改用参数化 SQL 吗？

如果您真的*打算*查询数字字段，则应首先确保您的输入是数字。在调用代码中将文本转换为整数，*而不是*在数据库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T15:58:48.063

您必须首先通过 PHP 清理您的输入。

```
$id = 'asdf';
if(is_numeric($id)){
    $query("SELECT 1 FROM myTable WHERE id = $id");
}else{
    die("ID is not numeric");
} 
```

或者你可以这样做：

```
 SELECT 1 FROM myTable WHERE id = 'asdf' AND 'asdf' REGEXP '^-?[0-9]+$' 
```

这将导致正则表达式 = false，导致没有行返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T15:58:11.340

由于与正确类型绑定的 pdo 准备语句不会引发任何错误（除非[启用了 mysql 严格模式](http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html)），因此您唯一的选择是确保和控制 php 中的变量类型以“纠正”这些语言的许可性。

[感谢评论员]

# node.js - 如何在 node.js 中存储请求级变量？

> ID：10983500
> 
> 赞同：23
> 
> 时间：2012-06-11T15:50:18.723
> 
> 标签：node.js

对于只需要在单个请求期间可用的数据，应该将其存储在哪里？我正在 req 和 res 对象上创建新属性，因此我不必将该数据从函数传递到函数。

```
req.myNewValue = 'just for this request' 
```

进程对象是一个选项吗？还是在所有请求中全局共享？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2017-01-06T20:10:11.837

在 Express 4 中，最佳实践是将请求级别的变量存储在[res.locals](http://expressjs.com/en/api.html#res.locals)上。

> 一个对象，其中包含范围为请求的响应局部变量，因此仅可用于在该请求/响应周期（如果有）期间呈现的视图。否则，此属性与 app.locals 相同。
> 
> 此属性对于公开请求级信息（例如请求路径名、经过身份验证的用户、用户设置等）很有用。

```
app.use(function(req, res, next){
  res.locals.user = req.user;
  res.locals.authenticated = ! req.user.anonymous;
  next();
}); 
```

该`process`对象由所有请求共享，不应按请求使用。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-06-11T15:54:48.503

如果您正在谈论像这里一样传递的变量：

```
http.createServer(function (req, res) {
    req.myNewValue = 'just for this request';
    res.writeHead(200, {'Content-Type': 'text/plain'});
    res.end('Hello World\n');
}).listen(1337, '127.0.0.1'); 
```

那么你在做什么就很好了。`req`存储请求数据，您可以根据需要对其进行修改。如果您使用的是 Express 之类的框架，那么它也应该没问题（请记住，您可能会覆盖对象的一些内置属性`req`）。

如果通过“进程对象”您指的是全局变量`process`，那么绝对不是。这里的数据是全局的，根本不应该修改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-30T12:05:19.320

如果您想在异步回调中保留数据，并且可能存在请求和响应对象不可用的情况。所以在这种情况下[continuation-local-storage](https://www.npmjs.com/package/continuation-local-storage)包是有帮助的。

它用于从不易访问的点访问数据或当前的快速请求/响应。它使用了**命名空间**的概念。

这是我如何设置的

安装`continuation-local-storage`包

```
npm install continuation-local-storage --save 
```

创建**命名空间**

```
let app = express();
let cls = require('continuation-local-storage');
let namespace = cls.createNamespace('com.domain'); 
```

然后是中间件

```
app.use((req, res, next) => {
   var namespace = cls.getNamespace('com.domain');
   // wrap the events from request and response
   namespace.bindEmitter(req);
   namespace.bindEmitter(res);

   // run following middleware in the scope of the namespace we created
   namespace.run(function () {
      // set data on the namespace, makes it available for all continuations
      namespace.set('data', "any_data");
      next();
   });
}) 
```

现在在任何文件或函数中，您都可以获取此命名空间并使用其中保存的数据

```
//logger.ts

var getNamespace = require("continuation-local-storage").getNamespace;
let namespace = getNamespace("com.domain");
let data = namespace.get("data");
console.log("data : ", data); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-26T12:37:22.910

不，它不会与所有请求一起共享，它只会在该请​​求中持续很长时间。

# javascript - Indesign CS6 脚本 - 导出图像

> ID：10983501
> 
> 赞同：2
> 
> 时间：2012-06-11T15:50:22.117
> 
> 标签：javascript, export, adobe-indesign

我在 indesign cs6 中编写 js 脚本以导出我的格式化图像时遇到问题。下面的代码（在本网站上找到并稍作修改）仅打开文档。

理想情况下，脚本将遍历我文档中所有格式化/裁剪的图像，并将它们导出到桌面上的新文件夹中，但使用原始文件名。

任何帮助将非常感激：

```
test();
function test(){

var myDoc = app.open('/Users/StudioA/Desktop/file.indd'); 
var myGroups = myDoc.groups;

//for each group...
for (var i = 0;i < myGroups.length; i++){
    // for each rectangle in the group...
    for(var r = 0; r< myGroups[i].rectangles.length; r++){

         var myRect = myGroups[i].rectangles[r];
           app.jpegExportPreferences.exportResolution = 300;
           app.jpegExportPreferences.jpegQuality = JPEGOptionsQuality.MAXIMUM;

           //give it a unique name
           var myFile = new File('/Users/StudioA/Desktop/Export/' + myRect.name + '.jpg');

           myRect.exportFile(ExportFormat.JPG, myFile);

           }
       }

 } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:57:27.427

文件名不在矩形上，而是在与放置的图形相关的链接上。给定一个打开的文档，这应该可以满足您的要求：

```
test();

function test() {

    var myDoc = app.activeDocument, apis = myDoc.allPageItems, rect, fileName;

    while ( rect = apis.pop() )
    {
        if ( !(rect instanceof Rectangle) || !rect.graphics[0].isValid ){ continue; }

        fileName = File ( rect.graphics[0].itemLink.filePath ).name;
        fileName = fileName.replace( /\.[a-z]{2,4}$/i, '.jpg' );

        app.jpegExportPreferences.exportResolution = 300;
        app.jpegExportPreferences.jpegQuality = JPEGOptionsQuality.MAXIMUM;

        //give it a unique name
        var myFile = new File (Folder.desktop+"/"+ fileName);

        rect.exportFile(ExportFormat.JPG, myFile);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-27T04:07:57.507

只需添加我的详细版本，它适用于 InDesign 中的当前选择并提供控制台反馈。它使用前缀“crop_”重命名图像并将它们保存到 ~/temp

```
exportSelectedImages();

function exportSelectedImages() {
    // configure export settings
    app.jpegExportPreferences.exportResolution = 72;
    app.jpegExportPreferences.jpegQuality = JPEGOptionsQuality.HIGH;

    // collect selected objects
    var selected = app.activeDocument.selection;
    $.writeln("Got " + selected.length + " selected objects...");

    // process selected objects
    for (var i = 0; i < selected.length; i++) {
        var cursor = selected[i];
        var img = cursor.images;

        $.writeln("Processing #" + (i+1) + "/" + selected.length);
        $.writeln("\t Type: " + cursor.constructor.name);

        // verify if object contains an image or not
        if (cursor.images.length > 0) {     
            var img = cursor.images[0];
            $.writeln("\t Contains image of type " + img.imageTypeName);
            var imageFileName = cursor.images[0].itemLink.name;
            $.writeln("\t File Name: " + imageFileName);
        } else {
            $.writeln("\t Not an image");
        }

        // save the object to a jpeg in path specified below
        var myFile = new File('~/temp/' + "crop_" + imageFileName + '.jpg');
        cursor.exportFile(ExportFormat.JPG, myFile);

     }

    $.writeln("Done.");
} 
```

# c# - C# 保持当前对页面更新的关注

> ID：10983505
> 
> 赞同：1
> 
> 时间：2012-06-11T15:50:26.203
> 
> 标签：c#, focus

我有一个需要多个用户输入的网页。每次更新后，虽然页面会跳回顶部，但用户必须向下滚动才能再次到达输入字段。我希望页面保持对每次更新的关注。如果那不可能，我想至少在每次更新后跳到输入表的顶部。我在用：

```
SetFocus(<tag name>) 
```

但它不起作用。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T15:55:28.870

您可以阅读这篇关于重置滚动位置的文章。

[http://csharpdotnetfreak.blogspot.com/2011/08/maintain-scroll-position-postback.html](http://csharpdotnetfreak.blogspot.com/2011/08/maintain-scroll-position-postback.html)

或这篇文章：

[http://www.elijahmanor.com/2009/09/maintain-scroll-position-on-page.html](http://www.elijahmanor.com/2009/09/maintain-scroll-position-on-page.html)

这是一个可以使用的工作 jquery 插件：

[http://en.hasheminezhad.com/scrollsaver](http://en.hasheminezhad.com/scrollsaver)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:58:14.693

我看到您使用的是 C#，所以如果您也使用 ASP.NET，您可以尝试将System.Web.UI.Page的[MaintainScrollPositionOnPostBack属性设置为 true。](http://msdn.microsoft.com/en-us/library/system.web.ui.page.maintainscrollpositiononpostback.aspx)这将使页面能够返回到回发之前的位置。

# java - WorldWind Java API

> ID：10983508
> 
> 赞同：0
> 
> 时间：2012-06-11T15:50:40.360
> 
> 标签：java, maps, openstreetmap, worldwind

我想创建一个允许用户输入经度和纬度的应用程序，然后将其显示在地图上。我遇到过[WorldWind](http://goworldwind.org/)，但我以前从未听说过。

要创建这样的应用程序，我最好使用 WorldWind 或[OpenStreetMap](http://www.openstreetmap.org/)

由于这只是我的应用程序的一部分，而且谷歌地图不允许在桌面应用程序上使用他们的地图，我将无法使用谷歌地图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T14:59:08.547

如果您从用户输入中获得纬度和经度，在 WorldWind 中您可以执行以下操作：

```
 Position pos = new Position(Angle.fromDegreesLatitude(latitude), Angle.fromDegreesLongitude(longitude), altitude);
    PointPlacemark pp = new PointPlacemark(position);
    PointPlacemarkAttributes attrs = new PointPlacemarkAttributes();
    attrs.setImageAddress("http://maps.google.com/mapfiles/kml/paddle/red-circle.png");
    attrs.setScale(0.6);
    attrs.setImageOffset(new Offset(32d, 4d, AVKey.PIXELS, AVKey.PIXELS));
    pp.setAttributes(attrs);
    wwd.redraw(); 
```

顺便说一句，您可以在 World Wind中使用[Open Street Map 图层。](http://builds.worldwind.arc.nasa.gov/worldwind-releases/1.5/docs/api/gov/nasa/worldwind/layers/Earth/OSMMapnikLayer.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:41:27.727

对于桌面应用程序 WorldWind 更好，但您需要注意所有客户端系统都应具有 3D 功能显卡。

而如果您对浏览器功能没问题，您可以尝试 Google 地图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T15:56:18.173

如果您可以使用网络，请使用[Google Maps](https://developers.google.com/maps/documentation/) API。

[代码很简单](http://today.java.net/pub/a/today/2006/10/25/integrating-google-maps-into-web-application.html)：

```
 var map = new GMap2(document.getElementById("map"));
    map.setCenter(new GLatLng(-41.5, -187.5), 5); 
```

# c - 为什么会泄漏内存？（指针数组 C）

> ID：10983518
> 
> 赞同：1
> 
> 时间：2012-06-11T15:51:08.240
> 
> 标签：c, memory-leaks, malloc, valgrind

早上好-

valgrind 说：

```
==9735== 24,976 bytes in 446 blocks are definitely lost in loss record 9 of 9
==9735==    at 0x100012362: malloc (vg_replace_malloc.c:266)
==9735==    by 0x1000016F2: interpolate (in ./a.out)
==9735==    by 0x100000CFA: main (in ./a.out) 
```

哎呀。这是我的插值函数：

```
void interpolate(PDouble* evaluated, int doubleCount){
int i, j, k;
int boxCount = 0;
int frameCount = 0;

for(i=0; i<doubleCount; i++){
  boxCount = evaluated[i]->first->numBoxes;
  frameCount = evaluated[i]->gap;
  evaluated[i]->changeMatrix = (int***)malloc(boxCount*sizeof(int**));

for(j=0; j < boxCount; j++){
  evaluated[i]->changeMatrix[j] = (int **)malloc(ATTR * sizeof(int*));

  for(k=0; k < ATTR; k++){
    evaluated[i]->changeMatrix[j][k] = (int*)malloc(sizeof(int)*frameCount);
    if(evaluated[i]->differenceMatrix[j][k] > 200 ||
       evaluated[i]->differenceMatrix[j][k] < -200){
      generateRotationSequence(evaluated[i]->changeMatrix[j][k],
                               evaluated[i]->first->boxes[j]->o,
                               evaluated[i]->second->boxes[j]->o,
                               frameCount);
    }
    else{
      evaluated[i]->changeMatrix[j][k] = (int*)malloc(sizeof(int)*frameCount);
      generateSequence(evaluated[i]->changeMatrix[j][k], 
                       evaluated[i]->differenceMatrix[j][k], frameCount);
    }
   }
  }
 }
} 
```

但是我有 C 函数可以释放 PDoubles 的所有指针。如果需要，我可以提供代码，但是有什么明显的地方会导致它泄漏或指针悬空吗？

编辑：意识到我在描述中使用了一个奇怪的术语。这次我也添加了我的析构函数

```
void killDouble(PDouble marked){
int i, j, k;
int gap = marked->gap;
for(i=0; i < marked->first->numBoxes; i++){
  for(j=0; j < ATTR; j++){
    free(marked->changeMatrix[i][j]);
  }
  free(marked->changeMatrix[i]);
  free(marked->differenceMatrix[i]);
}
for(i=0; i < gap; i++){
  killFrame(marked->intFrames[i]);
}
killFrame(marked->first);
killFrame(marked->second);
free(marked->changeMatrix);
free(marked->differenceMatrix);
free(marked->intFrames);
free(marked);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T15:53:50.043

你分配`evaluated[i]->changeMatrix[j][k]`

```
evaluated[i]->changeMatrix[j][k] = (int*)malloc(sizeof(int)*frameCount);
if(evaluated[i]->differenceMatrix[j][k] > 200 ||
   evaluated[i]->differenceMatrix[j][k] < -200){
  generateRotationSequence(evaluated[i]->changeMatrix[j][k],
                           evaluated[i]->first->boxes[j]->o,
                           evaluated[i]->second->boxes[j]->o,
                           frameCount);
}
else{
  evaluated[i]->changeMatrix[j][k] = (int*)malloc(sizeof(int)*frameCount); 
```

如果条件不满足，则无条件地再次释放。那是你的泄漏。

由于两种分配完全相同，因此您应该删除`else`块中的分配，这是没有意义的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T15:53:27.513

```
evaluated[i]->changeMatrix[j][k] = (int*)malloc(sizeof(int)*frameCount); 
```

这就是泄漏。您分配内存，但从不释放

# java - 如何解组未排序的集合？

> ID：10983521
> 
> 赞同：0
> 
> 时间：2012-06-11T15:51:26.873
> 
> 标签：java, binding, jibx

我有类似的 XML 字符串：

```
<Tree Name="tree1">
    <Service>Service1</Service>
    <Tree Name="tree2">
         <Service>Service2</Service>
         <Service>Service3</Service>
    </Tree>
    <Service>Service4</Service>
    <Tree Name="tree3">
        <Service>Service4</Service>
        <Service>service5</Service>
    </Tree>
</Tree> 
```

和绑定结构：

```
 <mapping ordered="false" allow-repeats="true" abstract="true" type-name="Tree"
         class="Tree">
    <collection ordered="false" allow-repeats="true" get-method="getTrees" set-method="setTrees" usage="optional">
        <structure usage="optional" ordered="false" allow-repeats="true" map-as="Tree" name="Tree"/>
    </collection>
    <collection ordered="false" allow-repeats="true"  get-method="getServices" set-method="setServices" usage="optional">
        <structure usage="optional" ordered="false" allow-repeats="true"   map-as="Service" name="Service"/>
    </collection>
    <value style="attribute" name="Name" get-method="getName" set-method="setName" usage="optional"/>
    </mapping> 
```

但是当我尝试解组 xml 时，我在根目录中只捕获了一棵树和一个服务。是否有任何可能从 xml 获取所有数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T13:56:41.827

我通过在 binding.xml 中使用这样的构造解决了这个问题：

```
<collection ordered="false" get-method="getCollection" set-method="setCollection" usage="optional">
      <structure map-as="Service" name="Service" usage="optional"/>
      <structure map-as="Tree" name="Tree" usage="optional"/>
</collection> 
```

这给了我所有元素的集合，我可以手动对其进行排序。

# java - Linux 上的 Java 服务器

> ID：10983522
> 
> 赞同：-3
> 
> 时间：2012-06-11T15:51:28.983
> 
> 标签：java, diskspace

嘿，我的主要目标是在我的 linux 系统上运行一个服务器，大约 10 个 linux 系统将连接到该服务器。所以我的动机是对服务器进行编程（在 java 中），以便找到连接到服务器的任何所需系统的磁盘容量。这可能吗？？我在 ubuntu 11.10 上使用 netbeans

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T15:56:17.050

是的，这是可能的。您可以使用套接字在服务器和客户端系统之间创建通信，并且客户端套接字可以将其磁盘容量写入服务器套接字。

要获取系统的磁盘容量，请获取根文件的总空间。

```
long diskCapacity = new File("/").getTotalSpace(); 
```

# java - 从 Tomcat 发送 SMTP 消息时出错：没有可用的缓冲区空间

> ID：10983526
> 
> 赞同：0
> 
> 时间：2012-06-11T15:51:45.337
> 
> 标签：java, sockets, unix, tomcat, networking

我在服务器上运行**Tomcat7**（现在它是一个虚拟机，但应该配置为无限连接）。

我与 SMTP 服务器以及 facebook 服务器有联系。我的流量约为 250 次/分钟。

我正在运行 djabberd，平均大约有几百个连接用户。

有时我得到：

```
javax.mail.MessagingException: Could not connect to SMTP host: xxx.xxx.xxx.xxx, port: xxxxx;
  nested exception is:
    java.net.SocketException: No buffer space available
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1934)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:638)
    at javax.mail.Service.connect(Service.java:295)
    at javax.mail.Service.connect(Service.java:176)
    at javax.mail.Service.connect(Service.java:125)
    at javax.mail.Transport.send0(Transport.java:194)
    at javax.mail.Transport.send(Transport.java:124)
    at xxxxxxxxxxxxxxxx.controllers.EmailManager.sendEmail(EmailManager.java:151) 
```

或连接到 facebook 服务器的相同错误。

```
netstat -n | wc -l 
348 
```

Tomcat 可以接受 acceptCount="1024" 连接。

我应该去哪里调查？

**[更新 1]**

发送电子邮件 ：

```
Context envContext = (Context) initContext.lookup("java:/comp/env");
session = (javax.mail.Session) envContext.lookup("mail/emailSession");

MimeMessage message = new MimeMessage(session);
//....
Transport.send(message); 
```

配置 ：

```
<resource-ref>
        <description>
            JNDI javamail session resource reference
        </description>
        <res-ref-name>mail/emailSession</res-ref-name>
        <res-type>javax.mail.Session</res-type>
        <res-auth>Container</res-auth>
    </resource-ref> 
```

脸书连接：

```
FacebookClient facebookClient = new DefaultFacebookClient(accessToken);
User user = facebookClient.fetchObject("me", User.class); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-13T00:32:20.890

什么操作系统？Linux？您可能已达到客户端套接字的最大数量的限制，没有无限连接之类的东西。在您的应用程序的某个地方，您没有关闭连接，或者您打开的连接太多。“太多”可能比您想象的要低很多，因为它受到进程可以打开的文件描述符的最大数量的限制。如果您正在运行 Linux，请查看[http://www.cyberciti.biz/faq/linux-increase-the-maximum-number-of-open-files/](http://www.cyberciti.biz/faq/linux-increase-the-maximum-number-of-open-files/)

# ios - 何时调用 didRegisterForRemoteNotificationsWithDeviceToken？

> ID：10983536
> 
> 赞同：38
> 
> 时间：2012-06-11T15:52:42.973
> 
> 标签：ios, notifications, apple-push-notifications

关于 didRegisterForRemoteNotificationsWithDeviceToken 有很多问题，但它们都回避了一个非常直接的问题，我似乎无法找到确切的答案。

对于以所有其他方式正确设置通知并具有适当网络连接的应用程序：何时调用 didRegisterForRemoteNotificationsWithDeviceToken？一些可能的选择可能是：

1.  每次应用启动时
2.  只有在初始提示用户接受推送通知之后
3.  还有什么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-12T00:58:50.083

在您的 UIApplication 中调用此方法后，应用程序委托将在成功注册远程通知后调用该方法：

> (void)registerForRemoteNotificationTypes:(UIRemoteNotificationType)types

根据：http: [//developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html)

> 当您发送此消息时，设备将启动 Apple 推送服务的注册过程。如果成功，则应用程序委托在**application:didRegisterForRemoteNotificationsWithDeviceToken:**方法中接收到一个设备令牌；如果注册不成功，则通过**application:didFailToRegisterForRemoteNotificationsWithError:**方法通知委托。如果应用程序委托接收到设备令牌，它应该与其提供者连接并将令牌传递给它。

现在，为了进一步详细说明，通常应用程序会在您的应用程序委托中调用您的**didFinishLaunchingWithOptions:(NSDictionary *)launchOptions中的****registerForRemoteNotificationTypes 。**因此，**application:didRegisterForRemoteNotificationsWithDeviceToken**通常在应用程序启动后立即被调用。

 ******编辑：**应用程序：didRegisterForRemoteNotificationsWithDeviceToken 在第一次之后仍然会被调用以进行后续注册。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-11T17:56:30.453

当应用程序首次运行时，它会询问用户是否允许远程通知。如果他们说是，那么它会在那个时候触发 didRegisterForRemoteNotificationsWithDeviceToken 并且每次在第一次打开应用程序时都会触发这个函数。如果他们说不，那么除非他们进入设置并允许应用程序上的通知，否则它不会被解雇。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-02T07:24:34.707

可能有很多原因，检查一些原因

*   如果您在模拟器中运行应用程序，则不会调用 application:didFailToRegisterForRemoteNotificationsWithError: 方法，因为模拟器中不支持使用设备令牌的推送通知。您仍然可以使用向您的模拟器发送推送通知`xcrun simctl push <device> com.example.my-app ExamplePush.apns"`

*   如果没有连接，请检查您的设备互联网连接。

有关更多信息，请查看[链接](https://developer.apple.com/library/ios/technotes/tn2265/_index.html)****

# c# - DatabaseContext 包含一个带有重复实体的 DbSet，为什么？

> ID：10983541
> 
> 赞同：1
> 
> 时间：2012-06-11T15:53:08.730
> 
> 标签：c#, asp.net, entity-framework, entity-framework-4.3

使用实体框架保存 InvoiceDetail 时，我们检查税收信息是否已被删除，如果我们看到我们仍然有税收，我们检查我们是否在税收的 DbSet 中已经有了税收，因为我们只想要对这个对象的引用到我们的 InvoiceDetail。为此，我们只需检查当地财产并从当地获取税款。

```
if (formInvoiceDetail.Tax != null) {
    if (formInvoiceDetail.Tax.ID == 0) {
        databaseInvoiceDetail.Tax = null;
    }
    else {
        if (!Database.Set<Tax>().Local.Any(e => e.ID == formInvoiceDetail.Tax.ID)){
            Database.Taxes.Attach(formInvoiceDetail.Tax);
        }
        databaseInvoiceDetail.Tax = Database.Set<Tax>().Local.Single(e => e.ID == formInvoiceDetail.Tax.ID);
    }                
} 
```

问题是我们遇到了 Single 崩溃的情况，因为 ID 在 Tax 的 DbSet 中重复。

当先前的操作设置额外的现有税务信息时会发生这种情况（例如，第一次加载将使用税务对象（仅其 ID）加载 InvoiceDetail，稍后将更改 invoiceDetail.Tax = fullLoadedTax。

如果我们不想在 DbSet 中有重复的数据并且总是“最准确”的数据，我们该如何进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:17:15.493

是 ID 是实体映射的数据库中的主键，因为如果是这样，您获得的代码片段

```
 invoiceDetail.Tax = fullLoadedTax 
```

违反了数据库的约束。令我震惊的是，您的问题在于这行代码，而不是您在问题中显示的任何内容。如果您正确地限定和更新您的本地数据库，它就不会违反其约束并且您不会遇到这个问题。当您搞乱 fullLoadedTax 时，请尝试使用[ApplyCurrentValues](http://msdn.microsoft.com/en-us/library/dd466205.aspx)：

```
 Database.Taxes.ApplyCurrentValues(formInvoiceDetail.Tax); 
```

这*应该*会更新一些东西，以便为您提供一致的、最新的设置，但如果一开始就将 ID 正确设置为主键，那么尝试 Attach() 具有相同键的第二条记录将会崩溃无论如何，你的脸，所以你可能还需要再看看你是如何处理你的 DbContext 的。

# javascript - jQuery sortable - 根据输入字段的值进行排序

> ID：10983546
> 
> 赞同：5
> 
> 时间：2012-06-11T15:53:52.183
> 
> 标签：javascript, jquery, jquery-ui-sortable

免责声明 - 我不完全确定这是可能的。但在这种情况下，我仍然希望有人指出一种可能的替代方案或某种黑客行为。

这是情况。

我有一个使用 jQuery UI Sortable 的工作列表，因此用户可以拖放列表中的项目。

jQuery：

```
$(document).ready(function() {
    $("#test-list").sortable({
      handle : '.big-handle',
      update : function () {
          var order = $('#test-list').sortable('serialize');
        $("#info").load("../sortable/process-sortable.php?"+order);
      }
    });
}); 
```

Ajax 部分将新订单存储在数据库中，您无需担心。

的HTML：

```
<ul id="test-list">
<li id='listItem_1'><div class='main-item big-handle'><img src='../sortable/arrow.png' alt='move' width='16' height='16' class='handle' /><strong>Item 1</strong></div></li>
<li id='listItem_2'><div class='main-item big-handle'><img src='../sortable/arrow.png' alt='move' width='16' height='16' class='handle' /><strong>Item 1</strong></div></li>
<li id='listItem_3'><div class='main-item big-handle'><img src='../sortable/arrow.png' alt='move' width='16' height='16' class='handle' /><strong>Item 1</strong></div></li>
</ul> 
```

这一切都很好。现在，棘手的部分。我的客户希望每个列表项旁边有一个输入字段，用户可以在其中输入一个数字，这应该`onBlur`将该列表项移动到指定位置。因此，如果用户在列表项编号旁边的字段中输入“1”。3，然后该项目应该移动到列表中的第一个位置，就像它被拖到那里一样。这可以做到吗？

您无需为整个列表提出完整的解决方案，假设我只需要一个可以移动项目编号的字段。3左右。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:27:58.190

这个怎么样：**[jsFiddle示例](http://jsfiddle.net/j08691/DHqRh/)**。

```
$("#test-list").sortable({
    handle: '.big-handle',
    update: function() {
        var order = $('#test-list').sortable('serialize');
        $("#info").load("../sortable/process-sortable.php?" + order);
    }
});

$("#test-list input").blur(function() {
    var pos = $(this).val() - 1;
    if (pos >= 0 && pos <= $("#test-list li").length - 1) {
        if ($(this).parents('li').index() > pos) {
            //move up
            $(this).parents('li').insertBefore($("#test-list li:eq(" + pos + ")"));
        }
        if ($(this).parents('li').index() < pos) {
            //move down
            $(this).parents('li').insertAfter($("#test-list li:eq(" + pos + ")"));
        }
        $("#test-list input").val('');
    }
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:12:28.340

试试这个

```
​$('input').on('blur', function(){
   var $el = $(this),
   pos = $el.val(),
   $parent = $el.closest('li');

   $parent.insertBefore($('li').eq(pos));

})​​​ 
```

功能演示：http: [//jsfiddle.net/YyvjH/](http://jsfiddle.net/YyvjH/)

模拟拖动的过渡效果可以在 CSS3 中完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:24:03.233

eq(2) 方法获取第 n 个匹配元素，我们将其删除。在这种情况下，从位置 3（索引 2）开始，因为那是您要求移动的位置。我们将其从 DOM 中移除，然后将其插入到输入框中指定的位置。

```
//do this on blur
var index = parseInt($("input").val())
  , element = $("#test-list li").eq(2).remove();
$("#test-list li").eq(index - 1).before(element); // -1 because users like 1 based indices 
```

# java - 通用数据库方法

> ID：10983550
> 
> 赞同：2
> 
> 时间：2012-06-11T15:54:01.373
> 
> 标签：java, generics

我有一个从 Drupal CMS 检索数据的 Java 类。Drupal 中最终会有相当多的内容类型，我需要将它们提取到 Java 中并进行缓存。由于 Drupal 的工作方式，每个内容类型都是一个单独的数据库视图。

我有以下由服务层调用的方法，它返回一个特定的对象类型。然而，我担心的是这些方法对于每种内容类型的扩散。

有人可以建议一种使其更通用的方法吗？数据库方法显示在第二个代码示例中。我不知道我是否也可以使其通用，以及是否值得。也许我可以在第一种方法中调用一个方法，并让第二种方法使用 case 语句。

```
public DeliverySchedule getDeliverySchedule(final String cmsKey) { //     <---- make return type (Del Schedule) generic

    String cacheKey = TYPEDS + cmsKey;
    DeliverySchedule cmsInstance = CMSObjectCache.getCachedCMSObject(cacheKey, DeliverySchedule.class);   // Make generic

    // Object not found in cache, go to database.
    if (cmsInstance == null) {
        try {
            cmsInstance = getDeliveryScheduleFromDB(cmsKey);   //  <---- How can I make this generic so I can avoid DRY?
            CMSObjectCache.putCachedCMSObject(cacheKey, new CMSObject(DeliverySchedule.class, cmsInstance));
            return cmsInstance;
        } catch (EmptyResultDataAccessException e) {
            return null;
        }
    } else {
        return cmsInstance;
    }
} 
```

数据库访问方法，特定于上述内容类型：

```
 // Called from above
private List<DeliverySchedule> getDeliverySchedulesFromDB() {
    JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);
    final String sql = "select * "
            + "         from cmsutil.delivery_schedules as m "
            + "         where m.effdate = (select max(mm.effdate) "
            + "                            from cmsutil.delivery_schedules as mm "
            + "                            where mm.cms_key = m.cms_key "
            + "                            and mm.effdate <= current_date)";

    List<DeliverySchedule> listcmsObject = jdbcTemplate.query(sql, new DeliveryScheduleMapper());
    return jdbcTemplate.query(sql, new DeliveryScheduleMapper());
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:53:15.697

通常，每个表或视图都有一个 DAO（DAO 的接口和实现它的类）。这样，如果特定表架构发生更改，您的更改将被隔离到一个 DAO 类。

您可以将内容类型概括为具有单个接口和为每种内容类型实现接口的类。这应该允许您适应通用内容类型层、特定内容类型和数据访问层的变化。

我同意它可能会变成大量代码，但是如果每个组件都与其他组件分离，那么它在更改/添加组件或处理架构更改时为您提供了灵活性。解耦和抽象在短期内可能会很痛苦，但从长远来看，往往会给整个工程团队带来回报。

我喜欢这样的问题/讨论，并且总是乐于接受建议或其他方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T03:11:52.913

要创建类的新实例，您需要在类对象上使用反射装置。所以你要做的是使用一个泛型类，它的实例有该类的记录。假设你的 bean 扩展了 mybean；

```
abstract class<T extends MyBean> Mapper implements T {
    abstract void map(ResultSet rs);
}

class DAO<T extends MyBean> {
    Class<Mapper<T>> theMapperClass;
    DAO(Class<T> clazz) { 
        this.theMapperClass = getMapperClassFor(clazz); 
    }

    List<T> getAList() {
        List<T> l = new ArrayList<T>();
        ResultSet rs = runTheQuery();
        while(rs.next()) {
            l.add(theMapperClaxx.newInstance().map(rs));
        }
        return l;
    }
} 
```

那种事。

```
 DAO<Foo> fooDao = new Dao<Foo>(Foo.class);
   List<Foo> l = fooDao.getAList();

   List<? extends MyBean> l = someDao.getAList();

   static <T extends Mybean> List<T> boink(Class<T> clazz) {
       DAO<T> tDao = (DAO<T>) daoMap.get(clazz);
       return tDao.getAList();
   }

   List<Foo> l = boink(Foo.class); 
```

# python - Python：如何根据元组中指定的多个条件从 csv 文件中提取行

> ID：10983553
> 
> 赞同：2
> 
> 时间：2012-06-11T15:54:08.423
> 
> 标签：python, csv, python-2.7

我有一个非常大的 .csv 文件（10GB），并希望根据元组中的不同条件提取行。
每行的第四列包含 IPAdd
我只需要提取具有特定 IP 的行。

我是 python 新手，想知道如何遍历每个元组 IP 并将它们写入 WYE_Data.csv 文件。

CSV 文件的内容示例是；

```
xxx,1234,abc,199.199.1.1,1,fghy,xxx   
xxx,1234,abc,10.10.1.1,1,fghy,xxx   
xxx,1234,abc,144.122.1.1,1,fghy,xxx   
xxx,1234,abc,50.200.50.32,1,fghy,xxx

import csv   
customers = csv.reader(open('data.csv', 'rb'), delimiter=',')    
## This is the line I'm having         issues with   
IPAdd = ('199.199.1.1' or '144.122.1.1' or '22.22.36.22')
csvout = csv.writer(open('WYE_Data.csv', 'ab')) 

for customer in customers:   
    if customer[3] == IPAdd:    
        csvout.writerow(customer) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:44:39.533

```
import csv

look_for = set(['199.199.1.1', '144.122.1.1', '22.22.36.22'])

with open('data.csv','rb') as inf, open('wye_data.csv','wb') as outf:
    incsv = csv.reader(inf, delimiter=',')
    outcsv = csv.writer(outf, delimiter=',')
    outcsv.writerows(row for row in incsv if row[3] in look_for) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:03:12.373

我建议您使用要匹配 IP 的值列表。

```
ips = ['199.199.1.1', '144.122.1.1', '22.22.36.22'] 
```

然后你可以说：

```
if customer[3] in ips: 
```

# design-patterns - 使用命令模式进行记事本设计

> ID：10983554
> 
> 赞同：0
> 
> 时间：2012-06-11T15:54:09.143
> 
> 标签：design-patterns

我的任务是获取一个将文件大小限制为 2 MB 的记事本。我们支持所有正常的记事本操作，如打开、保存、撤消、重做等。我最初的想法是通过“命令模式”进行操作。还有什么可以使用或建议的吗？

这是在c#中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:10:38.793

命令模式肯定会允许简单的撤消/重做功能。将模式扩展到完整的 MVC 将允许良好的代码组织，将数据（用户键入的内容）存储在模型中，在控制器中处理事件（用户键入、保存等）（使用强大的命令模式实现），以及用户实际看到的视图中处理的内容。

有大量资源可用于学习设计模式。Microsoft 在[这里讨论 MVC。](http://msdn.microsoft.com/en-us/library/ff649643.aspx)[这](http://www.c-sharpcorner.com/uploadfile/rmcochran/mvc_intro12122005162329pm/mvc_intro.aspx)是MVC的另一个介绍。[这](http://www.dofactory.com/Patterns/Patterns.aspx)是一个很好的各种其他模式的列表。这是一个很好的图表[，](http://www.robotlegs.org/diagram/)解释了 MVC 流程（不是 C#，但仍然适用）。

请记住，没有 100%“这就是 MVC 应有的方式”。与大多数与代码相关的事情一样，有一个目标（模型和视图的分离），并且您正在以最佳方式制作您的项目以尝试实现它。没有“一刀切”。

# python - Python XMLParser：何时调用 data() 方法

> ID：10983556
> 
> 赞同：0
> 
> 时间：2012-06-11T15:54:10.747
> 
> 标签：python, elementtree

我正在学习 Python，并且很难理解 xml 解析器（ElementTree - XMLParser）的行为。

我修改了[文档中的示例](http://docs.python.org/library/xml.etree.elementtree.html#xml.etree.ElementTree.XMLParser.feed)

```
class MaxDepth:                     # The target object of the parser
    path = ""
    def start(self, tag, attrib):   # Called for each opening tag.
        self.path += "/"+ tag
        print '>>> Entering - ' + self.path
    def end(self, tag):             # Called for each closing tag.
        print '<<< Leaving - ' + self.path
        if self.path.endswith('/'+tag):
            self.path = self.path[:-(len(tag)+1)]
    def data(self, data):
        if data:
            print '... data called ...'
            print data , 'length -' , len(data)
    def close(self):    # Called when all data has been parsed.
        return self 
```

它打印以下输出

```
>>> Entering - /a
... data called ...

length - 1
... data called ...
   length - 2
>>> Entering - /a/b
... data called ...

length - 1
... data called ...
   length - 2
<<< Leaving - /a/b
... data called ...

length - 1
... data called ...
   length - 2
>>> Entering - /a/b
... data called ...

length - 1
... data called ...
     length - 4
>>> Entering - /a/b/c
... data called ...

length - 1
... data called ...
       length - 6
>>> Entering - /a/b/c/d
... data called ...

length - 1
... data called ...
       length - 6
<<< Leaving - /a/b/c/d
... data called ...

length - 1
... data called ...
     length - 4
<<< Leaving - /a/b/c
... data called ...

length - 1
... data called ...
   length - 2
<<< Leaving - /a/b
... data called ...

length - 1
<<< Leaving - /a
<__main__.MaxDepth instance at 0x10e7dd5a8> 
```

我的问题是

1.  何时调用 data() 方法。
2.  为什么在开始标签之前调用了两次
3.  我找不到 api 文档以获取有关`data`方法的更多详细信息。我在哪里可以找到类的 api 参考之`XMLParser`类的 javadoc。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:05:08.607

如果您要像这样修改数据方法：

```
def data(self, data):
    if data:
        print '... data called ...'
        print repr(data), 'length -' , len(data) 
```

你会明白为什么要多次调用 data 方法；标签之间的每一行文本数据都会调用它：

```
>>> Entering - /a
... data called ...
'\n' length - 1
... data called ...
'  ' length - 2
>>> Entering - /a/b
... data called ...
'\n' length - 1
... data called ...
'  ' length - 2
<<< Leaving - /a/b
... data called ...
'\n' length - 1
... data called ...
'  ' length - 2
>>> Entering - /a/b
... data called ...
'\n' length - 1
... data called ...
'    ' length - 4
# ... etc ... 
```

XMLParser 方法基于[Expat](http://expat.sourceforge.net/)解析器。

In my experience, any streaming XML parser will treat text data as a series of chunks and you have to concatenate any and all data events together until you hit the next starttag or endtag event. Often the parser breaks up chunks at whitespace boundaries but that is not a given.

# c++ - Visual Studio2010 中 C++ 中通过优化（由编译器完成）的无限循环示例

> ID：10983557
> 
> 赞同：0
> 
> 时间：2012-06-11T15:54:11.370
> 
> 标签：c++, visual-studio-2010, compiler-optimization

我必须演示编译器如何在优化程序时产生无限循环。

我必须在 Visual Studio 2010 中用 C++ 展示它，我认为展示它的最佳方式是使用和不使用 volatile。

我使用了这里的代码[http://msdn.microsoft.com/en-us/library/12a04hfd%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/12a04hfd%28v=vs.80%29.aspx) 并在有和没有 volatile 的情况下进行了尝试（并使用：/EHsc /O2 编译）但是没有无限循环。我也这样改变它：

```
// compile with: /EHsc /O2

#include <iostream>
#include <windows.h>
using namespace std;

//volatile bool Sentinel = true;
bool Sentinel = true;
int CriticalData = 0;
int round=0;

unsigned ThreadFunc1() {
   while (Sentinel){
        Sleep(10);   // volatile spin lock   
        cout << "Critical Data = " << CriticalData << endl; 
   }
   return 0;
} 
unsigned  ThreadFunc2() {
   Sleep(2000);
   CriticalData++; 
   Sentinel = false; 
   return 0;
}

int main() {
   HANDLE hThread1, hThread2; 

   hThread1 = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)&ThreadFunc1, NULL, 0, NULL);
   hThread2 = CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)&ThreadFunc2, NULL, 0, NULL);

   CloseHandle(hThread1);
   CloseHandle(hThread2);

   system("pause");
} 
```

但没有无限循环。有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:12:11.930

编译器*不确定*您的全局变量可以做什么`Sleep(int)`以及可以做什么。`iostream.operator <<()`有可能（从它的角度来看）它们可以更改`Sentinel`变量，因此编译器无法`Sentinel`从循环中删除读取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:57:16.973

这里有什么问题？编译器*可能会*产生一个没有 volatile 的无限循环，但它不是必须的。以最高优化级别编译并关闭调试信息时，更有可能看到无限循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:00:46.683

```
int gIMightBeUseful = 1;

void foo()
{
  int bar;
  while(!bar){gIMightBeUseful++;}
} 
```

根据优化级别有无限循环的机会。还是必须特定于线程互锁？

# ios - 如何更新被吊销的证书？

> ID：10983564
> 
> 赞同：1
> 
> 时间：2012-06-11T15:55:08.283
> 
> 标签：ios, certificate

我刚刚完成了我的第一个应用程序，我想将它提交到 iTunes 商店。在准备时，我阅读了一个教程，该教程说我应该首先清理所有证书和配置文件。所以，按照这些人的指示，我吊销了我的证书。

现在，我有一段时间试图弄清楚如何找回它。我发现 Apple ( [TN2250](https://developer.apple.com/legacy/library/technotes/tn2250/_index.html) ) 的一篇明显过时的文章不再适用于我的 Xcode (4.3.2) 版本。在供应门户的证书部分，我看不到更新证书或创建新证书的方法。我什至打电话给苹果的支持，那个漂亮的女孩很可爱，但最后还是没能帮助我，并告诉我她不是技术支持，我需要在各种帮助论坛中提问。

如何更新我的证书？还是创建一个新的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T04:43:40.597

有两个证书：一个是开发证书，另一个是分发证书。

如果它们已过期或您已撤销它们。您需要使用 Apple 计算机中的密钥链来生成证书请求。

进入你的苹果电脑，打开Application->utilities->keychain Access Keychain Access->certificate Assantance->Request a certificate from a certificate authority 填写你的电子邮件地址和姓名，选择保存到磁盘

您需要为开发证书和分发证书生成两个证书

然后：

您登录到您的供应门户。点击左侧的证书手册 有两个证书：一个是开发证书，另一个是分发证书。
您从门户请求新证书，上传您之前生成的证书请求。

您应该能够获得新证书。您将这两个证书下载到您的计算机上，然后双击证书将它们安装到您的钥匙串中。

如果您在获取新证书时遇到问题，请告诉我。

# c# - 在 Silverlight 数据网格中维护排序顺序

> ID：10983566
> 
> 赞同：1
> 
> 时间：2012-06-11T15:55:15.510
> 
> 标签：c#, silverlight

我有一个绑定到 ObservableCollection 对象的简单 Silverlight 5 数据网格：

```
<sdk:DataGrid x:Name="grid_test" AutoGenerateColumns="False" Grid.Row="1" Height="268" HorizontalAlignment="Left" Margin="16,186,0,0" VerticalAlignment="Top" Width="744">
            <sdk:DataGrid.Columns>
                <sdk:DataGridTextColumn Header="Agent Name" CanUserReorder="True" CanUserResize="True" CanUserSort="True" Width="Auto" Binding="{Binding agentName}"  />
                <sdk:DataGridTextColumn Header="Campaign" CanUserReorder="True" CanUserResize="True" CanUserSort="True" Width="Auto" Binding="{Binding currentCampaign}"  />

                <sdk:DataGridTextColumn Header="Currently" CanUserReorder="True" CanUserResize="True" CanUserSort="True" Width="Auto" Binding="{Binding currentState}"  />
                <sdk:DataGridTextColumn Header="Time" CanUserReorder="True" CanUserResize="True" CanUserSort="True" Width="Auto" Binding="{Binding displayTime}"  />

            </sdk:DataGrid.Columns>
        </sdk:DataGrid> 
```

并在代码中：

> ```
> grid_test.ItemsSource = allKnownAgents; 
> ```

..它工作正常，数据会自动显示和更新，用户可以通过单击列标题对数据进行排序。但是，当数据发生变化时，网格不会自动恢复——这意味着排序顺序没有得到严格维护。用户需要再次单击列标题以手动重新排序数据。

是否有任何简单的方法可以要求/告诉 Silverlight 在数据变化时保持数据顺序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T17:36:54.433

一种选择是使用[PagedCollectionView](http://msdn.microsoft.com/en-us/library/system.windows.data.pagedcollectionview%28v=vs.95%29.aspx)代替 ObservableCollection 。您可以更好地控制无效和重新应用排序和过滤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-14T12:38:25.570

尝试设置，`Mode=TwoWay`例如：-`Binding="{Binding agentName, Mode=TwoWay}"`

# java - 检查 null - 什么顺序？

> ID：10983573
> 
> 赞同：18
> 
> 时间：2012-06-11T15:55:30.533
> 
> 标签：java

在检查空值时，我使用这个：

```
String str;

if(str == null){
    //...
} 
```

但我也看到了这个：

```
if(null == str){
    //...
} 
```

使用其中一个有什么优势吗？还是只是为了提高可读性？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-11T16:01:03.613

第二个版本 ( `null == str`) 称为**尤达条件**。

它们都导致相同的行为，但第二个有一个优点：它可以防止您在忘记一个变量时意外更改变量`=`。在这种情况下，编译器会在该行返回错误，并且您的代码不会出现一些奇怪的行为以及由此产生的调试。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-06-11T16:00:27.393

该`null == x`约定通常出现在熟悉 C 的人编写的代码中，其中赋值也可以是表达式。一些 C 程序员编写这样的代码，这样如果他们错过了`=`in

```
if (NULL == ptr)... 
```

代码不会编译，因为`NULL = ptr`它不是一个有效的赋值。这可以防止在代码库中引入相当隐蔽的错误，尽管现代 C 编译器使此类约定过时，只要注意启用和*阅读*生成的警告...

这种编码风格在 Java 中从来没有任何用处，在 Java 中引用赋值不能用作布尔表达式。它甚至可以被认为是违反直觉的；在他们的自然语言中，大多数人会说*“如果 X 为 null...”*，或者*“如果 X 等于 17...”*，而不是*“如果 null 等于 X...”*。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-11T15:56:41.647

除了可读性之外，两者之间没有区别。使用对您更有意义的那个。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-11T16:00:03.657

正如您所说，可读性是最重要的原因。大声读出来， (null == str) 读起来不好。这几乎就像从右到左阅读一样。(str == null) 读起来好多了。

此外，我认为需要考虑以下几点：

```
if (str != null)  
if (str == null) 
```

对比

```
if (null != str)
if (null == str) 
```

我希望正数（str == null）和负数以相同的方式写入，这是我偏爱顶级集合的另一个原因。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-11T16:00:42.370

`if(a==b) {}`与 相同`if(b==a) {}`，如果 b 为空，则相同。就功能而言，这只是样式/顺序的差异，至少在 java 中是这样。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-11T16:01:48.890

```
if (null == str) {
} 
```

是来自 c/c++ 的编程习惯，其中赋值运算符`=`可用于解析真/假语句。例如在c中如果你想检查我是否可以在c/c++中打开一个流，你可以

```
if (myStream = openStream()) 
```

在一行中设置打开和分配。然而，这意味着人们经常`=`在他们的意思是 时键入`==`，这将是 c 中的有效语法：例如`if (x = 5)`，当他们真正的意思时，总是会解析为 true `if (x ==5)`。因此，人们会这样写`if (5 == x)`，如果您遗漏 a，`=`您的代码将无法编译。

这不适用于java。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-11T16:08:40.393

没有真正的区别。然而，第二个被认为不太容易出错。在第一种情况下，如果您尝试这样做，您将不会收到错误

```
String str;

if(str = null){
} 
```

这是你通常不会在条件句中做的事情。

此外，您可以先考虑实际情况，这是一个很好的做法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-09-11T05:44:47.087

一些开发人员认为这`var == null`比`null == var`. 他们的论点是您可能不小心分配了变量而不是进行空检查。

但只有当您测试的变量`null`是 a时`Boolean`，您可能会意外地使用`=`而不是，`==`它才会编译。

```
Boolean checked = Boolean.TRUE;
if(checked = null){ // accidentally assigned null and compiles
} 
```

只有在这种情况下，赋值才能编译，因为条件表达式必须计算为布尔值。见[JLS-14.9。](https://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.9)由于赋值表达式本身的计算结果为布尔类型，因此它可以编译。但是你会得到一个`NullPointerException`at runtume，因为 java 会尝试解开`checked`变量`null`.

如果您使用任何其他类型，那么`Boolean`您将收到编译器错误。例如

```
String str = "hello";
if(str = null){ // compiler error, because str = null doesn't evaluate to a boolean
} 
```

我的结论是错误情况极为罕见，您可以轻松编写检测此类错误的单元测试。

因此，以更具可读性的方式编写 if 语句。

我认为“ *if name is null ”比“* *if null is name* ”更有意义。

# java - 从接口的方法中排除类的最有效方法

> ID：10983577
> 
> 赞同：1
> 
> 时间：2012-06-11T15:55:59.097
> 
> 标签：java

到目前为止，我已经使用以下代码将某些方法的应用限制在某些类的实例中。例如，使用`ItemListener`, 但这可以应用于很多事情，

```
public class mListener implements ItemListener {
    public void itemStateChanged(ItemEvent e) {

        if (!(e.getItemSelectable instanceof JCheckBox)) { //again, JCheckBox was chosen arbirtarily
            System.err.println("mListener can only be applied to a JCheckBox");
            return;
        }

    }
} 
```

但是，在Oracle Java教程的一些地方，我看到了以下代码

```
public class mListener implements ItemListener {
    public void itemStateChanged(ItemEvent e) {
        JCheckBox box = null;

        try {
            box = (JCheckBox) e.getItemSelectable();
        } catch (ClassCastException ex) {
            System.err.println("mListener can only be applied to a JCheckBox");
            return;
        }

    }
} 
```

锁定您不希望应用方法的类的最佳方法是什么？在实现接口的情况下尤其如此，其中参数无法更改。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T15:59:25.077

在这两种情况下，这是一个*编程错误*。不恰当地添加了侦听器。对此的正确回应几乎肯定不仅仅是打印出一条可能永远不会被看到的消息——这是一个例外。

简单的强制转换会给你这个异常，你不需要做任何工作，所以只是无条件地强制转换，不要试图掩盖编程错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T15:58:44.343

第二个版本是邪恶的，因为它使用异常进行流控制。阅读[Joshua Bloch](http://java.sun.com/docs/books/effective/)的 Effective Java，了解为什么它不好（第 57 条：“仅在异常情况下使用异常”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:02:04.163

答案可能是这样的：捕获 a`ClassCastException`允许`e`成为 的任何子类`JCheckBox`，而使用 instanceof 将其仅限制为 a `JCheckBox`。

# c++ - Qt 上的上下文相关帮助

> ID：10983583
> 
> 赞同：0
> 
> 时间：2012-06-11T15:56:43.383
> 
> 标签：c++, qt, user-interface

我想要做的是，当我将鼠标指针放在任何 GUI 组件（如按钮、单选按钮等）上并按下`F1`键时，应显示相关帮助。我能够获取鼠标坐标，但无法动态获取其下方的 GUI 元素。我正在使用 Qt 4.7.4 和 Qt Creator 2.4。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:17:45.100

QApplication 中有一个方法，可能对您有用：

```
QWidget * QApplication::widgetAt ( const QPoint & point ) [static] 
```

然后你应该根据你的需要命名每个小部件。

# java - OSGi 服务跟踪器和声明式服务有什么不同

> ID：10983587
> 
> 赞同：10
> 
> 时间：2012-06-11T15:56:58.073
> 
> 标签：java, osgi

我现在正在开发 OSGi 服务，我有一个关于在 OSGi 中使用服务的问题。有一些不同的方式来注册用户服务。谁能解释 OSGi 服务跟踪器和声明式服务之间的区别？哪一个更好？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-11T16:18:03.920

在 OSGi 中，ServiceTracker 是一种获取服务引用的编程方式。即，您编写“跟踪”对另一个服务的引用的 ServiceTracker 代码，并让您在它可用时使用它。

相反，声明式服务 (DS) 允许您声明注入到组件中的依赖项。DS 是一种依赖注入的形式。服务之间的依赖关系图以及它们的启动顺序将决定您的服务何时启动。DS 定义中的基数属性允许您声明关系是强制性的 (1..1)、具有至少一个 (1..n) 的多重、可选 (0..1) 还是多重可选 (0..n ）。当您声明强制关系时，您的服务将在所有依赖项都满足之前不会启动。当您声明一个可选关系时，无论依赖项的状态如何，您的服务都将启动，但您需要注意代码中对您的服务的引用可能为空。

从实用的角度来看，ServiceTracker 是需要编写和维护的大量样板代码。鉴于 OSGi 服务的动态特性，需要考虑 OSGi 规范允许的许多状态。DS 将为您提供一种干净的方式来声明和维护您的依赖项。定义良好的依赖关系将帮助您保持运行时环境的一致性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T11:28:25.530

声明式服务 (DS) 非常易于使用，您可以避免一些与使用 ServiceTracker 相关的样板代码。如果您使用普通的 OSGI，仅使用 ServiceTracker，您需要注意 OSGI 服务的动态特性的某些方面。服务可以来来去去，您的组件需要处理它。如果您使用 DS，则大部分工作已经完成。您只需定义对其他服务的引用，DS 将在这些引用可用时注入这些引用。DS 将在满足组件要求时激活您的组件。

如果您使用 Apache Felix SCR 注释或 bndlib 提供的注释，您还可以避免编写 Declarative Services 所需的 xml。最近，OSGI 小组也发布了他们的一个注释。我认为 bndlib 提供的和 OSGI 提供的非常相似，我几乎可以肯定 bnd 工具可以同时处理两者。

前段时间我使用了 Apache SCR 注释，但现在我更喜欢使用 bndlib，因为它包含 Metatype 的注释和一些使托管服务的实现更容易的类。元类型是与托管服务相关的规范。基本上，它提供了元数据，Config Admin 实现可以使用这些元数据为组件的配置提供更加用户友好的界面。

我知道另外两种选择：iPojo 和 Blueprint。

iPojo 非常强大且功能丰富。它抽象了大部分 OSGI 内容，并包含一些不错的功能，例如 EventAdmin 支持和 ConfigAdmin 支持。

我用了一点Blueprint，但由于过度使用xml，我不太喜欢它。我想你可能会说 Blueprint 就像 OSGI 的 Spring。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-11T15:58:39.923

OSGi Service Tracker 让您可以为某些服务注册侦听器，这样您就可以在该服务可用时做出反应。

另一方面，声明式服务隐式使用服务跟踪器来延迟捆绑激活代码的执行，直到服务依赖关系得到解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T16:11:54.593

> 哪个更好？

创建和使用一些声明式服务非常简单，尤其是使用 Apache Felix SCR 注释和 Apache Felix SCR Maven 插件：

[https://felix.apache.org/site/scr-annotations.html](https://felix.apache.org/site/scr-annotations.html)

[https://felix.apache.org/site/apache-felix-maven-scr-plugin-use.html](https://felix.apache.org/site/apache-felix-maven-scr-plugin-use.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-11T13:52:02.740

所有依赖项都必须安装在带有 maven 的 NetBeans 项目中的 pom.xml 文件中。例如 org.osgi.core 将是：

```
<dependency>
    <groupId>org.osgi</groupId>
    <artifactId>org.osgi.core</artifactId>
    <version>6.0.0</version>
    <scope>provided</scope>
</dependency> 
```

# actionscript-3 - 在 ActionScript 3.0 中，当在 SWFLoader 中使用 Ookla 的 Speedtest 时，如何允许它多次加载和运行？

> ID：10983589
> 
> 赞同：0
> 
> 时间：2012-06-11T15:57:00.717
> 
> 标签：actionscript-3, flash, swfloader, speed-test

有另一个奇怪/具体的问题要问你们：我可以用其他 .swfs 来解决这个问题，但 Ookla 的 Speedtest 是个问题。基本上，我们网站的一部分运行 Speedtest 以确定某人的带宽并在某些 if 语句中使用其结果。但是当这个人试图更换面板并回来时，Speedtest 就消失了。它应该回到起点重新开始，但它就像它只是继续运行并变得隐形。

当我尝试在 SWFLoader 中加载另一个 .swf 时，我可以让它很好地重置而不会消失。Ookla 的 Speedtest 有一些特别的地方会导致问题。如果当用户开始在面板周围移动时我不采取任何措施来重置 Speedtest .swf，它至少不会消失。但是，输入代码以使其重置是完全不同的故事。

这个程序的诀窍是什么？Ookla 是否专门设计了 .swf 以使其无法像那样工作？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T12:50:57.830

显然，Ookla 设计了 ​​.swf 以防止被这样使用，这可能会让他们的客户付出代价。

# jquery - jQuery 滑块缩略图宽度

> ID：10983591
> 
> 赞同：0
> 
> 时间：2012-06-11T15:57:06.240
> 
> 标签：jquery, slider, width, thumbnails

我刚刚从这里向我的网站添加了一个 jQuery Slider：http: [//demo.tutorialzine.com/2009/11/beautiful-apple-gallery-slideshow/demo.html](http://demo.tutorialzine.com/2009/11/beautiful-apple-gallery-slideshow/demo.html)

我想将缩略图图像宽度（样式表中的菜单项）从 60 像素更改为 240 像素，因此缩略图图像占据了整个容器宽度（960 像素）。我认为这是通过编辑 CSS 进行的简单修复，但当然不是。

最好的方法是什么？我以前从未使用过 javascript 或 jQuery，但我假设可以在 script.js 表中进行编辑。有任何想法吗？先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:14:46.303

我注意到有一个`div#menu`包含所有缩略图的内容，因此，如果您不更改`div#menu`其子项的高度`li`（您要更改其大小的缩略图容器），则不会更改。所以试着先改变`div#menu`大小而不是它的孩子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:34:38.040

需要第一个 li 吗？

```
<li class="fbar inact">&nbsp;</li> 
```

如果没有，你可以删除它并尝试这个

如果您只使用这 4 个项目，您可以这样做：

```
li {
    width: 25%;
} 
```

或者使用 jQuery 更动态的东西：

```
$(".menuItem").width((100 / $(".menuItem").length) + "%"); 
```

而且，您需要编辑您的活动图像，因为它是 60 像素。

# javascript - 加载和使用 jQuery 对性能的负面影响有多大？

> ID：10983592
> 
> 赞同：3
> 
> 时间：2012-06-11T15:57:07.067
> 
> 标签：javascript, jquery

我为一家公司做了一些第三方 javascript 工作，我可以将我的 javascript 片段输入 CMS 并让它在面向客户的网站中运行。我可以选择`JQuery 1.7.1`在网站的标题中打开，我通常会选择这样做或不这样做，这取决于如果我不这样做会使我的代码复杂多少。

我经常想知道如果我在所有情况下都打开它会有多大的不同，所以即使是简单的事情，比如：

```
document.getElementById('myElement'); 
```

变成了

```
$('#myElement'); 
```

决定打开 JQuery 更好/更有效/更容易的“断点”在哪里？

今天让我想到这一点的示例如下（常规 javascript 后跟 JQuery 等效项）：

**Javascript：**

```
if (document.getElementById('myElement')!== null) {
    var oldText = document.getElementById('myElement').innerHTML,
    newText = oldText.replace(/one/i,'two');
    document.getElementById('myElement').innerHTML = newText;
} 
```

**jQuery：**

```
if ($('#myElement').length !== 0) {
    var oldText = $('#myElement').html(),
    newText = oldText.replace('one','two');
    $('#myElement').html(newText);
} 
```

强制客户端下载 jQuery 的负面影响有多大？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-11T15:58:18.207

差异很小，不值得写这 10 个字符......

> 与往常一样，请记住，作为开发人员，您的时间通常是最宝贵的资源。不要专注于优化选择器速度，除非很明显需要提高性能。

[**jQuery 网站**](http://api.jquery.com/id-selector/)

当然`jQuery`还有比 id 选择器更多的功能......

* * *

一个好的建议是缓存查询的元素而不是多次查询它们，但无论是使用原生javascript还是使用`jQuery`原生javascript都是如此；

从：

```
document.getElementBy('id').value = "foo";
document.getElementBy('id').parentNode.className = "parent"; 
```

到：

```
var element = document.getElementBy('id')
element.value = "foo";
element.parentNode.className = "parent" 
```

或 jQuery 版本：

```
var $element = $('#id');
$element.val("foo");
$element.parent().addClass("parent"); 
```

由于 jQuery “chainabilty” - 级联风格，你可以用一个“chain”来做到这一点：

```
$('#id').val("foo").parent().addClass("parent"); 
```

* * *

[这`jsperf`](http://jsperf.com/getelementbyid-vs-jquery-id)表明`$('#id')`比这慢 3-6`document.getElementById`
这意味着您每秒只能“仅”进行 1,000,000 次这些操作...... **“一场灾难”**！

**“我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源”**

* * *

**关于“加载”- jQuery 库的下载时间。**

*   当前缩小版的 jQuery (1.7.2) 大小仅为 32K，几乎可以肯定比您网站中的大多数图像小，因此可以忽略不计。
*   您可以使用 jQuery 的 google 全局缓存副本，在[这篇长博](http://encosia.com/3-reasons-why-you-should-let-google-host-jquery-for-you/)文中了解更多信息。

> 无论您的网站优化得多么好，如果您在本地托管 jQuery，那么您的用户必须至少下载一次。您的每个用户可能已经在他们的浏览器缓存中拥有数十个相同的 jQuery 副本，但是当他们访问您的站点时，这些 jQuery 副本会被忽略。
> 
> 但是，当浏览器看到对 CDN 托管的 jQuery 副本的引用时，它会理解所有这些引用确实引用了完全相同的文件。由于所有这些 CDN 引用都指向完全相同的 URL，浏览器可以相信这些文件确实是相同的，并且不会浪费时间重新请求已缓存的文件。因此，浏览器能够使用缓存在磁盘上的单个副本，而不管 CDN 引用出现在哪个站点上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-11T16:04:53.183

如果不添加 jQuery，您的普通 JS 本身可能会更有效率：

```
var obj = document.getElementById('myElement');
if (obj) {
    obj.innerHTML = obj.innerHTML.replace(/one/i,'two');
} 
```

每当您在同一个函数中多次重复相同的选择器操作时，您通常应该将其缓存到局部变量中，并且您不需要在此处使用任何其他临时变量。

仅供参考，如果您想要一个快捷方式`getElementById()`，您可以非常轻松地定义自己的快捷方式，而无需为此包含整个库。

```
window.$ = function(id) {
    return(document.getElementById(id));
} 
```

还有比 jQuery 小得多的库，可以为您提供基本的选择器操作。jQuery 本身使用 Sizzle 库，当我只需要选择器操作时，我经常使用它。

如果您使用/需要它提供的许多东西，我不会反对 jQuery。它对于 ajax 和许多 DOM 操作函数特别有用。但是，如果您的需求很简单，那么如果站点效率/速度/大小很重要，那么通常有比包含所有 jQuery 更有效的方法。

# iphone - 一条链可以beginBackgroundTaskWithExpirationHandler多少次？

> ID：10983594
> 
> 赞同：1
> 
> 时间：2012-06-11T15:57:23.113
> 
> 标签：iphone, objective-c

一条链可以beginBackgroundTaskWithExpirationHandler多少次？

查看文档，beginBackgroundTaskWithExpirationHandler 中允许的最长时间约为 10 分钟（iOS 可能随时更改）。我在 iOS 文档中也看到了这一点：“你不应该使用这种方法来让你的应用程序在移动到后台后继续运行。”

一旦第一个任务即将到期，启动一个新的 beginBackgroundTaskWithExpirationHandler 是否有效？如果是这样，iOS 是否对可以完成的时间施加任何限制？

# report-viewer2010 - 将 Visual Studio 2010 .rdlc 报告导出为 PDF 会导致字体过大

> ID：10983596
> 
> 赞同：0
> 
> 时间：2012-06-11T15:57:27.067
> 
> 标签：report-viewer2010, export-to-pdf

我有一份报告在屏幕上呈现得非常好，但是当我将它导出为 PDF 时，一个部分正在呈现巨大的字体，使其无法阅读。渲染得如此之大的部分是我设置用于存储富文本的字段，然后将其转换为 html。我自己并没有推出这个解决方案，但据我了解，它运行一个 rtftohtml 方法来渲染到屏幕上，然后它再次运行相同的方法来重新渲染到 PDF，这就是我感到困惑的原因。第一次渲染（到屏幕）看起来很完美，然后第二次渲染（到 pdf）看起来像垃圾。我在其他一些论坛上看到了一些关于这个主题的主题，但没有一个有回应，所以我希望 SO 社区有可能解决或解决这个问题！

# facebook - Facebook FQL API 返回空数组

> ID：10983598
> 
> 赞同：1
> 
> 时间：2012-06-11T15:57:31.367
> 
> 标签：facebook, facebook-fql, facebook-insights

我已确保用户拥有“read_insights”权限。我也有“manage_pages”权限。我没有收到任何令人讨厌的错误，因为它会有所帮助。

我得到的只是一个空数组。Graph API 工作得很好，每次都返回正确的数据。

FQL 不起作用，我还没有从中获得见解。要么他们有错误，要么我做错了什么。

我有这个代码来获得一些见解：

```
$('.page-entry>a').live('click', function(e) {

            e.preventDefault();
            var id = $(this).parent().attr('id');
            FB.api(
                {
                    access_token: accessToken,
                    method: 'fql.query',
                    query: 'SELECT metric, value FROM insights WHERE object_id = ' + id + ' AND metric="page_impressions" AND end_time=end_time_date("2012-06-01T07:00:00+0000") AND period=period("month")'
                },
                function(data) {
                    console.log(data);
                }
            );
        }) 
```

用户已登录，我可以正常查看他们的所有页面/应用程序。我有每个页面的 id 甚至 access_tokens。我为 FQL 尝试过，它没有用。

任何帮助表示赞赏。

# vim - 如何在切换到 vim 正常模式时自动更改键盘布局？

> ID：10983604
> 
> 赞同：15
> 
> 时间：2012-06-11T15:58:03.470
> 
> 标签：vim, keyboard-layout

有时我使用 vim 编写非美国文本，当我想在普通模式下使用任何命令时，我需要将布局更改为美国。可以自动执行吗？

PS。我可以像[这样](http://www.vim.org/scripts/script.php?script_id=3885)进行映射，但在这种情况下，命令看起来像 :ц 而不是 :w - 不漂亮且有拼写错误的风险。

**更新**

我不想使用键盘映射选项，因为我更喜欢通过 CapsLock 切换语言。我尝试为 InsertLeave 事件编写 autocmd，但失败了……

**更新 2**

可能有人知道，为什么以下不起作用？

```
function SetUsLayout()
  !setxkbmap us,ru
endfunction

autocmd InsertLeave * call SetUsLayout() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:17:27.043

```
:help langmap 
```

可能会提供您需要的所有信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T09:47:45.300

看起来，跨平台解决方案不存在......所以，在 KDE 下我使用以下内容：

```
function! SetUsLayout()
  silent !qdbus org.kde.keyboard /Layouts setLayout us > /dev/null
endfunction

autocmd InsertLeave * call SetUsLayout() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-13T11:01:45.463

对我来说，使用 qdbus 是最好的选择。我制作了一个简单但很脆弱的插件，非常适合我：[https ://github.com/ironhouzi/bikey-vim/tree/master/plugin](https://github.com/ironhouzi/bikey-vim/tree/master/plugin)

我称它为易碎的，因为如果其他人想使用它，它对它没有太大的鲁棒性。

当我使用 Vim 时，我主要需要英语，但也有一些例外。当我想用我的母语写作时，我点击'leader'-k，我的航空公司状态栏会显示我已经切换了语言。当语言不是英文时，脚本会保证每次我进入插入模式时，我的母语都是通过qdbus设置的。每次我离开插入模式时，语言都会重新设置为英语。它还支持缓冲区之间的单独设置。尽管这可能不是做事的最佳方式，但我想我会分享它，以防其他人可能会从中得到一些用处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-19T21:40:30.107

在 Ubuntu 中，我使用以下内容：

```
function! SetUsLayout()
  silent !qdbus org.gnome.SettingsDaemon.Keyboard /org/gnome/SettingsDaemon/Keyboard org.gnome.SettingsDaemon.Keyboard.SetInputSource 0 > /dev/null
endfunction

autocmd InsertLeave * call SetUsLayout() 
```

或更短

```
silent !gsettings set org.gnome.desktop.input-sources current 0 
```

# php - Twitter api：x 跟随 y 吗？

> ID：10983605
> 
> 赞同：0
> 
> 时间：2012-06-11T15:58:05.510
> 
> 标签：php, twitter

我正在寻找一个非常简单的脚本，它会告诉我一个推特用户是否关注另一个推特用户。我浏览了 twitter 开发人员文档，但找不到与我想要完成的任务相关的任何信息。

我正在寻找的一个例子在这个网站上展示：http: [//doesfollow.com/jjmpsp/rhyyysss](http://doesfollow.com/jjmpsp/rhyyysss)

我确实考虑过使用这个网站，然后检查页面是否包含字符串“yup”，但显然这不是最有效的方法。

有人对我如何完成我想做的事情有任何建议/资源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:00:50.810

好吧，我想通了。哈哈...

[https://api.twitter.com/1/friendships/show.json?source_screen_name=jjmpsp&target_screen_name=Rhyyysss](https://api.twitter.com/1/friendships/show.json?source_screen_name=jjmpsp&target_screen_name=Rhyyysss)

# asp.net-mvc - 如何在谷歌地图中获取/设置绑定框？

> ID：10983606
> 
> 赞同：0
> 
> 时间：2012-06-11T15:58:06.020
> 
> 标签：asp.net-mvc, google-maps

如何获取/设置 Google 地图的绑定框？我知道如何使用中心和缩放创建地图，但我需要一种方法来保存基于其装箱的地图视图，并稍后使用地图绑定（地图的东北和西南）重新创建相同的视图

知道我该怎么做吗？

我正在使用 MVC 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:05:25.383

您想使用返回 LatLngBounds 对象的 map.getBounds() 函数。然后，您可以使用 getNorthEast() 和 getSouthWest() 来获取所需的坐标。

```
var bounds = map.getBounds();
var NE = bounds.getNorthEast();
var SW = bounds.getSouthWest(); 
```

如果您需要将这些 LatLng 对象变成字符串（用于插入数据库或写入 cookie 或其他），只需对它们使用 toString() 函数即可。

```
strNE = NE.toString();
strSW = SW.toString(); 
```

所以让我们假设您将这些写入 cookie 或使用 Ajax 将这些写入您的数据库。一旦您稍后将它们从 cookie/DB 中取出，您就可以使用它们来设置地图的中心：

```
bounds = new google.maps.LatLngBounds(SW, NE);
map.fitBounds(bounds);  // or maybe try panToBounds() 
```

所有这些功能都记录在这里：[https ://developers.google.com/maps/documentation/javascript/reference](https://developers.google.com/maps/documentation/javascript/reference)

# c# - MVC 3 Ajax 表单失败未在 UAT 服务器上触发

> ID：10983608
> 
> 赞同：0
> 
> 时间：2012-06-11T15:58:12.853
> 
> 标签：c#, jquery, ajax, asp.net-mvc-3

我正在编写一个 MVC3 应用程序，在其中一个页面上，我带回了一个项目列表，这些项目列表显示在带有分页和排序的表格中。

但是，如果回购的记录超过一定数量，我想发布一条消息，告诉用户进一步细化他们的搜索。

`Response.StatusCode`如果满足上述条件，我已经通过更改控制器中的 来实现这一点；

```
public PartialViewResult VerbatimGridUpdate(VerbatimFormModel model)
{
    if (ModelState.IsValid)
    {
        var mod = ModelBuilder.GetVerbatimFormModel(model);

        if (mod.Verbatims.Count() > 10000)
        {
            HttpContext.Response.StatusCode = 33;
        }

        return PartialView("_VerbatimGrid", mod);
    }
    else
    {
        return PartialView(model.Verbatims); 
    }
} 
```

在我的标记中，我使用 Ajax 表单的 OnFailure 事件捕获了这个失败；

```
 function FailureLoading(ajaxContext) {
        if (ajaxContext.status == "33") {
            var ul = $("#validationSummary ul");
            $("ul").empty();
            ul.append("<li>" + "Too many records returned, please refine your search." + "</li>");
        }
    }

</script>

<div class="filters" >
    @using (Ajax.BeginForm("VerbatimGridUpdate", null, new AjaxOptions { HttpMethod= "Get", UpdateTargetId = "grid-container",  OnBegin = "StartLoading", OnSuccess = "FinishLoading", OnFailure="FailureLoading"}, new { id = "VerbatimListForm", name="VerbatimListForm" }))
    { 
```

在本地一切正常，但是一旦我部署到我们的 UAT 服务器，就不会触发失败事件并显示所有记录。我无法弄清楚为什么我会在行为上出现这种差异。任何想法都将受到欢迎。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:22:15.950

我不应该为此目的使用自定义 http 状态代码，尽管我不确定它是否正确。首先，这不是一个错误，您要做的就是向用户传达那里有更多记录（信息）。

您可以在部分视图中使用**隐藏字段**来表示此状态，并且在`onSuccess`您必须从部分视图中读取隐藏字段并根据状态更新信息给用户的方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:15:47.427

发生这种情况的原因有很多，一些常见的原因是：

*   客户端和服务器之间的不同域。

默认情况下，AJAX 调用不允许跨域访问。您可以[在此处](http://net.tutsplus.com/tutorials/javascript-ajax/quick-tip-cross-domain-ajax-request-with-yql-and-jquery/)查看此问题的一些解决方案。

*   相对路径与绝对路径。

有时您的开发服务器将类似于 `http://localhost/myController/myAction`，然后您的 UAT 将类似于`http://myUatserver/myApp/myController/myAction`.

如果您使用的是绝对根路径，`/myController/myAction`那么它将转到主机根目录并且找不到 URL。尝试在`Ajax.BeginForm()`.

您可以通过使用诸如 Firebug 或 Chrome 的开发工具之类的调试器确定 Ajax 调用的位置，并查找 XHR 调用。

# python - 我们的sql中的参数化查询

> ID：10983616
> 
> 赞同：2
> 
> 时间：2012-06-11T15:58:37.490
> 
> 标签：python, mysql, database

如果有人能告诉我是否可以在`oursql`用于与 MySQL 数据库交互的 python 模块中使用命名占位符进行参数化查询，我将不胜感激。

例如，我尝试了一种可以与 sqlite3 一起使用的查询

```
c.execute('''select * from records where id=:id''', {"id": 2}) 
```

那没起效。我在语法中得到 ProgrammingError。我想知道是否有另一种方法可以做到这一点`oursql`。

如果不可能，`oursql`您是否知道另一个可用于与 MySQL 数据库交互的 python 模块，该模块允许使用命名占位符进行参数化查询。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T19:06:11.913

oursql 文档说它使用[qmark 表示法](http://packages.python.org/oursql/tutorial.html#executing-queries)，我认为它与这种格式格式不兼容。您正在寻找支持“pyformat”的数据库 API。（请参阅“paramstyle”下的[DB API 规范。）](http://www.python.org/dev/peps/pep-0249/)

我的经验是使用[MySQLdb](http://mysql-python.sourceforge.net/MySQLdb.html)，它确实支持“pyformat”参数样式，您可以在其中编写查询：

```
c.execute("""SELECT * FROM records WHERE id = %(id)s""", {"id": 2}) 
```

# objective-c - 具有多个视图的 UIViewcontroller

> ID：10983623
> 
> 赞同：0
> 
> 时间：2012-06-11T15:58:52.590
> 
> 标签：objective-c, ios, uiviewcontroller, dealloc, multiple-views

该项目目前有一个名为“Dashboard”的 UIviewController，它充当所有应用程序的主视图。这个主视图由上面的两个子视图组成，有点像拆分视图。主（左视图）的左侧有多个按钮。右侧（右视图）将显示左侧所选按钮的内容。

当按下按钮时，它将创建一个新的视图实例，如下所示：

```
vcMySchedule_iPad *vcSchedule = [[vcMySchedule_iPad alloc] initWithNibName:@"vcMySchedule_iPad" bundle:nil];
ncDashboard = [[UINavigationController alloc] initWithRootViewController:vcSchedule];

ncDashboard.navigationBar.barStyle = UIBarStyleBlackOpaque;

ncDashboard.view.frame = self.vwRightPanel.bounds;

[self.vwRightPanel addSubview:ncDashboard.view]; 
```

问题是，当按下另一个按钮时，它将显示另一个视图，但前一个调用的内存仍然存在，并且前一个视图的 dealloc 永远不会被调用。

我没有使用拆分视图，因为左侧有一个按钮，当按下时它将左侧移动到左侧，右侧将左侧移动以完全查看。

有什么办法吗？

更新了一些图片...

主要（MainViewController）： ![在此处输入图像描述](../Images/c3a983e80ef3ba7db0da320ffed3c416.png)

压制课程目录：

```
vcCourseCatalog_iPad *vcCourse = [[vcCourseCatalog_iPad alloc] initWithNibName:@"vcCourseCatalog_iPad" bundle:nil];
ncDashboard = [[UINavigationController alloc] initWithRootViewController:vcCourse];

ncDashboard.navigationBar.barStyle = UIBarStyleBlackOpaque;

ncDashboard.view.frame = self.vwRightPanel.bounds;

[self.vwRightPanel addSubview:ncDashboard.view]; 
```

![在此处输入图像描述](../Images/350260a37e2ad94220c2e4ef4dbbb6f2.png)

当从表格中选择一行时，它会显示详细信息，如果用户按下按钮，则视图将显示为最大。

![在此处输入图像描述](../Images/ed0e20920f6b5f42ec5a2e623deb5e64.png)

我想我可能一直认为新观点是错误的。释放的对象在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:04:27.320

如果没有更多信息，我无法给出可靠的建议，但请检查以下内容：

1.  你在用ARC吗？如果*不是*，请记住您必须在释放某些内容之前显式释放所有引用。
2.  您是否在其他任何地方保留对子视图的引用？如果您仍在某处引用它（尤其是在 ARC 中），它会一直存在。循环引用在这里是邪恶的。
3.  在将子视图替换为新视图之前，您是否要从其父视图中删除子视图？你会惊讶于它如此简单的频率。

**编辑：**

针对下面的问题，关于您不使用 ARC，很明显 1) 是您的问题。您没有发布参考。在这种情况下，这里似乎很明显：

```
vcCourseCatalog_iPad *vcCourse = [[vcCourseCatalog_iPad alloc] initWithNibName:@"vcCourseCatalog_iPad" bundle:nil]; ncDashboard = [[UINavigationController alloc] initWithRootViewController:vcCourse];

ncDashboard.navigationBar.barStyle = UIBarStyleBlackOpaque;

ncDashboard.view.frame = self.vwRightPanel.bounds;

[self.vwRightPanel addSubview:ncDashboard.view]; 
```

您正在分配 a`vcCourseCatalog_iPad`和 a `UINavigationController`，而从未释放它们。理想情况下，您会自动释放 vcCourseCatalog_iPad，并在您将其换出时释放导航控制器。

您的代码应该如下所示：

```
vcCourseCatalog_iPad *vcCourse = [[[vcCourseCatalog_iPad alloc] initWithNibName:@"vcCourseCatalog_iPad" bundle:nil] autorelease];

if(ncDashboard)
{
    //do any sort of removal from views here
    //[ncDashboard.view removeFromSuperview];
    [ncDashboard release];
}
ncDashboard = [[UINavigationController alloc] initWithRootViewController:vcCourse];
ncDashboard.navigationBar.barStyle = UIBarStyleBlackOpaque;
ncDashboard.view.frame = self.vwRightPanel.bounds;

[self.vwRightPanel addSubview:ncDashboard.view]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T19:32:52.970

除了 CrimsonDiego 的回答，我建议您在文件中使用以下行：

在`.h`文件中：

```
@property (nonatomic, retain) UIView *ncDashBoard; 
```

在`.m`文件中：

```
@synthesize ncDashBoard = _ncDashBoard; 
```

然后`_ncDashBoard`只从那时起使用。这是为了确保正确设置保留计数。

# sql - 如何使用 SUM 在 sql select 中获取表中每一行的最后 15 分钟值（会话）

> ID：10983624
> 
> 赞同：0
> 
> 时间：2012-06-11T15:58:53.580
> 
> 标签：sql, sql-server

![日志分析器表 参考表](../Images/854d9e0d09bdd04b217e960895aef29c.png)

> 我想要一张桌子
> 
> 1> requestTime 2> NumberOfSessionsInLast15minutes
> 
> 如何编写查询以获取 requestTime 列相同且 NumberOfSessions 列将是过去 15 分钟的会话总和的表
> 
> 例子：
> 
> 这个 2012-06-06 00:12:00.0000 的会话数应该是 2012-06-06 00:12:00.0000 和 (2012-06-06 00:12:00.0000) - 15 分钟之间的会话总和。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:04:34.020

您可以使用子查询来检索会话数：

```
select  s1.requesttime
,       (
        select  sum(NumberOfSessions)
        from    sessions s2
        where   dateadd(minute, -15, s1.requesttime) < s2.requesttime
                and s2.requesttime <= s1.requesttime
        ) as TotalNumberOfSessions
from    sessions s1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:03:50.183

```
DECLARE
  @reportTime   DATETIME
SELECT
  @reportTime = '2012-06-06 00:12'

SELECT
  @reportTime,
  SUM(NumberOfSessions)
FROM
  yourTable
WHERE
      requestTime >  DATEADD(minute, -15, @reportTime)
  AND requestTime <= @reportTime 
```

根据您的需要和数据的确切行为混合和匹配`>=`、`>`和。`<``<=`

*（通常 15 分钟的窗口是`>= 00:00 AND < 00:15`，但您的定义与此略有不同。）*

如果您希望源表中的所有记录都使用它...

```
SELECT
  base.requestTime,
  SUM(history.NumberOfSessions)
FROM
  yourTable    AS base
INNER JOIN
  yourTable    AS history
    ON  history.requestTime >  DATEADD(minute, -15, base.requestTime)
    AND history.requestTime <= base.requestTime
GROUP BY
  base.requestTime 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:15:07.040

这是一种通用的方法，提供给定日期的 15 分钟时间段的细分：

```
DECLARE @requests TABLE(requestTime DATETIME, NumberOfSessions INT);

INSERT @requests SELECT '20120605 23:59', 2
UNION ALL SELECT '20120606 00:00', 500
UNION ALL SELECT '20120606 00:07', 400
UNION ALL SELECT '20120606 00:17', 300
UNION ALL SELECT '20120606 23:57', 500
UNION ALL SELECT '20120607 00:00', 100;

DECLARE @day SMALLDATETIME; -- this would be a stored procedure parameter
SET @day = '20120606';

;WITH n AS 
(
  SELECT TOP 96 n = DATEADD(MINUTE, 15*
  (ROW_NUMBER() OVER (ORDER BY [object_id])-1), @day)
  FROM sys.all_columns ORDER BY [object_id]
)
SELECT requestTime = n.n, SumNumberOfSessions = COALESCE(SUM(NumberOfSessions), 0)
FROM n LEFT OUTER JOIN @requests AS r
ON r.requestTime >= n
AND r.requestTime < DATEADD(MINUTE, 15, n)
GROUP BY n.n
ORDER BY requestTime; 
```

结果：

```
requestTime                SumNumberOfSessions
-----------------------    -------------------
2012-06-06 00:00:00.000    900
2012-06-06 00:15:00.000    300
2012-06-06 00:30:00.000    0
...
2012-06-06 23:30:00.000    0
2012-06-06 23:45:00.000    500 
```

# sql - 如何备份和恢复表

> ID：10983625
> 
> 赞同：1
> 
> 时间：2012-06-11T15:59:13.883
> 
> 标签：sql, sql-server, tsql, backup

在我的测试过程中，我想在运行测试之前复制同一个数据库中的几个表。测试完成后，我想用副本恢复原始表。

做这个的最好方式是什么？
我还想确保恢复所有索引和约束。

```
DECLARE @Tablename NVARCHAR(500)
DECLARE @BuildStr NVARCHAR(500)
DECLARE @SQL NVARCHAR(500)
SELECT @Tablename = 'my_Users'
SELECT @BuildStr = CONVERT(NVARCHAR(16),GETDATE(),120)
SELECT @BuildStr = REPLACE(REPLACE(REPLACE(REPLACE(@BuildStr,' 
',''),':',''),'-',''),' ','')
SET @SQL = 'select * into '+@Tablename+'_'+@BuildStr+' from '+@Tablename
SELECT @SQL

EXEC (@SQL) -- Execute SQl statement 
```

如果我使用上述方法进行复制，如何恢复。

SQL2005

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:00:35.613

就像是：

```
truncate table OriginalTable
insert into OriginalTable select * from CopiedTable 
```

根据您使用的数据库，有更快的替代方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:06:37.350

有很多方法可以做到这一点，但到目前为止，最简单的方法是简单地备份数据库，使用它，然后在完成后从备份中恢复。（[这里有说明](http://technet.microsoft.com/en-us/library/ms177429%28SQL.90%29.aspx)）

备份表当然是可行的，但这不是最简单的方法，而且一旦您开始使用多个表，它就会变得更加困难。因此，我没有解决您恢复单个表的*具体*示例，而是提供有关更好地管理测试数据的*一般建议。*

最***安全***的方法是不恢​​复原件，甚至不要触摸原件。对其进行备份，然后将其还原到新的测试服务器。（[此处的说明](http://msdn.microsoft.com/en-us/library/ms186390.aspx)）最佳实践表明，无论如何您都不应该在实时数据库上进行测试或开发工作。这也很容易，也很安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T20:43:45.497

您是否考虑过使用诸如开源 tSQLt 框架之类的 SQL Server 单元测试框架？

见[http://tsqlt.org/](http://tsqlt.org/)

tSQLt 测试在事务中运行，因此您在测试中所做的任何事情都会回滚。

它有一个“faketable”的概念，它是原始表的副本减去约束，如果这些妨碍您的测试设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-16T15:02:17.437

我认为我最近使用的脚本可能对某人有用。

要备份表，您可以使用下一个查询：

```
DECLARE @tableName nvarchar(max), @tableName_bck nvarchar(max)
SET @tableName = 'SomeTable';
SET @tableName_bck = 'SomeTable_bck';

-- Backup
DECLARE @insertCommand nvarchar(max)
--SELECT INTO SomeTable_bck FROM SomeTable
SET @insertCommand = 'SELECT * INTO ' + @tableName_bck + ' FROM ' + @tableName
PRINT @insertCommand
EXEC sp_executesql @insertCommand 
```

对于恢复，由于表通常可以有 IDENTITY 字段，因此您需要 SET IDENTITY_INSERT ON 并且在插入记录时还需要提供列列表。这就是脚本有点复杂的原因：

```
DECLARE @tableName nvarchar(max), @tableName_bck nvarchar(max)
SET @tableName = 'SomeTable';
SET @tableName_bck = 'SomeTable_bck';

-- Restore
DECLARE @columnList nvarchar(max)
DECLARE @insertCommand nvarchar(max)

SELECT
    @columnList = SUBSTRING(
        (
            SELECT ', ' + column_name AS [text()]
            From INFORMATION_SCHEMA.COLUMNS
            WHERE table_name = @tableName
            ORDER BY table_name
            For XML PATH ('')
        ), 2, 1000);

--INSERT INTO SomeTable(Column1, Column2) SELECT Column1, Column2 FROM SomeTable_bck        
SELECT @insertCommand = 'INSERT INTO ' + @tableName + '(' + @columnList + ') SELECT ' + @columnList + ' FROM ' + @tableName_bck

IF EXISTS (
    SELECT column_name, table_name
    FROM INFORMATION_SCHEMA.COLUMNS
       WHERE table_schema = 'dbo' AND table_name = @tableName
       AND COLUMNPROPERTY(object_id(table_name), column_name, 'IsIdentity') = 1
    )
BEGIN
    SET @insertCommand = 
          'SET IDENTITY_INSERT ' + @tableName + ' ON;' 
        + 'TRUNCATE TABLE ' + @tableName + ';'
        + @insertCommand + ';'
        + 'SET IDENTITY_INSERT ' + @tableName + ' OFF;' 
    /*  
    SET IDENTITY_INSERT SomeTable ON
    TRUNCATE TABLE SomeTable
    INSERT INTO SomeTable(Column1, Column2) SELECT Column1, Column2 FROM SomeTable_bck    
    SET IDENTITY_INSERT SomeTable OFF
    */
END
ELSE
BEGIN
    SET @insertCommand = 
        'TRUNCATE TABLE ' + @tableName + ';'
        + @insertCommand
    /*
    TRUNCATE TABLE SomeTable
    INSERT INTO SomeTable(Column1, Column2) SELECT Column1, Column2 FROM SomeTable_bck     
    */
END 

PRINT @insertCommand
EXEC sp_executesql @insertCommand 
```

很容易看出，您可以根据自己的喜好指定@tableName 和@tableName_bck。例如，这可以在存储过程中，因此脚本是可重用的。

# r - 组套索正则化线性回归的R实现

> ID：10983629
> 
> 赞同：2
> 
> 时间：2012-06-11T15:59:26.150
> 
> 标签：r, regression, linear-regression

有谁知道 R（甚至 Matlab）中组套索正则化线性回归的任何良好实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T12:45:23.007

CRAN 中有[grplasso](http://cran.r-project.org/web/packages/grplasso/)包，我相信这就是您正在寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:05:15.627

你看过**[GNU Octave](http://www.gnu.org/software/octave/)**吗？它在命令行上完成它的工作，因此您可以将它与任何可以读/写文件并执行 shell 命令的语言一起使用以从程序中启动它。

GNU Octave 出现在**[斯坦福机器学习课程](https://class.coursera.org/ml/lecture/preview)**的多变量线性回归一章中。

# objective-c - 多语言本地化故事板支持问题

> ID：10983630
> 
> 赞同：6
> 
> 时间：2012-06-11T15:59:27.497
> 
> 标签：objective-c, ios5

我的项目故事板有问题。我在情节提要中添加了两个本地化版本，所以现在我有了三个情节提要：西班牙语、英语和巴斯克语。所有这些都取决于主要的：

![在此处输入图像描述](../Images/ca7eba3735170619e6a39effd6ca6e62.png)

现在我有一个问题，我必须手动将所有更改更新到所有故事板，因为如果我对 MainStoryboard 进行更改，其他更改不会随着这些更改而更新。

如何同时修改所有情节提要？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T05:17:02.253

这是一个非常棒的教程，用于自动化从一个故事板本地化到所有其他本地化的更改：

[http://danielsaidi.wordpress.com/2012/08/20/localization-in-ios/](http://danielsaidi.wordpress.com/2012/08/20/localization-in-ios/)

[http://www.youtube.com/watch?v=cF1Rf02QvZQ](http://www.youtube.com/watch?v=cF1Rf02QvZQ)

据我所知，该解决方案涉及将 python 脚本添加到同步故事板并生成字符串文件的构建的末尾。

转到链接以获取更详细的解决方案。他们说得比我好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T06:37:54.890

您可以从 Storyboard 中取出所有字符串并将它们放入本地化的字符串集中。然后，您必须像这样在代码中执行所有操作：

`self.label = NSLocalizedString("LABEL_STRING", nil);`

或者您可以将 Storyboard 作为 XML 文件打开并在那里执行可能会快一点。但除此之外，不，这是不可行的，故事板本地化为您提供完善的本地化服务。假设您有一个名为“HOME”的屏幕，然后（使用谷歌翻译），您在巴斯克语中有“HASIERA”。这里的问题是，在巴斯克语中它更长，因此您需要调整 GUI 元素以使其完全适合屏幕。可能发生的情况是字符串会被切断，这是我们不希望发生的。这就是为什么您需要逐步进行 Storyboard 本地化的原因。如果您不需要它，请改用字符串文件...

# objective-c - UIManagedDocument 在后台线程中插入对象

> ID：10983632
> 
> 赞同：5
> 
> 时间：2012-06-11T15:59:29.143
> 
> 标签：objective-c, multithreading, uimanageddocument

这是我在 Stack Overflow 上的第一个问题，如果我违反了任何礼仪，请见谅。我对 Objective-C/app 创建也很陌生。

我一直在关注 CS193P 斯坦福课程，特别是 CoreData 讲座/演示。在 Paul Hegarty 的 Photomania 应用程序中，他从表格视图开始，并在后台填充数据，而不会中断 UI 流程。我一直在创建一个列出本地企业的应用程序（来自返回 JSON 数据的 api）。

我根据保罗的照片/摄影师课程创建了类别。类本身的创建不是问题，而是它们被创建的地方。

```
A simplified data structure:
- Section
    - Sub-section
        - business
        - business
        - business
    - business
    - business
    - business 
```

我的应用程序从带有几个按钮的 UIViewController 开始，每个按钮都为相应的部分打开一个表格视图（这些都工作正常，我试图提供足够的信息，以便我的问题有意义）。我调用一个辅助方法来创建/打开 UIManagedDocument 的 URL，它基于[这个问题](https://stackoverflow.com/questions/9204025)。一旦应用程序运行，它就会被调用，并且加载速度很快。

我有一个非常类似于 Paul 的 fetchFlickrDataIntoDocument 的方法：

```
-(void)refreshBusinessesInDocument:(UIManagedDocument *)document
{
dispatch_queue_t refreshBusinessQ = dispatch_queue_create("Refresh Business Listing", NULL);
dispatch_async(refreshBusinessQ, ^{
    // Get latest business listing
    myFunctions *myFunctions = [[myFunctions alloc] init];
    NSArray *businesses = [myFunctions arrayOfBusinesses];

    // Run IN document's thread
    [document.managedObjectContext performBlock:^{

        // Loop through new businesses and insert
        for (NSDictionary *businessData in businesses) {
            [Business businessWithJSONInfo:businessData inManageObjectContext:document.managedObjectContext];
        }

        // Explicitly save the document.
        [document saveToURL:document.fileURL 
           forSaveOperation:UIDocumentSaveForOverwriting
          completionHandler:^(BOOL success){
              if (!success) {
                  NSLog(@"Document save failed");
              }
          }];
        NSLog(@"Inserted Businesses");
    }];
});
dispatch_release(refreshBusinessQ);
} 
```

[myFunctions arrayOfBusinesses] 只是解析 JSON 数据并返回一个包含各个业务的 NSArray。

我在业务创建代码的开始和结束时使用 NSLog 运行代码。每个业务都分配一个版块，创建时间为 0.006 秒，其中有数百个。插入最终需要大约 2 秒。

辅助方法在这里：

```
// The following typedef has been defined in the .h file
// typedef void (^completion_block_t)(UIManagedDocument *document);

@implementation ManagedDocumentHelper

+(void)openDocument:(NSString *)documentName UsingBlock:(completion_block_t)completionBlock
{
    // Get URL for document -> "<Documents directory>/<documentName>"
    NSURL *url = [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
    url = [url URLByAppendingPathComponent:documentName];

    // Attempt retrieval of existing document
    UIManagedDocument *doc = [managedDocumentDictionary objectForKey:documentName];

    // If no UIManagedDocument, create
    if (!doc) 
    {
        // Create with document at URL
        doc = [[UIManagedDocument alloc] initWithFileURL:url];

        // Save in managedDocumentDictionary
        [managedDocumentDictionary setObject:doc forKey:documentName];
    }

    // If the document exists on disk
    if ([[NSFileManager defaultManager] fileExistsAtPath:[url path]]) 
    {
        [doc openWithCompletionHandler:^(BOOL success)
         {
             // Run completion block
             completionBlock(doc);
         } ];
    }
    else
    {
        // Save temporary document to documents directory
        [doc saveToURL:url 
      forSaveOperation:UIDocumentSaveForCreating 
     completionHandler:^(BOOL success)
         {
             // Run compeltion block
             completionBlock(doc);
         }];
    }
} 
```

并在 viewDidLoad 中调用：

```
if (!self.lgtbDatabase) {
    [ManagedDocumentHelper openDocument:@"DefaultLGTBDatabase" UsingBlock:^(UIManagedDocument *document){
        [self useDocument:document];
    }];
} 
```

useDocument 只是将 self.document 设置为提供的文档。

我想更改此代码，以便将数据插入另一个线程，并且用户仍然可以单击按钮查看部分，而数据导入不会挂起 UI。

任何帮助将不胜感激我已经在这个问题上工作了几天但无法解决它，即使这里有其他类似的问题。如果您需要任何其他信息，请告诉我！

谢谢

编辑：

到目前为止，这个问题已经收到一票反对票。如果有办法我可以改进这个问题，或者有人知道我无法找到的问题，你能否评论一下如何或在哪里？如果还有其他原因您拒绝投票，请告诉我，因为我无法理解消极情绪，并且很想学习如何做出更好的贡献。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-12T10:53:35.080

有几种方法可以做到这一点。

由于您正在使用`UIManagedDocument`，您可以利用`NSPrivateQueueConcurrencyType`for 初始化一个新的`NSManagedObjectContext`并`performBlock`用来做您的事情。例如：

```
// create a context with a private queue so access happens on a separate thread.
NSManagedObjectContext *context = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
// insert this context into the current context hierarchy
context.parentContext = parentContext;
// execute the block on the queue of the context
context.performBlock:^{

      // do your stuff (e.g. a long import operation)

      // save the context here
      // with parent/child contexts saving a context push the changes out of the current context
      NSError* error = nil;
      [context save:&error];
 }]; 
```

当您从上下文中保存时，私有上下文的数据被推送到当前上下文。保存仅在内存中可见，因此您需要访问主上下文（链接到的那个`UIDocument`）并在那里进行保存（看看[dos-a-core-data-parent-managedobjectcontext-need-to-share -a-并发类型-wi](https://stackoverflow.com/questions/8424130/does-a-core-data-parent-managedobjectcontext-need-to-share-a-concurrency-type-wi) )。

另一种方式（我最喜欢的方式）是创建一个`NSOperation`子类并在那里做一些事情。例如，声明一个`NSOperation`子类，如下所示：

```
//.h
@interface MyOperation : NSOperation

- (id)initWithDocument:(UIManagedDocument*)document;

@end

//.m
@interface MyOperation()

@property (nonatomic, weak) UIManagedDocument *document;

@end

- (id)initWithDocument:(UIManagedDocument*)doc;
{
  if (!(self = [super init])) return nil;

  [self setDocument:doc];

  return self;
}

- (void)main
{ 
  NSManagedObjectContext *moc = [[NSManagedObjectContext alloc] init];
  [moc setParentContext:[[self document] managedObjectContext]];

  // do the long stuff here...

  NSError *error = nil;
  [moc save:&error];

  NSManagedObjectContext *mainMOC = [[self document] managedObjectContext];
  [mainMOC performBlock:^{
    NSError *error = nil;
    [mainMOC save:&error];
  }];

  // maybe you want to notify the main thread you have finished to import data, if you post a notification remember to deal with it in the main thread...
} 
```

现在在主线程中，您可以将该操作提供给队列，如下所示：

```
MyOperation *op = [[MyOperation alloc] initWithDocument:[self document]];
[[self someQueue] addOperation:op]; 
```

PS 你不能在`main`a 的方法中启动异步操作`NSOperation`。完成`main`后，将不会调用与该操作关联的委托。说实话，你可以，但这涉及到处理运行循环或并发行为。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T02:09:04.870

最初我只是想发表评论，但我想我没有权限。我只是想指出 UIDocument，超出了更改计数提供的范围 `- (void)autosaveWithCompletionHandler:(void (^)(BOOL success))completionHandler`

这不应该有我在等待“方便的时刻”时更新更改计数时遇到的延迟。

# javascript - UglifyJS：连接和缩小或反之亦然？

> ID：10983636
> 
> 赞同：19
> 
> 时间：2012-06-11T15:59:34.413
> 
> 标签：javascript, deployment, uglifyjs

我正在编写一个使用许多 JS 文件的应用程序。Underscore、Backbone、jQuery、滑块的 jQuery 插件、模型、路由器、集合和视图的几个文件。

在我的开发机器中，我分别加载每个文件，但在生产中我只使用一个 JS 文件（缩小、gziped、较少的 http req 等）。

**在我的构建过程中，每个文件都用 UglifyJS 缩小，然后连接到 prod.js。这是构建该文件的正确方法吗？或者我应该将每个文件连接到 prod.js 中，然后用 UglifyJS 缩小？**

非常感谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-04-24T21:10:58.047

[我使用Gulp](http://gulpjs.com)测试了每种方法的输出。

## 测试设置

连接（未缩小）时，我使用了 9 个总计**19.15 kB**的 JavaScript 文件。每个文件都以一个`'use strict';`语句开头。

## 结果：

*   连接 => 丑化：**7.993 kB**
*   Uglify => 连接：**8.093 kB**
*   *差异：* **0.1 kB**

## 笔记：

*   Concatenate => Uglify 去除**9 个** `'use strict';`语句中的 8 个
*   Uglify => Concatenate 保留所有`'use strict';`语句
*   单个`'use strict';`语句为**13 个字节**。8 × 13 字节 = 104 字节，这说明了 0.1 kB 的差异。

## 最后的想法：

**使用您喜欢的任何顺序。**

这两个过程之间的差异**可以忽略不计**。如果以下两个都为真，则 Concatenate => Uglify 可以（理论上）产生（几乎不明显）较小的文件：

*   几个单独的文件以`'use strict';`语句开头
*   有*很多*单独的文件

* * *

这是`gulpfile.js`我使用的：

```
var gulp = require('gulp'),
  concat = require('gulp-concat'),
  uglify = require('gulp-uglify');

var files = [
  '!app/scripts/**/*Spec.js', // Exclude test files
  'app/scripts/**/*.js'
];

// Register tasks
gulp.task('concat-min', function() {
  return gulp.src(files)
    .pipe(concat('script.min.js'))
    .pipe(uglify())
    .pipe(gulp.dest('dist'));
});

gulp.task('min-concat', function() {
  return gulp.src(files)
    .pipe(uglify())
    .pipe(concat('script.min.js'))
    .pipe(gulp.dest('dist'));
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:11:51.593

如果任何一种方式都对用户请求的开销产生了重大影响，我会感到惊讶。

我还建议将所有这些框架连接到一个文件中实际上可能会*增加*每个用户的开销。

为什么？

当使用流行/通用框架（例如 jQuery 等）时，将其托管在 CDN 上（例如[Google](https://developers.google.com/speed/libraries/devguide#jqueryUI)）以从缓存文件中受益 - 如果用户访问的网站也使用了 jQuery，他们将不需要下载它！更不用说减少地理延迟。

因此，通过创建您自己的独特文件，您就更有可能让用户不得不下载整个文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:19:38.703

我强烈建议您使用[requirejs](http://requirejs.org/docs/optimization.html)，使用该库您可以制作软件包或一个最小化和统一的文件。请阅读**优化工具**。

但是，正如 Widor 告诉您的，将所有文件合并为一个并不是一个好主意。如果您总是在线使用您的应用程序，那么其中许多库使用 google api (CDN) 性能会更好

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T16:45:46.700

我总是将它们全部合二为一，然后缩小。

我开始做的一件事是通过[http://www.javascriptobfuscator.com/](http://www.javascriptobfuscator.com/)运行它，首先我知道这听起来很直观，但它所做的一件事是将所有字符串存储在一个数组中，一个丑陋的数组，但停止字符串重复然后当你去你的缩小，我使用谷歌闭包编译器然后它会整理字符串，你通常会得到一个更好的缩小文件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T10:20:46.067

它不会有太大的区别，因为顶层语句（和变量等）没有被触及。

但是，当使用该`--lift-vars`选项时，它可能会发生变化。这在很大程度上取决于您的代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-21T12:07:58.777

假设您的全局变量较少，订单就无关紧要了。文件大小差异非常小。我个人的偏好是先 Concatenate，然后是 Uglify，这样您就可以生成更好、更准确的源图，而不是其他方式。（这是因为源映射随每次转换而变化）。我想知道丑化小文件然后连接的目的是什么。基本上，这取决于您，选择权在您手中。连接和丑化似乎更令人满意且不易出错

# ios - 如何实现 setNeedsReload / setNeedsRefresh

> ID：10983645
> 
> 赞同：0
> 
> 时间：2012-06-11T15:59:56.300
> 
> 标签：ios, uiview, refresh

我一直想知道用`setNeedsRefresh`我自己的一种方法扩展 UIView - 一种行为类似于`setNeedsLayout`但`setNeedsDisplay`目的是刷新/重新加载可见数据、隐藏视图等的方法。我的目标是：

1.  能够将方法（尤其是 setter）从必须立即刷新视图中分离出来。
2.  能够标记视图以进行刷新，而不是手动刷新它（以优化代码执行并拥有更清晰的代码架构）。

我希望能够以一种可以调用`setNeedsRefresh`任何视图的方式扩展 UIView，并`refreshView`在重绘发生之前让它执行或执行一些类似的方法。

PS：通过`setNeedsLayout`+刷新标志来处理这个问题的最好方法是什么？

**更新#1：**以下是我想要做的一个例子：

```
-(void)setAvailableForPurchase:(BOOL)availableForPurchase
{
    if (_availableForPurchase != availableForPurchase)
    {
        _availableForPurchase = availableForPurchase;
        [self setNeedsRefresh];
    }
} 
```

接着：

```
-(void)refreshView
{
    if (self.isAvailableForPurchase)
    {
        self.someView.image = someImage;
        self.someButton.enabled = yes;
        // more code, changes several objects
    }
    else
    {
        // some other code...
    }
} 
```

这个例子是一个非常简单的例子，目的是为了更好地表达我的要求——我需要/想要这样做的原因列在我最初的问题中。

# javascript - Handlebars.js 未捕获的 TypeError

> ID：10983653
> 
> 赞同：0
> 
> 时间：2012-06-11T16:00:36.737
> 
> 标签：javascript, requirejs, handlebars.js

我正在使用带有预编译模板的 Handlebars.js。我有以下代码（在第一行使用 JQuery）：

```
$('#'+id).append('<script src="'+widgetContext.templateDir+
                                             template+'.tmpl">');
console.log(Handlebars);
console.log(Handlebars.templates);                                       
var html = Handlebars.templates[template](data); 
```

我在控制台得到以下信息：

![在此处输入图像描述](../Images/fa3cce58cfabd6fba9622e8ccf0075b3.png)

'widget_container' 模板文件肯定存在于指定的位置。我也尝试过标准的handelbars.js 和handelbars.runtime.js。

知道这里发生了什么或如何修复错误吗？

更新：如果 HTML 与 javascript 文件和模板在同一个域中，它似乎可以工作，但如果不是，那么它与相同的源策略有关吗？我在这里尝试使用车把 require.js 插件[https://github.com/SlexAxton/require-handlebars-plugin](https://github.com/SlexAxton/require-handlebars-plugin)但无法正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T13:51:03.480

我使用以下方法解决了这个问题：

*   require.js 的文本插件并将车把模板加载为文本文件
*   r.js 的 optimizeAllPluginResources 构建选项
*   获取最近更新的 require.js/r.js 版本，它修复了 optimizeAllPluginResources 构建选项的错误
*   一个相当可怕的使用 eval 来运行模板文件代码 - 仍然可以避免这种情况

不过，仍然不太确定未定义的 Handlebars.templates 到底发生了什么。

# java - 恢复时 Android 崩溃。如何解释这个异常？

> ID：10983662
> 
> 赞同：8
> 
> 时间：2012-06-11T16:01:05.583
> 
> 标签：java, android

我收到了几份类似这样的崩溃报告，但我不确定这是什么意思。只是为了说清楚 - 这是我无法重现的东西。这是由 ACRA 报告的

'在偏移量 1232 处解组未知类型代码 2131296357'

下面的完整错误堆栈跟踪：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.idatt/com.idatt.activities.NewMailActivity}: java.lang.RuntimeException: Parcel android.os.Parcel@40651010: Unmarshalling unknown type code 2131296357 at offset 1232
 at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
 at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
 at android.app.ActivityThread.access$1500(ActivityThread.java:117)
 at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
 at android.os.Handler.dispatchMessage(Handler.java:99)
 at android.os.Looper.loop(Looper.java:130)
 at android.app.ActivityThread.main(ActivityThread.java:3687)
 at java.lang.reflect.Method.invokeNative(Native Method)
 at java.lang.reflect.Method.invoke(Method.java:507)
 at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
 at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
 at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.RuntimeException: Parcel android.os.Parcel@40651010: Unmarshalling unknown type code 2131296357 at offset 1232
 at android.os.Parcel.readValue(Parcel.java:1913)
 at android.os.Parcel.readSparseArrayInternal(Parcel.java:2112)
 at android.os.Parcel.readSparseArray(Parcel.java:1568)
 at android.os.Parcel.readValue(Parcel.java:1903)
 at android.os.Parcel.readMapInternal(Parcel.java:2083)
 at android.os.Bundle.unparcel(Bundle.java:208)
 at android.os.Bundle.getSparseParcelableArray(Bundle.java:1167)
 at com.android.internal.policy.impl.PhoneWindow.restoreHierarchyState(PhoneWindow.java:1682)
 at android.app.Activity.onRestoreInstanceState(Activity.java:844)
 at android.app.Activity.performRestoreInstanceState(Activity.java:816)
 at android.app.Instrumentation.callActivityOnRestoreInstanceState(Instrumentation.java:1096)
 at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1629)
 ... 11 more
java.lang.RuntimeException: Parcel android.os.Parcel@40651010: Unmarshalling unknown type code 2131296357 at offset 1232
 at android.os.Parcel.readValue(Parcel.java:1913)
 at android.os.Parcel.readSparseArrayInternal(Parcel.java:2112)
 at android.os.Parcel.readSparseArray(Parcel.java:1568)
 at android.os.Parcel.readValue(Parcel.java:1903)
 at android.os.Parcel.readMapInternal(Parcel.java:2083)
 at android.os.Bundle.unparcel(Bundle.java:208)
 at android.os.Bundle.getSparseParcelableArray(Bundle.java:1167)
 at com.android.internal.policy.impl.PhoneWindow.restoreHierarchyState(PhoneWindow.java:1682)
 at android.app.Activity.onRestoreInstanceState(Activity.java:844)
 at android.app.Activity.performRestoreInstanceState(Activity.java:816)
 at android.app.Instrumentation.callActivityOnRestoreInstanceState(Instrumentation.java:1096)
 at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1629)
 at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
 at android.app.ActivityThread.access$1500(ActivityThread.java:117)
 at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
 at android.os.Handler.dispatchMessage(Handler.java:99)
 at android.os.Looper.loop(Looper.java:130)
 at android.app.ActivityThread.main(ActivityThread.java:3687)
 at java.lang.reflect.Method.invokeNative(Native Method)
 at java.lang.reflect.Method.invoke(Method.java:507)
 at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
 at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
 at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T21:13:42.330

在模拟器上，应该有一个开发工具应用程序。打开该应用程序，从列表中选择“开发设置”，然后选中“立即销毁活动”旁边的框。现在，当您运行您的应用程序时，当您点击主页按钮时，前台 Activity 将被销毁。然后，您可以通过长按或从应用程序屏幕重新启动您的应用程序以重新创建错误。

# macos - 此目录中的 ExecCGI 已关闭

> ID：10983663
> 
> 赞同：1
> 
> 时间：2012-06-11T16:01:07.423
> 
> 标签：macos, apache, cgi

我正在尝试在我的 Mac 的网络服务器上运行 python cgi 脚本。每次我访问文件 @ localhost/site.py 时都会收到 403 禁止错误。

我正在查看我的 Apache 的错误日志，它说：

```
[Mon Jun 11 09:52:42 2012] [error] [client ::1] Options ExecCGI is off in this directory: /Users/<username>/Sites/site.py 
```

我已经更改了我的 httpd.conf 文件，因此我的文档根目录是 /Users//Sites

在我的用户的 .conf 文件中，我有以下内容：

```
<Directory "/Users/<username>/Sites/">
  Options All
  AllowOverride All
  Order allow,deny
  Allow from all
  AddHandler cgi-script .py
</Directory> 
```

当我允许用户的 .conf 文件中的所有选项时，为什么它告诉我 ExecCGI 已关闭？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T14:59:54.507

您可能必须为 httpd.conf 指定和/或添加脚本别名

这就是我在窗户上的样子。

```
<IfModule alias_module>
    #other comments removed
    ScriptAlias /cgi-bin/ "C:/Program Files/Apache Software Foundation/Apache2.2/cgi-bin/"

</IfModule> 
```

# quartz-scheduler - 石英调度器集群

> ID：10983666
> 
> 赞同：2
> 
> 时间：2012-06-11T16:01:26.020
> 
> 标签：quartz-scheduler

我有一个 2 节点 HA 服务器。节点 1 处于活动状态，节点 2 处于备用状态。

我做了一个应用程序并使用石英 api 进行聚类。我已经在数据库中创建了所有表。

现在我是否需要在两个节点或 jst 节点 1 中运行该模块，以便当节点 1 关闭时，应用程序会自动在节点 2 中启动。

在两个节点中运行模块时，触发器和作业名称应该相同还是不同？

## 石英属性：

org.quartz.threadPool.class = org.quartz.simpl.SimpleThreadPool

org.quartz.threadPool.threadCount = 10

org.quartz.threadPool.threadPriority = 5

org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread = true

-- 使用 RAMJobStore

-- 如果使用 RAMJobStore，请务必注释掉

-- org.quartz.jobStore.tablePrefix, org.quartz.jobStore.driverDelegateClass, org.quartz.jobStore.dataSource

-org.quartz.jobStore.class = org.quartz.simpl.RAMJobStore

-- 使用 JobStoreTX

-- 确保首先运行适当的脚本（在 docs/dbTables 下）来创建数据库/表

org.quartz.jobStore.class = org.quartz.impl.jdbcjobstore.JobStoreTX

-- 使用 DriverDelegate

org.quartz.jobStore.driverDelegateClass = org.quartz.impl.jdbcjobstore.StdJDBCDelegate

--新的集群配置

org.quartz.jobStore.isClustered = true

org.quartz.jobStore.clusterCheckinInterval = 20000

org.quartz.scheduler.instanceId = AUTO

org.quartz.scheduler.instanceId = AUTO

org.quartz.scheduler.instanceName = MyClusteredScheduler

-- 使用表前缀配置 JDBCJobStore

org.quartz.jobStore.tablePrefix = QRTZ_

-- 使用数据源

org.quartz.jobStore.dataSource = qzDS

-- 定义要使用的数据源

org.quartz.dataSource.qzDS.driver = oracle.jdbc.driver.OracleDriver

org.quartz.dataSource.qzDS.URL = jdbc:oracle:thin:@10.172.16.147:1521:emadb0

org.quartz.dataSource.qzDS.user = BLuser

org.quartz.dataSource.qzDS.password = BLuser

org.quartz.dataSource.qzDS.maxConnections = 30

## ----------------------

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:12:21.640

根据：http: [//quartz-scheduler.org/documentation/quartz-2.x/configuration/ConfigJDBCJobStoreClustering](http://quartz-scheduler.org/documentation/quartz-2.x/configuration/ConfigJDBCJobStoreClustering)

尤其是 ：

> 集群目前仅适用于 JDBC-Jobstore（JobStoreTX 或 JobStoreCMT），并且本质上是通过让集群的每个节点共享相同的数据库来工作的。
> 
> 负载平衡会自动发生，集群的每个节点都会尽快触发作业。当触发器的触发时间发生时，获取它的第一个节点（通过对其加锁）就是将触发它的节点。

您应该启动所有节点，最快的将触发作业，其他人会知道它。

# autoit - AutoIt - 导航到不允许直接链接的 ASP 页面

> ID：10983672
> 
> 赞同：0
> 
> 时间：2012-06-11T16:01:39.420
> 
> 标签：autoit

任何人都可以“翻译”如何使用 AutoIt 而不是 Simpletest 来做到这一点吗？

[不允许直接链接的 asp 站点上的简单测试浏览器 (php)](https://stackoverflow.com/questions/6284003/simpletest-browser-php-on-an-asp-site-that-doesnt-allow-direct-linking)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T07:22:36.397

以下是您的操作方法：

```
#include <IE.au3>

$URL="http://www.acgme.org/adspublic/"
$MyIExplorer=_IECreate($URL,1,1,1,1)

Local $theFrame = _IEFrameGetObjByName($MyIExplorer,"control")

_IELinkClickByText($theFrame, "Sponsoring Institutions")

_IELoadWait($theFrame)
ConsoleWrite(_IEBodyReadHTML($theFrame)) 
```

# php - 如何使用一个参数从 PHP 中的 url 中识别 variables_x 列表？

> ID：10983675
> 
> 赞同：0
> 
> 时间：2012-06-11T16:01:50.957
> 
> 标签：php, mysql, parsing, parameters

我有一个会员网站，用户可以获得多达 7 个网页模板来展示他们的产品。每个模板具有相同的字段名称，分别以_1、_2..._7 结尾。

例如：

```
// Template 1 would have the following list of variables
product_name_1
product_descript_1
product_color_1
product_price_1

// Template 2 would have the following list of variables
product_name_2
product_descript_2
product_color_2
product_price_2

// through Template 7 
```

通过使用在 url 中标识他们的 user_id 的查询字符串，我可以在网页中显示特定用户的任何变量，即

```
http://domain.com/folder/page.php?id=78 
```

然后我通过简单地在 PHP 文件中识别它来 $_Get 任何变量，即

```
$product_name_1
$product_descript_1
$product_color_1
$product_price_1 
```

我的问题是 url 必须标识 WHICH 模板，因为每个模板都标识一个特定的产品，即 _1、_2、..._7。如何在url中使用参数，比如

```
http://domain.com/folder/page.php?id=78&parameter=_7 
```

...识别所有以 _7 结尾的变量，它们会出现在网页中吗？url中使用的参数将标识网页中要使用的变量，无论是_1、_2等。

**更新**

我已经尝试了各种答案，但只有部分成功，即`Array_x`在使用任何特定变量以及建议的代码时会显示“”。可能与我在page.php中使用的其余代码有冲突，如下：

```
$db_connection = new mysqli("", "", "");
if ($db_connection->connect_errno) {
   echo "Failed to connect to MySQL: (" . $mysqli->connect_errno . ") " . $mysqli->connect_error;
}

$id = $_GET['id']; 
$query = mysql_query("SELECT * FROM table_name WHERE id = '$id' LIMIT 1") or die(mysql_error()); 
$row = mysql_fetch_object($query);

$prop_address=array(
"_1"=>"prop_address_1",
"_2"=>"prop_address_2",
"_3"=>"prop_address_3"
//Through to Temp 7
);

$prop_address{$_GET['parameter']}=$row->prop_address;

    echo " $prop_address{$_GET['parameter']} "; 
```

"Array_x" 显示（其中 x=1, 2, 3 等用作 url 中的参数，即[http://domain.com/page.php?id=72¶meter=1](http://domain.com/page.php?id=72&parameter=1)），而不是实际保存的值的数据库表`$product_name{$_GET['parameter']}`。由于某种原因，代码没有从数据库表中获取变量的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:07:56.607

是否可以使用数组，所以...

```
$product_name=array(
    "1"=>"Product name for template 1",
    "2"=>"Product name for template 2"
    //Through to Temp 7
);
echo $product_name[$_GET["parameter"]]; 
```

然后，您可以对其他变量执行相同的操作。

您可以通过执行以下操作来填充每个数组：

```
$row = mysql_fetch_object($query);
$product_name[$_GET['parameter']]=$row->product_name;
echo $product_name[$_GET['parameter']]; 
```

我可能会遗漏一些东西...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:06:05.097

```
$_GET['parameter'] = '_2';
$product_name{$_GET['parameter']} = 'string';
echo $product_name_2; // string 
```

或者

```
$_GET['parameter'] = '_2';
$var = 'product_name'.$_GET['parameter'];
$$var = 'string';
echo $product_name_2; // string 
```

就个人而言，我会使用数组来处理这种类型的行为。

**更新：**

尽管上述工作和测试都可以，但它比任何人都可能想要的要多得多。

为了简单起见，我建议通过数组的方法。

```
$templates = array(2 => array(
        'product_name' => "value",
        'product_descript' => "value",
        'product_color' => "value",
        'product_price' => "value",
    );

foreach($templates[substr($_GET['parameter'],1)] as $var => $val){
    $variable = $var.$_GET['parameter'];
    $$variable = $val;
} 
```

以上是向后兼容的，它使用 substr 从参数中删除前导 _ 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-19T14:41:44.793

我无法得到任何工作的答案。[我在此处](http://php.net/manual/en/language.variables.variable.php)的 PHP 手册中找到了用户为 php 变量变量提供的示例，并发现它可以工作。我将它合并到我的代码中，如下所示：

```
 $id = $_GET['id']; 
  $query = mysql_query("SELECT * FROM table_name WHERE id = '$id' LIMIT 1") or die(mysql_error()); 
  $row = mysql_fetch_object($query);

  for( $i = 1; $i < 8; $i++ )
  {
  $product_name[$_GET['parameter']] = "product_name_" . $i; 
  $product_descript[$_GET['parameter']] = "product_descript_" . $i; 
  $product_color[$_GET['parameter']] = "product_color_" . $i; 
  $product_price[$_GET['parameter']] = "product_price_" . $i; 
  }
  ${$product_name[1]}  = "$row->product_name_1"; 
  ${$product_name[2]}  = "$row->product_name_2"; 
  ${$product_name[3]}  = "$row->product_name_3"; 
  ${$product_name[4]}  = "$row->product_name_4"; 
  ${$product_name[5]}  = "$row->product_name_5"; 
  ${$product_name[6]}  = "$row->product_name_6"; 
  ${$product_name[7]}  = "$row->product_name_7"; 

  // List 7 variables and values for each field name

  echo "${$prop_name[$_GET['par']]}"; 
```

唯一的问题是此代码可以进行 mysql 注入。如果有人可以提出解决方案，我将不胜感激。

# html - 打印 HTML 表格时丢失列宽

> ID：10983686
> 
> 赞同：8
> 
> 时间：2012-06-11T16:02:23.367
> 
> 标签：html, css, printing

我有一个仅用于打印的页面（并因此设置样式）。当我在浏览器中查看页面时，列宽与我设置的一样：

```
<table>
<col width="20%">
<col width="25%">
<col width="5%">
<col width="10%">
<col width="17%">
<col width="15%">
<col width="8%">
<thead>
      header columns
</thead>
<tbody>
      columns
</tbody>
</table> 
```

但是，当我打印页面时，列的宽度都是相同的。我可以在打印时将列设置为百分比（或根本没有）吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-11T16:03:47.267

尝试使用`<table style="table-layout: fixed;">`.

这将强制表格使用指定的宽度。

`min-width`从历史上看，表格列的宽度一直是浏览器的“建议”，在某种程度上更像是一个“建议” 。设置`table-layout: fixed`将规避这一点。

# c# - 通过 C# 中的特殊快捷方式打开窗口

> ID：10983688
> 
> 赞同：4
> 
> 时间：2012-06-11T16:02:32.433
> 
> 标签：c#, wpf, shortcut, tray

> **可能重复：**
> [如何使用 WPF 和 .NET 3.5 注册全局热键以说出 CTRL+SHIFT+(LETTER)？](https://stackoverflow.com/questions/48935/how-can-i-register-a-global-hot-key-to-say-ctrlshiftletter-using-wpf-and-ne)
> [使用 C# 设置全局热键](https://stackoverflow.com/questions/2450373/set-global-hotkeys-using-c-sharp)

我有一个 WPF 应用程序，通过单击关闭按钮或单击最小化按钮，它会隐藏，但它仍然在托盘图标中保持打开状态。我想知道如何使用特殊快捷方式打开应用程序窗口，例如按 Shift+Start。Babylon 通过 F10 做同样的事情。

注意：我想在 WPF 中做到这一点，谢谢

# linq - 使用 LINQ 更新数据库中的行 - 复制的对象

> ID：10983693
> 
> 赞同：0
> 
> 时间：2012-06-11T16:02:45.503
> 
> 标签：linq, linq-to-sql

```
var queryResult = this.kindergardenDataContext.Groups.Where(g => g.group_id == groupToAdd.group_id && g.group_enabled==true);
                if (queryResult != null && queryResult.Count() != 0)
                {

                    Group groupToEdit = queryResult.First();

                    groupToEdit.group_name = groupToAdd.group_name;
                    groupToEdit.group_create_date = groupToAdd.group_create_date;
                    groupToEdit.Kindergarden = groupToAdd.Kindergarden;
                    groupToEdit.GroupGuardian = groupToAdd.GroupGuardian;
                    groupToEdit.Room = groupToAdd.Room;     

                }
                this.kindergardenDataContext.SubmitChanges(); 
```

你好。我是 LINQ 的初学者。这里没问题，但是 foreigns 键 kindergarden、groupguardian、room 已在数据库中重复（在 kindergarden、groupguardian、room 表中的数据库中添加了新行）。如何设置好的参考来更新组表中的行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T19:14:48.047

除非您检索`groupToAdd.Kindergarden`到 groupToAdd.GroupGuardian `, and`groupToAdd.Room `from`this.kindergardenDataContext` 或使用正确的 ID 设置附加它们，否则这是预期的行为。它不知道您指的是已经存在于数据库中的相同对象实例。

# mysql - mysql时间比较

> ID：10983699
> 
> 赞同：3
> 
> 时间：2012-06-11T16:03:13.803
> 
> 标签：mysql

我有 job_start 和 job_end 时间，timediff 会给我时差。现在我想看看这项工作是否花费了超过 2 小时 30 分钟。我如何比较它？如果我这样做，我会得到错误：

```
timediff(job_start,job_end)> '2:30:00'    
timediff(job_start,job_end)> time(2:30:00)   
timediff(job_start,job_end)> time_format(2:30:00) 
```

上述语法均无效。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-11T16:10:04.783

[来自函数TIMESTAMPDIFF](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_timestampdiff)的 mysql 文档：

结果的单位（整数）由 unit 参数给出。unit 的合法值与 TIMESTAMPADD() 函数描述中列出的值相同。

应该是以下值之一：MICROSECOND（微秒）、SECOND、MINUTE、HOUR、DAY、WEEK、MONTH、QUARTER 或 YEAR。

结果是整数。我推荐MINUTE：

```
TIMESTAMPDIFF(MINUTE, job_start, job_end) > 150 
```

(2 * 60 + 30) 分钟 = 150 分钟 = 2.5 小时

# objective-c - 如何在过渡时不停止动画的情况下过渡到 modalViewController

> ID：10983700
> 
> 赞同：2
> 
> 时间：2012-06-11T16:03:14.473
> 
> 标签：objective-c, ios, uiviewcontroller, core-animation, uiviewanimation

我注意到，如果我在控制器“A”的某个元素上启动 UIView 动画并呈现带有过渡的控制器 B，则之前提交的动画不会启动。例如：

```
//apply a UIView animation before transitioning
[UIView animateWithDuration: 1 delay:0 options:UIViewAnimationOptionCurveEaseOut             animations:^{
        someUIView.frame = newFrame;
 }completion:nil];
//transition from  controller A to controller B
controllerB.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
[self presentModalViewController: controllerB animated:YES]; 
```

如果动画已经开始并且我尝试转换到控制器 B，则 A 中的动画将停止。我注意到这种行为取决于使用的转换类型。例如，如果使用“UIModalTransitionStyleCoverVertical”，则不会出现问题。有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-05T14:51:27.680

只需从动画完成块中展示您的控制器B

```
[UIView animateWithDuration: 1 
                      delay:0
                    options:UIViewAnimationOptionCurveEaseOut
                 animations:^{
                     someUIView.frame = newFrame;
                }completion:^{
                   //transition from  controller A to controller B
                   controllerB.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
                   [self presentModalViewController: controllerB animated:YES];
 }]; 
```

# java - 关于 Java 垃圾收集，需要澄清

> ID：10983702
> 
> 赞同：2
> 
> 时间：2012-06-11T16:03:21.410
> 
> 标签：java, garbage-collection

在 之后`new A()`，我们分配足够的内存来保存`A`包含的所有对象。

对象`A()`可能包含其他对象，例如`B()`和`C()`

**问题 1：**什么时候`A()`不再需要并且你想从堆中删除它，设置它的引用来`null`解决问题吗？（如果不是，那么**现在**`JVM`向该`GC`对象发出信号的正确方法是什么？）

 ****问题 2：**如果是这样，指向`B()`和的实例会发生什么情况？`C()`

**问题3：**有没有办法可以观察到这种效果？（内存被释放以释放对象）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:06:40.563

将 A 设置为 null 会将 A 标记为要被 GC 释放的候选对象。如果对这些实例的唯一引用来自实例 A，则 B 和 C 的实例也将被标记。

**编辑问题 3：**调试此效果的一种简单方法是使用方法`finalize`；当一个对象被 GC'ed 时，他的`finalize`被调用。

但是，请注意这个方法：finalize 不能保证总是被执行（因为 GC 不能保证释放一个对象）并且不应该被用于应用程序的一般目的。

根据您的 IDE，有更好的调试工具。例如在eclipse中：[http ://www.yourkit.com/docs/80/help/garbage_collection.jsp](http://www.yourkit.com/docs/80/help/garbage_collection.jsp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T16:04:19.950

如果您有实时参考`B`，`C`那么它不会被 GCed

在任何时候，如果任何对象都没有对其的实时引用，则该对象已准备好进行 GC

```
class A{
 B b = new B();
 C c = new C();
} 
```

现在当你做

```
A a = new A();
a= null;//instance referred by a,b & c are ready to be collected in this system 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T16:08:06.797

> 对象 A() 可能包含其他对象，例如 B() 和 C()

对象只包含原语和对其他对象的引用。

> 问题 1：当不再需要 A() 并且您想将其从堆中删除时，将其设置为 null 的引用是否有效？

很少需要，但您可以这样做。

> 问题 2：如果是这样，指向 B() 和 C() 的实例会发生什么情况

没什么，它们是不相关的对象。

> 问题3：有没有办法可以观察到这种效果？（内存被释放以释放对象）

您可以覆盖该`finalize()`方法或使用 ReferenceQueues。这只会通知您收集的对象而不是丢弃对象。最好避免需要这样做。

* * *

可以收集没有来自根上下文（例如线程堆栈）的强引用的对象。这无关紧要。设置对 null 的引用可以允许这种情况发生，但更常见的是，允许变量超出范围是丢弃对象的更简单方法。

如果您有对象 B 并且它指向指向 B 的 C 并且没有对这些对象的其他引用，即使有对这些对象的引用，它们仍将被清除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T16:06:00.400

您不能强制 GC 删除对象。GC 会自动删除任何可以安全删除的对象。您可以通过调用强制 GC 运行`System.gc()`，这将删除它可以删除的任何对象。

`A = null`仅当不存在对该对象的其他引用时才会删除该对象。

一般来说GC是存在的，所以你不必担心删除和内存收集。如果一个东西可以安全地删除，它最终会是。

`B()`如果停止指向它们并且是唯一指向它们的东西，`C()`则将被删除。`A``A`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-11T16:07:56.467

1.  如果将其设置为 null，那么是的，它是一个信号，可以在`GC`需要内存时释放内存。但这只有在没有更多实例引用该对象时才会发生。

2.  如果仍然有实例引用一个对象，则在完全没有引用该对象的实例之前，它不会被 GC-ed。所以 B() 和 C() 只有当 A() 是唯一引用它们的时候才会被 GC-ed。

3.  通过使用 Java 使用 Scanner 读取一个巨大的文本文件（大约 3mb），然后关闭并丢弃 Scanner，并在完成后调用 System.gc()，可以很容易地观察到这种效果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-11T16:10:34.620

如果您取消对 A 的所有引用，并且如果没有其他对 B 和 C 的实时引用，那么当 GC 运行时，这些引用也将被 GC。

调用`System.gc()`并不能保证 gc 会立即运行。它可能会或可能不会运行，根本无法保证。

```
And There is no guaranteed way to force gc run immediately as you request it. 
```

是的，您可以看到 gc 运行释放内存时的效果。

要查看有关堆/内存使用情况的可视化图形/信息...，您可以使用 jdk 工具，在以下位置找到适用于 Windows 的信息：

```
JAVA_HOME\bin\jconsole.exe 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-11T16:57:27.023

它是规则的拇指，`that when an object has NO reference attached to it, its a toast for the Garbage collector to eat.`

将 A 标记为 null 将使 A 成为 GC 的祝酒词。如果指向 A 的引用是对 B 和 C 的唯一引用，那么这两个也是垃圾收集的候选对象

finalize 是对象类方法，当对象被垃圾回收时调用。**

# python - 如何在 Python 中获取最新目录

> ID：10983705
> 
> 赞同：3
> 
> 时间：2012-06-11T16:03:45.083
> 
> 标签：python, operating-system, directory

我正在寻找一种可以找到在另一个目录中创建的最新目录的方法我唯一的方法是`os.listdir()`，但它显示了里面的所有文件和目录。如何仅列出目录以及如何访问目录的属性以找出最新创建的目录？谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-11T16:20:02.110

```
import os
dirs = [d for d in os.listdir('.') if os.path.isdir(d)]
sorted(dirs, key=lambda x: os.path.getctime(x), reverse=True)[:1] 
```

**更新：**

也许更多的解释：

`[d for d in os.listdir('.') if os.path.isdir(d)]`

是一个列表理解。[你可以在这里](http://docs.activestate.com/activepython/3.1/diveintopython3/html/comprehensions.html#listcomprehension)阅读更多关于它们的信息

代码的作用与

```
dirs = []
for d in os.listdir('.'):
    if os.path.isdir(d):
        dirs.append(d) 
```

可以，但列表理解被认为更具可读性。

`sorted()`是一个内置函数。一些例子在[这里](http://wiki.python.org/moin/HowTo/Sorting/)

我展示的代码通过 o​​s.path.getctime(ELEMENT) 对 dirs 中的所有元素进行反向排序。结果又是一个列表。当然可以使用`[index]`语法和[切片访问](https://stackoverflow.com/questions/509211/good-primer-for-python-slice-notation)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-11T16:25:17.210

这是我编写的一个小函数，用于返回最新目录的名称：

```
#!/usr/bin/env python

import os
import glob
import operator

def findNewestDir(directory):
    os.chdir(directory)
    dirs = {}
    for dir in glob.glob('*'):
        if os.path.isdir(dir):
            dirs[dir] = os.path.getctime(dir)

    lister = sorted(dirs.iteritems(), key=operator.itemgetter(1))
    return lister[-1][0]

print "The newest directory is", findNewestDir('/Users/YOURUSERNAME/Sites') 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-11T16:08:56.187

以下 Python 代码应该可以解决您的问题。

```
import os
import glob
for dir in glob.glob('*'):
  if os.path.isdir(dir):
    print dir,":",os.path.getctime(dir) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T16:31:22.113

查看[`os.walk`](http://docs.python.org/library/os.html#os.walk)文档中的示例以获得获取目录的简单方法。

```
root, dirs, files = os.walk('/your/path').next() 
```

然后检查[`os.path.getctime`](http://docs.python.org/library/os.path.html#os.path.getctime)哪些取决于您的操作系统可能是创建或修改时间。如果您还不熟悉它，您还需要继续阅读[`os.path.join`](http://docs.python.org/library/os.path.html#os.path.join)。

> os.path. **getctime** (path) 返回系统的 ctime，在某些系统（如 Unix）上是最后一次更改的时间，而在其他系统（如 Windows）上，是路径的创建时间。

```
max((os.path.getctime(os.path.join(root, f)), f) for f in dirs) 
```

# jquery - Raphael JS 工具提示在第一次悬停时不显示

> ID：10983712
> 
> 赞同：3
> 
> 时间：2012-06-11T16:04:07.333
> 
> 标签：jquery, svg, tooltip, raphael

目前我有一个用 raphael 创建的竞技场地图，地图上的每个 svg 元素在悬停时都有一个工具提示。工具提示不会在 svg 元素的第一次悬停时显示，但如果用户再次输入 svg 元素，它将显示。

我认为这与我的 addTip“mouseeneter”函数有关，但我对 JS 的理解仍然很陌生，所以我不确定。这是我用于在悬停时将工具提示添加到 svg 元素的代码，我使用的代码基于此[stackoverflow 论坛问题](https://stackoverflow.com/questions/3417479/how-to-do-a-tooltip-on-an-svg-generated-by-raphael)和我创建的 jsfiddle[链接](http://jsfiddle.net/knottAverage/ArKDp/16/)

```
 var tip = $("#tip").hide();
    var tipText = "Tip the Canoe.";
    var over = false;
    function addTip(node, txt) 
    {
        $(node).mouseenter(function(){
            tipText = txt;
            tip.fadeIn();
            over = true;
        })
       .mouseleave(function(){
            tip.fadeOut();
            over = false;
        });
    }

    for (var i = 0, len = rsrGroups.length; i < len; i++) {
        var el = rsrGroups[i];
        el.mouseover(function() {
            addTip(this.node, tipText);
            console.log(node);
            this.toFront();
            this.attr({
                cursor: 'pointer',
                fill: '#990000',
            });
            //alert('test');
        });

        el.mousemove(function(e){
            if (over){
                tip.css("left", e.clientX+20).css("top", e.clientY+20);
                tip.text(tipText);
            }
        });
        el.mouseout(function() {
            this.attr({
                fill: '#003366'
            });
        });
        el.click(function() {
            this.attr({
                fill: 'green'
            });
        });

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:11:20.687

您正在等待添加工具提示，直到鼠标悬停触发，在此之前添加它，

前：

```
 for (var i = 0, len = rsrGroups.length; i < len; i++) {
    var el = rsrGroups[i];
    el.mouseover(function() {
        addTip(this.node, tipText); 
```

后：

```
 function addTip(node, txt) {
    node.mouseover(function(){
        tipText = txt;
        tip.fadeIn();
        over = true;
        }).mouseout(function(){
        tip.fadeOut();
        over = false;
    });
}

 for (var i = 0, len = rsrGroups.length; i < len; i++) {
    var el = rsrGroups[i];
    addTip(el, tipText);
    el.mouseover(function() { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:29:48.867

我同意安德鲁的观点。在第一个 el.mouseover 之前，工具提示不会被“实例化”。

这可能是解决方案，但我将详细说明一些技巧，这些技巧可能有助于将来解决此类问题。

我看到您正在使用警报（'test'）。这将帮助您确定是否正在访问代码，但它对于确定执行顺序并不是那么好（这似乎是这里的问题）。

而是使用两种方法之一来“调试”JavaScript。它是一个非常强大的运行时工具。方法如下：

1.  以编程方式：添加 JS 关键字调试器；这将设置一个断点并在执行期间停止您的代码。

    el.mouseover(function() { debugger; addTip(this.node, tipText); console.log(node); this.toFront(); this.attr({ cursor: 'pointer', fill: '#990000', });

这*可能*有助于您解决问题，因为您会看到此代码仅在第一次鼠标悬停*后*触发。

提示：在浏览器中打开单步调试器之前，调试器不会在断点处“停止”。为此，我推荐 Chrome 中的开发工具。您所做的就是右键单击页面并选择“检查元素”。这将打开一个控制台，提供按钮播放、跨步、跨步。一开始这可能是陌生的，但逐步调试 JavaScript 是成为高级 JS 开发人员必须具备的最重要的工具。这是非常重要的。:) 刷新页面，将鼠标悬停在您的元素上，您应该会看到它在调试器代码行处停止执行。

“2。” 使用开发工具设置断点而不是“调试器；”。这更灵活，因为断点是在浏览器运行时设置的，而不是物理嵌入代码中。

FireBug for Firefox 也很不错。但这需要您进行一些调查。

Step-Debugging对你有好处，试试吧！希望这可以帮助。祝一切顺利！纳什

# c# - 如何将列表对象的数字格式复制到 VSTO 中的另一个列表对象

> ID：10983715
> 
> 赞同：0
> 
> 时间：2012-06-11T16:04:24.073
> 
> 标签：c#, .net, vsto

我想从一个列表对象中提取数字格式并将其应用于 VSTO 中的另一个列表对象。

我尝试使用该方法：

```
for(int i=1 ;i<=sourceListObject.listcolumns.count;i++)
{
listobject1.listcolumns.item[i].range.numberformat  = sourceListObject.listcolumns.item[i].range.numberformat
} 
```

但这不起作用..因为数字格式没有应用于listobject1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:35:26.697

您要做的是逐列复制数字格式。仅当每列中的所有单元格都具有相同的 numberformat 时，这才有效，[否则 NumberFormat 属性返回 null](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.range.numberformat%28v=office.11%29.aspx)。

您可能应该逐个单元格地执行此操作（`ListObject.Range.get_Item(1,1)`是 ListObject 中的第一个单元格）。

# c# - 在 C# 中寻找高性能 XyDiff 端口（带有 XID 的 XML Diff 补丁）

> ID：10983718
> 
> 赞同：2
> 
> 时间：2012-06-11T16:04:32.103
> 
> 标签：c#, xml, xmldiff

我将一些数据存储为 XML，并将用户的更改存储为与原始 XML 的差异，因此可以在运行时修补用户的数据。

原始 xml 的示例（仅部分）：

```
<module  id="">
  <title id="">
    ...
  </title>
  <actions>
    ...
  </actions>
  <zones id="" selected="right">
    <zone id="" key="right" name="Right" />
  </zones>
</module> 
```

用户差异示例（用户从右到左更改了 selected 的值）：

```
<xd:xmldiff version="1.0" srcDocHash="" 
    options="IgnoreChildOrder IgnoreNamespaces IgnorePrefixes IgnoreSrcValidation " 
    fragments="no" 
    xmlns:xd="http://schemas.microsoft.com/xmltools/2002/xmldiff">
  <xd:node match="1">
    <xd:node match="3">
      <xd:change match="@selected">left</xd:change>
    </xd:node>
  </xd:node>
</xd:xmldiff> 
```

问题是，补丁会查找 XML 节点的顺序。如果订单发生变化，则无法再应用差异，甚至更糟糕的是，它将被错误地应用。所以我更喜欢通过 XID 修补。有谁知道用于 XyDiff 的 C# 的高性能库或算法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-19T08:23:50.650

我们现在开发了自己的解决方案，效果很好。

我们做了什么：

*   确保原始文件中的每个 xml 节点都有一个唯一的 id（无论在哪个级别）
*   为用户更改生成一个平面 xml 补丁，仅保存每个更改节点的更改（没有级别结构）
*   如果用户更改了一个值，则在补丁 xml 中写入一个 xmlpatch 节点，其属性 targetid 指向原始节点的 id
*   如果用户更改了属性，则将具有新值的属性写入 xmlpatch 节点
*   如果用户更改了值，则将该值写入 xmlpatch 节点

xml 补丁如下所示：

```
<patch>
  <xmlpatch sortorder="10" visible="true" targetId="{Guid-x}" />
  <xmlpatch selected="left" targetId="{Guid-y}" />
  <xmlpatch targetId="{Guid-z}">true</xmlpatch>
</patch> 
```

生成补丁 xml 的代码非常简单。我们循环遍历所有 xml 节点，并遍历所有属性的每个节点。如果节点的属性或值与原始节点不同，我们将生成具有该属性或值的补丁节点。请注意，代码是在一夜之间编写的；）

```
public static XDocument GenerateDiffGram(XDocument allUserDocument, XDocument runtimeDocument)
{
    XDocument diffDocument = new XDocument();
    XElement root = new XElement("patch");

    AddElements(root, runtimeDocument, allUserDocument.Root);

    diffDocument.Add(root);
    return diffDocument;
}

private static void AddElements(XElement rootPatch, XDocument runtimeDocument, XElement allUserElement)
{
    XElement patchElem = null;
    if (allUserElement.Attribute("id") != null 
        && !string.IsNullOrWhiteSpace(allUserElement.Attribute("id").Value))
    {
        // find runtime element by id
        XElement runtimeElement = (from e in runtimeDocument.Descendants(allUserElement.Name)
                        where e.Attribute("id") != null 
                        && e.Attribute("id").Value.Equals(allUserElement.Attribute("id").Value)
                        select e).FirstOrDefault();
        // create new patch node
        patchElem = new XElement("xmlpatch");

        // check for changed attributes
        foreach (var allUserAttribute in allUserElement.Attributes())
        {
            XAttribute runtimeAttribute = runtimeElement.Attribute(allUserAttribute.Name);
            if (!allUserAttribute.Value.Equals(runtimeAttribute.Value))
            {
                patchElem.SetAttributeValue(allUserAttribute.Name, runtimeAttribute.Value);
            }
        }

        // check for changed value
        if (!allUserElement.HasElements 
        && !allUserElement.Value.Equals(runtimeElement.Value))
        {
            patchElem.Value = runtimeElement.Value;
        }
    }

    // loop through all children to find changed values
    foreach (var childElement in allUserElement.Elements())
    {
        AddElements(rootPatch, runtimeDocument, childElement);
    }

    // add node for changed value
    if (patchElem != null 
        && (patchElem.HasAttributes 
        || !string.IsNullOrEmpty(patchElem.Value)))
    {
        patchElem.SetAttributeValue("targetId", allUserElement.Attribute("id").Value);
        rootPatch.AddFirst(patchElem);
    }
} 
```

在运行时，我们修补保存在补丁 xml 中的更改。我们通过 targetid 获取原始节点并覆盖属性和值。

```
public static XDocument Patch(XDocument runtimeDocument, XDocument userDocument, string modulePath, string userName)
{
    XDocument patchDocument = new XDocument(userDocument);

    foreach (XElement element in patchDocument.Element("patch").Elements())
    {
        // get id of the element
        string idAttribute = element.Attribute("targetId").Value;
        // get element with id from allUserDocument
        XElement sharedElement = (from e in runtimeDocument.Descendants()
                        where e.Attribute("id") != null 
                        && e.Attribute("id").Value.Equals(idAttribute)
                        select e).FirstOrDefault();

        // element doesn't exist anymore. Maybe the admin has deleted the element
        if (sharedElement == null)
        {
            // delete the element from the user patch
            element.Remove();
        }
        else
        {
            // set attributes to user values
            foreach (XAttribute attribute in element.Attributes())
            {
                if (!attribute.Name.LocalName.Equals("targetId"))
                {
                    sharedElement.SetAttributeValue(attribute.Name, attribute.Value);
                }
            }

            // set element value
            if (!string.IsNullOrEmpty(element.Value))
            {
                sharedElement.Value = element.Value;
            }
        }
    }

    // user patch has changed (nodes deleted by the admin)
    if (!patchDocument.ToString().Equals(userDocument.ToString()))
    {
        // save back the changed user patch
        using (PersonalizationProvider provider = new PersonalizationProvider())
        {
            provider.SaveUserPersonalization(modulePath, userName, patchDocument);
        }
    }

    return runtimeDocument;
} 
```

# javascript - DataTables：如何将类设置为表格行单元格（而不是表格标题单元格！）

> ID：10983721
> 
> 赞同：17
> 
> 时间：2012-06-11T16:04:35.633
> 
> 标签：javascript, datatables

我的桌子风格非常好。

*{抱歉链接不再有效}*

我必须添加 sClass 以便新行（由 fnAddData 添加）获得正确的类。

不幸的是，这破坏了我的布局，因为这些类也被添加到我的表头单元格中！

*{抱歉链接不再有效}*

如何将 sClass 配置为仅适用于 TBODY 单元？

**澄清：**

```
 var rolesTable = $('#roles').dataTable({
      "aoColumns": [
        { "mDataProp": "id", "sClass": "avo-lime-h avo-heading-white" },
        { "mDataProp": "name", "sClass": "avo-light" },
        { "mDataProp": "module", "sClass": "avo-light" },
        { "mDataProp": "description", "sClass": "avo-light" },
        { "mDataProp": null, "bSearchable": false, "bSortable": false, 
          "sDefaultContent": '<button type="button" name="add" class="btn"><i class="icon-plus icon-white"></i></button>' }, 
      ],
  }); // end od dataTable 
```

这样当我打电话时

```
rolesTable.fnAddData( { 
    "id": 10, 
    "name": "testname", 
    "module": "testmodule", 
    "description": "testdescription" 
} ); 
```

然后添加的行如下所示：

```
<tr>
    <td class="avo-lime-h avo-heading-white">10</td>
    <td class="avo-light">testname</td>
    <td class="avo-light">testmodule</td>
    <td class="avo-light">testdescription</td>
    <td></td>
</tr> 
```

这完全**没问题**

**问题是**此设置还将这些类添加到：

```
<thead>
    <tr> (...) </tr>
</thead> 
```

表头单元格......我不想要

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-11T21:14:03.023

**我的问题的解决方案是：**使用 fnRowCallback 而不是 sClass 将类设置为新行。

```
 var rolesTable = $('#roles').dataTable({
      "aoColumns": [
        { "mDataProp": "id" },
        { "mDataProp": "name" },
        { "mDataProp": "module" },
        { "mDataProp": "description" },
        { "mDataProp": null, "bSearchable": false, "bSortable": false, 
          "sDefaultContent": '<button type="button" name="add" class="btn btn-round"><i class="icon-plus icon-white"></i></button>' }, 
      ],
      "fnRowCallback": function( nRow, aData, iDisplayIndex, iDisplayIndexFull ) {
          $('td:eq(0)', nRow).addClass( "avo-lime-h avo-heading-white" );
          $('td:eq(1),td:eq(2),td:eq(3)', nRow).addClass( "avo-light" );
        }
  }); // end od dataTable 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-02T15:58:17.957

由于您仅使用 sClass 将样式应用于表格，因此解决问题的简单方法是将 CSS 本身修改为仅应用于 td 元素。

旧 CSS 样式：

```
.avo-light {
    color: blue;
} 
```

新的 CSS 样式：

```
td.avo-light {
    color: blue;
} 
```

这样，尽管 sClass 也应用于元素，但 CSS 只会影响您对应用样式感兴趣的单元格。

我意识到这个问题有点老了，但我发现它比最佳解决方案更加模块化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T07:55:00.647

之前设置默认类。

```
$.fn.dataTableExt.oStdClasses.sStripeOdd = '';

$.fn.dataTableExt.oStdClasses.sStripeEven = ''; 
```

如需进一步参考，请参见此处 [http://www.datatables.net/styling/custom_classes](http://www.datatables.net/styling/custom_classes)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-09-26T19:46:54.877

```
 let table = $("#myTable").dataTable();
  table.rows().every(function(rowIdx, tableLoop, rowLoop){
    $(this.node().cells[0]).addClass('red');
    $(this.node().cells[1]).addClass('blue');
  } 
```

呈现表格后，使用每行的 JavaScript 选择器遍历所有行并进行所需的任何更改。这解决了 gamliela 在 loostr 的回答中提出的性能问题。[数据表 rows().every() 文档](https://datatables.net/reference/api/rows().every())

# haskell - ghc 7.4.1 不生成 stub.o 文件

> ID：10983728
> 
> 赞同：5
> 
> 时间：2012-06-11T16:05:05.910
> 
> 标签：haskell, ghc, ffi, haskell-platform

我在 Ubuntu 上运行 Haskell 平台的默认安装，当我运行此示例时[http://www.haskell.org/haskellwiki/Calling_Haskell_from_C](http://www.haskell.org/haskellwiki/Calling_Haskell_from_C) "ghc -c -O Safe.hs" 没有生成 Safe_stub.o 文件。我已经在朋友盒子上单独安装 Ubuntu 以及 32 位和 64 位 Ubuntu 安装时检查了这一点。

有人可以确认这是特定于 ghc-7.4.1 还是仅安装 Ubuntu？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-11T16:15:40.240

这是一个 ghc-7.4（`ghc >= 7.2`实际上）的东西。那不再需要和产生`*_stub.o`（或`*_stub.c`）文件了。但是，最终编译的命令行必须更改

```
$ ghc -no-hs-main -optc-O test.c Safe.o  -o test 
```

你必须告诉 GHC 这`main`不是一个 haskell 调用。

# php - eregi_replace 已弃用

> ID：10983729
> 
> 赞同：0
> 
> 时间：2012-06-11T16:05:07.717
> 
> 标签：php

> **可能重复：**
> [已弃用：函数 eregi_replace()](https://stackoverflow.com/questions/8679656/deprecated-function-eregi-replace)

我有一个错误，内容如下：

> 已弃用：函数 ereg_replace() 在第 26 行的 /home/socia125/public_html/wi_class_files/autoMakeLinks.php 中已弃用

我的代码在这里。任何帮助表示赞赏。

```
<?php

    class autoActiveLink {

    function makeActiveLink($originalString){

        $newString = ereg_replace("[[:alpha:]]+://[^<>[:space:]]+[[:alnum:]/]","<a 

        href=\"\\0\" target=\"_blank\">\\0</a>", $originalString);
        return $newString;
    }

}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:06:56.617

`ereg`自 PHP 5.3.0 起不推荐使用函数。改为使用**[`preg`](http://il.php.net/manual/en/function.preg-replace.php)**。

```
class autoActiveLink {
    function makeActiveLink($originalString) {

        $newString = preg_replace("|[[:alpha:]]+://[^<>[:space:]]+[[:alnum:]/]|",
                                  "<a href=\"\\0\" target=\"_blank\">\\0</a>",
                                  $originalString
        );
        return $newString;
    }
} 
```

请注意，在`preg`函数上，您的正则表达式需要一个分隔符。有关更多详细信息，请参阅**[手册](http://il.php.net/manual/en/function.preg-replace.php)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:07:06.953

改为使用[`preg_replace`](http://php.net/preg-replace)。

在大多数情况下，唯一真正的区别是您必须在正则表达式周围有分隔符。我通常`(`在开头和`)`结尾使用，但您可以使用任何两个匹配的符号。的优点`()`是，您不必为了避免与分隔符冲突而转义任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:08:42.817

使用`preg_replace`：

```
$newString = preg_replace("#[[:alpha:]]+://[^<>[:space:]]+[[:alnum:]/]#","<a href=\"\\0\" target=\"_blank\">\\0</a>", $originalString); 
```

# javascript - HTML5 音频对象无法在 iPad 上播放（从 setTimeout 调用时）

> ID：10983731
> 
> 赞同：6
> 
> 时间：2012-06-11T16:05:10.223
> 
> 标签：javascript, ipad, html, audio, settimeout

我有一个带有隐藏`<audio>`对象的页面，该页面正在通过 javascript 使用自定义按钮启动和停止。（原因是我想自定义按钮，而绘制音频播放器似乎会破坏 iPad 上的渲染性能）。一个简化的例子（在咖啡脚本中）：

```
// Works fine on all browsers

constructor: (@_button, @_audio) ->
  @_button.on 'click', @_play          // Bind button's click event with jQuery

_play: (e) =>
  @_audio[0].play()                    // Call play() on audio element 
```

当从绑定到事件的函数触发时，音频播放正常，但我实际上希望在`click`文件播放之前完成动画，所以我把. 但是我无法让它工作：`.play()``setTimeout`

```
// Will not play on iPad

constructor: (@_button, @_audio) ->
  @_button.on 'click', @_play          // Bind button's click event with jQuery

_play: (e) =>
  setTimeout (=>                       // Declare a 300ms timeout
    @_audio[0].play()                  // Call play() on audio element
  ), 300 
```

我检查了`@_audio`( `this._audio`) 是否在范围内，并且它的`play()`方法存在。为什么这在 iPad 上不起作用？

**编辑**：碰巧，上面的简化测试用例*确实*有效。请参阅下面的@apsillers 的回答和我对此的评论。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-11T16:13:50.937

请参阅[Apple 的 iOS 注意事项指南](http://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html)：

> ...在用户开始播放之前，JavaScript`play()`和`load()`方法也处于非活动状态，除非`play()`or`load()`方法由用户操作触发。换句话说，用户启动的播放按钮有效，但`onLoad="play()"`事件无效。

您的`setTimeout()`回调似乎不符合用户启动的操作，尽管它`setTimeout()`本身是在用户启动的函数中。

**建议：**我没有要测试的 iOS 设备，但也许在用户按下按钮时进行初始播放/暂停会解除此限制。也就是说，您调用`play()`然后立即暂停它，*然后*调用 animate 和调用的`setTimeout()`函数`play()`。这使得用户启动的功能让 iOS 知道以后可以加载和播放这个视频。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:11:56.170

有些设备您无法自动调用播放音频系统您是否尝试过使用按钮并单击播放，看看是否有效，如果有效，它如何工作它是否打开音频播放器来播放它，如果是这样，您不允许自动播放媒体如果我没记错的话与视频标签相同

我认为 safari 会检查触发音频的事件因此为什么点击有效

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T17:08:02.563

@apsillers 在他的回答中建议我可以重新排列我的代码以满足 iPad 的“用户启动的操作”要求。我做了一些挖掘，事实证明这是真的。

要求似乎是`play()`调用只能在*一个* `setTimeout`范围内（因此，我在原始问题中给出的简化示例*确实*有效——我最初有`play()`几个`setTimeout`s 深度）。

所以这*将*起作用：

```
constructor: (@_button, @_audio) ->
  @_button.on 'click', @_play

_play: (e) =>
  setTimeout (=>
    @_audio[0].play()                  // play() is only inside one setTimeout
  ), 300 
```

这也可以：

```
constructor: (@_button, @_audio) ->
  @_button.on 'click', =>
    setTimeout ((e) =>
      @_play(e)
    ), 300

_play: (e) =>
  @_audio[0].play()                    // Still only inside one setTimeout 
```

但这不起作用：

```
constructor: (@_button, @_audio) ->
  @_button.on 'click', @_play

_play: (e) =>
  setTimeout (=>
    // Something useful
    setTimeout (=>
      @_audio[0].play()                // play() is inside two setTimeouts
    ), 300
  ), 300 
```

这也不会（我的原始设置）：

```
constructor: (@_button, @_audio) ->
  @_button.on 'click', @_play

_play: (e) =>

  @_button
    .animate { prop: value }, 300, =>

      setTimeout (=>
        @_audio[0].play()              // play() still 'too deep'
      ), 300 
```

在最后一个示例中，似乎 jQuery 的动画回调是从`setTimeout`库的另一个内部调用的，因此`play()`再次“太深”。

# c - 如何使用 GTK/Cairo 将多个 PNG 合成为单个 PNG

> ID：10983739
> 
> 赞同：3
> 
> 时间：2012-06-11T16:05:35.407
> 
> 标签：c, animation, graphics, gtk, cairo

我对 GTK 有点陌生，对开罗也很陌生。我的任务是创建一个应用程序，该应用程序需要将 PNG 作为背景并将包含字母和数字的多个 PNG 文件合成到背景 PNG 上，以便最终得到一个可以转换、旋转、缩放的 PNG等等。我可能觉得有用的任何提示、教程、代码示例？与 GTK 的情况一样，Cairo 文档对于尝试做比绘制形状更复杂的事情的初学者来说似乎有些欠缺。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-13T17:03:07.990

看看这个简单的例子。它仅使用 cairo：

```
#include <cairo.h>

int main()
{
    //Load a few images from files
    cairo_surface_t *surf1 = cairo_image_surface_create_from_png("a.png");
    cairo_surface_t *surf2 = cairo_image_surface_create_from_png("b.png");

    //Create the background image
    cairo_surface_t *img = cairo_image_surface_create(CAIRO_FORMAT_ARGB32, 100, 100);

    //Create the cairo context
    cairo_t *cr = cairo_create(img);

    //Initialize the image to black transparent
    cairo_set_source_rgba(cr, 0,0,0, 1);
    cairo_paint(cr);

    //Paint one image
    cairo_set_source_surface(cr, surf1, 0, 0);
    cairo_paint(cr);

    //Paint the other image
    cairo_set_source_surface(cr, surf2, 50, 50);
    cairo_paint(cr);

    //Destroy the cairo context and/or flush the destination image
    cairo_surface_flush(img);
    cairo_destroy(cr);

    //And write the results into a new file
    cairo_surface_write_to_png(img, "result.png");

    //Be tidy and collect your trash
    cairo_surface_destroy(img);
    cairo_surface_destroy(surf1);
    cairo_surface_destroy(surf2);

    return 0;

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T21:00:30.313

谢谢罗德里戈，这是一个很好的例子！

对于所有**C# 程序员**，这里是翻译成 C# 的完全相同的示例。我在 SetSourceRGBA() 中只做了一个小改动——允许使用透明背景图像而不是黑色：

```
Using Cairo;

    //Load a few images from files
    ImageSurface surf1 = new ImageSurface("a.png");
    ImageSurface surf2 = new ImageSurface("b.png");

    //Create the background image
    ImageSurface img = new ImageSurface(Format.Argb32, 200, 200);

    //Create the cairo context
    Context cr = new Context(img);

    //Initialize the image to black transparent
    // cr.SetSourceRGBA(255,255,255,1); // This will create the background image with white background
    // cr.SetSourceRGBA(0,0,0,1);       // This will create the background image with black background
    cr.SetSourceRGBA(0,0,0,0);          // This creates the background image with transparent background
    cr.Paint ();

    //Paint one image
    cr.SetSourceSurface(surf1,0,0);
    cr.Paint();

    //Paint the other image
    cr.SetSourceSurface(surf2, 25, 50);
    cr.Paint();

    //Destroy the cairo context and/or flush the destination image
    img.Flush();

    //And write the results into a new file
    img.WriteToPng("result.png");

    //Be tidy and collect your trash
    img.Dispose();
    img.Destroy();
    surf1.Destroy ();
    surf2.Destroy(); 
```

# c++ - 如何通过返回类型有条件地编译模板化函数

> ID：10983740
> 
> 赞同：1
> 
> 时间：2012-06-11T16:05:45.237
> 
> 标签：c++, templates

如果我在 C++ 中对返回类型的函数进行模板化：

```
template<class T> T foo(int x) { }; 
```

我可以使用显式模板特化来创建一个`double`实例：

```
template<> double foo<double>(int x) { }; 
```

我尝试使用前向声明来创建 undefined 的实例`struct`：

```
struct bar;
template<> bar foo<bar>(int x) { } 
```

这失败了`error: return type ‘struct bar’ is incomplete`。我*认为*这是允许的，即使在阅读了关于[何时使用前向声明的公认答案？](https://stackoverflow.com/a/553869/249341)因为，在我创建 的实例之前`foo<bar>`，永远不会创建显式模板化代码。显然情况并非如此（为什么不呢？）。

是否可以为编译时类型可能不存在的函数编写代码，并且仅在特定显式特化被实例化时才编译代码？这样做的动机是“重载”结构阅读器，其中重载操作是在编译之前按程序生成的（通过脚本）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:09:35.093

如果你不提供`foo`函数体，你可以这样做：

```
// some header file, probably
struct bar;
template<> bar foo<bar>(int x);

// somewhere else:

struct bar { 
    //blabla 
};

// the actual implementation
template<> bar foo<bar>(int x) {
    // do something
} 
```

前向声明仅在您实际上不需要定义`bar`. 在您的`foo`函数体中，您需要知道该结构的大小，这就是您的代码不起作用的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:10:47.900

当您*定义*函数的特化时，您定义的是*函数*，而不是*函数模板*。此时的规则与任何常规函数完全相同，并且因为您以需要完整类型的方式使用类型，所以缺少定义`bar`会使您的程序格式错误。

（缺少 return 语句也使程序格式错误......）

# iphone - iPhone VoiceOver 辅助功能设置会导致视频录制崩溃

> ID：10983742
> 
> 赞同：9
> 
> 时间：2012-06-11T16:05:50.563
> 
> 标签：iphone, objective-c, uiimagepickercontroller

`UIImagePickerController`我终于确定了一个在录制视频时崩溃的错误。启用 iPhone 的 VoiceOver 辅助功能设置后，录音机在通话时不会失败`presentModalViewController`。

到目前为止，我一直没有成功地想出一个解决方法。有没有其他人经历过这个并能够解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-18T14:59:36.083

正如上面评论中提到的@kamens，一种解决方法是`camera.showsCameraControls = NO`在呈现模态视图控制器时包含在完成块中，如下所示：

```
[controller presentViewController:self animated:YES completion:^{self.showsCameraControls = NO;}]; 
```

但是，使用此解决方案时，相机控件会在相机出现时瞬间闪烁，然后消失。当控件确实需要隐藏时显然不理想。另一种解决方法是设置`camera.showsCameraControls = OFF`......甚至不太理想。

* * *

@quellish，这是崩溃的输出：

```
*** -[PLCameraToggleButton setAccessibilityValue:]: message sent to deallocated instance 0x4a330b0 
```

@kamens，这是我用来设置`mediaTypes`and的代码`captureMode`：

```
tmpCamera.mediaTypes = [NSArray arrayWithObject:(NSString *)kUTTypeMovie];
tmpCamera.cameraCaptureMode = UIImagePickerControllerCameraCaptureModeVideo; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T07:03:12.077

正如@james 提到的，这发生在 iOS 5.1 中：

*   使用`picker.showsCameraControls = NO`
*   `animated:NO`在您的呼叫中使用`[viewController presentViewController:picker animated:YES completion:nil];`
*   VoiceOver 辅助功能选项已启用。

...*而且*，重要的是，当仅将电影指定为选择器接受的媒体类型时：

*   picker.mediaTypes = [NSArray arrayWithObject:(NSString *)kUTTypeMovie];

* * *

但是，我可以通过将上面的 mediaTypes 行更改为：

```
picker.mediaTypes = [UIImagePickerController availableMediaTypesForSourceType:picker.sourceType]; 
```

...考虑到默认的相机控件是隐藏的，并且我可以以编程方式控制是开始录制视频还是拍照，这很好用。

我不声称了解这次崩溃的原因。

# iphone - 从核心数据中的视图传递数据

> ID：10983744
> 
> 赞同：2
> 
> 时间：2012-06-11T16:05:58.147
> 
> 标签：iphone, objective-c, ios, cocoa-touch, core-data

大家好——我是 iPhone 编程和 Core Data 的初学者。我目前正在尝试学习 Core Data 背后的一些理论，并一直在使用[本](http://timroadley.com/2012/02/12/core-data-basics-part-2-core-data-views/)教程来帮助我在我的应用程序中实现它。

本教程通过使主视图一个`UITableViewController`列出已保存的对象和另一个`UITableViewController`保存对象（您在其中输入属性）来进行教学。

我正在创建的应用程序有 3 个视图。主视图是一个普通视图`UIViewController`（它处理计算），您可以通过点击 a 来保存您的计算，`UIBarButtonItem`这会将您带到第二个视图，您可以在其中输入更具体的属性。点击保存后，您将返回主视图，您可以在其中点击“显示已保存”按钮以访问`UITableViewController`包含的已保存对象。

我已将#imported`UITableViewController`文件包含到我的主视图的界面文件中，但是当我运行程序时，我的`prepareForSegue`方法中的这一行出现错误：

```
 addShoeSizeTVC.managedObjectContext = self.managedObjectContext; 
```

错误是“在'SSFViewController *'类型的对象上找不到属性managedObjectContext”我理解这个错误的含义-我的SSFViewController类中没有任何名为managedObjectContext的对象，但我想如果我包含我的文件包含仍可识别的 managedObjectContext。我应该补充一点，在本教程中，该`prepareForSegue`方法包含在列表视图中，以便继续添加新对象`UITableViewController`。我将此方法移至我的`mainViewController`.

在我的`ApplicationDidFinishLaunchingWithOptions`方法中，我的 App Delegate 中也出现错误：

```
 controller.managedObjectContext = self.managedObjectContext; 
```

我知道这源于另一个错误的相同问题（它给出了相同的错误消息）。

我不明白如何将数据从我的 viewA（mainView）传递到 viewB（添加对象），再传回 viewA，然后再传到 viewC（查看保存的对象）。我听说过委托，并在我的主要观点中在我的`prepareForSegue`方法中使用它：`SSFViewController`

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    if ([segue.identifier isEqualToString:@"Add Object Segue"]) {

        NSLog(@"Setting ObjectsTVC as a delegate of AddObjectTVC");
        AddObjectTVC *addObjectTVC = segue.destinationViewController;
        addObjectTVC.delegate = addObjectTVC.self;
        addObjectTVC.managedObjectContext = addObjectTVC.self.managedObjectContext;
    }
} 
```

同样`addObjectTVC.delegate = addObjectTVC.self;`在线上我收到一条警告，上面写着“将'AddObjectTVC *'传递给不兼容类型'id'的参数”

我是否必须在我的主视图中设置一个`NSManagedContext`或另一个委托方法？或者它是我必须添加到我的任何表视图中的东西？？？

非常感谢。如果提供正确的信息，我觉得这是一个很容易解决的问题。如果需要解决问题，我很乐意发布我使用的任何其他方法。我是初学者，所以如果您能以对初学者友好的方式进行解释，那就太好了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:34:07.940

首先，如果你想要从 ViewA 到 ViewB 的数据，在 ViewB 中插入一个属性，你可以将数据从 ViewA 传递到这个@property

**例子**

视图B：

> @property (nonatomic, strong) NSString *yourName; （不要忘记调用 @synthesize yourName ）

ViewA：（在 prepareForSegue 方法中）

> "ViewB-Controller" *controller = segue.destinationViewController; controller.yourName = self.name

--> 名称将传递给 ViewB

第二：我更喜欢从 ViewB 向 ViewA 发送“嘿，请保存您的数据”的代表。它使您的控制器变得简单和智能，并且您不必管理所有视图控制器的保存方法。Delegate 是 iOS 中的一个重要章节，对于初学者来说可能会非常沮丧。（我在 9 个月前遇到过同样的情况；））搜索一个代表示例并尝试了解它是如何工作的（边做边学），如果您对代表有进一步的疑问，我会友好地回答您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:17:29.273

具有[managedObjectContext](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSManagedObjectContext_Class/NSManagedObjectContext.html#//apple_ref/doc/uid/TP40003608)属性的不是视图控制器，而是您的[UIManagedDocument](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIManagedDocument_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40010905)。

上下文通常被描述为“便笺本”，您的应用程序将在其中使用数据存储。

# mysql - MYSQL - 可以根据条件命名结果的 SELECT 语句

> ID：10983746
> 
> 赞同：2
> 
> 时间：2012-06-11T16:06:01.923
> 
> 标签：mysql, sql, select

我想构建一个 SELECT 语句，可以根据条件命名结果。为了更好地解释我的尝试，我构建了以下无效/无效语句。如何将以下 SELECT 语句更改为实际适用于我的原因的语句。谢谢！

```
SELECT  
  CASE
     WHEN dayStart LIKE '2012-06-11%' THEN UNIX_TIMESTAMP(dayStart) as today
     WHEN dayStart LIKE '2012-06-10%' THEN UNIX_TIMESTAMP(dayStart) as yest
     WHEN dayStart LIKE '2012-06-12%' THEN UNIX_TIMESTAMP(dayStart) as tomor
  END
FROM dayBook
WHERE userID = 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:16:57.707

为什么不只返回两列，一列告诉您日期，另一列告诉您是今天、昨天还是明天？

```
SELECT  
  UNIX_TIMESTAMP(dayStart) as yourDate
, CASE
     WHEN dayStart LIKE '2012-06-11%' THEN 'today'
     WHEN dayStart LIKE '2012-06-10%' THEN 'yest'
     WHEN dayStart LIKE '2012-06-12%' THEN 'tomor'
  END as dayType
FROM dayBook
WHERE userID = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:17:33.493

我对你的问题感到困惑。如果您想更改 UNIX_TIMESTAMP 的值，您可以执行 UPDATE dayBook SET UNIX_TIMESTAMP(dayStart) = 'Today' WHERE dayStart = '2012-06-11%' 并对其他值执行相同操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:12:03.547

您需要使用动态 SQL。

# sql-server-2008 - SQL 中 where 语句的性能，而不是数据集上的过滤器

> ID：10983749
> 
> 赞同：2
> 
> 时间：2012-06-11T16:06:11.960
> 
> 标签：sql-server-2008, ssrs-2008, reporting-services

如果我搜索得不够彻底，请鞭打我......

我想知道什么对性能更好：

使用 SQL（WHERE、Group by、Order By 数据集中的语句）收集、汇总和排序我的数据，或者只收集“裸”数据并在报告中进行分组、排序和过滤。（在报告中过滤数据集、参数和聚合）

使用存储过程对性能有好处吗？

问候，

亨罗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T16:44:01.790

好吧，SSRS 是一个显示结果的工具，它为此进行了优化，虽然它可以执行聚合和过滤器以及更多的事情，但这并不意味着它是他的主要目标，所以它没有优化到这样做。当您对数据集执行聚合、过滤器和数据操作时，您正在为此使用数据库引擎，它为此进行了优化，因此您很可能通过这种方式获得更好的性能。至于存储过程或纯 SQL，两者都没有内在的性能优势（我更喜欢纯 SQL，只是因为它给了我更大的灵活性）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T19:34:22.643

在性能方面，SQL Server 针对这类事情进行了优化；

在某些情况下，存储过程可以在预编译查询计划时显着提高性能……在这种情况下，除非经常调用报告，否则我不知道您是否会注意到差异。不过，我确实更喜欢将我的 SQL 排除在报告之外。

# azure - 应该使用哪个驱动器在 azure 虚拟机中保存数据？

> ID：10983750
> 
> 赞同：4
> 
> 时间：2012-06-11T16:06:19.270
> 
> 标签：azure

在我的天蓝色虚拟机中，我从快速创建中选择了 windows server 2008 r2 映像。当我登录机器时，我看到有两个驱动器。我应该在哪个驱动器上 ftp 我的应用程序，因为我不确定如果机器被移动，哪个驱动器会持续存在。

另外，我可以在每种不同类型的 VM 上保留多少数据，是否有限制取决于我的 vm 大小？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-11T16:32:47.620

在适用于 Windows 的 Windows Azure 虚拟机中，您可以找到驱动器 C 和 D。

驱动器 C 是引导 OS 磁盘，其大小实际上是您从库中上传或配置的 VHD 的大小。该磁盘是持久化磁盘，因此您将存储在驱动器 C 上的任何内容都将被持久化。在预览版中，来自 Gallery id 的 Windows Server R2 VHD 默认大小为 30 GB，这就是为什么您可能会在驱动器 C 中看到 30 GB 大小的原因：但是您可以创建高达 128 GB 的 VHD 并使用中型及以上虚拟机实例自行部署。

D盘的存储空间为上表所示的临时存储空间，其中一个Medium预计为100GB。此空间不会保留在 Windows Azure 存储中，如果由于硬件故障需要迁移虚拟机，该空间将被销毁。

[关于您关于可以在 Windows Azure 虚拟机上保留多少数据的问题，此处](http://msdn.microsoft.com/en-us/library/windowsazure/jj156003.aspx)记录了可以在 Windows Azure 虚拟机上保留的数据大小。

1.  超小 - 20 GB
2.  小 - 20 GB
3.  中 - 100 GB
4.  大 - 200 GB
5.  超大 - 400 GB

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:30:36.217

默认情况下，每个 Azure 虚拟机都有两个驱动器。默认 c: 驱动器是 blob 存储中的 vhd，作为存储连接到您的虚拟机，并且是持久驱动器。在此处查看创建虚拟机的技术图和说明：http: [//www.windowsazure.com/en-us/manage/linux/other-resources/command-line-tools/](http://www.windowsazure.com/en-us/manage/linux/other-resources/command-line-tools/)

您连接到虚拟机的任何驱动器最终都将是 blob 存储中的 vhd。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T10:15:11.857

是的，限制确实取决于您的 VM 大小。

附加到 Azure 虚拟机的每个数据磁盘的最大容量为 1 TB（支持此数据磁盘的页 blob 的当前最大大小）。因此，使用超大型 VM，您可以拥有 16 TB 的持久异地复制存储（如果您在存储帐户中启用此功能）。

VM 大小数据磁盘限制

特小 1

小2

中 4

大号 8

特大号 16

[http://www.windowsazure.com/en-us/manage/windows/how-to-guides/attach-a-disk/](http://www.windowsazure.com/en-us/manage/windows/how-to-guides/attach-a-disk/)

# c# - 在 GridView 的 TemplateField 中获取 Html 输入的值

> ID：10983751
> 
> 赞同：3
> 
> 时间：2012-06-11T16:06:21.323
> 
> 标签：c#, asp.net

在以下示例中，我无法获取 tel 输入“Contract”的值。我对 DropDownList 没有任何问题。

asp 代码：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False"
                DataKeyNames="Serial,Model" DataSourceID="ObjectDataSource1" Width="50%" GridLines="None" CellSpacing="-1">
                    <Columns>
                        <asp:BoundField DataField="Serial" HeaderText="Serial" />
                        <asp:BoundField DataField="Model" HeaderText="Model"/>
                        <asp:TemplateField HeaderText="Status">
                        <ItemTemplate>
                            <asp:DropDownList ID="Status" CssClass="dropdownlist" runat="server" onfocus="setSelectedRow(this)" DataValueField="Status" SelectedValue='<%# Bind("Status") %>' onChange="statusChange(this)">
                                <asp:ListItem Value="RENT READY">Rent Ready</asp:ListItem>
                                <asp:ListItem Value="ON RENT">On Rent</asp:ListItem>
                                <asp:ListItem Value="OOS">Out of Service</asp:ListItem>
                            </asp:DropDownList>                               
                            <input type="tel" id="Contract" onfocus="setSelectedRow(this)" value= '<%# Eval("Contract") %>' placeholder="Contract #" class='<%# (string)Eval("Status") == "ON RENT" ? "textBox" : "textBoxHidden" %>'></input>
                        </ItemTemplate>
                    </asp:TemplateField>
</asp:GridView> 
```

呈现的 HTML：

![在此处输入图像描述](../Images/8deec3783e34c0096f8084c386c01532.png)

到目前为止我已经尝试过：

```
protected void submit_Click(object sender, EventArgs e)
{
   if (!Page.IsValid) return;
   foreach(GridViewRow row in GridView1.Rows)
   {
      string Serial = row.Cells[0].Text;
      string Model = row.Cells[1].Text;
      string Status = ((DropDownList)row.FindControl("Status")).SelectedValue;
      string Contract =  Any one of the below attempts...

      Sql stored procedure integrating the data back to the server...
   }
}

 string Contract = ((HtmlInputControl)row.FindControl("Contract")).Value;

 string Contract = ((HtmlInputText)row.FindControl("Contract")).Value;

 string Contract = ((TextBox)row.FindControl("Contract")).Text; 
```

全部抛出 Object Reference Not Set to Instance of Object 异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T18:37:13.293

像这样更改您的输入：添加一个`runat="server"`属性

`type = "text"`在`aspx`文件中使用

```
 <input type="text" runat="server" id="Contract" onfocus="setSelectedRow(this)" value= '<%#   
     Eval("Contract") %>' placeholder="Contract #" class='<%# (string)Eval("Status") == "ON  
     RENT" ? "textBox" : "textBoxHidden" %>' ></input> 
```

然后在像这样的事件`type = "tel"`中创建 GridRows 时将其更改为后面的代码 `OnRowCreated`

```
 protected void GridView1_RowCreated(object sender, GridViewRowEventArgs {
        if (e.Row.RowType == DataControlRowType.DataRow)
            ((HtmlInputText)(e.Row.FindControl("Contract")))
                .Attributes.Add("type", "tel");
    } 
```

检索输入值使用这个

```
string Contract = ((HtmlInputText)row.FindControl("Contract")).Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T19:33:46.540

1.  您需要`runat="server"`在服务器端添加访问 html 输入控件
2.  该`value`属性没有`=`符号并且在呈现的 html 中为空
3.  `/`呈现的 html中没有结束标记

渲染的输入标签：

```
<input type="tel" id="Contract" onfocus="setSelectedRow(this)" value placeholder="Contract #" class="textBoxHidden"> 
```

你需要这样的东西：

```
<input type="text" id="Contract" runat="server" onfocus="setSelectedRow(this)" value='<%# (string)Eval("Contract") == "" ? "" : Eval("Contract") %>' placeholder="Contract #" class='<%# (string)Eval("Status") == "ON RENT" ? "textBox" : "textBoxHidden" %>' /> 
```

如果`value`属性仍然`=`无法登录呈现的 html，则尝试将其值设置为某个虚拟电话。

```
value='<%# (string)Eval("Contract") == "" ? "0" : Eval("Contract") %>' 
```

# caching - FrontPage 无法发布一个特定的网页

> ID：10983754
> 
> 赞同：1
> 
> 时间：2012-06-11T16:06:35.900
> 
> 标签：caching, deployment, content-management-system, publish, frontpage

我有一个使用 FrontPage 2003 设计和发布的网站。我已经更改了该网站中的 5 个网页。当我发布它们时，FrontPage 不显示任何错误消息。我发现有 4 个网页正确发布，但有一个没有正确发布。该网站仍然包含该网页的旧版本。

我尝试从 FrontPage 和我发布的网站中删除旧版本。但是，一旦我发布具有相同名称的网页，问题就会立即出现。例如，这是我删除旧版本的方法：

1.  准备好新版本（例如 web-page-TEST.htm）。
2.  从 FrontPage 中删除旧版本。
3.  发布网站。当 FrontPage 提议删除仍在已发布网站中的旧版本时，我告诉 FrontPage 删除它。
4.  重命名新版本以使用原始网页名称（例如 web-page.htm）。
5.  再次发布网页。当 FrontPage 让我删除仍在已发布网站中的 TEST 版本时，我告诉 FrontPage 删除它。
6.  当我使用浏览器打开网页时，我发现它仍然包含旧信息。

我很确定 web-page-X 中的内容是正确的。原因是我在不同的网页名称下发布了它（如web-page-X-TEST.htm），它可以毫无问题地发布，而且效果也很好。

我已经没有想法了。请帮忙。谢谢。

陈杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T18:20:09.163

在“文件夹”视图中，右键单击未发布的文件，然后单击“不发布”以取消选择。如果这不起作用，这里有一些其他的故障排除技巧可能会有所帮助：

*   [网站更改在 FrontPage 2003 或 SharePoint Designer 2007 中的目标 Web 服务器上不可见](http://support.microsoft.com/kb/828904)

# winforms - 如何停止 Visual Studio 为设计器中的控件生成属性设置？

> ID：10983764
> 
> 赞同：0
> 
> 时间：2012-06-11T16:07:17.483
> 
> 标签：winforms, code-generation, windows-forms-designer, automatic-properties

在 Visual Studio 2008 中，当我添加一些控件以形成设计器时，设计器会自动创建一些关于控件属性的代码。现在，我正在使用自己的用户控件并将它们添加到表单中，设计器再次自动创建代码行，在这种情况下，属性 FONT 是我不希望设计器添加它的属性之一，因为它覆盖上层的字体设置。任何人都知道如何设置要在设计器中设置的属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T18:01:11.190

如果设计者确定该值与 DefaultValue[Attribute] 不同，则仅添加一行代码来更改属性的值。

如果您的自定义控件想要更改 Font 属性的默认值（或任何其他基类属性），您必须执行一些小技巧：

```
public class MyControl : Control
{
    public MyControl()
    {
        base.Font = new Font("Arial", 9.75f);
    }

    [DefaultValue(typeof(Font), "Arial, 9.75pt")]
    public new Font Font
    {
        get { return base.Font; }
        set { base.Font = value; }
    }
} 
```

注意到 Font 属性上的“new”关键字了吗？字体不是虚拟的，所以你不能覆盖它，我们也不想这样做。您覆盖以更改行为。我们不想改变行为（这就是代码简单地重定向回基础的原因），我们只想公开一个新的 DefaultValue。这会诱使设计人员考虑控件的新默认值。

我们还确保我们的 Font 属性在构造时具有该值。

# php - 简单的 mod_rewrite

> ID：10983765
> 
> 赞同：-2
> 
> 时间：2012-06-11T16:07:23.770
> 
> 标签：php, .htaccess, mod-rewrite

我想为网站上的所有页面提供直接访问或在虚假“目录”中访问的选项，例如

example.com/about.php

和

example.com/directory/about.php

两者都应该简单地访问 about.php。我还想在 PHP 中访问目录的名称，即将它作为 GET 变量传递（example.com/directory/about.php 的实际 URL 是 example.com/about.php?dirname=directory）。这不仅需要在 about.php 上工作，还需要在您可以访问的任何页面（contact.php、services.php 等）上工作。

关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:11:01.813

也许是这样的？

```
RewriteEngine On
RewriteRule ^([^/]+)/([^\.]+)\.php$ /$2.php?dirname=$1 [QSA,L] 
```

# android - 在android中的按钮内保存更改

> ID：10983766
> 
> 赞同：0
> 
> 时间：2012-06-11T16:07:40.557
> 
> 标签：android, button, save, state

我是 android 开发的新手，我想弄清楚我如何制作一个按钮来保存 Activity 中的更改。简介：我有一个 seekBar，我可以在其中更改铃声音量，但它会直接更改系统，我放了一个按钮来保存更改，我不知道该怎么做。这是我的代码：

**主要的.xml**

```
 <Button
        android:id="@+id/save"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/button_text"/>

    <SeekBar
        android:id="@+id/seekVolume"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" /> 
```

**活动**

```
public class SaveActivity extends Activity {

    private AudioManager aManager;
    private SeekBar seekVolume;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        aManager = (AudioManager) getSystemService(AUDIO_SERVICE);
        Button save = (Button) findViewById(R.id.save);

        setOnClickListener();      
}
    private void setOnClickListener(){
        SeekBar seekVolume = (SeekBar) findViewById(R.id.seekVolume);

        seekVolume.setMax(aManager.getStreamMaxVolume(AudioManager.STREAM_RING));
        seekVolume.setKeyProgressIncrement(1);
        seekVolume.setProgress(aManager.getStreamVolume(AudioManager.STREAM_RING));
        seekVolume.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {
            public void onStopTrackingTouch(SeekBar ringvolume) {
            }
            public void onStartTrackingTouch(SeekBar ringvolume) {
            }
            public void onProgressChanged(SeekBar ringvolume, int progress,boolean fromUser) {
aManager.setStreamVolume(AudioManager.STREAM_RING, progress, AudioManager.FLAG_SHOW_UI + AudioManager.FLAG_PLAY_SOUND); 
            }
        });
    }

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event){
        if(keyCode==KeyEvent.KEYCODE_VOLUME_DOWN || keyCode==KeyEvent.KEYCODE_VOLUME_UP){
            seekVolume.setProgress(aManager.getStreamVolume(AudioManager.STREAM_RING));
    }
        return (super.onKeyDown(keyCode, event));
    }

} 
```

我真的不知道该怎么做。多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:15:19.833

要阅读您的偏好（在 中`onCreate()`）：

```
SharedPreferences preferences = getPreferences(MODE_PRIVATE);
seekVolume.setProgress(preferences.getInt("storedVol", 0)); 
```

要保存您的偏好（在 中`onDestroy()`）：

```
SharedPreferences preferences = getPreference(MODE_PRIVATE);
SharedPreferences.Editor editor = preferences.edit();
editor.putInt("storedVol", seekVolume.getProgress()); // value to store
editor.commit(); 
```

你取回`Button save`但`onCreate()`什么也不做。你想让它做什么？如何`onClickListener`通过添加连接它

```
 save.setOnClickListener(mySaveHandler); 
```

到`onCreate()`？然后：

```
View.OnClickListener mySaveHandler = new View.OnClickListener() {
  public void onClick(View v) {
   // Save preferences here instead/aswell
 }
} 
```

# php - Magento addField 不使用“值”

> ID：10983767
> 
> 赞同：2
> 
> 时间：2012-06-11T16:07:48.740
> 
> 标签：php, magento, mage, adminhtml

设置自定义表单。Magento 不使用 addField 的 'value' 属性。建议？

代码：

```
$form = new Varien_Data_Form(array(
    'id' => 'edit_form',
    'action' => $this->getUrl('*/*/save', array('id' => $this->getRequest()->getParam('id'))),
    'method' => 'post',
    'enctype' => 'multipart/form-data',
));

$form->setUseContainer(true);
$this->setForm($form);

$fieldset = $form->addFieldset('example_form', array(
     'legend' =>Mage::helper('categoryrules')->__('Example Information')
));

...

$entityType = Mage::getModel('eav/config')->getEntityType('test_category_rule');
$entityTypeId = $entityType->getEntityTypeId();

...

$fieldset->addField('entity_type_id', 'hidden', array(
      'name'               => 'entity_type_id',
      'value'              => $entityTypeId
)); 
```

输出：

```
<input id="entity_type_id" name="entity_type_id" value="" type="hidden"> 
```

**编辑：**

print_r($entityType->debug()) 的结果；

```
Array ( 
    [entity_type_id] => 11 
    [entity_type_code] => rogue_category_rule 
    [entity_model] => categoryrules/rules 
    [attribute_model] => 
    [entity_table] => categoryrules/rules 
    [value_table_prefix] => 
    [entity_id_field] => 
    [is_data_sharing] => 1 
    [data_sharing_key] => default 
    [default_attribute_set_id] => 0 
    [increment_model] => 
    [increment_per_store] => 0 
    [increment_pad_length] => 8 
    [increment_pad_char] => 0 
    [additional_attribute_table] => 
    [entity_attribute_collection] => 
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T10:10:14.180

尝试在这里写任何常量，例如：

```
$fieldset->addField('entity_type_id', 'hidden', array(
      'name'               => 'entity_type_id',
      'value'              => 11
)); 
```

或者：

```
$fieldset->addField('entity_type_id', 'hidden', array(
      'name'               => 'entity_type_id'
));
$form->setValues($entityType->getData()); 
```

# python - urllib2，机制不返回与浏览器相同 - 还有什么可以欺骗的？

> ID：10983772
> 
> 赞同：1
> 
> 时间：2012-06-11T16:08:11.470
> 
> 标签：python, mechanize, urllib2

我正在尝试创建一个脚本（纯粹的学习目的）来用几个不同的字典翻译给定的单词。我完成了两个，使用 urllib2 和 beautifulsoup 来获取和解析翻译，然后转到谷歌翻译。

我很快发现它返回 403 禁止错误。添加用户代理会获得翻译，但只有一个单词的翻译。为了说明这一点，请访问[http://translate.google.com/?text=test&sl=en&tl=es](http://translate.google.com/?text=test&sl=en&tl=es)，您将获得翻译（在名为“hps”的课程中）和动词、名词和形容词列表。但是使用下面的脚本和 html 是不同的，只返回主要翻译，并且在

```
span id=result_box 
```

找不到动词、名词等。

在这个过程中，经过一番谷歌搜索，我意识到现在有一​​个 API - 而不是免费的。我不打算发布任何最终脚本，也不打算用它来违反任何 TOS，但现在我最感兴趣的是为什么浏览器和 urllib 等之间的区别。

为此，我尝试了纯 urllib2 与用户代理，并机械化 - 如下所示。所以，我的问题是——除了用户代理，浏览器和 python 脚本还有什么区别？我尝试过使用萤火虫，但没有任何反应（尽管我是个菜鸟）。谢谢！

编辑：来自萤火虫的请求标头和我的脚本如下。

```
import mechanize
import re
import cookielib

# Browser
br = mechanize.Browser()

# Cookie Jar
cj = cookielib.LWPCookieJar()
br.set_cookiejar(cj)

# Browser options
br.set_handle_equiv(True)
br.set_handle_redirect(True)
br.set_handle_referer(True)
br.set_handle_robots(False)

# Follows refresh 0 but not hangs on refresh > 0
br.set_handle_refresh(mechanize._http.HTTPRefreshProcessor(), max_time=1)

# Want debugging messages?
br.set_debug_http(True)
br.set_debug_redirects(True)
br.set_debug_responses(True)

# User-Agent (this is cheating, ok?)
br.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1')]

# Open some site, let's pick a random one, the first that pops in mind:
r = br.open('http://translate.google.com/?text=test&sl=en&tl=es')
html = r.read()
match = re.findall(r'verb', html)

print match 
```

萤火虫：

```
GET /?text=test&sl=en&tl=es HTTP/1.1

Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Charset  ISO-8859-1,utf-8;q=0.7,*;q=0.7
Accept-Encoding gzip, deflate
Accept-Language en-us,en;q=0.5
Connection  keep-alive
Cookie  PREF=ID=298b435815ef8553:U=e7dad4baf65f083b:FF=0:LD=en:CR=2:TM=1327516863:LM=1339428154:S=maktYFZEHXXpMDFg; NID=60=U229h4lzOnjpHyidbhgYecCx72Myp_-XHgupW-R_mWtpuOveDdIOO1uLBq-6ltn-ER15ppJryR7yYOYEhkCfUCl45qNz5aymBQ1CGDHS4UcHu2oIDYAHut0ctnlL76eDW3n7kjOWoz5wNH6NMw
Host    translate.google.com
User-Agent  Mozilla/5.0 (Windows NT 6.1; WOW64; rv:9.0) Gecko/20100101 Firefox/9.0 
```

脚本：

> 发送：'GET /?text=test&sl=en&tl=es HTTP/1.1\r\n接受编码：身份\r\n主机：translate.google.com\r\n连接：关闭\r\n用户代理：Mozilla/5.0 (X11;U;Linux i686;en-US;rv:1.9.0.1) Gecko/2008071615 Fedora/3.0.1-1.fc9 Firefox/3.0.1\r\n\r\n' 回复：'HTTP/1.1 200 OK\r\n' 标头：日期：星期一，2012 年 6 月 11 日 16:13:42 GMT
> 
> 标头：到期时间：1990 年 1 月 1 日星期五 00:00:00 GMT
> 
> 标头：缓存控制：无缓存，必须重新验证
> 
> 标头：编译指示：无缓存
> 
> 标题：X-Frame-Options：SAMEORIGIN
> 
> 标题：内容类型：文本/html；字符集=UTF-8
> 
> 标题：内容语言：en
> 
> 标头：设置 Cookie：PREF=ID=6dd42f2264250d7c:TM=1333431222:LM=1339454222:S=k6JXSoGGaAMNmPEo；过期=格林威治标准时间 2014 年 6 月 11 日星期三 16:13:42；路径=/; 域=.google.com
> 
> 标头：Set-Cookie：NID=60=f8czmR413h3sKUGJUUM4PLKl2O7SUtqfW5hss5O54sRKoErf9wIEU4Wu2WCuHzWTJQ3p1Rj7dQv1B4BBmSMY1tmfus7UZGCYFIKaXoKwklZ9tZsr5vds8vvvFjRdZyevn；到期=格林威治标准时间 2012 年 12 月 11 日星期二 16:13:42；路径=/; 域=.google.com；HttpOnly
> 
> header: P3P: CP="这不是 P3P 政策！有关详细信息，请参阅 [http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657](http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657) 。"
> 
> 标头：X-Content-Type-Options：nosniff
> 
> 标头：服务器：HTTP 服务器（未知）
> 
> 标头：X-XSS-保护：1；模式=块
> 
> 标题：连接：关闭

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:45:07.560

找不到动词、形容词，因为它们是通过 AJAX 调用加载的。您的 mechanize 浏览器没有 javascript。因此它不能做任何 AJAX。但是，如果您可以查看浏览器的检查器或其他内容，您会看到调用的标题、URL 和参数。现在剩下要做的就是模仿召唤。

我卷曲它，我得到一个 JSON 响应：

```
thrustmaster@thrustmaster:~/Temp$ curl 'http://translate.google.com/translate_a/t?client=t&text=test&hl=en&sl=en&tl=es&multires=1&ssel=0&tsel=0&sc=1' -H 'User-Agent: blah'
[[["prueba","test","",""]],[["noun",["prueba","ensayo","test","examen","an�lisis","criterio","toque","ejercicio","tanteo"],[["prueba",["test","proof","evidence","trial","event","race"]],["ensayo",["test","trial","essay","assay","testing","rehearsal"]],["test",["test"]],["examen",["examination","review","exam","test","inspection","quiz"]],["an�lisis",["analysis","test","review","assay","breakdown"]],["criterio",["criterion","judgment","standard","test","view","yardstick"]],["toque",["touch","stroke","test","knock","blast","chime"]],["ejercicio",["exercise","practice","drill","practicing","test","prosecution"]],["tanteo",["score","scoring","trial","test","try","calculation"]]]],["adjective",["de prueba"],[["de prueba",["test","testing","trial","probationary","corrective"]]]],["verb",["probar","comprobar","ensayar","examinar","poner a prueba","experimentar","someter a prueba","interrogar","hacer investigaciones","justificar","graduar"],[["probar",["test","try","prove","taste","try out","sample"]],["comprobar",["check","test","prove","ascertain","make sure","substantiate"]],["ensayar",["test","try","rehearse","try out","assay","essay"]],["examinar",["examine","consider","review","look at","explore","test"]],["poner a prueba",["test","try","try out","prove","tempt","put through his paces"]],["experimentar",["experience","experiment","undergo","experiment with","feel","test"]],["someter a prueba",["test","try out","touch"]],["interrogar",["question","interrogate","examine","cross-examine","ask","test"]],["hacer investigaciones",["test"]],["justificar",["justify","warrant","substantiate","prove","make good","test"]],["graduar",["graduate","grade","calibrate","time","test"]]]]],"en",,[["prueba",[5],1,0,1000,0,1,0]],[["test",4,,,""],["test",5,[["prueba",1000,1,0],["prueba de",0,1,0],["ensayo",0,1,0],["de prueba",0,1,0],["test",0,1,0]],[[0,4]],"test"]],,,[["en"]],5]thrustmaster@thrustmaster:~/Temp$ 
```

现在，可能在您的脚本中，您必须从以下 URL 获取响应：

> [http://translate.google.com/translate_a/t?client=t&text=test&hl=en&sl=en&tl=es&multires=1&ssel=0&tsel=0&sc=1](http://translate.google.com/translate_a/t?client=t&text=test&hl=en&sl=en&tl=es&multires=1&ssel=0&tsel=0&sc=1)

PS：

如您所说，这可能是 TOS 问题，以防您打算使用此脚本。它始终是在 API 上使用的更好选择。您所依赖的 HTML 可以随时更改。

# google-apps-script - “作为参数传入的不兼容类型”

> ID：10983776
> 
> 赞同：-1
> 
> 时间：2012-06-11T16:08:49.533
> 
> 标签：google-apps-script

我收到此错误消息：

“作为参数传入的不兼容类型”

在我的程序空闲一段时间后（通常是在休息后返回，但有时会更快）。是否存在在一段时间后超时的变量？而且，我怎样才能更好地处理错误而不是收到这个神秘的错误消息？

有没有人在不同元素上错误地使用相同的 ID 时遇到过这种情况？

例如：

var lbl2=app.createLabel("Test1") .setId('idlabel');

var lbl3=app.createLabel("Test2") .setId('idlabel');

然后使用以下命令重置值：

app.getElementById("idlabel").setText('changed');

谢谢-JS

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-21T19:54:56.840

抱歉，下面的原始答案不正确...Google Apps 脚本可以成功地将对象作为参数传递，这不会导致“不兼容的类型错误消息”。-JS

经过非常困难的故障排除后，我发现了错误：当参数是对象时，Google Apps 脚本无法可靠地解析传递给函数的参数。例如：

```
function projEditNew(e){ 
var app = UiApp.getActiveApplication(); 
var project = new projectO(); 
project['op']='insert';
var title="New Project"; /*This causes incompatible type error Pass into project properties or other instead */ 
projEdit(project,app,title); 
return app; 
} 
```

# .net - 实例化新的 DataContext 和使用空数组参数调用 DataContext.Refresh 之间有区别吗？

> ID：10983777
> 
> 赞同：2
> 
> 时间：2012-06-11T16:08:55.120
> 
> 标签：.net, linq-to-sql

我在我正在维护的应用程序中遇到了这个 Linq to Sql 代码：

```
 dbDataContext db = new dbDataContext();
        db.Refresh(System.Data.Linq.RefreshMode.OverwriteCurrentValues); 
```

dbDataContext 是继承 System.Data.Linq.DataContext 的类

在此示例中，代码尝试刷新整个 DataContext，但它在 DataContext 实例化后立即被调用。这不是多余的吗？

此外，Refresh 调用似乎是在没有第二个参数的情况下调用[该方法的重载。](http://msdn.microsoft.com/en-us/library/bb534264.aspx)由于没有指定参数，所以没有要刷新的对象。那么在没有第二个参数的情况下，对 Refresh 的调用是否有任何目的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T14:07:11.923

`db.Refresh()`因为没有任何改变，所以不需要在 create 之后正确调用。

[http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.refresh.aspx](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.refresh.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T13:30:41.203

我终于开始使用 Telerik JustDecompile 来查看 .NET 代码，看看在没有第二个参数的情况下调用 Refresh 是否有任何目的。

缺少的第二个参数默认为包含 0 个项目的数组。因此，刷新逻辑在遇到 for..each 块时会提前退出。然后不会刷新任何项目。

总之，使用空白的第二个参数调用 Refresh 方法不会刷新 DataContext 中的任何项目。

# java - 参数的重新声明

> ID：10983779
> 
> 赞同：6
> 
> 时间：2012-06-11T16:08:57.450
> 
> 标签：java, parameters, static, pass-by-reference, pass-by-value

在查看 Selenium 源代码时，我在 PageFactory 中注意到以下内容：

```
public static <T> T initElements(WebDriver driver, Class<T> pageClassToProxy) {
  T page = instantiatePage(driver, pageClassToProxy);
  initElements(driver, page);
  return page;
}

public static void initElements(WebDriver driver, Object page) {
  final WebDriver driverRef = driver;
  initElements(new DefaultElementLocatorFactory(driverRef), page);
} 
```

拥有以下行有什么好处？

```
final WebDriver driverRef = driver; 
```

将参数设为final，然后在不声明新引用的情况下将其传递给下一个方法不是很有意义吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:19:28.103

好吧，答案是设置`final`一个变量并且只将它用作函数的参数是完全没有用的。在`DefaultElementLocatorFactory`构造函数中，与输入参数相关的变量可以自由地重新分配，因为它是原始引用的副本。

PS ...当然，除非按照OP的建议，输入参数改为声明`final`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:36:40.760

我能想到的最好的事情（假设 selene 开发人员对 java 的工作原理有一个基本的了解——我认为这是给定的）：

大概在有一个`DefaultElementLocatorFactory`类之前，该方法使用了一个匿名内部函数，当重构代码时，某些部分被忽略了。

# jquery - 更改 DOM 时，.on 无法按预期工作

> ID：10983782
> 
> 赞同：0
> 
> 时间：2012-06-11T16:09:17.523
> 
> 标签：jquery, jquery-on

这是我正在开发的网站：[http ://cirkut.net/sub/northwood/popunder/](http://cirkut.net/sub/northwood/popunder/)

本质上，我要做的是在将鼠标悬停在下拉列表上之后，您可以单击侧面的四个链接，它会根据您选择的内容更改内容。我的过滤在初始加载时起作用，但是在单击之后，可以说`Locations`，没有任何东西传播到中间和右侧的内容列。

到目前为止，这是关于 keyup 的代码：

```
$('.megaMenu .menuSearchBar').on("keyup",function(event){
            //NONE OF THIS FIRES AFTER SELECTING a MENU ITEM
            var activeitem = $('.leftmenu a.active').text();
            activeitem = activeitem.toLowerCase();
            activeitem = activeitem.split(' ').join('-');

            data = null;
            //Switch to determine which data to use during filtering
            switch(activeitem){
                case 'programs':
                    data = programs;
                    break;
                case 'locations':
                    data = locations;
                    break;
                case 'financial-aid':
                    data = financialaid;
                    break;
                case 'admissions':
                    data = admissions;
                    break;
            }
            var typedtext = $(this).val();
            var matching = new Array();
            for(index in data){
                for(i in data[index]){
                    if(data[index][i].toLowerCase().indexOf(typedtext.toLowerCase()) != -1){
                        matching.push(data[index][0]);
                        break;
                    }
                }
            }
            //Filtering code goes here, just know that it outputs
            //into the middle and right columns
});
$('.megaMenu .menuSearchBar').keyup(); //Propagate initial content in middle and left column 
```

为了切换项目，我有一个隐藏`<div>`的包含四个搜索列（左侧内容），当单击菜单项时它们都会发生变化。这是单击菜单项时的代码：

```
$('.leftmenu a').click(function(){
    var oldactive = active;
    $('.leftmenu a').removeClass('active');
    $(this).addClass('active');
    //Get the new active item and set it so it can be compared in the switch above
    var active = $('.leftmenu').find('.active').text();
    active = active.toLowerCase();
    active = active.split(' ').join('-');
    //Change the left content to the search bar correlating to item clicked 
    $('.superNav .left').html($('.hidden .'+active).html());
    //Clear out the middle and right content for new data
    $('.middle').html('');
    $('.right').html('');
    //Supposed to trigger the above .on() call to set the new content, but doesn't.
    $('.megaMenu .menuSearchBar').keyup();
}); 
```

无需单击任何侧面菜单项，该`on keyup`功能即可完美运行。

我的问题必须在`left`点击中，因为该`keyup`功能不再正确触发。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:14:39.663

这个

```
$('.megaMenu .menuSearchBar').on("keyup",function(event){ 
```

应该

```
$('body').on("keyup",'.megaMenu .menuSearchBar',function(event){ 
```

您可以将 body 替换为所选元素的任何父元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:12:51.083

如果您`.on`用于处理操纵的 Com，那么您使用的是`.on`错误的方式

```
$('body').on("keyup",.megaMenu .menuSearchBar,function(event){//first line should be like this 
```

正确的语法是

```
$("parent element").on(event,children element,function) 
```

它将事件绑定到父元素，但仅在子元素上发生事件时触发

# joomla2.5 - jdownload 恢复支持的链接，而 downliad 目录受保护

> ID：10983784
> 
> 赞同：0
> 
> 时间：2012-06-11T16:09:18.950
> 
> 标签：joomla2.5

我使用 jdownloads 我有一个罕见的集合，现在我正在保护我的下载区域，用户通过 php 下载高级文件，但这是我的高级用户现在访问链接但链接不支持恢复的问题，我不希望我的用户找到确切的文件位置，我希望他们为他们的下载会话下载恢复支持的链接，有什么建议吗？

如果我们禁用下载目录保护，一位高级用户可以共享链接，每个人都可以下载文件......所以我需要保护（使用 php 下载）并恢复支持的链接？？？

# php - 在 PHP 中发送通知电子邮件

> ID：10983790
> 
> 赞同：-1
> 
> 时间：2012-06-11T16:09:59.177
> 
> 标签：php, email

> **可能重复：**
> [使用 PHP 发送批量电子邮件](https://stackoverflow.com/questions/2938037/sending-bulk-emails-using-php)

有没有可以处理通过 PHP 不断发送电子邮件而没有问题的服务？我们希望每天或更多发送 500 多封电子邮件，并且担心使用 PHP 的内置邮件功能。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:13:55.183

内置邮件功能本身并没有什么问题，每天 500 封电子邮件几乎完全没有负担。PHP 只执行您配置的 MTA 可执行文件，例如 sendmail。

但是，我建议使用更好的邮件 API，例如[Swiftmailer](http://swiftmailer.org/)。这将使您能够构建带有 HTML、附件等的电子邮件，这比尝试生成自己的 MIME 消息要容易得多。

对于较大的邮件量，我建议使用第 3 方，例如[MailChimp](http://mailchimp.com/)（或许多其他人之一）。他们非常擅长让您远离垃圾邮件等黑名单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:25:18.167

每天 500 封电子邮件真的不算多。你有几个选择：

1.  从您的服务器自己发送邮件。您可以使用第三方库来处理众多选项。Swiftmailer、PHPMailer 等或者你自己的。从您自己的服务器发送，您将需要管理反向 DNS、SPF 记录等，并且（假设您在 Linux 上）将非常熟悉 Postfix 等。

2.  您可以选择使用第三方服务，例如[http://sendgrid.com/](http://sendgrid.com/)或[http://aws.amazon.com/ses/](http://aws.amazon.com/ses/)。这些本质上是使用简单 API 的即用即付邮件服务器。这可以帮助解决维护可靠邮件服务器所涉及的大量繁重工作。当您每天发送数千封电子邮件时，这会变得很复杂。节流，排队，负载平衡等。

3.  如果您正在进行电子营销，另一种选择是使用 Mailchimp 或 Campaign Monitor 等服务。这些将一次性为您完成所有校对、发送、节流和报告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:26:41.817

您可以毫无问题地使用 php 的 mail() 函数。但是大多数共享托管服务器不允许您发送大量电子邮件。您可以为此使用第三方 SMTP。

# c++ - C++ Transaction-like Pattern for All or nothing work

> ID：10983791
> 
> 赞同：10
> 
> 时间：2012-06-11T16:10:00.197
> 
> 标签：c++, design-patterns, transactional

假设我有两个函数——都能够抛出——`DoTaskA`以及它们对应的“回滚”函数和. 最好的模式是什么，以使两者都成功或都失败？`DoTaskB``TaskException``UndoTaskA``UndoTaskB`

我现在最好的是

```
bool is_task_a_done = false,
     is_task_b_done = false;

try {
    DoTaskA();
    is_task_a_done = true;

    DoTaskB();
    is_task_b_done = true;
} catch (TaskException &e) {
    // Before rethrowing, undo any partial work.
    if (is_task_b_done) {
        UndoTaskB();
    }
    if (is_task_a_done) {
        UndoTaskA();
    }
    throw;
} 
```

我知道这`is_task_b_done`是不必要的，但如果我们稍后添加第三个或第四个任务，展示代码对称性可能会很好。

由于辅助布尔变量，不喜欢此代码。也许新的 C++11 中有一些我不知道的东西，它可以更好地编码？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-11T16:38:46.430

一个小的 RAII 提交/回滚范围保护可能如下所示：

```
#include <utility>
#include <functional>

class CommitOrRollback
{
    bool committed;
    std::function<void()> rollback;

public:
    CommitOrRollback(std::function<void()> &&fail_handler)
        : committed(false),
          rollback(std::move(fail_handler))
    {
    }

    void commit() noexcept { committed = true; }

    ~CommitOrRollback()
    {
        if (!committed)
            rollback();
    }
}; 
```

所以，我们假设我们总是在事务成功后创建保护对象，并且`commit`只有在*所有*事务都成功后才调用。

```
void complicated_task_a();
void complicated_task_b();

void rollback_a();
void rollback_b();

int main()
{
    try {
        complicated_task_a();
        // if this ^ throws, assume there is nothing to roll back
        // ie, complicated_task_a is internally exception safe
        CommitOrRollback taskA(rollback_a);

        complicated_task_b();
        // if this ^ throws however, taskA will be destroyed and the
        // destructor will invoke rollback_a
        CommitOrRollback taskB(rollback_b);

        // now we're done with everything that could throw, commit all
        taskA.commit();
        taskB.commit();

        // when taskA and taskB go out of scope now, they won't roll back
        return 0;
    } catch(...) {
        return 1;
    }
} 
```

* * *

PS。正如*Anon Mail*所说，如果你有很多 taskX 对象，最好将所有这些*taskX*对象推送到一个容器中，从而为容器提供相同的语义（在容器上调用 commit 以使其提交每个拥有的保护对象）。

* * *

聚苯乙烯。原则上，您可以`std::uncaught_exception`在 RAII dtor 中使用，而不是显式提交。我更喜欢在此处显式提交，因为我认为它更清晰，并且如果您提前退出范围并使用 a`return FAILURE_CODE`而不是异常也可以正常工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-11T16:25:47.793

在 C++ 中很难实现事务一致性。Dobb 博士的期刊中描述了一种使用[ScopeGuard模式的好方法。](http://www.drdobbs.com/cpp/184403758?pgno=1)该方法的美妙之处在于，这需要在正常情况和异常情况下进行清理。它利用了确保对象析构函数在任何范围出口上调用的事实，而异常情况只是另一个范围出口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:20:08.547

你有没有想过CommandPattern？[命令模式说明](http://en.wikipedia.org/wiki/Command_pattern)

您将执行 DoTaskA() 所需的所有数据封装在命令类的对象中，另外，如果需要，您可以反转所有这些（因此，如果执行失败，则无需特殊撤消） . 命令模式特别适合处理“全有或全无”的情况。

如果您有多个相互依赖的命令，如您的示例可以阅读，那么您应该调查[责任链](http://en.wikipedia.org/wiki/Chain-of-responsibility_pattern)

也许反应器模式可能会派上用场（[这里的反应器描述](http://en.wikipedia.org/wiki/Reactor_pattern)）这将反转控制流，但它感觉很自然，并且具有将您的系统变成强大的多线程、多组件设计的好处。但在这里可能有点矫枉过正，很难从例子中看出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T16:54:42.610

实现这一点的最佳方法是使用范围保护，基本上是一个小的 RAII 习惯用法，如果抛出异常，它将调用回滚处理程序。

不久前我询问了 ScopeGuard 的简单实现，这个问题演变成我在生产项目中使用的一个很好的实现。它使用 c++11 和 lambdas 作为回滚处理程序。

我的源代码实际上有两个版本：一个在构造函数处理程序抛出时调用回滚处理程序，另一个在发生这种情况时不会抛出。

[在此处](https://stackoverflow.com/q/10270328/170521)查看源代码和使用示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-11T16:19:38.493

对于可伸缩性，您希望保存需要对容器中的任务执行撤消的事实。然后，在 catch 块中，您只需调用容器中记录的所有撤消操作。

例如，容器可以包含功能对象以撤消已成功完成的任务。

# python - 使用 minidom 获取元素的所有属性

> ID：10983794
> 
> 赞同：7
> 
> 时间：2012-06-11T16:10:14.763
> 
> 标签：python, xml, minidom

我想获取一个元素的所有属性（不知道属性的名称）。有什么功能吗？谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-11T16:22:01.817

```
>>> docu = '<a href="http" alt=":)"></a>'
>>> dom = xml.dom.minidom.parseString(docu)
>>> a = dom.getElementsByTagName("a")[0]
>>> a.attributes.items()
[(u'alt', u':)'), (u'href', u'http')] 
```

# ruby-on-rails - heroku 可以使用 ssl 的多个子域？

> ID：10983797
> 
> 赞同：3
> 
> 时间：2012-06-11T16:10:26.153
> 
> 标签：ruby-on-rails, ssl, https, heroku, routing

我在 heroku 上有这个应用程序，它的主要部分称为 app.example.com，我在 heroku 上有自定义域，并为其添加了端点 ssl。一切正常。顺便说一句，原来的 www.example.com 已经很老了，而且它托管在 Heroku 以外的其他地方。

在heroku上，我只是

```
heroku domains:add app.example.com 
```

现在，我们有一个订单表格供用户在使用该应用程序之前订购东西。并且客户端希望其 url 为 order.example.com 而不是 app.example.com/order。我从 RailsCasts 中查找了 Rails 中的路由约束来处理这个子域重定向，所以一切都很好。然后我将它添加到 heroku 的自定义域

```
heroku domains:add order.example.com 
```

然后我将 www.example.com 的原始主机上的 CNAME 更改为将 order.example.com 指向 myapps.herokuapps.com （或其他东西）。现在访问 order.example.com 确实将我带到了订单表格！只是 https 部分显示了通常的未经验证的证书警告。

所以我继续为自己获取另一个godaddy证书，但是现在当我尝试将证书添加到heroku时（我之前为app.example.com的https做过一次）

```
heroku certs:add ~/ssl/combined.crt ~/ssl/nopass.key 
```

将 SSL 端点添加到 order-dev... 失败！每个应用只允许一个 SSL 端点（尝试 certs:update 代替）

因此，似乎每个应用程序实际上不能拥有一个以上的 SSL 证书，这是否意味着我实际上也可以将我拥有的 app.example.com 证书用于 order.example.com？如果是这样，我必须配置什么？还是我做错了，如果是这样，我应该怎么做？

谢谢你在这里帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T19:11:13.603

您应该为 *.example.com 购买通配符证书，而不是购买多个证书。

# php - 可捕获的致命错误：SimpleImage 类的对象无法转换为字符串（转换 var 不起作用）

> ID：10983803
> 
> 赞同：0
> 
> 时间：2012-06-11T16:10:46.273
> 
> 标签：php, mysql

我实现了以下图像调整器：http: [//www.white-hat-web-design.co.uk/blog/resizing-images-with-php/](http://www.white-hat-web-design.co.uk/blog/resizing-images-with-php/)

现在我想将上传的图像插入数据库。

```
include('simple_image.php');
$image_rez = new SimpleImage();
$image_rez->load($file);
$image_rez->resizeToWidth(990);
$image_rez->save($image_name.'.jpg');

$sql = "INSERT INTO
            `Media_images` (`ID`,`Name`,`Image`,`Size`)
        VALUES
            (?, ?, ?, ?)
        ";

$stmt = $db->prepare($sql);

if (!$stmt) {
    echo 'Datenbankfehler\n';
    echo $db->error;
}

$stmt->bind_param('ssss', $_POST['id'], $image_name, (string)$image_rez, $image_size);

if (!$stmt->execute()) {
    echo 'Datenbankfehler\n';
    echo $stmt->error;
}

//Cache löschen
destroy(PATH);
//Redirekt wenn erfolgreich eingetragen
header("location:../../index.php?section=media");
die; 
```

但我收到以下错误：

可捕获的致命错误：SimpleImage 类的对象无法转换为字符串。

Error-Line 是我绑定 $image 的地方。如何将此对象转换为字符串？尝试强制转换 (string)($image_rez) 但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:13:00.243

$image_rez 将是一个图像，最好将其作为 blob 存储在数据库中。将 bind_param 中的类型更改为 b，并删除（字符串）。

此外， $image_rez 不是图片，而是您的整个 SimpleImage 对象。您应该在绑定中使用 file_get_contents($image_name.'.jpg') 而不是 $image_rez。

**注意**：数据库不是存储图像的正确位置。您应该将它存储在文件系统上，并带有存储在数据库中的图像的路径。

# c++ - 奇怪的链接错误

> ID：10983805
> 
> 赞同：2
> 
> 时间：2012-06-11T16:10:56.637
> 
> 标签：c++, visual-studio-2008, templates, reference, linker

我正在开发一个大型 c++ 项目并更改其他人的代码。在此期间，我收到一个链接器错误，指出引用`VarA`是多重定义的。我找到了相应的变量，它已经定义在一个直接包含在项目中的 cpp 文件中。我试图将源文件转换为头文件和源文件，但不起作用。

然后我尝试将变量声明移动到仅包含此变量的新单独 h/cpp 中，它看起来像：

h 文件 (aaa.h)

```
#ifndef AAA_H
#define AAA_H

#include "classAdefinition.h"
extern ClassA VarA;

#endif 
```

cpp 文件 (aaa.cpp)

```
#include "aaa.h"
ClassA VarA; 
```

如果我现在包含`aaa.h`在主文件中，则链接器错误会将新创建的内容添加`aaa.obj`到错误消息中（例如`VarA`，也在那里定义），这正是我所期望的。但是当我删除主文件中的定义时，我得到一个未定义`VarA`的链接器错误，这真的很令人困惑。`VarA`

有谁知道这种行为的原因可能是什么？

我使用的是 VS2008，项目是用`cmake`. 这可能会导致问题吗？例如，可能存在配置问题吗？我们也经常使用模板，这会导致问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T08:56:21.113

我还没有发现错误，但是现在已经避免了这个问题，因为大部分第三方代码已经更改并且不再出现错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T17:53:11.620

为了消除由于多次循环调用而发生的多个定义错误，我建议您应该做的第一件事是编辑头文件以包含以下宏（无论您的情况如何）给每个文件一个唯一的名字

```
#ifndef CAR_HPP
#define CAR_HPP
class Car 
    {
    public:
    ....
    protected:
    ....
    };
#endif 
```

# perl - 在 Perl 中通过目录递归时使用 ARGV

> ID：10983810
> 
> 赞同：2
> 
> 时间：2012-06-11T16:11:10.163
> 
> 标签：perl, argv

我想要做的是让我的程序通过一个目录递归，并且对于目录中的所有这些文件，在每个文件中搜索单词“ERROR”，然后在单独的文件中打印它的实例。我能够做到这一点而无需使其递归，即只需在 cmd 中输入要手动检查的文件。我想知道递归时使用 ARGV 的正确方法是什么。到目前为止，这是我的代码：

```
#!/usr/bin/perl
use strict;
use warnings;
use File::Find;

my $dir = "c:/programs";

find(\&searchForErrors, $dir);

sub searchForErrors()
{
my $seen = 0;

if (-f){
    my $file = $_;
    my @errors = ();

    open FILE, $file;
    my @lines = <FILE>;
    close FILE;

    for my $line (@lines){
        if (/ERROR/ ){
        push(@errors, "ERROR in line $.\n");
        print FILE "ERROR in line $.:$1\n" if (/Error\s+(.+)/);
    }
    open FILE, ">$file";
    print FILE @lines;
    close FILE;
    }
}
} 
```

我需要知道的是如何合并 ARGV，以便程序读取目录中的每个文件，执行搜索，然后将搜索结果输出到文件中。我希望我已经充分解释了我的问题，如果您需要任何澄清，请告诉我什么是令人困惑的。您可以对答案给出的解释越多越好。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T16:39:47.280

`ARGV`通常用于迭代从 Perl 外部提供的文件。

```
 $ find -type f --exec perl script.pl {} +

 # script.pl
 while (<>) {
     print "$ARGV:$.: $1\n" if /Error\s+(.+)/;
 } continue {
     close(ARGV) if eof;  # Reset $.
 } 
```

但这不是必需的。你也可以这样做：

```
 use File::Find::Rule qw( );

 @ARGV = File::Find::Rule->file->in('.');
 while (<>) {
     print "$ARGV:$.: $1\n" if /Error\s+(.+)/;
 } continue {
     close(ARGV) if eof;  # Reset $.
 } 
```

我更喜欢[File::Find::Rule](http://search.cpan.org/perldoc?File%3a%3aFind%3a%3aRule)，但你可以坚持使用[File::Find](http://search.cpan.org/perldoc?File%3a%3aFind)，因为如果你将上面的代码片段与下面的代码片段进行比较，这些原因应该很明显：

```
use File::Find qw( find );

@ARGV = ();
find({ wanted => sub { push @ARGV, $_ if -f }, no_chdir => 1 }, '.');

 while (<>) {
     print "$ARGV:$.: $1\n" if /Error\s+(.+)/;
 } continue {
     close(ARGV) if eof;  # Reset $.
 } 
```

PS - 您正在用其自身的精确副本替换每个文件，并且您正在填充一个您从未使用过的数组。我从我的版本中省略了该代码。

# c# - 委托（Lambda 表达式）与接口和抽象类

> ID：10983812
> 
> 赞同：19
> 
> 时间：2012-06-11T16:11:31.423
> 
> 标签：c#, api, design-patterns

我一直在寻找这个设计问题的简洁答案，但没有成功。[我在“.NET Framework 设计指南”](http://msdn.microsoft.com/en-us/library/ms229042.aspx)和[“C# 编程指南”](http://msdn.microsoft.com/en-us/library/67ef8sbd)中都找不到帮助。我基本上必须将模式公开为 API，以便用户可以定义他们的算法并将其集成到我的框架中，如下所示：

**1)**

```
// This what I provide
public abstract class AbstractDoSomething{
   public abstract SomeThing DoSomething();
} 
```

用户需要实现这个抽象类，他们必须实现`DoSomething`方法（我可以从我的框架中调用并使用它）

**2)**

我发现这也可以通过使用委托来实现：

```
public sealed class DoSomething{
   public String Id;
   Func<SomeThing> DoSomething;
} 
```

在这种情况下，用户只能以`DoSomething`这种方式使用类：

```
DoSomething do = new DoSomething()
{
  Id="ThisIsMyID",
  DoSomething = (() => new Something())
} 
```

**问题**

这两个选项中的哪一个最适合作为 API 公开**的简单、可用且最重要的是可理解的？**

**编辑**

如果是**1**：注册是以这种方式完成的（假设`MyDoSomething`extends `AbstractDoSomething`：

```
MyFramework.AddDoSomething("DoSomethingIdentifier", new MyDoSomething()); 
```

如果是**2**：注册是这样完成的：

```
MyFramework.AddDoSomething(new DoSomething()); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-11T16:19:52.110

> 这两个选项中的哪一个最适合作为 API 公开的简单、可用且最重要的是可理解的？

第一个在 OOP 方面更“传统”，对于许多开发人员来说可能更容易理解。它还可以在允许用户管理对象的生命周期方面具有优势（即：您可以让类`IDisposable`在关闭时实现和处置实例等），以及易于在未来版本中以某种方式扩展不会破坏向后兼容性，因为向基类添加虚拟成员不会破坏 API。最后，如果您想使用 MEF 之类的东西来自动组合它，它可以更简单地使用，这可以从用户的角度简化/删除“注册”过程（因为他们可以只创建子类，并将其放入文件夹，并自动发现/使用它）。

第二种是更实用的方法，并且在许多方面更简单。这允许用户在对现有代码的更改少得多的情况下实现您的 API，因为他们只需要将必要的调用包装在带有闭包的 lambda 中，而不是创建新类型。

话虽这么说，如果您要采用使用委托的方法，我什至不会让用户创建一个类 - 只需使用如下方法：

```
MyFramework.AddOperation("ThisIsMyID", () => DoFoo()); 
```

在我看来，这使您更清楚地知道您正在直接向系统添加操作。它还完全消除了公共 API ( `DoSomething`) 中对另一种类型的需求，这再次简化了 API。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-11T16:22:16.267

如果出现以下情况，我会使用抽象类/接口：

*   DoSomething 是必需的
*   DoSomething 通常会变得非常大（因此 DoSomething 的实现可以分成几个私有/受保护的方法）

如果出现以下情况，我会和代表一起去：

*   DoSomething 可以被视为一个事件（OnDoingSomething）
*   DoSomething 是可选的（因此您将其默认为无操作委托）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-11T17:57:06.777

虽然就个人而言，如果在我手中，我总是会选择代表模型。我只是喜欢高阶函数的简单和优雅。但是在实现模型时，要小心内存泄漏。订阅事件是 .Net 中内存泄漏的最常见原因之一。这意味着，假设如果您有一个暴露了一些事件的对象，那么原始对象将永远不会被释放，直到所有事件都被取消订阅，因为事件创建了一个强引用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T16:23:47.917

正如大多数此类问题的典型情况一样，我会说“视情况而定”。:)

但我认为使用抽象类而不是 lambda 的原因实际上归结为行为。通常，我认为 lambda 被用作回调类型的功能——您希望在发生其他事情时发生一些自定义的事情。我在客户端代码中经常这样做： - 进行服务调用 - 获取一些数据 - 现在调用我的回调以相应地处理该数据

您可以对 lambda 执行相同的操作——它们是特定的并且针对非常特定的情况。

使用抽象类（或接口）实际上归结为你的类的行为是由它周围的环境驱动的。发生了什么，我在处理什么客户等？这些更大的问题可能表明您应该定义一组行为，然后允许您的开发人员（或 API 的消费者）根据他们的要求创建自己的行为集。当然，您可以对 lambdas 做同样的事情，但我认为开发起来会更复杂，与用户进行清晰的沟通也会更复杂。

所以，我想我粗略的经验法则是： - 将 lambdas 用于特定的回调或副作用自定义行为；- 使用抽象类或接口为对象行为定制（或至少对象的大部分主要行为）提供机制。

对不起，我不能给你一个明确的定义，但我希望这会有所帮助。祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-11T16:27:52.817

需要考虑的几件事：

需要覆盖多少个不同的函数/委托？如果可能起作用，继承将以更易于理解的方式对“组”覆盖进行分组。如果您只有一个“注册”功能，但可以将许多子部分委托给实现者，这是“模板”模式的经典案例，最适合被继承。

需要多少个相同功能的不同实现？如果只有一个，那么继承很好，但如果你有很多实现，委托可能会节省开销。

如果有多个实现，程序是否需要在它们之间切换？或者它只会使用一个实现。如果需要切换，代表可能会更容易，但我会提醒这一点，尤其是取决于对#1 的回答。请参阅策略模式。

如果覆盖需要访问任何受保护的成员，那么继承。如果它只能依赖于公众，那么委托。

其他选择是事件和扩展方法。

# assembly - 添加两个寄存器时操作码和操作数的组合无效

> ID：10983819
> 
> 赞同：1
> 
> 时间：2012-06-11T16:12:08.147
> 
> 标签：assembly, x86, nasm

我正在编写一段汇编代码，旨在使用 BIOS 中断获取键盘输入，然后使用另一个 BIOS 中断将其打印到屏幕上。我正在为 x86 系统使用 NASM 编译器。在我的代码的第 19 行（标有星号 (*)，我收到“操作码和操作数的无效组合”错误。我知道这通常代表任意数量的语法错误，但在我的技能水平上，我不能工作到任何细节，对不起。这是我的代码块：

```
 ; ---------------------------------------------
; Get input (hangs on input and loops forever)
; ---------------------------------------------
GetInput:

XOR AH, AH                 ;AH = 0 for interrupt 16.0
INT 0x16                   ;Fetch the next key pressed.
MOV SI, keymap             ;Set SI to the head pointer of the keymap
ADD SI, AH                 ;Increase the pointer by the key number.
*MOV AL, [SI]              ;Load the returned key for printing.
CALL PrintCharacter        ;Print the key
CALL GetInput              ;Wait on the next key.
RET 
```

如果您需要更多信息，请告诉我，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:33:00.527

我相信你的错误是之前的一行。您不能在 x86 中混合使用 16 位和 8 位寄存器，例如：

```
ADD SI, AH 
```

如果要将 AH 寄存器添加到 SI，而不是先将 AH 复制（零扩展）到 AX，例如：

```
MOVZX AX, AH
ADD   SI, AX 
```

# asp.net-mvc-3 - 参考内置 Account UserId 分配给 Model 作为外键

> ID：10983824
> 
> 赞同：0
> 
> 时间：2012-06-11T16:12:27.090
> 
> 标签：asp.net-mvc-3

在已经存在的问题中寻找答案之后，我仍然对应该如何进行感到有些困惑。我是 MVC 3 框架的新手，所以如果我听起来像个笨蛋，我道歉！

好的，所以我创建了一个 MVC 3 互联网应用程序，创建了 3 个新用户管理员、用户 1 和用户 2。我为我的“帖子”创建了一个新模型和控制器，我可以添加、编辑和删除项目。我目前在我的帖子表中有一个名为 UserID 的列。我希望它自动填充当前的用户 ID。我想我会在控制器中这样定义：

```
 [HttpPost]
    public ActionResult Create(Post post)
    {
        if (ModelState.IsValid)
        {

            public int User = System.Web.Security.Membership.GetUser(id);

            db.Posts.Add(post);
            db.SaveChanges();
            return RedirectToAction("Index");  
        }

        return View(post);
    } 
```

在模型内部，这是我目前拥有的：

```
 public class Post
    {
        public int PostID { get; set; }
        public int UserID { get; set; }
        public string PostTitle { get; set; }
        public int PostType { get; set; }
        public string PostBody { get; set; }
        public string PostBlogTitle { get; set; }
        public string PostBlogURL { get; set; }
        public string PostCategory { get; set; }
        public string PostSEO { get; set; }
        public int PostStatus { get; set; }
    }

    public class PostDBContext : DbContext
    {
        public DbSet<Post> Posts { get; set; }
    } 
```

我想`public int UserID { get; set; }`用控制器中新定义的变量替换，但不确定在哪里/如何添加它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:23:21.720

不确定我是否清楚您要达到的目标。您是否只是想将当前用户分配给模型，保存它然后将其传递回视图？

如果是这样，您可以这样做：

```
[HttpPost]
public ActionResult Create(Post post)
{
    if (ModelState.IsValid)
    {
        // Note: I'm assuming this actually works/returns an int
        public int User = System.Web.Security.Membership.GetUser(id);

        post.UserID = User;

        db.Posts.Add(post);
        db.SaveChanges();
        return RedirectToAction("Index");  
    }

    return View(post);
} 
```

# python - 如何使用带有 pywebkit 的纯 python 配置代理设置

> ID：10983827
> 
> 赞同：1
> 
> 时间：2012-06-11T16:12:32.967
> 
> 标签：python, proxy, webkit

我在寻找答案时遇到了这个[问题，但它使用 ctypes 来完成代理配置。](https://stackoverflow.com/questions/6915840/python-webkit-with-proxy-support)有没有办法用纯 python 做到这一点，还是 ctypes 是唯一的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:53:23.387

上游错误跟踪器上有一个错误报告，其中有一个补丁可以`set_proxy`向模块添加功能`webkit`。

到目前为止，它还没有出现在发布的版本中，但是从 git 构建应该允许使用它。

[http://code.google.com/p/pywebkitgtk/issues/detail?id=53](http://code.google.com/p/pywebkitgtk/issues/detail?id=53)

# php - 具有 ManyToOne 字段的教义 @UniqueEntity？

> ID：10983828
> 
> 赞同：7
> 
> 时间：2012-06-11T16:12:37.950
> 
> 标签：php, symfony, doctrine, doctrine-orm, many-to-one

我正在尝试创建一个具有 2 个字段（都是 ManyToOne 字段）的 UniqueEntity。

代码如下：

```
/*
* @ORM\Table()
* @ORM\Entity
* @ORM\HasLifecycleCallbacks()
* @UniqueEntity(fields={"user", "connect"})
*/
class UserConnect
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @var boolean $isLeader
     *
     * @ORM\Column(name="isLeader", type="boolean")
     */
    private $isLeader;

    /**
     * @var date $joinedDate
     *
     * @ORM\Column(name="joinedDate", type="date")
     */
    private $joinedDate;

    /**
     * @ORM\ManyToOne(targetEntity="User", inversedBy="userConnects")
     * 
     */
    private $user;

    /**
     * @ORM\ManyToOne(targetEntity="Connect", inversedBy="userConnects")
     * 
     */
     private $connect; 
```

目标是确保我只有一个将 USER 与 CONNECT 链接的实体。

我应该在`@UniqueEntity`声明中写其他内容吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-06-02T20:40:48.517

*我知道只有当一条记录的用户*和*连接*字段在数据库中的另一条记录中重复时，您才希望得到一个错误。

@UniqueEntity注释是为您的***目的***正确声明的（多列索引），但只会在表单验证中触发，不会影响 DDBB 模式。

如果要在数据库级别添加相同的检查，则应在 Table() 声明中使用***@UniqueConstraint***注释并为新索引命名。就像是：

```
/*
* @ORM\Table(uniqueConstraints={@ORM\UniqueConstraint(name="IDX_USER_CONNECT", columns={"user_id", "connect_id"})})
* @ORM\Entity
* @ORM\HasLifecycleCallbacks()
* @UniqueEntity(fields={"user", "connect"})
*/
class UserConnect
{ 
```

另一方面，如果您在每个属性中声明***@ORM\Column(unique=true)***，您将获得非常不同的行为，它不会是多列索引，但如果您输入两次，您将拥有两个独立的唯一列相同的 user_id 您将得到一个独立于 connect_id 值的错误，如果您输入两次相同的 connect_id 值，也会发生同样的情况。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-08T12:52:19.237

这有效：

```
/**
 * State
 *
 * @ORM\Table(
 *  name="general.states",
 *  uniqueConstraints={
 *      @ORM\UniqueConstraint(name="states_country_name_code_key", columns={"idcountry", "name","code"}),
 *  })
 * @ORM\Entity(repositoryClass="Fluency\Bundle\GeneralBundle\Entity\Repository\StateRepository")
 */
class State
{....... 
```

取自我系统上的一个实体。这种方式会影响数据库模式。看看我放在哪里`@\ORM\UniqueConstraint annotation`。对不起@estopero ...下次我必须先阅读其他答案。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-08T15:37:24.333

您也应该在属性注释中添加唯一声明。

```
 /**
 * @ORM\ManyToOne(targetEntity="User", inversedBy="userConnects")
 * @ORM\Column(unique=true)
 */
private $user;

/**
 * @ORM\ManyToOne(targetEntity="Connect", inversedBy="userConnects")
 * @ORM\Column(unique=true)
 */
 private $connect; 
```

请参阅此[symfony 文档](http://symfony.com/doc/2.0/reference/constraints/UniqueEntity.html)和此 StackOverflow[答案](https://stackoverflow.com/questions/8545561/unique-constraints-in-doctrine-2-symfony-2)。

# c# - 以数组形式获取 gridcontrol 记录

> ID：10983829
> 
> 赞同：0
> 
> 时间：2012-06-11T16:12:39.693
> 
> 标签：c#, devexpress, gridcontrol

如何将`gridcontrol`记录作为数组获取？

我将一个数组设置为 a `datasource`for a `gridcontrol (devExpress component)`。

```
PersonFamily4grid[] tmpPersonFamily = new PersonFamily4grid[PersonFamiliesCOUNT];
for (int i = 0; i < PersonFamiliesCOUNT; i++)
{
    tmpPersonFamily[i] = new PersonFamily4grid();
    tmpPersonFamily[i].BirthDate = PersonFamilies[i].BirthDate;
    tmpPersonFamily[i].Job = PersonFamilies[i].Job;
    tmpPersonFamily[i].CodeMelli = PersonFamilies[i].CodeMelli;
    tmpPersonFamily[i].NameFamily = PersonFamilies[i].NameFamily;
    tmpPersonFamily[i].Nesbat = FamilyInfo_cbe_Nesbat.Properties.Items[PersonFamilies[i].Nesbat].ToString();
    tmpPersonFamily[i].Taahol = FamilyInfo_cbe_Taahol.Properties.Items[Convert.ToInt32(PersonFamilies[i].Taahol)].ToString();
}
grid_Family.DataSource = tmpPersonFamily; 
```

现在，当用户更改数据时`gridcontrol`，我想从网格中获取更改并影响我的基本数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T19:05:34.510

尝试：

```
PersonFamily4grid[] personFamily = (PersonFamily4grid[])grid_Family.DataSource; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T10:10:57.590

> 当用户更改网格控件中的数据时，我想从网格中获取更改并影响我的基本数组。

如果要反映对主数组的更改，为什么要创建临时数组`PersonFamilies`。只需简单地分配`PersonFamilies`给 gridControl 的数据源，它就会自动反映对`PersonFamilies`.

如果您知道该类对象是引用类型，那么如果您将数组直接分配给 gridControls 数据源，它们的引用将不会改变：

```
grid_Family.DataSource = PersonFamilies; 
```

在网格视图中对数据进行一些更改后，检查`PersonFamilies`它们是否更新的数组对象。它肯定会更新对象数组。

如果您想处理包含在您的数组中的一些自定义数据，那么您可以在不通过 GridControl 的属性的情况下获取`PersonFamilies`Iterate 您的临时数组，这完全取决于您将如何操作或反映对主数组的更改。`tmpPersonFamily``DataSource``PersonFamilies`

例如

```
for (int i = 0; i < PersonFamiliesCOUNT; i++)
{                
    PersonFamilies[i].BirthDate = tmpPersonFamily[i].BirthDate;
    PersonFamilies[i].Job = tmpPersonFamily[i].Job;
    PersonFamilies[i].CodeMelli = tmpPersonFamily[i].CodeMelli;
    PersonFamilies[i].NameFamily = tmpPersonFamily[i].NameFamily;  
} 
```

希望这有帮助..

# ios - 非法文本重定位错误，如何嵌入文本文件？

> ID：10983832
> 
> 赞同：1
> 
> 时间：2012-06-11T16:12:44.907
> 
> 标签：ios, ipad, parsing

我目前正在开发一个应用程序，其中第一步是加载文本文件并读取其内容。

例如：

```
string file = "myfile.txt"; 
```

我正在调用另一个函数，我想在其中查找某种模式/出现

```
void read(string pattern, const char *content) {

   char subString [blocksize];
   int n;

   char *search = pattern;
   pos = strstr(content,search);

   ..... 
```

该函数在我的 Mac 上完美运行，但是一旦我尝试编译应用程序，编译器就会抛出一些错误`ld : illegal text-relocation.`

文本文件与目标应用程序位于同一文件夹中。我假设这与嵌入文本文件有关？

希望有人可以提供帮助或提示！提前致谢

# google-maps-api-3 - 仅在单击时创建标记类别和显示标记

> ID：10983837
> 
> 赞同：0
> 
> 时间：2012-06-11T16:13:13.470
> 
> 标签：google-maps-api-3

我正在尝试创建标记类别并在单击时显示标记...

例如，“Eat”、“Banks”、“Places of Interest”并单击它们只会产生这些类别中的标记。[你可以在这里](http://calwestcultural.com/sgs/backup/example-map.html)看到它

这是一个代码片段：

```
//<![CDATA[

//<![CDATA[

var map = null;

var gmarkers = [];

var gicons = [];

var icon = [];

function initialize() {

var myOptions = {

zoom: 13,

center: new google.maps.LatLng(37.979183,-121.302381),

mapTypeControl: true,

mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},

navigationControl: true,

mapTypeId: google.maps.MapTypeId.ROADMAP

  }

map = new google.maps.Map(document.getElementById("map_canvas"),

                            myOptions);

google.maps.event.addListener(map, 'click', function() {

infowindow.close();

});

// Add markers to the map

// Set up three markers with info windows 

///////////////////////// EATS //////////////////////////////////////////////

var point = new google.maps.LatLng(37.988012,-121.311901); 

var image = 'icons/orangepointer.png';

var marker = createMarker(point,'<div style="width:205"><center><img src="icons/tigeryogurt.jpg" /></center><br><b>Tiger Yogurt</b><small><br>4343 Pacific Avenue<br>209.952.6042<br><br><a href="http://maps.google.com/maps?saddr=&daddr=' + point.toUrlValue() + '" target ="_blank">Get Directions<\/a></small><\/div>', image);

// this will be gmarkers[0]

var point = new google.maps.LatLng(37.987054,-121.311655); 

var image = 'icons/orangepointer.png';

var marker = createMarker(point,'<div style="width:205"><center><img src="icons/mwbakery.jpg" /></center><br><b>M&W Bakery<br>Cakes & Sandwiches</b><small><br>4343 Pacific Avenue<br>209.473.3828<br><br>On the web visit:<br><a href="http://www.mandwdutchamericanbakery.com" target ="_blank">MandWDutchAmericanBakery.com<\/a><br><br><a href="http://maps.google.com/maps?saddr=&daddr=' + point.toUrlValue() + '" target ="_blank">Get Directions<\/a></small><\/div>', image);

// this will be gmarkers[1] 
```

目前，所有标记都会显示。我可以很容易地让标记不显示......但是，我试图只显示类别和仅在点击时显示单个列表！

创建标记功能：

```
 }

var infowindow = new google.maps.InfoWindow(
{ 
size: new google.maps.Size(150,50)
});

function triggerClick(i) {
  google.maps.event.trigger(gmarkers[i],"click")
  };

function createMarker(latlng, html, img) {
var contentString = html;
var marker = new google.maps.Marker({
    position: latlng,
    map: map,
    icon: img,
    zIndex: Math.round(latlng.lat()*-100000)<<5
    });

google.maps.event.addListener(marker, 'click', function() {
    infowindow.setContent(contentString); 
    infowindow.open(map,marker);
});
gmarkers.push(marker);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T14:07:39.413

我认为最简单的方法是将标记分配给数组，每个标记在创建时都具有 setMarker(null)。您可以为每个类别使用一个单独的数组，或者使用一个对象数组，每个对象都具有一个类别属性。然后，当用户单击某个类别时，您将遍历适当的数组并为其每个标记设置 setMarker(map)。

# ios - Web 服务到 Xcode 加密

> ID：10983839
> 
> 赞同：1
> 
> 时间：2012-06-11T16:13:23.970
> 
> 标签：ios, xcode, web-services, encryption, aes

我正在尝试加密 iPhone 上的数据并将加密的文本发送到 Web 服务以供他们解密。如果解密有效，那么它将返回 xml 中的名字作为确认工作。这是我的 Xcode

注意：*“key”在 xcode 和 web 服务中是相同的*

我要加密的信息：

```
NSString *fnameencrypted = [[NSString alloc] AES256EncryptWithKey:f_name.text withKey:key]];    
NSString *lnameencrypted = [[NSString alloc] AES256EncryptWithKey:l_name.text withKey:key]]; 
```

NSString 方法

```
-(NSString *)AES256EncryptWithKey:(NSString *)plaintext withKey:(NSString *)key{
    NSData *plainData = [plaintext dataUsingEncoding:NSASCIIStringEncoding];
    NSData *encryptedData = [plainData AES256EncryptWithKey:key];  
    NSString *encryptedString = [encryptedData base64Encoding];
    return encryptedString;
} 
```

***编辑***

加密方式

```
-(NSData *)AES256EncryptWithKey:(NSString *)key{
    char keyPtr[kCCKeySizeAES256 + 1]; // room for terminator (unused)
    bzero(keyPtr, sizeof(keyPtr)); // fill with zeroes (for padding)

    // fetch key data
    [key getCString:keyPtr maxLength:sizeof(keyPtr) encoding:NSASCIIStringEncoding];

    NSUInteger dataLength = [self length];

    //See the doc: For block ciphers, the output size will always be less than or 
    //equal to the input size plus the size of one block.
    //That's why we need to add the size of one block here
    size_t bufferSize = dataLength + kCCBlockSizeAES128;
    void *buffer = malloc( bufferSize );

    size_t numBytesEncrypted = 0;

    CCCryptorStatus cryptStatus = CCCrypt(kCCEncrypt, kCCAlgorithmAES128, kCCOptionECBMode + kCCOptionPKCS7Padding,
                                      keyPtr, kCCKeySizeAES256,
                                      NULL /* initialization vector (optional) */,
                                      [self bytes], dataLength, /* input */
                                      buffer, bufferSize, /* output */
                                      &numBytesEncrypted);
    if(cryptStatus == kCCSuccess){
        //the returned NSData takes ownership of the buffer and will free it on deallocation
        return [NSData dataWithBytesNoCopy:buffer length:numBytesEncrypted];
    }

    free(buffer); //free the buffer
    return nil;
} 
```

这是我的网络服务代码

```
private static string Decrypt(string encryptedText, string completeEncodedKey, int keySize)
{
    RijndealManaged aesEncryption = new RijndealManaged();
    aesEncryption.KeySize = keySize; //keySize is 256
    aesEncryption.BlockSize = 128;
    aesEncryption.Mode = CipherMode.ECB;
    aesEncryption.Padding = PaddingMode.PKCS7;
    aesEncryption.IV = Convert.FromBase64String(ASCIIEncoding.ACSII.GetString(Convert.FromBase64String(completeEncodedString)).Split(',')[0]);
    aesEncryption.Key = Convert.FromBase64String(ASCIIEncoding.ACSII.GetString(Convert.FromBase64String(completeEncodedString)).Split(',')[1]);
    ICryptoTransform decrypto = aesEncryption.CreateDecryptor();
    byte[] encryptedBytes = Convert.FromBase64CharArray(encryptedText.ToCharArray(), 0, encryptedText.Length);
    return ASCIIEncoding.ASCII.GetString(decrypto.TransformFinalBlock(encryptedBytes, 0, encryptedBytes.Length);
} 
```

此代码不起作用，因为它返回

```
<response><return>0</return></response> 
```

# android - 从非活动传递上下文

> ID：10983844
> 
> 赞同：0
> 
> 时间：2012-06-11T16:13:43.330
> 
> 标签：android, sqlite

我还真的掌握了我们在 android 编程中发现的很多内容。所以我尝试创建一个函数来删除我的所有表，这是我的部分代码：

```
public class DBAdapter {
       private static class DbHelper extends SQLiteOpenHelper {
        private boolean databaseCreated = false;
        public DbHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        public void deleteTables(){
        Log.d("DBAdapter","dlm drop tables pre");
        this.sqlDatabase.execSQL("DROP TABLE IF EXISTS ["+TABLE_TV+"];");
        this.sqlDatabase.execSQL("DROP TABLE IF EXISTS ["+TABLE_CAMERA+"];");
        this.sqlDatabase.execSQL("DROP TABLE IF EXISTS ["+TABLE_GPS+"];");
       }
}
} 
```

以及我要调用函数 deleteTables 的部分

```
public class UpdateDatabase {
     public void updateTable(String table,JSONObject jsonObject){
    DBAdapter db = new DBAdapter(this);
        db.deleteTables();
    }
} 
```

但当然它会返回一个错误，因为 DBAdapter 需要一个上下文。公共类 UpdateDatabase 不是活动类。从活动类调用 DbAdapter db = new DBAdapter(this) 只会找到。那么我如何找到解决这个问题的方法呢？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:31:55.053

您可以将构造函数添加到`UpdateDatabase`接受 a`Context`并存储它，以便它可供`updateTable`. 像这样的东西：

```
public class UpdateDatabase {
    private final Context mContext;

    public UpdateDatabase(Context context){
        mContext = context;
    }

    public void updateTable(String table,JSONObject jsonObject){
        DBAdapter db = new DBAdapter(mContext);
        db.deleteTables();
    }
} 
```

现在，无论何时你`new UpdateDatabase()`都需要这样做`new UpdateDatabase(..context..)`。如果您是从 执行此`Activity`操作，那么您可以执行此操作`new UpdateDatabase(this)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:27:22.020

嗨看看这段代码..

```
public class DbManager
{
// the Activity or Application that is creating an object from this class.
Context context;
CustomSQLiteOpenHelper helper;
// a reference to the database used by this application/object
protected SQLiteDatabase db;
private static DbManager INSTANCE;
// These constants are specific to the database. 
protected final String DB_NAME = "yourDB";
protected final int DB_VERSION = 1;

public DbManager(Context context)
{
    this.context = context; 
    // create or open the database
    helper = new CustomSQLiteOpenHelper(context);
    this.db = helper.getWritableDatabase();
}
public static DbManager getInstance(Context context){
    if(INSTANCE == null)INSTANCE = new DbManager(context);
    return INSTANCE;
    }
public void db_Close()
{
    if(helper!=null){
        helper.close();
    }
    this.db.close();
}

private class CustomSQLiteOpenHelper extends SQLiteOpenHelper
{

    public CustomSQLiteOpenHelper(Context context)
    {
        super(context, DB_NAME, null, DB_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db)
    {
        // This string is used to create the database.
        // execute the query string to the database.
        //db.execSQL(newTableQueryString);
        Log.i("DataBaseManager", "Create Table");
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)
    {
        // NOTHING TO DO HERE. THIS IS THE ORIGINAL DATABASE VERSION.
        // OTHERWISE, YOU WOULD SPECIFIY HOW TO UPGRADE THE DATABASE.
    }

}
}

// Inherit the DbManager Class
 public class DataCollection extends DbManager {

public DataCollection(Context context){
        super(context);
}
   public void deleteTable(String TABLE_NAME){
    try {db.execSQL("DROP TABLE "+TABLE_NAME);}//.delete(TABLE_NAME, null, null);}
    catch (Exception e){
        Log.e("DB ERROR", e.toString());
        e.printStackTrace();
    }
} 
```

# terminal - 下载 wxpthon 时遇到问题

> ID：10983848
> 
> 赞同：0
> 
> 时间：2012-06-11T16:13:55.247
> 
> 标签：terminal, wxpython, osx-lion

我对 Python 和使用终端非常陌生，我在下载 wxpython 时遇到了很多麻烦。我正在使用最新版本的 Mac OS X Lion，我尝试了两种方法：

如果我尝试从他们的网站上简单地下载 wxpython，我会经历整个安装过程，它说它已经安装，但是我在我的计算机上找不到它。当我运行单独安装的演示时，它说我的计算机上没有名为 wxpython 的模块。所以我转向了其他方法......

如果我尝试 sudo pip install wxpython，我会得到：

```
 Downloading/unpacking wxpython
      Downloading wxPython2.8-win64-devel-2.8.12.1-msvc9x64.tar.bz2 (7.2Mb): 7.2Mb downloaded
      Running setup.py egg_info for package wxpython
        Traceback (most recent call last):
          File "<string>", line 14, in <module>
        IOError: [Errno 2] No such file or directory: '/Users/michelletyler1/build/wxpython/setup.py'
        Complete output from command python setup.py egg_info:
        Traceback (most recent call last):

       File "<string>", line 14, in <module>

    IOError: [Errno 2] No such file or directory: '/Users/michelletyler1/build/wxpython/setup.py' 
```

安装 MacPorts 后，我还尝试了 sudo port install py27-wxpython，得到：

```
 --->  Computing dependencies for py27-wxpython
    --->  Building py27-wxpython
    Error: org.macports.build for port py27-wxpython returned: command execution failed
    Please see the log file for port py27-wxpython for details:
        /opt/local/var/macports/logs/_opt_local_var_macports_sources_rsync.macports.org_release_tarballs_ports_python_py-wxpython/py27-wxpython/main.log
    To report a bug, follow the instructions in the guide:
        http://guide.macports.org/#project.tickets
    Error: Processing of port py27-wxpython failed 
```

有什么问题？

另外，我一直在试图弄清楚如何更改我的 $PATH 以便 /usr/local/bin 领先于 /usr/bin （正如 brew doctor 所建议的那样），但是当我去编辑我的 ~/.profile （到目前为止，我已经收集到我应该从我在网上找到的内容），它不起作用。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:18:11.880

据我了解，您不想针对预装的 Python 安装 wxPython。相反，您需要访问 www.python.org 并安装新的 Mac 兼容 Python。然后，您可以下载所需的 wxPython 并将其安装到新的 Python 上。顺便说一句，wxPython 不支持 easy_install 或 pip。

# ios - UITableViewCell 自定义（拉伸）背景使用 UIAppearance

> ID：10983850
> 
> 赞同：1
> 
> 时间：2012-06-11T16:14:01.937
> 
> 标签：ios, uitableview, background

我正在尝试通过 UIAppearance 以与实现自定义 UINavigationBar （ruby 运动语法）相同的方式对 UITableViewCell 进行自定义：

```
bg = UIImage.imageNamed("cell_bg.png").resizableImageWithCapInsets(UIEdgeInsetsMake(0,13,0,13))
UITableViewCell.appearance.setBackgroundImage(bg, forState:UIControlStateNormal, barMetrics:UIBarMetricsDefault) 
```

但是 setBackgroundImage 没有定义， setBackgroundView 也没有 setBackgroundViewImage ... UITableViewCell 符合 UIAppearanceContainer ，所以我不应该能够使用其中之一吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:21:15.193

符合 UIAppearanceContainer 并不意味着你可以设置任何你喜欢的外观，它只是意味着它会提供一个外观代理。据我所知， UITableViewCell 没有任何内置的 UIAppearance 方法。

根据您的需要，尝试使用可拉伸图像创建 UIImageView，并将其设置为`backgroundView`单元格的。

# vbscript - 如何使用 VBS 软结束进程

> ID：10983852
> 
> 赞同：0
> 
> 时间：2012-06-11T16:14:10.133
> 
> 标签：vbscript, process

我喜欢使用 VBScript 结束一个进程。不幸的是，我只找到了作者描述如何杀死进程的例子。

我想要求关闭。所以 objProcess.Terminate() 无济于事。

我正在使用具有管理员权限的 Windows XP SP3。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T05:40:23.447

~~您可以尝试[MSDN](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.closemainwindow.aspx)`CloseMainWindow`上描述的过程中的和`Close`方法，例如：~~

 ~~```
Sub KillingMeSoftly(processName)

    'partly copied from http://www.activexperts.com/activmonitor/windowsmanagement/adminscripts/processes/    
    strComputer = "."
    Set objWMIService = GetObject("winmgmts:" _
        & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")
    Set colProcessList = objWMIService.ExecQuery _
        ("Select * from Win32_Process Where Name = '" & processName & "'")
    For Each objProcess in colProcessList
        objProcess.CloseMainWindow
        objProcess.Close
    Next

End Sub 
```~~ 

~~*这是一个糟糕的答案*~~

 ~~**更新**
在寻找答案时，我刚刚发现使用 //T:nn 选项启动脚本会触发对象上的 Terminate 事件：

```
class Foo
    sub class_terminate
        msgbox "Gracefull termination"
        ' Put your own termination code here.        
    end sub
end class

dim bar
set bar = new Foo

do 
loop ' makes the script run forever 
```

将此另存为`c:\endless.vbs`

运行此脚本将永远不会触发终止事件，因为它会挂在无限循环中，但如果您以超时启动脚本，它会；从命令提示符启动脚本：
`C:\>wscript endless.vbs //T:5`

您会看到 5 秒后会出现一个带有“Gracefull 终止”的消息框。

当您想在一段时间后退出脚本并在脚本没有自行结束时运行清理时，这很有用。我不知道这是否涵盖了您正在寻找的解决方案。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-25T14:55:07.907

所以，最后我找到了我的问题的解决方案，但没有使用 VBS 解决。有一个程序可以将 CTRL-BREAK 发送到任何名为“SendSignal”的进程。我以前试过这个，但是我所有的响应过程都是一条错误消息，它一直在运行。

我更改了发送 CTRL+C 的程序。在此之后，我能够轻轻地关闭我的 Javaw 进程。

感谢大家的帮助！~~

# javascript - jQuery data() 类型转换问题？

> ID：10983854
> 
> 赞同：4
> 
> 时间：2012-06-11T16:14:16.997
> 
> 标签：javascript, jquery, type-conversion

我有以下 div `<div data-item-id="0234">`，当我尝试使用`$element.data("itemId")`jQuery 访问数据时将其转换为 int ，现在我得到`234`而不是`"0234"`. 有什么办法可以得到实际数据`"0234"`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:16:17.947

只需使用`.attr`( `$element.attr('data-item-id');`)。文档本身建议了这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T16:15:53.300

试试这个：

```
$element.attr("data-item-id") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-11T16:16:31.707

使用`attr`：http: [//jsbin.com/ipuhah/](http://jsbin.com/ipuhah/)

```
$(selector).attr("data-item-id"); 
```

# matlab - Matlab 样条曲线

> ID：10983856
> 
> 赞同：3
> 
> 时间：2012-06-11T16:14:23.217
> 
> 标签：matlab, math, bspline

我必须在 MATLAB 中重新实现 B 样条（插值自然 B 样条，3 度），但我有一些问题使 B 样条自然（这意味着我的插值函数在`S"(a) = S"(b) = 0`哪里）。这就是我到目前为止实现[De Boor 算法所做的](http://en.wikipedia.org/wiki/De_Boor's_algorithm)：`S``[a,b]`

```
function [ b ] = deBoore( p,i,x,y )
% p is the degree, i is the index of the bspline
n = length(x);

    if p==0
        b = zeros(1,n);
        for j=1:n
            if y(i)<=x(j) && x(j)<y(i+1)
                b(j) = 1;
            end
        end
    else

       b = (((x-y(i))/(y(i+p)-y(i))).*deBoore(p-1,i,x,y)) ...
           + (((y(i+p+1)-x)/(y(i+p+1)-y(i+1))).*deBoore(p-1,i+1,x,y));
    end

end 
```

所以，这应该工作得很好，但我必须建立插值多项式看起来像这样：

```
function [ sp ] = splineB( p, x, y, f )

m = length(y);
n = length(f);

sp = 0;

    for i=(1):(m-p-1)
       sp = sp + f(i)*deBoore(p,i,x,y);
    end

end 
```

它几乎可以工作，但就像插值开始的时间比预期的要晚。 **我做错了什么，我该如何解决？**

# ruby-on-rails - 支持带有巫术或 Authlogic 宝石的多个模型？

> ID：10983857
> 
> 赞同：0
> 
> 时间：2012-06-11T16:14:28.333
> 
> 标签：ruby-on-rails, ruby-on-rails-3, authlogic, sorcery

1.  我有用户和联系人。
2.  用户登录到他们的帐户，并可以创建他们从中添加联系人的地址簿。
3.  如果他们与联系人共享某些内容，该联系人需要登录才能查看。

用户在数据库中是唯一的（存储在用户表中），联系人存储在联系人表中，并且仅在给定的地址簿中是唯一的。

我目前正在为用户使用 Sorcery gem，效果很好。但是，如何扩展它以支持联系人登录身份验证？

我已经通过 STI 或多态设置阅读了一些内容，但不清楚此类事情的一般模式是什么。

我可以简单地让两个模型都使用巫术吗？或者这是一种反模式？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:39:19.090

为什么要为联系人使用单独的模型？为什么不设置一个自加入，例如：

```
has_many :contact_entries, :class_name => "ContactEntry"
has_many :contacts, :through => :contact_entries 
```

您的用户表看起来相同，但您将有一个连接模型，如：

```
class ContactEntry < ActiveRecord::Base
  belongs_to :user
  belongs_to :contact, :foreign_key => "contact_id", :class_name => "User"
end 
```

这将有一个 user_id 和 contact_id 字段。

**更新**

好的，我现在看到你的问题了。我认为这在巫术中是不可能的，至少在不对巫术本身进行大量编辑的情况下是不可能的。Sorcery 在文件 initializer.rb 中定义了一个单一的可验证模型。

然而，Authlogic 可以通过“acts_as_authentic”引入任何模型，因此它是满足您需求的合理解决方案。缺点是 authlogic 似乎没有被积极开发。然而，它在 10 天前有[相当多的活动](https://github.com/binarylogic/authlogic/commits/master)，所以它绝对值得一看。

# php - 年份 4 位值的 PHP 日期格式的最佳实践

> ID：10983862
> 
> 赞同：5
> 
> 时间：2012-06-11T16:14:54.140
> 
> 标签：php

我在 PHP 的文档中看到有两种方法可以将年份值格式化为 4 位数字：

> Y - 年份的完整数字表示，4 位数字
> 
> o - ISO-8601 年编号。这与 Y 具有相同的值，除了如果 ISO 周数 (W) 属于上一年或下一年，则使用那一年。（在 PHP 5.1.0 中添加）

我研究了更多 ISO-8601 是什么，并且基于 php 的文档，它似乎更“有用”甚至更准确（？）。我认为它更有用，因为它可以防止歧义（例如在处理像 1981-04-05 这样的日期值时）。

但这真的有区别吗？有某种“最佳实践”吗？'o' 是否更慢，这就是为什么人们在没有真正做任何复杂的日期时使用 Y 的原因？

这可能对哪些特定用例有用？

谢谢您的帮助。

编辑：谢谢杰森举个例子！我想我为什么也提出这个问题是我想知道为什么不一直使用'o'？我想我应该一直使用“o”来表示当前未知的未来规范，这将需要我进行更复杂的日期操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T16:17:16.653

`o`将在尝试确定*当前*一周（即日历周）的年份时使用。

`Y`将用于特定日期的年度输出。

以下代码片段显示了这一点：

```
date('Y v. o', strtotime('2012-12-31'));  // output: 2012 v. 2013 
```

并不是说它是*最佳实践*，而是`Y`更*常用*于输出年份。如前所述，输出此类*边界*日期`o`的年份是不正确/令人困惑的。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:32:37.027

ISO 8601*是*一个非常有用的表示日期的标准，但它有几个组件，并非所有组件都可用于多种用途。特别是，“ISO 周”和“ISO 年”可能会有点令人困惑，而且它们通常不是你真正想要使用的（如果你*确实*想使用它们，你可能已经知道了）。

[维基百科](http://en.wikipedia.org/wiki/ISO_week_date)有一个很好的解释。基本上，ISO 8601 标准定义了一个单独的日历，而不是分解成月份和月份的几天，而是分解成星期和星期几。

您可能认为这对指定年份没有影响，但有一点问题：日历年开始和结束附近的几周适合哪一年？正如维基百科所说，这不是很直观：“[ISO] 年的第一周是包含 [日历] 年第一个星期四的那一周。”

**实际结果：**如果您将日期表示为传统的年-月-日值，您*不想*使用“ISO 年”( `o`)。一年中的大部分时间你都不会注意到差异，但是当你到了 12 月和 1 月时，你会突然（有时）结束一年的日期。如果你只是用当前日期测试你的系统，你很容易错过这个。

相反，您可能只想使用普通的 old `Y-m-d`。即使`date()`文档没有具体说明，这是一个完全有效的 ISO 8601 标准日期。

确实，只有在使用 ISO“星期日期”日历时才应该使用`o`（这意味着您可能还`W`用于星期数和`N`星期几）。*

# javascript - onclick 从提交输入调用函数不起作用

> ID：10983870
> 
> 赞同：0
> 
> 时间：2012-06-11T16:15:46.887
> 
> 标签：javascript, ajax

这是我通过 AJAX 动态编写的提交按钮：

```
var htmlpage = "<div class='pages'>"
                for (i=1 ; i < pages+1 ; i++)
                    {
                        htmlpage += "<li><input type='submit' value='"+i+"' onclick='updatefilters;' /></li"
                    }
                htmlpage += "<div>"    
                htmlpage += "</ul>"; 
```

我正在尝试重新运行 updatefilters() 函数来更改显示的项目。我想在没有看到所有代码的情况下概念化有点困难......但基本上，我需要做的就是在每次单击提交按钮时再次运行该函数......现在，它给了我一个`updatefilters is undefined`萤火虫错误。

这是我的整个 JS 供参考

```
$(function() {
    $( "#selectable" ).selectable({
        selected: updatefilters  
    });
    getactivesession();
    function getactivesession(ev, ui){
        var i = 0;
        var actfilter, strfilter;
        var strfilterarray = new Array();
        $.ajaxSetup({cache: false})
        $.ajax({
        type: "POST",  
        async: false,
        url: 'welcome/getactivesession', 
        dataType: 'json',
        success: function (data){
            strfilter = JSON.stringify(data)
            strfilterarray = strfilter.split(',')
            for (i=0 ; i < strfilterarray.length ; i++) {
                strfilter = strfilterarray[i]
                strfilter = strfilter.replace(/[\[\]'"]+/g,'');
                var strfilterdash = strfilter.replace(/\s+/g, '-')
                actfilter = '#'+ strfilterdash
                $(actfilter).addClass('ui-selected')
            }
            updatefilters();
        }
        });
    }

    function updatefilters(ev, ui){
        // get the selected filters
        var template, html;
        var i = 0;
        var page;
        if(! page){
            page = 0; 
        }

        var $selected = $('#selectable').children('.ui-selected');
        // create a string that has each filter separated by a pipe ("|")
        var filters = $selected.map(function(){return this.id;}).get().join("\|");
        $.ajax({
            type: "POST",
            async: false,
            url: 'welcome/updatefilters',
            dataType: 'json', 
            data: { filters: filters, page: page },
            success: function(data){
                var html = "";
                html += "<div id=board>"
                html += "<div class='board' id='table'>"
                html += "<div id='row'>header here</div>"
                var pages = Math.ceil(data['num_threads']/10);
                var htmlpage = "<div class='pages'>"
                for (i=1 ; i < pages+1 ; i++)
                    {
                        htmlpage += "<li><input type='submit' value='"+i+"' onclick='updatefilters;' /></li"
                    }
                htmlpage += "<div>"    
                htmlpage += "</ul>";
                htmlpage += "</br>";
                html += htmlpage;
                for (i=0 ; i < data['threads'].length ; i++)
                {
                    html += "<div id=row>";
                    html += "   <div id='author' style='background: url("+data['threads'][i].location + ") no-repeat; background-position: center;'><p>"+data['threads'][i].username + "</p></div>";
                    html += "   <div id='arrow'></div>";
                    html += "   <div id='subject' title='"+ data['threads'][i].body +"'>";
                    html += "       <a href=thread/" + data['threads'][i].slug + ">"+ data['threads'][i].subject +"</a><p>Created: "+data['threads'][i].posttime+"</p></div>";                    
                    html += "   <div id='info'>";
                    html += "       <div id='replies'>" + data['threads'][i].replies_num + "</div>";
                    html += "       <div id='lastpost'>"+ data['threads'][i].lastreply+"</div>";
                    html += "   </div>";
                    html += "</div>";
                }
                html += "</div></div>";
                $('#board').html(html);
            }
        });
    } 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:31:11.070

这种方法似乎存在一些问题。

首先，您实际上并没有在`onclick`处理程序中调用该函数。

```
htmlpage += "<li><input type='submit' value='"+i+"' onclick='updatefilters;' /></li" 
```

应该：

```
htmlpage += "<li><input type='submit' value='"+i+"' onclick='updatefilters();' /></li" 
```

其次，`updatefilters`无法从全局范围访问该函数，而全局范围是执行该匿名函数的地方。您必须移到回调`function updatefilters(ev, ui)`之外`onload`，也许是脚本块的顶部。

# algorithm - 点到多边形的距离

> ID：10983872
> 
> 赞同：26
> 
> 时间：2012-06-11T16:15:48.057
> 
> 标签：algorithm, geometry

我正在尝试确定二维空间中点到多边形的距离。该点可以在多边形内部或外部；多边形可以是凸的或凹的。

如果该点在多边形内或多边形外且距离小于用户定义的常数`d`，则程序应返回`True`；`False`否则。

我发现了一个类似的问题：[Distance from a point to a polyhedron or to a polygon](https://stackoverflow.com/questions/2433298/distance-from-a-point-to-a-polyhedron-or-to-a-polygon)。但是，在我的情况下，空间是 2D 的，并且多边形可以是凹的，所以它与那个不同。

我想应该有一种比将多边形偏移`d`并确定它在多边形内部还是外部更简单的方法。

我将不胜感激任何算法、代码或提示。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-11T16:32:11.453

最好的办法是遍历所有线并找到从点到线段的最小距离。

要找到从点到线段的距离，首先通过选择任意点`P1`和线上的点来找到从点到线的距离`P2`（使用端点可能是明智的）。然后将向量从`P1`到您的点`P0`并找到点积`(P2-P1) . (P0 - P1)`在哪里。`.`将此值除以`||P2-P1||^2`得到一个值`r`。

现在，如果您选择`P1`和`P2`作为您的点，您可以简单地检查是否`r`在 0 和 1 之间。如果`r` 大于 1，那么`P2`是最近的点，所以您的距离是`||P0-P2||`。如果`r`小于 0，那么`P1`是最近的点，所以你的距离是`||P0-P1||`。

如果`0<r<1`，那么你的距离是`sqrt(||P0-P1||^2 - (r * ||P2-P1||)^2)`

伪代码如下：

```
for p1, p2 in vertices:

  var r = dotProduct(vector(p2 - p1), vector(x - p1))
  //x is the point you're looking for

  r /= (magnitude(vector(p2 - p1)) ** 2)

  if r < 0:
    var dist = magnitude(vector(x - p1))
  else if r > 1:
    dist = magnitude(vector(p2 - x))
  else:
    dist = sqrt(magnitude(vector(x - p1)) ^ 2 - (r * magnitude(vector(p2-p1))) ^ 2)

  minDist = min(dist,minDist) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:27:19.297

如果你有一个工作点到线段的距离函数，你可以用它来计算从点到多边形每个边的距离。当然，您必须首先检查该点是否在多边形内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:37:07.170

您需要快速还是简单？
在边缘情况下它是否必须始终绝对正确，或者大多数时候*足够好就可以了？*

典型的解决方案是找到每个顶点的距离并找到具有最小值的对（请注意，对于凸多边形外部的点，这些点可能不相邻），然后检查每个线段的点到线交叉点。

对于大型复杂形状，您还可以存储近似多边形边界框（矩形或六边形）并在检查更多细节之前找到最近的边。

您可能还需要代码来处理恰好在一行中的特殊情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-12-05T21:39:56.070

如果这对其他人有帮助，我对doverbin 的答案进行了逆向工程，以了解为什么它以图形方式显示这三个案例正在计算的内容。（doverbin，如果您愿意，请随时将其合并到您的答案中。）

[![多弗宾答案的图形描述](../Images/a717b732a2b11e55e20ca8098aef3666.png)](https://i.stack.imgur.com/B9vX0.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-11T16:53:48.943

我可以帮助你解决这个问题：

*   即使使用未经测试的代码片段，也可以使用[Wikipedia entry计算距离。](http://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line "点到线的距离")
*   可以使用此[Stack Post 和链接解决内部/外部边界](https://stackoverflow.com/questions/10931414/point-inside-rotated-2d-rectangle-not-using-translation-trig-functions-or-dot/10932919#10932919 "自我参考：P")

和一些评论：

*   正如马丁贝克特的回答指出的那样，您应该只检查最近的点，因为另一段可以“预测”非常接近，但实际上并不需要接近。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-30T08:18:48.560

我不知道其他答案的性能差异，但在 boost C++ 库中有一个名为[distance](https://www.boost.org/doc/libs/1_57_0/libs/geometry/doc/html/geometry/reference/algorithms/distance/distance_2.html)的通用实现。它在每种情况下都有关于复杂性的信息，在您的问题情况下它是线性的。

几天前我也在寻找这个问题的解决方案，我想分享这个发现。希望它对某人有所帮助。

# facebook - Facebook 评论与 url 相关联

> ID：10983877
> 
> 赞同：3
> 
> 时间：2012-06-11T16:16:14.913
> 
> 标签：facebook, facebook-comments

我将添加在基于 Yii 框架的动态网络市场上通过“Facebook 评论插件”对产品进行评论的功能。

所以，今天我创建了一个新的 facebook 应用程序，我包含了 facebook sdk js 文件，并将这个 html 代码添加到呈现单个产品的视图中：

```
<div class="fb-comments" data-href="<?=$this->createAbsoluteUrl('site/courseDetail',array('id'=>$model->course_profile_id))?>" data-num-posts="10" data-width="470"></div>. 
```

评论链接到网址！！

**那么，如果域发生变化或者我决定向我的 Web 应用程序添加一个 url 重写引擎会发生什么？**

我想我放弃了所有的评论......奇怪......这是一个很大的限制......我阅读了文档：[https](https://developers.facebook.com/docs/reference/plugins/comments/) ://developers.facebook.com/docs/reference/plugins/comments/ 我看到现在强烈建议使用 html5 代码，因为 FBML 已被弃用。从 2012 年 6 月 1 日开始，FBML 应用程序将不再工作，因为所有 FBML 端点都将被删除。

所以，我不能使用 xid 参数，例如 on`<fb:comments...>`

正确的？

# iphone - ASIHTTPRequest 登录页面

> ID：10983882
> 
> 赞同：2
> 
> 时间：2012-06-11T16:16:25.873
> 
> 标签：iphone, objective-c, xcode, authentication, https

我尝试制作一个可以登录到使用 https 保护用户信息的 Web 应用程序的 iphone 应用程序。现在我被困在登录页面中。通过我的应用程序登录时，我不知道如何在用户的网站上查看真实帐户。即使我输入了错误的帐户，我也只收到了 200 条回复。

这是我的代码：

```
- (IBAction)clickOK:(id)sender {

NSURL *url = [NSURL URLWithString:@"https://www.freelancer.com/users/login.php"];
ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];

[request setUseKeychainPersistence:YES];
[request setDelegate:self]; 
request.shouldPresentCredentialsBeforeChallenge = YES; 

[request setRequestMethod:@"POST"];
[request setPostValue:usernameField.text forKey:@"username"];
[request setPostValue:passwordField.text forKey:@"passwd"];

request.timeOutSeconds = 30; 

[request setDidFailSelector:@selector(requestLoginFailed:)];
[request setDidFinishSelector:@selector(requestLoginFinished:)];
[request startAsynchronous];

}

- (void)requestLoginFailed:(ASIHTTPRequest *)request
{
//notify user
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Error sending request to the server" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
[alert show];

}

- (void)requestLoginFinished:(ASIHTTPRequest *)request
{
int statusCode = [request responseStatusCode];
NSString *statusMessage = [request responseStatusMessage];

NSLog(@"StatusCode: %d", statusCode);
NSLog(@"StatusMessage: %@", statusMessage);

} 
```

谁能建议我如何检查本网站的真实帐户并保持用户登录？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T16:51:14.743

你已经异步启动了一些东西

```
[request startAsynchronous]; 
```

然后只是期望它会立即返回一些东西：

```
NSLog(@"%@",[request responseString]);
NSLog(@"%d",[request responseStatusCode]); 
```

你需要这样写：

```
[request setDidFinishSelector:@selector(didFinishRequest:)]; 
```

然后将您的 NSLogs 和任何其他从响应中汲取的东西移到该方法中。

# android - 调用 AudioRecord.start() 时出现 IllegalStateException

> ID：10983885
> 
> 赞同：1
> 
> 时间：2012-06-11T16:16:46.520
> 
> 标签：android, audio, capture, mediarecorder

我正在使用 AudioRecorder 录制简短的音频剪辑，但是在调用 AudioRecord.start() 时出现 IllegalStateException 我一直在寻找几个小时，但找不到导致此问题的原因...

我已经设置了 Audio Rec + Write External Storage 权限。

这是我的一段代码：

```
// main activity...

// Audio inits
    final MediaRecorder recorder = new MediaRecorder();

    recorder.setAudioSource(MediaRecorder.AudioSource.MIC);
recorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
recorder.setOutputFile(getTempPath()); 
```

...

```
// called the sound rec async

new SoundComponent(tvmic, pb, tb).execute(recorder);

// SoundComponent.java
// Getting IllegalStateException when calling recorder[0].start();

[..]
protected Long doInBackground(MediaRecorder... recorder) {

     try {
         recorder[0].prepare();
        } catch (IOException e) {
            Log.e("100", "prepare() failed");
        }

    while (tb.isChecked())
    {
        //publishProgress();
        //recorder[0].prepare();

         recorder[0].start(); // here it were it throws
         try {
             Thread.sleep(250);
         } catch (InterruptedException e) {
             // TODO Auto-generated catch block
             e.printStackTrace();
         }
        // int amplitude = recorder[0].getMaxAmplitude();

         recorder[0].stop();

    }

    // TODO Auto-generated method stub
    return null;
} 
```

[..]

```
public String getTempPath() // audio temp path
{
    String path =  Environment.getExternalStorageDirectory().getAbsolutePath();
    path+="/temp/audiorectemp.3gp";
    return path;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T17:15:51.947

`MediaRecorder`在循环中多次启动和停止可能不是一个好主意。仔细看看你在做什么，我已经修剪了你的代码，使它更容易看到......

```
while (tb.isChecked())
{
     recorder[0].start(); // here it were it throws
     // Sleep here
     recorder[0].stop();
} 
```

它可能不会在您第一次调用时引发异常，`start()`但它会在第二个循环中引发。看状态机图... [MediaRecorder](http://developer.android.com/reference/android/media/MediaRecorder.html)

此外，为了检测何时`doInBackground(...)`应该退出线程，有一个方法`AsyncTask`可以从 UI 线程调用以取消它。

理想情况下，循环应该是并且您应该从主代码中的侦听器`while (!isCancelled())`调用该`AsyncTask.cancel(...)`方法（假设是 a或其他一些）。`onCheckedChanged``tb``Activity``tb``CheckBox``CompoundButton`

# playframework - 如何在服务器上启动 PlayFramework

> ID：10983890
> 
> 赞同：0
> 
> 时间：2012-06-11T16:17:01.627
> 
> 标签：playframework, webserver, remote-server

我创建了 Play 应用程序。但是当我在网络服务器上启动它时，它不起作用。

这是一个链接：[podulli.com](http://podulli.com)

当我在端口 9000 上以 DEV 模式运行它时，浏览器无法连接，并且播放应用程序仅显示：等待第一个请求启动。

当我通过命令运行它时：play start，shell write 应用程序已启动，但浏览器仅显示服务器上的文件。

是否可以在开发模式下运行 Play 应用程序，然后通过 WWW 使用它们？

我做错了什么？我该怎么做才能让我的应用开始在服务器上运行？

感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T18:07:37.660

是的，这是可能的。但是您的应用程序必须在端口 80 上运行。

你有两个选择。

1.  您将应用程序配置为在端口 80 上运行。这将限制您的服务器仅运行此应用程序，因为当时只有一个应用程序可以使用端口 80。

2.  您在服务器上设置了一个反向代理来侦听端口 80，并将请求代理到端口 9000。

对您来说，最好使用选项 2，因为您已经在服务器上运行 apache。Apache 和 play 不能同时使用 80 端口。您可以启动您的播放应用程序以使用端口 9000（或您喜欢的任何端口），并配置 apache 以将代理请求反向到该端口。

请记住，当您完成应用程序的调试后，在生产模式下运行它很重要。生产模式不仅速度更快，而且更安全。例如，每个人都可以通过访问[http://podulli.com/@kill](http://podulli.com/@kill)来终止您的应用程序。此“功能”在生产模式下被关闭。

# ruby-on-rails - Rails 3.1 - 需要快速重写已弃用的查询

> ID：10983894
> 
> 赞同：0
> 
> 时间：2012-06-11T16:17:23.377
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有这个：

```
Product.find(:all, :conditions => ['release_date >=? AND release_date <=?', @start, @start + @weeks.weeks], :order => "initial_stock DESC") 
```

我了解条件现已弃用。这在本地可以正常工作，但是当我上传到 heroku 时，订单不起作用，所以最好我重写吧？问题是我尝试过的每一件事都会引发错误。任何人都可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:21:53.240

这应该这样做：

```
Product.where("release_date >= ? AND release_date <= ?", @start, @start + @weeks.weeks).order("initial_stock DESC") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:29:32.183

如果在整个应用程序中使用它，我通常喜欢在模型上为其创建一个范围。我没有测试过这段代码，但我会这样做：

```
# scope on Product.rb
scope :by_release_date, lambda { |date| where("release_date BETWEEN ? AND ?", date.beginning_of_day, date.end_of_day) }

# query anywhere in app
Product.by_release_date('2012-06-11 00:00:00').order('initial_stock DESC') 
```

# .net - 如何使用具有类型参数的表单中的资源？

> ID：10983902
> 
> 赞同：1
> 
> 时间：2012-06-11T16:17:51.860
> 
> 标签：.net, winforms, generics, embedded-resource

我通过将类型参数添加到`Form1.cs`和中添加了一个类型参数`Form1.Designer.cs`：

```
partial class Form1<T> { ... } 
```

这一直有效，直到我将任何资源添加到我的表单中，比如一个图标。当我这样做时，会添加此行：

```
ComponentResourceManager resources = new ComponentResourceManager(typeof(Form1)); 
```

如果我将`typeof(Form1<T>)`其更改为可以编译但在运行时我会得到

> 找不到适合指定区域性或中性区域性的任何资源。确保 在编译时`"My.Assembly.Form1'1.resources"`正确嵌入或链接到程序集中`"My.Assembly`，或者所有所需的附属程序集都是可加载的并且完全签名。

尝试`typeof(Form1<T>).GetGenericTypeDefinition()`也失败了。如何使用通用表单的资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:43:06.143

这里已经提出了一个问题 - [http://connect.microsoft.com/VisualStudio/feedback/details/115397/component-resource-manager-doesnt-work-with-generic-form-classes](http://connect.microsoft.com/VisualStudio/feedback/details/115397/component-resource-manager-doesnt-work-with-generic-form-classes)

但是，**SO有一个解决方案**。看这里 -

[https://stackoverflow.com/a/1627605/763026](https://stackoverflow.com/a/1627605/763026)

# iphone - UIDocument、NSFileWrapper 和图像

> ID：10983903
> 
> 赞同：7
> 
> 时间：2012-06-11T16:17:53.307
> 
> 标签：iphone, cocoa-touch, icloud, uidocument, nsfilewrapper

我有一个 UIDocument，我希望它由（1）一个 txt 文件和（2）几个 jpg 图像组成。我将 txt 和所有 jpg 文件放入 NSFileWrapper。

当我加载 UIDocument 时，我很快就需要 txt 文件中的信息，所以我先加载它并忽略所有图像，直到我真正需要它们。

虽然我知道如何延迟加载图像，但我不确定如何“延迟”保存图像（尤其是在使用 iCloud 时，我不希望文件被不必要地上传/下载）。假设我已经加载了所有图像并且没有更改它们。然后我想保存 UIDocument，忽略所有图像（因为它们没有改变），但想保存文本，因为它确实改变了。

**我将如何实现这一目标？甚至可能吗？还是自动完成？或者我是否应该不将图像放在我的 UIDocument 中，让每个图像由不同的 UIDocument 处理？**恐怕这对我来说有点混乱。

到目前为止，这是我的代码，它将保存所有图像和文本（无论它们是否被更改）：

* * *

## `UIDocument`

```
-(id)contentsForType:(NSString *)typeName error:(NSError *__autoreleasing *)outError {

        NSMutableDictionary *wrappers = [NSMutableDictionary dictionary];
// the following puts a wrapper into a dictionary of wrappers:
        [self encodeObject:self.text toWrappers:wrappers toFileName:@"text.data"];
        [self encodeObject:self.photos toWrappers:wrappers toFileName:@"photos.data"];
        NSFileWrapper *fileWrapper = [[NSFileWrapper alloc] initDirectoryWithFileWrappers:wrappers];

        return fileWrapper;

    } 
```

* * *

## 当我想保存 UIDocument 时：

```
[self.doc saveToURL:self.doc.fileURL forSaveOperation:UIDocumentSaveForOverwriting completionHandler:^(BOOL success) {
    [self.doc closeWithCompletionHandler:^(BOOL success) {}];
}]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T02:54:37.220

您应该在 UIDocument 实例中保留对 NSFileWrapper 的引用。这样，只有更改的内容会被重写，而不是整个包装器。

因此，在加载文件（或为新文档创建新文件）时保留参考：

```
- (BOOL)loadFromContents:(id)contents ofType:(NSString *)typeName error:(NSError **)outError {
    // save wrapper:
    self.fileWrapper = (NSFileWrapper*)contents; 
```

现在您只需在文件实际更改时更新包装器：

```
- (id)contentsForType:(NSString *)typeName error:(NSError **)outError {
    NSFileWrapper *subwrapper = [self.fileWrapper.wrappers objectForKey:@"subwrapper"];
    if(self.somethingChanged) {
        [self.fileWrapper.wrappers removeFileWrapper:subwrapper];
        subwrapper = [[NSFileWrapper alloc] initRegularFileWithContents:… 
```

我知道代码非常简短，但我希望这有助于为您指明正确的方向。

# c++ - Linux 上多线程 C++ 应用程序中的内存泄漏

> ID：10983905
> 
> 赞同：4
> 
> 时间：2012-06-11T16:18:05.903
> 
> 标签：c++, linux, memory-leak-detector

我们有一个在 Linux 上运行的大型多线程 C++ 应用程序。我们看到应用程序占用的内存增长很快，并且认为存在一些泄漏。我们已经尝试了我们拥有的所有工具（valgrind、DynLeak、Purify），但没有找到任何东西。由于此应用程序可以在 Windows 上运行，我们还尝试了 Bounds Checker。也没有帮助。

我们需要一个可以提供帮助的新工具。我看过 Google Perfomrance Tools，Paul Nettle 的 MMGR，MemCheck Deluxe。他们都没有给我留下深刻印象。

有没有什么好工具可以完成这项任务？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:33:07.403

C/C++ 中内存泄漏的定义非常具体：它是已分配的内存，然后指针被覆盖或以其他方式丢失。Valgrind 通常会开箱即用地检测到此类情况，但事情并不总是那么简单。

*   您的应用程序很可能仍在使用该内存。在这种情况下，您可能会遇到*Java*程序员认为的泄漏，例如在结构中输入数据并且很少（或从不）删除条目。

*   您可能错误地测量了内存的内存使用情况。在 Linux 上，内存使用测量并不像看起来那么简单。你是如何测量你的内存使用量的？

*   您应该考虑使用您正在使用的任何内存分析工具的应用程序挂钩（Valgrind 将它们称为[客户端请求](http://valgrind.org/docs/manual/mc-manual.html#mc-manual.clientreqs)），以避免仅在程序终止时发布报告的问题。使用这些钩子可能会帮助您确定泄漏的位置。

*   您应该尝试使用堆分析器（例如Valgrind 的[massif](http://valgrind.org/docs/manual/ms-manual.html)）来查找分配内存过多的内存分配位置。

*   确保您没有在应用程序中使用自定义分配器或垃圾收集器。据我所知，没有任何内存分析工具可以在没有[用户干预](http://valgrind.org/docs/manual/mc-manual.html#mc-manual.mempools)的情况下与自定义分配器一起使用。

*   如果您的内存泄漏大到足以在可接受的应用程序运行时间内检测到，您可以尝试通过版本控制系统对旧修订进行二进制搜索，以识别引入问题的提交。至少[Mercurial](http://www.selenic.com/mercurial/hg.1.html#bisect) 和[Git](http://git-scm.com/docs/git-bisect)为这项任务提供了内置支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:25:44.437

如果“没有帮助”是指它没有报告内存泄漏，则很可能您没有内存泄漏，而只是使用越来越多的仍然由指针引用并且可以删除的内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:40:47.843

为了帮助您调试问题，也许在您的日志记录中，您还应该写入内存大小、对象数量（它们的类型）和一些其他对您有用的统计信息。至少在您更加熟悉您提到的工具之前。

# image - 糟糕的 OpenCL ImageSampling 性能与 OpenGL TextureSampling

> ID：10983906
> 
> 赞同：55
> 
> 时间：2012-06-11T16:18:12.950
> 
> 标签：image, opengl, opencl, textures, sampling

我最近将我的 volumeraycaster 从 OpenGL 移植到 OpenCL，这将 raycaster 的性能降低了大约 90%。我跟踪了 OpenCL 的图像采样函数的性能下降，这些函数比相应的 OpenGL 纹理采样函数慢得多。通过删除图像采样函数和纹理采样函数，两种光线投射器实现的速度大致相同。为了在不同的硬件上轻松地对函数进行基准测试，并排除我其余 RT 代码中的一些愚蠢错误，我编写了一个小基准，将 OpenCL 采样速度与 OpenGL 采样速度进行比较，并在不同的机器上进行了测试，但是OpenCL 的性能仍然只有 OpenGL 的 10% 左右。

基准测试的 OpenCL HostCode（至少是其中最重要的部分）：

```
void OGLWidget::OCLImageSampleTest()
{
    try
    {
    int size=8;
    float Values[4*size*size*size];
    cl::Kernel kernel=cl::Kernel(program,"ImageSampleTest",NULL);
    cl::ImageFormat FormatA(CL_RGBA,CL_FLOAT);
    cl::Image3D CLImage(CLcontext, CL_MEM_READ_ONLY | CL_MEM_COPY_HOST_PTR ,FormatA,size,size,size,0,0,Values,NULL);

    cl::ImageFormat FormatB(CL_RGBA,CL_UNSIGNED_INT8);
    cl::Image2D TempImage(CLcontext, CL_MEM_WRITE_ONLY,FormatB,1024,1024,0,NULL,NULL );

    kernel.setArg(0, CLImage);
    kernel.setArg(1, TempImage);

    cl::Sampler Samp;
    Samp() = clCreateSampler( CLcontext(), CL_TRUE, CL_ADDRESS_REPEAT, CL_FILTER_LINEAR, NULL);
    kernel.setArg(2, Samp);

    QTime BenchmarkTimer=QTime();
    BenchmarkTimer.start();

    cl::KernelFunctor func = kernel.bind(queue, cl::NDRange(1024,1024), cl::NDRange(32,32));
    func().wait();

    int Duration =  BenchmarkTimer.elapsed();
    printf("OCLImageSampleTest: %d ms \n", Duration);
    }
    catch (cl::Error& err)
      {
        std::cerr << "An OpenCL error occured, " << err.what()
                  << "\nError num of " << err.err() << "\n";
        return;
      }

} 
```

OpenCL 内核：

```
void kernel ImageSampleTest( read_only image3d_t CoordTexture, write_only image2d_t FrameBuffer, sampler_t smp)
{
int Screenx = get_global_id(0);
int Screeny = get_global_id(1);

int2 PositionOnScreen=(int2)(Screenx,Screeny) ;

float4 Testvec=(float4)(1,1,1,1);
for(int i=0; i< 2000; i++)
{
Testvec+= read_imagef(CoordTexture,smp, (float4)(0+0.00000001*i,0,0,0)); // i makes sure that the compiler doesn't unroll the loop
}

uint4 ToInt=(uint4)( (uint) (Testvec.x), (uint) (Testvec.y) ,(uint)(Testvec.z),1);
write_imageui (     FrameBuffer,  PositionOnScreen, ToInt ); 

} 
```

全屏四边形的 OpenGL FragmentShader 具有与 OpenCL 内核相同数量的片段具有工作项：

```
#version 150
uniform sampler3D Tex;
out vec4 FragColor;

void main()
{
FragColor=vec4(0,0,0,0);
for(int i=0; i<2000; i++)
{
FragColor+= texture(Tex,vec3(0+0.00000001*i,0,0),0);
}
} 
```

此外，我已经尝试了以下方法来提高性能：

-改变工作组规模：没有性能提升

- 不同的硬件：280 GTX、580 GTX、一些 Fermi Tessla 卡，它们在 OpenCL 和 OpenGL 中都有同样糟糕的性能

-不同的纹理格式（字节而不是浮点数），不同的访问模式和不同的纹理大小：不增加

- 在 CL 内核中使用缓冲区而不是图像来存储数据，并使用自写的三线性插值函数进行采样：将 OpenCL 性能提高了约 100 %

- 使用 2D 图像//纹理而不是 3D 图像//纹理：这将 OpenCL 性能提高了 100%，尽管 OpenGL 性能根本没有改变。

- 使用“最近”而不是“线性”插值：没有性能变化

这让我想知道：我是否犯了一个非常愚蠢的错误，降低了 OpenCL 的性能？为什么 OpenCL 采样性能如此之低，尽管它应该使用与 OpenGL 相同的纹理硬件？为什么我的复杂三线性插值函数实现比它的硬件实现快？如何提高 OpenCL 中的采样性能，以便获得与 OpenGL 中相同的速度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-04T07:55:01.480

我怀疑某些显卡上最新的 NVidia 驱动程序中的 OpenCL 存在一些问题。 [这里](https://forums.geforce.com/default/topic/627758/official-nvidia-331-65-whql-display-driver-feedback-thread-released-10-28-13-/)和[这里](https://forums.geforce.com/default/topic/620270/folding-home-slow-performance-with-331-x-beta/?offset=3)有一些关于这些的报道。尝试在另一个家庭的 GPU 上重复测试。

# .net - 为什么 Threading::Monitor::TryEnter 多次成功？

> ID：10983909
> 
> 赞同：2
> 
> 时间：2012-06-11T16:18:25.840
> 
> 标签：.net, multithreading, unit-testing, c++-cli, monitor

我正在尝试保护一些多线程代码，并且正在添加单元测试以证明我已经修复了我们之前看到的损坏。

这样做虽然我遇到了一些意想不到的行为。[当文档](http://msdn.microsoft.com/en-us/library/42h9d380.aspx)指示`TryEnter`仅在函数实现排他锁时才应返回 true 时，为什么以下代码会成功？

```
const int msToWaitForLock = 1;
Object^ syncObj = gcnew Object();
bool gotLock = Threading::Monitor::TryEnter(syncObj, msToWaitForLock); // <-- this succeeds as expected
bool gotSecondLock = Threading::Monitor::TryEnter(syncObj, msToWaitForLock); // <-- but why the heck does this succeed?! 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-11T16:22:29.477

文档说

> 同一个线程在没有阻塞的情况下多次调用 Enter 是合法的

请参阅[http://msdn.microsoft.com/en-us/library/de0542zz(v=vs.110)](http://msdn.microsoft.com/en-us/library/de0542zz(v=vs.110))

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T16:21:57.637

除非我在问题中遗漏了一些东西，否则这两个调用不应该成功吗，因为它们是由同一个线程制作的？

因此，如果您从单独的线程中制作它们，我预计第二个会失败。

# c++ - c++继承设计问题

> ID：10983911
> 
> 赞同：3
> 
> 时间：2012-06-11T16:18:42.090
> 
> 标签：c++, polymorphism, abstract-class, pure-virtual

在 c++ 中，我想要一个抽象类型 Query 的数组，它具有函数 calcScore() ，它是一个纯虚函数。
我有两个非抽象类：ConQuery 和 DisQuery，它们实现了 calcScore 函数。

为了做到这一点，我定义了这样的数组：

```
vector<Query*> m; 
```

我迭代并像这样调用函数：

```
for (vector<Query*>::const_iterator it1 = index.begin() ;it1 != index.end() ; it1++)
{
     cout << (*it1)->CalcScore() << endl; 
} 
```

调用Query**的纯虚函数**时出现错误。如何通过多态类型调用 ConQuery 或 DisQuery 的函数？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:29:37.557

如果您尝试从该类型的构造函数或析构函数调用纯虚函数（其中最派生的类型尚未构建/已被销毁），则该错误只会在该语言中发生：

```
struct Query {
   virtual void f() = 0;
   Query() {
      f();                // !!
   }
   ~Query() {
      f();                // !!
   }
}; 
```

请注意，编译器通常会将上面的代码标记为错误，但如果调用不是*直接*在构造函数/析构函数中，则编译器将无法检测到它，例如，如果您将对对象的引用传递给执行调用的不同函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-11T16:31:29.540

您确定在 ConQuery 和 DisQuery 中实现了 CalcScore 吗？我试过这个：

```
#include <iostream>
#include <vector>

class Query{
public:
    virtual int CalcScore() = 0;
};

class Query2 : public Query
{
public:
    virtual int CalcScore()
    {

        return 2;
    }
};

class Query3 : public Query
{
public:
    virtual int CalcScore()
    {

        return 3;
    }
};

int main(int argc, char* argv[])
{

    std::vector<Query*> m;
    m.push_back(new Query2());
        m.push_back(new Query3());
    for (std::vector<Query*>::const_iterator it1 =  m.begin() ;it1 !=  m.end() ; it1++)
    {
        std::cout  << (*it1)->CalcScore();
    }
} 
```

它在我的 VS2012 下运行良好。

我也在我的一些项目中多次使用它。

也许您尝试 push_back 查询项目（而不是 con/dis）？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-11T16:21:31.770

改变

```
for (vector<Query>::const_iterator it1 = index.begin() ;it1 != index.end() ; it1++) 
```

到

```
for (vector<Query *>::const_iterator it1 = index.begin() ;it1 != index.end() ; it1++) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-11T16:30:26.850

我可能错过了一些东西，但这对我有用：我已经知道我没有初始化等；-)

```
#include "stdafx.h"
#include <vector>

class Query
{
public:
    int i;
    void virtual CalcScore() = 0;
};

class ConQuery :public Query
{
public:
    int i;
    void virtual CalcScore() {i++;}

};

int _tmain(int argc, _TCHAR* argv[])
{
    std::vector<Query*> index;
    ConQuery b;

    index.push_back(&b);

    for (std::vector<Query*>::const_iterator it1 = index.begin() ;it1 != index.end() ; it1++) 
    {      
        (*it1)->CalcScore();
    } 

    return 0;
} 
```

# php - 我是否必须始终将所有参数传递给 PHP 函数？

> ID：10983914
> 
> 赞同：2
> 
> 时间：2012-06-11T16:19:12.780
> 
> 标签：php, javascript, function, arguments

> **可能重复：**
> [PHP - 使用多个变量调用函数](https://stackoverflow.com/questions/10881630/php-calling-functions-with-multiple-variables)

```
function test($var1=null, $var2=null, $var3=null){
    //smart stuff goes here
} 
```

我是否必须每次调用传递所有变量的函数？

```
test(null, $var2, null); 
```

我只想传递 $var2 因为所有其他变量都有默认值......甚至可能吗？

在 JavaScript 中我们可以将对象传递给函数，在 PHP 中有类似的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:20:37.813

您只需将参数传递到最后一个您不希望使用默认值的参数，包括最后一个参数。在您的示例中，您可以这样做：

```
test(null, $var2); 
```

最后一个参数可以省略，因为默认值是令人满意的。但必须包含第一个参数，以便 PHP 知道您正在设置第二个参数的值。

在 PHP 像 Python 那样提供命名参数之前，它必须是这样工作的。

# silverlight - Silverlight 数据绑定到集合内的集合

> ID：10983929
> 
> 赞同：0
> 
> 时间：2012-06-11T16:20:36.677
> 
> 标签：silverlight, data-binding, observablecollection, inotifypropertychanged, inotifycollectionchanged

希望有人可以帮助我解决这个问题。我正在创建一个用于编辑图像的 Silverlight 应用程序。用户有一个项目，其中包含包含元素的层。（元素是文本和图像元素）。

我有一个代表项目的类。它包含一个`ObservableCollection<Layer>`，每个层都有一个`ObservableCollection<Element>`. 元素是一个抽象类。有一个继承自 Element 的 TextElement 和 ImageElement 类。

我的问题是，当我更改集合中的元素时，UI 永远不会更新。我在我的所有属性上使用 INotifyPropertyChanged 并且我在集合上捕获 CollectionChanged 但仍然没有成功。CollectionChanged 事件`ObservableCollection<Element>`永远不会在更新其元素之一时受到影响。

这是我最初拥有的代码：

`void Elements_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e) { this.NotifyChange("Elements"); }`

如果有人可以提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:11:11.917

`ObservableCollection<>`在添加或删除项目时发布`CollectionChanged`，但当集合中的项目更改时不会这样做。

为了解决这个问题，您可以订阅`CollectionChanged`事件，然后订阅处理程序`INotifyPropertyChanged`中添加的元素`CollectionChanged`：

```
elementCollection.CollectionChanged += (s, a) =>
{
    foreach (Element element in a.NewItems)
        element.PropertyChanged += ElementChanged;
}; 
```

然后您可以在方法中更新 UI `ElementChanged`。

# javascript - 单词边界是否适用于符号字符？

> ID：10983932
> 
> 赞同：0
> 
> 时间：2012-06-11T16:20:47.550
> 
> 标签：javascript, regex, word-boundary

我正在尝试在我的表情符号功能中实现单词边界以进行聊天。但由于某种原因，我似乎无法让边界这个词起作用。我是正则表达式的新手。

所以当我这样做时：

```
var reg = /\b\Hi\b/gi;
var str = 'HiHiHi Hi HiHiHi Hi';
alert(str.replace(reg, '')); 
```

发生这种情况：[Jsfiddle](http://jsfiddle.net/ESb8n/)

它实际上工作正常，并且确实删除了那些单独站立的 2 个 Hi。

但是当我将 reg 更改为转义的笑脸然后更改字符串时：

```
var reg = /\b\:\)\b/gi;
var str = 'HiHi:) :) HiHiHi :)';
alert(str.replace(reg, '')); 
```

发生这种情况： [Jsfiddle](http://jsfiddle.net/Bzqu8/)

它只是行不通。字符串保持不变。是不是单词边界不能用于符号？如果是这样，Facebook 如何在他们的聊天中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:25:06.217

单词边界表示单词字符（在 javascript 中）和非单词字符（其他所有字符）`\b`之间的零宽度边界。`\w``[A-Za-z_]``\W`

因此，两个表情符号之间或当表情符号被空格、标点符号等包围时，不会有边界。

最简单的正则表达式是，它支持带有可选破折号和眼睛或眨眼的`/[:;]-?[()]/gi`笑脸`)`和皱眉。`(``:``;`

**编辑：**

这将需要一个空格或字符串的开头（作为一个捕获组，因为 Javascript 不支持后视），然后它使用上面的正则表达式，然后它必须跟在字符串或空格的结尾。

```
var reg = /(\s|^)[:;]-?[()](?:\s|$)/gi;
var str = 'HiHi:) :) HiHiHi :)';
alert(str.replace(reg, '$1')); 
```

在这些情况下应更换：`:-)`,`cool :( not!`

在这些情况下不应更换：`Digits:(0,1,2,3)`,`hi :(.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:36:46.740

由于`\b`在这种情况下不起作用，您可以使用：

```
var re = /(\s|^):\)(?!\S)/g;
var str = 'HiHi:) :) HiHiHi :)';
alert(str.replace(re, '$1')); 
```

这就像一个空间边界。

您可以像这样添加几个笑脸：

```
/(\s|^)(?::\)|:\(|:\||:\]|:\[)(?!\S)/g; 
```

# java - 如何将 Web 逻辑服务器控制台存储到文件中

> ID：10983936
> 
> 赞同：1
> 
> 时间：2012-06-11T16:21:00.423
> 
> 标签：java, weblogic11g

我如何将服务器输出控制台存储到`server.log`类似 netbeans apache 输出控制台的输出中`server.log`以跟踪 sql 错误并显示`system.out.println`

**`i have tried`**在 weblogic 管理控件中配置日志记录和调试部分，但我找不到解决问题的线索，server.log 存在存储 http 请求和其他对我不重要的东西，我阅读参考和手册“快速阅读”所以如果有人能给我一个关于我的问题或解决方案的参考，可能是因为我找不到合适的术语来搜索

例子

```
the Form Action is :searchEmNominativeInterviewPrevInvertory

=========EXTRA PARAMETER FOR SEARCH=========

Extra Parameters

=========EXTRA PARAMETER FOR SEARCH=========

-----<<>>----trying to get connection--3---
PDAO 
PDAO user
PDAO null
PDAO  1 = 1  AND REQ_CLASS = 'I'
PDAO 
PDAO 
PDAO -1
PDAO -1
PDAO null
PDAO -1
PDAO -1
PDAO -1
PDAO -1
PDAO I
PDAO -1
PDAO -1
PDAO 9481007150
PDAO 1
PDAO 13
PDAO 
PDAO 
-----<<>>----Executing the Security Procedure Fail...
java.sql.SQLException: ORA-06550: سطر 1 ، عمود  7 : 
PLS-00905: object HR2_EMPL.EM_NOM_INTER_PREV_STOCK$SELECT is invalid
ORA-06550: سطر 1 ، عمود  7 : 
PL/SQL: Statement ignored

        at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)
        at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288)
        at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:743)
        at oracle.jdbc.driver.T4CCallableStatement.doOall8(T4CCallableStatement.java:215)
        at oracle.jdbc.driver.T4CCallableStatement.executeForRows(T4CCallableStatement.java:954)
        at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1168)
        at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3285)
        at oracle.jdbc.driver.OraclePreparedStatement.execute(OraclePreparedStatement.java:3390)
        at oracle.jdbc.driver.OracleCallableStatement.execute(OracleCallableStatement.java:4223)
        at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.execute(DelegatingPreparedStatement.java:169)
        at com.rss.components.ParentDAO.executeProcedure(ParentDAO.java:318)
        at rss.hr2.recruitment.RecruitmentDAO.searchEmNominativeInterviewPrevInvertory(RecruitmentDAO.java:15051)
        at rss.hr2.recruitment.interviews.searchEmNominativeInterviewPrevInvertory.execute(searchEmNominativeInterviewPrevInvertory.java:159)
        at rss.controller.CommandDispatcher.executeCommand(CommandDispatcher.java:111) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:36:29.880

服务器控制台日志可以重定向到日志文件。

```
Adminstration Console - Server (Your server Name) - Logging - Redirect stdout logging enabled

Adminstration Console - Server (Your server Name) - Logging - Redirect stderr logging enabled 
```

尽管您拥有的堆栈跟踪应该作为应用程序日志记录的一部分进行处理。

可以在[此处](http://docs.oracle.com/cd/E21764_01/web.1111/e13739/config_logs.htm)找到完整的 Weblogic Server Logging 。

编辑：

移自以下评论：

[Log4j 教程](http://tutorialspoint.com/log4j/index.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T05:34:20.023

这个链接可以解决我的问题

[在 Weblogic Server 中配置*log4j的参考*](http://ananthkannan.blogspot.com/2009/09/how-to-configure-log4j-in-weblogic.html)

[关于如何将 Log4j 与 WebLogic 日志服务一起使用的 oracle 文档](http://docs.oracle.com/cd/E13222_01/wls/docs91/logging/config_logs.html#1014610)

第一个链接内容第一段阅读链接为重置

在 weblogic 服务器中配置 log4j 我最近为我们部署在 weblogic 10.3 域中的 Web 应用程序配置了 log4j。步骤如下：

1.  `log4j-1.2.9.jar & wllog4j.jar`下复制`domain_root/lib folder`。
2.  `log4j.xml`在 domain_root 文件夹下创建并删除它。如果您在应用程序（EAR/WAR）中有 log4j.xml，我建议移到 EAR/WAR 之外
    ，因为更改严重性（日志级别）需要重新部署。
    为避免这种情况，我们可以将 log4j.xml 移动到域根文件夹中，但需要再次退回服务器。但有一个解决办法。点击这里获取更多信息。
3.  登录到 weblogic 服务器控制台。`Go to Servers -> Admin Server-> Logging.`
    点击高级模式。`JDK to Log4J.`从单击保存更改日志记录实现。
4.  激活更改。重新启动管理服务器。

这应该启用 log4j 并且应该将日志写入`log4j.xml or properties file`.

如果你想要一个例子，我推荐这个[log4j - 快速指南](http://www.tutorialspoint.com/log4j/log4j_quick_guide.htm)

建议您应该耐心阅读和申请

# windows-phone-7 - 隔离存储文件流异常

> ID：10983938
> 
> 赞同：0
> 
> 时间：2012-06-11T16:21:02.760
> 
> 标签：windows-phone-7, isolatedstorage

我在单击按钮时从 Internet 异步读取文件并将其写入 txt 文件。如果文件存在，我总是检查按钮单击。如果文件不存在，我使用一个函数来下载它。之后我调用函数来读取文件。问题是我通常在 IsoaltedStorageFileStream 异常上不允许操作。我从代码中删除了读取函数，只调用了写入，然后运行程序没有任何异常。然后我再次编写读取函数，它可以工作。为什么第一种方法不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:22:12.377

问题在于对文件的访问。如果您的异步操作打开了文件，并且当它仍在写入时，您想要读取它。这是并发问题。在逻辑中添加某种锁定，即使是简单的布尔标志也足够​​了。

```
private canRead = false; 
```

当应用程序完成阅读时，将其设置为 true。然后在你的阅读逻辑中

```
if(canRead)
{
     //read file
} 
```

其他选项是隐藏按钮并在下载完成时显示它。

# android - Android - 让活动保持其原始方向

> ID：10983941
> 
> 赞同：0
> 
> 时间：2012-06-11T16:21:23.627
> 
> 标签：android, android-layout, android-intent, android-emulator, android-widget

当我打开一个活动时，我希望该活动保持在打开的那个方向。
例如，如果我在 PORTRAIT 模式下打开它，那么用户将无法将其更改为横向，而当我在 LANDSCAPE 模式下打开它时，用户将无法更改为纵向。（我需要这个作为视频播放器）

为此，我获取当前屏幕方向，然后设置它，如下所示：

```
int orientation = getResources().getConfiguration().orientation;
setRequestedOrientation(orientation); 
```

如果我在 PORTRAIT 模式下打开 Activity，并尝试通过旋转手机切换到 LANDSCAPE，它不会 - 这是预期的。问题是，如果在 LANDSCAPE 中打开活动并且我尝试旋转到纵向 - 它确实如此。

我不明白为什么会发生这种情况。

代码出现在 onCreate() 的 setContentView() 上方

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:28:15.367

问题在于`getResources().getConfiguration().orientation`并且`setRequestedOrientation(orientation);`使用不同的常数。您可以尝试阅读它们的文档，并在它们之间进行映射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:28:43.247

试试这个：

```
@Override
    public void onResume() {
        super.onResume();
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_SENSOR);

    } 
```

# javascript - jQuery + window.location.hash 和同页锚点 - 不一致的行为？

> ID：10983943
> 
> 赞同：0
> 
> 时间：2012-06-11T16:21:32.580
> 
> 标签：javascript, jquery, html, anchor

考虑以下 JS 代码：

```
<script type="text/javascript">

$(function() {
    // Check if landing on the page with a hash
    if (window.location.hash.length) {
        $('html,body').animate({scrollTop: 200}, 100);
        return false;
    }

    // Same-page anchors
    $('a[href*=#]').click(function() {
        // ... find the target based on the div and animate the scrollTop property again
       }
    });
}); 
</script> 
```

它的作用是首先检查是否登陆带有#anchor 的页面，或者用户是否单击同一页面的#anchor 并简单地为具有相应ID 的目标div 设置动画。

问题是这两个交替工作：如果您登陆一个带有井号的页面，该页面将动画到 div ID，但随后的同一页面链接不会被绑定的“点击”事件拦截（I'我也试过用 live() 绑定它，没有区别）

如果您使用干净的 URL 登陆页面，链接将再次起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T17:13:34.137

为什么返回false？这没有任何意义，因为在“就绪”事件处理程序中，没有可以阻止的默认行为或会冒泡的 DOM 树。此外，它还可以防止执行以下语句（特别是事件处理程序与链接的绑定）。

```
if (window.location.hash.length) {
    $('html,body').animate({scrollTop: 200}, 100);
    return false;  // <-- remove this line!
} 
```

# jquery - 点击事件在 Chrome 上不起作用，但在 Firefox 中很好

> ID：10983947
> 
> 赞同：2
> 
> 时间：2012-06-11T16:21:55.073
> 
> 标签：jquery, google-chrome

我的代码使用 jquery 向页面添加元素，然后向其添加“点击”事件。代码是：

```
$('.photosItem').mouseover(function() {
        // Remove all existing comment buttons
        $('.reelPhotoPageCommentLink').remove();
        // Add a comment button
        var commentButton = "<div class='reelPhotoPageCommentLink'>";
        commentButton += "Comment";
        commentButton += "</div>";
        $(this).prepend(commentButton);
        // Add click event to comment button
        $('.reelPhotoPageCommentLink').click(function() {
            $('#editPopupForm').remove();
            // Get photo id
            var photoID = $(this).parent().attr('photo_id');
            var url = "get_photo_comment_form/" + photoID;
            $.ajax({ 
                url: url,
                type: "POST",
                success: function(data) {
                    // Add item after header
                    $('#header').after(data);
                }
            });
        });
    }); 
```

因此，当您将鼠标悬停在具有“photosItem”类的照片上时，会出现一个“评论”按钮。点击按钮弹出评论框。这在 Firefox 上运行良好，但我在 Chrome 上遇到了问题，它似乎没有接收到点击事件。当我悬停时它会添加评论按钮，但单击它不会做任何事情。控制台在任何阶段都没有错误。

我在 $('.reelPhotoPageCommentLink').click(function() { 之后添加了一个 console.log，它没有显示出来，所以看起来点击事件被忽略了。

任何人有任何想法我怎样才能让它工作？在 Firefox 中没问题，那里没有警告或错误。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T16:23:14.483

当您动态添加`.reelPhotoPageCommentLink`到 DOM 时，即在 DOM 加载之后，您需要委托事件处理程序。

```
$('.photosItem').on('click', '.reelPhotoPageCommentLink', function() {

}); 
```

虽然您的代码在某些浏览器上运行，但以上是正确的过程。

### 如果您将上面的`click`处理程序代码放在事件之外会更好`mouseover`，将任何事件绑定到另一个事件中并不是一个好主意。

完整代码如下所示：

```
// Add click event to comment button

 $('.photosItem').on('click', '.reelPhotoPageCommentLink', function() {
    $('#editPopupForm').remove();
    // Get photo id
    var photoID = $(this).parent().attr('photo_id');
    var url = "get_photo_comment_form/" + photoID;
    $.ajax({ 
        url: url,
        type: "POST",
        success: function(data) {
            // Add item after header
            $('#header').after(data);
        }
    });
});

$('.photosItem').mouseover(function() {
    // Remove all existing comment buttons
    $('.reelPhotoPageCommentLink').remove();
    // Add a comment button
    var commentButton = "<div class='reelPhotoPageCommentLink'>";
    commentButton += "Comment";
    commentButton += "</div>";
    $(this).prepend(commentButton);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:25:23.783

在鼠标悬停时附加事件处理程序似乎是个坏主意。您可能应该使用委托事件编程模型，该模型将事件处理程序附加到 DOM 中的更高级别，并且可以处理动态添加的内容。例如

```
$('.photosItem').on('click', '.reelPhotoPageCommentLink', function(e) {

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-15T12:39:00.377

我最终放弃了这个。

相反，我在页面加载时生成了带有点击事件的按钮，但将它们隐藏起来。然后翻转显示按钮而不是生成它们。

感谢 codeparadox 和 Malevolence 的帮助。了解 jsfiddle 也很方便——我相信我会再次使用它。

# magento - 如何获取 Magento 主题目录？

> ID：10983955
> 
> 赞同：2
> 
> 时间：2012-06-11T16:22:10.073
> 
> 标签：magento, magento-1.6

首先，我在[这里](https://stackoverflow.com/questions/10360096/get-skin-path-in-magento)，但这无济于事，因为

```
$this->getSkinUrl() 
```

不是我想要的，因为它返回**URL**而不是**路径**

```
Mage::getBaseDir('skin'); 
```

返回皮肤基础目录，那里可能有很多主题..

我想确定当前的主题基础目录。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-11T17:07:17.143

尝试这个：

```
Mage::getSingleton('core/design_package')->getSkinBaseDir() 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-11T16:32:49.527

可能有很多主题，但它将使用您配置的任何内容，并且会一直用到可能在 System > Config > Design 中使用的包/主题

如果您正在寻找目录，

Mage_Core_Model_Design_Package::getSkinBaseDir()

```
public function getSkinBaseDir(array $params=array())
{
    $params['_type'] = 'skin';
    $this->updateParamDefaults($params);
    $baseDir = (empty($params['_relative']) ? Mage::getBaseDir('skin').DS : '').
        $params['_area'].DS.$params['_package'].DS.$params['_theme'];
    return $baseDir;
}

public function updateParamDefaults(array &$params)
{
    if ($this->getStore()) {
        $params['_store'] = $this->getStore();
    }
    if (empty($params['_area'])) {
        $params['_area'] = $this->getArea();
    }
    if (empty($params['_package'])) {
        $params['_package'] = $this->getPackageName();
    }
    if (empty($params['_theme'])) {
        $params['_theme'] = $this->getTheme( (isset($params['_type'])) ? $params['_type'] : '' );
    }
    if (empty($params['_default'])) {
        $params['_default'] = false;
    }
    return $this;
} 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-06-11T16:30:03.503

这是获取当前路径的方法

```
$_SERVER['DOCUMENT_ROOT'].parse_url($this->getSkinUrl(''),PHP_URL_PATH); 
```

[有关parse_url](http://php.net/manual/fr/function.parse-url.php)的更多详细信息

# image - 创建 CListCtrl 时出错

> ID：10983956
> 
> 赞同：0
> 
> 时间：2012-06-11T16:22:15.167
> 
> 标签：image, visual-c++, mfc, clistctrl

我正在尝试在 MFC 中创建 CListCtrl。我在制作 CImageList 时得到了。

```
BOOL CRadioButtonTestDlg::InitImageList() {
    mImageListNormal.Create(32, 32, ILC_COLOR32, 39, 1);
    CString filePath;
    CFileFind finder;
    CString strWildcard(_T("E:\\MyAssignments\\Window system programming\\MFC\\sample_programs\\VContact\\res\\contact_images\\*.jpg"));
    BOOL bWorking = finder.FindFile(strWildcard);
    while (bWorking) {
        bWorking = finder.FindNextFile();
        if (finder.IsDots())
            continue;
        filePath = finder.GetFilePath();
        CImage image;
        CBitmap bitmap;
        image.Load(filePath);
        bitmap.Attach(image.Detach());
        mImageListNormal.Add(&bitmap, RGB(255, 0, 255));
        bitmap.DeleteObject();
    }
    finder.Close();

    if(mAllContactListCtrl.SetImageList(&mImageListNormal, LVSIL_NORMAL) == NULL)
        AfxMessageBox(_T("Falied to set ImageList"));

    return TRUE;
} 
```

调用 mAllContactListCtrl.SetImageList() 失败。

我想知道使用从 CImage 创建 CBitmap 是否正确，或者我在其他地方做错了。

在输出中我只是得到字符串而不是图像。

==================================================== ========================

我从 InitDialog() 调用上述函数

```
BOOL CRadioButtonTestDlg::OnInitDialog() {
    CDialog::OnInitDialog();

    CRect rect;
    mAllContactListCtrl.GetClientRect(&rect);
    mAllContactListCtrl.InsertColumn(0, _T("Name"), LVCFMT_LEFT, rect.Width()-15, 0);
    for (int i = 0; i < 39; i++) {
        mAllContactListCtrl.InsertItem(i, _T("Some String"), i);
    }
    InitImageList();

    return TRUE;
} 
```

# java - 如何通过单击html页面中的菜单从jsp调用java方法？

> ID：10983961
> 
> 赞同：1
> 
> 时间：2012-06-11T16:22:37.073
> 
> 标签：java, javascript, jquery, ajax, jsp

我用java编写了一个服务器程序，但是为了提供一个与web的接口，我想在单击某个菜单按钮时访问jsp中的java方法。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T16:23:51.763

使用 ajax （使用[`jQuery.ajax`](http://api.jquery.com/jQuery.ajax/)，您可以向服务器发出请求，在您的情况下，可能`Servlet` 会调用您请求的服务器上的方法

**例如：**

```
function callMe(){
    $.ajax({
      type: "POST",
      url: "/someServlet",
      data: { methodToInvoke: "sayHello" , data: "Abc" }
    }).done(function( msg ) {
      alert( "Data Saved: " + msg );
    });
} 
```

`Servlet`最后_

```
doPost(...){
 String methodToCall = request.getParameter("methodToCall");
 //do some stuff to determine method to call and call it like
 methodService.invoke(request.getParameter("data"));
} 
```

**另见**

*   [DWR](http://directwebremoting.org)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:29:26.637

你不能直接这样做，因为 JSP 是服务器端而 html 是客户端。但是，它可以通过 AJAX 来完成。[http://en.wikipedia.org/wiki/Ajax_](http://en.wikipedia.org/wiki/Ajax_(programming) （编程）

# c# - 无法在设计视图中将“复杂对象”作为参数传递

> ID：10983962
> 
> 赞同：0
> 
> 时间：2012-06-11T16:22:39.383
> 
> 标签：c#, asp.net

我创建了自己的验证控制器，以使用我自己的用户控件。

我的问题 ：

经典验证器接受“设计视图”中的参数，例如

```
<asp:RequiredFieldValidator ControlToValidate="txtFirstname" runat="server" /> 
```

我想在我的控件中做同样的事情，但是当我传递“ControlToValidate”一个控件 ID 时，它会出现，我收到这个错误：

> 无法从“ControlToValidate”属性的字符串表示“txtFirstname”创建“System.Web.UI.WebControls.WebControl”类型的对象。

我需要实现什么“模式”以确保我可以充分利用我的“ascx”页面，而不必在我的“ascx.cs”代码隐藏页面中连接所有内容。

ps 我将在“ascx”页面上创建的“标签”称为“设计视图”，但我认为这可能是错误的术语，我怀疑这是我在谷歌上找不到任何东西的一半原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T17:20:02.863

您的代码应该看起来像这样（全部在 中`.ascx`）：

```
<asp:TextBox id="txtFirstName" 
      Text="Enter a value" 
      runat="server"/>

 <asp:RequiredFieldValidator id="RequiredFieldValidator1"  
      ControlToValidate="txtFirstName"
      Text="Required Field!" 
      runat="server"/> 
```

我猜你**没有**把它`RequiredFieldValidator`放在同一个范围内 - 导致这个问题。

# neo4j - Neo4jClient 数据导入

> ID：10983967
> 
> 赞同：4
> 
> 时间：2012-06-11T16:23:22.753
> 
> 标签：neo4j, neo4jclient

我使用 Neo4jClient (.NET)。我必须像国家一样导入主数据。

我已经看到 Neo4j 有一个 Java API（[批量插入 API](http://docs.neo4j.org/chunked/stable/batchinsert.html)）。是否可以通过 Web 界面或其他工具导入数据？

如果没有，我是否必须通过具有该`Create()`功能的 Neo4JClient 包装器导入数据？！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T17:35:57.023

如果您咬紧牙关并使用批处理插入 API 执行此操作，它会快得多——通过用 Java 或其他 JVM 语言编写导入脚本，或者使用 Michael Hunger 的批处理插入器，它从 CSV 插入数据。查看 Max de Marzi[关于该主题的帖子，](http://maxdemarzi.com/2012/02/28/batch-importer-part-1/)了解一个好的方法。

尽管 REST 绑定试图提供不错的性能，但它们永远不会像本地数据库访问那样快——即使是这样，批量插入 API 也将一些数据库功能（多线程访问等）剥离到了极致改善初始导入时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-14T21:28:56.287

Check out the Cypher neo4j import csv option. Maybe that helps. Otherwise just use a big Cypher query

[http://neo4j.com/docs/milestone/query-load-csv.html](http://neo4j.com/docs/milestone/query-load-csv.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T09:27:36.317

另外，您能否尝试使用 Cypher CREATE，因为它不如 Batch 快，但比 REST 快，并且应该可以让您快速创建内容。

[http://docs.neo4j.org/chunked/snapshot/cypher-cookbook-pretty-graphs.html](http://docs.neo4j.org/chunked/snapshot/cypher-cookbook-pretty-graphs.html)给出了一些很好的提示......

# jquery - jQuery JSON 将对象保存到 ASP.NET MVC2

> ID：10983969
> 
> 赞同：0
> 
> 时间：2012-06-11T16:23:38.403
> 
> 标签：jquery, ajax, json, asp.net-mvc-2, deserialization

我正在使用 ASP.NET MVC2 和 jQuery 来加载和保存对象。我正在使用 knockout.js 的对象序列化/反序列化来在加载/保存数据时安全地维护对象的数据结构。

当我使用以下 JavaScript 方法将我的对象以其确切结构发送回服务器时，在 ASP.NET 的服务器端，我的 GraduationClass 对象被实例化，但它没有任何数据。

我在 firebug 中检查了 post 数据，所有数据都以正确的结构正确发送回请求中的服务器，但 ASP.NET MVC 内部管道未能将数据反序列化回 GraduationClass 对象。我在有和没有 contentType 设置的情况下都试过了。

我想知道我做错了什么。

```
// javascript save method
function save(graduationClass) {
    $.ajax({
        url: "/SiteManagement/saveGraduationClass",
        type: "POST",
        // data: ko.mapping.toJSON(graduationClass), // (solution 1)
        data: graduationClass, // (solution 2)
        contentType: "application/json; charset=utf-8",
        dataType: "json",            
        success: function(data) {            
    });    
}

// both solutions result in a blank object construction on the server side

// ASP.NET MVC2 AJAX method
[HttpPost]               
public ActionResult saveGraduationClass(GraduationClass graduationClass) {
    // graduationClass here has all default data rather than the data sent in the post
    return Json(new { resultText = "success" }, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:30:21.560

我相信有两个可能的问题。

首先，我很确定当您指定在 Ajax 请求中发送 JSON 时，jQuery 将序列化传入数据参数的 Javascript 对象。您肯定是在创建一个`json`具有字符串值的属性的 jQuery 对象（我相信，我不熟悉淘汰赛）。传递给 MVC 的值将如下所示：

```
{
  json : 'string of graduationClass data '
} 
```

这是一种双重序列化。

`saveGraduationClass`第二个问题是，之前的 JSON 与你的方法参数不匹配`graduationClass`。

我认为这些解决方案中的任何一个都应该有效：

```
data: ko.toJSON(graduationClass),  // knockout.js utility method 
```

或者

```
data: graduationClass,  // let jQuery serialize the object. 
```

**更新**

如果我有这门课：

```
public class Person
{
  public string Name { get; set; } 
} 
```

我有这个 JSON：

```
{
  Name : 'Jon Doe'
} 
```

然后它将填充此方法：

```
public ActionResult SomeMethod(Person person) 
```

但是，以下 JSON 将不起作用：

```
{
  json : '{ Name : "Jon Doe" }'
} 
```

它也不会匹配：

```
{
  json :
  {
    Name : 'Jon Doe'
  }
} 
```

JSON的*布局*需要与试图填充的类的布局完全匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T16:35:39.767

嗨，我认为问题可能出在默认的 JsonValueProvider 中，但您可以编写一个自定义的：

```
public sealed class JsonDotNetValueProviderFactory : ValueProviderFactory
    {          

        private static void AddToBackingStore(Dictionary<string, object> backingStore, string prefix, object value)
        {
            IDictionary<string, object> d = value as IDictionary<string, object>;
            if (d != null)
            {
                foreach (KeyValuePair<string, object> entry in d)
                {
                    AddToBackingStore(backingStore, MakePropertyKey(prefix, entry.Key), entry.Value);
                }
                return;
            }

            IList l = value as IList;
            if (l != null)
            {
                for (int i = 0; i < l.Count; i++)
                {
                    AddToBackingStore(backingStore, MakeArrayKey(prefix, i), l[i]);
                }
                return;
            }

            // primitive
            backingStore[prefix] = value;
        }

        private static object GetDeserializedObject(ControllerContext controllerContext)
        {
            if (!controllerContext.HttpContext.Request.ContentType.StartsWith("application/json", StringComparison.OrdinalIgnoreCase))
            {
                // not JSON request
                return null;
            }

            StreamReader reader = new StreamReader(controllerContext.HttpContext.Request.InputStream);
            string bodyText = reader.ReadToEnd();
            if (String.IsNullOrEmpty(bodyText))
            {
                // no JSON data
                return null;
            }

            object jsonData = new JavaScriptSerializer().DeserializeObject(bodyText);
            return jsonData;
        }

        public override IValueProvider GetValueProvider(ControllerContext controllerContext)
        {
            if (controllerContext == null)
            {
                throw new ArgumentNullException("controllerContext");
            }

            object jsonData = GetDeserializedObject(controllerContext);
            if (jsonData == null)
            {
                return null;
            }

            Dictionary<string, object> backingStore = new Dictionary<string, object>(StringComparer.OrdinalIgnoreCase);
            AddToBackingStore(backingStore, String.Empty, jsonData);
            return new DictionaryValueProvider<object>(backingStore, CultureInfo.CurrentCulture);
        }

        private static string MakeArrayKey(string prefix, int index)
        {
            return prefix + "[" + index.ToString(CultureInfo.InvariantCulture) + "]";
        }

        private static string MakePropertyKey(string prefix, string propertyName)
        {
            return (String.IsNullOrEmpty(prefix)) ? propertyName : prefix + "." + propertyName;
        }

    } 
```

然后将其添加到 Global.asax 中的 Application_Start 中：

```
 ValueProviderFactories.Factories.Remove(ValueProviderFactories.Factories.OfType<JsonValueProviderFactory>().FirstOrDefault());
ValueProviderFactories.Factories.Add(new JsonDotNetValueProviderFactory()); 
```

此示例使用[Json.NET](http://json.codeplex.com/)

最好使用 ko.mapping 插件[ko.mapping](http://knockoutjs.com/documentation/plugins-mapping.html)，因为你的毕业类可能是可观察的对象：

```
var jsonModel = ko.mapping.toJSON(graduationClass);

                    $.ajax({
                        url: '/SiteManagement/saveGraduationClass',
                        type: 'POST',
                        dataType: 'json',
                        data: jsonModel,
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            // get the result and do some magic with it                            
                        }
                    }); 
```

# tomcat - tomcat 记录标准输出标准错误

> ID：10983970
> 
> 赞同：5
> 
> 时间：2012-06-11T16:23:41.677
> 
> 标签：tomcat

我使用 bin 中的启动命令启动 tomcat。如何将 println 记录到 stdout 并将错误记录到 stderr 而不是控制台？要修改哪个文件以及如何修改？我正在使用 Windows Server 2008。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-11T18:06:36.177

如果你运行`bin/startup.bat`，那么 Tomcat 应该在后台启动并且 stdout/stderr 应该被重定向到`logs/catalina.out`. 相反，如果您运行`bin/catalina.sh run`（注意附加的命令行参数“run”），那么 Tomcat 应该在控制台中运行并且所有的 stdout/stderr 都应该在那里显示。

# c# - 设计方法

> ID：10983971
> 
> 赞同：3
> 
> 时间：2012-06-11T16:23:46.200
> 
> 标签：c#

我需要以下设计方面的帮助。基本上我有一个 Main 表单，它初始化一个名为**Settings**的类。当用户单击一个名为 CommunicationsSetupForm 的表单时，Main 会在其 ctor 中传递**Settings类。**通过该 CommunicationsSetupForm，用户可以更改通信类型（RS232、RS485、TCP/IP 等）、波特率、COM 端口名称等设置。

完成此操作后，焦点将返回到主窗体。从这里，用户可以将数据包发送到相应的硬件，例如 RUN 数据包。数据包是通过 Init Packet 类初始化的，该类也接受其 CTOR 中的**Settings**类，然后 InitalizePacket 调用 PacketGenerate，它也在其 CTOR 中传递**Settings**类，最后通过来自 PacketGenerate 的事件调用 CommunicationMediator。CommunicationMediator 实际上是在 Main Form 中初始化的，并且还通过其 CTOR接收**Settings类。**下面是正在发生的事情的图片，我希望它能让情况更清楚一点： ![在此处输入图像描述](../Images/6d52bf0e698dfa26003e63783455aa79.png)

我的问题是，CommunicationMediator 知道**Settings**类是否已更改的最佳方法是什么。例如，用户现在已将波特率从 9600 更改为 300。根据我的研究，我已经阅读了有关“深度复制”以及实现它的方法：[How do you do a deep copy of an object in .NET (C#具体来说）？](https://stackoverflow.com/questions/129389/how-do-you-do-a-deep-copy-an-object-in-net-c-specifically). **使用这种技术，我可以创建一个名为OldSettings**的类的非引用副本，并在每次需要通过硬件发送某些内容时将其与当前的**Settings类进行比较。**如果**OldSettings != Settings**，我首先更改硬件上的设置。

如果我以这种方式实现旧的**Settings**类和当前的**Settings**类，如何进行比较？这是 CommunicationMediator 检查**Settings**类是否已更改的最佳方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-11T16:25:13.543

您的`Settings`班级可以只实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged%28v=vs.95%29.aspx)。这是框架中的标准接口，允许您在类中的属性发生更改时订阅通知，并且比每次深度复制和比较简单得多。

# tsql - 高效的查询和执行计划

> ID：10983974
> 
> 赞同：0
> 
> 时间：2012-06-11T16:24:00.330
> 
> 标签：tsql

我有一个简单的实体框架查询。它使用分组：

```
source.GroupBy(x => x.Key)
.Select(x => x.Count(z => z.IsDefaultValue == false) > 0
    ? x.FirstOrDefault(z => z.IsDefaultValue == false)
    : x.FirstOrDefault()
); 
```

它的执行计划如下所示：

![计划一](../Images/34a1007faa95767f9a2833ce8b16bb9d.png)

然后我更改查询：

```
source.GroupBy(x => x.Key)
.Select(x => x.Any(z => z.IsDefaultValue == false)
    ? x.FirstOrDefault(z => z.IsDefaultValue == false)
    : x.FirstOrDefault()
); 
```

现在我使用**Any**而不是**Count**。它的计划是这样的： ![计划 2](../Images/372287d6b3016cc792fbb43842ebc37c.png)

我的问题是：我应该使用什么查询？什么查询更有效？

我对执行计划一无所知:(您在这些执行计划中看到了哪些重要信息？

**编辑：请将图片拖到新标签中，它会更具可读性。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T13:05:31.583

> 我的问题是：我应该使用什么查询？什么查询更有效？

为了找到这个问题的答案，我将简单地获取已生成的两个 SQL 查询（您可以在计划的 xml 中查看完整的查询）并在一个 SQL Server Management Studio 查询窗口中一起运行它们，并使用“包括实际执行计划”选项。

然后，生成的计划中的“查询成本（相对于批次）”将告诉您哪个对您的实际架构/数据更有效。

> EF 的 Any() vs Count() > 0 怎么样？哪个更有效率？

一般来说，如果您只想知道*任何*“事物”是否符合您的标准，那么通常建议您使用 Any() 而不是 Count() > 0 并让 LINQ 担心构建最有效的方法。在这个用例中，我只需检查 SQL 并查看。

看到这样的[答案](https://stackoverflow.com/a/305156/1558255)

> 对于 just `IEnumerable<T>`， then*通常*`Any()`会更快，因为它只需要查看一次迭代。

# c++ - CreateRemoteThread：内存管理

> ID：10983977
> 
> 赞同：3
> 
> 时间：2012-06-11T16:24:17.693
> 
> 标签：c++, c, windows, winapi, createremotethread

我想知道[CreateRemoteThread](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682437%28v=vs.85%29.aspx)函数的`LPVOID lpParameter`参数。因为进程不共享内存，远程线程无法访问我们进程中的结构。那么，函数是复制参数并自己管理它，还是我们需要使用[VirtualAllocEx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366890%28v=vs.85%29.aspx)分配内存，然后调用[WriteProcessMemory](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681674%28v=vs.85%29.aspx)将结构实际复制到远程进程中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:27:20.983

`CreateRemoteThread`不做任何自动管理`lpParameter`。您是对的，由开发人员确保它`lpParameter`是目标进程上下文中的有效指针。`VirtualAllocEx`并且`WriteProcessMemory`绝对是这样做的选择。

# .net - 使用 SQL Server 2008 的 DbFit 异常

> ID：10983979
> 
> 赞同：0
> 
> 时间：2012-06-11T16:24:21.627
> 
> 标签：.net, fitsharp, dbfit

dbFit 的新手。下载的 dbfit 1.1 版本成功执行了查询，除了一个查询。然后该查询将超时。

然后当我更新超时修复程序时 - [https://github.com/jediwhale/fitsharp](https://github.com/jediwhale/fitsharp)，将失败。

然后返回以下错误：

```
 System.ApplicationException: Type 'dbfit.sqlserver' could not be found in  assemblies.
   Assemblies searched:    file:///C:/fitnesse20090321/fitnesse/dotnet/FitLibrary.DLL
file:///C:/Windows/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll
file:///C:/fitnesse20090321/fitnesse/dotnet/FitServer.exe
file:///C:/fitnesse20090321/fitnesse/dotnet/fit.DLL
file:///C:/Windows/assembly/GAC_MSIL/System/2.0.0.0__b77a5c561934e089/System.dll
         file:///C:/Windows/assembly/GAC_MSIL/System.Configuration/2.0.0.0__b03f5f7f11d50a3a/System.Configuration.dll
file:///C:/Windows/assembly/GAC_MSIL/System.Xml/2.0.0.0__b77a5c561934e089/System.Xml.dll
file:///C:/Windows/assembly/GAC_32/System.Web/2.0.0.0__b03f5f7f11d50a3a/System.Web.dll
      Load errors: Could not load file or assembly 'file:///C:\fitnesse20090321\fitnesse\dotnet\dbfit.dll' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded., Could not load file or assembly 'file:///C:\fitnesse20090321\fitnesse\dotnet\dbfit.sqlserver.dll' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded., Could not load file or assembly 'file:///C:\fitnesse20090321\fitnesse\dotnet\dbfit.sybase.dll' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded., Could not load file or assembly           'file:///C:\fitnesse20090321\fitnesse\dotnet\fitSharp.dll' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded., Could not load file or assembly 'file:///C:\fitnesse20090321\fitnesse\classes' or one of its dependencies. The system cannot find the file specified., Could not load file or assembly 'file:///C:\fitnesse20090321\fitnesse\fitnesse.jar' or one of its dependencies. The module was expected to contain an assembly manifest.
  at fit.Assemblies.FindType(TypeName theName)
  at fit.TypeName.get_Type()
 at fit.TypeName.CreateInstance()
  at fit.Fixture.LoadClass(String theClassName)
  at fit.StoryTest.DoTables() 
```

关于解决方案的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T20:43:22.783

你下载的是哪个？听起来您为其他软件正在使用的不同版本的 .Net Framework 下载了一个 zip 文件（所以可能是 4.0 而不是 2.0。）

# php - mysql php从2个表中减去2个字段改进查询

> ID：10983980
> 
> 赞同：1
> 
> 时间：2012-06-11T16:24:31.880
> 
> 标签：php, mysql, subtraction

大家好，我正在尝试改进我的查询以获得更好的性能是否可以以更好的方式编写此查询，非常感谢您的帮助

```
$query = " SELECT A  FROM out_org where zone_id='1'";
$query2 = " SELECT A  FROM out_dis where zone_id='1'";

$result = mysql_query($query);
$result2 = mysql_query($query2);

echo "<table border=1 style='background-color:#F0F8FF;' >";
echo "<caption><EM>my table</EM></caption>";
echo "<tr>";
echo "<th>" .OA. "</th>" ;
echo "<th>" .DA. "</th>";
echo "<th>" .total. "</th>";
echo "</tr>";

while($row = mysql_fetch_array($result)  )
{
    while( $row2 = mysql_fetch_array($result2)){
        echo "<tr>";          
        echo "<td>" .$row['A']."</td>";
        echo "<td>" .$row2['A']."</td>";
        echo "<td>" .$total = $row['A'] - $row2['A']."</td>";         
        echo "</tr>";           
    }
    echo "</table>";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:28:15.010

使用连接将您的 SQL 更改为一个查询，并在查询中进行减法：

```
$query = "SELECT (o1.A - o2.A) as value 
          FROM out_org o1 
               LEFT JOIN out_dis o2 
               ON o1.zone_id = o2.zone_id
           WHERE o1.zone_id='1'"; 
```

# java - 使用文本文件中的参数的 replaceAll() 方法

> ID：10983981
> 
> 赞同：2
> 
> 时间：2012-06-11T16:24:48.597
> 
> 标签：java, regex, file

我在数据库的表中有一组原始文本，我需要使用一组单词替换该集合中的一些单词。我将所有要替换的术语及其替代项放在一个文本文件中，如下所示

```
min=admin
lelet=lambat
lemot=lambat
nii=nih
ntu=itu 
```

等等。我已成功启动文件和扫描仪的变量来阅读该术语及其替代品的集合。

我循环所有数据集并将原始文本保存在同一循环中的字符串中我循环所有术语集合并将其行保存为字符串名称“模式”，并将模式拆分为两个名为“术语”和“替换器”的字符串在这个循环中，我启动一个新字符串，它的值是由replaceAll（term，replacer）修改的数据集中的字符串，用于术语集合的结束循环，然后我将新字符串插入到数据库结束循环中的另一个表中以获取数据集

我按照以下方式手动执行 replaceAll("min","admin") 及其工作，但它确实可以手动编码近 2000 个术语来替换它。

任何人都曾经面对过这种真正的事情..我现在真的很需要帮助:(

```
 package sentimenrepo;
    import javax.swing.*;
    import java.sql.*;
    import java.io.*;
    //import java.util.HashMap;
    import java.util.Scanner;
    //import java.util.Map;
    /**
     *
     * @author herman
     */
    public class synonimReplaceV2 extends SwingWorker {
        protected Object doInBackground() throws Exception {
                 new skripsisentimen.sentimenttwitter().setVisible(true);

                  Integer row = 0;
                  File synonimV2 = new File("synV2/catatan_kata_sinonim.txt");
                  String newTweet = "";
                DB db = new DB();
            Connection conn = db.dbConnect("jdbc:mysql://localhost:3306/tweet", "root", "");
            try{
              Statement select = conn.createStatement();
              select.executeQuery("select * from synonimtweet");
              ResultSet RS = select.getResultSet();
              Scanner scSynV2 = new Scanner(synonimV2);
              while(RS.next()){
                   row++;

                       String no = RS.getString("no");
                  String tweet = " "+ RS.getString("tweet");
                  String published = RS.getString("published");
                  String label = RS.getString("label");
                  clean2 cleanv2 = new clean2();

                  newTweet = cleanv2.cleanTweet(tweet);
                    try{
                         Statement insert = conn.createStatement();
                         insert.executeUpdate("INSERT INTO synonimtweet_v2(no,tweet,published,label) values('"
                                 +no+"','"+newTweet+"','"+published+"','"+label+"')");
                        String current = skripsisentimen.sentimenttwitter.txtAreaResult.getText();
                  skripsisentimen.sentimenttwitter.txtAreaResult.setText(current+"\n"+row+"original : "+tweet+"\n"+newTweet+"\n______________________\n");
                  skripsisentimen.sentimenttwitter.lblStat.setText(row+" tweet read");
                  skripsisentimen.sentimenttwitter.txtAreaResult.setCaretPosition(skripsisentimen.sentimenttwitter.txtAreaResult.getText().length() - 1);

                    }catch(Exception e){
                         skripsisentimen.sentimenttwitter.lblStat.setText(e.getMessage());

                    }

                 skripsisentimen.sentimenttwitter.lblStat.setText(e.getMessage());

              }
            }catch(Exception e){
                skripsisentimen.sentimenttwitter.lblStat.setText(e.getMessage());

            }
           return row;
        }
        class clean2{

            public clean2(){}

            public String cleanTweet(String tweet){
               File synonimV2 = new File("synV2/catatan_kata_sinonim.txt");

                String pattern = "";
              String term = "";
              String replacer = "";
              String newTweet="";
             try{
                Scanner scSynV2 = new Scanner(synonimV2);
                 while(scSynV2.hasNext()){
                  pattern = scSynV2.next();
                  term = pattern.split("=")[0];
                  replacer = pattern.split("=")[1];
                  newTweet = tweet.replace(term, replacer);
                 }
             }catch(Exception e){
                 e.printStackTrace();
             }

                System.out.println(newTweet+"\n"+tweet);
              return newTweet;

            }
        }

    } 
```

更新

* * *

我刚刚意识到代码实际上有效，但仅适用于数据库中的第一行，第二行等等都静止不动。这是我更新我构建的最新代码

```
public class synonimReplaceV2 extends SwingWorker {

    protected Object doInBackground() throws Exception {
             new skripsisentimen.sentimenttwitter().setVisible(true);

              Integer row = 0;

              String newTweet = "";
            DB db = new DB();
        Connection conn = db.dbConnect("jdbc:mysql://localhost:3306/tweet", "root", "");
        try{
          Statement select = conn.createStatement();
          select.executeQuery("select * from synonimtweet limit 2,10");
          ResultSet RS = select.getResultSet();
          FileReader readSyn = new FileReader("synV2/catatan_kata_sinonim.txt");
          BufferedReader buffSyn = new BufferedReader(readSyn);
          while(RS.next()){
               row++;
                   String no = RS.getString("no");
              String tweet = " "+ RS.getString("tweet");
              String published = RS.getString("published");
              String label = RS.getString("label");
              String pattern = "";
             while((pattern=buffSyn.readLine())!=null){
                 String patternTerm = pattern.split("=")[0];
                 String patternSubs = pattern.split("=")[1];
                 tweet = tweet.replaceAll("\\s"+patternTerm, patternSubs);
             }

                try{
                     Statement insert = conn.createStatement();
                     insert.executeUpdate("INSERT INTO synonimtweet_v2(no,tweet,published,label) values('"
                             +no+"','"+tweet+"','"+published+"','"+label+"')");
                    String current = skripsisentimen.sentimenttwitter.txtAreaResult.getText();
              skripsisentimen.sentimenttwitter.txtAreaResult.setText(current+"\n"+row+"original : "+tweet+"\n"+newTweet+"\n______________________\n");
              skripsisentimen.sentimenttwitter.lblStat.setText(row+" tweet read");
              skripsisentimen.sentimenttwitter.txtAreaResult.setCaretPosition(skripsisentimen.sentimenttwitter.txtAreaResult.getText().length() - 1);

                }catch(Exception e){
                     skripsisentimen.sentimenttwitter.lblStat.setText(e.getMessage());
                }

          }
        }catch(Exception e){
            skripsisentimen.sentimenttwitter.lblStat.setText(e.getMessage());
           // System.out.println(e.getMessage());
        }
        Thread.sleep(100);
       return row;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:36:48.727

打开同义词文件并为您的每一行迭代超过 2,000 行`ResultSet`有点浪费。

一次将同义词加载到内存映射中，以唯一拼写错误的术语为键，然后在映射上查找结果集中的每一行，并根据需要进行替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T18:03:21.010

让我们使用这两种解决方案为您构建一个解决方案：

首先，您使用所有键创建一个 HashMap：

```
public static HashMap<String, String> getMap() {
        //your version would read from the file
        HashMap<String,String> myMap=new HashMap<String,String>();
        myMap.put("min", "admin");
        myMap.put("lelet", "lambat");
        myMap.put("lemot", "lambat");
        myMap.put("nii", "nih");
        myMap.put("ntu", "itu");
        return(myMap);
    } 
```

其次，您创建一个包含哈希图中所有键的模式：

```
public static String getPattern(HashMap<String,String> mapReplacement) {
        String pattern="";
        for (String s : mapReplacement.keySet()) {
            if (!pattern.isEmpty()) {
                pattern=pattern+"|";
            }
            pattern=pattern+s;
        }        
        return(pattern);
    } 
```

接下来，您可以创建一个使用您创建的两个结构的 cleanTweet 方法：

```
public static String cleanTweet(String tweet, Pattern pattern,HashMap<String, String> myMap) {
        String newTweet=tweet;
        Matcher matcher = pattern.matcher(newTweet);
        int start=0;
        while (matcher.find()) {
            String key=matcher.group();
            String replacement=myMap.get(key);
            if (replacement!=null) {
                newTweet=newTweet.replace(key, replacement );
            }            
        }
        return(newTweet);
    } 
```

这可能需要一些调整才能完美（我只测试了几个案例），但关键是您将在您的密钥中迭代一次，然后仅在您的推文上迭代。

我希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-11T16:31:19.197

我没有尝试，但在我看来你几乎已经得到它 - 只需替换这一行：

```
newTweet = tweet.replace(term, replacer); 
```

有了这个：

```
tweet = tweet.replaceAll(term, replacer); 
```

由于您不再使用`newTweet`，请返回`tweet`：

```
return tweet; 
```

您还应该删除该`newTweet`声明。

此外，您不应该阅读`Scanner`阅读行。改为使用`FileReader`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-13T11:15:53.583

谢谢大家，我找到了为什么代码不起作用的答案，

每次程序从数据库中读取一行时，都应该启动包含术语及其替代项的 txt 文件。

代码是这样的

```
public class synonimReplaceV2 extends SwingWorker {

    protected Object doInBackground() throws Exception {
             new skripsisentimen.sentimenttwitter().setVisible(true);

              Integer row = 0;

              String newTweet = "";
            DB db = new DB();
        Connection conn = db.dbConnect("jdbc:mysql://localhost:3306/tweet", "root", "");
        try{
          Statement select = conn.createStatement();
          select.executeQuery("select * from synonimtweet limit 2,10");
          ResultSet RS = select.getResultSet();

          while(RS.next()){
               row++;

          FileReader readSyn = new FileReader("synV2/catatan_kata_sinonim.txt");
          BufferedReader buffSyn = new BufferedReader(readSyn);

                   String no = RS.getString("no");
              String tweet = " "+ RS.getString("tweet");
              String published = RS.getString("published");
              String label = RS.getString("label");
              String pattern = "";
             while((pattern=buffSyn.readLine())!=null){
                 String patternTerm = pattern.split("=")[0];
                 String patternSubs = pattern.split("=")[1];
                 tweet = tweet.replaceAll("\\s"+patternTerm, patternSubs);
             }

                try{
                     Statement insert = conn.createStatement();
                     insert.executeUpdate("INSERT INTO synonimtweet_v2(no,tweet,published,label) values('"
                             +no+"','"+tweet+"','"+published+"','"+label+"')");
                    String current = skripsisentimen.sentimenttwitter.txtAreaResult.getText();
              skripsisentimen.sentimenttwitter.txtAreaResult.setText(current+"\n"+row+"original : "+tweet+"\n"+newTweet+"\n______________________\n");
              skripsisentimen.sentimenttwitter.lblStat.setText(row+" tweet read");
              skripsisentimen.sentimenttwitter.txtAreaResult.setCaretPosition(skripsisentimen.sentimenttwitter.txtAreaResult.getText().length() - 1);

                }catch(Exception e){
                     skripsisentimen.sentimenttwitter.lblStat.setText(e.getMessage());
                }

          }
        }catch(Exception e){
            skripsisentimen.sentimenttwitter.lblStat.setText(e.getMessage());
           // System.out.println(e.getMessage());
        }
        Thread.sleep(100);
       return row;
    }
} 
```

但我实际上想应用上面 rlinden 制作的代码，但无法弄清楚如何调用 cleanTweet 函数。

# c# - C# sqldataadapter 数据表映射

> ID：10983984
> 
> 赞同：0
> 
> 时间：2012-06-11T16:25:06.767
> 
> 标签：c#, datatable, sqldataadapter, columnmappings

我有一个查询——“ `SELECT PK1 FROM users`”；

我还有一个名为`myTable`int 类型的三个字段的数据表；

```
-----------
| myTable |
-----------
| field1  |
| field2  |
| field3  |
----------- 
```

对于从我的查询返回的每一行，我想将 PK1 值放入 field2 中，`myTable`使 field1 和 field3 为空。

这是我到目前为止尝试过的一些示例代码，但它似乎不起作用。`myTable`而是将字段 PK1作为新字段附加到末尾。

```
class Program
    {
        static void Main(string[] args)
        {
            string SQL = "SELECT PK1 FROM users";
            SqlConnection connection = new SqlConnection([my connection string]);
            DataTable myTable = new DataTable();
            SqlDataAdapter adapter = new SqlDataAdapter();

            adapter.SelectCommand = new SqlCommand(SQL, connection);
            myTable.Columns.Add("field1", typeof(Int32));
            myTable.Columns.Add("field2", typeof(Int32));
            myTable.Columns.Add("field3", typeof(Int32));
            DataTableMapping dataMapping = adapter.TableMappings.Add("myTable", "users");
            dataMapping.ColumnMappings.Add("PK1", "field2");

            adapter.Fill(myTable);

            foreach (DataRow row in myTable.Rows)
            {
                Console.WriteLine("------------");
                foreach (DataColumn column in myTable.Columns)
                {
                    Console.WriteLine(column.ColumnName + " : " + row[column]);
                }
            }

            Console.ReadKey();
        }
    } 
```

我的代码中是否存在问题，或者是否有另一种方法可以映射字段？

出于此问题的目的，这是一个简化的示例，因为这样映射字段名称将是理想的，而不是在给定位置插入值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T16:38:11.290

它正在添加列，因为您要告诉它。您应该使用 datamappingColumn 功能或 table.column.add 功能而不是同时使用它们，它们是多余的，并且可能没有必要。

所以如果你离开 table.column.add()

这是一个示例，说明如何将列名“绑定”到您在表中设置的列，指定您希望它们出现的顺序，您可以通过 "" 双引号将它们留空或将它们设置为 null使用 NULL。

this.table.AutoSetDataBoundColumnHeaders = true; this.table.SetDataBinding(table, null, "PK1", null);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T16:45:34.400

我认为如果这是您的要求，那么这种方法没有任何问题。将您的查询更改为以下内容，并且您不需要映射。

```
string SQL = "SELECT PK1 as field2 FROM users"; 
```

# .net - 带有后台工作人员的进度条第 2 部分

> ID：10983987
> 
> 赞同：0
> 
> 时间：2012-06-11T16:25:14.127
> 
> 标签：.net, vb.net, vb.net-2010

我只是看不到我在这里做错了什么，因为我已经在我的后台工作人员中实现了一个进度条，它不再只运行一次（在某些情况下，我已经看到 foror 循环中的编码运行了 6 次）

我的编码：-

```
My progress bar max value is set to 10.

‘ BGWorker Do Work Event
            For i As Integer = 1 To 2
‘ Run code 1
Next

            For i As Integer = 2 To 3
‘ Run code 2
Next

            For i As Integer = 3 To 4
‘ Run code 3
Next

            For i As Integer = 4 To 5
‘ Run code 4
Next

            For i As Integer = 5 To 6
‘ Run code 5 
Next

            For i As Integer = 6 To 8
‘ Run code 6
Next

            For i As Integer = 8 To 9
‘ Run code 7
Next

‘ BGWorker Progress changed event
            Me.Progressbar1.Value = e.ProgressPercentage
            Me.label1.Text = String.Format("{0} % Completed", e.ProgressPercentage * 10) 
```

我真的很感激任何帮助，因为我只是不明白为什么我在循环中的编码不应该只运行一次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T16:32:24.303

调用 a`For - Loop 1 to 2`将运行两次。对于`3 to 4`,也`5 to 6`一样

您的原始代码只是：

```
For i As Integer = 1 To 2
  ‘ Run code 1
Next

For i As Integer = 3 To 4
  ‘ Run code 2
Next 
```

它做了同样的事情。

`For - Loops`但是，如果您所做的只是运行一次代码，听起来您根本不需要。如果您的后台工作人员有十个步骤，请尝试调用十个更新：

```
‘ Run code 1
BGWorker.ReportProgress(1)

‘ Run code 2
BGWorker.ReportProgress(2)

‘ Run code 3
BGWorker.ReportProgress(3)

‘ etc 
```

# mongodb - 在 mongoDB 中使用数组字段

> ID：10983992
> 
> 赞同：1
> 
> 时间：2012-06-11T16:25:27.677
> 
> 标签：mongodb, mongoid

我正在研究一个将在 mongo 文档中大量使用数组字段的方案，是否存在与保存相当大的其他文档数组等的方法有关的任何已知问题？

性能问题？

对mongo来说相当新并且来自SQL背景，这种方法对我来说似乎“不合适”，因为它与通过一组“主键”而不是持有“主键”对表中的所有记录进行分组的方法有点不同一次并将其余数据保存在数组中。

“主键”方法也是我在 mongo 中使用的另一种选择

什么是最好的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T06:06:11.227

我不知道特殊的性能问题。您需要记住的是，一个文档最多只有 16mb 左右。因此，如果您有数百或数千个子文档，并且有一些合理的长度，您可能会遇到文档限制的问题。根据您需要这些子文档和主文档的频率，您可以考虑将其拆分。否则，您的主文档将有很多过载（您的子文档），阻止其他“业务对象”保存在 RAM 中。所以这可能是一个重点。
此外，如果没有我实际使用 Arrays 的情况，最好只使用主键，如果可以在所有这些子文档上显示/查询这些子文档，而不需要它们的父级。我认为这在很大程度上取决于您是否经常需要这些子文档。

什么是最好的，是你的用例的问题，一般来说没有:)

# android - how to pass facebook object in intent?

> ID：10983995
> 
> 赞同：0
> 
> 时间：2012-06-11T16:25:50.437
> 
> 标签：android, facebook, android-intent

I would like to implement an android app requires facebook login in the beginning. As I declare the facebook object in main activity and want to invoke facebook.authorize in another activity, but I can't put the facebook object to intent, is there other way to achieve this?

Here is the flow: When the app is first opened, a main activity is opened. It will then check if the access token is set, if no, a new activity is started to let user login. In that activity there are some login option and a login button. If user press the login button, facebook api is called to do the login.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T16:53:07.490

You can use a similar method that is used in the official facebook/android examples.
Using the [SessionStore](https://github.com/facebook/facebook-android-sdk/blob/master/examples/simple/src/com/facebook/android/SessionStore.java) you can do something like:

First activity:

```
Facebook facebook = new Facebook("APP_ID");
if (!SessionStore.restore(facebook, this)) {
    // start the other activity for authentication
} 
```

Second activity:

```
Facebook facebook = new Facebook("APP_ID");
facebook.authorize(this, new DialogListener() {
    @Override
    public void onComplete(Bundle values) {
        SessionStore.restore(facebook, this)
    }
    ...
}); 
```

# spine.js - Spine.js：调用超级方法导致无限循环

> ID：10983998
> 
> 赞同：2
> 
> 时间：2012-06-11T16:25:58.040
> 
> 标签：spine.js

我正在使用纯 Javascript（无 Coffescript）的 Spine.js。
我正在使用[文档](http://spinejs.com/docs/classes)中描述的语法来调用父类方法。

```
具体来说：this.constructor.__super__.someFunction.apply(this, arguments) 

```

这对于调用它的直接父类的直接子类来说很好。但是加上一个孙子班，一切都乱套了。在孙子类的实例上调用该方法会导致无限循环。我有一个[jsFiddle](http://jsfiddle.net/dspears/6TES8/)，它通过实现此处显示的类层次结构来演示这一点：

```
MyObjClass（实现方法 sayHi()）
^
|
My2ndObjClass（方法 sayHi() 调用超类）
^
|
My3rdObjClass

```

当在 My3rdObjClass 的实例上调用 sayHi() 时，您会得到一个无限循环（Chrome 控制台报告最大堆栈错误）。

我的猜测是，当 sayHi() 在 My3rdObj 上运行时，它自然会运行父类实现（因此，My2ndObjClass 的 sayHi() 会执行）。My2ndObjClass 的 sayHi() 然后将**super**解析为 My2ndObjClass 而不是 MyObjClass （如我所料），因此对 super 的调用现在变成了递归调用，然后我们就走了…… StackOverflow ;)

那么，我做错了什么，还是这是 Spine 的限制？我怀疑有一些聪明的方法可以解决这个问题，但我没有通过谷歌或 RTFM 找到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T13:29:53.030

两件事：“这”不是你想象的那样。“this”的作用域不遵循传统的语言结构，所以你需要在你想要的闭包中引用特定的变量。在这种情况下，“my2ndObjClass”。

其次，由于您使用的是“包含”，因此您的方法是在实例上定义的，而不是在类上。在原型/对象的咖啡脚本/javascript 使用中，您要查找的东西是否在构造函数中，对象本身。所以不要看构造函数的**super**，直接看对象的。

所以，你的定义

```
 my2ndObjClass.include({
    sayHi: function() {
        this.constructor.__super__.sayHi.apply(this,arguments);
    }
  }); 
```

变成

```
my2ndObjClass.include({
    sayHi: function() {
        my2ndObjClass.__super__.sayHi.apply(this,arguments);
    }
  }); 
```

它有效。

恕我直言，这些都是使用咖啡脚本的原因，以避免所有这些脆弱和惯例

# r - 将结果摘要打印到 R 中的标准输出

> ID：10983999
> 
> 赞同：2
> 
> 时间：2012-06-11T16:26:06.373
> 
> 标签：r

我碰壁了，相信我错过了一些非常简单的东西。

我有一个列表，其中包含来自多个 wilcoxon 测试的结果（带有 Bonferroni 校正），并且希望使用 Dunnett 测试的输出生成一个外观相似的表格`multcomp`（即，没有显示行号并且间隔很好）。

![示例表](../Images/57ce195188df0198b41b2f140230bd65.png)

当我将其打印为数据框时，会显示行号，并且列中的文本值是右对齐的。

该列表由以下人员创建：

> ```
> for (i in 2:length(split.set)) {
>   wrs.mod <- suppressWarnings(wilcox.test(split.set[[1]]$VALUE, split.set[[i]]$VALUE))
>   stn.results[i - 1] <- as.character(unique(split.set[[i]]$TREATMENT))
>   stat.results[i - 1] <- as.numeric(wrs.mod$statistic)
>   p.results[i - 1] <- signif(wrs.mod$p.value, 3)
>   if (wrs.mod$p.value < 0.05/(length(split.set) - 1)) sig.results[i - 1] <- "*" else sig.results[i - 1] <- NA
> }
> wrs.results <- list(Treatment = stn.results, Statistic = stat.results, p = p.results, Significant = sig.results) 
> ```

如何将其格式化为一个看起来不错的打印表格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T16:30:42.323

与其将其格式化为 a `list`，不如将其格式化为 a`data.frame`并打印：

```
wrs.results <- data.frame(Treatment = stn.results, Statistic = stat.results, Pvalue = p.results, Significant = sig.results)
print(wrs.results) 
```

您可以通过多种方式自定义数据框的结构（以及外观）。您可能更喜欢治疗是行名称：

```
wrs.results <- data.frame(row.names = stn.results, Statistic = stat.results, Pvalue = p.results, Significant = sig.results) 
```

或自定义列名：

```
colnames(wrs.results) = c("Treatment", "Statistic", "P(>|t|)", "Significance") 
```