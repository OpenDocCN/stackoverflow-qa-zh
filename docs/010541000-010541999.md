# StackOverflow 问答 10541000-10541999

# php - libmysql (c-api) 比 php-mysqli 慢

> ID：10541003
> 
> 赞同：3
> 
> 时间：2012-05-10T19:37:31.867
> 
> 标签：php, c, performance, mysqli, libmysql

我正在调查为什么我的 C-test-program(libmysql) 的速度几乎是相同 php-test(cli) 程序的两倍：

我正在创建一个准备好的语句并插入 10 条记录。

php-cli-version(mysqlnd) 几乎是使用 libmysql 的 C 版本的两倍。我正在这样测试：time ./dbctest && time`php phptest.php`

## C版：

```
/*gcc dbctest.c  -o dbctest -lm -lmysqlclient -lz  -std=c99 */

#include <my_global.h>
#include <mysql.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
char my_str[16];
int my_str_length=0;
static void insert_records (MYSQL_STMT *stmt)
{
char            *stmt_str = "insert into bleach values (?)";
MYSQL_BIND      param[1];

//printf ("Inserting records...\n");
if (mysql_stmt_prepare (stmt, stmt_str, strlen (stmt_str)) != 0)
{
    fprintf(stderr,"\nCant prepare...");
    return;
}

memset ((void *) param, 0, sizeof (param)); /* zero the structures */

strcpy (my_str,"test");
my_str[5] = '\0';  
my_str_length = strlen (my_str);

param[0].buffer_type = MYSQL_TYPE_STRING;
param[0].buffer = (void *) my_str;
param[0].buffer_length = sizeof (my_str);
param[0].is_null = 0;

if (mysql_stmt_bind_param (stmt, param) != 0)
{
    fprintf(stderr,"\nCant bind..");
    return;
}

for (int i = 1; i < 10; i++)
{
    if (mysql_stmt_execute (stmt) != 0)
    {
        fprintf(stderr,"Error inserting row");
        return;
    }

}

}

int main (int argc, char *argv[])
{
MYSQL *conn;

conn = mysql_init(NULL);

if (conn == NULL) 
{
  printf("Error %u: %s\n", mysql_errno(conn), mysql_error(conn));
  exit(1);
}

if (mysql_real_connect(conn, "127.0.0.1", "root","password", "test_db", 0, NULL, 0) == NULL) 
{
    printf("Error %u: %s\n", mysql_errno(conn),     mysql_error(conn));
    exit(1);
}

MYSQL_STMT  *stmt;
stmt = mysql_stmt_init (conn); 
insert_records(stmt);
exit (0);
} 
```

## PHP版本：

```
<?php
$mysqli = new mysqli("127.0.0.1", "root", "password",     "test_db");

$name = "TEST-PHP";
$stmt = $mysqli->prepare("insert into bleach values (?)");
$stmt->bind_param('s', $name);
for($i=0;$i< 10;$i++)
{
$stmt->execute();
}
$mysqli->close();
?> 
```

# c# - 从 C# 拖放到 Outlook

> ID：10541004
> 
> 赞同：2
> 
> 时间：2012-05-10T19:37:34.773
> 
> 标签：c#, drag-and-drop, outlook

我有一个用 C# 编写的文档控制系统。从 Outlook拖放***到 C# 已经有一段时间了***。*现在很多文件都在 C# 应用程序中，用户自然希望能够从*我的文档控制系统向***另一个方向*** 拖放*到*Outlook。

 **由于文件存储在文件系统中（而不是作为 SQL 数据库中的 blob），我让它们打开文件夹视图并从那里拖放。但是，这允许绕过文档管理系统的版本控制。

***是否有我可以构建的拖放消息将通知 Outlook 我要删除的文件名和路径？***我怀疑这已经完成了，但是我的搜索被相反方向的响应数量所淹没。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T19:49:26.307

从这里：

[http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/f57ffd5d-0fe3-4f64-bfd6-428f58998603/](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/f57ffd5d-0fe3-4f64-bfd6-428f58998603/)

```
//put the file path is a string array
string[] files = new String[1];
files[0] = @"C:\out.txt";

//create a dataobject holding this array as a filedrop
DataObject data = new DataObject(DataFormats.FileDrop, files);

//also add the selection as textdata
data.SetData(DataFormats.StringFormat, files[0]);

//do the dragdrop
DoDragDrop(data, DragDropEffects.Copy); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-15T11:02:04.723

您必须遵循一系列步骤

1.  选择`Allow Drop`要成为的属性`true`

2.  添加事件侦听器 ( `DragEnter`& `DragDrop`)

3.  将此代码添加到您的 cs 文件中

    ```
    private void splitContainer1_Panel2_DragEnter(object sender, DragEventArgs e)
    {
        if (e.Data.GetDataPresent("FileDrop", false))
            e.Effect = DragDropEffects.Copy;
        else
            e.Effect = DragDropEffects.None;
    }

    private void splitContainer1_Panel2_DragDrop(object sender, DragEventArgs e)
    {
        string[] files = new String[1];
        files[0] = @"C:\out.txt";
        //create a dataobject holding this array as a filedrop
        DataObject data = new DataObject(DataFormats.FileDrop, files);
        //also add the selection as textdata
        data.SetData(DataFormats.StringFormat, files[0]);
        //do the dragdrop
        DoDragDrop(data, DragDropEffects.Copy);
        if (e.Data.GetDataPresent("FileDrop", false))
        {
            string[] paths = (string[])(e.Data.GetData("FileDrop", false));
            foreach (string path in paths)
            {
                 // in this line you can have the paths to add attachements to the email
                Console.WriteLine(path);
            }
        }
    } 
    ```**

# email - 如何自动设置自定义电子邮件设置

> ID：10541006
> 
> 赞同：0
> 
> 时间：2012-05-10T19:37:43.817
> 
> 标签：email, ssl, mail-server

我试图更改电子邮件客户端自动添加我的邮件服务器设置的方式。如何将我的邮件服务器的默认设置更改为我设置的自定义值？Thunderbird 和其他邮件客户端检索邮件服务器设置，无论是其 SSL、TLS、服务器名称等。当有人使用我的电子邮件服务器时，我将如何做到这一点，它会自动使用 SSL 并将传入的传出设置设置为我的偏好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T19:51:47.913

此页面描述了如何使 Thunderbird 使用自动设置：

*   [https://developer.mozilla.org/en/Thunderbird/Autoconfiguration](https://developer.mozilla.org/en/Thunderbird/Autoconfiguration)

# glassfish-3 - 在 Liferay 6.1 CE 中，我如何让用户组中的用户查看该用户组的网页？

> ID：10541013
> 
> 赞同：0
> 
> 时间：2012-05-10T19:38:24.737
> 
> 标签：glassfish-3, liferay-6

我有一个在 Glassfish 3.1.1 上运行的 Liferay 6.1 CE 安装。

我创建了一些用户组，以及一些附带的私人网站页面。例如：

用户组

1.  顾客

公共页面

*   没有页面

私人页面

1.  欢迎
2.  计费
3.  支付

我创建了一个登录后操作，它会拉出用户的用户组，然后从中构建一条路径。

我已将一些测试用户分配到“客户”用户组。但是当我与这些客户之一登录时，我收到以下错误屏幕

![拒绝用户访问](../Images/17124acb9de1ceaffce69ec5035cace0.png)

和以下日志消息

> INFO: 19:11:40,760 INFO [PortalImpl:4873] 当前 URL /en/group/56058 生成 >异常：不允许用户 29354 访问组 56059 的私人页面
> 
> INFO: 19:11:40,762 INFO [PortalImpl:4890] 不允许用户 29354 访问组 56059 的私有 > 页面

用户显然是用户组的成员

![显示“客户”用户组成员](../Images/3347a89210bed8855935a8579b3bd63a.png)

并且客户用户组的站点允许“站点成员”角色“查看”其页面

![用户组站点权限](../Images/4664ed632fcd07dd1c0020cea457acfe.png)...![用户组站点权限](../Images/f58bc6d18e89e8ef8b927bb46d044c6d.png)

有谁知道如何允许作为用户组成员的用户查看*该*用户组的私人页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T19:57:47.037

创建一个新的常规角色，例如`Customers`并将您的用户组作为成员添加到此角色。将您私人页面上的查看权限添加到此角色。

# c# - “隐藏”系统光标

> ID：10541014
> 
> 赞同：3
> 
> 时间：2012-05-10T19:38:30.857
> 
> 标签：c#, winapi, mouse

# 背景：

*   我正在尝试创建一个“鼠标隐藏”应用程序，在设定的时间后将用户的鼠标从屏幕上隐藏起来。
*   我已经尝试了很多事情，使用[SetCursor](http://www.pinvoke.net/default.aspx/user32.setcursor)只会从当前应用程序中隐藏鼠标，我的必须能够坐在托盘中（例如）并且仍然可以工作。
*   我想我已经找到了 SetSystemCursor 的解决方案，除了一个问题。

# 我的问题：

*   我需要能够捕获任何类型的鼠标光标，并替换完全相同类型的鼠标光标。
*   更换鼠标时，我需要提供我想用句柄引用的鼠标替换的鼠标类型的 id，但我使用的任何函数都没有为我提供复制的鼠标 id（或类型） .

# 我的问题：

*   以这种方式继续这样做是否足够，但首先将鼠标移动到 0,0，将其隐藏，然后在取消隐藏时将其移回原来的位置？（只需移动鼠标即可完成取消隐藏）
*   0,0 处的鼠标是否总是 OCR_NORMAL 鼠标？（标准箭头。）
*   如果没有，如何找到鼠标类型/ID 以使我能够用正确的手柄替换正确的鼠标？

# 资源：

```
[DllImport("user32.dll")]
public static extern IntPtr LoadCursorFromFile(string lpFileName);
[DllImport("user32.dll")]
public static extern bool SetSystemCursor(IntPtr hcur, uint id);
[DllImport("user32.dll")]
static extern bool GetCursorInfo(out CURSORINFO pci);

[StructLayout(LayoutKind.Sequential)]
public struct POINT
{
public Int32 x;
public Int32 y;
}

[StructLayout(LayoutKind.Sequential)]
struct CURSORINFO
{
public Int32 cbSize;        // Specifies the size, in bytes, of the structure. 
// The caller must set this to Marshal.SizeOf(typeof(CURSORINFO)).
public Int32 flags;         // Specifies the cursor state. This parameter can be one of the following values:
//    0             The cursor is hidden.
//    CURSOR_SHOWING    The cursor is showing.
public IntPtr hCursor;          // Handle to the cursor. 
public POINT ptScreenPos;       // A POINT structure that receives the screen coordinates of the cursor. 
}

private POINT cursorPosition;
private IntPtr cursorHandle;
private bool mouseVisible = false;
private const uint OCR_NORMAL = 32512;

//Get the current mouse, so we can replace it once we want to show the mouse again.
CURSORINFO pci;
pci.cbSize = Marshal.SizeOf(typeof(CURSORINFO));
GetCursorInfo(out pci);
cursorPosition = pci.ptScreenPos;
cursorHandle = CopyIcon(pci.hCursor);

//Overwrite the current normal cursor with a blank cursor to "hide" it.
IntPtr cursor = LoadCursorFromFile(@"./Resources/Cursors/blank.cur");
SetSystemCursor(cursor, OCR_NORMAL);
mouseVisible = false;

//PROCESSING...

//Show the mouse with the mouse handle we copied earlier.
bool retval = SetSystemCursor(cursorHandle, OCR_NORMAL);
mouseVisible = true; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T19:42:27.900

一个应用程序不能影响另一个应用程序光标。您必须编写某种鼠标驱动程序才能做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T15:14:41.123

我找到了一个很好的解决方法，可以暂时隐藏系统光标，而不涉及使用`setsystemcursor()`.

`SetSystemCursor()`很危险，因为如果应用程序崩溃或以其他方式引发错误，光标将永久更改，直到下次重新启动。

相反，我在整个桌面上实现了一个透明窗口，该窗口在需要时会隐藏光标。使用的方法是 Win32 中的 ShowCursor。

透明窗口可以是这样的：http: [//www.codeproject.com/Articles/12597/OSD-window-with-animation-effect-in-C](http://www.codeproject.com/Articles/12597/OSD-window-with-animation-effect-in-C)

```
[DllImport("user32.dll")]
static extern int ShowCursor(bool bShow);

ShowCursor(false); 
```

# dynamics-ax-2009 - AX 2012 中的 SSRS 报告错误

> ID：10541024
> 
> 赞同：2
> 
> 时间：2012-05-10T19:39:11.027
> 
> 标签：dynamics-ax-2009, axapta, dynamics-ax-2012

我正在尝试使用 AX 2012 在 Visual Studio 2010 中创建一个基本的 SSRS 报告。我想显示基本的 CustTable 数据。当我将数据集与查询 CustTableSRS（AOT 中的查询）链接时，出现错误。错误说，

> 对 SSPI 的调用失败，请参阅内部异常。

如果我在 AX 2009 中使用 Visual Studio 2008 执行相同的步骤，则不会发生这种情况。在谷歌搜索时，我发现这与“错误配置的 SPN”有关。SPN 是服务器主体名称，它是在 Kerboros 环境中为服务器实例指定的名称。但我无法正确设置。我正在使用在 Oracle VirtualBox 上运行的 AX2012 映像。

注意：对不起，由于我是新手，所以无法发布屏幕截图:)

Visual Studio 中的错误日志

```
Error   3   The "GenerateRdlTask" task failed unexpectedly.
Microsoft.Dynamics.AX.Framework.Services.Client.UserSessionServiceException: A call to SSPI failed, see inner exception. ---> System.ServiceModel.Security.SecurityNegotiationException: A call to SSPI failed, see inner exception. ---> System.Security.Authentication.AuthenticationException: A call to SSPI failed, see inner exception. ---> System.ComponentModel.Win32Exception: The target principal name is incorrect
   --- End of inner exception stack trace ---
   at System.Net.Security.NegoState.StartSendAuthResetSignal(LazyAsyncResult lazyResult, Byte[] message, Exception exception)
   at System.Net.Security.NegoState.StartSendBlob(Byte[] message, LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.CheckCompletionBeforeNextSend(Byte[] message, LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.ProcessReceivedBlob(Byte[] message, LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.StartReceiveBlob(LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.CheckCompletionBeforeNextReceive(LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.StartSendBlob(Byte[] message, LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.CheckCompletionBeforeNextSend(Byte[] message, LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.ProcessReceivedBlob(Byte[] message, LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.StartReceiveBlob(LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.CheckCompletionBeforeNextReceive(LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.StartSendBlob(Byte[] message, LazyAsyncResult lazyResult)
   at System.Net.Security.NegoState.ProcessAuthentication(LazyAsyncResult lazyResult)
   at System.Net.Security.NegotiateStream.AuthenticateAsClient(NetworkCredential credential, ChannelBinding binding, String targetName, ProtectionLevel requiredProtectionLevel, TokenImpersonationLevel allowedImpersonationLevel)
   at System.Net.Security.NegotiateStream.AuthenticateAsClient(NetworkCredential credential, String targetName, ProtectionLevel requiredProtectionLevel, TokenImpersonationLevel allowedImpersonationLevel)
   at System.ServiceModel.Channels.WindowsStreamSecurityUpgradeProvider.WindowsStreamSecurityUpgradeInitiator.OnInitiateUpgrade(Stream stream, SecurityMessageProperty& remoteSecurity)
   --- End of inner exception stack trace ---

Server stack trace: 
   at System.ServiceModel.Channels.WindowsStreamSecurityUpgradeProvider.WindowsStreamSecurityUpgradeInitiator.OnInitiateUpgrade(Stream stream, SecurityMessageProperty& remoteSecurity)
   at System.ServiceModel.Channels.StreamSecurityUpgradeInitiatorBase.InitiateUpgrade(Stream stream)
   at System.ServiceModel.Channels.ConnectionUpgradeHelper.InitiateUpgrade(StreamUpgradeInitiator upgradeInitiator, IConnection& connection, ClientFramingDecoder decoder, IDefaultCommunicationTimeouts defaultTimeouts, TimeoutHelper& timeoutHelper)
   at System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.SendPreamble(IConnection connection, ArraySegment`1 preamble, TimeoutHelper& timeoutHelper)
   at System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.DuplexConnectionPoolHelper.AcceptPooledConnection(IConnection connection, TimeoutHelper& timeoutHelper)
   at System.ServiceModel.Channels.ConnectionPoolHelper.EstablishConnection(TimeSpan timeout)
   at System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.OnOpen(TimeSpan timeout)
   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.OnOpen(TimeSpan timeout)
   at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.CallOpenOnce.System.ServiceModel.Channels.ServiceChannel.ICallOnce.Call(ServiceChannel channel, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannel.CallOnceManager.CallOnce(TimeSpan timeout, CallOnceManager cascade)
   at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
   at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
   at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)

Exception rethrown at [0]: 
   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
   at Microsoft.Dynamics.AX.Framework.Services.Client.UserSessionService.IUserSessionService.GetUserSessionInfo(UserSessionServiceGetUserSessionInfoRequest request)
   at Microsoft.Dynamics.AX.Framework.Services.Client.UserSessionClientInternal.<GetUserSessionInfo>b__0(IUserSessionService channel)
   at Microsoft.Dynamics.AX.Framework.Services.Client.ServiceClientHelper.InvokeChannelOperation[TResult,TChannel](IServiceClient`1 client, Func`2 operationInvoker, Func`2 exceptionWrapper)
   --- End of inner exception stack trace ---
   at Microsoft.Dynamics.AX.Framework.Services.Client.ServiceClientHelper.InvokeChannelOperation[TResult,TChannel](IServiceClient`1 client, Func`2 operationInvoker, Func`2 exceptionWrapper)
   at Microsoft.Dynamics.AX.Framework.Services.Client.UserSessionClientInternal.GetUserSessionInfo()
   at Microsoft.Dynamics.AX.Framework.Services.Client.UserSessionClient.GetUserSessionInfo()
   at Microsoft.Dynamics.AX.Framework.Reports.Shared.UserInformationProxy.GetUserSessionInfo()
   at Microsoft.Dynamics.AX.Framework.Reports.Shared.UserInformationProxy.GetUserLanguage()
   at Microsoft.Dynamics.AX.Framework.Reports.Shared.ReportParameterPromptStringResolver.Resolve(Stream input, String language)
   at Microsoft.Dynamics.Framework.Deployment.Reports.GenerateRdlTask.GetRDLForDesign(IReportDesignDefinition reportDesign, String[] assemblyReferences)
   at Microsoft.Dynamics.Framework.Deployment.Reports.GenerateRdlTask.Execute()
   at Microsoft.Build.BackEnd.TaskExecutionHost.Microsoft.Build.BackEnd.ITaskExecutionHost.Execute()
   at Microsoft.Build.BackEnd.TaskBuilder.ExecuteInstantiatedTask(ITaskExecutionHost taskExecutionHost, TaskLoggingContext taskLoggingContext, TaskHost taskHost, ItemBucket bucket, TaskExecutionMode howToExecuteTask, Boolean& taskResult)   C:\Program Files (x86)\MSBuild\Microsoft\DynamicsTools\Microsoft.Dynamics.Framework.Design.Reporting.Modeling.targets   103 6   ReporDemoModel1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-04T00:27:10.603

尝试与管理员相同的操作，以查看是否出现相同的错误。如果报告工作正常，这是首先要尝试的事情。

对于这种类型的开发，完全编译所有 CIL 并部署服务（和服务组，一个由 SRS 开始，另一个由 SAS 开始）至关重要。检查 VS 使用的配置客户端是否正确配置了服务通信。

# ruby-on-rails - 用户 has_many :courses，但课程不属于 :user

> ID：10541028
> 
> 赞同：1
> 
> 时间：2012-05-10T19:39:26.827
> 
> 标签：ruby-on-rails, database-design, activerecord

我一直在努力解决可能非常明显的事情：

当我尝试将课程分配给用户时，我认为不允许一门课程包含在多个用户的集合中。

我有一个方法可以遍历每个用户并将每门课程的一个小节分配给该用户。只有最后几个用户有课程分配给他们。我想这是因为两者的关系是作为字段存储在课程表中的，所以一门课程只能属于一个用户。我希望课程属于许多用户。

想一想，我假设这是因为我需要除了 has_many 之外的另一种关系？喜欢HABTM？

我想我对 AR 关联的工作方式感到困惑......

**用户.rb**

```
class User < ActiveRecord::Base
  has_many :courses
  has_many :bookmarks, :class_name => 'Course'

  attr_accessible :email, :password, :courses, :bookmarks

  validates_presence_of :password, :on => :create
  validates_presence_of :email, :on => :create
  validates :password, :length => { :in => 6..20 }
  validates_format_of :email, :with => /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i
  validates_uniqueness_of :email
end

# == Schema Information
#
# Table name: users
#
#  id              :integer         not null, primary key
#  email           :string(255)
#  password_digest :string(255)
#  course_id       :integer
#  bookmark_id     :integer
#  created_at      :datetime        not null
#  updated_at      :datetime        not null
# 
```

**课程.rb**

```
class Course < ActiveRecord::Base
  attr_accessible :name
end

# == Schema Information
#
# Table name: courses
#
#  id          :integer         not null, primary key
#  name        :string(255)
#  created_at  :datetime        not null
#  updated_at  :datetime        not null
#  user_id     :integer
# 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T19:46:01.050

您应该使用 HABTM，也可以`user_id`从课程和`course_id`用户中删除列。

```
class User < ActiveRecord::Base
  has_many :course_users
  has_many :course, :through => :course_users
end

class Course < ActiveRecord::Base
  has_many :course_users
  has_many :users, :through => :course_users
end

class CourseUser < ActiveRecord::Base
  belongs_to :user
  belongs_to :course
# == Schema Information
#
# Table name: course_users
#
#  id          :integer         not null, primary key
#  created_at  :datetime        not null
#  updated_at  :datetime        not null
#  user_id     :integer
#  course_id     :integer
#
end 
```

# javascript - 从 Chrome 扩展程序中获取框架的内容？

> ID：10541029
> 
> 赞同：1
> 
> 时间：2012-05-10T19:39:27.217
> 
> 标签：javascript, jquery, html, google-chrome-extension, frames

我正在编写一个 Chrome 扩展程序来更改对 document.all 的调用，以便它可以在 chrome 中使用。

但是，该页面包含一个使用 document.writeln 编写框架集的脚本。框架集由一帧“FrameMain”组成。

我在获取指向 FrameMain 中文档的变量时遇到了困难。

我认为问题是在 chrome 中 document_start 时没有创建 FrameMain，并且在 document_end 发生时没有加载它。

我目前正在使用 document_end 作为我的脚本的起点：

```
$('FrameMain').ready(function () {
    console.log("ready");
    console.log(parent.frames);
    console.log(parent.frames[0]);
}); 
```

看起来框架已加载时会打印就绪，它不会立即显示。
但是， parent.frames 返回一个 DOMWindow 并且 parent.frames[0] 是未定义的。
**如何获得对框架内容的引用？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:18:51.050

**解决了。**

```
$('FrameMain').ready(function () {
    console.log("ready");

    $($("frame[name = 'FrameMain']")[0].contentDocument).find("body").append("<h1>Hello frame</h1>");

}); 
```

使用**框架**选择器和**contentDocument**是关键。

:)

# vb.net - 使用VB计算报表中的行数

> ID：10541031
> 
> 赞同：3
> 
> 时间：2012-05-10T19:39:46.893
> 
> 标签：vb.net, activereports

我有一个包含位置列表的 VB 报告。我将此列表分成多个区域，我需要计算每个区域部分的总行数。我有一个包含我的区域字段的 groupHeader，然后在组中我列出了该区域的相应条目。然后在 groupFooter 我想给出组中的条目总数。我怎样才能做到这一点？我的 groupFooter 中有两个字段

1.  组数
2.  groupTotalAmount

- 这总结了我在每个条目中的值。任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T09:41:37.157

埃维恩，

您可以通过在设计器本身中设置一些属性来获取组中的总记录。最简单的例子是使用 NorthWind 数据库。您将报表绑定到“客户”表，并希望报表按国家/地区分组，其中每个组将包含该特定国家/地区的城市。

根据您的问题，我认为您已经知道如何在报告中获取组，因此我将仅讨论获取每个组的记录数。在 GroupFooter 中放置一个文本框。将其 datafield 属性设置为“Country”（与 groupheader 相同）。现在您需要为文本框设置以下属性：

*   摘要功能：- 计数
*   SummaryGroup：- GroupHeader1（或您在报告中的组头名称）
*   摘要运行：- 组
*   摘要类型：- 小计

您还可以使用以下代码以编程方式获得相同的结果。请注意，“TextBox1”是用于显示计数的文本框，位于 GroupFooter 部分：

```
Private count As Integer = 0

Public Sub GroupHeader1_Format()
    count = 0
End Sub

Public Sub Detail1_Format()
    count += 1
End Sub

Public Sub GroupFooter1_Format()
    TextBox1.Text = count.ToString()
End Sub 
```

我希望这能帮到您。您可能还想查看 ActiveReports[博客](http://blogs.gcpowertools.co.in/)，您可以在其中找到有关各个感兴趣领域的博客。

# android - ActionBar 列表导航重叠片段

> ID：10541034
> 
> 赞同：7
> 
> 时间：2012-05-10T19:40:17.923
> 
> 标签：android, android-fragments, android-actionbar

我正在尝试在列表导航模式下实现 Android 操作栏，当从列表中选择一个项目时，它成功更改片段，但片段重叠，当第二个是时，我可以在屏幕上看到前一个的内容选择。这是 Activity 的 OnCreate 和 OnNavigationItemSelected 的代码：

```
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);

    mFirstFragment = new FirstFragment();
    mSecondFragment = new SecondFragment();

    SpinnerAdapter mSpinnerAdapter = ArrayAdapter.createFromResource(
            this, 
            R.array.action_list, 
            android.R.layout.simple_spinner_dropdown_item);

    mActionBar = getActionBar();
    mActionBar.setDisplayShowTitleEnabled(false);
    mActionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
    mActionBar.setListNavigationCallbacks(mSpinnerAdapter, this);

    if(savedInstanceState != null) {
        mActionBar.setSelectedNavigationItem(
                savedInstanceState.getInt("currFragment"));
    }
}

public boolean onNavigationItemSelected(int position, long itemId) {
    FragmentTransaction mFragmentTransaction = 
            getFragmentManager().beginTransaction();

    switch(position) {
        case FIRST_FRAGMENT:
            mFragmentTransaction.replace(
                    android.R.id.content, 
                    mFirstFragment);
            break;
        case SECOND_FRAGMENT:
            mFragmentTransaction.replace(
                    android.R.id.content, 
                    mSecondFragment);
            break;
    }
    mFragmentTransaction.commit();

    return true;
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T22:36:28.110

我有同样的问题。[操作栏选项卡的FragmentTransaction .attach 和 .detach](https://stackoverflow.com/questions/8025449/fragmenttransaction-attach-and-detach-for-actionbar-tabs)中接受的答案对我有用。您还可以从[Android 操作栏选项卡中获得很好的指示，滚动视图在方向更改后制作了重复视图](https://stackoverflow.com/questions/8885594/android-action-bar-tab-with-scrollview-made-duplicate-view-after-orientation-cha)（尽管对我有用的关键见解来自我链接到的第一个问题）。

# excel - 我怎样才能找到这个值表的公式？

> ID：10541035
> 
> 赞同：-1
> 
> 时间：2012-05-10T19:40:22.223
> 
> 标签：excel, math

我怎样才能找到这个值表的公式？

我知道的事情：

此表水平方向为 45*1.25+(x*0.25)，其中 x 是从 0 开始的列号。

此表垂直方向为 45*1.25+(y*0.125)，其中 y 是从 0 开始的行号。

这些规则仅适用于我认为的第一行和第一列，这就是为什么我在弄清楚发生了什么时遇到问题的原因。

```
56.25   67.5    78.75   90
61.88   78.75   95.63   112.5
67.5    90      112.5   135 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T19:52:50.967

```
f(x,y) = 56.25 + 5.63 * ((x + 1) * y + 2 * x) 
```

而且，不是编程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T21:40:39.810

所以扔一个回归工具，我找到了一个模型

```
56.2513 + 11.2497*x + 5.625*y + 5.625*x*y 
```

参数标准偏差为

```
0.0017078 0.00091287 0.0013229 0.00070711 
```

残差的度量是 0.0018257，低于数据中的舍入误差。我要指出的是，它与 Amadan 给出的非常接近。

我可以得到一个稍微好一点的模型

```
56.2505 + 11.2497*x + 5.63*y + 5.625*x*y - 0.0025*y^2 
```

同样，参数标准误差是

```
0.0014434 0.00074536 0.0024833 0.00057735 0.001118 
```

残差为 0.0013944。改进是微乎其微的，您可以看到 y^2 的系数几乎不超过标准差的两倍。我很愿意相信这个参数不属于模型，而只是由舍入噪声产生的。

也许更能说明问题的是查看残差。Amadan 提出的模型产生以下残差：

```
56.25 + 5.63*Y + 11.26*X + 5.63*X.*Y - Z
ans =

        0         0.01         0.02         0.03
        0         0.02         0.03         0.05
     0.01         0.03         0.05         0.07 
```

相反，请考虑回归工具生成的模型。

```
56.2513 + 11.2497*X + 5.625*Y + 5.625*X.*Y - Z
ans =
       0.0013        0.001       0.0007       0.0004
      -0.0037        0.001      -0.0043       0.0004
       0.0013        0.001       0.0007       0.0004 
```

这里的残差更好，但我可以做得更好，只需查看系数并以合乎逻辑的方式扰动它们。这告诉我什么？Amadan 的模型不是最初生成数据的模型，尽管它很接近。

我更好的模型是这个：

```
56.25 + 11.25*X + 5.625*Y + 5.625*X.*Y
ans =
        56.25         67.5        78.75           90
       61.875        78.75       95.625        112.5
         67.5           90        112.5          135 
```

看到它是准确的，除了两个现在已经“不圆整”的单元格。它产生以下残差：

```
56.25 + 11.25*X + 5.625*Y + 5.625*X.*Y - Z
ans =
            0            0            0            0
       -0.005            0       -0.005            0
            0            0            0            0 
```

回归分析并不总能产生您需要的结果。有时铅笔和纸也一样好，甚至更好。但是，如果您查看数据，它可以让您有所了解。我的结论是原始模型是

```
f(x,y) = 56.25 + 11.25*x + 5.625*y + 5.625*x*y 
```

系数表现良好且简单，它们完美地预测了数据，除了两个单元格，它们肯定是四舍五入的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:23:00.253

给定一个假定的多项式，我认为您需要适合您的数据的最小二乘法。即使你给它更多的数据点，这种方法也会“起作用”。最小二乘法将计算使多项式与点之间的均方误差最小的多项式系数。

# jquery - 简单的jquery代码。我不知道我做错了什么

> ID：10541036
> 
> 赞同：3
> 
> 时间：2012-05-10T19:40:23.267
> 
> 标签：jquery, html, css, scripting

好的。首先让我说我刚开始学习 jQuery，我已经接受了各种挑战，所以我可以学得更快。今天，我有一个非常新手的问题，如果答案很明显，请道歉。我正在使用 JQuery 在单击相应列表时显示特定值。

我不知道我做错了什么。基本上，我创建了一个无序列表，我想要实现的是，如果单击每个链接，更改应该特定于每个列表项的跨度值（因此每个列表项将具有不同的跨度值）。但是下面的脚本不起作用。关于我做错了什么或我应该做什么的任何想法？： -

```
<ul class="stag">
    <li><a class="$200" href="#d1">Display</a></li>
    <li><a class="$300" href="#d2">Shirt</a></li>
    <li><a class="$400" href="#d3">Dress</a></li>
    <li class="amount"></li>
    **<span>$200</span>**
</ul> 
```

这是 jQuery 代码：-

```
 $(document).ready(function() {
      ("ul.stag li").click(function(){
        var activePd = $(this).find("a").attr("class");    //the clicked list
        $(".stag span").html(activePd.html());
            return false; 

       });
    }); 
```

任何人都可以帮忙吗？多谢你们 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T19:45:41.737

类名必须以从 a 到 Z 的字符开头。您以美元符号开头，因此您的类名无效。您必须找到其他存储`<a>`元素值的方法。这是您脚本的一个更好的版本，我使用`data`属性而不是`class`存储您的值：

**HTML：**

```
<ul class="stag">
    <li><a data-cost= "$200" href="#d1">Display</a></li>
    <li><a data-cost ="$300" href="#d2">Shirt</a></li>
    <li><a data-cost ="$400" href="#d3">Dress</a></li>
    <li class="amount"></li>
    <li><span>$200</span></li>
</ul>​ 
```

**Javascript：**

```
$(document).ready(function() {
    $("ul.stag li").click(function() {
        var activePd = $(this).find("a").data("cost"); //the clicked list
        $(".stag li span").html(activePd);
        return false;
    });
});​ 
```

同样重要的是你不能调用`.html()`一个字符串（这就是什么`activePd`），你甚至不需要，因为它已经是你想要的值。

此外，就像 Rocket 在下面的评论中指出的那样，您不能`<span>`在`<ul>`. 我暂时将其放入`<li>`并相应地更改了 jQuery 选择器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T19:54:51.843

这里有很多问题。

1.  在 a`<span>`中有 a`<ul>`但不在 an`<li>`中是无效的。
2.  类名不能以 开头`$`，也不能用于存储数据。尝试使用`data-*`属性。
3.  `activePd`是一个字符串，而不是一个 jQuery 对象，所以`.html()`不需要。
4.  你忘记了`$`以前`("ul.stag li").click`

您的 HTML 应如下所示：

```
<ul class="stag">
    <!-- The price is stored in a data attribute -->
    <!-- that's an HTML5 feature, but all browsers support it -->
    <li><a data-price="$200" href="#d1">Display</a></li>
    <li><a data-price="$300" href="#d2">Shirt</a></li>
    <li><a data-price="$400" href="#d3">Dress</a></li>
    <!-- The only valid children of ULs are LIs -->
    <li class="amount"><span>$200</span></li>
</ul>​ 
```

你的 jQuery 应该是这样的：

```
$(document).ready(function () {
     $("ul.stag li").click(function () {
         // jQuery can read data- attribures using .data
         var activePd = $(this).find("a").data("price");
         // The span has been moved to a new spot
         $(".stag .amount span").html(activePd);
         return false;
     });
 }); 
```

演示：http: [//jsfiddle.net/cUb9e/](http://jsfiddle.net/cUb9e/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T19:45:43.037

activePd 是一个字符串，所以你不要在它上面调用 .html() ：

```
$(".stag span").html(activePd); 
```

此外，您可以使其更简单：

```
$(document).ready(function() {
  $("ul.stag li a").click(function(){
    var activePd = $(this).attr("class");    //the clicked list
    $(".stag span").html(activePd);
    return false; 
   });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T19:46:40.550

首先，您在`$`jQuery 的第一行缺少 jquery。

你的：

```
$(document).ready(function() {
    ("ul.stag li").click(function(){ 
```

新的：

```
$(document).ready(function() {
    $("ul.stag li").click(function(){ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-10T19:48:25.387

您`$`的 jQuery 脚本中缺少 a ：

```
$(document).ready(function() {
here --> $("ul.stag li").click(function(){
             var activePd = $(this).find("a").attr("class");
             $(".stag span").html(activePd.html());
             return false; 
         });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-10T19:58:38.907

```
$(document).ready(function() {
  ("ul.stag li").click(function(){
    var activePd = $(this).find("a").attr("class");    //the clicked list
    $(".stag span").html(activePd.html());
        return false; 

   });
}); 
```

删除 activePd.html() 并添加

```
$(".stag span").html(activePd); 
```

如果使用 JQuery，则 activePd 并在单击事件中添加一个 $。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-10T19:53:11.763

检查 jquery 的变化

```
$(document).ready(function() {
      $("ul.stag li a").click(function(){
        var activePd = $(this).attr("class"); 
        var rel=$(this).attr("rel"); 
        $("span[id='stag-"+rel+"']").html(activePd);
            return false; 

       });
    }); 
```

请注意 HTML 已更改

```
<ul class="stag">
    <li><a class="$200" href="#d1" rel="1">Display</a></li>
    <li><a class="$300" href="#d2" rel="1">Shirt</a></li>
    <li><a class="$400" href="#d3" rel="1">Dress</a></li>
    <li class="amount"></li>
</ul>
<span id="stag-1">$200</span> 
```

您必须将跨度分开，每个都与某些特定的 id 相关联

对应的ul li的anchor的rel中会提到相同的id

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-10T20:02:16.843

这是一个工作示例，其中包含一些关于您的 HTML 和 JS 代码的固定问题：[Fiddle](http://jsfiddle.net/zuul/Au4TL/)

**HTML**

```
<ul class="stag">
    <li>
        <a class="$200" href="#d1" title="">Display</a>
    </li>
    <li>
        <a class="$300" href="#d2" title="">Shirt</a>
    </li>
    <li>
        <a class="$400" href="#d3" title="">Dress</a>
    </li>
    <li class="amount">
        <span>$200</span>
    </li>
</ul> 
```

**JS**

```
$(".stag a").bind("click", function(e) {
  // the clicked list
  var activePd = $(this).attr("class");
  $(".amount").html(activePd);
  e.preventDefault();
}); 
```

* * *

**你错过了什么：**

`<span>`不能是 UL 的直系子代，但我相信您希望它包含在 .amount LI 中。

`("ul.stag li")`缺少`$`.

`activePd.html()`应该是`activePd`，因为它是一个变量（字符串）而不是一个[Jquery Object](http://docs.jquery.com/Types#Object)。

您可能希望用户单击 a 标签但阻止链接被跟踪，因此您需要传递事件并阻止其在[click 函数上的](http://api.jquery.com/click/)[默认行为](http://api.jquery.com/event.preventDefault/)。

最后，您将点击事件分配给 LI，但正确的方法是将其直接分配给[html clickable element](http://www.w3schools.com/tags/tag_a.asp) `a`，从而节省一些代码行并使您的代码更准确。

阅读更多关于[Jquery](http://docs.jquery.com/Main_Page)和[HTML 标签](http://www.w3schools.com/tags/)的信息！祝你好运。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-05-10T19:49:09.550

这是一个可行的解决方案：http: [//jsfiddle.net/jn7P7/5/](http://jsfiddle.net/jn7P7/5/)

缺少的是`$`以前`("ul.stag > li")`

如前所述`activePd`是一个字符串，不需要做`.html()`

```
<ul class="stag">
    <li><a class="$200" href="#d1">Display</a></li>
    <li><a class="$300" href="#d2">Shirt</a></li>
    <li><a class="$400" href="#d3">Dress</a></li>
    <li class="amount"></li>
    <span>$200</span>
</ul>​ 
```

**JS**

```
$("ul.stag > li").click(function() {

    var activePd = $(this).find("a").attr("class"); //the clicked list
    console.log(activePd);
    $(".stag span").html(activePd);
    return false;

});​ 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-10T19:51:59.677

`$`不是 html 类名中的[有效字符](https://stackoverflow.com/questions/448981/what-characters-are-valid-in-css-class-names)，并且由于您似乎更多地将类属性用作数据容器，因此我建议您切换到该`data`属性。那将`<li><a data-price="$200" href="#d1">Display</a></li>`在您的标记和`$(this).data('price')`jQuery 中。

# php - 创建站点的用户可编辑区域 - 添加到用户集合

> ID：10541037
> 
> 赞同：0
> 
> 时间：2012-05-10T19:40:31.380
> 
> 标签：php, database, content-management-system

我正在尝试创建网站的一个部分，用户可以在其中登录并将产品添加到他们保存产品集合的集合区域。

一个简单的例子是：

登录用户 - 查找产品 - 单击添加到集合 - 保存集合以供他们重新登录时使用。

也可能有多个集合，例如“添加到：集合 1、集合 2 等”

如果有人可以提供帮助或只是为我指出正确的方向，那就太好了。

附加信息：我是一名优秀的前端开发人员，具有一些 php 知识。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:42:02.943

> 我正在尝试创建网站的一个部分，用户可以在其中登录并将产品添加到他们保存产品集合的集合区域。

好吧，现在我可以看到四个表：users、products、collections、collections_products（关联）。

> 一个简单的例子是：登录用户 - 查找产品 - 点击添加到收藏 - 收藏在他们重新登录时保存。

登录 - 验证用户和密码是否存在于表中并将用户数据存储在会话中。

第 1 页：提供一个表单，其中包含用户可以过滤以返回产品的字段

第 2 页：显示过滤器和产品，其中包含要添加到集合的链接。

当用户单击链接以添加到集合时，您可以提供一个带有集合列表的模式对话框，并且每个集合都有一个复选框。如果关联已存在，则列表可以选择已选中集合的复选框。

例子：

产品：我的产品

```
Add to collections
[ x ] collection one (already associated)
[   ] collection two
[   ] collection ...
[   ] collection ...

[ Save Associations ] 
```

**注意：在您的复选框中，您必须使用这样的名称，`collection[]`以便 php 将作为数组处理。**

要保存产品和集合的关联，您可以删除用户产品的所有关联并仅插入返回选中的关联。

好吧，我认为这是一个开始。

# asp.net - 如何确定用户是否在安全组中？

> ID：10541040
> 
> 赞同：0
> 
> 时间：2012-05-10T19:40:39.850
> 
> 标签：asp.net, active-directory

我正在使用下面的代码来获取用户组，但我不确定如何编写代码来说明如果用户在“TestGroup”中，如果不重定向页面，则执行某些操作？

```
 Dim resEnt As SearchResult
        Try
            For Each resEnt In mySearcher.FindAll()
                LabelUser.Text = resEnt.GetDirectoryEntry.Properties.Item("DisplayName").Value
                LabelLocation.Text = resEnt.GetDirectoryEntry.Properties.Item("SystemUserLocation").Value
                LabelState.Text = resEnt.GetDirectoryEntry.Properties.Item("st").Value
                LabelCountry.Text = resEnt.GetDirectoryEntry.Properties.Item("c").Value

                Dim result As SearchResult = mySearcher.FindOne()
                If (result Is Nothing) Then
                Else

                    Dim groupColl As Object
                    For Each groupColl In resEnt.Properties("memberof")
                        Dim GroupArray As Array = groupColl.split(",")
                        Select Case GroupArray(0).replace("CN=", "")
                            Case "TestGroup"
                                'Continue loading page
                            Case Else
                                'Prevent page from loading????

                        End Select

                    Next groupColl
                End If
            Next
        Catch f As Exception
            Console.WriteLine(f.ToString)
        End Try 
```

# php - 防止 facebook 会话劫持

> ID：10541042
> 
> 赞同：1
> 
> 时间：2012-05-10T19:40:50.913
> 
> 标签：php, facebook, security, session, session-hijacking

我正在构建一个金融服务 Web 应用程序，我的公司希望将 facebook 身份验证合并到其中。因为我们身处金融界，所以安全至关重要。我正在使用 facebook PHP SDK 进行集成，但我真的很担心会话劫持。在我的大学时代，我会从我周围的每个人那里劫持废话（这很有趣），但我正试图找到一种方法来防止我的应用程序出现这种情况。

我的公司希望尽可能简化身份验证过程，这意味着不希望使用两因素身份验证。但是在 facebook 登录后提示用户输入另一条信息似乎是最安全的方式。我想知道你们中是否有任何聪明的人可以想出其他方法来确保这一点，同时保持整个过程简单快捷？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T19:47:57.320

另一条信息仅在 P(attacker-has-extra-info | Attacker-hijacked-session) 较低时才有用。

如果您可以在他们第一次与您交互（或以安全敏感的方式进行交互）时使用复杂的第二个因素，然后记住他们连接的机器以在后续访问中跳过第二个因素，那么您通常可以获得简化的交互.

在第一次对设备进行身份验证时，要求他们在最后一条语句中的余额之类的东西可能是一个很好的第二个因素——这将证明他们已经知道可能与该帐户相关的特权。

或者，假设他们没有从该设备连接，向与该帐户关联的移动设备发送带有随机数的文本可以作为第二个因素。

# cassandra - 针对 cassandra 中的一个键的多个超级列的所有子列

> ID：10541044
> 
> 赞同：0
> 
> 时间：2012-05-10T19:40:53.647
> 
> 标签：cassandra, thrift, thrift-protocol

我们能否在一个请求中针对一个键读取多个超列的所有可用子列的列表。

例如

我们有一个带有超列 x1,x2,x3 的键“y1”

x1 有子列，名称类似于 c1,c2,c3
x2 有子列 c9 和 c8
x3 有 c1,c3,c10

我想针对一个键“y1”读取一个请求中的所有子列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T15:50:19.823

您将需要使用超级切片查询并指定一个范围。这是一个赫克托的例子：

```
SuperSliceQuery query = HFactory.createSuperSliceQuery(keyspace, ... serializers ...);
query.setColumnFamily(columnFamily)
     .setKey(key)
     .setRange("", "", false, Integer.MAX_VALUE); 
```

# java - 访问客户端服务器设置中的对象

> ID：10541049
> 
> 赞同：2
> 
> 时间：2012-05-10T19:41:07.027
> 
> 标签：java, c++, oop, concept

我想知道我的想法在面向对象编程中是否可行。假设我在某个 IP 地址（即 192.168.1.105）上有一个客户端（A），在 IP 地址 192.168.1.101 上有一个服务器（B）。是否可以访问客户端 (A) 中的对象并可能在服务器 (B) 的同一客户端上修改我选择的对象？. 是否有 c++ 或 java 或任何其他主要语言中的技术可以用来实现这一点?.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T19:45:34.717

实际上有几种技术可以让你做到这一点，但我猜你的意思是与语言无关的[CORBA](http://en.wikipedia.org/wiki/Common_Object_Request_Broker_Architecture)或 Java 的 RMI。还可以查看远程 EJB 调用等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T19:46:50.427

打开套接字后，您可以使用它们在客户端和服务器之间交换消息。此消息可能会被解释为执行您需要的操作。

例如：从客户端发送到服务器的具有已知内容的消息会导致服务器端的对象发生变化！

但是，这似乎很明显，也许您的意思是别的（远程方法调用）？

# javascript - 从jQuery中的字符串中提取某个查询的值

> ID：10541050
> 
> 赞同：0
> 
> 时间：2012-05-10T19:41:12.223
> 
> 标签：javascript

```
var test = "http://www.example.org/search?q=whatever&another=moretext"; 
```

如何在上面的查询字符串中提取`another`'s value ( `moretext`) 并从中创建一个变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T19:42:38.110

```
var test = "http://www.example.org/search?q=whatever&another=moretext";
var another = test.split('another='); 
```

another 是一个数组，其中 another[0] = 'http://www.example.org/search?q=whatever&' 和 another[1] = 'moretext'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T19:43:42.480

将此功能放在您的包中：

```
 function querySt(qsName, url)
        {
            var theUrl;
            if (url == null || url == undefined)
                theUrl = window.location.search.substring(1); else theUrl = url;
            var g = theUrl.split("&");
            for (var i = 0; i < g.length; i++) {
                var pair = g[i].split("=");
                if (pair[0].toLowerCase() == qsName.toLowerCase())
                {
                    return pair[1];
                }
            }
            return null;
        } 
```

`Usages`

```
alert(querySt("another")+'      '+querySt("q")); 
```

# dozer - 在使用推土机进行深度映射之前，我需要检查数据的有效性，可以吗？

> ID：10541051
> 
> 赞同：0
> 
> 时间：2012-05-10T19:41:13.320
> 
> 标签：dozer

我正在使用推土机在我的模型实体和我的 DTO 之间进行映射。现在我面临的问题是我需要将 classA.classC 的一些属性映射**到****classB**的不同属性，但首先我需要检查不一致，因为如果我不这样做 classC 将抛出异常并且映射将不起作用.

 **所以假设我有：

```
class ClassA {

   private String name;
   private ClassC c;

   public ClassC getC() throws ValidityException; 
}

class ClassB {

   private String code;
   private Integer value;

}

class ClassC {

   private String name;
   private Integer value;

   // Getters & Setters below
} 
```

所以现在我想像这样映射：

```
<mapping>
   <class-a>ClassA</class-a>
   <class-b>ClassB</class-b>
   <field>
      <a>c.name</a>
      <b>code</b>
   </field>
   <field>
      <a>c.value</a>
      <b>value</b>
   </field>
 </mapping> 
```

如果从 ClassA 实例访问 ClassC 实例引发异常，我将需要为两个 b 属性映射 null。从我正在阅读的内容来看，我假设我应该使用 CustomConverter 来访问 ClassC 实例，在这种情况下捕获异常并映射 null，但不确定如何实现这种转换器。

任何人都可以给我一些关于如何使用 Dozer 实现这一点的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T11:12:49.360

你确定你写了正确的映射吗？因为 ，

```
<field>
  <a>c.name</a>
  <b>name</b> 
```

在上面的代码片段中，您为 classB 编写了名称。其实应该是代码。**

# popup - ICS VpnService 弹出对话框

> ID：10541052
> 
> 赞同：1
> 
> 时间：2012-05-10T19:41:16.637
> 
> 标签：popup, vpn, android-4.0-ice-cream-sandwich

我正在尝试使用 VpnService 编写一个 VPN 应用程序。我基于示例 ToyVpn 启动了我的应用程序。它似乎工作正常，但我想知道当我单击连接时是否有办法摆脱弹出对话框。我希望我可以单击“连接”，它会启动而无需单击“我信任此应用程序...”复选框和“确定”。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T14:01:19.120

I don't think it's possible. They seem to be very careful about this class. If you take a look at the [documentation](http://developer.android.com/reference/android/net/VpnService.html) you can see it says:

Letting applications intercept packets raises huge security concerns. A VPN application can easily break the network. Besides, two of them may conflict with each other. The system takes several actions to address these issues. Here are some key points:

*   ***User action is required to create a VPN connection***. [emphasis mine]
*   There can be only one VPN connection running at the same time. The existing interface is deactivated when a new one is created.
*   A system-managed notification is shown during the lifetime of a VPN connection.
*   A system-managed dialog gives the information of the current VPN connection. It also provides a button to disconnect. The network is restored automatically when the file descriptor is closed. It also covers the cases when a VPN application is crashed or killed by the system.

Since it says that user action is required to create the VPN connection, I assume they mean this is something you cannot control yourself.

# wpf - WPF 中的异常

> ID：10541054
> 
> 赞同：0
> 
> 时间：2012-05-10T19:41:26.690
> 
> 标签：wpf, wpf-controls

我正在做一个音乐项目。您知道，如果您需要，我们必须有一个搜索栏来搜索 MediaElement 的位置。但是当滑块（搜索栏）运行时，IDE 抛出异常说：Exception:Thrown: Slider TargetType does not match type of element Control。我不认为这个问题是由代码引起的，我认为它是在我为搜索栏设计滑块时出现的。请帮助我！对不起我的英语不好。这是代码：

```
<Style x:Key="MyCustomStyleForSlider" TargetType="{x:Type Slider}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Slider}">
                <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto" MinHeight="{TemplateBinding MinHeight}"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <TickBar x:Name="TopTick" Visibility="Collapsed" Fill="{TemplateBinding Foreground}" Placement="Top" Height="4" Grid.Row="0"/>
                        <TickBar x:Name="BottomTick" Visibility="Collapsed" Fill="{TemplateBinding Foreground}" Placement="Bottom" Height="4" Grid.Row="0"/>
                        <Border x:Name="TrackBackground"  BorderThickness="1" CornerRadius="1" Margin="5,0" VerticalAlignment="Center" Height="4.0" Grid.Row="1" >
                            <Canvas Margin="-6,-1">
                                <Rectangle Visibility="Hidden" x:Name="PART_SelectionRange" Height="4.0" Fill="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" Stroke="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}" StrokeThickness="1.0"/>
                            </Canvas>
                        </Border>
                        <Track x:Name="PART_Track" Grid.Row="1">
                            <Track.DecreaseRepeatButton>
                                <RepeatButton Command="{x:Static Slider.DecreaseLarge}"/>
                            </Track.DecreaseRepeatButton>
                            <Track.IncreaseRepeatButton>
                                <RepeatButton Command="{x:Static Slider.IncreaseLarge}"/>
                            </Track.IncreaseRepeatButton>
                            <Track.Thumb>
                                <Thumb x:Name="Thumb" Background="Black"/>
                            </Track.Thumb>
                        </Track>
                    </Grid>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:37:36.233

检查您创建的任何样式或控件模板上的 TargetType 属性，并确保它适合您应用样式/控件模板的控件类型。

# c# - Json.NET 仅输出 C# 中的值

> ID：10541062
> 
> 赞同：2
> 
> 时间：2012-05-10T19:42:37.220
> 
> 标签：c#, json.net

**使用JsonConvert.SerializeObject**时如何仅获取值？我不需要重复的单词，如 id、name 等......

示例：**{ id: 189, name:'Paul', age:31, } x { [189, 'Paul', 31] }**

谢谢！

我需要与 PageList 类一起使用

```
public class PageList {
    IEnumerable _rows;
    int _total;
    int _page;
    int _records;
    object _userData;

    public PageList(IEnumerable rows, int page, int total, int records, object userData) {
        _rows = rows;
        _page = page;
        _total = total;
        _records = records;
        _userData = userData;
    }

    public PageList(IEnumerable rows, int page, int total, int records)
        : this(rows, page, total, records, null) {

    }

    public int total { get { return _total; } }

    public int page { get { return _page; } }

    public int records { get { return _records; } }

    public IEnumerable rows { get { return _rows; } }

    [JsonIgnore]
    public object userData { get { return _userData; } }

    public override string ToString() {
        return Newtonsoft.Json.JsonConvert.SerializeObject(this, new IsoDateTimeConverter() { DateTimeFormat = "dd-MM-yyyy hh:mm:ss" });
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T21:40:38.050

我能想到的最接近的事情是

```
var yourObjectList = List<YourObject>(){.....}

string s = JsonConvert.SerializeObject(GetObjectArray(yourObjectList));

public static IEnumerable<object> GetObjectArray<T>(IEnumerable<T> obj)
{
    return obj.Select(o => o.GetType().GetProperties().Select(p => p.GetValue(o, null)));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:36:02.023

第二个不是有效的 JSON ( `{ 189, 'Paul', 31 }`)。也许您想要一个数组而不是 ( `[ 189, 'Paul', 31 ]`)，在这种情况下，您可以不直接使用序列化程序，而是先将对象加载到 a`JObject`中，然后只取其值。

```
public class Foo
{
    public int id;
    public string name;
    public int age;
}

public class Test
{
    public static void Main()
    {
        Foo foo = new Foo { id = 189, name = "Paul", age = 31 };
        JObject jo = JObject.FromObject(foo);
        JArray ja = new JArray();
        foreach (var value in jo.Values())
        {
            ja.Add(value);
        }

        Console.WriteLine(ja);
    }
} 
```

或者如果你真的想要非 JSON 格式，你也可以使用`JObject`枚举并自己打印值。

# c++ - 在 C++ Builder 中更新 TDBGrid

> ID：10541065
> 
> 赞同：1
> 
> 时间：2012-05-10T19:42:46.853
> 
> 标签：c++, sql, c++builder

Embarcadero 关于许多数据库组件的文档不完整，并要求用户对其进行更新。结果，我无法弄清楚如何`DBGrid`使用新的 SQL 语句进行更新。

我一开始就可以调用我的 SQL 语句，但是当我更改 SQL 语句并调用相同的更新语句时，它仍然显示原始网格。

我正在使用一个`TDataSource`对象连接到 my`TADOQuery`以填充我的`DBTable`. 当我更新 my`TADOQuery`并让它重新运行查询，然后在 my 上调用更新函数时`DBGrid`，我看不出有什么区别。我需要做一些额外的事情`TDataSource`吗？

**编辑**：我复制了`TDataSource`，删除了原始文件，关闭并打开了 Builder，它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-21T10:34:11.617

复制了 TDataSource，删除了原始的，关闭并打开了 Builder，它工作正常。

# google-earth-plugin - 谷歌地球插件中的游戏偶尔会崩溃

> ID：10541067
> 
> 赞同：0
> 
> 时间：2012-05-10T19:42:50.513
> 
> 标签：google-earth-plugin

我创建了一个基于 Milktruck 演示的小型飞行模拟器。问题是插件每刷新一次就会崩溃。我不知道为什么会这样。它发生在所有浏览器上

你可以在这里看到游戏 [http://www.stepupforisrael.com/plane-game/0205/Mingame.htm](http://www.stepupforisrael.com/plane-game/0205/Mingame.htm)

欢迎任何线索....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T15:31:40.727

我明白了，问题是在几次刷新后你会得到错误 `ERR_BRIDGE_OTHER_SIDE_PROBLEM`，细节是`bad status`

我相信这是您如何加载插件本身的错误 - 我可以使用非常基本的设置来重现它。此外，这里似乎已经有一个错误报告。

[http://code.google.com/p/earth-api-samples/issues/detail?id=736](http://code.google.com/p/earth-api-samples/issues/detail?id=736)

表单阅读和测试，使用谷歌加载器加载插件似乎解决了这个问题。去做这个。

首先，从 body 元素中删除 onload 'init' 调用。

以便

`<body onload='init();' onunload="//GUnload()">`

变成

`<body onunload="GUnload()">`

然后使用 Google 加载器回调来处理初始化。为此，请将此行放在脚本块的末尾，就在结束元素之前。

`google.setOnLoadCallback(init);`

我的想法是 onload 事件在页面加载后立即发生。但是，有时发生此事件时插件尚未完成身份验证，因此会出现间歇性错误。您可以在此处阅读更多相关信息：[https ://groups.google.com/forum/?fromgroups#!topic/google-earth-browser-plugin/vvXKanCJbJU](https://groups.google.com/forum/?fromgroups#!topic/google-earth-browser-plugin/vvXKanCJbJU)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T07:41:00.923

我们对这个错误有自己的痛苦，我们使用了不同答案（GUnload 等）中描述的解决方案 - 没有成功。当我们将代码从我们使用的一些模糊托管移动到 Amazon EC2 时，问题就解决了。错误立即停止。是因为我们的原始主机和 Google 服务器之间的超时造成的吗？除了我们所做的拯救了我们之外，我们什么都不知道……

# javascript - 计算对象数组中的重复项

> ID：10541068
> 
> 赞同：10
> 
> 时间：2012-05-10T19:42:52.957
> 
> 标签：javascript, arrays, object, count, duplicates

我的服务器端 JS 中有如下对象数组：

```
[
    {
        "Company": "IBM"
    },
    {
        "Person": "ACORD LOMA"
    },
    {
        "Company": "IBM"
    },
    {
        "Company": "MSFT"
    },
    {
        "Place": "New York"
    }
] 
```

我需要遍历这个结构，检测任何重复项，然后在每个值旁边创建一个重复项的计数。

这两个值必须匹配才能被视为重复，例如“公司”：“IBM”与“公司”不匹配：“MSFT”。

如果需要，我可以选择更改入站对象数组。我希望输出成为一个对象，但我真的很难让它发挥作用。

编辑：这是我到目前为止的代码，其中 processArray 是上面列出的数组。

```
var returnObj = {};

    for(var x=0; x < processArray.length; x++){

        //Check if we already have the array item as a key in the return obj
        returnObj[processArray[x]] = returnObj[processArray[x]] || processArray[x].toString();

        // Setup the count field
        returnObj[processArray[x]].count = returnObj[processArray[x]].count || 1;

        // Increment the count
        returnObj[processArray[x]].count = returnObj[processArray[x]].count + 1;

    }
    console.log('====================' + JSON.stringify(returnObj)); 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-10T19:56:07.113

例如：

```
counter = {}

yourArray.forEach(function(obj) {
    var key = JSON.stringify(obj)
    counter[key] = (counter[key] || 0) + 1
}) 
```

文档：[Array.forEach](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/forEach)、[JSON.stringify](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T19:53:21.733

```
Object.prototype.equals = function(o){
    for(var key in o)
        if(o.hasOwnProperty(key) && this.hasOwnProperty(key))
            if(this[key] != o[key])
                return false;
    return true;
}
var array = [/*initial array*/],
    newArray = [],
    ok = true;
for(var i=0,l=array.length-1;i<l;i++)
    for(var j=i;j<l+1;j++)
    {
       if(!array[i].equals(array[j]))
           newArray.push(array[i]);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-12-17T18:04:23.840

我们需要编写一个 JavaScript 函数来接收一个这样的对象数组。该函数创建并返回一个新数组，其中没有重复对象（重复我们的意思是“Country”属性具有相同值的对象。）

此外，该函数应该为每个对象分配一个计数属性，表示它们在原始数组中出现的次数。

```
const arr = [
   {
      "Country": "BR",
      "New Lv1−Lv2": "#N/A"
   },
   {
      "Country": "BR",
      "New Lv1−Lv2": "#N/A"
   },
   {
      "Country": "",
      "New Lv1−Lv2": "test"
   }];
   const convert = (arr) => {
      const res = {};
      arr.forEach((obj) => {
         const key = `${obj.Country}${obj["New Lv1−Lv2"]}`;
         if (!res[key]) {
            res[key] = { ...obj, count: 0 };
         };
         res[key].count += 1;
      });
   return Object.values(res);
};
console.log(convert(arr)); 
```

[了解更多](https://pretagteam.com/question/count-duplicates-within-an-array-of-objects)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-11T16:07:42.597

使用 ES6，可以使用[`Array#reduce`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce)对象来存储计数。

```
let counts = arr.reduce((acc, curr)=>{
   const str = JSON.stringify(curr);
   acc[str] = (acc[str] || 0) + 1;
   return acc;
}, {}); 
```

[`Demo`](https://jsfiddle.net/rt6hv4bp/)

要创建没有重复的新数组，[`Set`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set)可以将 a 与[`Array#filter`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter).

```
let set = new Set;
let res = arr.filter(x => {
  const str = JSON.stringify(x);
  return !set.has(str) && set.add(str);
}); 
```

[`Demo`](https://jsfiddle.net/a26vexzm/)

# perl - 如何使用 Perl 访问这个凌乱的 HTML 表格中特定单元格的内容？

> ID：10541070
> 
> 赞同：0
> 
> 时间：2012-05-10T19:43:10.083
> 
> 标签：perl, html-parsing

我有以下凌乱的 HTML 表格，用于显示记录列表。

```
<table><tbody>                                                                                                                                                                                                                                                                       <tr id="RECORD_1">
    <td valign="top" class="summary_recnum"><input value="1" name="marked_list_candidates" type="checkbox">&nbsp;1\. <div id="ml_indicator_1"> 
    </div>
    <div id="enw_link_1"> 
    </div>
    </td><td class="summary_data"><div>
    <span class="label">Title: </span><a class="smallV110" href="/full_record.do?product=UA&amp;search_mode=GeneralSearch&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=1" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true">
    <value lang_id="">A Multitier System for the Verification, Visualization and Management of CHIMERA</value>
    </a>
    </div>
    <div>
    <span class="label">Author(s): </span>Lingerfelt E. J.; Messer O. E. B.; Osborne J. A.; et al.</div>
    <div>
    <span class="label">Editor(s): </span>Sato M; Matsuoka S; Sloot PMA; et al.</div>
    <div>
    <span class="label">Conference:
        </span> <span class="data_bold">
    <value>International Conference on Computational Science (ICCS) on the Ascent of Computational Excellence</value>
    </span>  <span class="label">Location: </span><span class="data_bold">Campus Nanyang Technolog Univ, Singapore, SINGAPORE</span>  <span class="label">Date: </span><span class="data_bold">2011</span>   
    <br>
    <span class="label">Sponsor(s): </span><span class="data_bold">Elsevier; Univ Tsukuba, Ctr Computat Sci</span>   
    </div>
    <span class="label">Source: </span>PROCEEDINGS OF THE INTERNATIONAL CONFERENCE ON COMPUTATIONAL SCIENCE (ICCS)&nbsp;&nbsp;<span class="label">Book Series: </span><span class="data_bold">Procedia Computer Science</span> &nbsp;&nbsp;<span class="label">Volume: </span><span class="data_bold">4</span> &nbsp;&nbsp;<span class="label">Pages: </span><span class="data_bold">2076-2085</span> &nbsp;&nbsp;<span class="label">DOI: </span><span class="data_bold">10.1016/j.procs.2011.04.227</span> &nbsp;&nbsp;<span class="label">Published: </span><span class="data_bold">2011</span> 
    <div>
    <span class="label">Times Cited: </span><span class="data_bold">0</span> (from All Databases) </div>
    <br>
    <div style="display: inline-block" id="links_1">
    <nobr><span id="links_openurl_1">                                               <a href="javascript:;" onclick="return open_location('OutboundService.do?action=go&amp;mode=fastOpenUrl&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;product=UA&amp;qid=2&amp;doc=1&amp;publisher_id=Oak_Ridge_National_Lab_UT_Battelle_LLC_open&amp;recordID=','openurl');" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"> <img src="http://sfx.ornl.gov/ornl/sfx.gif" border="0" alt="Context Sensitive Links" title="Context Sensitive Links"> </a>  </span><span id="links_full_text_1"> </span><span id="links_doc_del_1"> </span><span id="links_patent_1"> </span></nobr>
    </div>
    <span style="display: inline" class="ViewAbstract1_text" id="ViewAbstract1_text">
        [
        <a title="View the abstract" alt="View the abstract" onclick="return hide_show_abstract('1', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="View the abstract" alt="View the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/expand.gif" id="ViewAbstract1_img">View abstract</a>
        ]
        </span><span style="display: none" class="HideAbstract1_text" id="HideAbstract1_text">
        [
        <a title="Hide the abstract" alt="Hide the abstract" onclick="return hide_show_abstract('1', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="Hide the abstract" alt="Hide the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif" id="HideAbstract1_img">Hide abstract</a>
        ]
        </span><span style="display: none" url="http://apps.webofknowledge.com/ViewAbstract.do?product=UA&amp;search_mode=GeneralSearch&amp;viewType=ViewAbstract&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=1" id="ViewAbstract_Span1">
    <!----></span></td></tr><tr id="RECORD_2">
    <td valign="top" class="summary_recnum"><input value="2" name="marked_list_candidates" type="checkbox">&nbsp;2\. <div id="ml_indicator_2"> 
    </div>
    <div id="enw_link_2"> 
    </div>
    </td><td class="summary_data"><div>
    <span class="label">Title: </span><a class="smallV110" href="/full_record.do?product=UA&amp;search_mode=GeneralSearch&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=2" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true">
    <value lang_id="">Gravitational waves from core collapse supernovae</value>
    </a>
    </div>
    <div>
    <span class="label">Author(s): </span>Yakunin Konstantin N.; Marronetti Pedro; <span class="hitHilite">Mezzacappa Anthony</span>; et al.</div>
    <div>
    <span class="label">Conference:
        </span> <span class="data_bold">
    <value>14th Gravitational Wave Data Analysis Workshop (GWDAW-14)</value>
    </span>  <span class="label">Location: </span><span class="data_bold">Univ Rome, Rome, ITALY</span>  <span class="label">Date: </span><span class="data_bold">JAN 26-29, 2010</span>    
    </div>
    <span class="label">Source: </span>CLASSICAL AND QUANTUM GRAVITY&nbsp;&nbsp;<span class="label">Volume: </span><span class="data_bold">27</span> &nbsp;&nbsp;<span class="label">Issue: </span><span class="data_bold">19</span> &nbsp;&nbsp;<span class="label">Special Issue: </span><span class="data_bold">SI</span> &nbsp;&nbsp;&nbsp;&nbsp;<span class="label">Article Number: </span><span class="data_bold">194005</span> &nbsp;&nbsp;<span class="label">DOI: </span><span class="data_bold">10.1088/0264-9381/27/19/194005</span> &nbsp;&nbsp;<span class="label">Published: </span><span class="data_bold">OCT 7 2010</span> 
    <div>
    <span class="label">Times Cited: </span><a title="View all of the articles that cite this one" href="/CitingArticles.do?product=UA&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;search_mode=CitingArticles&amp;parentProduct=UA&amp;parentQid=2&amp;parentDoc=2&amp;REFID=337695000&amp;betterCount=7" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true">7</a> (from All Databases) </div>
    <br>
    <div style="display: inline-block" id="links_2">
    <nobr><span id="links_openurl_2">                                               <a href="javascript:;" onclick="return open_location('OutboundService.do?action=go&amp;mode=fastOpenUrl&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;product=UA&amp;qid=2&amp;doc=2&amp;publisher_id=Oak_Ridge_National_Lab_UT_Battelle_LLC_open&amp;recordID=','openurl');" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"> <img src="http://sfx.ornl.gov/ornl/sfx.gif" border="0" alt="Context Sensitive Links" title="Context Sensitive Links"> </a>  </span><span id="links_full_text_2"> </span><span id="links_doc_del_2"> </span><span id="links_patent_2"> </span></nobr>
    </div>
    <span style="display: inline" class="ViewAbstract2_text" id="ViewAbstract2_text">
        [
        <a title="View the abstract" alt="View the abstract" onclick="return hide_show_abstract('2', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="View the abstract" alt="View the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/expand.gif" id="ViewAbstract2_img">View abstract</a>
        ]
        </span><span style="display: none" class="HideAbstract2_text" id="HideAbstract2_text">
        [
        <a title="Hide the abstract" alt="Hide the abstract" onclick="return hide_show_abstract('2', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="Hide the abstract" alt="Hide the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif" id="HideAbstract2_img">Hide abstract</a>
        ]
        </span><span style="display: none" url="http://apps.webofknowledge.com/ViewAbstract.do?product=UA&amp;search_mode=GeneralSearch&amp;viewType=ViewAbstract&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=2" id="ViewAbstract_Span2">
    <!----></span></td></tr><tr id="RECORD_3">
    <td valign="top" class="summary_recnum"><input value="3" name="marked_list_candidates" type="checkbox">&nbsp;3\. <div id="ml_indicator_3"> 
    </div>
    <div id="enw_link_3"> 
    </div>
    </td><td class="summary_data"><div>
    <span class="label">Title: </span><a class="smallV110" href="/full_record.do?product=UA&amp;search_mode=GeneralSearch&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=3" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true">
    <value lang_id="">Protoneutron star evolution and the neutrino-driven wind in general relativistic neutrino radiation hydrodynamics simulations</value>
    </a>
    </div>
    <div>
    <span class="label">Author(s): </span>Fischer T.; Whitehouse S. C.; <span class="hitHilite">Mezzacappa A</span>.; et al.</div>
    <span class="label">Source: </span>ASTRONOMY &amp; ASTROPHYSICS&nbsp;&nbsp;<span class="label">Volume: </span><span class="data_bold">517</span> &nbsp;&nbsp;&nbsp;&nbsp;<span class="label">Article Number: </span><span class="data_bold">A80</span> &nbsp;&nbsp;<span class="label">DOI: </span><span class="data_bold">10.1051/0004-6361/200913106</span> &nbsp;&nbsp;<span class="label">Published: </span><span class="data_bold">JUL 2010</span> 
    <div>
    <span class="label">Times Cited: </span><a title="View all of the articles that cite this one" href="/CitingArticles.do?product=UA&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;search_mode=CitingArticles&amp;parentProduct=UA&amp;parentQid=2&amp;parentDoc=3&amp;REFID=336434672&amp;betterCount=40" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true">40</a> (from All Databases) </div>
    <br>
    <div style="display: inline-block" id="links_3">
    <nobr><span id="links_openurl_3">                                               <a href="javascript:;" onclick="return open_location('OutboundService.do?action=go&amp;mode=fastOpenUrl&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;product=UA&amp;qid=2&amp;doc=3&amp;publisher_id=Oak_Ridge_National_Lab_UT_Battelle_LLC_open&amp;recordID=','openurl');" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"> <img src="http://sfx.ornl.gov/ornl/sfx.gif" border="0" alt="Context Sensitive Links" title="Context Sensitive Links"> </a>  </span><span id="links_full_text_3"> </span><span id="links_doc_del_3"> </span><span id="links_patent_3"> </span></nobr>
    </div>
    <span style="display: inline" class="ViewAbstract3_text" id="ViewAbstract3_text">
        [
        <a title="View the abstract" alt="View the abstract" onclick="return hide_show_abstract('3', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="View the abstract" alt="View the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/expand.gif" id="ViewAbstract3_img">View abstract</a>
        ]
        </span><span style="display: none" class="HideAbstract3_text" id="HideAbstract3_text">
        [
        <a title="Hide the abstract" alt="Hide the abstract" onclick="return hide_show_abstract('3', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="Hide the abstract" alt="Hide the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif" id="HideAbstract3_img">Hide abstract</a>
        ]
        </span><span style="display: none" url="http://apps.webofknowledge.com/ViewAbstract.do?product=UA&amp;search_mode=GeneralSearch&amp;viewType=ViewAbstract&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=3" id="ViewAbstract_Span3">
    <!----></span></td></tr><tr id="RECORD_4">
    <td valign="top" class="summary_recnum"><input value="4" name="marked_list_candidates" type="checkbox">&nbsp;4\. <div id="ml_indicator_4"> 
    </div>
    <div id="enw_link_4"> 
    </div>
    </td><td class="summary_data"><div>
    <span class="label">Title: </span><a class="smallV110" href="/full_record.do?product=UA&amp;search_mode=GeneralSearch&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=4" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true">
    <value lang_id="">GENERATION OF MAGNETIC FIELDS BY THE STATIONARY ACCRETION SHOCK INSTABILITY</value>
    </a>
    </div>
    <div>
    <span class="label">Author(s): </span>Endeve Eirik; Cardall Christian Y.; Budiardja Reuben D.; et al.</div>
    <span class="label">Source: </span>ASTROPHYSICAL JOURNAL&nbsp;&nbsp;<span class="label">Volume: </span><span class="data_bold">713</span> &nbsp;&nbsp;<span class="label">Issue: </span><span class="data_bold">2</span> &nbsp;&nbsp;<span class="label">Pages: </span><span class="data_bold">1219-1243</span> &nbsp;&nbsp;<span class="label">DOI: </span><span class="data_bold">10.1088/0004-637X/713/2/1219</span> &nbsp;&nbsp;<span class="label">Published: </span><span class="data_bold">APR 20 2010</span> 
    <div>
    <span class="label">Times Cited: </span><a title="View all of the articles that cite this one" href="/CitingArticles.do?product=UA&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;search_mode=CitingArticles&amp;parentProduct=UA&amp;parentQid=2&amp;parentDoc=4&amp;REFID=292857312&amp;betterCount=6" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true">6</a> (from All Databases) </div>
    <br>
    <div style="display: inline-block" id="links_4">
    <nobr><span id="links_openurl_4">                                               <a href="javascript:;" onclick="return open_location('OutboundService.do?action=go&amp;mode=fastOpenUrl&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;product=UA&amp;qid=2&amp;doc=4&amp;publisher_id=Oak_Ridge_National_Lab_UT_Battelle_LLC_open&amp;recordID=','openurl');" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"> <img src="http://sfx.ornl.gov/ornl/sfx.gif" border="0" alt="Context Sensitive Links" title="Context Sensitive Links"> </a>  </span><span id="links_full_text_4"> </span><span id="links_doc_del_4"> </span><span id="links_patent_4"> </span></nobr>
    </div>
    <span style="display: inline" class="ViewAbstract4_text" id="ViewAbstract4_text">
        [
        <a title="View the abstract" alt="View the abstract" onclick="return hide_show_abstract('4', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="View the abstract" alt="View the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/expand.gif" id="ViewAbstract4_img">View abstract</a>
        ]
        </span><span style="display: none" class="HideAbstract4_text" id="HideAbstract4_text">
        [
        <a title="Hide the abstract" alt="Hide the abstract" onclick="return hide_show_abstract('4', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="Hide the abstract" alt="Hide the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif" id="HideAbstract4_img">Hide abstract</a>
        ]
        </span><span style="display: none" url="http://apps.webofknowledge.com/ViewAbstract.do?product=UA&amp;search_mode=GeneralSearch&amp;viewType=ViewAbstract&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=4" id="ViewAbstract_Span4">
    <!----></span></td></tr><tr id="RECORD_5">
    <td valign="top" class="summary_recnum"><input value="5" name="marked_list_candidates" type="checkbox">&nbsp;5\. <div id="ml_indicator_5"> 
    </div>
    <div id="enw_link_5"> 
    </div>
    </td><td class="summary_data"><div>
    <span class="label">Title: </span><a class="smallV110" href="/full_record.do?product=UA&amp;search_mode=GeneralSearch&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=5" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true">
    <value lang_id="">Understanding Core-Collapse Supernovae</value>
    </a>
    </div>
    <div>
    <span class="label">Author(s): </span>Hix W. R.; Lentz E. J.; Baird M.; et al.</div>
    <div>
    <span class="label">Conference:
        </span> <span class="data_bold">
    <value>10th International Conference on Nucleus-Nucleus Collisions (NN2009)</value>
    </span>  <span class="label">Location: </span><span class="data_bold">Beijing, PEOPLES R CHINA</span>  <span class="label">Date: </span><span class="data_bold">AUG 16-21, 2009</span>   
    <br>
    <span class="label">Sponsor(s): </span><span class="data_bold">China Inst Atom Energy</span>   
    </div>
    <span class="label">Source: </span>NUCLEAR PHYSICS A&nbsp;&nbsp;<span class="label">Volume: </span><span class="data_bold">834</span> &nbsp;&nbsp;<span class="label">Issue: </span><span class="data_bold">1-4</span> &nbsp;&nbsp;<span class="label">Pages: </span><span class="data_bold">602C-607C</span> &nbsp;&nbsp;<span class="label">DOI: </span><span class="data_bold">10.1016/j.nuclphysa.2010.01.104</span> &nbsp;&nbsp;<span class="label">Published: </span><span class="data_bold">MAR 1 2010</span> 
    <div>
    <span class="label">Times Cited: </span><span class="data_bold">0</span> (from All Databases) </div>
    <br>
    <div style="display: inline-block" id="links_5">
    <nobr><span id="links_openurl_5">                                               <a href="javascript:;" onclick="return open_location('OutboundService.do?action=go&amp;mode=fastOpenUrl&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;product=UA&amp;qid=2&amp;doc=5&amp;publisher_id=Oak_Ridge_National_Lab_UT_Battelle_LLC_open&amp;recordID=','openurl');" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"> <img src="http://sfx.ornl.gov/ornl/sfx.gif" border="0" alt="Context Sensitive Links" title="Context Sensitive Links"> </a>  </span><span id="links_full_text_5"> </span><span id="links_doc_del_5"> </span><span id="links_patent_5"> </span></nobr>
    </div>
    <span style="display: inline" class="ViewAbstract5_text" id="ViewAbstract5_text">
        [
        <a title="View the abstract" alt="View the abstract" onclick="return hide_show_abstract('5', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="View the abstract" alt="View the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/expand.gif" id="ViewAbstract5_img">View abstract</a>
        ]
        </span><span style="display: none" class="HideAbstract5_text" id="HideAbstract5_text">
        [
        <a title="Hide the abstract" alt="Hide the abstract" onclick="return hide_show_abstract('5', 'http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif', 'http://images.webofknowledge.com/WOKRS56B5/images/expand.gif', 'View the abstract', 'Hide the abstract');" href="javascript:;" oncontextmenu="javascript:return IsAllowedRightClick(this);" hasautosubmit="true"><img align="absmiddle" title="Hide the abstract" alt="Hide the abstract" src="http://images.webofknowledge.com/WOKRS56B5/images/collapse.gif" id="HideAbstract5_img">Hide abstract</a>
        ]
        </span><span style="display: none" url="http://apps.webofknowledge.com/ViewAbstract.do?product=UA&amp;search_mode=GeneralSearch&amp;viewType=ViewAbstract&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;doc=5" id="ViewAbstract_Span5">
    <!----></span></td></tr>
    <input type="hidden" name="all_summary_IDs" value=""><input type="hidden" name="viewAbstractUrl" value="http://apps.webofknowledge.com/ViewAbstract.do?product=UA&amp;search_mode=GeneralSearch&amp;viewType=ViewAbstract&amp;qid=2&amp;SID=2DI1PEg5Ja24IHi95Fc&amp;page=1&amp;"> <input type="hidden" name="LinksAreAllowedRightClick" value="full_record.do"> <input type="hidden" name="LinksAreAllowedRightClick" value="CitingArticles.do"> <input type="hidden" name="LinksAreAllowedRightClick" value="CitedPatent.do">
     </tbody></table> 
```

我对`td.summary_data`每一行的内容感兴趣，并尝试使用[HTML::TableExtract](http://search.cpan.org/perldoc/HTML%3a%3aTableExtract)解析表格：

```
my $te = HTML::TableExtract->new(headers => ["Title"]);
$te->parse($html_string);
# Examine all matching tables
my $count = 1;
foreach my $ts ($te->tables) {
    #print "\n";
    #print "Table (", join(',', $ts->coords), "):\n";
    foreach my $row ($ts->rows) {
        print "$count\n";
        for my $cell (@$row) {
           $cell =~ s/^\s+//;
           $cell =~ s/\s+\z/;/;
           $cell =~ s/\s+/ /g;
        }
        print join("|", @$row), "\n";
        print "\n";
        $count++;
    }
} 
```

结果：

```
1
Use of uninitialized value $cell in substitution (s///) at test2.pl line 20.
Use of uninitialized value $cell in substitution (s///) at test2.pl line 21.
Use of uninitialized value $cell in substitution (s///) at test2.pl line 22.
Use of uninitialized value $row in join or string at test2.pl line 24.

2
Title: Extreme Scaling of Production Visualization Software on Diverse Architectures Author(s): Childs Hank; Pugmire David; Ahern Sean; et al. Source: IEEE COMPUTER GRAPHICS AND APPLICATIONS??Volume: 30 ??Issue: 3 ??Pages: 22-31 ??Published: MAY-JUN 2010 Times Cited: 2 (from All Databases);

3
Title: Coupling visualization and data analysis for knowledge discovery from multi-dimensional scientific data Author(s): Ruebel Oliver; Ahern Sean; Bethel E. Wes; et al. Book Author(s): Sloot, PMA; Albada, GDV; Dongarra, J Book Group Author(s): ICCS Conference: International Conference on Computational Science (ICCS) Location: Univ Amsterdam, Amsterdam, NETHERLANDS Date: MAY 31-JUN 02, 2010 Sponsor(s): NWO, Netherlands Org Sci Res; KNAW, Royal Netherlands Acad Arts & Sci; Elsevier B V; Univ Amsterdam Source: ICCS 2010 - INTERNATIONAL CONFERENCE ON COMPUTATIONAL SCIENCE, PROCEEDINGS??Book Series: Procedia Computer Science ??Volume: 1 ??Issue: 1 ??Pages: 1751-1758 ??DOI: 10.1016/j.procs.2010.04.197 ??Published: 2010 Times Cited: 0 (from All Databases) [ View abstract ] [ Hide abstract ]; 
```

如何获取`td.summary_data`该表每一行的内容，以便提取我感兴趣的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:11:47.387

您的表格没有标题。这不是一张真正的桌子。该页面的作者使用表格进行布局。但是，您仍然可以提取所需的信息。只是当表格被布置为视觉格式而不是数据的表格显示时，细节[HTML::TableExtract](http://search.cpan.org/perldoc/HTML%3a%3aTableExtract)将不可用。

```
#!/usr/bin/env perl

use HTML::TokeParser::Simple;

my $parser = HTML::TokeParser::Simple->new(file => 'tt.html');

while (my $tag = $parser->get_tag('td')) {
    my $class = $tag->get_attr('class');
    next unless defined $class;
    next unless $class eq 'summary_data';

    my $text = $parser->get_text('/td');

    # do something with the contents of the table cell here
    process_record( \$text );
}

sub process_record {

} 
```

我取出了[标准序言](http://www.perl.com/pub/2012/04/perlunicook-standard-preamble.html)，因为我不确定您的输入编码是什么，但请确保您在创建`$parser`.

# php - IE 的条件 PHP 指向不同的站点？

> ID：10541076
> 
> 赞同：0
> 
> 时间：2012-05-10T19:43:43.080
> 
> 标签：php, internet-explorer, conditional

我对php很陌生，所以请耐心等待:)

我正在尝试创建一个可以使用`get_user_browser`php 中的函数的网页，然后将用户定向到单独的 HTML 页面。

我的网站是[http://www.danabohne.com](http://www.danabohne.com)，我刚刚意识到它在 IE 中几乎不可见。除非有不同的方法来解决这个问题，否则我想制作一个单独的静态 HTML 站点，IE 用户可以看到。

任何反馈都会非常有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:05:05.737

Firstly, it's important to note that browser detection on the server is not recommended, because it is possible for browsers to provide false user agent details, or none at all. (I know of some firewall products that routinely strip out this kind of data from the http headers).

Secondly, the `get_user_browser` function only works if you have a valid `browsecap.ini` file. If you're having trouble getting the function to work, check that you have this ini file and that it is up-to-date. (also note that you will need to keep it updated whenever new browsers or browser versions are released).

Finally, most (virtually all) IE-specific display issues can be resolved without having to create a separate page for IE.

Specifically in your case, I can see what the problem is straight away when looking at the HTML source code for your page:

The problem is the `<pre></pre>` that is in the first line of your code immediately before the `<!DOCTYPE>`. I assume this is the left-overs from some debugging code that hasn't been removed properly.

This `<pre></pre>` is going to cause IE to fall into "quirks mode", because IE sees the `<pre>` and assumes it doesn't have a doctype. Without a doctype, IE assumes the page should be in quirks mode.

Quirks mode makes IE's rendering engine display the page completely differently (it's basically an IE5-backward-compatibility mode), so it's no wonder your page looks rubbish in IE.

This behaviour is the same in all versions of IE.

If you have other IE-specific problems, it would be better to try to fix them on the page, as there are a lot of tools and hacks available to make IE work better.

Hope that helps.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T19:47:21.610

```
<?php
$useragent = $_SERVER['HTTP_USER_AGENT'];  
if( strpos($useragent,"MSIE 6.0") ) { 

  header("Location: http://google.com"); 

}
?> 
```

您可以根据需要添加更多`if`条件。

但是，就像评论中提到的约翰一样。我建议您创建一个单独的样式表并创建一个后备设计，而不是重定向到另一个页面。

# .net - 如何将 Wordpress 博客标题和日期拉入 .NET 主页

> ID：10541078
> 
> 赞同：0
> 
> 时间：2012-05-10T19:43:50.920
> 
> 标签：.net, wordpress

我正在尝试将最后三个 wordpress 博客文章的标题和日期拉入主页。请原谅我，因为我根本不精通 .net。

在我的 default.aspx 页面顶部我有这个命令：

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="DefaultNew.aspx.cs" Inherits="_DefaultNew" Debug="false" %>
<%@ Register Src="DefaultWordpress.aspx.cs" TagPrefix="Site" TagName="Wordpress" %>
<%@ Register Src="~/includes/siteHomeHeaderNew.ascx" TagPrefix="Site" TagName="Header" %>
<%@ Register Src="~/includes/siteFooter.ascx" TagPrefix="Site" TagName="Footer" %> 
```

我希望标题拉进来的地方有：

```
<Site:Wordpress runat="server" /> 
```

然后在我的 DefaultWordpress.aspx.cs 文件中我有这个：

```
using System;
using System.IO;
using System.Net;
using System.Text;
using System.Data;
using System.Configuration;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.Collections;
using System.Xml;

public partial class Wordpress : System.Web.UI.Page 
{
    using (var reader = XmlReader.Create("http://MY_SITE_GOES_HERE.com/blog/index.php?feed=atom"))
    {
        var feed = SyndicationFeed.Load(reader);
        // Print title and summary of 3 most recent posts
        foreach (var post in feed.Items.Take(3))
        {
            Console.WriteLine ("--- {0} ---", post.Title.Text);
            Console.WriteLine (post.Summary.Text);
            Console.WriteLine();
        }
    }
} 
```

有一个编译错误说：

```
Compilation Error
Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately. 

Compiler Error Message: CS1519: Invalid token 'using' in class, struct, or interface member declaration 
```

源错误：

```
Line 16: public partial class Wordpress : System.Web.UI.Page 
Line 17: {
Line 18:    using (var reader = XmlReader.Create("http://www.MY_SITE_HERE.com/blog/index.php?feed=atom"))
Line 19:    {
Line 20:        var feed = SyndicationFeed.Load(reader);

Source File: \\fs3-n02\stor9wc1dfw1\646363\647414\www.MY_SITE_HERE.com\web\content\DefaultWordpress.aspx.cs    Line: 18 
```

这显然行不通，但我不确定从这里去哪里。任何见解将不胜感激。有没有更简单的方法可以做到这一点，或者只是我缺少的东西？

谢谢你！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T21:07:25.213

您需要将`using`语句放入方法中，例如，`Page_Load`或您想要的任何其他方法。
除此之外，您不能`Console`在网页上使用。

将代码放入方法中可能如下所示：

```
protected void Page_Load(object sender, EventArgs e)
{
  using (var reader = XmlReader.Create("http://MY_SITE_GOES_HERE.com/blog/index.php?feed=atom"))
  {
    var feed = SyndicationFeed.Load(reader);
    // Print title and summary of 3 most recent posts
    foreach (var post in feed.Items.Take(3))
    {
        // ... Logic to render post information ...
    }
  }
} 
```

**更新**
您正在使用没有`SyndicationFeed`该类的 .NET 2.0。您可以尝试使用应该支持 .NET 2.0的[Atom.NET 。](http://atomnet.sourceforge.net/)

# javascript - 使用javascript在后台打印，即不弹出文档

> ID：10541079
> 
> 赞同：0
> 
> 时间：2012-05-10T19:43:51.627
> 
> 标签：javascript, printing, window

找到此代码以从 javascript 打印。但它会打开一个窗口，其中包含要打印的文档。有没有办法隐藏那个文件？

```
var element=document.getElementById(element_id);
var newWin=window.open('','Print-Window','width=400,height=400,top=100,left=100');

newWin.document.open();
/* newWin.document.title = "Readings on PageLinks"; */
newWin.document.write('<html><head><title>Readings on PageLinks</title></head><body   onload="window.print()">'+element.innerHTML+'</body></html>');
newWin.document.close();

setTimeout(function(){ newWin.close(); },10); 
```

该文档的打印是 onload() 完成的，所以我想没有它就无法打印。但是可以隐藏吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T19:55:36.740

您可以使用特定于打印的样式表来完成此操作，如[如何仅打印选定的 HTML 元素？](https://stackoverflow.com/questions/6500962/how-to-print-only-a-selected-html-element)根本不要使用`window.open()`；使用 CSS 类（如果需要，动态应用）来指定应该/不应该打印哪些元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T14:12:30.787

将此添加到您的标记中：

```
<iframe id="ifrOutput" style="display:none;"></iframe> 
```

添加以下javascript函数：

```
function printContainer(content, styleSheet) {
    var output = document.getElementById("ifrOutput").contentWindow;
    output.document.open();
    if (styleSheet !== undefined) {
        output.document.write('<link href="' + styleSheet + '" rel="stylesheet" type="text/css" />');
    }
    output.document.write(content);
    output.document.close();
    output.focus();
    output.print();
} 
```

并这样称呼它：

```
// with stylesheet
printHtml('<div>Styled markup</div>', 'printStyles.css');

// without stylesheet
printHtml('<div>Unstyled markup</div>'); 
```

# javascript - 确定 JavaScript 帖子大小

> ID：10541080
> 
> 赞同：0
> 
> 时间：2012-05-10T19:43:52.003
> 
> 标签：javascript, html, forms, post

[这个问题](https://stackoverflow.com/questions/8339241/how-do-i-determine-the-size-of-a-http-post-transaction-to-be-submitted)是别人问的，但没有给出合适的答案。让*我*通过解释我的特殊情况来帮助我，这样我就不会混淆我目前正在使用 AJAX（我***不是***为了这个问题，但有一天我可能会切换）......

我通过常规 HTML 提交表单，使用 POST 向 PHP 提交，在我的情况下，它有很多文本，有时足以超过 POST 限制。有没有办法通过 JavaScript 来计算 POST 在提交之前是否会太大？如果没有简单的方法来自动确定服务器的 POST 限制，我可以手动处理，但我需要计算要发送的字节并停止它（并发送回一条警告消息）它不会计算。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T19:46:52.797

`POST`只要它只是文本输入，就应该很容易确定请求的大小。如果你也有文件输入，它会有点困难，但对 HTML5 的东西是可行的。

只需将所有字段及其值相加即可。

通常`POST`表单数据如下所示：

`"key=value&key2=value"`

因此，为每个字段添加 1 个字节（对于`=`），总共添加 n-1 个字节（对于`&`）。

然后为 header 获得一个好的数字，100 字节左右？也许200。

# php - 即使 $_POST 应该未定义，测试 $_POST var 也会影响变量

> ID：10541081
> 
> 赞同：0
> 
> 时间：2012-05-10T19:43:57.947
> 
> 标签：php

多年来，我一直使用这种方法来测试 $_POST var 并同时为 $var 赋值。

今天我遇到了一个服务器，它的处理方式似乎有所不同。

我正在加载页面 [http://site.com/foo.php?var=bar](http://site.com/foo.php?var=bar) 没有发布表单...并且测试 $_POST var 似乎取消了我的初始分配

```
$var= $_GET['var'];

echo "var is $var\n";  // correctly echos $_GET['var'] 

if ($var= $_POST['foo']) {
    echo "POST foo seen\n";  // does not fire, condition not met
}

echo "var is $var\n";  // does not echo $_GET['var'] 
```

当我切换到

```
if (isset($_POST['foo'])) {
    $var = $_POST['foo'];
... 
```

我摆脱了令人不安的行为。

所以我的问题是这是否`if ($var= $_POST['foo']) {`是不好的形式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T19:47:14.763

您使用的是赋值运算符`=`i 而不是比较运算符`==`。另外，请注意 PHP`E_STRICT`在访问未定义的数组元素时会抛出警告。因此，最好的选择通常是：

$name = trim(isset($_POST['name']) ? $_POST['name'] : '');

或对于整数：

$age = intval(isset($_POST['age']) ? $_POST['age'] : '');

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T19:47:41.037

尝试

```
$var = isset ( $_GET ['var'] ) ? $_GET ['var'] : null;
$foo = isset ( $_GET ['foo'] ) ? $_GET ['foo'] : null;

echo "var is $var\n"; // correctly echos $_GET['var']

if ($var === $foo) {
    echo "POST foo seen\n"; // does not fire, condition not met
}

echo "var is $var\n"; // 
```

# python - 在没有 MYSQL 本地安装的情况下安装 MYSQLdb python 模块

> ID：10541085
> 
> 赞同：0
> 
> 时间：2012-05-10T19:44:26.313
> 
> 标签：python, mysql, windows

我正在尝试在 Windows 客户端上安装 MYSQLdb。目标是从 Windows 客户端运行一个 python 脚本，该脚本连接到 LINUX 客户端上的 MySQL 服务器。查看设置代码（并根据我尝试为 mysqldb 运行 setup.py 时遇到的错误，看来我必须在 Windows 框中拥有自己的 MySQL 版本。有没有办法（也许是另一个模块) 那会让我完成这个吗？我需要让多个机器上的人运行一个脚本，该脚本将与中央服务器上的 MySQL 数据库进行交互。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T19:59:26.660

您不需要整个 MySQL 数据库服务器，只需要 MySQL 客户端库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:36:54.490

你可以使用mysql客户端的纯python实现，比如

*   [`pymysql`](http://pypi.python.org/pypi?%3Aaction=search&term=pymysql) （可以通过调用用作 MySQLdb 的 dropin-replacement `pymysql.install_as_MySQLdb()`）
*   [`MySql-Connector`](http://pypi.python.org/pypi/MySQL-Connector)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:07:44.957

自从我为 Windows 编写 python db 代码以来已经有很长时间了......但我认为这样的东西应该仍然有效。

如果您仅在 Windows 机器上运行客户端，请安装[pywin32 包](http://sourceforge.net/projects/pywin32/)。这应该有一个 odbc 模块。

使用 Windows 控制/管理工具，为用户或系统创建一个 odbc 条目。在该条目中，您将为连接参数集指定一个唯一名称，然后选择驱动程序（在本例中为 MySQL），并填充连接参数（例如主机名等） 。有关odbc 模块的一些注释，请参阅[PyWin32 文档](http://timgolden.me.uk/pywin32-docs/contents.html)在 pywin32 中。

另外，请参阅这篇文章：[在 windows 上从 python 连接到 odbc 的常用方法](https://stackoverflow.com/questions/768312/common-ways-to-connect-to-odbc-from-python-on-windows/768330#768330)。

# iphone - 如何将 ViewController 更改为没有“.xib”的另一个？

> ID：10541086
> 
> 赞同：1
> 
> 时间：2012-05-10T19:44:29.683
> 
> 标签：iphone, objective-c, ios

我有一个使用 Three20 生成“.xib”的视图控制器

我想要一个 tableView 给我这个 ViewController 没有“.xib”，就像你做的那样？

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    if (!self.albumController) {
        self.albumController = (AlThumbsViewController *)self; //AlThumbsViewController no have xib  //Three20 is generated automatically with
    }

    [self.navigationController pushViewController:self.albumController animated:YES];
    [self.albumController release];
    self.albumController = nil;
} 
```

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T23:34:12.660

如图[所示](http://imageshack.us/photo/my-images/444/capturadepantalla201205tm.png/)？

```
error:
Undefined symbols for architecture i386:
   "_OBJC_CLASS_ $ _AlThumbsViewController", Referenced from:
       objc-class-ref in SocialesAlbumViewController.o
ld: symbol (s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use-v to see invocation) 
```

在这里看[图片](http://imageshack.us/photo/my-images/513/capturadepantalla201205vl.png/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:30:30.250

如果我对您的理解正确，您想从一个视图控制器转换到第二个视图控制器，该控制器在您创建第二个视图控制器时没有为其生成 NIB/XIB 文件？

如果是这样，您需要在 xcode 中创建一个新的 XIB。转到新文件、用户界面、视图。然后将新的 XIB 文件关联到视图控制器，方法是将 XIB 的接口构建器中的类名称更改为与视图控制器相同的名称。然后将 Interface Builder 中的 view outlet 设置为 XIB 的主视图。然后在没有 XIB 的视图控制器上执行 initWithNibName，并将刚刚创建的新 XIB 文件传递​​给它。

根据评论编辑：

步骤1：创建一个新文件，用户界面，视图。这将生成一个独立的 XIB 文件。

第 2 步：转到您的新 XIB。单击文件的所有者。单击右侧菜单上的 Identity Inspector 图标（中间的小图标）。对于“类”，将名称更改为要链接到的视图控制器的确切名称。

第 3 步：单击文件的所有者。单击右侧菜单上的 Connections Inspector 图标（最右侧的小图标）。在 Outlets 下，将“view”连接到 XIB 的主视图（只需从圆圈拖动到主窗口）。

第 4 步：像这样加载您的视图控制器：

```
MyViewController *view = [[MyViewController alloc] initWithNibName:@"MyView" bundle:nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T07:56:31.103

MyViewController *view = [[MyViewController alloc] initWithNibName:@"MyView" bundle:nil];

```
 [self.navigationController pushViewController:view animated:NO]; ---> you can use YES 
```

或 [self.view addsubview:view.view];

和相反的

```
[self.navigationController popViewControllerAnimated:NO]; 
```

[self.view romovefromsuperview];

# c# - 从 Windows 8 移植到 Windows Phone

> ID：10541090
> 
> 赞同：2
> 
> 时间：2012-05-10T19:44:49.890
> 
> 标签：c#, windows-phone-7, windows-8, windows-runtime, isolatedstorage

我正在尝试将应用程序从 Windows 8 移植到 Windows Phone 7，并且很难找出这些行的等价物

```
var localFolder = ApplicationData.Current.LocalFolder;
IReadOnlyList<StorageFile> fileList = await localFolder.GetFilesAsync(); 
```

它从中获取所有文件`localFolder`并将其保存在`fileList`

我可以在 Windows Phone 上使用

```
string[] fileList = appStorage.GetFileNames(); 
```

`appStorage`的实例在哪里`IsolatedStorageFile`。但是如果我使用上面的代码行，我不能对列表中的文件使用某些函数，比如如果我想获取文件的创建日期，我可以在 WinRT 中使用`file.DateCreated`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:52:23.547

如果 appStorage 是 IsolatedStorageFile 类型，则使用 GetCreationTime 方法[http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile.getcreationtime.aspx](http://bit.ly/JfZCoU)

# ios - 如何自动化在 iPhone 模拟器上执行的操作？

> ID：10541092
> 
> 赞同：0
> 
> 时间：2012-05-10T19:44:53.587
> 
> 标签：ios, functional-testing, ios-ui-automation, automated-tests

现在我正在使用 UIAutomation 类对应用程序进行自动化测试。但是我的应用程序具有某些功能，我相信这些功能不能仅使用 UIAutomation 进行测试。例如，如果将新联系人添加到通讯录中，则会在应用程序中显示一个弹出窗口。要测试此功能，需要将新联系人添加到地址簿中，应检查弹出窗口。但 UIAutomation 仅在目标应用程序中自动执行用户操作。谁能告诉我如何自动化这些类型的操作（最好使用脚本）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T18:40:28.933

我建议您使用 Sikuli 实现自动化。它的 mucvh 更容易录制和播放。你也可以任何类型的警报或弹出窗口

# php - php 性能 microtime 实际值

> ID：10541103
> 
> 赞同：2
> 
> 时间：2012-05-10T19:45:44.187
> 
> 标签：php, performance

> **可能重复：**
> [为什么这个微时间在 PHP 中显得很奇怪](https://stackoverflow.com/questions/1310045/why-is-this-microtime-showing-up-weird-in-php)

我使用此代码来检查脚本的性能。

```
$start_time = microtime(1);
// execution some code
$cpu_time = microtime(1) - $start_time; 
```

echo $cpu_time 的输出类似于 3.0994415283203E-6 如何在屏幕上将其显示为实际值，例如 0.000000003099？是 0 秒而且执行速度非常快，对吧？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T19:49:45.247

使用[`number_format`](http://php.net/number_format).

像：

```
number_format($microtime, 15); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T19:50:20.627

对 :) 尝试使用 number_format() 函数：

```
echo number_format($cpu_time, 12); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T19:51:54.200

采用`bcsub`

例子

```
echo  bcsub ( microtime ( 1 ), $start_time, 16 ); 
```

# javascript - 来自jquery的toggleClass（）不适用于有效选择

> ID：10541106
> 
> 赞同：0
> 
> 时间：2012-05-10T19:45:54.733
> 
> 标签：javascript, jquery, onmouseover

我的隐藏类不接受切换类：

```
function overFx (element, classN) {

    if (!element.hasClass('ligado')){

        if (!$.browser.webkit && !$.browser.opera){
            //TR

            element.toggleClass(classN);

        } else {
            //TD

            element.children("td:not(.media)").toggleClass(classN);
        }
    }
}
//EFEITOS PARA DESTACAR LINHAS:

//MOUSE OVER:

$("tr.destacar:not(.hide)").mouseover(function (){

    overFx($(this), "mouseoverTr");
}
);

$(".hide").mouseover(function (){

    overFx($(this), "mouseoverTrHide");
}
);

//MOUSE OUT:

$("tr.destacar:not(.hide)").mouseout(function (){

    overFx($(this), "mouseoverTr");
}
);

$(".hide").mouseover(function (){

    overFx($(this), "mouseoverTrHide");
}
); 
```

我稍后会发布 Jsfiddle。

par 运行良好，`$("tr.destacar:not(.hide)")`但 `$(".hide")`不是，它应该是！他们在那里，我 console.logged 它，`$(this)`返回正是我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:41:31.527

你的`$(".hide").mouseout(...)`方法有错别字，你有`.mouseover(...)`。

要重新迭代，你有`$(".hide").mouseover`两次，第二个应该是 a `.mouseout`。

演示：http: [//jsfiddle.net/ducYE/](http://jsfiddle.net/ducYE/)

# web-services - 如何在 Mule 中自定义 SOAP 错误消息？

> ID：10541107
> 
> 赞同：2
> 
> 时间：2012-05-10T19:45:55.497
> 
> 标签：web-services, soap, exception-handling, esb, mule

如何以这样一种方式发送故障代码和故障字符串，在我的流程引发异常后，我会在 SOAP 错误响应中（在 FaultCode 和 FaultString 字段中）获得所需的错误代码和消息。

我有一个在 Mule 中调用的 SOAP 服务。我正在使用自定义异常策略来捕获异常，然后为**代码**和**消息**字段设置 spring-bean 属性。正在设置弹簧属性，但我的 SOAP 响应仍然是通用 SOAP 错误。

另外，我读到只有 MessagingExceptions 可以在 mule 中处理。那么，如何在开发过程中重现消息传递异常来测试我的代码？

# javascript - 将输入值加载到滑块选项中

> ID：10541110
> 
> 赞同：2
> 
> 时间：2012-05-10T19:46:25.073
> 
> 标签：javascript, jquery

我需要滑块插件中的变量“值”是表单中输入的整数值：

```
$(function () {
  $("#calcSlider").slider({ 
    min: 0,
    max: 90,
    step: 5,
    value: /* ACCESS HERE!!!!!! */,
    slide: function (event, ui) {
      $("#calcSup").val(ui.value);
    }
  });
}); 
```

我需要`value:`成为`calcSup`or中的值`${form.calcSup}`，但那是一个字符串。我需要将其解析为 int：

```
<input type="text" 
       id="calcSup" 
       name="calcSup" 
       value="${form.calcSup}" 
       size="3" 
       readonly="readonly" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T19:53:37.303

如果您要将值解析为整数，请不要忘记包含基数，这样它就不会因 base-8 或其他内容而感到困惑。

```
$("#mySlider").slider({
  // Set initial value to that of <input type="text" id="bar" value="23" />
  value: parseInt( $("#bar").val(), 10 ),
  // Update <input type="text" id="foo" /> anytime we slide
  slide: function ( event, ui ) {
    $("#foo").val(ui.value);
  }
}); 
```

演示：http: [//jsbin.com/oceqab/edit#javascript,html](http://jsbin.com/oceqab/edit#javascript,html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T19:51:21.143

也许您正在寻找 parseInt 函数，可以在这里找到更多详细信息：

[http://www.w3schools.com/jsref/jsref_parseint.asp](http://www.w3schools.com/jsref/jsref_parseint.asp)

```
$(function () {
$("#calcSlider").slider({ min: 0,
                          max: 90,
                          step: 5,
                          value: parseInt($('input#calcSup').val()),
                          slide: function (event, ui) {
                              $("#calcSup").val(ui.value);
                          }
                       });
                    });

<input type="text" id="calcSup" name="calcSup" value="${form.calcSup}" size="3" readonly="readonly"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T19:52:21.140

这可能是您正在寻找的：

```
$(function () {
    $("#calcSlider").slider({ min: 0,
                          max: 90,
                          step: 5,
                          value: parseInt($("#calcSup").val()),
                          slide: function (event, ui) {
                              $("#calcSup").val(ui.value);
                          }
    });
}); 
```

# ios5 - UIPageCurl 两个视图控制器之间的 UIPageViewController 转换？

> ID：10541118
> 
> 赞同：1
> 
> 时间：2012-05-10T19:46:55.043
> 
> 标签：ios5, uinavigationcontroller, uipagecontrol, uipageviewcontroller

我想要类似于 UIPageViewController 过渡的过渡，有没有可能实现呢。

```
SecondViewController* bvc = [[SecondViewController alloc] init];

[UIView transitionWithView:self.view.window
                  duration:1.0f
                   options:UIViewAnimationOptionTransitionCurlUp
                animations:^{
                    [self.navigationController pushViewController:bvc animated:NO];
                }
                completion:NULL];

[self.navigationController pushViewController:bvc animated:YES]; 
```

好像现在我已经通过上面的代码实现了 pageCurl(up) 。但实际上想要像 pageTurn 这样的过渡。有什么办法可以做到这一点？

# c# - 如何有效地更新插入到 MongoDB 集合中的最新文档？

> ID：10541119
> 
> 赞同：0
> 
> 时间：2012-05-10T19:46:58.203
> 
> 标签：c#, mongodb, mongodb-.net-driver

如果我没记错的话，MongoDB 文档的 ObjectId 包含其创建的时间戳。仅更新集合中最新文档的最佳方法是什么？

假设我有一堆游戏文档，并且每隔一段时间就会创建一个新文档，并且每个分数都应该保存到最近的游戏，而不是以前的游戏。我想这样做是为了不将游戏对象存储在内存中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T19:49:12.373

我已经尝试了几件事，但我无法在一次操作中完成。但是，您不需要将整个游戏对象存储在内存中。您可以只要求最新的`_id`. 像这样的东西（shell 伪语法）。

```
var last_id = db.games.find({}, {_id: 1}).sort({_id: -1}).limit(1);
db.games.update({_id: last_id}, {$inc: {score: 1}}); 
```

### 更新：

好吧，我现在应该去睡觉了。当然，可以使用[findAndModify](http://www.mongodb.org/display/DOCS/findAndModify+Command)来完成。这是JS代码。

```
db.runCommand({findAndModify: 'games', 
               sort: {_id: -1}, 
               update: {$inc: {score: 1}}}) 
```

# c# - 超过一定长度时将文本换行到下一行？

> ID：10541124
> 
> 赞同：15
> 
> 时间：2012-05-10T19:47:17.917
> 
> 标签：c#, console-application

我需要在某个区域内编写不同的文本段落。例如，我在控制台上画了一个框，如下所示：

```
/----------------------\
|                      |
|                      |
|                      |
|                      |
\----------------------/ 
```

我将如何在其中写入文本，但如果它太长则将其换行到下一行？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-10T20:22:40.523

在行长之前的最后一个空格上拆分？

```
int myLimit = 10;
string sentence = "this is a long sentence that needs splitting to fit";
string[] words = sentence.Split(new char[] { ' ' });
IList<string> sentenceParts = new List<string>();
sentenceParts.Add(string.Empty);

int partCounter = 0;

foreach (string word in words)
{
    if ((sentenceParts[partCounter] + word).Length > myLimit)
    {
        partCounter++;
        sentenceParts.Add(string.Empty);
    }

    sentenceParts[partCounter] += word + " ";
}

foreach (string x in sentenceParts)
    Console.WriteLine(x); 
```

**更新**（在某些情况下，上面的解决方案丢失了最后一句话）：

```
int myLimit = 10;
string sentence = "this is a long sentence that needs splitting to fit";
string[] words = sentence.Split(' ');

StringBuilder newSentence = new StringBuilder();

string line = "";
foreach (string word in words)
{
    if ((line + word).Length > myLimit)
    {
        newSentence.AppendLine(line);
        line = "";
    }

    line += string.Format("{0} ", word);
}

if (line.Length > 0)
    newSentence.AppendLine(line);

Console.WriteLine(newSentence.ToString()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-21T20:41:59.803

我修改了 Jim H 的版本，使其支持一些特殊情况。例如句子不包含任何空白字符的情况；我还注意到，当一行的最后一个位置有空格时会出现问题；然后在最后添加空格，最后一个字符太多了。

这是我的版本，以防万一有人感兴趣：

```
public static List<string> WordWrap(string input, int maxCharacters)
{
    List<string> lines = new List<string>();

    if (!input.Contains(" "))
    {
        int start = 0;
        while (start < input.Length)
        {
            lines.Add(input.Substring(start, Math.Min(maxCharacters, input.Length - start)));
            start += maxCharacters;
        }
    }
    else
    {
        string[] words = input.Split(' ');

        string line = "";
        foreach (string word in words)
        {
            if ((line + word).Length > maxCharacters)
            {
                lines.Add(line.Trim());
                line = "";
            }

            line += string.Format("{0} ", word);
        }

        if (line.Length > 0)
        {
            lines.Add(line.Trim());
        }
    }

    return lines;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-26T11:53:09.587

我从[Jim H. 的解决方案](https://stackoverflow.com/questions/10541124/wrap-text-to-the-next-line-when-it-exceeds-a-certain-length#answer-10541549)开始，并以这种方法结束。唯一的问题是文本是否有任何超过限制的单词。但效果很好。

```
public static List<string> GetWordGroups(string text, int limit)
{
    var words = text.Split(new string[] { " ", "\r\n", "\n" }, StringSplitOptions.None);

    List<string> wordList = new List<string>();

    string line = "";
    foreach (string word in words)
    {
        if (!string.IsNullOrWhiteSpace(word))
        {
            var newLine = string.Join(" ", line, word).Trim();
            if (newLine.Length >= limit)
            {
                wordList.Add(line);
                line = word;
            }
            else
            {
                line = newLine;
            }
        }
    }

    if (line.Length > 0)
        wordList.Add(line);

    return wordList;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-30T17:46:01.180

我修改了曼弗雷德的版本。如果你在其中放入一个带有 '\n' 字符的字符串，它会奇怪地将文本换行，因为它会将它视为另一个字符。有了这个微小的变化，一切都会顺利进行。

```
public static List<string> WordWrap(string input, int maxCharacters)
    {
        List<string> lines = new List<string>();

        if (!input.Contains(" ") && !input.Contains("\n"))
        {
            int start = 0;
            while (start < input.Length)
            {
                lines.Add(input.Substring(start, Math.Min(maxCharacters, input.Length - start)));
                start += maxCharacters;
            }
        }
        else
        {
            string[] paragraphs = input.Split('\n');

            foreach (string paragraph in paragraphs)
            {
                string[] words = paragraph.Split(' ');

                string line = "";
                foreach (string word in words)
                {
                    if ((line + word).Length > maxCharacters)
                    {
                        lines.Add(line.Trim());
                        line = "";
                    }

                    line += string.Format("{0} ", word);
                }

                if (line.Length > 0)
                {
                    lines.Add(line.Trim());
                }
            }
        }
        return lines;
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-10-24T12:59:01.593

这是一个经过轻微测试并使用 LastIndexOf 来加快速度的方法（猜测）：

```
 private static string Wrap(string v, int size)
    {
        v = v.TrimStart();
        if (v.Length <= size) return v;
        var nextspace = v.LastIndexOf(' ', size);
        if (-1 == nextspace) nextspace = Math.Min(v.Length, size);
        return v.Substring(0, nextspace) + ((nextspace >= v.Length) ? 
        "" : "\n" + Wrap(v.Substring(nextspace), size));
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-02-26T10:18:19.323

这是一个更**完整**且经过测试的解决方案。

*   该`bool overflow`参数指定，除了按空格分割之外，是否对长词进行分块。
*   连续的空格以及`\r`,`\n`被忽略并折叠成一个空格。
*   边缘案例经过全面测试

* * *

```
public static string WrapText(string text, int width, bool overflow)
{
    StringBuilder result = new StringBuilder();

    int index = 0;
    int column = 0;

    while (index < text.Length)
    {
        int spaceIndex = text.IndexOfAny(new[] { ' ', '\t', '\r', '\n' }, index);

        if (spaceIndex == -1)
        {
            break;
        }
        else if (spaceIndex == index)
        {
            index++;
        }
        else
        {
            AddWord(text.Substring(index, spaceIndex - index));
            index = spaceIndex + 1;
        }
    }

    if (index < text.Length) AddWord(text.Substring(index));

    void AddWord(string word)
    {
        if (!overflow && word.Length > width)
        {
            int wordIndex = 0;
            while (wordIndex < word.Length)
            {
                string subWord = word.Substring(wordIndex, Math.Min(width, word.Length - wordIndex));
                AddWord(subWord);
                wordIndex += subWord.Length;
            }
        }
        else
        {
            if (column + word.Length >= width)
            {
                if (column > 0)
                {
                    result.AppendLine();
                    column = 0;
                }
            }
            else if (column > 0)
            {
                result.Append(" ");
                column++;
            }

            result.Append(word);
            column += word.Length;
        }
    }

    return result.ToString();
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-03-06T12:23:31.943

其他答案没有考虑不使用空格来分词的东亚语言。

一般来说，东亚语言中的句子可以被包裹在字符之间的任何位置，除了某些标点符号（即使忽略标点符号规则也不是什么大问题）。它比欧洲语言简单得多，但是当考虑混合不同的语言时，您必须通过检查 Unicode 表来检测每个字符的语言，然后通过空格算法仅对欧洲语言部分应用换行符。

参考： [https ://en.wikipedia.org/wiki/Line_wrap_and_word_wrap](https://en.wikipedia.org/wiki/Line_wrap_and_word_wrap) [https://en.wikipedia.org/wiki/Line_break_rules_in_East_Asian_languages](https://en.wikipedia.org/wiki/Line_breaking_rules_in_East_Asian_languages)

[https://en.wikibooks.org/wiki/Unicode/Character_reference/0000-0FFF](https://en.wikibooks.org/wiki/Unicode/Character_reference/0000-0FFF)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-03-25T07:10:37.297

此代码将包装段落文本。它将段落文本分成几行。如果遇到任何大于行长的单词，它也会将该单词分成多行。

```
private const int max_line_length = 25;

private string wrapLinesToFormattedText(string p_actual_string) {

    string formatted_string = "";
    int available_length = max_line_length;

    string[] word_arr = p_actual_string.Trim().Split(' ');

    foreach (string w in word_arr) {

        string word = w;
        if (word == "") {
            continue;
        }

        int word_length = word.Length;

        //if the word is even longer than the length that the line can have
        //the large word will get break down into lines following by the successive words 
        if (word_length >= max_line_length)
        {
            if (available_length > 0)
            {
                formatted_string += word.Substring(0, available_length) + "\n";
                word = word.Substring(available_length);
            }
            else
            {
                formatted_string += "\n";
            }
            word = word + " ";
            available_length = max_line_length;
            for (var count = 0;count<word.Length;count++) {
                char ch = word.ElementAt(count);

                if (available_length==0) {
                    formatted_string += "\n";
                    available_length = max_line_length;
                }

                formatted_string += ch;
                available_length--;
            }                    
            continue;
        }

        if ((word_length+1) <= available_length)
        {
            formatted_string += word+" ";
            available_length -= (word_length+1);
            continue;
        }
        else {
            available_length = max_line_length;
            formatted_string += "\n"+word+" " ;
            available_length -= (word_length + 1);
            continue;                    
        }

    }//end of foreach loop

    return formatted_string;
}
//end of function wrapLinesToFormattedText 
```

> `Blockquote`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-23T19:09:41.480

这是一小段优化的代码，用于根据用 Visual Basic9 编写的浮点句子长度限制换行文本。

```
 Dim stringString = "Great code! I wish I could found that when searching for Print Word Wrap VB.Net and other variations when searching on google. I’d never heard of MeasureString until you guys mentioned it. In my defense, I’m not a UI programmer either, so I don’t feel bad for not knowing"
    Dim newstring = ""
    Dim t As Integer = 1
    Dim f As Integer = 0
    Dim z As Integer = 0
    Dim p As Integer = stringString.Length
    Dim myArray As New ArrayList
    Dim endOfText As Boolean = False REM to exit loop after finding the last words
    Dim segmentLimit As Integer = 45

    For t = z To p Step segmentLimit REM you can adjust this variable to fit your needs
        newstring = String.Empty
        newstring += Strings.Mid(stringString, 1, 45)

        If Strings.Left(newstring, 1) = " " Then REM Chr(13) doesn't work, that's why I have put a physical space
            newstring = Strings.Right(newstring, newstring.Length - 1)
        End If

        If stringString.Length < 45 Then
            endOfText = True
            newstring = stringString

            myArray.Add(newstring) REM fills the last entry then exits
            myArray.TrimToSize()
            Exit For
        Else
            stringString = Strings.Right(stringString, stringString.Length - 45)
        End If

        z += 44 + f
        If Not Strings.Right(newstring, 1) = Chr(32) Then REM to detect space
            Do Until Strings.Right(newstring, z + 1) = " "
                If Strings.Right(newstring, z + f) = " " OrElse Strings.Left(stringString, 1) = " " Then
                    Exit Do
                End If

                newstring += Strings.Left(stringString, 1)
                stringString = Strings.Right(stringString, stringString.Length - 1) REM crops the original 
                p = stringString.Length REM string from left by 45 characters and additional characters

                t += f
                f += 1
            Loop

            myArray.Add(newstring) REM puts the resulting segments of text in an array
            myArray.TrimToSize()

            newstring = String.Empty REM empties the string to load the next 45 characters
        End If
        t = 1
        f = 1
    Next

    For Each item In myArray
        MsgBox(item)
        'txtSegmentedText.Text &= vbCrLf & item
    Next 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-08-31T11:44:01.913

我知道我有点晚了，但我设法通过使用递归来获得解决方案。我认为它是这里提出的最干净的解决方案之一。

递归函数：

```
public StringBuilder TextArea { get; set; } = new StringBuilder();

public void GenerateMultiLineTextArea(string value, int length)
{
    // first call - first length values -> append first length values, remove first length values from value, make second call
    // second call - second length values -> append second length values, remove first length values from value, make third call
    // third call - value length is less then length just append as it is

    if (value.Length <= length && value.Length != 0)
    {

        TextArea.Append($"|{value.PadRight(length)}" + "|");
    }
    else
    {
        TextArea.Append($"|{value.Substring(0, length).ToString()}".PadLeft(length) + "|\r\n");
        value = value.Substring(length, (value.Length) - (length));
        GenerateMultiLineTextArea(value, length);
    }
} 
```

用法：

```
string LongString = 
"This is a really long string that needs to break after it reaches a certain limit. " +
"This is a really long string that needs to break after it reaches a certain limit." + "This is a really long string that needs to break after it reaches a certain limit.";

GenerateMultiLineTextArea(LongString, 22);
Console.WriteLine("/----------------------\\");
Console.WriteLine(TextArea.ToString());
Console.WriteLine("\\----------------------/"); 
```

输出：

```
/----------------------\
|This is a really long |
|string that needs to b|
|reak after it reaches |
|a certain limit. This |
|is a really long strin|
|g that needs to break |
|after it reaches a cer|
|tain limit.This is a r|
|eally long string that|
| needs to break after |
|it reaches a certain l|
|imit.                 |
\----------------------/ 
```

# css - CSS导航菜单问题

> ID：10541125
> 
> 赞同：0
> 
> 时间：2012-05-10T19:47:19.507
> 
> 标签：css

我无法让 CSS 属性“margin-top”在所有浏览器（IE、FireFox、Chrome）中始终如一地工作。

```
.navmenu { list-style: none; padding: 0px; margin-top:16px; } 
```

这在 FireFox 和 Chrome 中运行良好，但在 Internet Explorer 中没有任何作用。

可以在这里看到一个例子：[http ://www.pogocheats.net/template.php](http://www.pogocheats.net/template.php)

导航 CSS 可以在以下位置找到：[http](http://www.pogocheats.net/styles/test.css) ://www.pogocheats.net/styles/test.css （从第 276 行开始）

有一个简单的解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T19:55:02.793

基于列表的菜单规则：

1)[使用 CSS 重置](http://developer.yahoo.com/yui/reset/)

2) 不要给 LI 设置样式，除了`position:` `float:`or`display:`

3）将所有样式放在A标签上并使用`display:block`

4）清除你的花车（如果使用它们）

查看我的列表教程：[preview.moveable.com/JM/ilovelists](http://preview.moveable.com/JM/ilovelists)

# c# - 从 C# 中的 URL 获取页面的类型

> ID：10541127
> 
> 赞同：3
> 
> 时间：2012-05-10T19:47:28.127
> 
> 标签：c#, .net, url-routing

给定一个 URL，我必须能够知道该 URL 处的页面类型是什么。例如，假设我有几页。

```
//first.aspx
public partial class FirstPage : System.Web.UI.Page { }

//second.aspx
public partial class SecondPage : MyCustomPageType { } 
```

我希望能够以以下方式调用方法，结果如下：

```
GetPageTypeByURL("first.aspx");     //"FirstPage"
GetPageTypeByURL("second.aspx");        //"SecondPage" 
```

这可能吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T19:51:20.690

从[这个答案](https://stackoverflow.com/a/1591506/707979)中，您似乎可以获得特定页面的类。然后，您可以使用反射来确定其基本类型。（注意：我没有尝试过，这只是一个建议。）

```
System.Web.Compilation.BuildManager.GetCompiledType(Me.Request.Url.AbsolutePath) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:24:45.527

那这个呢？

```
public Type GetPageTypeByURL(string url)
{
    object page = BuildManager.CreateInstanceFromVirtualPath(url, typeof(object));
    return page.GetType().BaseType.BaseType;
} 
```

**用法：**

```
Type pageType = GetPageTypeByURL("~/default.aspx"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T19:58:21.950

只是一个想法：我假设您从其他程序调用该页面。获取 HTML，搜索您的区别 HTML/隐藏元素，告诉您页面是什么。如果您在服务器上，只需将页面加载为文本文件并阅读即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-04T18:56:34.773

```
Page page = (Page)System.Web.Compilation.BuildManager.CreateInstanceFromVirtualPath(url, typeof(Page));
CustomerPage page = (CustomerPage) SomeMagicalPageCreater.CreatePage("CustomerPage.aspx"); 
```

[https://forums.asp.net/t/1315395.aspx](https://forums.asp.net/t/1315395.aspx) 这是我发现的。

# selenium - Selenium grid2：如何在远程关闭和打开浏览器

> ID：10541128
> 
> 赞同：1
> 
> 时间：2012-05-10T19:47:34.887
> 
> 标签：selenium, webdriver, selenium-grid

我有一个测试，我需要登录，关闭浏览器并再次打开它，然后检查页面上的内容。

使用远程集线器设置运行 webdriver 时如何执行此操作？还是我必须在没有遥控器的情况下运行它？

测试是这样的：

1.  打开浏览器
2.  登录
3.  关闭浏览器
4.  再次打开浏览器
5.  检查登录是否被记住

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T23:07:37.960

实现这一点的过程将与非网格环境中的解决方案非常相似。请注意，以下代码是为 Java 编写的，但我无法想象 C# 会有很大不同。

```
WebDriver driver = new RemoteWebDriver("hubURL", desiredCapabilities);
driver.manage().deleteAllCookies();
driver.get("http://path/to/page");
//login to application
driver.quit(); //This will close the browser on the remote machine

//Now to try it again

driver = new RemoteWebDriver("hubURL", desiredCapabilities);
driver.get("http://path/to/page");
Assert.assertTrue(some element that is not on the login page but is on the page after is present);
driver.quit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-13T14:48:12.020

大概你正在测试一些 cookie 的东西。不幸的是，不能保证任何特定节点都会执行任何请求，除非您正确限制它。您需要让一个节点通告客户端随后请求的唯一功能，以确保集线器每次都会路由到该节点。但是，很自然，如果该节点出现故障，您将没有任何其他节点可以为请求提供服务。

# mysql - 在嵌套集模型中仅获取节点的直接子节点

> ID：10541136
> 
> 赞同：2
> 
> 时间：2012-05-10T19:48:30.483
> 
> 标签：mysql, tree, nested-sets

我读了这个[http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/) 并在嵌套集模型中我想从父节点检索“便携式电子产品”只有直接子“mp3 播放器”“cd 播放器”“ 2 路收音机”。我能怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T19:54:57.987

您在标题**Find the Immediate Subordinates of a Node**下链接的文档中对此进行了描述。如您所见，它非常复杂。当我使用嵌套集时，我总是添加一个`parent`字段，因为这使得获取节点的直接子节点变得更加容易。

# button - dojox 移动按钮在 v1.7.x 中点击速度要慢得多

> ID：10541137
> 
> 赞同：0
> 
> 时间：2012-05-10T19:49:06.587
> 
> 标签：button, mobile, dojo, performance

只是我还是 dojox 移动按钮单击在 dojo 1.7.x 中要慢得多？我似乎没有注意到其他小部件变慢了。在使用 phonegap 1.7.0 将我的 phonegap/dojo 升级到最新的 dojo 1.7.2（使用 amd 加载程序和自定义构建）之后。只有移动按钮小部件似乎真的很慢！？！？

现在屏幕上有很多按钮（~12 个按钮和 4 个文本框小部件），由于某种原因，在我按下按钮到写入文本框的操作实际发生之间似乎存在延迟，点击时的“动画”也延迟了。我确实尝试在这些按钮上设置 data-dojo-props="duration:150"，但我仍然觉得在使用 dojo 1.6 时运行速度更快的同一个 html 屏幕的响应存在巨大滞后。

任何想法或建议将不胜感激。

盖伊

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T15:50:43.607

尝试将“mblIosWorkaround:false”设置为您的 djConfig/data-dojo-config，这会禁用一些棘手的代码以避免 iOS webkit 上的闪烁问题。

在 1.8 中，将有关于触摸响应的另一项改进，请参阅此票： [http](http://trac.dojotoolkit.org/ticket/14604) ://trac.dojotoolkit.org/ticket/14604 希望对您有所帮助。

# plone - 用 grok 和 Plone 命名的适配器？

> ID：10541139
> 
> 赞同：3
> 
> 时间：2012-05-10T19:49:08.953
> 
> 标签：plone, zope, grok

是否可以使用 Five.grok 注册命名适配器。

ZCML 等价物是：

```
 <adapter name="description" factory=".indexers.mytype_description" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T20:50:36.963

grok 等价物是

```
from five import grok
grok.global_adapter(mytype_description, name='description') 
```

# c# - 如何在视图中检索嵌套类的属性值？

> ID：10541140
> 
> 赞同：1
> 
> 时间：2012-05-10T19:49:09.187
> 
> 标签：c#, razor

我忙于我的 homecontroller.cs（在 MVC Razor 项目中），在那里我向我的视图发送了一个如下所示的类：

```
 private class Evt 
    {   
        public SEvent Event { get; set; }
        public String Duration { get; set; }
    };

    public ActionResult Index()
    {
        List<SEvent> modFromWcf = proxy.GetAllEventsByPeriod(@System.DateTime.Now.Year, @System.DateTime.Now.Year + 1, "EN").ToList();
        List<Evt> modTosend = new List<Evt>();

        foreach (SEvent item in modFromWcf)
        {
            Evt ES = new Evt();
            ES.Event = item;
            ES.Duration = GetDuration(item.StartDate ,item.EndDate);   
            modTosend.Add(ES);
        };

        return View("Index", modTosend);
    } 
```

SEvent 只是另一个类。

在我看来，我尝试对某些属性做一些事情，但我不知道如何检索该类 Event 的值。这是我的代码：

```
@{ 
    foreach (var item in ViewData.Model) {
    string year = item.Event.StartDate.Year.ToString();
    }
    ....
} 
```

我收到的错误是：“对象”不包含“事件”的定义。但我可以调试并看到该项目确实由一个类事件和一个字符串持续时间组成。我也可以看到内容。有人知道我如何检索例如 item.Event.StartData 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T21:30:09.453

你需要投到`item`你的班级。

`ViewData`is 的 type `ViewDataDictionary`，它实现`IDictionary<string, Object>`，表明它是一个字典，将 type 的键匹配到 type`string`的值`object`。

使用它使您的代码按原样运行：

```
@{ 
    foreach (var item in ViewData.Model) {
    string year = ((Evt)item).Event.StartDate.Year.ToString();
    }
    ....
} 
```

但是，您可能应该为此使用强类型视图，而不是为此塞入数据`ViewData`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T21:32:18.677

您需要明确定义项目。
`ViewData.Model`将返回一个对象集合，并且对象没有 Event 属性。

像这样的东西应该工作：

```
@{ 
    foreach (var item in ViewData.Model) {
        if (item is Evt){
            Evt itemEvt = (Evt)item;
            string year = itemEvt.Event.StartDate.Year.ToString();
        }
    }
    //...
} 
```

虽然我通常会做类似的事情：

```
@{ 
    foreach (Evt item in ViewData.Model) {
        string year = item.Event.StartDate.Year.ToString();
    }
    //....
} 
```

# c++ - 在虚拟继承的情况下类的大小

> ID：10541149
> 
> 赞同：5
> 
> 时间：2012-05-10T19:49:37.757
> 
> 标签：c++, polymorphism, virtual

在涉及虚拟功能的虚拟继承的情况下，有人可以解释一下类的大小。

```
 class A{
          char k[ 3 ];
          public:
          virtual void a(){};
          };

   class B : public  A{
          char j[ 3 ];
          public:
          virtual  void b(){};
          };

   class C : public virtual A{
          char i[ 3 ];
          public:
          virtual void c(){};
          };

   class D : public B, public C{
          char h[ 3 ];
          public:
          virtual void d(){};
          }; 
```

类大小的输出是：

```
 sizeof(A): 8
    sizeof(B): 12
    sizeof(C): 16
    sizeof(D): 32 
```

我正在使用的编译器是 `gcc version 4.6.1 (Ubuntu/Linaro 4.6.1-9ubuntu3)`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T20:31:06.523

> 大小（A）：8

数组中 3 个字节，1 个字节填充，4 个字节用于 vptr（指向 vtable 的指针）

> 大小（B）：12

一个子对象：8 个，3 个字节用于额外数组，1 个字节填充

> 大小（C）：16

这可能会让您感到惊讶... 一个子对象：8 个，3 个字节用于额外数组，1 个字节填充，**4 个字节指向 A**

每当您有虚拟继承时，虚拟基子对象相对于完整类型开始的位置是未知的，因此将一个额外的指针添加到原始对象以跟踪虚拟基的位置。考虑这个例子：

```
struct A {};
struct B : virtual A {};
struct C : virtual A {};
struct D : B, C {}; 
```

当完整类型为 a 时`A`，相对于对象开始的位置可以不同于当它是最终对象的一部分时的子对象的位置。如果这不明显，则假设相对位置相同，并检查相对于最终对象或子对象中的相对位置是否也可以保持。`B``B``A``B``D``A``C``C``C``D`

至于最后一个示例，我不太想分析它……但是您可以阅读[Itanium C++ ABI](http://sourcery.mentor.com/public/cxx-abi/abi.html)以了解 C++ 对象模型的具体实现。所有其他实现没有太大区别。

* * *

最后一个例子：

> 大小（D）：32

D 包含一个 B 子对象 (12) 和一个 C 子对象 (16)，加上一个大小为 3 的附加数组和一个额外的填充位 1。

在这种特殊情况下，可能会出现的问题是，如果虚拟继承自，为什么会有两个`A`子对象，答案是虚拟基础意味着对象愿意与层次结构中也愿意的任何其他类型共享此基础分享它。但是在这种情况下不愿意共享它的子对象，所以需要它自己的。`C``A``B``A``C`

您应该能够通过将日志添加到不同级别的构造函数来跟踪这一点。如果`A`让它在编译器中取一个值并从每个扩展类传递不同的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:10:36.433

`sizeof(C)`不仅仅是`sizeof(B)`因为 C 类型的对象（因为它实际上是从 A 继承的）将包含一个指针（除了 B 类型的对象也将包含的 vptr 之外）指向它从 A 继承的自身部分。Scott Meyers在他的书[更有效的 C++](http://my.safaribooksonline.com/book/programming/cplusplus/9780321545190/efficiency/ch04lev1sec9)的第 24 项中详细解释了这一点（大约 10 页）：“了解虚函数、多重继承、虚拟基类和 RTTI 的成本”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:23:52.810

要知道数据结构的实际大小，您可以说编译器不要使用#pragma pack(1) 在内存中对齐它。要保存当前打包设置并在以后恢复它们，您还可以使用#pragma pack(push) 和#pragma pack(pop)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-10T20:15:44.967

这是我对所有字节的使用位置的最佳猜测：

```
 Avptr Bvptr CVptr DVptr k j i h k' j' i'  TOTAL
============= ========================================= =====
sizeof(A): 8    4                     4                   8
sizeof(B): 12        4                4 4                12
sizeof(C): 16              4          4 4 4              16
sizeof(D): 32                    4    4 4 4 4  4  4  4   32 
```

在哪里：

*   vptr 每个占用 4 个字节（64 位指针）
*   char 数组每个占用 4 个字节（四舍五入以对齐）
*   k'、j' 和 i' 是通过 C 而不是 B 继承的那些变量的副本。

# linux-kernel - 在 make mrproper 之后插入内核模块

> ID：10541150
> 
> 赞同：2
> 
> 时间：2012-05-10T19:49:40.457
> 
> 标签：linux-kernel, makefile, linux-device-driver, kernel-module

我下载内核源代码，编译它并运行新内核。我正在对 kvm 内核模块进行一些更改并对其进行测试。

所以这就是我在内核源代码中进行一些更改后所做的事情。

```
make M=arch/x86/kvm 
```

在此之后，我能够成功插入内核模块。

我犯了一个错误，`make mrproper`它清除了 linux 编译中的所有二进制文件和副产品。

那么，现在有没有办法只制作我的内核模块并将其插入当前启动的内核中，或者我应该再次编译整个内核并用 /boot 中的 vmlinuz 文件替换新的 vmlinuz 文件。

我可以做第二个选项，但这需要时间，而且不是解决这个小问题的最明智的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:08:08.560

If the kernel is currently running you can try running `make cloneconfig`. This should configure the kernel tree exactly like the running kernel.

The compiled module should then match your kernel.

# ios - iOS数组拷贝，如何发布？

> ID：10541151
> 
> 赞同：0
> 
> 时间：2012-05-10T19:49:41.440
> 
> 标签：ios, memory-management

释放您使用副本创建的数组的正确方法是什么？我有一个以 NSMutableArray 作为参数的函数 createDoc。我得到内存泄漏，因为我相信复制分配内存。

```
doc = [getDoc createDoc: [[array subarrayWithRange:NSMakeRange(2, 5)] copy] ]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T19:53:58.270

试试这个

```
doc = [getDoc createDoc: [[[array subarrayWithRange:NSMakeRange(2, 5)] copy] autorelease]]; 
```

甚至更好

```
NSArray *subArray = [[array subarrayWithRange:NSMakeRange(2, 5)] copy]];
doc = [getDoc createDoc:subArray];
[subArray release]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T19:52:13.857

你会释放副本。就这样。

```
NSArray * copy = [[array subarrayWithRange:NSMakeRange(2, 5)] copy];
doc = [getDoc createDoc:copy];
[copy release]; 
```

但是 - 你想要的是一个可变副本，如果这是参数所需要的：

```
NSMutableArray * copy = [[array subarrayWithRange:NSMakeRange(2, 5)] mutableCopy];
  ^^^^^^^                                                            ^^^^^^^^^^^
doc = [getDoc createDoc:copy];
[copy release]; 
```

在大多数情况下，甚至更好地将参数声明为数组，而不是让对象`getDoc`创建它的`mutableCopy`.

# orm - 如何使用 EclipseLink 和 JPA2 实现通用的“saveOrUpdate”方法

> ID：10541155
> 
> 赞同：3
> 
> 时间：2012-05-10T19:50:12.017
> 
> 标签：orm, jpa-2.0, eclipselink

我正在尝试做这样的方法，错误出现了并发问题..似乎我的更新方法不会增加我的实体的 @Version 属性。

我的代码是这样的：

```
 @Transactional
      public B save(B bean) {
        if (bean == null || bean.getId() == null) {
            persist(bean);
        } else {
            bean = update(bean);
        }
        return bean;
      }     

      protected final B update(B bean) {
        bean = em().merge(bean);
        em().flush();
        return bean;
      } 
```

这是我的 AbstractDao 的一段代码。em() 方法返回一个由 Guice-Persist 管理的 EntityManager。

另外，我正在使用eclipselink。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:41:25.567

我用以下代码解决它：

```
protected final void persist(B bean) {
    em().persist(bean);
}

protected final B update(B bean) {
    bean.setVersion(findById(bean.getId()).getVersion());
    bean = em().merge(bean);
    em().flush();
    return bean;
}

@Transactional
public B save(B bean) {
    if (bean == null || bean.getId() == null) {
        persist(bean);
    } else {
        bean = update(bean);
    }
    return bean;
} 
```

# java - Java中的sscanf等价物

> ID：10541157
> 
> 赞同：4
> 
> 时间：2012-05-10T19:50:20.363
> 
> 标签：java, string-parsing, scanf

> **可能重复：**
> [使用已知模式从字符串中解析值的 sscanf 的 Java 等效项是什么？](https://stackoverflow.com/questions/8430022/what-is-the-java-equivalent-of-sscanf-for-parsing-values-from-a-string-using-a-k)

我对 Java 还很陌生，但是看到 sscanf 函数有多么有用，我想知道 Java 中是否有等效函数。我有很多格式化的字符串（即，为我的目的编写脚本语言），所以正则表达式在这里是多余的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T20:02:09.333

```
Scanner scanner = new Scanner ("2 A text 3 4");
scanner.nextInt (); // 2
scanner.next ();    // A 
scanner.next ();    // text
scanner.nextInt (); // 3
scanner.nextInt (); // 4
// and so on. 
```

[这是 Scanner 类的官方文档。](http://docs.oracle.com/javase/6/docs/api/java/util/Scanner.html)

# django - nginx 子域和域重写 w 代理传递

> ID：10541160
> 
> 赞同：10
> 
> 时间：2012-05-10T19:50:48.720
> 
> 标签：django, proxy, nginx, rewrite

我需要这两种类型的重写：

`subdomain.domain.com => domain.com/website/subdomain`

`otherdomain.com => domain.com/userdomain/otherdomain.com`

我的问题是我希望用户看到`subdomain.domain.com`和`otherdomain.com`，而不是重定向的版本。我当前在 nginx 中的重写工作，但是用户的 URL 显示了重写，我希望这对用户是透明的，有什么想法吗？：

```
upstream domain_server { server localhost:8000 fail_timeout=0; }     

server {
        listen  80;
        root  /var/www/domain.com;

        server_name domain.com ~^(?<subdomain>.*)\.domain\.com$ ~^(?<otherdomain>.*)$;
        if ( $subdomain ) {
                rewrite ^ http://domain.com/website/$subdomain break;
        }
        if ( $otherdomain ) {
                rewrite ^ http://domain.com/userdomain/$otherdomain break;
        }

        location / {
                proxy_redirect off;
                proxy_buffering off;
                proxy_set_header Host $http_host;
                proxy_set_header X-forwarded-for $proxy_add_x_forwarded_for;
                if (!-f $request_filename) {
                        proxy_pass http://domain_server;
                        break;
                }
        }

} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-11T20:05:07.223

使用 nginx，您根本不需要重写。

```
upstream domain_server { server localhost:8000 fail_timeout=0; }

proxy_set_header Host domain.com;
proxy_set_header X-forwarded-for $proxy_add_x_forwarded_for;

server {
    listen  80 default_server;

    location / {
        proxy_pass http://domain_server/userdomain/$http_host;
    }
}

server {
    listen  80;
    server_name domain.com;

    root  /var/www/domain.com;

    location / {
        try_files $uri @backend;
    }

    location @backend {
        proxy_pass http://domain_server;
    }
}

server {
    listen  80;
    server_name ~^(?<subdomain>.+)\.domain\.com$;

    location / {
        proxy_pass http://domain_server/website/$subdomain$request_uri;
    }
} 
```

*   [http://nginx.org/r/proxy_pass](http://nginx.org/r/proxy_pass)
*   [http://wiki.nginx.org/IfIsEvil](http://wiki.nginx.org/IfIsEvil)
*   [http://wiki.nginx.org/Pitfalls](http://wiki.nginx.org/Pitfalls)
*   [http://nginx.org/en/docs/http/converting_rewrite_rules.html](http://nginx.org/en/docs/http/converting_rewrite_rules.html)

# c# - 仅使用 access_token 的 Twitter API 简单查询

> ID：10541161
> 
> 赞同：2
> 
> 时间：2012-05-10T19:51:05.243
> 
> 标签：c#, .net, facebook-graph-api, twitter

我正在编写一个通过 oauth 连接到 Facebook 和 Twitter 的 C#.Net WPF 4.0 应用程序。使用 Facebook Graph API，我可以授权、使用 oauth 登录、将临时 access_token 交换为几乎持久的访问令牌，然后仅通过在我的查询旁边添加 access_token 或在墙上发布来获取任何数据，像这样：[http://Url/query/access_token]，所有这一切都没有任何 SDK 或任何其他库。

我试图对 Twitter 做同样的事情，但我都搞混了。我一直在寻找有关如何像在 Facebook 中一样获取一些 Json 数据的示例，但我什么也没找到，可能是因为我不知道要搜索什么。我需要遵循什么流程才能仅使用直接 url 和令牌进行查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T21:44:42.813

您应该执行以下操作：

1.  获取用户的访问令牌：[https ://dev.twitter.com/docs/auth/obtaining-access-tokens](https://dev.twitter.com/docs/auth/obtaining-access-tokens)

2.  使用 REST API 之一：[https ://dev.twitter.com/docs/api](https://dev.twitter.com/docs/api)

3.  生成 OAuth 标头并将其插入到您的请求中。下面是我的应用程序中的代码，它将推文和图像上传到推特 - 但 GET 请求将是相似的。注意：我正在使用来自[https://cropperplugins.svn.codeplex.com/svn/Cropper.Plugins/TwitPic/OAuth.cs的 3rd-party OAuth 类](https://cropperplugins.svn.codeplex.com/svn/Cropper.Plugins/TwitPic/OAuth.cs)

    ```
    var oauth = new OAuth.Manager();
    oauth["consumer_key"] = Settings.TWITTER_CONSUMER_KEY;
    oauth["consumer_secret"] = Settings.TWITTER_CONSUMER_SECRET;
    oauth["token"] = item.AccessToken;
    oauth["token_secret"] = item.AccessSecret;

    var url = "https://upload.twitter.com/1/statuses/update_with_media.xml";
    var authzHeader = oauth.GenerateAuthzHeader(url, "POST");

    foreach (var imageName in item.Images.Split('|'))
    {
        var fileData = PhotoThubmnailBO.GetThumbnailForImage(imageName, ThumbnailType.FullSize).Photo;

        // this code comes from http://cheesoexamples.codeplex.com/wikipage?title=TweetIt&referringTitle=Home
        // also see http://stackoverflow.com/questions/7442743/how-does-one-upload-a-photo-to-twitter-with-the-api-function-post-statuses-updat
        var request = (HttpWebRequest) WebRequest.Create(url);

        request.Method = "POST";
        request.PreAuthenticate = true;
        request.AllowWriteStreamBuffering = true;
        request.Headers.Add("Authorization", authzHeader);

        string boundary = "~~~~~~" +
                          Guid.NewGuid().ToString().Substring(18).Replace("-", "") +
                          "~~~~~~";

        var separator = "--" + boundary;
        var footer = "\r\n" + separator + "--\r\n";
        string shortFileName = imageName;
        string fileContentType = GetMimeType(shortFileName);
        string fileHeader = string.Format("Content-Disposition: file; " +
                                          "name=\"media\"; filename=\"{0}\"",
                                          shortFileName);
        var encoding = Encoding.GetEncoding("iso-8859-1");

        var contents = new StringBuilder();
        contents.AppendLine(separator);
        contents.AppendLine("Content-Disposition: form-data; name=\"status\"");
        contents.AppendLine();
        contents.AppendLine(item.UserMessage);
        contents.AppendLine(separator);
        contents.AppendLine(fileHeader);
        contents.AppendLine(string.Format("Content-Type: {0}", fileContentType));
        contents.AppendLine();

        // actually send the request
        request.ServicePoint.Expect100Continue = false;
        request.ContentType = "multipart/form-data; boundary=" + boundary;

        using (var s = request.GetRequestStream())
        {
            byte[] bytes = encoding.GetBytes(contents.ToString());
            s.Write(bytes, 0, bytes.Length);
            bytes = fileData;
            s.Write(bytes, 0, bytes.Length);
            bytes = encoding.GetBytes(footer);
            s.Write(bytes, 0, bytes.Length);
        }

        using (var response = (HttpWebResponse) request.GetResponse())
        {
            if (response.StatusCode != HttpStatusCode.OK)
            {
                throw new Exception(response.StatusDescription);
            }
        }
    } 
    ```

# facebook - 为什么我网站上的点赞按钮只出现了大约 3/4 的时间？

> ID：10541169
> 
> 赞同：1
> 
> 时间：2012-05-10T19:51:55.620
> 
> 标签：facebook, html, facebook-like

我已经为此奋斗了一段时间，但我无法让 facebook 的“喜欢”按钮可靠地出现。在任何浏览器中，在我网站上的任何页面上，我大约有 2/3 或 3/4 的时间出现在我的网站上，例如这个：[https ://www.liveset.com/events/142-blindpilot-new-奥尔良直播](https://www.liveset.com/events/142-blindpilot-new-orleans-live)

我正在使用以下代码：

```
<div class='fb-like' data-href='https://www.liveset.com/events/142-blindpilot-new-orleans-live' data-layout='button_count' data-send='false' data-show-faces='false'></div>
.
.
.
<div id='fb-root'></div>
<script>
  //<![CDATA[
    (function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
  //]]>
</script> 
```

我们已经在禁用所有扩展的众多浏览器和操作系统中复制了这一点。页面上只有一个赞按钮。我们的 OpenGraph 标签是有效的，如果不是，为什么它只会在部分时间失败？

没有 Javascript 错误。`all.js`正确加载，并且有内容。类似 fb 的 div 根本没有用 iframe 填充；它与页面源中的完全一样。根本没有任何反应。

通过访问上面的站点并重新加载几次，很容易复制该问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:12:22.143

我无法通过 15 次重新加载来复制该问题，但我在具有大量动态内容或动态加载内容的网站上已经多次看到此问题。请注意您网站上要加载的最后一件事是 facebook 按钮吗？很可能已经到了他们的尽头，超时了。当其他东西必须加载时，我往往会遇到这个问题，它们需要一段时间，然后 facebook 无法及时完成浏览器加载它。

***附带说明，尝试删除谷歌分析和quantcast（如果你使用它），看看你是否可以复制这个问题。让我知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T21:11:34.483

尝试将您的 FB 脚本移出您的其他脚本`<div id="main">`并移至您下方的区域。`<div id="footer">`

这可能是因为您正在使用 Twitter 评论向导将内容动态填充到此 div 中，这会破坏浏览器解析 Facebook Like 按钮脚本的能力。

# git - 从 git svn 中的新提交对实验分支进行更改

> ID：10541170
> 
> 赞同：1
> 
> 时间：2012-05-10T19:51:58.553
> 
> 标签：git, svn

我有以下 git svn 情况。

1.  大师，从svn签出。
2.  分支的开发分支，我在其中做了一些更改。有些是 git 提交的，有些还没有提交。
3.  我必须解决一个错误，所以我隐藏了我未提交的东西，将分支切换到主控，`git svn rebase`更新，创建并切换到分支`bugfix`。
4.  修复了中的错误`bugfix`，已提交。
5.  从错误修复切换到 master，svn 合并。
6.  git svn 提交。
7.  现在我已经准备好继续我的工作了`devel`，但是我想在我的分支中带来最近的错误修复，而不会搞砸事情。

我现在应该怎么做，以保证当我最终结束工作`devel`并将 --squash 合并到 master 之后，我不会弄乱一切 dcommit ？我还没有准备好线性化，所以我不能在 master 的 devel 上做一个 git rebase（据我所知，这会将我所有的更改放在`devel`最新的`master`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:50:32.797

你的错误修复提交的一个简单的*git cherry-pick不会解决问题吗？*

# c# - 2D 像素着色器从颜色中移除 Alpha 通道

> ID：10541172
> 
> 赞同：2
> 
> 时间：2012-05-10T19:52:02.420
> 
> 标签：c#, xna, shader, alpha, hlsl

所以，我正在尝试在 XNA 中制作游戏，并且我正在将像素着色器应用到我的关卡中，以便我可以在游戏画面中添加效果。着色器本身运行良好，但它有一个缺陷确实会降低性能。只要着色器处于活动状态，我在屏幕上绘制的任何内容就好像它是以最大 Alpha 通道绘制的一样。我正在使用 XNA 的内置`Color`类绘制很多东西，其中大部分都有不同的 alpha。然而，着色器似乎忽略了所有这些。即使我只是从着色器返回源，也会发生这种情况。

我已经看到了一些可能的解决方案。其中第一个是绘制到 RenderTarget2D，虽然这确实解决了这个问题，但它导致了更严重的 alpha 问题，我什至不想进入。

我见过一些人声称将颜色乘以着色器中的 alpha 值似乎有帮助，但这绝对没有区别，这对我来说表明 alpha 值输入总是被读取为 1。

这里有一些图片来说明我的问题：

![这是着色器处于活动状态的结果](../Images/b6ff9aaab32910ea6151bebd3033013f.png)![这就是它应该看起来的样子](../Images/7ebfc5872f61d03c2367c799baedb872.png)

希望有人知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-05-10T03:34:17.440

在您的 Draw() 方法中，您需要调用： `GraphicsDevice.BlendState = BlendState.NonPremultiplied;`在调用任何调用着色器的方法（即`DrawUserIndexedPrimitives`等）之前。

否则，框架假定 alpha 值已被预乘，并且它可以将 RGB 值直接传送到帧缓冲区。

# java - Android 编程和使用 HTML 解析器从 Wikia.com 页面提取类别数据以用于 ListView

> ID：10541176
> 
> 赞同：0
> 
> 时间：2012-05-10T19:52:09.083
> 
> 标签：java, android, listview, html-parsing, mediawiki

首先，我想知道是否有与 Android 应用程序编程一起使用的 HTML 解析器，或者我是否只能访问 Android 开发人员网站上列出的 html 命令。原因是我正在制作一个允许您访问 Zelda Wikia 的应用程序，而不是硬编码所有内容，例如我想继续使用 MediaWiki API 提取名称的视频游戏的标题，我发现的命令是这个：

[http://zelda.wikia.com/api.php?action=query&list=categorymembers&cmtitle=Category:Games&cmlimit=500](http://zelda.wikia.com/api.php?action=query&list=categorymembers&cmtitle=Category:Games&cmlimit=500)

这将返回 HTML 格式的所有标题，我能想到从返回的内容中提取所需内容的唯一方法是使用 HTML 解析器，但我不确定是否有一个适用于 Android 编程的方法，如果是这样，如何我什至会从中提取我需要的东西。从这里获取数据后，我想将其显示在 ListView 中，当单击标题时，它会将用户带到 Wikia 以获取 WebView 中的特定标题。这是我应该这样做的方式还是有人有任何其他建议，我真的需要帮助。其余的代码如下，以防有人想看看我有什么：

```
 package com.lvlup.kikurself.zeldatest;

    import android.app.ListActivity;
    import android.content.Intent;
    import android.os.Bundle;
    import android.view.View;
    import android.widget.AdapterView;
    import android.widget.ArrayAdapter;
    import android.widget.ListView;
    import android.widget.AdapterView.OnItemClickListener;

    public class zeldaGames extends ListActivity {
        public void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        String[] values = new String[] { "The Legend of Zelda", "Zelda II: The
         Adventure of Link", "The Legend of Zelda: Ocarina of Time",};
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
        android.R.layout.simple_list_item_1, values);
        setListAdapter(adapter);
        final ListView zeldaList = getListView();

        zeldaList.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View v, int position, long thisID)
      {
         Object o = (zeldaList.getItemAtPosition(position));
         String gameName_temp = (o.toString());

         Intent newIntent = new Intent(v.getContext(), gameDisp.class);
         newIntent.putExtra("tempG", gameName_temp);
         startActivity(newIntent);

    }
    }); 
```

感谢您抽出时间来阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:03:54.053

我不会在电话上使用解析器。在你知道之前，页面的所有者可能会想出一个新的布局，破坏你的应用程序。

相反，我会构建一个 web 服务（带有 DomXML 的 PHP 是一个很好的选择），它解析给定的站点，并以 XML、JSON 或其他格式返回文件。然后我会编写一个应用程序来使用解析器 Web 服务作为数据源。

这样，您将拥有更多的计算机能力。您只需要维护一个解析器实例，您知道它可以在任何下载了您的应用程序的设备上运行。

也许听起来工作量很大，但相信我——你会做得更好。个人和专业经验

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T08:52:30.103

将 &format=xml 附加到您的 URL 以获取机器可读的数据。[请参阅https://www.mediawiki.org/wiki/API:Data_formats](https://www.mediawiki.org/wiki/API)上有关 API 格式的 MW 帮助和[https://www.mediawiki.org/wiki/API](https://www.mediawiki.org/wiki/API:Data_formats)上的一般 API 帮助

# cross-domain - Faye 如何实现跨域（XDR）发布/订阅？

> ID：10541181
> 
> 赞同：0
> 
> 时间：2012-05-10T19:52:23.967
> 
> 标签：cross-domain, xss, security, publish-subscribe, faye

[Faye](http://faye.jcoglan.com/)支持跨域订阅。这是他们文档的摘录：

> **跨域操作**
> Faye 客户端和服务器透明地支持跨域通信，因此您的客户端可以连接到您喜欢的任何域上的服务器，而无需进一步配置。

有谁知道它是如何实现的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T11:35:30.903

Faye在跨域时使用[JSONP向服务器发送握手请求，正如 Faye 的作者在](http://en.wikipedia.org/wiki/JSONP)[此处](https://groups.google.com/forum/#!msg/sockjs/WSIdcY14ciI/B9kot6nS73MJ)的回复中所解释的那样。然后它从列表中选择一个新的传输，按优先顺序：WebSocket、EventSource、XHR、CORS 和 JSON-P。[请注意，WebSockets 一旦建立，也可以像前面讨论](https://stackoverflow.com/questions/4042691/web-sockets-make-ajax-cors-obsolete)的那样跨域工作。

# jquery - 图像未正确堆叠

> ID：10541182
> 
> 赞同：4
> 
> 时间：2012-05-10T19:52:28.053
> 
> 标签：jquery, css, jquery-masonry

我正在使用 jquery masonry，并且无法正确堆叠图像/帖子（参见附图）。

问题是帖子/图像之间有太多的空白/间隙。

我怎样才能解决这个问题？

谢谢，

费萨尔

**索引.HTML.ERB**

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script src="/assets/jquery.js"></script>
<script src="/assets/jquery.masonry.min.js"></script>
<style>
  .item {
   width: 200px;
   margin: 8px;
   float: left;
   border: 1px solid #999999; 
   background-color: #F7F7F7; 
   -moz-border-radius: 10px; 
   -webkit-border-radius: 10px; 
   padding: 6px;
   color: black;
   }

</style>
<div id="container">
<br />
<br />
<br />
<% @posts.each do |post| %>
<div class="item">
<%= post.body %>
<br />
<%= post.title %> 
<br />
<i>RSVP -- <%= post.job %>.</i>
<br />
<i>Created <%= time_ago_in_words(post.created_at) %> ago.</i>
</div>
<script type="text/javascript">

$(window).load() { 
$('#container').masonry({
  itemSelector: '.box',
  columnWidth: function( containerWidth ) {
  return containerWidth / 5;
  });
});
</script>
<% end %>
</div> 
```

![在此处输入图像描述](../Images/d1eaaf2492af0f232808a05d4cbffe47.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T20:33:16.377

JSfiddle 会很好，也尝试使用

`$(window).load(function() {`

正如 egasimus 指出的那样……

`$(document).ready(function()`

行不通，但 (function() 位是我首先尝试的位。您也可以“摆弄” `gutterWidth`（砌体）。

## 更新：

我已经分叉了你制作的 jsfiddle，清理了一些代码（很多多余的 javascript 等）并让它工作。我已经在砖石等方面使用了这些建议，但应该是有道理的。查看小提琴的工作版本：http: [//jsfiddle.net/8KHAh/11/](http://jsfiddle.net/8KHAh/11/)

```
$(function(){
  $('#container').masonry({
    // options
    itemSelector : '.item',
    columnWidth : 226
  });
}); 
```

确保使用类似的 CSS 或调整`columnWidth`以调整填充等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:08:55.627

我刚刚第一次看到 jQuery Masonry，从它的样子来看，也许插件根本没有运行？当我的代码中有语法错误时，这通常会发生在我身上。你的 JS 看起来有点粗略，而且，嗯......明白了！用这个：

```
$(function() {
  $('#container').masonry({
    itemSelector: '.box',
    columnWidth: function( containerWidth ) {
      return containerWidth / 5;
    }
  });
}); 
```

那必须工作。

这就是为什么适当的缩进很重要——如果你有它，问题（和解决方案）对你来说几乎是显而易见的。首先，你打电话给：

```
$(window).load() { /* your code goes here */ } 
```

这是两个完全独立的陈述，实际上与以下内容相同：

```
$(window).load(); /* your code goes here */ 
```

您需要将匿名函数作为参数传递给`.load()`，如下所示：

```
$(window).load ( function() { /* your code goes here */ } ) 
```

此外，在定义函数之后，您的设置对象中有一个分号`columnWidth`- 就像您输入了一样

```
{
   name1: 'value1',
   name2: 'value2'; // <-- SYNTAX ERROR
   name3: 'value3', // it's okay to leave a trailing comma, though
} 
```

那个也总是让我明白，但是通过适当的缩进更容易看到。

结论：自学良好的*缩进*。此外，使用浏览器的*JS 控制台*检查语法错误；仅此一项就可以极大地帮助找出问题所在。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-10T20:00:06.723

我不熟悉砌体，但我向您展示了 8 像素的边距和 6 像素的填充。我会首先尝试减少那些，可能是两个或三个像素。如果那没有给我任何东西，我会为该课程添加一个边框，并找出它到底影响了什么

# javascript - 在页面下方查找元素

> ID：10541184
> 
> 赞同：-1
> 
> 时间：2012-05-10T19:52:37.803
> 
> 标签：javascript, jquery, html

有没有办法确定页面上给定元素下方的元素？我有一个工具，我想在几个元素上使用，这些元素一次只能看到一个。我希望能够确定在给定元素下哪个元素是可见的。这可以做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T19:54:43.823

没有办法在 JavaScript 中以本机方式可靠地执行此操作。CSS 可以以您无法预测的方式影响布局。

我可以想到一种解决方案，您可以在其中找到页面上的*所有*元素及其偏移量，然后尝试从中恢复，但我怀疑这不会很好地执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T19:58:58.737

`.next()`您可以使用 jQuery函数获得紧随其后的兄弟（在一组匹配的元素中） ：

[http://api.jquery.com/next/](http://api.jquery.com/next/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:58:21.817

根据用例，我可以想到几个选项。

一种选择是在容器上触发单击事件，然后在事件处理程序中选择 event.target。它应该是顶部的元素。

像这样：http: [//jsfiddle.net/sm7gH/](http://jsfiddle.net/sm7gH/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T23:17:17.020

我的问题是关于找到一个点或一个元素的元素壁橱。这个插件是这样做的： [jquery 最近的](http://gilmoreorless.github.com/jquery-nearest/).

# fortran - GFortran 等效于 ieee_exceptions

> ID：10541189
> 
> 赞同：6
> 
> 时间：2012-05-10T19:53:15.743
> 
> 标签：fortran, gfortran, intel-fortran

我正在尝试编写一个程序，该程序将在执行无效操作时停止，无论它是如何使用 GFortran 编译的。使用 ifort 我可以做这样的事情：

```
use ieee_exceptions
....
logical      :: halt
....
call ieee_get_halting_mode(IEEE_USUAL,halt)
call ieee_set_halting_mode(IEEE_USUAL,.True.)
....
! Something that may stop the program
....
call ieee_set_halting_mode(IEEE_USUAL,halt) 
```

GFortran 是否有类似于 ifort 的模块`ieee_exceptions`？或者更好的是，有没有办法在不知道程序将如何编译或将使用哪个编译器的情况下停止暂停模式？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T20:23:14.853

GFortran 从 GCC 5 版本开始支持 ieee_exceptions 模块。

如果您停留在较旧的 GFortran 版本上，一种解决方法是在 C/asm 中实现获取/设置 FP 捕获状态寄存器并从 Fortran 调用这些函数的函数。

PS.：GFortran 确实有一个开关 (-fpe-trap) 用于全局启用 FP 异常的陷阱，请参阅[http://gcc.gnu.org/onlinedocs/gfortran/Debugging-Options.html](http://gcc.gnu.org/onlinedocs/gfortran/Debugging-Options.html)。但是，既然你明确地说“不管它是如何用 gfortran 编译的”，我想你不想使用它。

# css - 如何在 div 之间对齐文本

> ID：10541190
> 
> 赞同：0
> 
> 时间：2012-05-10T19:53:20.873
> 
> 标签：css, html, text, alignment

这是我的问题：http: [//jsfiddle.net/F6pNm/8/](http://jsfiddle.net/F6pNm/8/)

我需要文本与链接出现在同一行。但它一直使用在右侧添加一个空行。

编辑：忘了提，我需要 div 中的文本在链接之间居中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T19:55:28.330

也有`div#flash`浮动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:01:14.160

如果你添加这个：

`#footer {text-align:center;}`

并添加

`#flash {display:inline}` 到“闪存”ID

如果可行：http: [//jsfiddle.net/F6pNm/24/](http://jsfiddle.net/F6pNm/24/)

注意：如果您想将多个 div 居中，这也可以使用，只需使用 a`class`而不是`id`(and`.`而不是`#`) 将其应用于多个 div

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T19:56:55.040

用于`display: inline-block`flash div。既然您提到您希望内容居中，请添加`#footer { text-align: center; }`到您的样式规则中。

# python - 用于 Python 的 ESB？

> ID：10541195
> 
> 赞同：5
> 
> 时间：2012-05-10T19:53:46.040
> 
> 标签：python, soa, rabbitmq, esb, amqp

在工作中，我们正在讨论选择现成的全栈 ESB（企业服务总线 - [http://en.wikipedia.org/wiki/Enterprise_service_bus](http://en.wikipedia.org/wiki/Enterprise_service_bus)）与围绕 AMQP 系统（如 RabbitMQ）滚动我们自己。

部分担忧是我们的生态系统是 PHP 尽可能快地迁移到 Python，以及我们已经拥有的 API 都以 JSON 格式传递消息。ESB 和“SOA 解决方案”上的搜索空间真的，真的被污染了。那个或这个都不是 Python Thing(tm)。因此我在这里问：似乎我们考虑过的所有全栈 ESB 解决方案都主要集中在集成基于 SOAP 的组件上。这似乎是很多我们可能不想做的消息的双重包装和解包。此外，如果可以的话，我们真的很想用 Python 编写我们的服务到 ESB 适配器。

我应该在这里指出，PHP/Python 生态系统是内部的——我们的许多客户都是相当隐蔽的组织，他们使用与我们的应用程序集成的大型单一企业软件。他们会对面向客户的 API 的 SOAP、XML-RPC 等感到满意。我们已经收到了请求。所以，在*边界*，我们最终可能会同时提供基于 JSON 和基于 SOAP 的服务；只是不是在内部。

**tl;dr：**有没有人喜欢与 Python 应用程序一起使用的全栈 ESB？与您合作过的不受欢迎的人怎么样（无论如何，它有多糟糕*）*？你认为包装像 RabbitMQ 这样的东西对于 PHP/Python 生态系统来说是一个更好的主意吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T15:48:29.357

如果可以的话，这确实是一个大问题，更像是几个问题。所以，如果我误解了你，请原谅我。

根据定义，ESB 与您在实现应用程序时选择的语言并没有真正耦合。因此，无论您想以 SOA 方式连接的应用程序是用 PHP 还是 Python 编写的，您都应该能够在 SOA 中公开它们。另一方面，JSON 在 SOA 世界中是一个有点偏离的选择，这个选择非常重要。

许多 COTS ESB 提供了某种程度的 REST 支持。Mule、ServiceMix、WSO2、JBoss 是一些开源的。如果您更喜欢与商业供应商合作，我相信 Tibco 和 Oracle 要么具有开箱即用的支持，要么可以通过一些编码来实现。

您选择使用任何消息代理（例如 RabbitMQ 或 AMQP）实际上与传输有关——这又一次不是真正直接相关的。再说一次，如果您的目标是在您的应用程序之间添加消息传递，那么这是一个我无法真正回答的有效问题。

如果您可以写出您对 ESB 感兴趣的主要动机，这将有助于获得更好的答案。

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:18:34.933

哇...这就是个问题，而且我无法完全回答它...但是既然您问了这是众所周知的 2 美分：

RabbitMQ 很不错。我将它用于在科学计算网格上实现缓存的多代理系统中的实时消息传递。RabbitMQ 的一个很好的特性是您可以推送任意（包括二进制）消息，这可能是一个很好的性能特性。（也许使用 Hessian 协议的序列化/反序列化？）

我对 RabbitMQ 的唯一关心是继续支持 AMQP 的 python 库。当前的库是功能性的，我已经使用过它们……但它们存在的时间不长，而且我不确定对此类工作感兴趣和支持的社区有多大。也就是说，最近似乎 RabbitMQ（AMQP 和一般的消息传递）正在成为一个更热门的话题，希望这将拓宽在 python - AMQP 接口库上工作的基础。

# c - 将负双精度转换为无符号整数的行为是否在 C 标准中定义？ARM 与 x86 上的不同行为

> ID：10541200
> 
> 赞同：26
> 
> 时间：2012-05-10T19:54:27.863
> 
> 标签：c, casting, floating-point, type-conversion, undefined-behavior

我有在不同平台上运行的代码，似乎得到不同的结果。我正在寻找一个适当的解释。

我希望 cast to对 1或对¹`unsigned`起作用。`float``double``int`

**窗户：**

```
double dbl = -123.45; 
int d_cast = (unsigned int)dbl; 
// d_cast == -123 
```

**WinCE (ARM):**

```
double dbl = -123.45; 
int d_cast = (unsigned int)dbl; 
// d_cast == 0 
```

***编辑：***

感谢您指出正确的方向。

**~~修复~~解决方法**

```
double dbl = -123.45; 
int d_cast = (unsigned)(int)dbl; 
// d_cast == -123
// works on both. 
```

* * *

脚注 1：编者注：将超出范围的`unsigned`值转换为有符号类型，如`int`实现*定义*（不是未定义）。C17 § 6.3.1.3 - 3。

因此，对于最终在某些特定实现上具有巨大积极价值`d_cast`的情况，标准也没有确定对的分配。`(unsigned)dbl`（该执行路径包含 UB，因此理论上 ISO C 已经不在了）。在实践中，编译器在正常的 2 补码机器上执行我们所期望的操作，并保持位模式不变。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-10T19:59:32.650

### 不

* * *

这种转换是未定义的，因此不可移植。

C99/C11 6.3.1.4

> 当实浮点类型的有限值转换为_Bool 以外的整数类型时，小数部分被丢弃（即，该值被截断为零）。如果整数部分的值不能用整数类型表示，则行为未定义。

根据 C11 6.3.1.4 脚注 61：

> 将整数类型的值转换为无符号类型时执行的求余运算不需要在将实浮点类型的值转换为无符号类型时执行。因此，可移植实浮点值的范围是（-1，Utype_MAX+1）。

# eigen - 当矩阵超过 512x512 时，特征并行性能下降

> ID：10541202
> 
> 赞同：0
> 
> 时间：2012-05-10T19:54:31.640
> 
> 标签：eigen

我使用一个线程和 8 个线程对 Eigen SGEMM 操作进行了基准测试，我得到的是性能在 512x512 达到峰值，但在超过该大小时下降。我想知道这是否有任何具体原因可能与较大矩阵的复杂性有关？我在 Eigen 网站上查看了矩阵矩阵运算的基准，但没有看到任何类似的东西。

在 512x512 时，我的并行速度提高了 4 倍。但在 4096x4096 中，我的速度几乎快了 2 倍。我正在使用 openMP 进行并行处理，并将其降低到一个线程，我将 num_of_threads 设置为两个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T11:01:24.250

您的结果表明，该算法主要受大矩阵大小的内存带宽限制。4Kx4K 矩阵（浮点数？）超过了普通人可用的任何 CPU 的缓存大小，而 512x512 可以轻松适应大多数现代 CPU 的 L3 缓存。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-25T15:38:16.790

我使用包括 Eigen 在内的几个 BLAS 实现对矩阵乘法进行了一些测试。我已经在[这里](http://gcdart.blogspot.com/2013/06/fast-matrix-multiply-and-ml.html)发布了结果。你可能会发现它很有用。

# javascript - 使用 jQuery 的可折叠列表 - 如何更新展开/折叠所有按钮

> ID：10541205
> 
> 赞同：2
> 
> 时间：2012-05-10T19:54:47.443
> 
> 标签：javascript, jquery, list, expand, collapse

我有一个项目列表，这些项目可以单独展开/折叠，也可以使用全部展开/全部折叠按钮一次全部展开。所有项目开始折叠，但如果您手动展开项目以便展开每个项目，“全部展开”按钮应更改为“全部折叠”。同样，如果您折叠所有项目，它应该更改为“全部展开”。

因此，每次单击单个行时，它都应检查是否所有项目现在都已折叠/展开，如果是，请更新“全部展开/折叠”按钮。

我的问题是我不确定如何通过单击遍历所有项目以查看它们是否折叠并正确更新。

这是一个 JSFiddle：[JSFiddle](http://jsfiddle.net/iblizzard/vTDV6/)

这是我当前的代码：

```
 var expand = true;

jQuery.noConflict();
jQuery(function() {
    jQuery('[id^=parentrow]')
    .attr("title", "Click to expand/collapse")
    .click(function() {
        jQuery(this).siblings('#childrow-' + this.id).toggle();
        jQuery(this).toggleClass("expanded collapsed");
        ExpandCollapseCheck();
    });

    jQuery('[id^=parentrow]').each(function() {
        jQuery(this).siblings('#childrow-' + this.id).hide();

        if (jQuery(this).siblings('#childrow-' + this.id).length == 0)
            jQuery(this).find('.expand-collapse-control').text('\u00A0');
    });

    jQuery('#childrow-' + this.id).hide("slide", { direction: "up" }, 1000).children('td');

});

function CollapseItems() {
    jQuery('[id^=parentrow]').each(function() {
        jQuery(this).siblings('#childrow-' + this.id).hide();

        if (!jQuery(this).hasClass('expanded collapsed'))
            jQuery(this).addClass("expanded collapsed");
    });
}

function ExpandItems() {
    jQuery('[id^=parentrow]').each(function() {
        jQuery(this).siblings('#childrow-' + this.id).show();

        if (jQuery(this).hasClass('expanded collapsed'))
            jQuery(this).removeClass("expanded collapsed");

    });
}

function ExpandCollapseChildren() {

    if (!expand) {
        CollapseItems();
        jQuery('.expander').html('Expand All');
    }
    else {
        ExpandItems();
        jQuery('.expander').html('Collapse All');
    }

    expand = !expand;
    return false;
}

    function ExpandCollapseCheck() {
    if ((jQuery('[id^=parentrow]').hasClass('expanded collapsed')) && (expand)) {
        jQuery('.expander').html('Expand All');
        CollapseItems();
        expand = !expand;
    }
    else if ((!jQuery('[id^=parentrow]').hasClass('expanded collapsed')) && (!expand)) {
        jQuery('.expander').html('Collapse All');
        ExpandItems();
        expand = !expand;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:25:17.317

不要打扰迭代，只需使用选择器来获取所有元素及其类的计数：

```
var $all = jQuery('selector to return all lines');
if($all.length == $all.filter('.collapsed').length)
  //all the rows are collapsed
if($all.end().length == $all.filter('.expanded').length)
  //all the rows are expanded 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:29:28.097

我在您的代码中看到了几件事。

1.  似乎您可能有多个具有相同 ID 的孩子，例如`#childrow-parent0`. 这不是合法的 HTML，可能会导致 JavaScript 出现问题。改用类。
2.  操作 ID 查找子项比使用内置 jQuery 选择器查找子项更困难。我意识到在这种情况下，他们是兄弟姐妹而不是真正的孩子，但您仍然可以使用它`.nextUntil(".parent")`来查找父母的所有“孩子”。
3.  使用您的点击处理程序来进行展开/折叠，而不是重复代码。一个你有一个点击处理程序，你可以调用`.click()`一个父级，它会像你点击它一样切换。
4.  如果您的一半元素被折叠，您想要“全部展开”还是“全部折叠”？你可能两者都想要。

考虑到所有这些，我用更少的行编写了您的代码。为了回答您的具体问题，我只是将“.parent.expanded”元素的数量与“.parent”元素的数量进行了比较，看看它们是否都被扩展了。（我改为使用单个`.parent`课程。）

[演示](http://jsfiddle.net/ztjAU/)

您问题的相关代码：

```
$('#expand_all').toggleClass("disabled", $('.parent.expanded').length == $('.parent').length);
$('#collapse_all').toggleClass("disabled", $('.parent.collapsed').length == $('.parent').length); 
```

这使用`toggleClass()`，第二个参数根据折叠/展开的父项的数量返回真/假。这用于`toggleClass`确定是否`disabled`应用了该类。

# objective-c - 大图像处理 (ARC) 主要内存泄漏

> ID：10541217
> 
> 赞同：0
> 
> 时间：2012-05-10T19:55:57.410
> 
> 标签：objective-c, ios, uiimage, core-graphics

我正在创建的 iPad 应用程序必须能够为之前在我的应用程序中生成的 4096x2992 图像创建图块。

4096x2992 图像不是很复杂（我正在测试的内容），当以 png 格式写入文件时大约为 600kb ...

在模拟器上，这段代码似乎工作正常，但是当我在更严格的内存条件下（在我的 iPad 上）运行应用程序时，进程退出，因为它内存不足......

我一直在应用程序中使用相同的代码，以前工作正常（但是只为 3072x2244 图像创建图块）......

要么我必须做一些愚蠢的错误，要么我的@autoreleasepool 没有按应有的方式工作（我想我提到我使用 ARC）......在仪器中运行时，我只能看到使用的内存攀升到 ~500mb然后崩溃！

我已经分析了代码，但没有发现与我的应用程序的这一部分相关的单个内存泄漏，所以我真的很困惑为什么这会在我身上崩溃......

只是关于如何调用我的函数的一点历史，所以你知道发生了什么......该应用程序使用 CoreGraphics 渲染一个 UIView (4096x2992)，其中包含一些 UIImageView，然后它将 UIImage 引用发送到我的函数`buildFromImage:`（如下）开始切割向上/调整图像大小以创建我的文件...

这是代码...内存问题是在...`buildFromImage:`下的主循环中建立的`NSLog(@"LOG ------------> Begin tile loop ");`

```
-(void)buildFromImage:(UIImage *)__image {

NSLog(@"LOG ------------> Begin Build ");

//if the __image is over 4096 width of 2992 height then we must resize it! (stop crashes ect)
if (__image.size.width > __image.size.height) {
    if (__image.size.width > 4096) {
        __image = [self resizeImage:__image toSize:CGSizeMake(4096, (__image.size.height * 4096 / __image.size.width))];
    }
} else {
    if (__image.size.height > 2992) {
        __image = [self resizeImage:__image toSize:CGSizeMake((__image.size.width * 2992 / __image.size.height), 2992)];
    }
}

//create preview image (if landscape, no more than 748 high... if portrait, no more than 1004 high) must keep scale
NSString *temp_archive_store = [[NSString alloc] initWithFormat:@"%@/%i-temp_imgdat.zip",NSTemporaryDirectory(),arc4random()];
NSString *temp_tile_store = [[NSString alloc] initWithFormat:@"%@/%i-temp_tilestore/",NSTemporaryDirectory(),arc4random()];

//create the temp dir for the tile store
[[NSFileManager defaultManager] createDirectoryAtPath:temp_tile_store withIntermediateDirectories:YES attributes:nil error:nil];

//create each tile and add it to the compressor once its made
//size of tile
CGSize tile_size = CGSizeMake(256, 256);
//the scales that we will be generating the tiles too
NSMutableArray *scales = [[NSMutableArray alloc] initWithObjects:[NSNumber numberWithInt:1000],[NSNumber numberWithInt:500],[NSNumber numberWithInt:250],[NSNumber numberWithInt:125], nil]; //scales to loop round over

NSLog(@"LOG ------------> Begin tile loop ");
@autoreleasepool {
    //loop through the scales
    for (NSNumber *scale in scales) {

        //scale the image
        UIImage *imageForScale = [self resizedImage:__image scale:[scale intValue]];

        //calculate number of rows...
        float rows = ceil(imageForScale.size.height/tile_size.height);

        //calulate number of collumns
        float cols = ceil(imageForScale.size.width/tile_size.width);

        //loop through rows and cols

        for (int row = 0; row < rows; row++) {

            for (int col = 0; col < cols; col++) {

                NSLog(@"LOG ------> Creating Tile (%i,%i,%i)",col,row,[scale intValue]);

                //build name for tile...
                NSString *tile_name = [NSString stringWithFormat:@"%@_%i_%i_%i.png",@"image",[scale intValue],col,row];

                @autoreleasepool {

                    //build tile for this coordinate
                    UIImage *tile = [self tileForRow:row column:col size:tile_size image:imageForScale];

                    //convert image to png data
                    NSData *tile_data = UIImagePNGRepresentation(tile);

                    [tile_data writeToFile:[NSString stringWithFormat:@"%@%@",temp_tile_store,tile_name] atomically:YES];

                }

            }

        }

    }

}
} 
```

这也是我的调整大小/裁剪功能，因为这些也可能导致问题..

```
-(UIImage *)resizeImage:(UIImage *)inImage toSize:(CGSize)scale {

@autoreleasepool {

    CGImageRef inImageRef = [inImage CGImage];

    CGColorSpaceRef clrRf = CGColorSpaceCreateDeviceRGB();

    CGContextRef ctx = CGBitmapContextCreate(NULL, ceil(scale.width), ceil(scale.height), CGImageGetBitsPerComponent(inImageRef), CGImageGetBitsPerPixel(inImageRef)*ceil(scale.width), clrRf, kCGImageAlphaPremultipliedFirst );

    CGColorSpaceRelease(clrRf);

    CGContextDrawImage(ctx, CGRectMake(0, 0, scale.width, scale.height), inImageRef);

    CGImageRef img = CGBitmapContextCreateImage(ctx);

    UIImage *image = [[UIImage alloc] initWithCGImage:img scale:1 orientation:UIImageOrientationUp];

    CGImageRelease(img);
    CGContextRelease(ctx);

    return image;

}

}

- (UIImage *)tileForRow: (int)row column: (int)col size: (CGSize)tileSize image: (UIImage*)inImage
{

@autoreleasepool {

    //get the selected tile
    CGRect subRect = CGRectMake(col*tileSize.width, row * tileSize.height, tileSize.width, tileSize.height);

    CGImageRef inImageRef = [inImage CGImage];

    CGImageRef tiledImage = CGImageCreateWithImageInRect(inImageRef, subRect);

    UIImage *tileImage = [[UIImage alloc] initWithCGImage:tiledImage scale:1 orientation:UIImageOrientationUp];

    CGImageRelease(tiledImage);

    return tileImage;

}

} 
```

现在我从来没有在内存管理方面做得那么好，所以我确实花时间阅读它，并将我的项目转换为 ARC，看看是否可以解决我的问题（那是前一段时间），但从结果来看，我在仪器中对其进行分析后，我必须做一些非常错误的事情，以使内存泄漏得如此糟糕，但我只是看不出我做错了什么。

如果有人能指出我可能做错的任何事情，那就太好了！

谢谢

利亚姆

（如果您需要更多信息，请告诉我）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-01T09:53:50.143

我使用“UIImage+Resize”。在 @autoreleasepool {} 内，它可以在循环中与 ARC 一起正常工作。

[https://github.com/AliSoftware/UIImage-Resize](https://github.com/AliSoftware/UIImage-Resize)

```
-(void)compress:(NSString *)fullPathToFile {
@autoreleasepool {
    UIImage *fullImage = [[UIImage alloc] initWithContentsOfFile:fullPathToFile];
    UIImage *compressedImage = [fullImage resizedImageByHeight:1024];
    NSData *compressedData = UIImageJPEGRepresentation(compressedImage, 75.0);
    [compressedData writeToFile:fullPathToFile atomically:NO];
} 
```

}

# c++ - 两个值的随机选择

> ID：10541224
> 
> 赞同：8
> 
> 时间：2012-05-10T19:56:19.003
> 
> 标签：c++, algorithm, random

在我的算法中，我有两个值需要随机选择，但每个值都必须选择预定的次数。

到目前为止，我的解决方案是将选择正确次数放入向量中，然后对其进行洗牌。在 C++ 中：

```
// Example choices (can be any positive int)
int choice1 = 3; 
int choice2 = 4;

int number_of_choice1s = 5;
int number_of_choice2s = 1;

std::vector<int> choices;
for(int i = 0; i < number_of_choice1s; ++i) choices.push_back(choice1);
for(int i = 0; i < number_of_choice2s; ++i) choices.push_back(choice2);
std::random_shuffle(choices.begin(), choices.end()); 
```

然后我保留一个迭代器`choices`，每当我需要一个新的迭代器时，我都会增加迭代器并获取该值。

这可行，但似乎可能有更有效的方法。因为我总是知道我将使用每个值的多少，所以我想知道是否有更算法的方法来执行此操作，而不仅仅是存储值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-10T20:02:26.617

您不必要地使用了这么多内存。你有两个变量：

```
int number_of_choice1s = 5;
int number_of_choice2s = 1; 
```

现在简单地随机化：

```
int result = rand() % (number_of_choice1s + number_of_choice2s);
if(result < number_of_choice1s) {
  --number_of_choice1s;
  return choice1;
} else {
  --number_of_choice2s;
  return choice2;
} 
```

这可以很好地扩展两百万次随机调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:40:33.317

你可以写得更简单一点：

```
std::vector<int> choices(number_of_choice1s, choice1);
choices.resize(number_of_choice1s + number_of_choice2s, choice2);
std::random_shuffle(choices.begin(), choices.end()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T22:01:59.553

有偏差的随机分布将在结果集上保持某种顺序（选择最多的选择接下来被选择的机会越来越少），这会产生有偏差的结果（特别是如果您必须选择的次数第一个值比第二个值大，你最终会得到类似 {1,1,1,2,1,1,1,1,2} 的东西。

这是代码，它看起来很像@Tomasz Nurkiewicz 编写的代码，但使用简单的偶数/奇数应该有大约 50/50 的机会选择任一值。

```
int result = rand();

if ( result & 1  &&  number_of_choice1s > 0)
{
number_of_choice1s--;
return choice1;
}else if (number_of_choice2s>0)
{
number_of_choice2s--;
return choice2;
}
else
{
return -1;
} 
```

# internet-explorer - 跨浏览器测试：一台机器上的所有主流浏览器

> ID：10541225
> 
> 赞同：139
> 
> 时间：2012-05-10T19:56:30.580
> 
> 标签：internet-explorer, browser, cross-browser, virtualization

本指南的目的：

*   **在一台机器上并排**运行**多个未修改**的 Internet Explorer、
    Safari、Opera、Chrome 和 Firefox本机版本。

 **[第 1 部分](https://stackoverflow.com/questions/10541225/cross-browser-testing-all-major-browsers-on-one-machine#10541470)涵盖：

*   目录
*   哪些浏览器需要测试？
*   如何创建一个快速启动且永不过期的 Windows XP VM？
*   在哪里可以下载必要的软件（VM 映像、浏览器等）？

[第 2 部分](https://stackoverflow.com/questions/10541225/cross-browser-testing-all-major-browsers-on-one-machine#10541484)还介绍了：

*   IE、Firefox、Opera、Chrome 和 Safari 的安装和配置指南。
*   开发人员工具和快捷方式。
*   **时间和磁盘空间成本**。

*许多部分是独立的。例如，关于运行多个版本的浏览器的指令通常是适用的。*

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-05-10T20:16:39.587

> ### 内容
> 
> 1.  哪些浏览器需要测试？
>     *   经验法则：应该包括哪些浏览器？
> 2.  准备
>     *   视窗
>     *   Windows 7+（适用于 IE9+）
>     *   浏览器下载
>         *   IE浏览器
>         *   火狐
>         *   歌剧
>         *   铬合金
>         *   苹果浏览器
>         *   Adobe Flash 播放器
>     *   下载摘要
> 3.  Sandboxie
>     
>     [**第 2 部分：安装和配置**](https://stackoverflow.com/questions/10541225/cross-browser-testing-all-major-browsers-on-one-machine#10541484)
> 4.  IE浏览器
> 5.  火狐
> 6.  歌剧
> 7.  铬合金
> 8.  苹果浏览器
> 9.  开发人员工具（和快捷方式）
> 10.  测量的设置时间和磁盘空间
>     *   每个浏览器所需的时间（安装和配置）
> 11.  最佳使用
>     *   主页在`http://10.0.2.2:8888/`

* * *

> # 1\. 哪些浏览器需要测试？

统计数据很快就过时了。出于这个原因，我参考了Wikipedia[上 Web 浏览器的使用份额](http://en.wikipedia.org/wiki/Browser_statistics#Summary_table)，以及以下站点以获取最新的浏览器**版本**信息。每个站点都附有简短的使用指南。

*   [我可以使用](http://caniuse.com/usage_table.php)- 基于 StatCounter 和其他来源的数据的浏览器使用情况表。
*   [StatCounter](http://gs.statcounter.com/#browser_version-ww-monthly-201205-201205-bar) - 统计：浏览器版本 | 时间段：上个月^([截图](https://i.stack.imgur.com/HS59c.png "屏幕截图：在 StatCounter 中设置选项"))。
*   [W3Counter](http://www.w3counter.com/globalstats.php?year=2012&month=4) - 查看存档报告：（`January 2012`选择上个月）。^([截图](https://i.stack.imgur.com/aHSUI.png "屏幕截图：在 W3Counter 中选择报告"))。
*   [Wikimedia](http://stats.wikimedia.org/archive/squid_reports/) - 转到底部以打开最新报告 SquidReportClients。
*   [Clicky](http://www.getclicky.com/marketshare/global/web-browsers/versions/) - 这个网站提供了个别版本^([截图](https://i.stack.imgur.com/ByiQq.png "屏幕截图：显示浏览器的个人统计信息"))的统计数据。

## 经验法则：应该包括哪些浏览器？

*   [Firefox](http://www.getclicky.com/marketshare/global/web-browsers/firefox/)：最新的[ESR 版本](https://www.mozilla.org/en-US/firefox/organizations/faq/)+ 最新的稳定主要版本。^([发行说明](https://www.mozilla.org/en-US/firefox/releases/)| [对于开发人员](https://developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases)| [快速发布时间表](https://wiki.mozilla.org/RapidRelease/Calendar))
*   [Opera](http://www.getclicky.com/marketshare/global/web-browsers/opera/)：12.x + 最新稳定版本。^([版本历史](http://www.opera.com/docs/history/))
    从 Opera 15 开始，Opera 使用与 Chrome 相同的引擎。不过，相当多的用户仍在使用 Opera 12（当 Opera 15 发布时，用户体验发生了显着变化）。
*   [Safari](http://www.getclicky.com/marketshare/global/web-browsers/safari/) : 5.1.7 (Windows) + 最新版本。^([发行说明](https://apple.stackexchange.com/questions/2576/is-there-anywhere-i-can-get-a-complete-list-of-historical-safari-release-notes))
    不幸的是，Apple 放弃了对 Windows 的支持，因此您需要获得 Mac 或在 VM 中运行 OS X 才能在 Safari 中测试页面。
*   [Chrome](http://www.getclicky.com/marketshare/global/web-browsers/google-chrome/)：最新的稳定版本。^([发行说明](http://googlechromereleases.blogspot.com/))
*   [互联网浏览器](http://www.getclicky.com/marketshare/global/web-browsers/internet-explorer/)：IE8+。^([功能历史](http://en.wikipedia.org/wiki/Features_of_Internet_Explorer#History))
    这实际上取决于您的客户。本指南还教授如何获取 IE6 和 7，但这些浏览器已经死了，或者接近死了。IE8 是 Windows XP 上最后一个受支持的 Internet Explorer 版本，它仍然被大量使用。

## 评论

如今，大多数网络浏览器都使用某种形式的自动更新快速发布。在编写本指南时，发布的频率并不高，因此无需回顾即可设置一组浏览器很有用。
除非您有意在旧浏览器中测试应用程序，否则只需获取最新版本的浏览器并让自动更新程序负责管理版本。

如果你不需要太多的灵活性，并且想快速测试一个页面，我建议你看看[BrowserStack.com](http://www.browserstack.com/)。注册后，您可以获得 30 分钟的免费试用，允许您直接在浏览器中访问大量桌面和移动浏览器。

* * *

> # 2\. 准备

在设置机器之前，请下载所有必要的文件（参见本节末尾的“下载摘要”）。所有文件都将通过共享文件夹与虚拟机共享^([什么？如何？](http://www.techsmartlife.com/2012/01/09/share-and-write-files-between-host-and-guest-os-on-virtualbox/)).

*   虚拟化软件（推荐使用[VirtualBox](https://www.virtualbox.org/)，商业使用也是免费的。下面的说明是用[VirtualBox](https://www.virtualbox.org/)编写的。）
*   **视窗**
    *   [从modern.IE](http://www.modern.ie/en-us/virtualization-tools#downloads)网站下载 VirtualBox 的 IE6 XP 映像。提取`.ova`里面的文件并运行它以将其导入VirtualBox。（图像也可用于其他虚拟化产品，例如 VMware、Parallels、Virtual PC 和 Hyper-V）
        *   [适用于 Windows 上 VirtualBox 的 IE6 XP 映像](https://az412801.vo.msecnd.net/vhd/IEKitV1_Final/VirtualBox/Windows/IE6_XP_Signed/IE6.WinXP.For.WindowsVirtualBox.exe) ^(大约 764MB)
        *   [Mac 上 VirtualBox 的 IE6 XP 映像](https://az412801.vo.msecnd.net/vhd/IEKitV1_Final/VirtualBox/OSX/IE6_WinXP.ova.zip) ^(大约 717MB)
        *   [Linux 上 VirtualBox 的 IE6 XP 映像](https://az412801.vo.msecnd.net/vhd/IEKitV1_Final/VirtualBox/Linux/IE6_XP/IE6.WinXP.For.LinuxVirtualBox.sfx) ^(大约 771MB)
    *   准备使用的图像：
        *   **VirtualBox 设置**：启用网络适配器，但不要**将**VM 连接到真实网络。
        *   **VirtualBox 设置**：创建只读共享文件夹。此文件夹将用于在主机操作系统和来宾操作系统之间传输数据。
        *   运行`net use x: \\vboxsvr\WinShared`（假设共享文件夹被调用`WinShared`。这会将网络目录绑定到`x:`驱动器）。
        *   *可选*：安装**[AntiWPA](http://www.google.com/search?q=Antiwpa-V3.4.6_for_X64_and_X86.zip+download)**以禁用激活检查，如果您将使用映像超过 30 天。
        *   *可选*：**禁用分页文件**（计算机 > 属性 > 高级 > 性能 > 高级 > 虚拟内存 > 更改 > 无分页 > 设置 [确认]）。
        *   *可选*：通过 Order the rows by column禁用[不必要的服务](http://www.blackviper.com/2008/05/19/black-vipers-windows-xp-x86-32-bit-service-pack-3-service-configurations/)，并将所有“自动”服务切换为“手动”，根据图像。每当您想安装 MSI 软件包时，请运行（“Windows Installer”）：`Start > Run >` **`services.msc`**
            `Startup Type`**`net start msiServer`**
            ![Windows XP - services.msc](../Images/c52b9372c7ff7fd00e3fe14db0303c4c.png "服务.MSC;  只显示必要的服务")
        *   *可选*：[禁用桌面清理向导](http://support.microsoft.com/kb/320154)：`Desktop > Properties > Desktop > Customize Desktop > Disable "Desktop Cleanup wizard every 60 days"`
        *   *可选*：安装和配置**Sandboxie**（用于在同一 IE6 虚拟机上运行 IE7 和 IE8）
        *   *可选*：安装[CCleaner](http://www.piriform.com/ccleaner)，运行它来配置它并清理垃圾。
        *   *可选*：安装[7-Zip](http://www.7-zip.org/)（用于多个 Chrome）
        *   通过来宾操作系统 (WinXP) 关闭系统。
        *   **VirtualBox 设置**：将虚拟机连接到真实网络。
            *（只有 Internet Explorer 在安装过程中需要 Internet）*
        *   *可选*：创建 VM 的快照，以便在下一步搞砸时可以恢复。
*   **Windows 7+（适用于 IE9+）**
    *   [从modern.IE](http://www.modern.ie/en-us/virtualization-tools#downloads)网站下载预构建的虚拟机映像。
        这些图像是定时炸弹，它们在首次使用后 30 天过期。当图像过期时，它们会在使用一小时后关闭。如果您不希望每次都重新创建映像，请在激活映像之前更改 VM 的硬件时钟。
        例如，在 VirtualBox 中，您可以使用`VBoxManage modifyvm NAME_OF_VM --biossystemtimeoffset +3600000000`将时间设置为未来 1000 小时（如果要将其设置为过去的某个时间点，请使用减号）。
*   **浏览器下载**
    *   IE浏览器：
        *   如果您想在单台机器上安装 IE 6-8，推荐的方法：
            *   **需要[Sandboxie](http://sandboxie.com/index.php?DownloadSandboxie)**（我建议[购买](http://www.sandboxie.com/index.php?RegisterSandboxie)完整版，或[在 YouTube 上查看](http://www.youtube.com/results?search_query=sandboxie%2032-bit%20multiple%20sandboxes)）。
            *   **IE6 - 预装在 XP VM 中**
            *   [IE7](http://download.microsoft.com/download/3/8/8/38889dc1-848c-4bf2-8335-86c573ad86d9/IE7-WindowsXP-x86-enu.exe)和[IE8](http://download.microsoft.com/download/C/C/0/CC0BD555-33DD-411E-936B-73AC6F95AE11/IE8-WindowsXP-x86-ENU.exe)完整的离线安装程序
            *   [Internet Explorer Developer 工具栏](http://download.microsoft.com/download/1/6/4/164E1C78-A660-4C25-86E9-3C95EB0C537C/IEDevToolBarSetup.msi)（[发布信息](http://www.microsoft.com/download/en/details.aspx?id=18359)）（适用于 IE6+7）
        *   **IE9+ - 使用来自**[modern.IE](http://www.modern.ie/en-us/virtualization-tools#downloads)的预构建图像）。
    *   火狐：
        *   [配置文件管理器](https://developer.mozilla.org/en/Profile_Manager) ^(轻松管理多个配置文件)
        *   **[从Mozilla.org](https://www.mozilla.org/en-US/firefox/)****下载最新版本**。
        *   [从ftp.mozilla.org](https://ftp.mozilla.org/pub/mozilla.org/firefox/releases/)下载旧版本（如果您只对最近的旧版本感兴趣，请参阅[release.mozilla.org](http://releases.mozilla.org/pub/mozilla.org/firefox/releases/)）。
        *   或者，使用[Utilu Mozilla Firefox Collection](http://utilu.com/UtiluMFC/)。
    *   歌剧：
        *   **[从Opera.com](http://www.opera.com/browser/download/?custom=yes)下载任何 Opera 版本。**
    *   铬合金：
        *   下载[7-zip](http://www.7-zip.org/)以提取 Chrome 安装程序。
        *   **[在FileHippo.com](http://www.filehippo.com/download_google_chrome/history/)下载特定版本。确保选择“FileHippo”镜像以获取存档版本。**否则，您将被重定向到来自 Google 服务器的最新版本。
    *   苹果浏览器：
        *   [从Apple.com](http://www.apple.com/safari/download/)下载最新版本。
        *   **[从Oldapps.com](http://www.oldapps.com/apple_safari.php)下载其他版本。**
    *   [Adobe Flash 播放器](http://get.adobe.com/flashplayer/otherversions/)
        *   如果闪存必须在 IE6 中工作，请下载[10.3](http://blogs.adobe.com/asset/2012/03/an-update-for-the-flash-player-updater.html#comments) ^(3 MB版本。)否则，[请下载最新版本](https://get.adobe.com/flashplayer/otherversions/)。
        *   [下载其他浏览器](https://get.adobe.com/flashplayer/otherversions/)的最新插件。

### 下载摘要

为方便起见，最好将所有安装文件放在共享文件夹中。这是所有必要文件的简短（完整）列表（按步骤排序）：

*   [适用于 Windows 上 VirtualBox 的 IE6 XP 映像](https://az412801.vo.msecnd.net/vhd/IEKitV1_Final/VirtualBox/Windows/IE6_XP_Signed/IE6.WinXP.For.WindowsVirtualBox.exe) ^(大约 764MB)
*   [Mac 上 VirtualBox 的 IE6 XP 映像](https://az412801.vo.msecnd.net/vhd/IEKitV1_Final/VirtualBox/OSX/IE6_WinXP.ova.zip) ^(大约 717MB)
*   [Linux 上 VirtualBox 的 IE6 XP 映像](https://az412801.vo.msecnd.net/vhd/IEKitV1_Final/VirtualBox/Linux/IE6_XP/IE6.WinXP.For.LinuxVirtualBox.sfx) ^(大约 771MB)
*   [抗 WPA](http://www.google.com/search?q=Antiwpa-V3.4.6_for_X64_and_X86.zip%20download) ^(24 KB；[*误报*](https://www.virustotal.com/file/d8275a1c165842181215a8d05f91654a61b23584c6e0174fc613d3100b090da3/analysis/)；[_](https://www.virustotal.com/file/d8275a1c165842181215a8d05f91654a61b23584c6e0174fc613d3100b090da3/analysis/) md5：e5a14c47e9c26e78fccb22ee71fedd51)，[CCleaner](http://www.piriform.com/ccleaner/download/standard) ^(3.5 MB)，[沙盒](http://sandboxie.com/index.php?DownloadSandboxie) ^(2.3 MB)
*   浏览器（[Firefox](http://releases.mozilla.org/pub/mozilla.org/firefox/releases/) + [Profile manager](ftp://ftp.mozilla.org/pub/mozilla.org/utilities/profilemanager/1.0/)、[Opera](http://www.opera.com/browser/download/?custom=yes)、[Chrome](http://www.filehippo.com/download_google_chrome/history/)、[Safari](http://www.oldapps.com/apple_safari.php)）
    IE7 XP 和 IE8 XP 安装程序可以在这里下载：[IE7](http://download.microsoft.com/download/3/8/8/38889dc1-848c-4bf2-8335-86c573ad86d9/IE7-WindowsXP-x86-enu.exe)、[IE8](http://download.microsoft.com/download/C/C/0/CC0BD555-33DD-411E-936B-73AC6F95AE11/IE8-WindowsXP-x86-ENU.exe)
*   [7-zip](http://www.7-zip.org/) ^(1.1 MB)用于提取 Chrome 的安装程序。
*   [ActiveX 10.3](https://helpx.adobe.com/flash-player/kb/archived-flash-player-versions.html#Flash%20Player%20archives) for IE6+，其他浏览器的[最新插件版本](https://get.adobe.com/flashplayer/otherversions/)。
*   适用于 IE6 和 7 ^(626 KB的)[IE Developer 工具栏](http://download.microsoft.com/download/1/6/4/164E1C78-A660-4C25-86E9-3C95EB0C537C/IEDevToolBarSetup.msi)

* * *

> # 3.沙盒

[Sandboxie](http://sandboxie.com/)是一个轻量级的工具，可以在沙盒中运行应用程序。它还可用于在单个 Windows 机器上安装**多个版本的 IE/Safari 。**

*   **下载**：[http ://sandboxie.com/index.php?DownloadSandboxie](http://sandboxie.com/index.php?DownloadSandboxie)
*   **补丁**：一次启用多个沙箱**需要**扩展版本。[付钱](http://www.sandboxie.com/index.php?RegisterSandboxie)给他们或[访问 YouTube](http://www.youtube.com/results?search_query=sandboxie%2032-bit%20multiple%20sandboxes)。
    同时运行多个 IE/Safari 版本需要扩展版本。如果您不介意一次测试一个 IE/Safari 版本，标准版本就足够了。

    安装后：
*   **禁用提示**：“配置 > 提示 > 隐藏所有提示”
*   默认情况下，沙盒应用程序周围会出现黄色边框。如果您不喜欢这样，请转到**配置基础**：“沙盒 > 默认框 > 沙盒设置 > 外观”。

    对于每个新的 IE/Safari 版本，您必须遵循以下步骤：
*   **创建**：“Sandbox > Create New Sandbox” - 输入名称，例如“IE8”并确认。
*   **安装**：“IE8 > Run Sandboxed > Run Any Program”
    选择所需的安装程序，然后按 OK。
*   **快捷方式**：完成安装后，使用“IE8 > 浏览内容”，找到二进制文件并创建应用程序的桌面快捷方式。

所有沙盒文件/注册表更改都保存在`C:\Sandbox`. 默认情况下，此目录中的应用程序在沙箱中启动。其他程序可以通过上下文菜单在沙盒中轻松启动：“运行沙盒”*或*“发送到 > 沙盒 > IE8”。

**使用 CCleaner 进行清理**：在主环境中运行 CCleaner，然后在各个沙箱中运行。

导航至：[第 2 部分](https://stackoverflow.com/questions/10541225/cross-browser-testing-all-major-browsers-on-one-machine#10541484)

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-05-10T20:17:13.317

> **第 2 部分的内容**（导航至：[第 1 部分](https://stackoverflow.com/questions/10541225/cross-browser-testing-all-major-browsers-on-one-machine#10541470)）
> 
>  4\. Internet Explorer
>  5\. Firefox
>  6\. Opera
>  7\. Chrome
>  8\. Safari
>  9\. 开发工具（和快捷方式）
>  10\. 测量的设置时间和磁盘空间
>     • 每个浏览器所需的时间（安装和配置）
>  11\. 最佳使用
>     • 主页在`http://10.0.2.2:8888/`

* * *

> # 安装和配置

浏览器配置提示：

*   主页
*   禁用检查：“默认浏览器”和“更新”。
*   激活开发者工具

* * *

> # 4\. 互联网浏览器

Windows 7 不允许运行较旧的 IE 实例，^(但请参阅下面的注释)。这就是需要 Win XP VM 的原因。

IE 不能降级，所以从最低版本开始，然后在**单独的 Sandboxie**中升级 IE 。升级前在最低浏览器版本中设置首选项，这样您只需设置一次主要首选项。

*   IE6 - 在 WinXP 中默认安装
*   [IE7](http://download.microsoft.com/download/3/8/8/38889dc1-848c-4bf2-8335-86c573ad86d9/IE7-WindowsXP-x86-enu.exe) / [IE8](http://download.microsoft.com/download/C/C/0/CC0BD555-33DD-411E-936B-73AC6F95AE11/IE8-WindowsXP-x86-ENU.exe) - 在 Sandboxie (WinXP) 中安装
*   [IE9+ - 从modern.IE](http://www.modern.ie/en-us/virtualization-tools#downloads)网站获取预构建的 Windows 虚拟机映像。
    这些图像在首次使用后 30 天过期。当图像过期时，它们会在使用一小时后关闭。如果您不希望每次都重新创建映像，请在激活映像之前更改 VM 的硬件时钟。
    例如，如果您使用 VirtualBox，请启动终端并发出以下命令（将大写的名称替换为合理的名称）：
    `VBoxManage modifyvm NAME_OF_VM --biossystemtimeoffset <OFFSET IN MS, prefixed by plus or minus>`

[此站点](http://helpdesk.uvic.ca/software/downloads/windows/msiexpl.html)提供 IE6（甚至 IE5.5）的完全离线安装程序。

对于 IE6 和 IE7，应安装[Internet Explorer Developer Toolbar 。](http://www.microsoft.com/download/en/details.aspx?id=18359)IE8+[内置 F12 开发者工具](http://msdn.microsoft.com/en-us/library/gg589512%28v=vs.85%29.aspx)。

**配置**

*   启动IE6设置：首页、安全、Cookies、默认浏览器。
*   IE7：通过（IE7 Sandboxie）注册表摆脱第一个运行页面。请参阅[Microsoft 的 TechNet 论坛上的此帖子](http://social.technet.microsoft.com/Forums/en/itprovistaie/thread/91c92a44-1baf-48c3-bae2-12ed926d5639#258fd0f0-120a-4f1c-ad8c-d18a77421cfc)。
*   IE8：摆脱“设置 Windows Internet Explorer 8”对话框。这可以通过启动 IE8，然后单击“稍后”或[修改注册表来完成](http://www.winhelponline.com/blog/disable-ie8-tour-welcome-screen-runonce-all-users/)。

实际上可以通过应用程序虚拟化在 Windows 7 中运行 IE6-8。[VMWare ThinApp](http://www.vmware.com/products/thinapp/)运行良好，但设置需要相当多的时间，因为您需要捕获 Internet Explorer 的安装。此外，该软件包非常昂贵（注册机可以免费获得，但不道德）。

* * *

> # 5.火狐

**选项 1（懒惰）**：
[Utilu Mozilla Firefox Collection](http://utilu.com/UtiluMFC/)。此工具包含所有 Firefox 版本 (200+ MB) 的安装程序。Firebug、Web Developer 工具栏和 Flash 也包括在内。

**选项 2**：
*可以轻松地同时安装和执行多个 Firefox 版本。*

1.  [下载](ftp://ftp.mozilla.org/pub/mozilla.org/utilities/profilemanager/1.0/)Mozilla 的官方[配置文件管理器](https://developer.mozilla.org/en/Profile_Manager)。
2.  [从http://releases.mozilla.org/pub/mozilla.org/firefox/releases/](http://releases.mozilla.org/pub/mozilla.org/firefox/releases/)下载相关的 Firefox 版本。旧版本可以在[ftp.mozilla.org](https://ftp.mozilla.org/pub/mozilla.org/firefox/releases/)找到。
3.  安装每个 Firefox 版本。方便地选择一个主目录（“Firefox”），并使用版本号作为子目录的名称（“3.6”）。
4.  扩展：启动**最旧**的Firefox 版本，并获取您喜欢的扩展：
    *   [Firebug](https://addons.mozilla.org/en-US/firefox/addon/firebug/) - 旧 Firefox 版本的必备工具。最新的 Firefox 版本并不真正需要，它有一套很好的[内置开发工具](https://developer.mozilla.org/en-US/docs/Tools)。
    *   [HttpFox](https://addons.mozilla.org/en-US/firefox/addon/httpfox/) - 一个简单有效的测量 HTTP 请求的工具。
    *   [Web Developer](https://addons.mozilla.org/en-US/firefox/addon/web-developer/) - 一个非常有用的 Web 开发工具栏。节省很多时间。
    *   [控制台²](https://addons.mozilla.org/en-US/firefox/addon/console%C2%B2) - 增强了内置控制台 ( `Ctrl` `Shift>` `J`)。
5.  首选项：`Tools > Options`（Windows），`Edit > Preferences`（Linux）
    *   一般：主页
    *   安全性：取消选中所有设置，“当站点尝试安装附加组件时警告我”除外。
        （不要忘记通过底部的按钮查看警告消息设置）。
    *   先进的：
        *   一般的：
            *   检查默认浏览器：关闭
            *   提交崩溃报告：关闭
        *   更新：禁用所有更新
6.  清理：关闭所有选项卡，按下`Ctrl` `Shift` `Del`并检查所有内容。然后关闭火狐。
7.  Firefox 的[**配置文件管理器**](https://developer.mozilla.org/en/Profile_Manager)：
    [![截屏](../Images/471adcde46845ff55c92182fdc6654e8.png "全尺寸")](https://i.stack.imgur.com/eeN6c.png "Firefox 的配置文件管理器")
    *   `Copy`通过选项复制每个配置文件。
    *   将打开一个[对话框^(屏幕截图。)](https://i.stack.imgur.com/opgTT.png "配置文件管理器：复制配置文件对话框")选择适当的名称（例如`Firefox 3.6`）和目的地。
    *   使用该`Firefox version`选项为配置文件选择默认的 Firefox 版本。
    *   还要选中该`Start new instance [-no-remote]`框，以允许同时运行多个 Firefox 版本。
8.  整理起来
    *   使用该`Start Firefox`按钮启动 Firefox 实例。
    *   让插件兼容性检查运行并在必要时进行更新。
    *   使用 . 清除缓存、历史记录等`Ctrl` `Shift` `Del`。
    *   对每个 Firefox 版本重复此步骤。

* * *

> # 6\. 歌剧

**Opera ：** [Opera.com](http://www.opera.com/browser/download/?custom=yes)上提供了所有安装程序的列表。多个版本可以并排安装，没有任何问题。在安装过程中，选择“自定义”和**不同**的目录。
在安装时，还选择对所有用户使用相同的配置文件。

**重要首选项：设置 > 首选项 > 高级 > 安全 > 不检查更新。**

注意：Opera 15+ 使用与 Chrome 相同的渲染和 JavaScript 引擎。

* * *

> # 7.铬

**Chrome ：可以从**[File Hippo](http://www.filehippo.com/download_google_chrome/history/)下载独立安装程序。
也可以并排运行多个 Chrome 版本。

虽然可以使用 Sandboxie，但建议使用下一个本机方法以便并行运行多个版本。

1.  [从File Hippo](http://www.filehippo.com/download_google_chrome/history/)下载所需的版本。
2.  **创建**一个主目录，例如`C:\Chrome\`.
3.  **提取**安装程序（=**不安装**），例如使用[7-Zip](http://www.7-zip.org/)。
    解压后，`chrome.7z`会创建一个存档。还解压缩此文件，然后下降创建的`Chrome-bin`目录。
    现在，你看到`chrome.exe`了一个像`18.0.1025.45`.
    移动`chrome.exe`到`18.0.1025.45`，然后将此目录移动到`C:\Chrome`。`Chrome-bin`可以安全地删除其中的剩余文件。
4.  **为每个版本**创建一个快捷方式：

    ```
    "C:\Chrome\18.0.1024.45\chrome.exe" --user-data-dir="..\User Data\18" --chrome-version=18.0.1025.45 
    ```

    此快捷方式的说明：

    *   `"C:\Chrome\18.0.1024.45\chrome.exe"`• 这是**启动器**
    *   `--user-data-dir="..\User Data\18"` • 用户配置文件，相对于 的位置`chrome.exe`。您也可以使用`--user-data-dir="C:\Chrome\User Data\18"`相同的效果。***为最低*****Chrome 版本设置您的偏好，并为*每个*Chrome 版本复制用户配置文件。****较旧的 Chrome 版本拒绝使用新版本的用户配置文件。**
    ***   `--chrome-version=18.0.1025.45`•二进制文件的**位置**：
        *   位置（例如`18.0.1025.45`）必须是目录的名称：
        *   必须以数字开头和结尾。中间可能会出现一个点。
        *   这些数字不一定必须与真实版本号匹配（尽管使用真实版本号很方便......）。**

 **关于配置：所有首选项都可以设置为`chrome://settings/`。我通常会更改主页和“幕后”设置。

*   禁用自动更新：[http ://dev.chromium.org/administrators/turning-off-auto-updates](http://dev.chromium.org/administrators/turning-off-auto-updates)

由于 Chrome 版本很多，安装所有版本是不切实际的。我创建了一个自动执行这些步骤的 VB 脚本，因此我可以存储安装程序，然后在需要测试旧版 Chrome 时运行该脚本：[https ://gist.github.com/Rob--W/2882558](https://gist.github.com/Rob--W/2882558)

* * *

> # 8\. 野生动物园

注意：Windows 上的 Safari 支持已停止。Windows 上最后支持的 Safari 版本是 5.1.7；您需要 Mac 或 OS X VM 来在较新的 Safari 版本中测试您的网站。

Safari 本身[并不支持](https://apple.stackexchange.com/questions/11441/can-i-run-two-versions-of-safari-side-by-side)多个版本或用户配置文件并排。Safari 4[濒临死亡](http://caniuse.com/usage_table.php)，所以你只需要测试 5.*。所有 Safari 版本都可以从[旧应用程序](http://www.oldapps.com/apple_safari.php)下载。

*   下载并安装[Safari 5.0](http://www.oldapps.com/apple_safari.php?old_safari=21?download)。
*   启动 Safari，设置您的偏好。
*   **为每个额外的安装创建一个新的*Sandboxie***沙箱。
    最初安装**最旧**的版本很重要，以便用户配置文件可以适应较新的版本。
*   有关在 Sandboxie 中安装的更多信息，请参阅*Sandboxie*和*Internet Explorer*部分。

开发者工具必须通过`Preferences > Advanced > Show Developer menu in menu bar`. 安装 Safari 后，通过`Control panel > Add/Remove software`.

* * *

> # 9\. 开发者工具（和快捷方式）

*   IE浏览器
    *   IE6 / IE7：[Internet Explorer 开发工具栏](http://www.microsoft.com/download/en/details.aspx?id=18359)
    *   IE8`F12` [开发者工具](http://msdn.microsoft.com/en-us/library/ie/dd565628%28v=vs.85%29.aspx) ^(内置)
    *   IE9+ `F12` [F12 开发者工具](http://msdn.microsoft.com/en-us/library/gg589512%28v=vs.85%29.aspx) ^(内置)
*   火狐
    *   3.6+ `F12` [Firebug](http://getfirebug.com/)（见[addons.mozilla.org](https://addons.mozilla.org/en-US/firefox/addon/firebug/)）
    *   4+ `Ctrl` `Shift` `K` [Web 控制台](https://developer.mozilla.org/en/Using_the_Web_Console) ^(内置)
    *   ^(内置)所有`Ctrl` `Shift` `J`错误控制台（可使用[控制台](https://addons.mozilla.org/en-US/firefox/addon/console%C2%B2/)[²](https://addons.mozilla.org/en-US/firefox/addon/console%C2%B2/)进行扩展）^([](https://addons.mozilla.org/en-US/firefox/addon/console%C2%B2/))
*   歌剧
    *   9.5+ `Ctrl` `Shift` `I` [Opera Dragonfly](http://www.opera.com/dragonfly/documentation/) ^(内置)
    *   15+ `Ctrl` `Shift` `J` [Chromium 开发者工具](https://developers.google.com/chrome-developer-tools/) ^(内置)。
*   铬合金
    *   ^(内置)所有`Ctrl` `Shift` `J` [Chrome 开发者工具](https://developers.google.com/chrome-developer-tools/) 。
*   苹果浏览器
    *   4+ `Ctrl` `Alt` `C` [Safari 开发者工具](http://developer.apple.com/library/safari/documentation/appleapplications/Conceptual/Safari_Developer_Guide/2SafariDeveloperTools/SafariDeveloperTools.html) ^(内置)。默认情况下禁用这些工具。通过启用它`Preferences > Advanced > Show Developer menu in menu bar`。

* * *

> # 10\. 测量的设置时间和磁盘空间

*   设置基本环境需要**30 分钟**。
*   安装浏览器不需要太多时间。
*   根据浏览器的数量，配置它们可能需要一些时间。

*   使用本指南 + Opera 12 beta 中列出的浏览器设置 WinXP VM：
    *   下载大小：585MB
    *   12 个浏览器
    *   所用时间：1:09 小时（32 分钟到达 IE）
    *   设备大小：1.1G/进口大小：2.2G。
    *   **详细日志： http: [//pastebin.com/R7WGPK99](http://pastebin.com/R7WGPK99)**
*   设置一个巨大的 WinXP VM 进行详细的浏览器兼容性测试：
    *   24 个浏览器
    *   使用时间：2:15 小时
    *   电器尺寸：1.4G/进口尺寸：3.0G
    *   **日志： http: [//pastebin.com/SJEgxNyr](http://pastebin.com/SJEgxNyr)**

### 每个浏览器所需的时间（安装和配置）

*   歌剧：2分钟
*   Internet Explorer：3 分钟 *
*   野生动物园：4 分钟 *
*   火狐：5 分钟
*   铬：6 分钟

* 不包括设置 Sandboxie 沙箱的时间（< 1 分钟）。

* * *

> # 11\. 优化使用

安装完成后，使用 CCleaner 清理垃圾，然后：

*   导出设备（此设备可以保存在其他地方作为备份）。
*   删除新创建的虚拟机
*   导入设备（这些步骤可减小 VM 的文件大小）
*   创建快照（用作检查点）

从现在开始，当您完成网页测试后，关闭虚拟机，然后选择“恢复快照”。这将使您的虚拟机保持整洁和快速。

![关闭机器 > 恢复快照](../Images/c5e3a33cef905728bb32a3277507e555.png "VirtualBox 对话框：关闭 VM 并恢复快照")

### 主页在`http://10.0.2.2:8888/`

来宾操作系统可以通过 IP 地址访问主机操作系统`10.0.2.2`。即使主机没有互联网连接，`8888`也可以通过来宾访问在端口上运行的服务器。`http://10.0.2.2:8888/`

因此，`http://10.0.2.2:8888/`建议设置为主页。

可能的用例：

*   测试单个页面。
*   根据暴露的用户代理（例如通过重定向）自动显示某个页面。
*   Fiddleing：在 Chrome 中创建一个 fiddle，并在 Firefox 中进行测试。
*   分享文字和链接。

前面的所有内容都可以在一个简单的服务器上轻松实现（例如，我使用过[Node.js](http://nodejs.org/)）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-02-06T05:41:20.417

只是为了参与其中，微软最近开始提供一项名为modern.IE的免费服务：

> Modern.IE 是我的 Microsoft 的一项任务，旨在简化 Internet Explorer 浏览器的跨浏览器测试。微软创建了modern.IE，为开发人员和设计人员提供了一套促进IE浏览器测试的工具。
> 
> 使用modern.IE，您有两种方法可以在IE 中测试您的网站。首先，modern.IE 为您提供三个月免费使用基于 Web 的浏览器测试服务 BrowserStack。您只需要一个 Facebook 帐户即可登录并开始测试。
> 
> Modern.IE 提供的第二种方法是从 IE 6 到 IE 10 的每个浏览器的虚拟化映像，可以在 Windows、Mac 或 Linux 上的 VirtualBox、Virtual PC、Hyper-V 或 VMWare Player 等虚拟化软件上运行。
> 
> 此外，modern.IE 还提供了一个工具，它可以扫描您的网页以查找常见的编码问题并将它们列出以供您更正，以便它们在所有 IE 版本中正确显示。

*来源：[modern.IE - 跨浏览器 IE 测试工具套件](https://web.archive.org/web/20130709012751/http://www.functionn.in/2013/02/modernie-cross-browser-ie-testing-tools.html)*

**注意：**链接的文章已被删除。这些链接现在转到页面的[Wayback Machine](http://archive.org/web/)存档。****

# java - RegEx - 查找和替换位于同一文件中多个位置的两个标签之间的内容

> ID：10541229
> 
> 赞同：0
> 
> 时间：2012-05-10T19:56:44.323
> 
> 标签：java

我有一个包含@Start、@End 标记多个位置的java 文件。寻找可以替换这两个标签（包括标签）之间的代码的正则表达式

```
public class MyClass{ 
private String name; 
private String age; 

    @Start 
    private String address; 
    private String phoneNumber; 
    @End 
    -----------
    Some more code goes here
    ---------------

    @Start 
    private String pin; 
    private String amount; 
    @End 

    -----------
    Some more code goes here
    ---------------
} 
```

我正在使用 google 替换插件[http://code.google.com/p/maven-replacer-plugin/](http://code.google.com/p/maven-replacer-plugin/)以及 maven pom 中的以下配置来替换内容

```
<configuration>
..........
<token>@Start.*@End</token>
<value></value>
<regexFlags>
<regexFlag>DOTALL</regexFlag>
</regexFlags>
.......
</configuration> 
```

我可以替换标记之间的代码，但它匹配第一个 @Start 标记和最后一个 @End 标记，并删除了这两个标记之间的所有内容，因为我只想在两个标记之间替换内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T19:58:18.630

使用[非贪婪（或惰性）](http://www.regular-expressions.info/repeat.html#lazy)运算符

```
@Start.*?@End 
```

# google-apps-script - 获取 Gmail Meter 脚本的“TypeError”响应。

> ID：10541230
> 
> 赞同：0
> 
> 时间：2012-05-10T19:56:46.973
> 
> 标签：google-apps-script

我收到以下错误：“TypeError：无法从 null 读取属性“0.0”。（line227）”

我一直在查看这里的文档：[https](https://developers.google.com/apps-script/articles/gmail-stats#section1) ://developers.google.com/apps-script/articles/gmail-stats#section1 但无法排除故障。

Line227: variables.dayOfEmailsReceived[day]++;

抱歉，stackoverflow 的新手，但非常感谢任何帮助。

参考：

```
var BATCH_SIZE = 50;
var ss = SpreadsheetApp.getActiveSpreadsheet();
// If you are using several email addresses, list them in the following variable 
// - eg 'romain.vialard@gmail.com,romain.vialard@example.com'
var aliases =  'romain.vialard@euromed-management.com';

function activityReport() {
var status = ScriptProperties.getProperty("status");
if (status == null) {
    // If the script is triggered for the first time, init
    init_();
}
else {
    status = Utilities.jsonParse(status);
    var previousMonth = new Date(new Date().getFullYear(), new Date().getMonth() - 1, 1).getMonth();
    if (status == null || (status.customReport == false && status.previousMonth != previousMonth)) {
        init_();
        fetchEmails_(status.customReport);
    }
    // If report not sent, continue to work on the report
    else if (status.reportSent == "no") {
        fetchEmails_(status.customReport);
    }
}
}

function fetchEmails_(customReport) {
var variables = Utilities.jsonParse(ScriptProperties.getProperty("variables"));
if (!customReport) {
    var query = "after:" + variables.year + "/" + (variables.previousMonth) + "/31";
    query += " before:" + new Date().getYear() + "/" + (variables.previousMonth + 1) + "/31";
}
else {
    var query = "after:" + Utilities.formatDate(new Date(variables.startDate), variables.userTimeZone, 'yyyy/MM/dd');
    query += " before:" + Utilities.formatDate(new Date(variables.endDate), variables.userTimeZone, 'yyyy/MM/dd');
}
query += " in:anywhere -label:sms -label:call-log -label:chats -label:spam -filename:ics";
query += " -from:maestro.bounces.google.com -from:unified-notifications.bounces.google.com -from:docs.google.com";
query += " -from:group.calendar.google.com -from:apps-scripts-notifications@google.com";
query += " -from:sites.bounces.google.com -from:noreply -from:notify -from:notification";
var startDate = new Date(variables.startDate).getTime();
var endDate = new Date(variables.endDate).getTime();
var conversations = GmailApp.search(query, variables.range, BATCH_SIZE);
variables.nbrOfConversations += conversations.length;
var sheets = ss.getSheets();
var people = sheets[0].getDataRange().getValues();
var record = [];
for (var i = 0; i < conversations.length; i++) {
    Utilities.sleep(1000);
    var conversationId = conversations[i].getId();
    var firstMessageSubject = conversations[i].getFirstMessageSubject();
    var starred = false;
    if (conversations[i].hasStarredMessages()) {
        variables.nbrOfConversationsStarred++;
        starred = true;
    }
    var important = false;
    if (conversations[i].isImportant()) {
        variables.nbrOfConversationsMarkedAsImportant++;
        important = true;
    }
    var location = "";
    var labels = conversations[i].getLabels();
    var nbrOfLabels = labels.length;
    if (nbrOfLabels == 0) {
        if (conversations[i].isInInbox()) {
            variables.nbrOfConversationsInInbox++;
            location += "Inbox,";
        }
        else if (conversations[i].isInTrash()) {
            variables.nbrOfConversationsInTrash++;
            location += "Trashed,";
        }
        else {
            variables.nbrOfConversationsArchived++;
            location = "Archived";
        }
    }
    else {
        variables.nbrOfConversationsInLabels++;
        for (var j = 0; j < nbrOfLabels; j++) {
            location += labels[j].getName() + ",";
        }
    }
    var youReplied = false;
    var youStartedTheConversation = false;
    var someoneAnswered = false;
    var messages = conversations[i].getMessages();
    var nbrOfMessages = messages.length;
    variables.nbrOfEmailsPerConversation[nbrOfMessages]++;
    for (var j = 0; j < 10; j++) {
        if (variables.topThreads[j][1] < nbrOfMessages) {
            variables.topThreads.splice(j, 0, [firstMessageSubject, nbrOfMessages]);
            variables.topThreads.pop();
            j = 10;
        }
    }
    var timeOfFirstMessage = 0;
    var waitingTime = 0;
    for (var j = 0; j < nbrOfMessages; j++) {
        var process = true;
        var date = messages[j].getDate();
        var month = date.getMonth();
        if (customReport) {
            if (date.getTime() < startDate || date.getTime() > endDate) {
                process = false;
            }
        }
        else {
            if (month != variables.previousMonth) {
                process = false;
            }
        }
        if (process) {
            //////////////////////////////////
            // Fetch sender of each emails
            //////////////////////////////////
            var from = messages[j].getFrom().replace(/"[^"]*"/g,'');
            if (from.match(/</) != null) {
                from = from.match(/<([^>]*)/)[1];
            }
            var time = Utilities.formatDate(date, variables.userTimeZone, "H");
            var day = Utilities.formatDate(date, variables.userTimeZone, "d") - 1;

            // Use function from Utilities file
            variables = countSendsPerDaysOfWeek_(variables, date, from);
            var body = messages[j].getBody();
            // Use function from Utilities file
            var resultsFromCalcMessagesLength = calcMessagesLength_(variables, body, from);
            variables = resultsFromCalcMessagesLength[0];
            var messageLength = resultsFromCalcMessagesLength[1];
            var cc = messages[j].getCc().replace(/"[^"]*"/g,'').split(/,/);
            for (var k = 0; k < cc.length; k++) {
                if (cc[k].match(/</) != null) {
                    cc[k] = cc[k].match(/<([^>]*)/)[1];
                }
            }
            var reg = new RegExp(from, 'i');
            if ((variables.user + aliases).search(reg) != -1) {
                if (j == 0) {
                    youStartedTheConversation = true;
                    timeOfFirstMessage = date.getTime();
                }
                if (j > 0 && !youStartedTheConversation) {
                    if (!youReplied) {
                        youReplied = true;
                        // Use function from Utilities file
                        variables = calcWaitingTime_(variables, date, timeOfFirstMessage, youStartedTheConversation);
                    }
                }
                variables.nbrOfEmailsSent++;
                variables.timeOfEmailsSent[time]++;
                variables.dayOfEmailsSent[day]++;
                if (customReport) {
                    variables.monthOfEmailsSent[month]++;
                }
                var sharedWithTheOutsideWorld = false;
                var to = messages[j].getTo().replace(/"[^"]*"/g,'').split(/,/);
                for (var k = 0; k < to.length; k++) {
                    if (to[k].match(/</) != null) {
                        to[k] = to[k].match(/<([^>]*)/)[1];
                    }
                    if (to[k].search(variables.companyname) == -1){
                      sharedWithTheOutsideWorld = true;
                    }
                    var found = false;
                    for (var l = 0; l < people.length; l++) {
                        if (to[k] == people[l][0]) {
                            people[l][2]++;
                            found = true;
                        }
                    }
                    if (!found) {
                        people.push([to[k], 0, 1]);
                    }
                }
                if(!sharedWithTheOutsideWorld){
                  variables.sharedInternally++;
                }
            }
            else {
                if (j == 0) {
                    timeOfFirstMessage = date.getTime();
                }
                else if (youStartedTheConversation && !someoneAnswered) {
                    someoneAnswered = true;
                    // Use function from Utilities file
                    variables = calcWaitingTime_(variables, date, timeOfFirstMessage, youStartedTheConversation);
                }
                var found = false;
                for (var k = 0; k < people.length; k++) {
                    if (from == people[k][0]) {
                        people[k][1]++;
                        found = true;
                    }
                }
                if (!found) {
                    people.push([from, 1, 0]);
                }
                var to = messages[j].getTo().replace(/"[^"]*"/g,'');
                var checkSendToYou = false;
                var aliasesTemp = new Array(variables.user).concat(aliases.split(','));
                for(var k = 0; k < aliasesTemp.length; k++){
                    if(aliasesTemp[k] != ''){
                        var reg = new RegExp(aliasesTemp[k], 'i');
                        if (to.search(reg) != -1) {
                            checkSendToYou = true;
                        }
                    }
                }
                if(checkSendToYou)variables.sentDirectlyToYou++;
                var sharedWithTheOutsideWorld = false;
                to = to.split(/,/);
                for (var k = 0; k < to.length; k++) {
                    if (to[k].match(/</) != null) {
                        to[k] = to[k].match(/<([^>]*)/)[1];
                    }
                    if (to[k].search(variables.companyname) == -1){
                      sharedWithTheOutsideWorld = true;
                    }
                }
                if(sharedWithTheOutsideWorld == false && from.search(variables.companyname) != -1){
                  variables.sharedInternally++;
                }
                variables.nbrOfEmailsReceived++;
                variables.timeOfEmailsReceived[time]++;
                variables.dayOfEmailsReceived[day]++;
                if (customReport) {
                    variables.monthOfEmailsReceived[month]++;
                }
            }
            if (to != null) {
                to = to.toString();
            }
            if (cc != null) {
                cc = cc.toString();
            }
            var dayOfWeek = Utilities.formatDate(date, variables.userTimeZone, "EEEE");
            record.push([date, dayOfWeek, firstMessageSubject, from, to, cc, messageLength, location]);
        }
    }
    if (youStartedTheConversation) {
        variables.nbrOfConversationsStartedByYou++;
    }
    if (youReplied) {
        variables.nbrOfConversationsYouveRepliedTo++;
    }
}
variables.range += BATCH_SIZE;
ScriptProperties.setProperty("variables", Utilities.jsonStringify(variables));
sheets[0].getRange(1, 1, people.length, 3).setValues(people);
if (record[0] != undefined && sheets[1].getMaxRows() < 38000) {
    sheets[1].getRange(sheets[1].getLastRow() + 1, 1, record.length, record[0].length).setValues(record);
}
if (conversations.length < BATCH_SIZE) {
    sendReport_(variables);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T00:36:41.973

这是时区问题。转到您的 Google Drive 帐户上的 Gmail Meter 文件，然后：

文件 -> 电子表格设置...

将时区更改为您当前的时区。我假设您的 Gmail 帐户会自动更改时区，而不是您的电子表格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T14:02:30.863

错误表示和 day 为 0 变量。dayOfEmailsReceived 为空。不能引用 null 的索引。variables.dayOfEmailsReceived 是在 init_() 函数中创建的，因此请检查您是否定义了该函数并正确使用它。

# c# - C# 实体框架延迟加载未加载

> ID：10541235
> 
> 赞同：1
> 
> 时间：2012-05-10T19:57:38.813
> 
> 标签：c#, asp.net, entity-framework, lazy-loading

我已经完成了所有关于实体和延迟加载的阅读，以及这里的其他问题，但对于我的生活，我无法得到这个工作。这是我的数据库 SQL：

```
CREATE TABLE corporations(
corporationID bigint PRIMARY KEY
);

CREATE TABLE Character(
personID bigint PRIMARY KEY,
corporationID int NOT NULL,
FOREIGN KEY (corporationID) REFERENCES corporations(corporationID)
); 
```

以及获取它的实体代码（*** *EDITED from original，仍然损坏****）：

```
DBEntities context = new DBEntities();
public Character Character_GetByID(long CharacterID)
        {
            context.ContextOptions.LazyLoadingEnabled = true;
            Character character = context.Characters.Where(c => c.CharacterID == CharacterID).FirstOrDefault();      
            return character;
        } 
```

所以根据我的理解，有了这个我应该可以去

```
Character char = Character_GetByID(characterID);
Corporation corp = char.Corporation; 
```

“char.Corporation”对象存在，实体从外键正确创建它。但是当我运行上面的代码时，“corp”总是返回为 NULL（即使我确定相关的公司在数据库中）。

我确实注意到的一件事是，在自动生成的 Entity Character 对象中，它具有以下功能：

```
public virtual Corporation Corporation
        {
            get { return _corporation; }
            set
            {
                if (!ReferenceEquals(_corporation, value))
                {
                    var previousValue = _corporation;
                    _corporation = value;
                    FixupCorporation(previousValue);
                }
            }
        } 
```

这看起来很奇怪，因为我会假设通过延迟加载“get”函数将类似于“如果为空，则尝试从数据库中获取 Corporation”。任何想法将不胜感激。

****编辑**** 请求如何配置延迟加载：

在我的 Context 类中，对于我拥有的每个构造函数

```
this.ContextOptions.LazyLoadingEnabled = true; 
```

正如您从上面的第一个 C# 函数中看到的那样，我尝试在函数本身中将其设置为 true，就在查询它之前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:09:50.443

延迟加载是对象上下文（在您的情况下为 DBEntities 类实例）提供的功能。因此，它仅在实体对象附加到某些 DBEntities 实例时才起作用。当 Character_GetByID 方法完成时，上下文被释放，实体被分离，并且你的延迟加载请求无法执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:13:58.737

删除 using 语句，因为当您使用此 dbcontext 时立即释放

```
using (var context = new DBEntities())
{
   ...
}//context is disposed here... lazy loading is not possible 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:06:23.613

使用 .Include(x=> x.Corporation) ；

有关加载相关数据的一些信息。

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-应用](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-application)

# ruby-on-rails - 从对 super 的调用中清除块

> ID：10541242
> 
> 赞同：5
> 
> 时间：2012-05-10T19:58:08.563
> 
> 标签：ruby-on-rails, ruby, active-attr

我正在使用 ActiveAttr，它通过块选项为您提供了很好的初始化：

```
person = Person.new() do |p|
  p.first_name = 'test'
  p.last_name = 'man'
end 
```

但是，在包含 ActiveAttr::Model 的特定类中，我想绕过此功能，因为我想将该块用于其他用途。所以我们开始：

```
class Imperator::Command
 include ActiveAttr::Model
end

class MyCommand < Imperator::Command

  def initialize(*args, &block)
    @my_block = block

    super(*args)
  end
end 
```

这惨遭失败，因为块仍然被传递到链上，最终在 ActiveAttr 内部，这段代码被运行：

```
def initialize(*)
  super
  yield self if block_given?
end 
```

所以如果我的电话看起来像这样：

```
MyCommand.new() { |date| date.advance(month: 1) } 
```

它失败如下：

```
NoMethodError: undefined method `advance' for #<MyCommand:0x007fe432c4fb80> 
```

由于 MyCommand 没有方法 :advance 它，因此对 MyCommand 的调用显然失败了。

所以我的问题是，有没有一种方法可以在我`super`再次调用之前从方法签名中删除该块，以便该块不会比我重写的初始化程序更远？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-10T20:07:43.457

尝试

```
super(*args,&nil) 
```

& 使 ruby​​ 使用 nil 作为块，而 ruby​​ 似乎足够聪明，可以意识到这意味着没有块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T20:01:17.373

这当然是一个巧妙的技巧，但更好的方法是不直接使用 ActiveAttr::Model 模块，而只包含您需要的模块。

而不是

```
class Imperator::Command
  include ActiveAttr::Model
end 
```

做

```
class Imperator::Command
  include BasicModel
  # include BlockInitialization
  include Logger
  include MassAssignmentSecurity
  include AttributeDefaults
  include QueryAttributes
  include TypecastedAttributes

  def initialize(*args, &block)
    @my_block = block
    super(*args)
  end
end 
```

一旦你看到 ActiveAttr::Model 正在做的分解图，可能还有其他你不想要的东西。在这种情况下，只需简单地省略包含。其目的是为模型构建提供一个点菜的方法。

# javascript - JS中的深度属性？

> ID：10541244
> 
> 赞同：1
> 
> 时间：2012-05-10T19:58:14.090
> 
> 标签：javascript, html, dom

假设我有这个 html 代码：

```
<div>
 <a>
    <span id="a"> </span>
 </a>
</div> 
```

我的问题 ：

是否有任何暴露元素深度的js**属性？**

就像是 ：

```
$("#a").prop ("depth") //3+3=6   +body+form+html   jquery selector is just for example. 
```

*ps 我知道如何计算深度。我的问题是关于现有财产。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T20:00:00.670

你可以这样做：

```
$('#a').first().parents().length 
```

根据**zzzzBov**的评论进行编辑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T20:04:25.050

> 是否有任何暴露元素深度的 js 属性？

不是内置的，没有。您总是可以使用`defineGetter`and制作一个`defineSetter`。

# java - 将方法的名称用于哈希表值？

> ID：10541245
> 
> 赞同：2
> 
> 时间：2012-05-10T19:58:15.523
> 
> 标签：java, methods, hashtable

我创建了一个哈希表，它将作为键保存一个字符串，该字符串将表示用户将提供的方法的名称，并将实际方法调用的值作为字符串也作为字符串。我正在使用的代码是这里的代码：

```
public void getMethod(String givenMethod){

    Map<String, String> methods = new HashMap<String, String>();
    methods.put("length", "length();");

    methods.get(givenMethod);

} 
```

从主方法我调用 objectX.getMethod("length");，但方法​​ length(); 不执行。有人能帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:05:24.270

You are getting the method but you are not invoking it. You'll have to do something like this:

```
Method yourMethod = objectX.getClass().getDeclaredMethod("yourMethodName"); //This is the string that represents the name of the method. 
```

Then you invoke the method. All this through reflection:

```
yourMethod.invoke(YourObject); 
```

The parameter of the invoke method is first the object, and then the attributes.

You can also get the return type of the method and cast the result, since the invoking the method will result in an Object type method:

```
yourMethod.getReturnType(); //This line gives you the type returned by your method. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:25:55.470

使用 Java **reflection 按名称调用方法
（如您所说，您将方法名称存储在地图中）。
有关更多详细信息，请阅读以下文章：http: [//java.sun.com/developer/technicalArticles/ALT/Reflection/](http://java.sun.com/developer/technicalArticles/ALT/Reflection/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:02:47.937

您需要使用反射按名称调用方法。所以你的数据结构看起来更像

```
Map<String, Method> meth = new Hashmap<String,Method>(); 
```

其中[Method](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Method.html)是一个实际的对象。

# asp.net-mvc - 使用 LinqToSql 创建 DataContext - 在类中存储集合会导致内存问题吗？

> ID：10541257
> 
> 赞同：0
> 
> 时间：2012-05-10T19:59:37.690
> 
> 标签：asp.net-mvc, linq-to-sql, garbage-collection, datacontext

我在 .net 进程内存不足的应用程序中遇到了一些问题。我在应用程序中所做的一项更改是向 Sql 类添加了很多 Linq。我想知道我如何创建 DataContext 是否存在问题。

我可以在需要时通过创建数据上下文来创建我的数据上下文。显然，如果我要更改数据，我会创建一个变量并保存数据上下文，因为我需要在多个语句中使用相同的数据上下文。

**技术1**

```
public class SchoolRepository
{

    DataBaseDataContext GetCtx()
    {
        return new DataBaseDataContext();
    }

    public List<School> GetSchools()
    {
        return GetCtx().Schools.ToList();
    }
} 
```

这是我可以创建 DataContext 的另一种方法。在这种情况下，我有一个类字段，其中包含对 DataContext 的引用。

**技术2：**

```
 public class SchoolRepository
    {
        private DataBaseDataContext _ctx = null;
        DataBaseDataContext ctx
        {
            get { return _ctx = (_ctx ?? new DataBaseDataContext()); }
        }

        public List<School> GetSchools()
        {
            return ctx.Schools.ToList();
        }

    } 
```

我一直在使用第二种方式（使用类变量），我想知道这是否会导致上下文比第一种方式停留更长的时间——因为只要我的类的一个实例它就会持续存在卡在周围。

也许我在这里抓住了稻草——但我想知道一种方式是否比另一种方式“更安全”。

# c - C - 使用 -Wall 编译不会警告未初始化的变量

> ID：10541258
> 
> 赞同：4
> 
> 时间：2012-05-10T19:59:39.750
> 
> 标签：c, llvm-gcc

我有一个示例有缺陷的程序，它应该给出一个关于未初始化变量的警告，但是当我编译它时 gcc 并没有给我任何警告。

这是代码：

```
#include <stdio.h>

int main()
{
    int foo;

    printf("I am a number: %d \n", foo);

    return 0;
} 
```

这是我运行的：`cc -Wall testcase.c -o testcase`

我没有得到任何反馈。据我所知，这应该产生：

```
testcase.c: In function 'main': 
testcase.c:7: warning: 'foo' is used uninitialized in this function 
```

在他的 C 教程中的一个[类似示例](http://c.learncodethehardway.org/book/learn-c-the-hard-waych4.html#x9-270004.3)中，它似乎正确地警告了 Zed Shaw ）。这是我第一次尝试并注意到它没有按预期工作的示例。

有任何想法吗？

**编辑：**

gcc 版本：

```
i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.1.00) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-10T20:01:07.937

您是否在打开优化的情况下进行编译？这是我的`man gcc`页面所说的：

> ```
>  -Wuninitialized
>        Warn if an automatic variable is used without first being
>        initialized or if a variable may be clobbered by a "setjmp" call.
> 
>       These warnings are possible only in optimizing compilation, because
>        they require data flow information that is computed only when
>        optimizing.  If you do not specify -O, you will not get these
>        warnings. Instead, GCC will issue a warning about -Wuninitialized
>        requiring -O. 
> ```

我的 gcc 版本是：

```
i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.1.00) 
```

实际上，我只是在 gcc 4.4.5 上尝试过这个，但我*确实*在不使用`-O`. 所以这取决于你的编译器版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:01:49.997

更新你的编译器。

```
$ cat test.c
#include <stdio.h>

int main(void)
{
    int foo;
    printf("I am a number: %d \n", foo);
    return 0;
} 
```

```
$ gcc -Wall -o test ./test.c
./test.c: In function ‘main’:
./test.c:7:11: warning: ‘foo’ is used uninitialized in this function [-Wuninitialized]
$ gcc -v
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.6.1/lto-wrapper
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu/Linaro 4.6.1-9ubuntu3' --with-bugurl=file:///usr/share/doc/gcc-4.6/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++,go --prefix=/usr --program-suffix=-4.6 --enable-shared --enable-linker-build-id --with-system-zlib --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.6 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-plugin --enable-objc-gc --disable-werror --with-arch-32=i686 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 4.6.1 (Ubuntu/Linaro 4.6.1-9ubuntu3) 
$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:05:27.557

C 标准不要求编译器在访问未初始化的变量时发出警告。如果程序调用未定义的行为（假设没有语法错误并且没有违反约束），编译器甚至不需要发出警告。

您可以使用`gcc`为未初始化的变量启用警告`-Wuninitialized`。正如其他人指出的那样，在指定时启用最新版本的`gcc`, 。`-Wuninitialized``-Wall`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-30T12:56:53.497

使用[Clang](http://clang.llvm.org)，完成它。似乎是 GCC 中的一个错误，因为 Clang 会发出应有的警告。

# asp.net-mvc-3 - 提交表单 MVC3 .Net 时出错

> ID：10541259
> 
> 赞同：0
> 
> 时间：2012-05-10T19:59:43.930
> 
> 标签：asp.net-mvc-3, forms, properties, razor, model

您好，当我提交以下表格时出现错误：

```
<div id="tabs">
  <ul>
    <li><a href="@Url.Action("MainDetails", "ProjectDetails")">Project Details</a></li>
    <li><a href="@Url.Action("ProjectAttachments", "ProjectAttachments")">Project Attachments</a></li>
    <li><a href="@Url.Action("Members", "ProjectNetwork", new { IsTab = true })">Project
        Network</a></li>
    <li><a href="@Url.Action("BulletingBoard", "BulletingBoard")">Bulleting Board</a></li>
    <li><a href="@Url.Action("BidsReceived", "Bids")">Bids Received</a></li>
</ul>
</div>
  <div id="LowerButton">
    @Html.Hidden("MainStatus", @Model.Status)
@using (@Html.BeginForm("Dashboard", "Dashboard"))
{     
    <button type="button" id="MakeComment">
        Make a Comment
    </button>  
    <input type="submit" id="GoDashBoard" value="Return to Project List" />
}
</div> 
```

当我按下按钮“GoDashBoard”时，未达到控制器“仪表板”中的“仪表板”方法。而是出现以下错误：

![错误](../Images/39b485d6f46103a868532602f03ac84c.png)

它告诉我模型属性已发送到服务器。但是，仪表板表单中没有模型属性.. 除非我同时发送许多表单。但我不认为这是可能的，对吧？你们知道为什么在我实际上没有发送任何东西时尝试设置模型属性吗？

更新：

这是仪表板操作的输入：

```
 public ActionResult Dashboard(int page = 1)
    {
        var user = (User)Session["User"];
        if (user != null)
        {...
    }} 
```

输入是默认整数。但是，我看到了调用的痕迹及其提交的另一种形式，该形式与我使用的那个无关： ![在此处输入图像描述](../Images/94bf41eb82fe2d3de3e1e4e8381d7dce.png)

该表单位于其中一个 ajax 选项卡中。我不明白一个表单如何提交另一个表单并且它们没有嵌套。任何人都知道一个好的解决方法？因为我想在两种操作中都接收这两种形式并进行一些验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T23:19:28.953

我通过删除“仪表板”表单并添加一个不可见的链接来解决它。该按钮将引用不可见的链接：

```
@*@using (@Html.BeginForm("Dashboard", "Dashboard"))
     {  *@   
    <button type="button" id="MakeComment">
        Make a Comment
    </button>  
    <button name="button" type="button" onclick="document.location.href=$('#GoDashBoard').attr('href')">Return to Project List</button>
    <a id="GoDashBoard" href="@Url.Action("Dashboard", "Dashboard")" style="display:none;"></a>

    @*<input type="submit" id="GoDashBoard" value="Return to Project List" />*@
@*  }*@ 
```

# windows - 使用 CryptoAPI 进行 CA 固定

> ID：10541262
> 
> 赞同：1
> 
> 时间：2012-05-10T19:59:56.567
> 
> 标签：windows, pki, cryptoapi

我正在使用 CryptoAPI（特别是 CertGetCertificateChain 和 CertVerifyCertificateChainPolicy）验证 SSL 服务器证书。

我想限制我将接受来自哪些 CA 的签名，即 CA Pinning。

有没有办法让我自己的代码将根证书与可接受的证书列表进行比较？

# extjs - EXTJS setFieldLabel，对于fieldcontainer，添加样式display:block到label和break设计

> ID：10541266
> 
> 赞同：1
> 
> 时间：2012-05-10T20:00:21.860
> 
> 标签：extjs, styles

我正在将此代码用于表单：

```
{
    xtype: 'fieldcontainer',
    name: 'Label1',
    itemid: 'Label1',
    labelStyle: 'font-weight:bold;padding:0',
    labelWidth: 150,
    margin: '5 0 0 0',
    layout: {
        type: 'hbox',
        align: 'stretchmax'
    },

    style: { display: 'marker !important' }

    fieldDefaults: {
        labelAlign: 'top'
    },

    defaults: { width: 400 },
    fieldLabel: 'Teste de label',

    items: [
        { id: 'txtID', name: 'txtName', fieldLabel: 'Field Label', allowBlank: true, labelWidth: 150, xtype: 'textfield', enforceMaxLength: true, maxLength: 10, flex: 1, margin: '0 0 0 5' }
        , { id: 'txtID2', name: 'txtName2', fieldLabel: 'Field Label2', allowBlank: true, labelWidth: 150, xtype: 'textfield', flex: 1, margin: '0 0 0 5' }
    ]
} 
```

这在屏幕上看起来不错，但是，我需要动态更改 FieldContainer 标签内容。所以我正在做以下事情：

```
 obj = Ext.getCmp('ID');
 obj.setFieldLabel("New label text"); 
```

FieldContainer 获取新的标签文本，但 Ext 将样式：添加`display:block`到包含标签的表 TD 中。然后字段出现在标签上。

是否可以让 Ext 不添加这种样式？我尝试添加样式：`{ display: 'marker !importat' }`但没有用

# asp.net - html: FBML 命名空间

> ID：10541267
> 
> 赞同：0
> 
> 时间：2012-05-10T20:00:33.123
> 
> 标签：asp.net, fbml

我们正在使用具有集成 Facebook“登录”功能的应用程序。出于某种原因，仅 IE 7 浏览器的应用程序崩溃。如果在母版页中我们添加：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://www.facebook.com/2008/fbml"> 
```

一切开始正常。这是否意味着我们在某处使用 fbml 对象？如果是这样，目前还不清楚 - 为什么它适用于其他浏览器......而且我记得从 6 月 6 日开始，facebook 将不再支持 fbml。在那种情况下，可以参考吗

```
xmlns:fb="http://www.facebook.com/2008/fbml? Will it work after June 6? 
```

任何帮助，将不胜感激。

谢谢，

彼得。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:15:42.903

FBML 和 XFBML 是不同的。

FBML 将于 6 月 6 日被移除，而不是 XFBML。

您可以将其用作您的命名空间

`xmlns:fb="http://ogp.me/ns/fb#"`

# c# - HttpWebRequest POST 数据

> ID：10541270
> 
> 赞同：1
> 
> 时间：2012-05-10T20:00:46.627
> 
> 标签：c#, httpwebrequest

是否可以像浏览器一样在 C# 中使用 HttpWebRequest 进行完全相同的 POST？没有一个页面能够检测到它实际上不是浏览器？

如果是这样，我可以阅读更多吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:06:48.153

下载并熟悉[Fiddler](http://www.fiddler2.com/fiddler2/)等工具。它允许您检查从应用程序发出的 Web 请求，如普通浏览器，并准确查看正在发送的内容。然后，您可以模拟使用 C# 创建的请求发送的数据，为标头、cookie 等提供值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:06:37.400

我认为这是可行的。

浏览器检测是基于请求中的标头完成的。您需要做的就是设置该标题。在 HttpWebRequest 中，我们不需要设置 headers 集合，而是设置 .UserAgent 属性。

例如：

```
.UserAgent = "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)"; 
```

用户代理有很多。检查[此](http://www.user-agents.org/)链接以获取用户代理的完整列表

有用的链接：

[如何在 C# 中创建一个简单的代理？](https://stackoverflow.com/questions/226784/how-to-create-a-simple-proxy-in-c)
[WebRequest 是与网站交互的正确 C# 工具吗？](https://stackoverflow.com/questions/91275/is-webrequest-the-right-c-sharp-tool-for-interacting-with-websites)
[http://codehelp.smartdev.eu/2009/05/08/improve-webclient-by-adding-useragent-and-cookies-to-your-requests/](http://codehelp.smartdev.eu/2009/05/08/improve-webclient-by-adding-useragent-and-cookies-to-your-requests/)

# javascript - 下划线js替换对象中的项目

> ID：10541275
> 
> 赞同：1
> 
> 时间：2012-05-10T20:01:14.180
> 
> 标签：javascript, node.js, underscore.js

使用 Underscorejs，有人知道如何简单地替换对象的一个​​属性吗？

例如，如果我有这个：

```
var obj = {
 "id" : 123,
 "date" : 142002020,
 "name" : "somename",
 "active" : 1
} 
```

现在我想将 active 设置为 0；

我可以使用`_.collect`并检查“活动”然后更新它并返回到一个新变量，但似乎有更好的方法，我只是没有看到它。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T20:02:55.033

你为什么不只是`obj['active'] = 0`，你不需要下划线来改变一个属性。

**编辑**

如果您需要找到一个嵌套键，也许您可​​以使用递归函数。

```
var obj = {
   'foo' : {
      'bar' : {
         'active' : 1
      }
   }
}

function replaceKey (obj, key, value) {
   var _obj = _(obj)

    _obj.each(function (v, k) {
      if (k === key) {
         obj[k] = value
      } else if (obj[k] === Object(obj[k])) {
         replaceKey(obj[k], key, value)
      }
   })

   return _obj;
}

console.log('should be active:', obj.foo.bar.active === 1)
replaceKey(obj, 'active', 0)
console.log('should not be active:', obj.foo.bar.active === 0) 
```

# vb.net - 重新获取 POP3 消息

> ID：10541276
> 
> 赞同：0
> 
> 时间：2012-05-10T20:01:17.877
> 
> 标签：vb.net, pop3

我正在使用[Peter Huber 的 POP3 客户端](http://www.codeproject.com/Articles/15611/POP3-Email-Client-with-full-MIME-Support-NET-2-0)连接到 gmail 并下载消息。

被访问的收件箱是仅用于代码访问的事务性收件箱。也就是说，一条消息附带一个订单文件，代码将处理它然后删除该消息。代码的一个规定是一个 DEBUG 标志，如果设置该标志，它将阻止代码删除消息，以便您以后可以在没有调试标志的情况下再次运行程序并重新处理消息。所以，在我的代码中，我有

`If Not Arguments.Debug Then pop.DeleteEmail(eid)`

这工作正常。问题是，即使不删除邮件，第二次运行程序也不会重新检索邮件，即使我登录 gmail 并查看收件箱，它仍然存在。我可以让程序再次看到该消息的唯一方法是将消息转发回同一个收件箱。但是在彼得的代码中，我看不到他在任何地方跟踪会话之间看到的消息。

这是在gmail结束时完成的吗？拒绝第二次向同一个客户发送消息？如果是这样，有什么方法可以更改我的 gmail 帐户，以便在检索邮件列表时始终向客户显示收件箱中的所有邮件，即使是已经“看到”的邮件？我在 gmail 设置屏幕中看不到任何内容。

**更新**：我尝试添加一种方法来将 RSET 命令发送到服务器，根据codeproject 页面上的[此评论。](http://www.codeproject.com/Articles/15611/POP3-Email-Client-with-full-MIME-Support-NET-2-0?msg=3477014#xx3477014xx)然后我在检索我的消息后但在断开连接之前调用我的新`Reset()`方法，......但我仍然有同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:29:35.287

好的......在阅读了关于 codeproject 项目的评论页面后，找到了一个“有点”的答案。

根据[此评论](http://www.codeproject.com/Articles/15611/POP3-Email-Client-with-full-MIME-Support-NET-2-0?msg=2680937#xx2680937xx)，当您处理 gmail 的服务器时，RSET 命令实际上并没有做任何事情。

“答案”是在您的用户名前加上字符串“recent:”，因此您无需使用 [ **myaccount@gmail.com** ] 登录，而是使用 [ **recent:myaccount@gmail.com** ] 登录。相当hackish，......但它有效。

# apache - 正则表达式 - 301 重定向

> ID：10541278
> 
> 赞同：0
> 
> 时间：2012-05-10T20:01:23.543
> 
> 标签：apache, .htaccess, mod-rewrite

我想将我的一个域重定向到另一个域。我有一个域，例如

`http://www.test-url.com`

`http://test-url.com`

现在我有如下网址： `http://test-url.com/category/hoodies.html`

我希望这个（以及所有其他类别的 url 或子 url）url 被重定向到： `http://www.test-url.com/category/hoodies.html`

目前，所有像：这样的网址`http://testurl.com/category/hoodies.html`都被重定向到`http://www.testurl.com`- 没有类别页面。

我用这段代码试过了，但它不起作用。我想问题是，重写条件也与 www.-domain 匹配......对吗？

```
RewriteCond %{HTTP_HOST} ^test-url.com$ [NC]
RewriteCond %{HTTP_HOST} ^testurl.com$ [NC]
RewriteRule ^(.*)$ http://www.test-url.com/$1 [R=301,L] 
```

我用这样的否定尝试过：

```
RewriteCond %{HTTP_HOST} !^www.test-url.com$ [NC] 
```

这行得通，但我不能这样做，因为涉及另一个域......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:07:39.910

Replace your code with this:

```
RewriteCond %{HTTP_HOST} ^test-?url\.com$ [NC]
RewriteRule ^ http://www.test-url.com%{REQUEST_URI} [R=301,L] 
```

# c# - 将递归代码转换为 LINQ

> ID：10541280
> 
> 赞同：1
> 
> 时间：2012-05-10T20:01:37.850
> 
> 标签：c#, linq

我想将此递归调用转换为 LINQ，但我不确定如何执行最后两个条件。请告知如何添加最后两个条件。

```
private void findGoogleOrganic(HtmlNode node)
  {
          if (node.Attributes["class"] != null)
          {
              if (node.Attributes["class"].Value.ToString().Contains("r ld"))
              {
                  String tmp;
                  tmp = node.ParentNode.InnerHtml.ToString();
                  bool condition1 = false;
                  bool condition2 = false;

                  if (tmp != null)
                  {
                      **condition1 = tmp.Contains("qcp47e");
                      condition2 = tmp.Contains("r ld");**
                  }

                  **if (condition1 == false && condition2 == true)**
                  { 
                      GoogleOrganicResults.Add(new Result(URLGoogleOrganic, Listing, node, SearchEngine.Google, SearchType.Organic, ResultType.Website));

                  }
              }
            }

              if (node.HasChildNodes)
              {
                  foreach (HtmlNode children in node.ChildNodes)
                  {
                      findGoogleOrganic(children);
                  }
              }
          } 
```

这是我没有最后两个条件的第一次尝试：

```
 private void findGoogleOrganicLINQ(HtmlNode node)
  {
      var results = node.Descendants()
             .Where(x => x.Attributes["class"] != null &&
                        x.Attributes["class"].Value.Contains("r ld"))
             .Select(x => new Result(URLGoogleLocal, Listing, x, SearchEngine.Google, SearchType.Local, ResultType.GooglePlaces));

      foreach (Result x in results)
      {
          GoogleOrganicResults.Add(x);
      }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:09:55.250

```
if(node.HasChildNodes)
{
     node.ChildNodes.ForEach(findGoogleOrganic);
} 
```

# audio - 从音频文件中删除回声的最佳方法是什么？

> ID：10541282
> 
> 赞同：3
> 
> 时间：2012-05-10T20:02:03.170
> 
> 标签：audio, core-audio, audio-streaming, voip

我想通过类似Skype的回声消除功能运行音频文件。iChat 和其他 VoIP 也具有此功能，但我找不到任何可以导入或打开文件的软件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:29:28.720

基本方法：

确定延迟。确定幅度偏移。

反转信号。应用延迟。调整幅度。播放两个音频文件。

任何多轨音频应用程序都能够做到这一点（例如大胆、原型或逻辑）。

对于更复杂的信号，您需要更加聪明地进行过滤，理想情况下，您会在信号干扰之前抑制信号（在 Skype 场景中）。

* * *

> 听起来很酷，理论上很有意义，但我仍然不知道我应该如何去做。我对逻辑相当有经验，但我不知道如何确定延迟。我应该只复制文件，将其反转并移动它直到听起来不错吗？

只需直观地排列 2 个信号的瞬态即可确定延迟。然后您必须放大并确定*样本*的延迟以实现最佳消除。如果未关闭，则不会取消，而是*添加*.

> 幅度偏移是什么意思，是原始噪声和回声噪声之间的音量差异吗？

确切地。除了非常不寻常的情况外，回波的幅度将与源不同（通常更低），您需要知道这种差异才能最好地消除它（这个偏移量应用于反相信号，顺便说一句）。如果幅度错误，那么您将引入反相信号（可听见），或者在奇怪的情况下，回声比声源响亮，只减少部分回声。

一旦瞬变（与样本）对齐并且信号反转，然后确定音量差异 - 如果它太高或太低，它不会尽可能多地消除。

同样，这是一种基本方法。您可以做很多事情来改进它，这取决于您拥有的信号和处理器。在大多数情况下，这种方法将导致*抑制*，而不是消除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T05:57:01.513

为了消除回声，您需要**两个**文件：mic 和 reference。麦克风是包含回声的信号。参考是包含产生回声的原始音频的信号。

拥有这两个文件后，您就可以开始构建回声消除的逻辑了。从有关该主题的 wiki 页面开始。

# django - django-paypal 没有 subscr_payment 的信号

> ID：10541283
> 
> 赞同：0
> 
> 时间：2012-05-10T20:02:06.987
> 
> 标签：django, paypal, django-paypal

我正在研究 django-paypal IPN 源代码，我意识到它没有 subscr_payment 交易类型的信号。

我可以假设如果我收到一条 subscr_signup IPN 消息，支付成功了吗？

我的信号处理程序

```
def subscription_succesful(sender, **kwargs):
ipn_obj = sender

if ipn_obj.payment_status == "Completed":
    user = User.objects.get(pk=ipn_obj.custom)
    business = Business.objects.get(user=user)
    business.active = True
    business.save()

subscription_signup.connect(subscription_succesful) 
```

这目前不起作用，因为 ipn_obj.payment_status 未在 subscr_signup IPN 消息中发送。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:49:46.213

我刚刚使用 Django Paypal 集成了订阅 paypal 模块。支付状态已完成，它为 subscr_payment 调用以下 IPN 信号 subscription_signup 和 recurring_payment 信号。但是仍在处理它并且在通知贝宝已收到所有信号时遇到问题。付款后您是否从贝宝收到重复信号？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-01T16:27:14.300

我知道你的帖子很老了。`payment_status`不是订阅的有效标签。

```
def subscription_succesful(sender, **kwargs):
  ipn_obj = sender

  if ipn_obj.txn_type == "subscr_signup":
    user = User.objects.get(pk=ipn_obj.custom)
    business = Business.objects.get(user=user)
    business.active = True
    business.save()

 subscription_signup.connect(subscription_succesful) 
```

# c# - 在mysql中有没有办法让加载数据infile忽略bom？

> ID：10541284
> 
> 赞同：0
> 
> 时间：2012-05-10T20:02:07.477
> 
> 标签：c#, mysql, sql, csv, load-data-infile

我检查了mysql站点，似乎有很多人在谈论这个，但尚未提供解决方案。问题是 MySQL 将 BOM 作为 csv 内容的一部分，这会导致不可预测的结果。

我不想自己剥离 BOM，因为我有非常大的文件（很多 GB）和其中的几个。如果没有答案，任何关于好工具的建议都将受到欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T23:46:57.473

检查下面看看是否可以解决 byteordermark 问题
[http://forge.mysql.com/worklog/task.php?id=2637](http://forge.mysql.com/worklog/task.php?id=2637)

1.  使用“BYTEORDER”子句
2.  “SELECT ... INTO OUTFILE 不会生成 BOM。”

# php - 使用 php dom 获取属性值

> ID：10541286
> 
> 赞同：0
> 
> 时间：2012-05-10T20:02:09.513
> 
> 标签：php, json, xpath, domdocument

我试图获得一些属性值。但是没有机会。下面你可以看到我的代码和解释。如何获取持续时间、文件等值？

```
$url="http://www.some-url.ltd";

    $dom = new DOMDocument;
    @$dom->loadHTMLFile($url);
    $xpath = new DOMXPath($dom);
    $the_div = $xpath->query('//div[@id="the_id"]');
    foreach ($the_div as $rval) {
        $the_value = trim($rval->getAttribute('title'));
        echo $the_value;
    } 
```

下面的输出：

```
{title:'title',
                description:'description',
                scale:'fit',keywords:'',
                file:'http://xxx.ccc.net/ht/2012/05/10/419EE45F98CD63F88F52CE6260B9E85E_c.mp4',
                type:'flv',
                duration:'24',
                screenshot:'http://xxx.ccc.net/video/2012/05/10/419EE45F98CD63F88F52CE6260B9E85E.jpg?v=1336662169',
                suggestion_path:'/videoxml/player_xml/61319',
                showSuggestions:true,
                autoStart:true,
                width:412,
                height:340,
                autoscreenshot:true,
                showEmbedCode:true,
                category: 1,
                showLogo:true
                                                } 
```

如何获取持续时间、文件等值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:14:01.350

关于什么

```
$parsed = json_decode($the_value, true);
$duration = $parsed['duration']; 
```

编辑：由于 json_decode() 需要正确的 JSON 格式（键名和值必须用双引号括起来），我们应该将原始格式修复为正确的格式。所以这里是代码：

```
function my_json_decode($s, $associative = false) {
$s = str_replace(array('"', "'", 'http://'), array('\"', '"', 'http//'), $s);
        $s = preg_replace('/(\w+):/i', '"\1":', $s);
        $s = str_replace('http//', 'http://', $s);
        return json_decode($s, $associative);
}

$parsed = my_json_decode($var, true); 
```

函数 my_json_decode 取自[这个答案](https://stackoverflow.com/questions/1575198/invalid-json-parsing-using-php/1575315#1575315)，稍作修改。

# parsing - 具有讽刺意味的 AST 生成引发空引用异常

> ID：10541289
> 
> 赞同：4
> 
> 时间：2012-05-10T20:02:19.973
> 
> 标签：parsing, irony

我开始使用 Irony（版本 Irony_2012_03_15），但在尝试生成 AST 时我很快就卡住了。下面是一个抛出异常的完全约束语言：

```
[Language("myLang", "0.1", "Bla Bla")]
    public class MyLang: Grammar {
        public NModel()
            : base(false) {

            var number = TerminalFactory.CreateCSharpNumber("number");
            var binExpr = new NonTerminal("binExpr", typeof(BinaryOperationNode));
            var binOp = new NonTerminal("BinOp");

            binExpr.Rule = number + binOp + number;
            binOp.Rule = ToTerm("+");
            RegisterOperators(1, "+");
            //MarkTransient(binOp);
            this.Root = binExpr;
            this.LanguageFlags = Parsing.LanguageFlags.CreateAst; // if I uncomment this line it throws the error
        }
    } 
```

一旦我取消注释最后一行，它就会在语法资源管理器中或当我想解析测试时抛出 NullReferenceException。错误在 AstBuilder.cs 第 96 行：

```
 parseNode.AstNode = config.DefaultNodeCreator(); 
```

DefaultNodeCreator 是一个尚未设置的委托。

我试过用 MarkTransient 等设置东西，但没有骰子。

有人可以帮我在这里漂浮吗？我可能遗漏了一些明显的东西。在整个网络上寻找 AST 教程，但我似乎无法找到有关其工作原理的解释。

提前致谢，

格特-扬

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T23:37:17.587

在语法上设置`LanguageFlags.CreateAst`标志后，您必须提供有关如何创建 AST 的附加信息。

你应该能够设置`AstContext.Default*Type`整个语言，但目前有问题。

*   设置`TermFlags.NoAstNode`。Irony 将忽略此节点及其子节点。

*   设置`AstConfig.NodeCreator`。这是一个可以做正确事情的代表。

*   设置`AstConfig.NodeType`为 AstNode 的类型。这种类型应该是可访问的、实现`IAstInit`的，并且有一个公共的、无参数的构造函数。在这种情况下，可访问意味着要么`public`或`internal`带有`InternalsVisibleTo`属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-19T12:16:24.000

老实说，我遇到了同样的问题并且不理解 Jay Bazuzi 的答案，尽管它看起来像是有效的（也许它已经过时了）。

如果有人像我一样；

我刚刚从 `Irony.Interpreter.InterpretedLanguageGrammar`课堂上继承了我的语法，并且它有效。此外，任何试图让 AST 工作的人，请确保您的节点是“公共的”:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-27T18:59:55.623

除了 Jay 和 Erti-Chris 的回复之外，这个帖子也很有用：

[https://irony.codeplex.com/discussions/361018](https://irony.codeplex.com/discussions/361018)

Irony 的创建者在`InterpretedLanguageGrammar.BuildAst`.

高温高压

# sql-server-2008 - BULK INSERT 从逗号分隔的字符串

> ID：10541290
> 
> 赞同：4
> 
> 时间：2012-05-10T20:02:23.087
> 
> 标签：sql-server-2008, csv, bulkinsert

我有一个表格，其中一列包含以下数据：

```
abc,2,2,34,5,3,2,34,32,2,3,2,2
def,2,2,34,5,3,2,34,32,2,3,2,2 
```

我想获取这些数据并将其插入到另一个表中，使用逗号作为分隔符，就像您可以指定`FIELDTERMINATOR`in`BULK INSERT`语句一样。

有没有办法使用 T-SQL 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:28:14.650

您需要使用`Split`函数将字符串拆分为表变量，然后将这些值插入表中。

那里有**大量**的拆分函数，具有各种优缺点以及各种数量的参数等等。

[这是我非常喜欢的一个](https://web.archive.org/web/20120902003525/http://blog.logiclabz.com/sql-server/split-function-in-sql-server-to-break-comma-separated-strings-into-table.aspx)- 做得非常好，解释清楚。

使用该功能，您应该可以轻松地将列转换为其他表的单独条目。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T20:37:21.760

我不确定在 T-SQL 中是否有任何直接的方法，但如果你想使用批量插入，你可以使用`sqlcmd`导出到 CSV 文件，然后使用批量插入将文件导入服务器。

创建一个`dbo.Split`Functionm，你可以参考这里[split string into multiple record](https://stackoverflow.com/questions/314824/t-sql-opposite-to-string-concatenation-how-to-split-string-into-multiple-reco) 有很多很好的例子。

如果您想作为批处理执行，您可以执行`sqlcmd`并“批量插入”

```
sqlcmd -S MyServer -d myDB -E -Q "select dbo.Split(col1) from SomeTable" 
       -o "MyData.csv" -h-1 -s"," -w 700

-s"," sets the column seperator to 

bulk insert destTable
from "MyData.csv"
with 
(
  FIELDTERMINATOR = ',',
  ROWTERMINATOR = '\n'
) 
```

否则，您可以直接在 T-SQL 中进行操作，但前提是您具有相同的列定义标识。

```
 INSERT INTO DestinationTable
 SELECT dbo.Split(col1) FROM SomeTable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-18T20:33:16.137

编辑：允许多个字符分隔符

这就是我解决它的方法，使用两个函数来拆分成列（如果您还想要一个更完整的行拆分解决方案，[请参阅我的另](https://stackoverflow.com/questions/44514202/how-to-pass-string-to-bulk-insert-instead-of-file/45176375#45176375)一篇文章）。它涉及：

*   `fSubstrNth`给定分隔符，用于提取行的第 n 个字段的标量函数 ( )
*   `fPatIndexMulti`用于查找分隔符的第 n 个索引的标量函数 ( )
*   （可选）`Right`接受负值的替代函数
*   最后，在您的解决方案中使用一些特定的代码，因为 SQL 不允许动态表函数定义（换句话说，您不能`SELECT`使用具有动态列的函数）

现在，对于代码片段：

**fSubstrNth**

```
-- =============================================
-- Author:      Bernardo A. Dal Corno
-- Create date: 18/07/2017
-- Description: substring com 2 PatIndex limitando inicio e fim
-- =============================================
CREATE FUNCTION fSubstrNth
(
  @Text varchar(max),
  @Sep varchar(3),
  @N int --Nth campo
)
RETURNS varchar(max)
AS
BEGIN
  DECLARE @Result varchar(max)

  IF @N<1 RETURN ''
  IF @N=1
    SET @Result = substring(@Text, 1, dbo.fPatIndexMulti(@Sep,@Text,1)-1)
  ELSE
    SET @Result = substring(@Text, dbo.fPatIndexMulti(@Sep,@Text,@N-1)+LEN(@Sep), CASE WHEN dbo.fPatIndexMulti(@Sep,@Text,@N)>0 THEN dbo.fPatIndexMulti(@Sep,@Text,@N)-dbo.fPatIndexMulti(@Sep,@Text,@N-1)-LEN(@Sep) ELSE LEN(@Text)+1 END)

  RETURN @Result
END 
```

**fPatIndexMulti**

```
-- =============================================
-- Author:      Bernardo A. Dal Corno
-- Create date: 17/07/2017
-- Description: recursive patIndex
-- =============================================
CREATE FUNCTION [dbo].[fPatIndexMulti]
(
  @Find varchar(max),
  @In varchar(max),
  @N tinyint
)
RETURNS int
AS
BEGIN
  DECLARE @lenFind int, @Result int, @Texto varchar(max), @index int
  DECLARE @i tinyint=1

  SET @lenFind = LEN(@Find)-1
  SET @Result = 0
  SET @Texto = @In
  WHILE (@i <= @N) BEGIN
    SET @index = patindex('%'+@Find+'%',@Texto)
      IF @index = 0 RETURN 0
    SET @Result = @Result + @index
    SET @Texto = dbo.xRight(@Texto, (@index + @lenFind)*-1)

    SET @i = @i + 1
  END
  SET @Result = @Result + @lenFind*(@i-2)

  RETURN @Result
END 
```

**右**

```
-- =============================================
-- Author:      Bernardo A. Dal Corno
-- Create date: 06/01/2015
-- Description: Right inverso (para nros < 0)
-- =============================================
CREATE FUNCTION [dbo].[xRight] 
(
  @Texto varchar(8000),
  @Qntd int
)
RETURNS varchar(8000)
AS
BEGIN
  DECLARE @Result varchar(8000)

  IF (Len(@Texto) = 0) OR (@Qntd = 0)
    SET @Result = ''
  ELSE IF (@Qntd > 0) 
      SET @Result = Right(@Texto, @Qntd)
    ELSE IF (@Qntd < 0)
    SET @Result = Right(@Texto, Len(@Texto) + @Qntd)

  RETURN @Result
END 
```

**具体代码**

```
SELECT 
     acolumn = 'any value',
     field1 = dbo.fSubstrNth(table.datacolumn,',',1),
     field2 = dbo.fSubstrNth(table.datacolumn,',',2),
     anothercolumn = 'set your query as you would normally do',
     field3 = (CASE dbo.fSubstrNth(table.datacolumn,',',3) WHEN 'C' THEN 1 ELSE 0 END)
FROM table 
```

注意：

*   `fSubstrNth`接收要从“数据列”中提取的第 n 个字段
*   查询可以与任何其他查询一样。这意味着它可以存储在过程、表格函数、视图等中。您可以按您希望的任何顺序提取部分或全部字段，并按您希望的方式进行处理
*   如果在存储过程中使用，您可以创建一个通用的方法来创建一个查询和临时表，以加载带有动态列的字符串，但是您必须调用另一个过程才能使用数据或创建一个特定的查询，如上面相同的过程（这将使它成为非通用的，只是更可重用）

# variables - 如何在makefile中指定编译器？

> ID：10541293
> 
> 赞同：2
> 
> 时间：2012-05-10T20:02:29.840
> 
> 标签：variables, compiler-construction, build, makefile

全部，

我正在尝试修改 Makefile 以使用嵌入式交叉编译器而不是 PC 的编译器。Makfile 没有正常的 CC 或 CXX 变量。事实上，它似乎调用了另一个带有变量'@${MAKE}'的makefile。如何覆盖“@${MAKE}”变量以强制 makefile 使用不同的编译器？

提前致谢，

```
# GNU Make solution makefile autogenerated by Premake
# Type "make help" for usage help

ifndef config
config=debug
endif
export config

    PROJECTS := json openjaus

.PHONY: all clean help $(PROJECTS)

all: $(PROJECTS)

json: 
@echo "==== Building json ($(config)) ===="
@${MAKE} --no-print-directory -C .build -f json.make

openjaus: json
    @echo "==== Building openjaus ($(config)) ===="
    @${MAKE} --no-print-directory -C .build -f openjaus.make 
```

我根据 Rob 的评论编辑了 Makefile，现在我收到以下消息，不知道该怎么办？

```
make[1]: Nothing to be done for `/home/botbear/openwrt/trunk/staging_dir/toolchain-arm_v6k_gcc-linaro_uClibc-0.9.32_eabi/bin/arm-openwrt-linux-uclibcgnueabi-g++'. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:04:31.520

You'd have to look inside `json.make` and `openjaus.make` to see how they build programs. If they use the conventional variables, you might be able to do something like:

```
${MAKE} CC=/usr/bin/gcc-arm CXX=/usr/bin/g++-arm --no-parent-directory ... 
```

# database - 如何在依赖关系图中指定外键

> ID：10541295
> 
> 赞同：1
> 
> 时间：2012-05-10T20:02:45.130
> 
> 标签：database, normalization

我只需要知道外键是如何定义的。

当我创建图表时，我知道主键应该加下划线，但外键是如何定义的？是否也有下划线？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:04:43.303

For a dependency diagram you use a dashed underline.

# php - “意外的 T_STRING”？

> ID：10541297
> 
> 赞同：-1
> 
> 时间：2012-05-10T20:02:48.653
> 
> 标签：php, parsing

```
echo "Info: <input type=\"text\" name=\"titel\"> value=\" . $row['titel'] . "\">" . "<br />"; 
```

为什么显示：

> 解析错误：语法错误，意外的 T_STRING，期待 ',' 或 ';' 在 /home/lokachan/public_html/andravisaform.php 第 24 行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:03:51.010

改成：

```
echo "Info: <input type=\"text\" name=\"titel\"> value=\"" . $row['titel'] . "\">" . "<br />"; 
```

您在 a`"`之后缺少 a `\"`。

我宁愿把它写成：

```
echo 'Info: <input type="text" name="titel"> value="' . $row['titel'] . '"><br />'; 
```

现在你不需要那么多逃跑了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:03:35.240

你错过了一个报价

```
echo "Info: <input type=\"text\" name=\"titel\"> value=\"" . $row['titel'] . "\">" . "<br />"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:09:08.117

这样可以节省您的打字时间

```
$input = "<input type=\"text\" name=\"%s\" value=\"%s\"><br \/>";

echo sprintf ( $input, "title1",$row ['titel'] );
echo sprintf ( $input, "title2",$row ['tite2'] ); 
```

# c++ - C++ - 临时变量及其生命周期

> ID：10541299
> 
> 赞同：6
> 
> 时间：2012-05-10T20:02:56.907
> 
> 标签：c++, qt, variables, destructor, lifetime

*这个问题可以被认为是以下问题的后续问题：[C++ 临时变量生命周期](https://stackoverflow.com/questions/10540157/c-temporary-variable-lifetime)。*

`Qt`容器支持`stream-like`初始化语法。现在，当我编写以下代码时， my`QVector`在赋值后立即被破坏，并且引用变得悬空。

```
const QVector<QString>& v = QVector<QString>() << "X" << "Y" << "Z"; 
```

* * *

对应`operator<<`的实现方式如下：

```
inline QVector<T> &operator<< (const T &t)
{ append(t); return *this; } 
```

据我所知，`10.4.10 Temporary Objects`声明临时对象的生命周期已延长以匹配对其的相应`const`引用的生命周期。

但是，在这种情况下，临时对象`QVector<QString>()` **会提前销毁。**

我想这可能是由于最后一个操作返回 a`QVector<QString>&`并且不应该知道有关临时的生命周期的事实`QVector<QString>`，但是这种解释并不严格并且可能是错误的。

**那么，为什么会发生这种情况？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-10T20:20:16.680

仅当绑定到 const-reference 时才会延长临时对象的生命周期：

```
const QVector<QString>& v = QVector<QString>(); 
```

但是，在您的代码中，您*没有*将临时绑定到任何东西。相反，您正在调用一个成员函数（临时的），它返回一个引用（对临时的）。这个函数调用的结果不再是一个临时对象，而只是一个普通的引用。原始临时对象在它出现的完整表达式结束时过期，并且引用`v`变得悬空。

（在新的 C++ 中，可以通过右值限定的成员函数来禁止此类“意外”，即您可以`=delete`使用右值版本的`<<`运算符。）

# delphi - 用于静态数组的 Delphi 记录运算符

> ID：10541300
> 
> 赞同：1
> 
> 时间：2012-05-10T20:03:00.543
> 
> 标签：delphi, delphi-xe2

有没有办法让这样的工作？

```
program Project1;

{$APPTYPE CONSOLE}

{$R *.res}

uses
  System.SysUtils;

type
  TMyRecord = record
    class operator Explicit(const a: array of integer): TMyRecord;
  end;

{ TMyRecord }

class operator TMyRecord.Explicit(const a: array of integer): TMyRecord;
begin
end;

var
  a: array[0..100] of integer;
begin
  TMyRecord(a);  //Incompatible types: 'array of Integer' and 'array[0..100] of Integer
end. 
```

“TMyRecord.Explicit(const a: TIntegerDynArray)”适用于 TIntegerDynArray，但我无法让静态数组工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T22:20:36.057

如果您将静态数组声明为一种类型，它可以工作（好吧，编译）：

```
program Project1;

{$APPTYPE CONSOLE}

uses
  System.SysUtils;

type 
  TMyArray = array[0..100] of Integer;  

  TMyRecord = record 
    class operator Explicit(const a: TMyArray): TMyRecord; 
  end; 

class operator TMyRecord.Explicit(const a: TMyArray): TMyRecord; 
begin 
end; 

var 
  a: TMyArray; 

begin 
  TMyRecord(a); 
end;

end. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:11:37.837

我会说这是一个编译器错误/限制，你没有办法解决它。

我试过`Slice`这样使用：

```
TMyRecord(Slice(a, Length(a))); 
```

这导致此编译器错误：

```
E2193 Slice standard function only allowed as open array argument 
```

因此编译器无法识别显式运算符需要一个开放数组参数。

一个简单的方法调用而不是一个运算符就可以了，这进一步让我相信编译器根本不会玩球。

如果你不能使用开放数组，那么你就没有干净的出路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T09:00:34.910

另一种方法是通过变量的地址转换为指针类型：

```
type 
  PMyRecord = ^TMyRecord;

// ...

begin
  PMyRecord(@a).DoWhatever;
end; 
```

# mysql - SQL 语句问题

> ID：10541301
> 
> 赞同：1
> 
> 时间：2012-05-10T20:03:11.563
> 
> 标签：mysql, sql

以下 SQL 代码返回时选择的所有内容均为 NULL，event_size 为 0。我的表已根据以下条件正确设置。我在这里做错了什么？谢谢您的帮助

```
SELECT table_one.event_id AS event_id, table_one.event_name AS event_name, table_one.event_address AS event_address, COUNT( table_two.user_id ) AS event_size
FROM table_one
JOIN table_two
ON table_one.event_id = table_two.event_id 
WHERE (
       table_one.event_start_date =  '5/10/2012'
    OR table_one.event_mid_date =  '5/10/2012'
    OR table_one.event_end_date =  '5/10/2012'
)
ORDER BY event_size DESC 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:59:40.757

尝试添加一个 group by 子句：

```
group by table_one.event_id, table_one.event_name, table_one.event_address 
```

这应该做你想要的。

# php - 在 Codeigniter 中加载 PHPExcel 的问题

> ID：10541304
> 
> 赞同：1
> 
> 时间：2012-05-10T20:03:32.273
> 
> 标签：php, codeigniter, phpexcel

我正在尝试将 PHPExcel 与 Codeigniter 一起使用，但遇到了问题。我从 PHPExcel 下载中提取了类文件，并将它们放在 Codeigniter 的“应用程序/库”文件夹中。

但是，当我尝试加载必要的库时：

```
 $this->load->library('PHPExcel');
    $this->load->library('PHPExcel/IOFactory'); 
```

我收到错误“不存在的类：IOFactory”。

我检查了 iofactory 文件是否在 PHPExcel 文件中，并且它就在那里。我应该将课程放在其他地方吗？我还有什么做错的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T12:20:30.797

尝试这样的事情：

```
$this->load->library('PHPExcel');
$xl_obj = new PHPExcel();
$reader = PHPExcel_IOFactory::createReader('Excel5');
$reader->setReadDataOnly(true);
$file = $reader->load('/PATH/FILENAME.EXT'); 
```

有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T07:25:33.853

我的方法是将 PHPExcel 文件夹放在*/application/libraries文件夹中，然后在**库*文件夹中创建一个包装文件；

**PHPExcel.php**

```
<?php
/**
 * PHPExcel
 *
 * Copyright (c) 2006 - 2011 PHPExcel
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * @category   PHPExcel
 * @package    PHPExcel
 * @copyright  Copyright (c) 2006 - 2011 PHPExcel (http://www.codeplex.com/PHPExcel)
 * @license    http://www.gnu.org/licenses/old-licenses/lgpl-2.1.txt    LGPL
 * @version    1.7.6, 2011-02-27
 */

/** PHPExcel root directory */
if (!defined('PHPEXCEL_ROOT')) {
    define('PHPEXCEL_ROOT', dirname(__FILE__) . '/');
    require(PHPEXCEL_ROOT . 'PHPExcel/Autoloader.php');
}

/**
 * PHPExcel
 *
 * @category   PHPExcel
 * @package    PHPExcel
 * @copyright  Copyright (c) 2006 - 2011 PHPExcel (http://www.codeplex.com/PHPExcel)
 */
class PHPExcel
{
    /**
     * Document properties
     *
     * @var PHPExcel_DocumentProperties
     */
    private $_properties;

    /**
     * Document security
     *
     * @var PHPExcel_DocumentSecurity
     */
    private $_security;

    /**
     * Collection of Worksheet objects
     *
     * @var PHPExcel_Worksheet[]
     */
    private $_workSheetCollection = array();

    /**
     * Active sheet index
     *
     * @var int
     */
    private $_activeSheetIndex = 0;

    /**
     * Named ranges
     *
     * @var PHPExcel_NamedRange[]
     */
    private $_namedRanges = array();

    /**
     * CellXf supervisor
     *
     * @var PHPExcel_Style
     */
    private $_cellXfSupervisor;

    /**
     * CellXf collection
     *
     * @var PHPExcel_Style[]
     */
    private $_cellXfCollection = array();

    /**
     * CellStyleXf collection
     *
     * @var PHPExcel_Style[]
     */
    private $_cellStyleXfCollection = array();

    /**
     * Create a new PHPExcel with one Worksheet
     */
    public function __construct()
    {
        // Initialise worksheet collection and add one worksheet
        $this->_workSheetCollection = array();
        $this->_workSheetCollection[] = new PHPExcel_Worksheet($this);
        $this->_activeSheetIndex = 0;

        // Create document properties
        $this->_properties = new PHPExcel_DocumentProperties();

        // Create document security
        $this->_security = new PHPExcel_DocumentSecurity();

        // Set named ranges
        $this->_namedRanges = array();

        // Create the cellXf supervisor
        $this->_cellXfSupervisor = new PHPExcel_Style(true);
        $this->_cellXfSupervisor->bindParent($this);

        // Create the default style
        $this->addCellXf(new PHPExcel_Style);
        $this->addCellStyleXf(new PHPExcel_Style);
    }

    public function disconnectWorksheets() {
        foreach($this->_workSheetCollection as $k => &$worksheet) {
            $worksheet->disconnectCells();
            $this->_workSheetCollection[$k] = null;
        }
        unset($worksheet);
        $this->_workSheetCollection = array();
    }

    /**
     * Get properties
     *
     * @return PHPExcel_DocumentProperties
     */
    public function getProperties()
    {
        return $this->_properties;
    }

    /**
     * Set properties
     *
     * @param PHPExcel_DocumentProperties   $pValue
     */
    public function setProperties(PHPExcel_DocumentProperties $pValue)
    {
        $this->_properties = $pValue;
    }

    /**
     * Get security
     *
     * @return PHPExcel_DocumentSecurity
     */
    public function getSecurity()
    {
        return $this->_security;
    }

    /**
     * Set security
     *
     * @param PHPExcel_DocumentSecurity $pValue
     */
    public function setSecurity(PHPExcel_DocumentSecurity $pValue)
    {
        $this->_security = $pValue;
    }

    /**
     * Get active sheet
     *
     * @return PHPExcel_Worksheet
     */
    public function getActiveSheet()
    {
        return $this->_workSheetCollection[$this->_activeSheetIndex];
    }

    /**
     * Create sheet and add it to this workbook
     *
     * @return PHPExcel_Worksheet
     */
    public function createSheet($iSheetIndex = null)
    {
        $newSheet = new PHPExcel_Worksheet($this);
        $this->addSheet($newSheet, $iSheetIndex);
        return $newSheet;
    }

    /**
     * Add sheet
     *
     * @param PHPExcel_Worksheet $pSheet
     * @param int|null $iSheetIndex Index where sheet should go (0,1,..., or null for last)
     * @return PHPExcel_Worksheet
     * @throws Exception
     */
    public function addSheet(PHPExcel_Worksheet $pSheet = null, $iSheetIndex = null)
    {
        if(is_null($iSheetIndex))
        {
            $this->_workSheetCollection[] = $pSheet;
        }
        else
        {
            // Insert the sheet at the requested index
            array_splice(
                $this->_workSheetCollection,
                $iSheetIndex,
                0,
                array($pSheet)
                );

            // Adjust active sheet index if necessary
            if ($this->_activeSheetIndex >= $iSheetIndex) {
                ++$this->_activeSheetIndex;
            }

        }
        return $pSheet;
    }

    /**
     * Remove sheet by index
     *
     * @param int $pIndex Active sheet index
     * @throws Exception
     */
    public function removeSheetByIndex($pIndex = 0)
    {
        if ($pIndex > count($this->_workSheetCollection) - 1) {
            throw new Exception("Sheet index is out of bounds.");
        } else {
            array_splice($this->_workSheetCollection, $pIndex, 1);
        }
    }

    /**
     * Get sheet by index
     *
     * @param int $pIndex Sheet index
     * @return PHPExcel_Worksheet
     * @throws Exception
     */
    public function getSheet($pIndex = 0)
    {
        if ($pIndex > count($this->_workSheetCollection) - 1) {
            throw new Exception("Sheet index is out of bounds.");
        } else {
            return $this->_workSheetCollection[$pIndex];
        }
    }

    /**
     * Get all sheets
     *
     * @return PHPExcel_Worksheet[]
     */
    public function getAllSheets()
    {
        return $this->_workSheetCollection;
    }

    /**
     * Get sheet by name
     *
     * @param string $pName Sheet name
     * @return PHPExcel_Worksheet
     * @throws Exception
     */
    public function getSheetByName($pName = '')
    {
        $worksheetCount = count($this->_workSheetCollection);
        for ($i = 0; $i < $worksheetCount; ++$i) {
            if ($this->_workSheetCollection[$i]->getTitle() == $pName) {
                return $this->_workSheetCollection[$i];
            }
        }

        return null;
    }

    /**
     * Get index for sheet
     *
     * @param PHPExcel_Worksheet $pSheet
     * @return Sheet index
     * @throws Exception
     */
    public function getIndex(PHPExcel_Worksheet $pSheet)
    {
        foreach ($this->_workSheetCollection as $key => $value) {
            if ($value->getHashCode() == $pSheet->getHashCode()) {
                return $key;
            }
        }
    }

    /**
     * Set index for sheet by sheet name.
     *
     * @param string $sheetName Sheet name to modify index for
     * @param int $newIndex New index for the sheet
     * @return New sheet index
     * @throws Exception
     */
    public function setIndexByName($sheetName, $newIndex)
    {
        $oldIndex = $this->getIndex($this->getSheetByName($sheetName));
        $pSheet = array_splice(
            $this->_workSheetCollection,
            $oldIndex,
            1
            );
        array_splice(
            $this->_workSheetCollection,
            $newIndex,
            0,
            $pSheet
            );
        return $newIndex;
    }

    /**
     * Get sheet count
     *
     * @return int
     */
    public function getSheetCount()
    {
        return count($this->_workSheetCollection);
    }

    /**
     * Get active sheet index
     *
     * @return int Active sheet index
     */
    public function getActiveSheetIndex()
    {
        return $this->_activeSheetIndex;
    }

    /**
     * Set active sheet index
     *
     * @param int $pIndex Active sheet index
     * @throws Exception
     * @return PHPExcel_Worksheet
     */
    public function setActiveSheetIndex($pIndex = 0)
    {
        if ($pIndex > count($this->_workSheetCollection) - 1) {
            throw new Exception("Active sheet index is out of bounds.");
        } else {
            $this->_activeSheetIndex = $pIndex;
        }
        return $this->getActiveSheet();
    }

    /**
     * Set active sheet index by name
     *
     * @param string $pValue Sheet title
     * @return PHPExcel_Worksheet
     * @throws Exception
     */
    public function setActiveSheetIndexByName($pValue = '')
    {
        if (($worksheet = $this->getSheetByName($pValue)) instanceof PHPExcel_Worksheet) {
            $this->setActiveSheetIndex($worksheet->getParent()->getIndex($worksheet));
            return $worksheet;
        }

        throw new Exception('Workbook does not contain sheet:' . $pValue);
    }

    /**
     * Get sheet names
     *
     * @return string[]
     */
    public function getSheetNames()
    {
        $returnValue = array();
        $worksheetCount = $this->getSheetCount();
        for ($i = 0; $i < $worksheetCount; ++$i) {
            array_push($returnValue, $this->getSheet($i)->getTitle());
        }

        return $returnValue;
    }

    /**
     * Add external sheet
     *
     * @param PHPExcel_Worksheet $pSheet External sheet to add
     * @param int|null $iSheetIndex Index where sheet should go (0,1,..., or null for last)
     * @throws Exception
     * @return PHPExcel_Worksheet
     */
    public function addExternalSheet(PHPExcel_Worksheet $pSheet, $iSheetIndex = null) {
        if (!is_null($this->getSheetByName($pSheet->getTitle()))) {
            throw new Exception("Workbook already contains a worksheet named '{$pSheet->getTitle()}'. Rename the external sheet first.");
        }

        // count how many cellXfs there are in this workbook currently, we will need this below
        $countCellXfs = count($this->_cellXfCollection);

        // copy all the shared cellXfs from the external workbook and append them to the current
        foreach ($pSheet->getParent()->getCellXfCollection() as $cellXf) {
            $this->addCellXf(clone $cellXf);
        }

        // move sheet to this workbook
        $pSheet->rebindParent($this);

        // update the cellXfs
        foreach ($pSheet->getCellCollection(false) as $cellID) {
            $cell = $pSheet->getCell($cellID);
            $cell->setXfIndex( $cell->getXfIndex() + $countCellXfs );
        }

        return $this->addSheet($pSheet, $iSheetIndex);
    }

    /**
     * Get named ranges
     *
     * @return PHPExcel_NamedRange[]
     */
    public function getNamedRanges() {
        return $this->_namedRanges;
    }

    /**
     * Add named range
     *
     * @param PHPExcel_NamedRange $namedRange
     * @return PHPExcel
     */
    public function addNamedRange(PHPExcel_NamedRange $namedRange) {
        if ($namedRange->getScope() == null) {
            // global scope
            $this->_namedRanges[$namedRange->getName()] = $namedRange;
        } else {
            // local scope
            $this->_namedRanges[$namedRange->getScope()->getTitle().'!'.$namedRange->getName()] = $namedRange;
        }
        return true;
    }

    /**
     * Get named range
     *
     * @param string $namedRange
     * @param PHPExcel_Worksheet|null $pSheet Scope. Use null for global scope
     * @return PHPExcel_NamedRange|null
     */
    public function getNamedRange($namedRange, PHPExcel_Worksheet $pSheet = null) {
        $returnValue = null;

        if ($namedRange != '' && !is_null($namedRange)) {
            // first look for global defined name
            if (isset($this->_namedRanges[$namedRange])) {
                $returnValue = $this->_namedRanges[$namedRange];
            }

            // then look for local defined name (has priority over global defined name if both names exist)
            if (!is_null($pSheet) && isset($this->_namedRanges[$pSheet->getTitle() . '!' . $namedRange])) {
                $returnValue = $this->_namedRanges[$pSheet->getTitle() . '!' . $namedRange];
            }
        }

        return $returnValue;
    }

    /**
     * Remove named range
     *
     * @param string $namedRange
     * @param PHPExcel_Worksheet|null $pSheet. Scope. Use null for global scope.
     * @return PHPExcel
     */
    public function removeNamedRange($namedRange, PHPExcel_Worksheet $pSheet = null) {
        if (is_null($pSheet)) {
            if (isset($this->_namedRanges[$namedRange])) {
                unset($this->_namedRanges[$namedRange]);
            }
        } else {
            if (isset($this->_namedRanges[$pSheet->getTitle() . '!' . $namedRange])) {
                unset($this->_namedRanges[$pSheet->getTitle() . '!' . $namedRange]);
            }
        }
        return $this;
    }

    /**
     * Get worksheet iterator
     *
     * @return PHPExcel_WorksheetIterator
     */
    public function getWorksheetIterator() {
        return new PHPExcel_WorksheetIterator($this);
    }

    /**
     * Copy workbook (!= clone!)
     *
     * @return PHPExcel
     */
    public function copy() {
        $copied = clone $this;

        $worksheetCount = count($this->_workSheetCollection);
        for ($i = 0; $i < $worksheetCount; ++$i) {
            $this->_workSheetCollection[$i] = $this->_workSheetCollection[$i]->copy();
            $this->_workSheetCollection[$i]->rebindParent($this);
        }

        return $copied;
    }

    /**
     * Implement PHP __clone to create a deep clone, not just a shallow copy.
     */
    public function __clone() {
        foreach($this as $key => $val) {
            if (is_object($val) || (is_array($val))) {
                $this->{$key} = unserialize(serialize($val));
            }
        }
    }

    /**
     * Get the workbook collection of cellXfs
     *
     * @return PHPExcel_Style[]
     */
    public function getCellXfCollection()
    {
        return $this->_cellXfCollection;
    }

    /**
     * Get cellXf by index
     *
     * @param int $index
     * @return PHPExcel_Style
     */
    public function getCellXfByIndex($pIndex = 0)
    {
        return $this->_cellXfCollection[$pIndex];
    }

    /**
     * Get cellXf by hash code
     *
     * @param string $pValue
     * @return PHPExcel_Style|false
     */
    public function getCellXfByHashCode($pValue = '')
    {
        foreach ($this->_cellXfCollection as $cellXf) {
            if ($cellXf->getHashCode() == $pValue) {
                return $cellXf;
            }
        }
        return false;
    }

    /**
     * Get default style
     *
     * @return PHPExcel_Style
     * @throws Exception
     */
    public function getDefaultStyle()
    {
        if (isset($this->_cellXfCollection[0])) {
            return $this->_cellXfCollection[0];
        }
        throw new Exception('No default style found for this workbook');
    }

    /**
     * Add a cellXf to the workbook
     *
     * @param PHPExcel_Style
     */
    public function addCellXf(PHPExcel_Style $style)
    {
        $this->_cellXfCollection[] = $style;
        $style->setIndex(count($this->_cellXfCollection) - 1);
    }

    /**
     * Remove cellXf by index. It is ensured that all cells get their xf index updated.
     *
     * @param int $pIndex Index to cellXf
     * @throws Exception
     */
    public function removeCellXfByIndex($pIndex = 0)
    {
        if ($pIndex > count($this->_cellXfCollection) - 1) {
            throw new Exception("CellXf index is out of bounds.");
        } else {
            // first remove the cellXf
            array_splice($this->_cellXfCollection, $pIndex, 1);

            // then update cellXf indexes for cells
            foreach ($this->_workSheetCollection as $worksheet) {
                foreach ($worksheet->getCellCollection(false) as $cellID) {
                    $cell = $worksheet->getCell($cellID);
                    $xfIndex = $cell->getXfIndex();
                    if ($xfIndex > $pIndex ) {
                        // decrease xf index by 1
                        $cell->setXfIndex($xfIndex - 1);
                    } else if ($xfIndex == $pIndex) {
                        // set to default xf index 0
                        $cell->setXfIndex(0);
                    }
                }
            }
        }
    }

    /**
     * Get the cellXf supervisor
     *
     * @return PHPExcel_Style
     */
    public function getCellXfSupervisor()
    {
        return $this->_cellXfSupervisor;
    }

    /**
     * Get the workbook collection of cellStyleXfs
     *
     * @return PHPExcel_Style[]
     */
    public function getCellStyleXfCollection()
    {
        return $this->_cellStyleXfCollection;
    }

    /**
     * Get cellStyleXf by index
     *
     * @param int $pIndex
     * @return PHPExcel_Style
     */
    public function getCellStyleXfByIndex($pIndex = 0)
    {
        return $this->_cellStyleXfCollection[$pIndex];
    }

    /**
     * Get cellStyleXf by hash code
     *
     * @param string $pValue
     * @return PHPExcel_Style|false
     */
    public function getCellStyleXfByHashCode($pValue = '')
    {
        foreach ($this->_cellXfStyleCollection as $cellStyleXf) {
            if ($cellStyleXf->getHashCode() == $pValue) {
                return $cellStyleXf;
            }
        }
        return false;
    }

    /**
     * Add a cellStyleXf to the workbook
     *
     * @param PHPExcel_Style $pStyle
     */
    public function addCellStyleXf(PHPExcel_Style $pStyle)
    {
        $this->_cellStyleXfCollection[] = $pStyle;
        $pStyle->setIndex(count($this->_cellStyleXfCollection) - 1);
    }

    /**
     * Remove cellStyleXf by index
     *
     * @param int $pIndex
     * @throws Exception
     */
    public function removeCellStyleXfByIndex($pIndex = 0)
    {
        if ($pIndex > count($this->_cellStyleXfCollection) - 1) {
            throw new Exception("CellStyleXf index is out of bounds.");
        } else {
            array_splice($this->_cellStyleXfCollection, $pIndex, 1);
        }
    }

    /**
     * Eliminate all unneeded cellXf and afterwards update the xfIndex for all cells
     * and columns in the workbook
     */
    public function garbageCollect()
    {
        // how many references are there to each cellXf ?
        $countReferencesCellXf = array();
        foreach ($this->_cellXfCollection as $index => $cellXf) {
            $countReferencesCellXf[$index] = 0;
        }

        foreach ($this->getWorksheetIterator() as $sheet) {

            // from cells
            foreach ($sheet->getCellCollection(false) as $cellID) {
                $cell = $sheet->getCell($cellID);
                ++$countReferencesCellXf[$cell->getXfIndex()];
            }

            // from row dimensions
            foreach ($sheet->getRowDimensions() as $rowDimension) {
                if ($rowDimension->getXfIndex() !== null) {
                    ++$countReferencesCellXf[$rowDimension->getXfIndex()];
                }
            }

            // from column dimensions
            foreach ($sheet->getColumnDimensions() as $columnDimension) {
                ++$countReferencesCellXf[$columnDimension->getXfIndex()];
            }
        }

        // remove cellXfs without references and create mapping so we can update xfIndex
        // for all cells and columns
        $countNeededCellXfs = 0;
        foreach ($this->_cellXfCollection as $index => $cellXf) {
            if ($countReferencesCellXf[$index] > 0 || $index == 0) { // we must never remove the first cellXf
                ++$countNeededCellXfs;
            } else {
                unset($this->_cellXfCollection[$index]);
            }
            $map[$index] = $countNeededCellXfs - 1;
        }
        $this->_cellXfCollection = array_values($this->_cellXfCollection);

        // update the index for all cellXfs
        foreach ($this->_cellXfCollection as $i => $cellXf) {
            $cellXf->setIndex($i);
        }

        // make sure there is always at least one cellXf (there should be)
        if (count($this->_cellXfCollection) == 0) {
            $this->_cellXfCollection[] = new PHPExcel_Style();
        }

        // update the xfIndex for all cells, row dimensions, column dimensions
        foreach ($this->getWorksheetIterator() as $sheet) {

            // for all cells
            foreach ($sheet->getCellCollection(false) as $cellID) {
                $cell = $sheet->getCell($cellID);
                $cell->setXfIndex( $map[$cell->getXfIndex()] );
            }

            // for all row dimensions
            foreach ($sheet->getRowDimensions() as $rowDimension) {
                if ($rowDimension->getXfIndex() !== null) {
                    $rowDimension->setXfIndex( $map[$rowDimension->getXfIndex()] );
                }
            }

            // for all column dimensions
            foreach ($sheet->getColumnDimensions() as $columnDimension) {
                $columnDimension->setXfIndex( $map[$columnDimension->getXfIndex()] );
            }
        }

        // also do garbage collection for all the sheets
        foreach ($this->getWorksheetIterator() as $sheet) {
            $sheet->garbageCollect();
        }
    }

} 
```

然后在我的控制器中；

```
$this->load->library('PHPExcel');
// Create new PHPExcel object
$excel_obj = new PHPExcel();

// Set properties
$excel_obj->getProperties()->setCreator($params['author'])
            ->setLastModifiedBy($params['author'])
            ->setTitle($params['title'])
            ->setSubject($params['subject'])
            ->setDescription($params['description']); 
```

# blackberry - 如何在 BlackBerry 中为 LabelField 设置透明背景

> ID：10541306
> 
> 赞同：0
> 
> 时间：2012-05-10T20:03:36.767
> 
> 标签：blackberry, label, transparent

我正在尝试创建一个`LabelField`完全没有背景的，作为一个透明的。我用位图为我的屏幕设置了一个背景，我想让我的`LabelField`透明。

我有以下代码，但它不起作用。

```
BitmapField info;
EncodedImage logoBitmap = EncodedImage.getEncodedImageResource("userInfo.png");
info = new BitmapField(null, Field.FIELD_LEFT |Field.FIELD_BOTTOM);
info.setImage(logoBitmap);
AbsoluteFieldManager superMainContainer;
superMainContainer.add(info,0,200);
LabelField  nameLabel = new LabelField("Name:");
nameLabel.setBackground(BackgroundFactory.createSolidTransparentBackground(0, 0));
superMainContainer.add(nameLabel, 10, 210); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T10:21:05.493

*[更新]*

以下代码片段正在我的模拟器上运行。以下与您的代码之间的区别只是一些初始化代码。

```
Bitmap bm = Bitmap.getBitmapResource("image.png");
BitmapField info = new BitmapField(bm, Field.FIELD_LEFT 
        | Field.FIELD_BOTTOM);

LabelField  lbl = new LabelField("LabelField Text");
lbl.setBackground(BackgroundFactory.createSolidTransparentBackground(0, 0));

AbsoluteFieldManager superMainContainer = new AbsoluteFieldManager();
superMainContainer.add(info, 0, 200);
superMainContainer.add(lbl, 10, 210);

MainScreen screen = new MainScreen();
screen.add(superMainContainer);

UiApplication.getUiApplication().pushScreen(screen); 
```

*[老的]*

```
LabelField  lbl;
lbl.setBackground(BackgroundFactory.createSolidTransparentBackground(0, 0)); 
```

您没有在***应用***之前初始化`LabelField`-nameLabel 。*`Background`*

 *而且您不需要设置任何`Background`实例来获取透明背景，默认值`LabelField`将适用于这种情况。*

# jsp - JSP 中 request.getParameter() 无法访问 Servlet 中 request.setAttribute() 设置的值

> ID：10541311
> 
> 赞同：0
> 
> 时间：2012-05-10T20:04:14.350
> 
> 标签：jsp, servlets, parameters, attributes, parameter-passing

我在单击表单按钮后向控制器 servlet 发送请求，它需要检查用户是否已登录以及按下了哪个按钮。

第一部分工作正常，但是当我试图将结果设置为参数并将请求转发到 JSP 页面时，参数“Button”总是返回 null。有人可以帮我理解为什么会这样吗？也许有更好的方法来做到这一点？

小服务程序：

```
request.setAttribute("Buttons", "Add a new coupon");
request.getRequestDispatcher("/admin_main.jsp").forward(request,response); 
```

JSP：

```
if (request.getParameter("Buttons") != null) {
    // ...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T03:39:34.617

`if(request.getAttribute("Buttons") != null)`将工作。

信息：

总是`request.getParameter()`提取请求参数（即通过发布 html 表单发送的数据）。总是返回字符串值，`request.getParameter()`数据来自客户端。

始终用于`request.getAttribute()`获取添加到服务器端请求范围的对象，即使用`request.setAttribute()`.

# css - 做这种阴影的最佳方法？

> ID：10541315
> 
> 赞同：7
> 
> 时间：2012-05-10T20:04:39.343
> 
> 标签：css, drop-shadow

我有一个网站，其中有一列图像和 div（两者的混合）总是相同的大小。

在所有这些上，我想添加某种阴影（如此处所示）： ![在此处输入图像描述](../Images/996368248c6dae0c6ea7a9ee2acd4f62.png)

我使用过 CSS 阴影，但我从未在 CSS 中看到过这样的阴影。这可以在 CSS 中完成吗？假设它不能，那么我猜我只会使用阴影切片作为图形，可能是背景。如果这是唯一的路线，我如何将其应用于每个图像或 div？

现在我正在做的是在每个图像或 div 下放置一个 div：

```
<div class="rightimgdropshadow">&nbsp;</div> 
```

...并在 CSS 中执行此操作：.rightimgdropshadow

```
{
    background-image: url(../images/site-structure/right-col-image-shadow.jpg);
    background-repeat: no-repeat;
    background-position: center top;
    width 100%
    height: 20px;
} 
```

有一个更好的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-10T20:14:03.010

如果您更喜欢使用 CSS 来创建这种类型的阴影，您可以使用 CSS3，如此[处所示！](http://nicolasgallagher.com/css-drop-shadows-without-images/demo/)

**CSS**

```
/* Lifted corners */

.lifted {
    -moz-border-radius:4px; 
         border-radius:4px;
}

.lifted:before,
.lifted:after { 
    bottom:15px;
    left:10px;
    width:50%;
    height:20%;
    max-width:300px;
    -webkit-box-shadow:0 15px 10px rgba(0, 0, 0, 0.7);   
       -moz-box-shadow:0 15px 10px rgba(0, 0, 0, 0.7);
            box-shadow:0 15px 10px rgba(0, 0, 0, 0.7);
    -webkit-transform:rotate(-3deg);    
       -moz-transform:rotate(-3deg);   
        -ms-transform:rotate(-3deg);   
         -o-transform:rotate(-3deg);
            transform:rotate(-3deg);
}

.lifted:after {
    right:10px; 
    left:auto;
    -webkit-transform:rotate(3deg);   
       -moz-transform:rotate(3deg);  
        -ms-transform:rotate(3deg);  
         -o-transform:rotate(3deg);
            transform:rotate(3deg);
} 
```

[做了一个小提琴！](http://jsfiddle.net/zuul/mPnTP/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:12:00.287

您可以使用`box-shadow`：

```
.rightimgdropshadow { 
    box-shadow: 0px 2px 3px rgba(0,0,0,.3);
} 
```

这将产生类似的效果，但看起来不一样。

[这方面的一些信息](http://css-tricks.com/snippets/css/css-box-shadow/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:21:13.440

类似的东西

```
border: 1px solid #333;
border-bottom: none;
padding: 10px 10px 20px;
background: url('insert_image') no-repeat;
background-position: left bottom; 
```

底部的额外填充允许背景位于正确的位置。

这有帮助吗？

# text - Overwritting Cut / Copy / Paste to wx.TextCtrl

> ID：10541317
> 
> 赞同：2
> 
> 时间：2012-05-10T20:04:52.900
> 
> 标签：text, widget, wxpython, copy-paste

So I'm learning wxPython and to do so I'm working on a text editor. I know that I can intercept a CUT / COPY / PASTE signal generated from a control, such as wx.TextCtrl by binding the equivalent wx.EVT_TEXT_COPY / wx.EVT_TEXT_PASTE / wx.EVT_TEXT_CUT. What I'm having trouble figuring out is how to override say a paste to the clipboard with other text.

For instance I have a wx.ListBox where a user can store clips of text and then select them latter to paste onto the wx.TextCtrl instead of whatever text is on the system clipboard. So basically I'm trying to intercept the paste signal and in lieu of pasting the system clipboard text have it paste the selected line from the wx.ListBox. Is this possible? If so, how would I go about doing this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:44:28.600

一个简单的解决方案是不要`Skip()`在您的`wx.EVT_TEXT_PASTE`处理程序中使用并手动更新控件，例如：

```
 textCtrl.Bind(wx.EVT_TEXT_PASTE, self.onPaste)

def onPaste(self, evt):
    #do not use evt.Skip()
    print "PASTE but nothing happens"
    #do some manual update of the control 
```

这`evt.Skip()`将导致传播事件并执行粘贴内容的默认行为。如果没有调用，您会阻止传播，并且您可以替换默认行为。

# vb.net - VB silverlight for windows phone "DownloadStringAsync"

> ID：10541325
> 
> 赞同：0
> 
> 时间：2012-05-10T20:05:28.797
> 
> 标签：vb.net, silverlight, windows-phone-7

您好，我正在为 windows phone 开发应用程序，我想从网上读取 xml，所以我正在使用页面加载事件：

``Dim cl As New WebClient AddHandler cl.DownloadStringCompleted, AddressOf cl_DownloadStringCompleted cl.DownloadStringAsync(New Uri("demo.com/1.xml",UriKind.RelativeOrAbsolute))``

在 cl.DownloadStringCompleted 事件上：

``Dim doc = XDocument.Load("demo.com/1.xml")``

但由于某种原因我崩溃了！错误一定是我不必使用 URI：“demo.com/1.xml”，但还有一些：S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:44:57.017

该`DownloadStringCompleted`事件有`DownloadStringCompletedEventArgs`。您应该使用这些参数的 Result 属性。

```
Dim client As New WebClient()
AddHandler client.DownloadStringCompleted, AddressOf ClientOnDownloadStringCompleted
client.DownloadStringAsync(New Uri("http://demo.com/xml")) 
```

和处理程序：

```
Private Sub ClientOnDownloadStringCompleted(sender As Object, args As DownloadStringCompletedEventArgs)
    Dim doc = XDocument.Parse(args.Result)
End Sub 
```

# winapi - LoadLibrary fails with lasterror 0x43 The network name cannot be found

> ID：10541328
> 
> 赞同：0
> 
> 时间：2012-05-10T20:05:57.187
> 
> 标签：winapi

My program dynamically loads a number of DLL's using LoadLibrary and (on literally all machines) these load successfully, on one machine some of these DLL's do not get loaded. I added code to trace lasterror and this reports "0x43 The network name cannot be found.".

The machine in question is running Windows 7 Enterprise x64, the DLL is a 32 bit DLL, this shouldn't be an issue and (in fact) this is my development environment.

I also tried converting the name of the DLL (which includes the path) to a short filename and used that in the call to LoadLibrary, I still got the same error.

Any ideas?

//*eggbox

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:15:44.070

下载[Procmon](http://technet.microsoft.com/en-us/sysinternals/bb896645)让它运行并过滤你的 dll 名称。这将立即为您提供搜索 dll 的位置以及返回 0x43 的访问路径。

如果您的代码也有 pdb（只有 C/C++ 没有托管代码），您甚至可以获得调用堆栈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:18:02.643

通过[Dependency Walker](http://www.dependencywalker.com/)在其 Profile 模式下运行程序，并让该精细工具准确地告诉您出了什么问题。

# c# - 如何在组合框选择更改事件时更改部分窗口内容？

> ID：10541331
> 
> 赞同：0
> 
> 时间：2012-05-10T20:06:03.583
> 
> 标签：c#, wpf, visual-studio

在我的 wpf 窗口中，当组合框选择发生更改时，我想更改它的一部分（使不同的控件可见）。与 TabControl 完全一样，只需使用组合框即可。我知道我可以让一些控件可见，同时将其他控件隐藏在后面的 c# 代码中，但我想知道是否还有其他更好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:30:54.987

您可以使用两个`Grid`或`GroupBox`（或其他容器类型）控件，并在每个控件中放置一组适当的控件。这样，您可以只显示面板以隐藏整组控件，而不是直接隐藏每个控件。

有时为每组控件创建一个用户控件可能是合适的。但是，这可能取决于具体情况。

# c# - LINQ Where filtering with lists

> ID：10541333
> 
> 赞同：1
> 
> 时间：2012-05-10T20:06:09.200
> 
> 标签：c#, linq

I have code like this:

```
.Where(o => o.Parents.Contains(name)) 
```

The above code does not work because `Parents` contain a list of `Parent` objects, which in turn have a property `Name`. I want to check against the `Name` property, but it's a list so how could I do this check? So I want the `Where` to be `true` when any of the `Parent` objects in the list have `Name` property set to `name`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:07:37.157

There's a simple fix for this: use more LINQ.

```
.Where(o => o.Parents.Any(p => p.Name == name)) 
```

As an alternative, you could use the slightly more verbose (but equally lazy)

```
.Where(o => o.Parents.Select(p => p.Name).Contains(name)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:07:58.507

Try the following code snippet:

```
.Where(o => o.Parents.Any(p => p.Name == name)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:10:57.147

您可以使用 .Any 在要检查特定属性的对象集合中检查特定条件。

```
.Where(o => o.Childs.Any(child => child.Name == o.Name)); 
```

# jquery - 获取具有相同名称数组的字段的所有值

> ID：10541334
> 
> 赞同：1
> 
> 时间：2012-05-10T20:06:20.020
> 
> 标签：jquery, jquery-selectors

我有一些以下格式的输入字段：

```
<input name='date_of_birth[month]' type='text' />
<input name='date_of_birth[day]' type='text' />
<input name='date_of_birth[year]' type='text' /> 
```

有没有办法在 jQuery 中选择这些字段的所有值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T20:18:05.450

在这种情况下，该`$.map`方法可能会更好：

```
var dobArray = $.map($('input[type=text][name^=date_of_birth]'),function(){
  return this.value;
}); 
```

并使其成为日期字符串，

```
var dobString = dobArray.join("/"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:09:13.110

```
$(":text[name^='date_of_birth']").each(function (){alert(this.value)}); 
```

[http://jsbin.com/emumef/edit#javascript,html](http://jsbin.com/emumef/edit#javascript,html)

根据@gordon 关于速度的说法 - 这会更快：（减少扩展开销）

```
 $("input[type='text'][name^='date_of_birth']") 
```

# java - 在 glassfish Web 服务中加载属性或 XML

> ID：10541337
> 
> 赞同：0
> 
> 时间：2012-05-10T20:06:29.900
> 
> 标签：java, glassfish, jax-ws

我有一个基本的 glassfish 网络服务，我正在尝试从 WEB-INF 文件夹加载一些属性。然而，

Thread.currentThread().getContextClassLoader().getResource("test.properties") this.getClass().getResource("test.properties");

似乎没有在正确的目录中搜索。用“。”替换 test.properties，我得到目录 file:/C:/Program%20Files%20(x86)/glassfish-3.1.2/glassfish/domains/domain1/lib/classes/ 这是完全空的。

我如何在这样的 Web 服务中从 java 层加载属性文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:09:04.590

将它放在 WEB-INF/classes 中并询问“/test.properties”

# c# - Ref/Out on 2D Array with Ironpython

> ID：10541343
> 
> 赞同：2
> 
> 时间：2012-05-10T20:06:49.370
> 
> 标签：c#, clr, ironpython

I have a python script that needs to do some communication with a C# function. The function expects three parameters, two of which are returned via the `out` keyword. The declaration looks something like this:

```
RunComputation(InfoParams locInfo, out double[,] dataTable, out int numPoints){ ... } 
```

Since Python is a dynamically typed language, it doesn't know how to deal with the **out** keywords. I did some searching and found some stuff about clr.StrongBox and clr.Reference, which seem fairly simple to use in situations where you need to pass a strongly typed object.

For the numPoints parameter, I can define something like this in the python code:

```
 num_points = clr.Reference[int] 
```

And it seems to be fine. The problem comes from the **dataTable** array. I don't know the syntax to tell it that my strongly typed object is an array of doubles. The error it gives informs me that it's expecting an instance of Type `StrongBox[Array[float]]`. I tried import Array from System to see if I could add that C# type in as a reference, but it failed. Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:36:06.533

如果您只使用`out`参数，您也可以使用[隐式方式](http://ironpython.net/documentation/dotnet/dotnet.html#id52)，即如果您不`out`向方法传递任何参数，它们将作为元组返回。

例如

```
d = Dictionary[str, float]()
(keyfound,value) = d.TryGetValue("b") 
```

它也适用于`ref`参数。
想象一下有以下方法：

```
int Foo(int x, double[,] v) 
```

您可以通过这种方式调用该方法：

```
nrows = 5
ncols = 5
array = Array.CreateInstance(float, nrows, ncols)
(x, arrayNew) = obj.Foo(3, array) 
```

最后，修改后的值`array`包含在`arrayNew`

# javascript - onchange 在 Javascript 中没有错误

> ID：10541344
> 
> 赞同：0
> 
> 时间：2012-05-10T20:06:51.567
> 
> 标签：javascript, dom-events, onchange

我正在尝试从 HTML 的下拉列表中制作一个快速的 CSS 样式切换器。JS 是外部的，并在表单之前的头部末尾调用。

我的 JS：

```
function ChangeTheTheme(){
    txt = document.getElementsByTagName("link");
    switch(document.mytheme.themes.selectedIndex) {
    case 0:
        alert("Choice 0");
        txt[0].href = "style.css";
        break;
    case 1:
        alert("Choice 1");
        txt[0].href = "style2.css";
        break;
    }
} 
```

重要的 HTML 行是：

```
<form name="mytheme">
<select name=”themes” onChange=”ChangeTheTheme();”&gt; 
```

我尝试`alert("working");`在函数的开头添加。它向我展示了根本没有调用该函数。

下拉菜单应将 CSS 样式切换为当前选择的样式。没有按钮提交或任何东西。这就是我理解`onchange`应该做的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T20:08:59.603

你有花哨的报价而不是普通的报价。（这经常发生在从 Wordpress 驱动的博客复制时，这样做时要小心！我曾经从 Wordpress 博客复制了一个 PHP 代码，它让我的博客崩溃了一段时间，直到我弄清楚出了什么问题......）

```
<select name="themes" onChange="ChangeTheTheme();"> 
```

# python - django template iterate ordered dict generator

> ID：10541345
> 
> 赞同：2
> 
> 时间：2012-05-10T20:06:52.143
> 
> 标签：python, django, generator, pycassa

I have an ordered dict generator (output from pycassa query). It has the format {'key_0': 'value_0'}

I am having trouble iterating over it.

I am trying

```
{% for k in results %}
    {{ k }}
{% end for %} 
```

but I only get the key. i.e., 'key_0'

When I try `{% for k, v in results.items %}`

I get **'Content-Type' and 'text/html; charset=utf-8'** respectively

When I try `{% for k, v in results.iteritems %}`

yields no results at all

Any ideas?

# image - Testing image crops existence with Razor in Umbraco

> ID：10541353
> 
> 赞同：3
> 
> 时间：2012-05-10T20:08:01.383
> 
> 标签：image, umbraco

I have created some Razor code to output images onto a page if the exist. It is detailed below and contains some simple checks to prevent rendering a blank list item. The site has gone live and works fine. The client then deleted the image from the media folder within Umbraco, meaning my node had a valid image assigned but the image just didn't exists. I got the following exception:

**'string' does not contain a definition for 'crops'**

How do I deal with this?

```
@using umbraco.MacroEngines;
@inherits umbraco.MacroEngines.DynamicNodeContext
@using umbraco.presentation.nodeFactory
@using umbraco.cms.businesslogic.media

<ul>
    @foreach (dynamic client in @Model.Children)
    {
        var image = Model.MediaById(client.Logo);
        var crops = image.imageCropper.crops;

        <li>
            <h2><span>@client.Name</span></h2>

            @if (crops != null || crops.GetType().ToString() != "System.String")
            {
                <span class="itemImage">
                    <img src="@crops.Find("@name", "cropname").url" alt="@client.Name" />
                </span>
            }
        </li>
    }
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T03:34:19.277

在这种情况下，您可能需要进行类型检查。我相信 MediaById 方法应该返回一个 DynamicNode 如果它是有效的，所以应该像下面这样工作：

```
if(image.GetType() == typeof(DynamicNode))
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T17:12:34.430

我遇到了这个问题。我发现，如果 Media 已被删除（并且过去已被选中），则 Model.MediaById(imageid) 调用将引发异常。

所以我像这样设置我的测试：

```
dynamic mainMediaImage = new DynamicNull();
try
{
  mainMediaImage = Model.MediaById(related.eventMainImage);
}
catch(Exception e)
{
  <p style='display: none;'>@e.Message</p>
}
var cropUrl = "";

if(mainMediaImage.GetType() == typeof(DynamicMedia))
{  
   cropUrl = GetImageCropperUrl(Model.MediaById(related.eventMainImage).crops, "List Image");    
} 
```

我仍然收到错误，但它不会显示给用户。

我发现它永远不会进入我的 DynamicMedia 检查，所以我必须在调用周围添加 try...catch() ，否则整个宏将失败。

# excel - Show full drop-down list, but only populate field with characters before a "-"?

> ID：10541354
> 
> 赞同：0
> 
> 时间：2012-05-10T20:08:05.450
> 
> 标签：excel, validation

I am attempting to create a drop-down list populated with a range from another sheet. But what I want to do is show the full list, and when the user selects and item, it will only enter into that cell all characters before the dash.

So, if I had "David - Project Manager" upon selection the cell with populate with just "David" and remove everything after the dash. Everything after is just there to make things easier to see.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T00:40:52.000

VBA 方法不会破坏验证，因为 VBA 可以绕过这些要求。假设要调整 DV 的单元格范围是 B2:B100，试试这个：

```
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
Dim cell As Range

If Not Intersect(Target, Range("B2:B100")) Is Nothing Then
    For Each cell In Intersect(Target, Range("B2:B100"))
        If InStr(1, cell.Value, "-") > 0 Then
            Application.EnableEvents = False
            cell.Value = Trim(Left(cell.Value, InStr(1, cell.Value, "-") - 1))
            Application.EnableEvents = True
        End If
    Next cell
End If

End Sub 
```

该宏进入 SHEET 模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T11:29:24.767

[我在Contextures Video](http://www.youtube.com/watch?v=uLJEMnIT0zM)中找到了答案。

在可下载的 XLS 文件中，有一个指向工作表所需代码的链接。

```
Option Explicit
' Developed by Contextures Inc.
' www.contextures.com
Private Sub Worksheet_Change(ByVal Target As Range)
On Error GoTo errHandler
If Target.Cells.Count > 1 Then GoTo exitHandler
If Target.Column = 6 Then
  If Target.Value = "" Then GoTo exitHandler
  Application.EnableEvents = False
  Target.Value = Worksheets("codes").Range("C1").Offset(Application.WorksheetFunction.Match(Target.Value, Worksheets("codes").Range("activitycodes"), 0) - 1, -2)
End If

exitHandler:
  Application.EnableEvents = True
  Exit Sub

errHandler:
  If Err.Number = 13 Or Err.Number = 1004 Then
    GoTo exitHandler
  Else
    Resume Next
  End If

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T22:15:29.337

你不能用`Data Validation`. VBA 可用于修改已验证的单元格（但这会破坏验证，不是吗？）`Data Validation`提供完整条目的折衷方案如何，然后相邻的单元格将其修剪为您的要求，我认为这是：

```
=IFERROR(TRIM(LEFT(A1,SEARCH("-",A1)-1)),A1) 
```

`A1`一个单元格包含在哪里`Data Validation`

# php - 将多维数组信息插入数据库

> ID：10541360
> 
> 赞同：0
> 
> 时间：2012-05-10T20:08:13.437
> 
> 标签：php, mysql, sql

这似乎有一个非常简单的解决方案......但我很难弄清楚。我需要一个数组才能进入数据库。例如：

```
$usa = array(
'idaho' => array(
           county1 => array(
                     'pocatello', 'arimo', 'downey'
                      ),
           county2 => array(
                      'bear', 'cuprum', 'mesa'
                      )
'iowa' => array(
           county1 => array(
                     'des moines', 'adel', 'desoto'
                      ),
           county2 => array(
                      'douglas', 'grant', 'jasper'
                      )

); 
```

我尝试了这种插入数据库的方法：

```
foreach($usa as $state => $county){
    foreach($county as $name => $city){
    $s=$state;
    $county_name = strtolower($name);
    $city = strtolower($city);
    $us = "INSERT INTO us
           SET state='{$s}',county='{$county_name}',city='{$city}'
           ";
    $us_result = mysql_query($us,$connection);
         }
  } 
```

我相信问题出在 foreach （将状态变量传递到第二个 foreach 循环）。我已经尝试了很多不同的方法。在此先感谢您的帮助！

***注意：当我删除 $s=$state 变量和插入的 state='{$s}' 部分时，一切正常。我仍然无法让它插入状态

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:26:30.517

有两个主要问题。

首先，您的数组没有正确分隔，最好对县名使用单引号或双引号，无论如何您都将其称为字符串：

```
$usa = array(
  'idaho' => array(
       'county1'=>array(
                 'pocatello', 'arimo', 'downey'
                  ),
       'county2'=>array(
                  'bear', 'cuprum', 'mesa'
                  )),
  'iowa' => array(
       'county1'=>array(
                 'des moines', 'adel', 'desoto'
                  ),
       'county2'=>array(
                  'douglas', 'grant', 'jasper'
                  ))

); 
```

其次，应该有一个更多的 foreach 循环来解释城市名称：

```
foreach($usa as $state => $county){
  foreach($county as $name => $city){
    foreach ($city as $cityname) {
      $s = $state;
      $county_name = strtolower($name);
      $city = strtolower($cityname);
      $us = "INSERT INTO us SET state='{$s}',county='{$county_name}',city='{$city}'";
      echo $us.'<br>';
    }
  }
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:26:40.240

第一的。正如@itsmeee 所说，您又错过了一个遍历该县城市数组的 foreach。除此之外，您的输入数组缺少 2 个关闭括号来包装每个状态的数据数组。

如果你解决这个问题，我会这样做：

```
$us     = "INSERT INTO us (state, county, city) VALUES ";
$values = array();

foreach($usa as $state => $county){
    foreach($county as $name => $cities){
        foreach($cities as $city){
            $county_name = strtolower($name);
            $city        = strtolower($city);
            $values[]    = "('{$state}','{$county_name}','{$city}')";
        }
    }
}

$us       .= join(',',$values);
$us_result = mysql_query($us,$connection); 
```

这将构建插入字符串并一次性完成所有插入。您也可以进行单独的插入，但对于这样小的数据集，做一个大的插入更有效。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:11:56.757

您的 INSERT 查询不正确。试试这个：

```
$us = "INSERT INTO us (state, county, city) VALUES ('" . mysql_real_escape_string ($s) . "', '" . mysql_real_escape_string ($county_name) . "', '" . mysql_real_escape_string ($city) . "')"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T20:20:11.003

好像你又错过了一个 foreach：

```
foreach($county as $name => $cities) {
 foreach ($cities as $city) {
.... 
```

# java - 发现一个随机加号，没有语法错误

> ID：10541361
> 
> 赞同：3
> 
> 时间：2012-05-10T20:08:22.110
> 
> 标签：java, android, eclipse

所以，我查看了一些较早的代码，发现这个随机加号应该是语法错误，但代码运行良好，我不明白为什么

```
tv_distance.setText("Distance: " + 
        ( dist >= 1000 ? (String.format("%.1f", dist/1000f)) : +dist )
        + " " + metric ); 
```

额外的加号位于三元运算符的第三个操作数：

```
() ? () : +dist 
```

那我错过了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-10T20:11:51.880

`dist`是一个数字。`+`只是指定符号。例如，`+5`总是相同，`5`但它是合法的。显然，您更熟悉它的反义词，如`-5`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T20:16:21.910

在这种情况下，加号被用作一元运算符 - 这里是多余的，但包含在 java 中的方式与一元减法运算符相同，即

```
int x = -5; 
```

# amazon-ec2 - 自行终止的 AWS EC2 实例？

> ID：10541363
> 
> 赞同：88
> 
> 时间：2012-05-10T20:08:24.373
> 
> 标签：amazon-ec2, amazon-web-services, terminate

有没有办法让 Amazon Web Services EC2 实例自行终止？亚马逊是否有任何东西允许实例在运行超过一个小时后自行终止（“Hara-Kiri”）？我可以更改正在运行的实例上的脚本以自行执行此操作，但这可能会失败并且我不想编辑图像，因此我希望 Amazon 终止该实例。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-05-10T21:32:14.067

要让实例自行终止，请执行以下两个步骤：

1.  `--instance-initiated-shutdown-behavior terminate`在 AWS 控制台或 API 调用上使用或等效启动实例。
2.  `shutdown -h now`以 root 身份运行。在 Ubuntu 上，您可以使用以下命令将其设置为在 55 分钟内发生：

    ```
    echo "sudo halt" | at now + 55 minutes 
    ```

不久前，我写了一篇关于其他选项的文章，以实现同样的“在一小时内结束”目标：

> Amazon EC2 上的临时实例自动终止
> [http://alestic.com/2010/09/ec2-instance-termination](http://alestic.com/2010/09/ec2-instance-termination)

该文章最初是在`instance-initiated-shutdown-behavior`可用之前编写的，但您会在评论中找到更新和其他宝石。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-04-07T13:18:18.030

你可以这样做

```
ec2-terminate-instances $(curl -s http://169.254.169.254/latest/meta-data/instance-id) 
```

ec2 将获取其当前实例 ID 并自行终止。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2016-02-03T11:09:05.047

希望这会奏效

```
instanceId=$(curl http://169.254.169.254/latest/meta-data/instance-id/)
region=$(curl http://169.254.169.254/latest/dynamic/instance-identity/document | grep region | awk '{print $3}' | sed  's/"//g'|sed 's/,//g')

/usr/bin/aws ec2 terminate-instances --instance-ids $instanceId --region $region 
```

希望这对你有帮助！！！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-07-04T14:11:58.727

这是我的***自我终止脚本***

```
$ EC2_INSTANCE_ID="`wget -q -O - http://instance-data/latest/meta-data/instance-id || die \"wget instance-id has failed: $?\"`"
$ echo "ec2-terminate-instances $EC2_INSTANCE_ID" | at now + 55 min || die 'cannot obtain instance-id' 
```

如果您想将其分配为***Self-Stopping*** on *Self-Terminating*，您只能执行一次。

在您的*[EC2 控制台](https://console.aws.amazon.com/ec2/v2/home#Instances:sort=instanceId)*中，转到*Instance Settings*，将*Shutdown Behavior*更改 为*Stop*。
配置*/etc/cloud/cloud.cfg*，您可以参考*[如何使用 cloud-init 运行启动脚本](https://stackoverflow.com/a/38476752/4058484)*。[按照Eric Hammond](https://stackoverflow.com/a/10455027/4058484)
的 回答，将命令放在一个文件中，然后在[*scripts-per-boot*](https://stackoverflow.com/a/10455027/4058484)路径中找到它：[](https://stackoverflow.com/a/10455027/4058484)

 *```
$ echo '#!/bin/sh' > per-boot.sh
$ echo 'echo "halt" | at now + 55 min' >> per-boot.sh
$ echo 'echo per-boot: `date` >> /tmp/per-boot.txt' >> per-boot.sh
$ chmod +x per-boot.sh
$ sudo chown -R root per-boot.sh
$ sudo mv -viu per-boot.sh /var/lib/cloud/scripts/per-boot 
```

[重启](https://stackoverflow.com/a/637856/4058484)你的实例，检查脚本是否被执行：

```
$ cat /tmp/per-boot.txt 
per-boot: Mon Jul 4 15:35:42 UTC 2016 
```

如果是这样，以防您忘记停止实例，它将向您保证实例将在运行 55 分钟或您在脚本中设置的任何时间时自行终止。

```
Broadcast message from root@ip-10-0-0-32
        (unknown) at 16:30 ...

The system is going down for halt NOW! 
```

PS：对于每个想要使用*Self-Stopping*的人来说，您应该注意的一件事是，并非所有 EC2 类型在重启时都能自我恢复。我建议使用[*EC2-VPC/EBS*](https://stackoverflow.com/a/38235022/4058484)和*[On/Off Schedule](https://stackoverflow.com/a/38408077/4058484)*。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-08-04T13:50:49.240

我也有类似的需求，让 Web 应用程序启动 EC2 实例。我无法相信 Web 应用程序会停止/终止实例，因此我创建了一个脚本以在称为“馈送器”的单独进程中运行。馈线负责停止/终止实例。Web 应用程序必须定期请求馈送器“馈送”实例。如果一个实例“饿死”（在超时期限内没有被喂食），喂食器将停止/终止它。两个进料器可以在不同的机器上同时运行，以防止一个进料器过程出现问题。换句话说，实例在压力开关上运行。当压力释放时，实例停止/终止。这也允许我在多个用户之间共享一个实例。

对于最初的问题，可以在 EC2 实例本身中运行的馈送器消除了事先知道任务将运行多长时间的需要，但是它给应用程序提供了定期馈送的负担。如果笔记本电脑关闭，实例将关闭。

feeder 住在这里：[https](https://github.com/alessandrocomodi/fpga-webserver) ://github.com/alessandrocomodi/fpga-webserver并拥有一个宽松的开源许可证。*

# javascript - jQuery检查每个链接的点击

> ID：10541364
> 
> 赞同：1
> 
> 时间：2012-05-10T20:08:26.750
> 
> 标签：javascript, jquery

```
$("#showKey").each(
    $(this).click(function(){
        alert($(this).attr("value"));
    })
); 
```

和

```
<a id="showKey" href="#" value="{{ customer.key }}">
   <span class="icons icon-key"></span>
   Show key
</a> 
```

警报给出了未定义的输出，只是“未定义”。我有一个客户列表，点击#showKey 应该会显示被点击客户的密钥。

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T20:12:38.743

您不能有多个具有相同 ID 的元素 - 请改用一个类。此外，您不需要调用 .each - 而是使用类选择器：

```
$(".showKey").click(function(){
     alert($(this).data("key"));
);

<a class="showKey" href="#" data-key="{{ customer.key }}">Show key</a> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T20:13:12.520

你可以使用`data`属性：

```
<a id="showKey" href="#" data-value="{{ customer.key }}">
   <span class="icons icon-key"></span>
   Show key
</a>

$("#showKey").click(function(){
    alert($(this).data("value"));
}) 
```

[http://jsfiddle.net/LKArX/](http://jsfiddle.net/LKArX/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:16:32.643

你不需要[jQuery 的每个](http://api.jquery.com/jQuery.each/)函数。

```
$("#showKey").click(function(){
   alert($(this).attr("value"));
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T20:17:06.140

您的代码的问题在于您使用

```
$("#showkey").each({...}); 
```

你应该简单地使用

```
$("#showkey").click({function(){
   alert( $this).val() );
   }
}); 
```

将点击事件绑定到每个 showkey id'd 元素。

# c++ - 乌布拉斯矢量指针

> ID：10541366
> 
> 赞同：1
> 
> 时间：2012-05-10T20:08:39.090
> 
> 标签：c++, pointers, boost, ublas

我试图通过在我的 .h 文件中定义向量来初始化/赋值给 ublas 向量：

```
someClass{
    ublas::vector<double> *L;
} ; 
```

然后在我的 .cpp 文件中：

```
someClass::someClass()
{
    L = new ublas::vector<double>[4];
    L->data()[0] = 1;
} 
```

代码编译得很好，但是当我运行它时，我的 .cpp 文件中的最后一行给出了错误。我可能缺少一些非常简单的东西，但我不知道是什么......

提前谢谢了！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:38:47.887

您已经创建了一个由四个 ublas::vectors 组成的数组，每个向量的大小为零。分配给空向量的第一个元素会引发异常。

你的意思是写

```
L = new ublas::vector<double>(4); 
```

反而？

且不说 new 和指针的使用是有问题的，对于大多数用途来说，成员对象更合适：

```
class someClass {
    ublas::vector<double> L;
 public:
     someClass() : L(4) {
          L[0] = 1;
     }
}; 
```

# javascript - 如何关闭rails中的javascript连接？

> ID：10541374
> 
> 赞同：0
> 
> 时间：2012-05-10T20:09:25.887
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3

我在通过丑陋的压缩过程中遇到了这个令人讨厌的错误。但它是一个文件，很难追踪原因

有没有办法关闭连接并在 Rails 中保留压缩？

```
Unexpected token: name ($j)
  (in /home/grzegorz/work/navegas/app/assets/javascripts/all.js) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:15:05.227

所以你希望你的文件*不*被连接，但仍然被缩小，是吗？唔。我不认为有一种“酷”的方法可以做到这一点，但是您可以将所有 js 文件名添加到要预编译的文件列表中：

```
config.assets.precompile += ['admin.js', 'lala.js', ...] 
```

并在需要时包含您的单独文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T22:25:07.320

application.js 底部有一行，其中包含目录中的所有 js 文件。

```
//= require_tree . 
```

如果删除此行，文件将不会包含在连接文件中。您必须在使用它们的 html 页面中添加对它们的引用。

# iphone - XCode 4.3.2 中的自定义字体

> ID：10541378
> 
> 赞同：3
> 
> 时间：2012-05-10T20:09:45.030
> 
> 标签：iphone, ios, xcode, ipad, fonts

我知道这个主题已经深入人心，但是我已经尝试了我在 StackOverflow 上找到的所有解决方案来解决这个问题，但由于某种原因它无法正常工作。我正在以`UILabel`编程方式创建一个，然后使用这种字体。正在渲染但不是我想要的`UILabel`字体（看起来它默认为某些东西）

首先，我将两个 .ttf 字体导入到名为“Resources”的文件夹下的 xcode 项目中。这两种字体分别是 Gotham Book 和 Gotham Book Italic（GothaBoo.ttf、GothaBooIta.ttf）

然后，我在 [my app]-Info.plist 文件中添加了一行名为“UIAppFont”的行，在数组中添加了两行，Item 0 | 字符串 | GothaBoo，第 1 项 | 字符串 | 哥达布伊塔。

我检查了 Copy Bundle Resources 下的 Target Build Phases，并确保其中有两种字体。

然后，我简单地将这段代码添加到 viewDidLoad 例程中：

```
UILabel *myLabel1 = [[UILabel alloc] initWithFrame:CGRectMake(50, 100, 200, 100)];
myLabel1.text = @"Hello";
myLabel1.backgroundColor = [UIColor clearColor];
myLabel1.font = [UIFont fontWithName: @"GothaBoo" size: 48.0];
myLabel1.textColor = [UIColor blackColor];

[self.view addSubview:myLabel1]; 
```

没有骰子。我到底做错了什么？该项目在 Xcode 4.3.2 中，适用于 iPad，运行 5+ 的 iOS

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T20:31:55.847

在数组中必须提供完整的文件名，所以不是 Item 0 | 字符串 | GothaBoo，第 1 项 | 字符串 | GothaBooIta 你必须把它变成 Item 0 | 字符串 | GothaBoo.ttf，第 1 项 | 字符串 | GothaBooIt.ttf

其次，文件名或字体名可能与 iOS 喜欢在`fontWithName:`. 如果在更改 .plist 中的文件名后仍然无法正常工作，请使用 Mac 上的 Fontbook 获取正确的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:34:05.270

注意文件名和字体名的区别。字体名称将在 Fontbook 中找到。在 info.plist 中，它是文件名，在代码中，它是字体名称。

我自己为此苦苦挣扎了很长时间。很确定这会奏效。

# visual-studio-2010 - 如何在 VS 2010 中让错误突出显示在滚动条附近？

> ID：10541380
> 
> 赞同：2
> 
> 时间：2012-05-10T20:09:53.393
> 
> 标签：visual-studio-2010

在 Eclipse 中，如果有警告，则在警告点的滚动条旁边会出现一个黄色框。除了红色框外，错误也是如此。

## 有没有办法在 VS 2010 中实现这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T20:40:19.687

我使用 VS2010 的生产力工具。你可以在这里找到更多信息：[高级滚动](http://community.dotnetwork.it/AlbertoEng/archive/2011/03/26/vs-2010-productivity-power-tools-advanced-scrolling.aspx)，我也使用 VSCommands2010，那里也有很多有用的工具。您可以在工具>扩展管理器中从 VS2010 内的 VS2010 扩展库下载这两个文件，也可以从此处的在线库下载 .visx 文件：

[VS命令](http://visualstudiogallery.msdn.microsoft.com/d491911d-97f3-4cf6-87b0-6a2882120acf)

[生产力电动工具（高级滚动）](http://visualstudiogallery.msdn.microsoft.com/d0d33361-18e2-46c0-8ff2-4adea1e34fef)

# javascript - 像 window.showModalDialog 一样将参数数组传递给 window.open

> ID：10541382
> 
> 赞同：0
> 
> 时间：2012-05-10T20:10:09.243
> 
> 标签：javascript

> **可能重复：**
> [我可以将 JavaScript 变量传递到另一个浏览器窗口吗？](https://stackoverflow.com/questions/87359/can-i-pass-a-javascript-variable-to-another-browser-window)

我正在尝试更改“showModalDialog”，以便我可以在单独的选项卡/窗口中打开它，而不是在对话框中打开页面。为此，我必须传递它所期望的变量（数组），否则其他页面无法按预期加载。我正在为如何做到这一点而摸不着头脑。有任何想法吗？

编辑为包括：我无权更改作为对话框打开的页面上的任何代码，因此我需要将 vArgs 传递给 (aryAry) 以便它以与正在接收时相同的方式接收它们用showModalDialog打开，打开的页面是不能改变的，所以一定不能区分。

代码原样，打开一个模式对话框：

```
 var aryAry = new Array();
if ( aryAry )
{
  aryAry[ 0 ] = homeW.all.xmlHomeW.XMLDocument;
  aryAry[ 1 ] = homeW;
}

vR = window.showModalDialog( 'home.aspx', aryAry, 'dialogheight: 500px; dialogwidth: 500px;');

if ( vR == null )
  vR = false; 
```

# python - 对相似的 URL 模式进行分组

> ID：10541383
> 
> 赞同：1
> 
> 时间：2012-05-10T20:10:11.397
> 
> 标签：python, django, url

有什么方法可以简化模式`<product>`而不将它们放在单独的文件中？

```
urlpatterns = patterns('',
# Basic product functions
url(r'^create/$', 'product.views.create'),                       
url(r'^save/$', 'product.views.save'),
url(r'^save/(?P<product>[a-z0-9\-]+)/$', 'product.views.save'),
url(r'^edit/(?P<product>[a-z0-9\-]+)/$', 'product.views.edit'),
url(r'^publish/(?P<product>[a-z0-9\-]+)/$', 'product.views.publish'),
url(r'^upload_image/(?P<product>[a-z0-9\-]+)/$', 'product.views.upload_image'),

# Blog
url(r'^(?P<product>[a-z0-9\-]+)/blog/(?P<blog_id>[0-9]+)/view/(?P<content_id>[0-9]+)/$', 'blog.views.view'),
url(r'^(?P<product>[a-z0-9\-]+)/blog/(?P<blog_id>[0-9]+)/$', 'blog.views.main'),
url(r'^(?P<product>[a-z0-9\-]+)/blog/(?P<blog_id>[0-9]+)/(?P<page>[0-9]+)/$', 'blog.views.main'),                      #pagination for main

# Categories
url(r'^(?P<product>[a-z0-9\-]+)/category/(?P<category_id>[0-9]+)/$', 'category.views.category'),
url(r'^(?P<product>[a-z0-9\-]+)/category/(?P<blog_id>[0-9]+)/category/(?P<category_id>[0-9]+)/(?P<page>[0-9]+)/$', 'category.views.category'),   #pagination for main

# Content
url(r'^(?P<product>[a-z0-9\-]+)/content/(?P<blog_id>[0-9]+)/edit/$', 'content.views.edit'),
url(r'^(?P<product>[a-z0-9\-]+)/content/(?P<blog_id>[0-9]+)/edit/(?P<content_id>[0-9]+)/$', 'content.views.edit'), 
 ) 
```

只是寻找任何可能的方法来简化这里的东西。

有没有某种包装器我可以把所有的`^<product>`模式都放在里面来预处理它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:36:38.170

嗨，在 django 文档中，您可以找到：

```
from django.conf.urls import patterns, url, include

extra_patterns = patterns('',
    url(r'^reports/(?P<id>\d+)/$', 'credit.views.report', name='credit-reports'),
    url(r'^charge/$', 'credit.views.charge', name='credit-charge'),
)

urlpatterns = patterns('',
    url(r'^$', 'apps.main.views.homepage', name='site-homepage'),
    (r'^help/', include('apps.help.urls')),
    (r'^credit/', include(extra_patterns)),
) 
```

所以你可以这样做：

```
extra_patterns = patterns('',
    url(r'blog/(?P<blog_id>[0-9]+)/view/(?P<content_id>[0-9]+)/$', 'blog.views.view'),
    url(r'blog/(?P<blog_id>[0-9]+)/$', 'blog.views.main'),
    url(r'blog/(?P<blog_id>[0-9]+)/(?P<page>[0-9]+)/$', 'blog.views.main'),                      #pagination for main

    # Categories
    url(r'category/(?P<category_id>[0-9]+)/$', 'category.views.category'),
    url(r'category/(?P<blog_id>[0-9]+)/category/(?P<category_id>[0-9]+)/(?P<page>[0-9]+)/$', 'category.views.category'),   #pagination for main

    # Content
    url(r'^content/(?P<blog_id>[0-9]+)/edit/$', 'content.views.edit'),
    url(r'^content/(?P<blog_id>[0-9]+)/edit/(?P<content_id>[0-9]+)/$', 'content.views.edit'), 
)

urlpatterns = patterns('',
    # Basic product functions
    url(r'^create/$', 'product.views.create'),                       
    url(r'^save/$', 'product.views.save'),
    url(r'^save/(?P<product>[a-z0-9\-]+)/$', 'product.views.save'),
    url(r'^edit/(?P<product>[a-z0-9\-]+)/$', 'product.views.edit'),
    url(r'^publish/(?P<product>[a-z0-9\-]+)/$', 'product.views.publish'),
    url(r'^upload_image/(?P<product>[a-z0-9\-]+)/$', 'product.views.upload_image'),

    # Blog
    url(r'^(?P<product>[a-z0-9\-]+)/', include(extra_patterns)),
) 
```

# java - 如何在 Jsoup android 中解析和显示表格

> ID：10541386
> 
> 赞同：0
> 
> 时间：2012-05-10T20:10:31.007
> 
> 标签：java, android, html, jsoup

我对 jsoup 有一些问题。

这是我要解析的链接：[http](http://roosters.gepro-osi.nl/roosters/rooster.php?klassen%5B%5D=L2vp&type=Klasrooster&wijzigingen=1&school=905/) ://roosters.gepro-osi.nl/roosters/rooster.php?klassen%5B%5D=L2vp&type=Klasrooster&wijzigingen=1&school=905/ 。我想选择 te 表格内容并在我的应用程序中干净整洁地显示它。这是我已经拥有的脚本：

```
 package rsg.deborgen.nl;

     import org.jsoup.Jsoup;
     import org.jsoup.nodes.Document;
     import org.jsoup.select.Elements;

     import android.app.Activity;
     import android.os.Bundle;
     import android.view.View;
     import android.widget.Button;
     import android.widget.TextView;

     public class Lindenborg1Activity extends Activity {
Button btn_2p;

// blog url
static final String BLOG_URL = "http://roosters.gepro-osi.nl/roosters/rooster.php?klassen%5B%5D=L2vp&type=Klasrooster&wijzigingen=1&school=905/";

@Override
public void onCreate(Bundle savedInstanceState) {
    // set layout view
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    btn_2p =(Button) findViewById(R.id.button1);

    btn_2p.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            // process

                // set layout view
                setContentView(R.layout.rooster);

            try {
                ((TextView)findViewById(R.id.tv)).setText(getBlogStats());
            } catch (Exception ex) {
                ((TextView)findViewById(R.id.tv)).setText("Error");
            }
        }

        protected String getBlogStats() throws Exception {
            String result = "";
            // get html document structure
            Document document = Jsoup.connect(BLOG_URL).get();
            // selector query
            Elements nodeBlogStats = document.select("td.tableheader");
            // check results
            if(nodeBlogStats.size() > 0) {
                // get value
                result = nodeBlogStats.get(0).text();
            }

            // return
            return result; 
```

（我离开了结尾，因为代码块出错了）

但如果我现在运行它，它会显示整个站点，我只想要表格中的文本。所以请帮助我，谢谢！

（Ps。这个脚本来自另一个 tut，但我不记得它的名字，对不起我的菜鸟和糟糕的英语：D）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T21:24:54.423

尝试 document.select("tr.AccentDark td.tableheader")

# javascript - 添加到浏览器历史记录而无需重新加载页面

> ID：10541388
> 
> 赞同：23
> 
> 时间：2012-05-10T20:10:48.823
> 
> 标签：javascript, url, browser, back, browser-history

基本上，我有一个包含表单的页面。当用户提交该表单时，会调用一个 JavaScript 函数，并且会动态地向用户呈现一个新表单。

此时，我希望用户能够单击浏览器的后退按钮并返回到第一个表单。这可能吗？

* * *

感谢您的快速回复，但我无法让 pushState 正常工作。单击后退按钮后，HTML 仍显示“第二种形式”。

这是我用来测试它的代码：

```
<script>
function newPage(){
    history.pushState({state:1}, "State 1", "?state=1");
    document.getElementById('formBox').innerHTML="second form";
}
</script>

<input type="button" onclick="newPage();" value="forward" />
<div id='formBox'>first form</div> 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-10T20:15:24.280

```
var stateObj = { foo: "bar" };
history.pushState(stateObj, "page 2", "bar.html"); 
```

[文档的](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history)相关链接。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-10T20:14:04.280

我使用[History.js](https://github.com/balupton/History.js/)使用 HTML5 History/State API 完成了类似的行为，如下所述：

> 为所有 HTML5 浏览器提供交叉兼容的体验（它们都实现了 HTML5 History API 略有不同，导致不同的行为，有时甚至是错误 - History.js 修复了这个问题，确保整个 HTML5 浏览器的体验与预期的一样/相同/很棒）

例子：

```
History.pushState({state:1}, "State 1", "?state=1"); 
```

# php - PHP 和 ffmpeg - 为 JW Player 即时转换为 H.264

> ID：10541390
> 
> 赞同：1
> 
> 时间：2012-05-10T20:10:56.273
> 
> 标签：php, ffmpeg, h.264

所以我正在处理的项目在服务器上已经有大量需要在嵌入式播放器中播放的 MP4 文件。理想情况下，我们希望使用已经为大多数视频设置的 JW Player。不幸的是，许多较旧的视频都是 MPEG-4 编码的，需要额外的插件才能在浏览器中播放。

我想做的是能够将这些视频即时转码为 JW Player 支持的格式，例如 H.264。现在，我已经成功了，因为我可以用它来转换旧的 MP4 文件，但是我很难将数据直接传递给播放器。

这是我当前进行转换的脚本（这是`media_converted.php`）：

```
<?php
    error_reporting(0);
    if (!isset($_GET["MediaName"])) {
        $_GET["MediaName"] = "GSX238";
    }       
    require_once("php/media_center_functions.php");
    $MediaURL = ConstructVideoURLInternap($_GET["MediaName"]);  
    header("Content-Transfer-Encoding: binary");
    //header('Content-type: video/mp4');
    //$calculatedFileSize = filesize($MediaURL);
    //header("Content-Length: {$calculatedFileSize}");

    $cmd = 'ffmpeg -i "'.$MediaURL.'"  -vcodec libx264 -acodec copy -f mp4  -moov_size 32000 "_temp/'.time().'_temp.mp4"  2> _temp/media_converter_output.txt';
    passthru($cmd);

?> 
```

我正在尝试获取上述文件并将其作为视频源传递给 JW Player：在 JW Player 的变量脚本中，如下所示：

`so.addVariable('file','media_converted.php?MediaName=12345');`

虽然我相信这应该可行，但事实并非如此。

即使转换似乎有效并且正在发送到播放器，也很难说，因为我认为浏览器正在尝试在播放任何内容之前下载整个文件。显然我不能让用户那样等待。

我研究了 qt-faststart，我能够在我的计算机上使用它来修改文件，以便它可以在加载时开始播放。不幸的是，这需要两个步骤。我首先必须完全转换文件，然后当它完成后，我必须在它上面使用 qt-faststart.exe。同样，这并不是真正的即时解决方案。我确信必须有某种方法可以在单个命令中产生类似的结果，然后输出给玩家……对吧？

服务器上的视频数据比我目前硬盘上的空间要多，所以要永久重新编码每个视频，即使是分批，也会很麻烦，因为我必须下载一些，转换，重新上传，下载更多，等等。如果我必须这样做，我会这样做，但我更愿意让它们保持原样并能够即时转码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:18:45.417

我不认为这是可能的。必须先进行转换，然后才能加载文件。看看维密欧。上传文件时，系统会先转换格式，然后才能播放

# sql - 添加条件后查询运行缓慢

> ID：10541393
> 
> 赞同：0
> 
> 时间：2012-05-10T20:11:09.777
> 
> 标签：sql, ms-access, ms-access-2010

在其他人的帮助下，我有了这个 sql 语句来计算表中记录之间的里程差（+ 或 -）。问题是，当我向计算值添加标准（> 0）时，它会大大减慢我的查询速度。如果我向任何其他字段添加条件，那么事情会按预期运行（不会长时间延迟）。

```
SELECT T1.Date, 
       T1.Route, 
       T1.BookingID, 
       T1.StreetNumber, 
       T1.Street, 
       T1.Arrive, 
       T1.Perform, 
       T1.Miles, 
       T1.Miles - (SELECT Miles 
                   FROM   Test1 AS T2 
                   WHERE  T2.Route = T1.Route 
                          AND T2.IDNumber = (SELECT Min(IDNumber) 
                                             FROM   Test1 AS T3 
                                             WHERE  T3.Route = T1.Route 
                                                    AND T3.IDNumber > 
                                                        T1.IDNumber)) AS 
       Difference 
FROM   Test1 AS T1 
GROUP  BY T1.Date, 
          T1.Route, 
          T1.BookingID, 
          T1.StreetNumber, 
          T1.Street, 
          T1.Arrive, 
          T1.Perform, 
          T1.Miles, 
          T1.IdNumber, 
          T1.Status, 
          T1.Activityy 
HAVING (( ( [T1].[Miles] - (SELECT Miles 
                            FROM   Test1 AS T2 
                            WHERE  T2.Route = T1.Route 
                                   AND T2.IDNumber = (SELECT Min(IDNumber) 
                                                      FROM   Test1 AS T3 
                                                      WHERE  T3.Route = T1.Route 
                                                             AND T3.IDNumber > 
                                                     T1.IDNumber)) ) > 0 )) 
ORDER  BY T1.IdNumber; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:34:34.663

您的不同之处在于找到下一个里程记录。

如果您的数据库支持 row_number() 或 lag()，那么您可以使用 windows 函数而不是多个自联接来重写此查询。那应该可以解决性能问题。

否则，重写查询，使连接位于“from”子句中。这也应该解决问题。

最后，如果要使用临时表，请将所有结果放在临时表中，然后进行选择。（这不是我的首选方法，但对于一次性查询，它可能是最快的解决方案。）

# ruby-on-rails - 无法根据 rails 3.2 表单中 collection_select 的值更改复选框选项

> ID：10541394
> 
> 赞同：0
> 
> 时间：2012-05-10T20:11:13.190
> 
> 标签：ruby-on-rails, ruby-on-rails-3, partial-views, ruby-on-rails-3.2, rails-3.1

我在 Rails 3.2 中有一个用于在公司中创建用户的表单。每个公司都有网站。通过 collection_select 将站点分配给用户，然后每个站点都有许多使用复选框选择的部门。用户属于一个站点，并且可以属于该站点的多个部门。

我需要根据站点 collection_select 中的选定值更改部门复选框选项。

我一直在尝试通过使用 collection_select 的 :onchange 来调用包含部门的部分来做到这一点。我已经设法让它工作，但只显示公司的所有部门。不是每个站点的部门。我不明白如何将所选站点传递给部分站点，以便它可以返回正确的部门（如果这甚至可能的话）。

到目前为止，我的代码是：

形式：

```
 <%= form_for @user, :url => front_admin_users_path do |f| %>
      <%= devise_error_messages! %>

      <div><%= f.label :email %><br />
      <%= f.email_field :email %></div>

      <%= f.collection_select :role, User::ROLES, :to_s, :humanize %>

      <%= f.collection_select :site_id, current_user.company.sites.all, :id, :name, {}, :onchange => "jQuery.get('/load_department')",  :remote => true  %>

      <div id="department_frame"></div> 

      <div><%= f.label :password %><br />
      <%= f.password_field :password %></div>

      <div><%= f.label :password_confirmation %><br />
      <%= f.password_field :password_confirmation %></div>

      <div><%= f.submit "Sign up" %></div>
    <% end %> 
```

users_controller.rb：

```
 def load_department
       respond_to do | format |  
         format.js {render :layout => false}  
       end
     end 
```

load_department.js.erb：

```
 $("#department_frame").html( "<%=j render(:partial =>"department") %>" ); 
```

_department.html.erb：

```
 <% current_user.company.sites.each do |site| %>
<% for department in site.departments %>
    <%= check_box_tag "user[department_ids][]", department.id, current_user.department_ids.include?(department.id) %>
    <%= department.name %>
<% end %> 
```

我已经用谷歌搜索了几天试图找到解决方案，但找不到我真正需要的东西。我发现最接近的是 Ryan Bate 的动态集合选择，使用 grouped_collection_select 方法（我在项目的另一部分中使用过）进行了修改，但这似乎不适用于选择框。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T23:42:19.973

您可以尝试将 中的`site_id`作为参数传递`URL`给 AJAX 调用，然后在`controller`. 在该`controller`方法中，您还可以获取该`departments`特定对象的列表，`site`然后将其传递给`view`正在呈现的对象。

我已经编辑了代码的相关部分以更好地解释我的意思。希望这是有道理的:)

形式

```
<%= f.collection_select :site_id, current_user.company.sites.all, :id, :name, {}, :onchange => "jQuery.get('/load_department?site=' + $('#user_site_id').val())",  :remote => true  %> 
```

users_controller.rb：

```
def load_department
    site = params[:site]
    @departments = Site.find(site).departments

    respond_to do | format |  
        format.js {render :layout => false}  
    end
end 
```

_department.html.erb：

```
 <% for department in @departments %>
        <%= check_box_tag "user[department_ids][]", department.id, current_user.department_ids.include?(department.id) %>
        <%= department.name %>
    <% end %> 
```

# c++ - 结构与 int64 值

> ID：10541396
> 
> 赞同：1
> 
> 时间：2012-05-10T20:11:27.293
> 
> 标签：c++, 32bit-64bit

假设这是针对 32 位应用程序的。我有两个 ID 值，它们共同唯一标识特定对象。每个 ID 都是一个普通的 32 位 int，因此为了识别任何特定对象，我需要将两个 ID 值放在一起。

想到的第一个解决方案是将它们存储为两个单独的值，并在结构中传递它们：

```
struct {
    int id1;
    int id2;
}; 
```

但是，如果我可以将它们作为单个值而不是结构对传递，那就太好了，就像我在只有一个 32 位 ID 值时所做的那样。

因此，另一个想法是将它们存储为 uint64_t 的上半部分和下半部分。

我的问题是，这两种方法有什么真正的区别吗？无论哪种方式，都在传递相同数量的字节，但我不知道 int64 是否有任何特殊开销，因为 CPU 本身并不处理 64 位值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T20:18:16.323

最佳处理取决于实体的处理方式。如果通常/大部分是将两个子字段作为一个单元进行比较，则 int64 有效。如果它经常独立检查子字段，那么结构更自然。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:14:05.310

没有理由不使用该结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:22:53.487

如果您无法下定决心，请使用工会。

例如，微软定义了一个[`LARGE_INTEGER`union](http://msdn.microsoft.com/en-us/library/aa383713.aspx)。

# php - cURL 无法连接到主机

> ID：10541397
> 
> 赞同：1
> 
> 时间：2012-05-10T20:11:31.350
> 
> 标签：php, curl

如果我的流正在播放，我希望能够通过我的网站进行测试。所以它会相应地更新自己。

我正在使用 PHP - cURL 读取文件，但出现“无法连接到主机”错误。该脚本适用于其他 URL，但不是这个。

下面的 URL 也可以通过浏览器工作。

```
<?php
///if below doesn't work try this 86.28.144.85:88/broadwave.m3u?src=1&amp;rate=1///

$ch = curl_init("http://82.35.172.112:88/broadwave.m3u?src=p&rate=1");
$fp = fopen("example_homepage.txt", "w");

curl_setopt($ch, CURLOPT_FILE, $fp);
curl_setopt($ch, CURLOPT_HEADER, 0);

curl_exec($ch);
if(curl_errno($ch))
{
echo 'Curl error: ' . curl_error($ch);
}

curl_close($ch);
fclose($fp);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:15:04.990

“无法连接到主机”就是这个意思。很可能，防火墙阻止了与端口 88 的连接。

尝试将您的服务器移动到标准 HTTP 端口 80 或高端口，例如 8080。您可以使用[balance](http://www.inlab.de/balance.html)将您选择的端口上的所有内容简单地重定向到端口 88。

# c# - 是否可以使用 .NET 跟踪文件操作？

> ID：10541401
> 
> 赞同：8
> 
> 时间：2012-05-10T20:11:49.853
> 
> 标签：c#, .net, file

是否有可能以某种方式调用文件操作（例如打开或关闭），我可以在操作系统继续请求之前处理它，如果可能的话，由[.NET](http://en.wikipedia.org/wiki/.NET_Framework)取消它？如果 .NET 没有这样的能力，我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T21:50:07.663

您要求做的事情可以完成。例如，病毒扫描程序一直都在这样做。[您可以使用Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645)轻松监控文件活动。您也可以使用[FileSystemWatcher Class](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)在 C# 中以编程方式执行此操作。但是试图阻止程序打开或试图阻止程序访问文件不能在 C# 中完成。您将需要使用 C 或 C++。您需要创建一个[文件系统过滤器驱动程序](http://msdn.microsoft.com/en-us/windows/hardware/gg462968.aspx)。构建它是一件复杂的事情，但它正是您所需要的。引用 MSDN：

`A file system filter driver intercepts requests targeted at a file system or another file system filter driver. By intercepting the request before it reaches its intended target, the filter driver can extend or replace functionality provided by the original target of the request. Examples of file system filter drivers include anti-virus filters, backup agents, and encryption products.`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T20:21:50.767

如果您愿意，可以挂钩 Windows API。在 .NET/C# 中查看这种方式：

[EasyHook Windows API](http://www.codeproject.com/Articles/27637/EasyHook-The-reinvention-of-Windows-API-hooking)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T20:46:42.713

Sysinternals 提供了一个名为 Process Monitor 的免费工具，其中一个功能是附加到任意 Windows 进程（包括 .NET 应用程序）并捕获系统调用，包括文件打开、关闭、读取等。

您可以在[Process Monitor Download Page](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)下载它。

编辑

当我重新阅读您的问题时，我看到您在询问拦截并可能取消此类操作。我相信这个`FileSystemWatcher`类将是你最好的选择，虽然我不认为它可以单方面取消文件操作——你需要建立某种合作机制来通知调用者中止它的操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T21:43:18.563

我很确定你必须在这种操作上进入内核，我很确定这意味着你需要用 C 编写代码。看看[File System Drivers](http://msdn.microsoft.com/en-us/windows/hardware/gg462968)。

更新：这个[SO 链接](https://stackoverflow.com/questions/651171/usermode-file-system)可能会有所帮助。

[更新：添加了对Windows 文件系统驱动程序](https://www.google.com/search?q=windows%20file%20system%20drivers&oq=windows%20file%20system%20drivers&aqs=chrome..69i57j69i60l3.6059j0j7&sourceid=chrome&ie=UTF-8)的谷歌搜索

还有[什么是开始 Windows 文件系统驱动程序开发的好资源？](https://stackoverflow.com/questions/215605/what-is-a-good-resource-to-get-started-with-windows-file-system-driver-developme)

# asp.net-mvc-3 - Adobe Edge 幻灯片放映与 jquery ui 冲突

> ID：10541403
> 
> 赞同：0
> 
> 时间：2012-05-10T20:11:53.733
> 
> 标签：asp.net-mvc-3, jquery-ui, adobe-edge

我在 adobe edge 中制作了幻灯片

当我在 asp.net mvc3 razor 视图引擎中使用它时，我的 jquery 1.8 ui（模态对话框，拖放）不再工作

有谁知道我如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T18:27:34.203

Edge animate 默认使用 jquery 1.7。这可能是 jquery 调用的重复，因此请尝试删除边缘调用或将其替换为 1.8 版本。

# java - 使用字符串键管理嵌套映射

> ID：10541406
> 
> 赞同：0
> 
> 时间：2012-05-10T20:12:02.567
> 
> 标签：java, map, iterator, hashmap

当在方法中创建时，我可以`nestedMap`在我的迭代器中访问我的，如下所示：`nestedMap``put()`

```
@Override
public String put(final String row, final String column, final String value) {
    /**
     * Second map which is contained by centralMap, that contain Strings as
     * Keys and Values.
     */
    Map<String, String> nestedMap;

    if (centralMap.containsKey(row))
        nestedMap = centralMap.get(row);
    else
        nestedMap = new HashMap<String, String>();
    if (!nestedMap.containsKey(column))
        counter++;
    centralMap.put(row, nestedMap);
    return nestedMap.put(column, value);
} 
```

并且 centralMap 被声明为一个对象变量，

```
private final Map<String, Map<String, String>> centralMap; 
```

但仅在构造函数中实例化，如下所示：

```
centralMap = new HashMap<String, Map<String, String>>(); 
```

我试图实现的方法是 remove 方法：

```
@Override
    public void remove() {
        for (Map<String, String> map : centralMap.values()) {
            map = centralMap.get(keyName);
            iteratorNested.remove();
            if (map.size() <= 0)
                iteratorCentral.remove();
        }
    } 
```

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:49:24.053

不知道你到底在问什么，但我认为这更容易阅读：

```
@Override
public String put(final String row, final String column, final String value) {
    /**
     * Second map which is contained by centralMap, that contain Strings as
     * Keys and Values.
     */
    Map<String, String> nestedMap = centralMap.get(row);
    if (nestedMap == null) {
      nestedMap = new HashMap<String, String>();
      centralMap.put(row,nestedMap);
    }

    if (!nestedMap.containsKey(column))
        counter++;
    centralMap.put(row, nestedMap);
    return nestedMap.put(column, value);
} 
```

我不太明白您在第二节中在做什么，因此无法帮助您改进。而且我没有看到您的问题中提到的迭代器。

你让我猜，但也许在你的程序中的其他地方（它真的有助于查看更多代码，以及你正在寻找的特定函数原型或行为声明）你希望能够遍历`centralMap`实例的内容, 和 的嵌套实例`nestedMap`。是的你可以。

```
public void iterateOverAllNested()
{
   for (Map.Entry<String,Map<String,String>> nested : centralMap) {
     final String centralKey = nested.key();
     final Map<String,String> nestedMap = nested.value();
     System.out.println("Central map row/column: "+centralKey);
     for (Map.Entry<String,String> entry : nestedMap) {
       System.out.println(" key="+entry.key()+", value="+entry.value());
     }
   }
} 
```

请注意，这是气味。untyped`String`的嵌套映射可能是错误的。你最近有没有机会写 Perl？我建议您编写第二个 SO 问题，询问针对您的特定问题的良好数据结构。您可以将此代码作为您的起点，人们可能会提供更简洁的解决方案。

# jquery - 如何获取动态创建表行以等待 AJAX 调用返回的 Jquery 代码

> ID：10541407
> 
> 赞同：1
> 
> 时间：2012-05-10T20:12:07.573
> 
> 标签：jquery, ajax, dynamic, asynchronous, wait

所以我的页面上有一个链接“添加发货点”。这会出现一个对话框，让用户输入一些信息..当用户然后单击“保存运输点”时，对话框关闭，javascript 在屏幕上添加一个新行。

问题是，如果用户随后单击动态创建的行上的复选框并单击“删除发货点”，则该行不会被删除。

发生这种情况是因为创建新行的代码在 AJAX 调用之前执行此操作，该调用执行 db update 返回正确的 id。

所以我需要让代码在创建行之前等待 id。我在 Stack 上看到了类似的问题，但是调用的语法有点不同，所以我不确定如何让它适用于我的情况。

这是调用保存并创建新行的对话中的代码。

```
if (bValid) {
// make Ajax call save the Shipping Point and add to the list
var shipPointId = saveShippingPoint();                  

    // This alert when active does not have the id.
    //alert("Alert3:" + shipPointId);

if (shipPointId == "na") 
    {
        alert("There was a problem adding the Shipping Point.  Please try again.  If the problem persists please contact support.");
} 
    else 
    {
    $j("#shipPoints tr:last").after(
              "<tr>" 
            + "<td>" + city.val().toUpperCase() + ", " + state.val().toUpperCase() + "</td>" 
            + "<td>"
            + "<INPUT type='checkbox' NAME='chk' VALUE='"+ shipPointId + "' />"
            + "<INPUT type='hidden' NAME='shipPointId' VALUE='"+ shipPointId + "' />"
    + "</td>"+ "</tr>");
}
$j(this).dialog("close");
} 
```

这是使AJAX调用保存的代码......我在那里放了一个while循环来强制等待，就像临时更改一样，以确认这是问题......它等待的循环，并且该行已正确创建。如果没有该函数，它会立即向调用者返回一个未赋值的 id，并且它不起作用。所以需要知道让它等待的正确方法，这样我才能得到我需要的行为。

```
// Ajax call to add the Shipping Point to the Session
function saveShippingPoint() {

    var savedId = "";

    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
        if(xhr.readyState == 4) {
            savedId = xhr.responseText;
        }

    };      
    var url = '<portlet:resourceURL id="saveShippingPoint"/>';
    xhr.open("GET", url + 
       "?city=" + $j( "#city" ).val().toUpperCase() +
       "&state=" + $j( "#state" ).val().toUpperCase() +
       "&stateOther=" + $j( "#stateOther" ).val().toUpperCase() +
       "&zip=" + $j( "#zip" ).val() +
       "&product=" + $j( "#product" ).val().toUpperCase()
       , true);
    xhr.send();

    /* WHile loop just here to test and verify problem */
    while(xhr.readyState != 4) /* null statement */ ;       
    return savedId;
} 
```

在此先感谢，-吉姆

好的，根据前几个建议，我修改了代码，以便我使用 $.ajax 并定义成功回调方法，而不是自己操作 XmlHttpRequest。

作为 jquery 的新手，我在这里显然搞砸了一些语法，因为 Add Shipping Point 按钮没有关闭，也没有添加行......

这是新代码：

```
$j("#dialog-form").dialog(
{
    autoOpen : false,
    height : 500,
    width : 500,
    modal : true,
    buttons :
    {
        "Add Shipping Point" : function()
        {
            var bValid = true;
            var cityValid = true;
            var stateValid = true;
            var zipPresent = true;
            var zipValid = true;
            updateTips("");
            allFields.removeClass("ui-state-error");
            cityValid = checkRequired(city, "City");
            stateValid = checkRequired(state, "State");
            zipPresent = checkRequired(zip, "Zip");
            if(zipPresent) { zipValid = checkRegexp(zip, /(^\d{5}$)|(^\d{5}-\d{4}$)/, "Zip Code"); }
            bValid = cityValid && stateValid && zipPresent && zipValid;
            if (bValid)
            {
                saveShippingPoint();
                $j(this).dialog("close");
            }
        },
        Cancel : function()
        {
           $j(this).dialog("close");
        }
    },
    close : function()
    {
        allFields.val("").removeClass("ui-state-error");
    }
});
$j("#add-shipping-point").click(function()
{
    $j("#dialog-form").dialog("open");
    return false;
});
});
</script>
<script>
// Ajax call to add the Shipping Point to the Session
function saveShippingPoint()
{
$.ajax(
{
// This is a portal URL....which in reality has no spaces, it just didn't paste in very nicely
url: "/web/secure/!ut/p    /b1/jY7LUoMwGIWfpQ_g5CekGJdRKHek3FrYdCLN0DgUKlBUnl7sxpXo2Z2Z71xQgXIMVAVMASjao6Lho6z4INuG19--0A7xo51uEs1x9Sx- AntNrMAgBMBUZiCfAUUJXd81FaDPAGD7DnYjfa0A4P_l4Rcx- Cu_Q8UNWXpwAxYmAqs9C5TP2P3PVOJjHWxPswjoRAWKUYL2QA7xK30bjsb79bOcQiC0n_pqPMKH46bt4DUvnke7bFKzNGNbFuhGNLHVar6ZL5fvOt3164UKOr5KOKTvFxkU4WtbAa0LXl5Ep4YRR3ySqBzUW8e7DtznBj7Ao0UMN4!/" +
"?city=" + $j( "#city" ).val().toUpperCase() +
"&state=" + $j( "#state" ).val().toUpperCase() +
"&stateOther=" + $j( "#stateOther" ).val().toUpperCase() +
"&zip=" + $j( "#zip" ).val() +
"&product=" + $j( "#product" ).val().toUpperCase() ,
type: 'GET',
cache: false,
timeout: 30000,
success: function(data)
{
$j("#shipPoints tr:last").after(
"<tr>"
+ "<td>"
+ city.val().toUpperCase()
+ ", "
+ state.val().toUpperCase()
+ "</td>"
+ "<td>"
+ "<INPUT type='checkbox' NAME='chk' VALUE='"+ data + "' />"
+ "<INPUT type='hidden' NAME='shipPointId' VALUE='"+ data + "' />"
+ "</td>"
+ "</tr>");
}
});
return;
};
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:17:11.287

更改您的 saveShippingPoint 函数以使用 jQuery Ajax 函数（而不是自己构建和使用 xhr 对象），然后实现一个成功回调来更新您的表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:13:48.410

查看 jQuery 的[延迟](http://api.jquery.com/category/deferred-object/)对象。

# vim - 如何通过boost减少clang_complete搜索的时间

> ID：10541411
> 
> 赞同：7
> 
> 时间：2012-05-10T20:12:29.737
> 
> 标签：vim, boost, clang, code-completion, clang-complete

我喜欢在 vim 中使用 clang。

我一直遇到的一个问题是，每当我包含 boost 时，每次我输入 "." 时，clang 都会通过 boost 库。在对象名称之后。需要 5-10 秒。

由于我没有对提升标头进行更改，有没有办法通过提升缓存搜索？如果没有，有没有办法从自动完成搜索中删除提升？

**更新 (1)**以响应 adaszko 在 :let g:clang_use_library = 1 之后的回答

1.  我键入一个变量的名称。
2.  我按^N。Vim 开始搜索 boost 树。它自动完成变量。
3.  我按“。” 并得到以下错误：

> ```
> Error detected while processing function ClangComplete:
> line   35:
> Traceback (most recent call last):
> Press ENTER or type command to continue
> Error detected while processing function ClangComplete:
> line   35:
>   File "<string>", line 1, in <module>
> Press ENTER or type command to continue
> Error detected while processing function ClangComplete:
> line   35:
> NameError: name 'vim' is not defined
> Press ENTER or type command to continue
> Error detected while processing function ClangComplete:
> line   40:
> E121: Undefined variable: l:res
> Press ENTER or type command to continue
> Error detected while processing function ClangComplete:
> line   40:
> E15: Invalid expression: l:res
> Press ENTER or type command to continue
> Error detected while processing function ClangComplete:
> line   58:
> E121: Undefined variable: l:res
> Press ENTER or type command to continue
> Error detected while processing function ClangComplete:
> line   58:
> E15: Invalid expression: l:res
> Press ENTER or type command to continue 
> ```

...并且没有自动强制

**更新 (2)** 不确定 clang_complete 是否应该解决 boost 的问题。没有插件的 vim 会通过 boost 进行搜索。超级用户有一个[答案](https://superuser.com/questions/77800/vims-autocomplete-how-to-prevent-vim-to-read-some-include-files)可以通过 boost dirs 注释掉搜索`set include=^\\s*#\\s*include\ \\(<boost/\\)\\@!`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T07:08:06.967

所以，你至少有两个选择。选项 #1 设置`g:clang_use_library` 为`1`. 这是`:help g:clang_use_library`关于它的内容：

```
Instead of calling the clang/clang++ tool use libclang directly. This
gives access to many more clang features. Furthermore it automatically
caches all includes in memory. Updates after changes in the same file will
therefore be a lot faster. 
```

这需要 Python Vim 集成的工作设置。

选项 #2 设置`g:clang_complete_auto`为在 , ,`0`之后禁用自动完成`->`，并且可以随时使用手动调用 clang_complete 来代替。`.``::``<C-x> <C-o>`

我两个都用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T18:43:43.570

从[这里](https://superuser.com/questions/77800/vims-autocomplete-how-to-prevent-vim-to-read-some-include-files)，您可以将以下内容添加到您的`.vimrc`：

```
:set include=^\\s*#\\s*include\ \\(<boost/\\)\\@! 
```

（不过，通过 boost 缓存搜索的问题仍然悬而未决）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T21:37:25.147

我对 clang_complete 做了很多性能增强，你可以在 issue [#187](https://github.com/Rip-Rip/clang_complete/pull/187)中查看。问题的很大一部分是由于未优化的代码而导致的脚本性能较弱。

# visual-studio-2008 - 使用 Visual Studio 安装项目安装程序启动服务

> ID：10541415
> 
> 赞同：4
> 
> 时间：2012-05-10T20:12:55.013
> 
> 标签：visual-studio-2008, .net-2.0, windows-installer, setup-project

我有一个用于安装 Windows 服务的 Visual Studio 安装项目。该服务设置为自动运行，此时通过将我的服务添加为自定义操作可以正常安装。但是，我希望安装程序在安装完成后启动服务。这可能吗？

在相关说明中，我是否需要在卸载和/或升级时手动停止服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-06-21T06:47:13.753

在安装后覆盖自定义操作处理程序以启动 Windows 服务。尽管您设置了服务属性类型=自动，但除非我们明确启动，否则服务不会启动：

```
protected override void OnAfterInstall(IDictionary savedState)
{
        using (var sc = new ServiceController(serviceInstaller1.ServiceName))
        {
            sc.Start();
        }
} 
```

尽管我们使用自定义操作停止服务以进行卸载/升级，但 Visual Studio 安装程序并未停止 FileInUse 提示。似乎 VS Installer 没有太多复杂性来更改安装程序的顺序，因为我们无法控制这种行为。但是，最好停止卸载/升级服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:30:20.807

您也可以使用自定义操作来启动/停止服务。从您的自定义操作中，您只需调用以下实用程序：[http ://technet.microsoft.com/en-us/library/cc736564(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc736564(v=ws.10).aspx)

是的，对于升级/卸载，您应该在删除文件之前停止服务，这样您就可以避免操作系统提示“正在使用的文件”。

# php - Magento - 自定义模块结构

> ID：10541416
> 
> 赞同：2
> 
> 时间：2012-05-10T20:13:04.110
> 
> 标签：php, magento

嘿嘿，一段时间以来一直在研究 magento 主题（......而且我对系统的理解正在缓慢但稳定地增长）。我需要尽快开始处理一些自定义模块，所以我从这个小项目开始了解我的方向：

我找到了一些代码来管理我一直在复制并粘贴到模板文件中的特定任务：

```
<?php         
    $ids    = $_product->getCategoryIds(); 
    $cat    = Mage::getModel('catalog/category')->load($ids[0]);     
    $isFF   = false;
    foreach ($ids as $key=>$val) {
        $cat = Mage::getModel('catalog/category')->load($val);
        $name = $cat->getName(); 
        if ( $name === 'Fast Fulfillment' ) {
            $isFF = true;
        }
    }
    if ($isFF) { echo '<span class="ff-logo"></span>'; } 
?> 
```

非常简单。我只是检查产品是否属于特定类别，如果是，则生成一个元素。（我知道有大约 5 种可靠的方法可以做到这一点……这是我使用的方法）。

每次显示产品块时，我都需要对此进行测试，并且到目前为止，我一直在复制此代码以使其工作。它确实有效，但是是反击（我不应该将逻辑放入视图层）。

好的 - 所以，让我们制作一个简单的模块来共享功能：

**本地/WACI/ProductFlag/etc/config.xml**

```
<config>
    <modules>
        <WACI_ProductFlag>
            <version>0.1.0</version>
        </WACI_ProductFlag>
    </modules>
    <global>
        <blocks>
            <WACI_ProductFlag>
                <class>WACI_ProductFlag_Block_View</class>
            </WACI_ProductFlag>
        </blocks>
    </global>
</config> 
```

**等/模块/WACI_All.xml**

```
<config>
    <modules>
        <WACI_CustomPageLayouts>
            <codePool>local</codePool>
            <active>true</active>
        </WACI_CustomPageLayouts>
    </modules>
    <modules>
        <WACI_ProductFlag>
            <codePool>local</codePool>
            <active>true</active>
        </WACI_ProductFlag>
    </modules>
</config> 
```

现在，对于班级......我不确定 a`Block`或 a`Helper`是否合适。我去了`Block`，但是 - idk...我可能错了（这些东西的教程差异很大）。

**本地/WACI/ProductFlag/Block/View.php**

```
<?php

    /**
     * WACI
     * 
     * @codepool   Local
     * @category   View
     * @package    WACI
     * @module      ProductFlag  
     */

    class WACI_ProductFlag_Block_View extends Mage_Core_Block_Template
    {
        private $_focus;
        private $_isFF = false;

        public function getIsFF( $product ){
            $this->_focus = "FF";
            $isFF   = false;
            $ids    = $product->getCategoryIds(); 
            $cat    = Mage::getModel('catalog/category')->load($ids[0]);   

            foreach ($ids as $key=>$val) {
                $cat = Mage::getModel('catalog/category')->load($val);
                $name = $cat->getName(); 

                if ( $name === 'Fast Fulfillment' ) {
                    $isFF = true;
                }
            }
        }

        protected function _toHtml(){
            $html = parent::_toHtml();

            if ($this->_focus === "FF") {
                if ($this->_isFF){
                    $html .= '<span class="ff-logo"></span>';
                }
            }

            return $html;
        }
    }
?> 
```

希望很清楚，我只想根据任何给定产品的输入输出一个字符串。我应该覆盖`_toHtml()`传递字符串吗？再次。可能不是...

在我的**local.xml**中，我引用了该块：

```
<catalog_product_view>
<reference name="content">
            <reference name="product.info">
<block type="WACI/ProductFlag" name="product.flag" as="productFlag" output="toHtml" />... 
```

...我不清楚这是否实例化了这个类？我不这么认为。无论如何，我不确定如何在我的**product/view/media.phtml**中解决它，因为我需要调用带有参数的方法。

我认为我不需要模板文件，因为我只是输出一个字符串，但我认为我没有见过没有关联模板的块模块。也许一个助手类是合适的？

无论如何，它是行不通的。
我要么收到一个致命错误，说我的媒体类没有`getIsFF()`方法（不足为奇），要么什么都没有出现。我的配置文件是正确的，但仅此而已，我想。

杰布斯。*我都转了。*

有法师技能的人可以澄清这个简单的问题并指出正确的方向吗？

干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-14T14:48:45.113

没有建议？好吧=我提出了这个稍作修改且可行的解决方案：

**本地/WACI/ProductFlag/etc/config.xml**

```
<config>
    <modules>
        <WACI_ProductFlag>
            <version>0.1.0</version>
        </WACI_ProductFlag>
    </modules>
    <global>
        <blocks>
            <productflag>
                <class>WACI_ProductFlag_Block</class>
            </productflag>
        </blocks>
        <helpers>
            <productflag>
                <class>WACI_ProductFlag_Helper</class>
            </productflag>
        </helpers>
    </global>
</config> 
```

**本地/WACI/ProductFlag/Helper/Flag.php**

```
class WACI_ProductFlag_Helper_Flag extends Mage_Core_Helper_Abstract
    {
        private $_isFF = false;

        public function getIsFF( $product ){

            $html   = '';
            $ids        = $product->getCategoryIds(); 
            $cat        = Mage::getModel('catalog/category')->load($ids[0]);   

            foreach ($ids as $key=>$val) {
                $cat = Mage::getModel('catalog/category')->load($val);
                $name = $cat->getName(); 

                if ( $name === 'Fast Fulfillment' ) {
                    $this->_isFF = true;
                }
            }

            if($this->_isFF) { 
                $html = '<span class="ff-logo"></span>';
            }

            return $html;
        }

    } 
```

并通过简单的方法在任何模板文件中调用它：

```
<?php echo $this->helper('productflag/flag')->getIsFF($_product); ?> 
```

我仍然不确定这是否完全适合 magento 的做事方式 - 即模型调用，*我认为*，应该降级到他们自己的类并放在 Model 文件夹中。

无论如何——对于任何其他试图弄清楚这些东西的人——当我胡思乱想的时候，我慢慢意识到 config.xml 文件的目的是将可用的工厂类添加到块/帮助器/模型池中——并且路径是包含目录。然后，模板文件中的帮助程序调用识别目录的“短名称”，然后是实际的类名。

ie - 你可以有多个类别的助手：

```
<?php echo $this->helper('productflag/class_one')->someMethod($_product); ?>
<?php echo $this->helper('productflag/class_two')->someOtherMethod($_product); ?>
<?php echo $this->helper('productflag/class_three')->yetAnotherMethod($_product); ?> 
```

所以……更近了一步。

# ruby-on-rails - 有没有更红宝石的方式来做到这一点

> ID：10541418
> 
> 赞同：2
> 
> 时间：2012-05-10T20:13:20.873
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

好的，所以我有这个帮手

```
def current_company_title
 (Company.find_by_id(params["company_id"]).name rescue nil) || (@companies.first.name rescue nil) current_user.company.name
end 
```

基本上我用这个实现的是以下......

如果 param["company_id"] 存在，则尝试获取公司，如果不存在，则如果 @companies 存在，则获取第一个公司名称，如果不存在，则获取当前用户的公司名称

这行得通，但救援似乎是一种黑客行为......任何关于另一种方式来实现这一目标的想法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:19:13.873

确实救援是一种黑客，id'可能将其分成两种方法，然后用于`try`获取名称（如果可用）： http: [//api.rubyonrails.org/classes/Object.html#method-i-try](http://api.rubyonrails.org/classes/Object.html#method-i-try)

```
def current_company
  @current_company ||= Company.find_by_id(params[:company_id]) || @companies.try(:first) || current_user.try(:company)
end

def current_company_name
  current_company.try(:name)
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:20:25.343

少“魔法”，简单代码，简单易读：

```
def current_company_title
 company = Company.where(id: params["company_id"]).presence
 company ||= @companies.try(:first)
 company ||= current_user.company
 company.name
end 
```

附言。不是 Rails`try`方法的忠实拥护者，但它解决了问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T20:21:06.077

```
Company.find_by_id(params["company_id"]).name` 
```

`find`并且它的派生词应该在你确定你会得到积极的结果时使用，并且仅在某些情况下（行被删除等）错误。这就是它引发异常的原因。在你的情况下，你假设它会失败，所以`where`如果没有找到行，它会返回 nil ，它会做得更好，并删除第一个`rescue`

```
@companies.first.name rescue nil 
```

可以替换为

```
@companies.first.try(:name) 
```

我会让你检查 api 以了解更多关于`try`. 它不是普通的 ruby​​，它是 Rails 的补充。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T22:47:55.633

救援*是*一种黑客行为，如果发生其他错误，它们会掩盖它们。

尝试这个：

```
(Company.find_by_id(params["company_id"].name if Company.exists?(params["company_id"]) ||
(@companies.first.name if @companies && @companies.first) || 
current_user.company.name 
```

然后您可以将每个括号中的条件提取到它们自己的方法中，以使其更具可读性，并且更容易调整条件：

```
company_name_from_id(params["company_id"]) || name_from_first_in_collection(@companies) || current_user_company_name

def company_name_from_id(company_id)
  company=Company.find_by_id(company_id)
  company.name if company
end

def name_from_first_in_collection(companies)
  companies.first.name if companies && companies.first
end

def current_user_company_name
  current_user.company.name if current_user.company
end 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-10T20:34:33.757

```
def current_company_title
    if params["company_id"]
        return Company.find_by_id(params["company_id"]).name
    elsif @companies
        return @companies.first.name
    else
        return current_user.company.name
    end
end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-10T20:17:08.337

```
[Company.find_by_id(params["company_id"]),
  @companies.to_a.first,
  current_user.company
].compact.first.name 
```

# php - 将注释放在 createtable 语句的中间

> ID：10541421
> 
> 赞同：2
> 
> 时间：2012-05-10T20:13:36.880
> 
> 标签：php, mysql

我得到了这个创建表语句；

```
$sql = "CREATE TABLE TermsFinal(
    `seed`          INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `source`        varchar(100),
    `old_term`      varchar(255),
    `new_term`      varchar(100),
    `same_as`       varchar(100),
    `last_access`   datetime)"; 
```

有没有办法在此声明中添加评论，效果如下？

```
$sql = "CREATE TABLE TermsFinal(
    `seed`          INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    `source`        varchar(100),    //sample value services.media
    `old_term`      varchar(255),    // something like  "services.media>category:perspective"
    `new_term`      varchar(100),    // something like "opinion"
    `same_as`       varchar(100),    // the seed id of another record or another  "old_term" from this table 
    `last_update`   datetime)";      // when the last update took place 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:16:48.370

尝试遵循 SQL 注释语法，但要小心文本中的 "

```
$sql = "CREATE TABLE TermsFinal( 
    `seed`          INT NOT NULL AUTO_INCREMENT PRIMARY KEY, 
    `source`        varchar(100),    -- sample value services.media 
    `old_term`      varchar(255),    -- something like  "services.media>category:perspective" 
    `new_term`      varchar(100),    -- something like "opinion" 
    `same_as`       varchar(100),    -- the seed id of another record or another  "old_term" from this table  
    `last_update`   datetime)";      // when the last update took place 
```

[阅读更多...](http://dev.mysql.com/doc/refman/5.1/en/comments.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:21:19.270

您必须在您仍在 sql 语句中的行中使用 sql 注释。对于 mysql，这将是：

```
$sql = "CREATE TABLE TermsFinal(
`seed`          INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
`source`        varchar(100),    /* sample value services.media */
`old_term`      varchar(255),    /* something like  "services.media>category:perspective" */
`new_term`      varchar(100),    /* something like "opinion" */
`same_as`       varchar(100),    /* the seed id of another record or another  "old_term" from this table */
`last_update`   datetime)";      // when the last update took place 
```

# c# - 如何在 WPF 中将一个 ResourceDictionary 导入到另一个中？

> ID：10541424
> 
> 赞同：23
> 
> 时间：2012-05-10T20:13:50.460
> 
> 标签：c#, .net, wpf, xaml, resourcedictionary

是否可以将一个资源字典添加到另一个资源字典中？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-11T03:30:27.563

在 Dictionary2.xaml 中定义 MergedDictionaries（紧跟在打开 ResourceDictionary 标记之后）：

```
<ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="/Path/to/Dictionary1.xaml" />
</ResourceDictionary.MergedDictionaries> 
```

有一个问题：每次合并字典时，您都会有效地创建合并字典的副本。它是递归的 - 如果您有 Dict3.xaml 和 Dict4.xaml 都加载 Dictionary2.xaml，您将创建 Dictionary1.xaml 的三个实例

解决方案是[SharedResourceDictionary](http://www.wpftutorial.net/MergedDictionaryPerformance.html)。本教程中的实现应该被视为一个起点，并且可能需要进行一定程度的调整 - 取决于使用场景。谷歌“wpf SharedResourceDictionary”了解一些问题和解决方案。

从[XAMeLi对](https://stackoverflow.com/users/586553/xameli)[这个问题](https://stackoverflow.com/questions/10380597/style-inheritance-based-on-different-xaml)的回答

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-11T03:23:59.267

我正在处理的一个草图流项目中的一个片段直接显示了如何在 xaml 中合并资源字典：

```
<Application.Resources>
    <!-- Resources scoped at the Application level should be defined here. -->
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="/Microsoft.Expression.Prototyping.SketchControls;component/ScrollViewerStyles.xaml"/>
            <ResourceDictionary Source="/[ProjectABC];component/[fileXYZ].xaml"/>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources> 
```

这显示了将两个额外的资源字典合并到另一个资源字典中。

（请注意，如果您在多个地方定义了默认样式，则顺序会变得很重要，因为它们会相互覆盖）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:25:05.400

就像是：

```
ResourceDictionary resources = new ResourceDictionary();
resources.Source = new Uri("/MyModule;component/MyModule.xaml", 
     UriKind.RelativeOrAbsolute);
Application.Current.Resources.MergedDictionaries.Add(resources); 
```

可能是你正在寻找的。我们在 Prism 模块中使用这样的代码。

# wpf - 使用 Sharpdevelop Addin Architecture 开发 WPF 应用程序

> ID：10541427
> 
> 赞同：0
> 
> 时间：2012-05-10T20:13:57.947
> 
> 标签：wpf, add-in, sharpdevelop

我是这个 AddIns 架构的新手，但它对我来说真的很吸引人。我下载了 shardevelop 代码来理解它，但它太大了，并且给出的示例使用的是 Winforms。我想使用 WPF。您能否提供一些他们在 WPF 中使用了 sharpdevelop 的链接？

问候， 普里扬克·塔卡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T03:30:59.300

在大多数情况下，SharpDevelop 代码库是您最好的资源。

顺便说一句，你检查过微软的 MEF 吗？

[http://msdn.microsoft.com/en-us/library/dd460648.aspx](http://msdn.microsoft.com/en-us/library/dd460648.aspx)

# java - 用于多个文本输入的多个 else if 语句检查

> ID：10541435
> 
> 赞同：0
> 
> 时间：2012-05-10T20:14:31.660
> 
> 标签：java, android, if-statement

我有 5 个数字文本编辑器和一个按钮。单击按钮时，应用程序会根据哪个字段留空来计算不同的方程式。但是，当我将多个字段留空时应用程序不断崩溃，错误是第一个 if 语句中的第一个 double 无效。

代码的想法

```
if (first field.getText().toString().equals("")) {...}
else if (second field.getText().toString().equals("")) {...}
else if (third field.getText().toString().equals("")) {...}
else if (fourth field.getText().toString().equals("")) {...}
else if (fifth.getText().toString().equals("")) {...}
else {...} 
```

基本上最后一个应该只是敬酒，如果不是上述任何一个（2-5个空，0个空

真正的语法是这样的：

```
 calc.setOnClickListener(new OnClickListener() {         
            public void onClick(View v) {
                EditText fv = (EditText) findViewById(R.id.pv_fv);
                EditText pv = (EditText) findViewById(R.id.pv_pv);
                EditText r = (EditText) findViewById(R.id.pv_discountrate);
                EditText n = (EditText) findViewById(R.id.pv_periods);
                EditText t = (EditText) findViewById(R.id.pv_years);

                if (fv.getText().toString().equals("")) {
                    double r1 = Double.parseDouble(r.getText().toString());
                    double n1 = Double.parseDouble(n.getText().toString());
                    double t1 = Double.parseDouble(t.getText().toString());
                    double pv1 = Double.parseDouble(pv.getText().toString());
                    double answer1 = pv1*(Math.pow(1+(r1/n1) ,n1*t1 ));
                    answer1 = (double)(Math.round(answer1*100))/100;
                    TextView answer = (TextView) findViewById(R.id.pv_answer);
                    answer.setText("The Future Value of the cash flow is: "+answer1);
                }

                else if (pv.getText().toString().equals("")) {
                    double fv1 = Double.parseDouble(fv.getText().toString());
                    double r1 = Double.parseDouble(r.getText().toString());
                    double n1 = Double.parseDouble(n.getText().toString());
                    double t1 = Double.parseDouble(t.getText().toString());
                    double answer1 = fv1/(Math.pow(1+(r1/n1) ,n1*t1 ));
                    answer1 = (double)(Math.round(answer1*100))/100;
                    TextView answer = (TextView) findViewById(R.id.pv_answer);
                    answer.setText("The Present Value of the cash flow is: "+answer1);                      
                }

                else if (r.getText().toString().equals("")){
                    double fv1 = Double.parseDouble(fv.getText().toString());
                    double pv1 = Double.parseDouble(pv.getText().toString());
                    double n1 = Double.parseDouble(n.getText().toString());
                    double t1 = Double.parseDouble(t.getText().toString());
                    double answer1 = ( (Math.pow(fv1/pv1, 1/(n1*t1) ) ) -1)*n1 ;
                    answer1 = (double)(Math.round(answer1*100))/100;
                    TextView answer = (TextView) findViewById(R.id.pv_answer);
                    answer.setText("The discount rate / interest rate applied is: "+answer1);
                }

                else if (t.getText().toString().equals("")){
                    double fv1 = Double.parseDouble(fv.getText().toString());
                    double pv1 = Double.parseDouble(pv.getText().toString());
                    double n1 = Double.parseDouble(n.getText().toString());
                    double r1 = Double.parseDouble(r.getText().toString());
                    double answer1 = Math.log(fv1/pv1) / (n1* Math.log(1+(r1/n1) ) ) ;
                    answer1 = (double)(Math.round(answer1*100))/100;
                    TextView answer = (TextView) findViewById(R.id.pv_answer);
                    answer.setText("The number of years is: "+answer1);
                }

                else if(n.getText().toString().equals("")){
                    Toast errormsg = Toast.makeText(PresentValue.this, "Sorry but Number of Periods cannot be computed.", 5000);
                    errormsg.setGravity(Gravity.CENTER, 0, 0);
                    errormsg.show();
                }

                else {
                    Toast errormsg = Toast.makeText(PresentValue.this, "You either left too many fields empty or filled all of them.", 5000);
                    errormsg.setGravity(Gravity.CENTER, 0, 0);
                    errormsg.show();
                }

            }           
        }); 
```

知道这有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:17:58.523

假设您只有这五个字段 -`else`只有当没有字段为空时，才能访问该语句。

如果只有一个是空的，它将被相关的 if 语句捕获 - 它在这方面工作正常。
如果两个或更多是空的 - 它只会被捕获一次，在第一个 if 条件适用 - 这似乎不是你想要的。
如果没有一个是空的 -`else`尽管没有一个是空的，但将达到声明 - 这显然是你的意思。

另一种方法可能是不使用`else if`语句，而仅使用`if`s，并计算故障数。如果它高于 1 - 多个字段为空。如果为 0 - 没有字段为空。是否可以应用当然取决于每个语句块的实际内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:31:18.030

将字段的名称或引用放入 a`List`或`Set`中。然后，您可以轻松检索之后需要的空的。

和

```
if (emptyFieldSet.size() > 1) {
    toast that says "error multiples are empty"
} 
```

比`else`oodles of `if`s 之后的最后一条语句更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-14T01:23:52.867

这就是我解决它的方法。然而，它似乎真的......闷。有没有办法让它看起来更无缝？

```
//clickhandler
        calc.setOnClickListener(new OnClickListener() {         
            public void onClick(View v) {
                EditText fv = (EditText) findViewById(R.id.pv_fv);
                EditText pv = (EditText) findViewById(R.id.pv_pv);
                EditText r = (EditText) findViewById(R.id.pv_discountrate);
                EditText n = (EditText) findViewById(R.id.pv_periods);
                EditText t = (EditText) findViewById(R.id.pv_years);
                TextView answer = (TextView) findViewById(R.id.pv_answer);
                int filledfields = 0;

                if (fv.getText().toString().equals("")){
                    filledfields ++;
                }
                if (pv.getText().toString().equals("")) {
                    filledfields ++;
                }
                if (r.getText().toString().equals("")) {
                    filledfields ++;
                }
                if (t.getText().toString().equals("")) {
                    filledfields ++;
                }
                if (n.getText().toString().equals("")) {
                    filledfields ++;
                }

                if (filledfields > 1){
                    Toast errormsg = Toast.makeText(PresentValue.this, "Sorry but you left more than one field empty.", 5000);
                    errormsg.setGravity(Gravity.CENTER, 0, 0);
                    errormsg.show();
                }

                else if (fv.getText().toString().equals("")) {
                    double r1 = Double.parseDouble(r.getText().toString());
                    double n1 = Double.parseDouble(n.getText().toString());
                    double t1 = Double.parseDouble(t.getText().toString());
                    double pv1 = Double.parseDouble(pv.getText().toString());
                    double answer1 = pv1*(Math.pow(1+(r1/n1) ,n1*t1 ));
                    answer1 = (double)(Math.round(answer1*100))/100;

                    answer.setText("The Future Value of the cash flow is: "+answer1);
                }

                else if (pv.getText().toString().equals("")) {
                    double fv1 = Double.parseDouble(fv.getText().toString());
                    double r1 = Double.parseDouble(r.getText().toString());
                    double n1 = Double.parseDouble(n.getText().toString());
                    double t1 = Double.parseDouble(t.getText().toString());
                    double answer1 = fv1/(Math.pow(1+(r1/n1) ,n1*t1 ));
                    answer1 = (double)(Math.round(answer1*100))/100;

                    answer.setText("The Present Value of the cash flow is: "+answer1);                      
                }

                else if (r.getText().toString().equals("")){
                    double fv1 = Double.parseDouble(fv.getText().toString());
                    double pv1 = Double.parseDouble(pv.getText().toString());
                    double n1 = Double.parseDouble(n.getText().toString());
                    double t1 = Double.parseDouble(t.getText().toString());
                    double answer1 = ( (Math.pow(fv1/pv1, 1/(n1*t1) ) ) -1)*n1 ;
                    answer1 = (double)(Math.round(answer1*100))/100;

                    answer.setText("The discount rate / interest rate applied is: "+answer1);
                }

                else if (t.getText().toString().equals("")){
                    double fv1 = Double.parseDouble(fv.getText().toString());
                    double pv1 = Double.parseDouble(pv.getText().toString());
                    double n1 = Double.parseDouble(n.getText().toString());
                    double r1 = Double.parseDouble(r.getText().toString());
                    double answer1 = Math.log(fv1/pv1) / (n1* Math.log(1+(r1/n1) ) ) ;
                    answer1 = (double)(Math.round(answer1*100))/100;

                    answer.setText("The number of years is: "+answer1);
                }

                else if(n.getText().toString().equals("")){
                    Toast errormsg = Toast.makeText(PresentValue.this, "Sorry but Number of Periods cannot be computed.", 5000);
                    errormsg.setGravity(Gravity.CENTER, 0, 0);
                    errormsg.show();
                }

                else {
                    Toast errormsg = Toast.makeText(PresentValue.this, "You either left too many fields empty or filled all of them.", 5000);
                    errormsg.setGravity(Gravity.CENTER, 0, 0);
                    errormsg.show();
                }

            }           
        });
        //clickhandler end 
```

# php - 标头位置相对路径兼容性

> ID：10541439
> 
> 赞同：32
> 
> 时间：2012-05-10T20:14:39.510
> 
> 标签：php, html, redirect, header

这个**相对位置**html 标头是否与所有平台上的所有浏览器绝对兼容？有什么标准吗？

```
Location: some_script.php?la=2&po=2030 
```

我的意思是，它是否总是重定向到当前目录中的 some_script.php ？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-10T20:15:54.093

标准是这样的：

```
header('Location: http://www.mywebsite.com/yourpage.php?id=32', TRUE, 302); 
```

但是要回答您的问题，是的，如果您不首先放置斜杠或完整的 URL，它将重定向到当前文件夹中的页面 X。

这是我建议您为您所做的每个网站做的一个想法。在您的主文件（您使用的主 php 文件，如 config 或其他文件）中，创建类似的内容：

```
define('URL', 'http://www.mywebsite.com/'); 
```

因此，当您创建重定向、链接或其他任何内容时，您可以这样做：

```
header('Location: '.URL.'yourpage.php?id=32', TRUE, 302); 
```

编辑：2017 年 11 月。正如下面 @jordanbtucker 所指出的，HTTP 规范已于 2014 年 6 月更新（这篇文章来自 2012 年），以允许 Location 标头中的相对 URI。

# wmic - 使用 wmic 访问 Bcd 失败

> ID：10541440
> 
> 赞同：0
> 
> 时间：2012-05-10T20:14:50.960
> 
> 标签：wmic, bcdstore

当我尝试使用 wmic 访问 BcdStore 类的 EnumerateObjects 方法时出现错误。

我最初运行 GetSystemDisk 方法是为了查看我可以访问 BcdStore（见下文）。这工作得很好。

> ****__ *_* __ *_* __ *_* __ *_* __****cmd窗口输出开始*****__ *_* __ *_* __ *_* __ *_* __ *_* ___*******
> 
>  *****C:>wmic /namespace:\root\wmi 类 BcdStore 调用 GetSystemDisk
> 
> 执行 (BcdStore)->GetSystemDisk()
> 
> 方法执行成功。
> 
> 输出参数：
> 
> __PARAMETERS 的实例
> 
> {
> 
> ```
>  Disk = "\\Device\\Harddisk0\\DR0";
> 
>     ReturnValue = TRUE; 
> ```
> 
> };
> 
> ****__ *_* __ *_* __ *_* __ *_* __****cmd窗口输出结束*****__ *_* __ *_* __ *_* __ *_* __ *_* ___************

 ******然后我运行了 EnumerateObjects 方法，但是失败了，请看下面。不同的版本只是如何将参数传递给方法的不同变体，但这不起作用。

> ****__ *_* __ *_* __ *_* __ *_* __****cmd窗口输出开始*****__ *_* __ *_* __ *_* __ *_* __ *_* ___*******
> 
>  *****C:>wmic /namespace:\root\wmi 类 BcdStore 调用 EnumerateObjects 10200003
> 
> 执行 (BcdStore)->EnumerateObjects()
> 
> 错误：
> 
> 说明 = 方法参数无效
> 
> C:>wmic /namespace:\root\wmi class BcdStore call EnumerateObjects Type=10200003
> 
> 执行 (BcdStore)->EnumerateObjects()
> 
> 错误：
> 
> 说明 = 方法参数无效
> 
> C:>wmic /namespace:\root\wmi 类 BcdStore 调用 EnumerateObjects Type="H10200003"
> 
> 错误：
> 
> 描述 = 类型不匹配。
> 
> C:>wmic /namespace:\root\wmi 类 BcdStore 调用 EnumerateObjects 0x10200003
> 
> 错误：
> 
> 描述 = 类型不匹配。
> 
> ****__ *_* __ *_* __ *_* __ *_* __****cmd窗口输出结束*****__ *_* __ *_* __ *_* __ *_* __ *_* ___************

 ******任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T20:40:16.777

这不是一个答案，因为我不确定是否真的了解您想要做什么，但它可以解释为什么您所做的事情不起作用。

以下是有效的，因为`GetSystemDisk`是类的静态方法`BcdStore`：

```
wmic /namespace:\root\wmi class BcdStore call GetSystemDisk 
```

正如您在*WMI Cim studio*的方法限定符中看到的那样：

![在此处输入图像描述](../Images/3bfb84e0ebf79e21d9c2b057f04e3e28.png)

**但是** `EnumerateObjects`是类的实例方法`BcdStore`，所以不能从类本身调用，必须从实例调用。*WMI 对象浏览器*在我的 W2K8R2 上没有显示任何实例`BcdStore`。

![在此处输入图像描述](../Images/4f4a579a45dc2738ffd6efc967190153.png)************

# sql - 选择日期 = 日

> ID：10541447
> 
> 赞同：4
> 
> 时间：2012-05-10T20:15:28.820
> 
> 标签：sql, sql-server, sql-server-2008

我有一个包含日期时间类型列的表。我想做一个查询，选择该日期发生的所有行。基本上，

```
SELECT * FROM Table
WHERE [timeStamp] = '02-15-2003' 
```

但这只会返回 [timeStamp] 为 '02-15-2003 00:00:00.000' 的行，但实际上我想要那天任何时候的行。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-10T20:21:43.763

如果你有索引，你会想要一些不会阻止索引被使用的东西：

```
SELECT *
FROM Table 
WHERE [timeStamp] >= '20030215'
      AND [timeStamp] < '20030216' 
```

您可以对`[timeStamp]`列执行截断操作以消除任何时间部分（依赖于实现），但这可能会损害执行计划。不幸的是，您确实必须查看执行计划才能看到这一点，因为有时优化器对某些功能很聪明，有时则不然。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-10T20:19:25.387

如果您使用的是 SQL 2008，则应该 CAST to DATE。

```
select * from [Table]
where cast([timeStamp] as date) = '02-15-2003' 
```

[在 SQL Server 中删除日期时间的时间部分的最佳方法](https://stackoverflow.com/questions/1177449/best-approach-to-remove-time-part-of-datetime-in-sql-server)

- - 更新 - -

评论者应该在 2012 年用来描述为什么这不是最佳解决方案的词是[sargability](https://en.wikipedia.org/wiki/Sargable)。更改 WHERE 子句中的数据类型虽然是最简单的解决方案，但对索引使用有影响，而有界搜索则不会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:16:36.607

  在 sql server 2008 + 中：

```
 SELECT * FROM Table
        WHERE cast( [timeStamp] as date)  = '02-15-2003' 
```

或者

只是零时间部分：（2005+）

```
 SELECT * FROM Table
    WHERE DateAdd(day, DateDiff(day, 0, [timeStamp]), 0)  = '02-15-2003' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-07T20:19:32.007

MS SQL 2014，这很完美：

```
SELECT [YourDateColumn] FROM [YourTable] WHERE(DATEPART(dd,[YourDateColumn]) = '29') 
```

在非常大的数据库上可能会有一些性能问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T21:17:59.983

试试这个.. SQL SERVER

```
SELECT * FROM Table WHERE convert(date,[timestamp]) = '2003-02-15' 
```

应该返回指定日期的所有行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-11T15:33:35.447

我将创建一个接受“开始日期”和“结束日期”的存储过程

在这种情况下，开始日期和结束日期可以相同

这可确保返回从上午 12:01 到晚上 11:59 的所有行

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

Create PROCEDURE  TestBetweenDates
    -- Add the parameters for the stored procedure here
    @StartDate DateTime = 0, 
    @EndDate DateTime = 0
AS
BEGIN

    SET NOCOUNT ON;

        SET @StartDate = cast(Convert(varchar(10), DateAdd(d, -6, @StartDate ), 101) + ' 12:01 AM' as datetime)

        SET @EndDate = cast(Convert(varchar(10), DateAdd(d, -0, @EndDate), 101) + ' 11:59 PM' as datetime)

SELECT * FROM Table
WHERE ([timeStamp] BETWEEN @StartDate AND @EndDate) 

END
GO 
```

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2012-05-10T20:23:16.263

日期比较可能是一件棘手的事情。

请记住，它是日期时间而不是字符串。这就是为什么你会得到意想不到的结果。

对于您想到的特定查询，适当的查询是

```
SELECT * FROM Table 
WHERE 0 = datediff(day,[timestamp],'02-15-2003') 
```

您也可以按返回整数值的月（）和年（）进行比较。

您通常必须编写自定义函数来获得重要的比较。

另请注意

```
WHERE 0 = datediff(day,[timestamp],'02-15-2003') 
```

比

```
WHERE datediff(day,[timestamp],'02-15-2003') = 0 
```

前者不干扰内部效率，而后者则干扰。

# javascript - 基于另一个文本框的输入更新文本框的Javascript

> ID：10541449
> 
> 赞同：0
> 
> 时间：2012-05-10T20:15:37.497
> 
> 标签：javascript, textbox

我基本上想使用 javascript 来拥有 2 个相互依赖的文本框。例如，如果我在 textbox1 中输入一个数字 x，我希望 textbox2 立即更新为 x*2。如果我在 textbox2 中输入 x，我希望 textbox1 自动更新为 x/2。这些值将始终是数字。

编辑：所以这是我的 html 文件。谁能给我一个提示为什么它不起作用？

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script type="text/javascript" src="scripts/jquery-1.7.2.js"></script>
    <script type="text/javascript">
        $("#text1").keyup(function(){
            $("#text2").val($(this).val() * 2);
        });
        $("#text2").keyup(function(){
            $("#text1").val($(this).val() / 2);
        });        
    </script>
</head>
<body>
    <input type="text" name="text1" size=3 maxlength=6>
    <input type="text" name="text2" size=3 maxlength=6>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:20:23.443

在非常简单的情况下，应该这样做（[在这里小提琴](http://jsfiddle.net/rjzaworski/ETYgD/)）：

```
// in a <script>:
window.update = function() {
  var one = document.getElementById('one'),
      two = document.getElementById('two');    

  two.value = parseInt(one.value) * 2;
}​

<!-- in your HTML: -->
<input id="one" type="text" onchange="update();" />
<input id="two" type="text" />​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:19:45.573

```
$("#textbox1").onkeyup(function() {
    $("#textbox2").val($(this).val() * 2);
});

$("#textbox2").onkeyup(function() {
    $("#textbox1").val($(this).val() / 2);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:18:01.770

我现在无法测试您需要的确切代码，但基本想法是在每个框上放置一个 OnKeyUp 事件并通过脚本修改另一个框（使用 getElementById 或您喜欢的任何方法）

如果其他人没有先得到它，我会尽可能地整理一些代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T20:19:47.977

使用 onchange 事件或 jquery 更改回调来更新其他框。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-03T02:57:41.920

在这种情况下，应该这样做：http: [//jsfiddle.net/du09jhpd/](http://jsfiddle.net/du09jhpd/)

```
window.update = function() {
  var one = document.getElementById('one'),
      two = document.getElementById('two');    

  two.value = parseInt(one.value) * 2;
}
window.update1 = function() {
  var one = document.getElementById('one'),
      two = document.getElementById('two');    

  one.value = parseInt(two.value) / 2;
} 
```

# c# - 想要在另一个页面中显示一个页面的结果？

> ID：10541451
> 
> 赞同：1
> 
> 时间：2012-05-10T20:15:42.253
> 
> 标签：c#, windows-phone-7

我已经使用独立存储创建了一个 windows phone 7 应用程序。在这个应用程序中，我使用了一个名为 btnRead 的按钮、一个名为 txtRead 的文本块和一个名为 txtWrite 的文本框。如果我在文本框（txtWrite）中写入内容并单击按钮（btnRead）。然后文本块（txtRead）显示或保存我在文本框上写的任何内容（所有这些都是在单个 MainPage.xaml 中创建的）。现在我创建了另一个 page1.xaml 并创建了一个名为 txtShow 的文本块。但我希望 textblock(txtShow) 显示我在 MainPage.xaml 中的文本框上写的所有内容。我还上传了我的项目- [https://skydrive.live.com/redir.aspx?cid=ea5aaefa4ad2307a&resid=EA5AAEFA4AD2307A!133&parid=EA5AAEFA4AD2307A!109](https://skydrive.live.com/redir.aspx?cid=ea5aaefa4ad2307a&resid=EA5AAEFA4AD2307A!133&parid=EA5AAEFA4AD2307A!109)

下面是我使用过的 MainPage.xaml.cs 源 - ：

```
 private void button1_Click(object sender, RoutedEventArgs e)
    {
        IsolatedStorageFile myStore = IsolatedStorageFile.GetUserStoreForApplication();
        myStore.CreateDirectory("Bookmark");

        using (var isoFileStream = new IsolatedStorageFileStream("Bookmark\\myFile.txt", FileMode.OpenOrCreate, myStore))
        {
            //Write the data
            using (var isoFileWriter = new StreamWriter(isoFileStream))
            {
                isoFileWriter.WriteLine(txtWrite.Text);
            }
        }

        try
        {
            // Specify the file path and options.
            using (var isoFileStream = new IsolatedStorageFileStream("Bookmark\\myFile.txt", FileMode.Open, myStore))
            {
                // Read the data.
                using (var isoFileReader = new StreamReader(isoFileStream))
                {
                    txtRead.Text = isoFileReader.ReadLine();
                }
            }
        }
        catch
        {
            // Handle the case when the user attempts to click the Read button first.
            txtRead.Text = "Need to create directory and the file first.";
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:41:32.293

如果您在同一页面的 TextBlock 中显示来自 TextBox 的文本，则通过绑定更容易做到这一点

```
<TextBox x:Name="txtWrite"/>
<TextBlock  Text="{Binding Text, ElementName=txtWrite}"/> 
```

要将此信息放入下一页，您可以将其放入 NavigationContext 以传递到下一页

```
 // Navigate to Page1 FROM MainPage 
    // This can be done in a button click event
    NavigationService.Navigate(new Uri("/Page1.xaml?text=" + txtWrite.Text, UriKind.Relative));

// Override OnNavigatedTo in Page1.xaml.cs
protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
{
    string text;
    NavigationContext.QueryString.TryGetValue("text", out text);
    txtRead.Text = text;
} 
```

如果您喜欢使用 IsoStorage，您可以像上面在 OnNavigatedTo 方法中所做的那样进行读取。

# node.js - Windows 上的 nodejs 和 websockets

> ID：10541453
> 
> 赞同：3
> 
> 时间：2012-05-10T20:15:44.397
> 
> 标签：node.js, websocket, socket.io

我浏览了许多关于 websockets、nodejs 和 socket.io 的帖子，但找不到这个问题的答案。

我想建立一个使用nodejs开发websockets应用程序的开发环境。我更喜欢运行 Windows，因为我有运行 Windows 的物理硬件，而且我对 VS 非常熟悉，但如果需要，我可以设置一个运行 nginx 或 apache 的 Linux 机器。我探索了 iisnode，它对 node.js 有很好的支持，但由于 IIS 7.* 不支持 websockets，所以不支持 websockets。我也知道 Windows 8 支持 websockets，但我需要 Server 2008 R2 和 Windows 7 来完成其他任务，所以我想在它发布之前避免这种情况。

对于使用带有或不带有 windows 的 nodejs 作为服务器开发环境的 websockets 的其他开发人员来说，什么工作得很好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T00:48:25.650

我正在将 NodeJS 与 WAMP（win x64 php 5.x、apache 2.2.x、mysql 5.x）一起使用，我对此非常满意，除了在浏览器和 NodeJS 之间保持长时间套接字连接的一些问题（套接字.io)。因为它本身就是一个套接字服务器（使用 socket.io），所以我没有任何与 apache 的挂钩！它是纯 JavaScript。如果我需要与 apache/php/mysql 交互，我只是做一些帖子请求......还有与 mysql 交互的模块。

# image - 使用可配置产品图像的关联产品

> ID：10541461
> 
> 赞同：1
> 
> 时间：2012-05-10T20:16:17.433
> 
> 标签：image, magento, configurable-product

我希望创建的关联简单产品显示与其所属的可配置产品相​​同的“基本”图像。

我有一家出售衬衫的 magento 商店，每件衬衫都有 3-5 种相关产品，我不想在创建后为所有简单产品上传相同的图像，这非常耗时。

我搜索了类似的问题，发现一个线程建议在 /app/design/frontend/base/default/template/catalog/product/view/media.phtml 中添加以下代码

$_parentIdArray = Mage::getModel('catalog/product_type_configurable')->getParentIdsByChild($_product->getId()); if(sizeof($_parentIdArray)==1 && Mage::getModel('catalog/product')->load($_parentIdArray[0])->getTypeId() == 'configurable'){ $_product = Mage:: getModel('目录/产品')->load($_parentIdArray[0]); }

之后：$_product = $this->getProduct();

然而，简单的产品现在仍然显示可配置的产品图像。

提前致谢！

# mysql - 将聚合添加到 django 查询集

> ID：10541462
> 
> 赞同：0
> 
> 时间：2012-05-10T20:16:19.117
> 
> 标签：mysql, django, aggregate-functions, aggregation

希望简单的问题。我有一组查询动作，每个动作都有一个 time_estimate。我想获得查询集中所有操作的平均 time_estimate 以便返回平均值：

```
{{ actions.avg_time_estimate }} 
```

我试过

```
actions.avg_time_estimate = actions.aggregate(Avg('time_estimate')) 
```

但这是为actions.avg_time_estimate分配一个字典，这意味着我的平均值是这样的：

```
{{ actions.avg_time_estimate.effort__avg }} 
```

将平均值拉入查询集中的正确方法是什么？我还想保留查询中的实际操作列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:17:38.430

尝试`actions = actions.aggregate(avg_time_estimate=Avg('time_estimate'))`

# ruby-on-rails - 在关联扩展中访问代理所有者的正确方法

> ID：10541464
> 
> 赞同：3
> 
> 时间：2012-05-10T20:16:24.233
> 
> 标签：ruby-on-rails, ruby-on-rails-3

看起来关联扩展在整个 Rails 3.x 中发生了很大变化。

我需要访问代理所有者和代理目标（即has_many 对象和belongs_to 对象）。

最新的[文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)说要使用`proxy_association.owner`和`proxy_association.target`. 但是，这会导致缺少方法。我找到了一些较旧的参考资料（现在找不到它们），说那`self.proxy_target`会起作用。然而，这似乎只是间歇性地工作，并且在我的本地环境和生产之间不可靠（奇怪......我知道）。

有人知道我在哪里可以找到关于如何使用**Rails 3.0.10**从关联扩展中访问所有者和目标的更明确的答案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T20:48:16.107

`proxy_association`是 Rails 3.1 中的新功能。rails 3.0.x（和 2.x）等价物是`proxy_owner`和`proxy_target`. 但是`proxy_target`，如果关联已被加载，则返回缓存关联的实例变量，即如果关联尚未加载，您将返回`[]`集合关联。或者换句话说，给定

```
class Bar < ActiveRecord::Base
  has_many :foos do
    def target_test
      proxy_target
    end
  end
end 
```

然后

```
bar = Bar.first
bar.foos.target_test #=> []
bar.foos.inspect
bar.foos.target_test #=> [#<Foo id: 1 ...>] 
```

`load_target`您可以通过在调用之前调用来强制加载目标`proxy_target`。一切就绪，我不确定为什么这很重要-如果您在上面调用东西，`self`它将被转发到您的目标

# eclipse - 在 Eclipse 中控制 ASDoc 工具提示

> ID：10541465
> 
> 赞同：1
> 
> 时间：2012-05-10T20:16:29.213
> 
> 标签：eclipse, actionscript, flash-builder, asdoc

在 Eclipse（w/Flash Builder 4.6）中，如果您将 ASDocs 添加到 Actionscript 中，该类/方法/属性的工具提示将包含该 ASDoc 并使用标签进行一些格式化。有没有办法改变它的格式以及添加标签供它使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T18:06:06.997

这是可以使用的标签列表。

[ASDoc 标签](http://livedocs.adobe.com/flex/3/html/help.html?content=asdoc_1.html)

然后，您可以使用 ASDoc 工具将它们导出为完整的 HTML 文档，这些文档都来自您的评论，并且与它们在 Flex 中的工具提示中的显示方式相同。

# sencha-touch-2 - 列表不显示

> ID：10541475
> 
> 赞同：2
> 
> 时间：2012-05-10T20:16:50.117
> 
> 标签：sencha-touch-2

我无法在我的视图中显示列表。看来我正在从我的 ajax 调用中取回数据。我肯定在这里遗漏了一些东西。请帮忙。谢谢

以下是详细信息： 数据：

站.json

```
[
{
    "id": "129",
    "stop": "NY Station",
},
{
    "id": "13",
    "stop": "Newark Station",
}

] 
```

模型：

```
Ext.define('MyApp.model.Station', {
extend: 'Ext.data.Model',

config: {
    fields: [
         {name: 'id',  type: 'string'},
     {name: 'stop',  type: 'string'}

     ]
}

}); 
```

店铺：

```
       Ext.define('MyApp.store.Stations', {
       扩展：'Ext.data.Store'，
       需要：['MyApp.model.Station']，
    id: '车站',
    xtype: '车站',
    配置：{
        模型：'MyApp.model.Station',
        storeId: 'stationsStore',
        自动加载：真，
        //分拣机：'停止'，
        代理人： {
                类型：'ajax'，
                网址：'Stations.json'

     }
     });

```

看法：

```
Ext.define('MyApp.view.MyService', {
extend: 'Ext.Panel',
xtype: 'stationsformPage',
fullscreen: true,
layout: 'vbox',
requires: [
    'MyApp.store.Stations',    
    'Ext.form.FieldSet',
    'Ext.field.Password',
    'Ext.SegmentedButton',
    'Ext.List'
  ],

config: {
    iconCls: 'settings',
    title: 'My Service',
   items: [
        {
            docked: 'top',
            xtype: 'toolbar',
            title: 'My Service'
        },

        {
            xtype: 'list',
            title: 'Stations',
            store: 'stationsStore',
            styleHtmlContent: true,
            itemTpl: '<div><strong>{stop}</strong> {id}</div>'

        },

    ]
   },
   initialize: function() {

        /*
        Ext.Ajax.request({
            scope : this,
            url: 'StationLocator.json',
            callback : function(options, success, response){
                    var json =   Ext.decode(response.responseText);
                    alert(response.responseText); //this works
                    alert(json[0].stop); //this works
            }
        });
        */

  }//initialize

  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T22:24:35.027

我把它放在一个 TabPanel 中。这会有帮助吗？它看起来像这样：

![在此处输入图像描述](../Images/033400bdf4219472f97353beed0cece2.png)

这是我的看法：

```
Ext.define('MyApp.view.MyService', {
    扩展：'Ext.tab.Panel'，
    xtype: 'stationsformPage',
    全屏：是的，
    布局： {
        包：'中心'
    },
    要求：[
        'MyApp.store.Stations',
        'Ext.form.FieldSet',
        'Ext.field.Password',
        'Ext.SegmentedButton',
        '分机列表'
    ],
    配置：{
      tabBarPosition:'底部',
        布局： {
            类型：'卡'，
            动画： {
                持续时间：300，
                easing: '缓入出',
                类型：'幻灯片'，
                方向：“左”
            }
        },
        全屏：是的，
        标题：“我的服务”，
        项目： [
            {
                停靠：'顶部'，
                xtype: '工具栏',
                标题：“我的服务”
            },

            {
                xtype：'列表'，
                标题：“站”，
                商店：'stationsStore'，
// 高度：600，
// 宽度：400，
// 样式：'背景颜色：#c9c9c9;',
                styleHtmlContent: true,
                itemTpl: ' {stop} {id}'

            }

        ]
    }

});

```

这是一个将列表放在常规面板中的版本：

![在此处输入图像描述](../Images/c1bc22264706c044305882280d95a5b7.png)

```
Ext.define('MyApp.view.MyService', {
    扩展：'Ext.Panel'，
    xtype: 'stationsformPage',
    全屏：是的，
    布局： {
        包：'中心'
    },
    要求：[
        'MyApp.store.Stations',
        'Ext.form.FieldSet',
        'Ext.field.Password',
        'Ext.SegmentedButton',
        '分机列表'
    ],
    配置：{

        全屏：是的，
    layout: 'fit', // 指定 fit 很重要。没有它就看不到列表
        标题：“我的服务”，
        项目： [
            {
                停靠：'顶部'，
                xtype: '工具栏',
                标题：“我的服务”
            },

            {
                xtype：'列表'，
                商店：'stationsStore'，

                styleHtmlContent: true,
                itemTpl: ' {stop} {id}'

            }
        ]
    }
});

```

# xsd - 将属性赋予顶级元素时，Xerces 报告错误

> ID：10541476
> 
> 赞同：1
> 
> 时间：2012-05-10T20:16:51.677
> 
> 标签：xsd, xerces

我有以下工作正常的架构：

```
<?xml version="1.0"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="bindings">
        <xs:complexType>
            <xs:sequence maxOccurs="unbounded">
                <xs:element name="bind">
                    <xs:complexType>

                        <xs:attribute name="trigger" use="required">
                            <xs:simpleType>
                                <xs:restriction base="xs:string">
                                    <xs:minLength value="1"/>
                                </xs:restriction>
                            </xs:simpleType>
                        </xs:attribute> <!-- trigger -->

                        <xs:attribute name="command" use="required">
                            <xs:simpleType>
                                <xs:restriction base="xs:string">
                                    <xs:minLength value="1"/>
                                </xs:restriction>
                            </xs:simpleType>
                        </xs:attribute> <!-- command -->

                    </xs:complexType>
                </xs:element> <!-- bind -->
            </xs:sequence>
        </xs:complexType>
    </xs:element> <!-- bindings -->
 </xs:schema> 
```

但是，当我尝试为顶级`bindings`元素定义属性时，无论我将属性代码放在何处，都会出现错误。我错过了什么或做错了什么？

**编辑**：看起来我的 Java XML 代码或 Xerces 有一些问题。如果我更改 XSD 为顶级元素提供可选的“父”属性，Xerves 会给我错误`"Problem: schema_reference.4: Failed to read schema document 'null', because 1) could not find the document; 2) the document could not be read; 3) the root element of the document is not <xsd:schema>."` 但是，如果我给属性任何名称 //other// 而不是“父”，它会报告`Attribute 'parent' is not allowed to appear in element 'bindings'.`，就像你一样d 期望。

我关于 XSD 和 Xerces 的 Java 代码是：

```
 bindingsDocumentBuilderFactory =
        DocumentBuilderFactory.newInstance();
    DocumentBuilderFactory bdbf = bindingsDocumentBuilderFactory;

    bdbf.setValidating(true);

    // I get the input stream here as "is"

    bdbf.setAttribute("http://java.sun.com/xml/jaxp/properties/schemaLanguage",
                      "http://www.w3.org/2001/XMLSchema");
    bdbf.setAttribute("http://java.sun.com/xml/jaxp/properties/schemaSource", is); 
```

**编辑 2**：

正在验证的 XML 文件：

```
<bindings parent="game/movement">
    <bind trigger="i" command="INVENTORY"/>
</bindings> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T21:23:45.460

这有效（参见名为代码的属性）：

```
<?xml version="1.0"?> 
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"> 
    <xs:element name="bindings"> 
        <xs:complexType> 
            <xs:sequence maxOccurs="unbounded"> 
                <xs:element name="bind"> 
                    <xs:complexType> 
                        <xs:attribute name="trigger" use="required"> 
                            <xs:simpleType> 
                                <xs:restriction base="xs:string"> 
                                        <xs:minLength value="1"/> 
                                </xs:restriction> 
                            </xs:simpleType> 
                        </xs:attribute> 
                        <!-- trigger --> 
                        <xs:attribute name="command" use="required"> 
                            <xs:simpleType> 
                                <xs:restriction base="xs:string"> 
                                        <xs:minLength value="1"/> 
                                </xs:restriction> 
                            </xs:simpleType> 
                        </xs:attribute> 
                        <!-- command --> 
                    </xs:complexType> 
                </xs:element> 
                <!-- bind --> 
            </xs:sequence> 
            <xs:attribute name="code"/>
        </xs:complexType> 
    </xs:element> 
    <!-- bindings --> 
</xs:schema> 
```

![属性](../Images/e388920f21b11b6f1014aab993637e15.png)

# sorting - 基于数据库文本字段控制 SSRS 中的排序

> ID：10541477
> 
> 赞同：1
> 
> 时间：2012-05-10T20:17:01.050
> 
> 标签：sorting, reporting-services

我一直在试图找到一种方法来搜索这个，但没有太多运气。

基本上，我在表格中有一个文本字段。我要做的就是检查该文本字段是否包含特定字符串，在这种情况下，如果该字段包含“OLD”、“OBSOLETE”或“FOM”，然后将其移动到列表的最底部，让其他一切正常排序。这可能吗？我试图做到这一点，而不会过多地触及 SQL 语句本身。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:30:14.790

您可以通过在与排序相关的**表达式/函数**中使用 switch 语句来做到这一点。从逻辑上讲，switch() 与 case 语句非常相似。

在“排序选项”下，通过单击右侧的表达式按钮 (Fx) 添加新的排序行项目（或修改现有项目）

然后修改类似这样的排序表达式：

```
=Switch(Fields!YourField.Value="Old","xxx",
        Fields!YourField.Value="Obsolete","yyy",
        Fields!YourField.Value="Fom","zzz",
        1=1,Fields!YourField.Value) 
```

这将创建一个 switch 语句，将您提到的项目的要排序的值替换为 xxx、yyy 和 zzz，有效地将它们的排序值移动到列表的末尾。它们的显示值将保持不变。

Switch 在找到第一个 true 时停止评估；所以最后的 1=1 基本上是`otherwise`根据字段的实际值在不旧、过时或 fom 时进行排序的子句。

# mfc - 从 Shell 运行/帮助创建 DataObject (MFC C++)

> ID：10541478
> 
> 赞同：0
> 
> 时间：2012-05-10T20:17:02.550
> 
> 标签：mfc, drag-and-drop, startmenu, idataobject

我需要帮助来创建一个 IDataObject 以启用这 2 个项目（运行和帮助）的拖放。例如，我需要像 Windows 开始菜单那样做。

运行它们我使用这些

```
CComPtr<IShellDispatch2> pShellDisp;
if (SUCCEEDED(CoCreateInstance(CLSID_Shell,NULL,CLSCTX_SERVER,IID_IShellDispatch2,(void**)&pShellDisp)))
{
    pShellDisp->Help();    //Help
    pShellDisp->FileRun(); //Run
} 
```

你们能帮帮我吗？

PS：我也需要带有图像图标的拖动

编辑[已解决]

```
IShellFolder* desk = NULL;
                HRESULT hr =SHGetDesktopFolder(&desk);
                LPITEMIDLIST pidl2=NULL;
                ULONG cbEaten;
                DWORD dwAttribs = 0 ;

                hr = desk->ParseDisplayName(NULL,
                                             NULL,
                                             L"shell:::{2559a1f3-21d7-11d4-bdaf-00c04f60b9f0}",
                                             &cbEaten,  // This can be NULL
                                             &pidl2,
                                             &dwAttribs);
                hr = desk->GetUIObjectOf(parentHwnd, 1,
                        (PCITEMID_CHILD*)&pidl2, IID_IDataObject, 0, (LPVOID *)lpdataObj);

                desk->Release();
                return; 
```

运行：

```
shell:::{2559a1f3-21d7-11d4-bdaf-00c04f60b9f0} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T22:04:41.860

我假设您在任何时间点都只想要数据对象中的这些项目之一，在这种情况下：

*   如果您已经有一个 IShellItem，那么您可以调用`IShellItem::BindToHandler(...,BHID_DataObject,...)`.
*   如果您[只有 pidl](https://stackoverflow.com/a/10626934/3501)，则可以使用[SHCreateDataObject](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762126%28v=vs.85%29.aspx)或[CIDLData_CreateFromIDArray](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776390%28v=vs.85%29.aspx)

如果您想在同一操作中拖放两个项目，那么事情就会变得困难。我不知道这两个对象是否具有相同的父对象。如果他们这样做了，那么即使是旧的 CIDLData_CreateFromIDArray 也可以处理它。如果他们不这样做，那么您可以尝试 SHCreateShellItemArrayFromIDLists 然后使用`IShellItemArray::BindToHandler(...,BHID_DataObject,...)`. 要支持 < Vista 我相信您必须创建自己的[CFSTR_SHELLIDLIST](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776902%28v=vs.85%29.aspx#CFSTR_SHELLIDLIST)并将其添加到数据对象中。

拖动图像与此无关，应该在一个单独的问题中询问，其中包含有关 IDragSourceHelper 等的信息。

# css - 在一行中进行 div 滚动

> ID：10541479
> 
> 赞同：1
> 
> 时间：2012-05-10T20:17:03.563
> 
> 标签：css, html, scroll, alignment

我需要将文本放在单行滚动 div 中，适合两个 div。

[http://jsfiddle.net/F6pNm/26/](http://jsfiddle.net/F6pNm/26/)

目标是让**所有人都**适合**一条线**！

编辑：我想我不够具体，我需要链接和文本放在同一行。这样，滚动是垂直的。

**编辑：这是现在最接近我需要的。仅缺少滚动方面。[http://jsfiddle.net/BKvzV/4/](http://jsfiddle.net/BKvzV/4/)**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T20:28:54.603

如果我没看错的话，你不需要打破你的文本，而是继续前进，永远不要离开第 1 行，所以你可以像这样使用 CSS：

[小提琴示例！](http://jsfiddle.net/zuul/F6pNm/34/)

**你的 CSS 更新了**

```
#flash {
    float:left;
    width: auto;
    font-size: small;
    font-style: italic;
    text-align: center;
    white-space:nowrap;
} 
```

不同之处在于[white-space:nowrap](http://www.w3schools.com/cssref/pr_text_white-space.asp)；

**对于谁看不到它：**

![在此处输入图像描述](../Images/1a5c5d30a70bb77d38cf3e47aaaf4bf7.png)

* * *

**编辑考虑编辑的问题问题！**

[新的小提琴！](http://jsfiddle.net/zuul/F6pNm/41/)

* * *

**编辑考虑页脚内的所有 div 必须并排的事实！**

更新的[小提琴！](http://jsfiddle.net/zuul/F6pNm/47/)

**请注意**，此解决方案使用 Jquery 实时收集每个 div 的宽度并汇总在一起以设置页脚 div。没有它，就做不成！

* * *

**编辑使所有 3 个 div 在包装器宽度内并排**

*在 Fiddle 示例中，包装器是主体*

[新的小提琴！](http://jsfiddle.net/zuul/F6pNm/49/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:23:07.073

**据我所知**，当 3 个 div 都设置为`width:auto;`. 即使您使用`overflow`, 或`in-line`, 或到目前为止建议的其他方法，我认为左侧 div 将始终占用它需要的空间，然后是中间，然后是右侧......*除非*您使用设置宽度

我不知道这是否可能，因为您使用的是`width:auto;`. 这似乎允许 div 尽可能多地扩展，从而使其太大而不能只放在一行中。

如果您将链接更改为设置大小，例如`width:10%`，则其中 4 个链接会留下 60%，因此您可以将其设置`#flash {width:60%; overflow-x:auto;}`为可滚动和一行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:28:18.637

```
#flash {
    float:left;
    width: auto;
    font-size: small;
    font-style: italic;
    text-align: center;
    white-space:nowrap;  /* will put text in 1 line */
    overflow-x:scroll;   /* will add horizontal scroll bar should the length exceed the container */
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T20:32:32.507

```
#flash {
    float:left;
    width: auto;
    font-size: small;
    font-style: italic;
    text-align: center;

    /*These lines do the trick*/
    overflow-x: scroll;
    white-space: nowrap;
    width: 100%;
}​ 
```

[http://jsfiddle.net/F6pNm/35/](http://jsfiddle.net/F6pNm/35/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T21:16:38.927

使用 JQuery，我让中间 div 根据左右 div 改变大小。

jQuery：

```
$(function () {
   var midWidth = $(document).width() - ($('#left').width() + $('#right').width());
   $('#flash').width(midWidth);
}); 
```

[小提琴示例](http://jsfiddle.net/BKvzV/2/)

希望这可以帮助。

编辑：添加到 div 的 css 中：

```
height: 36px;
overflow: scroll; 
```

它更接近你可能想要的。
我不知道如何让盒子只显示一行。

[小提琴更新](http://jsfiddle.net/BKvzV/6/)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-10T20:44:47.130

删除浮动：左

```
#flash { 
    font-size: small;
    font-style: italic;
    text-align: center;
    white-space:nowrap;
    overflow-x:scroll;
}​ 
```

试试这个：

[http://jsfiddle.net/damsarabi/F6pNm/40/](http://jsfiddle.net/damsarabi/F6pNm/40/)

# c# - Windows Phone 网络浏览器 网站缩略图

> ID：10541495
> 
> 赞同：1
> 
> 时间：2012-05-10T20:18:06.793
> 
> 标签：c#, silverlight, windows-phone-7, webbrowser-control

很长一段时间以来，我一直想使用 Windows Phone 中的 Web 浏览器控件来获取网站的缩略图。

我的问题很简单，有没有办法获得用户当前所在网页的缩略图。我在使用 C# 标准 Web 浏览器控件和 DrawToBitmap 方法之前已经这样做了，但这在 Windows Phone 中不存在（至少我找不到任何其他建议的文档）

除了使用在线服务（例如一瞥或亚马逊的缩略图生成器）之外，如果你们知道有什么可以为我指明正确的方向，因为我想将此活动保留在应用程序中，我不想对另一个网站进行额外的调用当数据就在他们的网络浏览器中时提供服务。

我希望是否有一个我不知道的调用脚本或 Windows Phone 支持的一些库能够做到这一点。

感谢您的帮助，如果您需要更多信息，请询问，或者如果您想知道我想要什么或为什么想要这个，我将在这里进一步解释：

我有一个新闻应用程序，允许用户访问选择的几个提要，我有一个专用页面，用于托管 Web 浏览器控件以显示具有其他功能的网页，例如使用您的电子邮件共享网站或将网站固定到您的主屏幕，我只是想要一种比通用网络浏览器更自定义的体验。而且我认为网站的缩略图作为 Tiles 背景会很好

如果您对如何解决此类问题有更好的想法，请告诉我我愿意接受建议:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:38:00.057

您可以尝试将浏览器控件呈现为`WriteableBitmap`：

```
var bitmap = new WriteableBitmap(400, 400);
bitmap.Render(browserControl, null);
bitmap.Invalidate(); 
```

然后，您可以将此位图用作`ImageSource`.

# java - 在java中交换数组中元素的位置？

> ID：10541499
> 
> 赞同：6
> 
> 时间：2012-05-10T20:18:22.050
> 
> 标签：java, arrays, string, position, switching

好的，这是我第一次在这里发帖，所以请多多包涵。

我有一个格式为的名称，`"Smith, Bob I"`我需要将此字符串切换为 read `"Bob I. Smith"`。关于如何去做这件事的任何想法？

这是我尝试过的一种方法，虽然它确实完成了工作，但它看起来很草率。

```
public static void main(String[] args) {
        String s = "Smith, Bob I.", r = "";
        String[] names;

        for(int i =0; i < s.length(); i++){
            if(s.indexOf(',') != -1){
                if(s.charAt(i) != ',')
                    r += s.charAt(i);
            }

        }
        names = r.split(" ");
        for(int i = 0; i < names.length; i++){
        }
        System.out.println(names[1] +" " + names[2] + " " + names[0]);

    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-10T20:28:20.327

如果名称 always `<last name>, <firstname>`，请尝试以下操作：

```
String name = "Smith, Bob I.".replaceAll( "(.*),\\s+(.*)", "$2 $1" ); 
```

这将收集`Smith`到第 1 组和`Bob I.`第 2 组，然后在替换字符串中访问`$1`它们`$2`。由于`(.*)`表达式中的组，整个字符串匹配并将被替换完全替换，替换只是交换并由空格字符分隔的 2 个组。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-10T20:22:15.527

```
 String[] names = "Smith, Bob I.".split("[, ]+");
    System.out.println(names[1] + " " + names[2] + " " + names[0]); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-10T20:25:05.140

```
final String[] s = "Smith, Bob I.".split(",");
System.out.println(String.format("%s %s", s[1].trim(), s[0])); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-10T20:31:46.973

```
String s = "Smith, Bob I.";
String result = s.substring(s.indexOf(" ")).trim() + " "
            + s.substring(0, s.indexOf(",")); 
```

# c# - 在 C# 中解析字符串的多个部分的干净方法是什么？

> ID：10541510
> 
> 赞同：1
> 
> 时间：2012-05-10T20:19:14.703
> 
> 标签：c#, string, asp.net-mvc-3, encoding, mathml

我有一个可能包含 XML 和普通字符串的字符串。我需要解析出`<math....</math>`字符串中的所有实例。如何从这个字符串 中解析出这个（从`<math>`到）的多个部分？`</math>`

```
Here is some content <math
xmlns="http://www.w3.org/1998/Math/MathML">  
<mi>a</mi><mo>&#x2260;</mo><mn>0</mn> </math>, that is mixed in with
this other content <math xmlns="http://www.w3.org/1998/Math/MathML">  
<mi>a</mi><msup><mi>x</mi><mn>2</mn></msup>   <mo>+</mo>
<mi>b</mi><mi>x</mi>   <mo>+</mo> <mi>c</mi> <mo>=</mo> <mn>0</mn>
</math> we want to be able to seperate this string 
```

**背景**：我试图使这个问题通用。我正在尝试做的细节是针对 MVC3 编码与 Raw。默认情况下，它将对所有内容进行编码。我不希望它对 MathML 进行编码，但希望它对其他所有内容进行编码。所以它的一部分我想渲染为 Html.Raw （MathML 部分），其余部分我想渲染为正常编码的字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:26:07.897

如果您通常可以期望 XML 格式良好，或者至少格式一致，那么您应该能够使用[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)来去除 XML。

您可以尝试使用[Expresso](http://www.ultrapico.com/Expresso.htm)来制作您的表情。

如果你想解析你去掉的 XML，那是 .NET XMLParser 的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T10:56:17.293

我不是正则表达式，但这是我尝试过的，我得到了正确的结果。请将其用作基础并在必要时对其进行修改。

我是从Stackoverflow 上的这篇[文章中得到的。](https://stackoverflow.com/questions/121656/regular-expression-to-remove-xml-tags-and-their-content)

```
string yourstring = "<math xmlns=\"http://www.w3.org/1998/Math/MathML\">   <mi>a</mi><mo>&#x2260;</mo><mn>0</mn> </math>, that is mixed in with this other content <math xmlns=\"http://www.w3.org/1998/Math/MathML\">   <mi>a</mi><msup><mi>x</mi><mn>2</mn></msup>   <mo>+</mo> <mi>b</mi><mi>x</mi>   <mo>+</mo> <mi>c</mi> <mo>=</mo> <mn>0</mn> </math>";

try
{
     yourstring = Regex.Replace(yourstring, "(<math[^>]+>.+?</math>)", "");
}
catch (ArgumentException ex)
{
     // Syntax error in the regular expression
} 
```

结果字符串是：

```
, that is mixed in with this other content 
```

# visual-studio-2008 - 创建构成分组总计的各个项目的列表

> ID：10541511
> 
> 赞同：0
> 
> 时间：2012-05-10T20:19:16.103
> 
> 标签：visual-studio-2008, reporting-services, bids

巫师、专家、像我这样简单的工人以及我可能已经忘记的所有其他善意的人：我有一个问题，需要你的帮助......

我有一份报告“TRAINERMEETING”，其中计算了参加会议的人数（people_ID）：

* * *

培训师 -|-会议 -|- 参加者人数

[TrainerID] -|- [MeetingID] -|- =countdistinct(peopleID)

强尼 -|- 冷静训练 -|- 5

* * *

详细信息（个人人员 ID）在报告中可用，但不可见。一切都在 TRAINER 上分组，然后在 MEETING 上分组

我想要做的是创建一个逗号分隔值列表，其中包含在“=countdistinct(peopleID)”中计数的 5 个单独的 PeopleID 我想将此列表传递给另一个报告中的参数@PeopleID (LISTALLPEOPLEID)，其中包含所有人的身份证。该参数将用于过滤报告 (LISTALLPEOPLEID)。我试过 '=join(PeopleID,",")' 但这似乎很简单；）

谁知道是否/如何创建构成聚合的项目列表？或者简单地使用 peopleID 来过滤 PeopleID 的报告？我非常有义务，

亨罗

编辑：

感谢我得到的提示（不记得是谁，我很惭愧）我使用 XML 解决了它：

> SUBSTRING(replace(replace((SELECT me.meeting FROM trainer as tr1
> WHERE tr.trainer_id = tr1.trainer_id ORDER BY me.meeting FOR XML PATH('')) ,'','') ,'','
> - ' ) ,5,2000) AS 会议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T13:45:48.280

感谢我得到的提示（不记得是谁或在哪里，我感到羞耻）我使用 XML 解决了它：

SUBSTRING(replace(replace((SELECT me.meeting FROM trainer as tr1 WHERE tr.trainer_id = tr1.trainer_id ORDER BY me.meeting FOR XML PATH('')) ,'','') ,'',' - ' ) ,5,2000) AS 会议

# shell - for 循环和头部未按预期工作

> ID：10541512
> 
> 赞同：0
> 
> 时间：2012-05-10T20:19:18.917
> 
> 标签：shell, unix

测试.txt：

```
1 1
2 2
3 3 
```

测试.sh：

```
for ln in $(head -3 test.txt)
do
    echo "New line: $ln";
done 
```

我希望：

```
New line: 1 1
New line: 2 2
New line: 3 3 
```

...但输出是：

```
New line: 1
New line: 1
New line: 2
New line: 2
New line: 3
New line: 3 
```

变成：

```
"$(head -3 test.txt)" 
```

...导致：

```
New line: 1 1
2 2
3 3 
```

那有什么问题？显然，空间是问题所在。任何简单的解决方法？提前谢谢了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T20:21:27.930

如果你想逐行阅读，试试这个：

```
head -3 test.txt | while read line; do
  echo $line
done 
```

一般来说，shell 使用空格来标记事物，所以如果你这样做：

```
for ln in $(head -3 test.txt) 
```

它最终看起来像这样：

```
for ln in 1 1 2 2 3 3 
```

...这就是为什么你得到你得到的输出。

# php - XML标签相关问题

> ID：10541517
> 
> 赞同：0
> 
> 时间：2012-05-10T20:19:38.757
> 
> 标签：php, xml, xml-parsing

```
<?php
$xmlDoc = new DOMDocument();
$xmlDoc->load("note.xml");

print $xmlDoc->saveXML();
?> 
```

在上面的代码示例中，我不明白最后一行。为什么我们使用 saveXML()。有没有在不使用 saveXML() 的情况下打印 xml 文件。请任何人都可以回答我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:22:53.547

如果您从文件加载 xml 并且没有以任何方式修改它，则无需调用`saveXML()`. 当您从头开始创建 xml 文档时，最常使用[saveXML 。](http://php.net/manual/en/domdocument.savexml.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T21:18:57.210

如果您只想检查文件的内容，可以使用`file_get_contents`, 而不是使用 DomDocument。当您想要进行更改或解析时，DomDocument 更有用。

# c# - 使用 out/ref 与返回相比有什么好处？

> ID：10541532
> 
> 赞同：9
> 
> 时间：2012-05-10T20:20:38.930
> 
> 标签：c#, .net, api, xna

我正在使用 XNA 框架制作游戏，所以我使用了很多对向量进行操作的函数。（尤其是[Vector2](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.vector2_members)（64 位结构））。困扰我的是大多数方法都是用 ref 和 out 参数定义的。这是一个例子：

```
void Min(ref Vector2 value1, ref Vector2 value2, out Vector2 result) 
```

这对我来说也有点奇怪。还有一个`Min`更明显的

```
public static Vector2 Min(Vector2 value1, Vector2 value2); 
```

基本上，几乎所有的函数都有`ref`s 和`out`s 的重载。类似的，其他[API](http://msdn.microsoft.com/en-us/library/bb199001)。

**这种设计有什么好处？**XNA 针对性能进行了优化，这可能是结果吗？比如说，四元数需要 128b，其中通过 ref 较少。

编辑：

这是一个测试代码：

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;

    private Vector2 vec1 = new Vector2(1, 2);
    private Vector2 vec2 = new Vector2(2, 3);
    private Vector2 min;
    private string timeRefOut1;
    private string timeRefOut2;
    private SpriteFont font;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";

        refOut1();
        refOut2();
    }

    private Vector2 refOut1()
    {
        Vector2 min = Vector2.Min(vec1, vec2);
        return min;
    }

    private Vector2 refOut2()
    {
        Vector2.Min(ref vec1, ref vec2, out min);
        return min;
    }

    protected override void Initialize()
    {
        const int len = 100000000;
        Stopwatch stopWatch = new Stopwatch();
        stopWatch.Start();
        for (int i = 0; i < len; i++)
        {
            refOut1();
        }
        stopWatch.Stop();

        timeRefOut1 = stopWatch.ElapsedMilliseconds.ToString();

        stopWatch.Reset();
        stopWatch.Start();
        for (int i = 0; i < len; i++)
        {
            refOut2();
        }
        stopWatch.Stop();

        timeRefOut2 = stopWatch.ElapsedMilliseconds.ToString();

        base.Initialize();
    }

    protected override void LoadContent()
    {
        spriteBatch = new SpriteBatch(GraphicsDevice);
        font = Content.Load<SpriteFont>("SpriteFont1");
    }

    protected override void Update(GameTime gameTime)
    {
        if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
            this.Exit();

        base.Update(gameTime);
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);

        spriteBatch.Begin();
        spriteBatch.DrawString(font, timeRefOut1, new Vector2(200, 200), Color.White);
        spriteBatch.DrawString(font, timeRefOut2, new Vector2(200, 300), Color.White);
        spriteBatch.End();

        // TODO: Add your drawing code here

        base.Draw(gameTime);
    }
} 
```

结果：

*   参考输出1 2200
*   参考输出2 1400

赢 7 64 位，.Net 4\. XNA 4.0

还有IL代码

```
.method public hidebysig static void  Min(valuetype Microsoft.Xna.Framework.Vector2& value1,
                                          valuetype Microsoft.Xna.Framework.Vector2& value2,
                                          [out] valuetype Microsoft.Xna.Framework.Vector2& result) cil managed
{
  // Code size       69 (0x45)
  .maxstack  3
  IL_0000:  ldarg.2
  IL_0001:  ldarg.0
  IL_0002:  ldfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_0007:  ldarg.1
  IL_0008:  ldfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_000d:  blt.s      IL_0017
  IL_000f:  ldarg.1
  IL_0010:  ldfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_0015:  br.s       IL_001d
  IL_0017:  ldarg.0
  IL_0018:  ldfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_001d:  stfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_0022:  ldarg.2
  IL_0023:  ldarg.0
  IL_0024:  ldfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_0029:  ldarg.1
  IL_002a:  ldfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_002f:  blt.s      IL_0039
  IL_0031:  ldarg.1
  IL_0032:  ldfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_0037:  br.s       IL_003f
  IL_0039:  ldarg.0
  IL_003a:  ldfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_003f:  stfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_0044:  ret
} // end of method Vector2::Min 
```

和

```
.method public hidebysig static valuetype Microsoft.Xna.Framework.Vector2 
        Min(valuetype Microsoft.Xna.Framework.Vector2 value1,
            valuetype Microsoft.Xna.Framework.Vector2 value2) cil managed
{
  // Code size       80 (0x50)
  .maxstack  3
  .locals init (valuetype Microsoft.Xna.Framework.Vector2 V_0)
  IL_0000:  ldloca.s   V_0
  IL_0002:  ldarga.s   value1
  IL_0004:  ldfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_0009:  ldarga.s   value2
  IL_000b:  ldfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_0010:  blt.s      IL_001b
  IL_0012:  ldarga.s   value2
  IL_0014:  ldfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_0019:  br.s       IL_0022
  IL_001b:  ldarga.s   value1
  IL_001d:  ldfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_0022:  stfld      float32 Microsoft.Xna.Framework.Vector2::X
  IL_0027:  ldloca.s   V_0
  IL_0029:  ldarga.s   value1
  IL_002b:  ldfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_0030:  ldarga.s   value2
  IL_0032:  ldfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_0037:  blt.s      IL_0042
  IL_0039:  ldarga.s   value2
  IL_003b:  ldfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_0040:  br.s       IL_0049
  IL_0042:  ldarga.s   value1
  IL_0044:  ldfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_0049:  stfld      float32 Microsoft.Xna.Framework.Vector2::Y
  IL_004e:  ldloc.0
  IL_004f:  ret
} // end of method Vector2::Min 
```

似乎开销是由 temp Vector 引起的。我还尝试了 1GHz WP 7.5 设备：

*   1979
*   1677

迭代次数少一个数量级的刻度数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T20:24:42.687

Vector2 是一个结构，这意味着当它作为值返回时，会返回一个副本，而不是返回对现有结构的引用。通过使用 ref/out 参数，您可以避免此副本，以便在 Min 方法中创建的 Vector 是`result`变量中的确切向量。

这是通常会被劝阻的那些微优化之一，但在游戏世界中它已经足够频繁地完成，并且在性能足够重要的环境中，它值得稍微不那么可读的选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T20:29:11.900

除了 Servy 提到的性能效率之外，另一个区别是能够拥有多个“返回”值：不是以通常的方式返回它们，而是将它们列为 ref/var 参数。

# ruby-on-rails-3 - Rails RESTful API + 设计 - 如何检查用户的凭据

> ID：10541540
> 
> 赞同：2
> 
> 时间：2012-05-10T20:21:49.363
> 
> 标签：ruby-on-rails-3, devise, restful-architecture

我已经使用 Ruby On Rails 构建了一个 RESTful API，现在我很想知道使用 Devise 通过 POST 接收到的用户凭据是否有效。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T05:42:29.247

设计 -[开始](https://github.com/plataformatec/devise#getting-started)应该设置你。

编辑：

默认情况下，Devise 通过用户的电子邮件和密码验证用户。如果您想通过用户名添加验证，请参考[此 wiki](https://github.com/plataformatec/devise/wiki/How-To%3a-Allow-users-to-sign-in-using-their-username-or-email-address) 基本上，您需要将用户名添加到模型并使其“可访问”

Devise 为用户注册、登录和注销等设置路径。请参阅[devise asciicast](http://asciicasts.com/episodes/209-introducing-devise)获取这些路径助手。

要编写控制器测试，请参阅[此 wiki](https://github.com/plataformatec/devise/wiki/How-To%3a-Controllers-and-Views-tests-with-Rails-3-%28and-rspec%29)了解详细信息。

编辑：

很抱歉没有理解您的要求。这是[从凭据中查找用户的方法](https://github.com/plataformatec/devise/wiki/How-To%3a-Find-a-user-when-you-have-their-credentials)。您可以从您的服务中使用它来验证用户。

# git - Git 推送到远程源——更改不在源中提交，仅在 git stash 后可见

> ID：10541542
> 
> 赞同：1
> 
> 时间：2012-05-10T20:21:51.647
> 
> 标签：git, git-stash

在我的本地机器上，我克隆了一个远程仓库，进行了一些更改，提交，然后推回远程仓库，在此期间没有以任何方式被触及。

在远程机器上，当我查看远程仓库时，我看不到我所做的更改。`git status`告诉我有要提交的更改。当我查看文件时，我没有看到我所做的任何更改。当我`git stash`在远程分支中进行操作时，我看到了更改。所以不知何故 git 不会在远程仓库中提交推送的更改。

有人可以向我解释这背后的逻辑以及如何规避这种情况吗？我可以以某种方式将更改推送到远程仓库而不必这样做`git stash`吗？

非常感谢您的澄清！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:26:08.537

如果您正在推入具有结帐工作副本的遥控器，您将不会自动看到更改。 `git`正在将更改推送到*存储库*（`.git`目录）中。如果要更新关联的工作副本，则需要在`post-update`挂钩中实现适当的逻辑。

一般来说，在`git`没有明确配置的情况下，甚至不会让您使用关联的工作副本推送到远程……您通常会看到以下错误：

```
remote: error: refusing to update checked out branch: refs/heads/master
remote: error: By default, updating the current branch in a non-bare repository
remote: error: is denied, because it will make the index and work tree inconsistent
remote: error: with what you pushed, and will require 'git reset --hard' to match
remote: error: the work tree to HEAD.
remote: error: 
remote: error: You can set 'receive.denyCurrentBranch' configuration variable to
remote: error: 'ignore' or 'warn' in the remote repository to allow pushing into
remote: error: its current branch; however, this is not recommended unless you
remote: error: arranged to update its work tree to match what you pushed in some
remote: error: other way.
remote: error: 
remote: error: To squelch this message and still keep the default behaviour, set
remote: error: 'receive.denyCurrentBranch' configuration variable to 'refuse'.
To /home/lars/repo1
 ! [remote rejected] master -> master (branch is currently checked out)
error: failed to push some refs to '/home/lars/projects/administrivia/repo1' 
```

# mysql - 按聚合函数排序 MySql

> ID：10541543
> 
> 赞同：0
> 
> 时间：2012-05-10T20:21:53.030
> 
> 标签：mysql, sql

我想出了另一个问题。我正在尝试设计一个 MySql 查询。

我在评级表中有一个`Users`表和一个`Ratings`表`user_id`作为外键。

现在我必须得到平均评分最高的用户

所以我做了：

```
SELECT blah blah FROM Users USR
INNER JOIN Ratings RTN on USR.id = RTN.user_id
order by avg(RTN.rating) 
```

但我觉得这是错误的，它也不起作用。有没有办法让用户按他们收到的平均评分按降序排序？

问候希曼舒夏尔马。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:27:55.743

您可以使用计算平均评分的内联视图，然后如果要包含评分数据，则加入该视图。

```
SELECT blah blah 
FROM Users USR
   INNER JOIN Ratings RTN 
   ON USR.id = RTN.user_id
  INNER JOIN (SELECT avg(RTN.rating) Avg_rating 
              FROM Ratings RTN
              GROUP BY 
                rtn.user_id) a_rtn
  ON  USR.id = A_RTN.user_id

ORDER BY avg(A_RTN.AVg_rating) DESC 
```

如果您只需要用户数据而不是只需要标准的 Group By

```
SELECT USR.First_name, USR.Last_name, etc
FROM Users USR
   INNER JOIN Ratings RTN 
   ON USR.id = RTN.user_id

GROUP BY 
   USR.First_name, USR.Last_name, etc    
ORDER BY avg(A_RTN.AVg_rating) DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:29:29.080

您的查询实际上似乎不是很错误（作为开始），我会这样写：

```
SELECT USR.id, AVG(RTN.rating) AS avg_rating
FROM Users USR
INNER JOIN Ratings RTN ON USR.id = RTN.user_id
GROUP BY USR.id
ORDER BY avg_rating DESC
LIMIT 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:31:08.970

```
 select blah, blah
    from users usr
    join (
    select rtn.user_id, avg(rtn.rating) as avg_rating
    from users usr
    join ratings rtn on usr.id = rtn.user_id
    group by rtn.user_id
    ) t on t.user_id = usr.id 
    order by avg_rating desc 
```

# android - jQuery touchpunch 在安卓设备上的可拖动延迟

> ID：10541554
> 
> 赞同：2
> 
> 时间：2012-05-10T20:23:04.247
> 
> 标签：android, jquery-mobile, cordova, draggable

我在我的 Android 手机的 phonegap 应用程序中使用了 touchpunch 的可拖动 jquery：[http ://touchpunch.furf.com/。](http://touchpunch.furf.com/)我上传了对象的图片以拖动图片。但是无论我尝试拖动什么对象，它总是显得迟钝，而在我的 iPhone 上，它工作得非常好，没有迟滞。这已经在 Desire HD 和三星 Galaxy S2 上进行了测试，因此不是最慢的安卓手机类型。有谁知道是什么原因造成的以及如何解决？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:39:40.540

你设置`position : absolute`好元素了吗？这可以大大提高性能，因为任何`position : relative`动画/移动都需要重绘整个页面（因为任何更改都会影响祖先和后代）。使用`position : absolute`只需要重新绘制元素占用的区域（因此元素前面或后面的任何内容以及元素本身）。

我在我的 Droid X（现在快两年了）上测试了演示页面，它运行良好，但这是一个简单的测试。

# c# - asp.net 中的页面加载

> ID：10541555
> 
> 赞同：-6
> 
> 时间：2012-05-10T20:23:06.810
> 
> 标签：c#, asp.net

在 asp.net 中，在处理 web 应用程序时，有一个名为“Page_Load”的函数，它是空的。每次加载页面时都会调用它吗？如果我删除这个功能怎么办？本质上 Page_Load 的主要目的是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:26:58.357

它的主要目的是在页面加载时执行/验证/检查（它的启动事件之一）。

开启时通过反射调用此函数`AutoEventWireup`。

# java - JVM 如何在加载类时验证没有潜在的操作数堆栈溢出？

> ID：10541557
> 
> 赞同：16
> 
> 时间：2012-05-10T20:23:08.527
> 
> 标签：java, jvm, stack-overflow, verification

回顾一些演示文稿，我遇到了以下主张：当 JVM 加载一个类时，它可以分析其内容并确保**操作数堆栈没有溢出或下溢**。我发现[很多来源](http://www.google.com/search?q=java%20verify%20%22operand%20stack%22%20overflow%20underflow)都提出了同样的主张，但没有具体说明它是如何完成的。

我不清楚如何使用静态分析进行此类验证。假设我有一个（恶意）方法，它获取一些值作为参数，并使用它来执行一系列弹出。在加载时，迭代次数是未知的，因为它取决于方法调用者给出的参数。因此，在我看来，只有在运行时才能确定是否会出现下溢。我在这里想念什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-10T20:37:50.620

[您可以在Java 虚拟机规范](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.10.2.2)中找到字节码验证器的基本描述。

简单来说，每个分支点的堆栈深度都是已知的，在同一个合并点合并的两条执行路径也必须具有相同的堆栈深度。因此，验证器不允许您在没有相应 put 的情况下执行一系列 pop。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-10T20:41:50.867

该方法的代码被分成执行块。“块”是无需跳出或跳入即可执行的指令序列。这些块构建所有可能执行路径的有向图。

一个块在其开始时总是期望一定的堆栈大小，并且在其结束时具有固定的堆栈大小（开始 + 所有推送 - 所有弹出）。验证器检查对于可以从给定块“b”到达的所有块“a”，b 的结束堆栈大小与 a 的开始堆栈大小匹配。

# ajax - django object_list 在通过 ajax 提交对象创建表单后未更新

> ID：10541559
> 
> 赞同：1
> 
> 时间：2012-05-10T20:23:09.413
> 
> 标签：ajax, django, forms

我正在开发一个 django 项目，其中一个模板在弹出 div 中有一个表单，该表单提交一个表单以创建一个新对象。

到目前为止，ajax 函数已成功提交表单并将配方添加到管理数据库，但由于某种原因，它没有出现在我传递到模板中的 object_list 中。

即使我刷新页面，新添加的对象也不会添加到模板中，并且创建的对象会卡在管理页面上的边缘。

**代码**

**ajax提交功能：**

```
<script type="text/javascript"> 
$(document).ready(function(){

    function hijack() {
        var form = $('form#createrecipeform');
        form.submit(function(e) {
            e.preventDefault();
            console.log('ajax form submission function called successfully.');
            //form = $(this);
            console.log(form)
            var serialized_form = form.serialize();
            $.ajax({ type: "POST", 
                url: $(this).attr('action'),
                data: serialized_form, 
                success: (function(data) { 
                    console.log('ajax success function called successfully.');
                    data = $.parseJSON(data);
                    if (data.success) {
                        console.log('success');
                        alert('recipe added');
                    } else {        
                        console.log('failure');
                        var newForm = data.form;
                        form.replaceWith(newForm);
                        hijack();
                    }
                })
            });
            return false;
        });
    };
    hijack();
});
</script> 
```

**相关观点：**

```
 ** //this is the page the has the popup div to load the form**
    def account(request):
        user = request.user
        if request.user.is_authenticated():

            cookbooks = user.cookbooks
            if cookbooks.all().exists():
                cookbook = cookbooks.all()[0]
                form = RecipeForm(initial = {'original_cookbook' : request.user.cookbooks.all()[0]})
                recipe_list = cookbook.recipes.all()
            else:
                raise Http404
        else:
            return HttpResponseRedirect('/accounts/login')
        t = loader.get_template('cookbook/account.html')
        c = RequestContext(request, {
            'form': form,
            'recipe_list': recipe_list
        })
        return HttpResponse(t.render(c))

    **//this is the page that handles the ajax and is the action of the form**
    def createrecipe(request):
            if request.method == 'POST':
                form = RecipeForm(request.POST)     
                if form.is_valid():
                    form = form.save(commit=False)
                    form.original_cookbook = request.user.cookbooks.all()[0]
                    form.save()

                    t = loader.get_template('cookbook/create_form.html')
                    c = RequestContext(request, {
                    'form': form,
                    })

                    data = {
                    'replace': True,
                    'form': t.render(c),
                    'success': True,
                    }

                    json = simplejson.dumps(data)
                    return HttpResponse(json, mimetype='text/plain')
                else:
                    form = RecipeForm(request.POST)
                    t = loader.get_template('cookbook/create_form.html')
                    c = RequestContext(request, {
                        'form':form,
                    })

                    data ={
                        'form': t.render(c),
                        'success': False,
                    }

                    json = simplejson.dumps(data)
                    return HttpResponse(json, mimetype='text/plain') 
```

**模板：**

```
 {% block content %}
        <div id="recipe_cont">
                {% for recipe in recipe_list %}// here is where add each recipe in the recipe list
            <div class="recipe">
                <div id="recipebutton{{ forloop.counter }}" class="button"> 
                </div>
            </div>
        {% endfor %}
        </div>

            <div id="popupContact" class="popup">
                <a id="popupContactClose" style="cursor:pointer;float:right;">x</a>
                <p id="contactArea">
                    <div id="create_form_span">
                        {% include 'cookbook/create_form.html' %} // here is the form 
                    </div>
                </p>
            </div>
        </div>

    {% endblock %}

//template for the form that is included
    <head>

    </head>
    <body>
    <form action="{% url cookbook.views.createrecipe %}" method="POST" name="recipeform" id="createrecipeform">
        <table>
            {% csrf_token %}
            {{ form.as_table }}
        </table>
        <p><input type="submit" value="Submit"></p>
    </form>
    </body> 
```

# c# - 使用带有异步任务的 MVC3 来更新 UI

> ID：10541560
> 
> 赞同：0
> 
> 时间：2012-05-10T20:23:10.710
> 
> 标签：c#, ajax, asp.net-mvc-3, task-parallel-library

我拥有的是一个视图上的 AJAX 表单，它调用服务器。此调用执行 n 个任务，其中 n 是由数据库中的记录决定的数字（通常不超过 10 条记录）。每条记录对应于 TFS 中的一个构建定义，所以我想要做的是获取所有这些构建定义，将它们排入 TFS 中，并在每个构建完成时更新 UI，以便用户知道哪些构建已经完成。

不幸的是，我不确定如何最好地做到这一点。我在想一些事情：

```
 foreach (var dep in builds)
        {
            TFS tfsServer = new TFS(TFS_SERVER_ADDRESS);
            IBuildServer buildServer;
            int id = tfsServer.QueuBuild(dep.TeamProject, dep.BuildDefinition);
            string teamProject = dep.TeamProject;
            Task.Factory.StartNew(() => GetBuildStatus(teamProject, id, tfsServer));

        } 
```

调用的任务是：

```
 private void GetBuildStatus(string TeamProject, int BuildID, TFS Server)
        {
            Server.GetBuildStatus(TeamProject, BuildID);
            AsyncManager.OutstandingOperations.Decrement();
        } 
```

这里的问题是，在所有构建完成之前，我的 Completed 方法不会被调用。我将如何一次将数据反馈给 UI？

还值得一提的是，GetBuildStatus 方法如下所示：

```
 do
        {
            var build = buildsView.QueuedBuilds.FirstOrDefault(x => x.Id == BuildID);
            if(build != null)
            {
                status = build.Status;
                detail = build.Build;    
            }

        } while (status != QueueStatus.Completed);
        return detail.Status.ToString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:23:32.270

鉴于构建的持续时间将比 HTTP 请求的超时时间长，您不能在这种情况下让浏览器等待。您需要返回一个页面，然后使用 AJAX 从该页面轮询更新。通常，您在 javascript 中有一个计时器，它会触发定期回调服务器以获取更新的状态信息。

但是，由于您使用的是 .NET，因此您也可以考虑尝试[SignalR](https://github.com/SignalR/SignalR/wiki/Getting-Started)，它允许您使用长轮询、服务器发送事件或 Web 套接字来等待来自服务器的更新，并将其封装在一些易于实现的 .NET 类和 Javascript 中.

# android - 是否可以使用 Tcp 套接字同时向 n 个客户端发送数据？

> ID：10541564
> 
> 赞同：0
> 
> 时间：2012-05-10T20:23:24.953
> 
> 标签：android, sockets, clients

我正在尝试设置一个 Socket 服务器。我设法与客户沟通。我想做的是向更多客户发送相同的响应，比如说 2。这可能吗？任何人都可以提供提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:16:26.497

您所描述的技术是多播，但您可能不应该使用它。相反，在服务器上为每个客户端创建单独的线程，以便它们同时相互通信。

# ruby-on-rails - 我如何确定模型与控制器中的内容？

> ID：10541567
> 
> 赞同：2
> 
> 时间：2012-05-10T20:24:02.937
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, model-view-controller, ruby-on-rails-3.1

这是我最困惑的方面，我不断地向人们询问。他们给了我诸如“如果它与模型中的数据一起使用”之类的答案……但对我来说，这几乎就是全部。

有没有人有更好的方法来解释这一点？

我当前代码中的完美示例：

我有一个可以收藏或不收藏的帖子列表。在前端，我通过动态添加 class="favorite" 到 HTML 来区分不同的，这取决于它是否喜欢。

所以基本上...`<li class="item<%= is_favorite?(current_user.id) %>">`

我的一部分认为这应该进入模型，因为它会运行一个语句来查找匹配 :resource_id 和 :user_id 的记录...

但我的另一部分认为它会在控制器中，因为它直接输出`" favorite"`在 html 中使用的单词

我的第二个小问题是，将控制器使用的方法放在同一个控制器中是否是-rails-way？只要它们保持未布线等。或者那不是正确的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:27:11.217

你想的很准。

正确的答案是您应该使用演示者或装饰者。

[请参阅此 railscast 以获取灵感](http://railscasts.com/episodes/286-draper)。

# ruby - 理解使用“::”的 Ruby 代码

> ID：10541568
> 
> 赞同：1
> 
> 时间：2012-05-10T20:24:09.103
> 
> 标签：ruby

有时我会看到这样的代码：

```
module Elite

    module App
        def app
            'run app'
        end
    end

    module Base
        def base
            'base module'
        end
    end

    class Application
        include Elite::Base #Include variant A
        include ::Elite::App #Include variant B

        def initialize(str=nil) 
            puts "Initialized with #{str}"
            puts "Is respond to base?: #{base if self.respond_to?(:base)}"
            puts "Is respond to app?: #{app if self.respond_to?(:app)}"

        end
    end

    class Store < ::Elite::Application

        def initialize(str=nil)
            super #Goes to Application init
        end
    end
end

elite = Elite::Store.new(:hello) 
```

但我不明白`class Store < ::Elite::Application`and`class Store < Elite::Application`或`include Elite::Base`and之间有什么不同`include ::Elite::App` 只是编码风格，还是有什么不同？

类/模块之前做什么`::`？:: 类/模块的干净命名空间（模块名称）？因为`class Store < Application`有效，但这不起作用：`class Store < ::Application`. 请告诉我有什么区别...谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:28:24.510

'::' 是基本（全局）范围运算符。

所以'::Application'引用了基础应用程序，而'Application'引用了当前范围内的应用程序。

例如

```
class Application # Class 1
end

class Smile
  class Application # Class 2
  end

  ::Application # references class 1
  Application # references class 2 (The application in my current scope)
end 
```

# plone - archetype.schemaextender 和 Grok 适配器

> ID：10541570
> 
> 赞同：1
> 
> 时间：2012-05-10T20:24:39.353
> 
> 标签：plone, zope, grok

如何`archetypes.schemaextenders`注册`five.grok`.

尝试：

```
class QuickNavExtender(grok.Adapter):
    """
    Define schema fiddler which injects a new field to every item.
    """

    # This field comes on every AT content item
    grok.adapts(ISchemaExtender)
    grok.provider(ISchemaExtender)
    grok.context(IBaseContent)

    #adapts(IBaseContent)
    implements(ISchemaExtender)    

    fields = [
            ExtensionBooleanField("quicknav",
                widget = atapi.BooleanWidget(
                    label="Quick jump navigation",
                    description="Allow in-page jumping by navigation links"
                ),

                # On which edit tab this field appears
                schemata = "settings"
            )
    ] 
```

...没有被捡起。

但是，如果您添加此 ZCML 片段并回退 Zope 3 样式注册，则它可以工作：

```
<adapter factory=".extender.QuickNavExtender"
   provides="archetypes.schemaextender.interfaces.ISchemaExtender" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:43:43.957

我想你想要：

```
class QuickNavExtender(grok.Adapter):
    grok.context(IBaseContent)
    grok.implements(ISchemaExtender)
    # fields here... 
```

# php - 仅用新行替换第一次出现的多个空格

> ID：10541573
> 
> 赞同：2
> 
> 时间：2012-05-10T20:24:55.993
> 
> 标签：php, regex, preg-replace

> **可能重复：**
> [使用 preg_replace 仅替换第一个匹配项](https://stackoverflow.com/questions/6729710/replace-only-first-match-using-preg-replace)

我有一个字符串如下：

```
a     quick brown      fox jumps    over a lazy dog 
```

我希望结果是

```
a
quick brown      fox jumps     over a lazy dog 
```

只想用换行符替换第一次出现的多个（超过 1 个）空格，但在此之后保留其他多个空格。

我怎么能用 preg_replace 做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:26:48.270

```
echo preg_replace('/\s{2,}/', "\n", $string, 1); 
```

在[PHP 文档](http://php.net/manual/en/function.preg-replace.php)中，第四个参数 to`preg_replace`是一个可选限制，限制应该替换模式的次数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T20:27:49.593

Use the optional fourth parameter, setting the limit of replacements made for the pattern:

```
$str = preg_replace( "/\s{2,}/", PHP_EOL, $str, 1 ); 
```

Demonstration: [http://codepad.org/Kocnyryj](http://codepad.org/Kocnyryj)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T20:26:43.417

使用[`preg_replace()`](http://php.net/manual/en/function.preg-replace.php)'s`$limit`仅替换一个匹配项。

```
$string = preg_replace("/\s\s+/", "\n", $string, 1); // \s\s+ to replace 2 or more
// Where  preg_replace($pattern, $replacement, $subject, $limit); 
```

> **$limit**每个主题字符串中每个模式的最大可能替换。默认为 -1（无限制）。

# xml - 为包含节点值和属性的节点一起编写 xpath

> ID：10541576
> 
> 赞同：0
> 
> 时间：2012-05-10T20:25:09.583
> 
> 标签：xml, xpath

假设这是我的 XML：

```
<myxml>
   <data key="true">Apple</data>
   <data key="true">banana</data>
   <data1 key="true">banana</data1>
   <data>Apple</data>
</myxml> 
```

我需要一个包含属性`key="true"`和节点值 =的标记的 XPath 表达式`Apple`。

我尝试了不同的组合，但没有成功。

*   对于属性我使用这个`xpath="/myxml/data[@key='true']`
*   对于节点值，我使用它`xpath = "/myxml/data[. ='Apple']/`
*   也试试这个`xpath = "/myxml/data[.='Apple'][@key='true]/`

但有错误。

我在 xpath 中有多个标签。`/mappings/mapping[data[@iskey='true'][.='apple'] and data1[@iskey='true'][.='banana']/`

这条路有一个错误。

如何同时指定属性和节点值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:31:46.753

您需要使用“和”运算符。

从你的例子：

```
 /myxml/data[.='Apple' and @key='true'] 
```

在[http://www.w3schools.com/xpath/xpath_operators.asp](http://www.w3schools.com/xpath/xpath_operators.asp)下查看有关 xpath 运算符的更多信息。

# linux - 如何从主服务器上同步我的所有 Web 节点？

> ID：10541581
> 
> 赞同：0
> 
> 时间：2012-05-10T20:25:50.250
> 
> 标签：linux, bash, shell, load-balancing, rsync

我正在尝试在一堆负载平衡的 Web 节点（w1、w2、w3）上同步一堆域（a.com、b.com 和 c.com）。

我计划构建到节点 1 (w1)，然后通过类似这样的方式与其他节点进行 rsync：

```
rsync -arv /var/www/vhosts/a.com/ root@w1:/var/www/vhosts/a.com/ 
```

使用动态脚本（假设我已经在 w1 上）：

```
#!/bin/bash

DOMAINS="a.com b.com c.com"
NODES="w2 w3"

for DOMAIN in $DOMAINS; do
        for NODE in $NODES; do
                COMMAND="rsync -arv --exclude 'logs' --exclude '.git' /var/www/vhosts/$DOMAIN/ root@$NODE:/var/www/vhosts/$DOMAIN/"
                echo "$COMMAND"
                "$COMMAND"
        done
done 
```

第一个，手动，`rsync`工作得很好。但由于某种原因，我的批处理 rsync 脚本正在中断。

有人愿意帮我调试吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:28:42.170

你那里有一些过度引用。更改此行：

```
"$COMMAND" 
```

对此：

```
$COMMAND 
```

当您在整个事物周围加上引号时，shell 会将其解释为单个“标记”。这是一个简单的例子：

```
$ COMMAND="echo hello"
$ "$COMMAND"
bash: echo: command not found...
$ $COMMAND
hello 
```

# javascript - 悬停时显示内容

> ID：10541586
> 
> 赞同：2
> 
> 时间：2012-05-10T20:26:16.617
> 
> 标签：javascript, jquery, html

```
<div id="side">
    <h2 class="1">1</h2>
    <h2 class="2">2</h2>
    <ul>
        <li><a class="3"href="">3</a></li>
        <li><a class="4" href="">4</a></li>
    </ul>
</div> 
```

当我将鼠标悬停在`<a>`将显示的代码上时，代码会是`<h2>`什么？那么`.3`会显示`.1`吗？

这是我迄今为止尝试过的：

```
<script type="text/javascript"> 
    $(document).ready(function() { 
        $("#side a").hover( 
            function() { 
                $(this).children('.h2').show(); 
            }, 
            function() { 
                $(this).children('h2').hide(); 
            } 
        ); 
    }); 
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:29:47.973

```
<style>
.1{
    display: none;
}
</style>
<script>
document.querySelector('.3').onmouseover = function(){
    document.querySelector('.1').style.display = 'block';
};
document.querySelector('.3').onmouseout = function(){
    document.querySelector('.1').style.display = 'none';
};
</script>
<div id="side">
    <h2 class="1">1</h2>
    <h2 class="2">2</h2>
    <ul>
        <li><a class="3" href="">3</a></li>
        <li><a class="4" href="">4</a></li>
    </ul>
</div> 
```

而不是`document.querySelector('.3')`你可以使用`document.getElementsByClassName('3')[0]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:40:20.667

这是您的测试用例的示例，您应该为您的实时应用程序改进它。

JSFiddle 链接：[点击这里](http://jsfiddle.net/RM3yr/2/)

```
$(document).ready(function(){
    $("#side h2").hide();
    $("#side ul li a").mouseover(function() {
        if($(this).hasClass("3")) {
            $("#side h2.1").show();
        } else if($(this).hasClass("4")) {
            $("#side h2.2").show();
        } 
    }).mouseout(function() {
        if($(this).hasClass("3")) {
            $("#side h2.1").hide();
        } else if($(this).hasClass("4")) {
            $("#side h2.2").hide();
        }
    });
}) 
```

JSFiddle 链接：[点击这里](http://jsfiddle.net/RM3yr/2/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:33:38.203

```
<div id="side">
    <h2 class="one">What Have You Tried?</h2>
    <h2 class="two">2</h2>
    <ul>
        <li><a class="three"href="">3</a></li>
        <li><a class="four" href="">4</a></li>
    </ul>
</div>

<script type="text/javascript"> 
    $(document).ready(function() { 
        $("#side a").hover( 
            function() { 
                $("#side").find('.one').show(); 
            }, 
            function() { 
                $("#side").find('.one').hide(); 
            } 
        ); 
    }); 
</script> 
```

[http://jsfiddle.net/VdFxf/1/](http://jsfiddle.net/VdFxf/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T21:06:48.743

你会用`eq()`

如果我理解正确，您需要 ul 中的第一个项目，打开第一个标题。第二项，打开第二个标题，等等。

[eq()](http://api.jquery.com/eq/)获取提供的索引，该索引标识该元素在集合中的位置。

这是[小提琴](http://jsfiddle.net/Nymos/xDVcp/)

**HTML**

```
<div id="side">
    <h2 class="1">1</h2>
    <h2 class="2">2</h2>
    <ul>
        <li><a class="3" href="#">3</a></li>
        <li><a class="4" href="#">4</a></li>
    </ul>
</div>​ 
```

**jQuery**

```
$(document).ready(function(){
    $('#side a').on('click', function(){
        var index = $('#side a').index(this);
        // alert(index);
        alert($('#side h2').eq(index).html());
    });
});
​ 
```

注意：[eq 和 :nth-child 之间的区别](https://stackoverflow.com/questions/7039966/jquery-difference-between-eq-and-nth-child)

* * *

EIDT：当您要求悬停时，您可以这样做。

```
$(document).ready(function(){
    $('#side a').on('hover', function(){
        var index = $('#side a').index(this);
        // alert(index);
        // alert($('#side h2').eq(index).html());
        $('#side h2').eq(index).toggle();
    });
}); 
```

# python - Django中的UnicodeEncodeError

> ID：10541588
> 
> 赞同：0
> 
> 时间：2012-05-10T20:26:31.360
> 
> 标签：python, django

我试图在我的应用程序中加载一个页面，并弹出以下错误。我正在使用 tweepy 连接到 Twitter。而且我不知道错误来自哪里或我需要修复的行。很想知道我该如何解决这个问题。

```
 UnicodeEncodeError at /test/

   'charmap' codec can't encode character u'\u2019' in position 6: character maps to   <undefined>

   Request Method:      GET
   Request URL:     http://127.0.0.1:8000/test/
   Django Version:  1.3.1
   Exception Type:  UnicodeEncodeError
   Exception Value: 'charmap' codec can't encode character u'\u2019' in position 6: character maps to <undefined>
  Exception Location:   C:\Python27\lib\encodings\cp437.py in encode, line 12
  Python Executable:    C:\Python27\python.exe
  Python Version:   2.7.2 
```

视图.py

```
 def testdat(request):
      if request.method=="GET":
         treats=Cursor(api.list_timeline, owner=request.user, slug="").items(20)
         for treat in treats:
             print "%s\t%s\t%s\t%s" % (treat.text,
                                  treat.author.screen_name,
                                  treat.created_at,
                                  treat.source,)
             top=Twet(text= treat.text, author_screen_name= treat.author.screen_name, created_at= treat.created_at, source= treat.source)
             top.save()
        treats=Cursor(api.list_timeline, owner=request.user, slug='').items(20)
        return render_to_response('dashy.html',{'treats': treats},context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:30:30.327

停止打印。找出一种不同的调试方式。或者，首先编码为 UTF-8。

# asp.net-mvc-3 - 从内部动作方法 catch 块执行 ErrorFilter

> ID：10541589
> 
> 赞同：1
> 
> 时间：2012-05-10T20:26:39.490
> 
> 标签：asp.net-mvc-3, asp.net-mvc-filters

我正在使用全局 ErrorHandler 过滤器来记录未处理的异常，但我也希望能够使用相同的处理程序从 catch 块中记录已处理的异常。

我想访问全局过滤器并按照配置执行 ErrorHandler，但我在执行此操作时遇到了一些困难。我尝试了以下方法，但 Resharper 告诉我过滤器永远不可能是我的 ErrorLogFilter。

```
foreach (var filter in GlobalFilters.Filters)
{
    if (filter is ErrorLogFilter) // Static analysis tells me this can never be an ErrorLogFilter
    {
        // want to execute the filter
    }
} 
```

ErrorLogFilter 被添加到全局过滤器中，如下所示：

```
GlobalFilters.Filters.Add(new ErrorLogFilter(provider)); 
```

ErrorLogFilter（作为 Elfar 的一部分，类似于 Elmah，但用于 MVC）定义为：

```
public class ErrorLogFilter : FilterAttribute, IExceptionFilter 
```

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:35:27.547

`GlobalFilters.Filters`是一个[GlobalFilterCollection](http://msdn.microsoft.com/en-us/library/system.web.mvc.globalfiltercollection%28v=vs.98%29.aspx)，其中包含[Filter](http://msdn.microsoft.com/en-us/library/system.web.mvc.filter%28v=vs.98%29.aspx)，它们是添加的 s 的包装器`IMvcFilter`。

试试这个：

```
foreach (var filter in GlobalFilters.Filters)
{
    if (filter.Instance is ErrorLogFilter)
    {
        // want to execute the filter
    }
} 
```

所以 Reshaper 是正确的，表明没有`ErrorLogFilter`in `GlobalFilters.Filters`。

# c# - 组合框填充 valueMember 而不是 DataGridView 中的 DisplayMember？

> ID：10541602
> 
> 赞同：0
> 
> 时间：2012-05-10T20:27:46.427
> 
> 标签：c#, winforms, datagridview

我正在像这样填充组合框

```
cbDepartment.DataSource = SQLObject.Departments;
            cbDepartment.DisplayMember = "Name";
            cbDepartment.ValueMember = "Id"; 
```

和这样的数据gridview

```
EmployeeGrd.DataSource = SQLObject.sp_ViewEmployee(); 
```

组合框填充了另一个表，即我的查找表“部门”，它只包含“名称”和“Id”，而 DataGridView 填充了来自另一个表的存储过程，该表只包含部门表的“Id”我正在从数据网格视图中填充组合框，它正在组合框中填充“Id”，我需要填写“Name”而不是“Id”任何人都可以帮忙吗？

我正在像这样填充组合框。

```
 comboBox1.SelectedText = dataGridView1.SelectedRows[0].Cells[1].Value.ToString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:07:10.123

DataGridView 单元格具有`FormattedValue`您需要在此处使用的属性。

```
comboBox1.SelectedText = dataGridView1.SelectedRows[0].Cells[1].FormattedValue.ToString(); 
```

# javascript - 将键盘绑定到 Onclick 事件

> ID：10541606
> 
> 赞同：0
> 
> 时间：2012-05-10T20:27:57.160
> 
> 标签：javascript, jquery, keyboard, bind, slideshow

我在使用 jquery 幻灯片时遇到问题，我想在其中绑定下一个/右以使图像向前/向后跳转。

我使用以下代码尝试执行此操作，但它只是刷新页面。

```
<script>
$(function() {$(document).keyup(function(e) {
switch(e.keyCode) { case 37 : window.location = $('#prev a').attr('href'); break;
case 39 : window.location = $('#next a').attr('href'); break; }});});
</script> 
```

我试图打电话的是：

```
<a href='#' id='prev' onclick='show_image($prev); return false;'> 
```

和

```
<a href='#' id='next' onclick='show_image($next); return false;'> 
```

有谁知道一种简单的方法来切断中间人并简单地将左/右绑定到每个人的 onclick 事件？

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:35:06.907

这应该有效：

```
$(function() {
    $(document).keyup(function(e) {
        switch (e.keyCode) {
        case 37:
            $('#prev a')[0].onclick();
            break;
        case 39:
            $('#next a')[0].onclick();
            break;
        }
    });
});​ 
```

`onclick`只需根据您按下的键调用左键或右键的事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:41:08.300

```
$(function() {
    $(document).keyup(function(e) {
        switch (e.keyCode) {
        case 37:
            $('#prev').click();
            break;
        case 39:
            $('#next').click();
            break;
        }
    });
});​ 
```

# ruby-on-rails-3 - 来自带有 Authlogic 的 Rails 3.2.2 中 Uploadify 3.1 的请求不会产生 current_user

> ID：10541607
> 
> 赞同：2
> 
> 时间：2012-05-10T20:28:06.537
> 
> 标签：ruby-on-rails-3, uploadify, authlogic

我正在使用带有 Rails 3.2.2 的 Uploadify 3.1。我使用 Authlogic 来处理身份验证。Authlogic 提供了一种`current_user`方法，该方法向发出请求的用户提供。

当我尝试使用 Uploadify 3.1 上传某些文件时，在操作中查找时未设置 current_user，它给出了`nil`. Uploadify 2.1.4 没有发生这种情况。这是我调用uploadify的方式：

```
jQuery('#something').uploadify({

      uploader        : '#{some_path_from_rails_routes}',
      swf             : '/uploadify/uploadify.swf',
      cancelImg       : '/uploadify/cancel.png',
      fileTypeDesc    : 'FileNames',
      auto            : true,
      removeCompleted : false,
      buttonText      : 'Some Label',
      formData        : {
        '_http_accept': 'application/javascript',
        '#{session_key_name}' : encodeURIComponent('#{u(cookies[session_key_name])}'),
        'authenticity_token'  : encodeURIComponent('#{u(form_authenticity_token)}'),
      }
}); 
```

有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T05:27:49.623

Uploadify 的 flash 组件使用不同于 Rails 用于其会话的 cookie 存储。您可以使用[flash_cookie_session](https://github.com/trevorturk/flash_cookie_session) gem 来解决这个问题。

从它的文档来看，您似乎需要将您的修改为以下内容`formData`：

```
{
  "<%= key = Rails.application.config.session_options[:key] %>" : "<%= cookies[key] %>"
  "<%= request_forgery_protection_token %>" : "<%= form_authenticity_token %>",
} 
```

# javascript - 从计时器倒计时

> ID：10541609
> 
> 赞同：4
> 
> 时间：2012-05-10T20:28:12.747
> 
> 标签：javascript, jquery, countdown

有什么方法可以倒计时 60 秒...这是计时器的代码：

```
var count = 0;
var timer = $.timer(function() {
    $('#counter').html(++count);
});
timer.set({ time : 1000, autostart : true }); 
```

我需要做什么才能使这个代码像倒计时>谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-10T20:31:48.797

从 0 到 60 计数。

```
var count = 0, timer = setInterval(function() {
    $("#counter").html((count++)+1);
    if(count == 59) clearInterval(timer);
}, 1000); 
```

或从 60 到 0：

```
var count = 60, timer = setInterval(function() {
    $("#counter").html(count--);
    if(count == 1) clearInterval(timer);
}, 1000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:49:42.393

```
var timer;
var count = 60;

$("#counter").text(count);
//update display

timer = setTimeout(update, 1000);
//this allows for 'clearTimeout' if needed

function update()
{
    if (count > 0)
    {
       $("#counter").text(--count);
       timer = setTimeout(update, 1000);
    }
    else
    {
        alert("Done!!!");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:33:15.053

```
var count = 60;
var timer = $.timer(function() {
    $('#counter').html(--count);
});
timer.set({ time : 1000, autostart : true }); 
```

# django - Django OR 查询

> ID：10541611
> 
> 赞同：1
> 
> 时间：2012-05-10T20:28:15.393
> 
> 标签：django

我该怎么做：

```
FinancialStatements.objects.get(statement_id=statement_id) 
    or SalesStatements.objects.get(statement_id=statement_id) 
```

结果将始终产生一个结果。

我最终在这里使用了 try/except 路线：

```
 try:
        statement_object = FinancialStatements.objects.get(statement_id=statement_id)
    except FinancialStatements.DoesNotExist:
        statement_object = SalesStatements.objects.get(statement_id=statement_id) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:49:11.133

为什么不简单地做：

```
result = (FinancialStatements.objects.filter(statement_id=statement_id) or
          SalesStatements.objects.filter(statement_id=statement_id)) 
```

这应该有效，因为`filter`返回一个列表 - 如果没有条目匹配，则返回一个空列表。在 python 的布尔逻辑中，一个空列表的计算结果为 false，例如尝试运行：

```
print [] or "hello" 
```

（只是作为检查，比较`print ["Hi"] or "hello"`）

因此，如果第一个查询返回空，则将运行第二个查询。但是，如果第一个匹配任何内容，这将是结果，第二个查询将被忽略。

附录：结果将是列表类型 - 您需要使用`result[0]`.

# paypal - PayPal 订阅和 IPN

> ID：10541615
> 
> 赞同：5
> 
> 时间：2012-05-10T20:28:22.713
> 
> 标签：paypal

为用户创建 PayPal 订阅后，是`subscr_signup`在确认付款之前还是之后发送？

我正在使用[django-paypal](https://github.com/johnboxall/django-paypal)，它没有内置功能来处理`subscr_payment`IPN 消息。

这让我想知道我是否可以`subscr_signup`用作订阅成功的指标。

非常感谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-21T22:56:58.100

通常 subscr_signup 在 subscr_payment（相隔 3 秒）之后发送，但不能保证顺序。PayPal 的建议是依赖 subscr_signup。在这里阅读更多：http: [//www.mixedwaves.com/2010/11/paypal-subscriptions-ipn-demystified/](http://www.mixedwaves.com/2010/11/paypal-subscriptions-ipn-demystified/)

# cross-browser - 哪些浏览器支持 ::selection 中的文本阴影

> ID：10541617
> 
> 赞同：1
> 
> 时间：2012-05-10T20:28:24.417
> 
> 标签：cross-browser, selection, css

试图获得一些关于此的文档。已经看到它在一些网站中使用，他们`text-shadow`在`::selection`伪元素中声明。有人知道 IE 是否支持选定文本上的阴影吗？我知道火狐没有。哪些浏览器`text-shadow`支持`::selection`？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:31:25.863

使用此站点进行测试是[http://www.w3schools.com/cssref/tryit.asp?filename=trycss3_text-shadow](http://www.w3schools.com/cssref/tryit.asp?filename=trycss3_text-shadow)。只需将代码更改为`h1::selection {text-shadow:2px 2px #FF0000;}`，然后在单击“单击我”按钮后通过突出显示窗口中的 H1 文本来测试您选择的浏览器。

IE9根本不支持`text-shadow`，所以在a内`::selection`肯定行不通。但是，Chrome 确实支持`::selection`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:35:58.500

您可以阅读有关该问题的信息：

[::selection 伪元素的 W3C 工作草案](http://www.w3.org/TR/2005/WD-css3-selectors-20051215/#UIfragments)

[Mozilla 开发者网络关于 ::-moz-selection 和 ::selection 伪元素](https://developer.mozilla.org/En/CSS/%3a%3aselection)

您可以[将此页面](http://themousepotatowebsite.co.za/the-text-selection-pseudo-element/)用作测试基地（只需在所需的浏览器上打开它）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T11:35:26.073

实际上，有一个关于在 Firefox中支持`text-shadow`inside的持续讨论：`::selection`

[https://bugzilla.mozilla.org/show_bug.cgi?id=721750](https://bugzilla.mozilla.org/show_bug.cgi?id=721750)

# c# - 实体框架绑定到带有 .Include 的查询

> ID：10541622
> 
> 赞同：0
> 
> 时间：2012-05-10T20:28:46.413
> 
> 标签：c#, entity-framework-4

好的，我正在尝试做

```
from s in _db.Students.Include("Advisor") orderby s.LastName select s; 
```

一旦我开始工作，就会有更多的包含，但我需要先弄清楚这一点。基本上我不知道如何将文本框绑定到包含的顾问信息。我对主要学生数据的绑定有效，但不适用于顾问。绑定看起来像：

```
Text="{Binding Path=Advisor.AcadAdv}" 
```

主网格还包含我的学生对象 CollectionView 的 DataContext。

Advisor 是一个表格，其 id 是学生的外键和 5 个文本字段，其中包含顾问的姓名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:11:07.710

根据您提供的详细信息，您可以：
1）在绑定路径中指定项目（如下所示：{Binding Path=Advisor[0].AcadAdv}）
2）将 Advisor 属性绑定到任何 ItemsControl
3）制作一个视图模型，其中将 Advisor 属性作为集合的第一项
4) 使 Advisor 成为标量属性，而不是集合（这将需要更改实体模型）。

# list - 如何将具有相同第一项的列表项整理到地图上

> ID：10541628
> 
> 赞同：3
> 
> 时间：2012-05-10T20:29:06.660
> 
> 标签：list, scala

我知道这可能是 Scala 中一个非常简单的 List 操作，但我是新手，无法弄清楚。我有一个查询，它返回一个包含一系列值的结果集，这些值按一个公共 id 分组。例如：

结果集：

```
[{ 1, "a", 30 },
{ 1, "b", 20 },
{ 1, "c", 22 },
{ 2, "a", 32 },
{ 2, "c", 10 }] 
```

我想做的就是把它放到这样的地图中：

```
1 -> [{"a", 30}, {"b", 20}, {"c", 22}]
2 -> [{"a", 32}, {"c", 10}] 
```

我认为 collect 方法可以用于此，但无法弄清楚。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-10T20:33:50.293

我不确定您的数据结构中的类型是什么，但也许您可以调整它。这假设您有一组元组：

```
val items = 
  List((1, "a", 30),
       (1, "b", 20),
       (1, "c", 22),
       (2, "a", 32),
       (2, "c", 10))

items
  .groupBy{ case (a,b,c) => a }
  .mapValues(_.map{ case (a,b,c) => (b,c) })

// Map(1 -> List((a,30), (b,20), (c,22)), 2 -> List((a,32), (c,10))) 
```

或者，更简洁地说：

```
items.groupBy(_._1).mapValues(_.map(t => (t._2, t._3))) 
```

该`collect`方法完全是另一回事（基本上，它`map`会丢弃不匹配的值）。该`groupBy`方法是您真正想要的。

# android - 捏缩放，文本视图

> ID：10541630
> 
> 赞同：2
> 
> 时间：2012-05-10T20:29:09.283
> 
> 标签：android, android-layout

我正在尝试创建一个为用户显示歌词的应用程序。歌词存储在 values/strings.xml 中，并在访问活动时显示给用户。（我不确定这是否是一种好方法）。

根据每行文本的长度，我不知道我应该使用哪个文本大小，我真的可以使用一些“捏缩放”功能。

但是，我不知道是否可以“捏”放大文本视图。我在 webviews 和 imageviews 上找到了各种方法，但对于 textviews 没有。

我正在寻找通过“捏”增加文本大小/缩放布局的最佳方法

关于如何存储字符串和显示的帮助也非常受欢迎。

干杯!

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-13T18:57:58.063

我是 Android 开发的新手，并试图弄清楚。我有使用捏缩放的测试应用程序，但在[https://stackoverflow.com/questions/14306908/textview-in-a-scrollview-with-pinch-zoom提出了问题](https://stackoverflow.com/questions/14306908/textview-in-a-scrollview-with-pinch-zoom)

然而，这是有效的

```
package com.example.pinchzoom;

import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.util.TypedValue;
import android.view.Menu;
import android.view.MotionEvent;
import android.view.ScaleGestureDetector;
import android.view.ScaleGestureDetector.SimpleOnScaleGestureListener;
import android.widget.TextView;

public class MainActivity extends Activity {

    TextView scaleGesture;
    ScaleGestureDetector scaleGestureDetector;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        scaleGesture = (TextView)findViewById(R.id.article);
        scaleGesture.setText("this is some text");
        scaleGestureDetector = new ScaleGestureDetector(this, new simpleOnScaleGestureListener());
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        // TODO Auto-generated method stub
        scaleGestureDetector.onTouchEvent(event);
        return true;
    }

    public class simpleOnScaleGestureListener extends
            SimpleOnScaleGestureListener {

        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            // TODO Auto-generated method stub
            float size = scaleGesture.getTextSize();
            Log.d("TextSizeStart", String.valueOf(size));

            float factor = detector.getScaleFactor();
            Log.d("Factor", String.valueOf(factor));

            float product = size*factor;
            Log.d("TextSize", String.valueOf(product));
            scaleGesture.setTextSize(TypedValue.COMPLEX_UNIT_PX, product);

            size = scaleGesture.getTextSize();
            Log.d("TextSizeEnd", String.valueOf(size));
            return true;
        }
    }
} 
```

风景

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >
    <TextView
        android:id="@+id/article"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />
</RelativeLayout> 
```

# python - 转换日期格式python

> ID：10541640
> 
> 赞同：6
> 
> 时间：2012-05-10T20:29:31.233
> 
> 标签：python, django, python-datetime

我有 django 表单，我从 POST 收到格式为“%d/%m/%Y”的日期，我想将其转换为“%Y-%m-%d”，我该怎么做？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-10T20:34:05.880

使用[strptime 和 strftime](http://docs.python.org/library/datetime.html#strftime-strptime-behavior)：

```
In [1]: import datetime

In [2]: datetime.datetime.strptime('10/05/2012', '%d/%m/%Y').strftime('%Y-%m-%d')
Out[2]: '2012-05-10' 
```

同样，在 Django 模板语法中，您可以使用[日期过滤器](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#date)：

```
{{ mydate|date:"Y-m-d" }} 
```

以您喜欢的格式打印您的日期。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-10T20:33:53.510

一种方法是使用`strptime`and `strftime`：

```
>>> import datetime
>>> datetime.datetime.strptime('5/10/1955', '%d/%m/%Y').strftime('%Y-%m-%d')
'1955-10-05' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-10T05:35:34.347

您可以使用[easy_date](https://github.com/ralphavalon/easy_date)来简化：

```
import date_converter
my_datetime = date_converter.string_to_string('02/05/2012', '%d/%m/%Y', '%Y-%m-%d') 
```

# ajax - 如何在 jsf 中使用 Ajax 或不使用 Ajax 提交两个表单

> ID：10541642
> 
> 赞同：0
> 
> 时间：2012-05-10T20:29:38.657
> 
> 标签：ajax, jsf, primefaces, submit

我基本上有两个问题。

当我按下 Form1 中的按钮时，它工作正常，但我看不到来自 FacesContext 的消息。另一个问题是在 Form2 中。当我只按一次按钮时，它会转到服务器但没有任何反应，没有提交。但是当我第二次按下它时，它工作正常。当然也有和表格一一样的问题，我看不到来自 FacesContext 的消息。您能否帮忙告诉我是什么原因造成的，或者是否有另一种解决方案可以在一个页面内包含多个表单？

```
 <p:tabView>
                        <p:tab title="Form1">
                            <h:form id="form1">
                                <p:inputText id="txtInput" value="#{controller.selected.defaultLayout}" />
                                <h:commandButton value="Submit other form" action="#{controller.createMenu()}">
                                    <f:ajax execute="@form" render="@form" />
                                </h:commandButton>

                            </h:form>
                        </p:tab>
                        <p:tab title="Form2">
                            <h:form id="form2">
                                <p:inputText id="txtInput2" value="#{controller.selected.defaultTheme}" />
                                <h:commandButton value="Submit other form" action="#{controller.createMenu2()}">
                                    <f:ajax execute="@form" render="@form" />
                                </h:commandButton>
                             </h:form>
                        </p:tab>
                    </p:tabView> 
```

控制器：

```
public String createMenu() {

        Menu menu = current.getMenuMenuId();

        try {
            //current.getMenuMenuId().setMenuCreated(true);
            //getFacade().edit(current);
            JsfUtil.addSuccessMessage(ResourceBundle.getBundle("resources/Bundle").getString("MenuCreated"));-----> never visible!

            return "";
        } catch (Exception e) {
            JsfUtil.addErrorMessage(e, ResourceBundle.getBundle("resources/Bundle").getString("PersistenceErrorOccured"));
            return null;
        }

    } 
```

编辑：我关闭了外部标签，然后页面不再工作，然后我收到错误消息：

```
javax.faces.FacesException: <f:ajax> contains an unknown id ':form2' - cannot locate it in the context of the component j_idt77
    at com.sun.faces.renderkit.html_basic.AjaxBehaviorRenderer.getResolvedId(AjaxBehaviorRenderer.java:285)
    at com.sun.faces.renderkit.html_basic.AjaxBehaviorRenderer.appendIds(AjaxBehaviorRenderer.java:272)
    at com.sun.faces.renderkit.html_basic.AjaxBehaviorRenderer.buildAjaxCommand(AjaxBehaviorRenderer.java:214)
    at com.sun.faces.renderkit.html_basic.AjaxBehaviorRenderer.getScript(AjaxBehaviorRenderer.java:86)
    at javax.faces.component.behavior.ClientBehaviorBase.getScript(ClientBehaviorBase.java:103) 
```

谢谢！萨米人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:55:51.617

嵌套表单不是有效的 html。这将导致意外行为。删除外部表单，看看您的哪些问题仍然存在。

更新：

Primefaces tabview 也可以在没有表单的情况下工作。但是，如果您的选项卡中有输入元素和命令按钮，则需要一个表单。但这是一个 html 要求，而不是特定于 PF 的。您应该只删除外部形式而不是内部形式。请使用您当前的版本更新您的问题。

# php - Doctrine 2.0：如何在 OneToOne 关系中定位实体的超类

> ID：10541644
> 
> 赞同：1
> 
> 时间：2012-05-10T20:29:55.723
> 
> 标签：php, doctrine, doctrine-orm

我不太擅长提问，但下面的代码应该是不言自明的。我需要创建一个从类到不是实体的实体超类的 OneToOne 关联。

```
/* Not an entity */
class Superclass {
      /** 
       *@Id @Column(name="entity_id", type="integer") @GeneratedValue 
       **/
      protected $id;
}

/**
 * @Entity @Table(name="subclasses1")
 **/
class Subclass1 extends Superclass {

}

/**
 * @Entity @Table(name="subclasses2")
 **/
class Subclass2 extends Superclass {

}

/**
 * @Entity @Table(name="assoc")
 **/
class Associationclass
{
    /**
     *OneToOne(targetEntity="Superclass")
     **/
    protected $association;

    /**
     *@Column(type="string")
     **/
    protected $info;
} 
```

问题是：如何使用 OneToOne 关系同时引用 subclass1 和 subclass2 而不使超类成为实体（创建新表并使用鉴别器）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T05:16:16.910

你不能。如果你想要那种继承（你可以在关联中使用的那种），你需要在学说中对继承建模。

关联需要一个“targetEntity”——正如名称所示，它必须是一个实体。

除非有很好的理由不这样做，否则请继续将您的超类设置为实体，并以教义可以理解的方式设置继承。

您的超类需要成为实体的原因是因为超类及其子类将共享一个标识符。因此，有了标识符（和鉴别器），教义就可以确定 SuperClass#1234 实际上是 SubClass2。

# php - 使用 javascript/php 的静态倒计时，如何？

> ID：10541650
> 
> 赞同：1
> 
> 时间：2012-05-10T20:30:16.957
> 
> 标签：php, javascript, jquery

```
var austDay = new Date("May 18, 2012 00:00:00");
            $('#countdown').countdown({until: austDay}); 
```

是我得到的。我希望使这个静态化，我的意思是它在所有时区显示相同的倒计时。因此，无论您是否更改了您的时区或您的电脑上的日期，它都不应该影响倒计时并且它应该仍然是例如剩下 8 小时。

也许这是不可能的，因为 Javascript 是客户端？

我能做些什么？我真的希望它能够倒计时，而不是你需要刷新。也许我可以使用 PHP 的一些帮助？

倒计时应该是相同的，例如还剩 4 小时，它也应该在纽约和亚洲显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:41:22.223

您可以像这样使用 PHP 将服务器时间传递给客户端。

```
var time = new Date(<?php echo time()*1000; ?>); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:51:10.403

```
var austDay = new Date("May 18, 2012 00:00:00"); 
```

*这将在用户的本地 timezone*中创建一个显示日期和时间的日期对象。要创建 UTC 日期，您可以改为执行以下操作：

```
var austDay = new Date(Date.UTC(2012, 4, 18)); 
```

...其中 4 是*从零开始的*月份数（显然，2012 和 18 是年和日）。

如果您需要在之后*显示*日期，请使用“UTC”函数而不是它们的非 UTC 对应函数，例如：

```
console.log(austDay.toUTCString()) // "Fri, 18 May 2012 00:00:00 GMT" 
```

* * *

另一个问题是用户可以更改他们的时钟。为了给他们“还剩 8 小时”之类的信息并且绝对确定，您必须将服务器时间与客户端时间进行比较，并根据该时间设置日期。

例如，如果服务器知道事情发生在明天中午，并且是晚上 9:00，那么倒计时在 15 小时后结束。您可以告诉客户在倒计时准备好之前还剩多少时间，而不是给他们一个绝对时间。

```
var austDay = new Date();
var hoursLeft = <?php echo $something ?>;

austDay.addHours(hoursLeft); 
```

您可能希望在几秒钟或更短的时间内完成，而不是几小时，为了简单起见，我在这里使用了几小时。

# java - 列出retainAll异常

> ID：10541651
> 
> 赞同：9
> 
> 时间：2012-05-10T20:30:18.427
> 
> 标签：java, list, exception, sublist

我想测试如何获得两个列表之间的交集，这是我的代码：

```
 List<Integer> list = Arrays.asList(16, 17, 18, 19, 20);
        List<Integer> list2 = list.subList(2, 5);

        System.out.println(list.subList(2, 5));
        System.out.println(list.containsAll(list.subList(2, 5)));
        System.out.println(list.retainAll(list2)); 
```

这产生：

```
Exception in thread "main" java.lang.UnsupportedOperationException
    at java.util.AbstractList.remove(Unknown Source)
    at java.util.AbstractList$Itr.remove(Unknown Source)
    at java.util.AbstractCollection.retainAll(Unknown Source)
    at gov.noaa.nhc.App.main(App.java:48) 
```

但我没有做任何删除。为什么会产生异常？

**更新我：**

使用 ：

```
List<Integer> list = new ArrayList<Integer>(Arrays.asList(16, 17, 18, 19, 20));
List<Integer> list2 = list.subList(2, 5); 
```

生产：

```
java.util.ConcurrentModificationException 
```

由于 list2 由 list1 支持，因此从 list1 中删除项目将导致此异常。最后的工作版本：

```
List<Integer> list = new ArrayList<Integer>(Arrays.asList(16, 17, 18, 19, 20));
List<Integer> list2 = Arrays.asList(18, 19, 20); 
```

或者

```
List<Integer> list = new ArrayList<Integer>(Arrays.asList(16, 17, 18, 19, 20));
List<Integer> list2 = new ArrayList<Integer>(Arrays.asList(18, 19, 20)); 
```

或者

```
 List<Integer> list = new ArrayList<Integer>(Arrays.asList(16, 17, 18, 19, 20));
 List<Integer> list2 = new ArrayList<Integer>(list.subList(2, 5)); 
```

谢谢大家的回答。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-10T20:34:43.023

使用 时`Arrays.asList`，您会得到一个列表，该列表由传入的具有受限功能的实际数组支持。如果您想要一个完全可修改的列表，您必须创建一个新列表。例如：

```
List<Integer> list = new ArrayList<Integer>(Arrays.asList(16, 17, 18, 19, 20));
List<Integer> list2 = new ArrayList<Integer>(list.subList(2, 5));
list.retainAll(list2);
System.out.println(list);
// result: [18, 19, 20] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T20:34:09.217

正如[文档](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#retainAll%28java.util.Collection%29)所说，该`List.retainAll()`方法

> 仅保留此列表中包含在指定集合中的元素（可选操作）。换句话说，从这个列表**中删除**所有不包含在指定集合中的元素。[强调我的]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:32:54.040

[retainAll](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#retainAll%28java.util.Collection%29)确实从调用它的列表中删除项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T20:33:52.447

retainAll 确实删除了所有不在给定列表中的元素。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T20:38:19.200

文档还说，当 List 实现不支持此方法时，retainAll 会抛出 UnsupportedOperationException。

# azure - Windows Azure 角色可以检测角色所在的数据中心吗？

> ID：10541652
> 
> 赞同：5
> 
> 时间：2012-05-10T20:30:19.127
> 
> 标签：azure, azure-role-environment

我们的 Windows Azure 角色需要以编程方式了解角色所在的数据中心。

我知道一个 REST API ( [http://msdn.microsoft.com/en-us/library/ee460806.aspx](http://msdn.microsoft.com/en-us/library/ee460806.aspx) ) 返回位置属性。如果我部署到美国西部，REST API 会返回美国西部作为位置属性。但是，如果我部署到 Anywhere US，则该属性是 Anywhere US。即使位置属性是美国任何地方，我也想知道我们的角色在哪个数据中心。

我问的原因是我们的角色需要从 Windows Azure 存储中下载一些数据。从同一个数据中心下载数据是免费的，但从不同数据中心下载数据不是免费的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:42:17.420

两天前，Microsoft 发布了一个[XML 文件，其中包含每个区域的 IP 范围列表](http://www.microsoft.com/en-us/download/details.aspx?id=29840)。根据此文件和您的角色的 IP 地址，您可以找到该角色已部署在哪个数据中心。

```
<?xml version="1.0" encoding="UTF-8"?>
<regions>
  ...
  <region name="USA">
    <subregion name="South Central US">
      <network>65.55.80.0/20</network>
      <network>65.54.48.0/21</network>
      ...
    </subregion>
    <subregion name="North Central US">
      <network>207.46.192.0/20</network>
      <network>65.52.0.0/19</network>
      ...
    </subregion>
  </region>
</regions> 
```

**注意：**这个 XML 文件似乎没有涵盖新的数据中心（美国西部和东部），这可能使其在您的情况下无用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T21:08:50.253

这是一个很好的问题，我已经与不同的合作伙伴讨论过几次。根据我在您创建服务并提供您希望此服务的位置（“美国中南部”或“美国任何地方”）时的理解，此信息存储在您的 Azure 订阅中特定于您的服务的 RDFE 服务器上。因此，当您选择“美国中南部”或“美国中北部”等固定位置时，实际部署到该位置的服务和确切位置将被存储，但是当您选择“美国任何地方”时，选择“南部中心”或“North Central”在内部完成，但所选位置从未更新到与您的服务相关的 RDFE 服务器。

这就是为什么每当您尝试通过 SM API 或 Powershell 或任何其他方式在订阅中获取与您的服务相关的位置信息时（即使在 Azure 门户上它也被列为“美国任何地方”，因为信息来自同一存储），您将准确获取您在创建服务期间首先选择的内容。

只要您可以从 Windows Azure 团队发布的给定 IP 地址范围验证您的服务位置 IP 地址，@Sandrino 想法就可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T02:33:57.473

I had some services deployed in Anywhere US and in order to find out which data centre it was deployed in I had to log a support call with Microsoft. They were helpful and got me the information but even they had to go away and look it up. As a result of this I would never use and the the "Anywhere ..." locations. Knowing which data centre your services are running in is very important for knowing where to deploy things like SQL Azure and service bus which don't support affinity groups and don't have an Anywhere option.

# java - 从 web 服务中的 sun-web.xml 获取 context-root

> ID：10541654
> 
> 赞同：0
> 
> 时间：2012-05-10T20:30:28.580
> 
> 标签：java, web-services, glassfish, jax-ws

部署时，Web 服务 URL 为 http://localhost:8080/[context-root]/[serviceName]。context-root 尤其是项目的名称，但除此之外仅显示在 WEB-INF 中的 sun-web.xml 中。如何将这些信息传递给 java 层？我需要以编程方式获取 Web 服务的 url，而 context-root 是目前唯一缺少的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T09:19:46.047

这是您如何做到这一点的方法。假设此代码在服务类中

```
@Resource
WebServiceContext wsContext;

@WebMethod
public String myServiceOperation(){
MessageContext context = wsContext.getMessageContext();
HttpServletRequest res = (HttpServletRequest) context.get(MessageContext.SERVLET_REQUEST) ;
System.out.println(" Context:path "+res.getContextPath());
} 
```

这会将上下文路径打印到控制台。

# regex - sed/awk/RegEX 返回以三个冒号结尾的行

> ID：10541657
> 
> 赞同：2
> 
> 时间：2012-05-10T20:30:34.913
> 
> 标签：regex, linux, sed, awk

所以我在一个看起来像这样的文件中有几行

```
useradmin:$NT$asdlfkjwaeroisglkwerlkj23424tlj:::  
useradmin:c2q3r4lsdfk23rlsdfkj3rjsdflk2k23::: 
```

我想知道是否有 sed 和 Regex 的脚本来返回这些行？我已经尝试了以下，但他们没有工作......

```
sed -n '/^\w+:{3}$/p' fileA.txt   
sed -n '/^\w:{3}$/p' fileA.txt 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T21:02:17.997

要使用大括号量词`sed`（如果您的版本支持），您需要转义大括号或使用`-r`. 加号也是如此。但是，`sed`不支持`\w`.

```
sed -nr '/^.+:{3}$/p' fileA.txt 
```

或者

```
sed -n '/^.\+:\{3\}$/p' fileA.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:35:03.290

grep怎么样：

```
grep ":::$" fileA.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T09:39:42.493

这可能对您有用：

```
sed '/.:::$/!d' fileA.txt 
```

# php - Magento：如何分离多个属性的显示？

> ID：10541658
> 
> 赞同：1
> 
> 时间：2012-05-10T20:30:37.610
> 
> 标签：php, magento, content-management-system, e-commerce

我正在使用此代码在 Magento 中显示（在前端）产品的所有分配属性：

```
<?php if ($_product->getData('metal')): ?>  
    <?php echo nl2br($_product->getResource()->getAttribute('metal')->getFrontend()->getValue($_product )) ?>  
<?php endif; ?> 
```

我需要用一个要点`&#149;`和一个 break来分隔每个项目`<br/>`。我将如何编辑此代码以反映这些更改？提前致谢。

_山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-04T08:39:26.383

如果您想对输出进行更多控制（也许您想设置单个值的样式），请使用 explode();

```
<?php $attr = explode("," ,  $_helper->productAttribute($_product, $_data['value'], $_data['code'])); 
echo "<ul>";
?>
<?php foreach ($attr as $attrValue) {
    echo "<li>" . $attrValue . "</li>";
} 
echo "</ul>";
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-02T13:09:09.273

解决了。这很容易：如果您的默认包中没有，则从 base 复制 attributes.phtml。

放入 app/design/frontend/default/default/template/catalog/product/view/ 文件夹

将第 46 行从：

```
<td class="data"><?php echo $_helper->productAttribute($_product, $_data['value'], $_data['code']) ?></td> 
```

显示单独的产品属性：

```
<td class="data"><?php echo $_helper->productAttribute($_product, str_replace(",", "<br />", $_data['value']), $_data['code']) ?></td> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T17:14:38.270

假设上面的代码是“工作”......做这个改变：

```
<?php echo "&#149;".nl2br($_product->getResource()->getAttribute('metal')->getFrontend()->getValue($_product ))."<br/>" ?> 
```

the`.`是一个字符串连接运算符。

或者如果以上是产品列表的 HTML，您是否在问如何做到这一点？那么这应该工作......

```
<?php 
$somehtml=nl2br($_product->getResource()->getAttribute('metal')->getFrontend()->getValue($_product ));
$somehtml=explode("<br />",$somehtml);  // This ASSumes nl2br inserts <br /> between each line and this 
                                        // would lead to the behaviour you want.
                                        // see: http://php.net/manual/en/function.nl2br.php
$somehtml=implode("<br/>\n&#149;",$somehtml);
$somehtml="&#149;".$somehtml."<br/>\n";
echo $somehtml;
unset($somehtml);
?> 
```

`explode`通过`"<br />"`. `implode`然后通过放置`<br/>\n&#149;`在每个元素之间重新加入字符串。最后，我将项目符号点添加到前面并在末尾添加 br。内爆时，您仍然必须考虑字符串的“外部”。

# mysql - 在 MySQL 中索引和查询分析表的最佳方法

> ID：10541660
> 
> 赞同：1
> 
> 时间：2012-05-10T20:30:39.997
> 
> 标签：mysql, sql, indexing, subquery, analytics

我有一个具有以下结构的分析表（5M 行并且还在增长）

```
Hits 
  id int() NOT NULL AUTO_INCREMENT,
  hit_date datetime NOT NULL,
  hit_day int(11) DEFAULT NULL,
  gender varchar(255) DEFAULT NULL,
  age_range_id int(11) DEFAULT NULL,
  klout_range_id int(11) DEFAULT NULL,
  frequency int(11) DEFAULT NULL,
  count int(11) DEFAULT NULL,
  location_id int(11) DEFAULT NULL,
  source_id int(11) DEFAULT NULL,
  target_id int(11) DEFAULT NULL, 
```

对表的大多数查询是在两个日期时间之间查询特定的列子集，并将所有行中的所有计数列相加。例如：

```
SELECT target.id,
   SUM(CASE gender WHEN 'm' THEN count END) AS 'gender_male',
   SUM(CASE gender WHEN 'f' THEN count END) AS 'gender_female',
   SUM(CASE age_range_id WHEN 1 THEN count END) AS 'age_18 - 20',
   SUM(CASE target_id WHEN 1 then count END) AS 'target_test'
   SUM(CASE location_id WHEN 1 then count END) AS 'location_NY'
FROM Hits
WHERE (location_id =1 or location_id = 2)
  AND (target_id = 40 OR target_id = 22)
  AND cast(hit_date AS date) BETWEEN '2012-5-4'AND '2012-5-10'
GROUP BY target.id 
```

查询此表的有趣之处在于 where 子句包括命中列名称和值的任何排列，因为这些是我们要过滤的内容。因此，上面的特定查询是获取 NY 中 18 到 20 岁（age_range_id 1）之间的男性和女性的数量，这些男性和女性属于一个名为“测试”的目标。但是，有超过 8 个年龄组、10 个 klout 范围、45 个位置、10 个来源等（所有外键引用）。

我目前有一个关于 hot_date 的索引和另一个关于 target_id 的索引。正确索引此表的最佳方法是什么？在所有列字段上都有一个复合索引似乎本质上是错误的。

有没有其他方法可以在不使用子查询来汇总所有计数的情况下运行此查询？我做了一些研究，这似乎是获得我需要的数据集的最佳方式，但有没有更有效的方式来处理这个查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T21:28:59.367

这是您的优化查询。这个想法是摆脱`OR`s 和`CAST()`hit_date 上的函数，以便 MySQL 可以利用复合索引来覆盖每个数据子集。您需要按该顺序在 ( `location_id`, `target_id`, ) 上创建复合索引。`hit_date`

```
SELECT id, gender_male, gender_female, `age_18 - 20`, target_test, location_NY
FROM
(
SELECT target.id,
   SUM(CASE gender WHEN 'm' THEN 1 END) AS gender_male,
   SUM(CASE gender WHEN 'f' THEN 1 END) AS gender_female,
   SUM(CASE age_range_id WHEN 1 THEN 1 END) AS `age_18 - 20`,
   SUM(CASE target_id WHEN 1 then 1 END) AS target_test,
   SUM(CASE location_id WHEN 1 then 1 END) AS location_NY
FROM Hits
WHERE (location_id =1)
  AND (target_id = 40)
  AND hit_date BETWEEN '2012-05-04 00:00:00' AND '2012-05-10 23:59:59'
GROUP BY target.id

UNION ALL

SELECT target.id,
   SUM(CASE gender WHEN 'm' THEN 1 END) AS gender_male,
   SUM(CASE gender WHEN 'f' THEN 1 END) AS gender_female,
   SUM(CASE age_range_id WHEN 1 THEN 1 END) AS `age_18 - 20`,
   SUM(CASE target_id WHEN 1 then 1 END) AS target_test,
   SUM(CASE location_id WHEN 1 then 1 END) AS location_NY
FROM Hits
WHERE (location_id = 2)
  AND (target_id = 22)
  AND hit_date BETWEEN '2012-05-04 00:00:00' AND '2012-05-10 23:59:59'
GROUP BY target.id

UNION ALL

SELECT target.id,
   SUM(CASE gender WHEN 'm' THEN 1 END) AS gender_male,
   SUM(CASE gender WHEN 'f' THEN 1 END) AS gender_female,
   SUM(CASE age_range_id WHEN 1 THEN 1 END) AS `age_18 - 20`,
   SUM(CASE target_id WHEN 1 then 1 END) AS target_test,
   SUM(CASE location_id WHEN 1 then 1 END) AS location_NY
FROM Hits
WHERE (location_id =1)
  AND (target_id = 22)
  AND hit_date BETWEEN '2012-05-04 00:00:00' AND '2012-05-10 23:59:59'
GROUP BY target.id

UNION ALL

SELECT target.id,
   SUM(CASE gender WHEN 'm' THEN 1 END) AS gender_male,
   SUM(CASE gender WHEN 'f' THEN 1 END) AS gender_female,
   SUM(CASE age_range_id WHEN 1 THEN 1 END) AS `age_18 - 20`,
   SUM(CASE target_id WHEN 1 then 1 END) AS target_test,
   SUM(CASE location_id WHEN 1 then 1 END) AS location_NY
FROM Hits
WHERE (location_id = 2)
  AND (target_id = 22)
  AND hit_date BETWEEN '2012-05-04 00:00:00' AND '2012-05-10 23:59:59'
GROUP BY target.id
) a
GROUP BY id 
```

如果您的选择大小太大以至于没有任何改进，那么您不妨像已经在做的那样继续扫描所有行。

请注意，用反引号括起别名，而不是单引号，这已被弃用。我还修正了你的`CASE`条款，`count`而不是`1`.

# ruby - 显式返回函数值的好习惯？

> ID：10541661
> 
> 赞同：3
> 
> 时间：2012-05-10T20:30:42.637
> 
> 标签：ruby, function, return-value

你更喜欢这个：

```
def add(a, b)
  puts "ADDING #{a} + #{b}"
  return a + b
end 
```

在这个？

```
def add(a, b)
  puts "ADDING #{a} + #{b}"
  a + b
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T20:36:32.020

`return`除非绝对需要，否则不包含该语句是 The Ruby Way™ 。

我相信有更好的例子，但这里有一个简单的例子。

```
def divide a, b
    return false if b == 0
    a/b
end 
```

* * *

值得注意的是，Ruby 提供了可以选择性地忽略大量语法的方法。`()`是可选的，除非你嵌套它们。`{}`在很多情况下也可以省略。

```
func(5, 5, {:hello => 'world'})
# is the same as
func 5, 5, hello: 'world' 
```

你会在学习过程中学到更多的捷径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:36:04.910

[样式指南](https://github.com/bbatsov/ruby-style-guide)说要省略显式返回

> 避免在不需要的地方返回。

```
# bad
def some_method(some_arr)
  return some_arr.size
end

# good
def some_method(some_arr)
  some_arr.size
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T05:13:34.797

看看这个：[http ://www.robertsosinski.com/2008/12/21/understanding-ruby-blocks-procs-and-lambdas/](http://www.robertsosinski.com/2008/12/21/understanding-ruby-blocks-procs-and-lambdas/)

它解释了 return 如何在 procs、lambdas 和 blocks 上工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T20:34:51.697

这一切都取决于上下文。通常，没有必要明确表示：rubyists 知道最后一个表达式是返回的表达式。然而，在极少数情况下，最后一个表达式不容易掌握，例如在一个交互或一些晦涩的结构中，所以它可能会很好。但通常，没有必要。

编辑：

显然，当你试图返回一个不是你方法的最后一个表达式时，你*必须*使用 return。就像你对延迟加载的访问器所做的那样

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-10T20:35:28.360

优点`return a + b`：

*   可读性
*   不易出错

缺点：

*   冗长的

# arrays - （bash）如何将命令输出块作为离散数组元素访问？

> ID：10541662
> 
> 赞同：3
> 
> 时间：2012-05-10T20:30:44.760
> 
> 标签：arrays, string, bash, concatenation

```
nmcli -t -f STATE,WIFI,WWAN 
```

给出输出

```
connected:enabled:disabled 
```

我想转换成类似的东西

```
Networking: connected, Wifi: enabled, WWAN: disabled 
```

对我来说合乎逻辑的解决方案是把它变成一个数组。作为 bash 脚本的新手，我读过数组只是常规变量，元素由空格分隔。目前我的代码是

```
declare -a NMOUT=$(nmcli -t -f STATE,WIFI,WWAN nm | tr ":" "\n") 
```

这似乎适用于 for 循环，但如果我想询问特定元素，如在 ${NMOUT[]} 中，则不是。显然，我在这里错过了一些关键概念。如何访问此数组中的特定元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:32:45.600

```
IFS=: read -a NMOUT < <(nmcli -t -f STATE,WIFI,WWAN) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T02:12:53.550

Ignacio Vazquez-Abrams 为创建阵列提供了更好的解决方案。我将解决发布的问题。

bash 中的数组由从 0 开始的整数索引。

```
"${NMOUT[0]}" # first element of the array
"${NMOUT[2]}" # third element of the array
"${NMOUT[@]}" # All array elements
"${NMOUT[*]}" # All array elements as a string 
```

以下提供了有关在 bash 中使用数组的良好信息：http: [//mywiki.wooledge.org/BashFAQ/005](http://mywiki.wooledge.org/BashFAQ/005)

# android - Javascript 中的 HTML5 音频音量 (Android 2.3)

> ID：10541670
> 
> 赞同：0
> 
> 时间：2012-05-10T20:31:17.830
> 
> 标签：android, volume, html5-audio

```
// Standard HTML5 implementation of StartMusic.
function Html5StartMusic(music)
{
    var player = document.getElementById('musicPlayer');
    player.volume = 0.1;
    player.setAttribute('src', 'music/' + music + '.ogg');
    player.play();
} 
```

设置音量在 PC Chrome 中有效，但在 Android 2.3 Webkit 中无效。有没有其他方法可以让它工作？

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-12T10:59:52.157

最后，我解决了这个问题，在应用程序端编写了自己的播放器，支持音量控制。为了回调播放器函数，我使用 onJsAlert() 作为 API（onConsoleMessage() 似乎更好，但我听说在某些手机上它被禁用了）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T13:16:25.207

尝试：

```
yourAudioElement.mute = true 
```

# ios - iOS - 阻止屏幕截图/水印

> ID：10541671
> 
> 赞同：0
> 
> 时间：2012-05-10T20:31:22.837
> 
> 标签：ios

是否可以阻止应用程序的屏幕截图（电源 + 菜单按钮）？如果没有，这个屏幕截图可能会收到水印吗？

问候，克劳迪奥

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:35:00.090

创建屏幕截图是一种系统行为，您不能覆盖它。

重复[通知或检测正在拍摄的屏幕截图？](https://stackoverflow.com/questions/2121970/notification-of-or-detecting-screenshot-being-taken)

# javascript - 使用 express 设置基本服务器

> ID：10541676
> 
> 赞同：1
> 
> 时间：2012-05-10T20:31:43.820
> 
> 标签：javascript, http, node.js, express, pug

我有一个 node.js 应用程序，当我尝试加载主页时遇到错误消息。我会尽力在下面布置我的架构。它是 index.js --> server.js --> router.js --> requestHandlers.js

我正在使用 express (www.expressjs.com) 和 nodebeginner.org 的组合。很抱歉这个长问题..只是想尽可能多地获取信息。

index.js（创建包含路径名/请求处理程序信息的句柄对象，调用函数来启动服务器）我在这里从 router.route 开始，并在每个步骤中传递它

```
var server = require("./server");
var router = require('./router');
var requestHandlers = require('./requestHandlers');

// Routes

var handle = {}
handle['/'] = requestHandlers.home;

server.start(router.route, handle) 
```

server.js（启动服务器，这是我要配置服务器的地方，从 URL 获取路径名，并将其传递给路由模块）

```
var http = require("http");
var url = require('url');
var express = require('express');

function start (route, handle) {
    var onRequest = function(request, res) {
        var pathname = url.parse(request.url).pathname;
        console.log("request for " + pathname + " recieved.");
        route(handle, pathname, res);
    }

    var app = express.createServer(onRequest).listen(8888);
    if (app.configure) {
        console.log('app exists'); //logging correctly
    }
    // Configuration
     app.configure(function(){
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(app.router);
  app.use(express.static(__dirname + '/public'));
});

app.configure('development', function(){
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
});

app.configure('production', function(){
  app.use(express.errorHandler());
});

    console.log("Express server listening on port %d in %s mode", app.address().port, app.settings.env); //logs correct with 8888 and development
}

exports.start = start; 
```

router.js（从 index --> server 传递的函数 route 调用 router.js 中的 route 函数，调用与句柄对象中的路径名匹配的 requestHandler）

```
function route (handle, pathname, res) {

    console.log("About to route a request for" + pathname); //About to route a request for/stylesheets/style.css SEE BELOW******* this is the error

if (typeof handle[pathname] === 'function') {
        handle[pathname] (res);
    }
    else {
        console.log('no request handler found for' + pathname);
    }
}

exports.route = route; 
```

requestHandler.js（与 res/req 对象交互，函数映射到某些路径名，仅在请求这些路径名时才调用，这要归功于路由器）

```
var home = function(res){
  res.render('index', { title: 'WWYB?' });
  console.log('homepage rendered'); //correctly logs for pathname = '/'
  //click();
};

exports.home = home; 
```

******** *当我去请求 localhost:8888 时，它会尝试发出一堆请求。首先它正确地请求“/”，然后继续记录所有说“关于路由/stylesheets/style.css”的请求最终页面加载时没有css。我的 layout.jade 文件中指示的路径名正是“/stylesheets/style.css”。**

 **为什么路径名总是评估为 /stylesheets/style.css？我认为节点正在后台做某事，我不完全理解。

如果您需要更多信息，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T22:01:22.863

就像@TJHolowaychuk 评论的那样，您真的应该查看手册，并遵循一堆教程。无论如何，我会尽力帮助你一点。

这是一个非常基本的解释。Express 允许您使用子应用程序，因此您可以将应用程序的不同部分放在不同的文件中。它也有自己的路由器。如果您需要在处理路由之前对请求和/或响应做一些事情，您可以创建一个中间件。如果您希望在不同的模块中进行配置，请在其中返回一个函数。

所以 server.js 的一个例子：

```
var  $express = require('express'),
          app = module.exports = $express.createServer(),
       subapp = require('./subapp'),
    configure = require('./configure');

// Each of our own configure returns a function that will be
// called by app.configure
app.configure(configure.all(app));
app.configure('development', configure.devel(app));
app.configure('production', configure.prod(app));

// Use our sub application
app.use(subapp);

// Now listen
app.listen(3030) 
```

subapp.js：

```
var $express = require('express'),
    subapp = module.exports = $express.createServer();

// Add a handler for GET / to our sub-application
subapp.get('/', function (req, res) {
   res.end('Hello world!');
}); 
```

最后 configure.js ：

```
var $express = require('express');

exports.all = function (app) {
   return function () {
      // Global configurations

      app.use($express.bodyParser());
      app.use($express.methodOverride());
      app.set('views', __dirname + '/views');
      app.set('view engine', 'jade');
      app.use($express.static(__dirname + '/public'));
      //...

      // If you want to do something with/on the request/response
      // you can create a middleware
      app.use(function (req, res, next) {
         console.log('caught request %s %s', req.method, req.path);

         // Don't forget the callback
         next();
      });
   };
};

exports.devel = function (app) {
   return function () {
      // Development configurations
   };
};

//... 
```

使用您最喜欢的浏览器，它会显示“Hello world ！`localhost:3030`”，这是我们的请求处理程序。如果你看一下终端，你会看到“caught request GET /”，这是我们的中间件。

您的样式表、客户端 JavaScript 等应该在 /public 中。`app.use(express.static(__dirname + '/public'))`将为这些服务。

假设你有`/public/stylesheets/all.css`，那么在你的玉模板中你可以像这样包含它`link(rel='stylesheet', href='/public/stylesheets/all.css')`

现在，在考虑将某些东西部署到生产环境之前，您必须尝试并了解有关 node 和 express 的更多信息，这些网站可能会对您有所帮助：

*   [如何节点](http://howtonode.org/)
*   [节点图](http://nodetuts.com/)

希望这个小微图对您有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T20:34:07.890

哇，这很令人困惑，您可能想从可以为您生成的应用程序 express(1) 开始**

# php - 如何使用 PHP 反射设置静态属性？

> ID：10541683
> 
> 赞同：4
> 
> 时间：2012-05-10T20:32:04.083
> 
> 标签：php, phpunit

我正在使用 PHPUnit 制作一个模拟类进行测试。

```
class Item extends Object {
  protected static $_cache;
} 
```

我很确定嘲笑会做这样的事情（如果我错了，请纠正我）：

```
class Mock_Item_randomstring extends Item {

} 
```

当我`Item`的缓存被填充时，它会检查传入的对象是否是`Item`. 由于模拟没有明确定义`$_cache`，它无法检查实例类型。

PHP 根本没有真正记录反射函数。有没有办法在事后设置静态变量，这样类就会变成

```
class Mock_Item_randomstring extends Item {
  protected static $_cache;
} 
```

**编辑**

我玩弄了反射方法并遇到了各种各样的问题。这是我感到困惑的一个：

```
$mock = $this->getMock( 'Item', array( '_func' ), array(
  $argument1, $argument2
));

$mock = new ReflectionClass($mock); 

$mock->staticExpects( $this->exactly(2) )->method( '_func' ); 
```

我假设反思复制了整个班级。我收到此错误： `Call to undefined method ReflectionClass::staticExpects()`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T00:44:45.950

你不必。`\Closure::bind`允许您读取和分配私有和受保护的静态属性。请参阅[http://www.php.net/manual/en/closure.bind.php上的示例代码](http://www.php.net/manual/en/closure.bind.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T21:08:30.837

我倾向于对子类中的每个类静态变量使用一个有点讨厌的技巧：

```
class A {
    protected static $cache;
    public static function getCache() {
        return static::$cache;
    }
    public static function setCache($val) {
        static::$cache = & $val; // note the '&'
    }
}
class B extends A {}

A::setCache('A');
B::setCache('B');
A::getCache(); // 'A'
B::getCache(); // 'B' 
```

当然，最好一开始就避免使用静态变量。使用专用缓存对象并在类实例化时注入它。

# hadoop - 将 MapReduce 计数器值设置为某个值

> ID：10541685
> 
> 赞同：1
> 
> 时间：2012-05-10T20:32:12.900
> 
> 标签：hadoop, mapreduce

一开始我没有看到设置 MapReduce 作业的计数器值的简单方法？map/reduce 任务之间的计数器增量原子操作也是？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T02:38:48.790

不确定在开始时设置计数器值是什么意思 - 你的意思是将计数器值初始化为 0 以外的值（你这样做的用例是什么？）。

至于原子操作，计数器是为每个任务单独累积的。当任务完成时，计数器值被提交到全局总数中（只有提交的任务被提交，所以如果你有两个任务在推测运行，只有成功的任务计数器被提交。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T03:32:51.553

在创建计数器时设置值，例如：

```
 private AtomicInteger pages = new AtomicInteger(0);  // total pages fetched 
```

或者`incrCounter()`，如果您想稍后再做，请在循环中使用方法。（第一个更好。）

计数器由与其关联的任务维护，并定期发送到 tasktracker，然后发送到 jobtracker，因此它们可以全局聚合。所以每个 map 任务/reduce 任务都有自己的 counter 变量副本。如果作业成功，则计算所有计数器的总数并在输出摘要中提供。

# wpf - 更改选择时未更新 WPF ComboBox SelectedValue 绑定

> ID：10541687
> 
> 赞同：0
> 
> 时间：2012-05-10T20:32:17.457
> 
> 标签：wpf, combobox, telerik, selectedvalue

我有一个 Telerik RadComboBox 设置如下：

```
<t:RadComboBox Grid.Column="1" Grid.ColumnSpan="5" Grid.Row="3" x:Name="customer" IsReadOnly="True" IsEditable="True"
               ItemsSource="{Binding Path=Customers, Mode=OneWay}" DisplayMemberPath="Name" SelectedValuePath="Id"
               SelectedValue="{Binding Path=CustomerId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
               SelectionChanged="customer_SelectionChanged_1"/> 
```

该组合已正确填充，但如果我单击下拉菜单并从列表中选择一个项目，则该`SelectedValue`属性不会更新。如果我开始输入组合并以这种方式选择一个项目，则该`SelectedValue`属性不会更新。 **但是**，如果我使用鼠标滚轮或箭头键，则`SelectedValue`属性*会*正确更新。

我在后面的代码中添加了`SelectionChanged`事件，因此我可以查看控件的属性（此应用程序使用 MVVM 模式），看起来即使将`SelectedItem`属性*设置*为有效项，该`SelectedValue`属性也为空。如果我使用鼠标滚轮向下滚动到某个项目，那么这两个属性都按照我的预期正确设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T13:09:20.767

事实证明，这是由于我的视图模型`Guid.Empty`在没有选择时默认返回的事实引起的。但是由于列表中没有具有控件`Id`属性的项目`Guid.Empty`会感到困惑。

添加属性：`SelectedIndex="0"`修复此问题。

# android - Adobe Flex Mobile 4.6 - iPad 与 Android 或 BlackBerry 上的元素定位似乎不合适

> ID：10541688
> 
> 赞同：1
> 
> 时间：2012-05-10T20:32:21.123
> 
> 标签：android, ios, apache-flex, blackberry, mobile

如果这是一个愚蠢的问题，请原谅我。我对移动开发有点陌生。

我正在尝试使用 Adob​​e Flex 4.6 测试为 iPad、Android 和 BlackBerry PlayBook 设备构建应用程序。

我刚刚构建了一个真正快速而肮脏的“Hello World！” 应用程序开始。我在页面上放置了一个图像、一个按钮和一个文本框，使它们都居中。我将应用程序 DPI 设置为 160。

现在，当我在 PlayBook 上运行该应用程序时，一切看起来都很好而且很棒。我打算从同事那里得到一台 iPad 进行测试，但我在另一位开发人员的 iPod Touch 上对其进行了测试，该应用程序的扩展性根本就不好。图像和文本框的位置是关闭的，文本框甚至在图像上方一点。

我运行了几次 Flash 模拟器来模拟 Galaxy Tab 10.1，这些元素看起来不错，但由于屏幕尺寸较大而偏离了中心。所以应用程序根本没有扩展。

我在这里错过了什么吗？

编辑：

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
           xmlns:s="library://ns.adobe.com/flex/spark">
<s:Label x="323" y="365" width="377" height="40" fontSize="36" text=""     
    textAlign="center" verticalAlign="middle" id="label1" />
<s:TextInput id="textbox1" x="365" y="227"/>
<s:Button id="button" x="433" y="289" width="159" label="Button"
          click="button_clickHandler(event)"/>
</s:Application> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T21:12:16.370

如果您希望应用中心具有所有分辨率，则不必使用绝对坐标。您需要使用布局。像这样的例子：

```
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark">

    <s:layout>
        <s:VerticalLayout verticalAlign="middle" horizontalAlign="center" />
    </s:layout>
    <s:Label width="377" height="40" fontSize="36" text=""     
             textAlign="center" verticalAlign="middle" id="label1" />
    <s:TextInput id="textbox1" />
    <s:Button id="button" width="159" label="Button"
              click="button_clickHandler(event)"/>
</s:Application> 
```

# ruby - 具有散列且 proc 参数未运行的方法

> ID：10541697
> 
> 赞同：1
> 
> 时间：2012-05-10T20:32:52.153
> 
> 标签：ruby, ruby-1.9

我不确定为什么这个方法没有运行。

编译错误显示：

```
sequence5.rb:1:in `sequence5': wrong number of arguments (2 for 1) (ArgumentError) from sequence5.rb:11:in `<main>' 
```

但是你可以清楚地看到，`sequence5`方法应该有 2 个参数，一个用于`args`散列，另一个用于`b`proc。

我要运行的代码在这里。

```
def sequence5(args, &b)
  n, m, c = args[:n], args[:m], args[:c]
  i = 0
  while i < n
    b.call(i*m+c)
    i += 1
  end
end

p = Proc.new {|x| puts x}
sequence5({:n=>3, :m=>4, :c=>0}, p) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:35:31.433

```
sequence5({:n=>3, :m=>4, :c=>0}, &p) 
```

p 不是参数，它是一个块，Ruby 有不同的语法来传递一个块

# c# - 为什么我的 Silverlight 套接字策略文件不起作用？

> ID：10541699
> 
> 赞同：0
> 
> 时间：2012-05-10T20:33:00.857
> 
> 标签：c#, silverlight, sockets, cross-domain-policy

我有一个使用 SL4 的 silverlight 客户端和一个使用 .NET 4 的 C# 服务器。服务器在 4525 上打开一个端口，客户端打算连接到该端口。现在，如果我可以要求您简单地阅读以下内容，我们可能可以避免我不得不发布任何进一步的代码：

客户端尝试与服务器建立连接，打开策略文件的连接，请求策略文件，并返回策略文件。没有发生的是客户端中的 onConnect 事件。在我实现策略服务器之前，客户端会在 4525 上连接，并执行 onConnect 事件，但由于没有策略服务器而立即失败。现在我已经实现了策略服务器，它似乎永远不会检测到它的交付完成。

以下是传输摘要：

```
Client:
<policy-file-request/>
Server:
<?xml version="1.0" encoding ="utf-8"?>
<access-policy>
<cross-domain-access>
<policy>
<allow-from>
<domain uri="*:4525" />
</allow-from>
<grant-to>
<socket-resource port="4525" protocol="tcp" />
</grant-to>
</policy>
</cross-domain-access>
</access-policy> 
```

有效; 我要回答的唯一问题是：我是否遗漏了我的保单文件中的某些内容，或者我是否需要以任何特定方式结束其向客户的提交，以便我的客户检测其交付？

```
Things of note:
    The Client successfully establishes its connection to the policy server
    The policy server successfully writes the policy back to the client
    The 'real' servers port is successfully opened
    The client 'can' connect to the 'real' server 
```

谢谢大家的时间，我相信有人能提供帮助。

**代码请求** *客户端连接*

不确定这对找到答案是否有任何进一步的影响；但：

```
private static DnsEndPoint IP_END_POINT = new DnsEndPoint("192.168.0.36", 4525, AddressFamily.InterNetwork);

public MainPage()
{
    try
    {
        InitializeComponent();

        socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        SocketAsyncEventArgs connectEventArgs = new SocketAsyncEventArgs();
        connectEventArgs.RemoteEndPoint = IP_END_POINT;
        connectEventArgs.Completed += new EventHandler<SocketAsyncEventArgs>(ConnectionEstablished);
        socket.ConnectAsync(connectEventArgs);
    }
    catch (Exception e)
    {
    }
} 
```

**新开发** *“连接已建立”着火了！*

所以事实证明，如果我想要一分钟左右，我的“ConnectionEstablished”事件最终会触发。然而，我从中得到的并不是那么令人鼓舞。

我最终得到了一个 SocketError 的“AccessDenied”，以及一条消息“试图以一种被其访问权限禁止的方式访问套接字。”，正如可以预料的那样，我的服务器从不接受连接。我知道服务器打开了端口，并且可以接受连接，所以这是相当令人困惑的场景。

再次感谢任何人的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T03:53:00.097

尝试：

```
private static DnsEndPoint IP_END_POINT = new DnsEndPoint("192.168.0.36", 4525, AddressFamily.InterNetwork);

public MainPage()
{
    try
    {
        InitializeComponent();

        socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        SocketAsyncEventArgs connectEventArgs = new SocketAsyncEventArgs();
        connectEventArgs.RemoteEndPoint = IP_END_POINT;
        connectEventArgs.Completed += new EventHandler<SocketAsyncEventArgs>(ConnectionEstablished);

        if(!socket.ConnectAsync(connectEventArgs))
        {
            ConnectionEstablished(/*Insert Args*/); //Handle real time execution
        }
    }
    catch (Exception e)
    {
        //write error somewhere
    }
} 
```

[文档](http://msdn.microsoft.com/en-us/library/bb538102%28v=vs.95%29.aspx)表明如果返回 false ，`ConnectAsync`则“不会引发在 e 参数中传递的 System.Net.Sockets.SocketAsyncEventArgs 对象上的 SocketAsyncEventArgs.Completed 事件。”

此外，请确保您在某处记录异常。可能有一个例外，你只是轻而易举过去。

**更新**：

*   您是否检查了[ClientAccessPolicy.xml](http://msdn.microsoft.com/en-us/library/cc645032%28v=vs.95%29.aspx)文件？您需要将所有“和”字符替换为“。
*   您是否尝试`connectEventArgs.UserToken = socket;`在`ConnectAsync(connectEventArgs)`通话前添加？
*   服务器是否收到请求并发送回复（可能需要在客户端使用[Wireshark](http://www.wireshark.org/download.html)）？
*   虽然调试确实`connectEventArgs.Completed`指向正确的方法？
*   调试时，如果您“跳过”（F10）直到方法返回，会发生什么？是否调用了其他方法？
*   调试时，如果您“跳过”（F10）`socket.ConnectAsync(connectEventArgs)`（但仍在该方法中），Debug>Windows>Threads 窗口中是否还有其他线程？如果切换到另一个线程会发生什么（右键单击线程并选择“切换到线程”或双击线程）？

让我知道结果如何。

# spring - 针对 DB 的 Spring 安全认证

> ID：10541706
> 
> 赞同：0
> 
> 时间：2012-05-10T20:33:42.773
> 
> 标签：spring, spring-security

在 Spring 中，我尝试对 DB 进行身份验证。使用此配置成功：

```
<jdbc-user-service data-source-ref="dataSource"

       users-by-username-query="
          select username,password, enabled 
          from user where username=?" 

       authorities-by-username-query="
          select u.username, ur.authority from user u, user_roles ur 
          where u.id = ur.user_id and u.username =?  " 

    /> 
```

但是我无法登录，直到我在 user_roles 中为每个用户添加一行以至少指定 ROLE_USER...有没有办法在不在 DB 中添加记录的情况下将 ROLE_USER 授予所有用户？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T07:55:13.490

默认情况下，您可以在**authority-by-username-query**中返回该角色。例如，以下查询将在联合的第一部分返回，数据库中存在的**用户/角色**对（您已经拥有的查询）和联合的第二部分将为每个用户返回一对**user/ROLE_USER**因此，即使 user_roles 表中不存在该角色，每个用户现在都将拥有角色**ROLE_USER**

```
select u.username, ur.authority from user u, user_roles ur 
          where u.id = ur.user_id and u.username =?
union
select u.username, 'ROLE_USER' from user u 
```

# ruby - 为什么在 Ubuntu 12.04 - GCC 4.6.3 上 Zookeeper gem 安装失败并出现“变量‘端口’设置但未使用”？

> ID：10541708
> 
> 赞同：2
> 
> 时间：2012-05-10T20:33:49.390
> 
> 标签：ruby, gcc, gem, apache-zookeeper

全新安装 Ubuntu 12.04 上的 Zookeeper 失败。

src/zookeeper.c：在函数“getaddrs”中：src/zookeeper.c:455:13：错误：变量“端口”设置但未使用 [-Werror=unused-but-set-variable]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:55:25.417

原来这是一个已知问题：[https](https://issues.apache.org/jira/browse/ZOOKEEPER-1117) ://issues.apache.org/jira/browse/ZOOKEEPER-1117 。对我来说，短期解决方案是将`apt-get install gcc-4.5`gcc 指向 gcc-4.5 而不是 4.6，之后我就可以毫无问题地安装了。然后我又指向了 4.6 ......最新的是最好的！......好吧

我正在回答我自己的问题，以便可以接受这个问题的答案。虽然，这只是一个短期的解决方案。

# android - android浏览器宽度问题上的Web应用程序

> ID：10541712
> 
> 赞同：0
> 
> 时间：2012-05-10T20:33:57.470
> 
> 标签：android, css, browser, meta-tags

所以到目前为止我只在Android浏览器上遇到过这个问题。基本上我的网站几乎一直运行良好（我还没有在 Dolphin、Opera 或 Skyfire 上看到问题）但偶尔当我从手机主屏幕上的书签重新打开 Android 浏览器时，我的网站会出现水平拉伸，所以现在我只看到左侧的前 2/3。好像浏览器在最小化时只是丢失了 CSS 或元信息。这是我的元标记，我在表格样式中使用了 100% 的宽度。

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="keywords" content="Task, Tasks, Goal, Goals, Habit, Habits, Track, Tracking, Best Habit Tracker"/>
<meta name="description" content="Top Habit Tracker!"/>
<meta name="mobileoptimized" content="0"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/> 
```

此问题似乎仅在大约 30 分钟后单击书签时才会发生。重新打开股票 Android 浏览器。然后，似乎浏览器从其缓存中获取页面，但仍然为 ajax 运行窗口 onload，所以我认为它使用浏览器缓存页面与（也许？）顶部来自 ajax 的 javascript DOM 操作的组合是什么Android股票浏览器唯一存在的问题，在视口之外打破了我的表格宽度。或者也许 DOM 更改与它无关。

如果手机关闭，然后打开，并且点击了书签，股票浏览器从服务器重新加载页面，那么我没有得到问题。如果浏览器被最小化，并且仅在 2 分钟后重新单击了书签，那么也没有问题，因为浏览器只是重新显示自己和最后一页，完全按照它离开时的样子，没有做任何事情。

我一直在考虑某种技巧，我可以在从浏览器缓存中抓取页面的情况下强制从服务器重新加载，或者我想我可以尝试关闭浏览器缓存，但我想知道这样做对图像、CSS、加载时间等的影响。权衡我的选择……欢迎提出想法。

更新：关闭浏览器缓存可能会降低此问题的发生率（不确定？）但绝对不能治愈它。我现在想我可能遇到了与这篇博文中描述的相同的问题：

[http://www.gabrielweinberg.com/blog/2011/03/working-around-androids-screenwidth-bug.html](http://www.gabrielweinberg.com/blog/2011/03/working-around-androids-screenwidth-bug.html)

更新：好的，到目前为止，我没有尝试过在我的 Android 股票浏览器中阻止这个间歇性问题。我打算将我的应用程序的常规使用切换到 Dolphin 一段时间，看看该浏览器是否出现问题。到目前为止我尝试过的是：使用元标记来禁用浏览器缓存（我认为在某种程度上Android浏览器无论如何都会忽略这一点）......改变表格宽度（我可能会以不同的方式再次尝试）......使用此处在评论 14 中发布的解决方案（动态创建 CSS 链接）：[https](https://code.google.com/p/android/issues/detail?id=11961#c14) ://code.google.com/p/android/issues/detail?id= 11961#c14 最后我尝试将日期时间刻度附加到 URL为了减轻缓存，这也没有奏效。

更多有用的信息在这里： http: [//f055.tumblr.com/post/6364300769/viewport-bugs-in-android-browser](http://f055.tumblr.com/post/6364300769/viewport-bugs-in-android-browser)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T22:08:06.350

不确定这是否对你有帮助 - 但这是我为我的移动应用程序所做的

```
 This is the only meta I use...
 <meta content="initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" name="viewport">

 <div class=general>

 All Ur Content in here etc - or next div etc...
 Below the margin-left: 1% and margin-right: 1% formats your div to your width
 So if ur browser is upright or wide - it is always 1% border width and fits screen.
 Don't use any table width=800 or anything - control it with the 1% margins

 </div>

 .general { 
 font-family: Verdana; font-size: 10pt; font-weight: normal;
 position: relative;
 background-color: #fafafa;
 padding: 8px;
 margin-top: 4px;
 margin-left: 1%;
 margin-right: 1%;
 border: 1px solid #000;
 border-radius:5px;
 } 
```

# python - Python urllib 在 HTTP 或 URL 错误上跳过 URL

> ID：10541713
> 
> 赞同：2
> 
> 时间：2012-05-10T20:34:01.353
> 
> 标签：python, lxml, urllib

如果连接超时或无效/404，如何修改我的脚本以跳过 URL？

Python

```
#!/usr/bin/python

#parser.py: Downloads Bibles and parses all data within <article> tags.

__author__      = "Cody Bouche"
__copyright__   = "Copyright 2012 Digital Bible Society"

from BeautifulSoup import BeautifulSoup
import lxml.html as html
import urlparse
import os, sys
import urllib2
import re

print ("downloading and parsing Bibles...")
root = html.parse(open('links.html'))
for link in root.findall('//a'):
    url = link.get('href')
    name = urlparse.urlparse(url).path.split('/')[-1]
    dirname = urlparse.urlparse(url).path.split('.')[-1]
    f = urllib2.urlopen(url)
    s = f.read()
    if (os.path.isdir(dirname) == 0):
        os.mkdir(dirname)
    soup = BeautifulSoup(s)
    articleTag = soup.html.body.article
    converted = str(articleTag)
    full_path = os.path.join(dirname, name)
    open(full_path, 'wb').write(converted)
    print(name)
print("DOWNLOADS COMPLETE!") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:39:49.073

要将超时应用于您的请求，请将`timeout`变量添加到您对`urlopen`. 从[文档](http://docs.python.org/library/urllib2.html#urllib2.urlopen)：

> 可选的 timeout 参数以秒为单位指定连接尝试等阻塞操作的超时时间（如果未指定，将使用全局默认超时设置）。这实际上只适用于 HTTP、HTTPS 和 FTP 连接。

请参阅本指南中有关[如何使用 urllib2 处理异常](http://www.voidspace.org.uk/python/articles/urllib2.shtml#handling-exceptions)的部分。实际上，我发现整个指南非常有用。

`request timeout`异常代码`408`是。总结一下，如果你要处理超时异常，你会：

```
try:
    response = urlopen(req, 3) # 3 seconds
except URLError, e:
    if hasattr(e, 'code'):
        if e.code==408:
            print 'Timeout ', e.code
        if e.code==404:
            print 'File Not Found ', e.code
        # etc etc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:37:52.547

尝试将您的 urlopen 行放在 try catch 语句下。看看这个：

docs.python.org/tutorial/errors.html 第 8.3 节

查看不同的异常，当您遇到一个时，只需使用语句 continue 重新启动循环

# php - 通过链接 PHP/Joomla 清除变量

> ID：10541714
> 
> 赞同：0
> 
> 时间：2012-05-10T20:34:03.070
> 
> 标签：php, joomla

我从组件中调用一个变量来获取用户位置：

JRequest::getInt('CS_SESSION_LOCATIONID', null, 'COOKIE');

唯一的麻烦是，在某些情况下，我想从链接重置值。任何人都知道如何清除 CS_SESSION_LOCATIONID ？

我尝试过： clear 和其他各种方法，但似乎找不到方法。我基本上希望创建一个链接，该链接将重定向到索引页面并将用户选择的位置重新设置为空。

任何建议都会很棒。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T23:14:44.650

您是否尝试取消设置（$variable）变量？

# c# - 尝试从 Team City Sharp 服务器获取开始日期

> ID：10541726
> 
> 赞同：2
> 
> 时间：2012-05-10T20:34:48.593
> 
> 标签：c#, json, asp.net-mvc-3, teamcity

这是我获取到 TeamCitySharp 服务器的 Json 连接的代码。本地主机是我的 Json 连接。现在，我试图在我转到本地主机时显示开始日期，但它显示为空。有想法该怎么解决这个吗？

```
 HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://localhost:81/Status/AllStatuses");
            var response = request.GetResponse();
            var reader = new StreamReader(response.GetResponseStream());
            var responseString = reader.ReadToEnd();

            var serializer = new JavaScriptSerializer();
            serializer.RegisterConverters((new[] { new DynamicJsonConverter() }));
            dynamic obj = serializer.Deserialize(responseString, typeof(object));

            foreach (var objects in obj)
            {       

                foreach (var project in client.Projects)
                {

                    foreach (var build in project.Builds)
                    {
                        bs.date = project.ProjectStartDate.ToString(); 
```

这是在单独项目中的另一个控制器上调用 Jsonresult。

```
public JsonResult AllStatuses() //from the json called in the _client view
    {
        var buildStatuses = new List<BuildStatus>();

        var projects = Client.AllProjects();

        //var projects = storeDB.Projects.Include("Builds").ToList();
        //var buildStatuses = new List<BuildStatus>();

        foreach (var project in projects)
        {
            try 
            {
                var buildConfigs = Client.BuildConfigsByProjectId(project.Id);

                foreach (var buildConfig in buildConfigs)
                {
                    var build = Client.LastBuildByBuildConfigId(buildConfig.Id);

                    var b = new BuildStatus();
                    b.id = buildConfig.Id.ToString();
                    if (b.date != null)
                        b.date = b.date.ToString();
                    if (b.status != null)
                        b.status = build.Status.ToString();
                    buildStatuses.Add(b);
                }
            } catch { }
        }
        //var query = buildStatuses.OrderBy(x => x.status); // Create a sorted list from Error - Unknown               

        return Json(buildStatuses, JsonRequestBehavior.AllowGet);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-20T21:47:04.663

我不确定这个问题是否仍然与提出问题的人相关。我会为可能遇到相同问题的其他人回答。

有一个 FluentTc 库，可通过其 REST API 轻松访问 TeamCity。有一种方法可以检索带有开始和/或结束日期的构建：

`IList builds = new RemoteTc().Connect(h => h.ToHost("teamcity.codebetter.com").AsGuest()) .GetBuilds(b => b.BuildConfiguration(c => c.Id("FluentTc_FluentTcDevelop")) .Branch(r => r.Branched()), i => i.IncludeStatusText().IncludeStartDate().IncludeFinishDate());`

 `该库以 nuget 包的形式提供：[https ://www.nuget.org/packages/fluenttc](https://www.nuget.org/packages/fluenttc)`

# java - 如何使用 JavaFX 2 绘制时钟？

> ID：10541738
> 
> 赞同：5
> 
> 时间：2012-05-10T20:35:25.287
> 
> 标签：java, javafx-2

给定一小时一分钟，我想画一个类似的时钟。

我能够`Group`用 a创建 a `Circle`，但我不知道手用哪个类以及如何放置和旋转它们。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-10T21:12:28.277

1.  [将具有不同笔画](http://docs.oracle.com/javafx/2/api/javafx/scene/shape/Shape.html#setStroke%28javafx.scene.paint.Paint%29)和长度的3[行](http://docs.oracle.com/javafx/2/api/javafx/scene/shape/Line.html)（小时、分钟、秒）添加到您的组中。
2.  将每条线的一端放在圆圈的中心，每条线的另一端指向 12 点钟方向。
3.  创建一个每秒触发一个关键帧的[时间线。](http://docs.oracle.com/javafx/2/api/javafx/animation/Timeline.html)
4.  在关键帧中：
    *   根据当前[时间](http://docs.oracle.com/javase/7/docs/api/java/util/GregorianCalendar.html)计算指针的旋转度数。
    *   [转动](http://docs.oracle.com/javafx/2/api/javafx/scene/transform/Rotate.html)双手所需的量。
5.  将时间线设置为[无限](http://docs.oracle.com/javafx/2/api/javafx/animation/Animation.html#INDEFINITE)[循环](http://docs.oracle.com/javafx/2/api/javafx/animation/Animation.html#setCycleCount%28int%29) 。
6.  将您的组放在场景中并将场景添加到舞台。
7.  [播放](http://docs.oracle.com/javafx/2/api/javafx/animation/Animation.html#play%28%29)您的时间线。

我创建了一个实现上述原则的[示例应用程序。](https://gist.github.com/2658491)

![在此处输入图像描述](../Images/0573d97d2fe90cbbbe80ee7b91502140.png)

*更新*

为了回应对示例应用程序中使用的编码风格的[批评](http://blog.crisp.se/2012/08/09/perlundholm/an-analog-clock-in-javafx)，我创建了一个[重构的示例应用程序](https://gist.github.com/3388637#comments)，它使用了更实用的编码风格。

此外，[jfxtras 项目](http://jfxtras.org/)有一个 AnalogueClock 控件。以下是如何使用[jfxtras](https://gist.github.com/2928302)时钟的要点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-11T08:46:29.163

Netbeans 7.1.2 与示例应用程序捆绑在一起。在 JavaFX 部分有一个**StopWatch**示例应用程序。看看它，它可以给你一个很好的线索。

# javascript - Google 在我的位置上映射 api v3 标准标记

> ID：10541741
> 
> 赞同：0
> 
> 时间：2012-05-10T20:35:29.420
> 
> 标签：javascript, google-maps, google-maps-markers

当我在当前位置打开我的谷歌地图页面时，我想设置一个标记。当我在文本字段中输入地址时，需要更改此标记。我不知道如何在我的位置上添加标准标记并在文本字段中输入地址时更新它。

我已经有了当前位置的经纬度。

```
<script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"
  type="text/javascript"></script>

<style type="text/css">
  body {
    font-family: sans-serif;
    font-size: 14px;
  }
  #map_canvas {
    height: 400px;
    width: 600px;
    margin-top: 0.6em;
  }
</style>

<script type="text/javascript">
var gl;
var ownlat;
var ownlng;

function displayPosition(position) 
{
    ownlat = position.coords.latitude;
    ownlng = position.coords.longitude;
    var p = document.getElementById("p");
    p.innerHTML = "Own Latitude = " + ownlat + " <br/>" +
    "Own Longitude = " + ownlng;
}

function displayError(positionError) 
{
  alert("error " + positionError.code);
}

try 
{
    if (typeof navigator.geolocation === 'undefined')
    {
        gl = google.gears.factory.create('beta.geolocation');
    } else {
        gl = navigator.geolocation;
    }
} catch(e) {}

if (gl) 
{
    gl.getCurrentPosition(displayPosition, displayError);
} else 
{
    alert("Geolocation services are not supported by your web browser.");
} 

  function initialize() {
    var mapOptions = {
      center: new google.maps.LatLng(-33.8688, 151.2195),
      zoom: 13,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var map = new google.maps.Map(document.getElementById('map_canvas'),
      mapOptions);

    var input = document.getElementById('searchTextField');
    var autocomplete = new google.maps.places.Autocomplete(input);

    autocomplete.bindTo('bounds', map);

    var infowindow = new google.maps.InfoWindow();
    var marker = new google.maps.Marker({
      map: map
    });

    google.maps.event.addListener(autocomplete, 'place_changed', function() {
      infowindow.close();
      var place = autocomplete.getPlace();
      if (place.geometry.viewport) {
        map.fitBounds(place.geometry.viewport);
      } else {
        map.setCenter(place.geometry.location);
        map.setZoom(17);  // Why 17? Because it looks good.
      }   

      var image = new google.maps.MarkerImage(
          place.icon,
          new google.maps.Size(71, 71),
          new google.maps.Point(0, 0),
          new google.maps.Point(17, 34),
          new google.maps.Size(35, 35));
      marker.setIcon(image);
      marker.setPosition(place.geometry.location);

      var address = '';
      if (place.address_components) {
        address = [(place.address_components[0] &&
                    place.address_components[0].short_name || ''),
                   (place.address_components[1] &&
                    place.address_components[1].short_name || ''),
                   (place.address_components[2] &&
                    place.address_components[2].short_name || '')
                  ].join(' ');
      }

      infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
      infowindow.open(map, marker);

            //GET LAT & LONG
    var lat = marker.getPosition().lat();
    var long = marker.getPosition().lng();

    document.getElementById('lat').innerHTML = lat;
    document.getElementById('long').innerHTML = long;
    });

    // Sets a listener on a radio button to change the filter type on Places
    // Autocomplete.
    function setupClickListener(id, types) {
      var radioButton = document.getElementById(id);
      google.maps.event.addDomListener(radioButton, 'click', function() {
        autocomplete.setTypes(types);
      });
    }

    setupClickListener('changetype-all', []);
    setupClickListener('changetype-establishment', ['establishment']);
    setupClickListener('changetype-geocode', ['geocode']);
  }
  google.maps.event.addDomListener(window, 'load', initialize);     
</script> 
```

# javascript - IE 浏览器上的 Image.width

> ID：10541744
> 
> 赞同：0
> 
> 时间：2012-05-10T20:35:41.387
> 
> 标签：javascript

我有以下 javascript（在 blogspot 博客中调整图像大小）：

```
 var imageTags = document.getElementsByTagName('img');
  for(i = 0 ; i < imageTags.length; i++){
    if( imageTags[i].src.indexOf('/s400/', 0)>-1 ) {
      if(imageTags[i].style.width=='400px' || imageTags[i].width==400) {
      imageTags[i].style.width='556px';
        imageTags[i].style.height='368px';
      } else {
        imageTags[i].style.width='368px';
        imageTags[i].style.height='556px';
      }
      imageTags[i].src=imageTags[i].src.replace('/s400/', '/s556/');

    }
  } 
```

它在 Firefox 和 Chrome 上完美运行，但在 IE（经过测试的 IE9）上，它似乎总是进入第二个分支，好像`imageTags[i].width==400`总是被评估为 false。如何修复 IE 浏览器？

编辑：正如建议的那样，我暂时添加了一个警报来显示图像的宽度，而在 IE9 上它是.... 416。看起来 IE 为 html 的宽度添加了边距。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:55:22.663

请运行它并告诉你得到什么 - 目前你调整大小然后加载新图像

```
var imageTags = document.getElementsByTagName('img');
for(var i=0,n=imageTags.length,img,src,w,h,newImg; i<n; i++) {
  img =  imageTags[i];
  src = img.src;
  if(src.indexOf('/s400/', 0)==-1 ) continue;
  alert(img.width);
  if(img.width==400) {
    w=556;
    h=368;
  } else {
    w=368;
    h=556;
  }
  newImg = document.createElement("img");
  newImg.onload=function() { this.width=w; this.height=h}
  newImg.src=src.replace('/s400/', '/s556/')
  img.parentNode.replaceChild(newImg,img);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:36:53.867

尝试`imageTags[i].offsetWidth==400`而不是`imageTags[i].width==400`
我建议它，因为 .width 属性仅获取`width`标签中定义的内容，而`.offsetWidth`获取实际宽度

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T07:06:17.027

正如建议的那样，我检查了 IE 报告的宽度是 416 而不是 400（可能添加了边距？）。所以我只是添加了一个明显的 hack 来检查 400 和 416。

# wpf - 内影问题

> ID：10541748
> 
> 赞同：1
> 
> 时间：2012-05-10T20:36:00.040
> 
> 标签：wpf, silverlight, xaml

我有这段代码来实现**内部阴影。**

不知何故，它包括`TextBlock`等等。我不需要它。我*只需要 INNER SHADOW*。

它靠近[此处](https://stackoverflow.com/questions/2831062/wpf-drop-shadow)描述的问题，但我有内部阴影......

所以我想保留内部阴影，但不要将其应用于字体等。

请帮我修复它。谢谢！

```
 <DataTemplate x:Key="RSSItemTemplate">
            <Border Background="LightGray" BorderBrush="DarkGray" Margin="0,0,0,5" BorderThickness="1" ClipToBounds="True">
                <Border Background="Transparent" BorderBrush="Black" BorderThickness="1" Margin="-2">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="0" BlurRadius="5" />
                    </Border.Effect>
                    <Grid>
                        <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <Image>
                            </Image>
                            <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                    <TextBlock Text="{Binding Path=PublishDate}" Margin="0,0,5,0" />
                                    <TextBlock Text="{Binding Path=Title}"  TextWrapping="Wrap" />
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                    <TextBlock Text="{Binding Path=Description}" Margin="0,5,0,0" TextWrapping="Wrap" />
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Border>
            </Border>
        </DataTemplate>
    </UserControl.Resources>

    <Grid>
        <ItemsControl x:Name="MainRoot"   ItemTemplate="{StaticResource RSSItemTemplate}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
    </Grid> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:55:30.497

尝试像这样修改它：

```
<DataTemplate x:Key="RSSItemTemplate">
        <Border Background="LightGray" BorderBrush="DarkGray" Margin="0,0,0,5" BorderThickness="1" ClipToBounds="True">
                <Grid>
                    <Border Background="Transparent" BorderBrush="Black" BorderThickness="1" Margin="-2">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="0" BlurRadius="5" />
                        </Border.Effect>
                    </Border>
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <Image>
                        </Image>
                        <StackPanel Orientation="Vertical" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <TextBlock Text="{Binding Path=PublishDate}" Margin="0,0,5,0" />
                                <TextBlock Text="{Binding Path=Title}"  TextWrapping="Wrap" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                                <TextBlock Text="{Binding Path=Description}" Margin="0,5,0,0" TextWrapping="Wrap" />
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Grid>
        </Border>
    </DataTemplate>
    <!-- the rest of the code here --> 
```

它似乎像您描述的那样工作，具有边框的内部阴影但不影响内部的元素。

# ruby - 如何对 ASCII 字符进行 URL 编码？

> ID：10541757
> 
> 赞同：7
> 
> 时间：2012-05-10T20:36:30.107
> 
> 标签：ruby, ruby-on-rails-3, jruby, url-encoding

我正在使用 Ruby 提取文件的 URL 以下载和下载它。文件名包含 utf8 字符，例如：

```
www.domain.com/.../ÖÇÄÜ360ÓïÒôÖúÀí.txt 
```

尝试下载上述 URL 时，失败。使用`URI::escape`会产生一个也不起作用的 URI：

```
www.domain.com/.../%C3%96%C3%87%C3%84%C3%9C360%C3%93%C3%AF%C3%92%C3%B4%C3%96%C3%BA%C3%80%C3%AD.txt 
```

但如果我遵循[URL Encoding Reference](http://www.w3schools.com/tags/ref_urlencode.asp)，它可以工作：

```
www.domain.com/.../%D6%C7%C4%DC360%D3%EF%D2%F4%D6%FA%C0%ED.txt 
```

我试图在 Ruby 中搜索一个执行完全相同编码的函数，但我找不到任何函数。在我尝试编写一个实现上面链接中的表的函数之前，我想问一下是否有人知道任何现有的库可以做到这一点。如果我决定这样做，我应该编码什么范围的字符，显然，不是所有的。

我正在使用带有 RUBY_VERSION => "1.8.7" 的 JRuby 1.6.2

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-10T22:42:12.950

哦，字符编码的乐趣！

这里发生的事情如下。Ruby 在内部将您提取的字符串存储为字节序列，即文件名的 utf-8 编码。当您调用`URI.escape`它时，这些字节以`%xy`格式进行转义，并且生成的字符串现在仅由 ASCII 范围内的字节组成，用作 url。

然而，接收服务器正在解释这些字节（在将它们从`%xy`表单中转义之后），就好像它们采用不同的编码一样，在这种情况下是[ISO-8859-1](http://en.wikipedia.org/wiki/ISO/IEC_8859-1)，因此它提供的结果文件名与它所拥有的任何内容都不匹配.

这是一个使用 Ruby 1.9 的演示，因为它对编码有更好的支持。

```
1.9.3-p194 :003 > f
 => "ÖÇÄÜ360ÓïÒôÖúÀí.txt" 
1.9.3-p194 :004 > f.encoding
 => #<Encoding:UTF-8> 
1.9.3-p194 :005 > URI.escape f
 => "%C3%96%C3%87%C3%84%C3%9C360%C3%93%C3%AF%C3%92%C3%B4%C3%96%C3%BA%C3%80%C3%AD.txt" 
1.9.3-p194 :006 > g = f.encode 'iso-8859-1'
 => "\xD6\xC7\xC4\xDC360\xD3\xEF\xD2\xF4\xD6\xFA\xC0\xED.txt" 
1.9.3-p194 :007 > g.encoding
 => #<Encoding:ISO-8859-1> 
1.9.3-p194 :008 > URI.escape g
 => "%D6%C7%C4%DC360%D3%EF%D2%F4%D6%FA%C0%ED.txt" 
```

*因此，这种情况下*的解决方案是在转义字符串之前将其编码为 ISO-8859-1。在 Ruby 1.9 中，您可以像上面那样执行此操作，在早期版本中，您可以使用 Iconv（我假设 JRuby 包含 Iconv，我实际上对 JRuby 并不熟悉）：

```
1.8.7 :001 > f
 => "\303\226\303\207\303\204\303\234360\303\223\303\257\303\222\303\264\303\226\303\272\303\200\303\255.txt" 
1.8.7 :005 > g = Iconv.conv('iso-8859-1', 'utf-8', f)
 => "\326\307\304\334360\323\357\322\364\326\372\300\355.txt" 
1.8.7 :006 > URI.escape f
 => "%C3%96%C3%87%C3%84%C3%9C360%C3%93%C3%AF%C3%92%C3%B4%C3%96%C3%BA%C3%80%C3%AD.txt" 
1.8.7 :007 > URI.escape g
 => "%D6%C7%C4%DC360%D3%EF%D2%F4%D6%FA%C0%ED.txt" 
```

请注意，通常您不能依赖使用任何特定编码的服务器。它*应该*使用 utf-8，但在这种情况下显然不是。

# python - 我可以在 python 中为 tempfile.NamedTemporaryFile 设置 umask 吗？

> ID：10541760
> 
> 赞同：18
> 
> 时间：2012-05-10T20:36:49.520
> 
> 标签：python, file, permissions

在 Python 中（在 2.7 及以下版本中尝试过），它看起来像使用创建的文件`tempfile.NamedTemporaryFile`似乎不遵守 umask 指令：

```
import os, tempfile
os.umask(022)
f1 = open ("goodfile", "w")
f2 = tempfile.NamedTemporaryFile(dir='.')
f2.name

Out[33]: '/Users/foo/tmp4zK9Fe'

ls -l
-rw-------  1 foo  foo  0 May 10 13:29 /Users/foo/tmp4zK9Fe
-rw-r--r--  1 foo  foo  0 May 10 13:28 /Users/foo/goodfile 
```

知道为什么`NamedTemporaryFile`不拿起umask吗？在文件创建期间有没有办法做到这一点？

我总是可以用 os.chmod() 来解决这个问题，但我希望在文件创建过程中做正确的事情。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-10T20:53:44.637

这是一项安全功能。`NamedTemporaryFile`总是使用 mode 创建`0600`，硬编码在第[`tempfile.py`235 行](http://hg.python.org/cpython/file/63bde882e311/Lib/tempfile.py#l235)，因为它是您的进程私有的，直到您使用`chmod`. 没有构造函数参数可以更改此行为。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2017-05-23T09:15:20.583

如果它可能对某人有所帮助，我想做或多或少相同的事情，这是我使用的代码：

```
import os
from tempfile import NamedTemporaryFile

def UmaskNamedTemporaryFile(*args, **kargs):
    fdesc = NamedTemporaryFile(*args, **kargs)
    # we need to set umask to get its current value. As noted
    # by Florian Brucker (comment), this is a potential security
    # issue, as it affects all the threads. Considering that it is
    # less a problem to create a file with permissions 000 than 666,
    # we use 666 as the umask temporary value.
    umask = os.umask(0o666)
    os.umask(umask)
    os.chmod(fdesc.name, 0o666 & ~umask)
    return fdesc 
```

# java - 如何访问位于源文件夹中的 Jar 文件？

> ID：10541765
> 
> 赞同：2
> 
> 时间：2012-05-10T20:37:15.347
> 
> 标签：java, jdbc, classpath, h2

在我的 Java 项目中，我使用的是 H2 内存数据库，当我初始化我的应用程序时，我必须为此加载 JDBC 驱动程序。我想要/需要动态加载 H2 .jar 文件，所以我执行以下操作：

```
String classname = "org.h2.Driver";
URL u = new URL("jar:file:libs/h2.jar!/");
URLClassLoader ucl = new URLClassLoader(new URL[] { u });
Driver d = (Driver) Class.forName(classname, true, ucl).newInstance();
DriverManager.registerDriver(new DriverShim(d)); 
```

当我将 H2 .jar 文件放入我的 Java 源代码文件夹之外的“libs”文件夹中时（也就是说，在 Eclipse 中，这个“libs”目录与“src”文件夹处于同一级别），那么这种方法可以正常工作. 但是，不幸的是，我必须将此 H2 .jar 文件放入源代码文件夹树内的文件夹中，但位于主类文件夹下方。

例如，我的 Java 包结构在 Eclipse 中如下所示：

```
<project>/src/my/app/MyApp.java              // main class of my application
<project>/src/my/app/sub/package/h2.jar      // how to access this?
<project>/libs/h2.jar                        // loading from here works 
```

我知道这很愚蠢，但不幸的是我必须使用这种奇怪的设置。但我不知道的是：如何编辑我的 Java 代码（如上所列）以使用此设置？

编辑：这也必须在 Eclipse 之外工作，因此将 JAR 文件添加到 Eclipse 中的 Java 构建路径对我来说是没有选择的。

EDIT2：我已经尝试加载“jar：file：my/app/sub/package/h2.jar！/”，但这对我不起作用。

提前感谢所有有用的想法！

亲切的问候，马蒂亚斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T21:07:24.030

在一些引用 JAR 内文件的框架中，可以使用`classpath:`前缀来完成。~~我怀疑 URLClassLoader 本身是否支持它，但值得一试（例如`classpath:/my/app/sub/package/h2.jar`）。~~但由于这不适用于 URLClassLoader，这里有其他方法：

一种方法是编写您自己的 ClassLoader，它从类路径读取 JAR 文件（使用 getResourceAsStream），将其解压缩（使用 ZipInputStream）到内存（例如字节数组的映射）并从那里加载类。

另一种稍微简单的方法是从类路径中读取 JAR 文件并将其写入临时文件。然后，您可以使用普通的 URLClassLoader 从中加载类。这样做的缺点是必须将文件写入文件，并且在 JVM 退出之前可能无法删除该文件（[除非使用 Java 7](http://openjdk.java.net/projects/jdk7/features/#f584)或更高版本）。

我[在一个项目中](http://jumi.fi/)使用第二种方法（复制到临时文件） ，尽管我使用它来[启动外部进程](https://github.com/orfjackal/jumi/blob/0618c276cd66df6dbdb9c63bb888020781046119/jumi-launcher/src/main/java/fi/jumi/launcher/JumiLauncher.java#L100-102)。我很想知道你为什么有这样的要求。如果只是将整个应用程序放在一个 JAR 中，那么有许多更简单的方法可以实现这一点（Maven Assembly Plugin、Maven Shade Plugin、Jar Jar Links、One-JAR 等等）。

* * *

> 不，这不是作业，而是一个在线构建系统，它使用我在 my/app/* 下的类和其他几个类（不是来自我的）来自动构建整个解决方案。无论如何，我无法向您提供有关该系统内部结构的更多详细信息，因为我不了解它们。如前所述，我只需要忍受它，这就是我在这里问的原因......

听起来你在[WTF](http://thedailywtf.com/)环境中工作（它有名字吗？），所以这里有一些方法可以开始破解它：

了解有关您的环境的更多信息，尤其是以下绝对文件路径：保存源文件的目录、保存生成的 .class 文件的目录以及程序运行时的当前工作目录。

如果您可以在运行时获得程序打印的任何类型的输出，则可以在应用程序中放入一些调试代码，在其中使用[File.listFiles()](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#listFiles%28%29)来爬取机器的目录树。如果您只能从编译时发生的事情中获取输出，则可以通过创建自己的[注释处理器](http://docs.oracle.com/javase/6/docs/technotes/guides/apt/index.html)（apt 是 javac 自 Java 6 以来的一部分）在编译期间执行您自己的代码，尽管我不确定注释处理器是否必须先单独编译。

可以从系统属性中读取工作目录，并且可以从`user.dir`系统属性中获取类文件的位置`java.class.path`（除非使用自定义类加载器）。无法保证源目录中的 JAR 文件会被复制到类路径中，因此您可能需要四处查看。

然后，当您知道 JAR 文件的文件路径时，您可以获取它的 URL，然后您可以使用`new File("path/to/h2.jar").toURI().toURL()`它传递给 URLClassLoader。

如果没有其他工作，请上传库的源代码并将它们与您的项目一起编译。

从长远来看，尝试将 WTF 构建环境替换为使用标准构建工具（如 Maven）和通用 CI 服务器（如 Jenkins）的构建环境。项目有很多库依赖项是正常的，所以你不需要绕过构建环境来使用它们。

# blackberry - 黑莓中的推送通知

> ID：10541767
> 
> 赞同：0
> 
> 时间：2012-05-10T20:37:22.010
> 
> 标签：blackberry, blackberry-push

我开发了一个 Blackberry Native 应用程序，现在客户端即使在设备关闭时也需要通知。经过几次搜索，Blackberry Push Service 似乎是要走的路，但我有一些担忧：

1.  黑莓推送服务是免费服务还是付费服务？
2.  客户端的库要求是什么？我需要额外的库还是它只适用于 Blackberry SDK？
3.  通知是如何发送的？我需要为此构建一个额外的应用程序吗？客户端有 IIS 服务器，所以我想知道是否可以在 .NET 中构建这样的应用程序。
4.  有人试过[Urban Airship](http://urbanairship.com/)吗？似乎是完成任务的一种更简单的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T12:55:19.327

1.  RIM 根据您通过其服务器推送的数据量以及交付确认对推送服务收费。如果您的客户群很小，并且推送数据要求适中，他们不会收取任何费用。

2.  当您注册启动推送服务时，他们会向您发送示例代码，但没有额外的库要求。

3.  推送通知是发布到 RIM 'web' 服务器的 XML 文档。您必须向客户端提供许多服务以进行注册和推送控制。执行此操作的标准方法还是使用 RIM 和客户端设备与之通信的“网络”服务器。当您注册时，RIM 将向您发送一个设计用于在 Apache TomCat 中运行的示例服务器模块，但我（和其他人）已经在 Linux、Apache、MySQL 和 PHP 服务器 (LAMPS) 上复制了必要的功能。我看不出有任何理由不能在 IIS 上实现它，但我没有使用 IIS 的经验。（我将 'web' 放在引号中，因为此服务器可以但不必提供传统意义上的任何网页。推送服务使用 HTTPS 作为传输协议。）

4.  我什至不知道那是什么。

如果您的客户正在运行 BES，那么他们已经拥有了推送给客户并获得交付确认所需的一切，而无需任何额外费用。JP Mens 发表了一篇关于使用 BES MDS 服务器将数据从 LAMPS 机器推送到客户端的[非常好的文章。](http://jpmens.net/pages/real-world-blackberry-mds-push-applications-an-extensible-framework/)

# c - 给定数组的位向量实现

> ID：10541768
> 
> 赞同：1
> 
> 时间：2012-05-10T20:37:29.217
> 
> 标签：c, arrays, vector, bits

我正在尝试从给定的数组创建一个位向量集。不知道如何启动它。例如给定数组：`int rows[] = {1, 2, 5}`我需要创建一个函数`unsigned short MakeBitVector(int values[], int nValues)`您可以假设数组中元素的范围是 1-9。这是我到目前为止所拥有的：

```
unsigned short MakeBitVector(int values[], int nValues)
{
  (55)unsigned short int set = calloc(nValues, sizeof(unsigned short));
  for(int i = 0; i < nValues; i++){
    (57)set[i] = values[i];
  }
  return set;
} 
```

我不断收到警告和错误：

bits.c:55：警告：初始化从没有强制转换的指针生成整数

bits.c:57：错误：下标值既不是数组也不是指针

有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T20:42:09.713

你绝对需要你`set`成为一个指针：

```
unsigned short int* set = calloc(nValues, sizeof(unsigned short)); 
```

而且您还必须将函数的返回类型更改为指针。

编辑：如果您想将所有内容打包到一个 int 中，您可以以更简单的方式继续：

```
unsigned short MakeBitVector(int values[], int nValues)
{
    unsigned short int set = 0;
    for (int i = 0; i < nValues; i++)
        set |= 1 << values[i];
    return set;
} 
```

您不需要分配单个 int，返回副本就可以了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:56:48.283

我认为您根本不需要动态分配；`calloc`只是令人困惑的事情。此外，您将需要在您的代码当前不存在的某个位置上操作单个位。那这个呢：

```
unsigned short MakeBitVector(int values[], int nValues) {
  unsigned short int set = 0;
  for(int i = 0; i < nValues; i++){
    set |= 1 << values[i];
  }
  return set;
} 
```

显然，如果输入包含索引> = 16，则此输出是未定义的，但是您说这不应该是问题（无论如何您都可以轻松地将其扩展到32）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:42:00.460

`set`不是指针。改为将其更改为指针。您还需要返回一个指针。

# javascript - 将字符串数组转换为整数数组

> ID：10541770
> 
> 赞同：33
> 
> 时间：2012-05-10T20:37:34.583
> 
> 标签：javascript, jquery

我创建了一个数组：

```
var endFlowArray = new Array;
for (var endIndex in flowEnd) { // <- this is just some numbers 
    for (var i in dateflow) { // <- same thing 
        var check = $.inArray(flowEnd[endIndex], dateflow[i]);
        if (check >= 0) {
            endFlowArray.push(i);
            flowEnd[endIndex] = null;
        }
    }
} 
```

如何转换字符串数组：

```
["286", "712", "1058"] 
```

到整数数组，如：

```
[286, 712, 1058] 
```

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2014-02-08T09:53:06.443

```
var arrayOfNumbers = arrayOfStrings.map(Number); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-10T20:43:51.723

控制台中的字符串通过用引号括起来来表示。因此，我们可以假设它`i`是一个字符串。将其转换为整数，它将不再是字符串，也不再有那些引号。

```
endFlowArray.push(+i); 
```

您的“数字”实际上是字符串，`flowEnd`而`dateFlow`不是数字。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-05-31T11:59:57.910

要转换整个数组的数据类型，我们可以使用`map()`：

```
let numberArray = stringArray.map(Number) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-29T10:34:56.543

试试这个：

```
let numberArray = stringArray.map(el=>parseInt(el)) 
```

# java - 为独立应用程序初始化 log4j

> ID：10541778
> 
> 赞同：7
> 
> 时间：2012-05-10T20:38:08.310
> 
> 标签：java, logging, log4j

我是 log4j 的新手。这就是我所拥有的。我在一个独立的 JAVA 应用程序中有大约 20 个不同包中的文件。我正在尝试使用和编写日志文件。

以下是我的类路径中的**log4j.properties 文件：**

```
log4j.appender.R = org.apache.log4j.DailyRollingFileAppender
log4j.appender.R.File = /ParentFolder/ChildFolder/application.log
log4j.appender.R.Append = true
log4j.appender.R.DatePattern = '.'yyy-MM-dd
log4j.appender.R.layout = org.apache.log4j.PatternLayout
log4j.appender.R.layout.ConversionPattern = %d{yyyy-MM-dd HH:mm:ss} %c{1} [%p] %m%n 
```

**以下是在我的主要方法**中初始化日志记录的代码****

 **```
final String LOG_FILE = "C:/eclipse_workspace/lib/log4j.properties"; 
      Properties logProp = new Properties();      
      try     
      {      
       logProp.load(new FileInputStream (LOG_FILE));  
            PropertyConfigurator.configure(logProperties);      
            logger.info("Logging enabled");    
      }     
      catch(IOException e)                
      {       
     System.out.println("Logging not enabled");       
                 } 
```

**在应用程序的每个 java 类中，我都有以下代码**

```
import org.apache.log4j.*;

private static final Logger logger = Logger.getLogger(TheActualClassName.class); 
```

但是**当我运行应用程序时收到以下警告消息**。

log4j:WARN 找不到记录器 (com.xxx.myApp.MainProgram.MyFileName) 的附加程序。log4j:WARN 请正确初始化 log4j 系统。log4j:WARN 有关详细信息，请参阅[http://logging.apache.org/log4j/1.2/faq.html#noconfig](http://logging.apache.org/log4j/1.2/faq.html#noconfig)。

我究竟做错了什么？？未生成日志文件“application.log”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T20:43:17.670

可能需要以下行：

```
# Set root logger level to INFO and appender to R.
log4j.rootLogger=INFO, R 
```

根记录器始终可用并且没有名称。

从 1.2.7 版本开始，log4j（带有`LogManager`类）首先在类路径中查找`log4j.xml`。如果`log4j.xml`不存在，则 log4j（带有`LogManager`类）`log4j.properties`在类路径中查找。

*   [默认初始化过程](http://logging.apache.org/log4j/1.2/manual.html#defaultInit)
*   [日志管理器外部参照](http://logging.apache.org/log4j/1.2/xref/org/apache/log4j/LogManager.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T20:43:10.407

如果您要使用名为 的文件`log4j.properties`，*并且*它位于应用程序的类路径中，则甚至无需调用`PropertyConfiguration`或`DOMConfigurator`- [log4j 将在首次初始化时自动执行此操作](http://logging.apache.org/log4j/1.2/manual.html#defaultInit)（当您首次加载记录器时）。

错误消息似乎表明您的配置没有被加载。

将 VM 参数添加`-Dlog4j.debug`到您的应用程序，让 log4j 在启动时吐出一大堆信息，其中包括它尝试加载的文件以及它在配置中找到的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-09T14:46:16.773

Raghu，如果您使用独立配置来配置 log4j 属性，那么可以使用 BasicConfigurator.configure() 方法来解决您的附加程序问题。**

# php - 地理位置和 php 和数据库

> ID：10541780
> 
> 赞同：0
> 
> 时间：2012-05-10T20:38:20.073
> 
> 标签：php, geolocation, mysqli

我想在我的 phpwebsite 中使用地理位置。那我做了什么。用户可以将姓名、街道、房屋号码等信息添加到数据库中。这些信息清楚地存储在数据库中。如果人们使用搜索功能寻找地点，他们会收到他们搜索过的地点列表。在列表中的每个已创建地点上，用户可以单击 en 他们会收到有关特定地点（记录）的更详细的页面。在此页面中必须有地理位置。我已经使用谷歌，我发现我需要将地址转换为纬度/经度。必须将此纬度和经度添加到数据库中，但我不知道在什么时候（已经在添加函数中，在单独的函数之后）以及我将如何执行此操作。此时我有一个计算经度和纬度的函数。我将它们存储到 2 个变量中，在javascript中，但现在我被卡住了。在这里你可以看到我已经拥有的代码。

```
<script>
$(document).ready(function () {

    // wire up button click
    $('#go').click(function () {
        // get the address the user entered
        var straat = $('#straat').val();
        var nummer = $('#nummer').val();
        var address = straat + " " + nummer;
        alert(address);
        if (address) {
            // use Google Maps API to geocode the address
            // set up the Geocoder object
            var geocoder = new google.maps.Geocoder();
            // return the coordinates
            geocoder.geocode({ 'address': address }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    if (results[0]) {
                        // print results
                        printLatLong(results[0].geometry.location.lat(),
                           results[0].geometry.location.lng());
                    } else {
                        error('Google did not return any results.');
                    }

                } else {
                    error("Reverse Geocoding failed due to: " + status);
                }
            });
        }
        else {
            error('Please enter an address');
        }
    });

});

// output lat and long
function printLatLong(lat, long) {
    var latitude = lat;
    var longitude = long;
    $('.results').text(latitude);
}

function error(msg) {
    alert(msg);
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:46:29.410

您在哪里将其他字段保存到数据库中？为什么不在同一点进行地理编码和存储纬度和经度？

# asp.net - 在 ASP.NET MVC3 中上传文件时“字符串或二进制数据将被截断”

> ID：10541781
> 
> 赞同：1
> 
> 时间：2012-05-10T20:38:24.300
> 
> 标签：asp.net, sql-server, asp.net-mvc-3, sql-server-2008, linq-to-sql

我正在 ASP.NET MVC3 中开发一些应用程序并尝试在 SQL Server 2008 中上传一些文件，我在 DB 中有类型 varbinary(MAX)，我有下面的代码用于上传它，但我收到错误“字符串或二进制数据将被截断。语句已终止“我认为这是一个数据库错误，你认为我的问题在哪里？谢谢

```
if (UploadedFile != null)
            {
                App_MessageAttachment NewAttachment= new App_MessageAttachment { FileName = UploadedFile.FileName, FilteContentType = UploadedFile.ContentType, MessageId = NM.Id, FileData = new byte[UploadedFile.ContentLength] };
                UploadedFile.InputStream.Read(NewAttachment.FileData, 0, UploadedFile.ContentLength);
                db.App_MessageAttachments.InsertOnSubmit(NewAttachment);
                db.SubmitChanges();
            } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T20:41:53.143

这是一个数据库错误，但它不一定与插入的文件部分相关联。检查以确保 FileName、FileContentType 和 MessageId 都足够短以适合数据库中的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:53:47.907

我将从 Management Studio -> 工具 -> SQL Profiler 开始。将其指向您的数据库并再次运行上传。在您的应用程序中看到错误后按暂停或停止，并在跟踪窗口中搜索错误消息。这将为您提供生成此消息的 SQL。如果解决方案没有立即呈现给您，请使用失败的语句编辑您的帖子。

以下是一些 Profiler 资源

[SQL Server Profiler 一步一步](http://www.codeproject.com/Articles/21371/SQL-Server-Profiler-Step-by-Step)

[如何：使用 SQL 事件探查器](http://msdn.microsoft.com/en-us/library/ff650699.aspx)

# eclipse - Aptana/Eclipse 查找下一个快捷方式 - 用于在文件中查找

> ID：10541783
> 
> 赞同：0
> 
> 时间：2012-05-10T20:38:32.217
> 
> 标签：eclipse, aptana

我看到了这个[帖子](https://stackoverflow.com/questions/7569630/is-there-a-find-in-files-shortcut-in-eclipse)。但我仍然看不到任何方法可以快速浏览一堆搜索结果，进行编辑，并使用快捷键前进到下一个结果。“查找下一个”快捷方式仅适用于“搜索”选项卡窗口，而不适用于我在编辑时具有焦点的“编辑器”窗口。我必须继续单击下一个结果，然后单击编辑器窗口进行编辑。

看起来很基本，我一定错过了一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T00:38:58.130

我现在看到 Ctl+K 设置为做类似的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T23:42:46.520

**Ctrl+Alt+G**是在整个工作区（`Search>Text>Workspace`从菜单）中搜索当前选定文本的默认快捷方式。

没有用于在文件和当前项目中搜索选定文本的默认键映射，但我发现添加它非常有用（分别为**Ctrl+Alt+F**和**Ctrl+Alt+P** ( `Window>Preferences>Keys`)）

# c# - 似乎无法检查 RouteData 的可选参数

> ID：10541788
> 
> 赞同：1
> 
> 时间：2012-05-10T20:38:48.063
> 
> 标签：c#, asp.net, .net, routing, routes

我有一个带有可选“id”参数的页面路由。定义如下：

```
 routes.MapPageRoute(null,
            "projects/{operation}/{id}",
            "~/Projects/ProjectWizard.aspx",
            true,
            new RouteValueDictionary(new
            {
                operation = "new",
                id = UrlParameter.Optional
            }),
            new RouteValueDictionary(new
            {
                operation = @"new|edit",
                id = @"\d*"
            })
        ); 
```

该路线工作正常，但是当我到达页面时，如果我没有包含可选的“id”参数，那么我的代码在尝试转换为整数时会失败。

```
 var operation = RouteData.Values["operation"].ToString();
        var projectId = RouteData.Values.ContainsKey("id") ? Convert.ToInt32(RouteData.Values["id"]) : 0; 
```

只要我在这样的路线中传递一个 ID，这就会很好：

```
http://webapp/projects/edit/123 
```

`projectId`等于 123，就像它应该的那样。但如果我不包括 ID：

```
http://webapp/projects/new 
```

路线很好地转到页面，但我收到此错误：

> 无法将“System.Web.Mvc.UrlParameter”类型的对象转换为“System.IConvertible”类型。

[![](../Images/9858aa82eb05e848beff862cb525a925.png)](https://i.imgur.com/r92Eu.png)
它应该无法在路由数据值中找到键，然后将零分配给`projectId`，但事实并非如此。我一直在尝试不同的方法来检查“id”路由值是否为空，但它似乎不太喜欢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T06:25:28.630

如果您在此处处理 MVC 控制器操作和 MapRoute，那将非常有效。

在您的情况下，我会做的只是在默认值而不是 UrlParameter.Optional 中为您的 id 设置默认值，因此：

```
 routes.MapPageRoute(null,
    "projects/{operation}/{id}",
    "~/Projects/ProjectWizard.aspx",
    true,
    new RouteValueDictionary(new
    {
        operation = "new",
        id = "0"
    }),
    new RouteValueDictionary(new
    {
        operation = @"new|edit",
        id = @"\d*"
    })
); 
```

然后像这样简单地阅读你的身份证：

```
 var operation = RouteData.Values["operation"].ToString();
var projectId = int.Parse(RouteData.Values["id"].ToString()); 
```

# qooxdoo - 如何制作 qooxdoo 所需的 SelectBox？

> ID：10541791
> 
> 赞同：1
> 
> 时间：2012-05-10T20:39:06.983
> 
> 标签：qooxdoo

如何强制用户从 qooxdoo SelectBox 中进行选择？我希望 SelectBox 最初显示为空选择（或者更好的是，“请选择...”消息）。如果用户没有做出选择，我希望表单验证失败，并且 selectBox 出现红色“无效”装饰和“必需”工具提示，就像必需的文本字段一样。

RadioButtonGroup 也是如此：有没有办法让该组最初出现时没有选择按钮，并且在做出选择之前无效？

* * *

后来......这似乎适用于 SelectBox 案例：

```
var genderSlct = new qx.ui.form.SelectBox();
genderSlct.add(new qx.ui.form.ListItem("")); // initially selected null item
genderSlct.add(new qx.ui.form.ListItem("Male", null, "M"));
genderSlct.add(new qx.ui.form.ListItem("Female", null, "F"));
...

myForm.getValidationManager().setValidator(function(items) {
    var valid = true;

    if (genderSlct.getSelection()[0].getModel() == null) {
        genderSlct.setValid(valid = false);
        genderSlct.setInvalidMessage("Please select your gender.");
    }   
    ...   

    if (valid) {
        genderSlct.setValid(true);
        ...
        return true;
    } else {
        return false;
    }   
}); 
```

后来还是......找到了 RadioButtonGroup 的解决方案：

要获得初始未选中状态，请添加一个不可见的第一个 listItem 与 null 模型：

```
myRbg.add(new qx.ui.form.RadioButton("").set({
     model: null, visibility: "excluded"
})); 
```

然后将与 selectionBox 相同样式的代码添加到表单验证器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T07:51:46.593

查看此演示，它提供了您在 SelectBox 案例中寻找的确切内容：http: [//demo.qooxdoo.org/2.0.1/demobrowser/index.html#data~Form.html](http://demo.qooxdoo.org/2.0.1/demobrowser/index.html#data~Form.html)

您可以简单地检查验证器中的选择。

# c# - DataContractSerializer 属性的反序列化从派生类移动到基类

> ID：10541793
> 
> 赞同：1
> 
> 时间：2012-05-10T20:39:21.977
> 
> 标签：c#, .net, datacontractserializer

使用 DCS，我试图从 XML 中反序列化对象，其中序列化的对象是 Child 继承类 Base 的类型，其中 Child 具有一些已反序列化但后来在代码中移动到类 Base 的属性。现在这些属性不会被反序列化：

看看这个 XML：

```
<Base i:type="a:DirectoryEntry" xmlns="http://schemas.datacontract.org/2004/07/pending.Core.Models" xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns:a="http://schemas.datacontract.org/2004/07/pending.Core.Models.Directory">
    <Active>true</Active>
    <ContentType>DirectoryEntry</ContentType>
    <Created>2012-03-12T11:51:25.3401552+01:00</Created>
    <a:Location>location</a:Location>
    <a:OpenHours>opening</a:OpenHours>
</Base> 
```

xmlns:a 表示派生类型名称。这个类用来存放那些道具。现在它们被移到基类中，不再被 DCS 反序列化（反序列化后属性为空）。我说的是属性：在它们前面（在这种情况下是位置和开放时间）。

我们有很多这样的文件保存数据。使用 DCS 正确反序列化这些文件有哪些选择？

*请注意 [KnownType] 属性在 Base 和 Child 类中都使用*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T22:33:33.727

当您将属性移至基类时，它们实际上已移至另一个 XML 名称空间。基类可能定义在 namespace `pending.Core.Models`，而派生类定义在`pending.Core.Models.Directory`(我假设您没有在`Namespace`属性的`[DataContract]`属性中指定任何内容。因此，如果您更改了元素应该在的命名空间，那么序列化程序将'无法将它与您拥有的数据匹配。如果您将最后两个属性移至基类，则需要更改 XML 元素的命名空间`Location`和`OpenHours`.

```
<Base i:type="a:DirectoryEntry"
      xmlns="http://schemas.datacontract.org/2004/07/pending.Core.Models"
      xmlns:i="http://www.w3.org/2001/XMLSchema-instance"
      xmlns:a="http://schemas.datacontract.org/2004/07/pending.Core.Models.Directory">
  <Active>true</Active>
  <ContentType>DirectoryEntry</ContentType>
  <Created>2012-03-12T11:51:25.3401552+01:00</Created>
  <Location>location</Location>
  <OpenHours>opening</OpenHours>
</Base> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-14T17:37:35.523

我的解决方案是将属性移回原始类，并将它们留在它们首先移动到的类中。它现在给出了警告，`Property hides the inherited member...Use the new keyword if hiding was intended`但我可以忍受，因为反序列化现在再次起作用，我们可以将数据从一个提供者移动到另一个提供者。我找不到任何其他解决方案，并且无法修改所有序列化数据文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-14T13:21:32.987

正如 mare 上面或下面所提到的，在接受的答案中，没有原始类中没有该属性的解决方案。但是，通过`new`在原始类的属性声明中使用关键字，可以禁用警告。我还得到了以下结构：

```
[DataContract]
class Base
{
    [DataMember]
    public int X { get; set; }
} 

[DataContract]
class Derived : Base
{
    [DataMember]
    private new int X
    {
        get => base.X;
        set => base.X = value;
    }
} 
```

通过`DataContractSerializer`反射读取属性，因此它并不真正关心该属性是私有的，而是将属性放在其原始位置私有，从而防止从代码中使用它（如预期的那样）。

# php - 意外的 T_IF，数组中的 if 语句

> ID：10541795
> 
> 赞同：2
> 
> 时间：2012-05-10T20:39:24.643
> 
> 标签：php

我不知道为什么会收到 Parse error: syntax error, unexpected T_IF on line 6。

```
 $sf = array ( 

            "name" => $firstname . ' ' . $lastname,
            "email" => $email,
            "address" => $shipping_address_1 . if(!empty($shipping_address_2 )) { echo ", " . $shipping_address_2 }
            );
            print_r($sf); 
```

我想检查 $shipping_address_2 是否不为空，如果不是，则显示它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:41:30.333

因为你的代码是错误的。您不能`if`在数组初始化中放置语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:41:46.373

不是 100% 确定，但你应该能够使用三元运算符......

```
"address" => $shipping_address_1 . 
    (!empty($shipping_address_2 )) ? 
        ", " . $shipping_address_2 : // This gets executed if condition is true
        ""    // This gets executed if the condition is false 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:42:09.243

代替

```
 "address" => $shipping_address_1 . if(!empty($shipping_address_2 )) { echo ", " . $shipping_address_2 } 
```

和

```
"address" => $shipping_address_1 . (empty($shipping_address_2) ? null :  ", " . $shipping_address_2) 
```

# spring - RestClientException 无法提取响应 spring mvc

> ID：10541796
> 
> 赞同：1
> 
> 时间：2012-05-10T20:39:33.167
> 
> 标签：spring, rest, spring-mvc, dispatcher

我正在尝试通过 restTemplate 连接到服务器端以检索 xml。但是我收到了 RestClientException 和这条消息：“无法提取响应：没有找到适合响应类型 [frontend.model.Registration] 和内容类型 [application/xml] 的 HttpMessageConverter”在调度程序-servlet 中我写了这个：

```
<bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
 <property name="mediaTypes">
    <map>
        <entry key="xml" value="application/xml"/>
        <entry key="atom" value="application/atom+xml"/>
        <entry key="html" value="text/html"/>
    </map>
 </property>
 <property name="viewResolvers">
    <list>
        <bean class="org.springframework.web.servlet.view.BeanNameViewResolver"/>
    </list>
 </property> 
```

之后我添加了这个：

```
 <bean class="org.springframework.http.converter.xml.SourceHttpMessageConverter"/> 
```

异常也出现在这一行：3

```
 ResponseEntity<Registration> result = restTemplate.exchange("http://www.../ckp/user/{id}",
                    HttpMethod.GET, entity, Registration.class, id); 
```

我现在无法解决问题。我正在考虑添加 ViewResoler 和 MessageConverter，因为我不知道哪些解析器和哪些转换器。任何人都可以提出一些尝试吗？我应该在 disptcher servlet 上添加一些东西吗？我应该添加一个库吗？我的模型类是 pojo 的包含 jaxb 注释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T00:26:04.520

您需要将 xml 消息转换器 bean 添加到`RestTemplate`bean 定义中。这就是我使用的：

```
<bean id="restTemplate" class="org.springframework.web.client.RestTemplate">
    <property name="messageConverters">
        <list>
            <bean class="org.springframework.http.converter.xml.SourceHttpMessageConverter"/>
            <bean class="org.springframework.http.converter.FormHttpMessageConverter"/>
            <bean class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter"/>
        </list>
    </property>
</bean> 
```

不要忘记将`restTemplate`bean 注入到您的类中（通过 xml 或注释）。

编辑：在您调用 RestTemplate 的类中，添加如下字段：

```
@Inject
private RestTemplate restTemplate; 
```

# c# - 无构造函数的类可以在没有实例化的情况下调用它们的方法吗？

> ID：10541797
> 
> 赞同：1
> 
> 时间：2012-05-10T20:39:35.720
> 
> 标签：c#

我可以避免初始化吗？

我有一个**没有构造函数**的简单工厂。我这样使用它：

```
var slf = new GenericSelectListFactory();
vm.Works = slf.getWorkgsl(0);
vm.Cars = slf.getCargsl(0); 
```

我也可以这样使用它：

```
vm.Cars = new GenericSelectListFactory().getCargsl(0); 
```

没有新关键字有什么方法可以使用它？

```
vm.Cars = GenericSelectListFactory.getCargsl(0); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-10T20:42:26.277

使您的类的方法静态。

```
class GenericSelectListFactory
{
   public static List<Cars> getCargsl()
   {
      // your logic here
   }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-10T20:41:20.430

没有“新”，您应该将方法标记为静态

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-10T20:44:29.267

编译器会为没有构造函数的类分配一个默认构造函数，主要是为了消除对空构造函数的需要：

> 除非类是静态的，否则 C# 编译器会为没有构造函数的类提供公共默认构造函数，以启用类实例化。

如果您想在不初始化类的情况下访问方法，请创建 method(s) `static`。但是，在这样做时，您应该确保这些方法是线程安全的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-10T20:42:10.307

您可以将功能设为静态。

# xml - Builder gem 中的命名空间属性

> ID：10541800
> 
> 赞同：6
> 
> 时间：2012-05-10T20:40:02.100
> 
> 标签：xml, namespaces, builder

我尝试使用[构建器 gem](http://rubygems.org/gems/builder)在 Ruby on Rails 应用程序中构建此示例：

```
<?xml version="1.0" encoding="utf-8"?> 
<ngp:contactGet xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ngp="http://www.ngpsoftware.com/ngpapi"> 
<campaignID>1033</campaignID> 
<contactID>199434</contactID> 
</ngp:contactGet> 
```

我可以生成一个带有命名空间的标签，如下所示：

```
xml = Builder::XmlMarkup.new
xml.ngp :contactGet 
```

...但我无法在该标签内获得属性。

我会认为

```
xml.ngp :contactGet("xmlns:xsi" => "http://www.w3.org/2001/XMLSchema-instance" "xmlns:ngp" =>"http://www.ngpsoftware.com/ngpapi" 
```

会工作，但它没有。

请帮忙！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-11T15:00:46.377

弄清楚了：

```
xml.tag!('gp:contactGet', {"xmlns:xsi"=>"http://www.w3.org/2001/XMLSchema-instance", "xmlns:ngp"=>"http://www.ngpsoftware.com/ngpapi"}) do 
  xml.campaignID("1033")
  xml.contactID("199434")
end 
```

生产...

```
<?xml version="1.0" encoding="UTF-8"?>
<gp:contactGet xmlns:ngp="http://www.ngpsoftware.com/ngpapi" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <campaignID>1033</campaignID>
  <contactID>199434</contactID>
</gp:contactGet><to_s/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-01T12:50:24.767

来自 Builder 的文档：[http ://builder.rubyforge.org/](http://builder.rubyforge.org/)

> 现在可以使用对 XML 命名空间的一些支持。如果标签调用的第一个参数是一个符号，它将被连接到标签以产生一个命名空间：标签组合。展示它比描述它更容易。
> 
> xml.SOAP :信封做...结束
> 
> 只需在命名空间中的冒号前放置一个空格，即可为构建器生成正确的表单（例如“SOAP:Envelope”=>“xml.SOAP :Envelope”）

所以，你可以这样写：

```
xml.gp :contactGet do
  xml.campaignID("1033")
  xml.contactID("199434")
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-20T05:12:25.987

您可以使用此语法代替`xml.tag!('gp:contactGet')`

```
xml.gp :contactGet do 
  xml.contactID, "199434"
end 
```

此外，如果您需要块内标签的命名空间，您可以使用以下语法。我在其他任何地方都找不到此信息，因此在此处添加。

```
xml.tag!('gp:contactGet') do 
  xml.gp :contactID, "199434"
end 
```

给出以下标记：

```
<gp:contactGet>
  <gp:contactID>199434</gp:contactID>
</gp:contactGet> 
```

# windows - 自解压自检可执行文件

> ID：10541801
> 
> 赞同：2
> 
> 时间：2012-05-10T20:40:06.550
> 
> 标签：windows, zip, authenticode, self-extracting

我正在分发一个经过验证码签名的自解压可执行文件，其内容由我控制。

它包含大量基于 MSI 的安装程序，可控制分布式系统的热插拔，因此它本身不能轻易成为 MSI。

**如果可执行文件只是检查自己的身份验证代码**并且如果未签名则拒绝自解压，那就太好了。我确实意识到这并不能提供真正的完整性保证，但它会强化这样的信息，即内容绝不是可定制的，并且可能会使一些正式的认证更容易处理。

一种可能的策略可能是基于[这个仍未得到解答的问题](https://stackoverflow.com/questions/5018103/creating-a-selfextracting-executable-which-will-copy-itself-to-temp-directory-on)。还有其他想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T04:40:04.307

这在一般情况下是不可能的。如果有人篡改了您的二进制文件，也许他们也会删除您的自检。

如果可以构建一个完全防篡改的可执行文件，那么任何人都无法盗版软件。

您所要求的可以通过创建一个自解压可执行文件然后对其应用商业复制保护包来最接近地实现。

为此，请使用您喜欢的搜索引擎搜索“可执行复制保护”。

# php - 从字符串中删除最后两个单词

> ID：10541808
> 
> 赞同：2
> 
> 时间：2012-05-10T20:40:36.880
> 
> 标签：php, string, preg-replace

我对 完全陌生`preg_replace`，但下面的代码从我的字符串中删除了最后一个单词：

```
preg_replace('/\W\w+\s*(\W*)$/', '$1', $var); 
```

我正在尝试修改它，以便它删除最后**两个**单词。

我唯一能想到的就是替换`$1`为`$2`，但这似乎根本没有任何效果，可能只是愚蠢：/

有问题的字符串看起来像这样：

```
Lorem ipsum dolor sit amet. Source: LOREM 
```

我想删除`Source: LOREM`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-10T20:49:54.343

一个简单的正则表达式可以匹配一个空格，后跟任意数量的字母（或冒号），然后是一个空格，然后是字符串末尾的任意数量的字母：

```
$str = "Lorem ipsum dolor sit amet. Source: LOREM";
$str = preg_replace( "/\s[a-z:]+\s[a-z]+$/i", "", $str );

// Lorem ipsum dolor sit amet.
echo $str; 
```

表达式分解如下：

```
\s       // Single space
[a-z:]+  // Any letter, a to z, or a colon, 1 or more times
\s       // Single space
[a-z]+   // Any letter, a to z, 1 or more times
$        // End of string 
```

演示：[http ://codepad.org/G22LnDDY](http://codepad.org/G22LnDDY)

另一种方法是使用`explode`创建一个单词数组，并删除最后两个。

```
$str = "Lorem ipsum dolor sit amet. Source: LOREM";
$words = explode( " ", $str );
array_splice( $words, -2 );

// Lorem ipsum dolor sit amet.
echo implode( " ", $words ); 
```

演示：[http ://codepad.org/6XwqvwuP](http://codepad.org/6XwqvwuP)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:48:01.067

您不必*在*这里使用正则表达式。假设您将单词定义为被空格包围的任何内容：

```
$words = explode(' ', 'Lorem ipsum dolor sit amet. Source: LOREM');
if (count($words) >= 2) {
    array_pop($words);
    array_pop($words);
}
$words = implode(' ', $words); 
```

或者：

```
$words = explode(' ', 'Lorem ipsum dolor sit amet. Source: LOREM');
if (count($words) >= 2) {
    $words = array_slice($words, 0, count($words) - 2);
}
$words = implode(' ', $words); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T21:00:20.167

```
$str = ' would like to remove Source: LOREM';
$str =  preg_replace('/(.*)\s+([a-zA-Z]+):\s+([a-zA-Z]+)$/', '$1', $str);
echo $str; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T20:48:59.443

$1，实际上是用于替换的分组捕获，因此可以将其视为 $n，$n+1。您的正则表达式中只有 1 组括号（）。所以你需要第二组。如果您实际上不需要交换某些内容，则可以使用更有针对性的方法。

.*(?=\s\D+\s)

应该让你更接近。此外，对我来说，一个救生员（真的可以节省时间）是[http://regexpal.com/](http://regexpal.com/) 没有它我不会编写 RegEx 代码。

# testing - 在 Kindle Fire 应用程序中测试应用内购买

> ID：10541809
> 
> 赞同：4
> 
> 时间：2012-05-10T20:40:37.410
> 
> 标签：testing, in-app-purchase, kindle-fire

即使使用 Amazon Appstore SDK Tester，我也无法在应用程序购买中进行测试。

```
public void onPurchaseResponse(final PurchaseResponse purchaseResponse) 
```

purchaseResponse 总是有“INVALID_SKU”，即使我有带有假 JSON 的 amazon.sdktester.json 文件。

文件内容：{“test”：{“itemType”：“CONSUMABLE”，“price”：0.99，“title”：“更多点击！”，“description”：“点击你的按钮十次！”，“smallIconUrl” : "http://www.google.com/images/srpr/logo3w.png" },

```
"com.amazon.buttonclicker.ten_clicks" : {
    "itemType": "CONSUMABLE",
    "price": 0.99,
    "title": "More Clicks!",
    "description": "Click your button ten more times!",
    "smallIconUrl": "http://www.google.com/images/srpr/logo3w.png"
  },

  "com.amazon.buttonclicker.blue_button" : {
    "itemType": "ENTITLED",
    "price": 0.99,
    "title": "Blue Button",
    "description": "Button Clicker - Now in Blue!",
    "smallIconUrl": "http://www.google.com/images/srpr/logo3w.png"
  }
} 
```

即使是示例应用程序也不起作用。您对如何测试应用程序有任何建议吗？Amazon SDK Tester 似乎没有拦截请求。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T06:18:38.323

以下是我如何让应用内购买在 Kindle Fire 上工作（经过几个小时的努力......）

1.  adb install AmazonSDKTester.apk（在 Kindle Fire 上安装 SDKTester）
2.  在 SDCARD 目录中创建一个文件 amazon.sdktester.json（连接的 KF 在您的 Mac 上的 Finder 中显示为 SDCARD）
3.  amazon.sdktester.json 的内容 - **{ "com.yourcompany.yourpkgname.200_coins" : { "itemType": "CONSUMABLE", "price": 0.99, "title": "200 COINS", "description": "2 COINS ", "smallIconUrl": "http://www.yourcompany.com/icon.png" } }**
4.  按下 KF 上的电源按钮并按下“断开连接”按钮 - 现在 KF 不再是您 Mac 上的已安装驱动器。
5.  在 KF 上运行 AmazonSDKTester 应用程序。
6.  从 Eclipse 运行您的应用程序。确保 JSON 中的包名称与亚马逊网站上的 In App Item SKU 和**PurchasingManager.initiatePurchaseRequest("com.yourcompany.yourpkgname.200_coins");**
7.  现在您应该会看到应用内插页式广告出现了。
8.  仍然不起作用 - 在 KF 上强制关闭您的应用程序和 AmazonSDKTester；硬复位 KF ; 重新启动 Eclipse 并从步骤 1 重新启动

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-01T10:06:24.767

不要忘记 json 中的外层 {} 大括号。我花了3个小时才弄明白...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-11T08:45:17.187

看起来很神奇，但硬重置解决了我所有的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-29T22:18:45.573

确保在将 USB 电缆连接到您的 PC 后点击断开按钮，否则 SDK 测试器将无法读取您移动的 JSON 文件，因为此时设备已安装。发现这个很难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-20T09:04:38.417

我遇到了和你一样的问题，关键是：在你的java代码中，你的项目id必须等于你在json文件中的SKU，在这种情况下，它必须是：`com.amazon.buttonclicker.ten_clicks`或者`com.amazon.buttonclicker.blue_button` 这是示例json文件`SampleIAPConsumablesApp`和`SampleIAPEntitlementsApp`亚马逊提供的示例项目：

```
{
"com.amazon.sample.iap.consumable.orange" : {

    "itemType": "CONSUMABLE",

    "price": 0.99,

    "title": "More Clicks!",

    "description": "Click your button ten more times!",

    "smallIconUrl": "http://some/image.jpg"

  },

  "com.amazon.sample.iap.entitlement.level2" : {

    "itemType": "ENTITLED",

    "price": 0.99,

    "title": "Blue Button",

    "description": "Button Clicker - Now in Blue!",

    "smallIconUrl": "http://some/image.jpg"

  }
} 
```

祝你好运！

# sms - 多个可供选择的 SMS 消息使用哪个网关？

> ID：10541810
> 
> 赞同：1
> 
> 时间：2012-05-10T20:40:39.617
> 
> 标签：sms, mms, sms-gateway

假设：我想以编程方式向所有 Verizon 手机发送一条短信。我有[多个电子邮件网关](http://en.wikipedia.org/wiki/List_of_SMS_gateways)可供使用（从完全可靠的维基百科获得）：

*   number@vtext.com
*   number@vzwpix.com
*   number@message.alltel.com
*   number@text.wireless.alltel.com
*   number@mms.alltel.net

我不*认为*我**可以保证**其中任何一个都可以工作和/或仍然可以使用（是吗？），我不想在以后回来更改代码中的任何内容.

当有 5 个可能的网关时，有什么方法可以确保我只向给定的电话号码发送一条短信？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-01T02:34:05.013

确保您只向收件人传递一条消息的唯一方法（据我所知）是按顺序尝试每个网关，直到成功发送消息，就像提到的一些评论一样。

但是，我最近一直在发送相当数量（> 1500 条）的消息`@vtext.com`，并且在发送过程中没有注意到任何反弹或停机时间。我无法知道是否每条消息都已送达，但我的测试号码中没有一个已丢弃消息。如今，大多数美国运营商的网关似乎都具有不错的可靠性。

请记住，大多数运营商仍将 SMS 视为尽力而为的服务。即使您成功地将消息发送到他们的服务器，也不能保证消息会到达目的地。

# delphi - 如何使用纯 GDI 对画布区域进行颜色混合（按指定的 alpha 值着色）？

> ID：10541811
> 
> 赞同：9
> 
> 时间：2012-05-10T20:40:43.767
> 
> 标签：delphi, winapi, optimization, gdi

我想使用纯色混合（通过指定的 alpha 值着色）画布区域[`Windows GDI`](http://msdn.microsoft.com/en-us/library/dd145203%28v=vs.85%29.aspx)（所以没有 GDI+、DirectX 或类似的、没有 OpenGL、没有汇编程序或第 3 方库）。

我创建了以下函数，我想知道是否有更有效或更简单的方法来执行此操作：

```
procedure ColorBlend(const ACanvas: HDC; const ARect: TRect;
  const ABlendColor: TColor; const ABlendValue: Integer);
var
  DC: HDC;
  Brush: HBRUSH;
  Bitmap: HBITMAP;
  BlendFunction: TBlendFunction;
begin
  DC := CreateCompatibleDC(ACanvas);
  Bitmap := CreateCompatibleBitmap(ACanvas, ARect.Right - ARect.Left,
    ARect.Bottom - ARect.Top);
  Brush := CreateSolidBrush(ColorToRGB(ABlendColor));
  try
    SelectObject(DC, Bitmap);
    Windows.FillRect(DC, Rect(0, 0, ARect.Right - ARect.Left,
      ARect.Bottom - ARect.Top), Brush);
    BlendFunction.BlendOp := AC_SRC_OVER;
    BlendFunction.BlendFlags := 0;
    BlendFunction.AlphaFormat := 0;
    BlendFunction.SourceConstantAlpha := ABlendValue;
    Windows.AlphaBlend(ACanvas, ARect.Left, ARect.Top,
      ARect.Right - ARect.Left, ARect.Bottom - ARect.Top, DC, 0, 0,
      ARect.Right - ARect.Left, ARect.Bottom - ARect.Top, BlendFunction);
  finally
    DeleteObject(Brush);
    DeleteObject(Bitmap);
    DeleteDC(DC);
  end;
end; 
```

对于这个函数应该做什么的概念，请参见以下（区分:-)图像：

![在此处输入图像描述](../Images/913809e2dcea1719c2055064133c3f5a.png) ![在此处输入图像描述](../Images/b45e2b9af1f5160fe86749d6aec199fa.png)

以及可以按上图方式渲染[`this image`](https://i.stack.imgur.com/6G3Eg.png)到表单左上角的代码：

```
uses
  PNGImage;

procedure TForm1.Button1Click(Sender: TObject);
var
  Image: TPNGImage;
begin
  Image := TPNGImage.Create;
  try
    Image.LoadFromFile('d:\6G3Eg.png');
    ColorBlend(Image.Canvas.Handle, Image.Canvas.ClipRect, $0000FF80, 175);
    Canvas.Draw(0, 0, Image);
  finally
    Image.Free;
  end;
end; 
```

使用纯 GDI 或 Delphi VCL 是否有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-10T20:55:48.443

你试过用 AlphaBlend 画布吗？

就像是

```
Canvas.Draw(Arect.Left, ARect.Top, ABitmap, AAlphaBlendValue); 
```

与 FillRect 结合用于混合颜色

**更新**：这里有一些代码，尽可能接近您的界面，但纯 VCL。
可能效率不高，但更简单（并且有点便携）。
正如雷米所说，要以伪持久的方式在表单上绘画，您必须使用 OnPaint ...

```
procedure ColorBlend(const ACanvas: TCanvas; const ARect: TRect;
  const ABlendColor: TColor; const ABlendValue: Integer);
var
  bmp: TBitmap;
begin
  bmp := TBitmap.Create;
  try
    bmp.Canvas.Brush.Color := ABlendColor;
    bmp.Width := ARect.Right - ARect.Left;
    bmp.Height := ARect.Bottom - ARect.Top;
    bmp.Canvas.FillRect(Rect(0,0,bmp.Width, bmp.Height));
    ACanvas.Draw(ARect.Left, ARect.Top, bmp, ABlendValue);
  finally
    bmp.Free;
  end;
end;

procedure TForm1.Button1Click(Sender: TObject);
var
  Image: TPNGImage;
begin
  Image := TPNGImage.Create;
  try
    Image.LoadFromFile('d:\6G3Eg.png');
    ColorBlend(Image.Canvas, Image.Canvas.ClipRect, $0000FF80, 175);
    Canvas.Draw(0, 0, Image);
    // then for fun do it to the Form itself
    ColorBlend(Canvas, ClientRect, clYellow, 15);
  finally
    Image.Free;
  end;
end; 
```

# api - 将 GUI 与 SOAP/WS-API 更新/写入调用分离的好方法？

> ID：10541820
> 
> 赞同：0
> 
> 时间：2012-05-10T20:41:37.543
> 
> 标签：api, web-applications, transactions, decoupling

假设我们有一些配置 GUI，其当前形式使用直接 DB 事务以一致的方式为多个可配置组件提交新配置。

现在让我们移动一些 SOAP/WS API 后面的数据 (DB) 内容。GUI 不再有直接的数据库访问权限。事务行为必须保留，但 API 不应*设计*为明确适应 GUI 表单提交。事实上，我什至不知道新的 GUI 将如何工作或用户输入的结构将如何。因此我需要在 API 服务器端提供类似[WS-AtomicTransaction的东西。](http://docs.oasis-open.org/ws-tx/wstx-wsat-1.2-spec-os/wstx-wsat-1.2-spec-os.html)但是，有（至少）两个警告：

*   GUI 是用 PHP 编写的：我认为 PHP 中没有任何可用的 WS-Transaction 支持。
*   在等待其他客户端请求时，我不想在服务器端保持数据库事务打开。

我能想到的解决方案：

*   使用[骆驼的聚合](http://camel.apache.org/aggregator2.html)。但是，这至少会在两个方面使事情变得更加复杂：
    *   您不能在同一事务内的后续调用中使用新插入行的 DB 行 ID。您需要使用某种符号反向引用，因为在处理聚合消息时客户端和服务器之间没有通信。
    *   呼叫回复不会是立即的（或者对每个单独呼叫的立即和单独回复只是某种存根，即。除了“您的消息已附加到 TX xyz”之外不包含任何有用的信息——如果有的话在骆驼聚合情况下可能）。
*   前一个解决方案的两个缺点让我想到了请求批处理，其中 WS 标准可能提供了在批处理事务内的后续调用中引用调用结果的方法。有没有这样的东西已经可用？甚至可以作为 PHP 客户端？
*   试图通过仔细使用行级锁等来消除数据库中的锁争用。但是，当插入新元素时，我的猜测是通常页面和索引页面需要被数据库锁定。
*   也许一些使用乐观锁定的服务器端持久层？但是同样，如果数据库写入将被推迟到提交（根本不知道这是否可能），那么在最终提交之前不会将任何数据库 ID 返回给客户端。

*你*怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T18:45:15.567

交易是一种强大的工具，我们很容易进入一种思维模式，在这种模式中，我们将每个问题都视为我们用这把大锤子敲打的钉子。我可以理解你的困惑，因为我自己也经历过。不幸的是，我没有比尝试不考虑事务而是考虑原子 API 调用更好的建议。

当我考虑交易时，我的思维模式通常是这样的：

*   开始交易
*   阅读（根据需要重复）
*   更新（根据需要重复）
*   提交/回滚

需要一些时间才能意识到我们过度使用了这种模式。实际冲突很少见，并且有许多其他方法可以处理它们。这是API中常用的一个

*   读取数据并将数据发送到客户端（原子 API 调用）
*   更新数据（在客户端）
*   将原始 + 更新发送回服务器（原子 API 调用）
    *   开始交易（在服务器上）
    *   读
    *   与客户原件比较
    *   如果不一样，返回错误（客户端应该重试）
    *   如果相同，更新
    *   犯罪

最后六点是API调用实现的一部分。

Ferenc Mihaly [http://theamiableapi.com](http://theamiableapi.com)

# dreamweaver - Dreamweaver CS6 错误？

> ID：10541827
> 
> 赞同：0
> 
> 时间：2012-05-10T20:41:53.347
> 
> 标签：dreamweaver

我在 DW 中有一个黑色背景的页面。在页面的设计视图中，页面显示为白色而不是黑色。我不确定这是为什么。我可以按如下方式将内联样式添加到整个页面以使页面变黑：

```
<body>
<div style="background-color:#000" class="wrap_fullwidth">
<div style="background-color:#000" class="center">
<div style="background-color:#000" class="img-center">
    <img src="image.jpg" alt="Image" />
    </div>
    <p style="background-color:#000"> </p>
</div>
</div>
</div>
</body> 
```

这是页面的 CSS 及其通常的方式：

```
html, body{
 font-size:16px;
 font-family:"Lucida Grande", Helvetica, Arial, sans-serif;
   line-height:23px;
   color:#f3f3f3;
   background:#000;
}

.wrap_fullwidth {width:100%; position:relative; float:left; 
                 clear:both; padding-top:20px; }

.center{width:940px; position:relative; margin:0 auto; 
       clear:both; padding:0px 10px; display:block;}

 p{ margin-bottom:20px; text-align:justify;}

.img-center{ text-align: center; } 
```

设计视图应该显示页面，因为它显示为 css 等。我不明白为什么当 css 清楚地显示黑色作为背景时显示白色。好消息是浏览器中的页面正确显示，但如果我在设计视图中工作，这会让事情变得很痛苦。（我确实使用）

关于如何解决这个问题的想法或想法？

注意：CS5 和 CS5.5 没有这种行为。只有CS6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T18:51:28.463

事实证明，我对 CSS 的重置导致 DW 显示透明背景（因此是白色）而不是黑色。

重置包含此属性：`background:transparent;`

Once I removed that from the reset all worked fine.

*Update*: I had wondered if the way DW CS6 was reading the CSS if there was a bug or not, after filing a bug report I received this reply:

> I was able to reproduce as per your steps and have logged a backlog item for the same. It will be fixed in future release.

# php - 查询仅从所有用户获取最后一条消息

> ID：10541830
> 
> 赞同：3
> 
> 时间：2012-05-10T20:42:05.507
> 
> 标签：php, mysql

我需要编写一个查询来使用 mysql 表从两列中检索值

我的桌子有以下结构

```
| ID | to_user_id | from_user_id |  message  |        datetime     | 
| 1  |     21     |      07      |    hi     | 2012-05-10 04:13:01 | 
| 2  |     07     |      21      |   hello   | 2012-05-10 04:17:51 | 
| 3  |     21     |      11      | what's up | 2012-05-10 04:21:51 |
| 4  |     21     |      02      |  hi dude  | 2012-05-10 04:43:51 | 
```

我想编写一个查询以仅从所有 from_user_id 获取最新消息

我会尝试

```
$query="select * from messages WHERE datetime = (SELECT MAX(datetime) FROM messages)"; 
```

但它显示了错误

'where 子句'中的未知列'datetime'

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-10T20:46:13.980

```
select t1.from_user_id, t1.message
from t1
join (
select from_user_id, max([datetime]) as [datetime]
from t1
group by from_user_id
) t2 on t1.from_user_id = t2.from_user_id
and t1.[datetime] = t2.[datetime] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:53:44.900

你也可以试试：

```
select a.from_user_id, a.message
from table1 a
WHERE a.datetime = (SELECT MAX(datetime) FROM table1 x WHERE x.from_user_id = a.from_user_id) 
```

# javascript - 将读卡器中的信用卡信息捕获到不可编辑的文本字段中

> ID：10541839
> 
> 赞同：5
> 
> 时间：2012-05-10T20:42:29.163
> 
> 标签：javascript, html, credit-card, credit-card-track-data

我是 Javascript 方面的新手。这是我的问题：

我希望从读卡器中获取信用卡信息，然后对其进行处理。到目前为止，我已经能够在 HTML 文本框字段中捕获虚拟信用卡数据 - 实际上这不是火箭科学，因为读卡器输入只是当卡片通过读卡器刷卡时的一组键盘事件。问题是它仅在`cursor focus`文本字段上有 a 时才有效。如果我将文本字段变成只读框，它就不起作用 - 这是我的确切要求。我应该能够屏蔽输入，显示几个`*`s 并且我应该能够使该字段不可编辑。我希望这可以使用`div`放置在文本框上的透明来完成 - 但我不知道如何实现。

我也对其他想法持开放态度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T00:34:43.543

您可以使用 javascript 设置禁用文本字段的值，并通过`document.onkeydown = function(e) { ... }`. 不需要隐藏的 div。

我假设您的页面上有其他字段，这将使您很难知道何时捕获读卡器数据。您是否足够幸运，您的信用卡读卡器会发送一些独特的第一个字符，以便您知道键盘事件来自读卡器而不是用户击键？如果是这样，那么您可以聆听那些特定的击键，这样您就不必担心设置焦点。否则，可能会考虑一个像“读取信用卡”这样的按钮，它的`on("click")`功能设置为读取下一个 xx 位。

以下是一些调试代码，您可以使用它来查看您的阅读器是否发送了您可以收听的任何独特字符：

```
document.onkeydown = function(d) {
    console.log( d.which ? d.which : window.event.keyCode);
}; 
```

可以想象，在使用阅读器时，还有一些其他独特的事件信息。也许检查设备的手册。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-27T10:09:47.887

为了扩展扎克所说的信用卡方面......

请查看[有关金融磁条卡的维基百科页面，](http://en.wikipedia.org/wiki/Magnetic_stripe_card#Financial_cards)了解您将遇到的卡磁道格式的描述。您的阅读器将在最后输出带有回车的数据。

一种选择是扫描所有击键，如果您检测到启动序列`%B`开始缓冲，然后在收到回车时将其存储在您需要的位置。如果有人碰巧键入，那么一个故障保险`%B`就是击键超时，因为阅读器的键入速度会比用户快得多。

```
%B4111111111111111^LASTNAME/FIRST I ^YYMM###..###?;4111111111111111=YYMM###..###?[CR] 
```

# wcf - WCF：在生产中使用或不使用从服务到客户端的异常？有什么选择吗？

> ID：10541843
> 
> 赞同：0
> 
> 时间：2012-05-10T20:42:55.437
> 
> 标签：wcf, exception-handling

我正在考虑使用一些例外来从服务到客户端。

在这种情况下，我正在考虑例如。客户端尝试在数据库中插入一个寄存器。该寄存器具有数据库中存在的 e 字段的值，以及它如何具有唯一约束，当我执行 savechanges 时，我得到一个 updateException。

我正在考虑使用异常（faultException）向客户端警告错误，并使用自定义类向客户端发送寄存器的实际数据，因此客户端不会对寄存器进行其他查询。

但是，在这个[链接](https://msdn.microsoft.com/es-es/library/ms752208.aspx)中，它说只能在开发中使用异常，而不能在生产中使用，所以，没有异常，我怎么能做我想做的事？

也许我可以使用一个自定义类，它对每种类型的实体都有一个列表属性，以及一个属性 bool，它指示操作是对还是错，其他属性带有任意代码来指示错误类型......等等. 这是一个不错的选择吗？

总而言之，真的是更好地避免生产中的异常吗？我如何从服务中与客户端错误通信？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T23:37:58.457

您有 2 个选项：

*   抛出异常并返回 WCF 错误
*   将错误信息附加到您返回的对象

我个人倾向于抛出异常并返回 WCF 错误。我不喜欢将错误信息附加到返回对象的想法，我觉得它违反了面向对象的原则。例如，名为“ErrorCode”的字段在“CustomerAddress”对象上没有位置。

我相信如果出现异常情况，那么应该抛出异常。这也将简化您的代码，因为您不必将所有内容包装在 try catch 块中以便将错误信息附加到您的返回对象。尽管您可能希望捕获意外异常，然后抛出更合适的异常并提供更有用的消息。

# oracle - 免费或试用 Oracle 数据库环境

> ID：10541844
> 
> 赞同：-3
> 
> 时间：2012-05-10T20:43:00.467
> 
> 标签：oracle, toad, oracle-xe

我可以拥有的最好的免费（或试用）Oracle 数据库开发环境是什么？

特别是我想在本地拥有我的数据库，或者尽可能多的数据库。

它的 Oracle 10，我开发 .NET（在 Windows 上），我已经拥有 Toad 和 Oracle 提供的免费 Virtualbox 映像（Linux）（但更愿意在 Windows 中拥有这些工具）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T20:46:39.657

[您可以从OTN](http://otn.oracle.com)（Oracle 技术网）下载几乎所有 Oracle 产品的全功能版本。您可以下载 OTN 许可证下的完整企业版数据库（可免费用于学习/原型制作），也可以下载数据库的快速版，该数据库可免费部署和在生产中使用，但数量有限它可以使用的 RAM，它可以使用多少 CPU，以及数据库可以增长多大。

# iphone - 允许 UIImagePickerViewController 从库和相机添加

> ID：10541845
> 
> 赞同：0
> 
> 时间：2012-05-10T20:43:06.077
> 
> 标签：iphone, ios, uiimagepickercontroller

是否有允许用户点击一次并能够同时从库或相机中选择图像的界面？我知道有办法有两个按钮。我想将其限制为一个按钮而不使用操作表，并允许用户在图像选择器 UI 中时在库和相机之间切换。那么，有没有办法设置这两个值？谢谢。

`UIImagePickerControllerSourceTypeCamera UIImagePickerControllerSourceTypePhotoLibrary`

# php - 如何使用带计数器的 while 循环来回显 else 语句？

> ID：10541847
> 
> 赞同：0
> 
> 时间：2012-05-10T20:43:13.933
> 
> 标签：php, echo, oracle-call-interface

无论如何，我都不是全职 PHP 程序员，但想知道最有效的方法是什么？我正在运行 fetch 以获取一些我想在页面上显示的数据。查询结果通常有多行。

下面的效果很好，除了最后一个没有显示的 else 语句。这部分不起作用。基本上我想显示我的数据行，如果什么都不存在，抛出一条消息说“无”。

我做了一些阅读，它看起来像一个while循环+多个结果集，你不能简单地使用标准else......两者都带有！empty或isset。

有人提到做柜台？这将是实现这一目标的最佳方式。对任何建议持开放态度，因为我将来可能会添加更多这样的数据，并希望以正确的方式进行。

谢谢！

```
while($myvariable = oci_fetch_assoc($stmt))
{
if(!empty($myvariable))
    {
    echo "<tr><th>DISPLAY FIELD NAME:</th><td>" . $myvariable['myrowdata'] . </td></tr>";

    }
    else 
    {
    echo "<tr><th>DISPLAY FIELD NAME:</th><td>None</td></tr>";
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:48:31.303

查看 php 手册上的 oci_fetch_assoc。此函数通常在循环中调用，直到它返回 FALSE，表示不存在更多行。因此，您的 while 循环中不需要任何其他 if 或 else 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:49:47.943

通过获取第一行并检查它是否不是 FALSE，在循环之前进行检查；然后，如果不是，则将其提供给循环并在循环的 END 处获取下一行。这被称为“启动循环”并且并不少见。

```
if(!($myvariable = oci_fetch_assoc($stmt))) {
    echo "<tr><th>DISPLAY FIELD NAME:</th><td>None</td></tr>";
} else {
    while($myvariable) {
        echo "<tr><th>DISPLAY FIELD NAME:</th><td>" . $myvariable['myrowdata'] . </td></tr>";
        $myvariable = oci_fetch_assoc($stmt));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:51:58.050

我认为这个参考将帮助您使用函数 oci_fetch_assoc： [http ://php.net/manual/en/function.oci-fetch-assoc.php#100304](http://php.net/manual/en/function.oci-fetch-assoc.php#100304)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T20:54:12.843

只有当您在“$myvariable”中获得某些内容时，您的 while 语句才会运行，因此您的 if 语句是多余的，而您的 else 在这种情况下是无关紧要的。如果您想按照您的想法运行某些东西，您可以执行“oci_fetch_all()”，然后循环执行您的 if/else。

# facebook - facebook传出链接末尾的“code”参数是什么？

> ID：10541848
> 
> 赞同：0
> 
> 时间：2012-05-10T20:43:16.883
> 
> 标签：facebook, facebook-opengraph

每当我的应用程序通过 opengraph 对象/操作与 facebook 共享内容时，出现在 facebook 上的传出链接都有一个带有很长哈希的 code= 参数。这是什么？它有什么作用？有没有办法摆脱它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T00:48:48.017

如果您的应用开启了[Authenticated Referrals ，则](https://developers.facebook.com/docs/opengraph/authentication/#referrals)**代码**查询参数应为 OAuth 身份验证过程中使用的 Auth Token。

您的服务器应该能够基本上将此 AuthToken 发送回 Facebook 并获取与之关联的访问令牌...

```
 https://graph.facebook.com/oauth/access_token?
    client_id=YOUR_APP_ID
   &redirect_uri=YOUR_REDIRECT_URI
   &client_secret=YOUR_APP_SECRET
   &code=THE_AUTH_TOKEN 
```

您可以阅读有关 Facebook 服务器端身份验证的更多信息。[这里](https://developers.facebook.com/docs/authentication/server-side/)

# jquery - .validate 完成后需要显示 div

> ID：10541849
> 
> 赞同：0
> 
> 时间：2012-05-10T20:43:17.167
> 
> 标签：jquery

我正在使用 jQuery 的验证插件，并希望在验证完成后显示加载 div 并隐藏提交按钮。下一页需要一段时间才能加载显示我需要显示加载 .gif 和一些文本让用户知道发生了什么。

我不能做一个简单的点击显示 div1 并隐藏提交按钮功能，因为如果有错误，那么按钮就会被隐藏。

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:50:42.670

当您调用该`validate`方法时，应该有一个选项可以传递给它，这是一个在表单有效时调用的函数。

```
$(".selector").validate({
   submitHandler: function(form) {
      //do stuff after the form is valid
   }
}) 
```

假设您正在使用这个 jQuery 验证插件：[http ://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

# c# - 显示自定义异常消息

> ID：10541851
> 
> 赞同：1
> 
> 时间：2012-05-10T20:43:28.250
> 
> 标签：c#, asp.net, exception, exception-handling

我试图在保留内部异常的同时显示自定义异常消息。

这是我的示例代码：

```
public class Class1
{
public Class1()
{
    try
    {
        throw new WebException("Initial Exception");
    }
    catch (WebException we)
    {
        throw new myException("Custom Message", we);
    }
}
}

public class myException : WebException
{
public myException(string msg, WebException e) : base(msg, e) { }
} 
```

当我运行此代码时，它会在调试器中显示自定义消息： ![截图1](../Images/3f15ca1f9aecfaf9d4201d18319f22c5.png)

但仍将内部异常消息发送给客户端： ![截图2](../Images/bb00cbd8b0083439d90b0f94eaa5f4d4.png)

我在这里做错了什么？如何在显示我自己的自定义消息时保留内部异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T22:08:23.433

自定义用户看到的消息的方法是提供自定义错误页面。

[http://support.microsoft.com/kb/306355](http://support.microsoft.com/kb/306355)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T21:08:35.793

我怀疑这是因为 ApplicationException 没有得到有效处理，并且 catch 块引发了一个异常，然后将其作为基本异常拾取。然后调试器会列出这两个异常。

我认为这会给出你所追求的行为（我写成一个控制台应用程序）

```
using System;

namespace ConsoleApplication2
{
    class Program
    {
    static void Main(string[] args)
    {
        myException exception;
        try
        {
            throw new ApplicationException("Initial Exception");
        }
        catch (ApplicationException e)
        {
            exception = new myException("Custom Message", e);
        }
        catch (Exception e)
        {
            throw e;
        }

        if (exception != null)
        {
            throw exception;
        }
    }
}
}

public class myException : ApplicationException
{
public myException(string msg, ApplicationException e) : base(msg, e) { }
} 
```

# ios5 - 在应用程序启动时使用情节提要和拆分视图控制器正确显示条件登录屏幕？

> ID：10541852
> 
> 赞同：4
> 
> 时间：2012-05-10T20:43:35.223
> 
> 标签：ios5, uisplitviewcontroller, uistoryboard

这看起来应该很简单，但事实证明它有很多具有挑战性的细微差别——而且我还没有在 Stack Overflow 上的其他地方找到完全、清晰、简单地回答这个问题的答案。

简而言之 - 我有一个 iPad 应用程序，它使用故事板来布局应用程序流程，以及一个拆分视图控制器作为主要的根视图控制器。

此应用程序在启动时检查是否存储了登录凭据，如果有，则直接跳转到 UI，如果没有，则显示全屏登录页面。

但挑战是——应该在哪里进行这种条件检查，以及应该如何实例化登录屏幕？

我已经尝试了我能想到的所有排列。

在应用程序中，委托似乎是显而易见的地方，但调用 segues 或模式弹出窗口似乎被忽略了，因为来自故事板的视图尚未生效。

在拆分视图的细节控制器的启动方法中似乎是下一个明显的地方。

我能找到的最接近工作解决方案的描述如下： [https ://stackoverflow.com/a/8224389/529774](https://stackoverflow.com/a/8224389/529774)

```
- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];

    UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
    UIViewController *vc = [storyboard instantiateViewControllerWithIdentifier:@"Login"];
    [vc setModalPresentationStyle:UIModalPresentationFullScreen];

    [self presentModalViewController:vc animated:NO];
} 
```

但是通过这个由拆分视图的详细视图控制器调用的实现，底层拆分视图会在屏幕上短暂闪烁。

如果我从 viewDidAppear 更改为 viewWillAppear，则没有闪光灯 - 但即使屏幕旋转为横向，登录视图也会以纵向绘制。

正如我所说 - 这种有条件的登录显示似乎应该是常见且简单的，但我无法在任何地方找到一个简单的工作示例，它结合了拆分视图、故事板、旋转感知，并且可以防止 UI 闪烁。

有小费吗？指向良好工作示例的指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T15:09:58.847

我遇到了完全相同的问题，但经过大量搜索，杜安的回答给了我一些见解。他的答案仍然在以前的视图中闪烁，但我通过使用解决了这个问题：

```
-(void)viewWillAppear:(BOOL)animated {

    // Check if user is already logged in
    NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
    if ([[prefs objectForKey:@"log"] intValue] == 1) {
        self.view.hidden = YES;
    }
}

-(void)viewDidAppear:(BOOL)animated{
    [super viewDidAppear:animated];

    // Check if user is already logged in
    NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
    if ([[prefs objectForKey:@"log"] intValue] == 1) {
        [self performSegueWithIdentifier:@"homeSeg3" sender:self];
    }
}

-(void)viewDidUnload {
    self.view.hidden = NO;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:51:45.257

您必须先将 window.hidden 属性设置为 NO，然后才能添加子视图：

```
UITabBarController* tc = (UITabBarController*) self.window.rootViewController;

// Present the log in view controller
self.window.hidden = NO; // the window is initially hidden
[tc presentViewController:logInViewController animated:NO completion:NULL]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-10T05:01:07.343

这就是我在 SWIFT 中解决的方法

```
override func viewWillAppear(animated: Bool) {
    let prefs:NSUserDefaults = NSUserDefaults.standardUserDefaults()

    let isloggedIn = prefs.objectForKey("isLoggedIn") as? Bool
    if (isloggedIn != false) {
        self.view.hidden = true
    } else {
        self.view.hidden = false
    }
}

override func viewDidAppear(animated: Bool) {
    super.viewDidAppear(true)

    let prefs:NSUserDefaults = NSUserDefaults.standardUserDefaults()

    let isloggedIn = prefs.objectForKey("isLoggedIn") as? Bool
    if (isloggedIn != false) {
        println("this should work")
        self.performSegueWithIdentifier("Login", sender: self)
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-22T20:05:23.183

通过将第一个视图控制器呈现给用户作为登录屏幕，我能够做到这一点。然后有一个 segue 连接到下一个屏幕，带有 tabview 或 split view 或任何你想要的。

第一个控制器处理默认值和登录凭据，一旦全部检查和验证，就遵循 segue...否则它会向用户显示登录和/或错误并坐在那里。

# delphi - 哪些属性决定了 ClientDataSet 字段的大小？

> ID：10541853
> 
> 赞同：3
> 
> 时间：2012-05-10T20:43:35.640
> 
> 标签：delphi, tclientdataset

我有一个使用 ClientDataSets 和本地文件存储的应用程序。一些信息显示在数据库网格中，我发现它被截断了——显示了字符串的前 500 个字符左右，但基础字段需要更长。所以我回到我的代码并增加了底层 FieldDef 的大小以及它们的显示宽度。我还创建了一个新数据集（在设计时）。最后，我运行了应用程序，并创建了一个新数据库。然而，只显示了约 500 个字符。

我应该在哪里查看限制我的字段长度的因素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T00:01:46.990

我怀疑您遇到了`TDBGrid`列宽的内部限制，因为显示 500 个字符的列将超过典型的屏幕宽度。（如果您想浏览 VCL 源代码，可以选中此项；以 . 开头`Grids.pas`。）

通常， a`TDBGrid`不会在单个列中显示大量文本。它会导致用户大量滚动，而水平滚动阅读宽文本对大多数人来说非常烦人。

执行此操作的常用方法是使用`ftMemo`类型字段，它可以包含几乎无限的文本内容。当该列分配给 a`TDBGrid`时，网格列显示`(MEMO)`，并且应用程序处理单击或双击该列以显示带有 a 的辅助表单`TEdit`或`TRichEdit`显示/编辑该列的全部内容。

这是一个`TDBGrid`附加到`TClientDataSet`命名的示例，其中使用在对象检查器中`CDS`定义了以下列（无用，但是一个示例） ：`CDS.FieldDefs`

```
Column      Persistent Name    FieldType    Size
------      ---------------    ---------    ----
ID          CDSID              ftInteger     0
Name        CDSName            ftString     25
Notes       CDSNotes           ftMemo        0 
```

由于底层数据集不存在，我分配一个`FileName`, 并使用以下代码在运行时创建它：

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  if not FileExists(CDS.FileName) then
  begin
    CDS.CreateDataSet;
    CDS.Active := True;
    CDS.InsertRecord([1, 'John Smith', 'This is some longer text'#13'for testing.']);
    CDS.InsertRecord([2, 'Fred Jones', 'A note about Fred goes'#13'here for now.']);
    CDS.Active := False;
  end;
  CDS.Active := True;
end; 
```

我`TDataSource`在表格上放了一个，并将其设置`DataSource`为`CDS`. 我添加了一个`TDBGrid`，并将其设置`DataSet`为`DataSource1`.

在 Object Inspector 中，选择`TDBGrid`，转到 Events 选项卡，然后将以下内容添加到`OnCellClick`事件中（当然只是为了显示）：

```
procedure TForm1.DBGrid1CellClick(Column: TColumn);
begin
  if Column.FieldName := 'CDSNotes' then
    ShowMessage(Column.Field.AsString); // Display other form here instead
end; 
```

这是单击`CDSNotes`第 1 行的列后的显示`TDBGrid`：

![在此处输入图像描述](../Images/5d545b178cdf87570e0de579d095e1b5.png)

如果您*必须*在 中显示较长文本列的部分内容`TDBGrid`，您可以使用如下内容：

```
procedure TForm2.CDSNotesGetText(Sender: TField; var Text: string;
  DisplayText: Boolean);
begin
  // Again, a trivial example using an arbitrary chunk of the first 20
  // characters just for demo purposes.
  if DisplayText then
    Text := Copy(Sender.AsString, 1, 20)
  else
    // Not for display only; return all the text.
    Text := Sender.AsString;
end; 
```

使用上面的示例应用程序执行此操作会将显示更改为：

![在此处输入图像描述](../Images/126db80172d3301e5872c61fbf3c13f3.png)

# javascript - 当返回包装在回调中时，Meteor方法不返回返回值

> ID：10541857
> 
> 赞同：2
> 
> 时间：2012-05-10T20:44:15.023
> 
> 标签：javascript, meteor

当我将返回包装在回调中时，我无法让服务器 Meteor.method 返回成功的响应。

当不包含在回调中时，它工作正常。

它可以在包含在回调中和未包含在回调中时抛出新的 Meteor.errors。

以完全相同的方式在客户端包装 Meteor.call 可以正常工作。

但是，由于某种原因，在调用 return 时在服务器上执行此操作不会返回响应值。

这是一个例子。这不是我的确切代码，但非常接近。虽然非常接近。

```
Meteor.methods({
  insertData: insertData
});

function insertData(params){
 validateParams(params, function(bool, msg){
  if(bool){
    //do stuff, like insert records
    result = 'thanks a million gagillions';
    console.log(result);
    return result;
  } else {
    throw new Meteor.Error(513, msg);
  }
 });
}

validateParams(params, callback){
  for (var key in params) {
    value = params[key];
    if(_.isEmpty(value) || _.isUndefined(value) || _.isNull(value)) {
      callback(false, 'Please enter your "'+ key + '".'); 
      return;
    }
  }
  callback(true);
} 
```

我如何让它工作以便返回结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:57:33.200

您的问题是 return 语句属于您传递给的函数`validateParams`。它不属于`insertData`函数。

如果您拆分代码部分，您可以更好地看到这一点：

```
function insertFunc(bool, msg) {
  // do your work
  return result;
}

function insertData(params) {
  validateParams(params, insertFunc);
  // no return statement..
} 
```

您需要在以下位置传播回调的返回值`validateParams`：

```
validateParams(params, callback){
  for (var key in params) {
    value = params[key];
    if(_.isEmpty(value) || _.isUndefined(value) || _.isNull(value)) {
      return callback(false, 'Please enter your "'+ key + '".');  // <----- here
    }
  }
  return callback(true); // <---- and here
} 
```

然后`validateParams`在你的函数中返回结果：

```
function insertData(params){
  return validateParams(params, function(bool, msg) {
    // your code..
  });
} 
```

注意：抛出异常是有效的，因为这些异常会一直传播到到达 try/catch 块为止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T23:34:15.133

您在这里不需要回调。您可能会发现直线代码更具可读性。

```
Meteor.methods({
  insertData: insertData
});

function insertData(params){
  // run validator, allow exception to propagate
  validateParams(params);

  //do stuff, like insert records
  result = 'thanks a million gagillions';
  console.log(result);
  return result;
}

function validateParams(params){
  for (var key in params) {
    value = params[key];
    if(_.isEmpty(value) || _.isUndefined(value) || _.isNull(value))
      throw new Meteor.Error('Please enter your "'+ key + '".');
  }
  // not strictly necessary, just don't throw exception.
  return true;
} 
```

# python - Django South：数据迁移后添加模型字段

> ID：10541863
> 
> 赞同：2
> 
> 时间：2012-05-10T20:44:48.837
> 
> 标签：python, django, django-south

每当我`datamigration`使用 Django South 创建一个（但还没有运行它），然后创建一个`schemamigration`向该迁移中涉及的模型添加一个新字段时，`manage.py migrate`任务在`datamigration`.

这样做的原因是`models.py`文件的类定义包含一个`datamigration`无法识别的新字段定义。

有什么办法可以防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-11T14:49:01.357

在 South Datamigration 中，您应该直接引用您的模型。IE

```
from myapp.models import MyModel # <- This is bad in datamigration
MyModel.objects.filter(...) 
```

你必须使用 ORM 对象

```
orm.MyModel.objects.filter(...) <- This is good. 
```

# javascript - jquery/backbone/mustache/json 将 html 渲染为文本字符串

> ID：10541865
> 
> 赞同：6
> 
> 时间：2012-05-10T20:44:53.720
> 
> 标签：javascript, jquery, json, wordpress, backbone.js

太累了，我知道我以前见过这个，但谷歌并没有帮助我制作一个单页骨干驱动的 WP 主题。数据只是 wordpress JSON API 数据 & 我现在很高兴在几个项目中使用了主干，但这次它表现不佳.. 它正在这样做（显示 html 标签而不是.. 很好地使用它们）：

![在此处输入图像描述](../Images/ceed76bb779e372c54f0822012b81320.png)

这是渲染代码：

```
this.template = '<div class="post-list">{{#posts}}<article><h2>{{title}}</h2><span class="postcontent">{{content}}</span></article>{{/posts}}</div>';

            if(this.model.get("rawdata").posts!=undefined && this.model.get("rawdata").posts.length>0)
            {
                var posts = [];
                for(i=0;i<this.model.get("rawdata").posts.length;i++)
                {
                    posts[i] = new PostModel(this.model.get("rawdata").posts[i]);
                }
                this.postCollection = new PostCollection(posts);
                this.htm = Mustache.render(this.template,this.model.get("rawdata"));
                this.$el.empty().html(this.htm);
                log(this.htm)           
            }
            else
            {
                //handle no-data result error
            } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-10T20:58:26.803

尝试将 & 放在模板中的变量名之前

```
{{& posts}} 
```

或者

```
{{& title}} 
```

这一切都在[文档中](http://mustache.github.com/mustache.5.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-28T19:32:35.343

另一种选择是使用三重胡须：

```
{{{title}}} 
```

它也在[文档](http://mustache.github.com/mustache.5.html)中。此选项也适用于[Nustache](https://github.com/jdiamond/Nustache)。

# css - 如何制作水平布局 标签的 整个高度 ?

> ID：10541874
> 
> 赞同：0
> 
> 时间：2012-05-10T20:46:38.963
> 
> 标签：css

我`<dl>`在我的页面中显示标签列表。我希望`<dd>`标签在其内容足够长以超出`<dt>`.

什么CSS可以防止这种情况发生？

![包装问题示例](../Images/a8d5dcdbac5b419200671589d12a9dc6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:50:49.967

我会`margin-left`使用`<dd>`等于`<dt>`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T21:01:48.593

尝试设置`overflow: hidden`。`<dd>`

# syntax - 如何在我的 Razor 表达式中显示 &mdash

> ID：10541879
> 
> 赞同：2
> 
> 时间：2012-05-10T20:46:51.717
> 
> 标签：syntax, razor

我无法找出将 emdash 集成到 Razor 中的字符串的正确语法。这是想法：

```
@( string.IsNullOrEmpty(Model.DemandClassCode) ? string.Empty : Model.DemandClassCode &mdash; Model.DemandClassName) 
```

我在编辑器中收到 ReSharper 错误消息：

无法解析符号“mdash”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:03:49.240

Razor 自动对所有不是`HtmlString`.

`Html.Raw`如果您不想编码，请使用helper：

```
@Html.Raw(isValid ? "" : string.Format("{0} &mdash; {1}", @Model.Var1, @Model.Var2) ) 
```

或`HtmlString`显式创建：

```
@MvcHtmlString.Create(isValid ? "" : string.Format("{0} &mdash; {1}", @Model.Var1, @Model.Var2)) 
```

并使用您的新样品：

```
@Html.Raw(string.IsNullOrEmpty(Model.DemandClassCode) ? string.Empty : string.Format("{0} &mdash; {1}", Model.DemandClassCode, Model.DemandClassName)) 
```

或使用 if：

```
@if (string.IsNullOrEmpty(Model.DemandClassCode))
{
    @string.Empty
}
else
{
    <text>@Model.DemandClassCode &mdash; @Model.DemandClassName</text>
} 
```

# gitolite - 修复迁移的 Gitolite Repo 中的钩子和权限

> ID：10541886
> 
> 赞同：1
> 
> 时间：2012-05-10T20:47:32.207
> 
> 标签：gitolite

我有一个 gitolite pre-g2 存储库，我正在尝试使用 g3。

我复制了整个存储库文件夹，并从一个干净的 g3 conf 文件开始，并删除了所有 gl-perms 文件以获得一个干净的状态。我正在尝试使用每个 repo 权限启动并运行几个 repos。

具体来说，我有我的管理员访问密钥，可以克隆和推送存储库。这将 gitolite.conf 定义为：

```
@admin = nikolaj

repo @all
    RW+ = @admin 
```

然后对于个人回购，我确保我的名字（nikolaj）在 gl-creator 文件中，并删除了旧的 gl-perms 文件。

然后我尝试运行

```
ssh git@myserver perms my/repo 
```

我得到

```
FATAL: sorry you are not authorised 
```

非常感谢任何有关我如何进行调试的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T22:13:01.567

确保您遵循[迁移指南](http://sitaramc.github.com/gitolite/g2migr.html)并[预设了您的 gitolite.rc 文件](http://sitaramc.github.com/gitolite/g2migr.html#rc-preset)

> `ssh-authkeys`如果您在运行 gitolite setup 之前没有预设 rc（在这种情况下，通过注释掉 ' ' 行），您的`~/.ssh/authorized_keys`文件将被破坏。

在您的情况下，您确实获得了一个新的 gitolite.rc 文件，但仍然检查您 `~/.ssh/authorized_keys`是否仍然完好无损（使用强制命令`nikolaj`作为参数）

# java - Android - 精确的数学计算

> ID：10541888
> 
> 赞同：0
> 
> 时间：2012-05-10T20:47:46.033
> 
> 标签：java, android

我有一个问题，我正在开发一个应该能够进行一些数学计算的应用程序。这些计算必须准确（或者说没有明显错误）

但是这个简单的代码

```
double a = 3.048d;
double b = 1000d;

double c = a / b; 
```

给我一个错误的结果 c 不是预期的 0.003048 而是 0.0030480000000000004 这显然是错误的。

```
double d = 3.048 / 1000; 
```

这第二个代码片段给出了正确的结果。

我知道用计算机计算时所有浮点运算都不精确，但我不知道如何解决这个问题。

提前致谢！
路德维希

为：
- Android 2.2
测试设备开发：
- HTC Desire

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T20:52:29.767

您需要用于精确的 percision 是[BigDecimal](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html)对象：

```
BigDecimal a = new BigDecimal("3.048");
BigDecimal b = new BigDecimal(1000);

BigDecimal c = a.divide(b);

System.out.println(c); //0.003048 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:51:43.467

使用[BigDecimal](http://developer.android.com/reference/java/math/BigDecimal.html)进行精确的浮点计算。设置比例可以让您精确指定要输出多远。

```
import java.math.BigDecimal;

class Test{

        public static void main(String[] args){
                BigDecimal a = new BigDecimal("3.048");
                BigDecimal b = new BigDecimal(1000);
                BigDecimal c = a.divide(b).setScale(6);
                System.out.println(c); //0.003048
        }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:52:30.667

这是[IEEE 754 浮点表示](http://en.wikipedia.org/wiki/IEEE_754-2008)的结果，而不是错误。要处理它，请将您的结果四舍五入到适当的精度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T20:52:00.563

使用 BigDecimal 进行如此*精确*的分配。

顺便说一句， d 的结果显然是正确的，因为 double 具有无法存储结果的机器编码，您认为这是正确的。

# ruby-on-rails - 努力让两个模型建立关系。谁受苦？观点

> ID：10541889
> 
> 赞同：0
> 
> 时间：2012-05-10T20:47:51.417
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

我有一个为用户设置定时挑战的应用程序。每个用户都与一个或多个挑战相关联。我已经设置了模型，以便它们通过连接表连接。效果很好，但是我的视图级别有问题。在挑战的索引视图中，显示来自挑战模型和用户模型的数据。但是视图应该显示用户名的地方，它只是显示“用户”。如果您单击“用户”，您将被带到该用户的正确“显示”页面。所以链接工作正常，但我无法显示用户名。相反，我只是让类名出现。知道为什么吗？

这是视图的代码。下面的文件是views/challenges/index.html.erb

```
 <%- model_class = Challenge.new.class -%>
        <h1><%=t '.title', :default => model_class.model_name.human.pluralize %></h1>
        <table class="table table-striped">
          <thead>
            <tr>
              <th><%= model_class.human_attribute_name(:date) %></th>
              <th><%= model_class.human_attribute_name(:time) %></th>
              <th><%= model_class.human_attribute_name(:rider) %></th>
              <th><%=t '.actions', :default => t("helpers.actions") %></th>
            </tr>
          </thead>
          <tbody>
            <% @challenges.each do |challenge| %>
              <tr>
                <td><%= link_to challenge.date, challenge_path(challenge) %></td>
                <td><%= link_to challenge.duration, challenge_path(challenge) %></td>
                <td><%= link_to challenge.users.name, user_path(challenge) %></td>
              </tr>
            <% end %>
          </tbody>
        </table> 
```

这是相关的模型。挑战.rb

```
class Challenge < ActiveRecord::Base
  attr_accessible :date, :duration, :user

  has_many :user_challenges
  has_many :users, :through  => :user_challenges
  validates_presence_of :date, :duration

  def self.winner
    Challenge.find(:first, :order => "duration desc")
  end

end 
```

用户.rb

```
 class User < ActiveRecord::Base
    attr_accessible :name, :email

    has_many :user_challenges
    has_many :challenges, :through => :user_challenges

    validates_presence_of :name, :email
    validates_uniqueness_of :email

    def self.find_or_create(name, email)
      user = User.find_by_email(email)
      if user.present?
        user.challenge = challenge
        user.save
      else
        User.create(:name => name, :email => email)
      end
    end
  end 
```

加入表，又名 User_challenge.rb

```
class UserChallenge < ActiveRecord::Base
  belongs_to :challenge
  belongs_to :user
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:55:01.410

`challenge.users`是一个集合，`.name`是一个 ruby​​ 方法，它为您提供类的名称：

```
ruby-1.9.2-head :002 > Object.name
 => "Object" 
```

将属性称为其他名称（用户名）。

另外，什么时候可以（应该是哪个用户路径？）`user_path(challenge)`真的没有意义。`Challenge``have_many :users`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T15:07:03.337

我认为用户列表是空的，这就是 users.first.username 为 nil 的原因。user_path(challenge) '似乎' 像它的工作，但它可能总是把你带到 users/challenge_id 路径，这不是你想要的。

很可能某些东西没有为您正确保存。验证您的用户列表不为空。跳入控制台并测试数据的保存和重新加载

# sql - 分层查询 - 捕获路径的各个部分

> ID：10541893
> 
> 赞同：0
> 
> 时间：2012-05-10T20:48:12.887
> 
> 标签：sql, oracle, hierarchical-query

我在 Oracle 11g 中有一个分层查询，可以将所有叶节点从树中取出，而且效果很好。但是，当我遍历我的叶节点时，我需要尝试分别捕获路径的每个部分。有没有办法做到这一点？修改我的查询或第二个查询？

非常感谢任何帮助！

这是我的查询：

```
select c.id, 
   c.superid,
   c.name,
   SYS_CONNECT_BY_PATH(c.name, '>>') as PathName
from mytable c
where c.activestatus =0 AND
  c.id NOT IN(select distinct c2.superid from categorizations c2 where c2.superid IS NOT NULL)
start with c.superid IS NULL
connect by prior c.id = c.superid; 
```

所以目前我得到一个输出，如：id，superid，name1，>>name1>>name2>>name3>>name

哪个好。但我试图以某种方式捕获每个节点名称（因为我需要以 XML 格式输出它）。

所以现在我的每个叶节点的 XML 看起来像

```
<Node1>
  <Project>name</Project>
  <PathName>>name1>>name2>>name3>>name</PathName>
</Node1>. 
```

我希望能够以某种方式获得看起来像

```
<Node1>
 <Project>name1
   <Project>name2
      <Project>name3
         <Project>name</Project>
      </Project>
   </Project>
</Project>
<PathName>>name1>>name2>>name3>>name</PathName>
</Node1> 
```

....或类似的东西，基本上我希望能够将我的树层次结构输出到 XML。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T11:09:23.227

您可以使用`<project>`而不是`>>`预先添加另一个，然后使用`level`伪列在`</project>`每个级别附加一个

# mysql - 排序以使具有匹配列的行粘在一起

> ID：10541895
> 
> 赞同：0
> 
> 时间：2012-05-10T20:48:19.643
> 
> 标签：mysql, sorting

我有一个带有时间戳行的表：比如说，一些作者提供的信息：

```
CREATE TEMPORARY TABLE `feed` (
`id`           INT       UNSIGNED    NOT NULL    AUTO_INCREMENT    PRIMARY KEY,
`author`       VARCHAR(255)          NOT NULL,
`tm`           DATETIME              NOT NULL
); 
```

我想按`tm DESC`这样的方式排序，一个作者的行确实粘在一起。

例如，拥有

```
INSERT INTO `feed` VALUES
( 5, 'peter', NOW()+1 ),
( 4, 'helen', NOW()-1 ),
( 3, 'helen', NOW()-2 ),
( 2, 'peter', NOW()-10 ),
( 1, 'peter', NOW()-11 ); 
```

结果集应该按 排序`tm DESC`，但所有*peter*的帖子都排在第一位，因为他的帖子是最新的。下一组行应该来自`author`第二个最近的帖子。等等。

```
5 peter
2 peter
1 peter
3 helen
2 helen 
```

首先，我们按最近的帖子对作者进行降序排序。然后，有了这个“评级”，我们按照最近的帖子排序的作者对提要进行排序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T20:52:44.830

创建计算 Min Tm 的线视图，然后加入它。

```
SELECT f.* 
FROM   feed f 
       INNER JOIN (SELECT MAX(TM) MAXTM, 
                          author 
                   FROM   Feed 
                   GROUP  BY Author)m 
         ON f.author = m.author 
ORDER  BY m.MAXTM DESC, 
          f.author 
```

[演示](http://sqlfiddle.com/#!2/70d9a/13)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T20:53:56.813

你可以尝试这样的事情：

```
select * 
from feed
order by 
  (select max(tm) from feed f2 where f2.author = feed.author) desc, 
  tm desc 
```

这首先按作者最近发表的时间排序，然后按 tm.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:55:36.447

```
SELECT * 
FROM `feed` 
    LEFT JOIN (
        SELECT 
            @rownum:=@rownum+1 AS `rowid`,
            `author`,
            MAX(`tm`) AS `max_tm`
        FROM (SELECT @rownum:=0) r, `feed` 
        GROUP BY `author` 
        ORDER BY `max_tm` DESC
    ) `feedsort` ON(`feed`.`author` = `feedsort`.`author`) 
ORDER BY 
    `feedsort`.`rowid` ASC, 
    `feed`.`tm` DESC; 
```

这解决了问题，但我确信有更好的解决方案

# ubuntu - 无法在 TexMacs 中键入脱字符 (^) 来表示求幂

> ID：10541896
> 
> 赞同：-1
> 
> 时间：2012-05-10T20:48:24.733
> 
> 标签：ubuntu, emacs, tex, maxima

在 TexMacs（Ubuntu 12.04 64 位，Maxima 5.24.0）中，插入符号`^`不会打印在屏幕上。

它在所有其他程序中运行良好。

在 TeXMacs 中是否有另一种表示幂的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T22:31:39.480

当您说插入符号不打印时，不确定您的意思。我正在使用 TeXmacs 1.0.7.7 + Maxima 5.22.1 + Ubuntu 11.04，当我输入 2^n 时，我看到“2^n”显示为输入，排版形式（2 上标 n）作为输出. 所以我无法重现这个问题。

求幂的内部运算符是 Lisp 中的 MEXPT。您可以将其输入为?mexpt，例如?mexpt(2, n) 与2^n 相同。

# email - 将参数添加到 HTML 链接到电子邮件中的本地文件

> ID：10541897
> 
> 赞同：4
> 
> 时间：2012-05-10T20:48:26.227
> 
> 标签：email, arguments

有没有办法在电子邮件中向 file:/// 调用添加参数？理想情况下，我希望我的收件人能够单击一个链接，该链接将启动一个带有一些额外参数的程序。到目前为止，我知道我可以做一个 HTML 链接，`<a href="file:///C:/path/to/program.exe">ClickMe!</a>`但如果我尝试添加参数，它就找不到文件。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:53:01.500

通过 URL 传递查询参数的标准方法是使用问号，后跟键/值对，每个键/值对用 & 号分隔：

file:///C:/path/to/program.exe?a=b&c=d

我不知道浏览器是否会将这些查询参数传递给可执行文件。我相信这将取决于浏览器/操作系统的组合......

# windows-installer - 我可以配置 msi 安装程序以在安装前删除具有不同产品代码但相同升级代码的任何其他安装吗？

> ID：10541903
> 
> 赞同：1
> 
> 时间：2012-05-10T20:49:02.713
> 
> 标签：windows-installer

安装项目中的删除以前的版本属性对我来说不太适用。我希望 msi 也删除较新的版本。我可以编辑 msi 数据库以告诉它删除所有版本吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T05:27:57.843

看看[升级](http://msdn.microsoft.com/en-us/library/windows/desktop/aa372379%28v=vs.85%29.aspx)表。您可以控制从 VersionMin 和 VersionMax 字段中删除哪些版本。

# html - CSS/HTML 左右浮动？

> ID：10541904
> 
> 赞同：0
> 
> 时间：2012-05-10T20:49:04.557
> 
> 标签：html, css, alignment

我似乎不太清楚如何从我制作的 Photoshop 模型中制作 CSS。下图显示了我想要完成的任务。基本上，每个设计/修订块都是一个样式`<li>`标记，我想将标题浮动到左侧，将日期/时间浮动到右侧。此外，我希望一切都垂直对齐。

有任何想法吗？我尝试在 each 中使用一个表`<li>`，但这似乎不起作用（或者我做错了）。

想法？

![在此处输入图像描述](../Images/e579b95ab4e9781e92dd3d62fd7feca6.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T20:57:41.327

在 HTML 中：

```
<ul>
  <li>
      <span class="title">Design</span>
      <span class="date">2012 may 15</span>
  </li>
</ul> 
```

在 CSS 中：

```
li .title{
  float: left;
  display: block;
  width: 150px;
}
li .date{
  float: right;
  display: block;
  width: 50px;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-10T21:08:26.067

请看[这个 Fiddle](http://jsfiddle.net/zuul/2Yec6/)，应该是你想要做的！

**HTML**

```
<ul>
    <li>
        <a href="#" title="" class="clearfix">
            Design 1
            <span>May 6, 2012<br>11:34AM</span>
        </a>
    </li>
    <li>
        <a href="#" title=""class="clearfix">
            Revision 1
            <span>May 7, 2012<br>2:14AM</span>
        </a>
    </li>
</ul> 
```

**CSS**

```
body {
    background-color: #000;
    margin: 0;
    padding: 20px;
    font-family: sans-serif;
}
ul {
    list-style-type: none;
}
li {
    display: block;
    width: 240px;
    background-color: #212121;
    border: 1px solid #212121;
    border-top: 1px solid #444;
}
li a {
    padding: 10px;
    color: #fff;
    font-size: 18px;
    display: block;
    line-height: 24px;
    text-decoration: none;
}
li span {
    float: right;
    font-size: 10px;
    display: block;
    line-height: 12px;
    color: #999;
    text-align: right;
}

/* helpers */
.clearfix:before,
.clearfix:after  {
  content: '\0020';
  display: block;
  overflow: hidden;
  visibility: hidden;
  width: 0;
  height: 0;
}
.clearfix:after {
  clear: both;
}
.clearfix {
  zoom: 1;
} 
```

分析 CSS 以了解有关浮动和文档工作流程的更多信息！

阅读更多相关信息：

[CSS 浮点数](http://www.w3schools.com/cssref/pr_class_float.asp)

[文档流/视觉格式](http://www.w3.org/TR/CSS2/visuren.html)

**和打印屏幕：**

![在此处输入图像描述](../Images/de83fcd13853f73daa6dc174c5f2048b.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-10T20:58:37.613

我将创建两个宽度为 50% 的 div 标签并浮动到各自的侧面。所以我们的标记是。

```
<ul>
    <li>
        <div class="title">
            Title
        </div>
        <div class="date">
            May 10
        </div>
    </li>
</ul> 
```

然后我们只需使用以下 CSS 对其进行样式设置。

```
.title,
.date {
    width: 50%;
}

.title {
    float: left;
}

.date {
    float: right;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-10T20:59:59.893

你的问题标题就在现场:)

要做这样的事情，你可以使用该[`float`](http://reference.sitepoint.com/css/float)属性

使用以下标记：

```
<ul>
    <li>
        <div class="name">Design</div>
        <div class="time">01/01/2011</div>
    </li>
    <li>
        <div class="name">Revision</div>
        <div class="time">01/01/2012</div>
    </li>
<ul>​ 
```

和CSS：

```
.name{
    float:left;
}

.time{
    float:right;
}

li{
    clear:both;        
} 
```

这应该够了吧。

[这里的例子](http://jsfiddle.net/a4eXm/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-10T21:12:46.760

```
<!DOCTYPE html>

<html>
<head>
    <title>Page Title</title>
    <style type="text/css">

        p {
            margin: 0;
        }

        #revision_block li {
            height: 50px;
            width: 250px;
            background: url("path/to/your/background_image.jpg/png") top left no-repeat;
            display: block;
        }

        #revision_block li .title {
            font-size: 20px;
            padding-top: 13px;
            color: #eae; /*your color*/
            position: relative;
            float: left;
        }

        .date {
            text-align: right;
            float: right;
            padding-top: 7px;
        }

        .date p {
            border: 0;
            margin: 0;
            font-size: 12px;
            line-height: 18px;
            color: #eae; /*your color*/
        }

        .clearfix:after {
                content: ".";
                display: block;
                clear: both;
                visibility: hidden;
                line-height: 0;
                height: 0;
        }

        .clearfix {
                display: inline-block;
        }

        html[xmlns] .clearfix {
                display: block;
        }

        * html .clearfix {
                height: 1%;
        }

    </style>
</head>

<body>

    <ul id="revision_block">
        <li class="clearfix">
            <p class="title">Design 1</p>
            <div class="date">
                <p>May 6, 2012</p>
                <p>11:34</p>
            </div>
        </li>
        <li class="clearfix">
            <p class="title">Design 1</p>
            <div class="date">
                <p>May 6, 2012</p>
                <p>11:34</p>
            </div>
        </li>
    </ul>

</body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-10T20:56:45.317

如果你把每个元素都做成`<li>`一个块元素，然后在里面放两个`<div>`'s，一个向左浮动一个向右浮动呢？

```
<li style="dislpay:block;">
    <div style="float:left;">Design 1</div>
    </div style="float:right;">May 6, 2012</div>
</li> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-10T20:57:28.017

您仍然可以使用`<li>`标签。做这样的事情

```
<li>
    <div class='a'>
    </div>
    <div class='b'>
    </div>
</li> 
```

将 a 和 b 都向左浮动。如果需要，容器也是如此。请记住，这可能会迫使您指定宽度。如果没有，您可以使用 display:inline-block

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-10T21:00:50.450

你把标题`float: left;`和日期放在 上`float: right;`。一些例子：

```
<ul>
  <li>
    <h4>Design 1</h4>
    <date datetime="2012-05-06T11:34:00">May 6, 2012 <span>11:34 AM</span></date></li>
  </li>
  <li>
    <h4>Revision 1</h4>
    <date datetime="2012-05-07T14:14:00">May 7, 2012 <span>2:14 AM</span></date></li>
  </li>
</ul> 
```

现在你添加这个样式：

```
li h4
{
    float: left;
}
li date
{
    float: right;
} 
```

* * *

或者，如果您不想使用 HTML5（我不明白为什么不这样做）：

```
<ul>
  <li>
    <h4>Design 1</h4>
    <span class="date">May 6, 2012 <span>11:34 AM</span></span></li>
  </li>
  <li>
    <h4>Revision 1</h4>
    <span class="date">May 7, 2012 <span>2:14 AM</span></span></li>
  </li>
</ul> 
```

并在 CSS 中添加一个`.`before 。`date`

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-05-10T20:58:15.883

基本上，您希望`float`使用 container 为您的项目指定它们各自的方向`<div>'s`。然后设置左边项目的左边距和垂直对齐，右边项目的右边距和垂直对齐。

这是它的基础知识，我不能在我的手机上详细说明。我以后可能会编辑这个。

# php - 在 PHP $_Post 中从数组中获取数据

> ID：10541905
> 
> 赞同：-1
> 
> 时间：2012-05-10T20:49:05.663
> 
> 标签：php

假设我发送了一系列电子邮件。emails 是一个包含 john@test.com、tom@test.com、jerry@test.com....等的数组

从接收方我正在尝试检索电子邮件。

```
 foreach ($_POST['emails'] as $i => $value) {
    echo "emails[$i] is $value<br />";
    } 
```

这是正确的方法吗？对于 foreach 循环，它会迭代直到电子邮件数组中的所有数据完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:51:59.947

那是对的。不过，您可能可以使用更简单的循环：

```
foreach ($_POST['emails'] as $email) {
    echo $email, "<br>";
} 
```

一定要[清理你的输入](https://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php)！

* * *

如果您要调用电子邮件发送功能或其他功能，则可以使用[array_walk()](http://www.php.net/manual/en/function.array-walk.php)。

```
function send_mail($email){
    echo "Sending email to {$email}";
}

array_walk($_POST['emails'], 'send_mail');

# Sending email to john@test.com
# Sending email to tom@test.com
# Sending email to jerry@test.com
# ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T20:52:39.030

尝试

```
foreach ( $_POST ['emails'] as $value ) {
    echo $value , "<br />";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-10T20:55:21.127

只需使用 $value：

```
foreach($_POST['emails'] as $value) {
    echo "Email: {$value}\n";
} 
```

或者您也可以使用数组键来访问该值，但如果您不想编辑值，则没有意义：

```
foreach($_POST['emails'] as $key => $value) {
    echo "Email: " . $_POST['emails'][$key];
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-10T20:52:24.937

不，您很可能将这种语法用于关联数组，`$_POST['emails']`而不是关联数组。正确的方法是这样的：

```
foreach ($_POST['emails'] as $email) {
echo "Email: $email<br />";
} 
```

# git - 即使在 git rm 和 git checkout 之后，Git 忽略的文件也会被跟踪

> ID：10541906
> 
> 赞同：0
> 
> 时间：2012-05-10T20:49:09.053
> 
> 标签：git, version-control, gitx

Git 是一个令人敬畏的 SCM 野兽。然而，我对一个问题无休止地困惑。

我有一个配置文件，它在(via )上`.gitignore`的分支中而不是在`master`分支中。然而，在我的分支上，它已签出并工作了一段时间，文件正在以某种方式被跟踪，当我再次退出时，文件保留在我的仓库中，但对于我团队中的其他人来说消失了。我也跑了，作为最后的手段，我跑了：`origin``git show -- config/mongo.yml``origin/master``git rm``git checkout``origin/master``git rm --cached`

```
git update-index --assume-unchanged -- config/mongo.yml 
```

我已经多次使用它对忽略的文件产生了很好的效果，并且分支足够小可以重做。然而，这似乎不是解决办法。我真的很想知道这个“为什么”并理解这个问题，因为这是解决方案的 3/4！:)

我怎么能把它放在我的里面，然后在and`.gitignore`之后显示它？`git rm config/mongo.yml``git checkout origin/master -- config/mongo.yml`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T03:11:27.340

当事情很奇怪时我尝试过的事情：

*从 .gitignore 中删除*该文件并切换到没有该文件的提交（并且在 .gitignore 中没有它）。

`git ls-files --cached --ignored --exclude-standard`在我无法解释其行为的每个结帐中。不管怎样，我经常这样做。

`git log --all --decorate --oneline --graph path/to/your/cuckoo`, 显示文件的状态或内容发生变化的所有地方。你可以让 gitk 做同样的事情，调出一个新的视图。

此外，尝试克隆到相邻目录，它将硬链接除签出内容之外的所有内容，因此空间不是一个因素。这将为您提供一个原始的工作树，而不会丢失当前工作树的状态，您可以在那里进行试验并`git clean -dfx`随意清理任何混乱。

# jquery - 为什么返回的 json 包含一个“对象”标签

> ID：10541909
> 
> 赞同：0
> 
> 时间：2012-05-10T20:49:19.100
> 
> 标签：jquery, asp.net-web-api

我`ApiController`的是

```
public List<FileModel> Get(string foldername) 
```

在客户端，

```
function ListFiles(folder) {
    $.ajax({
        url: "/api/Files",
        data: "foldername=" + folder,
        type: "GET",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function (msg) {
            console.log("msg: ", msg);
            $('#Container').setTemplateURL('/Templates/files.htm', null, { filter_data: false });
            $('#Container').processTemplate(msg);
        }
    }); 
```

`console.log`检索到的节目`msg`是：

```
[Object { Extension=".pdf", FileName="Microsoft.Press.MCTS.Se...ing.Kit.Exam.70-503.pdf", FilePath="C:\inetpub\Examples\Fil...ing.Kit.Exam.70-503.pdf", more...}, 
Object { Extension=".pdf", FileName="Microsoft.Press.MCTS.Se...ing.Kit.Exam.70-515.pdf", FilePath="C:\inetpub\Examples\Fil...ing.Kit.Exam.70-515.pdf", more...}, 
Object { Extension=".pdf", FileName="Microsoft.Press.MCTS.Se...xam.70.516.May.2011.pdf", FilePath="C:\inetpub\Examples\Fil...xam.70.516.May.2011.pdf", more...}] 
```

而不是格式为

```
[{Extension=".pdf",...}, {...}, {...}] 
```

为什么我会得到所有这些额外的东西`Object`？我怎样才能删除它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:53:21.513

jQuery 会自动将 JSON 解析为 JavaScript 对象，所以不用担心。这就是`console.log()`打印对象的方式。

# tabs - 页面标签在必要时增加高度，但不降低

> ID：10541913
> 
> 赞同：0
> 
> 时间：2012-05-10T20:49:29.960
> 
> 标签：tabs, height, facebook-page

在我的 facebook 页面标签应用程序中，我有几个不同高度的不同页面。正如标题所说，页面在必要时会提高高度，但是当我返回不需要太多高度的页面时，窗口高度不会恢复到尽可能短的高度。这是它的外观：

[http://www.facebook.com/EasterIslandTraveling/app_167418876720611](http://www.facebook.com/EasterIslandTraveling/app_167418876720611)

“基本”页面是我指的高页面。

在 FB.init 之后我使用 FB.Canvas.setAutoGrow(); 这应该可以解决问题，对吗？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T06:15:31.567

您可以使用下面给出的代码来降低高度

```
<script src="//connect.facebook.net/en_US/all.js"></script>
<script type="text/javascript">
        window.fbAsyncInit = function()  {
            FB.init({ appId: 'YOUR APP ID', 
                status: true, 
                cookie: true,
                xfbml: true,
                oauth: true
            });

            FB.Canvas.setSize({ height: 600 }); // You can set height here..
        }
</script> 
```

这对我来说非常有效。让我知道它是否不起作用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T11:40:10.970

使用 FB.init() 时，必须先初始化 fb js 库。所以你必须在 window.fbAsyncInit 事件中包含 FB.init() 函数，如下所示：

```
window.fbAsyncInit = function()  {
            FB.init({ appId: 'FB APP ID', 
                status: true, 
                cookie: true,
                xfbml: true,
                oauth: true
            });

            FB.Canvas.setSize({ height: 700 });
        } 
```

您可以认为您正在编写文档就绪事件中的 javascript...

```
$(document).ready(function(){ /* Js Code */ }) 
```

# excel - 使用 VBA 在多列中查找值

> ID：10541919
> 
> 赞同：0
> 
> 时间：2012-05-10T20:49:51.503
> 
> 标签：excel, vba

我对 excel vba 比较陌生，但我正在寻找一些关于创建一个可以在工作簿中运行多个工作表的宏的建议。

我正在寻找的建议是取 3 列，我可以在这些列中找到某些值。其中一行在这 3 列中的每一列中都有一个值，可以将这些行与所有列标题一起保存到同一工作簿中的新工作表中。所以，如果我的工作簿中有 10 个工作表并运行宏，我最终需要 20 个工作表。

谁能帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T21:42:14.300

由于您是 VBA 新手，我给您一些代码。上帝知道我刚开始的时候得到了很多帮助。看一下这个。我不确定您将如何传递要查找的值，但这应该会给您一个良好的开端。

```
Sub find3_makesheet()

Dim strValue As String
Dim wks As Worksheet
Dim rng1 As Range, rng2 As Range, rng3 As Range

strValue = "myValue"

For Each wks In Worksheets

    With wks

        If Not .Columns(1).Find(strValue, lookat:=xlWhole) Is Nothing Then Set rng1 = .Columns(1).Find(strValue, lookat:=xlWhole)
        If Not .Columns(2).Find(strValue, lookat:=xlWhole) Is Nothing Then Set rng2 = .Columns(2).Find(strValue, lookat:=xlWhole)
        If Not .Columns(2).Find(strValue, lookat:=xlWhole) Is Nothing Then Set rng3 = .Columns(2).Find(strValue, lookat:=xlWhole)

        If Not rng1 Is Nothing And Not rng2 Is Nothing And Not rng3 Is Nothing Then
            ThisWorkbook.Worksheets.Add After:=Worksheets(Worksheets.Count)
            Set wksCopyTo = ActiveSheet
            .Rows(1).EntireRow.Copy wksCopyTo.Rows(1)
            rng1.EntireRow.Copy wksCopyTo.Rows(2)
            rng2.EntireRow.Copy wksCopyTo.Rows(3)
            rng3.EntireRow.Copy wksCopyTo.Rows(4)
        End If

    End With

    Set rng1 = Nothing
    Set rng2 = Nothing
    Set rng3 = Nothing
Next

End Sub 
```

# c# - 是否可以在 TimedOut 异常后重用套接字？

> ID：10541923
> 
> 赞同：0
> 
> 时间：2012-05-10T20:50:21.857
> 
> 标签：c#, multithreading, sockets, socket-timeout-exception

简而言之，是否可以在捕获 TimedOut 异常后重用套接字？我该怎么做？

**很长的故事：**

我有 2 个线程，都使用同一个套接字。一个正在向远程服务器发送数据包（我们称之为线程 A），而另一个（线程 B）正在侦听这些已发送数据包的确认数据包。当满足某些条件时，线程 A 将暂停（使用`Monitor.Wait`），等待 a`Monitor.Pulse`继续。当线程 B 收到一个数据包时，它调用`Monitor.Pulse`并且线程 A 继续做它的事情......

问题是数据包可能会丢失，线程 B 将无限期地等待一个不会接收到的数据包，而线程 A 正在等待一个脉冲。整个程序将“阻塞”。我的第一个想法是设置接收超时并捕获相关的异常。发生这种情况时，我调用`Monitor.Pulse`线程 A 可以继续，而线程 B 将继续等待另一个数据包。

但这不起作用。当异常被捕获时，套接字将关闭，当线程 A 尝试发送新数据包时应用程序将崩溃，因为它们使用的是同一个套接字。

如何防止这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-22T02:05:48.587

> 问题是数据包可能会丢失

不，他们不能。TCP 不会丢失数据包。如果您丢失了数据包，那么您的代码中有错误，或者发送者没有发送它们。这里还没有问题。

> 当异常被捕获时，套接字将关闭

不，不会的。*只有当你*关闭它时它才会关闭。

> 当线程 A 尝试发送新数据包时，应用程序将崩溃，因为它们使用的是同一个套接字。

仅当您在捕获超时异常时关闭套接字。所以不要那样做。

> 如何防止这种行为？

捕获超时异常时不要关闭套接字。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-30T23:45:18.613

TCP 数据包不会丢失（它们可以，但那是在一个完全不同的层上）。
如果出现通信错误，套接字将关闭。
但是，如果您使用的是 UDP 通信并且您选择了接收超时，那么您没有理由不能再试一次。

看看[这个](http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/51e3fb86-f0ec-4c6e-886e-ae2ac39c5997/)。
并[在此处阅读备注。](http://msdn.microsoft.com/en-us/library/ms145154.aspx)

# android - Android：进度条：三种状态

> ID：10541930
> 
> 赞同：1
> 
> 时间：2012-05-10T20:50:37.290
> 
> 标签：android

进度条可以有三个状态吗？

我知道如何设置二级状态，但没有三级状态。如何扩展进度条来处理它？

问候，塔塔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T22:38:38.873

查看[ProgressBar.java](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/widget/ProgressBar.java)中默认系统进度条的源代码表明，一次有两个条的硬编码限制......

对您来说最简单的方法可能是将进度条源复制到您的项目并自己添加另一个进度条。

由于已经存在辅助进度条，因此其他进度条不应构成任何额外困难的挑战（只需按照辅助进度条的示例）。

# ruby-on-rails - 部署到 Heroku 时遇到问题——包括日志

> ID：10541932
> 
> 赞同：0
> 
> 时间：2012-05-10T20:50:48.710
> 
> 标签：ruby-on-rails, postgresql, heroku

我在 Heroku 的 Bamboo 堆栈上运行 Rails 3.09 Ruby 1.92 应用程序。该应用程序在本地运行的生产模式下运行良好，没有问题。我正在尝试诊断为什么该应用程序无法在 Heroku 上运行。我收到 500 错误其他服务器错误。有没有人看到过类似日志中的内容？

这是我的日志...

[https://gist.github.com/2655795](https://gist.github.com/2655795)

更新：这是更新的日志：[https ://gist.github.com/2655991](https://gist.github.com/2655991)

更新：我在我的 production.rb 文件中启用了 config.whiny_nils = true ，现在我在 Heroku 上遇到了这个错误，但没有在我的生产环境中本地运行。我在本地使用 Postgres。

`G::Error: ERROR: null value in column "id" violates not-null constraint : INSERT INTO "sessions"`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T04:45:53.973

我打赌你是从 MySQL 迁移过来的。

您的表没有`sequence`, pg 使用什么而不是`autoincrement`. 不要使用 来创建表格的`id`列，而是`"id" integer NOT NULL,`使用`"id" serial,`。Postgres 会提到它正在为你创建一个序列，你可以`\d tablename`在命令行中运行来查看它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-10T22:06:39.223

登录 Heroku 并运行以下命令：

```
rake db:sessions:clear 
```

看起来您可能有旧的会话数据。

如果您以前没有这样做过，您可以通过运行以下命令登录到您的 Heroku 实例：

```
heroku run bash --app my_app 
```

# spring - 自动装配的 HTTPServletRequest bean 的 Spring AOP 和方面线程安全

> ID：10541934
> 
> 赞同：9
> 
> 时间：2012-05-10T20:50:52.153
> 
> 标签：spring, servlets, thread-safety, aop, spring-aop

我正在使用 Spring 3 AOP，并且我有一个方面需要访问 HttpServletRequest。它看起来像这样：

```
@Aspect
public class MyAspect {

    @Autowired
    private HttpServletRequest httpServletRequest;

    public void init() {
        // Do something once...
    }

    @Before("my pointcut here...")
    private void myMethod() {
        // I need the httpServletRequest...
    }

    @After("my pointcut here...")
    private void myOtherMethod() {
        // I need the httpServletRequest...
    }
} 
```

并且配置如下：

```
<bean id="myAspect" class="com.some.package.MyAspect" init-method="init" /> 
```

每个 IoC 容器是否只调用一次 init 方法，即使这是一个方面，并且 httpServletRequest 线程是否安全？如果不是，那么在执行建议期间获取它并使其成为线程安全的最佳方法是什么？如果可能的话，我宁愿不使用本地线程。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-10T20:56:17.530

> 每个 IoC 容器是否只调用一次 init 方法

**每个 bean 实例**调用一次。如果 bean 有一个单例范围（这也是方面的默认情况），它只会被调用一次。但是，您将无法访问`httpServletRequest`inside`init()`方法 - 还没有请求！

> httpServletRequest 线程是否安全

不是，但不要担心。这实际上比看起来要复杂得多。您正在将 HTTP servlet 请求（显然可以同时有多个请求）注入到单例对象中。注入哪一个？一个都没有（全部？）！Spring 创建了一些复杂的代理（称为*作用域代理*），每次访问注入的方法时，`httpServletRequest`它都会将它们委托给*当前*（线程）请求。通过这种方式，您可以安全地在多个线程中运行方面——每个线程都将针对不同的物理请求进行操作。

这整个行为在[*4.5.4.5 Scoped beans as dependencies*](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html#beans-factory-scopes-other-injection)中有详细描述：

> [...] 如果您想**将（例如）一个 HTTP 请求范围的 bean 注入到另一个 bean**中，您必须注入一个 AOP 代理来代替该范围的 bean。也就是说，您需要注入一个代理对象，该对象公开与作用域对象相同的公共接口，但也可以从相关作用域（例如，HTTP 请求）检索真实的目标对象，并将方法调用委托给真实对象.

关于`ThreadLocal`：

> 我不喜欢使用本地线程。

幸运的是 - Spring 正在为您使用一个。如果您了解如何工作 - Spring 将当前请求放入本地线程并在您访问代理`ThreadLocal`时委托给线程本地实例。`httpServletRequest`

# c++ - 在 CPP 中制作向量三元组的简单方法

> ID：10541936
> 
> 赞同：4
> 
> 时间：2012-05-10T20:50:54.827
> 
> 标签：c++, vector

在 CPP 中构造整数向量三元组的简单方法是什么？

即，而不是一对 2 ints ，

```
std::vector<std::pair<int, int> > vec; 
```

我希望将 3 个 int 捆绑在一起作为向量的一个元素。

我意识到一种方法是制作 2 个子嵌套对，但这种方法会变得混乱。我不了解 CPP 的所有细节，因此请推荐一种更简单的方法（如果有）。谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-10T20:53:29.797

`std::vector<std::tuple<int,int,int>> myvec;`

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-10T20:53:13.180

无需过度设计。

```
struct Triplet
{
  int  one_, two_, three_;
};

vector<Triplet> triplets; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-10T20:53:34.180

查看提升元组[http://www.boost.org/doc/libs/1_49_0/libs/tuple/doc/tuple_users_guide.html](http://www.boost.org/doc/libs/1_49_0/libs/tuple/doc/tuple_users_guide.html)

您可以轻松创建对、三重、四重、最多 n 个！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-10T20:53:57.193

在 C++11 中，有`std::array`，请参见[此处](http://en.cppreference.com/w/cpp/container/array)。在 C++03 中，我可能会定义一个 3 `int`s 的结构并制作一个向量。

# php - 删除表单标签和输入 cakephp 之间的换行符

> ID：10541939
> 
> 赞同：2
> 
> 时间：2012-05-10T20:51:17.410
> 
> 标签：php, cakephp, cakephp-1.3

cakephp 中的表单助手通常会生成这样的表单元素：

```
<div class="input text">
  <label for="Firstname">Firstname</label>
  <input type="text" id="Firstname" value="" class="test" name="Firstname"/>
</div> 
```

`<label>`但是是否可以删除介于 the和 the之间的换行符`<input>`以具有如下内容：

```
<div class="input text">
  <label for="Firstname">Firstname</label>    <input type="text" id="Firstname" value="" class="test" name="Firstname"/>
</div> 
```

请问有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-10T22:14:55.833

“换行符”不在 HTML 中，而是在默认的 CakePHP CSS 中。为了解决这个问题，我在我烘焙的 CakePHP 应用程序中添加了以下 CSS 规则：

```
label {
    display: inline;
    width: 20%;
    float: left;
}
input, textarea {
    width: 76%;
    clear: none;
}
form div.submit {
    clear: none;
    display: inline;
} 
```

这基本上内联了标签和输入，并为它们适当地设置了宽度（您可能想要更改应用程序的数字，具体取决于长度。）

让我知道这个是否奏效。您可以将这些行添加到 APP/webroot/css/cake.generic.css 的底部，或者根据需要添加新的 CSS 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T09:16:11.003

我同意@srs2012 的回答，但是有一种方法可以格式化表单助手的输出。

FormHelper::input() 动作的第二个参数也接受一个“格式”键。此键是元素顺序的格式模板。默认输入格式顺序为：

```
array('before', 'label', 'between', 'input', 'after', 'error') 
```

任何不在数组中的元素都不会出现在输出中。因此，如果您修改它并删除“between”键，它可能会起作用。

举个例子：

```
echo $this->Form->input('Model.name', array('format' => array('before', 'label', 'input', 'after', 'error'))); 
```

实际上，我在一个项目中只需要使用一次此设置。[它](http://api13.cakephp.org/class/form-helper#method-FormHelperinput)位于 CakePHP 1.3 API 中。试一试，看看你能想出什么。

# mysql - 我应该索引排序键字段与外键结合，还是单独（mysql）？

> ID：10541942
> 
> 赞同：0
> 
> 时间：2012-05-10T20:51:27.493
> 
> 标签：mysql, ruby-on-rails, sorting, indexing, foreign-keys

（这是在 Rails 应用程序中）

给定两个表：

```
items
id, int(11), primary key
name, varchar(30)

choices
id, int(11), primary key
item_id, int(11), foreign key
identifier, varchar(5)
name, varchar(30) 
```

大多数针对**选择**的查询将遵循以下原则：

```
SELECT identifier, name FROM choices WHERE item_id = n ORDER BY identifier; 
```

让我们假设我们都同意索引可以帮助排序性能（我知道我们都没有，没关系，但是对于这个问题，让我们假设）。

索引**选择**以同时获得搜索和排序好处的最佳方法是什么：

*   两个索引，**item_id**和**identifier各一个**

或者

*   **item_id**上的一个索引，标识符

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:58:15.303

1 个复合索引`item_id, identifier`将更适合您的查询，因为这样的索引将被覆盖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T21:03:57.387

You want the composite index. With the 2 separate indexes mysql would have to choose between using an index for filtering or an index for sorting (since MySQL only uses one index per table in a query). [More on how MySQL uses indexes when sorting](http://dev.mysql.com/doc/refman/5.0/en/order-by-optimization.html) (your case is one of the examples they give).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T11:55:39.383

Ive never use rails but isnt it possible to use B+Tree indexing item_id and identifier? there you would have fast queries, and sorted results too.**

# jquery - Jquery对话框模式未关闭

> ID：10541951
> 
> 赞同：9
> 
> 时间：2012-05-10T20:52:02.287
> 
> 标签：jquery, jquery-ui

单击“保存”或“取消”时，我有一个对话框模式没有关闭。我与[jQuery UI 的官方演示页面](http://jqueryui.com/demos/dialog/)进行了比较，似乎无法找到为什么这不起作用。

这是我所拥有的：

```
 $(function () {
            $("#DetailsWindow").dialog({
                autoOpen: false,
                resizable: false,
                height: 500,
                width: 600,
                modal: true,
                title: 'Appointment Details',
                buttons: {
                    "Save": function () {
                        $(this).dialog("close");
                    },
                    "Cancel": function () {
                        $(this).dialog("close");
                    }
                }
            });

            $('button').click(function () {
                $("#DetailsWindow").dialog("open");
            });
        }); 
```

HTML：

```
 <button>A button</button>
        <div id="DetailsWindow">
            <h3>Title</h3>
            <span>Some Text</span>
        </div> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-10T20:59:47.077

您的`$('button')`查询应该更具限制性，否则它会匹配`<button>`页面上的所有标签，包括 jQuery 对话框中的标签，从而导致它继续打开。

我建议在您的主按钮中添加一个类：

```
<button class="open-details">A button</button> 
```

然后将您的 JavaScript 更改为：

```
$('button.open-details').click(function() {
    $("#DetailsWindow").dialog("open");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T06:32:31.013

尝试使用：

```
 $(this).dialog('destroy').remove(); 
```

代替：

```
 $(this).dialog("close"); 
```

# gtfs - 如何通过api获取谷歌公交数据

> ID：10541958
> 
> 赞同：11
> 
> 时间：2012-05-10T20:52:31.330
> 
> 标签：gtfs

我正在做一个论文项目，以便`"integrated indoor / outdoor"`为移动设备（特别是 Iphone）做一个导航系统。

我需要有关公共交通的信息，直到几天前我才使用此服务：[http ://www.google.com/m/directions](http://www.google.com/m/directions)

但由于某种原因它不再起作用了。

我看到有 Google API 路线，但它们仅适用于步行、骑自行车、驾驶旅行模式，不适用于`"transit mode"`.

然后我看到 Google Transit 服务没有公共 API。

我想知道是否有“API”或“方式”从公共交通中提取数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T05:09:00.773

许多公共交通机构以通用交通信息规范 (GTFS) 格式提供其路线信息。事实上，这是公共交通机构用来向 Google 提交信息的格式。

[您可以在http://www.gtfs-data-exchange.com/](http://www.gtfs-data-exchange.com/)上搜索您选择的公交机构，或在[https://code.google.com/p/googletransitdatafeed/wiki/PublicFeeds](https://code.google.com/p/googletransitdatafeed/wiki/PublicFeeds)上查找。[您可以在https://developers.google.com/transit/gtfs/reference](https://developers.google.com/transit/gtfs/reference)找到有关 GTFS 的更多信息。

当然，您必须编写自己的代码来解析数据，可能会将其存储在数据库中，并确定从 A 点到 B 点的最佳路线。但您也不必突然担心别人的服务停止为你工作。（可能发生的最糟糕的事情是[http://www.gtfs-data-exchange.com/](http://www.gtfs-data-exchange.com/)消失了，在这种情况下，您需要找到另一种方法来使您的数据保持最新。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T01:13:55.023

并感谢您发布您的问题。我自己也在做一个类似的过境项目，我想回答你的问题，这里提供了最好的答案：

[https://stackoverflow.com/a/10083926/458811](https://stackoverflow.com/a/10083926/458811)

我希望我自己能提供一些原创的东西，但我正在尝试使用我所在城市提供的数据并自行开发一种算法，作为旅行计划者。这绝不是一件容易的事，但我想这就是优秀开发人员与平庸开发人员的区别。如果您有任何想法，请与我联系，我希望您在您的论文项目中取得好成绩。

小心。真挚地; 法亚兹

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-28T18:00:27.060

[Transitland](https://www.transit.land)平台汇总了来自世界各地数千家机构的交通数据（使用他们的 GTFS 和 GTFS 实时馈送），并提供了一系列 API 来支持您自己的应用程序。

现在开始的最佳 API 是[Transitland v2 REST API](https://www.transit.land/documentation/rest-api/)。根据您的需要，您可能还想查看[其他 API](https://www.transit.land/documentation/index#comparing-the-apis)。

正如其他答案也提到的那样，您还可以选择自己下载和解析 GTFS 提要。这并不难做到，但问题通常是您的应用程序将使用一个 GTFS 提要、数十个还是数百个——您需要的代理和提要越多，使用 Transitland API 之类的服务可能会获得更多好处。

下载 GTFS 提要的来源：

1.  [Transitland 的提要列表](https://www.transit.land/feeds/)（单击以下载任何提要版本）
2.  [OpenMobilityData](https://openmobilitydata.org/)（以前称为 TransitFeeds.com） - 很快就会被弃用，但仍有大量供稿可供下载
3.  直接访问运输代理网站并从中下载

# android - Android sqlite 删除和插入行

> ID：10541961
> 
> 赞同：0
> 
> 时间：2012-05-10T20:52:48.500
> 
> 标签：android, sqlite

我无法使用 SQLite 数据库管理我的应用程序。

以下是我希望应用程序运行的方式以及 SQLite Db 的外观。

当您第一次启动它时，它会根据一些起始对象放入三行数据。

Id_1 “鲍勃” Id_2 “比尔” Id_3 “史蒂夫”

在使用应用程序的不同时间点，用户可以选择添加新行。

删除（鲍勃）Id_1“鲍勃”Id_2“比尔”Id_3“史蒂夫”Id_4“托尼”

此外，用户可以根据对象的名称删除一行。

删除（鲍勃）Id_1“比尔”Id_2“史蒂夫”Id_3“托尼

当我只使用 Adapter 类删除行（或所有行）然后尝试插入新行时，它会删除该行并且其他行不会填补该空白。我该如何填写？

我是否需要找到该行，然后用下一行中的值更新该行并重复该行，直到我将它们全部移下？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-11T00:38:39.633

如果您对活动游标中的数据进行了数据库更改，只需使用 requery 方法，您的列表将与游标一起刷新。

```
yourCursor.requery(); 
```

希望这可以帮助！

# mainframe - 什么是 MVS 和 JCL？

> ID：10541962
> 
> 赞同：6
> 
> 时间：2012-05-10T20:52:50.213
> 
> 标签：mainframe, jcl, mvs

有人知道 MVS 和 JCL 吗？

是否可以向我解释 MVS 是什么？JCL 是用来做什么的？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-11T00:12:13.523

我相信您指的是[MVS](http://en.wikipedia.org/wiki/MVS)和[JCL](http://en.wikipedia.org/wiki/Job_Control_Language)。

**MVS**是 IBM 大型机系统的操作系统，而**JCL**是大型机的作业控制语言。例如，您可以将**MVS**关联到 Linux，将**JCL**关联到 Bash。

AS/400 / iSeries / IBM i / i5 被认为是中端机器。它的操作系统称为 OS/400 或最近的 i5/OS。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-11T21:10:13.103

稍微扩展一下 MVS 的名称：

MVS 在 1970 年代后期被添加到 OS/VS2 操作系统的名称中。它代表多个虚拟存储，指出在一台机器上使用虚拟存储概念运行许多任务的能力。最终 OS/VS2 被放弃了。

MVS 在 MVS/370、MVS/XA（eXtended Architecture，31 位）和 MVS/ESA（Enterprise Systems Architecture，数据空间）时期一直沿用此名称，直到 1990 年代中期操作系统更名为 OS /390，在 2000 年代初得到了 z/OS 的 64 位支持，该名称至今仍在使用。但是，在 IBM 文档中，核心操作系统组件仍称为 MVS。

有许多很好的 Internet 参考资料扩展了 IBM System/360 和后续操作系统的历史。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-14T15:15:26.243

对于 JCL 作业控制语言

用于

*   编译COBOL、C..等
*   排序数据集
*   创建 VSAM，生成数据集
*   连接
*   格式 INREC OUTREC..

它是一种真正通用的语言，可以控制您在大型机上可以执行的所有操作。

例如：使用 icetool 和 idcams 检查数据集是否为空，并使用 icetool 计算行数

```
000100 //CHKEMPTY JOB 12345,                                                  
000110 //         'CHECK EMPTY',                                              
000120 //         CLASS=A,                                                    
000130 //         NOTIFY=&SYSUID                                              
000200 //*                                    
000210 // SET USER=YOURUSERNAME               
000220 //* SELECT THE CC RETURN FOR ACTION                                                                                 
000300 //*****************************************************         
000400 //*1 CHKEMP ICETOOL 2 COUNT ICETOOL 3 CHKEMP IDCAMS             
000600 //*****************************************************       
000610 //STEPSET  EXEC PGM=IDCAMS                                             
000620 //SYSPRINT DD SYSOUT=*                                                 
000630 //SYSOUT   DD SYSOUT=*                                                 
000640 //SYSIN    DD *                                                        
000650  SET MAXCC=2         <----SELECT OPTION YOU WANT TO TEST                                                    
000660 /*                                                                    
000670 //*                                                                    
000680 //*********************************************************************   
000690 //* CHECK EMPTY WITH MAXCC=12 ICETOOL                                 
000691 //*********************************************************************   
000692 //*                                                                    
000700 //STEP0001 EXEC PGM=ICETOOL,COND=(1,NE,STEPSET)                        
000900 //IN       DD DSN=&USER..EMPTYDS,DISP=SHR      <--- EMPTY DS FOR TEST                    
001010 //TOOLMSG  DD SYSOUT=*                                                 
001100 //DFSMSG   DD SYSOUT=*                                                 
001110 //TOOLIN   DD DATA                                                     
001200  COUNT FROM(IN) EMPTY
001300 /*                                                                      
001301 //*                                                                     
001302 //*********************************************************************    
001303 //* COUNT LINES WITH ICETOOL                                            
001304 //*********************************************************************     
001305 //*                                                                     
001306 //STEP0002 EXEC PGM=ICETOOL,COND=(2,NE,STEPSET)                         
001307 //TOOLMSG  DD SYSOUT=*                <--- CONTAINS RECORD DATA         
001308 //DFSMSG   DD SYSOUT=*                                                  
001309 //IN       DD DSN=&USER..COBOL(CBLPGM),DISP=SHR               
001310 //TOOLIN   DD DATA                                                      
001311  COUNT FROM(IN)                                                         
001312 /*                                                                      
001313 //*                                                                     
001314 //****************************************************       
001315 //* CHECK EMPTY FILES USING IDCAMS   MAXCC=4 EMPTY                                   
001316 //****************************************************       
001317 //*                                                                     
001318 //STEP0003 EXEC PGM=IDCAMS,COND=(3,NE,STEPSET)                          
001319 //IN       DD DSN=&USER..EMPTYDS,DISP=SHR      <---- EMPTY DS FOR TEST                     
001320 //SYSPRINT DD SYSOUT=*                                                  
001330 //SYSIN    DD DATA                                                      
001340  PRINT INFILE(IN) COUNT(1)                                              
001350 /* 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-18T16:13:47.013

**MVS**是操作系统，有多种方式与操作系统交互。与 Windows 或 Linux 一样，一种方法是通过命令行。PC 型操作系统将其称为“终端”。在 MVS 上，它称为控制台。（不过，我不会在这里深入研究不同类型的控制台。）

另一种方法是通过脚本。 **CLIST**是 Command List 的简写，是 TSO（分时选项）中可用的一种较旧的脚本语言，它是一种交互式请求/响应类型的对话，它是更加用户友好的交互式系统生产力工具（也称为 ISPF）的基础。如今，**REXX**是 MVS 系统程序员中最流行的脚本语言。但近年来，**Python**等新的编程语言也已移植到大型机平台，并且可以像在非大型机平台上使用一样使用。

与操作系统交互的另一种方式是通过批处理作业。在这里，作业控制语言**JCL**发挥作用。它是一种特殊的语言，可用于描述批处理作业的一个（或多个）任务、其输入、要执行的实际程序及其输出。

JCL 作为一种告诉 Job Entry Subsystem **JES**需要什么资源的方法。另一方面，JES 确保这些资源可用（=已分配），以便作业可以成功运行。当所有资源都可用时，JES 启动作业，现在操作系统的任务是为其查找计算资源（CPU、内存、I/O）。此时，作业只是系统上运行的另一个进程。最后，当作业完成时，JES 处理其输出。它是怎么知道的？好吧，通过JCL。JCL 指定如何处理输出，是否应将其存储在数据集中，是否打印，或者例如是否保留在称为*SPOOL的内存池中*（同时在线外围操作）直到被用户或操作员清除。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-24T23:19:12.087

实际上是“多个虚拟存储”。与早期版本的操作系统相反，“单一虚拟存储”。

区别在于每个作业是否有一个地址空间（今天的标准）或所有作业共享一个地址空间（计算机带有地址重定位硬件之前的标准）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-10T08:19:33.727

JCL - 它是一种作业控制语言，用于控制要运行的程序。

MVS - 多虚拟存储系统。

# playframework - StackOverflowError 因为 Play 版本 2.0.1 中的“conf/routes”文件很大

> ID：10541967
> 
> 赞同：2
> 
> 时间：2012-05-10T20:53:22.103
> 
> 标签：playframework, playframework-2.0

在我的项目中，我希望有干净的 URL。因此，我在 conf/routes 中创建条目，例如：

```
GET   /switzerland  controllers.Application.country(countryCode = "CH")
GET   /germany      controllers.Application.country(countryCode = "DE")
...
GET   /:countryCode  controllers.Application.country(countryCode: String) 
```

我的列表有 130 多个条目，并创建了 StackOverflowError。非常感谢有关如何防止错误的任何帮助。也许这个问题还有一个更优雅的解决方案。

Java 版本：

```
java version "1.6.0_31"
Java(TM) SE Runtime Environment (build 1.6.0_31-b04-415-11M3646)
Java HotSpot(TM) 64-Bit Server VM (build 20.6-b01-415, mixed mode) 
```

非常感谢您的帮助！

我创建了一个小示例项目，以重现它（至少在我的 Mac 上）： [https ://github.com/sunsations/play_2.0.1_routes_stackoverflowerror](https://github.com/sunsations/play_2.0.1_routes_stackoverflowerror)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-11T07:36:46.717

确实，问题发生了，所以我认为更好的地方是[Play's Lighthouse](https://play.lighthouseapp.com/projects/82401-play-20/overview)

同时，您可以使用 ONE 路线快速轻松地解决它：

```
GET   /:countryName    controllers.Application.country(countryName : String) 
```

然后在`country()`行动中，您可以`countryCode`从由 String 标识的 DB中获取`countryName`

编辑：

顺便说一句，使用这种方法会更容易使用 UTF 链接，即`domain.tld/Росси́я`，而不是`domain.tld/Russia`

# php - 更新 MySQL 语法错误

> ID：10541968
> 
> 赞同：1
> 
> 时间：2012-05-10T20:53:26.027
> 
> 标签：php, mysql, sql-update

运行以下查询时出现 SQl 语法错误，但看不到它有什么问题：

```
$query = "UPDATE combined SET v_categories_name_1_1='Hoodie', 
v_attribute_options_id_1=1, v_attribute_values_id_1_1=1, v_attribute_values_id_1_2=2, 
v_attribute_values_id_1_3=3, v_attribute_values_id_1_4=4, 
v_attribute_values_price_1_1=0, v_attribute_values_price_1_2=0, 
v_attribute_values_price_1_3=0, v_attribute_values_price_1_4=0, 
v_attribute_options_name_1_1='Size', v_attribute_values_name_1_1_1='Small', 
v_attribute_values_name_1_2_1='Medium', v_attribute_values_name_1_3_1='Large', 
v_attribute_values_name_1_4_1='Extra Large') " .
"WHERE v_products_model='$fileName'"; 
```

这是错误：

您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 ') WHERE v_products_model=hs_3stm_giantsk.jpg' 附近使用正确的语法

更新：

感谢大家的超快速回复，它解决了我的问题，但不幸的是我不能再接受 9 分钟！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-10T21:01:05.557

尝试格式化您的查询；问题变得更加明显：

```
$query = "
    UPDATE combined SET 
        v_categories_name_1_1='Hoodie', 
        v_attribute_options_id_1=1,
        v_attribute_values_id_1_1=1,
        v_attribute_values_id_1_2=2, 
        v_attribute_values_id_1_3=3, 
        v_attribute_values_id_1_4=4, 
        v_attribute_values_price_1_1=0, 
        v_attribute_values_price_1_2=0, 
        v_attribute_values_price_1_3=0,
        v_attribute_values_price_1_4=0, 
        v_attribute_options_name_1_1='Size',
        v_attribute_values_name_1_1_1='Small', 
        v_attribute_values_name_1_2_1='Medium', 
        v_attribute_values_name_1_3_1='Large', 
        v_attribute_values_name_1_4_1='Extra Large')
    WHERE v_products_model='$fileName'
"; 
```

当您不只是查看一大块文本时，更容易注意到这个糟糕的括号。你（希望）永远不会那样写 PHP，那么为什么要那样写你的 SQL 呢？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-10T20:55:33.750

你关闭了你从未打开过的括号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T20:55:40.703

`)`在最后一行之前，您在行尾有一个奇数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-10T20:56:29.513

有一个符号`)`无缘无故出现:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-10T20:57:00.433

尝试这个

```
$query = "UPDATE combined SET v_categories_name_1_1='Hoodie', 
v_attribute_options_id_1=1, v_attribute_values_id_1_1=1, v_attribute_values_id_1_2=2, 
v_attribute_values_id_1_3=3, v_attribute_values_id_1_4=4, 
v_attribute_values_price_1_1=0, v_attribute_values_price_1_2=0, 
v_attribute_values_price_1_3=0, v_attribute_values_price_1_4=0, 
v_attribute_options_name_1_1='Size', v_attribute_values_name_1_1_1='Small', 
v_attribute_values_name_1_2_1='Medium', v_attribute_values_name_1_3_1='Large', 
v_attribute_values_name_1_4_1='Extra Large' " .
"WHERE v_products_model='$fileName'"; 
```

我删除了括号 before`WHERE`子句。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-10T20:58:16.380

此处没有开口的封闭支架

```
='Extra Large') 
```

# c - 在另一个结构中具有灵活数组成员的结构

> ID：10541976
> 
> 赞同：3
> 
> 时间：2012-05-10T20:54:00.120
> 
> 标签：c, flexible-array-member

下面的代码是否有效？

```
struct foo {
    int a;
    int b[];
};

struct bar {
    int c;
    struct foo d;
};

struct bar *x = malloc(sizeof(struct bar) + sizeof(int [128])); 
```

对我来说似乎没问题，但我有点怀疑，因为如果我这样做编译器不会抱怨：

```
struct bar {
    struct foo d;
    int c;
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-10T21:04:47.953

这不好。第 6.7.2.1 节（在 n1570 中）第 3 点说

> 3 结构或联合不应包含不完整或函数类型的成员（因此，结构不应包含自身的实例，但可能包含指向自身实例的指针），除了结构的最后一个成员具有更多一个命名成员可能具有不完整的数组类型；这样的结构（以及任何可能递归地包含此类结构的成员的联合）不应是结构的成员或数组的元素。

因此`struct`，具有灵活数组成员的 a 可能不是另一个结构的一部分。

（不过，如果编译器接受它，它也可以作为结构的最后一个成员。）

# regex - 正则表达式检查 Sku

> ID：10541977
> 
> 赞同：0
> 
> 时间：2012-05-10T20:54:04.340
> 
> 标签：regex

如果 sku 中有 OL，我需要将 has_online 设置为 true，如果 sku 中有 WB，我需要将 has_WB 设置为 tru，如果 sku 没有 WB 或 OL 但其他匹配，我需要将 has_classroom 设置为 true

```
if (preg_match('/^[0-9]{8}OL/', $sku))       $has_online      = true;
if (preg_match('/^[0-9]{8}WB/', $sku))       $has_WB          = true;
if (preg_match('/^[0-9]{8}[A-Z]{2}/', $sku)) $has_classroom   = true; 
```

我在 has_classroom 部分遇到问题。当它是 OL 或 WB 课程时，它也会设置 has_classroom。

Sku 的格式如下：

```
20120531TXCP
20120531OLCP
20120531WBCP
20120531FLAO
20120531NVAR 
```

我像这样重做了，但对它不满意。

```
$wb_course = preg_match('/^[0-9]{8}WB/', $sku);
$ol_course = preg_match('/^[0-9]{8}OL/', $sku);
if ($ol_course)                                 $has_online      = true;
if ($wb_course)                                 $has_WB          = true;
if (preg_match('/^[0-9]{8}[A-Z]{2}/', $sku) 
    && !$wb_course 
    && !$ol_course)                             $has_classroom   = true; 
```

任何可以帮助我正确实现这一点的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T20:57:52.193

试试别的如果？

```
 if (preg_match('/^[0-9]{8}OL/', $sku))       $has_online      = true;   
  else if (preg_match('/^[0-9]{8}WB/', $sku))       $has_WB     = true;   
  else if (preg_match('/^[0-9]{8}[A-Z]{2}/', $sku)) $has_classroom   = true; 
```

# javascript - 使用 javascript 插入具有冲突 ID 的 SVG

> ID：10541981
> 
> 赞同：2
> 
> 时间：2012-05-10T20:54:42.017
> 
> 标签：javascript, ajax, dom, svg

使用 javascript 插入到文档中的 SVG 看起来像乱码，因为它们内部的符号具有冲突的 ID。例如，这两个不同的 svg 文件

[http://filebin.ca/1LMtJr5zc2x/svg1.svg](http://filebin.ca/1LMtJr5zc2x/svg1.svg)

[http://filebin.ca/1LN9F5ZPIbH/svg2.svg](http://filebin.ca/1LN9F5ZPIbH/svg2.svg)

当使用 javascript* 插入文档时，其中一个看起来是错误的（在我的情况下，a 变成了 x）。如果您使用文本编辑器打开 SVG 文件，您会看到它们都有这样的一行

```
<symbol overflow="visible" id="glyph0-0"> 
```

所以我猜浏览器会看到第二个 svg 引用“glyph0-0”并使用第一个 svg 定义的*那个*。有没有办法告诉浏览器“在 <svg> 中定义的符号只在那里重要”？就像限制符号的范围一样。

<img> 指向这两个文件的标签没有这个问题。但是我没有使用该解决方案，因为这样服务器将不得不保留一堆文件并跟踪它们何时可以被丢弃。使用我当前的解决方案，浏览器在内存中有 SVG，当窗口关闭时它们就消失了。

*使用 XMLHttpRequest，我获取一个动态生成的 SVG 文件，克隆根 <svg> 标记并将其附加到文档中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T00:21:13.133

ID 对文档始终是全局的，根据 HTML 规范，非唯一 ID 被视为无效。如果您需要两个符号具有相同的 id，请尝试使用“class”而不是“id”。您还可以对 SVG 字符串进行一些正则表达式预处理以调整 ID，使其独一无二。

# python - 链接 z3c 表单

> ID：10541983
> 
> 赞同：3
> 
> 时间：2012-05-10T20:54:51.900
> 
> 标签：python, forms, plone, z3c.form

我希望能够在 Plone 中一个接一个地链接多个 z3c 表单。例如，一旦 form#1 完成处理并完成错误检查，它会将结果（最好通过 GET 变量）传递给 form#2，而后者又对 form#3 等做同样的事情......我也想成为能够对所有表单使用相同的 URL。

我当前的实现是有一个浏览器视图，然后分派适当的表单，即 DispatcherView 检查 self.request 变量，然后确定要调用 form#1、form#2、form#3 中的哪一个。

我有这段代码，但似乎 z3c 表单被抽象为对 BrowserView 的多次调用，并且试图从它触发对 z3c.form 的多次调用会干扰后者的处理。例如，当用户按下“提交”按钮一次，表单#1 的错误检查发生，当我尝试下面示例中的解决方案时，表单#2 返回显示所有必填字段不正确，这意味着表单#2 接收来自表格#1。我试图从不同的地方触发表单#2，例如 DispatcherView(BrowserView) **call** () 方法，表单#1 的**call** () 方法，还有后者的 update() 和 render() 但所有这些覆盖都会导致同样的问题。

搭载连续呼叫的合适位置在哪里，这样这个东西就可以工作了，还是我需要创建单独的页面并使用 self.request.RESPONSE.redicrect 明确地相互重定向？

```
from Products.Five import BrowserView
from zope import interface, schema
from z3c.form import form, field, group, button
from zope.schema.vocabulary import SimpleVocabulary, SimpleTerm

countries = SimpleVocabulary([SimpleTerm(value="not_selected", title=_("Chose your region")),
                            SimpleTerm(value="canada", title=_("Canada")),
                            SimpleTerm(value="us", title=_("United States")),
                            SimpleTerm(value="belgium", title=_("Belgium"))])
products =  SimpleVocabulary([SimpleTerm(value="product1", title=_("Product1")),
                            SimpleTerm(value="product2", title=_("Product2")),
                            SimpleTerm(value="product3", title=_("Product2"))
                            ])
class DispatcherView(BrowserView):
    def __call__(self):
        if 'form.widgets.region' in self.request.keys():
            step2 = Step2(self.context, self.request)
            return step2.__call__()
        else:
            step1 = Step1(self.context, self.request)
            return step1.__call__() 
    def update(self):
        pass

class IStep1(interface.Interface):
    region = schema.Choice(title=_("Select your region"),
                        vocabulary=countries, required=True,
                        default="not_selected")
class IStep2(interface.Interface):
    product = schema.Choice(title=_("Pick a product"),
                        vocabulary=products, required=True)

class Step1(form.Form):
    fields = field.Fields(IStep1)
    def __init__(self,context, request):
        self.ignoreContext = True
        super(self.__class__, self).__init__(context, request)
    def update(self):
        super(self.__class__, self).update()
    @button.buttonAndHandler(u'Next >>')
    def handleNext(self, action):
        data, errors = self.extractData()
        if errors:
            print "Error occured"

class Step2(form.Form):
    fields = field.Fields(IStep2)
    def __init__(self,context, request):
        self.ignoreContext = True
        super(self.__class__, self).__init__(context, request)
    def update(self):
        super(self.__class__, self).update()
    @button.buttonAndHandler(_('<< Previous'))
    def handleBack(self, action):
        data, errors = self.extractData()
        if errors:
            print "Error occured"
            #handle input errors here

    @button.buttonAndHandler(_('Next >>'))
    def handleNext(self, action):
        data, errors = self.extractData()
        if errors:
            print "Error occured" 
```

**编辑：** Cris Ewing 对此给出了答案，下面是示例代码在使用collective.z3cformwizard 重写后的样子：

```
from zope import schema, interface
from zope.interface import implements
from z3c.form import field, form
from collective.z3cform.wizard import wizard
from plone.z3cform.fieldsets import group
from plone.z3cform.layout import FormWrapper
from Products.statusmessages.interfaces import IStatusMessage
from Products.statusmessages.adapter import _decodeCookieValue

from zope.schema.vocabulary import SimpleVocabulary, SimpleTerm
from z3c.form.browser.checkbox import CheckBoxFieldWidget

from Products.Five import BrowserView

countries = SimpleVocabulary([SimpleTerm(value="not_selected", title=_("Chose your region")),
                            SimpleTerm(value="belgium", title=_("Belgium")),
                            SimpleTerm(value="canada", title=_("Canada")),
                            SimpleTerm(value="us", title=_("United States")),
                            ])
products = SimpleVocabulary([SimpleTerm(value="product1", title=_("Product1")),
                            SimpleTerm(value="product2", title=_("Product2")),
                            SimpleTerm(value="product3", title=_("Product3")),
                            SimpleTerm(value="product4", title=_("Product4")),
                            SimpleTerm(value="product5", title=_("Product5"))
                            ])
class Step1(wizard.Step):
    prefix = 'one'
    fields = field.Fields(schema.Choice(__name__="region",
                                title=_("Select your region"), vocabulary=countries,
                                required=True, default="not_selected")
                        )
class Step2(wizard.Step):
    prefix = 'two'
    fields = field.Fields(schema.List(__name__="product",
                                value_type=schema.Choice(
                                    title=_("Select your product"),
                                    vocabulary=products),
                                    required=True
                                    )
                        )
    for fv in fields.values():
        fv.widgetFactory = CheckBoxFieldWidget

class WizardForm(wizard.Wizard):
    label= _("Find Product")
    steps = Step1, Step2
    def finish(self):
        ##check answer here
        import pdb; pdb.set_trace()

class DispatcherView(FormWrapper):
    form = WizardForm
    def __init__(self, context, request):
        FormWrapper.__init__(self, context, request)
    def absolute_url(self):
        return '%s/%s' % (self.context.absolute_url(), self.__name__) 
```

也不要忘记浏览器：在configure.zcml中查看slug：

```
<browser:page
    name="view"
    for="Products.myproduct.DispatcherView"
    class=".file.DispatcherView"
    permission="zope2.View"
/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-11T06:51:42.863

我想你正在寻找这个：

[http://pypi.python.org/pypi/collective.z3cform.wizard](http://pypi.python.org/pypi/collective.z3cform.wizard)

# sql - 如何将 MSSQL PRINT 输出存储到变量

> ID：10541991
> 
> 赞同：2
> 
> 时间：2012-05-10T20:55:26.680
> 
> 标签：sql, sql-server, sql-server-2008

在 MS SQL 2008 R2 上，我希望能够将消息输出捕获到变量中。我需要在许多数据库上运行脚本。捕获消息输出（来自 print 或 raiserror 的消息）并将其记录到表中。我需要从存储过程内部执行此操作。

对于这个脚本

```
Declare @sqlscript nvarchar(500)

Set @sqlscript = 
'select * from sys.objects
raiserror (''My raised error'', 10,1)
select * from sys.schemas
print ''my print'''

EXEC sp_executesql @sqlscript 
```

我想得到

```
My raised error    
my print 
```

或者

```
(60 row(s) affected)  
My raised error

(21 row(s) affected)  
my print 
```

**更新**
我决定接受@rs 的建议。登录到表格对我来说是最简单的方法。使用 SP 记录（以保持代码干净），加上一个小的正则表达式来重构我的所有脚本。解决方案将在明天准备就绪。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-10T21:38:13.143

您可能可以使用 CLR 和类似的技术：

[http://blogs.msdn.com/b/mattm/archive/2007/09/13/capture-print-messages-from-a-stored-procedure.aspx](http://blogs.msdn.com/b/mattm/archive/2007/09/13/capture-print-messages-from-a-stored-procedure.aspx)

但最好的选择可能是 EXEC 到一个只有一个 varchar 列的临时表中：

[http://msdn.microsoft.com/en-us/library/aa175921%28v=sql.80%29.aspx](http://msdn.microsoft.com/en-us/library/aa175921%28v=sql.80%29.aspx)

# ruby-on-rails - 为连接表选择控制器和路由

> ID：10541994
> 
> 赞同：1
> 
> 时间：2012-05-10T20:55:31.620
> 
> 标签：ruby-on-rails, design-patterns, jointable

我正在建立一个收藏夹功能。

例如：

```
class User < ActiveRecord::Base
  has_many :favorites
end

class Product < ActiveRecord::Base
  has_many :favorites
end

class Favorite < ActiveRecord::Base
  belongs_to :user
  belongs_to :product
end 
```

**设想**

我有一个产品列表，我想在`[+] Add to favorites`每个产品旁边添加一个链接。

**我的问题**

*   我是否将整个列表包装在一个表单标签中，以便我可以使用 POST 到*某个*控制器 - 或者我是否使用 link_to_remote 标签做一些事情？
*   我`create`应该使用产品控制器的动作，还是应该使用收藏夹控制器 - 甚至是用户控制器（因为它是用户的收藏夹）？

如您所见，我不确定在哪里放置连接表的代码。谁“拥有”什么？我害怕使用不好的反模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T22:13:40.477

您也可以在路线中设置关联，例如

```
resources :products do
  resources :favorites
end 
```

这将允许您从您的收藏夹控制器处理收藏夹的创建

比你可以用link_to_remote添加更多的收藏夹将它链接到你的收藏夹#create

# c# - 程序因“out string”而崩溃

> ID：10541996
> 
> 赞同：0
> 
> 时间：2012-05-10T20:55:33.930
> 
> 标签：c#

我正在使用这个 dll，其中一种方法期望字符串作为 out 的参数，即

```
void function(out string param); 
```

当我将字符串传递出去时，程序崩溃了。我正在使用 C#。我在 VS2010 的输出调试窗口中得到的输出如下：程序'[4116] Managed (v4.0.30319)' has exited with code -1073741819 (0xc0000005)。

这个问题突然而短暂，所以我不知道如何进一步解释，但如果您还有其他问题，请告诉我......

更新：这是 ActiveX dll，我在教程中提到 COM 返回 Unicode 字符串。这是造成问题的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-10T21:01:25.543

如何调试：

这似乎是本机/托管互操作的问题。因此，请确保您的 VS 调试器设置为 x86 的混合（本机/托管）或 x64 的纯本机。

关闭“仅我的代码”（选项->调试）并打开调试->异常->当引发本机异常时。

这样，您将拥有堆栈并查看发生了什么。

注意：拥有 C 和 C# 部分的源代码可以避免需要调试...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-10T21:09:29.400

你怎么称呼它，你的方法调用中是否包含“out”字样？

```
string str;
function(out str); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-11T00:46:19.473

我同意上面的 Ed S。尝试使用 StringBuilder，因为您在托管代码和非托管代码之间传递参数。不幸的是，由于您没有本机代码，因此您不会对其进行过多的调试。