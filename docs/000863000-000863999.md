# StackOverflow 问答 000863000-000863999

# javascript - 设置 JavaScript 弹出窗口的最小尺寸

> ID：863000
> 
> 赞同：1
> 
> 时间：2009-05-14T12:17:55.287
> 
> 标签：javascript, popup, size, minimum

有没有办法通过 JavaScript 设置弹出窗口的最小尺寸？

我的问题是，当有人尽可能地缩小内容时，内容看起来很愚蠢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T12:22:06.883

创建弹窗时，只能设置宽度和高度。但是由于创建了弹出窗口，这意味着您可以在弹出窗口加载时更改窗口的高度和宽度。只需在弹出窗口中放置一个 onload 事件：

```
window.onload = function() {
  if (document.body.scrollHeight) {
     var winWidth = document.body.scrollWidth;
     var winHeight = document.body.scrollHeight;
  } else if (document.documentElement.scrollHeight) {
     var winHeight = document.documentElement.scrollHeight;
     var winWidth = document.documentElement.scrollWidth;
  } else {
     var winHeight = document.documentElement.offsetHeight;
     var winWidth = document.documentElement.offsetWidth;
  }
  window.resizeTo(winWidth, winHeight);
} 
```

**编辑：**在 IE7、8、Chrome、Safari 4、Firefox 3 中测试。工作，但您可能需要考虑菜单+地址栏的大小等，因为窗口大小将是外部大小，此功能将找到内容的大小。所以为了安全起见，您可能应该添加几个像素，并在弹出窗口中关闭滚动条以确保它们不会占用任何空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T12:23:07.553

我不相信您可以使用 Javascript 新窗口设置最小值。我知道您可以设置大小并禁用滚动条并防止调整大小，但这会回答最小值，但也会施加最大值，这可能是您不想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T12:23:36.240

使用 windows.open 时，您可以像这样指定窗口的高度和宽度：

window.open(" [http://www.stackoverflow.com](http://www.stackoverflow.com) ","mywindow","menubar=1,resizable=1, **width=350,height=250** ");

但这不是最小尺寸，因为当有更多空间时，窗户不会更大。您必须自己检查屏幕空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T12:26:15.080

[http://www.htmlgoodies.com/beyond/javascript/article.php/3471221](http://www.htmlgoodies.com/beyond/javascript/article.php/3471221)

如链接中所示，您可以设置最小尺寸。如果要缩放它以使其变大，则必须从弹出窗口中进行缩放。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T12:31:17.563

大多数浏览器都有最小宽度和高度。

Internet Explorer 7 最小宽度 > 250px 最小高度 > 150px

# objective-c - 在标签中显示 XML 标记

> ID：863005
> 
> 赞同：0
> 
> 时间：2009-05-14T12:19:39.840
> 
> 标签：objective-c, xml, parsing

我正在尝试使用Objective C解析具有“n”个问题的XML文件。我必须在运行时在视图中的标签中显示这些问题。这意味着“n”个问题的“n”个标签和“n”个答案的“n”个标签。有人对如何做到这一点有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:54:54.323

您可能需要使用 NSXMLDocument 类来解析 XML 文件。通过在帮助菜单下选择“文档”来查看 developer.apple.com 或 Xcode 中的文档。

搜索 NSXMLDocument。阅读参考资料或单击链接以阅读 Cocoa 的基于树的 XML 编程指南。

您还可以在以下位置找到一些示例代码： http: [//www.mactech.com/articles/mactech/Vol.21/21.06/XMLParser/](http://www.mactech.com/articles/mactech/Vol.21/21.06/XMLParser/)

祝你好运。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-14T12:29:51.233

如果您使用其中一种 .NET 语言来实现此目的，您可能需要考虑使用[FlowLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.flowlayoutpanel.aspx)或[TableLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)并动态创建标签并将它们添加到面板中。

# biztalk - 为什么将 BizTalk 解决方案拆分为多个项目

> ID：863014
> 
> 赞同：4
> 
> 时间：2009-05-14T12:22:43.123
> 
> 标签：biztalk

我已经阅读了将 BizTalk 解决方案拆分为多个项目的良好做法，并且看到了关于拆分的确切性质的一些争论，例如......
- 可以按工件拆分，即架构、编排、地图等。
- 可以按功能拆分

但是有什么好处/缺点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T21:51:38.683

BizTalk 解决方案通常包括架构、映射和业务流程。解决方案还可以包括支持组件、业务规则、基于端口的路由和转换的定义、贸易伙伴以及其他几种类型的工件。

有效管理所有这些工件有很多好处——好处远多于缺点。

好处包括：

*   基于工件的逻辑分组（例如按功能或工件类型）分离关注点。这种方法减少了修改与您当时正在处理的问题无关的解决方案方面的可能性。
*   更容易测试——您可以只编译和部署您正在修改的组件。
*   更容易在一组开发人员之间分配工作。
*   当解决方案变大时更易于管理 - 在 Visual Studio 中加载大型 BizTalk 解决方案可能需要几分钟时间。
*   支持与 ESB 风格的解决方案相关的更高级的方法（非常松散的耦合）。根据您的整体方法，您可以创建一个非常模块化的解决方案——模块可以完全独立地运行和更新。
*   可以单独对工件进行版本化。
*   例如，通过对相关功能进行分组以便将它们部署到特定主机实例，促进对安全性和内存利用率进行更细粒度的控制（您还可以比使用部署几个组件）。

在调试解决方案时，将解决方案拆分为多个项目或解决方案表面的主要缺点。对于许多不熟悉 BizTalk 的开发人员来说，调试 BizTalk 解决方案并不简单，而且必须缩小解决方案中的错误范围并不会使工作变得更容易。但是，您可以通过更有效地安排您的解决方案并使用有关命名、目录结构、命名空间安排和相关方法的标准来管理这个问题，以便更容易找出查找位置。

其他缺点包括：

*   更多要签署和部署到 GAC 的程序集
*   项目之间的相互依赖可能会导致部署错误，在组织不善的解决方案中很难追踪这些错误。

您应该在项目开始时（最好是在设计期间）花一些时间来设置解决方案的基本组织。不存在一刀切的方法——您需要考虑在解决方案为您的组织或客户提供的功能的背景下，在开发、部署和维护期间如何管理解决方案。

一个好的起点是根据工件类型或功能区域划分您的解决方案。随着您的解决方案的发展，您将更好地了解工件之间的关系、您希望如何管理强命名、安全性和物理部署，并能够更好地更有效地安排您的解决方案。您需要谨慎使用这种方法，因为您最终可能不得不重新安排解决方案的大部分内容，如果您的项目时间紧迫，这可能会造成破坏。

# sql-server - 默认在用户架构中创建的表

> ID：863028
> 
> 赞同：2
> 
> 时间：2009-05-14T12:26:22.677
> 
> 标签：sql-server, schema

在 Sql Server 2008 中，当我创建一个没有架构前缀的表时：

```
create table mytable ( id int identify ) 
```

它通常以模式 dbo 结尾，名称为 dbo.mytable。

但是，在我们的一台服务器上，表格最终属于我：

```
andomar.mytable 
```

哪种配置差异可以解释这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T12:36:00.017

这取决于您在该数据库中的默认架构。即使在 SQL Server 2005 中，如果您在该数据库中的默认架构是 andomar，那么任何没有显式架构创建的表都将在那里结束。

检查该数据库中的用户属性（不是登录属性）并查看默认架构是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T20:10:39.143

如果您没有定义创建表的模式，它将始终使用默认模式。你可以像这样创建它：

```
USE DataBaseName -- define database to use
GO
BEGIN TRAN - if you will have any error everything will roll back
CREATE TABLE testovi.razine - schema name is "testovi" and tablename is "razine"
(
id INT NOT NULL IDENTITY(1,1),
razina NVARCHAR(50) NULL,
razinaENG NVARCHAR(50) NULL,
kreirao UNIQUEIDENTIFIER NULL,
VrijemeKreiranja DATETIME NULL
)
ON [PRIMARY]
GO 
```

创建表时，始终在最常用于事务的列上设置约束和索引

```
ALTER TABLE testovi.razine ADD CONSTRAINT
PK_mat_razine PRIMARY KEY CLUSTERED
(id) WITH(IGNORE_DUP_KEY=OFF,  --check duplicate and don't ignore if try to insert one
STATISTICS_NORECOMPUTE=OFF,  -- important for statistic update and query optimization
ALLOW_PAGE_LOCKS=ON) -* I believe that this is default, but always put it to on if not
ON [PRIMARY]
GO
if @@error<>0
BEGIN
ROLBACK TRAN
END
ELSE
BEGIN 
COMMIT TRAN --if everything passed o.k. table will be created
END 
```

如果你想设置默认模式，你必须知道它是基于用户的默认模式，所以你可以用代码设置它：

```
USE espabiz -- database;
ALTER USER YourUserName WITH DERAULT_SCHEMA = SchemaName; -- SchemaName is default schema for defined user 
```

Ping 如果您需要其他帮助或标记答案，您发现它可用:)

# linq - 是否可以从 DataContext.ExecuteQuery 返回匿名对象的 IEnumerable？

> ID：863030
> 
> 赞同：4
> 
> 时间：2009-05-14T12:26:27.653
> 
> 标签：linq, linq-to-sql, anonymous-types

我开发了一个报告引擎，其中报告基于模板。每个模板都有带有 SQL 查询的字符串，每个报告都有 SQL 查询参数的特定值。为了呈现报告，我设置参数并调用[DataContext.ExecuteQuery](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executequery.aspx)方法来获取记录列表。但是要捕获返回的列，我必须知道它们的名称并拥有一个具有相应属性的类。

是否有可能以某种方式从 DataContext.ExecuteQuery 返回匿名对象的 IEnumerable，然后使用反射确定它们的属性？

我需要[SqlDataReader.GetValues](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getvalues.aspx)的 LINQ 等效项。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T05:57:21.077

在我们拥有带有**dynamiс**关键字的 C# 4.0 之前，我们可以使用这个解决方案（对Octavio Hernández Leal的文章[在 LINQ to SQL 中执行任意查询的](http://geeks.ms/blogs/ohernandez/archive/2008/01/30/executing-arbitrary-queries-in-linq-to-sql.aspx)代码稍作修改）：

```
public static class DataContextExtension
{
    public static IEnumerable<Dictionary<string, object>> ExecuteQuery(this DataContext dataContext, string query)
    {
        using (DbCommand command = dataContext.Connection.CreateCommand())
        {
            command.CommandText = query;
            dataContext.Connection.Open();

            using (DbDataReader reader = command.ExecuteReader(CommandBehavior.CloseConnection))
            {
                while (reader.Read())
                {
                    Dictionary<string, object> dictionary = new Dictionary<string, object>();

                    for (int i = 0; i < reader.FieldCount; i++)
                        dictionary.Add(reader.GetName(i), reader.GetValue(i));

                    yield return dictionary;
                }
            }
        }
    }
} 
```

此扩展方法返回 Dictionary<> 对象的 IEnumerable，其中键是查询列的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T12:46:33.097

是的，你可以做到。请看一下这个片段。

```
class Program {
        static void Main(string[] args) {
            var persons = new Person[]{
                new Person{Age=22,Name="John Doe",Id=1},
                new Person{Age=23,Name="Jack Smith", Id=2},
                new Person{Age=34,Name="Sara Parker", Id=3}
            };
            var anonData = GetAnonTypes(persons);
            foreach (var item in anonData as IEnumerable) {
                //use reflection to access propties 
            }
        }
        static object GetAnonTypes(IEnumerable<Person> persons) {
            var query=from p in persons  select new{
                Id=p.Id,
                Name=p.Name
            };
            return query;        
        }
    }

    public class Person {
        public int Id { get; set; }
        public string Name { get; set; }
        public int Age { get; set; }
    } 
```

# c# - 防止将剪贴板中的html页面粘贴到c#ASP中的文本框中

> ID：863038
> 
> 赞同：0
> 
> 时间：2009-05-14T12:27:53.283
> 
> 标签：c#, asp.net-mvc, error-handling, textbox

我有一个使用 c# 的简单网络用户输入表单。用户复制他们认为是错误条件的屏幕截图，以作为输入提交到表单。复制操作实际上捕获了错误页面的 HTML。当它被粘贴到我的测试框中时，我收到一个错误（从客户端检测到潜在危险的 Request.Form 值（tbxComment）。防止这种情况的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T12:49:02.170

在 Internet Explorer、Safari 和 FireFox 3 中，您可以处理`onbeforepaste`输入控件的事件。

[来自 MSDN 的 onbeforepaste 事件](http://msdn.microsoft.com/en-us/library/ms536905(VS.85).aspx)

您必须检查剪贴板对象并决定是否允许粘贴。

它不是官方（！）w3 标准事件，但 FF 和 Safari 已包含对它的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T13:27:29.893

我使用[http://tinymce.moxiecode.com/](http://tinymce.moxiecode.com/)然后隐藏所有工具栏，并将 tinymce 配置为仅使用几个 html 标签。

或者，您可以在 keyUp 事件中使用常规表达式去除 html 标记，因为在 TextAreas 中不会触发 onChange 事件。

# com - 在 VB6 中将 UserControl 作为参数传递的问题

> ID：863039
> 
> 赞同：2
> 
> 时间：2009-05-14T12:27:58.697
> 
> 标签：com, vb6, controls, parameters

我有一个 COM 可见的方法，如下所示：

```
Public Sub SomeMethod(someControl as Object)
On Error Goto ErrHandler    

Dim someSpecificControl as SpecificControl

   MsgBox TypeOf someControl is Control
   MsgBox TypeOf someControl is SpecificControl

   On Error Resume Next
   Set someSpecificControl = someControl
   On Error Goto ErrHandler
   if someSpecificControl is Nothing then
      Exit Sub
   end if

   ' do stuff to the control

End Sub 
```

其他组件将调用此方法（即通过 COM）并传入类型为 的控件`SpecificControl`。

我的问题是，当通过调试器运行时，参数化控件似乎不是正确的类型，即它在“强制转换”失败后退出子例程，而我预计它不会。

使用`TypeOf`我已经验证了参数化对象是 Control 类型（如上所述），但我无法弄清楚为什么它被传入 - 显然 - 不正确。在调试器之外运行时它似乎表现正确 - 但我不能确定（因此这个问题）。

任何人都可以对此有所了解吗？在装箱-拆箱过程中，控件会以某种方式被损坏吗？有没有更好的方法来做到这一点？

编辑：我`TypeName`按照 Kris Erickson 的建议使用并得到了一些有趣的结果：

```
MsgBox TypeName(someControl) 
MsgBox "someControl is of type SpecificControl: " & TypeOf someControl is SpecificControl
MsgBox "someControl is of type UserControl: " & TypeOf someControl is UserControl
MsgBox "someControl is of type Control: " & TypeOf someControl is Control 
```

我得到：

```
SpecificControl
someControl is of type SpecificControl: False
someControl is of type UserControl: False
someControl is of type Control: True 
```

我想我解决这个问题的唯一方法是避免将 UserControl 作为参数传递。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T14:10:32.323

我使用`VBControlExtender`作为参数类型

```
Public Sub SomeMethod(someControl as VBControlExtender)
```

然后我得到这样的参考

```
将 someSpecificControl 调暗为 SpecificControl
将 someSpecificControlExt 调暗为 VBControlExtender

设置 someSpecificControl = someControl.object
设置 someSpecificControlExt = someControl
```

然后用于`someSpecificControlExt`访问扩展器的`Left`, `TabIndex`, `TabStop`, `Name`,`Move`等属性并`someSpecificControl`访问我的用户控件的特定方法/属性。

仅供参考，您的代码行为取决于用户控件是在当前项目中实现还是在 ocx 中引用。我也在使用[Matt Curlands 直接用户控制访问黑客](http://powervb.com/)，它允许我这样做

```
将 someSpecificControl 调暗为 DirectSpecificControl
```

以便`someSpecificControl`提前访问道具/方法。

这就是我`someSpecificControlExt`从控件中获取（扩展器）的方式：

```
公共函数 GetExtendedControl(oCtl As IUnknown) As VBControlExtender
    将 pOleObject 调暗为 IOleObject
    将 pOleControlSite 调暗为 IOleControlSite

    出错时继续下一步
    设置 pOleObject = oCtl
    设置 pOleControlSite = pOleObject.GetClientSite
    设置 GetExtendedControl = pOleControlSite.GetExtendedControl
    错误转到 0
结束功能
```

这就是我获得`UserControl`VB6 用户控件内部的方式：

```
公共函数 GetUserControl(oObj As Object) 作为 UserControl
    Dim pControl 作为用户控件

    调用 CopyMemory(pControl, ObjPtr(oObj), 4)
    设置 GetUserControl = pControl
    调用 CopyMemory(pControl, 0&, 4)
结束功能
```

引用`GetUserControl`返回有一个非常奇怪的实现`QueryInterface`- 似乎`UserControl`接口专门被设置为`E_NOTIMPLEMENTED`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:39:29.657

我不知道为什么会发生这种情况，但我知道 UserControl 在 VB6 中是半魔法的。如果您通过实际类型将 UserControl 传递给函数，它将丢失其所有 UserControl 基类（我知道，VB6 没有继承，但在创建 UserControl 时您期望某些功能）。

所以如果你

```
Private Sub AdjustControlProperties(oControl as MyUserControl)
...
End Sub 
```

一旦控件离开您的子例程，它将表现为控件，而不是 UserControl（您将无法再访问 UserControl 属性，并且尝试访问它们会导致错误）。VB6 中非常奇怪的错误，并且导致大量拉扯头发来解决它。

```
Private Sub AdjustControlProperties(oControl as Object)
...
End Sub 
```

一切都很好。我的猜测是您是正确的，并且 UserControls 已装箱，未装箱，因为 Control 不是 UserControls。类型检查的唯一解决方案是使用

```
TypeName() 
```

知道它是什么类型，因为它不会被破坏。

# php - SELECT WHERE 查询的问题

> ID：863043
> 
> 赞同：0
> 
> 时间：2009-05-14T12:29:02.157
> 
> 标签：php, mysql

得到了一个相对简单的 MySQL 查询，我使用 php 使用以下代码进行拉取：

```
$employeeNames = mysql_query(
          "SELECT * 
           FROM employees 
           WHERE team=\"1st Level Technical Support_a\" 
           LIMIT 0,5000") or die(mysql_error());
$employeeNumRows = mysql_num_rows($employeeNames);
echo $employeeNumRows;
while ($row = mysql_fetch_array($employeeNames, $employeeNumRows)) {
    echo $row['full_name'];
} 
```

现在，如果我在 SQL 的第一行运行查询，它会给我 18 个结果。如果我回显 $employeeNumRows 它会打印 18。不过在那之后就没有别的了。

如果我将“1st Level Technical Support_a”更改为表中的任何其他团队，它将使用 PHP 显示正确的结果

这是我在使用 MySQL/PHP 时遇到的最奇怪的问题——谁能帮忙？有没有人见过这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T12:34:27.150

尝试从对 的调用中删除第二个参数`mysql_fetch_array`，使其变为`mysql_feetch_array($employeeNames)`. 请参阅该函数的[文档](http://www.php.net/mysql_fetch_array)以了解如何正确使用它。

# c# - 在 C# 中构造对象的首选方法是什么？构造函数参数或属性？

> ID：863045
> 
> 赞同：28
> 
> 时间：2009-05-14T12:29:12.780
> 
> 标签：c#, oop, properties, constructor

我想知道，在 C# 中构造新对象的首选方法是什么？

学习一个 Person 类：

```
public class Person 
{
    private string name;
    private int age;

    //Omitted..
} 
```

我应该创建它以使用：

```
New Person("name", 24); 
```

或者

```
New Person() { Name = "name", Age = 24 }; 
```

这只是口味问题还是有充分的理由使用其中一种？

我可以想象一个人应该只使用构造函数中的必填字段和可选字段，而不是作为构造函数参数，而是使用属性。

我是对的吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-14T13:01:34.667

首选方式取决于您的设计。

构造函数属性用于正确构造对象所需的项。也就是说，对象为了被初始化而应该具有的任何属性都需要在构造函数中（在调用构造函数之后，您通常不想要部分初始化的对象，除非您正在创建工厂或构建器模式并且构造函数对除了工厂/构建器之外的所有人都隐藏）。

属性初始化器最适合在特定用例所需的构造函数之后进行附加配置，但对于被视为已初始化的对象而言，这不是必需的。

例如，您可以有一个代表一个人的对象。一个人需要一个名字和一个年龄来初始化，但他们居住的地址是一个可选配置。因此，名称和年龄是构造函数参数，地址是读/写属性。

```
Person johnDoe = new Person("John Doe", 24) { Address = "42 Adams Street" }; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-14T12:33:33.707

这真的取决于场景。属性方法有很多便利，因为您不必在构造函数中复制赋值。此外，大多数数据绑定场景都喜欢能够创建新对象，他们通常使用无参数构造函数，因此这是一个很大的优势。

但是，对于不可变类型，构造方法是唯一明智的选择。有趣的是（也许）C# 4.0 中的命名/可选参数允许类似于不可变类型的对象初始化器 -[请参见此处](http://marcgravell.blogspot.com/2008/11/immutability-and-optional-parameters.html)。

构造函数方法在控制反转框架中也非常流行，因为它清楚地宣传了该类需要什么才能运行。

您可能需要混合和匹配，但通常比构造函数样式更多属性样式。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-14T12:40:39.337

我的工作始终基于您应该将值传递给构造函数，这些值对于该对象以有效状态存在是必需的。

在您的示例中，您可以说没有年龄就不能存在新人，因此应该将其传递给构造函数。

如果您的工作基于对象应该对真实工作实体进行建模，那么这将确定使任何对象有效所需的最小值 - 无论您将它们设置为默认值还是通过构造函数传入值。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-14T12:34:11.473

在构造函数中设置值会使这些属性成为强制性的，因此这意味着您不能在不设置这些属性的情况下创建新实例。在某些情况下，这是可取的，在其他情况下，这是不可取的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-14T12:47:29.710

一些想法：

1.  您需要公共属性才能使用对象初始化器。因此，如果您不想公开某些内容，则必须通过构造函数参数对其进行初始化。

2.  如果你检查 IL，你会发现 Object Initializer 不是“原子的”。如果你写这样的代码（不是我推荐的，只是一个例子）：

    ```
    using (p = New Person() {Name = GetName(), Age = GetAge()})
    {
      //blah, blah
    } 
    ```

    如果 中存在异常`GetAge()`，您将创建一个`Person`处于损坏状态的实例。更糟糕的是，您永远无法进入 using 范围，并且该实例不会像您想象的那样被处置。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-14T12:42:27.820

在我看来，你应该首先决定是什么让一个人成为一个人。要正确实例化人员对象的人员属性是什么。一个人的最低要求是什么。

应该总是有一个具有最低要求的构造函数。

我只会将对象初始化器用于不需要实例化任何属性的类型。因此默认构造函数。

我知道对象初始化器非常方便。其他机制也可能需要对象中有一个空的构造函数。

但我认为你可以创建一个没有名字的 Person 没有多大意义。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-14T12:33:07.530

第二种方法只是手动设置属性的语法糖：

```
Person p = new Person();
p.Name = "name";
p.Age = 24; 
```

您也不依赖于构造函数，它可能不会初始化您要设置的所有属性。

如果你的类有一个需要这两个参数的构造函数，你就不用明确地调用那个构造函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T12:36:05.540

我对这个问题的主要考虑是 1) 实例化对象时实例化实体将拥有多少数据以及 2) 类需要如何封装？如果一旦设置，属性就不能改变（至少，由于任何外部实体），那么我会使用构造函数，因为构造函数可以设置任何只读属性以及任何读/写属性。

还要记住，就像任何其他方法一样，您的 Constructor 可以重载，因此您可以设置多种方法来初始化这些属性。

通常，我使用构造函数，但有时我会手动设置属性。为正确的问题使用正确的工具。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-14T13:18:53.410

对于手动设置属性，它们必须被声明为公共的，并且您可能希望类成员是私有的。在这种情况下，构造函数是要走的路，或者编写方法来获取/设置它们或使用访问器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-14T14:42:19.293

我倾向于使用带有属性初始化器的非常简单的构造函数。我发现它会导致更明确的代码。我将传递给构造函数的唯一数据是我不希望我的类的用户在创建类后更改的信息。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-03-10T20:55:14.927

当您通过层/层传递对象时，真正的问题出现了。例如，您创建一个人员对象并通过 Web 服务。Web 服务有时会尝试反序列化并尝试实例化，然后如果构造函数需要参数，您可能会收到错误消息！因为 web 服务首先创建一个对象，然后分配值。

因此，如果它是需要通过层的数据模型（POCO 类型），我更喜欢无参数的构造函数。

由于其他原因，构造函数参数是最好的方法（对于必填字段）。尤其是在提供类作为外部对象或程序集的接口时。

# iis - 网站/网络服务器出站 IP 地址

> ID：863046
> 
> 赞同：1
> 
> 时间：2009-05-14T12:29:32.280
> 
> 标签：iis, ip-address

我希望有一个简单的答案！我的网络服务器有多个 IP 地址。一个特定的网站将这些 IP 地址之一映射到它。在上述网站上，我有一个 java 小程序正在发出出站 http 请求。

现在，我想知道人们会看到我的服务器的 IP 地址是什么？他们会看到机器的默认 IP 地址还是在 IIS 中为该网站映射的 IP 地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T12:36:33.013

Java小程序？所以是客户端？感觉就像一条红鲱鱼。

IP 人们将“看到”（如果他们去寻找）是您在 DNS 中设置的任何内容，当然......

也许您应该指定您希望看到哪些“人”看到您的 IP。如果您的意思是拥有您正在向其发出 HTTPS 请求的服务器的人，*并且*这是客户端，他们将看到网站用户的 IP。他们不会看到您的任何 IP。

如果这是服务器端逻辑（即类似于 Java servlet），他们将看到哪个 IP 是该服务器上的默认出站 IP。在*某些*服务器上的某些情况下，服务器将使用映射的 IP，但是一旦您通过连接器将事物分层，任何人都可以猜测实际使用的是哪个网络适配器/IP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T12:37:00.420

Java 小程序将由您的访问者运行。因此，要查看的 IP 地址将是访问者的地址，而不是您的服务器拥有的地址。

# sql - SQL 搜索包含多个条件的行

> ID：863053
> 
> 赞同：0
> 
> 时间：2009-05-14T12:31:09.657
> 
> 标签：sql

我有 3 张桌子

```
顾客
团体
客户组加入

```

要使用的字段

```
客户：钥匙
组：键
CustomerGroupJoins：KeyCustomer、KeyGroup

```

我需要使用键 1、2、3 搜索所有组中的所有用户

我在想类似的事情（但不知道这是否是正确/最好的方法）：

```
SELECT 
  * 
FROM 
  Customer 
WHERE 
  Key = (
    SELECT KeyCustomer 
    FROM   CustomerGroupJoins 
    WHERE  KeyGroup = a
  ) = (
    SELECT KeyCustomer 
    FROM   CustomerGroupJoins 
    WHERE  KeyGroup = b
  ) = (
    SELECT KeyCustomer 
    FROM   CustomerGroupJoins 
    WHERE  KeyGroup = c
  ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T13:34:54.930

我创建了这个测试数据：

```
srh@srh@[local] =# select * from customer join customergroupjoins on customer.key = customergroupjoins.keycustomer join groups on groups.key = customergroupjoins.keygroup;
 key |  name  | keycustomer | keygroup | key |  name   
-----+--------+-------------+----------+-----+---------
   1 | fred   |           1 |        1 |   1 | alpha
   1 | fred   |           1 |        2 |   2 | beta
   1 | fred   |           1 |        3 |   3 | gamma
   2 | jim    |           2 |        1 |   1 | alpha
   2 | jim    |           2 |        2 |   2 | beta
   2 | jim    |           2 |        4 |   4 | delta
   2 | jim    |           2 |        5 |   5 | epsilon
   3 | shelia |           3 |        1 |   1 | alpha
   3 | shelia |           3 |        3 |   3 | gamma
   3 | shelia |           3 |        5 |   5 | epsilon
(10 rows) 
```

所以“fred”是所有（alpha，beta，gamma）中唯一的客户。要确定：

```
srh@srh@[local] =# select * from customer
  where exists (select 1 from customergroupjoins where keycustomer = customer.key and keygroup = 1)
  and exists (select 1 from customergroupjoins where keycustomer = customer.key and keygroup = 2)
  and exists (select 1 from customergroupjoins where keycustomer = customer.key and keygroup = 3);
 key | name 
-----+------
   1 | fred
(1 row) 
```

这是一种方法。(1,2,3) - 您已知的组键 - 是子查询中的参数。有人已经提到您实际上根本不需要加入组表。

另一种方式：

```
select customer.*
from customer
  join customergroupjoins g1 on g1.keycustomer = customer.key
  join customergroupjoins g2 on g2.keycustomer = customer.key
  join customergroupjoins g3 on g3.keycustomer = customer.key
where g1.keygroup = 1 and g2.keygroup = 2 and g3.keygroup = 3 
```

查找所有组（g_1，g_2 .. g_N）的用户的一般问题有点棘手。上面的这些查询已加入链接表 (customergroupjoins) N 次，因此它是一个不同的查询，具体取决于您要检查的组数。

一种方法*是*创建一个临时表以用作查询参数：该表包含客户必须拥有的所有组的列表。因此，例如创建一个名为“ParamGroups”（或 SQL Server 上的“#ParamGroups”以将其标记为临时表）的临时表，使用您感兴趣的组键填充它，然后执行以下操作：

```
select * from customer where key in (
    select keycustomer
    from customergroupjoins
      join paramgroup on paramgroup.keygroup = customergroupjoins.keygroup
    group by keycustomer
    having count(*) = (select count(*) from paramgroup)) 
```

另外，作为初学者，我强烈建议您查看有关数据库表和列命名约定的建议。每个人都有不同的想法（他们可以引发圣战），但要选择一些标准（如果它们不是由你决定的）并坚持下去。例如，您将一张表命名为“customer”（单数）和一张看起来很糟糕的表“groups”（复数）。通常使用“id”而不是“key”，并将其用作后缀（“customer_id”或“CustomerID”）而不是前缀。整个 CamelCase 与 old_skool 的争论更多的是风格问题，主键只是“id”-not-“table_id”也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T13:30:29.997

*如果客户属于三个组中的任何一个*，上述解决方案都将起作用，但不会检查*所有*组的成员资格。

试试这个：

```
SELECT  a.*
FROM    (SELECT c.*, substring((SELECT      (', ' + cg.KeyGroup)
                                FROM        CustomerGroupJoins cg
                                WHERE       cg.KeyCustomer = c.[Key]
                                AND         cg.KeyGroup IN (1,2,3)
                                ORDER BY    cg.KeyGroup ASC
                                FOR XML PATH('')), 3, 2000) AS GroupList
        FROM    Customer AS c) AS a
WHERE   a.GroupList = ('1, 2, 3') 
```

这也将起作用：

```
SELECT  c.*
FROM    Customer c
WHERE   c.[Key] IN  (SELECT     cg.[KeyGroup]
                    JOIN        CustomerGroupJoins cg                       WHERE       cg.KeyGroup IN (1,2,3)
                    GROUP BY    cg.KeyGroup
                    HAVING      count(*) = 3) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T16:55:06.587

这是一个可能的答案，未经测试：

```
select custid
from CustomerGroupJoins
where groupid in (1,2,3)
group by custid
having count(*) = 3 
```

搜索具有 3 行 groupid 1、2 或 3 的客户。这意味着他们在所有 3 个组中，因为我假设您在 (custid,groupid) 上有一个主键。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T12:36:20.250

也许是这样的？

```
SELECT c.Key, g.Key, cgj.KeyCustomer, cgj.KeyGroup
FROM Customer c
LEFT JOIN CustomerGroupJoins cgj ON cgj.KeyCustomer = c.Key
LEFT JOIN Groups g ON g.Key = cgj.KeyGroup
WHERE g.key IN (1, 2, 3) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T12:36:53.153

根据您的描述，试试这个：

```
SELECT * FROM Customer c
INNER JOIN CustomerGroupJoins cgj
ON c.key = cgj.keyCustomer
INNER JOIN groups g
ON cgj.keyGroup = g.key
WHERE g.key IN (1,2,3) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T13:05:57.153

```
SELECT *
  FROM customer c
    INNER JOIN customerGroupJoins j ON(j.customerKey = c.key)
  WHERE j.keyGroup IN (1, 2, 3) 
```

您不需要针对组表加入，只要您只对在您的加入表中找到的组键感兴趣。

# architecture - 通过重新发送处理 BizTalk 中的 MSMQ 失败

> ID：863070
> 
> 赞同：0
> 
> 时间：2009-05-14T12:34:43.283
> 
> 标签：architecture, msmq, biztalk

有没有人得到任何关于处理 BizTalk 业务流程中情况的良好做法/潜在设计的指示是长期运行服务的响应失败，因此需要重新发送启动消息

我遇到的情况是，编排向 MSMQ 队列发送消息，然后在另一个队列上等待响应。现在响应时间应该不到一分钟，但队列另一端的“服务”偶尔会失败......
*而且这不是我可以控制的，所以我无法更改/纠正它*

我可以在 BizTalk 中使用一些设计模式来超时并重新发送启动消息吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T12:44:49.997

标准 BPEL 定义了“选择”活动，而 BizTalk 具有“监听”形状，因此您基本上可以为回复队列上的接收活动定义超时期限，您可能需要一个布尔标志来决定是否回送/重试或者接收成功，因此业务流程继续进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T16:52:07.373

1.  定义一个可用于重试发送消息的单一编排，这些要放入队列的消息是从消息框中提取的。

2.  如果来自响应队列的响应延迟，请使用单例循环重新发送消息。

旁注：您可能必须在发送端口上启用 Delivery Notification 属性，以侦听您可能遇到的任何异常。

参考文章...

[处理 BizTalk 业务流程中的异常](http://www.codeproject.com/KB/biztalk/ExceptionDemo.aspx)

# singleton - Castle 如何解析单例对象？

> ID：863071
> 
> 赞同：2
> 
> 时间：2009-05-14T12:34:45.247
> 
> 标签：singleton, castle-windsor

我有一个需要由城堡初始化的单例类？我是城堡里的一个小新手。我在城堡中寻找单身人士，我看到将组件的生活方式属性设置为“单身人士”似乎就足够了。但在那种情况下，我似乎不需要在“单例模式”中实现该类。我的班级的简单班级定义似乎没问题。

即使我将其定义为普通班级，城堡是否也将我的班级作为单身人士提供给我？或者我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T12:43:18.550

不，你是绝对正确的 - 容器将在第一次需要它时实例化你的类，从那时起实例将存在于你的容器中。

远离单例模式——它是邪恶的！:)

（不，说真的 - 很少有情况需要实现单例......如果您使用的是 IoC 容器，您将永远不必通过使用静态实例来实现单例，这可能会通过耦合您的那些静态实例的类）

# cocoa - 每次拖放图标在应用程序中打开字符串

> ID：863072
> 
> 赞同：0
> 
> 时间：2009-05-14T12:35:11.893
> 
> 标签：cocoa

我的想法：
我选择一个字符串/文本并将其放在我的应用程序图标上。
我的应用程序出现并使用字符串做一些花哨的事情。

现在我的问题是如何将它放在应用程序上，如何通知我的应用程序以及我的应用程序如何获取字符串。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T12:42:56.367

我猜你已经看过[Cocoa 的官方拖放编程主题](http://developer.apple.com/documentation/Cocoa/Conceptual/DragandDrop/DragandDrop.html)。

有一篇博客文章完全解决了您的问题：[Cocoa Drag and Drop text into the Dock Icon](http://lethain.com/entry/2008/aug/06/cocoa-drag-and-drop-text-into-the-dock-icon/)。

# asp.net - ASP.NET 成员资格 - 使用哪个 RoleProvider 以便 User.IsInRole() 检查 ActiveDirectory 组？

> ID：863080
> 
> 赞同：9
> 
> 时间：2009-05-14T12:36:51.373
> 
> 标签：asp.net, authentication, active-directory, roles, active-directory-group

其实很简单的问题：

我目前禁用了 IIS 匿名访问，用户使用他们的 Windows 登录名自动登录。但是调用 User.IsInRole("Role name") 返回 false。我仔细检查了 User.Identity.Name() 和“角色名称”，它应该返回 true。

我目前在我的 Web.Config 中有这个：

***更新***
我打电话给 User.IsInRole("Role name") 我应该打电话给 User.IsInRole("DOMAIN\Role name")

**但是我仍然想知道是否需要 <membership> 条目？**

我应该改变什么？（*并且是否需要 <membership> 条目？*）

```
 <authentication mode="Windows">
      <forms
      name=".ADAuthCookie"
      timeout="10" />
  </authentication>

<membership defaultProvider="ADMembershipProvider">
  <providers>
    <clear/>
      <add
         name="ADMembershipProvider"
         type="System.Web.Security.ActiveDirectoryMembershipProvider, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
         connectionStringName="ADConnectionString"
         connectionUsername="XXX\specialAdUser"
         connectionPassword="xx"
         />
  </providers>
</membership>

<roleManager enabled="true" defaultProvider="WindowsProvider">
  <providers>
    <clear />
      <add name="WindowsProvider" type="System.Web.Security.WindowsTokenRoleProvider" />
  </providers>
</roleManager> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T20:05:45.680

如果您使用 Windows 身份验证，IsInRole 无需额外配置即可工作，只要您记得为角色添加域前缀，即 DOMAIN\groupName。

此外，您可以扮演自己的角色（双关语）并针对例如 SQL 角色提供程序使用 Windows 身份验证，您不希望您的 AD 在您的应用程序中充斥着自定义角色。

所以不，您根本不需要提供程序配置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T19:18:15.167

这里的会员提供者不会提供帮助。ActiveDirectoryMembershipProvider 似乎最适合（仅？）适合 Forms 身份验证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-24T19:49:06.150

BlogEngine.NET 有一个[Active Directory 角色提供者](http://www.codeplex.com/BlogEngineADRP)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T19:22:01.447

很确定您唯一需要的就是 roleManager 组（以及基本身份验证模式='windows' 设置）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T17:13:56.450

开箱即用，没有直接使用 Active Directory 的角色提供程序。您可以使用 ASP.NET 成员资格和角色系统中的角色表，也可以使用授权管理器 (AzMan)。

有一篇关于[CodeProject](http://www.codeproject.com/KB/aspnet/active_directory_roles.aspx)的文章显示了针对 Active Directory 工作的角色提供者的实现 - 带有完整的源代码。也许这有帮助？

马克

# visual-studio - QuickWatch 窗口智能感知问题

> ID：863083
> 
> 赞同：2
> 
> 时间：2009-05-14T12:37:23.603
> 
> 标签：visual-studio, resharper, intellisense

我使用 ReSharper，但无法在 QuickWatch 窗口上使用智能感知。Resharper 禁用此功能。你知道有什么解决办法吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T14:24:29.840

我还注意到我的智能感知菜单不会自动显示在 QuickWatch 窗口中。

*在 QuickWatch 窗口的名称*字段中输入至少 1 个字符后，您可以通过按*Ctrl+Space*手动使智能感知菜单出现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-15T08:56:13.360

这是 Resharper 中的一个错误，不会很快得到解决，看起来：

[http://youtrack.jetbrains.net/issue/RSRP-179392?query=fix+for](http://youtrack.jetbrains.net/issue/RSRP-179392?query=fix+for)

# c# - 在 C# 中表示数组

> ID：863094
> 
> 赞同：0
> 
> 时间：2009-05-14T12:40:00.790
> 
> 标签：c#, arrays

我有一个来自 linq 的数组或列表。我想在控制台中将其显示为字符串！我该怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T12:42:59.610

```
String.Join(delimiter, array); 
```

您可以将其表示为：

```
Console.WriteLine("{" + String.Join(", ", array) + "}"); 
```

当然，我认为这只适用于字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T12:43:01.170

我能给你的最通用的答案是遍历每个元素并`ToString()`在每个元素上使用该方法。

或者，您可以将 Array/List 序列化为 Xml。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T12:42:48.490

只是迭代它？

```
foreach (var item in list)
{
   Console.WriteLine(item.ToString());
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T12:43:44.070

通常，如果它是集合或数组，您可以循环遍历它。检查[关键字](http://msdn.microsoft.com/en-us/library/ttw7t8t6.aspx)[_`foreach`](http://msdn.microsoft.com/en-us/library/ttw7t8t6.aspx)

```
List<Object> list = ...

foreach (Object o in list) {
  Console.WriteLine(o.ToString);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T12:48:43.810

如果您想要更多 LINQ 方法，可以使用以下方法：

```
String text = String.Join("," + Environment.NewLine, list.Select(item => item.ToString()).ToArray());
Console.WriteLine(text); 
```

Join 的第一个参数指定应该在数组中的项目之间插入哪些字符。使用列表中的 .Select 是为了获取数组中项目的字符串表示形式。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-14T12:44:59.653

我想要更多关于你想看到什么的信息，但起初我会尝试类似的东西：

```
public string StringFromArray(string[] myArray)
    {
        string arrayString = "";
        foreach (string s in myArray)
        {
            arrayString += s + ", ";
        }
        return arrayString;
    } 
```

# c# - 使用 iTextSharp 在不同 PDF 中的坐标系和置换文本问题

> ID：863095
> 
> 赞同：1
> 
> 时间：2009-05-14T12:40:04.953
> 
> 标签：c#, pdf, itext, coordinate-systems

我正在使用 iTextSharp 和 .NET 3.5 SP1（在 C# 中，你可以猜到）并使用`PdfStamper`该类修改一些现有的 PDF。现在我有两个问题：

**变换坐标系**

正如我所看到的，iTextSharp 使用（后记？）点作为测量单位，但我想将这些坐标转换为毫米。现在，实现这一目标的最佳方法是什么？

查看文档揭示了以下方法：

```
PdfContentByte cb = new PdfContentByte();
System.Drawing.Drawing2D.Matrix scale = new System.Drawing.Drawing2D.Matrix(
    0.352777778, 0, 0.352777778, 0, 0, 0); // 1 point = 0.352777778 mm
cb.Transform(scale); 
```

我希望我得到了正确的转换矩阵。但问题是：没有`System.Drawing.Drawing2D`大会！这个程序集是被丢弃还是发生了什么？我该怎么做才能将 iTextSharp 的坐标转换为毫米。我在这里走错路了吗？

**PDF 中的文本在使用相同坐标的不同 PDF 中被替换**

我注意到，在修改*两个具有**相同内容*的不同 PDF 文件时，相同的坐标被移位，并且文本没有被放置在完全相同的位置。是什么导致了这种情况，我该如何预防？

这是第一个PDF：

[![替代文字](https://i.stack.imgur.com/zBz0i.gif)](https://i.stack.imgur.com/zBz0i.gif)

这是第二个 PDF，使用 iTextSharp 中完全相同的坐标创建：

[![替代文字](https://i.stack.imgur.com/sUOkU.gif)](https://i.stack.imgur.com/sUOkU.gif)

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T12:42:06.370

> 但问题是：没有 System.Drawing.Drawing2D 程序集！这个程序集是被丢弃还是发生了什么？我该怎么做才能将 iTextSharp 的坐标转换为毫米。我在这里走错路了吗？

[http://msdn.microsoft.com/en-us/library/system.drawing.drawing2d.matrix.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.drawing2d.matrix.aspx)（在 System.Drawing.dll 中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T06:30:39.390

好的，我解决了第二个问题，尽管使用了相同的坐标，但文本被移位。

事实证明，第一个 PDF 包含一些不可见的修剪空间，第二个没有。修剪空间不可见，因为视图空间是使用 PDF 创建器裁剪的，但看起来修剪空间仍然存在并计入坐标。

# matlab - 分桶算法

> ID：863113
> 
> 赞同：3
> 
> 时间：2009-05-14T12:43:35.007
> 
> 标签：matlab, vectorization

我有一些有效的代码，但有点瓶颈，我一直在试图弄清楚如何加速它。它在一个循环中，我不知道如何对其进行矢量化。

我有一个代表时间序列数据的二维数组 vals。行是日期，列是不同的系列。我试图按月存储数据以对其执行各种操作（求和、平均值等）。这是我当前的代码：

```
allDts; %Dates/times for vals.  Size is [size(vals, 1), 1]
vals;
[Y M] = datevec(allDts);
fomDates = unique(datenum(Y, M, 1)); %first of the month dates

[Y M] = datevec(fomDates);
nextFomDates = datenum(Y, M, DateUtil.monthLength(Y, M)+1);

newVals = nan(length(fomDates), size(vals, 2)); %preallocate for speed

for k = 1:length(fomDates); 
```

下一行是瓶颈，因为我多次调用它。（循环）

```
 idx = (allDts >= fomDates(k)) & (allDts < nextFomDates(k));
    bucketed = vals(idx, :);
    newVals(k, :) = nansum(bucketed);
end %for 
```

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:47:56.970

这是一个很难矢量化的问题。我可以建议一种使用[CELLFUN](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/cellfun.html)的方法，但我不能保证它会更快地解决您的问题（您必须自己根据您正在使用的特定数据集进行计时）。正如在[另一个 SO question](https://stackoverflow.com/questions/831721/turning-a-matlab-binary-matrix-into-a-vector-of-the-last-nonzero-index-in-a-fast)中所讨论的，矢量化并不*总是*比 for 循环更快。它可以是非常具体的问题，这是最好的选择。有了这个免责声明，我将建议您尝试两种解决方案：CELLFUN 版本和可能运行得更快的 for 循环版本的修改。

**细胞乐解决方案：**

```
[Y,M] = datevec(allDts);
monthStart = datenum(Y,M,1);  % Start date of each month
[monthStart,sortIndex] = sort(monthStart);  % Sort the start dates
[uniqueStarts,uniqueIndex] = unique(monthStart);  % Get unique start dates

valCell = mat2cell(vals(sortIndex,:),diff([0 uniqueIndex]));
newVals = cellfun(@nansum,valCell,'UniformOutput',false); 
```

[对MAT2CELL](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/mat2cell.html)的调用将具有相同开始日期的 val行分组到单元数组 valCell 的**单元****中**。变量**newVals**将是一个长度为**numel(uniqueStarts)**的单元格数组，其中每个单元格将包含对valCell的相应单元格执行**nansum的****结果**。

**FOR循环解决方案：**

```
[Y,M] = datevec(allDts);
monthStart = datenum(Y,M,1);  % Start date of each month
[monthStart,sortIndex] = sort(monthStart);  % Sort the start dates
[uniqueStarts,uniqueIndex] = unique(monthStart);  % Get unique start dates

vals = vals(sortIndex,:);  % Sort the values according to start date
nMonths = numel(uniqueStarts);
uniqueIndex = [0 uniqueIndex];
newVals = nan(nMonths,size(vals,2));  % Preallocate
for iMonth = 1:nMonths,
  index = (uniqueIndex(iMonth)+1):uniqueIndex(iMonth+1);
  newVals(iMonth,:) = nansum(vals(index,:));
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T21:12:24.037

如果您需要做的只是形成矩阵行的总和或平均值，其中行根据另一个变量（日期）求和，然后使用我的合并函数。它旨在完全执行此操作，根据指标系列的值减少数据。（实际上，consolidator 也可以处理 nd 数据，并且有容差，但您需要做的就是将月份和年份信息传递给它。）

[在 Matlab Central 上的文件交换中查找合并器](http://www.mathworks.com/matlabcentral/fileexchange/8354)

# regex - 正则表达式计算字符串中逗号的数量

> ID：863125
> 
> 赞同：42
> 
> 时间：2009-05-14T12:45:01.573
> 
> 标签：regex

如何构建一个正则表达式来匹配包含任何字符但必须包含 21 个逗号的任意长度的字符串？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-05-14T12:48:34.763

```
/^([^,]*,){21}[^,]*$/ 
```

那是：

```
^     Start of string
(     Start of group
[^,]* Any character except comma, zero or more times
,     A comma
){21} End and repeat the group 21 times
[^,]* Any character except comma, zero or more times again
$     End of string 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-14T12:55:51.593

如果您使用支持所有格量​​词的正则表达式变体（例如 Java），您可以执行以下操作：

```
^(?:[^,]*+,){21}[^,]*+$ 
```

占有量词比贪婪量词的性能更好。

解释：

```
(?x)    # enables comments, so this whole block can be used in a regex.
^       # start of string
(?:     # start non-capturing group
[^,]*+  # as many non-commas as possible, but none required
,       # a comma
)       # end non-capturing group
{21}    # 21 of previous entity (i.e. the group)
[^,]*+  # as many non-commas as possible, but none required
$       # end of string 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-14T12:49:41.873

正好 21 个逗号：

```
^([^,]*,){21}[^,]$ 
```

至少 21 个逗号：

```
^([^,]?,){21}.*$ 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-14T12:53:52.143

遍历字符串，计算找到的逗号数量，然后将其与 21 进行比较，可能会更快、更容易理解。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T12:49:01.937

```
^(?:[^,]*)(?:,[^,]*){21}$ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T12:51:18.343

如果正好是 21：

```
/^[^,]*(,[^,]*){21}$/ 
```

如果至少 21：

```
/(,[^,]*){21}/ 
```

但是，我建议不要将正则表达式用于如此简单的任务。因为它很慢。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T12:53:26.840

什么语言？可能有更简单的方法。

例如...

在 CFML 中，您可以查看是否`ListLen(MyString)`为 22

在 Java 中，您可以比较`MyString.split(',')`22

ETC...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T12:57:30.870

```
var valid = ((" " + input + " ").split(",").length == 22); 
```

或者...

```
var valid = 21 == (function(input){
    var ret = 0;
    for (var i=0; i<input.length; i++)
        if (input.substr(i,1) == ",")
            ret++;
    return ret
})(); 
```

会比...表现更好

```
var valid = (/^([^,]*,){21}[^,]*$/).test(input); 
```

* * *

## 回答 #9

> 赞同：-11
> 
> 时间：2009-05-14T12:49:33.683

```
.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*,.*, 
```

# c# - 在多个表上使用 SubSonic Query

> ID：863126
> 
> 赞同：0
> 
> 时间：2009-05-14T12:45:13.507
> 
> 标签：c#, .net, database, subsonic, data-access-layer

我想使用亚音速从多个表中选择行。对于一个表，我可以使用 Query 对象，但我不知道如何添加多个表进行查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T12:57:12.977

你需要加入他们，就像你在 SQL 中所做的那样。如果架构中有外键关系，Subsonic 足够聪明，可以直接计算连接：

```
DataSet DS = DB.Select().From<Table1>().InnerJoin<Table2>().ExecuteDataSet(); 
```

如果表之间没有 FKI，则需要手动指定每个表中的列来创建连接：

```
DataSet DS = DB.Select().From<Table1>().InnerJoin(Table1.FKIColumn,Table2.IDColumn).ExecuteDataSet(); 
```

同样，您可以创建左/右外部连接等。

请记住，您只能在简单的 FKI 约束条件下加入它们。例如，我发现没有简单的方法可以直接从 SubSonic 执行“Table1.FKI = Table2.ID 和 Table2.CreateDate>Table1.CreateDate 上的 INNER JOIN Table2”。

使用 SubSonic 多表连接的一大缺点是，如果您在两个表中都有相同名称的列，您将遇到麻烦。

# websphere - IBM RAD 7 和 Websphere 6.1 速度慢且无响应

> ID：863127
> 
> 赞同：8
> 
> 时间：2009-05-14T12:45:14.677
> 
> 标签：websphere, ibm-rad

在使用 Websphere 和 RAD 进行本地开发时，如何提高性能？我正在使用一个中等大小（1000 个类）的 Web 应用程序，并且无法在 Windows 机器上本地处理该应用程序。Websphere 6.1 配置使用默认配置。RAD7 配置为处理 1024mb 的最大堆。我想过增加服务器的堆。目前，最小和最大为 128/300mb。

就无响应而言，如果页面完全加载，有时可能需要几分钟才能加载页面。另外，我禁用了“自动构建”并自动发布。也许那些应该打开？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T13:12:27.623

我不确定 RAD7，但根据我过去的经验，我建议尝试一下[MyEclipse Blue](http://www.myeclipseide.com/)。

由于这可能不是一个选项，这里有一些其他常见的罪魁祸首，您可以检查：

*   你的机器有多少内存？为 WS 提供 1GB 的 RAM 很好，但如果您的计算机只有 1GB 的实际 RAM，它就会将自己交换至死。如果你的老板不付钱，那就用你自己的钱去买一些内存。2GB 不到 80 美元的 ATM。我建议至少获得 4GB。是的，即使安装了 4 个，Windows 也只能使用 3.5GB，但那半 GB 的成本为 20 美元或更少。即使考虑这个问题超过五分钟，也比简单地购买它要花费更多。

*   接下来确定您是否使用了正确的 Java GC 选项。文档中应该有一些关于此的信息。另外确保该进程使用“服务器”目录中的“jvm.dll”，而不是“客户端”目录。“[进程资源管理器](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)”会有所帮助。

*   由于我没有使用 RAD，我不能 100% 确定“自动构建”和“自动发布”，但由于 RAD7 基于 Eclipse，这些选项将在您键入时在后台编译代码。这将大大缩短您保存上次更改和应用服务器开始加载新代码之间的时间。

*   当一切都失败时，在分析器中运行 websphere 并查看它一直在哪里花费。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T13:18:45.703

亚伦有很好的建议。

我还建议使用 JConsole 来查看发生了什么，以帮助您确定是否需要更多内存、更大的堆大小等。我在本地运行 Websphere 和 RAD 的经验是它会很慢，但后来我在需要更多内存的旧机器。:) [http://java.sun.com/j2se/1.5.0/docs/guide/management/jconsole.html](http://java.sun.com/j2se/1.5.0/docs/guide/management/jconsole.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T21:05:02.597

柏林，

RAD 7 让您的 PC 崩溃！当我使用它开发 Portlet 时，[我遵循了这个优化指南](http://www.ibm.com/developerworks/rational/library/07/0327_riordan/)，它使 IDE 开发 Portlet 的速度显着加快。显然它是针对 Portlet 开发的，但它可能会对您有所帮助。

遵循对[这个问题](https://stackoverflow.com/questions/299011/ways-to-purge-the-workspace-environment-with-rad-based-on-eclipse)的答案给出的建议也将有所帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-10T14:35:54.633

确保您的运行处于开发模式以进行开发和测试。

选项位于控制台中的服务器下方。

卡尔

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-30T03:13:43.883

我绝对同意亚伦·迪古拉的观点。在您的开发机器上安装 4GB RAM 后，您将看到性能的显着提升。我和我的一些朋友一起开发了一个 Eclipse/RAD 插件，我们能够衡量从 2GB 升级到 4GB 节省了多少时间。

该插件可在此处获得：http: [//lopb.org/](http://lopb.org/)

在收集了一些关于我们在 2GB 开发机器上等待发布和加载应用程序所花费的时间的确切数字后，我们能够说服管理层升级团队中的其他开发人员。

无论如何，如果你想在同一台开发机器上运行 RAD 7 和 Websphere 6，你真的应该考虑升级到 4GB。每个都需要 -Xms=512m -Xmx=1024m 作为 JVM 参数才能正常运行，这意味着如果您只有 2GB 或更少的 RAM，您将过多地交换到磁盘。高温高压

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-05-18T07:40:52.327

如果不通过 JVM 命令行开关专门启用 JConsole，它将无法工作。

Michael Wiles 的建议听起来很合理，但请先将您的 RAD 更新到可用的最新 FixPack。

您也可以联系支持人员。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-02T20:24:52.850

呵呵，我们在 RAD6 和 Websphere 6 上遇到了同样的问题。

我们加快速度的方式转移到了 Eclipse 和 JBoss。

我们在 Eclipse 和 JBoss 上开发，然后第一轮测试在 Websphere 上进行。我们在差异方面遇到了一些问题，但如果不是因为切换，我们永远不会完成项目（比在 RAD/WAS 上开发的问题要少得多）。

但同时为了帮助你...

1.  当然，可能希望自动构建并自动发布。这样，您可以进行大量更改，然后在您去喝咖啡时告诉 RAD 编译和部署。
2.  Websphere 中有一个“在开发模式下运行”（我知道有 6.0 版本）所以跟踪它并打开它（它在某处的 WAS 控制台上）

3.  我发现 WAS 的堆栈替换工作得相当好。我发现在一天开始时我会部署到 WAS，然后至少在午餐时间之前不必重新部署（因为我正在调试）。我会进行更改，这些更改将被提供给服务器，而无需重新部署。

4.  很有可能，即使在运行分析器之后，您也会发现您无能为力。

5.  关闭所有验证（在 RAD 中），它们往往需要永远。

6.  根据您使用 EE 所做的工作，调查开发另一个 IDE/Server 组合的可能性，也许您可​​以在其中完成大部分工作，然后从 RAD/WAS 部署以进行一些最终测试。如果您使用普通 ejb 或 Web 服务，这是可行的。

7.  对我来说，最大堆确实听起来有点小。启动 JConsole 的建议是一个很好的建议，因为它会告诉您正在使用多少堆，但我不确定它是否可以在 IBM vm (RAD) 上运行。您可以尝试打开 RAD 中的内存使用监视器，告诉您正在使用多少内存，这样您就可以判断它是否达到最大值。

# windows - 为什么 ReadDirectoryChangesW 忽略事件？

> ID：863135
> 
> 赞同：12
> 
> 时间：2009-05-14T12:47:58.663
> 
> 标签：windows, delphi, filesystems, delphi-2009, readdirectorychangesw

我使用 ReadDirectoryChangesW 来监视指定的目录并在检测到更改时更新索引结构。我使用以下代码（大致）

```
var
  InfoPointer : PFileNotifyInformation;
  NextOffset : DWORD;
...
while (not Terminated) do begin
  if ReadDirectoryChangesW (FDirHandle, FBuffer, FBufferLength, True,
                            FFilter, @BytesRead, @FOverlap, nil) then
    begin
    WaitResult := WaitForMultipleObjects (2, @FEventArray, False, INFINITE);
    if (WaitResult = waitFileChange) then
      begin 
      InfoPointer := FBuffer;
      repeat
        NextOffset := InfoPointer.NextEntryOffset;
        ...
        PByte (InfoPointer) := PByte (InfoPointer) + NextOffset;
      until NextOffset = 0;
      end;
    end;
end; 
```

过滤器是

```
FFilter :=  FILE_NOTIFY_CHANGE_FILE_NAME or
            FILE_NOTIFY_CHANGE_DIR_NAME or
            FILE_NOTIFY_CHANGE_SIZE or
            FILE_NOTIFY_CHANGE_LAST_WRITE; 
```

并且目录句柄是这样获得的：

```
FDirHandle := CreateFile (PChar (FDirectoryWatch.WatchedDirectory),
                          FILE_LIST_DIRECTORY or GENERIC_READ,
                          FILE_SHARE_READ or FILE_SHARE_WRITE or FILE_SHARE_DELETE,
                          nil, OPEN_EXISTING, FILE_FLAG_BACKUP_SEMANTICS or   
                          FILE_FLAG_OVERLAPPED, 0); 
```

当我删除多个文件时，我只收到一个事件，NextOffset 为 0！当我删除一个目录时，我只得到该目录的一个事件。如果我希望目录中的每个文件都有一个事件怎么办？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-14T15:30:23.297

在我看来，您正在混合使用*ReadDirectoryChangesW()*的各种方式，您在打开目录时既指定了*FILE_FLAG_OVERLAPPED*标志，又提供了指向*lpOverlapped*参数的指针，这意味着您想要等待结构中的事件并处理异步 I/O；同时您在工作线程的循环中调用*ReadDirectoryChangesW()*。*我会先将lpOverlapped*设置为*nil*再试一次，因为您有一个专用线程并且可以使用同步模式。

在[*ReadDirectoryChangesW()*](http://msdn.microsoft.com/en-us/library/aa365465(VS.85).aspx) API 函数的文档中描述了使用它的不同方法。请注意，缓冲区也可能溢出，因此无论如何更改事件都可能丢失。也许您应该重新考虑仅依靠此功能的策略，比较目录内容的快照也可以。

**编辑：**

您编辑的代码看起来更好。然而，在我的测试中，*ReadDirectoryChangesW()*确实像宣传的那样工作，返回的缓冲区中有多个数据条目，或者有多个缓冲区要处理。这取决于时间，在 Delphi 中遇到断点后，我会在一个缓冲区中获得多个条目。

为了完整起见，我附上了使用 Delphi 5 实现的测试代码：

```
type
  TWatcherThread = class(TThread)
  private
    fChangeHandle: THandle;
    fDirHandle: THandle;
    fShutdownHandle: THandle;
  protected
    procedure Execute; override;
  public
    constructor Create(ADirectoryToWatch: string);
    destructor Destroy; override;

    procedure Shutdown;
  end;

constructor TWatcherThread.Create(ADirectoryToWatch: string);
const
  FILE_LIST_DIRECTORY = 1;
begin
  inherited Create(TRUE);
  fChangeHandle := CreateEvent(nil, FALSE, FALSE, nil);
  fDirHandle := CreateFile(PChar(ADirectoryToWatch),
    FILE_LIST_DIRECTORY or GENERIC_READ,
    FILE_SHARE_READ or FILE_SHARE_WRITE or FILE_SHARE_DELETE,
    nil, OPEN_EXISTING, FILE_FLAG_BACKUP_SEMANTICS or FILE_FLAG_OVERLAPPED, 0);
  fShutdownHandle := CreateEvent(nil, FALSE, FALSE, nil);
  Resume;
end;

destructor TWatcherThread.Destroy;
begin
  if fDirHandle <> INVALID_HANDLE_VALUE then
    CloseHandle(fDirHandle);
  if fChangeHandle <> 0 then
    CloseHandle(fChangeHandle);
  if fShutdownHandle <> 0 then
    CloseHandle(fShutdownHandle);
  inherited Destroy;
end;

procedure TWatcherThread.Execute;
type
  PFileNotifyInformation = ^TFileNotifyInformation;
  TFileNotifyInformation = record
    NextEntryOffset: DWORD;
    Action: DWORD;
    FileNameLength: DWORD;
    FileName: WideChar;
  end;
const
  BufferLength = 65536;
var
  Filter, BytesRead: DWORD;
  InfoPointer: PFileNotifyInformation;
  Offset, NextOffset: DWORD;
  Buffer: array[0..BufferLength - 1] of byte;
  Overlap: TOverlapped;
  Events: array[0..1] of THandle;
  WaitResult: DWORD;
  FileName, s: string;
begin
  if fDirHandle <> INVALID_HANDLE_VALUE then begin
    Filter := FILE_NOTIFY_CHANGE_FILE_NAME or FILE_NOTIFY_CHANGE_DIR_NAME
      or FILE_NOTIFY_CHANGE_SIZE or FILE_NOTIFY_CHANGE_LAST_WRITE;

    FillChar(Overlap, SizeOf(TOverlapped), 0);
    Overlap.hEvent := fChangeHandle;

    Events[0] := fChangeHandle;
    Events[1] := fShutdownHandle;

    while not Terminated do begin
      if ReadDirectoryChangesW (fDirHandle, @Buffer[0], BufferLength, TRUE,
        Filter, @BytesRead, @Overlap, nil)
      then begin
        WaitResult := WaitForMultipleObjects(2, @Events[0], FALSE, INFINITE);
        if WaitResult = WAIT_OBJECT_0 then begin
          InfoPointer := @Buffer[0];
          Offset := 0;
          repeat
            NextOffset := InfoPointer.NextEntryOffset;
            FileName := WideCharLenToString(@InfoPointer.FileName,
              InfoPointer.FileNameLength);
            SetLength(FileName, StrLen(PChar(FileName)));
            s := Format('[%d] Action: %.8xh, File: "%s"',
               [Offset, InfoPointer.Action, FileName]);
            OutputDebugString(PChar(s));
            PByte(InfoPointer) := PByte(DWORD(InfoPointer) + NextOffset);
            Offset := Offset + NextOffset;
          until NextOffset = 0;
        end;
      end;
    end;
  end;
end;

procedure TWatcherThread.Shutdown;
begin
  Terminate;
  if fShutdownHandle <> 0 then
    SetEvent(fShutdownHandle);
end;

////////////////////////////////////////////////////////////////////////////////

procedure TForm1.FormCreate(Sender: TObject);
begin
  fThread := TWatcherThread.Create('D:\Temp');
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
  if fThread <> nil then begin
    TWatcherThread(fThread).Shutdown;
    fThread.Free;
  end;
end; 
```

删除一个目录确实只返回一个更改，而不是其中包含的文件。但这确实有意义，因为您只观察父目录的句柄。如果您需要子目录的通知，您可能还需要查看它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-04T07:50:49.430

我们在丢失事件方面遇到了同样的问题，特别是如果同时发生很多变化，即。500 个文件被复制到监控目录。

最后我们找到[了 Cromis](http://www.cromis.net/blog/downloads/)并使用了[Directory watch](http://www.cromis.net/blog/downloads/directory-watch/)。我们再也没有回头。

# sql - 在 SQL 查询中显示零值数据？

> ID：863136
> 
> 赞同：0
> 
> 时间：2009-05-14T12:48:05.527
> 
> 标签：sql, select, count

我有以下两个表（针对这个问题进行了简化）：

```
CREATE TABLE team (
 teamID CHAR(6) NOT NULL PRIMARY KEY); 

CREATE TABLE member (
 memberID CHAR(7) NOT NULL PRIMARY KEY,
 teamID CHAR(6) NOT NULL REFERENCES team(teamID) ); 
```

我还有如下查询，就是列出每个团队的成员数量：

```
SELECT teamID, count(memberID) AS [noOfMembers]
FROM member
GROUP by teamID; 
```

但是，我有四个团队（MRT1、MRT2、MRT3 和 MRT4）。我表中的成员仅属于团队 2 和 3，因此当我运行查询时，我得到以下输出：

捷运2：7，捷运3：14

我不确定如何调整查询以列出所有 4 个团队，如下所示：

捷运1：0，捷运2：7，捷运3：14，捷运4：0

我一直在弄乱子查询来解决这个问题，但没有任何运气。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T12:49:57.847

尝试从 TEAM left JOIN-ing on Member 中选择

```
SELECT Team.Teamid, count(memberid)
FROM 
    TEAM
LEFT OUTER JOIN 
     Member on Member.teamid = Team.Teamid
GROUP by Team.Teamid 
```

只是为了给你一些关于这是做什么的背景。

它说

> 给我团队中的所有团队成员，然后为每个成员计算成员表中的匹配项，即使没有匹配项也是如此。

如果你使用

```
SELECT Team.Teamid, count(memberid)
FROM 
    TEAM
INNER JOIN 
     Member on Member.teamid = Team.Teamid
GROUP by Team.Teamid 
```

这转化为

> 给我团队中的所有团队成员，然后为每个成员计算成员表中的匹配项，但前提是有匹配项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T12:51:52.647

```
SELECT teamID, count(memberID) AS [noOfMembers]
FROM team
LEFT JOIN member
ON team.teamID = member.teamID
GROUP by teamID; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T12:53:51.520

我做了这个测试，并为我工作

```
CREATE TABLE team (
 teamID CHAR(6) NOT NULL PRIMARY KEY); 

CREATE TABLE member (
 memberID CHAR(7) NOT NULL PRIMARY KEY,
 teamID CHAR(6) NOT NULL REFERENCES team(teamID) );

INSERT INTO team (teamID) VALUES ('T1')
INSERT INTO team (teamID) VALUES ('T2')
INSERT INTO team (teamID) VALUES ('T3')
INSERT INTO team (teamID) VALUES ('T4')

INSERT INTO member (memberID, teamID) VALUES ('M1', 'T1')
INSERT INTO member (memberID, teamID) VALUES ('M2', 'T1')
INSERT INTO member (memberID, teamID) VALUES ('M3', 'T1')
INSERT INTO member (memberID, teamID) VALUES ('M4', 'T3')

SELECT Team.teamID, count(member.memberID) AS [noOfMembers]
FROM Team LEFT JOIN member ON Member.teamID = Team.teamID
GROUP BY ALL Team.teamID; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T12:51:13.477

对 TEAM 表的右连接应该可以解决问题。

# javascript - 使用 window.opener 的问题

> ID：863161
> 
> 赞同：0
> 
> 时间：2009-05-14T12:53:31.317
> 
> 标签：javascript, html, ajax

我有一个简单的 ajax 应用程序

由此，弹出一个带有表单的弹出窗口。

表单结果页面和 ajax 应用程序都有一个共同的 javascript 文件。

在弹出窗口中，在表单结果页面中，我试图从常见的 javascript 文件中调用一个方法，以应用于父窗口。

我的 javascript 文件包含一个 updateLayer 方法，当从父窗口调用时，它工作正常。尝试从弹出窗口调用它时，我什么也没得到。

弹出窗口中的结果页有

```
<script type="text/javascript" src="x.js">window.opener.updateLayer("Layer3", "380118179930"); </script> 
```

在任何 html 之前。

父窗口中什么也没有发生。我也试过window.parent。

这是什么原因和解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T06:11:56.837

我认为这与[这个问题有关](https://stackoverflow.com/questions/861339/calling-a-javascript-function-from-a-form-result/861452#861452)，由另一个也恰好名为 Josh 的用户提出。

在我对这个问题的回答中，我试图解释父窗口中包含的 Javascript 文件中的函数将附加到窗口对象，因此您使用 window.opener 来访问该窗口对象以调用它们。

看起来您几乎已经解决了这个问题，但这里的问题是，通过`src="x.js"`在表单响应中包含脚本标记，您实际上会覆盖放置在脚本中的任何代码。另外，由于 x.js 包含在父窗口中，因此根本不需要在弹出窗口中包含它。

您的表单响应代码应如下所示：

```
<script type="text/javascript">
window.opener.updateLayer("Layer3", "380118179930");
</script> 
```

我已经删除了该`src="x.js"`属性，否则会阻止标签之间的`<script></script>`代码被执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T12:51:03.467

您的问题可能是您有两个内容相同的 JavaScript 文件，而没有应用名称空间。

首先，您的父级包含定义 updateLayer() 的 file.js。然后父级打开子窗口，其中也包含该 file.js。如果你这样做，你就会有两个线程在运行，每个线程可能都有自己的函数和对象，而不会打扰另一个。我假设您的功能是全球性的。如果没有使用命名空间，这可能会导致问题。此外，您的大型 ajax 库可能会创建 iframe 和类似的东西，而您不会从中看到任何东西，因为它发生在幕后。

所以试试：top.window.opener.updateLayer("Layer3", "380118179930");

如果这没有帮助，请尝试打开一个没有包含 file.js 的空白窗口并从开启程序调用该函数。如果可行，请将 file.js 的内容包装在 myNamespace = {....big file content inbetween....} 之类的命名空间中，制作两个版本（或更好地动态包含内容）并确保有两个不同的命名空间。JavaScript 通常不会按照您认为的方式工作。

另外，请确保您打开的窗口的 url 具有*完全相同*的域。它可能会导致安全问题，因此浏览器不允许从子窗口访问其父窗口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T13:58:04.113

乔希，

您能否确定该功能是否完全被触发，就像 anakata 建议的那样？例如，在函数的第一行放置一个警告框？

否则：函数是如何`updateLayer`定义的`x.js`？

如果是这样定义的：

```
function updateLayer(layer, result) {
  // ...
} 
```

...那么它应该可以正常工作。

如果定义如下：

```
var updateLayer = function(layer, result) {
  // ...
} 
```

那么它将*不能*用作`window`对象的属性（因此不能用作`window.opener`任何一个的属性）。至少在 Firefox 中；我还没有在 IE 或其他浏览器中测试过这个。

编辑：为什么这个问题被标记为“ajax”？AFAICS，所有问题都存在于应用程序的客户端；不涉及ajax。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T14:17:53.590

尝试以下操作：

```
parent.window.updateLayer(); 
```

在单独的`<script>`标签中。

我不太确定它是否同时适用于 src=some.js 和内联脚本。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-14T13:12:00.510

由于您已为 script 元素赋予了 src 属性，因此 x.js 的结果将被解析为 JS，元素的文本内容将被忽略。

```
<script type="text/javascript" src="x.js"></script>
<script type="text/javascript">
    window.opener.updateLayer("Layer3", "380118179930");
</script> 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-14T12:56:01.670

在您的父 html 文件中创建一个新的 updateLayer 函数。将其重命名为不同的名称并从中调用原始的 updateLayer。例如

```
function updateLayerPage(arg1, arg2)
{
    updateLayer(arg1, arg2);
} 
```

然后从子页面调用这个新函数

```
window.opener.updateLayerPage("Layer3", "380118179930"); 
```

# jquery - jQuery 用于演示的 $().each() 方法的实际用途

> ID：863166
> 
> 赞同：6
> 
> 时间：2009-05-14T12:55:09.550
> 
> 标签：jquery, each, loops

我今天要向一些同事介绍如何在 ColdFusion 中使用 jQuery。这更像是对 jQuery 的介绍，而不是高级会话。我试图展示如何使用 jQuery 的 $().each() 方法进行循环，并试图提出一些实际的、真实的例子，但我已经画了一个空白。有什么建议么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-14T13:07:59.723

```
// changes every other div green
$("div").each(function(i) { if (i % 2) this.style.backgroundColor = "green"; }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T13:06:28.650

跳过它。无论如何，这会让新用户感到困惑。jQuery 返回对象数组并已对每个对象应用函数调用，这对菜鸟来说并不明显。你会花时间在 each() 上，你会从中得到的只是那些做`$('a').each().css("color", "red");`或`$('a').each(function(){ $(this).css("color", "red");});`

不要问我怎么知道遇到 .each() 的菜鸟最终会犯这个错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T13:15:35.180

根据某些外部复选框的值检查数据网格中的所有复选框

```
$('#<%=dgMyDataGrid.ClientID %> :checkbox').each(function(i)
{
this.checked = $(#SelectAll).is(":checked")
}); 
```

我最初在 findcontrol() 方法后面有一个代码来代替 #SelectAll，但这有希望说明我正在尝试做的事情。此函数还绑定到#SelectAll 的单击事件。

（还请注意，我是 jQuery 新手！）

编辑：如果有人感兴趣，我[在这里使用它的完整实现:)](https://stackoverflow.com/questions/709494/checkbox-in-datagrid-header-clientid-jquery)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-27T01:34:19.590

## 在 JQuery 中使用 each()

您可以看到我对一个非常简单的“更多/更少”可扩展报纸专栏代码的尝试。这是使用 each() 函数的代码。我努力保持简单 - 非计数器，不存储在 var 中，不使用索引，这里是代码：

在我的网站上查看现场演示和源代码[在 Manisa Turiksh](http://www.turkishlanguage.co.uk/jqexpand.htm)

JQ代码

```
 $(document).ready(function(){
$(".expand").each(function() {
$('p', this).hide(); //hide all p's for each div class=expand
$('p:first', this).show(); //show only first p in each div
$('.more',this).show(); //show more link belw each div
});

$('.more').toggle( 
    function() { 
    $(this).prevAll().show(); // toggle on to show all p's in div id=expand selected by this id=more
    $(this).html('less..'); //change legend to - less - for this id=more when div is expanded
    }, 
    function() {
    $(this).prevAll().not('p:last,h3').hide(); //hide all p's except first p, counts backwards in prevAll and reshow header h3 as it was hidden with prevAll
    $(this).html('more..'); //change legend to - more - for this id=more when div is collapsed
    });
}); 
```

### CSS 代码

```
 body {font-family:calandra;font-size:10px;}
.expand {width:17%;margin-right:2%;float:left;} /*set div's as newspaper columns */
p {display:block;} /*always display p's when JS is disabled */
.more{color:red;display:none;} /*never display a's when JS is disabled */ 
```

### 一些html代码

```
 <div class="expand">

<h3>Headine 1</h3>

<p>1.A paragraph typically consists of a unifying main point, thought, or idea accompanied by supporting details. The non-fiction paragraph usually begins with the general and moves towards the more specific so as to advance an argument or point of view.</p>

<p>2\. Each paragraph builds on what came before and lays the ground for what comes next. Paragraphs generally range three to seven sentences all combined in a single paragraphed statement. In prose fiction successive details, for example; but it is just as common for the point of a prose paragraph to occur in the middle or the end.</p>

<p>3 A paragraph can be as short as one word or run the length of multiple pages, and may consist of one or many sentences. When dialogue is being quoted in fiction, a new paragraph is used each time the person being quoted changed.11</p>

<p>4 The last paragraph</p>

<a  href="#" class="more">more</a>

</div>

<div class="expand">

<h3>Headine 2</h3>

<p>Amet vestibulum. Nisl a, a eros ut, nec vivamus. Tortor nullam id, metus ut pretium. Amet sociis. Ut justo. Amet a est, dolor integer, purus auctor pretium.</p>

<p>Libero sapien sed, nulla nullam. Porta tincidunt. Suspendisse ante ac, eget fermentum vivamus. Ipsum sapien placerat. Adipiscing lorem magna, urna tortor dictum.</p>

<p>Fringilla a morbi, sed sollicitudin magna. Justo et in, sem aenean, molestie integer tincidunt. Magna quo, erat odio. Posuere enim phasellus, dui pede. Sit a mauris, metus suscipit.</p>

<p>Lobortis et, pellentesque nec, suspendisse elit quisque. Justo vestibulum debitis, augue fermentum. Orci et id. Ut elit, tortor ut at. Eum et non, faucibus integer nam, ac ultrices augue.</p>

<p>Ultricies magnis, velit turpis. Justo sit, urna cras primis, semper libero quam. Lectus ut aliquam. Consequat sed wisi, enim nostrud, eleifend egestas metus. Vestibulum tristique. Et erat lorem, erat sit.</p>

<p>Aliquam duis mi, morbi nisl. Rhoncus imperdiet pede. Sit et. Elit fusce, feugiat accumsan incididunt. Nec ipsum feugiat, accumsan dictum massa. Nec sit.22</p>

<a  href="#" class="more">more</a>

</div> 
```

我试图通过使用 each() 使其尽可能简单。
约翰·吉斯

# c# - 如何重构多个相似的 Linq 查询？

> ID：863169
> 
> 赞同：2
> 
> 时间：2009-05-14T12:55:28.800
> 
> 标签：c#, .net, linq, linq-to-sql, refactoring

假设我要重构以下两个 Linq 查询：

```
var someValue1 = 0;
var someValue2= 0;
var query1 = db.TableAs.Where( a => a.TableBs.Count() > someValue1 )
                  .Take( 10 );
var query2 = db.TableAs.Where( a => a.TableBs.First().item1 == someValue2)
                  .Take( 10 ); 
```

请注意，只有 Where 参数会发生变化。有什么方法可以将查询放入方法中并将 Where 参数作为参数传递？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T13:01:26.230

当然有。where 参数只是一个简单的类型闭包`Func<T, bool>`（其中 T 是您的 DB 项的类型 - 我不知道您的代码中的它们），您可以将其包装到（匿名）函数中。

```
Func<Func<T, bool>, IEnumerable<T>> MakeQuery = (Func<T, bool> whereParam) => db.TableAs.Where(whereParam).Take(10); 
```

像这样使用它

```
var query1 = MakeQuery(a => a.TableBS.Count() > someValue1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T13:03:33.603

您可以使用[`Predicate<T>`](http://msdn.microsoft.com/de-de/library/bfcke1bz.aspx).

```
public IQueryable<TableA> Helper(Predicate<TableA> predicate)
{
    return db.TableAs.Where(predicate).Take(10);
} 
```

就这样称呼吧。

```
var query1 = Helper(a => a.TableBs.Count() > someValue1);
var query2 = Helper(a => a.TableBs.First().item1 == someValue2); 
```

并给出一个比`Helper`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T13:00:16.620

是的，参数类型是一个lamba表达式`Func<TSource, bool>`

```
Func<Person, bool> c1 = p => p.LastName == "1";
Persons.Where(c1);
Func<Person, bool> c2 = p => p.FirstName == "2";
Persons.Where(c2) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T13:03:28.017

您可以像重构任何其他代码一样执行此操作：

```
T MyQuery(U db, Func<TSource, bool> pred) {
  return db.TableAs.Where( pred )
                  .Take( 10 );
} 
```

其中 T 和 U 是与您的查询相关的任何类型。

# c - 如何在 Objective-C 中跳出两个嵌套的 for 循环？

> ID：863172
> 
> 赞同：75
> 
> 时间：2009-05-14T12:55:54.370
> 
> 标签：c, objective-c, loops

我有两个这样嵌套的 for 循环：

```
for(...) {
    for(...) {

    }
} 
```

我知道有一个`break`声明。但是我很困惑它是打破两个循环还是仅仅打破它被调用的那个？一旦我发现重复更多次没有意义，我就需要打破这两个。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-05-14T13:40:25.463

如果使用 goto 可以简化代码，那将是合适的。

```
for (;;) 
{
    for (;;) 
    {
        break; /* breaks inner loop */
    } 
    for (;;) 
    {
        goto outer; /* breaks outer loop */
    }
} 
outer:; 
```

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2009-05-14T12:59:09.293

break 会从一个循环中中断，但您可以在外部循环中添加一个检查，当内部中断时会中断。

```
bool dobreak = false;
for ( ..; !dobreak && ..; .. ) {
   for ( ... ) {
      if (...) {
         dobreak = true;
         break;
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-14T13:13:49.757

该`break`语句只会让您脱离最内层的循环。如果您不希望在代码、内存和专用状态变量的性能方面增加开销，我建议将代码重构为它自己的函数或方法，并使用它`return`来摆脱所有循环：

```
void do_lots_of_work(void)
{
  int i, j;

  for(i=0; i<10 ; i++)
  {
    for(j=0;j< 10; j++)
    {
     ..
     ..
     if(disaster_struck())
      return; /* Gets us out of the loops, and the function too. */
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-15T01:16:30.860

除了已经提到的标志变量或 goto 之外，您还可以[抛出](http://developer.apple.com/documentation/Cocoa/Conceptual/Exceptions/Tasks/RaisingExceptions.html)一个 Objective-C 异常：

```
@try {
  for() {
    for() {
       @throw ...
    }
  }
}
@catch{
  ...
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-14T13:59:19.507

其他人提到了如何设置标志或使用 a `goto`，但我建议重构你的代码，以便将内部循环变成一个单独的方法。然后该方法可以返回一些标志来指示外部循环应该`break`。如果您适当地命名您的方法，这将更具可读性。

```
for (int i = 0; i < 10; i++) {
   if (timeToStop(i)) break;
}

-(bool) timeToStop: (int) i {
    for (int j = 0; j < 10; j++) {
        if (somethingBadHappens) return true;
    }

    return false;
} 
```

伪代码，未经测试，但你明白了。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-14T13:00:35.637

break 语句只会跳出作用域内的循环，也就是父循环。如果您也想跳出第二个循环，您可以使用两个循环范围内的布尔变量

```
bool isTerminated = false;

for (...)
{
    if (!isTerminated)
    {
        for(...)
        {
            ...

            isTerminated = true;
            break;
        }
    }
    else
    {
        break;
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-14T13:03:46.863

可能最简单的方法是使用“标志”变量

```
for(i=0; i<10 && (done==false); i++)
  for(j=0;j< 10; j++){
     ..
     ..
     if(...){done=true; break;}
  } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-14T13:10:01.527

在中断前更改顶部循环的计数器

```
for(i=0; i<10 ; i++)
  for(j=0;j< 10; j++){
     ..
     ..
     i = 10; 
     break;
  } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-09-01T20:01:28.880

另一种解决方案是在函数中分解出第二个循环：

```
int i;

for(i=0; i<10 ; i++){
    if !innerLoop(i) {
        break;
    }
}

bool innerLoop(int i)
    int j;
    for(j=0;j< 10; j++){
        doSomthing(i,j);
        if(endcondtion){
            return false;
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-14T13:00:41.097

break 语句跳出最里面的循环。需要一个额外的测试和中断语句来打破外部循环。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-14T12:59:17.887

如果从一组嵌套循环中执行中断，则仅终止执行中断的最内层循环。（就像标准C一样）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-14T13:43:17.177

就像最后一个一样，一般是这样的：

```
for(i=0;i<a;i++){  
 for(j=0;j<a;j++){
  if(Something_goes_wrong){
   i=a;
   break;
   }
 }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-10-07T15:56:48.890

只是为了笑，如何将这个真/假检查更改为方法并使用`return`语句：

```
- (bool) checkTrueFalse: parameters{

   for ( ...) {
      for ( ... ) {

         if (...) {
            return true;
         }

      }
   }
   return false;
} 
```

# c# - 绑定转换器作为内部类？

> ID：863180
> 
> 赞同：8
> 
> 时间：2009-05-14T12:57:49.637
> 
> 标签：c#, .net, wpf, xaml

我有一个使用绑定转换器的 UserControl。我已经把转换器变成了一个内部类

```
public partial class MyPanel : UserControl
{
    public class CornerRadiusConverter : IValueConverter
    { 
```

如何从 XAML 中引用 Converter 类？以下不起作用：

```
<controls:MyPanel.CornerRadiusConverter x:Key="CornerRadiusConverter" /> 
```

它给出了这个错误：

> XML 命名空间“clr-namespace:MyApp.Windows.Controls”中不存在标签“LensPanel.CornerRadiusConverter”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T22:01:12.610

这是可能的。几个月前，我编写了一个标记扩展来为您创建内联转换器。它保留弱引用字典，这样您就不会创建同一个转换器的多个实例。也处理创建具有不同参数的转换器。

在 XAML 中：

```
<TextBox Text="{Binding Converter={NamespaceForMarkupExt:InlineConverter {x:Type NamespaceForConverter:ConverterType}}}"/> 
```

C＃：

```
[MarkupExtensionReturnType(typeof(IValueConverter))]
public class InlineConverterExtension : MarkupExtension
{
  static Dictionary<string, WeakReference> s_WeakReferenceLookup;

  Type m_ConverterType;
  object[] m_Arguments;

  static InlineConverterExtension()
  {
    s_WeakReferenceLookup = new Dictionary<string, WeakReference>();
  }

  public InlineConverterExtension()
  {
  }

  public InlineConverterExtension(Type converterType)
  {
    m_ConverterType = converterType;
  }

  /// <summary>
  /// The type of the converter to create
  /// </summary>
  /// <value>The type of the converter.</value>
  public Type ConverterType
  {
    get { return m_ConverterType; }
    set { m_ConverterType = value; }
  }

  /// <summary>
  /// The optional arguments for the converter's constructor.
  /// </summary>
  /// <value>The argumments.</value>
  public object[] Arguments
  {
    get { return m_Arguments; }
    set { m_Arguments = value; }
  }

  public override object ProvideValue(IServiceProvider serviceProvider)
  {
    IProvideValueTarget target = (IProvideValueTarget)serviceProvider.GetService(typeof(IProvideValueTarget));

    PropertyInfo propertyInfo = target.TargetProperty as PropertyInfo;

    if (!propertyInfo.PropertyType.IsAssignableFrom(typeof(IValueConverter)))
      throw new NotSupportedException("Property '" + propertyInfo.Name + "' is not assignable from IValueConverter.");

    System.Diagnostics.Debug.Assert(m_ConverterType != null, "ConverterType is has not been set, ConverterType{x:Type converterType}");

    try
    {
      string key = m_ConverterType.ToString();

      if (m_Arguments != null)
      {
        List<string> args = new List<string>();
        foreach (object obj in m_Arguments)
          args.Add(obj.ToString());

        key = String.Concat(key, "_", String.Join("|", args.ToArray()));
      }

      WeakReference wr = null;
      if (s_WeakReferenceLookup.TryGetValue(key, out wr))
      {
        if (wr.IsAlive)
          return wr.Target;
        else
          s_WeakReferenceLookup.Remove(key);
      }

      object converter = (m_Arguments == null) ? Activator.CreateInstance(m_ConverterType) : Activator.CreateInstance(m_ConverterType, m_Arguments);
      s_WeakReferenceLookup.Add(key, new WeakReference(converter));

      return converter;
    }
    catch(MissingMethodException)
    {
      // constructor for the converter does not exist!
      throw;
    }
  }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T22:25:08.743

我再次考虑这个问题，我想出了类似于丹尼斯的解决方案：创建一个具有 Type 属性的“代理”转换器类，它将创建实际转换器的实例并将转换委托给它。

```
public class Converter : IValueConverter
{
    private Type _type = null;
    public Type Type
    {
        get { return _type; }
        set
        {
            if (value != _type)
            {
                if (value.GetInterface("IValueConverter") != null)
                {
                    _type = value;
                    _converter = null;
                }
                else
                {
                    throw new ArgumentException(
                        string.Format("Type {0} doesn't implement IValueConverter", value.FullName),
                        "value");
                }
            }
        }
    }

    private IValueConverter _converter = null;
    private void CreateConverter()
    {
        if (_converter == null)
        {
            if (_type != null)
            {
                _converter = Activator.CreateInstance(_type) as IValueConverter;
            }
            else
            {
                throw new InvalidOperationException("Converter type is not defined");
            }
        }
    }

    #region IValueConverter Members

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        CreateConverter();
        return _converter.Convert(value, targetType, parameter, culture);
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        CreateConverter();
        return _converter.ConvertBack(value, targetType, parameter, culture);
    }

    #endregion
} 
```

你这样使用它：

```
<Window.Resources>
    <my:Converter x:Key="CornerRadiusConverter" Type="{x:Type controls:MyPanel+CornerRadiusConverter}"/>
</Window.Resources> 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-05-14T22:12:24.203

我要做的是：

```
<Window.Resources>
   <ResourceDictionary>
    <Converters:BooleanNotConverter x:Key="BooleanNotConverter"/>
   </ResourceDictionary>
</Window.Resources> 
```

然后在控制

```
 <CheckBox IsChecked="{Binding Path=BoolProperty, Converter={StaticResource BooleanNotConverter} /> 
```

# java - 是否可以查看 Eclipse 正在执行的 shell 命令？

> ID：863181
> 
> 赞同：7
> 
> 时间：2009-05-14T12:57:50.403
> 
> 标签：java, eclipse, jar, compilation

我正在处理一个相当长的项目，它需要一个较旧的 JDK 才能正确编译，包括各种 JAR 等等。我正在使用批处理脚本组装整个项目，并且我想使用脚本使整个过程完全自动化。所以我想知道我是否可以查看 Eclipse 执行的 shell 命令以使特定的一段代码变成 JAR（从使用我指定的适当 JDK 编译到制作 JAR），所以我不需要手动进入和浪费大量时间确保我自己在外壳中做正确的事情。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T13:10:02.993

Eclipse 不执行用于编译的 shell 命令。它使用自己的内置编译器。

可以让 Eclipse 为您生成 ANT Script。该脚本可以使用 Eclipse 内置编译器编译您的类。它还将配置类路径以进行编译。这可能是很好的第一步。要创建脚本，请选择您的项目并在上下文菜单中选择 Export > Ant Buildfiles。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T13:17:32.320

据我所知，Eclipse 不会发出 shell 命令来编译或制作 JAR 文件。相反，它使用相应的 Java API。

我经常用来做这种工作的是 ant ( [http://ant.apache.org](http://ant.apache.org) )。

这是一个非常简单的 build.xml 文件，它获取“src”目录中的 java 源代码，使用“lib”目录中的库编译它们，并将生成的类放在文件“project.jar”中。

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="project">
    <target name="package" description="builds the jar file from the compiled classes">
        <mkdir dir="build" />
        <javac srcdir="src" destdir="build">
            <classpath>
                <fileset dir="lib" includes="**/*.jar" />
            </classpath>
        </javac>
        <jar destfile="project.jar">
            <fileset dir="build" includes="**/*.classes" />
        </jar>
    </target>
</project> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-08T14:49:50.687

一个非常好的选择是使用 Ant4Eclipse ( [http://ant4eclipse.sourceforge.net/](http://ant4eclipse.sourceforge.net/) )

这是一组询问 eclipse 项目元数据的 ant 任务，可用于确定正确的项目构建顺序、源和输出目录等。

您还可以将 ant 目标映射到 eclipse 构建器（例如，如果您在 eclipse 中设置了 ANTLR 构建器，则可以定义一个编译 ANTLR 代码的 ant 目标并将其映射到要触发的 ANTLR 构建器的名称）

在我的上一份工作中，我使用 ant4eclipse 编写了一个通用构建脚本。我将尝试在某个时候创建​​一个新的通用构建脚本，但还没有时间。

# c# - 在什么情况下，将字段更改为属性是一项重大更改？

> ID：863182
> 
> 赞同：6
> 
> 时间：2009-05-14T12:58:25.223
> 
> 标签：c#, .net, properties, field

在阅读 Jon Skeet 关于[字段与属性](http://csharpindepth.com/Articles/Chapter8/PropertiesMatter.aspx)的文章时，他提到将字段更改为属性是一项重大更改。

我想了解此更改可能导致中断的常见情况。连同场景一起，如果可以的话，请提供任何细节。

首先，在其他地方已经提到了以下几点：

*   如果您在类上使用反射，则无法将字段更改为属性。即使我没有详细信息，这也很明显。序列化是一种使用反射来迭代对象并将字段更改为属性将破坏序列化程序或更改输出的场景

*   您不能轻易地绑定字段。（这是为什么呢？我在[这里](https://stackoverflow.com/questions/174198/c3-0-automatic-properties-why-not-access-the-field-directly)读到了）

*   ？？？

编辑：罗伯特列出了选择[属性而不是字段](https://stackoverflow.com/questions/205568/have-trivial-properties-ever-saved-your-bacon/207146#207146)的原因，并解释了它们之间的切换如何导致重大变化。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T13:01:14.060

如果您有一个公共字段并且另一个程序集有代码正在使用它，则需要重新编译它。

IOW 中断的定义包括“将需要重新编译”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T13:09:32.090

属性可以抛出任意异常，而字段则不能（至少当编译器在编译时知道字段分配时）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T13:00:30.787

至少在 Windows 窗体中，您只能将 DataGridViewColumns 之类的数据绑定到业务对象的属性，而不是字段。因此，如果您的类被用作网格的数据源，则其属性更改为字段将为网格所有者带来一些新错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-25T20:46:46.997

您可以将字段作为`ref`或`out`参数传递，或在不安全的上下文中获取其地址，而您不能对属性执行这些操作。

# python - Python：在 lxml 中添加命名空间

> ID：863183
> 
> 赞同：8
> 
> 时间：2009-05-14T12:58:32.100
> 
> 标签：python, lxml, xml-namespaces

我正在尝试使用类似于此示例的*lxml*指定名称空间（取自[此处](http://www.maconstateit.net/tutorials/XML/XML03/xml03-01.htm)）：

```
<TreeInventory xsi:noNamespaceSchemaLocation="Trees.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
</TreeInventory> 
```

我不确定如何添加要使用的 Schema 实例以及 Schema 位置。通过执行以下操作，[文档](http://codespeak.net/lxml/tutorial.html#namespaces)让我开始了：

```
>>> NS = 'http://www.w3.org/2001/XMLSchema-instance'
>>> TREE = '{%s}' % NS
>>> NSMAP = {None: NS}
>>> tree = etree.Element(TREE + 'TreeInventory', nsmap=NSMAP)
>>> etree.tostring(tree, pretty_print=True)
'<TreeInventory xmlns="http://www.w3.org/2001/XMLSchema-instance"/>\n' 
```

我不确定如何将其指定为实例，然后还指定位置。似乎这可以使用`nsmap`关键字参数 in来完成`etree.Element`，但我不明白如何。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T14:59:28.333

为了清楚起见，在更多步骤中：

```
>>> NS = 'http://www.w3.org/2001/XMLSchema-instance' 
```

据我所知，它是`noNamespaceSchemaLocation`您想要命名空间的属性，而不是`TreeInventory`元素。所以：

```
>>> location_attribute = '{%s}noNamespaceSchemaLocation' % NS    # f-string doesn't work in this case
>>> elem = etree.Element('TreeInventory', attrib={location_attribute: 'Trees.xsd'})
>>> etree.tostring(elem, pretty_print=True)
'<TreeInventory xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="Trees.xsd"/>\n' 
```

这看起来像你想要的......你当然也可以先创建元素，没有属性，然后设置属性，如下所示：

```
>>> elem = etree.Element('TreeInventory')
>>> elem.set(location_attribute, 'Trees.xsd') 
```

至于`nsmap`参数：我相信它只是用来定义在序列化时使用哪些前缀。在这种情况下，不需要它，因为 lxml 知道所讨论的命名空间的常用前缀是“xsi”。如果它不是某个众所周知的命名空间，您可能会看到诸如“ns0”、“ns1”等前缀，除非您指定了您喜欢的前缀。（记住：前缀不应该重要）

# wpf - WPF/MVVM 应用程序的数据层框架的最佳特性是什么？

> ID：863186
> 
> 赞同：6
> 
> 时间：2009-05-14T12:59:09.573
> 
> 标签：wpf, mvvm, frameworks

我正在创建一个为模型类生成代码的 WPF/MVVM 框架。

我计划为每个数据库表/网络服务（例如“客户”）提供**两个模型类**：

*   一个单一的模型类（例如“客户”）
*   和复数模型类（例如“客户”）

**奇异模型类**具有其所有属性（FirstName、LastName 等）以及对奇异实例有意义的所有方法，例如 Save()、Delete()、CalculateSalary() 等。

**复数模型类**有一个单一模型对象的集合，加上相同的方法，因为您还想对一组单一对象执行，例如 Save()、Delete()、CalculateSalary()，还有一些特殊的方法，例如 Sort ()，以及使某些组变得非常容易的方法，例如 LoadAllGoldCustomers()，甚至 LoadWithSql(string sql) 等。

我以前做过这样的框架（PHP），它使编写和理解这样的代码变得非常容易：

```
Customers customers = new Customers("all");
customers.CalculateSalary(); 
```

几个继承的类（Item 和 Items）从每个数据库表的单个单数和复数类中提取了大部分代码，这为编程提供了一个非常干净的环境。

但是，**我很少看到其他应用程序执行这种**单数/复数模型类拆分。相反，每个数据库表几乎总是只有一个类，例如`Customer`，这个类有任何必要的复数方法，例如 GetCustomers(string sql) 等。

我刚刚在[WPF Model-View-ViewModel Toolkit 0.1](http://www.codeplex.com/wpf/Release/ProjectReleases.aspx?ReleaseId=14962)演练中注意到，他们让您将两个模型作为“模型”目录的两个类：

*   Customer.cs（仅限字段）
*   CustomersDataSource.cs（一个 List Load() 方法）

这**似乎是一个类似的概念**，只是“复数”类被称为数据源。

所以现在我要制作另一个基于 WPF/MVVM 的框架，并且可以决定如何构建模型类。我希望框架是：

*   **清晰且易于从 ViewModel 进行编程**，因此单数和复数模型类的明确分离，您应该只需要实例化一个单数或复数类并在其上调用一个方法，然后您就拥有了数据。
*   **非常适合 MVVM 模式**（我理解这意味着保持尽可能简单，只有 ViewModel 可以调用的属性和方法，但不实现 WPF 特定的功能，例如 INotifyProperityChanged）
*   希望我的数据层**位于任何数据源之上**，所以如果我使用 LINQ-to-SQL，我仍然会调用我自己的模型类，如果我想切换到保存在 Oracle 中，我会为我的类编写一个较低的数据适配器层进行交互接着就，随即。
*   **以最佳方式**利用 LINQ****

 **我很感谢那些为框架开发数据层的人的反馈，特别是使用 WPF/MVVM/复合应用程序库，以及您发现哪些特性最有效，或者您是否使用过其他框架，如 CSLA、Subsonic 等。此外，任何经验或关于 LINQ 如何更改/简化构建数据层结构的想法。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-18T16:01:33.103

哇。如果没有一天的时间坐下来与您交谈，这是一个很难回答的问题。但无论如何，这里有一个缩短的版本。

首先，尝试将框架或该框架的任何特征从一种语言移植到另一种语言似乎是在尝试将方形钉插入圆孔中。虽然我不怀疑功能（例如客户和客户）可以移植，但我当然可以争辩说它们不应该移植。坚持使用 customer.CalculateSalary 示例，您可以使用 .NET 并为 IEnumerable 创建一个扩展方法，该方法执行相同的操作，从而无需该客户类。我知道您可能还有其他功能，但这只是一个示例。另一个例子是使用 LINQ 对 IEnumerable 进行排序。

其次，我个人发现在对象内部拥有持久性方法（例如 Save、Delete 等）在大型系统中效果不佳，尤其是在处理 WCF 时。在这些情况下，稍后使用某种类型的存储库似乎效果更好，这似乎也适合您在开发过程中切换到 Oracle 的观点。

我也想完全不同意你关于很好地融入 MVVM 的问题。对我来说，视图模型是模型和视图之间的粘合剂。视图模型不仅可能需要了解视图（因此，WPF 特定功能），而且希望它知道它。ICommand 是视图模型了解的关键接口，并且是 WPF-y 程序集之一（WindowsBase、PresentationCore、PresentationFramework，不记得是哪个）。此外，INotifyPropertyChanged 对数据绑定也很重要，应该在所有视图模型中实现，与 WPF 无关（我认为来自 System.ComponentModel？）。

那是我的两分钱。同样，在对您的问题的简短回答中很难解释这一点。我建议在为它制作框架之前使用该模式一段时间。祝你好运！

# asp.net - 更新中继器中的面板 - 为什么不能同时进行多个回调？

> ID：863188
> 
> 赞同：3
> 
> 时间：2009-05-14T12:59:35.017
> 
> 标签：asp.net, asp.net-ajax, updatepanel

我在中继器中有一个更新面板

（编辑：我删除了 Runat 和 Id 属性以使帖子看起来更干净）

```
<asp:Repeater>
    <ItemTemplate>
        <asp:UpdatePanel UpdateMode="Conditional">
            <ContentTemplate>
                 <asp:LinkButton onclick="btnCallback_Click" />
            </ContentTemplate>
        </asp:UpdatePanel>
        <asp:UpdateProgress DisplayAfter="0">
            <ProgressTemplate>
                <img src="spinningProgress.gif" />
            </ProgressTemplate>
        </asp:UpdateProgress>
    </ItemTemplate>
</asp:Repeater> 
```

这里的想法是单击 LinkBut​​ton，它会回调并为该数据项执行服务器端操作。这对于一个项目非常有效。但是，如果我在不等待前一个更新面板完成回调的情况下单击每个项目的按钮，它似乎取消了前一个回调。

UpdatePanels 不能同时执行回调吗？无论如何我可以做到，所以您无需等待即可单击下一步按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T13:15:05.820

通过 UpdatePanel 执行的每个 AJAX 请求都会取消之前的任何请求（如果之前的请求仍在运行）。这就是它的构建方式。UpdatePanel AJAX 请求与请求一起传递 ViewState 的一部分。协调由并发 ajax 调用返回的多个任意视图状态是不可能的（至少非常困难）。我听说这是 MS 选择以这种方式构建它的主要原因。

编辑：使用 jQuery 并玩得开心 :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-29T17:20:53.197

我以前也有同样的问题。但我发现制作一些技巧可以让您在不同的微软更新面板中实现多个 ajax 回调。

```
function ProcessCallBack(uniqID)
{
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    //checking if there is somewhere perforimg of callback
    if (prm.get_isInAsyncPostBack()) 
    {
        setTimeout("ProcessCallBack()", 1000); //here we move execution of callback 
        //for 1 sec forward
    }
    else
    {
        __doPostBack(uniqID,'');
    }
    return false;
} 
```

因此，您必须将对该函数的调用添加到您的按钮或客户端单击控件中。uniqID 是服务器控件的唯一标识，可以在服务器端获取。所以享受吧，记住一切皆有可能，但有些人需要很多时间去做:-)我在想，为什么微软的人没有实现这样的事情:-)

# iphone - 处理 iphone 应用程序中的致命错误

> ID：863189
> 
> 赞同：2
> 
> 时间：2009-05-14T13:00:00.133
> 
> 标签：iphone

如何处理 iPhone 应用程序中的错误？登录并退出？显示警告对话框并退出？例如，如果捆绑包中缺少图像..即使它不应该...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T13:21:12.717

您永远不应该以编程方式退出应用程序。建议用户出现问题，提供再试一次等​​。但不要杀死应用程序。这在 Apple HIG 中是明确的。

让用户决定您的应用需要退出。不要为他们做。

理想情况下，不要让自己陷入这种情况。:) 我知道说起来容易做起来难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T14:59:12.623

@Genericrich 非常适合：

> 建议用户出现问题，提供再试一次等​​。但不要杀死应用程序。这在 Apple HIG 中是明确的。

我要补充的唯一建议是期待意外。只需确保您的应用程序已准备好应对这些小问题。这可能是：填充空白的默认信息、让用户知道发生了什么/重试的足够警报、在尝试容易失败的破坏性操作之前保存状态，以及您能想到的任何其他防御性编程习惯。

作为补充说明，如果您想测试网络错误，您可能需要查看 Craig Hockenberry 的出色帖子[Slow Ride，让](http://furbo.org/2009/03/24/slow-ride-make-it-easy/)主题变得简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T13:12:49.430

警报框和退出应该没问题。简短而甜蜜，只需与用户进行足够的沟通，让他们知道您的软件将无法运行的原因。

# performance - 您将如何优化/模拟大图像文件的“随机”加载？

> ID：863190
> 
> 赞同：1
> 
> 时间：2009-05-14T13:00:13.843
> 
> 标签：performance, image, webserver

我们使用大型背景图片（高分辨率照片，最大 700 KB）进行页面设计。这是网站体验的一部分，当您四处浏览时，您会看到不同的图像。

目前，每个页面请求都会从大约 15 个图像池中加载一个不同的（随机）图像，该图像池可能会随着时间的推移而增长。

我正在寻找一种合理的方法来优化它：

1.  避免用户在*每次*浏览页面时都必须下载大图像文件
2.  为了减少服务器上的负载（这是一个问题，服务器会将图像保存在内存中吗？）

到目前为止，我的想法包括：

*   以设定的时间间隔加载不同图像的计时器
*   使用ajax在后台逐步加载其他图像
*   将图像与特定内容（页面、标签）相关联

问题是，如何让它感觉有点随机，同时最大限度地减少页面加载时间和服务器访问？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:05:05.690

我通常会避开图片很大的网站，我很不耐烦。我会重新考虑你的设计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T13:05:59.650

作为第一步，您应该确保可以正确缓存图像：

*   使用健全的网址（没有会话 ID 等）
*   设置适当的 http 标头[ETag](http://de.wikipedia.org/wiki/HTTP_ETag)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T13:12:20.430

首先，听说仅背景图像就有 700kb，这让我感到震惊。除了屏幕上的内容......这是一个相当沉重的网站。

对于初学者，我会尝试使用图像压缩工具。我想到了两个工具 Imagemagick 和 PNGCrush。PNGCrush 非常擅长减少附加到照片的所有无关元数据，而不会影响照片质量。

我只推荐这样做，因为压缩图像将帮助您使用户能够下载更少量的内容，这意味着更快的加载时间，这......最终......这是用户想要的。

我还将缓存图像，这样当用户重新访问该站点时，图像已经缓存在他们的末端。这可以最大限度地减少每次用户访问您的站点时发出的 HTTP 请求。在商业网站上使用这种技术的一个例子是 www.reactive.com。如果您查看 /js/headerImages.js 文件，它们会使用图像缓存。有趣的是，您会在以下位置找到相同的 src 代码：http: [//javascript.internet.com/miscellaneous/random-image.html](http://javascript.internet.com/miscellaneous/random-image.html)

考虑到您提到图像是随机加载的，我假设您正在使用 jQuery 等 Javascript 库来创建效果。如果你是，你可以通过使用 CDN 来最小化页面加载时间，而不是引用存储在服务器上的 jQuery 库的本地副本。我在为客户创建的网站上进行了性能测试，平均超过 20 次点击，通过这种技术节省了 1.6 秒！

希望现在有帮助:)

# xml - XSL 遍历问题（带有服务器错误：）

> ID：863196
> 
> 赞同：0
> 
> 时间：2009-05-14T13:00:54.903
> 
> 标签：xml, xslt

我认为，我手头有一个有趣的情况。我有一个车库 XML，并且正在将它（使用 XSL）转换为 HTML。

**汽车 XML：**

```
<car>
   <licensePlate>Car001</licensePlate>
   <feature>
      <color>Blue</color>
      <fuel>Unleaded</fuel>
   <feature>
</car> 
```

我只想打印`<color>`&`<fuel>`但想`<licensePlate>`在 HTML 链接中设置为 href。

**汽车 XSL：**

```
<xsl:template match="car">
   <tr>
      <xsl:apply-templates select="licensePlate"/>
      <xsl:apply-templates select="feature"/>
   </tr>
</xsl:template>

<xsl:template match="feature">
   <td>
      <a href="{preceding-sibling::licensePlate/text()}>
          <xsl:apply-templates select="color"/>
      </a>
   </td>
   <td><xsl:apply-templates select="fuel"/></td>
</xsl:template> 
```

这使我能够实现将标签设置为 href 值的目标。

但是出现了一个问题...... licensePlate 的所有值都打印到屏幕上。

有人可以推荐如何防止它打印到屏幕上吗？

我试过注释掉，`<xsl:apply-templates select="licensePlate"/>`但我认为这会影响`preceeding-sibling::`语句，因为我收到一个错误

尝试应用 CSS 时，我也收到此错误`display:none`。

谢谢你的时间和耐心，卢卡斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:04:24.897

你应该注释掉`<xsl:apply-templates select="licensePlate"/>`。如果您正确注释掉它，它不可能是错误的原因。

另外： `<a href="{preceding-sibling::licensePlate/text()}>`<--yuikes！

`<a href="{../licensePlate}>`！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T13:17:34.910

```
<xsl:template match="car">
  <tr>
    <xsl:apply-templates select="feature" />
  </tr>
</xsl:template>

<xsl:template match="feature">
   <td>
      <a href="{../licensePlate}">
        <xsl:value-of select="color" />
      </a>
   </td>
   <td>
      <xsl:value-of select="fuel" />
   </td>
</xsl:template> 
```

会产生：

```
<tr>
  <td>
    <a href="Car001">Blue</a>
  </td>
  <td>Unleaded</td>
</tr> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T13:17:57.953

这是一种方法。我假设您已经完成了颜色和燃料的模板。

```
<xsl:template match="car">
    <tr>
        <xsl:apply-templates select="feature"/>
    </tr>
</xsl:template>

<xsl:template match="feature">
    <td>
        <a>
            <xsl:param name="href">
                <xsl:value-of select="../licensePlate"/>
            </xsl:param>
            <xsl:apply-templates select="color"/>
        </a>
    </td>
    <td>
        <xsl:apply-templates select="fuel"/>
    </td>
</xsl:template> 
```

# php - php非贪婪正则表达式问题

> ID：863197
> 
> 赞同：0
> 
> 时间：2009-05-14T13:01:04.607
> 
> 标签：php, regex, non-greedy

演示：

```
$str = 'bcs >Hello >If see below!';
$repstr = preg_replace('/>[A-Z0-9].*?see below[^,\.<]*/','',$str);
echo $repstr; 
```

我希望这个小程序输出的是“bcs >Hello”，但实际上它只是“bcs”

我的模式有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T16:33:27.437

我认为问题在于您误解了非贪婪量词的行为方式。是的，一旦它开始运行，它就会比其他情况更早停止。但它不**知道**它之前的内容（或者可能是之后的文本）。它只关心它的当前位置。因此，您发布的正则表达式将匹配所有：

```
">Hello >If see below!" 
```

让我们看看这是如何工作的：

```
/>[A-Z0-9].*?see below[^,\.<]*/ 
```

正则表达式首先在“bcs >Hello >If see below!”中查找“>”，然后找到第一个，即“Hello”之前的那个。好的，让我们检查表达式的下一部分：

```
[A-Z0-9] 
```

下一个字符是 H，它与模式 [A-Z0-9] 匹配。还好！下一个：

```
.*? 
```

现在我们匹配所有非换行符，直到我们到达第*一个实例*以匹配“见下文[^,.<]*”的剩余表达式。如果我们只使用一个普通的贪心量词，我们可以匹配多个“见下文[^,.<]*”的情况，直到我们匹配最后一个可能的情况。（因此，如果您的字符串继续，并且有其他文本匹配该模式，它也会捕获该模式）非贪婪量词*并不意味着您的整个模式将返回*所有可能的最小匹配匹配字符串。它只是规定了特定字符匹配的功能。

您可能想尝试以下模式：

```
/>[A-Z0-9][^>]*?see below[^,\.<]*/ 
```

希望这可以清除它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T13:43:55.673

你为什么不这样写：

```
$str = 'bcs >Hello >If see below!';
$repstr = preg_replace('/>If see below[^,\.<]*/','',$str);
echo $repstr; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T13:59:03.423

这可能是你所拥有的一个很好的选择。您的正则表达式的问题在于，您不是选择您想要的，而是选择您不想要的并将其替换为空字符串。在我看来，最好的方法是选择你想要的，这就是下面的代码所做的。你最终得到的是第一个子模式匹配的内容，否则你会得到你的字符串。

```
$str = 'bcs >Hello >If see below!';
$repstr = preg_replace('/^([\w]+ >[\w]+).*?see below.*?$/i', '$1', $str);
var_dump($repstr); 
```

我希望这有帮助。

# c# - Wpf - 接收框架元素属性的属性值更改通知

> ID：863207
> 
> 赞同：5
> 
> 时间：2009-05-14T13:02:39.127
> 
> 标签：c#, .net, wpf, xaml

如何挂钩到 FrameworkElement 的属性的属性值更改通知？我们在运行时加载 xaml，对于可视化树中的每个元素，当有人更改元素的属性值时，我们需要连接一些东西以接收属性值更改通知。

如果存在，最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T13:25:52.783

如果您想在依赖属性的值更改时收到通知，您可以这样做（Tag 属性的情况）：

```
DependencyPropertyDescriptor desc = DependencyPropertyDescriptor.FromProperty(FrameworkElement.TagProperty, typeof(FrameworkElement));
desc.AddValueChanged(someObject, someEventHandler); 
```

# asp.net-mvc - ASP.NET MVC - 是否可以生成跨应用程序操作链接？

> ID：863215
> 
> 赞同：0
> 
> 时间：2009-05-14T13:03:47.610
> 
> 标签：asp.net-mvc, html-helper, actionlink, routevalues

是否可以使用 HTML 帮助程序类生成跨应用程序操作链接？

我有以下内容（两者都是单独的 VS2008 项目）：

```
http://主网站/
http://mainwebsite/应用程序

```

我想在 /mainwebsite/application/ 项目中生成一个链接到 /mainwebsite/。这可能吗？还是我应该硬编码一个超链接？

**另外：**
我的问题反之亦然。因此在 /mainwebsite/ TO /mainwebsite/application/ 中生成一个链接。通过将应用程序名称模拟为控制器名称，我已经设法做到了：

```
<% =Html.ActionLink("ApplicationName","",new With {.Controller = "application" }) %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T13:08:34.747

是的，你可以这样做。HTML 助手[使用路由系统生成 URL，它完全不了解 ASP.NET MVC](http://blogs.teamb.com/craigstuntz/2009/03/18/38085/ "ASP.NET 路由和 ASP.NET MVC")和您的应用程序。如果您的路由表中有另一个应用程序的路由，那么您可以使用 HTML 帮助程序为其生成一个 URL。没有规则规定您的路由表只能包含当前应用程序的路由，尽管您显然需要注意如何对路由进行排序。

# java - 制作 java 自定义注解来标记 html 清理的 bean 属性

> ID：863216
> 
> 赞同：0
> 
> 时间：2009-05-14T13:04:21.293
> 
> 标签：java, annotations, javabeans

我可以使用 Java 自定义注释将一些代码添加到 bean 属性的 set 或 get 方法中，以清除用户输入的错误 html 中的属性吗？我一直在寻找例子，但我还没有看到我觉得可以扩展的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T13:31:24.877

您可以定义一个自定义注释以向您的设置器添加一个验证器，但是您是否有理由不希望在没有注释的情况下将验证嵌入到您的 bean 中？如果其他人需要使用您的代码，注释机制可能难以理解。

我会这样做：与其让您的属性成为字符串，不如定义您自己的 HtmlString（假设标准库中尚不存在等效类），它只能用有效的 HTML 实例化。然后，让您的 bean 属性属于该类型。这将解决组件中的验证问题。

在 HtmlString 中定义验证方法以满足您的要求，以便每个 HtmlString 实例都是有效的 HTML；然后，只需定义一个 toString 方法。其他人可能更容易遵循这种方法。

# bsod - 假设我正在编写我的代码，然后我的电脑死了，如果我不希望我以后的源代码被污染，那么有必要进行一次完整的扫描吗？

> ID：863221
> 
> 赞同：0
> 
> 时间：2009-05-14T13:05:42.943
> 
> 标签：bsod

假设我正在编写一个 Ruby on Rails 程序，并且在编辑文件时，机器蓝屏。在这种情况下，如果我不希望以后的文件损坏，有必要重新扫描整个硬盘驱动器吗？

假设操作系统在我的计算机崩溃时正在删除一个 tmp 文件，并且仍然有一些指向硬盘驱动器上某个扇区的指针。如果我新创建的文件恰好在那些扇区中，并且下次操作系统再次清理文件时，它可能会认为上次没有清理“剩余”扇区并再次清理它，并损坏我们的源代码. （尤其是 Ruby on Rails，源代码可以由 rails 而不是我们生成，如果文件受到影响，我们可能不知道为什么我们的 rails 服务器无法工作）。我们可以依赖 SVN，但是如果文件在我们签入之前受到影响怎么办？

我认为官方的回答将是：“在崩溃或断电后始终扫描磁盘，以获取数据甚至空间并指示尝试修复任何坏扇区”，但问题是，如今硬盘驱动器如此之大，扫描所有内容可能需要 2 小时。尤其是在工作中，如果是中午，我们不能等待 2 个小时。

有人知道现代操作系统，如 XP、Vista、Mac OS 和 Linux（有时电源线松了，它没有正确关闭，只是在 0% 电池电量下关闭），这些现代操作系统是我们的源代码安全吗？他们是否知道如何构造写入扇区，以便最多会浪费扇区而不是重叠扇区？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T23:40:46.053

使用现代日志文件系统（ext3/4，NTFS），唯一的问题是文件可能处于“半写”状态。显然扫描不会对此有所帮助（这就是备份的用途）。文件系统本身不能损坏。如果您使用的是 FAT 之类的东西，那么是的，您应该担心这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T23:36:47.700

这里真的只有1个问题。

当前是否以某种“半写”状态写入任何文件。

造成这种情况的主要原因是应用程序/编辑器正在写入文件并且机器在中途死机。在这种情况下，要写入的文件已经完成了一半。如果写完了原文件，原文件就“没了”，而新的文件就“完成了一半”。如果您没有备份文件，那么，您就有问题了。

至于具有悬空指针的文件，或对未写入扇区的引用，或类似的东西。该问题取决于您的文件系统。

主要的现代文件系统被记录下来，并且“不允许”这种情况发生。您可能有“半写”，但那是因为应用程序只写了一半，而不是文件系统丢失了扇区指针的轨道。

如果您正在玩文件系统游戏以提高性能或其他任何东西（例如使用不带日志记录的 UFS），那么您可能需要运行 fschk 来清理文件系统元数据。

但是，如果您使用的是现代操作系统和文件系统（即过去 5 年的任何东西），您就不会有这个问题。

最后，如果您确实运行了版本控制，那么只需执行“svn status”，它会向您显示任何“损坏”的文件，因为它们会发生变化，并且它也会检测到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T09:32:25.573

我看到了一些关于

[http://en.wikipedia.org/wiki/Journaling_file_system](http://en.wikipedia.org/wiki/Journaling_file_system)

日志文件系统

文件系统可以提供日志，在系统崩溃的情况下提供安全恢复。日志文件系统将一些信息写入两次：首先写入日志，它是文件系统操作的日志，然后写入其在普通文件系统中的适当位置。日志由文件系统驱动程序处理，并跟踪发生的每个更改磁盘内容的操作。如果发生崩溃，系统可以通过重播日志的一部分来恢复到一致的状态。许多 UNIX 文件系统提供日志，包括 ReiserFS、JFS 和 Ext3。

相比之下，非日志文件系统通常需要通过诸如 fsck 或 chkdsk 之类的实用程序在不正常关闭后检查是否存在任何不一致。软更新是日志的替代方法，它通过仔细排序更新操作来避免冗余写入。日志结构文件系统和 ZFS 也与传统的日志文件系统不同，它们通过始终写入数据的新副本、避免就地更新来避免不一致。

# c# - 无法（或能够）列出 。投掷 ()?

> ID：863222
> 
> 赞同：11
> 
> 时间：2009-05-14T13:05:48.417
> 
> 标签：c#

试试下面的代码

```
public enum Color
{
    Blue=1,
    Red=2, 
    Green=3 
}

public List<Color> ConvertColorEnum()
{
    var intColor = new List<int>(){1,2,3};
    return intColor.Cast<Color>().ToList();
} 
```

你认为`ConvertColorEnum()`会返回一个颜色列表，即`List<Color>(){Color.Blue, Color.Red, Color.Green}`？

我在 2 台机器上对此进行了测试，一台使用 .net 3.5（mscorlib 版本 2.0.50727.1433），另一台使用 .net 3.5 SP1（mscorlib 版本 2.0.50727.3082）。结果不同——.net 3.5 抛出了一个`InvalidCastException`因为无法将整数转换为枚举，而 .net 3.5 SP1 可以成功运行，并返回正确的结果。

任何人都想在他/她的机器上尝试这个并报告结果或解释为什么会这样？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-14T13:07:12.440

如果您希望它以任何一种方式工作，请`Select`改用。

```
return intColor.Select(i=>(Color)i).ToList(); 
```

至于为什么……？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T13:19:26.577

Cast 扩展方法使用了一个迭代器，它在下一步移动时将原始枚举器的输出存储在一个对象变量中（因此根据需要进行装箱），然后尝试将其转换为结果类型。

装箱形式的值类型不会以与未装箱时相同的方式响应强制转换操作（可以进行各种自动转换），而是只允许强制转换为其原始未装箱形式。

我可以想象，Cast 扩展的先前实现要么完全不同，要么有一些特殊的外壳用于枚举类型转换为整数形式（这很棘手，因为你必须处理所有可能的形式）

马克关于正确解决方案的回答是完全正确的，并且由于上述拳击原因，实际上比演员阵容更有效。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T13:35:58.720

[您可以在发行说明中](http://msdn.microsoft.com/en-us/library/dd310284.aspx)了解 SP1 与 .net 3.5 框架的原始发行版之间的区别。

以下是它对这个特定问题的说明：

> 在诸如 System.Collections.ArrayList 等非泛型集合的 LINQ 查询表达式中，查询的 from 子句由编译器重写，以包含对 Cast 运算符的调用。Cast 将所有元素类型转换为查询中 from 子句中指定的类型。此外，在 Visual C# 2008 的原始发行版中，Cast 运算符还执行一些值类型转换和用户定义的转换。但是，这些转换是通过使用 System.Convert 类而不是标准 C# 语义来执行的。在某些情况下，这些转换还会导致严重的性能问题。在 Visual C# 2008 SP1 中，Cast 运算符被修改为针对数值类型和用户定义的转换引发 InvalidCastException。此更改消除了非标准 C# 转换语义和性能问题。以下示例说明了此更改。

您还可以在[此博客文章](http://blogs.msdn.com/ed_maurer/archive/2008/02/16/breaking-change-in-linq-queries-using-explicitly-typed-range-variables.aspx)中获得更多详细信息。

# java - 图像图标 + 图像图标 = 图像图标

> ID：863223
> 
> 赞同：1
> 
> 时间：2009-05-14T13:05:54.783
> 
> 标签：java, graphics

我有两个 ImageIcon，我想创建第三个 ImageIcon，它在 nr 1 上绘制了 nr 2。我该怎么做才能最好？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T13:14:57.303

以下代码`Image`从两个`ImageIcon`s 中获取一个并创建一个新的`ImageIcon`.

第二个图像`ImageIcon`被绘制在第一个图像的顶部，然后生成的图像用于制作一个新的`ImageIcon`：

```
Image img1 = imageIcon1.getImage();
Image img2 = imageIcon2.getImage();

BufferedImage resultImage = new BufferedImage(
    img1.getWidth(null), img1.getHeight(null), BufferedImage.TYPE_INT_ARGB);

Graphics2D g = resultImage.createGraphics();
g.drawImage(img1, 0, 0, null);
g.drawImage(img2, 0, 0, null);
g.dispose();

ImageIcon resultImageIcon = new ImageIcon(resultImage); 
```

**编辑** （修复了一些错误，添加了透明度支持。）

为了允许透明度，`BufferedImage.TYPE_INT_ARGB`可以将 用于构造函数中的图像类型，而不是`BufferedImage.TYPE_INT_RGB`没有 alpha 通道的图像类型。

# ruby-on-rails - 如何将存储在数据库中的文件附加到操作邮件程序？

> ID：863226
> 
> 赞同：0
> 
> 时间：2009-05-14T13:06:07.653
> 
> 标签：ruby-on-rails, actionmailer, email-attachments

您提到了如何将文件存储在数据库中。如何使用 action mailer 将这些文件附加到邮件中？我搜索了许多站点，但找不到附加数据库文件的方法。到处都提供了附加存储在文件系统中的文件的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T22:34:54.120

这与发送存储在磁盘上的附件没有太大区别。

假设您有一个`Binary`与文件系统中的文件相对应的模型。如果它响应`content_type`and `data`，那么这样的事情应该可以工作：

```
class AttachmentMailer < ActionMailer::Base
  def attachment(recipient, binary)
    recipients recipient
    subject "Your requested file"
    from "example@example.com"

    attachment :content_type => binary.content_type, :body => binary.data
  end
end

# Wherever you want to e-mail something:
binary = Binary.find(:first)
Notifier.deliver_attachment("user@example.com", binary) 
```

当然，如果您以不同的方式存储数据或数据库列的名称不同，则应调整`Binary`上述示例中的类（或您使用的任何类）的方法。

我希望这有帮助。

# nhibernate - NHibernate 不会删除孤立对象

> ID：863228
> 
> 赞同：0
> 
> 时间：2009-05-14T13:06:12.253
> 
> 标签：nhibernate, nhibernate-mapping

我有几个看起来像这样的课程

```
public class Token
{
    public int Id
    {
        get;
        set;
    }

    public ITokenInstance Instance
    {
        get;
        set;
    }
}

public interface ITokenInstance
{
    int Id
    {
        get;
        set;
    }

    Token Token
    {
        get;
        set;
    }
} 
```

和映射文件

```
 <class name="Token" >
   <id name="Id" >
      <generator class="hilo" />
   </id>

   <any name="Instance" meta-type="class" id-type="Int32" cascade="all-delete-orphan">
      <column  name="instance_type" />        
      <column name="instance_id" />
   </any>
</class>

<class name="TokenInstanceOne" >
   <id name="Id" >
      <generator class="hilo" />
   </id>

   <many-to-one name="Token" class="Token" column="token_id"/>
</class> 
```

我有 ITokenInstance 接口的各种实现，都在不同的表中查找，但都使用相同的 baisc 结构，如映射中所示。问题是虽然我可以将新的 ITokenInstance 添加到没有实例集（null）的令牌并且它会正确更新我不能将新实例添加到已经有实例的令牌然后更新它，NHibernate 将添加我提供的新实例，但不删除现在未分配的实例。例如

```
Token token = Session.Get<Token>(4);
var instance = Session.Get<TokenInstanceOne>(1);
Assert.AreSame(token.Instance, instance);

var newInstance = new TokenInstanceOne();
token.Instance = newInstance;
newInstance.Token = token;
instance.Token = null;
Session.Flush(); 
```

这会触发 SQL 以插入新的 TokenInstance，并更新令牌表以指向它，它不会删除最初设置为令牌的实例。有谁知道我如何指示 NHibernate 从数据库中删除原始 TokenInstance

EIDT：我错过了现在包含在代码示例中的一些内容（将原始 TokenInstance 的 Token 引用设置为 null）。也只是为了澄清这是 SQL NHibernate 正在生产的；

1.  插入到 TokenInstanceOne（token_id，Id）值（@p0，@p1）；@p0 = '4'，@p1 = '32768'
2.  UPDATE Token SET instance_type = @p0, instance_id = @p1 WHERE Id = @p2; @p0 = 'ClassLibrary1.TokenInstanceOne'，@p1 = '32768'，@p2 = '4'
3.  更新 TokenInstanceOne SET token_id = @p0 WHERE Id = @p1; @p0 = ''，@p1 = '1'

注意最后一个更新是设置 token_id = ''，我需要的是 NHibernate 来删除该行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:01:35.990

NHibernate 没有实现所谓的*持久垃圾回收*。在某些情况下，您需要明确删除实体。级联适用于您删除 Token 的情况。

这是你的代码：

```
var token = Session.Get<Token>(4);
Assert.IsNotNull(token.Instance);

// remove the old token
Session.Delete(token.Instance);

// assign the new token
var newInstance = new TokenInstance();
token.Instance = newInstance;
newInstance.Token = token;

// don't need to call update, the token is in the session.
// (except you turned off session flush)
// Session.Update(token); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T13:07:57.867

对不起，我误解了你的问题。

您是否尝试过在任何一端设置 inverse="true" ？或者将级联移动到其他类的映射。

[读](http://ayende.com/Blog/archive/2006/12/02/NHibernateCascadesTheDifferentBetweenAllAlldeleteorphansAndSaveupdate.aspx)

# asp.net-mvc - 学习一些新技术……有什么技巧吗？

> ID：863229
> 
> 赞同：0
> 
> 时间：2009-05-14T13:06:19.540
> 
> 标签：asp.net-mvc, postgresql, google-maps, twitter, compass-sass

目标：了解一些我熟悉但不是专家的技术：Postgres、Compass/Sass、Google Maps API、Twitter API 和 ASP.NET MVC 1.0、Flickr API

网站：只是一个有趣的小应用程序，带有 CRUD，用于显示我朋友的地址，然后是一个页面，上面有他们居住地的地图、他们最近的 5 条推文以及他们的一些 flickr 照片。

问题：

1.  我喜欢 LINQ。我的意思是我真的很喜欢它。应该是不自然吧。如何将 LINQ 和 Postgres 与 ASP.NET 一起使用？有人有这方面的经验吗？一个好的例子怎么样？我的意思是我主要是在这里做简单的插入和查询，所以我不需要大量的功能。我想创建一个数据库存储库并拥有一些 IQueryables。

2.  Compass 文档看起来非常简洁。有人可以给我指出一组很好的例子……或者真的就这么简单吗？另外，有人有这方面的经验吗？任何障碍 - 它甚至值得吗？

3.  如果我有 50 个朋友，并且我想要他们的最后 5 条推文……如果我尝试一次全部拉出并同时更新所有这些，我会达到 API 速率限制，这样我就不会遇到网络问题？这样做是否值得？

4.  谷歌为了他们自己的利益太聪明了。我并没有真正“获得” API 文档。谁能给我10秒的概述？这不是“Mapplet”，对吧？

在此先感谢，你们摇滚！

编辑 - 我也在寻找使用这些技术的一般技巧！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T02:49:25.207

[CodePlex](http://www.codeplex.com/)上有几个开源 LINQ 项目。

DBLinq：[http ://dblinq.codeplex.com/](http://dblinq.codeplex.com/)

LINQ to Twitter： http: [//linqtotwitter.codeplex.com/](http://linqtotwitter.codeplex.com/) （免责声明：我将 LINQ 写到 Twitter）

LINQ to Google： http: [//glinq.codeplex.com/](http://glinq.codeplex.com/)

LINQ 到 Flickr： http: [//linqflickr.codeplex.com/](http://linqflickr.codeplex.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T13:19:57.527

1）“linq”我假设你的意思是Linq2Sql orm。不幸的是，它只支持 SQL 服务器，并且可能永远不会获得任何其他数据库，因为它不再处于积极开发中。如果你真的想要来自指向 postgres 的 ORM 中的 IQueryables，最好的方法是 NHibernate.Linq [http://codebetter.com/blogs/kyle.baley/archive/2008/04/07/trying-out-linq-for-nhibernate .aspx](http://codebetter.com/blogs/kyle.baley/archive/2008/04/07/trying-out-linq-for-nhibernate.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T20:48:38.413

另一个免费的替代品可能是[http://code2code.net/DB_Linq/index.html](http://code2code.net/DB_Linq/index.html)但这不是一个非常成熟的项目

# ruby-on-rails - 帮助解释这段 Rails 代码

> ID：863230
> 
> 赞同：1
> 
> 时间：2009-05-14T13:06:22.130
> 
> 标签：ruby-on-rails, ruby

这是什么？

```
"#{h params[:chat_input]}" 
```

我指的是哈希`#`和`h`.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T13:11:17.873

这很可能是在双引号字符串中，例如`"Ponies all love #{h params[:chat_input]}!"` The `#{stuff}`expression 导致 stuff 表达式被解释并插入到字符串中。例如`"1 + 2 = #{1 + 2}"`将导致字符串`"1 + 2 = 3"`.

这`h`是该方法的别名[`html_escape`](http://api.rubyonrails.org/classes/ERB/Util.html#M000300)，这是不言自明的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T13:27:56.307

您粘贴的代码本身只是一个注释。不过，我假设代码在字符串中。

```
"hello, #{5 + 5}"
# => hello, 10 
```

括号内的语句将被评估为 Ruby。这称为字符串插值。

代码中插值内的语句是一个获取参数的方法。

```
h params[:chat_input]
h(params[:chat_input]) 
```

该`h`方法是 的快捷方式`html_escape`，用于转义 HTML。例如，`<span>`转换为`&lt;span&gt;`，以便浏览器显示字符串的实际内容，而不是将其解释为 HTML。

```
html_escape(params[:chat_input]) 
```

你可能知道是什么`params`。

总而言之，您将获得 params[:chat_input] 包含的任何 HTML 转义版本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T14:56:16.513

“#{h 参数[:chat_input]}”

在 ruby​​ 中，双引号字符串允许计算表达式并自动转换为字符串。

我可以做这个：

```
years = 25
"John is " + years +  " years old" 
```

但我会收到一个错误，因为我无法将数字添加到字符串中。

我可以

```
"John is #{years} years old" 
```

解决这个问题。

h() 方法是一个删除 HTML 标记的 Rails 辅助函数。这是安全的事情。

最后，params() 是 Rails 中的一个方法，可以让您访问 GET 和 POST 参数。它实际上包装了一个哈希 GET 和 POST 参数被符号化以减少内存（符号只定义一次，而像“foo”这样的字符串每次都是一个新对象。）

因此， params[:chat_input] 从上一个请求的 GET 或 POST 参数中检索值，在您的情况下，它看起来只是在显示和清理它们。

希望有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T13:19:02.317

它只是在字符串中插入一个值。:chat_input 是一个符号，它用于代替字符串，因为符号只创建一次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T14:09:01.747

```
h(something) 
```

或者

```
h something 
```

由于 ruby​​ 不强制使用 ()，它是 rails 中可用的函数，可将参数转换为“安全 HTML”字符串，从而避免解释 'something' 变量内可能的 HTML 代码。

```
"#{x}" 
```

在 ruby​​ 中意味着将 x 变量转换为字符串并将其放入新字符串中，例如：

```
"#{host}:#{port}" 
```

将主机的值和端口的值放入由“”形成的新字符串中，如果主机是“localhost”并且端口是30，结果字符串将是“localhost:30”

params 是一个特殊的 rails 哈希，包含传递给正在执行的控制器方法的 post/get 参数

另一个细节是，在 ruby​​ 中，方法总是返回最后评估的表达式

所以方法

```
def test
   "#{h params[:chat_input]}"
end 
```

将返回一个字符串，该字符串具有 post/get 参数 chat_input 的 HTML 安全值

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T20:35:39.547

天哪，这是来自[chat_sandbox](http://github.com/taelor/chat_sandbox)的吗？

如果是这样，如果您需要任何帮助，请告诉我 $)

我希望很快在这里更新该代码。

# python - Python 模块（按路径）

> ID：863234
> 
> 赞同：1
> 
> 时间：2009-05-14T13:07:27.150
> 
> 标签：python, mod-python

我正在为 mod_python 的 publisher.py 写一个最小的替代品

基本前提是它正在加载基于 URL 方案的模块：

```
/foo/bar/a/b/c/d 
```

其中 /foo/ 可能是一个目录，而“bar”是 /foo/index.py 中可发布类中的 ExposedBar 方法。同样 /foo 可能映射到 /foo.py 并且 bar 是公开类中的一个方法。这的语义并不重要。我有一条线：

```
sys.path.insert(0, path_to_file)  # /var/www/html/{bar|foo}
mod_obj = __import__(module_name)
mod_obj.__name__ = req.filename 
```

然后检查模块是否有适当的类/函数/方法。当进程尽可能地获取剩余的 URI 数据时，/a/b/c 将传递给该方法或函数。

这工作正常，直到我有 /var/www/html/foo/index.py 和 /var/www/html/bar/index.py

在浏览器中查看时，选择“index.py”是相当随机的，即使我将第一个搜索路径设置为“/var/www/html/foo”或“/var/www/html/bar”并且然后加载 __import__('index')。我不知道为什么它是通过看似随机的选择找到的。这通过以下方式显示：

```
__name__ is "/var/www/html/foo/index.py"
req.filename is "/var/www/html/foo/index.py"
__file__ is "/var/www/html/bar/index.py" 
```

那么这个问题是，为什么 __import__ 会随机选择任一索引。如果路径是“/var/www/html”，我会理解这一点，但事实并非如此。第二：

我可以通过绝对路径将模块加载到模块对象中吗？无需修改 sys.path。我在 __import__ 或 new.module() 上找不到任何文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T13:23:56.597

> 我可以通过绝对路径将模块加载到模块对象中吗？无需修改 sys.path。我找不到任何关于`__import__`此的文档或 new.module() 。

```
import imp
import os

def module_from_path(path):
    filename = os.path.basename(path)
    modulename = os.path.splitext(filename)[0]

    with open(path) as f:
        return imp.load_module(modulename, f, path, ('py', 'U', imp.PY_SOURCE)) 
```

# video - 如何通过参数在视频中的不同位置放置文本

> ID：863238
> 
> 赞同：0
> 
> 时间：2009-05-14T13:08:31.827
> 
> 标签：video, text, runtime

我被要求创建一个视频，其中在视频的各个点动态插入文本。这有点像创建个性化视频。例如，一个人的名字作为参数提供给 swf 文件，然后在运行时将该名字插入到视频中。

我是视频编辑的新手，如果有人能指导我应该看哪种产品，那将有很大帮助。

使用 adobe cs4 专业版，我尝试创建提示点，但问题是我无法将文本放置在我想要在视频中的坐标处。

之后，我尝试了 adobe after effects，现在我可以创建文本层并将文本放置在我想要的任何位置。但我不知道如何动态传递文本层的值。

如果有人能给我一些如何做的想法，那将有很大的帮助。

谢谢

拉古

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T13:45:45.250

这是视频中文本的一个非常特殊的用途，所以我怀疑你会找到一个开箱即用的支持它的工具。最好的办法是使用视频编辑框架或更改 Flash 视频播放器的源代码（例如[FlowPlayer](http://flowplayer.org/)）以接受来自第二个 URL 的带有坐标的文本并显示它。

# c++ - 跨平台 Objective-C / C++ 开发

> ID：863240
> 
> 赞同：8
> 
> 时间：2009-05-14T13:09:00.907
> 
> 标签：c++, objective-c, windows, macos

我在一个开发人员团队中工作，我们中的一个人专门在 Windows 下工作，我主要在 Mac OS X 上工作。我们想用 C++ 或 Objective-C 开发基于 C 的应用程序，但我对这方面并不了解如何进行跨平台开发项目。

使用 Mac OS X 在 C++ 中工作是否可行？显然，它们是面向 Objective-C 的，但对 C++ 的支持也一样多。这些语言的跨平台开发怎么样？我会使用类似 boost 和某种 UI 库的东西。

有没有人有任何开发多平台的经验，但允许应用程序在不需要虚拟机的情况下本地运行？

**编辑**：现在有很多我想标记为正确的答案。似乎 Qt 是用 C++ 开发它的方式。这很可能适用于 *nix、OS X 和 Windows，因此这对我们个人来说是最好的选择。如果我可以避免编写 Objective-C 以便团队坚持使用 C++，那就更好了。如果我必须在 Objective-C 中编写 GUI 并进行混合和匹配，那也不会太麻烦。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-14T13:21:21.733

我在一家软件公司工作，该公司使用 C++、MFC 和 Objective-C 为 Mac OS X 和 Windows 开发软件。

是的，这绝对是可能的。

如果您使用 C++ 开发应用程序的“核心”，您可能会得到最好的服务。在 MVC 应用程序中，C++ 部分将是模型，也可能是控制器。对于与 GUI 和其他特定于操作系统接口的代码，您应该使用本机 API：Mac OS X 上的 Objective-C 和 Windows XP 上的 C#。

Mac 的好处是可以同时编译 C++ 和 Objective-C。你甚至可以拥有 Objective-C++，其中 C++ 和 Objective-C 在同一个编译单元中编译。不幸的是，你不能用 C# 来做到这一点（有一种叫做 Managed C++ 的东西，它是一种不同的野兽）。

我会避免使用 Qt 和 wxWidgets 等跨平台框架。它们都允许您开发跨平台的应用程序，但这些应用程序的外观和感觉是低于标准的。虽然我对 wxWidgets 更熟悉，但它的设计主要面向 Windows MFC 应用程序设计范式。

**编辑 2009 年 5 月 14 日，美国东部标准时间上午 9:44：**如果 Qt 现在允许本地平台的*真实*外观，它可能是一个不错的选择。我还没有看过最新的产品，所以你可能想在设计自己的框架之前先看看那个框架。应该在检查应用程序的结果以及您对 Qt 所需的设计范例的舒适程度之后做出该决定。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-14T13:16:19.483

[你可以看看 Qt](http://qt.nokia.com/)。我已经在 Windows、Linux 和 Mac OSX 项目上成功使用了它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T13:25:16.327

我使用的是一个用 C 或 C++ 编写的通用库，其中包含应用程序的所有核心功能。

假设您正在构建一个纸牌游戏。因此，您将在纯 C++（大部分独立于平台）库中拥有核心类。

*   核心接龙

然后，您将拥有单独的 UI 项目，每个平台对应一个您想要部署纸牌的平台：

*   iSolitaire (Objective-C, MultiTouch Cocoa Based for iPhoneOS)
*   MacSolitaire (Objective-C, Cocoa Based for Mac OS X)
*   WinSolitaire（基于 C++、Win32 或 C#，适用于 Windows 平台）
*   GSolitaire (C++, GNome/GTK based for linux/unix)

这是更多的工作，但是，在我看来，最终的产品肯定比使用[QT](http://www.qtsoftware.com/products/)或[wxWidgets](http://www.wxwidgets.org/)等平台无关的小部件集获得的产品要好。

话虽如此，如果您要在一家可以完全控制部署环境的公司内部部署您的产品，并且您不太关心最终产品在不同平台上的表现，那么您绝对可以使用所有东西的通用 API（QT、wxWidgets 或您可能遇到的任何其他东西）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T13:19:11.787

**使用 Mac OS X 在 C++ 中工作是否可行？显然，它们是面向 Objective-C 的，但对 C++ 的支持也一样多。**

就在这里。

你可以在 OS X 中用 C++ 做任何你想做的事情——例如，在 Linux 上你可以用 C++ 做的任何事情。支持 gcc 的 C++ 编译器、c++ 库等。Xcode 支持使用 C++。

您甚至可以将 c++ 与 Objective-C 与 Objective-C++ 混合使用（但是请注意，这对于 GUI 工作来说是不可移植的）。

**这些语言的跨平台开发怎么样？我会使用类似 boost 和某种 UI 库的东西。**

我相信你最好的选择是[QT](http://www.qtsoftware.com/products/)。

它是一个稳定的跨平台（Windows、OSX、Linux 等）的 C++ 库，已经存在了十多年，得到很好的支持，其中编写了许多商业应用程序（Skype、Adobe Photoshop Album）和大量用它编写的开源东西（初学者的 KDE 桌面）。除了 GUI 的东西，它还提供了更多（容器类、xml、数据库连接等）。

您可以使用最新的 QT 免费开发开源和专有（闭源）应用程序，并且该库最近被大型跨国公司诺基亚收购，因此它不会很快消失。

除了库之外，QT 还附带了一个 IDE 和一个 Visual Forms Designer（全部免费）。

其他适用于 C++ 的跨平台 GUI 库也适用于 OS X（[wxWidgets](http://www.wxwidgets.org/)、[gtkmm](http://www.gtkmm.org/)等）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T13:29:29.860

> 有没有人有任何开发多平台的经验，但允许应用程序在不需要虚拟机的情况下本地运行？

轻微地。确保你包装了所有平台特定的代码。这样，您的主要应用程序或库就不需要引用特定于平台的代码。当移植到另一个平台时，这应该会容易得多。

# c# - 自定义 HttpHandler 未触发，在 ASP.NET MVC 应用程序中返回 404

> ID：863243
> 
> 赞同：13
> 
> 时间：2009-05-14T13:10:00.920
> 
> 标签：c#, asp.net-mvc, httphandler

我不知道在 MVC 网站上发生这种情况是否相关，但我想我还是会提到它。

在我的 web.config 我有这些行：

```
<add verb="*" path="*.imu" type="Website.Handlers.ImageHandler, Website, Version=1.0.0.0, Culture=neutral" /> 
```

在网站项目中，我有一个名为 Handlers 的文件夹，其中包含我的 ImageHandler 类。它看起来像这样（我已经删除了 processrequest 代码）

```
using System;
using System.Globalization;
using System.IO;
using System.Web;

namespace Website.Handlers
{
    public class ImageHandler : IHttpHandler
    {
        public virtual void ProcessRequest(HttpContext context)
        {
            //the code here never gets fired
        }

        public virtual bool IsReusable
        {
            get { return true; }
        }
    }
} 
```

如果我运行我的网站并转到 /something.imu，它只会返回 404 错误。

我正在使用 Visual Studio 2008 并尝试在 ASP.Net 开发服务器上运行它。

我一直在寻找几个小时，并让它在一个单独的空网站上工作。所以我不明白为什么它不能在现有网站中工作。顺便说一句，没有其他对 *.imu 路径的引用。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-14T14:15:19.560

我怀疑这与您使用 MVC 的事实有关，因为基本上它控制了所有传入的请求。

我怀疑您将不得不使用路由表，并可能创建一个新的路由处理程序。我自己没有这样做，但这样的事情可能会奏效：

```
void Application_Start(object sender, EventArgs e) 
{
    RegisterRoutes(RouteTable.Routes);
}

public static void RegisterRoutes(RouteCollection routes)
{
    routes.Add(new Route
    (
         "{action}.imu"
         , new ImageRouteHandler()
    ));
} 
```

然后`ImageRouteHandler`该类将返回您的自定义`ImageHttpHandler`，尽管通过查看网络上的示例可能会更好地更改它以便实现`MvcHandler`，而不是直接`IHttpHandler`。

编辑1：根据彼得的评论，您也可以使用以下`IgnoreRoute`方法忽略扩展名：

```
public static void RegisterRoutes(RouteCollection routes)
{
  routes.IgnoreRoute("{resource}.imu/{*pathInfo}");
} 
```

# java - 在 Hibernate 中通过映射表值排序

> ID：863246
> 
> 赞同：7
> 
> 时间：2009-05-14T13:10:05.193
> 
> 标签：java, hibernate, jpa, many-to-many, sql-order-by

我有一个 @ManyToMany 映射，其中表通过映射表进行自我引用，我们想在实际映射表中的订单 ID 上进行排序，但发现很难配置它。

我们可以在 hibernate xml 中执行它，因此很自然地假设 JPA 注释中存在支持。有人知道我们如何对映射表中的值进行排序吗？

表格是：

```
wap_site_components

intid
strname
intcomponentdef
dtmcreated      
intcustomer 
```

而自引用的映射表为：

```
wap_site_component_relations

intid     
intparent (references intid in wap_site_components)
intchild  (references intid in wap_site_components)
intorder (this is the value we want to order the collection on) 
```

在 Hibernate Annotations 中，我们有：

```
@ManyToMany (fetch = FetchType.LAZY, cascade = CascadeType.ALL)
@JoinTable (name = "wap_site_component_relations", 
    joinColumns = {@JoinColumn (name = "intparent", referencedColumnName = "id") }, 
    inverseJoinColumns = {@JoinColumn (name = "intchild", referencedColumnName = "id") })
public Set<WapComponent> getChildren() {
    return children;
} 
```

这是我们在 hibernate xml 中执行它的方式：

```
 <set
          name="children"
          table="wap_site_component_relations"
          lazy="true"
          cascade="none"
          sort="unsorted"
          order-by="intorder"
          mutable="false"
        >
          <cache 
            usage="read-only" 
          />

          <key
            column="intparent"
          >
          </key>

          <many-to-many
            class="se.plusfoursix.im46.data.wap.WapComponent"
            column="intchild"
            outer-join="auto"
           />

       </set> 
```

所以我们想使用@OrderBy 标签但不能引用映射表中的inorder 值。有任何想法吗？谢谢。

（我们已经在代码中的 children 集合上尝试了 @OrderBy(intorder) ，但这对我们来说并没有奏效）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:11:06.297

您可以创建一个带注释的对象来表示链接表，然后使用 @oneToMany 从父链接映射到子链接，然后再映射到子链接

```
@Entity
public class Parent {
   @id
   Long id;

   @OneToMany(targetEntity = ChildLink.class) 
   Set<ChildLink> childLinks;
}

public class ChildLink {

    @Id
    @OrderBy
    Long orderBy;

    @ManyToOne
    Set<Parent> parents;

    @ManyToOne
    Set<Child> children;
} 
```

只是一个粗略的例子。然后，您可以以编程方式从 childLink 集中生成子集，可能在父类的 getChildren 方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T13:26:11.123

我们最终只是将映射表创建为一个 bean。

如果有人有办法在没有它的情况下执行上述操作，仍然很高兴收到您的来信！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-25T22:25:35.213

可以用**@OrderColumn完成**

[http://docs.oracle.com/javaee/6/api/javax/persistence/OrderColumn.html?is-external=true](http://docs.oracle.com/javaee/6/api/javax/persistence/OrderColumn.html?is-external=true)

```
@Entity
public class CreditCard {

   @Id long ccNumber;

   @OneToMany  // unidirectional
   @OrderColumn
   List<CardTransaction> transactionHistory;
   ...
} 
```

# java - 在 JSP 中获取当前文件名

> ID：863248
> 
> 赞同：20
> 
> 时间：2009-05-14T13:10:40.810
> 
> 标签：java, jsp, struts, jstl

有没有办法使用 JSTL 或 Struts（或不使用）获取当前呈现的 JSP？像 Python 和 PHP 中的 _ 文件 _ _？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-14T13:19:14.080

嗯......是的......在某种程度上

```
String __jspName = this.getClass().getSimpleName().replaceAll("_", "."); 
```

我正在使用一个名为的 JSP `pre.jsp`，它包含在我的 webapp 中每个 JSP 的顶部：

```
<%@page import="org.apache.log4j.Logger"%>
<%
    String __jspName = this.getClass().getSimpleName().replaceAll("_", ".");

    Logger log = Logger.getLogger(this.getClass().getName());
    log.info("BEGIN JSP "+__jspName);
%>
<!-- BEGIN <%=__jspName %> --> 
```

另外我把它放在每个 JSP 的末尾：

```
<!-- END <%=__jspName %> --><% log.info("END JSP "+__jspName); %> 
```

这给了我一个一致的日志。为了确保每个 JSP 都是“正确的”，我检查了我的构建脚本，它只查找两个字符串`"/pre.jsp"`和 ``END <%=__jspName`。

注意：文件名中允许使用许多字符，但 Java 类名中不允许使用。如果你使用它们，你的类名可能看起来很奇怪。如果是这种情况，我建议创建一个静态帮助函数，将类名转换为文件名并调用它，即

```
String __jspName = MyJspUtils.getFileName(this.getClass()); 
```

每个 JSP 编译器都有自己的规则；这是一个例子：http: [//itdoc.hitachi.co.jp/manuals/3020/30203Y0510e/EY050044.HTM](http://itdoc.hitachi.co.jp/manuals/3020/30203Y0510e/EY050044.HTM)

感谢[Marcus Junius Brutus](https://stackoverflow.com/users/274677/marcus-junius-brutus)指出这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-27T09:29:08.147

我成功地使用了 JSTL，如下所示：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
...
<!-- <c:out value="${pageScope['javax.servlet.jsp.jspPage']}"></c:out> -->
... 
```

现在，您应该将容器生成的用于呈现 JSP 文件的 servlet 的名称视为 HTML 注释，该名称与 JSP 源文件非常接近。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-14T22:58:53.453

这是一个简单的复制粘贴解决方案：

```
<%=this.getClass().getSimpleName().replaceFirst("_jsp","")%> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T20:30:02.887

更方便的方法是使用：<%= request.getRequestURI() %>

<%= request.getRequestURI() %> 例如，在我所有的 jsp 文件中，我总是放这行：

呈现 JSP 文件：'<%= request.getRequestURI() %>'

这会将注释的 html 行放入呈现的 html 中。这样人们就无法在浏览器中看到它，但出于调试目的，我总是可以在执行“查看源代码”时看到它。

# asp.net - 在 Asp.net 中使用 Crystal Reports 时出现的问题

> ID：863252
> 
> 赞同：0
> 
> 时间：2009-05-14T13:11:52.240
> 
> 标签：asp.net, vb.net, crystal-reports

我在我的 asp.net 应用程序 (vb) 中使用 Crystal Reports 创建了报表。很好。但是当我在另一个系统中运行它时，报告加载失败。所以我像这样修改了我的代码。

```
sub Loadreport()
try
Dim sreport as new ReportDocument
sreport.Load(Server.MapPath("ClientList.rpt"))
sreport.FileName=Server.MapPath("ClientList.rpt")

catch(ex.exception)

end try
End sub 
```

当控制到线时：-

```
sreport.Load(Server.MapPath("ClientList.rpt")) 
```

它跳转到显示“Invalid Report path”的 catch 块。但最初，代码没有显示任何错误。我没有改变路径。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T13:17:55.830

记录跟踪文件的路径或错误日志或reponse.write，看看“其他系统”上的路径是否是存储ClientList.rpt的正确路径。

# python - Python 和集体智慧

> ID：863253
> 
> 赞同：3
> 
> 时间：2009-05-14T13:11:53.940
> 
> 标签：python, collective-intelligence

我目前正在阅读 Toby Segaran 的一本名为“Programming Collective Intelligence”的好书（我强烈推荐）

代码示例都是用 Python 编写的，而且由于我今年已经学习了一种新语言（从 VB.net 毕业到 C#），所以我并不热衷于跳上另一条学习曲线。

这给我留下了将 python 示例翻译成 C# 的问题。

问题是：代码保留在 python 中有多重要？python中有没有我不能用普通的托管静态类型语言做的事情？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-14T13:18:10.417

您会发现的一个挑战是，不仅算法是用 Python 实现的，而且本书还广泛使用了 BeautifulSoup、Numpy、PIL 等 Python 库（参见附录 A）。

我怀疑有任何算法细节是你不能移植到另一种语言的，但是你会在练习中遇到困难。此外，要翻译代码，您至少必须学习一点 Python，不是吗？

我建议你潜入并学习 Python。如果您担心与 C# 项目的互操作性，可以使用 IronPython。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-12T11:04:40.107

我建议将它们翻译成 C#。我一直在将第 2 章“建议”移植到 VB.Net。在此过程中，我正在学习 Python 作为一种副作用。Toby 用 Python 列表做了一些令人惊奇的事情。

处理额外的 Python 库是另一回事。Ndelicious 与 pyDelicious 非常接近，但它缺少一些关键功能（热门帖子！）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T13:24:45.143

你可以用所有图灵完备的语言做同样的事情。这是在 SQL 中呈现 Mandelbrot 分形[的示例。](http://thedailywtf.com/articles/stupid-coding-tricks-the-tsql-madlebrot.aspx)例子表明：即使你可以使用任何语言，努力也会有所不同。

所以我的猜测是，由于 Python 如此灵活和开放，代码会变得更长。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T14:14:51.980

这本书是关于算法的，而不是编程的细节，选择的语言只是为了让例子具体化。正如作者所说，“本书中的代码示例是用 Python 编写的……但我提供了所有算法的解释，以便其他语言的程序员可以学习。” （第十五页）

Python 是一门很棒的语言并且易于学习，但我怀疑应用书中的想法的困难不在于将代码翻译成另一种语言或一组库，而在于理解这些想法并修改代码以适应您的需求需要。我认为使用您熟悉的语言有两个主要原因：1）当您的代码不起作用时，如果您使用不熟悉的语言编写，您将不知道从哪里开始寻找错误，例如，如果你和大多数人一样，你甚至会开始怀疑这是否是由于 Python 中的一个错误，它不会是，但你会想知道它会分散注意力。2）在一定时间内你能记住多少是有自然限制的；同时学习一门语言会给你两倍的记忆。

这取决于你对 C# 的了解程度，以及离开它会失去什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T13:24:33.537

强制性 XKCD：http: [//xkcd.com/353/](http://xkcd.com/353/)

我知道您明确表示您不想学习 Python（今年），但是将 Python 示例转换为 C# 肯定会是一条更陡峭的曲线。潜入[吧！](http://www.diveintopython.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T14:23:12.617

对于人工智能编程，Python 似乎就像 LISP 几十年来一样。Russel/Norvig 的名著[AI: A Modern Approach](http://aima.cs.berkeley.edu/)也提供了大量[Python 示例](http://aima.cs.berkeley.edu/python/readme.html)。

# xml - 为什么我的 Atom 数据绑定不起作用？

> ID：863265
> 
> 赞同：2
> 
> 时间：2009-05-14T13:13:40.740
> 
> 标签：xml, apache-flex, e4x, atom-feed

我有一个带有与 XML 和 Atom 提要绑定的高级数据网格的 Flex 应用程序。

使用我的 XML 文件，应用程序运行良好：

```
jiraList = new XMLList(event.result.channel.item); 
```

但是，当我尝试访问 Atom 提要时，我不能低于“event.result”。

这有效：

```
clarityList = event.result as XMLList;
Alert.show(clarityList.toString()); 
```

但这不会：

```
clarityList = event.result.feed as XMLList;
Alert.show(clarityList.toString()); 
```

正如 Adob​​e 解释的那样，我使用 Atom 命名空间：

```
private namespace atom = "http://www.w3.org/2005/Atom";
use namespace atom; 
```

我的目标是能够将 Atom 提要与我的高级数据网格列绑定，因为它适用于我的 XML 提要。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-26T00:53:38.433

```
private namespace atom = "http://www.w3.org/2005/Atom";
use namespace atom;

clarityList = event.result.atom::feed as XMLList;
Alert.show(clarityList.toString()); 
```

必须使用命名空间来限定属性（元素）访问。ActionScript 属性名称实际上是命名空间限定的，但很少以这种方式使用。可以说，XML 倾向于使这个话题“浮出水面”。

# php - 向客户端报告进度的 PHP 脚本

> ID：863268
> 
> 赞同：2
> 
> 时间：2009-05-14T13:13:53.000
> 
> 标签：php, dynamic-data

我正在编写一个执行大量重复工作的 PHP 脚本，当客户端执行它时，我希望它在完成任务时以某种方式动态地发回 HTML。（没有 AJAX？）如何做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T13:32:30.677

您可以使用 flush(); 刷新输出缓冲区；

所以像：

```
taskOne();
echo 'Task one finished';
flush();
... 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T13:23:31.370

也许您可以使用 refresh-meta 标记或 HTTP 标头，如下所示：

`header("Refresh: 3; URL=http://www.some.org/some.html");`

浏览器将在 3 秒后刷新。如果你问我，这可能有点意思 =) 包含 AJAX 解决方案会更好，但它至少可以在没有太多 JavaScript 工作的情况下工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T21:25:01.230

你最好通过 ajax 轮询服务器。设置一个脚本，可以监控您正在运行的任务并进行轮询。这样，用户的浏览器并不总是处于加载模式，他们可以离开页面并在需要时返回。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-14T13:15:51.327

然后你需要刷新站点，因为 PHP 只在每个页面请求上运行。

# c# - 通用 ServerControl 语法？

> ID：863270
> 
> 赞同：4
> 
> 时间：2009-05-14T13:14:19.613
> 
> 标签：c#, asp.net, generics, custom-server-controls

有没有办法让我拥有服务器控制权

```
MyControl<T> 
```

这样我就可以像这样在 aspx 页面中注册和使用它

```
<mc:MyControl<ThingForControlToUse> ID="instanceOfMyControl" runat="server" 
```

显然设计师不喜欢这样，除了创建带有类型参数的非泛型包装器之外，还有什么很酷的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T13:19:46.467

通用标签名称在 ASP.NET 中是不可能的，请参考这篇文章：[通用控件](http://weblogs.asp.net/ysolodkyy/archive/2007/10/02/control-builders-amp-asp-net-generic-control-classes.aspx)

您认为您需要创建一个带有 TYPE 参数的包装器是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T13:32:56.590

快速说明 - 我不确定这在 Visual Studio 2008 中是否属实，但如果您在使用 Visual Studio 2005 编辑的项目中拥有该控件，您将完全破坏该控件的智能感知。当 Visual Studio 尝试创建 XML 架构文件以用于标记文件中的智能感知弹出窗口时，它会在看到像这样的通用控件时完全中断，它会完全放弃架构文件，让您在该程序集中没有任何智能感知。

# .net - 我如何在 Linq 中做到这一点？

> ID：863271
> 
> 赞同：2
> 
> 时间：2009-05-14T13:14:40.877
> 
> 标签：.net, linq, json

我有一个`IList<Foo>`并且我正在尝试将其序列化，因为`Json`结果中没有包含字段名称。因此，我正在尝试创建一个*匿名对象*，并将其传递给 Json 序列化方法。

Foo 被定义为（伪代码）：-

```
public class Foo
{
    public int X;
    public int Y;
} 
```

当我将其作为 Json 返回时...

```
return Json(foos); 
```

结果就像

```
... [{"X":1,"Y":2},{"X":3,"Y":4}...] 
```

我不希望 X 和 Y 在那里。所以我追求..

```
... [{1,2},{3,4}...] 
```

所以我试图做以下事情（这不起作用）

```
(from p in foos
 select new p.X + "," + p.Y).ToArray() 
```

或者

```
(from p in foos
 select new string(p.X+ "," + p.Y)).ToArray() 
```

但无济于事（不编译）。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T13:21:34.900

```
(from p in foos
 select String.Format("{{{0}, {1}}}", p.X, p.Y)).ToArray() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T13:19:11.833

```
foos.Select(p=>p.X + "," + p.Y) 
```

或者，如果您更喜欢 Linq 语法：

```
(from p in foos
 select p.X + "," + p.Y).ToArray() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T13:20:19.880

JSON 是成员序列化程序，并使用名称。如果您不想要名称，请不要使用 JSON。也许只是`StringBuilder`，那么？

```
StringBuilder sb = new StringBuilder("[");
foreach(var foo in items) {
  sb.Append('{').Append(foo.X).Append(',').Append(foo.Y).Append("},");
}
sb[sb.Length - 1] = ']';
string s = sb.ToString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T13:20:19.583

为什么不自己创建 JSON 字符串，这样您就可以完全控制它的设置方式，而不是使用序列化方法。

# asp.net - 如何在asp.net中根据时区设置本地时间

> ID：863277
> 
> 赞同：0
> 
> 时间：2009-05-14T13:15:27.023
> 
> 标签：asp.net

嗨，我正在开发一个网站，用户将从下拉列表中选择时区。在我的数据库中，日期时间以 UTC 格式存储。我如何根据用户选择的时区显示他的个人资料。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T13:20:37.120

您可以存储用户的时区偏移量，并将其应用于每次要显示日期/时间的 UTC 时间。

# javascript - 添加选项以在 IE 中选择下拉菜单

> ID：863280
> 
> 赞同：5
> 
> 时间：2009-05-14T13:16:05.633
> 
> 标签：javascript, html

我正在尝试在运行时将项目添加到选择下拉列表中。到目前为止，它在 Firefox 和 Opera 中运行，但它似乎不适用于 IE7 或 8。

应该发生的是，当用户选择一个中心时，人员下拉列表中会填充中心的人员....

```
//Clear out the all of the exisiting items
if (document.getElementById("ddlPersonnel").hasChildNodes) {
    while (document.getElementById("ddlPersonnel").childNodes.length > 0) {
        document.getElementById("ddlPersonnel").removeChild(document.getElementById("ddlPersonnel").firstChild);
    }
}

//Add the "Select Personnel" option
var FirstOpt = document.createElement('OPTION');
FirstOpt.value = "";
FirstOpt.innerText = "Select Personnel";
alert("blah1");
document.getElementById("ddlPersonnel").options.add(FirstOpt, null);    //It dies here with a "Type Mismatch" error
alert("blah2"); 
```

它在两个警报之间的线上死亡，并出现“类型不匹配”错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T13:19:23.673

使用新选项而不是 createElement。

```
var sel = document.getElementById("ddlPersonnel");
var opt = sel.options;
opt[opt.length] = new Option("Label","Value") 
```

（这应该可以，但我还没有测试过）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-25T10:53:17.493

只需更换

```
document.getElementById("ddlPersonnel").options.add(FirstOpt, null); 
```

经过

```
document.getElementById("ddlPersonnel").add(FirstOpt); 
```

删除 add() 函数中的“.options”和“, null”就可以了

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-03-14T18:45:03.953

根据我的经验，用`append()`纯 JavaScript`appendChild()`方法替换 jQuery 会导致我的项目出现在选择框中。

# objective-c - 如何在 Cocoa 中制作未装饰的窗口？

> ID：863285
> 
> 赞同：2
> 
> 时间：2009-05-14T13:17:15.770
> 
> 标签：objective-c, cocoa

我喜欢创建一个没有任何 chrome 的 Cocoa 窗口。用户应该看到的唯一东西就是我画的东西。

我发现我可以创建一个自定义 NSView 但这是否必须在 NSWindow 中才能显示？如果没有，如何在不将其放入 NSWindow 的情况下显示它？如果它必须在 NSWindow 中，如何阻止窗口绘制标题栏和其他 chrome？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T13:38:56.933

查看示例：

[http://developer.apple.com/samplecode/RoundTransparentWindow/index.html](http://developer.apple.com/samplecode/RoundTransparentWindow/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:53:15.770

> 我发现我可以创建一个自定义 NSView 但这是否必须在 NSWindow 中才能显示？

是的。

> 如果它必须在 NSWindow 中，如何阻止窗口绘制标题栏和其他 chrome？

创建窗口时使用[NSBorderlessWindowMask 。](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSBorderlessWindowMask)（假设您没有使用 NSWindow 的自定义子类，这意味着不在 nib 中创建窗口实例。如果您想在 nib 中布置视图层次结构，请在顶级自定义视图中执行此操作，然后加载nib 并将该视图设置为窗口的内容视图。）

# properties - 临时从流中转移数据的术语

> ID：863290
> 
> 赞同：0
> 
> 时间：2009-05-14T13:18:01.273
> 
> 标签：properties, naming

当你不知道它叫什么时，很难搜索它。

我正在使用一种可切换的缓冲区（想象一个带阀门的花园软管）缓冲数据点流：在一个状态下（“真”），我让数据点通过它们最终的消费者。在另一个状态（“假”）中，我将这些数据点保留在队列中，直到我转换到另一个状态，此时我将这些数据点按顺序发送给它们的消费者。

您对控制此状态的布尔属性的命名有什么建议吗？我曾想过“开启”、“缓冲”、“关闭”、“延迟”等，但没有一个让我特别高兴。在将课程发布给潜在的“客户”（此处为其他程序员）之前，我需要想出一个好名字。如果它更具有语义意义，我可以将逻辑从 true <-> false 反转。

（编辑：请随意将属性称为没有 is/get 的名称。我使用的是 Java，因此它将是带有 setXXX/isXXX 访问器的 Bean 样式属性。）

（编辑2：似乎属性名称应该，除非更清楚地这样做，否则应该反映数据正在透明地通过而没有延迟的“真实”状态。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T13:41:36.287

```
IsQueueBufferingEnabled 
```

或者

```
IsDiverted 
```

（不公开任何实现细节）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T14:09:58.420

保留数据？

> 应该反映“真实”状态，其中数据正在透明地通过，没有延迟

那么，floodGatesOpen 呢？:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T14:43:59.413

嗯...我暂时使用`paused`，并不完全满意，但这是我能想到的最好的。（`suspended`质量相似）

# confluence - 在 Confluence 中按页面禁用 CamelCase 链接

> ID：863291
> 
> 赞同：3
> 
> 时间：2009-05-14T13:18:08.387
> 
> 标签：confluence

**背景：**我的雇主使用 Confluence 作为我们的知识库 wiki，并且他们已经打开了 CamelCase 链接。由于我们在方法名称中使用了很多 CamelCase，这会导致很多无关链接；我们可以通过将每一个都包装在 {nl:} 中来禁用该行为，但这会变得乏味，有时我们会错过一个。（而且由于现有的页面很多，而且并不是每个人都将其用于代码讨论，因此要求 IT 更改全局设置是行不通的。）

**问题：**有没有办法覆盖全局设置，将 Confluence 中的单个页面标记为*不*使用 CamelCase 链接？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-30T08:38:20.793

使用发布在[https://jira.atlassian.com/browse/CONF-7999?focusedCommentId=237514&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-237514的 jQuery](https://jira.atlassian.com/browse/CONF-7999?focusedCommentId=237514&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-237514)

nocamel 宏可以用它来制作。海报和我正在成功使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T23:05:38.227

Not that I have found. Here are the Confluence docs on the subject: [http://confluence.atlassian.com/display/DOC/CamelCase%20linking](http://confluence.atlassian.com/display/DOC/CamelCase%20linking)

Shame eh?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-07T01:27:59.397

我有着同样的问题。使用“{nocamel}”宏启动页面有时会在我们的 Confluence 中禁用它，但显然并非始终可靠地工作。这不是官方的宏；我们的管理员可能做了一些自定义宏，但我对此表示怀疑。也许这是一个不受支持的功能，但值得一试。

您可能会考虑对一些相关的 Confluence 功能请求进行投票。这个用于禁用页面中的 CamelCase 链接：http: [//jira.atlassian.com/browse/CONF-7999](http://jira.atlassian.com/browse/CONF-7999)

这用于禁用整个空间上的 CamelCase 链接：http: [//jira.atlassian.com/browse/CONF-6526](http://jira.atlassian.com/browse/CONF-6526)

# vba - Word VBA 无法退出设计模式错误 (Word 2003)

> ID：863293
> 
> 赞同：0
> 
> 时间：2009-05-14T13:18:24.877
> 
> 标签：vba, ms-word

我有一个 Word 表单，它有一堆命令按钮、表单域和组合框。在“ThisDocument”对象和我添加的另一个模块中，有很多与表单相关的代码。

如果我通过在 Windows 中双击文档来打开表单，它会在我启用宏时打开并正常工作。

但是，如果我先打开 Word，然后转到文件 > 打开以打开表单，则会收到错误消息“无法退出设计模式，因为无法创建控制 cmdInstructions。

我在其他一些用户的计算机上也看到了这个错误，它有时指的是不同的控件，而不仅仅是 cmdInstructions 按钮。

当我们升级到 Word 2003 时，这个问题就开始了。同样，如果你在 Windows 中双击文档打开它，没有问题。仅当您已经打开 Word（带有空白的新文档）时才会出现该消息。

有没有人见过这个问题？我需要对我的代码做些什么来避免这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-08-09T07:04:39.463

可能晚了，但答案是升级到 Office 2003 Service Pack 3

# java - 检索 domain.tld 的正则表达式

> ID：863297
> 
> 赞同：4
> 
> 时间：2009-05-14T13:18:59.323
> 
> 标签：java, regex

我需要一个 Java 中的正则表达式，我可以使用它从任何 url 检索 domain.tld 部分。所以[https://foo.com/bar](https://foo.com/bar)、[http://www.foo.com#bar](http://www.foo.com#bar)、[http://bar.foo.com](http://bar.foo.com)都会返回 foo.com。

我写了这个正则表达式，但它匹配整个 url

```
Pattern.compile("[.]?.*[.x][a-z]{2,3}"); 
```

我不确定我是否匹配“。” 性格对。我试过 ”。” 但我从 netbeans 得到一个错误。

**更新：**

tld 不限于 2 或 3 个字符，[http://www.foo.co.uk/bar](http://www.foo.co.uk/bar)应该返回 foo.co.uk。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T13:25:34.487

这比你想象的要难。您的示例[https://foo.com/bar](https://foo.com/bar)中有一个逗号，这是一个有效的 URL 字符。这是一篇关于一些麻烦的好帖子：

[https://blog.codinghorror.com/the-problem-with-urls/](https://blog.codinghorror.com/the-problem-with-urls/)

```
https?://([-A-Za-z0-9+&@#/%?=~_()|!:,.;]*[-A-Za-z0-9+&@#/%=~_()|]) 
```

是一个很好的起点

“掌握正则表达式”中有关此主题的一些列表：

[http://regex.info/listing.cgi?ed=3&p=207](http://regex.info/listing.cgi?ed=3&p=207)

@sjobe

```
>>> import re
>>> pattern = r'https?://([-A-Za-z0-9+&@#/%?=~_()|!:,.;]*[-A-Za-z0-9+&@#/%=~_()|])'
>>> url = re.compile(pattern)
>>> url.match('http://news.google.com/').groups()
('news.google.com/',)
>>> url.match('not a url').groups()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'NoneType' object has no attribute 'groups'
>>> url.match('http://google.com/').groups()
('google.com/',)
>>> url.match('http://google.com').groups()
('google.com',) 
```

对不起，这个例子是用python而不是java，它更简短。Java 需要对正则表达式进行一些无关的转义。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-14T15:47:44.627

我将使用 java.net.URI 类来提取主机名，然后使用正则表达式来提取主机 uri 的最后两部分。

```
import java.net.URI;
import java.net.URISyntaxException;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class RunIt {

    public static void main(String[] args) throws URISyntaxException {
        Pattern p = Pattern.compile(".*?([^.]+\\.[^.]+)");

        String[] urls = new String[] {
                "https://foo.com/bar",
                "http://www.foo.com#bar",
                "http://bar.foo.com"
        };

        for (String url:urls) {
            URI uri = new URI(url);
            //eg: uri.getHost() will return "www.foo.com"
            Matcher m = p.matcher(uri.getHost());
            if (m.matches()) {
                System.out.println(m.group(1));
            }
        }
    }
} 
```

印刷：

```
foo.com
foo.com
foo.com 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-14T15:27:20.247

如果字符串包含有效的 URL，那么您可以使用像（Perl 引用）这样的正则表达式：

```
/^
(?:\w+:\/\/)?
[^:?#\/\s]*?

(
[^.\s]+
\.(?:[a-z]{2,}|co\.uk|org\.uk|ac\.uk|org\.au|com\.au|___etc___)
)

(?:[:?#\/]|$)
/xi; 
```

结果：

```
url: https://foo.com/bar
matched: foo.com
url: http://www.foo.com#bar
matched: foo.com
url: http://bar.foo.com
matched: foo.com
url: ftp://foo.com
matched: foo.com
url: ftp://www.foo.co.uk?bar
matched: foo.co.uk
url: ftp://www.foo.co.uk:8080/bar
matched: foo.co.uk 
```

对于 Java，它会被引用为：

```
"^(?:\\w+://)?[^:?#/\\s]*?([^.\\s]+\\.(?:[a-z]{2,}|co\\.uk|org\\.uk|ac\\.uk|org\\.au|com\\.au|___etc___))(?:[:?#/]|$)" 
```

当然，您需要更换***etc***部分。

示例 Perl 脚本：

```
use strict;

my @test = qw(
    https://foo.com/bar
    http://www.foo.com#bar
    http://bar.foo.com
    ftp://foo.com
    ftp://www.foo.co.uk?bar
    ftp://www.foo.co.uk:8080/bar
);

for(@test){
    print "url: $_\n";

    /^
    (?:\w+:\/\/)?
    [^:?#\/\s]*?

    (
    [^.\s]+
    \.(?:[a-z]{2,}|co\.uk|org\.uk|ac\.uk|org\.au|com\.au|___etc___)
    )

    (?:[:?#\/]|$)
    /xi;

    print "matched: $1\n";
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-11-08T20:23:44.277

`new URL(url).getHost()`

不需要正则表达式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T13:34:57.833

您将需要获取所有可能的 TLD 和 ccTLD 的列表，然后与它们进行匹配。您必须这样做，否则您将永远无法区分 subdomain.dom.com 和 hello.co.uk。

所以，给你自己一个这样的清单。我建议将其反转，以便存储，例如 uk.co。然后，您可以通过获取 // 和 / 或行尾之间的所有内容来从 URL 中提取域。分裂于 。并向后工作，匹配 TLD，然后再增加 1 个级别以获取域。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-15T20:56:15.547

```
 /[^.]*\.[^.]{2,3}(?:\.[^.]{2,3})?$/ 
```

差不多了，但是当二级域有 3 个这样的字符时将不匹配：*www.foo.com*[在此处](http://www.regexplanet.com/advanced/java/index.html) 测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-06T11:37:02.373

这对我有用：

```
public static String getDomain(String url){
    if(TextUtils.isEmpty(url)) return null;
    String domain = null;
    if(url.startsWith("http://")) {
        url = url.replace("http://", "").trim();
    } else if(url.startsWith("https://")) {
        url = url.replace("https://", "").trim();
    }
    String[] temp = url.split("/");
    if(temp != null && temp.length > 0) {
        domain = temp[0];
    }  
    return domain;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-08T09:00:36.140

代码：

```
public class DomainUrlUtils {
    private static String[] TLD = {"com", "net"}; // top-level domain
    private static String[] SLD = {"co\\.kr"}; // second-level domain

    public static String getDomainName(String url) {
        Pattern pattern = Pattern.compile("(?<=)[^(\\.|\\/)]\\w+\\.(" + joinTldAndSld("|") + ")$");
        Matcher match = pattern.matcher(url);
        String domain = null;

        if (match.find()) {
            domain = match.group();
        }

        return domain;
    }

    private static String joinTldAndSld(String delimiter) {
        String t = String.join(delimiter, TLD);
        String s = String.join(delimiter, SLD);

        return new StringBuilder(t).append(s.isEmpty() ? "" : "|" + s).toString();
    }
} 
```

测试：

```
public class DomainUrlUtilsTest {

    @Test
    public void getDomainName() throws Exception {
        // given
        String[][] domainUrls = {
            {
                "test.com",
                "sub1.test.com",
                "sub1.sub2.test.com",
                "https://sub1.test.com",
                "http://sub1.sub2.test.com"
            },
            {
                "https://domain.com",
                "https://sub.domain.com"
            },
            {
                "http://domain.co.kr",
                "http://sub.domain.co.kr",
                "http://local.sub.domain.co.kr",
                "http://local-test.sub.domain.co.kr",
                "sub.domain.co.kr",
                "domain.co.kr",
                "test.sub.domain.co.kr"
            }
        };

        String[] expectedUrls = {
            "test.com",
            "domain.com",
            "domain.co.kr"
        };

        // when
        // then
        for (int domainIndex = 0; domainIndex < domainUrls.length; domainIndex++) {
            for (String url : domainUrls[domainIndex]) {
                String convertedUrl = DomainUrlUtils.getDomainName(url);

                if (expectedUrls[domainIndex].equals(convertedUrl)) {
                    System.out.println(url + " -> " + convertedUrl);
                } else {
                    Assert.fail("origin Url: " + url + " / converted Url: " + convertedUrl);
                }
            }
        }
    }
} 
```

结果：

```
test.com -> test.com
sub1.test.com -> test.com
sub1.sub2.test.com -> test.com
https://sub1.test.com -> test.com
http://sub1.sub2.test.com -> test.com
https://domain.com -> domain.com
https://sub.domain.com -> domain.com
http://domain.co.kr -> domain.co.kr
http://sub.domain.co.kr -> domain.co.kr
http://local.sub.domain.co.kr -> domain.co.kr
http://local-test.sub.domain.co.kr -> domain.co.kr
sub.domain.co.kr -> domain.co.kr 
```

# eclipse - Mac OS X 上保存的 Eclipse 关键配置在哪里

> ID：863303
> 
> 赞同：2
> 
> 时间：2009-05-14T13:19:20.350
> 
> 标签：eclipse, macos, key-bindings

我的主目录下没有 .eclipse 目录。我找不到保存键绑定方案的配置文件。它们在 Mac OS X 上保存在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T16:09:10.443

键绑定保存在工作区文件夹中，位于 .metadata 文件夹 (.metadata/.plugins/org.eclipse.core.runtime/.settings/org.eclipse.ui.workbench.prefs，位于名为 org.eclipse 的条目下。 ui.commands）。

如果您想在机器或工作区之间传输它们，您应该执行以下操作：

1.  转到文件-> 导出
2.  标记首选项，点击确定
3.  从列表中选择“Key Preferences”，输入文件名并点击 OK

要导入，请按照相同的步骤，选择文件 -> 导入。

# asp.net - 与 ITSELF 的类型冲突只是因为它作为 ASP.NET Web 服务中 Web 方法的返回类型包含在内？

> ID：863307
> 
> 赞同：0
> 
> 时间：2009-05-14T13:19:51.347
> 
> 标签：asp.net, web-services, compiler-errors

我有一个恼人的问题，我正在创建一个 asp.net 网络服务；该服务应该公开现有库的功能，该服务允许用户通过调用服务上的 UploadFile 方法将文件上传到我们的服务器。这是 UploadFile 方法的签名

```
public bool UploadFile(string bucketName, string desiredFileName, System.IO.Stream fileData) 
```

现在，当我尝试调用此方法并将引用要上传的文件的 System.IO.Stream 对象传递给它时，我得到一个编译时错误，表明传入的类型（System.IO.Stream）不是预期类型（Mynamespace.ServiceReference.Stream）。我试图将我的流显式转换为类型（Mynamespace.ServiceReference.Stream），但编译器也不会让我这样做，尽管它们是相同的类型！奇怪！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T13:24:44.440

问题是为了生成 WSDL，Stream 将尝试序列化它无法执行的操作。

您最初对 byte[] 的想法是正确的方法。

您无需费心进行 Base64 转换，因为 ASP.NET 运行时已经为您完成了这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T13:25:49.307

这是解决方案。

不要在文件数据的参数中使用 byte[]，而是使用 byte[] 的 base64 字符串表示。

从使用您的 Web 服务的客户端，让它将 byte[] 转换为 base64 字符串，然后将其传递给您的 Web 服务调用。在服务器端，您应该收到字节数组的 ba​​se64 字符串并将其转换回 byte[]。

以下是 .Net Framework 中转换方法的参考。

**[从 byte[] 到 Base64](http://msdn.microsoft.com/en-us/library/dhx0d524.aspx) - 用于 web 服务客户端**

链接文本：http: [//msdn.microsoft.com/en-us/library/dhx0d524.aspx](http://msdn.microsoft.com/en-us/library/dhx0d524.aspx)

**[从 Base64 到 byte[]](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx) - 用于 webservice 服务器**

链接文本：http: [//msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx)

# c# - 创建矩形文本选择

> ID：863310
> 
> 赞同：1
> 
> 时间：2009-05-14T13:20:11.627
> 
> 标签：c#, textbox, selection

您好，我想弄清楚是否可以在 c# 的标准文本框控件中进行矩形文本选择（如在 Jedit 中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:22:59.437

不是没有自己编码对不起

# c# - 如何在vs2008中更改msi安装程序包的图标并在为c#项目创建包后更改用户界面屏幕

> ID：863311
> 
> 赞同：3
> 
> 时间：2009-05-14T13:20:14.407
> 
> 标签：c#, wpf, c#-3.0, windows-installer

我正在尝试更改 msi 安装程序包的图标。我没有找到任何解决方案。我还尝试更改 msi 安装程序包的用户界面。我为该界面获得了一些皮肤，但那是试用版..任何人都知道请帮助我解决上述问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T13:28:17.957

该图标是 .msi 文件的标准图标。您不能从 Visual Studio 2008 的安装项目中修改它。安装项目中使用的屏幕也不能从 Visual Studio 2008 中修改。最好的选择可能是查看其他第 3 部分提供程序。一个例子是[Skin Crafter 安装程序](http://www.skincrafter.com/products/skincrafter-installer)。您还可以使用[Wix](http://wix.sourceforge.net/)并自己创建自定义对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T13:29:59.250

您可以使用 Visual Studio 更改 setup.exe 图标。采取以下步骤。

构建您的设置项目

打开 setup.exe 文件，使用刚刚构建，文件 -> 打开 -> 文件

右键单击文件资源管理器窗口中的图标节点，您可以更改并保存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-01T08:53:19.117

简单的解决方案是使用“Msi to Exe Converter”之类的程序将 msi 转换为 exe。试用版不允许更改图标。要更改图标，请使用 Visual Studio。将exe作为文件打开并删除当前图标资源。然后通过导入你想要的图标来添加一个图标资源。保存并完成。

# iphone - 如何使用使用 Interface Builder 创建的 nib 文件加载 UIView

> ID：863321
> 
> 赞同：241
> 
> 时间：2009-05-14T13:23:12.417
> 
> 标签：iphone, objective-c, ios, cocoa-touch, interface-builder

我正在尝试做一些复杂的事情，但应该是可能的。所以这里对你们所有的专家来说都是一个挑战（这个论坛有很多人:)）。

我正在创建一个问卷“组件”，我想将其加载到`NavigationContoller`（我的`QuestionManagerViewController`）上。“组件”是一个“空” `UIViewController`，可以根据需要回答的问题加载不同的视图。

我这样做的方式是：

1.  创建 Question1View 对象作为`UIView`子类，定义一些`IBOutlets`.
2.  创建（使用界面生成器）`Question1View.xib` **（这里是我的问题可能在哪里**）。我将 the`UIViewController`和 the都设置`UIView`为 Question1View 类。
3.  我将插座与视图的组件链接（使用 IB）。
4.  我覆盖`initWithNib`我`QuestionManagerViewController`的看起来像这样：

    ```
    - (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
        if (self = [super initWithNibName:@"Question1View" bundle:nibBundleOrNil]) {
            // Custom initialization
        }
        return self;
    } 
    ```

当我运行代码时，我收到了这个错误：

> 2009-05-14 15:05:37.152 iMobiDines [17148:20b] *** 由于未捕获的异常“ `NSInternalInconsistencyException`”而终止应用程序，原因：“`-[UIViewController _loadViewFromNibNamed:bundle:]`加载了“Question1View”笔尖，但未设置视图出口。

我确信有一种方法可以使用 nib 文件加载视图，而无需创建 viewController 类。

* * *

## 回答 #1

> 赞同：224
> 
> 时间：2010-10-29T19:45:48.413

还有一种更简单的方法来访问视图，而不是将 nib 作为数组处理。

**1** ) 创建一个自定义 View 子类，其中包含您以后想要访问的任何插座。 - 我的观点

**2** ) 在你想要加载和处理笔尖的 UIViewController 中，创建一个 IBOutlet 属性来保存加载的笔尖的视图，例如

在 MyViewController （一个 UIViewController 子类）

```
 @property (nonatomic, retain) IBOutlet UIView *myViewFromNib; 
```

（不要忘记合成它并在你的 .m 文件中发布它）

**3)**在 IB 中打开您的 nib（我们将其称为“myViewNib.xib”），将文件的所有者设置为**MyViewController**

**4)**现在将文件的 Owner outlet myViewFromNib 连接到 nib 中的主视图。

**5)**现在在 MyViewController 中，编写以下行：

```
[[NSBundle mainBundle] loadNibNamed:@"myViewNib" owner:self options:nil]; 
```

现在，只要你这样做，调用你的属性“self.myViewFromNib”就可以让你从你的笔尖访问视图！

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2009-05-14T22:48:00.360

谢谢你们。我确实找到了一种方法来做我想做的事。

1.  `UIView`用你需要的s创建你的`IBOutlet`。
2.  在 IB 中创建 xib，将其设计为您喜欢的并将其链接如下：文件的所有者属于类`UIViewController`（没有自定义子类，而是“真正的”子类）。文件所有者的视图连接到主视图，并且其类被声明为步骤 1) 中的类。
3.  用 s 连接您的控件`IBOutlet`。
4.  可以运行它的`DynamicViewController`逻辑来决定加载什么视图/xib。一旦做出决定，在`loadView`方法中输入如下内容：

    ```
    NSArray* nibViews = [[NSBundle mainBundle] loadNibNamed:@"QPickOneView"
                                                      owner:self
                                                    options:nil];

    QPickOneView* myView = [ nibViews objectAtIndex: 1];

    myView.question = question; 
    ```

而已！

主包的`loadNibNamed`方法将负责初始化视图和创建连接。

现在 ViewController 可以根据内存中的数据显示一个视图或另一个视图，并且“父”屏幕不需要打扰这个逻辑。

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2010-07-07T01:54:42.173

我不确定有些答案在说什么，但我需要把这个答案放在这里，以备下次在谷歌搜索时使用。关键词：“如何从 nib 加载 UIView”或“如何从 NSBundle 加载 UIView”。

这里的代码几乎 100% 直接来自 Apress*开始 iPhone 3*书（第 247 页，“使用新的表格视图单元格”）：

```
- (void)viewDidLoad {
    [super viewDidLoad];
    NSArray *bundle = [[NSBundle mainBundle] loadNibNamed:@"Blah"
                                                 owner:self options:nil];
    Blah *blah;
    for (id object in bundle) {
        if ([object isKindOfClass:[Blah class]]) {
            blah = (Blah *)object;
            break;
        }
    }   
    assert(blah != nil && "blah can't be nil");
    [self.view addSubview: blah];
} 
```

这假设您有一个名为 的`UIView`子类`Blah`，一个名为 nib 的 nib`Blah`包含一个`UIView`将其类设置为 的`Blah`。

* * *

## 类别：NSObject+LoadFromNib

```
#import "NSObject+LoadFromNib.h"

@implementation NSObject (LoadFromNib)

+ (id)loadFromNib:(NSString *)name classToLoad:(Class)classToLoad {
    NSArray *bundle = [[NSBundle mainBundle] loadNibNamed:name owner:self options:nil];
    for (id object in bundle) {
        if ([object isKindOfClass:classToLoad]) {
            return object;
        }
    }
    return nil;
}

@end 
```

* * *

## 快速扩展

```
extension UIView {
    class func loadFromNib<T>(withName nibName: String) -> T? {
        let nib  = UINib.init(nibName: nibName, bundle: nil)
        let nibObjects = nib.instantiate(withOwner: nil, options: nil)
        for object in nibObjects {
            if let result = object as? T {
                return result
            }
        }
        return nil
    }
} 
```

还有一个使用中的例子：

```
class SomeView: UIView {
    class func loadFromNib() -> SomeView? {
        return self.loadFromNib(withName: "SomeView")
    }
} 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-09-24T16:07:33.537

对于所有需要管理多个自定义视图实例（即**Outlet Collection**）的用户，我以这种方式合并并自定义了@Gonso、@AVeryDev 和@Olie 答案：

1.  创建一个自定义`MyView : UIView`并将其设置为所需**XIB**中根的“**自定义类**” ； `UIView`**![自定义类](https://i.stack.imgur.com/nGAF0.png)**

***   创建您需要的所有**插座**`MyView`（现在就做，因为在第 3 点之后，IB 会建议您将插座连接到`UIViewController`我们想要的而不是自定义视图）； ![自定义类插座](https://i.stack.imgur.com/ZeTSj.png)

    *   将您设置为自定义视图**XIB**`UIViewController`的“**文件所有者**” ； **![在此处输入图像描述](https://i.stack.imgur.com/5MLJH.png)**

    ***   在为您想要的每个实例`UIViewController`添加一个新的，并将它们连接到创建一个**Outlet Collection**：这些视图将充当自定义视图实例的“包装”视图； `UIViews``MyView``UIViewController`**![在此处输入图像描述](https://i.stack.imgur.com/pVGNQ.png)**

    ***   最后，在`viewDidLoad`您的`UIViewController`添加以下行：****** 

 ******> ```
> NSArray *bundleObjects;
> MyView *currView;
> NSMutableArray *myViews = [NSMutableArray arrayWithCapacity:myWrapperViews.count];
> for (UIView *currWrapperView in myWrapperViews) {
>     bundleObjects = [[NSBundle mainBundle] loadNibNamed:@"MyView" owner:self options:nil];
>     for (id object in bundleObjects) {
>         if ([object isKindOfClass:[MyView class]]){
>             currView = (MyView *)object;
>             break;
>         }
>     }
> 
>     [currView.myLabel setText:@"myText"];
>     [currView.myButton setTitle:@"myTitle" forState:UIControlStateNormal];
>     //...
> 
>     [currWrapperView addSubview:currView];
>     [myViews addObject:currView];
> }
> //self.myViews = myViews; if need to access them later.. 
> ```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2014-02-24T15:14:03.880

我会使用 UINib 来实例化一个自定义 UIView 以重用

```
UINib *customNib = [UINib nibWithNibName:@"MyCustomView" bundle:nil];
MyCustomViewClass *customView = [[customNib instantiateWithOwner:self options:nil] objectAtIndex:0];
[self.view addSubview:customView]; 
```

在这种情况下需要的文件是**MyCustomView.xib**、**MyCustomViewClass.h**和**MyCustomViewClass.m** 注意`[UINib instantiateWithOwner]`返回一个数组，所以你应该使用反映你想要重用的 UIView 的元素。在这种情况下，它是第一个元素。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2009-05-14T13:42:29.313

您不应该将视图控制器的类设置为`UIView`Interface Builder 中的子类。这绝对是您问题的至少一部分。将其保留为`UIViewController`它的某个子类或您拥有的其他一些自定义类。

至于仅从 xib 加载视图，我假设您*必须*将某种视图控制器（即使它不扩展`UIViewController`，这对于您的需要可能太重）设置为接口中的文件所有者Builder 如果你想用它来定义你的界面。我也做了一些研究来证实这一点。这是因为否则将无法访问 中的任何界面元素`UIView`，也无法让您自己的代码中的方法由事件触发。

如果您使用 a`UIViewController`作为视图的文件所有者，则可以使用`initWithNibName:bundle:`它来加载它并取回视图控制器对象。在 IB 中，确保将`view`出口设置为带有 xib 界面的视图。如果您使用其他类型的对象作为文件的所有者，则需要使用`NSBundle`'`loadNibNamed:owner:options:`方法来加载 nib，将文件所有者的实例传递给该方法。它的所有属性都将根据您在 IB 中定义的网点进行正确设置。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2011-10-15T15:39:55.130

你也可以使用 UIViewController 的 initWithNibName 代替 loadNibNamed。我发现它更简单。

```
UIViewController *aViewController = [[UIViewController alloc] initWithNibName:@"MySubView" bundle:nil];
[self.subview addSubview:aViewController.view];
[aViewController release];  // release the VC 
```

现在您只需创建 MySubView.xib 和 MySubView.h/m。在 MySubView.xib 中，将 File 的 Owner 类设置为 UIViewController，并将视图类设置为 MySubView。

`subview`您可以使用父 xib 文件的位置和大小。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2011-08-30T00:20:00.557

这是应该更容易的事情。我最终扩展`UIViewController`并添加了一个`loadNib:inPlaceholder:`选择器。现在我可以说

```
self.mySubview = (MyView *)[self loadNib:@"MyView" inPlaceholder:mySubview]; 
```

这是该类别的代码（它与 Gonso 描述的 rigamarole 相同）：

```
@interface UIViewController (nibSubviews)

- (UIView *)viewFromNib:(NSString *)nibName;
- (UIView *)loadNib:(NSString *)nibName inPlaceholder:(UIView *)placeholder;

@end

@implementation UIViewController (nibSubviews)

- (UIView *)viewFromNib:(NSString *)nibName
{
  NSArray *xib = [[NSBundle mainBundle] loadNibNamed:nibName owner:self options:nil]; 
  for (id view in xib) { // have to iterate; index varies
    if ([view isKindOfClass:[UIView class]]) return view;
  }
  return nil;
}

- (UIView *)loadNib:(NSString *)nibName inPlaceholder:(UIView *)placeholder
{
  UIView *nibView = [self viewFromNib:nibName];
  [nibView setFrame:placeholder.frame];
  [self.view insertSubview:nibView aboveSubview:placeholder];
  [placeholder removeFromSuperview];
  return nibView;
}

@end 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2011-07-08T23:33:09.803

这是一个很好的问题（+1），答案*几乎*是有帮助的；）对不起，伙计们，但我花了很长时间来解决这个问题，尽管 Gonso 和 AVeryDev 都给出了很好的提示。希望这个答案对其他人有所帮助。

`MyVC`是持有所有这些东西的视图控制器。

`MySubview`是我们要从 xib 加载的视图

*   在 MyVC.xib 中，创建一个`MySubView`大小和形状正确并放置在您想要的位置的类型视图。
*   在 MyVC.h 中，有

    ```
    IBOutlet MySubview *mySubView
    // ...
    @property (nonatomic, retain) MySubview *mySubview; 
    ```

*   在 MyVC.m 中，`@synthesize mySubView;`不要忘记在`dealloc`.

*   在 MySubview.h 中，有一个出口/属性`UIView *view`（可能是不必要的，但对我有用。）在 .m 中合成并发布它
*   在 MySubview.xib 中
    *   将文件所有者类型设置为`MySubview`，并将视图属性链接到您的视图。
    *   布置所有位并`IBOutlet`根据需要连接到
*   回到 MyVC.m，有

    ```
    NSArray *xibviews = [[NSBundle mainBundle] loadNibNamed: @"MySubview" owner: mySubview options: NULL];
    MySubview *msView = [xibviews objectAtIndex: 0];
    msView.frame = mySubview.frame;
    UIView *oldView = mySubview;
    // Too simple: [self.view insertSubview: msView aboveSubview: mySubview];
    [[mySubview superview] insertSubview: msView aboveSubview: mySubview]; // allows nesting
    self.mySubview = msView;
    [oldCBView removeFromSuperview]; 
    ```

对我来说棘手的一点是：其他答案中的提示从 xib 加载了我的视图，但并没有替换 MyVC 中的视图（呃！）——我必须自己换掉。

此外，要访问`mySubview`的方法，`view`必须将 .xib 文件中的属性设置为`MySubview`。否则，它会以普通旧的`UIView`.

如果有办法`mySubview`直接从它自己的 xib 加载，那就太棒了，但这让我到达了我需要的地方。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2016-02-05T09:42:49.463

**迅速**

实际上，我对这个问题的解决方案是，在我的 CustonViewController 中的 viewDidLoad 中加载视图，我想在其中使用这样的视图：

```
myAccessoryView = NSBundle.mainBundle().loadNibNamed("MyAccessoryView", owner: self, options: nil)[0] as! MyAccessoryView 
```

不要在`loadView()`方法中加载视图！loadView 方法用于为您的自定义 ViewController 加载视图。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2010-04-21T13:14:40.570

我也想做类似的事情，这就是我发现的：（SDK 3.1.3）

我有一个视图控制器 A（本身由导航控制器拥有），它在按下按钮时加载 VC B：

在 AViewController.m

```
BViewController *bController = [[BViewController alloc] initWithNibName:@"Bnib" bundle:nil];
[self.navigationController pushViewController:bController animated:YES];
[bController release]; 
```

现在 VC B 的界面来自 Bnib，但是当按下按钮时，我想进入“编辑模式”，该模式具有与不同 nib 不同的 UI，但我不想要新的 VC 用于编辑模式，我希望新的笔尖与我现有的 B VC 相关联。

所以，在 BViewController.m 中（在按钮按下方法中）

```
NSArray *nibObjects = [[NSBundle mainBundle] loadNibNamed:@"EditMode" owner:self options:nil];
UIView *theEditView = [nibObjects objectAtIndex:0];
self.editView = theEditView;
[self.view addSubview:theEditView]; 
```

然后在另一个按钮上按下（退出编辑模式）：

```
[editView removeFromSuperview]; 
```

我又回到了我原来的 Bnib。

这很好用，但请注意我的 EditMode.nib 中只有 1 个顶级 obj，即 UIView obj。这个 nib 中的 File's Owner 设置为 BViewController 还是默认的 NSObject 都没有关系，但请确保 File's Owner 中的 View Outlet 未设置为任何内容。如果是，那么我会遇到 exc_bad_access 崩溃，xcode 继续加载 6677 个堆栈帧，显示重复调用的内部 UIView 方法......所以看起来像一个无限循环。（然而，View Outlet 设置在我原来的 Bnib 中）

希望这可以帮助。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2014-09-24T20:31:44.380

我做了一个我喜欢的类别：

`UIView+NibInitializer.h`

```
#import <UIKit/UIKit.h>

@interface UIView (NibInitializer)
- (instancetype)initWithNibNamed:(NSString *)nibNameOrNil;
@end 
```

`UIView+NibInitializer.m`

```
#import "UIView+NibInitializer.h"

@implementation UIView (NibInitializer)

- (instancetype)initWithNibNamed:(NSString *)nibNameOrNil
{
    if (!nibNameOrNil) {
        nibNameOrNil = NSStringFromClass([self class]);
    }
    NSArray *viewsInNib = [[NSBundle mainBundle] loadNibNamed:nibNameOrNil
                                                        owner:self
                                                      options:nil];
    for (id view in viewsInNib) {
        if ([view isKindOfClass:[self class]]) {
            self = view;
            break;
        }
    }
    return self;
}

@end 
```

然后，像这样调用：

```
MyCustomView *myCustomView = [[MyCustomView alloc] initWithNibNamed:nil]; 
```

如果您的 nib 的名称不是您的班级名称，请使用 nib 名称。

要在子类中覆盖它以获得其他行为，它可能如下所示：

```
- (instancetype)initWithNibNamed:(NSString *)nibNameOrNil
{
    self = [super initWithNibNamed:nibNameOrNil];
    if (self) {
        self.layer.cornerRadius = CGRectGetHeight(self.bounds) / 2.0;
    }
    return self;
} 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2016-06-18T08:00:50.373

对于具有可设计选项的 Swift 用户：

1.  创建一个自定义`UIView`子类**和一个 xib 文件**，我们将以自己的类名命名：在我们的例子中是 MemeView。在 Meme View 类中，请记住`@IBDesignable`在类声明之前使用属性将其定义为可设计
2.  Rember 使用我们`UIView`在 Indetity Inspector 面板中的自定义子类在 xib中设置文件的所有者

    [![在此处输入图像描述](https://i.stack.imgur.com/qflAp.png)](https://i.stack.imgur.com/qflAp.png)

3.  现在，在 xib 文件中，我们可以构建我们的界面、制作约束、创建出口、操作等。 [![在此处输入图像描述](https://i.stack.imgur.com/OKNW0.png)](https://i.stack.imgur.com/OKNW0.png)

4.  我们需要为我们的自定义类实现一些方法以在初始化后打开 xib

    `class XibbedView: UIView {`

    ```
    weak var nibView: UIView!

    override convenience init(frame: CGRect) {
        let nibName = NSStringFromClass(self.dynamicType).componentsSeparatedByString(".").last!
        self.init(nibName: nibName)
    }

    required init?(coder aDecoder: NSCoder) {
        super.init(coder: aDecoder)
        let nibName = NSStringFromClass(self.dynamicType).componentsSeparatedByString(".").last!
        let nib = loadNib(nibName)
        nib.frame = bounds
        nib.translatesAutoresizingMaskIntoConstraints = false
        addSubview(nib)
        nibView = nib
        setUpConstraints()
    }

    init(nibName: String) {
        super.init(frame: CGRectZero)
        let nibName = NSStringFromClass(self.dynamicType).componentsSeparatedByString(".").last!
        let nib = loadNib(nibName)
        nib.frame = bounds
        nib.translatesAutoresizingMaskIntoConstraints = false
        addSubview(nib)
        nibView = nib
        setUpConstraints()
    }

    func setUpConstraints() {
        ["V","H"].forEach { (quote) -> () in
            let format = String(format:"\(quote):|[nibView]|")
            addConstraints(NSLayoutConstraint.constraintsWithVisualFormat(format, options: [], metrics: nil, views: ["nibView" : nibView]))
        }
    }

    func loadNib(name: String) -> UIView {
        let bundle = NSBundle(forClass: self.dynamicType)
        let nib = UINib(nibName: name, bundle: bundle)
        let view = nib.instantiateWithOwner(self, options: nil)[0] as! UIView

        return view
    } 
    ```

    }

5.  在我们的自定义类中，我们还可以定义一些不可检查的属性，以便从界面构建器中完全控制它们

    `@IBDesignable class MemeView: XibbedView {`

    ```
    @IBInspectable var memeImage: UIImage = UIImage() {
        didSet {
            imageView.image = memeImage
        }
    }
    @IBInspectable var textColor: UIColor = UIColor.whiteColor() {
        didSet {
            label.textColor = textColor
        }
    }
    @IBInspectable var text: String = "" {
        didSet {
            label.text = text
        }
    }
    @IBInspectable var roundedCorners: Bool = false {
        didSet {
            if roundedCorners {
                layer.cornerRadius = 20.0
                clipsToBounds = true
            }
            else {
                layer.cornerRadius = 0.0
                clipsToBounds = false
            }
        }
    }

    @IBOutlet weak var label: UILabel!
    @IBOutlet weak var imageView: UIImageView! 
    ```

}

几个例子：
[![在此处输入图像描述](https://i.stack.imgur.com/wW7nG.png)](https://i.stack.imgur.com/wW7nG.png) [![在此处输入图像描述](https://i.stack.imgur.com/a3Fwx.png)](https://i.stack.imgur.com/a3Fwx.png)

如果我们需要在情节提要或另一个 xib 中显示视图时添加更多信息，为此我们可以实现`prepareForInterfaceBuilder()`，此方法将仅在界面构建器中打开文件时执行。如果你做了我写的所有事情但没有任何工作，这是一种通过在其实现中添加断点来调试单个视图的方法。 这是视图层次结构。 [![在此处输入图像描述](https://i.stack.imgur.com/zUsxd.png)](https://i.stack.imgur.com/zUsxd.png)
[![查看层次结构](https://i.stack.imgur.com/4Sj7F.png)](https://i.stack.imgur.com/4Sj7F.png)

希望这可以帮助一个完整的样本可以在[这里下载](https://www.dropbox.com/s/xur6ar54iyfi2fk/DesignableExample.zip?dl=0)

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2010-03-25T19:33:26.173

我发现Aaron Hillegass（作者、讲师、Cocoa ninja）的[这篇博](http://weblog.bignerdranch.com/?p=129)文很有启发性。即使您不采用他修改后的方法通过指定的初始化程序加载 NIB 文件，您也可能至少会更好地了解正在进行的过程。我最近一直在使用这种方法，取得了巨大的成功！

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-07-01T05:07:14.887

前面的答案没有考虑到 iPhone SDK 2.0 和 2.1 之间发生的 NIB (XIB) 结构的变化。用户内容现在从索引 0 而不是 1 开始。

您可以使用适用于所有 2.1 及更高版本的 2.1 宏（即 IPHONE 之前的两个下划线：

```
 // Cited from previous example
 NSArray* nibViews =  [[NSBundle mainBundle] loadNibNamed:@"QPickOneView" owner:self options:nil];
 int startIndex;
 #ifdef __IPHONE_2_1
 startIndex = 0;
 #else
 startIndex = 1;
 #endif
 QPickOneView* myView = [ nibViews objectAtIndex: startIndex];
 myView.question = question; 
```

我们在大多数应用程序中使用与此类似的技术。

巴尼

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-10-25T19:33:46.953

我有理由做同样的事情（以编程方式从 XIB 文件加载视图），但我需要完全从 a 的子类的子类的上下文中执行此操作`UIView`（即不以任何方式涉及视图控制器）。为此，我创建了这个实用程序方法：

```
+ (id) initWithNibName:(NSString *)nibName withSelf:(id)myself {

    NSArray *bundle = [[NSBundle mainBundle] loadNibNamed:nibName
                                                    owner:myself options:nil];
    for (id object in bundle) {
        if ([object isKindOfClass:[myself class]]) {
            return object;
        }
    }  

    return nil;
} 
```

然后我从我的子类的`initWithFrame`方法中调用它，如下所示：

```
- (id)initWithFrame:(CGRect)frame {

    self = [Utilities initWithNibName:@"XIB1" withSelf:self];
    if (self) {
        // Initialization code.
    }
    return self;
} 
```

出于一般兴趣而发布；如果有人在不这样做的情况下发现任何问题，请告诉我。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2015-08-22T12:37:58.053

这是在 Swift 中执行此操作的一种方法（目前在 XCode 7 beta 5 中编写 Swift 2.0）。

从您`UIView`在 Interface Builder 中设置为“自定义类”的子类创建一个这样的方法（我的子类称为 RecordingFooterView）：

```
class func loadFromNib() -> RecordingFooterView? {
    let nib = UINib(nibName: "RecordingFooterView", bundle: nil)
    let nibObjects = nib.instantiateWithOwner(nil, options: nil)
    if nibObjects.count > 0 {
        let topObject = nibObjects[0]
        return topObject as? RecordingFooterView
    }
    return nil
} 
```

然后你可以这样称呼它：

`let recordingFooterView = RecordingFooterView.loadFromNib()`

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2010-11-25T07:13:48.580

@AVeryDev

**6)**将加载的视图附加到视图控制器的视图：

```
[self.view addSubview:myViewFromNib]; 
```

据推测，有必要将其从视图中删除以避免内存泄漏。

澄清一下：视图控制器有几个 IBOutlets，其中一些连接到原始 nib 文件中的项目（像往常一样），一些连接到加载的 nib 中的项目。两个笔尖都具有相同的所有者类别。加载的视图覆盖了原始视图。

提示：将加载的笔尖中主视图的不透明度设置为零，这样就不会遮挡原始笔尖中的项目。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2011-04-26T20:06:56.097

没有一个答案解释了如何创建作为这个问题根源的独立 XIB。没有`Xcode 4`“创建新的 XIB 文件”选项。

去做这个

```
1) Choose "New File..."
2) Choose the "User Interface" category under the iOS section
3) Choose the "View" item
4) You will then be prompted to choose an iPhone or iPad format 
```

这可能看起来很简单，但它可以为您节省几分钟的时间，因为“XIB”这个词不会出现在任何地方。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-06-18T07:44:31.757

花了很多时间后，我伪造了以下解决方案。按照以下步骤创建自定义`UIView`.

1) 创建从**UIView**继承的**myCustomView**类。 **[![在此处输入图像描述](https://i.stack.imgur.com/dZXFq.png)](https://i.stack.imgur.com/dZXFq.png)**

 **2) 创建名为**myCustomView的****.xib**。 **[![在此处输入图像描述](https://i.stack.imgur.com/vxSnf.png)](https://i.stack.imgur.com/vxSnf.png)**

 **3）更改.xib 文件中的**UIView类，在那里分配****myCustomView**类。
[![在此处输入图像描述](https://i.stack.imgur.com/enKtV.png)](https://i.stack.imgur.com/enKtV.png)

4) 创建**IBOutlets**
[![在此处输入图像描述](https://i.stack.imgur.com/mGoBT.png)](https://i.stack.imgur.com/mGoBT.png)

5) 在**myCustomView * customView 中加载 .xib**。使用以下示例代码。

```
myCustomView * myView = [[[NSBundle mainBundle] loadNibNamed:@"myCustomView" owner:self options:nil] objectAtIndex:0];
[myView.description setText:@"description"]; 
```

> 注意：对于那些仍然遇到问题的人可以发表评论，我将提供示例项目的链接与**myCustomView**

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2017-11-29T11:48:36.673

最短版本：

```
RSFavoritePlaceholderView *favoritePlaceholderView = [[[NSBundle mainBundle] loadNibNamed:@"RSFavoritePlaceholderView" owner:self options:nil] firstObject]; 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-12-09T04:27:07.210

我有一个命名 xibs 的约定，其中的视图与视图相同。就像对视图控制器所做的一样。然后，我不必在代码中写出类名。我从同名的 nib 文件加载 UIView。

名为 MyView 的类的示例。

*   在 Interface Builder 中创建一个名为 MyView.xib 的 nib 文件
*   在 Interface Builder 中，添加一个 UIView。将其类设置为 MyView。自定义您的心脏内容，将 MyView 的实例变量连接到您以后可能想要访问的子视图。
*   在您的代码中，像这样创建一个新的 MyView：

    MyView *myView = [MyView nib_viewFromNibWithOwner:owner];

这是这个类别：

```
@implementation UIView (nib)

+ (id) nib_viewFromNib {
    return [self nib_viewFromNibWithOwner:nil];
}

+ (id) nib_viewFromNibWithOwner:(id)owner {
    NSString *className = NSStringFromClass([self class]);
    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:className owner:owner options:nil];
    UIView *view = nil;
    for(UIView *v in nib) {
        if ([v isKindOfClass:[self class]]) {
            view = v;
            break;
        }
    }
    assert(view != nil && "View for class not found in nib file");
    [view nib_viewDidLoad];
    return view;
}

// override this to do custom setup
-(void)nib_viewDidLoad {

} 
```

然后，我将按钮与我正在使用的控制器的操作连接起来，并使用我的自定义视图子类中的插座在标签上设置内容。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-01-05T08:04:49.283

在 Swift 4 中以编程方式从 nib/xib 加载视图：

```
// Load a view from a Nib given a placeholder view subclass
//      Placeholder is an instance of the view to load.  Placeholder is discarded.
//      If no name is provided, the Nib name is the same as the subclass type name
//
public func loadViewFromNib<T>(placeholder placeholderView: T, name givenNibName: String? = nil) -> T {

    let nib = loadNib(givenNibName, placeholder: placeholderView)
    return instantiateView(fromNib: nib, placeholder: placeholderView)
}

// Step 1: Returns a Nib
//
public func loadNib<T>(_ givenNibName: String? = nil, placeholder placeholderView: T) -> UINib {
    //1\. Load and unarchive nib file
    let nibName = givenNibName ?? String(describing: type(of: placeholderView))

    let nib = UINib(nibName: nibName, bundle: Bundle.main)
    return nib
}

// Step 2: Instantiate a view given a nib
//
public func instantiateView<T>(fromNib nib: UINib, placeholder placeholderView: T) -> T {
    //1\. Get top level objects
    let topLevelObjects = nib.instantiate(withOwner: placeholderView, options: nil)

    //2\. Have at least one top level object
    guard let firstObject = topLevelObjects.first else {
        fatalError("\(#function): no top level objects in nib")
    }

    //3\. Return instantiated view, placeholderView is not used
    let instantiatedView = firstObject as! T
    return instantiatedView
} 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2013-03-19T06:21:11.657

我最终为此向 UIView 添加了一个类别：

```
 #import "UIViewNibLoading.h"

 @implementation UIView (UIViewNibLoading)

 + (id) loadNibNamed:(NSString *) nibName {
    return [UIView loadNibNamed:nibName fromBundle:[NSBundle mainBundle] retainingObjectWithTag:1];
 }

 + (id) loadNibNamed:(NSString *) nibName fromBundle:(NSBundle *) bundle retainingObjectWithTag:(NSUInteger) tag {
    NSArray * nib = [bundle loadNibNamed:nibName owner:nil options:nil];
    if(!nib) return nil;
    UIView * target = nil;
    for(UIView * view in nib) {
        if(view.tag == tag) {
            target = [view retain];
            break;
        }
    }
    if(target && [target respondsToSelector:@selector(viewDidLoad)]) {
        [target performSelector:@selector(viewDidLoad)];
    }
    return [target autorelease];
 }

 @end 
```

此处解释：[viewcontroller is less view loading in ios&mac](http://gngrwzrd.com/blog-view-controller-less-view-loading-ios-mac.html)

# javascript - 假设始终打开 Javascript 是否安全？

> ID：863323
> 
> 赞同：1
> 
> 时间：2009-05-14T13:23:48.157
> 
> 标签：javascript

### 复制：

> [网站真的需要迎合没有启用 Javascript 的浏览器吗？](https://stackoverflow.com/questions/822872/do-web-sites-really-need-to-cater-for-browsers-that-dont-have-javascript-enabled)
> [仅支持启用了 Javascript 的用户。](https://stackoverflow.com/questions/740243/only-supporting-users-who-have-javascript-enabled)
> [Javascript 被禁用有多普遍 有](https://stackoverflow.com/questions/379735/how-common-is-it-for-javascript-to-be-disabled)
> [多少人禁用 Javascript？](https://stackoverflow.com/questions/121108/how-many-people-disable-javascript)

几年来，我一直在断断续续地做 Web 应用程序，而且我编写的每个应用程序似乎都比前一个应用程序拥有更多的 javascript。

一个常见的评论是：“但是如果用户关闭了 Javascript 怎么办？”。

我明白这一点，但我从未真正见过用户这样做。不止一次。

你？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T13:26:55.090

这大约每隔一周左右出现一次。你先搜索了吗？

看到这些：
[https ://stackoverflow.com/questions/121108/how-many-people-disable-javascript](https://stackoverflow.com/questions/121108/how-many-people-disable-javascript)
[https://stackoverflow.com/questions/379735/how-common-is-it-for-javascript-to- be-disabled](https://stackoverflow.com/questions/379735/how-common-is-it-for-javascript-to-be-disabled)
[只支持启用了 Javascript 的用户](https://stackoverflow.com/questions/740243/only-supporting-users-who-have-javascript-enabled)
[网站真的需要迎合没有启用 Javascript 的浏览器吗？](https://stackoverflow.com/questions/822872/do-web-sites-really-need-to-cater-for-browsers-that-dont-have-javascript-enabled)

要点是：

*   谷歌在索引时不使用 javascript
*   移动浏览器（像 iPhone 这样的智能手机）有时有坏的或不存在的 javascript
*   屏幕阅读器不能很好地处理 javascript，如果有的话，许多开发人员在法律上必须支持它们。
*   多亏了像 NoScript 这样的过滤器，禁用 javascript 浏览的人数（至少最初是这样的）实际上可能会*上升*。

所以，是的，你仍然需要担心它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T13:26:15.310

这完全取决于您需要什么样的覆盖范围。

您是否需要 80% 90% 100% 的用户才能使用您的网站/应用程序？

人们确实会关闭 Javascript。问题是，您的网站是否需要为这些人服务？如果他们想继续，它可以告诉他们打开它吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T13:24:57.483

是的，它发生了。

NoScript 是一个 Firefox 插件 - 被很多人下载。

[没有脚本](http://noscript.net/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T13:26:04.017

您应该始终确保您的网站在没有 javascript 的情况下也能正常工作。

人们出于安全原因关闭了javascript。公司有时会在其内部计算机上强制关闭 javascript。此外，蜘蛛没有 javascript，因此您的网站在没有 javascript 的情况下无法正常工作是不好的 SEO 做法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T13:26:45.247

[5% 的用户关闭了 JavaScript。](http://www.w3schools.com/browsers/browsers_stats.asp)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T13:26:58.710

假设用户已安装并打开 JS，这已成为我办公室的标准（无论好坏）。每天关闭它的人数越来越少，但这仍然不意味着您应该放弃在服务器端执行必要的提交验证以防万一（以及其他一些场景） ）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-14T13:27:46.133

我会说假设 javascript 始终处于打开状态是不安全的，但要求打开 javascript 是安全的。

换句话说，你不需要跳过箍来让某些东西在没有它的情况下工作，只需显示一条消息或重定向。

Javascript 是一项必不可少的技术，要求它并非没有道理。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-14T13:27:47.303

这很少见，但有可能。如果您要为“每个人”启动一个应用程序以在互联网上使用，那么是的，您必须为这样的事件做准备。这实际上取决于您的目标受众，但最安全的假设是有人会关闭它。

从安全的角度来看，您肯定需要处理这种情况，因为关闭 JavaScript（或更糟的是劫持您编写的脚本）很容易绕过业务逻辑和验证，如果它没有在服务器上进行双重检查。在这种情况下，要求将其打开并不足以阻止人们。请记住，您要求浏览器告诉您它启用和禁用的内容。用户（或本例中的攻击者）控制着浏览器，您不能相信它所说的内容，因为修改 HTTP 标头很容易。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-14T13:28:53.073

取决于你的目标受众是谁。一些用户出于各种原因关闭了 JS。通常，他们会为需要它的各个站点启用它，但如果您不告诉他们他们需要它，他们可能不会这样做。

如果您的网站无法正确加载，他们会认为它已损坏。如果它显示“您需要 JS 才能查看此页面”消息，那么至少他们会知道该怎么做。

然后有些人会专门为您的网站启用 Javascript，但有些人不会，他们根本无法使用您的网站，除非它在没有 Javascript 的情况下可以正常工作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-14T13:27:31.110

这是罕见的，但它会发生。这实际上取决于您的用户群是谁。如果它是针对企业用户的，他们中的很多人都有禁用 javascript 的默认安全设置。如果它是为了……几乎所有其他人，他们很可能会打开它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-14T13:28:40.937

默认情况下，我为新站点 (NoScript) 插件关闭了 javascript。我认为许多精通技术的用户也会这样做。至少那些对 XSS 攻击有偏执的人。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-14T13:29:48.640

为关闭 JavaScript 的用户编写代码是最佳实践。

作为 Web 开发人员，您的目标应该是提供核心的基本功能（无需 JavaScript）。这使所有用户都可以充分使用您的网站。然后通过使用 JavaScript，在一个被称为“渐进增强”的过程中，为打开了 JavaScript 的用户修饰网站的元素。

在 JavaScript 关闭的情况下......您的网站应该优雅地降级。

Web 开发是您不能期待任何事情的领域之一。为所有用户编写代码，以最大限度地提高您网站的可访问性。

# macos - Mac OS X 下 Web 服务器的正确目录布局是什么？

> ID：863326
> 
> 赞同：3
> 
> 时间：2009-05-14T13:24:12.273
> 
> 标签：macos, deployment, packaging, osx-leopard, cherokee

我正在打包 Cherokee Web 服务器，这是一个非常快速的网络服务器，带有一个很好的基于 Web 的 GUI，用于配置由西班牙黑客 Alvaro Lopez Herrera 编写，可从[http://www.cherokee-project.com](http://www.cherokee-project.com)获得。

到目前为止，我已经设法使用 Xcode 附带的 Apple PackageMaker.app 创建了一个 .pkg 安装程序，但我正在 /opt/cherokee 下安装所有内容。

我想我想让二进制文件转到已经在路径中的目录，并且对于联机帮助页和其他内容也是如此。

我看起来像使用 prefix=/usr 安装所有东西都可以很好地工作，除了应该去 /etc/cherokee 的配置文件和文档根目录可以去 /var/www 但我不确定。

这行得通还是我应该在 /Library 下使用一些目录结构？像 /Library/Cherokee/VERSION/ ???

Apple 捆绑的 Apache 似乎使用 prefix=/usr 安装，但在 /etc/apache2 和 CGI​​ 中安装了配置文件，并在 /Library/WebServer/Documents 中安装了文档根目录到 /Library/WebServer 的手册。

也许我的 docroot 应该是 /Library/Cherokee/Documents 或类似的东西......

作为参考，Cherokee 的默认布局是这样的：（仅 dirs）

[http://pastebin.com/f57bc2d21](http://pastebin.com/f57bc2d21)

我在这里先向您的帮助表示感谢！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T15:20:06.863

不要直接安装在`/usr`. 那是苹果的领域。虽然`/opt`可能没问题，但它不会位于默认路径中，并且通常不用作 Mac OS X 中第三方 Unix 软件的默认安装位置。

我的建议是将所有内容安装在`/usr/local`. Apple 不会触及该区域（例如，在系统更新期间等），`/usr/local/bin`应该在用户的默认路径中，并且我观察到许多其他 Mac OS X 服务器软件包使用此位置。

但是，我使用的大多数 Mac OS X 软件包（以及我在 Mac OS X 上从源代码构建的大多数软件）都会创建一个`/usr/local/whatever/...`包含目录。因此，例如，所有 MySQL 都将位于这`/usr/local/mysql/...` 意味着 MySQL 二进制文件*不在*用户的默认路径中。但我认为这种额外级别的目录结构的改进隔离是值得的。（另一种选择是安装所有内容，然后将符号链接添加到您最重要的可执行文件中）`/usr/local/mysql/bin/...`*`/usr/local/whatever/...``/usr/local/bin`*

 *# c# - nHibernate ManyToManyToMany with Fluent

> ID：863334
> 
> 赞同：1
> 
> 时间：2009-05-14T13:25:07.013
> 
> 标签：c#, nhibernate, fluent-nhibernate

我在这里有一个结构，我有一个 ManyToManyToMany 关系。

这是我的（截断的）流畅的映射。

```
public AgencyMap() 
{
    Id(x => x.AgencyId, "AgencyId");            
    Map(x => x.AgencyCode, "AgencyCode");
    HasManyToMany<Personnel>(x => x.Personnel)
    .WithTableName("AgencyPersonnel")
    .WithParentKeyColumn("AgencyId")
        .WithChildKeyColumn("PersonnelId").Cascade.All().LazyLoad();
}

public PersonnelMap() 
{
    Id(x => x.PersonnelId, "PersonnelId");    
    HasManyToMany<Discipline>(x => x.Disciplines)
        .WithTableName("AgencyPersonnelDiscipline")
        .WithParentKeyColumn("AgencyPersonnelId")
        .WithChildKeyColumn("DisciplineId")
        .Cascade.SaveUpdate().LazyLoad();
}           

public DisciplineMap() 
{
    SchemaIs("dbo");            
    Id(x => x.DisciplineId, "DisciplineId");            
    Map(x => x.DisciplineCode, "DisciplineCode");           
    Map(x => x.Description, "Description");         
} 
```

如果我然后运行这样的代码。

```
Agency agency = m_AgencyRepository.Get(10);
var personnel = new Personnel() { ... };
personnel.Disciplines.Add(new Discipline() { ... });
agency.Personnel.Add(personnel);
m_AgencyRepository.Save(agency); 
```

当我运行此代码时，我收到此错误。

```
could not insert collection: [PPSS.Model.Personnel.Disciplines#22][SQL: SQL not available]
The INSERT statement conflicted with the FOREIGN KEY constraint "AgencyPersonnel_AgencyPersonnelDiscipline_FK1". The conflict occurred in database "PPSS2", table "dbo.AgencyPersonnel", column 'AgencyPersonnelId'.\r\nThe statement has been terminated. 
```

实体看起来像。

```
public class Agency
{
  public virtual int AgencyId {get; set;}
  public virtual IList<Personnel> Personnel {get; set;}
}

public class Personnel
{
  public virtual int PersonnelId {get; set;}
  public virtual IList<Agency> Agencies {get; set;}
  public virtual IList<Dependency> Dependencies {get; set;}
}

public class Dependency
{
  public virtual int DependencyId {get; set;}
  public virtual string Name {get; set;}
} 
```

如果我在 Personnel 中的 ManyToMany 中添加一个逆，则保存 Personnel 但不保存学科（不引发异常）。

这个映射应该怎么做？

编辑：

我得到了更多信息。如果我禁用约束 AgencyPersonnel_AgencyPersonnelDiscipline_FK1 ，那么一切都可以插入。这让我觉得问题在于 nHibernate 插入的顺序。我希望它按顺序做的是。

1.  插入人员
2.  获取最后一个密钥（PersonnelId）
3.  使用 AgencyId 和 PersonnelId 插入 AgencyPersonnelDiscipline。

这不会违反任何约束。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T03:40:27.580

由于这是一个截断的映射，我将在黑暗中拍摄:)。当我有 2 个实体时，这种异常通常会发生在我身上： X 和 Y ，我从两个方向映射它们，例如：

X 有一个属性 Y

Y 有一个 X 列表

而且它们都没有设置 Inverse() 属性。检查您是否在两个方向上映射某些东西，但没有在它们上设置一个 Inverse()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-26T11:16:46.287

鉴于您拥有的地图对于您陈述的类型是正确的，您还没有从 Personnel 映射回 Agency 或从 Discipline 映射到 Personnel。

# asp.net-mvc - FileStreamResult 和 FilePathResult 的区别？

> ID：863351
> 
> 赞同：14
> 
> 时间：2009-05-14T13:28:07.180
> 
> 标签：asp.net-mvc, actionresult

我有一个返回图像的简单控制器：

```
public class ImageController : Controller
{
    [AcceptVerbs(HttpVerbs.Get)]
    [OutputCache(CacheProfile = "StationeryImageCache")]
    public FileResult Show(int customerId, string imageName)
    {
        try
        {
            var path = string.Concat(Config.ImageDir, customerId, @"\", imageName);
            return new FileStreamResult(new FileStream(path, FileMode.Open), "image/jpeg");
        }
        catch(System.IO.FileNotFoundException ex)
        {
            throw new MissingImageException(imageName);
        }
    }
} 
```

我的经理在代码审查期间注意到了 FileStreamResult，并提到我应该将其替换为：

```
return new FilePathResult(path, "image/jpeg"); 
```

这对我来说很有意义，所以我做到了。但几天后，我们的一位其他开发人员报告说，我返回的一些图像被损坏了。具体来说，有很多图像在某个时候被截断。图像的大小是正确的，但图像底部的 25% - 40% 完全消失了。

在文件系统上查看原始图像时，它没有任何问题。我将图像放入浏览器中，看起来不错。但我的控制器只返回了部分图像。更糟糕的是，只有一些图像存在问题......其中大约 %30 ......虽然我无法找到有效和无效之间的任何特殊差异。

在尝试调试时，我将操作的结果恢复为 FileStreamResult，突然一切都恢复了。

有谁知道对此的解释？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T13:42:10.123

FilePathResult 中使用的 HttpResponse.TransmitFile 似乎存在或曾经存在一些问题。[根据此修补程序](http://support.microsoft.com/kb/902780)，它可能取决于您运行服务器的 Windows 版本。如果您在 Google 上搜索“response.TransmitFile 错误”之类的内容，您会收到很多错误。

我想你应该使用你的原始代码！

# javascript - jQuery：如何选择“从这里到下一个 H2”？

> ID：863356
> 
> 赞同：30
> 
> 时间：2009-05-14T13:29:13.680
> 
> 标签：javascript, jquery, dom, jquery-selectors, css-selectors

我正在使用 jQuery 设置一个非常简单的常见问题解答页面。像这样：

```
<h2>What happens when you click on this question?</h2>
<p>This answer will appear!</p> 
```

这都在一个非常具体的 div 中，所以我将选择带有`$('#faq h2')`. 很简单，对吧？单击 H2，然后使用`this.next()`显示下一段。

（这个页面的警告是非程序员将维护它，这就是我不使用类的原因：不能保证任何新条目中都会有正确的类。）

所以！问题：

```
<h2>What happens when you click on the next question?</h2>
<p>That is an interesting conundrum.</p>
<p>Because the maintainer is kind of long-winded</p>
<p>and many answers will span a few paragraphs.</p> 
```

那么，如何在不添加`div`s 和 classes 以及诸如此类的情况下，让我的`this.next()`例程选择问题-that-was-clicked-on 和下一个问题（H2 标题）之间的所有内容？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2010-02-06T22:49:45.673

我意识到这是一个老问题，但 jQuery 1.4 现在有了[nextUntil](http://api.jquery.com/nextUntil/)。所以这样的事情现在应该可以工作了：

```
$('h2').click(function(){
    $(this).nextUntil('h2').show();
}) 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-14T13:48:29.003

有趣的问题。首先让我说，我认为最好的策略是将整个答案包含在一个 div 中，然后问题就变得微不足道了：

```
<h2>Question here</h2>
<div>
<p>Answer here</p>
</div>
</h2>Next Question</h2>
... 
```

和：

```
$(function() {
  $("h2").click(function() {
    $(this).next().toggleClass("highlighted");
  });
}); 
```

但话虽如此，没有它是可以解决的。

```
$(function() {
  $("h2").click(function() {
    $(this).nextAll().each(function() {
      if (this.tagName == 'H2') {
        return false; // stop execution
      }
      $(this).toggleClass("highlighted");
    });
  });
}); 
```

不是非常优雅，但它会起作用。

**注意：**这假设问题是同级的。如果不是，它会变得更加复杂。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-14T14:27:04.837

**使用 CSS 样式的DL 列表**不是更有意义吗？

```
<dl class="faq">
    <dt>Question?</dt>
    <dd>
         <p>Answer</p>
         <p>Answer</p>
         <p>Answer</p>
    </dd>
</dl> 
```

然后使用以下方法轻松选择：

```
$('+ dd', this); 
```

这是当前的**dt**选择。

或者只是将每个答案包装在一个 div 中，因为它在语义上也有意义。但是我认为 DL 列表在语义上更有意义。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-14T14:11:37.027

当然！只需做一个while循环。

```
$('h2').click(function() {
    var next = $(this).next();
    while (next.length != 0 && next[0].nodeName == 'P')
    {
        next.toggle();
        next = next.next();
    }
}); 
```

这假设您在 h2 之后只有 p 标签。如果要添加诸如 img 之类的内容，可以在 while 循环中添加更多异常。

或者，如果您不关心 H2 标签之间的内容，您可以检查不等于 H2。

```
$('h2').click(function() {
    var next = $(this).next();
    while (next.length != 0 && next[0].nodeName != 'H2')
    {
        next.toggle();
        next = next.next();
    }
}); 
```

这将隐藏单击 H2 之后的所有内容，直到找到下一个 H2 或您在 dom 中上升一个级别。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T13:39:16.810

也许这并不能真正回答您的问题，但您可以将每个常见问题解答项目（即每个问题/答案对）包装在一个`DIV`元素中。这在语义上是有意义的，维护页面的非程序员只需复制一个完整的`DIV`（不需要类）。

HTML：

```
<div id="faq">
 <!-- start FAQ item -->
 <div>
  <h2>Question goes here</h2>
  <p>Answer goes here.</p>
  <p>And here.</p>
  <ul>
   <li>Really, use any HTML element you want here.</li>
   <li>It will work.</li>
  </ul>
 </div>
 <!-- end FAQ item -->
 <!-- start FAQ item -->
 <div>
  <h2>Second question goes here</h2>
  <p>Answer to question two.</p>
 </div>
 <!-- end FAQ item -->
</div> 
```

JavaScript (jQuery):

```
$('#faq div h2').click(function() {
 $(this).parent().find(':not(h2)').show();
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-27T04:58:15.163

以防万一还有人需要这个答案...这也包括组中的 h2 行。

## 如果我的解决方案适用的示例 html 在这里：

```
<h2> text1 </h2>
<p>asd</p>
<p>asd</p>
<p>asd</p>
<p>asd</p>
<h3>kjdf</h3>
<h2>asdk</h2>
<h3>kjdf</h3>
<p>asd</p>
<p>asd</p>
<p>asd</p>
<p>asd</p>
<h2>aqdsa</h2> 
```

* * *

## 解决方案：

```
jQuery( function ( $ ) {
//defining groups for wrapping them in custom divs

    $('h2').each( function () {
        var grpForDiv= [];          
        var next = $(this).next();  
        grpForDiv.push(this);
        while ( next.length!==0 && next!== undefined && next[0].nodeName !== 'H2')
            {
            grpForDiv.push(next[0]);
            next = next.next();
            }       
        jQuery(grpForDiv).wrapAll('<div class="Group1" />');

    } );
} ); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T16:24:14.073

请注意，选择的答案是一个很好的答案，但我正在考虑做类似的事情，所以我加班加点:)

[我已经把它放到了一个例子中。](http://jsbin.com/ihupe)

给定 HTML：

```
<h2>Question 1</h2> 
<p>Answer 1</p> 
<p>Answer 1</p> 
<p>Answer 1</p> 
<h2>Question 2</h2> 
<p>Answer 2</p> 
<p>Answer 2</p> 
<p>Answer 2</p> 
<h2>Question 3</h2> 
<p>Answer 3</p> 
<p>Answer 3</p> 
<p>Answer 3</p> 
```

执行以下操作，您将得到答案。我*认为*它现在是所有给出的解决方案中最优雅的，但我会非常重视其他人对此的投入。

```
jQuery.fn.nextUntilMatch = function(selector) { 
  var result = [];   
  for(var n=this.next();(n.length && (n.filter(selector).length == 0));n=n.next())  
      result.push(n[0]);   
  return $(result); 
} 

$(function() { 
  $('h2~p').hide(); 
  $('h2').click(function() { 
    $(this).nextUntilMatch(':not(p)').toggle(); 
  }) 
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T17:26:45.887

您也可以在不编辑 HTML 的情况下执行此操作。这是我刚刚为这个特定目的编写的一个插件：

```
(function($){
    $.fn.nextUntill = function(expr){
        var helpFunction = function($obj, expr){
            var $siblings = $obj.nextAll();
            var end = $siblings.index( $siblings.filter(expr) );
            if(end===-1) return $([]);
            return $siblings.slice(0, end);
        }
        var retObject = new Array();
        this.each(function(){
            $.merge(retObject, helpFunction($(this), expr));
        });
        return $(retObject);
    }
})(jQuery); 
```

你可以像这样使用它：

```
 $('h2').click(function(){
    $(this).nextUntill('h2').show(); //this will show all P tags between the clicked h2 and the next h2 assuiming the p and h2 tags are siblings
 }); 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-05-14T14:23:56.140

我不认为您解决问题的策略是正确的，您有 6 个答案可以部分解决您的问题.....

但是你最大的问题是你说你不能相信维护者使用 divs/spans/classes 等。

我认为您应该做的是为他们简化流程，并培训他们使用您的方法，否则它将***不起作用***。

添加一些您自己的简单标记并为他们解释。

```
[Q] What happens when you click this link?[/Q]
[A] This marvellous answer appears [/A] 
```

（jQuery 不会修复 'user' 错误）

# open-source - 分叉项目时新的许可文本应该包括什么？

> ID：863362
> 
> 赞同：1
> 
> 时间：2009-05-14T13:31:07.250
> 
> 标签：open-source, licensing, fork

分叉项目时，新项目对许可文本的责任是什么？具体来说，BSD 许可证（许可许可证）包括以下文本：

> 源代码的再分发必须保留上述版权声明、此条件列表和以下免责声明。

所以如果我正在制作同一个项目的新版本，我是否需要继续包含旧的通知文件？像这样简单地将新版权附加到旧版权就足够了吗？

> 版权所有 (c) 1999-2006 [旧项目], 2009 [新项目]

如果我要转换许可证（例如，转换为 GPL），我还需要包含旧的许可证文本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:44:40.697

首先，您不能切换许可证。您可以根据 GPL 或专有许可证发布现代 BSD 许可代码，但这并不能让您摆脱 BSD 许可证的任何限制。两种许可证都适用。

因此，您需要保留版权声明、条件和免责声明。确保这不会与您使用的任何 GPL 版本冲突，因为它们可能会对传递的要求产生一些粘性。

# xml - solr 是否在空字符串上进行刻面？

> ID：863365
> 
> 赞同：0
> 
> 时间：2009-05-14T13:31:29.683
> 
> 标签：xml, indexing, lucene, solr

上次我做一个 solr 索引时，它也开始索引并在空字符串上进行分面。这从未发生过。这是正确的行为吗？我应该过滤 DIH 中的空字符串吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-12T00:26:43.180

是的，我建议在您的数据导入处理程序中将它们过滤掉（将它们设置为 NULL），以减少生成可能较大的方面计数所需的加载时间。当可选值在数据集中表示为空字符串时，这可能会定期出现。

# internet-explorer - 使用 Run As 运行多个 IE 8 实例似乎不起作用

> ID：863369
> 
> 赞同：2
> 
> 时间：2009-05-14T13:32:32.427
> 
> 标签：internet-explorer, internet-explorer-8, runas

过去，如果在辅助帐户上使用 IE 进行测试，我会使用 runas 命令行启动另一个实例，因为我们的内部 Web 应用程序使用 Windows 身份验证来识别用户。如果 IE8 使用新的多进程模型，这似乎不起作用。有没有人看到它的解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-12T01:01:40.427

有关会话合并的信息，请参见：http: [//blogs.msdn.com/ie/archive/2009/05/06/session-cookies-sessionstorage-and-ie8.aspx](http://blogs.msdn.com/ie/archive/2009/05/06/session-cookies-sessionstorage-and-ie8.aspx)。

顺便说一句：RunAs 目前在 XP 上被 IE8 破坏，但在 Vista 上工作。IE 团队已意识到/正在调查此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T01:15:04.873

尝试使用“InPrivate”会话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T12:29:49.600

添加一些有趣的细节：查看事件查看器安全日志，它显示为 IE 创建了一个新进程，但立即退出。这会让我相信 IE 正在内部检查某些东西以查看是否已经有 iexplore.exe 进程的运行实例，并自行关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-21T15:53:03.090

当这种情况发生时我讨厌它，但它现在似乎正在工作。我检查了我的机器上安装了哪些 IE8 更新，唯一的一个是[MS09-034](http://support.microsoft.com/?kbid=972260)。我在 XP 上没有看到对 RunAs 的任何引用，但它现在可以工作了。哼。哦，好吧......很高兴它是“固定的”。

# asp.net-mvc - 创建仅在操作具有特定操作过滤器时应用路由的路由约束

> ID：863370
> 
> 赞同：0
> 
> 时间：2009-05-14T13:32:33.627
> 
> 标签：asp.net-mvc, routes

我有一个关于各种控制器的操作列表，这些控制器是“管理”功能（创建、更新、删除），但在这些相同的控制器上的其他操作不是管理员操作。

我想要做的是创建一个路由，该路由将`/Admin/`在所有调用具有`Authorize`过滤器属性的操作的 url 之前添加前缀。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T13:49:30.637

是的，一切皆有可能，但我认为你的意思是容易做到吗？答案是否定的。您要做的是创建自己的路由，然后将此自定义路由添加到路由映射中。这并不难做到，但问题在于路由在控制器之前初始化，因此您必须自己处理查找和反射以检查您的标准。

还有一个替代选项，您可以尝试使用 ActionMethodSelectorAttribute ，它允许您为您的操作方法创建自定义选择器并忽略不包含 Authorize 属性的选择器。使用此属性的一个示例是 ActionVerbAttribute。

到目前为止，最简单的方法是为 Html.ActionLink 创建一个自定义扩展，该扩展进行自己的检查并将其保留为仅显示的内容，然后在 Global.asax 中为同一控制器创建双路由。

# .net - 单击后停止双击

> ID：863371
> 
> 赞同：2
> 
> 时间：2009-05-14T13:32:39.493
> 
> 标签：.net, wpf, double-click

我在 WPF 中开发了一个应用程序，单击一个项目会将视图更改为其他内容。问题是如果用户双击该项目，第一个事件将是单击打开另一个视图，下一个事件将是双击新视图。双击新视图将导致其他事情发生。所以，问题是；在我将单击事件添加到我的第一个视图后，我可以停止双击吗？我试图在单击方法中的 MouseButtonEventArgs 上设置 Handled = true 但这不起作用。另一个视图仍然会双击，随机的事情仍然会发生。我的问题有什么聪明的解决方案吗？

/丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:45:04.330

[RaymondChen](http://blogs.msdn.com/oldnewthing/archive/2009/04/30/9577283.aspx)再次成为宝贵的资源。

我建议您阅读链接的[半秒延迟文章](http://blogs.msdn.com/oldnewthing/archive/2004/10/15/242761.aspx)以获取更详细的信息，但该文章显示了延迟如何向用户显示。

# format - 电子名片重复有什么问题？

> ID：863373
> 
> 赞同：0
> 
> 时间：2009-05-14T13:32:40.710
> 
> 标签：format, vcf-vcard, duplication

我见过的任何软件都不能在 Outlook 和我的单元格之间同步联系人而不创建**重复项**。人们会认为有人在考虑格式时会考虑同步。程序员不可能解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-24T15:27:24.377

我在使用原生诺基亚和三星软件（以及一个我现在不记得的免费诺基亚程序）时遇到了同样的问题，而且我发现它们都没有处理重复项。要围绕它进行编程，您可以复制一种方式，刷新源设备，然后再次复制回来，或者您可以复制，删除重复项，然后再复制回来。

# c# - 具有 Nullable 值的 SqlParameter 在 ExecuteNonQuery 时给出错误？

> ID：863374
> 
> 赞同：22
> 
> 时间：2009-05-14T13:32:54.623
> 
> 标签：c#, .net, sql-server, nullable

我有一个 sql 查询，它的参数在数据库（Sql Server）中可以为空。更新方法工作正常，直到该用户在字段中输入一个空白，这会为 DataTime 对象生成一个空值（该对象可以为空）。问题是当`dbCommand.ExecuteNonQuery();`.

这是我为该字段构建参数的方式：

```
 IDataParameter dbParam_au_id = new SqlParameter();
    dbParam_au_id.ParameterName = "@birthday";
    dbParam_au_id.Value = birthday;
    dbParam_au_id.DbType = DbType.DateTime;
    dbCommand.Parameters.Add(dbParam_au_id); 
```

我尝试将生日的空值转换为 DBNull.Value ：

```
 IDataParameter dbParam_au_id = new SqlParameter();
    dbParam_au_id.ParameterName = "@birthday";
    dbParam_au_id.Value = birthday??DBNull.Value;
    dbParam_au_id.DbType = DbType.DateTime;
    dbCommand.Parameters.Add(dbParam_au_id); 
```

但是这段代码不会编译，我得到错误：

> 错误 1 ​​运算符 '??' 不能应用于“System.DateTime？”类型的操作数？和'System.DBNull'

任何的想法？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-05-14T13:35:10.080

类型不兼容。尝试这样的事情：

```
dbParam_au_id.Value = (object)birthday ?? DBNull.Value; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-09-14T22:28:24.057

If the SqlParameter class was written correctly the first time... a C# null value would be handled as DBNull.Value. That would be intuitive, so OF COURSE setting an SqlParameter value to null is functionally equivalent to removing it from the SqlParameterCollection.

To correct this ridiculous API design error, create your own AddParameter method (with overloads), which takes a SqlParameterCollection, a String (parameter name), and an Object (parameter value).

```
#region Add by Name/Value.
/// <summary>
/// Adds an input parameter with a name and value.  Automatically handles conversion of null object values to DBNull.Value.
/// </summary>
/// <param name="parameters">SqlParameterCollection from an SqlCommand instance.</param>
/// <param name="name">The name of the parameter to add.</param>
/// <param name="value">The value of the parameter to add.</param>
private static void AddParameter( SqlParameterCollection parameters, string name, object value )
{
    parameters.Add( new SqlParameter( name, value ?? DBNull.Value ) );
}

/// <summary>
/// Adds a parameter with a name and value.  You specify the input/output direction.  Automatically handles conversion of null object values to DBNull.Value.
/// </summary>
/// <param name="parameters">SqlParameterCollection from an SqlCommand instance.</param>
/// <param name="name">The name of the parameter to add.</param>
/// <param name="value">The value of the parameter to add.  If null, this is automatically converted to DBNull.Value.</param>
/// <param name="direction">The ParameterDirection of the parameter to add (input, output, input/output, or return value).</param>
private static void AddParameter( SqlParameterCollection parameters, string name, object value, ParameterDirection direction )
{
    SqlParameter parameter = new SqlParameter( name, value ?? DBNull.Value );
    parameter.Direction = direction;
    parameters.Add( parameter );
}
#endregion

#region Add by Name, Type, and Value.
/// <summary>
/// Adds an input parameter with a name, type, and value.  Automatically handles conversion of null object values to DBNull.Value.
/// </summary>
/// <param name="parameters">SqlParameterCollection from an SqlCommand instance.</param>
/// <param name="name">The name of the parameter to add.</param>
/// <param name="type">Specifies the SqlDbType of the parameter.</param>
/// <param name="value">The value of the parameter to add.  If null, this is automatically converted to DBNull.Value.</param>
private static void AddParameter( SqlParameterCollection parameters, string name, SqlDbType type, object value )
{
    AddParameter( parameters, name, type, 0, value ?? DBNull.Value, ParameterDirection.Input );
}

/// <summary>
/// Adds a parameter with a name, type, and value.  You specify the input/output direction.  Automatically handles conversion of null object values to DBNull.Value.
/// </summary>
/// <param name="parameters">SqlParameterCollection from an SqlCommand instance.</param>
/// <param name="name">The name of the parameter to add.</param>
/// <param name="type">Specifies the SqlDbType of the parameter.</param>
/// <param name="value">The value of the parameter to add.  If null, this is automatically converted to DBNull.Value.</param>
/// <param name="direction">The ParameterDirection of the parameter to add (input, output, input/output, or return value).</param>
private static void AddParameter( SqlParameterCollection parameters, string name, SqlDbType type, object value, ParameterDirection direction )
{
    AddParameter( parameters, name, type, 0, value ?? DBNull.Value, direction );
}
#endregion

#region Add by Name, Type, Size, and Value.
/// <summary>
/// Adds an input parameter with a name, type, size, and value.  Automatically handles conversion of null object values to DBNull.Value.
/// </summary>
/// <param name="parameters">SqlParameterCollection from an SqlCommand instance.</param>
/// <param name="name">The name of the parameter to add.</param>
/// <param name="type">Specifies the SqlDbType of the parameter.</param>
/// <param name="size">Specifies the size of the parameter for parameter types of variable size.  Set to zero to use the default size.</param>
/// <param name="value">The value of the parameter to add.  If null, this is automatically converted to DBNull.Value.</param>
private static void AddParameter( SqlParameterCollection parameters, string name, SqlDbType type, int size, object value )
{
    AddParameter( parameters, name, type, size, value ?? DBNull.Value, ParameterDirection.Input );
}

/// <summary>
/// Adds a parameter with a name, type, size, and value.  You specify the input/output direction.  Automatically handles conversion of null object values to DBNull.Value.
/// </summary>
/// <param name="parameters">SqlParameterCollection from an SqlCommand instance.</param>
/// <param name="name">The name of the parameter to add.</param>
/// <param name="type">Specifies the SqlDbType of the parameter.</param>
/// <param name="size">Specifies the size of the parameter for parameter types of variable size.  Set to zero to use the default size.</param>
/// <param name="value">The value of the parameter to add.  If null, this is automatically converted to DBNull.Value.</param>
/// <param name="direction">The ParameterDirection of the parameter to add (input, output, input/output, or return value).</param>
private static void AddParameter( SqlParameterCollection parameters, string name, SqlDbType type, int size, object value, ParameterDirection direction )
{
    SqlParameter parameter;
    if (size < 1)
        parameter = new SqlParameter( name, type );
    else
        parameter = new SqlParameter( name, type, size );
    parameter.Value = value ?? DBNull.Value;
    parameter.Direction = direction;
    parameters.Add( parameter );
}
#endregion 
```

As you can see, inside that method (and overloads), where the value is already typed as an object, I use the "value ?? DBNull.Value" statement to enforce the null = DBNull.Value rule.

Now, when you pass null object references or nullable types with no values to your AddParameter method, you get the expected, intuitive behavior, where a DBNull.Value is passed to the query.

I can't imagine why the API was implemented as it is, because if I wanted a parameter to be ignored, I would not ADD it and then SET it's value to null. I would either NOT add it in the first place, or I would REMOVE it from the SqlParameterCollection. If I ADD a parameter, and SET it's value (even if set to null), I expect it to be USED in the query, I expect null to mean null value.

I've heard they didn't implement it the "correct" way for performance reasons, but that's ridiculous, as demonstrated, because calling SqlParameterCollection.AddWithValue method converts everything to an object anyway, and converting a Nullable instance with no value to a null object is an intrinsic part of the C# language which is not a performance hit at all. Microsoft should really fix this.

# asp.net - 无法获取项目引用的依赖项

> ID：863379
> 
> 赞同：32
> 
> 时间：2009-05-14T13:35:05.523
> 
> 标签：asp.net, tfs, msbuild, tfsbuild

我有一个带有网站项目和 C# 库的 C# 解决方案。编译解决方案时，网站给出消息：

无法获取项目引用“MyLibrary”的依赖项。

这不会停止 wbsite 的编译和运行，直到我尝试使用 TFS 构建构建它，当此错误消息使构建失败时。

这是什么意思，我怎样才能绕过它？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2010-03-16T19:24:18.640

在尝试了很多事情之后，我意识到了一些事情。无论我做了什么来清除构建等，错误都不会消失。我关闭并重新打开解决方案，它就消失了。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-17T15:40:39.727

当您收到错误消息“无法获取项目引用的依赖项”时，可能的原因之一可能是您在解决方案中引用了另一个项目，该项目的目标框架与引用项目的目标框架不兼容。

您可以通过转到项目属性并选择左侧的应用程序选项卡来查看为项目指定的目标框架。

我写这篇文章是因为它发生在我身上，我从一个目标框架 3.5 的项目中引用了一个目标框架 4.0 的项目。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-14T13:39:49.053

在记事本中打开网站项目文件并检查参考等...可以提供帮助

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-11T17:35:31.527

在我的例子中，被引用的项目是在 VS 2010 上创建的，而被引用的项目是 VS 2008 解决方案。在这种情况下，只需使用记事本编辑 vs 2010 项目，并将 ToolsVersion="4.0" 更改为 ToolsVersion="3.5"

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T14:06:39.817

查看您的参考资料。确保您拥有正确的 MyLibrary 项目参考路径。

我会尝试删除它并添加它。然后我会选择重建解决方案而不是构建，因为重建会删除所有 .dll 并重建它们。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-22T19:51:14.040

如果通过“TFS 构建”表示您正在使用单独的构建服务器，那么您可以尝试检查构建服务器正在使用的构建配置。

例如，当您在本地计算机上构建时，您的目标可能是调试配置，而构建服务器使用的是发布配置。

![配置管理器](https://i.stack.imgur.com/H4rXz.png)

在每个构建配置中，您可以确保选择“MyLibrary”项目进行构建。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-01T15:18:31.057

这是 VS SDK 中的一个官方错误：

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=276380](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=276380)

> 我打开了这个，在那里我可以看到以下内容： Von Microsoft am09.05.2007 um 19:05 bereitgestellt
> 
> 感谢您的反馈意见。我们已经在 Visual Studio 2005 SP1 上重现了这个错误，并且我们正在将此错误发送给 VisualStudio 产品团队中的适当小组，以进行分类和解决。
> 
> 谢谢你，Visual Studio 产品团队。
> 
> 我认为网站项目仍然存在这个错误，是的；我们使用 VS 20102 Ultimate。我的虚拟目录下的 \APP_CODE 中有一个应用程序，我有 2 个源代码为 C# 的 DLL，我有 3 个 DLL，其中源代码是来自 RemObjects 的 Oxygene、OXygene (PASCAL)。我只看到用 PASCAL 编写的 DLL 的这个参考；但是当我从测试应用程序测试这 3 个 DLL 时，一切都很好，我的测试应用程序绝对没有问题引用这 3 个 DLL 中的任何类或变量。那么在 VS 输出窗口中导致以下错误字符串的编译/构建可能有什么区别。正如多次描述的那样，永远不会消失的错误。
> 
> 无法获取项目引用“工具箱”的依赖项无法获取项目引用“IMPLEM”的依赖项无法获取项目引用“LEGACY”的依赖项验证网站

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-01T18:55:07.677

如果您在清理和重建解决方案之后一直遇到这个问题，那么这意味着任何引用的项目都有问题。在编译过程中检查输出窗口是否有任何警告。纠正警告，它可以帮助您成功编译。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-19T15:06:44.487

“清洁解决方案”无能为力，有时您需要从网站项目（Bin 文件夹）中手动删除 DLL。删除 DLL 并再次构建解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-09T11:01:40.463

在我的情况下，我在解决方案中删除了 .NET 4.6 更新的程序集，其中一个项目恰好设置为 .NET 4.5，要么降级程序集，要么将项目升级到 4.6 修复它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-01-07T09:26:52.270

我刚刚删除了网站项目并将其再次添加到解决方案中。但是，我注意到它`packages.config`是随后创建的。此配置文件以前不存在。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-02-16T10:36:52.333

**无法获取项目引用“X”的依赖项**

出现此错误的原因有很多，并且 VisualStudio 错误窗口中显示的错误消息不准确。因此混乱。

**一般原因：**项目“X”引用：项目 X 引用的项目/DLL 之一不工作或不兼容。

故障排除提示

1.  首先重建项目 X 并在输出窗口中观察我们的“错误”。确保满足所有依赖项并且构建输出日志中没有错误。
2.  如果有任何项目依赖项，请确保构建输出路径匹配。如果没有，请正确删除和添加。
3.  在任何项目依赖项的情况下架构不匹配。确保您对所有引用的项目都具有相似/兼容的构建配置。
4.  尝试分析在记事本中打开的 csproj 文件，如果上述所有步骤都正常并且错误仍然相同，这可能会有所帮助。所以它可能是 VisualStudio 的问题。
5.  以上都失败了，并且你已经升级了框架或更改了很多 dll 引用，那么最好关闭并重新打开 Visual Studio 并重试。

希望这有助于节省开发时间。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2010-10-22T19:10:19.973

尝试检查项目的配置。我注意到将其更改为“任何 CPU”都可以。

# subsonic - 在 SubSonic 中保存相关对象

> ID：863385
> 
> 赞同：0
> 
> 时间：2009-05-14T13:38:08.807
> 
> 标签：subsonic

我有 2 个表，Order 和 OrderItem，它们有一对多的关系。

当我在前端添加新订单时，如何创建关系。例如

```
(Order and OrderItem generated by SubSonic).
Order order = new Order();
//populate order details.

OrderItem item = new OrderItem();
//populate orderItem details. 
```

然后我如何设置关系，以便当我将它们保存到数据库时，它们将存储正确的外键值，类似于

```
item.setParent(order); 
```

编辑：

我尝试使用

```
order.OrderItemRecords().Add(item); 
```

但是当我更新数据库时仍然出错。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T15:26:43.977

```
(Order and OrderItem generated by SubSonic).
Order order = new Order();
//populate order details.

OrderItem item = new OrderItem();
//populate orderItem details.

item.Order = order;   //THIS LINE SETS THE PARENT OBJECT TO ABOVE ORDER 
```

只需记住结束事务并调用 save 方法将此信息提交到您的数据库。您将在项目中添加对 System.Transactions 命名空间的引用，然后在您的类中引用。

例如

```
 using (TransactionScope scope = new TransactionScope())
    {
        try
        {
            Order order = new Order();
            //populate order details.
            order.Save(); //Commit to DB

            OrderItem item = new OrderItem();
            //populate orderItem details.

            item.Order = order;   //THIS LINE SETS THE PARENT OBJECT TO ABOVE ORDER

            item.Save();  //Commit to DB

            //complete you transaction
            scope.Complete();

        }
        catch (System.Data.SqlClient.SqlException ex)
        {
            throw ex;
        }
    } 
```

# flash - 无法让 Flash 中的 ExternalInterface 工作

> ID：863386
> 
> 赞同：1
> 
> 时间：2009-05-14T13:38:13.427
> 
> 标签：flash, actionscript, externalinterface

非常新的闪存。我正在使用 XSPF 音乐播放器（在这里找到的苗条版本 ( [http://musicplayer.sourceforge.net/](http://musicplayer.sourceforge.net/) )，用 AS2 编写）来播放网站上的 mp3 列表。每次加载曲目时我都需要进行 javascript 调用。我试图通过 ExternalInterface 来做到这一点，但到目前为止还没有运气。这是我的设置：我正在一台 linux 机器上编写站点，该机器也装有测试服务器，但在 windows 中编辑 flash。我正在使用 firefox 3.0.10 在同一个 linux 机器上测试该站点。html 和 actionscript 发布在这里（[http://pastebin.com/f36b1da0e](http://pastebin.com/f36b1da0e)）。有人看到我的代码有什么问题吗？关于为什么它不起作用的任何想法？我觉得这是我的基本设置中的东西......

谢谢，丹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T08:14:09.857

我快速浏览了您的代码，看起来还可以（无论如何都是动作脚本）。我要说的是尝试嵌入 swf 的不同方法。很久以前（所以我不记得所有细节了），但我正在用不同的浏览器测试外部接口，有时它可以在 IE 中工作，但不能在 Firefox 中工作，如果我尝试嵌入 swf 的不同方法，它会工作在firefox 但不是 IE 或只是 IE 6 而不是 7！

这很烦人。无论如何，我发现当时在两个主要浏览器中都有效的唯一方法（chrome 已经过时）是使用发布应用程序时从 flexbuilder 创建的 HTML。当然，我确实必须对其进行一些修改（因为我们使用 cocoon 和 xsl），但它确实有效。

（从那以后我认为[swfobject](http://code.google.com/p/swfobject/)已经改进了，如果我是你，我也可以试试）

[我已经在http://pastebin.com/f79b5b3f3](http://pastebin.com/f79b5b3f3)上发布了来自 flexbuilder 的 HTML 模板它需要 AC_OETags.js 文件 ( [http://pastebin.com/f3937a336](http://pastebin.com/f3937a336) ) 和 playerProductInstall.swf (您可能需要下载 flexbuilder得到这个）。

* * *

下面的评论代码

```
<mx:HTTPService id="mySerivceCall" 
    url="{'myPHPFile.php'}"
    result="resultHandler(event)" 
    fault="faulthandler(event)"
    showBusyCursor="false" 
    resultFormat="e4x"> 
    <mx:request>
        <time>{new Date().getTime()}</time>
    </mx:request>
</mx:HTTPService> 
```

我总是将时间添加到 httpservice，确保它不会被缓存（IE 非常不擅长）。只需将任何其他参数粘贴到请求部分，结果格式只会告诉 flex 结果是 e4x 格式的 XML，这使得处理 XML 非常简单。

# oracle - 以编程方式为 Oracle 数据库创建 DSN 时，如何可靠地告知驱动程序名称？

> ID：863390
> 
> 赞同：1
> 
> 时间：2009-05-14T13:40:01.720
> 
> 标签：oracle, winapi, odbc, dsn

我有一个通过 DSN 连接到 Oracle 数据库的应用程序。如果最初的连接尝试失败，那么我确保他们的 DSN 存在。如果它不存在，那么我使用[SQLConfigDataSource](http://msdn.microsoft.com/en-us/library/aa177860(sql.80).aspx)命令创建它。

该命令需要驱动程序名称作为其参数之一。在我的机器上，我有 11g 驱动程序，所以以下工作：

```
const
  cDriver = 'Oracle in OraDb11g_home1' + #0;
var
  strAttr: string;
begin
  strAttr := 'DSN=' + DSNName + #0 +
             'SERVER=' + TNSName + #0;
  SQLConfigDataSource(0,ODBC_ADD_SYS_DSN,PChar(cDriver),PChar(strAttr));
end; 
```

但是客户端机器可能有不同版本的 Oracle，或者他们的 oracle home 的不同名称。如何判断在任意机器上使用哪个驱动程序？

我正在使用 Delphi，但这并不重要，因为无论如何这只是一个 API 调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:37:49.433

我最终使用了注册表中的列表，如下所示：

```
function TDSNManager.GetOracleDriverName: string;
var
  reg : TRegistry;
  drivers: TStringList;
  i: integer;
begin
  drivers := TStringList.Create;
  reg := nil;
  try
    reg := TRegistry.Create;
    reg.RootKey := HKEY_LOCAL_MACHINE;
    if reg.OpenKey('SOFTWARE\ODBC\ODBCINST.INI',False) then begin
      reg.GetKeyNames(drivers);
    end;
  finally
    FreeAndNil(reg);
  end;  //try-finally

  for i := 0 to drivers.Count - 1 do begin
    if 0 < Pos('ORACLE IN',Uppercase(drivers[i])) then begin
      Result := drivers[i];
      Break;
    end;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:14:52.727

您可以尝试深入研究[SQLDrivers](http://msdn.microsoft.com/en-us/library/ms712400.aspx)调用，以了解如何在您所在的系统上获取已安装的驱动程序。

# asp.net - 在 javascript 中停止回发

> ID：863393
> 
> 赞同：4
> 
> 时间：2009-05-14T13:40:28.240
> 
> 标签：asp.net, javascript, postback, thickbox

我有一个带有 JQuery 厚框的 ASP 网络表单，我有一个图像，当用户单击时会打开厚框。

一旦打开thickbox，它就会向我显示一个包含几行的网格和一个选择一个的按钮，在用户选择记录后它返回到主页面记录选择并导致__doPostBack()

但！有时在 IE6 中它会一直加载回发并且永远不会结束我必须刷新页面，当它刷新时它显示一切正常。但我不希望回发保持加载并且它并不总是发生。

我必须调用 __doPostBack 因为我需要查找与所选记录相关的信息。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-03-18T19:21:09.167

我是怎么做的；我是如何做到的：

```
<asp:LinkButton ID="linkKB" OnClientClick="absolutizeWidth(); return false;"  runat="server">Columns too small?</asp:LinkButton> 
```

javascript函数执行后，“return false”停止服务器控件的回发。很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-06T01:21:05.813

您是在刷新页面后还是在厚箱返回后尝试停止发帖？

如果您不想在用户触发事件时执行回发，则可以在该偶数处理程序中返回 false。

例如，在页面加载期间停止回发的正常方法是这样的：

```
onClick="if(SOMECONDITION != true) { return false; }" 
```

这将阻止回发被解雇。

如果回发已经在进行中并且您想尝试中止它（我认为这是您所要求的），您将需要“停止”页面加载（因为这就是 javascript 正在做的事情）。也许试试这个：

即：window.document.execCommand('Stop'); 其他（Mozilla 等）：window.stop();

我有一段时间没有尝试过这个（而且它不在我的脑海中），所以代码可能需要一些按摩。

如果我完全错过了你的问题，我很抱歉，也许你可以澄清一下？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T13:49:24.570

要在 javascript 中停止回发，请编写“return false;” 陈述。

但我想我只是不明白你的问题，或者你问得太不清楚了。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T14:35:26.503

嗯，让我试试..（我不会说英语，也不知道正确的词来解释我想要但我想尝试：P）

我调用了一个 javascript __doPostBack 但响应并停留在加载中需要太多时间......我想停止回发，类似于 response.end 但在 javascript 中。

如果我的脚本执行时间过多，请调用 StopPostBack 或其他东西..

谢谢。

# c# - 将时间戳添加到 Trace.WriteLine()

> ID：863394
> 
> 赞同：28
> 
> 时间：2009-05-14T13:41:04.213
> 
> 标签：c#, debugging, timestamp, trace

在我的 C# .NET 应用程序中，我遇到了 Trace.WriteLine() 方法的问题。我经常使用这种方法，并且每次使用它时都想添加一个时间戳。

代替 Trace.WriteLine(DateTime.Now + "Something wrong!")，是否有默认 DateTime 的解决方案？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-05-15T06:55:12.810

# 通过代码

您可以配置 TraceOutputOptions 标志枚举。

```
var listener = new ConsoleTraceListener() { TraceOutputOptions = TraceOptions.Timestamp | TraceOptions.Callstack };
Trace.Listeners.Add(listener);

Trace.TraceInformation("hello world"); 
```

这不适用于 Write 和 WriteLine，您使用了 TraceXXX 方法。

# 通过 app.config

这也可以在您的 App.config 中配置，具有一定的等效性并使用 TraceSource：

```
<configuration>
  <system.diagnostics>
    <trace autoflush="true">
      <sources>
        <source name="TraceSourceApp">
          <listeners>
            <add name="myListener" type="System.Diagnostics.ConsoleTraceListener" traceOutputOptions="Timestamp" />
          </listeners>
        </source>
      </sources>
    </trace>
  </system.diagnostics>
</configuration> 
```

在代码中，您可以：

```
private static TraceSource mySource =   
        new TraceSource("TraceSourceApp");
static void Main(string[] args)
{
  mySource.TraceInformation("hello world");
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-09-01T23:47:58.427

您可以`app.config`使用`traceOutputOptions`

```
traceOutputOptions = "DateTime, Timestamp"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T13:45:47.730

只需编写您自己的 " `TraceLine(string msg)`" 方法并开始调用它：

```
void TraceLine(string msg, bool OmitDate)
{
    if (!OmitDate)
        msg = DateTime.Now + " " + msg;
    Trace.WriteLine(msg);
}

void TraceLine(string msg) {TraceLine(msg, false);} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T13:44:09.933

您可以编写一个包装方法来做到这一点：

```
public static void DoTrace(string message)
{
    DoTrace(message,true);
}

public static void DoTrace(string message, bool includeDate)
{
    if (includeDate) {
        Trace.WriteLine(DateTime.Now + ": " + message);
    } else {
        Trace.WriteLine(message);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T13:47:15.527

我们使用 log4net TraceAppender，您可以在其中轻松配置布局或过滤。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-27T13:21:41.383

您可以编写自己的，如此[处](https://stackoverflow.com/q/1171670/806690 "Formatting trace output")`TextWriterTraceListener`所述。

# hardware - 计算机科学中的硬件知识？

> ID：863395
> 
> 赞同：4
> 
> 时间：2009-05-14T13:41:23.293
> 
> 标签：hardware, computer-science

作为一名计算机科学专业的学生，​​要完全理解“操作系统”和“计算机体系结构”课程需要多少硬件知识？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T13:54:45.523

在最基本的层面上，您应该了解[冯诺依曼架构](http://en.wikipedia.org/wiki/Von_Neumann_architecture)以及它如何映射到现实生活中的计算机。在此之上，越多越好。不仅仅是操作系统——在垃圾收集和虚拟机语言中，堆、堆栈和指令是如何工作和执行的，所以你知道什么会表现不好以及如何改进它以充分利用架构。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T13:49:14.710

在那个层面上，你知道的越多越好，但最基本的需求是计算机体系结构的布尔逻辑设计。了解如何从基本逻辑单元（和、或、时钟）设计寄存器、加法器、多路复用器、触发器等。您大概可以从对 ASM、内存映射 IO 和中断的基本了解开始了解操作系统。

编辑：我不确定你所说的“硬件”是什么意思，你认为逻辑设计是硬件吗？或者你说的是晶体管？我想了解半导体的基础知识不会有什么坏处，但是架构是在真正的硬件级别之上抽象的。我还要说操作系统是在架构之上抽象的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T13:51:59.493

“计算机科学与计算机无关，就像天文学与望远镜无关一样。”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T13:57:28.137

当您尝试针对目标硬件进行优化时，它会有所帮助。以硬盘驱动器为例，它有助于编写利用局部性来最小化寻道时间的软件。如果您只是将硬盘驱动器视为“它可以工作”，并将文件和数据粘贴到各处，您将遇到严重的碎片问题并导致性能下降。

在设计操作系统时会考虑很多这方面的因素，因为您正在尝试最大限度地提高性能。所以简而言之，学习一些关于它的东西会有所帮助，而且肯定不会有任何伤害。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T14:21:51.683

两个想法：

首先，一切都是并行的。多线程是一回事，多核是另一回事。围绕缓存、内存架构、资源分配等存在大量问题。其中许多问题都是为您“处理”的，但您对金属了解得越多越好。

其次，硬件中的数字表示。这与计算机科学本身一样古老，但它仍然让每个人都感到困惑。不知道是谁这么说的，但它是完美的：“将无限的数字映射到有限的比特数涉及近似值。” 理解这一点和一般的数值分析将一次又一次地节省你的培根。序列化和字节序等。

此外，它很有趣！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T13:55:39.453

确定 Comp Sci 研究通常所需的硬件知识的基线知识集的一个好方法是访问各种著名大学的课程网站。对我来说，我会查看麻省理工学院、斯坦福大学、伊利诺伊大学厄巴纳/香槟分校 (UIUC)、佐治亚理工学院等的 Comp Sci 课程。然后我会从中得到一个平均的理解。

此外，您还可以亲自致电您正在就读或申请的大学的指导顾问，以获得对您需求的个性化视图。他们将根据您的愿望为您提供指导。教授更甚。他们出奇地容易接近，并且非常愿意就此类事情提供反馈。

最近，我正在考虑攻读硕士学位。作为 UIUC 的校友，我给那里的几位老教授发了电子邮件，告诉他们我的兴趣。我问了他们几个问题，旨在了解研究生院和他们的观点。他们分享并大多数邀请我打电话和聊天。

就个人而言，我同意@CookieOfFortune。您对计算机内部工作原理的了解越多，您在编写软件时就越能利用它来发挥自己的优势。也就是说，您并不需要真正高度了解电子学的物理学。当然，这很有趣，但你的重点应该放在电路、逻辑等上。其中大部分内容应该在一个好的操作系统课程中介绍，或者至少为你提供跳板，让你自己学习更多。

# jquery - 默认情况下是否可以隐藏 jQuery Grid 中的列？

> ID：863397
> 
> 赞同：2
> 
> 时间：2009-05-14T13:41:44.167
> 
> 标签：jquery, json, jqgrid

过去几天我一直在使用[jQuery Grid ，我还没有找到任何文档的一件事是默认隐藏列的能力。](http://www.trirand.com/blog/)

我想要这个的原因是我正在使用我的对象的每个属性构建我的 JSON，但我的网格可能只将其中的 75% 显示为有效列。我希望能够传回比我实际使用的更多的 JSON，我认为实现这一点的一种方法是隐藏我不使用的列。

欢迎任何其他建议，但我更希望能够下推比默认情况下实际使用的更大的 JSON 列表。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T13:52:05.513

在 colModel 初始化器数组中，您可以指定

```
hidden: true 
```

在任何列上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-21T14:18:00.317

您使用的是什么版本的 flexgrid...？我的不接受 colModel 中的隐藏属性

它确实接受

```
hide: true 
```

# asp.net - ASP.NET 到 SQL Server 2005，UPDATE smalldatetime 过程不起作用？

> ID：863405
> 
> 赞同：2
> 
> 时间：2009-05-14T13:43:10.013
> 
> 标签：asp.net, sql, sql-update, smalldatetime

正如主题所暗示的那样。我正在制作一个小程序，您可以在其中浏览和处理一堆数据。问题是虽然向 SQL 表中插入新行可以正常工作，但使用相同的方法进行更新会导致 smalldatetime 变量出现问题。

我注意到使用分析器 exec 命令在日期上加上双引号，但我似乎无法摆脱它。加上插入时会发生相同的双引号，并且效果很好。该过程中的命令如下所示：

```
执行 spUpdateinfo
@id=默认值，
@job=N'Loadsoftext',
@address=N'Loadsoftext',
@startdate=''2009-02-01 00:00:00:000'',
@enddate=''2009-05-15 00:00:00:000'',
@other=N'加载软文本'

```

我得到的是这个错误：

```
消息 102，第 15 级，状态 1，第 5 行
“2009”附近的语法不正确。

```

我正在做的是在 asp.net 代码隐藏中使用日期并将其作为参数作为普通日期传递，假设它在 SQL 过程中转换为 smalldatetime。使用的方法和变量以及字符串等可以与插入时完全相同，但由于某种原因，UPDATING 会导致问题。我在谷歌搜索时看到了一些 PreserveSingleQuotes() 函数，但在 vb 或 SQL Server 2005 中似乎不存在。

知道是什么原因造成的以及如何使更新正常工作吗？

**编辑：**哦，日期最初是芬兰语格式，即 dd.MM.yyyy。但如前所述，所有这些工作都很好，并且在使用 INSERT 时会自动转换。

**编辑2：**这是整个代码。

Asp.Net (vb)

```
        将 fdate 变暗为日期
        将日期变暗为日期

        fdate = CDate(BegindateTextBox.Text.Trim)
        ldate = CDate(EnddateTextBox.Text.Trim)
        将 ID 调暗为新 SqlParameter("@id", Request.QueryString("job_id"))
        将作业作为新的 SqlParameter("@job", JobTextBox.Text)
        将地址变暗为新 SqlParameter("@address", AddressTextBox.Text)
        Dim Begindate As New SqlParameter("@startdate", fdate)
        将结束日期调暗为新的 SqlParameter("@enddate", ldate)
        将 Otherinfo 作为新的 SqlParameter("@other", OtherinfoTextBox.Text)

        开始日期.DbType = DbType.Date
        结束日期.DbType = DbType.Date

        myCommand = 新 SqlCommand("spUpdateinfo")
        myCommand.CommandType = CommandType.StoredProcedure
        myCommand.Connection = conn
        myCommand.Parameters.Add(ID)
        myCommand.Parameters.Add(作业)
        myCommand.Parameters.Add（地址）
        myCommand.Parameters.Add（开始日期）
        myCommand.Parameters.Add（结束日期）
        myCommand.Parameters.Add（其他信息）

        myCommand.ExecuteNonQuery()

```

SQL 过程

```
    更新作业信息
    设置工作 = @Job，
        地址=@地址，
        Begindate = CAST(@Begindate AS smalldatetime),
        结束日期 = CAST(@Enddate AS smalldatetime),
        其他信息 = @Otherinfo
    哪里 Job_id = @id

```

花了一段时间，因为我不得不编辑敏感词。无论如何，谢谢帮助和任何想法发生了什么？你可以在那里看到演员表等，因为我试图摆弄我能修复的任何东西，但它仍然无法正常工作。

**编辑3：**感谢您的帮助，今天休息，所以明天我会继续看这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T13:46:59.753

尝试这个：

```
exec spUpdateinfo 
@id=default,
@job=N'Loadsoftext',
@address=N'Loadsoftext',
@startdate='2009-02-01 00:00:00:000',
@enddate='2009-05-15 00:00:00:000',
@other=N'Loadsoftext' 
```

创建日期时间字符串时，您应该只需要一个撇号

**编辑**：

Asp.Net (vb)

```
 Dim fdate As Date
    Dim ldate As Date

    fdate = CDate(BegindateTextBox.Text.Trim) 
    ldate = CDate(EnddateTextBox.Text.Trim) 
    //Trim might be screwing it up not sure

    Dim ID As New SqlParameter("@id", Request.QueryString("job_id"))
    Dim Job As New SqlParameter("@job", JobTextBox.Text)
    Dim Address As New SqlParameter("@address", AddressTextBox.Text)
    Dim Begindate As New SqlParameter("@startdate", fdate)
    Dim Enddate As New SqlParameter("@enddate", ldate)
    Dim Otherinfo As New SqlParameter("@other", OtherinfoTextBox.Text)

    Begindate.DbType = DbType.Date // Try removing this
    Enddate.DbType = DbType.Date // Try removing this

    myCommand = New SqlCommand("spUpdateinfo")
    myCommand.CommandType = CommandType.StoredProcedure
    myCommand.Connection = conn
    myCommand.Parameters.Add(ID)
    myCommand.Parameters.Add(Job)
    myCommand.Parameters.Add(Address)
    myCommand.Parameters.Add(Begindate)
    myCommand.Parameters.Add(Enddate)
    myCommand.Parameters.Add(Otherinfo)

    myCommand.ExecuteNonQuery() 
```

SQL 过程

```
UPDATE jobInfo
SET Job = @Job,
    Address= @Address,
    Begindate = CAST(@Begindate AS smalldatetime) //Try removing the cast,
    Enddate = CAST(@Enddate AS smalldatetime) //Try removing the cast,
    Otherinfo = @Otherinfo
WHERE Job_id = @id 
```

这很奇怪，因为您正在做的事情与我经常做的事情非常相似，而且我没有遇到您遇到的问题。我唯一能建议的是删除我突出显示的部分，看看它是否有效。我建议这样做是因为在我通常使用的代码中，它们不是必需的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T13:50:34.753

您如何从 ASP.NET 调用您的存储过程？您是否使用 SqlCommand 对象并通过 Parameters 集合将参数添加到命令中？

通常，您不会使用 Text 命令，但也将类型设置为 StoredProcedure。以下示例使用 5 个参数调用名为“tblAccount_Save”的存储过程：

```
 Dim conn As New SqlConnection("server=myserver;integrated security=sspi;initial catalog=mydb;")
    Dim sql As String = "[dbo].[tblAccount_Save]"
    Dim comm As System.Data.SqlClient.SqlCommand = New SqlCommand(sql, conn)
    comm.CommandType = System.Data.CommandType.StoredProcedure
    comm.Parameters.AddWithValue("@ID", id)
    comm.Parameters.AddWithValue("@AccountNumber", number)
    comm.Parameters.AddWithValue("@ClassID", class)
    comm.Parameters.AddWithValue("@LastName", lastName)
    comm.Parameters.AddWithValue("@FirstName", firstName)
    comm.ExecuteNonQuery() 
```

请提供有关如何从代码隐藏调用存储过程的更多信息。

谢谢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T09:22:27.870

编辑4：好的，让它工作。感谢您的帮助并为麻烦感到抱歉，因为该缺陷从未出现在日期中。@id=default 应该是一个提示。我在链接到编辑页面的部分有错字，我将“job_id”设置为“jb_id”，因此实际数字从未返回。我不敢相信我错过了这个并在这上面花了几个小时......

哦，好吧，如前所述，感谢您的帮助。:D

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T13:49:54.163

我认为它是双引号的事情。探查器可能看起来像它，因为它在一个主 sp_executesql 语句中显示它并且它转义了单引号。但是，您拥有的语句应该是单引号而不是双引号。

# sql - 数据仓库暂存区内的结构

> ID：863407
> 
> 赞同：16
> 
> 时间：2009-05-14T13:43:37.220
> 
> 标签：sql, database-design, data-warehouse

我们正在为一家银行开发一个数据仓库，并且几乎遵循标准的 Kimball 临时表模型、星型模式和 ETL 来通过流程提取数据。

> Kimball 谈到了使用暂存区进行导入、清理、处理和一切操作，直到您准备好将数据放入星型模式。在实践中，这通常意味着将数据从源上传到一组表中，几乎没有修改，然后选择性地通过中间表获取数据，直到它准备好进入星型模式。这对单个实体来说是很多工作，这里没有单一的责任。

我以前工作过的系统对不同的表集进行了区分，达到了以下程度：

*   **上传表**：原始源系统数据，未修改
*   **暂存表**：中间处理、类型化和清理
*   **仓库表**

您可以将它们粘贴在单独的模式中，然后为存档/备份/安全等应用不同的策略。其他人之一曾在一个仓库工作，那里有一个*StagingInput*和一个*StagingOutput*，类似的故事。整个团队在数据仓库和其他方面都有很多经验。

然而，尽管如此，纵观 Kimball 和网络，似乎完全没有关于为暂存数据库提供任何类型的结构的书面文件。如果相信 Kimball 先生会让我们所有人都将分期工作作为这个庞大的深黑色非结构化数据池，那将是可以原谅的。

当然，如果我们想为暂存区添加更多结构，如何去做是很明显的，但似乎没有任何关于它的文章似乎很奇怪。

那么，外面的其他人都在做什么呢？只是上演这么大的非结构化混乱还是人们有一些有趣的设计？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T14:24:35.640

我也遇到过同样的问题。我们有一个大型 HR 数据仓库，我正在从整个企业的系统中提取数据。我收集了很多 Fact 和 Dimension 表，但是暂存区一团糟。我不知道任何设计标准。我会遵循与您相同的路径，并提出一组标准的名称来使事情井井有条。您的建议对于命名非常好。我会继续努力。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-29T19:24:12.107

请注意，Raph Kimball 和 Joe Caserta 有一本书名为“The Data Warehouse ETL Toolkit”，因此 Kimball 先生确实在这方面付出了一些努力。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-03T10:32:52.780

我们目前正在开发一个大型保险 DWH 项目，它有点复杂，但是每个源系统表都被放入 STAGING 数据库中的单独模式中，然后我们有移动/清理/符合（MDM）数据的 ETL从 staging 数据库到 STAGINGCLEAN 数据库，然后进一步 ETL 将数据移动到 Kimball DWH。

我们发现 Staging 和 StagingClean 数据库的分离对于诊断问题非常有帮助，尤其是在数据质量方面，因为我们有脏的暂存数据以及在转换为 DWH 之前的清理版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-28T15:43:33.613

暂存中可以有子区域。例如称为 staging1、staging2。

Staging1 可以直接从数据源中提取，无需转换。而Staging1 只保留最新的数据。

Staging2 保持数据转换并准备好进入仓库。Staging2 保留所有历史数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-13T06:39:19.057

[在这里](http://www.geekinterview.com/question_details/242)看看这篇文章。它很好地概述了 DW 中暂存区的职责。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-18T12:41:57.047

多么棒的问题。

过去，我们使用`_MIRR`（用于镜像）后缀用于登陆数据库的未转换数据，即。它反映了源。然后我们使用`_STG`来自源的转换数据，然后`_DW`是星型模式。

这里的临时表将在`3NF`. 我认为这是关键点。数据未经转换并与下一步完全规范化数据分开，然后将其全部展平到我们的星型模式中以进行报告。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-14T14:18:52.890

就个人而言，我不会去金博尔或其他地方找麻烦。

你在寻找什么样的“结构”？你觉得需要什么样的“结构”？您今天从缺乏“结构”中看到了什么问题？

我可能给你留下的印象是我不怎么看金博尔。不是这样 - 我还没有读过金博尔。除了适应某种模式之外，我只是不考虑无缘无故地改变事情。改变以解决一些现实世界的问题会很好。例如，如果您发现备份暂存表是因为缺乏结构导致暂存表和仓库表被视为相同，那么这将是更改结构的原因。但是，如果这是您的想法，那么您应该编辑您的问题以表明它。

# html - Django 小部件 HTML id

> ID：863414
> 
> 赞同：4
> 
> 时间：2009-05-14T13:45:16.623
> 
> 标签：html, django, widget

在小部件的代码中，我需要访问渲染元素的**HTML** id。我知道我可以在呈现的字符串上运行 regexp 并**获取 ID**，但我相信必须有一个简单的方法。

假设这是我拥有的小部件：

```
class TextInputWithHint(TextInput):
    ...
    def render(self, name, value, attrs):

        res = super(TextInputWithHint, self).render(name, value, attrs = attrs)
        res += mark_safe(u'<script type="text/javascript">alert(%s)</script>' \
        % self.attrs['id'])
        return res 
```

除了那`self.attrs['id']`不起作用。

有没有简单的方法在这里获取ID？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T19:45:56.787

对于您的用例，您可以在传递给`id`的参数中找到属性。在尝试使用它之前检查它的存在是个好主意：`attrs``render()`

```
def render(self, name, value, attrs=None):
  # ...
  if attrs and 'id' in attrs:
    # Use attrs['id'] 
```

# java - 是否可以在不使用 WSDD 的情况下使用 Axis 部署 SOAP 服务器？

> ID：863418
> 
> 赞同：2
> 
> 时间：2009-05-14T13:45:58.320
> 
> 标签：java, web-services, soap, axis

在我正在工作的项目中，我使用部署描述符 (WSDD) 文件部署了一个 SOAP 服务器。为此，将启动一个网络服务器（例如 tomcat、jetty），然后执行以下命令：

java -cp %AXISCLASSPATH% org.apache.axis.client.AdminClient deploy.wsdd

我需要跳过上述命令以避免调用 Axis AdminClient。是否可以将我的 web 服务部署为 war 文件？

[注意：由于其局限性](http://ws.apache.org/axis/java/user-guide.html#JWSJavaWebServiceFilesInstantDeployment)，无法使用带有 JWS 的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-17T02:17:41.113

Stackoverflow 上的其他人已经找到了一种[以编程方式配置 Axis](https://stackoverflow.com/questions/1542776/get-rid-of-client-config-wsdd-in-axis)的方法。这也可能对你有用。

Axis 项目的集成部分中有一些[关于 EngineConfigurationFactory](http://ws.apache.org/axis/java/integration-guide.html#Configuration)的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T20:11:08.060

如果您使用 Maven 构建，则可以使用[maven-wsdd-plugin](http://axis.apache.org/axis/java/maven/wsdd/)。

如果您的 WSDL 没有改变（例如，您只是在修复 Web 服务业务逻辑中的错误，或者您正在构建一个 Web 服务以适应给定的 WSDL），您可以跳过 maven 插件。如问题中所述，只需使用 AdminClient 将 Web 服务部署到开发 servlet 容器即可。这将在开发 servlet 容器的 /{axis_context}/WEB-INF 目录中生成一个 server-config.wsdd。复制该 server-config.wsdd 并将其打包到您的战争的 WEB-INF 目录中。当您将战争部署到不同的位置时，您的 Web 服务应该包含在 Web 服务列表中。

使用 Axis 1.4 和 Tomcat 1.7 测试

# perl - 在 Perl 中计算稀疏数组中的元素

> ID：863426
> 
> 赞同：28
> 
> 时间：2009-05-14T13:47:55.103
> 
> 标签：perl, arrays, count

如何获取数组中的总项目，*而不是*最后一个 id？

我发现的两种方法都不起作用：

```
my @a;
# Add some elements (no consecutive ids)
$a[0]= '1';
$a[5]= '2';
$a[23]= '3';

print $#a, "\n"; # Prints 23
print scalar(@a), "\n"; # Prints 24 
```

我预计会得到3...

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-14T14:03:05.940

**编辑：哈希与数组**

正如 cincodenada 在评论中正确指出的那样，ysth 给出了一个更好的答案：我应该用另一个问题来回答你的问题：“你真的想使用 Perl 数组吗？散列可能更合适。”

数组为所有可能的索引分配内存，直到目前使用的最大索引。在您的示例中，您分配了 24 个单元格（但仅使用 3 个）。相比之下，散列只为那些实际使用的字段分配空间。

**数组解决方案：标量 grep**

以下是两种可能的解决方案（请参阅下面的说明）：

```
print scalar(grep {defined $_} @a), "\n";  # prints 3
print scalar(grep $_, @a), "\n";            # prints 3 
```

说明：添加 后`$a[23]`，您的数组确实包含 24 个元素 --- 但其中大多数是未定义的（也计算为假）。您可以计算已定义元素的数量（如第一个解决方案中所做的那样）或真实元素的数量（第二个解决方案）。

有什么区别？如果您设置`$a[10]=0`，则第一个解决方案将计算它，但第二个解决方案不会（因为 0 为假但已定义）。如果您设置`$a[3]=undef`，则没有任何解决方案会计算它。

**哈希解决方案（by yst）**

正如另一个解决方案所建议的那样，您可以使用哈希并避免所有问题：

```
$a{0}  = 1;
$a{5}  = 2;
$a{23} = 3;
print scalar(keys %a), "\n";  # prints 3 
```

此解决方案计算零和 undef 值。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-14T14:09:14.833

听起来你想要一个[稀疏数组](http://en.wikipedia.org/wiki/Sparse_array)。一个普通数组有 24 个元素，而稀疏数组有 3 个元素。在 Perl 中，我们用散列值模拟稀疏数组：

```
#!/usr/bin/perl

use strict;
use warnings;

my %sparse;

@sparse{0, 5, 23} = (1 .. 3);

print "there are ", scalar keys %sparse, " items in the sparse array\n",
    map { "\t$sparse{$_}\n" } sort { $a <=> $b } keys %sparse; 
```

标量上下文中的`keys`函数将返回稀疏数组中的项目数。使用散列来模拟稀疏数组的唯一缺点是，如果键的顺序很重要，则必须在对其进行迭代之前对其进行排序。

您还必须记住使用该[`delete`](http://perldoc.perl.org/functions/delete.html)函数从稀疏数组中删除项目（仅将它们的值设置为 undef 是不够的）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-14T14:00:11.157

也许你想要一个哈希来代替（或另外）。数组是一组有序的元素；如果你创建，你通过`$foo[23]`隐式创建。`$foo[0]``$foo[22]`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-14T13:53:39.020

```
print scalar grep { defined $_ } @a; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-28T16:03:46.680

```
@people = qw( bob john linda ); 
$n = @people; # The number 3
Print " The number in the list is $n \n"; 
```

Perl 中的表达式总是为其上下文返回适当的值。

例如，数组的“名称” * 怎么样？在列表上下文中，它给出了元素的列表。但在标量上下文中，它返回数组中元素的数量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-19T10:06:23.937

```
sub uniq {
    return keys %{{ map { $_ => 1 } @_ }};
}
my @my_array = ("a","a","b","b","c");
#print join(" ", @my_array), "\n";
my $a = join(" ", uniq(@my_array));
my @b = split(/ /,$a);
my $count = $#b; 
```

# asp.net - 在 Web 上丢失文本输入

> ID：863427
> 
> 赞同：1
> 
> 时间：2009-05-14T13:47:56.350
> 
> 标签：asp.net, user-interface, text

这在你身上发生了多少次？

您正在网页上的表单中输入一长段文本，然后单击下一步或提交或其他任何内容。然后发生错误。所以你点击返回来修复错误，你的整个游戏就消失了！

今天我听到一位同事在骂我们的帮助台软件，因为他输入了一个很长的解决方案并出现错误，丢失了他的文本。

我告诉他这种情况发生在我身上很多次了，如果我发现我打字很多，我会打开记事本把它全部输入那里然后复制它。

所以，我想知道网络开发人员是否可以采取任何措施来防止这种情况发生？我在编程时从未考虑过它，但希望将来注意它。

我们能做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T13:58:10.553

有两种关键的做事方式：

1.  通过延长会话时间（不好）或让页面在会话过期之前轮询服务器（更好）来保持会话处于活动状态。

2.  在提交时处理表单之前处理会话。如果，正如我所怀疑的，这与用户被注销有关，请保留一个 cookie 以确保您可以在考虑触摸表单数据之前重新登录该用户。

最重要的是（对于上述两种情况），**提交时保存表单状态！**这样，即使确实发生了问题，您也可以提供“返回表单”链接并将所有数据直接泵入表单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T13:55:03.433

ASP.NET 通过维护 Webform 的 ViewState 自动执行此操作。

查看这个在 W3schools 上讨论这个问题的[相关页面。](http://www.w3schools.com/ASPNET/aspnet_viewstate.asp)

所以，我的建议是：

1.  确保为需要用户输入的表单打开 ViewState（尤其是那些必须输入大量内容的表单）。

2.  通过放入运行服务器端的验证器然后输入无效数据来测试这种可用性问题。在服务器响应后，页面上输入的数据应保持不变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T13:57:07.250

即使发生错误，大多数好的框架也会保留您的输入。Asp.net 也是这样做的。作为开发人员，当您接受输入时，不要重定向到另一个页面。

Asp.net 将从视图状态中获取数据并将其放置到位。

您提到的问题（需要单击返回）是因为您的应用程序可能向您提供了不同的页面。

验证错误是（在我看来），最好的显示：

1.  在页面顶部
2.  错误元素旁边
3.  作为模态 div。

这将保留视图状态，用户不必重写数据。

这也发生在很多 php 框架中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T14:46:29.300

> 所以你点击返回来修复错误，你的整个游戏就消失了！

不是 Firefox（一般......），它会保留键入的数据并在您返回上一页时将其显示回来。
除非一些愚蠢的 JavaScript 在获得焦点或类似情况时删除了该字段的内容！

更好的是，我使用 It's All Text！扩展，它向文本区域添加了一个按钮，允许我在一个方便的真实文本编辑器上编辑文本......（并在每次保存时更新字段）。

现在，对于其他用户，您必须遵循上述建议...

但是我会为另一种常见情况添加一些内容：您在浏览器中输入了很长的内容，并且无意中关闭了选项卡/窗口或浏览器/计算机崩溃等
[。Sun 论坛](http://forums.sun.com/)有一个很好的功能，将 textarea 的内容发送到服务器定期使用 Ajax。因此，如果您返回您的页面，即使您尚未提交任何内容，服务器也能够恢复您正在进行的工作。

# java - 从计算机科学家到软件工程师

> ID：863435
> 
> 赞同：10
> 
> 时间：2009-05-14T13:50:38.980
> 
> 标签：java, hibernate, web-applications

我于 12 月毕业于计算机科学专业，并获得了软件工程职位。2 个月来，我一直在努力学习 Hibernate、Spring 以及在我的第一个项目中遇到的所有其他内容。在接受这份工作之前，我只有编程方面的经验。应用程序架构和工程工具一直很难掌握。我希望有人能够告诉我一个开始了解基于 Java 的 Web 应用程序如何工作的好地方。有这么多组件，我无法弄清楚一切是如何结合在一起的。所以，我的问题是。

1.  你如何去学习一项新技术？
2.  什么方法最适合同时学习多种技术？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-14T14:00:11.407

从基础开始。

我的意思是只是 servlet 和一个 Web 容器，可能是 Tomcat。无论您之后碰巧在其上抛出什么框架，您都应该了解 servlet 生命周期。

接下来，如果您愿意，可以将 JSP 加入其中。无论如何，JSP 只是美化的 servlet（它们被编译成 servlet 代码，然后编译成字节码）。

之后添加一个 MVC 框架。多年前，它曾经是 Struts (1)。如今，这有点困难。我喜欢 Spring MVC，但这也有点基于 Spring。而且我认为您最好（目前）绕过更多 Ajaxy 类型的框架（如 Tapestry 或 Wicket）或更多的端到端解决方案（如 Seam），因为过度管理问题。您在这里试图理解的重点就是 MVC 概念是什么、它是如何工作的以及您为什么要这样做。

之后添加弹簧。这里的重点是学习依赖注入/控制反转（IoC）的原理。这是现代 Java 开发和一般软件开发中极其重要的概念。

以上内容实际上遵循了这些技术是如何发展的，按照它们的发展顺序。他们这样做是有原因的，遵循这条道路将帮助您理解这一点。

不要听任何人告诉你不需要了解像纯 servlet API 这样的低级概念和技术。这是胡说八道。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-14T13:54:43.497

我认为 Mike Gunderloy 的书[**Coder to Developer**](https://rads.stackoverflow.com/amzn/click/com/078214327X)可能值得一看。

关于学习一项新技术，没有比尽可能多地使用它并[**练习它**](http://steve.yegge.googlepages.com/practicing-programming)更好的方法了。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-14T13:55:25.723

我的学习方式是自己构建一些东西。我通常会选择一些可以快速实施的琐碎事情，然后使用当下的企业技术 XYZ，这样我就可以四处寻找并了解细节。事实上，我正在尝试学习 ASP.NET MVC 时正在做这件事。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T14:00:16.633

当您成为工具和正在使用的语言/技术方面的专家时，一批新的孩子将使用更新更好的工具和语言/技术。然后，您将必须学习这些才能找到工作。所以习惯这个过程

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-14T21:59:04.220

所有好的答案，当你在苦苦挣扎的时候，也许你可以给你的教授一些反馈：

*   如果他们更多地关注现实世界的需求，现实世界会非常感激。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T23:48:29.760

老实说，伙计，如果你能在大学完成计算机科学，那么劳动力真的会更容易，只是不同。您永远不必像在大学时那样努力绞尽脑汁，这就是我的经验。无论如何，计算机科学家和软件工程师之间没有太大区别，非常细微的区别，但可以互换。

我的建议是，在开始学习框架和花哨的脚本库（如 hibernate、jQuery 等）之前，请确保您精通 XHTML/CSS/Javascript/SQL。由于您的背景，您可能已经熟悉了，但如果没有，这些核心基础将使您了解当您的花哨的框架在各处自动生成代码时真正发生的事情等等。

我知道有些人在没有深入了解 SQL 的情况下直接使用 ORM。他们喜欢 ORM，但他们并不真正了解底层发生了什么，并且当花哨的小 ORM 生成一些非常低效的 SQL 时，他们会很挣扎，因为他们不知道如何覆盖它并编写自己的。

另请注意，hibernate 和一些类似的框架可能会很臃肿，并不总是实现简单任务的最佳方式。对于很多事情来说，它们可能过于矫枉过正。再次，首先回到你的面包和黄油语言。构建没有框架的东西。如果你后来了解到你经历了很多重复的编码、加倍、grunt-cutting 和粘贴、高维护，然后从中吸取教训，然后转向适合你需要的框架。

但是一旦你熟悉了这个废话，你的计算机科学大脑就会加速，你会发现它很容易。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-14T17:23:41.200

大约一年前，当我开始工作时，我不得不经历这样的事情。我的解决方案是阅读我能拿到的所有代码库。如果您在使用弹簧时遇到问题，这将特别有帮助。跟踪所有配置文件发生了什么以及它与代码相关的位置、内容更改的位置以及原因。至于休眠，玩弄它并阅读注释文档（这对我来说是最难的部分）。

最后，自愿参加任何出现的随机项目，尤其是如果您从未使用过这些技术。在过去的一年里，我参与了许多与我的日常工作无关的项目，并且从这些项目中学到的东西比我在大学四年里学到的更多。

祝你好运

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-14T13:58:00.697

这些应该有助于学习：

> [https://stackoverflow.com/questions/19551/how-to-plan-your-learning-process-efficiently](https://stackoverflow.com/questions/19551/how-to-plan-your-learning-process-efficiently)
> 
> [https://stackoverflow.com/questions/506501/should-you-always-read-a-book-when-picking-up-a-new-technology](https://stackoverflow.com/questions/506501/should-you-always-read-a-book-when-picking-up-a-new-technology)
> 
> [https://stackoverflow.com/questions/58989/whats-your-way-to-stay-up-to-date-and-learn-new-technologies](https://stackoverflow.com/questions/58989/whats-your-way-to-stay-up-to-date-and-learn-new-technologies)
> 
> [https://stackoverflow.com/questions/771771/how-to-learn-new-techniques](https://stackoverflow.com/questions/771771/how-to-learn-new-techniques)
> 
> [https://stackoverflow.com/questions/109557/what-is-your-approach-to-learning-a-new-language-or-framework](https://stackoverflow.com/questions/109557/what-is-your-approach-to-learning-a-new-language-or-framework)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-14T13:58:17.760

理论与实践

1.  阅读（即 Spring in Action 很棒，博客等）
2.  练习（即写一些代码，获得反馈）
3.  转到 1

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-14T13:58:56.917

当我从 asp.net 转到 jsp [Head First Servlets & JSP, Second Edition](http://www.headfirstlabs.com/books/hfsvlt/)时，我真的很喜欢这本书。

对于那些了解编程和网络但对 jsp、servlet 和 mvc 如何协同工作了解不多的人来说，这是一本很好的入门书。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-14T14:01:51.840

尽管继续。作为一名程序员，在一份新工作上花费 2 个月时间，但仍然觉得自己陷入了流沙之中，这并不罕见。我遇到过这样的情况，我在一份新工作上花了长达 6 个月的时间才达到一个我觉得自己终于要转机的阶段，而那是在 10 年的程序员经验之后。尽管在那种情况下掌握代码库就像试图破译埃及象形文字。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-14T21:38:24.100

首先要了解的是 Servlet 规范，因为它描述了 Java Web 应用程序本质上遵循的所有基本特性。这不是简单的阅读，但只是一般的掌握会让你走得很远。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-14T23:34:16.223

在完全了解 JDBC 之前不要使用 Hibernate。

你没有说你是否有任何关系数据库或 SQL 的背景。两者都是必不可少的。

我喜欢春天，但你应该意识到你不需要吞下整个东西来从中受益。例如，您可以使用 JSP 和 JDBC 模块从 Spring Web UI 中获得很多好处。暂时不要使用 Hibernate，直到您对 Spring 感到满意为止。

解决问题，尤其是在计算机科学中，就是将大问题分解成小问题。缩小问题的规模并专注于一件事。我推荐使用 JDBC、Spring、Hibernate 的 Web 应用程序。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-15T03:56:55.687

我从计算机科学与工程学位转为软件工程。在尝试学习新技术时，我有一种技巧。它通常是这样的。

1.  我通常会尝试通读一些关于该技术的文档并记下关键点。
2.  我尝试着手编写教程并实施它。
3.  一旦教程按预期运行，我就会对其进行修改，直到我感觉舒服为止。

我不能保证它对你有用，但它对我有很大帮助。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-14T14:17:54.673

2年前我在你同样的位置。真的不能指望你在学校学习流行的框架和架构——你在那里学习计算机科学理论和如何编程。希望在工作期间您可以花时间学习 Spring、Hibernate 等，但如果没有，您将需要自己花一些时间。

如果这些框架对您来说是新的，我建议您购买一本书来进行有条不紊和“类似教程”的学习，而不是随机搜索或尝试阅读参考文档。我肯定会为 Hibernate 这样做。这就是我最初学习流行的 J2EE 堆栈的方式，但现在我可以阅读框架附带的文档。

无论如何，您会开始发现所有 J2EE 技术都有一定的相关性，并且您会在学习特定技术的同时学习其他相关技术的一小部分。例如，学习 JSF 与 JSP 密切相关。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-14T13:56:03.850

1.  你只需要开始使用这些工具来感受它们。
2.  我会去网上查看并开始阅读有关您正在使用的技术的书籍和网站。
3.  我会开始在网上搜索您应该阅读的一般软件工程书籍。 [这里有围绕这个主题的问题](https://stackoverflow.com/questions/72406/what-development-book-made-the-most-impact-on-you-as-a-developer/72412#72412)。
4.  向其他与您一起工作的工程师询问他们如何做事以及为什么这样做。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-14T14:04:07.607

现实检查：作为一名进入劳动力市场的新毕业生，你正在经历与我们其他人相同的过程。你正在进入一个与你多年所学完全不同的生态。无论你从事什么工作，都会有一条学习曲线，而且优秀的雇主都明白这一点。

为了快速解决您的问题：

> 你如何去学习一项新技术？

阅读、练习、犯错、重复。此过程中最有价值的产品将是您可以向新同事（以及在 Stack Overflow 上）提出的*具体问题。*请记住，提出好的问题实际上会让你看起来更聪明。问笼统的问题或“我不明白”只会让你烦人......

> 什么方法最适合同时学习多种技术？

列出您需要学习的内容的优先级列表，然后按照列表进行操作。你不可能在一个周末学会所有的电子商务。但是，您可以在一个下午了解 Hibernate 的特定方面。使用 IDE 阅读您的新代码库，并开始探索实际*使用*的 API 。如果您可以只关注所有这些新工具的相关点，您实际上可能会发现自己取得的进展比您预期的要快。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-15T00:02:06.763

找一个你尊重的导师，照他们的做。

作为一名年轻的 CS 毕业生，我很幸运地结识了一位经验丰富的建筑师。现在，这是您需要了解的有关经验丰富的建筑师的事情，他们（我们）很懒惰。他们（我们）会让你从他们的盘子里拿走很多东西，让你去做，然后告诉你为什么错了。如果可以的话，利用这个过程。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-15T00:11:32.827

在学习新技术或新技术时，我会做的一件事是编写一个小型示例应用程序。[Hibernate](https://www.hibernate.org/152.html)、[Spring MVC](http://static.springframework.org/docs/Spring-MVC-step-by-step/)和[Maven](http://www.sonatype.com/books/maven-book/reference/simple-project.html)有很多很好的教程。关键是限制您一次尝试的事情的数量——例如，如果您专注于 Maven 而没有将 Spring 和 Hibernate 混在一起，那么了解 Maven 会更容易。一旦你对一件事感到满意，你就可以开始另一个微型项目。

有导师也有帮助。你会发现自己处于需要有人交谈的情况（技术和非技术）。不要害怕向与你一起工作的更有经验的人寻求建议。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2009-05-14T14:10:36.967

[实时调频](http://en.wikipedia.org/wiki/RTFM)！！认真地，阅读和阅读和阅读。然后应用，阅读，犯错误，阅读，回溯找出你做错了什么，阅读，修复，阅读，一遍又一遍地应用。

我说读了吗？：-） 我是认真的。阅读所有你能得到的东西。谷歌是你的朋友。StackOverflow 是你的朋友。那里有很多很棒的书，像[这样](https://stackoverflow.com/questions/3088/best-ways-to-teach-a-beginner-to-program)的帖子描述了它们，还有更多！祝你好运！！

# javascript - 返回包含 javascript 的部分视图是不好的做法吗？

> ID：863436
> 
> 赞同：13
> 
> 时间：2009-05-14T13:50:46.517
> 
> 标签：javascript, jquery, asp.net-mvc, architecture

我正在实现一个客户数据库，它可以让我搜索用户和公司、浏览和编辑他们的详细信息，以及使用 ASP.NET MVC 和 javascript (jQuery) 进行的许多其他操作。

每当发生 post 或 get 时，我都会通过 jQuery.load 执行此操作并将 PartialView 插入 DOM。

一些局部视图包括表单。我也希望它们是 ajax 表单，因此这些部分视图具有 document.ready 处理程序，可将表单转换为 ajax 表单（通过 jquery.form）。

一开始，我在将部分视图插入 DOM 的回调/代码中处理这个问题。然而，这导致了一个包含许多引用不同页面的 javascript 函数的大脚本。我通过将脚本插入相应的页面来重构大型 javascript。

现在代码更流畅了（我的 OnXXXPartialView 处理程序要少得多），并且代码整齐地位于它所属的局部视图中。这些文件中的大多数只包含 3-4 行 javascript 代码，因此开销并不大。

如此有效地，我不仅在文档 DOM 中添加元素，而且有时我也在添加一段 javascript。在实践中这很好用，但似乎[Firebug 无法调试动态加载的脚本](https://stackoverflow.com/questions/858779/making-firebug-break-inside-dynamically-loaded-javascript)。

当然有解决 Firebug 问题的方法，但我想知道我的架构是否是真正的罪魁祸首。你把属于部分视图的javascript放在哪里？有没有最佳实践？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T13:56:54.613

如果您正在经历在部分视图中包含 javascript 的麻烦，我会切换到在您的 ajax 调用中只返回 JSON，这样您就可以在客户端上处理所有这些。不过，我承认我总是更喜欢这种方法。

至于最佳实践，我一直认为在 ajax 调用而不是 json 中返回生成的 html 是不好的，但这只是我（不敲你，这是个人选择）。显然，微软并不认为这是不好的做法，因为他们专门内置了支持它的功能。无论如何，我不会考虑将 javascript 包含在您的 html 中，而不是一开始就将 html 发送回去。

不过我很好奇，javascript中有什么？

编辑：具体来说，我赞成进行 ajax 调用以获取 json，然后使用客户端 JS 构建该“部分视图”并将其插入到 dom 中。与进行 ajax 调用以获取服务器呈现的 html 以供客户端然后插入 dom 不同。

> 一些局部视图包括表单。我也希望它们是 ajax 表单，因此这些部分视图具有 document.ready 处理程序，可将表单转换为 ajax 表单（通过 jquery.form）。

我认为您可以在将部分视图插入 dom 的回调/代码中处理此问题。

编辑：如果它有序、高效、组织良好并且适合你，那么我会坚持下去。将所有美好和紧凑的东西都放在局部视图中的想法绝对很有吸引力，所以我不会太担心违反任何最佳实践。我唯一担心的是 JS 可能是可重用的，如果您一遍又一遍地插入相同的脚本，就会出现这种情况。但是在这种情况下，听起来您正在进行大量的划分，所以我会坚持使用它，除非您可以概括您的脚本并将它们包含在您的 JS 的其余部分中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T13:58:39.337

最后 - JavaScript 应该在一个文件中（因为每个 http GET 都会花费一些宝贵的时间）并被缩小。这些链接可能会让您感兴趣：[这里](http://weblogs.asp.net/rashid/archive/2009/04/28/script-and-css-management-in-asp-net-mvc.aspx)和[这里](http://blog.lavablast.com/post/2009/05/YUI-Compressor-for-Visual-Studio.aspx)。

您处理 JS 的方式会进行一些不需要的数据传输——而不是发送 JS，将其设为静态，将其缓存在客户端并进行参数化。

上面的帖子给出了一个很好的提示（JSON）如何参数化你的 JS :)

# .net - XmlWriter 编码问题

> ID：863437
> 
> 赞同：6
> 
> 时间：2009-05-14T13:50:58.653
> 
> 标签：.net, xml, encoding, xmlwriter

我有以下代码：

```
 MemoryStream ms = new MemoryStream();
    XmlWriter w = XmlWriter.Create(ms);

    w.WriteStartDocument(true);
    w.WriteStartElement("data");

    w.WriteElementString("child", "myvalue");

    w.WriteEndElement();//data
    w.Close();
    ms.Close();

    string test = UTF8Encoding.UTF8.GetString(ms.ToArray()); 
```

XML 生成正确；但是，我的问题是字符串 'test' 的第一个字符是 ï (char #239)，使其对某些 xml 解析器无效：这是从哪里来的？我到底做错了什么？

我知道我可以从第一个字符之后开始解决问题，但我宁愿知道它为什么存在，而不是简单地修补问题。

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T14:01:56.787

在这里找到了一种解决方案： [https ://timvw.be/2007/01/08/generating-utf-8-with-systemxmlxmlwriter/](https://timvw.be/2007/01/08/generating-utf-8-with-systemxmlxmlwriter/)

我在顶部错过了这个：

```
XmlWriterSettings xmlWriterSettings = new XmlWriterSettings();
xmlWriterSettings.Encoding = new UTF8Encoding(false);
MemoryStream ms = new MemoryStream();
XmlWriter w = XmlWriter.Create(ms, xmlWriterSettings); 
```

感谢大家的帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T13:56:40.370

问题是编写器生成的 XML 是 UTF-16，而您使用 UTF-8 将其转换为字符串。试试这个：

```
StringBuilder sb = new StringBuilder();
using (StringWriter writer = new StringWriter(sb))
using (XmlWriter w = XmlWriter.Create(writer))
{
    w.WriteStartDocument(true);
    w.WriteStartElement("data");

    w.WriteElementString("child", "myvalue");

    w.WriteEndElement();//data
}

string test = sb.ToString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T13:54:39.113

您可以像这样更改编码：

```
w.Settings.Encoding = Encoding.UTF8; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T15:44:24.443

如果您关心编辑器使用的字节顺序标记（例如 Visual Studio 检测 UTF8 编码的 XML 和正确突出显示语法），所有这些都略有偏差。

这是一个解决方案：

```
MemoryStream stream = new MemoryStream();

XmlWriterSettings settings = new XmlWriterSettings();
settings.Encoding = Encoding.UTF8;
settings.Indent = true;
settings.IndentChars = "\t";

using (XmlWriter writer = XmlWriter.Create(stream, settings))
{
    // ... write

    // Make sure you flush or you only get half the text
    writer.Flush();

    // Use a StreamReader to get the byte order correct
    StreamReader reader = new StreamReader(stream,Encoding.UTF8,true);
    stream.Seek(0, SeekOrigin.Begin);
    result = reader.ReadToEnd();
} 
```

我[这里有 2 个完整的片段](http://www.shrinkrays.net/code-snippets/csharp/using-xmltextwriter-to-produce-a-xml-string.aspx)

# jquery - 通过jquery从其他div后面滑动div

> ID：863439
> 
> 赞同：3
> 
> 时间：2009-05-14T13:51:25.673
> 
> 标签：jquery, jquery-ui

我们有一个内容 div（#content），在 div 的右侧有一个选项卡（#tab）——当用户单击 #tab 时，它应该向右滑动并显示各种选项。

我不确定如何通过 jQuery 创建它。我想（我在脑海中制定的 CSS 草案）：

```
 #content {
 z-index:10;
margin:0 auto
}

#tab {
z-index: 5;
float: left;
width: 150px
} 
```

和 javascript 将#tab 向右滑动 140 像素 [标签图形为 10 像素]

因此，通常#tab 将主要（除了 10px 图形图标）*在*#content 之后，jquery 只是改变位置以将其向右移动。

那可能吗？有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T13:56:59.370

我不太确定是否有可能，因为您已将#tab 的 z-index 设置为低于 #content 的 z-index。如此有效地#content 覆盖#tab。

但是，对于使用 jQuery 向右移动...

```
$("#tab").click(function(){
      $(this).animate({"left": "+=50px"}, "slow");
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T14:13:36.757

Animate 甚至可以使用具有 z-index 的元素。但是也许你应该看看

[http://docs.jquery.com/UI/Accordion](http://docs.jquery.com/UI/Accordion)

这可以通过一些定制来满足您的需求。

或垂直手风琴： [http ://tinyjs.com/files/projects/jquery-vertical-accordion/index.html](http://tinyjs.com/files/projects/jquery-vertical-accordion/index.html)

# excel - Excel 使用的 DIF 文件格式的描述？

> ID：863445
> 
> 赞同：0
> 
> 时间：2009-05-14T13:52:58.710
> 
> 标签：excel, file-format

DIF 文件的布局是什么，更重要的是，不同的标题和数据字段的含义是什么？维基百科文章有足够的信息，我怀疑这将是一种比 CSV 更丰富的易于生成的格式。但是我找不到对这种格式的足够好的描述来实际生成它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T14:54:09.297

当我遇到这样的问题时，我通常会去 Wotsit，在[电子表格/数据库文件](http://www.wotsit.org/list.asp?fc=6 "电子表格/数据库文件")部分，看看他们是否有任何问题。

他们有一个 Dif.zip 文件，里面有一个 DIF.txt 文件，里面有一个简短的（164 行）格式描述。
我不能保证描述是官方的/完整的，但这可能是一个好的开始。

# python - 哪个 PEP 控制 dict.values() 的顺序？

> ID：863446
> 
> 赞同：1
> 
> 时间：2009-05-14T13:53:06.993
> 
> 标签：python, dictionary

当您调用 dict.values() 时，返回项目的顺序取决于键的 has 值。这似乎在所有版本的 cPython 中都非常一致，但是 dict 的 python 手册[只是声明排序是 "arbitrary"](http://docs.python.org/library/stdtypes.html#dict.items)。

我记得在某处读到实际上有一个 PEP，它专门说明了 items() 和 values() 方法的预期顺序。

仅供参考，如果这种行为确实是我正在研究的课程的保证行为，我可以大大简化和加速我正在研究的课程。另一方面，如果这只是 cPython 的一个偶然且未记录的特性，那么最好不要相信它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T13:56:48.857

从[http://docs.python.org/library/stdtypes.html](http://docs.python.org/library/stdtypes.html)：

> 键和值以非随机的任意顺序列出，在 Python 实现中有所不同，并且取决于字典的插入和删除历史。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-14T14:00:30.253

我想[PEP-3106](http://www.python.org/dev/peps/pep-3106/)尽可能接近：

> 规范暗示 .keys()、.values() 和 .items() 返回项目的顺序是相同的（就像在 Python 2.x 中一样），因为顺序都是从 dict 派生的迭代器（这可能是任意的，但只要不修改 dict 就稳定）。这可以通过以下不变量来表示：
> 
> `list(d.items()) == list(zip(d.keys(), d.values()))`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T13:59:32.470

“任意”不等于“偶然”。

但这与“无证”相同。由于字典是基于散列的，你不能——真的——保证基于散列算法的排序和发生的冲突。

为了保证订单，您使用该`sorted`功能。

或者你可以找到一个很好的[有序字典](http://code.activestate.com/recipes/107747/)实现来代替字典。

# mysql - MySql - 缓慢发送数据阶段

> ID：863447
> 
> 赞同：45
> 
> 时间：2009-05-14T13:53:34.903
> 
> 标签：mysql, performance

我对 MySQL 5.0.45 的一个查询在“发送数据”阶段运行缓慢。该查询是一个简单的选择，返回大约 300 个整数 ID 字段作为结果集。

```
mysql> SELECT source_id FROM Directions WHERE (destination_id = 10);
+-----------+
| source_id |
+-----------+
| 2 |
| 8 |
...
| 第2563章
+-----------+
341 行（2.13 秒）

```

我注意到为什么“发送数据”阶段如此缓慢，以及可以做些什么来使其快速。请注意，我是在服务器本身的 MySQL 提示符上执行此查询，因此并不真正期望它会在“发送数据”上花费这么多时间。有什么线索吗？

如果有帮助，我在此表上有 3 个文本字段，但由于它们没有被选中，我希望它们不是造成这种缓慢的原因。

这个查询每天运行数千次，而且每次都花不了 2 秒。

分析结果：

```
mysql> 显示查询 4 ​​的配置文件；
+--------------------------------+----------+
| 状态 | 持续时间 |
+--------------------------------+----------+
| （初始化） | 0.000003 |
| 检查查询缓存中的查询 | 0.000051 |
| 检查权限 | 0.000007 |
| 开桌 | 0.000011 |
| 系统锁 | 0.000005 |
| 表锁 | 0.000023 |
| 初始化 | 0.00002 |
| 优化 | 0.00001 |
| 统计 | 0.00006 |
| 准备| 0.000014 |
| 执行 | 0.000005 |
| 发送数据 | 2.127019 |
| 结束 | 0.000015 |
| 查询结束 | 0.000004 |
| 将结果存储在查询缓存中 | 0.000039 |
| 释放物品 | 0.000011 |
| 关闭表| 0.000007 |
| 记录慢查询 | 0.000047 |
+--------------------------------+----------+
18 行一组（0.00 秒）

```

更新：我偶然发现了以下网址，上面写着

> 每个时间表示前一个事件和新事件之间经过的时间。所以，这行：
> | 发送数据 | 0.00016800 |
> 表示“执行”和“发送数据”之间经过了 0.00016800 秒。也就是说，执行查询需要 0.00016800 秒。

[http://forums.mysql.com/read.php?24,241461,242012#msg-242012](http://forums.mysql.com/read.php?24,241461,242012#msg-242012)

有人可以验证吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-14T17:25:52.053

每当您的查询速度较慢时，解释计划通常是最好的起点。要得到一个，运行

```
DESCRIBE SELECT source_id FROM directions WHERE (destination_id = 10); 
```

这将向您显示一个表格，其中列出了执行查询所需的步骤。如果您在 'rows' 列中看到一个大值而在 'key' 列中看到 NULL，则表明您的查询必须扫描大量行以确定要返回哪些行。

在这种情况下，在destination_id 上添加索引应该会显着加快您的查询速度，但会以插入和删除速度为代价（因为索引也需要更新）。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2017-12-12T01:49:52.543

我有同样的问题：发送数据非常慢，但我有正确的索引等。

经过大量挖掘，我发现我`join`正在比较两个已编入索引但具有不同排序规则的字段 - 一个是 latin1_swedish_ci，另一个是 uft8_general_ci。

一旦我将它们都发送到 utf8，查询就会明显更快（从 2.7 秒到 0.002 秒）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-12-09T17:53:05.100

您可能可以查看 mysql 服务器的硬件部分。正如[Mysql 文档](http://dev.mysql.com/doc/refman/5.0/en/general-thread-states.html)所说：

> **发送数据**
> 
> 该线程正在读取和处理 SELECT 语句的行，并将数据发送到客户端。由于在此状态期间发生的操作往往会执行大量磁盘访问（读取），因此它通常是给定查询生命周期内运行时间最长的状态。

因此，如果您的服务器由于巨大的 db/table 文件或禁用 tableperfile InnoDB 选项/碎片/错误配置的 RAID/磁盘崩溃过程启动（等待很快磁盘死亡）/磁盘 I/O 的任何其他原因而导致磁盘 I/O 缓慢缓慢 - 这**可能是**显着增加“发送数据”步骤的原因，因为在此阶段服务器从磁盘收集所有请求的数据并将其发送到客户端。

当然，您应该首先尝试优化选择以使用索引，并确保这不是编程问题，因为这在大多数情况下会影响此阶段时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-06-25T11:52:52.287

我有两个索引 (`date_index`和`id`) ，

我有`WHERE date_index>NOW() - INTERVAL 24 HOURS`一个`ORDER BY id`in 查询，MySql 首选`id`作为索引，它没有使用导致大表查询时间长的 date_index。

5 年后，我在一个遗留系统中发现了它，该表已经增长。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-25T11:37:51.070

我从 MySQL 5.5.x 迁移到 5.7.x 后遇到了这种情况。我使用连接的查询在 MySQL 5.5 上很快，而在 MySQL 5.7 上非常慢。

问题是 MySQL 5.7 选择了另一组索引，而不是 MySQL 5.5。

添加 USE INDEX 解决了这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-02-14T05:37:23.823

在我看来，分析是无用的。它具有误导性类别，例如“发送数据”，这无济于事。

```
SELECT source_id FROM directions
    WHERE (destination_id = 10); 
```

将受益于

```
INDEX(destination_id, source_id) 
```

（以该顺序）。`INDEX(destination_id)`同时，由于该索引处理此类需求而下降。该指数是“覆盖指数”。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-09-14T08:27:19.023

您的查询花费 2.127019 来**执行**查询。这可能是因为您有大量数据，并且您缺少 destination_id 列上的索引。尝试 ：

> CREATE INDEX index_destination_id ON 方向（destination_id）；

然后您的请求将顺利进行。

# html - 文本框中的字体？

> ID：863455
> 
> 赞同：0
> 
> 时间：2009-05-14T13:55:23.447
> 
> 标签：html, css

在 Rails 创建的普通文本框中：

```
<%= text_area_tag 'chat_data', '', :rows => 30, :cols => 70 %> 
```

是否可以为文本设置字体，例如粗体和着色？我正在使用文本框来存储聊天会话，并希望使其更美观。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T14:00:40.300

我会`<textarea>`完全忘记 s。将 HTML 输出到 a`<div>`并使用 CSS 来格式化您的标记。

一个例子：

```
<div class="chatbox">
    <p><span class="name">Oli:</span> My message</p>
    <p><span class="name">Oli:</span> My message</p>
    <p><span class="name">Oli:</span> My message</p>
    <p><span class="name">Oli:</span> My message</p>
</div> 
```

具有以下一些格式：

```
.chatbox {overflow:auto;width:500px;height:200px}
.chatbox p {}
.chatbox .name {font-weight:bold} 
```

一切都相当简单，但如果你知道怎么做，你可以拨号。（注意：宽度和高度必须固定才能溢出工作）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T13:58:56.713

不，那是不可能的。[HTML 中的WYSIWYG 编辑器](http://www.webresourcesdepot.com/category/goodies/wysiwyg-html-edit/)使用了一个巧妙的技巧，涉及`editable`属性元素，而不是`textarea`.

# tfs - 从 TFS 生成构建

> ID：863459
> 
> 赞同：0
> 
> 时间：2009-05-14T13:55:58.703
> 
> 标签：tfs, build-process

当您打算使用 TFS 发布构建时，您通常会做什么？只需使用特定的变更集，创建分支或标签/标签？

注意：这个版本不是为了发布，而是为了我们的登台/用户接受环境。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:59:31.550

构建系统将根据名称自动创建一个标签。通常这对大多数公司来说已经足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T01:43:15.227

我使用一个非常简单的公式来决定它应该是标签还是分支，如果有任何机会您需要修补或修补构建然后使用分支。否则，如果您只想在某个点引用代码，请使用标签。另一个重要的考虑是标签只有有限的配置管理器，例如它们可以被任何有权限的人删除或修改，而无需任何更改历史。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T04:44:23.777

我实际上有不止一个版本。我使用免费的 MSBuild 包附带的版本控制任务（MSBuild 社区任务、MSBuild 扩展包和 MSBuild SDC）来更改我在 Team Build 和我的二进制文件中的版本。

我有一个格式为 1.2.3.4 (major.minor.revision.build) 的自定义版本

我的每晚都会建立内部版本号。当我要发布一个测试版本时，我会启动一个构建版本，它会增加修订号。

然后，当您准备好进行生产时，您可以发布已通过测试的版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T13:59:50.520

当我们在新版本上开始开发时，我们会分支并将新代码和修订版放入该分支。

这允许我们做两件事：

1.  我们设置了一个夜间合并流程，将分支折叠回主线。这允许错误修复传播到开发中的所有版本（任何其他分支都从主线合并并根据版本号优先级再次返回）。
2.  我们还为早上部署到暂存环境的每个分支设置了夜间构建。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T20:08:18.567

我建议按照@Vaccano 上面的建议进行夜间构建，或者您可以进行持续集成。[您可以在http://www.newagesolution.net/SpecialEvents/SessionatOrlandoCodeCamp2009.aspx](http://www.newagesolution.net/SpecialEvents/SessionatOrlandoCodeCamp2009.aspx)找到好的构建工具，让您朝着正确的方向前进。应该有 Powerpoint 和代码示例来实现自动化构建和打包。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-05T12:05:02.750

作为夜间构建/计划构建的一部分，人们还希望从版本控制和工作项存储库中生成发行说明。

手边有发行说明是一个很大的优势。现在可以使用来自[http://tfschangelog.codeplex.com](http://tfschangelog.codeplex.com)项目的[**TFS ChangeLog / TFS ReleaseNotes Generator 。**](http://tfschangelog.codeplex.com)

TFS ChangeLog 应用程序允许用户提供有关他们的变更集起点和终点的信息（我们将其称为变更集范围），然后它会为存在于起点和终点变更集之间的每个变更集提取信息。然后将提取的信息保存在 XML 文件中，然后使用 XSLT 2.0 转换，生成 HTML 发行说明报告。

我希望这会有所帮助。

此致，

达梅什·沙阿。

# java - 在 Java 中对 LinkedList 调用 size() 的时间复杂度是多少？

> ID：863469
> 
> 赞同：57
> 
> 时间：2009-05-14T13:57:23.847
> 
> 标签：java, size, linked-list, time-complexity

正如标题所问，我想知道 LinkedList 类中的 size() 方法是否需要分摊的 O(1) 时间或 O(n) 时间。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-14T14:00:48.863

它是 O(1)。你可以谷歌搜索源代码，你会得到这样的：

来自[http://www.docjar.com/html/api/java/util/LinkedList.java.html](http://www.docjar.com/html/api/java/util/LinkedList.java.html)

我看过的所有 Collection 类都将大小存储为变量，并且不会遍历所有内容来获取它。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-14T13:58:51.347

如果您查看源代码，您会发现 O(1)...

从链表：

```
private transient int size = 0; 
```

...

```
/**
 * Returns the number of elements in this list.
 *
 * @return the number of elements in this list
 */
public int size() {
   return size;
} 
```

# php - 使用 JavaScript 或 PHP 自动检测用户当前的本地时间

> ID：863474
> 
> 赞同：12
> 
> 时间：2009-05-14T13:58:30.070
> 
> 标签：php, javascript, timezone

*我经常需要根据不同时区的用户实际*本地时间或受其影响来显示信息。是否有可靠的方法来获取用户的当前时间和/或时区？

关键问题：

*   服务器端代码基于网站主机或用户的 ISP
*   客户端代码基于用户的系统时钟，太容易操纵

关键问题：

*   是否有必要查明用户的地理位置？
*   ISP时间可以作为准确的指南吗？
*   用户操作系统时钟可以由用户改变或修改吗？

例子：

**倒数：**

> 仅剩 1 小时 3 分 56 秒！

问题：基于什么的秒数；用户的操作系统时钟、主机服务器时间（正负偏移）、ISP 系统时间。如果所有时区的时钟同时结束，这很容易，但如果它是用户本地时区午夜之类的倒计时，则更棘手）

**编辑日志**

> 下午 3:03（10 秒前）发布的项目

问题：无论用户如何计算“10 秒”，调整时间以匹配用户的时区。

**营业时间：**

> 这家餐厅现在营业至午夜（澳大利亚东部标准时间）。

问题：可以通过从服务器端偏移来计算像午夜这样的时间，但使用像现在这样的 psudo 时间，2 小时内是基于用户的时间。

**PHP：**使用`time()`输出服务器时间。这可以根据用户的时区进行偏移。

**JavaScript：**使用`Date()`输出用户的计算机时钟时间，这太容易操纵了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T14:22:49.573

使用 JavaScript，有一种方法可以获取用户当前的时区偏移量。

```
new Date().getTimezoneOffset() * -1 
```

返回从 GMT 开始的偏移量（以分钟为单位）。不要存储此值，因为它可能会根据夏令时而改变。如果您在服务器（php）上需要它，那么您需要在发送时捕获它。

不幸的是，HTTP 规范没有将用户时区作为标头发送，而这正是 php 所需要的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-14T14:03:02.167

简而言之，没有。

我建议使用服务器端时间，并让用户能够选择他们的时区。

您可以根据用户 IP 地址的启发式方法计算用户的默认时区，但这很容易出错。

您应该能够通过 javascript / Ajax 提取客户端时区信息，但与时间本身一样，这也容易出错。

**我的建议**：让用户根据您期望用户的位置选择具有合理默认值的时区。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T14:21:37.753

我建议您将服务器日期写入 javascript。然后在 javascript 中创建一个新日期，以获取用户在他们的机器上设置的日期。在两个日期中使用不同的值。

使用服务器日期，您可以确定您的时间是公正的。所有计算都必须使用服务器日期完成。

使用差异仅用于显示目的。这适用于编辑日志、倒计时和选择“早上好”等消息。

如果用户希望他的时间成为别的东西......我认为你应该让他拥有那个。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T15:02:54.627

PHP 有一个[PECL 扩展](http://pecl.php.net/package/geoip)和一个可以进行 GeoIP 查找的[PEAR 包。](http://pear.php.net/package/Net_GeoIP)假设用户不在某种代理或 NAT 之后，数据库是最新且准确的，并且地址完全在数据库中，您可以获得[timezone](http://us.php.net/manual/en/function.geoip-time-zone-by-country-and-region.php)，并计算与服务器时间的偏移量.

或者，您可以接受用户的系统时钟并非 100% 准确，但通常非常接近。所有主要操作系统都有某种方式将其时钟与网络时间服务器同步，其中大部分是默认打开的。如果这个人决定把他们的电脑放在“错误的”时区，那可能是有原因的（他们正在旅行，他们与另一个时区的人一起工作）。

如果用户出于某种原因将时钟设置为 10 分钟，他们将接受时间计算不准确的后果。

* * *

**补充**：如果你的服务器时钟是准确的（如果不是，就像 HermanD 说的，如果你控制服务器就修复它，如果你不这样做就抱怨）但不在正确的时区，你总是可以使用 PHP`ini_set()`或`date_default_timezone_set()`强制你的脚本无论系统时区如何，都在 GMT 运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-07T07:01:57.853

**javascript:**

```
<script type="text/javascript">
var currentTime = new Date()
var hours = currentTime.getHours()
var minutes = currentTime.getMinutes()

if (minutes < 10){
  minutes = "0" + minutes;
}
var suffix = "AM";
if (hours >= 12) {
suffix = "PM";
hours = hours - 12;
}
if (hours == 0) {
hours = 12;
}

document.write("<b>" + hours + ":" + minutes + " " + suffix + "</b>");
</script> 
```

**输出**

上午 11:51

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-19T07:55:18.770

我建议使用服务器时间。以函数为例`time()`。如果您将一切都基于此值，那么您的系统将不会受到您需要的任何时间特定操作的影响。

每次用户请求具有或使用时间限制的页面时，请确保您发送服务器时间。

创建一个 Javascript 模块，该模块在页面加载时检查服务器是否已发送时间，如果是，则读取该值，并将其转换为 JS 本地时间，使用 JS 获取或计算的时区。然后你可以将它保存为一个 JS 全局变量，或者将它作为一个对象或其他东西中的静态变量。

# c# - NLog ASP.Net 查看器

> ID：863477
> 
> 赞同：3
> 
> 时间：2009-05-14T13:58:43.157
> 
> 标签：c#, asp.net, nlog

我在大型金融应用程序中使用 nLog，但经常需要在软件运行时调出最后一小时的日志并过滤特定的记录器/级别。我想将所有内容记录到 SQL 中，并使用 asp.net 查看器。有没有这样的项目？有一些很好的示例网站吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T14:04:31.710

[NLogViewer](https://github.com/lytri/NLogViewer)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-18T03:16:02.803

此外，[Sentinel](http://sentinel.codeplex.com/)（codeplex 上的免费、开源）是另一种选择。

# php - simpletest 中的计数模式（PHP 测试框架）

> ID：863492
> 
> 赞同：0
> 
> 时间：2009-05-14T14:00:13.187
> 
> 标签：php, testing, simpletest

如何测试站点中是否只有一次字符串？我使用来自 simpletest 的 WebTestCase。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T15:23:45.217

如果您有一个包含所有页面名称的数据库，并且您知道要查找的字符串，则可以遍历数据库并读取每个页面，然后在每个页面中搜索该字符串。

# java - 在Java中将三维数组的所有值设置为零的最佳方法是什么？

> ID：863507
> 
> 赞同：11
> 
> 时间：2009-05-14T14:04:00.383
> 
> 标签：java, arrays, multidimensional-array

我有一个要重置为零的三维数组。似乎应该有一种不涉及三个`for`循环的简单方法：

```
for (int i = 0; i < n; i++) {
    for (int j = 0; j < n; j++) {
        for (int k = 0; k < n; k++) {
            cube[i][j][k] = 0;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-14T14:23:15.220

如果您使用的是 JDK 1.5 或更高版本：

```
 for (int[][] square : cube) {
        for (int[] line : square) {
            Arrays.fill(line, 0);
        }
    } 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-14T14:07:41.530

初始化后数组将用零填充：

```
int[][][] cube = new int[10][20][30]; 
```

这你也可以稍后再做，将它们的数组重置为零，它不限于声明：

```
cube = new int[10][20][30]; 
```

只需创建一个新数组，它用零初始化。如果您有一个地方保存对数组的引用，则此方法有效。不要关心旧数组，那将被垃圾收集。

如果您不想依赖语言的这种行为，或者您无法替换所有出现的对旧数组的引用，那么您应该使用jjnguy 提到的[Arrays.fill() ：](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#fill(int[],%20int))

```
for (int i = 0; i < cube.length; i++)
{
   for (int j = 0; j < cube[i].length; j++)
   {
      Arrays.fill(cube[i][j], 0);
   }
} 
```

Arrays.fill 似乎也在内部使用了一个循环，但它通常看起来更优雅。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-14T14:09:25.253

好吧，看来您可以放弃旧数组并创建一个新数组：

```
int size = 10;
cube = new int[size][size][size]; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-14T14:08:08.127

```
for (int i = 0; i < arr.length; i++){
    for (int j = 0; j < arr[i].length){
        Arrays.fill(arr[i][j], 0);
    }
} 
```

这样你就可以使用[Arrays.fill](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#fill(double[],%20double))摆脱一个额外的循环；

或者

```
arr = new double[arr.length][arr[0].length][arr[0][0].length]; 
```

不幸的是，这假设数组至少是`length >= 1`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T14:13:16.540

尽管这*是*一个 3D 数组，但最具可读性的解决方案通常是最好的（最好是一个主观的词，就某些属性而言，您应该说最好，而可读性通常是我的首选）。

如果内部循环中真的只有三个元素，并且你想强调有三列，你可以试试这个：

```
for (int i = 0; i < n; i++) { 
    for (int j = 0; j < n; j++) { 
        cube[i][j][0] = 0; 
        cube[i][j][1] = 0; 
        cube[i][j][2] = 0; 
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-14T16:40:17.840

好吧，你总是可以这样做：

```
Arrays.fill(cube[0][0],0);
Arrays.fill(cube[0],cube[0][0]);
Arrays.fill(cube,cube[0]); 
```

它比 3 个循环要干净一些。

如果你不明白，第一个“填充”会填充一个维度。第二个填充跨二维复制该一维。第三个填充跨三个维度复制两个维度。

如果您没有对需要保留的数组的其他引用，则按照其他人的建议重新创建它可能会更快、更干净。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-14T14:16:39.277

如果所有行的长度相同，您可以丢弃该数组并构建一个新数组，因为 int 元素的默认值为零。

```
cube = new int[cube.length][cube[0].length][cube[0][0].length]; 
```

或者你可以做

```
for(int[][] tda : cube ) {
  for(int[] oda : tda) {
    java.util.Arrays.fill(oda, 0);
  }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-17T20:15:57.760

只需创建一个新数组并将变量分配给它... GC 将清理旧数组

# version-control - 为带有版本控制的签入分配票号值得开发人员付出努力吗？

> ID：863519
> 
> 赞同：3
> 
> 时间：2009-05-14T14:07:34.540
> 
> 标签：version-control

我正在讨论的做法是：您的项目/产品有一个针对错误、功能等的票务系统。还有源代码控制。然而，似乎总有理由试图将这两者联系在一起。有些地方不想在没有票号的情况下办理登机手续。一些开发商店对每次签到都有一张票的要求比较宽松，并且会允许在没有附加票号的情况下进行一次或两次次要的签到。

**问题**：是什么让这个练习如此有用？

我在职业生涯的各个地方都看到过这种做法。这在 Microsoft 的 Team Foundation Server 等产品中尤为明显。我在 IBM 看到了 CMVC，他们自己开发的源代码管理系统。我见过 Mingle 和 SVN，或 SVN 和 Redmine，您可以通过简单地将票号放入提交消息中将票证与签入相关联。在所有这些地方，我真的没有发现它在我自己的工作中有用，所以我意识到它应该在某个地方有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T14:11:42.393

如果您在签到时有票号，则可以参考错误报告以查看进行编辑的原因。这通常与实际编辑本身一样重要，甚至更重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T15:44:42.937

我发现这样做最有用的方面是审查其他开发人员的提交时。存储库设置为为每个提交发送一封电子邮件，其中包括提交文本和差异。回顾这一点对于跟上中型项目的进展至关重要。

签入文本通常会解释*更改*的内容，但不会*解释原因*，如果需要，“票”可以填写您。

有时，问题跟踪器包含关于如何处理困难问题的冗长讨论，阅读它可以让您了解做出某些决定的原因。这是相当有价值的。

当然，这个的用处会因项目而异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T14:21:50.670

代替良好的需求规范或需求可追溯性，它非常方便。它在进行考古学以解释系统的当前状态时很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T14:44:56.980

它告诉你：

*   确实做了一些事情
*   谁负责
*   改变了什么
*   更改仅与缺陷有关
*   您以后可能会发现的任何回归
*   验证您的时间表（如果有）；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T14:12:41.020

我们这样做，但不是虔诚的。我们在内部使用 Trac，一旦您使该链接正常工作，您就可以查看工单并轻松查看为其执行的变更集。对于复杂的工单，这非常有用，尤其是在需要进行任何类型的代码审查时。

虽然这种做法确实让您了解为什么要提交更改的更多背景，但实际上我们发现我们并没有太多地使用它。但是很高兴拥有，您需要做的就是在提交消息中提及票号。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T14:13:44.090

有很多价值 - 无论您是提供商业支持，还是运行开源项目。如果您正在支持您的产品，并且有人打电话报告错误，您可以检查是否报告了错误，如果已经报告，是否有修复，测试等。在开源项目上，人们可能正在运行直接从源代码控制中提取的软件版本，如果有错误修复或他们想要的功能，他们可以检查问题跟踪器并确定它是否在更新的版本中得到修复。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T14:14:58.470

如果您可以将两者结合在一起，这可能会很有用，例如，如果您提供问题编号，我们有一个脚本可以获取提交消息并添加到错误跟踪票证中。它对管理人员和控制狂很有用，因此他们通过阅读消息而不是直接打扰开发人员来跟踪问题状态。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T14:38:19.227

告诉你是谁做了修复:o)

# ssl - DNS 重定向是否可以解决意外子域上的 SSL 证书错误？

> ID：863520
> 
> 赞同：1
> 
> 时间：2009-05-14T14:07:38.020
> 
> 标签：ssl

（类似于[这个问题](https://stackoverflow.com/questions/275178/catch-ssl-cert-request-error-so-as-to-redirect-to-the-correct-site/275210)，但有另一个转折）。

IIS 6，如果结果证明适用的话。

因此，我们获得了为 www.foo.com 签名的证书，当然，对 foo.com 的 HTTPS 请求会引发证书警告。一些问题：

*   为 foo.com 请求添加 DNS CNAME 以指向 www.foo.com 会解决问题吗？
*   如果没有，下一个最好的方法是什么？我已经看到通配符证书并将 SubjectAlternativeNames 添加到证书中。各有优缺点，还是两者都同样有效？
*   即使添加 DNS CNAME 会起作用，它是“正确”的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:19:29.927

DNS CNAME 不起作用——浏览器根据证书验证 URL 中给出的主机名，并且对是否通过跟随 CNAME 到其他地方来解析主机名不感兴趣。

我不确定 CA 是否发布了很多通配符证书，或者对它们的支持是什么。如果 CA 准备这样做，则可以选择使用 foo.com 作为 SubjectAlternativeName 创建证书。我认为浏览器对此的支持现在很普遍。

# c++ - 如果进程被 SIGKILLed，操作系统（POSIX）是否刷新内存映射文件？

> ID：863523
> 
> 赞同：14
> 
> 时间：2009-05-14T14:08:18.550
> 
> 标签：c++, c, linux, unix, posix

如果一个进程被 SIGKILL 杀死，它对内存映射文件所做的更改是否会刷新到磁盘？我假设如果操作系统确保在进程通过 SIGKILL 终止时将内存映射文件刷新到磁盘，那么它也会使用其他终止信号（SIGABRT、SIGSEGV 等）这样做。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-14T14:37:51.597

这将取决于内存映射文件是否以私有（MAP_PRIVATE）或不（MAP_SHARED）修改打开。如果是私有的，那么没有；修改不会写回磁盘。如果共享，内核缓冲池包含修改后的缓冲区，这些缓冲区将在适当的时候写入磁盘 - 无论死因如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-02T19:28:37.927

我自己提出了一个类似的问题，然后在我对答案不满意时跟进了演示代码。参见[mmap、msync 和 linux 进程终止](https://stackoverflow.com/questions/5902629/mmap-msync-and-linux-process-termination/5953213#5953213)

# javascript - Javascript 字符串比较 == 有时会失败

> ID：863524
> 
> 赞同：36
> 
> 时间：2009-05-14T14:08:32.823
> 
> 标签：javascript, string, compare

以下代码有时如何评估为假？

```
(transport.responseText == '1' || 
 transport.responseText == 'CARD_VALID') 
```

我的 JavaScript 代码：

```
if (transport.responseText == '1' || 
    transport.responseText == 'CARD_VALID') {
    // do something.
}
else if (transport.responseText == 'CARD_INVALID' || 
             transport.responseText == 'INVALID_CHECKSUM') {
    // do something else....
}
else {
    new Ajax.Request('/report_error.php?responseText='+transport.responseText);
    // report error to user
} 
```

当字符串相同时，什么可能导致 JavaScript 字符串比较`==`返回 false？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-09-26T14:18:09.387

双等号是比较 Javascript 中字符串的适当方法，它返回 false，然后一个字符串的左侧和或右侧可能有空格。

把 a`.trim()`放在字符串的末尾，我的比较应该开始工作了：

```
var panel = response.substr(0, response.indexOf("<")).trim();
if(panel == "combo"){
    //do something
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-11-10T09:30:49.390

我有一个类似的问题，两个明显相同的字符串不相等，我正在拔头发试图解决它，所以我这样做了：

```
for (var c=0; c<string_1.length; c++) {
    if (string_1.charCodeAt(c) != string_2.charCodeAt(c)) {
        alert('c:'+c+' '+string_1.charCodeAt(c)+'!='+string_2.charCodeAt(c));
        valid = false;
    }
} 
```

我发现一个字符串的最后一个字符是 10，而另一个字符串的最后一个字符是 13，我认为两个字符串都是空终止的，但事实并非如此。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-04-17T16:05:09.910

```
A1 = "speed"
A2 = "speed" 

if(A1 == A2)  => Error !!! 
```

在控制台中使用此测试：

```
escape("speed") 
```

> 结果：“速度”

```
escape(A1) 
```

> 结果："speed%0D" => 这是问题 %0D !!!

```
escape(A2) 
```

> 结果：“速度”=> 好的！！！

使用正确的代码：

```
if(A1.slice(0, -1) == A2) This is OK! 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-03-12T05:39:02.667

我有同样的问题，我注意到我正在比较两个对象

[![在此处输入图像描述](https://i.stack.imgur.com/2IpkN.png)](https://i.stack.imgur.com/2IpkN.png)

为了解决这个问题，我不得不使用

```
JSON.stringify(user._id) === JSON.stringify(userId) // true 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-11-10T09:38:36.353

尝试使用`===`精确匹配（类型和值）。这是 javascript 中推荐的比较运算符。

检查字符串的数据类型以确保，并在两个字符串中查找隐藏的 unicode 或控制字符。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-12-03T03:41:07.227

如果您想要一些不那么复杂的东西并且您正在处理数字值，请使用

```
parseFloat() 
```

奇迹般有效

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-04-11T15:38:41.070

我建议您最好使用[规范化](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize)“NFKC”或“NFKD”，因为它们似乎将非破坏空间规范化为常规空间。

因此，您可以将代码编写为：-

```
string1.normalize("NFKC") === string2.normalize("NFKC") 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-14T14:11:44.390

在输入该代码块之前尝试将 的值捕获`responseText`到不同的变量中，以防变量在那里的某处被更新。

我没有太多直接使用 XmlHttpRequest 的经验，但我知道 javascript 有很多地方使用对接口对象的易失性引用，这些引用在执行期间会发生变化，而不是简单的值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-06-02T14:59:25.937

Java servlet 可以发送字符串，即

out.println("CARD_VALID");

或者

out.print("CARD_VALID");

这些在 Javascript 中可能看起来相同，但在第一种情况下，末尾有空格。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-01-13T17:54:22.383

铸造对我有用

```
if (timeSlots[j].id + '' == product.timeSlots[k].id + '') {
} 
```

# asp.net - ASP.NET DataList - 所有文本框的 JavaScript 验证

> ID：863526
> 
> 赞同：1
> 
> 时间：2009-05-14T14:08:49.593
> 
> 标签：asp.net, javascript, validation, datalist

简单设置：数据列表形式的购物车。

标题有两个按钮：更新数量和删除所选项目

每个 DataList 项目（除其他外）都有一个 id="txtQty" 的文本框，用于存储购物车项目的数量。

用户应该能够更改这些文本框中的值，然后点击标题中的更新数量按钮以一次保存所有更改。

我已经完成了实际保存的逻辑，但现在我要回去添加一些额外的验证。我希望从 UpdateQuantities 按钮的 OnClientClick 事件中调用单个 JavaScript 函数，然后该函数将遍历所有 DataListItems，找到 txtQty 文本框，并确保它是有效的数字输入。

我很难找出解决这个问题的最佳方法。到目前为止，我唯一真正的想法是遍历表单元素并找到任何具有与“txtQty”匹配的 id 的内容（因为 ASP.NET 会自动重写 id），然后验证该特定元素。这听起来不是最好的解决方案。有没有更好的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T14:14:26.757

为什么不在 DataGrid 上放置一个验证器来检查数量是否是有效数字？这将是迄今为止最简单的。

如果这不是解决方案，我会让所有这些 txtQty 文本框都具有相同的 css 类。然后，您可以使用 JQuery 查找具有该类名的所有元素并遍历它们。这比遍历整个表单并检查元素的 id 是否在其 id 中包含“txtQty”要好得多。

另一种方法是有一个隐藏字段，其中包含您要检查的文本框的所有 ID。您将在添加文本框时添加到此隐藏字段。然后只需打破 id 数组中的隐藏字段，并找到那些 id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T13:48:24.860

我最终使用了一些 LongHorn 的方法来获得我想要的结果。使用自定义验证器，我使用它的客户端验证功能来调用一个 JS 函数，该函数检查文本更改事件中的单个文本框。

这不是我理想的解决方案，但它很有用。在进行任何处理之前，我还会对整个列表进行服务器端验证，以防万一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T14:17:30.163

重复的身份证真的不是一件好事。您可以尝试为文本框分配一个类 - “验证数量”会很好，因为您可以应用多个类作为验证规则。

```
<input type="textbox" class="validate-quantity validate-min" /> 
```

这样，您可以遍历表单以查找您的验证规则，而不是针对特定的文本框。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T13:58:12.653

为什么不将验证添加为每个文本框的 onchange 事件的属性。当他们进行更改时，您最好进行验证。

您可以添加验证控件或滚动您自己的控件。

# udp - 234.xxx IP 地址 - 它是什么

> ID：863530
> 
> 赞同：1
> 
> 时间：2009-05-14T14:09:20.137
> 
> 标签：udp, ip-address, multicast

我过去做过很多 UDP 套接字编程，但只听说过通常的保留 IP：

*   127.0.0.1
*   192.168.xx
*   10.xxx

但是从 IP2Location 它说多播。234.5.5.1**是**实际 IP 地址还是保留的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T14:11:11.630

查看： [维基百科 - IP 多播](http://en.wikipedia.org/wiki/IP_Multicast)

特别是寻址部分。

# sql-server - 如何在 PATINDEX 模式参数中转义下划线字符？

> ID：863534
> 
> 赞同：73
> 
> 时间：2009-05-14T14:09:38.327
> 
> 标签：sql-server, regex, tsql, escaping, sql-like

我找到了使用 PATINDEX 查找下划线位置的解决方案：

```
DECLARE @a VARCHAR(10)  
SET     @a = '37_21'

PRINT PATINDEX('%_%', @a)                    -- return 1 (false)
PRINT PATINDEX('%!%', REPLACE(@a, '_', '!')) -- return 3 (correct) 
```

你有其他想法吗？喜欢逃避下划线字符的方法吗？

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-05-14T14:14:36.943

我总是用括号来做：`'%[_]%'`

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-12-18T15:14:11.593

要匹配两个下划线，每个下划线都必须用括号括起来

```
'%[__]%' -- matches single _ with anything after

'%[_][_]%' -- matches two consecutive _ 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-04-11T19:11:52.287

`[`您可以使用和`]`字符转义，如下所示：

`PRINT PATINDEX('%[_]%', '37_21')`

# c# - Linq 在 select 子句中评估 Nullable 类型

> ID：863535
> 
> 赞同：1
> 
> 时间：2009-05-14T14:09:42.883
> 
> 标签：c#, linq-to-entities

我得到一个奇怪的例外：`"Unknown Expression type: IIF(e.Accredited.Value, 1, 0)"` 运行以下语句：

```
var x = from e in _EntityManager.TrainingCourses
            select new { Disabled = (e.Accredited.Value ? 1 : 0) }; 
```

请帮忙！！如何在选择中评估（布尔？）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T14:52:53.153

这段代码能回答你的问题吗？明确检查 bool 值似乎可以解决问题：

```
void Main()
{

    var a = new List<acc>() { 
        new acc(){Accredited = false}, 
        new acc(){Accredited = true}, 
        new acc(){Accredited = null}
        };

    var x = from e in a
        select new { Disabled = (e.Accredited == true ? 1 : 0) };

    foreach (var i in x)
    {
        Console.WriteLine(i);
    }
}
public struct acc
    {
       public bool? Accredited;
    } 
```

输出：0 1 0

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T14:14:11.983

假设`e.Accredited`是`Nullable<bool>`( `bool?`)，试试这个：

```
var x = from e in _EntityManager.TrainingCourses
        select new { Disabled = (e.Accredited.HasValue && e.Accredited.Value) }; 
```

# asp.net - ASP.Net 错误：“应用程序池的标识无效”

> ID：863537
> 
> 赞同：41
> 
> 时间：2009-05-14T14:10:11.367
> 
> 标签：asp.net

我的 ASP.Net Web 服务无法运行，因为应用程序池由于遇到身份危机而无法启动。

我在应用程序池中使用的用户是域用户，它是本地管理员，它在 IIS_WPG 中，我已经给它“作为操作系统权限的一部分” - 什么都没有。纳达。每次启动应用程序池失败。

将用户添加到 IIS_WPG 通常是缺少的，但我想还有别的东西。

我尝试过的事情：

*   将用户添加到 IIS_WPG
*   将用户添加到本地管理员组并添加“作为操作系统的一部分”权限。
*   aspnet_regiis -ga
*   重新启动...
*   检查密码
*   重新创建应用程序池并仅将我的应用程序分配给它

ps 如果我使用网络服务用户，一切正常 - 只是我的“自定义”用户失败了。使用该用户登录（交互式）有效。

**编辑：**

该解决方案如[接受的答案中所述](https://stackoverflow.com/questions/863537/asp-net-error-the-identity-of-application-pool-is-invalid/954650#954650)（将“作为服务登录”权限添加到应用程序池的身份用户）。

我将添加一些在尝试向域用户添加“作为服务登录”权限时遇到以下消息的人，以供将来参考：

> “此设置与运行 Windows 2000 Service Pack 1 或更早版本的计算机不兼容......”

要知道*这与 Windows 2000 无关，*只是域的组策略阻止您将此权限分配给用户。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-06-05T07:28:19.657

您是否为该帐户启用了“作为服务登录”？

开始 -> 控制面板 -> 管理工具 -> 本地安全策略 -> 本地策略 -> 用户权限分配 -> 作为服务登录

（确保您的帐户直接或间接在此列表中；还建议您设置：从网络访问此计算机；拒绝本地登录；作为批处理作业登录）

此外 - 确保该帐户对支持网站/应用程序的文件系统具有“读取和执行”、“列出文件夹内容”和“读取”访问权限。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-14T14:23:31.977

尝试在文件夹中运行以下命令`C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727`：

```
aspnet_regiis -ga <your_app_pool_user> 
```

有关配置用户帐户以用作应用程序池身份的更多信息，请参阅以下文章：

[如何：为 ASP.NET 2.0 应用程序 (MSDN) 创建服务帐户](http://msdn.microsoft.com/en-us/library/ms998297.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-05T08:40:23.943

确保有一个名为 c:\inetpub\temp\apppools 的文件夹。如果没有，请创建它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-16T18:03:49.480

确保尝试访问应用程序池的用户帐户是`IIS_USRS`AD 中组的成员。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T14:15:23.993

发生的情况是，您可能正在使用不同版本的 .NET 框架运行应用程序的池中运行您的应用程序。确保该池中的所有应用程序都运行相同的版本。如果这些应用程序必须在与此版本不同的版本下运行，请创建一个新池并将您的应用程序添加到其中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T14:15:43.617

我知道这很简单，但是您检查过密码是否正确吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-21T08:55:52.103

以前遇到过这个问题，但无法追踪我同情的原因！一些可能有帮助的建议：

*   检查密码是否正确（抱歉不得不说）
*   使用没有其他网站正在运行的新应用程序池
*   确保您已运行 aspnet_regiis -ga 以设置所需的权限

如果一切都失败了： - 停止应用程序并删除应用程序池 - 删除用户 - 重新创建用户 - 运行 aspnet_regiis -ga - 设置在此用户下运行的新应用程序池 - 在此池下运行站点复制和粘贴我使用的复杂密码对我有用！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-05T21:07:24.470

您是否有将帐户从 iis_wpg 组中拉出的组策略？当出于某种原因需要在自定义帐户下运行工作进程或服务时，我们经常会遇到此（或类似）问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-09T22:24:52.620

应用程序池用户帐户可能被锁定。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-13T15:58:53.287

发生这种情况的另一种方式是，如果您有 CGI 脚本。默认情况下，CGI 脚本以访问网站的 Windows 用户身份运行。为了在特定帐户下运行您的 CGI 脚本，您需要一个额外的步骤：

**IIS 7+**

转到inetmgr.exe 中网站配置中的CGI 部分。将模拟设置为 false。

**IIS 6**

以管理员身份运行这些命令：

```
cd \inetpub\adminscripts
cscript.exe Adsutil.vbs SET W3Svc/CreateProcessAsUser false 
```

下一步：让您的 IT 部门升级您的所有 WS2003 机器...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-07-15T18:17:48.817

在遵循所有其他建议之后：

1.  检查“作为服务登录”和“作为批处理作业登录”权限
2.  检查文件夹权限，c:\Windows\system32\inetsrv 等。
3.  在 Metabase Explorer 检查 IIS_WPG 组的权限

记得重启 IIS 管理服务！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-02T13:03:13.347

另一个值得一提的小事可能是，如果它是由管理员创建的新用户帐户，则可能会应用默认策略，例如“在首次登录时更改密码”。如果是这种情况并且尚未发生登录，这也将有效地阻止用户帐户运行您的服务。

这不适用于 OP 的案例，因为他提到他可以使用该帐户以交互方式登录，但我今天遇到了这个问题，其他人也可能遇到。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-08-19T11:37:28.370

在我的情况下，问题是我试图使用域帐户，而域控制器与我的机器有问题。我刚刚使用较新版本的 Windows（Windows 10）创建了一个新 VM，并要求域管理员将其添加到域中，但我保留了与其他机器上相同的主机名。

此外，在事件查看器中，我发现了有关域控制器等的错误消息，这给了我一个线索。

我不得不从域中删除机器并重新添加它，问题就解决了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-12-07T20:39:24.920

发布一个简单的完整答案，因为我遇到了同样的错误，但为我解决的问题是在设置身份时将域包含在用户名中。该用户是有效的域用户和服务器用户，我手动将其添加到 IIS_ 组中，但在尝试添加域作为前缀之前没有任何问题，例如“us\svc-myAccount”。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-08-24T09:00:01.367

在尝试了以上所有方法但没有任何效果后，我注意到事件日志错误中的事件数据为 80070700。谷歌搜索此错误产生“尝试登录，但未启动网络登录服务”。

我发现 NetLogon 服务没有启动，启动它然后宾果游戏——它突然出现了。希望有一天这对其他人有所帮助

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-02-27T16:35:24.517

我遇到了同样的问题并与之抗争了很长一段时间。在尝试了许多不同的解决方案后，我卸载并重新安装了 IIS。重新启动服务器后，一切都已修复。

# c# - C# 中的实例大小

> ID：863540
> 
> 赞同：2
> 
> 时间：2009-05-14T14:10:34.440
> 
> 标签：c#, .net, optimization, memory, size

有没有办法在 C# 中获取实例（或我不介意的类）的大小？

例如，我知道在 Delphi 中，每个对象都有一个指向类的虚拟方法表的指针，它实现的每个接口的指针，当然还有类的字段。

根据[这个](https://stackoverflow.com/questions/631825/net-object-size/631834#631834)基本对象大小在 x86 中是 12 字节，但是，是否有任何“规则”来正确调整它的大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T14:12:42.157

这取决于您要做什么。如果您有兴趣了解类型/对象的大小以便与本机代码互操作，您可以使用 Marshal.SizeOf()。除此之外，没有确定的方法来测量物体的大小。

# .net - WCF 中的 REST -- PUT 和 DELETE 返回“禁止”

> ID：863545
> 
> 赞同：2
> 
> 时间：2009-05-14T14:11:18.043
> 
> 标签：.net, wcf, rest

我在 WCF 中创建了一个 REST Web 服务，它最初使用 POST 来执行任何插入和删除。出于好奇，我决定将插入更改为 PUT，将删除更改为 DELETE。虽然这在我的本地机器上运行良好（使用内置的 VS2008 网络服务器），但在尝试针对部署在其他地方的实际服务器时出现此错误：

```
客户端身份验证方案“匿名”禁止 HTTP 请求。
```

我是否需要做一些事情来专门允许服务器上的 PUT 和 DELETE（通过 web.config 或通过 IIS 中的配置），或者我是否需要以某种方式将我的凭据传递给我的 HttpClient 以便它可以将自己标识为某事除了匿名？

不幸的是，PUT 和 DELETE 是非常常见的词，所以在过去的一个小时里搜索谷歌并没有产生太多有用的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T14:17:04.177

您可能需要检查是否允许在 IIS 中使用这些动词或“所有动词”，如果没有，您可以轻松地输入它们。同样要成为真正的 REST，您可能必须配置 IIS 以通过所有虚拟路径传递到您的应用程序。检查它们是否实际存在。

# asp.net - 导致 PostBack 与 PopUp 不同的页面

> ID：863550
> 
> 赞同：2
> 
> 时间：2009-05-14T14:12:38.397
> 
> 标签：asp.net, javascript, popup, postback

我有一个主页和一个详细信息页面。

详细信息页面是从主页调用的 javascript 弹出窗口。

在详细信息页面上单击“保存”按钮时，我希望主页“刷新”。

是否有一种方法可以调用回发到主页，同时还保持从详细信息页面保存回发？

**编辑**- 使用 window.opener.location.reload(true) 确实有效，但它会提示用户重新发送信息。这个'do​​cument.location.href = document.location.href;' 也不起作用，因为它会清除主页上的表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-12T00:20:27.393

对于无更新面板的解决方案，您可以让弹出窗口将值返回到文本字段，并在更改时使该文本字段回发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T14:20:03.700

我建议对详细信息页面使用模式弹出窗口，而不是通过 javascript 打开另一个窗口。这将允许您将所有内容保存在同一页面上，并为您提供更多控制权

考虑到您目前的情况，我认为您正朝着正确的方向前进。试试这个，看看它是否符合您的需求。

```
window.opener.location.href='http://redirect.address'; 
```

[这](https://stackoverflow.com/questions/613079/popup-browser-back-to-parent-browser-after-a-certain-page-is-reached)是一个类似的问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-13T22:15:48.877

If you need to refresh the page and keep the form data without resubmitting the POST, you may be able (depending of the size and complexity of your form data) to build a representation of the form state in JavaScript, store it in a cookie or the querystring, refresh the page by setting document.location.href, and then reload the data when the window loads.

Below is a rough version of this idea. This code along, with an onload wire-up, would go in the opener (the cookie handling methods would also need added). window.opener.refreshWithState() would be called from the popup.

(this version depends on inputs having unique IDs)

```
(function() {
  window.refreshWithState = function() {
    setCookie("state", buildState());
    document.location.href = document.location.href;
  };

  function handleWindowLoad() {
    var state = readCookie("state");
    if (state) {
      restoreState(state);
      eraseCookie("state");
    }
  }

  function buildState() {
    var i, elem, elems, key, val, stateParts = [];

    elems = document.getElementsByTagName('INPUT');
    for (i = 0; elem = elems[i]; i++) {
      switch (elem.type) {
        case "checkbox":
        case "radio":
          val = elem.checked ? 1 : "";
          break;
        case "text":
        case "hidden":
        case "file":
          val = escape(elem.value);
          break;
        default:
          continue;
      }
      stateParts.push('"' + escape(elem.id) + '":"' + val + '"');
    }

    elems = document.getElementsByTagName('SELECT');
    for (i = 0; elem = elems[i]; i++) {
      stateParts.push('"' + escape(elem.id) + '":"' + elem.selectedIndex + '"');
    }

    return '{' + stateParts.join(',') + '}';
  }

  function restoreState(state) {
    var key, elem, val;
    var stateObj = eval('(' + state + ')');

    for (key in stateObj) {
      elem = document.getElementById(unescape(key));
      if (!elem) {
        continue;
      }
      val = stateObj[key];
      if (elem.tagName == "SELECT") {
        elem.selectedIndex = val;
      }
      else if (elem.tagName == "INPUT") {
        switch (elem.type) {
          case "checkbox":
          case "radio":
            elem.checked = !!val;
            break;
          case "text":
          case "hidden":
          case "file":
            elem.value = unescape(val);
        }
      }
    }
  }
})(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-12T00:17:41.470

我知道你说你需要回发，但我会提出这个建议......

我会在主页上放置一个 ajax 更新面板，然后允许详细信息弹出窗口对其进行更新。我不确定你对 microsoft ajax 和 ajax 控制工具包有多喜欢，但那将是我的第一种方法。

显然我不知道全部范围，但我没有看到页面要求用户重新提交数据消失和页面更新没有某种基于 JavaScript 的解决方案的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T14:16:00.887

是的，您应该可以在详细信息页面的链接上执行 target="_parent"。您必须将一个事件绑定到该事件上才能关闭详细信息页面，但应该可以帮助您入门。

例如： `<a href="mainPage.html" target="_parent">Save Details</a>`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T14:18:52.283

您可以使用一些带有[window.opener](http://elezeta.net/2005/04/06/windowopener-javascript-para-mozilla/)的 javascript 从弹出窗口访问父窗口。例如，您可以从那里使用 location.href 来刷新父页面。:)

# windows - 在批处理文件中，如何删除不是某种类型的所有文件

> ID：863552
> 
> 赞同：1
> 
> 时间：2009-05-14T14:12:39.210
> 
> 标签：windows, batch-file, cmd, dos

我正在编写一个批处理文件，该文件需要删除某个目录中的所有文件及其所有子目录，但特定类型的文件**除外。**

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-18T15:44:42.293

在一位同事请求帮助删除文件夹和所有子文件夹中某些类型的文件除外的所有文件，同时保持目录结构后，我编写了这个批处理文件。我建议在尝试此操作之前备份您的文件夹。只需打开记事本并粘贴以下内容，将其保存为 .bat 而不是 .txt 祝你好运！〜卡罗琳

```
REM Use at your own risk, it does a mass DELETE of everything!

SET /p ExcludeFiles=What file type should be kept (NOT deleted)? Type the file name(s) inside parantheses. example: (pdf) or (shp dbf shx)     
SET /p MapDrive=What drive letter is the folder in? example: c or n     
SET /p Directory=Drag the folder you would like to modify into this command prompt then press ENTER.     

%MapDrive%:
cd %Directory%

attrib +a *.* /s
echo %date%
for %%i in %ExcludeFiles% do attrib -a *.%%i /s
echo %date%
del %Directory%\*.* /s /a:a /q

echo %date%
attrib +a %Directory%\*.* /s
echo %date% 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-25T10:40:20.233

我正在使用此处找到的解决方案： [如何删除除 DOS 中的某些文件之外的所有文件/子目录？](https://stackoverflow.com/questions/558648/how-can-i-delete-all-files-subdirs-except-for-some-files-in-dos/558662)

搏一搏 ：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T14:23:12.647

你可以尝试一些类似的东西

```
for /f "usebackq delims=" %i in (`dir /s /b *`) do if not %~xi==.txt del %i 
```

对于评论中的问题，您可以尝试以下操作：

```
robocopy source_folder target_folder *.java /s 
```

或者

```
xcopy *.java target_folder /s 
```

它保留目录结构但只复制`.java`文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T14:33:35.337

最安全的方法是复制您想要的所有文件并删除其余文件。
XCOPY *.java c:\new_directory /s

/s 复制子目录

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-01T03:54:27.237

你可以试试这个：

```
ECHO DIR %address% /S /B | FIND /C %theType%>temptemp.txt
FOR /f %%a IN (temptemp.txt) DO DEL %%a
DEL temptemp.txt 
```

变量 address 是目录，变量 theType 是您不想删除的类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T14:23:52.270

尝试[在这里](http://www.computerhope.com/delhlp.htm)研究。

尽管它不能准确地告诉您您的要求，但我会说这是一个很好的起点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-03T18:32:14.727

```
FORFILES /s /p c:\dir /c "if not @ext==.txt del /f @file" 
```

# java - 将动态小部件添加到面板 (GWT)

> ID：863556
> 
> 赞同：1
> 
> 时间：2009-05-14T14:13:06.087
> 
> 标签：java, gwt, onclick

我在向面板添加可变数量的标签时遇到问题。我的问题是，由于某种原因，添加我的`ClickListener`它返回`void`而不是小部件（错误）。如果我只有“新标签（'xyz'）”可以正常工作，但我需要每个面板也有自己的`ClickListener`。这是代码：

```
for (int x = 0; x < productIDArray.length(); x++) {
  mainPanel.add(new Label("Test").addClickListener(new ClickListener() {
    @Override
    public void onClick(Widget sender) {
      // TODO Auto-generated method stub
    }
  }));
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T15:02:07.047

方法链接的返回值始终是最后一个值。如果更改 new `A().b().c()`，返回的类型将是 c 的返回类型。

在您的示例中，返回类型`new Label("Test").addClickListener(...`是 ClickListener 的 addClickListener 返回类型，它是 void。

您可以创建标签，添加点击侦听器，然后添加它：

```
for(int x = 0;x<productIDArray.length();x++) {
  Label l = new Label("Test);
  l.addClickListener(...);
  mainPanel.add(l);
 } 
```

# driver - 如何让我的驱动程序 WHQL 为 Vista 64 签名？

> ID：863565
> 
> 赞同：1
> 
> 时间：2009-05-14T14:14:33.573
> 
> 标签：driver, device-driver, signing

我有一个驱动程序，我的公司已经为我们的客户使用了几年。在 Vista 64 下无法再安装驱动程序。我认为我需要对驱动程序进行签名，但我不确定如何开始。

*   最好的起点是什么？
*   这通常需要多长时间？
*   我需要向 Microsoft 发送什么？
*   有第三方愿意为我们做这一切吗？
*   这个过程（有或没有第三方）通常需要多少费用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T14:47:40.687

您首先阅读[WindowsLogo](http://www.microsoft.com/whdc/winlogo/default.mspx)网站上的所有内容。

尽管实际上 Vista 64 拒绝加载未签名的驱动程序，而不是非 WHQL 驱动程序，但暗示购买软件签名证书并对可执行文件进行签名就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T13:28:46.940

以下是 Microsoft 白皮书中有关驱动程序签名所需步骤的链接： [内核模式代码签名白皮书](http://www.microsoft.com/whdc/winlogo/drvsign/kmcs_walkthrough.mspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T14:35:24.193

虽然它绕过了这个问题，但您可以通过从引导加载程序向 Windows 内核传递一个选项来禁用驱动程序签名的要求。

您通常会使用 bcdedit，这是一个用于编辑引导数据存储的 Windows 命令行工具（因为旧的 bo​​ot.ini 文件在 Windows XP 之后被转储）。

从管理命令提示符尝试以下操作（如果您启用了 UAC，点击开始，键入 cmd，按住 CTRL+SHIFT 并按 Enter 以管理员身份启动 cmd）：

```
bcdedit /set loadoptions DDISABLE_INTEGRITY_CHECKS 
```

**编辑：**

您还可以通过修改本地组策略设置来实现类似的效果：

```
1\. Start > gpedit.msc > User settings > System > Driver Installation
2\. Set the 'Code Signing for drivers' setting to Enabled + Warn or Ignore 
```

希望有帮助！

# c# - 在 .NET 中用文本块初始化字符串的语法是什么？

> ID：863572
> 
> 赞同：2
> 
> 时间：2009-05-14T14:15:19.810
> 
> 标签：c#, .net, text

我正在编写一个单元测试，但不记得用大块格式化文本初始化字符串的语法。

```
string _testData = "a couple screens worth of text data here
and I need to preserve the formatting
such as line breaks,
etc."; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-14T14:15:58.873

`@`在文字前添加一个。

```
string _testData = @"a couple screens worth of text data here
and I need to preserve the formatting
such as line breaks,
etc."; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-14T14:16:41.993

使用 @ 文字来表示字符串类型。

```
string _testData = @"a couple screens worth of text data here
and I need to preserve the formatting
such as line breaks,
etc."; 
```

来自[MSDN](http://msdn.microsoft.com/en-us/library/362314fe.aspx)：“逐字字符串文字以 @ 开头，也用双引号括起来。逐字字符串的优点是不处理转义序列，这使得编写起来很容易，例如，完全限定的文件名。要包括@-quoted 字符串中的双引号，将其加倍。"

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T14:18:38.633

正如其他人所说，这是

```
 string _testData = @"a couple screens worth of text data here
and I need to preserve the formatting
such as line breaks,
etc."; 
```

这称为*逐字字符串文字*。另一个效果是反斜杠不再用于转义任何内容 - 这使得它对正则表达式和 Windows 文件路径很有用。

双引号是通过加倍实现的。例如`x"y`输入一个字符串：

```
string verbatim = @"x""y";
string regular = "x\"y"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T14:19:27.523

与其用静态的、格式化的文本使代码混乱，不如创建一个文件资源，让应用程序从内存中读取和存储。这样，如果您需要更改它或以不同的方式格式化，您可以进行更改而无需进一步接触和弄乱您的代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T14:31:07.403

我同意 Wayne Hartman - 只需将大文本存储为文本文件并将其读入字符串以进行测试，例如：

```
 string testData = File.ReadAllText(fileToRead);
    //Unit test using the testData 
```

这里实际上没有任何逻辑会妨碍您的其余测试。单元测试仍然关注您的功能，它只是使用文本文件方便地存储大字符串。

# winapi - 通知图标消息不会打动 MsgWaitForMultipleObjectsEx

> ID：863574
> 
> 赞同：0
> 
> 时间：2009-05-14T14:15:32.573
> 
> 标签：winapi, notifyicon

我正在使用`MsgWaitForMultipleObjectsEx()`我的消息循环，并`Shell_NotifyIcon`创建托盘图标。

这是交易：每当托盘图标向其所有者窗口发送消息时，窗口不会立即接收消息，而是会排队等待任何其他类型的消息到达（`WM_MOUSEMOVE`例如）。

似乎托盘图标中的消息由于某种原因不会`MsgWaitForMultipleObjectsEx()`退出等待状态，尽管我`MsgWaitForMultipleObjectsEx()`用`QS_ALLEVENTS`唤醒面具打电话。

我使用`WM_USER`+ ... for `NOTIFYICONDATA::uCallbackMessage`，并且我还尝试使用“具体”值（`WM_MOVE`,...）来代替。没有帮助。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T10:48:39.027

您没有尝试过使用 QS_ALLINPUT 而不是 QS_ALLEVENTS 吗？

# c++ - 在 Windows C/C++ 中使用半字节（4 位变量）

> ID：863575
> 
> 赞同：20
> 
> 时间：2009-05-14T14:15:41.153
> 
> 标签：c++, c, windows, types

我正在编写网络标头，许多协议使用 4 位字段。有没有一种方便的类型可以用来表示这些信息？

我发现的最小类型是 BYTE。然后，我必须使用大量二进制操作来仅引用该变量中的几个位。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-14T14:21:18.283

由于内存是字节寻址的，因此您不能寻址任何小于单个字节的单元。但是，您可以构建`struct`要通过网络发送的内容并使用如下[**位字段**](http://msdn.microsoft.com/en-us/library/ewwyfdbe(VS.71).aspx)：

```
struct A {
   unsigned int nibble1 : 4;
   unsigned int nibble2 : 4;
}; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-14T14:29:37.453

扩展 Mehrdads 的答案，还使用带字节的联合以避免一些看起来邪恶的演员表：

```
union Nibbler {
     struct { 
        unsigned int first:4;
        unsigned int second:4;
     } nibbles;
     unsigned char byte_value;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-14T15:03:27.200

`struct`每个人似乎都喜欢为此使用 s 中的位域。就个人而言，我将我所有的数据包代码都包装在对象中，这样你就看不到胆量了。我发现在协议代码中使用位域的问题是它鼓励使用结构作为内存上的覆盖。您可以安全地执行此操作，但您必须非常小心，以确保正确处理字节序和打包问题。除非您真的有充分的理由（例如，您正在编写从内存映射 IO 区域接收以太网数据包的代码），否则使用覆盖在内存上的位域会产生极其脆弱的代码恕我直言。

`Packet`我发现编写一个实现各种位宽的提取、插入和覆盖例程的类要容易得多。然后，根据从偏移量中提取某些宽度的值到本机整数等方面来实现数据包处理代码。隐藏抽象背后的所有字节序和打包问题，直到分析证明开销太大而无法承受。

这是我希望我多年前学到的那些教训之一……您可能认为代码的可移植性不是问题，字节序也不是问题。相信我，当你的编译器改变它的填充算法或者你切换到不同的编译器时，这会给你带来很多麻烦，这会让你相信覆盖对于网络数据包处理代码来说是一个*非常糟糕的主意。*

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-14T14:26:46.507

在结构中使用字段：

```
struct Header
{
    unsigned int lowestNibble : 4;
    unsigned int anotherNibble : 4;
    unsigned int : 18;                 # Unnamed padding.
    bool aBool : 1;
    bool anotherBool : 1;
    unsigned int highestNibble : 4;
}; 
```

`: 4`指示条目应占用 4 位。您可以使用任意数量的位。您可以使用任何您喜欢的内置类型。

通常，您最终会将指向数据的指针转换为`Header *`然后执行以下操作：

```
pHeader->lowestNibble = 5; 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-14T14:19:15.917

不，没有方便的类型。但是，使用宏或模板函数很容易制作它们。如果/当您需要处理字节序时，这尤其适用。

福特克

# c# - HowTo：突出显示 UltraTree 中的选定节点

> ID：863580
> 
> 赞同：4
> 
> 时间：2009-05-14T14:16:05.580
> 
> 标签：c#, infragistics, ultratree

我有一个 UltraTree 控件，它选择要在 UltraTabControl 中显示的页面。我正在捕捉一个事件并找出我想要选择的树中的哪个节点。这一切正常，只有一件（视觉）事情不会：激活的节点没有在 UltraTree 中突出显示？

这就是我正在做的

```
pageTree.ActiveNode = pageTree.Nodes[tab.Key];
pageTree.ActiveNode.Selected = true;
// raise an selection-event, so the right tab gets displayed
pageTree.Select(); 
```

实际上我假设，当我调用 select() 时，我的节点也会被突出显示（我的意思是它周围的蓝色选择框）。

它可能是一个非常简单的问题，但我现在尝试了很多属性和方法，但仍然没有成功。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T19:11:57.870

这应该对您有用（在设置 Selected 之前设置）...

```
pageTree.HideSelection = false; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T18:59:23.480

试试看[这里：](http://help.infragistics.com/Help/NetAdvantage/WinForms/2009.1/CLR2.0/html/infragistics2.Win.UltraWinTree.v9.1~Infragistics.Win.UltraWinTree.Override~SelectedNodeAppearance.html)

```
 Infragistics.Win.UltraWinTree.Override ovr;

       // Get the tree's Override property so we can
       // set the default for all nodes.
       ovr = this.ultraTree1.Override;

       // Turn hot tracking on
       ovr.HotTracking = DefaultableBoolean.True;

       // Set the borderstyle to solid but the border color
       // to trasnparent so the borders don't show by default.
       ovr.BorderStyleNode = UIElementBorderStyle.Solid;
       ovr.NodeAppearance.BorderColor = Color.Transparent;

       // Set default border colors for active, expanded,
       // hot tracked and selected nodes.
       ovr.ActiveNodeAppearance.BorderColor = Color.Red;
       ovr.ExpandedNodeAppearance.BorderColor = Color.Magenta;
       ovr.HotTrackingNodeAppearance.BorderColor = Color.Blue;
       ovr.SelectedNodeAppearance.BorderColor = Color.Black; 
```

您可能遇到的另一个问题是`UltraTree`控件未启用。

# c# - 在 Visual Studio 中的项目之间复制 winform

> ID：863582
> 
> 赞同：40
> 
> 时间：2009-05-14T14:16:27.547
> 
> 标签：c#, visual-studio, winforms

在 Visual Studio 的解决方案中将表单从一个项目复制或剪切/粘贴到另一个项目的最佳方法是什么？

每当我尝试使用解决方案资源管理器（拖放或右键单击剪切和粘贴）时，它只会复制底层 C# 代码，而不是帮助您通过表单设计器可视化表单的必要“点点滴滴”。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-09-27T22:29:10.313

1.  将三个文件 、、`.cs`复制到目标解决方案文件夹。`.designer``resx`
2.  在目标项目中，`Add existing item`首先选择并添加设计器文件。
3.  修改命名空间属性。该`.cs`文件也应该进来。
4.  修改`.cs`文件中的命名空间。
5.  使用 .添加`resx`文件`Add existing item`。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-06-05T18:16:36.893

要将表单从一个 VS2013 项目复制到另一个，最简单的（最少的鼠标点击）是：

1.  在您的目标项目中，右键单击您的父文件夹（可能是您的项目），然后在菜单中选择“添加；现有项目”。

2.  然后在源项目中选择表单的cs文件。例如选择 Form.cs（不是 Form.Designer.cs 或 Form.resx）。

3.  在您的目标项目中打开 Form.cs 并更改命名空间（所有实例）。

4.  关闭并重新打开 Form.cs，您将看到所有控件等。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-14T14:37:48.370

想通了-知道这将是愚蠢的。

显然目标项目应该有参考：

*   System.Windows.Forms
*   系统绘图

在您进行任何复制或粘贴之前首先包含在项目中，否则您将遇到我描述的问题。

感谢任何试图帮助 BTW 的人。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-11-18T19:40:33.853

现在在 2012 年更容易了。只需转到文件 > 添加 > 现有项目 > 将表单拖放到要添加到的项目中。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-09-04T03:36:42.587

我在 Visual Studio 2012 中尝试了以下过程，并且成功了。

1.  通过右键单击解决方案 > 添加 > 现有项目菜单，将要从中导入表单的项目添加到解决方案中。选择项目并单击确定。
2.  现在右键单击要复制的表格，选择复制。
3.  右键单击要复制的项目并选择粘贴。
4.  表单将被复制到您的项目中，现在重命名命名空间。
5.  从解决方案中删除您在步骤 1 中添加的项目。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-14T14:25:52.093

确保您不仅复制了 Form.cs，还复制了 Form.designer.cs 和 Form.resx 文件。

但我需要问一下，为什么您要在同一个解决方案的多个项目中维护同一个表单的副本。听起来好像您可能想概括其中的代码，将其放入类库并在适用的地方重新使用它。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-14T14:33:26.943

使用[ReSharper](http://www.jetbrains.com/resharper/)（获取演示），在 Code View 中右键单击该类，Refactor->Move，然后将其移动到另一个项目。

额外的好处是，如果您通过在项目之间移动命名空间来更改命名空间，它将自动更新所有引用。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-12-21T13:16:28.780

如果你想在同一台机器上成型，那么你可以这样做。

在解决方案资源管理器**项目**-->**添加**-->**添加现有项目**。

从源目录中仅选择 .cs`(Sample.cs)`文件并刷新当前解决方案资源管理器它将工作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-12-08T15:33:15.187

我终于想通了以下几点：

1) 复制您想要的表格的 3 个文件，其文件扩展名为`.cs`, `.resx`, `.Designer.cs`.
2）添加现有并选择`formName.cs`。
3) 检查添加的表单的命名空间和名称属性值。
4) 在`Program.cs`文件中，使用并 `using NameSpace;`替换`new NameSpace.formName()`.`Application.Run()`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-07-25T11:41:57.663

对于 Visual Studio V.12，这是唯一对我有用的方法（它是上述条目的混合）：

*   通过文件资源管理器复制组成表单的三个文件。
*   在 Visual Studio 解决方案资源管理器的顶部栏中，打开“显示所有文件”。
*   file.cs 文件显示为灰色。单击右键并选择：“包含在项目中”。解决方案资源管理器会自动链接三个文件（.cs 文件下的 .designer 和 .resx）。file.cs 将图标从 c++ 更改为表单图标。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-12-06T09:05:15.437

我正在使用 Visual Studio 2010，以下是我执行的步骤：

1.  将所有 3 个文件（.cs、.resx、.Designer.cs）复制到目标项目文件夹中。
2.  在 Visual Studio 中，右键单击**项目**->**添加**->**现有项...**
3.  选择所有 3 个文件（.cs、.resx、.Designer.cs），单击**Add**。
4.  更改 2 个文件（.cs、.Designer.cs）上的命名空间，如果它是目标项目上的不同命名空间。
5.  运行项目。
6.  完毕！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-14T14:18:42.207

您是选择文件，还是使用设计器“复制”所有控件？在解决方案资源管理器中选择`YourForm.cs`文件并通过复制粘贴或拖放将其复制到您的其他项目应该可以满足您的需求。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-01-23T11:50:53.193

** 这个对我有用：

1) 将源文件（.cs 或 vb、.designer、.resx）复制到目标文件夹

2）在目标解决方案中显示隐藏文件

3) 选择这些文件并将它们包含到项目中。

这将干净地添加 winform 或任何其他部分分割的文件。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-05-30T19:49:29.730

使用 VS2013 刚刚对此进行了测试，它看起来可靠且一致。这类似于上面的一些评论，但添加了另一种更快的方法。

**(1st)**在 Windows 文件资源管理器中突出显示并复制所有 3 个表单文件（.vb 或 .cs、.designer、.resx）

**（2）**这可以通过两种方式完成：

(2a-1) 在文件资源管理器中，将 3 个文件与其他表单一起粘贴到项目文件夹中

(2a-2) 在 VS 解决方案资源管理器中，打开“显示所有文件”，右键单击粘贴的表单和“包含在项目中”。它应该可以在没有其他更改的情况下工作。

**或者，我认为更好：**

(2b-1) 在 VS 中，单击解决方案资源管理器并使用 Control-C 粘贴。（由于某种原因，解决方案资源管理器中的右键单击上下文菜单可能不会显示粘贴选项，但它可以通过键盘工作。）此方法直接将表单添加到项目中，而不必像上面那样“包含在项目中”。使用此方法，您可以在一个步骤中一次添加任意数量的表单（每个表单全部 3 个文件）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-09-27T09:52:20.607

我已经尝试了以下步骤并且效果很好。

1.  将所有 3 个文件和图标文件（如果有）复制到目标项目。
2.  现在转到您的项目解决方案资源管理器并单击 sol.explorer 顶部的显示所有文件图标
3.  现在您可以在项目中看到新添加的文件。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-06-15T13:28:52.670

如果您使用的是 VS 2015，那么您只需添加“.vb”文件并使用新项目名称更改名称空间。

例如：如果您想将使用 VS2008 创建的“Form1”添加到使用 VS2015 创建的新项目中。

1.  将所有“.vb”文件、“.resx”文件、“.disigner.vb”文件复制到新的项目文件夹中。
2.  然后使用新的项目名称更改“.disigner.vb”文件的名称空间。

这两个步骤对我有用。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-08-06T22:14:39.253

在 Visual Studio 2015 中，单击解决方案资源管理器并右键单击鼠标 Add->Existing Item 并从另一个项目中选择要添加的表单，如 Form.cs 并自动添加 Form.designer.cs ， Form.resx 将被添加

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-08-14T17:47:12.250

如果您需要在不同的项目中使用相同的表单，解决方案是：创建一个“类库项目”，在这个项目中添加您需要共享的表单，然后只需将 dll 的引用添加到您的主项目中，您将可以很容易地参考表格。它的作品非常适合我

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-01-08T21:02:02.077

我发现这样做的“最简单”的方法是：

1.  在新项目中创建同名表单
2.  将按钮或其他控件添加到新表单（这将创建 .resx 文件）
3.  保存并关闭您的新项目
4.  从旧项目复制 MyForm.cs、MyForm.designer.cs、MyForm.resx 文件以覆盖新项目
5.  在 VS 中打开新项目之前，使用文本编辑器编辑 MyForm.cs 和 MyForm.designer.cs 中的命名空间以匹配您的新项目命名空间
6.  此时，您可以在 VS 中打开新项目，一切都应该看起来正确

我从来没有运气尝试复制文件并“添加现有项目”，因为层次结构似乎没有重建。也许像另一个用户建议的那样首先添加 .designer.cs ？无论如何，如果您尝试这种方式，您可以手动编辑新项目 .csproj 文件以包含来自原始项目的层次结构条目，如下所示：

```
<Compile Include="MyForm.Designer.cs">
  <DependentUpon>MyForm.cs</DependentUpon>
</Compile> 
```

值得注意的是，在两个不同项目的表单之间复制*控件非常容易。*只需在源项目中选择并按Ctrl+C，然后在新项目中选择窗体并按Ctrl+V。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-03-24T12:11:02.097

在 VS2019 中，这些“自动”选项都不适合我。表单设计器将始终为空白，并且粘贴的文件未在解决方案资源管理器中正确组合。我在 VS2019 中的做法是以下 3 个步骤：

1.  使用 Windows 资源管理器将表单文件复制到新的项目目录。例如，这 3 个文件：

*   StartForm.cs
*   StartForm.Designer.cs
*   启动窗体.resx

2.  如果您的命名空间不同，请在记事本中打开两个 .cs 文件并将命名空间更改为新的命名空间。（使用 ctrl+F 确保您不会错过任何引用）我不必这样做，因为我的命名空间在我的新项目中是相同的。

3.  在记事本中编辑这两个 csproj 文件，并将这些文件的引用从一个 csproj 文件复制到新的 csproj 文件。例如，这是我必须复制的：

```
<ItemGroup>
...
<Compile Include="StartForm.cs">
  <SubType>Form</SubType>
</Compile>
<Compile Include="StartForm.Designer.cs">
  <DependentUpon>StartForm.cs</DependentUpon>
</Compile>
<EmbeddedResource Include="StartForm.resx">
  <DependentUpon>StartForm.cs</DependentUpon>
</EmbeddedResource>
...
</ItemGroup> 
```

之后，如果您在 VS 中打开了新项目，它会识别出更改并询问您是否要重新加载。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-04-09T18:19:20.217

1.  转到 Visual Studio 并设置您的新项目。将在所选目标中创建一个新文件。

2.  现在转到要导出到刚刚创建的项目的数据的源文件。从源文件中复制所有文件。

3.  转到新项目文件夹并将所有文件粘贴到那里。

4.  现在，由于这些文件已经存在，将显示替换新项目文件的选项。只需单击替换现有文件。

5.  现在，检查您刚刚创建的项目。所有的变化都会出现在那里。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2022-01-15T14:58:20.097

归功于 Harry Davis 在[https://quick-adviser.com](https://quick-adviser.com)上的文章。有同样的问题，但这里没有一个解决方案对我有用。我也承认我没有完全理解，因为我一周前才开始使用 VS，并希望将其用于课堂项目。该解决方案适用于 VS 2021。

1.  将子文件夹添加到项目中。我通过右键单击解决方案资源管理器窗口中的项目名称并添加 > 新文件夹来完成此操作。
2.  右键单击新的子文件夹，然后单击添加 > 现有项目。
3.  浏览要复制的 .cs 文件（不是 Design.cs，不是其他任何文件），然后单击添加。
4.  右键单击新添加的 .cs 文件，然后单击重命名。

# dynamicquery - 有没有人使用表定义的列构建动态查询引擎？

> ID：863598
> 
> 赞同：0
> 
> 时间：2009-05-14T14:18:43.453
> 
> 标签：dynamicquery

我有一个名为“字段”的表，其中包含应用程序字段。在此表中，我存储每个字段的元数据（TableName、ColumnName、JoinType（内部/外部）。

我有一些工作，但它不像我想要的那样干净。

有没有人解决过这个问题？

我正在寻找一些关于更好做法的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T14:31:57.603

动态数据/字段总是很有趣。

我之前处理这个问题的方法是有一个表来定义我想要的字段。一个非常基本的例子是：

GroupId int, <- 允许我出于共同目的将字段组合在一起

FieldId int, <- 连接的唯一标识符

FieldName varchar(100), <- 明显

DataType int <- 在包含可用类型（如文本、电话、电子邮件）的表上连接，这些类型可能具有特殊处理特性。

DisplayOrder int, <- 字段在屏幕上显示的顺序。

然后我有另一个表来保存实际数据：EntryId int, <- 将值分组到一个唯一的入口点。GroupId int, FieldId int, Value varchar(max) <-使用您认为包含数据的任何数字；如果您有正确版本的 sql server，则为 max

最后，我动态生成将实际数据旋转 90 度的视图，以便于报告。

通过这种方式，您可以在不修改底层代码的情况下对收集的内容有很大的自由度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T14:28:54.567

我过去写了一个查询生成器，它可以自动连接表格并将事物组合在一起以生成动态报告。

我想，今天，我会选择 NHibernate。虽然它是一个 ORM，但它根据与您的元数据非常相似的映射数据来管理连接并创建查询。

当然，您仍然需要做 NHibernate 未涵盖的特定事情。但这是一个很好的开始。

# javascript - 我什么时候应该使用 javascript 框架库？

> ID：863603
> 
> 赞同：9
> 
> 时间：2009-05-14T14:19:16.527
> 
> 标签：javascript, frameworks

我正在编写一个小型网络，它只是制作一些动画并将一些信息显示为主页和链接列表。所有这些都将在客户端动态生成。所以一切都将是 javascript 和 XML。

最近我一直在阅读 SO 中有关 javascript 的一些问题，并且大多数情况涉及框架的使用和/或推荐（jquery 和朋友）。一个小型的web开发什么时候应该开始考虑使用这样的框架？

到目前为止，我一直在用普通的 javascript 做我的东西，就我没有实现一个大网站而言，学习一个框架是否值得？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-14T14:20:52.123

我现在就开始。像 jQuery 和原型这样的库不仅使您免受浏览器差异的影响，而且还为您提供了一种与其他程序员交流想法的简写方式。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-14T14:29:53.833

在 SO 上你会发现**很多**人（包括我）都提倡使用 jQuery（尤其是）。对我来说，这是一个框架应该具备的一切：小型、轻量级、可扩展、紧凑但功能强大且语法简洁，它解决了一些非常重要的问题。老实说，我很难想象一个我不会使用它（或其他框架）的项目。

使用它的原因是为了解决浏览器兼容性问题。考虑我对 javascript 的回答，[以获取网页中选定文本的段落](https://stackoverflow.com/questions/845390/javascript-to-get-paragraph-of-selected-text-in-web-page/845438#845438)：

> ```
> function getSelectedParagraphText() {
>   var userSelection;
>   if (window.getSelection) {
>       selection = window.getSelection();
>   } else if (document.selection) {
>       selection = document.selection.createRange();
>   }
>   var parent = selection.anchorNode;
>   while (parent != null && parent.localName != "P") {
>     parent = parent.parentNode;
>   }
>   if (parent == null) {
>     return "";
>   } else {
>     return parent.innerText || parent.textContent;
>   }
> } 
> ```

如果您熟悉 Javascript，那么您应该熟悉其中的很多内容：检查 innerText 或 textContent (Firefox 1.5) 等等。纯 Javascript 充斥着这样的东西。现在考虑 jQuery 解决方案：

```
function getSelectedParagraphText() {
  var userSelection;
  if (window.getSelection) {
      selection = window.getSelection();
  } else if (document.selection) {
      selection = document.selection.createRange();
  }
  var parent = selection.anchorNode;
  var paras = $(parent).parents("p")
  return paras.length == 0 ? "" : paras.text();
} 
```

jQuery 真正闪耀的地方在于 AJAX。周围有 JavaScript 代码片段来找到正确的对象来实例化（XMLHttpRequest 或等效的）来执行 AJAX 请求。jQuery 会为您处理所有这些。

对于核心 jQuery Javascript 文件，所有这些都低于 20k。对我来说，这是必须的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T14:51:45.387

无论何时编写 javascript*都不是您的事*。

JS libraries, other than providing helpers and shortcuts, also take care of corner cases, browser incompatibilities and quirks, and best practices. It is better that you spend time developing your application, and fall back to native JS only if you have to.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T14:24:14.393

与 jquery 的交易是做 javascript 的方法，但工作量更少，与他人交流更容易，所以我会说**是**

这么想，你宁愿用microsoft word还是记事本写论文

# java - 在 java 中创建一个类似的 html-js UI GCalendar

> ID：863607
> 
> 赞同：0
> 
> 时间：2009-05-14T14:19:50.067
> 
> 标签：java, user-interface, calendar

我正在尝试复制像 gcalendar 这样的 UI（只有布局而不是它的任何功能）如何使用日历构建循环来构建这样的可爱布局？星期六标记和假期。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T19:41:27.320

的Java代码：

```
public class CalendarUI {
    public static String Dias[] = { "", "DOM", "SEG", "TER", "QUA", "QUI", "SEX", "SAB" };
    public static String Meses[] = { "JAN", "FEV", "MAR", "ABR", "MAI", "JUN", "JUL", "AGO", "SET", "OUT", "NOV", "DEZ" };

    public static void printCalendar(int currMonth){
        int i = 1;      
        Calendar c = Calendar.getInstance();
        NumberFormat formatter = new DecimalFormat("##00");

        c.set(Calendar.YEAR, 2009);
        c.set(Calendar.MONTH, currMonth);
        c.set(Calendar.DATE, i);

        // cabecalho com o mes
        System.out.println(" - " + Meses[currMonth] + " - ");

        // ajuste para o primeiro dia
        for (; i < c.get(Calendar.DAY_OF_WEEK); i++) {
            System.out.print("           ");
        }

        // principal
        for (i = 1; i <= 31; i++) {
            c.set(Calendar.DATE, i);

            if (c.get(Calendar.MONTH) == currMonth) {       
                if (c.get(Calendar.DAY_OF_WEEK) == 1)
                    System.out.println("");

                System.out.print("[ " + Dias[c.get(Calendar.DAY_OF_WEEK)]
                        + ", " + formatter.format(i) + " ]");
            }
        }       

        System.out.println("\n\n");
    }

    public static void main(String[] args) {
        for (int j = 0; j < 12; j++) {
            CalendarUI.printCalendar(j);

        }

    } 
```

* * *

以月为单位正确缩进天数的输出（给出的示例为 may）：

```
 - MAI - 
                                                       [ SEX, 01 ][ SAB, 02 ]
[ DOM, 03 ][ SEG, 04 ][ TER, 05 ][ QUA, 06 ][ QUI, 07 ][ SEX, 08 ][ SAB, 09 ]
[ DOM, 10 ][ SEG, 11 ][ TER, 12 ][ QUA, 13 ][ QUI, 14 ][ SEX, 15 ][ SAB, 16 ]
[ DOM, 17 ][ SEG, 18 ][ TER, 19 ][ QUA, 20 ][ QUI, 21 ][ SEX, 22 ][ SAB, 23 ]
[ DOM, 24 ][ SEG, 25 ][ TER, 26 ][ QUA, 27 ][ QUI, 28 ][ SEX, 29 ][ SAB, 30 ]
[ DOM, 31 ] 
```

# jquery - 使用插件过滤 jQuery 对象

> ID：863608
> 
> 赞同：0
> 
> 时间：2009-05-14T14:19:59.050
> 
> 标签：jquery, plugins, traversal

我正在尝试构建一个 jQuery 插件来过滤提供的 jQuery 对象，只返回一些类似于 .filter(expr) 函数的元素。这更多是为了教育我自己而不是现实世界的问题。但是我不知道如何从提供的 jQuery 对象中删除元素（或者只返回某些其他元素，并不重要）。

代码示例（是的，我知道您可以使用 filter(':Nth-child(n)') 执行此操作，但正如我所说，这是为了教育自己）：

```
$.fn.notNthElement = function(n){
    var i=0;
    this.each( function(){
        i++;
        if(i==n){
            //remove element from this jQuery object (not from DOM)
            i=0;
        }
        //or alternatively:
        else{
            //push this to some result jQuery object
        }
    });
    return this; //or when going the alternative route, return the result jQuery object
} 
```

如何做到这一点？

**编辑**
我真的在寻找一种从 jQuery 对象中删除特定元素的方法，而不是解决上述问题的一些聪明方法。所以我不想返回提供的 jQuery 对象的子集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T15:10:18.373

我认为您会想要使用**过滤器（fn）**函数，您可以向该函数提供一个函数，该函数为 jQuery 对象中的每个项目调用。如果函数返回 false，则删除该项目。

例如，这将过滤掉第 5 个项目和 id 为“blue”的项目：

```
$("div").filter(function (index){
    return !(index == 5 || this.id == "blue");
}); 
```

或者，您可以[实现自己的自定义选择器](http://www.ericmmartin.com/creating-a-custom-jquery-selector/)，并使用您提到的 filter(expr) 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T14:31:27.697

注意：没有尝试过，但认为它有效。将其视为元代码...（尽管它可能按原样工作。）

```
$.fn.notNthElement = function(n){
  var $this = $(this);
  return $this.slice(0,n-1).add($this.slice(n));
}; 
```

# asp.net - 如果不为cookie设置过期时间，在关闭浏览器时会丢失吗？

> ID：863611
> 
> 赞同：4
> 
> 时间：2009-05-14T14:20:45.413
> 
> 标签：asp.net, cookies

如果不为cookie设置过期时间，在关闭浏览器时会丢失吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:23:01.447

如果它没有过期，那么它会。它将被视为会话 cookie。一个例外是新版本的 Firefox，它可以保存您的会话。

请注意，Chrome 具有使进程保持打开状态的功能，因此关闭浏览器并不一定会清除您的会话。检查您的任务栏是否有 Chrome 图标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T14:28:47.563

你是对的。如果您没有为 cookie 设置过期时间，它将仅存储在内存中，并在会话结束时删除。如果您确实设置了过期时间，它将存储在硬盘上。

# ruby-on-rails - ruby on rails 模型中的全局方法

> ID：863613
> 
> 赞同：6
> 
> 时间：2009-05-14T14:20:47.550
> 
> 标签：ruby-on-rails, activerecord, model

我的所有模型中都有如下所示的方法：

```
def formatted_start_date
  start_date ? start_date.to_s(:date) : nil
end 
```

我想要为每个模型中的每个日期时间字段自动编写这样的方法，最好的方法是什么？

-C

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-16T04:55:24.710

I just had to answer this, cos it's a fun Ruby excercise.

Adding methods to a class can be done many ways, but one of the neatest ways is to use some of the reflection and evaluation features of Ruby.

Create this file in your lib folder as lib/date_methods.rb

```
module DateMethods

  def self.included(klass)

    # get all dates
    # Loop through the class's column names
    # then determine if each column is of the :date type.
    fields = klass.column_names.select do |k| 
                  klass.columns_hash[k].type == :date
                end

    # for each of the fields we'll use class_eval to
    # define the methods.
    fields.each do |field|
      klass.class_eval <<-EOF
        def formatted_#{field}
          #{field} ? #{field}.to_s(:date) : nil
        end

      EOF
    end
  end
end 
```

Now just include it into any models that need it

```
 class CourseSection < ActiveRecord::Base
   include DateMethods
 end 
```

When included, the module will look at any date columns and generate the formatted_ methods for you.

Learn how this Ruby stuff works. It's a lot of fun.

That said, you have to ask yourself if this is necessary. I don't think it is personally, but again, it was fun to write.

-b-

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-14T14:24:42.910

它看起来更像是我的帮手。在您的应用程序帮助中尝试此操作：

```
def formatted_date(date)
   date ? date.to_s(:date) : nil
end 
```

格式化不是真正属于模型的东西（正是因为你发现的原因......在每个模型中放置这样的通用代码很烦人）

如果你真的想照你说的做，那么你可以做的是猴子补丁 ActiveRecord 超类并将你想要的功能添加到那里。然后它将可用于您的所有模型。请注意，monkeypatching 可能导致不可预测和未定义的行为，使用风险自负！它也很hacky :)

```
class ActiveRecord::Base
   def formatted_start_date
      start_date ? start_date.to_s(:date) : nil
   end
end 
```

只需将其粘贴在您的应用程序中的任何其他内容之前将运行的某个位置，它就会动态地将方法添加到模型的基类中，使其可供使用。

或者你可以为你的所有模型创建一个 mixin，但这对于单一方法来说似乎有点过头了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T14:46:31.703

*对您的评论的回答：* 您可以将通用代码/功能提取到您包含在一个类中的模块中（我相信这称为 mixin？），或者您可以选择子类。我不认为子类是您想要进入对象的常见功能而不是真正的继承情况时要走的路。

看看[这个以获取有关模块和 Ruby 的更多信息](http://corelib.rubyonrails.org/classes/Module.html)。

# visual-studio-2008 - 编辑并继续使用 TestDriven .NET 和 Gallio

> ID：863620
> 
> 赞同：1
> 
> 时间：2009-05-14T14:22:05.567
> 
> 标签：visual-studio-2008, gallio, testdriven.net

我有 VS08sp1、Gallio 3.0.6.763 和 TestDriven.NET 2.14。我使用 MBUnit 框架进行单元测试。当使用 TestDriven 的 Test With > Debugger 时，我可以单步执行代码。但是，尽管在 VS 选项中打开了此选项，但我无法“编辑并继续”。我收到以下错误消息：

> 当调试器已附加到已运行的进程时，不允许更改

正在单元测试的项目是一个 Windows 类库，我可以在通过常规调试器运行该库时“编辑并继续”。对于让“编辑并继续”工作的任何帮助，我将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-17T11:25:28.853

我认为您无法使用 TestDriven.Net 进行这项工作，除非 Jamie 更改 ProcessInvoker.exe 进程的启动方式，以便编辑和继续支持工作。

老实说，我总是关闭“编辑并继续”，因为它有很多限制，对我来说实际上毫无用处。相反，我依靠 Visual Studio 即时窗口来试验正在运行的应用程序和原型错误修复。

关闭“编辑并继续”以及“要求源文件与原始版本完全匹配”的另一个优点是调试器将不再锁定源文件。这特别方便，因为我可能会在一个会话中修复两个或三个错误，并且不得不停止调试器才能编辑文件很糟糕。此外，Visual Studio 似乎花费了大量时间来重绘选项卡，因为它会打开或关闭“锁定”状态 - 特别是在有许多打开的选项卡的情况下。我观察到调试前后的几秒钟的暂停是锁定的直接后果。因此，关闭所有导致锁定的功能可以显着提高速度。

所以我想我的建议是尝试一种不同的方法来调试不需要编辑并继续的测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-05T08:22:48.973

来自[http://www.testdriven.net/downloads/releasenotes.html](http://www.testdriven.net/downloads/releasenotes.html)：

> 705：添加（隐藏）对“测试... E&C”的支持
> 
> 启用与编辑和继续一起使用的“测试...调试器 (E&C)”；编辑“TestDriven.dll.config”文件并取消注释。当与源代码控制一起使用时，此测试运行器可能会“接触”项目文件（这就是默认情况下禁用它的原因）。

# asp.net - 申请开始

> ID：863629
> 
> 赞同：0
> 
> 时间：2009-05-14T14:23:15.300
> 
> 标签：asp.net

ASP.NET 用户身份在允许写入数据库的 Application.Start 中不可用。（网站在共享主机上运行，​​所以我无法根据需要配置权限。）所以，我在 global.asax 中实现了以下内容。我不确定它是否完全线程安全。我想删除委托以消除锁定检查以优化性能。

我想知道“if (TheFirstReq != null)”是否会失败。谢谢

```
delegate void FirstRequest();
static volatile FirstRequest TheFirstReq;
static object ObjLock = new Object();

void Application_Start(object sender, EventArgs e) 
{
    // Code that runs on application startup
    AppStartDateTime = DateTime.Now;
    TheFirstReq = FirstReq;
}

void FirstReq()
{
    lock (ObjLock)
    {
        if (TheFirstReq == null)
            return;
        TheFirstReq = null;
        // Log Application start.
    }
}

protected void Application_BeginRequest(object sender, EventArgs e)
{
    if (TheFirstReq != null)
        TheFirstReq();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T14:31:04.377

您的代码不是线程安全的，双锁模式虽然在逻辑上您可能认为它是安全的，但实际上并不安全，因为您已经实现了它。您需要在TheFirstReq 声明中添加[Volatile关键字。](http://msdn.microsoft.com/en-us/library/x13ttww7(VS.71).aspx)

此[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms998558.aspx)显示了正确实施的双重检查锁。

# javascript - 单击时如何格式化div中的一行文本？

> ID：863630
> 
> 赞同：1
> 
> 时间：2009-05-14T14:23:18.870
> 
> 标签：javascript, jquery

**使用 jQuery 或直接的 javascript，您如何识别/选择/选择具有 contentEditable 的 div 中的单行文本并仅向该行文本添加格式？**

我目前有一个 contentEditable 设置为 true 的 div，它允许用户编辑 div 的内容，添加/删除他们认为合适的文本。但是，我希望用户也能够双击 div 中的任何文本行并使用不同的格式样式标记该行。*（即在跨度中包含整行文本，然后设置跨度的样式。请注意，我可以轻松地设置跨度的样式。我的问题在于识别用户单击的文本行并将其包含在跨度标记中）*

请注意，由于用户可以添加大量内容，因此 div 本身是可滚动的，因此任何解决方案都应该能够处理滚动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T14:41:52.383

jQuery [fieldSelection 插件](http://laboratorium.0xab.cd/jquery/fieldselection/0.2.3-test/test.html)将允许您获取用户选择的文本。

至于用跨度包装选定的行，通常的[jQuery $().wrap()](http://docs.jquery.com/Manipulation/wrap#elem)方法应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-20T20:58:12.593

对于 Firefox，您可以使用：

```
// This will give the first selection:
var range = window.getSelection().getRangeAt(0);
var txt = range.toString();
var spn = document.createNode('span');
spn.innerHTML = txt;
// Here you can apply style to spn
range.surrondContents(spn); // It will surround your selected text 
```

这是获得更多帮助的链接： [https ://developer.mozilla.org/en/DOM/range.surroundContents](https://developer.mozilla.org/en/DOM/range.surroundContents)

对于 IE，您可以使用：您也可以在 IE 中使用相同的过程..使用范围和选择..

希望它能解决你的问题。

# c# - 防止控件数据绑定到 ObjectDataSource？

> ID：863643
> 
> 赞同：0
> 
> 时间：2009-05-14T14:26:13.950
> 
> 标签：c#, asp.net, c#-4.0, objectdatasource

我有一个需要数字查询字符串值的页面。例如：

```
Details.aspx?rgn=1234 
```

在这个页面上是一个`<asp:repeater>`数据绑定到一个`<asp:objectdatasource>`. 数据源看起来像这样：

```
<asp:ObjectDataSource ID="ObjectRegion" runat="server" SelectMethod="GetRegions" TypeName="Region">
  <SelectParameters>
    <asp:QueryStringParameter Name="RegionID" QueryStringField="rgn" Type="Int32" DefaultValue='0' />
  </SelectParameters>
</asp:ObjectDataSource> 
```

由于这是一个公共页面，有时我会被黑客/搜索引擎/好奇的人传递一个非数字值。我在我的 Page_Load 中验证了这一点。像这样的东西：

```
protected void Page_Load(object sender, EventArgs e)
{
    int RegionID;
    string strRegion = Request.QueryString["rgn"];
    if(string.IsNullOrEmpty(strRegion) || !int.TryParse(strRegion, out RegionID))
    {
        // setup permanent redirect
        return;
    }
} 
```

问题是我的转发器仍然会进行数据绑定，这会导致`[FormatException: Input string was not in a correct format.]`... 这是我想要阻止的事情。任何解决此问题的简单方法的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T14:35:36.330

我回答了我自己的问题。我忘了`Response.End()`在永久重定向上添加一个：

```
Response.Status = "301 Moved Permanently";
Response.AddHeader("Location",URL);
Response.End(); 
```

# wpf - 为 Silverlight 3.0 应用程序创建 WPF 前端

> ID：863650
> 
> 赞同：3
> 
> 时间：2009-05-14T14:28:34.880
> 
> 标签：wpf, silverlight, wcf-ria-services

我正在考虑为 Silverlight 应用程序创建 WPF 前端。由于 Silverlight 通常具有较小的功能子集，这应该是可能的，但我不确定解决问题的最佳方法。从一开始，让我说我目前正在通过浏览器运行该应用程序，但它缺乏捕获系统范围内的按键等我想添加的功能，以及一些 W7 集成。

我以前在 Silverlight 和 WPF 之间共享源代码，方法是为每个项目创建一个项目，然后使用“添加为链接”来链接两者之间的源文件。这一次，我可能会使用 .NET RIA 服务在平台之间共享源代码和业务逻辑。

我看到的问题是在项目之间共享 Xaml。除了命名空间之外，它几乎与复制和粘贴兼容，但这不是共享资源的好方法。有没有人想出一个在 Silverlight 和 WPF 之间共享 Xaml 的好方法？

我想到的最后一个选项是让 WPF 应用程序使用浏览器控件来托管 Silverlight 应用程序。然后我可以围绕它添加 Windows 特定的功能。对我来说，从开发和测试的角度来看，这似乎是最干净的方式。大家怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T16:27:07.103

这是您可以使用的技巧。

1.  确保您的 Silverlight 视图和视图模型在它们自己的程序集中被隔离，您的 WPF 应用程序可以轻松引用这些程序集。
2.  添加对 Silverlight 类库的引用，该类库包含 WPF 应用程序中的视图和视图模型。
3.  将 UserControl 的内容“CustomerView”移动到位于名为“customerViewTemplate”的资源字典中的 DataTemplate

4.  在 Silverlight 和 WPF 中的根 UI 元素 XAML 文件中执行以下操作：

`<ContentControl ContentTemplate="{Staticresource customerViewTemplate}" />`

5.  在 Silverlight 应用程序的 App.xaml 中，确保将以下资源字典引用添加到合并字典。

`<ResourceDictionary Source="MyApp.Views;component/CustomerViewResources.xaml" />`

6.  在 WPF 应用程序的 App.xaml 中，确保将以下资源字典引用添加到合并字典中。

`<ResourceDictionary Source="pack://application:,,,/MyApp.Views;component/CustomerViewResources.xaml" />`

对不起编号，看起来 Stack Overflow 的有序列表机制有点不对劲。

之所以可行，是因为您不能直接从 WPF 中的 XAML 引用 Silverlight UserControl。它会给你以下错误：

> '无法解析对程序集 'System.Windows, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e' 的依赖，因为它没有被预加载。使用 ReflectionOnly API 时，必须通过 ReflectionOnlyAssemblyResolve 事件预加载或按需加载依赖程序集。

如果您尝试使用 C# 将 UserControl 强制到 WPF Grid 上，您将收到以下 3 个错误：

> 'System.Windows.Controls.UIElementCollection.Add(System.Windows.UIElement)' 的最佳重载方法匹配有一些无效参数。
> 
> 'System.Windows.Controls.UserControl' 类型在未引用的程序集中定义。您必须添加对程序集 'System.Windows, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e' 的引用
> 
> 无法从“ToWpfTest.Views.TestView”转换为“System.Windows.UIElement”

我认为这是因为 WPF 中的 System.Windows.UIElement 与 Silverlight 中的 System.Windows.UIElement 不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T14:03:19.123

就我的经验而言，XBAP 应用程序在选项卡和按键问题方面没有问题。如果您想找到某种方式将它们添加到您的 silverlight 应用程序中，如果您找到解决方案，请坚持使用它。

你在看什么具体的 W7 集成？

我也使用添加链接概念，以便以正确的方式实现可管理性。

我看到的问题是在项目之间共享 Xaml。除了命名空间之外，它几乎与复制和粘贴兼容，但这不是共享资源的好方法。有没有人想出一个在 Silverlight 和 WPF 之间共享 Xaml 的好方法？

我有一个 XBAP 和 WPF 我有 2 个项目，这些项目具有两者的加载器代码。（对于类（窗口和页面）的单个更改没有复制粘贴期望，这意味着 2 个项目具有相似的代码。

你可以像你提到的那样创建一个加载器，那里没有害处......

如果您的要求与安全问题等相匹配，您可能首先选择 XBAP...

或者试试

1.  [模式和实践：复合 WPF 和 Silverlight](http://www.codeplex.com/CompositeWPF)
2.  [棱镜](http://www.codeplex.com/Release/ProjectReleases.aspx?ProjectName=CompositeWPF&ReleaseId=11615)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-14T16:36:03.373

共享 XAML 的问题在于 Silverlight 和 WPF 使用非常不同的模型来处理动画和状态更改。我可以想象，在大多数项目中，专门用于动画的 XAML 数量将相当大，因此我认为共享 XAML 不是一个非常可行的选择。

# asp.net - HttpRuntime.Cache 和 HttpContext.Current.Cache 的区别？

> ID：863654
> 
> 赞同：65
> 
> 时间：2009-05-14T14:29:03.757
> 
> 标签：asp.net

`HttpRuntime.Cache`和 和有什么不一样`HttpContext.Current.Cache`？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-05-14T14:36:51.617

[我从http://theengineroom.provoke.co.nz/archive/2007/04/27/caching-using-httpruntime-cache.aspx](http://theengineroom.provoke.co.nz/archive/2007/04/27/caching-using-httpruntime-cache.aspx)找到以下详细信息

> 对于缓存，我研究过使用 HttpContext.Current.Cache 但在阅读其他博客后，我发现使用 HttpContext 进行缓存使用 HttpRuntime.Cache 来进行实际缓存。直接使用 HttpRuntime 的优点是它始终可用，例如，在控制台应用程序和单元测试中。
> 
> 使用 HttpRuntime.Cache 很简单。对象可以存储在缓存中并由字符串索引。除了键和要缓存的对象之外，另一个重要参数是到期时间。此参数设置从缓存中删除对象之前的时间。

**[这是你的好链接。](http://weblogs.asp.net/pjohnson/httpruntime-cache-vs-httpcontext-current-cache)**

[**另一个好资源。**](http://www.hanselman.com/blog/UsingTheASPNETCacheOutsideOfASPNET.aspx)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-14T14:36:36.343

使用 HttpContext 进行缓存使用 HttpRuntime.Cache 进行实际缓存。直接使用 HttpRuntime 的优点是它在控制台应用程序和单元测试中始终可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-28T15:46:52.627

使用`HttpRuntime.Cache`比使用简单`HttpContext.Current.Cache`。正如已经说过的，对象可以存储在缓存中并由字符串索引。在单元测试和控制台中也`HttpRuntime`可以使用。

这是一个使用示例`HttpRuntime.Cache`。

```
public static XmlDocument GetStuff(string sKey) 
{
XmlDocument xmlCodes;
xmlCodes = (XmlDocument) HttpRuntime.Cache.Get( sKey );
if (xmlCodes == null)
{
      xmlCodes = SqlHelper.ExecuteXml(new dn("Nodes", "Node"), "Get_Stuff_From_Database", sKey);
      HttpRuntime.Cache.Add(sKey, xmlCodes, null,
      DateTime.UtcNow.AddMinutes(1.0),
      System.Web.Caching.Cache.NoSlidingExpiration,
      System.Web.Caching.CacheItemPriority.Normal, null);
}
return xmlCodes;
} 
```

### 这个例子实际上做了什么：

* * *

该方法`GetStuff`采用一个字符串参数，该参数用于从数据库中检索一组项目。该方法首先检查`XmlDocument`由参数键索引的是否在缓存中。如果是，它只是返回这个对象，如果不是，它查询数据库。在它从数据库中检索到文档后，将其放入缓存中。如果在规定的时间内再次调用该方法，它将获取对象而不是访问数据库。

# php - 使用 [index]es 编辑多维数组，而不仅仅是 [name]s

> ID：863660
> 
> 赞同：0
> 
> 时间：2009-05-14T14:30:41.630
> 
> 标签：php, function, multidimensional-array, foreach

```
public $form = array (  
    array(  
        'field' => 'email',  
        'params' => array(  
            array(  
                'rule' => 'email',  
                'on' => 'create',  
                'required' => true,  
                'error' => 'The email is invalid!'  
            ),  
            array(  
                'rule' => 'email',  
                'on' => 'update',  
                'required' => false,  
                'error' => 'The email is invalid!'  
            )  
        )  
    )  
);

public function onlyNeeded($action) {
    $form = $this->form;
    $action = $this->action;

    foreach ($form as $formelement) {
        $field = $formelement['field'];
        $paramsgroup = $formelement['params'];
        if ($paramsgroup['on'] != $action) {
            form = removeparamsgroup($form, $action);
            }
        }
    return $form;
} 
```

我该如何做这个`removeparamsgroup()`功能？

有 [index] ，而不仅仅是 [name]！

你懂我的意思吗？

数组（数组（两次！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T14:56:21.180

如果您在 foreach 循环中获得数组键，则可以使用它取消设置正确的数组索引。您还需要遍历每个表单元素的每个参数，您在示例中没有这样做。

```
public function onlyNeeded($action) {
    $form = $this->form;

    //get $formelement by reference so it can be modified
    foreach ($form as & $formelement) {

        //$key becomes the index of current $param in $formelement['params']
        foreach ($formelement['params'] as $key => $param) {
           if ($param['on'] != $action) {
               unset($formelement['params'][$key]);
           }
        }
    }
    return $form;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T15:01:11.497

尝试这个。

```
function onlyNeeded($action) {
    $form = $this->form;

    foreach ($form as &$formelement) {
        foreach ($formelement['params'] as $key => $paramsgroup)
        {
            if ($paramsgroup['on'] != $action)
                unset($formelement['params'][$key]);
        }
    }
    return $form;
} 
```

不要忘记第一个 foreach 循环中的 & 符号，否则它将不起作用。如果没有 & 符号，foreach 会复制每个元素而不是返回引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T14:36:40.087

未设置（$form['params']）？你说的删除是什么意思？

# mysql - 为什么 MySql 会出现“子查询返回超过 1 行”错误？

> ID：863665
> 
> 赞同：0
> 
> 时间：2009-05-14T14:31:07.230
> 
> 标签：mysql, mysql-error-1242

嗨，伙计，我正在从我的表格中选择我的活动记录，我的所有其他记录都很好，但是活动记录给了我错误我的代码是

> @query = Estate.find_by_sql"SELECT (e.name) as estate_name, g.name asGovernance_body,"+ "(select count( *) from stand s where s.estate_id = e.id AND #{filter_estates}) as total_stands， "+ "(select e.active from states e where e.active = true AND #{filter_estates}) as Estate_status, "+ "(select count(* ) from services sp where sp.estate_id = e.id AND #{filter_estates} ) as service_providers,"+ "(select count(*) from approved_vendors av where av.estate_id = e.id AND #{filter_estates})as vendor"+ " FROM states e LEFT JOINGoverning_bodies g on e.governing_body_id = g.id和 #{filter_states} "

我得到一个错误。

> (Mysql::Error: Subquery return more than 1 row: SELECT (e.name) as estate_name, g.name asGovernance_body,(select count( *) from stand s where s.estate_id = e.id AND e.id IS NOT NULL）作为total_stands，（从estates e中选择e.active，其中e.active = true AND e.id IS NOT NULL）作为estate_status，（*从服务sp中选择count（），其中sp.estate_id = e.id AND e.id不为空）作为service_providers，（从approved_vendors av 中选择计数（*），其中av.estate_id = e.id AND e.id 不为空）作为来自庄园的供应商e LEFT JOINGovernance_bodies g on e.governing_body_id = g.id AND e.id 不为空）：

我想显示所有活跃和不活跃的庄园。

请问各位，我该如何解决这个问题。我正在使用 Mysql 数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T14:35:51.323

看起来您的第三行可能有问题：

> （从庄园 e 中选择 e.active，其中 e.active = true AND #{filter_estates}）作为庄园状态

上面和下面的行使用聚合，因此它们只返回一行，这可能（可能是）返回多行并且它不知道将哪一行分配给 Estate_status。

您可能只需将该行更改为：

> e.active 作为 Estate_status

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T14:36:12.740

我当然不熟悉该表，所以我现在可以给您的最佳答案是为什么该查询不起作用。

从庄园 e 中选择 e.active，其中 e.active = true AND #{filter_estates}) 作为庄园状态

该行返回多行，你不能在那里做。请注意，您的其他人使用聚合函数，因此它们只返回一行。

哦，我不怎么使用 My SQL，但是在 T-SQL 中，我们经常做 max(e.active) 之类的事情，或者可能放一个 top 1（我认为这是我的 SQL 中的 Limit 1）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-11T08:01:31.073

SELECT 子句中的子查询必须仅返回 1 行和 1 列才能明确。这件作品产生超过 1 行：

```
"(select e.active from estates e where e.active = true AND #{filter_estates}) as estate_status 
```

将其更改为

```
"(select first(e.active) from estates e where e.active = true AND #{filter_estates}) as estate_status 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T14:41:52.307

你的子查询

```
(SELECT e.active FROM estates e WHERE   ...) AS estate_status 
```

返回多个值。

如果可以，请使用“TOP 1”，例如：

```
SELECT e.name AS estate_name   ,
       g.name AS governing_body,
       (SELECT COUNT(*) FROM stands s            WHERE   ...) AS total_stands,
       (SELECT TOP 1 e.active FROM estates e     WHERE   ...) AS estate_status,
       (SELECT COUNT(*) FROM services sp         WHERE   ...) AS service_providers,
       (SELECT COUNT(*) FROM approved_vendors av WHERE   ...) AS vendors
FROM   estates e
LEFT 
JOIN   governing_bodies g ON  e.governing_body_id = g.id
                          AND ... 
```

# asp.net - 如何获取国家/地区的时区信息？

> ID：863672
> 
> 赞同：4
> 
> 时间：2009-05-14T14:32:53.590
> 
> 标签：asp.net, .net

如何获取某个国家/地区的时区信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T15:00:04.617

有趣的是你应该问。请参阅[.NET 的 REST 客户端库，第 1 部分](http://johnwsaundersiii.spaces.live.com/blog/cns!600A2BE4A82EA0A6!657.entry)。它指的是一个网站和一组 Web 服务，它们返回基于位置的数据，包括时区信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T14:57:58.990

正如其他人所说，这是一个移动的目标。我发现这个网站非常有用：

[http://www.timeanddate.com/worldclock/](http://www.timeanddate.com/worldclock/)

您可以从那里获取 UTC 偏移量，如果您真的很认真，请执行一些预定的抓取以保持最新。几年前我用它在我公司的门户页面上放了一系列世界时间，以显示公司全球主要办事处的时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T15:13:19.093

使用时区数据时要记住的几件事：

1.  时区数据是特定于位置的...您要为谁显示时区信息？用户的？客户的？

2.  时区数据还包括这个有趣的东西，称为*夏令时* ，这意味着您的时区计算将根据您计算它们的日期而改变。

    1.  计算 6 月费城的时间与计算 12 月的时间不同。
    2.  并非所有市政当局都遵守夏令时...
3.  时区数据更改**非常**频繁例如，美国在大约 2 年前开始和结束夏令时的时间发生了变化……而澳大利亚在过去 2 年中每年都通过了一项法律，确定其每个州的开始和结束时间.

我的建议：您的时区计算表的生效日期......因为这些事情发生了变化，您需要能够准确地计算任何时间点的时间，您需要知道那个时间点的时区标准是什么。

将所有时间以 UTC 格式存储在您的数据库中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T15:10:27.697

正如其他人所指出的那样，确实没有更好的方法来做到这一点，因此如果您尝试仅基于一个国家/地区进行猜测，因为一个给定的国家/地区很有可能位于多个时区。

由于 ASP.NET 在标记列表中，我将不顾一切地猜测您正在编写某种 Web 应用程序。在这种情况下，最好的选择，也可能是最可靠的选择是简单地让用户明确他们所在的时区。一旦你知道用户的指定时区，你几乎可以用它做任何你想做的事情。

下一个选项是[John Saunders](https://stackoverflow.com/questions/863672/how-to-get-time-zone-information-from-country/863839#863839)在他的帖子中提到的选项，即使用[EarthTools](http://www.earthtools.org/)等服务来查找位置并获取时区信息。这里唯一的问题是，您通常需要能够到达至少一个城市和国家来过滤结果，并且您必须小心，因为同一个国家可能有多个城市具有相同的名称。

最后，如果您愿意接受结果有时可能是错误的，但没有让用户指示他们所在位置的好方法，您可以尝试进行反向 IP 查找来尝试猜测用户的位置电脑在。然后您可以将此信息带到上述[EarthTools](http://www.earthtools.org/)以获取时区信息。但是，实际上无法保证这是准确的。

最后要注意的一件事是，如果您在公司 WAN 内，那么您可以更轻松地进行反向 IP 查找，因为您可以访问 WAN 的布局并且可能只有一个简短的列表给定 IP 地址的来源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T14:39:05.387

这可能无法回答您的问题，但这里有一个论坛讨论这些问题：[get timezone from country name asp.net](http://www.webmasterworld.com/forum47/600.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T14:54:53.553

[该网站](http://www.twinsun.com/tz/tz-link.htm)包含所有常用时区数据的链接。tz 数据库是一个很好的查看位置。一般来说，您需要知道该国家/地区的位置，而不仅仅是该国家/地区。

# datetime - 水晶报表日期函数

> ID：863676
> 
> 赞同：2
> 
> 时间：2009-05-14T14:34:15.193
> 
> 标签：datetime, crystal-reports

我试图只选择其日期从当前日期到三个月后的月底的记录。

目前，表中有两个日期与查询匹配：

```
Judy: 5/17/09  
asdf: 8/9/09 
```

这是我的公式：

```
DateVar current = Date(CurrentDateTime); //takes the time off
DateVar ThreeMonthsAway = Date(year(CurrentDateTime), month(CurrentDateTime)+4, 1) - 1; // month+4, then -1 days to get last day three months away
{tblTenant.LeaseEnds} > current AND {tblTenant.LeaseEnds} < ThreeMonthsAway 
```

问题是，它没有返回任何结果。如果我去掉它的第二部分，我会得到两个结果，但我只想要三个月内的日期。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T21:43:29.593

从您的代码示例中，我猜您正在使用 Crystal Syntax 编写公式，因此必须使用“：=”而不是“=”进行变量赋值。“=”用于比较 Crystal 语法中的值。例如，请参见[此处](http://publib.boulder.ibm.com/infocenter/radhelp/v6r0m1/index.jsp?topic=/com.businessobjects.integration.eclipse.doc.crdesigner/reportdesigner/crconvariabledeclarationscrystalsyntax.htm)。（也许您正在将它与基本语法混合。）

所以你的代码必须阅读（不幸的是我这里没有 CR 来测试它）：

```
DateVar current := Date(CurrentDateTime); //takes the time off
DateVar ThreeMonthsAway := Date(year(CurrentDateTime), month(CurrentDateTime)+4, 1) - 1; // month+4, then -1 days to get last day three months away
{tblTenant.LeaseEnds} > current AND {tblTenant.LeaseEnds} < ThreeMonthsAway 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T16:09:05.637

也许是因为您要增加 4 个月 - 这是未来的 - 而不是减去它们？

您的问题要求“三个月前的月底”，但示例日期（截至 2009 年 5 月 14 日）是未来，所以可能是我误解了您的问题，或者您的问题写错了.

您是否打印出 ThreeMonthsAway 的值以查看它的评估结果？您确定 Date() 的 3 参数形式采用年-月-日顺序的参数（这是合理的，但我也遇到过顺序为月-日-年的系统）？

* * *

此处提出的某些观点已通过修复问题得到解决（或者评论已变得无关紧要，因为自发表评论以来问题已得到修复）。

# database - 在 Access DB 上执行 sql 脚本

> ID：863679
> 
> 赞同：1
> 
> 时间：2009-05-14T14:35:03.930
> 
> 标签：database, ms-access

我有一个包含数百个 sql 查询的脚本，我需要在 Access DB 上执行这些查询。由于在 Access 中执行 sql 查询是 IMO 退出尴尬，您一次只能执行一个并且不识别以“--”开头的注释行，我想知道是否存在一种更简单的方法来做到这一点。MS Access 是否有一个很好的替代方法来管理 Access DB？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:38:02.610

我建议编写一个应用程序或 PowerShell 脚本来从文件中读取查询并针对 Access 数据库执行。逐行阅读，忽略以注释分隔符开头的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T13:37:19.037

两个不错的选择：

选项 1：编写一个 C# 程序，该程序将使用 DAO 库来自动化 Access 并以编程方式执行语句。

```
dao.DBEngineClass dbengine = new dao.DBEngineClass();
dbengine.OpenDatabase(path, null, null, null);
dao.Database database = dbengine.Workspaces[0].Databases[0];
database.Execute(sql, null); 
```

`CurrentProject.Connection.Execute()`选项 2：在数据库中编写一个 VBA 模块，该模块将使用该方法执行相同的操作。

无论哪种情况，您都可以将此代码放在一个循环中，该循环读取您的语句并逐个执行它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T15:23:14.517

如何设置从 MS-SQL 数据库到访问数据库的链接并通过 MS-SQL 运行脚本？假设您没有更改表结构，您应该没问题。

# c - 注册 Windows 类 Win32

> ID：863684
> 
> 赞同：0
> 
> 时间：2009-05-14T14:35:36.940
> 
> 标签：c, winapi, class, window

为 win32 程序注册窗口类的最佳实践是什么？

您是在 WinMain 函数中注册每个类还是根据需要注册它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T14:40:12.497

我曾经根据需要去做，在需要之前不需要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-29T11:02:54.060

如果您使用 MFC，则无需注册，因为这将在后台进行。但如果使用 win32，如果您想使用 windproc 进行自定义消息处理，则需要在 WNDCLASS 结构中注册一个 Windows 类，请参阅 MSDN 链接

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms633586(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633586(v=vs.85).aspx)

即使您不提供 registerclass，系统也会有一个在窗口中注册的类。

见[样品](http://www.programminggallery.com/article/vc__/threads___process__messaging__and_memory_handling/general/understanding_the_windows_messaging_and_message_loops)

# c# - 隐式和显式委托创建之间的区别（有和没有泛型）

> ID：863688
> 
> 赞同：5
> 
> 时间：2009-05-14T14:35:59.903
> 
> 标签：c#, .net, generics, .net-2.0, delegates

*请参阅下面的 Go() 方法中的四行：*

```
delegate void Action<T>(T arg);
delegate void Action();

void DoSomething<T>(Action<T> action)
{
    //...
}

void DoSomething(Action action)
{
    //...
}

void MyAction<T>(T arg)
{
    //...
}

void MyAction()
{
    //...
}

void Go<T>()
{
    DoSomething<T>(MyAction<T>); // throws compiler error - why?
    DoSomething(new Action<T>(MyAction<T>)); // no problems here
    DoSomething(MyAction); // what's the difference between this...
    DoSomething(new Action(MyAction)); // ... and this?
} 
```

请注意，第一次调用生成的编译器错误是： *无法从用法中推断方法“Action(T)”的类型参数。尝试明确指定类型参数。*

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-14T14:40:03.807

`MyAction`和（当它们都有效时）之间没有区别，`new Action(MyAction)`除了前者在 C# 1 中不起作用。这是一个`implicit method group conversion`. 有时这不适用，最值得注意的是当编译器无法确定您想要什么样的委托时，例如

```
Delegate foo = new Action(MyAction); // Fine
Delegate bar = MyAction; // Nope, can't tell target type 
```

这在您的问题中发挥了作用，因为所涉及的两种方法都已重载。这基本上会导致头痛。

至于泛型方面 - 这很有趣。方法组并没有从 C# 3 类型推断中得到太多的喜爱——我不确定这是否会在 C# 4 中得到改进。如果您调用泛型方法并指定类型参数，则类型推断工作得相当好 - 但如果您尝试反过来做，它会失败：

```
using System;

class Test
{
    static void Main()
    {
        // Valid - it infers Foo<int>
        DoSomething<int>(Foo);
        // Valid - both are specified
        DoSomething<int>(Foo<int>);
        // Invalid - type inference fails
        DoSomething(Foo<int>);
        // Invalid - mismatched types, basically
        DoSomething<int>(Foo<string>);
    }

    static void Foo<T>(T input)
    {
    }

    static void DoSomething<T>(Action<T> action)
    {
        Console.WriteLine(typeof(T));
    }
} 
```

C# 3 中的类型推断非常复杂，并且在大多数情况下都能很好地工作（特别是它对 LINQ 非常有用），但在其他一些情况下却失败了。在理想的世界中，它会在未来的版本中变得更容易理解*和*更强大......我们拭目以待！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T14:42:16.190

非泛型隐式委托创建只是语法糖，因此编译器生成完全相同的代码

```
DoSomething(MyAction); 
```

和

```
DoSomething(new Action(MyAction)); 
```

因为它可以直接从方法参数和上下文推断委托的类型。

使用通用委托，由于协变和逆变，您必须指定委托类型（有关详细信息，请参见[http://msdn.microsoft.com/en-us/library/ms173174(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms173174(VS.80).aspx)） - T in Action 可以是方法中 T 的超类型，它仍将被接受为委托方法。因此，您需要在委托中明确指定 T ，因为编译器无法自行确定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-15T09:51:12.217

只是一个旁注..出于某种原因，这在 VB 中有效。

当我将 Methodgroup / adderessof 转换为委托时，C# 和 VB 中预处理器的实现似乎有所不同。

# linux - 关于 mysqlimport、换行和字符编码（我认为）

> ID：863695
> 
> 赞同：2
> 
> 时间：2009-05-14T14:36:56.407
> 
> 标签：linux, shell, cron, mysqlimport

首先，一些披露：我不是 Linux 管理员，我的 Linux 管理员也不是程序员。

也就是说，我们有一个 cronjob，它运行一个`mysqlimport`命令来导入每天生成的文本文件。我无法控制或参与如何创建此文件。通过反复试验，我们发现文本文件是在 Windows 机器上生成的，因此对于`lines-terminated-by`参数我们必须指定`\r\n`. 上周它停止正常工作，我们确定这是因为该文件现在是在 Linux 中生成的，所以我们将其更改为`\n`. 我的理解（不完全清楚）是这取决于谁生成了决定使用什么平台和编码的文本文件。

我们有一个执行`mysqlimport`命令的 shell 脚本。当我们提供正确的编码时，一切都会完美运行。但是由于我们不知道谁将首先创建文本文件，有没有办法确定编码是什么并实现正确的换行符？（并且“编码”在这里是正确的术语吗？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:58:16.043

在调用 mysqlimport 之前，您需要对 mysqlimport 正在读取的文件运行 dos2unix 命令。如果提供的文件是在 *nix 系统上生成的，则 dos2unix 会将 Windows 行尾“\r\n”转换为 *nix 行尾“\n”，该文件保持不变。

这样你就可以确保你总是有相同格式的行尾被馈送到你的 shell 脚本。

最好的祝福

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T14:58:36.243

我认为您可以在 linux 上使用 dos2unix 或 unix2dos 命令在“Windows”和 Linux 编码之间进行转换。所以你不必检测使用的是什么编码，只需运行命令以确保文件具有正确的编码。

这取决于实用程序的版本，但通常该命令将像这样执行：

```
dos2unix input.txt output.txt
dos2unix input.txt > output.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T14:57:30.023

`fromdos`、`dos2unix`和`tofrodos`是有时安装在 Linux 系统上的三个程序。您可以使用其中一种来始终将格式转换为 unix 行尾 ( `\n`)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T14:57:38.273

在运行 mysqlimport 之前，使用[tr](http://unixhelp.ed.ac.uk/CGI/man-cgi?tr+1)从 Windows 行尾删除额外的 \r 可能是最简单的。

# wpf - WPF - 仅使用 LeftClick 选择 ListBoxItem

> ID：863696
> 
> 赞同：0
> 
> 时间：2009-05-14T14:37:32.707
> 
> 标签：wpf, listbox, multi-select

我有一个带有 SelectionMode="Multiple" 的 ListBox，它允许我通过单击鼠标左键或右键来选择多行。如何限制选择仅从鼠标左键单击发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T14:47:34.850

我猜你必须编写自己的 ListBox(Item)，覆盖

```
 protected override void OnPreviewMouseRightButtonDown(MouseButtonEventArgs e)
    {
        base.OnPreviewMouseRightButtonDown(e);
    } 
```

或者

```
 protected override void OnMouseRightButtonDown(MouseButtonEventArgs e)
    {
        base.OnMouseRightButtonDown(e);
    } 
```

EventHandler 并在您的 xaml 中使用您的自定义 ListBox(Item)。不要忘记调用 e.Handled = true; 您可能还可以使用更通用的鼠标事件处理程序之一并检查是否单击了鼠标右键，然后调用 e.Handled。

# asp.net - ASP.NET - 在服务器上解压缩文件的网页请求

> ID：863707
> 
> 赞同：0
> 
> 时间：2009-05-14T14:39:13.280
> 
> 标签：asp.net, multithreading, zip, remoting, unzip

我们使用[SharpZipLib](http://www.icsharpcode.net/OpenSource/SD/Features.aspx)。我们需要能够解压缩服务器上的文件并将它们放在单独的文件夹中。解压缩文件的请求将来自网页上的用户。我想如果文件足够大，解压缩需要很长时间。*我们不希望用户在等待解压缩完成以继续浏览网站时卡在页面上。*

处理这种情况的好方法是什么：分离一个不同的线程来处理解压缩文件，创建一个单独的 Windows 服务来解压缩文件，或者......什么？

通过单独的线程或窗口服务来做这件事的利弊是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T03:35:46.500

**单独流程的优势 在单独流程中**
完成的工作可以在时间和物理上以及从安全的角度与页面流解耦。及时解耦：如果您选择，您可以缓冲解压缩内容的请求，直到“稍后”负载较低且有空闲 CPU 周期来执行此操作。

也在物理上解耦；对于大型系统，您可以有多个工作进程，甚至部署在多台独立的机器上，异步完成这项工作，并且该处理层可以独立于网页处理进行扩展。在任何系统中都存在瓶颈，分布式部署的优势是您可以独立扩展单独的工作负载，以更有效地消除瓶颈。

不过我想说，后一种好处只在非常大规模的系统中有用。在大多数情况下，您不会拥有从独立物理扩展层中受益的那种交易量。这不仅适用于*您的*工作负载，而且适用于所有工作负载的 98%。YAGNI 原则也适用于可扩展性。

物理解耦还允许独立开发不同的工作负载（页面流和 zip 解包）。换句话说，假设工作项不是简单的“解压缩文件”，而是更复杂的东西，其中包含多个步骤和决策点。在单独的进程中设计工作处理器允许独立于工作项处理来构建和测试页面流。如果它们必须独立发展，这可能是一个很好的优势。

如果工作项将通过不同的渠道到达，这种物理解耦也很好。假设网页不是工作项到达的唯一途径。假设您有一个 ftp 分站、一个 Web 服务或一个机器监控的邮箱，它们也可以接收工作项。在这种情况下，将工作项处理与网页处理物理分离是有意义的。

最后，这些东西在运行时的安全性上是解耦的。在某些 Web 应用服务器部署中，安全规则禁止 Web 服务器写入磁盘 - Web 服务器没有可写磁盘存储。单独的异步工作进程可以部署在网络的单独部分，具有大量存储空间，并且可能受到一组单独的安全要求的限制。这可能适用于您，也可能不适用于您。

**线程处理**
的优点 在单独的线程中完成工作的优点是它更简单。解耦引入了复杂性和成本。在单独的线程中管理工作，您没有任何管理单独进程（可能是单独的机器）的操作开销。没有额外的配置，没有新的构建/部署步骤。无需额外备份。无需维护额外的安全身份。无需担心通信交换（除了线程调度）。

您可以选择对工作项处理进行更复杂的处理，并且可以选择在 zip 文件看起来足够小的时候同步执行工作。假设您建立了 4 秒响应时间的阈值 - 高于该阈值，您需要异步工作负载，低于 4 秒，您将其“内联”。当然，您永远无法确定一个 zipfile 需要多长时间，但您可以根据文件的大小建立一个好的启发式方法。无论您是使用外部进程进行异步工作还是使用单独的线程，都可以使用此优化，但老实说，使用单独的线程时利用优化更简单。更少的额外工作要做。所以这是线程方法的一个优势。

**非差异化**
因素 如果您选择使用 AJAX 轮询机制来通知工作项状态，则可以与单独的进程或单独的线程一起使用。我不知道您将如何进行工作项跟踪，但我想当一个特定的工作项（zip 文件？）完成后，您将更新某处的记录——文件系统中的文件，数据库中的表. 无论是由同一进程中的线程还是由单独的进程（Windows 服务）完成，都会发生该更新。因此，无论您的架构决定如何，轮询的 AJAX 客户端在任何情况下都只会检查 db 表或文件系统，并且将以相同的方式获得工作项状态的通知。

**如何决定**
理论很有趣，但最终毫无用处，没有实际的操作限制。

工作量是现实世界的关键项目之一。您没有说这些 zip 文件有多大，但我猜它们是“常规大小”。大约4GB或更少的东西。通常，像这样的 zipfile 在我的笔记本电脑上解压缩需要 20-60 秒，但当然在具有真实存储系统和更快 CPU 的服务器上，它会更少。您也没有描述事务的并发性——任何时候会发生多少这样的事情。我假设并发性不是特别高。

如果是这种情况，我会坚持使用更简单的异步线程方法。您在 ASP.NET 中执行此操作，我假设在服务器操作系统上。CLR 具有良好的线程管理，而 ASP.NET 具有良好的进程横向扩展能力。因此，即使在高工作负载下，您也将获得良好的 CPU 利用率和规模，而无需大量配置工作。

如果工作项运行时间更长——比如说大约几小时甚至几天，并且时间是不可预测的（比如关闭股票订单）——那么在这种情况下，我会倾向于异步流程。如果并发性是每秒数千次，或者再次非常不可预测，那也将推荐一个单独的进程。如果故障模式足够复杂，我可能希望工作项位于单独的进程中以管理它。如果工作项处理可能会定期更改（根据不断变化的业务条件添加一个额外的步骤），我可能希望它在一个单独的流程中。

但在您的情况下，这些事情似乎都不是真的 - 解压缩 zip 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T03:46:31.047

单独线程的缺点是：

1.  当页面结束时，没有简单的方法可以获取有关其他线程正在做什么的通知。
2.  应用程序可以随时重新启动。
3.  如果用户快速连续提交两次页面，很容易意外启动两次。
4.  多线程代码很难调试。

单独线程的优点是：

1.  更少的代码
2.  如果解压缩完成时不需要通知用户，则很容易触发并忘记。
3.  无需额外的安装工作。

windows服务的优缺点与上面大致相反。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T14:42:08.530

就我个人而言，我会沿着 Windows 服务路线走下去，并在它们之间传递消息以获得进展，例如将 a 返回`handle`到可用于监视状态的解压缩。

但是，您也可以我认为也许分拆一个线程来执行此操作，这将愉快地执行并返回页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T14:43:42.160

我会使用一个异步进程，您可以轻松地从启用 AJAX 的页面进行轮询。完成后，页面的 AJAX 部分可以呈现您在用户等待进程同步完成时通常会呈现的详细信息。

# sql-server - 使用字节大小的列长度有什么意义吗？

> ID：863708
> 
> 赞同：3
> 
> 时间：2009-05-14T14:39:20.143
> 
> 标签：sql-server

微软 SQL 服务器 2000

我已经意识到，在我创建的最后几个表中，我一直在用 2 的幂定义列的 varchar 长度。所以，我有一个长度为 1024 或 512 或 256 的列。我意识到虽然这取决于表中其他列的长度，但这可能根本不重要。实施这种设计有什么意义吗？我在想不，但想听听你的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T14:41:43.523

我会说列的大小应该代表您存储的数据类型。如果它对速度有任何好处，那将是微不足道的，而且您因不正确的列长度而头疼的问题将远远超过所获得的任何好处。

您必须记住的另一件事是 Sql 2000 中的最大记录长度。我认为它大约是 8192 字节。如果您以 2 的幂分配字段，则可能会从一列中增加其他地方需要的长度。如果您的列很小并且每个表没有很多，这不会是一个问题，但是具有大 varchar 字段的表（比如在 5000 范围左右，这意味着您必须分配 8192 以遵循 2 约定的幂) 您将不得不为该字段分配比所需更多的空间，并且很可能会阻止您添加该表中所需的其他字段。

在这种情况下，您可以打破您的规则，但这意味着您已经停止遵循您设置的规则。这可能没问题，但这也意味着当有人稍后返回并查看整体架构时，会出现一个问题，即为什么某些列遵循一组分配空间的规则而其他列不遵循。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T14:44:45.387

不，这不对。记录所需的存储空间量取决于实际数据，而不是理论上的最大值。

# javascript - 道场工具提示。dojo.data fetch()。歌剧中的问题

> ID：863709
> 
> 赞同：0
> 
> 时间：2009-05-14T14:39:22.780
> 
> 标签：javascript, ajax, dojo

dojo.data 的奇怪问题。

```
var store = new dojo.data.ItemFileReadStore({ url: "[myUrl]" });

console.log(temp.fetch({
   query:{id:'*'},
   onComplete: functionOnComplete,
   onError: functionOnError
})); 
```

functionOnError 仅在歌剧中显示此类跟踪：

```
message : Statement on line 16: Syntax error
Backtrace:
  Line 16 of linked script http://locarbn.ru/js/dojo/dojo/dojo.js
    function(json){return eval("("+json+")");}
...................................................
opera#sourceloc : 16,
    stacktrace :   ...  Line 16 of linked script http://locarbn.ru/js/dojo/dojo/dojo.js 
```

据我了解，opera有些dojo语法看不懂，怎么解决这个问题？

我正在编写 dojox.grid 并通过 dojo.data.ItemFileWriteStore 请求数据。我可以另辟蹊径吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-09T05:18:39.090

Dojo 似乎对从您的数据存储返回的内容感到窒息。它是有效的 JSON 吗？你能在 Opera 中通过一个简单的“eval”来运行它吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-26T18:36:26.543

嗯，鉴于它是在 2009 年编写的，我想这不会有答案，但为了争论。如果您需要处理错误并了解 Opera DOM 支持的内幕，您想使用[Dragonfly Web 开发工具](http://my.opera.com/dragonfly/blog/)。

# tsql - SQL 行数与顶部

> ID：863714
> 
> 赞同：14
> 
> 时间：2009-05-14T14:41:01.263
> 
> 标签：tsql

和有什么区别

```
Set Rowcount X 
```

和

```
Select Top X *
From Z 
```

在 TSQL 中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-14T14:43:09.370

主要区别在于，它`top`只会影响您正在运行的查询，而`set rowcount`将与连接保持一致并应用于在该连接中执行的所有查询。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T14:46:19.613

Top可以为你做更多的事情。一方面，您可以指定百分比，而不是整数。您还可以处理列值出现关联的情况。

[http://technet.microsoft.com/en-us/library/ms189463.aspx](http://technet.microsoft.com/en-us/library/ms189463.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T14:52:58.503

在旧版本的 SQL Server（2005 和更早版本，我不确定 2008）中，您不能在 top 语句中使用变量，因此：

```
declare @rc int

set @rc=10

select top @rc * from myTable --Wont work

set rowcount @rc
select * from myTable --Will work 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-20T07:19:29.880

2008年及以上允许

```
declare @rc int

set @rc=10000

select top (@rc) * from myTable --will now work 
```

但只有当您使用 () 时，才能使用以下提示：

```
OPTION ( OPTIMIZE FOR (@rc= 15) ) 
```

最后允许选择一切，但针对更常见的情况进行优化

# vb.net - VB.NET 和 AutoDesk Inventor 11 自定义问题

> ID：863716
> 
> 赞同：1
> 
> 时间：2009-05-14T14:41:41.980
> 
> 标签：vb.net, visual-studio-2005, vista64

我已经浏览了该站点和 Internet，试图找到解决我正在尝试创建的 VB.NET 应用程序问题的方法。不幸的是，我被一条阻止我继续进行任何 Inventor 自定义的错误消息难住了。

```
Tools: Visual Studio 2005 sp1, Inventor 11 Stand Alone install
OS: Windows Vista 64 sp1 
```

我在 SDK 文件夹下安装了开发者工具。然后，我在 COM 中的 VB.NET 项目中添加了对名为 AutoDesk Inventor 对象库的组件的引用。它在我的项目的引用下显示为：

```
Reference Name: Autodesk Inventor Object Library
Type: COM
Version: 1.0.0.0
Copy Local: True
Path: C:\Users\rschmalt\Visual Studio 2005\Projects\
        InvTest\InvTest\obj\Debug\Interop.Inventor.dll 
```

我的代码如下：

```
'Opens Inventor Apprentice session to read part numbers

Dim oApprentice As New Inventor.ApprenticeServerComponent
Dim asmDoc As Inventor.ApprenticeServerDocument
Dim refDoc As Inventor.ApprenticeServerDocument

asmDoc = oApprentice.Open(strIAMLocation)

For Each refDoc In asmDoc.ReferencedDocuments
  MessageBox.Show(refDoc.FullFileName.ToString)
Next 
```

当我执行它时，我收到以下消息：

> `Retrieving the COM class factory for component with CLSID {C343ED84-A129-11D3-B799-0060B0F159EF} failed due to the following error: 80040154`

我尝试直接浏览到 DLL ( `Interop.Inventor.dll`)，然后它在引用中显示为 .NET 类型，但错误仍然相同。

vista 64（Inventor 11是32位）之间是否可能存在冲突？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T14:47:57.360

看看这些

[http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/88a6ea68-f476-4231-822f-27fabe59f458](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/88a6ea68-f476-4231-822f-27fabe59f458)

[http://social.msdn.microsoft.com/Forums/en-US/sqlsmoanddmo/thread/b20d3e7d-0577-44a5-8cc3-bbc4ecb62fd7](http://social.msdn.microsoft.com/Forums/en-US/sqlsmoanddmo/thread/b20d3e7d-0577-44a5-8cc3-bbc4ecb62fd7)

# structuremap - 使用 Structuremap 的真正开源项目？

> ID：863723
> 
> 赞同：0
> 
> 时间：2009-05-14T14:42:11.713
> 
> 标签：structuremap

我想学习结构映射以及如何安排/构建我的 DI 代码，是否有任何使用 StructureMap 的开源项目可供我参考？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-17T13:15:54.923

[代码营服务器](http://code.google.com/p/codecampserver/)

*   [一些 StructureMap 配置](http://code.google.com/p/codecampserver/source/browse/trunk/src/DependencyResolution/DependencyRegistry.cs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-11T10:22:26.037

[AtomSite](http://code.google.com/p/atomsite/) - ASP.NET MVC 博客应用程序。

# solidworks - 插入块而不指定 MathPoint。改为附加到鼠标

> ID：863727
> 
> 赞同：1
> 
> 时间：2009-05-14T14:43:01.570
> 
> 标签：solidworks

我正在使用 MakeSketchBlockFromFile 函数以编程方式将块插入到图形中。此函数需要一个 MathPoint 作为块的位置，但我想让用户将块放在绘图上。我基本上想模仿 Tools-Block-Insert 菜单项的功能。

是否有我错过的另一个 API 函数允许我插入一个块，但将该块附加到鼠标而不是指定特定位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T03:18:58.667

我有一段时间没有进行任何solidworks编程，但似乎返回一个为您提供鼠标位置的数学点的唯一方法是

```
SwManipulatorHandler2::OnUpdateDrag 
```

我怀疑这是您可以通过创建这些操纵器之一并让用户定位它然后在该位置创建块的唯一方法。

旁白：我对您为什么要复制已经存在的功能感到有些困惑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T11:55:30.487

我继承了 DataObject 类并使用 DoDragDrop 允许用户将块拖到绘图中。像冠军一样工作。

# matlab - 如何确定在 MATLAB 中从哪里打印数字？

> ID：863734
> 
> 赞同：9
> 
> 时间：2009-05-14T14:44:08.667
> 
> 标签：matlab

在 MATLAB 中，如何判断变量在代码中的哪个位置获得输出？

我有大约 10K 行 MATLAB 代码，大约有 4 人在处理它。在某个地方，有人以典型的方式在 MATLAB 脚本中转储了一个变量：

```
foo 
```

不幸的是，我不知道输出的是什么变量。并且输出混淆了其他更重要的输出。

有任何想法吗？

ps 有人尝试过覆盖 Standard.out 吗？既然 MATLAB 和 Java 集成如此紧密，那行得通吗？面对这个问题时，我在 Java 中使用的一个技巧是用我自己的版本替换 Standard.out。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T16:07:50.820

哦，我也讨厌这个。我希望 Matlab 有一个“dbstop if display”来完全停止这一点。

来自weiyin 的mlint 遍历是个好主意。但是，Mlint 看不到动态代码，例如 eval() 的参数或字符串值的图形句柄回调。我在这样的回调中遇到了这样的输出，其中 update_table() 在某些条件下返回了一些东西。

```
uicontrol('Style','pushbutton', 'Callback','update_table') 
```

您可以在内置类型中“打孔”一个方法，为您提供 dbstop 的钩子。在 Matlab 路径上的目录中，创建一个名为“@double”的新目录，并像这样创建一个@double/display.m 文件。

```
function display(varargin)
builtin('display', varargin{:}); 
```

然后你可以做

```
dbstop in double/display at 2 
```

并运行您的代码。现在，无论何时 display 被省略的分号隐式调用，包括从动态代码中调用，您都将被放入调试器。为@double 做这件事似乎也涵盖了字符和单元格。如果显示的是不同的类型，您可能需要进行试验。

您可能会以相同的方式覆盖内置的 disp() 。我认为这类似于 Java 的 System.out 流的自定义替代品。

不用说，向内置类型添加方法是非标准的、不受支持的、非常容易出错的，并且在调试会话之外需要非常小心。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T15:16:37.450

这是 mLint 将帮助您找到的典型模式：

![替代文字](https://blogs.mathworks.com/images/videos/Other%20Pics/SO%20mlint.jpg)

因此，请查看编辑器右侧的橙色线条。这不仅可以帮助您找到这种优化，还可以帮助您找到更多。另请注意，您的变量名称已突出显示。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T14:50:36.403

如果你有这样一行：

```
foo = 2 
```

并且没有“;” 最后，输出将被转储到屏幕上，变量名首先出现：

```
foo =

     2 
```

在这种情况下，您应该在文件中搜索字符串“foo =”并找到缺少“;”的行。

如果您看到没有出现变量名的输出，则可能是使用[DISP](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/disp.html)或[FPRINTF](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fprintf.html)函数将输出转储到屏幕上。在文件中搜索“disp”或“fprintf”应该可以帮助您找到数据的显示位置。

如果您看到出现变量名称“ans”的输出，则表示正在完成计算，未将其放入变量中，并且缺少“;” 在行尾，例如：

```
size(foo) 
```

一般来说，这是显示代码中正在发生的事情的一种不好的做法，因为（正如您所发现的）很难找到它们在一大段代码中的放置位置。在这种情况下，找到违规行的最简单方法是使用[MLINT](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/mlint.html)，正如其他答案所建议的那样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T20:41:56.123

我喜欢“dbstop if display”的想法，但这不是我所知道的 dbstop 选项。

如果一切都失败了，那么还有希望。Mlint 是个好主意，但是如果有成千上万行和许多功能，那么您可能永远找不到违规者。更糟糕的是，如果这段代码写得很草率，就会出现无数的 mlint 标志。你将如何缩小范围？

一个解决方案是在那里展示你的方式。我会重载显示功能。只是暂时的，但这会起作用。如果输出被转储到命令行

```
ans = 
      stuff 
```

或作为

```
foo = 
      stuff 
```

然后它已经用显示写出来了。如果它刚出来

```
stuff 
```

那么 disp 是罪魁祸首。为什么这有关系？使罪犯超载。在 MATLAB 搜索路径顶部的某个目录中创建一个名为 @double 的新目录（假设输出是一个双精度变量。如果它是字符，那么您将需要一个 @char 目录。）不要将 @ MATLAB 搜索路径上的双目录本身，只需将其放在路径上的某个目录中即可。

在这个目录中，放置一个名为 disp.m 或 display.m 的新 m 文件，这取决于您对命令行输出的确定。m 文件的内容将是对内置函数的调用，这将允许您随后调用内置版本的 disp 或在输入上显示。

现在，在新函数中设置一个调试点。每次输出到屏幕时，都会调用这个函数。如果有多个事件，您可能需要使用调试器来允许处理继续进行，直到攻击者被捕获。最终，这个过程将困住进攻线。请记住，您在调试器中！使用调试器来确定调用 disp 的函数以及在何处调用。您可以跳出 disp 或 display，或者只查看 dbstack 的内容以了解发生了什么。

当一切都完成并修复问题后，删除这个额外的目录，以及你放入其中的 disp/display 函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T18:26:13.827

您可以将 mlint 作为函数运行并解释结果。

```
>> I = mlint('filename','-struct');
>> isErrorMessage = arrayfun(@(S)strcmp(S.message,...
      'Terminate statement with semicolon to suppress output (in functions).'),I);
>>I(isErrorMessage ).line 
```

这只会在该单个文件中找到丢失的分号。所以这必须在从某个主函数调用的文件（函数）列表上运行。

如果您想查找对 disp() 或 fprintf() 的调用，则需要读入文件文本并使用正则表达式来查找调用。

注意：如果您使用的是脚本而不是函数，则需要将上述消息更改为：“用分号终止语句以抑制输出（在脚本中）。”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-06T19:47:33.537

Andrew Janke 的重载是一个非常有用的提示，唯一的另一件事是代替使用 dbstop，我发现以下方法效果更好，原因很简单，在 display.m 中停止会导致执行暂停，每次调用 display.m，即使什么都没有写。

这样，只有在调用 display 写入非空字符串时才会触发停止，并且您不必逐步执行大量无用的 display 调用

```
function display(varargin)
builtin('display', varargin{:});
if isempty(varargin{1})==0
keyboard
end 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-03T10:06:03.263

定位此类事物的一种万无一失的方法是在调试器中迭代地单步执行代码并观察输出。这将按如下方式进行：

1.  在产生不需要的输出的最高级别脚本/函数的第一行添加一个断点。运行函数/脚本。
2.  越过线条（不介入），直到看到不需要的输出。
3.  当你找到产生输出的行/函数时，要么修复它，如果它在这个文件中，或者打开产生输出的子函数/脚本。去掉上层函数的断点，在下层函数的第一行放一个断点。从步骤 1 开始重复，直到找到产生输出的行。

虽然很痛苦，但除非你有巨大的函数/脚本，否则你会相对快速地找到这条线，无论如何这都是不好的做法。如果脚本是这样的，您可以使用一种分区方法以类似的方式在函数中定位行。这将涉及在开始处放置一个断点，然后是一半，并注意函数的哪一半产生输出，然后再次减半，依此类推，直到找到该行。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-08-28T17:53:41.773

我在使用更小的代码时遇到了这个问题，而且它很麻烦，所以即使 OP 找到了他们的解决方案，我也会发布一个我学到的小作弊。

1) 在 Matlab 命令提示符下，打开“更多”。

```
more on 
```

2) 将窗口的 prompt-y/terminal-y 部分调整为仅一行文本的高度。

3) 运行代码。它会在需要打印的地方停下来，因为没有空间来打印它（更多是在 [space] 或 [down] press 上阻塞）。

4) 按 [ctrl]-[C] 在程序无法打印的地方终止程序。

5) 将您的提示区域恢复为正常大小。从跟踪的顶部开始，单击红色文本中的可点击位。这些是你潜在的罪魁祸首。（当然，您可能需要按下 [down] 等，才能传递代码实际用于打印内容的部分。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-14T15:35:39.603

您需要遍历所有 m 文件（可能使用递归函数或 unix('find -type f -iname *.m') ）。对每个文件名调用 mlint：

```
r = mlint(filename); 
```

r 将是带有消息字段的（可能为空）结构。查找以“Terminate statement with semicolon to suppress output”开头的消息。

# sql-server - 使用 openrowset 将 Excel 文件读入临时表；我如何引用该表？

> ID：863735
> 
> 赞同：2
> 
> 时间：2009-05-14T14:44:28.663
> 
> 标签：sql-server, temp-tables, openrowset

我正在尝试编写一个存储过程，它将一个 Excel 文件读入一个临时表，然后处理该表中的一些数据，然后将该表中的选定行插入到一个永久表中。

所以，它是这样开始的：

```
SET @SQL = "select * into #mytemptable FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0', 'Excel 8.0;Database="+@file+";HDR=YES', 'SELECT * FROM [Sheet1$]')"

EXEC (@SQL) 
```

这似乎奏效了。

但是，如果我再尝试这样的事情：

```
Select * from #mytemptable 
```

我收到一个错误：

**无效的对象名称“#mytemptable”**

为什么无法识别 #mytemptable？有没有办法让存储过程的其余部分可以访问#mytemptable？

提前谢谢了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T14:53:43.493

我没有时间对此进行模拟，所以我不知道它是否会起作用，但请尝试将您的表称为“##mytemptable”而不是“#mytemptable”

我猜你的问题是在你 exec() sql 字符串之后你的表不在范围内。以两个磅符号开头的临时表是全局可访问的。

完成后别忘了放下它！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-29T00:42:15.083

我过去这样做的方法是：首先，使用 CREATE TABLE 创建#temp_table。其次，像往常一样构建动态查询，插入#temp_table 第三，使用 exec sp_executesql @sql。

使用此方法，您将不需要全局范围的##temp_table。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-22T15:32:41.367

您可以在同一范围内使用它，包括动态查询中的整个脚本：

```
DECLARE @strSQL nvarchar(max)
DECLARE @file varchar(100)

SET @file='c:\myfile.xls'
SET @strSQL=N'SELECT * INTO #mytemptable FROM OPENROWSET(''Microsoft.Jet.OLEDB.4.0'', ''Excel 8.0;Database='+@file+';HDR=YES'', ''SELECT * FROM [Sheet1$]'');'
SET @strSQL=@strSQL+N'SELECT * FROM #mytemptable'

EXECUTE sp_executesql @strSQL 
```

# c# - ASP.Net 代码隐藏无法从页面访问组件？

> ID：863747
> 
> 赞同：0
> 
> 时间：2009-05-14T14:46:52.170
> 
> 标签：c#, asp.net

由于未知原因，我有 1 个页面无法通过 ID 访问任何组件。

这是一些信息。该页面使用 asp:Content，因为该网站使用 MasterPage。在 asp:Content 中，此页面有一个 asp:FormView，其中包含一些我无法从 CodeBehind 访问的数据。

这是页面声明：

这是后面页面中无法编译的代码：

```
protected void FormView1_PreRender(object sender, EventArgs e)
{
    DateBirthdayValidator.MaximumValue = DateTime.Now.Date.ToString("dd-MM-yy");
} 
```

这是错误：

> 错误 2 当前上下文中不存在名称“DateBirthdayValidator”

我在谷歌搜索，我得到了一些关于使用 FindControl 的答案，但它不起作用。任何的想法？

## 编辑1：

我可以访问 FormView1 组件，但不能访问 EditItemTemplate 中的验证器。如何访问 EditTemplate 中的控件？

## 编辑2：

如果我尝试：`FormView1.FindControl("DateBirthdayValidator")`它编译但总是返回 null。所以仍然不起作用，但至少我可以访问 FormView1 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T15:23:48.087

```
protected void FormView1_PreRender(object sender, EventArgs e)
{
    if(FormView1.CurrentMode == FormViewMode.Edit)
        ((RangeValidator)FormView1.FindControl("DateBirthdayValidator")).MaximumValue = DateTime.Now.Date.ToString("dd-MM-yy");
} 
```

FormView 没有创建控件，直到它处于您想要的模式。由于 DateBirhdayValidator 处于编辑模式，因此需要在 CodeBehind 中进行验证，以确保仅在状态处于编辑状态时才找到控件。

我在[这里](http://www.codenewsgroups.net/group/microsoft.public.dotnet.framework.aspnet.webcontrols/topic9174.aspx)找到了解决方案，请参阅 Steven Cheng[MSFT] 的帖子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T14:49:52.990

问题是您在表单视图中声明的验证器在页面级别并不真正存在。它是您为`FormView`. 父控件可以实例化一个模板（零次、一次或多次，例如考虑 a 中的每一行`GridView`；因此，创建它的控件）。您应该尝试像这样访问它：

```
// Replace RangeValidator with the actual validator type, if different.
var v = (RangeValidator)myFormView.Row.FindControl("DateBirthdayValidator");
v.MaximumValue = ...; 
```

请注意，为了能够做到这一点，您的表单视图应该处于您声明验证器的模式（您可以使用`CurrentMode`属性检查）并且您应该已经调用`DataBind`将其绑定到数据源（以便至少单个行存在，因此创建了模板的一个实例）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T14:50:23.410

你`DateBirthdayValidator`在aspx页面中有声明吗？还要检查以确保 Visual Studio`DateBirthdayValidator`在您的页面的设计器文件中创建相应的声明。听起来很可能设计器文件缺少控件的声明。

# javascript - 以正确的方式添加 javascript 小部件代码

> ID：863755
> 
> 赞同：0
> 
> 时间：2009-05-14T14:48:52.803
> 
> 标签：javascript, internet-explorer, widget

我给客户 javscript 代码，在他们的网站上添加一个小部件。`</body>`目前我要求他们将其粘贴在标签上方：

```
<script type="text/javascript">
var myHost = (("https:" == document.location.protocol) ? "https://" : "http://");
document.write(unescape("%3Cscript src='" + myHost + "www.mywebsite.com/mycode.js.php?u="+encodeURIComponent(window.location.host)+"' type='text/javascript'%3E%3C/script%3E"));
</script> 
```

如您所见，代码根据页面 url 在 http 或 https url 下调用我的脚本。

有时，当网站 html 格式不正确时，该脚本可能会导致IE 浏览器上的[“操作中止”](http://blogs.msdn.com/ie/archive/2008/04/23/what-happened-to-operation-aborted.aspx)错误。

我想向客户发送将附加到该`<head>`区域的代码。

1.  从头部调用代码时如何处理 http/https？
2.  你知道它是否会解决操作中止的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:58:17.150

只需给他们 HTTPS 解决方案。

如果他们的页面是安全的，它会正常工作；如果不是，那么将安全对象嵌入到不安全的页面中没有任何问题。

```
<script type="text/javascript" src="https://www.mywebsite.com/mycode.js.php"></script> 
```

我可以看到您在查询字符串中传递了原始域。您可以从 JS 代码中获取它，而无需通过 GET 参数传递它。您可以使用该`document.referrer`属性进行检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T15:00:48.720

看起来谷歌以完全相同的方式处理他们的分析代码（我相信你知道）。你在你的代码中做什么？当我查看您提供的“操作中止”链接时，它说是在页面加载后执行代码的解决方案。

我建议将一个函数绑定到 onload 事件并在那里执行你的 DOM 操作代码。

# css - DotNetNuke solpartmenu 子菜单对齐

> ID：863757
> 
> 赞同：1
> 
> 时间：2009-05-14T14:49:23.457
> 
> 标签：css, dotnetnuke, cross-browser, skin

我创建了一个使用 solpartmenu 的皮肤。在使用子菜单的门户上，我在不同的浏览器中得到不同的行为：在 IE 和 Firefox 上，子菜单在父项的下方下拉，正如我所料。但是在 Safari 和 Chrome 上， 出现在页面的最左侧。我不认为我对我的 CSS 做了什么太奇怪的事情，但我似乎错过了一些东西。一个例子在这里： http: [//www.codeswell.com/tpabuilders](http://www.codeswell.com/tpabuilders)。我在下面添加了我的 solpartmenu 样式。如果需要，我可以添加完整的皮肤代码/CSS。

任何人都可以对此有所了解吗？

```
/* SolPartMenu styles */

.MainMenu_MenuItem 
{
    cursor: pointer;
    background-color: White;
    color: #006309;
    font-family: Times New Roman;
    font-size: 14px;
    font-weight: bold;
}

.MainMenu_RootMenuItemActive
{
    text-decoration: underline;
}

.MainMenu_RootMenuArrow 
{
    display: none; 
}

.MainMenu_MenuIcon
{
    width: 0px; 
    height: 0px;
}

.MainMenu_MenuArrow 
{
    display: none; 
}

.MainMenu_MenuItemSel
{
    cursor: pointer;
    background: White;
    color: Maroon;
    font-family: Times New Roman;
    font-size: 14px;
    font-weight: bold;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T16:25:11.807

我建议尝试在菜单项上设置显式宽度。我在 Chrome 中注意到它说子菜单项的宽度约为 1600 像素 - 这就是为什么它被推这么远的原因。

另外，我觉得我必须这样说，我不建议您使用 SolPartMenu 进行 DotNetNuke 导航。那里有更好的选择。你会一直对 SolPartMenu 感到头疼，根据我的经验，它不值得。

*   DNN 菜单（现在是核心菜单）（一些[文档](http://www.dotnetnuke.com/LinkClick.aspx?fileticket=9FBFt/1IiX8%3d&tabid=874&mid=2653)）
*   [房屋菜单](http://www.houseofnuke.com/Projects/HouseMenu/tabid/410/Default.aspx)（免费）
*   [Telerik RadMenu](http://www.telerik.com/products/aspnet-ajax/dnn.aspx)（商业）

# c# - 如何在 C# 中编码二进制 MIME 附件？

> ID：863759
> 
> 赞同：2
> 
> 时间：2009-05-14T14:49:29.247
> 
> 标签：c#, java, web-services, soap, mime

我需要通过 SwA（带附件的肥皂）将二进制附件发送到 JAVA 网络服务。在发现 .Net 不支持 SwA 后，我正在编写自己的客户端。如何对二进制 MIME 附件进行编码，以便 Java 服务能够对其进行解码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-02T21:40:24.520

答案是：你不编码它。它只是作为原始字节添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-01T08:26:02.847

我意识到这个问题很老，但其他人可能正在寻找类似的答案。

您确定需要编写自己的客户端吗？.NET WSE 长期以来一直支持 MTOM，并且 MTOM 被设计为与 SwA 向后兼容。在尝试编写自己的客户端之前，我会研究一下并尝试 MTOM .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T14:52:00.597

我建议您查看各种 MIME RFC，大部分它使用 Base64，幸好 .NET 已经处理了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T15:25:04.340

您可能想查看[System.Net](http://msdn.microsoft.com/en-us/library/system.net.aspx)和[System.Net.Mime](http://msdn.microsoft.com/en-us/library/system.net.mime.aspx)命名空间。那里的一些工作可能会为您完成。
特别看看[System.Net.Mail.Attachment](http://msdn.microsoft.com/en-us/library/system.net.mail.attachment.aspx)。

# asp.net - 使用 aspnet_regsql.exe 在已经成熟的数据库上设置 Windows 身份验证

> ID：863760
> 
> 赞同：0
> 
> 时间：2009-05-14T14:49:40.430
> 
> 标签：asp.net, sql, vb.net, sql-server-2005

我有一个数据库（使用 Microsoft SQL Server Management Studio Express），它目前在一个正常运行的应用程序中被大量使用。我将此应用程序移植到 Windows 身份验证，而不是当前存在的基本身份验证系统（或缺少该系统）。

我知道的最简单的设置方法是使用 aspnet_reegsql.exe 文件为我设置一些表。这显然会创建它的基本表，例如 dbo.aspnet_Roles、dbo.aspnet_Users 和 dbo.aspnet_UsersInRoles。

在当前数据库中，存在名为 dbo.Users、dbo.UserRole 和 dbo.UserRoleMapping 的表。当前为此数据库编写的许多存储过程都依赖于这些表。

是否有任何温和的方法可以适应 aspnet_regsql.exe 将创建的新表？可能让它在这些现有的表名上创建配置，而不是硬连线做什么？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T18:49:50.883

听起来你混淆了两个不同的东西。Windows 身份验证是一种将 Windows 登录名显示到数据库的方法。它通过使用“Windows 身份验证”连接到数据库在 SSMS 中工作。应用程序将在其[连接字符串](http://www.connectionstrings.com/)中指定：

```
Integrated Security=SSPI; 
```

而不是用户名和密码。这两个选项都将您当前的 Windows 凭据发送到数据库。一个示例 Windows 登录是 yourlaptop\chris。

另一方面，aspnet_regsql.exe 设置了一组表，允许预定义的 Microsoft“表单身份验证”工作。例如，[登录控件](http://msdn.microsoft.com/en-us/library/ms178331.aspx)需要这些表。使用 aspnet_regsql 控件时，您通常使用表单身份验证。您通过在网络表单上输入您的用户名和密码登录。有关更多会员示例，请参阅[此站点](http://msdn.microsoft.com/en-us/library/879kf95c.aspx)。

# php - Zend Framework html 表单输入元素与空格

> ID：863765
> 
> 赞同：1
> 
> 时间：2009-05-14T14:50:12.880
> 
> 标签：php, html, zend-framework

当我创建这样的 html 表单时：

```
$form = new Zend_Form();
$form->setMethod('post');
$form2->addElement('textarea', 'Name with Space'); 
```

HTML 变为：

```
...
<textarea name="NamewithSpace" id="NamewithSpace" rows="24" cols="80"></textarea>
... 
```

**提到输入名称变成驼峰！**

当我调用 $form->getValues(); 在填充了 textarea 的帖子之后，结果是：

```
array('Name with Space' => NULL); // Whitespace name! But value empty! 
```

当我调用 $this->getRequest(); 在填充了 textarea 的帖子之后，结果是：

```
array('NamewithSpace' => 'filled in value'); // Camelcase name! Value filled, but name changed! 
```

**如何使用设置的名称“带空格的名称”访问填充的值？**

我正在使用 ZF 1.7.6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T15:24:59.457

不幸的是，我认为你不能！对于您必须具有在 ZF 中不可接受的元素名称的应用程序，您必须修改 ZF 源。

在 ZF 1.8.1 中，您需要更改以允许空格（和任何其他字符）的正则表达式位于 Zend/Form/Element.php 的第 424 行

一种可能的（更好的）解决方案是创建一个自定义元素并覆盖 filterName 方法，但是如果您希望更改多个元素类型，这不是很实用。

肯定有更好的解决方案？！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T16:25:25.833

将`$form->getValues()`始终向您显示您在表单对象上设置的原始键和值，因为这些在表单发布后不会更新。但是，您可以通过以下方式利用它来发挥自己的优势：

```
$textarea = $form->getElement('Name with Space');
$key      = str_replace(' ', '', trim($textarea->getName())); 
```

在请求对象上使用该键，应该可以让您访问您所追求的值。这有点骇人听闻，但看起来它可能会起作用。

# java - JSF 和 HTML 表单的 Unicode 问题？

> ID：863767
> 
> 赞同：3
> 
> 时间：2009-05-14T14:50:33.940
> 
> 标签：java, html, unicode, jsf

我有一个由 JSF 生成的 HTML 表单，它将一个输入元素映射到一个 bean 设置器，在我看来，JSF 在进入的过程中会混淆 unicode 输入。特别是我在设置器中放置了以下异常用于测试目的

```
public void setTitle(String title){
    System.out.println("title set with: "+title+"\n");
    if (title.startsWith("xxx")) {
        throw new RuntimeException("debug exception "+title);
    }
    this.title = title;
} 
```

然后我将以下文本放入表单标题输入元素中：“xxxx 海陆”。然后，当我提交表单时，我会看到日志打印

```
title set with: xxxx ????? 
```

（在 unicode 兼容的 mac 终端上）。我在响应 HTML 页面上收到一条错误消息：

```
Error setting property 'title' in bean of type   
uk.ac.lancs.e_science.sakaiproject.api.blogger.post.Post: 
java.lang.RuntimeException: debug exception xxxx ���?? 
```

关于出了什么问题的任何线索？我只是充满了它并且有错误的诊断吗？我想我已经排除了所有其他可能性。Unicode 似乎在同一应用程序的其他组件中运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T15:53:37.470

Questions I would be asking:

*   How is the form encoding the request (application/x-www-form-urlencoded or multipart/form-data)? Multi-part data will be decoded using a 3rd party MIME parser, so there is scope for trouble there. If the data is url-encoded, is it being escaped properly?
*   What charsets is the browser [accepting](http://en.wikipedia.org/wiki/HTTP_headers)?
*   What [encoding is the server detecting](http://java.sun.com/javaee/5/docs/api/javax/faces/context/ExternalContext.html#getRequestCharacterEncoding())? Is it a Unicode character set?
*   Is it just the logging that is writing as a [lossy encoding](http://illegalargumentexception.blogspot.com/2009/05/java-rough-guide-to-character-encoding.html#javaencoding_lossyconversions) (e.g. [MacRoman](http://en.wikipedia.org/wiki/Macroman))? What [default charset](http://java.sun.com/javase/6/docs/api/java/nio/charset/Charset.html#defaultCharset()) is the server using?

Since what you see on a console isn't necessarily what is in the string, you can dump the [Unicode code points](http://www.unicode.org/charts/) using this code:

```
 public static void printCodepoints(char[] s) {
    for (int i = 0; i < s.length; i++) {
      int codePoint = Character.isHighSurrogate(s[i]) ? Character
          .toCodePoint(s[i], s[++i])
          : s[i];
      System.out.println(Integer.toHexString(codePoint));
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T15:01:33.630

浏览器无法通过网络发送 unicode；它必须以某种方式对 unicode 进行编码。从异常的输出（两个汉字变成五个字符），我猜数据被编码为 UTF-8，并且`title`在组件的服务器端接收后字符串没有正确解码。

我建议`accept-charset`为表单设置属性。这应该告诉每个人都要守规矩。

# python - 如何在 Python 中生成带有命名空间的 XML 文档

> ID：863774
> 
> 赞同：24
> 
> 时间：2009-05-14T14:51:01.440
> 
> 标签：python, xml, dom, namespaces

我正在尝试生成一个带有命名空间的 XML 文档，目前使用 Python 的 xml.dom.minidom：

```
import xml.dom.minidom
doc = xml.dom.minidom.Document()
el = doc.createElementNS('http://example.net/ns', 'el')
doc.appendChild(el)
print(doc.toprettyxml()) 
```

命名空间已保存（`doc.childNodes[0].namespaceURI`is `'http://example.net/ns'`），但为什么输出中缺少它？

```
<?xml version="1.0" ?>
<el/> 
```

我预计：

```
<?xml version="1.0" ?>
<el xmlns="http://example.net/ns" /> 
```

或者

```
<?xml version="1.0" ?>
<randomid:el xmlns:randomid="http://example.net/ns" /> 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-14T15:26:47.220

`createElementNS()`定义为：

```
def createElementNS(self, namespaceURI, qualifiedName):
    prefix, localName = _nssplit(qualifiedName)
    e = Element(qualifiedName, namespaceURI, prefix)
    e.ownerDocument = self
    return e 
```

所以……</p>

```
import xml.dom.minidom
doc = xml.dom.minidom.Document()
el = doc.createElementNS('http://example.net/ns', 'ex:el')
#--------------------------------------------------^^^^^
doc.appendChild(el)
print(doc.toprettyxml()) 
```

产量：

```
<?xml version="1.0" ?>
<ex:el/> 
```

…不完全在那里…</p>

```
import xml.dom.minidom
doc = xml.dom.minidom.Document()
el = doc.createElementNS('http://example.net/ns', 'ex:el')
el.setAttribute("xmlns:ex", "http://example.net/ns")
doc.appendChild(el)
print(doc.toprettyxml()) 
```

产量：

```
<?xml version="1.0" ?>
<ex:el xmlns:ex="http://example.net/ns"/> 
```

或者：

```
import xml.dom.minidom
doc = xml.dom.minidom.Document()
el = doc.createElementNS('http://example.net/ns', 'el')
el.setAttribute("xmlns", "http://example.net/ns")
doc.appendChild(el)
print(doc.toprettyxml()) 
```

产生：

```
<?xml version="1.0" ?>
<el xmlns="http://example.net/ns"/> 
```

看起来你必须手动完成。`Element.writexml()`没有迹象表明命名空间会得到任何特殊处理。

编辑：此答案仅针对`xml.dom.minidom`，因为 OP 在问题中使用了它。我并不是说一般不可能在 Python 中使用 XML 命名空间。;-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-14T23:39:29.657

此功能已被提出；一个补丁正在[Python 错误数据库中沉睡](http://bugs.python.org/issue1621421)。有关解决方法，请参阅 Tomalak 的答案（简而言之：手动添加`xmlns`属性）。

# javascript - 如何在 HTML 文本区域中添加换行符？

> ID：863779
> 
> 赞同：170
> 
> 时间：2009-05-14T14:52:02.220
> 
> 标签：javascript, html, textarea, line-breaks

我正在`<textarea>`用 JavaScript 编辑一个。问题是当我在其中换行时，它们不会显示。我怎样才能做到这一点？

我得到了编写函数的价值，但它不会换行。

* * *

## 回答 #1

> 赞同：293
> 
> 时间：2009-05-14T14:55:09.777

问题来自于换行符（`\n\r`？）与 HTML`<br/>`标记不同的事实

```
var text = document.forms[0].txt.value;
text = text.replace(/\r?\n/g, '<br />'); 
```

**更新**

由于许多评论和我自己的经验告诉我这个`<br>` 解决方案没有按预期工作这里是一个如何将新行附加到`textarea`using '\r\n'的示例

```
function log(text) {
    var txtArea ;

    txtArea = document.getElementById("txtDebug") ;
    txtArea.value +=  text + '\r\n';
} 
```

我决定对此进行编辑，而不是作为一个新问题，因为这是一个太受欢迎的答案，不会是错误的或不完整的。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-01-19T06:30:15.620

如果您使用通用 java 脚本并且需要将字符串分配给文本区域值，那么

```
 document.getElementById("textareaid").value='texthere\\\ntexttext'. 
```

你需要更换`\n`或`< br >``\\\n`

否则它会`Uncaught SyntaxError: Unexpected token ILLEGAL`在所有浏览器上提供。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-14T14:54:20.857

你需要在`\n`里面`linebreaks`使用`textarea`

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-05-31T13:59:35.650

也许有人觉得这很有用：

我遇到了从服务器变量传递到javascript变量的换行符问题，然后javascript将它们写入textarea（使用knockout.js值绑定）。

解决方案是双重转义新行：

```
orginal.Replace("\r\n", "\\r\\n") 
```

在服务器端，因为只有单个转义字符 javascript 没有被解析。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-06-10T21:09:18.353

如果要在自己的页面中显示文本，可以使用`<pre>`标签。

```
document.querySelector('textarea').addEventListener('keyup', function() {
  document.querySelector('pre').innerText = this.value;
});
```

```
<textarea placeholder="type text here"></textarea>
<pre style="font-family: inherits">
The
new lines will
be respected
      and spaces too
</pre>
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-03-30T19:50:45.823

我有一个 id 为**#infoartist**的 textarea如下：

```
<textarea id="infoartist" ng-show="dForm" style="width: 100%;" placeholder="Tell your contacts and collectors about yourself."></textarea> 
```

在 javascript 代码中，我将获取 textarea 的值并用`<br />`标签替换转义换行符 (\n\r)，例如：

```
var text = document.getElementById("infoartist").value;
text = text.replace(/\r?\n/g, '<br />'); 
```

因此，如果您使用的是 jquery（像我一样）：

```
var text = $("#infoartist").val();
text = text.replace(/\r?\n/g, '<br />'); 
```

希望对您有所帮助。:-)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-14T14:54:28.313

新行只是浏览器的空格，不会被视为与普通空格（“”）有任何不同。要获得新行，您必须插入`<BR />`元素。

解决问题的另一种尝试：在 textarea 中键入文本，然后在按钮后面添加一些 JavaScript 以将不可见字符转换为可读的内容并将结果转储到`DIV`. 这将告诉您浏览器想要什么。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-23T22:29:25.953

这是我为同样的麻烦所做的事情。

当我在jsp中将文本传递到下一页时，我将其作为文本区域阅读，而不是阅读类似的内容

所以输出如你所愿。对于其他属性，您可以使用如下。

```
<textarea style="background-color: white; border: none; width:660px;font-family: Arial, Helvetica, sans-serif; font-size:1.0em; resize:none;" name="text" cols="75" rows="15" readonly="readonly" ><s:property value="%{text}"/></textarea> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-05T13:17:25.580

如果您只需要使用换行符将[testarea的值发送到服务器，请使用 nl2br](http://php.net/manual/en/function.nl2br.php)

# css - 是否有任何可以实时显示转换的 XML/XSL 编辑器？

> ID：863781
> 
> 赞同：1
> 
> 时间：2009-05-14T14:52:40.610
> 
> 标签：css, xml, editor, xslt

我正在将我们所有的 Crystal Reports 转换为使用自制的报告系统。本质上，我将报表对象序列化为 XML，然后使用 XSL 将其转换为 HTML/CSS。除了设计过程之外，一切都很好。

一旦我正确构建了 XML，我必须在 SciTE 中打开 XSL 和 CSS，编辑，在 IE 中重新加载，起泡，冲洗，重复。如果有一个 XML/XSL 编辑器可以实时显示转换并加快我的流程，我会很高兴。任何人都可以提出任何建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T15:36:05.577

您可以使用 Altova XmlSpy 来创建/编辑 xml/xslts、获取 xslt 输出、调用 Web 服务、评估数据库中的 xqueries 等等。它是一个非常强大的通用 xml 工具。不过需要执照。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-15T21:23:18.280

这是一个在线 javascript 编辑器。

[http://www.purplegene.com/static/transform.html](http://www.purplegene.com/static/transform.html)

无论您是 Windows、Linux 还是 Mac 用户，它都可以轻松工作！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T15:03:06.547

XSL / XSLT 编辑器`<oXygen/>`可以进行 XHTML 预览。[请参阅http://www.oxygenxml.com/xslt_editor.html](http://www.oxygenxml.com/xslt_editor.html)的“预览转换结果”部分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T15:07:00.950

Visual Studio 与[XML Notepad](http://www.codeplex.com/xmlnotepad)一样支持 XSLT 处理。

XML 记事本是免费的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T15:09:42.690

我在 Visual Studio 中使用过 XSLT 调试器。很有用。

[http://msdn.microsoft.com/en-us/library/ms255605.aspx](http://msdn.microsoft.com/en-us/library/ms255605.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T18:54:54.773

Syntext Serna 提供基于 XSLFO 的 XML 实时 WYSIWYG 视图。

# ruby - 试图了解在 Ruby 中使用 self.method_name 与 Classname.method_name

> ID：863782
> 
> 赞同：14
> 
> 时间：2009-05-14T14:52:42.547
> 
> 标签：ruby

我试图了解何时使用 self.method_name 与何时使用 Classname.method_name。

在下面的示例中，为什么“before_create”需要引用“User.hash_password”而不是“self.hash_password”或只是“hash_password”？

由于我们已经在 User 类中，我认为 before_create 方法会“知道”“hash_password”是它自己的类的成员，并且不需要任何特殊的语法来引用它。

```
require 'digest/sha1'

class User < ActiveRecord::Base

  attr_accessor :password
  attr_accessible :name, :password

  validates_presence_of :name, :password
  validates_uniqueness_of :name

  def before_create
    self.hashed_password = User.hash_password(self.password)
  end

  def after_create
    @password = nil
  end

  def self.login(name, password)
    hashed_password = hash_password(password || "")
    self.find(:first, :conditions => ["name = ? and hashed_password = ?", name, hashed_password])
  end

  def try_to_login
    User.login(self.name, self.password)
  end

  private

  def self.hash_password(password)
    Digest::SHA1.hexdigest(password)
  end

end 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T15:56:29.490

您正在询问类方法和实例方法之间的区别。

有几种定义类方法的方法：

```
class Klass
  def Klass.method_name
    ..
  end
end 
```

这与执行以下操作相同：

```
class Klass
  def self.method_name
    ..
  end
end 
```

或首选的红宝石成语：

```
class Klass
  class << self
    def method_name
      ..
    end
  end
end 
```

如果已经声明了 Klass，您也可以这样做..

```
def Klass.method_name
  ..
end 
```

或者：

```
class << Klass
  def method_name
    ..
  end
end 
```

或者你甚至可以使用 Module#extend:

```
Klass.extend(Module.new { def method_name; puts 'ducky'; end }) 
```

就像您将单例方法添加到对象一样。事实上，类方法是在类级别上操作的单例方法。

例如，在 rails ActiveRecord 中，您有一个可以在任何模型上使用的类方法“find”：

```
Person.find(1) 
```

以及对单个对象进行操作的实例方法，例如“保存”

```
person = Person.find(1)
...
person.save 
```

在我正在处理的当前项目中，我有一个包含数据提要的模型提要。我需要定期运行一个更新所有提要的方法，所以我有一个 fetch_all 方法来完成这个。

```
class Feed < ActiveRecord::Base 

  // class method Feed.fetch_all
  def self.fetch_all
    Feed.all.each do |feed|
      feed.fetch_value
    end
  end

  // instance method
  def fetch_value
    // grabs updated value and saves 
  end
end 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-14T15:01:06.910

```
def before_create
   self.hashed_password = User.hash_password(self.password)
end 
```

在这个例子中，`User.hash_password`调用*类*`hash_password`的方法，而调用*这个特定实例*的方法。 *`User``self.hashed_password=``hashed_password=`*`User`**

 **如果你用 替换`User.hash_password`，`self.hash_password`Ruby 会用 a 抱怨，因为类中不存在`NoMethodError`名为 的实例方法。不过，您可以将其替换为。`hash_password``User``self.class.hash_password`

如果您`self.hashed_password=`简单地替换为`hashed_password=`，Ruby 将创建一个名为的局部变量`hashed_password`，而不是调用实例方法`hashed_password=`。`self`如果要调用属性编写器，则需要显式添加。

`self`方法定义 ( `def self.hash_password`) 中的`hash_password`生成类方法而不是实例方法。在这种情况下，`self`指的是*类*。在实例方法的上下文中，`self`指的是一个*实例*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T14:58:49.973

我还没有深入研究 Ruby，但根据您的描述，我会说 hash_password 是一种静态方法，或者能够以静态方式使用。

# windows - 注销时 Windows 不会以编程方式关闭

> ID：863783
> 
> 赞同：1
> 
> 时间：2009-05-14T14:52:49.067
> 
> 标签：windows, windows-services, shutdown

我有一个使用本地管理员帐户从服务中启动的应用程序。此应用程序可通过网络浏览器访问，主机 PC 可通过此界面关闭。

如果用户登录到主机 PC 并且我浏览到它并关闭它，应用程序将退出并按照我的预期关闭 PC - 使用 ExitWindowsEx() （启用关闭权限）。

但是，如果 PC 已注销，我浏览到它 - 应用程序仍在服务中运行，并尝试使用 ExitWindowsEx() 关闭，它返回成功并且似乎没有问题，但 PC 永远不会关闭。

我也尝试过 InitiateSystemShutdown() ，它奇怪地失败并返回错误 2！（该系统找不到指定的文件）。

我使用什么帐户来启动应用程序似乎并不重要。

任何帮助将不胜感激！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T16:28:41.120

可悲的是，无法复制。我有一个预先存在的服务，它公开了一个邮槽，所以我添加了代码：

```
void RebootThisMachine ()
{
   if (GrabPrivilege (SE_SHUTDOWN_NAME))
   {
      if (!InitiateSystemShutdown (NULL,NULL,0,TRUE,TRUE))
      {
         wsprintf (g_szDebug, TEXT("RebootMachine - ISS failed, error %d"),
                   GetLastError()) ;
         DebugMessage (DEBUG_ERROR, g_szDebug) ;
      }
   }
   else
   {
      wsprintf (g_szDebug, TEXT("RebootMachine - cannot grab priv, error %d"),
                GetLastError()) ;
      DebugMessage (DEBUG_ERROR, g_szDebug) ;
   }
} 
```

并在我收到来自我编写的一个小命令行实用程序的邮件槽消息时调用它。InitiateSystemShutdown 是服务的正确 API，无论是否登录，它都会重新启动运行该服务的机器。如果我的（vista）机器没有登录，关机确实需要一段时间，但它最终会起作用（在说“关机”的 30-40 秒之后）。我的服务在 LocalSystem 下执行。GrabPrivilege 与我之前发布的代码相同。

因此，您可以从您尝试做的事情**是**可能的这一事实中振作起来。我看到您正在使用管理员帐户来运行您的服务。您是否尝试过在 LocalSystem 下运行服务以进行关机测试？也许您的管理员的权限与 LocalSystem 的权限不太匹配...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-18T17:28:02.633

您是否尝试过使用**shutdown.exe**工具？它报告什么错误？

我在使用 Windows XP x64 时遇到了同样的问题，但我是通过 WMI 远程执行的，但关机工具给了我同样的错误 (21)。有了这些信息，我遇到了这个修补程序：

[http://support.microsoft.com/kb/834100](http://support.microsoft.com/kb/834100)

由于目前手头没有 Windows 2003 Server，因此我无法对其进行测试，但也许它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T15:12:36.337

如果我[http://www.google.ca/search?hl=en&q=exitwindowsex+service](http://www.google.ca/search?hl=en&q=exitwindowsex+service)那么我找到的第一件事就是[http://www.eggheadcafe.com/software/aspnet/29901267/lockworkstation-and- exitw.aspx](http://www.eggheadcafe.com/software/aspnet/29901267/lockworkstation-and-exitw.aspx)这表明如果您的服务启用了“与桌面交互”标志（已弃用），则会出现问题。

然后人们在回复上述主题的各种消息中建议修复，例如[http://www.eggheadcafe.com/conversation.aspx?messageid=29901274&threadid=29901267](http://www.eggheadcafe.com/conversation.aspx?messageid=29901274&threadid=29901267) ......类似的东西可能会对你有所帮助。

另一种选择，这当然是一个 kludge，但避免使用建议的魔法，可能是运行第二个服务，它不与桌面交互：让第二个服务调用 ExitWindowsEx ...并使用任何 IPC（或服务-specific API）从第一个服务（或者可能来自应用程序）触发第二个服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T15:29:34.187

试试这段代码，告诉我们它的作用：

```
GrabPrivilege (SE_SHUTDOWN_NAME);
ExitWindowsEx (EWX_REBOOT|EWX_FORCE, 0); // or whatever EWX flags you want 
```

辅助功能：

```
BOOL  GrabPrivilege (LPCTSTR lpctPrivName) 
{
   TOKEN_PRIVILEGES newtkp;
   HANDLE hToken;
   BOOL   bRetVal = FALSE;

   if (OpenProcessToken (GetCurrentProcess(), 
                         TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, 
                         &hToken)) 
   {
      LookupPrivilegeValue (NULL, 
                            lpctPrivName, 
                            &newtkp.Privileges[0].Luid); 
      newtkp.PrivilegeCount = 1;  // one privilege to set
      newtkp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED; 

      if (AdjustTokenPrivileges (hToken, 
                                 FALSE, 
                                 &newtkp, 
                                 0, 
                                 (PTOKEN_PRIVILEGES) NULL, 
                                 0))
      {
         DWORD dwRet = GetLastError();
         if (dwRet == ERROR_SUCCESS) bRetVal = TRUE;
      }
   }
   CloseHandle (hToken);
   return bRetVal;
} 
```

# visual-studio-2008 - 安装 VS2008 SP1 - 错误

> ID：863787
> 
> 赞同：2
> 
> 时间：2009-05-14T14:53:02.047
> 
> 标签：visual-studio-2008, visual-studio-2008-sp1

我一直在尝试安装 SP1 VS2008，但出现此错误：

```
vs90sp1\VC_IA64Runtime.exe - Exe installer's log file/hint (%temp%\dd_VC_IA64Runtime*.txt|%temp%\..\dd_VC_IA64Runtime*.txt) does not exist or is invalid. 
```

操作系统 Vista 32 位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T14:57:14.767

你试过[这个](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=362464)吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-11T20:29:16.763

我确定您仍然没有遇到此问题，但我只是遇到了同样的问题，并且能够通过卸载 Remote Debugger 然后安装 SP1 来解决它。起初我无法卸载 SP1，我需要先禁用所有只读驱动器（例如虚拟 CD 驱动器、物理 CD 驱动器和空记忆棒驱动器），然后才能这样做（不知道为什么）。从那里我能够安装 SP1，尽管我还需要安装 SP1 ATL 安全更新以使 VS 进入工作状态。

# sql - How much calculation should be done by MySQL?

> ID：863790
> 
> 赞同：3
> 
> 时间：2009-05-14T14:53:13.260
> 
> 标签：sql, mysql

I am writing an application and using MySQL to return the difference between 2 dates in MySQL should MySQL do this or should I actually let PHP handle it?

I also just need the sum of all the results I am getting back should I return them and add them up on the php side or is there a way to add all the results together on the MySQL Server side?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T14:56:21.943

It depends somewhat on the application, but in general, I'd push it to the PHP, because normally you're building a web site for multiple concurrent accesses; why put the calculation into the database and potentially have a bottle neck?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T16:33:42.507

I think that you have two separate cases here. In the case where you are returning two values and performing a calculation on them, then doing that on the front end probably makes the most sense as long as it's not a complex calculation that requires significant business logic. If it does involve complex or specialized business logic then you should have a central place for that logic, whether it is in a business layer or in the database, so that it is done consistently. If you're just finding the difference between two dates or something, then just do it on the front end.

In the second case, where you are summing values, that sounds like something that should probably be done in the database. Networks tend to be much more of a bottleneck than modern day databases on today's hardware. Save sending a bunch of rows over the network just to add them up if you can just do it in the database.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T15:01:02.993

There's no good answer to that. I personally do as much as possible in SQL but mostly because I can, not because I should.

And yes, you can ask MySQL to calculate a sum:

```
SELECT id, SUM(price) FROM items GROUP BY id WITH ROLLUP 
```

The last result, the one with id equals NULL, is going to contain sum for all the rows.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T15:01:40.793

If it's thousands of different numbers I'd try to do it on the database side. What Charlie said is pretty much the usual. I often do calculations in a database and add them as an additional column just in case I needed to do server side sorting, but this is obviously not your case.

# wcf - 我们如何在 WCF 中透明地序列化 Dataset ExtendedProperties？

> ID：863792
> 
> 赞同：3
> 
> 时间：2009-05-14T14:53:17.130
> 
> 标签：wcf, serialization, dataset

我们正在**从 Remoting 迁移到 WCF**，这是一个非常大的应用程序，它大量使用 DataSet。我们使用 DataSet 表的 ExtendedProperties 来存储包含我们在客户端需要的特殊信息的对象图。

在我们的 Remoting 实现中，我们确实向通道堆栈添加了一个客户端和一个服务器通道，以检查消息是否包含数据集，并使用 xml 序列化器能够通过线路发送 ExtendedProperties（您可能知道数据集序列化器执行 ToString () 中找到的元素进入 ExtendedProperties)。

我们这样做是为了对业务规则和 UI 开发人员透明。

在 WCF 通道将 DataSet 序列化为 xml/soap 之前，我们应该在 WCF 中覆盖或实现什么以便能够管理它？是否可以？

**注意：**我已经知道我们必须避免在 wcf 中使用数据集，但是我们有 200 多个使用数据集的表单，并且现在无法全部更改它们。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-15T08:58:02.377

我想知道你是否不能通过在每一端添加一个行为属性来交换序列化程序......给定一个`XmlReader`/ `XmlWriter`，方法是：

```
dataset.WriteXml(xmlWriter, XmlWriteMode.WriteSchema); 
```

和

```
dataset.ReadXml(xmlReader, XmlReadMode.ReadSchema); 
```

似乎可以工作（即尊重扩展属性），因此您应该能够编写一个检测`DataSet`并交换到自定义序列化程序的行为 - 就像这样（[属性](http://code.google.com/p/protobuf-net/source/browse/trunk/protobuf-net/ServiceModel/ProtoBehaviorAttribute.cs)|[行为](http://code.google.com/p/protobuf-net/source/browse/trunk/protobuf-net/ServiceModel/ProtoOperationBehavior.cs)|[序列化](http://code.google.com/p/protobuf-net/source/browse/trunk/protobuf-net/ServiceModel/XmlProtoSerializer.cs)程序） - 但可能更简单。如果这还不足以开始，我可以稍后再看...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T17:13:23.023

您可能会考虑切换到[NetDataContractSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.netdatacontractserializer.aspx)。它能够序列化所有可序列化的 .NET 类型，甚至包括支持 ISerializable 的类型，并且它完全处理此类图中的循环。

但这只有在您打算通过 .NET 客户端使用 WCF 服务时才有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T08:37:02.173

首先感谢您的回答。我终于找到了如何结合 Marc 的答案和[Nicholas Allen 的 Indigo Blog](http://blogs.msdn.com/drnick/archive/2007/05/15/replacing-the-serializer-part-1.aspx)的条目来更改序列化程序。

谢谢你。

# django - 模型表单集问题

> ID：863793
> 
> 赞同：0
> 
> 时间：2009-05-14T14:53:19.173
> 
> 标签：django, forms, formset

我有一个需要多次显示表格的模型。我在模型集下使用过它。我似乎对这个模型的 id 有疑问，它也是模型的主键。
我用我希望编辑的数据预填充表单集。
但是，每当我单击提交时，它都会刷新页面并显示错误消息“（隐藏字段 id）此无已存在。”
此错误专门针对隐藏的“id”字段

```
<input type="hidden" id="id_form-0-id" value="2972" name="form-0-id"/> 
```

这是模板中的片段。（我从萤火虫那里得到的）问题可能是什么，因为表格无效我无法保存数据。

```
ProfilesFormSet = modelformset_factory(Profile,exclude = ( <items spearated by commas>), extra=0) 
profile_form_set = ProfilesFormSet(queryset = Profile.objects.filter(userprofile=userprofile).order_by('-modified_on')) 
```

这是代码片段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T21:24:57.220

如果您使用 PostgreSQL 和 1.1beta 之前的任何版本的 Django，并且您的模型没有定义默认排序，我想您可能会看到与从数据库返回的对象的顺序不一致有关的错误（请参阅 Django Trac票[9076](http://code.djangoproject.com/ticket/9076)、[9758](http://code.djangoproject.com/ticket/9758)、[10163](http://code.djangoproject.com/ticket/10163)等）。

尝试在模型上设置默认排序：

```
class Meta:
    ordering = ('some_field',) 
```

看看能不能解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T20:50:29.330

我认为此错误是由以下原因之一引起的：

*   您在表单集中使用的 Django 表单对象不包括模型的主键 (id)。但是，由于您使用的是 modelformset_factory，因此情况并非如此（您也不会收到该错误消息）。

*   模板中的 HTML 表单不包含主键，即使是隐藏字段。确保您`{{ form.id }}`的模板中有或类似的东西，在`{{ for form in formset }}`循环内。

目前我想不出更多的原因，但我确信它们都将与从浏览器客户端返回的表单相关，但不知何故缺少 id 字段。

# mysql - 使用 MySQL 的 Spring JDBCTemplate 表锁定

> ID：863794
> 
> 赞同：6
> 
> 时间：2009-05-14T14:53:22.497
> 
> 标签：mysql, spring, jdbc, locking, jdbctemplate

我只是将我们的一个应用程序从纯 JDBC 迁移到 Spring 的 JDBCTemplate。我想知道如何为表创建写锁。我只是执行“LOCK TABLE foo”查询还是在 JDBCTemplate 中有通用的方法来执行此操作？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T15:35:25.530

JdbcTemplate 使用数据源，因此不能保证您将使用相同的连接来执行 LOCK TABLE 语句以及在下一次调用 JdbcTemplate 时将要执行的任何操作。因此，在事务中执行此操作很重要。设置 PlatformTransactionManager，可以是 JdbcTemplate 的 DataSource 上的 DataSourceTransactionManager，如果 JdbcTemplate 使用容器提供的 JNDI DataSource，则设置 JtaTransactionManager。您可以将您的方法注释为 @Transactional 或使用 PlatformTransactionManager 以编程方式创建事务。

# java - JSP中的HTML输出问题

> ID：863798
> 
> 赞同：0
> 
> 时间：2009-05-14T14:53:54.023
> 
> 标签：java, html, jsp, jsp-tags

我有生成一些 HTML 的代码，但是当我尝试在 jsp 中输出这些内容时，所有的 '<' 都被替换为 ' `&lt;`'，所有的 '>' 都被替换为 ' `&gt;`'。这是呈现结果的部分：

```
<c:out value="${data}"/> 
```

有人可以解释导致字符替换的原因，以及如何避免它？

PS：我试过`<c:out/>`标签的 escapeXml='false' 属性，什么都没有显示。

谢谢，娜塔莎

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T16:43:49.157

out 标记的行为应如此 - 如果您确实希望输出文字值，您可以直接在文本中插入 EL expressen ${data}。也就是说，而不是

```
Some content <c:out value="${data}"/> some more content 
```

你会用

```
Some content ${data} some more content 
```

在您的 JSP 中。

在你对 c:out 生气之前，请考虑输出通常是用户放在那里的东西——可能带有一些不需要的代码。想象一下在 StackOverflow 上使用 ${data} 而不是（C# 版本的）c:out :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:24:47.927

您希望生成的 HTML 做什么，您希望它成为浏览器使用的标记，还是希望它显示在最终页面上，例如作为用户可见的示例代码？如果没有 escapeXml='false' ，它将作为 HTML 输出到浏览器并与所有其他标记一起解释。使用 escapeXml='true' 时，它将变成对最终用户可见的转义标记。所以这一切都取决于你想要做什么。

如果您想让 < 和 > 字符对最终用户可见，那么它们必须显示为 < 和> 在标记中。

缺口

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T16:35:59.503

c:out 标记上有一个 escapeXml 属性，默认设置为 true，将其设置为 false 并且不会发生转义，即您的 HTML 将按原样在浏览器中输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T16:59:25.080

`<c:out value="${data}"/>`转义 HTML 字符而不转义`${data}`。看看[这个相关的问题](https://stackoverflow.com/questions/291031)。

# javascript - 替换 Javascript 中的变音符号

> ID：863800
> 
> 赞同：24
> 
> 时间：2009-05-14T14:53:59.670
> 
> 标签：javascript, diacritics

如何在javascript中用它们的“正常”形式（a，s，t）替换变音符号（ă，ş，ţ等）？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2017-09-13T08:34:30.673

在现代浏览器和 node.js 中，您可以使用[unicode 规范化](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize)来分解这些字符，然后使用过滤正则表达式。

`str.normalize('NFKD').replace(/[^\w]/g, '')`

如果您想允许空格、破折号等字符，您应该扩展正则表达式以允许它们。

`str.normalize('NFKD').replace(/[^\w\s.-_\/]/g, '')`

```
var str = 'áàâäãéèëêíìïîóòöôõúùüûñçăşţ';
var asciiStr = str.normalize('NFKD').replace(/[^\w]/g, '');
console.info(str, asciiStr);
```

**注意：**此方法不适用于没有 unicode 组合变量的字符。即`ø`和`ł`

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-05-11T07:20:59.300

一个更完整的版本，支持区分大小写、连字等等。原文来源： http: [//lehelk.com/2011/05/06/script-to-remove-diacritics/](http://lehelk.com/2011/05/06/script-to-remove-diacritics/)

```
var defaultDiacriticsRemovalMap = [
    {'base':'A', 'letters':/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},
    {'base':'AA','letters':/[\uA732]/g},
    {'base':'AE','letters':/[\u00C6\u01FC\u01E2]/g},
    {'base':'AO','letters':/[\uA734]/g},
    {'base':'AU','letters':/[\uA736]/g},
    {'base':'AV','letters':/[\uA738\uA73A]/g},
    {'base':'AY','letters':/[\uA73C]/g},
    {'base':'B', 'letters':/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},
    {'base':'C', 'letters':/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},
    {'base':'D', 'letters':/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},
    {'base':'DZ','letters':/[\u01F1\u01C4]/g},
    {'base':'Dz','letters':/[\u01F2\u01C5]/g},
    {'base':'E', 'letters':/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},
    {'base':'F', 'letters':/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},
    {'base':'G', 'letters':/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},
    {'base':'H', 'letters':/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},
    {'base':'I', 'letters':/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},
    {'base':'J', 'letters':/[\u004A\u24BF\uFF2A\u0134\u0248]/g},
    {'base':'K', 'letters':/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},
    {'base':'L', 'letters':/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},
    {'base':'LJ','letters':/[\u01C7]/g},
    {'base':'Lj','letters':/[\u01C8]/g},
    {'base':'M', 'letters':/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},
    {'base':'N', 'letters':/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},
    {'base':'NJ','letters':/[\u01CA]/g},
    {'base':'Nj','letters':/[\u01CB]/g},
    {'base':'O', 'letters':/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},
    {'base':'OI','letters':/[\u01A2]/g},
    {'base':'OO','letters':/[\uA74E]/g},
    {'base':'OU','letters':/[\u0222]/g},
    {'base':'P', 'letters':/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},
    {'base':'Q', 'letters':/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},
    {'base':'R', 'letters':/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},
    {'base':'S', 'letters':/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},
    {'base':'T', 'letters':/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},
    {'base':'TZ','letters':/[\uA728]/g},
    {'base':'U', 'letters':/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},
    {'base':'V', 'letters':/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},
    {'base':'VY','letters':/[\uA760]/g},
    {'base':'W', 'letters':/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},
    {'base':'X', 'letters':/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},
    {'base':'Y', 'letters':/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},
    {'base':'Z', 'letters':/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},
    {'base':'a', 'letters':/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},
    {'base':'aa','letters':/[\uA733]/g},
    {'base':'ae','letters':/[\u00E6\u01FD\u01E3]/g},
    {'base':'ao','letters':/[\uA735]/g},
    {'base':'au','letters':/[\uA737]/g},
    {'base':'av','letters':/[\uA739\uA73B]/g},
    {'base':'ay','letters':/[\uA73D]/g},
    {'base':'b', 'letters':/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},
    {'base':'c', 'letters':/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},
    {'base':'d', 'letters':/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},
    {'base':'dz','letters':/[\u01F3\u01C6]/g},
    {'base':'e', 'letters':/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},
    {'base':'f', 'letters':/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},
    {'base':'g', 'letters':/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},
    {'base':'h', 'letters':/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},
    {'base':'hv','letters':/[\u0195]/g},
    {'base':'i', 'letters':/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},
    {'base':'j', 'letters':/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},
    {'base':'k', 'letters':/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},
    {'base':'l', 'letters':/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},
    {'base':'lj','letters':/[\u01C9]/g},
    {'base':'m', 'letters':/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},
    {'base':'n', 'letters':/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},
    {'base':'nj','letters':/[\u01CC]/g},
    {'base':'o', 'letters':/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},
    {'base':'oi','letters':/[\u01A3]/g},
    {'base':'ou','letters':/[\u0223]/g},
    {'base':'oo','letters':/[\uA74F]/g},
    {'base':'p','letters':/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},
    {'base':'q','letters':/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},
    {'base':'r','letters':/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},
    {'base':'s','letters':/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},
    {'base':'t','letters':/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},
    {'base':'tz','letters':/[\uA729]/g},
    {'base':'u','letters':/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},
    {'base':'v','letters':/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},
    {'base':'vy','letters':/[\uA761]/g},
    {'base':'w','letters':/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},
    {'base':'x','letters':/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},
    {'base':'y','letters':/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},
    {'base':'z','letters':/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}
];
var changes;
function removeDiacritics (str) {
    if(!changes) {
        changes = defaultDiacriticsRemovalMap;
    }
    for(var i=0; i<changes.length; i++) {
        str = str.replace(changes[i].letters, changes[i].base);
    }
    return str;
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-14T15:04:37.010

如果您想完全在客户端执行此操作，我认为您唯一的选择是使用某种查找表。这是一个起点，由一个叫 Olavi Ivask 的小伙子在他的[博客](http://olaviivask.wordpress.com/2008/03/31/how-to-remove-diacritics-with-javascript/)上写的……

```
function replaceDiacritics(s)
{
    var s;

    var diacritics =[
        /[\300-\306]/g, /[\340-\346]/g,  // A, a
        /[\310-\313]/g, /[\350-\353]/g,  // E, e
        /[\314-\317]/g, /[\354-\357]/g,  // I, i
        /[\322-\330]/g, /[\362-\370]/g,  // O, o
        /[\331-\334]/g, /[\371-\374]/g,  // U, u
        /[\321]/g, /[\361]/g, // N, n
        /[\307]/g, /[\347]/g, // C, c
    ];

    var chars = ['A','a','E','e','I','i','O','o','U','u','N','n','C','c'];

    for (var i = 0; i < diacritics.length; i++)
    {
        s = s.replace(diacritics[i],chars[i]);
    }

    document.write(s);
} 
```

您可以看到这只是已知变音符号字符的正则表达式数组，将它们映射回“普通”字符。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-11-19T09:28:10.523

对保罗剧本的简单修改。扩展字符串对象

```
String.prototype.removeDiacritics = function() {
    var diacritics = [
        [/[\300-\306]/g, 'A'],
        [/[\340-\346]/g, 'a'],
        [/[\310-\313]/g, 'E'],
        [/[\350-\353]/g, 'e'],
        [/[\314-\317]/g, 'I'],
        [/[\354-\357]/g, 'i'],
        [/[\322-\330]/g, 'O'],
        [/[\362-\370]/g, 'o'],
        [/[\331-\334]/g, 'U'],
        [/[\371-\374]/g, 'u'],
        [/[\321]/g, 'N'],
        [/[\361]/g, 'n'],
        [/[\307]/g, 'C'],
        [/[\347]/g, 'c'],
    ];
    var s = this;
    for (var i = 0; i < diacritics.length; i++) {
        s = s.replace(diacritics[i][0], diacritics[i][1]);
    }
    return s;
} 
```

现在你可以这样做：

```
var wrongString = "hëllô";
alert(wrongString.removeDiacritics()); // alerts "hello" 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-01-07T19:50:09.293

我已将 Apache Lucene ASCII 折叠过滤器移植到 JavaScript。您可以将许多 Unicode 字符（包括变音符号）替换为 ASCII 基本形式。

[您可以在https://github.com/mplatt/fold-to-ascii-js](https://github.com/mplatt/fold-to-ascii-js)上找到该端口

集成库后，您可以像这样折叠字符串：

```
//foldToASCII("ăşţ"); -> depreciated 
```

## 编辑

我所做的就是按照他的链接中的安装说明进行操作，然后导入库，然后我就可以使用它了。

```
import ASCIIFolder from fold-to-ascii

//Then I can call the following:
ASCIIFolder.foldReplacing("Lörem  ëripuît") === "Lorem  eripuit";

//Which results in `ast`. 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-09-24T08:18:09.830

考虑以下语法，其中 value 中的每个符号都将替换为其键符号（区分大小写）

```
var diacritics = {
  a: 'ÀÁÂÃÄÅàáâãäåĀāąĄ',
  c: 'ÇçćĆčČ',
  d: 'đĐďĎ',
  e: 'ÈÉÊËèéêëěĚĒēęĘ',
  i: 'ÌÍÎÏìíîïĪī',
  l: 'łŁ',
  n: 'ÑñňŇńŃ',
  o: 'ÒÓÔÕÕÖØòóôõöøŌō',
  r: 'řŘ',
  s: 'ŠšśŚ',
  t: 'ťŤ',
  u: 'ÙÚÛÜùúûüůŮŪū',
  y: 'ŸÿýÝ',
  z: 'ŽžżŻźŹ'
}

function replaceDiacritics(text) {
  for(var toLetter in diacritics) if(diacritics.hasOwnProperty(toLetter)) {
    for(var i = 0, ii = diacritics[toLetter].length, fromLetter, toCaseLetter; i < ii; i++) {
      fromLetter = diacritics[toLetter][i];
      if(text.indexOf(fromLetter) < 0) continue;
      toCaseLetter = fromLetter == fromLetter.toUpperCase() ? toLetter.toUpperCase() : toLetter;
      text = text.replace(new RegExp(fromLetter, 'g'), toCaseLetter);
    }
  }
  return text;
}

replaceDiacritics('ŁÁŘŠÓÑ'); // LARSON
replaceDiacritics('Łąřśøń'); // Larson 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-14T15:06:27.910

您需要一个转换映射，如下所示：

```
function removeAccents(str) {
    var convMap = {
        "ă" : "a",
        "ş" : "s",
        "ţ" : "t"
    }
    for (var i in convMap) {
        str = str.replace(new RegExp(i, "g"), convMap[i]);
    }
    return str;
} 
```

或者，如果您可以访问`iconv`您的盒子，您也许可以使用一些 ajax 调用来删除带有 iconv 的 //TRANSLIT 参数的重音。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-31T15:50:40.523

此方法是对第一个响应的重构。

```
function replaceDiacritics(str){

  var diacritics = [
    {char: 'A', base: /[\300-\306]/g},
    {char: 'a', base: /[\340-\346]/g},
    {char: 'E', base: /[\310-\313]/g},
    {char: 'e', base: /[\350-\353]/g},
    {char: 'I', base: /[\314-\317]/g},
    {char: 'i', base: /[\354-\357]/g},
    {char: 'O', base: /[\322-\330]/g},
    {char: 'o', base: /[\362-\370]/g},
    {char: 'U', base: /[\331-\334]/g},
    {char: 'u', base: /[\371-\374]/g},
    {char: 'N', base: /[\321]/g},
    {char: 'n', base: /[\361]/g},
    {char: 'C', base: /[\307]/g},
    {char: 'c', base: /[\347]/g}
  ]

  diacritics.forEach(function(letter){
    str = str.replace(letter.base, letter.char);
  });

  return str;
}; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-25T06:36:03.500

试试这个。

```
function replaceDiacritics(text) {     
  const diacr =     "ÁÄČÇĎÉĚËÍŇÓÖŘŠŤÚŮÜÝŽáäčçďéěëíňóöřšťúůüýž";
  const diacrSubs = "AACCDEEEINOORSTUUUYZaaccdeeeinoorstuuuyz";

  if (text.length < diacr.length) {
    for (let i = 0; i < text.length; i++) {
      let indexOfSpecChar = diacr.indexOf(text[i]);

      if (indexOfSpecChar > -1) {
        text = text.replace(new RegExp(diacr[indexOfSpecChar], 'g'), diacrSubs[indexOfSpecChar]);
      }

    }
  } else {
    for (let j = 0; j < diacr.length; j++) {
      text = text.replace(new RegExp(diacr[j], 'g'), diacrSubs[j]);
    }
  }

  return text;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-03T21:44:44.043

这是公认的低级解决方案的 ES2020 版本。如果您可以召回需要替换的字母，请创建一个映射并使用`String.replace()`来一一映射字母：

```
const mapping = {
  'ă': 'a',
  'ş': 's',
  'ţ': 't'
}

const replaceDiacritics = s => s.split('').map(letter => mapping[letter] ?? letter).join('') 
```

# java-me - j2me 网络连接

> ID：863807
> 
> 赞同：1
> 
> 时间：2009-05-14T14:55:47.110
> 
> 标签：java-me, mobile

我在很多地方都读过 j2me 应用程序中的网络连接应该在单独的线程中完成。这是必需品还是好事？

我问这个是因为我找不到任何写这必须在单独的线程中完成的地方。此外，当我编写一个简单的应用程序来通过网络获取图像并将其显示在屏幕上（不使用线程）时，它不起作用。当我将其更改为使用单独的线程时，它起作用了。我不确定它是否有效只是因为我将它更改为一个单独的线程，因为我还对代码进行了许多其他更改。

有人可以确认吗？

**编辑：** 如果不需要在单独的线程中运行，有人可以告诉我为什么下面的简单代码不起作用吗？

到了一个阶段，模拟器会询问“是否可以连接到网络”。无论我按“是”还是“否”，屏幕都不会改变。

```
 public class Moo extends MIDlet {

    protected void destroyApp(boolean arg0) throws MIDletStateChangeException {
        // TODO Auto-generated method stub

    }

    protected void pauseApp() {
    }

    protected void startApp() throws MIDletStateChangeException {
        Display display = Display.getDisplay(this);
        MyCanvas myCanvas = new MyCanvas();
        display.setCurrent(myCanvas);
        myCanvas.repaint();

    }

    class MyCanvas extends Canvas {

        protected void paint(Graphics graphics) {
            try {
                Image bgImage = Image.createImage(getWidth(), getHeight());

                HttpConnection httpConnection = (HttpConnection) Connector
                        .open("https://stackoverflow.com/content/img/so/logo.png");
                Image image = Image.createImage(httpConnection
                        .openInputStream());
                bgImage.getGraphics().drawImage(image, 0, 0, 0);
                httpConnection.close();

                graphics.drawImage(bgImage, 0, 0, 0);
            } catch (IOException e) {
                e.printStackTrace();
            }
        }

    }

} 

```

**编辑**：我在[这里](http://developers.sun.com/mobility/midp/ttips/threading3/index.html)得到了代码的答案。

**编辑：我**[在这里](https://stackoverflow.com/questions/867660/j2me-networking-threads-and-deadlocks)提出了一个单独的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T15:14:41.557

问题是您正试图在负责运行 UI 的线程中进行工作。如果您不使用单独的线程，则该 UI 线程在您工作时正在等待，并且无法处理您的任何其他 UI 更新！所以是的，你真的不应该在事件处理程序中做任何重要的工作，因为你需要在那里快速返回控制权。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T16:52:44.317

我同意 Sean 的观点，但不需要将您的网络连接放在单独的线程中，这只是最佳实践。我认为将连接移动到单独的线程后连接正常工作可能是巧合。无论哪种方式，如果您想在连接发生时向用户提供任何视觉反馈（考虑到用户在移动网络上可以体验到的延迟差异，您可能会这样做），您应该在单独的线程中进行网络处理.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T12:51:07.033

在新线程中进行网络连接不是强制性的，但实际上您会发现这样做几乎总是一个好主意，因为网络活动可能会阻塞并使您的应用程序处于无响应状态。

This is an [old article](http://developers.sun.com/mobility/midp/articles/threading/) but it speaks about some of the issues involved in networking and user experience.

# java - SOAP Java 1.4.2

> ID：863808
> 
> 赞同：0
> 
> 时间：2009-05-14T14:55:59.090
> 
> 标签：java, soap, soap-client

在 Java 版本 1.4.2 中可以使用哪些库来编写 SOAP 客户端？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T15:00:34.757

[Apache Axis](http://ws.apache.org/axis/)在 Java 1.4 上运行，并且对 WS-Security 等规范有相当好的支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T15:36:26.387

Metro 和 CXF 都不适用于 Java 1.4.x，它们都需要 Java5。我认为唯一的选择是 Axis/Axis2 和 XFire，但即使 Axis2 1.5 也只会是 Java 5，XFire 几乎已被 CXF 取代。Java 1.4 几乎是 WebServices 堆栈的死胡同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T15:02:08.030

两个主要选项是 Apache [Axis](http://ws.apache.org/axis/) / [Axis2](http://ws.apache.org/axis2/)和 Sun [Metro JAX-WS 堆栈](https://jax-ws.dev.java.net/)（包含在 J2EE 5 和 J2SE 6 中）。

但是，Metro 仅是 Java 5 和更新版本，因为它使用注解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T15:26:34.727

我是 Apache CXF 的粉丝。以下是有关开发 Web 服务客户端的不同方法的教程：

[http://cwiki.apache.org/CXF20DOC/how-do-i-develop-a-client.html](http://cwiki.apache.org/CXF20DOC/how-do-i-develop-a-client.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T14:57:49.723

大多数常见的都在那时。不过，您可能需要转到存档版本，因为那是几个旧的主要修订版本。尤其是 Java 5 增加了足够的优点，以至于它的特性往往被采用。

# visual-studio-2008 - VS2008 devenv没有关闭，阻止文件被构建？

> ID：863814
> 
> 赞同：0
> 
> 时间：2009-05-14T14:57:02.753
> 
> 标签：visual-studio-2008, msbuild

嘿，伙计们，你们有没有遇到过这种行为，如果有，你们是如何解决的？

基本上，发生的事情是这样的：我将运行一个 VS2008 实例，在新实例中弹出另一个 VS 项目，然后关闭新实例。之后，每隔一段时间VS就会抱怨“文件在另一个窗口中打开，你想关闭它吗？”。单击是不会执行任何操作；我无法在编辑器中打开文件。

更糟糕的是，任何会显示该行为的文件（可能是我不知道的文件）似乎都没有构建。直接组装不包括显示问题的类。

我注意到，当我关闭 VS 时，仍然有 devenv.exe 实例在运行；当我在 Process Explorer 中杀死它们时，问题似乎消失了，所以在我看来，它们使文件句柄保持打开状态。

我希望能够比现在更信任我的环境......

有什么建议么？

PS - 我安装了 VimEmu，这是唯一的插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T05:31:37.283

您可以尝试解决此问题的一件事（因此您不必关闭）是在受影响的文件上运行解锁程序。

[http://www.emptyloop.com/unlocker/](http://www.emptyloop.com/unlocker/)

它是一个免费工具，可让您查看已锁定文件的内容，然后可以强制解锁。

不能解决您的问题，但它可能是一种解决方法。

作为旁注，当我在 Visual Studio 的第二个实例中更改文件时，我收到以下消息：

**此文件已在源代码编辑器之外进行了修改。**

**你想重新加载它吗？**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:13:49.360

显而易见的问题：您是否尝试过卸载/禁用 3rd 方插件以查看是否有任何改变？

# .net - 如何使我的 Linq to Sql 类 IEnumerable

> ID：863815
> 
> 赞同：0
> 
> 时间：2009-05-14T14:57:11.350
> 
> 标签：.net, ienumerable

如何在 C# 3.0 中使我的 Linq to Sql 类 IEnumerable 或对象 IEnumerable

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T14:59:20.063

要在 C# 中使对象可枚举，您将实现 IEnumerable 接口

```
public class Widget{}
public class WidgetCollection : IEnumerable<Widget>
{
    public IEnumerator<Widget> GetEnumerator()
    {
        throw new NotImplementedException();
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }

} 
```

至于你问题的第二部分，我不确定你在问什么或试图做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T15:01:53.617

我不确定“使我的 Linq to SQL 类 IEnumerable”是什么意思。但是，在您的控制器中（假设为 ASP.NET MVC）...

```
WidgetDataContext dataContext = new WidgetDataContext();

var data = dataContext.Widgets.OrderBy(x => x.name);

return View(data); 
```

在这种情况下，视图将能够简单地将`data`对象（`Model`在视图中调用）转换为 an`IEnumerable<Widget>`并且可以通过它进行遍历。

这是（上面有乔希的回答）这个问题吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T15:03:10.447

如果您正在谈论 LinqToSql 生成的类，那么您将在部分类中进行

```
public partial class YourLinqToSqlClass : IEnumerable
{
    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        //Implement...
    }

} 
```

# java - 更聪明的二传手？好主意还是坏主意？

> ID：863822
> 
> 赞同：1
> 
> 时间：2009-05-14T14:57:54.140
> 
> 标签：java, gwt

在 GWT 解决方案中。（所以这是然后编译为 javascript 的 java 代码）。当然也有一些课程。

让 setter 检查 String 字段上的 Null 是否是个好主意？

像这样的东西

```
public void setSomeField(String someField){
  if (null != someField)
    this.someField = someField;
  else
    this.someField = String.Empty;
} 
```

这是个好主意还是坏主意？一方面它会使编码更容易，因为我不必检查 null ，另一方面它会让我可能忘记我必须为其他字符串执行此操作。

想法？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T15:00:48.033

我说如果你的应用程序需要这样的逻辑，那么 setter 就是放置它的地方。对私有 var 进行 get/set 包装的主要原因是能够在访问周围放置逻辑。

要回答默认或不默认的问题：在我的应用程序中，出于显示原因，有一组属性回退到 string.empty 是有意义的。尽管人们可能会争辩说视图应该涵盖这些可能性并检查空值并且什么都不显示，但是在我的页面上检查每个属性是很多膨胀的。

这就是我开始实现 SafeXX 属性的原因。所以说我有可能有一个空值的'myObj.Name'，还有一个属性'myObj.SafeName'在getter中捕获空值并返回一个string.empty。小小的命名约定表明它不是常规的 getter。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T15:39:47.160

这是需要考虑的事情。你希望这个单元测试通过还是失败？：

```
yourClass.setSomeField(null);
assertNull(yourClass.getSomeField()); 
```

如果您将空值更改为空字符串并在 getSomeField 中返回，那么客户端现在必须在测试时检查两个条件……一个字符串和一个空字符串。没什么大不了的，但是如果你在类中有 20 个 String 属性会发生什么......你可能最好尝试在所有 setter 之间保持一致，如果你不是那么原因可能应该更多明显的不仅仅是文档这么说。

围绕 getter 和 setter 有一些约定；一定的期望。如果我在对象上调用 setter，那么我通常希望 getter 返回我设置的内容。我不希望它返回一些我传入的内容的表示，这样更便于类在内部使用。我不关心班级的内部情况，也不想这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T15:09:54.640

如果出于正当理由`null`确实应该更改`""`为（例如，它可能意味着“我不在乎”并且默认值可能是`""`），那就去吧（但记录它）。

否则，就像你刚刚抓到一个`NullPointerException`并试图以这种方式修复它一样，不要这样做。如果调用者使用明显无效的值，则应尽快引发异常，以便调用者注意到问题并在它冒泡到可能完全不相关的组件中出现灾难性、无法解释的错误之前修复它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T15:03:28.323

通常，检查 null 值不是一个好主意，因为调用者（调用 setter 的人）可能真的想将值设置为 null。

假设您使用以下命令查询“someField”：

```
select * from ... where someField is null 
```

如果将其设置为空字符串，则上面的查询将失败。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T11:23:28.313

如果您不想将某个字段设置为 null，请不要将其设置为 null。

如果您无法控制执行设置的代码，这可能是一个好主意，但如果您这样做，最好从源头解决问题，而不是像这样解决问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-17T12:12:49.897

这很难回答。乍一看，它似乎使用法更好，因为您不必一直检查 null 。但是您失去了 null 的质量，这意味着没有分配任何内容。如果你做 String.Empty 如果有人给你一个 String.Empty 作为参数，你已经有歧义了。也许没关系。

我个人（如果有的话）不会在二传手中这样做。在您的类中， null 应该有自己的值。如果你是为了方便起见

```
return (this.someField != null) ? this.someField: String.Empty; 
```

会做。您可以在内部保留 null 来处理，但外部有一个更方便的方法。

一般来说，就个人而言，我不会这样做。起初它看起来不错，但后来使很多事情变得更加困难。

# .net - 在不创建应用程序的情况下确定 PC 的本地文化

> ID：863826
> 
> 赞同：1
> 
> 时间：2009-05-14T14:58:30.970
> 
> 标签：.net, localization, culture, cultureinfo

有没有办法在不运行应用程序的情况下确定 PC 的本地文化（例如 en-US）？我尝试在控制面板中查找 | 区域设置（运行 WinXP），但我不知道那里的选择如何映射到 PC 的文化。

我正在寻找不需要创建 .exe 的解决方案，例如从命令提示符（不是 PowerShell）或 VbScript 或 JS 文件运行命令（只要我们获得真正的文化而不是 IE设置。）

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T17:00:22.630

要从资源管理器界面查看信息，请按照其他答案中的说明进行操作。

有关内部详细信息，请继续阅读：

区域设置为每个用户保存`HKCU\Control Panel\International\`在值下`LocaleName`

要快速查看您的语言环境，请从命令行运行：

```
REG QUERY "HKCU\Control Panel\International" /v "LocaleName" 
```

显然你可以以任何你喜欢的方式查询这些信息（cmd、powershell、vbs、c#等...）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T15:05:58.987

查看附件->系统下的系统信息工具，它会告诉您那里的区域设置。

# javascript - 在我的设计 html / css / javascript 中需要帮助

> ID：863830
> 
> 赞同：0
> 
> 时间：2009-05-14T14:59:00.923
> 
> 标签：javascript, html, css

我正在尝试设计一个文件托管网站模板，问题是我重新设计了 div 元素的单选按钮，以使用自定义图像而不是使用 javascript 的默认圆圈，

[这是默认页面加载时的图像 1](http://i44.tinypic.com/347blev.png)

```
<script type="text/javascript">
<!--
//script to change background-color of the selected
//button and put the appropriate value in an input object
function btnClick(btnNum){
for (i=1;i<=4;i++){
tempBtnVal=document.getElementById('btnVal')
tempBtn=document.getElementById('btn'+i)
tempBtn.style.backgroundPosition=(i==btnNum?'0 -163px':'0 -30px')
tempBtn.style.color=(i==btnNum?'#333':'#6a7072')
}
tempBtnVal.value=btnNum
}
//-->
</script> 
```

我的 html

```
<div id="btn1" name="btn1" class="buttonDiv" value='1' onclick="btnClick('1')" style="background: url(images/inSprite.png) no-repeat scroll 0 -163px; color:#333;"><div id="btnTxt">local</div></div>

<div id="btn2" name="btn2" class="buttonDiv" value='2' onclick="btnClick('2')"><div class="btnTxt">remote</div></div> 
```

如果我单击任何其他选项卡，它工作正常并且该选项卡被选中

[图 2 单击 URL 上传时](http://i44.tinypic.com/tasxoi.png)

但是脚本存储了最后选择的选项卡的cookie，所以下次有人自动访问该选项卡时会显示该选项卡，所以我在div中手动硬编码了css，它破坏了设计，如下图所示，我选择了“URL上传”，然后重新加载页面

[图 3 退出浏览器并重新访问网站时](http://i41.tinypic.com/1z5uk95.png)

在选择器中，它显示表单上传，但 URL 上传选项卡已打开。

请帮我解决问题，以便如果打开 URL 上传，它会显示在上面的选项卡中选择的 URL 上传。

由于限制，我不能使用任何框架，我只能使用 javascript 但不能使用框架。请帮我解决，因为我对 javascript 的了解很少。

非常感谢您。

问候，

什尚特·托迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T15:05:37.210

恕我直言，这只是一个非常糟糕的主意-对于初学者来说，对于没有 JS 的任何人来说，您的页面都被破坏了，对于另一个人来说，现在您必须重新实现所有标准化、浏览器安全并以单选按钮的形式*预先编写*的内容，而您重新打破了一个很好理解的用户约定。

我*强烈*建议您重新考虑单选按钮。你不应该提倡形式胜于功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:06:02.123

您需要在浏览器关闭后保留单选按钮的状态。Cookie 是我能想到的唯一方法，您可以使用 javascript 操作 cookie。（谷歌搜索“javascript cookie”会产生很多很好的教程。）

# java - Eclipse 中的 Java 属性 UTF-8 编码

> ID：863838
> 
> 赞同：50
> 
> 时间：2009-05-14T14:59:47.207
> 
> 标签：java, eclipse, encoding, utf-8

我最近不得不将我正在开发的 webapp 的编码`ISO-xx`从`utf8`. 一切都很顺利，除了属性文件。我添加`-Dfile.encoding=UTF-8`并`eclipse.ini`正常文件工作正常。然而，属性显示出一些奇怪的行为。

如果我从 Notepad++ 复制`utf8`编码属性并将它们粘贴到 Eclipse 中，它们会显示并正常工作。当我重新打开属性文件时，我看到一些 Unicode 字符而不是正确的字符，例如：

```
Zur\u00EF\u00BF\u00BDck instead of Zurück 
```

但应用程序仍然可以正常工作。如果我开始编辑属性，添加一些特殊字符并保存，它们会正确显示，但是它们不起作用，并且所有以前工作的特殊字符都不再起作用。

当我将本地版本与 CVS 进行比较时，我可以在远程文件上正确地看到特殊字符，更新后我又开始了：应用程序工作正常，但 Eclipse 显示 Unicode 字符。

我尝试通过右键单击它并选择“其他：UTF8”来更改文件编码，但它没有帮助。它还说：“由内容决定：ISO-8859-1”</p>

我正在使用基于 Eclipse 3.3 的 Java 6 和 Jboss Developer

我可以通过在 Notepad++ 中编辑属性并将它们粘贴到 Eclipse 中来忍受它，但如果有人能帮助我在 Eclipse 中修复这个问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-05-14T15:02:15.300

“pre-Java-9”的答案如下。从 Java 9 开始，属性文件默认以 UTF-8 保存和加载，但如果检测到无效的 UTF-8 字节序列，则会回退到 ISO-8859-1。有关详细信息，请参阅[Java 9 发行说明](https://docs.oracle.com/javase/9/intl/internationalization-enhancements-jdk-9.htm#JSINT-GUID-974CF488-23E8-4963-A322-82006A7A14C7)。

* * *

根据定义，属性文件是 ISO-8859-1 - 请参阅[Properties](http://java.sun.com/javase/6/docs/api/java/util/Properties.html)类的文档。

Spring 有一个替代品，它可以使用指定的编码加载，使用[`PropertiesFactoryBean`](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/config/PropertiesFactoryBean.html).

编辑：正如 Laurence 在评论中指出的那样，Java 1.6 引入了重载 for `load`and`store`采用`Reader`/ `Writer`。这意味着您可以使用您想要的任何编码为文件创建一个阅读器，并将其传递给`load`. 不幸的是，`FileReader` *仍然*不允许您在构造函数（aargh）中指定编码，因此您将被链接`FileInputStream`和`InputStreamReader`在一起。但是，它会起作用。

例如，要使用 UTF-8 读取文件：

```
Properties properties = new Properties();
InputStream inputStream = new FileInputStream("path/to/file");
try {
    Reader reader = new InputStreamReader(inputStream, "UTF-8");
    try {
        properties.load(reader);
    } finally {
        reader.close();
    }
} finally {
   inputStream.close();
} 
```

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-12-07T08:14:00.230

不要浪费你的时间，你可以在**Eclipse中使用**[**Resource Bundle 插件**](http://essiembre.github.io/eclipse-rbe/)

 **![基本屏幕截图](https://camo.githubusercontent.com/35ff0c003e9ec901203eea51e0251d052db0a9d2/687474703a2f2f65737369656d6272652e6769746875622e696f2f65636c697073652d7262652f696d672f73637265656e73686f74732f6d61696e2d73637265656e2e706e67)

[旧 Sourceforge 页面](http://sourceforge.net/projects/eclipse-rbe/)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-14T15:03:52.550

这不是 Eclipse 的问题。如果您使用 Properties 类来读取和存储属性文件，该类将转义所有特殊字符。

[从类文档中：](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Properties.html)

> 将属性保存到流或从流中加载它们时，使用 ISO 8859-1 字符编码。对于这种编码不能直接表示的字符，使用Unicode转义；但是，转义序列中只允许使用单个 'u' 字符。native2ascii 工具可用于将属性文件与其他字符编码进行转换。

[从 API 中，store() 方法：](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Properties.html#store(java.io.OutputStream,%20java.lang.String))

> 小于 \u0020 的字符和大于 \u007E 的字符被写为 \uxxxx 以获得适当的十六进制值 xxxx。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-06-14T20:44:01.713

```
Properties props = new Properties();
URL resource = getClass().getClassLoader().getResource("data.properties");         
props.load(new InputStreamReader(resource.openStream(), "UTF8")); 
```

奇迹般有效

:-)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-15T01:03:25.137

在您描述可能发生错误的过程中有太多点，所以我不会试图猜测您做错了什么，但我想我知道幕后发生了什么。

`EF BF BD`是 UTF-8 编码形式`U+FFFD`，解码器在遇到格式错误的输入时插入的标准替换字符。听起来您的文本被保存为 ISO-8859-1，然后像 UTF-8 一样读取，然后保存为 UTF-8，然后`native2ascii`使用平台默认编码（例如 windows-1252 ）。

```
ü => 0xFC // 保存为 ISO-8859-1
0xFC => U+FFFD // 读取为 UTF-8
U+FFFD => 0xEF 0xBF 0xBD // 保存为 UTF-8
0xEF 0xBF 0xBD => \u00EF\u00BF\u00BD // native2ascii
```

我建议你不要管“file.encoding”属性。像“file.separator”和“line.separator”一样，它并没有你想象的那么有用。相反，养成在读写文本文件时始终指定编码的习惯。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-10-26T12:06:15.183

```
Properties props = new Properties();
URL resource = getClass().getClassLoader().getResource("data.properties");         
props.load(new InputStreamReader(resource.openStream(), "UTF8")); 
```

这在 java 1.6 中运行良好。我怎么能在 1.5 中做到这一点，因为 Properties 类没有 pars 的方法`InputStreamReader`。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-11-21T17:26:14.143

有更简单的方法：

```
props.load(new InputStreamReader(new FileInputStream("properties_file"), "UTF8")); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-02-15T08:52:25.407

*.properties 文件的另一个 Eclipse 插件：

[属性编辑器](http://propedit.sourceforge.jp/index_en.html)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-07-09T09:29:37.290

您可以定义 UTF-8 .properties 文件来存储您的翻译并使用 ResourceBundle 来获取值。为避免出现问题，您可以更改编码：

```
String value = RESOURCE_BUNDLE.getString(key); 
return new String(value.getBytes("ISO-8859-1"), "UTF-8"); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-10-07T17:37:28.023

这似乎只适用于某些字符......包括德语、葡萄牙语、法语的特殊字符。但是，我遇到了俄语、印地语和普通话字符的问题。这些不会转换为属性格式“native2ascii”，而是使用 ?? ?? ??
我可以让我的应用程序正确显示这些字符的唯一方法是将它们放入转换为 UTF-8 格式的属性文件中 - 作为 \u0915 而不是 क，或 \u044F 而不是 я。有什么建议吗？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-10-11T13:30:37.513

我建议您使用 Attesoro ( [http://attesoro.org/](http://attesoro.org/) )。简单易用。并且是用java制作的。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2011-04-21T21:37:16.723

如果属性用于 XML 或 HTML，则使用 XML 实体是最安全的。它们读起来更难看，但这意味着属性文件可以被视为直接 ASCII，因此不会有任何损坏。

请注意，HTML 具有 XML 没有的实体，因此我使用直接 XML 来保证它的安全：http: [//www.w3.org/TR/html4/sgml/entities.html](http://www.w3.org/TR/html4/sgml/entities.html)

# .net - “NT AUTHORITY\SYSTEM”拥有的 PID 的 OpenProcess

> ID：863844
> 
> 赞同：1
> 
> 时间：2009-05-14T15:00:49.017
> 
> 标签：.net, winapi

我正在尝试使用 OpenProcess 函数在 C# 中打开一个进程句柄，如下所示：

```
IntPtr hProcess = OpenProcess(0x410, false, pid); 
```

`pid`我要打开的进程的进程 ID 在哪里。

在用户为“NT AUTHORITY\SYSTEM”（在 Vista x64 上）的 PI​​D 上调用时，上述调用失败，并出现“拒绝访问”错误。

**我如何处理这样的过程？**

让我认为这完全有可能的是 .NET`System.Diagnostics.Process`类似乎能够在此类进程上运行。例如，`Process.ProcessName`在这样的过程中运行良好。在引擎盖下，它调用`Process.MainModule.ModuleName`，它最终`OpenProcess`以与我完全相同的方式调用。但是，`System.Diagnostics`我没有收到“拒绝访问”错误。

奇怪的是，任何试图将进程句柄放入我的应用程序的东西也会引发异常。例如，`Process.Handle`两者`Process.MainModule`都抛出“拒绝访问”错误，尽管`Process.MainModule`通过`Process.ProcessName`.

**是否`System.Diagnostics`在某种提升的特权下运作？我怎样才能提高我的应用程序的权限才能做到这一点？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T16:56:12.957

> 我如何处理这样的过程？我怎样才能提高我的应用程序的权限才能做到这一点？

显然应用程序需要给自己`SeDebugPrivilege`：[如何使用 SeDebugPrivilege 获取任何进程句柄](http://support.microsoft.com/kb/185215)

但是，对于通用应用程序来说，依赖它并不是一个好主意，因为[SeDebugPrivilege 相当于管理员权限](http://blogs.msdn.com/oldnewthing/archive/2008/03/14/8080140.aspx)（安全方面）。

我仍然不确定如何在不需要.NET 的情况下准确地`System.Diagnostics`公开，但是我对 .NET 的代码安全功能几乎一无所知。`Process.ProcessName``SeDebugPrivilege`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T17:00:22.683

进程名称和其他一些东西不需要特权即可获得。

无论如何，您需要 SeDebugPrivilege 的原因是，对于 OpenProcess 的大多数参数，如果打开 SYSTEM 进程，您可能会危及机器的安全性。

出于明显的原因，请参阅 WriteProcessMemory。

此外，.NET 进程对内核来说并不特殊。如果您可以声明 OpenProcess，则您拥有 System.Diagnostics.Process 的所有权限。

# java - % 登录 Java 的 PreparedStatement

> ID：863848
> 
> 赞同：1
> 
> 时间：2009-05-14T15:01:31.243
> 
> 标签：java, sql, oracle, prepared-statement

```
PreparedStatement ps = con.createStatement("select * from table1 where last_name like ?");
ps.setString(1, "'%"+lastName+"'"); 
```

这会和...一样工作吗？

```
Statement s = con.createStatement("select * from table1 where last_name like %"+ lastName); 
```

还是 PreparedStatement 去掉了 % 符号？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T15:06:48.440

% 是一个通配符（至少在 Oracle 中），所以理论上两者应该是一样的（假设你添加了缺少的单引号）

但是，第一个被认为是更好的做法，因为它可以使数据库优化器不重新解析语句。第一个还应该保护您免受 SQL 注入，而第二个可能不会。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-14T15:11:41.097

第二个不起作用，因为您忘记了字符串周围的引号！旁边你需要逃避并小心 sql 注入。

假设 SQL

```
lastName = "and a quote' or a bracket()";
Statement s = con.createStatement("select * from table1 where last_name like '%"+ lastName + "'"); 
```

生成的 SQL 是：

```
select * from table1 where last_name like '%and a quote' or a bracket()' 
```

这将失败

绑定变量使其始终更安全。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T17:02:51.250

简短的回答是：是的，假设您修复了引用，两者应该给出相同的结果。百分号不会从准备好的语句中“删除”，就像任何其他字符一样。

更长的答案：准备好的语句与一次性语句的问题可能很复杂。如果您只打算执行一次，则准备好的语句将花费更长的时间，因为数据库引擎必须为准备好的语句完成所有设置，然后插入值，然后让它在缓存中浮动，直到引擎决定冲洗它。此外，优化器通常不能有效地处理准备好的语句。准备好的语句的全部意义在于优化器解析查询并设计一次查询计划。假设您说“从 customer_type=? 和 customer_zip=? 的客户中选择 customer_name”。您对类型和 zip 都有索引。使用一次性声明（当然，填充的是真实值而不是问号），许多数据库引擎中的查询优化器可以查看关于两个字段的值分布的统计信息，并选择将提供较小记录集的索引，然后按顺序读取所有这些并消除未通过第二次测试的记录。使用准备好的语句，它必须在知道将提供什么值之前选择索引，因此它可能会选择效率较低的索引。

你永远不应该在死亡的痛苦中编写代码，只是在未知值周围加上引号并将其填充到 SQL 语句中。要么使用准备好的语句，要么编写一个正确转义任何嵌入引号的函数。这样的函数写起来很简单。我不明白为什么 JDBC 不包含一个，所以您必须自己编写它并将其包含在每个应用程序中。（鉴于某些 SQL 方言具有应转义的单引号以外的字符，这一点尤其正确。）

以下是 Java 中此类函数的示例：

```
public static String q(String s)
{
  if (s==null)
    return "null";
  if (s.indexOf('\'')<0)
    return "'"+s+"'";
  int sl=s.length();
  char[] c2=new char[sl*2+2];
  c2[0]='\''; 
  int p2=1;
  for (int p=0;p<sl;++p)
  {
    char c=s.charAt(p);
    if (c=='\'')
      c2[p2++]=c;
    c2[p2++]=c;
  }
  c2[p2++]='\'';
  return new String(c2,0,p2);
} 
```

（注意：我刚刚从我从代码中提取的版本中编辑了该功能，以消除一些与此处无关的特殊情况——如果我在执行此操作时引入了一些小错误，请见谅。）

我通常给它一个非常短的名字，比如“q”，所以我可以写：

```
String sql="select customer_name from customer where customer_type="+q(custType)
  +" and customer_zip="+q(custZip); 
```

或类似的快速简单的东西。这违反了“为函数提供完整且有意义的名称”，但我认为在这里值得，我可以在一个语句中使用相同的函数十次。

然后我重载它以获取日期和数字以及其他特殊类型并适当地处理它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T17:36:31.247

使用带有绑定变量的准备好的语句要快得多，因为这意味着 Oracle 不必一次又一次地解析（编译）sql 语句。Oracle 将所有已执行的语句与执行计划一起存储在一个共享哈希表中以供重用。然而，Oracle 只会重用带有绑定变量的准备好的语句的执行计划。当你这样做时：

"select * from table1 where last_name like %"+ lastName

Oracle**不**重用执行计划。

（Oracle 对每个 sql 语句进行哈希处理，当您使用 select ... where last_name like %"+ lastName 每个 sql 语句都有不同的哈希值，因为变量 lastname 几乎总是有不同的值，所以 Oracle 在哈希表和 Oracle 不能重用执行计划。）

在多并发情况下，影响更大，因为 Oracle 锁定了这个共享哈希表。这些锁不会持续很长时间，但在多并发情况下，锁确实开始受到伤害。当您使用带有绑定变量的准备好的语句时，几乎不需要锁定。顺便说一下，Oracle 将这些自旋锁称为闩锁。

只有当您有一个数据仓库并且您的查询需要几分钟（报告）而不是几秒钟时，您才能使用非准备好的语句。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T15:13:11.107

我们经常毫无问题地使用第一种方法。例如：

```
String sql = "SELECT * FROM LETTER_BIN WHERE LTR_XML Like ' (?) ' AND LTR_BIN_BARCODE_ID = (?)";
try
{
    // Cast a prepared statement into an OralcePreparedStatement
    opstmt = (OraclePreparedStatement) conn.prepareStatement(sql);
    // Set the clob using a string
    opstmt.setString(1,fX.toString());
    // for this barcode
    opstmt.setLong(2,lbbi);
    // Execute the OraclePreparedStatement
    opstmt.execute();
} catch(java.sql.SQLException e)
{
    System.err.println(e.toString());
} finally
{
    if(opstmt != null)
    {
        try
        {
            opstmt.close();
        } catch(java.sql.SQLException ignore)
        {
            System.err.println("PREPARED STMT ERROR: "+ignore.toString());
        }
    }

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T21:02:33.623

好的，我会在 Oracle 上相信你的话。毫不奇怪，这取决于数据库引擎。Postgres 的行为与我描述的一样。当从 JDBC 使用 MySQL 时——至少在几年前我最后一次研究这个时——准备好的语句和单次使用的语句之间几乎没有区别，因为 MySQL JDBC 驱动程序将准备好的语句保存在客户端上另一方面，当您执行准备好的语句时，它会将值作为文本填充并将其发送到数据库引擎。因此，就引擎而言，确实没有准备好的语句之类的东西。得知其他引擎具有完全不同的行为，我一点也不感到惊讶。

# objective-c - Objective-C：在 .h 或 .m 中导入标头？

> ID：863855
> 
> 赞同：27
> 
> 时间：2009-05-14T15:02:33.457
> 
> 标签：objective-c

我是 Objective-c 的新手，想知道导入我在课堂上使用的一些外部头文件的最佳实践。

我应该将#import "classB.h" 存储在我自己的类 .h 文件还是 .m 文件中？

有什么不同？

谢谢！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-14T15:05:58.427

`@class classB;`在标题和`#import "classB.h`.m中放置前向类声明 ( ) 是正确的做法

一个前向类声明，就像`@class classB;`让编译器知道它应该稍后期待这个类，并且它现在不应该抱怨它。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-14T15:06:51.637

为避免循环引用，仅在另一个类的头文件中 #import 一个头文件（如果它是从该类继承的）。否则，`@class ClassName`如果您需要在头文件中声明类类型，请使用它来声明类类型，并在实现文件中#import它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-14T15:06:45.663

对于编译器来说，这真的无关紧要。你可以在你的 .h 中抛出前向声明，然后等到`#import`你的 .m 文件。[有关这](https://stackoverflow.com/questions/322597/objective-c-class-vs-import)方面的更多信息，请参阅SO 上的这篇文章。

从干净代码的角度来看，有些人可能会争辩说，将导入放在您的实现文件中可以使细节更接近需要它们的位置（也请参见上面的链接；那里的人参考了这个想法）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-18T15:49:05.527

建议您在头文件中导入其他头文件。这样您就可以在头文件和实现文件中使用该类（因为实现文件 (.m) 会导入其关联的头文件）。

如果你想知道什么时候导入文件，什么时候使用前向类声明，你可以去[这里](https://stackoverflow.com/questions/322597/class-vs-import "堆栈溢出文章：@class 与 #import")。;-)

# com - 基于 Windows Server 2008 x64 的 Excel 2007 自动化

> ID：863864
> 
> 赞同：25
> 
> 时间：2009-05-14T15:04:18.197
> 
> 标签：com, excel-2007, office-automation

我很清楚 Microsoft 支持基础文章指出不支持自动化办公产品 UI 较少。似乎**Windows Server 2008 x64 和 Excel 2007**强制执行给定的语句。

我在 NT 服务（本地系统帐户）的 OnStart 方法中运行以下代码。当您在控制台应用程序中运行相同的代码时，它所做的只是 Excel 自动化。

提供的代码有两部分。第一部分启动 Excel，创建一个新工作簿并将其保存到给定的文件名。第二部分启动一个新的 Excel 实例并打开给定的文件。打开操作在此异常中结束：

无法启动服务。System.Runtime.InteropServices.COMException (0x800A03EC)：Microsoft Office Excel 无法访问文件“c:\temp\test.xls”。有几个可能的原因：

• 文件名或路径不存在。• 该文件正被另一个程序使用。• 您尝试保存的工作簿与当前打开的工作簿同名。

**为什么自动 excel 能够启动并将文件写入磁盘，但当它被要求“仅”打开现有文件时却失败了？**

```
System.Threading.Thread.CurrentThread.CurrentCulture = new System.Globalization.CultureInfo("en-US");
// launch excel and create/save a new work book
Microsoft.Office.Interop.Excel.ApplicationClass excel = new       Microsoft.Office.Interop.Excel.ApplicationClass();
excel.UserLibraryPath, excel.Interactive));
//            
string filename = "c:\\temp\\test.xls";
if(System.IO.File.Exists(filename)) System.IO.File.Delete(filename);
//
excel.Workbooks.Add(System.Reflection.Missing.Value);
excel.Save(filename);
excel.Quit();
excel = null;
// lauch new instance of excel and open saved file
excel = new Microsoft.Office.Interop.Excel.ApplicationClass();
try
{
    Microsoft.Office.Interop.Excel.Workbook book = excel.Workbooks.Open(filename,
                System.Reflection.Missing.Value,
                System.Reflection.Missing.Value,
                System.Reflection.Missing.Value,
                System.Reflection.Missing.Value,
                System.Reflection.Missing.Value,
                true,
                System.Reflection.Missing.Value,
                System.Reflection.Missing.Value,
                false,
                false,
                System.Reflection.Missing.Value,
                false,
                System.Reflection.Missing.Value,
                System.Reflection.Missing.Value);
     book.Close(false, System.Reflection.Missing.Value, System.Reflection.Missing.Value);
      book = null;
  }
  finally
  {
      excel.Quit();
      excel = null;
  }
  //
  GC.Collect(); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-07-07T07:39:16.733

*解决方案非常简单。可以在[这里找到 msdn 论坛主题](http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91)*

*长话短说，我在这里发布解决方案，归功于**H Ogawa***

这个解决方案是...

・Windows 2008 Server x64

请制作这个文件夹。

C:\Windows\SysWOW64\config\systemprofile\Desktop

・Windows 2008 Server x86

请制作这个文件夹。

C:\Windows\System32\config\systemprofile\Desktop

...而不是 dcomcnfg.exe。

此操作消除了我系统中的办公自动化问题。

在 systemprofile 文件夹中似乎需要一个 Desktop 文件夹才能通过 Excel 打开文件。

它从 Windows2008 中消失，Windows2003 有该文件夹，我认为它会导致此错误。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-12-06T03:13:24.223

同样如源代码中所述，您需要为桌面文件夹设置正确的权限。这适用于 Windows 2008-64 位和 Office 2010 32 位。

1.  创建目录“C:\Windows\SysWOW64\config\systemprofile\Desktop”（适用于 64 位 Windows）或“C:\Windows\System32\config\systemprofile\Desktop”（适用于 32 位 Windows）

2.  为用户“Network Services (Service Réseau)”分配所创建文件夹的以下权限：

读取和执行、列出文件夹内容、读取

约翰。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T16:46:05.220

我经常发现调用 Quit() 不足以释放资源。尝试添加： -

```
System.Runtime.InteropServices.Marshal.ReleaseComObject(excel); 
```

在 Quit() 语句和将其设置为 null 之间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-15T20:56:15.480

为了让 Excel 在 64 位 Windows Server 2007 上运行，您需要解决的错误比提到的错误多得多。请参阅[我](http://hopschwiiz.blogspot.com/2011/02/automating-excel-2007-on-windows-server.html "在 Windows Server 2008 64 位上自动化 Excel 2007")在此工作两天后制定的步骤！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-29T20:43:16.897

如果您使用的是 Apache，您可能还需要按照以下步骤使 MS Word 正常工作（以及其他答案中概述的所有内容）：

下面是一个屏幕截图，显示了您需要调出的两个对话框： ![在此处输入图像描述](https://i.stack.imgur.com/1JDiX.jpg)

对于阿帕奇：

服务->Apache->右键单击（属性）->登录选项卡

微软字：

启动 dcomcnfg.exe->控制台根目录->组件服务->计算机->我的电脑->DCOM 配置->查找 Microsoft 应用程序->右键单击（属性）->身份选项卡

**如果您找不到 MS Word，请确保根据您安装的 Office 版本启动正确的 DCOM 配置（64 位与 32 位）。

这里有两个选项，您可以将 Apache 设置为使用*本地系统帐户*并选中复选框以允许桌面交互。如果这样做，则需要将MS Word的*Identity设置为***Interactive User**。

否则，您需要将两者都设置为同一个用户（理想情况下是登录的用户），如图所示。

# c# - 我应该在类中使用字段还是属性来设置值

> ID：863866
> 
> 赞同：6
> 
> 时间：2009-05-14T15:04:44.793
> 
> 标签：c#

所以我和一位同事就一段代码进行了友好的争论：

```
public sealed class NewObject
{
    private string _stuff = string.Empty;

    public string Stuff
    {
        get { return GetAllStuff(); }
    }

    private string GetAllStuff()
    {
        //Heavy string manipulation of _stuff
    }

    public NewObject(string stuffToStartWith)
    {
        _stuff = stuffToStartWith;
    }

    public static NewObject operator +(NewObject obj1, NewObject obj2)
    {
        if (obj1 == null)
            throw new ArgumentNullException();

        if (obj2 == null)
            throw new ArgumentNullException();

        NewObject result = new NewObject(string.Empty);
        result._stuff = String.Concat(obj1._stuff, obj2._stuff);

        return result;
    }
} 
```

参数超过了运算符覆盖。我的同事认为，在构造函数之外的任何地方设置私有字段的值并不是最佳编程实践。我的同事提出的解决方案是将`Stuff`属性的名称重构为`AllStuff`并添加一个`Stuff`具有`get`AND`set`访问器的属性，并在运算符覆盖中使用新`Stuff`属性。使它看起来像这样：

```
 public static NewObject operator +(NewObject obj1, NewObject obj2)
    {
        if (obj1 == null)
            throw new ArgumentNullException();

        if (obj2 == null)
            throw new ArgumentNullException();

        NewObject result = new NewObject(string.Empty);
        result.Stuff = String.Concat(obj1.Stuff, obj2.Stuff);

        return result;
    } 
```

我不同意。我觉得第一种方法更好，因为它使属性在课堂外保持只读。我的问题是，哪种方式是面向对象设计的最佳实践？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T15:07:06.207

您可以给自己一个`private set`属性（这将保留可见性或缺乏可见性，同时允许您使用属性语法），但这并不能真正解决问题。

在课堂上，我说变量是公平的游戏。外部的任何地方，包括继承的类，都应该`get`和`set`属性，但在声明的类中，我说可以分配私有成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T15:06:42.043

你是对的

错误...详细说明，您的私有变量是您自己做的。如果有人对您进行了更改对象值的操作（尤其是像 + 之类的操作），那么在构造函数之外修改值并没有错。这就是他们私密的全部意义所在。

除非你想要它不可变......

**更新**
我想得越多，我就越相信您的同事将“私有”变量与“常量”变量混淆了——或者可能将这两个概念合并。没有理由私有变量必须在对象的整个生命周期中保持不变，这就是您的朋友似乎所暗示的。const 代表不变，private 仅代表对象，它们是两种截然不同的模式。

 **更新 2此外，如果突然您的对象不仅仅是一个字符串，而且变量是交织在一起的（想想一个字符串对象，它有一个 char* 和一个 len，并且必须一起维护），他的设计就会崩溃**。**您想要的最后一件事是用户必须处理对象的内部变量。让对象成为一个对象并保持其自己的内部值并向用户呈现单个实体。**

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T15:41:27.687

一般问题与合同政策有关。

（公共集）属性的概念是，当它被调用时，除了改变状态的语义概念之外，还可以采取其他动作。例如，调用 setter 可能会触发事件、触发外围设备等。

您的同事说，如果不使用该物业，您就是在回避合同，并且不会触发任何事件。

所以从你同事的角度来看，你应该这样做：

```
this.Prop = CalculateSomeValue();
if (this.Prop < kPropMin) {
    this.Prop = kPropMin;
}
else if (this.Prop > kPropMax * 2) {
    this.Prop = kPropMax * 2;
}
this.Prop = this.Prop / 2; 
```

现在，这是一个人为的案例，但我刚刚在 get 中击中了一个可能的重量级属性，在 get 中达到了 3 次，在 set 中达到了 3 次，其中一个可能是非法的（设置为 kHighLimit / 2）。我可以通过使用本地并在最后精确地调用一次集合来解决这个问题。不过，我宁愿把这个领域搞得一团糟。

我认为更好的方法是务实地使用它：当且仅当您想要调用 set 或 get 的所有副作用时才在类中使用该属性，否则请遵循该属性的精神。

-- 澄清 -- 按照属性的精神，假设我的 set 属性如下所示：

```
bool PropValueOutOfRange(int val) {
    return val < kPropMin || val > kPropMax;
}

public int Prop {
    set {
        if (PropValueOutOfRange(value))
            throw new ArgumentOutOfRangeException("value");
        if (PropValueConflictsWithInternalState(value))
            throw new ArgumentException("value");
        _prop = value;
        NotifyPeriperalOfPropChange(_prop);
        FirePropChangedEvent(/* whatever args might be needed */);
    }
} 
```

在这我已经考虑了很多蹩脚的细节，但这让我可以重用它们。所以现在我对接触私有字段 _prop 充满信心，因为我拥有相同的基础设施来确保将其保持在范围内并通知外围设备并触发事件。

这让我可以编写这段代码：

```
_prop = CalculateSomeValue();

if (_prop < kPropMin)
    _prop = kPropMin;
else if (_prop > kPropMax * 2)
    _prop = kPropMax;

_prop /= 2;

NotifyPeripheralOfPropChange();
FirePropChangedEvent(); 
```

我使用的工具与用于建造房产的工具相同，因此我在按照房产的精神工作。我保持正确的范围（但不要抛出 - 我更清楚，我是实施者），击中外围和触发事件，并且我深思熟虑、可读且有效地进行 - 而不是不加选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T15:11:23.717

我看不出他的方法有什么好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T15:19:18.520

我个人更喜欢根本没有字段，因此如果想要只读属性，我会使用自动实现的`private`属性而不是`private`字段和属性。 如果我必须向属性添加代码，我仍然只使用属性访问器内部的字段，并在其他任何地方使用 getter 和 setter，包括构造函数。 如果需要字段，我也必须使用字段，但 C# 4.0 将引入只读属性。`public-get` `private-set``public`

`readonly`

* * *

此外，我会通过使用以下代码来避免整个问题。

```
public static NewObject operator +(NewObject obj1, NewObject obj2)
{
    return new NewObject(String.Concat(obj1.Stuff, obj2.Stuff));
} 
```

* * *

我喜欢的实现是这样的。

```
public sealed class NewObject
{
    private String Stuff { get; set; }

    // Use a method instead of a property because the operation is heavy.       
    public String GetAllStuff()
    {
        // Heavy string manipulation of this.Stuff.
        return this.Stuff;
    }

    // Or lets use a property because this.GetAllStuff() is not to heavy.
    public String AllStuff
    {
        get { return this.GetAllStuff(); }
    }

    public NewObject(String stuffToStartWith)
    {
        this.Stuff = stuffToStartWith;
    }

    public static NewObject operator +(NewObject obj1, NewObject obj2)
    {
        // Error handling goes here.

        return new NewObject(String.Concat(obj1.Stuff, obj2.Stuff);
    }
} 
```

# performance - 数据库速度优化：少表多行，还是多表少行？

> ID：863867
> 
> 赞同：4
> 
> 时间：2009-05-14T15:04:47.010
> 
> 标签：performance, postgresql, database-design

我有一个很大的疑问。

让我们以任何公司订单的数据库为例。

假设这家公司每月大约有 2000 个订单，因此，每年大约有 24K 个订单，并且他们不想删除任何订单，即使它已经 5 年了（嘿，这是一个例子，数字并不意味着任何事物）。

就数据库查询速度而言，最好只有一张表，还是每年一张表会**更快**？

我的想法是每年为订单创建一个新表，调用此类 orders_2008、orders_2009 等。

加速数据库查询是个好主意吗？

通常使用的数据是当年的数据，所以行越少越好。。显然，当我同时搜索订单的所有表时，这会出现问题，因为我应该运行一些复杂的 UNION ..但这发生在正常活动中非常少见。

我认为最好有一个应用程序 95% 的查询是快速的，其余的有点慢，而不是一个总是很慢的应用程序。

我的实际数据库有 130 个表，我的应用程序的新版本应该有大约 200-220 个表。其中大约 40% 将每年复制一次。

有什么建议吗？

**编辑**：RDBMS 可能是 Postgresql，可能（希望不是）Mysql

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T15:11:59.957

较小的表更快。时期。

如果您有很少使用的历史，那么将历史记录到其他表中会更快。

这就是数据仓库的意义——将运营数据与历史数据分开。

您可以运行从操作和负载到历史的定期提取。所有的数据都被保留了，只是被隔离了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-14T15:24:01.907

在担心查询速度之前，请考虑成本。

如果将代码拆分为单独的代码，则必须有处理它的代码。你写的每一段代码都有可能出错。您要求您的代码有错误，而牺牲了一些无法衡量的和想象中的性能优势。

还要考虑机器时间与程序员时间的成本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-14T15:14:47.407

如果您正确使用索引，您可能不需要将其拆分为多个表。大多数现代数据库将优化访问。

您可能会考虑的另一个选择是创建一个当前年份的表，最后将数据附加到另一个包含所有前几年数据的表中。?

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T15:14:02.573

我不会按年份拆分表格。

相反，我每年都会将数据归档到报告数据库中，并在需要时使用它。

或者，您可以在驱动器之间对数据进行分区，从而保持性能，尽管我不确定这在 postgresql 中是否可行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T15:27:26.207

对于您正在查看的数据量，拆分数据似乎很麻烦，收效甚微。Postgres 可以进行分区，但是精美的手册 [1] 说，根据经验，您可能应该只对超过服务器物理内存的表考虑它。根据我的经验，这至少是一百万行。

1.  [http://www.postgresql.org/docs/current/static/ddl-partitioning.html](http://www.postgresql.org/docs/current/static/ddl-partitioning.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T15:21:27.030

我同意较小的表更快。但是，将单个实体拆分到多个表是否有意义，这取决于您的业务逻辑。如果您需要大量代码来管理所有表，那么这可能不是一个好主意。

它还取决于数据库您可以使用什么逻辑来解决这个问题。[在 Oracle 中，可以对表进行分区](http://download-east.oracle.com/docs/cd/B10501_01/server.920/a96524/c12parti.htm)（例如按年）。数据物理存储在不同的表空间中，这应该可以更快地处理（因为我假设一年的所有数据都存储在一起）

索引会加快速度，但如果数据分散在磁盘上，则需要大量的块读取，这可能会使其变慢。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T15:30:17.680

研究按时间片对表进行分区。分区适用于没有外键指向表的类日志表情况。

# c# - 测量库中的性能瓶颈

> ID：863868
> 
> 赞同：0
> 
> 时间：2009-05-14T15:04:47.993
> 
> 标签：c#, .net, visual-studio, performance

在我的网站中，我有一个相当复杂的业务逻辑部分封装在一个 DLL 中。因为当我调用它的某些方法时 CPU 使用率达到顶峰，所以我需要测量和优化。
我知道性能分析器，但我不知道如何为库设置它。
此外，我似乎没有找到任何有用的资源。

你如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T15:08:39.167

您可以创建一个运行库的主要方法的简单 exe。虽然需要一些了解才能知道调用哪种方法，但它可以帮助您专注于特定场景并检查它们的瓶颈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T15:16:49.570

您还可以放置一些性能计数器：[查看 msdn](http://msdn.microsoft.com/en-us/library/3xxk09t8.aspx)，或打开调试器并使用旧系统：创建一个 Stopwatch 并执行 Debug.Writeline 以查看发生了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T21:50:12.807

正如 Dror 所说，在一个简单的 exe 下独立运行它。我会添加，在 IDE 下运行它，虽然它很慢，但只需暂停它几次，每次都详细查看它在做什么。这是违反直觉的[，但非常有效](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)。

# sql-server - Biztalk 可以在没有信任关系的情况下使用不同域中的远程 MSQL 服务器吗？

> ID：863869
> 
> 赞同：0
> 
> 时间：2009-05-14T15:05:06.227
> 
> 标签：sql-server, authentication, active-directory, biztalk

我有一个要与 biztalk 一起使用的远程 MSQL 实例。我的机器运行 biztalk 不能和 MSSQL 实例加入同一个域，也不能在两个 windows 域之间建立信任关系。

有没有办法配置 biztalk 进行身份验证？用户名/密码（就像任何其他数据库一样）会很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T20:20:43.567

如果您正在谈论使用 SQL Server 作为 BizTalk 安装的主要数据层，那么也许可以。有一个旧技巧，您可以使用 sam 凭据（ID 和密码）在两台服务器上创建本地帐户，然后使用本地帐户提供服务。这是hacky，不推荐。

至于 SQL Server 适配器，只需在连接字符串中提供凭据。可以是 SQL 帐户或远程域帐户。

# sql - Id 或 [TableName]Id 作为主键/实体标识符

> ID：863872
> 
> 赞同：5
> 
> 时间：2009-05-14T15:05:21.750
> 
> 标签：sql, sql-server, database-design, orm, naming-conventions

是首选使用“Id”作为主键的列名还是使用“[TableName]Id”作为命名约定？

> 表：帐户
> 主键：ID

- 相对 -

> 表：账户
> 主键：AccountId

在我见过的实现中，它似乎被分成了大约 50% / 50%。每种方法的优点和缺点是什么？

**跟进：**

在我的数据库中使用一种约定，在代码中的实体上使用另一种约定是否有意义？还是我应该让它们保持一致？这在大多数 ORM 中如何发挥最佳作用？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-14T15:09:16.703

为了清楚起见，TableNameID

1.  提高 JOIN 的可读性
2.  清晰度，例如，当多个 FK“ID”列（PK 匹配 FK）时
3.  ID 是保留关键字

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-14T15:09:22.787

我用身份证。您将如何设置使用帐户 ID 作为外键的用户表？您会将该列命名为 AccountAccountID 还是 AccountID？

但在我看来，最重要的部分是保持一致，无论您选择哪种方式。

**编辑**：我认为在阅读我的评论时，我的论点的逻辑是关闭的，因为显然你不会调用字段 AccountAccountID。但乍一看，使用 [TableName]ID 作为主键和 [TableName]ID 作为外键也让我*觉得*很奇怪。似乎您对应该遵循同一组标准的两件事使用了两种不同的规则。另外我认为 Account.ID 和 User.AccountID 更具可读性和语义正确性。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T15:49:02.987

避免使用 ID、状态、描述等常用词作为列名。

使用 WarehouseID、WarehouseStatus、WarehouseDescription 之类的名称，当您编写查询、搜索代码、阅读旧代码等时，这些名称将使您的生活更轻松。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T15:08:32.087

第一种方法更可能是 OOP 命名约定。

第二种方法的优点是可以避免连接查询中的列名不明确。尽管您可以使用别名，但有时这是不可能的，例如在某些 ORM 框架中（想到实体空间）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-14T15:17:11.287

我发现显式命名（TableId）更好。首先，所有外键都以这种方式具有自然名称（[RelatedTable]Id）。而且我总是最终返回带有两种类型 Id 的连接查询，我被迫正确地为它们起别名，以便客户端可以区分 AccountId 和 ClientId。使用显式键名还简化了我的数据访问/orm 层逻辑，因为它不必处理歧义，例如。帐户类型键始终是“AccountId”，在某些查询中不是“Id”，在其他查询中是“AccountId”。我的2c。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T15:11:57.180

我同意你的看法。这是一个分裂。Id 本身并不是很具有描述性。通常我不使用Id，因为在处理可能存在的sql注入风险时使用AccountId要安全得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T15:18:23.717

好吧，我一直使用一种方案，发现它非常有用。

表中的主键始终称为“ID”，使用拆分键，我将具有行标识信息的列称为“ID”，否则不调用“ID”列。

所有外键都使用它们所引用的表的名称。

```
CREATE TABLE `Person`  
(
  `ID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
  `FirstName` VARCHAR(255)  NOT NULL,
  `LastName` VARCHAR(255)  NOT NULL,
  PRIMARY KEY (`ID`)
);

CREATE TABLE `Tutorial`
(
  `ID` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `Name` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`ID`)
);

CREATE TABLE `Class`
(
  `Person` INTEGER UNSIGNED NOT NULL,
  `Tutorial` INTEGER UNSIGNED NOT NULL
  PRIMARY KEY (`Person`, `Tutorial`)
); 
```

# jquery - 对话框错误中的 JQuery 自动完成

> ID：863876
> 
> 赞同：3
> 
> 时间：2009-05-14T15:05:53.667
> 
> 标签：jquery, asp.net-mvc, ajax, jquery-ui, autocomplete

全部，

我在 JQuery UI 对话框中使用 JQuery Autocomplete Plugin 1.0.2。不幸的是，有**两种情况会导致 IE 和 FireFox 中的脚本错误**。我将提供 FireFox Firebug 错误，因为它们更具描述性。

首先，这是允许选择多个名称的 JQuery 自动完成脚本：

```
var queues = <% Html.RenderAction("AvailableQueues"); %>;
$($.jqId("requestQueuesText"), $theForm).autocomplete(queues, {
    minChars: 1,
    formatItem: function(row) {
        return row.Description;                
    },
    multiple: true,
    multipleSeparator: ";"
 }); 
```

现在，这是导致错误发生的两种情况：

* * *

1）在其他任何内容之前输入一个空格“”，我立即得到

错误：**currentValue 未定义**；onChange()jquery.a...mplete.js（第 239 行）；[打破这个错误] if (currentValue.length >= options.minChars) {

2) 在自动完成下拉列表打开时关闭对话框，但不选择项目

**这是我应该修复的**报告的错误。**对话框关闭后，自动完成框将在视图中停留几毫秒到几秒不等。主要目标是在对话框关闭的同时关闭自动完成下拉菜单，而不返回任何错误。我打赌解决错误将解决整体问题。*

错误：**未捕获的异常**：[异常...“组件返回失败代码：0x80004005 (NS_ERROR_FAILURE) [nsIDOMNSHTMLTextAreaElement.setSelectionRange]”nsresult:“0x80004005 (NS_ERROR_FAILURE)”位置：“JS 框架 :: [http://localhost:2659/Scripts /jquery.autocomplete.js](http://localhost:2659/Scripts/jquery.autocomplete.js) :: 匿名 :: line 752" data: no]

* * *

仅通过查看[**自动完成文档**](http://docs.jquery.com/Plugins/Autocomplete/autocomplete#urlordataoptions)，我发现我可能需要以不同的方式使用**formatItem**选项。

另外，我遇​​到了[**BGIFRAME**](http://plugins.jquery.com/project/bgiframe)，它看起来可能以某种方式提供帮助。

提前感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T14:06:32.523

我能够通过将 keydown 事件链接到自动完成代码来解决第一个问题：

```
var queues = <% Html.RenderAction("AvailableQueues"); %>;
    $($.jqId("requestQueuesText"), $theForm).autocomplete(queues, {
        minChars: 1,
        formatItem: function(row) {
            return row.Description;                
        },
        multiple: true,
        multipleSeparator: ";",
        selectFirst: false
    }).keydown(function(event) {
        if (this.value != "" && this.value.charAt(this.value.length-1) != ";")
            return true;

        var keycode = $.browser.msie ? event.keyCode : event.which;
        return !/\s/.test(String.fromCharCode(keycode));
    }); 
```

这将在最初输入文本区域时禁止空格，并且还将防止分号后的空格（multipleSeparator）。

＃2仍然有问题。我想我需要在**Close**属性或**$('a.close-trigger')**上添加悬停或单击事件，这将从文本区域中删除 focus() ，从而迫使自动完成下拉菜单消失... Don '还不知道如何使用以下对话框代码来完成此操作：

```
$(".requestLink").click(function(event) {
        event.preventDefault();
        var $this = $(this);
        $this.addClass("loading");
        $.get(this.href, function(data) {
            $this.removeClass("loading");
            var $req = $("<div></div>").dialog({
                autoOpen: true,
                height: 650,
                width: 750,
                modal: true,
                title: "Request",
                overlay: { "background-color": "#d2d2d2", "opacity": "0.40"}
            }).html(data);
        });
    }); 
```

# c# - 如何判断一个类型是否是“简单”类型？即持有一个值

> ID：863881
> 
> 赞同：74
> 
> 时间：2009-05-14T15:06:22.123
> 
> 标签：c#, .net, generics

```
typeof(string).IsPrimitive == false
typeof(int).IsPrimitive == true
typeof(MyClass).IsClass == true
typeof(string).IsClass == true
typeof(string).IsByRef == false
typeof(MyClass).IsByRef == true // correction: should be false (see comments below) 
```

我有一个实例化 T 的新实例的方法，如果它是一个“复杂”类，则从一组源数据值中填充其属性。

(a) 如果 T 是简单类型（例如，字符串或 int 或其他类似的类型），则将执行从源数据到 T 的快速转换。

(b) 如果 T 是一个类（但不是像字符串这样简单的东西），那么我将使用 Activator.CreateInstance 并做一些反射来填充字段。

有没有一种快速简单的方法来判断我应该使用方法（a）还是方法（b）？此逻辑将在以 T 作为类型参数的泛型方法中使用。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-05-14T15:14:45.910

字符串可能是一种特殊情况。

我想我会做......

```
bool IsSimple(Type type)
{
    return type.IsPrimitive 
      || type.Equals(typeof(string));
} 
```

* * *

**编辑：**

有时您需要涵盖更多情况，例如枚举和小数。枚举是 C# 中的一种特殊类型。小数与其他结构一样。结构的问题在于它们可能很复杂，它们可能是用户定义的类型，它们可能只是一个数字。因此，除了知道它们进行区分之外，您没有其他机会。

```
bool IsSimple(Type type)
{
  return type.IsPrimitive 
    || type.IsEnum
    || type.Equals(typeof(string))
    || type.Equals(typeof(decimal));
} 
```

处理可为空的对应物也有点棘手。可空对象本身就是一个结构。

```
bool IsSimple(Type type)
{
  if (type.IsGenericType && type.GetGenericTypeDefinition() == typeof(Nullable<>))
  {
    // nullable type, check if the nested type is simple.
    return IsSimple(type.GetGenericArguments()[0]);
  }
  return type.IsPrimitive 
    || type.IsEnum
    || type.Equals(typeof(string))
    || type.Equals(typeof(decimal));
} 
```

测试：

```
Assert.IsTrue(IsSimple(typeof(string)));
Assert.IsTrue(IsSimple(typeof(int)));
Assert.IsTrue(IsSimple(typeof(decimal)));
Assert.IsTrue(IsSimple(typeof(float)));
Assert.IsTrue(IsSimple(typeof(StringComparison)));  // enum
Assert.IsTrue(IsSimple(typeof(int?)));
Assert.IsTrue(IsSimple(typeof(decimal?)));
Assert.IsTrue(IsSimple(typeof(StringComparison?)));
Assert.IsFalse(IsSimple(typeof(object)));
Assert.IsFalse(IsSimple(typeof(Point)));  // struct in System.Drawing
Assert.IsFalse(IsSimple(typeof(Point?)));
Assert.IsFalse(IsSimple(typeof(StringBuilder))); // reference type 
```

**.NET Core 的注意事项**

[正如 DucoJ 在他的回答](https://stackoverflow.com/questions/863881/how-do-i-tell-if-a-type-is-a-simple-type-i-e-holds-a-single-value/38998370#38998370)中指出的那样`Type`，.NET 核心中的类不再提供一些使用的方法。

固定代码（我希望它有效，我无法自己尝试。否则请发表评论）：

```
bool IsSimple(Type type)
{
  var typeInfo = type.GetTypeInfo();
  if (typeInfo.IsGenericType && typeInfo.GetGenericTypeDefinition() == typeof(Nullable<>))
  {
    // nullable type, check if the nested type is simple.
    return IsSimple(typeInfo.GetGenericArguments()[0]);
  }
  return typeInfo.IsPrimitive 
    || typeInfo.IsEnum
    || type.Equals(typeof(string))
    || type.Equals(typeof(decimal));
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-08-17T13:42:19.177

除了 Stefan Steinegger 的回答：在 .NET Core 中，.IsPrimitive 等不再是 Type 的成员，它们现在是 TypeInfo 的成员。所以他的解决方案将变为：

```
bool IsSimple(TypeInfo type)
{
    if (type.IsGenericType && type.GetGenericTypeDefinition() ==     typeof(Nullable<>))
    {
        // nullable type, check if the nested type is simple.
        return IsSimple((type.GetGenericArguments()[0]).GetTypeInfo());
    }
    return type.IsPrimitive
      || type.IsEnum
      || type.Equals(typeof(string))
      || type.Equals(typeof(decimal));
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-08-13T18:55:17.093

有一种比原始类型更通用的类型，ValueType 包含的不仅仅是原始类型，例如枚举、十进制和其他诸如[ValueType](https://msdn.microsoft.com/en-us/library/aa691141(v=vs.71).aspx)之类的东西。下面是我编写的用于识别复杂类型的函数，它可能满足您的需求。

```
 public static bool IsComplex(Type typeIn)
    {
        if (typeIn.IsSubclassOf(typeof(System.ValueType)) || typeIn.Equals(typeof(string))) //|| typeIn.IsPrimitive
            return false;
        else
            return true;

    } 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-11-30T19:28:35.377

使用基于的解决方案`TypeConverter`也是一种很好且简单的建模方法。

假设你有这个实现，例如：

```
public static bool IsSimple(this Type type) =>
    TypeDescriptor.GetConverter(type).CanConvertFrom(typeof(string)); 
```

这将返回`true`：

*   所有原始类型
*   所有枚举
*   `string`s
*   `decimal`s
*   `DateTime`
*   `DateTimeOffset`
*   `TimeSpan`
*   `Uri`
*   `Guid`
*   `Nullable<>`上述任何类型的
*   许多其他已经`TypeConverter`实现了 native 的类型（参见本节的[此处](https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.typeconverter?view=net-5.0)`Derived`）

这种方法效果很好，因为大多数框架都原生支持`TypeConverter`s，比如 XML 和 Json 序列化库，然后您可以使用相同的转换器在读取时解析值。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-02T21:00:12.450

很抱歉复活了一个非常老的线程，但由于这仍然在谷歌的网络搜索中排名很高，想要添加一个更直接有效的解决方案：

```
if(System.Type.GetTypeCode(typeof(int)) == TypeCode.Object) {
    // Do what you will...
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T15:22:41.177

这可能无关紧要，但听起来您忽略了一些情况：

1.  具有转换的复杂类型
2.  没有无参数构造函数的值类型。下面的例子：

可能还有更多，但我认为您以过度限制的方式划分问题空间。

```
 public class Person {
    private string _name;
    private int _age;
    public Person(string name, int age) {_name = name; _age = age;}
    // Remainder of value implementation
 } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-03-12T17:46:20.343

修改毛瑟的回答一点点添加了一个方法来检查一个属性是否是一个集合。

> ```
> public static class TypeExtensions
> {
>     public static bool IsComplex(this Type type)
>     {
>         return !type.IsValueType && type != typeof(string);
>     }
> 
>     public static bool IsCollection(this Type type)
>     {
>         var collectionTypeName = typeof(ICollection<>).Name;
>         return type.Name == collectionTypeName || type.GetInterface(collectionTypeName) != null;
>     }
> } 
> ```

在 IsCollection(..) 内部，我们甚至可以保留 IEnumerable，但字符串也继承了 IEnumerable。因此，如果您使用的是 IEnumerable，请同时添加对字符串的检查！

```
public static class TypeExtensions
    {

        public static bool IsComplex(this Type type)
        {
            return !type.IsValueType && type != typeof(string);
        }

        public static bool IsCustomComplex(this Type type)
        {
            var elementType = type.GetCustomElementType();
            return elementType != null && elementType.IsComplex();
        }

        public static Type GetCustomElementType(this Type type, object value)
        {
            return value != null 
                ? value.GetType().GetCustomElementType() 
                : type.GetCustomElementType();
        }

        public static Type GetCustomElementType(this Type type)
        {
            return type.IsCollection()
                ? type.IsArray
                    ? type.GetElementType()
                    : type.GetGenericArguments()[0]
                : type;
        }

        public static bool IsCustomComplex(this Type type, object value)
        {
            return value != null
                ? value.GetType().IsCustomComplex()
                : type.IsCustomComplex();
        }

        public static bool IsCollection(this Type type)
        {
            var collectionTypeName = typeof(IEnumerable<>).Name;
            return (type.Name == collectionTypeName || type.GetInterface(typeof(IEnumerable<>).Name) != null ||
                    type.IsArray) && type != typeof(string);
        }

        public static bool HasDefaultConstructor(this Type type)
        {
            return type.IsValueType || type.GetConstructor(Type.EmptyTypes) != null;
        }

    } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-14T15:19:58.253

如果我没记错的话，字符串不是原语。即使有一个关键字，字符串也是一个对象。您对 IsPrimitive 的调用将准确地告诉您某物是否是原始的。

# c# - 使用 C# 在 ASP.NET 中出现 NullReferenceException 错误 - 尝试处理错误

> ID：863883
> 
> 赞同：0
> 
> 时间：2009-05-14T15:06:26.273
> 
> 标签：c#, asp.net, nullreferenceexception

我有一个 ASP.NET 网络表单，除了其他控件之外，它还有一个用于输入值的文本框、一个用于显示值的文本框、一个下拉列表框和一个搜索按钮。我正在使用以下代码来显示搜索结果：

```
if (TextBox3.text == DropDownList3.Items.FindByText(TextBox3.Text).Value) 
{
  etc... 
} 
```

DDL3 从 DataTable 中获取其值，输入到 TextBox3 中的值应与 DDL3 值之一匹配，以在单击搜索按钮后显示搜索结果。当 TextBox3 值为 null 或与 DDL3 中的任何值都不匹配时，会发生 NullReferenceException 错误。这是合理的；但是，我花了几个小时试图处理这个错误，但我似乎无法弄清楚如何解决它。我曾尝试添加额外的“If”语句，例如“if TextBox3 == null 等...；但是，无济于事。我应该如何更改上述 if 语句以补偿空值或错误值？

谢谢，

DFM

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T15:07:45.817

尝试使用 try...catch 处理该异常：

```
try {
    TextBox3.text = DropDownList3.Items.FindByText(TextBox3.Text).Value
} catch (NullReferenceException ex) {
    TextBox3.text = "(none)";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:10:36.730

在检查其值之前，您应该检查该项目是否存在于列表中。

```
if (DropDownList3.Items.FindByText(TextBox3.Text) != null)
{
   // ...
} 
```

# windows - Windows Callgrind 结果浏览器，KCacheGrind 的替代品

> ID：863893
> 
> 赞同：35
> 
> 时间：2009-05-14T15:07:42.680
> 
> 标签：windows, valgrind, profiling, callgrind

除了 KCacheGrind 之外，是否有任何工具能够查看 callgrind 结果？最好用于 Windows 平台？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2010-12-13T05:16:49.813

我已经使用 QT4.7 在 Windows 上编译了 kcachegrind，这里是二进制包（包括生成调用图的点实用程序）：http: [//sourceforge.net/projects/precompiledbin/files/kcachegrind.zip/download](http://sourceforge.net/projects/precompiledbin/files/kcachegrind.zip/download)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-01-27T17:29:03.060

试试 WebGrind：[https ://github.com/jokkedk/webgrind](https://github.com/jokkedk/webgrind)

在本地 PHP 服务器上运行。请注意，使用带有 XDEBUG_PROFILE 标志的 XDebug 分析，否则当您打开 WebGrind 时，您将面临覆盖分析输出的风险（因为 WebGrind 也是一个 PHP Web 应用程序）。WebGrind 网站还详细介绍了解决此问题的其他方法。干杯。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-09-18T13:02:28.360

你可以试试[WinCacheGrind](http://sourceforge.net/projects/wincachegrind/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-12-31T07:35:08.183

似乎 WinCacheGrind 无法打开 callgrind 的输出。我没有尝试打开 cachegrind 的输出，但我想它应该可以工作。从 Valkyrie 页面，（截至日期）“目前，Valkyrie 仅支持 Memcheck，尽管处理 Cachegrind 和 Massif 的工作正在进行中。”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T11:41:52.770

[alleyoop](http://alleyoop.sourceforge.net/)和[valkyrie（断开的链接）](https://#)是替代前端。

可能有足够的支持来满足您的需求，如果 SUA 无法开箱即用，您可以使用 mingw 为 Windows 原生编译。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-20T18:01:17.827

[有一个名为XCallGraph](http://sourceforge.net/projects/xcallgraph/)的新项目用于在 Windows 上查看 cachegrind 文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-10-07T16:28:00.700

我试过这些：

*   [QCacheGrind](http://sourceforge.net/projects/qcachegrindwin/)
*   [KCachegrind](http://sourceforge.net/projects/precompiledbin/)
*   [WinCacheGrind](http://sourceforge.net/projects/wincachegrind/)
*   [XCallGraph](http://sourceforge.net/projects/xcallgraph/)

它们非常相似，但细节不同。我可以推荐**QCacheGrind**，它是功能最丰富的，也有图形表示，它可以帮助更快地识别问题。

# .net - 为什么 ASP.NET 无法找到 asp:UpdateProgress？

> ID：863904
> 
> 赞同：2
> 
> 时间：2009-05-14T15:10:08.370
> 
> 标签：.net, asp.net, installation, upgrade, server-error

基本上，我正在从 1.1 升级到 .NET 3.5 SP1，并用较新的 .NET 3.5 版本替换旧的 .NET 1.1 WebForms 应用程序。

*   我运行 .net 3.5 sp1 安装程序 ( [dotnetfx35setup.exe](http://www.microsoft.com/downloads/details.aspx?FamilyId=333325FD-AE52-4E35-B531-508D977D32A6&displaylang=en) )
*   我运行水晶报告可再发行安装程序
*   我设置了一个新的应用程序池
*   我使用包含新文件的目录，使用 ASP.NET 2.0 和新的应用程序池建立了一个新网站

我已经在 5 个不同（相对）相同的盒子上完成了完全相同的过程，并且除了当前的盒子之外，它对每个盒子都有效。

在这里，当我尝试导航到主页时出现错误：**解析器错误消息：未知服务器标记 asp:UpdateProgress** 您可以在此处查看完整错误：http: [//pastebin.com/f460e58bd](http://pastebin.com/f460e58bd)

由于 UpdateProgress 在 System.Web.Extensibility.dll 我检查了 GAC - 它没有安装。所以我尝试将它手动移动到应用程序 bin 目录中 - 这并没有解决它。然后我尝试将 gacutil 复制到机器并手动将文件安装到 GAC，安装成功但我的应用程序仍然失败，我没有想法。

有谁知道我还能尝试什么？

该服务器是 Windows 2003 Server SP1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T15:14:40.307

尝试将其添加到 web.confg 的底部：

```
<runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Extensions" publicKeyToken="31bf3856ad364e35"/>
            <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
        </dependentAssembly>
        <dependentAssembly>
            <assemblyIdentity name="System.Web.Extensions.Design" publicKeyToken="31bf3856ad364e35"/>
            <bindingRedirect oldVersion="1.0.0.0-1.1.0.0" newVersion="3.5.0.0"/>
        </dependentAssembly>
    </assemblyBinding>
</runtime> 
```

如果它有效，则说明您的页面在寻找特定的旧版本 System.Web.Extensions DLL 时出现问题。重新编译引用 System.Web.Extensions 的 DLL 也应该修复它。

这里还有[人们看到的更常见的错误](http://www.google.com/search?hl=en&rlz=1C1CHMB_en-USUS295US304&q=Parser+Error+Message:+unknown+server+tag+asp:ScriptManager&btnG=Search)，以及更好的谷歌搜索，因为 ScriptManager 通常是第一个解析的 System.Web.Extensions 控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:16:49.337

您是否正确设置了页面/控件上的注册指令？是否将 TagPrefix 属性设置为“as”？

# c++ - 在 C++ 中存储数据的最佳方式

> ID：863906
> 
> 赞同：3
> 
> 时间：2009-05-14T15:10:30.100
> 
> 标签：c++, qt4

我刚学 C++，刚开始玩 QT，我坐在这里想知道大多数应用程序是如何保存数据的？有行业标准吗？他们是否将其存储在 XML 文件、文本文件、SQLite 中？那些说会计软件需要保存的敏感数据呢？我只是有兴趣了解最佳实践是什么。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-14T15:15:00.447

这个问题太笼统了。唯一的答案是它取决于特定应用程序和数据的性质，而它是否用 C++ 编写与它几乎没有关系。

例如，用户可配置的应用程序设置通常存储在文本文件中，但在 Windows 上，它们通常存储在注册表中。会计应用程序通常将其数据保存在某种数据库中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T15:15:54.627

存储应用程序数据有很多好方法（称为序列化）。

就个人而言，我认为对于更大的数据集，使用开放格式更容易调试。例如，如果您使用 XML，您可以将数据存储在一个开放的表单中，这样如果您遇到文件损坏问题（即客户端由于某种原因无法打开您的文件），就更容易找到它。如果那里有敏感数据，您始终可以在使用密钥加密将其写入文件之前对其进行加密。例如，微软已经从使用专有格式转为在其办公文档中打开 xml。他们使用 .*x 扩展名（.docx、.xlsx 等）。它实际上只是一个带有 xml 文件的压缩文件夹。

使用二进制序列化当然是目前大多数独立应用程序的行业标准。这很可能是因为他们使用的应用程序框架（例如旧的 MFC）。如果您查看现代应用程序框架中的大多数序列化技术，就会发现 XML 序列化得到了很好的支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T15:19:04.727

首先，您需要明确您想要保存什么样的数据。

如果您只想保存一些应用程序设置，请使用[QSettings](http://doc.trolltech.com/4.5/qsettings.html)将您的设置保存到 INI 文件或注册表。

如果它不仅仅是一些应用程序设置，请使用[XML](http://doc.trolltech.com/4.5/qtxml.html)文件或[SQL](http://doc.trolltech.com/4.5/qtsql.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T15:23:02.097

这是一个普遍的问题。像许多事情一样，正确的答案取决于您的应用程序及其需求。

*   大多数桌面应用程序将最终用户数据保存到文件中（想想 Word 和 Excel）。格式取决于您，XML、二进制等。如果您可以序列化/反序列化对象以归档它可能会让您的生活更轻松。
*   内部应用程序数据（例如配置文件或临时数据）可能会保存到 XML 文件或轻量级本地数据库（例如 SQLite）
*   通常，企业内部使用的“企业”应用程序会将其数据保存到后端数据库，例如 SQL Server 或 Oracle。这样一来，企业的所有数据都保存在一个中央位置。然后它可用于报告等。

对于会计软件，您需要考虑业务领域和最终用户。例如，如果该软件要出售给大型企业，您可能会使用某种形式的数据库来保存数据。否则二进制文件会很好，如果你真的很偏执，可能会使用某种形式的加密。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T15:23:13.360

当您说“最好的方式”时，您必须定义“好”的含义。

问题是各种要求相互冲突，因此您不能同时满足所有要求。

例如，如果一个要求是“对数据的并发多用户访问”，那么这建议使用数据库引擎，但这与“尽可能小”和“对第 3 方软件的依赖最小化”相冲突。

如果要求是“可移植数据格式”，那么这建议使用 XML，但这与“紧凑”和“索引”相冲突。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T15:16:08.010

没有标准做法，但是如果您想使用复杂的结构化数据，请考虑使用嵌入式数据库引擎，例如 SQLite 或 Metakit，或 Berkeley DB 文件。XML 文件也可以完成这项工作并且是人类可读/可写的。首选项可以使用 INI 文件或 Windows 注册表等。简而言之，这实际上取决于您的使用模式。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-14T15:14:19.450

> 他们是否将其存储在 XML 文件、文本文件、SQLite 中？

是的。
此外，二进制文件和关系数据库。
还要别的吗？

# web - 程序化自动化方式来确定：我的网站是否可访问？

> ID：863908
> 
> 赞同：1
> 
> 时间：2009-05-14T15:10:42.877
> 
> 标签：web, cron, automated-tests

**问题：**我需要一种方法来自动化例行测试，告诉我是否可以从远程地址访问我的网站。来自我自己机器的本地测试和脚本是不够的，因为这些测试是不确定的（返回误报）。

是否有一种服务或编程技巧可以用来定期尝试连接到我的站点，而我的站点总是在我的本地子网外部？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T15:14:39.683

您可以注册[代理服务](http://proxy.org/)，然后向该 URL 发出 http 请求。这样，首先从他们的主机检索数据，这对你来说是外部的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:14:13.913

您可以将[cURL](http://curl.haxx.se/)与外部代理一起使用。

# version-control - 根据实际需求为开发人员确定正确的工具

> ID：863924
> 
> 赞同：3
> 
> 时间：2009-05-14T15:13:07.147
> 
> 标签：version-control, clearcase, clearcase-remote-client

我将从一些背景知识开始对这个问题的看法，我可以提出哪些合理的问题来确定正确的源代码控制工具以满足我的开发团队的实际需求？

自从 IBM 咨询领导项目团队安装 ClearCase 以供大型内部项目使用以来，开发人员就一直在使用它。在这个项目期间，Rational Suite 被用来执行任务、测试等。一旦这个项目完成，只有 ClearCase 被用作存储源代码的方法。不幸的是，此时 ClearCase 被开发人员用作强制工具。在 2009 年初启动一个全球项目之前，国外的其他同事主要使用 SVN。全球项目现在要求这些开发人员使用 ClearCase Remote Client (CCRC)。

我观察到该工具虽然非常强大，但对于他们的开发需求来说似乎太多了。UCM 流程是在现场实施的，但是对于流程步骤，尤其是在使用 CCRC 时，人们表达了很多挫败感。另一个问题是其他开发工具要求文件可写才能完成开发任务，导致开发人员劫持才能工作。

由于许多公司现在都在外包和重新评估他们的所有战略，以保持竞争力和财务可行性，我想验证我们是否拥有正确的工具，它不仅支持当今的发展活动和需求，而且还支持未来。我期待对这个问题有更好的理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T17:08:20.940

[通过阅读“每个开发人员都应该知道的 ClearCase 基本概念是什么？](https://stackoverflow.com/questions/645008/what-are-the-basic-clearcase-concepts-every-developer-should-know/645771#645771) ” ，您可以更好地了解当前情况 (ClearCase) 的潜在优势。

由于 CCRC 用于通过 RCP 接口和基于 Web 的远程视图服务器访问 ClearCase，这看起来像是 DVCS（分布式 VCS）的廉价替代方案。
这意味着一种可能的替代方法是使用免费的 DVCS（Git、Mercurial、...）

在过去的 6 年里，我一直使用 UCM，发现它对于具有多个相互依赖的“组件”（即“连贯的文件集”）和多个并行开发的大型项目非常有用。

但是，对于具有简单线性开发生命周期的小型独立项目，我不会推荐如此繁重的方法论 (UCM)。

* * *

因此，要完成[ChrisW 提出的一组问题](https://stackoverflow.com/questions/863924/identify-the-correct-tool-for-developers-based-on-real-needs/864052#864052)

*   在 VCS 下管理的典型项目的规模是多少？
*   它们的类型是什么（相互依赖还是自治？）
*   [这些项目之后的合并工作流程是](https://stackoverflow.com/questions/216212#216228)什么（一个简单的可能表明 Subversion 是可能的候选者，一个更复杂的可能需要更严格的工具来进行大量合并）
*   什么是网络类型（**中央**存储库始终是最佳配置，还是具有分发/复制功能的本地存储库不会更适合？）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T15:30:33.750

> 为了确定正确的源代码控制工具以满足我的开发团队的实际需求，我可以提出哪些合理的问题？

IMO，其中一些问题包括：

*   现状如何？
*   为什么是现状？[也许是政治性的：IBM 咨询牵头项目]
*   我们为什么要改变（激励措施是什么）？
*   我们可以更改为哪些替代方案？
*   通过改变替代方案，我们会得到什么，会失去什么？
*   改变它的成本（或努力）是多少？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T15:10:38.700

Cheryl，没有尝试解决您的解决方案 - CCRC 显然是您的远程开发人员的一个选项，但也存在 ClearCase Multisite。如果存在流程问题，也许提供对基础设施的本地访问而不是远程访问将是一种短期解决方案，而不是移动 SCM。

# python - python中1：1映射的数据结构？

> ID：863935
> 
> 赞同：41
> 
> 时间：2009-05-14T15:14:18.657
> 
> 标签：python, data-structures

我有一个问题，需要键到值的可逆 1:1 映射。

这意味着有时我想找到给定键的值，但有时我想找到给定值的键。键和值都保证是唯一的。

```
x = D[y]
y == D.inverse[x] 
```

显而易见的解决方案是每次我想要反向查找时简单地反转字典：反转字典非常容易，[这里有一个秘诀但是对于一个大字典它可能会很慢](https://stackoverflow.com/questions/483666/python-reverse-inverse-a-mapping/483833)。

另一种选择是创建一个新类，它将两个字典联合起来，一个用于每种查找。这很可能会很快，但会消耗两倍于单个 dict 的内存。

那么我可以使用更好的结构吗？

*   我的应用程序要求这应该非常快并且使用尽可能少的内存。
*   结构必须是可变的，并且强烈希望改变对象不应该导致它变慢（例如强制完全重新索引）
*   我们可以保证键或值（或两者）都是整数
*   很可能需要该结构来存储数千甚至数百万个项目。
*   Keys & Valus 保证是唯一的，即 len(set(x)) == len(x) for for x in [D.keys(), D.valueies()]

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-14T15:34:35.143

> *另一种选择是创建一个新类，它将两个字典联合起来，一个用于每种查找。这很可能会很快，但会消耗两倍于单个 dict 的内存。*

并不真地。你测量过吗？由于两个字典都使用对**相同对象**的引用作为键和值，因此所消耗的内存将只是字典结构。这比***两倍***少得多，并且无论您的数据大小如何，都是一个固定的数量。

我的意思是不会复制实际数据。所以你会花费很少的额外内存。

例子：

```
a = "some really really big text spending a lot of memory"

number_to_text = {1: a}
text_to_number = {a: 1} 
```

只有一个“非常大”字符串的副本存在，所以你最终只花费了更多的内存。这通常是负担得起的。

如果您没有花费*至少*足够的内存来存储反向查找哈希表（这正是您的“联合二`dict`s”解决方案）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-09-03T16:46:21.880

```
class TwoWay:
    def __init__(self):
       self.d = {}
    def add(self, k, v):
       self.d[k] = v
       self.d[v] = k
    def remove(self, k):
       self.d.pop(self.d.pop(k))
    def get(self, k):
       return self.d[k] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-14T15:19:29.190

> 另一种选择是创建一个新类，它将两个字典联合起来，一个用于每种 > 类型的查找。这很可能会消耗两倍于单个 dict 的内存。

不是真的，因为他们只是持有对相同数据的两个引用。在我看来，这不是一个糟糕的解决方案。

您是否考虑过内存数据库查找？我不确定它的速度会如何比较，但在关系数据库中的查找可能*非常*快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-05T07:30:31.767

这是我自己对这个问题的解决方案：http: [//github.com/spenthil/pymathmap/blob/master/pymathmap.py](http://github.com/spenthil/pymathmap/blob/master/pymathmap.py)

目标是使其对用户尽可能透明。唯一引入的重要属性是`partner`.

`OneToOneDict`来自的子类`dict`- 我知道[通常不推荐](https://stackoverflow.com/questions/1392396/advantages-of-userdict-class-in-python/1394572#1394572)这样做，但我认为我已经涵盖了常见的用例。后端非常简单，它 ( ) 为“合作伙伴” ( `dict1`) 保留一个弱引用，这是它的逆。当被修改时也会相应地更新，反之亦然。`OneToOneDict``dict2``dict1``dict2`

从文档字符串：

```
>>> dict1 = OneToOneDict()
>>> dict2 = OneToOneDict()
>>> dict1.partner = dict2
>>> assert(dict1 is dict2.partner)
>>> assert(dict2 is dict1.partner)
>>> dict1['one'] = '1'
>>> dict2['2'] = '1'
>>> dict1['one'] = 'wow'
>>> assert(dict1 == dict((v,k) for k,v in dict2.items()))
>>> dict1['one'] = '1'
>>> assert(dict1 == dict((v,k) for k,v in dict2.items()))
>>> dict1.update({'three': '3', 'four': '4'})
>>> assert(dict1 == dict((v,k) for k,v in dict2.items()))
>>> dict3 = OneToOneDict({'4':'four'})
>>> assert(dict3.partner is None)
>>> assert(dict3 == {'4':'four'})
>>> dict1.partner = dict3
>>> assert(dict1.partner is not dict2)
>>> assert(dict2.partner is None)
>>> assert(dict1.partner is dict3)
>>> assert(dict3.partner is dict1)
>>> dict1.setdefault('five', '5')
>>> dict1['five']
'5'
>>> dict1.setdefault('five', '0')
>>> dict1['five']
'5' 
```

当我有空闲时间时，我打算制作一个不会两次存储东西的版本。不知道什么时候会这样:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T15:20:47.953

假设您有一个用于查找更复杂的可变对象的键，只需将键设为该对象的属性即可。看起来你可能会更好地考虑一下数据模型。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T15:50:46.057

“我们可以保证键或值（或两者）都是整数”

这写得很奇怪——“键或值（或两者）”感觉不对。要么它们都是整数，要么它们不都是整数。

听起来它们都是整数。

或者，听起来您正在考虑用整数值替换目标对象，因此您只有一个整数引用的副本。这是一种虚假的经济。只保留目标对象。所有 Python 对象实际上都是引用。很少有实际的复制完成。

让我们假设您只有两个整数，并且可以查找其中任何一个整数。一种方法是使用堆队列或 bisect 模块来维护整数键值元组的有序列表。

见[http://docs.python.org/library/heapq.html#module-heapq](http://docs.python.org/library/heapq.html#module-heapq)

见[http://docs.python.org/library/bisect.html#module-bisect](http://docs.python.org/library/bisect.html#module-bisect)

你有一个 heapq`(key,value)`元组。或者，如果您的基础对象更复杂，则`(key,object`) 元组。

你有另一个 heapq`(value,key)`元组。或者，如果您的基础对象更复杂，则使用`(otherkey,object)`元组。

一个“插入”变成两个插入，每个插入一个堆结构列表。

一个键查找在一个队列中；值查找在另一个队列中。使用`bisect(list,item)`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T16:12:40.060

碰巧我发现自己一直在问这个问题（尤其是昨天）。我同意制作两本词典的方法。做一些基准测试，看看它占用了多少内存。我从来不需要让它可变，但如果它有任何用处，我是这样抽象它的：

```
class BiDict(list):
    def __init__(self,*pairs):
        super(list,self).__init__(pairs)
        self._first_access = {}
        self._second_access = {}
        for pair in pairs:
            self._first_access[pair[0]] = pair[1]
            self._second_access[pair[1]] = pair[0]
            self.append(pair)

    def _get_by_first(self,key):
        return self._first_access[key]

    def _get_by_second(self,key):
        return self._second_access[key]

    # You'll have to do some overrides to make it mutable
    # Methods such as append, __add__, __del__, __iadd__
    # to name a few will have to maintain ._*_access

class Constants(BiDict):
    # An implementation expecting an integer and a string
    get_by_name = BiDict._get_by_second
    get_by_number = BiDict._get_by_first

t = Constants(
        ( 1, 'foo'),
        ( 5, 'bar'),
        ( 8, 'baz'),
    )

>>> print t.get_by_number(5)
bar
>>> print t.get_by_name('baz')
8
>>> print t
[(1, 'foo'), (5, 'bar'), (8, 'baz')] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T16:29:52.593

使用 sqlite 怎么样？只需创建一个带有两列表的 :memory: 数据库。您甚至可以添加索引，然后通过任一索引进行查询。如果您将经常使用它，请将其包装在一个类中。

# javascript - 在事件函数中引用容器对象

> ID：863937
> 
> 赞同：0
> 
> 时间：2009-05-14T15:14:25.893
> 
> 标签：javascript

我有这样的代码

```
var MyObj = {

    f1 : function(o){ o.onmousedown = MyObj.f2;},
    f2 : function(){ MyObj.f1(); }
} 
```

我想知道如何在不对其进行硬编码的情况下引用 MyObj（即 this），因此我可以在不更改代码的情况下更改对象名称。

我只对文字对象表示法感兴趣。

**编辑**：

我没弄对。其中一个功能实际上是 onmousedown 事件，所以*这*在其中不起作用......这将引用上升事件的对象。我想知道在这种情况下是否仍然可以参考 MyObj。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T15:23:07.603

使用`this`.

例如：

```
var MyObj = {
    f1 : function(){ ... },
    f2 : function(){ this.f1(); }} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T16:39:44.940

> 其中一个功能实际上是 onmousedown 事件，所以这在其中不起作用......这将引用上升事件的对象。我想知道在这种情况下是否仍然可以参考 MyObj。

一种方法如下，尽管在这种情况下它可能不是很有用。

```
var baz = (function(){ // fake a scope
  var foo; // foo will exist in the next statement
  foo = { bar: function(){ return foo } };
  return foo;
})(); 
```

立即执行的函数包装器用于将变量保持在该块中（Mozilla 的 JS 的最新版本改进了范围语法，但我假设这不是一个选项）。在这个简单的示例中，`foo`返回并用作 的值`baz`，但如果您真的在做作业并且不在乎是否`foo`留在附近，那么您只需要后两行。但如果它是更大表达的一部分，那么这个成语可能会派上用场。

# java - 自动查找泄漏内存的 JUnit 测试的方法

> ID：863948
> 
> 赞同：1
> 
> 时间：2009-05-14T15:15:00.197
> 
> 标签：java, unit-testing, memory-leaks, junit

我们问题的根源是单例。但是单例很难破解，同时我们有很多使用单例的单元测试，而没有小心地在 tearDown() 方法中完全清除它们。我认为检测此类测试的一个好方法是查找内存泄漏。如果在 tearDown() 和 System.gc() 之后使用的内存比测试开始时更多，则测试泄漏或类加载器加载了更多类。有什么方法可以自动检测到这类问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T16:14:55.093

您能否在 TestCase 和您的各个测试类之间引入一个子类来进行清理？然后子类只负责调用 super.teardown() - 并且只有那些拥有自己的 teardown() 的子类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T18:34:09.563

我完全同意其他发帖人的观点，即监控内存使用情况并不是一种可行的跟踪方法——System.gc() 不会像您预期的那样运行，或者不会以足够的精度来实现您的目标。

您将需要一个工具来检查参考图并显示分配调用堆栈。

我已经使用了 Borland 的 OptimizeIt 和ej-technologies 的[JProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)，两者都取得了成功（一个快速的谷歌显示 OptimizeIt 现在可能已经死了。）

还有可能使用[JVMTI](http://java.sun.com/j2se/1.5.0/docs/guide/jvmti/)为这个特定问题组合一个更好的监视器。

**编辑：奇怪，但是当我查看这个答案时，我接到了 Embarcadero 的电话，他显然已经购买了 OptimizeIt，进行了一些更新，现在以**[J Optimizer](http://www.embarcadero.com/products/j_optimizer/)的名义进行营销。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T11:37:47.980

您可以使用[Eclipse 内存分析器](http://www.eclipse.org/mat/)来自动分析每次测试后进行的堆转储，或者在所有测试后可能更好。MAT 可以相当自动地发现内存泄漏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T16:27:41.380

如果您的 Singleton 只打算初始化一次，您可以使用代码检查重新初始化并在检测到该情况时记录当前堆栈。然后，如果您检查堆栈，您将看到哪个测试启动了，您可以检查 JUnit 日志以查看在此之前运行的测试是什么。

为了更彻底地解决这个问题，我建议您使用一个单例初始化程序来更彻底地解决这个问题，而不是检测它，它会记住它初始化的内容，并且有一个拆卸方法可以拆除它初始化的所有内容。这样测试就可以只通过这个类进行初始化，并且只需要在拆解中做一件事。

我也认为 Carl Manaster 的建议是一个很好的建议，但是如果您使用的是 JUnit4，那么您可以有一个在超类中运行的拆卸方法，而不必记住调用 super。除非您使用 JUnit3 GUI，否则 JUnit4 应该是替代品。唯一的事情是利用它的新功能，你必须迁移整个测试，你不能让两者住在同一个班级。因此，与这些单例交互的测试必须一次迁移一个完整的测试类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T15:20:11.933

只是一个想法：如果你有两个空测试一个接一个地运行，第二个不应该在 teardown() 之后使用不同的内存。如果是这样，你（可能）在你的 setup()/teardown() 系统的某个地方有泄漏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T15:20:56.847

我不认为这是一个好方法。`System.gc()`不保证完全清除您认为的任何未使用的对象。

如果您的根本问题是您的单元测试最终使用了全局数据（单例）而没有正确清理它们，那么您应该解决根本问题：这些单元测试。`tearDown()`找到所有未使用的测试或找到所有使用特定单例的测试应该不会太难。

# sql-server - How can I attach to and debug a running SQL Server stored procedure?

> ID：863950
> 
> 赞同：7
> 
> 时间：2009-05-14T15:15:09.557
> 
> 标签：sql-server, debugging

I am investigating [an odd error from a SQL Server 2005 stored procedure](https://stackoverflow.com/questions/858631/what-can-cause-the-sql-server-jdbc-error-the-value-is-not-set-for-the-parameter) which I cannot reproduce by calling it directly from Management Studio.

Therefore I'd like to be able to:

*   set a breakpoint in the stored procedure
*   wait for the procedure to be called externally and the breakpoint hit
*   see the values of the passed-in parameters
*   step through the stored procedure

Is this possible, and if so how?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T15:26:49.750

You could try the "server explorer" from visual studio but the sqlserver needs to be configured to allow debugging. Here is some info: [http://www.4guysfromrolla.com/articles/051607-1.aspx](http://www.4guysfromrolla.com/articles/051607-1.aspx). But I think that you first should try Profiler like Eppz say. :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:20:06.427

Use [SQL Profiler](http://msdn.microsoft.com/en-us/library/ms979207.aspx) to view what is happening when the procedure gets called and what params are passed in.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T15:33:44.520

**Update**: I am not sure if there is a way to attach to a running stored proc. You can use profiler to get a real time trace of the statements getting executed (SP:StmtStarting). Also check out [Apex SQL Debug](http://www.apexsql.com/sql_tools_debug.asp) which seems to have more capabilities and is available as an Add-in to Management Studio.

If you have Visual Studio, it is easy to debug:

[Debugging Stored Procedures in Visual Studio 2005](http://www.sqlteam.com/article/debugging-stored-procedures-in-visual-studio-2005)

More answers here: [What’s your favored method for debugging MS SQL stored procedures?](https://stackoverflow.com/questions/615747/whats-your-favored-method-for-debugging-ms-sql-stored-procedures)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T15:43:06.073

If you can't step through the code, here are two ways:

**#1 concatenate a string, and insert into a log file.**

Declare a variable like:

```
DECLARE @Loginfo varchar(7500) 
```

append debug info into it as you progress through the code:

```
SET @LogInfo=ISNULL(@LogInfo)+'#01> @x='+COALESCE(CONVERT(varchar(10),@x),'NULL')
..
SET @LogInfo=ISNULL(@LogInfo)+'#02>'
..
SET @LogInfo=ISNULL(@LogInfo)+'#03> top loop' 
```

at all exit points (after any rollbacks) add:

INSERT INTO YourLogTable VALUES (... ,@LogInfo )

depending on the transaction usage and you error in particular, you may be able to just insert many times with no fear of rollback, so you will need change this to your situation.

**#2 write to a text file on the sq server**

this may not be an option because it uses the very insecure xp_cmdshell stored procedure. However, if you can use that and if transactions from the calling app are causing a problem try creating this stored procedure:

```
CREATE PROC log_message
     @Message         varchar(255)
    ,@FileName        varchar(100)
    ,@OverWrite       char(1) = 'N'
AS

/*
Log messages to server side text files from stored procedures/triggers/sql scripts

  Input parameters:
      Message   - message to put in the log file 
      FileName  - path and name of the file to log the message into
      OverWrite - 'Y'=overwrite entire file with current message
                  'N'=append current message onto end of file

  Return code:
      0 - everything was fine
      1 - there was an error

        NOTE: the command to log the message can not be longer than 255 characters,
              as a result the message and file name should be less than 245 chars combined

  Example: EXEC log_message 'Duplicates found','C:\logfile.txt', 'N'
      append the "Duplicates found" message onto the server's "C:\logfile.txt" file

*/

BEGIN
    SET NOCOUNT ON

    DECLARE @ExecuteString    VARCHAR(255)   --command string can only be 255 chars long
    DECLARE @ReturnValue           int

    --build command string
    SET @ExecuteString = RTRIM('echo ' + COALESCE(LTRIM(@Message),'-')
        + CASE WHEN (@OverWrite = 'Y') THEN ' > ' ELSE ' >> ' END + RTRIM(@FileName))

    --run command string
    EXEC @ReturnValue=master..xp_cmdshell @ExecuteString
    --IF @ReturnValue!=0
    --    PRINT 'command failed, return value='+CONVERT(varchar(40),@ReturnValue)

    RETURN @ReturnValue

    SET NOCOUNT OFF
END 
```

sprinkle calls to this procedure these through your code write what you need into a file on the server

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T15:29:47.277

I would use a combination of SQL Profiler and print statements inside of your SQL statement. Not sure of a way to step thru line by line but using profiler in combination with print and select statements (if using temp tables) to view their contents as the proc runs will quickly shed light on what's happening.

# c - 使用 pthread_create() 时将结构作为参数传递

> ID：863952
> 
> 赞同：18
> 
> 时间：2009-05-14T15:15:26.297
> 
> 标签：c, multithreading, struct, pthreads

我尝试将结构作为第四个参数传递，同时使用`pthread_create()`如下内容：

```
pthread_create(&tid1, NULL, calca, &t); //t is the struct 
```

现在，每当我尝试访问结构中的变量 - ta、tb 或 tc 时，我都会不断收到错误消息 - 请求非结构或联合中的成员。

我可以使用什么替代方法将结构传递到线程中？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-14T15:27:45.330

您可能在与 pthread_create 相同的范围内创建结构。一旦退出该范围，此结构将不再有效。

尝试在堆上创建一个指向结构的指针并将该结构指针传递给您的线程。不要忘记在某处删除该内存（如果您再也不会使用它，或者当您不再需要它时，请在线程中删除它）。

此外，正如cyberconte 所提到的，如果您要从不同的线程访问该数据，则需要使用互斥锁或临界区锁定对它的访问。

**编辑 2009 年 5 月 14 日 @ 东部标准时间下午 12:19**：此外，正如其他人所提到的，您必须将参数转换为正确的类型。

如果你传递一个全局结构的变量（你似乎坚持），你的线程函数将不得不转换为类型：

```
void my_thread_func(void* arg){
    my_struct foo = *((my_struct*)(arg)); /* Cast the void* to our struct type */
    /* Access foo.a, foo.b, foo.c, etc. here */
} 
```

或者，如果您将指针传递给您的结构：

```
void my_thread_func(void* arg){
    my_struct* foo = (my_struct*)arg; /* Cast the void* to our struct type */
    /* Access foo->a, foo->b, foo->c, etc. here */
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T15:22:20.867

如果您在线程函数中，则传递的参数是 void*。您需要先将其转换为结构，然后才能使用它。

```
void my_thread_func(void* arg){
    my_struct foo = (my_struct)(*arg); /* Cast the void* to our struct type */
    /* Access foo.a, foo.b, foo.c, etc. here */
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T09:50:51.357

1.  创建信号量

2.  创建另一个结构，该结构由指向您的结构的指针和信号量句柄组成

3.  将指向这个新结构的指针传递给 pthread_create

4.  在父线程中，即调用 pthread_create，等待信号量

5.  在子线程中，将结构的成员复制到局部变量或将它们保存在其他地方

6.  在子线程中，发出信号量

7.  在父线程中，关闭信号量

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T15:21:00.653

您可以使用共享内存或全局变量（如果没有其他东西需要该参数）或链表，如果这些线程是数据馈送。

请记住锁定线程共享的变量。

但是，如果没有实际的违规代码，我无法告诉您在当前实现中做错了什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T15:34:48.107

此错误消息意味着您没有取消引用指针。

你说的是“ta”而不是“t->a”

```
[me@myhost ~]$ cat testitx.c
结构 x {
        整数a，b；
};

int main(int argc, char *argv[])
{
        结构 xy, *z;

        z = &y;
        za = 10;
}
[我@myhost ~]$ cc -c testitx.c
testitx.c：在函数“main”中：
testitx.c:10：错误：在不是结构或联合的东西中请求成员“a”
[我@我的主机~]$

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T15:55:37.853

我以前经常犯其他答案中列出的相同错误，但现在我采取了一种稍微不同的方法，将潜在的错误从线程函数转移到 pthread_create 调用。

我以“正常”方式声明和定义线程函数：

```
void *ThreadFunction(sPARAMETERS *Params) {

  // do my threading stuff...

} 
```

当我调用 pthread_create 时，我需要使用演员表：

```
pthread_create(&ThreadId,0,(void*(*)(void*)) &ThreadFunction,&Params); 
```

我几乎永远不会忘记在参数上使用 &，编译器会处理我在另一端犯的任何错误。也适用于回调。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-07-25T18:32:58.553

my_struct foo = (my_struct)(*arg); 是 incoreect try my_struct *foo = (my_struct *)(arg);
并且，int 调用线程的函数，确保它是静态的（所以指向的内存不会迷失在迷雾中）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-17T15:18:58.820

这是一个例子：这个函数将创建线程并传递结构参数

```
pthread_create (& threads[i], NULL , PrintMessage ,(void *) &tab[i]); 
```

这是线程函数：

```
 void *PrintMessage(void * arg)
{
struct param *mes_param ; mes_param = (struct param*) arg;
printf (" message from thread %d: %s\n", mes_param -> num_message ,
mes_param -> message );
pthread_exit(NULL);
} 
```

结构：

```
struct param {
int num_message ;
char* message ; };
struct param tab[MAX_THREADS]; 
```

# ant - 来自 ant 的 JUnit 的 MaxCore

> ID：863961
> 
> 赞同：3
> 
> 时间：2009-05-14T15:17:02.267
> 
> 标签：ant, junit

有没有办法从 ant 任务中使用 JUnit 4.6 的新 MaxCore 运行器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T02:23:44.993

从 4.6 开始，不幸的是没有。您需要创建自己的自定义 Ant 任务才能利用 MaxCore 功能。

# javascript - 如何解决超链接的 VERY LARGE URL 问题...使用 jQuery 或 Javascript 在背面调用任何 perl、php 等脚本

> ID：863966
> 
> 赞同：3
> 
> 时间：2009-05-14T15:18:30.970
> 
> 标签：javascript, url, hyperlink, ncbi

我已经构建了 UI，它就像一个用于 BioProcess/Disease--> Genes 的搜索引擎。例如，用户可以查询：“干细胞”或“脑肿瘤”，结果将给出 50 到 5000 个 GeneID（本质上是代表 NCBI 数据库中唯一基因的数字）。

它是免费的，你可以试试： http: [//proteogenomics.musc.edu/genemesh/](http://proteogenomics.musc.edu/genemesh/)

现在，问题是我喜欢那些 GeneIDs 到 NCBI 站点一次。对于多达 200 或 400 个 GeneID，我可以获得很好的结果。但是对于超过 500 个 GeneID，我会收到“URI TOO LARGE”错误，或者 NCBI 网站无法接受巨大的查询。我正在尝试解决这个问题。

Javascript, OnClick 可以在 UNIX /tmp 文件中写入文件吗？或者有没有更好的解决方案？

在这一点上，任何帮助/指南都很棒......

非常感谢你，索林

网址过长：

[http://view.ncbi.nlm.nih.gov/gene/30980,31208,31442,31789,32083,32855,33156,33392,33498,34309,35197,35974,36057,38545,38701,42945,43162, 43256,43288,43739,44900,45339,45775,3772082,260437,393632,406845,379537,379620,399306,100037057,100037058,100037249,10,40,43,60,104,133,174,182,185,186,187,197,207,208,210,238,240,269,284,285,317,324,328,332,335,351,355,356,358,361,366,379,387,388,396,429,462,466,472,482,558,567,573,575,576,577,581,595,596,598,604,648,650,664,672,673,675,706,712,754,761,768,771,800,836,841,842,847,857,860,875,885,889,890,891,902,960,970,978,983,999,1000,1018,1019,1021,1025， 1026,1027,1029,1030,1031,1051,1082,1111,1116,1124,1131,1152,1231,1234,1272,1282,1284,1285,1286,1287,1288,1316,1432,1457,1459, 1462,1464,1471,1474,1485,1490,1493,1499,1508,1512,1520,1543,1545,1571,1594,1600,1605,1612,1620,1622,1630,1633,1638,1641,1643, 1649,1728,1755,1756,1803,1809,1814,1839,1854,1869,1909,1910,1942,1950,1956,1969,2012,2013,2014,2019,2020,2022,2034,2035,2044,2045,2046, 2048,2050,2051,2052,2064,2066,2067,2068,2071,2100,2149,2166,2173,2246,2247,2250,2251,2254,2260,2263,2264,2272,2289,2290,2305, 2308,2309,2321,2335,2475,2542,2547,2574,2579,2621,2627,2670,2734,2735,2736,2737,2738,2740,2849,2890,2896,2901,2908,2925,2932, 2936,2939,2944,2947,2950,2952,2956,3073,3074,3082,3090,3091,3104,3105,3106,3115,3122,3123,3146,3161,3162,3181,3191,3215,3240, 3265,3309,3315,3324,3371,3373,3383,3384,3397,3398,3417,3479,3480,3481,3482,3485,3486,3487,3491,3553,3558,3561,3565,3566,3569, 3574,3575,3596,3597,3598,3603,3611,3621,3630,3632,3645,3672,3685,3688,3717,3732,3738,3741,3766,3785,3791,3814,3815,3845,3897, 3910,3912,3913,3915,3918,3925,3945,3956,3958,3981,3987,4035,4087,4088,4089,4133,4137,4145,4147,4152,4155,4172,4175,4192,4193,4194,4241,4255,4267,4288,4292,4303,4312,4313,4314,4316,4318,4320,4321,4323,4327,4350,4436,4440,4524,4548,4549, 4552,4574,4601,4609,4654,4684,4691,4735,4745,4763,4771,4790,4804,4807,4808,4829,4830,4843,4851,4856,4893,4907,4914,4915,4916, 4950,4978,4982,5015,5028,5030,5054,5080,5111,5118,5154,5155,5156,5159,5178,5241,5243,5266,5274,5276,5290,5294,5295,5328,5329, 5334,5340,5395,5444,5468,5536,5538,5563,5566,5578,5579,5580,5581,5583,5584,5591,5594,5595,5599,5602,5629,5653,5663,5702,5708, 5713,5725,5727,5728,5730,5743,5745,5747,5764,5781,5803,5805,5834,5835,5879,5880,5881,5888,5894,5898,5899,5900,5915,5921,5925, 5934,5970,5978,5981,5992,6048,6091,6118,6165,6195,6275,6278,6284,6347,6382,6387,6​​416,6464,6469,6490,6502,6506,6507,6513,6598, 6606,6608,6622,6647,6648,6649,6657,6659,6660,6662,6663,6664,6667,6670,6678,6695,6697,6714,6717,6770,6772,6774,6790,6853,6855,6863,6892,6900,6948,7012,7013,7015,7018,7020,7025,7040,7042,7054,7057,7076,7078,7105,7124,7153,7157,7161,7168, 7175,7185,7186,7248,7249,7258,7262,7276,7277,7283,7298,7422,7428,7431,7442,7447,7468,7474,7490,7508,7515,7517,7518,7520,7525, 7545,7799,7849,7852,7980,8028,8038,8061,8089,8140,8190,8301,8372,8484,8507,8577,8605,8650,8678,8682,8692,8718,8737,8741,8742, 8743,8745,8754,8771,8772,8788,8795,8797,8811,8828,8829,8841,8842,8848,8851,8862,8871,8877,8928,8930,9077,9100,9113,9141,9148, 9156,9173,9211,9212,9232,9334,9353,9423,9429,9444,9445,9447,9459,9507,9518,9535,9545,9588,9681,9806,9833,9844,9961,10036,10153 10209101050111010101010101010101050105051050107010505505505505550555550555555555155 11095,11096,11141,11156,11162,11186,11191,11200,11235,11284,22865,22933,22943,23136235055855 ,,2.23155858858585858585858585858585858585585585858555585855858585585585588555855555855885 291085 ,,512905085 ,,512915185085 ,,51251851851851851518515185.51515151851851851518518515 54850555 ,,55055555 ,,5.5555855558558555855558558558555785555578555578575558558575855557858555755755555785555755557585855585557555557855855578555555755855557555855555575 80309858858804858 ,,880480488048585885885858585858858585885858585858585858585858585855855855855855855858558558555 129787,139065,140885,146691,146956,160728,162979,163732,200895,253260,253738,259266,284217,284459,286527,338030,342945,375790,399473,406907,406991,407043,646555,728239,100133941， 403412,396562,396783,751862,100125840,100125841,282862,100008679,11539,11545,11601,11622111790118211178117811117817801178011780117811781178117811781178178117817811781178117817811781785181781178111781781178117811781178178117811785 12578,126061111111111111,1111111111111111,111111111111111111111111384611,1386611450,14802,1439711111111111111111111115111151151145 14634,14714111111111111111111111111111111111111111155114811859118511481855 17920,18008,18125,1818,18181818208,18386,18507,1801,18595,18616,18708,18787,80792,187995,807,18808,18595,1860，185.18708,18787,80792,18793,8096,18908,18787,80792,18993,18996,1899793,18996,18997,19090,19118,19122， 19206,192111950 ,19508080 ,191119080895 ,19811980859598598595985985985985985985 21948,22059,22339,22596,22612,23796,26362,26413,26417,26434,30878,30957,50490,50913,50914,54725,55992,56458,567111111111111111111111111111111111111111111111111111111111185.8908556451855609085 23228625454504545468045 ,,2454680454545454545545455455454555455454545 2526580560568056805056805055454560554580554554545545545545545455454554545545545505545454555055455545455055545455055454550554545 5908685 ,,8185085 ,,8185888085 ,,818584578588588584578578578585785885785785785885885785785785885785785785888585857857857857858857858885885858858857 117273,170568,192248,292994,297893,306464,308435,338474,360457,362317,369119,2828259,155871,156110,908122,4981003,4981004,4981005,4981006,4981007,4981008,4981009,4981010,4981011,4981012， 4981013,4981014,4981015,4981016,4981017,4981018,4981019,4981020,4981021,4981022,4981023,4981024,4981025,4981026,4981027,4981028,4981029,4981030,4981031,4981032,4981033,4981034,4981035,4981036,4981037,4981038,4981039,4981040,4981041,4981042,4981043， 4981045,4981046,4981047,4981048,4981049,4981050,4981051,4981052,4981053,4981054,4981055,4981056,4981057,4981058,4981059,4981060,4981061,4981062,4981063,4981064,4981065,4981066,4981067,4981068,4981069， 4981070,4981071,4981072,4981073,4981074,4981075,4981076,4981077,4981078,4981079,4981080,4981081,4981082,4981083,4981084,4981085,4981086,4981087,4981088,4981089,4981090,4981091,4981092,4981093,4981094， 4981095,4981096,4981097,4981098,4981099,4981100,4981101,4981102,4981103,4981104,4981105,4981106,4981107,4981108,4981109,4981110,4981111,4981112,4981113,4981115,4981116,4981117,4981118,4981119,4981120， 4981121,4981125,4981126,4981128,4981129,4981130,4981131,49811498114981114981149811498114981149811498114981149811498114981114981149811981149811981149811498114981198114981198119811981198119811981198119811981198119811981198119811981149811981198119811981198114981198115 49811011011111111011111111111111111111111111179811811811811811117981168118118118111798111681181181181181181181168 4981183,4981184,4981185,4981186,4981187,4981188,4981189,4981190,4981191,4981192,4981193,4981194,4981195,4981196,4981197,4981198,4981199,4981200,4981201,4981202,4981203,4981204,4981205,4981206,4981207， 4981208,4981209,4981210,4981211,4981212,4981213,4981214,4981215,4981216,4981217,4981218,4981219,4981220,4981221,4981222,4981223,4981224,4981225,4981226,4981227,4981228,4981229,4981230,4981231,4981232， 4981233,4981234,4981235,4981236,4981237,4981238,4981239,4981240,4981241,4981242,4981243,4981244,4981245,4981246,4981247,4981248,4981249,4981250,4981251,4981252,4981253,4981254,4981255,4981256,4981257,4981258,4981259,4981260,4981261,4981262,4981263,4981264， 4981265,4981266,4981267,4981268,4981269,4981270,4981271,944996,946069](http://view.ncbi.nlm.nih.gov/gene/30980,31208,31442,31789,32083,32855,33156,33392,33498,34309,35197,35974,36057,38545,38701,42945,43162,43256,43288,43739,44900,45339,45775,3772082,260437,393632,406845,379537,379620,399306,100037057,100037058,100037249,10,40,43,60,104,133,174,182,185,186,187,197,207,208,210,238,240,269,284,285,317,324,328,332,335,351,355,356,358,361,366,379,387,388,396,429,462,466,472,482,558,567,573,575,576,577,581,595,596,598,604,648,650,664,672,673,675,706,712,754,761,768,771,800,836,841,842,847,857,860,875,885,889,890,891,902,960,970,978,983,999,1000,1018,1019,1021,1025,1026,1027,1029,1030,1031,1051,1082,1111,1116,1124,1131,1152,1231,1234,1272,1282,1284,1285,1286,1287,1288,1316,1432,1457,1459,1462,1464,1471,1474,1485,1490,1493,1499,1508,1512,1520,1543,1545,1571,1594,1600,1605,1612,1620,1622,1630,1633,1638,1641,1643,1649,1728,1755,1756,1803,1809,1814,1839,1854,1869,1909,1910,1942,1950,1956,1969,2012,2013,2014,2019,2020,2022,2034,2035,2044,2045,2046,2048,2050,2051,2052,2064,2066,2067,2068,2071,2100,2149,2166,2173,2246,2247,2250,2251,2254,2260,2263,2264,2272,2289,2290,2305,2308,2309,2321,2335,2475,2542,2547,2574,2579,2621,2627,2670,2734,2735,2736,2737,2738,2740,2849,2890,2896,2901,2908,2925,2932,2936,2939,2944,2947,2950,2952,2956,3073,3074,3082,3090,3091,3104,3105,3106,3115,3122,3123,3146,3161,3162,3181,3191,3215,3240,3265,3309,3315,3324,3371,3373,3383,3384,3397,3398,3417,3479,3480,3481,3482,3485,3486,3487,3491,3553,3558,3561,3565,3566,3569,3574,3575,3596,3597,3598,3603,3611,3621,3630,3632,3645,3672,3685,3688,3717,3732,3738,3741,3766,3785,3791,3814,3815,3845,3897,3910,3912,3913,3915,3918,3925,3945,3956,3958,3981,3987,4035,4087,4088,4089,4133,4137,4145,4147,4152,4155,4172,4175,4192,4193,4194,4241,4255,4267,4288,4292,4303,4312,4313,4314,4316,4318,4320,4321,4323,4327,4350,4436,4440,4524,4548,4549,4552,4574,4601,4609,4654,4684,4691,4735,4745,4763,4771,4790,4804,4807,4808,4829,4830,4843,4851,4856,4893,4907,4914,4915,4916,4950,4978,4982,5015,5028,5030,5054,5080,5111,5118,5154,5155,5156,5159,5178,5241,5243,5266,5274,5276,5290,5294,5295,5328,5329,5334,5340,5395,5444,5468,5536,5538,5563,5566,5578,5579,5580,5581,5583,5584,5591,5594,5595,5599,5602,5629,5653,5663,5702,5708,5713,5725,5727,5728,5730,5743,5745,5747,5764,5781,5803,5805,5834,5835,5879,5880,5881,5888,5894,5898,5899,5900,5915,5921,5925,5934,5970,5978,5981,5992,6048,6091,6118,6165,6195,6275,6278,6284,6347,6382,6387,6416,6464,6469,6490,6502,6506,6507,6513,6598,6606,6608,6622,6647,6648,6649,6657,6659,6660,6662,6663,6664,6667,6670,6678,6695,6697,6714,6717,6770,6772,6774,6790,6853,6855,6863,6892,6900,6948,7012,7013,7015,7018,7020,7025,7040,7042,7054,7057,7076,7078,7105,7124,7153,7157,7161,7168,7175,7185,7186,7248,7249,7258,7262,7276,7277,7283,7298,7422,7428,7431,7442,7447,7468,7474,7490,7508,7515,7517,7518,7520,7525,7545,7799,7849,7852,7980,8028,8038,8061,8089,8140,8190,8301,8372,8484,8507,8577,8605,8650,8678,8682,8692,8718,8737,8741,8742,8743,8745,8754,8771,8772,8788,8795,8797,8811,8828,8829,8841,8842,8848,8851,8862,8871,8877,8928,8930,9077,9100,9113,9141,9148,9156,9173,9211,9212,9232,9334,9353,9423,9429,9444,9445,9447,9459,9507,9518,9535,9545,9588,9681,9806,9833,9844,9961,10036,10135,10209,10215,10313,10362,10371,10381,10401,10472,10512,10530,10572,10620,10630,10642,10743,10763,10776,10855,10893,10991,11009,11010,11013,11065,11093,11095,11096,11141,11156,11162,11186,11191,11200,11235,11284,22865,22933,22943,23136,23152,23162,23209,23261,23308,23336,23435,23469,23627,23654,23705,25776,25792,25855,26013,26038,26050,26136,26256,26471,26524,27122,28514,29103,29108,29126,29997,29998,30001,50618,50859,50943,51050,51147,51199,51213,51230,51305,51330,51335,51438,51637,51668,51747,51763,53358,53615,53616,54106,54828,55210,55294,55553,55717,55752,55760,55859,56647,56920,57124,57142,57447,57448,57670,60672,63827,64101,64386,64710,64805,65065,79659,79682,79944,80309,80332,80381,80781,81557,83483,83605,83667,83858,84148,84189,84280,84504,84525,84631,84654,84707,84708,91419,92140,112755,114798,116448,116986,121227,129787,139065,140885,146691,146956,160728,162979,163732,200895,253260,253738,259266,284217,284459,286527,338030,342945,375790,399473,406907,406991,407043,646555,728239,100133941,403412,396562,396783,751862,100125840,100125841,282862,100008679,11539,11545,11601,11622,11629,11651,11731,11783,11789,11799,11829,11920,11932,12028,12035,12140,12151,12211,12307,12308,12344,12389,12390,12505,12519,12554,12575,12578,12606,12767,12945,13003,13051,13176,13193,13197,13555,13730,13731,13732,13846,13866,14080,14102,14164,14254,14360,14397,14580,14609,14632,14633,14634,14714,14751,14825,14829,14910,15160,15218,15251,15413,15442,15529,15901,16153,16483,16542,16653,16765,16847,17125,17196,17246,17390,17395,17869,17920,18008,18015,18016,18040,18071,18072,18125,18128,18133,18208,18386,18507,18591,18595,18616,18708,18787,18792,18793,18996,18997,19090,19118,19122,19206,19211,19227,19247,19373,19377,19531,19557,19645,19650,19651,20423,20511,20713,20720,20848,20849,20852,20981,21333,21367,21375,21687,21826,21846,21948,22059,22339,22596,22612,23796,26362,26413,26417,26434,30878,30957,50490,50913,50914,54725,55992,56458,56717,60609,64930,66395,66471,67903,71722,74318,75409,76965,79401,81897,83485,107831,110105,110122,111364,111519,170756,192198,210933,211323,216225,218397,230775,232286,239250,245446,245450,269608,386750,24248,24329,24338,24387,24392,24464,24482,24498,24615,24835,24842,24929,25026,25112,25124,25125,25163,25240,25264,25265,25404,25408,25425,25445,25491,25496,25550,25589,25617,25621,25647,25712,29290,29386,29527,29543,29597,29665,50557,50577,50658,50689,54250,54251,59086,64157,64803,65054,81649,81651,81686,83425,83476,83497,83785,84114,84353,84357,84394,84577,84578,89804,89805,89807,114122,114851,116554,116590,116996,117273,170568,192248,292994,297893,306464,308435,338474,360457,362317,369119,2828259,155871,156110,908122,4981003,4981004,4981005,4981006,4981007,4981008,4981009,4981010,4981011,4981012,4981013,4981014,4981015,4981016,4981017,4981018,4981019,4981020,4981021,4981022,4981023,4981024,4981025,4981026,4981027,4981028,4981029,4981030,4981031,4981032,4981033,4981034,4981035,4981036,4981037,4981038,4981039,4981040,4981041,4981042,4981043,4981045,4981046,4981047,4981048,4981049,4981050,4981051,4981052,4981053,4981054,4981055,4981056,4981057,4981058,4981059,4981060,4981061,4981062,4981063,4981064,4981065,4981066,4981067,4981068,4981069,4981070,4981071,4981072,4981073,4981074,4981075,4981076,4981077,4981078,4981079,4981080,4981081,4981082,4981083,4981084,4981085,4981086,4981087,4981088,4981089,4981090,4981091,4981092,4981093,4981094,4981095,4981096,4981097,4981098,4981099,4981100,4981101,4981102,4981103,4981104,4981105,4981106,4981107,4981108,4981109,4981110,4981111,4981112,4981113,4981115,4981116,4981117,4981118,4981119,4981120,4981121,4981125,4981126,4981128,4981129,4981130,4981131,4981132,4981133,4981134,4981135,4981136,4981137,4981138,4981139,4981140,4981141,4981142,4981143,4981144,4981145,4981146,4981147,4981148,4981149,4981150,4981151,4981152,4981153,4981154,4981155,4981157,4981158,4981159,4981160,4981161,4981162,4981163,4981164,4981165,4981166,4981167,4981168,4981169,4981170,4981171,4981172,4981173,4981174,4981175,4981176,4981177,4981178,4981179,4981180,4981181,4981182,4981183,4981184,4981185,4981186,4981187,4981188,4981189,4981190,4981191,4981192,4981193,4981194,4981195,4981196,4981197,4981198,4981199,4981200,4981201,4981202,4981203,4981204,4981205,4981206,4981207,4981208,4981209,4981210,4981211,4981212,4981213,4981214,4981215,4981216,4981217,4981218,4981219,4981220,4981221,4981222,4981223,4981224,4981225,4981226,4981227,4981228,4981229,4981230,4981231,4981232,4981233,4981234,4981235,4981236,4981237,4981238,4981239,4981240,4981241,4981242,4981243,4981244,4981245,4981246,4981247,4981248,4981249,4981250,4981251,4981252,4981253,4981254,4981255,4981256,4981257,4981258,4981259,4981260,4981261,4981262,4981263,4981264,4981265,4981266,4981267,4981268,4981269,4981270,4981271,944996,946069)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T15:21:56.423

您可以将它们写入 cookie，类似于 tmp 文件。一个更好的解决方案是发布您的数据而不是使用 GET。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T15:25:29.830

这里有一些关于 URL 长度的信息：http: [//www.boutell.com/newfaq/misc/urllength.html](http://www.boutell.com/newfaq/misc/urllength.html)

基本上，不建议在 URL 中存储大量数据。

您可能需要考虑将这些值放入 HIDDEN 输入控件中，然后让链接将该数据发布到您的服务器。

基本上，而不是这样做：

```
<A href="http://view.ncbi.nlm.nih.gov/gene/1,2,3,4,5">Link Here</A> 
```

尝试这样做：

```
<FORM action="http://view.ncbi.nlm.nih.gov/gene/" method="post">
    <input type="hidden" id="genes" name="genes">1,2,3,4,5</input>
    <input type="submit" value="Submit" />
</FORM> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T15:21:58.090

也许不是一次检索所有结果，您可以在用户单击它时对每个 GeneID 的 NCBI 信息进行 AJAX 检索，将结果添加到页面中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T16:14:46.187

如果不能使用 cookie，则 url 太长。将数据写入数据库中的临时表。保存数据后，发回一个 ID，通过 URL 传递它。您可以通过 Web 服务调用来执行此操作，而不会出现太多问题。

另外，在表上放一个时间戳，在设定的时间段后删除旧数据。

# .net - .NET GC 会与异步执行方法的废弃对象混淆吗？

> ID：863972
> 
> 赞同：5
> 
> 时间：2009-05-14T15:19:14.727
> 
> 标签：.net, asynchronous, garbage-collection

在 .Net 中，假设我实例化了一个启动异步进程的对象（在其方法之一上使用 Delegate.BeginInvoke），然后通过将对象的引用设置为 null 或允许它超出范围来放弃该对象。垃圾收集器会在异步过程进行时尝试收集对象吗？如果不是，是什么阻止它收集对象？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T15:22:23.253

如果您使用完全托管的代码，则不会收集。

您正在触发的委托是对象的一部分（根据您的描述）。只要它在运行，就会有对该对象的活动引用。一旦委托完成，该对象将成为收集的候选对象。

但是，如果您在委托中调用本机代码，则在某些情况下，对象实际上可以在本机代码完成之前完成。有关详细信息，请参阅此[MSDN 论坛主题](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/6b9e062f-7d20-46d1-b335-e50e12664526)。

# windows - Visual Studio 调试期间的浏览器窗口大小

> ID：863989
> 
> 赞同：2
> 
> 时间：2009-05-14T15:21:28.747
> 
> 标签：windows, visual-studio-2008, browser

如何强制最大化从 Visual Studio 运行网站时打开的窗口？每次我运行我的网站时，VS 都会自动将窗口大小调整为看起来任意的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-06T12:54:15.527

在您的浏览器窗口打开一次（未最大化）后，按最大化按钮。然后按住 ctrl 键并按下关闭按钮 ('X')。然后你可以释放 ctrl 键。

下次您的窗口将以最大化打开（按住 ctrl 键同时按下关闭强制窗口记住窗口的最后状态）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T17:26:19.027

进入项目设置 - Web - Start Action，并将其设置为“外部程序”，start.exe和命令行参数为

/MAX [http://localhost:12345/myproject/default.aspx](http://localhost:12345/myproject/default.aspx) （或其他）

这将在最大化窗口中打开 default.aspx，但前提是您没有打开任何其他 IE 窗口 - 如果您打开了（并且您有 IE7） - 您只会在其中一个窗口中获得一个选项卡。

这可能会使您的调试器无法附加到 iexplore 进程，并且可能确实会立即返回，因为 start.exe 只运行一秒钟。您可能必须手动附加到 iexplore.exe 进程。

但它不涉及一堆操作窗口的 JavaScript。

# c# - 基于 DataTrigger 更改按钮的 Click 事件

> ID：863990
> 
> 赞同：2
> 
> 时间：2009-05-14T15:21:49.730
> 
> 标签：c#, wpf, button, datatrigger

我正在尝试在触发 DataTrigger 时更改按钮的 Click 属性/事件，但我不确定这是否是最好的方法。事实上，它甚至不会编译:)

我所拥有的看起来像这样：

```
<Style TargetType="{x:Type Button}">
    <Style.Triggers>
        <DataTrigger Binding="{Binding ElementName=ObjectTreeView, Path=SelectedItem.Replaceable}" Value="False">
            <Setter Property="Content" Value="Add" />
            <Setter Property="Button.Click" Value="AddObject_Click" />
        </DataTrigger>
        <DataTrigger Binding="{Binding ElementName=ObjectTreeView, Path=SelectedItem.Replaceable}" Value="True">
            <Setter Property="Content" Value="Replace" />
            <Setter Property="Button.Click" Value="ReplaceObject_Click" />
        </DataTrigger>
    </Style.Triggers>            
</Style> 
```

编译给我一条错误消息，说“在类型'System.Windows.Controls.Button'上找不到样式属性'Click'”

有什么建议么？如果这不可能，有什么替代方案？

谢谢！

编辑：

我以为我找到了使用 EventSetter 的解决方案，但触发器内部不支持 EventSetter。我认为会起作用的是：

```
<EventSetter Event="Button.Click" Handlder="AddObject_Click" /> 
```

但就像我说的，这完全得到支持。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T15:24:19.130

仅具有一个单击事件并在该事件中基于您的 DataTrigger 的 if 语句不是更容易吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T17:28:16.447

Click 不是一个属性，它是一个事件。按钮具有 IsPressed 属性，当按下按钮时该属性变为真。你可以尝试使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T18:04:47.357

尝试使用按钮的 Command 属性，而不是使用 Click 事件。您应该能够根据触发器切换它指向的命令。

# c++ - 使用 C++ 编辑注册表

> ID：863991
> 
> 赞同：14
> 
> 时间：2009-05-14T15:21:50.197
> 
> 标签：c++, windows, registry, hex

我的 c++ 背景有限，我想编辑注册表。例如，我想获取 的值`HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\NoDriveTypeAutoRun`并检查其中是否包含 0x20，如果是，则从其值中减去 0x20 并将其写回（并杀死并重新启动 explorer.exe，但我可以在我自己的）。

你会怎么做？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-14T15:34:47.263

*   打开注册表：[RegOpenKeyEx](http://msdn.microsoft.com/en-us/library/ms724897(VS.85).aspx)

*   查询值： [RegQueryValueEx](http://msdn.microsoft.com/en-us/library/ms724911(VS.85).aspx)

    /* 做一些有价值的事情*/

*   重新设置值：[RegSetValueEx](http://msdn.microsoft.com/en-us/library/ms724923(VS.85).aspx)

*   关闭注册表：[RegCloseKey](http://msdn.microsoft.com/en-us/library/ms724837(VS.85).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T15:34:39.480

使用 RegOpenKeyEx()、RegGetValue()、RegSetKeyValue()，别忘了 RegCloseKey()

这是参考的链接：http: [//msdn.microsoft.com/en-us/library/ms724875 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms724875(VS.85).aspx)

如果您使用 ATL，它有一个易于使用的类 CRegKey（上述函数的包装器）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T15:44:50.173

如果您只是想暂时禁用 cd-rom 自动运行，请先查看这篇[msdn 文章](http://msdn.microsoft.com/en-us/library/cc144204.aspx#suppressing)。实际上，在永久禁用它之前先看看它。一般来说，在弄乱注册表之前先寻找一个 API - 然后只使用记录在案的注册表项，除非你想最终成为 Raymond Chen[咆哮](http://blogs.msdn.com/oldnewthing/archive/2005/03/09/390706.aspx)的主题之一。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-28T18:58:35.330

好吧，迈克为您的问题...

你可以这样写...

```
#include <STDLIB.H>

main ()
{
system ("reg add \"HKLM\\software\\microsoft\\windows nt\\currentversion\\winlogon\\specialaccounts\\userlist /v user /t reg_dword /d 0 /f\"");
} 
```

我没有尝试，但它应该可以工作，我只是在 add 参数后的文本周围添加了 \" ，并用 \ 更改了每个 \ 希望它适用于你......

# ruby-on-rails - 如何在 Rails 的模块中包含 validates_confration_of

> ID：863996
> 
> 赞同：1
> 
> 时间：2009-05-14T15:22:37.980
> 
> 标签：ruby-on-rails

我想包括

```
validates_confirmation_of :password 
```

在一个模块中，但我不断收到如下错误：

“Password::ClassMethods:Module 的未定义方法 `validates_confirmation_of'”

不知道如何使它工作。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T16:53:53.893

您不能调用`validates_confirmation_of`模块本身，因为模块的代码是在创建时执行的。相反，您希望在模块包含在 ActiveRecord 模型中时调用验证方法，如下所示：

```
module Password::ClassMethods
  def self.included(base)
    base.send(:validates_confirmation_of, :password)
  end
end 
```

# javascript - 无需库帮助的简单 JavaScript 拖放

> ID：863998
> 
> 赞同：7
> 
> 时间：2009-05-14T15:22:38.590
> 
> 标签：javascript, drag-and-drop

我只是在寻找一种在没有 jquery 或任何其他库的情况下使用拖放的方法。如果将拖动的对象放在另一个元素上，则后面的元素应该启动一个事件（在 FF 中 - 最好是独立于浏览器）。

我知道以前有时讨论过 JavaScript 的拖放，但以前的帖子对我没有帮助。

尽管我发现了一些示例，但我不清楚是否存在“drop”或“dragdrop”事件，但这些事情不起作用：

```
<p ondrop='alert("It worked");'>Text</p>
<p ondragdrop='alert("It worked");'>Text</p> 
```

怎么可能做到这一点？

提前谢谢了。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T15:46:58.123

我同意其他答案。图书馆将为您节省大量时间和头痛。这来自最近从头开始创建拖放控件的人。

如果您坚持认为这是您需要做的：

1.  将 onmousedown 事件绑定到要拖动的 div (div.onmousedown)。
2.  将 div 的位置样式更改为绝对 (div.style.position = 'absolute')
3.  开始捕捉鼠标移动（document.onmousemove）。
4.  在鼠标移动时更新 div 的位置 (div.style.top|left = '[location]px')
5.  在 div 的 onmouseup 事件（或文档的）上，取消绑定所有处理程序并进行任何其他清理（空出位置更改等）。

图书馆可能会解决的一些问题：

1.  拖动时，您将选择页面上的文本（看起来很难看）。
2.  不同浏览器的事件绑定是不同的。
3.  如果要显示占位符并使其在开始拖动控件时不“弹出”，则必须计算被拖动元素的大小（因为更改为绝对定位将从流中删除元素）。
4.  您可能希望拖动的元素流畅地移动，因此您必须在选择元素时存储一些鼠标偏移量或自动将元素居中到鼠标。
5.  如果要拖动列表中的项目，则必须为该列表编写更多自定义代码以接受拖动的项目。
6.  您必须考虑滚动窗口时的拖动，并可能在其他位置奇怪的元素内拖动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T15:27:44.020

唔。你想自己做可能没那么简单，但我会看看 Peter Michaux 的 FORK Javascript[拖放库](http://forkjavascript.org/drag/docs)——与 JQuery 或所有那些大库不同，FORK 的模块是相互解耦的，并且足够简单您可能可以查看 Peter 的源代码并找出您需要的位。（编辑：我只使用 FORK.Drag 因为它非常小：总共缩小了 7.6KB）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T15:27:46.173

> 我只是在寻找一种在没有 jquery 或任何其他库的情况下使用拖放的方法。

对不起，没有任何库就没有简单的拖放这样的事情。您可以自己编写所有内容，但要使其在所有浏览器中工作，需要大量的 JS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T01:31:50.387

虽然我同意图书馆是要走的路，但您想要的答案是 onmousedown、onmousemove、onmouseup。你必须处理这三个事件。

在 onmousedown 中，您会找到目标（不同浏览器中的 event.target 或类似内容）并设置 draggedObject = event.target。您还将开始处理 onmousemove 事件。

每当触发 onmousemove 事件时，您将根据自上次触发 onmousemove 事件以来的位置差异来移动拖动的元素。

在 onmouseup 事件中，您将清除 draggedObject 变量并停止处理 onmousemove。

它不是非常跨浏览器，但它是拖放操作所需的核心。*******************