# StackOverflow 问答 12424000-12424999

# django - 如何绕过 django 管理索引并转到特定的应用程序页面？

> ID：12424000
> 
> 赞同：0
> 
> 时间：2012-09-14T11:53:18.667
> 
> 标签：django, django-admin

我有一个只有一个应用程序的 Django 项目。

我不需要站点管理员（与我的应用程序管理员相同），因此我想绕过站点管理员并直接进入我的应用程序管理员，即`mysite/admin/myapp/` 登录后直接进入并在面包屑中删除`Home`。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:20:30.317

`Django Url Dispatcher`扫描所有已定义的 url 定义并将请求重定向到第一个匹配的 url 定义。此时，在`urls.py`项目根目录的文件中，url 排序很重要：

```
urlpatterns += patterns('',   
    ...
    (r'^admin/', include(admin.site.urls)),
    ...
) 
```

*您可以定义从管理索引页面*url 到自定义视图的 url 重定向

```
urlpatterns += patterns('',   
    ...
    (r'^admin/$', 'myapp.views.home'),
    (r'^admin/', include(admin.site.urls)),
    ...
) 
```

因此，如果请求 url 是您的*admin index page*，那么您的自定义视图将被调用，如果它是一个 admin page（以 开头`admin/`）但不是*admin index page*，那么`admin.site.urls`将被执行......

在你`myapp.views`写一个简单的重定向视图：

```
from django.http import HttpResponseRedirect

def home(request):
    return HttpResponseRedirect("/myapp/") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T12:28:09.950

您可以做的是覆盖管理索引页面以重定向到特定于应用程序的管理页面。

正如@FallenAngel 所述，您需要更新 urls.py 以查看管理索引页面。该视图可以重定向到内部应用程序管理页面。

```
from django.http import HttpResponseRedirect
from django.core import urlresolvers
def home(request):
    return HttpResponseRedirect(urlresolvers.reverse('admin:app_list', args=("myapp",))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:16:35.447

`INSTALLED_APPS`如果您不想在项目中使用它，可以在 中将其注释掉。只需要将其从管理员中删除，您就需要取消注册。[在这里](https://stackoverflow.com/questions/5742279/removing-sites-from-django-admin-page)查看。

另一个技巧是，您可以覆盖管理 url`mysite/admin/`以简单地重定向到 `mysite/admin/myapp/`您不需要定义自己的重定向视图的位置。Django [DRY](https://docs.djangoproject.com/en/dev/misc/design-philosophies/#don-t-repeat-yourself-dry)在那里摇摆不定。:)

```
from django.http import HttpResponseRedirect

urlpatterns = patterns('',
                       url(r'^mysite/admin/$', lambda x: HttpResponseRedirect('/mysite/admin/myapp/')),
                       url(r'^mysite/admin/', include(admin.site.urls)),
                      ) 
```

要进行更多自定义，您需要通过自定义管理模板来更改管理索引页面。医生在这里。 [https://docs.djangoproject.com/en/1.3/intro/tutorial02/#customize-the-admin-index-page](https://docs.djangoproject.com/en/1.3/intro/tutorial02/#customize-the-admin-index-page)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-02T10:45:02.030

最干净和最简单的方法是使用泛型`RedirectView`in `urls.py`：

```
from django.core.urlresolvers import reverse_lazy
from django.views.generic import RedirectView

urlpatterns = patterns('',
    url(r'^admin/$', RedirectView.as_view(url=reverse_lazy('admin:app_list',
        args=('myapp',)))),
    url(r'^admin/', include(admin.site.urls)),
) 
```

# image - 如何将内联图像与文本对齐？

> ID：12424003
> 
> 赞同：10
> 
> 时间：2012-09-14T11:53:23.710
> 
> 标签：image, css

我有简单的 div

```
<div class="ui-bar-a ui-corner-top">
    first_test | Status: <img src="templates/style/images/reload.gif" />
</div>
<div class="ui-bar-a">
    sms1 | Status: <img src="templates/style/images/reload.gif" />
</div>
<div class="ui-bar-a ui-corner-bottom">
    sms2 | Status: <img src="templates/style/images/reload.gif" />
</div> 
```

看起来像：

![重新加载](../Images/39f6495efeca5281b994c1a765cfac3e.png)

我需要它：

![重新加载2](../Images/63eb82bb07c35b839cb87a8d61795b86.png)

我尝试设置`margin:auto` `align="middle"`，但没有帮助

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T12:02:49.083

试着把

```
.ui-bar-a img{
    vertical-align: middle;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T12:05:08.900

就放

```
vertical-align:middle; 
```

图像的 css。没有其他的。你会得到你的输出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T11:58:56.873

你可以使用这个 CSS：

```
.ui-bar-a img, .ui-bar-a span{
    display:inline-block;
    vertical-align:top;
}
    .ui-bar-a img{
    margin-top:xxx; // as you requirment  
} 
```

这个HTML：

```
<div class="ui-bar-a">
    <span>Some text here </span>
    <img src="xxx.jpg"> 
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:08:06.590

这是一个如何垂直对齐 DIV 的示例

**例子：**

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
  <title>Universal vertical center with CSS</title>
  <style>
    .greenBorder {border: 1px solid green;} /* just borders to see it */
  </style>
</head>

<body>
  <div class="greenBorder" style="display: table; height: 400px; #position: relative; overflow: hidden;">
    <div style=" #position: absolute; #top: 50%;display: table-cell; vertical-align: middle;">
      <div class="greenBorder" style=" #position: relative; #top: -50%">
        any text<br>
        any height<br>
        any content, for example generated from DB<br>
        everything is vertically centered
      </div>
    </div>
  </div>
</body>
</html> 
```

来源：[http ://www.jakpsatweb.cz/css/css-vertical-center-solution.html](http://www.jakpsatweb.cz/css/css-vertical-center-solution.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T12:11:00.190

您可以使用：用于制造的浮动，

```
<div class="ui-bar-a ui-corner-top"> 
<span>first_test</span> <span>|</span> <span>Status:<span> <img src="templates/style/images/reload.gif" /> 
```

.ui-corner-top{ 溢出：隐藏填充：5px 0; }

.ui-corner-top span{ 浮动：左；显示：块；填充：0 2px；

}

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-14T12:11:54.053

使用此代码，下面是结果以及附件

![在此处输入图像描述](../Images/a4c03fa49440dd9f60391ecf61bd1a81.png)

```
<div class="ui-bar-a">
sms1 | Status: <img src="status.png" style= "vertical-align:middle;"  />
</div>
 <div class="ui-bar-a ui-corner-bottom">
sms2 | Status: <img style= "vertical-align:middle;" src="status.png" />
</div> 
```

# ios - Bug Cordova 1.5 找不到变量：PhoneGap

> ID：12424006
> 
> 赞同：1
> 
> 时间：2012-09-14T11:53:30.357
> 
> 标签：ios, xcode4, cordova, phonegap-plugins

我在 Cordova 1.5 下使用了 FTP Transfert 的插件，但是当我调用该函数时，出现错误：找不到变量：PhoneGap。

插件的 JS 脚本包含：

```
return Cordova.exec(success, fail, "FTPPlugin", "upload", types); 
```

我不知道错误中出现的变量PhoneGap在哪里

环境：

> Mac OS X 版本 10.6.8 构建 10K549
> 
> Xcode 版本 4.0.2 构建 4A2002a
> 
> 科尔多瓦 1.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T15:46:02.667

你肯定有 Cordova 和 Phonegap 版本之间的版本问题。“找不到变量：PhoneGap”

您可以尝试用 Cordova 替换 PhoneGap 来验证。

# java - 如何在 eclipse 中自动使用 m2e 配置 checkstyle？

> ID：12424009
> 
> 赞同：2
> 
> 时间：2012-09-14T11:53:32.547
> 
> 标签：java, eclipse, maven, checkstyle, m2e

我已经阅读了有关使用 m2eclipse 插件配置 checkstyle 的帖子，但它似乎不适用于 eclipse 维护的新 m2e 插件。

有没有办法在 maven 和 eclipse 中自动使用相同的 checkstyle 配置规则而不回退到 maven-eclipse-plugin？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T21:49:36.830

[位于https://github.com/organizations/m2e-code-quality](https://github.com/organizations/m2e-code-quality)的 m2e checkstyle 插件在市场上的发布和广告方面有点落后。您可以构建自己的副本并在 eclipse 中安装插件。

# c - 常量字符数组的内存分配

> ID：12424012
> 
> 赞同：0
> 
> 时间：2012-09-14T11:53:42.867
> 
> 标签：c

如果我写 char * p = "Welcome"。我可以看到 p 的地址。但是字符串的地址是什么，即 Welcome 存储在哪个地址？

如果我再写一次 char *s = "Welcome"。p 和 s 会指向同一个地址吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T11:55:15.037

在调试器中，如果您检查`p`，您将看到字符串的地址。

`&p`是`p`它自己的地址。

不，`p`也`s`不能保证指向同一个地址，但它们可能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T04:46:53.890

字符串常量“Welcome”通常放在内存的“只读数据”部分。这里有很好的解释：[字符串文字他们去哪里](https://stackoverflow.com/questions/2589949/c-string-literals-where-do-they-go)和[数据段](http://en.wikipedia.org/wiki/Data_segment)

您可以通过以下方式找到字符串常量“Welcome”的地址

```
 printf("%p",p); 
```

> 如果我再写一次 char *s = "Welcome"。p 和 s 会指向同一个地址吗？

也许相同的字符串常量被放在同一个地址，也许不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T11:55:58.687

“欢迎”是字符串常量，它存储在内存的只读数据部分中，但指针 p 在指向该字符串文字的堆栈中创建

# javascript - Javascript：为什么这个基准测试显示 array.shift() 在从数组中读取值时比 array[i] 快得多？

> ID：12424014
> 
> 赞同：7
> 
> 时间：2012-09-14T11:54:03.440
> 
> 标签：javascript, arrays, shift

只是一个快速的问题。我创建了基准测试（下面的链接），至少对我来说（运行 chrome 18.0.1025），每次使用 array.shift() 从数组前面读取值似乎比使用 while/for 读取值快得多循环并通过索引访问它们。

我确信这不可能是正确的，因为 shift() 还有很多工作要做，但同时我看不出我可能做错了什么来解释这种相当极端的差异？

[http://jsperf.com/some-array-reading-comparisons](http://jsperf.com/some-array-reading-comparisons)

感谢阅读，詹姆斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T12:19:07.090

您每次测试只设置一次数组，因此只有测试的第一次迭代`shift`有任何数据可供使用。下一次迭代从第一次迭代中留下一个空数组，并立即终止。

[这是固定的测试套件](http://jsperf.com/some-array-reading-comparisons/6)，其中变异算法在数据副本上工作。`shift`可以预见，该算法在性能上排在最后。

# java - 诱使 Facebook auth 相信我的应用程序是 iPhone

> ID：12424015
> 
> 赞同：1
> 
> 时间：2012-09-14T11:54:09.210
> 
> 标签：java, facebook, http, header

我正在开发一个允许用户使用他们的 Facebook 帐户登录的应用程序。目前，我[`Eclipse SWT browser`](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/browser/Browser.html)用来显示登录浏览窗口，效果很好。但是，如果这个网络浏览窗口被当作 iPhone 对待（并因此设置样式），我会更喜欢。我试图强迫它`HTTP-headers`模仿 iPhone；没有任何变化。

我当前的代码看起来有点像这样：

```
String[] headers = { "Mozilla/5.0 (iPhone; U; CPU like Mac OS X; en) AppleWebKit/420+ (KHTML, like Gecko) Version/3.0 Mobile/1A543a Safari/419.3" };
browser.setUrl("https://m.facebook.com/dialog/oauth?client_id=appId&redirect_uri=url&state=state", "", headers); 
```

然而，Facebook 网站仍然意识到我不是 iPhone，这使得输出看起来像这样：

![在此处输入图像描述](../Images/3ff5fe0788ab35c2f4fcb1df93f5b6ab.png)

虽然我正在寻找这种设计：

![在此处输入图像描述](../Images/86f80dd75b574accdf8684280f334850.png)

# imagemagick - 如何在 ImageMagick 中用透明图像替换白色背景颜色？

> ID：12424018
> 
> 赞同：43
> 
> 时间：2012-09-14T11:54:11.397
> 
> 标签：imagemagick, background-image, background-color

我有一张`.jpg format`图片`white background color`。我想将白色背景颜色删除为透明`Imagemagick`。我尝试了很多方法，但仍然无法删除白色背景。有人可以帮我解决这个问题。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-09-14T19:03:41.370

您的 JPEG 文件中不能有透明的背景颜色。JPEG 文件格式不支持透明度。

如果需要透明背景，则需要将 JPEG 转换为

*   PNG（高质量，文件大小可能大于 JPEG）
*   或 GIF（如果您可以容忍低质量和最多 255 种颜色的范围）。

**示例命令：**

```
convert  your.jpg  -transparent white  your.png 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-09-15T03:43:17.113

首先，您需要将图像格式从转换`.jpg`为`.png`格式，因为 JPEG 不支持透明度。然后使用这个命令：

`convert image1.png -fuzz 20% -transparent white result.png`

该`-fuzz`选项还允许将与纯白色的指定百分比偏差转换为透明。这很有用，例如，当您的图像包含噪声或细微渐变时。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-06-30T20:21:13.160

我刚刚发现了一个非常整洁的东西！

```
magicwand 1,1 -t 20 -f image -r outside -m overlay -o 0 image.jpg imgOutput.png 
```

这是一个 Fred Weinhaus bash 脚本，可以从[这里](http://www.fmwconcepts.com/imagemagick/magicwand/)下载（仅用于非商业用途）。还有大约250个脚本！这个太棒了！它确实做到了，去除所有背景，同时保持内部图像点不受影响！

在他的页面上，有几个图像作为示例，因此您可以选择需要放在命令行上的内容！

初始位置`1,1`是一般猜测者，说所有轮廓都是背景。

注意输出必须是“.png”

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-05T09:37:00.027

这是我没有魔法棒的解决方案（替换`magick`为`convert`for im < 7.0）：

```
magick img.png -fuzz 20% -fill none -draw "alpha 1x1 floodfill" result.png 
```

# android - 如何将辅助效果附加到全局输出组合？

> ID：12424028
> 
> 赞同：2
> 
> 时间：2012-09-14T11:54:44.623
> 
> 标签：android, opensl

如何通过 OpenSL 将混响和包络混响效果附加到全局输出组合？

# javascript - Jquery $(document.activeElement).is(':focus') 返回 false ？（在火狐中）

> ID：12424029
> 
> 赞同：1
> 
> 时间：2012-09-14T11:54:45.477
> 
> 标签：javascript, jquery

根据定义， document.activeElement 应该返回具有焦点的元素，但是

```
$(document.activeElement).is(':focus') 
```

有时似乎返回错误。（使用 Jquery 1.7.2）

[jsFiddle 中的示例](http://jsfiddle.net/yRQHB/1/)

第一次显示此小提琴时，结果为真，然后如果单击运行按钮，结果变为假。

编辑：这个问题可以在 ubuntu 上的 Firefox 15 和 10 中复制。

有人对这种行为有解释吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:16:26.857

Firefox 会发生这种情况，只是因为 Firefox 不允许同时聚焦和聚焦同一元素，因为当我们为某个元素调用函数 focus 时，它会从前一个元素调用 outfocus。

现在你会想为什么它显示它作为一个活动元素只是因为参考没有改变你的解决方案，你首先调用 focusout，然后调用 focus 和其他设置超时的操作。

# google-apps-script - 创建用户界面元素 E.parameter.widgetName

> ID：12424032
> 
> 赞同：0
> 
> 时间：2012-09-14T11:55:00.650
> 
> 标签：google-apps-script

* * *

我正在尝试通过按钮功能获取参数`addCallbackElement`。但我收到以下错误：

> 遇到错误：TypeError：无法读取未定义的属性“nameRegister”

```
----------

function **createUserPanel**(e){

  var ss = SpreadsheetApp.openById(LOGS_SHEET_ID);

  var app = UiApp.getActiveApplication();

  var absolutePanelReg = app.createAbsolutePanel().setId("absolutePanelReg");

  var verticalPanelReg = app.createVerticalPanel().setId("verticalPanelReg");

  var mainPanelReg = app.createHorizontalPanel().setId("mainPanelReg");

----------

  var lbNameRegister = app.createLabel().setText("Name of user: ");

  var nameRegister = app.createTextBox().setId("nameRegister").setName("nameRegister");

  var botonSend = app.createButton().setText("Send");

  var handlerRegister = app.createServerHandler("createUser")**.addCallbackElement**(verticalPanelReg);

  botonSend.addClickHandler(handlerRegister);

----------

  verticalPanelReg.add(lbNameRegister);

  verticalPanelReg.add(nameRegister);

  mainPanelReg.add(verticalPanelReg);

  absolutePanelReg.add(mainPanelReg);

  app.add(absolutePanelReg);

  return app;
};

----------

  function **createUser**(e){

    /*var nameRegister ="test";*/

    var nameRegister = e.paramater.nameRegister;

    .......

}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T08:19:54.767

问题已经解决了 ：

参数 > 参数

感谢“Serge insas”

# javascript - Raphael SVG：Chrome 中的丑陋渲染

> ID：12424036
> 
> 赞同：6
> 
> 时间：2012-09-14T11:55:03.707
> 
> 标签：javascript, google-chrome, svg, raphael

使用 Raphael.js 在欧洲的一些小地图上工作。

它在 IE7+、Safari、Firefox 中运行良好。但是，在 Chrome 中，当悬停在法国上空时，我的地图上会出现一个白框。它似乎无处不在，它只发生在法国，当你将鼠标悬停在另一个国家时它就会消失。

![白盒](../Images/73b91e92179bd6bdd486d8ac5254dc55.png)

我的地图的 JSFiddle 在这里；我仍然需要清理代码，但它可以工作。

[http://jsfiddle.net/ontolecabaret/ncyge/](http://jsfiddle.net/ontolecabaret/ncyge/)

似乎问题与这一行有关：

```
$c.css({ top: e.pageY, left: e.pageX}).fadeIn(500); 
```

当我删除“左”设置时，该框不会出现。当我将'left'设置为 50px 或 50px margin-left 时，框看起来要小得多。似乎有什么东西被法国盒子推到了右边，但我似乎无法将手指放在它上面。

**编辑：重新打开这个问题，因为修复不能解决我的问题。**

使用`-webkit-transform: translate3d(0,0,0);`地图上的 css，白框消失了，但出现了一个新问题：我的地图上到处都是黑点，并且路径无法正确渲染。

![丑陋的道路](../Images/4b53e6bebed6d08472fb52704b512c05.png)

这也是 Chrome 中的一个错误，还是我可以通过一种或另一种方式解决这个问题？

SVG 在 Safari、FF 甚至 IE 中呈现良好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T14:18:07.203

我已经看到，在最新版本的 Chrome 动画中偶尔会留下试验（我无法确定确切的时间），我解决这个问题的方法是迫使 webkit 使用 gpu 来缓存图像。您可以通过应用 3d 转换来实现此目的：

```
#map {
    background: #f4f3f0;
    width: 631px;
    height: 686px; 
    -webkit-transform: translate3d(0,0,0);
} 
```

[http://jsfiddle.net/5s7dR/](http://jsfiddle.net/5s7dR/)

但是因为——由于某种原因我无法理解——这会弄乱你的路径，你可以用`-webkit-backface-visibility: hidden;`

```
#map {
    background: #f4f3f0;
    width: 631px;
    height: 686px; 
    -webkit-backface-visibility: hidden;
} 
```

[http://jsfiddle.net/VaKvX/](http://jsfiddle.net/VaKvX/)

这不是 Raphael 特有的问题，它有时会发生在 CSS 过渡、jQuery 和 vanilla js 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T12:49:00.300

我的字体有问题 - 网格边框很大，我的解决方案是增强 viewBox - 10 倍 - 然后公差变得非常小，但代价是所有内容 - 10 倍？

# iphone - 仅针对特定行的重用表视图单元格的子视图为零

> ID：12424042
> 
> 赞同：0
> 
> 时间：2012-09-14T11:55:18.093
> 
> 标签：iphone, ios, uitableview, storyboard

我已经尝试解决这个问题很长一段时间了，但我仍然无法弄清楚。我拥有的是故事板中的自定义表格视图单元格。在单元格中，我添加了 6 个视图，每个视图都有一个 imageView 子视图。我设置了视图的标签，以便以后可以访问它们。此表用作我的应用程序中的缩略图视图。问题是，在特定行中，最后一个缩略图容器视图不再将 imageview 作为子视图，从而导致崩溃。

下面是我为表格设置图像的代码。任何帮助将不胜感激。谢谢！

```
 NSString *CellIdentifier = @"ThumbnailCell";
    UITableViewCell *cell = (UITableViewCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    //loops through each thumbnails
    for (int i=1; i<=kNumberOfThumbnails; i++)
    {

        //get index of current thumbnail- starting value is 0
        int index=((indexPath.row *kNumberOfThumbnails)+i)-1;
        NSLog(@"index %d",index);
        //create an indexpath given the computed index and cell section
        NSIndexPath *currentIndexPath=[NSIndexPath indexPathForRow:index inSection:indexPath.section];
        //get number of sections
        NSArray *sections = [self.fetchedResultsController sections]; 

        NSInteger count=0;
        id <NSFetchedResultsSectionInfo> sectionInfo = [sections objectAtIndex:indexPath.section];
        //get number of objects for given section
        count = [sectionInfo numberOfObjects]; 

        NSLog(@" i: %d  number of subviews ni thumn container %d",i,thumbContainer.subviews.count);

         //get view container for thumbnails
        UIView *thumbContainer=(UIView *)[cell.contentView viewWithTag:i];

        UIImageView *imageView=[thumbContainer.subviews objectAtIndex:0];// this is where the app crashes.. thumbContainer no longer have a subview (for a specific row only)so it throws out an nsrangeexception

        if (index<count) 
        {

            //get file using the created indexpath
            File *imageFile=[self.fetchedResultsController objectAtIndexPath:currentIndexPath];

            //set image
            imageView.image=[UIImage imageNamed:imageFile.thumbnail];
            thumbContainer.backgroundColor=[UIColor grayColor];

            //set tag for image view for the system to know what file is tapped
            imageView.tag=(currentIndexPath.section*kImageTagMultiplier)+currentIndexPath.row;

            //add tap gesture to thumbnail container view

            UITapGestureRecognizer *tap=[[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(resultTapped:)];
            tap.numberOfTapsRequired=1;
            [thumbContainer addGestureRecognizer:tap];   

        }
        else {
            imageView.image=[UIImage imageNamed:@""];
            thumbContainer.backgroundColor=[UIColor clearColor];
            for (UIGestureRecognizer *gest in thumbContainer.gestureRecognizers) {
                [thumbContainer removeGestureRecognizer:gest];
            }
        }

   return cell; 
```

我在这里尝试做的是我有一个对象数组，每个对象都由一个缩略图表示，我使用 tableview 来显示这些缩略图..，对于每一行都有固定数量的缩略图。在情节提要中，我有一个有 6 个方形视图的单元格，每个视图里面都有一个 imageview。我添加容器视图而不是仅仅放置图像视图的原因是每个缩略图都是可点击的，我需要通过获取 Tapgesture 的视图（容器视图）子视图（即 imageview）标签来知道点击了什么对象。

顺便说一句，我在遇到崩溃的地方发表了评论

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T06:41:44.243

你应该使用新的 iOS 6 [`UICollectionView`](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UICollectionView_class/Reference/Reference.html)，因为它是为这样的事情而设计的。

# .net - 句柄和线程有什么区别？

> ID：12424045
> 
> 赞同：14
> 
> 时间：2012-09-14T11:55:24.197
> 
> 标签：.net, windows

我在 Windows 任务管理器 -> 系统块下的性能选项卡中看到了进程、线程和句柄统计信息。

有人可以告诉我什么是句柄（包括技术信息，包括开发观点）？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-14T12:03:13.027

线程是进程的一部分，在自己的执行空间内运行，一个进程中可以有多个线程。借助它，操作系统可以并行执行多个任务（取决于机器的处理器数量。

句柄是一个通用的操作系统术语，可以作为操作系统对象的票证。每个句柄都是唯一的并标识每个对象。线程是一个操作系统对象，您创建的每一个对象都会为它返回一个句柄。

在 Windows 下，线程句柄与线程 ID 不同，就像文件句柄与文件名不同一样。

线程句柄是一个令牌，它允许您对线程执行某些操作（通常等待或终止它）。Win32 有许多对象的这些标记，通​​常称它们为 HANDLE。

# visual-studio-2010 - SlowCheetah 在构建后事件后执行

> ID：12424047
> 
> 赞同：5
> 
> 时间：2012-09-14T11:55:39.903
> 
> 标签：visual-studio-2010, msbuild, slowcheetah

我使用 SlowCheetah 来转换我的 app.configs。我有一个多项目解决方案，其中一个项目执行构建后事件，其中 bin 的输出被复制到其他地方。我发现 SlowCheetah 在构建后事件之后会进行转换，所以我正在复制的 app.config 是预转换版本。

有没有人建议我在 SlowCheetah 转换后如何执行我的副本？这是否需要我编写自定义构建任务？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T18:27:25.727

如果您使用 msbuild 4.0 来构建您的项目 - 您可以使用新的 AfterTargets BeforeTargets 属性连接到 slowcheetah 目标。

我不知道您想要挂钩的确切目标名称，但这段代码可以为您提供如何执行此操作的基本概念

```
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <Target Name="Some_Target_Name" AfterTargets="TransformAllFiles" >
            <Message Text="= Script here will run after SlowCheetah TransformAllFiles ="/>
    </Target>
<Project> 
```

编辑：我安装了 SlowCheetah，发现 AfterTargets 属性应该是“TransformAllFiles”。只需设置您的目标依赖项`AfterTargets="TransformAllFiles"`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-05T15:33:55.183

Alexey 的回答导致了正确的解决方案，但这里是完整的：

*   右键单击您的项目并选择`Unload Project`
*   现在右键单击项目并选择`Edit [your project name].csproj`
*   滚动到底部并取消注释命名的目标`AfterBuild`并添加此属性`AfterTargets="TransformAllFiles"`
*   使用 Exec 命令将您的构建后操作移动到此目标中：

一个例子：

```
<Target Name="AfterBuild" AfterTargets="TransformAllFiles">
 <Exec Command="ECHO Hello PostBuild World!" />
</Target> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-17T17:48:03.983

我也遇到过这个问题...决定更新到SlowCheetah的最新版本（当前2.5.8），这个问题似乎已经解决了！使用构建后事件来部署具有转换后的 XML 的项目不再有问题！

在 NuGet 包升级过程之后，我遇到了一个奇怪的问题，但是......转换不再发生。像 Naeem Sarfraz 建议的那样编辑项目，我发现 SlowCheetah 的 PropertyGroup 部分放在 .csproj 的末尾。

只需将它移到顶部，靠近其他 PropertyGroup 部分，现在它就像一个魅力！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-13T00:16:33.250

如果您需要在构建之后复制/移动其他 .config 文件（web.config 除外），然后在此处发布，那么可以使用 Visual Studio 2013 来完成（我没有在早期版本上对其进行测试）。此部分可以添加到 .csproj 文件末尾的结束标记 </Project> 之前，它将在 MSDeploy 开始发布过程之前被触发。

```
<Target Name="MoveConfigFile" BeforeTargets="MSDeployPublish">
    <Move
        SourceFiles="$(IntermediateOutputPath)Package\PackageTmp\ThirdPartyApp.config"
        DestinationFolder="$(IntermediateOutputPath)Package\PackageTmp\bin"
        OverwriteReadOnlyFiles="true"
    />
</Target> 
```

我工作的公司购买了第三方产品，该产品需要在***bin 文件夹***中包含一个 .config 文件及其程序集才能工作。

同时我们需要对产品的.config文件进行处理，并能够在转换后将其移动到***bin文件夹***中。

$(IntermediateOutputPath)Package\PackageTmp 文件夹包含将通过目标服务器复制的整个应用程序。

# native - 本机应用程序可以访问网络吗？

> ID：12424048
> 
> 赞同：0
> 
> 时间：2012-09-14T11:55:39.963
> 
> 标签：native

好的，在浏览网络后，我有点困惑。

如果我使用 Apache Cordova 之类的东西从 html5 构建本机应用程序，该应用程序是否可以使用来自 Web 服务器的数据使其离线数据库保持最新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T11:58:32.523

当然可以。当您的应用程序连接到 Internet 时，您将“只需”同步它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:05:06.357

是的，我们可以使用 html5 服务器发送的事件来做到这一点。我没有尝试过，但我想它可能对你有帮助。[从服务器获取数据到客户端](http://www.w3schools.com/html5/html5_serversentevents.asp)

[用于缓存](http://www.w3schools.com/html5/html5_app_cache.asp)

# python - 从 PyIDispatch 调用方法

> ID：12424049
> 
> 赞同：1
> 
> 时间：2012-09-14T11:55:40.980
> 
> 标签：python, pywin32, win32com, pythoncom

我必须从具有描述的 COM API 获取事件：

```
HRESULT OnStatusMessage(
    [in] IDispatch* pStatusMessage
); 
```

而IStatusMessage有属性：BSTR描述、LONG Code等。

我的代码不起作用：

```
import msvcrt
import pythoncom
from win32com.client import DispatchWithEvents

class evt(object):
    def OnConnectionLost(self):
        print 'method ConnectionLost'
    def OnStatusMessage(self, s):
        print 'method OnStatusMessage: '  + str(s.Description)
    def OnLogin(self, l):
        print 'method OnLogin:', l
    def OnMessage(self, msg):
    print 'method OnMessage'

session = DispatchWithEvents("NiApi.SrvrSession", evt)
# login settings....

session.Connect()

while 1:
    if msvcrt.kbhit():
    msvcrt.getch()
        session.Disconnect()
        break
    pythoncom.PumpWaitingMessages() 
```

模块因回溯而失败：

```
Traceback (most recent call last):
  File "C:\Python\AP_272\lib\site-packages\win32com\server\policy.py", line 277, in     _Invoke_
    return self._invoke_(dispid, lcid, wFlags, args)
  File "C:\Python\AP_272\lib\site-packages\win32com\server\policy.py", line 282, in _invoke_
    return S_OK, -1, self._invokeex_(dispid, lcid, wFlags, args, None, None)
  File "C:\Python\AP_272\lib\site-packages\win32com\server\policy.py", line 585, in _invokeex_
    return func(*args)
  File "d:\niapi.py", line 13, in OnStatusMessage
    print 'method OnStatusMessage' + str(s.Description)
AttributeError: 'PyIDispatch' object has no attribute 'Description'
pythoncom error: Python error invoking COM method. 
```

为什么我不能得到这个属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:01:22.910

我在[这里](http://bytes.com/topic/python/answers/31518-com-server-being-passed-instance-interface)找到了答案：

需要调度这个对象：

```
message = Dispatch(s)
print 'method OnStatusMessage', str(message.Description) 
```

并且不要忘记导入`Dispatch`

```
from win32com.client import Dispatch 
```

# javascript - Jquery管道多个结果

> ID：12424051
> 
> 赞同：1
> 
> 时间：2012-09-14T11:55:48.780
> 
> 标签：javascript, jquery, jquery-deferred

我有三种方法 `loadMeta`,`loadData`和`renderList`。

`loadMeta`将其结果传递给`loadData`. LoadData 使用元数据获取结果；

然后我需要从`loadMeta`and获取结果`loadData`并将它们都传递给`renderList`. 但我不知道如何获得两组结果，我只是从`loadData`.

这（基本上）是我想要做的：

```
$.when(loadMeta().pipe(loadData)).then(function(){ renderList(metaResult, dataResult); } ); 
```

是否可以内联或我需要分解语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:24:11.347

如果您的`loadData`函数将返回两个结果，那将是最简单的。

让结果成为包含两个结果的对象的简单函数需要一个额外的`then`( `pipe`)：

```
loadMeta().then(function(metaResult) {
    return loadData(metaResult).then(function(dataResult) {
        return {meta:metaResult, data:dataResult};
    });
}).done(function(result) {
    renderList(result.meta, result.data);
}); 
```

或者，您将它们合并到具有正确签名的解析回调`renderList`：

```
loadMeta().then(function(metaResult) {
    return loadData(metaResult).then(function(dataResult) {
        return new $.Deferred().resolve(metaResult, dataResult);
    });
}).done(renderList); 
```

或者，正如您所建议的，我们可能会中断该语句并添加一个额外的回调来缓存`metaResult`：

```
var metaResult;
loadMeta().done(function(result) {
    metaResult = result;
}).then(loadData).done(function(dataResult) {
   renderList(metaResult, dataResult);
}); 
```

这可能是最容易理解的。

# php - 如果 user_meta 等于 X 则显示一个 div

> ID：12424055
> 
> 赞同：0
> 
> 时间：2012-09-14T11:55:51.480
> 
> 标签：php, wordpress, metadata, conditional, meta-tags

在我的网站上，当用户注册时，可以选择从 3 个值（房屋、汽车、船）中进行选择。一旦用户注册并查看了他们的个人资料，我想根据他们在注册时选择的元值在前端显示一个按钮。如果他们没有元键，则不会显示任何内容。

这是我的代码尝试，但不起作用！

```
<?php global $current_user;
get_currentuserinfo(); //wordpress global variable to fetch logged in user info
$userID = $current_user->ID; //logged in user's ID
$havemeta1 = get_user_meta($userID,'house',true); //stores the value of logged in user's meta data for 'house'
$havemeta2 = get_user_meta($userID,'car',true); //stores the value of logged in user's meta data for 'car'
$havemeta3 = get_user_meta($userID,'boat',true); //stores the value of logged in user's meta data for 'boat'

?>

<!--add if statement to figure out what button to show to logged in user-->
<?php if ($havemeta1) { ?>
   <div class="Button1"></div>
<?php } elseif ($havemeta2) { ?>
   <div class="Button2"></div>
<?php } elseif ($havemeta3) { ?>
   <div class="Button3"></div>
<?php } else { ?>
   <div></div>
<?php }?> 
```

简而言之 - 预期结果是，如果用户在注册时选择了 House，则显示带有 class=Button1 等的 DIV

**更新：** 上面的代码现在可以工作了！

# gwt - 未找到 Gwt requestFactory 验证器

> ID：12424059
> 
> 赞同：-1
> 
> 时间：2012-09-14T11:55:57.270
> 
> 标签：gwt, validation, bean-validation, requestfactory

在我的项目引用库中，我有：hibernate-validator-4.1.0.Final.jar

但是当我运行我的项目时，我得到了

```
[WARN] Server class 'org.springframework.asm.ClassVisitor' could not be found in the web app, but was found on the system classpath
 [WARN] Adding classpath entry 'file:/C:/Users/bob/Downloads/spring-framework-3.1.2.RELEASE/spring-framework-3.1.2.RELEASE/dist/org.springframework.asm-3.1.2.RELEASE.jar' to the web app classpath for this session
   For additional info see: file:/C:/Applications/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.4.0.v201208080121-rel-r42/gwt-2.4.0/doc/helpInfo/webAppClassPath.html
[WARN] Server class 'org.springframework.expression.PropertyAccessor' could not be found in the web app, but was found on the system classpath
   [WARN] Adding classpath entry 'file:/C:/Users/bob/Downloads/spring-framework-3.1.2.RELEASE/spring-framework-3.1.2.RELEASE/dist/org.springframework.expression-3.1.2.RELEASE.jar' to the web app classpath for this session
   For additional info see: file:/C:/Applications/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.4.0.v201208080121-rel-r42/gwt-2.4.0/doc/helpInfo/webAppClassPath.html
[WARN] Server class 'net.sf.cglib.proxy.Enhancer' could not be found in the web app, but was found on the system classpath
   [WARN] Adding classpath entry 'file:/C:/Users/bob/Downloads/lib/cglib-2.2.jar' to the web app classpath for this session
   For additional info see: file:/C:/Applications/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.4.0.v201208080121-rel-r42/gwt-2.4.0/doc/helpInfo/webAppClassPath.html
[WARN] Server class 'javax.validation.ValidationException' could not be found in the web app, but was found on the system classpath
   [WARN] Adding classpath entry 'file:/C:/Applications/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.4.0.v201208080121-rel-r42/gwt-2.4.0/validation-api-1.0.0.GA.jar' to the web app classpath for this session
   For additional info see: file:/C:/Applications/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.4.0.v201208080121-rel-r42/gwt-2.4.0/doc/helpInfo/webAppClassPath.html
14 sept. 2012 13:48:10 com.google.web.bindery.requestfactory.server.ReflectiveServiceLayer <clinit>
INFO: Unable to initialize a JSR 303 Bean Validator
javax.validation.ValidationException: Unable to find a default provider
    at javax.validation.Validation$GenericBootstrapImpl.configure(Validation.java:264)
    at javax.validation.Validation.buildDefaultValidatorFactory(Validation.java:111) 
```

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T14:14:12.090

你看过[file:/C:/Applications/eclipse/plugins/com.google.gwt.eclipse.sdkbundle_2.4.0.v201208080121-rel-r42/gwt-2.4.0/doc/helpInfo/webAppClassPath.html](http://google-web-toolkit.googlecode.com/svn/tags/2.4.0/distro-source/core/src/doc/helpInfo/webAppClassPath.html)吗？

答案就在那里：服务器端 JAR 应该在*WEB-INF/lib*中。

# testing - 如何使用 selenium 检查 Web 表单元素是否存在

> ID：12424061
> 
> 赞同：1
> 
> 时间：2012-09-14T11:56:01.587
> 
> 标签：testing, selenium, web

我需要使用 selenium 检查当前网页中是否存在表单元素。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T23:08:57.560

There are two ways to do this. Either use lefthandedgoat's version catching an exception, or use the FindElements method and check it's size, so something like (in C# using LINQ):

```
public bool IsElementPresent(By selector)
{
    return driver.FindElements(selector).Any();
} 
```

Either option will work fine, there is not really much different. I personally use the other way, but wanted to make sure you knew there are generally two ways to do this. You didn't mention a language, so let us know if there is a specific language you are using.

It is worth noting that underneath, when you do a FindElement() in Selenium, it is performing this method.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T18:26:04.963

在 selenium 的 C# 版本中，如果元素不存在，它将引发异常。你可以做这样的事情

```
public bool Exists(string cssSelector)
{
  try
  {
    browser.FindElement(By.CssSelector(cssSelector));
    return true
  }
  catch (Exception ex){}

  return false;
}

var exists = Exists("form"); 
```

我不确定 webdriver 在其他语言中的行为方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T10:16:03.737

您可以使用两种方法：

```
input.findElements(By.xpath("//....blablalba....")).size() > 0

driver.findElement(By.xpath("//....blablalba....")).isDisplayed() 
```

# android - Android 上下文菜单创建中的 getMenuInflater() 方法未定义问题

> ID：12424063
> 
> 赞同：21
> 
> 时间：2012-09-14T11:56:10.693
> 
> 标签：android, contextmenu, android-menu, android-contextmenu

我正在尝试在片段内创建上下文菜单项。但是我遇到了 getMenuInflater() 方法的问题。它是未定义的。我已经导入了所有必要的包。谁能指出我在这里做错了什么？

这是我的代码：

```
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.ContextMenu;
import android.view.ContextMenu.ContextMenuInfo;
import android.view.Gravity;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuItem;
import android.view.MenuInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;
import android.view.MenuItem;

public class FeaturedFragment extends Fragment {
    public FeaturedFragment() {
    }
    public static final String ARG_SECTION_NUMBER = "section_number";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.featured_fragment,container,false);
        registerForContextMenu(view);
        return view;
    }

    @Override
    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo)
    {
        super.onCreateContextMenu(menu, v, menuInfo);
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.toggleview_menu, menu);
    }
} 
```

这是我的 menu.xml

```
 <menu xmlns:android="http://schemas.android.com/apk/res/android" >    
      <item android:id="@+id/toggle_view"
         android:title="Change to ListView"
         android:icon="@drawable/collections_view_as_grid"
         android:showAsAction="always" />
      <item android:id="@+id/grid_view"
         android:title="Grid View"
         android:orderInCategory="99"
         android:showAsAction="never" />
      <item android:id="@+id/list_view"
         android:title="List View"
         android:orderInCategory="99"
         android:showAsAction="never" />
  </menu> 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-09-14T11:58:10.357

改变：

```
MenuInflater inflater = getMenuInflater(); 
```

对此：

```
MenuInflater inflater = getActivity().getMenuInflater(); 
```

# iphone - 如何弹出拆分视图控制器“DetailViewController”？

> ID：12424064
> 
> 赞同：0
> 
> 时间：2012-09-14T11:56:16.140
> 
> 标签：iphone

```
 detailViewController = [[DetailViewController alloc] initWithNibName:@"DetailViewController_iPad" bundle:nil];

    [self.splitViewController.splitViewController viewWillDisappear:YES];
    detailViewController.strDetailId = [teaserSectionOneArray objectAtIndex:indexValue] ;
    NSMutableArray *viewControllerArray = [[NSMutableArray alloc] initWithArray:[[self.splitViewController.viewControllers objectAtIndex:1] viewControllers]];
    [viewControllerArray removeAllObjects];
    [viewControllerArray addObject:detailViewController];
    [[self.splitViewController.viewControllers objectAtIndex:1] setViewControllers:viewControllerArray animated:NO];
    [self.splitViewController.splitViewController viewWillAppear:YES];
    [viewControllerArray release]; 
```

此代码用于推送到详细视图。单击按钮时，如何在详细视图中弹出另一个视图控制器？它不支持`[self.navigationController popViewControllerAnimated:YES];`. 如何处理这个问题？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:07:27.847

哇哦，这不是您将视图控制器推送到导航控制器堆栈上的方式！

你不必打电话`viewWillDisappear`，`viewWillAppear`这样你自己！您也不必自己添加`detailViewController`到`splitViewController.viewControllers`数组中！

你需要做的是：

*   确保你的 UISplitViewController 有一个`NavigationController`作为它的一部分`detailViewController`（即屏幕右侧的 ViewController 应该是一个`UINavigationController`，而不是常规的`UIViewController`）。
*   剩下的就很容易了，因为它的工作方式与任何常规`UINavigationController`. `UINavigationController`您是 an 的正确部分这一事实与您在任何其他上下文中`UISplitViewController`使用 an 时没有什么不同。`UINavigationController`

只需使用`pushViewController:animated:`和`popViewControllerAnimated:`的方法`UINavigationController`来推送和弹出您的视图控制器。使用您添加的`UINavigationController`自`UISplitViewController`定义`IBOutlet`来指向它，或者通过访问`(UINavigationController*)[self.splitViewController.viewControllers objectAtIndex:1]`.

# asp.net - 文件名包含空格的 TransmitFile

> ID：12424066
> 
> 赞同：2
> 
> 时间：2012-09-14T11:56:21.320
> 
> 标签：asp.net, string, httpresponse, response.transmitfile

在 C# ASP.Net 网站中，将文件传输到我正在使用的客户端

```
String file_path = Server.MapPath("~/files/"+file_name); 
HttpContext.Current.Response.ContentType = "application/octet-stream";
HttpContext.Current.Response.AddHeader("Content-Disposition", "attachment;filename=" + file_Name);
HttpContext.Current.Response.TransmitFile(file_path);        
HttpContext.Current.Response.End(); 
```

它工作得很好，但是当文件名包含任何空格时，下载的文件的名称只能到第一个单词。例如：如果我的文件名是，`"This is demo.txt"`那么下载的文件名将变为`"This"`没有扩展名。因此，下载它的用户无法识别其类型。
对于包含空格的文件名，我们如何避免发生这种情况？

我尝试使用

```
String file_path = "'"+Server.MapPath("~/files/"+file_name)+"'"; 
```

但它没有用。

我也无法替换（用'_'或'-'）或删除服务器上存在的文件名中存在的所有空格。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T12:11:18.890

您应该将文件名括在引号中。

```
HttpContext.Current.Response.AddHeader("Content-Disposition", "attachment;filename=\"" + file_Name + "\""); 
```

如果您使用的是 VS2015 或更高版本，则可以使用字符串插值使其更整洁：

```
HttpContext.Current.Response.AddHeader("Content-Disposition", $"attachment;filename=\"{file_Name}\""); 
```

此外，标题中的文件名不必与文件名相同。标题中的文件名只是对用户的建议。

有关完整的详细信息，请参阅[RFC 6266](https://www.rfc-editor.org/rfc/rfc6266) “在超文本传输​​协议 (HTTP) 中使用 Content-Disposition 标头字段”，尤其是关于哪些字符可能会导致文件名出现问题。

# php - 需要简单的正则表达式建议

> ID：12424073
> 
> 赞同：0
> 
> 时间：2012-09-14T11:56:37.677
> 
> 标签：php, regex

不幸的是，由于计划不周，我需要逐个字段地编辑一个巨大的 html 表单。但由于它只是查找和替换，我认为我可以使这个过程更快。所以......所有的领域看起来或多或少是这样的：

```
<td align="left" width="30%">Incoming date:</td>
<td align="left">
<input name="inc_date" class="frmfixededit" size="20"></td>
</tr>
....
<td align="left" width="30%">Name:</td>
<td align="left">
<input name="name" class="frmfixededit" size="20"></td>
</tr> 
```

我想做的就是把它改成这样：

```
<td align="left" width="30%">Incoming date:</td>
<td align="left">
<input name="inc_date" <?php if ($u==TRUE) echo "value='$row['inc_date']'"; ?> class="frmfixededit" size="20"></td>
</tr>
....
<td align="left" width="30%">Name:</td>
<td align="left">
<input name="name" <?php if ($u==TRUE) echo "value='$row['name']'"; ?> class="frmfixededit" size="20"></td>
</tr> 
```

关于我如何做到这一点的任何建议？我不知道如何匹配

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:03:14.483

在您选择的 IDE 中，使用查找模式执行正则表达式查找和替换：

```
<input name="(.*)" class="(.*)" size="20"> 
```

并替换模式：

```
<input name="$1" <?php if ($u==TRUE) echo "value='$row['$1']'"; ?> class="$2" size="20"> 
```

刚刚在 Textmate 为我工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:01:18.183

这个怎么样：

```
$result = preg_replace(
    '/<input name="  # Match start of tag
    ([^"]+)        # Match and capture the name
    "              # Match closing quote
    (.*)           # Match and capture rest of the line/x', 
    '<input name="\1" <?php if ($u==TRUE) echo "value=\'$row[\'\1\']\'"; ?>\2', $subject); 
```

# c# - 如何在 asp.net c# 中调用连接？

> ID：12424076
> 
> 赞同：-2
> 
> 时间：2012-09-14T11:56:45.487
> 
> 标签：c#, asp.net

我是 ASP.net c# 的新手

我有一个程序，在每个方法中都声明了连接。

我如何调用连接，以便我将声明一次连接并可以通过其他方法调用？那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T11:59:36.330

是的，有可能，我做这样的事情

```
public static DataContext getConnection()
    {
        String SqlOptions = "Put your connection string here";

        return new SqlConnection(SqlOptions);

    } 
```

如果您愿意，也可以将其设为属性，或从配置文件中调用连接字符串，如另一篇文章中所示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:01:14.240

如果您正在谈论恢复 SQLConnection 对象，那么它会更好，您现在拥有它的方式。当涉及到数据库连接时，最好尽可能晚地创建并尽早关闭。

`using`最好是在声明连接时使用块。

```
using(SQLConnection conn = new SQLConnection(yourConnectionString))
{
    // your work. 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T11:59:48.573

在您的应用程序或 web.config 添加

```
<connectionStrings>
    <add name="Default" connectionString="server=server;database=database;uid=username;pwd=password;Connect Timeout=900" providerName="System.Data.SqlClient" />
</connectionStrings> 
```

然后添加使用 System.Configuration；作为参考并称之为

```
ConfigurationManager.ConnectionStrings["Default"].ToString() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:19:36.663

我不确定我是否理解你的情况，但我会试着给你一个想法。您可以使用 2 种方法创建连接类：`ExecuteSqlScript()`和`ExecuteStoredProcedure()`，并在需要它的页面开头实例化它。您调用该方法，您可以填写`DataSet`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T12:02:05.593

[检查此代码项目教程](http://www.codeproject.com/Articles/12300/An-ASP-NET-Application-Using-a-MySQL-Database)

这将使您对使用 c# 的 asp.net 中的数据库连接有所了解。

# powershell - 如何在 PowerShell 中为脚本提供参数属性？

> ID：12424078
> 
> 赞同：18
> 
> 时间：2012-09-14T11:56:56.547
> 
> 标签：powershell, parameters

我有这个脚本可以通过两种方式调用：

```
MyScript -foo path\to\folder 
```

或者

```
MyScript -bar path\to\folder 
```

（也就是说，我既可以传递一个开关加一个文件夹，也可以传递一个字符串参数加一个文件夹。）

我试图将[参数声明](http://technet.microsoft.com/en-us/library/hh847743)放入我的脚本中以反映该语法：

```
param(
  [parameter(Mandatory=$false)] [switch]$foo,
  [parameter(Mandatory=$false)] [String]$bar,
  [parameter(Mandatory=$true)]  [System.IO.FileInfo]$path
) 
```

但是我必须`path`显式传递才能调用脚本：

```
MyScript -l -path path\to\folder 
```

那么（如何）我可以同时制作`bar`位置`path`参数吗？

*注意*：如果我选择了一种非常愚蠢的语法来调用脚本，我仍然可以更改它。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-14T13:14:24.327

有几件事：您需要使用参数集来告诉 PowerShell 调用脚本的方法是互斥的；也就是说，不能同时使用开关和字符串。这些集合还允许您设置两者的位置`$bar`并`$filepath`位于索引 0。开关不需要按位置放置，因为它们对活页夹没有歧义并且可以放置在任何地方。此外，每组中至少有一个参数应该是强制性的。

```
function test-set {
    [CmdletBinding(DefaultParameterSetName = "BarSet")]
    param(
        [parameter(
            mandatory=$true,
            parametersetname="FooSet"
        )]
        [switch]$Foo,

        [parameter(
            mandatory=$true,
            position=0,
            parametersetname="BarSet"
        )]
        [string]$Bar,

        [parameter(
            mandatory=$true,
            position=1
        )]
        [io.fileinfo]$FilePath
    )
@"
  Parameterset is: {0}
  Bar is: '{1}'
  -Foo present: {2}
  FilePath: {3}
"@ -f $PSCmdlet.ParameterSetName, $bar, $foo.IsPresent, $FilePath
} 
```

*如果在没有*参数的情况下调用函数，则需要该`CmdletBinding`属性来指定哪个参数集应该是默认值。

 *以下是上述配置的语法帮助：

```
PS> test-set -?

NAME
    test-set

SYNTAX
    test-set [-Bar] <string> [-FilePath] <FileInfo>  [<CommonParameters>]

    test-set [-FilePath] <FileInfo> -Foo  [<CommonParameters>] 
```

这是各种调用的输出：

```
PS> test-set barval C:\temp\foo.zip
  Parameterset is: BarSet
  Bar is: 'barval'
  -Foo present: False
  FilePath: C:\temp\foo.zip

PS> test-set -foo c:\temp\foo.zip
  Parameterset is: FooSet
  Bar is: ''
  -Foo present: True
  FilePath: c:\temp\foo.zip 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:46:01.463

如[here](http://technet.microsoft.com/en-us/library/hh847743.aspx)所述，您可以指定参数的参数位置。

```
[parameter(Position=0)] 
```*

# .net - 将 ASP.NET MVC 验证与企业库验证集成

> ID：12424081
> 
> 赞同：1
> 
> 时间：2012-09-14T11:57:00.900
> 
> 标签：.net, asp.net-mvc, validation, enterprise-library, validation-application-bl

我已经在为我的模型使用 Enterprise Library 5 验证（也用于 WCF 方法），所以我决定要避免使用 DataAnnotations 的 ASP.NET 4 MVC 中的冗余验证器。

但似乎 MVC 不会自动选择 Enterprise Library Validators。

如果我使用 MVC DataAnnotations：

```
[RegularExpression(MyValidationExpressions.Email, ErrorMessage = MyValidationMessages.InvalidEmailMessage)]
public virtual string Email { get; set; } 
```

HTML 包含 data-val-regex-pattern 并且该字段正在客户端验证。

但是如果我使用现有的基于 EL 的验证：

```
 [RegexValidator(MyValidationExpressions.Email, MessageTemplate = MyValidationMessages.EmptyFieldMessage))]
 public virtual string Email { get; set; } 
```

它不会在客户端显示验证错误，并且生成的 HTML 没有任何验证属性。

我在这里缺少什么，如何强制 MVC 在客户端和服务器端使用现有的 EL 验证器？

**解决方案**：

我接受了完全迁移到 DataAnnotations 的解决方案。这是最简单的方法，它适用于 EntLib 5 和 MVC 4。但是 ValidationFactory 有一个小问题 - 我必须用 CreateValidator 和特定标志替换 CreateValidatorFromAttributes。有关 DataAnnotations 如何与 ValidationFactory 一起使用的说明，请参阅本文：

[CreateValidatorFromAttributes 不使用 DataAnnotations 属性](http://entlib.codeplex.com/workitem/30303)

DataAnnotations 还具有 [Required] 属性，可以很好地处理空字符串和仅包含空格的字符串。VAB 上存在一些问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:20:28.267

您可以[`ModelValidatorProvider`](http://msdn.microsoft.com/en-us/library/system.web.mvc.modelvalidatorprovider%28v=vs.108%29.aspx)为企业库验证创建一个。Brad Wilson 有一篇[博客文章](http://bradwilson.typepad.com/blog/2009/10/enterprise-library-validation-example-for-aspnet-mvc-2.html)描述了如何做到这一点。

但是，看起来这只会执行服务器端验证。如果您使用的属性与 DataAnnotations 非常相似，我建议您改用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:11:05.060

这不起作用的原因是因为 VAB`RegexValidatorAttribute`不是从 继承`System.ComponentModel.DataAnnotations.RegularExpressionAttribute`，而是直接从`ValidationAttribute`. 因为这个 MVC 不知道如何处理它。

有一种方法可以改变 MVC 进行这种处理的方式，但我不知道如何。但是你为什么不直接`RegexValidatorAttribute`用 DataAnnotations'代替使用`RegularExpressionAttribute`呢？验证应用程序块 5 能够处理 DataAnnotations 属性，因此如果 DataAnnotations 属性有效，只需使用它们。

# facebook-graph-api - 为什么 Facebook Graph API 权限如此奇怪？

> ID：12424084
> 
> 赞同：0
> 
> 时间：2012-09-14T11:57:14.750
> 
> 标签：facebook-graph-api, permissions, facebook-page

我创建了一个 Facebook 页面。在页面上，我创建了一些事件和一些注释。一切尽可能公开。现在我想使用 Graph API 在我的网站上公开数据。

页面的一般数据无需任何访问令牌即可访问，这很好。事件数据可使用带有 app_id 和 app_secret 的 FB 应用程序访问。对于笔记，您需要一个“用户访问令牌”，这不是一个选项，因为并非所有网站访问者都有 FB 帐户。

为什么一定要这么复杂？有没有人有办法解决吗？

问候艾伦

# search - 产品搜索引擎，以及 eBay 上的属性过滤 - 它是如何完成的？

> ID：12424087
> 
> 赞同：2
> 
> 时间：2012-09-14T11:57:19.997
> 
> 标签：search

如果这是一个常见问题，请提前道歉......我想我很难找到答案，因为我不确定这个问题实际上叫什么！

问题的背景是 - 如果您查看像 ebay 这样的服务，当您进行查询时，您可以选择一个类别以深入了解您的结果。然后，当您向下钻取叶类别时，您可以开始使用过滤器。因此，如果您选择电视，您可能会得到各种过滤器——如面板技术（oled、lcd、crt）、屏幕尺寸（22 英寸、32 英寸、40 英寸等）、品牌（索尼、三星、lg 等） . 不同的过滤器向您显示每个过滤器将产生的结果数量。

关键点：当您选择过滤器时，可用的过滤器会更新。因此，如果您选择 Sony 和 oled，屏幕尺寸过滤器（和其他过滤器）将更新以匹配先前选择的过滤器约束内可用的结果。

我的问题是......你将如何在搜索引擎中实现这种过滤系统。或者具体来说，您将如何计算给定过滤器组合可用的结果数量？当用户选择过滤器时，您如何计算和更新“过滤器直方图”？

这似乎是一个复杂的问题。ebay 是否预先计算叶类别下每个可能的过滤器组合的结果数量？

还是有其他更聪明的方法来处理这个问题？

我希望我的问题是有道理的 :) 感谢您的帮助！:)

# android - Android 的 ViewPager 中的视差效果

> ID：12424088
> 
> 赞同：14
> 
> 时间：2012-09-14T11:57:21.517
> 
> 标签：android, android-viewpager, parallax

我试图在我的片段中滑动时模拟视差效果，我已经阅读过 beginFakeDrag 和 fakeDragBy 但老实说，我不知道它是否是解决我的问题的最佳方法。

任何人都对 ViewPager 做过类似的事情，或者对我应该如何处理这个有提示？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-09-16T19:19:14.850

不使用自定义库的一种简单方法是实现`ViewPager.PageTransformer`

我创建了布局以将其`id`用于背景元素。对于我的示例，所有背景图像都将使用 id`background`

```
<ImageView
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:id="@+id/background"
    android:src="@drawable/img12"
    android:scaleType="fitXY"/> 
```

然后，当我开始实施时，`ViewPager.PageTransformer`我可以像这样引用该图像：

```
public class Transformer implements ViewPager.PageTransformer{
    @Override
    public void transformPage(View page, float position) {
        if(position >= -1 && position <= 1){
            page.findViewById(R.id.background).setTranslationX(-position * page.getWidth() / 2);
        } else {
            page.setAlpha(1);
        }
    }
} 
```

最后，我将我的分配`ViewPager.PageTransformer`给我的`ViewPager`喜欢。

```
ViewPager pager = (ViewPager) findViewById(R.id.pager);
pager.setPageTransformer(false, new Transformer()); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-05T01:06:06.280

这个问题有点老了，但是当我试图做到这一点时，我发现了它......

我实现了自己的解决方案，基本上是扩展`ViewPager`和覆盖`onDraw`.

[你可以在这里](https://github.com/MatthieuLJ/ViewPagerParallax)找到一个简单示例的所有代码

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-04-25T20:33:10.233

我知道它有点旧，但看看[https://github.com/xgc1986/ParallaxPagerLibrary](https://github.com/xgc1986/ParallaxPagerLibrary)

它不会覆盖 onDraw 方法，并且效果不仅适用于图像，它适用于各种视图

```
mPager.setPageTransformer(false, new ParallaxTransformer(R.id.parallaxContent)); 
```

R.id.paraallaxContent 是你想要这个效果的View的id

除非其他解决方案，不需要任何具体结构即可工作，并且与布局无关

演示：[YouTube](https://www.youtube.com/watch?v=5zEOUWY9Hvo)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-22T19:33:14.823

也许这个库可以帮助你：

[https://github.com/garrapeta/ParallaxViewPager](https://github.com/garrapeta/ParallaxViewPager)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-04-12T09:03:48.040

你可以看看这个：

[https://github.com/luxsypher/ParallaxViewPager](https://github.com/luxsypher/ParallaxViewPager)

您可以在视图的任何元素上应用视差效果并赋予它们不同的速度

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-05-09T15:11:56.937

这是我编写的 ViewPager 子类，非常易于使用。您不需要对它做任何不同的事情，只需包含依赖项并将其用作标准 ViewPager。在[GitHub](https://github.com/andraskindler/parallaxviewpager)上可用。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-05-12T23:53:22.187

这个库在 x 和 y 方向上是完全可定制的，并且包括 alpha 效果：

[https://github.com/prolificinteractive/ParallaxPager](https://github.com/prolificinteractive/ParallaxPager)

安装（从 v0.7 开始，检查 README 以获取更新）：

1.  使用 Gradle 添加为 Maven Central 依赖项

2.  使用`ParallaxContainer`布局 XML 代替`ViewPager`

3.  为每个页面创建一个布局 XML 文件（可以为每个移入/移出页面的对象单独设置 x/y/alpha 属性）

4.  有一些复制/粘贴行要添加到`onCreate`您的活动中

![视差星球动画](../Images/55ef3b349a3c36b3e25a5766d7447f04.png)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-30T15:02:17.507

也许这个库可能有用： [https](https://github.com/matrixxun/ProductTour) ://github.com/matrixxun/ProductTour ？

它使用“ViewPager.PageTransformer”使事物在内部以不同方式移动。

# ruby - 有没有办法在 Rails 中模拟/存根“放置”

> ID：12424090
> 
> 赞同：5
> 
> 时间：2012-09-14T11:57:27.263
> 
> 标签：ruby, ruby-on-rails-3, testing

我正在使用 puts 命令在我的应用程序中打印一些自定义消息。但是，我不希望这些出现在我的测试输出中。所以，我尝试了一种存根方法`puts`，如下所示。但它仍然输出我的信息。我究竟做错了什么 ？

```
stubs(:puts).returns("") #Did not work out
Object.stubs(:puts).returns("") #Did not work out either
puts.stubs.returns "" #Not working as well
Kernel.stubs(:puts).returns "" #No luck 
```

我在用`Test::Unit`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T18:14:06.580

您可能需要在调用`puts`. 例如，如果您正在调用类`puts`的实例方法`User`，请尝试：

```
user = User.new
user.stubs(:puts)
user.some_method_that_calls_puts 
```

当您尝试`puts`在顶级执行范围内进行测试时，这同样适用：

```
self.stubs(:puts) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:43:58.100

我要做的是定义一个自定义日志方法（现在基本上调用 puts），您可以很容易地在测试中模拟或静音。

这也为您提供了稍后使用它执行更多操作的选项，例如登录到文件。

编辑：或者如果你真的想存根puts，并且你在一个实例方法中调用它，你可以只在那个类的实例上存根puts。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-17T06:40:28.437

使用 Rails 5 + 摩卡：`$stdout.stubs(puts: '')`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-16T16:14:40.350

因此，对原始帖子的评论指向答案：

```
Kernel.send(:define_method, :puts) { |*args| "" } 
```

我不会使所有输出静音，而只会使测试期间放置的特定对象的输出静音。

```
class TestClass
  def some_method
    ...
    puts "something"
  end
end

it "should do something expected" do
  TestClass.send(:define_method, :puts) { |*args| "" }
  test_class.some_method.should == "abc123"
end 
```

# dapper - Dapper Rainbow - 如何在另一个模式中指定表名

> ID：12424092
> 
> 赞同：6
> 
> 时间：2012-09-14T11:57:32.067
> 
> 标签：dapper, dapper-rainbow

我对 Dapper Rainbow 很陌生，所以我可能会遗漏一些明显的东西。是否可以指定表名，如果可以，如何指定？

我试过以下没有运气。

```
public class DashboardContext : Database<DashboardContext>
{
    public DashboardContext()
    {
       this.DashboardResults = new Table<DashboardResult>(this, "Monitor.DashboardResult");
    }

    public Table<DashboardResult> DashboardResults { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-17T00:41:44.577

我遇到了同样的问题，但代码中似乎有错误。我刚刚评论了为表（Database.cs）设置构造函数的行，它可以工作。

```
 internal void InitDatabase(DbConnection connection, int commandTimeout)
    {
        this.connection = connection;
        //this.commandTimeout = commandTimeout;
        //if (tableConstructor == null)
        //{
        //    tableConstructor = CreateTableConstructorForTable();
        //}

        //tableConstructor(this as TDatabase);
    } 
```

我想这不是最好的解决方案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-08T08:45:29.453

你需要破解彩虹源才能让它工作。在DataBase.cs 文件中找到`CreateTableConstructor`方法。只需添加一些代码如下：

```
...
var setters = GetType().GetProperties()
    .Where(p => p.GetValue(this, null) == null 
             && p.PropertyType.IsGenericType 
             && p.PropertyType.GetGenericTypeDefinition() == tableType)
    .Select... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-28T11:45:28.120

对于像我一样被这篇文章绊倒的其他人，现在在 Dapper.Rainbow 0.1.3 版中已修复。

它目前仍处于测试阶段（0.1.3-beta1），因此如果您想使用模式，您可以克隆/分叉存储库并运行构建脚本。然后可以直接使用或打包二进制输出。

至于表设置，您需要使用该特定表的模式名称来定义表名，例如查看这个没有模式的示例

```
 public class MyDatabase : Database<MyDatabase>
    {
        public Table<Order> Order{ get; set; }
        public Table<Customer> Customer { get; set; }
        public Table<Item> Item { get; set; }
    } 
```

如果您仅使用 dbo，则该方法有效。但是，例如，如果您对 Item 使用说 Product 模式，则必须使用构造函数来定义它

```
 public class MyDatabase : Database<MyDatabase>
    {
        public Table<Order> Order{ get; set; }
        public Table<Customer> Customer{ get; set; }
        public Table<Item> Item;

        public MyDatabase()
        {
            Item = new Table<Item>(this, "Product.Item");
        }
    } 
```

其余的应该和以前一样

```
 using (var connection = DbConnections.Create())
     {
            connection.Open();
            var db = MyDatabase.Init((DbConnection)connection, commandTimeout: 2);
            var insert = db.Customer.Insert(
            // .
            //..... your object
            // .
            );
            var insertId = insert.Value;
     } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-29T21:54:51.890

根据@Acorax 的回答，这对我来说还不够，我需要在模式和表名中添加括号来解决这个问题。

所以这解决了我的架构问题：

```
public class MyDatabase : Database<MyDatabase>
{
    public Table<Item> Items;

    public HamenasDbSchema()
    {
        Items = new Table<User>(this, "[Schema].[Items]");
    }
} 
```

# html - 如何使用插入的数据在 tr 中的 td 上放置动态宽度

> ID：12424096
> 
> 赞同：-1
> 
> 时间：2012-09-14T11:57:44.070
> 
> 标签：html, css, html-table

我正在使用宽度为 100% 的表格，并且我的表格行包含两个表格数据，如下所示：

```
<table width="100%" border="1" >
    <tr>
      <td style="width:150px;" class="fontbold fontgrey">Data1 :<span class="fontdgrey">Rs. </span></td>
      <td width="15">&#160;</td>
      <td style="width:200px;" class="fontbold fontgrey">Data2 :<span class="fontdgrey">Rs. </span></td>

    </tr>
</table> 
```

它的输出是这样的：

**数据 1 卢比。数据 2 卢比。**

这对我来说很好，但如果我增加文本长度，它就不会像这样以正确的格式出现

**InsertedNewData InsertedNewData2
Rs Rs。**

所以我想动态增加 td 宽度，用单行插入其中的内容，如下所示：

**InsertedNewData Rs.100000 InsertedNewData2 卢比。1000000**

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T17:39:45.103

删除`style='width:150px;`and`style='width:250px` 并且 td 元素变为动态的，因为您的表格元素宽度为 100%

# c# - 如何允许与 Dynamics 服务器的一般连接

> ID：12424107
> 
> 赞同：2
> 
> 时间：2012-09-14T11:58:09.107
> 
> 标签：c#, dynamics-crm, outlook-addin

最后，我已经完成了以我想要的方式**完全****按照**我想要的方式创建的附加组件。只剩下一个问题。目前，该软件进入*组织*并使用静态硬编码到程序中的*凭证。*

我有一种预感，我的一些客户可能会将他们的组织命名为“ *Hazaa Inc. #1-5* ”以外的其他名称，他们可能会被称为“ *CRMK.local\Konrad* ”以外的其他名称，他们甚至有可能选择不同的名称密码比我（虽然“abc123”显然相当普遍）。

那么，问题来了——如何使我的解决方案通用？

我相信只要我正确输入下面的代码，我就完成了。

```
using (OrganizationServiceProxy proxy 
  = new OrganizationServiceProxy(
    organizationUri, 
    homeRealmUri, 
    credentials, 
    deviceCredentials)) 
```

我从 CRM Dynamics 的“设置”中手动复制的当前登录字符串，但在这里还不够。我需要以动态**和**编程方式获取它。此外，即使我知道组织的名称，我也需要确定它是 CRM 4.0 还是 CRM 2011，如果我们在谈论在线/假设用户名和密码是什么等。

简单地要求用户提供该信息是更好的解决方案，还是建议*自动神奇地*这样做（就用户体验而言）？这是我第一次，所以大多数东西都让人感到恐惧和困惑。我看过一些代码示例，但这让我很快又回到了恐惧和困惑中。

编辑：

我已遵循[此代码](http://msdn.microsoft.com/en-us/library/hh675400.aspx)，但我根本不明白。例如`ServerConnection`，我什至不知道在哪里可以找到。我尝试在 SDK 中添加对不同`Xrm`和`Crm`包的引用，但这比实际开发更像是一种试验和恐怖。感觉就像我错过了一些（相当）明显的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:29:20.823

如有疑问，请询问用户而不是试图猜测：如果您的假设是错误的，您可能会不情愿地破坏某些东西。

还有一些想法：

*   Online vs. On-Premise 有[可能会破坏功能的限制](http://community.dynamics.com/product/crm/crmtechnical/b/lostinthoughtsofcrm/archive/2012/03/17/microsoft-dynamics-crm-2011-limitations-of-dynamics-crm-online-vs-on-premises.aspx)。如果您需要同时兼顾两者，请专注于在线。换句话说，如果它在线工作，它就可以在本地工作，但如果它在内部工作，它*可能*无法在线工作。
*   与 4.0 相比， CRM 2011 提供了许多[创新](http://www.google.it/url?sa=t&rct=j&q=&esrc=s&source=web&cd=5&cad=rja&ved=0CFAQFjAE&url=http%3A%2F%2Fblogs.msdn.com%2Fb%2Fcrm%2Farchive%2F2011%2F04%2F11%2Fwhat-s-new-in-microsoft-dynamics-crm-2011.aspx&ei=ATFTUMzBKLOL4gTW-4GIDw&usg=AFQjCNFTv3-NvbDKVyQeKB-YgpkZEprPkA&sig2=ZIIbzI5Ord3Ws4yJvvdX3Q)，代码确实应该是分支的，因此您在一个项目中坚持旧样式并在另一个项目中利用所有新功能。仅解决方案管理就值得完全放弃 4.0 支持。

# javascript - 如果元素的 ID 以数字开头怎么办

> ID：12424108
> 
> 赞同：0
> 
> 时间：2012-09-14T11:58:15.797
> 
> 标签：javascript, html

> **可能重复：**
> [为什么我不能将数值作为元素的 ID？](https://stackoverflow.com/questions/7987636/why-cant-i-have-a-numeric-value-as-the-id-of-an-element)

元素的 ID 必须以字母 ([A-Za-z]) 开头。但是如果我做类似的事情

```
<td id='9'></td> 
```

javascript 可以找到这样的元素。所以我不明白为什么我不能以数字开头

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:00:22.943

该标准规定 ID 必须以字母开头。如果浏览器（或者更确切地说是 JavaScript 引擎）选择忽略该要求，那么情况就是如此。浏览器真的很宽容...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:02:30.200

如果您偏离规范，您将面临代码无法在决定更严格地遵循规范的浏览器中运行的风险，而不是您正在使用的浏览器。

这可能很好，但这似乎是不必要的风险，因为您可以通过在数字前加上一些固定字符串并维护“数字”id 的语义来避免任何此类问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:02:01.007

HTML 4 确实规范了

> ID 和 NAME 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_") , 冒号 (":") 和句点 (".")。

很长一段时间以来，浏览器都采用了[更为宽松的 HTML5 规范](http://www.w3.org/TR/html-markup/global-attributes.html#common.attrs.id)，即使它仍然不是官方规范：

> 任何字符串，具有以下限制：
> 
> *   必须至少有一个字符长
> *   不得包含任何空格字符

但要小心，因为如果不遵守 HTML4 规范，您可能会在使用旧版浏览器时遇到问题。另请注意，在大多数语言中，程序员都习惯于“通常的 id”，这更像是 HTML4 中的。通过使用“不寻常的” id，您会冒（不是很大）遇到无法处理它们的库的风险。

# cuda - CUDA应用的计算能力会自动升级吗？

> ID：12424110
> 
> 赞同：7
> 
> 时间：2012-09-14T11:58:42.160
> 
> 标签：cuda, nvcc

如果我编译具有较低计算能力的 CUDA 程序，例如 1.3（nvcc 标志 sm_13），并在具有 Compute Capability 2.1 的设备上运行它，它会利用 Compute 2.1 的功能吗？

在那种情况下，计算 2.1 设备的行为会像计算 1.3 设备一样吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T12:19:29.310

不，它不会利用您需要明确编程的任何功能。只有那些对用户透明的特性（如缓存或更大的寄存器文件）才会被使用。

此外，您需要确保您的目标文件包含编译为 PTX 中间语言的代码版本，该版本可以动态编译为目标架构，否则您的程序甚至无法运行。

编译为虚拟架构 ( `nvcc -arch compute_13`) 以确保这一点，或者使用`-gencode`nvcc 选项为多个架构创建包含代码的胖二进制文件。

使用胖二进制文件，如果将代码包装在`#if __CUDA_ARCH__ >= xyz`预处理器条件中，则可以针对仅在更高计算能力上可用的功能进行编程。

# solr - Solr indexversion 和可复制索引版本不同

> ID：12424111
> 
> 赞同：2
> 
> 时间：2012-09-14T11:58:45.717
> 
> 标签：solr, replication, solrj, master, slave

我正在使用 solrJ 将文档添加到 solr 服务器。我有一个主/从设置。建立索引后，我进行提交，`http://URL/update?commit=true`以便能够在主节点中进行搜索。但是对于复制，当我使用 replication?command=details 查看 indexversion 详细信息时，我看到 indexverion 和可复制索引版本是不同的。

```
`<arr name="commits">
<lst>
<long name="indexVersion">1346928051888</long>
<long name="generation">1907</long>
<arr name="filelist"></arr>
</lst>
</arr>
<str name="isMaster">true</str>
<str name="isSlave">false</str>
<long name="indexVersion">1346928051888</long>
<long name="generation">1907</long>
<lst name="master"><arr name="replicateAfter"><str>commit</str>
<str>startup</str></arr>
<str name="replicationEnabled">true</str>
<long name="replicatableIndexVersion">1346928046763</long>
<long name="replicatableGeneration">1</long></lst>
</lst>`

Because of this the slave is not replicating the commited document.

Here is the code i used for solrJ to add documents
Collection<SolrInputDocument> docs = new ArrayList<SolrInputDocument>();
SolrInputDocument doc = new SolrInputDocument();
doc.add(FIELDS);
docs.add(doc);

SolrInputDocument doc = new SolrInputDocument();
doc.add(FIELDS);
docs.add(doc);

SolrInputDocument doc = new SolrInputDocument();
doc.add(FIELDS);
docs.add(doc);

server.add(docs);
server.commit(); 
```

我在这里有什么遗漏吗？非常感谢任何帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-03T03:44:11.997

我会尽量避免在提交和启动后将复制放在一起。这会导致一些问题 仅在提交后尝试复制。

```
<requestHandler name="/replication" class="solr.ReplicationHandler" >
    <lst name="master">

        <str name="replicateAfter">commit</str>     
        <str name="confFiles">schema.xml,stopwords.txt,elevate.xml</str>
        <str name="commitReserveDuration">00:00:10</str>
    </lst>
     <str name="maxNumberOfBackups">1</str> 
</requestHandler> 
```

它是这样工作的吗？

# java - com.ctc.wstx.exc.WstxUnexpectedCharException：非法字符（（CTRL-CHAR，代码 15））

> ID：12424112
> 
> 赞同：2
> 
> 时间：2012-09-14T11:58:53.990
> 
> 标签：java, xml-parsing, axiom

我正在使用公理从 XML 中提取数据。
但是由于在 XML 中有 CTRL-CHAR（例如：â、€、¢、“、”、™、'、- 等），我遇到了错误。
任何机构都可以帮我替换所有 CTRL-SHAR 以避免上述错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-23T09:05:23.413

目前我在这种情况下使用以下方法。但我认为一定有比这更好的方法。

```
public static String removeNonUtf8CompliantCharacters( final String inString ) {
        if (null == inString ) return null;
        byte[] byteArr = inString.getBytes();
        for ( int i=0; i < byteArr.length; i++ ) {
            byte ch= byteArr[i]; 
            // remove any characters outside the valid UTF-8 range as well as all control characters
            if ( !(ch < 0x00FD && ch > 0x001F) || ch =='&' || ch=='#') {
                byteArr[i]=' ';
            }
        }
        return new String( byteArr );
    } 
```

# c# - 我可以让枚举返回整数以外的东西吗？

> ID：12424115
> 
> 赞同：-1
> 
> 时间：2012-09-14T11:58:58.450
> 
> 标签：c#

如果我有以下情况：

```
public enum TYPE
{
   One = 1,
   Two = 2,
   Three = 3
} 
```

当我做：

```
 var a = TYPE.One; 
```

我希望它用**"01" 格式**的字符串填充变量 a 。换句话说，两个数字前导零。

是否可以通过为 SomeEnum 分配一些方法来做到这一点？我意识到我可以使用 TYPE.One.ToString("00") 但我希望它在枚举中自包含并且使用起来非常简单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:10:47.703

可以做这样的事情：

```
public static class Ext {

    public static string ToMyString(this Enumer en ) {
         return ((int)en).ToString("00");
    }
} 
```

并在使用后像：

```
public enum TYPE { One = 1, Two = 2, Three = 3 }
Type t = TYPE.One; 

string s = t.ToMyString(); 
```

是的，从概念上讲，它与声明字符串相同，但它隐藏在扩展方法中。

其他解决方案是：在这一点上简单地避免以这种`enums`方式使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:12:46.560

您可以使用 description 属性向每个枚举元素添加一个字符串。

例如

```
public Enum MyEnum
{
    [Description("Value A Description")]
    ValueA,
    [Description[("Value B Description")]
    ValueB
} 
```

要检索描述值，请使用扩展器类

```
public static class MyEnumExtender
{
    public static string Description(this Enum Value)
    {
        FieldInfo FI = Value.GetType().GetField(Value.ToString());
        IEnumerable<DescriptionAttribute> Attributes = FI.GetCustomAttributes(typeof(DescriptionAttribute), false).Cast<DescriptionAttribute>();
        return (Attributes.Any()) ? Attributes.First().Description : Value.ToString();
    }
}

....

MyEnum EnumVar = MyEnum.ValueA;
string Description = EnumVar.Description(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:00:58.150

不要为此使用枚举，而是使用字典或哈希之类的东西。当存在一组有限的可能性并且您不想要或不需要值时，枚举就在那里。它如何存储无关紧要。

# c# - 使用反射时将新版本/修复替换为 dll

> ID：12424116
> 
> 赞同：2
> 
> 时间：2012-09-14T11:59:00.087
> 
> 标签：c#, .net

我们使用反射在 wcf 中创建了一个可扩展项目。Web 服务在运行时加载不同的模块取决于输入请求。我们使用 .NET 反射来动态加载模块库。系统在 IIS 上运行。

在我们的测试中，我们注意到一旦通过反射加载，我们就无法替换现有的 dll。我们试图将我们的新 dll 复制到 bin 目录中，但我们收到类似于“应用程序使用的 dll”的错误，我们可以确保它只有我们的系统使用该 dll。但是替换 dll 可能会停止 IIS。但是我们需要在不停止 IIS 的情况下替换 dll。无论如何我们可以在代码级别处理这个吗？

感谢您的快速反应。

```
IOrder orderImpl = null;

try
{

string path = Path.GetDirectoryName(Assembly.GetExecutingAssembly().GetName().CodeBase) + "\\" + assemInfo.AssemblyQualifiedName + ".dll";
path = path.Replace("file:\\", "");
Assembly a = Assembly.LoadFile(path);

Type commandType = a.GetType(assemInfo.AssemblyQualifiedName + "." + assemInfo.ClassName);

orderImpl = (IOrder)commandType.GetConstructor(new System.Type[] { typeof(LocalOrderRequest) }).Invoke(new object[] { order });

}
catch (Exception ex)
{
throw new OrderImplException("-1", ex.Message);
} 
```

感谢无国界医生

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:07:32.997

我将从您的问题中做出两个假设：1）正常运行时间对您的应用程序至关重要，这就是为什么它不能关闭 30 秒来更新它的原因；2) 它不在容错、负载平衡的农场中。

如果是这种情况，那么解决 #2 也将解决如何在不停机的情况下更新 DLL。

对于无法在几秒钟内关闭以更新 DLL 的应用程序，您应该拥有支持所需稳定性的基础架构。意外中断的风险远大于更新应用程序的影响。

如果其中一台服务器出现故障，您应该在负载均衡器后面拥有多台服务器，以提供容错路由。

通过这样做，您可以最大限度地减少因故障而停机的风险，并且您可以通过关闭一个节点上的 IIS、更新它然后重新启动来更新 DLL。负载平衡将识别节点已关闭并将流量路由到良好节点，直到更新的节点再次可用。对其他节点重复此操作，您已经更新了您的应用程序而没有停机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:06:00.567

您可以尝试创建自己的 AppDomain，然后从那里加载/卸载程序集。这是一篇关于此的文章：http: [//people.oregonstate.edu/~reeset/blog/archives/466](http://people.oregonstate.edu/~reeset/blog/archives/466)

# php - Facebook PHP SDK 适用于 Firefox，但不适用于 Chrome

> ID：12424118
> 
> 赞同：1
> 
> 时间：2012-09-14T11:59:05.360
> 
> 标签：php, facebook, firefox, google-chrome

这个问题一开始可能听起来有点沉闷，我自己也很困惑。我正在开发一个严重依赖 Facebook API 的 PHP 应用程序，因此使用 PHP SDK 连接并通过以下方式获取当前登录的用户

```
$fb->getUser(); 
```

我还包括了 Javascript SDK，但它目前只获取登录用户并将他们的数据对象打印到控制台。

今天我开始实现该应用程序的本地开发版本，在 Facebook 上设置了第二个开发应用程序，将它们连接起来，瞧……它不起作用。getUser() 在本地总是为我返回 0。我刚刚发现它可以在 Firefox 中运行。我 var_dump getUser() 值，并在 Firefox 中收到完整的用户 ID（我的），但在 Chrome 中为 0（是的，我在两个浏览器上都登录了 Facebook）。

我清除了缓存、cookies、销毁了会话。我只是无法想象浏览器对 Facebook 的 PHP 请求有什么不同？有没有人经历过这样的事情？显然 app_key 和 secret 必须正确，因为它适用于 Firefox。

* * *

编辑：仅供参考，应用程序的实时版本（托管）在 Chrome 中运行良好，只有这个非常本地的应用程序我无法工作。

* * *

编辑#2：这是我在应用程序上运行的 Javascript

```
 <div id="fb-root"></div>
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : {$_connect.app_id}, // App ID
        channelUrl : '{$_connect.channel_file}', // Channel File
        status     : true, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        xfbml      : true  // parse XFBML
      });
    {if !$_user.is_authorized}
    // listen for and handle auth.statusChange events
    FB.Event.subscribe('auth.statusChange', function(response) {
      if (response.authResponse) {
        // user has auth'd your app and is logged into Facebook
        FB.api('/me', function(me){
          if (me.name) {
            console.log(me);
            //window.location = 'index.php';
            // redirection is currently causing loop
          }
        })
      } else {}
    });
    {/if}
    };
    // Load the SDK Asynchronously
    (function(d){
       var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement('script'); js.id = id; js.async = true;
       js.src = "//connect.facebook.net/de_DE/all.js";
       ref.parentNode.insertBefore(js, ref);
     }(document));
  </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:10:28.407

> 我只是无法想象浏览器对 Facebook 的 PHP 请求有什么不同？

当然，唯一的可能是参数。

在这种情况下，很可能是 cookie——Facebook 在成功登录时设置的 cookie，浏览器必须*接受*并发送回服务器，以便 PHP SDK 能够识别登录的用户。

因此，当您在本地测试您的应用程序时，请检查您的 Chrome 是否接受这些 cookie。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T14:00:55.263

我认为，您还需要在两个浏览器中通过 JS SDK 进行身份验证，我相信 JavaScript 请求背后有一些 OAuth 逻辑。

然而，现在的 Chrome 试图阻止或干脆不执行跨域 js 请求。如果您遇到类似的情况，请尝试查看网络控制台。如果确实如此

*   尝试检查本地环境的域 + 协议 /http(s)/。我相信你应该在调用 js api 时使用 https
*   考虑使用通道文件，它应该可以解决/防止这些跨浏览器调用问题，如[JavaScript SDK 文档中所述](https://developers.facebook.com/docs/reference/javascript/)

如果上面没有任何帮助您，我想您可以开发应用程序，在 FFox 上对其进行测试，然后在部署后使用真实设置对其进行测试。

祝你好运。

# perl - CGI 上传创建空文件

> ID：12424119
> 
> 赞同：0
> 
> 时间：2012-09-14T11:59:18.517
> 
> 标签：perl, upload, cgi

您好我正在尝试使用 CGI 上传文件，虽然 CGI 脚本运行，但创建的文件是空的。

我有一个 html 文件，它获取文件名并将其传递给 cgi 脚本：

```
<html>
<body>

<form enctype="multipart/form-data" action="cgi-bin/upload.pl" method="POST">
<input type="FILE" name="file">
<input type="submit">
</form>

</body>
</html> 
```

cgi脚本如下：

```
#!/usr/bin/perl -w

use strict;
use CGI::Carp qw(fatalsToBrowser warningsToBrowser);
use CGI;

print "Content-type: text/html\n\n";

my $cgi = new CGI;
my $dir = 'sub';

my $name = $cgi->param('file');
print "name: $name <br />\n";
open(LOCAL, ">$dir/$name") or die "error: failed to open $dir/$name\n";
my $file_handle = $cgi->upload('file');
die "file_handle not defined\n" unless(defined($file_handle));
while(<$file_handle>) {
    print $_;
    print LOCAL $_;
}
close($file_handle);
close(LOCAL);

print "done\n"; 
```

cgi 脚本运行正常，不产生警告，设法创建本地文件并正确获取远程文件名。但是，该脚本似乎没有从文件中读取任何数据或将任何数据写入本地文件，该文件是空的。

我肯定会上传一个包含多行数据的文件，但 cgi 脚本的输出如下：

```
 name: tmp.txt 
   done 
```

非常感谢任何帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T14:42:16.390

您可能想尝试`binmode`在 FH 上使用该命令。

*这是一个 Perl 脚本，我将其用作上传文件（显示表单并*进行上传）的 CGI 表单的起点：

```
#!/usr/bin/perl

use strict;
use warnings;

use POSIX;
use CGI::Pretty qw(:standard -any -no_xhtml -oldstyle_urls *center);
use CGI::Carp qw(fatalsToBrowser set_message);

use Upload;

# Constants
my $FILE_DIR_INTERNAL = 'Z:\webroot\tmp';

# Variables
my $ACTION = param('action') || "";

if (! $ACTION) { UploadForm() }
elsif ($ACTION eq "UploadFile") {
  my $file = UploadFile($FILE_DIR_INTERNAL, 1);
  print "File uploaded to $file\n<pre>";
  open(F, "$file");
  while(<F>) { print }
  close(F);
} 
```

这是该脚本使用的 Perl 模块：

```
package Upload;

use strict;
use warnings;
use POSIX;
use File::Copy;
use CGI::Pretty qw(:standard -any -no_xhtml -oldstyle_urls *center);
use CGI::Carp qw(fatalsToBrowser); # supposed to echo STDERR to browser, too

use Exporter;
our $VERSION = do{ q$Revision: 1.5 $ =~ /(\d+)\.(\d*)([^ ]*)/; sprintf "%d.%02d%s", $1, $2, $3; };
our @ISA = qw(Exporter);
our @EXPORT = qw(UploadForm UploadFile);

my $FILE_UPLOAD_PARAM = "fileUploaded";

# *************************************************************************
# FUNCTION: UploadForm
# ARGUMENTS:    
# RETURNS:  
# NOTES:    This subroutine displays the upload form.
# *************************************************************************
sub UploadForm {

  print start_center;
  print p("Upload a file from your computer:");

  # Normally, I use the "get" method for forms (params show up in URL),
  # but "post" is required for uploading files!
  # Using "post" also requires that we pass parameters thru the hidden()
  # commands down below, instead of in the URL.
  print start_multipart_form({-method=>"post", -action=>script_name});
  print filefield($FILE_UPLOAD_PARAM,"",50) . "\n";

  # Hidden parameters are "sticky", so modify the existing "action" param,
  # before trying to insert a new hidden "action" param.
  # If you don't, CGI.pm will re-use the current "action" param.
  param("action", "UploadFile");
  print hidden("action") . "\n";

  print p(submit("", "Upload File"));
  print end_form;

  print end_center;

}

# *************************************************************************
# FUNCTION: UploadFile
# ARGUMENTS:    
# RETURNS:  
# NOTES:    This subroutine handles data "posted" thru the form
#       created in UploadForm().
# *************************************************************************
sub UploadFile {

  my $dir = shift || die "ERROR!  No arg passed to UploadFile().\n";
  my $overwrite = shift || 0;

  my $TEMP_FH;

  # The upload() function returns the filename and a file handle.  See CGI.pm.
  $_= $TEMP_FH = upload($FILE_UPLOAD_PARAM);

  # What do all the regexes do?  I wrote them, but I forgot.  I think they
  # strip off any path information (common in IE!) to get just the filename.
  s/\w://;
  s/([^\/\\]+)$//;
  $_ = $1;
  s/\.\.+//g;
  s/\s+//g;
  my $filename = $_;
  my $serverFullFilename = "$dir/$filename";

  if (! $filename) {
    DisplayErrorPage("Illegal filename: '$filename'");
  }

  if ((! $overwrite) && (-e $serverFullFilename)) {
    die "Unable to upload file.  File '$filename' already exists.";
  }

  open(SERVER_FH,">$serverFullFilename") || die "Error opening $filename for writing.";
  binmode SERVER_FH;

  # Copy the file from the temp dir to the final location.
  while (<$TEMP_FH>) {
    print SERVER_FH;
  }

  close(SERVER_FH);
  close($TEMP_FH);

  if ((stat $serverFullFilename)[7] <= 0) {
    unlink $serverFullFilename;
    die "Unable to upload file '$filename'.  This is usually due to the user specifying an invalid or unreadable file on the user's computer.";
  }

  return $serverFullFilename;
} 

return 1; 
```

请原谅任何不一致之处，因为我不得不剪掉一些特定于站点的东西，但如果我正确地修剪它，那应该可以“开箱即用”

# android-intent - 隐含意图

> ID：12424124
> 
> 赞同：1
> 
> 时间：2012-09-14T11:59:48.463
> 
> 标签：android-intent

我是安卓新手。我从

[http://saigeethamn.blogspot.in/2009/08/android-developer-tutorial-for_26.html](http://saigeethamn.blogspot.in/2009/08/android-developer-tutorial-for_26.html)

现在我的问题是我可以通过隐式意图在此应用程序中调用我的另一个应用程序作为活动之一吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T06:07:18.290

是的你可以。例如，当您想从一个应用程序共享图像到另一个应用程序时，您必须在第二个应用程序中注册，该应用程序在第二个应用程序的清单文件中接收意图。额外的意图过滤器如下

```
 <activity
        android:name=".Main"
          android:label="@string/app_name" android:screenOrientation="portrait"
         android:theme="@android:style/Theme.Black.NoTitleBar">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
        **<intent-filter>
            <action android:name="android.intent.action.SEND" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
        <data android:mimeType="image/*" />
        **
    </activity> 
```

然后 onCreate 已经具有图像视图视图的第二个应用程序

```
ImageView im = (ImageView) findViewById(R.id.image);
im.setImageURI((Uri) getIntent().getExtras.get(Intent.EXTRA_STREAM)); 
```

这意味着当您在清单文件中声明意图过滤器时，只要有人分享图片，您的第二个应用程序就会出现在可用列表中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-10T10:53:25.780

是的，你可以做到。

隐式意图不命名特定组件，而是声明要执行的一般操作，允许来自另一个应用程序的组件处理它。例如，如果您想向用户显示地图上的位置，您可以使用隐式意图来请求另一个有能力的应用程序在地图上显示指定位置。

您的活动向 ActivityManager（它是操作系统的一部分）发送请求，然后 ActivityManager 从另一个应用程序请求活动，然后响应从被调用应用程序发送到调用应用程序。

# ios5 - 如何在opengl中只清除一些纹理

> ID：12424126
> 
> 赞同：0
> 
> 时间：2012-09-14T11:59:49.527
> 
> 标签：ios5, opengl-es

假设我在opengl中做了五次不同纹理的笔画。现在我想清除所有我想保留的四个纹理，因为它只剩下一个纹理。我该怎么做。当我使用 glClear() 时，它会删除所有内容。我不能使用 glScissor，因为纹理位置可以相同。我怎样才能做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:18:53.527

您可以使用以下方法创建精确的纹理：

```
GLuint index=x;
glGenTextures(1, &index);
glBindTexture(GL_TEXTURE_2D, index);
glTexImage2D... 
```

并删除相同的纹理：

```
glDeleteTextures(1, &index); 
```

现在，您无需在渲染过程中删除纹理，只需为所需的笔画使用适当的纹理索引即可。使用相同的网格，只是在渲染顶点时改变纹理索引。

# mysql - 如何使用 GROUP BY 子句过滤 SQL 查询

> ID：12424127
> 
> 赞同：2
> 
> 时间：2012-09-14T11:59:50.070
> 
> 标签：mysql, sql

我正在尝试为消息传递系统制定一个 SQL 查询，该查询将返回所有线程的列表，这些线程的状态为“OPEN”，并且其最后一条消息不是由某个组中的用户发布的。

查询中涉及的表有：

```
threads
-------
threadId
timestamp
subject
status
clientId

messages
--------
messageId
userId
messagebody
timestamp
threadId

users
-----
userId
username
groupId 
```

当前查询是：

```
SELECT threadId, timestamp, subject, status, clientId 
FROM threads
WHERE status='OPEN' 
ORDER BY timestamp DESC 
```

效果很好；但我现在有一个新要求 - 如果线程中的最后一条消息是由 a`groupId`为 1 的用户发布的，那么它不应该在结果集中。

包括我需要的信息很简单：

```
SELECT threadId, timestamp, subject, status, clientId 
FROM threads
INNER JOIN messages USING(threadId)
INNER JOIN users USING(userId)
WHERE status='OPEN' 
GROUP BY threadId
ORDER BY timestamp DESC 
```

但此时我被卡住了，因为我不知道如何让查询根据特定组`messages.userId`中最高的线程来过滤掉线程。`timestamp`我已经查看了`HAVING`所有聚合函数，但似乎没有任何内容符合要求。

**编辑**

我可能不够清楚，所以我将尝试用一个例子来说明。

以下是一些示例数据：

**线程**

```
threadId | timestamp | subject | status | clientId
--------------------------------------------------
1        | 1         | One     | OPEN   | 1
2        | 10        | Two     | OPEN   | 4
3        | 26        | Three   | OPEN   | 19
4        | 198       | Four    | OPEN   | 100 
```

**消息**

```
messageId | userId | messagebody | timestamp | threadId
-------------------------------------------------------
1         | 3      | Hello, World| 1         | 1
2         | 1      | Hello       | 3         | 1
3         | 1      | ^&%&6       | 10        | 2
4         | 2      | Test        | 12        | 2
5         | 4      | Hi mum      | 26        | 3
6         | 1      | More tests  | 100       | 4 
```

**用户**

```
userId | username | groupId
---------------------------
1      | Gareth   | 1
2      | JimBob   | 2
3      | BillyBob | 2
4      | Bod      | 3 
```

在此示例数据集线程 1 和 4 应从查询中删除，因为用户`Gareth`（组 1 的成员）是最后一个发布到它们的人（threadId 1 中的 messageId 2，threadId 4 中的 messageId 5）。所以结果集应该只有线程 2 和 3 的线程数据（threadId、timestamp、subject、status 和 clientId）。

我为此测试数据创建了一个[SQLfiddle 。](http://sqlfiddle.com/#!2/b9d86)

谁能在这里指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:05:26.703

听起来你想要这个：

```
SELECT threadId, timestamp, subject, status, clientId 
FROM threads t
INNER JOIN messages m
  ON t.threadId = m.threadId
INNER JOIN users u
  ON m.userId = u.userId
  and u.groupId != 1  --placed the groupId filter here.
WHERE status='OPEN' 
GROUP BY threadId
ORDER BY timestamp DESC 
```

编辑，这似乎给了你你需要的东西：

```
SELECT t.threadId, 
  t.timestamp, 
  t.subject, 
  t.status, 
  t.clientId
FROM threads t
INNER JOIN messages m
  ON t.threadId = m.threadId
INNER JOIN users u
  ON m.userId = u.userId
WHERE status='OPEN' 
  AND NOT EXISTS (select t1.threadid
                  FROM threads t1
                  INNER JOIN messages m
                    ON t1.threadId = m.threadId
                  INNER JOIN users u
                    ON m.userId = u.userId
                  where u.groupid = 1
                     and t.threadid = t1.threadid)
ORDER BY timestamp DESC 
```

# 见[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/b83e6/15)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:03:32.860

~~添加`LIMIT 1`到您的查询中是否可以解决您的问题？~~

 ~~```
SELECT threadId, timestamp, subject, status, clientId  
FROM threads 
INNER JOIN messages USING(threadId) 
INNER JOIN users USING(userId) 
WHERE status='OPEN'  
GROUP BY threadId 
ORDER BY timestamp DESC 
LIMIT 1 
```~~ 

或将 where 子句更改为

```
WHERE status='OPEN' and groupID<>1 
```

 ~~我想这就是你想要的？

```
select * from threads
where threadId not in
(
    select messages.threadId
    from messages
        inner join (select threadId, MAX(timestamp) maxtime from messages group by threadId) t
            on messages.threadId = t.threadId
            and messages.timestamp = t.maxtime
    where messages.userId=1
) 
```~~

# cocoa - 视觉格式语言 - 填充区域

> ID：12424129
> 
> 赞同：1
> 
> 时间：2012-09-14T12:00:01.137
> 
> 标签：cocoa, constraints, autolayout

我有几个大小是静态的对象，它们紧贴屏幕的顶部和底部。但是，屏幕中间有一个空白区域，我想通过方向更改来拉伸它。

我通过添加一个可以拉伸的额外清晰视图 [paddedView] 解决了一个问题，但我想知道是否有更简单的方法可以在没有 paddedView 的情况下仅使用 Visual Format Language 来做到这一点。

```
@"V:|-20-[topLabel(40)]-15-[anotherTopLabel(40)]-[paddedView]-[bottomView(73)]|"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:59:14.127

除了仅用于填充的视图，您可以指定距离的较低优先级或将约束指定为“大于或等于”。

由于您想要的是一个灵活的空间，因此最后一个选项听起来是最好的：

```
@"V:|-20-[topLabel(40)]-15-[anotherTopLabel(40)]-(>=15)-[bottomView(73)]|" 
```

这个数字`15`当然只是一个例子。

# php - 使用 preg_replace 从 html 中删除输入大小

> ID：12424131
> 
> 赞同：1
> 
> 时间：2012-09-14T12:00:07.310
> 
> 标签：php, parsing, preg-replace

我正在使用简单的 HTML DOM 解析器，通过这个我可以从下面的对象片段中获取所有输入标签

```
foreach ($InputObj->find('input') as $e) {

    $inputTag =  $e->outertext;

   // now I want to check if input element have size attribute then remove it with preg_replace
   $inputTagsSizeStrip = preg_replace('~\<input[^\s]*size=\'|\"[^\'|\"]~is', "" , $inputTag);
} 
```

但没有成功....

任何帮助都会得到帮助...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:02:44.843

这里没有理由使用正则表达式。您已经拥有 DOM，只需进行必要的操作：

```
foreach ($InputObj->find('input') as $e) {
  if ($e->hasAttribute('size')) {
    $e->removeAttribute('size');
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:13:39.697

你已经在输入标签中，所以不需要去输入标签来搜索尺寸使用这个 preg 它会找到尺寸并删除它

```
 foreach ($InputObj->find('input') as $e) {  
       $inputTagsSizeStrip = preg_replace('~(size=(\"|\')[^\'|\"]*(\"|\'))~is', $changeSrc , $inputTagsSizeStrip);
 } 
```

它肯定会奏效

# android - 如何在 android 2.3+ 上找出电话何时开始和停止？

> ID：12424133
> 
> 赞同：1
> 
> 时间：2012-09-14T12:00:09.700
> 
> 标签：android, phone-call

我需要我的应用程序来查明电话通话的时间。

当另一部电话被呼叫以及接听电话时，它应该可以工作。我只需要我的应用程序在连接开始和停止时得到确切的通知（而不是拨号、响铃等）。

这有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:05:43.513

您可以使用广播类来实现这一点，如下所示：

```
public class PhoneStateBroadcastReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {

    TelephonyManager telephonyManager = (TelephonyManager) context
            .getSystemService(Context.TELEPHONY_SERVICE);
    telephonyManager.listen(new CustomPhoneStateListener(context),
            PhoneStateListener.LISTEN_CALL_STATE);
    }
}

class CustomPhoneStateListener extends PhoneStateListener {

    // private static final String TAG = "PhoneStateChanged";
    Context context; // Context to make Toast if required

    public CustomPhoneStateListener(Context context) {
        super();
        this.context = context;
    }

    @Override
    public void onCallStateChanged(int state, String incomingNumber) {

        super.onCallStateChanged(state, incomingNumber);
        switch (state) {

        case TelephonyManager.CALL_STATE_IDLE:
            //WHEN PHONE WILL BE IDLE       
        break;

        case TelephonyManager.CALL_STATE_OFFHOOK:
            // when Off hook i.e in call
        break;

        case TelephonyManager.CALL_STATE_RINGING:
            // when Ringing
        break;

        default:
        break;
        }
    }
} 
```

希望这会帮助你。

# knitr - latex knitr chunk echo=FALSE 破坏 par() 设置

> ID：12424135
> 
> 赞同：3
> 
> 时间：2012-09-14T12:00:17.143
> 
> 标签：knitr

我是 latex 和 knitr 的新手，当我使用 echo=FALSE 时，R 块的输出存在问题。下面的 .Rnw 代码按预期工作，即输出有

```
 1\. some code
    2\. a block of figures arranged 2 x 3
    3\. some more code
    4\. a block of figures arranged 2 x 3 
```

但是更改块开口以从输出中消除代码块

`<<bghist2_mas_rma, fig.height=4, fig.width=6, echo=FALSE>>=`

不仅从输出中删除代码（好），而且还覆盖 par() 设置，使得两个图形（每个 2 x 3）在页面上相邻放置，第二个图形的大部分从边缘脱落。

除了简单地将代码留在输出中之外，我怎么能解决这个问题？

谢谢

乙

```
\newpage
<<bghist2_mas_rma, fig.height=4, fig.width=6, echo=TRUE>>=
par(mfrow=c(2,3))
for(i in 1:6){
    hist(bg.mas[,i], xlab="", las=1,
    main=paste(sep="", "bg.mas[, ",  i, "]"),
    xlim=c(-100, 300), breaks=10000)
}
par(mfrow=c(1,1))

par(mfrow=c(2,3))
for(i in 1:6){
    hist(bg.rma[,i], xlab="", las=1,
    main=paste(sep="", "bg.rma[, ",  i, "]"),
    xlim=c(-100, 300), breaks=10000)
}
par(mfrow=c(1,1))
@ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:39:53.420

最简单的解决方案是将它们分成单独的块：

```
<<bghist2_mas_rma, fig.height=4, fig.width=6, echo=FALSE>>=
par(mfrow=c(2,3))
for(i in 1:6){
    hist(bg.mas[,i], xlab="", las=1,
    main=paste(sep="", "bg.mas[, ",  i, "]"),
    xlim=c(-100, 300), breaks=10000)
}
@

<<bghist2_mas_rma_2, fig.height=4, fig.width=6, echo=FALSE>>=
par(mfrow=c(2,3))
for(i in 1:6){
    hist(bg.rma[,i], xlab="", las=1,
    main=paste(sep="", "bg.rma[, ",  i, "]"),
    xlim=c(-100, 300), breaks=10000)
}
par(mfrow=c(1,1))
@ 
```

# jquery - 从列表视图中获取点击值

> ID：12424141
> 
> 赞同：3
> 
> 时间：2012-09-14T12:00:40.927
> 
> 标签：jquery, jquery-mobile

我已经使用 jQuery Mobile 创建了一个动态列表视图，我想获取单击列表项的值。我想要实现这一点的原因是因为我需要这个值来链接到另一个页面并显示有关单击项目的更多详细信息。

我已经在互联网上搜索过，我发现了一个对我不起作用的解决方案。

我的（jQuery Mobile）页面如下所示：

```
<div data-role="page" id="personList">
    <div data-role="header" data-position="fixed">
        <h1>header</h1>
    </div>

    <div data-role="content">
    </div>

    <div data-role="footer" data-position="fixed">
        footer
    </div>
</div> 
```

我将项目动态添加到列表视图的函数如下所示：

（我使用 HTML5 SQL Web 存储将数据本地存储在设备上）

```
function showPersons() 
{
  db.transaction (function (transaction)
  {
//get data from table
var sql = "SELECT * FROM person";
transaction.executeSql (sql, undefined, 

//loop through sql result and add results to html variable
function (transaction, result)
{
  var html = "<ul id=" + "personListview" + "data-role=" + "listview" +" data-filter=" + "true" + ">";

  if (result.rows.length) //if there is something found
  {
    for (var i = 0; i < result.rows.length; i++) 
    {
      var row = result.rows.item (i);
      var voorNaam = row.voorNaam;
      var achterNaam = row.achterNaam;
      var email = row.email;

        html += "<li data-theme='e'" + "data-name='test value'>" + "<a href='#'>" +  "<h3>" + voorNaam + " " + achterNaam + "</h3><p>" + email + "</p></a></li>";

    }
  }
  else //if there is nothing found
  {
    html += "<li> No persons found </li>";
  }

  html += "</ul>";

  //Change page
  $("#personList").unbind ().bind ("pagebeforeshow", function ()
  {
    var $content = $("#personList div:jqmData(role=content)");
    $content.html (html);
    var $ul = $content.find ("ul");
    $ul.listview ();
  });

  $.mobile.changePage ($("#personList"));

}, error);});} 
```

如您所见，我在“li”标签中添加了“data-name='test value'”，所以我应该使用以下函数获取该值：

```
$('#personListview').children('li').click(function() {
alert($(this).attr('data-name')); }); 
```

但是，最后一个功能不起作用。当我单击“li”项目时，什么也没有发生。我希望我收到一个值为“数据名称”的警报）。

PS。即使我声明了这一点，我也没有收到警报：

```
$('#personListview').children('li').click(function() {
    alert('test'); 
```

有人可以帮助我吗？我是 Javascript 和 jQuery(mobile) 的初学者。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:09:36.480

你的代码：

```
"<ul id=" + "personListview" + "data-role... 
```

输出到：

```
<ul id=personListviewdata-role... 
```

您的 javascript 需要阅读：

```
'<ul id="personListview" data-role=....' 
```

请注意，我在开头使用单引号，因此我可以在整个过程中使用双引号。

另外，我建议给每个人`<ul>`自己的 ID，或在其上使用 CSS 类，然后将事件与`$('.myclass').click(function() { ... });`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:36:26.600

尝试将您的点击事件更改为这样的（我建议并假设您`<ul>`有一个类`yourclass`）：

```
$("#personlist").live('pageinit', function() {   
    $('.yourclass').live('vclick', function(e) {
         alert($(this).attr('data-name').val();
    }  
} 
```

还要检查当前代码中的这一行：

```
alert($(this).attr('data-name').val(); 
```

看你的`<li>`定义。它应该以`<li>`：

```
<li><a href="bmw.html">BMW</a></li> 
```

您的 html 格式可能不正确。尝试按照我的示例所示进行操作：

```
<li><a class="yourclass" href="#" id="' + id + '" ><h1>' + label + '</h1><p>'+ customer + '</p></a></li> 
```

尝试更改您的 html`<li>`项目，然后添加事件处理程序：

```
$("#personlist").live('pageinit', function() {   
    $('.yourclass').live('vclick', function(e) {
        alert($(this).attr('data-name').val();
    }  
} 
```

如果出现格式问题，请查看：[jQuery Docs](http://jquerymobile.com/test/docs/lists/docs-lists.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-27T21:42:23.963

```
$("#myListview").on("click", "li", function() { 
     alert( $(this).attr("data-name") ); 
}; 
```

# android - 如何在android中实现微博授权和分享？

> ID：12424144
> 
> 赞同：2
> 
> 时间：2012-09-14T12:01:06.943
> 
> 标签：android, authentication, key, share, social-networking

我试过这段代码： [http](http://code.google.com/p/weibo-android-sdk/source/browse/example/src/com/weibo/android/example/AuthorizeActivity.java?r=12) ://code.google.com/p/weibo-android-sdk/source/browse/example/src/com/weibo/android/example/AuthorizeActivity.java?r=12 你可以得到整个应用程序来自[http://code.google.com/p/android-weibo-sdk/downloads/list](http://code.google.com/p/android-weibo-sdk/downloads/list) 授权工作，但后来我从代码中更改了 appkey 和 appsecret，使用微博给我的开发人员帐户，在我更改后具有以下代码：

```
private static final String CONSUMER_KEY = "1415745064";// Replace a developer's appkey, for example, "1646212960";

private static final String CONSUMER_SECRET = "8cf118d44c9881b9d1cbf2c4eb957c57";// Replace a developer's appkey, e.g. "94098772160b6f8ffc1315374d8861f9";

private String username = "";

private String password = "";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    mToken = (TextView) this.findViewById(R.id.tvToken);
    mLogin = (Button) this.findViewById(R.id.btnLogin);
    mLogin.setText("oauth!");
    mLogin.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            if (v == mLogin) {
                Weibo weibo = Weibo.getInstance();
                Log.d("onclick", "onclick");
                weibo.setupConsumerConfig(CONSUMER_KEY, CONSUMER_SECRET);
                // Oauth2.0
                // Implicit authorization and authentication
                Log.d("onclick", "dupa setupconsumerconfig");
                weibo.setRedirectUrl("http://www.sina.com");
                // Here the callback page content should replace the corresponding application callback page with appkey
                // Application callback page landing Sina microblogging development platform developers
                // Into my application - Application Details - Application Information - Senior - authorization settings - application callback page set up
                // and view
                // Application callback page is not empty
                Log.d("onclick", "dupa set redirecturl");

                weibo.authorize(AuthorizeActivity.this, new AuthDialogListener());
                Log.d("onclick", "dupa autorize");

            }
        }
    });

} 
```

其余的代码是相同的，但是我没有向我显示我可以在其中写入我的电子邮件和密码以登录的对话框，而是收到一个带有错误的对话框。一些用中文写的，无法理解 id，比它说的：(error:redirect_uri)mismatch)。

# c# - 在从 svn 更新之前检查本地目录是工作副本

> ID：12424149
> 
> 赞同：1
> 
> 时间：2012-09-14T12:01:39.197
> 
> 标签：c#, sharpsvn

我正在使用 c# 编程提取 svn 存储库。我在我的项目中添加了sharpsvn dll并编写了以下代码

```
string localFolder= @"C:\Users\Desktop\LocalFolder\Dev\Websites\Service";
SvnClient client = new SvnClient();

SvnUriTarget target = new SvnUriTarget(@"http://svn.user.com/svn/websites/Branches/InternalServices");

SvnInfoEventArgs info;

client.GetInfo(target, out info);

//Specify the repository root as Uri
//Console.WriteLine("Repository version: {0}", info.Revision);
Console.WriteLine("Started checking out. Please wait few minutes");

client.CheckOut(target, localFolder);                   
//client.Update(localFolder); 
```

我已经使用“client.checkout”方法进行了检查，并且可以使用“client.update”方法进行更新。

假设我的机器中有文件夹“服务”。我最初使用“client.checkout”检查文件/文件夹到这个文件夹。

下次我运行该程序时，它应该会自动更新而无需结帐。我怎么知道服务文件夹是否已经检查过一次，现在应该更新？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T19:22:00.490

您可以确定一个目录是否是这样的工作副本：

```
public static bool IsWorkingCopy(string path)
{
    using (var client = GetSvnClient())
    {
        var uri = client.GetUriFromWorkingCopy(path);
        return uri != null;
    }
} 
```

# javascript - 可变大小的 JavaScript 字符串如何成为原始类型？

> ID：12424150
> 
> 赞同：1
> 
> 时间：2012-09-14T12:01:41.210
> 
> 标签：javascript, string, stack, primitive-types

据我了解，`string`JavaScript 中的（基本）类型是原始类型，这意味着它的变量是在堆栈上分配的。

我原以为要在堆栈上分配一个类型，它需要有一个固定的大小——这可能适用于其他原始类型，如`boolean`,`number`等。

我是否有某种错误的假设，或者是否有其他一些内部魔法用于`string`在 JavaScript 原始类型中创建 s？

* * *

编辑：当人们认为 JavaScript 是松散类型时，这会变得更加复杂。这让我想知道如何在堆栈上分配*任何*局部变量......鉴于在函数过程中可能分配给它的大小不是固定的。

但我想（可能是简化的）答案可能是所有局部变量都可以在堆栈上分配一个固定的最大大小。假设这是 8 个字节，我认为这是`number`类型的大小，并且应该足够大以容纳所有其他原始类型（除了`string`) 以及内存地址（当为局部变量分配引用类型时）。但是，字符串肯定不能限制为 8 个字节（或任何大小）。这让我得出结论，字符串（即使是原始类型的）没有（不能）分配在堆栈上。因此，JavaScript 中的术语“原始类型”被用来表示“基本/构建块”类型，而不是必须在堆栈上分配的类型（与我在包括“Professional JavaScript.. .”尼古拉斯·扎卡斯）。

任何人有任何其他看法或指向一个好的来源谈论这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:12:22.413

字符串既是对象又是基元。

做的时候：

```
var s = "this is a string"; 
```

你实际上是这样做的：

```
var s = new string("this is a string"); 
```

窗帘后面。

第一个是带有字符的原始数组，第二个是指该数组。

字符串是不可变的，这意味着它们无法更改。如果您尝试更改它（即反转它），您将创建一个新的字符串原语，对象引用将指向该原语。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:08:23.900

1.  字符串不在堆栈上分配
2.  分配变量的位置不区分原语和对象
3.  字符串不是原语，它们属于“字符串”类

原始类型和类型之间的区别在于类型具有方法，您可以为它们分配新属性：

```
var a = 1, b = {}, s = '';
a.foo = 1; // doesn't work, but no error either
b.foo = 1; // works
s.foo = 1; // doesn't work, but no error either

console.log(a.foo);
console.log(b.foo);
console.log(s.foo);
​ 
```

给

```
undefined
1
undefined 
```

所以总而言之，我不确定在 JavaScript 中使用“原始”是否有意义，因为这条线是模糊的。

字符串是“值对象”，这意味着您不能更改任何属性。例如，当您替换字符串中的字符时，您会得到一个新字符串；旧字符串不会改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:05:43.510

用于在 Javascript 解释器中表示变量的存储不需要看起来像堆栈 - 它依赖于实现。

# mysql - 如何在 mysql CONCAT 函数中使用自动递增值？

> ID：12424153
> 
> 赞同：1
> 
> 时间：2012-09-14T12:01:51.083
> 
> 标签：mysql, concat

我有这个问题：

我想像这样在图像表中插入新行：

```
INSERT INTO image (pr_id, kelias, tipas) VALUES(111111, CONCAT('1111111111', '_', image.id, '.jpg'), '0') 
```

`CONCAT`但是当我尝试输入`image.id`值 ir 每次返回 0时，我的函数做错了。

`image.id`是自动增量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:11:24.773

您可以使用 BEFORE INSERT 触发器 -

```
CREATE TRIGGER trigger1
  BEFORE INSERT
  ON image
  FOR EACH ROW
BEGIN
  SET NEW.kelias = CONCAT(NEW.kelias, NEW.pr_id);
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:12:20.303

```
mysql_query("INSERT INTO image (kelias, tipas) VALUES('anything', '0')");
$img_id = mysql_insert_id();
$kelias = '1111111111' . '_' . $img_id . '.jpg';
mysql_query("UPDATE image SET kelias='$kelias' WHERE pr_id = $img_id"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:06:06.960

尝试

```
INSERT INTO image (pr_id, kelias, tipas)
SELECT 11111, 
       CONCAT('1111111111', '_', max(image.id) + 1, '.jpg'), 
       '0'
FROM image 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-27T10:32:06.047

您可以使用 BEFORE INSERT 触发器 -

```
CREATE TRIGGER trigger1
  BEFORE INSERT
  ON image
  FOR EACH ROW
BEGIN
  SET NEW.kelias = CONCAT( NEW.kelias , '_', 

  (SELECT AUTO_INCREMENT
  FROM information_schema.TABLES
  WHERE TABLE_SCHEMA = "<your database name here>"
  AND TABLE_NAME = "image" )

  , '.jpg');
END 
```

然后通过以下方式获得所需的结果：

```
INSERT INTO image (pr_id, kelias, tipas) VALUES(111111, '1111111111', '0') 
```

# algorithm - 给定 N 组元素，找到 M 组的最小并集

> ID：12424155
> 
> 赞同：8
> 
> 时间：2012-09-14T12:01:54.750
> 
> 标签：algorithm

给定一份食谱作为一组配料，我试图找到能做一周饭菜的最低限度的配料。这转化为上述问题，其中 N 为配方数，M = 7。

```
eg. if the initial sets are [{1,2}, {2,3}, {1,2,3}, {1}, {2}], and M=3
The minimal union is {1,2}. 
```

我正在寻找解决此问题的高级方法。我觉得这可以简化为 BFS，但我想看看其他方法是否也可以使其最佳。

注意：可能有多个这样的集合，具有相同的基数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-14T12:49:33.147

这个问题被称为 MINIMUM *k* -UNION，它是[NP-hard](http://en.wikipedia.org/wiki/NP-hard)，如下所示：

*   斯塔尔 A.温特博 (2002)。[*关于k-*](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.57.9172&rep=rep1&type=pdf)[歧义问题](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.57.9172&rep=rep1&type=pdf)[的硬度的](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.57.9172&rep=rep1&type=pdf)*注释。DSG 技术报告 2002-006。*

 *所以没有人知道任何算法来解决它，它在输入大小上是多项式的。

在您的情况下，您可能会乐于接受一个近似的解决方案：即一组具有少量成分的食谱，但不一定是最小的此类集合。所以我建议你尝试*贪心算法*：通过在每个阶段添加最小化联合大小的配方来迭代地构建配方集合。这是 Python 中的一个简单实现：

```
def small_union(sets, k):
    """
    Choose `k` elements from `sets` and return their union.  Attempt
    to return a fairly small union using a greedy approach.

    >>> small_union([{1,2}, {2,3}, {1,2,3}, {1}, {2}], 3)
    set([1, 2])
    >>> small_union([{1,2}, {2,3}, {3,4}, {1,4}], 3)
    set([1, 2, 3, 4])
    """
    union = set()
    for _ in xrange(k):
        s = min(sets, key = lambda s: len(s | union))
        sets.remove(s)
        union |= s
    return union 
```*

# c# - 温莎城堡代码设计问题

> ID：12424158
> 
> 赞同：2
> 
> 时间：2012-09-14T12:02:09.523
> 
> 标签：c#, castle-windsor

使用 Windsor 已经有一段时间了，我有点惊讶我没有早点遇到这个“设计”问题。我不知道如何最好地解决它。

我有一个`ConverterService`用于执行数据转换的类。这是界面（我已将参数/返回值更改为对象以简化示例）：-

```
public interface IConverterService
{
    object ConvertData(object sourceData);
} 
```

转换器类需要一些配置设置，由`ISettingsProvider`. 这些设置用于构造函数和 ConvertData() 方法。因此，我将 ISettingsProvider 注入到构造函数中：-

```
public class ConverterService : IConverterService
{
    private ISettingsProvider _settingsProvider;

    public ConverterService(ISettingsProvider settingsProvider)
    {
        _settingsProvider = settingsProvider;

        // Do some one-time initialisation using info from settingsProvider
        // and store the results in class variables (not shown), used by ConvertData.
    }

    public object ConvertData(object sourceData)
    {
        // Do the conversion - also uses _settingsProvider,
        // and other variables initialised in the constructor ..
    }
} 
```

ConverterService 和 SettingsProvider 都以通常的方式在 Windsor 中注册：-

```
container.Register(Component.For<IConverterService>().ImplementedBy<ConverterService>().LifeStyle.Singleton);
container.Register(Component.For<ISettingsProvider>().ImplementedBy<SettingsProvider>().LifeStyle.Singleton); 
```

任何需要使用转换器的类都会通过其构造函数注入一个 IConverterService - 标准的东西。这很好用，但我现在需要让许多不同的消费者能够将 ConverterService 与不同的设置提供程序（最多两个或三个）一起使用。

我不能让 ConverterService 瞬态，因为我不希望每次都有初始化开销。感觉就像我需要为每种类型的 ISettingProvider 提供一个单独的 ConverterService 实例，但我不确定是否/如何使用 Windsor 来实现这一点，或者是否需要更基本的重构？

我将如何注册不同的设置提供程序，所有这些提供程序都实现了 ISettingsProvider？更具体地说，Windsor 将如何解决正确的问题（请记住，ConverterService 构造函数只需要一个 ISettingsProvider）？

任何关于我应该如何（重新）设计课程的建议都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:21:19.287

您不能为您的实例使用命名约定并以这种方式控制它们吗？因此，您的 IConverterService 的每个实例都会有一个关联的名称来指示它正在使用的配置。

这个问题提供了一些关于使用命名组件/实例的信息。

[Castle Windsor - 如何在构造函数注入中映射命名实例](https://stackoverflow.com/questions/11325699/castle-windsor-how-to-map-named-instance-in-constructor-injection)

# css - Drupal 7 - Internet Explorer 7&8 忽略样式表

> ID：12424174
> 
> 赞同：3
> 
> 时间：2012-09-14T12:03:09.737
> 
> 标签：css, internet-explorer, drupal, drupal-7, stylesheet

我即将完成 Drupal 7 网站构建并正在浏览器中进行测试。除了 IE 7&8 之外，所有浏览器中的一切都很好——这似乎是一个常见问题。

我已经阅读了很多关于 IE 7&8 如何忽略超过 31 个样式表请求的内容。

我已经采取了很多我在 Stackoverflow 和 Internet 上找到的建议。

*   在**Performance -> Aggregate and compress CSS files**中压缩 CSS 文件- 我现在可以看到源代码中加载了 5 个样式表，但是 IE 仍然没有加载我的样式表！
*   我在 html.tpl.php 文件中的所有其他样式表之前添加了对 IE7 样式表的直接调用（硬编码）
*   我还使用了一个名为**Conditional Stylesheets**的模块来允许调用 .info 文件中的特定样式表

这些都没有奏效。

我还在我的 template.php 文件中添加了以下内容，以删除[James Hopkins](http://jhop.me/css/removing-all-those-pesky-style-element-declarations-in-drupal-to-accommodate-ie6)建议的某些 Drupal CSS 文件（我知道它说的是 IE6，但是嘿，值得一试。

```
# get array of stylesheets
$css = drupal_add_css();
unset($css['all']['module']['modules/system/system.css']);
unset($css['all']['module']['modules/system/defaults.css']);
unset($css['print']['theme']['themes/mytheme/print.css']); 
```

链接到网站**88.208.247.36** 它仍然是 ip 格式，因为域尚未传递到网络服务器。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-15T13:51:04.513

你试过这个吗？

将此添加到您的 clinigen.info 文件中：

```
stylesheets-conditional[lte IE 7][all][] = _css/ie7.css 
```

并从 main.css 中删除它：

```
@import url("ie7.css"); 
```

# python - Python - smtplib - 另存为草稿 - Gmail

> ID：12424177
> 
> 赞同：2
> 
> 时间：2012-09-14T12:03:23.093
> 
> 标签：python, gmail, smtplib

我有以下工作代码从 GMail 帐户发送消息：

```
mailServer = smtplib.SMTP(SMTP_SERVER, SMTP_PORT)
mailServer.ehlo()
mailServer.starttls()
mailServer.login(FROM_EMAIL, PASSWORD)
mailServer.sendmail(FROM_EMAIL, finalReciepients, msg.as_string())
mailServer.close()    # Should be mailServer.quit(), but that crashes... 
```

我不想发送消息，而是将其保存在草稿文件夹中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T21:19:32.537

SMTP 严格用于*发送*邮件。如果您想*存储*邮件（就像使用草稿一样），那么您需要使用本地存储或 IMAP。

# wcf - WCF 服务在 SSL 下不工作

> ID：12424181
> 
> 赞同：0
> 
> 时间：2012-09-14T12:03:37.977
> 
> 标签：wcf, wcf-binding, wcf-security, wcf-client

我在具有负载平衡服务器配置的 IIS 7 上运行 WCF。

当我们正常运行它时一切正常，但是当我们尝试打开 SSL 时一切都停止工作。我已经尝试了 web.config 中的所有不同配置设置，例如 Transport 和 Message，但似乎没有任何效果。

甚至不允许我添加对项目的引用，只是返回一个关于文档类型的奇怪错误。

在我们的主网络服务器上一切正常，所以我认为数字证书没有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:13:27.570

我不知道您是否在负载均衡器上使用 SSL 加速来保存证书。如果你是这可能会解释错误。

当我们实施负载平衡时，我们的服务器也遇到了类似的问题。问题在于，当您添加服务引用时，SSL 加速会干扰 WCF 获取引用的方式。

[这里](http://www.clickoncerevolution.com/wiki/index.php?title=WCF_under_SSL_Acceleration_and_Load_Balancing)有一篇文章解释了如何解决这个问题。它也有图表和东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:13:21.267

看看这个链接 [http://www.codeproject.com/Articles/36705/7-simple-steps-to-enable-HTTPS-on-WCF-WsHttp-bindi](http://www.codeproject.com/Articles/36705/7-simple-steps-to-enable-HTTPS-on-WCF-WsHttp-bindi)

并查看以下内容

您必须将服务配置为使用 HTTPS：

```
<bindings>
  <basicHttpBinding>
    <binding name="https">
      <security mode="Transport" />
    </binding>
  </basicHttpBinding>
</bindings>
<behaviors>
  <serviceBehaviors>
    <behavior name="metadata">
      <serviceMetadata httpsGetEnabled="true" />  
    </behavior>
  </serviceBehaviors>
</behaviors>
<services>
  <service name="..." behaviorConfiguration="metadata">
    <endpoint address="..." contract="..." binding="basicHttpBinding"
              bindingConfiguration="https" />
  </service>
</services> 
```

# javascript - 限制javascript变量的最小/最大整数

> ID：12424185
> 
> 赞同：4
> 
> 时间：2012-09-14T12:03:58.793
> 
> 标签：javascript, html

我正在尝试制作各种人才计算器，单击“技能”将减少此变量，而右键单击将增加该变量。

我遇到的问题是我希望将变量限制为超过 50 或低于 0。

现在我用谷歌搜索并在这里搜索了变量限制和最大整数，但没有任何东西让我知道如何做到这一点，我认为我的搜索措辞错误。

有人可以给我一个想法如何做到这一点或请指出正确的方向，谢谢。

变量 im 使用：

```
 var a=50;
  function decrease(){a--;document.getElementById('boldstuff').innerHTML= +a;}
  function increase(){a++;document.getElementById('boldstuff').innerHTML= +a;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:05:56.763

添加`decrease`后的函数中`a--`

```
if (a < 0)
    a = 0; 
```

并在`increase`：

```
if (a > 50)
   a = 50; 
```

或使用`Math.min(value, minValue)`和`Math.max(value, maxValue)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:06:31.297

您可以使用 Math.min 和 Math.max。

```
 var a=50;
  function decrease(){ a = Math.max( a-1,0) ; document.getElementById('boldstuff').innerHTML= a;}
  function increase(){ a = Math.min( a+1,50); document.getElementById('boldstuff').innerHTML= a;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:08:51.513

试试这个：

```
var a=50;
function decrease(){
   if(a > 0){
      a--;
      document.getElementById('boldstuff').innerHTML= +a;
   }  
}
function increase(){
   if(a < 50){
      a++;
      document.getElementById('boldstuff').innerHTML= +a;
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:09:00.093

试试这个：

```
 var a=50;
  function decrease(){if(a>0){a--;document.getElementById('boldstuff').innerHTML= +a;}}
  function increase(){if(a<50){a++;document.getElementById('boldstuff').innerHTML= +a;}} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T12:10:56.597

只需在更改之前检查该值，以便仅在未达到限制时更改它：

```
var a=50;

function decrease(){
  if (a > 0) {
    a--;
    document.getElementById('boldstuff').innerHTML = a;
  }
}

function increase(){
  if (a < 50) {
    a++;
    document.getElementById('boldstuff').innerHTML = a;
  }
} 
```

（上面的代码假定整数值。如果您分配`49.9`给变量并调用`increase`，它会将变量增加到`50.9`。如果您还需要防止浮点数，您可以进行检查`if (a - 1 >= 0)`和`if (a + 1 <= 50)`。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-02T00:35:15.007

```
Math.max(Math.min(x,range.max),range.min); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-05T06:49:33.083

使用[三元运算符](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_Operator)。使您的代码美观整洁：

```
let a = someFunctionResult();
    a = a > 50 ? 50 : a;  
    a = a <  0 ?  0 : a; 

    // if A is more than 50, make it 50, otherwise leave it unchanged;
    // if A is < 0, make it 0, otherwise leave it unchanged. 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2017-09-13T10:46:41.703

//// 你的最大值 ///// 你的最小值 if(type > 4){type = 4;} if(type < 0){type = 0;}

简单地说，如果它在任一边界之外将其设置为该边界

# jsp - java - 如何在Java Web应用程序中上传文件时减少时间？

> ID：12424186
> 
> 赞同：-2
> 
> 时间：2012-09-14T12:03:58.900
> 
> 标签：jsp, servlets

在 Java Web 应用程序中上传 tiff 图像时，需要花费大量时间来上传。所以任何减少等待时间的想法。我搜索了很多，但 tiff 图像上传需要时间，但无论如何我们可以这样做，我们可以将其推送到任何消息队列，以便上传过程将从该消息队列继续，而不会干扰我的正常工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:44:20.123

如果您认为您的代码还可以并且文件很大，我建议您当然在另一个线程中进行上传

# extjs - 在 ExtJS 4 中将组件插入到 Tabpanel 的选项卡中

> ID：12424202
> 
> 赞同：2
> 
> 时间：2012-09-14T12:05:41.513
> 
> 标签：extjs, extjs4, extjs4.1

我想在 ExtJS 4 中使用包含我自己的组件（或 XTemplete）的大标签制作一个标签面板，有什么方法可以实现吗？谢谢

**更新** ：可以通过此链接更改自定义选项卡的高度

[更改 ExtJS 4 选项卡的高度](https://stackoverflow.com/questions/7237795/change-the-height-of-an-extjs-4-tab)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T05:24:14.837

签出`Ext.tab.Bar`和`Ext.tab.Tab`。您可以通过`Ext.tab.Panel#tabBar`config 属性将选项卡栏配置传递给面板。

```
var tabpanel = {
    xtype: 'tabpanel',
    tabBar: {
        defaultType: 'xxx'        
    }
}​ 
```

然后，您使用`alias: 'widget.xxx`. 默认`Ext.tab.Tab`是`Ext.button.Button`自定义样式的子类。

用一个不仅仅是一个子类的组件替换它`Ext.tab.Tab`可能需要相当多的工作。您需要确保组件的行为正确，并且 CSS 样式看起来不错。

一种更快但不太灵活的方法是子类化`Ext.tab.Tab`并更改其外观以满足您的需求。

**更新**

不幸的是，ExtJs`Ext.tab.Panel`为每个正在添加/创建的选项卡明确设置了 xtype。从`Ext.tab.Panel`

```
onAdd: function(item, index) {
    var me = this,
        cfg = item.tabConfig || {},
        defaultConfig = {
            xtype: 'tab',                // <= XXX
            card: item,
            disabled: item.disabled,
            closable: item.closable, 
```

但正如您所看到的，可以`tabConfig`在选项卡面板的项目上添加 a，这将优先于此处定义的 defaultConfig。因此，一种简单直接的方法是在选项卡面板的每个子项上定义一个 tabConfig

```
tabConfig: {
   xtype: 'xxx'
} 
```

# curl - 在检查文件存在时获取 CURLE_COULDNT_CONNECT 代码

> ID：12424205
> 
> 赞同：0
> 
> 时间：2012-09-14T12:05:48.533
> 
> 标签：curl, libcurl

我正在使用以下代码检查 http 服务器上的文件是否存在。但我正在获取`CURLE_COULDNT_CONNECT`代码。谁能告诉我如何使用 lib curl 检查文件是否存在？

```
 curl_easy_setopt(curl, CURLOPT_URL, "http://www.thekevindolan.com/wp-content/uploads/2010/02/15_19_1-Tree-Sunrise-Northumberland_web.jpg");
    curl_easy_setopt(curl, CURLOPT_NOBODY, 1L);
    /* Do not do the transfer - only connect to host */
    curl_easy_setopt(curl, CURLOPT_CONNECT_ONLY, 1L);

    CURLcode res = curl_easy_perform(curl); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T18:14:49.817

CURLE_COULDNT_CONNECT 表示 TCP 连接失败。您无法从运行该代码的机器连接到端口 80 上的 HTTP 服务器！

# android - Jsoup网页解析——如何避免ban？

> ID：12424206
> 
> 赞同：3
> 
> 时间：2012-09-14T12:05:49.493
> 
> 标签：android, html-parsing, jsoup

我有一个简单的 android 应用程序，它定期用 Jsoup 解析一些网页。还有我的问题：

```
1) can admins detect me? how?
2) how to avoid to be banned? 
```

我尊重礼貌，所以我只每 2 小时设置一次解析间隔，但是用户可以随时请求手动刷新/解析 - 但这应该每天只发生几次，而且为了避免太大的流量，我已经实现了 10 分钟缓存（所以最大值可能的解析间隔是每小时 6 次）。这够了吗？如果我的应用程序将下载 1000 个用户，他们会阻止我吗？

PS：我没有解析带有子页面的完整页面，只有 1 个大小为 cca 50-100kb 的 html 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:33:05.937

由于该应用程序在具有许多不同 IP 地址的许多不同设备上运行，它们只能检测单个用户，而不是作为开发人员的您。我认为那里的网站应该能够毫无问题地处理这么多请求。你没有做任何普通用户可能不会做的事情......

# php - 通过 php 类函数循环打印进度

> ID：12424210
> 
> 赞同：0
> 
> 时间：2012-09-14T12:05:57.147
> 
> 标签：php, apache, http

我目前正在使用 aOuth 和其他一些服务器做一些事情，虽然我创建的课程有效，但它并没有让 HTML 页面发布它的进度。例如说我有以下课程：

```
class Something {
    function a() {
        sleep(2); echo "a()"; return TRUE;
    }
    function b() {
        sleep(2); echo "b()"; return TRUE;
    }
    function c() {
        sleep(2); echo "c()"; return TRUE;
    }
} 
```

然后我循环遍历我的 HTML 中的类：

```
$something = new Something();
if($something->a()) {
    if($something->b()) {
        if($something->c()) {
            echo "everything completed!!";
        }
    }
} 
```

该页面将呈现：

```
a()b()c()everything completed!! 
```

6秒后。我希望它随时更新（即`a()`在完成处理某事时打印->a（），`b()`在完成处理某事时打印->b（）等...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:23:03.343

每次您希望显示进度时，尝试使用`ob_flush`函数刷新输出缓冲区。

每次输出一些文本时，如果启用了输出缓冲，它会被添加到缓冲区中，而不是立即发送到客户端。当请求完成处理时，输出会立即发送。

如果刷新缓冲区，则强制 PHP 发送它已有的文本，而无需等待请求完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:41:09.710

在 Chrome 21、Firefox 15 和 IE8 中为我工作：

```
<?php
header( 'Content-Type: text/html; charset=utf-8' );

class Something {
    function a() {
        echo "a()" . str_repeat(' ', 1024); 
        ob_flush(); flush(); 
        sleep(2); return TRUE;
    }
    function b() {
        echo "b()" . str_repeat(' ', 1024); 
        ob_flush(); flush(); 
        sleep(2); return TRUE;
    }
    function c() {
        echo "c()" . str_repeat(' ', 1024); 
        ob_flush(); flush(); 
        sleep(2); return TRUE;
    }
}

$something = new Something();
if($something->a()) {
    if($something->b()) {
        if($something->c()) {
            echo "everything completed!!";
        }
    }
} 
```

解释：我们必须说服立即开始输出......

*   PHP 处理器，带有[ob_flush](http://www.php.net/manual/en/function.ob-flush.php) -[刷新](http://www.php.net/manual/en/function.flush.php)组合。

*   Apache（网络服务器），`Content-Type`在脚本开头发送标头。

*   网络浏览器，因为其中一些不会考虑绘制部分输出，除非它足够大。解决方法是将一个相当大但为空的字符串 ( `str_repeat(' ', 1024)`) 附加到输出。

# java - Java：表示大量数据数组

> ID：12424218
> 
> 赞同：2
> 
> 时间：2012-09-14T12:06:09.617
> 
> 标签：java, arrays, memory, enums

对于工作调度应用程序，我需要为 w 周（= 7w 天）生成很多可能的员工时间表。员工时间表包括计划期间每一天的轮班列表（早、晚、晚、休息日）。该应用程序是用 Java 编写的。

此时，我代表一个员工时间表如下：

```
public class Schedule
{
    /** List with for every day of planning period the assigned shift */
    private Shift[] shiftlist = new Shift[Settings.schedule_days];

    /** Cost of schedule (for measuring its quality) */
    private double cost;

    // A list of variables, representing schedule properties
    // which are referenced often.
    // E.g.: number of workweekends, number of night shifts

    // Also some methods for updating / retrieving information
} 
```

Shift 是一个枚举，表示分配的班次，定义为：

```
public enum Shift
{
    DAY, LATE, NIGHT, FREE;
} 
```

我在枚举声明和比较属性的方法中也有一些移位属性，但我认为这与这里无关。

每个员工都有一个他可能的时间表列表：

```
public class Employee
{
    /** Large set of possible schedules for planning period */
    public LinkedList<Schedule> generated_schedules;

    // Variables representing properties of employee
} 
```

我的问题是我实际上有 50 名员工，我想为每位员工生成 100.000 - 1.000.000 个可能的时间表。

时间表实际上生成得很快，因为我的电脑有 8GB 可用内存，所以我可以存储很多。然而，当完成为 30--40 名员工生成时，我的记忆就变得满满当当了。

有人给我的建议是使用字符数组来表示分配的班次，而不是枚举数组。这将使用更少的空间。此外，他表示使用 char 数组列表而不是 Schedule 对象列表也更好。但是，不可能在计划附近的某个地方保存计划属性（例如成本），并且需要经常重新计算它们。我认为这将是一个严重的缺点。

这种观察确实有意义，还是您认为有更好的方法来表达如此大量的数据以使用更少的空间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:14:01.110

如果您想减少内存，您需要确定当前使用最多内存的内容以及您可以对该数据类型做出哪些假设以使其更小。如果没有这些信息，你只会猜测。

* * *

我建议您使用基于通用算法的方法。

例如;

*   您只能生成 1000 个计划并对它们进行评分。

*   500强，你留着

*   使用这些将它们混合在一起以生成带有一些随机突变的下 1000 个。

重复，直到你的最好成绩没有提高。

重点是; 您可以使用另一种方法在更短的时间内生成更少的计划，但仍会收敛到最佳解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:14:56.273

类似“小”项目的一次经历：

建议使用也存储在文件系统中的**嵌入式数据库。**尽管 SQL 很丑陋，但它允许比手动编码的集合遍历更好的查询；并且更容易维护。

这样一来，内存消耗的问题就没有实际意义了。

如果您愿意，可以使用 JPA，例如带有 ORM 的 eclipseLink。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:20:18.647

如果您确实需要同时在内存中使用所有计划，那么最节省空间的编码是使用每天 2 位的 BitSet。

```
public class BitSetShiftList {
  private BitSet bitset;

  public void BitSetShiftList(int size) {
    bitset = new BitSet(size * 2);
  }

  public void setShift(int day, Shift shift) {
    int ordinal = shift.ordinal();
    assert ordinal >= 0 && ordinal <= 3;

    bitset.set(day * 2, (ordinal & 0x1) != 0);
    bitset.set(day * 2 + 1, (ordinal & 0x2) != 0);
  }

  public Shift getShift(int day) {
    int ordinal = (bitset.get(day * 2) ? 0x1 : 0x0) |
      (bitset.get(day * 2 + 1) ? 0x2 : 0x0);
    return Shift.values()[ordinal];
  }

} 
```

# javascript - 如何在 onclick 事件中调用 Javascript 中的“link_to”

> ID：12424220
> 
> 赞同：0
> 
> 时间：2012-09-14T12:06:22.747
> 
> 标签：javascript, jquery, ruby-on-rails

我正在尝试在我的 Javascript (jQuery) 中获取 rails-'link_to' 功能。在我的 Javascript 中，我正在等待 onclick 事件并通过 ajax 获取一些数据。之后我想打电话给

```
= link_to "Show", @mymodel, :remote => true, :id => "#{some.id}", :format => :js 
```

但我不知道如何把它放在 JS 中。非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:21:53.140

[RJS](http://www.simonecarletti.com/blog/2010/06/unobtrusive-javascript-in-rails-3/)是您所需要的：

使用您的 JS 代码创建文件 app/views/mymodel/show.js.erb。然后将此代码添加到控制器的 show 方法中：

```
respond_to do |format| 
  format.js
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:19:36.307

如果您使用的是 jquery，则可以在使用您的 RoR 代码创建锚标记后在锚标记上附加一个单击事件，如下所示

```
$(document).ready(function(){
    $('#theid').click(function(){
        //do something here
    });
}); 
```

# php - 在一堆 XML 文档中搜索单个术语

> ID：12424225
> 
> 赞同：1
> 
> 时间：2012-09-14T12:06:57.180
> 
> 标签：php, xml

我需要在大量 XML 文档中搜索出现在 XML 标记中（任何级别）的单个术语（字典中的单词），并将它们计数以提供每个术语的频率表。我正在使用 PHP5，我将在本地机器上运行它，所以时间和性能损失不是问题 - 如果需要，可能需要几天时间。

# c# - 在 3D 中绘制文本

> ID：12424226
> 
> 赞同：0
> 
> 时间：2012-09-14T12:07:07.213
> 
> 标签：c#, 3d, xna, text-rendering

我试图弄清楚如何在 3D 中绘制文本。

现在我有两种方法可以在屏幕上显示内容。一种使用通常的 3d 空间来渲染世界，并使用额外的渲染来渲染以预转换方式进行的 HUD。

因此，理想情况下，我想要一种对文本执行相同操作的方法，既可以 3D 渲染字符串（有点像“广告牌”方式），也可以使用预转换方式（就像我使用 2d 模式一样）。

我唯一能找到的是使用“Mesh.FromText”，但它似乎不是我需要的。哦，还使用 ​​spritebatch 将文本绘制到纹理，然后在 3D 中使用此纹理和 alpha 混合，但这似乎是一种糟糕的方法......

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:11:29.703

`SpriteBatch`您可以使用自定义效果在 3D 空间中绘制。[这篇博](http://blogs.msdn.com/b/shawnhar/archive/2010/04/05/spritebatch-and-custom-shaders-in-xna-game-studio-4-0.aspx)文有详细信息。

`BasicEffect`它就像将一个带有正确转换的效果（如）传递给`SpriteBatch.Begin`（[这个](http://msdn.microsoft.com/en-us/library/ff433700.aspx)）的适当重载一样简单。

（文本由透明精灵组成——因此所有在 3D 中使用透明绘图的常见注意事项都适用：对不透明的 Z 缓冲场景进行排序和绘制，或使用 alpha 测试。）

# java - 正则表达式匹配-Java

> ID：12424229
> 
> 赞同：1
> 
> 时间：2012-09-14T12:07:21.333
> 
> 标签：java, regex

我从以下格式的文件中获取输入：

```
(int1,int2) (int3,int4) 
```

现在我想在我的 Java 代码中读取 int1、int2、int3 和 int4。如何在java中使用正则表达式匹配来做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-14T12:12:39.393

```
String[] ints = "(2,3) (4,5)".split("\\D+");
System.out.println(Arrays.asList(ints));
// prints [, 2, 3, 4, 5] 
```

为避免空值：

```
String[] ints = "(2,3) (4,5)".replaceAll("^\\D*(.*)\\D*$", "$1").split("\\D+");
System.out.println(Arrays.asList(ints));
// prints [2, 3, 4, 5] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T12:12:49.943

```
Pattern p = Pattern.compile("\\((\\d+),(\\d+)\\)\\s+\\((\\d+),(\\d+)\\)");
String input = "(123,456) (789,012)";

Matcher m = p.matcher(input);

if (m.matches()) {
  int a = Integer.parseInt(m.group(1), 10);
  int b = Integer.parseInt(m.group(2), 10);
  int c = Integer.parseInt(m.group(3), 10);
  int d = Integer.parseInt(m.group(4), 10);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:14:09.997

您可以执行以下操作：

```
String str = "(1,2) (3,4)";
Matcher m = Pattern.compile("\\((\\d+),(\\d+)\\) \\((\\d+),(\\d+)\\)").matcher(str);
if (m.matches()) {
   System.out.println(m.group(1)); // number 1
   ...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T12:15:02.550

要构建您自己的方法，您可以使用更简单的正则表达式：

```
String s = "(1,2) (3,4)";
Pattern p = Pattern.compile("\\d+");
Matcher m = p.matcher(s);
while (m.find()) {
    System.out.println(m.group());
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-14T12:18:06.373

这将起作用：

```
String[] values = s.substring(1).split("\\D+"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-14T12:13:37.583

`"\\((\\d*),(\\d*)\\)\\s*\\((\\d*),(\\d*)\\)"`

# c# - 向多个文本框添加属性

> ID：12424230
> 
> 赞同：1
> 
> 时间：2012-09-14T12:07:23.183
> 
> 标签：c#, asp.net

我的 ASP.Net 网络表单包含许多文本框。我想为所有文本框添加“onfocus”和“onmouseover”属性。我可以使用以下代码执行此操作：

```
TextBox1.Attributes.Add("onfocus", "javascript:this.select();");
TextBox1.Attributes.Add("onmouseover", "javascript:this.select();");

TextBox2.Attributes.Add("onfocus", "javascript:this.select();");
TextBox2.Attributes.Add("onmouseover", "javascript:this.select();");

TextBox3.Attributes.Add("onfocus", "javascript:this.select();");
TextBox3.Attributes.Add("onmouseover", "javascript:this.select();"); 
```

但自从没有。TextBoxes 超过 35 个，我正在考虑使用循环来执行此操作。我尝试了以下代码：

```
if (!IsPostBack)
{
    foreach  (Control ctl in Controls)
    {
        if (ctl is TextBox)
               ctl.Attributes.Add("onmouseover", "javascript:this.select();");
    }
} 
```

但我收到以下错误：

'System.Web.UI.Control' 不包含'Attributes' 的定义，并且找不到接受'System.Web.UI.Control' 类型的第一个参数的扩展方法'Attributes'（您是否缺少 using 指令还是汇编参考？）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:12:05.450

你可以使用 Linq 的[`OfType`](http://msdn.microsoft.com/en-us/library/bb360913.aspx). 它返回给定类型的所有控件。

我建议将所有内容添加`TextBoxes`到容器控件中，例如 a `Panel`or `PlaceHolder`：

```
foreach(var txt in txtPanel.Controls.OfType<TextBox>())
{
    txt.Attributes.Add("onfocus", "javascript:this.select();");
    txt.Attributes.Add("onmouseover", "javascript:this.select();");
} 
```

确保您已添加`using System.Linq`.

这是另一种类似的方法，它查看当前页面中的所有面板：

```
this.Form.Controls.OfType<Panel>()
                  .SelectMany(p => p.Controls.OfType<TextBox>());
foreach (TextBox txt in allTextBoxes){} 
```

请注意，您还可以过滤`Panels`or `TextBoxes`（[`Enumerable.Where`](http://msdn.microsoft.com/en-us/library/bb534803.aspx)如果面板的 id 全部以 开头`txtPanel_`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:10:00.890

ctl 对象只是一个 web 控件，尽管您正在检查它是一个 TextBox，但在使用它之前您并没有将它作为一个对象进行转换......

尝试...

```
if (!IsPostBack)
{
    foreach  (Control ctl in Controls)
    {
        if (ctl is TextBox)
               ((TextBox)ctl).Attributes.Add("onmouseover", "javascript:this.select();");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:10:04.767

ctl 的类型仍然是 Control。为了让它成为一个文本框，你可以像这样转换它：

```
((TextBox)ctl).Attributes.Add("onmouseover", "javascript:this.select();"); 
```

或使用`as`运算符：

```
(ctl as TextBox).Attributes.Add("onmouseover", "javascript:this.select();"); 
```

这两者之间的区别在于，如果转换不成功，`as`它将返回一个引用，并且转换将引发异常，但是由于您已经使用运算符进行了检查，因此只需使用对您来说更好的那个。 但是，如果您使用多个分配，我会将强制转换提取到变量中，例如：`null``is`

```
if (ctl is TextBox)
{
  TextBox textBox = (TextBox) ctl;
  textBox.Attributes.Add("onmouseover", "javascript:this.select();")
  .....
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:10:09.110

您必须将其转换为文本框。ctl 仍然是一个控件，它没有 Attributes 属性。

```
((TextBox)ctl).Attributes.Add("onmouseover", "javascript:this.select();"); 
```

# json - 对地址进行地理编码并使用 lat/long 作为 JSON 中的变量提交到数据库

> ID：12424234
> 
> 赞同：0
> 
> 时间：2012-09-14T12:07:38.333
> 
> 标签：json, geocoding

我对网页设计相当陌生，我给自己设定了正确的任务。我正在尝试使用 Google Geocoder 对地址进行编码（存储在 5 个单独的输入中 - Address1、Address2、3、4、PostCode），然后我需要使用 Lat/Long 结果作为 JSON.php 中的变量来添加 Lat /长到数据库。

我已经构建了表单，并设置了 JSON 以将输入传递到数据库。我还使用了来自 google API 的地理编码脚本。

我的问题是如何使用谷歌地理编码器来提供纬度/经度结果，然后将它们存储为我可以在单独的 JSON.php 中使用的变量。

我的代码，目前是相当标准的 JSON.php 和标准的谷歌地理编码代码。

我将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:12:18.087

你可以做两件事中的一件……或者三到四件事，但这些是最有可能的几个选择：

1.  在用户提交表单之前使用 Javascript 获取纬度/经度，就像他们输入足够多的地址一样，并`input type="hidden"`在表单中填充字段，然后在表单提交时将这些字段传输到 PHP。

2.  表单提交后使用PHP查询地理编码器并获取纬度/经度，然后将结果直接存入数据库。

您是否考虑过在对其进行地理编码之前验证地址以确保其正确无误？即使地址不是真实的，谷歌也倾向于返回近似结果......（这有时很方便，但有时很麻烦）。

# wxpython - wxpython：用另一个全新的面板替换旧的内容- wx.SplitterWindow 对象水平拆分为两个面板

> ID：12424235
> 
> 赞同：0
> 
> 时间：2012-09-14T12:07:38.713
> 
> 标签：wxpython

我正在尝试在 wxpython 中构建这个 GUI 工具作为我项目的一部分。我有一个基本框架，它有一个拆分器窗口（wx.SplitterWindow 对象），水平拆分。首次打开应用程序时，它将仅显示带有一些文本的拆分器窗口。我还有一个菜单，其中包含绑定到相应事件处理程序的各种菜单项。现在，当我第一次单击特定的菜单项时，我需要创建一个新的 wx.Notebook 对象，其中包含与该事件处理程序相关的信息的页面，位于框架（wx.SplitterWindow 对象）。通常，我希望在旧内容之上创建一个新面板，这将是笔记本对象的父级。随后每次单击菜单项都应在笔记本中创建一个新页面。我可以知道如何实现吗？

以下是我编写的必要代码片段，但我在某处出现了严重错误：

# 此代码创建由两个面板组成的初始拆分器窗口：

```
 self.splitter = wx.SplitterWindow(self, id = wx.ID_ANY)
    self.panel1 = wx.Panel(self.splitter, id = wx.ID_ANY)
    self.panel2 = wx.Panel(self.splitter, id = wx.ID_ANY)
    self.panel1.SetBackgroundColour(wx.LIGHT_GREY)
    self.splitter.SplitHorizontally(self.panel1, self.panel2) 
```

# 第一个菜单项单击事件的代码：

```
def displayNodes(self,event):
    if hasattr(self, "notebook") == False: #If the notebook object has not been already created
        #create notebook if it does not exitst already. This script should be present in every event handler
        self.panel = wx.Panel(self,wx.ID_ANY)
        self.notebook = NotebookDemo(self.panel)
        #creating vertical sizer for the notebook
        self.sizer = wx.BoxSizer(wx.VERTICAL)
        self.sizer.Add(self.notebook, 1, wx.ALL|wx.EXPAND, 5)
        self.panel.SetSizer(self.sizer)
    self.nodesname = "nodes"
    self.nodesinstance = wx.SingleInstanceChecker(self.nodesname)
    if self.nodesinstance.IsAnotherRunning():
        self.notebook.ChangeSelection(self.nodesindex)
    else:
        #creating a tab
        self.nodesTab = TabPanel(self.notebook)
        self.notebook.AddPage(self.nodesTab, "List of all the nodes")
        self.nodes = wx.ListBox(self.nodesTab, 11, (10,40), (200,130), self.nodeslist, wx.LB_SINGLE)
        self.nodesindex = self.notebook.GetPageCount() - 1
        self.notebook.SetSelection(self.nodesindex)
        #self.Bind(wx.EVT_CONTEXT_MENU, self.OnShowPopup) 
```

PS：我对wxpython的了解有限，还在学习中！如果可以以一种非常优雅的方式实现目标，那就太高兴了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:20:54.293

您可能可以使用我在面板切换教程中谈到的方法：http: [//www.blog.pythonlibrary.org/2010/06/16/wxpython-how-to-switch-between-panels/](http://www.blog.pythonlibrary.org/2010/06/16/wxpython-how-to-switch-between-panels/)

或者，您可以显示/隐藏笔记本对象，检查哪个是活动的，然后将选项卡添加到活动的对象，而不是替换面板。

# php - 如何让 php echo 和 die 消息与 jQuery 通知插件一起使用

> ID：12424237
> 
> 赞同：0
> 
> 时间：2012-09-14T12:07:45.760
> 
> 标签：php, notifications, echo, die

我创建了一个联系表单，并设置为通过 mail.php 文件发送表单内容。目前，它分别通过 echo 和 die 在新的空白页面上显示成功/错误消息，但我希望在当前页面上弹出某种通知。

我想使用的解决方案是[http://www.sandbox.timbenniks.com/projects/jquery-notice/](http://www.sandbox.timbenniks.com/projects/jquery-notice/)，但该站点上的演示使用了将通知添加到按钮的示例。我需要做的是添加通知来代替 echo 或 die 输出消息。这可能吗？

这是我正在使用的 mail.php 代码...

```
<?php $name = $_POST['name'];
  $email = $_POST['email'];
  $phone = $_POST['phone'];
  if (isset($_POST['service'])) {
    $service = $_POST['service'];
    // $service is an array of selected values
  }
  $message = $_POST['message'];
  $formcontent=" Message received from wwww.jhnormanandsons.co.uk: \n \n From: $name \n Phone: $phone \n \n Service required: $service \n \n Message: $message";
  $recipient = "jasonbradberry@gmail.com";
  $subject = "You have a new message from $name";
  $mailheader = "From: $email \r\n";
  mail($recipient, $subject, $formcontent, $mailheader) or die("Error!");
  echo ("Thank you for your message. We'll be in touch as soon as we can.");
?> 
```

这是表单HTML...

```
<form id="contact-form" method="post" action="mail.php" name="jh_contact">
  <input type="text" id="name" name="name" placeholder="Name" required />
  <input type="email" id="email" name="email" placeholder="Email" required />
  <input type="tel" id="phone" name="phone" placeholder="Phone" required />
  <textarea id="message" name="message" placeholder="Message" required ></textarea>
  <select name="service">
    <option>Service required</option>
    <option value="MOT">MOT</option>
    <option value="Service / repairs">Service / repairs</option>
    <option value="Cars for sale">Cars for sale</option>
    <option value="Welding">Welding</option>
    <option value="Exhausts">Exhausts</option>
    <option value="Tyres">Tyres</option>
    <option value="Brakes">Brakes</option>
    <option value="Diagnostics">Diagnostics</option>
    <option value="Vehicle checks">Vehicle checks</option>
    <option value="Courtesy car">Courtesy car</option>
    <option value="Advice">Advice</option>
    <option value="Other">Other</option>
  </select>
  <input type="submit" value="Send" id="submit-button" name="submit" />
</form> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:16:45.043

使用 Jquery post 提交您的表单。并让通知消息显示为 json...

[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

搜索此行以使用 jquery 提交您的表单

“示例：使用 ajax 请求发送表单数据”...

回应..写下这段代码（取自你添加的通知链接）

jQuery.noticeAdd({ text: data , //你的通知消息保持：true });

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:14:48.140

我也会禁用 JavaScript 的表单，然后使用 jQuery 将表单发布到页面并以这种方式解析任何正常的成功消息。

```
<?php
if (isset($_POST['send'])) {
    // process form
    if ($sent === true) {
        $alert_class = 'success';
        $alert_test = 'Your enquiry was sent successfully.';
    }
    else {
        $alert_class = 'error';
        $alert_text = 'There was an error sending your enquiry.';
    }
}
?>
<!DOCTYPE html>
<html>
  <body>
<?php if (isset($alert_text)): ?>
    <div class="alert <?php echo $alert_class; ?>">
      <p><?php echo $alert_text; ?></p>
    </div>
<?php endif; ?>
    <form action="" method="post" id="contact-form">
      <!-- your form -->
    </form>
  </body>
</html> 
```

然后是 jQuery：

```
(function($) {
    $('#contact-form').submit(function() {
        $.post($(this).attr('action'), $(this).serialize(), function(response) {
            var alert_text = $(response).find('.alert').text();
            alert(alert_text);
        });
        return false;
    });
})(jQuery); 
```

希望有帮助。

# javascript - 在 Google 地图中模拟点击

> ID：12424239
> 
> 赞同：15
> 
> 时间：2012-09-14T12:07:53.807
> 
> 标签：javascript, google-maps-api-3, drupal-6, geolocation, cck

我正在尝试使用 API v3 模拟用户点击谷歌地图，在他们写下他们的地址后，我对他们的位置进行了地理定位。

我曾经做：

```
google.maps.event.trigger(map, 'click', {
    latLng: new google.maps.LatLng(lat, lng)
}); 
```

但现在我得到一个错误：

> 未捕获的类型错误：无法读取未定义 main.js:727 的属性“wa”

我需要模拟点击，因为我正在使用带有 CCK 字段的 Drupal，如果我将位置选择添加为标记，它会在引擎盖下的点击上执行此操作。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-15T14:21:02.270

地图对象的“点击”事件将[**google.maps.MouseEvent**](https://developers.google.com/maps/documentation/javascript/reference#MouseEvent)对象作为参数：

```
var mev = {
  stop: null,
  latLng: new google.maps.LatLng(40.0,-90.0)
}

google.maps.event.trigger(map, 'click', mev); 
```

[**现场示例在这里**](http://maps.forum.nu/v3/gm_elevation.html)

# c# - 从 DbDataReader 读取/序列化时避免代码重复？

> ID：12424241
> 
> 赞同：2
> 
> 时间：2012-09-14T12:07:53.963
> 
> 标签：c#, design-patterns, lambda, dbdatareader

考虑下面的`FetchData`方法。它旨在避免每次您想从数据库中获取一些数据时重复数据库查询代码。

```
List<MyData> myData = new List<MyData();
FetchData((IDataReader reader) =>
   {
       myData.Add(new MyData(reader.GetString(0), reader.GetInt32(1)));
   }, "usp_get_my_data"); 
```

`FetchData`它可以工作，但如果这个对象创建能够以某种方式存在于方法中，那就太好了。

**有更好的方法吗？**

也许`FetchData`可以修改为直接返回某个类型 X 的列表？

```
protected void FetchData(Action<IDataReader> processor, String query)
{
    using (var connection = CreateConnection())
    {
        connection.ConnectionString = ConnectionString;
        connection.Open();

        using (var command = connection.CreateCommand())
        {
            command.CommandType = CommandType.StoredProcedure;
            command.CommandText = query;

            using (IDataReader reader = command.ExecuteReader())
            {
                while (reader.read())
                {
                    processor(reader);
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:14:59.600

也许使用泛型？

```
protected IEnumerable<T> FetchData<T>(Func<IDataReader, T> processor, String query)
{
    using (var connection = CreateConnection())
    {
        connection.ConnectionString = ConnectionString;
        connection.Open();

        using (var command = connection.CreateCommand())
        {
            command.CommandType = CommandType.StoredProcedure;
            command.CommandText = query;

            using (IDataReader reader = command.ExecuteReader())
            {
                while (reader.read())
                {
                    yield return processor(reader);
                }
            }
        }
    }
} 
```

然后，您可以根据需要使用枚举：

```
var myData = FetchData<MyData>(reader => new MyData(reader.GetString(0), reader.GetInt32(1)), "usp_get_my_data").ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:28:37.680

您可能会看一下[Dapper.Net](http://code.google.com/p/dapper-dot-net/)，它是具有三个不同助手的单文件 ORM：

1.  执行查询并将结果映射到强类型列表
2.  执行查询并将其映射到动态对象列表
3.  执行不返回结果的命令

用于构建这个 miro-ORM 的设计模式非常有用。[Dapper.Net 目前正在 StackOverflow 中使用](http://www.infoq.com/news/2011/04/dapper-released)。

# iphone - 什么是自动布局？

> ID：12424248
> 
> 赞同：26
> 
> 时间：2012-09-14T12:08:25.927
> 
> 标签：iphone, ios, xcode, cocoa-touch, autolayout

什么是自动布局 - 它有什么作用，它是 iOS 5 的功能吗？

由于新的 iPhone 5 有更大的屏幕，所有关于如何优化应用程序的选项都归结为自动布局。

你能指点我一些关于自动布局的文章，以及我如何在我的项目中调整它吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-14T12:11:57.953

我推荐观看 WWDC 2012 会议[Introduction to Auto Layout for iOS and OS X](https://developer.apple.com/videos/wwdc/2012/?id=202)。

[Auto Layout](https://developer.apple.com/library/mac/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html)是一种定义动态 GUI 的新方法。之前，我们有自动调整大小的掩码，它描述了在调整其父视图大小时子视图将如何调整大小或移动。使用自动布局，您可以很容易地做同样的事情，也可以做很多更复杂的 GUI。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T12:10:43.337

[https://developer.apple.com/library/mac/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html](https://developer.apple.com/library/mac/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html)

“如果 iOS 6 中的 Auto Layout 与 Mac OSX 10.7 中的 Cocoa Auto Layout 类似，那么公开文档 Cocoa Auto Layout Guide 可能会让您了解它在 Cocoa Touch 中的工作方式。

Cocoa Touch 使用的底层引擎是 Cassowary，它也用于其他工具包，例如 enaml。我最近写了一篇关于 Cassowary 的简要概述，比较了 Cocoa Touch 和 enaml，其中我将一个 Cocoa Auto Layout 示例移植到 Python 和 enaml。”

来自：[https ://stackoverflow.com/a/11129597/1648976](https://stackoverflow.com/a/11129597/1648976)

以及 WWDC 会议：[https ://developer.apple.com/videos/wwdc/2012/?id=202](https://developer.apple.com/videos/wwdc/2012/?id=202)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T12:11:22.347

iOS 6 仍处于保密协议下。再坚持几天。这是 iOS 6> 的一项功能。如果您有开发者帐户，您必须已经能够从文档或 WWDC 2012 会议视频中了解自动布局。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-28T13:56:35.720

“自动布局”用于调整布局以适应不同的屏幕尺寸、方向和本地化。

在 Autolayout 中，我们不根据“x”和“y”坐标（旧式）提供输入。相反，我们使用视图中元素之间的数学关系来定义布局。我们可以使用约束或单个元素或一组元素之间的约束来定义这种关系。一旦我们使用这种关系重新定义布局。我们的应用程序不仅可以根据设备尺寸（如 iPhone 中的 5 英寸或 5.5 英寸）适应不同的布局，还可以根据方向和本地化进行调整。

如需进一步了解，您可以访问：[http ://www.raywenderlich.com/83129/beginning-auto-layout-tutorial-swift-part-1](http://www.raywenderlich.com/83129/beginning-auto-layout-tutorial-swift-part-1)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-14T09:45:09.733

**什么是自动布局？**

Auto Layout 是一个基于约束的布局系统。它允许开发人员创建一个自适应界面，以适当地响应屏幕尺寸和设备方向的变化。如果不使用自动布局，您将很难构建一个支持所有屏幕尺寸的应用程序。

[![在此处输入图像描述](../Images/853004b73794748a900e7ecfb1521d65.png)](https://i.stack.imgur.com/uzllR.png)

**为什么要自动布局？**

自动布局是一种让开发人员通过定义元素之间的关系来创建用户界面的方法。它提供了一个灵活而强大的系统来描述视图和 UI 控件如何相互关联。通过使用自动布局，您可以通过广泛的自定义获得令人难以置信的布局控制，并产生完美的界面。

Auto Layout 与 Apple 的许多最令人兴奋的应用程序编程接口 (API) 兼容，包括动画、运动效果和精灵。

[![在此处输入图像描述](../Images/9f23c20ae6899bcf5ac6e1e1cd21c80f.png)](https://i.stack.imgur.com/lnEUt.jpg)

参考： [https ://www.appcoda.com/introduction-auto-layout/](https://www.appcoda.com/introduction-auto-layout/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-01T12:48:31.347

UIView Autolayout 是 iOS App 开发中一个非常有趣的概念。自动布局负责响应式设计。iPhone 每次都有不同的屏幕尺寸。在 Autolayouts 的帮助下，您不必每次都创建您的 App 设计。自动布局负责响应式设计。

这篇关于[“Autolayouts 简介”的](https://www.codzify.com/swiftIOS/introduction-auto-layout.php)文章会让你对它有足够的了解。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-10-06T11:28:23.067

自动布局的最佳教程链接：

1.  [https://www.youtube.com/watch?v=ugqFWPsY_A0](https://www.youtube.com/watch?v=ugqFWPsY_A0)
2.  [https://www.youtube.com/watch?v=vzyd33Pv9kg](https://www.youtube.com/watch?v=vzyd33Pv9kg)
3.  [https://www.youtube.com/watch?v=Nl2iMF0yKW8](https://www.youtube.com/watch?v=Nl2iMF0yKW8)
4.  [https://www.youtube.com/watch?v=Gl6DibzPYa4](https://www.youtube.com/watch?v=Gl6DibzPYa4)
5.  [https://www.youtube.com/watch?v=J10vzrTcswI](https://www.youtube.com/watch?v=J10vzrTcswI)
6.  [https://www.youtube.com/watch?v=izES1zQjRUU](https://www.youtube.com/watch?v=izES1zQjRUU)

# json - 构建 API 响应

> ID：12424251
> 
> 赞同：1
> 
> 时间：2012-09-14T12:08:55.043
> 
> 标签：json, api

我不确定从我们的 API 构建响应的最佳方式。

每个响应都应该有一个“结果”或“成功”节点吗？

我正在考虑以下模板：

```
 -result (true/false)
   -data (only if result is true)
   -errors (only if result is false) 
```

这是公认的做法，还是有更标准的做事方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:14:13.863

我认为你应该看看 RESTful API 的实现。对于错误，您可以使用 HTTP 状态。如果状态为 200，则一切正常。你可以在这里阅读[http://www.infoq.com/articles/designing-restful-http-apps-roth](http://www.infoq.com/articles/designing-restful-http-apps-roth)

# javascript - ASP.Net 在 $.ajax 成功时调用代码隐藏

> ID：12424255
> 
> 赞同：0
> 
> 时间：2012-09-14T12:09:21.747
> 
> 标签：javascript, asp.net, ajax

我有一个带有代码隐藏的页面（default.aspx）。a$.ajax url 正在从一个地方获得响应，并且在成功后我想调用 codebehind 函数。

（如果我在混淆代码时犯了错误，$.ajax 可以完美运行，我会得到想要的响应）。

这怎么可能？

我正在使用的代码：

```
 jQuery.support.cors = true; // force cross-site scripting (as of jQuery 1.5)
    $.ajax({
                type: "POST",
                url: URL,
                data: parameters,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {

                    var resultCount = response.d
                    alert("*** RESULT ****" + resultFields);;
                    var string = StringReturn(); // the codebehind
                    alert(string);
                },
                error: function (e) {
                    alert("Unavailable");
                }
            }); 
```

代码隐藏：

```
 [WebMethod]
protected static string StringReturn()
{
    return "StringReturn() success";
} 
```

但是，我收到错误消息说 StringReturn 不是一个有效的函数。

任何帮助，将不胜感激？

我已按照建议将以下代码行添加到页面中：

```
 <asp:ScriptManager ID="ScriptMgr" runat="server" EnablePageMethods="true"> </asp:ScriptManager> 
```

我还更改了代码以在 Success 事件上调用 javascript 函数，该函数为：

```
 function HelloWorlds() {

        alert("HelloWorld() method");
        message = PageMethods.StringReturn();
        message.toString();
        alert(message);
    } 
```

但是这似乎不起作用。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:13:22.647

您需要在页面上有一个 scripmanager，然后您可以像这样调用它 PageMethods.StringReturn()

# jenkins - 如何从 Jenkins 中提取数据并将其显示为自定义网页

> ID：12424256
> 
> 赞同：1
> 
> 时间：2012-09-14T12:09:29.353
> 
> 标签：jenkins

我目前正在为我的构建系统使用 Jenkins，并且我已经集成了几个插件。我可以在 Jenkins 中提取数据并将其显示在自定义网页上吗？

例如，我正在使用 cobertura 插件来显示我的测试覆盖率结果。我希望 cobertura 显示的所有数据（例如图表...）都显示在我拥有的自定义网页上（Jenkins 之外）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:12:04.277

这是 Jenkins 提出的所有建议： [Jenkins Remote access API](https://wiki.jenkins-ci.org/display/JENKINS/Remote+access+API)

# php - 在php中使用变量类型变量作为数组名称

> ID：12424257
> 
> 赞同：0
> 
> 时间：2012-09-14T12:09:31.013
> 
> 标签：php, arrays, variables, hyperlink

我正在尝试在我的网络中创建一个动态菜单，其中每个部分仅显示一些页面。

我写的代码是：

```
$menulist=array();

$menulist[1]='file1%#16';

$menulist[2]='file2%#9';

$menulist[3]='file3%#19';

$menulist[4]='file4%#8';

$menulist[5]='file5%#13';

$menulist[6]='file6%#14';

$menulist[7]='file7%#10';

$menulist[8]='file8%#23';

$menulist[9]='file9%#19';

$menulist[10]='file10%#18';

$menulist[11]='file11%#12';

function actualizaciones($matriz)

{

$linea=explode("%#",$matriz);

echo '&lt;li&gt;&lt;a href="first_chunk_of_URL'.$linea[0].'middle_chunk_of_url'.$linea[1].'last_chunk_of_URL"&gt;'.${$linea[0]}[$linea[1]].'&lt;/li&gt;;

}

echo '&lt;ul&gt;';

array_walk($menulist,'actualizaciones');

echo '&lt;/ul&gt;'; 
```

每个`$linea[0]`字符串都是另一个数组的名称（此代码中未显示），其中包含应该在与传递的每个键对应的每个可能链接中的文本`$linea[1]`。

我一定是做错了什么，因为超链接工作正常，但上面没有显示文字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:13:45.313

使用像下面这样的简单字符

```
echo '<li><a href="first_chunk_of_URL'.$linea[0].'middle_chunk_of_url'.$linea[1].'last_chunk_of_URL"&gt;'.${$linea[0]}[$linea[1]].'<li>'; 
```

你的代码中的问题是

```
.'&lt;/li&gt;;

         ^^^^^

        here is the problem it should be

.'&lt;/li&gt;'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:15:08.520

如果我没看错，你问的是如何在 PHP 中使用可变变量。

这可以使用双美元语法来完成 - 即`$$linea[0]`. 有关更多信息，请参阅 PHP 手册：http: [//uk.php.net/manual/en/language.variables.variable.php](http://uk.php.net/manual/en/language.variables.variable.php)

但如果这就是你正在做的事情，我会说你没有写出好的代码：如果涉及变量变量，那么几乎总是有更好的方法来做。

如果不了解更多关于您正在尝试做什么的信息，这里真的无法提供更好的帮助，但听起来您应该使用子数组而不是为所有内容单独命名变量。

希望有帮助。

# php - 如何将变量传递给 PHP 中的 MySQL 查询？

> ID：12424261
> 
> 赞同：0
> 
> 时间：2012-09-14T12:09:35.583
> 
> 标签：php, mysql

我有以下 MySQL 命令尝试获取用户的登录信息：

```
$requete = "SELECT login, pass FROM membres WHERE login='$login' AND pass='$pass'";
echo ("$requete"); 
```

它不工作。问题是，在执行此代码时，我看到以下输出（而不是执行查询的结果）：

```
SELECT login, pass FROM membres WHERE login='$login' AND pass='$pass' 
```

在 PHP 中将变量传递给 MySQL 查询的正确方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T13:08:56.590

在 PHP 中，与许多其他编程语言一样，`=`运算符将右侧操作数的值[分配给](http://php.net/manual/en/language.operators.assignment.php)左侧操作数变量。即这样的命令执行后，符号左侧命名的变量`=`将包含符号右侧表达式的值`=`。

您的右手操作数是一个[双引号字符串字面](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.double)量，其中 PHP 用它们的值扩展（替换）变量；但是，结果（分配给左侧操作数）只是一个字符序列。

PHP 的[`echo`](http://php.net/manual/en/function.echo.php)构造将其参数转换为字符串，按顺序连接它们并将结果发送到输出缓冲区。

在您的情况下，唯一的参数是另一个双引号字符串 literal `"$requete"`，其中 PHP 再次使用它们的值扩展变量：这次文字的内容仅仅是 variable `$requete`，因此引用它只会导致多余的解析开销；并且由于该变量被分配了前一个字符串文字，因此结果字符串（由 输出`echo`）等于原始字符串文字。因此，您的两个陈述具有相同的效果：

```
echo "SELECT login, pass FROM membres WHERE login='$login' AND pass='$pass'"; 
```

PHP 没有被告知存在 RDBMS，这是您希望由该 RDBMS 评估的 SQL，或者您希望输出生成的结果集。

**更糟糕的是，除非您*绝对确定*并且`$login`不`$pass`包含未转义`'`的字符，否则为 SQL 解析该字符串可能会导致意外行为。** 攻击者经常利用这种疏忽来执行[SQL 注入攻击](https://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain)，这可能会危及您的整个数据库。避免这种情况的最安全方法是永远*不要**评估*SQL 的变量，而是使用[准备好的语句](https://stackoverflow.com/a/60496/623041)，将变量作为参数传递到其中。

我建议您研究[PHP Data Objects](http://uk.php.net/manual/en/book.pdo.php)，它使安全数据库访问变得非常容易：

```
$dbh = new PDO("mysql:dbname=$dbname;charset=utf8", $username, $password);
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

$qry = $dbh->prepare('
  SELECT login, pass
  FROM   membres
  WHERE  login = ? AND pass = ?
');

$qry->execute(array($login, $pass));
while ($row = $qry->fetch(PDO::FETCH_ASSOC)) print_r($row); 
```

不过，有几点需要注意：

1.  您只是从与常量值匹配的数据库字段中进行选择，这是毫无意义的：从此类查询中可以获得的唯一信息是数据库中匹配记录的数量，但是在返回多余的数据时会浪费资源。

    相反，您可以`SELECT COUNT(*) FROM membres WHERE ...`在不浪费任何开销的情况下获取相同的信息；或者如果您只想发现是否有一条或多条匹配记录，`SELECT EXISTS (SELECT * FROM membres WHERE ...)`效率会更高。

2.  您似乎正在创建一个登录脚本，以安全的方式完成这项工作并非易事：如果您有兴趣了解更多信息，请阅读[The Definitive Guide To Forms based Website Authentication 。](https://stackoverflow.com/a/477578/623041)那里有一些库和工具，您可以将它们放入您的项目中，以避免在重新发明轮子上浪费资源（以及其他人从艰难中学到的所有许多痛苦的错误）。

# extjs - 单击蒙版时如何关闭模态窗口extjs？

> ID：12424263
> 
> 赞同：13
> 
> 时间：2012-09-14T12:09:56.930
> 
> 标签：extjs, modal-dialog, extjs4.1

如果我创建一个模式窗口：

```
Ext.define('myWindow', {
    extend: 'Ext.Container',
    alias: 'widget.myWindow',
    floating: true,
    modal: true,
    listeners:
        'onMaskClick???': { close the window }
    .....
} 
```

我如何知道用户何时点击了窗口外的遮罩？在 Sench Touch 中，有一个配置 hideOnMaskTap 可以让我指定。extJS 的事件/配置是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-20T13:05:02.870

Tramway 的案例（有点）适用于模态或非模态窗口。但如果子组件（如组合框的边界列表）浮动在窗口边界之外，则不会。

但是，如果您仍然使用模态窗口，您可以像这样在掩码上侦听单击事件。

```
Ext.define('myWindow', {
    extend: 'Ext.window.Window',
    alias: 'widget.myWindow',
    floating: true,
    modal: true,

    initComponent: function () {
        var me = this;
        me.callParent(arguments);
        me.mon(Ext.getBody(), 'click', function(el, e){
            me.close(me.closeAction);
        }, me, { delegate: '.x-mask' });
    }
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-15T08:41:54.553

可以监听所有点击事件，然后检查点击位置是否在窗口外

```
Ext.define('myWindow', {
    extend: 'Ext.Container',
    alias: 'widget.myWindow',
    floating: true,
    modal: true,

    initComponent: function () {
        this.initEvents();
        this.callParent();
    },

    initEvents: function () {
        //make sure your window is rendered and have sizes and position
        if(!this.rendered) {
            this.on('afterrender', this.initEvents, this, {single: true});
            return;
        }

        this.mon(Ext.getBody(), 'click', this._checkCloseClick, this);
    }

    _checkCloseClick: function (event) {
        var cx = event.getX(), cy = event.getY(),
            box = this.getBox();

        if (cx < box.x || cx > box.x + box.width || cy < box.y || cy > box.y + box.height) {
            //clean up listener listener
            this.mun(Ext.getBody(), 'click', this._checkCloseClick, this);
            this.close();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-02T14:07:44.930

你也可以试试这个：

```
Ext.getBody().on('click', function(e, t){
    var el = win.getEl();

    if (!(el.dom === t || el.contains(t))) {
        win.close();
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-25T10:33:49.910

我发现在 body 中添加一个监听器并检查 css 类对我来说有点生硬。您实际上可以覆盖（请参阅，完全不是hackey）`_onMaskClick`的私有方法。`Ext.ZIndexManager`它允许您将自己的配置参数（甚至事件）添加到所有窗口。

```
Ext.define('MyApp.ux.ZIndexManager_maskClick', {
  override: 'Ext.ZIndexManager',

  _onMaskClick: function ()
  {
    if (this.front)
    {
      var allowed = this.front.fireEvent('maskclick', this.front, this.mask);

      if (allowed !== false && this.front.closeOnMaskClick)
        this.front.close();
    }
    return this.callParent(arguments);
  },
}); 
```

# openldap - 使用 WSO2 身份服务器配置外部 LDAP 用户存储

> ID：12424267
> 
> 赞同：1
> 
> 时间：2012-09-14T12:10:04.583
> 
> 标签：openldap, wso2carbon

我当前的配置是

#

```
 <UserManager>
    <Realm>
        <Configuration>
                <AdminRole>admin</AdminRole> 
                <AdminUser>
                     <UserName>admin</UserName>
                     <Password>XXXXXX</Password>
                </AdminUser>
            <EveryOneRoleName>everyone</EveryOneRoleName> <!-- By default users in     thsi role sees the registry root -->
<!--            <ReadOnly>false</ReadOnly> -->
            <MaxUserNameListLength>500</MaxUserNameListLength>
            <Property name="url">jdbc:h2:repository/database/WSO2CARBON_DB</Property>
            <Property name="userName">wso2carbon</Property>
            <Property name="password">wso2carbon</Property>
            <Property name="driverName">org.h2.Driver</Property>
            <Property name="maxActive">50</Property>
            <Property name="maxWait">60000</Property>
            <Property name="minIdle">5</Property>
        </Configuration>
        <UserStoreManager
            class="org.wso2.carbon.user.core.ldap.LDAPUserStoreManager">
            <Property name="ConnectionURL">ldap://localhost:389</Property>
            <Property name="ConnectionName">cn=admin,dc=ysd,dc=com</Property>
            <Property name="ConnectionPassword">admin32</Property>
            <Property name="UserSearchBase">ou=People,dc=ysd,dc=com</Property>
            <Property name="UserNameListFilter">(objectClass=person)</Property>
            <Property name="UserNameAttribute">uid</Property>
            <Property name="ReadLDAPGroups">false</Property>
            <Property name="GroupSearchBase">ou=People,dc=ysd,dc=com</Property>
            <Property name="GroupSearchFilter">(objectClass=groupOfNames)</Property>
            <Property name="GroupNameAttribute">cn</Property>
            <Property name="MembershipAttribute">member</Property>
        </UserStoreManager>
        <AuthorizationManager
            class="org.wso2.carbon.user.core.authorization.JDBCAuthorizationManager">
        </AuthorizationManager>
    </Realm>
</UserManager>` 
```

#

**启动服务器时出现以下错误。** **错误 {org.wso2.carbon.user.core.common.DefaultRealm} - 无法创建 org.wso2.carbon.user.core.ldap.LDAPUserStoreManager 。错误是：null java.lang.reflect.InvocationTargetException* * ......................................................................

**原因：org.wso2.carbon.user.core.UserStoreException：LDAPUserStoreManager 无法在读写模式下操作。这是无效的配置。它只能在 org.wso2.carbon.user.core.ldap.LDAPUserStoreManager.(LDAPUserStoreManager.java:97) 的 ReadOnly 模式下运行 ... 25 更多**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T05:42:28.803

您的具体要求是什么？您是希望 Identity Server 对外部 LDAP 进行读写操作还是只进行读取操作？

您会收到此异常，因为您尝试将只读 ldap 用户存储用于两个读写操作。将参数设置`<ReadOnly>false</ReadOnly>`为true，则此错误将消失。

但是，如果您的要求是将 IS 用于两个读写操作，请使用 ApacheDSUserStoreManager。您可以为此使用 LDAPUserStoreManager。

# c - C：配置文件和命令行解析器

> ID：12424271
> 
> 赞同：0
> 
> 时间：2012-09-14T12:10:09.373
> 
> 标签：c, configuration, configuration-files

我正在寻找一些能够使用一些规则系统解析文件和命令行的 C 库，以便我可以指定应该接受哪些参数以及它们的类型。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:13:34.160

对于简单的命令行解析，您可以[`getopt`](http://linux.die.net/man/3/getopt)使用`getopt_long`. 这个函数当然也可以用于配置文件，如果它们遵循与命令行选项相同的格式，则需要一点“预解析”。

注意：`getopt`在 POSIX 系统上是标准的，例如 Linux 和 Mac OSX，但在 Windows 上不是。不过，可以找到适用于 Windows 的实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T13:13:14.110

您可以使用提供[命令行选项解析器](http://developer.gnome.org/glib/2.32/glib-Commandline-option-parser.html)的 GLib ，您可以为每个选项指定一个类型。这个库还提供了一个简单的[键/值文件解析器](http://developer.gnome.org/glib/2.32/glib-Key-value-file-parser.html)。即使您仍然需要编写一些代码（至少从 ini 文件生成 GOptionEntry），也可能值得尝试一下……
GLib 在 Linux、MacOSX 和 Windows 上可用。

# jquery - jQuery ajax 作用域和 dom 操作

> ID：12424278
> 
> 赞同：0
> 
> 时间：2012-09-14T12:10:40.683
> 
> 标签：jquery, dom, scope

我有一个 js 文件（在页眉中调用），其中包含一些在名为 admin.js 的 CMS 的每个页面上运行的代码。它包含一些使用 jQuery 文件上传插件处理文件上传的代码。

我正在 CMS 中构建一个小部件系统。它使用引导模式。如果我将文件上传表单放在模式中，文件上传工作正常，但如果我在模式中使用 ajax 加载表单，文件上传插件不会触发。

modal 和 ajax 的代码是这样的：

```
$('#widget').on('show', function (event) {
    var page_id = $('#widget').data('modal').options.page_id;
    var widget_id = $('#widget').data('modal').options.widget_id;
    $.ajax({
        url: ADMIN_INCLUDES_URL + 'widget/widget.php',
        dataType: 'html',
        type: 'POST',
        async: false,
        data: {
            'page_id': page_id,
            'widget_id': widget_id,
            'action': 'form'
        },
        success: function(r){
            $('#widget').html(r);
        }
    });
}); 
```

我不想复制文件上传js代码。我正在使用 .on() 并且我也尝试过 .live() 但都不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T10:44:51.073

试试这个，您需要使用在任何 ajax 调用之前存在的容器并将动态元素绑定到该容器

例如 - 这会将点击事件绑定到现在和将来的任何 .click 元素，它是 #widget 的子元素

```
$('#widget').on('click', '.click', function(){ console.log('clicked');}); 
```

# mocking - Functional testing a one page app, with local aliased api calls

> ID：12424286
> 
> 赞同：0
> 
> 时间：2012-09-14T12:11:05.940
> 
> 标签：mocking, cucumber, functional-testing, watir-webdriver, single-page-application

I'm trying to do an end-to-end smoke test for a one page app, and stuck with the following:

*   The app just runs as a bunch of HTML pages, and has no server side code (I'm running Apache locally to serve the pages).

*   The API calls are to /api/blah and I currently have an alias in my httpd.conf that redirects the /api/blah call to the proper server API (www.example.com/api/blah).

*   The API has an SSO requirement, so I want to avoid calling the actual API during functional testing.

I've got cucumber setup locally, with watir-webdriver handling the browser control. I've got a few tests running with the intial state, but would love to mock out the calls to the API with some dummy JSON I have stored with the project.

The tests will be eventually run on a TeamCity CI server.

I tried using WebMock and FakeWeb, but they're looking for serverside calls - so the ajax calls from the app are never hitting something they can intercept.

I've also looked into maybe firing up the server with jsTestDriver, then mocking it out there, but can't get the two to connect.

Are there any solutions for this out there, or has anyone had this problem and solved it reliably?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T08:08:47.613

There are several ways you could solve this.

1.  You could start a little HTTP server process serving your JSON fixtures alongside Cucumber and shut it down when the feature suite has finished loading. This could be written in Ruby/Node.js/whatever you like.

    You'll probably want to make the API base URI configurable so that it interacts with this little test server when automated by Cucumber but calls the real thing in production.

2.  Stub XMLHttpRequest (given that's what you're using to make API calls) and return the fixtures from there.

I would go for #1: make the base URI configurable instead of that forged "/api/blah" path and serve whatever you want in your specs through some basic HTTP server.

# jdbc - PreparedStatement.setNull(int parameterIndex, int sqlType)

> ID：12424287
> 
> 赞同：5
> 
> 时间：2012-09-14T12:11:06.720
> 
> 标签：jdbc

## 问题 #1

谁能告诉我使用以下代码我将获得什么好处，什么`sPhoneExt`时候`null`？

```
if (sPhoneExt == null || sPhoneExt.trim().equals("")) {
    stmt.setNull(9, java.sql.Types.INTEGER);
} else {
    stmt.setString(9, sPhoneExt);
} 
```

代替`stmt.setString(9, sPhoneExt);`

因为如果值为 SQL`iPhoneType = rset.getInt("phone_type");`将返回；我不想要。`0``NULL`

* * *

## 问题2

只是好奇`stmt.setString(9, null)`被执行的回报是`rset.getInt("phone_type")`什么？

## 答案#2

`getInt()`当它在 DB 中为空时将返回零。您必须使用下面的代码来了解 DB `NULL`。

```
if (rs.wasNull()) {
    // handle NULL field value
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-13T05:40:53.607

`setNull`在这种 String 案例中使用我没有看到任何好处。它仅用于检查空字符串“”并在数据库中插入空值。但为此，我们也可以这样做`stmt.setString(9, null);`

但是当 sPhoneExt 为 Integer 且为 null 时，我们无法执行 `stmt.setInt(9, sPhoneExt);` ，因为`setInt(int, int)`API 执行；将（拆箱）sPhoneExt（整数）转换为原始（整数），所以你会得到 NullPointerException。所以你需要`stmt.setNull(9, java.sql.Types.INTEGER);`

最后，如果您在数据库中为 NUMBER（sql 类型）列插入了 null；getInt() 将仅返回 0。

这与下面的空集机制无关。

```
stmt.setString(9, null);
stmt.setNull(9, java.sql.Types.INTEGER) 
```

也有人告诉 DB NUMBER 列何时具有默认值；上述两行将以不同方式考虑该默认值。但事实并非如此。即使在那种情况下，上述两条线也以相同的方式执行。为设定`NULL`值；不是默认值。

```
create table t1 (id number default 1 );
insert into t1 (id) values (2); 
```

```
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class TestDB {
    public static void main(String args[]) {
        PreparedStatement stmt = null;
        ResultSet rs = null;
        Connection con = null;
        try {
            Class.forName("oracle.jdbc.driver.OracleDriver");
            con = DriverManager.getConnection("jdbc:oracle:thin:@10.201.32.92:1521:psprd1", "username", "password");
            String query = null;
            String l = null;
            ResultSet rset = null;
            int paramIndex = 1;
            query = "UPDATE t1 " + " SET id = ?";

            stmt = con.prepareStatement(query);
            stmt.setInt(paramIndex++, null);
            // stmt.setNull(1, java.sql.Types.INTEGER);
            stmt.executeUpdate();
            stmt.close();

            query = "select id from t1 ";
            stmt = con.prepareStatement(query);
            rset = stmt.executeQuery();
            rset.next();
            System.out.println(rset.getString("id"));
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            try {
                rs.close();
                stmt.close();
                con.close();
            } catch (Exception e) {
                e.printStackTrace();

            }
        }
    }
} 
```

# jquery - 有序列表未重新启动

> ID：12424289
> 
> 赞同：0
> 
> 时间：2012-09-14T12:11:10.963
> 
> 标签：jquery, html

目前我已经写了一个表格，里面有单独的有序列表。然而问题是当我使用 jquery 来获取索引时，我得到的是一个连续数字的索引。我希望有人能够帮助我将每个有序列表的这个数字重新恢复为 1。我试过了，但没有用。下面提到的是我的代码。提前致谢

```
<tr>
<td>
    <ol start="1" class="selectable">
        <li class="ui-widget-content">0800 - 0830</li> 
        <li class="ui-widget-content">0830 - 0900</li>
    </ol>
</td>
<td>
    <ol start="1" class="selectable">
        <li class="ui-widget-content">0800 - 0830</li> 
        <li class="ui-widget-content">0830 - 0900</li>
    </ol>
</td> 
```

```
<script>
$(function() {
    $( ".selectable" ).selectable({
        stop: function() {

            $(".selectable li").css({"background":"white","color":"black"});

            var result = $( "#select-result" ).empty();
            var bookingHours = $( "#booking-hours" ).empty();
            var bookingPeriod = [];
            var count = 0;

            $( ".ui-selected", this ).each(
                function() {
                    $( this ).css({"background":"#F39814","color":"white"});
                    var index = $( ".selectable li" ).index( this )+1;
                    bookingPeriod[count] = index;
                    count++;
                }
            );
            bookingHours.append( (count*0.5) + " Hours" );

            var bookingFrom = bookingPeriod[0];
            var bookingTo = bookingPeriod[bookingPeriod.length-1];

            result.append( ( bookingFrom ) + " to " + ( bookingTo ) );
        }
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:22:45.317

```
var index = $( ".selectable li", $(this).parent() ).index( this )+1; 
```

在上面的示例中，您也可以将上下文作为它的 $(this).parent() 来提及。

在您发布更新之前，我还创建了[http://jsbin.com/welcome/22907/edit 。](http://jsbin.com/welcome/22907/edit)希望这会有所帮助。

# ruby-on-rails - rails_admin 中的自定义模型

> ID：12424293
> 
> 赞同：1
> 
> 时间：2012-09-14T12:11:20.170
> 
> 标签：ruby-on-rails, acts-as-taggable-on, rails-admin

我有这样的问题：

我正在使用 rails_admin 和 gem act_as_taggable_on。第二个有模型 ActsAsTaggableOn::Tag。我需要在管理部分进行管理。Google 和 StackOverflow 不知道答案，或者我忘了，如何 google =(

所以，我尝试了什么：在 initializers/rails_admin.rb 中添加了

```
config.model ActsAsTaggableOn::Tag do
  label 'Тэг'
  label_plural 'Тэги'
  configure :name, :string
end 
```

还是没有反应。但是如果我尝试添加`config.included_models = [ActsAsTaggableOn::Tag]` 然后我在管理员中看到该模型，但这是白名单，所以我只看到标签，没有其他模型 =)

试着

```
config.included_models = :all 
```

和

```
config.included_models << ActsAsTaggableOn::Tag 
```

还是什么都没有=(

如果有人可以帮助我，我将不胜感激。

PS Nowtime 只看到一种方法 - 在 app/models 中添加空类 ActsAsTaggableOn::Tag 但我认为，这不是好方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:01:56.993

如果您进入白名单模式，则需要将它们全部添加：

```
config.included_models = ['ActsAsTaggableOn::Tag', <all other models>] 
```

您可以运行`rake rails_admin:install`以获取 RailsAdmin 检测到的所有模型的列表`config/initializers/rails_admin.rb.example`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-04T20:54:19.597

下面将让您能够列出、过滤、编辑、搜索标签并查看它们被使用了多少次。此示例不提供使用标签或其与所述标签的关联来更改项目的能力。

创建文件：app/models/tag.rb

将内容定义为：

```
class Tag < ActsAsTaggableOn::Tag
  attr_accessible :name, :as => :admin
end 
```

# jquery - 最近创建的文件无法下载

> ID：12424299
> 
> 赞同：0
> 
> 时间：2012-09-14T12:11:51.073
> 
> 标签：jquery, file, tomcat, download, struts

我有以下情况：我必须动态创建文件，用户代理以这种方式通过ajax向服务器发送数据：

```
$("#generateButton").live("click",function(){
dateLimite = $("#dateLimite").val();
 $.ajax({
   type    : "POST",
   url     : "../generateFile.do",
   data    : { fileName: "demandeExplication",
   nbrParam: "3",
   param1:"<%=agent.getPrenomAgentArabe()+" "+agent.getNomAgentArabe()%>",
   param2:"<%=descriptionActe%>",
   param3:dateLimite,
   },
   dataType: "html",

}).done(function(data) {
$("#test").empty().append(data);
  fileName = $("#test").find("input").val();
$.fileDownload('http://localhost:8080/gestionRH/fiches/temp/'+fileName);

});
}); 
```

服务器使用动态创建文件的操作处理此数据：

```
public class GenerateFile extends Action
{ 

public ActionForward execute(ActionMapping mapping, ActionForm form,
        HttpServletRequest request, HttpServletResponse response) throws IOException {
    String fileName = request.getParameter("fileName");
    Integer nbrParam = Integer.parseInt(request.getParameter("nbrParam"));
    String[] valueParam = new String[nbrParam+1];
    for(int i =1;i<=nbrParam;i++)
    {  System.out.println(request.getParameter("param"+i));
        valueParam[i]=request.getParameter("param"+i);
    }
    FileInputStream in = new FileInputStream("C:\\Users\\free\\Desktop\\myworkspace\\gestionRH\\WebRoot\\fiches\\"+fileName+".doc");
    POIFSFileSystem fs = new POIFSFileSystem(in);
    HWPFDocument doc = new HWPFDocument(fs);
    Range r = doc.getRange();
    for(int i=1;i<=nbrParam;i++)
    {   System.out.println("<param"+i+">");
        System.out.println(valueParam[i]);
        r.replaceText("<param"+i+">", valueParam[i]);
    }

    File frr = new File("C:\\Users\\free\\Desktop\\myworkspace\\gestionRH\\WebRoot\\fiches\\temp");
    File temp = File.createTempFile("monfile",".doc",frr);
    FileOutputStream out = new FileOutputStream(temp);
    doc.write(out);
    out.close();
    in.close();
    request.setAttribute("fileName", temp.getName());
    return mapping.findForward("fileName");
}
} 
```

我使用这个插件进行下载：http: [//johnculviner.com/category/jQuery-File-Download.aspx](http://johnculviner.com/category/jQuery-File-Download.aspx)

我收到错误下载！我没有得到现有文件，或者当我在一段时间后使用此代码触发下载时：

```
function timeout_trigger() { 
```

文件名 = $("#test").find("input").val(); }

我以这种方式使用它：

```
......}).done(function(data) {
setTimeout("timeout_trigger()",7000);
}); 
```

而第二个解决方案并不总是有效，所以我必须解决这个问题。为什么下载已经存在的文件没有问题并且最近创建的下载时显示错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T14:26:15.700

那可能是因为该文件尚未上传。使用 AJAX，文件在后台上传。这需要时间。服务器代码仅在整个文件上传后才会触发（它不想对部分文件进行操作）。

因此，您需要一种方式来询问“是否正在进行上传？”。当我遇到同样的问题时，我发送了几个 AJAX 请求。第一个将在会话中创建一个状态对象，我将在其中记录文件名。

查询文件时，我会查看该状态对象以查看上传是否完成并返回状态。

还有一些方法可以连接到上传过程；当您这样做时，您甚至可以将“上传百分比”添加到状态对象。

# c# - 如何将 NLog 中的自定义字段记录到数据库？

> ID：12424301
> 
> 赞同：53
> 
> 时间：2012-09-14T12:11:55.270
> 
> 标签：c#, nlog

我目前在很多项目中使用 NLog。在某些情况下，我登录到数据库。

这是我想做的事情：

```
CREATE TABLE [dbo].[NLogEntries](
  [Id] [bigint] IDENTITY(1,1) NOT NULL,
  [Origin] [nvarchar](100) NOT NULL,
  [LogLevel] [nvarchar](20) NOT NULL,
  [Message] [nvarchar](3600) NOT NULL,
  [CreatedOn] [datetime] NOT NULL,
  [OrderId] [int] NULL --Custom field!
) 
```

和带有这个目标的 NLog.config：

```
<target type="Database" name="database" connectionstring="Server=localhost;Database=NLog;Trusted_Connection=True;">
  <commandText>
    INSERT INTO NLogEntries ([Origin], [Message], [LogLevel],[CreatedOn],[OrderId]) VALUES (@Origin,@Message,@LogLevel,@Date, @OrderId);
  </commandText>
  <parameter name="@Date" layout="${date}"/>
  <parameter name="@Origin" layout="${callsite}"/>
  <parameter name="@LogLevel" layout="${level}"/>
  <parameter name="@message" layout="${message}"/>
  <parameter name="@OrderId" layout="${orderId}"/> <!-- custom field! -->
</target> 
```

然后记录如下内容：

```
var logger = LogManager.GetCurrentClassLogger();
var orderId = 123;
logger.Debug("What is going on here", orderId); 
```

有没有一种好方法可以做到这一点并继续使用 NLog？或者当这些是要求时，我是否必须滚动自己的记录器并跳过 NLog？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2013-07-20T23:40:31.720

2022 年 2 月 11 日更新：较新版本的 NLOG 有其他解决方案 - 请参阅[Julian 的回答](https://stackoverflow.com/questions/12424301/how-do-i-log-a-custom-field-in-nlog-to-database/56719847#56719847)。

与其使用用于全局静态数据并在并发日志记录上失败的 GDC，不如使用  允许传递特定于事件的自定义属性的[EventProperties-Layout-Renderer](https://github.com/NLog/NLog/wiki/EventProperties-Layout-Renderer)

```
LogEventInfo theEvent = new LogEventInfo(logLevel, "", message);
theEvent.Properties["OrderId"] =orderId;`

log.Log(theEvent);

... and in your NLog.config file: 
${event-context:item=OrderId}  -- obsolete
${event-properties:item=OrderId} -- renders OrderId 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-09-14T15:23:36.473

这是使用 GlobalContext 的一种方法。

配置：

```
<target type="Database" name="database" connectionstring="Server=localhost;Database=NLog;Trusted_Connection=True;">
  <commandText>
    INSERT INTO NLogEntries ([Origin], [Message], [LogLevel],[CreatedOn],[OrderId]) VALUES (@Origin,@Message,@LogLevel,@Date, @OrderId);
  </commandText>
  <parameter name="@Date" layout="${date}"/>
  <parameter name="@Origin" layout="${callsite}"/>
  <parameter name="@LogLevel" layout="${level}"/>
  <parameter name="@message" layout="${message}"/>
  <parameter name="@OrderId" layout="${gdc:OrderId}"/> <!-- custom field! -->
</target> 
```

调用站点：

```
var logger = LogManager.GetCurrentClassLogger();
GlobalDiagnosticsContext.Set("OrderId",123);
logger.Debug("What is going on here"); //If you use the logging configuration above, 123 will be logged to the OrderId column in your database 
```

稍加努力，您就可以使用[此处](https://github.com/jkowalski/NLog/tree/master/examples/ExtendingLoggers)说明的一种技术来包装 NLog 记录器。

或者，您可以创建自己的“上下文”对象并编写自定义 LayoutRenderer 以从中提取值并将它们写入日志。自定义 LayourRenderers 很容易编写。[你可以在我对这个问题](https://stackoverflow.com/questions/4091606/most-useful-nlog-configurations)的第一个回答中看到一个例子。在那里，我展示了如何编写自己的 LayoutRenderer，它将 System.Diagnostics.Trace.CorrelationManager.ActivityId 的当前值附加到日志消息中。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2019-06-22T23:16:42.370

NLog 4.5 引入了[结构化日志](https://github.com/NLog/NLog/wiki/How-to-use-structured-logging)，所以你可以这样做：

```
logger.Debug("What is going on here. OrderId={MyOrderId}", orderId); 
```

使用 NLog 4.6.3 可以创建临时 Logger，它具有所需的属性，使用`WithProperty`：

称呼

```
int orderId = 123; 
logger.WithProperty("MyOrderId", orderId).Info("This is my message!"); 
```

配置：

```
<target type="Database" name="database" connectionstring="Server=localhost;Database=NLog;Trusted_Connection=True;">
  <commandText>
    INSERT INTO NLogEntries ([Origin], [Message], [LogLevel],[CreatedOn],[OrderId]) VALUES (@Origin,@Message,@LogLevel,@Date, @OrderId);
  </commandText>
  <parameter name="@Date" layout="${date}" dbType="DbType.Date"/>
  <parameter name="@Origin" layout="${callsite}"/>
  <parameter name="@LogLevel" layout="${level}"/>
  <parameter name="@message" layout="${message}"/>
  <parameter name="@OrderId" layout="${event-properties:MyOrderId}" dbType="DbType.Int32"/> <!-- custom field! Note also the DB Type -->
</target> 
```

请注意，NLog 4.6 还支持 DbType - 请参阅[https://nlog-project.org/2019/03/20/nlog-4-6-is-live.html](https://nlog-project.org/2019/03/20/nlog-4-6-is-live.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-05-05T00:59:01.063

如果这就是所有需要，从 NLog 版本 4.3.3 开始，有一种更简单的方法来声明和访问自定义变量。 **当心：** ***这些解决方案都不是线程安全的。***

将以下内容添加到 NLog.config

```
<nlog ...
    <!-- optional, add some variables -->  
    ...
    <variable name="myvarone" value="myvalue"/>
    <variable name="myvartwo" value=2/>
     ...
</nlog> 
```

可以通过以下方式在代码中更改/访问变量：

```
LogManager.Configuration.Variables["myvarone"] = "New Value"
LogManager.Configuration.Variables["myvartwo"] = 2 
```

这些值可以在 NLog.config 中引用：

```
"${var:myvarone}"  -- renders "New Value"
"${var:myvartwo}"  -- renders 2 
```

正如我上面提到的*var*和*LogEventInfo*对象是全局的。因此，如果定义了多个实例，更改一个值将更改所有实例的值。如果有人知道为 NLog 声明每个实例自定义变量的方法，我很感兴趣。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-23T14:42:20.620

您可以使用 MDC 代码：

```
var logger = LogManager.GetCurrentClassLogger();

MDC.Set("OrderId", 123);
MDC.Set("user", HttpContext.Current.User.Identity.Name);
// ... and so on 
```

还要检查这个[http://weblogs.asp.net/drnetjes/archive/2005/02/16/374780.aspx](http://weblogs.asp.net/drnetjes/archive/2005/02/16/374780.aspx)

# css - 导致浮动堆叠的边框

> ID：12424304
> 
> 赞同：1
> 
> 时间：2012-09-14T12:12:02.650
> 
> 标签：css, border

下面的代码产生了两个不错的列和一个页脚：

```
<div class="column one">
ONE
</div>

<div class="column two">
TWO
</div>

<div class="footer">
Footer
</div>​ 
```

用CSS：

```
.column {float: right; width: 30%; margin: 0 10%;}
.footer {clear: both;} 
```

那么为什么当我添加边框时，两列突然堆叠在一起？

```
.column, .footer {
  border-style:solid;
  border-width:1px;
 } 
```

见 - 小提琴：http: [//jsfiddle.net/usdu7/19/](http://jsfiddle.net/usdu7/19/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:17:06.433

这是因为，边框增加了宽度。所以总宽度比 100% 宽度多 4 个像素。因此，它相互堆叠。

添加 box-sizing 属性将解决问题。

[http://jsfiddle.net/usdu7/30/](http://jsfiddle.net/usdu7/30/)

# asp.net - 我想把表格放在 asp.net 网格视图中

> ID：12424309
> 
> 赞同：0
> 
> 时间：2012-09-14T12:12:10.673
> 
> 标签：asp.net

这是我下面给出的网格视图代码>

```
<asp:GridView ID="gvReport" runat="server" AutoGenerateColumns="False" GridLines="None"
     ShowHeader="true" HorizontalAlign="Left" OnRowCommand="gvReport_RowCommand">
           <Columns>
               <asp:TemplateField HeaderText="User" ItemStyle-HorizontalAlign="Left">
                 <ItemTemplate>
                    <asp:Image id="img" text=<%#Eval("Coupon_Image")%>/>
                 </ItemTemplate>
                 <HeaderStyle Font-Bold="false" HorizontalAlign="Left" />
               </asp:TemplateField>
               <asp:TemplateField HeaderText="">
                 <ItemTemplate>
                    <asp:Button ID="getCoupon" runat="server" CssClass="btn" Width="145" Height="34"
                            CommandName="getCoupon" CommandArgument='<%#Eval("Coupon_Id")%>' />
                 </ItemTemplate>
                </asp:TemplateField>
           </Columns>
</asp:GridView> 
```

在这个它显示像这样

```
 Image 1    Button
 Image 2    Button 
```

实际上我想在网格视图中喜欢这种类型

```
 Image1            Image2      Image3
  Button            Button      Button 
```

请帮助我....提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:57:51.767

网格视图不适用于此。为此使用 Table 控件，并以可编程方式构建行和列。挑战在于 gridview 并不意味着水平渲染。您也可以使其与转发器或 ListView 一起使用，因为您可以让 ListView 或转发器呈现列，并且布局模板是表格和标题行。

# objective-c - iOS自定义字体问题

> ID：12424310
> 
> 赞同：1
> 
> 时间：2012-09-14T12:12:17.787
> 
> 标签：objective-c, ios, xcode, fonts

> **可能重复：**
> [我可以在 iPhone 应用程序中嵌入自定义字体吗？](https://stackoverflow.com/questions/360751/can-i-embed-a-custom-font-in-an-iphone-application)

我陷入了以下问题：我必须使用以下字体：**Helvetica Neue LT Pro**。中等压缩和粗体压缩样式。

我首先将它们作为 otf 文件，然后我在某处读到，将它们作为**true-type**字体可能会更好。所以我使用[http://www.freefontconverter.com/将它们转换为](http://www.freefontconverter.com/)**.ttf**文件

**我做了什么**：

1）我在**资源包**中添加了字体，检查以确保它们在`Copy Bundle Resources`部分中列出。

2）我将它们添加到`Fonts provided by application`条目中`Info.plist`，并带有我的 2 个文件的完整名称和扩展名：`helveticaneueltprobdcn.ttf`和`helveticaneueltpromdcn.ttf`

3）我使用此代码检查字体是否已安装并获取名称：

```
for (NSString *familyName in [UIFont familyNames])
            {
                NSLog(@"----------------");
                NSLog(@"FAMILY: %@", familyName);
                for(NSString *fontName in [UIFont fontNamesForFamilyName:familyName])
                {
                    NSLog(@"  %@", fontName);
                }
            } 
```

4）字体在那里列出，如下所示：

```
 FAMILY: Helvetica Neue LT Pro
   HelveticaNeueLTPro-MdCn
   HelveticaNeueLTPro-BdCn 
```

5）尝试使用时仍然无法正常工作`[UIFont fontWithName:@"HelveticaNeueLTPro-BdCn" size:16]`。这不是我要求的字体，我猜它没有找到它并使用系统默认值。如果我更改 size ，则没有任何变化 - 我可以使用 size 16 或 46 ，结果是一样的。

6）我尝试删除并重新安装应用程序，在 XCode 中清理项目，我能想到的一切。

有谁知道为什么这不起作用？我google了很多，我找不到解决方案。如果重要的话，我正在使用**XCode 4.3.2**、iOS **SDK 5.1**并在安装了 iOS 5.1.1 的 iPad 上运行。

谢谢你。

问候，

乔治

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:23:16.127

终于明白了...

这就是我正在做的事情：

```
MyCustomView *view = [[MyCustomView alloc] init];
//bla bla 
```

在 MyCustomView.m 中，在 init 方法中我有这个：

```
- (id) init
{
     //create some labels and set their fonts.
} 
```

问题是在我设置字体时，标签的父视图（ MyCustomView 实例）没有添加到超级视图中。

我在 MyCustomView 实例上调用 init 之后创建了一个`setFonts`方法，当我在那里设置字体时，它起作用了！

希望这可以帮助。

干杯!

# jquery - 在 rails 3.2 中使用 jquery 和 ajax 渲染部分的教程？

> ID：12424318
> 
> 赞同：4
> 
> 时间：2012-09-14T12:12:36.627
> 
> 标签：jquery, ruby-on-rails, ruby, ajax

在过去的几天里，我一直在到处寻找，而且我能找到的所有教程

*   不适用于rails 3.2，

*   老了，

*   或者我无法理解。

我需要一个人或一组指令来教我如何使用 jQuery 渲染部分，以及我应该在哪里放置 javascript 代码。

# jquery - Wmode=transparent 和 autoplay=1 不能一起工作

> ID：12424320
> 
> 赞同：0
> 
> 时间：2012-09-14T12:12:38.597
> 
> 标签：jquery, actionscript-3, iframe, youtube

我有一个嵌入在 html 页面中的 youtube 播放器，我需要在页面加载时播放它，并且由于我有一个删除播放器的按钮，我需要 wmode=transparent 以便我可以将元素放置在它上面。

这是我使用的播放器的代码：

```
<iframe width="560" height="235" src="http://www.youtube.com/embed/vUd6TpdFLl4?autoplay=1?wmode=transparent" frameborder="0" allowfullscreen></iframe> 
```

如果我只使用其中一个，它们工作正常，但如果我把它们放在一起，它们都不起作用。

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:18:14.077

url 查询字符串的正确语法是这样的：

```
<iframe width="560" height="235" src="http://www.youtube.com/embed/vUd6TpdFLl4?autoplay=1&amp;wmode=transparent" frameborder="0" allowfullscreen></iframe> 
```

`?`您正在使用而不是添加第二个参数`&amp;`

# html - 使用 HTML 和 CSS 的 Kindle 电子书动画

> ID：12424323
> 
> 赞同：-2
> 
> 时间：2012-09-14T12:12:47.187
> 
> 标签：html, css, kindle

我想使用 HTML 和 CSS 创建 Kindle 电子书。我可以使用“calibre”创建带有一些 HTML 页面的基本电子书。但项目要求是使用 HTML 页面中的动画......就像我们点击一​​个气球它就会吹一样。我曾尝试使用动画是 CSS，但它没有用。

请帮助我提供一些链接或示例代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T08:54:25.897

作为电子书阅读器的 Kindle 设备不支持动画，无论它们是 CSS 还是 jQuery 或纯 JavaScript 或其他任何东西。

# android - 在 Android 中操作传入的短信

> ID：12424327
> 
> 赞同：0
> 
> 时间：2012-09-14T12:13:04.410
> 
> 标签：android, sms

如何在 Android 中操作某些传入的 SMS 消息？我想在消息到达收件箱之前更改发件人号码（因此来自一系列号码的所有短信都将被分组到单个对话中）。

这可以通过 android.provider.Telephony.SMS_RECEIVED 意图的广播接收器来完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:22:07.033

您无法在“隐身模式”中修改传入消息，并且您无法在不进行生根和平台修改的情况下用虚假消息替换广播。您可以尝试使用内容提供商来玩 SMS，但您需要 WRITE_SMS 权限，这样您的意图对许多人来说都很清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:18:48.550

我不认为你能做到。你通过什么`android.provider.Telephony.SMS_RECEIVED`，数据是一个副本，所以即使你改变它也不会改变其他接收者。您可以阻止它转到其他广播，但不能更改它并重新广播

您可以做的是使用 SMS 的 contentProvider 进行操作。您将需要 WRITE_SMS 权限

# c++ - 通过 C++ STL 映射上的迭代器擦除

> ID：12424329
> 
> 赞同：3
> 
> 时间：2012-09-14T12:13:08.323
> 
> 标签：c++, stl, map, iterator, erase

我很好奇以下代码背后的基本原理。对于给定的地图，我可以使用以下代码删除一个范围，但不包括`end()`（显然）：

```
map<string, int> myMap;
myMap["one"] = 1;
myMap["two"] = 2;
myMap["three"] = 3;

map<string, int>::iterator it = myMap.find("two");

myMap.erase( it, myMap.end() ); 
```

这将使用范围擦除最后两项。但是，如果我使用擦除的单个迭代器版本，我有一半希望通过`myMap.end()`不会导致任何操作，因为迭代器显然位于集合的末尾。这与明显会导致未定义行为的损坏或无效迭代器不同。

但是，当我这样做时：

```
myMap.erase( myMap.end() ); 
```

我只是得到一个分段错误。我不会认为 map 很难检查迭代器是否相等`end()`并且在这种情况下不采取行动。我错过了一些微妙的原因吗？我注意到即使这样也有效：

```
myMap.erase( myMap.end(), myMap.end() ); 
```

（即什么都不做）

我问的原因是我有一些代码接收到集合的有效迭代器（但可能是`end()`），我想简单地将它传递给擦除，而不是像这样首先检查：

```
if ( it != myMap.end() )
    myMap.erase( it ); 
```

这对我来说似乎有点笨拙。另一种方法是重新编码，这样我就可以使用按键类型擦除重载，但如果我能提供帮助，我宁愿不要重写太多。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T12:39:56.770

关键是在标准库中，由两个迭代器确定的范围是半开范围。在数学符号中`[a,b)`它们包括第一个但不包括最后一个迭代器（如果两者相同，则范围为空）。同时，返回*一个超出最后一个*`end()`元素的迭代器，它与半开范围表示法完美匹配。

 *当您使用它的范围版本时，`erase`它永远不会尝试删除最后一个迭代器引用的元素。考虑一个修改过的例子：

```
map<int,int> m;
for (int i = 0; i < 5; ++i)
   m[i] = i;
m.erase( m.find(1), m.find(4) ); 
```

在执行结束时，地图将包含两个键`0`和`4`. 请注意，第二个迭代器引用的元素*并未*从容器中删除。

另一方面，单个迭代器操作将擦除迭代器引用的元素。如果上面的代码改为：

```
for (int i = 1; i <= 4; ++i ) 
   m.erase( m.find(i) ); 
```

带有键的元素`4`将被删除。在您的情况下，您将尝试删除未引用有效对象的结束迭代器。

> 我不会认为 map 很难检查迭代器是否等于 end() 并且在这种情况下不采取行动。

不，这并不难，但是该函数的设计考虑了不同的合约：调用者必须将迭代器传递给容器中的元素。造成这种情况的部分原因是，在 C++ 中，大多数功能的设计都是为了尽可能降低成本，从而允许用户在安全/性能方面取得平衡。用户可以在调用之前测试迭代器`erase`，但如果该测试在库中，那么当用户知道迭代器有效时，她将无法选择退出测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:18:05.790

n3337 23.2.4 表 102

```
a.erase( q1, q2) 
```

> 擦除**范围 [q1,q2)**中的所有元素。返回 q2。

因此，如果`iterator`返回 from`map::end()`不在范围内`myMap.erase(myMap.end(), myMap.end())`;

```
a.erase(q) 
```

> 擦除 q 指向的元素。返回一个迭代器，该迭代器指向紧跟在 q 之后的元素，在该元素被擦除之前。如果不存在这样的元素，则返回 a.end()。

> 我不会认为 map 很难检查迭代器是否等于 end() 并且在这种情况下不采取行动。我错过了一些微妙的原因吗？

原因是一样的，`std::vector::operator[]`不能检查，那个索引当然在范围内。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:27:45.280

当您使用两个迭代器来指定范围时，范围由第一个迭代器指向的元素中的元素组成，但不包括第二个迭代器指向的元素。所以`erase(it, myMap.end())`说要删除所有内容`it`，但不包括`end()`. 您同样可以将指向“真实”元素的迭代器作为第二个传递，并且该迭代器指向的元素不会被删除。

当您使用`erase(it)`它时，它说要擦除`it`指向的元素。迭代器`end()`没有指向一个有效的元素，所以`erase(end())`没有做任何明智的事情。库可以诊断这种情况，调试库会这样做，但是每次调用`erase`检查迭代器指向的内容都会产生成本。标准库不会将这种成本强加给用户。你自己一个人。`<g>`*

# android - 日食中未检测到索尼爱立信（Android）手机？

> ID：12424330
> 
> 赞同：2
> 
> 时间：2012-09-14T12:13:10.570
> 
> 标签：android, android-emulator, sony

我有索尼爱立信 LT26i 手机（印度）。我打开了开发模式。我仍然无法在日食中检测到手机。在正常模式下检测到此手机以浏览文件和所有内容。

在日食中检测到其他手机，如三星等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:22:41.863

你不写你运行的操作系统。

在 Linux 中你可以

```
> lsusb 
```

你会得到一个喜欢的列表：

> 总线 001 设备 009：ID 04e8:6860 三星电子有限公司

您编辑规则文件：

```
> sudo gedit /etc/udev/rules.d/99-android.rules 
```

添加 SUBSYSTEM=="usb", ATTR{idVendor}=="04e8", ATTR{idProduct}=="6860", MODE="0666", OWNER=" `<your login here>`"

还需要做

```
> sudo service udev restart
> adb kill-server
> adb start-server 
```

检查

```
> adb devices 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-03T14:50:45.330

我的 Sony Xperia Neo L 手机也遇到过同样的问题。正如上面的帖子中提到的，你可以在 linux 平台上用“不透明”的答案来解决这个问题。但是，如果您是 Windows 7 用户（和我一样），最好和最简单的方法是从索尼网站安装 Sony PC Companion 软件。

该软件已安装所需的驱动程序，之后我的 Eclipse 检测到了我的手机。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-06T00:45:02.500

当我按原样尝试 opaque 的解决方案时，我无法在 Ubuntu 13.04 上识别我的 Xperia Pro。至于我能从这篇文章中理解什么（[http://esausilva.com/2010/05/13/setting-up-adbusb-drivers-for-android-devices-in-linux-ubuntu/](http://esausilva.com/2010/05/13/setting-up-adbusb-drivers-for-android-devices-in-linux-ubuntu/)），我不是正确创建 android-rules 文件。

To solve this I checked for other rules files on the rules.d directory and found out that it should be 70-andoid.rules, in my case. After that it still didn't recognize the device, but, after changing the file's permissions and rebooting the system, as also said on the cited post, Ubuntu is now identifying it ok.

Hope it helps!

# c++ - WaveFront .obj 加载器未按应有的方式显示对象（VBO 和 VAO）

> ID：12424338
> 
> 赞同：2
> 
> 时间：2012-09-14T12:13:26.887
> 
> 标签：c++, opengl, vbo, glm-math, wavefront

我正在开发 WaveFront .obj 加载器，我的第一个目标是从以下 .obj 文件中加载所有顶点和索引（显示带有弯曲边缘的立方体）。

```
# Blender v2.62 (sub 0) OBJ File: 'Cube.blend'
# www.blender.org
o Cube
v 0.900000 -1.000000 -0.900000
v 0.900000 -1.000000 0.900000
v -0.900000 -1.000000 0.900000
v -0.900000 -1.000000 -0.900000
v 0.900000 1.000000 -0.900000
v 0.899999 1.000000 0.900001
v -0.900000 1.000000 0.900000
v -0.900000 1.000000 -0.900000
v 1.000000 -0.900000 -1.000000
v 1.000000 -0.900000 1.000000
v -1.000000 -0.900000 1.000000
v -1.000000 -0.900000 -1.000000
v 1.000000 0.905000 -0.999999
v 0.999999 0.905000 1.000001
v -1.000000 0.905000 1.000000
v -1.000000 0.905000 -1.000000
f 1//1 2//1 3//1
f 1//1 3//1 4//1
f 13//2 9//2 12//2
f 13//2 12//2 16//2
f 5//3 13//3 16//3
f 5//3 16//3 8//3
f 15//4 7//4 8//4
f 15//5 8//5 16//5
f 11//6 15//6 16//6
f 11//6 16//6 12//6
f 14//7 6//7 7//7
f 14//7 7//7 15//7
f 10//8 14//8 11//8
f 14//8 15//8 11//8
f 13//9 5//9 6//9
f 13//9 6//9 14//9
f 9//10 13//10 10//10
f 13//11 14//11 10//11
f 9//12 1//12 4//12
f 9//12 4//12 12//12
f 3//13 11//13 12//13
f 3//14 12//14 4//14
f 2//15 10//15 11//15
f 2//15 11//15 3//15
f 1//16 9//16 10//16
f 1//16 10//16 2//16
f 5//17 8//17 7//17
f 5//17 7//17 6//17 
```

我已经将所有顶点和索引加载到两个向量中，称为 verticesVec 和 indicesVec，并且我已经检查了它们（它们的所有输入都以正确的顺序排列，verticesVec[0] = 0.9 和 indicesVec[0] = 1）。我加载 VertexBufferObject 中的顶点和 VerticArrayObject 中的索引以及着色器字段设置。

但是，当我渲染立方体时，我得到以下不正确的图像。我已经重新检查了所有代码，但找不到出错的部分。它与向量和向量的字节大小有关吗？

[![错误的立方体](../Images/65ff650f796741f0d6847b85ab30ba0a.png)](https://i.stack.imgur.com/fQQtd.png)

以下代码来自我的 Draw/Render 方法，该方法执行所有渲染。

```
 glUseProgram(theProgram);
    GLuint modelToCameraMatrixUnif = glGetUniformLocation(theProgram, "modelToCameraMatrix");
    GLuint perspectiveMatrixUnif = glGetUniformLocation(theProgram, "cameraToClipMatrix");
    glUniformMatrix4fv(perspectiveMatrixUnif, 1, GL_FALSE, glm::value_ptr(cameraToClipMatrix));

    glm::mat4 identity(1.0f);
    glutil::MatrixStack stack(identity); // Load identity Matrix

    // Push for Camera Stuff
    glutil::PushStack camera(stack);
    stack.Translate(glm::vec3(camX, camY, camZ));

    //Push one step further to fix object 1
    glutil::PushStack push(stack);

    stack.Translate(glm::vec3(0.0f, 0.0f, 3.0f));
    // Draw Blender object
    glBindVertexArray(this->load.vertexArrayOBject);
    glUniformMatrix4fv(modelToCameraMatrixUnif, 1, GL_FALSE, glm::value_ptr(stack.Top()));
    glDrawElements(GL_TRIANGLES, this->load.indicesVec.size(), GL_UNSIGNED_SHORT, 0);

    // Pop camera (call destructor to de-initialize all dynamic memory)
    camera.~PushStack();

    // Now reset all buffers/programs
    glBindVertexArray(0);
    glUseProgram(0); 
```

以及我的 .obj 加载器中缓冲区对象的初始化：

```
void Loader::generateVertexBufferObjects()
{
     // Fils the vertex buffer object with data
    glGenBuffers(1, &vertexBufferObject);
    glBindBuffer(GL_ARRAY_BUFFER, vertexBufferObject);
    glBufferData(GL_ARRAY_BUFFER, verticesVec.size() * 4, &verticesVec[0], GL_STATIC_DRAW);
    glBindBuffer(GL_ARRAY_BUFFER, 0);

    // Fills the index buffer object with its data
    glGenBuffers(1, &indexBufferObject);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexBufferObject);
    glBufferData(GL_ELEMENT_ARRAY_BUFFER, indicesVec.size() * 4, &indicesVec[0], GL_STATIC_DRAW);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);
}

void Loader::generateVertexArrayObjects()
{
    glGenVertexArrays(1, &vertexArrayOBject);
    glBindVertexArray(vertexArrayOBject);

    glBindBuffer(GL_ARRAY_BUFFER, vertexBufferObject);
    glEnableVertexAttribArray(0);
    glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, indexBufferObject);

    glBindVertexArray(0);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T16:09:23.633

您将索引创建为无符号整数，但您将它们传递给 OpenGL，它们的类型为 GL_UNSIGNED_SHORT。glDrawElements 的类型参数必须与上传到索引缓冲区的数据类型相匹配。

# java - 如何解决枚举继承来重命名它？

> ID：12424345
> 
> 赞同：1
> 
> 时间：2012-09-14T12:13:40.970
> 
> 标签：java, enums, rename

> **可能重复：**
> [Java 枚举继承](https://stackoverflow.com/questions/1884433/java-enum-inheritance)

我正在使用一个具有枚举类型的库，该类型非常适合我的使用，但是这个名字很可怕而且令人困惑。我可以简单地从这个枚举继承来创建我自己的一个更好的名字吗？

```
public enum Settings extends JiggidyWapperfragNautchFrick.SkiddidyBoomCaFriglets {
} 
```

像这样？当我尝试这样做时，IntelliJ 抱怨，但什么是获得我提议的效果的合适方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:16:17.950

不，你不能扩展一个`enum`类。

唯一的（轻微的）例外是枚举值可以具有特定于值的类主体，这有效地创建了一个扩展原始类的单独`enum`类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T12:16:59.993

枚举是最终类，因此您不能对它们进行子类化。我建议将它包装在另一个名字很好的类中。

也许是这样的。通过拥有私有 ctor，您无法实例化它。

```
public class Nice {

    private Nice(){}

    public static badNamedEnum one(){
        return badNamedEnum.badNamedOne;
    }

    public static badNamedEnum two(){
        return badNamedEnum.badNamedTwo;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:18:03.527

Joachim 是对的，但枚举可以`implement`是接口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:20:01.503

枚举用于“硬编码”开关和其他测试。允许子类化是没有意义的，并且会破坏目的，因为这将允许对可能的值产生不确定性。

# android - 在 Android 中制作一个弹跳的 ListView

> ID：12424346
> 
> 赞同：4
> 
> 时间：2012-09-14T12:13:42.843
> 
> 标签：android, listview

我试图让我的列表视图“反弹”。为了解释我自己，我希望 ListView 具有与 iOs List View 对象相同的行为。在列表的顶部和底部，用户可以通过滑动手指浏览列表。

这种行为存在于 Android 2.2 三星设备（例如 Galaxy Tab GT1000）上。

在我测试的大多数设备上，列表现在在滚动时表现不同，它显示一条蓝线，当你滑动手指时会变得更亮。

我发现 BounceListView 像这样：

```
public class BounceListView extends ListView
{
    private static final int MAX_Y_OVERSCROLL_DISTANCE = 200;

    private Context mContext;
    private int mMaxYOverscrollDistance;

    public BounceListView(Context context) 
    {
        super(context);
        mContext = context;
        initBounceListView();
    }

    public BounceListView(Context context, AttributeSet attrs) 
    {
        super(context, attrs);
        mContext = context;
        initBounceListView();
    }

    public BounceListView(Context context, AttributeSet attrs, int defStyle) 
    {
        super(context, attrs, defStyle);
        mContext = context;
        initBounceListView();
    }

    private void initBounceListView()
    {
        //get the density of the screen and do some maths with it on the max overscroll distance
        //variable so that you get similar behaviors no matter what the screen size

        final DisplayMetrics metrics = mContext.getResources().getDisplayMetrics();
            final float density = metrics.density;

        mMaxYOverscrollDistance = (int) (density * MAX_Y_OVERSCROLL_DISTANCE);
    }

    @Override
    protected boolean overScrollBy(int deltaX, int deltaY, int scrollX, int scrollY, int scrollRangeX, int scrollRangeY, int maxOverScrollX, int maxOverScrollY, boolean isTouchEvent) 
    { 
        //This is where the magic happens, we have replaced the incoming maxOverScrollY with our own custom variable mMaxYOverscrollDistance; 
        return super.overScrollBy(deltaX, deltaY, scrollX, scrollY, scrollRangeX, scrollRangeY, maxOverScrollX, mMaxYOverscrollDistance, isTouchEvent);  
    }

} 
```

但是这个 ListView 的问题是它不会在滚动列表后返回到第一个或最后一个项目......它停留在未填充列表的位置。

任何人都有想法让它工作？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:41:32.677

您应该覆盖`onOverScrolled`，调用它表示列表已过度滚动，并在该函数中滚动`ListView`回您想要使用它的点`smoothScrollToPosition`。

它看起来像：

```
@Override
protected void onOverScrolled(int scrollX, int scrollY, boolean clampedX, boolean clampedY) {
    if(scrollY < 0) {
        smoothScrollToPosition(0);
    } else if(scrollY > MAX_SCROLL) {
        smoothScrollToPosition(getAdapter().getCount());
    }
} 
```

MAX_SCROLL 必须由您使用列表项的高度和适配器中的项数来确定，尽管看起来您已经在问题中弄清楚了，所以这应该不是问题。

# email - 在 Instagram 中，如何将邀请发送给 Twitter 好友？

> ID：12424349
> 
> 赞同：0
> 
> 时间：2012-09-14T12:13:47.240
> 
> 标签：email, twitter, instagram

Twitter 不提供任何 API 来检索用户电子邮件 ID。

那么 Instagram 是如何邀请 Twitter 好友加入的呢？我正在做一个类似的应用程序。请提出想法。

# python - subprocess.Popen：如何终止子进程并接收其输出？

> ID：12424351
> 
> 赞同：2
> 
> 时间：2012-09-14T12:14:01.643
> 
> 标签：python, subprocess, stdout

我想从 python 运行一个 shell 命令并使用 subprocess.Popen 接收它的输出。问题是，当我关闭进程并发送 Ctrl-C 时，我没有得到任何输出。我究竟做错了什么？代码：

```
>>> import subprocess
>>> sub = subprocess.Popen(["xinput", "test", "8"], stdout=subprocess.PIPE) #receive mouse events
>>> output = sub.communicate()[0].read()
^CTraceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.6/subprocess.py", line 693, in communicate
    stdout = self.stdout.read()
KeyboardInterrupt
>>> output
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'output' is not defined 
```

受 Jett 这篇文章的启发：

[从 python 中的 xinput 测试中读取标准输出](https://stackoverflow.com/questions/12420999/reading-stdout-from-xinput-test-in-python)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:24:43.563

这里的问题是`KeyboardInterrupt`在调用`communicate`. 结果，`communicate`永远不会返回，因此它的输出永远不会存储在变量中`output`，并且`NameError`当您尝试使用它时会得到。一种解决方法如下：

```
 import subprocess
 sub = subprocess.Popen(["xinput", "test", "8"], stdout=subprocess.PIPE)
 lines = [] #Need someplace to store the data as it comes
 try:
    for line in sub.stdout: #read one line from standard out, store it in lines
        lines.append(line)
 except KeyboardInterrupt:  #keyboardInterrupt happened.  Stop process
    sub.terminate()
 finally:                   #Join our lines into a single buffer (like `communicate`)
    output = ''.join(lines)
    del lines               #clean `lines` out of our namespace (just because). 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:24:58.320

@pythonm 已经解释了`NameError`.

此外，您正在使用`Popen.communicate()`概念上错误的输出。它返回一个 2 元组的字符串：`(stdout, stderr)`. 它不返回两个类似文件的对象。这就是为什么如果返回你`sub.communicate()[0].read()`会失败的原因。`communicate()`

在子进程返回之前，`communicate()`聚合其所有 stdout 和 stderr（考虑到您提供`stdout=subprocess.PIPE`给`stderr=subprocess.PIPE`构造函数）。只有在子流程终止后，您才能访问`communicate()`在子流程运行期间收集的内容。

如果您想实时监控子流程的输出，那`communicate()`是错误的方法。运行子进程，监视它（例如在循环中）并与它的`Popen.stdout`和`Popen.stderr`属性交互（然后是类似文件的对象）。@mgilson 的回答向您展示了一种方法：)

# android - 这个 LinearLayout 应该使用 android:layout_height="wrap_content" 吗？

> ID：12424352
> 
> 赞同：9
> 
> 时间：2012-09-14T12:14:03.380
> 
> 标签：android

我有以下 xml 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:fillViewport="true" >

  <LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" // ==> here I get the error.
    android:orientation="vertical" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Test"
        android:textAppearance="?android:attr/textAppearanceLarge"
        android:layout_marginLeft="10dp"
        android:layout_marginTop="5dp"  />

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="2dip"
        android:background="#298EB5"
        android:orientation="horizontal" />

  </LinearLayout>
</ScrollView> 
```

但我收到了 lint 消息：

> 这个 LinearLayout 应该使用 android:layout_height="wrap_content"

为什么我会收到此消息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T12:24:17.723

`LinearLayout`'s 设计用于将元素并排或堆叠在一起。我的猜测是，这个 lint 警告建议使用虚拟堆叠，因为`ScrollView`

[文档](http://developer.android.com/guide/topics/ui/layout/linear.html)：

“LinearLayout 的所有子元素一个接一个地堆叠，**因此垂直列表每行只有一个子**元素，无论它们有多宽，而水平列表将只有一行高（最高子元素的高度，加上填充）。LinearLayout 尊重子级之间的边距和每个子级的重力（右对齐、居中对齐或左对齐）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T12:21:30.670

您应该使用它的 Lint 警告

```
android:layout_height="wrap_content" 
```

`wrap_content`根据添加需要的内容占据高度。这里的Layout wrap的高度根据需要

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T17:25:54.503

这不是错误，但不建议这样做，因为在某些情况下会产生不需要的结果。我在使用滚动视图时遵循 Romain 的这篇[文章。](http://www.curious-creature.org/2010/08/15/scrollviews-handy-trick/)我希望这将解释该消息的原因。

# asp.net-mvc - 在 ObjectStateManager 中找不到具有与所提供对象的键匹配的键的对象

> ID：12424353
> 
> 赞同：0
> 
> 时间：2012-09-14T12:14:08.887
> 
> 标签：asp.net-mvc, entity-framework

我使用以下代码

```
Tel_CallHistory CallHistory = new Tel_CallHistory();

                     CallHistory.MobileNo = MobileNo;
                     CallHistory.CRId = CallResponse;
                     CallHistory.CallRemark = CallRemark;
                     CallHistory.UserId = UserId;
                     CallHistory.CallDate = DateTime.Now;
                     CallHistory.CallTime = DateTime.Now.TimeOfDay;

                     CallHistory.MeetingPoint = meetingpoint;
                     if (CallResponse == 1)
                     {
                         CallHistory.NCallDateOn = null;
                         CallHistory.NCallTimeAt = null;
                         CallHistory.MeetingDate = Convert.ToDateTime( meetingdate);

                         CallHistory.MeetingTime =  DateTime.Parse(meetingtime).TimeOfDay;
                     }
                     else
                     {

                         CallHistory.NCallDateOn =  Convert.ToDateTime(NCallDateOn);

                         CallHistory.NCallTimeAt =  DateTime.Parse(NCallTimeAt).TimeOfDay;  

                         CallHistory.MeetingDate = null;
                         CallHistory.MeetingTime = null;
                     }

                     db.Tel_CallHistory.AddObject(CallHistory);

                     Tel_Mobile TelMobile = _teacher.getDB().Tel_Mobile.Single(a => a.MobileNo == MobileNo);
                     TelMobile.CallDate = CallHistory.NCallDateOn;
                     TelMobile.CallTime = CallHistory.NCallTimeAt;

                     TelMobile.LCallDateOn = CallHistory.CallDate;
                     TelMobile.LCallTimeAt = CallHistory.CallTime;
                     TelMobile.LCRId = CallHistory.CRId;
                     TelMobile.LCallRemark = CallHistory.CallRemark;
                     TelMobile.LMeetingPoint = CallHistory.MeetingPoint;
                     TelMobile.LMeetingDate = CallHistory.MeetingDate;
                     TelMobile.LMeetingTime = CallHistory.MeetingTime;

                      db.Tel_Mobile.ApplyOriginalValues(TelMobile);

                     db.SaveChanges();

                     db.AcceptAllChanges(); 
```

但是当`db.Tel_Mobile.ApplyOriginalValues(TelMobile)`执行时，显示错误

> 在 ObjectStateManager 中找不到具有与所提供对象的键匹配的键的对象。验证必须应用更改的对象未处于已添加状态，并且其键值与所提供对象的键值匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:27:17.113

你可能想附上它。

```
db.Tel_Mobile.Attach(TelMobile); 
```

# java - 为什么消息再次来到 onMessage() 函数？

> ID：12424355
> 
> 赞同：9
> 
> 时间：2012-09-14T12:14:09.747
> 
> 标签：java, nullpointerexception, jms, listener, activemq

我`ActiveMQ`用来发送消息。

所以当我发送消息时，消息来接收消息。在成功插入时，它被确认。

但是我有确认后的代码，可以抛出`NullPointerException`.

所以为了故意产生那个异常，我抛出了`NullPointerException`. 所以当它这样做时：

消息不是`dequeued`，同样的消息再次出现在`onMessage`函数中。

我的*代码*是：

```
public void onMessage(Message message) {
    String msg = null;
    try
    {
        msg = receiveMessage(message);

        // Other code to insert message in db

        message.acknowledge();

        if(true)
        {
            throw new NullPointerException("npe"));
        }
            ** // Other code which might produce a null pointer exception **
        }
        catch(Exception ex)
        {
        }
    } 
```

为什么该消息再次`onMessage()`像我一样发挥作用`acknowledge()`。

因为我已经在 db.xml 中插入了消息。

队列中的消息不会被删除`acknowledge()`吗？

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T20:50:40.847

您对消息侦听器使用 AUTO 确认模式，然后根据规范，如果消息侦听器未能成功返回（例如，如果抛出异常），则会重新传递消息。

在您的情况下，您正在尝试手动确认消息，但使用创建的会话是不可能的`createSession(false, Session.AUTO_ACKNOWLEDGE)`。

您的代码可以与`Session.CLIENT_ACKNOWLEDGE`.

否则，您希望在使用 AUTO_ACKNOWLEDGE 时捕获 onMessage 方法中的异常。

要对您的消息进行更细粒度的控制，请考虑使用事务处理会话并用于`session.commit();`确认消息已被阅读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-18T21:29:20.093

您是否检查过您没有使用[事务处理会话](http://docs.oracle.com/javaee/6/api/javax/jms/Connection.html#createSession%28boolean,%20int%29)？当使用事务会话时，确认模式被忽略，所以：

*   你`message.acknowledge()`将实际上是一个无操作

*   在转义消息侦听器时，您未捕获的异常将触发“会话回滚”，从而强制重新传递消息。

注意：您发布的代码有一个`catch (Exception ex) { }`，所以我不知道您的异常是如何逃到外面的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-24T15:08:52.053

您可以创建一个单独的方法来处理消息，我的意思是在`onMessage()`函数中编写仅将该消息插入数据库的代码。

并创建一个单独的函数来处理该消息。

这样，如果您在处理过程中遇到任何错误，该消息将不会`onMessage()`再次出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T15:51:55.173

当您使用事务处理 JMS 确认模式时，您的消息将被 JMS-listener 多次接收（在 AMQ 中默认约为 8 次），直到被无异常处理或被 JMS-container 移动到 DQL-queue。有关详细信息，请参阅[消息重新传递和 DLQ 处理](http://activemq.apache.org/message-redelivery-and-dlq-handling.html)。

管理事务取决于您使用的框架。我更喜欢使用[Spring Framework](http://en.wikipedia.org/wiki/Spring_Framework)，所以我的 Spring XML 配置如下所示：

```
<jms:listener-container container-type="default"
                        connection-factory="calendarConnectionFactory"
                        acknowledge="transacted"
                        destination-type="queue"
                        cache="consumer"
                        concurrency="1-5">
    <jms:listener destination="${jms.calendar.destination}" ref="calendarListener"/>
</jms:listener-container> 
```

我的消息监听器的 Java 代码是

```
@Override
@Transactional(propagation = Propagation.REQUIRED,
               noRollbackFor =
                 {ClassCastException.class, IllegalArgumentException.class})
public void onMessage(Message message) {
 ....
} 
```

所以我可以管理哪些异常会回滚事务。

# javascript - iScroll4 - 滚动时禁用点击事件

> ID：12424361
> 
> 赞同：3
> 
> 时间：2012-09-14T12:14:37.647
> 
> 标签：javascript, jquery, scroll, iscroll4

我在一个里面有 Lis 的 div 上使用 iSroll4，每个 LI 都有一个链接。当我开始滚动时，触发了内部 LI 的点击事件。我希望点击事件保持可用，但在滚动时不可用。

请帮忙.. thnx :)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T00:51:00.403

```
$('.link').on('click', function() {
  if (myScroll.moved) return; 
  // add click functionality here
}); 
```

来自 iScroll 论坛[https://groups.google.com/forum/#!topic/iscroll/0ai6QzTtbJE](https://groups.google.com/forum/#!topic/iscroll/0ai6QzTtbJE)

# c# - C#.net 中进度条的使用

> ID：12424369
> 
> 赞同：0
> 
> 时间：2012-09-14T12:15:03.497
> 
> 标签：c#

在我的一个winform中，我试图根据组合框中的月份和年份选择在数据网格上填充员工天数和缺勤天数的数据。

一旦单击“显示”按钮，它需要一些时间来填充，所以我想在底部栏使用进度条，说明“正在填充列表”（如在控制面板中添加或删除程序）。如果他们的任何其他建议使其发挥作用是最受欢迎的。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:17:19.770

看看[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)。

您还应该在提问之前进行搜索，[这里有很多类似的问题](https://stackoverflow.com/search?q=%5Bc%23%5D+backgroundworker+progressbar&submit=search)，您可以查看哪些可能对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:21:45.303

您可以使用 BackgroundWorker 线程来处理数据填充。这将为用户提供视觉反馈，同时保持 UI 响应。看这里：http: [//msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:24:21.203

您可以通过继承 StatusBar 将 ProgressBar 添加到 .NET StatusBar 控件的面板中。然后在 WinForm 上使用派生的 StatusBar，就像使用标准控件一样。[请参阅示例和文章](http://www.thescarms.com/dotnet/ProgressStatus.aspx)

您也可以尝试此[示例](http://www.codeproject.com/Articles/10166/C-StatusBarProgressPanel-Control)，提供示例代码供下载。

# c++ - getline() 返回错误

> ID：12424370
> 
> 赞同：1
> 
> 时间：2012-09-14T12:15:09.253
> 
> 标签：c++

我正在尝试从文件中读取并`strtok()`用来分解我从文件中获取的字符串。问题是，每当我编译程序时，我都会收到这个错误。

```
source.cpp: In function ‘int main(int, char**)’:
source.cpp:39:32: error: no matching function for call to ‘getline(char [1000], int,     char)’
source.cpp:39:32: note: candidates are:
/usr/include/stdio.h:675:20: note: __ssize_t getline(char**, size_t*, FILE*)
/usr/include/stdio.h:675:20: note:   no known conversion for argument 1 from ‘char   [1000]’ to ‘char**’
/usr/include/c++/4.6/bits/basic_string.h:2734:5: note: template<class _CharT, class    _Traits, class _Alloc> std::basic_istream<_CharT, _Traits>&    std::getline(std::basic_istream<_CharT, _Traits>&, std::basic_string<_CharT, _Traits,   _Alloc>&)
/usr/include/c++/4.6/bits/basic_string.tcc:1070:5: note: template<class _CharT, class _Traits, class _Alloc> std::basic_istream<_CharT, _Traits>&   std::getline(std::basic_istream<_CharT, _Traits>&, std::basic_string<_CharT, _Traits,   _Alloc>&, _CharT) 
```

这是导致问题的代码部分。

```
char *p, line[1000], opcode[9], arg1[256], arg2[256];

int i = 0;

while(getline(line, 1000, '\n') != NULL)
{
    line[strlen(line)-1] = '\0';
    cout << "Line = " << line << endl;

    if (strchr(line, '#'))
    {
        *p = '\0';
    }
    if (p = strtok(line, "\t"))
        strcpy(opcode,p);
    if (p = strtok(NULL, "\t"))
        strcpy(arg1,p);
    if (p = strtok(NULL, "\t"))
        strcpy(arg2,p);

    printf("opcode=:%s: arg1=:%s: arg2=:%s:\n",opcode,arg1,arg2);

} 
```

我会很感激我能得到的任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:18:24.420

您完全错误地调用该`getline()`函数。`getline()`有关如何使用它，请参阅手册。你得到一个提示：

```
candidates are:
__ssize_t getline(char**, size_t*, FILE*) 
```

在你的情况下，它会是这样的：

```
getline(&line, 1000, your_file_pointer) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:19:39.240

您需要先打开文件的流，然后才能开始写入。

[这是有关如何执行此操作的教程。](http://www.cplusplus.com/doc/tutorial/files/)

# android - 如何滚动到 Horizo ntalScrollView 的孩子的中心？

> ID：12424373
> 
> 赞同：9
> 
> 时间：2012-09-14T12:15:16.963
> 
> 标签：android, horizontalscrollview, rect

我需要滚动到 Horizo​​ntalScrollView 的 childView(TextView) 的中心。我已经使用下面的代码获得了中心孩子，现在我想将箭头调整到该孩子视图的确切中心。

在这里，我所做的是我拿了一个 Horizo​​ntalScrollView，在里面有一个 LineaerLayout，在 LinearLayout 里面我有 TextViews。

这是我的 XML：

```
 <com.sample.test.ScrollViewCustom
                android:id="@+id/mHorizontalScrollViewMain"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_alignBottom="@id/relativeOne"
                android:background="@drawable/mergethree2"
                android:scrollbars="none" >

                <LinearLayout
                    android:id="@+id/llayoutfirst"
                    android:layout_width="wrap_content"
                    android:layout_height="55dip"
                    android:orientation="horizontal" >

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />

                    <TextView
                        android:id="@+id/mtxtHome"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_marginBottom="5dip"
                        android:layout_marginLeft="5dip"
                        android:layout_marginRight="5dip"
                        android:layout_marginTop="8dip"
                        android:text="home"
                        android:textColor="@android:color/white"
                        android:textSize="15sp"
                        android:typeface="serif" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />

                    <TextView
                        android:id="@+id/mtxtSchools"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_marginBottom="5dip"
                        android:layout_marginLeft="5dip"
                        android:layout_marginRight="5dip"
                        android:layout_marginTop="8dip"
                        android:text="schools"
                        android:textColor="@android:color/white"
                        android:textSize="15sp"
                        android:typeface="serif" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />

                    <TextView
                        android:id="@+id/mtxtCalendar"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_marginBottom="5dip"
                        android:layout_marginLeft="5dip"
                        android:layout_marginRight="5dip"
                        android:layout_marginTop="8dip"
                        android:text="calendar"
                        android:textColor="@android:color/white"
                        android:textSize="15sp"
                        android:typeface="serif" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />

                    <TextView
                        android:id="@+id/mtxtActivitiesAndClubs"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_marginBottom="5dip"
                        android:layout_marginLeft="5dip"
                        android:layout_marginRight="5dip"
                        android:layout_marginTop="8dip"
                        android:text="activitiesandclubs"
                        android:textColor="@android:color/white"
                        android:textSize="15sp"
                        android:typeface="serif" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />

                    <TextView
                        android:id="@+id/mtxtBoosters"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_marginBottom="5dip"
                        android:layout_marginLeft="5dip"
                        android:layout_marginRight="5dip"
                        android:layout_marginTop="8dip"
                        android:text="boosters"
                        android:textColor="@android:color/white"
                        android:textSize="15sp"
                        android:typeface="serif" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />

                    <TextView
                        android:id="@+id/mtxtSchoolMenu"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_marginBottom="5dip"
                        android:layout_marginLeft="5dip"
                        android:layout_marginRight="5dip"
                        android:layout_marginTop="8dip"
                        android:text="schoolmenu"
                        android:textColor="@android:color/white"
                        android:textSize="15sp"
                        android:typeface="serif" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />

                    <TextView
                        android:id="@+id/mtxtStaff"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_marginBottom="5dip"
                        android:layout_marginLeft="5dip"
                        android:layout_marginRight="5dip"
                        android:layout_marginTop="8dip"
                        android:text="staff"
                        android:textColor="@android:color/white"
                        android:textSize="15sp"
                        android:typeface="serif" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />

                    <TextView
                        android:id="@+id/mtxtMyFavorites"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_marginBottom="5dip"
                        android:layout_marginLeft="5dip"
                        android:layout_marginRight="5dip"
                        android:layout_marginTop="8dip"
                        android:text="myfavorites"
                        android:textColor="@android:color/white"
                        android:textSize="15sp"
                        android:typeface="serif" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />

                    <TextView
                        android:id="@+id/mtxtAboutContact"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:layout_marginBottom="5dip"
                        android:layout_marginLeft="5dip"
                        android:layout_marginRight="5dip"
                        android:layout_marginTop="8dip"
                        android:text="aboutcontact"
                        android:textColor="@android:color/white"
                        android:textSize="15sp"
                        android:typeface="serif" />

                    <TextView
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginTop="12dip"
                        android:background="@drawable/blackline" />
                </LinearLayout>
        </com.sample.test.ScrollViewCustom> 
```

我想要的是，我希望箭头正好位于屏幕中心的 TextView 中心。如下图。

![在此处输入图像描述](../Images/334c09e45331b2c05c0d343d59cb6cbd.png)

我现在得到的是..

![在此处输入图像描述](../Images/45993728927172bf72e9768f2a63a42f.png)

我已经使用以下代码获得了孩子的中心，但现在我的要求是滚动到该孩子的屏幕中心。

这是我的代码：

```
 scroll.setOnScrollStopListner(new onScrollStopListner() {
                    @Override
                    public void onScrollStoped() {
int scrollX = scroll.getScrollX();
                    int width = lLayOne.getChildAt(1).getWidth();
                    int home = width;
                    int school = width * 2;
                    int calender = width * 3;
                    int activityNclubs = width * 4;
                    int booster = width * 5;
                    int schoolMenu = width * 6;
                    int staff = width * 7;
                    int myFav = width * 8;
                    int about = width * 9;

                    if ( scrollX > 0 && scrollX < home ) {
                        Log.d(TAG, "Home "+" scrollx "+scrollX+" home "+home);
                    }else if ( scrollX > home && scrollX < school ) {
                        Log.d(TAG, "school"+" scrollx "+scrollX+" school "+school);
                    }else if ( scrollX > school && scrollX < calender ) {
                        Log.d(TAG, "calender"+" scrollx "+scrollX+" calender "+calender);
                    }else if ( scrollX > calender && scrollX < activityNclubs ) {
                        Log.d(TAG, "activity n clubs"+" scrollx "+scrollX+" activity "+activityNclubs);
                    }else if ( scrollX > activityNclubs && scrollX < booster ) {
                        Log.d(TAG, "booster"+" scrollx "+scrollX+" booster "+booster);
                    }else if ( scrollX > booster && scrollX < schoolMenu ) {
                        Log.d(TAG, "school menu"+" scrollx "+scrollX+" school menu "+schoolMenu);
                    }else if ( scrollX > schoolMenu && scrollX < staff ) {
                        Log.d(TAG, "staff"+" scrollx "+scrollX+" staff "+staff);
                    }else if ( scrollX > staff && scrollX < myFav ) {
                        Log.d(TAG, "myFav"+" scrollx "+scrollX+" fav "+myFav);
                    }else if ( scrollX > myFav && scrollX < about ) {
                        Log.d(TAG, "about"+" scrollx "+scrollX+" about "+about);
                    }                       // TODO Auto-generated method stub

}
            }); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-22T22:57:20.947

首先我可以看到你使用一个TextView来画一条黑线，你可以只使用一个View。

所以如果我们假设你创建了一个 OnScrollStopListener 接口，你可以使用下面的代码来获取元素中心。

```
 scroll.setOnScrollStopListener(new OnScrollStopListener() {
        @Override
        public void onScrollStoped() {
            //get the center
            int center = scroll.getScrollX() + scroll.getWidth() / 2;
            LinearLayout linearLayout = ((LinearLayout)scroll.findViewById(R.id.llayoutfirst));
            int chilrenNum = linearLayout.getChildCount();
            for (int i = 0; i < chilrenNum; i++) {
                View v = linearLayout.getChildAt(i);
                if(v.getClass()!=TextView.class){
                    // you do no care about that view
                    continue;
                }
                int viewLeft = v.getLeft();
                int viewWidth = v.getWidth();
                if (center >= viewLeft && center <= viewLeft + viewWidth) {
                    Log.d(TAG, "CENTER THIS : " + ((viewLeft + viewWidth / 2) - center));
                    scroll.scrollBy((viewLeft + viewWidth / 2) - center, 0);
                    break;
                }
            }
        }
    }); 
```

如您所见，步骤是：

1.  找到 ScrollView 的滚动中心。
2.  扫描所有要居中的元素（childrenViews）（在这种情况下只有 TextViews）。
3.  如果滚动视图的中心在元素的边界内，则测试每个元素。
4.  滚动（以您想要的任何方式 - 在这种情况下使用*scrollBy*）到元素中心并打破循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-16T09:32:27.117

这对我有用：

```
HorizontalScrollView calendarScroller = (HorizontalScrollView)findViewById(R.id.calendarScroller);
    Handler handler=new Handler();
    Runnable mTabSelector = new Runnable() {
        public void run() {
            View tabView = dateScroller.getChildAt(selectedDateIndex);// selected child view
            final int scrollPos = tabView.getLeft() - (calendarScroller.getWidth() - tabView.getWidth()) / 2;
            calendarScroller.smoothScrollTo(scrollPos, 0);
           // mTabSelector = null;
        }
    };
    handler.postDelayed(mTabSelector, 10); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-22T15:10:40.930

这对我有用：

```
 SHVradioChannels.setOnTouchListener(new OnTouchListener() {

        @Override
        public boolean onTouch(View v, MotionEvent event) {

            if (event.getAction() == MotionEvent.ACTION_UP) {       
                int center = SHVradioChannels.getScrollX() + SHVradioChannels.getWidth() / 2;
                LinearLayout linearLayout = ((LinearLayout)SHVradioChannels.findViewById(R.id.LLradioChannels));
                int chilrenNum = linearLayout.getChildCount();
                for (int i = 0; i < chilrenNum; i++) {
                    View v2 = linearLayout.getChildAt(i);
                    int viewLeft = v2.getLeft();
                    int viewWidth = v2.getWidth();
                    if (center >= viewLeft && center <= viewLeft + viewWidth) {
                        SHVradioChannels.scrollBy((viewLeft + viewWidth / 2) - center, 0);
                        break;
                    }
                }
            }
            return false;
        }
    }); 
```

# asp.net-mvc - 创建一个假的 DbContext

> ID：12424379
> 
> 赞同：2
> 
> 时间：2012-09-14T12:15:44.703
> 
> 标签：asp.net-mvc, entity-framework, unit-testing

我正在使用 EF 创建一个 MVC 应用程序，目前使用的是通用存储库模式，例如：[通用存储库模式](http://www.tugberkugurlu.com/archive/generic-repository-pattern-entity-framework-asp-net-mvc-and-unit-testing-triangle)。除了为每个存储库创建一个新的上下文并且在我的应用程序中需要使用两个或更多存储库这一事实之外，一切都运行良好。当我使用 StructureMap 时，我添加了

```
x.For<IDbContext>().HttpContextScoped().Use(context => new MyContext()); 
```

其中 IDbContext 具有相应的方法，不再是通用的，而是通过构造函数传递的。

当我必须测试事物时，问题就出现了——我想创建一个内存存储（比 db、自定义、易于控制的数据更快），例如 HashTable 或 HashSet。我想不通的是如何制作一个假的 IDbContext 实现，从该 HashTable 中检索数据。作为参考 IDbContext 看起来像这样（只有通用存储库中 DbContext 使用的方法）：

```
 public interface IDbContext : IDisposable
    {
        IDbSet<TEntity> Set<TEntity>() where TEntity : class;
        DbEntityEntry<TEntity> Entry<TEntity>(TEntity entity) where TEntity : class;
        int SaveChanges();
    } 
```

在目前的情况下，我想我犯了一个重大错误，因为创建虚假上下文似乎不是常规程序。任何有关如何改进我的应用程序架构并使其更具可测试性的建议都值得赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:59:55.410

当我过去这样做时，我通常使用字典来保存我的测试数据，例如：

```
public class FakeDb : IDbContext
{
    private Dictionary<Type, Object> _lists = new Dictionary<Type, Object>();
    public List<T> GetList<T>()
    {
        var type = typeof(T);
        if(!_lists.Contains(type))
        {
            _lists.Add(type, new List<T>());
        }
        return (List<T>)_lists[type];
    }

    ///
} 
```

[从更广泛的角度来看，通过将查询构建逻辑包装到单个类而不是存储库类](http://ayende.com/blog/3955/repository-is-the-new-singleton)中，我取得了很大的成功。

# c++ - 如何使用 C++ 结束进程？

> ID：12424380
> 
> 赞同：0
> 
> 时间：2012-09-14T12:15:51.743
> 
> 标签：c++, winapi, console, process, terminate

我正在尝试创建一个结束进程的 C++ 程序。所以从头开始，我不太确定我应该朝哪个方向前进？我的意思是根据我所做的研究，解决方案涉及以下步骤（如果逻辑不正确，请告诉我）：

1.  获取进程名称（在我的情况下它总是相同的）

2.  遍历所有进程并找到匹配的名称（假设该进程具有唯一的名称）

3.  获取 id 并终止它

正如我所提到的，我不必担心检查重复的进程名称，因为它被认为是唯一的，但现在我需要关于我应该查看哪种库、类等的指导？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:37:24.343

请参阅[EnumProcesses](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682629%28v=vs.85%29.aspx)和研究进程的句柄。

将一个 pID 类型的空数组传递给 EnumProcesses，它将用所有当前正在运行的进程的 pID 填充它，因此请使用一个大数组。这样，您可以枚举所有正在运行的进程。

使用 OpenProcess 获取与 PID 关联的句柄并调用 GetModuleFileNameEx 以获取其完全限定的路径，以查看您正在查看的路径是否是您想要的路径。

然后，您可以在句柄上使用 TerminateProcess，如果它是您想要结束的句柄。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:19:18.770

使用该[`TerminateProcess`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686714%28v=vs.85%29.aspx)功能。

# android - 在 Android 中检查数据库是否存在

> ID：12424384
> 
> 赞同：0
> 
> 时间：2012-09-14T12:16:23.020
> 
> 标签：android, sqlite

> **可能重复：**
> [如何在 Android 2.2 上创建新数据库之前检查现有数据库？](https://stackoverflow.com/questions/4645961/how-to-check-existing-database-before-creating-new-database-on-Android-2-2)

我有一个应用程序在启动时检查数据库是否存在。如果没有退出，则创建一个新的，如果存在则访问数据库。你能告诉我如何检查 db(SQlite) 的存在吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:22:14.360

我使用一个布尔标志，在调用[SQLiteOpenHelper](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)`onCreate`时设置为true 。[你可以在这里](https://github.com/marwinxxii/ccardstats/blob/master/src/com/github/marwinxxii/ccardstats/db/DBHelper.java#L44)找到我的完整代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:25:16.153

看看[query-if-android-database-exists](https://stackoverflow.com/questions/3386667/query-if-android-database-exists/9031969#9031969)

* * *

在 try 块中使用数据库路径打开您的数据库，例如：

```
try{
   SQLiteDatabase   dbe = SQLiteDatabase.openDatabase("/data/data/bangla.rana.fahim/databases/dictionary", null,0);
            Log.d("opendb","EXIST");
            dbe.close();
            } 
```

如果发生异常，则数据库不存在，因此创建它：

```
catch(SQLiteException e){
                Log.d("opendb","NOT EXIST");

            SQLiteDatabase db = openOrCreateDatabase("dictionary", MODE_PRIVATE, null);
                    db.execSQL("CREATE TABLE IF NOT EXISTS LIST(wlist varchar);");

                    db.execSQL("INSERT INTO LIST VALUES('খবর');");
                    db.execSQL("INSERT INTO LIST VALUES('কবর');"); //whatever you want
                 db.close();
} 
```

就是这样，你完成了:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:25:57.670

Android 帮助很多开发人员管理数据库。你应该有一个像这样的类（一个只有 1 列的表）：

```
public class MyDBOpenHelper extends SQLiteOpenHelper {

private static final String queryCreationBdd = "CREATE TABLE partie (id INTEGER PRIMARY KEY)";

public MyDBOpenHelper(Context context, String name, CursorFactory factory, int version) 
{
    super(context, name, factory, version);
}

@Override
public void onCreate(SQLiteDatabase db) 
{
    db.execSQL(queryCreationBdd);
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) 
{
    db.execSQL("DROP TABLE partie;");
    db.execSQL("DELETE FROM sqlite_sequence"); //table which contains the next incremented key value
    onCreate(db);
}

} 
```

然后你只需这样做：

```
MyDBOpenHelper databaseHelper = new MyDBOpenHelper(context, "dbname.db", null, 1);
SQLiteDatabase bdd = databaseHelper .getWritableDatabase(); 
```

如有必要，Android 将创建数据库（调用 onCreate 方法）或为您提供已经存在的数据库。第四个参数是数据库的版本。如果当前创建的数据库不是最新版本，则会调用 onUpgrade。

编辑：数据库路径将是这样的：

```
/data/data/fr.mathis.application/databases/dbname.db 
```

# android - Robotium：将 Android Robotium 项目从 Eclipse 导入 IntelliJ 时出现问题

> ID：12424392
> 
> 赞同：2
> 
> 时间：2012-09-14T12:16:33.683
> 
> 标签：android, intellij-idea, robotium

我有一个项目最初是用 Eclipse 编写的，作为应用程序项目的一个单独的 Robotium 项目，需要进行测试。我想将它导入 IntelliJ IDEA。我猜，IDEA 的问题与该应用程序项目的可见性有关。我已将其添加为模块依赖项，如此处所[建议](https://stackoverflow.com/questions/9718920/robotium-howto-create-a-test-project-for-an-existing-project-in-intellij-idea)。但这没有帮助。IDEA 仍然会抛出编译错误，例如：

```
type parameter com.***.MyActivity is not within its bound    
cannot find symbol constructor Solo(android.app.Instrumentation, com.***.MyActivity) 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T14:46:54.157

请注意，当您设置模块之间的依赖关系时，默认情况下该模块的库将不可用于另一个模块，需要显式启用相应库的**导出**复选框。

# javascript - Javascript：在Firefox上输入具有奇怪行为的输入元素

> ID：12424404
> 
> 赞同：2
> 
> 时间：2012-09-14T12:17:04.620
> 
> 标签：javascript, jquery, firefox, input

我有一个带有选择、按钮和输入元素的 html 表单。

```
<form action="">
    <button>innocent button</button>
    <select multiple name="multiple">
    <option selected value="a">A</option>
    <option value="b">B</option>
</select>
<input style="width:300px" type="text" value="press here enter and look at the multiple select" name="" />
</form> 
```

和一些 jquery javascript

```
$(document).ready(function(){
            console.log('hi');

            var $button = $('button');

            $button.on('click',function(e){

                $('select option').first().attr('selected',false);
                e.preventDefault();

            }); 
```

演示：在这里尝试：http: [//jsfiddle.net/3Rjdh/](http://jsfiddle.net/3Rjdh/)

在 Chrome 上一切正常。但在 Firefox 上：如果您在输入字段中按 ENTER，则选择元素将失去选中状态。

火狐有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:25:06.307

当您在输入上按 enter 时，您实际上是在触发按钮的单击事件，尝试将 conole.log 放在那里，您会看到它触发

[您可以通过执行以下](https://stackoverflow.com/questions/585396/how-to-prevent-enter-keypress-to-submit-a-web-form)操作来停止提交

```
 function stopSubmit(e){
      e = e || event;
      return (e.keyCode || event.which || event.charCode || 0) !== 13;
   } 
```

然后在您的表单中添加按键事件

```
 <form onkeypress="return stopSubmit(event)"> 
```

查看[更新的小提琴](http://jsfiddle.net/3Rjdh/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:43:57.803

我想，我通过添加带有值按钮的属性类型来修复它

[http://jsfiddle.net/3Rjdh/2/](http://jsfiddle.net/3Rjdh/2/)

# java - 在 Jython 中，我可以创建一个实现 Java 接口的内联匿名类吗？

> ID：12424405
> 
> 赞同：5
> 
> 时间：2012-09-14T12:17:04.170
> 
> 标签：java, jython, anonymous-class

在Java中，我可以说

```
Thread t = new Thread(){
    public void run(){ // do stuff }
} 
```

（或类似的东西）来声明一个匿名类内联。这对于制作事件处理程序或其他回调类型的东西最有用，在任何*明智*的语言[中都不需要对象首先拥有它们](http://steve-yegge.blogspot.com/2006/03/execution-in-kingdom-of-nouns.html)。

我在 Jython 中遇到了同样的问题——我想定义一个事件处理程序，但我不想构建一个完整的独立类来这样做。

理想情况下，我只能传递一个 lambda 并完成它，但如果可能的话，我在文档中的任何地方都找不到它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-24T22:41:22.280

以下是我原始答案的背景阅读链接：

阅读本文：[Python 是否有类似 Java 的匿名内部类的东西？](https://stackoverflow.com/questions/357997/does-python-have-something-like-anonymous-inner-classes-of-java)

然后，阅读以下内容：[Python 有匿名类吗？](https://stackoverflow.com/questions/1123000/does-python-have-anonymous-classes)

最后，阅读这篇文章：[是否可以在 Python 中创建匿名对象？](https://stackoverflow.com/questions/652276/is-it-possible-to-create-anonymous-objects-in-python)

**[对原始答案的改进]**

Jython 在适当时将函数隐式转换为事件处理程序。因此，您可以在其中一种方法中编写此代码：

```
def _(self, event):
    print 'Cancel button was clicked!'
    if self.task is not None:
        self.task.cancel()
cancelButton.setOnAction(lambda event: _(self, event)) 
```

这种方法提供了匿名内部类的三个理想特性。

(1) 高度**本地化**。处理程序代码位于分配处理程序的代码旁边。

(2) 它是**self-aware**，这意味着您`self`可以访问包含对象的所有成员。

(3) 它（几乎）是**匿名**的。Python 强制我为多行函数选择一个名称，但它也允许我重用该名称。`_`因此，只要我立即使用它们，我就可以定义尽可能多的本地函数。（用相同的名称定义第二个函数会使该名称无法访问第一个函数。）因此，我不必无限地发明唯一名称。

您还可以将此模式打包在装饰器中，我认为这可以稍微阐明意图：

```
@LocalEventHandler(self, cancelButton.setOnAction)
def _(self, event):
    print 'Cancel button was clicked!'
    if self.task is not None:
        self.task.cancel() 
```

装饰器实现如下所示：

```
class LocalEventHandler(object):
    '''This decorator turns a local function into a *self aware* event handler.'''

    def __init__(self, context, assignHandlerFunc):
        self.context = context
        self.assignHandlerFunc = assignHandlerFunc

    def __call__(self, handler):
        self.assignHandlerFunc(lambda event: handler(self.context, event))
        return handler 
```

# php - 计算 SQL 表行并在结果上加 1

> ID：12424409
> 
> 赞同：4
> 
> 时间：2012-09-14T12:17:16.373
> 
> 标签：php, mysql, sql, count

我正在尝试计算表格行并在结果上加 1，我有这段代码。

```
$countQuery = "SELECT COUNT(id) FROM donations";
$outcomeQuery = mysql_query($countQuery);
$countUp = mysql_fetch_array($outcomeQuery);
$plusOne = 1; 
$outcome = $countUp;
echo $outcome[0]
    or die(mysql_error()); 
```

但这给了我错误：

> 致命错误：不支持的操作数类型

我需要这个，所以我总是有一个以前的捐赠者没有使用过的唯一号码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T12:18:18.010

你可以使用：

```
SELECT COUNT(id)+1 as IDCount FROM donations 
```

作为您的查询。这将节省您在 PHP 中进行数学运算的任何麻烦。您拉回的数组将立即获得您想要的数字。

编辑：然而，更好的选择是使用自动递增的列类型。在 MySQL 中，这是通过`auto_increment`create table 语法中的语法完成的。

使用它，您实际上*不必*插入一个值，而是`NULL`按如下方式传递它（假设 ID 是带有 Auto_increment 的字段：

```
insert into tableName (ID,Name) values (null, 'Fluffeh'); 
```

所以你看到你没有给它任何 ID 列的值 - 数据库会使用正确的数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T12:34:43.613

使用简单的 php

```
$countQuery = mysql_query("SELECT id FROM donations");
$count=mysql_num_rows($countQuery);
$count+=1; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:22:38.397

依靠**`COUNT`**给你一个唯一的号码是很危险的。如果两个进程执行这个查询，然后都尝试并提交会发生什么：你突然两次获得相同的值。

实现某种独立于表内容的序列函数会更安全。此链接显示了一种可能性：

[http://forums.mysql.com/read.php?61,143867,238482#msg-238482](http://forums.mysql.com/read.php?61,143867,238482#msg-238482)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T13:37:59.933

这个问题是针对 MySQL 数据库的。我建议您使用[AUTO INCREMENT 字段类型](http://dev.mysql.com/doc/refman/5.1/en/example-auto-increment.html)。当您使用 PHP 时，如果您需要在插入记录后知道 id，请使用：

```
mysql_query("INSERT INTO mytable (1, 2, 3, 'blah')");
$id = mysql_insert_id(); 
```

见[`mysql_insert_id()`](http://dev.mysql.com/doc/refman/5.1/en/example-auto-increment.html)。

使用

> 4 个随机生成的数字，确保 100% 没有重复

不会 100% 确定没有重复项。不要重新发明轮子。这就是确保使用唯一递增标识符的问题已得到解决的方法，您不需要为并不总是有效的自制解决方案感到尴尬。

# java - 如何正确同步 AsynchronousSocketChannel 上的并发读写

> ID：12424412
> 
> 赞同：5
> 
> 时间：2012-09-14T12:17:21.937
> 
> 标签：java, sockets, concurrency, nio, vert.x

我正在尝试使用 CompletionHandler 而不是 Futures 在 vert.x 工作线程中的 AsynchronousSocketChannel 上实现单个请求/响应。来自 vert.x 文档：

> “Worker Verticle 永远不会被多个线程同时执行。”

所以这是我的代码（不确定我是否 100% 正确处理了套接字 - 请发表评论）：

```
 // ommitted: asynchronousSocketChannel.open, connect ...

    eventBus.registerHandler(address, new Handler<Message<JsonObject>>() {
        @Override
        public void handle(final Message<JsonObject> event) {
            final ByteBuffer receivingBuffer = ByteBuffer.allocateDirect(2048);
            final ByteBuffer sendingBuffer = ByteBuffer.wrap("Foo".getBytes());

            asynchronousSocketChannel.write(sendingBuffer, 0L, new CompletionHandler<Integer, Long>() {
                public void completed(final Integer result, final Long attachment) {
                    if (sendingBuffer.hasRemaining()) {
                        long newFilePosition = attachment + result;
                        asynchronousSocketChannel.write(sendingBuffer, newFilePosition, this);
                    }

                    asynchronousSocketChannel.read(receivingBuffer, 0L, new CompletionHandler<Integer, Long>() {
                        CharBuffer charBuffer = null;
                        final Charset charset = Charset.defaultCharset();
                        final CharsetDecoder decoder = charset.newDecoder();

                        public void completed(final Integer result, final Long attachment) {
                            if (result > 0) {
                                long p = attachment + result;
                                asynchronousSocketChannel.read(receivingBuffer, p, this);
                            }

                            receivingBuffer.flip();

                            try {
                                charBuffer = decoder.decode(receivingBuffer);
                                event.reply(charBuffer.toString()); // pseudo code
                            } catch (CharacterCodingException e) { }

                        }

                        public void failed(final Throwable exc, final Long attachment) { }
                    });
                }

                public void failed(final Throwable exc, final Long attachment) { }
            });
        }
    }); 
```

我在负载测试期间遇到了很多 ReadPendingException 和 WritePendingException，如果在句柄方法中一次真的只有一个线程，这似乎有点奇怪。如果一次只有 1 个线程与 AsynchronousSocketChannel 一起工作，怎么可能读取或写入尚未完全完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:23:01.090

AsynchronousSocketChannel 的处理程序在它们自己的 AsynchronousChannelGroup 上执行，AsynchronousChannelGroup 是 ExecutorService 的派生。除非您做出特别努力，否则处理程序将与启动 I/O 操作的代码并行执行。

要在 Verticle 中执行 I/O 完成处理程序，您必须从该 Verticle 创建并注册一个处理程序，该处理程序执行 AsynchronousSocketChannel 的处理程序现在所做的事情。

AsynchronousSocketChannel 的处理程序应该只将其参数（结果和附件）打包到消息中并将该消息发送到事件总线。

# java - 在特殊情况下使用 XPATH 提取属性值

> ID：12424416
> 
> 赞同：1
> 
> 时间：2012-09-14T12:17:40.550
> 
> 标签：java, xml, design-patterns, xpath, tags

嗨，我需要帮助才能使用 xpath 从 XML 中提取信息。

我将使用 Xpath 来提取一个以通用键开头的 Tag 的属性值：

```
<st:Testprova id='abcd'>
  ....
</st>

  or

<st:Test1prova id='defg'>
  ....
</st> 
```

我使用了那个 Xpath 表达式：

```
"//*[contains(.,'prova')]/@ID" 
```

但不起作用。你能帮助我吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:20:35.403

您正在使用`@ID`而不是`@id`，这是区分大小写的。此外，您应该使用`name()`来检索节点名称。

这个 XPath 表达式

```
//*[contains(name(),'prova')]/@id 
```

返回`abcd`和`defg`

尽管您的 XML 不正确，但它应该是：

```
<st:Testprova id='abcd'>
  ....
</st:Testprova>
<st:Test1prova id='defg'>
  ....
</st:Test1prova> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T13:22:53.943

在这种情况下要使用的正确函数是`matches()`。

contains() 即使对于像这样的节点名称也可以返回 true

```
Testprova
Prodprova
UATprova
provaTest 
```

和其他曾经包含prova这个词的人。

但是，如果您知道节点名称的模式，那么 match() 函数会准确过滤掉所需的节点。

因此，如果我假设两个单词之间可能出现一个数字，则 xpath 可以如下所示

```
//*[matches(name(), '^Test[0-9]?prova$')]//@ID 
```

**注意：** matches 函数是 Xpath2.0 的一部分，在 Xpath1.0 中不起作用

# c - 指向结构的指针成员

> ID：12424417
> 
> 赞同：0
> 
> 时间：2012-09-14T12:17:41.457
> 
> 标签：c, pointers, struct, 8051

我的编译器出现如下错误：

> C51 编译器 V9.01 - SN：C1ADC-HAI60D 版权所有 KEIL ELEKTRONIK GmbH 1987 - 2009 *** SEQUENCE.C 第 300 行中的 C260 警告：'='：指针截断 *** SEQUENCE.C 第 301 行中的错误 C190：'&'：不是左值

以下是我的代码：

```
 struct myCond{
    unsigned char currStatus;
    unsigned char prevStatus;
    unsigned int *timer;
    unsigned char *flag;
   }
  struct myCond StatCond;

  unsigned int data timerdata;
  bit bdata timeflag;

  void someSubroutine (void)
  {
    struct myCond *tempCond;

tempCond = &StatCond;
tempCond->timer = &((unsigned int)timerdata);
tempCond->flag = &((unsigned char)timeflag);
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:36:52.347

我们是否应该猜测哪一行是 301？

据我了解，问题在这里：

```
tempCond->timer = &((unsigned int)timerdata);
tempCond->flag = &((unsigned char)timeflag); 
```

`(unsigned int)timerdata`准确地说，`(unsigned char)timeflag`是价值观。`r-values`它们不能被修改或分配，不像`l-values`，它是普通的`timerdata`和`timeflag`是。所以你不能使用`r-values`with的地址`&`。这与写作相同`&1`。`1`它本身并不作为数据存储器中的对象存在。

你应该改写：

```
tempCond->timer = &timerdata;
tempCond->flag = (unsigned char*)&timeflag; 
```

而且我不太确定获取位变量的地址是否合法。最后一行可能无法编译。

也许重新定义结构会有所帮助：

```
struct myCond{
...
    bit bdata *flag; // or maybe without bdata
   } 
```

然后你会写`tempCond->flag = &timeflag;`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:23:46.943

```
unsigned int data timerdata;  // what is 'data', is it defined?
bit bdata timerflag;  // what are 'bit' and 'bdata', are they defined? 
```

根据我上面的问题检查您的代码。编译器错误通常在真正的攻击之后多行报告。

# iphone - 电影下载器应用程序如何在 iOS 中运行？

> ID：12424420
> 
> 赞同：0
> 
> 时间：2012-09-14T12:18:03.527
> 
> 标签：iphone, objective-c, ios, video-streaming

视频下载器应用程序如何在 iOS 中运行？有很多应用程序，例如

[http://itunes.apple.com/in/app/video-downloader-super-lite/id481701140?mt=8](http://itunes.apple.com/in/app/video-downloader-super-lite/id481701140?mt=8)

[http://itunes.apple.com/in/app/video-downloader/id524931696?mt=8](http://itunes.apple.com/in/app/video-downloader/id524931696?mt=8)

他们如何从视频播放器（来自 Web 视图的视频）获取 URL？我尝试使用代理但无法追踪。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:37:28.633

他们直接解析响应以找到视频的 URL，然后下载视频数据并在必要时进行转换。

在某些情况下，这很容易（如果 URL 直接是视频）。在其他情况下，它有点复杂。对 youtube、vimeo、ted 等常见视频托管网站的支持是硬编码的。每个站点都有一个特定的方案来表示视频页面（它是 html，可能使用 javascript）。该方案的知识允许识别它并找到数据的链接。

在某些情况下，视频采用直接可用的格式（如 h264）。在其他情况下不是。在许多情况下，您从 html 页面获得的是 flash 文件的 URL。下一步是下载 Flash 文件本身并对其进行解析以提取视频或视频数据的 URL。

在其他情况下，视频根本不作为文件提供。例如，它可以使用流式传输协议。获取流的参数和URL后，必须接收流并将视频转换为本地视频文件。

# java - 升级我的 Spring WebFlow 项目以使用 Maven 和 Hibernate4。现在获取 NoSuchMethodException：org.hibernate.cfg.Configuration.addAnnotatedClass

> ID：12424423
> 
> 赞同：2
> 
> 时间：2012-09-14T12:18:06.340
> 
> 标签：java, spring, hibernate, maven, spring-webflow

我必须升级我的项目才能开始使用 Hibernate4 和 Maven 进行构建。我有很多项目，这个过程让我因错误而死。我的项目是 Spring WebFlow、MySQL、CAS 和 Hibernate4，它使用 Hibernate3 没有任何问题。

我尽我所能制作了 pom.xml，但看起来我可能遇到了 Hibernate 版本控制问题。我收到以下错误：

***NoSuchMethodException：org.hibernate.cfg.Configuration.addAnnotatedClass***

我认为我的项目仍然可以尝试使用 Hibernate3 而不是 Hibernate4。如果您在下面查看我的 pom.xml，您会看到我正在请求 Hibernate4，但是如果您在打包后查看我的 WAR 文件，您可以看到 Hibernate4 和 Hibernate3 库。

这是我得到的错误：

```
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/spring/database-c3p0.xml]: Invocation of init method failed; nested exception is java.lang.ExceptionInInitializerError
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.findAutowireCandidates(DefaultListableBeanFactory.java:848)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:790)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:707)
    at org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor$AutowiredFieldElement.inject(AutowiredAnnotationBeanPostProcessor.java:478)
    ... 56 more
Caused by: java.lang.ExceptionInInitializerError
    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:259)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1514)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)
    ... 66 more
Caused by: java.lang.IllegalStateException: Expected method not found: java.lang.NoSuchMethodException: org.hibernate.cfg.Configuration.addAnnotatedClass(java.lang.Class)
    at org.springframework.util.ClassUtils.getMethod(ClassUtils.java:627)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.<clinit>(LocalSessionFactoryBuilder.java:68)
    ... 69 more
Sep 14, 2012 8:08:34 AM org.apache.catalina.core.StandardContext start 
```

这是我的 pox.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.uftwf.schoolvisit</groupId>
    <artifactId>SchoolVisit</artifactId>
    <name>School Visit</name>
    <packaging>war</packaging>
    <version>1.0.0-BUILD-SNAPSHOT</version>

    <properties>
        <java-version>1.5</java-version>
        <springframework-version>3.1.1.RELEASE</springframework-version>
        <springwebflow-version>2.3.1.BUILD-SNAPSHOT</springwebflow-version>
        <springsecurity-version>3.1.1.RELEASE</springsecurity-version>
        <org.slf4j-version>1.5.10</org.slf4j-version>
        <hibernate.version>4.1.1.Final</hibernate.version>
    </properties>

    <dependencies>
        <!-- Spring -->

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-orm</artifactId>
            <version>${springframework-version}</version>
            <!-- will come with all needed Spring dependencies such as spring-core 
                and spring-beans -->
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-aspects</artifactId>
            <version>${springframework-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>${springframework-version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.springframework.webflow</groupId>
            <artifactId>spring-faces</artifactId>
            <version>${springwebflow-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-core</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-config</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-web</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-ldap</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-cas</artifactId>
            <version>${springsecurity-version}</version>
        </dependency>

        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-cas-client</artifactId>
            <version>3.0.7.RELEASE</version>
        </dependency>

        <dependency>
            <groupId>javax.transaction</groupId>
            <artifactId>jta</artifactId>
            <version>1.1</version>
        </dependency>

        <dependency>
            <groupId>javax.mail</groupId>
            <artifactId>mail</artifactId>
            <version>1.4.5</version>
        </dependency>

        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib</artifactId>
            <version>2.2.2</version>
        </dependency>

        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.21</version>
        </dependency>

        <dependency>
            <groupId>c3p0</groupId>
            <artifactId>c3p0</artifactId>
            <version>0.9.1.2</version>
        </dependency>

        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpcore</artifactId>
            <version>4.2.1</version>
        </dependency>

        <dependency>
            <groupId>org.apache.httpcomponents</groupId>
            <artifactId>httpclient</artifactId>
            <version>4.2.1</version>
            <exclusions>
                <exclusion>
                    <artifactId>commons-logging</artifactId>
                    <groupId>commons-logging</groupId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjtools</artifactId>
            <version>1.6.2</version>
        </dependency>

        <dependency>
            <groupId>jstl</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>

        <!-- Logging -->

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-ext</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>

        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-api</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>jcl-over-slf4j</artifactId>
            <version>${org.slf4j-version}</version>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>1.2.16</version>

        </dependency>
        <!-- JSF-303 Dependency Injection -->
        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>1</version>
        </dependency>
        <!-- Servlet -->
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>servlet-api</artifactId>
            <version>2.5</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>jsp-api</artifactId>
            <version>2.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        <!-- Sun Mojarra JSF 2 runtime -->
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.7</version>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.1.7</version>
        </dependency>

        <!-- JSR 303 validation -->
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>1.0.0.GA</version>
        </dependency>

        <!-- ********************************************************************** 
            ** HIBERNATE DEPENDENCIES ** ********************************************************************** -->

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate.version}</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.0.2.GA</version>
        </dependency>

        <!-- Test -->
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.7</version>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <repositories>
        <!-- For testing against latest Spring snapshots -->
        <repository>
            <id>org.springframework.maven.snapshot</id>
            <name>Spring Maven Snapshot Repository</name>
            <url>http://maven.springframework.org/snapshot</url>
            <releases>
                <enabled>false</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
        <!-- For developing against latest Spring milestones -->
        <repository>
            <id>org.springframework.maven.milestone</id>
            <name>Spring Maven Milestone Repository</name>
            <url>http://maven.springframework.org/milestone</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For Hibernate Validator -->
        <repository>
            <id>org.jboss.repository.releases</id>
            <name>JBoss Maven Release Repository</name>
            <url>https://repository.jboss.org/nexus/content/repositories/releases</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For Sun Mojarra JSF 2 implementation -->
        <repository>
            <id>maven2-repository.dev.java.net</id>
            <name>Java.net Repository for Maven</name>
            <url>http://download.java.net/maven/2/</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>
        <!-- For PrimeFaces JSF component library -->

    </repositories>

    <build>
        <finalName>SchoolVisit</finalName>
    </build>
</project> 
```

这是来自 maven 的 WAR 中我的 lib 中的文件列表：

```
activation-1.1.jar
antlr-2.7.6.jar
antlr-2.7.7.jar
aopalliance-1.0.jar
asm-3.1.jar
asm-3.3.1.jar
asm-attrs-1.5.3.jar
aspectjrt-1.6.8.jar
aspectjtools-1.6.2.jar
aspectjweaver-1.6.8.jar
c3p0-0.9.1.2.jar
c3p0-0.9.2-pre4.jar
cal10n-api-0.7.2.jar
cas-client-core-3.1.10.jar
cas-client-core-3.1.12.jar
cas-client-core-3.2.1.jar
cglib-2.2.2.jar
cglib-2.2.jar
commons-beanutils-1.8.0.jar
commons-codec-1.4.jar
commons-codec-1.6.jar
commons-collections-3.1.jar
commons-dbcp.jar
commons-digester-1.8.1.jar
commons-email-1.0.jar
commons-fileupload-1.1.1.jar
commons-io-1.1.jar
commons-lang-2.5.jar
commons-logging-1.1.1.jar
commons-pool.jar
dom4j-1.6.1.jar
dumbster-1.6.jar
ehcache-1.2.3.jar
hibernate-annotations-3.5.0-Final.jar
hibernate-commons-annotations-3.2.0.Final.jar
hibernate-commons-annotations-4.0.1.Final.jar
hibernate-core-3.5.0-Final.jar
hibernate-core-4.1.1.Final.jar
hibernate-entitymanager-3.5.0-Final.jar
hibernate-entitymanager-4.1.1.Final.jar
hibernate-jpa-2.0-api-1.0.0.Final.jar
hibernate-jpa-2.0-api-1.0.1.Final.jar
hibernate-search-3.0.0.GA.jar
hibernate-validator-4.0.2.GA.jar
hsqldb-1.8.0.10.jar
httpclient-4.1.2.jar
httpclient-4.2.1.jar
httpclient-cache-4.1.2.jar
httpcore-4.1.2.jar
httpcore-4.2.1.jar
httpmime-4.1.2.jar
icu4j-2.6.1.jar
jackson-core-asl-1.5.3.jar
jackson-mapper-asl-1.5.3.jar
javassist-3.15.0-GA.jar
javassist-3.9.0.GA.jar
javax.inject-1.jar
javax.servlet-jstl-1.2.jar
jaxb-api-2.1.jar
jaxb-impl-2.1.3.jar
jaxen-1.1.1.jar
jboss-logging-3.1.0.GA.jar
jboss-transaction-api_1.1_spec-1.0.0.Final.jar
jcl-over-slf4j-1.5.10.jar
jdom-1.0.jar
joda-time-1.6.jar
joda-time-jsptags-1.0.2.jar
jsf-api-2.1.7.jar
jsf-impl-2.1.7.jar
jstl-1.2.jar
jstl-jstl-1.2.jar
jta-1.1.jar
list.txt
log4j-1.2.14.jar
log4j-1.2.15.jar
log4j-1.2.16.jar
lucene-core-2.3.2.jar
lucene-highlighter-2.0.0.jar
mail-1.4.5.jar
mail-1.4.jar
mailapi.jar
mail.jar
mchange-commons-java-0.2.2.jar
mysql-connector-java-5.0.5.jar
mysql-connector-java-5.1.21.jar
org.springframework.aop-3.1.1.RELEASE.jar
org.springframework.asm-3.1.1.RELEASE.jar
org.springframework.aspects-3.1.1.RELEASE.jar
org.springframework.beans-3.1.1.RELEASE.jar
org.springframework.binding-2.3.1.RELEASE.jar
org.springframework.context-3.1.1.RELEASE.jar
org.springframework.context.support-3.1.1.RELEASE.jar
org.springframework.core-3.1.1.RELEASE.jar
org.springframework.expression-3.1.1.RELEASE.jar
org.springframework.faces-2.3.1.RELEASE.jar
org.springframework.instrument-3.1.1.RELEASE.jar
org.springframework.instrument.tomcat-3.1.1.RELEASE.jar
org.springframework.jdbc-3.1.1.RELEASE.jar
org.springframework.jms-3.1.1.RELEASE.jar
org.springframework.js-2.3.1.RELEASE.jar
org.springframework.js.resources-2.3.1.RELEASE.jar
org.springframework.orm-3.1.1.RELEASE.jar
org.springframework.oxm-3.1.1.RELEASE.jar
org.springframework.test-3.1.1.RELEASE.jar
org.springframework.transaction-3.1.1.RELEASE.jar
org.springframework.web-3.1.1.RELEASE.jar
org.springframework.webflow-2.3.1.RELEASE.jar
org.springframework.web.portlet-3.1.1.RELEASE.jar
org.springframework.web.servlet-3.1.1.RELEASE.jar
org.springframework.web.struts-3.1.1.RELEASE.jar
persistence-api-1.0.jar
quartz-1.5.2.jar
slf4j-api-1.5.10.jar
slf4j-ext-1.5.10.jar
slf4j-log4j12-1.5.10.jar
smtp.jar
spring-aop-3.0.7.RELEASE.jar
spring-asm-3.1.1.RELEASE.jar
spring-aspects-3.1.1.RELEASE.jar
spring-beans-3.1.1.RELEASE.jar
spring-binding-2.3.1.BUILD-20120326.222602-13.jar
spring-context-3.1.1.RELEASE.jar
spring-context-support-3.1.1.RELEASE.jar
spring-core-3.1.1.RELEASE.jar
spring-expression-3.1.1.RELEASE.jar
spring-faces-2.3.1.BUILD-20120326.222626-13.jar
spring-jdbc-3.1.1.RELEASE.jar
spring-js-2.3.1.BUILD-20120326.222614-13.jar
spring-js-resources-2.3.1.BUILD-20120326.222607-13.jar
spring-ldap-1.3.1.RELEASE-all.jar
spring-ldap-core-1.3.1.RELEASE.jar
spring-orm-3.1.1.RELEASE.jar
spring-security-cas-3.1.0.RELEASE.jar
spring-security-cas-3.1.1.RELEASE.jar
spring-security-cas-client-3.0.7.RELEASE.jar
spring-security-config-3.1.0.RELEASE.jar
spring-security-config-3.1.1.RELEASE.jar
spring-security-core-3.1.0.RELEASE.jar
spring-security-core-3.1.1.RELEASE.jar
spring-security-crypto-3.1.0.RELEASE.jar
spring-security-ldap-3.1.0.RELEASE.jar
spring-security-ldap-3.1.1.RELEASE.jar
spring-security-openid-3.1.0.RELEASE.jar
spring-security-remoting-3.1.0.RELEASE.jar
spring-security-taglibs-3.1.0.RELEASE.jar
spring-security-web-3.1.0.RELEASE.jar
spring-security-web-3.1.1.RELEASE.jar
spring-tx-3.0.5.RELEASE.jar
spring-tx-3.1.1.RELEASE.jar
spring-web-3.1.1.RELEASE.jar
spring-webflow-2.3.1.BUILD-20120326.222621-13.jar
spring-webmvc-3.1.1.RELEASE.jar
stax-api-1.0-2.jar
tiles-api-2.1.3.jar
tiles-core-2.1.3.jar
tiles-jsp-2.1.3.jar
tiles-servlet-2.1.3.jar
urlrewritefilter-3.1.0.jar
validation-api-1.0.0.GA.jar
xalan-2.6.0.jar
xml-apis-1.0.b2.jar
xml-apis-1.3.02.jar
xmlParserAPIs-2.6.2.jar
xom-1.0.jar 
```

如您所见，我的 POM.XML 正在导入同一文件的多个版本，我认为这可能是问题，但我不知道。作为 Maven 和 Hibernate4 的新手，我不知道真正的问题。期待听到一些反馈...谢谢

这是我的 mvn 依赖项的输出：tree 但我仍然看不到 Hibernate3 的来源：

```
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building School Visit 1.0.0-BUILD-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-dependency-plugin:2.1:tree (default-cli) @ SchoolVisit ---
[INFO] org.uftwf.schoolvisit:SchoolVisit:war:1.0.0-BUILD-SNAPSHOT
[INFO] +- org.springframework:spring-orm:jar:3.1.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-beans:jar:3.1.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-core:jar:3.1.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-jdbc:jar:3.1.1.RELEASE:compile
[INFO] |  \- org.springframework:spring-tx:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-aspects:jar:3.1.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-context:jar:3.1.1.RELEASE:compile
[INFO] |  \- org.springframework:spring-context-support:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework:spring-webmvc:jar:3.1.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-asm:jar:3.1.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-expression:jar:3.1.1.RELEASE:compile
[INFO] |  \- org.springframework:spring-web:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework.webflow:spring-faces:jar:2.3.1.BUILD-SNAPSHOT:compile
[INFO] |  +- commons-logging:commons-logging:jar:1.1.1:compile
[INFO] |  +- org.springframework.webflow:spring-binding:jar:2.3.1.BUILD-SNAPSHOT:compile
[INFO] |  +- org.springframework.webflow:spring-js:jar:2.3.1.BUILD-SNAPSHOT:compile
[INFO] |  |  \- org.springframework.webflow:spring-js-resources:jar:2.3.1.BUILD-SNAPSHOT:compile
[INFO] |  \- org.springframework.webflow:spring-webflow:jar:2.3.1.BUILD-SNAPSHOT:compile
[INFO] +- org.springframework.security:spring-security-core:jar:3.1.1.RELEASE:compile
[INFO] |  +- org.springframework:spring-aop:jar:3.0.7.RELEASE:compile
[INFO] |  \- aopalliance:aopalliance:jar:1.0:compile
[INFO] +- org.springframework.security:spring-security-config:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework.security:spring-security-web:jar:3.1.1.RELEASE:compile
[INFO] +- org.springframework.security:spring-security-ldap:jar:3.1.1.RELEASE:compile
[INFO] |  \- org.springframework.ldap:spring-ldap-core:jar:1.3.1.RELEASE:compile
[INFO] |     \- commons-lang:commons-lang:jar:2.5:compile
[INFO] +- org.springframework.security:spring-security-cas:jar:3.1.1.RELEASE:compile
[INFO] |  \- org.jasig.cas.client:cas-client-core:jar:3.1.12:compile
[INFO] +- org.springframework.security:spring-security-cas-client:jar:3.0.7.RELEASE:compile
[INFO] |  \- org.jasig.cas:cas-client-core:jar:3.1.10:compile
[INFO] +- javax.transaction:jta:jar:1.1:compile
[INFO] +- javax.mail:mail:jar:1.4.5:compile
[INFO] |  \- javax.activation:activation:jar:1.1:compile
[INFO] +- cglib:cglib:jar:2.2.2:compile
[INFO] |  \- asm:asm:jar:3.3.1:compile
[INFO] +- mysql:mysql-connector-java:jar:5.1.21:compile
[INFO] +- c3p0:c3p0:jar:0.9.1.2:compile
[INFO] +- org.apache.httpcomponents:httpcore:jar:4.2.1:compile
[INFO] +- org.apache.httpcomponents:httpclient:jar:4.2.1:compile
[INFO] |  \- commons-codec:commons-codec:jar:1.6:compile
[INFO] +- org.aspectj:aspectjtools:jar:1.6.2:compile
[INFO] +- jstl:jstl:jar:1.2:compile
[INFO] +- org.slf4j:slf4j-ext:jar:1.5.10:compile
[INFO] |  \- ch.qos.cal10n:cal10n-api:jar:0.7.2:compile
[INFO] +- org.slf4j:slf4j-log4j12:jar:1.5.10:compile
[INFO] +- org.slf4j:slf4j-api:jar:1.5.10:compile
[INFO] +- org.slf4j:jcl-over-slf4j:jar:1.5.10:compile
[INFO] +- log4j:log4j:jar:1.2.16:compile
[INFO] +- javax.inject:javax.inject:jar:1:compile
[INFO] +- javax.servlet:servlet-api:jar:2.5:provided
[INFO] +- javax.servlet.jsp:jsp-api:jar:2.1:provided
[INFO] +- javax.servlet:jstl:jar:1.2:compile
[INFO] +- com.sun.faces:jsf-api:jar:2.1.7:compile
[INFO] +- com.sun.faces:jsf-impl:jar:2.1.7:compile
[INFO] +- javax.validation:validation-api:jar:1.0.0.GA:compile
[INFO] +- org.hibernate:hibernate-entitymanager:jar:4.1.1.Final:compile
[INFO] |  +- org.jboss.logging:jboss-logging:jar:3.1.0.GA:compile
[INFO] |  +- org.hibernate:hibernate-core:jar:4.1.1.Final:compile
[INFO] |  |  \- antlr:antlr:jar:2.7.7:compile
[INFO] |  +- org.jboss.spec.javax.transaction:jboss-transaction-api_1.1_spec:jar:1.0.0.Final:compile
[INFO] |  +- dom4j:dom4j:jar:1.6.1:compile
[INFO] |  |  \- xml-apis:xml-apis:jar:1.0.b2:compile
[INFO] |  +- org.hibernate.javax.persistence:hibernate-jpa-2.0-api:jar:1.0.1.Final:compile
[INFO] |  +- org.javassist:javassist:jar:3.15.0-GA:compile
[INFO] |  \- org.hibernate.common:hibernate-commons-annotations:jar:4.0.1.Final:compile
[INFO] +- org.hibernate:hibernate-validator:jar:4.0.2.GA:compile
[INFO] |  +- javax.xml.bind:jaxb-api:jar:2.1:compile
[INFO] |  |  \- javax.xml.stream:stax-api:jar:1.0-2:compile
[INFO] |  \- com.sun.xml.bind:jaxb-impl:jar:2.1.3:compile
[INFO] \- junit:junit:jar:4.7:test
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 6.291s
[INFO] Finished at: Fri Sep 14 09:06:33 EDT 2012
[INFO] Final Memory: 11M/162M
[INFO] ------------------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T14:49:12.287

我修好了它。我创建了一个新的 maven webapp 并复制到 pom.xml 和源代码中，一切都很棒......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:42:20.910

解决此类问题的典型方法是运行`mvn dependency:tree -Dverbose`并分析其输出，以找出错误版本的依赖项来自何处，然后通过应用必要的排除来修复它们。

但是，在您的情况下，输出`mvn dependency:tree`不包含任何错误。因此，我认为您的`target`文件夹中有旧版本的依赖项，因此您需要运行`mvn clean`以删除它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T13:03:45.627

正如其他人所指出的，运行“mvn dependency:tree”以查看从何处获取 hibernate 3 依赖项。然后您可以在 pom.xml 中排除它：

```
<dependency>
    <exclusions>
        <exclusion>
           <groupId>org.hibernate</groupId>           
        </exclusion>
    </exclusions>
</dependency> 
```

从 hibernate 3 到 4 还需要从 hibernate3 包中的 AnnotationSessionFactoryBean 更改为 hibernate4 包中的 LocalSessionFactoryBean，并使用 hibernate4 包中的事务管理器。

曾经在 hibernate3 包中的两个单独的 bean（本地和注释）现在变成了 hibernate4 包中的一个 bean，如果你升级了你就不能使用 hibernate3 包。

[http://blog.springsource.org/2012/04/06/migrating-to-spring-3-1-and-hibernate-4-1/](http://blog.springsource.org/2012/04/06/migrating-to-spring-3-1-and-hibernate-4-1/)

# c# - 绘制控件两次

> ID：12424427
> 
> 赞同：0
> 
> 时间：2012-09-14T12:18:20.967
> 
> 标签：c#, wpf, repaint

我正在开发一个非常吸引眼球的程序，我需要为控件添加反射和 3D 深度。

在这两种情况下，我都需要多次绘制控件，但要进行更改：

对于反射，我必须在底部再次重新绘制控件+翻转它。

至于3D深度，只是后面+到侧面的很多副本。

问题是如何获取控件的图像以对其进行修改并将其绘制在其下方/后面？您对此类操作有任何警告和警告/有用的提示吗？（我以前从未尝试过类似的东西）。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:45:14.083

在 WPF 中，您可以使用 a`VisualBrush`作为另一个元素（例如 a `Rectangle`）的背景/填充。它`VisualBrush`有一个`Visual`属性，可以绑定到另一个控件以模仿其内容。在此控件上使用变换和 Alpha 蒙版有助于应用反射样式效果。例如：

```
 <StackPanel Width="200">  
    <TextBox x:Name="tb">Hello world</TextBox>
    <Rectangle Height="40" HorizontalAlignment="Stretch">
      <Rectangle.Fill>
        <VisualBrush Visual="{Binding ElementName=tb}"  />
      </Rectangle.Fill>
      <Rectangle.RenderTransform>
        <ScaleTransform CenterY="20" ScaleY="-1" />
      </Rectangle.RenderTransform>
      <Rectangle.OpacityMask>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
          <GradientStop Color="#00000000" Offset="0" />
          <GradientStop Color="#FFFFFFFF" Offset="1" />
        </LinearGradientBrush>
      </Rectangle.OpacityMask>
    </Rectangle>
  </StackPanel> 
```

# android - 从 SD 卡播放视频文件

> ID：12424429
> 
> 赞同：1
> 
> 时间：2012-09-14T12:18:25.883
> 
> 标签：android

我正在尝试从 SD 卡播放视频，我已经从 Eclipse 中的 DDMS 视图将视频推送到 mnt/sdcard 文件夹中。但是模拟器屏幕显示空白，没有任何错误。请帮忙。

```
public class Video extends Activity {
private MediaController mc;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    videoPlayer("mnt/sdcard","bikekid",true);
}

public void videoPlayer(String path, String fileName, boolean autoplay){
    //get current window information, and set format, set it up differently, if you need some special effects
    getWindow().setFormat(PixelFormat.TRANSLUCENT);
    //the VideoView will hold the video
    VideoView videoHolder = new VideoView(this);
    //MediaController is the ui control howering above the video (just like in the default youtube player).
    videoHolder.setMediaController(new MediaController(this));
    //assing a video file to the video holder
    videoHolder.setVideoURI(Uri.parse(path+"/"+fileName));
    //get focus, before playing the video.
    videoHolder.requestFocus();
    if(autoplay){
        videoHolder.start();
    }

 }

}/// end class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:26:57.687

利用

```
.getAbsolutePath() 
```

代替`"mnt/sdcard"`

编辑：

用这个

```
File file = new File(Environment.getExternalStorageDirectory(),"bikekid");
Uri mUri = Uri.fromFile(fie);
videoHolder.setVideoURI(mUri); 
```

# ruby - 完全理解 Ruby 类变量

> ID：12424430
> 
> 赞同：3
> 
> 时间：2012-09-14T12:18:39.643
> 
> 标签：ruby

在这个代码块中，

```
@@y = 1
class MyClass
 @@y = 2
end
p @@y # => 2 
```

天真地，它似乎`@@y`在顶级范围内，并且与' 范围内`@@y`的不一样。`MyClass`为什么会`@@y`受到类`MyClass`定义的影响？（为什么是结果`2`？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T12:26:55.600

让我们看看这个例子。这里`@@x`in确实与in`Bar`分开。`@@x``Foo`

```
class Foo
  @@x = 1
end

class Bar
  @@x = 2
end

Foo.class_variable_get(:@@x) # => 1
Bar.class_variable_get(:@@x) # => 2 
```

但是，如果`Bar`是 的孩子，会发生什么`Foo`？

```
class Foo
  @@x = 1
end

class Bar < Foo
  @@x = 2
end

Foo.class_variable_get(:@@x) # => 2
Bar.class_variable_get(:@@x) # => 2 
```

在这种情况下，`@@x`在两种情况下都是相同的，并且它是在 中声明的那个`Foo`。

现在，回到你的例子：

```
@@y = 1
class MyClass
  @@y = 2
end
p @@y 
```

第一行在根范围内声明类变量。`main`Root 是一个类型为 的特殊对象`Object`。所以，本质上，你是在 class 上定义一个类变量`Object`。由于一切都是一个`Object`，这就是定义的`MyClass`也继承`@@y`并能够改变它的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:31:38.993

当你这样做

```
@@y = 1 
```

你在对象上定义它。由于 MyClass 是 Object 的子类，因此它可以访问它的类变量。

```
@@y = 1
class MyClass
  @@y = 2
end
p @@y
puts MyClass.superclass #=> Object
puts Object.class_variables #=> @@y 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-14T12:26:14.333

全局变量是这样的：

```
$y = 1 
```

和类变量是这样的：

```
@@y = 1 
```

所以实际上你使用类变量

这是一个链接：[vars](http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Variables_and_Constants#Global_Variables)

# javascript - 为什么 Chrome 不运行这个 Javascript？

> ID：12424438
> 
> 赞同：2
> 
> 时间：2012-09-14T12:19:25.430
> 
> 标签：javascript, google-chrome

该脚本在 FF 和 IE 中完美运行，但在 Chrome 中却不行。有人可以帮我找出问题所在吗？

if statmenst 似乎没有在应该运行的时候运行，它们在应该运行时什么也不做。

```
var top = 285;
var bottom = 650;

var pageheight, maxscroll;

window.onload = function(){

    pageheight = document.body.offsetHeight;

    maxscroll = pageheight - (bottom+40);

}

    window.onscroll = function(){

        var element = document.getElementById("guide-menu");

        if(window.pageYOffset < top){

            element.style.position = "absolute";
            element.style.top = "300px";

        }

        if(window.pageYOffset > top){

            element.style.top = "10px";
            element.style.position = "fixed";
            element.style.marginTop = "0px";

        }

        if(window.pageYOffset > maxscroll){

            element.style.position = "absolute";

            element.style.marginTop = (pageheight - bottom - 40) + "px";

        }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:27:51.393

“顶部”在 chrome 中具有不同的含义。只需尝试重命名顶级变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:43:05.770

“top”变量返回最顶层的浏览器窗口。Chrome 是唯一不支持覆盖此变量的主流浏览器。

将您的变量重命名为“myTop”之类的东西非常有效。

这段代码运行良好。

```
 var myTop = 285;
    var bottom = 650;

    var pageheight, maxscroll;

    window.onload = function(){
        pageheight    = document.body.offsetHeight;
        maxscroll     = pageheight - (bottom+40);

        window.onscroll = function()
        {
            var element = document.getElementById("guide-menu");
            if(window.pageYOffset < myTop)
            {
                element.style.position = "absolute";
                element.style.top = "300px";
            }

            if(window.pageYOffset > myTop)
            {
                element.style.top = "10px";
                element.style.position = "fixed";
                element.style.marginTop = "0px";
            }

            if(window.pageYOffset > maxscroll)
            {
                element.style.position = "absolute";
                element.style.marginTop = (pageheight - bottom - 40) + "px";
            }
        }
    } 
```

顺便说一句，检查您是否为 IF 语句设置了正确的条件。如果你想要一个随网页滚动的菜单，那么你必须先交换两个 if 条件。

# c++ - 如何为 Windows 使用 Boost 进程间消息队列？

> ID：12424440
> 
> 赞同：1
> 
> 时间：2012-09-14T12:19:26.070
> 
> 标签：c++, boost, boost-interprocess

我正在使用 Boost Interprocess 实现进程间通信。作为测试，我从[boost 文档](http://www.boost.org/doc/libs/1_51_0/doc/html/interprocess/synchronization_mechanisms.html#interprocess.synchronization_mechanisms.message_queue)中获取了示例。

第一个进程（创建消息队列）启动另一个进程（应该从队列中接收消息）使用`CreateProcess(NULL, (LPSTR)commandStream.str().c_str(), NULL, NULL, FALSE, NULL, NULL, NULL, &si, &pi)`

第一个进程使用创建队列`message_queue mq(create_only, "message_queue", 100, sizeof(int))`。

不幸的是，`message_queue mq(open_only, "message_queue")`抛出一个`interprocess_exception`. 例外包含描述*Das System kann die angegebene Datei nicht finden。*（系统找不到请求的文件）。

当队列的创建和打开都在一个进程中完成时，不会引发异常并且通信按照文档中的描述进行。

有人知道什么可能导致异常以及我如何解决它？

编辑：我正在使用 Boost 1.45

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T13:19:42.703

该异常是由 Boost Interpocessing 库中的问题引起的，如[该票证](https://svn.boost.org/trac/boost/ticket/5392)中所述。该错误已重新打开，我并不完全清楚 Boost 代码是如何更改的，以及如何为 Boost 1.45 应用变通方法。但是，升级到 Boost 1.51 后，我现在可以按预期使用消息队列了。

# c - 在C中点击三下后输入数据

> ID：12424454
> 
> 赞同：0
> 
> 时间：2012-09-14T12:19:57.027
> 
> 标签：c, count, click, show

我在按钮上有'.,/'，我需要打印：

'。' 如果单击一次
',' 如果单击两次
'/' 如果单击三次

如何在**C**中管理这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T07:14:12.503

由于您可能仍然有一个用于取消按钮弹跳的计时器，因此您可以使用它来检测按键之间的间隙。

所以你计算按键，如果间隔太长，你重置计数器。

# android - 如何去除口音？

> ID：12424456
> 
> 赞同：2
> 
> 时间：2012-09-14T12:20:08.360
> 
> 标签：android, string, diacritics

我有一个带有数据的 ISO8859-1 (Latin1) 文件的 android 应用程序。本质上，我想将其字符转换为无口音的葡萄牙语单词。

是的，我为此搜索了很多，并尝试了

```
 Normalizer.normalize(input, Normalizer.Form.NFD); 
```

把戏，是的，我也试过

```
 String.replaceAll("[áâã]", "a").replaceAll(....).... 
```

但字符串仍然是重音。我还尝试弄乱项目编码，但不确定在哪里更改（如果这是一个解决方案）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-21T04:10:56.387

好的，我找到了答案。在读取 InputStreamReader 时刚刚添加了“Latin1”（似乎，尽管进行了配置，但它假设为 UTF-8 或其他内容）。

所以这就是我现在读取文件的方式：

```
 br = new BufferedReader(new InputStreamReader(new FileInputStream(Environment.BR_DB), "Latin1")); 
```

我需要添加一个 UnsupportedEncodingException。

Thanks for the previous answers,

```
L. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:25:28.683

就像奥瑟伦说的...

不是

```
String.replaceAll("[áâã]", "a").replaceAll(....) 
```

但

```
value = String.replaceAll("[áâã]", "a").replaceAll(....) 
```

[编辑]

不要使用字符串类作为要替换的对象...我刚刚测试了这段代码，它执行得很好...

```
String weirdAs = "ábâcdeã";

String newString = weirdAs.replaceAll("[áâã]", "a");

Toast.makeText(_context,
            "New String: " + newString + " Weird As: " + weirdAs,
            Toast.LENGTH_LONG).show(); 
```

[编辑 2]

只是为了好玩......这是一个logcat输出......

```
09-14 09:16:23.502: I/Test(12022): Original String (Weird As): ábâcdeã
09-14 09:16:23.502: I/Test(12022): New String: abacdea 
```

# java - Struts2 JQuery 网格 - 空网格消息

> ID：12424462
> 
> 赞同：1
> 
> 时间：2012-09-14T12:20:34.837
> 
> 标签：java, jquery, struts2, grid

我正在使用 Struts2 JQuery 网格，它工作正常。

下面是一个网格示例：

```
<s:url var="remoteurl" action="jsontable"/>
    <sjg:grid
        id="gridtable"
        caption="Customer Examples"
        dataType="json"
        href="%{remoteurl}"
        pager="true"
        gridModel="gridModel"
        rowList="10,15,20"
        rowNum="15"
        rownumbers="true"
    >
        <sjg:gridColumn name="id" index="id" title="ID" formatter="integer" sortable="false"/>
        <sjg:gridColumn name="name" index="name" title="Name" sortable="true"/>
        <sjg:gridColumn name="country" index="country" title="Country" sortable="false"/>
        <sjg:gridColumn name="city" index="city" title="City" sortable="false"/>
        <sjg:gridColumn name="creditLimit" index="creditLimit" title="Credit Limit" formatter="currency" sortable="false"/>
    </sjg:grid> 
```

我想在网格为空时显示特定消息，而不是显示空网格。我知道这可以通过将整个网格封装在一个`s:if`语句中来完成，但是如果网格有内容，我想避免两次检索信息（一次用于 if 语句，然后第二次用于网格本身）。

是否可以选择执行以下“isEmpty”消息？

```
<sjg:grid
        id="gridtable"
        ifEmpty="No data to display!" 
```

或者其他类似的机制，我可以显示一个按钮来创建一个新条目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:51:23.383

您可以使用事件*onCompleteTopics*和一些像这样的脚本：

```
<script type="text/javascript">
$.subscribe('completegrid', function(event, data) {
        var records = $('#gridtable').getGridParam('records');
            if(records < 1) {
                $('#gridcontainer').html('<span>none</span>');
            }
});
</script>

<sjg:grid
        ...
        onCompleteTopics ="completegrid"
        ...
> 
```

请参阅[http://code.google.com/p/struts2-jquery/wiki/GridTag#Topics上的参考资料](http://code.google.com/p/struts2-jquery/wiki/GridTag#Topics)

# jquery - 在jQuery中触发打印屏幕键盘功能并将转换后的图像发送到服务器

> ID：12424468
> 
> 赞同：0
> 
> 时间：2012-09-14T12:21:06.027
> 
> 标签：jquery, printscreen

如何通过一些 jQuery 函数触发 PrtScn 即 PrintScreen 键盘事件，然后将捕获的图像保存到服务器？

```
function ErrorLog(errorCode, errorMessage) {

    // Here i want the screenshot of the user's screen where the error have occurred ...
    var _screenShot = "";

    SendErrorToServer(errorCode, errorMessage, _screenShot);
} 
```

你能指导我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:27:23.690

也许可以使用 HTML5 来完成`<canvas>`。

[http://html2canvas.hertzen.com/](http://html2canvas.hertzen.com/)

演示：[http ://html2canvas.hertzen.com/screenshots.html](http://html2canvas.hertzen.com/screenshots.html)

# c++ - 全球运营商 new, private c-tor and friend

> ID：12424469
> 
> 赞同：3
> 
> 时间：2012-09-14T12:21:09.490
> 
> 标签：c++

在以下代码中：

```
class A
{
    A() {}
    friend class B;
};

class B
{
public:
    void foo() {A* p=new A;};
};

int main()
{
    B b;
    b.foo();

    A* p = new A;

    return 0;
} 
```

该函数`foo()`通过编译，但该行`A* p = new A;`没有。怎么会这样？`new`是全局运算符，因此它不能调用私有构造函数，那么为什么编译器也不抱怨`foo()`呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:23:55.567

operator new 函数不调用构造函数。它只是分配所需的存储空间。

构造函数随后由编译器魔术调用，并被认为分别由`foo`和`main`完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:26:12.477

新表达式包括对`operator new`分配内存的调用（不调用构造函数，不需要访问）和对构造函数的调用。对构造函数的调用是在表达式的上下文中完成的，在这种情况下 `B::foo`，它可以访问构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:27:04.467

new-expression 做了两件事：

*   调用一些重载`operator new`来获取一些内存；
*   在该内存中构造一个对象。

构造发生在 new-expression 的上下文中，而不是调用`operator new`. 因此，构造函数必须在该上下文中是可访问的；所以在你的例子中，它可以在`B::foo`但不能在`main`.

# windows - 为什么 emacs 中的 vc-git 和 magit 忽略了我的 git 配置设置？

> ID：12424470
> 
> 赞同：3
> 
> 时间：2012-09-14T12:21:09.793
> 
> 标签：windows, git, emacs, magit

我正在使用 magit 运行 emacs 24.1.1 的官方 Windows 二进制文件。当我提交文件时，日志中显示的用户名和电子邮件会从我的帐户和机器名称中提取，而不是使用在全局 git config 或此 repro 的本地设置中设置的值。

从 git bash 和 dos，我可以向 git 询问 user.email 和 user.name 并获取本地 repro 设置。

magit 和 vc-git 的 diff 模式似乎也忽略了我的 autocrlf 设置，所以这可能是一个 emacs 范围的问题，而不是特定于 magit。

`C:\Program Files (x86)\Git\cmd`是在 emac 的`exec-path`.

我怎样才能指示 magit 找到正确的设置，或者手动告诉它设置是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T13:34:13.557

从 Emacs 的角度和 shell 的角度来看，您可能想要控制您的 $HOME 是否相同。很可能它们并不相同，因此在 Emacs 中找不到 $HOME/.gitconfig。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T08:20:10.057

您可以添加一个 HOME 环境变量并指定与 .gitconfig 目录相同的目录。

# javascript - 通过javascript/html访问twitter分享iframe

> ID：12424471
> 
> 赞同：0
> 
> 时间：2012-09-14T12:21:13.777
> 
> 标签：javascript, html, css, twitter

在某些页面上，Twitter 分享按钮未显示其全宽。我已经追踪了问题，显示它的 iframe 仅设置为 24px 宽度，但是我需要将其设置为正确的宽度。问题是..我无法直接访问 iframe，因为这是插入它的代码：

```
<div style="margin:4px 0 0 5px; float:left; position: relative;"><a href="https://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a></div>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div><!-- END #socialNetworking -->
<script> 
```

有人知道我如何编辑 iframe 吗？生成的 HTML 不显示 iframe，但是在 chrome web 开发工具上挖掘 html 检查器，我可以在那里看到它：

```
<iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.1347008535.html#_=1347624904492&amp;count=none&amp;id=twitter-widget-0&amp;lang=en&amp;original_referer=http%3A%2F%2Fwww.dgfdg.co.uk%2F&amp;size=m&amp;text=Web%20Design%20Kendal%20%7C%20Website%20Design%20Cumbria%20%7C%20Graphic%20Design%20%7C%20Marketing%20%7C%20Advertising%20%7C%20Designworks%20%7C&amp;url=http%3A%2F%2Fwww.fdfdg.co.uk%2F" class="twitter-share-button twitter-count-none" style="width: 24px; height: 20px; " title="Twitter Tweet Button" data-twttr-rendered="true"></iframe> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:35:10.007

查看[https://dev.twitter.com/docs/tweet-button](https://dev.twitter.com/docs/tweet-button)，我认为这是您正在寻找的“大小”属性。不过，它只接受分类值。我认为您不能将其设置为任意大小。

# php - 按日期 php 过滤本月和最后 x 天和本周

> ID：12424473
> 
> 赞同：1
> 
> 时间：2012-09-14T12:21:26.387
> 
> 标签：php, date, time, filter

我有一个日期以字符串形式返回 2012-03-19 05:00:32，它不是来自数据库

我可以使用下面搜索过去 30 天

```
$date = '2012-03-19 05:00:32';
if (strtotime($date) >= strtotime('-7 days')) {
// do something
} 
```

问题是如果今天是 3 月 19 日，我要从 11 日到 18 日搜索过去 7 天，这似乎是通过计算 24 小时 * 7 来搜索过去 7 天，我的搜索需要从 00:00 开始:01 每天。

我的计划是将日期分解为年、月和日，然后检查年 = 12，然后检查月 = 3，然后检查日期是否在 11 和 18 之间。

我只是想知道是否有更有效的方法来做到这一点，或者我是否走在正确的轨道上。

我在搜索本月的所有信息时也遇到了同样的问题，并且还想从星期一开始搜索本周的所有信息。

所以这只是问我的方法是否合理，或者是否有更有效的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:25:31.190

我建议使用[DateTime](http://www.php.net/manual/en/class.datetime.php)类...

```
<?php
$d1=new DateTime("2012-07-08 11:14:15.638276");
$d2=new DateTime("2012-07-08 11:14:15.889342");
$diff=$d2->diff($d1);
print_r( $diff ) ;

/* returns:

DateInterval Object
(
    [y] => 0
    [m] => 0
    [d] => 0
    [h] => 0
    [i] => 0
    [s] => 0
    [invert] => 0
    [days] => 0
)

*/
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:33:51.457

```
$mytime = new DateTime('2012-03-19 05:00:32');
$mydate = new DateTime($mytime->format('Y-m-d')); //keep date only, exclude the time component
$now=new DateTime; //includes hours, minutes, seconds
$today=new DateTime($now->format('Y-m-d')); //time set to 0:00

$interval = $mydate->diff($today);
if($interval->format('d') <=7) { //assuming that $mydate isn't in the past
 //do something
} 
```

# objective-c - 编码 - 解码，重音

> ID：12424479
> 
> 赞同：1
> 
> 时间：2012-09-14T12:21:38.393
> 
> 标签：objective-c

我正在使用 php 和 JSON 从我的数据库中提取数据：

```
$output[]=array("userJoomla" => "2749", "userID" => $e['mobileUserID'], "userName" =>  utf8_encode($e['mobileUserName'])); 
```

我使用 utf8_encode 因为书面口音和西班牙字母ñ

在我的 Objective-C 代码中：

```
 NSString *serverOutput = [[NSString alloc] initWithData:dataURL encoding: NSUTF8StringEncoding]; 
```

但是，当我打印它时，我得到：

“Roc\u00edo”而不是“Rocío”

我怎样才能做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:53:14.173

您是否尝试过不编码用户名值？如果您的数据库配置为使用 utf8，则该值应该已经像这样编码。所以如果你用 utf8 编码一个 utf8 字符串，结果应该看起来很糟糕

# c# - C#实时替换桌面背景

> ID：12424498
> 
> 赞同：-2
> 
> 时间：2012-09-14T12:23:00.067
> 
> 标签：c#, windows, winforms, desktop

我需要实时更改windows 7中的桌面图像，或者用控件替换背景，以便在C# WinForms中构建一些桌面效果，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:12:17.697

[Windows 7 DreamScene 激活器](http://www.google.it/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCUQFjAA&url=http%3A%2F%2Fwww.thewindowsclub.com%2Fwindows-7-dreamscene-activator-released&ei=myxTULrVDMaA4gTCzoHQBg&usg=AFQjCNEJ2CmFIV1U9jp5P1RrAiM034LHYA&sig2=gGDtyirCmCXRRgCYPE_jtQ)允许使用视频作为背景（虽然它非常消耗 CPU，但请小心处理）。

我在我的书呆子装备上使用它，它非常简单，唯一需要注意的是视频的分辨率必须相当低，否则它们*会*卡顿。

# php - 用 smarty 循环播放？

> ID：12424504
> 
> 赞同：0
> 
> 时间：2012-09-14T12:23:20.353
> 
> 标签：php, loops, twitter-bootstrap, smarty

我正在使用 smarty 和 bootstrap，

我正在建立一个图片库，所以我的标记最终如下所示。

我知道我可以循环遍历我的类别，`{foreach $categories as $category}{/foreach}` 但是正如您从下面发布的标记中看到的那样，我需要将四个分组包装起来。那是我不知道该怎么做的部分。

另外，请注意，可能并不总是四的倍数，例如可能有 15 个类别。

我该怎么做？

```
<div class="row-fluid">
    <ul class="thumbnails">
        <li class="span3">
            <div class="thumbnail">
                <a href="#" class="thumbnail"><img src="http://placehold.it/260x180" alt=""></a>

                <div class="caption">
                    <h3>Thumbnail label</h3>

                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida
                        at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>

                    <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
                </div>
            </div>
        </li>

        <li class="span3">
            <div class="thumbnail">
                <a href="#" class="thumbnail"><img src="http://placehold.it/260x180" alt=""></a>

                <div class="caption">
                    <h3>Thumbnail label</h3>

                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida
                        at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>

                    <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
                </div>
            </div>
        </li>
        <li class="span3">
            <div class="thumbnail">
                <a href="#" class="thumbnail"><img src="http://placehold.it/260x180" alt=""></a>

                <div class="caption">
                    <h3>Thumbnail label</h3>

                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida
                        at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>

                    <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
                </div>
            </div>
        </li>
        <li class="span3">
            <div class="thumbnail">
                <a href="#" class="thumbnail"><img src="http://placehold.it/260x180" alt=""></a>

                <div class="caption">
                    <h3>Thumbnail label</h3>

                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida
                        at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>

                    <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
                </div>
            </div>
        </li>
    </ul>
</div>

<div class="row-fluid">
    <ul class="thumbnails">
        <li class="span3">
            <div class="thumbnail">
                <a href="#" class="thumbnail"><img src="http://placehold.it/260x180" alt=""></a>

                <div class="caption">
                    <h3>Thumbnail label</h3>

                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida
                        at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>

                    <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
                </div>
            </div>
        </li>
        <li class="span3">
            <div class="thumbnail">
                <a href="#" class="thumbnail"><img src="http://placehold.it/260x180" alt=""></a>

                <div class="caption">
                    <h3>Thumbnail label</h3>

                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida
                        at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>

                    <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
                </div>
            </div>
        </li>
        <li class="span3">
            <div class="thumbnail">
                <a href="#" class="thumbnail"><img src="http://placehold.it/260x180" alt=""></a>

                <div class="caption">
                    <h3>Thumbnail label</h3>

                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida
                        at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>

                    <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
                </div>
            </div>
        </li>

        <li class="span3">
            <div class="thumbnail">
                <a href="#" class="thumbnail"><img src="http://placehold.it/260x180" alt=""></a>

                <div class="caption">
                    <h3>Thumbnail label</h3>

                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida
                        at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>

                    <p><a href="#" class="btn btn-primary">Action</a> <a href="#" class="btn">Action</a></p>
                </div>
            </div>
        </li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:28:02.037

您可以使用`name`for`foreach`循环，然后检查迭代次数，如下所示：

```
{foreach from=$array item=var name=myloop}

    {if $smarty.foreach.myloop.iteration % 4 == 1}
        {* this is the first in a group of four *}
    {elseif $smarty.foreach.myloop.iteration % 4 == 0}
        {* this is the last in a group of four *}
    {else}
        {* this is the second or the third *}
    {/if}

{/foreach} 
```

阅读[文档以`foreach`](http://www.smarty.net/docsv2/en/language.function.foreach)获取更多详细信息。具体看`iteration`和`index`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T17:27:52.053

看来您正在使用**Smarty v3**，您可以直接`@iteration`在变量上使用：

```
{foreach $array as $var}
    {if $var@iteration %4 == 1}
        <div class="row">
    {/if}
        <div class="span3"><!-- ... --></div>
    {if $var@iteration %4 == 0}
        </div><!-- /div.row -->
    {/if}
{/foreach} 
```

[聪明的医生](http://www.smarty.net/docs/en/language.function.foreach.tpl#foreach.property.iteration)

* * *

另一件事是，`.thumbnails`它旨在用作 a `.row`，但它允许的不仅仅是经典的 12 个单元格。

所以我不知道它是否处理`.row-fluid`得很好。这就是为什么您的解决方法需要几个*硬*行。

最好的做法是自己定义跨度的宽度，或者等待`.thumbnails-fluid`这样的实现：[Demo (jsfiddle)](http://jsfiddle.net/Sherbrow/KpaZu/)

```
.thumbnails.thumbnails-fluid { margin-left: 0; }
.thumbnails.thumbnails-fluid > [class*="span"] {
  display: block;
  float: left;
  width: 100%;
  min-height: 1px;
  margin-left: 2.127659574468085%;
  *margin-left: 2.074468085106383%;
  -webkit-box-sizing: border-box;
     -moz-box-sizing: border-box;
          box-sizing: border-box;
}
.thumbnails.thumbnails-fluid .span12 { width: 100%; *width: 99.94680851063829%; }
.thumbnails.thumbnails-fluid .span11 { width: 91.48936170212765%; *width: 91.43617021276594%; }
.thumbnails.thumbnails-fluid .span10 { width: 82.97872340425532%; *width: 82.92553191489361%; }
.thumbnails.thumbnails-fluid .span9 { width: 74.46808510638297%; *width: 74.41489361702126%; }
.thumbnails.thumbnails-fluid .span8 { width: 65.95744680851064%; *width: 65.90425531914893%; }
.thumbnails.thumbnails-fluid .span7 { width: 57.44680851063829%; *width: 57.39361702127659%; }
.thumbnails.thumbnails-fluid .span6 { width: 48.93617021276595%; *width: 48.88297872340425%; }
.thumbnails.thumbnails-fluid .span5 { width: 40.42553191489362%; *width: 40.37234042553192%; }
.thumbnails.thumbnails-fluid .span4 { width: 31.914893617021278%; *width: 31.861702127659576%; }
.thumbnails.thumbnails-fluid .span3 { width: 23.404255319148934%; *width: 23.351063829787233%; }
.thumbnails.thumbnails-fluid .span2 { width: 14.893617021276595%; *width: 14.840425531914894%; }
.thumbnails.thumbnails-fluid .span1 { width: 6.382978723404255%; *width: 6.329787234042553%; } 
```

# java - Xstream如何在编组时避免具有特定值的字段

> ID：12424505
> 
> 赞同：5
> 
> 时间：2012-09-14T12:23:19.327
> 
> 标签：java, xml, xstream

我想创建以下格式的 xml

```
<parm-list>
<param>
<NAME>somename</NAME>
<VALUE>somevalue</VALUE>
</param>
<param>
<NAME>somename</NAME>
<VALUE>somevalue</VALUE>
</param>
<param>
<NAME>somename</NAME>
<VALUE>somevalue</VALUE>
</param>
<param>
<NAME>somename</NAME>
<VALUE>somevalue</VALUE>
</param>
</param-list> 
```

如果我不想要一个`<PARAM>`特定的字段， 我该怎么办`<NAME>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:34:44.883

虽然我真的不认为 Xstream 真的适合这项任务，但它似乎是可能的。

您可以实现自己的转换器，类似于[其中之一](http://xstream.codehaus.org/converters.html)。如果您查看[Converter](http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/converters/Converter.html)界面，您会发现您可以通过不向`HierarchicalStreamWriter`.

```
public class ParamConverter implements Converter{

    boolean canConvert(Class type){
        return Param.class.equals(type);
    }

    public void marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context){
        Param param = (Param)source;
        if (NAME_TO_SKIP.equals(param.getName()){
            return;
        }
        // delegate to ReflectionConverter or something else appropriate.
    }   
} 
```

要注册转换器，只需调用`xStram.registerConverter(new ParamConverter());`.

有关更多信息，请阅读有关转换器的[本教程。](http://xstream.codehaus.org/converter-tutorial.html)

# java - Android：SQLite 使用错误的数据库

> ID：12424506
> 
> 赞同：6
> 
> 时间：2012-09-14T12:23:29.763
> 
> 标签：java, android, sqlite

我在我的 android java 项目中使用了多个 SQLite 数据库。第一个（用于登录）工作正常，使用以下代码，我正在关闭连接。但是，在下一页上，我正在调用一个使用不同数据库的函数，但它似乎仍然引用第一个数据库而不是新数据库。我收到此错误：

```
09-14 13:18:01.990: I/SqliteDatabaseCpp(10035): sqlite returned: error code = 1, msg = no such table:
 NextID, db=/mnt/extSdCard/DirectEnquiries/AuditingData/Static/Users 
```

没错，NextID 不在用户中。

这是使用用户表的登录页面的代码：

```
if(String.valueOf(loginCount).equals("2")) {

        File dbfile = new File(Global.StaticDB + "/Users" ); 
        SQLiteDatabase db = SQLiteDatabase.openOrCreateDatabase(dbfile, null);

        Cursor c = db.rawQuery("SELECT UserID from Users where UserID like '" + txtUsername.getText().toString().trim() + "' AND Password like '" + txtPassword.getText().toString().trim() + "'", null); 
        c.moveToFirst();

        if(c.getCount() > 0) {
            Global.Username = c.getString(c.getColumnIndex("UserID"));
            Global.currentDB = spnLocation.getSelectedItem().toString();
            Global.currentDBfull = Global.sctArea + Global.currentDB;

            db.close();
            Context context = getApplicationContext();
            CharSequence text = "Logged In";
            int duration = Toast.LENGTH_SHORT;
            Toast toast = Toast.makeText(context, text, duration);
            toast.show();
            Intent ShowMainPage = new Intent(view.getContext(), MainPage.class);
            startActivityForResult(ShowMainPage, 0);

        } 
```

下一页正在使用这个：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main_page);
    TextView txt = (TextView) findViewById(R.id.textView1);
    txt.setText(Global.Username);
    TextView dbtxt = (TextView) findViewById(R.id.txtDB);
    dbtxt.setText(Functions.getNextID("StationObjects"));

} 
```

功能是：

```
public static int getNextID(String tablename) {
    Log.e("Current DB is: ", Global.currentDBfull);
    File dbfile = new File(Global.currentDBfull); 
    SQLiteDatabase dbF = SQLiteDatabase.openOrCreateDatabase(dbfile, null);

    int rtnID=(int)DatabaseUtils.longForQuery(dbF,"Select NxtNumber from NextID where NxtTable like '" + tablename + "'",null);    
    rtnID += 1;
    //db.rawQuery("update NextID set NxtNumber = '" + rtnID + "' where NxtTable like 'StationObjects'", null);
    dbF.close();
    return rtnID;
} 
```

如何确保它使用第二个数据库而不是第一个？汤姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T08:14:01.977

您可以尝试使用以下格式打开和关闭数据库：

```
private static String DB_PATH = "/data/data/PACKAGE_NAME/databases/DATABASE_NAME.db";
private static SQLiteDatabase db;
db = SQLiteDatabase.openDatabase(DB_PATH, null, SQLiteDatabase.OPEN_READONLY);
// RUN YOUR QUERIES ETC
db.close() 
```

对于 2 个数据库，您需要定义 2 个 DB_PATH 并在相关的地方引用它们。

希望这会有所帮助，L & L Partners

# mobile - 手机支持http渐进式下载和其他流媒体协议。

> ID：12424507
> 
> 赞同：2
> 
> 时间：2012-09-14T12:23:34.807
> 
> 标签：mobile, video, video-streaming, html5-video

Samsung Bada OS、Nokia Symbian、Nokia Series 40、Windows Phone 和 Blackberry 的大多数现代版本是否支持通过其默认 Web 浏览器进行 http 渐进式下载（并假设将呼叫传递到媒体播放器）？

本质上，我想找出视频流协议的最佳组合，以在这些设备上达到最大用户数（如果用户单击链接以通过 Web 浏览器播放视频）。我找不到有关媒体播放器是否支持 http 渐进式下载的任何文档，尽管他们不支持似乎很荒谬。这些操作系统的一些最新版本支持 HTML5……这意味着它们理论上可以在浏览器中播放视频。

# php - 我可以将 $_GET 参数传递给本地运行的脚本吗？

> ID：12424512
> 
> 赞同：3
> 
> 时间：2012-09-14T12:23:58.443
> 
> 标签：php, shell, command-line

我正在尝试从命令行启动：

```
$ /usr/bin/php -f "index.php?refresh_words=1"
Could not open input file: index.php?refresh_words=1 
```

当然，没有`?refresh_words=1`它运行正常。我可以从命令行传递 $_GET 参数吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T12:24:45.300

你不能那样做。使用`argv`和`argc`。请参阅手册中的[命令行使用](http://php.net/manual/en/features.commandline.php)部分

# c# - 如何将哈希码附加到在 C# 中计算的同一文件中

> ID：12424513
> 
> 赞同：3
> 
> 时间：2012-09-14T12:24:02.760
> 
> 标签：c#, file, encryption, hash

我想将哈希码附加到计算它的文件中。（文件可以是任何格式）然后使用 RSA 算法加密结果。现在我想解密加密的结果并计算原始文件的哈希值。现在我必须比较两个哈希码....任何人都可以帮助我，请提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:52:41.453

这是很有可能的。例如，这就是[Microsoft Authenticode](http://msdn.microsoft.com/en-us/library/ms537359%28v=vs.85%29.aspx)的工作方式。正如@Guffa 上面所说，文件中需要有一些定义的格式，以将数字签名（签名哈希）与散列的部分分开。例如，一个简单的示例可能是使用[SignedXML](http://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.signedxml.aspx)类将数字签名嵌入到[XML 文件中的某个 XML 元素中。](http://msdn.microsoft.com/en-us/library/ms229745.aspx)正如@nonnb 所说，更复杂的示例可能会使用多部分文件。签名者和验证者需要知道在哪里可以找到签名以及从计算中包含什么。

# solr - 搜索 Solr 索引时避免重复

> ID：12424517
> 
> 赞同：4
> 
> 时间：2012-09-14T12:24:17.393
> 
> 标签：solr, filtering, duplicate-removal, solr-query-syntax

我的 Solr 索引有两种类型的用户（Type-A 和 Type-B），可以使用称为“类型”的字段来标识。但是用户有可能在两种类型（A 和 B）下都有条目。

例如，

```
Jacob is a user who comes under both Types(A and B). So, he will have two documents in our Index like:  
//document-1  
name:...  
type:A  
age:...  
//end of document-1

//document-2  
name:...  
Type:B  
age:...  
//end of document-2 
```

我的目标是，

*   当一个用户被搜索并且他只是A型时，他应该在结果中。

*   当一个用户被搜索并且他只是B型时，他应该在结果中。

*   当搜索用户（如 Jacob）并且他同时属于 A 类和 B 类时，结果中应该只有 A 类的文档。

我们如何通过查询来实现这一点？
提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-15T09:41:55.827

我假设您有一些可以唯一识别用户的字段？喜欢名称或 iduser？[如果是这样，只需使用grouping](http://wiki.apache.org/solr/FieldCollapsing)按该字段分组。如果您设置 group.main=true 那么结果看起来与您不使用分组时没有什么不同

# css - 使用@media 忽略整个样式表

> ID：12424519
> 
> 赞同：1
> 
> 时间：2012-09-14T12:24:19.100
> 
> 标签：css, media-queries, rules

好的，所以我正在尝试构建响应式设计，需要做的一件事是忽略图像滑块的整个样式表（因为我正在使用的样式表在使用特定主题时具有固定尺寸）。

那么，有什么方法可以忽略该特定文件中的每个 CSS 规则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:10:29.057

最简单的方法是不以编程方式在该页面上加载 css。

否则，您可以指定设备或视口宽度（无论您用于调整大小）以仅在屏幕大小匹配时加载样式表。

就像是：

```
<link rel="stylesheet" type="text/css"  media="screen and (max-device-width: 480px)" href="alternate.css" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:18:35.270

你不能在每个你不想展示的媒体查询的滑块容器上显示：none 吗？

# networking - Powershell在当前服务器上创建共享 - 授予用户/组权限

> ID：12424528
> 
> 赞同：3
> 
> 时间：2012-09-14T12:24:49.933
> 
> 标签：networking, powershell, permissions, powershell-2.0

我在创建共享或分配权限时没有问题，但我很难真正完全访问它。我是服务器上的管理员，我正在尝试准备服务器以供其他用户访问，并且我目前正在尝试将权限设置为对所有人的完全访问权限。

问题是，当我尝试在共享中创建新文件/文件夹时，访问被拒绝。

是否有其他人在通过 powershell 进行共享时遇到此错误？

这是我一直在使用的代码：

```
function New-Share 
    {
        param (
        [parameter(ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true, Mandatory=$true, HelpMessage="No folder name specified")]
        [string]$FolderName,
        [parameter(ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true, Mandatory=$true, HelpMessage="No share name specified")]
        [string]$ShareName,
        [parameter(ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true, Mandatory=$false, HelpMessage="No description specified")]
        [string]$Description
        )
    $error.clear()
    # Check for folder; Create it if it doesn't exist
        If (!(Test-Path $FolderName)) 
            {
                New-Item $FolderName -type Directory | Out-Null
            }
            # Check for share; Create it if it doesn't exist
            $Shares=[WMICLASS]"WIN32_Share"
            if (!(Get-WMIObject Win32_share -filter "name='$ShareName'"))
                {
                $Shares.Create($FolderName,$ShareName,0,65535,$Description) | Out-Null
                if (!($error))
                    {
                    # Share created
                    return $true
                    } else {
                    # Error
                    return $false
                    }
                } else {
            # Share Exists
            return $false
            }
    } 
```

我一直在用这个调用函数：

```
function bo.Share()
    {
        $domain = [Environment]::UserDomainName
        $BDrive = "$boDrive" + ":\SYNintviewer"
        New-Share -FolderName "$BDrive" -ShareName "SYNintviewer" -Description "SYNintviewer"
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T15:12:25.733

我实际上是自己完成的...

调用此函数改为有效：

```
function bo.Share()
{
    $domain = [Environment]::UserDomainName
    $BDrive = "$boDrive" + ":\SYNintviewer"
    echo "$boDrive is BoDRIVE"
    echo "$BDrive is BDRIVE"
    New-Share -Sharename "SYNintviewer" -Sharepath "$BDrive" -group "Authenticated Users" -auth FULL
} 
```

# objective-c - 当值改变时动画 NSLevelIndicator

> ID：12424530
> 
> 赞同：0
> 
> 时间：2012-09-14T12:25:01.057
> 
> 标签：objective-c, xcode, cocoa, uiviewanimation, nslevelindicator

目前我有以下代码来更新 NSLevelindicator：

```
[self.headerIndicator selfFloatValue:heightValue] 
```

有什么方法可以在值更新时为值之间的级别指示器设置动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T23:22:39.893

阅读动画滑块的这个答案。我没有尝试过使用级别指示器，但从 API 文档来看，这似乎是一个可行的选择。那里的源代码很容易适应：[NSSlider 动画](https://stackoverflow.com/questions/9015767/nsslider-animation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-11-13T17:05:27.643

我已经尝试过这段代码，它工作正常：

斯威夫特：self.CpuLevel.maxValue = Double(value)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T13:36:29.437

如果`[[[self.headerIndicator] animator] setFloatValue:heightValue];`不起作用，您必须自己添加该功能。请参阅[NSAnimatablePropertyContainer](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSAnimatablePropertyContainer_protocol/Introduction/Introduction.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T16:56:29.267

您可以编写自己的方法，例如更改级别。那里的数学试图保持总“动画”时间相等，无论从旧值到新值的转换有多大（这些值大约需要 1 秒）。

```
-(void)updateLevel:(NSNumber *) newLevelNum {
    float currentLevel = self.level.floatValue;
    float newLevel =  newLevelNum.floatValue;
    if (self.delay == 0.0) // self.delay is a float property set to 0.0 elsewhere
        self.delay = .2 /(newLevel - currentLevel);
    [self.level setFloatValue:currentLevel + .2];
    if (self.level.floatValue - newLevel < .01){
        [self performSelector:@selector(updateLevel:) withObject:newLevelNum afterDelay:self.delay];
    }
} 
```

# java - 如何在无需强制转换的情况下获得实现通用接口的特定类的工厂？

> ID：12424533
> 
> 赞同：2
> 
> 时间：2012-09-14T12:25:11.207
> 
> 标签：java, generics, factory

所以我得到了一个接口`SuperType`和一堆实现类`TypeA`，`TypeB`等等。我还有一个具有参数化方法的顶级接口：

```
public interface UsedByProductThing<T extends SuperType> {
    public T doStuff(T one);
} 
```

我有一个工厂（见下文）生产对象实现`GeneralProduct`：

```
public interface GeneralProduct<T extends SuperType> {
    T doSomething(T input);
} 
```

这是实施`ProductA`：

```
public class ProductA implements GeneralProduct<TypeA> {
    UsedByProductThing<TypeA> in;

    public ProductA(UsedByProductThing<TypeA> in) {
        this.in = in;
        in.doStuff(new TypeA());
    }

    @Override
    public TypeA doSomething(TypeA input) {
        return null;
    }
} 
```

现在有问题的工厂：

```
public class GeneralFactory {
    public static <T extends SuperType> GeneralProduct<T> createProduct(
            int type, UsedByProductThing<T> in) {
        switch (type) {
        case 1:
            return (GeneralProduct<T>) new ProductA((UsedByProductThing<TypeA>) in);
            // at this point, i want to return a "new ProductA(in)" preferably
            // without casting
            // or at least without the cast of the argument.
        default:
            throw new IllegalArgumentException("type unkown.");
        }
    }
} 
```

正如评论的那样，我希望工厂方法不使用演员表。我知道返回类型必须是 GeneralProduct，但我想不出一种省略演员表的方法（它也给了我一个“未经检查的演员表”警告）。另外，我想不出一种省略论点的方法。如果有必要摆脱那个地方的“不安全”铸造，我可以重组整个代码。你能告诉我一个在这里又好又顺利的方法吗？

另外，请根据需要编辑我的问题-我不知道如何在标题中正确解决该问题。

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:31:45.377

你不能避免铸造，因为

*   你有`in`哪个类型`UsedByProductThing<T>`你想变成 a`UsedByProductThing<TypeA>`并且编译器无法知道那`T`是`TypeA`
*   ProductA 是`GeneralProduct<TypeA>`并且编译器也不知道它`T`是 a `TypeA`here。

避免强制转换的唯一方法是替换`T`为`TypeA`

```
 public static GeneralProduct<TypeA> createProduct(
            int type, UsedByProductThing<TypeA> in) {
        switch (type) {
            case 1:
                return new ProductA(in);
            default:
                throw new IllegalArgumentException("type unkown.");
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:39:50.013

我不确定有什么干净的方法可以做到这一点。另外，我认为任何铸造方式无论如何都是不安全的，因为有人可能传递与“in”值不兼容的“type”值。

话虽如此，在处理泛型时，这些固有的未经检查的强制转换很常见。如果可能的话，你应该避免它们，但有时你不能，如果你真的只是想摆脱编译器警告，你应该添加注释来抑制。

@Suppress("未选中")

或者，为什么不采取建设者的方法呢？

```
public inteface Builder<T extends SuperType> {
    public GeneralProduct<T> createProduct(UsedByProductThing<T> thing);
}

public class BuilderFactory {
    public static <T extends SuperType> Builder<T> createBuilder(Class<T> clazz) {
       if (clazz.equals(ProductA.class)) {
          return new (Builder<T>) ProductABuilder();
       }
       ...
    }
} 
```

然后就这样使用它（假设您已经创建了一个构建器impl：

```
Builder<ProductA> builder = BuilderFactory.createBuilder(ProductA.class);
UsedByProductThing<ProductA> thing = ...;
ProductA product = builder.createProduct(thing); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:45:11.587

不回来

```
"GeneralProduct<T>" 
```

，你最好回来

```
"GeneralProduct<?>" 
```

，所以不需要转换结果。

但无论如何，您必须为“ProductA”转换参数！

# javascript - 在Firefox中使div可拖动

> ID：12424534
> 
> 赞同：1
> 
> 时间：2012-09-14T12:25:13.007
> 
> 标签：javascript, html

我已经尝试过[这个线程中](https://stackoverflow.com/questions/3977596/how-to-make-divs-in-html5-draggable-for-firefox)的代码，但它似乎对我不起作用。我正在使用 Firefox 15，它可以在 Chrome 中运行。

这是我的代码：

```
<!DOCTYPE html>
<head>
  <title>A Simple Draggable Object</title>
</head>
<body>
    <script>
        window.onload=function() {
            var dragItems = document.querySelectorAll('[draggable=true]');

            for (var i = 0; i < dragItems.length; i++) {
                addEvent(dragItems[i], 'dragstart', function (event) {
                    // store the ID of the element, and collect it on the drop later on
                    event.dataTransfer.setData('Text', this.id);
                 });
            }

        };
</script>

    <h1>Test #1: A Simple Draggable Object</h1>
    <div draggable="true">This text should be draggable.</div>
</body>
</html> 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T13:39:42.070

```
window.onload=function() {
        var dragItems = document.querySelectorAll('[draggable=true]');

        for (var i = 0; i < dragItems.length; i++) {
          dragItems[i].addEventListener('dragstart', function (event) {
            event.dataTransfer.setData('Text', this.id);
          });
        }

}; 
```

为我工作。感[谢克里斯 C](https://stackoverflow.com/users/42234/kris-c)

# php - Zend 与数据库的单元测试

> ID：12424535
> 
> 赞同：1
> 
> 时间：2012-09-14T12:25:19.887
> 
> 标签：php, database, zend-framework, testing

我想在我的项目中进行一些单元测试（我是测试新手），但在线教程似乎只展示了测试最简单的东西的示例。

我想测试的是，在我的 SurveyController 中将 POST 发送到 addAction 后会导致向我的调查表和问题表添加相应的行（一对多）。

测试数据库相关内容的最佳实践是什么？我是否为我的测试环境创建单独的数据库并在其上运行测试？那是唯一和正确的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:57:53.887

这取决于你的情况。

这是我对此的看法：

这个想法是测试但也要[干燥](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)（不要重复自己）。您的测试必须涵盖所有或尽可能多的不同情况，以确保您的组件经过彻底测试并准备好发布。

如果您使用已经开发的框架来访问您的数据库，例如[Doctrine](http://www.doctrine-project.org/)、[Zend Framework](http://framework.zend.com)、[PhalconPHP](http://www.phalconphp.com)等，那么您可以假设该框架已经过测试，而不是测试实际的 CRUD 操作。您可以专注于自己的代码所做的事情。

有些人可能甚至想测试，但在我看来，这是一种过度杀伤和资源浪费。如果他们只想进行更多测试，实际上可以将特定框架的测试包含在他们自己的测试中:)

但是，如果您负责数据库层类及其与应用程序的交互，那么测试是必须的。您可能不会一直运行它们，您需要通过一些代码来证明数据库操作是否有效，但您需要拥有它们。

[最后，您可以按照Mark Ba​​ker](https://stackoverflow.com/users/324584/mark-baker)在代码中建议的方式使用模拟测试，并假设数据库将按照您的预期响应（因为它已经过测试）。然后，您可以看到您的应用程序将如何对不同的响应或结果做出反应。

模拟数据库操作实际上会使您的测试运行得更快（以及此策略带来的其他好处），因为测试本身不会有任何数据库交互。这在具有数百个甚至数千个测试和持续集成的项目中变得非常方便。

高温高压

# c# - 为什么选择 IEnumerable 被定义为 IEnumerable , 不是 IEnumerable

> ID：12424537
> 
> 赞同：16
> 
> 时间：2012-09-14T12:25:28.830
> 
> 标签：c#, linq, c#-4.0

> **可能重复：**
> [为什么 IEnumerable<T> 在 C# 4 中成为协变的？](https://stackoverflow.com/questions/6732299/why-was-ienumerablet-made-covariant-in-c-sharp-4)

我在[MSDN](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)上查看`IEnumerable<T>`接口定义，并查看：

```
public interface IEnumerable<out T> : IEnumerable 
```

我想知道为什么 T 被定义为`out`，为什么不呢？

```
public interface IEnumerable<T> : IEnumerable 
```

这是什么原因？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-14T12:28:19.757

更多信息可以在[这里](http://msdn.microsoft.com/en-us/library/dd469487.aspx)找到。

使`out`类型参数协变。也就是说，您可以使用类型或任何派生类型。请注意，`out`这种方式仅适用于泛型，在方法签名中使用时具有不同的含义（尽管您可能已经知道这一点）。

这是取自[参考页面](http://msdn.microsoft.com/en-us/library/dd469487.aspx)的示例：

```
// Covariant interface. 
interface ICovariant<out R> { }

// Extending covariant interface. 
interface IExtCovariant<out R> : ICovariant<R> { }

// Implementing covariant interface. 
class Sample<R> : ICovariant<R> { }

class Program
{
    static void Test()
    {
        ICovariant<Object> iobj = new Sample<Object>();
        ICovariant<String> istr = new Sample<String>();

        // You can assign istr to iobj because 
        // the ICovariant interface is covariant.
        iobj = istr;
    }
} 
```

如您所见，`out`接口签名中的 允许您将 分配`ICovariant<String>`给`ICovariant<Object>`变量，如`String`派生自`Object`. 如果没有`out`关键字，您将无法执行此操作，因为类型会有所不同。

[您可以在此处](http://msdn.microsoft.com/en-us/library/dd799517.aspx)阅读有关协方差（和相关逆变）的更多信息。

正如其他答案所指出的那样，`IEnumerable`仅在 .NET 4 中成为协变的。尝试编写如下代码：

```
IEnumerable<Object> strings = new List<string>(); 
```

将在 .NET 4 和更高版本中编译，但不能在以前的版本中编译。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-14T12:46:46.577

`out`类型参数说明符表示协方差。

在实践中，

如果我定义两个接口。

```
interface ISomeInterface<T>
{
}

interface ISomeCovariantInterface<out T> 
{
} 
```

然后，我像这样实现它们。

```
class SomeClass<T> : ISomeInterface<T>, ISomeCovariantInterface<T>
{
} 
```

然后我尝试编译这段代码，

```
ISomeCovariantInterface<object> covariant = new SomeClass<string>(); // works
ISomeInterface<object> invariant = new SomeClass<string>(); // fails

// Cannot implicitly convert type 'SomeClass<string>' to 'ISomeInterface<object>'.
// An explicit conversion exists (are you missing a cast?) 
```

这是因为协变接口允许更多派生实例，而标准接口则不允许。

[在这里提琴](https://dotnetfiddle.net/CkP81L)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-14T12:28:05.147

[协方差。](http://msdn.microsoft.com/en-us/library/dd469487.aspx)这允许为集合分配比其通用参数中指定的更具体或派生类型的项目。

`IEnumerable<T>`并不总是协变的；[这是 .NET 4 的新功能，此处](https://stackoverflow.com/questions/6732299/why-was-ienumerablet-made-covariant-in-c-sharp-4)解释了更改的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:28:32.960

为达到这个：

```
class Base {}
class Derived : Base {}

List<Derived> list = new List<Derived>();
IEnumerable<Base> sequence = list; 
```

# java - 如何在android中确定语句的cpu使用情况

> ID：12424539
> 
> 赞同：2
> 
> 时间：2012-09-14T12:25:34.287
> 
> 标签：java, android, cpu

> **可能重复：**
> [如何在 android 中获取内存使用情况和 CPU 使用情况？](https://stackoverflow.com/questions/3118234/how-to-get-memory-usage-and-cpu-usage-in-android)

我正在编写一个 android 应用程序，它需要知道一些语句需要多少 cpu/电池。

例如，如果我调用一个函数，我想知道该函数使用了多少电池，或者至少类似的东西，例如已经使用了多少个时钟周期。

你知道我能用的一切吗？

提前致谢

莱昂纳多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:24:58.050

截至目前，可能无法直接获得 CPU 使用率。您如何使用间接方法来计算 CPU 使用率。

> 计算调用函数前后的时间戳差异。这将为您提供函数所需的以milis 为单位的持续时间。
> 
> 现在 CPU 使用率应该与持续时间成正比，除非功能阻塞某些 IO 操作或“Object.wait()”或上下文切换。
> 
> 但是，如果您的函数仅在内存计算中进行，则上述方法几乎会产生下降结果。

# c++ - 引用不同类型的变量

> ID：12424542
> 
> 赞同：0
> 
> 时间：2012-09-14T12:25:55.880
> 
> 标签：c++, reference

是否可以创建另一个数据类型的引用来引用不同数据类型的变量？

```
LPWSTR Buffer = new WCHAR[BUFFER_LEN];
LPBYTE& rfBuffer = (LPBYTE&) Buffer;
//Compiles but rfBuffer is BAD 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:27:37.197

是的。该语法`T x = (T&)y`告诉编译器将变量占用的内存视为`y`a`T`位于那里。但这只是对语言的严重滥用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T20:47:09.760

引用是隐含的指针。它们保存原始对象的地址，但在语法上与对象本身一样。根据这篇 MSDN[文章](http://msdn.microsoft.com/en-us/library/w7049scy%28v=vs.71%29.aspx)：*任何地址可以转换为给定指针类型的对象也可以转换为类似的引用类型*

# javascript - 将 JSONP 标头的数据参数传递给另一个文件中的 AJAX 请求

> ID：12424549
> 
> 赞同：0
> 
> 时间：2012-09-14T12:26:21.693
> 
> 标签：javascript, ajax, cordova, jquery-mobile

我在另一个文件中有一个 AJAX 请求。我需要将 json 参数传递给这个请求。以下是在我的 ajax 中工作的示例参数：

```
{firstName : name, lastName: sname, email : email, password : pass}, 
```

我想将数据作为函数的参数传递。我试图将它作为字符串参数传递，但我的函数识别它，并作为字符串发送。哪个不起作用。

我的ajax请求函数：

```
function ajax(url,contentType,data)
{  
    $.ajaxSetup ({
    cache: false
});

console.log("Starting AJAX");

$.ajax({                                                                   
    crossDomain: true,
    type: 'GET',
    url: url, 
    callback: 'jsonpCallback',
    jsonpCallback: 'jsonpCallback',
    jsonp: '_jsonp',
    data: data, 
    scriptCharset: "utf-8",
    contentType: contentType,
    dataType: 'jsonp json',
    timeout : 5000,

    success: success,
    error: error,
});
console.log('AJAX done');
} 
```

我试过这个：

```
ajaxRegister('http://lalal/register','application/json',data);

ajaxRegister('http://lalal/register','application/json','{firstName : name, lastName: sname, email : email, password : pass}'); 
```

关键是，当我将此示例 json 作为请求的数据参数时，它可以工作。我想要灵活并且能够将任何 json 放入参数中并将其作为请求的参数发送。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:51:28.830

答案是在“”中传递参数。它有所帮助，但在本地添加数据时并非必需。

# sql - 在 WHERE CLAUSE 的 CASE WHEN 条件下的“IN”条件？

> ID：12424551
> 
> 赞同：4
> 
> 时间：2012-09-14T12:26:30.047
> 
> 标签：sql, tsql, where-clause, case-when

我的情况很复杂。我想编写一个 sql 查询，包括“where 子句”上的“case when”条件。

就像这样：

```
SELECT *
FROM <table>
WHERE
<Column1> in
   CASE <Column2>
      WHEN 1 THEN ('OP', 'CL') 
      WHEN 0 THEN ('RE', 'ST')
END 
```

Column1 必须是“in”，而不是“=”。因为 Column1 的条件有多个值。该查询返回“',' 附近的语法不正确”。错误。

你能给我什么建议吗？（对不起，我的英语不好。）

编辑：我想我误解了。如果 Column2 为 1，则条件必须类似于“IN ('OP', 'CL')”，否则 Column1 为 2，条件必须类似于“IN ('RE', 'ST')”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T12:27:58.437

你不需要一个`CASE`表达式，你可以`OR`像这样使用：

```
SELECT *
FROM <table>
WHERE (Column2 = 1 AND Column1 IN ('OP', 'CL')) OR
    (Column2 = 0 AND Column1 IN ('RE', 'ST')) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-14T12:30:22.050

```
Select * from table where <Column1> in (Select case <Column2> when 1 then ('OP','CL') when
0 then  ('RE','ST')) 
```

# javascript - 如何将数组项添加到对象属性

> ID：12424552
> 
> 赞同：0
> 
> 时间：2012-09-14T12:26:30.040
> 
> 标签：javascript, arrays, object, for-loop

我想做以下事情：

```
// an object
var object = {
    one: null,
    two: null,
    three: null
};

// an array
var array = ['this is one', 'this is two', 'this is three']; 
```

我现在想将它们合并在一起，所以我得到了；

```
var merged = {
    one: 'this is one',
    two: 'this is two',
    three: 'this is three'
}; 
```

我不想只使用纯 javascript (ECMA5) 的任何第三个库。

**那么诀窍是什么？**

问候，博多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T14:00:06.977

尝试这个：

```
// an object 
var object = {
    one: null,
    two: null,
    three: null
};

// an array 
var array = ['this is one', 'this is two', 'this is three'];

function merge(arraysrc, array2dest) {

    var x, i = 0;

    var merged = [];

    for (x in array2dest) {
        var obj = {};
        obj[x] = arraysrc[i++];
        merged.push(obj);
    }
    return merged;
}

var a = merge(array, object);

alert(JSON.stringify(a));​ 
```

[http://jsfiddle.net/6mQYN/](http://jsfiddle.net/6mQYN/)

# android - Phonegap：带有 node.js 的“独立”应用程序

> ID：12424554
> 
> 赞同：2
> 
> 时间：2012-09-14T12:26:41.307
> 
> 标签：android, node.js, cordova, redis

我想用本地 node.js 服务器编写一个 Phonegap 应用程序。这可能吗？使用 node.js，我可以使用 redis-client 和 sdl 功能。

这是[Tim Caswalls 谈论](http://www.youtube.com/watch?v=uscdtg6nyqQ)node.js 和 phonegap 但我找不到更多关于它的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-03T18:43:54.240

我认为你应该研究这些

[https://github.com/rogerwang/node-webkit](https://github.com/rogerwang/node-webkit)

[http://appjs.com/](http://appjs.com/)

这是一个例子，看看 clipconverter.cc 桌面据我所知它使用 appjs

# java - 关于并行的接口声明

> ID：12424555
> 
> 赞同：2
> 
> 时间：2012-09-14T12:26:42.887
> 
> 标签：java, interface, constants, declaration

我正在浏览代码，其中我发现一个接口用于常量声明，但我在接口中发现的东西如下所示..

```
public interface abcConstants extends Serializable
 {

int def = 4;
int efg = 7;

} 
```

请让我知道这是正确的，因为我的知识常量也应该有 publis static final ..!!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T12:28:38.577

接口中所有声明的变量都是`public static final`.

接口中的方法是`public abstract`.

在接口中的变量或方法前面添加上述关键字是多余的，但可能有助于阅读代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:29:24.347

[JLS#9.3。字段（常量）声明](http://docs.oracle.com/javase/specs/jls/se7/html/jls-9.html#jls-9.2)

> 接口主体中的每个字段声明都是**隐式公共的、静态的和最终的。允许为这些字段冗余地指定任何或所有这些修饰符。**

你应该如何避免使用`interface for constant declaration and Define enum instead`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:53:14.493

默认情况下，接口内声明的变量是**public static final**。你不需要**明确地**标记它们。并且**接口中声明的所有方法**默认都标记为**公共抽象**，所以，..

```
public interface abcConstants extends Serializable
{

int def = 4;
int efg = 7;

} 
```

相当于

```
public interface abcConstants extends Serializable
{

public static final int def = 4;
public static final int efg = 7;

} 
```

# python - PyQt4如何恢复最小化的窗口？

> ID：12424557
> 
> 赞同：2
> 
> 时间：2012-09-14T12:26:44.070
> 
> 标签：python, pyqt

**PyQt4如果窗口最小化怎么办，调用方法展开那个窗口**

请告诉我怎么做

我将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T18:19:30.937

**嗨，伙计们，我最好这样来：**

```
if self.windowState() == QtCore.Qt.WindowMinimized:
   # Window is minimised. Restore it.
   self.setWindowState(QtCore.Qt.WindowActive) 
```

当然并不总是这个函数是`工作
可能是python中的问题
**感谢所有人**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T15:43:06.767

`QWidget`您可以通过调用其`windowState()`方法来检查 a 的当前状态。要更改状态，您将新状态传递给`setWindowState()`.

这是一个示例应用程序，它每 5 秒检查一次以查看它是否已最小化。如果是，则恢复窗口。

这只是一个例子——每 5 秒检查一次最小化窗口并恢复它在应用程序中是一件坏事；）。

```
import sys
import time
from PyQt4.QtGui import QApplication, QWidget
from PyQt4.QtCore import QTimer, Qt

class MyWidget(QWidget):
    def __init__(self):
        QWidget.__init__(self)

        self.timer = QTimer()
        self.timer.setInterval(5000)
        self.timer.timeout.connect(self.check_state)
        self.timer.start()

    def check_state(self):
        if self.windowState() == Qt.WindowMinimized:
            # Window is minimised. Restore it.
            self.setWindowState(Qt.WindowNoState)

if __name__ == '__main__':        
    app = QApplication(sys.argv)
    widget = MyWidget()
    widget.show()
    sys.exit(app.exec_()) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T16:38:25.943

最准确的方法是观察`QWindowStateChangeEvent`小部件的 ，并在它发生时立即响应。您可以通过不止一种方式做到这一点。

以下是如何重新实现`event`目标小部件的方法：

```
class Window(QtGui.QWidget):
    def __init__(self):
        super(Window, self).__init__()

    def event(self, e):
        if e.type() == e.WindowStateChange:
            if self.windowState() & QtCore.Qt.WindowMinimized:
                print "Minimized"
                # self.showMaximized()

        # call the super class event() no matter what
        return super(Window, self).event(e) 
```

现在，如果您有一些其他小部件要监视最小化，并且您不想在该对象上定义新的事件方法，您可以创建一个对象来简单地监视多个其他对象的事件。它被称为事件过滤器：

```
class Watcher(QtCore.QObject):

    def eventFilter(self, obj, e):
        if obj.isWidgetType() and e.type() == e.WindowStateChange:
            if obj.windowState() & QtCore.Qt.WindowMinimized:
                print "Minimized"
                # obj.showMaximized()

        return False

app = QtGui.QApplication([])

aWindow = QtGui.QWidget()
aWatcher = Watcher(aWindow)

aWindow.installEventFilter(aWatcher)

aWindow.show()
app.exec_() 
```

请注意，在检查 时`windowState`，您应该使用`&`to 而不是 比较`==`，因为状态可以是多个值的组合，您需要使用掩码检查它以查看该值是否存在于其他值中。即如果你先最大化窗口然后最小化它，它将有多个窗口状态。

附带说明一下，您还可以选择首先自定义实际的窗口属性。因此，如果您的目标是防止最小化，您可以禁用它的按钮：

```
aWindow = QtGui.QWidget()
flags = aWindow.windowFlags()
aWindow.setWindowFlags(flags ^ QtCore.Qt.WindowMinimizeButtonHint) 
```

这将从所有其他标志中减去最小化按钮标志。

# c - 测试 EINTR 信号

> ID：12424567
> 
> 赞同：1
> 
> 时间：2012-09-14T12:27:13.737
> 
> 标签：c, gdb, signals

在我的程序中，我有一个系统调用“sendmsg()”。我想测试如果这个系统调用被中断会发生什么。我该怎么做？

```
int test(args) {
          -----
          /* I can use GDB and stop at this point */  
          n = sendmsg(h, send_msg, 0);
          ----
          return n; 
 }

 int test_caller(args) {
           int a, err;
           a = test(arg);
           if (a != what_i_am_expecting) {
               err = error;
               switch (err) {
                   case EINTR:
                       syslog(LOG_ERR, "I WANT TO SEE THIS LOG");
                       break;
                   default:
                }
            } else printf("Everything went well\n");
    return 0;
   } 
```

在同一个函数中，我注册了一个信号处理程序，如下所示：

```
1366         struct sigaction sa;
1367         
1368         memset (&sa, '\0', sizeof(sa));
1369         sa.sa_handler = sighdl;
1370         sa.sa_flags = 0; 
1371         (void)sigaction(SIGINT, &sa, NULL); 
```

使用此处理程序：

```
1349 static void
1350 sighdl(int signo)
1351 {
1352         int i = 0;
1353         syslog(LOG_ERR, "got signal %d", signo);
1354         for (i = 0; i < 100; i++) {
1355         }
1356 } 
```

我的想法是在调用 sendmsg() 之前中断 test() 函数，然后将 sigint 发送到 pid。但不确定这个信号；它是否在测试调用者中进入 EINTR 案例。

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:38:10.003

通常`sendmsg`通话很快。因此在此期间很难发出信号。但是有一个办法：

`sendmsg`如果接收者队列已满，则取决于协议将阻塞。因此，以某种方式填充队列，然后在程序卡在`sendmsg`调用中时按 CTRL+C（CTRL-C 导致 SIGINT）。

因为你捕捉到了 SIGINT，所以程序不会退出。将`sendmsg`返回代码 -1 和 errno EINTR。

# sql - SQL标准中是否包含无穷大？

> ID：12424570
> 
> 赞同：3
> 
> 时间：2012-09-14T12:27:34.397
> 
> 标签：sql, postgresql, datetime, sqldatatypes

在 postgres 中，日期/时间类型有一个特殊的值 infinity 或 -infinity。那些标准的 SQL 值，还是 postgres 的附加值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T12:38:12.570

它是 PostgreSQL 的补充。

标准时间范围从 0001-01-01 00:00:00.000000 开始，到 9999-12-31 23:59:59.999999 结束（时区增加了定义工作的乐趣）。

1980 年代后期有一份（美国）空军合同 AF251，要求将“世界末日”作为一种时间无限。我不确定哪个 DBMS 获得了合同，以及系统是否普遍保留了这个概念。但是，我认为大多数人不会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:45:23.217

如果我没记错的话，SqlServer 中 smalldatetime 的最大值是 2079-06-06

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:41:00.127

据我所知，SQL 中没有无穷大的概念。通常，如果操作的结果高于特定数据类型的存储，它将抛出异常或算术溢出。日期时间没有任何上限，因此时间可以被认为是从 -Infinity 到 +Infinity。

# eclipse - Eclipse 项目资源管理器图标或名称

> ID：12424573
> 
> 赞同：1
> 
> 时间：2012-09-14T12:27:43.140
> 
> 标签：eclipse, eclipse-plugin

在 Eclipse Project Explorer 中，我希望添加一个特殊图标或修改项目名称以显示是否为项目设置了某个项目参数。这可能吗，如果可以，我该怎么做？我不想更改项目的名称，因为这会弄乱其他项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T15:39:48.380

这只能通过创建 Eclipse 插件来完成。我相信以下可能符合要求：

1.  标签装饰器（[装饰器扩展点](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_decorators.html)）
2.  项目性质/自然图像（[自然图像扩展点](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_ide_projectNatureImages.html)）

# android - Android联系人中的多个查询

> ID：12424576
> 
> 赞同：1
> 
> 时间：2012-09-14T12:27:46.370
> 
> 标签：android, android-contacts

尝试使用 android 联系人选择器获取 NAME 和 NUMBER

```
Uri uri = ContactsContract.CommonDataKinds.Phone.CONTENT_URI;
        String[] projection = new String[] { ContactsContract.Contacts._ID,
                ContactsContract.Contacts.DISPLAY_NAME,
                ContactsContract.CommonDataKinds.Phone.NUMBER };
        String selection = ContactsContract.Contacts.HAS_PHONE_NUMBER + " = '"
                + ("1") + "'";
        String[] selectionArgs = null;
        String sortOrder = ContactsContract.Contacts.DISPLAY_NAME
                + " COLLATE LOCALIZED ASC"; 
```

但不幸的是我得到：

```
android.database.sqlite.SQLiteException: no such column: has_phone_number: , while compiling: SELECT _id, display_name, data1 FROM view_data_restricted data WHERE (1 AND mimetype = 'vnd.android.cursor.item/phone_v2') AND (has_phone_number = '1') ORDER BY display_name COLLATE LOCALIZED ASC 
```

# windows-phone - Windows Phone appBar 在键盘上方添加额外边距

> ID：12424581
> 
> 赞同：4
> 
> 时间：2012-09-14T12:27:52.220
> 
> 标签：windows-phone

我正在尝试创建一个消息屏幕。这是我的 XAML：

```
<phone:PhoneApplicationPage
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:edc="clr-namespace:Microsoft.Expression.Controls;assembly=Microsoft.Expression.Drawing" xmlns:em="clr-namespace:Microsoft.Expression.Media;assembly=Microsoft.Expression.Drawing"

mc:Ignorable="d" d:DesignWidth="480" d:DesignHeight="696"
x:Class="chatScreen.MainPage"
Orientation="Portrait"
shell:SystemTray.IsVisible="True">

<phone:PhoneApplicationPage.Resources></phone:PhoneApplicationPage.Resources>

<phone:PhoneApplicationPage.ApplicationBar>
    <shell:ApplicationBar>
        <shell:ApplicationBarIconButton IconUri="/icons/appbar.message.send.png" IsEnabled="True" Text="send"/>

</phone:PhoneApplicationPage.ApplicationBar>

<!--LayoutRoot is the root grid where all page content is placed-->

<Grid x:Name="LayoutRoot" Background="Transparent">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="auto"/>
    </Grid.RowDefinitions>

    <Grid x:Name="userInfo" Grid.Row="0" Margin="12,0,0,0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="15" />
            <ColumnDefinition Width="84" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="48"/>
        </Grid.ColumnDefinitions>

        <Image x:Name="PresenceIcon" Grid.Column="0"  Height="64" Width="12" HorizontalAlignment="Left" VerticalAlignment="Bottom" Source="available.jpg"  />
        <Image x:Name="DisplayImage" Grid.Column="1"  Height="64" Width="64" HorizontalAlignment="Left" VerticalAlignment="Bottom" Source="tony.jpg"  Margin="0" />

        <Grid x:Name="metaContact_info" Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <TextBlock x:Name="DisplayName" Grid.Row="0" Text="Tony Stark" TextWrapping="NoWrap" FontSize="40" />
            <TextBlock x:Name="DisplayStatus" Grid.Row="1" Text="enjoying windows phone" FontSize="18" TextTrimming="WordEllipsis" />
        </Grid>
        <Image x:Name="ServiceIcon" Grid.ColumnSpan="2" Grid.Column="3" Source="service_gtalk.jpg" Width="24" Height="24" VerticalAlignment="Top" Margin="0,20,0,0"/>
    </Grid><!-- userInfo ends -->

    <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,18,12,12">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <ScrollViewer x:Name="messages" Grid.Row="0" HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch" Margin="0"/>

    </Grid>
    <ScrollViewer x:Name="inputBox_scroller" Grid.Row="2" Margin="0" MaxHeight="108" VerticalAlignment="Bottom">
        <TextBox x:Name="inputBox"  TextWrapping="Wrap" HorizontalContentAlignment="Stretch" Text="" FontSize="{StaticResource PhoneFontSizeMedium}" InputScope="Chat" AcceptsReturn="True" />
    </ScrollViewer><!-- Content Panel ends --> 
```

我还使用 Jeff Wilcox 的 PhoneThemeManager 1.2 让我的应用程序始终以浅色主题加载。

当我在此屏幕中有 appBar 并且键盘打开时，文本框下方有大约 48 px 的额外边距。当手机主题为黑色时，这会在键盘上方和文本框下方显示一个难看的黑条。当手机主题为白色时，此黑色彩条为白色。以下是更好地演示的屏幕截图：

![](../Images/04c53a5b14262dd69150174be78f4602.png) ![](../Images/f1eca0765aadcc7736d2fb2addd21f78.png)

但是，当我禁用应用栏然后打开键盘时，文本框下方的额外边距不存在。

我想在键盘打开时禁用这个额外的边距，就像它在 appBar 在那里的消息传递中心中发生的那样，以及键盘的自动更正栏，但仍然没有这个额外的边距。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:59:10.847

唯一的方法（现在已知）是在您键入时禁用 AppBar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T18:37:16.890

嗨我也有这个问题。将 设置`Textbox.InputScope`为空会删除键盘上方的额外栏，除了删除 AppBar 之外我无法使其消失。

# video-streaming - HTTP Live Streaming 播放器行为

> ID：12424585
> 
> 赞同：0
> 
> 时间：2012-09-14T12:28:02.783
> 
> 标签：video-streaming, http-live-streaming, audiovideoplayback

我正在开发播放 HLS Live 内容的播放器。因此，它会定期重新加载测试链接的 .m3u8 索引文件。

例如播放器重新加载了 01.m3u8 索引文件。

```
(01.m3u8 - #1)

       0.ts---the player tried to download this 100.ts file first.
       1.ts---
       2.ts
       3.ts 
```

然后，它尝试下载 0.ts 文件。

但是，网络带宽不足以快速下载这个 0.ts 文件。

一个 TS 下载用了将近 24 秒。因此，它再次重新加载了 02.m3u8 索引文件。

```
(01.m3u8 - #2)
       2.ts---the player tried to download 102.ts file first.
       3.ts
       4.ts
       5.ts 
```

但是，播放器在索引文件中找不到 1.ts 文件。因为，在播放器下载 1.ts 文件之前，服务器已经更新了索引文件。因此，播放器尝试下载 2.ts 文件而不是 1.ts 文件。

这意味着播放器丢失了 20 秒的流数据。那么，这种行为是否符合规范，因为它看起来令人困惑？

我认为它应该从 1.ts 而不是 2.ts 开始更新 m3u8。或者它是如何决定的。

有人可以提出建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:40:23.803

它做了正确的事。解决您面临的问题

如果您只需要 1 个比特率，您应该知道您的网络带宽并相应地进行编码 [对封闭和受控环境有用]

或者

在多个带宽中进行编码并使用多个比特率设置您的 m3u8，并确保您将最低的作为第一个条目，HLS 将相应地进行调整。在几个段内，它将达到目标带宽。这实际上是 HLS 的重点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:23:34.440

该规范允许服务器从播放列表的开头删除 URI，只要播放列表仍然是目标持续时间的至少三倍。（draft-pantos-http-livestreaming-08 的第 6.2.2 节）

> 如果播放列表文件的持续时间减去片段的持续时间小于目标持续时间的三倍，则服务器不得从播放列表文件中删除指定片段的媒体 URL。

因此，只要播放列表包含 4 个片段，长度只有很小的变化，这似乎是一种有效的行为。对于实时流，我希望服务器以与添加片段相同的速度从流中删除片段。因此，对于 10 秒的片段，我发现它删除 2 个片段而您花费 24 秒下载单个片段是合理的。

# cakephp - 如何在 CakePHP 中显示登录用户的记录？

> ID：12424603
> 
> 赞同：3
> 
> 时间：2012-09-14T12:29:07.697
> 
> 标签：cakephp, find, record

用户控制器

```
public function profile()
{
   $this->set('profile', $this->User->find('all'));
} 
```

配置文件.ctp

```
<?php
echo $profile['User']['name'];  // Where user is the model and name is the name field  in db.
?> 
```

我知道我做错了什么，但我找不到任何好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:12:34.950

```
public function profile(){
   $this->set('current_user', $this->Auth->user());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:46:01.393

```
public function profile()
{
   $this->set('profile', CakeSession::read('Auth.User'));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:34:37.373

您必须进行查询。如果您有，您已经登录了用户

> 认证

在 $components 中的 Appcontroller 中，例如：

```
class AppController extends Controller {

    public $components = array(
        'Session',
        'Auth' => array(
            'authenticate' => array(
                'Form' => array(
                    'fields' => array('username' => 'email')
                )
            )
        ),
    ); 
```

现在，在您的控制器中，您在此模式下拥有经过身份验证的用户的变量：

```
$this->Session->read('Auth.User.id')); 
```

您可以进行这样的查询以在数据库中检索已登录用户的记录：

```
this->set('profile', $this->User->find('all', array('recursive' => 1,
                    'conditions' => array('User.id' =>  $this->Auth->user())))); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:52:28.520

尝试这个：

```
public function profile()
{

    $user = $this->Auth->user();
    $this->set('profile', $this->User->find('all',
        array('conditions'=>array('User.id'=>$user['id']))));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T12:56:38.500

实际上我在控制器中所做的是

```
 public function profile()
{
   $id=$this->Session->read('Auth.User.id');
   $this->set('profile', $this->User->findByid($id));

} 
```

及其工作:)。谢谢大家理清逻辑。

# spring - Spring 动态自动装配服务

> ID：12424604
> 
> 赞同：0
> 
> 时间：2012-09-14T12:29:09.887
> 
> 标签：spring, autowired

我已经开始构建某种 CMS，但我被一个想法困住了。

描述是：

我有标准的 MVC 控制器（主页），我正在下载将在此控制器中设置的模块设置。

响应是，我必须实现名为“HPModule”的模块。

所以我试图通过`Class.forName("com.app.something.HPModule");`然后调用方法加载这个模块`init();`

我的 HPModule 是：

```
public class HPModule
{

    @Resource(name = "hpModuleService")
    private HPModuleService hpModuleService;

    public String init()
    {
        SomeObject someObject = hpModuleService.getArticle();
    }
} 
```

而且我发现当我尝试做`SomeObject someObject = hpModuleService.getArticle();`Spring时，`@Resource`当我通过`Class.forName`.

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:39:14.363

`HPModule`必须是通过 Spring`DI`或直接从 Spring检索的Spring Bean `BeanFactory`。你不能期望 Spring 自动装配一个没有被 Spring 实例化的类，除非你使用`@Configurable`和`AspectJ`编织这个类。

如果`HPModule`已经是一个 Spring Bean，那么就直接将它`@Autowire`或`@Inject`它直接放入需要它的 MVC 控制器中。

如果您在编译时不知道您将需要哪些模块，那么注入`ListableBeanFactory`并使用`BeanFactoryUtils`以在运行时按类型或名称获取您需要的模块。

# sql - 缺少索引详细信息 SQL

> ID：12424605
> 
> 赞同：25
> 
> 时间：2012-09-14T12:29:16.107
> 
> 标签：sql, performance, indexing

我正在调整我的 SQL 服务器，当我在顶部显示我的一个查询的执行计划时，它显示：

“缺失索引（影响 99.7782）：创建非聚集索引...”

所以我查看了缺少的索引详细信息，它显示了这一点：

```
/*
Missing Index Details from ExecutionPlan1.sqlplan
The Query Processor estimates that implementing the following index could improve the query cost by 99.7782%.
*/

/*
USE [phsprod]
GO
CREATE NONCLUSTERED INDEX [<Name of Missing Index, sysname,>]
ON [dbo].[address] ([userid])

GO
*/ 
```

我现在只使用 SQL 大约一个月，而且我从来没有做过任何事情，因为我的所有表都已经为我构建了。任何人都可以帮助解释/给我关于如何处理的任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-14T12:34:24.953

这意味着 SQL Server 建议您的查询可以使用索引运行得更快。索引会增加开销和磁盘存储，因此您应该忽略此提示，除非查询在生产中出现性能问题。

要创建索引，请取消注释后面的语句`use`，替换`[<Name of Missing Index, sysname,>]`为真实姓名，然后运行它：

```
USE [phsprod]
GO
CREATE NONCLUSTERED INDEX IX_Address_UserId
ON [dbo].[address] ([userid]) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-14T12:42:46.213

这意味着 SQL Server 建议您的查询可以使用此索引运行得更快。

这可能意味着您当前的索引对于您正在运行的查询来说不是最大的。也许您的查询可以优化。或者，也许您可​​以添加索引。但如果你决定这样做，你必须仔细分析。

事实上，索引增加了开销和磁盘存储。但是，它也可以提高性能。例如，如果您总是根据“用户 ID”在表中搜索，那么在该列上添加索引可能会有所回报，因为 SQL 将能够使用该索引进行搜索。

如果您在字典中搜索一个单词，请稍微考虑一下。如果您要查找单词“dog”，则要搜索“d”，然后搜索以“do”开头的单词，最终找到单词“dog”。

如果字典中的单词不是按字母顺序排列的，则必须搜索整个字典才能找到“dog”这个词！

聚集索引（或主键）是列的顺序。现在，您似乎在“userid”列上没有索引。所以 SQL Server 有（可能）扫描整个表，直到找到用户 ID。

如果您添加一个非聚集索引，它不会重新排序您的表，但它会告诉 SQL Server 他应该在哪个范围内搜索以找到您想要的用户 ID。（如“在字典中，在第 20 页和第 30 页之间”）所以它不必搜索整个表来找到它。

但这也意味着当你向表中添加新数据，或者删除，或者修改时，他需要保持他的索引是最新的。通常，一些索引不会受到伤害，但您需要确保它们是必需的。您不想添加太多索引，因为如果添加太多，它们会损害性能。

如果你的表只包含几百行，也许它不会显示你的性能有很大的提高。但随着时间的推移，当你的桌子变大时，它可能会有所作为。

希望有帮助！

# symfony - 如何正确声明对 Bundle 中另一个 Bundle 的依赖关系？

> ID：12424607
> 
> 赞同：5
> 
> 时间：2012-09-14T12:29:23.367
> 
> 标签：symfony, symfony-2.1, composer-php

我正在尝试在 Bundle 中使用 Bundle，但不知何故它失败了。

```
"repositories": [
    {
        "type": "vcs",
        "url": "https://github.com/myname/mybundle"
    }
],
"require": {
    "php": ">=5.3.3",
    "symfony/symfony": "2.1.*",
    (...)
    "myname/mybundle": "*"
}, 
```

到目前为止，这似乎有效。但我不知道如何在“myname/mybundle”中声明另一个依赖项。

我在 myname/mybundle 的 composer.json 文件中尝试了以下操作，但没有一个起作用:(

```
"repositories": [
    {
        "type": "vcs",
        "url": "url": "https://github.com/drymek/PheanstalkBundle"
    }
],
"require": {
    (...)
    "drymek/PheanstalkBundle": "dev-master"
} 
```

和

```
"repositories": [
    {
        "type": "package",
        "package": {
            "name": "drymek/PheanstalkBundle",
            "version": "dev-master",
            "source": {
                "url": "https://github.com/drymek/PheanstalkBundle.git",
                "type": "git",
                "reference": "master"
            }
        }
    }
],
"require": {
    (...)
    "drymek/PheanstalkBundle": "dev-master"
} 
```

当我朗姆酒时，我`composer.phar update`得到的只是

`- myname/mybundle dev-master requires drymek/pheanstalkbundle dev-master -> no matching package found.`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T13:15:55.497

好的，我在[这里找到了答案](https://github.com/composer/composer/blob/master/doc/04-schema.md#repositories-root-only)

它指出：`Repositories are not resolved recursively. You can only add them to your main composer.json. Repository declarations of dependencies' composer.jsons are ignored`。

太糟糕了......但现在至少我知道将我的依赖放在哪里（在根 composer.json 文件中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-09T23:00:19.097

对于捆绑包依赖项，请参阅我的库[https://github.com/AshleyDawson/MultiBundle](https://github.com/AshleyDawson/MultiBundle)。例如，扩展 MultiBundle 并实现 getBundles() 方法，如下所示：

```
<?php

namespace Acme\MyBundle;

use AshleyDawson\MultiBundle\AbstractMultiBundle;

class AcmeMyBundle extends AbstractMultiBundle
{
     /**
      * Optional: define a protected constructor to stop instantiation     outside of registerInto()
      */
     protected function __construct()
     {

     }

    /**
     * Define bundles that this bundle depends on
     */
    protected static function getBundles()
    {
        return array(
           new Acme\FooBundle\AcmeFooBundle(),
           new Acme\BarBundle\AcmeBarBundle(),
        );
    }
} 
```

然后在 AppKernel 中注册捆绑包及其依赖项：

```
// app/AppKernel.php

// ...

class AppKernel extends Kernel
{
    // ...

    public function registerBundles()
    {
        $bundles = array(
            // ...,
        );

        // Register my bundle and its dependencies
        \Acme\MyBundle\AcmeMyBundle::registerInto($bundles);

        // ...
    }
} 
```

# ajax - 尝试使用 jquery 获取 json 时出错

> ID：12424610
> 
> 赞同：0
> 
> 时间：2012-09-14T12:29:45.187
> 
> 标签：ajax, jquery, imdb

我正在尝试编写一个代码，该代码将使用一些 IMDB API 获取有关电影的一些信息，但是我遇到了两个无法修复的错误...

这是代码：

```
<body>
    <h1>The bourne Legacy</h1>
    <h2>2012</h2>

    <script>
        (function() {

            function getMovieInfo( title, year ) {

                $.ajax({
                    type : 'GET',
                    url: "http://www.deanclatworthy.com/imdb/",
                    dataType: 'jsonp',
                    data: { 'q': title, 'year': year },
                    success: function(info) {
                        console.log(info.year);
                    }
                });
            }

            getMovieInfo( $('h1').text(), $('h2').text() );

        })();
    </script>
</body> 
```

错误是下一个：

```
Resource interpreted as Script but transferred with MIME type text/html: "http://www.deanclatworthy.com/imdb/?callback=jQuery18108839007553178817_1347625688866&q=The+bourne+Legacy&year=2012&_=1347625688869". jquery.min.js:2
Uncaught SyntaxError: Unexpected token : www.deanclatworthy.com:1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T11:13:37.687

```
 function getMovieInfo( title, year ) {

        $.ajax({
            type : 'GET',
            url: "http://www.deanclatworthy.com/imdb/",
            dataType: 'json',
            data: { 'q': title, 'year': year },
            success: function(info) {
                console.log(info.year);
            }
        });
    }

    getMovieInfo( $('h1').text(), $('h2').text() );

}); 
```

# c# - unity3d blender fbx 文件枪是分开的

> ID：12424611
> 
> 赞同：0
> 
> 时间：2012-09-14T12:29:47.790
> 
> 标签：c#, unity3d

你好，我将一个 blender.fbx 文件统一导出到我的资产文件夹中，它运行良好，我将它放在相机前面，但是当我玩它时，枪看起来像是被拆开了怎么回事？！如果这对我有帮助分离了一些部分，所以我可以将它用于动画，因为看起来所有动画部分都是分开的，这是统一的东西还是搅拌器的东西？

[http://www.flickr.com/photos/87198010@N07/7985274177/in/photostream](http://www.flickr.com/photos/87198010@N07/7985274177/in/photostream)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T14:07:28.670

当您将网格加载到 unity 时，unity 将作为标准添加一个动画模块，即使您还没有任何动画。这可能是造成枪支错误的原因。如果上面有动画组件，请移除该组件并重试。

也可能是枪的不同部分处于不同的比例或旋转，在从搅拌机导出之前单击并单击“应用旋转和比例”，然后导出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T21:05:42.567

两种选择：

1.  可能是您的动画不正确..删除动画进行测试..
2.  子对象、枪管和触发器的位置可能与父对象的关系不正确。我不知道事实，只是想到了一些想法。

当您发现时告诉我们。

# database - VB.NET - 更改数据库日期时间的样式/格式？

> ID：12424613
> 
> 赞同：0
> 
> 时间：2012-09-14T12:30:15.077
> 
> 标签：database, vb.net, datetime, ssis

我有一个 SSIS 脚本组件，它需要在导出数据前不久运行一些 VB.NET 代码。

我正在为时间戳列的每一行提供这个脚本组件。（数据类型 DT_DBTIMESTAMP）

日期的输入样式如下：`2012-09-12 16:34:12`

我需要 VB.NET 代码来更改它，以便它以以下格式显示：`09/12/2012 04:34:12 PM`

两个关键点是，如果所有值都是个位数，则需要用零填充，并且所有时间值都需要采用 AM/PM 的 12 小时格式。简而言之，风格必须遵循： `{0:MM/dd/yyyy hh:mm:ss tt}`

不幸的是，我的 VB.NET 技能非常有限，而且我还没有在 SO 或 MSDN 上找到这方面的示例。从我的搜索来看，我似乎可以创建一种新样式的 DateTime 对象，然后使用自定义日期格式或其他什么？我无法为我的生活弄清楚在这里做什么。

脚本组件自动生成的代码如下：

```
Imports System
Imports System.Data
Imports System.Math
Imports Microsoft.SqlServer.Dts.Pipeline.Wrapper
Imports Microsoft.SqlServer.Dts.Runtime.Wrapper

Public Class ScriptMain
    Inherits UserComponent

    Public Overrides Sub Input0_ProcessInputRow(ByVal Row As Input0Buffer)
        '
        ' Add your code here
        '
    End Sub

End Class 
```

所以我可以做类似的事情：

```
String.Format("{0:MM/dd/yyyy hh:mm:ss tt}", Row.[DateTimeColumn].toString()) 
```

我不知道……完全迷失在这里。第一次真正在 SSIS 或 VB.NET 中使用脚本组件。

帮助？？？？:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:12:38.190

如果您将数据作为`Date`对象获取，那么您可以简单地调用该`ToString`方法并传递格式字符串，例如：

```
Dim d As Date = columnValue
Dim formatted As String = d.ToString("MM/dd/yyyy hh:mm:ss tt") 
```

但是，如果您将日期作为字符串获取，则需要先将其解析为`Date`对象，然后再重新格式化：

```
Dim s As String = columnValue
Dim d As Date = Date.ParseExact(s, "yyyy-MM-dd HH:mm:ss", CultureInfo.InvariantCulture)
Dim formatted As String = d.ToString("MM/dd/yyyy hh:mm:ss tt") 
```

# sql-server-2008 - 使用数据库邮件发送每日电子邮件通知

> ID：12424616
> 
> 赞同：0
> 
> 时间：2012-09-14T12:30:23.267
> 
> 标签：sql-server-2008

在我的项目中，我有一个“每天提醒我”功能，如果用户选中该选项，则它是一个复选框，将使用数据库邮件 SQL Server 2008 每天发送一封电子邮件，直到满足特定条件。请建议我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:33:03.917

很简单，新建一个 Sql Server Job 并添加发送邮件任务。看到这个：

[http://www.howtogeek.com/howto/database/sending-automated-job-email-notifications-in-sql-server-with-smtp/](http://www.howtogeek.com/howto/database/sending-automated-job-email-notifications-in-sql-server-with-smtp/)

最好的祝福

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:34:03.923

您可以使用 SQL Server 代理邮件功能。

更多信息：http: [//msdn.microsoft.com/en-us/library/ms188235%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ms188235%28v=sql.105%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:34:04.980

通过 SQL 代理作业和[`sp_send_dbmail`](http://msdn.microsoft.com/en-us/library/ms190307.aspx). 但我建议改用[SQL Server Reporting Service](http://msdn.microsoft.com/en-us/library/ms159106.aspx)。它能够创建[数据驱动的订阅](http://msdn.microsoft.com/en-us/library/ms159150.aspx)并[通过电子邮件发送](http://msdn.microsoft.com/en-us/library/ms160334)。

# scala - 将提升与 Play2 进行比较

> ID：12424617
> 
> 赞同：47
> 
> 时间：2012-09-14T12:30:33.920
> 
> 标签：scala, playframework-2.0, lift, web-frameworks

我之前在 java 中使用过 play2。感觉有点像样板文件，特别是如果您将 akka 与 java 一起使用。但这不是框架的错。

昨天我读了“为不耐烦的人准备的 Scala”，我真的很喜欢这种语言。

现在我查看了 Lift 2.5 和 Play 2.0.3 这两个框架。我认为电梯的学习曲线更高，我不能只用电梯做一些事情。这对我来说不是一个骗局。据我所见，Lift 的设计非常漂亮和干净。

但对我来说，很难说出主要的区别是什么。我认为这两个框架都很棒。

*   Views First 方法不允许您在模板中编写代码，而是必须在片段中编写代码。我非常喜欢这个，因为它对我来说看起来更有条理。它还允许您使用普通的 html 编辑器。 *（我没有太多经验，这只是我的第一印象）*

*   为了安全，我认为这不是框架的工作。

*   无状态/有状态：很难说出主要区别在哪里。我只知道如果你使用 web sockets，play 也有一个状态。

*   按 F5 后，这两个框架都可以编译。我非常喜欢这个功能。

*   两个框架都在使用 sbt

*   Lift 带有授权，但我认为有一个 play2 scala 插件可以做同样的事情

*   Lift 有一个用于 mongoDB 的 ORM 映射器。因为我想使用 noSQL，所以这对我来说看起来更干净。*（再次没有太多经验）* **编辑**play2 中有一个用于 scala mongodb 的 ORM 映射器[https://github.com/leon/play-salat](https://github.com/leon/play-salat)

*   异步 - Play 2 使用 Akka。不知道电梯使用什么，但他们也有类似的东西。

*   Lift 附带 CSRF 支持。Play2 有一个用于 CSRF 的模块，但这会为您的代码添加一个样板。

*   无状态身份验证似乎存在一些安全漏洞。两个框架都具有状态身份验证。（play2 有状态/无状态，提升有状态）

* * *

* * *

*   每个框架的优势是什么？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-09-14T16:16:35.460

在使用 Lift 一两个星期后发布此内容并不符合任何人的利益。但是，我想花一些时间来纠正一些错误和误解。

> *   为了安全，我认为这不是框架的工作。

你大错特错了。安全是框架的工作。至关重要的是，安全是默认完成的，而不是依赖每个开发人员了解每个安全漏洞并确保每一行代码都考虑到这一点。

我们所要做的就是看看[GitHub](http://arstechnica.com/business/2012/03/hacker-commandeers-github-to-prove-vuln-in-ruby/)发生了什么， 以了解即使是使用众所周知的技术的最佳编码人员也可能犯下严重错误。

Lift 在顶部提供了一个坚实的安全层，因此默认情况下，没有 XSS、CSRF 等，但开发人员可以尽可能深入地挖掘 HTTP 请求并处理网络上的字节。

> *   无状态/有状态：很难说出主要区别在哪里。我只知道如果你使用 web sockets，play 也有一个状态。

Lift 非常清楚哪里需要状态，哪里不需要。Lift 可以支持无状态、部分有状态和完全有状态的应用程序。在逐页和逐个请求的基础上，Lift 应用程序可以是有状态的或无状态的（例如，在[Foursquare](http://foursquare.com)中，场所页面对于搜索引擎抓取是无状态的，但对于已登录的浏览器是有状态的。）有关状态设计决策的更多信息，请参阅[Lift、State 和 Scaling](http://lift.la/lift-state-and-scaling)。

> *   两个框架都在使用 sbt

Lift 使用 Maven、sbt、Buildr 甚至 Ant。Lift 不知道构建环境和部署环境（Java EE 容器、Netty 等）。这很重要，因为它使 Lift 更容易与您环境的其他部分集成。

> *   Lift 带有授权，但我认为有一个 play2 scala 插件可以做同样的事情

Lift 已经存在了 5 年多，并且有很多模块和东西。Lift Web 框架（与模块不同）与持久性、身份验证等无关，因此您可以在 Lift 中使用任何东西。

> *   异步 - Play 2 使用 Akka。不知道电梯使用什么，但他们也有类似的东西。

Lift 已经支持 Async 超过 5 年了。它已融入框架。Lift 的 Comet 支持是[所有 Web 框架中最好的，](http://seventhings.liftweb.net/comet)因为除其他外，它通过对服务器的单个请求来多路复用页面上的所有“推送”请求，从而避免连接不足。Lift 如何进行异步并不重要，因为 Lift 的核心理念之一是我们从开发人员那里移除管道，以便开发人员可以专注于业务逻辑。

但是对于那些关心的人来说，Lift 拥有 Scala 领域中任何框架中最好和最轻量级的演员。我们是第一个脱离 Scala Actor 库的人，并努力为不同的 Actor 库开辟道路，让 Akka 和 ScalaZ Actors 蓬勃发展。

> *   Lift 附带 CSRF 支持。Play2 有一个用于 CSRF 的模块，但这会为您的代码添加一个样板。

这是 Lift 对安全性承诺的一部分。这很[重要](https://twitter.com/rasmus/status/5929904263)。

> *   无状态身份验证似乎存在一些安全漏洞。两个框架都具有状态身份验证。（play2 有状态/无状态，提升有状态）

Lift 应用程序可以是有状态的，也可以是无状态的。这是您的选择，Lift 非常清楚如何做出决定。

此外，正如我在 Lift、State 和 Scaling 文章中指出的那样，让开发人员弄清楚如何以一种安全、可扩展、高性能的方式序列化状态（因为识别特定用户的 Web 应用程序上的几乎每个请求都是有状态的）应该由框架以可预测、安全的方式完成，并为开发人员提供合理的覆盖。

## 离别笔记

Play 很像 Rails：它可以快速将一个站点拼凑在一起，而且它基于 MVC，因此很多开发人员都理解它。但是 Play 缺乏 Rails 的深度和广度（社区、插件、专业知识、人才等）。如果你想要快速、简单的 MVC，那么使用 Rails 和 JRuby 并用 Scala 编写后端（它们一起工作得非常好。）

电梯是另一种野兽。有一个显着的学习曲线（停止思考 MVC 并开始考虑首先考虑流向业务逻辑的用户体验。）但是一旦你走上学习曲线，Lift 站点就会更安全、高度可扩展、超级交互，并且更容易随着时间的推移保持。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-09-14T13:04:58.560

要了解 Play 可以做什么（它可能很酷），请查看[TypeSafe 控制台](http://typesafe.com/products/console)

要快速使用 Lift，请使用[模板项目](https://github.com/lift/lift_25_sbt)。

有关在 Play 中使用 Mongo 的示例，请查看[Factile](https://github.com/asinghal/factile)。

总之，我认为 Lift 或 Play 都不会出错。两者都是活跃的项目，拥有良好的社区和作者的良好支持。这实际上取决于您的业务问题。如果工具支持对您很重要，那么您可能需要考虑使用 Play（它在 IntelliJ Idea 上得到了很好的支持）。

请注意，作为 TypeSafe 技术堆栈的一部分，Play 将构建到最新版本的 Scala，因此如果使用 Scala 2.10 功能对您很重要，那么您可能需要牢记这一点。Lift 目前使用的是 Scala 2.9.2，这也很好。

对于我目前的项目，我使用用于 ORM 的提升映射器（它非常棒且坚如磐石），用于 REST 的喷雾器（这简直太棒了）。这种方法完全避免了框架，但这取决于您想要做什么。框架通常是要走的路。

# tcl - 在 tcl 中读取缓冲流

> ID：12424622
> 
> 赞同：2
> 
> 时间：2012-09-14T12:30:51.087
> 
> 标签：tcl, file-handling

这是一个关于 tcl 文件读取的问题。我正在打开一个要写入的缓冲区流，并且我只有一个文件处理程序引用它现在在逐行读取此缓冲区时，在某些情况下我必须放置缓冲区的所有内容，请建议我如何实现这一点。所以我只是粘贴一个示例代码来解释我的要求。

```
catch { open "| grep" r } pipe
while { [gets $pipe line] } {
      if { some_condition } {
          ## display all the content of $pipe as string
      }
} 
```

谢谢鲁奇

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:35:42.900

要从管道读取直到它被另一端关闭，只需使用`read $pipe`. 然后，您可以这样做：

```
set pipe [open "| grep" r]
while { [gets $pipe line] >= 0 } {  # zero is an empty line...
    if { some_condition } {
        puts [read $pipe]
        ### Or, to include the current line:
        # puts $line\n[read $pipe]
    }
} 
```

如果您想要管道输出中早期的任何内容，则必须将其保存在变量中。

# iphone - 如何连接 3 个 NSData 变量

> ID：12424628
> 
> 赞同：16
> 
> 时间：2012-09-14T12:31:13.860
> 
> 标签：iphone, ios, ios5, ios4

如何连接 3 个`NSData`变量？

```
NSData *iv;
NSData *salt;
NSData *encryptedData; 
```

我需要将这些加入到单个变量中。任何人都可以告诉我一个方法。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-14T12:35:18.243

使用`NSMutableData`对象和方法`-(void)appendData:(NSData *)otherData`

编辑添加示例：

```
NSMutableData *concatenatedData = [NSMutableData data];
[concatenatedData appendData:iv];
[concatenatedData appendData:salt];
[concatenatedData appendData:encryptedData];
// and now you have all of the data in the single variable "concatenatedData" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-02T20:46:25.223

对于那些为 iOS5 及更高版本编写代码的人。我想展示一些真正好的串联。为什么这些答案还不够好？因为它们涉及复制数据的额外内存使用。让我们看看答案：

```
NSMutableData *concatenatedData = [NSMutableData data];
[concatenatedData appendData:iv];
[concatenatedData appendData:salt];
[concatenatedData appendData:encryptedData]; 
```

在这里，我们为 分配了内存`iv`，`salt`而且`encryptedData` 每次我们将其中一个附加到可变连接时，我们显然是再次将其复制到可变数据中。我们在处理大数据时是否需要这些额外费用？我没有。

有一种方法可以避免这种不必要的内存开销——`dispatch_data` 我不打算解释它是如何工作的，如果你愿意，你可以用谷歌搜索它。我只是给你一个有效的代码：

```
NSData *iv = [@"some data" dataUsingEncoding:NSUTF8StringEncoding];
NSData *salt = [@"even more data" dataUsingEncoding:NSUTF8StringEncoding];
NSData *encryptedData = [@"and one more" dataUsingEncoding:NSUTF8StringEncoding];
dispatch_queue_t queue = dispatch_get_global_queue(0, 0);
dispatch_data_t dispatch_data_iv = dispatch_data_create([iv bytes], [iv length], queue, DISPATCH_DATA_DESTRUCTOR_DEFAULT);
dispatch_data_t dispatch_data_salt = dispatch_data_create([salt bytes], [salt length], queue, DISPATCH_DATA_DESTRUCTOR_DEFAULT);
dispatch_data_t dispatch_data_encrypted = dispatch_data_create([encryptedData bytes], [encryptedData length], queue, DISPATCH_DATA_DESTRUCTOR_DEFAULT);
iv = nil; salt = nil; encryptedData = nil; // free all parts, we dont need it anymore
dispatch_data_t dispatch_data_concat = dispatch_data_create_concat( dispatch_data_create_concat(dispatch_data_iv, dispatch_data_salt), dispatch_data_encrypted);
NSData *concatenatedNSData = DataFromDispatchData(dispatch_data_concat);

// lets check now if the concatenation works properly
NSString *stringFromConcatenatedNSData = [[NSString alloc]initWithData:concatenatedNSData encoding:NSUTF8StringEncoding];
NSLog(@"%@",stringFromConcatenatedNSData); 
```

不要忘记 helper-converter

```
NSData *DataFromDispatchData(dispatch_data_t data)
{
    NSMutableData *result = [NSMutableData dataWithCapacity: dispatch_data_get_size(data)];
    dispatch_data_apply(data, ^(dispatch_data_t region, size_t offset, const void *buffer, size_t size) {
        [result appendBytes:buffer length:size];
        return (_Bool)true;
    });
    return result;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:35:02.453

您可以使用`NSMutableData`'[`-appendData`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSMutableData_Class/Reference/NSMutableData.html#//apple_ref/occ/instm/NSMutableData/appendData%3a)方法：

```
NSMutableData *result = [NSMutableData data];

[result appendData:iv];
[result appendData:salt];
[result appendData:encryptedData];

// result now has what you need. 
```

这是使用可变数据的开销，这可能会更慢并使用更多内存，因此请谨慎使用。一般来说，您不希望 large`NSData`的浮动。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-09-14T12:42:41.250

先创建两个`NSObjects`，使用这个方法

```
-(void)appendData:(NSData *)otherData 
```

并在`NSData`稍后与 3rd`NSData`一起使用相同的方法连接。

# ruby-on-rails - Rails缓存：持续时间未到期

> ID：12424629
> 
> 赞同：0
> 
> 时间：2012-09-14T12:31:15.403
> 
> 标签：ruby-on-rails, caching

我的 HAML 视图中有这个：

```
- cache "home", :duration => 15.minutes do
...etc... 
```

但是等了15分钟后，页面还没有更新。看起来持续时间缓存不起作用......它可能是什么？我还需要做些什么才能在缓存上使用 :duration 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:35:18.260

尝试使用下面的哈希选项而不是`:duration`

```
:expires_in => 15.minutes 
```

# javascript - 在 chrome 扩展中获取选定的文本

> ID：12424631
> 
> 赞同：2
> 
> 时间：2012-09-14T12:31:35.137
> 
> 标签：javascript, google-chrome, google-chrome-extension

我想制作一个扩展程序来获取选定的文本并在谷歌翻译中搜索它，但我不知道如何获取选定的文本。

这是我的 manifest.json

```
{
"manifest_version": 2, 
"name": "Saeed Translate",
"version": "1",
"description": "Saeed Translate for Chrome",
 "icons": {
    "16": "icon.png"
  },
"content_scripts": [ {
      "all_frames": true,
      "js": [ "content_script.js" ],
      "matches": [ "http://*/*", "https://*/*" ],
      "run_at": "document_start"
   } ],
"background": {
    "scripts": ["background.js"]
  },
"permissions": [
"contextMenus",
"background",
"tabs"
]

} 
```

和我的 background.js 文件

```
var text = "http://translate.google.com/#auto/fa/";
function onRequest(request, sender, sendResponse) {
   text = "http://translate.google.com/#auto/fa/";
   text = text + request.action.toString();

 sendResponse({});
};

chrome.extension.onRequest.addListener(onRequest);
chrome.contextMenus.onClicked.addListener(function(tab) {
  chrome.tabs.create({url:text});
});
chrome.contextMenus.create({title:"Translate '%s'",contexts: ["selection"]}); 
```

和我的 content_script.js 文件

```
var sel = window.getSelection();
var selectedText = sel.toString();
chrome.extension.sendRequest({action: selectedText}, function(response) {
  console.log('Start action sent');  
}); 
```

如何获取选定的文本？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-11T03:45:49.460

你让它变得比实际上更复杂一些。您不需要在内容脚本和背景页面之间使用消息，因为 contextMenus.create 方法已经可以捕获选定的文本。尝试将您的创作脚本调整为：

```
chrome.contextMenus.create({title:"Translate '%s'",contexts: ["all"], "onclick": onRequest}); 
```

然后调整您的函数以简单地获取 info.selectionText：

```
function onRequest(info, tab) {
var selection = info.selectionText;
//do something with the selection
}; 
```

请注意，如果您想远程访问像谷歌翻译这样的外部网站，您可能需要调整您的权限设置。

# java - java的AtomicBitSet实现

> ID：12424633
> 
> 赞同：19
> 
> 时间：2012-09-14T12:31:38.493
> 
> 标签：java, concurrency

标准 api 不包括 AtomicBitSet 实现。我可以在 AtomicIntegerArray 上滚动我自己的，但我也不希望这样做。

有人知道根据与 Apache 2 兼容的许可证发布的现有实现吗？我只需要基本操作来设置和检查位。

编辑：

该代码对性能和内存都至关重要，因此我想尽可能避免同步或每个标志的整数。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-14T12:53:50.217

我将使用 AtomicIntegerArray，并且每个整数使用 32 个标志，这将为您提供与 BitSet 相同的密度，但不需要线程安全锁。

```
public class AtomicBitSet {
    private final AtomicIntegerArray array;

    public AtomicBitSet(int length) {
        int intLength = (length + 31) >>> 5; // unsigned / 32
        array = new AtomicIntegerArray(intLength);
    }

    public void set(long n) {
        int bit = 1 << n;
        int idx = (int) (n >>> 5);
        while (true) {
            int num = array.get(idx);
            int num2 = num | bit;
            if (num == num2 || array.compareAndSet(idx, num, num2))
                return;
        }
    }

    public boolean get(long n) {
        int bit = 1 << n;
        int idx = (int) (n >>> 5);
        int num = array.get(idx);
        return (num & bit) != 0;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:35:57.610

看看[http://www.javamex.com/tutorials/synchronization_concurrency_7_atomic_integer_long.shtml](http://www.javamex.com/tutorials/synchronization_concurrency_7_atomic_integer_long.shtml)

不完全使用 BitSet，而是使用 AtomicInteger。

# android - 如果没有可用的网络，如何阻止应用程序崩溃？

> ID：12424636
> 
> 赞同：0
> 
> 时间：2012-09-14T12:31:54.410
> 
> 标签：android

如何在此代码中设置请求超时？这是我的应用程序，如果 http 服务器没有响应或不可用的应用程序爆炸，它工作正常我如何在这个应用程序中设置请求超时？请帮我

```
public class AgAppHelperMethods   {

       private static final String LOG_TAG = null;

           private static AgAppHelperMethods instance = null;
public static   String[][] AgAppXMLParser( String parUrl) {

    String _node,_element;
    String[][] xmlRespone = null;
    try {

            String url = "www.xxxx.com";
            URL finalUrl = new URL(url);    

            DocumentBuilderFactory dbf =   
  DocumentBuilderFactory.newInstance();
            DocumentBuilder db = dbf.newDocumentBuilder();
            Document doc = db.parse(new 
    InputSource(finalUrl.openStream()));
            doc.getDocumentElement().normalize();

            NodeList list=doc.getElementsByTagName("*");
            _node=new String();
            _element = new String();
            xmlRespone = new String[list.getLength()][2];

            //this "for" loop is used to parse through the
            //XML document and extract all elements and their
            //value, so they can be displayed on the device

            for (int i=0;i<list.getLength();i++)
                {
                    Node value=list.item(i).      getChildNodes().item(0);
                    _node=list.item(i).getNodeName();
                    _element=value.getNodeValue();
                    xmlRespone[i][0] = _node;
                    xmlRespone[i][1] = _element;

                }

        }

 catch (Exception e)
 {

   Log.e(LOG_TAG, "Connection Error NET NOT WORKING", e);

 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:33:31.147

```
ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
            NetworkInfo info = cm.getActiveNetworkInfo();
            if (info != null) {
                if (!info.isConnected()) {
                    Toast.makeText(this,
                            "Please check your internet connection and try again.",
                            Toast.LENGTH_LONG).show();

                }
                else {
//do your stuff
}
} 
```

你也必须有这个权限

```
 <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

# jenkins - 从哪里可以下载 Jenkins build-pipeline-plugin？

> ID：12424637
> 
> 赞同：1
> 
> 时间：2012-09-14T12:32:01.117
> 
> 标签：jenkins, continuous-deployment

我正在尝试找到可以下载最新版本 Jenkins 构建的位置

管道插件[https://wiki.jenkins-ci.org/display/JENKINS/Build+Pipeline+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Build+Pipeline+Plugin)但我

无法这样做。我签出代码并在我的系统上构建它，但是当我安装

插件它没有向我显示构建管道的视图选项。如果可以的话会很有帮助

帮我找到插件的位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T06:52:24.140

查看 Jenkins 的[下载服务器](http://mirrors.jenkins-ci.org)。在那里你会找到所有 Jenkins 版本和插件的可用下载：

[http://mirrors.jenkins-ci.org/plugins/build-pipeline-plugin/latest/](http://mirrors.jenkins-ci.org/plugins/build-pipeline-plugin/latest/)

# facebook-graph-api - 如何计算 iOS sdk 中 Facebook 好友的数量？

> ID：12424640
> 
> 赞同：4
> 
> 时间：2012-09-14T12:32:18.963
> 
> 标签：facebook-graph-api, random, count, userid

我试图弄清楚如何从我的朋友那里获得一个随机的用户 ID。

有没有办法用“friendPickerController”做到这一点？我发现的唯一“计数”方法是在选择中，这无济于事。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-04T08:16:42.340

您可以使用以下方法获取总朋友数

```
FBRequest* friendsRequest = [FBRequest requestForMyFriends];
[friendsRequest startWithCompletionHandler: ^(FBRequestConnection *connection,
                                  NSDictionary* result,
                                  NSError *error) {
    NSArray* friends = [result objectForKey:@"data"];

    NSLOG(@"Total Friend :%@",friends.count);
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T07:45:15.287

只是更新以防万一这对任何人都有帮助。虽然 Dipak 的回答最终对我来说完美无缺，但直到我添加了检索计数的权限后才起作用。我在 Dipak 的代码之前添加了以下代码行，它返回了正确的朋友数。

```
NSArray *permissions = [NSArray arrayWithObjects:@"friends_about_me", nil];
[FBSession openActiveSessionWithReadPermissions:permissions
                                       allowLoginUI:YES
                                  completionHandler:^(FBSession *session, FBSessionState status, NSError *error) {

                                  }];

[FBSession setActiveSession:[FBSession activeSession]]; 
```

# android - 请帮我把两张图片变成 9-patch

> ID：12424641
> 
> 赞同：0
> 
> 时间：2012-09-14T12:32:26.577
> 
> 标签：android, android-layout

设计师给了我两张 PNG 图像，它们应该是我应用程序所有按钮的背景。我无法将其转换为 9-patch 图像。似乎一张图像的细节太多而不能成为一个 9-patch，拉伸它会使其失去细节。

你们可以看看，让我知道你的想法吗？

[http://img211.imageshack.us/img211/1965/background1p.png](http://img211.imageshack.us/img211/1965/background1p.png)

[http://img845.imageshack.us/img845/676/background2a.png](http://img845.imageshack.us/img845/676/background2a.png)

非常感谢，费利佩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:51:18.520

//重复图像.xml

```
<?xml version="1.0" encoding="utf-8"?>
    <bitmap
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:src="@drawable/tileimage"
    android:tileMode="repeat"
    android:dither="true" >

</bitmap> 
```

并将此图像在您的布局背景中设置为

`android:background="@drawable/repeatimage"`

//把你的图片切成小块

![在此处输入图像描述](../Images/2955ec0f932fb50fadd599a9028904ac.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-15T09:07:48.533

也许您应该查看本教程：[http](http://www.thesecretpie.com/2010/07/creating-custom-fancy-buttons-in.html) ://www.thesecretpie.com/2010/07/creating-custom-fancy-buttons-in.html 它解释了 9-patch 的实际工作原理以及如何使用 Android 附带的 drow9patch 工具开发工具包。这对我来说真的很有用。对于阴影，您只需要保存具有透明背景的图像（当然）并在图像的阴影和边缘之间留出一点空闲空间，您将使用它来为 9-patch 绘制线条

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:49:13.183

尝试使用[此工具](http://android-ui-utils.googlecode.com/hg/asset-studio/dist/nine-patches.html)。这是一个简单的 9 补丁生成器，对您有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T12:53:22.903

对于您的两个问题：

1：我经常使用带有阴影的图像，您当然可以将它们转换为 9-patch 图像。我不确定如何解释创建它所涉及的实际步骤。也许一个例子可以帮助你解决这个问题。

![在此处输入图像描述](../Images/d81d55122738b55d0c69e2decefef317.png)

2：对于其中带有图案的图像，*@Padma Kumar*指出的 9 个补丁仍然会扭曲您的图像。要解决此问题，您可以点击随附的链接。这是一个关于如何使用平铺图案作为背景的很好的教程。[http://androidforbeginners.blogspot.in/2010/06/how-to-tile-background-image-in-android.html](http://androidforbeginners.blogspot.in/2010/06/how-to-tile-background-image-in-android.html)

附注：draw9patch 可能是一个令人生畏的工具。在你掌握它的窍门之前，你可以考虑在这里使用这个网站：[http](http://android-ui-utils.googlecode.com/hg/asset-studio/dist/nine-patches.html) ://android-ui-utils.googlecode.com/hg/asset-studio/dist/nine-patches.html 。但是，它仅适用于 Google Chrome。

# php - 在 php 电子邮件中使用变量

> ID：12424643
> 
> 赞同：-2
> 
> 时间：2012-09-14T12:32:28.853
> 
> 标签：php, html, email

我正在使用谷歌从一个随机数生成我的二维码。生成此数字，然后将其存储为变量。但我想在电子邮件中的图像链接中使用它。像这样的东西，其中 $random 是我的变量：谢谢

```
 $message = '<html>
               <head>
                  <title></title>
               </head>
               <body>
                 <img src="http://chart.apis.google.com/chart?chs=250x250&cht=qr&chld=L|1&chl=$random" />
               </body>
             </html>'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:36:26.850

```
$message = '<html>
               <head>
                  <title></title>
               </head>
               <body>
                 <img src="http://chart.apis.google.com/chart?chs=250x250&cht=qr&chld=L|1&chl=' . $random . '" />
               </body>
             </html>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:37:45.003

```
$message = 'Your text with ' . $random . ' string'; 
```

或者

```
$message = "Your text with $random string"; 
```

或者

```
$message = "Your text with <a href=\"$random\">string</a>"; 
```

我强烈建议在开始编程之前阅读所选语言的[基础知识](http://us2.php.net/manual/en/language.types.string.php)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:39:47.633

尝试

```
$message = "<html>
           <head>
              <title></title>
           </head>
           <body>
             <img src=\"http://chart.apis.google.com/chart?chs=250x250&cht=qr&chld=L|1&chl={$random} \" />
           </body>
         </html>"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:39:21.080

```
$message = '<html>
               <head>
                  <title></title>
               </head>
               <body>
                 <img src="http://chart.apis.google.com/chart?chs=250x250&cht=qr&chld=L|1&chl=<?php echo $random; ?>" />
               </body>
             </html>'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T12:40:47.933

PHP 中不同的引号以不同的方式工作。单引号不评估直接写在字符串中的变量，所以你必须关闭引号并用它来 cat 变量：`echo 'variable: '.$variable.'.';`

双引号确实会评估字符串内的变量，因此`echo "variable: $variable.";`会打印与上面相同的内容。

你应该使用`$message = '...1&chl='.$random.'" />...';`

# c# - ASP.NET C#将文本框中的值写入标签：初学者简单

> ID：12424648
> 
> 赞同：2
> 
> 时间：2012-09-14T12:32:44.503
> 
> 标签：c#, asp.net, textbox, document.write

我试图找到一个非常简单的语法示例，以简单地将输入的值写入文本框中，并将该值放入标签 onclick。我想尽可能基本。我只提到了 asp.net，因为我想用一个 aspx 页面来做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:50:37.217

在 aspx 页面中

```
<asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Button" />
        <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
        <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label> 
```

并在cs文件中

```
protected void Button1_Click(object sender, EventArgs e)
        {
            Label1.Text = TextBox1.Text;
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:50:36.147

`Label`没有服务器`OnClick`事件。

你可以使用一个按钮：

```
void [ButtonID]_OnClick(object sender, EventArgs e) 
{    
   [LabelID].Text = [TextBoxID].Text; 
} 
```

将方括号内的值替换为真实 ID。

或者你可以使用 Javascript，但那是另一回事了！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:52:58.973

这页纸：

```
<%@ Page Title="Home Page" Language="C#" MasterPageFile="~/Site.master" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="WebApplication1._Default" %>

<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
<asp:Label ID="MyLabel" runat="server">Hello World</asp:Label>
<br />
<asp:TextBox ID="MyTextBox" runat="server" />
<br />
<asp:Button ID="MyBtn" runat="server" Text="Click Me" OnClick="MyBtn_Clicked" />
</asp:Content> 
```

后面的代码：

```
namespace WebApplication1
{
   using System;

   public partial class _Default : System.Web.UI.Page
   {
       protected void Page_Load(object sender, EventArgs e)
       {

       }

       protected void MyBtn_Clicked(object sender, EventArgs args)
       {
           this.MyLabel.Text = this.MyTextBox.Text;
       }
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T12:04:39.860

```
namespace WebApplication1
{
   using System;

   public partial class _Default : System.Web.UI.Page
   {
       protected void Page_Load(object sender, EventArgs e)
       {

       }

       protected void MyBtn_Clicked(object sender, EventArgs args)
       {
           this.MyLabel.Text = this.MyTextBox.Text;
       }
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-27T18:18:02.630

```
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class CodeBehind : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Button1_Click(object sender, EventArgs e)
    {
        Label1.Text = TextBox1.Text;
    }
} 
```

# android - 使用 android 插入联系人并查询结果 uri 不返回任何条目

> ID：12424650
> 
> 赞同：0
> 
> 时间：2012-09-14T12:33:04.690
> 
> 标签：android, contacts, android-contentprovider, contactscontract

我正在开发一个处理 android 联系人 API 的应用程序。我实现了插入、更新和查询联系人的方法。到目前为止一切正常（写和读联系人）。

在我的项目中的某个时刻，我遇到了一种奇怪的行为。

1.  我使用批处理模式插入联系人。我收到了 RawContact 的 URI。我在后台线程中执行此操作。

```
 ArrayList<ContentProviderOperation> ops = new  ArrayList<ContentProviderOperation>();      
                    int rawContactInsertIndex = ops.size();  
                    // create rawContact  
                    ops.add(ContentProviderOperation.newInsert(RawContacts.CONTENT_URI)
                                        .withValue(RawContacts.ACCOUNT_TYPE, ConstantsContract.ACCOUNT_TYPE)
                                        .withValue(RawContacts.ACCOUNT_NAME, accountName).build());
                    ops.add(createInsertOperation().withValueBackReference(Data.RAW_CONTACT_ID, rawContactInsertIndex)
                                    .withValue(Data.MIMETYPE, StructuredName.CONTENT_ITEM_TYPE)
                                    .withValue(StructuredName.DISPLAY_NAME, displayName).withValue(StructuredName.GIVEN_NAME, firstName)
                                    .withValue(StructuredName.FAMILY_NAME, lastName).build());      

        ContentProviderResult[] results = context.getContentResolver().applyBatch(ContactsContract.AUTHORITY, ops);
if (results.length > 0) {
    result = results[0];
} 
```

1.  然后我请求并存储查找 uri

```
RawContacts.getContactLookupUri(this.getContentResolver(), myContantRawContactUri); 
```

1.  我可以在插入后直接使用 rawContactUri 查询联系人（在同一个线程中）。查找 uri 返回 null。

```
 Uri rawContactUri = appUser.getRawContactUri(ctx);
    if (rawContactUri == null) {
                return null;
            }

String lastPathSegment = rawContactUri.getLastPathSegment();
                long rawContactId = Long.decode(lastPathSegment);
                if (rawContactUri != null) {
                    contact = readContactWithID(rawContactId, ContactsContract.Data.RAW_CONTACT_ID); 
```

1.  在项目的另一个地方，我想查询我通过存储的查找 uri 或原始联系人 uri 插入的联系人。两者都没有从内容提供者返回任何行。我在主线程和另一个后台线程中尝试过。

```
ctx.getContentResolver().query(ContactsContract.Data.CONTENT_URI, null,   ContactsContract.Data.RAW_CONTACT_ID + " = ? AND " + ContactsContract.Data.MIMETYPE + " =   ?", new String[] { contactID + "",   ContactsContract.CommonDataKinds.StructuredName.CONTENT_ITEM_TYPE }, null); 
```

我的第一个想法是它可能与 context.getContentResolver() 有关。但是 android 文档指出，ContentResolver 对象范围是应用程序的包，因此您拥有整个应用程序的 ContentResolver。我对吗？

我究竟做错了什么？为什么相同的 rawContactUri 在一个地方返回联系人而在另一个地方没有？为什么我会从一个根本不起作用的原始联系人那里得到一个查找 uri？

**更新：** 我使用 sqlite 分析了数据库。当我插入联系人时，会创建 raw_contacts 和 contacts 中的行。已删除标志设置为 0，因此未将其标记为删除。如果我随后在应用程序的另一个位置读取联系人，它会返回 null。此时的数据库转储不再包含联系人的行。

**更新 2：** 我在 2.3.3、4.0 和 4.1 版本中使用模拟器测试了我的应用程序。所描述的行为仅出现在 4.1 Jelly Bean 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-22T15:54:31.563

好的，我找到了解决方案。其实是我自己的错。在将自定义帐户添加到 AccountManager 之前，我添加了一个联系人。这显然删除了联系人，因为它设置了相同的帐户类型。

# javascript - 检索原始 html 实体（十进制）值作为字符串

> ID：12424653
> 
> 赞同：1
> 
> 时间：2012-09-14T12:33:09.070
> 
> 标签：javascript, jquery, html, encoding

> **可能重复：**
> [如何制作 ibeer、imilk、ibug、ibeer 等 iPhone 应用程序](https://stackoverflow.com/questions/885152/how-to-make-iphone-apps-like-ibeer-imilk-ibug-ibeer)
> [使用 javascript 获取原始 html 代码](https://stackoverflow.com/questions/3905219/use-javascript-to-get-raw-html-code)

假设我有一个这样的 html 部分：

```
<div id="post_content">
  <span>&#9654;<span>
</div> 
```

（这是右指向三角形）

我想将“post_content”的子元素作为原始html，即作为与上面代码完全相同的字符串，所以：

```
"<span>&#9654;<span>" 
```

当我做

```
$('#post_content').html() 
```

跨度获取的内容似乎已转换为其他内容，例如，当我使用 $.post() 发布它时，它变成了 %E2%96%B6。

如何将 post_content 的内容作为与原始字符串完全相同的字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:36:52.627

看看这里：

[如何使用 jQuery 解码 HTML 实体？](https://stackoverflow.com/questions/1147359/how-to-decode-html-entities-using-jquery)

基本上使用：

```
var decoded = $("<div/>").html(encodedStr).text(); 
```

会给你你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T14:32:10.727

你不能，正如[这个出色的答案](https://stackoverflow.com/a/3905503/885152)中所解释的那样，接收到的 HTML 被解析成一个 DOM，只有它可用于脚本。您只能从`responseText`XMLHttpRequest 中获取纯文本。

如果您`innerHTML`从 DOM 中获取 （做什么`$el.html()`），它将被序列化。HTML5[指定了如何做到这一点](http://www.w3.org/TR/html5/serializing-html-fragments.html)，但旧版浏览器通常不兼容。

你的问题`$.post()`是这个方法在 HTTP 请求中发送文本 - 当然是编码的。您看到的只是`encodeURIComponent`应用于您获得的 Unicode 字符串。尝试`alert()`或`console.log()`取值，你会看到它的真实表现。

# php - 在 php 中管理所有人的会话

> ID：12424657
> 
> 赞同：0
> 
> 时间：2012-09-14T12:33:19.703
> 
> 标签：php, session, session-state, session-cookies

我有一个会话变量 $_SESSION['random'] 和一个页面 home.php .home.php 包含一个 div 自动刷新并显示一个随机数，这个数字放入 $_SESSION['random'] 数组中。再次任何从 1 到 50 的数字拉取并放入 $_SESSION['random'] 变量中。我的问题是，如果任何 user1 打开 home.php 并且从范围中拉出 10 个数字并放入 $_SESSION['random'] ，如果任何 user2 打开该页面 hoem.php 那么这个 colud 不是从初始开始的，user2 也有10 号，因为它们是拉出的。如果可能在会议中，如果那么如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:00:50.517

您应该将最后一个拉入数据库的号码存储起来，并将 +1 no 分配给下一个用户，如果该号码大于 50，则将其重置为零。

如果不使用数据库，您将无法执行此操作

# java - Flex - Java 字节到 mp3

> ID：12424659
> 
> 赞同：1
> 
> 时间：2012-09-14T12:33:24.813
> 
> 标签：java, actionscript-3, apache-flex, flex4.5, lame

我在将字节转换为 .mp3 声音文件时遇到问题。在我的情况下，我使用 FileOutputStream 使用它的 write(bytes) 方法来完成它，但它只是创建一个带有 mp3 扩展名的数据文件，但我无法在我的 PC 上的任何播放器中播放它。

注意：我从 Flex Michrophone 录制它并将 ByteArray 发送到 java。

我应该使用哪些库在 java 中添加 mp3 声音文件头等？

更新：我什至无法将我的原始数据转换为 java sound api 支持的 Wave 格式。它为我创建了带有录制声音但有噪音的声音 - 问题出在哪里？

这是我的波形代码：

```
AudioFormat format = new AudioFormat(Encoding.PCM_SIGNED, 44100, 16, 2, 2, 44100, true);

ByteArrayInputStream bais = new ByteArrayInputStream(bytes);
AudioInputStream stream = new AudioInputStream(bais, format, bytes.length/format.getFrameSize());

AudioSystem.write(stream, AudioFileFormat.Type.WAVE, new File(path+"zzz.wav")); 
```

我的音频格式有什么问题？？？我必须在 MP3 盒中使用哪一个？！

紧急求助！任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:44:01.623

仅将原始字节写入扩展名为 .mp3 的文件并不会神奇地将数据转换为 MP3 格式。您需要使用编码器对其进行压缩。

谷歌快速搜索发现[LAMEOnJ](http://openinnowhere.sourceforge.net/lameonj/)，它是流行的[LAME](http://lame.sourceforge.net/) MP3 编码器的 Java API。

# html - vim omni-complete 可以删除我之前选择的单词吗？

> ID：12424666
> 
> 赞同：2
> 
> 时间：2012-09-14T12:33:56.310
> 
> 标签：html, vim, omnicomplete

我正在用 gvim 编写 HTML，但让我烦恼的是，omni-complete 总是删除我以前的单词，甚至是我以前选择的单词。

例如，假设我正在编写以下代码**（'_' 表示光标，此后）**：

```
<a style="_" ></a> 
```

按^X-^O后，弹出提示列表，我选择“颜色：”

```
<a style="color:_" > 
```

然后我再次按^X-^O，它确实弹出了正确的提示（“rgb（”，“#”），但同时删除了前一个单词，如下所示：

```
<a style="rgb(_" > 
```

谁能给我一些帮助？非常感谢。这是我的 gvimrc：

```
set guifont=文泉驿等宽微米黑\ 14
colorscheme neverness_modified
set number
set guioptions-=T
winpos 0 0
set columns=1000 
set lines=1000
set fileencodings=utf-8,gb18030
set smartindent
set tabstop=4
set shiftwidth=4
set expandtab
filetype on
filetype indent on
syntax on
set cindent
set completeopt+=longest

function Maximize_Window()
    silent !wmctrl -r :ACTIVE: -b add,maximized_vert,maximized_horz
endfunction

" ========================
" TagList
" ========================

set tags+=/home/fish47/.vim/tags/STL.tags

" ========================
" TagList
" ========================

let Tlist_Show_One_File=1
let Tlist_Exit_OnlyWindow=1

" ========================
" WinManager
" ========================

let g:winManagerWindowLayout='FileExplorer|TagList'
WMToggle

" ========================
" OmniCppComplete
" ========================

set nocp
filetype plugin on
let OmniCpp_SelectFirstItem=2
let OmniCpp_MayCompleteDot=1
let OmniCpp_MayCompleteArrow=1
let OmniCpp_MayCompleteScope=1

set showcmd

autocmd FileType css set omnifunc=csscomplete#CompleteCSS
autocmd FileType html set omnifunc=htmlcomplete#CompleteTags 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T14:34:09.870

这是`htmlcomplete.vim`脚本中的一个错误。`<Space>`正如 romainl 所指出的，您可以通过在属性和值之间插入一个来解决此问题。

请向脚本作者 Mikolaj Machowski 提交错误报告（基本上是此页面的链接）；他的电子邮件地址在脚本的标题中；该脚本位于`autoload/htmlcomplete.vim`Vim 安装目录中。

由于最后一次更改是从 2011 年 4 月开始，因此作者很有可能仍在维护它。如果您没有收到回复，请告知 vim_dev 邮件列表（cp. [http://www.vim.org/community.php](http://www.vim.org/community.php)；您需要先注册）；希望，其他人会拿起它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T03:56:46.990

让 csscomplete.vim 来处理 html 补全可能是我的问题的解决方案。您可以通过在 gvimrc 中添加“autocmd FileType html set omnifunc=csscomplete#CompleteCSS”来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-04T04:24:56.450

对于较新版本的 vim，这是一个错误和回归。这个 csscomplete.vim 插件是为早期版本编写的，而您使用较新版本时，会出现意外的回归。

如果你破解插件，你会看到删除发生，因为它反向移动光标以寻找最明显的上下文，并且反向光标移动被你的 vim 解释为擦除。

对我来说，错误在于以下几行：

```
...
let compl_begin = col('.') - 2
while start >= 0 && line[start - 1] =~ '\%(\k\|-\)' 
  let start -= 1 
endwhile 
```

所以是的，你的问题是：命名的变量`start`通过omnifunc传递回vim，vim用于保持现有文本原样，但新版本将该动作解释为擦除。

因此，更改断言连字符的第二个 while 子句条件，现在您就可以参加比赛了。但这暴露了一个新问题，当 csscomplete.vim 陷入困境时，键入字母并启动omnifunc 会变慢。但是，嘿，一次一个问题，呵呵。

这就像买一辆方向盘安装在车顶上的汽车。就像是的，那是行不通的。但这是 Vim，如果你不是为了低级黑客而参与其中，那么你就在错误的机器车间。

# php - 发布数据时需要php名称属性吗？

> ID：12424672
> 
> 赞同：2
> 
> 时间：2012-09-14T12:34:09.137
> 
> 标签：php, xhtml

我昨天刚开始学习php，对下面的示例代码有疑问。

```
<form action='action.php' method='post'>
    <input type='text' name='foo' />
</form> 
```

还有我的 action.php：

```
<?php
    $foo = htmlspecialchars($_POST['foo']);
    echo $foo;
?> 
```

所以，我的问题是：现在，使用 php 访问 html 元素的唯一方法似乎是通过“name”属性。这是真的？还是有另一种方法可以做到这一点？我主要是问，因为我知道该属性在 xhtml 中已被弃用，所以我正在寻找解决方法。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:40:50.300

根据 W3C，该`name`属性在 XHTML 中不被弃用：

[HTML 输入标签](http://www.w3schools.com/tags/tag_input.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:42:24.030

`name`属性仅在`<a>`种类元素中被弃用，请随意在表单中使用它：它是生成`application/x-www-form-urlencoded`HTTP 请求的关键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:38:37.373

在 $_POST 你只能得到名称和值，你可以这样做：

```
echo '<pre>';
print_r($_POST);
echo '</pre>'; 
```

为了更好地了解这些信息是如何在您的 PHP 代码中提供给您的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:47:56.093

该`name`属性仅在`form`标签本身上被弃用（在这个问题的上下文中，就是！）

# ruby-on-rails - RSpec Rails 打印未定义的 home_path 错误

> ID：12424675
> 
> 赞同：1
> 
> 时间：2012-09-14T12:34:29.863
> 
> 标签：ruby-on-rails, rspec, undefined, nameerror

当我在我的 rails 项目上运行 rspec 时，我收到一条非常烦人的错误消息，尽管之前的代码完全相同。我唯一做的就是添加一个新的 rspec 文件。现在，新的 rspec 文件除了“require 'spec_helper'”之外不包含任何内容，但我仍然收到此消息（以及其他一些消息......）：

> 1) 主页应该有 'Lists' 和 'Students' 链接失败/错误：访问 home_path NameError: undefined local variable or method `home_path' for > #<RSpec::Core::ExampleGroup::Nested_2:0x00000004c455a0> # ./spec/requests/homes_spec.rb:5:in`block (2 levels) in '

我不知道现在该怎么办。有谁知道这是怎么回事？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:49:16.020

根据您的路线，适当的助手将是`home_index_path`. 尝试使用它。

# gwt - 为一场战争收集多个 gwt 模块

> ID：12424677
> 
> 赞同：1
> 
> 时间：2012-09-14T12:34:35.070
> 
> 标签：gwt, maven

我有多模块结构的项目，像这样

```
root
|
core
  |
  core-services
  |
  core-gwt-ui
|
some-like-core-modules
|
root-war 
```

**root-war**这是将所有其他模块*jar*压缩到一个*.war*的模块。当 maven 构建**core-gwt-ui**时，我将在*src.main中获得***webapp**目录。与另一个模块是同样的故事。

 *那么，如何调整*root-war.pom*以将所有 gwt 构建结果收集到一场**战争中**？

这是我构建**core-gwt-ui 的maven 插件配置**

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>gwt-maven-plugin</artifactId>
    <executions>
        <execution>
            <goals>
                <goal>compile</goal>
            </goals>
        </execution>
    </executions>
    <configuration>
        <inplace>true</inplace>
        <runTarget>sample.client.Sample25/Sample25.html</runTarget>
    </configuration>
</plugin> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T14:11:35.197

您有 2 个选择：

1.  您可以在每个项目中*gwt:compile*您的应用程序，在这种情况下，它们最好是您在*root-war中使用覆盖的 WAR*

2.  或者您只需将源代码和类打包并在*root-war中执行一个大的**gwt:compile*。*

# java - 如何使 TeamCity 构建参数动态化？

> ID：12424683
> 
> 赞同：4
> 
> 时间：2012-09-14T12:34:47.730
> 
> 标签：java, version-control, teamcity

我的情况是：

*   我有一些代码修改（在 SVN 中）
*   我有一些针对不同应用程序的构建配置
*   我在另一个应用程序（Zookeeper）中有一个地图，它知道我现在要构建哪些修订版

我希望 TeamCity 在构建过程开始时动态更新构建参数。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T13:28:59.493

我在类似的问题中找到了答案[如何从构建步骤永久更改 TeamCity 6 中的系统属性](https://stackoverflow.com/questions/9789030/how-to-permanently-change-a-system-property-in-teamcity-6-5-from-a-build-step)

这是配方： [从构建步骤添加或更改构建参数](http://confluence.jetbrains.net/display/TCD65/Build+Script+Interaction+with+TeamCity#BuildScriptInteractionwithTeamCity-AddingorChangingaBuildParameterfromaBuildStep "从构建步骤添加或更改构建参数")

# asp.net - 在 javascript 和 c# 中使用 AES 加密

> ID：12424684
> 
> 赞同：0
> 
> 时间：2012-09-14T12:34:53.970
> 
> 标签：asp.net, encryption, aes

我正在尝试在 javascript 中加密一个字符串，然后使用 c# 在服务器中将其解密。我想在服务器端使用 System.Security.Cryptography.Rijndael 并在客户端使用一些像[这样](http://point-at-infinity.org/jsaes/)或[这样](http://www.movable-type.co.uk/scripts/aes.html)的 AES 实现。

我对密码学知之甚少，所以基本上我生成一个密钥并将其发送给客户端并用该密钥加密我的文本并将其发送回服务器。

我的问题是 Javascript AES 实现使用密钥来加密文本，但 c# Rijndael 类使用密钥和向量。该向量来自哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:42:41.697

AES 只是一个*分组密码*，它是一种密码原语。其目的是加密单个数据块（16 字节）。

加密需要的远不止这些。您需要一种方法来加密任意数量的数据，并且希望以一种不会泄露任何信息的方式。为此，您需要将数据量分成块，将最后一部分填充为一个完整的块，然后以某种巧妙的方式加密每个块。这样做是*加密模式*的职责。

最简单的模式（电子食谱，ECB），只是用相同的密钥加密每个块，但这非常危险。其他模式需要某种初始化状态，它需要是随机的，但可以公开。

要加密和解密您的数据，您必须同时了解分组密码*和*加密模式，并且您必须找到一种方法在加密端生成初始状态并在解密端恢复它以初始化编码器和解码器，分别。

简而言之：你需要更多关于你在做什么的信息！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T12:17:43.373

这可能不是您正在寻找的。但我可以认为你真正需要做的是实现 SSL。

[http://en.wikipedia.org/wiki/Secure_Sockets_Layer](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)

这可能会解决您的问题，而无需参与编码密码学。

# python - 模拟补丁方法和属性

> ID：12424686
> 
> 赞同：1
> 
> 时间：2012-09-14T12:35:08.010
> 
> 标签：python, mocking, patch

我想修补方法返回的数据的属性。

假设我有以下简化的代码：

```
@patch('requests.post')
class TestKeywordsApi(BaseTest):
    # Instantiate API class and set the apikey
    def setUp(self):
        BaseTest.setUp(self)
        self.fixtures = FIXTURES
        self.api = BaseApi()

    def mock_requests_post(self, url, data=None):
        ''' Mock method for post method from responses library.
            It replaces the responses.post calls in Api class.
        '''
        url = self.encode_url(url, data)
        if url:
            return self.fixtures[url]

    def test_save_success(self, mock_post):
        mock_post.side_effect = self.mock_requests_post

        response = self.api.post(keyword, params={...})

        # list of asserts

# original class calling requests.post    
import requests
class BaseApi(object):
    def post(self, action, params):
        ''' Sends a POST request to API '''
        response = requests.post(self.build_url(action), data=params).content 
```

上面的代码失败，因为模拟方法没有为请求库中存在的“内容”属性提供模拟/存根。有谁知道如何存根内容属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T06:23:43.643

您的模拟 post 函数需要返回一个更像`requests`' 响应对象的对象，一个具有`.content`属性的对象。例如：

```
from mock import Mock, patch
#[...]
def mock_requests_post(self, url, data=None):
    ''' Mock method for post method from responses library.
        It replaces the responses.post calls in Api class.
    '''
    mock_response = Mock()
    mock_response.content = 'my test response content'
    url = self.encode_url(url, data)
    if url:
        mock_response.url_called = self.fixtures[url]
    return mock_response 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T12:48:59.347

我找到了以下解决方案，它只修改了 mock_requests_post 方法，添加了一个具有我需要的属性的内部类：

```
def mock_requests_post(self, url, data=None):
    ''' Mock method for post method from responses library.
        It replaces the responses.post calls in Api class.
    '''
    url = self.encode_url(url, data)

    class classWithAttributes(object):
        content = json.dumps(self.fixtures[url])

    if url:
        return classWithAttributes() 
```

# ios - UIGraphicsGetCurrentContext 似乎返回 nil

> ID：12424690
> 
> 赞同：20
> 
> 时间：2012-09-14T12:35:34.377
> 
> 标签：ios, pdf

我在这里尝试将单个 PDF 页面转换为 PNG，并且它运行良好，直到 UIGraphicsGetCurrentContext 突然开始返回 nil。

我试图在这里追溯我的步骤，但我不太确定我知道这发生在什么时候。我的帧不是 0，我认为这可能会产生这个问题，但除此之外，一切“看起来”都是正确的。

这是我的代码的开头。

```
_pdf = CGPDFDocumentCreateWithURL((__bridge CFURLRef)_pdfFileUrl);
CGPDFPageRef myPageRef = CGPDFDocumentGetPage(_pdf, pageNumber);
CGRect aRect = CGPDFPageGetBoxRect(myPageRef, kCGPDFCropBox);
CGRect bRect = CGRectMake(0, 0, height / (aRect.size.height / aRect.size.width), height);
UIGraphicsBeginImageContext(bRect.size);
CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSaveGState(context); 
```

有人知道还有什么可能导致零上下文吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2014-03-11T20:29:55.310

它不必从“drawRect”中调用。你也可以在“UIGraphicsBeginImageContext(bRect.size);”之后调用它

签入以下行

```
UIGraphicsBeginImageContext(bRect.size); 
```

如果 bRect.size 不是 0,0

就我而言，这就是下一行返回的上下文为空的原因。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-09-14T12:43:02.283

您是否在 drawRect 方法中调用 UIGraphicsGetCurrentContext() ？据我所知，它只能在drawRect中调用，否则它只会返回nil。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-14T21:01:49.477

实际上，在 drawRect 方法中设置 CGContextRef 对象后，它是可以重用的。关键是 - 您需要在从任何地方使用 Context 之前将其推送到堆栈。否则，当前上下文将为 0x0
1。添加

```
@interface RenderView : UIView {
    CGContextRef visualContext;
    BOOL renderFirst;
} 
```

2\. 在您的@implementation 中，在视图出现在屏幕上之前先将 renderFirst 设置为 TRUE，然后：

```
-(void) drawRect:(CGRect) rect {
  if (renderFirst) {
      visualContext = UIGraphicsGetCurrentContext();
      renderFirst = FALSE;
  }
} 
```

3\. 设置上下文后将某事渲染到上下文。

```
-(void) renderSomethingToRect:(CGRect) rect {
   UIGraphicsPushContext(visualContext);
   // For instance
   UIGraphicsPushContext(visualContext);
   CGContextSetRGBFillColor(visualContext, 1.0, 1.0, 1.0, 1.0);
   CGContextFillRect(visualContext, rect);
} 
```

这是一个与线程案例完全匹配的示例：

```
- (void) drawImage: (CGImageRef) img inRect: (CGRect) aRect {
    UIGraphicsBeginImageContextWithOptions(aRect.size, NO, 0.0);
    visualContext = UIGraphicsGetCurrentContext();
    CGContextConcatCTM(visualContext, CGAffineTransformMakeTranslation(-aRect.origin.x, -aRect.origin.y));
    CGContextClipToRect(visualContext, aRect);
    CGContextDrawImage(visualContext, aRect, img);
    // this can be used for drawing image on CALayer
    self.layer.contents = (__bridge id) img;
    [CATransaction flush];
    UIGraphicsEndImageContext();
} 
```

并从之前在这篇文章中拍摄的上下文中绘制图像：

```
-(void) drawImageOnContext: (CGImageRef) someIm onPosition: (CGPoint) aPos {
    UIGraphicsPushContext(visualContext);
    CGContextDrawImage(visualContext, CGRectMake(aPos.x,
                    aPos.y, someIm.size.width,
                    someIm.size.height), someIm.CGImage);
} 
```

在需要上下文来呈现对象之前，不要调用 UIGraphicsPopContext() 函数。
当调用方法完成时，似乎 CGContextRef 正在从图形堆栈的顶部自动删除。
无论如何，这个例子似乎是一种 Hack——不是 Apple 计划和提出的。该解决方案非常不稳定，仅适用于屏幕顶部的一个 UIView 内的直接方法消息调用。在“执行选择”调用的情况下，上下文不会将任何结果呈现到屏幕上。因此，我建议使用 CALayer 作为屏幕目标的渲染，而不是直接使用图形上下文。
希望能帮助到你。

# c# - 在使用速记样式初始化对象（ClientCredentials）期间设置属性的属性？

> ID：12424692
> 
> 赞同：-3
> 
> 时间：2012-09-14T12:35:38.120
> 
> 标签：c#

返回简单对象时，我习惯了下面的语法。它更容易、更短、更干净、更整洁。

```
return Stuff{ Prop1 = "a", Prop2 = 5 }; 
```

但是，由于某种原因，我不能`ClientCredentials`以相同的方式实例化。我想指定`UserName`属性，但智能感知只是给了我一大堆令人困惑的东西，我不知道该怎么办。而且我要找的房子不在那里。我认为这种语法是推荐的和标准的……什么给出了？

编辑：

我想使用以下语法：

```
return ClientCredentials
{ 
  UserName.Password = "abc123",
  UserName.UserName = "server\\user"
}; 
```

代替：

```
ClientCredentials clientCredentials = new ClientCredentials();
clientCredentials.UserName.UserName = "server\\user";
clientCredentials.UserName.Password = "abc123";
return clientCredentials; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:45:04.883

[在此处](http://msdn.microsoft.com/en-us/library/system.servicemodel.description.clientcredentials.username.aspx)查看 MSDN 文章

它说 UserName 属性是一个只有一个 get 访问器的[类。](http://msdn.microsoft.com/en-us/library/system.servicemodel.security.usernamepasswordclientcredential.aspx)还有一个示例如何设置它的值 - 你不能用初始化器做到这一点

编辑：在 OP 评论之后：你不能在初始化程序中设置属性的属性，你必须用旧的方式来做

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:54:52.030

您想设置`UserName`属性的`ClientCredentials.UserName`属性，这使它有些混乱。但是，很容易将其封装到一个方法中：

```
ClientCredentials CreateClientCredentials(String userName, String password) {
  var clientCredentials = new ClientCredentials();
  clientCredentials.UserName.UserName = userName;
  clientCredentials.UserName.Password = password;
  return clientCredentials;
} 
```

此语法不是您可以更改的。`ClientCredentials`类和相关类型是这样设计的。

如果您真的想“修改”语法，一个选项是使用扩展方法创建一个流畅的 API，在某些情况下，这允许您在代码中创建小型嵌入式 DSL。对于这种特殊情况，我认为没有好的解决方案，但作为灵感，我在这里提供了一些扩展方法：

```
public static class ClientCredentialsExtensions {

  public static ClientCredentials WithUserName(
    this ClientCredentials clientCredentials, String userName) {
    // Argument checking omitted.
    clientCredentials.UserName.UserName = userName;
    return clientCredentials;
  }

  public static ClientCredentials WithPassword(
    this ClientCredentials clientCredentials, String password) {
    // Argument checking omitted.
    clientCredentials.UserName.Password = password;
    return clientCredentials;
  }

} 
```

然后你可以像这样使用它：

```
var clientCredentials = new ClientCredentials()
  .WithUserName("username")
  .WithPassword("password"); 
```

但是，我认为没有比这更好的了：

```
var clientCredentials = new CreateClientCredentials("username", "password"); 
```

# android - 滑动自定义图库

> ID：12424694
> 
> 赞同：1
> 
> 时间：2012-09-14T12:35:44.983
> 
> 标签：android

呈现从目录读取的全屏图片库的最佳方式是什么。

我正在考虑使用 ImageView 进行全屏位图显示，然后使用 viewPager 滑动到下一个图像。这意味着我需要至少有 PICTURE、PICTURE+1 和 PICTURE-1 始终在内存中。

这是正确的方法还是有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:39:17.090

**- 更新 -**

正如评论中所指出的，该画廊已被弃用。

画廊文档说要使用 ViewPager 或水平滚动列表： http: [//developer.android.com/reference/android/support/v4/view/ViewPager.html](http://developer.android.com/reference/android/support/v4/view/ViewPager.html) http://developer.android.com/reference/android /widget/Horizo​​ntalScrollView.html

**——老答案——**

您是否有不想使用内置图库的原因？

[http://developer.android.com/reference/android/widget/Gallery.html](http://developer.android.com/reference/android/widget/Gallery.html)

至于管理内存和位图，android 对此发表了一篇文章：

[http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T18:39:58.910

允许你做你想做的事情，并在刷完后回收碎片以供重复使用

[http://developer.android.com/reference/android/support/v4/app/FragmentPagerAdapter.html](http://developer.android.com/reference/android/support/v4/app/FragmentPagerAdapter.html)

# kernel - 从内核模式访问 WinUSB 设备

> ID：12424695
> 
> 赞同：2
> 
> 时间：2012-09-14T12:35:56.947
> 
> 标签：kernel, access-denied, winusb

我确实有一个使用 WinUSB 驱动程序 (winusb.sys) 作为其功能驱动程序的 USB 设备。现在我需要编写一个访问该设备的视频捕获驱动程序（必须是内核模式驱动程序）。

我的问题是：我可以从内核模式访问和使用 WinUSB 设备吗？如果是这样，是否有任何文件可以这样做？

我发现的所有文档都在谈论使用 WinUSB.dll 从用户模式访问 WinUSB 但这不是我的选择。我已经尝试使用 IoGetDeviceObjectPointer() 来获取我在 USB 设备上与之通信的 USB 管道所需的文件句柄，但调用总是以 STATUS_ACCESS_DENIED 失败。我知道我可以为 USB 设备编写自己的 KMDF 驱动程序，但使用已经到位的 WinUSB 驱动程序会容易得多。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T14:23:07.757

这可以工作......但很难做到。

您可以在内核模式下向 winusb 设备发送 i/o 请求。您不能使用 WinUSB 函数进行通信，您必须使用实际的 IO 请求从一个 i/o 堆栈到另一个 i/o 堆栈进行通信。

我为 USB 设备编写了一个 AVStream 微型端口驱动程序，并且可以说，USB 部分并不是最难的部分。特别是在微型端口模式下使用 kmdf USB IO 队列时。

# c# - C# OAuth 1.0 如何在不打开浏览器进行保管箱授权的情况下获取 access_token（桌面应用程序）

> ID：12424702
> 
> 赞同：1
> 
> 时间：2012-09-14T12:36:33.160
> 
> 标签：c#, .net, winforms, oauth, dropbox

我开发桌面应用程序保管箱客户端，我想授权我的应用程序并获得执行 api 请求的能力，但我不想显示给用户浏览器窗口，有什么方法可以在没有浏览器的情况下授权用户并在 C# 中获取 access_token

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:56:07.103

简单的回答：Dropbox 实现的 OAuth 流不支持此操作。

这些流程的想法是用户只需直接在（受信任的）提供商网站上交出他的密码，这在没有浏览器/网络视图的情况下是不可能的。

# apache - 带有 Apache 的 Socket.io

> ID：12424707
> 
> 赞同：4
> 
> 时间：2012-09-14T12:36:55.873
> 
> 标签：apache, node.js, socket.io, reverse-proxy

我在 Node.js 和 socket.io 方面都没有太多经验，因此也许我会问一些愚蠢的问题并为此感到抱歉。

我正在尝试执行以下操作：

1.  在我还安装了 apache 的 ubuntu 上安装了节点。
2.  在 apache 中创建虚拟主机并将其设置为节点的代理。我的 conf 文件如下所示：

    ```
    <VirtualHost *:80>
        ServerAdmin giorgi@omedia.ge
        ServerName node.aidemo.info
        ServerAlias www.node.aidemo.info

        ProxyRequests off
        <Proxy *>
           Order deny,allow
           Allow from all
        </Proxy>

        <Location />
           ProxyPass http://127.0.0.1:8080
           ProxyPassReverse http://127.0.0.1:8080
        </Location>

    </VirtualHost> 
    ```

3.  为服务器创建了简单的 js 文件（socket.io 网站中的第一个服务器示例）并使用命令从 cli 启动服务器：node server.js。完美启动，听8080

4.  创建了另一个虚拟主机，我在其中放置了客户端 index.html（也来自 socket.io 中的第一个示例）。起初我有问题（实际上主要问题是这个），浏览器无法解析路径/socket.io/socket.io.js。然后我从终端本地从 lynx 转到 url (http://localhost:8080/socket.io/socket.io.js)，下载该 js 并使用 index.html 附近的虚拟主机本地放置。在此之后，浏览器可以解析该请求，但是当 socket.io.js 本身尝试获取 url 时出现错误：

    ```
    http://localhost:8080/socket.io/1/?t=1347623348836 
    ```

你有什么想法我该如何解决这个问题？我的主要目标是拥有一个 web url，我可以从中访问我的节点服务器并使用 socket.io 与之交谈——例如创建非常简单的聊天。

我希望我很清楚。感谢所有愿意提供帮助的人。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-02T18:36:07.807

我正在使用 express + socket.io，他们正在监听 port `3001`。我想`http://example.com/folder`重定向到我的 Express 应用程序侦听端口`3001`（即 to `http://localhost:3001`，**server-side**）。

我做了以下事情。

.html 文件有这个：

```
<script src='/folder/socket.io/socket.io.js'> </script>  
<script>  
var socket = io.connect('http://example.com', {resource: 'folder/socket.io'});  
...  
</script> 
```

我的 apache2 conf 看起来像这样：

```
ProxyPreserveHost On
ProxyPass /folder/ http://localhost:3001/
ProxyPassReverse /folder/ http://localhost:3001/

<Proxy *>
    Order deny,allow
    Allow from all
</Proxy>

<Location /folder/>
    allow from all
</Location> 
```

请注意，它需要`proxy_http`启用该模块。要启用它，请运行以下命令：

```
sudo a2enmod proxy_http; service apache2 restart 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-15T09:02:10.037

如果您将`socket.io.js`文件本地放在文件附近`index.html`，它不会解决问题，因为您可能没有更改文件中`socket`var 中的 url，请`main.js`查看：

```
var socket = io.connect(); 
```

在你的`main.js/index.html`（脚本）

用。。。来代替：

```
var socket = io.connect(httpprotocol+hostname+httpport); 
```

我的代码源如下所示：

```
var socket = io.connect('https://192.168.43.187:8443/'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T20:55:23.453

`http://localhost:8080`显然您的服务器之外的任何东西都无法使用。

客户端 javascript`io.connect()`应该连接到，`http://node.aidemo.info`以便 apache 可以将其发送到 Node.js。

`http://node.aidemo.info:8080`如果您打开了端口 8080，也可能会起作用。

# php - php：根据中心纬度/经度和距离查找纬度和经度边界

> ID：12424710
> 
> 赞同：8
> 
> 时间：2012-09-14T12:37:12.160
> 
> 标签：php, latitude-longitude

我正在使用解决方案来解决一个非常[相似的问题](https://stackoverflow.com/questions/8135243/finding-towns-within-a-10-mile-radius-of-postcode-google-maps-api)，在实施后我发现它正在生成一个带有返回坐标而不是正方形的高矩形（请参阅 Matthias 对另一个问题的回答）。

我只需要返回一个数组，因为这是与 WordPress 一起使用的，它有自己的首选查询方法。

这是我的实现：

```
function bar_get_nearby( $lat, $lng, $limit = 50, $distance = 50, $unit = 'mi' ) {

    // radius of earth; @note: the earth is not perfectly spherical, but this is considered the 'mean radius'
    if( $unit == 'km' ) { $radius = 6371.009; }
    elseif ( $unit == 'mi' ) { $radius = 3958.761; }

    // latitude boundaries
    $maxLat = ( float ) $lat + rad2deg( $distance / $radius );
    $minLat = ( float ) $lat - rad2deg( $distance / $radius );

    // longitude boundaries (longitude gets smaller when latitude increases)
    $maxLng = ( float ) $lng + rad2deg( $distance / $radius / cos( deg2rad( ( float ) $lat ) ) );
    $minLng = ( float ) $lng - rad2deg( $distance / $radius / cos( deg2rad( ( float ) $lat ) ) );

    $max_min_values = array(
        'max_latitude' => $maxLat,
        'min_latitude' => $minLat,
        'max_longitude' => $maxLng,
        'min_longitude' => $minLng
    );

    return $max_min_values;

} 
```

如果我给我地理编码（通过谷歌地图 API）我想要的 G2 1QX 邮政编码和 5 英里的距离，我得到一个纬度/经度为 -4.2556347/55.8620472 的函数返回这个数组：

```
Array
(
    [max_latitude] => -4.18326890233
    [min_latitude] => -4.32800049767
    [max_longitude] => 55.9346130696
    [min_longitude] => 55.7894813304
) 
```

有任何想法吗？提前谢谢了。

干杯，RS

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-11-27T09:52:22.250

这是您的函数，其中包含我的修改，它将为您提供方形坐标而不是高矩形：

```
function bar_get_nearby( $lat, $lng, $limit = 50, $distance = 50, $unit = 'mi' ) {
    // radius of earth; @note: the earth is not perfectly spherical, but this is considered the 'mean radius'
    if( $unit == 'km' ) { $radius = 6371.009; }
    elseif ( $unit == 'mi' ) { $radius = 3958.761; }

    // latitude boundaries
    $maxLat = ( float ) $lat + rad2deg( $distance / $radius );
    $minLat = ( float ) $lat - rad2deg( $distance / $radius );

    // longitude boundaries (longitude gets smaller when latitude increases)
    $maxLng = ( float ) $lng + rad2deg( $distance / $radius) / cos( deg2rad( ( float ) $lat ) );
    $minLng = ( float ) $lng - rad2deg( $distance / $radius) / cos( deg2rad( ( float ) $lat ) );

    $max_min_values = array(
        'max_latitude' => $maxLat,
        'min_latitude' => $minLat,
        'max_longitude' => $maxLng,
        'min_longitude' => $minLng
    );

    return $max_min_values;
} 
```

干杯，

鲁佩什·坎布尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:54:36.820

我曾经写过这个函数来计算 2 个点之间的距离，单位是公里（km）而不是英里。我为英里答案写了一个快速修改

```
/**
 * The Haversine function can be used to calculate the distance between 2 points on a map
 *
 * @param  float $lat1 The longtitude value of the first point
 * @param  float $lon1 The lattitude of the frist point
 * @param  float $lat2 The longtitude value of the second point
 * @param  float $lon2 The lattitude of the second point
 * @return float       The distance between the points in mile
 *
 * @access public
 **/
public function harversineDistance($lat1, $lon1, $lat2, $lon2)
{
    $latd = deg2rad($lat2 - $lat1);
    $lond = deg2rad($lon2 - $lon1);
    $a = sin($latd / 2) * sin($latd / 2) +
        cos(deg2rad($lat1)) * cos(deg2rad($lat2)) *
        sin($lond / 2) * sin($lond / 2);
    $c = 2 * atan2(sqrt($a), sqrt(1 - $a));

    // Original return for the km answer
    //return 6371.0 * $c;

    // Return for the mile answer on 2 digits percision
    return round(((6371.0 * $c) * 0.621371192), 2);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-12T13:35:56.880

我需要这个相同的函数 sql，所以我将它转换为 sql 语句，这就是我们可以使用 sql 查询调用的方式

```
select bar_get_nearby(4.860416,-58.93018, 100 ,@"mi") 
```

特别感谢[Rupesh K](https://stackoverflow.com/a/20239032/7439186)

```
DELIMITER $$
CREATE FUNCTION bar_get_nearby(lat FLOAT,lng FLOAT,distance FLOAT,unit VARCHAR(3)) RETURNS TEXT
BEGIN

  DECLARE radius FLOAT;
  DECLARE maxLat FLOAT;
  DECLARE minLat FLOAT;
  DECLARE maxLng FLOAT;
  DECLARE minLng FLOAT;
  DECLARE max_min_values TEXT;

  CASE unit
    WHEN  'km' THEN
       SET radius = 6371.009;
    WHEN 'mi' THEN
       SET radius = 3958.761;
    ELSE
       SET radius = 3958.761;
  END CASE;

   SET maxLat = lat + degrees( distance / radius );
   SET minLat = lat - degrees( distance / radius );

   SET maxLng = lng + degrees( distance / radius) / COS( radians( lat ) );
   SET minLng = lng - degrees( distance / radius) / COS( radians( lat ) );

    SET max_min_values = concat('north=' , maxLat, '&south=' , minLat,'&east=' , maxLng, '&west=' , minLng);

  RETURN max_min_values;
END$$
DELIMITER ; 
```

# java - 从平面文件中读取数据并将其写入 xml 的最佳方法

> ID：12424711
> 
> 赞同：1
> 
> 时间：2012-09-14T12:37:16.087
> 
> 标签：java, xml, file

我有一个带有逗号分隔值的平面 .txt 文件，例如：

```
1,name1,department1
2,name2,department2
3,name3,department3
...
... 
```

现在我想从 .txt 文件中读取这些记录并将其写入 xml，输出应该是这样的：

```
<Employees>
     <Employee>
          <Code>1</Code>
          <Name>name1</Name>
          <Department>department1</Department>
     </Employee>
     <Employee>
          <Code>2</Code>
          <Name>name2</Name>
          <Department>department2</Department>
     </Employee>
     <Employee>
          <Code>3</Code>
          <Name>name3</Name>
          <Department>department3</Department>
     </Employee>
</Employees> 
```

所以现在为了实现这一点，我已经经历了各种问题/帖子，不知何故我对我应该遵循的方法以及我应该使用哪个 XMLBuilder 感到困惑，比如 XStream ？

谁能告诉我应该采用哪种方法才能获得最佳性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:50:00.957

我会使用 CSV 库（例如 openCSV）来读取文件，然后使用 JAXB 创建 XML 文件。

您可以使用where has fields等创建一个`Employees`类。使用 CSV 库填写它。使用其中一种方法将整个内容写入一行中的文件。`List<Employee>``Employee``Code``Name``JAXB.marshal`

简单的示例代码

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.PUBLIC_MEMBER)
public class XmlWriterTest
{
    public String foo;
    public List<String> bars;

    public static void main(String[] args)
    {
        XmlWriterTest test = new XmlWriterTest();
        test.foo = "hi";
        test.bars = Arrays.asList("yo", "oi");
        JAXB.marshal(test, System.out);
    }   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:46:07.570

这是伪代码中最简单的方法：

```
file.write("<Employees>");
foreach(String line : file)
{
    String[] parts = line.split(",");
    file.write("<Employee><Code>" + parts[0] + "</Code><Name>" + parts[1] + "</Name><Department>" + parts[2] + "</Department></Employee>");
}
file.write("</Employees>"); 
```

显然，此解决方案非常幼稚，并假设您的平面文件在字段中不包含逗号，并且每行正好有 3 列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:47:55.477

从您的评论来看，最简单的方法似乎是在没有任何 xml 构建器的情况下使用 print/write 执行此操作：

1.  逐行读取txt文件
2.  使用“，”作为分隔符拆分字段
3.  使用简单的 System.out.print 方法将 xml 标记写入文件/标准输出

不要忘记 XML 标头。

如果您的格式经常更改，您将编写一个`.xsd schema`并使用`jaxb`来生成类层次结构和编组/解组代码，但在这种情况下，它会是矫枉过正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T20:07:36.090

单行 awk 解决方案怎么样？

```
awk -F, 'BEGIN{printf "<Employees>\n"}END{printf "</Employees>\n"}{printf"<Employee><Code>%s</Code><Name>%s</Name><Department>%s</Department></Employee>\n",$1,$2,$3}' data.txt 
```

对于这样一个简单的问题，编写 Java 程序似乎有点过头了。

## 更新

如果要格式化输出，可以通过管道将其输入 xmllint 命令：

```
$ awk -F, 'BEGIN{printf "<Employees>"}END{printf "</Employees>"}{printf"<Employee><Code>%s</Code><Name>%s</Name><Department>%s</Department></Employee>",$1,$2,$3}' data.txt | xmllint --format -
<?xml version="1.0"?>
<Employees>
  <Employee>
    <Code>1</Code>
    <Name>name1</Name>
    <Department>department1</Department>
  </Employee>
  <Employee>
    <Code>2</Code>
    <Name>name2</Name>
    <Department>department2</Department>
  </Employee>
  <Employee>
    <Code>3</Code>
    <Name>name3</Name>
    <Department>department3</Department>
  </Employee>
</Employees> 
```

# java - 将 POJO 类从 EJB jar 注入到不同 EJB jar 中的 EJB

> ID：12424715
> 
> 赞同：3
> 
> 时间：2012-09-14T12:37:37.913
> 
> 标签：java, dependency-injection, ejb, cdi

鉴于我耳朵里有两个 EJB jar：A.jar 和 B.jar。我可以`Autil`使用 CDI 将不是 EJB 的实用程序类（只是 A.jar 中的 POJO）注入到 B.jar 中的 EJB 中吗？我无法在 Java EE 规范中清楚地找到这一点。（顺便说一句。我使用的是 Glassfish 3.1.1）

**注意：**当然我可以尝试（同时已经尝试过），但是这样我只能用特定的 AS 来检查它，我想知道规范是怎么说的，因为我试图保持供应商中立。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T21:34:59.483

首先，如果您使用的是 GlassFish，请帮自己一个忙并使用 3.1.2.2。接下来，是的，您应该能够做到这一点。确保两个 jar 都具有 META-INF/beans.xml 以及您的 Web 应用程序 (WEB-INF/beans.xml)

# codeigniter-2 - Ion Auth , 获取所有当前登录的用户登录

> ID：12424720
> 
> 赞同：2
> 
> 时间：2012-09-14T12:38:08.957
> 
> 标签：codeigniter-2, ion-auth

我正在使用带有 codeigniter 的 ion auth 库。我可以获取 ceratin 组中的所有成员，但无法获取该组中的所有已登录用户。有谁知道我怎么能做到这一点？谢谢你们

好的，我正在编辑这个，因为我找到了一种方法......我已经通过了我的数据库会话，表 ci_sessions，现在我可以看到基于表行数登录的用户。

我发现了另一个问题。

我以这种方式反序列化 ci_sessions 的 user_data

```
       $query = $this->db->get('ci_sessions');

       foreach ($query->result() as $row)
       {
          var_dump([$row->user_data]);
          $user_data = unserialize($row->user_data);
          var_dump($user_data);
       }

```

我得到 user_data 作为这样的数组

```
    数组（大小=6）
      'user_data' => 字符串''（长度=0）
      '身份' => 字符串'joao.costa@onegreat.org'（长度=23）
      '用户名' => 字符串'joao.costa' (长度=10)
      '电子邮件' => 字符串'joao.costa@onegreat.org'（长度=23）
      'user_id' => 字符串'14'（长度=2）
      'old_last_login' => 字符串'1347619173'（长度=10）

```

我现在无法获取我的 user_id，因为它说 user_id 也是一个字符串和 14。

我究竟做错了什么？

我试着做这样的事情

```
    用户数据->用户 ID

```

谢谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T10:54:14.833

你为什么要反序列化数组？没有必要。

```
 $query = $this->db->get('ci_sessions');

       foreach ($query->result() as $row)
       {
          var_dump([$row->user_data]);
          $user_data = $row->user_data;
          var_dump($user_data);
          // or
          var_dump($user_data->user_id);
       } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-04T22:50:35.193

要访问数组中的元素，请使用数组表示法：

> 用户数据['user_id']

# asp.net - 在 ado.net 中使用 exec 运行 SP

> ID：12424721
> 
> 赞同：1
> 
> 时间：2012-09-14T12:38:09.423
> 
> 标签：asp.net

> **可能重复：**
> [CommandType.Text vs CommandType.StoredProcedure](https://stackoverflow.com/questions/643880/commandtype-text-vs-commandtype-storedprocedure)

我一直在 .Net 中开发一个已经开发的项目，并且通过运行 SP 的 commandText 类似于“exec SPname”，因此 SqlCommand 的 commandType 仍然是文本而不是存储过程。Rest 代码与 ado 中使用的代码相似。网。它的性能是否比传统的更好？

# c# - Web 应用程序的另一个面板上的显示面板

> ID：12424725
> 
> 赞同：0
> 
> 时间：2012-09-14T12:38:22.817
> 
> 标签：c#, asp.net, panel

我一直在寻找答案，但还没有找到任何有用的东西。

我有一个带有一些数据（来自 SQL 数据库）的 gridview 和一个删除行的选项。在删除行之前，我希望用户确认删除（弹出窗口）。我知道如何使用 javascript 创建一个弹出窗口，但我不喜欢该弹出窗口的外观。我想制作 ky 自己的“弹出窗口”。

我正在考虑将一个面板（我在其中放置文本（标签）和一些按钮（确定，取消））覆盖在我拥有 gridview 的面板上。像图片中的东西。我将如何完成这样的事情？

![在此处输入图像描述](../Images/78dee34a9ceffc885fef72703cb84097.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:40:37.943

使用 Ajax 控件工具包弹出窗口怎么样？

[http://www.asp.net/ajaxlibrary/act_Popup.ashx](http://www.asp.net/ajaxlibrary/act_Popup.ashx)

这似乎完全符合您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:43:19.317

带有[自定义](http://jqueryui.com/themeroller/)样式的[JQueryUI 对话框](http://jqueryui.com/demos/dialog/)怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:44:40.447

使用[jQuery UI 对话框](http://jqueryui.com/demos/dialog/#modal)

例子：

```
<script type="text/javascript">
    $(function () {
        var $dialog = $("#dialog");
        var $foo = $("input:submit[id$=foo]");
        var confirmed = false;

        $dialog.hide();

        $dialog.dialog({
            width: "300px",
            modal: true,
            autoOpen: false,
            buttons: {
                OK: function (e) {
                    $dialog.dialog("close");
                    confirmed = true;
                    $foo.click();
                },
                Cancel: function (e) {
                    $dialog.dialog("close");
                    confirmed = false;
                }
            }
        });

        $foo.click(function (e) {
            if (!confirmed) {
                $dialog.dialog("open");
            }

            return confirmed;
        });
    });
</script> 
```

完整[的工作示例可以从这里下载](https://github.com/jupaol/SO-Answers/blob/master/Visual%20Studio%202012/src/SO/WebForms/WebForms_1/Topics/JQuery/jQueryUI/ModalDialog.aspx)

# jquery - 我可以停止开始的动画吗？

> ID：12424727
> 
> 赞同：0
> 
> 时间：2012-09-14T12:38:29.427
> 
> 标签：jquery

假设我有这个从某个时间点开始的动画：

```
myElement.animate({ top: -currentTempImageX, left: -currentTempImageY }, 5000); 
```

动画需要 5 秒！假设我想在 2 秒后停止它。我可以有这个控制吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:40:06.247

是的你可以

```
myElement.stop(); 
```

链接：[http ://api.jquery.com/stop/](http://api.jquery.com/stop/)

如果您想在 2 秒后停止动画，请使用，

```
setTimeout(function(){myElement.stop();}, 2000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:42:53.793

Bhuvan Rikka 建议的用户 setTimeout() ，用于停止使用 clearTimeout() 函数..例如，请参阅此链接

[http://www.w3schools.com/js/js_timing.asp](http://www.w3schools.com/js/js_timing.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:43:56.797

您还可以检查 FX 队列（用于 jquery 动画）

[http://api.jquery.com/queue/](http://api.jquery.com/queue/)

或其他主题。

[jQuery 中的队列是什么？](https://stackoverflow.com/questions/1058158/can-somebody-explain-jquery-queue-to-me)

# java - 如何访问 IntelliJ 插件中当前项目的依赖项的类？

> ID：12424730
> 
> 赞同：0
> 
> 时间：2012-09-14T12:38:38.757
> 
> 标签：java, maven, plugins, intellij-idea, classpath

我想通过当前项目的依赖项（Maven）访问一个类。就像在 IDEA 的代码窗口中访问类一样。那么，是否可以从插件访问这些类？我现在可以访问所有项目数据和类，但不能访问外部依赖项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:29:33.907

冒着不理解问题的风险，如果所讨论的类是 Maven 依赖项，并且 IntelliJ 已将依赖项放在类路径上，那么您只需要导入该类即可使用它：

```
import somepackage.ObjectUtil;
...
ObjectUtil.save(); 
```

但是，可能存在依赖项不是必需的依赖项的情况 - 如果它被列为`<optional>true</optional>`或如果它具有 non-compile `<scope>`。

# javascript - 用javascript输出图像但不下载

> ID：12424731
> 
> 赞同：1
> 
> 时间：2012-09-14T12:38:46.027
> 
> 标签：javascript, mysql, database, image, export

我使用库 Highcharts 来生成一些图形。

我想将它们发送到服务器并执行 mysql 请求，以便将数据信息保存到我的数据库中。问题是它只是将文件下载到我的计算机中。

我真的很想将它保存在服务器上的预定义文件夹中。它只是下载它。

我付出了很多努力编写了这段代码。

我遇到了很多问题，但我不知道最后如何通过。

这是生成图像并自动下载图像的代码：

```
 <script type="text/javascript">//<![CDATA[ 
$(function(){
/**
 * Create a global getSVG method that takes an array of charts as an argument
 */
Highcharts.getSVG = function(charts) {
    var svgArr = [],
        top = 0,
        width = 0;

    $.each(charts, function(i, chart) {
        var svg = chart.getSVG();
        svg = svg.replace('<svg', '<g transform="translate(0,' + top + ')" ');
        svg = svg.replace('</svg>', '</g>');

        top += chart.chartHeight;
        width = Math.max(width, chart.chartWidth);

        svgArr.push(svg);
    });

    return '<svg height="2400px" width="1200px" version="1.1" xmlns="http://www.w3.org/2000/svg">' + svgArr.join('') + '</svg>';
};

/**
 * Create a global exportCharts method that takes an array of charts as an argument,
 * and exporting options as the second argument
 */
Highcharts.exportCharts = function(charts, options) {
    var form
        svg = Highcharts.getSVG(charts);

    // merge the options
    options = Highcharts.merge(Highcharts.getOptions().exporting, options);

    // create the form
    form = Highcharts.createElement('form', {
        method: 'post',
        action: options.url
    }, {
        display: 'none'
    }, document.body);

    // add the values
    Highcharts.each(['filename', 'type', 'width', 'svg'], function(name) {
        Highcharts.createElement('input', {
            type: 'hidden',
            name: name,
            value: {
                filename: options.filename || 'chart',
                type: options.type,
                width: 1200,

                svg: svg
            }[name]
        }, null, form);
    });
    //console.log(svg); return;
    // submit
    form.submit();

    // clean up
    form.parentNode.removeChild(form);
};

$('#export').click(function() {
    Highcharts.exportCharts([chart1, chart2, chart3]);
});
});//]]>  

</script>
    </head>
    <body>

<script src="js/highcharts.js"></script>
<script type="text/javascript" src="http://highcharts.com/js/testing-exporting.js"></script>
<div id="container" style="height: 400px; width:1200px"></div>
<div id="container2" style="height: 400px; width:1200px"></div>
<div id="container3" style="height: 400px; width:1200px"></div>

<button id="export">Export all</button> 
```

我只是尝试将其发送到服务器。

非常感谢大家的帮助。

接受我最崇高的敬意。

亲切的问候 SP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-20T10:52:24.327

you can try this

```
 var chart = $('#yourchart').highcharts();
    svg = chart.getSVG();   
    var base_image = new Image();
    svg = "data:image/svg+xml,"+svg;
    base_image.src = svg;
    $('#mock').attr('src', svg);

var dataString = $('#mock').html() ; //  or just binary code 
$.ajax({
    type: 'POST',
    data: dataString,
    url: 'your-server/',
    success: function(data){

    }
}); 
```

[Save highchart as binary image](http://angulartutorial.blogspot.in/2014/03/save-highchart-as-binary-image.html)

# ios - BlocksKit 框架编译错误

> ID：12424732
> 
> 赞同：4
> 
> 时间：2012-09-14T12:38:55.747
> 
> 标签：ios, frameworks

我尝试构建框架，但它返回编译器错误。如何解决这个错误？

![在此处输入图像描述](../Images/2e722e26bce4c87c041cdf501324e272.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-09T21:02:22.410

Blockskit 依赖于 libffi，它在其 podspec 中包含此标志。但是，自版本 ld64-134.9 以来，链接器似乎不再支持它（您可以通过从命令行输入 ld -v 来检查您正在运行的版本）。

我已经发送了一个拉取请求来纠正这个问题。同时，我发现的唯一解决方案是在每次运行“pod install”后从生成的 Pods.xconfig 文件中手动删除“-Wl,-no_compact_unwind”。顺便说一句，无论您是针对静态库还是应用程序进行链接，都会出现问题。

我希望我的修复将很快被合并。

**** 更新 ****

固定的！

**** 更新 ****

不幸的是，BlocksKit 开发人员不接受我的解决方案，并且问题没有在他的测试机器上重现。所以目前最好的选择是： 1\. 在每次“pod update”之后手动删除标志（如上所述） 2\. Fork BlocksKit，从那里删除编译器标志，然后更新你的 Podfile 以指向你的 fork 而不是原始项目。您必须不时手动提取原始项目以保持最新状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T21:41:16.700

您是否将 blockskit 与静态库链接？我认为“-Wl，-no_compact_unwind”链接器标志在那里不起作用。一种解决方法可能是从 cocoapods 生成的 xcconfig 文件中删除该标志？当我这样做时，错误似乎消失了。

# javascript - MVC HTML@Beginform + 从布局视图提交具有现有隐藏字段值的表单

> ID：12424734
> 
> 赞同：0
> 
> 时间：2012-09-14T12:38:57.743
> 
> 标签：javascript, asp.net-mvc, razor

在我的共享 _Layout.cshtml 视图中，我有一个隐藏字段，我想保留一个值以在多个页面中使用。现在在其中一个页面中，我必须提交一个需要该特定隐藏字段值的表单。我在想我所需要的只是从我的 _Layout.cshtml 传入 hiddenfield 值，但不知道如何分配它，下面的工作但我正在创建一个额外的 hiddenfield 并使用来自的 hiddenfield 值分配它的值我的_Layout.cshtml。

是否可以消除额外隐藏字段的使用？

谢谢。

```
<script type="text/javascript">
    ($('#p1').val($('#playerChoice_1').val()));
</script>

    @using (Ajax.BeginForm(new AjaxOptions { OnSuccess = "LoadThankYou()" }))
        {
            @Html.ValidationSummary(true)
            <fieldset >

                <div style="FILTER:" class="fb-grouplabel fb-item fb-100-item-column">
                    @Html.LabelFor(model => model.Name)
                </div>
                <div class="fb-input-box editor-field">
                    @* <input id="item7_text_1" class="" name="text7" maxlength="254" placeholder="Enter your name"
                                       autocomplete="off" data-hint="" type="text" />*@
                    @Html.EditorFor(model => model.Name)
                    @Html.ValidationMessageFor(model => model.Name)
                </div>               

                <div style="FILTER:" class="fb-grouplabel fb-item fb-100-item-column">
                    @Html.LabelFor(model => model.Email)
                </div>
                <div class="fb-input-box editor-field">
                    @Html.EditorFor(model => model.Email)
                    @Html.ValidationMessageFor(model => model.Email)
                </div>

                <div style="FILTER:" class="fb-grouplabel fb-item fb-100-item-column">
                    @Html.LabelFor(model => model.Contact)
                </div>
                <div class="fb-input-box editor-field">
                    @Html.EditorFor(model => model.Contact)
                    @Html.ValidationMessageFor(model => model.Contact)
                </div>

                <div style="FILTER:" class="fb-grouplabel fb-item fb-100-item-column">
                    @Html.LabelFor(model => model.PersonalID)
                </div>
                <div class="fb-input-box editor-field">
                    @Html.EditorFor(model => model.PersonalID)
                    @Html.ValidationMessageFor(model => model.PersonalID)
                </div>

                <input type="hidden" id="p1" name="Choice_1" />

                <div style="MIN-HEIGHT: 1px" id="fb-submit-button-div" class="fb-item-alignment-left fb-footer">
                    @* <input style="BACKGROUND-IMAGE: url(theme/default/images/btn_submit.png)"
                            id="fb-submit-button" class="fb-button-special" type="submit" value="Submit" />*@
                    <input type="submit" value="Submit" />
                </div>
            </fieldset>
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T13:29:12.337

在[`ready`](http://api.jquery.com/ready/)活动中这样做。这样它就会在 DOM 完成加载后执行。

```
<script type="text/javascript">
  $(function(){
     $('#p1').val($('#playerChoice_1').val());
  });
</script> 
```

如果您想避免隐藏字段，并且希望在所有页面中都使用此值，则可以考虑将 Value 存储在**Session 变量**中一次，并在需要时在您的操作方法中访问它。

# mysql - 检查一列的值是否包含另一列的值

> ID：12424737
> 
> 赞同：5
> 
> 时间：2012-09-14T12:38:59.800
> 
> 标签：mysql, sql

我有一个带有 java 包名称的表：

```
|id|pkg|
|1 |some.long.package.path|
|2 |com.admob.bla| 
```

和一个包含部分包名称的表形成已知的广告框架。

```
|id|path_fragment|
|1 |.admob | 
```

如何检索 pkg 值包含任何 ad_frameworks.path_fragment 的包？

我只是找不到子字符串检查。我发现的只是人们使用 like 来比较一些字符串文字，但从不用于比较列。

注意：我正在使用 MySQL。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-14T12:43:48.257

认为你可以用like来做一个内部连接

```
select p.id, p.pkg
from package p
inner join ad_frameworks adf on p.pkg like CONCAT('%', adf.path_fragment, '%')
--group by p.id, p.pkg 
```

或者正如你所指出的

```
select * 
from package p
inner join ad_frameworks adf on LOCATE(adf.fragment, p.pkg) > 0 
```

或者

```
select * 
from package p
inner join ad_frameworks adf on INSTR( p.pkg,adf.fragment) > 0 
```

或者

```
select * 
from package p
inner join ad_frameworks adf on POSITION(adf.fragment IN p.pkg) > 0 
```

或者

```
select * 
from package p
inner join ad_frameworks adf on REPLACE(p.pkg, adf.fragemnt, '') <> p.pkg 
```

好吧，你的选择很少；）

[SqlFiddle](http://sqlfiddle.com/#!2/a2d82/6)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:49:35.680

试试这个，

```
SELECT  a.*, b.*
FROM    package a, ad_frameworks b
WHERE   a.pkg LIKE CONCAT('%',b.path_fragment,'%') 
```

# [*SQLFiddle 演示*](http://sqlfiddle.com/#!2/a8267/2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:50:52.153

尝试这样的事情：

```
SELECT distinct a.pkg FROM TAB_1 as a INNER JOIN TAB_2 as b ON a.pkg LIKE CONCAT('%', b.path_fragment, '%') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:50:53.243

你可以这样做：

```
select p.id, pkg from packages p
inner join frameworks f on 
p.pkg like concat('%',f.path_fragment,'%') 
```

# jquery - 将全选和取消全选按钮添加到 jQuery 可排序和可拖动的多选

> ID：12424738
> 
> 赞同：0
> 
> 时间：2012-09-14T12:39:00.757
> 
> 标签：jquery, spring-mvc, draggable, multi-select

我正在使用[http://jqueryui.com/demos/sortable/#empty-lists](http://jqueryui.com/demos/sortable/#empty-lists)呈现用户可以选择的元素列表。但是现在我必须实现 2 个按钮：一个选择全部（即从左到右移动所有元素）和另一个取消全选（即从右到左移动所有元素）但我不太确定如何去做...

这是脚本部分：

```
<script>
    $(function() {
        $("ul.droptrue").sortable({
            connectWith: 'ul',
            opacity: 0.6,
            update : updatePostOrder
        });

        $("#listaCentrosDisponibles, #listaCentrosSeleccionados").disableSelection();
        $("#listaCentrosDisponibles, #listaCentrosSeleccionados").css('minHeight',$("#listaCentrosDisponibles").height()+"px");
        updatePostOrder();
    }); 
    function updatePostOrder() { 
        var arr = [];
        $("#listaCentrosSeleccionados li").each(function(){
            arr.push($(this).attr('id'));
        });
        $('#centrosSeleccionados').val(arr.join(','));  
    }
</script> 
```

这是 jsp 部分（我使用 Spring MVC 和 Spring 3.1）：

```
<div class="listBlock">
    <ul id="listaCentrosDisponibles" class="droptrue">
        <c:forEach items="${filtro.centros}" var="centro">
            <li class="centro_draggable" id="${centro.idCentro}">${centro.nombre}</li>
        </c:forEach>
    </ul>
</div>

<div class="listBlock">
    <ul id="listaCentrosSeleccionados" class="droptrue">
    </ul>
    <form:hidden path="centrosSeleccionados" />
</div> 
```

Filtro.centros 是包含可以选择的元素的原始列表，centrosSeleccionados 是我存储已选择元素的列表。

我试过这个：

```
("#quitar_todos").click(function() {
    var arrDisponibles = [];
    var arrSeleccionados = [];
    $("#listaCentrosSeleccionados li").each(function(){
        arrDisponibles.push($(this).attr('id'));
    });
    $("#listaCentrosDisponibles li").each(function(){
        arrDisponibles.push($(this).attr('id'));
    });
    $('#centrosDisponibles').val(arrDisponibles.join(','));
    $('#centrosSeleccionados').val(arrSeleccionados.join(','));
}); 
```

quitar_todos 在哪里：

```
<a id="quitar_todos" href="#"><span>Quitar todos</span></a> 
```

但它不会工作...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T11:04:15.637

好吧，最后我想出了如何去做。

这是脚本部分：

```
$(function() {
    $("ul.droptrue").sortable({
        connectWith: 'ul',
        opacity: 0.6,
        update : updatePostOrder
    });

    $("#listaCentrosDisponibles, #listaCentrosSeleccionados").disableSelection();
    $("#listaCentrosDisponibles, #listaCentrosSeleccionados").css('minHeight',$("#listaCentrosDisponibles").height()+"px");
    updatePostOrder();

    $("#boton_quitar_todos").click(function() {
    var arrDisponibles = [];
    var arrSeleccionados = [];
    $("#listaCentrosSeleccionados li").each(function(){
        $(this).remove();
        $(this).appendTo("#listaCentrosDisponibles");
    });
    $("#listaCentrosDisponibles li").each(function(){
        arrDisponibles.push($(this).attr('id'));
    });
    $('#listaCentrosDisponibles li').sort(sortAlpha).appendTo('#listaCentrosDisponibles');
    $('#centrosSeleccionados').val(arrSeleccionados.join(','));
});

$("#boton_seleccionar_todos").click(function() {
    var arrSeleccionados = [];
    $("#listaCentrosDisponibles li").each(function(){
        $(this).remove();
        $(this).appendTo("#listaCentrosSeleccionados");
    });
    $("#listaCentrosSeleccionados li").each(function(){
        arrSeleccionados.push($(this).attr('id'));
    });
    $('#listaCentrosSeleccionados li').sort(sortAlpha).appendTo('#listaCentrosSeleccionados');
    $('#centrosSeleccionados').val(arrSeleccionados.join(','));
});

});

function updatePostOrder() { 
    var arr = [];
    $("#listaCentrosSeleccionados li").each(function(){
        arr.push($(this).attr('id'));
    });
    $('#centrosSeleccionados').val(arr.join(','));  
}

function sortAlpha(a,b){  
    return a.innerHTML.toLowerCase() > b.innerHTML.toLowerCase() ? 1 : -1;  
}; 
```

这是jsp片段：

```
<div class="listBlock">
    <ul id="listaCentrosDisponibles" class="droptrue">
        <c:forEach items="${filtro.centros}" var="centro">
            <li class="centro_draggable" id="${centro.idCentro}">${centro.nombre}</li>
        </c:forEach>
    </ul>
</div>

<a id="seleccionar_todos" href="#"><span>Seleccionar todos</span></a>
<a id="quitar_todos" href="#"><span>Quitar todos</span></a>

<div class="listBlock">
    <ul id="listaCentrosSeleccionados" class="droptrue">
    </ul>
    <form:hidden path="centrosSeleccionados" />
</div> 
```

# php - foreach 循环 x 坐标中的图像复制

> ID：12424744
> 
> 赞同：1
> 
> 时间：2012-09-14T12:39:17.213
> 
> 标签：php, loops, foreach, gdlib

我有这个图像功能，但我有一点问题

```
function BuildCustomBricks($myBricksAndRatios) {

        $img = imagecreate(890,502);
        imagealphablending($img, true);
        imagesavealpha($img, true);

        foreach ($this->shuffle_with_keys($myBricksAndRatios) as $key) {            

            $bricks_to_choose = rand(1,10);

            $cur = imagecreatefrompng("/var/www/brickmixer/bricks/". $key."-".$bricks_to_choose.".png"); 
            imagealphablending($cur, true);
            imagesavealpha($cur, true);
            imagecopy($img, $cur, 0, 0, 0, 0, 125, 32);

            imagedestroy($cur);
        }

        header('Content-Type: image/png');
        imagepng($img);
    } 
```

如何将每张图像放在前一张的 foreach 100 像素中？

```
next image in the loop:    
imagecopy($img, $cur, previous_x_coord+100, 0, 0, 0, 125, 32); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:42:20.573

只需存储一个从零开始并在每次循环迭代结束时添加 100 的变量：

```
 // Init at zero
    $coords = 0;
    foreach ($this->shuffle_with_keys($myBricksAndRatios) as $key) {            

        $bricks_to_choose = rand(1,10);

        $cur = imagecreatefrompng("/var/www/brickmixer/bricks/". $key."-".$bricks_to_choose.".png"); 
        imagealphablending($cur, true);
        imagesavealpha($cur, true);
        // Use the variable here
        imagecopy($img, $cur, $coords, 0, 0, 0, 125, 32);

        imagedestroy($cur);

        // Add 100 at the end of the loop block
        $coords += 100;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:45:14.083

迈克尔的回答是一个选项，但是由于您使用的是`foreach`代替`while`，因此您也可以使用数组的索引：

```
foreach ($this->shuffle_with_keys($myBricksAndRatios) as $factor => $key)
{
    //...Multiply index by 100: 0*100,1*100,2*100 etc...
    imagecopy($img, $cur, 100*$factor, 0, 0, 0, 125, 32);
    //...
} 
```

这对我来说有点肛门，但它不需要额外的 2 行代码，也不需要额外的变量。批评者可能会说这段代码的*可维护性较差*，在这种情况下，我会说：“不要忍者评论，那么”

*警告：*
正如迈克尔指出的那样，由于明显的原因，此代码不适用于关联数组（`'First_Key'*100 === ?`）

# maven - 使用 EJB 和 JSF 配置 maven：部署期间的严重错误

> ID：12424748
> 
> 赞同：1
> 
> 时间：2012-09-14T12:39:34.187
> 
> 标签：maven, jsf-2, glassfish, ejb

我一直在将一个耳朵项目从 Ant 迁移到 Maven，我发现了这个问题：

**严重：部署期间出现严重错误：com.sun.faces.config.ConfigurationException：配置失败！默认实现必须覆盖此方法**

来自项目 web 的 POM 配置如下：

```
 <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-web-api</artifactId>
        <version>6.0</version>
        <scope>provided</scope>
    </dependency>

    <dependency>
        <groupId>com.alquilaweb</groupId>
        <artifactId>Maven-ejb</artifactId>
        <version>1.0-SNAPSHOT</version>
        <scope>provided</scope>
    </dependency>

    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
    </dependency>

    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency>

    <dependency>
        <groupId>com.sun.faces</groupId>
        <artifactId>jsf-api</artifactId>
        <version>2.1.7</version>
        <scope>compile</scope>
    </dependency>

    <dependency>
        <groupId>com.sun.faces</groupId>
        <artifactId>jsf-impl</artifactId>
        <version>2.1.7</version>
        <scope>compile</scope>
    </dependency>

    <dependency>
        <groupId>org.primefaces</groupId>
        <artifactId>primefaces</artifactId>
        <version>${primefaces.version}</version>
        <type>jar</type>
        <scope>compile</scope>
    </dependency> 
```

我google了很多，但我找不到任何解决方案。也许这是一件愚蠢的事情，但我找不到这个异常发生在哪里。

问候，

萨朗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-27T18:42:59.387

我也遇到了同样的错误。然后我将我的 JDK 编译器版本更新为 1.8，它对我有用。

# c# - 集成测试（纯文本文件填充数据库）

> ID：12424750
> 
> 赞同：2
> 
> 时间：2012-09-14T12:39:38.743
> 
> 标签：c#, database, text, integration

我们的团队在测试方面非常新。我们是第一次使用 scrum。在第一个 sprint 中，我们在 gui 上有 1 个按钮。按下按钮将导致将文本文件的内容转换为数据库（在新线程/任务中）。gui 将显示任务已启动，并将轮询任务的状态。

我们知道如何使用 TDD 方法对所有内容进行单元测试。但是完成后，我们必须进行集成测试。

我们需要在集成测试中执行什么样的测试？我们是否需要通过测试不同的文件来检查数据库中的所有内容是否正确填写？（IE：关系，存储为 varchar(xxx) 的特定格式等？）

如果是这样：这可能非常复杂，对吧？因为您没有 1 或 2 个输入参数，但您有一个完整的文件（我的意思是文件的内容！！！），它是要测试的变量。然后，您可以为这个一键式按钮进行数百甚至数千次测试。最糟糕的事情：大多数测试（即格式化）已经在单元测试中进行了测试。

互联网上的大多数示例显示更多类似 gui 的测试作为集成测试（或者下面的示例是验收测试？）：使用正确的用户名和密码登录 - 输入：名称 + 密码 - 预期输出：重定向到主页

使用不正确的用户名和/或密码登录 - 输入：名称和密码（不正确） - 预期输出：警告（登录失败，用户名或密码不正确）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T15:54:38.307

您的问题涵盖了许多试图转向更好的测试和环境建设程序的领域。所以首先让我们谈谈集成测试。

对于集成测试，您大部分需要一个空数据库，因为您正在测试给定一组特定的现有数据，您可以查询该数据并获得所需的结果。

让我们使用像 UserFinder 类这样的简单示例，您希望能够在系统中找到具有给定名称的用户并获取可用的模型。

```
public class UserFinder
{
    private SomeDbContext _dbContext;

    public UserFinder(SomeDbContext dbContext)
    { _dbContext = dbContext }

    public User FindUser(string name)
    { _dbContext.Find<User>(new FindUserByNameQuery(_dbContext, name)); }
} 
```

现在在上面虽然它是一个非常垃圾的类，但我们可以测试给定数据库中名为“Tester”的用户，当您调用 FindUser("Tester") 时，您应该返回该用户模型。

因此，作为此测试的一部分，您首先要在数据库中设置预期用户，然后创建用户查找器，为其提供*真正的*数据库连接，然后使用名称“Tester”查询数据库并证明你把那个模型拿回来。

通过这种方式，您可以在任何上下文中运行该测试，无论是 IDE、构建脚本还是命令行，并且您将获得一致的结果，因为您的测试是自包含的，它设置场景、运行测试并验证验收标准。然后，一旦该测试完成，所有数据都应该被删除，重点是您只设置给定测试所需的内容，并且通常只在该测试中设置它。

现在理想情况下，由于集成测试和验收测试的运行速度比单元测试慢很多，您只想测试单元测试中未涵盖的内容，但同时您要确保只测试您的逻辑，就像您一样可以使用 NHibernate 轻松创建上面的测试场景，而您所证明的只是 NH​​ibernate 有效，这不是您的目标。*美国*不可能告诉*你*您需要测试什么，因为我们不知道您的项目或您想要实现的目标，但您应该对您的应用程序逻辑流程有一些了解，以及您是否看到该流程中连接到数据库或文件系统的任何点或将其他一些外部边界传递给您具有业务逻辑的应用程序，您可能希望在其中放置一个测试场景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T16:13:26.733

我会说你需要限制你正在测试的内容。在业余时间，我正在开发一个以 EF5 作为后端的 MVC4 项目，其中包含存储库和数据服务。我曾尝试模拟 EntityFramework 行为，但它太复杂了。一般来说，这里的人们一致认为模拟数据库上下文是毫无意义的。无论如何，微软都会对此进行测试，所以不要费心测试自己已经被 MS 测试过的东西。

在我的项目中，我为此设置了测试项目和测试数据库。但我不测试存储库，因为它们非常透明且接近 EF。我通过将真实上下文和连接字符串提供给测试数据库来测试我的数据服务。对于每个测试类，我都会删除数据库并重新创建结构。我正在为每个测试重新填充数据，因此测试始终针对相同的数据运行。

这被认为是一个集成测试，因为在这里我要经过几层，然后再点击数据库。在这些测试中，我发现了我在 DB 中的关系和 DbContext 中的其他问题可能遇到的所有问题。

但就我进行集成测试而言 - 我的控制器（和其他对象）使用模拟依赖项进行测试（我使用的是 Moq）。一旦我对 UI 有了更深入的了解，我可能会通过 Selenium 为网页编写一些测试。

以下是我的测试项目中的一些示例：

```
[TestFixture]
class ProjectDataServiceTest
{
    private ProjectDataService _projectDataService;
    private DatabaseSeeder _seeder;
    private SiteContext _context;

    [TestFixtureSetUp]
    public void FixtureSetUp()
    {

        _context = new SiteContext(); // connection string is taken from app.config file

        _seeder = new DatabaseSeeder(_context);
        _seeder.InitialiseDb();  // create database structure

        ProjectRepository projectRepository = new ProjectRepository(_context);

        _projectDataService = new ProjectDataService(projectRepository);

    }

    [SetUp]
    public void TestSetUp()
    {
        _seeder.SeedDatabase(); // put some test data from a script
    }

    [TearDown]
    public void TestTearDown()
    {
        _seeder.RemoveData(); // delete everything from all the tables
    }

    /**************** Tests are here! ********************/

    [Test]
    public void CheckDatabaseConnectivity()
    {
        Assert.Pass();
    }

    [Test]
    public void GetNoProjectsForUser()
    {   // should return no project for this user, as nothing is assigned
        var user = _seeder.Users[0];
        var projects = _projectDataService.GetUserProjects(user);

        Assert.IsEmpty(user.UserProjectRoles);
        Assert.IsEmpty(projects);
    }

    [Test]
    public void GetAllProjetsForUser()
    {
        var user = _seeder.Users[2];
        var projects = (List<Project>)_projectDataService.GetUserProjects(user);
        int count = user.UserProjectRoles.Count;

        Assert.AreEqual(count, projects.Count);

        Assert.False(projects.Contains(_seeder.Projects[0]));
    }
 } 
```

控制器以普通的单元测试方式进行测试：

```
 [TestFixture]
    class ProjectsControllerTest
    {
        private ProjectsController _projectController;

        private Mock<IProjectDataService> _projectDataService;
        private Mock<ICurrentUserService> _currentUserService;

        [SetUp]
        public void SetUp()
        {
            MapperConfig.SetMappings();

            _projectDataService = new Mock<IProjectDataService>();
            _currentUserService = new Mock<ICurrentUserService>();

            _currentUserService.Setup(s => s.GetCurrentAppUser()).Returns(new AppUser());

            _projectController = new ProjectsController(_projectDataService.Object, _currentUserService.Object);
        }

        [Test]
        public void InstanceOfProjectController()
        {
            Assert.IsInstanceOf<ProjectsController>(_projectController);
        }

        [Test]
        public void Index()
        {
            var projects = new List<Project>() { new Project() { Name = "one" }, new Project() { Name = "two" } };

            _projectDataService.Setup(s => s.GetUserProjects(It.IsAny<AppUser>())).Returns(projects);

            var view = _projectController.Index();

            Assert.IsInstanceOf<AutoMapViewResult<List<ProjectViewModel>>>(view);
        }
} 
```

**并且不要忘记，没有任何自动化测试可以取代真实的人通过系统并单击随机按钮，试图破坏事物。很多时候单元测试缺少来自用户的随机输入。这在机器上是很难模仿的。**

# python - 有条件地合并列表

> ID：12424759
> 
> 赞同：2
> 
> 时间：2012-09-14T12:40:01.893
> 
> 标签：python, list, merge, conditional

假设我有两个列表

```
[16, 0, 0, ';', 17, 0, 2, ';', 0, 2, 1, ';']
  [-1, 0, ';', 0, -2, ';', -2, -1, ';'] 
```

有没有一种更简单的方法可以在满足“;”时有条件地合并这些列表元素 字符而不是单独遍历它们并将它们组合起来？

输出应该是

```
[16, 0, 0, -1, 0, ';', 17, 0, 2, 0, -2, ';', 0, 2, 1, -2, -2,';'] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T12:43:40.103

```
def get_part(lst,sep=';'):
    out = []
    for i in lst:
        if i == sep:
           yield out
           out = []
        else:
           out.append(i) 
```

现在我们可以将您的列表压缩在一起：

```
merged = []
for l1,l2 in zip(get_part(list1),get_part(list2)):
    merged.extend(l1)
    merged.extend(l2)
    merged.append(';') 
```

当然，在它的核心，这本质上是对它们进行迭代并结合......所以在回答你的问题时，我认为没有更好的方法。

* * *

也许存储列表的更好方法是将它们存储为列表列表 - 例如：

```
list1 = [[16, 0, 0], [ 17, 0, 2], [ 0, 2, 1] ] 
```

像这样存储，你可以这样做：

```
merged = [ l1 + l2 for l1,l2 in zip(list1,list2) ] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:47:28.427

```
>>> from itertools import groupby, izip, chain
>>> L1=[16, 0, 0, ';', 17, 0, 2, ';', 0, 2, 1, ';']
>>> L2=[-1, 0, ';', 0, -2, ';', -2, -1, ';']    
>>> g1 = groupby(L1, key=';'.__eq__)
>>> g2 = groupby(L2, key=';'.__eq__)
>>> [i for i1,i2 in izip(g1, g2) for i in ([';'] if i1[0] is True else chain(i1[1], i2[1]))]
[16, 0, 0, -1, 0, ';', 17, 0, 2, 0, -2, ';', 0, 2, 1, -2, -1, ';'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T13:54:07.033

更多 itertools 疯狂：

```
from itertools import groupby, chain, izip, repeat

a = [16, 0, 0, ';', 17, 0, 2, ';', 0, 2, 1, ';']
b = [-1, 0, ';', 0, -2, ';', -2, -1, ';']

wanted = [16, 0, 0, -1, 0, ";",
          17, 0, 2, 0, -2, ';',
          0, 2, 1, -2, -1,";"]

def split(items, sep=";"):
    return (group for key, group in
            groupby(items, lambda item: item != sep) if key)

got = list(
    chain.from_iterable(
        chain.from_iterable(
            izip(split(a), split(b), repeat([";"])))))
assert got == wanted 
```

# mysql - phpmyadmin 不会导入 funstuff.sql.zip 文件

> ID：12424760
> 
> 赞同：0
> 
> 时间：2012-09-14T12:40:04.687
> 
> 标签：mysql, phpmyadmin, mamp

我正在尝试将 database.sql.zip 导入到 phpmyadmin，因为它需要大量导入解压缩。

我正在使用 Mamp。

但是当我尝试导入数据库时​​，使用正确的 utf8。

当我按下 go PHPMYADMIN 显示这个

![白页](../Images/c0a7b9c50cc84ad4b566d935e1bcc3d0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T11:59:32.527

哦，

我想通了为什么，它是给问题的 zip 文件，例如，当你使用另一种格式时`gzip`，一切都很顺利:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-01T09:09:14.663

1.  登录到你的 mysql shell “mysql -u root”
2.  导航到数据库“使用 yourDbName”
3.  运行这个“源 /path/to/that/file.sql”

# css - 每个项目之间的菜单行

> ID：12424767
> 
> 赞同：1
> 
> 时间：2012-09-14T12:40:51.823
> 
> 标签：css, menu, space

这是我的布局菜单：

[http://gyazo.com/da1f1954a34694facaaab8ce6c92b267](http://gyazo.com/da1f1954a34694facaaab8ce6c92b267)

你能看到每个菜单项之间的黑白低不透明度线吗？我怎样才能把它们做成那个尺寸？您还可以看到每个菜单项中都有一个空间量的空间，我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:53:34.357

1) 对于边框，使用 rgba：

```
your_li_element_selector {
    border-right: 1px solid rgba(255, 255, 255, 0.5); /* white border with opacity 50% */
    border-left: 1px solid rgba(0, 0, 0, 0.5); /* black border with opacity 50% */
} 
```

隐藏第一个菜单项的左边框：

```
your_li_element_selector:first-child {
    border-left: 0;
} 
```

隐藏最后一个菜单项的右边框：

```
your_li_element_selector:last-child {
    border-right: 0;
} 
```

2）用于空间使用`margin`和元素及其内部`padding`的属性。`li``a`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:14:05.540

您可以使用 RGBA 进行左边框和右边框并降低不透明度。第一个孩子和最后一个孩子删除额外的边框。缺点是上述内容在某些较旧的浏览器中不起作用。正如@dev 所说，最合适的可能是使用图像。

使用 RGBA、第一个孩子和最后一个孩子的示例：http: [//jsfiddle.net/Ra9NT/](http://jsfiddle.net/Ra9NT/)

# android - 无法从 youtube 下载视频

> ID：12424768
> 
> 赞同：1
> 
> 时间：2012-09-14T12:40:51.660
> 
> 标签：android, youtube, download

我正在使用 [http://www.youtube.com/get_video_info?video_id=](http://www.youtube.com/get_video_info?video_id=) *VIDEO_ID* 并从我得到的数据中解析 url_encoded_fmt_stream_map 并得到像

```
http://blah.youtube.com/videoplayback?blah 
```

早些时候我可以使用这个网址下载视频，但现在我无法再下载视频了。任何人都知道为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-04T17:29:53.817

以下是返回视频网址的代码：

youtube-dl 的所有功劳我只复制了提取 url 所需的脚本部分

```
video_id = "yourvideoid"
for el_type in ['&el=embedded', '&el=detailpage', '&el=vevo', '']:
    video_info_url = ('http://www.youtube.com/get_video_info?&video_id=%s%s&   ps=default&eurl=&gl=US&hl=en'
                     % (video_id, el_type))
    request = urllib2.Request(video_info_url)
    try:
        video_info_webpage = urllib2.urlopen(request).read()
        video_info = parse_qs(video_info_webpage)
        if 'token' in video_info:
            break
    except (urllib2.URLError, httplib.HTTPException, socket.error), err:
        print('ERROR: unable to download video info webpage: %s' % str(err))
video_url_list = video_info['url_encoded_fmt_stream_map'][0]
url_data_strs = video_info['url_encoded_fmt_stream_map'][0].split(',')
url_data = [parse_qs(uds) for uds in url_data_strs]
url_data = filter(lambda ud: 'itag' in ud and 'url' in ud, url_data)
url_map = dict((ud['itag'][0], ud['url'][0] + '&signature=' + ud['sig'][0]) for ud in  url_data)
print(str(url_map)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T21:02:15.557

不知道为什么，但它似乎[影响了所有下载器扩展](http://malaysia.answers.yahoo.com/question/index;_ylt=Ans_6xNo6cejU7csGqs0c0m4QAx.;_ylv=3?qid=20120913130136AA8hpdL)，所以它几乎肯定在 YouTube 方面。我假设它与知识产权有关。YouTube“旨在”成为流媒体网站，而不是视频文件存储库。

[addons.mozilla.com 的 Shutaro](https://addons.mozilla.org/en-US/firefox/addon/video-downloadhelper/reviews/382210/)发现了一种解决方法，该解决方法需要强制 YouTube 恢复为提供较旧的 .webm 格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T10:47:14.277

我遇到了同样的问题，据我从其他修复它的人那里了解到，我们需要向视频链接（返回的 mp4 或 3gp 链接）添加签名......我正在调查这个并将更新。如果你发现任何东西，我希望你也能这样做。

# python - 将列表元素转换为像这样的列表的更好方法

> ID：12424770
> 
> 赞同：2
> 
> 时间：2012-09-14T12:40:53.780
> 
> 标签：python, python-3.x, python-3.2

我认为这应该很容易，但我真的不知道如何以更好的方式编写它，如果你知道请告诉我

```
#there are some points in text files and was read into a list
s = ['3,4','4,5','6,5','7,8']
#break s element to (x,y) form every element should convert to number type
points = [] 
for pStr in s:
    ss = pStr.split(',')
    points.append([int(p) for p in ss])
print(points) #[[3, 4], [4, 5], [6, 5], [7, 8]] 
```

请最好把它写在一行中

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T12:44:57.910

使用列表理解：

```
In [19]: s = ['3,4','4,5','6,5','7,8']

In [21]: [[int(y) for y in x.split(',')] for x in s]
Out[21]: [[3, 4], [4, 5], [6, 5], [7, 8]] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-14T12:42:10.290

如果使用 Python 2.x，您可以执行以下操作：

```
points = [map(int, x.split(',')) for x in s] 
```

如果使用 Python 3.x，您需要将 map() 的结果传递给 list()，因为它返回一个迭代器：

```
points = [list(map(int, x.split(','))) for x in s] 
```

在行动：

```
>>> s = ['3,4','4,5','6,5','7,8']
>>> points = [map(int, x.split(',')) for x in s]
>>> print(points)
[[3, 4], [4, 5], [6, 5], [7, 8]] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:55:47.377

```
>>> s = ['3,4','4,5','6,5','7,8']
>>> from ast import literal_eval
>>> [literal_eval(x) for x in s]
[(3, 4), (4, 5), (6, 5), (7, 8)] 
```

如果你*真的需要*列表列表

```
>>> [list(literal_eval(x)) for x in s]
[[3, 4], [4, 5], [6, 5], [7, 8]] 
```

# asp.net - 我无法访问网络服务，该怎么办？

> ID：12424774
> 
> 赞同：1
> 
> 时间：2012-09-14T12:41:07.850
> 
> 标签：asp.net, web-services, soap, asmx

```
The request failed with HTTP status 401: Unauthorized. 
```

当我在浏览器中进行测试时，它可以工作，但是当我从另一个应用程序调用它时，我无权访问。该怎么办？Web 服务使用 Windows 身份验证的应用程序。我想问题可能就在那里！

**我解决了它：**

*它们在同一个域上，但不在同一个应用程序上。我通过 web 服务调用通过了身份验证：*

```
 cm.Credentials = System.Net.CredentialCache.DefaultCredentials; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:54:54.140

Web 服务的 Windows 身份验证提供了一些挑战；我相信，Web 服务需要在同一个域上才能工作，以便它可以使用用户的凭据。

您必须使用 Windows 凭据吗？使用要求用户首先通过另一种 Web 服务方法登录的票务系统也可以正常工作。

# java - 静态变量没有正确返回？

> ID：12424776
> 
> 赞同：2
> 
> 时间：2012-09-14T12:41:11.813
> 
> 标签：java, android

我正在构建一个小应用程序，它现在可以很好地与服务和活动配合使用。

虽然，我试图在登录时将一些静态信息（比如服务是否已经启动？）保存到静态布尔值 isRunning 中。它会在 onCreate() 时设置为 true，但是当我稍后从活动中调用它时，它总是返回 false。

**从服务：**

```
public static boolean isRunning = false;

public void onCreate() {
        super.onCreate();
    isRunning = true;
} 
```

有谁知道为什么这不起作用？我尝试使用一些日志来弄清楚发生了什么，但我似乎无法弄清楚。

**从活动**

```
public void onResume() {
        super.onResume();
        if(mIsBound) {
            Log.i(LOG_TAG, "Resuming: Service is running");
            if(Service.isRunning) {
                Log.e(LOG_TAG, "SERVICE IS RUNNING!");
            } else {
                Log.e(LOG_TAG, "SERVICE IS NOT RUNNING!");
            }
        } else {
            Log.i(LOG_TAG, "Resuming: Service NOT running");
        }
        StopCheck.setChecked(mIsBound);
    } 
```

mIsBound 是由活动创建以绑定到服务的（我希望它重新绑定，但这似乎是不可能的），并且它在当前状态下是可靠的。但不是在该活动之外，这就是我想要使用静态变量的目的。如果 mIsBound 等于 true，Service.isRunning 应该返回 true。然而，我日志中那个小测试的结果是“正在恢复：服务正在运行”，然后是“服务未运行”。

任何建议或问题都非常感谢。

**根据要求：AndroidManifest.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.somnu.ServiceTest"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="7" />

    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.INTERNET" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".Login"
            android:debuggable="true"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".Activity"
            android:debuggable="true"
            android:label="@string/app_name" >
        </activity>

        <service
            android:name=".Service"
            android:process=":Service" >
        </service>

    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:53:54.743

删除**android:process**

> **运行服务的进程的名称。**通常，应用程序的所有组件都在为应用程序创建的默认进程中运行。它与应用程序包同名。元素的 process 属性可以为所有组件设置不同的默认值。但是组件可以使用自己的进程属性覆盖默认值，从而允许您将应用程序分布在多个进程中。

```
If the name assigned to this attribute begins with a colon (':'), a new process, private to the application, is created when it's needed and the service runs in that process. If the process name begins with a lowercase character, the service will run in a global process of that name, provided that it has permission to do so. This allows components in different applications to share a process, reducing resource usage. 
```

# php - 在mongodb php中查询数组和更新（索引未知）中的值？

> ID：12424778
> 
> 赞同：0
> 
> 时间：2012-09-14T12:41:19.373
> 
> 标签：php, mongodb

我想查询数组中的特定值并更新它，但我不知道索引。以下是内容。

```
{ "_id" : ObjectId("50072b17b4a6de3b1100000f")
"employment_details" : [
 {
     "_id" : ObjectId("50072b17b4a6de3b11000015"),
     "title" : "Information Technology Compliance & Security",
     "rank" : null,
     "department" : null,
     "current" : false,
     "company_id" : ObjectId("5007269fb4a6de941001d19d")
 }
......
{
     "_id" : ObjectId("50072b17b4a6de3b11000018"),
     "title" : "security engineer",
     "rank" : null,
     "department" : null,
     "current" : false,
     "company_id" : ObjectId("5007269fb4a6de941001dasd")
 }
{
     "_id" : ObjectId("50072b17b4a6de3b11000016"),
     "title" : "software Engineer",
     "rank" : null,
     "department" : null,
     "current" : true,
     "company_id" : ObjectId("5007269fb4a6de94100189e")
}  
] 
```

如果**_id**匹配**ObjectId("50072b17b4a6de3b1100000f")****并且**company_id**匹配**ObjectId **("5007269fb4a6de94100189e")** ，我想更改数组中特定对象的特定**当前**字段（我不知道索引） 。

 ******这是我所做的。但不更新。

```
$criteria = array("_id" => $mongo_id, "employment_details.company_id" => $company_id);
$new_object = array('$set' => array('employment_details.$.current' => "false", "updated_at" => $time));
$mycollection->update($criteria,$new_object); 
```

如何进行这样的更新？******

# c++ - 将 double 转换为 int 的结果是错误的

> ID：12424779
> 
> 赞同：5
> 
> 时间：2012-09-14T12:41:30.460
> 
> 标签：c++, casting, floating-accuracy

当我运行以下代码时，似乎存在某种模糊的舍入错误：

```
int roundedTotal = (int)(PriorityJob * 100.0); 
```

最初是未定义的`PriorityJob = 1.4`。在这一点上进行`roundedTotal`评估给出. 之后。`PriorityJob * 100.0``140``roundedTotal = 139`

显然，140.0 被解释为 139.99999。这是浮点引擎的缺陷吗？我从来没有见过这样的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T12:52:41.590

几乎每台现代计算机都使用[二进制表示](http://en.wikipedia.org/wiki/IEEE_floating_point)浮点数。

正如`1/3 = 0.33333333...`不能完全表示为小数一样，`1/10`（因此大多数非整数十进制值，包括`1.4`）也不能完全表示为二进制分数。相反，它将由最接近的可表示值表示，该值可能略大于或小于“真实”值。

您可能想要四舍五入到最接近的整数：`(int)(PriorityJob * 100.0 + 0.5)`

# php - Symfony2 价格输入和显示

> ID：12424782
> 
> 赞同：2
> 
> 时间：2012-09-14T12:41:43.140
> 
> 标签：php, symfony

我在 Symfony2 中使用[FormBuilder](http://symfony.com/doc/current/book/forms.html)创建了带有数字字段的表单：

```
$builder->add('price', 'number'); 
```

字段仅正确处理使用“，”（逗号）用作小数分隔符（每个区域设置）的数字，但我希望它也使用“。”解析数字。（点）用作小数分隔符。现在“。”后面的数字 （点）被忽略。

我应该怎么做才能使用两种类型的小数分隔符处理这两种价格？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:53:40.710

看看[这个组件](http://symfony.com/doc/current/reference/forms/types/money.html)，虽然我不知道它是如何呈现的。

无论如何，您可以尝试使用自定义正则[表达式](http://symfony.com/doc/2.0/reference/constraints/Regex.html)验证器约束，要求类似`number + dotOrComma + number`.

或者免费出售您的商品，无需价格标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T19:25:37.580

您需要创建一个自定义类型，使用核心类型的代码作为参考点。

请参阅[此开放功能请求](https://github.com/symfony/symfony/issues/2059)以供参考。

# google-app-engine - 计数方法抛出 500 错误

> ID：12424783
> 
> 赞同：1
> 
> 时间：2012-09-14T12:41:46.413
> 
> 标签：google-app-engine, gql

我陷入了困境。我想知道基于每日、每周、每月和所有时间的 Fetch 计数。在 Datastore 中，计数约为 2,368,348。每当我尝试通过 Model 或 GqlQuery 获取计数时，我都会收到 500 错误。当行数较少时，下面的代码工作正常。

请任何大师纠正我或告诉我正确的解决方案吗？我正在使用 Python。

该模型：

```
class Fetch(db.Model):
    adid = db.IntegerProperty()
    ip = db.StringProperty()
    date = db.DateProperty(auto_now_add=True) 
```

统计代码：

```
adid = cgi.escape(self.request.get('adid'))
...
query = "SELECT __key__ FROM Fetch WHERE adid = " + adid  + " AND date >= :1"  
rows = db.GqlQuery( query, monthlyDate)
fetch_count = 0
for row in rows:
   fetch_count = fetch_count + 1
self.response.out.write( fetch_count) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T16:12:20.610

看起来您的查询花费的时间比 GAE 允许查询运行的时间长（通常约为 60 秒）。从[count() 文档](https://developers.google.com/appengine/docs/python/datastore/queryclass#Query_count)：

> 除非预期结果计数很小，否则最好指定一个限制参数；否则该方法将继续执行，直到完成计数或超时。

从[请求计时器文档](https://developers.google.com/appengine/docs/python/runtime#The_Request_Timer)中：

> 请求处理程序生成并返回对请求的响应的时间有限，通常约为 60 秒。一旦达到最后期限，请求处理程序就会被中断。

如果 a`DeadlineExceededError`被提出，这是你的问题。如果您需要运行此查询，请考虑在 GAE 中使用[后端。](https://developers.google.com/appengine/docs/python/backends/)使用后端，生成和返回请求没有时间限制。

# php - 如何使用 slickgrid 显示 mysql 数据库内容？

> ID：12424785
> 
> 赞同：0
> 
> 时间：2012-09-14T12:41:49.807
> 
> 标签：php, mysql, html, slickgrid

新手堆栈溢出，尽我所能正确地问这个问题。

目标：

1.  通过 slickgrid 在 html 页面中显示 mysql 数据库的内容。
2.  能够使用来自 jquery ui 主题滚轮的主题来设置此网格的样式。
3.  能够通过此界面编辑和添加记录到数据库中。

研究：

我寻找了所有主要的“网格”应用程序并遇到了：

*   phpgrid
*   jqgrid
*   数据表
*   柔性网格

并在此处浏览了网格列表：

*   [20 个 JQuery Table Datagrid 插件](http://superdit.com/2012/01/18/20-jquery-table-datagrid-plugins/)

并读到 jquery ui 团队实际上将发布他们自己的网格，但它目前处于暂停状态。

因此，通过这项研究，我决定使用 slickgrid，因为人们说它速度很快，而且我喜欢干净的布局以及它可以使用 jquery ui 进行蒙皮的事实（而且它是免费的）。

我发现使用 slickgrid 从数据库获取数据的大多数语法和方法我无法理解（这些领域的新手），但我发现的最接近一组“指令”的是：

[SlickGrid AJAX 数据](https://stackoverflow.com/questions/6668613/slickgrid-ajax-data)

但是我卡在第 5 步。

所以我想这篇文章是在问，任何人都可以为新手提供有关如何：

1.  通过 slickgrid 在 html 页面中显示 mysql 数据库的内容。
2.  可以通过这个界面编辑和添加记录到数据库中。

我已经从[slickgrid github 页面](https://github.com/mleibman/SlickGrid)下载了包含现有示例的 zip 文件。

谢谢你！

ps 我有提到的所有应用程序和来源的链接，但作为一个新用户，不能发布两个以上的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:55:54.667

最后，这一切都归结为在表格中显示数据。所有的网格都从 中选择一个表`DOM`，并“增强”它们。

作为一个新手，在设置一个带有 JQuery/Javascript 网格的页面之前，我建议首先让它作为一个“普通”表工作。当一切正常时，更容易理解网格的作用。

这应该可以帮助您：

```
 <table>
    <?
    $entries = $this->model->FindAll();
    if ( $entries )
      foreach ( $entries as $entry ) {
        ?>
        <tr>
          <td><?= $entry['admid'] ?></td>
          <td><?= $entry['admname'] ?></td>
          <td><?= $entry['admemail'] ?></td>
        </tr>
        <?
      }
    ?>
  </table> 
```

*我使用“ Datatables.net* ”获得了一些不错的结果，但大多数网格仅在易于配置和功能集方面有所不同。

# c - 检查字节是 0x00 还是 0xFF 的算法

> ID：12424786
> 
> 赞同：1
> 
> 时间：2012-09-14T12:42:04.137
> 
> 标签：c, boolean-logic

是否有一个逻辑等价于：

~~`if(byte != 0x00 || byte != 0xFF)`~~

```
if(byte != 0x00 && byte != 0xFF) 
```

我处于程序内存限制并且可以使用每个优化:)

用文字来解释，如果所有位都相同（所以全 0 或全 1），你能用逻辑函数检查吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T12:46:37.390

也许`(unsigned char)(byte + 1) > 1`？假设你的意思是`&&`，当然。并假设`CHAR_BIT == 8`，如果你想要“所有位设置”的意思`0xFF`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-14T12:48:15.673

假设它`byte`有一个无符号的 8 位类型 [编辑：并假设你的意思是`&&`，不是`||`]，你可以尝试：

```
!((uint8_t)(byte+1) <= 1) 
```

显然不能说这是否会产生更小的代码，你只需要试试看。毫无疑问，其他人可以提出其他逻辑等价的表达方式。

您还可以查看编译器生成的内容，如果您怀疑编译器的优化不是很好，请查看其他更好的编译器生成的内容。这可能会为您提供逻辑上等价的其他表达式的想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T12:50:03.723

条件始终为真。

~~我严重怀疑上述检查是否可以压缩很多。~~

在指令级别，if 看起来像：

```
; if(byte != 0x00 || byte != 0xFF) 
cmp byte, 0
jnz ifbody
cmp byte, 0xFF
jz skipifbody
ifbody:
;{
; if body
;}
skipifbody: 
```

这里有大约 4 条指令。这里没有太多需要优化的地方。

~~我会在代码中寻找其他地方来优化大小。不过，首先要看的是数据，而不是代码。~~

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-14T13:46:03.733

我发现，鉴于您的原始代码 GCC 足够聪明，可以在使用时产生类似于 Kerrek SB 的答案`-O2`：

```
movzbl  8(%ebp), %eax
subl    $1, %eax
cmpb    $-3, %al
setbe   %al 
```

这基本上相当于：

```
((unsigned char)byte - 1) <= -3 // or 0xFD 
```

# php - 如何检查 PHP 中是否存在 shell 命令

> ID：12424787
> 
> 赞同：37
> 
> 时间：2012-09-14T12:42:05.147
> 
> 标签：php, linux, exec

我在php中需要这样的东西：

```
If (!command_exists('makemiracle')) {
  print 'no miracles';
  return FALSE;
}
else {
  // safely call the command knowing that it exists in the host system
  shell_exec('makemiracle');
} 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-09-14T12:55:21.157

在 Linux/Mac OS 上试试这个：

```
function command_exist($cmd) {
    $return = shell_exec(sprintf("which %s", escapeshellarg($cmd)));
    return !empty($return);
} 
```

然后在代码中使用它：

```
if (!command_exist('makemiracle')) {
    print 'no miracles';
} else {
    shell_exec('makemiracle');
} 
```

**更新：** 正如@camilo-martin 所建议的，您可以简单地使用：

```
if (`which makemiracle`) {
    shell_exec('makemiracle');
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-08-30T19:28:19.503

Windows 使用`where`、UNIX 系统`which`允许本地化命令。如果找不到该命令，两者都将在 STDOUT 中返回一个空字符串。

PHP_OS 当前是 PHP 支持的每个 Windows 版本的 WINNT。

所以这里有一个便携式解决方案：

```
/**
 * Determines if a command exists on the current environment
 *
 * @param string $command The command to check
 * @return bool True if the command has been found ; otherwise, false.
 */
function command_exists ($command) {
  $whereIsCommand = (PHP_OS == 'WINNT') ? 'where' : 'which';

  $process = proc_open(
    "$whereIsCommand $command",
    array(
      0 => array("pipe", "r"), //STDIN
      1 => array("pipe", "w"), //STDOUT
      2 => array("pipe", "w"), //STDERR
    ),
    $pipes
  );
  if ($process !== false) {
    $stdout = stream_get_contents($pipes[1]);
    $stderr = stream_get_contents($pipes[2]);
    fclose($pipes[1]);
    fclose($pipes[2]);
    proc_close($process);

    return $stdout != '';
  }

  return false;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-03-21T08:56:34.790

基于@jcubic和[应该避免的'which'](http://stackoverflow.com/a/677212/937377)，这是我想出的跨平台：

```
function verifyCommand($command) :bool {
  $windows = strpos(PHP_OS, 'WIN') === 0;
  $test = $windows ? 'where' : 'command -v';
  return is_executable(trim(shell_exec("$test $command")));
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-14T12:54:33.653

您可以使用[is_executable](http://jp.php.net/manual/en/function.is-executable.php) 来检查它是否可执行，但您需要知道命令的路径，您可以使用`which`command 来获取它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-18T11:12:30.503

平台独立解决方案：

```
function cmd_exists($command)
{
    if (\strtolower(\substr(PHP_OS, 0, 3)) === 'win')
    {
        $fp = \popen("where $command", "r");
        $result = \fgets($fp, 255);
        $exists = ! \preg_match('#Could not find files#', $result);
        \pclose($fp);   
    }
    else # non-Windows
    {
        $fp = \popen("which $command", "r");
        $result = \fgets($fp, 255);
        $exists = ! empty($result);
        \pclose($fp);
    }

    return $exists;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-14T16:49:15.823

基于@xdazz 的回答，适用于 Windows 和 Linux。也应该在 MacOSX 上工作，因为它是 unix。

```
function is_windows() {
  return strtoupper(substr(PHP_OS, 0, 3)) === 'WIN';
}

function command_exists($command) {
    $test = is_windows() ? "where" : "which";
    return is_executable(trim(shell_exec("$test $command")));
} 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2012-09-14T12:46:07.660

不是，没有。

即使直接访问 shell，您也不知道命令是否存在。有一些技巧，例如`wheris`or`find / -name yourcommand`但不是 100% 保证您可以执行命令。

# dojo - 网格启动后更改数据网格中一个单元格的颜色

> ID：12424788
> 
> 赞同：1
> 
> 时间：2012-09-14T12:42:07.473
> 
> 标签：dojo

在网格启动后，我无法更改数据网格的一个单元格。我想改变一些单元格的颜色，我需要询问这个单元格是否有另一个值作为另一列中的单元格，然后如果这是真的改变颜色。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:45:09.997

Try

```
var rows = dojo.query(".dojoxGridRow", grid.domNode);
var cellsInSecondRow = dojo.query("td", rows[1]);
var cellTwoInSecondRow = = dojo.query("td[idx='1']", rows[1]); 
```

etc..

# php - Symfony2 阻止标准 php 包含？

> ID：12424789
> 
> 赞同：0
> 
> 时间：2012-09-14T12:42:09.113
> 
> 标签：php, symfony, include

我有一种情况，我打算离开面向对象的大纲，只是将原始 php 文件包含到我的一个控制器中。

我想在实体的表单树枝文件中包含未知数量的额外表单字段的原因（这些表单字段在我想要包含的单独文件中定义）。

我的意图是在提交操作中循环这些字段（比如 data_1、data_2 等）并将它们序列化并将它们存储在实体属性“数据”中。然后，将输出该实体结果的视图也将根据模板类型知道预期有多少和哪些额外字段，并以正确的方式输出它们，这要归功于为每个包含视图模板的类似设计模板类型。

现在，当这样做时：

```
 //All template form files store all their html in $output
    include '/'.$templatePath.'/form.php';

    return $output; 
```

我收到一个 symfony 错误（不是 php 错误！）说

```
Warning: include(/main/1/form.php) [<a href='function.include'>function.include</a>]: failed to open stream: No such file or directory in /var/www/biztv/src/BizTV/ContentManagementBundle/Controller/DefaultController.php line 136 
```

那么这只是说我错误地追踪了我试图包含的路径，还是像我怀疑的那样，它是 symfony2 的禁止行为？还有其他方法可以完成我在这里尝试的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T14:18:55.283

只看你的代码，你的路径开头有一个斜杠，它将指向根文件系统......

使用正确的相对路径（假设您当前的文件是 Controller/xxx.php 并且您的表单在 Forms/form.php 中）：

```
include __DIR__.'/../Forms/form.php'; 
```

但是您应该使用输出缓冲来捕获包含 .php 文件的结果，然后将内容传递给您的 twig 模板。否则它可能会干扰应该发送哪些标头等。

在你的控制器中：

```
ob_start();
include __DIR__.'/../Forms/form.php';
$formContent = ob_clean();

...

return $this->render('tpl.html.twig', array(
    'form_content' => $formContent,
)); 
```

然后在你的树枝模板中：

```
{{ form_content|raw }} 
```

# java - 如何等到我的 java 函数删除所有文件？

> ID：12424792
> 
> 赞同：0
> 
> 时间：2012-09-14T12:42:12.487
> 
> 标签：java, delete-file, reboot

我有问题。
我有一个删除一些文件然后重新启动系统的功能。它包含很多文件，所以在整个文件集被删除之前，我的重启命令正在执行。

如何在我的 Java 代码中解决这个问题。

要删除文件，我正在使用：

```
Runtime.exec("/bin/rm -rf /myDir");
Runtime.exec("/bin/shutdown -r now"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:43:54.940

您可以使用`Process`返回的 by`exec`并等待它完成：

```
Process p = Runtime.exec("/bin/rm -rf /myDir");
p.waitFor();
Runtime.exec("/bin/shutdown -r now"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:45:07.803

您可以使用 Process.waitFor() 等待命令完成，或者您可以一次性完成所有操作。

```
Runtime.exec("/bin/sh -c '/bin/rm -rf /myDir ; /bin/shutdown -r now'"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:44:26.087

Runtime.exec 方法返回一个 Process ，您可以在其上调用[waitFor 方法](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Process.html)。

为第一个命令执行此操作，然后立即启动第二个命令。

# erlang - 对于具有重复字段的消息，erlang_protobuffs 未按预期解码

> ID：12424793
> 
> 赞同：1
> 
> 时间：2012-09-14T12:42:16.993
> 
> 标签：erlang, protocol-buffers

我正在开发一个使用 google proto 缓冲区进行内部数据交换的项目。它像宣传的那样工作正常，但是对于其中包含重复字段的消息，它不能按预期工作。这是一个例子：

示例`test.proto`文件：

```
message Test {
    optional string t = 1;
}

message Tests {
    repeated Test testsList = 1;
} 
```

生成erlang代码：

```
1> protobuffs_compile:scan_file("test.proto").
=INFO REPORT==== 14-Sep-2012::16:38:25 ===
Writing header file to "test_pb.hrl"

=INFO REPORT==== 14-Sep-2012::16:38:25 ===
Writing beam file to "test_pb.beam"
ok 
```

生成`test_pb.hrl`：

```
-ifndef(TEST_PB_H).
-define(TEST_PB_H, true).
-record(test, {
    t
}).
-endif.

-ifndef(TESTS_PB_H).
-define(TESTS_PB_H, true).
-record(tests, {
    testslist = []
}).
-endif. 
```

编码：

```
5> test_pb:encode_tests({tests, [{test, <<"t">>}]}).
<<10,3,10,1,116>> 
```

解码：

```
6> test_pb:decode_tests(<<10,3,10,1,116>>).
{[{test,"t"}],undefined} 
```

如上例所示，解码不会返回预期的记录元组：

```
{tests, [{test, <<"t">>}]} 
```

以前有人遇到过类似的问题吗？我在哪里错过了诀窍？任何指示和帮助将不胜感激。

对于版本信息，我的 rebar.config 中的 deps 行：

```
{protobuffs, "0.7.0", {git, "git://github.com/basho/erlang_protobuffs.git", {tag, "0.7.0"}}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T14:21:25.830

只是为了更新。

`0.7.0`，`0.6.0`并且`HEAD`都给了我与上述相同的问题。

在讨论了#riak IRC 之后，我意识到我们需要使用这个提交哈希标记的稳定版本：`e0f5f6ea4c3dcb4e7b824496d2b48333fbd5a8c8`它解决了上述问题。

# php - 仅在将新内容添加到数据库时才刷新 div 的内容

> ID：12424795
> 
> 赞同：2
> 
> 时间：2012-09-14T12:42:20.207
> 
> 标签：php, jquery, mysql

是否只有在将新内容添加到数据库时才能刷新 div 内容？

我将它用于出现在侧边菜单中的“最近的帖子”。

现在 div 设置为每 10 秒刷新一次。

是否有可能以某种方式检查是否将新帖子添加到数据库中，然后仅将帖子数据添加到 div 中？

我正在使用 MySql、php 和 jquery 来完成所有这些工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:55:32.137

是的，您可以通过比较文本内容来做到这一点。

```
function updateHtmlContent() {
    var htmlContent=$('#divToUpdate').text();
    $.ajax({
        type: "GET",
        datatype: "text",
        //php function that should give you the text back
        url: 'dataBaseFunction.php',
        success: function(data) {
            if (htmlContent != data) {
                $('#divToUpdate').text(data);
            }
        }
    });
}

//compare and upate every 20 seconds
setInterval(updateHtmlContent(), 20000); 
```

希望这有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T11:52:23.310

**YES IT IS POSSIBLE**

The below code will get the recent photos that has been added:

1.  AFTER THE TIMER.PHP WAS LAODED (or your wordpress blog page)
2.  AND ONLY AFTER A NEW PHOTO IS ADDED (you can use it for recent posts, comments, or anything)

This can be used to create a live blog for example, where the user will see all the recent comments, images or posts, or everything, even if he doesn't reload the current page. And it won't consume a lot of bandwidth as the content will be reloaded ONLY IF THERE IS NEW ADDED (it will only send a tiny check in the database otherwise).

I've just finished working out a solution for that, and I have to share it with you. I was doing it for Wordpress, i needed a function that gets the photos that has been added **ONLY** after the user loaded the page. It could be done by simply refreshing the div every 5 seconds, but imagine if there were 20 photos, and they had to be refreshed every 5 seconds... that's a lot of MB of data. So we will refresh them **ONLY when a new photo is added** (you can apply it to anything, from posts to comments or users, etc.).

There are 3 PHP files: **timer.php**, **check.php** and **display.php**.

The timer.php will load the check.php every 5 seconds, to check if new content is added. Notice the **-6 extraction** from the time of the current load of check.php.

The date-time of the timer.php will be passed (by **check.php?tim=**print date) through the check.php (by **display.php?timm='. $tizz .'**) and to the display.php, so we can use it for a reference in our database (that will be the time from where we will load all the images, if new images are added).

If any questions, just ask. It has to work for you too, as it works for me.

**ENJOY! :)**

Below are the 3 PHP files, just customize them for your needs:

THE **TIMER.PHP** (or your wordpress blog pages):

```
<script type="text/javascript" src="jquery.js"></script>

<script type="text/javascript">
        $(document).ready(function(){

            setInterval(function(){
                $("#quotex a").load("check.php?tim=<?php print date("Y-m-d H:i:s"); ?>");
            }, 5000);

        });
        </script>

        <div id="quote"><a></a></div>

        <div id="quotex"><a></a></div> 
```

THE **CHECK.PHP :**

```
 <?php 
     // Connects to your Database 
     mysql_connect("localhost", "username", "password") or die(mysql_error()); 
     mysql_select_db("database name") or die(mysql_error()); 

     // SQL query
        $strSQL = "SELECT * FROM wp_posts WHERE   post_mime_type LIKE 'image/jpeg' ORDER BY `wp_posts`.`id`  DESC LIMIT 1";

        // Execute the query (the recordset $rs contains the result)
        $rs = mysql_query($strSQL);

        // Loop the recordset $rs
        // Each row will be made into an array ($row) using mysql_fetch_array
        while($row = mysql_fetch_array($rs)) {

        $atime = $row['post_date'];

    $tizz = $_GET['tim'];    

    $dsff = $row['post_date'];;

    $duff = date("Y-m-d H:i:s");

    //convert the date-time into seconds so we can extract 6 seconds from it
    $six = strtotime(date("Y-m-d H:i:s"))-6; 

    //convert the latest image date-time too from database so we can compare it
     $sox = strtotime("$dsff");

     if ($six < $sox)
      {
      echo '<script type="text/javascript">$(document).ready( function(){ $("#quote a").load("display.php?timm='. $tizz .'"); } ); </script>';
      }
          }

        // Close the database connection
        mysql_close();

     ?> 
```

THE **DISPLAY.PHP**:

```
<?php 
$tipp = $_GET["timm"];
 // Connects to your Database 
 mysql_connect("localhost", "username", "password") or die(mysql_error()); 
 mysql_select_db("database name") or die(mysql_error()); 

 // SQL query
    $strSQL = "SELECT * FROM wp_posts WHERE   post_mime_type LIKE 'image/jpeg' AND post_date > '$tipp' ORDER BY `wp_posts`.`id`  DESC LIMIT 10";
    // Execute the query (the recordset $rs contains the result)
    $rs = mysql_query($strSQL);

    // Loop the recordset $rs
    // Each row will be made into an array ($row) using mysql_fetch_array
    while($row = mysql_fetch_array($rs)) {
    //guid is the column where the image url is located in the wordpress database table
    $atime = $row['guid'];

     echo "<img src='". $atime ."' /><br />";
      }
    // Close the database connection
    mysql_close();

 ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T12:49:03.687

我想你可能已经完成了大约 90% 的工作。我假设您每 10 秒在内容中使用 jQuery 到 AJAX（PS 这似乎很多？）

我认为您可以通过使后台功能从找到的最新帖子之后的帖子开始来解决您的问题。

因此，如果您的查询现在看起来像这样：

`SELECT a,b,c FROM foo`

你应该把它改成

`SELECT a,b,c FROM foo WHERE id > $last_found_id`

您可以存储`last_found_id`在您的 Javascript 中，并在调用该函数时将其发回。如果结果集为空，则不必刷新 div。

此更改还可能需要您预先/附加到 div 而不是完全覆盖它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T12:44:14.077

Yes 是可能的，但是您需要在其中创建一个方法`php`并使用它`Ajax`来刷新您的`div`.

如果您使用代码更新您的问题，我可以提供一个示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T12:49:35.247

查看`setInterval(function, time)`javascript 中的每个“时间”（以毫秒为单位）进行循环，

以及[`$.ajax()`](http://api.jquery.com/jQuery.ajax/)jQuery 中将信息传递给服务器的函数。

此外，您必须使用`.html()`或创建新内容[`.append()`](http://api.jquery.com/append/)

# php - MySQL - LEFT JOIN 什么都没有找到

> ID：12424797
> 
> 赞同：0
> 
> 时间：2012-09-14T12:42:21.327
> 
> 标签：php, mysql, database

我收到以下查询：

```
SELECT      budgets_income.income_amount, budgets_income.rule_type, budgets_income_rules.day_of_week, budgets_income_rules.interval_week, budgets_income_rules.fixed_day, budgets_income_rules.last_day_month, budgets_income_rules.date_start, budgets_income_rules.date_end
FROM        budgets_income
LEFT JOIN   budgets_income_rules USING (income_id)
WHERE       budgets_income.account_id = :account_id
    AND
    (
        budgets_income_rules.date_start <= :date_end
    ) 
```

如果`budgets_income.rule_type`等于 1 或 2，那么在表格中`budgets_income_rules`有一条我可以使用的规则`LEFT JOIN`- 这很好。

现在，有时如果规则等于 0，则意味着该规则不存在。由于该规则不存在，因此该字段也不存在`budgets_income_rules.date_start`- 这意味着该行不会与其他行一起获取（因为`WHERE budgets_income_rules.date_start <= :date_end`）。

我尝试了这些事情：

*   首先，我这样做了：

    ```
    AND
    (
        budgets_income_rules.date_start <= :date_end
            OR
        budgets_income_rules.date_start NOT EXISTS
    ) 
    ```

    效果不太好，因为它根本不起作用。

*   在那之后，我做了另一个这样的尝试：

    ```
    AND
    (
        budgets_income_rules.date_start <= :date_end
            OR
        budgets_income_rules.date_start IS NULL
    ) 
    ```

这在逻辑上确实有效，因为如果 MySQL 在 中找不到该行`LEFT JOIN`，则该列设置为`NULL`。

现在我的问题是，有没有更好的方法呢？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:46:20.370

目前，您还将获得`date_start`记录中为 NULL 的行。您可以使用 budgets_income_rules 表的 id 来测试 NULL，因为在不存在该行的连接查询中这只会是 NULL。

```
budgets_income_rules.id IS NULL 
```

# java - 多平台应用程序启动器

> ID：12424805
> 
> 赞同：6
> 
> 时间：2012-09-14T12:42:45.710
> 
> 标签：java, native, launcher, multiplatform

是否有任何应用程序可以创建 Java 应用程序的本机应用程序启动器？作为“本机”术语，我的意思是“看起来像正常的、依赖于平台的应用程序，它只启动 java -jar foobar.jar，如果没有安装 JVM 则显示错误”。我听说过 Launch4j，但它只适用于 Windows。我想要多平台（Win+Lin+Mac）解决方案。而且我不是在谈论 shell 脚本。我想要正常的可执行文件。

顺便说一句，Eclipse 看起来它已经得到了我想要的东西。

问候。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T11:03:28.937

如果您使用的是 maven，那么为所有平台创建 Native 应用程序将非常容易，我们使用 launch4j for windows(.exe)，对于 debian(.deb) 我们使用 jdeb，对于 Mac OSX(.app 和 .dmg)我们使用 osxappbundle。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:45:27.503

有像[launch4j](http://launch4j.sourceforge.net/)这样的工具可以做到这一点。

您可以将它与[izPack](http://izpack.org/)一起使用，以提供本机安装程序和启动程序。有关更多详细信息，请参阅[此](http://izpack.org/documentation/izpack-utils.html)内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-04T13:26:19.940

我使用[LibGDX Packr](https://github.com/libgdx/packr)，但它使用与应用程序一起打包的 JVM，而不是安装在操作系统上的 JVM。因为我更喜欢提供真正的 GNU Linux 包，所以我使用[JDeb](https://github.com/tcurdt/jdeb)和[Redline RPM](http://redline-rpm.org)。我将不得不找到一个解决方案来为 Windows 创建一个 MSI 包。

这些工具是跨平台的，这意味着您不必在 Mac OS X 下创建 .app 文件，您不必在 Windows 下使用本机 Windows 启动器创建压缩文件，您不需要不必在 GNU Linux 下创建 GNU Linux 软件包。

我使用 Ant 作为构建工具，但你可以用 Maven 做同样的事情，[JDeb](https://github.com/tcurdt/jdeb)和[Redline RPM](http://redline-rpm.org)都支持它，为[LibGDX Packr](https://github.com/libgdx/packr)编写 Ant 任务非常容易。[当我成功地正确使用JDeb](https://github.com/tcurdt/jdeb)和[Redline RPM](http://redline-rpm.org)时，我仍然犹豫是否将我的高级部署工具放入一个单独的库中。我想使用同质语法以允许开发人员使用相同的参数来创建所有本机包。此外，我的代码为您创建了 .icns 文件，当您不想依赖本机 Mac OS X 工具或任何外部应用程序时，它非常有用，它基于我的 Apache Commons Imaging 补丁。

PS：几个月前我把自己的工具（JNDT）放到了一个单独的 Ant 脚本中，它的文档在[这里](https://gouessej.wordpress.com/2014/11/22/ardor3d-est-mort-vive-jogamps-ardor3d-continuation-ardor3d-is-dead-long-life-to-jogamps-ardor3d-continuation/#jndt)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-26T12:27:17.320

我发现[install4j](https://www.ej-technologies.com/products/install4j/overview.html)对于多平台应用程序绑定很有用。它易于使用并具有漂亮的图形界面。

它支持**Windows + Linux + MacOSX + Unix**。
它还可以绑定 JRE，即使用户没有安装任何 JRE，您也可以运行它。

# php - UDP cron 作业使服务器忙

> ID：12424806
> 
> 赞同：0
> 
> 时间：2012-09-14T12:42:47.270
> 
> 标签：php, udp

您能否帮我在 PHP 中自定义以下 cron 脚本。该脚本正在服务器中创建许多后台进程。一天后，服务器繁忙，MYSQL 服务器崩溃。

以下脚本有什么问题。我需要这个脚本来不断地监听特定的 UDP 端口。所以它被设置为一个 cron jon，它将运行每个 mits。

```
set_time_limit(60);
class pingtype
{
function rotate()
{

    $socket = socket_create(AF_INET, SOCK_DGRAM, SOL_UDP);
    socket_bind($socket, '50.50.50.50', 9091);
    $from = '';
    $port = 0;
    $bytes_received = socket_recvfrom($socket, $buf, 150, MSG_PEEK, $from, $port);
    if ($bytes_received == -1)
    {
            die('An error occured while receiving from the socket');
            echo "Received $buf from $from\n";
    }

    echo "Received $buf from remote address $from and remote port $port";

    $hex_string_buf = "HEX:&nbsp;".$this->strToHex($buf)."&nbsp;&nbsp;String:&nbsp;".$buf;

    $link = mysql_connect("localhost", "user_database", "123") or die ("Errror in connection ".mysql_error());
    mysql_select_db("database") or die ("Error in select ".mysql_error());

    $sql = "INSERT INTO socket SET contents='".$hex_string_buf."' ";
    mysql_query($sql) or die ("Error in query ".mysql_error());
    mysql_close($link);
    // close socket and delete own .sock file
    socket_close($socket);      
    usleep(1000);       
}
function strToHex($string)
{
    $hex='';
    for ($i=0; $i < strlen($string); $i++)
    {
        $hex .= str_pad(dechex(ord($string[$i])), 3);
    }
    return $hex;
}

function hexToStr($hex)
{
    $string='';
    for ($i=0; $i < strlen($hex)-1; $i+=2)
    {
        $string .= chr(hexdec($hex[$i].$hex[$i+1]));
    }
    return $string;
}
}

for($i=1;$i<=6000;$i++)
{
    $object_pingtype = new pingtype();  
    $object_pingtype->rotate();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:06:58.243

您正在超载您的服务器。如果脚本每分钟运行一次，则执行以下代码：

```
for($i=1;$i<=6000;$i++)
{
    $object_pingtype = new pingtype();  
    $object_pingtype->rotate();
} 
```

这归结为**每秒****6000 / 60 ~ 100 个**请求。如果服务器没有足够的容量，它不会在 60 秒内完成这个脚本。然后启动一个新脚本等。

 **在一天结束时，您的服务器将分解所有任务。

任何一个：

*   减少循环中的旋转次数
*   减少脚本每小时运行的次数。**

# ruby - 如何部署一个 jRuby 应用程序？

> ID：12424808
> 
> 赞同：1
> 
> 时间：2012-09-14T12:42:54.043
> 
> 标签：ruby, deployment, gem, jruby

只是想知道是否有人对如何将 JRuby 应用程序“部署”到另一台服务器有任何经验？

那就是我正在 Windows 上开发一个 jRuby 应用程序，我希望最终将它部署到许多 Linux/Unix 服务器上。所以特别 -

*   它太容易部署还是只是一场噩梦？
*   我是否必须重新编译所有“宝石”（依赖项）或尝试找出将它们捆绑为部署包的方法？或者我是否必须像在我的开发机器（Windows Box）上那样为每个服务器单独配置 jRuby

PS。该应用程序由客户端/服务器组成。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:56:33.107

考虑使用[特立尼达](https://github.com/trinidad/trinidad)或[莺](https://github.com/jruby/warbler)；它解决了大部分这些问题。

# android - 如何获取在 ContextMenu 上单击的项目的位置？

> ID：12424809
> 
> 赞同：4
> 
> 时间：2012-09-14T12:42:54.077
> 
> 标签：android, nullpointerexception, contextmenu

我正在使用此代码来获取上下文菜单上的 Clicked Item 位置：

```
public boolean onContextItemSelected(MenuItem item) {
    AdapterContextMenuInfo info = (AdapterContextMenuInfo) item.getMenuInfo();
    int index = info.position;
} 
```

如此处建议：

[Android：如何找到从上下文菜单中单击的位置](https://stackoverflow.com/questions/2453620/android-how-to-find-the-position-clicked-from-the-context-menu#answers-header)

但我在行得到 NullPointerException：

```
 int index = info.position; 
```

为什么会这样？

**编辑**

我有 2 个已注册的 contextMenu 视图，如下所示：

```
button1.onClick(view v){
registerForContextMenu(v);
openContextMenu(v);
}

button2.onClick(view v){
registerForContextMenu(v);
openContextMenu(v);
} 
```

然后根据 v.getId() 我填充菜单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:49:51.217

请参阅本教程[http://www.stealthcopter.com/blog/2010/04/android-context-menu-example-on-long-press-gridview/](http://www.stealthcopter.com/blog/2010/04/android-context-menu-example-on-long-press-gridview/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:51:02.350

你可以直接使用：

**编辑开始**

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    AdapterView.AdapterContextMenuInfo info;
    try {
        info = (AdapterView.AdapterContextMenuInfo) menuInfo;
    } catch (ClassCastException e) {
        // If the menu object can't be cast, logs an error.
        Log.e("MENU", "bad menuInfo", e);
        return;
    }
    position = sectionAdapter.getIndexForPosition(info.position);
    menu.setHeaderTitle("");
    String[] menuItems = { "item1","item2","item3","item4" };
    for (int i = 0; i < menuItems.length; i++) {
        menu.add(Menu.NONE, i, i, menuItems[i]);
    }
} 
```

**编辑结束**

```
public boolean onContextItemSelected(MenuItem item) {
    // TODO Auto-generated method stub
    int position = item.getItemId();
    switch (position) 
    {

        case 0:
        break;
        .
        .
        .
        default:
        break;
    }
} 
```

希望它会帮助你。

# python - 如何在芹菜中设置回调

> ID：12424814
> 
> 赞同：7
> 
> 时间：2012-09-14T12:43:11.540
> 
> 标签：python, celery

我想向函数添加回调，以便在它返回时可以调用常规 python 函数，

我的任务

```
@celery.task                                                                                                                            
def add(x, y):                                                                                                                         
    return x + y 
```

我想如何使用它：

```
from __future__ import print_function
delay.add(2, 3 ,callback=lambda x: print x) 
```

除了 lambda，它可以是任何未在 celery 任务中定义但从中调用任务的函数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T12:49:51.313

在这种情况下，您只能链接任务：

```
add.apply_async((2, 3), link=other_task.s()) 
```

这与以下内容相同：

```
(add.s(2, 3) | other_task.s())() 
```

等待任务完成使任务同步，因此您想要的调用相当于：

```
(lambda x: print(x))(add.delay(2, 3).get()) 
```

这将阻塞当前进程，直到任务返回。如果您不希望进程阻塞，那么您必须编写一个专用线程来等待结果并调用您的回调。

或者你可以使用 eventlet/gevent 并且几乎可以编写普通代码。

# javascript - 如何使用 Javascript 调用引导模式并传递变量

> ID：12424818
> 
> 赞同：0
> 
> 时间：2012-09-14T12:43:20.923
> 
> 标签：javascript, jquery, leaflet, modal-dialog, jquery-events

> **可能重复：**
> [如何在 twitter bootstrat 中将值参数传递给 modal.show() 函数](https://stackoverflow.com/questions/10379624/how-to-pass-values-arguments-to-modal-show-function-in-twitter-bootstrat)

我从教程中有一个简单的引导模式：

```
<div id="modal-custom-id" class="modal hide fade">
 <div class="modal-header">
  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
  <h3>Modal header</h3>
  </div><div class="modal-body">
   <p>One fine body…&lt;/p>
  </div>
  <div class="modal-footer">
  <a href="#" class="btn">Close</a>
 </div>
</div> 
```

我有一个传单标记，我添加了一个自定义点击功能：

```
marker.on('click', function(e) {
   ...
} 
```

如何编写一个点击函数，女巫将调用并显示 Bootstrap 模型并用自定义标题和正文填充它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:54:19.020

您可以在显示模式之前导航 DOM 并更改值。使用您的示例，您可能会遇到以下情况：

```
marker.on('click', function(e) {
   $("#modal-custom-id .modal-header h3").html("New Title"):
   $("#modal-custom-id .modal-body p").html("New Body"):
   $("#modal-custom-id").modal("show");
} 
```

# gcc - 为什么我的 freopen 功能不起作用？

> ID：12424821
> 
> 赞同：0
> 
> 时间：2012-09-14T12:43:28.537
> 
> 标签：gcc, stdout, freopen

```
#include <stdio.h>
#include <string.h>
#define MAXN 15
char forbid[MAXN][MAXN];
int dp[2][1<<MAXN],c[1<<MAXN],*dp1,*dp2;
int cnt_one(int x)
{
    int s=0;
    while(x)
    {
        s++;
        x&=x-1;
    }
    return s;
}
int main()
{
    int t,n,s,a,b,i,j,k;
/*This is my use of freopen function*
************************************/
    freopen("datain.txt","r",stdin);
    freopen("dataout.txt","w",stdout);
/*This is just a dynamic program to solve a mathematical problem*
****************************************************************/
    for(i=0;i<(1<<MAXN);i++) c[i]=cnt_one(i);
    scanf("%d",&t);
    while(t--)
    {
        memset(forbid,0,sizeof(forbid));
        memset(dp[0],0,sizeof(int)*(1<<MAXN));
        dp[0][0]=1;
        scanf("%d%d",&n,&s);
        while(s--)
        {
            scanf("%d%d",&a,&b);
            forbid[a][b]=1;
        }
        for(i=1;i<=n;i++)
        {
            if(i%2)
            {
                dp1=dp[0];
                dp2=dp[1];
            }
            else
            {
                dp1=dp[1];
                dp2=dp[0];
            }
            memset(dp2,0,sizeof(int)*(1<<MAXN));
            for(j=0;j<(1<<n);j++)
            {
                if(c[j]!=i-1) continue;
                for(k=0;k<n;k++)
                {
                    if(!(j>>k&1)&&!forbid[i][n-k]) dp2[j^(1<<k)]+=dp1[j];
                }
            }
        }
        printf("%d\n",dp2[(1<<n)-1]);
    }
    return 0;
} 
```

这是我的程序。我使用动态程序方法来解决数学问题。但是当我使用“freopen”函数将“stdout”流重定向到“dataout.txt”文件时，它失败了，文件中没有数据。你能告诉我为什么我可以从“datain.txt”获取数据，但我不能将数据输出到“dataout.txt”吗？我的“stdout”流的“freopen”函数有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:15:38.383

我认为问题在于你有一个你看不到的分段错误。如果您在 freopen 之后放置 printf 和 return 我认为它会起作用（对我有用）。

我建议您在为调试而编译的生成可执行文件上使用“valgrind”，以查看程序在哪一行崩溃。如果您希望有人进一步帮助您，您需要提供示例输入。

# python - 考虑到 nan 数字，我如何有条件地更改 numpy 数组中的值？

> ID：12424824
> 
> 赞同：23
> 
> 时间：2012-09-14T12:43:51.793
> 
> 标签：python, open-source, numpy, statistics, gdal

我的数组是一个二维矩阵，除了负值和正值之外，它还有 numpy.nan 值：

```
>>> array
array([[        nan,         nan,         nan, ..., -0.04891211,
            nan,         nan],
   [        nan,         nan,         nan, ...,         nan,
            nan,         nan],
   [        nan,         nan,         nan, ...,         nan,
            nan,         nan],
   ..., 
   [-0.02510989, -0.02520096, -0.02669156, ...,         nan,
            nan,         nan],
   [-0.02725595, -0.02715945, -0.0286231 , ...,         nan,
            nan,         nan],
   [        nan,         nan,         nan, ...,         nan,
            nan,         nan]], dtype=float32) 
```

我想用一个数字替换所有正数，用另一个数字替换所有负数。

如何使用 python/numpy 执行该操作？

（为了记录，矩阵是geoimage的结果，我想对其进行分类）

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-09-14T12:47:49.747

您在阵列中拥有的事实`np.nan`并不重要。只需使用花哨的索引：

```
x[x>0] = new_value_for_pos
x[x<0] = new_value_for_neg 
```

如果你想更换你的`np.nans`：

```
x[np.isnan(x)] = something_not_nan 
```

有关花式索引[教程](http://www.scipy.org/Tentative_NumPy_Tutorial#head-0dffc419afa7d77d51062d40d2d84143db8216c2)和[NumPy 文档](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html)的更多信息。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-14T12:47:30.523

尝试：

```
a[a>0] = 1
a[a<0] = -1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-04-23T19:23:42.097

然后添加或减去当前值（np.nan 不受影响）

```
import numpy as np

a = np.arange(-10, 10).reshape((4, 5))

print("after -")
print(a)

a[a<0] = a[a<0] - 2
a[a>0] = a[a>0] + 2

print(a) 
```

输出

```
[[-10  -9  -8  -7  -6]
 [ -5  -4  -3  -2  -1]
 [  0   1   2   3   4]
 [  5   6   7   8   9]]

after -

[[-12 -11 -10  -9  -8]
 [ -7  -6  -5  -4  -3]
 [  0   3   4   5   6]
 [  7   8   9  10  11]] 
```

# git - JGit 获取命令

> ID：12424825
> 
> 赞同：2
> 
> 时间：2012-09-14T12:43:54.323
> 
> 标签：git, jgit, git-fetch

我理解 Git fetch 的概念。我想通过 JGit API 中的 FetchCommand 类来获取对象。

我有一个 Git 存储库。例如`C:\jGit\.git`.

我已经克隆了这个存储库。例如：`C:\jGitClone\jGit\.git`。

我再次克隆了这个存储库。例如`C:\Users\user\Desktop\jGitClone\.git`.

使用 JGit API 我有一个 Git 类：

```
Git git = new Git(repository); // this is the cloned repository. C:\jGitClone\jGit\.git 
```

我将如何设置桌面上的克隆存储库，以便在调用 fetch 时知道要获取到此存储库中。

我看过一些网站，包括下面的 1，但仍然卡住。

[使用 jgit 获取 Git 失败：远程没有可用于获取的 <branchname>](https://stackoverflow.com/questions/11304261/git-fetch-failing-using-jgit-remote-does-not-have-branchname-available-for-fe)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T11:36:41.527

我想你错过了什么。在 Git/jGit 中，本地副本由 a `path`（就像在文件系统中一样）和 a确定`remote`，它是一个远程仓库。

在您的情况下，您希望您的桌面克隆存储库具有指向您的存储库的链接`jGitClone/jGit`。所以首先，如果克隆已经完成，那么桌面存储库就会知道它的远程存储库。所以在你的代码中，你只需要告诉你的桌面仓库在哪里：

```
Builder builder = new FileRepositoryBuilder()
Git repo = builder.setGitDir(new File("C:\Users\user\Desktop\jGitClone.git"))
  .readEnvironment()
  .build() 
```

该代码可能无法直接工作（我没有对其进行测试，我的疑问是在给出的路径上，以及要使用的对象：`Builder`，`Git`），但它基于这个我认为会对您有所帮助的答案：[JGit 和寻找头部](https://stackoverflow.com/questions/12342152/jgit-and-finding-the-head)

顺便说一句，您的问题不是很清楚：您是否已经克隆了所有内容，还是您想要做的？在您的代码中，您提到了一个`repository`：您是否使用类似于我建议的代码获得它？您选择的名称也不是很清楚：调用 repo jGit，除非它包含 jGit 源代码，否则听起来有点笨拙。另外，为您的不同存储库（A，B，C）命名，以便更清晰地理解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-15T04:09:55.633

您需要定义远程，它跟踪您可以从中获取提交的存储库，使用 valina git，您可以执行以下操作：

```
# suppose you have cloned C:\jGitClone\jGit\.git
$ cd C:\Users\user\Desktop\jGitClone\.git
$ git remote add upstream "C:\jGitClone\jGit\.git"
$ git fetch upstream 
```

如果您想尝试[git24j](https://github.com/git24j/git24j)，您可以在 java 中执行此操作，就像使用 valina git 一样：

```
Repository remote = Repository.open("C:\jGitClone\jGit\.git");
Repository local = Repository.open("C:\Users\user\Desktop\jGitClone\.git");
// set up remote
Remote upstream = Remote.create(local, "upstream", URI.create(remote.getPath()));
// fetch from remote
upstream.fetch(null, null, "reflog"); 
```

这两个`nulls`参数定义了要获取的 refspecs 和选项（您可以在其中设置凭据等）。

# java - 无法在 Eclipse 中运行 Java 应用程序

> ID：12424835
> 
> 赞同：6
> 
> 时间：2012-09-14T12:44:23.973
> 
> 标签：java, eclipse, exception

> **可能重复：**
> [无法在 Eclipse 中运行/调试 Java 应用程序（JavaTimeZone 问题）](https://stackoverflow.com/questions/1553343/cannot-run-debug-java-applications-in-eclipse-javatimezone-issue)

Eclipse 失败了。

当我尝试运行 Java 应用程序时，我得到了这个：

```
An internal error occurred during: "Launching (app name)".
org/eclipse/jdt/debug/core/JDIDebugModel 
```

尝试调试会产生以下结果：

```
An internal error occurred during: "Launching (app name)".
com/sun/jdi/connect/IllegalConnectorArgumentsException 
```

打开运行配置，我得到这个：

```
Exception occurred creating launch configuration tabs

Reason:
Plug-in org.eclipse.jdt.debug.ui was unable to load class
org.eclipse.jdt.internal.debug.ui.launcher.LocalJavaApplicationTabGroup
An error occurred while automatically activating bundle org.eclipse.jdt.debug.ui (322). 
```

转到 Java 应用程序的任何运行配置也会给出错误消息：

```
No tabs defined for launch configuration type Java Application 
```

我无法运行任何 Java 应用程序。我可以将它们从运行配置中删除，仅此而已。尝试从例如包资源管理器运行应用程序什么也不做。例如，我仍然可以运行 Android 应用程序。

我在 Ubuntu 12.04/Gnome 3.4.2.1 上有 Indigo Service Release 2，Java EE IDE 版本。

有没有什么办法解决这一问题？我应该重新安装 Eclipse，也许是一些旧版本？

顺便说一句：错误消息与 [无法在 Eclipse 中运行/调试 Java 应用程序（JavaTimeZone 问题）](https://stackoverflow.com/questions/1553343/cannot-run-debug-java-applications-in-eclipse-javatimezone-issue)相同 ，但我没有安装 GPE，它是 Java 应用程序，而不是失败的 Web 应用程序。

# string - 冲突的字符串和整数

> ID：12424837
> 
> 赞同：0
> 
> 时间：2012-09-14T12:44:26.297
> 
> 标签：string, variables, python-3.x, integer, digit

我遇到了一些麻烦，我已经完成了程序的这一部分，它按计划工作，它存储变量并成功检查所有验证，但我需要它来验证，以便只能输入数字。一旦你按下一个字母键，程序就会崩溃。

我知道我需要在某个地方使用 selection.isdigit，我已经在几个不同的地方尝试过，但是当我把它放在看起来正确的地方时，程序崩溃了，因为 isdigit 只适用于字符串，并且给出了数字验证在程序中，当他们尝试使用字符串时程序会崩溃。有人可以帮我吗？

```
while True:
    if amountwanted > 0:                                                                               
        selection = int(input("What flavour pizza would you like? (1-12): "))                           
        if selection < 1 or selection > 12:                                                             
            print("You must enter a pizza between 1 and 12")                                            
            print("")
        else:
            if selection <= 7:                                                                          
                orderedstandardpizzas.append(selection)
            else:
                orderedgourmetpizzas.append(selection)                                                  
            amountwanted = amountwanted - 1                                                             
    else:                                                                                         
        break 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:48:40.417

您的使用会`int()`引发错误，因为它只接受*可以*解释为数字的字符串。

您可以捕获异常而不是检查输入中的每个字符：

```
try:
    selection = int(input("What flavour pizza would you like? (1-12): "))
except ValueError:
    print "You must enter a number!"
    break 
```

上面的代码片段替换了你的旧`selection = ...`行，它已经缩进了 4 个空格以匹配我插入的新`try`/块。`except`完整的代码最终是这样的：

```
while True:
    if amountwanted > 0:
        try:
            selection = int(input("What flavour pizza would you like? (1-12): "))
        except ValueError:
            print "You must enter a number!"
            break
        if selection < 1 or selection > 12:
            print("You must enter a pizza between 1 and 12")
            print("")
        else:
            if selection <= 7:
                orderedstandardpizzas.append(selection)
            else:
                orderedgourmetpizzas.append(selection)
            amountwanted = amountwanted - 1
     else:
        break 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:50:24.140

尝试这个：

```
selection = raw_input("What flavour pizza would you like? (1-12): ");
if (selection.isdigit())
    numSelection = int(selection);
    if (numSelection < 1 or numSelection > 12:
        // carry on
    else:
        // else case
else:
    //print error message. Break out of loop here if required. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:56:04.180

考虑线

```
 selection = int(input("What flavour pizza would you like? (1-12): ")) 
```

该`input(...)`函数根据用户的输入返回一个字符串；然后通过 将 this 转换为整数`int(...)`。[正如其他人指出的那样，`input`在 3.x 中相当于`raw_input`2.x。]

所以你基本上有两个选择。首先，您可以将非数字输入视为实际*错误*，您可以捕获它，并`continue`在出现错误时使用它返回到循环的开头：

```
try:
    selection = int(input("What flavour pizza would you like? (1-12): "))
except ValueError:
    print "Error message"
    continue 
```

这可能是最合适的和 Pythonic 的策略。

相反，您可以检查输入是否确实由数字组成，尽管它比这更复杂一些，因为当前版本允许前后有空格，因此您可以执行类似的操作

```
 string_selection = input("What flavour pizza would you like? (1-12): ")
    if not string_selection.strip().isdigit():
        continue
    selection = int(string_selection) 
```

但这更复杂！

# java - 线程本地删除？

> ID：12424838
> 
> 赞同：21
> 
> 时间：2012-09-14T12:44:32.343
> 
> 标签：java, multithreading, thread-local

使用 a时，我`ThreadLocal`应该总是在完成后调用`remove()`，或者当我这样做时`set`，旧值无论如何都会被替换，所以`remove`是多余的吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-14T12:49:05.290

因为`ThreadLocal`有`Map`和`currentThread`，`value`现在如果你不删除正在使用它的线程中的值，那么它将造成内存泄漏。

> 您应该始终调用**remove**，因为**ThreadLocal类从****ThreadLocal.Values localValues**定义 的**Thread**类中放置值；这也将导致持有 Thread 和关联对象的引用。

 **从源代码`ThreadLocal`

> **该值将设置为 null 并且基础条目仍将存在。**

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-14T12:47:44.760

`set`总是替换旧值。

这是真的

*   Calendar.set() 和 Date.set()
*   位集.set()
*   列表.set()
*   二传手

> 你的意思是没有删除它不会被GCed？

它不会被删除，直到线程死亡。没有你调用 remove() 它不会消失在你身上

这是否是内存泄漏取决于您的程序。您必须使用大型线程本地对象创建大量线程，出于某种原因您不需要这些对象。例如，具有 1 KB 对象的 1000 个线程可能会浪费多达 1 MB，但如果您正在执行此类操作，这表明存在设计问题。

* * *

唯一可能出现内存泄漏的地方是。

```
for (int i = 0; ; i++) {
    // don't subclass Thread.
    new Thread() {
        // this is somewhat pointless as you are defining a ThreadLocal per thread.
        final ThreadLocal<Object> tlObject = new ThreadLocal<Object>() {
        };

        public void run() {
            tlObject.set(new byte[8 * 1024 * 1024]);
        }
    }.start();
    Thread.sleep(1);
    if (i % 1000 == 0) {
        System.gc();
        System.out.println(i);
    }
} 
```

与`-verbosegc`印刷品。

```
[Full GC 213548K->49484K(3832192K), 0.0334194 secs]
39000
[GC 2786060K->82412K(3836864K), 0.0132035 secs]
[GC 2815569K->107052K(3836544K), 0.0212252 secs]
[GC 2836162K->131628K(3837824K), 0.0199268 secs]
[GC 2867613K->156204K(3837568K), 0.0209828 secs]
[GC 2886894K->180780K(3838272K), 0.0191244 secs]
[GC 2911942K->205356K(3838080K), 0.0187482 secs]
[GC 421535K->229932K(3838208K), 0.0192605 secs]
[Full GC 229932K->49484K(3838208K), 0.0344509 secs]
40000 
```

注意：full GC后的大小是一样的`49484K`

在上述情况下，您将拥有一个 ThreadLocal，它指的是 Thread，它指的是 ThreadLocal。但是，由于线程已死，它不会导致内存泄漏，因为它成为关注对象，即当 A -> B 和 B -> A

我在循环中运行了上面的示例几分钟，GC 级别移动了很多，但最小大小仍然很小。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-09-17T14:16:43.240

**不**，您不必“总是调用*remove()* ”而不是*set()*

如果您担心这样做会导致内存泄漏，这就是[javadoc](https://docs.oracle.com/javase/10/docs/api/java/lang/ThreadLocal.html)所说的

> 只要线程处于活动状态并且 ThreadLocal 实例可访问，每个线程都持有对其线程局部变量副本的隐式引用；在线程消失后，它的所有线程本地实例副本都将受到垃圾回收（除非存在对这些副本的其他引用）。

因此，不调用*remove()*不会阻止线程本地实例被正确地垃圾收集，并且不会自然导致内存泄漏。

您还可以查看 ThreadLocal 实现，它使用[Wea​​kReferences](https://docs.oracle.com/javase/8/docs/api/java/lang/ref/WeakReference.html)来实现这种“隐式引用”机制

**但**要注意与线程池的一致性

仅对线程池使用*set()*方法，您可能更喜欢*remove()*一个 ThreadLocal 实例，而不是使用同一线程在另一个“工作单元”中覆盖它。因为您可能希望避免由于某种原因未调用 set 方法，并且您的 ThreadLocal 仍然附加到它不属于的上下文/处理的情况。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-09-14T12:48:41.870

`set`：将此线程局部变量的当前线程副本设置为指定值。

这意味着该内存位置中的任何内容现在都将被您通过的内容覆盖`set`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-14T12:50:23.600

如果您尝试使用的变量`remove`将始终`set`在线程的下一次执行中，我不会担心删除它。`set`将覆盖其值。

但是，如果您仅在某些情况下设置该变量（例如，仅在处理特定类型的请求时），删除它可能会很方便，这样它就不会在线程被放回游泳池。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-14T13:16:39.393

我会简单地说：如果您出于任何原因扩展 ThreadLocal，请使用`remove()`. 在香草 ThreadLocal 上使用`set(null)`. 基本上不在*扩展*`ThreadLocal.remove()`的 ThreadLocal上使用会导致内存泄漏（ClassLoader 最有可能）

 *如果您需要更多详细信息，请发表评论。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-23T09:57:35.593

如果线程完成，`threadLocalMap`则将使用线程完成。您不需要删除它。但是如果线程被用于回收，则需要删除`threadLocalMap`.***

# xpath - XPath 查询根据文件不同部分中另一个节点的属性查找节点的属性

> ID：12424843
> 
> 赞同：2
> 
> 时间：2012-09-14T12:44:49.917
> 
> 标签：xpath, openstreetmap

我有一个由 Open Street Map 生成的 xml 文件。其中有“节点”节点和“路”节点。

“node”节点位于文件的顶部，“way”节点位于文件的下方。“节点”节点包含一个点的纬度和经度（作为属性）信息。“路”节点包含组成路的“nd”节点列表。每个“nd”节点的@ref 属性与“节点”的@id 属性相匹配。

我需要为每个 /way/nd/@ref 解析 xml 并从相应的“节点”获取 @latitude 和 @longitude

本质上，我希望有一个方式列表，其中包含每个节点的纬度和经度值。

如果有人可以提供帮助，将不胜感激。我尝试了几十种 xpath 查询组合来尝试使其工作，但似乎无法确定它。

下面是示例 xml，如果有人感兴趣，我这样做是为了将“方式”导入到 drupal 站点，以在 openlayers 地图上绘制“方式”。

```
<?xml version="1.0" encoding="UTF-8"?>
<osm version="0.6" generator="Overpass API">
<note>The data included in this document is from www.openstreetmap.org. It has there been collected by a large group of contributors. For individual attribution of each item please refer to http://www.openstreetmap.org/api/0.6/[node|way|relation]/#id/history </note>
<meta osm_base="2012-09-12T07:00:02Z"/>

  <node id="291435953" lat="50.7468739" lon="7.1563067" version="4" timestamp="2012-05-13T23:29:40Z" changeset="11591622" uid="49785" user="mike67"/>
  <node id="291435954" lat="50.7464770" lon="7.1561995" version="2" timestamp="2012-05-13T23:29:40Z" changeset="11591622" uid="49785" user="mike67"/>
  <node id="291435955" lat="50.7461387" lon="7.1558430" version="2" timestamp="2012-05-13T23:29:40Z" changeset="11591622" uid="49785" user="mike67">
    <tag k="highway" v="turning_circle"/>
  </node>
  <node id="291435956" lat="50.7472300" lon="7.1555832" version="3" timestamp="2012-02-25T15:00:32Z" changeset="10788449" uid="49785" user="mike67"/>
  <node id="291435957" lat="50.7462073" lon="7.1544363" version="1" timestamp="2008-08-26T21:58:25Z" changeset="418638" uid="36773" user="bernd1606">
    <tag k="created_by" v="JOSM"/>
  </node>
  <node id="291438870" lat="50.7479387" lon="7.1562447" version="4" timestamp="2012-02-25T15:00:31Z" changeset="10788449" uid="49785" user="mike67">
    <tag k="highway" v="turning_circle"/>
  </node>
  <node id="291438872" lat="50.7476693" lon="7.1540409" version="1" timestamp="2008-08-26T22:05:07Z" changeset="418638" uid="36773" user="bernd1606">
    <tag k="created_by" v="JOSM"/>
  </node>
  <node id="470930364" lat="50.7466304" lon="7.1550088" version="1" timestamp="2009-08-19T10:27:27Z" changeset="2198882" uid="49785" user="mike67"/>
  <node id="1212226020" lat="50.7462970" lon="7.1551053" version="1" timestamp="2011-03-21T18:14:35Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226026" lat="50.7461263" lon="7.1552748" version="1" timestamp="2011-03-21T18:14:35Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226027" lat="50.7460993" lon="7.1549555" version="1" timestamp="2011-03-21T18:14:35Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226028" lat="50.7463885" lon="7.1540406" version="1" timestamp="2011-03-21T18:14:35Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226035" lat="50.7460590" lon="7.1549115" version="1" timestamp="2011-03-21T18:14:36Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226040" lat="50.7460307" lon="7.1549335" version="1" timestamp="2011-03-21T18:14:37Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226041" lat="50.7461886" lon="7.1551879" version="1" timestamp="2011-03-21T18:14:37Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226043" lat="50.7460489" lon="7.1552923" version="1" timestamp="2011-03-21T18:14:37Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226044" lat="50.7465142" lon="7.1543804" version="1" timestamp="2011-03-21T18:14:37Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226049" lat="50.7461296" lon="7.1549315" version="1" timestamp="2011-03-21T18:14:38Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226065" lat="50.7461674" lon="7.1552133" version="1" timestamp="2011-03-21T18:14:39Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226068" lat="50.7460541" lon="7.1546925" version="1" timestamp="2011-03-21T18:14:39Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226069" lat="50.7462755" lon="7.1542526" version="1" timestamp="2011-03-21T18:14:39Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226071" lat="50.7461058" lon="7.1548565" version="1" timestamp="2011-03-21T18:14:39Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226087" lat="50.7462284" lon="7.1551919" version="1" timestamp="2011-03-21T18:14:40Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226090" lat="50.7461464" lon="7.1550496" version="1" timestamp="2011-03-21T18:14:40Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226091" lat="50.7465509" lon="7.1541410" version="1" timestamp="2011-03-21T18:14:40Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226104" lat="50.7460048" lon="7.1551556" version="1" timestamp="2011-03-21T18:14:41Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226127" lat="50.7462070" lon="7.1544275" version="1" timestamp="2011-03-21T18:14:43Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226133" lat="50.7461004" lon="7.1550786" version="1" timestamp="2011-03-21T18:14:43Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226142" lat="50.7460609" lon="7.1548346" version="1" timestamp="2011-03-21T18:14:44Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226144" lat="50.7461532" lon="7.1553573" version="1" timestamp="2011-03-21T18:14:44Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226149" lat="50.7460912" lon="7.1548105" version="1" timestamp="2011-03-21T18:14:44Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226165" lat="50.7461320" lon="7.1546332" version="1" timestamp="2011-03-21T18:14:45Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226171" lat="50.7462548" lon="7.1549671" version="1" timestamp="2011-03-21T18:14:45Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226180" lat="50.7460253" lon="7.1549160" version="1" timestamp="2011-03-21T18:14:46Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226184" lat="50.7462552" lon="7.1552743" version="1" timestamp="2011-03-21T18:14:46Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226192" lat="50.7461445" lon="7.1552153" version="1" timestamp="2011-03-21T18:14:47Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226196" lat="50.7460206" lon="7.1547882" version="1" timestamp="2011-03-21T18:14:47Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226197" lat="50.7461830" lon="7.1548005" version="1" timestamp="2011-03-21T18:14:47Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1212226208" lat="50.7465204" lon="7.1542470" version="1" timestamp="2011-03-21T18:14:48Z" changeset="7630016" uid="49785" user="mike67"/>
  <node id="1558201806" lat="50.7465619" lon="7.1543799" version="1" timestamp="2011-12-22T14:11:53Z" changeset="10179910" uid="116044" user="berndw"/>
  <node id="1558201807" lat="50.7465706" lon="7.1545076" version="1" timestamp="2011-12-22T14:11:53Z" changeset="10179910" uid="116044" user="berndw"/>
  <node id="1558201808" lat="50.7465787" lon="7.1542431" version="1" timestamp="2011-12-22T14:11:53Z" changeset="10179910" uid="116044" user="berndw"/>
  <node id="1558201809" lat="50.7465945" lon="7.1546459" version="1" timestamp="2011-12-22T14:11:53Z" changeset="10179910" uid="116044" user="berndw"/>
  <node id="1558201810" lat="50.7466379" lon="7.1540966" version="1" timestamp="2011-12-22T14:11:53Z" changeset="10179910" uid="116044" user="berndw"/>
  <node id="1558201813" lat="50.7468171" lon="7.1569205" version="1" timestamp="2011-12-22T14:11:54Z" changeset="10179910" uid="116044" user="berndw"/>
  <node id="1558201814" lat="50.7469049" lon="7.1557857" version="2" timestamp="2012-02-25T15:00:33Z" changeset="10788449" uid="49785" user="mike67"/>
  <node id="1558201822" lat="50.7472431" lon="7.1542901" version="2" timestamp="2012-02-25T15:00:31Z" changeset="10788449" uid="49785" user="mike67"/>
  <node id="1558201829" lat="50.7478716" lon="7.1567219" version="1" timestamp="2011-12-22T14:11:54Z" changeset="10179910" uid="116044" user="berndw"/>
  <node id="1579451712" lat="50.7475476" lon="7.1550423" version="2" timestamp="2012-02-25T15:00:32Z" changeset="10788449" uid="49785" user="mike67"/>
  <node id="1647096049" lat="50.7477273" lon="7.1555526" version="1" timestamp="2012-02-25T15:00:31Z" changeset="10788449" uid="49785" user="mike67"/>
  <node id="1647096076" lat="50.7468682" lon="7.1556378" version="1" timestamp="2012-02-25T15:00:32Z" changeset="10788449" uid="49785" user="mike67"/>
  <node id="1647096079" lat="50.7469025" lon="7.1560030" version="2" timestamp="2012-05-13T23:29:39Z" changeset="11591622" uid="49785" user="mike67"/>
  <node id="1751820951" lat="50.7469115" lon="7.1558916" version="1" timestamp="2012-05-13T23:29:39Z" changeset="11591622" uid="49785" user="mike67"/>
  <node id="1751820952" lat="50.7465981" lon="7.1562371" version="1" timestamp="2012-05-13T23:29:40Z" changeset="11591622" uid="49785" user="mike67"/>
  <node id="1751820953" lat="50.7463604" lon="7.1561245" version="1" timestamp="2012-05-13T23:29:40Z" changeset="11591622" uid="49785" user="mike67"/>
  <node id="1751820954" lat="50.7462630" lon="7.1560233" version="1" timestamp="2012-05-13T23:29:40Z" changeset="11591622" uid="49785" user="mike67"/>
  <node id="1751820955" lat="50.7461938" lon="7.1559261" version="1" timestamp="2012-05-13T23:29:40Z" changeset="11591622" uid="49785" user="mike67"/>
  <way id="26577114" version="3" timestamp="2012-05-13T23:29:40Z" changeset="11591622" uid="49785" user="mike67">
    <nd ref="291435953"/>
    <nd ref="1751820952"/>
    <nd ref="291435954"/>
    <nd ref="1751820953"/>
    <nd ref="1751820954"/>
    <nd ref="1751820955"/>
    <nd ref="291435955"/>
    <tag k="highway" v="residential"/>
    <tag k="lit" v="yes"/>
    <tag k="name" v="RhedenstraÃŸe"/>
  </way>
  <way id="26577115" version="2" timestamp="2011-12-22T14:12:55Z" changeset="10179910" uid="116044" user="berndw">
    <nd ref="1558201814"/>
    <nd ref="291435956"/>
    <tag k="highway" v="residential"/>
    <tag k="name" v="Von-Ketteler-StraÃŸe"/>
  </way>
  <way id="26577275" version="4" timestamp="2012-02-25T15:00:32Z" changeset="10788449" uid="49785" user="mike67">
    <nd ref="291438870"/>
    <nd ref="1647096049"/>
    <nd ref="1579451712"/>
    <nd ref="1558201822"/>
    <nd ref="1558201815"/>
    <tag k="highway" v="residential"/>
    <tag k="name" v="Mutter-Barat-StraÃŸe"/>
  </way>
  <way id="26577276" version="3" timestamp="2012-02-25T15:00:30Z" changeset="10788449" uid="49785" user="mike67">
    <nd ref="291438871"/>
    <nd ref="291438872"/>
    <nd ref="1647095991"/>
    <nd ref="1647095994"/>
    <nd ref="291438873"/>
    <tag k="highway" v="residential"/>
    <tag k="lit" v="yes"/>
    <tag k="name" v="StegerwaldstraÃŸe"/>
  </way>
  <way id="31347483" version="6" timestamp="2012-02-25T14:04:08Z" changeset="10787922" uid="49785" user="mike67">
    <nd ref="1558201825"/>
    <nd ref="96133774"/>
    <nd ref="1647008854"/>
    <nd ref="1558201826"/>
    <nd ref="1558201827"/>
    <nd ref="96133775"/>
    <nd ref="1558201829"/>
    <nd ref="1558201831"/>
    <nd ref="96133776"/>
    <nd ref="1558201832"/>
    <nd ref="291438874"/>
    <nd ref="1558201836"/>
    <nd ref="96133777"/>
    <nd ref="291089398"/>
    <nd ref="96133778"/>
    <nd ref="32346787"/>
    <nd ref="291089396"/>
    <nd ref="291092263"/>
    <nd ref="33078442"/>
    <tag k="highway" v="residential"/>
    <tag k="lit" v="yes"/>
    <tag k="name" v="Alte SchulstraÃŸe"/>
  </way>
  <way id="39300712" version="3" timestamp="2011-10-30T13:18:29Z" changeset="9693579" uid="239847" user="theophrastus">
    <nd ref="470930364"/>
    <nd ref="1212226113"/>
    <nd ref="470930365"/>
    <tag k="name" v="Alaunbach"/>
    <tag k="waterway" v="stream"/>
  </way>
  <way id="105196611" version="2" timestamp="2011-05-26T14:50:40Z" changeset="8254295" uid="49785" user="mike67">
    <nd ref="1212226149"/>
    <nd ref="1212226142"/>
    <nd ref="1212226027"/>
    <nd ref="1212226049"/>
    <nd ref="1212226071"/>
    <nd ref="1212226149"/>
    <tag k="building" v="garages"/>
  </way>
  <way id="105196614" version="1" timestamp="2011-03-21T18:14:50Z" changeset="7630016" uid="49785" user="mike67">
    <nd ref="1212226065"/>
    <nd ref="1212226220"/>
    <tag k="highway" v="service"/>
  </way>
  <way id="105196615" version="2" timestamp="2011-03-21T18:21:18Z" changeset="7630100" uid="49785" user="mike67">
    <nd ref="1212226068"/>
    <nd ref="1212226149"/>
    <nd ref="1212226071"/>
    <nd ref="1212226197"/>
    <nd ref="1212226165"/>
    <nd ref="1212226068"/>
    <tag k="addr:city" v="Bonn"/>
    <tag k="addr:country" v="DE"/>
    <tag k="addr:housenumber" v="21a"/>
    <tag k="addr:postcode" v="53229"/>
    <tag k="addr:street" v="Von-Ketteler-StraÃŸe"/>
    <tag k="building" v="yes"/>
  </way>
  <way id="105196617" version="2" timestamp="2011-03-21T18:21:18Z" changeset="7630100" uid="49785" user="mike67">
    <nd ref="1212226067"/>
    <nd ref="1212226047"/>
    <nd ref="1212226166"/>
    <nd ref="1212226180"/>
    <nd ref="1212226130"/>
    <nd ref="1212226067"/>
    <tag k="addr:city" v="Bonn"/>
    <tag k="addr:country" v="DE"/>
    <tag k="addr:housenumber" v="23"/>
    <tag k="addr:postcode" v="53229"/>
    <tag k="addr:street" v="Von-Ketteler-StraÃŸe"/>
    <tag k="building" v="yes"/>
  </way>
  <way id="105196618" version="2" timestamp="2011-03-21T20:19:24Z" changeset="7631407" uid="49785" user="mike67">
    <nd ref="1212226110"/>
    <nd ref="1212226181"/>
    <nd ref="1212226107"/>
    <nd ref="1212226030"/>
    <nd ref="1212226125"/>
    <nd ref="1212226091"/>
    <nd ref="1212226208"/>
    <nd ref="1212226044"/>
    <nd ref="1212226127"/>
    <nd ref="1212226203"/>
    <nd ref="1212226085"/>
    <nd ref="1212226052"/>
    <nd ref="1212226042"/>
    <nd ref="1212226061"/>
    <nd ref="1212226038"/>
    <nd ref="1212226190"/>
    <nd ref="1212226139"/>
    <nd ref="1212226110"/>
    <tag k="amenity" v="school"/>
    <tag k="name" v="Marktschule"/>
  </way>
  <way id="105196620" version="2" timestamp="2011-05-26T14:50:40Z" changeset="8254295" uid="49785" user="mike67">
    <nd ref="1212226196"/>
    <nd ref="1212226130"/>
    <nd ref="1212226180"/>
    <nd ref="1212226040"/>
    <nd ref="1212226035"/>
    <nd ref="1212226196"/>
    <tag k="building" v="garages"/>
  </way>
  <way id="105196621" version="2" timestamp="2011-03-21T18:21:17Z" changeset="7630100" uid="49785" user="mike67">
    <nd ref="1212226041"/>
    <nd ref="1212226090"/>
    <nd ref="1212226171"/>
    <nd ref="1212226020"/>
    <nd ref="1212226041"/>
    <tag k="addr:city" v="Bonn"/>
    <tag k="addr:country" v="DE"/>
    <tag k="addr:housenumber" v="23a"/>
    <tag k="addr:postcode" v="53229"/>
    <tag k="addr:street" v="Von-Ketteler-StraÃŸe"/>
    <tag k="building" v="yes"/>
  </way>
  <way id="105196625" version="2" timestamp="2011-03-21T18:21:18Z" changeset="7630100" uid="49785" user="mike67">
    <nd ref="1212226133"/>
    <nd ref="1212226104"/>
    <nd ref="1212226043"/>
    <nd ref="1212226192"/>
    <nd ref="1212226133"/>
    <tag k="addr:city" v="Bonn"/>
    <tag k="addr:country" v="DE"/>
    <tag k="addr:housenumber" v="23b"/>
    <tag k="addr:postcode" v="53229"/>
    <tag k="addr:street" v="Von-Ketteler-StraÃŸe"/>
    <tag k="building" v="yes"/>
  </way>
  <way id="105196626" version="1" timestamp="2011-03-21T18:14:54Z" changeset="7630016" uid="49785" user="mike67">
    <nd ref="1212226028"/>
    <nd ref="1212226024"/>
    <nd ref="1212226031"/>
    <nd ref="1212226159"/>
    <nd ref="1212226131"/>
    <nd ref="1212226069"/>
    <nd ref="1212226028"/>
    <tag k="building" v="yes"/>
    <tag k="leisure" v="sports_centre"/>
    <tag k="sport" v="multi"/>
  </way>
  <way id="105196629" version="2" timestamp="2011-05-26T14:50:40Z" changeset="8254295" uid="49785" user="mike67">
    <nd ref="1212226087"/>
    <nd ref="1212226026"/>
    <nd ref="1212226144"/>
    <nd ref="1212226184"/>
    <nd ref="1212226087"/>
    <tag k="building" v="garages"/>
  </way>
  <way id="142380554" version="1" timestamp="2011-12-22T14:11:57Z" changeset="10179910" uid="116044" user="berndw">
    <nd ref="1558201831"/>
    <nd ref="291438870"/>
    <tag k="highway" v="footway"/>
    <tag k="name" v="Mutter-Barat-StraÃŸe"/>
  </way>
  <way id="142380557" version="3" timestamp="2012-05-13T23:29:39Z" changeset="11591622" uid="49785" user="mike67">
    <nd ref="1558201823"/>
    <nd ref="1558201815"/>
    <nd ref="1558201810"/>
    <nd ref="1558201808"/>
    <nd ref="1558201806"/>
    <nd ref="1558201807"/>
    <nd ref="1558201809"/>
    <nd ref="1647096076"/>
    <nd ref="1558201814"/>
    <nd ref="1751820951"/>
    <nd ref="1647096079"/>
    <nd ref="291435953"/>
    <nd ref="1558201813"/>
    <nd ref="1558201812"/>
    <tag k="highway" v="residential"/>
    <tag k="lit" v="yes"/>
    <tag k="name" v="Von-Ketteler-StraÃŸe"/>
  </way>
  <way id="142380558" version="1" timestamp="2011-12-22T14:11:58Z" changeset="10179910" uid="116044" user="berndw">
    <nd ref="1558201806"/>
    <nd ref="291435957"/>
    <nd ref="1212226220"/>
    <nd ref="291435958"/>
    <nd ref="291435959"/>
    <nd ref="1212226021"/>
    <tag k="bicycle" v="yes"/>
    <tag k="foot" v="yes"/>
    <tag k="highway" v="service"/>
    <tag k="motorcar" v="private"/>
    <tag k="motorcycle" v="private"/>
    <tag k="name" v="Von-Ketteler-StraÃŸe"/>
  </way>

</osm> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T18:52:06.867

处理此问题的最佳方法取决于您正在使用的上下文。通常，您可能会有一些代码迭代`way`元素，并且在其中一些其他代码迭代`nd`元素。从那里获取`@ref`值并将其分配给一个变量，然后编写一个 XPath 表达式来查找`node`具有该 ID 的 并返回其`@lat`和`@lon`属性。

例如，在 XQuery 中，以下查询返回一组`way`元素，其中每个`nd`子元素都增加了纬度/经度信息。

```
let $in := doc('/Users/cmsmcq/2012/misc/SO2/user1671.xml')
for $w in $in//way
return element {"way"} 
     { for $a in $w/@* return $a,
       for $n in $w/nd
       let $id := $n/@ref,
           $node := $in//node[@id=$id],
           $lat := $node/@lat,
           $lon := $node/@lon
       return <nd ref="{$id}" lat="{$lat}" lon="{$lon}"/>
     } 
```

这可能不是您想要的（它会丢弃`tag`元素），但它可以帮助您查看所需的模式。

单独在 XPath 中执行此操作非常困难（我认为这是不可能的，但我没有该命题的证明），因为 XPath 无法从谓词中引用作为上下文节点的节点在谓词的左括号之前重置上下文节点。（这就是 XSLT`current()`函数的用途，也是变量绑定的优点之一。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-11T05:59:56.230

Overpass API 提供了一种新模式`out geom;`，该模式在 way 元素的正下方嵌入了所有方向的节点纬度/经度详细信息。因此，不再需要这种收集节点纬度/经度详细信息的相当复杂的方法。

查看 wiki.openstreetmap.org 上的 Overpass 查询语言文档以获取更多详细信息。

为了说明，这是您将获得的查询结果`way(26577114);out geom;`

```
<?xml version="1.0" encoding="UTF-8"?> <osm version="0.6" generator="Overpass API"> <note>The data included in this document is from www.openstreetmap.org. The data is made available under ODbL.</note> <meta osm_base="2014-10-13T19:08:02Z"/>

  <way id="26577114">
    <bounds minlat="50.7461387" minlon="7.1558430" maxlat="50.7468739" maxlon="7.1563067"/>
    <nd ref="291435953" lat="50.7468739" lon="7.1563067"/>
    <nd ref="1751820952" lat="50.7465981" lon="7.1562371"/>
    <nd ref="291435954" lat="50.7464770" lon="7.1561995"/>
    <nd ref="1751820953" lat="50.7463604" lon="7.1561245"/>
    <nd ref="1751820954" lat="50.7462630" lon="7.1560233"/>
    <nd ref="1751820955" lat="50.7461938" lon="7.1559261"/>
    <nd ref="291435955" lat="50.7461387" lon="7.1558430"/>
    <tag k="highway" v="residential"/>
    <tag k="lit" v="yes"/>
    <tag k="name" v="Rhedenstraße"/>   </way>

</osm> 
```

# php - 对象会话未通过

> ID：12424847
> 
> 赞同：1
> 
> 时间：2012-09-14T12:44:57.910
> 
> 标签：php, session, object

在文件 A.php 上，我有一个 while 循环，它从数据库中提取数据并连接到 class.php 以为每个数据集创建对象。那部分工作正常。
在该循环中，我尝试在创建新对象后将每个对象保存到由其 id 值定义的 SESSION

文件 A.php：

```
$_SESSION[$pObject->id] = $pObject;

if (isset($_SESSION[$pObject->id]))

{

echo "SESSION $pObject->id is set"; 

} 
```

我已经确认它正在创建中。

现在，我有一个通过 GET 将 Objects id 值发送到文件 B.php 的表单，我确认收到了该值。

文件 B.php：

```
require_once 'class.php';

session_start();

$id = $_GET['id'];

echo $id;

//Now $id is in my new file, so I try to call my SESSION

if(isset($_SESSION[$id]))

{

echo "SESSION $id is set";

$pObjectCurrrent = $_SESSION[$id];

}

else{

echo "SESSION $id is Not set";

} 
```

问题是，尽管`$id`文件 B.php 中的值等于文件 A.php 中的值`$pObject->id`，但文件 B.php 中的值`SESSION[$id]`未设置且没有任何值。相反，我收到一个未定义的变量错误。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:07:53.640

您不能使用整数作为会话变量名称。

您可以像这样设置会话变量：

```
$_SESSION['obj' . $pObject->id] = $pObject; 
```

然后像这样从 B.php 中检索它：

```
echo $_SESSION['obj' . $id]; 
```

本质上，它将 ID 与字符串连接起来，因此变量名将是“obj5”、“obj2”等。

另外 - 如果您在会话对象中传递大量数据，我建议您研究序列化和替代方法，例如将会话数据存储到数据库。

# ruby - 哪些 IDE 可用于 jRuby？

> ID：12424853
> 
> 赞同：6
> 
> 时间：2012-09-14T12:45:11.360
> 
> 标签：ruby, ide, jruby

我做了一些谷歌搜索，似乎 jRuby 的 IDE 很稀缺。我读过有关 TextMate 和 Sublime 的信息，但它们不提供调试或代码完成功能。

有人可以提出建议（或者这项技术还处于起步阶段）吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T12:51:38.473

有几种选择；我更喜欢[JetBrains 的 IntelliJ (RubyMine)](http://www.jetbrains.com/ruby/)。

[Aptana 有一个 Eclipse 插件](http://www.aptana.com/products/radrails)。[NetBeans 以前有官方支持](http://netbeans.org/features/ruby/index.html)，不知道现在是什么[状态](http://netbeans.org/features/ruby/index.html)。

# iphone - EKEventEditViewController 本地化

> ID：12424859
> 
> 赞同：2
> 
> 时间：2012-09-14T12:45:28.397
> 
> 标签：iphone, objective-c, xcode

如何更改 EKEventEditViewController 中的默认语言，它始终是英语，即使我手动设置 AppleLanguages 对象

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T15:39:13.887

`Localizations`我通过向我的应用 plist添加一个项目解决了这个问题。例如，如果您希望您的应用程序以西班牙语显示表单，`Localizations key`请在您的 plist 中添加一个并在其中创建西班牙语项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T15:56:39.537

1) 在 info.plist 中，将“本地化本地开发区域”设置为您的语言，例如 en、de、fr 等。

2) 添加新文件 -> iOS 资源 -> 字符串文件并将其命名为可本地化。在您的捆绑包中选择此文件，然后在“实用程序视图”中添加您的本地化。

那么您的 EventController 应该使用正确的语言。

# objective-c - 在 Safari 中打开前确认

> ID：12424862
> 
> 赞同：1
> 
> 时间：2012-09-14T12:45:31.760
> 
> 标签：objective-c, cocoa-touch

我试图添加一个`UIAlertView`警告用户该链接将在`Safari`. 然后，用户可以选择 OK（打开 url）或取消，这应该只是关闭警报并返回链接。我有三个不同`UIButton`的 s，其中有 3 个不同`URL`的 s。

现在`IBAction`我为所有按钮添加了一个，所有按钮都有标签（我认为我可以以某种方式使用：D）。我想`- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:`委托会很好用..

我的问题：应该如何`UIAlertView`知道`URL`用户点击确定要打开什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:21:50.857

我建议您使用`UIAlertView`能够跟踪更多属性的子类。我在所有项目中都这样做，而且要简单得多。

*   一种解决方案是子类化`UIAlertView`并`MyAlertView`添加一个`@property(nonatomic, retain) id userInfo;`or `@property(nonatomic, retain) NSURL* urlToOpen`。因此，您可以将自定义数据附加到您的数据`UIAlertView`并在委托方法中检索它以执行您需要的任何操作。
*   另一种解决方案，实际上是我更喜欢的解决方案，是将 Objective-C 块支持添加到`UIAlertView`，以便能够使用`UIAlertView`块 API 而不是使用`delegate`. 如果您`UIAlertViews`在同一个类和同一个委托中使用多个，这将特别有用，因为使用单个委托来处理不同的实例是一团糟。

我个人一直都在使用这种技术，因为它还通过在显示警报的代码旁边点击按钮时执行的代码，而不是在使用时将其放在完全不同的位置，从而使我的代码更具可读性委托方法。

你可以[`OHAlertView`在 GitHub 上查看我的子类](https://github.com/AliSoftware/OHAlertView-OHActionSheet)，它已经实现了这个。用法非常简单，允许您为每个警报视图使用块而不是通用委托，见下文。

* * *

### 使用示例

```
-(void)confirmOpenURL:(NSURL*)url
{
  NSString* message = [NSString string WithFormat:@"Open %@ in Safari?",
                                                  url.absoluteString];
  [OHAlertView showAlertWithTitle:@"Open URL"
                          message:message
                     cancelButton:@"No"
                         okButton:@"Yes"
                   onButtonTapped:^(OHAlertView* alert, NSInteger buttonIndex)
  {
    if (buttonIndex != alert.cancelButtonIndex)
    {
       // If user tapped "Yes" and not "No"
       [[UIApplication sharedApplication] openURL:url];
    }
  }];
} 
```

然后每个按钮都可以有自己的动作：

```
-(IBAction)button1Action
{
  [self confirmOpenURL:[NSURL URLWithString:@"http://www.google.com"]];
}
-(IBAction)button2Action
{
  [self confirmOpenURL:[NSURL URLWithString:@"http://www.stackoverflow.com"]];
} 
```

或者，您可以为所有按钮打开 URL 设置一个通用 IBAction：

```
-(IBAction)commonButtonAction:(UIButton*)sender
{
   NSUInteger tag = sender.tag;
   NSString* urls[] = { @"http://www.google.com", @"http://www.stackoverflow.com" };
   NSURL* buttonURL = [NSURL URLWithString: urls[tag] ]; // in practice you should check that tag is between 0 and the number of urls to be sure, that's just an example here
   [self confirmOpenURL:buttonURL];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T14:23:50.757

像这样解决它：`tag`在创建`UIAlertView`. 像这样：

```
- (IBAction)PressedButton {

    UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"Link"
                                                      message:@"Want to open in safari?"
                                                     delegate:self
                                            cancelButtonTitle:@"Ok"
                                            otherButtonTitles:nil];

    message.tag = 2;        //different tag for each button

    [message addButtonWithTitle:@"Cancel"];
    [message show];

} 
```

然后当`- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex`委托被抛出时，我这样做了：

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{

    if (buttonIndex == alertView.cancelButtonIndex){

        if (alertView.tag == 1)
        {
            //go to URL1
        }

        else if (alertView.tag == 2)
        {
             //go to URL2
        }

        else if (alertView.tag == 3)
        {
            //go to URL3
        }

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:55:37.120

您的按钮操作方法应具有如下签名：

```
 -(void)doSomething:(id)sender; 
```

其中发件人将是按钮。基于此，您可以找出所指的 URL。

# c++ - c++ OS 独立（windows & linux）开源随机数生成器库？

> ID：12424863
> 
> 赞同：1
> 
> 时间：2012-09-14T12:45:44.853
> 
> 标签：c++, windows, linux, encryption, random

独立于操作系统（windows & linux）的开源随机数生成器库？(c++)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T12:48:12.117

[Boost.Random](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_random.html)满足您的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T13:23:36.663

[GNU 科学库](http://www.gnu.org/software/gsl/)实现了[许多随机数生成器算法](http://www.gnu.org/software/gsl/manual/html_node/Random-number-generator-algorithms.html)。

除了第 3 方库，C++11 也[有几个](http://en.cppreference.com/w/cpp/numeric/random)。如果您可以访问合适的 C++11 环境并且这些环境适合您的需求，请使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:47:59.723

cstdlib 提供随机数生成...

# symfony - Symfony 2：尝试打开 /app_dev.php 时出现 404 Not Found 错误

> ID：12424864
> 
> 赞同：14
> 
> 时间：2012-09-14T12:45:45.943
> 
> 标签：symfony, nginx, http-status-code-404, symfony-2.1, profiler

尝试打开时收到此错误消息

/app_dev.php

```
An error occurred while loading the web debug toolbar (404: Not Found).

Do you want to open the profiler? 
```

当我单击确定时，我收到错误：

```
app_dev.php/_profiler/5053258a822e1 
```

和

```
404 Not found 
```

我正在使用 nginx

非常感谢您的帮助。

编辑：这是错误日志：

```
[error] 18369#0: *9 open() "/var/www/Symfony/web/app_dev.php/_wdt/5056f875afc98" failed (20: Not a directory), client: 127.0.0.1, server: symfony, request: "GET /app_dev.php/_wdt/5056f875afc98 HTTP/1.1", host: "symfony", referrer: "http://symfony/app_dev.php"
[error] 18369#0: *9 open() "/var/www/Symfony/web/404" failed (2: No such file or directory), client: 127.0.0.1, server: symfony, request: "GET /app_dev.php/_wdt/5056f875afc98 HTTP/1.1", host: "symfony", referrer: "http://symfony/app_dev.php" 
```

编辑2：

当我尝试访问 app_dev.php 时，页面打开但没有工具栏，当我尝试使用 app_dev.php/ 时，我得到了

```
**Oops! An Error Occurred
The server returned a "404 Not Found".
Something is broken. Please e-mail us at [email] and let us know what you were doing when this error occurred. We will fix it as soon as possible. Sorry for any inconvenience caused. ** 
```

错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-08T16:24:52.723

我知道这不完全是你问的，但可能会帮助未来搜索这个问题的人，就像@yvoyer 建议的那样，我的问题也是斜杠，我的服务器使用了 nginx 和 fpm，并且在 nginx // 中不 euqal / ，所以我不得不对我的虚拟主机 conf 进行一些修复，之后它运行良好。我只是将conf粘贴给需要它的人，或者建议一个更好的。

```
 location / {
            try_files $uri @pass_to_symfony;
    }

    location ~ /app_dev.php/ {
            try_files $uri @pass_to_symfony_dev;
    }

    location @pass_to_symfony{
            rewrite ^ /app.php?$request_uri last;
    }

    location @pass_to_symfony_dev{
            rewrite ^ /app_dev.php?$request_uri last;
    }

    location ~ ^/app(_dev)?\.php($|/) {
            include fastcgi_params;
            fastcgi_pass   unix:/var/run/php5-fpm.sock; # replace with your sock path
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T19:02:58.560

我有同样的错误，但我发现在我输入时输出了消息，`app_dev.php/`但在请求时没有输出`app_dev.php`（注意尾部斜杠`/`）。

我认为它与路由器有关，但这只是一个有根据的猜测

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-20T05:01:34.927

我的错误与 Nginx 配置有关（使用 symfony 3.1），我刚刚从 Symfony 编辑了 Nginx 的推荐配置：

[http://symfony.com/doc/current/setup/web_server_configuration.html](http://symfony.com/doc/current/setup/web_server_configuration.html)

所以，也许是因为符号链接，我不知道。

我将一小部分复制到 Nginx 默认配置并进行编辑以匹配所有 .php：

```
##
# You should look at the following URL's in order to grasp a solid understanding
# of Nginx configuration files in order to fully unleash the power of Nginx.
# http://wiki.nginx.org/Pitfalls
# http://wiki.nginx.org/QuickStart
# http://wiki.nginx.org/Configuration
#
# Generally, you will want to move this file somewhere, and start with a clean
# file but keep this around for reference. Or just disable in sites-enabled.
#
# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
##

# Default server configuration
#
server {
    listen 80 default_server;
    listen [::]:80 default_server;

    # SSL configuration
    #
    # listen 443 ssl default_server;
    # listen [::]:443 ssl default_server;
    #
    # Note: You should disable gzip for SSL traffic.
    # See: https://bugs.debian.org/773332
    #
    # Read up on ssl_ciphers to ensure a secure configuration.
    # See: https://bugs.debian.org/765782
    #
    # Self signed certs generated by the ssl-cert package
    # Don't use them in a production server!
    #
    # include snippets/snakeoil.conf;

    root /var/www/html;

    # Add index.php to the list if you are using PHP
    index index.html index.htm index.nginx-debian.html;

    server_name _;

    location / {
        # First attempt to serve request as file, then
        # as directory, then fall back to displaying a 404.
        try_files $uri $uri/ =404;
    }

    # Symfony
    location ~ \.php(/|$) {
            fastcgi_pass unix:/var/run/php/php7.0-fpm.sock;
        fastcgi_split_path_info ^(.+\.php)(/.*)$;
        include fastcgi_params;
        # When you are using symlinks to link the document root to the
        # current version of your application, you should pass the real
        # application path instead of the path to the symlink to PHP
        # FPM.
        # Otherwise, PHP's OPcache may not properly detect changes to
        # your PHP files (see https://github.com/zendtech/ZendOptimizerPlus/issues/126
        # for more information).
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
        fastcgi_param DOCUMENT_ROOT $realpath_root;
    }

    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
    #
    #location ~ \.php$ {
    #   include snippets/fastcgi-php.conf;
    #
    #   # With php7.0-cgi alone:
    #   fastcgi_pass 127.0.0.1:9000;
    #   # With php7.0-fpm:
    #   fastcgi_pass unix:/run/php/php7.0-fpm.sock;
    #}

    # deny access to .htaccess files, if Apache's document root
    # concurs with nginx's one
    #
    #location ~ /\.ht {
    #   deny all;
    #}

}

# Virtual Host configuration for example.com
#
# You can move that to a different file under sites-available/ and symlink that
# to sites-enabled/ to enable it.
#
#server {
#   listen 80;
#   listen [::]:80;
#
#   server_name example.com;
#
#   root /var/www/example.com;
#   index index.html;
#
#   location / {
#       try_files $uri $uri/ =404;
#   }
#} 
```

对于生产服务器，我建议坚持 Symfony 推荐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:51:28.957

要在 Symfony2 页面中以开发人员模式显示 Web 调试工具栏，应具有有效的 HTML。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-06-01T20:20:39.677

它发生在我的开发环境中，所以我在我的虚拟主机配置文件中评论了指令 DirectoryIndex，所以现在我进入我的应用程序：`http://127.0.0.1/app_dev.php` 并且没有更多关于探查器的错误！我使用 Symfony 2.3.x。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-17T14:21:57.003

我找到了解决方案（或多或少）。我采用了另一个现有的 Symfony 项目，现在一切正常。我真的不知道为什么 Symfony 标准版本在我的情况下不起作用......如果有人需要空的 symfony 项目，我可以上传存档。

编辑：这里是工作 Symfony 2.0 的模板：[http ://www.megafileupload.com/en/file/372986/Symfony-tpl-zip.html](http://www.megafileupload.com/en/file/372986/Symfony-tpl-zip.html)

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2013-06-04T10:41:02.903

请尝试注意您的.htaccess，我也遇到了这个问题，我解决了我的问题。

```
 <IfModule mod_rewrite.c>
    RewriteEngine On
        RewriteCond %{REQUEST_URI}::$1 ^(/.+)/(.*)::\2$
    RewriteRule ^(.*) - [E=BASE:%1]
    RewriteCond %{ENV:REDIRECT_STATUS} ^$
    RewriteRule ^app_dev.php(/(.*)|$) %{ENV:BASE}/$2 [R=301,L]    ##### this is the part that you should tweak, have the .htaccess point the request to app_dev.php, since the routing.yml is empty initially
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule .? - [L]
    RewriteRule .? %{ENV:BASE}/app_dev.php [L]        ##### this is the part that you should tweak, have the .htaccess point the request to app_dev.php, since the routing.yml is empty initially
    </IfModule>

    <IfModule !mod_rewrite.c>
    <IfModule mod_alias.c>
        # When mod_rewrite is not available, we instruct a temporary redirect of
        # the startpage to the front controller explicitly so that the website
        # and the generated links can still be used.
        RedirectMatch 302 ^/$ /app.php/
        # RedirectTemp cannot be used instead
    </IfModule>
    </IfModule> 
```

# java - Cordova 2.0.0 中的 Phonegap Screenshot 插件

> ID：12424865
> 
> 赞同：0
> 
> 时间：2012-09-14T12:45:49.147
> 
> 标签：java, android, eclipse, cordova, cordova-2.0.0

我已经从 github 设置了截图插件，位于此处：

[https://github.com/phonegap/phonegap-plugins/tree/master/Android/Screenshot](https://github.com/phonegap/phonegap-plugins/tree/master/Android/Screenshot)

我按照指示使用 1.8.1 的科尔多瓦进行了设置。它有效，屏幕截图已保存到手机中。然而，它在科尔多瓦 2.0.0 中失败了。

截图.java代码：

[https://github.com/phonegap/phonegap-plugins/blob/master/Android/Screenshot/src/org/apache/cordova/Screenshot.java](https://github.com/phonegap/phonegap-plugins/blob/master/Android/Screenshot/src/org/apache/cordova/Screenshot.java)

截图.js 代码：

[https://github.com/phonegap/phonegap-plugins/blob/master/Android/Screenshot/www/Screenshot.js](https://github.com/phonegap/phonegap-plugins/blob/master/Android/Screenshot/www/Screenshot.js)

由于一个名叫 Simon MacDonald 的聪明人的建议，我从上面显示的 JS 文件中删除了第 31 和 38 行。

但是，当我尝试将屏幕截图插件与 cordova 2.0.0 一起使用时，我收到以下错误：

```
ERROR: org.json.JSONException: Value undefined of type java.lang.String cannot be converted to JSONArray.
Error: Status=8 Message=JSON error
file:///android_asset/www/cordova-2.0.0.js: Line 938 :  Error: Status=8 Message=JSON error
Error: Status=8 Message=JSON error at file:///android_asset_/www/cordova-2.0.0.js:938 
```

cordova.js 的第 938 行是：

```
 // If error, then display error
    else {
        console.log("Error: Status="+v.status+" Message="+v.message); 
```

但我几乎可以肯定这是一个兼容性错误。有谁知道解决这个问题，甚至是一个原因。我有点迷失了。任何帮助表示赞赏。

我用以下代码调用 screenshot.js：

```
function takeScreenShot() {
cordovaRef.exec("Screenshot.saveScreenshot"); 
```

}

任何帮助都非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T15:36:42.173

我刚刚升级它以支持 v2.0.0：

[https://github.com/phonegap/phonegap-plugins/commit/88a57e1c232f604f73be5bd82868d711ac235424](https://github.com/phonegap/phonegap-plugins/commit/88a57e1c232f604f73be5bd82868d711ac235424)

# r - 如何在不提前指定点击次数的情况下使用 gglocator？

> ID：12424873
> 
> 赞同：0
> 
> 时间：2012-09-14T12:46:02.233
> 
> 标签：r, ggmap

像这样使用`gglocator()`默认为一键。

是否可以使用`ggloactor`它来处理**动态**点击次数？即用户应该可以随意点击任意多次。

?

# java - 是否可以从 Java Applet 获取数据到 PHP 或 MySQL？

> ID：12424877
> 
> 赞同：0
> 
> 时间：2012-09-14T12:46:28.380
> 
> 标签：java, php, mysql, web, applet

我想创建一个带有小程序形式游戏的网站。我想使用人们在游戏中获得的高分显示在网站的排行榜上吗？这是如何实现的？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:49:04.030

这可以用 JSObject 来完成，基本上你在 Javascript 和 Java 之间传递信息。

*基于[文档](http://java.sun.com/products/plugin/1.3/docs/jsobject.html#Enable)的示例 。*

假设这是您的 Java Applet，netscape.javascript.* 库用于调用浏览器的 Plugin 容器（运行 Java Applet 的窗口）以将信息传入或传出。这是来自文档的示例，您可以将版本更改为您首选的 JDK 版本到您使用的任何版本。

```
import netscape.javascript.*;
import java.applet.*;
import java.awt.*;
class MyApplet extends Applet {
     public void init() {

         // requesting the JSObject
         JSObject win = JSObject.getWindow(this);

         // here you call a javascript function
         win.call("myJavscriptFunction", null);

         // if you wish to pass an argument to the javascript function,
         // do the following
         String myString = "World!";
         final Object[] args = { myString };  
         win.call("myJavascriptFunction2()", args);
     }
} 
```

我将使用 EMBED 标签作为示例，但也可以使用 OBJECT（IE 等）标签（请参阅顶部链接中的文档）。您不应该忘记的最重要的属性是启用`MAYSCRIPT=true`

```
<EMBED type="application/x-java-applet;version=1.3" width="200"
   height="200" align="baseline" code="XYZApp.class"
   codebase="html/" model="models/HyaluronicAcid.xyz" MAYSCRIPT=true
   pluginspage="http://java.sun.com/products/plugin/1.3/plugin-install.html">
<NOEMBED>
   No JDK 1.3 support for APPLET!!
</NOEMBED>
</EMBED> 
```

现在 HTML/PHP 文件中的 javascript 函数

```
<script text="text/javascript">
  function myJavascriptFunction() {
    alert("Hello!");
  }

  /**
   * with argument
   */
  function myJavascriptFunction2(myString) {
     alert("Hello "+myString);
     // will produce "Hello World!";
  }
</script> 
```

参考：[java.sun.com/products/plugin/1.3/docs/jsobject](http://java.sun.com/products/plugin/1.3/docs/jsobject.html#Enable)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:50:06.313

1.  我认为您应该将所有高分保存在数据库中

2.  使用 php 或其他语言使用该分数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:52:06.770

允许您的小程序调用原始服务器上的 URL。这可以用来保存高分。

# sqlite - 是否可以测试 SQLite 3 中是否启用了加载扩展？

> ID：12424883
> 
> 赞同：4
> 
> 时间：2012-09-14T12:46:55.110
> 
> 标签：sqlite

是否可以测试是否在 SQLite 3 中从 C 接口或使用 SQL[启用扩展加载](https://www.sqlite.org/c3ref/enable_load_extension.html)而不实际尝试加载扩展？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-05T21:25:48.490

您可以使用此查询来检查扩展加载是否*默认*启用：

```
SELECT sqlite_compileoption_used('ENABLE_LOAD_EXTENSION'); 
```

但这只有在您知道`sqlite3_enable_load_extension`永远不会被调用时才对您有用。

内部`SQLITE_LoadExtension`标志不可访问；它仅在 SQLite 实际尝试加载扩展时才被读取。

您可以做的是尝试加载已知无效的扩展名，例如`load_extension('/dev/null')`. 如果扩展加载被禁用，错误消息将`not authorized`代替类似`file too short`.

# reporting-services - 从进程对话框触发 SSRS 报告

> ID：12424884
> 
> 赞同：0
> 
> 时间：2012-09-14T12:46:59.283
> 
> 标签：reporting-services, dynamics-crm, dynamics-crm-2011

我有几个自定义报告，我希望能够从 CRM 对话框触发它们。

可能吗？如果是这样，任何例子都会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:55:03.717

实际*执行*报告（而不是显示它）需要更多的工作。我们过去使用过“触发实体”模型。

总之，您的工作流或对话框创建了一个报表触发器实体的实例，该实例具有保存要运行的报表的属性（SSRS 中的相对 URL）以及应作为参数传递给数据集的实体。在创建这样的触发器记录时，我们注册了一个插件，该插件调用 SSRS Web 服务，执行然后将报告呈现为 PDF。由于无法仅向用户显示此报告，因此您必须决定是否将呈现的报告通过电子邮件发送给调用用户，或者在我们的例子中，提交到上下文 SharePoint 文档库以获取在原始文件中处理的记录工作流程。

我们的要求非常具体；）此外，这在 CRM Online 中不起作用，因为没有公开 SSRS Web 服务。

在您的情况下，鉴于 Process Dialog 的交互性，我认为 James 的方法可能更合适。我已将此添加为潜在的另一个选项的介绍。如果它适合您的用例，很高兴发布更多内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T13:28:18.773

[执行此操作的最简单方法是使用此处](http://ryanfarley.com/blog/archive/2006/01/27/15689.aspx)所示的 url 打开报告。

然后，您只需在对话框中显示 url。

![在此处输入图像描述](../Images/22ee31d62cfdf78734175e770a6098e8.png)

# java - 标准生成器@OneToMany 在哪里

> ID：12424886
> 
> 赞同：0
> 
> 时间：2012-09-14T12:47:18.623
> 
> 标签：java, jpa-2.0, criteria-api

我有这个领域的实体：

```
//on main entity
@OneToMany(mappedBy="minutisPreke", targetEntity=MinutisPrekeTiekejas.class, fetch=FetchType.EAGER, cascade = CascadeType.ALL)
private List<MinutisPrekeTiekejas> tiekejai;

//inverse join of MinutisPrekeTiekejas entity
@OneToOne(fetch=FetchType.LAZY)
@JoinColumn(name="tiek_id")
private MinutisTiekejas minutisTiekejas; 
```

我正在构建标准查询，我需要检查该实体是否包含`MinutisPrekeTiekejas`数组中具有 id 的对象`Constants.ID_ARRAY`

像这样的东西（这看起来不对，也不起作用，只是原理）：

```
...
//predicates is a predicate array
predicates.add(from.get("tiekejai").get("tiekId").in(Constants.ID_ARRAY));
... 
```

# regex - PatternReplaceFilterFactory 中的美元符号

> ID：12424891
> 
> 赞同：0
> 
> 时间：2012-09-14T12:47:36.430
> 
> 标签：regex, search, solr, sunspot

在 Solr 中，我希望“a$ap”找到“asap”以及“a$ap”。为了实现这一点，我将其添加到 schema.xml 中的索引和查询分析器并重新索引：

```
<filter class="solr.PatternReplaceFilterFactory" pattern="$" replacement="s"/> 
```

但是，“a$ap”只返回“a$ap”，“asap”只返回“asap”。这可能是一些愚蠢的语法问题，但我不知道出了什么问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:30:56.053

您应该转义 $，因为它是正则表达式的特殊字符，表示结束。

采用 ：-

```
 <fieldType name="test" class="solr.TextField" sortMissingLast="true" omitNorms="true">
      <analyzer>
        <tokenizer class="solr.KeywordTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory" />
        <filter class="solr.PatternReplaceFilterFactory" pattern="\$" replacement="s" replace="all" />
      </analyzer>
    </fieldType> 
```

上面的字段完美地替换了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T08:18:35.083

最后我用 MappingCharFilterFactory 修复了它。

我将此添加到索引和查询分析器中：

```
<charFilter class="solr.MappingCharFilterFactory" mapping="mapping.txt"/> 
```

mapping.txt 看起来像这样：

```
"$" => "s" 
```

重新索引后就成功了！

# javascript - 是否可以在 HTML 文本框中键入宏？

> ID：12424892
> 
> 赞同：0
> 
> 时间：2012-09-14T12:47:39.373
> 
> 标签：javascript, jquery, html, textbox

我正在验证 HTML 文本框字段`<input type="text" />`，我需要检测用户是否在文本框中输入了 Macron。我的问题是，有什么方法可以将 Macron 类型（不是复制粘贴）到 HTML 文本框中？如果是这样，您将如何检测用户是否输入了 Macron？

我已经检查了[这个页面](http://www.personal.psu.edu/ejp10/psu/gotunicode/macron.html)。在底部，它显示了如何输入它，但我不能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:01:55.610

是的，可以使用 [Alt 代码](http://www.wouterlowies.nl/voorbeeld/chars/)

Alt-0175 在输入字段中给出一个宏 ¯。

但是，我不知道如何将宏与字符组合，但这不是问题。

*编辑：* 找到这些用于宏字符的 ALT 代码。（仅适用于 Word）

小写元音

*   ā ALT+0257 下长A
*   ē ALT+0275 下长 E
*   ī ALT+0299 下长 I
*   ō ALT+0333 下长 O
*   ū ALT+0363 下长U
*   ȳ ALT+0562 下长 Y
*   æ ALT+0230 下 AE 灯
*   – ALT+0156 下 OE 灯

大写元音

*   Ā ALT+0256 盖长 A
*   Ē ALT+0274 帽长 E
*   Ī ALT+0298 盖长 I
*   Ō ALT+0332 盖长 O
*   Ū ALT+0362 帽长 U
*   Ȳ ALT+0563 帽长 Y
*   Æ ALT+0198 Cap AE 灯
*   Œ ALT+0140 Cap OE lig

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:16:49.267

是的，您应该始终假设用户可以在文本框中键入任何字符。无论您在这里所说的“马克龙”是什么意思，这都是正确的。它可能表示 U+00AF 长音“¯”，或 U+0304 组合长音，或长音作为字符的一部分，如 U+0101 拉丁小写字母 A 与长音“ā”。

例如，使用带有符合现代芬兰标准的键盘驱动程序的普通芬兰键盘，我只使用 AltGr ¨ 空格键入“¯”，使用 AltGr ¨ A 键入“ā”。例如可以使用我自己的键盘输入组合宏用于组合标记的驱动程序或 Fileformat.info 页面上描述的“通用方法”[如何在 Microsoft Windows 中输入 Unicode 字符](http://www.fileformat.info/tip/microsoft/enter_unicode.htm)。

您可以通过检查字段的值来检测任何意义上的宏。使用 JavaScript 时，您可以检查值是否包含`\u00af`（如果您不确定如何直接在代码中输入“¯”并确保其正确读取）。

# c++ - std::ostream::operator<< 没有为 std::string 定义？

> ID：12424897
> 
> 赞同：3
> 
> 时间：2012-09-14T12:47:54.583
> 
> 标签：c++, std, stdstring, ostream

我偶然发现了一个我无法理解原因的错误。

我认为它基本上归结为这个错误：

```
 error: no matching function for call to ‘std::basic_ostream<char>::operator<<(const std::basic_string<char>&)’ 
```

我查看了[www.cplusplus.com](http://www.cplusplus.com/reference/iostream/ostream/operator%3C%3C/)上的规范，确实它说没有定义`std::ostream::operator<<`with`std::string`作为参数。

我的问题是，当一个人写作时会发生什么`std_ostream_instance << std_fancy_string;`。我相信它是旁边最常见的调用之一（例如`std::out << std::string("Hello world!")`）`const char*`。

错误源于以下几行：

```
template<typename T> 
void Log::_log(const T& msg)
{  _sink->operator<<( msg ); } 
```

`_sink`被蔑视，因为`std::ostream*` 有一些包装功能，但它在这里中断。

我想我可以通过写作来解决

```
template<> 
void Log::_log<std::string>(const std::string& msg) {
  _sink->operator<<( msg.c_str() );
} 
```

因为有`ostream& operator<< (ostream& out, const unsigned char* s );`默认定义。

我只是看不出为什么它不会被自动猜到，因为它显然可以在简单的使用中工作，例如`cout << any_std_string`.

不确定这是否相关，但我希望能够通过我的日志函数传递任何`std::ostream`. 我使用了显式的非模板化声明，但决定使用模板`log(const T& anything_to_log)`来重构它。有 5 次以上的重载似乎很愚蠢。当我尝试编译类似`Log::log( std::string("test case") )`.

它看起来很简单，但我自己无法做到。尝试谷歌和搜索堆栈无济于事。

关于，luk32。

PS。我检查了解决方法，它可以工作。为什么它没有隐式完成？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T12:56:13.060

`operator <<`重载不是`ostream`. 它们是独立的函数，例如

```
ostream& operator << ( ostream& out, const basic_string<T>& bs ); 
```

尝试

```
template<typename T> 
void Log::_log(const T& msg)
{  *_sink << msg;  } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-14T12:59:59.033

版本不是成员函数，因此`std::string`不能作为`_sink`. 尝试以这种方式获取成员和非成员版本（事实上，无论如何您都不太可能需要成员版本）：

```
#include <iostream>
#include <string>

int main()
{
    std::ostream * os = &std::cout;
    std::string s = "Hello\n";

    // This will not work
    // os->operator<<(s);
    (*os) << s;

    return 0;
} 
```

或者更好的是存储`_sink`为参考，并完全按照您通常的方式输出`cout`。

# windows-8 - 如何将适用于 Windows 8 和 Windows 桌面的 Visual Studio Express 2012 合二为一？

> ID：12424901
> 
> 赞同：2
> 
> 时间：2012-09-14T12:47:55.267
> 
> 标签：windows-8, visual-studio-2012

我已经安装了以上两个，但它们是作为两个完全独立的 IDE 安装的！在 RC 版本中，我可以将 Metro 风格应用程序和桌面应用程序编程为一体。拥有两个 Visual Studio 是非常不切实际的。有没有办法合并这些 IDE？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:48:47.093

您正在寻找 Visual Studio Professional 或更高版本（而不是 Express），它可以完成所有工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:49:21.213

不，你不能把它们结合起来。

Express 版本设计为用于不同任务的独立程序。

如果您想要一个多合一的 IDE，那么您必须购买完整版的 Visual Studio（例如专业版）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T12:49:23.973

是的。购买完整的产品。如果成本对您来说是个问题，恐怕您将不得不安装 2 个 IDE。

# numpy - 使用 : 运算符来索引 numpy.void 的 numpy.ndarray（作为 numy.genfromtxt 的输出）

> ID：12424904
> 
> 赞同：0
> 
> 时间：2012-09-14T12:48:07.230
> 
> 标签：numpy, indexing, python-2.7, genfromtxt

`numpy.genfromtxt`我使用这样的方法生成数据：

```
ConvertToDate = lambda s:datetime.strptime(s,"%d/%m/%Y")
data= numpy.genfromtxt(open("PSECSkew.csv", "rb"), 
                        delimiter=',',
                        dtype=[('CalibrationDate', datetime),('Expiry', datetime), ('B0', float), ('B1', float), ('B2', float), ('ATMAdjustment', float)],
                        converters={0: ConvertToDate, 1: ConvertToDate}) 
```

我现在想提取最后 4 列（每行但在一个循环中，所以我们只考虑一行）来分隔变量。所以我这样做：

```
 B0 = data[0][2]
    B1 = data[0][3]
    B2 = data[0][4]
    ATM = data[0][5] 
```

但是，如果我能做到这一点（例如，我可以使用普通的 2D ndarray），我会更喜欢它：

```
 B0, B1, B2, ATM = data[0][2:] 
```

但这给了我一个“无效索引”错误。有没有办法很好地做到这一点，还是我应该坚持使用 4 线方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T12:55:39.553

作为 的输出`np.genfromtxt`，您有一个结构化数组，即一维数组，其中每一行作为不同的字段。

如果要访问某些字段，只需按名称访问它们：

```
data["B0"], data["B1"], ... 
```

您还可以将它们分组：

```
data[["B0", "B1]] 
```

它为您提供了一个“新”结构化数组，其中仅包含您想要的字段（“新”周围的引号，因为未复制数据，它仍然与您的初始数组相同）。

如果您想要一些特定的“行”，只需执行以下操作：

```
data[["B0","B1"]][0] 
```

输出第一行。切片和精美的索引也可以工作。

因此，对于您的示例：

```
B0, B1, B2, ATM = data[["B0","B1","B2","ATMAdjustment"]][0] 
```

如果您只想逐行访问这些字段，我建议先存储您想要的字段的整个数组，然后迭代：

```
filtered_data = data[["B0","B1","B2","ATMAdjustment"]]
for row in filtered_data:
    (B0, B1, B2, ATM) = row
    do_something 
```

甚至 ：

```
for (B0, B1, B2, ATM) in filtered_data:
    do_something 
```

# ios - 具有 contentMode UIViewContentModeScaleAspectFit 的 UIImageView 的 UILabel

> ID：12424905
> 
> 赞同：1
> 
> 时间：2012-09-14T12:48:08.700
> 
> 标签：ios, contentmode

我需要在 UIImageView 上设置一个具有自定义背景颜色的标签。问题是我希望它的宽度与图像视图中的图像完全相同。这是到目前为止的代码：

```
UIImageView *pictureV = [[UIImageView alloc] initWithFrame:CGRectMake(pictureX, 0, pictureSize.width, pictureSize.height)];
pictureV.image = self.picture.image;
pictureV.contentMode = UIViewContentModeScaleAspectFit; 
```

和标签：

```
UILabel *lblName = [[UILabel alloc]init];
lblName.backgroundColor=[UIColor colorWithRed:0.5 green:0.5 blue:0.5 alpha:0.6];
lblName.frame = CGRectMake(pictureV.bounds.origin.x, pictureV.bounds.origin.y + pictureV.bounds.size.height - 30, self.picture.image.size.width, 30);
[lblName setText:self.pictureNote.text];
[lblName setTextAlignment:UITextAlignmentCenter];
[lblName setTextColor:[UIColor whiteColor]];
[pictureV addSubview:lblName] 
```

将 contentMode 设置为 UIViewContentModeScaleAspectFit 时，某些图像比我的 UIImageView 小，我似乎无法使标签的宽度大小相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T14:35:50.883

如果使用 UIViewContentModeScaleAspectFit，图像将不会占用 UIImage View 的完整大小。而不是将您的pictureV 的 contentMode 属性设置为 UIViewContentModeScaleToFill ，然后图像将占用您的 imageView 的整个大小

# jquery - 可折叠标题内的jQuery移动按钮

> ID：12424911
> 
> 赞同：3
> 
> 时间：2012-09-14T12:48:15.370
> 
> 标签：jquery, jquery-mobile, header

如果有人可以帮助我，我将不胜感激。我正在尝试使用 jQuery mobile 1.2 Beta（使用 jQuery 1.7.1）动态构建可折叠块。

现在我有一个问题，我想在可折叠的标题内有一个按钮，一切正常，但是当我点击按钮时，我设置的点击事件不会被触发，而是块被展开或折叠。

```
$('#main').append('<div data-role="collapsible" data-theme="c" data-content-theme="c" id="pflicht_' 
+ identifier + '" pflichtID="' + val.guid + '">' +
'<h3 style="white-space: normal;" id="inner_header_' + identifier + '">' 
+ header + ': ' + val.pflichtBezeichnung + ' (' + val.Intervall + ' - ' + val.IntModus + ') ' 
+ val.pflichtNummer + '.' + val.pflichtZusatz + 
'<button type="button" data-inline="true" id="ok" pflichtID="' 
+ val.guid + '" identifier="' + identifier + '" >Ok</button></h3>' +
'</div>'

$("#ok").live('click', function () {
                  alert("ok");
              }); 
```

我该怎么做才能获得按钮的点击事件？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T14:12:42.673

首先，您应该意识到`.live`已弃用[on](http://api.jquery.com/on/)。

也就是说，要了解这里发生了什么，您需要了解事件委托的一般工作原理，`live`特别是当您使用事件委托时，您将事件绑定到 DOM 中的更高级别（某些父元素），然后因为事件让您冒泡检查原始事件以查看它是否与指定的选择器匹配。

该`.live`方法通过将事件绑定到`document`（因此它始终绑定到父元素）来工作，然后当事件冒泡到 时，`document`它会检查它是否与指定的选择器匹配。您的问题是某些东西（可能是*collapisple header*）正在吞噬`click`事件，因此它永远不会到达文档。

解决方案非常简单，要么直接绑定到按钮，要么委托给 DOM 中的较低级别，即您的事件将到达的某个地方。

例如

```
$('#inner_header_' + identifier).on('click', '#ok', function(e) {
    alert('ok');
}); 
```

如果您不希望在单击按钮时标题展开和折叠，只需阻止事件进一步冒泡，您可以使用[stopPropagation()](http://api.jquery.com/event.stopPropagation/)方法来完成

例如

```
$('#inner_header_' + identifier).on('click', '#ok', function(e) {
    alert('ok');
    e.stopPropagation()
}); 
```

# java - 使用来自android的外部Jar调用Web服务方法时出错

> ID：12424912
> 
> 赞同：0
> 
> 时间：2012-09-14T12:48:24.700
> 
> 标签：java, android, web-services, ksoap2

我正在尝试从我正在通过axis2 Web 服务访问的android device.my java 方法调用一些java 方法。

这是我的完整 Java 类，因为我编写了两个从 Adnroid 设备调用的方法。不知何故，它只是成功调用 get_wav_byte() 方法，但对于另一种方法，它给了我如下错误

在 java.lang.Thread.run(Thread.java:662) 引起：java.lang.NoClassDefFoundError: edu/cmu/sphinx/util/props/ConfigurationManager

这是我在识别波（字符串波路径）方法中使用的外部 jar 库中的类。我还检查了 edu/cmu/sphinx/util/props/ConfigurationManager 在 jar 文件 m 中是否可用，包括仍然给我错误。我给你我的 java 和 android 的完整代码如下

JAVA方法：

```
package edu.cmu.sphinx.demo.transcriber;

import edu.cmu.sphinx.frontend.util.AudioFileDataSource;
import edu.cmu.sphinx.recognizer.Recognizer;
import edu.cmu.sphinx.result.Result;
//import edu.cmu.sphinx.util.props.ConfigurationManager;
import edu.cmu.sphinx.util.props.ConfigurationManager;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;

import java.net.MalformedURLException;
import java.net.URL;

import javax.sound.sampled.UnsupportedAudioFileException;

/** A simple example that shows how to transcribe a continuous audio file that has multiple utterances in it. */
public class Transcriber {

      //  private static final String PATH = "file:///D:\\Sound\\";

    @SuppressWarnings("null")
    public static String recognize_wave(String wavePath) throws MalformedURLException{

         String resultText="";
              URL audioURL;

               audioURL = new URL(wavePath);
               URL configURL = Transcriber.class.getResource("config.xml");

                ConfigurationManager cm = new ConfigurationManager(configURL);
                Recognizer recognizer = (Recognizer) cm.lookup("recognizer");

                /* allocate the resource necessary for the recognizer */
                recognizer.allocate();

                // configure the audio input for the recognizer
                AudioFileDataSource dataSource = (AudioFileDataSource) cm.lookup("audioFileDataSource");
                dataSource.setAudioFile(audioURL, null);

                // Loop until last utterance in the audio file has been decoded, in which case the recognizer will return null.
                Result result;
                while ((result = recognizer.recognize())!= null) {

                      resultText  = result.getBestResultNoFiller();
                        System.out.println(resultText);
                }

            return resultText;
        }

        public String get_wav_byte(byte[] wavbite,String path) throws IOException

        {

            String result1="null";
            //return result1;

             final String PATH = "file:///D:\\Sound\\";

            //System.out.println(bhavik1111);

            try
        {
            File dstFile = new File(path);
            FileOutputStream out = new FileOutputStream(dstFile);
                out.write(wavbite, 0, wavbite.length);

            out.close();

        }
        catch (IOException e)
        {
          System.out.println("IOException : " + e);
        }

        try {
            result1=recognize_wave(path);
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    return result1;

 }

} 
```

我用 KSOAP2 调用该方法的 Android 代码如下：

```
package com.varma.samples.audiorecorder;

import java.io.BufferedInputStream;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;

import org.ksoap2.SoapEnvelope;
import org.ksoap2.SoapFault;
import org.ksoap2.serialization.MarshalBase64;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.media.AudioFormat;
import android.media.AudioRecord;
import android.media.MediaRecorder;
import android.os.Bundle;
import android.os.Environment;
import android.util.Base64;
import android.util.Log;
import android.view.View;
import android.view.ViewDebug.FlagToString;
import android.widget.Button;
import android.widget.TextView;

public class RecorderActivity extends Activity {
    private static final int RECORDER_BPP =16;
    private static final String AUDIO_RECORDER_FILE_EXT_WAV = ".wav";
    private static final String AUDIO_RECORDER_FOLDER = "AudioRecorder";
    private static final String AUDIO_RECORDER_TEMP_FILE = "record_temp.raw";
    private static String AUDIO_WAV_FILE = "";
    private static final int RECORDER_SAMPLERATE = 16000;
    private static final int RECORDER_CHANNELS = AudioFormat.CHANNEL_CONFIGURATION_MONO;
    private static final int RECORDER_AUDIO_ENCODING = AudioFormat.ENCODING_PCM_16BIT;

    private AudioRecord recorder = null;
    private int bufferSize = 0;
    private Thread recordingThread = null;
    private boolean isRecording = false;

    @SuppressLint("NewApi")
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        setButtonHandlers();
        enableButtons(false);

        bufferSize = AudioRecord.getMinBufferSize(RECORDER_SAMPLERATE,RECORDER_CHANNELS,RECORDER_AUDIO_ENCODING);
    }

    private void setButtonHandlers() {
        ((Button)findViewById(R.id.btnStart)).setOnClickListener(btnClick);
        ((Button)findViewById(R.id.btnStop)).setOnClickListener(btnClick);
    }

    private void enableButton(int id,boolean isEnable){
        ((Button)findViewById(id)).setEnabled(isEnable);
    }

    private void enableButtons(boolean isRecording) {
        enableButton(R.id.btnStart,!isRecording);
        enableButton(R.id.btnStop,isRecording);
    }

    private String getFilename(){
        String filepath = Environment.getExternalStorageDirectory().getPath();
        File file = new File(filepath,AUDIO_RECORDER_FOLDER);

        if(!file.exists()){
            file.mkdirs();
        }

        return (file.getAbsolutePath() + "/" + System.currentTimeMillis() + AUDIO_RECORDER_FILE_EXT_WAV);
    }

    private String getTempFilename(){
        String filepath = Environment.getExternalStorageDirectory().getPath();
        File file = new File(filepath,AUDIO_RECORDER_FOLDER);

        if(!file.exists()){
            file.mkdirs();
        }

        File tempFile = new File(filepath,AUDIO_RECORDER_TEMP_FILE);

        if(tempFile.exists())
            tempFile.delete();

        return (file.getAbsolutePath() + "/" + AUDIO_RECORDER_TEMP_FILE);
    }

    @SuppressLint({ "NewApi", "NewApi" })
    private void startRecording(){
        recorder = new AudioRecord(MediaRecorder.AudioSource.MIC,
                        RECORDER_SAMPLERATE, RECORDER_CHANNELS,RECORDER_AUDIO_ENCODING, bufferSize);

        recorder.startRecording();

        isRecording = true;

        recordingThread = new Thread(new Runnable() {

            @Override
            public void run() {
                writeAudioDataToFile();
            }
        },"AudioRecorder Thread");

        recordingThread.start();
    }

    @SuppressLint({ "NewApi", "NewApi", "NewApi" })
    private void writeAudioDataToFile(){
        byte data[] = new byte[bufferSize];
        String filename = getTempFilename();
        FileOutputStream os = null;

        try {
            os = new FileOutputStream(filename);
        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        int read = 0;

        if(null != os){
            while(isRecording){
                read = recorder.read(data, 0, bufferSize);

                if(AudioRecord.ERROR_INVALID_OPERATION != read){
                    try {
                        os.write(data);
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                }
            }

            try {
                os.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    @SuppressLint({ "NewApi", "NewApi" })
    private void stopRecording(){
        if(null != recorder){
            isRecording = false;

            recorder.stop();
            recorder.release();

            recorder = null;
            recordingThread = null;
        }

        copyWaveFile(getTempFilename(),getFilename());
        deleteTempFile();
    }

    private void deleteTempFile() {
        File file = new File(getTempFilename());

        file.delete();
    }

    @SuppressLint("NewApi")
    private void copyWaveFile(String inFilename,String outFilename){
        FileInputStream in = null;
        FileOutputStream out = null;
        long totalAudioLen = 0;
        long totalDataLen = totalAudioLen + 36;
        long longSampleRate = 16000;
        int channels = 1;
        long byteRate = RECORDER_BPP * RECORDER_SAMPLERATE * channels/8;
    /// long byteRate = 256;

        byte[] data = new byte[bufferSize];

        try {
            in = new FileInputStream(inFilename);
            out = new FileOutputStream(outFilename);
            totalAudioLen = in.getChannel().size();
            totalDataLen = totalAudioLen + 36;

            AppLog.logString("File size: " + totalDataLen);

            WriteWaveFileHeader(out, totalAudioLen, totalDataLen,
                    longSampleRate, channels, byteRate);

            while(in.read(data) != -1){
                out.write(data);
            }

            in.close();
            out.close();
            //////////////////

            AUDIO_WAV_FILE=outFilename;
            /////////////////

        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
/////////////read wav file and convert to byte////////////////////
    public static byte[] getBytesFromFile(File file) throws IOException {

        /*
        InputStream is = new FileInputStream(file);

        // Get the size of the file
        long length = file.length();

        // You cannot create an array using a long type.
        // It needs to be an int type.
        // Before converting to an int type, check
        // to ensure that file is not larger than Integer.MAX_VALUE.
        if (length > Integer.MAX_VALUE) {
            // File is too large
        }

        // Create the byte array to hold the data
        byte[] bytes = new byte[(int)length];

        // Read in the bytes
        int offset = 0;
        int numRead = 0;
        while (offset < bytes.length
               && (numRead=is.read(bytes, offset, bytes.length-offset)) >= 0) {
            offset += numRead;
        }

        // Ensure all the bytes have been read in
        if (offset < bytes.length) {
            throw new IOException("Could not completely read file "+file.getName());
        }

        // Close the input stream and return bytes
        is.close();
        return bytes;
        */
        ByteArrayOutputStream out = new ByteArrayOutputStream();
        BufferedInputStream in = new BufferedInputStream(new FileInputStream(file));

        int read;
        byte[] buff = new byte[1024];
        while ((read = in.read(buff)) > 0)
        {
            out.write(buff, 0, read);
        }
        out.flush();
        byte[] audioBytes = out.toByteArray();

        return audioBytes;

    }

    //////////////////////////////////////
    private void WriteWaveFileHeader(
            FileOutputStream out, long totalAudioLen,
            long totalDataLen, long longSampleRate, int channels,
            long byteRate) throws IOException {

        byte[] header = new byte[44];

        header[0] = 'R';  // RIFF/WAVE header
        header[1] = 'I';
        header[2] = 'F';
        header[3] = 'F';
        header[4] = (byte) (totalDataLen & 0xff);
        header[5] = (byte) ((totalDataLen >> 8) & 0xff);
        header[6] = (byte) ((totalDataLen >> 16) & 0xff);
        header[7] = (byte) ((totalDataLen >> 24) & 0xff);
        header[8] = 'W';
        header[9] = 'A';
        header[10] = 'V';
        header[11] = 'E';
        header[12] = 'f';  // 'fmt ' chunk
        header[13] = 'm';
        header[14] = 't';
        header[15] = ' ';
        header[16] = 16;  // 4 bytes: size of 'fmt ' chunk
        header[17] = 0;
        header[18] = 0;
        header[19] = 0;
        header[20] = 1;  // format = 1
        header[21] = 0;
        header[22] = (byte) channels;
        header[23] = 0;
        header[24] = (byte) (longSampleRate & 0xff);
        header[25] = (byte) ((longSampleRate >> 8) & 0xff);
        header[26] = (byte) ((longSampleRate >> 16) & 0xff);
        header[27] = (byte) ((longSampleRate >> 24) & 0xff);
        header[28] = (byte) (byteRate & 0xff);
        header[29] = (byte) ((byteRate >> 8) & 0xff);
        header[30] = (byte) ((byteRate >> 16) & 0xff);
        header[31] = (byte) ((byteRate >> 24) & 0xff);
        header[32] = (byte) (2 * 16 / 8);  // block align
        header[33] = 0;
        header[34] = RECORDER_BPP;  // bits per sample
        header[35] = 0;
        header[36] = 'd';
        header[37] = 'a';
        header[38] = 't';
        header[39] = 'a';
        header[40] = (byte) (totalAudioLen & 0xff);
        header[41] = (byte) ((totalAudioLen >> 8) & 0xff);
        header[42] = (byte) ((totalAudioLen >> 16) & 0xff);
        header[43] = (byte) ((totalAudioLen >> 24) & 0xff);

        out.write(header, 0, 44);

    }

    private View.OnClickListener btnClick = new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            switch(v.getId()){
                case R.id.btnStart:{
                    AppLog.logString("Start Recording");

                    enableButtons(true);

                    startRecording();

                    break;
                }
                case R.id.btnStop:{
                    AppLog.logString("Start Recording");

                    enableButtons(false);
                    stopRecording();

                     File source_for_byte=new File( AUDIO_WAV_FILE);
                        byte[] temp = new byte[(int) source_for_byte.length()];

                        try {
                            temp=getBytesFromFile(source_for_byte);
                        } catch (IOException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }

                        //byte[] strBase64 = Base64.encode(temp, Base64.NO_WRAP);
                        //Request.addProperty("image", strBase64); 
                        //////////////////////WebService Activity ///////////////////////

                        String METHOD_NAME = "";
                        // our webservice method name
                        String NAMESPACE = "http://test.com";
                        String SOAP_ACTION = NAMESPACE + METHOD_NAME;
                        // NAMESPACE + method name

                        //final String URL = "http://192.168.3.106:8080/axis2/services/speechmain?wsdl";

                        final String URL="http://192.168.3.106:8080/axis2/services/VoiceService?wsdl";

                            METHOD_NAME = "get_wav_byte";
                            try {
                                SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);

                            request.addProperty("wavbite", temp);

                            request.addProperty("path", "D:\\sound\\latest_recognizer.wav");
                            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(
                                    SoapEnvelope.VER11);

                            new MarshalBase64().register(envelope); // serialization

                            envelope.encodingStyle = SoapEnvelope.ENC;
                                envelope.dotNet = true;
                                envelope.setOutputSoapObject(request);
                                HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
                                androidHttpTransport.call(SOAP_ACTION, envelope);
                                Object result = envelope.getResponse();

                               // Object  result = (SoapObject) envelope.bodyIn;

                                ((TextView) findViewById(R.id.gettext1)).setText("NUMBER IS :->   "
                                         + result.toString());

                            } catch (Exception E) {
                                E.printStackTrace();
                                ((TextView) findViewById(R.id.gettext1)).setText("ERROR:"
                                        + E.getClass().getName() + ":" + E.getMessage());
                            }

                        /////////////////////////

                    break;
                }
            }
        }
    }; 
} 
```

我能理解的是它是如何不工作的，因为我在该公共静态字符串识别波（字符串波路径）方法中使用外部 jar 文件。

我已经搜索了很多，但仍然没有好的指导。

希望你能帮我..

提前致谢 ..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:41:15.020

检查以确保您的外部 jar 文件包含在您的构建路径中以及您的 libs 文件夹中。如果您没有 libs 文件夹，您可以在项目的根目录中创建一个。然后将您的 jar 文件复制并粘贴到此位置。然后右键单击 Eclipse 中的 jar 文件，`Build Path`然后单击`Add To Build Path`. 如果您的 libs 文件夹中有 jar 文件，则不会出现任何编译器错误。但这仅适用于编译时间。如果 jar 不在构建路径中，它将在运行时失败。

# c++ - C++ 条件运算符性能

> ID：12424914
> 
> 赞同：3
> 
> 时间：2012-09-14T12:48:33.320
> 
> 标签：c++, performance, conditional, conditional-statements

我有一个条件语句`expensive_foo()`，在 99.9% 的情况下它是错误的。我有一个条件语句`bar`，在约 50% 的情况下是正确的。

如果两个陈述都是真的，我希望采取一些行动。所以我几乎肯定知道那`expensive_foo()`是假的，我只想检查它是否`bar`是真的。

下面的代码是否会检查`expensive_foo()`ONLY if`bar`为真？还是`expensive_foo()`每次都会检查？

```
if ( bar && expensive_foo() )
{
    ...
} 
```

或者我需要制作这样的结构：

```
if ( bar )
{
    if ( expensive_foo() )
    {
        ...
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T12:50:52.290

逻辑 AND 运算符`&&`是短路的，这意味着当且仅当第一个操作数被评估为 时，保证第二个操作数被评估`true`。条件`if (bar && foo)`和`if (bar) if (foo)`是相同的。

鉴于`foo`计算成本很高，您几乎绝对应该`bar`先检查一下。尽管`bar`分支预测器不能很好地预测，但与`foo`.

因此，结构可能应该是：

```
if (bar)
{
    if (bool const foo = compute())   // expensive
    {
        // ...
    }
} 
```

请注意，所有这些结构都意味着我们可能会或可能不会调用`compute()`. 如果您无条件地需要函数调用，那么您应该将其作为*第一个*检查。在这种情况下，应该利用对结果的成功分支预测。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T12:51:50.190

两个代码都只会检查是否`foo`为`bar`真。在第一种情况下，这是由语言惰性布尔表达式评估来保证的（实际上可以在某些编译器中显式关闭，但默认情况下是打开的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T14:38:46.613

其他答案很好，但我质疑这个前提。

如果您查询的谓词在 99.9% 的情况下为假，这类似于在 2000 个条目的列表中进行线性搜索，您要查找的项目可能以大致相等的概率出现在任何地方。

在这种情况下，通常人们会尝试以不同的方式组织列表，以便进行 O(logN)（或更好）搜索而不是 O(N)。我不知道你能不能做到这一点，但那是我要关注的地方。

当以高度偏斜的概率提出问题时，如果可以取消偏斜，那可能是一个很大的加速机会。（假设大部分时间都花在了这个活动上。如果不是，那么这一点就没有实际意义了。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T16:31:25.117

如果两者的优化装配不完全相同，我会感到惊讶。如果 bar 为 false，则永远不会调用昂贵的 foo()。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-14T23:37:05.477

我看到一条评论说编译器可以重新排序操作，我倾向于这种观点。改进顺序程序的自动并行化的努力产生了更好的编译器，它有助于程序员避免从他们的程序中执行复杂的并行化例程。编译器可以对操作重新排序，前提是重新排序不违反/恶化局部性，或者在广义上不违反程序的实际意图。

但我怀疑编译器会尝试重新排序条件语句，例如：

```
 if ( bar && expensive_foo() ) 
```

如果把成本较低的布尔函数放在开头，肯定可以节省一些时间。

# entity-framework - 实体框架，在插入时自动链接到现有实体

> ID：12424917
> 
> 赞同：3
> 
> 时间：2012-09-14T12:48:42.220
> 
> 标签：entity-framework

我不确定这是否可行，但我在数据库中插入了很多实体，并且对于每个项目，它都有一个语言属性，它是一个实体。目前我为每个要插入的项目创建一个新的语言对象，但这只是为了测试，因为它会创建很多重复项。语言在数据库中应该是唯一的，并且应该只指向现有的语言记录，我能想到的唯一方法是为每个插入进行单独的服务调用以查找语言代码并获取现有语言的 id，这是很多开销。

有没有办法让它根据语言代码自动查找记录并使用该记录？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-21T13:33:29.583

两者`ObjectContext`和`DbContext`都有方法尝试从内存中的上下文中找到已加载的实体 - `GetObjectByKey`for`ObjectContext`和`Find`for `DbContext`。`Language`使用这些方法可以避免从数据库中多次加载实体。

这两种方法都需要一个主键值作为输入参数来按键查找实体。本质上将这些方法视为访问将主键与实体对象相关联的内部字典。

现在，参考您的评论...

> 本质上是尝试匹配自定义值而不是 id/主键值。

...您不能使用这些方法，因为它们依赖于知道您要查找的主键值。

我要做的是通过您自己的字典来模仿上述内部字典的逻辑，该字典将您的“自定义值”与实体而不是主键相关联。我假设自定义值在`Language`表中是唯一的。

所以，这个想法是：

鉴于您有这样的实体...

```
public class MyEntity
{
    public int Id { get; set; }
    public Language Language { get; set; }
    public string SomeOtherValue { get; set; }
    // ... more
}

public class Language
{
    public int Id { get; set; }             // primary key value
    public string CustomValue { get; set; } // the unique custom value
    // ... more
} 
```

...并且您有一组用于插入新实体的数据...

```
public class Data
{
    public string SomeOtherValue { get; set; }
    public string LanguageCustomValue { get; set; }
    // ... more
}

var dataList = new List<Data>
{
    new Data { SomeOtherValue = "A", LanguageCustomValue = "EN" },
    new Data { SomeOtherValue = "B", LanguageCustomValue = "FR" },
    new Data { SomeOtherValue = "C", LanguageCustomValue = "EN" },
    new Data { SomeOtherValue = "D", LanguageCustomValue = "EN" },
    // ... more
} 
```

...然后你可以使用这个：

```
using (var context = new MyContext())
{
    var dict = new Dictionary<string, Language>();
    foreach (var data in dataList)
    {
        Language language;
        if (!dict.TryGetValue(data.LanguageCustomValue, out language))
        {
            // load the language only once from the database
            language = context.Languages.SingleOrDefault(l =>
                l.CustomValue == data.LanguageCustomValue);
            dict.Add(data.LanguageCustomValue, language);
        }

        var myEntity = new MyEntity
        {
            SomeOtherValue = data.SomeOtherValue,
            Language = language
        };

        context.MyEntities.Add(myEntity);  // or AddObject
    }
    context.SaveChanges();
} 
```

这将只加载一个`Language`实体`LanguageCustomValue`，只执行一次，并且不会`Language`在数据库中创建对象的副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T23:22:57.477

不确定您在这里的确切含义，但如果它在插入期间，您通常会检查它是否存在，如果不存在则添加它。如果您插入一堆实体，您可以将语言存储在上下文中。不确定这是否是最好的解决方案。不要认为没有密钥就可以快速找到商店或上下文中的对象。根据您的语言实体的复杂性，您可以将上下文“语言”变量*转换为 ToDictionary()*并通过它来代替。

```
//'db' is your context here.
var languages = db.Languages.all();
myentity MyEntity = new MyEntity();
myentity.property1 = "mynewvalue1";

var newlang = new Language{ LanguageName= "newlanguagename"};
//language exists?
if (!languages.Any( u => u.LanguageName== newlang.LanguageName ))
 {

  // no:
  db.Languages.InsertOnSubmit(newlang);
  db.SubmitChanges();
  myentitly.Language = newlang;
 }
else{

  //yes:
  myentitly.Language = languages.Where( u => u.LanguageName== newlang.LanguageName).Single();
 }

db.MyEntities.InsertOnSubmit(myentity);
db.SubmitChanges(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T12:32:21.527

由于您关心开销性能成本，我建议这是处理此问题的最有效方法：

**第 1 步：确保您的语言表是正确的。**

我不确定您是如何定义使用哪些语言的，所以在这里我无法为您提供帮助，只需确保您的语言表包含所有需要的行。假设您的表格如下：

```
{ Id: 1 ; Language: "English" }
{ Id: 2 ; Language: "French"  }
{ Id: 3 ; Language: "German"  } 
```

**第 2 步：处理您的实体**

步骤 2.1：创建一个`Dictionary<string, int>`以轻松映射您的语言表：

```
var lang_list = new Dictionary<string, int>();

using(var db = new DbContext()
{
     foreach(var row in db.Languages.ToList())
     {
            lang_list.Add(row.Language, row.Id);
     }
}

//From now on, you can refer to the local list. 
```

步骤 2.2：向（待添加的）实体添加正确的语言

我不知道您将如何确定需要添加的语言。假设您有一个字符串变量`myLanguage`，其中包含您需要的语言的字符串名称。

您可能想要使用类似的东西：

```
int foundvalue;

if(lang_list.TryGetValue( myLanguage , out foundvalue ))
{
     //if language is in the list, the value (= the id of the row in the language
     // table) will be stored in foundvalue
     myEntity.LanguageId = foundvalue;
}
else
{
     //if the language wasn't found in the list, set a default lang (e.g. English)
     myEntity.LanguageId = 1;
} 
```

我希望这可以帮助你解决你的问题？

使用此过程的好处：

*   您只需为语言查询一次数据库。填充列表后，它将存储在内存中，这是一种性能更好的方法。
*   如果实体设置了意外或不正确的语言，您将能够使用默认语言。

# .net - Quickie：EF5 中的 ForeignKeyAttribute 在哪里？

> ID：12424919
> 
> 赞同：1
> 
> 时间：2012-09-14T12:48:48.700
> 
> 标签：.net, entity-framework

我在 EF5 中找不到此属性：http: [//msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.foreignkeyattribute.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.schema.foreignkeyattribute.aspx)

谁能告诉我它去了哪里？它是否已过时并被 DataAnnotations 中的另一个类取代？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:09:00.333

原来我只需要将目标框架从 4 更改为 4.5。

# objective-c - iOS：Html 解析 - 如何在其中忽略 a、li 等标签

> ID：12424920
> 
> 赞同：4
> 
> 时间：2012-09-14T12:48:54.583
> 
> 标签：objective-c, ios, xpath, html-parsing, hpple

我目前正在使用 Hpple 来解析 HTML，如下所示：

```
TFHpple *htmlParser = [TFHpple hppleWithHTMLData:[currentString dataUsingEncoding:NSUTF8StringEncoding]];
NSString *paragraphsXpathQuery = @"//p//text()";
        NSArray *paragraphNodes = [htmlParser searchWithXPathQuery:paragraphsXpathQuery];
        if ([paragraphNodes count] > 0) {
            NSMutableArray *tempArray = [NSMutableArray array];
            for (TFHppleElement *element in paragraphNodes) {
                [tempArray addObject:[element content]];
            }
            article.paragraphs = tempArray;
        } 
```

这样我就得到了一个段落数组，我可以用`NSString *result = [myArray componentsJoinedByString:@"\n\n"];`它来将它编译成带有换行符的单个文本体。

但是，如果 html 包含标签，它们将被解释为单独的实体，并且会自行换行，所以**在一天结束时，从这样的一行开始：**

```
<p>I went to the <a href="blablabla.html">shop</a> to get some milk!</a></p>
<p>It was awesome.</p> 
```

**我明白了：**

```
I went to the

shop

to get some milk!

It was awesome! 
```

**当然我想得到这个（忽略标签内的其他`p`标签）：**

```
I went to the shop to get some milk!

It was awesome! 
```

**你能帮我吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T13:23:04.983

**在 XPath 1.0 中，您可以分两步执行此操作**：

1.  选择所有`p`元素：`//p`

2.  在每个选定`p`的元素（用作初始上下文节点）上评估：`string()`

**说明**：

根据定义，将标准 XPath 函数**[`string()`](http://www.w3.org/TR/xpath/#function-string)**应用于元素的结果是其所有文本节点后代的串联（按文档顺序）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T13:48:22.433

```
NSString *HTMLTags = @"<[^>]*>"; //regex to remove any html tag

NSString *htmlString = @"<html>bla bla</html>";
NSString *stringWithoutHTML = [hstmString stringByReplacingOccurrencesOfRegex:myregex withString:@""]; 
```

不要忘记将其包含在您的代码中：#import "RegexKitLite.h" 这里是下载此 API 的链接：[http ://regexkit.sourceforge.net/#Downloads](http://regexkit.sourceforge.net/#Downloads)

# java - 尝试从 Tomcat 迁移到 Jetty 以在工作站、tomcat vs jetty 上进行测试

> ID：12424921
> 
> 赞同：0
> 
> 时间：2012-09-14T12:48:55.650
> 
> 标签：java, spring, tomcat, maven, jetty

一段时间以来，我一直在使用 eclipse 和 tomcat 编写 Spring/Web 项目，但现在我开始使用 Maven，我也在考虑使用 jetty 进行工作站测试。

我制作了一个示例网络应用程序，如果我从 eclipse 在 tomcat 上运行它，我会转到**http://localhost:8080/TestJetty/**但如果我执行 mvn jetty:run 我必须从**http://localhost:8080/访问它**

这是为什么？

我也可以设置 eclipse 来运行码头吗？两者的优缺点是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:06:44.630

通常使用 maven jetty 插件的“jetty:run”目标，上下文路径是`/`，除非它被 contextPath 配置条目覆盖：

```
 <plugin>
            <groupId>org.mortbay.jetty</groupId>
            <artifactId>jetty-maven-plugin</artifactId>
            <version>Your version..</version>
            <configuration>
                <webApp>
                    <contextPath>/mycontextpath</contextPath>
                </webApp>
            </configuration>
        </plugin> 
```

在 Eclipse 中，可能是您的项目名称被用作上下文路径。

关于利弊，这只是您的舒适程度，我更喜欢命令行，因此通常会使用“mvn jetty：run”在eclipse之外运行它

# javascript - 在画布上绘制图像 - jQuery

> ID：12424926
> 
> 赞同：0
> 
> 时间：2012-09-14T12:49:04.947
> 
> 标签：javascript, jquery, jquery-ui

如何将可放置的图像绘制到画布中。

我知道我应该使用：

```
var c=document.getElementById("myCanvas");
var ctx=c.getContext("2d");
var img=document.getElementById("image");
ctx.drawImage(img,//drop x position ,//drop y position); 
```

我可以使用 jquery 来实现吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:00:29.497

**更新了位置校正演示**：http : [//jsfiddle.net/techfoobar/VFZ4m/2/](http://jsfiddle.net/techfoobar/VFZ4m/2/)

* * *

是的，你可以这样做。检查这个演示：http: [//jsfiddle.net/techfoobar/VFZ4m/1/](http://jsfiddle.net/techfoobar/VFZ4m/1/)

请注意，您需要微调画布上绘制图像的 x、y。

HTML：

```
<img id="x" src="image.png">
<canvas id="c" width="200" height="200"> 
```

JS：

```
$('#x').draggable();
$('#c').droppable({
    drop: function(event, ui) {
        var img = ui.draggable;
        var ctxt =$("#c")[0].getContext("2d");
        var offs = $("#c").offset();
        ctxt.drawImage(img[0], event.pageX - offs.left, event.pageY - offs.top);
        return false;
    }
}); 
```

# asp.net - 如何将 CSS 应用于在 ASP.NET 中创建的 pdf 文件

> ID：12424927
> 
> 赞同：1
> 
> 时间：2012-09-14T12:49:08.117
> 
> 标签：asp.net, css

我已经使用第三方生成了一个 pdf 文件，现在我想将自己的样式应用于 pdf 中的内容。

我可以在生成的 PDF 中插入外部 CSS 文件吗？我尝试了很多方法，但都不起作用。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:53:43.423

您不能使用 CSS 为已生成的 PDF 设置样式。它不是由可选元素组成的，也无法将 CSS 链接到 PDF。

您必须在创建 PDF*之前进行样式设置。*这就像试图在已经烤好的蛋糕上添加更多的糖，没有办法做到这一点。

# testing - Haskell：测试 Web API

> ID：12424928
> 
> 赞同：7
> 
> 时间：2012-09-14T12:49:09.290
> 
> 标签：testing, haskell, web

我一直想知道使用什么方法（如果有的话）来测试通过网络执行请求的 Haskell 应用程序？来自 Ruby 领域，我一直在寻找可以存根或“模拟”网络调用以测试 Haskell 函数的任何东西。我对类似“VCR”的解决方案（例如：[https](https://github.com/myronmarston/vcr) ://github.com/myronmarston/vcr ）特别感兴趣，因为它似乎是最可行的选择，恕我直言。

因此，我希望能够记录一次网络请求/响应对，然后将这些记录重用于后续测试。我想出了我自己的简单组合，在测试之前启动一个 Web 服务器（warp），提供预先录制的响应，但我必须将应用程序中的所有 URL 指向“localhost”。我想，这并不总是可以替换应用程序中的所有 URL。虽然我对上面描述的自己的设置非常满意（并且想稍后从中制作一个专用的测试工具/框架“插件”），但我宁愿不重新发明轮子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:46:57.653

Check out [Control.Proxy.Tutorial](http://hackage.haskell.org/packages/archive/pipes/2.3.0/doc/html/Control-Proxy-Tutorial.html). If you can write a Proxy wrapper around your type, then you can easily swap out the test interface and a real interface like this:

```
client <-< simulatedServer

client <-< realServer 
```

Edit: To answer your question in the comment, you use a `Server` to write a wrapper around your `simpleHTTP` requests:

```
realServer
 :: HStream ty => Request ty -> Server (Request ty) (Result (Response ty)) IO r
realServer = foreverK $ \req -> do
    result <- lift $ simpleHTTP req
    respond result 
```

The simulated server would look like:

```
simulatedServer
 :: (Monad m, HStream ty)
 => Request ty -> Server (Request ty) (Result (Response ty)) m r
simulatedServer = foreverK $ \req -> do
    result <- lift $ simulatedRequest req
    respond result 
```

And your client would look like:

```
client
 :: (Monad m, HStream ty) => () -> Client (Request ty) (Result (Response ty)) m r
client () = forever $ do
    let req = <something>
    result <- request req
    lift $ doSomethingWith result 
```

Then you can test the real server and fake server using:

```
-- Test the real server
main = runSession $ client <-< realServer

-- Test the fake server
main = runSession $ client <-< simulatedServer 
```

The `client` and `simulatedServer` are polymorphic in the base monad only because I don't know what base monad they would use for your testing. The only requirement is that the two things you compose have the same base monad or that at least one is polymorphic in the base monad.

# magento - 商品详情页如何根据分类调用不同的静态块？

> ID：12424937
> 
> 赞同：0
> 
> 时间：2012-09-14T12:49:35.447
> 
> 标签：magento, magento-1.6

我想在产品详细信息页面“**根据类别**”中调用不同的 2 个静态块。

```
Lets say i have 2 categories :

1.electronics
2.mobiles 
```

在电子类中，我想在特定部分显示不同的静态块。在手机类中，我想在同一特定部分显示不同的静态块。

我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:12:44.230

如果您可以在后端创建静态块并将其命名为`category_static_block_1`等 `category_static_block_2`，这些将分别显示在类别 id 1 和 2 中，您可以在`.phtml`文件中使用以下代码来执行此操作。

```
<?php echo $this->getLayout()->createBlock('cms/block')->setBlockId('category_static_block_'+$catid)->toHtml() ?> 
```

这里`$cat_id`应该包含当前的类别 ID。

# android - Wordpress 博客 Android 应用

> ID：12424947
> 
> 赞同：1
> 
> 时间：2012-09-14T12:50:28.197
> 
> 标签：android, wordpress

我想知道是否有用于 Wordpress Android 应用程序的开源项目？我不想通过应用程序管理 Wordpress，只是让我的用户可以通过应用程序浏览我的新闻。我需要代码来适应它，而且我不想要一个 webview，尽管我想要的非常简单（4 个选项卡，一个用于新闻的选项卡，其余的用于静态页面）。

我在网上搜索，我找不到任何东西，看看有多少人使用 WP，我想可能有人带来了他们愿意分享的应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:57:56.427

有很多 Wordpress 插件可以将您的网站转换为适用于多个不同平台的原生或基于 html5 的移动应用程序。您可以在此处找到一些 Android 的列表：

[http://wordpress.org/extend/plugins/tags/android](http://wordpress.org/extend/plugins/tags/android)

UppSite 看起来很容易使用。

# multithreading - 如何在 Delphi 中进行异步编程？

> ID：12424952
> 
> 赞同：8
> 
> 时间：2012-09-14T12:50:47.547
> 
> 标签：multithreading, delphi, asynchronous, delphi-xe

我有一个应用程序，其中大多数操作都需要一些时间，我希望始终保持 GUI 响应。用户触发的任何动作的基本模式如下：

1.  准备动作（在主线程中）
2.  执行动作（在后台线程中，同时保持 gui 响应）
3.  显示结果（在主线程中）

我尝试了几件事来实现这一点，但从长远来看，所有这些都会导致问题（在某些情况下似乎是随机访问违规）。

1.  准备动作，然后调用后台线程，在后台线程结束时，`Synchronize`用于调用`OnFinish`主线程中的事件。
2.  准备动作，然后调用后台线程，并在后台线程结束时`PostMessage`通知 GUI 线程结果已准备好。
3.  准备动作，然后调用后台线程，然后忙等待（调用时`Application.ProcessMessages`）直到后台线程完成，然后继续显示结果。

我想不出另一种选择，而且这些都不适合我。这样做的首选方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T13:32:13.063

您可以使用 OTL 作者[在此处演示的 OTL 来实现所质疑的模式](http://www.thedelphigeek.com/2012/07/asyncawait-in-delphi.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-14T13:48:05.553

1) 是“原始 Delphi”方式，强制后台线程等待同步方法执行完毕，并使系统面临比我满意的更多死锁可能性。TThread.Synchronize 至少被重写了两次。我在 D3 上使用过一次，但遇到了问题。我看了看它是如何工作的。我再也没有用过它。

2）我最常使用的设计。我使用应用程序生命周期线程（或线程池），创建线程间通信对象，并使用基于 TObjectQueue 后代的生产者-消费者队列将它们排队到后台线程。后台线程/s 对对象的数据/方法进行操作，将结果存储在对象中，完成后，PostMessage() 对象，（转换为 lParam）返回到主线程，以便在消息中以 GUI 显示结果-处理程序，（再次将 lParam 投射回去）。主 GUI 线程中的后台线程就不必对同一个对象进行操作，也不必直接访问彼此的任何字段。

我使用 GUI 线程的隐藏窗口（使用 RegisterWindowClass 和 CreateWindow 创建）作为 PostMessage 的后台线程，LParam 中的 comms 对象和“目标”TwinControl（通常是 TForm 类）作为 WParam。隐藏窗口的简单 wndproc 只使用 TwinControl.Perform() 将 LParam 传递给表单的消息处理程序。这比将对象直接发送到 TForm.handle 更安全 - 不幸的是，如果重新创建窗口，句柄可能会发生变化。隐藏窗口从不调用 RecreateWindow()，因此它的句柄永远不会改变。

生产者 - 消费者队列“从 GUI 出来”、线程间通信类/对象和 PostMessage()“进入 GUI”将运行良好 - 我已经这样做了几十年。

重用通讯对象也相当容易——只需在启动时在循环中创建一个负载（最好在初始化部分中，以便通讯对象比所有形式都更有效），然后将它们推送到 PC 队列中——这就是你的池。如果 comms 类有一个用于池实例的私有字段，那就更容易了——“releaseBackToPool”方法不需要参数，如果有多个池，则确保对象总是被释放回它们自己的池。

3）不能真正改善大卫赫弗曼的评论。只是不要这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T13:10:01.880

您可以在线程之间将数据作为消息进行通信。

线程1：

1.  为数据结构分配内存
2.  填入
3.  使用指向此结构的指针向 Thread2 发送消息（您可以使用 Windows 消息或实现队列，确保其入队和出队方法没有竞争条件）
4.  可能会收到来自 Thread2 的响应消息...

线程2：

1.  从 Thread1 接收带有指向数据结构的指针的消息
2.  消费数据
3.  释放数据结构的内存
4.  可能以类似的方式将消息发送回 Thread1（可能重用数据结构，但您不会释放它）

如果您希望您的 GUI 不仅是实时的，而且还响应一些输入，那么您最终可能会得到超过 1 个非 GUI 线程，而处理需要很长时间才能处理的输入。

# ruby-on-rails-3.1 - rails中的重定向问题

> ID：12424965
> 
> 赞同：0
> 
> 时间：2012-09-14T12:51:28.910
> 
> 标签：ruby-on-rails-3.1

我已经重定向到`dashboard_path`用户登录后。我相信该控制器中应该有一个名为仪表板的操作。但是，当我在控制器中删除该仪表板操作时，它仍然可以正常工作。这怎么可能。？请帮忙。我很困惑。

在会话控制器中

```
def create
  admin=Admin.find_by_email(params[:session][:email].downcase)
  user=User.find_by_email(params[:session][:email].downcase)

  if user && user.authenticate(params[:session][:password])
    redirect_to dashboard_path
  else
    redirect_to(admins_index_path(:current_admin=>admin))
  end
end 
```

在用户控制器中（如果我在用户控制器中删除了此操作，它仍然会重定向到仪表板页面。如何？？）

```
def dashboard
end 
```

路线.rb

```
match '/dashboard' => 'admins/users#dashboard' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:20:57.653

它被称为“约定优于配置”，Rails 有很多。如果您没有在控制器动作中指定任何`render`或`redirect_to`，Rail 的默认行为是重定向到与动作同名的视图。

您应该阅读[动作控制器概述](http://guides.rubyonrails.org/action_controller_overview.html)以获取有关此主题的更多信息（它是[Rails 指南](http://guides.rubyonrails.org/index.html)的一部分，包含有关 Rails 行为的大量信息）。

# django - django - 尝试登录时出现 KeyError

> ID：12424967
> 
> 赞同：0
> 
> 时间：2012-09-14T12:51:33.480
> 
> 标签：django, django-sessions

当我尝试登录时，它显示：

```
KeyError at /admin/

'loggedin' 
```

只有当我使用正确的用户名和密码提交时，它才会显示此错误。所以我认为这是关于我的管理员视图..

这是我的登录视图：

```
def log_user_in(request):
    if request.method=='POST':
        uname = request.POST['username']
        password = request.POST['password']
        user = authenticate(username=uname, password=password)
        form = LoginForm(request.POST)
        if form.is_valid():
            if user is not None:
                request.session['loggedin']="djangoo"
                login(request, user)
                return HttpResponseRedirect('/admin/')
    else:
        form = LoginForm()

    return render_to_response('login.html',{'form':form,},context_instance=RequestContext(request)) 
```

并注销视图：

```
def log_user_out(request):
    user = request.user
    try:
        del request.session['loggedin']
    except KeyError:
        pass
    logout(request)
    return HttpResponseRedirect('/blog/%s/'%(user)) 
```

和管理员视图：

```
def admin_view(request):

    if request.session['loggedin'] == "djangoo":
    #other codes.. 
```

这是我的 urls.py：

```
urlpatterns = patterns('blog.views',
    url(r'^superadmin/', include(admin.site.urls)),

    url(r'^blog/(?P<username>[-\w]+)/$',view='index', name='index'),
    url(r'^blog/(?P<username>[-\w]+)/post/(?P<postslug>[-\w]+)',view='single_post', name='view_blog_post'),
    url(r'^login/$', view='log_user_in'), # i log in to admin page from this url
    url(r'^admin/$', view='admin_view', name='admin'),# to this url
    url(r'^admin/logout/$', view='log_user_out', name='logout'),
    url(r'^admin/post/add/$', view='add_post',name='addpost'),
    url(r'^admin/post/edit/(?P<post_id>\d+)', view='edit_post', name='editpost'),
    url(r'^admin/post/delete/(?P<post_id>\d+)', view='delete_post', name='deletePost'),

) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T13:15:33.077

当您注销时，您手动删除`request.session['loggedin']`密钥，当您浏览到管理页面时，`request.session['loggedin']`由于您已经删除了该密钥而失败。

您可以控制是否`request.session`有`loggedin`密钥：

```
`loggedin` in request.session 
```

因此，编写您的管理视图，如：

```
def admin_view(request):

    if `loggedin` in request.session and request.session['loggedin'] == "djangoo":
    #other codes.. 
```

或者干脆使用

```
if request.session.get('loggedin') == 'djangoo' 
```

正如@Alexander Larikov 所说

编辑：我需要提一下，最好检查一个键是否存在于字典或类似字典的结构中，特别是如果您也可以在其他地方删除该键。

# php - PHP重新排序月份名称数组

> ID：12424968
> 
> 赞同：9
> 
> 时间：2012-09-14T12:51:34.217
> 
> 标签：php, arrays

我有一系列当前排序的月份名称，例如（“April”、“August”、“February”）等。我想重新排序此列表，使其处于正常的月份顺序，例如（“January”、“二月三月”）

该数组是从 SHOW TABLES sql 查询中填充的，不幸的是 SHOW TABLES 没有 ORDER BY 参数，所以我认为最好的选择是将它们添加到数组中并重新排序数组以获得我正在寻找的内容。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-14T12:55:37.597

将月份转换为数值。然后使用数字顺序排列您的数组`sort()`

你可以使用这个问题：[convert month from name to number](https://stackoverflow.com/questions/3283550/convert-month-from-name-to-number)

@Matthew 的回答似乎效果很好：

```
$date = date_parse('July');;
echo $date["month"]; 
```

**工作解决方案**

```
$months = array("April", "August", "February");

usort($months, "compare_months");
var_dump($months);

function compare_months($a, $b) {
    $monthA = date_parse($a);
    $monthB = date_parse($b);

    return $monthA["month"] - $monthB["month"];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T13:01:08.967

```
$input = array('May', 'December', 'March', 'July');
$output = array();

foreach($input as $month) {
    $m = date_parse($month);
    $output[$m['month']] = $month;
}
ksort($output);

var_dump($output); 
```

**输出**

```
array
  3 => string 'March' (length=5)
  5 => string 'May' (length=3)
  7 => string 'July' (length=4)
  12 => string 'December' (length=8) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T13:05:06.560

这是一个稍微优化的版本（没有日期解析）^^

```
$foobar_months = array( 'april','februari', 'march', 'may', 'june', 'januari', 'august', 'october', 'july', 'november', 'december', 'september' );
usort( $foobar_months, "sortMonths" );
var_dump( $foobar_months );

function sortMonths ( $a, $b ) {
  $months = array( 'januari', 'februari', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december' );
  if ( array_search( $a, $months) == array_search( $b, $months) ) return 0;
  return array_search( $a, $months) > array_search( $b, $months) ? 1 : -1;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T12:57:39.547

不可能将数组作为独立数组进行排序，因为系统无法知道一月先来，二月之后等。您可以最初定义一个哈希，例如

```
a = {'January':0,'February':1,...'December':11} 
```

然后你可以用这种方式对你的数组进行排序

```
array_to_be_sorted = sorted(array_to_be_sorted, key = lambda(x): a[x]) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T13:09:28.067

您可以按照以下步骤

1.  获取 SHOW TABLES 的输出，这将是月份的未排序列表（“April”、“August”、“February”）
2.  将其传递给 switch case 如下
    $output_show_tables = ("April", "August", "February") $order_month_list = array(); foreach($output_show_tables 作为 $month){

switch($month) case '一月': $order_month_list[1] = 一月；休息; $order_month_list[2] = 二月；休息; .. ... $order_month_list[12] = 十二月；休息;

}

1.  现在你得到月份的订单清单

# c# - 如何使用多个可能的千位分隔符解析数字？

> ID：12424970
> 
> 赞同：1
> 
> 时间：2012-09-14T12:51:46.047
> 
> 标签：c#, .net

文化 nb-NO 有“”（空格）作为千位分隔符（数字组分隔符、货币组分隔符等），但也很常见键入“。” （时期）。小数点分隔符为“，”。

如何分配多个千位分隔符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:53:55.120

如果您知道分隔符是什么或知道一个列表，请使用[Int.TryParse](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)并传入代表分隔符的不同区域性。例如：

```
using System.Globalization;

...

string number; // Contains number to parse
int parsedNumber;
List<CultureInfo> cultures = new List<CultureInfo>()
{
    Cultureinfo.InvariantCulture,
    new CultureInfo("en-US"),
    ... // Insert other cultures here
};
CultureInfo matchingCulture = cultures.FirstOrDefault(cultureInfo =>
    Int.TryParse(number, out parsedNumber, 
        NumberStyles.AllowThousands, cultureInfo));
if(matchingCulture != null)
{
    // parsedNumber contains the parsed number and matchingCulture contains 
    // the culture that parsed it
} 
```

如果分隔符没有由不同的区域性表示，请考虑使用简单的 string.Replace() 将已知分隔符列表替换为单个已知分隔符，例如逗号。请注意，这可能会出现问题，例如，由于某些国家/地区的惯例冲突，千位分隔符与小数点一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T12:54:12.870

如果找不到内置解决方案，您可以随时将可能不需要的字符替换为`,`空字符串，然后解析数字。

# c# - 使用 Moq 模拟第三方库时内部类出现问题

> ID：12424971
> 
> 赞同：1
> 
> 时间：2012-09-14T12:51:46.673
> 
> 标签：c#, mocking, moq, exchangewebservices

我正在尝试使用 moq 模拟第三方库的方法。问题是我正在模拟的方法返回这个框架内部的一个对象，因此我无法实例化它。

在下面的示例中，ChangeCollection 和 ItemChange 都是内部的，我收到错误：“此处无法访问内部构造函数 'ChangeCollection'”

我在想出一个好的解决方案时遇到问题，有人有什么想法吗？

```
[TestMethod]
public void GetItemsForExistingEMails_should_call_GetItems_atleast_once()
{
    ewsMock = new Mock<IEwsIntegration>();
    ewsMock.Setup(e => e.GetItems()).Returns(new ChangeCollection<ItemChange>);
    var emailService = new EmailService(ewsMock.Object);

    var items = emailService.GetItemsForExistingEMails();

    ewsMock.Verify(e => e.GetItems(), Times.AtLeast(1));
    Assert.AreEqual(0, items.Count());
}

public interface IEwsIntegration
{
    ChangeCollection<ItemChange> GetItems();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T13:00:45.570

这里有几个可能的选择。

**第一个**要求您有权访问第 3 方源进行设置`InternalsVisibleTo`。

[http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.internalsvisibletoattribute.aspx)

然后，这允许您访问正在引用的 dll 上的内部成员，并且在 AssemblyInfo.cs 中看起来像这样：

```
[assembly: InternalsVisibleTo("Mynamespace.MyProject.Tests, PublicKey=00240...")] 
```

**其次**，由于`IEwsIntegration`公开了来自 3rd 方应用程序的类型，因此您可以更改它以便返回自己的类型。这将使您从 3rd 方应用程序中获得更好的抽象。

在这里，我将使用 AutoMapper 来管理 3rd 方应用程序的返回类型与我自己的类型之间的映射。然后，您可以模拟此依赖项（我使用 IAutoMapperWrapper）并让它在测试中返回您的返回类型的具体实现。

即使您使用自己的自定义转换器，您也可以模拟它返回的内容并提供一些您自己类型的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:22:24.463

我认为你可以`IEnumerable<ChangeItem>`在你的界面中返回。似乎[ChangeCollection](http://msdn.microsoft.com/en-us/library/dd633880%28v=exchg.80%29)只是`IEnumerable<T>`.

```
public interface IEwsIntegration
{
    IEnumerable<ItemChange> GetItems();
} 
```

然后你可以简单地在你的设置中返回一个列表

```
ewsMock.Setup(e => e.GetItems()).Returns(new List<ItemChange>()); 
```

**更新：**

由于您必须使用仅在具体类上定义的属性，因此您必须创建一个适配器。

首先使用具体类的成员创建一个接口。

```
public interface IChangeCollection<T> : IEnumerable<T>
{
    bool MoreChangesAvailable { get; }
    string SyncState { get; }
} 
```

确保从界面返回此类型：

```
public interface IEwsIntegration
{
    IChangeCollection<ItemChange> GetItems();
} 
```

然后，您必须创建一个实现，`IChangeCollection<T>`该实现将简单地直接调用 ChangeCollection 的实例。

```
public class ChangeCollectionAdapter<T> : IChangeCollection<T>
{
    private readonly ChangeCollection _changeCollection;

    public ChangeCollectionAdapter(ChangeCollection changeCollection)
    {
        _changeCollection = changeCollection;
    }

    public bool MoreChangesAvailable 
    { 
        get { return _changeCollection.MoreChangesAvailable; }
    }

    //other members
} 
```

# msp430 - 如何让 msp430 休眠 12 秒？

> ID：12424973
> 
> 赞同：3
> 
> 时间：2012-09-14T12:51:59.473
> 
> 标签：msp430, real-time-clock

让 MSP430 休眠 10 秒的最佳方法是什么。速度不如低功耗重要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T13:12:29.007

使用计时器。使用正确的预分频器设置定时​​器。预加载它并使其在 10 秒后溢出。启动定时器并使 CPU 处于低功耗状态。

在 10 秒后执行的定时器 ISR 中，唤醒 CPU。

就是这样。

# c# - 为什么单击按钮后我的 jQuery Accordion 会被删除？

> ID：12424976
> 
> 赞同：0
> 
> 时间：2012-09-14T12:52:12.693
> 
> 标签：c#, jquery, asp.net, postback, accordion

我想在我的 ASP.NEt 应用程序中使用 jQuery Accordion 并且它可以工作，但是如果我单击 Accordion 中的一个按钮，那么我的 Accordion 将被删除:(这里是我的代码和两个 pitures...

aspx：

```
<link href="App_Theme/mainStyle.css" type="text/css" rel="Stylesheet" />
    <script src="Scripte/jquery-1.8.0.min.js" type="text/javascript"></script>
    <script src="Scripte/jquery-ui-1.8.23.custom.min.js" type="text/javascript"></script>
    <link href="App_Theme/jquery-ui-1.8.23.custom.css" rel="stylesheet" type="text/css"/>

    <script type="text/javascript" language="javascript">

        $(document).ready(function () {
            $("#accordion").accordion();

        });

    </script>

</head>
<body>
    <form id="form1" runat="server">

    <asp:ToolkitScriptManager ID="manager" runat="server"></asp:ToolkitScriptManager>
    <asp:UpdatePanel ID="update" runat="server">
    <ContentTemplate>

    <div id="accordion">
            <h3><a href="#"><asp:Label ID="lblAbwesenheit" runat="server"/></a></h3>
            <div>
                 <asp:Panel runat="server" ID="pn1" DefaultButton="btnAbwesenheitErzeugen">
                            <div id="Angaben" runat="server">

                            <table id="Angabentabelle" runat="server">

                                <tr>
                                <td><asp:Label ID="lblAbwesenheitBis" runat="server" /></td><td><asp:TextBox ID="txtAbwesenheitBis" runat="server" Enabled="false"></asp:TextBox>
                                <asp:ImageButton Width="20px" Height="20px" ID="imgbtnAbwesenheitBis" runat="server" ToolTip="Abwesenheit bis..." ImageUrl="~/App_Theme/Calender.ico"  />
                                <asp:CalendarExtender ID="AbwesenheitBis" runat="server" TargetControlID="txtAbwesenheitBis"
                                 Format="dd.MM.yyyy" PopupButtonID="imgbtnAbwesenheitBis"></asp:CalendarExtender>
                                </td>
                                </tr>

                                <tr>
                                <td><asp:Label ID="lblVertreter" runat="server" /></td>
                                <td>
                                <asp:TextBox ID="txtVertreter" runat="server"></asp:TextBox>
                                <asp:AutoCompleteExtender ID="AutoComlete" runat="server" TargetControlID="txtVertreter" 
                                ServiceMethod="GetCompletionList" ServicePath="" Enabled="true"
                                DelimiterCharacters="" UseContextKey="true" MinimumPrefixLength="1" ></asp:AutoCompleteExtender>
                                (Suche nach Nachname)
                                </td>

                                </tr>
                            </table>

                                <asp:Button ID="btnAbwesenheitErzeugen" runat="server" Text="Erzeugen" OnClick="btnAbwesenheitErzeugen_Click" />
                                <br />
                            <br />

                            </div>

                            <HTMLEditor:Editor ID="htmlEditAbwesenheit" runat="server" Content="<% %>" />

                            </asp:Panel>
            </div>
            <h3><a href="#"><asp:Label ID="lblSignatur" runat="server" /></a></h3>
            <div>
               <HTMLEditor:Editor ID="htmlEditSignatur" runat="server" Content="<% %>" />
            </div>
        </div> 
```

如果我开始我的页面，我会看到：

![在此处输入图像描述](../Images/56d769546284badb3f34afdb01f4d1eb.png)

如果我单击按钮，那么我会看到...

![在此处输入图像描述](../Images/f164d23b6dc012b7531c1804fdc2b484.png)

为什么我的手风琴删除？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:54:56.543

这是因为您的手风琴位于更新面板中。当您回帖时，更新面板中的所有内容都会从 DOM 中删除并重新读取。因此，作为手风琴的 DOM 元素消失了。您需要调用： $("#accordion").accordion(); 在你的回发之后。

你可以这样做的一种方法是这样做：

```
<script type="text/javascript" language="javascript">
   function SetupAccordion(){
        $("#accordion").accordion();
   }
   $(document).ready(function () {
     SetupAccordion();
     if (typeof Sys.WebForms != 'undefined') {
       Sys.WebForms.PageRequestManager.getInstance().add_endRequest(SetupAccordion);
     }
   });   
</script> 
```

# php - 使用 ajax 将数据发送到 php 时出现“不允许发布方法”错误

> ID：12424978
> 
> 赞同：0
> 
> 时间：2012-09-14T12:52:25.027
> 
> 标签：php, javascript, mysql, ajax, razor

我想向 php 发送一些数据以更改我的 MySQL 数据库中的某些内容，但我不断收到此 405 错误“不允许使用 POST 方法”。我用谷歌搜索了很多，但找不到任何有用的解决方案。有人可以向我解释我做错了什么吗？

我在 HTML 中使用 Razor 在网页上呈现数据：

```
@foreach(var row in db.Query(getKamers))
     {            
        <form id="@row.id" action='_DataConn.php' method='post' class='ajaxform'>                    
            <input type="text" value="@row.id" name="id" id="td-id" />
            <input type="text" value="@row.oppervlakte" name="oppervlakte" id="td-opp" />
            <input type="text" value="@row.locatie" name="locatie" id="td-loc" />
            <input type="text" value="@row.type" name="type" id="td-type" />
            <input type="text" value="@row.kamernr" name="nummer" id="td-kamernr" />
            <input type="text" value="@row.vrij" name="vrij" id="td-vrij" />
            <input type="submit" value="opslaan" name="opslaan" id="@row.id" />                
        </form>              
     } 
```

然后我有这个 JavaScript 文件：

```
$(document).ready(function () {
$('.ajaxform').submit(function () {
    $.ajax({
        url: $(this).attr('action'),
        type: $(this).attr('method'),
        dataType: 'json',
        data: $(this).serialize(),
        success: function (data) {
            console.log(data);
        }
    });

    return false;
}); 
```

});

我的 PHP 看起来像这样：

```
<?php
$dbhost = "localhost";
$dbuser = "root";
$dbpass = "root";
$dbname = "Studentenkamers";
//Connect to MySQL Server
mysql_connect($dbhost, $dbuser, $dbpass);
//Select Database
mysql_select_db($dbname) or die(mysql_error());
// Retrieve data from Query String

$id = $_POST['id'];
$oppervlakte = $_POST['oppervlakte'];
$locatie = $_POST['locatie'];
$kamernr = $_POST['nummer'];
$type = $_POST['type'];
$vrij = $_POST['vrij'];
echo 'ok'
// Escape User Input to help prevent SQL Injection

$id = mysql_real_escape_string($id);
$oppervlakte = mysql_real_escape_string($oppervlakte);
$locatie = mysql_real_escape_string($locatie);
$kamernr = mysql_real_escape_string($kamernr);
$type = mysql_real_escape_string($type);
$vrij = mysql_real_escape_string($vrij);
//build query
//"UPDATE Studentkamer SET oppervlakte='" + room[1] + "', locatie='" + room[2] + "', type='" + room[3] + "', vrij='" + room[4] + "' WHERE id='" + room[0] + "'";
$query = "UPDATE Studentkamer SET oppervlakte = '$id', locatie = '$locatie', type='$type', kamernr   = '$kamernr', vrij = '$vrij' WHERE id='$id'";

//Execute query
 $qry_result = mysql_query($query) or die(mysql_error());
 ?> 
```

编辑：

下面是错误信息截图的链接，它与静态上下文有关吗？ [http://img41.imageshack.us/img41/9139/errorde.jpg](http://img41.imageshack.us/img41/9139/errorde.jpg)

我正在使用 localhost 在 Webmatrix 中工作，我是否需要将此网站放到网上才能正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:36:13.490

查看提交按钮和表单 ID。剃须刀是否将其转换为有效字符串？在我看来，id 好像包含`@`. 根据[http://www.w3.org/TR/html4/types.html](http://www.w3.org/TR/html4/types.html)`@`， id 值是不允许的。这可能作为包含这些字符的值传递

```
 ID and NAME tokens must begin with a letter ([A-Za-z]) and may be followed by any number
 of letters, digits ([0-9]), hyphens ("-"), underscores ("_"), colons (":"), and periods ("."). 
```

尝试

`@(row.id)`

参考 - [MVC3 Razor 语法。如何将此 ASP.NET 样式转换为 Razor。（引号内的@也有问题）](https://stackoverflow.com/questions/4276093/mvc3-razor-syntax-how-do-i-convert-this-asp-net-style-to-razor-also-issues-wi?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:34:56.863

您必须在您的网络服务器的配置中允许 POST 方法

# javascript - 从文本中删除文本和数字

> ID：12424986
> 
> 赞同：1
> 
> 时间：2012-09-14T12:53:04.087
> 
> 标签：javascript, string, replace

我有很多文字：

```
var one = 'this_is_first_text#test=4';
var two = 'second_text#test=2';
var three = 'next_text#test=243';
var four = 'last_text_for_this#test=44'; 
```

我如何删除这个**#test=X**？

我只能删除文本：

```
one.replace('#test=', ''); 
```

但热删除号码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:54:48.657

```
one = one.slice(0, one.indexOf('#')); 
```

[http://jsfiddle.net/U3PU2/](http://jsfiddle.net/U3PU2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T13:06:18.473

```
 one = one.split("#"); one=one[0]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T12:57:08.007

[`replace()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)可以将正则表达式作为参数。因此，您可以使用以下内容：

```
one.replace(/#test=\d+/, '') 
```

`\d+`将匹配一个或多个数字。

**[演示](http://jsfiddle.net/srUTw/)**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T12:57:23.140

使用正则表达式？

```
one.replace(/\#test\=.*/,''); 
```

# image - CakePHP 如何将图像存储在数据库中并显示？

> ID：12424991
> 
> 赞同：2
> 
> 时间：2012-09-14T12:53:14.277
> 
> 标签：image, cakephp, view

我不知道如何在数据库中存储图像并显示它？

我想要做的是将图像路径存储在数据库中并将图像存储在 /img/ 文件夹中，然后将其显示给用户。

在我的注册表单中，我要求用户上传这样的图像

```
<?php echo $this->Form->input('image', array('class'=>'forminput', 'label' => 'Upload Image:', 'type' => 'file'));  ?> 
```

在数据库中，图像字段的类型是 longblob。

像这样向用户显示它......

```
<?php echo $this->html->image('Auth.User.image');?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T12:57:10.237

您将图像存储在服务器上，在数据库中您只保存图像的名称。

通常图像存储在**webroot的****img**文件夹中。当您显示图像时，您将拥有如下内容：

 **```
<?php echo $this->Html->image('img' . DS . CakeSession::read('Auth.User.image')); ?> 
```

*   其中**image**是您要上传的图像的名称，该名称保存到用户表中的图像字段中。

在控制器内部，您应该像在 PHP 中通常那样上传文件。

```
$file_name = $_POST['User']['name'];
$tmp_file = $_POST['User']['tmp_name'];
if(is_uploaded_file($tmp_file)){ 
    if(move_uploaded_file($tmp_file){
        ... 
        $this->data['User']['image'] = $file_name; 
        $this->User->save($this->data);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-21T12:11:03.730

```
paste it in your controller and change the field and model names accroding to 
```

公共功能添加（）{

```
 $this->set('status_tbl', $this->Player->Status->find('list'));

        if ($this->request->is('post')) {
             $this->Player->create();
             if(!empty($this->request->data)){

                if(!empty($this->request->data['Player']['image']['name'])){

                $file = $this->request->data['Player']['image']; 

                $ext = substr(strtolower(strrchr($file['name'], '.')), 1); 

                $arr_ext = array('jpg', 'jpeg', 'gif'); 

        if(in_array($ext, $arr_ext)){
        $this->request->data['Player']['image'] = $file['name'];
        move_uploaded_file($file['tmp_name'],'uploads/file'.$file['name']);

        $this->Player->save($this->request->data);
        }

                }

        if($this->Player->save($this->request->data)){
        return $this->redirect(array('controller'=>'Players',"action"=>'index'));

                }
            }

        }

} 
```**

# javascript - 全日历单元格大小

> ID：12424992
> 
> 赞同：5
> 
> 时间：2012-09-14T12:53:15.367
> 
> 标签：javascript, jquery, css, fullcalendar

我正在使用 jQuery FullCalendar (http://arshaw.com/fullcalendar/docs/)。

在月视图中，我将所有事件的大小设置为与标题无关。

现在，无论特定日期有多少事件，我都希望所有单元格的大小相同。如果有更多的事件超出了单元格的容纳范围，我只想显示那些可以容纳在单元格中的事件，并在单元格的底部添加类似：“2 more ...”的内容。

为此，我需要知道 FullCalendar 如何根据单元格中显示的事件数量确定单元格的大小，以及在通过拖放添加新事件时它如何调整单元格的大小。我在 html 代码中看到事件实际上并没有放在单元格表中，但通过使用绝对定位，它们似乎在单元格中，所以我猜一些 javascript 也用于计算单元格的大小。

也许我应该提一下，我没有放日历的大小，我需要它使用其容器的默认 100% 宽度。

# c# - 关于 SyncRoot 模式的一些说明：使用此模式的正确方法是什么？

> ID：12424993
> 
> 赞同：8
> 
> 时间：2012-09-14T12:53:15.920
> 
> 标签：c#, .net, multithreading, thread-safety

作为一般规则，我阅读了一些关于*SyncRoot 模式的内容，以避免死锁。*阅读几年前的一个问题（请参阅此[链接](https://stackoverflow.com/questions/728896/whats-the-use-of-the-syncroot-pattern)），我想我理解这种模式的某些用途可能是不正确的。特别是，我专注于[该主题](http://blogs.msdn.com/b/brada/archive/2003/09/28/50391.aspx)的以下句子：

> *您会注意到 System.Collections 中许多集合上的 SyncRoot 属性。回想起来，我认为这个属性是一个错误......请放心，我们不会犯同样的错误，因为我们构建了这些集合的通用版本。*

实际上，例如，`List<T>`类没有实现`SyncRoot`属性，或者更准确地说，它是显式实现的（请参阅[此答案](https://stackoverflow.com/a/4067371)），因此您必须转换`ICollection`为才能使用它。但是[此评论](https://stackoverflow.com/questions/728896/whats-the-use-of-the-syncroot-pattern#comment13873399_728934)认为，`SyncRoot`公开私有字段与锁定`this`（请参阅[此答案）一样糟糕的做法，正](https://stackoverflow.com/questions/251391/why-is-lockthis-bad)[如此评论](https://stackoverflow.com/questions/3910628/any-downsides-to-locking-a-collection-vs-a-syncroot#comment4168873_3910716)中所证实的那样。

所以，如果我理解正确，当我实现一个非线程安全的数据结构时，因为它可以在多线程上下文中使用，我不应该（实际上，我绝不能）提供该`SyncRoot`属性。但我应该让开发人员（将使用此数据结构）负责将其与私有 SyncRoot 对象相关联，如以下示例代码所示。

```
public class A
{
    private MyNonThreadSafeDataStructure list;
    private readonly object list_SyncRoot = new object;

    public Method1()
    {
        lock(list_SyncRoot)
        {
            // access to "list" private field
        }
    }

    public Method2()
    {
        lock(list_SyncRoot)
        {
            // access to "list" private field
        }
    }
} 
```

总之，我理解同步/锁定的最佳实践应该如下：

1.  任何私有 SyncRoot 对象都不应通过公共属性公开；换句话说，自定义数据结构不应提供公共`SyncRoot`属性（另请参阅[此评论](https://stackoverflow.com/questions/6525118/why-lock-on-collection-syncroot-instead-of-just-lock-the-collection#comment7682030_6525218)）。
2.  通常，不强制使用私有对象进行锁定（请参阅[此答案](https://stackoverflow.com/a/3910655/364056)）。
3.  如果一个类有多个需要同步的操作集，但不能相互同步，则它应该有多个私有 SyncRoot 对象（请参阅[此注释](https://stackoverflow.com/questions/3910628/any-downsides-to-locking-a-collection-vs-a-syncroot#comment4172092_3910656)）。

上面写的是这个模式的正确使用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T13:52:49.987

我会避免向`SyncRoot`我设计的类型添加属性，原因如下：

*   我这种类型的用户可能需要使用不同的同步机制，例如[`Mutex`](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)，or [`ReaderWriterLock`](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlock.aspx)or [`ReaderWriterLockSlim`](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)etc

*   类型变得更胖：它的职责变得更加分散。为什么我要添加对显式多线程锁定的支持而不支持其他绒毛？我会强迫用户只遵循一种做法，这可能不是所有情况下的最佳解决方案

*   我需要正确实现该属性（不返回`this`or `typeof(MyClass)`），即这是错误的：

    ```
    public object SyncRoot {get {return this;}} 
    ```

我也会避免使用`SyncRoot`.NET 框架类型的属性。如果我需要创建一个没有`SyncRoot`属性线程安全的类型，我将使用一个锁定模式，如果一个类型具有此属性，我仍然不会选择锁定 on `SyncRoot`。这使我的代码风格一致且更易于阅读/维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:33:31.747

这里有很多概念。首先，您正确实现的是一个线程安全的类，该类的消费者不需要自己进行同步。因此，您绝对不需要公开 syncRoot 对象。在旧的 Collection 类中，SyncRoot 属性被公开，因为这些类*不是*线程安全的。

锁定任意对象并锁定您的内部集合在程序的正确性或性能方面绝对没有区别。只要对两者的引用没有改变，它们就可以像 Monitor.Enter/Exit 的参数一样工作。你的内在收藏会改变吗？如果不是，也将其标记为只读。

第三，有关于基于不同操作使用不同锁的评论。典型的例子是 ReaderWriterLock。您应该根据您的类公开的不同功能分析使用不同级别的锁的需求。

# c# - EF4.1 Code First DbContext：操作无法完成，因为DbContext已被释放

> ID：12424997
> 
> 赞同：2
> 
> 时间：2012-09-14T12:53:25.427
> 
> 标签：c#, asp.net-mvc, entity-framework-4.1, unity-container, dbcontext

我有一个直接调用的控制器操作，但会引发此错误：

```
The operation cannot be completed because the DbContext has been disposed. 
```

我只在网上找到了关于延迟执行的解决方案，但我认为这不适用于这里，因为我在任何地方使用上下文（在这种情况下）我都会调用`.ToList()`or 或`.FirstOrDefault()`. 这是我的代码：

**控制器内容**

```
 private IUnitOfWork UnitOfWork;
    public MyFavouritesController(
        IAccountServices accountServices,
        IUnitOfWork unitOfWork
        )
    {
        AccountServices = accountServices;
        UnitOfWork = unitOfWork;
    }

    public ActionResult Index()
    {
        int? id = AccountServices.GetCurrentUserId();
        if (!id.HasValue)
        {
            return RedirectToAction("Login", "Account", new { ReturnUrl = this.HttpContext.Request.Url.AbsolutePath });
        }
        var user = UnitOfWork.UserRepo.Get(id.Value, "Favourites", "Favourites.County", "Favourites.Country");
        //THE ABOVE CALL GETS THE ERROR

        //.....
        return View();
    } 
```

**存储库基类**

```
public class RepositoryBase<C, T> : IDisposable
    where C:DbContext, new()
    where T : ModelBase
{
    private DbContext _context;
    public DbContext Context
    {
        get
        {
            if (_context == null)
            {
                _context = new C();
                this.AllowSerialization = true;
            }
            return _context;
        }
        set
        {
            _context = value;
        }
    }

    public virtual T Get(int Id, params string[] includes)
    {
        if (Id > 0)
        {
            var result = Context.Set<T>().Where(t => t.Id == Id);
            foreach (string includePath in includes)
            {
                result = result.Include(includePath);
            }
            return result.FirstOrDefault(); //This is where the error occurs.
        }
        else
        {
            throw new ApplicationException("Id is zero (0).");
        }
    }

    //... (More CRUD methods)

    public void Dispose()
    {
        if (Context != null)
        {
            Context.Dispose(); //Debugger never hits this before the error
        }
    }
} 
```

**工作单位**

```
public class UnitOfWork:IUnitOfWork
{
    public UnitOfWork(
        //... DI of all repos
        IUserRepository userRepo
        )
    {
        //... save repos to an local property
        UserRepo = userRepo;

        //create a new instance of the context so that all the repo's have access to the same DbContext
        Context = new Context();

        //assign the new context to all the repo's
        //...
        UserRepo.Context = Context;
    }

    public Context Context { get; set; }

    public IUserRepository UserRepo { get; set; }

    //... (some more repositories)

    public void Dispose()
    {
        Context.Dispose(); //THIS IS NOT HIT AT ALL
    }
} 
```

**最后，模型容器有这条线**

```
_Instance.RegisterType<IUnitOfWork, UnitOfWork>(new PerThreadLifetimeManager()); 
```

如您所见，索引操作将接收一个新的 UnitOfWork 实例，其中包含一个新的 DbContext 对象。但是在第一次调用这个上下文时，它会抛出上述错误。这种模式适用于我的代码中的其他任何地方。

谢谢

**更新**

下面的答案是使用 perRequestLifetimeManager。以下是合一的含义：

```
 public class HttpRequestLifetimeManager : LifetimeManager
    {
        private string _key = Guid.NewGuid().ToString();

        public override object GetValue()
        {
            if (HttpContext.Current != null && HttpContext.Current.Items.Contains(_key))
                return HttpContext.Current.Items[_key];
            else
                return null;
        }

        public override void RemoveValue()
        {
            if (HttpContext.Current != null)
                HttpContext.Current.Items.Remove(_key);
        }

        public override void SetValue(object newValue)
        {
            if (HttpContext.Current != null)
                HttpContext.Current.Items[_key] = newValue;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T06:31:46.857

我注意到您正在使用 a`PerThreadLifetimeManager`来控制工作单元类的创建和处置。`PerRequestLifetimeManager`如果您的 IoC 容器支持，您可能应该将其更改为类似的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T12:57:01.220

这是因为您正在处理工作单元，在您请求数据之后，在查询后将数据存储在变量中，然后您也可以释放工作单元实例。