# StackOverflow 问答 000713000-000713999

# haskell - 为什么这个类型变量不明确？

> ID：713003
> 
> 赞同：6
> 
> 时间：2009-04-03T08:16:56.963
> 
> 标签：haskell, type-inference, typeclass

卷心菜.hs：

```
module Cabbage where 
class Cabbage a
  where foo :: a -> String      -- the parameter is only present for its type,
                                -- the parameter value will be ignored
        bar :: String -> a
quux :: Cabbage a => String -> a
quux s = bar (s ++ foo (undefined :: a)) 
```

当我编译（使用 ghc）时，我收到以下错误消息：

```
Cabbage.hs:7:19:
    Ambiguous type variable `a' in the constraint:
      `Cabbage a' arising from a use of `foo' at Cabbage.hs:7:19-38
    Probable fix: add a type signature that fixes these type variable(s) 
```

我不明白为什么`a`模棱两可。第 7 行中的第 6 行肯定与第 6`a`行中的相同`a`吗？我该如何解决？

或者，是否有更好的方法来声明每个实例的常量？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-03T10:51:33.647

使用作用域类型变量，您可以让 GHC 知道`undefined :: a`应该是相同的（否则`a`只是 的简写`forall a. a`）。然后，作用域类型变量必须明确地为所有限定的：

```
{-# LANGUAGE ScopedTypeVariables #-}
module Cabbage where 
class Cabbage a
  where foo :: a -> String      -- the parameter is only present for its type,
                                -- the parameter value will be ignored
        bar :: String -> a
quux :: forall a. Cabbage a => String -> a
quux s = bar (s ++ foo (undefined :: a)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T10:25:16.437

问题是 Haskell 不知道哪个实例`Cabbage`对应`foo`于那里。据我所知，它与`a`in不匹配`(undefined :: a)``a``quux :: Cabbage a => String -> a`

假设这是你想要的，你可以这样做：

```
quux :: Cabbage a => String -> a
quux s = result
    where result = bar (s ++ foo result) 
```

这将 foo 和 bar 联系在一起，因此它对两者使用相同的实例，并且由于您实际上不需要 foo 的输入值，因此它会触底。不过，我不知道做每个实例常量的更好方法。希望其他人会来。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-04T01:43:08.103

您可以将多态部分提取为函数

```
quux :: Cabbage a => String -> a
quux s = quux' undefined
    where quux' :: Cabbage a => a -> a
          quux' x = bar (s ++ foo x) 
```

# c# - 如何扩展 .Net 中的内置配置提供程序以添加自定义存储？

> ID：713005
> 
> 赞同：2
> 
> 时间：2009-04-03T08:18:37.553
> 
> 标签：c#, .net-3.5, configuration

我们有一个配置 XML 数据库。我不想通过数据库 API 直接访问它，而是想扩展 .Net 的配置类以添加自定义存储提供程序。

我不知道从哪里开始。我已经看到了配置应用程序块，但这似乎已被弃用。我正在使用.Net 3.5。

我应该看哪些课程？我需要实现哪些接口？这在其他地方做过吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T09:35:22.830

您可以将任意文件加载到配置系统中，但您需要使用 ConfigurationManager.OpenMappedExeConfiguration 传递包含您的文件的 ExeConfigurationFileMap。

但该文件需要采用 .config 格式，`<configuration>`用作根元素，并`<configSections>`定义自定义部分。一旦这到位子类化`ConfigurationElement`等。允许高度的结构灵活性或仅自己解析元素（覆盖`ConfigurationElement.DeserializeElement`）。

或者，使用一些抽象。在普通 .configuration 中有一个自定义元素，带有一个配置节处理程序，用于加载在主 .config 中指定的文件。

# asp.net - Asp.Net Validaterequest 错误

> ID：713007
> 
> 赞同：3
> 
> 时间：2009-04-03T08:18:56.803
> 
> 标签：asp.net, validation

我正在创建一个 Asp.Net 程序 UI，用户可以在其中浏览和更改数据库中的信息。出于这个原因，他们需要能够使用所有形式的字符，但我仍然需要保持程序 HTML 和 SQL 本身的安全。出于这个原因，我使用了一种自建方法，当它们在文本框之外处理时，用它们的 html 代码替换危险的字符，如 '<' 等（在页面加载时发布，因此它们在那里）。

现在我的困境：为了能够做到这一点，我必须根据主题禁用 Validaterequest 参数，程序将发出投诉。将其设置为 False 的可能后果是什么？

SQL 查询已经参数化，我只过滤掉以下标记：

```
& # < > " ’ % @ = 
```

问题：即使我处理了上面的字符，我是否会让程序对威胁开放？基本上这是一个内部网应用程序，只有少数人能够访问该程序。然而，它访问的信息相当重要，因此即使是无意的事故也应该被防止。我真的不知道 Validaterequest 事情甚至做了什么。

**编辑：**好的，谢谢答案。我会按照最初的计划去做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T08:27:27.423

[Validate Request](http://www.asp.net/learn/whitepapers/request-validation/)寻找的主要内容是 < 和 > 字符，以阻止您向向您的网站发布脚本和/或 HTML 的恶意用户打开您的网站。

如果您对去除 HTML 标记的代码感到满意，或者您没有在未处理的情况下将保存的数据显示回网站，那么您应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T08:33:55.037

基本上通过替换特殊字符来验证用户输入通常会导致更多麻烦并且并不能真正解决问题。这完全取决于用户输入的内容，有时他们需要特殊字符，例如

```
& # < > " ’ % @ = 
```

想想精明的用户仍然可以使用 xp_ 命令甚至使用 CONVERT() 函数来进行 ASCII/二进制自动攻击。只要您将所有输入参数化，就可以了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T09:22:56.370

我认为问题不仅在于 SQL 注入攻击，还在于跨站点脚本和 JS 执行攻击。为防止这种情况，您不能仅依赖参数化查询，您应该对用户发送的 html 进行“清理”！也许像 html tidy 这样的工具可以提供帮助。

# html - 静态 html 网站的浏览器 cookie 有什么作用吗？

> ID：713009
> 
> 赞同：5
> 
> 时间：2009-04-03T08:19:55.880
> 
> 标签：html, web, cookies

如果是，那么我们可以用 cookie 做什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T08:22:51.897

你说的是静态html，是不是用javascript的意思？

如果是这样，您可以使用 javascript cookie 来记住诸如菜单是否展开、用户上次访问该站点的时间等。

如果您只是指纯 html 本身，那么不，cookie 对您没有任何好处，您也无法编写或访问它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T08:24:33.170

您可以将 cookie 与客户端脚本一起使用。查看**document.cookie**属性。它包含所有可通过脚本访问的 cookie（即所有未标有 HttpOnly 标志的 cookie）。事实上，你必须解析这个字符串来分隔 cookie，但这一点也不难。

请参阅[这篇文章](http://www.quirksmode.org/js/cookies.html)，了解如何在客户端使用 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:22:33.520

您可以根据当前用户之前是否去过网站来显示网站的不同元素。

这可以用javascript来完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T08:23:16.717

HTML 是一种标记语言，因此它无法读取 cookie。但是如果您在 html 中使用 javascript，您可以创建和读取 cookie 并做任何您想做的事情。

# pdf - PS/PDF 如何存储和压缩位图？

> ID：713014
> 
> 赞同：1
> 
> 时间：2009-04-03T08:21:41.337
> 
> 标签：pdf, pdf-generation, postscript

我正在试验一个系统来扫描字母并将扫描的位图转换为 PDF，目标是获得高分辨率和较小的 PDF 文件大小。

我正在使用扫描仪、用于位图操作的 GIMP 和用于位图到 PDF 转换的 ImageMagick 进行原型设计。

我的过程如下所示：

*   以 3x8 位颜色、600 DPI、LZW 压缩的真彩色 TIFF 文件大小进行扫描，大小约为 8 Mb。

*   使用 GIMP 将位图转换为具有 4 到 8 种颜色的典型颜色表的索引图像。这使得图像可更好地压缩。

*   使用 ImageMagick 转换 LZW 压缩的索引 TIFF 文件 PDF，每页大约 500K。

现在为了使图像更好地压缩，我可以使位图对压缩更友好。在这里进行实验之前，我想知道 PS/PDF 是如何存储位图的。

PS/PDF 中的位图是运行长度编码的吗？然后我会通过从位图行中删除单个像素来获得压缩。

您有进一步优化的想法吗？

您知道 PS/PDF 中对位图存储格式的引用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T08:48:00.650

PDF 支持多种类型的图像压缩，请参阅：[http ://en.wikipedia.org/wiki/Pdf#Raster_images](http://en.wikipedia.org/wiki/Pdf#Raster_images)

我认为您可以指定与 imagemagick -compress 选项一起使用的选项：[http ://www.imagemagick.org/script/command-line-options.php#compress](http://www.imagemagick.org/script/command-line-options.php#compress)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-11T05:13:57.963

一些公司（Luratech 和 CamiNova 是我所知道的唯一一家）在 PDF 中制作“混合光栅内容”模型。这些文件可以在标准的 Adob​​e Reader 中查看，但非常非常小——与 DjVu 相当。

“混合光栅内容”意味着他们将图像分割成高分辨率黑白蒙版（硬边缘、线条、字母）和低分辨率平滑色调图像（背景图片）。使用双色调压缩算法（可能是 JBIG2）存储蒙版，使用 JP2K（可能）压缩平滑色调图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:48:22.707

对于位图，IIRC，PDF 使用 deflate。但PDF也可以用更具体的图像压缩算法存储图像，如JPEG（有损）、CCITT（无损）、JBIG2（有损和无损）和JPX（JPEG2000的有损和无损）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T09:01:46.013

[Adobe 的 PDF 参考](http://www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf)可能是一个不错的起点。从非常粗略的看，看起来图像是未压缩存储的，但感觉根本不对。它还可以链接到外部图像，例如 JPEG。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T11:01:52.820

压缩方法通常由创建 PDF 的工具选择，您可能对其控制有限。

如果您有 Acrobat 9.0，则有一个非常好的“隐藏”功能，它允许您查看 PDF 中的对象树（您对资源下的 XObjects 感兴趣）。[在http://pdf.jpedal.org/java-pdf-blog/bid/10479/Viewing-PDF-objects](http://pdf.jpedal.org/java-pdf-blog/bid/10479/Viewing-PDF-objects)上有一个关于使用它的简短博客

# jquery - 分组表排序

> ID：713020
> 
> 赞同：1
> 
> 时间：2009-04-03T08:23:18.417
> 
> 标签：jquery, sorting, tablesorter

我首先有带有文件夹的表格，然后是文档。我想排序以便排序适用于文件夹和文档，但希望先保留排序的文件夹，然后再排序文档。jQuery表格排序器可以吗？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T08:50:12.813

阅读[tablesorter 文档](http://tablesorter.com/docs/)。您可以通过单击一列、按住 shift 并单击其他列来手动排序。或者您可以通过设置配置选项在默认排序中编码 - 文档中按第一列和第二列升序排序的示例是：

```
$(document).ready(function() 
    { 
        $("#myTable").tablesorter( {sortList: [[0,0], [1,0]]} ); 
    } 
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T10:51:26.513

非常感谢您的回复。我选择了 jquery.tablesorter.js 中的 sortForce: [[0,0]] 选项。添加了一个作为文件夹和文档的第一列。对于文件夹和文档..

这解决了我的问题。

再次感谢 Dushyant Joshi

# iphone - 无法更新 UITableView

> ID：713021
> 
> 赞同：6
> 
> 时间：2009-04-03T08:23:46.497
> 
> 标签：iphone, objective-c

我有 UITableViewController 作为 RootViewController。我需要根据从 RootViewController 线程启动的另一个线程获得的数据向表中添加行。当我从其他线程返回到我的 RootViewController 的线程时，我有更新的数据，但我无法更新 TableView。我调用了该`[self.tableview reloadData];`方法，但这似乎不起作用。我也试过`[self.tableview setNeedsDisplay]`打电话，但没有成功。如何使用新数据更新 TableView？

```
In my RootViewController Class I have:

- (void) reload {

for(int i=0;i<[camDetails count];i++)
 {
    cCameraInformation *obj = [[cCameraInformation alloc] init];
    obj = [camDetails objectAtIndex:i];
    NSString *tString = [[NSString alloc] initWithFormat: @"        Remote     %s     %s",[obj->sCameraid UTF8String],[obj->sCameraid UTF8String]];
    [tableEntry addObject:tString];
 }
 [self.tableView reloadData];
} 
```

然后是一个接收类线程，它不断地接收数据。它的基类是 NSObject。所以，我使用 Application 委托类（它有一个 RootViewController 类的实例）在我的接收线程中调用 RootViewController 类的这个重新加载数据方法。

我无法使用 performSelectorOnMainThread 调用上述方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T10:01:15.623

嘿，您确定要在主线程上更新表格视图显示/重新加载表格视图吗？我遇到了同样的问题，数据在那里，但直到用户滚动，tableview 没有更新

谷歌搜索后，我知道您需要在主 ui 线程上调用 reloadData 方法

下面的代码示例：

```
- (void) getDataOnNewThread
{
    // code here to populate your data source
    // call refreshTableViewOnMainThread like below:
    [self performSelectorOnMainThread:@selector(refreshTableView) withObject:nil waitUntilDone:NO];
}

- (void) refreshTableView
{
    [tableView reloadData];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T09:24:26.053

确保从 numberOfRowsForSection 返回的值正确。

还要确保您的 cellForRowAtIndexPath 方法正在使用此数据来获取单元格内容。

您的 reloadData 方法应该在主线程上调用，而不是在任何其他线程上。

如果您可以发布相关代码，将能够更好地帮助您。

# .net - IIS 6 with wildcard mapping and UNC virtual directory problem

> ID：713025
> 
> 赞同：2
> 
> 时间：2009-04-03T08:24:25.607
> 
> 标签：.net, asp.net, iis-6, virtual-directory, unc

On our production servers (win 2003 with IIS6 and load balanced with an F5 BIGIP), we have a problem when introducing wildcardmapping on IIS6\. We use .net Framework 3.5 SP1.

The issue manifests itself as by the server only sometimes serving the images stored on a virtual directory pointing to a UNC path. Sometimes the images are displayed, and sometimes not. Removing the wildcard mapping solved this problem.

I will need wildcard mapping on the server for future features, so any help/pointers to if this is a known problem will be very helpful.

In advance, thanks for any help.

Edit: The exception it fails with is the following:

> Message: Failed to start monitoring changes to '\ourFileServer\folder1\thumbnails' because the network BIOS command limit has been reached. For more information on this error, please refer to Microsoft knowledge base article 810886\. Hosting on a UNC share is not supported for the Windows XP Platform. Source: System.Web Data: System.Collections.ListDictionaryInternal TargetSizeVoid .ctor(System.Web.DirectoryMonitor, System.String, Boolean, UInt32) StackTrace at System.Web.DirMonCompletion..ctor(DirectoryMonitor dirMon, String dir, Boolean watchSubtree, UInt32 notifyFilter)
> at System.Web.DirectoryMonitor.StartMonitoring() at System.Web.DirectoryMonitor.StartMonitoringFile(String file, FileChangeEventHandler callback, String alias) at System.Web.FileChangesMonitor.StartMonitoringFile(String alias, FileChangeEventHandler callback) at System.Web.Configuration.WebConfigurationHost.StartMonitoringStreamForChanges(String streamName, StreamChangeCallback callback) at System.Configuration.BaseConfigurationRecord.MonitorStream(String configKey, String configSource, String streamname) at System.Configuration.BaseConfigurationRecord.InitConfigFromFile()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T11:48:52.593

It's been a while since I asked this question. We have now been able to diagnose the problem. In a nutshell, it seems that once you enable wildcard mapping on UNC shares, ASP.net adds file monitors for each subdirectory. In our case, it's a lot of subdirectories. See [http://weblogs.asp.net/hosterposter/archive/2006/10/30/Hosting-IIS-with-UNC-content-*2D00*-Network-BIOS-commands-and-other-errors.aspx](http://weblogs.asp.net/hosterposter/archive/2006/10/30/Hosting-IIS-with-UNC-content-_2D00_-Network-BIOS-commands-and-other-errors.aspx).

We will try and fix this by experimenting with different suggestions.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-27T10:39:11.117

We recently implemented wildcard mapping for our ASP.NET 1.1 application on a Windows 2003 server and it worked fine until we found that a situation similar to yours where a sub-directory (virtual directory) points to a UNC share generates the same error you have mentiojned.

Removing the wildcard mapping solves the problem but we need the wildcard mapping. So if you have found a solution to your problem, we'll be glad to know about it.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T21:25:20.060

Your problem may be that you have the option "Verify that file exists" turned on for your wildcard application map. If this setting is checked, try shutting it off and seeing if that resolves the problem.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-21T05:26:11.677

I made a very detailed answer to this problem here: [https://stackoverflow.com/a/20710473/705198](https://stackoverflow.com/a/20710473/705198)

That answer is an accumulation of all the technet, msdn, and blog reference material I could find on the subject, and what we ended up having to do to fix the problem.

# sql-server-2005 - 事务复制是否有可能获得低于 1 秒的延迟？

> ID：713032
> 
> 赞同：7
> 
> 时间：2009-04-03T08:27:41.073
> 
> 标签：sql-server-2005, performance, architecture, replication

我们的数据库架构由两台 Sql Server 2005 服务器组成，每台服务器都有一个相同数据库结构的实例：一台用于所有读取，一台用于所有写入。我们使用事务复制来保持读取数据库是最新的。

这两台服务器的规格确实非常高（写入服务器有 32GB 的 RAM），并且通过光纤网络连接。

在决定采用这种架构时，我们被认为将数据复制到读取服务器的延迟大约为几毫秒（显然取决于负载）。在实践中，即使在最简单的情况下，我们也会看到大约 2-5 秒的延迟，这并不令人满意。最简单的情况是，我的意思是更新写入数据库上单个表中单行中的单个值，并查看在读取数据库中观察新值需要多长时间。

我们应该考虑哪些因素来实现低于 1 秒的延迟？这甚至可以实现吗？

或者，我们应该考虑不同的复制模式吗？数据和日志文件位置的最佳做法是什么？

**编辑**

感谢大家的建议和见解——我相信我们所经历的潜伏期*是*正常的；我们的数据库托管公司误导了我们预期的延迟时间！

[我们正在使用这篇 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc500561.aspx)底部附近描述的技术（在“扩展数据库”标题下），我们未能正确处理此警告：

> 创建此类专用数据库的结果是延迟：现在将需要时间才能将写入分发到读取器数据库。但是，如果您可以处理延迟，那么扩展潜力是巨大的。

我们现在正在考虑对我们的缓存机制进行更改，当一项数据被认为是“易失性”时，它会强制从写入数据库中读取。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T07:50:25.193

不。即使使用快速硬件，SQL Server 事务复制也不太可能实现低于 1 秒的延迟时间。

如果你能得到 1 - 5 秒的延迟，那么你做得很好。

从[这里](http://msdn.microsoft.com/en-us/library/aa902656(SQL.80).aspx#sql2k_replperf_tran4_topic05n)：

> 使用事务复制，订阅服务器可能比发布服务器晚几秒钟。由于只有几秒钟的延迟，订阅服务器可以很容易地用作报告服务器，将昂贵的用户查询和报告从发布服务器转移到订阅服务器。
> 
> 在以下场景中（使用本节后面显示的 Customer 表），订阅者仅比发布者晚 4 秒。更令人印象深刻的是，60% 的时间延迟为两秒或更短。时间是从记录在发布服务器插入或更新到实际写入订阅数据库的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T08:38:03.170

我会说这绝对是可能的。

我会看：

*   您的网络
    在两台服务器之间运行 ping 命令并查看是否有任何问题
    如果服务器彼此相邻，您应该有 < 1 毫秒。
*   服务器上的瓶颈
    这可能是网络流量（容量）
    就像网卡没有配置为 1GB/秒
    防病毒或其他东西
*   对某些查询进行一些分析，看看您是否可以识别索引或锁定，这可能是一个问题
*   查看读取数据库上的任何选择是否可能阻止写入。
    添加 with (nolock)，看看这是否会对您正在分析的一两个查询产生影响。

本质上，您有一个复杂的系统，您遇到了问题，您需要确定哪个组件是问题并修复它。

如果您需要运行的报告/选择需要是最新的，则事务复制可能是最好的。如果他们不这样做，您可以查看日志传送，尽管这会在每次导入时增加一些停机时间。

对于数据/日志文件，请确保它们位于单独的驱动器上，以便最大限度地提高性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T07:44:12.073

关于事务复制要记住的一点是，单个更新现在需要执行多个操作才能使更改发生。

首先更新源表。接下来，日志阅读器会看到更改并将更改写入分发数据库。接下来，分发代理看到分发数据库中的新条目并读取该更改，然后在订阅服务器上运行正确的存储过程以更新该行。

如果您监视两台服务器上的语句运行时间，您可能会看到它们在几毫秒内运行。然而，等待日志阅读器和分发代理看到他们需要做一些会杀死你的事情是滞后时间。

如果您确实需要亚秒级处理时间，那么您将需要考虑编写自己的处理引擎来处理从一台服务器移动到另一台服务器的数据。我建议使用 SQL Service Broker 来处理这个问题，因为这样一切都是 SQL Server 原生的，不需要编写第三方代码。

# browser - 有没有什么好方法可以只使用网络浏览器将麦克风音频输入到服务器？

> ID：713033
> 
> 赞同：0
> 
> 时间：2009-04-03T08:27:44.613
> 
> 标签：browser, audio, cross-browser

我需要从只有浏览器（而不仅仅是 IE）的用户那里获取音频输入。有没有什么好的方法可以通过 brouser 将音频流传输到服务器。如果可以避免使用 Java、flash 等？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T08:33:02.137

你可以用闪光灯做到这一点。

看看[http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000297.html](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000297.html)

PS：单靠Html是做不到的。你需要一个插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T08:33:24.180

不，您需要某种插件。HTML 本身不支持麦克风输入。

-- 编辑正如我之前几秒钟回答的那样，您可以使用许多第三方插件，例如 flash 和 java。但是你不能避免不使用它们。

# c# - C#中的WinApp调用java程序

> ID：713036
> 
> 赞同：5
> 
> 时间：2009-04-03T08:32:22.933
> 
> 标签：c#, java

我有 ac#winapp，它通过 tcp 调用 java 应用程序，并通过 tcp 将所有内容发送回 c#。

我使用 java 的原因是因为我收到了一个 java api。因此，我编写了一个小型 Java 应用程序，它调用该 API 并获取我需要的所有数据。

所以我想知道是否有另一种解决方案。因为它运行缓慢，尤其是在有大量数据的情况下。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T08:35:30.993

本地机器上的 TCP 应该非常快（命名管道可能会快一点，但在两端可能更难做到）。

最大的瓶颈可能是数据的序列化和反序列化。您目前使用什么格式来表示数据？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T09:26:05.270

在我看来，您需要对此进行分析。您确定是网络方面速度慢吗？或序列化/反序列化，或数据传输之外的实际客户端/服务器处理。

在解决分析解决方案之前，您应该确定特定的问题点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T09:28:21.287

你收到了一个 java api，你写了一个小的 java api……所以你知道 java。为什么不也用 java 编写应用程序的其余部分呢？

有时更容易重写“不兼容”的部分，具体取决于它的工作量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T13:03:12.940

我建议尝试使用两个好的 Web 服务堆栈。听到你的结果会很有趣。这听起来违反直觉，但这些堆栈已经过优化，即使它们有转换为文本的负担。此外，将堆栈纳入其中并不需要太多工作。至少在 C# 中很容易并行化调用 Web 服务（如果这适合您的情况）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T20:48:21.463

还有一些商业解决方案允许从 .NET 调用 Java（反之亦然）。几年前我用过[JNBridge ，它](http://www.jnbridge.com/)**很棒**。

[您可以在http://www.jnbridge.com/bin/downloads.php?pr=1&id=0](http://www.jnbridge.com/bin/downloads.php?pr=1&id=0)下载 30 天免费试用版（不，我不为他们工作）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-06T09:31:14.267

我在java中做了一些分析，我收到的api方法占用了我注意到的大部分时间。如果我收到大约 1200 条记录，我有 5 分钟的等待时间。一旦我在 c# 中收到它，只需几秒钟即可将其添加到对象并显示结果视图。

所以我认为问题并不在我的最后，或者如果我使用 JNBridge 或 web 服务之类的东西会更好吗？

# c++ - “便携式” C 是否应该编译为 C++？

> ID：713042
> 
> 赞同：19
> 
> 时间：2009-04-03T08:35:07.670
> 
> 标签：c++, c, compatibility, portability

我收到了对我在 C 问题上发布[的答案](https://stackoverflow.com/questions/712926/safe-way-of-allocating-memory-for-a-list-node/712969#712969)的评论，其中评论者建议应该编写代码以使用 C++ 编译器进行编译，因为原始问题提到代码应该是“可移植的”。

这是对“便携式C”的常见解释吗？正如我在对该答案的进一步评论中所说的那样，这让我感到非常惊讶，我认为可移植性意味着完全不同的东西，并且认为编写也是合法 C++ 的 C 代码几乎没有什么好处。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-03T09:42:14.607

当前的 C++ (1998) 标准合并了 C (1989) 标准。抛开一些关于类型安全的细则，这意味着“好的”C89 应该在 C++ 编译器中编译得很好。

问题是当前的 C 标准是 1999 年 (C99) 的标准 - 它还*不是*C++ 标准 (AFAIK)(*) 的正式组成部分。这意味着 C99 的许多“更好”特性（long long int、stdint.h、...）虽然*受到*许多 C++ 编译器的支持，但*并不*严格兼容。

“可移植”C 完全意味着其他东西，与官方 ISO/ANSI 标准几乎没有关系。这意味着您的代码不会对主机环境做出假设。（int 的大小、字节序、非标准函数或 errno 数字，诸如此类。）

从我曾经为一个跨平台项目编写的编码风格指南中：

**跨平台 DNA（不要假设）**

*   没有本机数据类型。您可能使用的唯一数据类型是标准库中声明的数据类型。
*   char、short、int 和 long 的大小各不相同，就像 float、double 和 long double 一样。
*   int 不是 32 位。
*   char 既没有签名也没有无符号。
*   char 不能容纳数字，只能容纳字符。
*   将短类型转换为长类型（int -> long）会破坏 CPU 的对齐规则。
*   int 和 int* 的大小不同。
*   int* 和 long* 的大小不同（与指向任何其他数据类型的指针一样）。
*   你还记得本机数据类型甚至不存在吗？
*   'a' - 'A' 不会产生与 'z' - 'Z' 相同的结果。
*   'Z' - 'A' 不会产生与 'z' - 'a' 相同的结果，并且不等于 25。
*   除了测试它的值之外，你不能对 NULL 指针做任何事情；取消引用它会使系统崩溃。
*   涉及有符号和无符号类型的算术不起作用。
*   数据类型的对齐规则随机变化。
*   数据类型的内部布局随机变化。
*   上溢和下溢的具体行为随机变化。
*   函数调用 ABI 随机变化。
*   操作数以随机顺序进行评估。
*   只有编译器才能解决这种随机性。随机性将随着 CPU / OS / 编译器的下一个版本而改变。
*   对于指针，== 和 != 仅适用于指向完全相同数据类型的指针。
*   <, > 仅适用于指向同一数组的指针。它们仅适用于 char 显式声明的 unsigned。
*   你还记得原生数据类型不存在吗？
*   size_t（sizeof 的返回值的类型）不能转换为任何其他数据类型。
*   ptrdiff_t（从另一个指针中减去一个指针的返回值的类型）不能转换为任何其他数据类型。
*   wchar_t（“宽”字符的类型，其确切性质由实现定义）不能转换为任何其他数据类型。
*   任何 ..._t 数据类型都不能转换为任何其他数据类型

**(*)**：在撰写本文时确实如此。C++11 的情况发生了一些变化，但我的回答的要点是正确的。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-03T08:38:34.917

不，我的回应[为什么人为地将您的代码限制为 C？](https://stackoverflow.com/questions/649789/why-artificially-limit-your-code-to-c/650533#650533)有一些不编译为 C++ 的符合标准的 C99 示例；早期的 C 差异较小，但 C++ 具有更强的类型和对`(void)`函数参数列表的不同处理。

至于使C“可移植”到C++是否有好处-该答案中引用的特定项目是基于特征的语言的虚拟机，因此不适合C++对象模型，并且有很多案例您正在提取`void*`解释器的堆栈，然后转换为表示内置对象类型布局的结构。为了使代码“可移植”到 C++，它会添加很多类型转换，这对类型安全没有任何作用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-03T08:40:59.653

可移植性意味着编写您的代码，以便它使用不同的编译器和/或不同的平台进行编译并具有相同的行为（即尽可能依赖 ISO 标准规定的行为）。

让它使用不同语言的编译器进行编译是一件好事（也许），但我不认为这就是可移植性的意思。由于 C++ 和 C 现在越来越不同，这将更难实现。

另一方面，在编写 C 代码时，我仍然会避免使用“类”作为标识符。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T08:51:35.320

不，“可移植”并不意味着“在 C++ 编译器上编译”，它意味着“在任何符合标准的 C 编译器上编译”，具有一致的、已定义的行为。

并且不要仅仅为了保持 C++ 兼容性而剥夺自己对 C99 的改进。

但只要保持兼容性不束缚你的手，如果你能避免使用“类”和“虚拟”之类的，那就更好了。如果您正在编写开源代码，那么有人可能希望将您的代码移植到 C++；如果您正在招聘，您的公司/客户可能希望在未来的某个时候移植。嘿，也许你将来甚至想把它移植到 C++

做一个“好管家”，不在篝火旁乱扔垃圾，无论做什么都是善业。

请尽量避免不兼容的内容出现在您的标题中。即使您的代码从未被移植，人们也可能需要从 C++ 链接到它，因此拥有一个不使用任何 C++ 保留字的标头是很酷的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T08:43:37.493

这取决于。如果您正在做的事情可能对 C++ 用户有用，那么这可能是个好主意。如果您正在做一些 C++ 用户永远不需要但 C 用户可能会觉得方便的事情，请不要费心让它与 C++ 兼容。

如果您正在编写一个执行很多人所做的事情的程序，您可能会考虑使其尽可能广泛使用。如果您正在编写 Linux 内核的附加功能，您可以将 C++ 兼容性抛到脑后——它永远不会被需要。

尝试猜测谁可能会使用您的代码，如果您认为很多 C++ 粉丝可能会发现您的代码有用，请考虑使其对 C++ 友好。但是，如果您认为大多数 C++ 程序员不需要它（即它是 C++ 中已经相当标准化的功能），请不要打扰。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T09:05:35.460

为了进行更严格的类型检查，使用 C++ 编译器编译 C 代码绝对是常见的做法。尽管有像 lint 这样的特定于 C 的工具可以做到这一点，但使用 C++ 编译器会更方便。

使用 C++ 编译器编译 C 代码意味着您通常必须用 extern "C" 块包围您的包含，以告诉编译器不要破坏函数名称。然而，这不是合法的 C 语法。实际上，您正在使用 C++ 语法，而您的代码应该是 C，实际上是 C++。使用“C++ 便利”的趋势也开始像使用未命名的联合一样蔓延。

如果你需要严格保持你的代码 C，你需要小心。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-20T09:16:12.113

FWIW，一旦项目获得一定的规模和动力，它实际上可能从 C++ 兼容性中受益并非不可能：即使它不会直接移植到 C++，也确实有**许多**与工作/处理 C++ 源代码相关的现代工具代码。

从这个意义上说，缺乏与 C++ 的兼容性实际上可能意味着您可能必须想出自己的工具来做特定的事情。我完全理解在某些平台、环境和项目中支持 C 而不是 C++ 的原因，但从长远来看，C++ 兼容性通常会简化项目设计，最重要的是：**它提供了选项**。

此外，有许多 C 项目最终变得如此庞大，以至于它们实际上可能受益于 C++ 的功能，例如使用带有访问修饰符的类改进了对抽象和封装的支持。

以 linux（内核）或 gcc 项目为例，它们基本上都是“仅限 C”的，但两个开发人员社区仍然定期讨论切换到 C++ 的潜在收益。

事实上，目前正在进行 gcc 工作（*在*FSF 树中！）将 gcc 源代码移植到有效的 C++ 语法中（有关详细信息，请参阅：[gcc-in-cxx](http://gcc.gnu.org/wiki/gcc-in-cxx)），以便可以使用 C++ 编译器来编译源代码代码。

这基本上是由长期的 gcc 黑客发起的：Ian Lance Taylor。

最初，这只是为了提供更好的错误检查以及改进的兼容性（即一旦完成此步骤，这意味着您不一定必须有 C 编译器来编译 gcc，您也可以只使用一个 C++ 编译器，如果你碰巧“只是”一个 C++ 开发人员，这就是你得到的）。

但最终，这个分支旨在鼓励将 C++ 作为 gcc 的**实现语言**迁移，这是一个真正具有革命性的步骤 - 一种范式转变，这些 FSF 人员正在批判性地看待这种转变。

另一方面，很明显 gcc 已经受到其内部结构的严重限制，任何至少有助于改善这种情况的事情都应该受到称赞：开始为 gcc 项目做贡献是不必要的复杂和乏味的，主要是由于复杂的内部结构，已经开始使用宏和 gcc 特定扩展来模拟 C++ 中的许多更高级的功能。

为最终切换到 C++ 准备 gcc 代码库是最合乎逻辑的事情（不过，无论何时实际完成！），实际上需要它来保持竞争力、有趣和简单**相关**，这适用于特别是由于非常有前途的努力，例如 llvm，它们并没有带来所有这些麻烦和复杂性。

虽然用 C 编写非常复杂的软件通常是可能的，但这样做会变得不必要地复杂，许多项目在很久以前就已经完全超越了 C。这并不意味着 C 不再相关，恰恰相反。但是考虑到一定的代码库和复杂性，C 根本就不一定是完成这项工作的理想工具。

实际上，您甚至可以争辩说 C++ 不一定是某些项目的理想语言，但只要一种语言本身支持封装并提供实施这些抽象的方法，人们就可以绕过这些限制。

仅仅因为显然可以用非常低级的语言编写非常复杂的软件，并不意味着我们必须这样做，或者它首先确实有效。

我在这里谈论的是具有数十万行代码的复杂软件，其生命周期为几十年。在这种情况下，选择变得越来越重要。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-01-06T13:54:57.470

不，口味问题。我讨厌强制转换 void 指针，使代码混乱，没有太多好处。

```
char * p = (char *)malloc(100); 
```

对比

```
char * p = malloc(100); 
```

当我编写一个“面向对象”的 C 库模块时，我真的很喜欢使用“this”作为我的对象指针，因为它是一个 C++ 关键字，它不会在 C++ 中编译（这是故意的，因为这些模块在 C++ 中毫无意义鉴于它们确实存在于 stl 和库中）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-03T08:37:11.643

为什么你看不到什么好处？这很容易做到，谁知道您将来会如何使用该代码。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-03T09:04:46.053

不，可被 C++ 编译并不是对可移植性的常见解释。处理非常旧的代码，K&R 风格的声明是高度可移植的，但不能在 C++ 下编译。

正如已经指出的，您可能希望使用 C99 增强功能。但是，我建议您考虑所有目标用户并确保他们可以使用这些增强功能。不要只使用可变长度数组等，因为你有自由，但只有在真正合理的情况下。

是的，尽可能地保持 C++ 兼容性是一件好事——其他人可能有充分的理由需要将 C 代码编译为 C++。例如，如果他们想将它包含在 MFC 应用程序中，他们将不得不在单独的 DLL 或库中构建纯 C，而不仅仅是能够将您的代码包含在单个项目中。

还有一个论点是，在 C++ 模式下运行编译器可能会发现细微的错误，这取决于编译器，如果它应用了不同的优化。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-03T09:13:15.660

AFAIK 经典文本中的所有代码 C 编程语言第二版可以使用标准 C++ 编译器（如 GCC (g++)）进行编译。如果您的 C 代码符合该经典文本中遵循的标准，那么就足够了，并且您已准备好使用 C++ 编译器编译您的 C 代码。

以 linux 内核源代码的实例为例，它大部分是用 C 语言编写的，带有一些内联汇编代码，用 C++ 编译器编译 linux 内核代码是一场噩梦，因为“new”被用作变量名的最不可能的原因linux内核代码，其中C++不允许使用'new'作为变量名。我这里只举一个例子。请记住，Linux 内核是可移植的，在 intel、ppc、sparc 等架构中可以很好地编译和运行。这只是为了说明可移植性在软件世界中确实具有不同的含义。如果您想使用 C++ 编译器编译 C 代码，您正在将代码库从 C 迁移到 C++。我认为它是两种不同的编程语言，最明显的原因是 C 程序员不太喜欢 C++。但我喜欢他们两个& 我经常使用它们。您的 C 代码是可移植的，但您应该确保在将 C 代码迁移到 C++ 代码时遵循标准技术以使 C++ 代码具有可移植性。继续阅读以了解您从哪里获得标准技术。

您必须非常小心地将 C 代码移植到 C++ 代码中，我要问的下一个问题是，如果某些 C 代码可移植且运行良好且没有任何问题，您为什么还要费心去做呢？我不能接受可管理性，Linux 内核又是一个 C 语言的大代码源被很好地管理。

始终将两种编程语言 C 和 C++ 视为不同的编程语言，尽管 C++ 确实支持 C 并且其基本概念是始终支持这种出色的语言以实现向后兼容性。如果您不将这两种语言视为不同的工具，那么您将陷入流行、丑陋的 C/C++ 编程语言大战，并让自己变得肮脏。

选择可移植性时使用以下规则：

a) 您的代码（C 或 C++）是否需要在可能使用本机 C/C++ 编译器的不同架构上编译？b) 研究您希望运行程序并计划代码移植的不同架构上的 C/C++ 编译器。在这上面花点时间。c) 尽可能尝试在 C 代码和 C++ 代码之间提供一个干净的分离层。如果您的 C 代码是可移植的，您只需使用可移植 C++ 编码技术再次围绕该可移植 C 代码编写 C++ 包装器。

转向一些关于如何编写可移植 C++ 代码的优秀 C++ 书籍。我个人推荐 Bjarne Stroustrup 本人的 C++ 编程语言、Scott meyers 的 Effective C++ 系列以及 www.ddj.com 上的热门 DDJ 文章。

PS：我帖子中的Linux内核示例只是为了说明可移植性在软件编程中确实意味着不同的含义，并不批评Linux内核是用C而不是C++编写的。

# open-source - 对于那些想要归属的人来说，最好的开源许可证？

> ID：713045
> 
> 赞同：20
> 
> 时间：2009-04-03T08:35:51.990
> 
> 标签：open-source, licensing

我有~~拿到~~我对许多许可证感到担忧，我发现没有什么能阻止其他开发人员获取代码并声称它是他们的。我看过的一些包括 MIT 和 CPAL 许可证。在这方面，哪些许可证可以让您高枕无忧？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-03T08:46:24.523

[Apache 2.0 许可证](http://www.apache.org/licenses/LICENSE-2.0.html)怎么样：

> 您必须以您分发的任何衍生作品的源形式保留作品源形式的所有版权、专利、商标和归属通知，不包括那些与衍生作品的任何部分无关的通知；和

但我觉得你担心太多了。大多数 FOSS 代码的用户会很乐意保留归属，无论是否许可，你真的有财力去追求那些没有的人吗？

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-03T08:55:54.343

我建议所有软件都在[Poetic License](http://genaud.net/2005/10/poetic-license/)下获得许可：

> (c) <year> <name>
> 我们提供的这项工作“原样”。
> 没有明示或暗示的保证。
> 我们已尽最大努力
> 进行调试和测试。
> 拒绝承担损害赔偿责任。
> 
> 特此授予
> 复制、共享和修改的许可。
> 随意使用、
> 免费或盈利。
> 这些权利，在本通知中，依赖。

它本质上是作为打油诗的 MIT 许可证。但是，我不确定这是否正是您想要的。作为一个玩笑的答案，我在社区 wiki 上编辑了它，这样人们就不会认为我在卖淫。

但就我个人而言，我会在尽可能多的软件上使用 Poetic 许可证，因为我可以为自己辩护。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-03T09:29:21.720

[BSD 许可证](http://en.wikipedia.org/wiki/BSD_licenses)中有一个归属条款：

> 二进制形式的再分发必须在随分发提供的文档和/或其他材料中复制上述版权声明、此条件列表和以下免责声明。

我喜欢 BSD 许可证，因为它简短、直接且易于理解。

我会将它与Neil[建议的](https://stackoverflow.com/questions/713045/best-open-source-license-for-those-wanting-attribution/713076#713076)[Apache 2.0 许可证](http://www.apache.org/licenses/LICENSE-2.0.html)进行比较，看看哪一个更能满足您的需求。

# c# - 在 ASP.NET 的 64 位 Windows 平台上将 Excel 文件导入 SQL Server 的最佳方法是什么？

> ID：713046
> 
> 赞同：0
> 
> 时间：2009-04-03T08:36:30.740
> 
> 标签：c#, asp.net, sql-server, excel, 64-bit

在 64 位 Windows 系统上将 Excel 文件导入 SQL Server 的最佳/最流畅的解决方案是什么？

我特别关注的是从 ASP.NET/C# 页面将 Excel 97-2003 文件导入 SQL 2005 数据库。导入数据会要求用户使用“模板”，因此每次数据看起来都一样。

以前系统使用 Microsoft Jet OleDb 4.0 进行这种导入，但现在已转移到 64 位环境。如果 IIS 在 32 位模式下运行，我知道 Jet 可以在 64 位上运行，但我认为这不是一个选项。

那么，这里的 64 位替代方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T10:08:34.560

您应该使用集成服务。创建一个加载 Excel 文件的集成服务包（相对容易做的事情；您甚至可以使用[导入和导出向导](http://msdn.microsoft.com/en-us/library/ms141209.aspx)），然后[从 asp.net 调用该包](http://blogs.msdn.com/michen/archive/2007/03/22/running-ssis-package-programmatically.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T08:44:00.723

您可以上传文件并将其保存在特定文件夹中，然后让 Windows 服务或其他在 32 位和后台运行的进程。此后台进程监视上传文件夹并将新的 Excel 文件导入 SQL Server。

缺点是您无法直接回复用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:45:27.833

我会通过将 excel 文件读入 DataTable 对象然后使用 SqlBulkCopy 来存储信息来做到这一点。这将是快速且相对简单的编码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T17:44:35.120

将 Excel 读入 ADO.NET 数据表的另一种方法：

[http://www.aspspider.com/resources/Resource510.aspx](http://www.aspspider.com/resources/Resource510.aspx)

虽然我也建议只使用 SSIS 包来完成这项工作。

# iphone - NSDictionary 或 NSObject 以 NSStrings 作为属性，哪个更好？

> ID：713053
> 
> 赞同：2
> 
> 时间：2009-04-03T08:38:58.487
> 
> 标签：iphone, objective-c, sdk

如果代码是为 iPhone 应用程序编写的，就更快的性能和有效的内存管理而言，使用和 as 属性之间`NSDictionary`哪种方法更好？`NSObject``NSStrings`

例如，如果应用程序处理解析 XML 文件，如下所示：

```
< ?xml version="1.0" encoding="utf-8" ?>

<Sync status="1" syncdate="03/04/2009 11:25:34 AM">

< FirstName>AAA< / FirstName>

< MiddleName>BBB< / MiddleName>

< LastName>ZZZ< / LastName>

< Age>28< /Age>

< Gender>Male< /Gender>

< /Sync> 
```

那么，在存储解析值时，如果 XML 文件大小可以稍大一点，哪种方法更有效和更合适？与将相同的解析数据存储到变量中（即具有所有感兴趣节点的属性来存储`NSDictionary`各自的值。例如将存储“AAA”）的子类？我正在寻找更快的性能以及内存效率。`Key=FirstName` `Value=AAA``NSString``NSString``NSString *firstName``NSObject`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T08:37:23.613

> 在更快的性能和高效的内存管理方面

答案可能取决于您的应用程序 - 您将拥有多少这些对象，您将如何访问它们 - 它们是不是写的多于读的等等。

我会给你一些一般性的建议——先让它工作，然后在需要时优化速度和大小。在编写之前不要优化某些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-06T08:49:45.923

就性能而言，没有什么比实际执行测试更好的了。人们已经对 . [`NSArray`](http://ridiculousfish.com/blog/archives/2005/12/23/array/)，这似乎比预期的更复杂，只是为了性能优化而感到惊讶。

换句话说，如果在您的 XML 文件的未来版本中添加新属性，我会说它`NSDictionary`比 custom 更灵活。`NSObject`在 couterpart 中，我还要说`NSObject`具有明确命名属性的 custom 比`NSDictionary`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:47:25.050

不是一个真正的答案：您也可以使用`NSArray`键值编码，但我不知道与`NSObject`/相比的性能`NSDictionary`。

但我很确定使用`NSObject`将是最快的，因为根本没有开销。

# c# - 将 bool[] 转换为 byte[]

> ID：713057
> 
> 赞同：9
> 
> 时间：2009-04-03T08:40:29.483
> 
> 标签：c#, boolean, bytearray

我有一个`List<bool>`要转换为`byte[]`. 我该怎么做呢？ `list.toArray()`创建一个`bool[]`.

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-03T08:53:46.080

这里有两种方法，具体取决于您是要将位打包成字节，还是与原始位一样多的字节：

```
 bool[] bools = { true, false, true, false, false, true, false, true,
                     true };

    // basic - same count
    byte[] arr1 = Array.ConvertAll(bools, b => b ? (byte)1 : (byte)0);

    // pack (in this case, using the first bool as the lsb - if you want
    // the first bool as the msb, reverse things ;-p)
    int bytes = bools.Length / 8;
    if ((bools.Length % 8) != 0) bytes++;
    byte[] arr2 = new byte[bytes];
    int bitIndex = 0, byteIndex = 0;
    for (int i = 0; i < bools.Length; i++)
    {
        if (bools[i])
        {
            arr2[byteIndex] |= (byte)(((byte)1) << bitIndex);
        }
        bitIndex++;
        if (bitIndex == 8)
        {
            bitIndex = 0;
            byteIndex++;
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-04-12T12:05:37.993

## 马克的回答已经很好了，但是......

*假设*你是那种喜欢玩比特的人，或者只是想写更少的代码*并*挤出更多的性能，那么这里的代码是给你的好先生/女士：

```
byte[] PackBoolsInByteArray(bool[] bools)
{
    int len = bools.Length;
    int bytes = len >> 3;
    if ((len & 0x07) != 0) ++bytes;
    byte[] arr2 = new byte[bytes];
    for (int i = 0; i < bools.Length; i++)
    {
        if (bools[i])
            arr2[i >> 3] |= (byte)(1 << (i & 0x07));
    }
} 
```

它与 Marc 的代码完全相同，只是更简洁。

当然，如果我们*真的*想全力以赴，我们也可以展开它............
当我们在它的时候，让我们在返回类型上扔一个曲线球！

```
IEnumerable<byte> PackBoolsInByteEnumerable(bool[] bools)
{
    int len = bools.Length;
    int rem = len & 0x07; // hint: rem = len % 8.

    /*
    byte[] byteArr = rem == 0 // length is a multiple of 8? (no remainder?)
        ? new byte[len >> 3] // -yes-
        : new byte[(len >> 3)+ 1]; // -no-
     */

    const byte BZ = 0,
        B0 = 1 << 0, B1 = 1 << 1, B2 = 1 << 2, B3 = 1 << 3,
        B4 = 1 << 4, B5 = 1 << 5, B6 = 1 << 6, B7 = 1 << 7;

    byte b;
    int i = 0;
    for (int mul = len & ~0x07; i < mul; i += 8) // hint: len = mul + rem.
    {
        b = bools[i] ? B0 : BZ;
        if (bools[i + 1]) b |= B1;
        if (bools[i + 2]) b |= B2;
        if (bools[i + 3]) b |= B3;
        if (bools[i + 4]) b |= B4;
        if (bools[i + 5]) b |= B5;
        if (bools[i + 6]) b |= B6;
        if (bools[i + 7]) b |= B7;

        //byteArr[i >> 3] = b;
        yield return b;
    }

    if (rem != 0) // take care of the remainder...
    {
        b = bools[i] ? B0 : BZ; // (there is at least one more bool.)

        switch (rem) // rem is [1:7] (fall-through switch!)
        {
            case 7:
                if (bools[i + 6]) b |= B6;
                goto case 6;
            case 6:
                if (bools[i + 5]) b |= B5;
                goto case 5;
            case 5:
                if (bools[i + 4]) b |= B4;
                goto case 4;
            case 4:
                if (bools[i + 3]) b |= B3;
                goto case 3;
            case 3:
                if (bools[i + 2]) b |= B2;
                goto case 2;
            case 2:
                if (bools[i + 1]) b |= B1;
                break;
            // case 1 is the statement above the switch!
        }

        //byteArr[i >> 3] = b; // write the last byte to the array.
        yield return b; // yield the last byte.
    }

    //return byteArr;
} 
```

**提示：**如您所见，我包含了将 a`byte[]`作为注释返回的代码。如果这是您想要/需要的，只需注释掉这两个 yield 语句。

* * *

**Twiddling 提示：**
Shifting`x >> 3`更便宜`x / 8`。
掩蔽`x & 0x07`是更便宜的`x % 8`。
掩蔽`x & ~0x07`是更便宜的`x - x % 8`。

* * *

**编辑：** 这是一些示例文档：

```
 /// <summary>
    /// Bit-packs an array of booleans into bytes, one bit per boolean.
    /// </summary><remarks>
    /// Booleans are bit-packed into bytes, in order, from least significant
    /// bit to most significant bit of each byte.<br/>
    /// If the length of the input array isn't a multiple of eight, then one
    /// or more of the most significant bits in the last byte returned will
    /// be unused. Unused bits are zero / unset.
    /// </remarks>
    /// <param name="bools">An array of booleans to pack into bytes.</param>
    /// <returns>
    /// An IEnumerable&lt;byte&gt; of bytes each containing (up to) eight
    /// bit-packed booleans.
    /// </returns> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T08:58:41.450

您可以使用 LINQ。这不会是有效的，但会很简单。我假设您希望每个布尔值一个字节。

```
bool[] a = new bool[] { true, false, true, true, false, true };
byte[] b = (from x in a select x ? (byte)0x1 : (byte)0x0).ToArray(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-26T00:18:03.087

或者[AnorZaken 的回答](https://stackoverflow.com/a/36572780/5185376)`IEnumerable`方法：

```
static IEnumerable<byte> PackBools(IEnumerable<bool> bools)
{
    int bitIndex = 0;
    byte currentByte = 0;
    foreach (bool val in bools) {
        if (val)
            currentByte |= (byte)(1 << bitIndex);
        if (++bitIndex == 8) {
            yield return currentByte;
            bitIndex = 0;
            currentByte = 0;
        }
    }
    if (bitIndex != 8) {
        yield return currentByte;
    }
} 
```

并且相应的解包`paddingEnd`意味着从最后一个字节中丢弃的比特量来解包：

```
static IEnumerable<bool> UnpackBools(IEnumerable<byte> bytes, int paddingEnd = 0)
{
    using (var enumerator = bytes.GetEnumerator()) {
        bool last = !enumerator.MoveNext();
        while (!last) {
            byte current = enumerator.Current;
            last = !enumerator.MoveNext();
            for (int i = 0; i < 8 - (last ? paddingEnd : 0); i++) {
                yield return (current & (1 << i)) != 0;
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T08:56:38.397

如果您对列表的类型有任何控制权，请尝试将其设为 List，然后它将在 ToArray() 上生成 byte[]。如果你有一个 ArrayList，你可以使用：

```
(byte[])list.ToArray(typeof(byte)); 
```

要获取列表，您可以使用未指定的列表迭代器创建一个作为构造函数的输入，然后生成 ToArray()? 或者复制每个项目，从 bool 转换为一个新字节？

关于它是什么类型的列表的一些信息可能会有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T08:58:01.437

看看[BitConverter](http://msdn.microsoft.com/en-us/library/system.bitconverter.aspx)类。根据您的需求的确切性质，它可以很好地解决您的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-04T17:55:45.673

另一种 LINQ 方法，不如@hfcs101 有效，但也很容易适用于其他值类型：

```
var a = new [] { true, false, true, true, false, true };
byte[] b = a.Select(BitConverter.GetBytes).SelectMany(x => x).ToArray(); 
```

# c# - 使用单独的程序集扩展 c# 代码

> ID：713060
> 
> 赞同：2
> 
> 时间：2009-04-03T08:41:25.907
> 
> 标签：c#, .net, delegates, c#-2.0, partial-classes

我需要添加一些额外的功能，其中包括向对象添加新属性以及在另一个处理该对象的类中扩展方法。我正在处理我们使用的产品的源代码（在 C# 2.0 中），我真的不想修改它，我只想扩展它。

理想情况下，我希望有一个单独的程序集来执行此操作，以便清楚它是我们的代码。似乎部分类和委托可能是要走的路，但我不确定这是否可行。有没有人做过类似的事情？或者知道什么好文章？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T10:04:11.823

查看[装饰器](http://www.dofactory.com/Patterns/PatternDecorator.aspx#_self1)模式。这正是您正在寻找的。您可以继承现有类并使用您拥有的任何其他逻辑对其进行扩展。如果你想隐藏一些基本功能，还有一个[代理模式。](http://www.dofactory.com/Patterns/PatternProxy.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T10:06:40.257

就像hfcs101说的。

看看你是否可以在给定一些现有的 OO 设计模式的情况下扩展该类。

看一眼：

*   [适配器模式](http://www.fluffycat.com/Java-Design-Patterns/Adapter/)
*   [装饰图案](http://www.fluffycat.com/Java-Design-Patterns/Decorator/)
*   [立面图案](http://www.fluffycat.com/Java-Design-Patterns/Facade/)

看看您是否能找到与您的问题非常匹配的模式。Decorator 看起来是最佳人选。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:48:33.863

好吧，您必须将原始类修改为“部分”类，并且您必须确保第二个程序集中的命名空间与第一个程序集中的命名空间匹配，并且两个程序集都是使用这些程序集的项目中的引用. 从那里你可以自由地扩展你的意志。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T09:05:19.563

你可以从类继承还是密封？继承是扩展现有类的 OO 方式...

# c# - 安全序列化

> ID：713064
> 
> 赞同：0
> 
> 时间：2009-04-03T08:42:38.697
> 
> 标签：c#, .net, serialization, tcp, rmi

我正在编写一个客户端/服务器，它允许客户数据在我们的总部和公司内的移动销售人员之间共享。

服务器下载并写入 XML 文件中的客户数据，但也将数据保存在内存中，以便它可以充当本地客户端。

我计划对 ArrayList 进行序列化，以便可以轻松地通过 Internet 发送客户数据。这有多安全？我应该在传输序列化对象之前研究某种形式的加密吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T08:49:47.290

作为序列化的一部分，我不会执行加密。

这里有两个问题：

1.  将对象置于可传输的形式，即序列化。
2.  确保传输安全。

1 和 2 是独立的问题，将它们组合成一个解决方案只会在将来给自己制造问题。

我会使用开箱即用的序列化，然后使用安全的传输通道，比如[TLS](http://en.wikipedia.org/wiki/Transport_Layer_Security)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T08:45:22.170

我的猜测，看看HTTPS。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T08:51:37.490

您不应该考虑序列化部分。在序列化过程结束时，您会获得数据（二进制或 XML），您应该将其视为不安全的。

如果您的计划是通过网络安全地传输它，您应该研究 HTTPS，但如果您计划通过电子邮件或文件传输等其他方式传输它，或者您需要安全地存储或存档它，您可能应该研究[PKCS #7 及相关标准](http://en.wikipedia.org/wiki/PKCS)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T08:52:06.007

> 我计划对 ArrayList 进行序列化，以便可以轻松地通过 Internet 发送客户数据。这有多安全？

就像在明信片上打印并放入邮件一样安全。您和接收者之间的链中的任何内容都可以看到内容。

> 我应该在传输序列化对象之前研究某种形式的加密吗？

这是通常的做法。传输级别的安全性，例如安全套接字，客户端和服务器之间的连接被加密，但消息以“纯文本”形式出现在任一端，或者您可以加密消息本身，然后在客户端中解密。加密消息而不是传输更复杂，因为它影响更多层，但允许您保存消息或从客户端服务器更改为允许缓存的东西。如果您担心移动中的人丢失笔记本电脑时信息会丢失，那么加密消息并仅在使用时解密它们可能会更好。（另一种选择是对保存任何客户消息的驱动器进行加密，这样可以保护所有内容，但也会影响计算机上的所有内容，因此需要更改公司的 IT 政策）。

你当然可以同时使用这三个。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T09:35:24.780

> 我计划对 ArrayList 进行序列化，以便可以轻松地通过 Internet 发送客户数据。这有多安全？我应该在传输序列化对象之前研究某种形式的加密吗？

加密不应该发生在序列化步骤。需要明确的是：序列化正在获取对象并将其转换为一串字节。您的所有序列化都应该清楚地完成，而没有任何不必要的修改以使事情复杂化。

一旦准备好导出位包，就应该进行加密。如果您正在与目的地进行“实时”通信——例如通过网络，那么您应该使用 SSL 来保护线路。幸运的是，这就像将[SslStream (MSDN)](http://msdn.microsoft.com/en-us/library/system.net.security.sslstream.aspx)附加到您的`TcpClient`. 请注意，仅加密较大（未加密）流中的一小部分位通常是错误的安全性。为了安全起见，整个对话应该是安全的。

另一方面，如果您正在存储这些位（即在文件中），那么您应该使用某种离线加密。同样，.NET 框架为您处理所有细节；只需将[CryptoStream](http://msdn.microsoft.com/en-us/library/system.security.cryptography.cryptostream(VS.71).aspx)对象附加到您的对象上即可`FileStream`。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T09:41:11.350

序列化、gzip，然后通过 HTTPS 发送。以正确的顺序保持这些步骤很重要。压缩加密数据不起作用。加密未压缩数据需要更多时间，理论上会降低安全性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T09:06:50.027

通过 SSL 使用 HTTPS 或 TCP 取决于您的通信通道。如果它需要在每一侧安全地部署您的证书，并且其中的所有内容都是安全的。

另外，正如您所说的在序列化之前进行加密可以解决问题，您可以在双方都使用一个密钥，您需要安全地存储密钥并确保没有人可以访问它们。然而，这并不是很好，因为您可能希望稍后更换它们，并且密钥管理可能会有点痛苦。我会说坚持使用 HTTPS/TCP + SSL

# email - Solr 中的动态字段

> ID：713071
> 
> 赞同：0
> 
> 时间：2009-04-03T08:45:07.507
> 
> 标签：email, indexing, lucene, solr, information-retrieval

在我当前的项目中，我需要索引来自多个邮箱的所有电子邮件及其附件。

我将使用 Solr，但我不知道构建索引结构的最佳方法是什么。我的第一种方法是：

```
<fields>
<field name="id" require="true"/>
<field name="uid" require="true"/>
//A lot of other fields
<dynamicField name="attachmentName_*" require="false">
<dynamicField name="attachmentBody_*" require="false">
</fields> 
```

但现在我不确定它是否是最好的结构。我不认为我可以通过单个查询搜索一个术语（例如*stackoverflow*）并知道该术语在哪里（例如*attachmentBody_1*或*_2*或*_3等）。*

有人对我的索引结构有更好的建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T17:13:16.503

您可以将多值字段用于 attachmentName 和 attachmentBody。因此，您将拥有 2 个常规字段而不是动态字段。然后，您可以使用突出显示来带回与周围上下文匹配的特定值。

另一种选择是使每个附件成为一个单独的文档，并存储一些内容以识别它属于哪个电子邮件。这种方法的缺点是您可能需要多次索引电子邮件本身的任何数据。但是，如果大多数电子邮件消息都有多个附件，这实际上只是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T15:59:23.703

我找到了一种可能的解决方案。我需要做的就是将 attachmentBody 设置为已存储。

这个解决方案还不够好，因为索引的空间会急剧增加，但在我的情况下没有问题，因为我也会实现高亮功能并且需要存储这些字段。

# wpf - 如何发送验证消息表单模型以在 MVVM 模式中查看？

> ID：713085
> 
> 赞同：4
> 
> 时间：2009-04-03T08:48:59.633
> 
> 标签：wpf, validation, mvvm

我有一个小型测试 WPF MVVM 应用程序在其中工作，其中一个视图允许用户更改客户的名字或姓氏，并且全名会自动更改，因此通信从 M 到 MV 到 V 并返回，一切都完全解耦，到目前为止一切顺利。

但是现在，当我考虑如何开始扩展它以使用 MVVM 模式构建大型应用程序时，我发现解耦是一个障碍，即：

*   **我将如何进行验证消息**，例如，如果回到 LastName 设置器中的模型中，我添加了阻止设置超过 50 个字符的名称的代码，**我如何向视图发送消息，**告诉它显示名称太长的？

*   在复杂的应用程序中，**我可能一次在屏幕上有几十个视图**，但我知道在 MVVM 中，每个视图都有一个且只有一个 ViewModel 分配给它来为其提供数据和行为，那么**视图如何交互例如，**在上面的验证示例中，如果回到客户模型中，我们想要通知特定的“MessageAreaView”以显示消息“姓氏可能只包含 50 个字符。”，我们如何在堆栈中进行通信到那个特定的观点？

**CustomerHeaderView.xaml（视图）：**

```
<UserControl x:Class="TestMvvm444.Views.CustomerHeaderView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
        <StackPanel HorizontalAlignment="Left">
            <ItemsControl ItemsSource="{Binding Path=Customers}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <StackPanel Orientation="Horizontal">
                                <TextBox
                                Text="{Binding Path=FirstName, Mode=TwoWay}" 
                                Width="100" 
                                Margin="3 5 3 5"/>
                                <TextBox 
                                Text="{Binding Path=LastName, Mode=TwoWay}" 
                                Width="100"
                                Margin="0 5 3 5"/>
                                <TextBlock 
                                Text="{Binding Path=FullName, Mode=OneWay}" 
                                Margin="0 5 3 5"/>
                            </StackPanel>
                        </StackPanel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>
    </Grid>
</UserControl> 
```

**Customer.cs（模型）：**

```
using System.ComponentModel;

namespace TestMvvm444.Model
{
    class Customer : INotifyPropertyChanged
    {

        public int ID { get; set; }
        public int NumberOfContracts { get; set; }

        private string firstName;
        private string lastName;

        public string FirstName
        {
            get { return firstName; }
            set
            {
                if (firstName != value)
                {
                    firstName = value;
                    RaisePropertyChanged("FirstName");
                    RaisePropertyChanged("FullName");

                }
            }
        }

        public string LastName
        {
            get { return lastName; }
            set
            {
                if (lastName != value)
                {
                    lastName = value;
                    RaisePropertyChanged("LastName");
                    RaisePropertyChanged("FullName");
                }
            }
        }

        public string FullName
        {
            get { return firstName + " " + lastName; }
        }

        #region PropertChanged Block
        public event PropertyChangedEventHandler PropertyChanged;

        private void RaisePropertyChanged(string property)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(property));
            }
        }
        #endregion
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T09:04:24.823

为了验证，让您的视图模型实现[`IDataErrorInfo`](http://msdn.microsoft.com/en-us/library/system.componentmodel.idataerrorinfo.aspx)。至于视图之间的通信，不要害怕编写 UI 服务（例如，允许视图模型提供消息的消息服务，这些消息将显示在 UI 中的某个位置）。或者，如果视图模型之间存在硬关系（例如，一个视图模型拥有另一个视图模型），则拥有的视图模型可以持有对子视图模型的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-06T11:23:59.703

添加验证消息的一种非常简单的方法是使用绑定。

向您的视图模型添加一个可通知属性，该属性定义是否应显示验证消息：

```
private Boolean _itemValidatorDisplayed;
public Boolean ItemValidatorDisplayed
{
    get { return _itemValidatorDisplayed; }
    set
    {
        _itemValidatorDisplayed= value;
        _OnPropertyChanged("ItemValidatorDisplayed");
    }
} 
```

添加一个将 bool 转换为可见性的转换器类：

```
using System;
using System.Windows;

namespace xxx
{
    public class BoolToVisibilityConverter : IValueConverter
    {
        public bool Negate { get; set; }

        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            bool val = System.Convert.ToBoolean(value);
            if (!Negate)
            {
                return val ? Visibility.Visible : Visibility.Collapsed;
            }
            else
            {
                return val ? Visibility.Collapsed : Visibility.Visible;
            }
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    }
} 
```

从视图绑定到属性并应用转换器：

```
 <UserControl x:Class="ViewClass"
    ...
    >
        <UserControl.Resources>
            <contract:BoolToVisibilityConverter Negate="False"
                                                x:Key="BoolToVisibilityConverter" />
        </UserControl.Resources>

...

<TextBlock Visibility="{Binding Converter={StaticResource BoolToVisibilityConverter}, Path=ItemValidatorDisplayed}" />

...

</UserControl> 
```

您需要将 ViewModel 设置为视图的数据上下文：

```
namespace xxx
{
    public partial class ViewClass: UserControl
    {
        public ViewClass()
        {
            InitializeComponent();

            this.DataContext = new ViewClass_ViewModel();
        }
}
} 
```

Bingo - 完美工作的验证被推送到任何关心订阅此 ViewModel/Property 的视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-07T12:04:17.477

您还可以将验证绑定到 SL3 中的源对象集合 :-)

# php - PHP 复杂用途 - 与外部设备交互

> ID：713086
> 
> 赞同：0
> 
> 时间：2009-04-03T08:49:03.550
> 
> 标签：php

是否可以在 PHP 中访问和控制外部设备？

例如，它是否能够改变 USB 风扇的速度或改变无线玩具车的方向。

我正在尝试超越网络开发，我想知道我使用的编程语言是否能够处理我的想法，或者我是否应该考虑改变环境。

如果这些是可能的，我将非常感谢任何关于阅读材料或可能更适合的其他语言的建议的建议。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T08:52:54.647

在 Linux 上，通过访问 /dev/ 文件肯定是可能的。但这会非常乏味。我建议你切换到 Python、Ruby、Lua 或 Java。

例如，有针对[Python](http://pyusb.berlios.de/)、[Ruby](http://www.a-k-r.org/ruby-usb/)、[Lua](http://luaforge.net/projects/lualibusb/)和[Java的](http://libusbjava.sourceforge.net/wp/res/doc/ch/ntb/usb/LibusbJava.html)[libusb](http://libusb.wiki.sourceforge.net/)绑定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T09:10:07.307

您可以编写一个外部程序，然后使用 PHP 的 exec（或者是系统？）函数与可执行文件或脚本进行交互。

似乎是最明智的做法。另一个不错的选择是构建一个程序或脚本来控制可以与通过 HTTP 公开的 RESTfull 类型 API 进行通信的外部设备 - 然后在 PHP 领域使用 lib_curl 在它之间来回交谈。相信我，用 C++ 构建一个基本的 HTTP 服务器，可以用来通过 PHP（或 JS）远程控制是非常简单的。

**等待**

我想我读错了这个问题；）

如果你想进入真正酷的东西，我说你学习 C++。C++ 是一门很棒的语言，它不仅打开了很多大门，而且提供了良好的学习体验。C++ 非常有趣。

**回应评论**

在使用 USB 的情况下，它有点不同且更复杂（因为 USB 具有已建立的协议等），但串行就像将数据转储到句柄中一样简单。

你应该能够很快学会 C++ 来达到这一点。无论哪种方式，这都是一次很棒的经历。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T08:51:01.313

这可以通过扩展实现，但不能使用纯 PHP 代码。我不知道任何扩展能够做这样的事情，但我认为它应该是可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T09:10:18.850

如果您找到执行此操作的命令行工具，则可以使用[exec()](http://is2.php.net/manual/en/function.exec.php)、[system()](http://is2.php.net/manual/en/function.system.php)、[passthru()](http://is2.php.net/manual/en/function.passthru.php)或[shell_exec()](http://is2.php.net/manual/en/function.shell-exec.php)来控制它（基于程序返回给您的输出）

如果您从公共网站授予对该程序的访问权限，请务必使用[escapeshellcmd() 。](http://is2.php.net/manual/en/function.escapeshellcmd.php)

# vb.net - 如何（以编程方式）将图像添加到 AxMSComctlLib.AxImageList 并将图像列表绑定到 AxMSComctlLib.AxToolbar

> ID：713096
> 
> 赞同：0
> 
> 时间：2009-04-03T08:50:43.107
> 
> 标签：vb.net, vb6

我正在开发.NET 应用程序。并使用一些 vb6 常用控件

在设计模式下，我可以创建图像列表并将其附加到工具栏控件，但是当我以编程方式添加工具栏按钮时

Toolbar.Buttons.Add(, "tbsave", "Save", MSComctlLib.ButtonStyleConstants.tbrDefault, toolbarImages.ListImages(1).Picture)

得到异常“无效密钥”它不是

任何想法？？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T05:46:00.357

您正在考虑使用 .NET。改用 VB6 来思考。

```
dim nIndex as long 
nIndex = 4  ' this is the index of your image in the ImageList control.
            ' The code assumes that you already assigned the ImageList
            ' to the Toolbar.ImageList property

Toolbar.Buttons.Add(, "tbsave", "Save", MSComctlLib.ButtonStyleConstants.tbrDefault, nIndex) 
```

# sql - 交叉连接

> ID：713103
> 
> 赞同：0
> 
> 时间：2009-04-03T08:52:42.837
> 
> 标签：sql

在 SQL 中，谁能给我一些关于何时使用交叉连接的好例子？

## 重复的问题

*   [交叉连接的用途是什么？](https://stackoverflow.com/questions/219716/what-are-the-uses-for-cross-join)
*   [sql cross join - 有人发现它有什么用处？](https://stackoverflow.com/questions/523091/sql-cross-join-what-use-has-anyone-found-for-it)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T08:54:48.417

**选项1**：它可用于轻松生成大量数据（例如用于测试目的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T09:00:33.413

在我的职业生涯中，我正好使用了一种愤怒，作为一种快速匹配多对多关系的技术。问题是能够从任一侧搜索两类组之间的关系。

有很多方法可以以编程方式解决这个问题，但由于我们有数十亿种可能性，结果证明用交叉连接匹配简单字符串键的数组比其他任何方法都要快几个数量级。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T16:41:27.713

实际上，正如我们所说，我正在尝试找出在 MS Access 2003 中使用 CROSS JOIN 的最佳方式。

基本上，我们有一个数据库，其中包含客户、服务计划（年度计划，详细说明分配给每个服务分配的金额）、分配（服务计划中的特定金额）、服务代码（每个分配都有一个服务代码） ，费用记录，支持提供者。

我试图弄清楚我们每个提供商在过去 6 个月内每月支付了多少服务，包括在过去 6 个月内没有支付任何费用（0 费用）的服务。但常规连接查询仅给出 ACTUAL 费用的 COUNT，但对于未记录费用的服务代码不提供零。因此，我想获得所有支持提供商与所有服务代码的交叉产品，这样每个提供商对数据库中可能的每个服务代码都有一个记录，因此每个服务将有一个 Total 或一个 0。

希望有帮助。

仍在尝试找出在 Access 中执行此操作的最佳方法，这似乎没有对此类事情的最佳支持。只是不太确定使用常规连接与其他表组合时的语法......

# javascript - JQuery 复选框的未定义值

> ID：713107
> 
> 赞同：3
> 
> 时间：2009-04-03T08:54:12.133
> 
> 标签：javascript, jquery, ajax

我有 3 个复选框，但它们在警报框中显示为未定义。有什么技巧可以让他们表现出价值吗？我尝试在输入标签中输入值 1，但它仍然报告为未定义。

好的，谢谢.. 这是一些代码。

```
 else if (item.field == "admCustRptDly" && item.value == "1")
        {
          $('#admCustRptDly').attr('checked', true);
        }

        else if (item.field == "admCustRptSumm" && item.value == "1")
        {
          $('#admCustRptSumm').attr('checked', true);
        }

        else if (item.field == "admCustRptDtl" && item.value == "1")
        {
          $('#admCustRptDtl').attr('checked', true);
        }

<input type="checkbox" id="admCustRptDly" name="admCustRptDly" class="admChkbx">
<input type="checkbox" id="admCustRptSumm" name="admCustRptSumm" class="admChkbx">
<input type="checkbox" id="admCustRptDtl" name="admCustRptDtl" class="admChkbx"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T12:51:03.017

```
 else if (item.field == "admCustRptDly" && item.value == "1") 
```

我不明白你想在这里做什么？我猜您正在尝试验证“admCustRptDply”复选框的值。也许在此之前也发布代码。你可以得到这样的值：

```
 var val = $("#admCustRptDly").val() 
```

但是在您的 HTML 中，复选框没有 value 属性。

您可以像这样获取复选框的选中属性：

```
var checked = $("#admCustRptDly").attr("checked") 
```

你可以这样设置：

```
$("#admCustRptDly").attr("checked","checked") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T12:31:25.247

您的 jquery 已关闭，这并不能完全给出您期望的响应，而是查找是否选中了复选框：

```
var checked = $("#admCustRptDtl:checked").val(); 
```

此外，checked 属性永远不会等于 true，html 实际上是 checked="checked"

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T08:57:14.497

请问可以展开吗？一些示例代码会很有帮助，您可能只是在尝试使用它时拼错了复选框名称。

# c# - 性能 - 使用 Guid 对象或 Guid 字符串作为 Key

> ID：713109
> 
> 赞同：57
> 
> 时间：2009-04-03T08:55:30.180
> 
> 标签：c#, performance, guid

当使用 a`Guid`作为 a 的索引时`Dictionary`，是使用对象更好`Guid`，还是使用 Guid 的字符串表示形式更好？

我只是重构了一些使用字符串来使用对象的代码，因为到处都有`new Guid()`调用。但这让我想知道性能问题可能是什么。（这些集合相当小，但它们会被迭代很多次。）

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-04-03T08:57:41.593

`Guid`应该更快，因为比较更简单 - 只需几个直接字节。该字符串涉及取消引用和更多工作。

当然-您可以配置文件；-p

证据：

```
Searching for 7f9b349f-f36f-94de-ad96-04279ddf6ecf
As guid: 466; -1018643328
As string: 512; -1018643328
Searching for 870ba465-08f2-c872-cfc9-b3cc1ffa09de
As guid: 470; 1047183104
As string: 589; 1047183104
Searching for d2376f8a-b8c9-4633-ee8e-9679bb30f918
As guid: 423; 1841649088
As string: 493; 1841649088
Searching for 599889e8-d5fd-3618-4c4f-cb620e6f81bb
As guid: 488; -589561792
As string: 493; -589561792
Searching for fb64821e-c541-45f4-0fd6-1c772189dadf
As guid: 450; 1389733504
As string: 511; 1389733504
Searching for 798b9fe5-ba15-2753-357a-7637161ee48a
As guid: 415; 779298176
As string: 504; 779298176
Searching for 12ba292e-8e59-e5d0-7d04-e811a237dc21
As guid: 457; 558250944
As string: 564; 558250944
Searching for 05b3ce14-dfbf-4d3a-1503-ced515decb81
As guid: 413; 1658205056
As string: 504; 1658205056
Searching for 8db4a556-0a65-d8cb-4d0d-0104245d18b8
As guid: 415; 696231936
As string: 506; 696231936
Searching for c49cf80c-5537-fba5-eebd-8ad21bba09c4
As guid: 459; 2100976384
As string: 557; 2100976384 
```

基于：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
static class Program
{

    static void Main()
    {
        Random rand = new Random(123456);
        int COUNT = 1000;
        Dictionary<Guid, int> guids = new Dictionary<Guid, int>(COUNT);
        Dictionary<string, int> strings = new Dictionary<string, int>(
            COUNT, StringComparer.Ordinal);

        byte[] buffer = new byte[16];
        for (int i = 0; i < COUNT; i++)
        {
            rand.NextBytes(buffer);
            Guid guid = new Guid(buffer);
            int val = rand.Next();
            guids.Add(guid, val);
            strings.Add(guid.ToString(), val);
        }

        for(int i = 0 ; i < 10 ; i++) {
            int index = rand.Next(COUNT);
            Guid guid = guids.Keys.Skip(index).First();
            Console.WriteLine("Searching for " + guid);
            int chk = 0;
            const int LOOP = 5000000;
            Stopwatch watch = Stopwatch.StartNew();
            for (int j = 0; j < LOOP; j++)
            {
                chk += guids[guid];
            }
            watch.Stop();
            Console.WriteLine("As guid: " + watch.ElapsedMilliseconds
                   + "; " + chk);
            string key = guid.ToString();
            chk = 0;
            watch = Stopwatch.StartNew();
            for (int j = 0; j < LOOP; j++)
            {
                chk += strings[key];
            }
            watch.Stop();
            Console.WriteLine("As string: " + watch.ElapsedMilliseconds
                   + "; " + chk);
        }
        Console.ReadLine();

    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T09:11:44.680

> 这些集合相当小，但它们会被迭代很多次

如果您正在迭代，则没有关键比较的关键。如果您通过键添加/修改或查找，则将对键进行散列并比较散列；只有当哈希值相等时，才会比较键。

因此，除非您在具有许多哈希冲突的大型字典上执行大量基于键的操作，否则键与键比较的速度将不是主要因素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T09:26:20.870

我的第一个想法是，`Guid`对象更快，但是如果您将一些输入作为字符串，并且必须在 GUID 的小集合（哈希集）（不经常更改）中搜索它，存储它们可能会更快作为字符串，因为：

*   要在 GUID 字典中搜索字符串，您必须解析字符串（包括错误检查等）、创建`Guid`结构、获取哈希码、进行哈希查找和最后一次 GUID 字节比较。

*   为了在字符串字典中搜索字符串，您必须构建字符串的哈希（可能比构建`Guid`结构更快），查找哈希并进行一个字符串比较。例如，如果您希望集合中没有许多 GUID，则哈希比较通常会失败，您甚至不必进行字符串比较（这比上面第 1 点中的 GUID 比较花费的时间稍长）

如果您已经将 Guid 结构作为输入（例如，因为您对输入字符串进行了一些有效性检查），那么将它们用作字典中的索引当然要好得多。

**但是**：从设计清晰度的角度来看（这比 99% 的代码中的性能更重要）你应该使用`Guid`结构并且只有在你真的遇到性能问题时才改变它（并且分析表明你获得了优势的字符串解决方案）。

# xml - XPath 生成包含同一节点的结果节点集不止一次？

> ID：713111
> 
> 赞同：2
> 
> 时间：2009-04-03T08:55:49.227
> 
> 标签：xml, xslt, xpath

我试图在标题中说的是：

给定一些我知道特定元素只出现一次的 XML，是否可以使用*单个*XPath 查询来选择包含该元素两次的节点集？

我知道有一个“联合”运算符（|），但这基本上是一个逻辑或，对吧？用 SQL 术语来说，我正在寻找相当于“联合所有”的东西。

例如，给定 XML 片段...

```
<toplevel>
  <ElementIWant>
    <SomeSubElement1>specific data</SomeSubElement1>
    <SomeSubElement2>specific data 2</SomeSubElement2>
  </ElementIWant>
</toplevel> 
```

...是否有一个查询可以让我获得相当于...的结果集

```
<ElementIWant>
  ...identical content...
</ElementIWant>
<ElementIWant>
  ...identical content...
</ElementIWant> 
```

我还没有找到任何让我认为可以做到的事情 - 但这就是我问的原因......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T14:01:43.110

*正如其他答案中所指出的，XPath 无法修改 XML 文档并生成新节点*。

由于 的定义，任何节点只能参与一次节点集`"set"`。

**但是，XPath 2.0 为我们提供了新的[序列类型](http://www.w3.org/TR/xpath-datamodel/#sequences)，**它允许重复项。

为了让一个元素在一个序列中出现两次，只需使用[**序列连接运算符`","`**](http://www.w3.org/TR/xpath-functions/#func-concatenate)，如下面的表达式：

**`/*/ElementYouWant, /*/ElementYouWant`**

将其放入 XSLT2.0 样式表中，如下所示：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 xmlns:f="http://fxsl.sf.net/"
 exclude-result-prefixes="f xs"
 >

 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
   <t>
     <xsl:sequence select=
      "/*/ElementYouWant, /*/ElementYouWant"/>
   </t>
 </xsl:template>
</xsl:stylesheet> 
```

并将此转换应用于此 XML 文档：

```
<toplevel>
    <ElementYouWant>
        <SomeSubElement1>specific data</SomeSubElement1>
        <SomeSubElement2>specific data 2</SomeSubElement2>
    </ElementYouWant>
</toplevel> 
```

产生想要的结果：

```
<t>
   <ElementYouWant>
            <SomeSubElement1>specific data</SomeSubElement1>
            <SomeSubElement2>specific data 2</SomeSubElement2>
      </ElementYouWant>
   <ElementYouWant>
            <SomeSubElement1>specific data</SomeSubElement1>
            <SomeSubElement2>specific data 2</SomeSubElement2>
      </ElementYouWant>
</t> 
```

请注意，如果使用该[**`<xsl:sequence>`**](http://www.w3.org/TR/xslt20/#element-sequence)指令，则不会创建元素的新副本`<ElementYouWant>`——因此在 XSLT 2.0 中建议使用`<xsl:sequence>`并避免使用[**`<xsl:copy-of>`**](http://www.w3.org/TR/xslt#element-copy-of)创建（不必要的）节点副本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T09:08:26.310

XPath 为您提供节点**集**，因此根据定义，节点只出现一次。现在，您可以命名模板并使用相同的 XPath 调用它两次。

```
<xsl:template match="/ElementIWant"> 
  <xsl:call-template name="repeat"/>
  <xsl:call-template name="repeat"/>
</xsl:template>

<xsl:template name="repeat"> 
  <xsl:copy select=".">
    <xsl:text>... same content ...</xsl:text>
  </xsl:copy>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T09:26:07.360

XPath 是一种用于查询 XML 文档中的数据的语言，而 SQL`UNION ALL`语法结合了来自两个不同查询的结果集。

XPath 本身不能用于以与现有格式不匹配的格式呈现现有数据。但是，您可以使用 XSLT 来执行此转换：

```
<x:stylesheet version="1.0" xmlns:x="http://www.w3.org/1999/XSL/Transform">
  <x:output method="xml"/>

  <x:template match="/">
    <topMostLevel>
      <x:apply-templates />
    </topMostLevel>
  </x:template>

  <x:template match="toplevel">
    <x:copy-of select="."/>
    <x:copy-of select="."/>
  </x:template>
</x:stylesheet> 
```

# xsd - xml架构元素层次结构的问题

> ID：713115
> 
> 赞同：0
> 
> 时间：2009-04-03T08:57:00.737
> 
> 标签：xsd

这个 xml 模式有什么问题？它解析不正确，我无法实现 cluster(element)->host(element)->Load(element) 之间的层次结构。

```
<?xml version="1.0"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:element name="cluster">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="host"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <xs:element name="host">
    <xs:complexType>
      <xs:element ref="Load"/>
      <xs:attribute name="name" type="xs:string" use="required"/>
    </xs:complexType>
  </xs:element>

  <xs:element name="Load">
    <xs:complexType>
      <xs:attribute name="usedPhisicalMemory" type="xs:integer"/>
    </xs:complexType>
  </xs:element>

</xs:schema> 
```

谢谢你，埃米利奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T10:06:11.757

在宿主元素中，加载元素不能是 complexType 的子元素，中间必须有序列等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T10:07:03.533

为了允许这样的事情（我更正了 中的错字`"usedPhysicalMemory"`）：

```
<cluster>
  <host name="foo">
    <Load usedPhysicalMemory="500" />
  </host>
  <host name="bar">
    <Load usedPhysicalMemory="500" />
  </host>
</cluster> 
```

这个模式可以做到：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:element name="cluster">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="host" maxOccurs="unbounded" />
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <xs:element name="host">    
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="Load" />
      </xs:sequence>
      <xs:attribute name="name" type="xs:string" use="required" />
    </xs:complexType>
  </xs:element>

  <xs:element name="Load">
    <xs:complexType>
      <xs:attribute name="usedPhysicalMemory" type="xs:integer" />
    </xs:complexType>
  </xs:element>    

</xs:schema> 
```

[从 MSDN 开始`<xs:complexType>`](http://msdn.microsoft.com/en-us/library/ms256067.aspx)（因为[规范](http://www.w3.org/TR/xmlschema11-1/#Complex_Type_Definitions)让我的大脑受伤）：

> 如果指定`group`、`sequence`、`choice`或`all`，则元素必须按以下顺序出现：
> 
> 1.  `group | sequence | choice | all`
> 2.  `attribute | attributeGroup`
> 3.  `anyAttribute`

也许其他人可以指出规范中的相关部分。

# asp.net - 文本格式工具栏

> ID：713120
> 
> 赞同：1
> 
> 时间：2009-04-03T08:58:23.650
> 
> 标签：asp.net, vb.net, formatting, text-editor

当您添加新问题时，我正在寻找如何实现类似于此处使用的工具栏的工具栏，该工具栏应格式化在我的文本框中输入的文本，并允许我将其设为粗体、斜体、选择大小、喜欢和突出显示，颜色也是... 一件重要的事情，我想要一个在 Firefox 和 IE 上都支持的东西，discountasp.net 提供了一个只被 IE 支持的东西。

PS：我正在用 asp.net 3.5、vb.net、MS SQL 2005 Express 对我的网站进行编码，所有这些都是使用 MS VWD 2008 express 完成的。

而且我可以补充一点，我不是编程大师，我只是让事情顺利进行，所以请保持简单；）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T09:10:36.070

[您可以在此处](http://github.com/cky/wmd/tree/master)获取 SO 编辑器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T09:12:06.473

我认为您应该尝试一下[http://nicedit.com/](http://nicedit.com/)它会将任何文本区域或文本框变成一个不错的编辑器，就像 SO 中使用的那样。

# vb.net - Vb 函数返回 null

> ID：713123
> 
> 赞同：10
> 
> 时间：2009-04-03T08:59:17.673
> 
> 标签：vb.net, null

具有整数返回类型的 VB.net 函数是否可以返回 null ？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-03T13:36:43.420

如果您严格地谈论空引用（C# 的 null 版本），那么答案是否定的。dommer 和 Mitch 在这里都有正确的想法。您必须返回 Nullable(OF Integer) 才能传达值的缺失。

但是，VB 没有空值。相反，它使用 Nothing。Nothing 代表值和引用类型的空值。它可以转换为任何值类型，并且仅表示 C# 中 default(T) 的等价物。许多人在谈论 VB 时都说 null，但实际上没有任何意义。如果是这种情况，那么是的，您可以从 Integer 返回函数返回 Nothing

```
Public Function Example() As Integer
  Return Nothing
End Function 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-03T09:03:05.200

您需要返回类型为 Nullable(Of Integer)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T09:02:31.520

仅当它被定义为返回一个可为空的整数时。

# google-maps - 使用 Google Map 的 css 流体布局

> ID：713132
> 
> 赞同：1
> 
> 时间：2009-04-03T09:03:00.787
> 
> 标签：google-maps, css, two-column-layout

我最近一直在为一个网站设计一个布局，并且被 CSS 卡住了。我喜欢认为我可以按照简单的教程进行 2 列页脚布局，但我一直被其中一列的内容所困扰。

两栏设计将是左侧流动的谷歌地图和右侧固定宽度的侧边栏。我已经尝试过很多这种布局的例子，但我总是遇到用谷歌地图保持流畅的一面的问题。主要是谷歌地图不喜欢保持流动。我已经尝试了所有我能找到的带有负边距、浮动、绝对定位的 CSS 解决方案（GMaps 真的很讨厌这个），甚至尝试过表格（不寒而栗）。

有没有人有任何想法来处理这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-26T19:13:17.657

看看 Yahoo YUI 网格。

[雅虎 YUI 网格](http://developer.yahoo.com/yui/grids/)

YUI CSS 框架提供了大量可定制的网格布局。页面宽度从 750 像素、950 像素、974 像素和 100% 不等，并且有提供固定左右列宽的模板 - 所有这些都保证在多个浏览器中正常工作。他们对尺寸的选择也与常见的广告尺寸有关，如果您愿意，可以更轻松地放置广告。Yahoo 上的所有页面都使用这些布局。

您还可以选择合并“重置”功能，以便将所有浏览器设置为关于字体、填充、边距等的通用布局。

对我来说，它使基础网页开发变得更加容易、不那么挑剔！

# selenium - Selenium 打开命令有时不起作用

> ID：713136
> 
> 赞同：4
> 
> 时间：2009-04-03T09:03:46.883
> 
> 标签：selenium

有时我的硒测试会超时这些建议：[你如何让硒识别页面加载？](https://stackoverflow.com/questions/88269/how-do-you-get-selenium-to-recognize-that-a-page-loaded)没有解决我的问题。当我使用 open 或 openAndWait 时，它主要发生在测试开始时。奇怪的是页面实际上被打开了，但测试只是停止并且没有进一步执行。我使用的是 beta-2 版本和多窗口 true。我用自定义命令调用我的浏览器。我愿意接受任何建议。

谢谢

库库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T09:13:00.840

您是否尝试过在 openAndWait 之后设置**固定暂停（几秒钟）？**根据我的经验，selenium 中的所有“打开”和“点击”（甚至是 *AndWait ）都不能保证在处理下一个 selenium 命令之前页面已**完全**加载到浏览器中。这就是为什么我总是在这些命令之后添加一个小暂停。

即使您在浏览器中看到正在呈现的页面，这并不一定意味着此时 Selenium 的命令处理器可以使用所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-12T19:07:19.540

这适用于 IE6、IE7、IE8、FF、Chrome：

```
<tr>
  <td>waitForCondition</td>
  <td>
    (selenium.browserbot.getCurrentWindow().$$("body").length == 1) ? true : false;
  </td>
  <td>10000</td>
</tr> 
```

它只是轮询目标窗口并检查 body 元素。但是，它仍然容易超时，但是您可以将其设置为您喜欢的任何值。

注意：以上代码使用 Prototype JS 获取 body 元素。这不是必需的，但如果您使用另一个 JS 库，则需要进行一些修改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-10T05:25:22.833

我有一个类似的问题，无论如何我都会超时。
我看到页面已完全呈现，但由于某种原因`selenium.open(relative_url)`会超时。

我尝试将超时设置为 120 秒，但仍然是同样的问题。将速度设置为非常慢也无济于事。

**我通过使用 try/catch 处理异常来修复它**，并且基本上继续验证页面是否真的呈现（就像一个魅力）所以我的代码看起来像这样：

```
try {
    selenium.open(relative_url);
} catch (Exception e) {
    // check if page rendered completely here
}
// continue 
```

# python - 从函数中获取文档字符串

> ID：713138
> 
> 赞同：223
> 
> 时间：2009-04-03T09:04:09.677
> 
> 标签：python

我有以下功能：

```
def my_func():
    """My docstring is both funny and informative"""
    pass 
```

如何访问文档字符串？

* * *

## 回答 #1

> 赞同：305
> 
> 时间：2009-04-03T09:05:57.440

交互式地，您可以使用

```
help(my_func) 
```

或者从代码中你可以检索它

```
my_func.__doc__ 
```

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2011-05-06T18:47:14.773

您也可以使用[`inspect.getdoc`](http://docs.python.org/library/inspect.html#inspect.getdoc). 它`__doc__`通过将制表符标准化为空格并左移文档正文以删除常见的前导空格来清理。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-05-24T04:44:14.943

在 ipython 或 jupyter 笔记本上，您可以使用上述所有方法，但我选择

```
my_func? 
```

或者

```
?my_func 
```

快速总结方法签名和文档字符串。

我避免使用

```
my_func?? 
```

（由@rohan 评论）用于文档字符串，仅用于检查源代码

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-07T18:34:23.100

```
import ast
import sys
f = open(sys.argv[1], "r") #filename input
module = ast.parse(f.read())
class_definitions = [node for node in module.body if isinstance(node, ast.ClassDef)]
method_definitions = []
for class_def in class_definitions:
        print(class_def.name)
        print(ast.get_docstring(class_def))
        function_definitions = [node for node in class_def.body if isinstance(node, ast.FunctionDef)]
        for f in function_definitions:
                print('\t---')
                print('\t'+f.name)
                print('\t---')
                print('\t'+'\t'.join(ast.get_docstring(f).splitlines(True)))
        print('----') 
```

# c# - 使用 COM-Interop 将数组从 JS 返回到 C#

> ID：713146
> 
> 赞同：5
> 
> 时间：2009-04-03T09:07:01.853
> 
> 标签：c#, javascript, com, com-interop

我通过 COM Interop 和 WebBrowser WPF 控件将一些数据从我的 JavaScript 代码返回到我的 C# 代码。我已经成功返回了在 Javascript 中看起来像这样的数据：

```
var result = new Array(); 
result[0] = cbCamera.selectedItem; 
result[1] = cbMicrophone.selectedItem; 
```

现在我有 C# 中的对象结果，如下所示：

```
result.GetType(); 
{Name = "__ComObject" FullName = "System.__ComObject"} 
```

如何获取包含在此 ComObject 中的此数组中的 javascript 字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T02:42:37.587

要查找包含在 rutime 可调用包装器 (System.__ComObject) 中的对象的底层类型，您可以使用 refection。然后，您将能够根据此信息创建或转换为托管类型。

例如;

```
string type = (string)result.GetType().InvokeMember("getType",
BindingFlags.InvokeMethod, null, result, null); 
```

或者，您可以使用 invokeMember 来检索值。例如，您可以调用 valueOf 方法将数组转换为可能的最有意义的原始值，或者调用 toString 将数组转换为 csv 字符串。

```
string result = (string)result.GetType().InvokeMember("toString",
BindingFlags.InvokeMethod, null, result, null);
string[] jsArray = result.Split(',');
// c# jsArray[n] = js result[n] 
```

编辑：在 c# 4.0 中执行此操作的第三种方法是使用新的动态类型。动态类型使得对 COM 对象进行后期绑定调用变得非常容易。

```
string csv = ((dynamic)result).toString(); 
```

# multithreading - 对并行 Haskell 感到困惑

> ID：713150
> 
> 赞同：1
> 
> 时间：2009-04-03T09:09:26.667
> 
> 标签：multithreading, haskell, parallel-processing

这段代码如何：

```
parfib :: Int -> Int
parfib 0 = 1
parfib 1 = 1
parfib n = nf2 `par` (nf1 `par` (nf1+nf2+1))
           where nf1 = parfib (n-1)
                 nf2 = parfib (n-2) 
```

比这更好：

```
parfib :: Int -> Int
parfib 0 = 1
parfib 1 = 1
parfib n = nf2 `par` (nf1 `seq` (nf1+nf2+1))
           where nf1 = parfib (n-1)
                 nf2 = parfib (n-2) 
```

我没有得到我在网上找到的解释说“为了保证以正确的顺序评估主表达式（即不阻塞子任务上的主任务），使用了 seq 注释”。

为什么要使用 seq？我知道它强制解释器首先评估 parfib (n-1) 但为什么有必要？

在执行第二个程序时，interpeter 不会触发一个新进程来评估 nf2，同时并行评估 nf1+nf2+1 表达式的 nf1 吗？有什么需要告诉它指定它应该以 nf1 开头？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T10:54:40.580

`nf1`并行评估没有多大意义，`nf1+...`因为后者取决于 nf1，所以它所做的只是阻止`nf1`. 使用`seq`它只会在`nf1`您知道它已被评估后尝试使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-06T20:46:10.217

这可能是因为我们希望根据我的理解最小化火花的数量，这两个版本会产生相同的结果

但是使用第一个选项，您将触发两个额外的进程（nf1，nf2）。但是当我们使用 seq 时，我们只会触发一个附加进程（nf1）。

# c# - 如何将数据或事件信息从 Javascript 发送到 Default.cs (Asp.net)？

> ID：713157
> 
> 赞同：0
> 
> 时间：2009-04-03T09:12:25.223
> 
> 标签：c#, .net, asp.net, ajax

如何将数据或事件信息从 Javascript 发送到 Default.cs (ASP.NET)？是阿贾克斯吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T14:26:38.433

您将需要创建一个对 Default.aspx 的 AJAX 调用。

使用[jQuery](http://www.jquery.com)：

```
$.ajax({
    type: "POST",
    url: "Default.aspx",
    data: "first=John&last=Doe",
    success: function(msg){
        alert( "Data saved: " + msg );
    }
}); 
```

# java - Websphere Portal Server 的奇怪垃圾收集行为

> ID：713161
> 
> 赞同：4
> 
> 时间：2009-04-03T09:14:27.700
> 
> 标签：java, garbage-collection, websphere, portal-server

我们正在使用 IBM JDK 1.4.2 在 AIX 上的 Websphere Portal Server 5.1 上将一个相当复杂的应用程序作为 portlet 运行。在我们的生产系统上，我可以在详细的 GC 日志中看到一个奇怪的行为。在一段时间的正常行为之后，系统可以开始快速分配越来越大的块。系统开始花费超过 1000 毫秒来完成每个 GC，但是分配块的速度非常快，以至于分配失败之间只有 30 毫秒的间隔。

*   每个分配失败比最后一个稍大一些整数 x 1024 字节。例如，您可能有 5 MB，然后不久之后 5 MB + 17 * 1024。
*   这可以持续长达 10 分钟。
*   在停止之前，这些块的大小往往会增长到 8 到 14 MB。
*   这是一个四核系统，我假设它现在花费超过 95% 的时间进行 GC，其中三个核心等待另一个核心完成 GC。10 分钟。哎哟。
*   显然，此时系统性能会下降。
*   我们有 JSF、hibernate 和 JDBC、Web 服务调用、log4j 输出等等。

我认为这可能是基础设施而不是我们的应用程序代码。如果是循环内的错误字符串连接，我们预计会比 1024 个块有更多的不规则增长。如果是 StringBuffer 或 ArrayList 增长，我们会看到块大小翻倍。这种增长让我想到了日志缓冲或其他东西。在我们的应用程序中我想不出任何分配甚至 1 MB 的东西，更不用说 14。今天我在内存中寻找日志记录备份，然后再刷新到磁盘，但是在这段 GC 颠簸期间的日志记录语句量远不及MB 范围。

很明显，问题在于过多的内存分配，而不是垃圾收集，垃圾收集只是尽力跟上。有些东西正在分配一个大块并试图以太小的增量低效地增长它。

当系统处于负载状态时，有什么想法可能导致所有这些吗？有人看到与 Portal Server 类似的东西吗？

注意：对于任何感兴趣的人来说，原因似乎是偶尔但巨大的数据库查询。罪魁祸首似乎是 Hibernate 或 JDBC 驱动程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T09:43:38.613

不确定是什么导致了问题，但这里有一个关于如何进行更多调查的想法：IBM JDK 很棒，因为它可以配置为在收到 SIGQUIT 信号时进行堆转储。
在之前的项目中，它不是我们的 JDK，但只要我们有内存问题需要调查，我们就会使用它。

以下是启用堆转储的方法：http: [//publib.boulder.ibm.com/infocenter/javasdk/v1r4m2/index.jsp ?topic=/com.ibm.java.doc.diagnostics.142j9/html/enabling_a_heapdump.html](http://publib.boulder.ibm.com/infocenter/javasdk/v1r4m2/index.jsp?topic=/com.ibm.java.doc.diagnostics.142j9/html/enabling_a_heapdump.html)

然后有一个名为 heaproot 的工具，可以让您查看这些转储中的内容。

找到对象的类型应该会让你找到罪魁祸首。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T00:17:22.723

根据您使用的 IBM JDK 的确切版本，有多种用于跟踪“大分配”的选项。区别主要在于实现，结果是当分配超过一定大小时记录 Java 堆栈跟踪（这应该有助于您追查罪魁祸首）。

“主权”1.4.2 SR4+： [http ://www-01.ibm.com/support/docview.wss?uid=swg21236523](http://www-01.ibm.com/support/docview.wss?uid=swg21236523)

“J9” 1.4.2（如果 Java 在 -Xj9 选项下运行）：您需要获取 JVMPI / JVMTI 代理以实现相同目的，我现在找不到此链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T10:00:10.697

只是一个提示......一旦我们有一个项目由于堆碎片而遭受主要的 GC 问题（Websphere 和 IBM JDK）。最后，我们添加了一个 JDK 开关来强制堆压缩。

Sun JDK 不倾向于有碎片堆，但 IBM JDK 由于不同的内存/GC 处理方式而存在。

试一试...我不记得魔法开关了。

# java - 比较十六进制和十进制值

> ID：713162
> 
> 赞同：2
> 
> 时间：2009-04-03T09:15:49.193
> 
> 标签：java, core

我有十六进制和十进制值存储的字节数组，我想在我如何在 java 中执行此操作中搜索十六进制 1 即 SOH，请提供示例代码。诠释 SOH=0X01；如果（SOH==1）

显示真实。这个对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T09:33:36.173

您的字节数组将只存储字节值。十六进制（或十进制或八进制）只是源代码中该值的表示。一旦存储，它们都是相同的值，例如

```
0x01 == 1 == 01 
```

（最后一个是八进制）

因此检查特定值是相同的代码。一个值不*知道*它是否被表示为十六进制/十进制/八进制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T09:23:08.147

字节数组中的数据如何存储为十六进制和十进制？字节数组包含字节。

```
        字节[] 十进制 = 新字节[] {1,10 };
        字节[] hexa = 新字节[] {0x1,0xa };

```

这些包含相同的值，您可以直接比较它们，您不需要任何特定的代码。

# php - 保护数据的最佳方法 PHP + MYSQL

> ID：713165
> 
> 赞同：1
> 
> 时间：2009-04-03T09:17:30.157
> 
> 标签：php, mysql, security, administration

我正在构建一个应用程序，它将存储我们的一些客户详细信息，例如用户名/密码，我们需要记住并保持安全的信息。

安全存储此信息的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T09:21:37.357

这样一个开放式的问题，没有太多细节可以继续。我建议您在进一步阅读之前阅读 Chris Shiflett 的优秀“ [Essential PHP Security ”。](https://rads.stackoverflow.com/amzn/click/com/059600656X)它简短、中肯且非常实用。

本书的网站[http://phpsecurity.org/也提供了合理数量的建议。](http://phpsecurity.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T10:24:56.690

# 使用 PHP 框架确保安全

如果您想在不进行大量研究的情况下快速获得 PHP 安全设置，那么 PHP 框架将是一个好主意。

我是[CodeIgniter](http://www.codeigniter.com)的粉丝，但其他选项包括[CakePHP](http://www.cakephp.com)和[Zend](http://framework.zend.com)。

使用安全框架意味着您可以立即获得经过验证的方法，但是学习该框架可能需要一些时间和精力。

[可以在 wikipedia 上找到 PHP 框架](http://en.wikipedia.org/wiki/List_of_web_application_frameworks)的完整列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-04T00:57:54.797

其实很简单。设置一个快速的 MySQL 数据库和一个用户表。在该用户表中，将用户名存储在一列中，并将密码的散列版本存储在另一列中。

作为增加的安全性，我喜欢生成一个随机的 8 个字符串并将其存储在每一行中 - 我称该列为“Keycode”。当用户使用正确的用户名/密码登录时，我将他们的身份验证存储在会话变量中作为匹配的“密钥代码”。

这样，session认证不仅可以查找正确的用户名/密码，还可以快速查询db，查看session变量中存储的“Keycode”是否与行中的keycode相同。

它运作良好，因为甚至用户都不知道他们的键码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T09:21:08.963

就密码而言，您应该存储密码的哈希值。每当您对用户进行身份验证时，您都会对他们输入的密码进行哈希处理，并将结果与​​您存储的内容进行比较。这样您就不会存储实际密码。

# web-services - 阻止任何人执行您的 Web 服务？

> ID：713173
> 
> 赞同：1
> 
> 时间：2009-04-03T09:20:49.043
> 
> 标签：web-services

我有一个通过 javascript (jquery) 执行以从数据库中检索数据的 web 服务。我想确保只有我的网页可以执行这些 web 方法（即我不希望人们直接执行这些 web 方法 - 例如，他们可以通过查看 javascript 的源代码来找到 url）。
我打算做的是向所有 webmethods 添加一个“Key”参数。密钥将存储在隐藏字段中的网页中，并且在请求网页时由网络服务器动态设置值。键值仅在 5 分钟内有效。这样，当需要执行 webmethod 时，javascript 会将密钥传递给 webmethod，webmethod 将在执行任何需要执行的操作之前检查密钥是否有效。
如果有人想直接执行 webmethods，他们将没有密钥，这将使他们无法执行它们。
您对此有何看法？有更好的解决方案吗？你预见到我的解决方案有什么问题吗？

更多信息：对于我正在做的事情，访问者没有登录，所以我不能使用会话。我知道如果有人真的想打破这一点，他们可以解析 html 代码并获取隐藏字段的值，但他们必须定期这样做，因为密钥每 x 分钟就会改变一次......这当然是可能的，但是希望对他们来说是一种痛苦。

编辑：我正在做的是一个网络应用程序（而不是一个网站）。数据通过网络方法（+jquery）检索。我想阻止任何人使用我的数据构建自己的 Web 应用程序（如果他们可以执行 Web 方法，他们可以这样做）。显然这对他们来说是一个风险，因为我可以随时更改网络方法。

我可能只会选择推荐人选项。它并不完美，但很容易实现。我不想花太多时间在这上面，正如你们中的一些人所说，如果有人真的想打破它，他们无论如何都会找到解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T09:26:58.717

好吧，这没有任何*技术*问题，但是您假设“他们没有使他们无法执行的密钥”是不正确的，因此整个事情的安全性是有缺陷的。

检索隐藏字段的值并使用它来执行方法非常简单。

我将为您节省大量时间和挫败感：如果用户的浏览器可以执行该方法，那么确定的用户就可以。你将无法阻止它。

话虽如此，有关您为什么尝试这样做的更多*信息*？上下文是什么？如果我们知道更多，也许还有其他可以实现您的目标的东西：）

编辑：那里没有更多信息，但我会用它来运行。您的解决方案根本不会真正提高安全性，并且会在维护和错误方面让您头疼。它还会让您的用户感到头疼，因为他们将有一个“不可见的”时间限制来执行页面上的操作。到目前为止，你已经告诉我们，我会说你最好什么都不做。

你想在这里保护什么样的方法？你为什么要保护他们？

ND

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T09:56:45.587

> 更多信息：对于我正在做的事情，访问者没有登录，所以我不能使用会话。

如果您向客户端发送一个密钥，他们将在每次他们想要使用服务时发回，那么您实际上是在创建一个会话。您来回传递的密钥在功能上与 cookie 没有什么不同（预计它只会在某些请求上传递回来。）还不如省去麻烦并设置一个将在 5 分钟内过期的临时 cookie。为过期的 cookie 添加一点服务器端检查，您可能会得到最好的结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T09:28:45.233

如果您使用设置会话 ID 的语言或框架，您可能已经拥有这样的密钥。使用 Ajax 调用发送它。（请注意，这样的会话持续时间超过五分钟，但还请注意，您使用它来为用户保持常规 HTPP 获取和发布的状态。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T09:27:21.290

什么可以阻止某人请求网页，解析结果以提取密钥，然后用它调用网络服务？

您可以检查引荐来源标头以检查呼叫是否来自您的一个页面，但这也很容易被欺骗。

我能看到解决这个问题的唯一方法是要求身份验证。如果您调用 Web 服务的网页要求用户登录，那么您可以检查他们在调用 Web 服务时是否已登录。这不会阻止其他页面使用您的网络服务，但它确实可以让您更多地跟踪使用情况，并且通过一些速率限制，您应该能够防止滥用您的服务。

如果您真的不想冒您的网络服务被滥用的风险，请不要将其公开。这是唯一的故障安全解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T09:28:35.717

假设您生成了一个从 12.00 到 12.05 有效的密钥。在 12.04 我打开页面，平静地阅读它，并在 12.06 我触发了使用您的 Web 服务的操作。即使我是合法访客，我也会被阻止这样做。

我建议限制通过 http 引荐来源网址访问 Web 服务（仅允许来自您的域和空引荐来源网址的人）和/或要求对调用方法进行用户身份验证。

# vb6 - 将 VB 表单/用户控件加载到 ActiveX 控件中

> ID：713177
> 
> 赞同：1
> 
> 时间：2009-04-03T09:21:54.517
> 
> 标签：vb6, activex

我在 VB 6.0 中开发了一个 ActiveX 控件。我的 ActiveX 控件中有一个占位符，我需要在其中加载在运行时使用 VB 6.0 开发的用户控件。用户控件必须是另一个 DLL/OCX 文件的一部分。

1.  如何在VB中动态加载用户控件？

2.  所有的用户控件都有一些共同的功能。我可以在基类中实现通用功能并在用户控件中只编写特定代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T18:58:51.150

1.  您可以像任何其他控件一样加载控件，使用`CreateObject`. 然后您必须将控件作为子控件分配给您的容器。（在标准的 VB6 表单中，您可以使用 . 来执行此操作`Controls.Add`。（请参阅[此](http://www.codeguru.com/vb/controls/vb_activex/activex/article.php/c3499)））

2.  这仅在一定程度上是可能的。COM/ActiveX 都是关于组合的，没有继承。您可以创建一个帮助类，它提供通用功能并由用户控件实例化和使用。

# c# - XmlSerializer 可以池字符串以避免大的重复字符串吗？

> ID：713178
> 
> 赞同：5
> 
> 时间：2009-04-03T09:22:19.240
> 
> 标签：c#, .net, xml-serialization, memory-management

我有一些非常大的 XML 文件，我使用`System.Xml.Serialization.XmlSerializer`. 它非常快（嗯，足够快），但我希望它汇集字符串，因为一些长字符串出现很多次。

XML 看起来有点像这样：

```
<Report>
    <Row>
        <Column name="A long column name!">hey</Column>
        <Column name="Another long column name!!">7</Column>
        <Column name="A third freaking long column name!!!">hax</Column>
        <Column name="Holy cow, can column names really be this long!?">true</Column>
    </Row>
    <Row>
        <Column name="A long column name!">yo</Column>
        <Column name="Another long column name!!">53</Column>
        <Column name="A third freaking long column name!!!">omg</Column>
        <Column name="Holy cow, can column names really be this long!?">true</Column>
    </Row>
    <!-- ... ~200k more rows go here... -->
</Report> 
```

XML 被反序列化的类看起来有点像这样：

```
class Report 
{
    public Row[] Rows { get; set; }
}
class Row 
{
    public Column[] Columns { get; set; }
}
class Column 
{
    public string Name { get; set; }
    public string Value { get; set; }
} 
```

导入数据时，会为每个列名分配一个新字符串。我知道为什么会这样，但根据我的计算，这意味着一些重复的字符串占导入数据使用的内存的大约 50%。我认为花费一些额外的 CPU 周期将内存消耗减少一半是一个很好的权衡。是否有某种方法`XmlSerializer`可以获得池字符串，以便丢弃重复项并在下次发生 gen0 GC 时回收？

* * *

另外，一些最后的说明：

*   我无法更改 XML 架构。它是从第三方供应商导出的文件。

*   我知道（理论上）可以使用 an`XmlReader`来制作一个更快的解析器，它不仅可以让我进行自己的字符串池，还可以在导入过程中处理数据，这样就不必将所有 200k 行都保存在 RAM 中，直到我已经阅读了整个文件。不过，我宁愿不花时间编写和调试自定义解析器。真正的 XML 比示例要复杂一些，因此这是一项非常重要的任务。如上所述 -`XmlSerializer`对于我的目的，它确实表现得足够好，我只是想知道是否有一种简单的方法可以稍微调整一下。

*   我可以编写自己的字符串池并在`Column.Name`setter 中使用它，但我不希望 (1) 这意味着摆弄自动生成的代码，以及 (2) 它会引发一系列与并发相关的问题和内存泄漏。

*   不，“池化”并不是指“实习”，因为这会导致内存泄漏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T09:40:38.543

就个人而言，我会毫不犹豫地手动启动实体 - 通过假设生成代码的所有权，或者手动执行（并摆脱数组;-p）。

重新并发 - 你可能有一个线程静态池？AFAIK，`XmlSerializer`只使用一个线程，所以这应该没问题。它还可以让您在完成后将游泳池扔掉。那么你可以有一个静态池之*类的东西，但是每个线程。*然后也许调整设置器：

```
class Column 
{
    private string name, value;
    public string Name {
       get { return this.name; }
       set { this.name= MyPool.Get(value); }
    }
    public string Value{
       get { return this.value; }
       set { this.value = MyPool.Get(value); }
    }
} 
```

静态`MyPool.Get`方法与用 .`HashSet<string>`装饰的静态字段（大概是`[ThreadStatic]`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T12:11:27.830

我建议你不要预先优化这个。等到它工作，分析结果，然后根据分析结果进行优化。您可能会发现首先要进行一些其他优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-30T18:01:51.200

我知道它的旧线程，但我找到了一个很好的方法：

以在返回值之前检查它是否存在于字符串池中然后返回它的方式创建`XmlReader`覆盖属性。`Value`

来自[msdn](https://docs.microsoft.com/en-us/dotnet/api/system.xml.xmlreader.value?view=netframework-4.7.2)的`Value`属性：`XmlReader`

> 返回的值取决于节点的 NodeType。下表列出了具有要返回值的节点类型。所有其他节点类型都返回 String.Empty。

例如，`Attribute` `NodeType`它返回属性的值。

因此，实现将如下所示：

```
public class StringPoolXmlTextReader : XmlTextReader
{
    private readonly Dictionary<string, string> stringPool = new Dictionary<string, string>();

    internal StringPoolXmlTextReader(Stream stream)
        : base(stream)
    {
    }

    public override string Value
    {
        get
        {
            if (this.NodeType == XmlNodeType.Attribute)
                return GetOrAddFromPool(base.Value);

            return base.Value;
        }
    }

    private string GetOrAddFromPool(string str)
    {
        if (str == null)
            return null;

        if (stringPool.TryGetValue(str, out var res) == false)
        {
            res = str;
            stringPool.Add(str, str);
        }

        return res;
    }
} 
```

如何使用：

```
using (var stream = File.Open(@"..\..\Report.xml", FileMode.Open))
{
   var reader = new StringPoolXmlTextReader(stream);
   var ser = new XmlSerializer(typeof(Report));
   var data = (Report)ser.Deserialize(reader);
} 
```

**性能：**我检查了具有随机列值的 200K 行的性能，我发现反序列化时间相同，`Report`内存从 78,551,460 字节下降到 48,890,016 字节（减少了约 38%）。

**笔记：**

1.  该示例继承自，`XmlTextReader`但您可以从任何继承`XmlReader`
2.  您还可以通过像这样覆盖 Value 属性将字符串池用于列值，`public override string Value => GetOrAddFromPool(base.Value);`但是当值不重复时（例如在我的测试中它们是随机的），它可以将反序列化时间增加约 20%。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T09:51:22.650

[`OnDeserializedAttribute`](http://msdn.com/library/system.runtime.serialization.ondeserializedattribute)如果您使用 DataContract 序列化程序（如 WCF 使用）而不是使用 XmlSerializer，则可以使用定义在反序列化实例后调用的方法。

或者，如果 XML 没有比示例复杂得多，那么为什么不通过 XmlReader 实现自己的反序列化。

# sql-server - 如何一次获取 sql 表中所有行的批处理？

> ID：713179
> 
> 赞同：2
> 
> 时间：2009-04-03T09:22:29.927
> 
> 标签：sql-server, batch-processing, row-number

我有一张有 4000 万行的表。
我想一次提取大约 200 万个并“处理”它们。
为什么？
处理超过 1000 万行的 Cos 处理会降低性能，并且经常超时。（我需要这个工作独立于数据大小，所以我不能一直增加超时限制。）
另外，我正在使用 SQL Server。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T09:26:33.473

是否有增加的密钥，例如身份密钥？它是聚集索引吗？如果是这样，跟踪你得到的最后一个键应该相当简单，并执行以下操作：

```
SELECT TOP 1000000 *
FROM [MyTable]
WHERE [Id] > @LastId
ORDER BY [Id] 
```

另外 - 一定要用类似的东西来阅读它`ExecuteReader`，这样你就不会缓冲太多的行。

当然，除了几千行之外，您还不如接受偶尔的往返，并一次请求（例如）10000 行。我认为这实际上不会降低效率（到处都是几毫秒）。

# c# - 将数据集导出到 Excel

> ID：713180
> 
> 赞同：0
> 
> 时间：2009-04-03T09:22:47.540
> 
> 标签：c#

如何将数据集导出到 Excel 2003 可以打开的文件？

你会详细说明吗？因为很难理解 CSV/TSV

马克你能给我们一个样本吗.v 现在只听说过 csv/tsv 术语

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T09:56:34.697

我想这会对你有所帮助。使用 http 处理程序

```
<%@ WebHandler Language="C#" Class="DownloadAllEvent" %>

using System;
using System.Web; 
using System.Data.SqlClient;
using System.Data;
using System.Text;
using System.IO;

public class DownloadAllEvent : IHttpHandler
{ 
    const int BUFFERSIZE = 1024;

    public bool IsReusable
    {
         get
    {
          return true;
    }
 } 

 public void ProcessRequest(HttpContext context) 
{ 
   HttpResponse response = context.Response; 
   HttpRequest request = context.Request; 
   response.BufferOutput = true;
   response.ContentType = "application/octet-stream";
   response.AddHeader("Content-Disposition", "attachment; filename=Events.csv");
   response.Cache.SetCacheability(HttpCacheability.NoCache);
   //string  csvfile = request.QueryString["csvfile"];
   string strNoofIds = request.QueryString["NoofIds"];
   // declare variables or do something to pass parameter to writecalEntry function

   writeCalEntry(response.Output, strguid, sectionid); 
  response.End(); 
 }

   public void writeCalEntry(TextWriter output, string[] strguid,string sectionid)
   {
        DataTable dt = createDataTable();
        DataRow dr;

        StringBuilder sbids = new StringBuilder();

        // process table if neeed.. use following code to create CSV format string from table

        string separator;      

        separator = ","; //default

        string quote = "\"";

        //create CSV file
        //StreamWriter sw = new StreamWriter(AbsolutePathAndFileName);

        //write header line

        StringBuilder sb = new StringBuilder();

        int iColCount = dt.Columns.Count;
        for (int i = 0; i < iColCount; i++)
        {
            //sw.Write(TheDataTable.Columns[i]);
            sb.Append(dt.Columns[i]);
            if (i < iColCount - 1)
            {
                //sw.Write(separator);
                sb.Append(separator);
            }
        }
        //sw.Write(sw.NewLine);
        sb.AppendLine();

        //write rows
        foreach (DataRow  tempdr in dt.Rows)
        {
            for (int i = 0; i < iColCount; i++)
            {
                if (!Convert.IsDBNull(tempdr[i]))
                {
                    string data = tempdr[i].ToString();
                    data = data.Replace("\"", "\\\"");
                    //sw.Write(quote + data + quote);
                    sb.Append(quote + data + quote);
                }
                if (i < iColCount - 1)
                {
                    //sw.Write(separator);
                    sb.Append(separator);
                }
            }
            //sw.Write(sw.NewLine);
            sb.AppendLine();
        }
        //sw.Close();
        UnicodeEncoding uc = new UnicodeEncoding();
        output.WriteLine(sb);

}

public static DataTable createDataTable()
{
    DataTable dt = new DataTable("EventsData");
    // create tables as needed which will be converted to csv format.
    return dt;
} 
```

调用此 httphandler 文件，您希望将数据导出为 Excel 格式

```
Response.Redirect("downloadFile.ashx"); 
```

您也可以在 Response.Redirect 中发送参数，这些参数可以在 .ashx 文件中获取。我想这会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T09:30:41.093

可能最简单的方法是将单个表导出为 csv/tsv。'网络上充满了这样的样本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T09:33:45.157

如果你想在 2003 年做，你已经晚了六年。;)

如果您通过“2003”表示其他意思，也许您可​​以澄清一下，人们可以给出更好的答案（尽管之前的答案导出为 CSV 是一个很好的答案）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T09:54:10.880

XML 电子表格可能是您正在寻找的。

看看[这个](https://stackoverflow.com/questions/668965/getting-data-from-c-to-excel-03-07/669011#669011)答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T09:56:43.403

我个人发现的最好方法是使用 XML 和电子表格组件。

示例代码太乱了，无法在此处发布，但从此处开始，看看它会导致什么：http: [//msdn.microsoft.com/en-us/library/aa140062.aspx](http://msdn.microsoft.com/en-us/library/aa140062.aspx)

# e-commerce - 网上商店：客户会回来重新下订单吗？

> ID：713184
> 
> 赞同：0
> 
> 时间：2009-04-03T09:24:51.263
> 
> 标签：e-commerce

最近我们网上商店的一个错误导致结帐时价格翻了一番。这导致订单在 19 小时内从大约 25 个下降到 2 个。我们为此损失了不少钱。我想知道的是：有什么方法可以衡量有多少“掉线”的客户会回来并重新下订单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T09:31:33.760

如果他们登录，他们的用户详细信息。如果没有，请将服务器日志中的 IP 地址、在价格翻倍期间未购买的 IP 地址与下周的 IP 地址进行比较，以获得粗略的了解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T01:52:24.527

我想说，如果你的产品好，你的客户就会回来。我想说现在是开始在您的网站上收集一些分析的好时机。你不会有太多可比较的地方，但它会是一个开始的地方。要判断您的客户是否回来，您可以比较问题前后的购买数据。我认为您将拥有某种类型的用户 ID，他们必须在购买时登录或输入。我们的网站都需要用户名才能登录，我们还提供访客结帐，这只是一个电子邮件地址，但如果需要，我们可以进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-04T02:00:06.393

非编程解决方案是为遇到问题的客户提供某种折扣或额外产品（如果他们完成订单）。这并不能帮助您找出有多少人因为您正在更改规则而回来，但它会帮助您损失一些损失的钱。

如果您有邮寄名单，请将特别优惠邮寄出去，或者将其放在您网站的某个地方。

要求他们再次填写订单的详细信息，如果它与该时间段内的先前订单匹配，则为他们提供特别优惠。

# wpf - WPF 与 Windows 窗体

> ID：713193
> 
> 赞同：4
> 
> 时间：2009-04-03T09:26:26.657
> 
> 标签：wpf, winforms

我对 WPF 和 Windows 窗体感到非常困惑。WPF 在 Windows 窗体上的用途是什么？WPF的用途是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T09:40:05.157

WPF 是一个用于为 Windows（和浏览器）开发应用程序的新平台。WPF 不一定要*替换*Windows 窗体。使用 WPF，可以更轻松地将 3D、视频和动画添加到您的应用程序中。因为它是基于[XAML](http://en.wikipedia.org/wiki/Extensible_Application_Markup_Language)的，所以也很容易绑定到 XML 数据，例如来自 web 服务的数据，并将其作为内容动态加载。

在我看来，WPF 还可以更好地将 UI 编程与业务逻辑分开。[让高级 WPF 设计人员使用Expression Blend](http://en.wikipedia.org/wiki/Microsoft_Expression_Blend)等工具构建您的 UI 会更容易，而您自己作为程序员，则更多地关注后端。这样，它更像是让 HTML 和 CSS 前端为您的网站创建一个漂亮的设计，而您在后端工作。

不过，Windows 窗体（就目前而言）有更多可用的第三方控件，如果您真的不需要 WPF 带来的东西，那么您当然不必*切换*到 WPF。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T09:37:44.663

你见过*[WPF 或 WinForms，明智地选择](http://weblogs.asp.net/bsimser/archive/2008/02/25/wpf-or-winforms-choose-wisely.aspx)*吗？

简而言之，WPF 是 Microsoft Windows 的下一个 UI 平台。它从以前的技术中吸取了很多教训，但风险在于工具和第三方组件的不成熟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T09:36:45.323

一个好处是关注点分离。您可以构建您的应用程序，而不必过多担心 UI 内容，如布局、颜色、字体等。然后您可以将其传递给可以使其看起来很棒（希望如此）的设计师，而无需了解代码（使用 Blend 或其他一些工具） ）。

从纯粹实用的角度来看，我对使用哪个框架的选择通常取决于我需要使用哪些第三方控件（尽管您*可以*在 WinForms 应用程序中使用 WPF 控件，例如 - 使用托管控件）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-13T13:46:15.753

我喜欢 WPF 的另一件事是核心图形处理已从 GDI+ 转移到 DirectX。当您使用 3D 或重型网格/时间序列绘图仪时，这会带来巨大的性能优势，因为它会尝试消耗您的 GPU（图形）资源而不是 CPU。

# javascript - 为什么 jqueryUI datepicker 会抛出错误？

> ID：713205
> 
> 赞同：3
> 
> 时间：2009-04-03T09:28:20.367
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-datepicker

我正在尝试 jqueryUI，但 firebug 在此脚本上捕获了以下错误：

```
$(function(){$("#date").datepicker()}); 
```

萤火虫错误显示：

```
$("#date").datepicker is not a function 
```

在我的 html 中，“日期”ID 如下所示：

```
<input type="text" name="date" id="date" > 
```

注意：我在该部分使用了正确的 JqueryUI css/js 脚本

什么都没有执行...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T09:35:57.133

[jQuery 文档](http://docs.jquery.com/UI/Datepicker)说您可以通过以下命令调用 datepicker：

```
$("#datepicker").datepicker(); 
```

如果您单击文档页面上的“查看源代码”按钮，您可以看到他们已将其包装到*ready*函数中：

```
$(document).ready(function(){
    $("#datepicker").datepicker();
  }); 
```

**编辑：**它应该与 INPUT 一起使用（感谢您指出 Steerpike）。这是我写的测试，它有效，你自己试试：

```
<html>
<head>
  <link type="text/css" href="http://jqueryui.com/latest/themes/base/ui.all.css" rel="stylesheet" />
  <script type="text/javascript" src="http://jqueryui.com/latest/jquery-1.3.2.js"></script>
  <script type="text/javascript" src="http://jqueryui.com/latest/ui/ui.core.js"></script>
  <script type="text/javascript" src="http://jqueryui.com/latest/ui/ui.datepicker.js"></script>
  <script type="text/javascript">
  $(document).ready(function(){
    $("#datepicker").datepicker();
  });
  </script>
</head>
<body>
  <input type="text" id="datepicker" value="this is a test">   
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T09:56:49.797

您几乎可以肯定没有正确加载 datepicker 插件。请向我们提供您用于包含 javascript 文件的代码。

如果您仍然遇到问题，请从 google api 加载 jquery 和 UI。

```
<link type="text/css" href="http://jqueryui.com/latest/themes/base/ui.all.css" rel="stylesheet" />

<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
    google.load("jquery", "1.3.2");
    google.load("jqueryui", "1.7.0");
</script> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-17T14:27:51.917

对我来说，这只是确保 jquery ui 是所有 js 包含列表中的最后一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T09:38:48.687

```
 $(document).ready(function(){
  // Your code here
 }); 
```

确保您的函数位于 .ready 主函数中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-14T06:40:28.397

这是一篇旧帖子，但我在寻找解决方案时来到这里，所以人们仍然阅读它；）我有或者更确切地说有同样的问题。就我而言，事实证明我以错误的方式在 html 中附加了 js（注意我以何种方式结束`script`标签）

错误的：`<script type="text/javascript" src="/fbo/js/jquery-ui-1.8.14.custom.min.js"/>`

好的：`<script type="text/javascript" src="/fbo/js/jquery-ui-1.8.14.custom.min.js"></script>`

当我以错误的方式做这件事时，我遇到了同样的错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T09:51:22.637

您可能正在加载prototype.js 或另一个使用$ 作为别名的库。

尝试用 jQuery 替换 $。

# sql - 可以在 select 语句的 where 部分中使用的 ORACLE SQL 函数

> ID：713214
> 
> 赞同：0
> 
> 时间：2009-04-03T09:30:39.097
> 
> 标签：sql, oracle

我想创建一个可以在 select 语句的 where 部分中使用的函数。像这样：

```
select 'x' from table where addNumber(4,3)=7; 
```

我知道如何在 MS SQL 中执行此操作，但我想执行此 Oracle SQL。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T09:34:48.837

您需要编写一个 PL/SQL 函数...

```
CREATE OR REPLACE FUNCTION addNumber(firstParam  IN NUMBER,
                                     secondParam IN NUMBER)
RETURN NUMBER
IS 
BEGIN
   RETURN firstParam + secondParam;
END;
/ 
```

...将其运行到您正在使用的方案中（可能使用 SQL*Plus），然后像在上面的 SQL 语句中那样调用它。

# svn - 区分大小写的颠覆问题

> ID：713220
> 
> 赞同：2
> 
> 时间：2009-04-03T09:31:38.407
> 
> 标签：svn

我今天发现了一个关于 Subversion 支持文件名区分大小写的问题。

我提交了一个名为“ClassOne.file”的类。另一个人提交了另一个文件“Classone.file”。除了文件名外，这两个文件完全相同。

当我进行 SVN 更新时，它显示错误，“无法添加，文件已存在”。我注意到在 SVN 存储库中，两个文件都存在，但我无法更新我的本地副本。它停在那里。

我所做的是删除其中一个，然后 SVN 更新照常恢复。SVN 服务器运行在 Linux 上，但我们的 PC 运行的是 windows。

我的问题：

*   这是SVN中的标准配置吗？
*   如何避免这种错误（除了强制每个人使用相同的文件命名约定）？

高级感谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T09:35:43.733

[http://svn.apache.org/repos/asf/subversion/trunk/contrib/hook-scripts/case-insensitive.py](http://svn.apache.org/repos/asf/subversion/trunk/contrib/hook-scripts/case-insensitive.py)

正是你需要的:)

把它扔进你的

```
/svnroot/<repos>/hooks/pre-commit 
```

文件和 BAM，问题将永远不会重复。

**回应评论**

您必须编辑存储库的挂钩；工作副本没有挂钩。在您的文件系统上找到您的存储库，然后在名为“hooks”的文件夹下，您将看到一个名为“pre-commit.tmpl”的文件，只需将其重命名为“pre-commit”并通过添加上面找到的代码对其进行编辑：）

# c# - 如何使用 CodeVariableDeclaraionStament 声明数组

> ID：713222
> 
> 赞同：0
> 
> 时间：2009-04-03T09:32:12.667
> 
> 标签：c#

```
CodeVariableDeclarationStatement cvds = new CodeVariableDeclarationStatement(p.ParameterType, p.Name,
                       new CodePrimitiveExpression(INTARR())); 
```

考虑上面的代码。当我在调试模式下运行我的项目时，这些是存储在 p.ParameterType 和 p.Name 中的值。

```
p.ParameterType = {Name = "Int32[]" FullName = "System.Int32[]"}
p.Name = "x" 
```

INTARR() 是一个返回整数数组的方法。

但我收到错误消息“无效的原始类型：System.Int32 []。考虑使用 CodeObjectCreateExpression。”

我如何为上述代码使用 CodeObjectCreateExpression，即我想在 CodeVariableDeclarationStatement 中传递一个整数数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T12:47:25.800

数组不是原始的。您需要使用 CodeArrayCreateExpression：

```
Int32[] ints = INTARR();
CodeExpression[] intExps = new CodePrimitiveExpression[ints.Length];
for (int i = 0; i < ints.Length; i++)
   intExps[i] = new CodePrimitiveExpression(ints[i]);
CodeVariableDeclarationStatement cvds = new CodeVariableDeclarationStatement(
   "Int32[]", "x", new CodeArrayCreateExpression("Int32", intExps)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T09:40:40.710

基于这个[链接](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/e2c984ae-93e4-4d3c-8086-cbcd877b4eec/)我认为应该是这样的

```
CodeVariableDeclarationStatement cvds = new CodeVariableDeclarationStatement(typeof(Int32[]), "x",
                       new CodePrimitiveExpression(INTARR())); 
```

所以也许这个？：

```
CodeVariableDeclarationStatement cvds = new CodeVariableDeclarationStatement(typeof(Int32[], "x",
                       new CodePrimitiveExpression(INTARR()));                     

p.ParameterType = typeof(Int32);
p.Name = "x"; 
```

# javascript - CSS中图像顶部的PNG图像有问题吗？

> ID：713232
> 
> 赞同：0
> 
> 时间：2009-04-03T09:36:01.533
> 
> 标签：javascript, html, css, image, png

我正在使用 jQuery 内容旋转器，我想将 PNG 图像放在图像顶部和该文本顶部。

这是我的旋转器在 HTML 中的样子：

```
 <div id="testimonials">
    <div class="slides">

    <div class = "testimonialContainer">
    <div class ="leesmeer"> <a href ="http://site/link"><img src ="http://site/afbeeldingen/test.jpg" ><div class="caption">LORUM IPSUM DOLOR SIT AMET </div></a></div>
    </div>

    <div class = "testimonialContainer">
    <p class = "testimonial"> 2 </p>
    <div class ="leesmeer"> <a href ="http://site/link"><img src ="http://site/afbeeldingen/test.jpg" ></a></div>
    </div>

</div>
</div> 
```

这是CSS：

```
.testimonialContainer {height: 123px}

    #testimonials{
    width: 210px;
    height: 125px;
    }

    .slides div{
    width: 210px;
    xheight:  25px;
    xpadding: 5px;

    .slides div.caption{
        background-image: url(../images/h_contentrotator_zwart.png);
        /*background-color:#000000;
        filter:alpha(opacity=60);
        -moz-opacity: 0.6;
        opacity: 0.6;*/
        color: #fff;
        width: 210px;
        height: 41px;
        position: relative;
        top: -24px;
        padding: 2px 20px 2px 10px;
        zbehavior: url("iepngfix.htc")
    } 
```

问题是PNG图像没有出现，文本也没有出现。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T09:40:01.977

您需要在最后一个选择器处添加一个点 (.)：

```
.slides div.caption{ 
```

现在它不存在，但应该存在。

如果添加点后问题仍未解决，则更具体。改变

```
.slides div.caption 
```

对此：

```
#testimonials a div.caption 
```

并从行为中删除 Z。

即使没有解决，也请给我一个 jQuery 脚本主页的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T14:18:00.467

确保您有正确的背景图像路径。如果样式在`<head>`HTML 页面中，则路径将相对于 HTML 页面。如果样式在外部样式表中，则路径将相对于样式表的文件位置。

您可能还希望首先在没有 Internet Explorer 6 PNG 修复的情况下使其工作，然后在您知道其余代码正确后重新添加修复。

# c# - 每次表单更改都必须更正表单设计器生成的代码命名空间

> ID：713241
> 
> 赞同：0
> 
> 时间：2009-04-03T09:38:34.383
> 
> 标签：c#, .net, winforms, intellisense, auto-generate

我有几种具有这种奇怪行为的表格。

例如，我有这个表单生成的代码。

```
namespace Sogyo.InHolland.SeriousGameFactory.GameCreator
{
    partial class FormAvatarResourceSetEditor
{
this.bindingSourceAvatarResourceSets.DataSource = typeof(SeriousGameFactory.Framework.ImageResource);
}
} 
```

在这种情况下，当我按下构建时，编译器会抱怨它无法识别“SeriousGameFactory.Framework.ImageResource”。（Intellisense 似乎无法在 SeriousGameFactory 命名空间中找到框架命名空间）

然后我手动将其更改为以下代码

```
using SeriousGameFactory.Framework;
namespace Sogyo.InHolland.SeriousGameFactory.GameCreator
{
    partial class FormAvatarResourceSetEditor
{
this.bindingSourceAvatarResourceSets.DataSource = typeof(ImageResource);
}
} 
```

现在项目构建。（奇怪！？？）但是，当我打开表单并使用它时，Visual Studio 会自动生成以下代码。

```
using SeriousGameFactory.Framework;
namespace Sogyo.InHolland.SeriousGameFactory.GameCreator
{
    partial class FormAvatarResourceSetEditor
{
this.bindingSourceAvatarResourceSets.DataSource = typeof(SeriousGameFactory.Framework.ImageResource);
}
} 
```

而且它再次无法编译。（Intellisense 似乎无法在 SeriousGameFactory 命名空间中找到框架命名空间）

有没有人对可能导致这种情况的原因有任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T09:58:57.827

您是否`SeriousGameFactory`在某个级别调用了冲突的类型/属性/方法/控件？这样就可以了...

# c# - 我应该将图像存储在数据库还是文件夹中？

> ID：713243
> 
> 赞同：25
> 
> 时间：2009-04-03T09:39:02.087
> 
> 标签：c#, asp.net, vb.net, image, file

> **可能重复：**
> [在数据库中存储图像 - 是还是不是？](https://stackoverflow.com/questions/3748/storing-images-in-db-yea-or-nay)

你好

目前，我网站上的每家公司都有一张可以添加到个人资料中的图片。我将该图像保存到数据库中……它是他们的公司徽标。

现在我想让他们添加更多图片。现在我不知道是否必须将其全部保存在数据库中或保存在文件夹中？？？？

我认为文件夹会更好的原因是因为有这么多漂亮的文章，我可以使用带有精美银光的功能，但所有这些文章都只适合保存在文件夹中的图像。

而且由于我不是那么好，因此我很难更改代码以查看数据库，而不是使用文件夹进行图像检索的示例。

我想在我的网站上添加这样的内容（浏览图片）。当图像保存在数据库中时，我有什么代码示例说明如何执行此操作？我正在将 ASP.NET 与 VB.net 一起使用。 [点击这里查看我在说什么](http://capetown.gumtree.co.za/c-Cars-for-Sale-cars-R35K-BMW-318i-E46-Motorsport-2004-W0QQAdIdZ118186301)

有什么想法吗？

问候艾蒂安

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-03T19:54:54.993

我最近和个人都这样做了；我更喜欢使用目录方法来存储图像，同时将它们的属性保存在数据库中。

主要原因：我有一个客户，我为他创建了一个网站。在网站上；有一个照片库部分允许用户上传新照片（可以从公共站点浏览）。由于我的客户在上传之前没有考虑过优化图像；*.jpg 超过 1mb。我确实实现了更新图像的能力（一旦将其保存到数据库中），但必须一次完成一条记录。

If this happens while storing the images in a directory, then the files can be saved locally, optimized and put back onto the server.

[Here is an example](http://www.aspnettutorials.com/tutorials/file/fileupload-vb.aspx)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-03T09:40:32.583

我会去找文件夹。如果存储空间不足（只需将它们移动到另一个磁盘并重新指向），则更灵活，其他应用程序（例如 Silverlight）的灵活性更高。我只会将 DB 用于必须安全的文件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-03T09:46:50.697

对于任何普通站点，您绝对希望它作为站点应用程序本身的一部分，而不是存储在数据库中。一个网站应该尽可能地自包含以保持它的可移植性，并且不添加到数据库的往返行程（即使在缓存的地方）只能是一件好事。Web 服务器*非常*擅长提供图像文件。

但是，我个人正在开发一个应用程序，其中图像是动态创建的，并通过第二个管理应用程序提供给站点。显然，这些必须以某种形式得到数据库支持，以保持图像的可维护性和安全性。

长话短说，如果图像具有商业价值（即它们是内容，它们需要安全性，或者它们是动态的），您将不得不将它们存储在数据库中。它们是静态的和微不足道的，让网站成为一个网站。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-03T14:50:39.233

对此有两个想法：

1.  使用文件系统。但请确保您的方案设计得足够好，以至于任何一个文件夹都不会被图像超载，并且管理起来简直就是一场噩梦。例如，您可以使用标识符的第一个或最后一个字母或随后的位置符号将其树出。您的里程会有所不同，因此请确保该方案适合您的数据集（图像）大小。如果您只管理 20 张图像，则无需详细说明。

2.  使用 SQL Server 2008。它有一个名为 filestream 的新数据类型，它会将图像保存到文件系统，但允许您通过标准数据库查询来检索它。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/cc949109.aspx](http://msdn.microsoft.com/en-us/library/cc949109.aspx)。

这些不是唯一的选择，但至少，我推荐选项#1，因为使用基于文件系统的方案而不是从数据库中存储和读取 blob 可以获得更好的性能。 .

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-04T19:46:15.927

I think saving images in system folders is the best way.
working with DB and Queries you know will cause some overloads and DB transanctions usually are heavy and it can place more stress on your server.
with the way u save images in folders and just put URLs in DB it is more suitable for your app loads.
but the advantage of DB is that you can BackUp your images.

* * *

My Suggestion: save your Images in folders. the only need is to know about system I/O operations.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-03T09:42:14.717

我通常使用的方法是将图像复制到文件夹并将相对 URL 保存在数据库中。这种方法的缺点是，如果有人删除了图像，您最终会在您的网页中出现“找不到图像”，除非您每次呈现页面时都进行检查。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-03T09:53:50.273

我会去。

首先，将每个图像存储为数据库中的 BLOB 列。通过这样做，您可以放心，该映像始终包含在您的数据库备份中（假设您这样做了）。

其次，将文件复制到文件夹中。通过这样做，您可以避免每次都查询数据库（对于图像文件）。单独存储在文件夹中可能会产生以下影响，例如

*   由于磁盘损坏而丢失的文件
*   文件不包含在备份操作中

到目前为止，我们所有的客户项目都采用相同的方法，我们遇到了各种问题，但没有丢失上传的文件。（我们正在谈论> 100GB的上传文件）。

请注意，您可能需要查看以下内容：

1.  确保无论何时更新/替换文件，都在数据库和文件夹上执行此操作。否则会不一致。
2.  您可能希望有一个单独的表来存储文件的信息。通常您可能希望存储以下内容：(1) 文件名 (2) 文件类型 (3) 文件大小/mime 类型
3.  您可能想要拆分存储数据的表。我们的做法是，一旦表达到 2GB，我们就创建另一个表。设计得当，找到合适的桌子应该没有任何问题。

希望这可以帮助。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-11T06:59:49.990

AFAIK, flickr.com goes with folders/file server as well with the reference,metadata,etc stored in db. See [flickr architecture](http://highscalability.com/flickr-architecture)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-03T09:45:40.997

我的网站也有同样的问题。我决定使用文件夹实现，因为如果您使用数据库，当您只想备份图片时，您应该备份整个数据库......另一方面，您可以保持目录结构，并轻松备份.

分开的东西我的朋友，最好的问候！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-03T09:48:29.333

使用文件夹的优点是您不需要自定义处理程序来从数据库中提取这些 BLOB 并将它们转换为常规流。从不同位置托管它们也更简单，您将避免数据库服务器的负担。

您必须小心存储路径名。相对路径名作为 URL 工作得更好，并允许您在存储它们的位置、提供它们的方式等方面具有一定的灵活性和扩展性。

# spam-prevention - 以编程方式检测色情图片的最佳方法是什么？

> ID：713247
> 
> 赞同：120
> 
> 时间：2009-04-03T09:39:51.557
> 
> 标签：spam-prevention

Akismet 在检测垃圾评论方面做得非常出色。但如今评论并不是垃圾邮件的唯一形式。如果我想要 akismet 之类的东西来自动检测社交网站上的色情图片，让用户上传他们的照片、头像等怎么办？

已经有一些基于图像的搜索引擎以及人脸识别的东西可用，所以我假设它不会是火箭科学，它可以完成。但是，我不知道这些东西是如何工作的，如果我想从头开始开发它应该如何去做。

我应该如何开始？

是否有任何开源项目可以解决这个问题？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-06-17T09:04:29.773

这实际上相当容易。您可以以编程方式检测肤色 - 色情图片往往有很多皮肤。这会产生误报，但如果这是一个问题，您可以传递通过实际审核检测到的图像。这不仅大大减少了版主的工作量，而且还为您提供了大量免费色情内容。这是双赢的。

```
#!python    
import os, glob
from PIL import Image

def get_skin_ratio(im):
    im = im.crop((int(im.size[0]*0.2), int(im.size[1]*0.2), im.size[0]-int(im.size[0]*0.2), im.size[1]-int(im.size[1]*0.2)))
    skin = sum([count for count, rgb in im.getcolors(im.size[0]*im.size[1]) if rgb[0]>60 and rgb[1]<(rgb[0]*0.85) and rgb[2]<(rgb[0]*0.7) and rgb[1]>(rgb[0]*0.4) and rgb[2]>(rgb[0]*0.2)])
    return float(skin)/float(im.size[0]*im.size[1])

for image_dir in ('porn','clean'):
    for image_file in glob.glob(os.path.join(image_dir,"*.jpg")):
        skin_percent = get_skin_ratio(Image.open(image_file)) * 100
        if skin_percent>30:
            print "PORN {0} has {1:.0f}% skin".format(image_file, skin_percent)
        else:
            print "CLEAN {0} has {1:.0f}% skin".format(image_file, skin_percent) 
```

此代码测量图像中心的肤色。我测试了 20 张相对温和的“色情”图片和 20 张完全无辜的图片。它标记了 100% 的“色情”和 20 个干净图像中的 4 个。这是一个相当高的误报率，但脚本的目标是相当谨慎，可以进一步调整。它适用于浅色、深色和亚洲肤色。

误报的主要弱点是棕色物体，如沙子和木头，当然它不知道“顽皮”和“漂亮”肉体之间的区别（如面部镜头）。

假阴性的弱点是没有太多裸露肉体的图像（如皮革束缚）、涂漆或纹身的皮肤、黑白图像等。

[源代码和示例图像](http://www.warriorhut.org/graphics/pornscanner/pornscanner.zip)

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-04-03T10:35:03.187

这是 2000 年写的，不确定色情检测的最新技术是否已经进步，但我对此表示怀疑。

[http://www.dansdata.com/pornsweeper.htm](http://www.dansdata.com/pornsweeper.htm)

> PORNsweeper 似乎有一定的能力将人的图片与非人的图片区分开来，只要图片是彩色的。在区分脏照片和干净照片方面不太成功。
> 
> 在默认的中等敏感度下，如果人力资源部向客户发送一张新员工的图片，您有大约 50% 的机会获得它。如果你的妹妹给你发一张她六个月大的照片，它也很可能被拘留。
> 
> 如果它们代表了软件的行为，那么指出有趣的错误是公平的，比如称蒙娜丽莎色情片。如果制造商承认他们的算法图像识别器会在 15% 的时间内丢球，那么当它确实如此时取笑它是愚蠢的。
> 
> 但 PORNsweeper 似乎只在一个部门达到了其规定的规格 - 检测实际色情内容。**它在检测色情方面还算不错，但在检测干净图片方面却很糟糕。如果在不久的将来在这一领域没有取得重大进展，我也不会感到惊讶。**

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-04-03T09:42:41.500

我宁愿允许用户报告不良图像。图像识别开发可能需要太多的精力和时间，并且不会像人眼那样准确。将审核工作外包要便宜得多。

看看：[亚马逊机械土耳其人](https://www.mturk.com/mturk/welcome)

*“ **Amazon Mechanical Turk** (MTurk) 是 Amazon Web Services 套件之一，这是一个众包市场，使计算机程序能够协调使用人类智能来执行计算机无法完成的任务。”*

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2011-05-28T16:53:50.747

*   [成人图像分类和过滤的视觉词袋模型](http://thomas.deselaers.de/publications/papers/deselaers_icpr08_porn.pdf)
*   [以编程方式检测色情图片的最佳方法是什么？](https://stackoverflow.com/questions/713247/what-is-the-best-way-to-programatically-detect-porn-images)
*   [色情检测/色情删除软件的简要调查](http://www.yangsky.com/products/porndetect/htm/surveypornremoval.htm)
*   [检测色情数字图像](http://www.naun.org/multimedia/NAUN/computers/20-462.pdf)（2011 年！）

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-12-05T23:20:49.037

繁荣！这是包含该算法的[白皮书。](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.96.9872&rep=rep1&type=pdf)

有谁知道在哪里可以获得 java（或任何语言）实现的源代码？

那会摇滚。

一种称为 WISE 的算法具有 98% 的准确率，但误报率为 14%。所以你要做的是让用户标记 2% 的误报，如果一定数量的用户标记它，最好自动删除，并让版主查看 14% 的误报。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2010-11-21T16:12:50.940

[Nude.js](https://github.com/pa7/nude.js/blob/master/nude.js)基于De La Salle 大学的 Rigan Ap-apid的[白皮书。](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.96.9872&rep=rep1&type=pdf)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-04-03T09:49:19.160

有软件可以检测色情的概率，但这不是一门精确的科学，因为计算机无法识别图片上的实际内容（图片只是网格上的一大组值，没有任何意义）。您可以通过举例来教计算机什么是色情，什么不是色情。这样做的缺点是它只能识别这些或类似的图像。

鉴于色情片的重复性，如果您以很少的误报训练系统，您就有很好的机会。例如，如果你用裸体人训练系统，它可能会将“几乎”裸体人的海滩图片标记为色情片。

类似的软件是最近问世的facebook软件。它只是专门针对面部的。主要原理是一样的。

从技术上讲，您将实现某种利用贝叶斯过滤的特征检测器。如果它是一个简单的检测器，或者只是计算当前图像与一组保存的色情图像的相似性，特征检测器可能会寻找像肉色像素百分比这样的特征。

这当然不仅限于色情片，它实际上更像是一个极端情况。我认为更常见的是试图在图像中找到其他东西的系统;-)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-04-03T10:37:08.267

答案很简单：可以肯定地说，在接下来的 20 年里这是不可能的。在此之前，我们可能会得到很好的翻译工具。上次我检查时，AI 人员在两张从稍微改变的角度拍摄的照片上难以识别同一辆车。看看他们花了多长时间获得足够好的 OCR 或语音识别。这些是识别问题，可以从字典中受益匪浅，尽管投入了数百万人工月，但仍远未找到完全可靠的解决方案。

话虽如此，您可以简单地添加“进攻性”？用户生成的竞争旁边的链接，并让 mod 交叉检查传入的投诉。

编辑：

我忘记了一些事情：如果您要实现某种过滤器，您将需要一个可靠的过滤器。如果您的解决方案 50% 正确，那么 4000 名具有良好图像的用户中有 2000 名将被阻止。期待愤怒。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-10-16T14:02:08.577

2004年，台湾成功大学的一名研究生对此课题进行了研究，他对从网上下载的裸照进行检测的成功率达到了89.79%。这是他的论文的链接：[基于肤色](http://etdncku.lib.ncku.edu.tw/ETD-db/ETD-search-c/getfile?URN=etd-0730104-131644&filename=etd-0730104-131644.pdf)
的裸人图像检测研究是中文的，如果看不懂，可能需要翻译。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-04-03T09:42:31.173

简短的回答：使用主持人；）

长答案：我不认为有这个原因的项目什么是色情？只有腿，全裸，侏儒等。它是主观的。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-04-03T12:35:33.880

添加攻击性链接并存储违规图像的 md5（或其他哈希），以便将来自动标记。

如果有人拥有一个大型的图像 md5 公共数据库以及作为 Web 服务运行的描述性标签，那该有多酷？很多色情片不是原创作品（因为现在拥有它的人，可能没有制作它）并且流行的图像往往会在不同的地方漂浮，所以这真的会有所作为。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-02-01T20:02:00.580

如果你真的有时间和金钱：

一种方法是 1) 编写图像检测算法来确定对象是否是人。这可以通过对图像进行位掩码以检索它的“轮廓”并查看轮廓是否适合人体轮廓来完成。

2）对大量色情图片进行数据挖掘，并使用C4算法或粒子群优化等数据挖掘技术来学习检测与色情图片匹配的模式。

这将要求您确定人体的裸体男人/女人轮廓必须如何以数字化格式显示（这可以通过与 OCR 图像识别算法相同的方式来实现）。

希望你玩得开心！:-)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-05-24T02:09:35.610

在我看来，主要障碍是定义“色情图片”。如果您可以轻松定义它，您可能会编写一些可行的东西。但即使是人类也无法就什么是色情达成一致。应用程序如何知道？用户适度可能是您最好的选择。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-03T10:01:43.640

我看过一个过滤色情图片的网络过滤应用程序，抱歉我不记得名字了。它很容易出现误报，但大多数时候它都在工作。

我认为主要技巧是检测“图片上的皮肤过多:)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-04-03T10:07:22.707

检测色情图片仍然是一项明确的人工智能任务，目前还非常理论化。

通过添加“报告垃圾邮件/滥用”按钮/链接来收获集体力量和人类智慧。或者雇用几个主持人来完成这项工作。

PS 真的很惊讶有多少人提出问题，假设软件和算法是万能的，甚至没有考虑他们想要的东西是否可以完成。他们是对硬件、底层编程和所有“背后的魔法”一无所知的新一代程序员的代表吗？

PS #2。我还记得时不时会发生某些情况，当人们自己无法确定一张照片是色情还是艺术品时，会被带到法庭上。即使在法庭裁决之后，仍有一半的人会认为该决定是错误的。上一次这种愚蠢的情况发生在最近，当时一个维基百科页面在英国被禁止，因为一张 CD 封面图片带有一些裸体。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-04-03T12:53:15.163

我能想到的两个选项（尽管它们都不是以编程方式检测色情内容）：

1.  阻止所有上传的图像，直到您的一位管理员查看它们。这没有理由花费很长时间：您可以编写一些软件，每秒显示 10 张图像，几乎就像一部电影一样——即使以这样的速度，人类也很容易发现潜在的色情图像。然后你倒回这个软件，仔细看看。
2.  添加通常的“将此图像标记为不适当”选项。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-09-29T06:35:20.633

BrightCloud [Web 服务 API](http://bcws.brightcloud.com)非常适合这一点。它是一个 REST API，用于像这样进行网站查找。它包含一个非常大且非常准确的网络过滤数据库，其中一个类别“成人”已识别出超过 1000 万个色情网站！

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-09-29T06:51:00.040

我听说过使用非常简单但非常有效的算法的工具。该算法计算了颜色值接近某些预定义“皮肤”颜色的像素的相对数量。如果该数量高于某个预定义值，则图像被认为是色情/色情内容。当然，该算法会对特写人脸照片和许多其他事物产生误报结果。
由于您正在撰写有关社交网络的文章，因此会有很多带有大量肤色的“正常”照片，因此您不应该使用此算法来拒绝所有具有正面结果的照片。但是您可以使用它为版主提供一些帮助，例如将这些图片标记为更高的优先级，

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-04-28T09:56:26.983

这个看起来很有希望。基本上，它们检测皮肤（通过识别面部进行校准）并确定“皮肤路径”（即测量皮肤像素与面部皮肤像素/皮肤像素的比例）。这有不错的表现。 [http://www.prip.tuwien.ac.at/people/julian/skin-detection](http://www.prip.tuwien.ac.at/people/julian/skin-detection)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-04-03T10:41:55.400

查看文件名和任何属性。几乎没有足够的信息来检测甚至 20% 的顽皮图像，但一个简单的关键字黑名单至少可以检测到带有描述性标签或元数据的图像。20 分钟的编码获得 20% 的成功率并不是一件坏事，尤其是作为一个预筛选，它至少可以捕捉一些简单的代码，然后将其余部分交给主持人进行判断。

另一个有用的技巧当然是相反的，维护一个图像源白名单以允许无需审核或检查。如果您的大多数图片来自已知的安全上传者或来源，您可以直接接受它们。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-12-05T23:24:33.257

> 今天我不会试图进一步定义我理解的那种简写描述[“硬核色情”]中包含的材料；也许我永远也无法理解地做到这一点。但我看到就知道了，而本案涉及的电影并非如此。

——[美国最高法院大法官波特斯图尔特，1964 年](http://en.wikipedia.org/wiki/I_know_it_when_I_see_it)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-01-01T19:51:19.833

您可以在网上找到许多涉及此主题的[白皮书。](http://scholar.google.ca/scholar?hl=en&q=An%20Algorithm%20for%20Nudity%20Detection%20&btnG=Search&as_sdt=0,5&as_ylo=&as_vis=0)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-01-19T12:13:15.887

这不是火箭科学。不再。它与人脸识别非常相似。我认为处理它的最简单方法是使用机器学习。由于我们正在处理图像，我可以指出神经网络，因为这些似乎是图像的首选。您将需要训练数据。你可以在互联网上找到大量的训练数据，但你必须将图像裁剪到你希望算法检测到的特定部分。当然，您必须将问题分解为您想要检测的不同身体部位并为每个部位创建训练数据，这就是事情变得有趣的地方。

就像上面有人说的那样，它不可能100％完成。会有这样的算法失败的情况。实际精度将取决于您的训练数据、神经网络的结构以及您将如何选择对训练数据进行聚类（阴茎、阴道、乳房等，以及这些数据的组合）。在任何情况下，我都非常有信心，对于明确的色情图像，这可以以高精度实现。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-08-07T16:25:45.263

这是一个裸体检测器。我没试过。这是我能找到的唯一一个 OSS。

[https://code.google.com/p/nudetech](https://code.google.com/p/nudetech)

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2009-04-03T10:20:41.503

用当今的知识，你不可能 100% 做到这一点（我会说 1-5% 可能是合理的）。你会得到更好的结果（比那些 1-5%）只需检查图像名称中与性相关的词:)。

@SO巨魔：如此真实。

# objective-c - 如何将 NSArray 写入 NSOutputStream？

> ID：713262
> 
> 赞同：1
> 
> 时间：2009-04-03T09:43:10.160
> 
> 标签：objective-c, cocoa, arrays, byte

我想发送一个 NSArray，所以我必须先将它写入 NSOutputStream。该方法应该是：

```
- (NSInteger)write:(const uint8_t *)buffer maxLength:(NSUInteger)length
```

我可以使用以下方法将数组的指针转换为 uint8 _ t：

```
(uint8_t *)arr
```

但是如何获取数组的字节长度呢？我是否必须将数组保存到文件中并将其作为 NSData 读出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T10:25:31.710

> 我可以使用以下方法将数组的指针转换为 uint8 _ t：
> 
> ```
> (uint8_t *)arr 
> ```

那只是一个演员表；它实际上并没有将数组转换为字节序列。即使您通过网络发送了数组的私有存储，数组的内容也只是其他对象的内存地址。你的进程中的内存地址在接收进程中几乎肯定是不一样的——假设接收进程正在运行 Cocoa 并且期待一个 NSArray！

您需要将数组的内容序列化为接收器能够处理的某些外部表示。您可以通过[转换为 plist](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSPropertyListSerialization_Class/)、创建[NSXMLDocument](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSXMLDocument_Class/)并[获取其数据](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSXMLDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/NSXMLDocument/XMLData)或手动组装自定义格式表示来做到这一点——但不能单独使用强制转换。

> 但是如何获取数组的字节长度呢？

数组不是一系列字节；它是一个对象。因此，它没有长度，只有（作为数组）其中的对象数。您需要一系列字节才能获得系列的长度。

> 我是否必须将数组保存到文件中并将其作为 NSData 读出？

您需要获取数组的外部表示，最好是在 NSData 对象中。告诉它将自身写入（plist）到一个文件并读回文件是一种方法，但还有更好的方法，我在上面列出了。

# asp.net - 打开网页，就像从网页中单击了链接一样

> ID：713263
> 
> 赞同：0
> 
> 时间：2009-04-03T09:43:18.927
> 
> 标签：asp.net, javascript

这个网址有一个网页：

[http://www.vankampen.com/Products/529Portfolios](http://www.vankampen.com/Products/529Portfolios)

此网页以默认选项“含销售费用”打开。此网页上有一个“不收取销售费用”的链接。当我们点击此链接时，网页会显示与“无销售费用”相关的选项。

我想打开“ [http://www.vankampen.com/Products/529Portfolios”URL](http://www.vankampen.com/Products/529Portfolios)，使用“不收取销售费用”选项而不是默认的“收取销售费用”选项。

将鼠标悬停在“无销售费用”上时，它显示正在调用以下函数： javascript:__doPostBack('ctl00$ctl00$ctl00$m_mainContent$m_secondaryContent$m_mainContent$list529Funds$ctrl1$withoutSalesCharge','')

如果可以使用“无销售费”选项而不是“有销售费”选项打开网页，有人可以建议我吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T18:24:37.783

我会说这取决于你到底想要做什么。

恐怕您无法避免回发，除非它们支持某些查询字符串变量或有办法在 cookie 中设置“首选项”或其他方式。这得自己想办法。

否则，这是一种标准的捕获/重放技术。您将不得不以某种形式和方式模仿用户操作。这意味着发送初始 GET 请求以提取所有表单字段，然后创建一个 POST 以模拟回发。

我想，在常规浏览器中执行此操作将具有挑战性。我不记得javascript是否允许设置标题和所有内容。我想您可以使用 MS 活动对象...但是，如果您的目标是在某些 .net 代码中提取数据，那么您可以相对容易地做到这一点。

有很多关于如何使用 HttpWebRequest 或 WebClient 进行屏幕抓取的示例，包括模拟登录等。我会使用 HttpWebRequest。发送 GET 请求、获取数据、保存 cookie、提取表单字段、创建 POST 请求、重新创建标头（包括正确的引荐来源）、形成正确的帖子正文、重新分配 cookie，您应该已经设置好了。

要查看需要发送的内容，我建议使用 Fiddler（带有 IE）。运行它，然后浏览到该页面，单击一个链接。该文件将向您显示有关初始请求和后续回发的所有流量和所有必要信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T11:21:17.303

我认为您不控制 www.vankampen.com 但想要“深层链接”到应用了正确设置的页面？

如果您获得该布局的唯一方法是通过表单提交，那么您需要尝试发布到服务器 - 但是，ASP.NET 通常会拒绝来自不同站点的回发 - 视图状态等将失败验证。

如果您确实可以访问 www.vankampen.com 的代码，那么您可以考虑提供一种机制来提供指向这些页面的直接链接，或者全部获取而不是发布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T11:30:49.743

使“有销售费用”和“无销售费用”可通过查询字符串访问。

然后你可以简单地做类似的事情

有销售费

[http://www.vankampen.com/Products/529Portfolios?settings=CS](http://www.vankampen.com/Products/529Portfolios?settings=CS)

或者

不含销售费用

[http://www.vankampen.com/Products/529Portfolios?settings=NCS](http://www.vankampen.com/Products/529Portfolios?settings=NCS)

# hibernate - Hibernate Validator：hbm2ddl 忽略 EmbeddedId 约束

> ID：713268
> 
> 赞同：6
> 
> 时间：2009-04-03T09:45:49.933
> 
> 标签：hibernate, validation, hbm2ddl

这里有一个相当具体的问题，但它已经困扰了我一天了：
我在 PostgreSQL 8.3 上使用 Hibernate Core、Annotations & Validator。

我有以下课程设置：

```
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public class Entry {
    @EmbeddedId
    protected EntryPK       entryPK;
    @ManyToMany
    private Set<Comment>    comments    = new HashSet<Comment>();
...

@Embeddable
public class EntryPK implements Serializable {
    @ManyToOne(cascade = CascadeType.ALL)
    private Database    database;

    @Length(max = 50)
    @NotEmpty
    private String      pdbid;
... 
```

我希望在我的 PostgreSQL 数据库中看到长度约束转换为长度约束（它适用于@Entity而不是@Embeddable's中的其他字段）但它似乎不想工作..
即使使用@IdClass代替@EmbeddedId 并在 @Entity 中的匹配字段上应用长度约束并没有解决这个问题：数据库字段仍然是 varchar 255（对于我的需要来说，大约 250 太大了）。
有人可能会说我不应该关心这个级别的细节，但是我的强迫症方面拒绝放手.. ;) 是否不可能在 EmbeddedId 中使用 Hibernate Validator Annotations 并让 hbm2ddl 将约束应用于数据库领域？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-10T08:00:19.053

不是答案。经历相同的行为。请作者识别以下代码是否与问题陈述一致。

实体和复合 ID 类。

```
@Embeddable
public class MyComposite implements Serializable {
    private static final long serialVersionUID = 5498013571598565048L;

    @Min(0)
    @Max(99999999)
    @Column(columnDefinition = "INT(8) NOT NULL", name = "id", nullable = false)
    private Integer id;

    @NotBlank
    @NotEmpty
    @Column(columnDefinition = "VARCHAR(8) NOT NULL", name = "code", length = 8, nullable = false)
    private String code;
    // plus getters & setters.
}

@Entity
@Table(name = "some_entity_table")
public class MyEntity {
    @EmbeddedId
    private MyComposite composite;

    public MyComposite getComposite() {
        return composite;
    }

    public void setComposite(MyComposite composite) {
        this.composite = composite;
    }
} 
```

类的单元测试

```
@Test
public void createWithIdOutOfRangeTest(){
    Exception exception = null;
    MyEntity input = new MyEntity();
    MyEntity output = null;
    MyComposite id = new MyComposite();
    // EITHER THIS
    id.setId(123456789);
    id.setCode("ABCDEFG");
    // OR THIS
    id.setId(12345678);
    id.setCode("        ");
    input.setComposite(id);
    try {      
      output = service.create(input);
    } catch (Exception e) {
      exception = e;
    }
    Assert.assertNotNull("No exception inserting invalid id !!", exception);
    Assert.assertTrue("There was some other exception !!", exception instanceof ConstraintViolationException);
} 
```

正如问题中所述，将无效值传递给复合键字段（`Hibernate-core:5.0.12`, `H2:1.4.196`）时，我没有遇到任何异常。测试失败。

# c# - 为什么这个特定的操作在 C# 中溢出（参见 CS0220）？

> ID：713271
> 
> 赞同：1
> 
> 时间：2009-04-03T09:47:41.130
> 
> 标签：c#, compiler-construction, overflow

我尝试构建一个大的 Int64，其中包含以字节为单位的半字节信息。

以下代码行按预期工作：

```
Console.WriteLine("{0:X12}", (Int64)(0x0d * 0x100000000));
Console.WriteLine("{0:X12}", (Int64)(0x0d * 0x1000000));
Console.WriteLine("{0:X12}", (Int64)(0x0d * 0x100000)); 
```

为什么下面这行会导致编译错误 CS0220 "The operation overflows at compile time in checked mode" 而其他行不会？

```
Console.WriteLine("{0:X12}", (Int64)(0x0d * 0x10000000)); 
```

结果将是：

```
FFFFFFFFD0000000 
```

代替：

```
0000D0000000 
```

谁能解释一下？我现在将使用移位运算符进行转换，但仍然很好奇为什么这种方法不起作用！

更新：使用 (Int64)(0x0d << 28) 时也会出现该错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T09:53:23.690

您需要将常量值专门标记为 long（Int64s）或可能的 ulongs（UInt64s），否则默认情况下它们将被解释为 int（即 Int32s），显然会导致溢出。在这种情况下，在乘法运算之后进行强制转换对您没有任何好处。

尚未测试，但此代码应该可以工作：

```
Console.WriteLine("{0:X12}", 0x0dL * 0x100000000L);
Console.WriteLine("{0:X12}", 0x0dL * 0x1000000L);
Console.WriteLine("{0:X12}", 0x0dL * 0x100000L); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T09:53:48.947

整数文字具有 Int32 类型（即使是十六进制）。使用“L”后缀使它们成为 long (Int64)。

```
Console.WriteLine("{0:X12}", 0x0dL * 0x100000000L); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-03T09:52:27.750

乍一看，我猜它是在用 Int32 进行乘法运算，然后溢出。您需要将各个操作数转换为 Int64，然后将它们相乘。现在你只是在投射结果。

也就是说，我不知道为什么它只会发现那一行而不是第一行的问题。

ND

# java - 使用来自 Javascript 的 Java 套接字检测 EOF / TCP 拆除

> ID：713276
> 
> 赞同：0
> 
> 时间：2009-04-03T09:48:30.443
> 
> 标签：java, javascript, http, sockets, tcp

我正在用 Javascript 创建一个 Java 套接字，发送一个 HTTP 请求并正确接收响应，但我似乎无法检测到 EOF 或服务器最后关闭了套接字。我究竟做错了什么？问题是我们永远不会退出最外层的while循环——服务器停止传输并且（可能）关闭它的连接端，但是receiver.read()永远不会返回-1，并且所有套接字方法都返回与套接字仍然连接的状态一致.

```
 var s = new java.net.Socket("www.google.com",80);
    var sender = new java.io.PrintStream(s.getOutputStream());
    var receiver = s.getInputStream();
    sender.print("GET / HTTP/1.0\r\n\r\n");
    sender.flush();
    s.shutdownOutput();
    var response = '';
    var eof = 0;
    while( !eof && s.isConnected() && s.isBound() && !s.isClosed() && !s.isInputShutdown() )
    {  
       if( receiver.available() )
       {
        while( receiver.available() )
        {
         var i = receiver.read();
         if( i == -1 ) { eof = 1; }
         else { response += String.fromCharCode(i); }
        }
        // at this point response does contain the expected HTTP response
       }
    }

    // in case remote end closed the socket before we got a chance to read all the bytes from it        
    // ...but this is never reached!
    while( receiver.available() )
    { 
      response += String.fromCharCode(receiver.read());
    }

    alert( response ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T09:54:51.707

这不是：

```
      同时（receiver.available（）&&！eof）

```

会更好？代替第一个 while(receiver.available()) ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T10:04:26.347

行。当代码到达此注释时，eof 的值是多少？
// 此时响应确实包含预期的 HTTP 响应

什么症状？我假设这是一个无限循环？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T12:40:25.613

好的，进一步的研究表明，没有非阻塞方式可以发现远程端是否关闭了套接字。但是，可以使用 NIO 通道来实现这一点：

```
 var s = new java.nio.channels.SocketChannel.open(new java.net.InetSocketAddress( "www.google.com",80) );
    //ew, but while we're prototyping...
    s.configureBlocking(true); 
    var sender = new java.io.PrintStream(s.socket().getOutputStream());
    sender.print("GET / HTTP/1.0\r\n\r\n");
    sender.flush();

    s.configureBlocking(false); // yayy!

    var response = '';
    var len = 0;
    var dbuf = java.nio.ByteBuffer.allocate( 1024 );
    while( len >= 0 )
    {    
         len = s.read( dbuf );
         dbuf.flip();
         while( dbuf.hasRemaining() )
         { 
           response += String.fromCharCode( dbuf.get() );
         }
         dbuf.clear();
    }

    alert( response ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T13:16:09.740

当到达流的末尾时，available() 返回 0，因此在您的代码中，您永远不会读取 -1

# c# - 通过c#找到用户选择的窗口的hwnd

> ID：713277
> 
> 赞同：1
> 
> 时间：2009-04-03T09:49:04.293
> 
> 标签：c#, parameters, window, hwnd

我已经编写了 ac# 程序，它以编程方式重现键盘敲击。我的想法是将这些键盘敲击传递给另一个应用程序，该应用程序可能有一个文本框设置为焦点。

所以在我的程序中，我希望用户选择我必须将键盘敲击重定向到的窗口。为此，我想知道一种我可以等待的方法，让用户选择必须发送键盘敲击的窗口，然后用户在我的应用程序上单击确定以确认，然后我的应用程序知道我必须在哪个窗口通过获取它的 hwnd 来控制。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T09:52:19.590

```
using System;
using System.Windows.Forms;
using System.Runtime.InteropServices;
using System.Text;

public class MainClass

    // Declare external functions.
    [DllImport("user32.dll")]
    private static extern IntPtr GetForegroundWindow();

    [DllImport("user32.dll")]
    private static extern int GetWindowText(IntPtr hWnd,
                                            StringBuilder text,
                                            int count);

    public static void Main() {
        int chars = 256;
        StringBuilder buff = new StringBuilder(chars);

        // Obtain the handle of the active window.
        IntPtr handle = GetForegroundWindow();

        // Update the controls.
        if (GetWindowText(handle, buff, chars) > 0)
        {
            Console.WriteLine(buff.ToString());
            Console.WriteLine(handle.ToString());
        }
    }
} 
```

# linq-to-sql - 如何配置。Linq DataContext（在 Class Lib Proj 中）在 Web 应用程序的 web.config 中使用连接字符串？

> ID：713280
> 
> 赞同：1
> 
> 时间：2009-04-03T09:51:02.370
> 
> 标签：linq-to-sql

我正在寻找有关如何在类库项目中配置 Linq DataContext 的解决方案，以便在 Web 应用程序的 web.config 中使用连接字符串。您的建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-11T11:13:41.777

我不确定这是否可以解决您的问题，但您必须在启动项目（为解决方案执行的项目）中创建 app.config（或我相信的 web.config）。单击项目，添加新的通用应用程序配置文件（在 app.config 的情况下）。

然后你必须添加一些内容。而已。

# c# - 枚举，委托字典集合，其中委托指向重载方法

> ID：713286
> 
> 赞同：2
> 
> 时间：2009-04-03T09:52:30.807
> 
> 标签：c#, .net

我有一个通用集合（字典），它存储一个枚举和委托。因此，如果用户将枚举值作为参数提供给方法，则集合中的相应委托将被执行。

委托所指向的这个方法被重载了。调用方法时，如何选择要执行的方法版本？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T10:06:24.143

委托只指向一个重载——而不是“方法组”。当您获得一个方法的委托时，您已经完成了重载决议。通常，您可以在编译器中执行此操作：

```
using System;
class Foo {
    int Bar() { return 1; }
    void Bar(int a) { }
    static void Main() {
        Foo foo = new Foo();
        Func<int> myDelegate = foo.Bar; // points to "int Bar()" version
    }
} 
```

如果问题与通过反射获取重载方法有关 - 那么您可以在`Type.GetMethod()`(as a `Type[]`) 的参数中指定模式。这应该给你你想要的方法。

要从 a 获取委托`MethodInfo`，请使用`Delegate.CreateDelegate`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T10:06:14.597

代表作为特定签名。当您使用具有重载的方法实例化委托时，它将使用其签名与委托签名最匹配的重载。

# c# - Configuration reading, should it be confined to client code?

> ID：713289
> 
> 赞同：0
> 
> 时间：2009-04-03T09:52:57.560
> 
> 标签：c#, .net, configuration

I'm just writing some data access code. I've decided to pass in the name of connection string from the config via constructor injection which the repository then reads and uses to construct a SqlConnectionStringBuilder.

Thinking about it I probably don't need the SqlConnectionStringBuilder but that's a different matter.

Should I be reading the configuration here or should that be confined to client code? Opinions?

```
public class SqlRepository : IRepository
{
    private SqlConnectionStringBuilder _connString;

    public SqlRepository(string connectionStringName)
    {
        var connStringSetting = ConfigurationManager.ConnectionStrings[connectionStringName];

        if (connStringSetting == null)
            throw new ArgumentException("Could not find connection string in configuration.");

        _connString = new SqlConnectionStringBuilder(connStringSetting.ConnectionString);
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T10:19:16.047

I'd perfer to pass an actual connection string (or even Dependency Inject it). Doing so helps maintaining [SoC](http://en.wikipedia.org/wiki/Separation_of_concerns) and [SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T10:22:21.033

Could different clients use different connection strings? If so I'd read the config in the client and pass it through. If all clients will require the same connection strinn then keep that information in the data layer.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T15:57:42.367

IF you pass the connection string into the DAL, you are making something out side of the data layer aware of the data base, which is a layer violation. Nothing outside of the DAL should have any knowledge of anything DB related, if you want to have the client set what connection string to use, then have them set the configuration, nothing more.

If you want to decouple the connection string use the factory pattern, and let it worry about what connection string to use, single responsibility principal. You can use dependency injection, config file, etc.

# php - php: file_get_contents 编码问题

> ID：713293
> 
> 赞同：8
> 
> 时间：2009-04-03T09:54:07.137
> 
> 标签：php, encoding, file-get-contents

我的任务很简单：向 translate.google.com 发出帖子请求并获取翻译。在以下示例中，我使用单词“hello”翻译成俄语。

```
header('Content-Type: text/plain; charset=utf-8');  // optional
error_reporting(E_ALL | E_STRICT);

$context = stream_context_create(array(
    'http' => array(
        'method' => 'POST',
        'header' => implode("\r\n", array(
            'Content-type: application/x-www-form-urlencoded',
            'Accept-Language: en-us,en;q=0.5', // optional
            'Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7' // optional
        )),
        'content' => http_build_query(array(
            'prev'  =>  '_t',
            'hl'    =>  'en',
            'ie'    =>  'UTF-8',
            'text'  =>  'hello',
            'sl'    =>  'en',
            'tl'    =>  'ru'
        ))
    )
));

$page = file_get_contents('http://translate.google.com/translate_t', false, $context);

require '../simplehtmldom/simple_html_dom.php';
$dom = str_get_html($page);
$translation = $dom->find('#result_box', 0)->plaintext;
echo $translation; 
```

标记为可选的行是那些没有输出相同的行。但是我得到了奇怪的字符...

```
������ 
```

我试过

```
echo mb_convert_encoding($translation, 'UTF-8'); 
```

但我明白了

```
ÐÒÉ×ÅÔ 
```

有谁知道如何解决这个问题？

更新：

1.  忘了说我所有的 php 文件都是用 UTF-8 编码的，没有 BOM
2.  当我将“to”语言更改为“en”时，即从英语翻译成英语，它可以正常工作。
3.  我不认为我正在使用的库搞砸了，因为我试图输出整个 $page 而不将其传递给库函数。
4.  我正在使用 PHP 5

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-03T10:28:13.170

试试看这篇文章是否可以帮助[CURL 导入字符编码问题](https://stackoverflow.com/questions/649480/curl-import-character-encoding-problem/649856#649856)

你也可以试试这个片段（取自 php.net）

```
<?php
function file_get_contents_utf8($fn) {
     $content = file_get_contents($fn);
      return mb_convert_encoding($content, 'UTF-8',
          mb_detect_encoding($content, 'UTF-8, ISO-8859-1', true));
}
?> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T10:31:36.377

首先，您的浏览器是否设置为 UTF-8？在 Firefox 中，您可以在 View->Character Encoding 中设置文本编码。确保您选择了“Unicode (UTF-8)”。我还将 View->Character Encoding->Auto-Detect 设置为“通用”。

其次，您可以尝试传递 FILE_TEXT 标志，如下所示：

```
$page = file_get_contents('http://translate.google.com/translate_t', FILE_TEXT, $context); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T10:34:36.463

*Accept-Charset*并不是那么可选。您应该在那里指定 UTF8。俄语字符在 ISO_8859-1 中无效

# spring - Equinox 中的 Jasper - 无法解析 jstl 核心 uri

> ID：713297
> 
> 赞同：2
> 
> 时间：2009-04-03T09:54:55.577
> 
> 标签：spring, jstl, osgi, equinox

我目前正在研究带有 Spring 的 OSGi，并通过[Pro Spring Dynamic Modules for OSGi](https://rads.stackoverflow.com/amzn/click/com/1430216123)中的几个示例进行工作。

我的示例网络应用程序有一个控制器，例如：

```
@Controller
public class HelloWorldController {
    private HelloWorldService helloWorldService;

    @RequestMapping(method = RequestMethod.GET)
    @ModelAttribute("helloworld")
    public HelloWorld home() {
        return this.helloWorldService.find();
    }

    // injected in - spring looks up the service from OSGi
    public void setHelloWorldService(HelloWorldService helloWorldService) {
        this.helloWorldService = helloWorldService;
    }
} 
```

视图解析器配置为：

```
<bean id="viewResolver"
  class="org.springframework.web.servlet.view.InternalResourceViewResolver">
  <property name="viewClass" 
    value="org.springframework.web.servlet.view.JstlView"/>
  <property name="prefix" value="/jsp/" />
  <property name="suffix" value=".jsp" />
</bean> 
```

调用 url`'http://localhost:8080/helloworld-web/spring/home'`应该会导致视图`jsp/home.jsp`被渲染，并`helloworld`包含一个 bean：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<html>
<head>
<title>Spring DM HelloWorld</title>
</head>
<body>
<p>Results from accessing Spring-DM service bundle:</p>
<p>Message <c:out value="${helloworld.message}" /></p>
<p>Current Time: <c:out value="${helloworld.currentTime}" /></p>
<p>Model Version: <c:out value="${helloworld.modelVersion}" /></p>
</body>
</html> 
```

但是，我看到以下堆栈跟踪：

```
org.apache.jasper.JasperException: The absolute uri: http://java.sun.com/jsp/jstl/core cannot be resolved in either web.xml or the jar files deployed with this application
    org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:51)
    org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:409)
    org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:116)
    org.apache.jasper.compiler.TagLibraryInfoImpl.generateTLDLocation(TagLibraryInfoImpl.java:317)
    org.apache.jasper.compiler.TagLibraryInfoImpl.<init>(TagLibraryInfoImpl.java:148)
    org.apache.jasper.compiler.Parser.parseTaglibDirective(Parser.java:424)
    org.apache.jasper.compiler.Parser.parseDirective(Parser.java:493)
    org.apache.jasper.compiler.Parser.parseElements(Parser.java:1557)
    org.apache.jasper.compiler.Parser.parse(Parser.java:127)
    org.apache.jasper.compiler.ParserController.doParse(ParserController.java:212)
    org.apache.jasper.compiler.ParserController.parse(ParserController.java:101)
    org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:156)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:296)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)
    org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:299)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:315)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
    org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:236)
    org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:257)
    org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1183)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:902)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:807)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:571)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:501)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:690)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:803) 
```

因为这是一个作为 OSGi 包部署的 WAR，所以它的`WEB-INF/lib`目录是完全空的。

我的理解是，jasper 的 OSGi 版本会在单个 Web 应用程序之外寻找 taglib 描述符和 JAR？

有没有其他人看过这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T11:03:36.363

一定是一些微妙的捆绑版本问题。我下载了这本书的[示例代码](http://www.apress.com/book/downloadfile/4259)，它使用了稍微不同版本的 jasper 等，现在它可以工作了。

[Spring-DM 参考](http://static.springframework.org/osgi/docs/1.1.2/reference/html/web.html#web:classpath:jsps:taglibs)说明：

> Spring-DM 扩展了 JSP 约定，通过检测捆绑类路径中定义的任何标签库（导入的包或所需的捆绑包），将标签库打包为 WEB-INF/lib 下的 jar 或解压到 WEB-INF/classes 下。

我做过的...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T22:37:36.460

什么包含您的 MANIFEST.MF（在 Import-package 和/或 Required bundle 中？）

```
Bundle-ManifestVersion: 2
Bundle-Classpath: .,
 WEB-INF/classes
Bundle-Version: 0.0.1.SNAPSHOT
Bundle-Name: iki-admin
Import-Package: javax.servlet,
 javax.servlet.http,
 javax.servlet.resources,
 [..]
 net.sf.navigator.taglib.el,
 [..]
 org.ikiproject.lib.exception,
 [..]
 org.springframework.web.servlet.tags,
 uk.ltd.getahead.dwr
Bundle-SymbolicName: org.ikiproject.admin
Web-ContextPath: iki-admin
Application-TraceLevels: *=info,org.ikiproject.*=verbose
Bundle-RequiredExecutionEnvironment: JavaSE-1.6
Require-Bundle: com.springsource.javax.servlet.jsp.jstl,
 com.springsource.org.apache.taglibs.standard,
 org.springframework.security.taglibs 
```

之后，您可能还会在使用 OSGi 的 jasper 和 apache-tomcat 版本时遇到一些问题。

# sql-server - SQL Server 防止脚本在错误的实例上运行

> ID：713305
> 
> 赞同：2
> 
> 时间：2009-04-03T09:57:37.720
> 
> 标签：sql-server, database, open-source, devtools

这不是一个编程问题，更多的是对工具一的建议:-)

我正在寻找一种方法来防止脚本意外地在错误的 sql server 实例上运行，也就是说，您不必运行该脚本来清除实时/生产环境中开发环境中的客户。

我基本上追求的是企业管理器（或用于管理 sql server 实例的不同应用程序）的插件，这将允许我定义 SQL server 实例的连接详细信息列表，以便当窗口连接到LIVE 环境，它可以通过将选项卡涂成红色，或者弹出一个消息框说“这已连接到 XXXX 实例。你确定”

除了形式非常小心之外，是否有人对可以执行此操作或任何远程模拟的工具/插件有任何想法？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T10:01:29.133

我所有的脚本都以此开头：

```
if exists (select 1 from dbo.environment where value in('production', 'qa'))
  return 
```

当然，这意味着我有一个环境表，其中有 'production' 、 'development' 、 'qa' 等，具体取决于它的托管位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T10:26:01.617

你去： [http ://www.ssmstoolspack.com/](http://www.ssmstoolspack.com/)

这个免费的 SSMS 插件为每个服务器提供窗口着色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T10:18:52.430

此 SQL 代码检查您是否在正确的服务器上：

```
if @@servername <> 'testserver'
  RAISERROR ( 'Wrong server', 16, 1 ); 
```

错误（或返回）将阻止执行，直到下一个 GO 语句。例如，以下仍然会打印 hello world，并删除 user 表：

```
RAISERROR ( 'Wrong server', 16, 1 );
go
drop table users
print 'Hello world!'
go 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T10:00:48.463

您可以为您通常使用的用户在您的实时实例上设置不同的（有限的）访问权限。然后使用不同的用户名在实时系统上做任何严肃的事情。

# c++ - C++ STL：数组可以透明地与 STL 函数一起使用吗？

> ID：713309
> 
> 赞同：24
> 
> 时间：2009-04-03T10:00:18.090
> 
> 标签：c++, arrays, stl

`vector`在我看到这段代码之前，我一直假设 STL 函数只能与 STL 数据容器（如 ）一起使用：

```
#include <functional>
#include <iostream>
#include <numeric>
using namespace std;

int main()
{
    int a[] = {9, 8, 7};
    cerr << "Sum: " << accumulate(&a[0], &a[3], 0, plus<int>()) << endl;
    return 0;
} 
```

它使用 g++ 编译和运行，没有任何警告或错误，给出正确的输出总和 24。

C++/STL**标准是否****允许**使用带有 STL 函数的数组？如果是的话，像数组这样的古老结构如何适应模板化迭代器、容器和函数的宏伟 STL 计划？此外，程序员应该**注意**这种用法的任何警告或细节吗？

 ***** * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-03T10:59:22.720

好吧，你问一个数组。您可以轻松地获得指向其元素的指针，因此它基本上归结为是否可以将指针与 STL 函数透明地使用的问题。指针实际上是最强大的迭代器。有不同的种类

*   **输入迭代器**：仅向前和单遍，并且仅读取
*   **输出迭代器**：只前向和单通，并且只写

* * *

*   **转发迭代器**：仅转发和读/写
*   **双向迭代器**：向前和向后，以及读/写
*   **随机访问迭代器**：一口气进退任意步，读/写

现在第二组中的每个迭代器都支持前面提到的所有迭代器的所有东西。指针模拟最后一种迭代器——随机访问迭代器。您可以添加/减去任意整数，并且可以读取和写入。除了输出迭代器之外，所有迭代器都有一个`operator->`可以用来访问我们迭代的元素类型的成员。

通常，迭代器有几个 typedef 作为成员

*   value_type - 迭代器迭代的内容 (int, bool, string, ...)
*   reference - 对 value_type 的引用
*   指针 - 指向 value_type 的指针
*   difference_type - 两个迭代器之间的距离的类型（由 返回`std::distance`）。
*   iterator_category - 这是一个标记类型：它被定义为一个表示迭代器种类的类型。要么`std::input_iterator_tag`，...，`std::random_access_iterator_tag`。算法可以使用它来重载不同类型的迭代器（比如`std::distance`随机访问迭代器更快，因为它可以只返回`a - b`）

现在，指针当然没有这些成员。C++ 有一个`iterator_traits`模板并专门用于指针。因此，如果您想获取任何迭代器的值类型，您可以

```
iterator_traits<T>::value_type 
```

无论是指针还是其他迭代器，它都会为您提供该迭代​​器的 value_type。

所以 - 是的，指针可以很好地与 STL 算法一起使用。正如其他人提到的，甚至`std::vector<T>::iterator`可以是`T*`. 指针甚至是迭代器的一个很好的例子。因为它非常简单，但同时又如此强大，以至于它可以在一个范围内迭代。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-03T10:05:21.667

该标准设计了迭代器，使其感觉和行为尽可能像指针。此外，由于迭代器基于模板，唯一相关的是迭代器类型定义了正确的运算符。结果是指针将开箱即用，就像随机访问迭代器一样。

事实上，一个可能的实现`std::vector<T>::iterator`就是把它变成一个`T*`.

当然，对于数组，您将没有找到有效迭代器范围的有用方法`begin()`和方法，但这就是 C 样式数组始终存在的问题。`end()`

编辑：实际上，正如评论和其他答案中提到的，如果数组不是动态的并且没有衰减为指针，您可以为数组实现这些函数。但我的基本观点是，您必须比使用标准容器时更加小心。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-03T14:13:11.150

简短的回答：STL 算法通常被定义为与各种迭代器一起使用。迭代器由它的行为定义：它必须可以用 * 解引用，它必须可以用 ++ 递增，以及各种其他也定义了它是哪种迭代器的东西（最常见的是随机访问）。请记住，STL 算法是模板，所以问题是语法之一。类似地，定义了 operator() 的类实例在语法上就像函数一样工作，因此它们可以互换使用。

指针完成了成为随机访问迭代器所需的一切。因此，它是一个随机访问迭代器，可以在 STL 算法中使用。您可以查看向量实现；您很可能会发现这`vector<whatever>::iterator`是一个`whatever *`.

这不会使数组成为有效的 STL 容器，但会使指针成为有效的 STL 迭代器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-03T10:37:42.057

> 标准是否允许使用带有 STL 函数的数组？

是的

> 如果是的话，像数组这样的古老结构如何适应模板化迭代器、容器和函数的宏伟 STL 计划？

迭代器的设计具有与指针相似的语义。

> 此外，程序员应该注意这种用法的任何警告或细节吗？

我更喜欢下一个用法：

```
int a[] = {9, 8, 7};
const size_t a_size = lengthof( a );
cerr << "Sum: " << accumulate( a, a + a_size , 0, plus<int>()) << endl; 
```

或者使用 boost::array 会更好更安全：

```
boost::array< int, 3 > a = { 9, 8, 7 };
cerr << "Sum: " << accumulate( a.begin(), a.end(), 0, plus<int>()) << endl; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T10:45:51.817

只是对 Mykola 的[回答](https://stackoverflow.com/questions/713309/c-stl-can-arrays-be-used-transparently-with-stl-functions/713323#713323)发表评论：

数组不是指针，即使它们很容易衰减为指针。编译器在数组上的信息比在容器上的信息多：

```
namespace array {
   template <typename T, int N>
   size_t size( T (&a)[N] ) {
      return N;
   }
   template <typename T, int N>
   T* begin( T (&a)[N] ) {
      return &a[0];
   }
   template <typename T, int N>
   T* end( T (&a)[N] ) {
      return &a[N];
   }
}
int main()
{
   int theArray[] = { 1, 2, 3, 4 };
   std::cout << array::size( theArray ) << std::endl; // will print 4
   std::cout 
      << std::accumulate( array::begin( theArray ), array::end( theArray ), 0, std::plus<int>() )
      << std::endl; // will print 10
} 
```

虽然您不能询问数组的大小，但编译器会在调用给定模板时解析它。

现在，如果你调用一个带 a 的函数`int a[]`（注意没有大小），这类似于定义一个`int*`参数，并且大小信息会丢失。编译器将无法确定函数内部数组的大小：数组已衰减为指针。

另一方面~~，~~如果您将参数定义为，`int a[10]`则信息将丢失~~，但您将无法使用不同大小的数组调用该函数。这与 C 版本完全不同，至少在 C99 之前最近没有检查 [*]。在 C 中，编译器将忽略参数中的数字，并且签名将等同于以前的版本。~~

@litb：你是对的。我有这个测试，但它是对数组的引用，而不是数组。感谢您指出。

```
dribeas@golden:array_size$ cat test.cpp 
void f( int (&x)[10] ) {}
int main()
{
    int array[20];
    f( array ); // invalid initialization of reference of type 'int (&)[10]' from...
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T10:49:54.367

而不是使用数组，然后担心将它们传递给 STL 函数（人们可能称之为“前向兼容性”，因此很脆弱），IMO 你应该使用 std::vector 并使用它的（稳定和可靠的）向后兼容的函数如果您需要使用数组，请使用数组。

所以你的代码变成：

```
#include <functional>
#include <iostream>
#include <numeric>
#include <vector>
using namespace std;

int main()
{
    vector<int> a(3);
    a[0] = 9;
    a[1] = 8;
    a[2] = 7;
    cerr << "Sum: " << accumulate(a.begin(), a.end(), 0, plus<int>()) << endl;
    return 0;
} 
```

如果您需要将“a”传递给 C API，您可以这样做，这要归功于向量与数组的二进制兼容性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-03T12:26:15.320

[介绍`boost::array`](http://www.boost.org/doc/libs/1_38_0/doc/html/array.html#array.intro)（一个简单的用于传统数组的模板化包装器，它还[定义了](http://www.boost.org/doc/libs/1_38_0/doc/html/boost/array.html)与 STL 兼容的迭代器类型和`begin()`/`end()`等）包含一些关于它们与 STL 兼容程度的有趣讨论。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-03T10:18:43.507

是的，这是故意的。迭代器可以实现为指针，因此您可以将指针用作迭代器。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-03T14:19:35.627

指针模型[Trivial Iterator](http://www.sgi.com/tech/stl/trivial.html)，来自数组的指针模型[Random Access Iterator](http://www.sgi.com/tech/stl/RandomAccessIterator.html)。所以是的，这是完全合法的。

如果您对每个 S(T)L 算法的使用约束感兴趣，请熟悉[迭代器模型](http://www.sgi.com/tech/stl/Iterators.html)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T10:05:03.383

由于 int a[] 可以被视为一个指针。在 C++ 中，指针可以递增并指向下一个元素。由于可以比较指针，因此可以将指针用作迭代器。

标准 24.1 部分中指出了对迭代器的要求。指针与他们相遇。这是其中的一些

> 所有迭代器 i 都支持表达式*i
> 
> 正如指向数组的常规指针保证有一个指针值指向数组的最后一个元素，所以对于任何迭代器类型，都有一个迭代器值指向对应容器的最后一个元素。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2011-03-14T03:13:18.180

STL 有它隐藏的东西。这大部分都归功于迭代器，请考虑以下代码：

```
std::vector<int> a = {0,1,2,3,4,5,6,7,8,9};
// this will work in C++0x use -std=c++0x with gcc
// otherwise use push_back()

// the STL will let us create an array from this no problem
int * array = new int[a.size()];
// normally you could 'iterate' over the size creating
// an array from the vector, thanks to iterators you
// can perform the assignment in one call
array = &(*a.begin());

// I will note that this may not be considered an array
// to some. because it's only a pointer to the vector.
// However it comes in handy when interfacing with C
// Instead of copying your vector to a native array
// to pass to a C function that accepts an int * or
// anytype for that matter, you can just pass the
// vector's iterators .begin().

// consider this C function
extern "C" passint(int *stuff) { ... }

passint(&(*a.begin())); // this is how you would pass your data.

// lets not forget to delete our allocated data
delete[] a; 
```

# mysql - MySQL mysql_tzinfo_to_sql 程序

> ID：713319
> 
> 赞同：11
> 
> 时间：2009-04-03T10:03:53.620
> 
> 标签：mysql

我在 microsoft windows xp 上使用 MySQL 5.0.51b。我正在尝试将数据从 zoneinfo 文件（由从[此处下载的库生成）加载到](ftp://elsie.nci.nih.gov/pub/)[此处](http://dev.mysql.com/doc/refman/5.0/en/time-zone-support.html)描述的数据库表中。

现在我无法找到我在哪里可以得到这个 Windows 的“ [mysql_tzinfo_to_sql](http://dev.mysql.com/doc/refman/5.1/en/mysql-tzinfo-to-sql.html) ”程序。我尝试在 mysql 命令行客户端上执行它，但没有成功。在 linux 上，您可以直接在 shell 上执行此命令。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-04-03T20:37:13.867

您不需要在 Windows 上运行**mysql_tzinfo_to_sql**。

对于 Windows，只需执行以下操作：

1.  下载文件。[链接在这里](http://dev.mysql.com/downloads/timezones.html)
2.  将它们移动到您的 MySQL 目录。例子：`C:\ProgramData\MySQL\MySQL Server 5.5\data\mysql`
3.  重新启动您的服务器。
4.  现在，如果你愿意，你可以像这样改变你的时区： `SET time_zone = 'America/Costa_Rica';`
5.  检查它 `SELECT NOW();`

* * *

更多信息： [MySQL](http://dev.mysql.com/doc/refman/5.0/en/time-zone-support.html)

看看这个：[回答](https://stackoverflow.com/questions/19023978/should-mysql-have-its-timezone-set-to-utc/19075291#19075291)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-01-04T19:08:55.410

命令“mysql_tzinfo_to_sql”在 Windows 上不起作用。您必须下载包含 SQL 语句的时区包，并使用“source”命令填充时区表，如下所示：

```
mysql> use mysql ;
mysql> source /path/to/file/timezone_posix.sql ; 
```

检查以下链接以供参考：

> 博客：[https ://discourse.looker.com/t/cannot-connect-time-zone-tables-dont-appear-to-be-loaded-in-mysql/208/6](https://discourse.looker.com/t/cannot-connect-time-zone-tables-dont-appear-to-be-loaded-in-mysql/208/6)
> 
> 脚本 sql: [http://downloads.mysql.com/general/timezone_2016a_posix_sql.zip](http://downloads.mysql.com/general/timezone_2016a_posix_sql.zip) , [http://downloads.mysql.com/general/timezone_2016a_leaps_sql.zip](http://downloads.mysql.com/general/timezone_2016a_leaps_sql.zip)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-01-05T00:13:03.877

对于 mysql 8，没有一个“填充文件”方法对我有用。

很多答案都包含此链接：[http](http://dev.mysql.com/downloads/timezones.html) ://dev.mysql.com/downloads/timezones.html 有包含 sql 文件的可下载 zip 文件。把它放到任何目录都没有帮助。一件事帮助了我：我发出了“使用mysql；” 并将可下载的 sql 文件的内容作为脚本执行。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-12-07T01:59:25.797

基于弗朗西斯科·科拉莱斯·莫拉莱斯的回答。

对于 Windows 10 机器上的 MySQL 5.7+，我的程序是

1.  [从https://dev.mysql.com/downloads/timezones.html](https://dev.mysql.com/downloads/timezones.html)下载 5.7+ 部分下的最新`POSIX Standard`时区脚本
2.  提取文件，然后会有一个名为的 SQL 文件`timezone_posix.sql`
3.  运行 sql 脚本，在我的情况下，使用下面的命令行

```
bin\mysql.exe --host=localhost --port=3306 --user=USERNAME -p mysql < c:\...\Downloads\timezone_2020d_posix_sql\timezone_posix.sql 
```

**注意**确保在`mysql`数据库/模式下运行时区脚本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T10:21:58.333

对于 Windows，MySQL 提供了一个已经加载的数据库供您下载并保存在您的数据目录中： http: [//dev.mysql.com/downloads/timezones.html](http://dev.mysql.com/downloads/timezones.html)

从用户对 MySQl 文档的评论中复制：

> Jyotsna Channagiri 于 2008 年 11 月 20 日下午 6:28 发布
> 
> 你好，
> 
> 我认为这些信息会帮助那些正在寻找更改 mysql 时区的人。
> 
> 步骤是：
> 
> 1.  [从http://dev.mysql.com/downloads/timezones.html](http://dev.mysql.com/downloads/timezones.html)下载时区表结构和数据
>     
>     
> 2.  将数据复制并粘贴到您的 Mysql/data/mysql 文件夹中
>     
>     
> 3.  重启你的mysql服务器。
>     
>     
> 4.  mysql> SET GLOBAL time_zone = '美国/多伦多';
>     
>     
> 5.  mysql> SET SESSION time_zone = '美国/多伦多';
>     
>     
> 6.  检查 SELECT @@global.time_zone ，@@session.time_zone ；它应该为您提供您之前设置的时区。

评论：

> 是的，但是 MySQL 提供的表已经过时（由 2006p 版本的 D olson 的时区库生成）。我需要最新的时区数据，因此我下载了最新的库并生成了二进制文件。现在我需要一种在 mysql 中加载这些表的方法。但我不知道如何在 Windows 上执行此操作。

啊，我明白了。然后你需要做两件事之一。1）获取执行此操作的工具并在 Windows 上编译它（或其他）。如果幸运的话，它是一个 perl 脚本。

2）在linux上填写数据库，然后复制到windows。[这家伙][ [http://it-idiot.einsamsoldat.net/2008/01/moving-mysql-database-from-windows-to-linux-redhat/comment-page-1/2]](http://it-idiot.einsamsoldat.net/2008/01/moving-mysql-database-from-windows-to-linux-redhat/comment-page-1/2])说可以，至少对于 MyIsam 而言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-02-08T16:33:50.020

```
mysql_tzinfo_to_sql /usr/share/zoneinfo | mysql -uadmin -ppassword mysql 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-23T08:38:03.903

我在**Windows 10上使用****XAMPP**和**PHP 7.4.27** ，并且在其他解决方案的工作中遇到了一些困难。

 **### 以下是我为使其正常工作而采取的步骤，这对我有用。

1.  在以下部分下载最新的[MySQL 社区下载](https://dev.mysql.com/downloads/timezones.html)POSIX 标准或带有闰秒的非 POSIX（如果您需要包含闰秒）时区脚本：

> 每个文件都包含用于填充表的 SQL 语句

2.  提取文件，它应该是一个名为 timezone_posix.sql 的 SQL 文件。
3.  在您选择的代码编辑器中打开提取的 SQL 文件并复制其内容。
4.  打开您选择的数据库管理工具，选择“mysql”表并在“SQL”选项卡下粘贴提取文件的内容。

> 注意：#4 以 PHPMyAdmin 为基础，其他管理工具可能会有不同的流程。

5.  单击“开始”，然后按照任何提示进行操作。
6.  所有需要的 time_zone 表都应填充时区数据

[![使用 PHPMyAdmin 执行 SQL 命令](https://i.stack.imgur.com/RQHtN.png)](https://i.stack.imgur.com/RQHtN.png)

# sql - Visual Studio 中自动生成的 sql 查询的质量

> ID：713322
> 
> 赞同：0
> 
> 时间：2009-04-03T10:04:46.270
> 
> 标签：sql, auto-generate, datatableadapters

我遇到了自动生成的删除语句的问题。在我看来，删除应该只是

```
DELETE [tablename] where [PK] = @param 
```

但它会生成一个带有 4 个 OR 的查询。

```
DELETE FROM Market
WHERE     (@IsNull_Name = 1) 
AND (Name IS NULL) 
AND (@IsNull_Description = 1) 
AND (Description IS NULL) 
AND (MarketId = @Original_MarketId) 
OR
(@IsNull_Name = 1) 
AND (Name IS NULL) 
AND (Description = @Original_Description) 
AND (MarketId = @Original_MarketId) 
OR
(Name = @Original_Name) 
AND (@IsNull_Description = 1) 
AND (Description IS NULL) 
AND (MarketId = @Original_MarketId) 
OR
(Name = @Original_Name) 
AND (Description = @Original_Description) 
AND (MarketId = @Original_MarketId) 
```

数据集工具几乎坚持查询涉及 PK/Indexes 为什么会生成如此复杂的代码？

这是“最佳实践”代码吗，如果有人可以引导我阅读一些文档吗？

当然，最简单的情况是需要 99% 的代码，另外 1% 应该是您需要编辑自动生成的代码或添加我们自己的代码的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T10:13:22.910

这是基于乐观并发 - 它需要在删除之前检查所有值是否相同。

# c# - 如何将 IntPtr 转换为字节 *

> ID：713324
> 
> 赞同：11
> 
> 时间：2009-04-03T10:05:06.753
> 
> 标签：c#

我正在通过返回`out IntPtr`参数的互操作调用方法。我怎样才能得到一个`byte*`这样`IntPtr`我就可以对它进行操作了？我尝试了以下方法：

```
fixed(byte* ptr = (byte)myIntPtr) 
```

但它没有用。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-03T10:09:50.297

你可以简单地写：

```
byte* ptr = (byte*)int_ptr; 
```

您不必使用*fixed*关键字。您不想固定 IntPtr，是吗？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-03T10:08:14.093

`myIntPtr.ToPointer()`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-20T07:40:06.590

我不想在我的应用程序中出现“不安全代码”，所以我执行以下操作将 IntPtr 转换为 byte[]。给定一个名为“unsafeDataBlock”的 IntPtr：

```
var byteArray = new byte[dataBlockSize];
System.Runtime.InteropServices.Marshal.Copy(unsafeDataBlock, byteArray, 0, dataBlockSize); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-24T03:02:02.787

这似乎对我有用，我没有使用 Interop，但仍在从 C Sharp 调用托管 C++ 函数。然而，托管 C++ 函数称为非托管代码，因此它完成了与 Interop 相同的事情。

无论如何，在从 c-sharp 调用的 C++ 函数中，我使用了以下代码：

```
(anyPointerType*) pointer = (anyPointertype*) myIntPtr.ToPointer(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T10:11:49.577

如果您不想在应用程序中使用不安全的代码，则必须使用 中的方法`System.Runtime.InteropServices.Marshal`，或者（甚至更好）声明互操作函数的参数类型，以便自动进行封送处理。

# asp.net - 使用 VB.Net 的标准 .net 2.0 Gridview 的分页问题

> ID：713326
> 
> 赞同：1
> 
> 时间：2009-04-03T10:05:58.590
> 
> 标签：asp.net, vb.net, gridview, .net-2.0, paging

我正在使用一个标准的 .net 2.0 Gridview，它使用 XMLDatasource 来填充网格。XMLDatasource 的 Data 属性是动态设置的，它允许 gridview 根据输入进行更改。

所有这一切都很好，但是我在分页时遇到问题......

我已将 AllowPaging 属性设置为“true”，并将 PageSize 属性设置为“10”。GridView 第一次在底部显示前 10 条记录和作为超链接的页数时填充良好，但是当我尝试单击任何页码以查看它们时，会弹出一个消息框，提示“未设置对象引用到一个对象的实例”

任何想法我做错了什么？还是有什么我错过的事情需要做？

当前使用的代码；

网格视图...

```
<asp:GridView ID="GridView1" 
      Runat="server" 
      DataSourceID="XmlDataSource1" 
      AutoGenerateColumns="False" 
      AllowPaging="True"
      style="width:100%; height:100%;"  
      EnableViewState="False">
<SelectedRowStyle BackColor="Red" />
<Columns>
   <asp:BoundField DataField="TYPE" HeaderText="TYPE" SortExpression="TYPE" />
   <asp:BoundField DataField="DESCRIPTION" HeaderText="DESCRIPTION" SortExpression="DESCRIPTION" />
</Columns>
</asp:GridView> 
```

XML数据源...

```
<asp:XmlDataSource ID="XmlDataSource1" runat="server" TransformFile="~/XML/grid2.xslt" EnableCaching="False">
</asp:XmlDataSource> 
```

设置 XMLDatasource 的 Data 属性的 vb.net 代码...

```
Private Sub btnTest_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnTest.Click

  XmlDataSource1.Data = _testLib.GetGridXML(_Num)
  GridView1.DataBind()
End Sub 
```

其中 _testLib.GetGridXML 是一个函数，它根据传入的 _Num 返回 XML 字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T17:42:05.983

没有看到你的代码很难说......我推测你有条件地分配数据，即：

```
If Not IsPostBack Then
   MyXMLDataSource.Data = "...some xml..."
End If 
```

在这种情况下，回发时它将为空，并且您会遇到异常。可能是别的东西，但话又说回来，没有代码......

**更新**

由于您添加了更多信息...

您必须在 Page_Load 上有类似上面的代码。既然你没有在这里提供它，我想你会这样做。如果不这样做，每次加载都会出现空引用异常。

考虑到这一点，您在某些按钮单击时分配数据，而不是在 PageIndexChanging 上分配数据。

单击按钮，页面加载，分配数据，网格显示它。然后你点击网格的下一个链接，页面再次加载，PageIndexChanging 被触发，你的点击事件没有——那么分配在哪里？

据我所知，要么**每次都**在 Page_Load 上分配 Data 属性，要么在**所有**后续事件中都这样做，即在页面更改、排序等时。

顺便说一句，您不必在以声明方式分配 XmlDataSource 时调用 DataBind。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T19:43:13.257

如果您对 PreRender 事件进行数据绑定，它应该可以工作

由于在 PageLoad 上设置 XML 数据源是动态设置的，因此在此阶段可能不存在所有页面元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T18:01:23.253

您是否正在实施 OnPageChanging 事件？通常您需要实现它并使用事件参数中的 e.NewPageIndex 属性在您的网格视图中设置它。

# xsd - 是否有任何免费使用 XSD (DTD) 用于 Rx 文档（药物处方）

> ID：713335
> 
> 赞同：3
> 
> 时间：2009-04-03T10:08:02.377
> 
> 标签：xsd, dtd

我想探索并可能使用（重用）开放 XML 格式/方案（DTD/XSD），用于由医生签发的**药物（药物）处方文件**（Rx），然后由持牌药剂师和健康保险公司处理。

是否有任何这样的免费 XSD 可用，在考虑和纳入医疗保健信息系统时我必须注意什么？

应使用哪些国际标准（ISO、ISO/IEC、EN）来实现最高水平的**互操作性**？

# c# - 比较 C# 中的数组

> ID：713341
> 
> 赞同：63
> 
> 时间：2009-04-03T10:10:17.927
> 
> 标签：c#, arrays

我正在尝试将两个数组相互比较。我尝试了这段代码并得到了以下错误。

```
static bool ArraysEqual(Array a1, Array a2)
{
    if (a1 == a2)
        return true;

    if (a1 == null || a2 == null)
        return false;

    if (a1.Length != a2.Length)
        return false;

    IList list1 = a1, list2 = a2; //error CS0305: Using the generic type 'System.Collections.Generic.IList<T>' requires '1' type arguments
    for (int i = 0; i < a1.Length; i++)
    {
        if (!Object.Equals(list1[i], list2[i])) //error CS0021: Cannot apply indexing with [] to an expression of type 'IList'(x2)
            return false;
    }
    return true;
} 
```

为什么我会收到这个错误？我选择了一个技术含量低的解决方案，效果很好，但我需要为每种类型复制/粘贴几次。

```
static bool ArraysEqual(byte[] a1, byte[] a2)
{
    if (a1 == a2)
        return true;

    if (a1 == null || a2 == null)
        return false;

    if (a1.Length != a2.Length)
        return false;

    for (int i = 0; i < a1.Length; i++)
    {
        if (a1[i] != a2[i])
            return false;
    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2009-04-03T10:18:46.110

如果您有可用的 LINQ 并且不太关心性能，那么最简单的事情如下：

```
var arraysAreEqual = Enumerable.SequenceEqual(a1, a2); 
```

事实上，可能值得用*Reflector*或*ILSpy*检查这些`SequenceEqual`方法的实际作用，因为无论如何它都可以针对数组值的特殊情况进行优化！

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2009-04-03T10:15:28.460

“为什么我会收到这个错误？” `using System.Collections;`- 可能，文件顶部没有“ ” - 只有“ `using System.Collections.Generic;`” - 但是，泛型可能更安全 - 见下文：

```
static bool ArraysEqual<T>(T[] a1, T[] a2)
{
    if (ReferenceEquals(a1,a2))
        return true;

    if (a1 == null || a2 == null)
        return false;

    if (a1.Length != a2.Length)
        return false;

    EqualityComparer<T> comparer = EqualityComparer<T>.Default;
    for (int i = 0; i < a1.Length; i++)
    {
        if (!comparer.Equals(a1[i], a2[i])) return false;
    }
    return true;
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-11-07T09:32:08.487

For **.NET 4.0** and higher, you can compare elements in array or tuples using the [**StructuralComparisons**](https://docs.microsoft.com/en-us/dotnet/api/system.collections.structuralcomparisons) type:

```
object[] a1 = { "string", 123, true };
object[] a2 = { "string", 123, true };

Console.WriteLine (a1 == a2);        // False (because arrays is reference types)
Console.WriteLine (a1.Equals (a2));  // False (because arrays is reference types)

IStructuralEquatable se1 = a1;
//Next returns True
Console.WriteLine (se1.Equals (a2, StructuralComparisons.StructuralEqualityComparer)); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-05-20T17:58:59.870

推荐 SequenceEqual 是可以的，但认为它可能比平常更快的 for(;;) 循环太天真了。

这是反映的代码：

```
public static bool SequenceEqual<TSource>(this IEnumerable<TSource> first, 
    IEnumerable<TSource> second, IEqualityComparer<TSource> comparer)
{
    if (comparer == null)
    {
        comparer = EqualityComparer<TSource>.Default;
    }
    if (first == null)
    {
        throw Error.ArgumentNull("first");
    }
    if (second == null)
    {
        throw Error.ArgumentNull("second");
    }
    using (IEnumerator<TSource> enumerator = first.GetEnumerator())     
    using (IEnumerator<TSource> enumerator2 = second.GetEnumerator())
    {
        while (enumerator.MoveNext())
        {
            if (!enumerator2.MoveNext() || !comparer.Equals(enumerator.Current, enumerator2.Current))
            {
                return false;
            }
        }
        if (enumerator2.MoveNext())
        {
            return false;
        }
    }
    return true;
} 
```

如您所见，它使用 2 个枚举器并触发大量方法调用，这严重减慢了一切速度。而且它根本不检查长度，所以在不好的情况下它可能会慢得离谱。

比较移动两个迭代器与美丽

```
if (a1[i] != a2[i]) 
```

你就会明白我所说的性能是什么意思。

它可以用在性能真的不是那么重要的情况下，可能是在单元测试代码中，或者在很少被调用的方法中的一些短列表的情况下。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-07-16T19:00:12.473

SequenceEqual 可以更快。即在几乎所有时间的情况下，两个数组确实具有相同的长度并且不是同一个对象。

它仍然与 OP 的功能不同，因为它不会默默地比较空值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-11T17:52:29.657

我知道这是一个老话题，但我认为它仍然是相关的，并且想分享一个数组比较方法的实现，我觉得它在性能和优雅之间取得了适当的平衡。

```
static bool CollectionEquals<T>(ICollection<T> a, ICollection<T> b, IEqualityComparer<T> comparer = null)
{
    return ReferenceEquals(a, b) || a != null && b != null && a.Count == b.Count && a.SequenceEqual(b, comparer);
} 
```

这里的想法是首先检查所有提前退出的条件，然后再使用`SequenceEqual`. 它还避免了额外的分支，而是依靠布尔短路来避免不必要的执行。我也觉得它看起来很干净，很容易理解。

此外，通过使用`ICollection`参数，它不仅仅适用于数组。

# interface - 需要有关 ASP.NET 中实际上是什么“接口”的信息

> ID：713342
> 
> 赞同：0
> 
> 时间：2009-04-03T10:10:36.363
> 
> 标签：interface

我正在度过一个“学习”的日子，我正在研究一个 ASP.NET 解决方案，以尝试学习构建应用程序的更高级技术（我仍处于新手阶段，所以请你回答得好像我很愚蠢:)...哈哈）。

我有几个问题...

1.）查看代码我看到了这个方法

**公共接口 Something()**

我以前从未见过“界面”？这有什么用途？你能指出我正确的方向以了解更多关于使用它的信息吗

2.）我一直在评论中看到这样的事情

```
<see cref="CoComment"/> 
```

我不确定这意味着什么？

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T10:19:26.997

抱歉，错过了您对评论的编辑。

您可以使用 /// 注释标记创建 XML 文档。

所以你可以拥有：

```
/// <summary>
/// Does something
/// </summary>
/// <see cref="something" />
public void DoSomething()
{
} 
```

然后可以使用它来生成 API 文档，很像 MSDN 格式。它也出现在 Visual Studio Intellisense 工具提示中，我觉得这非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T10:16:49.860

我不知道方法上的接口修饰符，只是用谷歌搜索过，什么也看不到。

它可能是一个大小写错误（并命名！）的返回类型吗？

IE。应该是：

```
public Interface Something(); 
```

因为它返回一个接口类型的对象？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T10:17:21.730

您可以将接口视为仅提供常量和方法原型声明的抽象类。然后类可以以与从其他类继承相同的方式实现接口。实现接口时，类必须实现接口中定义的所有方法：

```
public interface MyInterface
{
    void doSomething();
}

public class MyClass : MyInterface
{
    public void doSomething()
    {
    }
}

MyInterface obj = new MyClass();
obj.doSomething(); 
```

接口的优点之一是它们支持多重继承，这与 .NET 中的类不同。所以你可以实现几个接口，并且接口可以扩展几个其他接口。

.NET 中接口的命名约定是“ISomething”，因此如果符号以“I”开头，您可以猜到它是一个接口。此外，许多接口的名称以“-able”结尾，例如“IDisposable”或“ICloneable”。

该概念与 Java 中的概念相同，您可以[在 Wikipedia 上](http://en.wikipedia.org/wiki/Interface_(Java))阅读更多相关信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T10:19:47.963

这是 cref 的帮助：

[http://msdn.microsoft.com/en-us/library/cc837134.aspx](http://msdn.microsoft.com/en-us/library/cc837134.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T10:21:14.967

1）界面见： http: [//msdn.microsoft.com/en-us/library/87d83y5b (VS.80).aspx](http://msdn.microsoft.com/en-us/library/87d83y5b(VS.80).aspx)

2) `<see ...?`XML 文档标记见： http: [//msdn.microsoft.com/en-us/library/5ast78ax (VS.71).aspx](http://msdn.microsoft.com/en-us/library/5ast78ax(VS.71).aspx)

# php - ZF：登录表单验证

> ID：713344
> 
> 赞同：0
> 
> 时间：2009-04-03T10:10:56.520
> 
> 标签：php, zend-framework, validation

登录表单（Zend_Form）中显示错误消息“登录名/密码不正确”的最佳方式/代码是什么？

我慢慢开始明白，在 form/init() 中设置 $this->setErrorMessage('Login/password wrong') 是不够的，我必须让 Validators 能够看到我设置的消息。

我应该将此消息绑定到哪个对象，我是否必须使用验证器？谢谢！

更新：

登录操作（）代码：

```
$auth  = Zend_Auth::getInstance();
$authAdapter =
$this->_getAuthAdapter($formData['userName'],$formData['password']);
$result = $auth->authenticate($authAdapter);

if (!$result->isValid()) {
    //Problem: the line below doesn't display error message
    $form->addError('Username or password do not exist'); 
    $form->populate($formData);
    $this->view->form = $form; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T11:06:48.990

我通常只有两张支票来涵盖我的身份验证表格。

1.  检查用户名和密码，如果没有设置，显示类似“请同时输入用户名和密码”的消息

2.  使用 Zend_Auth 验证凭据并在它们无效时显示错误：“无效的用户名或密码”。

我通常只是将消息传递给变量中的视图，但您可能会发现[FlashMessenger](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelpers.flashmessenger)很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T11:32:40.333

我想你正在寻找`Zend_Form_Decorator_FormErrors`装饰师。由于默认情况下未注册此装饰器，因此`Zend_Form`您必须手动注册装饰器。

您必须在表单的`init()`方法中执行以下操作：

```
$this->setDisableLoadDefaultDecorators(true);
$this->setDecorators(array(
    'FormElements',
    array('HtmlTag', array('tag' => 'dl', 'class' => 'zend_form')),
    'FormErrors',
    'Form'
)); 
```

# sql-server-2005 - 从时间到默认日期时间的转换格式

> ID：713346
> 
> 赞同：0
> 
> 时间：2009-04-03T10:11:25.550
> 
> 标签：sql-server-2005

我有时间下午 1:00。我必须转换为格式“1/1/1900 01:00:00 PM”。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T10:15:13.157

```
select convert(datetime , "1/1/1900 " + "1:00 PM" , 101) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T10:13:44.080

**第 1**步：让我们获取日期并将其保存到 @Date 变量中。

```
DECLARE @Date DATETIME;
SELECT @Date = CONVERT(DATETIME, '1:00PM' , 100); 
```

现在@日期 = 1900-01-01 13:00:00.000

**第 2 步**：让我们将其转换为自定义格式

```
SELECT CONVERT(VARCHAR, @Date, 101) + ' '
       + REPLACE(LTRIM(SUBSTRING(CONVERT(VARCHAR, @Date, 131), 12, 14)),
       ':000', ' '); 
```

这将返回 '1/1/1990 1:00:00 PM'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T10:18:47.500

请参阅 sql server 在线书籍中的“CAST and CONVERT”

dd/mm/yy hh:mi:ss:mmmAM

您可能想要 131 但将其作为 varchar 返回

所以

```
SELECT CONVERT(VARCHAR(20),GETDATE(),131) 
```

# excel - dsolefile - 值不存在时的错误处理（在 excel 中）

> ID：713356
> 
> 赞同：0
> 
> 时间：2009-04-03T10:15:38.223
> 
> 标签：excel, vba, xls

我正在尝试更新文档属性并创建新条目（如果它们不存在）

但是这种类型的东西不起作用

```
Set objDocProps = DSO.GetDocumentProperties(sfilename:=FileName)

With objDocProps
If .CustomProperties("ABC") Is Nothing Then
'create it here 
```

如果我在那里放置一个错误处理程序，它会被锁定或失去连接

```
errhandler:
Select Case Err.Number
 Case -2147220987 ' missing custom property
 Debug.Print "missing custom property"
 With objDocProps
     .CustomProperties("ABC").Value = "banana!" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-05T00:58:02.103

您可以将`CustomDocumentProperties`集合用于适当的 Excel 工作簿吗？然后，您可以遍历集合并在找到该属性时对其进行编辑。如果它不存在，您可以创建该属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T11:49:51.127

尝试按名称访问 CustomProperties 时似乎存在问题。

我实现的解决方案是迭代 CustomPropery 集合以确定项目的索引（如果存在），然后使用它来设置值（或者如果不存在则添加一个新的）

传入：您的自定义属性对象，您希望填充的条目以及您希望填充它的值

```
Sub UpsertEntry(objCustomProps, entryname, entryvalue)
  'update the custom property with value supplied
  On Error Resume Next

  Dim icount 
  Dim iindex 

  For icount = 1 To objCustomProps.Count

    If objCustomProps.Item(icount).name = entryname Then
      iindex = icount
      Exit For
    Else
      iindex = 0
    End If

  Next

  If iindex = 0 Then 'no custom property found

   objCustomProps.Add entryname, entryvalue
   Wscript.Echo " Adding   [" & entryname & ":" & entryvalue & "]"
  Else
   objCustomProps.Item(iindex).Value = entryvalue
   Wscript.Echo " Changing [" & entryname & ":" & entryvalue & "]"

  End If
  On Error GoTo 0

End Sub 
```

# c# - 向窗口句柄发送消息

> ID：713371
> 
> 赞同：2
> 
> 时间：2009-04-03T10:20:08.120
> 
> 标签：c#

我正在运行一个 exe，通过它我可以获得另一个 exe 中的控件句柄。现在我想做的是从我的 exe 向特定句柄发送消息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T10:43:11.840

您需要使用以下方法导入函数：

```
[DllImport("user32.dll")]
public static extern int SendMessage(
                  int hWnd,      // handle to destination window
                  uint Msg,       // message
                  long wParam,  // first message parameter
                  long lParam   // second message parameter
                  ); 
```

并定义您要发送的消息，例如：

```
public const int <WM_YOURMESSAGE> = <yourvalue>; 
```

然后像任何其他函数一样调用 SendMessage。

# asp.net - 您如何创建文件夹并同时指定对它们的访问权限？

> ID：713377
> 
> 赞同：1
> 
> 时间：2009-04-03T10:21:18.553
> 
> 标签：asp.net, iis, filesystems

我有一个 Windows 窗体应用程序，它用作 ASP.NET Web 应用程序的一种管理模块。Web 应用程序为多个国家/地区提供服务，并在将新国家/地区添加到应用程序数据时创建文件夹。

不幸的是，在新添加的国家/地区，当我尝试在文件夹中写入文件时，Web 应用程序遇到了异常：

```
System.UnauthorizedAccessException: Access to the path 'C:\...' is denied. 
```

对于使用 ASP.NET 模拟的 Web 应用程序，很明显默认 IIS 用户 (MACHINENAME\IUSR_MACHINENAME) 没有写入文件夹的权限。

如何在创建文件夹时授予默认 IIS 用户权限？

我明白那个

```
System.IO.Directory.CreateDirectory(string path, DirectorySecurity directorySecurity) 
```

应该这样做，但我不明白如何在`DirectorySecurity`对象上指定登录名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T10:56:21.980

将创建目录和文件（读/写/修改/...）的权限授予工作进程组 ( `sysname\iis_wpg`) 到您要在其中创建新目录的父目录。确保您已设置要应用到`this folder, subfolders, and files`的权限，然后您创建的新文件夹的权限将被继承，您无需专门应用它们。我建议不要对所有 App_Data 执行此操作，而是创建一个特定的子目录并仅授予对该子目录的权限。如果您在盒子上运行了多个应用程序，您可能希望为该应用程序创建一个新用户来运行，更改工作进程组的 ID，并仅向该特定用户授予权限。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-15T11:35:43.817

这是我最终使用的解决方案：

```
 if (!Directory.Exists(path))
        {
            Directory.CreateDirectory(path);
            DirectoryInfo info = new DirectoryInfo(path);
            DirectorySecurity security = info.GetAccessControl();

            security.AddAccessRule(new FileSystemAccessRule(logonName, FileSystemRights.FullControl, InheritanceFlags.ContainerInherit, PropagationFlags.None, AccessControlType.Allow));
            security.AddAccessRule(new FileSystemAccessRule(logonName, FileSystemRights.FullControl, InheritanceFlags.ObjectInherit, PropagationFlags.None, AccessControlType.Allow));

            info.SetAccessControl(security); 
        } 
```

# wpf - WPF 应用程序因 System.MissingMethodException 而失败

> ID：713384
> 
> 赞同：1
> 
> 时间：2009-04-03T10:23:17.973
> 
> 标签：wpf, .net-3.5

我制作了一个使用 Web 服务的 WPF 应用程序。它在除开发机器之外的所有计算机上都失败，并显示消息 -- System.MissingMethodException。我猜它失败的地方是它试图访问远程网络服务（网站）的地方。

有没有人有过 WPF 和 web 服务的经验？我应该再花 2 天时间将它移植到 .Net Winforms，还是应该继续尝试让它运行？

问题是，在 Vista 中，我看到的只是“此应用程序遇到错误并将关闭”，而在 XP 中，我只是一个系统错误对话框，我无法指出错误在哪里。

我的猜测是我的 PC 上有一些 DLL，而不是其他人的 PC 上缺少导致错误的方法。

我使用 .Net 3.5 制作了这个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T10:31:46.237

事实上，您已经确定了问题的最可能原因：您的开发机器上安装的库与生产机器上安装的库不匹配。

您可以使用 fuslogvw.exe 启用 Fusion 以记录绑定错误。

还要检查您是否在所有地方都安装了相同（版本）的 .NET 框架（SP1？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T10:32:08.543

你用过SP1吗？目标机器上是否安装了 SP1？

获得完整的堆栈跟踪将使您能够进一步诊断。

# apache-flex - DDD 和客户端/服务器应用程序

> ID：713389
> 
> 赞同：4
> 
> 时间：2009-04-03T10:25:02.540
> 
> 标签：apache-flex, silverlight, domain-driven-design, client-server

我想知道你们中是否有人在客户端/服务器应用程序中成功实现了 DDD，并想分享一些经验。

我们目前正在开发 Flex 的智能客户端和 Java 的后端。在服务器上，我们有一个向客户端公开的服务层，它提供 CRUD 操作以及其他一些服务方法。我知道在 DDD 中，这些服务应该是存储库，并且服务应该用于处理不适合存储库的用例。现在，我们在接口后面的客户端上模拟这些服务，并通过 IoC 容器注入实现（Webservices、RMI 等）。

所以出现了一些问题：

*   服务器应该向客户端公开存储库还是我们需要某种外观（例如能够处理安全性）
*   客户端是否应该实现存储库（以及一般的 DDD？）知道在客户端中，大部分逻辑与视图相关，而真正的业务逻辑存在于服务器上。与服务器的所有通信都是异步发生的，我们在客户端上有一个单线程编程模型。
*   如何将客户端映射到服务器对象，反之亦然？我们尝试了 DTO，但又恢复为公开对象的状态并直接映射到它们。我知道这被认为是不好的做法，但它为我们节省了大量时间）

总的来说，我认为新一代应用程序将随着 Flex、Silverlight、JavaFX 的发展而出现，我很好奇 DDD 是如何融入其中的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-05T20:44:11.317

1.  我不会直接向客户端公开存储库。您提到的第一个大问题是安全性：您不能信任客户端，因此您不能将数据访问 API 暴露给潜在的敌对客户端。
2.  使用服务器上的服务包装您的存储库，并在处理远程通信的客户端中创建一个瘦委托层。
3.  暴露您的实体不一定是一种不好的做法，只是当您开始考虑延迟加载、通过客户端不需要的线路发送数据等因素时，它会变得有问题。如果您编写一个包装一个或更多实体和委托 get/set 调用实际上可以非常快速地构建 DTO 层，尤其是使用大多数 IDE 中可用的代码生成。

所有这一切的关键在于，一组模式实际上应该只适用于应用程序的一部分，而不是整个应用程序。您在域模型中拥有丰富的逻辑并使用存储库作为 DDD 的一部分进行数据访问这一事实不应以任何方式影响客户端。从概念上讲，我构建的 RIA 具有三层：

1.  客户端使用诸如 MVC、MVP 或 MVVM 之类的东西来呈现 UI。模型层最终调用...

2.  我可以称之为“集成层”。这是客户端和服务器上都存在的服务和数据对象的合同，以允许两者进行协调。通常，UI 设计驱动这一层，以便 (A) 仅将客户端需要的数据传递给它，并且 (B) 数据访问可以是粗粒度的，即“对这组所需的所有状态进行一个方法调用用户界面。

3.  服务器使用任何它想要处理的业务逻辑和数据访问。这可能是 DDD 或更老派的东西，例如使用数据库中的存储过程和大量“ResultSet”或“DataTable”对象构建的数据层。

关键是客户端和服务器都是非常不同的动物，它们需要独立变化。为了做到这一点，您需要一个介于 UI 需求和服务器上可能需要的实际情况之间的公平折衷层。

Silverlight/WPF 和 JavaFX 与 Flex + 任何东西相比的一大优势是您可以在前两个中使用大量逻辑，因为您在应用程序的两侧都有相同的 VM。Flex 是最好的 UI 技术，但它缺少可以更有效地共享和重用代码的服务器组件。

# text - 什么是合理的日语支持的最小 unicode 字符集？

> ID：713397
> 
> 赞同：7
> 
> 时间：2009-04-03T10:26:55.497
> 
> 标签：text, unicode, fonts, internationalization

我有一个需要为日本观众移植的移动应用程序。应用程序的一部分是自定义字体文件，需要将其从仅包含 latin-1 字符扩展到还包含日语字符。我意识到这会使它变得相当大，但这不是今天的问题。

请注意，我无法控制此应用程序要显示的文本，因此它需要能够支持足够的内容才能显示用户生成的内容。

这是我认为的最大 unicode 范围集，可以涵盖所需的任何内容。

```
 Compatability                         U+3300  -  U+33FF
 Compatability forms                   U+FE30  -  U+FE4F
 Compatability ideographs              U+F900  -  U+FAFF
 Compatability ideographs supplement  U+2F800  - U+2FA1F
 Radicals supplement                   U+2E80  -  U+2EFF
 Strokes                               U+31C0  -  U+31EF
 Symbols and punctuation               U+3000  -  U+303F
 Unified Ideographs                    U+4E00  -  U+9FBB
 Unified Ideographs ext. A             U+3400  -  U+4DB5
 Unified Ideographs ext. B            U+20000  - U+2A6D6
 Enclosed letters and months           U+3200  -  U+32FF
 Hiragana                              U+3040  -  U+309F
 Kanbun                                U+3190  -  U+319F
 Katakana                              U+30A0  -  U+30FF
 Katakana phonetic                     U+31F0  -  U+31FF 
```

我需要知道的是：

*   此列表中是否缺少任何内容？
*   有什么明显不需要的吗？
*   有什么可以说是非必要的，为什么可以这样争论？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-03T11:06:45.183

## 基本特征总结

```
封闭的字母数字 U+2460 - U+2473
            " U+2474 - U+24E9*
            " U+24EA - U+24FF
其他符号 U+2600 - U+2607
            " U+2618 - U+2618
            " U+260E - U+260F
            " U+2614 - U+2615
            " U+263D - U+2653
            " U+2660 - U+266F
符号和标点符号 U+3000 - U+303F
平假名 U+3040 - U+309F
片假名 U+30A0 - U+30FF
片假名拼音 U+31F0 - U+31FF
封闭字母和月份 U+321F - U+325F*
            " U+3280 - U+32FF*
统一表意文字分机。A U+3400 - U+4DB5
统一表意文字 U+4E00 - U+9FBB
兼容表意文字 U+F900 - U+FAFF
兼容形式 U+FE30 - U+FE4F
全角罗马字 U+FF00 - U+FF5E
半角片假名 U+FF61 - U+FF9F
全角和半角符号 U+FFE0 - U+FFEE
统一表意文字分机。B U+20000 - U+2A6D6
兼容表意文字补充 U+2F800 - U+2FA1F

* = 较低的优先级

```

## 完整说明

不要忘记全角罗马字，它通常用于日语中的罗马字母 (FF00-FF5E) 和半角片假名页面 (FF61-FF9F)。您可能还需要全角和半角符号 (FFE0-FFEE)。

可以说一般不会使用 Kanbun 注释页面 (3190-319F)。Kanbun 是一种旧式的日语，它使用所有汉字（没有平假名或片假名）和一套不同的语法规则，通常在学校教授。除非有人试图解释如何阅读/理解这些段落之一，否则不会使用这些注释标记，这可能不太可能。出于完整性考虑，可以将其包括在内，但可能不是高优先级。

CJK Compatability (3300-33FF) 通常被印刷媒体中的报纸使用，但几乎可以肯定普通公众不会使用（我还没有在网站上看到）。在任何一种情况下，它们都有等效的长形式（例如，㌘ 可以写成 グラム），所以这也属于非必要类别。

CJK Radicals Supplement (2E80-2EFF) 也不是必需的，但可以使用。它们不是完整的字符，而是字符的“激进”（基础部分）。它们*可以*用来解释字符的派生，但不太可能用于语言的正常应用。

CJK Strokes (31C0-31E3) 与 CJK Radicals Supplement 相同，在日常应用中使用的可能性可能更小。

封闭的CKJ字母和月份（3200-321E）的第一部分是不必要的。它们是韩国的象征。与 (3260-327F) 相同。该页面的其余部分的使用率很低，但为了完整起见，我会将其包括在内，因为*有人*可能会偶尔尝试使用一个。但是您可以将它们视为较低优先级。

您在原始列表中列出的其余部分是必不可少的。

列表中还缺少封闭的字母数字 (2460-24FF)。带圆圈的数字（2460-2473 和 24EA-24FF）使用相对频繁。然而，带圆圈的字母、括号内的数字和数字句点 (2474-24E9) 可以省略，因为它们不是必需的。

此外，最好包含杂项符号 (2600-263C)，尽管有些符号比其他符号更常用。绝对必要的包括一些天气符号 (2600-2607)、三叶草 (2618)、电话 (260E-260F)、雨伞和热饮 (2614-2615)、占星术和十二生肖符号 (263D-2653)，以及玩耍卡片、温泉和音乐符号（2660-266F）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-03T06:57:18.373

从技术上讲，您应该包括： 1\. 阿拉伯数字 (0,1..9) 2\. 英文标点符号 (!"#$%'...) 3\. 罗马字母 (A..Z, a..z) (半宽和全宽）

1-3 基本上意味着 ASCII 支持。

1.  平假名
2.  片假名
3.  日语标点
4.  常阳汉字（这是日本政府批准用于报纸等的大约 2000 个汉字的清单）
5.  Name Kanji（日本政府为专有名称编制的另一份清单）。

总之，这将为您提供 2600 个汉字或类似的东西，您将能够代表您在网络上可以找到的大多数正常的东西。有一些小例外，其中字符很常见，但在 Joyo (fe 沢) 中不常见。

问题是 Unicode 并没有完全围绕卓越汉字列表进行组织，因此您必须在范围内进行选择。包含日语中存在的每个汉字可能更容易，即使它不经常使用或不属于 Joyo 的一部分。

# vb6 - 如何在 VB6 中创建自动完成组合框？

> ID：713398
> 
> 赞同：3
> 
> 时间：2009-04-03T10:27:06.607
> 
> 标签：vb6, autocomplete, combobox

是否可以使用VB6下的默认ComboBox控件使其成为智能ComboBox？我们假设这些值已经填充在 ComboBox 中。例如：

```
New Delhi
New World
New York 
```

我们需要 ComboBox 来响应一个默认事件，因此例如当用户写入“N”时，ComboBox 中的值将是第一个以“N”开头的值。在我们的例子中，它是新德里，然后用户可以继续输入，直到他们写出确切的单词或者他写了不同的东西。这种技术在 Web 应用程序中非常有用（例如在 Google 中，当您输入第一个单词时，您将获得一个包含建议的下拉列表）。但是如何在 VB6 中做到这一点:-(

如果不可能，我们如何保持 ComboBox 下拉，当 ComboBox 中的文本发生变化并且 ComboBox 中的第一个元素对应于用户输入的值开始的第一个单词时，值会发生变化？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T10:43:55.427

实际上我找到了一个简单的解决方案:) 感谢 FreeVbCode uder Forms&Contorls Tab。有一个名为 AutoControl 的控件。我们可以很容易地使用它来满足我们的要求。

[http://www.freevbcode.com/ShowCode.Asp?ID=5944](http://www.freevbcode.com/ShowCode.Asp?ID=5944)

谢谢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T11:46:25.137

您可能还想从支持自动完成的 vbAccelerator.com中查看[此控件。](http://www.vbaccelerator.com/home/VB/Code/Controls/Combo_and_List_Boxes/ComboBoxEx/article.asp)vbAccelerator 代码通常质量很高。当然，每当您使用第三方控件时，您都会在代码中引入相当大的依赖性。

# javascript - 从 JavaScript 数组中删除任意元素

> ID：713401
> 
> 赞同：-1
> 
> 时间：2009-04-03T10:28:26.353
> 
> 标签：javascript, arrays, splice

在我的 Google 地图应用程序中，我可以在地图上放置标记，并保留对放置的每个标记的引用，以及名为`markers`.

添加标记很容易，我只是`push()`将新创建的对象放到数组（`markers.push(marker)`）上；

但是，当从数组中删除任意标记时，给定插槽的索引，它的行为并不像预期的那样。我的功能是：

```
function deleteMarker(markerIndex) {
    if (markerIndex!='' && markerIndex>=0 && markerIndex<markers.length) {
        if (confirm('Do you really want to remove this marker from the map?')) {
            alert('deleting marker '+markerIndex); //debugging purposes
            markers.splice (markerIndex, 1);
        }
    }
} 
```

我以前没有使用 splice() 函数的经验，但看看[它的描述 @ w3schools](http://www.w3schools.com/jsref/jsref_splice.asp)似乎很简单。但是，我得到以下行为：

`markers.splice()`什么也没做。那么我做错了什么？

而且，当`markerIndex`为 0 时，不显示确认框。起初，我假设冗长的 if 条件评估为 false，因此跳过了整个代码块，但是，使用 Firebug 逐步执行调用我发现当数组非空时，索引 0 的条件（当然）成立, 下一步显示`if (confirm(...))`and`alert('deleting...)`被*跳过*并被`markers.splice()`调用（但没有任何反应）。这种行为太奇怪了，我决定打开这个问题。

*谁能澄清发生了什么？*

我认为删除标记将是人们可以做的最简单的功能。我可以添加它们，编辑它们的内容，甚至*清除所有标记*（`pop()`从`markers`数组中删除标记直到为空），一切都很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T10:39:21.957

您的代码的一个问题是 JavaScript 解释`0 == ''`为 true，因此对于`markerIndex`零，您的确认代码不会执行。我猜你误解了 Firebug 显示的步骤，或者它在这里只是有问题，因为你的 if 条件实际上将评估为 false 的 markerIndex 为 0。

您可以通过添加额外的来使用**类型严格比较**`=`：

```
if (markerIndex !== '' && ...) { 
```

一种更简单的方法是：

```
if (markers[markerIndex] !== undefined) { 
```

因为 JavaScript 在访问未定义的对象成员时不会引发错误。

你不工作的另一个问题`splice()`很奇怪（它应该工作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T11:03:26.550

```
function deleteMarker(markerIndex) {
    if (markers[markerIndex] !== undefined) {
        if (confirm('Do you really want to remove this marker from the map?')) {
            map.removeOverlay(markers[markerIndex]);
            markers.splice (markerIndex, 1);
        }
    }
} 
```

这似乎可以解决所有问题。感谢您的回答，非常感谢。我特别喜欢将第一个 if 条件简化为：

`if (markers[markerIndex] !== undefined)`

`splice()`似乎直接在阵列上运行（与 NuclearDog 暗示的相反）并且它按预期工作。我最亲爱的萤火虫误导了我。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-03T10:42:24.057

不确定这是否是这里发生的事情。但是我已经看到相同的代码在调试时在 firebug 中以不同的方式运行 v 在未调试时。我很确定我也没有干扰代码的手表。

# internet-explorer - Internet Explorer 忙时超时

> ID：713405
> 
> 赞同：0
> 
> 时间：2009-04-03T10:31:27.500
> 
> 标签：internet-explorer, nunit, cruisecontrol.net, watin

在 ccnet 服务器上执行测试期间。一些测试在 Internet Explorer 忙时显示超时并挂起系统并在最后在 nunit 结果中显示旧的 results-xml 文件时失败，即使我使用的是干净的构建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T08:01:16.820

I'm having the same issue with WatiN-tests. I can't write text to a TextField. I have no idea for how to solve it yet.

**Update:** I downgraded from IE8 to IE6 and ran the WatiN-tests again without the timeout issue.

# ms-access - OLEDB 使用 DSN 连接到 Access 数据库

> ID：713410
> 
> 赞同：0
> 
> 时间：2009-04-03T10:32:13.880
> 
> 标签：ms-access, oledb

海

我想要使​​用 Dsn 的 oledb 连接。我使用了以下代码

```
'Dsn Create
 dbRegBase.RegisterDatabase("GEMINI", "Microsoft Access Driver (*.mdb)", True,DBQ=D:\Gemini\GEMINI\database\paints_01_2008-2009.mdb
Description=Greenchip Technologies ODBC Database File Path
OemToAnsi=No
UID=admin
PWD=XXXXXX

conection code
Provider=Microsoft.Jet.OLEDB.4.0;DBQ ='GEMINI';Persist Security Info=False;Jet OleDB:Database Password = XXXXXX 
```

但是错误来了，错误名称是“找不到可安装的 ISAM”我做什么。请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-27T01:06:23.517

我的问题是为什么有人想使用 odbc？有许多网站展示了 oledb 与 odbc 的速度改进。此外，odbc 已经有一段时间没有更新了，而且非常有问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-03T10:39:14.017

它是否需要是 OleDB 连接？

我尝试在我最近的应用程序中使用 OleDB，但惨遭失败，但使用 OdbcConnection 和 DSN 进行管理。

```
String query = "SELECT * FROM myTable"; //Complete this for your specific query
OdbcConnection con = new OdbcConnection("DSN=DatabaseName");
OdbcCommand com = new OdbcCommand("Query...", con);
try
{
    con.Open();
    OdbcReader reader = com.ExecuteReader();

    while(reader.Read())
    {
        //Do things with the results
    }
}
catch(Exception ex)
{
    //Exception handling
} 
```

我认为比使用 OleDB 友好得多。

# visual-studio - 为什么“命名空间提供程序”属性没有保存在给定子目录的项目文件中？

> ID：713411
> 
> 赞同：18
> 
> 时间：2009-04-03T10:32:21.680
> 
> 标签：visual-studio, visual-studio-2008, resharper, namespaces, code-analysis

VS2008 项目中的子目录主要用于在磁盘上物理表示项目的命名空间结构。每个文件夹都有一个名为“命名空间提供程序”的布尔属性，当设置为 True 时，ReSharper 会验证给定类的物理位置是否对应于逻辑命名空间位置。

有时我不希望将文件夹用作命名空间提供程序，因此我将此属性设置为 False，并且 ReSharper 不会执行检查。

### 问题

此设置不会保存在项目文件中，因此在我下次打开解决方案时恢复为默认值 True。这没什么大不了的，但 ReSharper 确实会给您很多关于不正确命名空间的警告。

为什么不保存属性值？

### 版本...

带有 VS2008 SP1 的 ReSharper 4.0

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-09-30T16:25:07.467

对我来说，此设置保存在 .csproj.resharper 文件中。我们遇到了问题，因为一些开发人员在这个文件上添加了一个忽略模式，并且没有签入。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-02-19T19:13:56.727

@橄榄小时

这是保存在 ProjectName.csproj.DotSettings 文件中的项目级设置。考虑将所有项目级 .DotSettings 文件检查到源代码控制，以在您的团队中保留此设置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-05-17T15:47:06.020

**快速回答：** 在切换分支之前，关闭您正在切换的解决方案。这可以防止 VS 提示您“重新加载”解决方案，因为它已更改。Visual Studio 将在重新加载 .suo 文件时删除 ReSharper 的自定义设置。

**长答案：** 我发现要保持“命名空间提供程序”的 False 设置（True 设置始终保持，因为它是默认状态）是为了确保在我切换分支之前（通过 ToirtoiseSVN），我记得关闭 Visual Studio 或解决方案。

在 Visual Studio 提示您以下消息后，只要您选择“重新加载”Visual Studio 选项，该状态就会被清除：“项目 'project.name.here' 已在环境外修改。按重新加载以从磁盘。按忽略以忽略外部更改。”

我认为发生这种行为是因为 Visual Studio 在重新加载 .suo 文件时从 .suo 文件中删除了所有未知值。这是保留此 ReSharper 设置（命名空间提供程序）的地方。

# url-rewriting - 通配符在 IIS7 URL 重写中无效

> ID：713413
> 
> 赞同：2
> 
> 时间：2009-04-03T10:34:59.753
> 
> 标签：url-rewriting

我有一个在我的本地机器上作为根 url 运行的 webapp，但是在服务器上它在另一个网站的新虚拟目录中运行。

我遇到的问题是所有图像都是这样写的；

```
<img src="/Images/image.jpg" .../> 
```

但是，当我将 webapp 上传到服务器时，图像需要是这样的

```
<img src="/myApp/Images/image.jpg .../> 
```

所以我想我会使用重写模块来更改图像路径并节省一些时间。使用 IIS7 我有以下模式；

```
*/Images/* 
```

这对于操作重写属性

```
http://example.com/myApp/Images/{R:2} 
```

但是它不起作用 - 此图像仍显示为未找到。有人会指出我的错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T11:26:55.103

模式应该是正则表达式，尝试匹配为

```
 ^.*?/Images/(.*) 
```

和重写网址为

```
 /myApp/Images/{R:1} 
```

请注意，这需要在网站而不是应用程序的 web.config 中。

# c# - 通过集合、ORM 列表查看数据库

> ID：713415
> 
> 赞同：0
> 
> 时间：2009-04-03T10:36:04.713
> 
> 标签：c#, .net, database, datagridview, .net-2.0

我一直在研究如何以及使用什么来说出类中字段的名称，然后调用该类并获取该类的属性，如字段值中一样。举个例子，假设我要从一张表的一条记录中获取一个值，我将创建该类的一个对象，如下所示；

```
DBTable<cars> cartable = new DBTable<cars>(1) //passing 1 is a dataset number
cartable.GetLastRec(); OR cartable.Attributes.Key.carIdx // record index
cartable.GetKeyRec();
// Now I print the value
Console.WriteLine("Car number: " + cartable.Attributes.Data.number; 
```

很容易获得一条记录，它就像一个面向对象的数据库，但不确定是否不是，我对数据库系统一无所知，只是这些类用于与 DLL 文件通信并传递一些数字.

到目前为止，我一直在使用集合、继承、ORM 进行测试，没有任何东西能够描述正在发生的非常简单的过程，甚至动态调用对象并迭代它的属性我希望做的是；Datagridview => 表类 => DLL 入口点 => 数据库

如果有人遇到过同样的挑战，或者我在这里的方法有误，但在这个阶段完全迷失了，欢迎任何想法提前致谢

顺便说一句：我正在使用 VS2005，.NET 2.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T10:46:22.520

做到这一点的唯一方法是提供您自己的`PropertyDescriptorCollection`.

在此处或在 Google 上进行搜索，应该会为您指明正确的方向。

# sql-server - 尝试保存数据时出现一般错误

> ID：713416
> 
> 赞同：0
> 
> 时间：2009-04-03T10:36:39.733
> 
> 标签：sql-server, cluster-computing

我们刚刚在连接到集群 Sql Server 2000 的应用程序上遇到了一个奇怪的错误：我们的 .NET 应用程序 (ADO.NET) 和 C++ (ADO) 应用程序都出现了我们无法解释的错误。所有应用程序都可以连接到数据库，可以从中读取数据，但无法在其上写入数据，收到“通用网络错误”（我已从意大利语消息中翻译）。经过几次尝试，我们尝试将服务从一个节点切换到另一个节点，这似乎解决了问题。仍然没有人能够弄清楚发生了什么以及为什么；有谁能给我解释一下吗？在此先感谢马尔科

* * *

编辑：以防万一发生在其他人身上：我们发现计算机没有最新版本的 MDAC (2.8 SP1)。客户很可能重新安装了计算机并且没有更新 Windows：当我们运行 Windows Update 时，问题*神奇地*（从客户的角度......）得到了解决。我们不确切知道安装了哪个版本的 MDAC，但可能是 2.6 或更低版本，因为我知道我们的应用程序在使用旧版本的 MDAC 时存在问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T11:08:53.777

最近应用了任何更新？

我在更高版本的 SQLServer 上看到了类似的东西，所以我会看看对服务器的安全访问等，因为我不认为它们都在系统之间复制。

# c# - 如何在同一解决方案中从 C++/CLi 项目中引用 C# 项目

> ID：713428
> 
> 赞同：13
> 
> 时间：2009-04-03T10:40:18.570
> 
> 标签：c#, visual-studio, c++-cli, reference

我在一个解决方案中有两个项目，一个是 C# 库，另一个是 C++/CLI 库。

我已经使用 C# 库的引用菜单在 C++/CLI 项目中添加了一个引用。然后我添加

```
#using <assembly.name.dll> 
```

并尝试使用

```
using namespace namspace.subnamespace; 
```

但我得到了无法找到 assembly.name.dll 的错误。我已经尝试匹配程序集名称的大小写和所有小写，但没有用。令人惊讶的是，互联网上的任何地方都没有关于如何引用您自己创建的程序集的参考资料。

正确的是这样做，如果我做对了，我应该采取什么方法来诊断这个。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-03T11:36:27.173

您需要将 C# 程序集的路径添加到 C/C++ > General > Resolve #using References

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T10:44:10.183

如果您包含参考，我认为您不需要#using 位。

# annotations - 强制 javadoc 忽略注释

> ID：713429
> 
> 赞同：1
> 
> 时间：2009-04-03T10:41:18.803
> 
> 标签：annotations, javadoc

我正在尝试记录一个带注释的接口，并包含一个如何在 javadoc 中使用的示例。例如

```
/**
 * Here's an example usage:
 *
 * <PRE>
 * @IFaceAnnotation(value="")
 * public interface IFace {
 *
 *     @MethodAnnotation("")
 *     public String Method();
 * }
 * </PRE>
 */ 
```

但是，Javadoc 将我的注释视为 javadoc 指令（如 @param 等），因此只打印：

> 这是一个示例用法：

在生成的文档中。我能够阻止这种情况的唯一方法是在注释之前添加一个额外的字符，例如

```
/**
 * Here's an example usage:
 *
 * <PRE>
 * \@IFaceAnnotation(value="")
 * public interface IFace {
 *
 *     \@MethodAnnotation("")
 *     public String Method();
 * }
 * </PRE>
 */ 
```

但这看起来有点乱。

只是想知道是否有人有任何建议，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T10:59:24.157

您可以使用`'&#064;'`而不是@，但这更难看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-06-19T22:51:02.943

你也可以使用`{@literal @}`. 没有讨厌的转义字符。

```
/**
 * Here's an example usage:
 *
 * <PRE>
 * {@literal @}IFaceAnnotation(value="")
 * public interface IFace {
 *
 *     {@literal @}MethodAnnotation("")
 *     public String Method();
 * }
 * </PRE>
 */ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-16T08:26:14.270

您是否尝试将其包装在 {@code} 符号中？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-16T19:04:05.507

为了记录，正确和完整的答案是：

```
/**
 * Here's an example usage:
 *
 * <pre>
 * {@code}
 * &#064;IFaceAnnotation(value="")
 * public interface IFace {
 *
 *     &#064;MethodAnnotation("")
 *     public String Method();
 * }
 * </pre>
 */ 
```

这导致

[![在此处输入图像描述](https://i.stack.imgur.com/TheQX.png)](https://i.stack.imgur.com/TheQX.png)

# sql-server - SQL Server 中唯一标识符 ID 列上的聚集主键

> ID：713430
> 
> 赞同：3
> 
> 时间：2009-04-03T10:41:33.637
> 
> 标签：sql-server, primary-key, uniqueidentifier

如果表上的 ID 列是唯一标识符 (Guid)，那么在 ID 列上创建**聚集**主键有什么意义吗？

鉴于它们是全球唯一的，排序将如何工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T10:47:19.443

我强烈建议不要使用集群 Guid 密钥...由于几年前设计如此糟糕，我们在 SQL 服务器上遇到了很大的性能问题。

另请查看：[提高集群索引 GUID 主键的性能](https://stackoverflow.com/questions/583001/improving-performance-of-cluster-index-guid-primary-key)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T10:48:41.843

GUID 因为它们实际上是随机值（这会“破坏”聚集索引），所以它们对性能很糟糕，而且它们对索引很糟糕，因为更少的条目适合单个页面/范围（SQL Server 术语）。SQL Server 2005 引入[`newsequentialid()`](http://www.sqljunkies.com/Article/4067A1B1-C31C-4EAF-86C3-80513451FC03.scuk)了帮助解决第一个问题的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T10:50:37.313

将聚集索引放在 guid 列上并不是一个好主意（除非您正在使用顺序 guid）。

聚集索引确定记录存储方式的物理顺序。
这意味着，如果您将聚集索引放在不按顺序增长的列上，SQL Server 将进行一些工作以确保在您插入新记录时记录在物理上正确排序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T10:52:04.923

拥有排序索引的想法本身非常好，因为搜索变得非常有效。

然而问题是，在 GUID 的情况下，永远不会使用“WHERE GUID = xyz”进行搜索。所以整个概念都被浪费了。因此，我建议宁愿在最常用作 SARG 的列上设置聚集索引，以提高查询效率。

# c# - 用 C# 替换字符串中的数字

> ID：713435
> 
> 赞同：2
> 
> 时间：2009-04-03T10:43:43.307
> 
> 标签：c#, regex, filenames

我以为我做了一个正则表达式替换

```
Regex r = new Regex("[0-9]"); 
return r.Replace(sz, "#"); 
```

在名为 aa514a3a.4s5 的文件上。它完全按照我的预期工作。它替换所有数字，包括分机中的数字。我如何使它不替换分机中的数字。我尝试了许多正则表达式字符串，但我开始认为它是全有或全无的模式，所以我不能这样做？我需要将分机与字符串分开还是可以使用正则表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T11:24:31.397

这个是为我做的：

`(?<!\.[0-9a-z]*)[0-9]`

这会在句点上进行否定的向后查找（字符串不得出现在匹配的字符串之前），后跟零个或多个字母数字字符。这可确保仅匹配不在您的分机中的数字。

显然，[0-9a-z] 必须替换为您在扩展程序中期望的字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T10:51:13.070

我不认为你可以用一个正则表达式来做到这一点。

可能最好将原始字符串拆分为基础和扩展；在底座上进行更换；然后加入他们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T10:50:36.440

是的，我觉得你最好分开扩展。

如果您确定字符串末尾总是有 3 个字符的扩展名，那么最简单、最易读/可维护的解决方案是仅在

```
yourString.Substring(0,YourString.Length-4) 
```

..然后追加

```
yourString.Substring(YourString.Length-4, 4) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T10:53:44.327

为什么不在子字符串上运行正则表达式？

```
String filename = "aa514a3a.4s5";
String nameonly = filename.Substring(0,filename.Length-4); 
```

# c# - 在 C# 中以外行风格解释泛型？

> ID：713438
> 
> 赞同：4
> 
> 时间：2009-04-03T10:45:14.643
> 
> 标签：c#, generics

[C# 中的“< >”语法是什么的](https://stackoverflow.com/questions/155260/what-is-the-functionality-within-c)重复

* * *

实际上我想知道“为什么以及何时应该使用泛型？”。

它有什么需要？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T11:09:18.033

泛型是在 C# 编译时确保类型安全的一种方法。

示例 - 预泛型：

```
class Person 
{
 string name;
 string lastname;
 public Person(string _name )  { this.name = _name; }
}

class ClientCode
{
   public static void Main()
   {
         //create a list of person
         ArrayList personList = new ArrayList();
         Person p1 = new Person("John");
         Person p2 = new Person("Ram");
         personList.Add(p1);
         personList.Add(p2);
         // BUT, someone can do something like:
         // ArrayList does not stop adding another type of object into it
         object q = new object();
         personList.Add(q);
         // while accessing personlist
         foreach(object obj in personlist)
         {
            Person p = obj as Person;
            // do something, for person
            // But it will fail for last item in list 'q' since its is not person.
         }
   }
} 
```

示例 - 后泛型：

```
class ClientCode
{
   public static void Main()
   {
         //create a list of person
         List<Person> personList = new List<Person>();
         Person p1 = new Person("John");
         Person p2 = new Person("Ram");
         personList.Add(p1);
         personList.Add(p2);
         // Someone can not add any other object then Person into personlist
         object q = new object();
         personList.Add(q); // Compile Error.
         // while accessing personlist, No NEED for TYPE Casting
         foreach(Person obj in personlist)
         {
            // do something, for person
         }
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-07T21:16:17.527

泛型可以让你在类型上参数化代码，就像参数让你在值上参数化它一样。这可能并不能解释很多，所以让我们一步一步来：

想象一下，您想要一个程序打印“我喜欢兔子”。你这样写：

```
static void Main()
{
    ILikeBunnies();
}

void ILikeBunnies() { Console.WriteLine("I like bunnies"); } 
```

一切都很好。但你也喜欢奶酪，所以现在你有：

```
static void Main()
{
    ILikeBunnies();
    ILikeCheese();
}

void ILikeBunnies() { Console.WriteLine("I like bunnies"); }
void ILikeCheese()  { Console.WriteLine("I like cheese"); } 
```

您注意到您的两个功能几乎相同。您想重用*相同*的功能，但为您喜欢的内容提供不同的*值：*

```
static void Main()
{
    ILike("bunnies");
    ILike("cheese");
}

void ILike(string what) { Console.WriteLine("I like " + what); } 
```

这就是函数参数的用途：它们允许您重用具有不同值的相同代码。

泛型就是这样，但不是传入不同的值，而是传入*types*。假设您的代码需要将两个字符串捆绑到一个数组中：

```
static void Main()
{
    string[] s = Pair("a", "b");
}

string[] Pair(string a, string b) { return new string[] { a, b }; } 
```

很好，花花公子。后来你意识到你还需要将整数捆绑到一个数组中：

```
static void Main()
{
    string[] s = Pair("a", "b");
    int[]    i = Pair(1, 2);
}

string[] Pair(string a, string b) { return new string[] { a, b }; }
int[]    Pair(int    a, int    b) { return new int[]    { a, b }; } 
```

就像以前一样，我们可以看到那里有一堆冗余。我们需要的是一个函数，它返回一对*whatever*，以及一种*传入*我们想要一对的类型的方法。这就是泛型的用途：

```
static void Main()
{
    string[] s = Pair<string>("a", "b");
    int[]    i = Pair<int>(1, 2);
}

T[] Pair<T>(T a, T b) { return new T[] { a, b }; } 
```

尖括号让您可以将类型传递给函数，就像括号让您传递值一样。这里的“T”是类型参数的名称，就像上面的值参数“what”一样。函数中出现的任何位置 T 都将替换为您传入的实际类型（示例中的字符串和 int）。

除此之外，你可以用泛型做很多事情，但这是基本思想：泛型让你可以将类型传递给函数（和类），就像参数让你传递值一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T10:50:56.907

泛型基本上消除了将对象转换为基本类型的需要。

例如，如果您想将一组 Foos 存储在列表中。

您过去必须创建自己的 owen FooList 或将项目转换为对象。

所有这一切都需要您时间和编译器。

使用泛型，您所要做的就是坐在列表中，它会检查您的类型并加速您的程序。（没有装箱和拆箱）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T10:55:08.457

假设你自己是一个算法，它可以对任何可以成对比较的对象（扑克牌、CD、名片等）进行排序。您实际上对这些具体对象提供的内容并不感兴趣，您可以比较它们。这样你就变成了一个泛型（这里的“泛型”是广义的，而不是 C# 意义上的）算法。

.NET 中的泛型有助于促进这种特定类型的行为，不仅在算法（泛型函数）方面，而且在泛型类型（类、结构、委托、接口）方面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T11:05:31.413

只是为了补充其他人会告诉你的内容，更实际地，尝试用一个`ArrayList`或`System.Array`对象做一些事情，然后尝试用一个做它，`List<T>`你可以立即看到泛型如何让你编写更具可读性的代码并且也更快地编写它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T15:41:50.687

[我很久以前在博客上写过，在这里](http://charlieflowers.wordpress.com/2006/07/05/generics-and-xpath-a-beautiful-match/)。我正在使用 XML，我想要一个可以获取 XmlElement 或 XmlAttribute（基于 XPath）并让我使用它的助手。当泛型对 C# 来说还很新时，这是我在现实世界中完成的一个很好的简单示例。

# f# - F#（和 .NET）中的浮点精度

> ID：713439
> 
> 赞同：2
> 
> 时间：2009-04-03T10:45:23.503
> 
> 标签：f#, floating-point

1.  在“[科学家的 F#](http://www.ffconsultancy.com/products/fsharp_for_scientists/index.html) ”中，Jon Harrop 说：

    > 粗略地说，int 类型的值近似于 min-int 和 max-int 之间的实数，具有 +- 1/2 的恒定绝对误差，而 float 类型的值具有近似恒定的相对误差，只有百分之几.

    现在，这是什么意思？int 类型不准确？

2.  为什么 C# for (1 - 0.9) 返回 0.1 而 F# 返回 0.099999999999978 ？C#更准确，更适合科学计算吗？

3.  我们应该使用十进制值而不是双精度/浮点数进行科学计算吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T17:00:27.737

1.  对于任意实数，整数类型或浮点类型都只会提供近似值。积分近似在一个方向或另一个方向上的偏差永远不会超过 0.5（假设实数符合该整数类型的范围）。浮点近似值的偏差永远不会超过一小部分（再次假设实数在该浮点类型支持的值范围内）。这意味着对于较小的值，浮点类型将提供更接近的近似值（例如，将 PI 的近似值存储在浮点数中将比 int 近似值 3 准确得多）。然而，对于非常大的值，整数类型的近似值实际上会比浮点类型的更好（例如，考虑值 9223372036854775806.7，

2.  这只是您如何打印值的工件。9/10 和 1/10 不能精确地表示为浮点值（因为分母不是 2 的幂），就像 1/3 不能精确地写成小数一样（你得到 0.333... 其中3 永远重复）。无论您使用哪种 .NET 语言，该值的内部表示都将是相同的，但是打印该值的不同方式可能会以不同的方式显示它。请注意，如果您在 FSI 中评估 1.0 - 0.9，则结果显示为 0.1（至少在我的计算机上）。

3.  您在科学计算中使用什么类型将取决于您要达到的目标。您的答案通常只会大致准确。你需要它有多准确？您的性能要求是什么？我认为十进制类型实际上是一个定点数，这可能使其不适用于涉及非常小的或非常大的值的计算。另请注意，F# 包括任意精度的有理数（使用 BigNum 类型），这也可能适用于您的输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T10:47:54.997

不，F# 和 C# 使用相同的双精度类型。浮点数几乎总是不精确的。整数是精确的。

更新：

您看到差异的原因是由于数字的打印，而不是实际的表示。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T10:59:07.760

对于第一点，我想说它`int`可以用来表示整数范围内的任何实数，在 [-0,5, 0.5] 中具有恒定的最大误差。这是有道理的。例如，pi 可以用整数值 3 表示，误差小于 0.15。

浮点数不共享此属性；它们的最大绝对误差与您尝试表示的值无关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T16:56:44.000

3 - 这取决于计算：有时 float 是一个不错的选择，有时您可以使用 int。但是，当您对任何浮点数和小数点都缺乏精度时，就会有一些任务。

反对使用**int**的原因：

```
> 1/2;; 
val it : int = 0 
```

反对使用**float**（在 C# 中也称为 double）的原因：

```
> (1E-10 + 1E+10) - 1E+10;;
val it : float = 0.0 
```

反对 BCL**十进制**的原因：

```
> decimal 1E-100;;
val it : decimal = 0M 
```

每种列出的类型都有其自身的缺点。

# selenium - Selenium 浏览器检测

> ID：713446
> 
> 赞同：0
> 
> 时间：2009-04-03T10:46:56.900
> 
> 标签：selenium

早上好

在过去的几周里，我一直在进行一些测试，但遇到了一些困难。

我正在 IE 7 和 8 以及 Firefox 中进行测试。

基本上我的问题是 IE 8 还不支持插件，firefox 不支持框架集中的引用，所以基本上我想做的是检测我正在使用哪个浏览器，然后如果它的 ie 7 运行测试，否则跳过某些测试，这可能吗？

提前感谢大家的帮助。

干杯

卡梅伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T11:14:25.540

我可能遗漏了一些东西（可能！），但是如果您要做的只是针对 IE 进行目标测试，那么条件注释会起作用吗？

```
<!--[if ie 7]>

    The tests go here.

<![endif]--> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-07T13:10:16.460

只是给其他阅读此内容的人的注意事项：问题是关于使用 Selenium Core，并且该解决方案旨在编辑基于 HTML 的测试套件文件。如果您使用的是 Selenium RC，那么您显然知道您启动了哪个浏览器 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T10:53:43.140

嗯，我想到了一个解决方案......也许有点奇怪，但我认为它应该有效：让你的 Web 应用程序。读取 HTTP UserAgent 并将其保存为隐藏的 HTML 输入字段。然后您可以从您的 Selenium 测试中访问它并决定是否要继续运行它们。

也许有更好的解决方案，我不知道。

# c# - ASP.NET - 转换本地化数字

> ID：713453
> 
> 赞同：2
> 
> 时间：2009-04-03T10:49:24.757
> 
> 标签：c#, asp.net, localization, culture

我有一个接受用户输入的文本框；我正在尝试使用此用户输入来填充我的一个业务对象的此成员：

```
公共 System.Decimal？汇率
```

该应用程序已本地化 - 我需要同时支持接受这些作为有效输入的文化：“1,5”和“1.5”

我现在的代码是：

```
varculture = Thread.CurrentThread.CurrentUICulture;

国际汇率；
int.TryParse(txtExchangeRate.Text, NumberStyles.Number, 文化,
    出汇率）；

entity.ExchangeRate = exchangeRate;

```

当用户文化设置为期望“1,5”格式（逗号作为小数分隔符）的文化时 - 例如“ro-RO”，我希望存储在 entity.ExchangeRate 中的值为 1.5；但是，当运行上面的代码时，它会被转换为 15。

关于如何转换这些各种格式以使存储在我的业务实体中的数据为“1.5”（点为小数分隔符）的任何建议？

谢谢。

* * *

你们是对的 - 使用 Thread.CurrentThread.CurrentCulture 而不是 Thread.CurrentThread.CurrentUICulture 和 decimal.TryParse 而不是 int.TryParse 是有意义的。

但是这些更改仍然不能解决我的问题。在玩了更多代码之后，我现在可以将问题简化为：

我正在使用 Telerik RadNumericTextBox 控件，它强制用户根据他们的文化使用正确的格式。因此，当 Thread.CurrentThread.CurrentCulture 设置为“ro-RO”时，它只接受“1,5”格式，而当它设置为“en-GB”时，它只接受“1.5”格式。

这是我现在使用的代码：

```
十进制汇率；
decimal.TryParse(txtExchangeRate.Text, out exchangeRate);
entity.ExchangeRate = exchangeRate;

```

案例 1：当前文化是 "en-GB" - 接受的输入是 "1.5" ，exchangeRate 设置为 1.5 - 一切正常。

案例 2：当前文化是 "ro-RO" - 接受的输入是 "1,5" ，但在执行 decimal.TryParse... 行后，**exchangeRate 设置为 15** - 显然是错误的。我还应该提到，在这种情况下，txtExchangeRate.Text 的值在我的监视窗口中也显示为“1.5”。

所以，看起来像 decimal.TryParse 会考虑到当前的文化，但我找不到一种方法让它真正适合我。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T11:49:34.817

1.  显然， int 不能容纳 1.5 ！:-) 改用浮点数。

2.  使用 CurrentCulture 而不是 CurrentUICulture。我的文化是 fr-BE（因此接受 1,5，但我的 Windows UI 是英语，但不是）。

3.  我将使用 CurrentCulture 和 InvariantCulture 进行 float.Parse() 测试：当一些程序学会接受“1,5”时，每个人都习惯于输入“1.5”。没有什么比 Excel 要求我在说 1.5 时输入 1,5 更让我烦恼的了！此外，在比利时，第一年政府推出了基于网络的纳税申报，该网站强制您使用逗号而不是句点作为小数点。每个人都想知道为什么输入的数字被拒绝了！因此，请善待您的用户并接受两者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T08:04:09.513

好的，这里的代码似乎适用于我在上面的帖子中描述的两种情况（1.文化“ro-RO”，逗号作为小数分隔符和 2.文化“en-GB”，点作为小数分隔符）：

```
十进制汇率；
decimal.TryParse(txtExchangeRate.Text, NumberStyles.Any,
       CultureInfo.InvariantCulture, out exchangeRate);
entity.ExchangeRate = exchangeRate;

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T11:34:46.520

仅供参考，我知道这不是您的问题，但它为其他可能正在这样做的人提供了指导：

当你设置你的文化时，你不能让你的应用程序能够处理不同文化的输入。它必须是您指定的类型。

因此，如果您将 ro-RO 设置为文化，它不会将 1.5 和 1,5 理解为同一事物。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T11:04:57.887

您可能应该使用 CurrentCulture（而不是 CurrentUICulture）进行本地化（例如日期/数字格式）。

# deployment - SQL CE 部署

> ID：713474
> 
> 赞同：4
> 
> 时间：2009-04-03T10:57:05.440
> 
> 标签：deployment, sql-server-ce

我有一个小型 Windows 应用程序，正在尝试将 SQL CE 用于本地数据存储。我在部署它时遇到了一些问题。我正在使用 ClickOnce 部署。

第一个问题：在`Publish properties -> Application Files`我将其设置为数据文件（自动）、必需、包含。但是，它似乎不包括在内？当我导航到 Click Once 安装到它的位置时，它不在那里？

第二：单击一次在目录中创建一个新目录`User\Local\Apps`，其中包含应用程序文件和 SDF 文件，当我更新应用程序并发布新版本时，我不想从新数据库开始。现有数据库中的所有数据都会丢失吗？只是似乎没有意义？

围绕这个的程序是什么？

# c# - 如何合并我拆分的字符串？

> ID：713476
> 
> 赞同：7
> 
> 时间：2009-04-03T10:58:48.417
> 
> 标签：c#, string

我喜欢我能做到的`string [] stringArray = sz.split('.');`

但是有没有办法将它们重新合并在一起？`(stringArray.Merge(".");)`

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-03T11:01:13.840

```
string mergedString = String.Join(" ", stringArray); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-03T10:59:42.860

字符串连接

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T10:59:45.387

```
String.Join() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-23T10:00:01.460

假设有一个电话号码，例如：

```
string str = "^^^^^546^64767";
string resultString = String.Join("-", str.Split(new string[] { "^" }, StringSplitOptions.RemoveEmptyEntries)); 
```

所以你可以像这样加入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-06T13:14:19.573

字符串合并 = String.Concat(stringArray);

# .net - Cruise control.NET 跟踪源文件更改的次数？

> ID：713489
> 
> 赞同：0
> 
> 时间：2009-04-03T11:02:12.263
> 
> 标签：.net, scripting

我已经配置了一个 ccnet，它实际上会嗅探我本地系统中存在的源文件中的修改。我的 ccnet.config 文件将每 4 分钟轮询一次以检查源文件中的任何修改。所以问题就像我修改同一个文件两次，当 ccnet 轮询我在命令窗口中看到的是 jst 1 个修改而不是我所做的 2 个修改。你能建议任何方法来获得我的源文件的确切次数修改的。为了更清楚：--------假设我的源文件夹包含名为 ac、bc 和 dc 的文件如果我在 ac 和 bc 中进行修改，当我的 ccnet 以确切的间隔轮询时，它显示检测到 2 个修改并启动构建过程。现在，如果我只在 a 中进行修改。

谢谢麦迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T12:55:43.550

CruiseControl.Net 检查自上次构建以来的修改，以了解它是否应该触发新构建。它不需要知道一个文件被修改了多少次，只需要知道自上次检查以来哪些文件被修改了。

修改次数是指被修改的文件，而不是文件被修改的次数或次数。

# c# - 在不破坏封装的情况下创建对象

> ID：713490
> 
> 赞同：2
> 
> 时间：2009-04-03T11:02:15.163
> 
> 标签：c#, oop

我对这一切都很陌生，所以这可能是 OOP 101，但我无法理解它，假设以下 C# 代码存在于程序集中：

```
internal interface IDataStore
{
    void Store(string name, object data);
    object Retrieve(string name);
}

internal class DBStore : IDataStore
{
    public DBStore(string connection) { }
    public void Store(string name, object data) { }
    public object Retrieve(string name) { }
}

public class GizmoManager
{
    public GizmoManager(IDataStore dataStore) { }
    // Other stuff
}

public class WidgetManager
{
    public WidgetManager(IDataStore dataStore) { }
    // Other stuff
} 
```

如果第二个程序集尝试创建 GizmoManager 和 WidgetManager，它不能，因为它无法获取 DBStore（因为它是内部而不是公共的）。

以下不适用于 AFAICS：

*   公开 DBStore 和 IDataStore。不好，因为客户端程序集可以绕过 GizmoManager/WidgetManager 并访问它喜欢的数据库。
*   不要将 IDataStore 传递给 GizmoManager 和 WidgetManager 构造函数。不好，因为它降低了可测试性（您不能轻易传入 MockDataStore）。
*   用工厂做一些神奇的事情。似乎没有解决任何问题，因为您需要将相同的 IDataStore 传递给 GizmoManager 和 WidgetManager，因此客户端程序集仍然需要将 IDataStore 分配给变量（它不能因为 IDataStore 是内部的）。

这可能非常明显，但我就是看不到。如何克服这一矛盾？

TIA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T11:08:56.613

只需`IDataStore`公开界面即可。这样，客户可以使用他们自己创建的模拟对象来实例化您的`WidgetManager`和类。`GizmoManager`

实现设计模式的*工厂*类，以允许客户端代码创建`GiszmoManager`对象`WidgetManager`。这样，客户端代码永远无法创建`DBStore`对象，因此它们永远无法绕过您的经理。

**顺便说一句：**为什么要对封装大惊小怪？如果您从事专有框架业务，这可能是有意义的，否则，[YAGNI](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T11:07:03.077

将 IDataStore 和 DBStore 设为公开，但将 DBStore 构造函数设为内部。然后程序集 1 可以完全控制何时实例化 DBStore，但程序集 2 能够访问和传递 DBStore。

我想你会想要一个装配 1 中的工厂来限制创建的 DBStore 实例的数量或配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T11:11:59.603

您可以制作接口和类`public`，但制作直接访问数据库的方法`internal`。这样，您可以实例化您的实例`DBStore`，而不允许对其他程序集不允许的方法进行任何访问。

`internal`方法仅对同一程序集中的类可见。

我宁愿检查是否没有办法在不需要`DBStore`每次都实例化的情况下组装你的对象。也许是工厂模式或依赖注入？然后你可以公开你的接口，并让第一个程序集中的工厂实例化它们。这不会影响可测试性，但会减少您创建的对象实例。更少`new XYZ()`的陈述更好...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T11:12:45.560

将 DBStore 设为公开，但将您不想公开的所有成员设为私有或内部。然后... 选项 1：从 IDataStore 中删除您不希望在程序集之外访问的所有成员，并使 IDataStore 公开。选项 2：将 IDataStore 重命名为 IDataStoreInternal，并使其继承自一个新的公共 IDataStore 接口，该接口没有成员（或只有您想要在外部公开的成员）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T11:42:58.937

我喜欢这两个：

> *   不要将 IDataStore 传递给 GizmoManager 和 WidgetManager 构造函数。不好，因为它降低了可测试性（您不能轻易传入 MockDataStore）。
> *   用工厂做一些神奇的事情。似乎没有解决任何问题，因为您需要将相同的 IDataStore 传递给 GizmoManager 和 WidgetManager，因此客户端程序集仍然需要将 IDataStore 分配给变量（它不能因为 IDataStore 是内部的）。

为了解决可测试性但隐藏实现，公共接口应该只提供商店是否应该是活动的、可测试的、预生产的等选项。因此，您可以将正确的 IDataStore 构造的责任委托给程序集中的另一方。例如，工厂概念只允许您设置“测试”、“部署”、“调试”等。在给定“模式”设置的情况下，具有在内部引用工厂以获取正确存储的默认构造函数（或单例或其他）。

# c# - 打开/关闭监视器

> ID：713498
> 
> 赞同：57
> 
> 时间：2009-04-03T11:06:56.137
> 
> 标签：c#, winapi

是否可以通过代码（C#）以编程方式打开/关闭监视器？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-03T11:09:31.013

你甚至尝试过谷歌搜索吗？

第一次点击： http: [//www.codeproject.com/KB/cs/Monitor_management_guide.aspx](http://www.codeproject.com/KB/cs/Monitor_management_guide.aspx)

我并不惊讶您需要使用 Windows 提供的一些 DLL。

（我猜你需要一个 C# 解决方案，因为这是你应用的唯一标签）。

**编辑 2013 年 2 月 8 日：**

有人提到该解决方案在 Windows 7 en 8 下不再有效。这里有一个在 Windows 7 下运行良好的解决方案，还没有尝试过 Windows 8。

[http://cocoa.ninja/posts/Turn-off-your-monitor-in-Csharp.html](http://cocoa.ninja/posts/Turn-off-your-monitor-in-Csharp.html)

```
namespace MonitorOff {

    public enum MonitorState {
        MonitorStateOn = -1,
        MonitorStateOff = 2,
        MonitorStateStandBy = 1
    }

    public partial class Form1 : Form {
        [DllImport("user32.dll")]
        private static extern int SendMessage(int hWnd, int hMsg, int wParam, int lParam);

        public Form1() {
            InitializeComponent();
            SystemEvents.SessionSwitch += SystemEvents_SessionSwitch;
        }

        void SystemEvents_SessionSwitch(object sender, SessionSwitchEventArgs e) {
            SetMonitorInState(MonitorState.MonitorStateOff);
        }

        private void button1_Click(object sender, EventArgs e) {
            SetMonitorInState(MonitorState.MonitorStateOff);
        }

        private void SetMonitorInState(MonitorState state) {
            SendMessage(0xFFFF, 0x112, 0xF170, (int)state);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-03T11:08:28.050

**按下开/关按钮**

* * *

如果您想在代码中执行此操作，显然这在 Win32 API 中是可能的：

SendMessage hWnd、WM_SYSCOMMAND、SC_MONITORPOWER、参数

其中 WM_SYSCOMMAND = 0x112 和 SC_MONITORPOWER = 0xF170 和 param 指示将显示器置于的模式： -1：开启 2：关闭 1：节能模式

hWnd 可以是任何窗口的句柄 - 所以如果你有一个表单，这样的东西应该可以工作

```
int WM_SYSCOMMAND = 0x112;
int SC_MONITORPOWER = 0xF170;

[DllImport("user32.dll", CharSet = CharSet.Auto)]
private static extern int SendMessage(IntPtr hWnd, int wMsg, IntPtr wParam, IntPtr lParam);

public static void Main(string[] args)
{
    Form f = new Form();
    bool turnOff = true;   //set true if you want to turn off, false if on
    SendMessage(f.Handle, WM_SYSCOMMAND, (IntPtr)SC_MONITORPOWER, (IntPtr)(turnOff ? 2 : -1));
} 
```

注意我实际上没有尝试过这个......

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-02-05T00:53:44.940

上面的答案[https://stackoverflow.com/a/713504/636189](https://stackoverflow.com/a/713504/636189)非常适合关闭 Windows 7/8 显示器，但不适用于唤醒它。在这些系统上，您需要做一些像这样的黑客行为（如发现[https://stackoverflow.com/a/14171736/636189](https://stackoverflow.com/a/14171736/636189)）：

```
[DllImport("user32.dll")]
static extern void mouse_event(Int32 dwFlags, Int32 dx, Int32 dy, Int32 dwData, UIntPtr dwExtraInfo);

private const int MOUSEEVENTF_MOVE = 0x0001;

private void Wake(){
mouse_event(MOUSEEVENTF_MOVE, 0, 1, 0, UIntPtr.Zero);
Sleep(40);
mouse_event(MOUSEEVENTF_MOVE, 0, -1, 0, UIntPtr.Zero);
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-03-25T14:05:23.757

对于想要在**控制台应用程序**上使用此功能的人：

```
using System;
using System.Runtime.InteropServices;
using System.Timers;

namespace TurnScreenOFF
{
    class Program
    {
        private static int WM_SYSCOMMAND = 0x0112;
        private static uint SC_MONITORPOWER = 0xF170;

        public static void Main(string[] args)
        {
            SendMessage(GetConsoleWindow(), WM_SYSCOMMAND, (IntPtr)SC_MONITORPOWER, (IntPtr)2);
        }

        [DllImport("kernel32.dll")]
        static extern IntPtr GetConsoleWindow();

        [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern int SendMessage(IntPtr hWnd, int wMsg, IntPtr wParam, IntPtr lParam);
    }
} 
```

适应和测试。100% 在 Windows 8 上工作。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-01-11T07:19:59.513

此代码可用于打开和关闭。它也适用于 Windows 7。

```
 private int SC_MONITORPOWER = 0xF170;

    private uint WM_SYSCOMMAND = 0x0112;

    [DllImport("user32.dll")]
    static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, IntPtr wParam, IntPtr lParam);

    enum MonitorState
    {
        ON = -1,
        OFF = 2,
        STANDBY = 1
    }
    private void SetMonitorState(MonitorState state)
    {
        Form frm = new Form();

        SendMessage(frm.Handle, WM_SYSCOMMAND, (IntPtr)SC_MONITORPOWER, (IntPtr)state);

    } 
```

要调用该函数，您必须这样做：

```
SetMonitorState(MonitorState.ON); 
```

或者

```
SetMonitorState(MonitorState.OFF); 
```

注意：此代码在 WPF 应用程序中测试。使用以下命名空间：

```
using System.Runtime.InteropServices;
using System.Windows.Forms; 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-09-11T06:14:01.903

我找不到复制粘贴示例，所以自己创建了一个，不要忘记添加对 System.Windows.Forms 的引用。

```
using System;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;

namespace monitor_on_off
{
    class Program
    {
        [DllImport("user32.dll")]
        static extern IntPtr SendMessage(IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam);
        [DllImport("user32.dll")]
        static extern void mouse_event(Int32 dwFlags, Int32 dx, Int32 dy, Int32 dwData, UIntPtr dwExtraInfo);

        private const int WmSyscommand = 0x0112;
        private const int ScMonitorpower = 0xF170;
        private const int MonitorShutoff = 2;
        private const int MouseeventfMove = 0x0001;

        public static void MonitorOff(IntPtr handle)
        {
            SendMessage(handle, WmSyscommand, (IntPtr)ScMonitorpower, (IntPtr)MonitorShutoff);
        }

        private static void MonitorOn()
        {
            mouse_event(MouseeventfMove, 0, 1, 0, UIntPtr.Zero);
            Thread.Sleep(40);
            mouse_event(MouseeventfMove, 0, -1, 0, UIntPtr.Zero);
        }

        static void Main()
        {
            var form = new Form();

            while (true)
            {
                MonitorOff(form.Handle);
                Thread.Sleep(5000);
                MonitorOn();
                Thread.Sleep(5000);
            }
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-05-11T19:55:21.890

我已经完成了每个人发布的让显示器进入睡眠状态并稍后在其他时间唤醒它的每一种方法。当然，`SendMessage()`它确实适用于 Windows XP，但在显示器休眠一段时间后它不会唤醒显示器。我尝试过使用 C#、DOS、用于玩电源配置文件的脚本和 Powershell。最终我放弃了，回到了起点，我的第一个想法被证明是正确的。您需要`PostMessage()`在显示器关闭后使用，更好的是，您可能应该始终使用`PostMessage()`;

* * *

因此，您之前看到的所有代码都是正确的，而是使用以下代码：

```
using System.Runtime.InteropServices;
[DllImport("user32.dll")]
static extern IntPtr PostMessage(int hWnd, int msg, int wParam, int lParam);
PostMessage(-1, WM_SYSCOMMAND, SC_MONITORPOWER, MONITOR_OFF); 
```

* * *

此时执行并正常工作（2015 年 5 月 11 日）我正在运行

*   Windows 7 专业版 6.1.7601 Service Pack 1 Build 7601
*   Visual Studio Professional 2013 版本 12.0.31101.00 更新 4
*   .NET 框架 4.5.51209
*   C＃

我的系统完全是最新的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-10-16T14:12:31.937

SLOC最少的答案：

```
using System;
using System.Windows.Forms;
using System.Runtime.InteropServices;

static class Program
{
    [DllImport("user32.dll")]
    static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, int wParam, int lParam);

    [STAThread]
    static void Main()
    {
        SendMessage(new Form().Handle, 0x0112, 0xF170, 2);
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-19T08:05:05.513

`SendMessage()`对于 Windows 10（在 Pro 64 位上测试），我能够使用本页中提到的技术关闭显示器。但是，我无法重新打开显示器：“鼠标移动”技巧不起作用，该`SendMessage()`技术会将屏幕重新打开一秒钟然后关闭，使用`PostMessage()`并没有改变任何东西。

但诀窍其实很简单，我所要做的就是用`SendKeys()`. 我在这里使用 ALT 是因为它本身对系统没有影响，但它可以是任何其他键。

```
SendKeys.SendWait("%"); 
```

如果您不使用 Windows.Forms，发送“ALT”也可以使用[SendInput()](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-sendinput)，但实现时间更长。

# 3d - AS3 3D 地形纹理生成：寻找中级/高级思路

> ID：713499
> 
> 赞同：1
> 
> 时间：2009-04-03T11:06:56.883
> 
> 标签：3d, textures, procedural, terrain

我一直在抨击 AS3 的 Away3D，并制作了一个小地形生成器，使用 Perlin Noise 创建高度图，然后用于纹理，将 5 个图像拼接在一起（非常通用的基于噪声的水、海滩、草、岩石和雪) 取决于高度。

下一步去哪里？我怀疑我是否有能力直接为 3D 引擎做出贡献，但我想知道是否有人对诸如雨影和其他地理现象之类的东西胡作非为。例如，当云在山脉上空移动时，它的温度会下降，从而降低其保持水分的能力，因此在某些天气模式下，山脉的一侧会比另一侧更加茂盛。

我想知道是否有人可以推荐任何阅读材料。

非常感谢

编辑：放松认为我应该添加一张图片。网上有我醉醺醺的照片，一个可悲的不发达地形的东西应该不会更尴尬！感谢迄今为止的想法......嗯...... Lod'ing可能很有趣，也许在开始添加细节之前我应该​​看看我可以制作多大的地图。植被很有意义（呃……植物，当然！），我想知道我能在程序上做多少。

[替代文字 http://assemblism.com/terrain/images/stage1.jpg](http://assemblism.com/terrain/images/stage1.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T12:49:42.097

关于纹理渲染，我想到了很多东西。首先我不得不说我不是 100% 确定你在找什么。我只会发布我能想到的所有内容，您可以选择；）

*   改进一般纹理映射。地形的坡度是否会修改您将在给定顶点放置的纹理类型？是否有其他标准可用于指示使用哪种纹理？
*   整合昼夜循环。在地形周围移动太阳/月亮，以便您可以看到相应的照明变化。
*   自我阴影总是看起来很酷；）。
*   天空盒/圆顶也不会受到伤害。
*   添加程序生成的植被。
*   如果添加植被，请使其在地形上投下阴影。
*   考虑改进水渲染（反射、波浪、透明度）
*   我假设您使用某种纹理混合来混合从一个纹理到下一个纹理的过渡？
*   您是在使用一个在整个地图上拉伸的大纹理还是平铺纹理？
*   也许，重新考虑地形本身的渲染？你“只是”管理大量的顶点/边吗？如果是这样，请进一步研究管理地形数据的方法。四叉树/八叉树之类的东西通常用于此类问题。

这些点没有特别的顺序。

编辑：

[游戏开发网](http://www.gamedev.net/reference/list.asp?categoryid=40)

[gamasutra.com](http://www.gamasutra.com/visualcomputing/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T11:36:22.523

会想到更多的植被，例如树木或“灌木丛”，具体取决于您拥有多少草覆盖。你可以在不同的地方玩不同生长的树。也许有些树木在靠近水的地方生长得更快，而高山一侧的树木却萎缩而崎岖不平？

您可能需要考虑更多的天气现象，例如风（弯曲草、影响树木生长等）。

您还可以考虑修改地形需要采取什么措施，例如模拟在某处炸出一个洞的爆炸，或使表面裂开的地震。

听起来很有趣！

# subsonic - 脚手架 WhereExpression 被忽略

> ID：713501
> 
> 赞同：1
> 
> 时间：2009-04-03T11:07:26.867
> 
> 标签：subsonic

我正在将 SubSonic 与 Sqlite 数据库一起使用，一切都运行良好，但其中一件事不是 Scaffold 组件中的**WhereExpression**。我无法让它工作。WhereExpression="Emember=true" 表名="blah" >

还有其他人有这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T01:04:56.767

Never had the problem. I always like to bind in a method on a code behind, that way I can control the binding process.

The syntax is similar to below.

```
Dim sublist as new SubSonic.SqlQuery().From("Table").Where("ColumnName").IsEqualTo("Value").ExecuteList() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T19:07:52.657

我相信我们在最近的补丁中修复了这个问题（我相信来自你！）。你能帮我拉一下最新的（我认为是re​​v 509），看看它是否能解决你的问题？

# algorithm - 找到两个给定节点之间的路径？

> ID：713508
> 
> 赞同：48
> 
> 时间：2009-04-03T11:09:18.033
> 
> 标签：algorithm, path, graph-theory, pseudocode

假设我有按以下方式连接的节点，我如何得出给定点之间存在的路径数量以及路径详细信息？

```
1,2 //node 1 and 2 are connected
2,3
2,5
4,2
5,11
11,12
6,7
5,6
3,6
6,8
8,10
8,9 
```

找到从 1 到 7 的路径：

答案：找到 2 条路径，它们是

```
1,2,3,6,7
1,2,5,6,7 
```

![替代文字](https://farm4.static.flickr.com/3120/3409325514_68840abcb8.jpg)

[在这里](http://code.activestate.com/recipes/576675/)找到的实现很好，我将使用相同的

这是python中上述链接的片段

```
# a sample graph
graph = {'A': ['B', 'C','E'],
             'B': ['A','C', 'D'],
             'C': ['D'],
             'D': ['C'],
             'E': ['F','D'],
             'F': ['C']}

class MyQUEUE: # just an implementation of a queue

    def __init__(self):
        self.holder = []

    def enqueue(self,val):
        self.holder.append(val)

    def dequeue(self):
        val = None
        try:
            val = self.holder[0]
            if len(self.holder) == 1:
                self.holder = []
            else:
                self.holder = self.holder[1:]   
        except:
            pass

        return val  

    def IsEmpty(self):
        result = False
        if len(self.holder) == 0:
            result = True
        return result

path_queue = MyQUEUE() # now we make a queue

def BFS(graph,start,end,q):

    temp_path = [start]

    q.enqueue(temp_path)

    while q.IsEmpty() == False:
        tmp_path = q.dequeue()
        last_node = tmp_path[len(tmp_path)-1]
        print tmp_path
        if last_node == end:
            print "VALID_PATH : ",tmp_path
        for link_node in graph[last_node]:
            if link_node not in tmp_path:
                #new_path = []
                new_path = tmp_path + [link_node]
                q.enqueue(new_path)

BFS(graph,"A","D",path_queue)

-------------results-------------------
['A']
['A', 'B']
['A', 'C']
['A', 'E']
['A', 'B', 'C']
['A', 'B', 'D']
VALID_PATH :  ['A', 'B', 'D']
['A', 'C', 'D']
VALID_PATH :  ['A', 'C', 'D']
['A', 'E', 'F']
['A', 'E', 'D']
VALID_PATH :  ['A', 'E', 'D']
['A', 'B', 'C', 'D']
VALID_PATH :  ['A', 'B', 'C', 'D']
['A', 'E', 'F', 'C']
['A', 'E', 'F', 'C', 'D']
VALID_PATH :  ['A', 'E', 'F', 'C', 'D'] 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-03T11:38:44.873

[广度优先搜索](http://en.wikipedia.org/wiki/Breadth-first_search)遍历一个图，实际上是从一个起始节点找到所有路径。但是，通常 BFS 不会保留所有路径。相反，它更新了一个前身函数 π 以保存最短路径。您可以轻松地修改算法，以便`π(n)`不仅存储*一个*前任，而且存储可能的前任列表。

然后所有可能的路径都被编码在这个函数中，并且通过递归地遍历 π 你得到所有可能的路径组合。

在Cormen*等人**的《算法导论》中*可以找到使用这种表示法的一个很好的伪代码。并随后被用于该主题的许多大学脚本中。谷歌搜索“BFS 伪代码前身 π”[在 Stack Exchange 上根除了这个命中](https://softwareengineering.stackexchange.com/q/287017/2366)。

 ** * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-06-04T19:17:45.283

对于那些不是 PYTHON 专家的人，C++ 中的相同代码

```
//@Author :Ritesh Kumar Gupta
#include <stdio.h>
#include <vector>
#include <algorithm>
#include <vector>
#include <queue>
#include <iostream>
using namespace std;
vector<vector<int> >GRAPH(100);
inline void print_path(vector<int>path)
{
    cout<<"[ ";
    for(int i=0;i<path.size();++i)
    {
        cout<<path[i]<<" ";
    }
    cout<<"]"<<endl;
}
bool isadjacency_node_not_present_in_current_path(int node,vector<int>path)
{
    for(int i=0;i<path.size();++i)
    {
        if(path[i]==node)
        return false;
    }
    return true;
}
int findpaths(int source ,int target ,int totalnode,int totaledge )
{
    vector<int>path;
    path.push_back(source);
    queue<vector<int> >q;
    q.push(path);

    while(!q.empty())
    {
        path=q.front();
        q.pop();

        int last_nodeof_path=path[path.size()-1];
        if(last_nodeof_path==target)
        {
            cout<<"The Required path is:: ";
            print_path(path);
        }
        else
        {
            print_path(path);
        }

        for(int i=0;i<GRAPH[last_nodeof_path].size();++i)
        {
            if(isadjacency_node_not_present_in_current_path(GRAPH[last_nodeof_path][i],path))
            {

                vector<int>new_path(path.begin(),path.end());
                new_path.push_back(GRAPH[last_nodeof_path][i]);
                q.push(new_path);
            }
        }

    }
    return 1;
}
int main()
{
    //freopen("out.txt","w",stdout);
    int T,N,M,u,v,source,target;
    scanf("%d",&T);
    while(T--)
    {
        printf("Enter Total Nodes & Total Edges\n");
        scanf("%d%d",&N,&M);
        for(int i=1;i<=M;++i)
        {
            scanf("%d%d",&u,&v);
            GRAPH[u].push_back(v);
        }
        printf("(Source, target)\n");
        scanf("%d%d",&source,&target);
        findpaths(source,target,N,M);
    }
    //system("pause");
    return 0;
}

/*
Input::
1
6 11
1 2 
1 3
1 5
2 1
2 3
2 4
3 4
4 3
5 6
5 4
6 3
1 4

output:
[ 1 ]
[ 1 2 ]
[ 1 3 ]
[ 1 5 ]
[ 1 2 3 ]
The Required path is:: [ 1 2 4 ]
The Required path is:: [ 1 3 4 ]
[ 1 5 6 ]
The Required path is:: [ 1 5 4 ]
The Required path is:: [ 1 2 3 4 ]
[ 1 2 4 3 ]
[ 1 5 6 3 ]
[ 1 5 4 3 ]
The Required path is:: [ 1 5 6 3 4 ]

*/ 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-03T11:52:46.667

Dijkstra 的算法更适用于加权路径，听起来发布者想要找到所有路径，而不仅仅是最短路径。

对于这个应用程序，我将构建一个图表（您的应用程序听起来不需要定向）并使用您最喜欢的搜索方法。听起来您想要所有路径，而不仅仅是猜测最短的路径，因此请使用您选择的简单递归算法。

唯一的问题是图形是否可以是循环的。

通过连接：

*   1, 2
*   1、3
*   2、3
*   2、4

在寻找从 1->4 的路径时，您可能有一个 1 -> 2 -> 3 -> 1 的循环。

在这种情况下，我会保留一个堆栈作为遍历节点。这是一个包含该图的步骤和结果堆栈的列表（抱歉格式化 - 没有表格选项）：

**当前节点**（可能的下一个节点减去我们来自哪里）[堆栈]

1.  **1** (2, 3) [1]
2.  **2** (3, 4) [1, 2]
3.  **3** (1) [1, 2, 3]
4.  **1** (2, 3) [1, 2, 3, 1] //错误 - 堆栈上的重复数字 - 检测到循环
5.  **3** () [1, 2, 3] // 后退到节点 3 并将 1 从堆栈中弹出。没有更多的节点可以从这里探索
6.  **2** (4) [1, 2] // 后退到节点 2 并将 1 从堆栈中弹出。
7.  **4** () [1, 2, 4] // 找到目标节点 - 路径的记录堆栈。没有更多的节点可以从这里探索
8.  **2** () [1, 2] //后退到节点 2 并从堆栈中弹出 4。没有更多的节点可以从这里探索
9.  **1** (3) [1] //后退到节点 1 并将 2 从堆栈中弹出。
10.  **3** (2) [1, 3]
11.  **2** (1, 4) [1, 3, 2]
12.  **1** (2, 3) [1, 3, 2, 1] //错误 - 堆栈上的重复数字 - 检测到循环
13.  **2** (4) [1, 3, 2] //后退到节点 2 并从堆栈中弹出 1
14.  **4** () [1, 3, 2, 4] 找到目标节点 - 路径的记录堆栈。没有更多的节点可以从这里探索
15.  **2** () [1, 3, 2] //后退到节点 2 并从堆栈中弹出 4。没有更多节点
16.  **3** () [1, 3] // 后退到节点 3 并将 2 从堆栈中弹出。没有更多节点
17.  **1** () [1] // 后退到节点 1 并将 3 从堆栈中弹出。没有更多节点
18.  用 [1, 2, 4] 和 [1, 3, 2, 4] 的 2 条记录路径完成

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-20T02:22:14.657

原始代码有点麻烦，如果您想使用 BFS 来查找图上 2 点之间是否存在路径，您可能需要使用 collections.deque。这是我破解的一个快速解决方案：

注意：如果两个节点之间不存在路径，此方法可能会无限继续。我还没有测试所有的情况，YMMV。

```
from collections import deque

# a sample graph
  graph = {'A': ['B', 'C','E'],
           'B': ['A','C', 'D'],
           'C': ['D'],
           'D': ['C'],
           'E': ['F','D'],
           'F': ['C']}

   def BFS(start, end):
    """ Method to determine if a pair of vertices are connected using BFS

    Args:
      start, end: vertices for the traversal.

    Returns:
      [start, v1, v2, ... end]
    """
    path = []
    q = deque()
    q.append(start)
    while len(q):
      tmp_vertex = q.popleft()
      if tmp_vertex not in path:
        path.append(tmp_vertex)

      if tmp_vertex == end:
        return path

      for vertex in graph[tmp_vertex]:
        if vertex not in path:
          q.append(vertex) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-09-15T12:02:02.813

在 Prolog（特别是 SWI-Prolog）中

```
:- use_module(library(tabling)).

% path(+Graph,?Source,?Target,?Path)
:- table path/4.

path(_,N,N,[N]).
path(G,S,T,[S|Path]) :-
    dif(S,T),
    member(S-I, G), % directed graph
    path(G,I,T,Path). 
```

测试：

```
paths :- Graph =
    [ 1- 2  % node 1 and 2 are connected
    , 2- 3 
    , 2- 5 
    , 4- 2 
    , 5-11
    ,11-12
    , 6- 7 
    , 5- 6 
    , 3- 6 
    , 6- 8 
    , 8-10
    , 8- 9
    ],
    findall(Path, path(Graph,1,7,Path), Paths),
    maplist(writeln, Paths).

?- paths.
[1,2,3,6,7]
[1,2,5,6,7]
true. 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T11:45:42.673

如果您想要所有路径，请使用递归。

使用邻接表，最好创建一个函数 f() 来尝试填充当前访问顶点列表。像这样：

```
void allPaths(vector<int> previous, int current, int destination)
{
    previous.push_back(current);

    if (current == destination)
        //output all elements of previous, and return

    for (int i = 0; i < neighbors[current].size(); i++)
        allPaths(previous, neighbors[current][i], destination);
}

int main()
{
    //...input
    allPaths(vector<int>(), start, end);
} 
```

由于向量是按值传递的（因此在递归过程中进一步向下进行的任何更改都不是永久性的），因此会枚举所有可能的组合。

您可以通过引用传递*前一个*向量来提高效率（因此不需要一遍又一遍地复制向量），但您必须确保事情得到 popped_back() 手动。

还有一件事：如果图表有循环，这将不起作用。（我假设在这种情况下你会想要找到所有*简单的*路径，然后）在向前一个向量添加一些东西*之前*，首先检查它是否已经在那里。

如果您想要所有*最短*路径，请使用此算法的 Konrad 建议。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-23T18:58:00.330

给定邻接矩阵：

{0, 1, 3, 4, 0, 0}

{0, 0, 2, 1, 2, 0}

{0, 1, 0, 3, 0, 0}

{0, 1, 1, 0, 0, 1}

{0, 0, 0, 0, 0, 6}

{0, 1, 0, 1, 0, 0}

以下 Wolfram Mathematica 代码解决了查找图的两个节点之间的所有简单路径的问题。我使用了简单的递归和两个全局变量来跟踪循环并存储所需的输出。代码并没有仅仅为了代码清晰而优化。“打印”应该有助于澄清它是如何工作的。

```
cycleQ[l_]:=If[Length[DeleteDuplicates[l]] == Length[l], False, True];
getNode[matrix_, node_]:=Complement[Range[Length[matrix]],Flatten[Position[matrix[[node]], 0]]];

builtTree[node_, matrix_]:=Block[{nodes, posAndNodes, root, pos},
    If[{node} != {} && node != endNode ,
        root = node;
        nodes = getNode[matrix, node];
        (*Print["root:",root,"---nodes:",nodes];*)

        AppendTo[lcycle, Flatten[{root, nodes}]];
        If[cycleQ[lcycle] == True,
            lcycle = Most[lcycle]; appendToTree[root, nodes];,
            Print["paths: ", tree, "\n", "root:", root, "---nodes:",nodes];
            appendToTree[root, nodes];

        ];
    ];

appendToTree[root_, nodes_] := Block[{pos, toAdd},
    pos = Flatten[Position[tree[[All, -1]], root]];
    For[i = 1, i <= Length[pos], i++,
        toAdd = Flatten[Thread[{tree[[pos[[i]]]], {#}}]] & /@ nodes;
        (* check cycles!*)            
        If[cycleQ[#] != True, AppendTo[tree, #]] & /@ toAdd;
    ];
    tree = Delete[tree, {#} & /@ pos];
    builtTree[#, matrix] & /@ Union[tree[[All, -1]]];
    ];
]; 
```

调用代码：initNode = 1; 结束节点 = 6; lcycle = {}; 树 = {{initNode}}; builtTree[initNode, 矩阵];

路径：{{1}} 根：1---节点：{2,3,4}

路径：{{1,2},{1,3},{1,4}} 根：2---节点：{3,4,5}

路径：{{1,3},{1,4},{1,2,3},{1,2,4},{1,2,5}} 根：3---节点：{2, 4}

路径：{{1,4},{1,2,4},{1,2,5},{1,3,4},{1,2,3,4},{1,3,2, 4},{1,3,2,5}} 根：4---节点：{2,3,6}

路径：{{1,2,5},{1,3,2,5},{1,4,6},{1,2,4,6},{1,3,4,6},{ 1,2,3,4,6},{1,3,2,4,6},{1,4,2,5},{1,3,4,2,5},{1,4, 3,2,5}} 根：5---节点：{6}

结果：{{1, 4, 6}, {1, 2, 4, 6}, {1, 2, 5, 6}, {1, 3, 4, 6}, {1, 2, 3, 4, 6}, {1, 3, 2, 4, 6}, {1, 3, 2, 5, 6}, {1, 4, 2, 5, 6}, {1, 3, 4, 2, 5, 6}, {1, 4, 3, 2, 5, 6}}

...不幸的是，我无法上传图像以更好地显示结果:(

[http://textanddatamining.blogspot.com](http://textanddatamining.blogspot.com)

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2009-04-03T11:14:39.363

您要做的基本上是在（有向？）图中找到两个顶点之间的路径，如果您需要最短路径，请查看[Dijkstra 算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)，或者如果您需要任何存在的路径，请编写一个简单的递归函数。

# .net - Windows VB.NET 1.1 到 2.0 升级 - 好处？

> ID：713512
> 
> 赞同：1
> 
> 时间：2009-04-03T11:10:07.470
> 
> 标签：.net, windows, winforms, upgrade

我们有一个相当大的基于 Windows 的 1.1 .NET 应用程序，我们正在考虑升级到 2.0。我们考虑更新的主要原因是我们可以利用 Visual Studio 2008 进行项目的持续开发，以及我们使用 Infragistics Suite 控件和 1.1 集不再更新新功能。

由于这是一个仅适用于一个组织的内部 Windows 应用程序，而不是安全问题更受关注的公共 Web 应用程序，因此从这种升级中可以看到哪些可能的好处？对于基于 Windows 的应用程序，2.0 和 1.1 的其他优点是否有性能和其他改进？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T11:11:59.337

[泛型](http://www.15seconds.com/issue/031024.htm)将是我列表中的主要好处。

自 .NET 1.1 天以来，WinForms 设计器获得了多项可用性改进，文本对齐指南是我的最爱之一。

但是，我会问您为什么不一直迁移到 .NET 3.5？

## 编辑

[迁移到.NET 3.5](http://en.wikipedia.org/wiki/.NET_Framework#.NET_Framework_3.5)的理由

*   这是最新版本！
*   [LINQ](http://msdn.microsoft.com/en-us/vbasic/aa904594.aspx)
*   [扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)（不太重要，但“不错”的补充）

在短暂迁移到 .NET 2.0 和最近迁移到 .NET 3.5 之前，我使用了 .NET 1.1 几年。在查询和处理列表（数组、集合等）中存在的任何类型的数据时，我不能低估使用 LINQ 语法所带来的巨大好处。我在 LINQ 上找到的最易读的信息是[Charlie Calvert 的博客](http://blogs.msdn.com/charlie/archive/tags/LINQ/default.aspx)。

如果您打算在较新版本的 .NET 中构建您的应用程序，然后使用 Infragistics 控制套件，那么您可能无法利用 .NET 3.5 中的语言添加，但给自己机会这样做未来对我来说很有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T11:22:14.257

对 1.1 的工具/框架支持正在真正消失，这本身就是一种激励。也就是说，根据您使用的功能，您将在 2.0 运行时中看到性能改进。数据集、泛型、GC……仅举几例。

Imo，泛型和 lambdas 等语言创新也提高了生产力。

# ruby-on-rails - 多态关联不保存 ClassName（没有 STI），有什么提示吗？

> ID：713514
> 
> 赞同：1
> 
> 时间：2009-04-03T11:11:50.337
> 
> 标签：ruby-on-rails, activerecord, associations, polymorphism

我有两个模型，一个叫做 Notes，一个叫做 Comments。评论可以与许多其他模型相关联，因此我使用多态关联。在 schema.rb 中它看起来像这样：

```
 create_table "comments", :force => true do |t|
t.text     "body"
t.integer  "user_id"
t.integer  "commentable_id"
t.integer  "commentable_type"
t.datetime "created_at"
t.datetime "updated_at" end 
```

当我想将评论保存到笔记时，一切似乎都有效：

```
 # POST /comments
  # POST /comments.xml
  def create
    @comment = Comment.new(params[:comment])
    @comment.user = current_user
    respond_to do |format|
      if @comment.save
        process_file_uploads
        flash[:notice] = 'Comment was successfully created.'
        if !params[:note_id].nil?
          @note = Note.find(params[:note_id])
          debugger
          @note.comments << @comment
          format.html { redirect_to(@note) }
          format.xml  { render :xml => @note, :status => :created, :location => @note }
        else
          format.html { redirect_to(@comment) }
          format.xml  { render :xml => @comment, :status => :created, :location => @comment }
        end
      else
        format.html { render :action => "new" }
        format.xml  { render :xml => @comment.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

奇怪的是，在评论表中它保存了 commentable_type = 0 而不是 = "Note" 应该是。如果我输入@note.comments，它仍然会找到评论。

```
Comment Update (0.4ms)   UPDATE `comments` SET `commentable_type` = 0, `commentable_id` = 11, `updated_at` = '2009-04-03 10:55:50' WHERE `id` = 5 
```

我不明白这种行为。你有什么想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T12:23:30.587

你很亲密！只需将您的 commentable_type 列更改为字符串而不是整数，它应该会正确填充（当然假设您的模型声明是正确的）。作为参考，我将提供一个如何设置的示例：

```
# Comment model
class Comment < ActiveRecord::Base
  belongs_to :commentable, :polymorphic => true
end

# Other models which can contain comments
class AnotherModel < ActiveRecord::Base
  has_many :comments, :as => :commentable
end

class YetAnotherModel < ActiveRecord::Base
  has_many :comments, :as => :commentable
end 
```

同样对于处于这种情况的任何人，这里有一个可以做出改变的迁移：

```
class ChangeCommentableTypeToString < ActiveRecord::Migration
  def self.up
    change_column(:comments, :commentable_type, :string)
  end

  def self.down
    change_column(:comments, :commentable_type, :integer)
  end
end 
```

# c# - 访问 C# 匿名类型对象

> ID：713521
> 
> 赞同：12
> 
> 时间：2009-04-03T11:13:23.640
> 
> 标签：c#, anonymous-types

如何访问声明范围之外的匿名类型的对象？

例如

```
void FuncB()
{
var obj = FuncA();
Console.WriteLine(obj.Name);
}

??? FuncA()
{
var a = (from e in DB.Entities
where e.Id == 1
select new {Id = e.Id, Name = e.Name}).FirstOrDefault();

return a;
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-03T11:46:28.380

正如其他答案所述，**您真的不应该这样做**。但是，如果你坚持，那么有一个令人讨厌的黑客被称为“以身作则”，它可以让你做到这一点。[此处](http://tomasp.net/blog/cannot-return-anonymous-type-from-method.aspx)和[此处](http://msmvps.com/blogs/jon_skeet/archive/2009/01/09/horrible-grotty-hack-returning-an-anonymous-type-instance.aspx)的几篇文章中提到了该技​​术。

```
public void FuncB()
{
    var example = new { Id = 0, Name = string.Empty };

    var obj = CastByExample(FuncA(), example);
    Console.WriteLine(obj.Name);
}

private object FuncA()
{
    var a = from e in DB.Entities
            where e.Id == 1
            select new { Id = e.Id, Name = e.Name };

    return a.FirstOrDefault();
}

private T CastByExample<T>(object target, T example)
{
    return (T)target;
} 
```

[（虽然其中一篇文章的作者说他也不想与它相关联，](https://webcache.googleusercontent.com/search?q=cache:x_rICZ2nnxUJ:https://blogs.msmvps.com/jonskeet/2009/01/09/horrible-grotty-hack-returning-an-anonymous-type-instance/+&cd=1&hl=en&ct=clnk&gl=us)但我不能把这个黑客归功于这个黑客。他的名字可能很熟悉。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T11:15:33.760

您不能从函数返回匿名类型。

从[MSDN 文档](http://msdn.microsoft.com/en-us/library/bb397696.aspx)：

> 要在方法边界之外传递匿名类型或包含匿名类型的集合，您必须首先将类型强制转换为对象。然而，这破坏了匿名类型的强类型。如果您必须存储查询结果或将它们传递到方法边界之外，请考虑使用普通的命名结构或类而不是匿名类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-24T17:18:58.220

如果您使用的是 .NET 4.0，则可以为此使用元组，您将返回一个`Tuple<int, string>`. 您可以为 2.0/3.5 实现自己的元组，实际上其他人已经拥有，所以如果您愿意，您应该可以这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T11:17:09.653

匿名类型只是编译器生成的类，编译器不愿意告诉你类本身的名称。因此，除了返回对`object`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T11:17:35.597

好吧，我认为答案是：不要在声明的范围之外使用匿名类型。在这种情况下，创建一个简单类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-24T16:23:02.840

将为这种情况创建一个类：

```
public class LISTFUNCA   
{                         
    public int identificacion;  
    public string nombre;      
} 
```

然后：

```
public List<LISTFUNCA> FuncA()   
{                                          
    var lista = (from e in DB.Entities where e.Id == 1                        
                select new { identificacion = e.Id, nombre = e.Name})
                .FirstOrDefault();  
    return lista.ToList(); 
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-02T04:30:57.040

开源框架[Impromptu-Interface](http://code.google.com/p/impromptu-interface/)将允许您将匿名对象强制转换为接口。它的优点是不那么 hacky，因为它可以跨程序集边界按预期工作。它使用轻量级代理和 dlr 来实现这一点。

# python - 如何使用 SoapPy 在 Web 服务请求中禁用 v1 标记？

> ID：713522
> 
> 赞同：1
> 
> 时间：2009-04-03T11:14:07.960
> 
> 标签：python, web-services, soappy

我正在尝试使用 SOAPpy 编写 Web 服务客户端。然而，在定义 WSDL 对象之后，对 Web 服务方法的调用被包装在一个

```
 <v1> .. actual parameters .. </v1> 
```

如何禁用此 v1 标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T12:45:29.410

您可以通过在参数调用列表中提供名称来给出标签的名称，即：

```
server.GetList(GetListRequest = { "order" : "asc" }) 
```

然后`v1`被替换`GetListRequest`为我最初想要的。

# c# - 使用 Outlook 自动化创建邮件时如何将收件人地址设为只读？

> ID：713532
> 
> 赞同：0
> 
> 时间：2009-04-03T11:15:49.750
> 
> 标签：c#, outlook, automation

当您使用 Office 自动化在 Outlook 中创建和显示邮件消息时，是否可以将“收件人”文本框设置为只读？我们使用以下代码来创建消息：

```
 Outlook.Application objOutlook = new Outlook.Application();
   Outlook.MailItem mail = (Outlook.MailItem)objOutlook.CreateItem(OlItemType.olMailItem);
   // setting properties...
   mail.Display(modal); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T11:53:25.667

我知道没有简单的方法，但一种方法是使用 P/Invoke 和本机 API 将文本框的状态设置为只读。它涉及获取文本框的句柄，这是棘手的部分。如果您使用 Spy++，您可能会深入了解窗口的层次结构以及如何获取它的句柄。

# .net - .NET 正则表达式引擎是否支持内联模式修饰符？

> ID：713536
> 
> 赞同：4
> 
> 时间：2009-04-03T11:19:41.907
> 
> 标签：.net, regex

我公司使用的 AC# 应用程序从数据库表中获取正则表达式字符串，并将它们匹配到不同的文本文件中。问题是应用程序没有将 RegexOptions 设置为默认值，我需要使用“点匹配新行”模式。

引擎是否支持内联模式修饰符，就像

```
"A(?s)(.*?)(?-s)B" 
```

或 PHP 中的“全局”模式修饰符

```
"/A(.*?)B/s" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T16:32:03.873

除了 RegexOptions 编译器标志之外，没有直接等效`/s`的修饰符样式，但是您可以通过在正则表达式的最开始放置一个内联修饰符来获得相同的效果：

```
"(?s)A(.*?)B" 
```

请注意，内联修饰符有两种形式。您在示例中使用的那个：

```
"A(?s)(.*?)(?-s)B" 
```

...没有冒号。这`(?s)`只是一个打开 DOTALL 模式直到`(?-s)`再次关闭它的开关。另一个带有冒号的版本实际上是一个非捕获组，`(?:...)`内置了模式开关。模式开关只有在该组内的正则表达式部分受控制时才有效。使用该版本，您的示例将变为

```
"A(?s:.*?)B" 
```

...或者，如果您仍想使用捕获组：

```
"A(?s:(.*?))B" 
```

您不想混淆这两个版本。如果您要像这样编写原始正则表达式：

```
"A(?s:)(.*?)(?-s:)B" 
```

...它不会抛出异常，但不会按预期工作。将`(?s:)`在 DOTALL 模式下不匹配任何内容，而在非 DOTALL 模式下`(?-s:)`将匹配更多内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T11:28:11.327

当然可以（支持内联模式修饰符）！

只需使用模式修饰符`(?s:)`打开“单行模式”，使点字符匹配换行符。

要检查正则表达式在 .NET 风格中的工作方式，我发现使用使用 .NET Regex 引擎的[RAD Regex Designer](http://www.radsoftware.com.au/regexdesigner/)很方便。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T11:24:22.507

是的。见[这里](http://msdn.microsoft.com/en-us/library/yd1hzczs.aspx)。

```
(?s:) 
```

应该打开单行模式。

# svn - Subversion：可以在一个版本中完成多个复制操作吗？

> ID：713538
> 
> 赞同：7
> 
> 时间：2009-04-03T11:20:17.477
> 
> 标签：svn, transactions, copy, pvcs

根据我对 Subversion 中事务的了解，这原则上应该是可能的，但我不知道有任何工具支持它。

背景是我们正在讨论从 PVCS 维度到 Subversion 的迁移，Subversion 中引用的主要功能是“设计部件”。设计部分是可以一起处理的任意文件集合，例如子项目所需的所有源文件。

替换它的一个想法是通过 Makefile 中的复制操作，将相关文件复制到分支中。但是如果所有文件都单独复制，这可能会导致大量的修订，这可能会使历史混乱，所以最好避免这种情况。

**编辑：** 更多背景信息：

该项目由几个（5-10）个单独发布的子项目组成，但它们共享一些公共源文件和从其他项目导入的外部库。

设计部分引用的一个原因是限制对源文件的依赖关系，另一个是为了管理子项目的产品，以便可以在一次操作中在版本控制中更新所有产品。这两种文件都散布在目录中。

我们大约有 5 名开发人员参与该项目。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T11:47:09.940

有一个工具 svnmucc 可以做到这一点，而不需要工作副本：

[http://subversion.tigris.org/tools_contrib.html#svnmucc_c](http://subversion.tigris.org/tools_contrib.html#svnmucc_c)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-06-24T19:36:12.530

您可以使用：`svn copy FROM_URL1 FROM_URL2 URL_TO`

例如：

```
svn copy svn://192.168.1.50/trunk/folder1 svn://192.168.1.50/trunk/folder2 svn://192.168.1.50/tags/MY_TAG 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-03T11:39:54.793

您可以在工作副本中制作副本，并在以后一次全部提交。这只会创建一个修订版。

使用命令行客户端，它可能看起来像这样：

```
svn copy file1 directory
svn copy file2 directory
svn copy file3 directory
svn commit 
```

主要缺点是您需要一个工作副本，并且该工作副本必须包含源目录和目标目录。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T13:35:38.697

这很有趣，我刚刚快速阅读了设计部分，从我能收集到的内容中，通过有效地将文件单独分支到任意结构中，当你开始时你将走向一个痛苦的世界将事物合并回其原始位置（并且合并可能不会在所有文件的单个提交中完成）。

但我认为你可以做类似的事情来设计颠覆中的部分，并进行一些调整：

首先，可以使用外部对象模拟设计部分（1.6 版本允许外部对象指向文件和目录）。为此，您可以像这样设置项目层次结构：

```
/project1
 /trunk
  /doc
   /design1
   /release2
  /src
   /subproject1
   /subproject2
 /tags
 /branches
 /parts
  /part1
  /part2
  /part3 
```

每个部件文件夹将仅包含一个“svn:externals”属性，该属性将该部件的适当文件引入适当的子位置，例如：

```
svn:externals

../../trunk/src/subproject1       src/subproject1
../../trunk/doc/release2          doc/release2 
```

然后，您检查零件，而不是主干，您会得到一个工作副本，其中仅包含零件定义的结构中所需的文件，当您提交时，您将直接进入主干 - 此处不需要合并。

您还可以通过首先分支整个主干（便宜且快速），然后更改您的部件外部以指向分支而不是主干来为您的部件设置基线。这不会增加存储库的大小，并且您的工作副本保持完全相同的结构，您只是从分支而不是主干获取所有文件。对该部分的任何更新也会违反分支 - 合并该部分的更改只是将分支重新集成到主干的沼泽标准重新集成合并，这是标准的 svn 实践。

管理部件的定义变得更加有趣，因为在上面的方案中，每个部件都是手动定义的，它们不是分层的。您需要某种形式的脚本（可能是 makefile），它知道部件层次结构并给定部件名称，可以构建适当的外部定义，然后可以将其应用于部件目录。

因此，虽然 subversion 没有显式地提供部件的抽象层，但它可以相当准确地手动建模——您只受 svn:externals 的功能和用于管理它们的脚本的限制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T11:43:49.807

你为什么不把你的子项目放到一个自己的子目录中。

```
Project
   |
   ---> Subproject 1
   ---> Subproject 2
   Files from project. 
```

通过这种方式，您始终可以对完整的子项目进行操作。

在这里，我们有：

```
Project
   |
   ---> common Files
   ---> Subprojects... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T11:45:45.293

如果所有项目都在他们自己的存储库中，svn externals 可能会解决问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-26T14:31:22.280

我面临着类似的问题：如何将分散在存储库中的多个文件复制到一个标签中，并在一个事务中使其快速，从而进行一次修订。最简单的方法是创建临时工作副本目录，将所有需要的文件复制到那里，然后将本地工作副本复制到远程存储库并删除临时目录：

```
svn mkdir TMP_DIR
svn mkdir TMP_DIR\MY_TAG
svn cp --parents src\test\File.txt TMP_DIR\MY_TAG\src\test\File.txt
svn cp --parents src\test2\File2.txt TMP_DIR\MY_TAG\src\test2\File2.txt
svn cp -m "comment" TMP_DIR\MY_TAG "http://myrepohost/myrepo/tags/"
svn rm --force TMP_DIR 
```

希望有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-30T11:44:54.233

您的工作流程/代码组织错误：

如果您在不同的包之间有共享代码，那么这显然属于一个单独的包。每个包裹一棵树。

将几个包（特定版本）放在某个环境中（例如，由几个可能可选的组件组成的更大的软件产品）属于上面的单独层：发行版，并由发行版的包管理基础设施处理。

# java - 类加载器混淆

> ID：713540
> 
> 赞同：10
> 
> 时间：2009-04-03T11:21:27.957
> 
> 标签：java, classloader

我在几个地方看到“Class.getClassLoader() 返回用于加载该特定类的 ClassLoader”，因此，我对以下示例的结果感到困惑：

```
 package test;

import java.lang.*;

public class ClassLoaders { 
    public static void main(String[] args) throws java.lang.ClassNotFoundException{
      MyClassLoader mcl = new MyClassLoader();
      Class clazz = mcl.loadClass("test.FooBar");
      System.out.println(clazz.getClassLoader() == mcl); // prints false
      System.out.println(clazz.getClassLoader()); // prints e.g. sun.misc.Launcher$AppClassLoader@553f5d07
    }
}

class FooBar { }

class MyClassLoader extends ClassLoader { } 
```

clazz.getClassLoader() == mcl 语句不应该返回 true 吗？有人可以解释我在这里缺少什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-03T11:28:15.617

每当您创建自己的类加载器时，它将附加在类加载器的树状层次结构中。为了加载一个类，类加载器首先将加载委托给它的父类。只有当所有的父母都没有找到类时，首先被要求加载类的加载器才会尝试加载它。

在您的特定情况下，加载被委托给父类加载器。尽管您要求 MyClassLoader 加载它，但加载的是父级。在这种情况下，它是 AppClassLoader。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T11:29:34.613

引用[ClassLoader 的 API 文档](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html)：

> ClassLoader 的每个实例都有一个关联的父类加载器。当请求查找类或资源时，ClassLoader 实例将在尝试查找类或资源本身之前将对该类或资源的搜索委托给其父类加载器。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-03T11:27:35.273

如果自定义类加载器将调用委托给虚拟机的类加载器，由谁加载类。clazz.getClassLoader() 将返回这个类加载器。

深入了解：[ClassLoader 类](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html#loadClass(java.lang.String,%20boolean))的 Javadoc提供了以下对执行步骤顺序的解释：

> 加载具有指定二进制名称的类。此方法的默认实现按以下顺序搜索类：
> 
> 1.  调用 findLoadedClass(String) 来检查类是否已经加载。
> 2.  在父类加载器上调用 loadClass 方法。如果 parent 为 null，则使用虚拟机内置的类加载器。
> 3.  调用 findClass(String) 方法来查找类。

由于您在未更改方法的情况下继承了该方法，因此此行为将保持不变。步骤 2 将是加载类的步骤。当您调用 ClassLoader 的无参数构造函数时（自动地，因为您没有在 MyClassLoader 中定义构造函数），您会自动使用内置的 ClassLoader。

# .net - 在运行时设置 DataContract 的 DataMember 属性？

> ID：713543
> 
> 赞同：1
> 
> 时间：2009-04-03T11:23:40.603
> 
> 标签：.net, attributes

是否可以在运行时动态设置数据合同的数据成员属性？基本上我需要的是在序列化时读取包含两个属性的 DataMemeber 属性的类的序列化实例，但是当前的“版本”不再具有它们，但我需要迁移这些属性中的旧数据集转到新的处理......所以我需要的是让数据合同反序列化器读取包括这些“旧”值的数据，并使用新配置重新序列化它们（因为这些属性的数据现在被存储和处理完全不同）。

这可能吗？

干杯&谢谢。-约尔格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T11:37:16.000

您可以指定类型/已知类型 - 但不能指定 AFAIK 成员信息。`XmlSerializer`这里有点宽容......旧类型是否有机会使用 xml 属性？（而不是数据合同属性）。

另一种选择是提供`IDataContractSurrogate`- 但这并非微不足道。

您是否有机会使用旧属性*和*属性（等）来装饰您正在使用的任何新机制的类？

如果数据很简单（即只有一种或两种类型，在一个简单的关系中），您可以使用一组**并行**的类来反序列化，然后将数据（属性到属性等）复制到新的数据结构中，然后重新-连载。随着模型复杂性的增加，这变得更加困难。

# jquery - IE 使用 $.get 发送 POST 而不是 GET

> ID：713546
> 
> 赞同：1
> 
> 时间：2009-04-03T11:24:30.977
> 
> 标签：jquery, ajax, asp.net-mvc

我有小问题。我不能`AcceptVerb.Get`在某些 ASP.NET MVC 操作上使用，因为当我使用`$.get(..)`IE 时发送 POST 而不是 GET。为什么？？？

编辑：忘记添加我想要的 Firefox 工作 - Firefox 中的相同代码执行 GET。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T12:23:01.850

我相信 $.get() 的工作方式与 $.load() 相同，如果您发送额外的参数，它将执行一个帖子。

# java - 在 Windows 上用 Java 并发文件写入

> ID：713550
> 
> 赞同：17
> 
> 时间：2009-04-03T11:25:51.940
> 
> 标签：java, file-io, portability, concurrency

当您在同一个文件上同时打开两个（或多个）FileOutputStreams 时会发生什么？

[Java API](http://java.sun.com/javase/6/docs/api/)是这样说的：

> 特别是某些平台，一次只允许一个 FileOutputStream（或其他文件写入对象）打开一个文件进行写入。

我猜 Windows 不是这样的平台，因为我有两个线程读取一些大文件（每个都是不同的），然后将其写入同一个输出文件。没有抛出异常，文件被创建并且似乎包含来自两个输入文件的块。

附带问题：

*   Unix 也是这样吗？
*   而且由于我希望行为相同（实际上我希望一个线程正确写入，而另一个线程被警告冲突），我如何确定文件已经打开以进行写入？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-03T16:49:32.630

当文件有另一个写入者时，没有一种可靠的、跨平台的方式来被动通知——即，如果文件已经打开以进行写入，则引发异常。但是，有一些技术可以帮助您主动检查这一点。

如果多个进程（可以是 Java 和非 Java 的混合）可能正在使用该文件，请使用[`FileLock`](http://docs.oracle.com/javase/6/docs/api/java/nio/channels/FileLock.html). 成功使用文件锁的关键是记住它们只是“建议”。如果您检查它，则可以保证该锁是可见的，但如果您忘记了，它不会阻止您对文件执行操作。所有访问文件的进程都应该设计为使用锁定协议。

如果单个 Java 进程正在处理该文件，您可以使用 Java 内置的并发工具来安全地执行此操作。您需要一个对所有线程可见的映射，它将每个文件名与其对应的锁实例相关联。[相关问题](https://stackoverflow.com/questions/659915/synchronizing-on-an-integer-value)的答案可以很容易地调整为使用`File`对象或文件的[规范路径](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#getCanonicalPath())来做到这一点。锁定对象可以是一个`FileOutputStream`，一些围绕流的包装器，或者一个[`ReentrantReadWriteLock`.](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T11:28:28.143

我会警惕让操作系统为您确定文件状态（因为这取决于操作系统）。如果您有共享资源，我将使用可[重入锁限制对它的访问](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/ReentrantLock.html)

使用这个锁意味着一个线程可以获取资源（文件）并写入它。下一个线程可以检查这个锁是否被另一个线程持有，和/或无限期地阻塞直到第一个线程释放它。

Windows（我认为）会限制两个进程写入同一个文件。我不相信 Unix 会这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T11:40:16.930

如果您正在谈论的 2 个线程在同一个 JVM 中，那么您可以在某个地方有一个两个线程都可以访问的布尔变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T20:30:26.373

Unix 允许并发写入同一个文件。

您不应该多次尝试写入同一个文件。如果你是你有一个设计缺陷。

# php - 使用 regenerateId() 时 Zend_Session 丢失

> ID：713552
> 
> 赞同：1
> 
> 时间：2009-04-03T11:26:46.587
> 
> 标签：php, zend-framework, session

我现在在几个 ZF 应用程序中遇到了这个问题，这非常令人沮丧：

在我的引导程序顶部附近，我有以下两行

```
Zend_Session::start();
Zend_Session::regenerateId(); 
```

我的应用程序需要使用 Zend_Auth 进行身份验证，并使用默认会话存储来保持身份。会话随机丢失，显示用户已注销。如果我删除对 Zend_Session::regenerateId() 的调用，则会话不会丢失。

重新生成会话 ID 可以提高安全性，所以我想让它工作。这个问题发生在我的本地开发服务器（windows）和我们的登台服务器（linux）上

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T12:49:08.073

阅读您的问题后，我一直在寻找解决您问题的方法。实际上根据 Zend Framework: Documentation 解决方案很简单。

“如果用户已成功登录您的网站，请使用 rememberMe() 而不是 regenerateId()。”

我希望这会帮助你。

问候，

尤尼斯

[编辑：这是我找到这个的链接：[Zend 框架：文档](http://framework.zend.com/manual/en/zend.session.global_session_management.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-09-27T16:00:16.273

Zend_Session 有一个相关的问题。由于以下问题，您的会话可能已丢失：

尝试使用这个：

```
Zend_Session::rememberMe(100); // any value here 
```

然后使用您的会话数据集（例如用户登录）转到应用程序中的任何页面，并非常快速地（如双击）单击浏览器的刷新按钮 3-5 次。你会看到你的会话数据已经消失了:(

我可以解决这个问题的唯一方法是暂时不使用 rememberMe() 方法。我希望有人能在这里阐明这个问题。我认为 regenerateId() 方法以某种方式弄乱了 cookie 值，因此从浏览器到服务器的后续调用不会与现有会话 ID 相关联。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-30T14:11:11.203

我在使用会话 cookie 时遇到了同样的问题，当 cookie 过期时一切正常。

使用记住我功能时，到期日期设置为作为参数给出的秒数。

我的解决方案是在创建新 Zend_Application 之后和 call 之前将会话重新生成代码放在 index.php 中`$application->bootstrap()->run();`，每 5 个请求重新生成 id。

```
/** Zend_Application */
require_once 'Zend/Application.php';

// Create application, bootstrap, and run
$application = new Zend_Application(
                APPLICATION_ENV,
                APPLICATION_PATH . '/configs/application.ini'
);

// set httponly option (when set in application.ini it dosent work) 
Zend_Session::setOptions(array('cookie_httponly' => true));

//regenerate sessionid after 5 hits
$defaultNamespace = new Zend_Session_Namespace();
if ($defaultNamespace->initialized > 3) {
    Zend_Session::regenerateId();
    $defaultNamespace->initialized = 0;
} else {
    $defaultNamespace->initialized++;
}

//run application
$application->bootstrap()->run(); 
```

# java - 在 1 个项目中管理多个 Google Web Toolkit 页面

> ID：713555
> 
> 赞同：1
> 
> 时间：2009-04-03T11:27:59.563
> 
> 标签：java, gwt

我有一个项目，主要由 Java Servlet、JSP/Html 页面和一些常规 javascript 组成。但是，有些屏幕太复杂而无法仅用 javascript 完成，所以我想使用 GWT。

是否可以这样做，所以`EntryPoint`同一个项目中有多个类？然后，根据正在加载的页面，我将加载适当的 javascript 文件？

我在想，也许该`RootPanel.get()`函数将用于检查是否`<div>s`存在具有给定 ID 的某些内容。例如，如果 signup div 存在，则加载 sign up GWT 控件，如果 'search' div 存在则加载 Search，但这会使 javascript 文件变得非常大。我宁愿每个组件都在自己的 javascript 文件中。

那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T13:50:24.837

我认为最好将页面分成 GWT 模块。如果您将使用 RootPanel.get() 检查特定插槽（DIV 或其他元素）是否存在，您的模块将保存您的所有 UI，因此客户端将加载整个模块，仅访问一个页面 - 这很可能是不必要的开销。您可以将通用代码放在某个模块中，您的所有页面模块都将从该模块继承。

RootPanel.get() 更适合您拥有一组小部件（UI 中的逻辑面板，例如菜单、主要内容等），您可以将它们放置在页面上的适当位置中。

您的应用程序中的示例结构如下所示（请参阅评论中的问题）：

```
- gwtui
-- common (module1)
--- client
---- widgets (eg. common widgets)
---- ...
---- ApplicationService.java
---- ApplicationServiceAsync.java
--- public
---- images (common images etc.)
---- css (common style)
---- ...
--- server
---- ...
---- ApplicationServiceImpl.java
--- GwtCommon.gwt.xml
-- expenses (module2)
--- client
---- ExpensesEntrypoint.java
--- public
--- server
--- GwtExpenses.gwt.xml (inherits GwtCommon, entry point ExpensesEntrypoint)
-- reports (module2)
--- client
---- ReportsEntrypoint.java
--- public
--- server
--- GwtReports.gwt.xml (inherits GwtCommon, entry point ReportsEntrypoint) 
```

请注意，您可以在所有模块中使用一项服务，以及在公共模块中您可能不必创建入口点（但我不是 100% 确定，在一些旧项目中我必须创建空入口点，但不要'不记得确切的原因 - 抱歉）

这对我们有用。

我当然想听听不同的意见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T13:56:52.623

我建议您查看[Optimizing a GWT Application with Multiple EntryPoints](http://raibledesigns.com/rd/entry/optimizing_a_gwt_application_with)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-05T23:00:18.773

这是我就这个确切主题进行的五分钟闪电演讲： [http ://www.youtube.com/watch?v=0DuR9xDvrHA&feature=channel_page](http://www.youtube.com/watch?v=0DuR9xDvrHA&feature=channel_page)

可以理解，你不能在 5 分钟内提供大量信息，所以希望这会给你足够的帮助，但如果你还有其他问题，请随时提问。

我打算提供更多代码示例，但我还没有找到时间。

# ruby - 如何在 Ruby 中标记这个字符串？

> ID：713559
> 
> 赞同：12
> 
> 时间：2009-04-03T11:28:35.320
> 
> 标签：ruby, parsing, tokenize, text-parsing

我有这个字符串：

```
%{Children^10 Health "sanitation management"^5} 
```

我想将其转换为将其标记为哈希数组：

```
[{:keywords=>"children", :boost=>10}, {:keywords=>"health", :boost=>nil}, {:keywords=>"sanitation management", :boost=>5}] 
```

我知道 StringScanner 和[Syntax gem](http://syntax.rubyforge.org/)，但我找不到足够的代码示例。

任何指针？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-03T12:17:02.270

对于一门真正的语言，词法分析器是必经之路——[就像 Guss 所说](https://stackoverflow.com/questions/713559/how-do-i-tokenize-this-string-in-ruby/713608#713608)的那样。但是，如果完整的语言只和你的例子一样复杂，你可以使用这个快速破解：

```
irb> text = %{Children^10 Health "sanitation management"^5}
irb> text.scan(/(?:(\w+)|"((?:\\.|[^\\"])*)")(?:\^(\d+))?/).map do |word,phrase,boost|
       { :keywords => (word || phrase).downcase, :boost => (boost.nil? ? nil : boost.to_i) }
     end
#=> [{:boost=>10, :keywords=>"children"}, {:boost=>nil, :keywords=>"health"}, {:boost=>5, :keywords=>"sanitation management"}] 
```

如果您正在尝试解析常规语言，那么这种方法就足够了 - 尽管使语言变得非常规并不需要更多的复杂性。

正则表达式的快速分解：

*   `\w+`匹配任何单项关键字
*   `(?:\\.|[^\\"]])*`使用非捕获括号 ( `(?:...)`) 来匹配转义双引号字符串的内容 - 转义符号 ( `\n`, `\"`,`\\`等) 或任何不是转义符号或结束引号的单个字符。
*   `"((?:\\.|[^\\"]])*)"`仅捕获引用的关键字词组的内容。
*   `(?:(\w+)|"((?:\\.|[^\\"])*)")`匹配任何关键字 - 单个术语或短语，将单个术语捕获到`$1`并将短语内容捕获到`$2`
*   `\d+`匹配一个数字。
*   `\^(\d+)`捕获插入符号 ( `^`) 后面的数字。由于这是第三组捕获括号，它将被捕获到`$3`.
*   `(?:\^(\d+))?`如果存在插入符号后面的数字，则捕获该数字，否则匹配空字符串。

`String#scan(regex)`尽可能多地将正则表达式与字符串匹配，输出“匹配”数组。如果正则表达式包含捕获括号，则“匹配”是捕获的项目数组 - 因此`$1`变为`match[0]`、`$2`变为`match[1]`等。任何未与部分字符串匹配的捕获括号映射到`nil`结果“匹配”中的条目。

然后`#map`获取这些匹配项，使用一些块魔法将每个捕获的术语分解为不同的变量（我们可以这样做`do |match| ; word,phrase,boost = *match`），然后创建您想要的哈希值。恰好是`word`or`phrase`之一`nil`，因为两者都不能与输入匹配，所以`(word || phrase)`将返回非`nil`一，`#downcase`并将其​​转换为全小写。 `boost.to_i`将字符串转换为整数，同时`(boost.nil? ? nil : boost.to_i)`确保`nil`boosts 保持不变`nil`。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-03T13:55:42.297

这是一个使用`StringScanner`. 这是我刚刚改编自[Ruby Quiz: Parsing JSON](http://rubyquiz.com/quiz155.html)的代码，它有一个很好的解释。

```
require 'strscan'

def test_parse
  text = %{Children^10 Health "sanitation management"^5}
  expected = [{:keywords=>"children", :boost=>10}, {:keywords=>"health", :boost=>nil}, {:keywords=>"sanitation management", :boost=>5}]

  assert_equal(expected, parse(text))
end

def parse(text)
  @input = StringScanner.new(text)

  output = []

  while keyword = parse_string || parse_quoted_string
    output << {
      :keywords => keyword,
      :boost => parse_boost
    }
    trim_space
  end

  output
end

def parse_string
  if @input.scan(/\w+/)
    @input.matched.downcase
  else
    nil
  end
end

def parse_quoted_string
  if @input.scan(/"/)
    str = parse_quoted_contents
    @input.scan(/"/) or raise "unclosed string"
    str
  else
    nil
  end
end

def parse_quoted_contents
  @input.scan(/[^\\"]+/) and @input.matched
end

def parse_boost
  if @input.scan(/\^/)
    boost = @input.scan(/\d+/)
    raise 'missing boost value' if boost.nil?
    boost.to_i
  else
    nil
  end
end

def trim_space
  @input.scan(/\s+/)
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T11:49:06.393

您在这里拥有的是任意语法，并且要解析它，您真正想要的是词法分析器 - 您可以编写一个描述您的语法的语法文件，然后使用词法分析器从您的语法生成递归解析器。

编写词法分析器（甚至是递归解析器）并不是一件容易的事——尽管它是编程中的一个有用练习——但你可以在此电子邮件中找到 Ruby 词法分析器/解析器的列表：http: [//newsgroups.derkeiler.com /Archive/Comp/comp.lang.ruby/2005-11/msg02233.html](http://newsgroups.derkeiler.com/Archive/Comp/comp.lang.ruby/2005-11/msg02233.html)

RACC 作为 Ruby 1.8 的标准模块提供，所以我建议您专注于它，即使它的手册不是很容易理解并且需要熟悉 yacc。

# c# - 如何在匿名类型中定义方法？

> ID：713561
> 
> 赞同：2
> 
> 时间：2009-04-03T11:29:09.187
> 
> 标签：c#, .net

如何定义一个方法，例如`void doSuff()`匿名类型？我能找到的所有文档都只使用匿名的，基本上仅限于属性列表。我什至可以在匿名类型中定义一个方法吗？

编辑：好的，快速浏览一下非常快速的答案告诉我这是不可能的。有没有办法动态地构造一个类型并将匿名方法添加到该类型的委托属性？我正在寻找一种 C# 方法来完成以下 JavaScript 的功能：

```
...
person.getCreditLimit = function() { ... }
... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T11:42:31.620

嗯，你可以。使用委托，您只需将方法视为数据：

```
var myMethods = from x in new[] { "test" }
                select new { DoStuff = new Func<string>(() => x) };

var method = myMethods.First();
var text = method.DoStuff(); 
```

你认为“文字”的价值是什么？

使用 Action<> 和 Func<> 泛型类型，您可以（几乎）在其中放置任何您想要的东西。几乎，因为您不能例如访问匿名类型的其他属性，如下所示：

```
var myMethods = from x in new[] { "test" }
                select new { Text = x, DoStuff = new Func<string>(() => Text) }; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T11:52:29.897

与代表一起，您绝对可以：

```
Action action = MethoThatDoesSomething;
var obj = new
          {
              DoSomething = action
          };

obj.DoSomething(); 
```

我尝试在 lambda 中使用`new { ... }`它并没有用，但上面完全没问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T11:30:08.700

你不能，至少不能达到 .NET 3.5。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T11:51:24.860

那这个呢：

```
 var anonType = new
        {
            FirstName = "James",
            LastName = "Bond",
            FullName = new Action<string, string>(
                (x, y) =>
                    { 
                        Console.WriteLine(x + y );
                    })                
        };

        anonType.FullName("Roger","Moore"); 
```

基本上使用 Lambda 作为委托

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T11:35:36.020

你不能。但您可以尝试以下方法：

```
var test = new { Foo = new Func<string>(() => "hello") };
test.Foo.Invoke(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T11:37:17.450

你不能。Anonymouse 类型仅包含具有公共 get 修饰符和覆盖 GetHashCode()、Equals() 和 ToString() 的属性。

```
var myclass = new { Name = "Andy", Location = "Bellingham", Sector = 0, }; 
```

从反射器：

```
[CompilerGenerated, DebuggerDisplay(@"\{ Name = {Name}, Location = {Location}, Sector = {Sector} }", Type="<Anonymous Type>")]
internal sealed class <>f__AnonymousType0<<Name>j__TPar, <Location>j__TPar, <Sector>j__TPar>
{
    // Fields
    [DebuggerBrowsable(DebuggerBrowsableState.Never)]
    private readonly <Location>j__TPar <Location>i__Field;
    [DebuggerBrowsable(DebuggerBrowsableState.Never)]
    private readonly <Name>j__TPar <Name>i__Field;
    [DebuggerBrowsable(DebuggerBrowsableState.Never)]
    private readonly <Sector>j__TPar <Sector>i__Field;

    // Methods
    [DebuggerHidden]
    public <>f__AnonymousType0(<Name>j__TPar Name, <Location>j__TPar Location, <Sector>j__TPar Sector)
    {
        this.<Name>i__Field = Name;
        this.<Location>i__Field = Location;
        this.<Sector>i__Field = Sector;
    }

    [DebuggerHidden]
    public override bool Equals(object value)
    {
        var type = value as <>f__AnonymousType0<<Name>j__TPar, <Location>j__TPar, <Sector>j__TPar>;
        return ((((type != null) && EqualityComparer<<Name>j__TPar>.Default.Equals(this.<Name>i__Field, type.<Name>i__Field)) && EqualityComparer<<Location>j__TPar>.Default.Equals(this.<Location>i__Field, type.<Location>i__Field)) && EqualityComparer<<Sector>j__TPar>.Default.Equals(this.<Sector>i__Field, type.<Sector>i__Field));
    }

    [DebuggerHidden]
    public override int GetHashCode()
    {
        int num = 0x5fabc4ba;
        num = (-1521134295 * num) + EqualityComparer<<Name>j__TPar>.Default.GetHashCode(this.<Name>i__Field);
        num = (-1521134295 * num) + EqualityComparer<<Location>j__TPar>.Default.GetHashCode(this.<Location>i__Field);
        return ((-1521134295 * num) + EqualityComparer<<Sector>j__TPar>.Default.GetHashCode(this.<Sector>i__Field));
    }

    [DebuggerHidden]
    public override string ToString()
    {
        StringBuilder builder = new StringBuilder();
        builder.Append("{ Name = ");
        builder.Append(this.<Name>i__Field);
        builder.Append(", Location = ");
        builder.Append(this.<Location>i__Field);
        builder.Append(", Sector = ");
        builder.Append(this.<Sector>i__Field);
        builder.Append(" }");
        return builder.ToString();
    }

    // Properties
    public <Location>j__TPar Location
    {
        get
        {
            return this.<Location>i__Field;
        }
    }

    public <Name>j__TPar Name
    {
        get
        {
            return this.<Name>i__Field;
        }
    }

    public <Sector>j__TPar Sector
    {
        get
        {
            return this.<Sector>i__Field;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-04T15:06:53.897

你可以：

```
// this line should be in class body, not in method
delegate void MyDelegate(); 
var Obj = new {
    MyDel = new MyDelegate(delegate() { MessageBox.Show("yee-haw"); })
};
Obj.MyDel(); 
```

如果不想声明委托类型，可以使用 System.Func<>：

```
var Obj = new {
    MyFunc = new Func<string>( delegate() { return "yee-haw"; })
};
MessageBox.Show(Obj.MyFunc()); 
```

# asp.net - ASP.NET 应用程序 - 设置 IE7 兼容模式？

> ID：713581
> 
> 赞同：5
> 
> 时间：2009-04-03T11:39:28.990
> 
> 标签：asp.net, internet-explorer-8

在 ASP.NET 应用程序中设置 IE7 兼容模式模式以处理 IE8 问题的最简单方法是什么？是否可以通过 web.config 进行设置，或者必须在 IIS 或页面级别进行设置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T11:44:33.080

添加标题

`X-UA-Compatible: IE=EmulateIE7`

在站点的 HTTP 标头选项卡或 IIS 管理器中的应用程序属性中。在 IIS7 中，它的 HTTP 响应标头功能。

您可以将其放在`<system.webServer>`web.config 的部分

```
 <httpProtocol>
        <customHeaders>
            <add name="X-UA-Compatible" value="IE=EmultateIE7" />
        </customHeaders>
    </httpProtocol> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-31T13:07:39.337

如果此处发布的解决方案对您不起作用，请在此处查看我的问题和回答[ASP.NET Ignores IE7 Compatibility Mode Tag in Web.config](https://stackoverflow.com/questions/1209183/asp-net-ignores-ie7-compatibility-mode-tag-in-web-config/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T11:45:07.777

您可以使用 META 标签来影响 IE8 以相应地设置其模式：

[http://weblogs.asp.net/fredriknormen/archive/2009/03/19/change-ie8-to-ie7-compatible-mode-with-meta-tags.aspx](http://weblogs.asp.net/fredriknormen/archive/2009/03/19/change-ie8-to-ie7-compatible-mode-with-meta-tags.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-14T14:30:28.487

代替`value="IE=EmultateIE7"`

用。。。来代替`value="IE=EmulateIE7"`

# spring - 如何从多个路径弹簧加载 JPA 类？

> ID：713586
> 
> 赞同：3
> 
> 时间：2009-04-03T11:42:48.000
> 
> 标签：spring, jpa

所以我有一个spring应用程序分为几个模块，每个模块都在一个单独的项目中。每个模块都有自己的 JPA 实体，我使用 Spring ORM 进行配置：

```
<beans ...>

<context:component-scan
    base-package="org.myapp.module1.persistence" />

<context:component-scan
    base-package="org.myapp.module2.persistence" />

...

<context:annotation-config />

<tx:annotation-driven />

...

</beans> 
```

persistence.xml 文件如下所示：

```
<persistence ...>

<persistence-unit name="myunit" />

</persistence> 
```

我的问题是，当 Spring 上下文初始化时，它只会在 persistence.xml 文件的同一路径上查找 @Entity 类，并且会忽略其他项目的类路径。

我尝试拥有多个persistence.xml，每个都与@Entity 类位于同一路径中，但在这种情况下，一旦Spring 找到第一个persistence.xml，它就会停止加载，并且不会在其他路径上找到任何@Entity 类。

我怎样才能让 Spring 看到一切？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-30T20:16:54.580

如果您想从多个文件构建单个持久性单元，`persistence.xml`您可以使用Spring Data JPA 中提供的[MergingPersistenceUnitManager 。](https://github.com/SpringSource/spring-data-jpa/blob/master/src/main/java/org/springframework/data/jpa/support/MergingPersistenceUnitManager.java)确保为所有持久性单元提供相同的名称。当然，您必须使用通配符导入`persistence.xml`：`classpath*:META-INF/persistence.xml`

问候，奥利

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T08:34:18.357

也许[spring jpa - 多个持久性单元](http://static.springframework.org/spring/docs/2.5.x/reference/orm.html#orm-jpa-multiple-pu)确实有帮助

# business-logic - 业务逻辑软件选择

> ID：713597
> 
> 赞同：1
> 
> 时间：2009-04-03T11:45:54.497
> 
> 标签：business-logic

您目前使用什么软件来实现业务逻辑？

我们有一个具有非常繁重的业务逻辑的应用程序，它是用 Java 和 POJO 和 EJB (2.0) 实现的。

是否有任何更新的软件语言或工具有利于用于编写业务逻辑？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T04:11:21.493

在我看来，要走的路是开始转向使用规则引擎。我知道我们有很大的动力开始在我们的一个应用程序中使用规则引擎，该应用程序的决策逻辑非常繁重。使用规则引擎可以让您从业务逻辑中提取一些决策逻辑，并允许以更易于阅读的格式指定它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T11:48:56.470

根据您对“业务逻辑”的确切含义，[Drools](http://www.jboss.org/drools/)或[Jess](http://www.jessrules.com/)等规则引擎可能是实现它们的更有效方式。

# asp.net - AJAX 和 asp.net 安全问题

> ID：713600
> 
> 赞同：0
> 
> 时间：2009-04-03T11:46:21.393
> 
> 标签：asp.net, javascript, wcf, security

我有几个关于 asp.net (2.0) 中的安全机制的问题。

我一直在使用 Forms authentication + Page.User 来验证权限。

现在我需要将一些数据从客户端 javaScript (jQuery) 发送到 WCF 服务。我的 IPrincipal 是否仍然可以从 WCF 服务的 HttpContext 访问（我将我的服务托管在同一个 IIS、同一个域上）。

如果 $.Ajax 将获取客户端身份验证 cookie 并将其分配给服务器上的 HttpContext （或者它是否自动发生），我特别感兴趣？

这里有哪些可能的陷阱/陷阱？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T11:53:21.687

您可以，但需要在 WCF 服务的 web.config 中设置此属性。

```
<system.serviceModel>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
</system.serviceModel> 
```

# json - 从解析函数中传递JSON obj？| 菜鸟javascript问题

> ID：713610
> 
> 赞同：0
> 
> 时间：2009-04-03T11:50:19.993
> 
> 标签：json, function, global-variables, pass-by-value

我正在尝试将对象从函数中传递出去。这是我的代码：

```
<script type="text/javascript">

// finds the head element; creates a script with passed url; appends it to the head
function loadJSON(url) {
  var headID = document.getElementsByTagName("head")[0];         
  var newScript = document.createElement('script');
      newScript.type = 'text/javascript'; // isn't this 'application/json' really?
      newScript.src = url;
  headID.appendChild(newScript);
}

function parseJSON(o) {
  if (content == null) {
    document.write("<p>parseJSON(): JSON failed.</p>");
    return false;
  }

  isDST = "<strong>not</strong> ";
  if ( o.rawOffset == o.dstOffset ) {
    isDST = "";
  }
  document.getElementById("geonames").innerHTML = "<p>The time now is " + o.time + " in " + o.countryName +".</p>";
}

var lat = "47.01"; var long = "10.2"; // test data for austria
var jsonUrl = " {{URL}} ";
loadJSON(jsonUrl);
</script> 
```

我想要做的不是在 parseJSON 函数中使用对象 o 我想将对象传递出去，以便在 loadJSON() 调用之后我可以对对象进行操作。我发现在 parse 函数中调用 innerHTML 并不“整洁”。

我已经尝试了很多迭代，例如在脚本开始时声明“var jsonOutput”，然后制作“jsonOutput = o”，但这只是让 jsonOutput 未定义。如果我尝试返回 jsonOutput，那么我不知道它被返回到哪里，无论如何我都无法使用它。

我需要创建一个全局变量吗？我尝试了一个简单的“全局 jsonOutput”声明，但它似乎没有在函数内部进行修改。

卡住了，请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T12:11:46.963

此外，您似乎正在尝试使用`<script>`标签加载 JSON 数据。

您还可以通过[XMLHttpRequest](http://developer.apple.com/internet/webcontent/xmlhttpreq.html)加载 JSON 数据，然后通过以下方式将其转换为对象：

```
var dataObject = eval('(' + myJSONData + ')'); 
```

如果您无法验证数据的安全性，您可以使用[官方 JSON JavaScript 解析器](https://github.com/douglascrockford/JSON-js)（请参阅[此处](http://json.org/js)了解更多信息）在执行数据之前对其进行验证。

史蒂夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T12:08:30.760

我不太确定我是否完全理解您的情况，但是您是否尝试过返回整个对象而不是仅返回布尔值或 json？

```
function parseJSON(o)
{
   // Your code here
   var result = new Object();
   result.IsSuccess = true; // or false
   result.JSON = someData; // your json output
   return result;
}

function loadJSON()
{
   // Your code here
   var jsonParseResult = ParseJSON(o);
   if (jsonParseResult.IsSuccess)
   {
       // More code here involving jsonParseResult.JSON
   }
} 
```

# security - 将密码返回给 Web 用户

> ID：713611
> 
> 赞同：1
> 
> 时间：2009-04-03T11:50:28.403
> 
> 标签：security, password-policy

我收到了构建一个向经过身份验证的用户显示新密码的页面的不幸要求。我没有成功地抗议这个要求，因为这是一个普遍的坏主意，但我认为陪审团仍然存在，所以也许有人反对显示我还没有尝试过的新密码。你有什么建议吗？

其次，将密码以图像而不是文本的形式显示给用户会更好吗？我担心文本被“刮掉”，我认为使用图像会更困难。如何确保图像不会被用户浏览器缓存？

提前致谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T11:59:10.923

图像不会很安全。

如果您使用 HTTPS，那么无论哪种方式，密码都是安全的。如果您使用 HTTP，那么密码将以明文形式从表单中发送（我假设您正在显示它以进行某种确认），几秒钟后如何显示它并不重要。

重要的是确保显示密码的页面是不可缓存的。

```
Cache-control: no-cache, no-store, must-revalidate 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T11:58:55.900

你试过以下吗？

*   您无法显示密码，因为您不存储它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T12:10:09.883

我不确定您要构建什么以及要求是什么，但作为一般经验法则，我不认为这是一个严重的安全问题。让我们看看攻击向量：

1.  中间人攻击 HTTP 文本流量 - 图像，尤其是对 OCR（CAPTCHA 样式）进行模糊处理的图像将阻止这种攻击，但也可以简单地使用 HTTPS，如porneL 提到的。
2.  远程桌面应用程序的屏幕抓取 - HTTPS 保护无济于事，屏幕上的混乱图像也无济于事（人类攻击者也可以通过以下方式绕过您对“中间人”的模糊图像保护指示听众存档图像，然后手动检查它们）。如果屏幕刮板后面有人，那么您将没有保护。
3.  在你的肩膀上窃听 - 如果攻击者只是站在用户身后，那么再次 - 你没有保护。

请注意，如果您的密码是自动生成的，那么您必须将其显示给用户，这是没有办法的。网站试图减轻威胁的一种方法是通过电子邮件发送密码 - 假设用户可以确保他们在没有人查看时阅读电子邮件，在他们自己的时间。不幸的是，电子邮件甚至不会让您受益于加密来保护传输。

在我看来，最好的方法是让用户输入密码（在密码混淆字段中，就像通常那样），然后只存储密码的哈希值，这样你就不需要存储实际密码，防止你显示它给用户。如果您必须向用户展示它（可能是因为您正在生成它），那么请确保您通过 HTTPS 并仅展示它 - 所有的宣传只会使实现复杂化，而不会带来任何安全优势。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T12:09:48.823

我不确定这是否真的是个坏主意。您必须以任何一种方式将新密码发送给用户。作为未加密的电子邮件发送具有相同的问题 - 使用 Web 邮件时被捕获或被缓存。

我建议使用图像，可能是一些类似的验证码。但这只能保护一点免受自动攻击，而不是人为攻击。

确保事情安全的唯一方法是使用加密，建议使用 HTTPS。然后使用您的网站进行展示可能会比依赖电子邮件或类似的解决方案更安全。

让用户输入新密码也有同样的问题 - 现在您必须将其发送回服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-28T03:41:46.030

我只是建议使用 HTTPS 加密流量并仅存储临时密码的哈希值，这样实际密码就不会存储在数据库中。当然，您无法阻止物理“黑客”（例如偷偷摸摸的人）窃取临时密码，但如果可能，您可以要求用户在使用临时密码登录时立即更改密码，从而减轻使用临时密码的风险。

# .net - 如何检查在 Web 服务请求期间发送了哪些 xml？

> ID：713616
> 
> 赞同：4
> 
> 时间：2009-04-03T11:51:38.260
> 
> 标签：.net, web-services

有没有办法获取由.net 中的 SOAP 请求生成的原始 XML。我不知道如何准确地问这个问题，但是这里有

我添加了网络参考并调用了一些方法。有没有办法知道正在发送什么 XML。仅用于调试目的，如此快速和肮脏的方式就足够了

使用了 PS SSL，所以这里截图没有帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T11:56:42.070

[我通常用Fiddler](http://www.fiddlertool.com/fiddler)做这种事情。

将其粘贴在配置文件中：-

```
<system.net>
    <defaultProxy enabled="true">
        <proxy proxyaddress="http://127.0.0.1:8888" bypassonlocal="False"/>
    </defaultProxy>
</system.net> 
```

启动 fiddler，您应该能够监控来自您的应用程序的所有 http 流量。只需在关闭提琴手之前将启用设置为 false。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T13:26:25.817

您可以创建一个 SoapExtensionAttribute 并将其应用于您的 Web 服务方法。

创建一个派生自 SoapExtensionAttribute 的类。

创建另一个派生自 SoapExtension 的类。

您的 SoapExtensionAttribute 的类型应该是您的 SoapExtension 的类型。

进入 SoapExtension 后，您就可以访问数据被序列化/反序列化的时刻。

以下是4个具体阶段：

```
SoapMessageStage.BeforeSerialize
SoapMessageStage.AfterSerialize           *
SoapMessageStage.BeforeDeserialize        *
SoapMessageStage.AfterDeserialize 
```

带有“*”的那些是您要访问流的阶段。从那里，您可以记录进出 Web 服务的 xml。

这就是我们在这里所做的，它工作得很好。

这是一个详细解释的链接：http: [//progtutorials.tripod.com/soapext.htm](http://progtutorials.tripod.com/soapext.htm)

希望对您有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T11:56:53.487

获取通过网络发送的任何数据的最简单方法是安装[wireshark](http://www.wireshark.org/)，并在原始数据通过网络堆栈时对其进行窥探。好处是，在任何其他应用程序或服务修改它之前，您可以真正看到正在发送的内容。网上有很多[例子和博客](http://geekswithblogs.net/EltonStoneman/archive/2009/01/29/debugging-soap-messages-with-wireshark.aspx)。

您还可以使用它来[重放soap 请求](http://mikehadlow.blogspot.com/2009/01/capturing-and-playing-back-web-service.html)。它也适用于其他网络 - 不仅仅是 SOAP，还有普通的 HTTP 和 TCP，甚至是串行通信。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T11:53:28.613

你可以试试：[http](http://www.pocketsoap.com/tcpTrace/) ://www.pocketsoap.com/tcpTrace/ 。

# asp.net - 如何通过 Visual Studio 识别 ASP.NET 站点是“正常”运行还是“调试”运行？

> ID：713626
> 
> 赞同：0
> 
> 时间：2009-04-03T11:54:12.060
> 
> 标签：asp.net, visual-studio, visual-studio-2008, debugging

如何确定我的网站运行在什么“模式”下？

在这种特定情况下，我在代码隐藏页面中的代码应该在“发布”模式下以一种方式运行 - 即有人使用浏览器在那里导航，如果我处于来自 VS2008 的调试模式，则另一种方式。（例如识别要使用的 SQL 连接字符串、是否显示某些错误或警告消息等）

VS2008 被配置为通过 IIS 有多种原因（Cassini 不是一个选项）。

搜索所有帮助我找不到任何东西，但必须有一种方法来确定网站是如何启动的。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T11:58:23.377

我不确定你是什么意思。如果您想知道应用程序当前是否正在调试，您可以检查该`System.Diagnostics.Debugger.IsAttached`属性。如果你想知道应用程序是否在调试模式下编译，那么你可以这样做：

```
#if DEBUG
   const bool DebugMode = true;
#else
   const bool DebugMode = false;
#endif 
```

此外，您可以使用 ConditionalAttribute：

```
[System.Diagnostics.Conditional("DEBUG")]
public void ThisMethodWillOnlyExecuteInDebugMode()
{
} 
```

不过，我强烈建议重新考虑这一点——根据我的经验，拥有不同的发布和调试行为是将错误引入生产代码的绝佳方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T12:05:15.417

```
HttpContext.Current.IsDebuggingEnabled 
```

看[这篇文章](http://www.west-wind.com/Weblog/posts/10228.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T12:03:22.957

我使用这种方法来检测编译部分是否打开了调试：-

```
bool DebugModeOn()
{
    System.Web.Configuration.CompilationSection configSection =
             (System.Web.Configuration.CompilationSection)HttpContext.Current.GetSection("system.web/compilation");
    return configSection.Debug;

} 
```

这并不完全符合您的要求。但是，由于这在生产中应该是错误的，而在开发中应该是正确的，所以它可能已经足够好了。

**编辑**：或者你可以简单地使用上下文的 IsDebuggingEnabled 属性，正如 Olivier PAYEN 指出的那样。:P 哎呀。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T12:07:20.560

我会用

```
#if DEBUG
    // ...
#else
    // ...
#endif 
```

但是，我只会将其用于“Main”方法中的异常捕获：

*   如果调试，则不要捕获（因此调试器可以捕获任何未捕获的异常），
*   如果释放，则显示错误页面。

这些不会改变程序的流程，只是不要那样做，有龙:)

例如，如果您查看连接字符串，我会将它们放在 web.config 中。

# programming-languages - 企业级Scala

> ID：713629
> 
> 赞同：5
> 
> 时间：2009-04-03T11:56:11.570
> 
> 标签：programming-languages, scala

您是否正在使用 Scala 开发企业级应用程序？

编辑：同意，企业这个词没有很好的定义。通过问这个问题，我的意思是问你是否将 Scala 用于真正的项目，而这些项目不仅仅用于游戏。将 Scala 用于个人项目，而不仅仅是它的创建者使用它属于“实际项目”类别。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-06T02:16:34.793

问题中使用的“企业”一词显然缺乏要求。一个人的“企业”应用程序，不是另一个人的。SAP 正在使用 Scala/Lift，“企业”是否足够？

在一天结束时，您可以访问 Java 平台必须提供的所有“企业”内容。

对不起，有点混蛋，但这类问题很糟糕，没有明确的答案。更重要的是，有人可能编写了许多您可能认为是“企业”的应用程序，但他们没有，因此永远不要这样说。

**编辑**

此外，推特喜欢 Scala：[http](http://www.slideshare.net/al3x/twitter-3s-scala) ://www.slideshare.net/al3x/twitter-3s-scala 以及涵盖他们经历的采访：[http ://www.artima.com/scalazine/articles/twitter_on_scala.html](http://www.artima.com/scalazine/articles/twitter_on_scala.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-12T17:42:59.403

Scala 用于实际项目？是的，一点没错。

首先，因为所有的 Java 仍然可用，应用程序可以使用我们现有的公共库。这些库是在过去 10 年中用 Java 构建的，它们对于访问公司内的其他系统非常重要。

其次，企业应用最关键的是适应性。过于僵化是大多数企业应用程序衰败并最终消亡的原因。有两个问题会导致这种僵化，而 Scala 有助于避免这两个问题。一个问题只是代码量太大。Java 比 C 或 C++ 工作得更好，但它仍然需要比 Scala 更多的代码行来实现应用程序。

对于 Java，解决代码大小问题需要更高程度的结构：框架、库、可定制工厂等。这就是我们部署 Java EE 应用程序（通常基于 Spring）的原因，这些应用程序的“lib”目录中有 20 到 50 个 JAR 文件。该结构本身对于完成应用程序是必要的，但它可能会在概念复杂性方面产生自己的问题。

Scala 不能免于概念复杂性的过载，但 Scala 中的通用编程风格倾向于更小、更具体的程序，而不是用于构建 DSL 的框架的库。

当然，如果您确实需要用于构建 DSL 的框架库，那么这就是能够回调 Java 的地方。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-06T12:39:19.117

这可能是您问题的答案（或不是），但我刚刚了解到 Twitter 正在使用 Scala 进行所有后端处理（RoR 保留在界面上）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-07T16:57:19.707

[这是在 Twitter 上的 Bay Area Scala Enthusiast 会议上的一张漂亮的幻灯片](http://www.slideshare.net/al3x/twitter-3s-scala)，其中概述了他们的语言风格指南。到目前为止，Twitter 正在使用 Scala 开发一些重要的后端服务，这一点已经很成熟了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-10T23:00:40.123

[Sony Imageworks](http://www.imageworks.com/)正在将 Scala 用于他们的几个中间层应用程序，并开源了他们用 Scala 编写的[数据库迁移包](http://code.google.com/p/scala-migrations/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-01T14:50:07.593

我们正在使用 scala 进行金融中的大型刻度数据清理、计算和分发操作。该应用程序非常健壮且可扩展。除了一些 c++ 部分，它完全是用 scala 编写的。

原因：

*   非常快的开发时间

*   由于没有样板，因此易于推理实际问题

*   更快的问题解决，因为只是“更少的代码”

*   功能范式的更大灵活性

*   上述所有改进都没有真正的性能成本

高达 2.8 的工具很不稳定（尽管 emacs/ant 方法即使在那时也很可靠）

now with eclipse plugin improvements the environment is sufficiently robust.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-16T15:13:23.203

LinkedIn 正在使用一些 Scala

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-24T09:09:28.023

我们正在使用 Scala 和 java 进行金融衍生品定价项目。但是，我们并不是 LIFT 的真正粉丝 :)

最好的祝福

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-10-24T23:04:48.933

它可能有点旧，但在 Scala 网站[http://www.scala-lang.org/node/1658上有一个“企业中的 Scala”列表](http://www.scala-lang.org/node/1658)

我个人更喜欢使用 Scala 以比“企业级”更高的质量水平进行开发；-)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-03-30T16:51:26.347

Aside from legacy Java code (that is being ported to Scala bit by bit), we are 100% using Scala at [Wordnik](http://wordnik.com "Wordnik") for all of our backend code. Database layer through a REST API on some very large scale projects that I would characterize as "Enterprise". We are not, however, an Enterprise company and would probably take offense if anyone suggested we were ;) Cheers!

# c# - 将带有两个参数的委托作为参数函数传递

> ID：713634
> 
> 赞同：23
> 
> 时间：2009-04-03T11:57:51.427
> 
> 标签：c#, delegates

我有一系列看起来非常相似但只有一行的函数，比如以下两个（但我还有更多）：

```
private static int HowManyHoursInTheFirstYear(IList<T> samples)
{
    DateTime firstDate = samples[0].Date;
    int count = 0;

    while (count < samples.Count && 
          samples[count].Date.Year == firstDate.Year)
    {
        count++;
    }

    return count;
}

private static int HowManyDaysInTheFirstMonth(IList<T> samples)
{
    DateTime firstDate = samples[0].Date;
    int count = 0;

    while (count < samples.Count && 
           samples[count].Date.Month == firstDate.Month) // <--- only change!
        count++;
    }

    return count;
} 
```

我正在考虑使用委托以某种优雅的方式删除代码中的这种重复，这将允许我调用类似的东西：

```
HowManyDaysInTheFirstPeriod(
    samples,
    delegate(DateTime d1, DateTime d2) { return d1.Month == d2.Month; }); 
```

从而声明如下委托：

```
delegate bool DateComparer(DateTime first, DateTime second); 
```

以及 HowManyDaysInTheFirstPeriod 应该类似于以下内容：

```
private static int HowManySamplesInFirstPeriod
    IList<T> samples,
    DateComparer comparer)
{
    DateTime firstDate = samples[0].Date;
    int count = 0;

    while (count < samples.Count && comparer())
    {
        count++;
    }
} 
```

不幸的是，编译器抱怨比较器需要两个参数。

我对 C# 比较陌生，在这里遇到了障碍。你会如何解决这个问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-03T12:04:44.280

您快到了！`comparer`委托参数就像任何其他函数一样：**您仍然需要传递适当的参数来调用它**。在您的情况下，这将意味着这种变化：

```
while (count < samples.Count && comparer(samples[count].Date, firstDate))
{
    count++;
} 
```

**（另外，请注意，`samples`可能应该是`samples.Count`，正如我上面所写的。）**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-03T12:07:22.527

你可以简单一点。只需为函数提供一个委托，该委托从 DateTime 中提取应比较的任何内容：

```
private static int HowManySamplesInFirstPeriod<T>
    IList<T> samples,
    Func<DateTime, int> f // a function which takes a DateTime, and returns some number
{
    DateTime firstDate = samples[0].Date;
    int count = 0;

    while (count < samples && f(samples[count].Date) == f(firstDate))
    {
        count++;
    }
} 
```

然后可以这样调用它：

```
HowManySamplesInFirstPeriod(samples, (dt) => dt.Year); // to get the year
HowManySamplesInFirstPeriod(samples, (dt) => dt.Month); // to get the month 
```

该`(dt) => dt.year`语法对您来说可能是新的，但它是一种更简洁的编写“匿名委托，它接受某种通用类型的对象 dt，并返回 dt.year”的方式。你可以写一个老式的委托，但这更好。:)

不过，我们可以通过添加另一个泛型类型参数使其更通用：

```
private static int HowManySamplesInFirstPeriod<T, U>
    IList<T> samples,
    Func<DateTime, U> f // Let's generalize it a bit, since the function may return something other than int (some of the DateTime members return doubles, as I recall) 
```

不过，与往常一样，LINQ 提供了一个更好的替代方案：

```
private static int HowManySamplesInFirstPeriod<T>
    IList<T> samples,
    Func<DateTime, int> f)
{
  var firstVal = f(samples.First().Date);
  return samples.Count(dt => f(dt.Date) = firstVal)
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T12:03:55.577

您需要将有问题的两个日期传递给比较器。它可能很简单：

```
private static int HowManySamplesInFirstPeriod
    IList<T> samples,
    DateComparer comparer)
{
    DateTime firstDate = samples[0].Date;
    int count = 0;

    while (count < samples.Count 
           && comparer(samples[count].Date, firstDate))
    {
        count++;
    }
} 
```

或者您可能想以相反的方式传递它们（即`firstDate`然后`samples[count].Date`）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T12:18:24.700

我认为 jalf 的答案需要稍作修改以适应原始用法：

```
private static int HowManyHoursInTheFirstYear(IList<DateTime> samples, Func<DateTime, DateTime, bool> comparer) 
{ 
    DateTime firstDate = samples[0].Date; 
    int count = 0;
    while (count < samples.Count && comparer(samples[count], firstDate) ) {
        count++;
    } 
    return count; 
} 
```

调用使用：

```
HowManyDaysInTheFirstPeriod(samples, (d1, d2) = > { return d1.Month == d2.Month; });
HowManyDaysInTheFirstPeriod(samples, (d1, d2) = > { return d1.Year == d2.Year; }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T12:04:04.923

您需要将要与代表进行比较的日期传递。所以：

```
comparer(samples[count].Date, firstDate) 
```

# nhibernate - NHibernate 中的逆属性

> ID：713637
> 
> 赞同：90
> 
> 时间：2009-04-03T11:58:27.120
> 
> 标签：nhibernate, nhibernate-mapping

如何使用逆属性？如果我没记错的话，对于一对多的关系，inverse 属性必须设置为 true。对于多对多关系，必须将一个实体类逆属性设置为 true，另一个设置为 false。

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2009-04-03T12:11:26.947

不得将 inverse 属性设置为 true ...

您使用 inverse 属性来指定关联的“所有者”。（一个关联只能有一个所有者，因此必须将一端设置为反向，另一端必须设置为“非反向”）。（所有者：`inverse=false`；非所有者`inverse=true`：）

在一对多关联中，如果您不将集合标记为反向结束，则 NHibernate 将执行额外的 UPDATE。实际上，在这种情况下，NHibernate 会先插入集合中包含的实体，必要时插入拥有该集合的实体，然后更新“集合实体”，从而设置外键和关联制作。（请注意，这也意味着您的数据库中的外键应该可以为空）。

当您将集合结束标记为“反向”时，NHibernate 将首先保留“拥有”集合的实体，然后将保留集合中的实体，避免额外的 UPDATE 语句。

因此，在双向关联中，您总是有一个相反的末端。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-19T15:08:21.810

除了[上面的答案](https://stackoverflow.com/a/713666/3834)，根据我的理解，你需要手动将外键值持久化在集合中，即如果你不想要额外的更新语句：

```
Parent par = Session.Get<Parent>(8);

Child ch = new Child();
ch.Name = "Emad";

//set the parent foreign key manually
ch.MyParent = par;

par.MyChildren.Add(ch);
Session.Save(par); 
```

有关 inverse 属性的进一步说明，请查看以下帖子：

[http://www.emadashi.com/index.php/2008/08/nhibernate-inverse-attribute/](http://www.emadashi.com/index.php/2008/08/nhibernate-inverse-attribute/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-14T22:36:47.697

我可以看到“所有者”的来源，但关联是一个管道，你可以向下看任何一端，所以说哪个实体“拥有”管道。

看待这一点的另一种方式是，在一对多关系中，实际上有两个关系在进行。

关系1：许多孩子的父母。

关系 2：每个孩子对父母

因此 NH 将尝试运行 sql 将这些中的每一个存储在数据库中。但这并不需要，因为当您在存储孩子时在关系 2 中设置外键时，它也会自动修复父与子的关系，因为关系 1 是关系 2 的“逆” .

所以反向意味着，一旦我们设置了主要关系，我们就会默认得到它。即 NH 不需要运行 sql 来修复关系 1，并且通过将子集合标记为 Inverse NH 将在添加子集合时跳过运行 sql。

我假设如果你没有告诉 NH 它是一个逆关系，那么它会浪费精力去做 sql 来尝试设置逆关系——即使它不需要。

# algorithm - 预测市场算法

> ID：713642
> 
> 赞同：8
> 
> 时间：2009-04-03T11:59:32.703
> 
> 标签：algorithm

我正在尝试建立自己的预测市场，并且正在考虑算法。也就是说，如何根据看涨和看跌订单的数量来调整合约的价格。我现在使用的基本算法有两种：

对于是/否事件（即事件发生或不发生），我只计算说它会发生的人的百分比，并制定合同价格。如果 90% 的人说它会发生，价格在 90 美元（假币）。如果事件发生，合约将兑现 100 美元，否则为 0 美元。

对于具有一定价值的事件（比如运动员的“功率等级”），我设置了一个 IPO（我猜测这件事将在哪里兑现），并对 IPO 应用一个百分比增加。因此，如果看涨期权的数量比看跌期权多 80%，那么我在 IPO 中增加 80%。我添加了一点稳定器，这样早期的订单就不会引起巨大的跳跃（即第一个订单价格翻倍）。

请记住，这不是一个真实的市场，玩家不交易合约，他们只是对系统进行调用或下单。

我的第一个想法是我应该权衡最近的看涨期权和看跌期权，因为他们可能没有相关信息（比如运动员刚刚摔断了脚）。这些人比三个月前买合同的人知道的更多。

还有其他想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T12:04:49.867

期权定价得到了很好的研究。你读过 Black-Scholes 和 Binomial 模型吗？这将帮助您确定完美市场中价格上涨/下跌的方式。

然后有不同类型的期权——普通的看涨/看跌（美国/欧洲）、奇异期权、期权链等。您打算包括哪些？

从您在最后几段中的描述来看，您似乎正在尝试复制做市商的交易模型。在深入研究之前，您可能需要阅读实际的市场模型（包括前面声明中提到的模型）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T12:36:47.167

我目前正在阅读 Margaret o'Hara 的“市场微观结构理论”。这是一本内容丰富的书，但很好地概述了（相对）最近关于如何设定市场价格的理论研究。

*我的第一个想法是我应该权衡最近的看涨期权和看跌期权，因为他们可能没有相关信息（比如说运动员刚刚摔断了脚）。这家伙比三个月前买合同的家伙知道的多。*

我认为你不应该这样做。知道运动员刚摔断脚的交易者是“知情交易者”，他会使用这些信息来买入/卖出头寸——如果他可以交易的数量没有限制，那么他应该交易无限量. 因此，对交易进行简单平均会给您“正确”的价格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T12:28:29.917

您似乎在问两个方面：

1.  做任何事情（股票、债券、期权、赌注）的做市商
2.  复制任何类型的导数背后的数学

两者都是*巨大的*话题......

首先，我推荐拉里·哈里斯 (Larry Harris) 的《交易与交易》一书。[http://tradingandexchanges.com/](http://tradingandexchanges.com/)

第二，保罗威尔莫特的书[http://www.amazon.co.uk/Paul-Wilmott-introduces-Quantitative-Finance/dp/0471498629](http://www.amazon.co.uk/Paul-Wilmott-introduces-Quantitative-Finance/dp/0471498629)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T14:34:07.977

为什么你需要定价？只允许人们以他们希望的任何价格放置看跌期权和看涨期权。如果您想显示“当前”价格以供参考，请取最后一笔交易的价格，或平均最后几笔交易。

为了让股票首先进入市场，您可以提供“篮子”。花 100 美元，向任何人出售每种可能结果的一份。然后，他们可以出售他们认为不会发生的结果。您甚至可以通过自动生成和出售篮子来利用市场低效率，只要每个结果的买入订单总额超过 100 美元，或者您可以将其留给有进取心的玩家。

# .net - MSSQL2008 中的默认值或绑定的好习惯？

> ID：713643
> 
> 赞同：1
> 
> 时间：2009-04-03T11:59:52.747
> 
> 标签：.net, sql-server-2008, default-value

例如，如果您在 MSSQLServer2008 中的列上设置了 datetime 数据类型，它为您提供了创建日期，那么让 .NET 层传递当前日期或将列的默认值或绑定设置为 (getdate()) 更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T12:13:37.007

我认为最好让 SQL Server 处理此类项目的日期。如果客户端超过了该日期，那么如果客户端位于不同的时区或者某个客户端在其计算机上设置了错误的日期，那么您可能会遇到问题。另外，它是您需要在命令中发送的少一项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T12:14:17.143

我的观点是，只要方法一致，在哪里做就没有太大区别。

我怀疑它在性能或可维护性方面是否有很大的不同。

我的偏好是使用 getdate() 在数据库中创建它，但是这在使用 ORM 时会导致传递问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T08:24:40.557

您应该考虑使用 UTC 而不是服务器本地时间来编写时间。这样，如果您必须将服务器从一个时区移动到另一个时区，您就不会遇到任何问题。

例如，我们将服务器从德克萨斯州迁移到加利福尼亚州。主要生产应用程序对所有日期时间值使用 UTC 时间。但是票务系统使用服务器时间，并且票务应用程序将值更改为用户本地时间，假设服务器位于德克萨斯州。当我们将服务器移动到加利福尼亚时，一切都会变得非常混乱，并且值都是 2 小时的休息时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T13:26:48.747

我将使用默认值 GETDATE() 创建该列，但我会让存储过程设置实际值。 **我认为使用不包含所有列的 INSERT 语句是不好的做法**。

在适当的时候，我喜欢在事务开始时将变量 @RunDate 设置为 GETDATE()，并用 @RunDate 标记所有 CreateDate 和 LastChgDate 列。我从不在主键中使用日期，所以如果它们稍微偏离或相同，没关系。我觉得最好同时查看用户创建/更改的所有内容。

# asp.net - 选择性验证

> ID：713644
> 
> 赞同：3
> 
> 时间：2009-04-03T12:01:50.123
> 
> 标签：asp.net, vb.net, validation, textarea

我有一个包含许多文本字段的表单，并且所有字段都在验证中，我还添加了 NiceEdit 插件，以便能够在我的文本区域中格式化文本，但它会引发如下错误：

**从客户端检测到潜在危险的 Request.Form 值**

现在我可以简单地转到页面顶部并在页面指令中添加`ValidateRequest="false"` ，但这将使我无法进行我真正需要的所有验证，那么如何关闭我的文本区域的验证？？？

VB.net、ASP.net 3.5、VWD 2008 Express...

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T12:44:59.427

该`ValidateRequest`设置针对一组预定义的危险值关闭/打开内置验证。HTML 字符串被认为是危险的，因为它们可能被用于提交和发起 XSS/HTML 注入攻击。

您的问题似乎暗示您误认为此属性会影响页面的验证控件。这是不准确的。

由于您可能希望允许用户通过“NiceEdit”插件提交 HTML，我可以想到两种方法：

1.  关闭`ValidateRequest`页面并手动处理验证。在提交表单之前检查危险值。

2.  继续`ValidateRequest`页面，但在客户端，就在提交页面之前，使用 Javascript 对相关文本区域中的 HTML 值进行编码（如有必要，对所有“<”和“>”字符执行正则表达式替换），然后只允许提交。

后一种方法在[Mads Kristensen 的](http://madskristensen.net/post/Re-enable-request-validation-in-ASPNET.aspx)博客和[此处](http://dustyreagan.com/how-to-submit-html-without-disabling/)进行了演示。

# sql-server - 按 weekOfYear 获取日期

> ID：713647
> 
> 赞同：1
> 
> 时间：2009-04-03T12:03:12.850
> 
> 标签：sql-server, vb.net, datetime

我需要一年中特定周数的 Week-Start-Date 和 Week-End-Date（vb.net 或 SQL Server）

例如，如果 weeknumber=1 和 2009 年，我应该得到：

开始日期=1/1/2009 结束日期=1/3/2009

如果 weeknumber=2 和 2009 年，则：

开始日期=1/4/2009 结束日期=1/10/2009

实际上我通过在查询中使用 datepart(wk, Date) 得到周数，然后我按周数分组。现在我需要分组周数的开始日期和结束日期。

——拉赫尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T12:07:05.210

您是否正在寻找这样的东西：

```
Dim day As DayOfWeek = DateTime.Now.DayOfWeek
Dim days As Integer = day - DayOfWeek.Monday
Dim startDate As DateTime = DateTime.Now.AddDays(-days)
Dim endDate As DateTime = startDate.AddDays(6) 
```

当然，您可以更改它，以便一周从您认为应该的任何一天开始（星期日，星期一？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T12:11:53.950

可能值得考虑使用[日历表](http://web.archive.org/web/20070611150639/http://sqlserver2000.databases.aspfaq.com/why-should-i-consider-using-an-auxiliary-calendar-table.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T12:25:54.697

是的，一周从哪一天开始？星期天，还是星期一？

datepart( dw, date) 返回星期几（1 到 7），但是“[t]weekday datepart 生成的数字取决于 SET DATEFIRST 设置的值，它设置了一周的第一天。”

但它会返回正确的东西，假设您的数据库设置正确。

好的，如果它返回 1，我们在第一天，或者更一般地说，第一天是

1 - datepart(dw, date) 日期前几天

如果它返回 7 我们在一周的最后一天，或者更一般地说，最后一天是

7 - datepart(dw, date) 日期后的几天

我们使用 dateadd( dd, n, date) 从我们的日期获取日期 n 天，所以：

```
select
 date_column, 
 datepart(wk, date_column ) as week_number, 
 dateadd( dd, 1 - datepart( dw, date_column ),date_column ) as week_start, 
 dateadd( dd, 7 - datepart( dw, date_column ), date_column ) as week_end
from table ; 
```

给我们我们需要的东西。

请注意，一年中第一周的第一天晚上是上一个日历年，因为根据定义，一周开始于（星期日或星期一或您设置的任何时间），但一年可以从任何一天开始一周中的。同样，一年中最后一周的最后一天可能在下一个日历年。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T14:30:20.750

试试这个 TSQL：

```
DECLARE @Year int
DECLARE @WeekNo int
SET @Year = 2009
SET @WeekNo = 1

DECLARE @DaysInWeekOne int
DECLARE @FirstOfJan smalldatetime
DECLARE @ThirtyFirstOfDec smalldatetime
DECLARE @StartDateDayOfYear int
DECLARE @EndDateDayOfYear int

--GET THE START AND END OF THE YEAR
SELECT
    @ThirtyFirstOfDec = Cast(('12/31/' + Cast(@Year as varchar)) as smalldatetime)
,   @FirstOfJan = Cast(('01/01/' + Cast(@Year as varchar)) as smalldatetime)

--GET THE AMOUNT OF DAYS IN WEEK ONE
SELECT
    @DaysInWeekOne = 7 - (DatePart(dw, @FirstOfJan) - 1)

--GET THE START AND END DAYOFYEAR VALUES FOR THE GIVEN WEEK
SELECT
    @StartDateDayOfYear = CASE WHEN ((@WeekNo-1)*7)-(7-@DaysInWeekOne) < 0 THEN 0 ELSE ((@WeekNo-1)*7)-(7-@DaysInWeekOne) END
,   @EndDateDayOfYear = ((@WeekNo-1)*7)-(7-@DaysInWeekOne) + 6

--SELECT THE START DATE AND END DATE MAKING SURE IF THE COUNT RUNS OVER THE YEAR THAT WE SHOW THE 31/12
SELECT
    @Year As mYear
,   @WeekNo As WeekNo
,   dateadd(dd, @StartDateDayOfYear, (@FirstOfJan)) As StartDate
,   CASE 
        WHEN dateadd(dd, @EndDateDayOfYear,   (@FirstOfJan)) > @ThirtyFirstOfDec THEN @ThirtyFirstOfDec 
        ELSE dateadd(dd, @EndDateDayOfYear, @FirstOfJan) 
    END As EndDate 
```

# c# - 在 mono/Linux 下从命名管道读/写

> ID：713660
> 
> 赞同：3
> 
> 时间：2009-04-03T12:08:43.023
> 
> 标签：c#, linux, mono, named-pipes

我想从 Linux 下的命名管道/FIFO 队列中读取/写入。我已经尝试过 System.IO 中的标准类 StreamWriter 和其他类，但它失败了，因为它使用了 seek。有没有人使用 Mono 从命名管道写入/读取？我正在设法阅读和写作-但不是同时...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T18:01:01.803

您需要打开单独的读者和作者；出于某种原因，Mono 将 FIFO 视为可查找的（这是一个错误），即使它们不是。

# objective-c - 关于 Objective-C 中的私有实例变量

> ID：713663
> 
> 赞同：1
> 
> 时间：2009-04-03T12:09:52.367
> 
> 标签：objective-c, variables, private, visibility

在 xCode 3 中，我在一个类中定义了私有实例变量。当我直接访问客户端代码中的私有变量时，为什么编译器只显示警告而不是错误？代码仍然可以运行。警告说这可能是未来的一个硬错误。“硬错误”是什么意思？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T14:04:13.137

硬错误意味着将来某个时候编译器将按照您期望的方式运行（即，当您直接访问定义的可见性范围之外的实例变量时，它不会编译源文件）。

现在编译器根本没有强制执行 Objective-C 的可见性限制。然而，警告在那里提醒你你正在做一些你不应该做的事情，并提醒你注意这一点，以防你不小心做了。

如果我不得不冒险猜测为什么不强制执行可见性，我会说在 Foundation 库和 CoreFoundation 库之间有所有免费的桥接东西，可能有相当数量的库代码可以访问严格来说，实例变量不应该是可见的。

一般来说，无论如何直接访问实例变量是个坏主意。只要您可以使用 Obj-C 2.0，如果您正在设计纯数据模型对象，最好使用属性之类的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T12:39:33.947

好吧，硬错误意味着它将来会变成错误而不是警告。至于为什么现在是警告，我不确定。我想这也是出于同样的原因，当您尝试调用类中不存在的方法时，这也只是一个警告。

# mysql - 数据库模式设计工具/模块化数据库设计

> ID：713665
> 
> 赞同：11
> 
> 时间：2009-04-03T12:10:55.763
> 
> 标签：mysql, database, schema, modularity

我正在开发可以部分从模块构建的应用程序。例如，我将能够开发一些包含“论坛”、“博客”、“画廊”等模块的在线社区。

目前我有一个大型数据库 ERM，其中包含具有外键连接的所有模块的所有表，我正在使用 dbwrench 来构建这个 ERM。但是，我对这种方法不是很满意。我想有一个 ERM 设计师，它可以以面向模块的方式工作。我想为每个模块将数据库表保存在一个单独的模式文件中，但在这些不同的模式之间保留外键引用。

但是，我找不到任何支持这一点的工具——这是错误的方法还是你如何设计“模块化 ERM”/模块化数据库方案？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-03T22:33:24.657

我同意模块化设计是要走的路。当我们为客户创建应用程序时，我们倾向于向他们出售我们已经构建的小部件集合。那么当客户说*“我访问了网站 X 并且我喜欢他们的小部件 Y。你可以将它添加到我的应用程序/网站中吗？”时会发生什么？*

这是一件好事，客户 A 为小部件 Z 付费，然后我们可以将其出售给所有其他客户。诀窍是以这样的方式构建这些小部件，以便它们适合而不破坏当前应用程序。

查看此链接和注释中确定的来源。

[MediaWiki 设计 - 见底部注释](http://commons.wikimedia.org/wiki/File:Mediawiki-database-schema.png "媒体维基设计")

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T13:24:35.087

我绝对相信，这是正确的做法。不幸的是，数据库社区尚未接受模块化设计、敏捷软件开发等新概念。

如果我有选择，我让 ORM 工具创建脚本的基础，并手动添加不属于 ORM 的详细信息（例如特殊索引、表空间、分区），还手动创建迁移脚本（这很简单当你有基于文本的差异时，在两个版本的完整脚本之间转发。

所以我最终得到了三种脚本：自动生成的脚本，生成一个新的数据库。手动生成的脚本执行相同的操作，但添加了一些与功能要求无关的细节。一组迁移脚本，逐步将数据库从一个版本移动到下一个版本。

我还有一堆测试，它们使用这些脚本的组合创建各种模式并进行比较。

如果我需要图表，我会使用一些逆向工程从模式或对象模型的代码中创建这些图表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T13:03:20.817

我为每个模块模式保留单独的数据库构建脚本，并在注释中注明它们依赖的其他模块。然后，我根据需要将架构添加到与应用程序对应的数据库中。使用普通索引而不是外键。我一直发现手动操作最适合高度模块化的任务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-05T22:13:32.457

我更喜欢使用模式。这是封装关注区域的自然方式（无论是模块的模式还是覆盖信息区域的模式）。

我正在使用 PostgreSQL，我更喜欢自己编写数据库启动（我希望拥有 100% 的控制权，并且 SQL 尽可能明确。）。我使用 SchemaSpy 生成 ER 图。我对多个模式和跨模式的外键没有任何问题 - 不确定它在 MySQL 中是如何工作的。

我不熟悉您提到的工具，但是，屏幕截图似乎显示它们支持模式。可能值得再次检查。 [http://www.dbwrench.com/screenshots/xp_explorer.shtml](http://www.dbwrench.com/screenshots/xp_explorer.shtml)

至于模块化设计，我不确定模式是否足够，恕我直言，模式使大脑更容易对数据的关联方式做出假设，它本身并没有使任何东西更加模块化。请阐明您对它们应该如何模块化的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-07T07:01:51.163

我在 oracle 数据库中使用了模块化。您可以通过 SYNONYM 访问外键、视图、表、函数、存储过程。您必须执行以下两个查询才能在父模式的子模式中生成 SYNONYM。

```
grant DELETE, INSERT, UPDATE, SELECT on parentUser.table1 to childUser;
CREATE OR REPLACE SYNONYM childUser.table1 FOR parentUser.table1; 
```

table1 存在于 parentUser 架构中，但执行上述查询后，您可以从 childUser 访问此表。

# java - 在 Java 中存储国家代码、名称和大陆的最佳方式

> ID：713671
> 
> 赞同：8
> 
> 时间：2009-04-03T12:12:26.570
> 
> 标签：java, arrays, linked-list, hashmap, treemap

我想要一个`List`或`Array`某种，存储有关每个国家/地区的信息：

*   2个字母代码
*   巴西等国名
*   世界各大洲/地区，如东欧、北美等。

我将手动将每个国家/地区分类为区域/大陆（但如果存在自动执行此操作的方法，请告诉我）。这个问题是关于如何存储和访问国家的。例如，我希望能够检索北美的所有国家/地区。

我不想使用本地文本文件等，因为该项目将使用 Google Web Toolkit 转换为 javascript。但是存储在 Enum 或其他某种资源文件中，将其与其他代码分开，这才是我真正想要的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-03T12:26:26.087

只需创建一个名为 Country 的枚举。Java 枚举可以有属性，所以有你的国家代码和名称。对于非洲大陆，您可能想要另一个枚举。

```
public enum Continent
{
    AFRICA, ANTARCTICA, ASIA, AUSTRALIA, EUROPE, NORTH_AMERICA, SOUTH_AMERICA
}

public enum Country
{
    ALBANIA("AL", "Albania", Continent.EUROPE),
    ANDORRA("AN", "Andorra", Continent.EUROPE),
    ...

    private String code;
    private String name;
    private Continent continent;

    // get methods go here    

    private Country(String code, String name, Continent continent)
    {
        this.code = code;
        this.name = name;
        this.continent = continent;
    }
} 
```

至于存储和访问，您将要搜索的每个字段的一个 Map 并键入该字段，这将是标准解决方案。由于您对大陆有多个值，因此您必须使用 a`Map<?, List<Country>>`或 Multimap 实现，例如来自 Apache commons。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T13:34:33.770

ISO 3166 中有 246 个国家/地区，您可能会在此基础上获得一个中继大枚举。我更喜欢使用带有国家列表的 XML 文件，您可以从[http://www.iso.org/](http://www.iso.org/iso/country_codes/iso_3166_code_lists.htm)下载一个并加载它们（例如，当应用程序启动时）。比，因为您需要在 GWT 中将它们作为 RPC 调用加载回来，但请记住缓存这些（某种延迟加载），这样您就不会每次都完成加载它们。我认为这无论如何都会比将它们保存在代码中更好，因为每次访问模块时您都将完成加载完整列表，即使用户不需要使用此列表。

所以你需要一些可以容纳国家的东西：

```
public class Country
{
    private final String name;
    private final String code;

    public Country(String name, String code)
    {
        this.name = name;
        this.code = code;
    }

    public String getName()
    {
        return name;
    }

    public String getCode()
    {
        return code;
    }

    public boolean equals(Object obj)
    {
        if (this == obj)
        {
            return true;
        }
        if (obj == null || getClass() != obj.getClass())
        {
            return false;
        }

        Country country = (Country) obj;

        return code.equals(country.code);
    }

    public int hashCode()
    {
        return code.hashCode();
    }
} 
```

对于 GWT，这个类需要实现 IsSerializable。您可以使用以下命令在服务器端加载它们：

```
import java.util.ArrayList;
import java.util.List;
import java.io.InputStream;

import org.dom4j.Attribute;
import org.dom4j.Document;
import org.dom4j.DocumentException;
import org.dom4j.Element;
import org.dom4j.io.SAXReader;

public class CountriesService
{
    private static final String EL_COUNTRY = "ISO_3166-1_Entry";
    private static final String EL_COUNTRY_NAME = "ISO_3166-1_Country_name";
    private static final String EL_COUNTRY_CODE = "ISO_3166-1_Alpha-2_Code_element";
    private List<Country> countries = new ArrayList<Country>();

    public CountriesService(InputStream countriesList)
    {
        parseCountriesList(countriesList);
    }

    public List<Country> getCountries()
    {
        return countries;
    }

    private void parseCountriesList(InputStream countriesList)
    {
        countries.clear();
        try
        {
            Document document = parse(countriesList);
            Element root = document.getRootElement();
            //noinspection unchecked
            Iterator<Element> i = root.elementIterator(EL_COUNTRY);
            while (i.hasNext())
            {
                Element countryElement = i.next();
                Element countryName = countryElement.element(EL_COUNTRY_NAME);
                Element countryCode = countryElement.element(EL_COUNTRY_CODE);

                String countryname = countryName.getText();
                countries.add(new Country(countryname, countryCode.getText()));
            }
        }
        catch (DocumentException e)
        {
            log.error(e, "Cannot read countries list");
        }
        catch (IOException e)
        {
            log.error(e, "Cannot read countries list");
        }
    }

    public static Document parse(InputStream inputStream) throws DocumentException
    {
        SAXReader reader = new SAXReader();
        return reader.read(inputStream);
    }
} 
```

当然，如果您需要通过 ISO 2 字母代码查找国家/地区，您可能不会将 List 更改为 Map。如您所述，如果您需要按大洲划分国家/地区，您可以从 ISO 3166 扩展 XML 并添加您自己的元素。只需检查他们的（ISO 网站）许可证。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T12:17:57.230

如果您经常需要按大陆进行查找，我只需制作一系列不可变列表，每个大陆都有一个，并相应地填充它们。一个大陆的国家/地区数据列表可能不会频繁地更改，以支付在需要更改某些内容时重建这样一个要重建的阵列的成本。

此外，如果您愿意手动进行国家/地区分类，其余的都是自动的，可以通过编程方式完成。

*   用于[`Locale.getISOCountries()`](http://java.sun.com/javase/6/docs/api/java/util/Locale.html#getISOCountries())获取国家代码列表。
*   用于[`Locale.getDisplayCountry()`](http://java.sun.com/javase/6/docs/api/java/util/Locale.html#getDisplayCountry(java.util.Locale))获取每个国家/地区的显示名称。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T13:40:40.540

最简单的方法是使用地图（或任何集合）在 Java 中创建国家/大陆结构，然后使用[XStream将其持久化](http://xstream.codehaus.org/)

这将创建集合的 XML 表示，您可以非常轻松地将其读入您的流程并将其转换回您最初创建的相同集合类型。此外，由于它是 XML，您可以在代码之外轻松地对其进行编辑。即只是在文本编辑器中。

有关详细信息，请参阅[XStream 教程](http://xstream.codehaus.org/tutorial.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-19T01:24:03.540

using the Locale object is the best solution I can think of, you wouldn't need to store anything. But if you are using GWT try to do that on the server side, as some say you won't get it working correctly on the client side (as it gets translated to javascript) you can send them to the client in an RPC as stated before.

# java - 在将对象从 Java 传递到 Jython 时保留对象的 Java 类型

> ID：713675
> 
> 赞同：5
> 
> 时间：2009-04-03T12:13:18.113
> 
> 标签：java, python, jython

我想知道当您将 java 对象放入 Java ArrayList 时，是否可以**不让jython 自动将它们转换为 python 类型。**

从 jython 控制台复制的示例：

```
>>> b = java.lang.Boolean("True");
>>> type(b)
<type 'javainstance'>
>>> isinstance(b, java.lang.Boolean);
1 
```

到目前为止，一切都很好，但是如果我将对象放在 ArrayList

```
>>> l = java.util.ArrayList();
>>> l.add(b)
1
>>> type(l.get(0))
<type 'int'> 
```

对象被转换为类似 python 的布尔值（即 int）并且......

```
>>> isinstance(l.get(0), java.lang.Boolean)
0 
```

这意味着我再也看不到这曾经是一个 java.lang.Boolean。

**澄清**

我想真正想要实现的是在将对象从 Java 传递到 Python 时摆脱从 Java 类型到 Python 类型的隐式转换。我再举一个例子来说明。

一个 Python 模块：

```
import java

import IPythonModule

class PythonModule(IPythonModule):

    def method(self, data):
        print type(data); 
```

还有一个使用这个模块的 Java 类：

```
import java.util.ArrayList;

import org.python.core.PyList;
import org.testng.annotations.*;

import static org.testng.AssertJUnit.*;

public class Test1 {

    IPythonModule m;

    @BeforeClass
    public void setUp() {
        JythonFactory jf = JythonFactory.getInstance();
        m = (IPythonModule) jf.getJythonObject(
                "IPythonModule",
        "/Users/sg/workspace/JythonTests/src/PythonModule.py");
    }

    @Test
    public void testFirst() {
        m.method(new Boolean("true"));
    }   
} 
```

由于隐式转换，在这里我将看到输出“bool”，但我真正想要的是看到“javainstance”或“java.lang.Boolean”。如果您想运行此代码，您还需要可以在[此处](http://wiki.python.org/jython/JythonMonthly/Articles/September2006/1)找到的 JythonFactory 类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T13:35:01.413

您似乎使用的是旧版本的 Jython。在当前的 Jython 版本中，Python`bool`类型对应于 Java `Boolean`。

Jython 不会将 Java 类型转换为 Python 类型，`ArrayList`相反，它会将原始 Python 类型转换为原始或包装 Java 类型，然后将其传递给 Java 方法，并将 Java 类型转换为 Python在出去的路上打字。

您可以通过打印数组的内容来观察这一点。注意 Python`bool`是大写的 ( `True`)；Java`Boolean`不是。

```
>>> from java.lang import Boolean
>>> b = Boolean('True')
>>> b      
true
>>> from java.util import ArrayList
>>> l = ArrayList()
>>> l.add(b)
True
>>> l
[true]
>>> l.add(True)
True
>>> l
[true, true]
>>> list(l) 
[True, True] 
```

如果这仍然不能满足您的要求，请考虑编写一个小型 Java 帮助函数，它会为您检查数组而不进行转换。可以说这是一个错误，Jython 不会自动将`Boolean`您构造的 转换为 Python ，在这种情况下，与使用或 Python`bool`相比，它没有给您带来任何优势。`Boolean.TRUE``True`

# sql-server - MS/Transact-SQL 存储过程可以查找自己的名称吗？

> ID：713677
> 
> 赞同：14
> 
> 时间：2009-04-03T12:13:28.957
> 
> 标签：sql-server, tsql

存储过程中是否有任何方法可以引用自己的名称？假设我希望它打印自己的名称，但不在存储过程中对名称进行硬编码。是否有任何欺骗方法可以从程序本身中获取名称或 ID，而不使用实际名称来查找信息？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-03T12:20:55.817

尝试：

```
SELECT OBJECT_NAME(@@PROCID) 
```

@@PROCID 返回当前 SQL 模块的对象 ID。OBJECT_NAME 将对象 ID 转换为其名称。两者都至少从 SQL Server 版本 7 到 2008 可用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-03T12:21:07.923

您正在寻找 @@PROCID 和 OBJECT_NAME 即

```
select @procName=OBJECT_NAME(@@PROCID) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T12:34:44.350

过程/函数的名称

```
Select OBJECT_NAME(@@PROCID); 
```

其他有趣的东西

```
 Select * From sys.sysprocesses Where spid = @@SPID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T07:53:58.020

这是我编写的一些修补程序代码，针对 SQL Server 2005 数据库运行以使用 OBJECT_NAME(@@PROCID) 函数。

先运行本节，创建日志表

```
CREATE TABLE Diagnostics_Log 
  (
   sprocName sysname,
   WhenRun  datetime,
   Comment  Varchar(160) NULL
  ) 
```

--=========================================

然后运行这个 T-SQL 来创建同一个存储过程的几个版本，每次都添加一个数字后缀。

```
CREATE PROC dg_test_name_logging
    @Comment Varchar(160)
AS 
  declare @Sprocname sysname
  select @sprocName = OBJECT_NAME(@@PROCID)

  PRINT @@PROCID
  print @sprocname

  insert into Diagnostics_Log VALUES (@sprocname, GetDate(), @Comment)

GO 
```

--========== 然后运行这个部分

```
 exec dg_test_name_logging 'this is the first run'
WAITFOR DELAY '00:00:00:123'
  exec dg_test_name_logging1 'this is my second comment'
WAITFOR DELAY '00:00:00:123'
  exec dg_test_name_logging2 'yet another comment'
WAITFOR DELAY '00:00:02:123'
  exec dg_test_name_logging3 'amazing'
WAITFOR DELAY '00:00:00:123'
  exec dg_test_name_logging4 'I''ll be gobsmacked if this works'
WAITFOR DELAY '00:00:00:123'
  exec dg_test_name_logging5 'It''s ALIVE !!!'

  select * from Diagnostics_Log 
```

在运行或访问存储过程或视图时记录日志可能很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-19T00:55:23.177

object_name() 本身不指定当前对象的模式。要做到这一点：

```
print object_schema_name(@@PROCID) + '.' + object_name(@@PROCID) 
```

# silverlight - Silverlight 深度变焦在幕后是如何工作的？

> ID：713685
> 
> 赞同：1
> 
> 时间：2009-04-03T12:18:08.493
> 
> 标签：silverlight, imaging, deepzoom

我已经使用 Silverlight 深度缩放完成了一些示例项目（只是为了好玩）。它真的很酷和令人兴奋的东西。但我很想知道在幕后发生了什么来实现这种事情。深度缩放作曲家在其数据源的子文件夹中生成许多图像和少量 XML 文件。

谁能解释所有这些东西到底是如何工作的。正在使用哪些概念来实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T12:22:37.030

看看 Open-Zoom 项目。这是一个开源项目，因此您可以通过查看 Open-Zoom 的实现来自己回答您的问题：

[http://code.google.com/p/open-zoom/](http://code.google.com/p/open-zoom/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T12:21:53.867

据我了解，这类似于他们在游戏中用来保持帧速率的技术；虽然有些东西很小，但只能获取它的低分辨率版本。当他们放大时，获取越来越多的细节。

运行wireshark，你会看到平移/缩放时发生的流量。

该工具的工作是生成数据，让客户可以轻松获得不同分辨率的图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T09:53:13.563

[这是一个截屏视频](http://conceptdevelopment.net/Silverlight3/DeepZoom01/)，展示了深度缩放“平铺金字塔”的外观（在 Flash 中观看，或者如果您有 SL3 测试版，您可以进行交互）。

还有一个[DeepZoom 查看器](http://deepzoompublisher.com/Viewer/)，可让您“探索”一个“有点”像 Windows 资源管理器一样的 Deep Zoom 图像 - 查看每一层及其包含的图像。

这些可能有助于可视化 DeepZoom 的工作原理——但公认的 Open Zoom 答案无疑为您提供了最大程度的细节/技术理解。

# c# - 带有 ITemplate 字段的 GridView 导出到 Excel

> ID：713687
> 
> 赞同：0
> 
> 时间：2009-04-03T12:18:38.053
> 
> 标签：c#, asp.net, gridview, postback, export-to-excel

我有一个 GridView，它在 Page_Load 和每个 PostBack 上都以编程方式添加了一些模板字段（因为出于某种原因，这些字段在 PostBack 上失去了它们的价值）。

它工作得很好，所以我不再考虑 PostBack 问题。

现在我正在尝试将该 GridView 导出到 Excel。我正在使用以下代码：

```
protected void ExportToExcel_Click(object sender, EventArgs e)
{
    string attachment = "attachment; filename=ExcelFile.xls";
    Response.ClearContent();
    Response.AddHeader("content-disposition", attachment);
    Response.ContentType = "application/vnd.xls";
    Response.Charset = "utf-8";
    Response.ContentEncoding = System.Text.Encoding.GetEncoding("windows-1250");
    StringWriter sw = new StringWriter();
    HtmlTextWriter htw = new HtmlTextWriter(sw);

    // Create a form to contain the grid
    HtmlForm frm = new HtmlForm();
    this.gridValores.Parent.Controls.Add(frm);
    frm.Attributes["runat"] = "server";
    frm.Controls.Add(this.gridView);
    frm.RenderControl(htw);
    Response.Write(sw.ToString());
    Response.End();
} 
```

问题是除了模板字段之外的所有列都呈现到 Excel 文件中，这些字段留空。

我认为这个问题与模板字段在每个 PostBack 上丢失它们的值这一事实有关。我搜索了一下，发现有人说这些动态字段应该添加到 Page_Init 上，而不是 Page_Load 上。我不确定这是不是真的，但是我需要根据通过 HttpRequest 获得的信息创建这些字段，如果我没记错的话，这些字段在 Init 上不存在。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T13:57:14.057

我发现很多人都有这样的问题，但很少有答案可以帮助我。

直到这个： [http ://forums.asp.net/p/1229438/2216336.aspx#2216336](http://forums.asp.net/p/1229438/2216336.aspx#2216336)

这真的可以解决我的问题。我已经做了一些测试并且它有效。他设法将模板字段保存在缓存中并在 Page_Load 上恢复它们​​。聪明的。

如果有人找到更好的解决方案，请在此处发布。对于其他正在努力解决问题的开发人员来说，它可能非常有用。

# c++ - C++ 命名空间建议

> ID：713698
> 
> 赞同：77
> 
> 时间：2009-04-03T12:23:39.273
> 
> 标签：c++, namespaces

我只是在自学 C++ 命名空间（来自 C# 背景），我真的开始认为，即使 C++ 比大多数其他语言做得更好，嵌套命名空间也不是其中之一！

我是否认为为了声明一些嵌套的命名空间，我必须执行以下操作：

```
namespace tier1
{
    namespace tier2
    {
        namespace tier3
        {
            /* then start your normal code nesting */
        }
    }
} 
```

相对于：

```
namespace tier1::tier2::tier3
{
} 
```

就像 C#？

当我需要转发声明时，这变得更加疯狂：

```
namespace tier1
{
    namespace tier2
    {
        namespace forward_declared_namespace
        {
            myType myVar; // forward declare
        }
        namespace tier3
        {
            /* then start your normal code nesting */
            class myClass
            {
                forward_declared_namespace::myType myMember;
            }
        }
    }
} 
```

请记住，我开发的典型系统包括：

```
MyCompany::MySolution::MyProject::System::[PossibleSections]::Type 
```

这就是为什么您在 C++ 示例中很少看到命名空间的原因吗？或者通常只有单个（非嵌套）命名空间？

**更新**

对于任何感兴趣的人，[这就是我最终](http://www.adamjamesnaylor.com/2012/10/23/NestedNamespacesInC.aspx)解决此问题的方式。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-04-03T12:31:25.607

C++ 命名空间并非旨在成为一种设计机制——它们只是为了防止名称冲突。在 99.99% 的情况下，您真的不想或不需要使用嵌套命名空间。

在 C++ 中正确使用命名空间的一个很好的例子是 C++ 标准库。这个相当大的库中的所有内容都放置在一个名为**std**的命名空间中- 没有尝试或不需要将库分解为（例如）一个 I/O 子命名空间、一个数学子命名空间、一个容器子命名空间等等

在 C++ 中建模的基本工具是类（在某种程度上是模板），而不是命名空间。如果你觉得需要嵌套，你应该考虑使用嵌套类，它比命名空间有以下优点：

*   他们有方法
*   他们可以控制访问
*   它们不能重新打开

考虑到这些，如果您仍然希望通过所有方式使用嵌套命名空间 - 以这种方式使用它们在技术上没有任何问题。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-03T12:27:50.387

C++ 命名空间比以前的产品有了很大的改进（即根本没有命名空间）。C# 命名空间扩展了这个概念并与之一起运行。我建议您将命名空间保持在简单的平面结构中。

**编辑** *您是否建议由于我在这里概述的缺点？*

简单地说“是”。C++ 命名空间并非旨在帮助您像在 C# 中那样对逻辑和库进行分区。

C++ 命名空间的目的是阻止 C 开发人员在现实世界中遇到的问题，即他们在使用两个导出相同函数名称的第三方库时会遇到名称冲突。C 开发人员有各种解决方法，但这可能是一个严重的痛苦。

这个想法是 STL 等具有`std::`命名空间，“XYZ Corp”提供的库将具有`xyz::`命名空间，您为“ABC corp”工作会将您*所有*的东西放在一个`abc::`命名空间中。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-11-14T11:18:49.373

我在前向声明时所做的如下所示：

```
 namespace abc { namespace sub { namespace subsub { class MyClass; }}} 
```

我的前向声明被折叠成单行。前向声明的可读性被牺牲以换取其余代码的可读性。对于定义，我也不使用缩进：

```
 namespace abc {
 namespace sub {
 namespace subsub {

 class MyClass 
 {
    public:
       MyClass();

       void normalIntendationsHere() const;
 };

 }
 }
 } 
```

使用这种风格一开始需要一点纪律，但对我来说这是最好的妥协。

* * *

从 C++17 开始，您可以使用问题作者提出的语法声明命名空间。

```
namespace A::B::C { ... } 
```

> 嵌套命名空间定义：`namespace A::B::C { ... }`等价于`namespace A { namespace B { namespace C { ... } } }`.

[https://en.cppreference.com/w/cpp/language/namespace](https://en.cppreference.com/w/cpp/language/namespace)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-03T15:02:55.710

至少作为一个小帮助，在某些情况下你可以这样做：

```
namespace foo = A::B::C::D; 
```

然后将 A::B::C::D 引用为 foo。但仅在某些情况下。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-11-21T20:24:01.067

您可以跳过缩进。我经常写

```
namespace myLib { namespace details {

/* source code */

} } /* myLib::details */ 
```

C++ 源代码最终被编译成二进制，不像 C#/Java 保留在二进制中。因此，命名空间只是为变量命名冲突提供了一个很好的解决方案。它不适用于类层次结构。

我经常在代码中保留一两个命名空间级别。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-03T12:28:49.933

首先，您可以避免命名空间缩进，因为没有理由这样做。

在示例中使用命名空间不会显示命名空间的强大功能。对我来说，他们的力量正在将领域区域彼此分开。将实用程序类与业务类分开。

只是不要在一个 .h 文件中混合不同的命名空间层次结构。命名空间是对函数声明接口的一种额外注释。查看名称空间和类名应该可以解释很多东西。

```
namespace product
{
namespace DAO
{

class Entity
{
}; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-20T22:49:40.503

我发现您可以像这样模仿 c# 命名空间；

```
namespace ABC_Maths{
    class POINT2{};
    class Complex{};
}

namespace ABC_Maths_Conversion{
    ABC_MATHS::Complex ComplexFromPOINT2(ABC_MATHS::POINT2)
    {return new ABC_MATHS::Complex();}

    ABC_MATHS::POINT4 POINT2FromComplex(ABC_MATHS::COMPLEX)
    {return new ABC_MATHS::POINT2();}
}

namespace ABC
{
} 
```

但是代码似乎不是很整洁。我希望有长篇大论的用法

最好将尽可能多的功能嵌套到类似的类中

```
namespace ABC{
    class Maths{
        public:
        class POINT2{};
        class Complex:POINT2{};
        class Conversion{
            public:
            static Maths.Complex ComplexFromPOINT2(MATHS.POINT2 p)
            {return new MATHS.Complex();}

            static MATHS.POINT2 POINT2FromComplex(MATHS.COMPLEX p)
            {return new ABC::MATHS.POINT2();}// Can reference via the namespace if needed
} /*end ABC namespace*/ 
```

这仍然有点啰嗦。但确实感觉有点OO。

并听到它似乎是最好的完成

```
namespace ABC
{
    class POINT2{};
    class Complex:POINT2{};
    Complex ComplexFromPOINT2(POINT2 p){return new Complex();}
    POINT2 POINT2FromComplex(Complex){return new POINT2();}
} 
```

听到用法的样子

```
int main()
{
    ABC_Maths::Complex p = ABC_Maths_Conversion::ComplexFromPOINT2(new ABC_MATHS::POINT2());

    // or THE CLASS WAY

    ABC.Maths.Complex p = ABC.Maths.Conversion.ComplexFromPOINT2(new ABC.Maths.POINT2());

    // or if in/using the ABC namespace

    Maths.Complex p = Maths.Conversion.ComplexFromPOINT2(new Maths.POINT2());

    // and in the final case

    ABC::Complex p = ABC::ComplexFromPOINT2(new ABC::POINT2());
} 
```

找出为什么我从未像使用 c# 那样使用 c++ 命名空间很有趣。它会太啰嗦，而且永远不会像 c# 命名空间那样工作。

在 c++ 中命名空间的最佳用途是停止说我的超级 cout 函数（每次调用它时都会发出叮当声）与 std::cout 函数（远不那么令人印象深刻）混淆。

仅仅因为 c# 和 c++ 具有命名空间，并不意味着命名空间的含义相同。它们不同但相似。c# 命名空间的想法一定来自 c++ 命名空间。一定有人看到了类似但不同的事情可以做什么，并且没有足够的想象力给它自己的原始名称，例如“ClassPath”，这更有意义，因为它是通往课程的路径，而不是提供命名空间，其中每个空间可以具有相同的名称

我希望这可以帮助别人

我忘了说所有这些方法都是有效的，前两种的适度使用可以合并到第三种中来创建一个有意义的库，即（不是很好的例子）

```
_INT::POINT2{} 
```

和

```
_DOUBLE::POINT2{} 
```

因此您可以使用更改精度级别

```
#define PREC _DOUBLE 
// or #define PREC _INT 
```

然后为双精度 POINT2 创建一个 PREC::POINT2 实例

这对 c# 或 java 命名空间来说不是一件容易的事

显然这只是一个例子。想想用法是如何读取的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-03T12:42:04.970

您过度使用它们（并且您将一无所获）。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-05-30T06:45:59.760

我有时在单独的标头中将深层命名空间声明为几个宏

**命名空间.h**

```
#define NAMESPACE_TIER1_TIER2_TIER3 \
    namespace tier1 { \
    namespace tier2 { \
    namespace tier3 {

#define END_NAMESPACE_TIER1_TIER2_TIER3 }}} 
```

要在其他地方使用它：

**另一个文件.h**

```
#include "./namespace.h"

NAMESPACE_TIER1_TIER2_TIER3;

/* Code here */

END_NAMESPACE_TIER1_TIER2_TIER3; 
```

宏后面的多余分号是为了避免额外的缩进。

# c++ - C++ 中的强制导向布局实现

> ID：713701
> 
> 赞同：8
> 
> 时间：2009-04-03T12:25:43.123
> 
> 标签：c++, user-interface, force-layout, force-based-algorithm

您是否知道用于 GUI 的 C++中[强制导向布局](http://en.wikipedia.org/wiki/Force-based_algorithms)的开源实现？最好是 BSD/MIT/Apache 或其他（非 GPL）许可证。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T06:02:16.710

优秀的[Boost.Graph 库](http://www.boost.org/doc/libs/1_38_0/libs/graph/doc/table_of_contents.html)提供了广泛的算法，其中一些布局算法。我建议使用[Kamada-Kawai spring layout](http://www.boost.org/doc/libs/1_38_0/libs/graph/doc/kamada_kawai_spring_layout.html)或[Fruchterman-Reingold force-directed layout](http://www.boost.org/doc/libs/1_38_0/libs/graph/doc/fruchterman_reingold.html)。

[Boost 许可证](http://www.boost.org/LICENSE_1_0.txt)非常宽松，所以不用担心。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-03T12:36:13.940

第一个谷歌结果是[VTK](http://vtk.org/)。另一个带我去[vtkGraphLayoutView](http://www.vtk.org/doc/nightly/html/classvtkGraphLayoutView.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-17T04:59:09.353

您是否看过[graphviz](http://www.graphviz.org/)中的[neato](http://www.graphviz.org/pdf/neatoguide.pdf)。本[指南](http://www.graphviz.org/pdf/libguide.pdf)甚至详细介绍了使用 graphviz 作为库。该[指南](http://www.graphviz.org/pdf/libguide.pdf)包括使用 fdp 布局算法，这似乎正是您想要的。所有 graphviz 都属于[Common Public License](http://www.graphviz.org/License.php)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T19:16:00.623

概述

[https://www.kitware.com/InfovisWiki/index.php/Main_Page](https://www.kitware.com/InfovisWiki/index.php/Main_Page)

如果你想要这个应用程序，有一些安装步骤，所有信息都在那个 wiki 上。它是一个建立在VTK上的应用程序。OverView 的具体功能是能够在二维中表示信息图（不一定是几何图形）。

正如 dirkgently 所指出的，VTK 具有强制定向图布局。使用 OverView 之类的东西的好处是，您可以轻松地为 OverView 制作自定义插件，您可以使用强制定向布局策略读取数据并显示它。

如果您不想依赖 OverView，那么提取插件代码并仅引用 OverView 非常容易，因为所有渲染都是在插件之外处理的。

# c++ - C++ 作为第一语言

> ID：713704
> 
> 赞同：33
> 
> 时间：2009-04-03T12:26:21.373
> 
> 标签：c++

我已经自学 C++ 大约 4 个月了。我很享受，我觉得我做得很好。然而，对我[的一个问题](https://stackoverflow.com/questions/711350/learning-to-work-with-audio-in-c/711447#711447)的回答让我想到我可能会为自己的跌倒做好准备。

那么，这里的人们如何看待 C++ 作为第一门学习语言呢？现在我已经有了一个良好的开端，值得我继续吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-04-03T12:37:03.017

我不明白为什么人们仍然将“语言”与“图书馆”混为一谈。（参考链接的答案。）那么如果 C++ 没有“原生”音频概念怎么办？那里有很多库，您可以轻松地将其与 C++ 一起使用，并且可能比任何“包罗万象”“标准库”音频处理 API 更适合您的特定需求。

</rant>

C++ 是一门难学的语言。还有一些更容易学习的。我永远不会为此争论。

但是 C++ 很容易成为最*强大的*语言之一。它可以同时高效且优雅*。*当然，也没有什么能阻止你把所有事情都搞得一团糟。

如果我推荐 C++ 作为第一门编程语言？其实，我也不知道更好。其他人可能会保护您免于犯错，并使最初的成功（例如您的第一个 GUI 应用程序）更容易。但是，如果您建立在 C++ 的基础上，您将始终处于稳固的基础上。实际上，您可能根本不需要选择另一种语言。但是，如果您愿意/必须这样做，您会发现它非常容易。

一个有经验的 C++ 程序员可以在几周内全速完成 Java 之类的工作。反过来呢？困难*得多*。

* * *

许多年后，我觉得我应该修改这个答案。自从我的孩子们要求我教他们编程后，我就开始这样做了。我发现自己实际上**并不是**从 C++ 开始的……因为我首先向他们展示了[BF](https://en.wikipedia.org/wiki/Brainfuck)。他们很快就了解了内存和指针。然后我继续使用 C++，到目前为止，我们都非常享受。

* * *

然而又过了几年，我觉得我真的应该把这个来自 CppCon 2015 的 Kate Gregory 的精彩演讲添加到这个答案中：

[停止教学](https://www.youtube.com/watch?v=YnWhqhNdYyk)C.

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-04-03T12:42:21.490

让我这样说吧：

我以 94% 的成绩通过了 Sun Java 认证*，而我从未编译过一行 Java*（那是九年前）。我能够做到这一点，因为我非常了解 C++。

在我的第一份专业工作中，我被聘为测试员。第二天，有人告诉我，如果我在两周内学会了足够有用的 PowerBuilder，我可以编程而不是测试。因为我非常了解 C++，所以 PowerBuilder 很简单。

C++*很难*，但如果你学得好——阅读 Stroustrup 的*The C++ Programming Language*，也做练习，阅读他的*Design and Evolution of C++*，阅读 C++ Faq 和 Meyers 的书籍以及 Herb Sutter 的书籍，阅读 comp.lang。 c++.moderated，阅读 Coplien 的*Advanced C++ Programming Styles and Idioms*无论你想用哪种 OO 语言编写代码——如果你学得好，其他所有 OO 语言都很容易。

学习 C++ 是学习编码的绝佳准备。（你也将成为一名合格的 C 程序员，但请阅读 K&R 以成为一名优秀的 C 程序员。）

哦。而且 C++ 编程真的很有趣，比 Java 简洁*得多*，而且更灵活。您真正负责，而不是 IDE 或语言。你可以用自己的脚射门，但你将负责做这件事。一旦你知道了模板，就读一读 Alexandrescu 的书，它会让你感到惊奇、目瞪口呆和高兴。

C++ 很*有趣*。阅读“Curious Recurring Template Pattern”：它看起来像这样

```
template< class  T> struct base {};

struct derived: base< derived > {}; 
```

是的，你没看错：它是一个派生自在派生类上模板化的基类的类。现在这听起来既晦涩又愚蠢，但它有很多很好的用途，就在前几天，我在敲我的脑袋，因为*你不能在 Java 中做到这一点*（因为 Java 使用类型擦除，而不是模板，用于泛型），但如果我可以使用它，我就可以保存在很多类中重复的大量代码。

C++ 中还有很多东西，如果您将自己限制在 Java 或 .Net 中，您将永远不会发现它。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-03T12:57:03.500

正如其他人所指出的那样，C++ 并不是一门容易学习的语言，但有几个原因使它成为一个不错的起点：

*   它不会将您束缚于特定的编程范式（例如 Java 和 OOP），因此您可以轻松地尝试不同的技术
*   C++ 没有花里胡哨的东西，所以如果你想知道它们是如何构建的，你可以专注于构建构建块
*   因为它是一种语言而不是平台，所以您可以选择最适合手头任务或您选择的编程风格的库（例如，为 Java 风格选择 Poco 之类的东西，[为坚韧的早期风格 OO 选择](http://www.pocoproject.org/)[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)等.)
*   它是一种通用编程语言，而不是平台*（不得不说两次）*

诀窍是第一次仔细和正确地学习它。我知道，我和许多其他人一样，在真正理解它之前，通过将它作为“C + 对象”来学习它而苦苦挣扎。这是一门难学的语言。我建议寻找一位经验丰富的 C++ 导师，并阅读大量关于如何编写和不编写 C++ 的“强烈推荐”书籍。避免预先学习坏习惯。

对于没有特定顺序的起始阅读列表：

*   Koenig 和 Moo 的“加速 C++”
*   Scott Meyers 的“Effective C++/STL”
*   Bertrand Meyer 的“面向对象的软件构建”
*   Peter van der Linden 的“专家 C 编程”
*   Musser、Derge 和 Saini 的“STL 教程和参考指南”
*   Josuttis 的“C++ 标准库”

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-03T13:05:46.100

这里有很多对 c++ 的支持，但我不同意。每种语言都有其优点和缺点（当然，有些语言比其他语言取得了更好的平衡）。

话虽如此，对于第一种语言，我相信大多数人将学习*如何*使用一种语言更有效地编程 a) 没有编辑-编译-运行周期（对于程序员而言，这本质上会更慢 b ) 具有垃圾收集 c) 具有良好的运行时自省。最好还有一个交互式评估器，可以搞乱。

在这些语言中，开发（如果不是运行时）几乎总是更快，让你绊倒的事情更少，并且有更好的工具可以帮助找出问题所在。

这并不是说用像 c++ 这样的语言学习变幻莫测的内存管理是不值得做的事情，等等等等，它只是不是你真正想要开始的地方。

c++ 的另一个问题是，尽管它具有实用性，但它的庞大规模加上它具有不兼容的部分的事实，这可能导致作为初学者最好避免的微妙问题。

编辑：John D 在评论中指出，一些首先学习 GC 语言（绝不限于“脚本”语言）的人以后永远不会学习指针。不过，这是一条红鲱鱼。有些人由于各种原因无法学习各种东西。我坚持认为，当你学习基础知识时，担心指针会分散注意力。在某些时候，您可能需要了解手动内存管理，但一开始这样做并不重要。或者更准确地说，避免这种情况所获得的收益比成本更重要。

不过让我明确一点，我并不是说 c++ 是第一语言的次要选择，因为它缺乏垃圾收集。这只是阻碍良好学习编程基础的众多问题之一。真正的问题是它是一种大型复杂语言，到处都有怪癖，甚至内部不一致（例如，指针和异常不能很好地配合使用）。当然，所有这些都可以妥善管理，您可以学习良好的做法，以免陷入麻烦。

然而，对于一个真正的新手来说，这些都没有多大意义。所以一些学习它最终会成为“这样做，而不是那样”。“为什么？” “因为我说过——你还不会明白细节”。几乎没有一个吉祥的开始。

学习第一语言的最大收获可能在于避免编辑-编译-运行循环（任何类型）并具有良好的自省能力。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-04-03T13:11:12.467

如果你学习“现代 C++”而不是“C 加上一些新东西”，C++ 将（很多？）更平易近人。例如，使用[`std::string`](http://en.cppreference.com/w/cpp/string)、[`std::vector<>`](http://en.cppreference.com/w/cpp/container/vector)和[`unique_ptr<>`/`shared_ptr<>`](http://en.cppreference.com/w/cpp/memory)代替 C 风格的字符串、数组和指针。

[**Koenig 和 Moo**](https://rads.stackoverflow.com/amzn/click/com/020170353X)已经提到的[*Accelerated C++*就是](https://rads.stackoverflow.com/amzn/click/com/020170353X)**一本书。**

 *** * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-03T12:32:07.803

如果你有一个好老师，C++ 作为第一语言是可以的。但是第一次扩展它是一堵相当高的墙，但是一旦你扩展了那堵墙，其他类似的语言就变得非常容易了。

所以，是的，继续。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-03T12:35:41.477

任何语言都是好的第一语言（在合理范围内，而不是像 lolcode 这样的语言）

一旦你掌握了它的工作原理，就更容易扩展到其他语言。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-04-03T12:30:57.667

我认为 C++ 可能不是第一次开发时最友好的语言，但它也不会牵着你的手，必然会导致你养成太多坏习惯（我没有说，只是没有太多）。

C++ 是我大学编程课程所基于的介绍性语言，我们在那里学习了所有基础知识以及数据结构和算法，然后再扩展到我们选择的语言。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-03T12:33:52.167

对我来说，学习 C++ 主要是关于学习如何**不**打自己的脚。这可能是一个痛苦的练习，因为在 C++ 中，总是有另一个边缘情况会使枪在指向你的蹄子时爆炸。

向上的镜头是，如果您设法完成练习，您将成为一个更好的开发者，并且您将能够在未来发生之前以您最终使用的任何语言发现脚射机会。

此外，当某些第三方库自爆时，您将比那些连续数月未重复使用的其他库更好地了解问题所在。

我会说坚持使用 C++，这不是浪费时间，即使您从未编写过一行生产 C++ 代码。

希望这可以帮助 ：）

体重

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-04-03T12:32:24.137

继续。C++ 仍然被广泛使用，并且是某种工作的语言。所以这取决于你想做什么——系统编程是用 C++ 或 C 来完成的，商业和 Web 应用程序往往是用其他东西来完成的。

我强烈建议您也探索其他语言。例如，Python 是我的第二语言；它可能会为您提供有关面向对象和函数式编程的新见解，并使您成为更好的 C++ 程序员（以及整体上更好的程序员）。

我相信接触尽可能多的语言（更重要的是，接触许多不同的编程范例）会让你成为一个整体上更好的程序员。至少看看 Haskell、Prolog、Lisp 和一个 Assembler 变体。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-04-03T12:37:20.613

就个人而言，我认为每个人都应该从 BASIC 开始。不，真的。至少前 2 周到 1 个月。它非常适合高中课程。它非常简单，您可以专注于非常简单的事情，例如使用变量、循环结构、条件和调用子例程，而不必担心框架、对象和指针。但是，如果您已经掌握了所有这些简单的东西，那么您没有理由不能继续使用 C++。这是一门很棒的语言。并且非常有用。我认为从未使用 C/C++ 编程的人真的错过了一些你应该知道的关于在较低级别上如何工作的基本知识。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-04-03T12:52:44.197

如果你刚开始，我不会推荐 C++ 作为第一语言，因为作为程序员，你首先需要了解的是编程概念，而在 C++ 中，你会花很多时间来处理语法.

但既然你已经四个月了，而且很享受，那么听起来你做得还不错，所以我会说继续。但是通过一些更一般的阅读来完善它。[诸如计算机程序的结构和解释之](https://rads.stackoverflow.com/amzn/click/com/0262510871)类的东西。它会教你一些在 C++ 中不会发生的事情。能让你的 C++ 程序变得更好（也让你在其他语言中变得更好）的东西。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-04-03T12:30:37.137

对我来说，C++ 也是我的第一语言，我想这是一个不错的选择。您学习了 OOP 的所有基本原理，并将了解编程的逻辑结构。但当然，这取决于你想用它做什么。

但是我很确定如果你切换到 Rails 来做所有花哨的 web 应用程序，你将成为比任何开始使用 PHP 或 - 最坏情况 - Rails 的人更好的开发人员。

所以去吧！

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-04-03T12:42:32.473

C++ 是我学习的第一种正确的语言，它使我能够很好地学习其他语言（主要是 C#）。

除其他外，它为我提供了面向对象的良好基础，这在使用 Siebel 和 C# 时确实非常有帮助。

享受。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-04-03T12:49:34.157

C++ 是第一语言的不错选择。特别是如果你四个月了，并且取得了良好的进展，我会敦促你*现在不要改变*。C++ 很难，但它是一门很好学的语言，因为它不会对你隐藏任何东西，而且很多其他语言都使用类似的语法。确保您给自己足够的时间来理解该语法，以便在您开始学习其他语言时轻松发现差异（可能非常微妙）。

最后，我会提醒您确保您更多地关注编程概念而不是语言概念。对于你学习的每一个新的 C++ 语法特性，问问自己“这解决了什么问题？” 这些问题的解决方案比 C++ 或任何其他语言中的特定实现更重要。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-04-03T14:48:27.023

无视仇敌。C++ 可以成为第一语言。我的第一语言是 TRS-80 Model 1 上的汇编程序。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2009-04-03T16:03:01.837

我认为如果你很敏锐并且玩得很开心，那么 C++*对你*来说是一门不错的初学者语言。

如果你问我同样的问题，但还没有实际选择一个来尝试，我建议从 Ada 开始。它与 C++ 一样强大，但远没有那么神秘。

此外，它的语法被设计为不易出错，并且它进行更多的编译时间和运行时检查，因此您将花费更少的令人沮丧的时间来调试您的程序。真正让很多想成为程序员的人感到厌烦的是，当他们遇到无法找到的令人讨厌的错误时。

现在你使用 C++ 的主要事情是，一旦你适应了它，你就会出去尝试*另一种*语言。太多的人习惯了一种母语，以至于他们在其边界之外看不到。我数不清有多少人*讨厌*除了第一门语言之外的所有语言，仅仅因为他们做事不同。但即使你终生坚持将 C++ 作为你的主要语言，我向你保证，学习 Lisp 会让你成为一个更好的 C++ 程序员。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-04-03T12:32:17.850

C++ 是一门难学的第一语言，但这不是不可能的，你会从中学到很多东西。它的关键，就像其他任何事情一样，如果你不理解某些事情，不要放弃。提出问题，并阅读是否有问题。最终你会找到答案。我认为我能给你的关于你的任务的最佳报价来自[Randy Pausch](http://www.cmu.edu/uls/journeys/randy-pausch/index.html)：

“砖墙的存在是有原因的。砖墙不是为了把我们挡在外面。砖墙是为了向你展示我们多么想要某样东西。因为砖墙的存在是为了阻止那些不想做坏事的人。他们在那里是为了阻止其他人。”</p>

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-04-03T14:45:24.817

虽然我确信 C++ 是一个很好的工具，但我会谨慎地建议*不要*将它作为第一语言学习。

C++ 是专业人士的强大工具。你可以用它做可怕的事情（[http://chaosradio.ccc.de/camp2007_m4v_1951.html](http://chaosradio.ccc.de/camp2007_m4v_1951.html)）。有时你会很难理解错误信息。它具有诸如手动内存管理和指针算法之类的功能，这些功能显然已放置在系统编程中，并且具有非常高性能要求的软件（游戏...）需要它们，但是它们很难深入人心，而且不是很在这些利基之外有用。当我从 c++ 切换到 java 时，我*确实*学得更快，但这可能只是个人的事情。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-04-03T15:36:43.960

C++ 是一个非常有用的工具，我经常认为掌握 C++ 是一种卓越的标志，因为它是如此疯狂的语言。

我的建议是同时学习另一种语言，例如 python 或 scheme。我用 C++ 编程了很长一段时间，但是当我开始学习 python 方案并随后使用 haskell 时，我打开了一个全新的思维世界。很容易进入 C++ 可以做所有事情并且做得更快的思维定势，因此学习另一种语言没有意义。

基本上，您可以将更多的编程概念和方法加载到您的脑海中的速度越快，您在解决原始问题时就会越出色。

我在大学里最有趣的一堂课是学习离散数学和函数式编程的课程，紧随其后的是学习计算机硬件架构和使用汇编的课程。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2009-04-03T22:45:30.590

我认为 C++ 是一门很好的整体第一语言，因为它什么都有。它不像高级脚本语言，您不必真正处理类型、内存或指针，也不是像汇编那样的直接硬件访问。它在中间的某个地方。如果您学习 C++，您基本上将拥有一套可以轻松翻译成其他语言的技能。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-04-03T12:34:36.330

在你开始学习的任何语言中，你都会犯错误。有些语言可能需要注意的陷阱较少，有些可能有很多。不管是什么语言，你肯定会发明自己的陷阱。现在你已经花了大约 4 个月，我建议你继续。考虑到现在您有两件事要完成，现在切换可能会使事情变得更加困难：

*   忘记 C++
*   从零开始学习语言 X

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-04-03T13:06:23.557

去！去！去！每个人都会爱你，因为你重申了他们早期的努力，并在你身上看到了自己等。抛开所有的感伤，是的，我个人认为你应该这样做。您将拥有更好的信誉，从而获得自尊。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-04-03T13:18:40.187

C++ 可能不是最好的语言，而且还有更糟糕的选择。

正如其他人已经说过的那样，诀窍是正确学习它，我的意思是现代 C++，您可以在其中专注（/专注？）算法和要解决的问题，而不是带有类的 C在早期章节中了解内存管理。

AC++确实是一本非常好的学习现代C++的书。然而，如果没有任何编程经验，Francis Glassborrow 的[*You can do it*](http://www.spellen.org/youcandoit/book.htm)可能是一个更好的选择。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-04-03T13:59:21.713

有两种类型的语言。“厨房水槽”和“极简主义”。厨房水槽语言为您提供了他们认为可能有用的一切。极简主义者只为您提供开发您可能想到的任何东西所需的东西。C++ 是极简主义的。你当然可以写东西并与他人分享，但默认情况下它什么都没有。

C++ 也是（之一）对程序员来说最难的语言。托管/解释语言为程序员做了很多事情。C++ 什么都不做，但它也不会妨碍您或让您支付管理费用。

你的目标是成为 MAD SKILLZ 的专家还是只是在玩玩？

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-04-03T14:25:12.307

C++ 是一种好的第一语言吗？

正如您所发现的，它当然可以作为一个使用。我不会特别推荐它来介绍一般的编程（我更喜欢 Python 或 Scheme），但这取决于你的目标和学习风格。我已经成功地教授了 C 编程，并且当正确使用 C++ 时，C++ 不再困难。

如果您的目标只是为了某个特定目的而学习 C++，那么我真的不知道有比继续学习 C++ 更好的方法了。

如果你喜欢挑战，你可能想跳入 C++。学习曲线相当糟糕，但是一旦通过它你就会知道很多东西。（毕竟，人们仍然学习如何使用 vi 编辑器。）

我建议先学习更高层次的东西。学习向量而不是数组，使用智能指针而不是普通指针，诸如此类。部分是因为你应该结束这样的编程（对于大多数目的），部分是因为一开始要记住的东西更少。您最终将需要学习较低级别的东西，就像您最终需要学习一些琐碎的东西一样。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-04-03T15:24:35.627

C++ 是我用过的第一门语言。我在中学时玩过一点 BASIC，但从未真正做过比“我在想 1 到 100 之间的数字”游戏更有意义的事情。我在 C++ 方面没有遇到很多麻烦，但我不是自学的。在高中时，开设了一门 AP 计算机科学课程，当时我们使用 C++（大学委员会正在用 C++ 进行考试；我想他们后来改用 Java）。我认为作为第一语言（或者几乎是第一语言，在我的情况下）是可以的，**只要你有一个好老师**。

如果你是自学的，我认为你会从 Python 中得到更多。你可以直接在 REPL 中玩东西，所以会有更多的即时满足感。语言本身在执行语言习语方面也更加严格，这将帮助您学习“正确”的做事方式。如果您尝试以错误的方式做某事，C++ 不会妨碍您，特别是如果您没有老师告诉您您做错了什么以及如何解决它，您将倾向于开发一些陋习。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-04-03T17:54:39.230

您在这里有很多很好的答案，但我要补充一点：

永远不要放弃任何事情！如果您没有时间或您不感兴趣的事情，那么您应该**退出**，但永远不要*放弃*！

我不管有多难，继续。如果必须，请慢慢进行。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-04-03T20:45:58.740

在我上学的地方，他们用 C++ 教授大多数课程（实际上它更像是混合 C/C++：想想 C++，但只使用 C 风格的字符串而不使用 stl），我认为它是一门很棒的第一语言。它只是接近硬件的低级繁重工作的正确组合，可帮助您了解内存、指针和流的真实情况，并结合使用 stl 集合和垃圾等高级构造的对象设计另一个集合（提升共享指针等）。

也就是说，我现在已经转向 VB.Net 和 C#。我仍然非常感谢我的 C++ 背景，我认为首先使用它让我成为了一个更好的程序员。但我不想回去。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-04-08T01:07:39.840

如果你已经四个月了，并且做得很好，那就坚持到底。但是，我一般不推荐 C++ 作为第一语言。

在研究生院，我是所有工科学生都必须参加的第一年计算机课程的助教。该课程使用 C++ 作为教学语言，我现在认为这是一个非常糟糕的选择。大约 10-20% 的学生立即“明白”并轻松完成课程（作为 SO 用户，您可能属于这个类别），中间的 70-90% 努力工作并且做得很好，而后 10 -20% 在课程进行到一半时仍然无法区分变量声明和函数声明。

太多的学生陷入了 C++ 语法的困境，而不是使用计算机来解决问题，而这正是一年级的一般计算机课程应该真正涉及的内容。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-04-08T01:48:57.417

C++ 是我开始使用的第一个“真正的”语言。是的，有时这是一个艰难的学习曲线，但最好的部分是因为我不知道更好 - 我不知道更好。也就是说，C++ 是我用过的最简单的语言。

就个人而言，我认为好处是巨大的。和其他人一样，我在不到一周的时间内就成功地掌握了 Java 的专业能力。几天后我就掌握了嵌入式 C 的速度。Delphi、VB.Net、C# - 都是简单的转换，我将其归因于以 C++ 作为基线。

如果你在最初的几天里成功了，你就可以走了。无论如何，坚持下去。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2012-02-23T05:26:55.400

试试看这篇对 Stroustrup 的采访吧。我希望它能回答你的一些问题。 [http://www.nsbasic.com/ce/info/interview.shtml](http://www.nsbasic.com/ce/info/interview.shtml)

他的话：

> “嗯，有一天，当我坐在办公室里时，我想到了这个小计划，它可以稍微调整平衡。我想‘我想知道如果有一种语言如此复杂、如此难以学习会发生什么？ ，没有人能用程序员淹没市场？实际上，我从 X10 中得到了一些想法，你知道，X windows。那是一个如此糟糕的图形系统，它只能在那些 Sun 3 上运行/60 东西.. 他们拥有我想要的所有成分。一个非常复杂的语法，晦涩的函数和伪 OO 结构。即使是现在，也没有人编写原始 X-windows 代码。如果你这样做，Motif 是唯一的方法想保持理智”

* * *

## 回答 #33

> 赞同：-2
> 
> 时间：2009-04-03T12:35:55.267

我不是 C++ 的粉丝，主要是因为它的语法。我发现它在使用中很可怕而且很成问题，而且我并不孤单有这种观点。也许，如果你花足够多的时间来掌握它，那将不再是问题，但我更喜欢选择更优雅的 Java，它可以让我更快地创建桌面应用程序并使其更便携，以及纯 C 来处理系统 -或以绩效为导向的工作。

# iphone - 如何找到iphone的旋转角度？

> ID：713712
> 
> 赞同：1
> 
> 时间：2009-04-03T12:29:51.897
> 
> 标签：iphone, orientation, angle

当我将 iphone 从纵向模式旋转到横向右侧或横向左侧但在 YX 平面中时，我想计算旋转角度。在我的游戏中，我想相对于 iphone 旋转一个对象，但方向相反。如果我将 iphone 从纵向模式向右移动 30 度，那么我只想将对象移动 30 度，但向右横向移动。我有点积的公式，比如

v1.v2=L1.L2cos(θ) 但我不知道确切的解决方案。因此，如果有人知道它，请帮助我提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T19:42:49.717

您可能会发现 atan2() 标准库函数很有用。它会将 x 和 y 加速度数字转换为您的角度。

# algorithm - 学习文本分析和文本语义从哪里开始？

> ID：713727
> 
> 赞同：3
> 
> 时间：2009-04-03T12:34:58.390
> 
> 标签：algorithm, text, analysis

我对文本分析非常感兴趣，我可以从哪里开始学习这个主题？适合初学者的算法和东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T14:24:12.463

有关自然语言处理的教科书列表，请参阅我对[这个问题的回答。](https://stackoverflow.com/questions/608743/strategies-for-recognizing-proper-nouns-in-nlp/609951)此外，[Lucene in Action](http://www.manning.com/hatcher3/)是一本关于领先的全文搜索库的实用书籍。同样，[清醒的想象力](http://www.lucidimagination.com/)是一家新公司，拥有大量有关信息检索的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T13:09:45.293

Paul Graham[关于垃圾邮件检测的系列文章](http://www.paulgraham.com/antispam.html)是有趣的轻松阅读，并且与研究有一些联系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T13:12:18.363

您可以尝试寻找科学论文。

[从Google Scholar](http://scholar.google.com/)中的关键字搜索开始，每篇论文都有许多参考文献，这对您来说应该是一个很好的起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-11T11:25:14.143

我发现这也提供了很多信息： [http ://www.youtube.com/watch?v=kKe4M4iSclc](http://www.youtube.com/watch?v=kKe4M4iSclc)

# c - 无操作系统执行

> ID：713734
> 
> 赞同：9
> 
> 时间：2009-04-03T12:37:01.800
> 
> 标签：c, linux, boot, bootstrapping, bare-metal

如何将**C**程序编译为有效的**ELF**格式（或 RAW 格式），以便可以在没有任何**操作系统**的情况下直接从 RAM 执行？假设存在一个**引导加载程序**，它能够将代码加载到 RAM 中的任何位置并在该地址开始执行。准确地说，编译器（**GCC**）标志应该是什么？是否需要地图文件？

一个示例 helloworld 应用程序将是最受欢迎的 :)

只是为了详细说明我的观点，
让 main() 方法是一个空的无限 while 循环，以确保不使用特定于**操作系统**或标准库的调用。所需的 o/p 是一个挂起。使用通常的**GCC**选项，引导加载程序肯定无法加载可执行文件，告诉它是无效的**ELF**格式。但是，通过将*-dN*选项传递给链接器将使其成为有效的**ELF**。需要更多编译器/链接器选项才能使其挂起而不崩溃！！这些编译器选项到底是什么？

```
file.c:
int main()
{
    while(1);
} 
```

编译
gcc -c -nostdinc -fno-builtin
file.c ld -dN -nostdlib file.o

**Bootloader 将a.out**加载到 RAM 并执行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T13:46:59.293

首先，一旦引导加载程序完成工作，您可以做的事情就会受到限制。这些限制是由于以下原因：（假设您的引导加载程序（例如：grub）将您带到 32 位保护模式） 1\. 没有启用分页。您需要启用它。2.在那里你不能与设备交互，因为你必须为 IRQ 设置处理程序。

这是我用来学习裸机编程艺术的经典链接（[http://geezer.osdevbrasil.net/osd/index.htm](http://geezer.osdevbrasil.net/osd/index.htm)）。此外，页面上有一个下载链接（[http://geezer.osdevbrasil.net/osd/code/osd.tgz](http://geezer.osdevbrasil.net/osd/code/osd.tgz)）。tar 文件包含复杂程度不断提高的演示内核。此外，您可以查看 make 文件 (linux.mak)，并获取 gcc 所需的标志。

我打开了一个随机生成文件，发现使用了以下标志： gcc : -nostdinc -fno-builtin ld: -nostdlib
（对链接器进行了显式调用，因此 ld 也需要一个标志）。

flags 的目的是告诉 gcc 不能与标准库进行链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-05T13:47:11.460

coreboot 可以加载独立的 ELF。请参阅“初始化 DRAM”：

[http://en.wikipedia.org/wiki/Coreboot](http://en.wikipedia.org/wiki/Coreboot)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T05:42:37.940

[http://www.osdever.net/bkerndev/index.php](http://www.osdever.net/bkerndev/index.php)

这个网站一步一步地回答你的问题......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T15:03:32.323

您是否意识到，如果您不加载操作系统，则必须编写设备驱动程序才能与任何设备一起使用。这意味着如果不为该特定视频卡编写驱动程序就不能写入屏幕，如果不为该特定硬盘驱动器控制器卡编写驱动程序就不能从磁盘读取，不能访问键盘等。

您可能想研究一种称为[Kiosk 模式](http://www.google.com/search?q=linux+kiosk+mode)的东西。基本思想是操作系统运行，加载您的应用程序所需的一切，加载您的应用程序，然后您不能切换到另一个应用程序。

# php - CakePHP 中的模型可以有多个表吗？

> ID：713736
> 
> 赞同：7
> 
> 时间：2009-04-03T12:37:13.907
> 
> 标签：php, cakephp

CakePHP 中的模型可以有多个表吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-03T13:22:44.123

从手册中的这句话猜测：

> 模型通常是数据库的访问点，更具体地说，是数据库中某个表的访问点。默认情况下，每个模型都使用名称是其自身复数的表，即“用户”模型使用“用户”表。

我不这么认为，但你可以建立关系，也许这就是你所需要的。

[检查这个](http://book.cakephp.org/view/312/Models)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-03-20T05:02:53.873

当然可以，当您有很多相同的表时，它很方便。

```
class SomeModel extends Model
{
    var $useTable = false;

    public function ReadData()
    {
        // select table
        if($a == 1)
            $this->setSource('tableName1');
        else if($a == 2)
            $this->setSource('tableName2');
        // ...
        else if($a == N)
            $this->setSource('tableNameN');

        // now perform operations with selected table
        return $this->find('all');
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T01:18:37.837

从技术上讲，根据您提出问题的方式，而不是我所知道的。不过，我通常会使用与您所追求的相似的事物的*关系*。例如，一个人的地址信息可以很容易地放入人员表中，但我通常更喜欢将其提取出来，因为其他实体也可以有地址（企业等）。

如果你想在你的数据库中实现某种伪继承模型，同样的想法。例如，志愿者是人，但承包商、供应商和员工也是人。所有这些都共享您可能希望存储在人员表中的某些属性以及对于他们所属于的人员类型而言是唯一的其他属性。

在每种情况下，您都有两个模型，但它们通过它们的关联无缝地协同工作。

如果这是您正在考虑的那种场景，那么类似的方法可能对您有用，尽管它不是关于具有多个表的模型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-05T20:32:50.627

它不能同时有多个表...，但您可以修改 Model::useTable 属性以将模型的表切换到不同的表。试一试，让我们知道它是否有效。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-21T16:08:41.047

我猜你想在数据库中实现某种继承（这需要在从子表中检索信息时加入存储在父表中的数据）。我解决这个问题的方法是在子模型中使用 afterFind 回调。我重新定义了回调如下：

```
function afterFind($results) {
    foreach ($results as $key => $val) {
                $fieldRetrieved=$this->query("SELECT *field* FROM *parent_table* WHERE id={$val['*ChildModelName*']['id']}");
                $results[$key]['*ChildModelName*']['*field*']=$fieldRetrieved[0]['*parent_table*']['*field*'];
    }
    return $results;
} 
```

通过这种方式，我将父表中的字段包含到从子表中获得的结果中。在这种情况下，我假设两个表都是带有一个名为 id 的字段的索引，并且子表中的该字段也是父表的外键（从而创建了伪继承）。

# architecture - 您是否使用预发布软件来开发商业产品？

> ID：713740
> 
> 赞同：4
> 
> 时间：2009-04-03T12:39:36.177
> 
> 标签：architecture

所以问题是……您是否使用过预发布产品或技术（社区技术预览版、Beta 版或发布候选版等）来开发您自己的产品？

例如，您可能已经使用 Microsoft 的 ASP.Net MVC（昨天刚刚进入 RTM）开发了一个网站，或者针对 SQL Server 2008 RC 1..etc 构建了软件

如果是这样..

1\. 您（或您）采取了哪些步骤来最大程度地降低预发布产品正确发布时出现问题的风险？

2\. 在使用产品之前，您是否等待特定的时间范围（例如，直到产品成为候选版本）？

3\. 使用预发布技术的主要优势（相对于风险）是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T12:49:28.790

实际上，我曾经参与过的所有成功的软件项目都已发布（呃，已发布 - 网站），并且有相当多的测试版在使用中。

我们主要评估这些（主要是开源项目）的测试覆盖率以及之前不做傻事的记录。

只要能满足我们的需要，任何旧的测试版都可以使用 ;) 但通常我们会在重大改写后远离即时快照。

这些天我们是测试驱动的，所以我们知道*我们的*东西是否有效。如果库有错误，我们将保留旧版本或修复错误。我们还可以立即评估更新中是否存在严重错误，因为它会破坏我们自己的测试。所以使用“未完成”的软件真的不再是什么大问题了。访问最新功能始终是原因，有时我们这样做是为了获得重要的修复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T12:45:55.210

除非我真的需要某些东西，否则我倾向于等到更广泛的市场对事物进行测试后再与他们一起处理工作。我不只是为了它而采用新东西。这取决于我在使用它之前想要看到的眼睛数量。

对我来说，在设计/开发系统方面有足够的挑战，而不必开拓基础设施。

显然，如果客户采用早期技术版本，那么我的手是被迫的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T12:51:35.433

这取决于您对该软件的信任程度——基本上它是否会比您当前的软件更有效地解决您的用户问题。所以当 asp.net 2.0 首次预览时，我们立即接受了它（因为我们认为它比 asp.net 1.1 有了巨大的改进）

但对于 asp.net mvc 并非如此。现在，如果我们决定采用预览软件，下面是我对您的 3 个问题的回答：

关于你的第一点——这些天你在 IDE 上取得的进步——就最终版本的代码破坏而言，风险很小。这些公司在提前告知这些变化方面做得很好。更大的风险在于——该技术是否会被大众采用，您的客户是否愿意为此付出额外的代价。

关于您的第二点 - 不，如果我们对新版本有强烈的感觉，那么一旦发布，我们就会开始研究它以获得额外的优势。

关于你的第三点-

优势 - 如果该软件能够以可承受的成本解决问题 - 那么您作为早期采用者已经获得了大奖。您可以为这些技能收取更多费用，因为显然供应会减少，需求会增加

风险——如果软件没有被大众接受——你投入的时间和金钱就会付诸东流；-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T12:46:42.590

我不。

通常我会等到 Service Pack 1 才开始将产品用于商业目的。

我发现在我打破这条规则的奇怪情况下，它最终给开发人员带来了很多不必要的压力和压力来解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T13:34:52.787

有时我们需要它是否有错误修复或性能改进。如果 FAE（现场应用工程师）说它稳定，我愿意尝试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T13:46:07.063

对我来说，这就是将产品推出门所需要的时间。例如，我在 Silverlight 工作。SL3 中将提供的一些功能对于我们软件的下一个版本是必需的。如果我们想在 SL3 成为 RTW 之后真正快速发布，那么我们需要针对 beta 进行开发。我们不能等那么久。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T14:04:43.570

这取决于实际情况。在之前的工作中，我们使用了 ADO.NET Entity Framework，而它仍处于测试阶段。我们对 beta 版进行了彻底的测试，并且我们使用了自动化单元测试和代码覆盖率分析来确保我们是彻底的。测试版通过了我们的测试。

事实证明这是一个很好的举措。它为我们节省了三个月等待最终版本的时间，并且只用了几个小时来修复测试版和发布版本之间的重大更改。

我不会使用的是我不确定是否会被发布或得到很好支持的预发布软件。这包括开源软件，除非我愿意自己支持它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T15:33:41.673

如果您的产品已发货或安装在客户端计算机上，请务必小心。

对于基于 Web 的系统（包括 Silverlight 等组件），这是可能的。我以前的公司部署的系统是基于 ASP.NET beta 的（在正式发布之前）。

在某些情况下，这可能是一个不错的选择（例如，您需要的突破性技术）。但是，强烈的警告点：代码越多，您必须更改的越多。Beta 产品没有预期的使用寿命、支持或遗留问题。因此，您应该期望必须替换任何基于 beta 产品的代码构建。

对我来说，除非绝对必要，否则我几乎肯定会避免这种情况。问问自己：为什么要使用测试版？如果这是一个很好的答案，只需考虑风险。否则，为你的车跑。;)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T15:45:05.420

有时你别无选择。例如，当该工具的新 CTP 版本完全颠覆了现有技术时。

例如：

当 Windows Workflow Foundation 发布时，几乎没有其他选择。我们考虑了开发周期时间框架（1 年以上），并意识到冒险并开始使用 CTp 版本进行研究/开发是有益的。原来它支付了那个项目。

另一个例子是新的同步框架。尽管我们需要 SQL EE/STD 提供程序，但它仅与 SQL CE 提供程序一起出现。我们与 CE 提供商一起制作原型，并在新的 EE 提供商发布时进行升级。

我们唯一的选择是使用 SQL 服务器合并复制或类似技术。啊!

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-03T12:46:35.630

根据经验，我从不在生产软件中使用这种不稳定的组件。

如果你需要质量，你应该建立在坚实的基础上。

我知道许多大型软件公司在它们足够成熟之前不会使用新的组件和技术——只是为了安全起见。

这完全取决于你愿意接受的风险。

# windows-7 - 用于软件测试用例的 Windows 7 徽标计划，它们在哪里？

> ID：713751
> 
> 赞同：1
> 
> 时间：2009-04-03T12:43:24.530
> 
> 标签：windows-7

有很多关于硬件测试的信息，但没有关于软件的信息。我能找到的只是一份带有“要求”和“政策”的 PDF（[ [http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=27028822-b172-4cec-91a3-26b610a4da79]](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=27028822-b172-4cec-91a3-26b610a4da79])）。

vista 的认证涉及大量的测试用例。

如果有人有任何信息，我想得到他们的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T20:07:35.453

您可以从此处下载 alpha 版本（截至 4 月下旬）： [https ://connect.microsoft.com/site/sitehome.aspx?SiteID=831](https://connect.microsoft.com/site/sitehome.aspx?SiteID=831)

最好的祝愿，

蒂姆

# excel - 在 Excel 中截断字符串 - 是否有一个函数可以在分隔符后删除字符串的最后一部分

> ID：713752
> 
> 赞同：2
> 
> 时间：2009-04-03T12:44:08.787
> 
> 标签：excel, string

Excel 中是否有一个智能宏（2000 以上）可以删除字符串的最后一部分，如果它有特定的分隔符？

如果分隔符不存在，则应保留字符串

例如，对于“。”

```
 abcd.1          =>  abcd
 abcd            =>  abcd 
```

我想我可以使用 Instr 和 Mid 等的组合来编写一些东西，但我很想知道是否有更聪明的速记，比如“Strip('abcd.1';'.')”等等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T12:53:37.220

我不相信有任何功能可以为您做到这一点。

你可能可以使用这样的东西：

```
=LEFT(A1,IF(ISERROR(SEARCH(".",A1)),LEN(A1),SEARCH(".",A1) - 1))

```

这将删除分隔符的第一个实例之后的所有字符，如果您想从最后一个实例中删除，您可能需要编写自己的函数来对反向字符串进行搜索。

可用功能的完整列表可在以下位置找到：

[http://www.techonthenet.com/excel/formulas/index.php](http://www.techonthenet.com/excel/formulas/index.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T13:03:57.103

您也可以为此创建自己的用户定义函数 (UDF)。

```
Function Strip(ByVal oCell As Range, ByVal sSeperator As String) As String

    Dim iPos As Integer
    Dim sValue As String

    sValue = oCell.Value
    iPos = InStr(sValue, sSeperator)

    If (iPos <= 0) Then
        Strip = sValue
    Else
        Strip = Left(sValue, iPos - 1)
    End If

End Function 
```

然后你可以在你的公式栏中使用

> =条（A1，“。”）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-08T11:41:59.180

您可以交替使用数据列，单击“文本到列选项”，选择“分隔”，点击下一步并选择您选择的符号来拆分数据（在您的情况下，'.'）。您的数据现在应该分成两列。删除第二列:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-11T19:31:34.610

'在函数中使用 SPLIT

公共函数 extractName(parmField As String, Optional parmSplitChar As String = ".") As String

```
Dim vSplit As Variant

vSplit = Split(parmField, parmSplitChar)
extractName = vSplit(0) 
```

结束功能

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-12T13:07:14.177

这适用于德语版的 Excel。

```
=LINKS(A1;WENN(ISTFEHLER(SUCHEN(".";A1));LÄNGE(A1);SUCHEN(".";A1) - 1)) 
```

# ant - 如何从 Ant 任务中读取非 xml 文件？

> ID：713757
> 
> 赞同：2
> 
> 时间：2009-04-03T12:46:33.057
> 
> 标签：ant

XmlProperty任务非常适合在 Ant 中读取格式正确的 xml 文件[。](http://ant.apache.org/manual/Tasks/xmlproperty.html)

但是如何阅读非 XML 的呢？

更准确地说，如何从非 XML 文件中读取模式？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-03T13:15:42.020

查看[LoadFile](http://ant.apache.org/manual/Tasks/loadfile.html)任务。它允许您将文件加载到 Ant 属性中，然后您可以从其他任务中访问该属性。LoadFile 任务还支持过滤器/过滤器链，因此您可以执行诸如将文件的前 5 行读取到属性中或读取仅包含某些单词的行等操作...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T12:59:35.117

您可以使用[task](http://ant.apache.org/manual/Tasks/property.html)的选项读取[.properties 文件](http://en.wikipedia.org/wiki/.properties)。`file`[`property`](http://ant.apache.org/manual/Tasks/property.html)

# c++ - 浮点比较的奇怪结果

> ID：713763
> 
> 赞同：4
> 
> 时间：2009-04-03T12:48:12.383
> 
> 标签：c++, floating-point

我有这个简单的测试：

```
double h;
...
// code that assigns h its initial value, used below
...
if ((h>0) && (h<1)){
 //branch 1 -some computations
}
else{
 //branch 2- no computations
} 
```

我列出了我的值，因为我得到了一些非常奇怪的结果，例如如果： h=1 则到达第一个分支，我不明白为什么因为如果 h=1 我想要计算 branch2。
我是否对如此明显的事情感到困惑？

* * *

### 编辑：

这就是我计算然后使用的方式`h`：

```
double* QSweep::findIntersection(edge_t edge1,edge_t edge2) {  
point_t p1=myPoints_[edge1[0]];
point_t p2=myPoints_[edge1[1]];
point_t p3=myPoints_[edge2[0]];
point_t p4=myPoints_[edge2[1]];

double xD1,yD1,xD2,yD2,xD3,yD3,xP,yP,h,denom;
double* pt=new double[3];

// calculate differences  
xD1=p2[0]-p1[0];  
xD2=p4[0]-p3[0];  
yD1=p2[1]-p1[1];  
yD2=p4[1]-p3[1];  
xD3=p1[0]-p3[0];  
yD3=p1[1]-p3[1];    

xP=-yD1;
yP=xD1;
denom=xD2*(-yD1)+yD2*xD1;
if (denom==0) {
    return NULL;
}
else{
h=(xD3*(-yD1)+yD3*xD1)/denom;
}
std::cout<<"h is"<<h<<endl;
if (h < 1) std::cout<<"no"<<endl;
else std::cout<<"yes"<<endl;
if (h==1) {
    return NULL;
}
else{
if ((h>0)&&(h<1)){
    pt[0]=p3[0]+xD2*h;  
    pt[1]=p3[1]+yD2*h;
    pt[2]=0.00;
}
else{
    return NULL;
}
}

return pt; 
```

}

* * *

### 编辑：

好的，很清楚我应该如何重新制定条件。

从：

```
double h;
if (h==1){
   //computations here
} 
```

至：

```
double h;
if (abs(h-1)<tolerance){
  //computations here
} 
```

当我使用双数时。

但是我该如何重新制定呢？

```
double h;
if (h<1){
   //computations here
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-03T12:51:36.133

由于`h`是双精度数，它可能已经足够接近 1 以打印为`1`，但它实际上比 1 小一点，所以比较成功。[浮点数可以](http://en.wikipedia.org/wiki/Floating_point)做到这一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T13:05:11.297

[通过以最大精度打印出来来](http://www.billthelizard.com/2009/02/c-snippets-print-precision.html)检查 h 的实际值。您可能会发现它实际上略小于 1.0。

我运行以下代码作为测试

```
#include <iostream>

int main()
{
    double h = 1.0;
    if((h>0) && (h<1))
    {
        std::cout << "first branch" << std::endl;
    }
    else
    {
        std::cout << "second branch" << std::endl;
    }
} 
```

并且输出是“第一个分支”（在 Ubuntu 8.10 上使用 g++ 4.3.2），但 Indeera 在评论中提到，在使用 VS2005 编译的 Windows XP 上运行的相同代码给出了输出“第二个分支”（感谢 Indeera）。

`h`您可能会更改代码以将0.0 和1.0之间的差异与`h`一些小的 delta 值进行比较。

```
double allowedDelta = 0.000001;

if( ((h - 0.0) > allowedDelta) && ((1.0 - h) > allowedDelta) )
... // h is between 0.000001 and 0.9999990 
```

请注意，在这种特殊情况下，“(h - 0.0)”可以替换为“h”。为了说明价值，我将其保留原样。

另请注意，如果您只进行一次比较，则需要将 delta 与 h 与某个常数之间的差值的绝对值进行比较。由于您在此处检查范围，因此两个比较 AND 一起构成了一种特殊情况，您可以绕过使用`abs`. 如果 h 是一个负值或大于 1.0 的某个正值，它将超出范围并无法通过上述两个测试之一。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T16:23:19.417

小故事：您的测试不正确，因为浮点数的行为不像您可能期望的那样。特别是像“denom == 0”这样的东西是有问题的。

Sun 很乐意在网上提供这篇论文：

[每个计算机科学家都应该知道的关于浮点运算的知识](http://docs.sun.com/source/806-3568/ncg_goldberg.html)

这与宣传的完全一样。根据您的背景，这将是一个简单的阅读或大量的工作，但对于任何使用浮点数的程序员来说，这确实值得花时间。

添加评论：我并不是说每个程序员都能轻松理解该论文中的所有内容。不过，仔细阅读它至少可以更好地了解浮动实际上是什么，问题是什么，以及如何正确处理事情的一些提示。

如果你想正确地做很多数值工作，你将不得不阅读各种技术，但这将是一本（或几本）教科书的材料。这里的评论已经指出了一些基础知识，并链接到更多

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-03T14:11:22.947

比较浮点值时始终允许舍入误差。而不是测试平等，通常是你想要的这样的东西：

```
if (abs(x - y) < epsilon) ... 
```

其中 epsilon 是一些适当的小值，例如 0.00001。

浮点数学不准确有几个原因。首先，并不是所有的值都可以精确表示（例如0.1，不能用二进制浮点数表示，就像1/3不能用十进制表示一样）

另一个是浮点只使用固定数量的有效数字（相对于小数点“浮动”，因此得名）。因此，在大数字上，小部分有效地被截断。永远不要假设浮点计算会返回准确的结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T12:53:08.797

这可能是一个精度问题。H 可能不完全是 1，但非常接近它。您能否发布更多关于您正在尝试做的事情的信息，例如，H 的值来自哪里，它去哪里？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T16:30:52.847

好的，您已经发布了代码。您正在通过一系列算术运算从看起来相当任意的数字计算 h 。这意味着您将获得非常接近理想值 h 的近似值，但并不完全正确。

这意味着您需要进行近似比较。测试（h == 1.0）只会偶然成功；尝试 (fabs(h - 1.0) < 1e-10) 或类似的东西（使用 const double 而不是幻数来表示公差）。对其他比较进行适当的更改。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-03T13:12:00.437

这可能与 C/C++ 中的双精度数是 64 位这一事实有关，但计算可以以更高的精度完成（cpu 的浮点寄存器更宽（96 位），因此甚至没有像 cos(x )==cos(x) 可能是真的。

参考： http: [//www.parashift.com/c++-faq-lite/newbie.html#faq-29.18](http://www.parashift.com/c++-faq-lite/newbie.html#faq-29.18)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-03T13:39:12.383

原因是浮点数不是您保存在变量中的数字的真实表示。（反对 BCD [二进制编码的小数]）

你可以在这里看到定义： [浮点维基百科](http://en.wikipedia.org/wiki/Floating_point)

所以问题是某些数字不能用给定的一组位来表示。（如果你可以无限添加位，你可以）诀窍是，在大多数情况下，保存的数字和预期的数字之间的差异非常小。在实践中，您会遇到一些极端情况，这可能会导致问题。例如，这就是为什么您不应该构建财务软件并使用浮点数进行货币计算的原因。您可以很容易地发现税务局不喜欢的明显差异。

因此，要比较浮点数，您应该始终应用某种适用于您的应用程序的阈值。就像是：

```
if(a==b) 
```

变成

```
if(abs(a-b)<threshold) 
```

编辑：正如大卫在他的评论中提到的那样，你仍然会遇到像 pi、1./3.、......但你至少可以存储数字而不会损失你放入系统的精度。由于计算机的内存有限，您始终可以构建无法依赖精确表示的极端情况......

刚刚看到您对文本的编辑，所以这是下一个编辑：

```
if(a<1) 
```

有点困难，因为您不知道是数字表示错误还是只是接近 1 的实际值。这实际上取决于您的算法的要求。如果一个小错误是可以的，那么做：

```
if(a < 1-threshold) 
```

如果不行，那么你必须使用另一个没有问题的变量类型。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-03T17:14:28.967

您可能对GDC 2005 上的“[几何计算的数值鲁棒性](http://realtimecollisiondetection.net/pubs/)”（又名“EPSILON 不是 0.00001！”）演讲非常感兴趣。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-03T13:00:34.957

如果您必须在检查中使用浮点数，请将它们四舍五入并将其存储在例如整数中。1f 可以是 1.0000000000000000000000000000000001 或 0.999999999999999999999999999999999999

# iphone - UIWebView 中的 iPhone 下拉框

> ID：713785
> 
> 赞同：0
> 
> 时间：2009-04-03T12:56:31.427
> 
> 标签：iphone, uiwebview, drop-down-menu

我在我的应用程序的 UIWebView 中使用选择标签，但遇到了一些问题。

1.  当单击选择框时，会打开 UIPickerView，有什么方法可以禁用它吗？
2.  单击选择框时它会丢失，当我再次单击它的位置时它会出现，有什么办法可以阻止它？因为我总是希望它被展示出来。

这是我的代码：

```
webView = [[UIWebView alloc] initWithFrame:cellRectangle];
NSString *content = [NSString stringWithString:@""];
content = [content stringByAppendingString:@"<select style='width:100%;     height:100%'>"];
for(int i = 0; i<[seasons count]; i++){
Season *aSeason = [seasons objectAtIndex:i];
content = [content stringByAppendingString:@"<option"];
if(aSeason.n_isCurrent = 1) content = [content stringByAppendingString:@"   selected=\"yes\""];
content = [content stringByAppendingString:@">"];
content = [content stringByAppendingString:aSeason.c_Season];
content = [content stringByAppendingString:@"</option>"];
}
content = [content stringByAppendingString:@"</select>"];

webView.backgroundColor = [UIColor clearColor];
webView.scalesPageToFit = NO;
[webView setOpaque:NO];
[webView loadHTMLString:content baseURL:nil]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T02:17:08.333

一旦您将任何功能传递给 WebView，您就无能为力了。要回答您的具体问题：

1) 没有

2) 没有

如果你想要一个特定的行为，你必须做你自己的自定义视图并适当地编码。

# python - 在使用 Python 'with' 语句时捕获异常

> ID：713794
> 
> 赞同：346
> 
> 时间：2009-04-03T13:00:25.550
> 
> 标签：python, exception-handling

令我感到羞耻的是，我不知道如何处理 python 'with' 语句的异常。如果我有代码：

```
with open("a.txt") as f:
    print f.readlines() 
```

我真的很想处理“文件未找到异常”以做某事。但我不会写

```
with open("a.txt") as f:
    print f.readlines()
except:
    print 'oops' 
```

并且不能写

```
with open("a.txt") as f:
    print f.readlines()
else:
    print 'oops' 
```

在 try/except 语句中包含 'with' 不起作用：不会引发异常。为了以 Pythonic 方式处理“with”语句中的失败，我该怎么做？

* * *

## 回答 #1

> 赞同：301
> 
> 时间：2009-04-03T13:04:32.810

```
from __future__ import with_statement

try:
    with open( "a.txt" ) as f :
        print f.readlines()
except EnvironmentError: # parent of IOError, OSError *and* WindowsError where available
    print 'oops' 
```

如果您想要对公开调用与工作代码中的错误进行不同的处理，您可以执行以下操作：

```
try:
    f = open('foo.txt')
except IOError:
    print('error')
else:
    with f:
        print f.readlines() 
```

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2011-05-22T20:13:04.143

利用该语句的最佳“Pythonic”方法在[PEP 343](http://www.python.org/dev/peps/pep-0343/)`with`中列为示例 #6 ，它给出了语句的背景。

```
@contextmanager
def opened_w_error(filename, mode="r"):
    try:
        f = open(filename, mode)
    except IOError, err:
        yield None, err
    else:
        try:
            yield f, None
        finally:
            f.close() 
```

使用如下：

```
with opened_w_error("/etc/passwd", "a") as (f, err):
    if err:
        print "IOError:", err
    else:
        f.write("guido::0:0::/:/bin/sh\n") 
```

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2015-07-25T05:15:57.817

> ## 在使用 Python 'with' 语句时捕获异常

[自 Python 2.6 以来](https://docs.python.org/2/library/__future__.html)，with 语句在没有`__future__`导入的情况下可用。您可以[早在 Python 2.5](https://docs.python.org/2/whatsnew/2.5.html#pep-343-the-with-statement)中获得它（但此时是升级的时候了！）：

```
from __future__ import with_statement 
```

这是您所拥有的最接近纠正的东西。你快到了，但`with`没有`except`子句：

> ```
> with open("a.txt") as f: 
>     print(f.readlines())
> except:                    # <- with doesn't have an except clause.
>     print('oops') 
> ```

上下文管理器的`__exit__`方法，如果它返回，`False`它将在完成时重新引发错误。如果它返回`True`，它将抑制它。`open`内置`__exit__`函数不返回，`True`所以你只需要将它嵌套在 try 中，除了块：

```
try:
    with open("a.txt") as f:
        print(f.readlines())
except Exception as error: 
    print('oops') 
```

和标准样板文件：不要使用`except:`捕获`BaseException`和所有其他可能的异常和警告的bare。至少和 一样具体`Exception`，对于这个错误，也许可以 catch `IOError`。只捕获您准备处理的错误。

所以在这种情况下，你会这样做：

```
>>> try:
...     with open("a.txt") as f:
...         print(f.readlines())
... except IOError as error: 
...     print('oops')
... 
oops 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-07-30T22:19:19.303

# 区分复合`with`语句引发的异常的可能来源

区分`with`语句中发生的异常是很棘手的，因为它们可能起源于不同的地方。可以从以下任一位置（或其中调用的函数）引发异常：

*   `ContextManager.__init__`
*   `ContextManager.__enter__`
*   的身体`with`
*   `ContextManager.__exit__`

有关更多详细信息，请参阅有关[Context Manager Types](https://docs.python.org/3/library/stdtypes.html#context-manager-types)的文档。

如果我们想区分这些不同的情况，仅仅将 a 包裹起来`with`是`try .. except`不够的。考虑以下示例（`ValueError`用作示例，但当然可以将其替换为任何其他异常类型）：

```
try:
    with ContextManager():
        BLOCK
except ValueError as err:
    print(err) 
```

这里`except`将捕获源自所有四个不同位置的异常，因此不允许区分它们。如果我们将上下文管理器对象的实例化移到 之外`with`，我们可以区分`__init__`和`BLOCK / __enter__ / __exit__`：

```
try:
    mgr = ContextManager()
except ValueError as err:
    print('__init__ raised:', err)
else:
    try:
        with mgr:
            try:
                BLOCK
            except TypeError:  # catching another type (which we want to handle here)
                pass
    except ValueError as err:
        # At this point we still cannot distinguish between exceptions raised from
        # __enter__, BLOCK, __exit__ (also BLOCK since we didn't catch ValueError in the body)
        pass 
```

实际上，这只是对部分有所帮助，`__init__`但我们可以添加一个额外的哨兵变量来检查是否`with`开始执行的主体（即区分`__enter__`和其他）：

```
try:
    mgr = ContextManager()  # __init__ could raise
except ValueError as err:
    print('__init__ raised:', err)
else:
    try:
        entered_body = False
        with mgr:
            entered_body = True  # __enter__ did not raise at this point
            try:
                BLOCK
            except TypeError:  # catching another type (which we want to handle here)
                pass
    except ValueError as err:
        if not entered_body:
            print('__enter__ raised:', err)
        else:
            # At this point we know the exception came either from BLOCK or from __exit__
            pass 
```

棘手的部分是区分源自的异常`BLOCK`，`__exit__`因为逃脱主体的异常`with`将被传递给`__exit__`可以决定如何处理它的异常（请参阅[文档](https://docs.python.org/3/library/stdtypes.html#contextmanager.__exit__)）。但是，如果`__exit__`引发自身，则原始异常将被新异常替换。为了处理这些情况，我们可以`except`在 的主体中添加一个通用子句`with`来存储任何可能会被忽视的潜在异常，并将其与`except`稍后捕获的最外层的异常进行比较 - 如果它们相同，则意味着起源是`BLOCK`否则它是`__exit__`（如果`__exit__`通过在最外层返回一个真值来抑制异常`except`根本不会被执行）。

```
try:
    mgr = ContextManager()  # __init__ could raise
except ValueError as err:
    print('__init__ raised:', err)
else:
    entered_body = exc_escaped_from_body = False
    try:
        with mgr:
            entered_body = True  # __enter__ did not raise at this point
            try:
                BLOCK
            except TypeError:  # catching another type (which we want to handle here)
                pass
            except Exception as err:  # this exception would normally escape without notice
                # we store this exception to check in the outer `except` clause
                # whether it is the same (otherwise it comes from __exit__)
                exc_escaped_from_body = err
                raise  # re-raise since we didn't intend to handle it, just needed to store it
    except ValueError as err:
        if not entered_body:
            print('__enter__ raised:', err)
        elif err is exc_escaped_from_body:
            print('BLOCK raised:', err)
        else:
            print('__exit__ raised:', err) 
```

# 使用 PEP 343 中提到的等效形式的替代方法

[PEP 343——“with”语句](https://www.python.org/dev/peps/pep-0343/#specification-the-with-statement)指定了一个等效的“non-with”版本的`with`语句。在这里，我们可以轻松地包装各个部分，`try ... except`从而区分不同的潜在错误源：

```
import sys

try:
    mgr = ContextManager()
except ValueError as err:
    print('__init__ raised:', err)
else:
    try:
        value = type(mgr).__enter__(mgr)
    except ValueError as err:
        print('__enter__ raised:', err)
    else:
        exit = type(mgr).__exit__
        exc = True
        try:
            try:
                BLOCK
            except TypeError:
                pass
            except:
                exc = False
                try:
                    exit_val = exit(mgr, *sys.exc_info())
                except ValueError as err:
                    print('__exit__ raised:', err)
                else:
                    if not exit_val:
                        raise
        except ValueError as err:
            print('BLOCK raised:', err)
        finally:
            if exc:
                try:
                    exit(mgr, None, None, None)
                except ValueError as err:
                    print('__exit__ raised:', err) 
```

# 通常更简单的方法就可以了

这种特殊异常处理的需求应该很少见，通常将整个包装`with`在一个`try ... except`块中就足够了。特别是如果各种错误源由不同的（自定义）异常类型指示（需要相应地设计上下文管理器），我们可以轻松区分它们。例如：

```
try:
    with ContextManager():
        BLOCK
except InitError:  # raised from __init__
    ...
except AcquireResourceError:  # raised from __enter__
    ...
except ValueError:  # raised from BLOCK
    ...
except ReleaseResourceError:  # raised from __exit__
    ... 
```

# c++ - 在 C++ 中命名函数、方法、指针、变量、数组等

> ID：713797
> 
> 赞同：0
> 
> 时间：2009-04-03T13:01:20.230
> 
> 标签：c++, naming

好吧，和几个朋友一起做一些项目，我需要一些标准来命名 C++ 中的东西。有没有人有任何好的 c++ 命名方案，它是经过深思熟虑的，而不是像 10 分钟那样制作的。

例如，int* house 应该命名为 int* house_p，这样当有人阅读代码时，他就不需要一直滚动想知道一个东西是指针、数组、矩阵还是其他什么...

发布您正在使用的经过深思熟虑的命名方案！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-03T13:06:16.893

> 例如，int* house 应该命名为 int* house_p，这样当有人阅读代码时，他就不需要一直滚动想知道一个东西是指针、数组、矩阵还是其他什么...

但是如果它的类型发生了变化——你是否要检查所有的代码并更改所有变量的名称。如果变量是复杂类型的实例怎么办：

```
ComplicatedDerivativeFinancialInstrument x; 
```

你会使用什么后缀？

您所问的是[匈牙利符号](http://en.wikipedia.org/wiki/Hungarian_notation)- 它在 C++ 中的使用几乎被普遍认为是一个坏主意。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-03T13:09:47.243

`int*`在 C++ 中，在设计/重构代码时，将指针 ( ) 更改为引用 ( )是很常见的`int&`。如果您通过在变量名上包含一个表明它是指针的后缀来[重复自己，那么您将不得不将其更改为其他内容，到处都是。](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)这似乎是无意义的工作，只会让代码更难编辑和塑造成你想要的样子。

你不应该需要那种提醒；例如，如果变量是指针，从用法上会很清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T13:06:53.337

那里有很好的命名约定，但是在变量名称中包含类型信息（一种形式称为[匈牙利表示法](http://en.wikipedia.org/wiki/Hungarian_notation)）变得不那么流行了。大多数现代 IDE 只需将鼠标悬停在变量上即可为您提供有关变量的有用信息，例如它的类型。但是，如果它对您很重要，那么匈牙利符号可能就是您想要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-03T13:13:34.270

正如 Neil 和 aaronis 所提到的，您说的是一种[Hungarian Notation](http://en.wikipedia.org/wiki/Hungarian_notation)形式。由于 C++ 是一种强类型语言，因此通常被认为是一个坏主意。它使代码更难阅读，因为有一堆额外的字符妨碍了。

最初的匈牙利符号实际上用于表示超出类型所告诉的信息。例如，假设我正在做一些图形工作，并且我在各种坐标系中都有点。它们都是 Point 类型，但有些在对象坐标中，有些在相机坐标中，有些在世界坐标中。在这种情况下，将它们各自的变量命名为 oPt、cPt 和 wPt 是很有意义的。

从历史上看，这个“应用程序”匈牙利语对某些人来说似乎是一个好主意（额外的字符代码表示非类型信息），他们走得太远了，将其变成了“系统”匈牙利语（额外的字符代码表示 C++ 类型），这几天不受欢迎。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T14:17:40.280

作为一般规则，请使用您要解决的实际问题的语言。当您使用对外界有意义的良好、描述性标识符时，您的代码将记录自己。

至于语法，选择一个可读的约定，传达一些关于标识符的信息，但不会将你锁定在某些实现中。使其简单易记，这样您的编码人员就可以花更多的时间进行编码，而花更少的时间来满足复杂的语法要求。我发现以下内容很容易理解并且足够丰富：

*   类和方法定义 - 第一个字母大写，连接单词的第一个字母也大写
*   对象实例和函数参数 - 第一个字母小写，连接单词的第一个字母大写
*   类数据字段 - 尾随下划线，第一个字母字符小写，连接单词的第一个字母大写

恐怕它可能没有通过 10 分钟的测试，但如果需要超过 10 分钟的时间来解释，它可能会妨碍实际工作。

```
class FooProblem {
  int fooData_;
  public:
  FooProblem(int fooData): fooData_(fooData){}
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-03T14:33:43.173

如果 Facebook 上有一个“我讨厌匈牙利符号”组，我会加入。

这是一些说明我的标准的伪代码。

```
namespace utilities
{

class MyGizmo
{
public :
   void doTheThing();
   std::string name_;
private:
   int thingCount_;
};

static const char* ApplicationName = "Gizmotronic Ultra 1.0";

void setGizmoName(MyGizmo& gizmo, const std::string & name)
{
   gizmo.name_ = name;
}

int main()
{
   cout << ApplicationName;
   MyGizmo gizmo;
   gizmo.doTheThing();

   std::string gizmoName = gizmo.name_;

   return 0;
} 
```

# regex - 正则表达式在字符串中查找数字

> ID：713798
> 
> 赞同：27
> 
> 时间：2009-04-03T13:02:09.713
> 
> 标签：regex

我有一个字符串，可能包含也可能不包含 4 或 5 位数字。我正在寻找一个可以检测字符串是否确实有这样一个数字的正则表达式。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-03T13:12:52.027

避免更长数字的万无一失的方法是：

```
([^\d]|^)\d{4,5}([^\d]|$) 
```

我假设您不想在千位之后允许逗号？如果你这样做：

```
([^\d]|^)\d{1,2},\d{3}([^\d]|$) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T13:03:43.233

也许

```
\d{4,5} 
```

?

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T13:09:07.917

\d{4,5} 还会在其中找到带有 6 位数字的字符串 - 我不知道这是否有问题。你可能想做这样的事情：

([^\d]+|^)\d{4,5}[^\d]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-02-21T09:07:53.997

您还可以使用负前瞻和后视来执行此操作：

```
 (?<!\d)\d{4,5}(?!\d) 
```

寻找 4-5 个数字，这些数字前面或后面都没有其他数字。

这具有匹配字符串中的 4-5 位数字的额外优势，例如`asdsad1as12316asd`包含较短数字的字符串。它的缺点是匹配字符串中的所有 4-5 位数字，这可能不是所需要的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T13:03:35.607

简单`\d{4,5}`就足够了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-03T13:03:49.677

。网？然后就是**`[0-9]{4,5}`**

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2019-02-21T08:38:51.667

这是一个 sudocode 不要复制和粘贴它，它在检查字符串时会很有帮助，它是否包含数字。

```
 if(str.matches(".*\\d+.*")) 
   print "contains numbers ";
 else 
   Print "doesn't contain numbers "; 
```

# c# - .NET - 终结器和退出 (0)

> ID：713805
> 
> 赞同：4
> 
> 时间：2009-04-03T13:03:30.350
> 
> 标签：c#, .net, c++, finalizer, object-lifetime

我有一个 .NET C# / C++ 应用程序，它在线程中使用对`exit(0)`(from `<stdlib.h>`) 的调用来终止。

奇怪的是，在某些情况下，托管对象的终结器在调用之后立即被调用`exit`，而在其他情况下，它们根本不会被调用。

情况非常确定 - 应用程序在其生命周期内从外部插件 dll（用非托管 C 编写）调用一些方法。
如果我使用 dll A，则始终调用终结器。
如果我使用 dll B，则永远不会调用终结器。

在 exit(0) 调用的情况下，终结器的预期行为是什么？（如果有任何预期的 - 和记录的 - 行为）

对外部 dll 的调用能否更改一些可能影响进程终止方式的全局设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T13:15:21.163

Chris Brumme 谈到了在进程关闭期间如何处理终结器：

*   [http://blogs.msdn.com/cbrumme/archive/2004/02/20/77460.aspx](http://blogs.msdn.com/cbrumme/archive/2004/02/20/77460.aspx)（查看标题为“V1 & V1.1 最终确定保证”的部分）。

最重要的是，对于在关闭时运行的终结器的保证方式似乎很少，但我不确定 DLL 可能会做什么来导致事情发生不同（也许是一个 DLL 正在做DLL_PROCESS_DETACH 处理中的某些内容使 .NET 有机会处理终结器。

这篇文章是针对 .NET 1.x 的——我不确定在 .NET 2.0 或更高版本中有多少变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T13:26:20.420

根据 Jeff Richter 的书，系统确实会尝试在进程关闭时调用终结器，但是在此过程中，每个终结器（2 秒）和总终结器（40 秒）都超时，之后进程被中止。（当然，现在可能已经改变了确切的时间，这对 2.0 来说是正确的）

你能看到一个运行时间超过 2 秒的终结器吗？这将导致最终确定停止。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T13:33:31.867

归根结底，这是一个“军备竞赛”问题。有人在微软记录了一个错误，抱怨当一些讨厌的代码使进程退出时，他们的终结器没有运行——因此问题得到了解决。然后其他人记录了一个关于似乎没有办法强制进程立即退出以使终结器不运行的错误，因此微软添加了一个新的 API 来再次允许它。因此，另一个人需要一种新的“关键”终结器，即使响应这种新的退出，它也总是运行......等等。

因此，更改 C++ 代码可能比尝试依赖当前赢得军备竞赛的人更容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-11T15:11:48.433

如果您放入终结器中的代码相当关键，请将其移至 Dispose 并在 Dispose 中使用 if(!disposed) 模式调用终结器中的 Dispose。

在我的书中，不应该依赖终结器来被运行时调用。Dispose 是显式的，您可以对其进行更精细和确定性的控制。

# .net - 整数矩阵中最大的

> ID：713813
> 
> 赞同：0
> 
> 时间：2009-04-03T13:04:27.523
> 
> 标签：.net, arrays

我需要编写一个从整数矩阵中挑选出最大数字的函数。矩阵通过指针类型参数传递给函数。行数和列数也通过参数传递给函数。该函数应返回最大数量的矩阵元素。

我需要在程序中使用此函数从磁盘文件“matrix.dat”中读取 (m*n) 矩阵，其中 m 是行数，n 是列数。假设数据文件最初具有 m 和 n 的值，然后存储矩阵元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T13:12:36.270

出色地：

*   从第一个元素开始并保存它。
*   对于其他元素，将其与保存的元素进行比较，如果最大则保存。
*   最终你拥有最大的价值。

如果矩阵的行或列数为 0 或更少，请不要忘记恐慌。

# ms-access - VBA代码计算列表框中包含SQL查询结果的所有数字列

> ID：713823
> 
> 赞同：0
> 
> 时间：2009-04-03T13:06:29.437
> 
> 标签：ms-access, vba, count, isnumeric

这是在 Access 2007 中。我尝试过编写如下内容：

```
Forms!MyForm!TextBox = Count(ISNUMERIC(ISNUMERIC(QueryResult.Reading))) 
```

但这会返回非数字结果。我也试过：

```
Forms!MyForm!TextBox = IIF(ISNUMERIC(QueryResult.Reading),Count(ISNUMERIC(QueryResult.Reading),"") 
```

有人有想法么？我搞不清楚了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T13:12:20.017

尝试使用 SUM 而不是 COUNT，这样，如果结果是数字，则计算结果，如果不是，则忽略它。请注意，我无法测试下面的代码，但它应该让您了解我的意思。

```
Forms!MyForm!TextBox = SUM(IIF(ISNUMERIC(QueryResult.Reading),1,0)) 
```

# perl - 如何使用 Perl 筛选抓取？

> ID：713827
> 
> 赞同：7
> 
> 时间：2009-04-03T13:07:37.873
> 
> 标签：perl, screen-scraping

我需要显示一些存储在网站中的值，因为我需要抓取网站并从表中获取内容。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-03T13:13:06.143

如果您熟悉 jQuery，您可能想查看[pQuery](http://search.cpan.org/~ingy/pQuery-0.07/lib/pQuery.pm)，这很容易：

```
## print every <h2> tag in page
use pQuery;

pQuery("http://google.com/search?q=pquery")
    ->find("h2")
    ->each(sub {
        my $i = shift;
        print $i + 1, ") ", pQuery($_)->text, "\n";
    }); 
```

还有[HTML::DOM](http://search.cpan.org/dist/HTML-DOM/)。

但是，无论您做什么，都不要为此使用正则表达式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-03T13:21:11.133

我过去使用过[HTML 表格提取](http://search.cpan.org/~msisk/HTML-TableExtract-2.10/lib/HTML/TableExtract.pm)。我个人觉得使用起来有点笨拙，但可能我没有很好地理解对象模型。我通常使用手册的这一部分来检查数据：

```
 use HTML::TableExtract;
 $te = HTML::TableExtract->new();
 $te->parse($html_string);

     # Examine all matching tables
     foreach $ts ($te->tables) {
       print "Table (", join(',', $ts->coords), "):\n";
       foreach $row ($ts->rows) {
          print join(',', @$row), "\n";
       }
     }` 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-03T15:11:48.903

虽然我通常使用[LWP](http://search.cpan.org/~gaas/libwww-perl-5.825/lib/LWP.pm) / [LWP::Simple](http://search.cpan.org/~gaas/libwww-perl-5.825/lib/LWP/Simple.pm)完成此操作，但当前在 Perl 中用于任何类型网页抓取的“首选”模块是[WWW::Mechanize](http://search.cpan.org/~petdance/WWW-Mechanize-1.54/lib/WWW/Mechanize.pm)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-05T09:22:12.030

你也可以使用这个简单的 perl 模块 WEB::Scraper，这很容易理解并且让我的生活变得轻松。请按照此示例获取更多信息。

[http://teusje.wordpress.com/2010/05/02/web-scraping-with-perl/](http://teusje.wordpress.com/2010/05/02/web-scraping-with-perl/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T20:34:58.827

如果您熟悉 XPath，还可以使用[HTML::TreeBuilder::XPath](http://search.cpan.org/dist/HTML-TreeBuilder-XPath)。如果你不是......那么你应该是;--)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-05T13:18:45.007

对于类似的 Stackoverflow 问题，请查看....

*   [如何从 Perl 中的网页中提取 URL](https://stackoverflow.com/questions/254345/how-can-i-extract-urls-from-a-web-page-in-perl)
*   [如何使用 Perl 的 LWP 提取网站的 XML 并保存在文件中？](https://stackoverflow.com/questions/221091/how-can-i-extract-xml-of-a-website-and-save-in-a-file-using-perls-lwp)

我确实喜欢将[pQuery](http://search.cpan.org/~ingy/pQuery/)用于此类事情，但是[Web::Scraper](http://search.cpan.org/dist/Web-Scraper/)看起来确实很有趣。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-10T14:54:24.820

看看神奇的[Web::Scraper](http://search.cpan.org/~miyagawa/Web-Scraper/)，它是网页抓取的**工具**。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-12-10T14:34:15.063

我并不是要拖出一个死线程，但是任何在这个线程上搜索的人也应该检查[WWW::Scripter](http://search.cpan.org/~sprout/WWW-Scripter-0.010/lib/WWW/Scripter.pod) - '用于编写有脚本的网站'

快乐的远程数据聚合；）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-05-10T13:18:54.270

看看这个用 perl 抓取网页的小例子： [链接文本](http://teusje.wordpress.com/2010/05/02/web-scraping-with-perl/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-03T14:47:13.313

我使用[LWP::UserAgent](http://search.cpan.org/~gaas/libwww-perl-5.825/lib/LWP/UserAgent.pm)来满足我的大部分屏幕抓取需求。如果您需要 Cookie 支持，也可以将其与[HTTP::Cookies结合使用。](http://search.cpan.org/~gaas/libwww-perl-5.825/lib/HTTP/Cookies.pm)

这是一个关于如何获取源代码的简单示例。

```
use LWP;
use HTTP::Cookies;
my $cookie_jar = HTTP::Cookies->new;
my $browser = LWP::UserAgent->new;
$browser->cookie_jar($cookie_jar);

$resp = $browser->get("https://www.stackoverflow.com");
if($resp->is_success) {
   # Play with your source here
   $source = $resp->content;
   $source =~ s/^.*<table>/<table>/i; # this is just an example 
   print $source;                     # not a solution to your problem.
} 
```

# c# - 如何在 C# 项目中包含 Castle ActiveRecord 程序集

> ID：713832
> 
> 赞同：0
> 
> 时间：2009-04-03T13:09:16.870
> 
> 标签：c#, boost, visual-studio-2005, castle

我遇到了教授运行 C# 程序可能存在的潜在问题。Castle ActiveRecord 的文档说：

> 如果您使用的是 Visual Studio .Net，请添加对以下程序集的引用：
> 
> *   Castle.ActiveRecord.dll
> *   Castle.Core.dll
> *   Castle.Components.Validator.dll
> *   Castle.DynamicProxy.dll
> *   NHibernate.dll
> *   Iesi.Collections.dll
> *   log4net.dll

我想出了如何在标准 C++ 中添加对 Boost 的引用，但我的教授无法运行该应用程序，因为他没有安装 Boost。

城堡也会发生同样的事情吗？如果是这样，我如何将程序集包含在项目中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T13:15:31.240

您可以做的是在您的项目中创建一个文件夹来保存这些程序集的私有副本。然后，当您添加对它们的引用时，请添加对私有副本的引用，而不是对您机器上已安装的副本的引用。

# c# - 动态删除控件的问题

> ID：713836
> 
> 赞同：1
> 
> 时间：2009-04-03T13:10:58.973
> 
> 标签：c#

注意：在 WinForm 中

我在 TableLayoutPanel 中遇到问题。我使用 TableLauoutPanel 添加和删除控件动态。我的问题是，如果我删除了中间的控件（即我添加了 TextBox1、TextBox2 和 TextBox3，现在我删除了 TextBox2），此时其他控件的大小不会正确调整。当最后一个控件（即 TextBox3 ）被删除时，它的大小会正确调整。我在这里附上了我的代码。问题是什么？

///这里 tbl 是 TableLayoutPanel

```
private void AddText_Click(object sender, EventArgs e)
{    
    TextBox txt = new TextBox();
    txt.MouseDoubleClick += new MouseEventHandler(txt_MouseDoubleClick);
    txt.Multiline = true;
    txt.Dock = DockStyle.Fill; NEWADD(txt);
}

private void NEWADD(Control ctrl)
{
    tbl.RowCount += 1;
    tbl.RowStyles.Add(new RowStyle(SizeType.Percent, 100F / tbl.RowStyles.Count));
    tbl.Controls.Add(ctrl, 0, tbl.RowStyles.Count - 1); 

    foreach (RowStyle row in tbl.RowStyles)
    {
        row.SizeType = SizeType.Percent;
        row.Height = 100F / (tbl.RowStyles.Count);
    }
}

private void RemoveControl(Control ctrl)
{ 
    tbl.RowCount -= 1; 
    tbl.Controls.Remove(ctrl); 
    tbl.RowStyles.Clear();

    for (int i = 0; i < tbl.Controls.Count; i++)
    {
        tbl.RowStyles.Add(new RowStyle(SizeType.Percent, 100F /( tbl.RowStyles.Count +1)));
    }

    foreach (RowStyle row in tbl.RowStyles)
    {
        row.SizeType = SizeType.Percent;
        row.Height = 100F / (tbl.RowStyles.Count);
    }

    tbl.Refresh();
} 

void txt_MouseDoubleClick(object sender, MouseEventArgs e)
{
    RemoveControl(sender as Control);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T13:16:01.537

目前无法对其进行测试，但看起来您的问题是删除控件所在行的逻辑。

```
tbl.RowCount -= 1 
```

总是要删除最后一行。您需要在要删除的控件之后逐行浏览每个控件，然后将控件向上移动一行。也许像这样的东西......

```
foreach(Control control in tbl.Controls)
{
    if(control.Row > controlToRemove.Row)
        control.Row--;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T13:14:32.333

由于看起来您还尝试为每个控件动态创建一个新的表格行，因此使用 FlowLayoutPanel 可能会做得更好。您应该能够对其进行样式设置以获得类似的效果，并且它将能够自动处理“行创建”。

# php - mysqli for Ubuntu 8.04 LAMP 堆栈上的 php

> ID：713838
> 
> 赞同：5
> 
> 时间：2009-04-03T13:11:26.507
> 
> 标签：php, mysqli, ubuntu-8.04

有谁知道如何在 Ubuntu 8.04 上使用 PHP 5 和 MySQL 5.0 启用/安装 mysqli 包/扩展？

最好我想保留现有的安装，但如有必要，我会从头开始重新安装。

我意识到从技术上讲，它与编程无关，但我认为（在一定程度上，也许）它是支持编程的？*希望*

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-12-04T00:03:07.797

在 Ubuntu Hardy (8.04) 中，mysqli 与标准 mysql 库和 pdo 一起是 php5-mysql 包的一部分 - 请参阅[http://packages.ubuntu.com/hardy/php5-mysql](http://packages.ubuntu.com/hardy/php5-mysql)了解更多信息。

```
sudo apt-get install php5-mysql 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T13:14:47.607

您可能必须使用 mysqli 选项安装 php：apt-get install php5-mysqli

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T13:18:19.987

[来自 PHP 文档。](http://is.php.net/manual/en/mysqli.installation.php)

> 为确保启用 PHP 的 mysqli 扩展，您需要配置 PHP 源代码以使用 mysqli。这是通过在构建 PHP 之前运行带有选项 --with-mysqli=mysql_config_path/mysql_config 的配置脚本来实现的。这将启用 mysqli 并将使用 MySQL 客户端库 (libmysql) 与 MySQL 服务器进行通信。

但是因为你在ubuntu上。你可以只安装 mysqli 包。[关于它的详细信息在这里。](http://packages.ubuntu.com/dapper/php5-mysqli)

```
sudo apt-get install php5-mysqli 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-07T18:07:50.970

使用 PHP5 的 php5-mysqli 包不可用，但它被另一个包取代。可能是包已过时。

可以通过以下命令下载

```
sudo apt-get install php5-mysqlnd 
```

# crystal-reports - 将水晶报表降级到旧版本？

> ID：713844
> 
> 赞同：1
> 
> 时间：2009-04-03T13:12:48.347
> 
> 标签：crystal-reports

我有一个遗留应用程序，可以使用开发时当前的水晶组件向用户显示水晶报告。可悲的是，当时的版本是 8.5。

如果我尝试在旧应用程序中打开 XI 报告，则会出现无法打开报告的异常。

我想在该应用程序中显示 Crystal XI 报告。水晶报表可以降级到旧版本吗？

如果我可以在 Crystal XI 中打开它并执行 File->Save As->“Crystal 8”，那就太好了，但当然它从来没有那么容易......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T13:22:44.937

您可以在 XI 查看器中显示 8.5 报告。但是，不是相反。也许将旧版应用程序升级到 XI？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T13:18:18.427

您将得到的最好的结果是回收查询或存储过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T00:19:19.467

Crystal Reports 9.0 将报表格式更改为完全兼容 Unicode。他们认为尝试向后转换所有 Unicode 部分的工作量太大，这意味着无法保存所有以前的报告格式。可能您唯一的途径是将报告导出到“报告定义”文件并在 8.5 中手动重新创建它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-20T14:21:33.537

如果你也有 crystalreports.com，我刚刚发现你可以将 2008 年的报告上传到 crystalreports.com，在那里运行并将其导出为 Crystal Report，CR XIr2 可以读取它。我知道 Crystalreports.com 运行 XI Server，所以它也可以在那里工作。

# python - Python REST（Web 服务）框架的推荐？

> ID：713847
> 
> 赞同：321
> 
> 时间：2009-04-03T13:13:23.837
> 
> 标签：python, web-services, rest, frameworks

是否有不同的基于 Python 的 REST 框架的建议列表，用于在服务器端编写您自己的 RESTful API？最好各有优劣。

请随时在此处添加建议。:)

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2009-05-28T10:25:21.867

在设计 RESTful API 时需要注意的是 GET 和 POST 的混淆，就好像它们是同一件事一样。[使用Django](http://www.djangoproject.com/)的[基于函数的视图](https://docs.djangoproject.com/en/dev/topics/http/views/)和[CherryPy](http://www.cherrypy.org/)的默认调度程序很容易犯这个错误，尽管这两个框架现在都提供了解决这个问题的方法（分别[是基于类的视图](https://docs.djangoproject.com/en/dev/topics/class-based-views/)和[MethodDispatcher](http://docs.cherrypy.org/dev/refman/_cpdispatch.html#cherrypy._cpdispatch.MethodDispatcher)）。

[HTTP 动词在 REST 中非常重要](http://en.wikipedia.org/wiki/Representational_State_Transfer#RESTful_web_services)，除非您对此非常小心，否则您最终会陷入[REST 反模式](http://www.infoq.com/articles/rest-anti-patterns)。

一些正确的框架是[web.py](http://webpy.org/)、[Flask](http://flask.pocoo.org)和[Bottle](http://bottlepy.org)。当与[mimerender](https://github.com/martinblech/mimerender)库（完全公开：我写的）结合使用时，它们允许您编写漂亮的 RESTful Web 服务：

```
import web
import json
from mimerender import mimerender

render_xml = lambda message: '<message>%s</message>'%message
render_json = lambda **args: json.dumps(args)
render_html = lambda message: '<html><body>%s</body></html>'%message
render_txt = lambda message: message

urls = (
    '/(.*)', 'greet'
)
app = web.application(urls, globals())

class greet:
    @mimerender(
        default = 'html',
        html = render_html,
        xml  = render_xml,
        json = render_json,
        txt  = render_txt
    )
    def GET(self, name):
        if not name: 
            name = 'world'
        return {'message': 'Hello, ' + name + '!'}

if __name__ == "__main__":
    app.run() 
```

服务的逻辑只实现一次，正确的表示选择（Accept header）+分发到正确的渲染函数（或模板）以整洁、透明的方式完成。

```
$ curl localhost:8080/x
<html><body>Hello, x!</body></html>

$ curl -H "Accept: application/html" localhost:8080/x
<html><body>Hello, x!</body></html>

$ curl -H "Accept: application/xml" localhost:8080/x
<message>Hello, x!</message>

$ curl -H "Accept: application/json" localhost:8080/x
{'message':'Hello, x!'}

$ curl -H "Accept: text/plain" localhost:8080/x
Hello, x! 
```

**更新（2012 年 4 月）**：添加了有关 Django 基于类的视图、CherryPy 的 MethodDispatcher 以及 Flask 和 Bottle 框架的信息。当问题被问到时，两者都不存在。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2011-01-08T06:49:48.623

没有人提到[烧瓶](http://flask.pocoo.org/)感到惊讶。

```
from flask import Flask
app = Flask(__name__)

@app.route("/")
def hello():
    return "Hello World!"

if __name__ == "__main__":
    app.run() 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-03T13:30:30.907

我们将[Django](http://www.djangoproject.com/)用于 RESTful Web 服务。

请注意——开箱即用——Django 没有足够细粒度的身份验证来满足我们的需求。我们使用了[Django-REST 接口](http://code.google.com/p/django-rest-interface/)，这很有帮助。[从那以后我们推出了自己的产品，因为我们做了很多扩展，以至于它已经成为维护的噩梦。]

我们有两种 URL：实现面向人的 HTML 页面的“html” URL，以及实现面向 Web 服务的处理的“json” URL。我们的视图函数通常是这样的。

```
def someUsefulThing( request, object_id ):
    # do some processing
    return { a dictionary with results }

def htmlView( request, object_id ):
    d = someUsefulThing( request, object_id )
    render_to_response( 'template.html', d, ... )

def jsonView( request, object_id ):
    d = someUsefulThing( request, object_id )
    data = serializers.serialize( 'json', d['object'], fields=EXPOSED_FIELDS )
    response = HttpResponse( data, status=200, content_type='application/json' )
    response['Location']= reverse( 'some.path.to.this.view', kwargs={...} )
    return response 
```

关键是有用的功能是从两个演示文稿中提取出来的。JSON 表示通常只是请求的一个对象。HTML 演示文稿通常包括各种导航帮助和其他有助于人们提高工作效率的上下文线索。

功能都非常相似，这`jsonView`可能有点烦人。但它是 Python，所以让它们成为可调用类的一部分，或者在有帮助的情况下编写装饰器。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-03T13:26:06.550

请参阅[Python Web 框架](http://wiki.python.org/moin/WebFrameworks)wiki。

您可能不需要*完整的堆栈*框架，但剩下的列表仍然很长。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-04-03T13:39:04.007

我真的很喜欢[CherryPy](http://cherrypy.org/)。下面是一个 RESTful Web 服务的示例：

```
import cherrypy
from cherrypy import expose

class Converter:
    @expose
    def index(self):
        return "Hello World!"

    @expose
    def fahr_to_celc(self, degrees):
        temp = (float(degrees) - 32) * 5 / 9
        return "%.01f" % temp

    @expose
    def celc_to_fahr(self, degrees):
        temp = float(degrees) * 9 / 5 + 32
        return "%.01f" % temp

cherrypy.quickstart(Converter()) 
```

这强调了我真正喜欢 CherryPy 的地方；这是一个完整的工作示例，即使对于不了解该框架的人来说也是非常容易理解的。如果您运行此代码，那么您可以立即在 Web 浏览器中看到结果；例如，访问[http://localhost:8080/celc_to_fahr?degrees=50](http://localhost:8080/celc_to_fahr?degrees=50)将显示`122.0`在您的网络浏览器中。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-08-11T00:22:05.757

看一眼

*   [伊蒂](http://github.com/toastdriven/itty/tree "伊蒂")（[博](http://www.toastdriven.com/fresh/itty-sinatra-inspired-micro-framework/)文）
*   [瓶子](http://github.com/defnull/bottle/tree "瓶子")
*   [网页.py](http://webpy.org/)
*   [朱诺](http://brianreily.com/project/juno/)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-08-01T10:50:42.290

我认为没有任何理由使用 Django 来公开 REST api，有更轻、更灵活的解决方案。Django 提供了很多其他的东西，这些东西并不总是需要。如果您只想将某些代码公开为 REST 服务，则肯定不需要。

我个人的经验是，一旦你有了一个万能的框架，你就会开始使用它的 ORM、它的插件等，因为它很简单，并且很快你就会产生依赖这是很难摆脱的。

选择 Web 框架是一个艰难的决定，我会避免仅仅为了公开 REST API 而选择全栈解决方案。

现在，如果你真的需要/想要使用 Django，那么 Piston 是 django 应用程序的一个不错的 REST 框架。

话虽如此，CherryPy 看起来也很不错，但似乎比 REST 更像 RPC。

查看示例（我从未使用过），如果您只需要 REST，web.py 可能是最好和最干净的。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-10-05T10:23:27.313

这是 CherryPy 文档中关于 REST 的讨论：http: [//docs.cherrypy.org/dev/progguide/REST.html](http://docs.cherrypy.org/dev/progguide/REST.html)

特别是它提到了一个内置的 CherryPy 调度程序，称为 MethodDispatcher，它根据 HTTP 动词标识符（GET、POST 等）调用方法。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2011-03-28T16:13:59.633

2010 年，Pylons 和 repoze.bfg 社区“联手”创建了[Pyramid](http://pylonsproject.org/)，这是一个主要基于 repoze.bfg 的 Web 框架。它保留了其父框架的理念，可用于[RESTful 服务](http://zhuoqiang.me/a/restful-pyramid)。值得一看。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2010-12-04T18:07:48.040

[Piston](http://bitbucket.org/jespern/django-piston/wiki/Home)是一个非常灵活的框架，用于为 Django 应用程序编写 RESTful API。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-02-25T13:26:53.980

现在似乎各种python web框架都可以实现RESTful接口。

对于Django来说，除了tastepie和piston，django-rest-framework是一个值得一提的有前途的。我已经顺利迁移了我的一个项目。

> Django REST 框架是 Django 的轻量级 REST 框架，旨在使构建连接良好、自描述的 RESTful Web API 变得容易。

快速示例：

```
from django.conf.urls.defaults import patterns, url
from djangorestframework.resources import ModelResource
from djangorestframework.views import ListOrCreateModelView, InstanceModelView
from myapp.models import MyModel

class MyResource(ModelResource):
    model = MyModel

urlpatterns = patterns('',
    url(r'^$', ListOrCreateModelView.as_view(resource=MyResource)),
    url(r'^(?P<pk>[^/]+)/$', InstanceModelView.as_view(resource=MyResource)),
) 
```

以官方网站为例，以上所有代码都提供了 api、自我解释文档（如基于肥皂的 web 服务）甚至沙箱来测试一下。很方便。

链接： [http ://django-rest-framework.org/](http://django-rest-framework.org/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-04-03T13:15:59.710

我不是 python 世界的专家，但我一直在使用[django](http://www.djangoproject.com/)，它是一个优秀的 web 框架，可以用来创建一个 restful 框架。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-03-28T14:26:42.543

[web2py](http://www.web2py.com)包括对轻松构建 RESTful API 的支持，[在此处](http://web2py.com/books/default/chapter/29/10#Restful-Web-Services)和[此处](http://vimeo.com/21133657)进行了描述（视频）。特别是[`parse_as_rest`](http://web2py.com/books/default/chapter/29/10#parse_as_rest-%28experimental%29)，它允许您定义将请求参数映射到数据库查询的 URL 模式；和[`smart_query`](http://web2py.com/books/default/chapter/29/10#smart_query-%28experimental%29)，它使您能够在 URL 中传递任意自然语言查询。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-02-10T07:49:37.863

如果您使用的是 Django，那么您可以考虑[django-tastypie](https://github.com/toastdriven/django-tastypie)作为[django-piston](https://bitbucket.org/jespern/django-piston/wiki/Home)的替代品。它比活塞更容易调整到非 ORM 数据源，并且有很好的[文档](http://tastypieapi.org/)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-11-12T15:13:58.420

我强烈推荐 TurboGears 或 Bottle：

涡轮齿轮：

*   比 django 简洁
*   更灵活，更少面向 HTML
*   但是：不太出名

瓶子：

*   非常快
*   很容易学
*   但是：简约而不成熟

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2011-11-22T00:46:25.027

我们正在为严格的 REST 服务制定一个框架，请查看[http://prestans.googlecode.com](http://prestans.googlecode.com)

目前它处于早期 Alpha 阶段，我们正在针对 mod_wsgi 和 Google 的 AppEngine 进行测试。

寻找测试人员和反馈。谢谢。

# vb.net - 清除字符串数组的最佳方法是什么？

> ID：713867
> 
> 赞同：18
> 
> 时间：2009-04-03T13:19:57.110
> 
> 标签：vb.net, arrays

清除字符串数组的最佳方法是什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-03T13:23:14.170

错误的方法：

```
myArray = Nothing 
```

仅将指向数组的变量设置为空，但实际上并不清除数组。指向同一数组的任何其他变量仍将保留该值。因此有必要清除数组。

正确的方式

```
Array.Clear(myArray,0,myArray.Length) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T13:35:07.120

当然还有使用 Erase 关键字的 VB 方式：

```
Dim arr() as String = {"a","b","c"}
Erase arr 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T13:23:46.667

取决于你想要什么：

*   不分配任何内容（空）
*   分配一个新的（空）数组
*   数组.清除

最后可能是最慢的，但如果您不想要新阵列，则只有选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-03T13:31:47.270

如果你需要做一些事情，比如清除，你可能想要一个*集合*而`List(Of String)` 不是一个数组。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-17T11:20:01.363

redim arr(1,1,1,1) 然后 redim (z,x,y,v) 到您的尺寸

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-07-02T20:21:17.543

这是我用来清除字符串数组内容的简单调用：

```
Public Sub ClearArray(ByRef StrArray As String())
    For iK As Int16 = 0 To StrArray.Length - 1
        StrArray(iK) = ""
    Next
End Sub 
```

然后只需调用它：

```
ClearArray(myLocalArray) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-05T06:48:36.837

如果您需要使用空字符串或其他不等于 Nothing/Null 的值重新初始化，您可以使用扩展方法进一步：

```
Option Strict On : Option Explicit On : Option Infer On
...
Public Delegate Sub ArrayForAllDelegate(Of T)(ByRef message As T)
<Extension>
Public Function ForAll(Of T)(ByRef self As T(), f As ArrayForAllDelegate(Of T)) As T()
    Dim i = 0
    While i < self.Length
        f(self(i))
        i += 1
    End While
    Return self
End Function 
```

然后你的初始化代码：

```
Dim a = New String(3 - 1) {"a", "b", "c"}
...
a.ForAll(Sub(ByRef el) el = "") 'reinitialize the array with actual empty strings 
```

# c# - 如何编写重定向 Facebook 应用程序的自定义 MVC ActionFilterAttribute

> ID：713874
> 
> 赞同：2
> 
> 时间：2009-04-03T13:22:15.407
> 
> 标签：c#, asp.net-mvc, facebook, fbml

我需要一个属性来处理我的控制器的授权。这是针对 Facebook 应用程序的，围绕该问题存在一些障碍。

我真正需要的是等价于 a`server.transfer`但当然这不是 ASP.NET MVC 中的一个选项。由于 Facebook 使用应用程序的方式，重定向将不起作用。

有没有办法可以从内部重新路由`ActionFilterAttribute`？

```
public class FbAuthorize : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (!Service.SignedIn())
            RouteToAction("Account", "Index"); // Fictional method (I wish it existed)
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T07:06:21.533

如果您使用的是 facebook 开发人员的工具包，您可以在 ActionFiler 的 OnActionExecuting 方法中实现 basepagehelper 的 LoadFBMLPage 方法。（否则你必须自己发出 fb:redirect 标签）。这是一个简短的文章：http: [//onihimura.com/2009/04/13/facebook-and-aspnet-mvc/](http://onishimura.com/2009/04/13/facebook-and-aspnet-mvc/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T13:30:12.640

您可以使用与要路由到的操作相同的数据来渲染 sam 视图。将生成数据的代码抽象回模型中，两种方法都可以从那里使用它，从而减少重复。这不会为您提供相同的 URL，但会为您提供所需的视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-24T14:56:01.770

这是您的“Server.Transfer()”或类似的：

```
public static class ServerHelper {

  public static void Transfer(ActionExecutingContext filterContext, string url) {

    // Rewrite path
    HttpContext.Current.RewritePath(GetPath(filterContext, url), false);

    IHttpHandler httpHandler = new System.Web.Mvc.MvcHttpHandler();

    // Process request
    httpHandler.ProcessRequest(HttpContext.Current);
    filterContext.HttpContext.Response.End();
  }

  private static string GetPath(ActionExecutingContext filterContext, string url) {
      HttpRequestBase request = filterContext.HttpContext.Request;

      UriBuilder uriBuilder = new UriBuilder(request.Url.Scheme, request.Url.Host, request.Url.Port, request.ApplicationPath);

      uriBuilder.Path += url;

      return filterContext.HttpContext.Server.UrlDecode(uriBuilder.Uri.PathAndQuery);
  }
} 
```

现在，在您的过滤器中，只需调用：

```
ServerHelper.Transfer(filterContext, "Account/Index"); 
```

干杯

# r - 计算矩阵的特征值有多昂贵？

> ID：713878
> 
> 赞同：37
> 
> 时间：2009-04-03T13:23:03.610
> 
> 标签：r, matrix, linear-algebra, sparse-matrix, eigenvalue

计算矩阵的特征值有多昂贵？

最佳算法的复杂度是多少？

如果我有一个 1000 x 1000 的矩阵，实际需要多长时间？我认为如果矩阵稀疏会有帮助吗？

是否存在特征值计算不会终止的情况？

在`R`中，我可以计算特征值，如下面的玩具示例所示：

```
m<-matrix( c(13,2, 5,4), ncol=2, nrow=2 )
eigen(m, only.values=1)
$values
[1] 14  3 
```

有谁知道它使用什么算法？

是否有任何其他（开源）包可以计算特征值？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-03T15:05:37.607

大多数用于特征值计算的算法都可以扩展到 big-Oh(n^3)，其中 n 是（对称和方形）矩阵的行/列维度。

要了解迄今为止最佳算法的时间复杂度，您必须参考科学计算/数值方法中的最新研究论文。

但即使您假设最坏的情况，对于 1000x1000 矩阵，您仍然需要至少 1000^3 次操作。

R 默认使用 LAPACK 例程的（DSYEVR、DGEEV、ZHEEV 和 ZGEEV）实现。但是，您可以指定 EISPACK=TRUE 作为参数来使用 EISPACK 的 RS、RG、CH 和 CG 例程。

用于特征值计算的最流行和最优秀的开源包是 LAPACK 和 EISPACK。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-17T20:41:02.613

对于大矩阵，您通常不需要所有特征值。你只希望前几个做（比如说）降维。

**规范算法是在 ARPACK 中实现的 Arnoldi-Lanczos 迭代算法：**

www.caam.rice.edu/software/ARPACK/

eigs中有一个matlab接口：

[http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/ref/eigs.html](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/ref/eigs.html)

```
eigs(A,k) and eigs(A,B,k) return the k largest magnitude eigenvalues. 
```

现在还有一个 R 接口：

[http://igraph.sourceforge.net/doc-0.5/R/arpack.html](http://igraph.sourceforge.net/doc-0.5/R/arpack.html)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-03T14:29:51.280

> 我认为如果矩阵稀疏会有帮助吗？

是的，有些算法在稀疏矩阵上表现良好。

参见例如：[http ://www.cise.ufl.edu/research/sparse/](http://www.cise.ufl.edu/research/sparse/)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-06T18:19:57.677

> 如果我有一个 1000x1000 矩阵，实际需要多长时间？

MATLAB（基于 LAPACK）在双核 1.83 GHz 机器上在大约 5 秒内计算 1000x1000 随机数的所有特征值。当矩阵是*对称*的时，计算可以明显更快地完成，并且只需要大约 1 秒。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-03T13:26:52.990

我会看一下[特征值算法](http://en.wikipedia.org/wiki/Eigenvalue_algorithm)，它链接到许多不同的方法。它们都有不同的特征，希望有一个适合您的目的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-04-29T09:04:37.270

您可以使用[CRAN](https://cran.r-project.org/web/packages/GuessCompx/index.html)`GuessCompx`的包来估计特征值计算的**经验复杂性**并预测完整的运行时间（尽管在您的示例中它仍然很小）。您需要一个小辅助函数，因为拟合过程仅对行进行子集化，因此您必须使矩阵为正方形：

 **```
library(GuessCompx)
m = matrix(rnorm(1e6), ncol=1000, nrow=1000)
# custom function  to subset the increasing-size matrix to a square one:
eigen. = function(m) eigen(as.matrix(m[, 1:nrow(m)]))
CompEst(m, eigen.)
#### $`TIME COMPLEXITY RESULTS`
#### $`TIME COMPLEXITY RESULTS`$best.model
#### [1] "CUBIC"
#### $`TIME COMPLEXITY RESULTS`$computation.time.on.full.dataset
#### [1] "5.23S"
#### $`TIME COMPLEXITY RESULTS`$p.value.model.significance
#### [1] 1.784406e-34 
```

您会得到**time 的三次复杂度**，以及R 基函数**的内存使用的 Nlog(N) 复杂度。**`eigen()`运行整个计算需要 5.2 秒和 37Mb。

[![在此处输入图像描述](https://i.stack.imgur.com/9HcEr.png)](https://i.stack.imgur.com/9HcEr.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-05-27T21:55:43.637

[Apache Mahout](http://mahout.apache.org/)是一个基于 map-reduce 的开源框架（即它适用于非常大的矩阵）。请注意，对于很多矩阵的东西，问题不是“什么是 big-o 运行时”，而是“它的可并行性如何？” Mahout[说](https://cwiki.apache.org/MAHOUT/dimensionalreduction.html)他们使用 Lanczos，它基本上可以在您愿意提供的任意数量的处理器上并行运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-30T07:21:55.783

它使用 QR 算法。参见 Wilkinson, JH (1965) 代数特征值问题。克拉伦登出版社，牛津。它不利用稀疏性。

# javascript - 将 js Array() 转换为 JSON 对象以用于 JQuery .ajax

> ID：713884
> 
> 赞同：30
> 
> 时间：2009-04-03T13:24:40.797
> 
> 标签：javascript, jquery, arrays, json

在我的应用程序中，我需要通过 ajax post 将 javascript Array 对象发送到 php 脚本。像这样的东西：

```
var saveData = Array();
saveData["a"] = 2;
saveData["c"] = 1;
alert(saveData);
$.ajax({
    type: "POST",
    url: "salvaPreventivo.php",
    data:saveData,
    async:true
    }); 
```

数组的索引是字符串而不是 int，因此像 saveData.join('&') 这样的东西不起作用。

想法？

提前致谢

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-04-03T13:26:19.950

如果它不是数组，请不要将其设为数组，将其设为对象：

```
var saveData = {};
saveData.a = 2;
saveData.c = 1;

// equivalent to...
var saveData = {a: 2, c: 1}

// equivalent to....
var saveData = {};
saveData['a'] = 2;
saveData['c'] = 1; 
```

以您使用 Arrays 的方式进行操作只是利用了 Javascript 对 Arrays 的处理，而不是真正的正确方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-08-10T20:59:17.690

如果已经定义了数组，您可以通过循环遍历数组的元素来创建一个 json 对象，然后您可以将其发布到服务器，但是如果您按照上述情况创建数组，只需创建一个 json 对象即可保罗·[贝甘蒂诺建议](https://stackoverflow.com/users/16417/paolo-bergantino)

```
 var saveData = Array();
    saveData["a"] = 2;
    saveData["c"] = 1;

    //creating a json object
    var jObject={};
    for(i in saveData)
    {
        jObject[i] = saveData[i];
    }

    //Stringify this object and send it to the server

    jObject= YAHOO.lang.JSON.stringify(jObject);
    $.ajax({
            type:'post',
           cache:false,
             url:"salvaPreventivo.php",
            data:{jObject:  jObject}
    });

    // reading the data at the server
    <?php
    $data = json_decode($_POST['jObject'], true);
    print_r($data);
    ?>

    //for jObject= YAHOO.lang.JSON.stringify(jObject); to work,
    //include the follwing files

    //<!-- Dependencies -->
    //<script src="http://yui.yahooapis.com/2.9.0/build/yahoo/yahoo-min.js"></script>

    //<!-- Source file -->
    //<script src="http://yui.yahooapis.com/2.9.0/build/json/json-min.js"></script> 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-03T13:38:41.153

您可以迭代 saveData 对象的键/值对以构建对数组，然后在结果数组上使用 join("&") ：

```
var a = [];
for (key in saveData) {
    a.push(key+"="+saveData[key]);
}
var serialized = a.join("&") // a=2&c=1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-10T08:14:31.310

数组对象和 JSON 对象实际上是有区别的。您可以执行以下操作，而不是创建数组对象并将其转换为 json 对象（使用 JSON.stringify(arr)）：

```
var sels = //Here is your array of SELECTs
var json = { };

for(var i = 0, l = sels.length; i < l; i++) {
  json[sels[i].id] = sels[i].value;
} 
```

无需将其转换为 JSON，因为它已经是一个 json 对象。查看相同的使用`json.toSource();`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-09T20:36:29.410

使用服务器上的数据时，您的字符可以通过添加斜杠来达到，例如如果 string = {"hello"} 为 string = {\ "hello \"} 来解决以下功能，以后可以使用 json decode .

```
<?php
function stripslashes_deep($value)
{
    $value = is_array($value) ?
                array_map('stripslashes_deep', $value) :
                stripslashes($value);

    return $value;
}

$array = $_POST['jObject'];
$array = stripslashes_deep($array);

$data = json_decode($array, true);
print_r($data);
?> 
```

# c++ - C++、OLE、Excel 自动化：EAccessviolation at 00000800

> ID：713887
> 
> 赞同：2
> 
> 时间：2009-04-03T13:25:03.340
> 
> 标签：c++, excel, exception, ole

我正在编写一个后台服务应用程序，它必须自动从 Excel 2003 文件中读取数据。但无论我尝试什么，方法 OlePropertyGet() 总是在尝试从地址“00000800”读取时导致 EAccessViolation 错误。

该错误总是发生在此代码片段的最后一行，并且似乎与方法接收的参数无关：

```
Variant excel, workbooks;

try
{
    excel = GetActiveOleObject("Excel.Application");
}
catch(...)
{
    excel = CreateOleObject("Excel.Application");
}

workbooks = excel.OlePropertyGet("Workbooks"); 
```

我对此进行了一些广泛的谷歌搜索，但没有发现任何有帮助的东西，只有[这个](http://topic.csdn.net/t/20040316/18/2850019.html "这个")论坛帖子有人有同样的问题，但没有提供有关原因或解决方案的任何信息（有一点有点好笑作者提到他知道原因，但没有说是什么！）。

我愿意接受有关导致此问题的原因以及如何解决此问题的任何想法，以及 Excel OLE 自动化的替代方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-04T13:57:59.747

我的猜测是它的空指针问题..

它看起来既不工作`GetActiveOleObject()`也不`CreateOleObject()`工作。

在调用之前尝试检查“excel”的有效性`OlePropertyGet`。

我想你应该确保你已经安装了 Excel。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T14:06:26.967

您可以使用 Visual Studio Tools for Office（请参阅[http://msdn.microsoft.com/en-us/library/d2tx7z6d.aspx](http://msdn.microsoft.com/en-us/library/d2tx7z6d.aspx)）。

或者您可以使用 ATL 支持来实例化 office 提供的对象模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-24T04:39:21.940

我使用这样的代码来确定创建对象的有效性（在 C++ Builder 中）：

```
Varaint excel = GetActiveOleObject("Excel.Application");
TAutoDriver<IDispatch> dispatcher;
dispatcher.Bind(excel, false);

if (dispatcher.IsBound())
{
    Variant workbooks = excel.OlePropertyGet("Workbooks");   
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-13T15:16:41.017

您的代码可能无法成功解析“Excel.Application”，从而导致出现空指针。它使用带有该字符串的注册表查找来识别 Excel。听起来您缺少该注册表项。

# javascript - 你最喜欢的 JavaScript/jQuery 代码编辑器是什么？

> ID：713889
> 
> 赞同：10
> 
> 时间：2009-04-03T13:25:10.483
> 
> 标签：javascript, jquery, editor

什么是最好和最强大的 AJAX（包括 jQuery）代码编辑器？

我可以为此使用 Visual Studio，但想知道非 MICROSOFT 的人使用什么来编写他们的 JavaScript、AJAX 和 jQuery 代码。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-03T13:29:10.147

我使用[记事本++](http://notepad-plus.sourceforge.net/)。免费、轻量级、Windows 友好且非常方便。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-03T13:31:46.083

[Netbeans IDE](http://www.netbeans.org)非常适合 javascript 编码，无论您最喜欢的 JS 库如何。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-03T13:39:48.763

这正在变成一个名人录，但我仍然相信[IntelliJ IDEA](http://www.jetbrains.com/idea/features/)是 javascript 支持的领导者之一。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-03T13:45:24.397

Aptana 在其 javascript 编辑器中内置了一个出色的 jquery 编辑器。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-03T13:30:06.137

在我看来，没有什么比一个好的 javascript 和 html 文本编辑器更好的了。我个人使用[UltraEdit](http://www.ultraedit.com/)。

任何 AJAX 开发人员都必须做的一件事是[FireBug](http://getfirebug.com/)和[IE Web Development Helper](http://projects.nikhilk.net/WebDevHelper/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-03T14:01:30.647

只有[TextMate](http://macromates.com/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-03T13:31:26.087

[带有JSEclipse](http://www.interaktonline.com/products/eclipse/jseclipse/overview/)的 Eclipse工作得非常好。

显然启用了[VIM插件！](http://vimplugin.org/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-03T13:30:24.123

蚀？如果只是因为我将它用于其他所有事情，并且在学习语言时代码建议很棒。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-03T13:33:18.577

我会通过说 Notepad++ 确实是一个非常方便的编辑器来支持 Pablo。一定要试一试:)（我喜欢 Ctrl+Enter 组合，非常聪明，虽然可以改进）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-03T13:44:14.337

记事本++和Editra

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-03T13:57:58.737

我将 Emacs 与 js2-mode 一起用于中小型 javascript 项目。

对于将数百个模块存储在不同文件中的 javascript 项目，没有什么比 IntelliJ Idea 更好的了。它解析项目中的所有文件，并允许您从函数调用跳转到函数定义，从覆盖的方法定义跳转到父类中的定义等。

我尝试过 Eclipse、Aptana、NetBeans、Komodo 等，但在 JavaScript 支持方面，它们甚至与 Intellij Idea 相差甚远。

另一方面，如此大的 javascript 项目很少见，通常 emacs 或任何其他编辑器就足够了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-03T14:02:31.440

我是一名 .Net 开发人员，但我一直在使用[RubyMine](http://www.jetbrains.com/ruby/index.html)测试版来编辑所有 JavaScript。我不确定它是否具有与 IntelliJ（推荐的其他 JetBrains 产品）相同的功能，但 RubyMine 为 JavaScript 提供了类似的重构功能，ReSharper 为 C# 提供了类似的重构功能。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-03T14:16:34.650

GVim。'%'、'.' 和 ':%s' 是你的朋友。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-04T19:48:56.077

如果您想放弃更改（谁来做？），Dreamweaver 还支持预先输入功能：

[Dreamweaver 的 jQuery API 扩展](http://xtnd.us/dreamweaver/jquery)

我想说还有另一个支持预先输入的编辑器（可能不是智能感知，而是某些东西）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-04T19:53:37.593

Visual Studio（我几乎将它用于所有事情）并且它具有 jQuery 的智能感知功能！坚持下去

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-03-17T13:50:57.770

最好的免费 javascript 编辑器[http://www.yaldex.com](http://www.yaldex.com)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-07-20T12:46:25.257

没有人提到**[PSPad](http://www.pspad.com/en/)**吗？

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-01-17T22:28:14.630

绝对是 NetBeans。最强大的 PHP IDE，支持 jQuery、CSS 和标记（html、xhtml、html5）等等！免费和开源，拥有庞大的社区。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-02-19T09:23:22.127

如果您是资源管理器，Notepad++ 是最好的

1.  插件 > 插件管理器 > 显示插件管理器
2.  在这些插件中，使用 NPPExec 插件在信号编辑器中使用所有编译器 java、objective c、c、c++ 等等。
3.  FTP、Light Explorer、Explorer 插件

# url - SSL 安全网站最佳实践

> ID：713893
> 
> 赞同：11
> 
> 时间：2009-04-03T13:26:10.090
> 
> 标签：url, redirect, https

我有一个受 SSL 证书保护的网站 (www.mydomain.com)。这是一个 ASP.NET 网站，我通过代码强制要求某些页面使用 https:// 前缀。如果他们不这样做，它会将他们重定向到 https:// 等价物。这是一个好习惯吗？有没有更简单的方法来做到这一点？并非每个页面都需要 SSL。

此外，当用户以 mydomain.com 而不是 www.mydomain.com 的形式使用我的 URL 时，他们会收到证书错误，因为证书是为 www.mydomain.com 注册的。我应该使用与上面提到的 http:// 和 https:// 问题相同的方法吗？或者有没有更好的方法来处理这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T13:34:53.317

你的方法听起来不错。在我当前的项目中，当用户进入我的登录页面时，我强制使用 HTTPS（基于一个配置标志，它允许我在本地进行测试而无需处理需要证书）。这使我可以访问其他不安全的页面，这很方便。

我有几个地方，我们的服务器会抓取其他页面的输出（例如，将 html 渲染为 PDF 并获取动态图像）。由于我们的环境，我们的服务器无法解析它的公共名称，所以如果我们要在站点上强制使用 ssl，我们必须添加我们的内部 IP 地址（或伪造域名）。

至于您的第二个问题，您有两种选择来处理 www.example.com 与 example.com。您可以购买允许您拥有多个域名的证书。这些被称为 UCC 证书。

您的第二个选择是将 example.com 重定向到 www.example.com 或相反。如果希望您的内容被谷歌或​​其他搜索引擎索引，重定向是一个很好的选择。因为他们会将 www.example.com 和 example.com 视为两个单独的站点。这意味着指向您网站的链接将被拆分，从而降低您的整体页面排名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T13:35:42.363

您可以将 IIS 中的站点配置为需要证书，但这会 A）如果有人没有使用 https 访问，则会生成错误，并且 B）要求所有页面都使用 https。所以，*那是*行不通的。您可以在 IIS 上放置一个过滤器，检查所有请求并将它们重定向为 https 调用（如果它们在您的加密列表中）。这里明显的缺点是每次添加新页面（例如从 XML 文件或数据库）时都需要更新页面列表并重新启动过滤器。

我认为您在需要 https 的页面中构建代码可能是正确的，如果它们通过 http 到达，则会重定向到 https 版本。就您的证书错误而言，您可以使用完整路径（包括 www）而不是相对路径重定向来解决此问题。如果您对如何检测调用是否使用 https 或如何获取当前请求的完整路径有任何疑问，请告诉我。两者都非常简单，但如果您需要，我有示例代码。

**更新**- Josh，处理多个子域的证书称为通配符证书。问题是它们比标准证书贵很多。

**更新 2**：要考虑的另一件事是对需要 SSL 的页面使用母版页或派生类。这样，您不必在每个页面中复制代码，只需将其声明为 SSLPage 类型（或使用相应的母版页）并让 Master/Parent 类处理重定向。同样，如果您采用这种方法，您将需要进行一些 URL 处理，但这非常简单。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-04-17T13:31:56.687

以下内容可以帮助您：

*   如果可以使用 https:// 显示所有网站页面，那么您只需更新代码以使用 https:// 并在 IIS 中设置两个绑定。一个用于http，另一个用于https。这样，您的网站可以通过任何协议访问。
*   您的访问者收到名称不匹配错误，因为您的 SSL 证书中使用的通用名称是 www.mydomain.com。Namecheap 提供 RapidSSL 证书，您可以通过它在单个 SSL 下保护两个名称。您可以为 www.mydomain.com 购买此 SSL，它会自动保护 mydomain.com（即没有 www）。

另一种选择是您可以编写代码将访问者重定向到 www.mydomain.com 网站，即使他们浏览 mydomain.com。

# wpf - 设置单元格颜色时出现 Wpf Datagrid 虚拟化问题

> ID：713912
> 
> 赞同：1
> 
> 时间：2009-04-03T13:31:20.673
> 
> 标签：wpf, datagrid, virtualization, toolkit

我正在使用 wpf 工具包数据网格，并且有一列填充有切换按钮。如果选择了切换按钮并且鼠标悬停，则使用以下样式更改背景颜色。不幸的是，如果我启用了虚拟化，当我在一个单元格中选择一个切换按钮并在网格中向下滚动时，我会发现其他单元格的背景也发生了变化。我认为这是我滚动时虚拟化如何重用单元的一个错误。有什么建议可以解决这个问题并仍然使用虚拟化吗？

```
 <Style TargetType="{x:Type ToggleButton}">
                <Setter Property="Control.Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type ToggleButton}">
                                <TextBlock x:Name="Tb" Tag="{TemplateBinding Property=Tag}" Padding="{TemplateBinding Property=Padding}" Text="{TemplateBinding Property=Content}" >
                                </TextBlock>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Tb" Property="Background" Value="{StaticResource HoverRed}" />
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="Tb" Property="Background" Value="{StaticResource SelectYellow}" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-03T20:07:07.383

通过绑定样式所针对的切换按钮的 IsChecked 属性，我已经能够解决这个问题。这使我可以打开虚拟化并保持每个单元格中模板切换按钮的背景颜色与其应有的颜色正确同步。

```
 <ToggleButton Tag="button" IsChecked="{Binding Path=Selected,Mode=TwoWay}" FocusVisualStyle="{x:Null}" Content="{Binding Path=MarkerName,Mode=OneWay}">
                </ToggleButton> 
```

# asp.net - 如何在页面后面的代码中创建文件夹

> ID：713914
> 
> 赞同：0
> 
> 时间：2009-04-03T13:31:42.653
> 
> 标签：asp.net, directory

这是参考昨天的问题[“如何在 ASP.NET 中在代码后面创建文件夹”](https://stackoverflow.com/questions/710123/how-do-i-create-folders-in-asp-net-in-code-behind)。问题是我想在运行时创建动态文件夹。文件夹名称将通过 TextBox 输入，输出将显示在 TreeView 中。如果我在 textbox1 中输入第一个文件夹名称并单击“添加文件夹”按钮，该表单将提交。当我提交多个同名文件夹时，输出应该是名称的索引增量（例如，FooFolder、FooFolder(2)、FooFolder(3) 等）。有两个事件：添加文件夹事件和删除文件夹事件。如果我选择一个特定的子文件夹并单击“删除文件夹”按钮，该文件夹将被删除。为了添加文件夹，我编写了以下代码：

```
TreeNode tnode = new TreeNode();
if (TreeView1.Nodes.Count > 0)
        {
            int found = 0;
            for (int i = 0; i < TreeView1.Nodes.Count; i++)
            {
                if (TreeView1.Nodes[i].Text == TextBox1.Text)
                    found += 1+i;
            }
            if (found > 0)
            {
                tnode.Text = TextBox1.Text + found.ToString();
            }
            else
            {
                tnode.Text = TextBox1.Text;
            }
        }
        else
        {
            tnode.Text = TextBox1.Text;
        }
        TreeView1.Nodes.Add(tnode);
} 
```

在我的代码中， ChildNode 索引没有增加；它始终为 1，如下所示：

```
Sumit
Sumit(1)
Sumit(1)
Sumit(1)
Amit
Amit(5)
Amit(5)
Amit(5) 
```

在树视图中，我设置了`ImageSet="XPFileExplorer"`. 所以输出应该是这样的：

```
-Root
        -Sumit(Parent1)
                  NewFolder
                  NewFolder(2)
                  NewFolder(3)
                  NewFolder(4)
                  NewFolder(5)
         -Amit(Parent2)
                  FooFolder
                  FooFolder(2)
                  FooFolder(3)
                  FooFolder(4)
                  FooFolder(5) 
```

如果我删除任何子文件夹，比如 Newfolder(3) 和 Newfolder(4)，并在同一个 Sumit(Parent1) 下创建这些相同的文件夹，则索引应该是 Newfolder(3)，Newfolder(4)。如果我在 Sumit 下再创建一个同名的 NewFolder，那么索引应该是 NewFolder(6)。

有人可以修改我的代码以获得所需的输出吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T13:47:37.013

您的问题是您的算法来检测该项目是否存在。基本上你的代码：

```
for (int i = 0; i < TreeView1.Nodes.Count; i++)            
{                
    if (TreeView1.Nodes[i].Text == TextBox1.Text)
                    found += 1+i;            
}
if (found > 0)            
{                
   tnode.Text = TextBox1.Text + found.ToString();      
}            
else            
{                
   tnode.Text = TextBox1.Text;            
} 
```

让我们来看看这个。用户提交 NewFolder，您的代码通过并没有找到任何名为 NewFolder 的节点，因此它将节点设置为 NewFolder。

现在用户再次为 NewFolder 单击添加，这次它找到了 NewFolder，因此新名称变为 NewFolder1。

现在用户再次为 NewFolder 单击添加，这次它找到了 NewFolder，因此新名称变为 NewFolder1。

如果 TreeView1.Nodes[i].Text == TextBox1.Text 进行比较，则只有一个节点将具有此名称。您需要去掉名称的数字部分。

如果您使用像 NewFolder(1) 这样的命名约定，那么您可以轻松地做到这一点。但是根据您那里的代码，节点的名称将是 NewFolder1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-03T13:46:55.893

在你这样做之前，我学到了一个艰难的方法，你不应该在正在运行的应用程序下创建/删除文件夹，否则你会导致你的应用程序池被回收。因此，请确保您在服务器上的其他位置创建目录。（希望你有那个权限）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T13:50:17.367

您的文本比较已关闭。由于您可能已将数字添加到同一父节点下的先前节点，因此您只会遇到一次新名称。

它应该看起来像：

```
if (TreeView1.Nodes[i].Text.StartsWith(TextBox1.Text))
    found++ 
```

# sql - 在垂直排序的单独列中返回 sql 查询结果

> ID：713917
> 
> 赞同：0
> 
> 时间：2009-04-03T13:31:49.563
> 
> 标签：sql, sql-server, tsql

如何重写查询“ **select col1 from tbl1** ”，以便将结果分成三列 - 每列对结果进行垂直排序？

因此，如果我要返回的数据是：

```
aaa
bbb
ccc
ddd
eee
fff
ggg 
```

我需要查询将其返回为：

```
aaa  ddd  ggg
bbb  eee
ccc  fff 
```

这可能吗？谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-03T13:36:35.543

事实上，这不应该在 SQL 中完成。除非 aaa、ddd 和 ggg 的配对有意义，否则这是客户端格式，不应在服务器上完成。

编辑：

为了智力锻炼，这样的事情似乎奏效了。

```
select
    f1.data, f2.data, f3\. data

from (select data, ROW_NUMBER() over (order by data) as row_num from your_table) f1

left join (select data, ROW_NUMBER() over (order by data) as row_num from your_table) f2 on f2.row_num = f1.row_num + (select CEILING(COUNT(1) / 3) + 1 from your_table)
left join (select data, ROW_NUMBER() over (order by data) as row_num from your_table) f3 on f3.row_num = f1.row_num + (select CEILING(COUNT(1) / 3) + 1 from your_table) * 2

where f1.row_num between 1 and FLOOR((select COUNT(1) from your_table) / 3) + 1 
```

但是，我再次怀疑这确实应该在客户端完成，而不是在 SQL 中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T13:36:59.660

这似乎是您应该在应用程序的前端处理的事情。除非有特定原因说明您为什么不能这样做，否则我建议您在那里处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T13:47:39.917

如果只是为了格式化，那么亚当是正确的，你应该在客户端做。

如果它与数据相关（我假设 aaa 和 bbb 不是您的实际数据），那么您可以考虑使用 SQL 数据透视表来重新排序数据。

[这是一个例子](http://blog.sqlauthority.com/2008/06/07/sql-server-pivot-and-unpivot-table-examples/)

# iphone - 在Objective-C中替换字符串中的多个字符？

> ID：713918
> 
> 赞同：48
> 
> 时间：2009-04-03T13:32:33.837
> 
> 标签：iphone, objective-c, string, replace

在 PHP 中，我可以这样做：

```
$new = str_replace(array('/', ':', '.'), '', $new); 
```

...替换字符 / : 的所有实例。带有空白字符串（删除它们）

我可以在 Objective-C 中轻松做到这一点吗？还是我必须自己动手？

目前我正在多次调用`stringByReplacingOccurrencesOfString`：

```
strNew = [strNew stringByReplacingOccurrencesOfString:@"/" withString:@""];
strNew = [strNew stringByReplacingOccurrencesOfString:@":" withString:@""];
strNew = [strNew stringByReplacingOccurrencesOfString:@"." withString:@""]; 
```

谢谢，
马特

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-04-03T13:55:09.397

这样做的一种效率较低的方法：

```
NSString *s = @"foo/bar:baz.foo";
NSCharacterSet *doNotWant = [NSCharacterSet characterSetWithCharactersInString:@"/:."];
s = [[s componentsSeparatedByCharactersInSet: doNotWant] componentsJoinedByString: @""];
NSLog(@"%@", s); // => foobarbazfoo 
```

看看，`NSScanner`如果`-[NSString rangeOfCharacterFromSet: ...]`你想更有效地做到这一点。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-06-02T14:01:12.370

在某些情况下，您的方法足够好我认为马特..顺便说一句，我认为最好使用

```
[strNew setString: [strNew stringByReplacingOccurrencesOfString:@":" withString:@""]]; 
```

而不是

```
strNew = [strNew stringByReplacingOccurrencesOfString:@"/" withString:@""]; 
```

因为我认为您正在用 NSString 覆盖 NSMutableString 指针，这可能会导致内存泄漏。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-09-06T22:15:05.027

最近不得不这样做，并想分享一个有效的方法：

（假设 someText 是一个 NSString 或 text 属性）

```
NSString* someText = @"1232342jfahadfskdasfkjvas12!"; 
```

（此示例将从字符串中删除数字）

```
[someText stringByReplacingOccurrencesOfString:@"[^0-9]" withString:@"" options:NSRegularExpressionSearch range:NSMakeRange(0, [someText length])]; 
```

请记住，您需要使用 Obj-c 转义字符来转义正则表达式文字字符：

（obj-c 使用双反斜杠来转义特殊的正则表达式文字）

```
...stringByReplacingOccurrencesOfString:@"[\\\!\\.:\\/]" 
```

有趣的是 NSRegularExpressionSearch 选项很少使用，但可以带来一些非常强大的控件：

[您可以在此处](http://www.raywenderlich.com/30288/nsregularexpression-tutorial-and-cheat-sheet)找到一个不错的 iOS 正则表达式教程，并在[regex101.com](http://regex101.com)上找到更多关于正则表达式的信息

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-01-22T16:34:48.710

基本上与上面发布的 Nicholas 相同，但是如果您想删除除一组字符之外的所有内容（假设您想删除不在集合“ABCabc123”中的所有内容），那么您可以执行以下操作：

```
NSString *s = @"A567B$%C^.123456abcdefg";
NSCharacterSet *doNotWant = [[NSCharacterSet characterSetWithCharactersInString:@"ABCabc123"] invertedSet];
s = [[s componentsSeparatedByCharactersInSet: doNotWant] componentsJoinedByString: @""];
NSLog(@"%@", s); // => ABC123abc 
```

如果您只想要字母数字，则可用于去除符号等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-01T13:03:23.090

```
+ (NSString*) decodeHtmlUnicodeCharactersToString:(NSString*)str
{
    NSMutableString* string = [[NSMutableString alloc] initWithString:str];  // #&39; replace with '
    NSString* unicodeStr = nil;
    NSString* replaceStr = nil;
    int counter = -1;

    for(int i = 0; i < [string length]; ++i)
    {
        unichar char1 = [string characterAtIndex:i]; 
        for (int k = i + 1; k < [string length] - 1; ++k)
        {
            unichar char2 = [string characterAtIndex:k]; 

            if (char1 == '&'  && char2 == '#' ) 
            { 
                ++counter;
                unicodeStr = [string substringWithRange:NSMakeRange(i + 2 , 2)]; // read integer value i.e, 39
                replaceStr = [string substringWithRange:NSMakeRange (i, 5)];  // #&39;
                [string replaceCharactersInRange: [string rangeOfString:replaceStr] withString:[NSString stringWithFormat:@"%c",[unicodeStr intValue]]];
                break;
            }
        }
    }

    [string autorelease];

    if (counter > 1)
        return [self decodeHtmlUnicodeCharactersToString:string]; 
    else
        return string;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-18T21:39:17.603

如果您要删除的字符彼此相邻，您可以使用

```
stringByReplacingCharactersInRange:(NSRange) withString:(NSString *) 
```

除此之外，我认为多次使用相同的功能并没有那么糟糕。它比创建一个以更通用的方式执行相同操作的大方法更具可读性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-11-10T15:36:48.110

这是 Swift 3 中使用替换出现的正则表达式选项的示例。

将**replaceOccurrences 与 String.CompareOptions.regularExpression****选项**一起使用。

 **示例（斯威夫特 3）：

```
var x = "<Hello, [play^ground+]>"
let y = x.replacingOccurrences(of: "[\\[\\]^+<>]", with: "7", options: .regularExpression, range: nil)
print(y) 
```

输出：

```
7Hello, 7play7ground777 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-11-18T13:41:24.843

在字符串上创建扩展...

```
extension String {

   func replacingOccurrences(of strings:[String], with replacement:String) -> String {
      var newString = self
      for string in strings {
          newString = newString.replacingOccurrences(of: string, with: replacement)
      }
      return newString
   }

} 
```

像这样称呼它：

```
aString = aString.replacingOccurrences(of:['/', ':', '.'], with:"") 
```

# firefox - 可在 XML/复合文档中的节点上编辑内容？

> ID：713919
> 
> 赞同：0
> 
> 时间：2009-04-03T13:32:34.180
> 
> 标签：firefox, browser, webkit, contenteditable

我有一个在 Web 浏览器中显示的 XML 文档，并附有样式表：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<?xml-stylesheet type="text/css" href="abc.css"?>
<myxml xmlns:xhtml="http://www.w3.org/1999/xhtml">
    <para>I wish i was editable</para>
    <xhtml:script type="text/javascript" src="abc.js"/>
</myxml> 
```

使用 xhtml 命名空间声明和 xhtml:script 标签，我可以执行 javascript。

我想做的是使此文档内容中的任意非 XHTML 元素可编辑。（实际上，它们将在另一个命名空间中）

即使我明确添加了@contentEditable="true"（即不使用Javascript），内容实际上也不是可编辑的（在Firefox 3.0.4 中）。

是否可以在任何当前浏览器中编辑它？（在 XHTML 1.0 过渡文档中，我对`<div contentEditable="true"`>Edit me >没有任何问题）`</div`

我什至无法在此文档中编辑 xhtml:div（在 Firefox 中）；如果我能做到这一点，那可能会提供一条前进的道路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-06T22:46:21.063

在 Firefox 3 中，@content-editable="true" 仅在内容类型为 text/html 时才使相关元素可编辑（如果本地文件名以 .html 结尾也会发生这种情况）

它不适用于内容类型 app/xhtml+xml 或 text/xml（以 .xhtml 或 .xml 结尾的本地文件名）

我为此记录了一个增强功能：[https ://bugzilla.mozilla.org/show_bug.cgi?id=486931](https://bugzilla.mozilla.org/show_bug.cgi?id=486931)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-04T03:01:08.010

如果我使用这个 doctype，contentEditable 可以在 html/xhtml 以外的元素上工作（在 Firefox 和 Chrome 中测试）：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                      "http://www.w3.org/TR/html4/loose.dtd"> 
```

和 .html 文件扩展名（而不是 .xml）。

我根本不需要包含任何html 元素（例如head、body、div、p）。

虽然没有应用 css（如果我的 xml 在命名空间中，我想这是有道理的，给定 doctype！）。

不是一个优雅的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-15T06:13:04.370

Firefox 是少数严格执行 XHTML 规范的浏览器之一。因此，要使元素可编辑，您必须将`contenteditable`属性指定为`true`. 请注意，整个属性名称是小写的。在您的示例中，可编辑的第一个“E”大写。

应该提到的另一个怪癖是 IE(6,7,8) 的行为正好相反。要使元素在 IE 中可编辑，您**必须**`contentEditable="true"`准确添加。无论出于何种原因，`contenteditable="true"`（以及任何其他大小写变化）都不起作用。

# asp.net - 如果在回发期间完成，ASP.Net 链接不会禁用

> ID：713923
> 
> 赞同：0
> 
> 时间：2009-04-03T13:33:28.343
> 
> 标签：asp.net, postback, hyperlink

我对 ASP.Net 还是很陌生，所以如果这是一个愚蠢的问题，请原谅我。

在页面加载时，我会显示一个进度表，之后我会进行回发以处理页面的实际加载。在回发期间，根据某些标准，我禁用了页面上的某些链接。但是，链接不会禁用。我注意到，如果我强制链接在第一次（通过调试）中禁用，链接禁用就好了。但是，我当时没有我需要的数据来做出禁用的决定。

**代码背后**

```
If (Not IsCallback) Then
    pnlLoading.Visible = True
    pnlQuote1.Visible = False
Else
    pnlLoading.Visible = False
    pnlQuote1.Visible = True
    <Load data from DB and web service>
    <Build page>
    If (<Some Criteria>) Then
        somelink.Disable = True
    End If
End If 
```

**JavaScript**

```
if (document.getElementById('pnlQuote1') === null) {
    ob_post.post(null, 'PerformRating', ratingResult);
} 
```

ob_post.post 是一个 obout js 函数，它执行正常的回发，然后调用由第二个参数命名的服务器方法。然后调用由第三个参数命名的 JavaScript 方法。第一个参数是要发回的页面。一个值为 null 的帖子返回到当前页面。

回邮工作正常。所有方法都以正确的顺序调用。给我带来麻烦的代码在粗体后面的代码下。（somelink.disabled = True 实际上并没有禁用链接）同样，如果我第一次调试并强制禁用链接，它会禁用。有谁知道我可以做些什么来解决这个问题？

谢谢，GRB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-03T13:38:52.307

您的代码示例使用 IsCallBack 检查，而问题文本谈论 IsPostback 检查。我会验证您是否在代码中使用 Page.IsPostBack 来关闭链接。

# php - MySQL - 在返回结果之前通过 PHP 函数传递数据库字段

> ID：713928
> 
> 赞同：0
> 
> 时间：2009-04-03T13:34:47.857
> 
> 标签：php, function, mysqli, prepared-statement

以下来自[http://php.morva.net/manual/en/mysqli-stmt.bind-result.php](http://php.morva.net/manual/en/mysqli-stmt.bind-result.php)的代码显示了正在准备和执行的 mysqli 查询。while ($stmt->fetch()) 循环看起来像是在生成结果资源。我可以更改它以包含对函数的调用，例如

```
while ($stmt->fetch()) {
       foreach($row as $key => $val)
       {
           $c[$key] = performFunction($val);
       }
       $result[] = $c;
   } 
```

然后我会返回（$result）而不是 print_r（$result）。这样我就可以动态改变 $val
的值 原始代码 =

```
if ($stmt = $mysqli->prepare("SELECT * FROM sample WHERE t2 LIKE ?")) {
   $tt2 = '%';
     $stmt->bind_param("s", $tt2);
   $stmt->execute();

   $meta = $stmt->result_metadata();
   while ($field = $meta->fetch_field())
   {
       $params[] = &$row[$field->name];
   }

   call_user_func_array(array($stmt, 'bind_result'), $params);

   while ($stmt->fetch()) {
       foreach($row as $key => $val)
       {
           $c[$key] = $val;
       }
       $result[] = $c;
   }
     $stmt->close();
}
$mysqli->close();
print_r($result); 
```

这行得通吗，我还能怎么做？
谢谢大家...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T19:07:09.443

您可以使用 UDF（用户定义函数）来处理 MySQL 端的数据，然后再将其返回 PHP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T13:47:26.903

这是一个完全有效的方法，尽管我怀疑您的示例实现代码不太适用。您最好获取一个 mysqli_result 对象，在其上调用[fetch_assoc](http://us.php.net/manual/en/mysqli-result.fetch-assoc.php)，然后将生成的关联数组推送到您的结果集中，而不是自己制作关联数组。

# c# - 如何在 C# Regex 中匹配“参数名称：值”？

> ID：713931
> 
> 赞同：0
> 
> 时间：2009-04-03T13:34:55.313
> 
> 标签：c#, regex

我想匹配这些行：

```
ParameterINeed: 758
ParameterCount: 8695
ParameterText: 56 
```

我会收到一个参数名称和参数值。您能否告诉我如何为此编写 Regex.Matches 模式以及如何将这些数据处理成字典？

我使用这段代码：

```
string Text = "ParameterINeed: 758\r\nParameterCount: 8695\r\nParameterText: 56";
string Pattern = "^(\\w+):\\s+(\\d+)$";
MatchCollection ma = Regex.Matches(Text, Pattern, RegexOptions.Singleline); 
```

并得到 ma.Count = 0

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-03T13:37:43.747

试试这个正则表达式

```
"^Parameter(\w+):\s+(\d+)$" 
```

然后，您可以通过 Matches[1] 访问名称，并将值作为 Matches[2]。我的回答是基于你想要的字符串 ParameterINeed: 42

*   名称：需要
*   价值：42

相反，如果您想要 ParameterINeed 作为值，您可以从正则表达式中删除 Parameter 字。

```
"^(\w+):\s+(\d+)$" 
```

**编辑**响应添加的代码示例

请尝试以下示例

```
string Text = "ParameterINeed: 758\r\nParameterCount: 8695\r\nParameterText: 56";
string[] lines = Text.Split("\n");
string Pattern = @"^(\w+):\s+(\\d+)$";
foreach ( string line in lines ) {
  MatchCollection ma = Regex.Matches(line, Pattern, RegexOptions.Singleline);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-03T14:22:42.217

`RegexOptions.SingleLine`唯一会影响句点标记的工作方式，而不影响 ^ 和 $ 标记的工作方式。你需要使用`RegexOptions.MultiLine`它。

多行模式不理解 \r\n 换行符，它只将 \n 字符视为换行符。您必须使用 \r 字符才能到达换行符。

```
string text = "ParameterINeed: 758\r\nParameterCount: 8695\r\nParameterText: 56";
string pattern = @"^(\w+):\s+(\d+)\r?$";
MatchCollection ma = Regex.Matches(text, pattern, RegexOptions.Multiline); 
```

现在`ma.Count`是3。

这是您将匹配项放入字典中的方式：

```
Dictionary<string, int> values = new Dictionary<string, int>();
foreach (Match match in ma) {
    values.Add(match.Groups[1].Value, int.Parse(match.Groups[2].Value));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T14:21:55.310

这是一个经过测试的解决方案。;)

```
static void Main(string[] args)
{
    try
    {

        string sInput;

        // The string to search.
        sInput = "ParameterINeed: 758\r\nParameterCount: 8695\r\nParameterText: 56";

        var regex = new Regex(@"(?<parameter>\w+):\s+(?<value>\d+)");
        var dictionary = new Dictionary<string, string>();

        foreach (Match match in regex.Matches(sInput))
        {
            dictionary.Add(
            match.Groups["parameter"].Value, 
            match.Groups["value"].Value); 
        }

        foreach (KeyValuePair<string, string> item in dictionary)
            Console.WriteLine("key: {0}; value:{1}", item.Key, item.Value);

    }
    finally
    {
        Console.ReadKey();
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T13:37:54.337

你为什么不简单地按行分割，然后用'：'来分割文本并修剪结果？还是更复杂的问题？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T14:20:37.277

没有使用过 C#，我无法给出直接的代码示例。

如果它遵循正常的正则表达式模式，问题可能是 ^/$.. 通常匹配字符串开头 (^) 和字符串结尾 ($) 不一定是“行尾”。

如果你尝试类似（用 perl 测试）：

`/(\w+):\s(\w+)(?:\r\n)?/g`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-03T13:37:24.980

取决于其他一些约束，但你可以使用它。

```
var regex = new Regex(@"^($<parameter>\w+):\s($<value>\d+)$");
var dictionary = new Dictionary<string, string>();

foreach(var match in regex.Matches(inputData, RegexOptions.Multiline))
{
  dictionary.Add(
    match.Groups["parameter"].Value, 
    match.Groups["value"].Value);
} 
```

# php - 如何使用服务器端脚本生成网页的屏幕截图？

> ID：713938
> 
> 赞同：19
> 
> 时间：2009-04-03T13:35:52.113
> 
> 标签：php, python, screenshot, server-side-scripting

我需要一个服务器端脚本（PHP、Python）来将网页捕获为 PNG、JPG、Tiff、GIF 图像并将它们调整为缩略图。

实现这一目标的最佳方法是什么？

### 也可以看看：

> *   [使用 PHP 的网页截图？](https://stackoverflow.com/questions/686858/web-page-screenshots-with-php)
> *   [如何使用 PHP 和 GD 截取网站的屏幕截图？](https://stackoverflow.com/questions/627301/how-can-i-take-a-screenshot-of-a-website-with-php-and-gd)
> *   [如何使用 PHP 获取网页的快照或缩略图？](https://stackoverflow.com/questions/443837)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-03T13:46:41.150

您可能可以编写类似于[webkit2png](http://www.paulhammond.org/webkit2png/)的内容，除非您的服务器已经运行 Mac OS X。

**更新：**我刚刚看到了它的 Linux 等价物的链接：[khtml2png](http://khtml2png.sourceforge.net/)

也可以看看：

*   [使用 Python 和 QtWebKit 创建网页的屏幕截图](http://www.blogs.uni-osnabrueck.de/rotapken/2008/12/03/create-screenshots-of-a-web-page-using-python-and-qtwebkit/)
*   [使用嵌入式 Mozilla 自动截取网页截图](http://www.hackdiary.com/2004/06/13/taking-automated-webpage-screenshots-with-embedded-mozilla/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T13:39:42.057

需要做的是让程序呈现页面，然后拍摄页面的图像。这是一个非常缓慢和繁重的过程，但[可以在 Windows 上的 PHP 中完成。](http://is.php.net/manual/en/function.imagegrabscreen.php)

还要检查文档文章中的评论。

对于 python [，我建议阅读这篇文章](http://www.blogs.uni-osnabrueck.de/rotapken/2008/12/03/create-screenshots-of-a-web-page-using-python-and-qtwebkit/)。它强调了一些解决方案。

您还可以调用一些服务（通过一些 API），它们会返回一个图像。但通常它们会花费（例如[WebShots ）](http://webshotspro.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-03T13:41:55.967

您需要：

*   阅读网页及其所有多媒体内容（图像、flash 等）
*   利用浏览器渲染引擎来渲染网页
*   截取屏幕截图并将其保存为图像

第一步和第三步很容易，第二步更具挑战性；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-02T00:10:04.357

如果您使用的是 php，则可以使用 imagegrabscreen (PHP 5 >= 5.2.2)。Imagegrabscreen：捕获整个屏幕。

# jquery - 在 UL 中“自动换行”一个 LI

> ID：713955
> 
> 赞同：1
> 
> 时间：2009-04-03T13:40:30.463
> 
> 标签：jquery, html, css

我想将一些文本包装到我在 LI 中保存的下一行 - 包装需要动态完成，所以我正在寻找 CSS

我希望它看起来像这样：

```
<ul>
    <li> normal sized </li>
    <li> big massive long one that i'd like to wrap to the next line like below </li>
    <li> the result that
            i'd like to see </li>
</ul> 
```

我不想要任何滚动条，也不希望它离开页面，并且在 CSS 中设置 UL 或 LI 的宽度似乎并不适合我。有任何想法吗？我确定它是我想念的微不足道的东西

谢谢

**编辑：**我已经尝试了这些解决方案，但没有任何运气 - 就其本身而言，它们工作正常。所以我必须得出结论，问题出在我正在使用的 jQuery 代码中。（使用名为 jqueryFileTree 的插件）。该代码提取了一个文件名，因此可能存在断行问题

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-03T13:46:23.960

`ul`设置元素的宽度应该可以解决问题。我用你的基本示例进行了尝试，它适用于 FF3、IE 5.5-8。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
        <title>test</title>
        <style type="text/css" media="screen">
            ul {
                width: 80px;
            }
        </style>
    </head>
    <body>
        <ul>
            <li> normal sized </li>
            <li> big massive long one that i'd like to wrap to the next line like below </li>
            <li> the result that i'd like to see </li>
        </ul>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T13:46:37.763

当文本到达视口（浏览器中的“查看区域”）的末端或指定宽度的元素末端时，文本将自行包装，根本不应用任何 CSS。这适用于所有元素，只要它们最初不是绝对定位在视口之外。

我必须说我想知道您实际上是如何使文本超出 UL/LI 的视口或宽度的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T13:49:34.840

你如何设置元素的宽度？

以下将不起作用：

```
<ul width="100">
    <li>Normal Sized</li>
    <li>Big massive long one that I'd like to wrap to the next line</li>
    <li>The result I'd like to see</li>
</ul> 
```

您需要在 CSS 或标签的 style 属性中设置宽度：

```
<ul style="width: 100px;">
    <li>Normal Sized</li>
    <li>Big massive long one that I'd like to wrap to the next line</li>
    <li>The result I'd like to see</li>
</ul> 
```

或者您可以创建一个 css 类，而不是为页面上的每个 ul 设置宽度：

```
<style type="text/css" media="screen">
    .smallList {
        width: 100px;
    }
</style>

<ul class="smallList">
    <li>Normal Sized</li>
    <li>Big massive long one that I'd like to wrap to the next line</li>
    <li>The result I'd like to see</li>
</ul> 
```

# asp.net - Asp.Net 文本框拼写检查控件

> ID：713958
> 
> 赞同：1
> 
> 时间：2009-04-03T13:41:42.050
> 
> 标签：asp.net, textbox, controls, spell-checking

有谁知道 Asp.Net 文本框是否存在任何拼写检查器控件？我需要一个控件来检查用户当前正在编辑的文本框并提示他们拼写错误。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T13:49:15.653

Telerik 做一个很好的例子：

[http://www.telerik.com/products/aspnet-ajax/spell.aspx](http://www.telerik.com/products/aspnet-ajax/spell.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T13:48:03.563

在 codeplex 上有一个 Checkspelling 项目可能会有所帮助？

[http://www.codeproject.com/KB/aspnet/checkspelling.aspx](http://www.codeproject.com/KB/aspnet/checkspelling.aspx)

# sql - 如何在 SQL Server 2005 中删除列的 IDENTITY 属性

> ID：713960
> 
> 赞同：10
> 
> 时间：2009-04-03T13:42:20.397
> 
> 标签：sql, sql-server-2005, tsql

我希望能够将具有标识列的表中的数据插入 SQL Server 2005 中的临时表中。

TSQL 看起来像：

```
-- Create empty temp table
SELECT *
INTO #Tmp_MyTable
FROM MyTable
WHERE 1=0
...
WHILE ...
BEGIN
    ...
    INSERT INTO #Tmp_MyTable
    SELECT TOP (@n) *
    FROM MyTable
    ...

END 
```

上面的代码使用标识列创建了#Tmp_Table，随后插入失败并出现错误“只有在使用列列表并且 IDENTITY_INSERT 为 ON 时才能指定表 '#Tmp_MyTable' 中标识列的显式值”。

TSQL 中是否有办法删除临时表中列的标识属性**而不显式列出所有列**？我特别想使用“SELECT *”，以便在将新列添加到 MyTable 时代码将继续工作。

我相信删除并重新创建该列会改变它的位置，从而无法使用 SELECT *。

**更新：**

我已尝试按照一个响应中的建议使用 IDENTITY_INSERT。它不起作用 - 请参阅下面的重现。我究竟做错了什么？

```
-- Create test table
CREATE TABLE [dbo].[TestTable](
    [ID] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
    [Name] [varchar](50) NULL,
 CONSTRAINT [PK_TestTable] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
)
) 
GO
-- Insert some data
INSERT INTO TestTable
(Name)
SELECT 'One'
UNION ALL
SELECT 'Two'
UNION ALL
SELECT 'Three'
GO
-- Create empty temp table
SELECT *
INTO #Tmp
FROM TestTable
WHERE 1=0

SET IDENTITY_INSERT #Tmp ON -- I also tried OFF / ON
INSERT INTO #Tmp
SELECT TOP 1 * FROM TestTable

SET IDENTITY_INSERT #Tmp OFF 
GO
-- Drop test table
DROP TABLE [dbo].[TestTable]
GO 
```

请注意，错误消息*“表 '#TmpMyTable' 中标识列的显式值只能**在使用列列表**且 IDENTITY_INSERT 为 ON 时指定。”* - 我特别不想使用上面解释的列列表。

**更新 2** 尝试[了 Mike 的建议，](https://stackoverflow.com/questions/713960/how-to-drop-identity-property-of-column-in-sql-server-2005/714247#714247)但这给出了同样的错误：

```
-- Create empty temp table
SELECT *
INTO #Tmp
FROM (SELECT
      m1.*
      FROM TestTable                 m1
          LEFT OUTER JOIN TestTable  m2 ON m1.ID=m2.ID
      WHERE 1=0
 ) dt

INSERT INTO #Tmp
SELECT TOP 1 * FROM TestTable 
```

至于我为什么要这样做：MyTable 是一个临时表，可以包含大量要合并到另一个表中的行。我想处理暂存表中的行，插入/更新我的主表，然后在每个事务处理 N 行的循环中从暂存表中删除它们。我意识到还有其他方法可以实现这一目标。

**更新 3**

我无法让[Mike 的解决方案](https://stackoverflow.com/questions/713960/how-to-drop-identity-property-of-column-in-sql-server-2005/714247#714247)起作用，但是它建议了以下可行的解决方案：使用非身份列作为前缀并删除身份列：

```
SELECT CAST(1 AS NUMERIC(18,0)) AS ID2, *
INTO #Tmp
FROM TestTable
WHERE 1=0
ALTER TABLE #Tmp DROP COLUMN ID

INSERT INTO #Tmp
SELECT TOP 1 * FROM TestTable 
```

Mike 建议只在临时表中存储键也是一个不错的建议，尽管在这种特定情况下，我更喜欢将所有列都放在临时表中是有原因的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T13:44:02.903

你可以试试

```
SET IDENTITY_INSERT #Tmp_MyTable ON 
-- ... do stuff
SET IDENTITY_INSERT #Tmp_MyTable OFF 
```

这将允许您选择进入`#Tmp_MyTable`，即使它有一个标识列。

但这**不起作用**：

```
-- Create empty temp table
SELECT *
INTO #Tmp_MyTable
FROM MyTable
WHERE 1=0
...
WHILE ...
BEGIN
    ...
    SET IDENTITY_INSERT #Tmp_MyTable ON 

    INSERT INTO #Tmp_MyTable
    SELECT TOP (@n) *
    FROM MyTable

    SET IDENTITY_INSERT #Tmp_MyTable OFF 
    ...    
END 
```

（导致错误“只有在使用列列表并且 IDENTITY_INSERT 为 ON 时才能指定表 '#Tmp' 中标识列的显式值。”）

似乎没有实际删除列的方法 - 但这会改变 OP 提到的列的顺序。丑陋的 hack：基于#Tmp_MyTable 创建一个新表...

我建议您编写一个存储过程，该过程基于表名 ( `MyTable`) 创建一个临时表，该表具有相同的列（按顺序），但缺少标识属性。

您可以使用以下代码：

```
select t.name as tablename, typ.name as typename, c.*
from sys.columns c inner join
     sys.tables t on c.object_id = t.[object_id] inner join
     sys.types typ on c.system_type_id = typ.system_type_id
order by t.name, c.column_id 
```

了解反射在 TSQL 中的工作原理。我相信您将不得不遍历相关表的列并对生成的表执行动态（手工制作、存储在字符串中然后评估）alter 语句。

你介意为世界其他地方发布这样一个存储过程吗？这个问题似乎在其他论坛上也出现了很多......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T14:47:19.147

如果您只是按照您的描述处理行，那么将前 N 个主键值选择到临时表中会不会更好，例如：

```
CREATE TABLE #KeysToProcess
(
     TempID    int  not null primary key identity(1,1)
    ,YourKey1  int  not null
    ,YourKey2  int  not null
)

INSERT INTO #KeysToProcess (YourKey1,YourKey2)
SELECT TOP n YourKey1,YourKey2  FROM MyTable 
```

键不应该经常更改（我希望），但其他列可以这样做而不会造成伤害。

获取插入的@@ROWCOUNT，您可以在 TempID 上做一个简单的循环，它将从 1 到 @@ROWCOUNT

和/或

只需将#KeysToProcess 加入您的 MyKeys 表即可，无需复制所有数据。

**这在我的 SQL Server 2005 上运行良好，其中 MyTable.MyKey 是一个标识列。**

```
-- Create empty temp table
SELECT *
INTO #TmpMikeMike
FROM (SELECT
      m1.*
      FROM MyTable                 m1
          LEFT OUTER JOIN MyTable  m2 ON m1.MyKey=m2.MyKey
      WHERE 1=0
 ) dt

INSERT INTO #TmpMike
SELECT TOP 1 * FROM MyTable

SELECT * from #TmpMike 
```

**编辑**
这个作品，没有错误......

```
-- Create empty temp table
SELECT *
INTO #Tmp_MyTable
FROM (SELECT
          m1.*
          FROM MyTable                 m1
              LEFT OUTER JOIN MyTable  m2 ON m1.KeyValue=m2.KeyValue
          WHERE 1=0
     ) dt
...
WHILE ...
BEGIN
    ...
    INSERT INTO #Tmp_MyTable
    SELECT TOP (@n) *
    FROM MyTable
    ...

END 
```

**但是，您真正的问题是什么？** 为什么在将“*”插入此临时表时需要循环？您也许可以改变策略并提出一个整体上更好的算法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T13:52:43.350

**编辑**Daren 建议的切换 IDENTITY_INSERT 肯定是更优雅的方法，在我的情况下，我需要消除标识列，以便我可以将选定的数据重新插入源表

我解决这个问题的方法是像你一样创建临时表，显式删除标识列，然后动态构建 sql，以便我有一个排除标识列的列列表（如你的情况，proc 将如果架构发生更改，仍然可以工作）然后执行 sql 这是一个示例

```
declare @ret int
Select * into #sometemp from sometable
Where
id = @SomeVariable

Alter Table #sometemp Drop column SomeIdentity 

Select @SelectList = ''
Select @SelectList = @SelectList 
+ Coalesce( '[' + Column_name + ']' + ', ' ,'')
from information_schema.columns
where table_name = 'sometable'
and Column_Name <> 'SomeIdentity'

Set @SelectList = 'Insert into sometable (' 
+ Left(@SelectList, Len(@SelectList) -1) + ')'
Set @SelectList = @SelectList 
+ ' Select * from #sometemp '
exec @ret  =  sp_executesql  @selectlist 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-12T17:12:13.437

我编写了这个过程作为自动和快速删除列标识的许多答案的汇编：

```
CREATE PROCEDURE dbo.sp_drop_table_identity @tableName VARCHAR(256) AS
BEGIN
    DECLARE @sql VARCHAR (4096);
    DECLARE @sqlTableConstraints VARCHAR (4096);
    DECLARE @tmpTableName VARCHAR(256) = @tableName + '_noident_temp';

    BEGIN TRANSACTION

    -- 1) Create temporary table with edentical structure except identity
    -- Idea borrowed from https://stackoverflow.com/questions/21547/in-sql-server-how-do-i-generate-a-create-table-statement-for-a-given-table
    -- modified to ommit Identity and honor all constraints, not primary key only!
    SELECT
        @sql = 'CREATE TABLE [' + so.name + '_noident_temp] (' + o.list + ')'
        + ' ' + j.list
    FROM sysobjects so
    CROSS APPLY (
        SELECT
            ' [' + column_name + '] '
            + data_type
            + CASE data_type
                WHEN 'sql_variant' THEN ''
                WHEN 'text' THEN ''
                WHEN 'ntext' THEN ''
                WHEN 'xml' THEN ''
                WHEN 'decimal' THEN '(' + CAST(numeric_precision as VARCHAR) + ', ' + CAST(numeric_scale as VARCHAR) + ')'
                ELSE COALESCE('(' + CASE WHEN character_maximum_length = -1 THEN 'MAX' ELSE CAST(character_maximum_length as VARCHAR) END + ')', '')
            END
            + ' '
            /* + case when exists ( -- Identity skip
            select id from syscolumns
            where object_name(id)=so.name
            and name=column_name
            and columnproperty(id,name,'IsIdentity') = 1
            ) then
            'IDENTITY(' +
            cast(ident_seed(so.name) as varchar) + ',' +
            cast(ident_incr(so.name) as varchar) + ')'
            else ''
            end + ' ' */
            + CASE WHEN IS_NULLABLE = 'No' THEN 'NOT ' ELSE '' END
            + 'NULL'
            + CASE WHEN information_schema.columns.column_default IS NOT NULL THEN ' DEFAULT ' + information_schema.columns.column_default ELSE '' END
            + ','
        FROM
            INFORMATION_SCHEMA.COLUMNS
        WHERE table_name = so.name
        ORDER BY ordinal_position
        FOR XML PATH('')
    ) o (list)
    CROSS APPLY(
        SELECT
            CHAR(10) + 'ALTER TABLE ' + @tableName + '_noident_temp ADD ' + LEFT(alt, LEN(alt)-1)
        FROM(
            SELECT
                CHAR(10)
                + ' CONSTRAINT ' + tc.constraint_name  + '_ni ' + tc.constraint_type + ' (' + LEFT(c.list, LEN(c.list)-1) + ')'
                + COALESCE(CHAR(10) + r.list, ', ')
            FROM
                information_schema.table_constraints tc
                CROSS APPLY(
                    SELECT
                        '[' + kcu.column_name + '], '
                    FROM
                        information_schema.key_column_usage kcu
                    WHERE
                        kcu.constraint_name = tc.constraint_name
                    ORDER BY
                        kcu.ordinal_position
                    FOR XML PATH('')
                ) c (list)
                OUTER APPLY(
                    -- https://stackoverflow.com/questions/3907879/sql-server-howto-get-foreign-key-reference-from-information-schema
                    SELECT
                        '  REFERENCES [' + kcu1.constraint_schema + '].' + '[' + kcu2.table_name + ']' + '([' + kcu2.column_name + ']) '
                        + CHAR(10)
                        + '    ON DELETE ' + rc.delete_rule
                        + CHAR(10)
                        + '    ON UPDATE ' + rc.update_rule + ', '
                    FROM information_schema.referential_constraints as rc
                        JOIN information_schema.key_column_usage as kcu1 ON (kcu1.constraint_catalog = rc.constraint_catalog AND kcu1.constraint_schema = rc.constraint_schema AND kcu1.constraint_name = rc.constraint_name)
                        JOIN information_schema.key_column_usage as kcu2 ON (kcu2.constraint_catalog = rc.unique_constraint_catalog AND kcu2.constraint_schema = rc.unique_constraint_schema AND kcu2.constraint_name = rc.unique_constraint_name AND kcu2.ordinal_position = KCU1.ordinal_position)
                    WHERE
                        kcu1.constraint_catalog = tc.constraint_catalog AND kcu1.constraint_schema = tc.constraint_schema AND kcu1.constraint_name = tc.constraint_name
                ) r (list)
            WHERE tc.table_name = @tableName
            FOR XML PATH('')
        ) a (alt)
    ) j (list)
    WHERE
        xtype = 'U'
    AND name NOT IN ('dtproperties')
    AND so.name = @tableName

    SELECT @sql as '1) @sql';
    EXECUTE(@sql);

    -- 2) Obtain current back references on our table from others to reenable it later
    -- https://stackoverflow.com/questions/3907879/sql-server-howto-get-foreign-key-reference-from-information-schema
    SELECT
        @sqlTableConstraints = (
            SELECT
                'ALTER TABLE [' + kcu1.constraint_schema + '].' + '[' + kcu1.table_name + ']'
                + ' ADD CONSTRAINT ' + kcu1.constraint_name + '_ni FOREIGN KEY ([' + kcu1.column_name + '])'
                + CHAR(10)
                + '  REFERENCES ['  + kcu2.table_schema + '].[' + kcu2.table_name + ']([' + kcu2.column_name + '])'
                + CHAR(10)
                + '    ON DELETE ' + rc.delete_rule
                + CHAR(10)
                + '    ON UPDATE ' + rc.update_rule + ' '
            FROM information_schema.referential_constraints as rc
                JOIN information_schema.key_column_usage as kcu1 ON (kcu1.constraint_catalog = rc.constraint_catalog AND kcu1.constraint_schema = rc.constraint_schema AND kcu1.constraint_name = rc.constraint_name)
                JOIN information_schema.key_column_usage as kcu2 ON (kcu2.constraint_catalog = rc.unique_constraint_catalog AND kcu2.constraint_schema = rc.unique_constraint_schema AND kcu2.constraint_name = rc.unique_constraint_name AND kcu2.ordinal_position = KCU1.ordinal_position)
            WHERE
                kcu2.table_name = 'department'
            FOR XML PATH('')
        );
    SELECT @sqlTableConstraints as '8) @sqlTableConstraints';
    -- Execute at end

    -- 3) Drop outer references for switch (structure must be identical: http://msdn.microsoft.com/en-gb/library/ms191160.aspx) and rename table
    SELECT
        @sql = (
            SELECT
                ' ALTER TABLE [' + kcu1.constraint_schema + '].' + '[' + kcu1.table_name + '] DROP CONSTRAINT ' + kcu1.constraint_name
            FROM information_schema.referential_constraints as rc
                JOIN information_schema.key_column_usage as kcu1 ON (kcu1.constraint_catalog = rc.constraint_catalog AND kcu1.constraint_schema = rc.constraint_schema AND kcu1.constraint_name = rc.constraint_name)
                JOIN information_schema.key_column_usage as kcu2 ON (kcu2.constraint_catalog = rc.unique_constraint_catalog AND kcu2.constraint_schema = rc.unique_constraint_schema AND kcu2.constraint_name = rc.unique_constraint_name AND kcu2.ordinal_position = KCU1.ordinal_position)
            WHERE
                kcu2.table_name = @tableName
            FOR XML PATH('')
        );
    SELECT @sql as '3) @sql'
    EXECUTE (@sql);

    -- 4) Switch partition
    -- http://www.calsql.com/2012/05/removing-identity-property-taking-more.html
    SET @sql = 'ALTER TABLE ' + @tableName + ' switch partition 1 to ' + @tmpTableName;
    SELECT @sql as '4) @sql';
    EXECUTE(@sql);

    -- 5) Rename real old table to bak
    SET @sql = 'EXEC sp_rename ' + @tableName + ', ' + @tableName + '_bak';
    SELECT @sql as '5) @sql';
    EXECUTE(@sql);

    -- 6) Rename temp table to real
    SET @sql = 'EXEC sp_rename ' + @tmpTableName + ', ' + @tableName;
    SELECT @sql as '6) @sql';
    EXECUTE(@sql);

    -- 7) Drop bak table
    SET @sql = 'DROP TABLE ' + @tableName + '_bak';
    SELECT @sql as '7) @sql';
    EXECUTE(@sql);

    -- 8) Create again doped early constraints
    SELECT @sqlTableConstraints as '8) @sqlTableConstraints';
    EXECUTE(@sqlTableConstraints);

    -- It still may fail if there references from objects with WITH CHECKOPTION
    -- it may be recreated - https://stackoverflow.com/questions/1540988/sql-2005-force-table-rename-that-has-dependencies
    COMMIT
END 
```

使用非常简单：

```
EXEC sp_drop_table_identity @tableName = 'some_very_big_table' 
```

好处和限制：

1.  它使用[switch partition](http://technet.microsoft.com/en-us/library/ms191160%28v=sql.105%29.aspx)（也适用于未分区的表）语句进行**快速移动，无需完整数据复制**。它还应用了一些适用条件。
2.  它在没有身份的情况下制作动态表副本。这样的解决方案[我也单独发布](https://stackoverflow.com/a/18619504/307525)，它也可能需要调整像复合字段这样不那么琐碎的结构（它满足了我的需求）。
3.  如果表包含在具有由CHECKOUPTION（sp，视图）绑定的架构的对象中，它会阻止执行切换（参见代码中的最后一条注释）。可以另外编写脚本以临时删除此类绑定。我还没有这样做。

欢迎所有反馈。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-21T12:56:58.947

在 SQL Server 上删除标识列（尤其是对于大型数据库）的最有效方法是直接修改 DDL 元数据，在 2005 年以前的 SQL Server 上，这可以通过以下方式完成：

```
sp_configure 'allow update', 1
go
reconfigure with override
go

update syscolumns set colstat = 0 --turn off bit 1 which indicates identity column
where id = object_id('table_name') and name = 'column_name'
go

exec sp_configure 'allow update', 0
go
reconfigure with override
go 
```

SQL Server 2005+ 不支持*使用 override 重新配置*，但您可以在单用户模式下启动 SQL Server 实例时执行 Ad Hoc Queries（使用*-m*标志启动 db 实例，即 "C:\Program Files\Microsoft SQL Server \MSSQL10.MSSQLSERVER\MSSQL\Binn\sqlservr.exe -m"，确保以管理员身份运行）使用专用管理控制台（从 SQL Management Studio 连接，使用*ADMIN:*前缀，即 ADMIN:MyDatabase）。列元数据存储在*sys.sysschobjs* 内部表中（没有 DAC 时未显示）：

```
use myDatabase

update sys.syscolpars set status = 1, idtval = null -- status=1 - primary key, idtval=null - remove identity data
where id = object_id('table_name') AND name = 'column_name' 
```

有关此方法[的更多信息，请访问此博客](http://www.hackingsqlserver.com/2010/03/modifying-system-tables-in-sql-server.html)

# .net - 使用 iTextSharp 将 HTML 转换为 PDF 时的绝对位置

> ID：713961
> 
> 赞同：5
> 
> 时间：2009-04-03T13:42:37.977
> 
> 标签：.net, html-to-pdf

我正在使用 iTextSharp 将 HTML 转换为 PDF，但它似乎不适用于绝对定位的元素。例如我有这个 HTML 文件：

```
<html>
<body>
    <p style="position: absolute; left: 10px; top: 100px; width: 50px;">Hello World</p>
</body>
</html> 
```

文本在生成的 PDF 文件中的位置不正确。您知道将 HTML 转换为 PDF 时是否可以使用绝对定位的元素？任何允许这样做的免费解决方案（iTextSharp 或其他）将不胜感激。

这是我用来执行 iTextSharp 转换的代码：

```
class Program
{
    static void Main(string[] args)
    {
        Document document = new Document(PageSize.A4);
        using (Stream output = new FileStream("out.pdf", FileMode.Create, FileAccess.Write, FileShare.None))
        using (Stream htmlStream = new FileStream("input.htm", FileMode.Open, FileAccess.Read, FileShare.Read))
        using (XmlTextReader reader = new XmlTextReader(htmlStream))
        {
            PdfWriter.GetInstance(document, output);
            HtmlParser.Parse(document, reader);
        }
        Process.Start(@"C:\Program Files\Adobe\Reader 9.0\Reader\AcroRd32.exe", "out.pdf");
    }
} 
```

* * *

编辑：

经过进一步调查，似乎 iTextSharp 的 HTML 到 PDF 的转换功能仅限于一些非常简单的 HTML 文档。有一个很好的 Java 项目叫做[Flying Saucer](http://code.google.com/p/flying-saucer//)，它可以处理复杂的 HTML 文档。所以我尝试将它与[IKVM](http://www.ikvm.net/)一起使用，效果非常好。唯一的问题是它在某种程度上感觉是一个肮脏的解决方案。为 HTML 到 PDF 的转换添加 31MB 的汇编代码似乎相当多。有没有更好和“免费”的替代方案来处理这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-08T05:14:39.533

我最终决定使用[xhtmlrenderer](http://code.google.com/p/flying-saucer//)。它完全符合我的需求，它具有许多功能，并且能够正确呈现我的任何 HTML 文件。

由于目前它只有一个 JAVA 版本，因此我必须使用[IKVM](http://www.ikvm.net/)将 jar 转换为 .NET 程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-08T02:31:23.020

假设您在 Windows 上，如何通过 COM 或命令行自动化免费的[PDFCreator](http://sourceforge.net/projects/pdfcreator/)以通过 Internet Explorer 的渲染引擎将 HTML 渲染为 PDF？

安装 PDFCreator 后，C:\Program Files\PDFCreator\COM\ 文件夹中有很多自动化示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-07T11:07:10.130

在二进制发行版中的 JAR 上使用 ikvmc 向我展示了许多来自无法生成的类的警告。在包含 iKVM 核心库以处理 Flying Saucer 以 Java 对象为目标的事实后，我遇到了以下异常：

```
`Cannot load AWT toolkit: ikvm.awt.NetToolkit, IKVM.AWT.WinForms, Version=0.40.0.1, Culture=neutral, PublicKeyToken=13235d27fcbfff58` 
```

那只是从执行：

```
`ITextRenderer toRender = new ITextRenderer();` 
```

这似乎是飞碟使用的主要对象。你能提供一些你如何使用它的来源吗？

# c - 为什么这个 offsetof() 的实现有效？

> ID：713963
> 
> 赞同：38
> 
> 时间：2009-04-03T13:43:05.947
> 
> 标签：c, pointers, offsetof

在 ANSI C 中，offsetof 定义如下。

```
#define offsetof(st, m) \
    ((size_t) ( (char *)&((st *)(0))->m - (char *)0 )) 
```

既然我们正在取消引用 NULL 指针，为什么这不会引发分段错误？或者这是某种编译器破解，它看到只有偏移的地址被取出，所以它静态计算地址而不实际取消引用它？这段代码也是可移植的吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-03T13:45:52.057

上述代码中的任何地方都没有取消引用。当`*`或`->`用于地址值以查找引用值时，会发生取消引用。上面的唯一用途`*`是在类型声明中用于强制转换。

上面使用`->`了运算符，但它不用于访问值。相反，它用于获取值的地址。这是一个非宏代码示例，应该使它更清晰一些

```
SomeType *pSomeType = GetTheValue();
int* pMember = &(pSomeType->SomeIntMember); 
```

第二行实际上不会导致取消引用（依赖于实现）。它只是返回值`SomeIntMember`内的地址`pSomeType`。

您看到的是任意类型和 char 指针之间的大量转换。char 的原因是它是 C89 标准中唯一（可能是唯一）具有明确大小的类型之一。大小为 1。通过确保大小为 1，上面的代码可以执行计算值的真实偏移量的邪恶魔法。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-03T14:39:38.777

虽然这是 的典型实现`offsetof`，但标准并没有强制要求，它只是说：

> 标准头文件中定义了以下类型和宏`<stddef.h>`[...]
> 
> `offsetof(`*`type`*`,`*`member-designator`*`)`
> 
> 它扩展为具有类型的整数常量表达式`size_t`，其值是以字节为单位的偏移量，*`member-designator`*从其结构的开头（由 指定）到结构成员（由 指定*`type`*）。类型和成员代号应使给定的
> 
> `static`*`type`*`t;`
> 
> 然后表达式计算为地址常量。（如果指定的成员是位域，则行为未定义。）`&(t.`*`member-designator`*`)`

阅读 PJ Plauger 的“标准 C 库”以讨论它以及其他项目，`<stddef.h>`其中所有的边界线特性都可能（应该？）在适当的语言中，并且可能需要特殊的编译器支持。

它仅具有历史意义，但我在 386/IX 上使用了早期的 ANSI C 编译器（请参阅，我告诉过您具有历史意义，大约在 1990 年），该编译器在该版本上崩溃，`offsetof`但在我将其修改为：

```
#define offsetof(st, m) ((size_t)((char *)&((st *)(1024))->m - (char *)1024)) 
```

那是某种编译器错误，尤其是因为标头与编译器一起分发并且不起作用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-03T14:35:02.000

在 ANSI C 中，`offsetof`不是这样定义的。没有这样定义的原因之一是某些环境确实会抛出空指针异常，或者以其他方式崩溃。因此，ANSI C 将开放的实现留给`offsetof( )`编译器构建器。

上面显示的代码对于不主动检查 NULL 指针但仅在从 NULL 指针读取字节时失败的编译器/环境来说是典型的。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-03T14:37:26.927

要回答问题的最后一部分，代码不可移植。

仅当两个指针指向同一数组中的对象或指向数组最后一个对象之后的对象时，才定义和可移植两个指针相减的结果（7.6.2 加法运算符，H&S 第五版）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T13:47:58.730

它没有段错误，因为您没有取消引用它。指针地址被用作从另一个数字中减去的数字，而不是用于寻址内存操作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T13:55:49.490

它计算成员`m`相对于类型对象表示的起始地址的偏移量`st`。

`((st *)(0))`指的`NULL`是类型的指针`st *`。 `&((st *)(0))->m`指的是这个对象中成员m的地址。由于这个对象的起始地址是`0 (NULL)`，所以成员 m 的地址就是偏移量。

`char *`转换和差异计算以字节为单位的偏移量。根据指针操作，当你对两个类型的指针进行区分时`T *`，结果是`T`操作数包含的两个地址之间表示的类型对象的数量。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-07-23T17:39:14.427

清单 1：一组有代表性的`offsetof()`宏定义

```
// Keil 8051 compiler
#define offsetof(s,m) (size_t)&(((s *)0)->m)

// Microsoft x86 compiler (version 7)
#define offsetof(s,m) (size_t)(unsigned long)&(((s *)0)->m)

// Diab Coldfire compiler
#define offsetof(s,memb) ((size_t)((char *)&((s *)0)->memb-(char *)0))

typedef struct 
{
    int     i;
    float   f;
    char    c;
} SFOO;

int main(void)
{
  printf("Offset of 'f' is %zu\n", offsetof(SFOO, f));
} 
```

宏中的各种运算符按顺序进行评估，以便执行以下步骤：

1.  `((s *)0)`取整数零并将其转换为指向`s`.
2.  `((s *)0)->m`取消引用指向结构成员的指针`m`。
3.  `&(((s *)0)->m)`计算 的地址`m`。
4.  `(size_t)&(((s *)0)->m)`将结果转换为适当的数据类型。

根据定义，结构本身位于地址 0。因此，指向的字段的地址（上面的步骤 3）必须是从结构开始的偏移量（以字节为单位）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-20T20:55:26.447

`offsetof`引用宏的 C 标准：

> **C 标准，第 6.6 节，第 9 段**
> 
> 地址常量是空指针、指向指定静态存储持续时间对象的左值的指针或指向函数指示符的指针；它应使用一元运算`&`符或转换为指针类型的整数常量显式创建，或通过使用数组或函数类型的表达式隐式创建。数组下标`[]`和成员访问`.`和`->`操作符、地址`&`和间接`*`一元操作符以及指针转换可用于创建地址常量，但不得使用这些操作符访问对象的值。

宏定义为

```
#define offsetof(type, member)  ((size_t)&((type *)0)->member) 
```

并且该表达式包括地址常数的创建。

虽然说实话，结果不是地址常量，因为它不指向静态存储持续时间的对象。但这仍然是一致的，即不应访问对象的值，因此不会取消引用转换为指针类型的整数常量。

另外，请考虑 C 标准中的这句话：

> **C 标准，第 7.19 节，第 3 段**
> 
> 类型和成员代号应使给定的
> 
> `static type t;`
> 
> 然后表达式`&(t.member-designator)`计算为地址常量。（如果指定的成员是位域，则行为未定义。）

C 中的 struct 是一种复合数据类型（或记录）声明，它在内存块中以一个名称定义变量的物理分组列表，允许通过单个指针或通过返回的结构声明名称访问不同的变量同一个地址。

从编译器的角度来看，结构声明的名称是一个地址，而成员指示符是该地址的偏移量。

# c# - 如何在 Web 用户控件中添加 listdictionary（如何初始化新方法）？

> ID：713965
> 
> 赞同：0
> 
> 时间：2009-04-03T13:44:14.243
> 
> 标签：c#, .net, asp.net

我创建了 Web 用户控件。它的属性包含在 ListDictionary 中；但我无法在 web uset 控件中生成。如果我在 asp.net 页面中尝试 wuc，它会给出初始化错误：

“对象引用未设置为对象的实例。”

网络用户控制：

```
 protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                FillList1();
            }
        }

        public String OrderClause
        {
            get { return Session["selecteditem"].ToString(); }
            set { Session["selecteditem"] = value; }
        }
        private ListDictionary  items;

        public ListDictionary Items
        {
            get { return items; }
            set { items = value; }
        }
         void FillList1()
        {
             foreach (string ky in Items.Keys)
            {
                ListBox1.Items.Add(new ListItem(ky, Items[ky].ToString()));
            }
        } 
```

## 但！！

### 如果我添加我的网页这个网络用户控件。并编写以下代码：

```
protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                WebUserControl2_1.Items.Add("Yusuf", "1");
                WebUserControl2_1.Items.Add("Gulden", "2");
            }
        }

        protected void btn_test_Click(object sender, EventArgs e)
        {
            lbl_test.Text = WebUserControl2_1.OrderClause.Trim();

        }
```

# 你调用的对象是空的。

错误点：WebUserControl2_1.Items.Add("Yusuf", "1");

我需要 web 用户控件中的 listdictionary 新方法，但如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T13:51:08.517

您在没有首先实例化该字段的情况下引用 Items 属性。因此，请求该项目将导致 NullReferenceException。我喜欢延迟加载的方式，所以当你需要它的时候，如果它为空，那么它会实例化它。

在吸气剂里面，你可以简单地把

```
if(items == null)items = new ListDictionary(); 
return items; 
```

但是你需要考虑状态管理。您有几个选项，包括 ViewState 和 ControlState。

安德鲁

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-22T20:21:41.577

你犯了几个错误。首先，您的所有属性都应该有一种方法可以在回发之间存储它们的值。处理这个问题的一个简单方法是通过视图状态。

这是一篇文章，提供了有关此主题的更多详细信息 [http://www.codeguru.com/csharp/.net/net_asp/controls/article.php/c11971/](http://www.codeguru.com/csharp/.net/net_asp/controls/article.php/c11971/)

其次，如果它是一个集合，则更有可能您只需要一个吸气剂，因为您将操纵集合而不是替换整个集合。

所以你的代码应该是这样的：

```
public ListDictionary Items        
{            
    get 
    {
        object o = ViewState["Items"];
        if (o == null)
        {
            ViewState["Items"] = new ListDictionary;
            o = ViewState["Items"];
        }
        return (ListDictionary) o;
    }
 } 
```

希望这可以帮助，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T13:51:53.447

您实际上从未在*items*变量中实例化 ListDictionary 的实例在这段代码中：

```
 private ListDictionary items;
 public ListDictionary Items
    {
        get { return items; }
        set { items = value; }
    } 
```

把它改成这样：

```
private ListDictionary items;
public ListDictionary Items
    {
        get { if (items == null) {items = new ListDictionary}; return items; }
        set { items = value; }
    } 
```

# java - 跨 DB2 和 Oracle 数据库连接信息最佳实践

> ID：713976
> 
> 赞同：1
> 
> 时间：2009-04-03T13:46:46.267
> 
> 标签：java, sql, oracle, db2

我们正在设计一个相当大的棕地应用程序，并遇到了一些问题。

我们在 DB2 数据库中拥有来自仍在加载数据的遗留应用程序的大量信息。我们在我们控制的 Oracle 数据库中也有信息。

我们必须对表执行“JOIN”类型的操作。现在，我正在考虑将 DB2 表中的信息提取到 List<> 中，然后将它们迭代到 Oracle 数据库上的 SQL 语句中，例如：

```
select * from accounts where accountnum in (...) 
```

有没有更简单的方法在数据库之间进行交互，或者至少，这种操作的最佳实践是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T14:08:48.773

我已经做到了这两种方式。

在不同的机器上使用两个 Sybase 数据库，我设置了存储过程，然后调用 like 函数来来回发送数据。这还允许存储过程审计/记录，以说服客户在此过程中没有数据丢失。

在 Oracle 到 Sybase 的一种方式中，我使用视图来编组数据和每个供应商的 C 库，这些库是从 C++ 程序调用的，该程序为 C API 提供了一个通用接口。

在 MySQL 和 DB2 设置中，与您的情况一样，Db2 是“旧版但仍然存在”，我采用了类似于您所描述的设置：将数据提取到（Java）客户端程序中。

如果连接始终是一对一的，并且每个框的结果集具有相同的键，则您可以使用相同的顺序将它们拉出并在客户端中轻松连接它们。即使它们是一对多的，将它们拼接在一起也只是两个列表的单向迭代。

如果它是多对多的，那么我可能会退回到一次处理一个项目（尽管您可以使用 HashSet 查找）。

不过，基本上，您的选择是存储过程（您需要和客户端层），或者只是在客户端中进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-04T14:19:08.817

1.  您可以从 DB2 中以平面文件格式导出数据并将该平面文件用作外部表或使用 sql 加载器，这是一个批处理过程。

2.  还有一种叫做异构连接的东西。在这里，您创建了一个从 Oracle 到 DB2 的数据库链接。这使得实时查询 DB2 数据库成为可能，并且您可以将 Oracle 表与 DB2 表连接起来。

您还可以将此数据库链接与物化视图结合使用。

有不同种类的异构连接，因此请仔细阅读文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-06T00:17:44.453

它必须是实时数据吗？如果是这样，那么有一些产品可用于异构连接，尤其是作为联合服务器一部分的 db2 关系连接。如果延迟被接受，您可以设置脚本以将数据复制到 oracle，您可以使用它进行本机连接。将数据拉到客户端应用程序时性能会很差。如果这是唯一的选择，请尝试创建一个 db2 存储过程来返回数据，这将使性能稍好一些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T14:19:21.320

如果可以将数据从遗留数据库复制到您控制的数据库，您可以考虑每天（或尽可能频繁地）将新记录从遗留数据库复制到 Oracle 数据库的数据提取作业。如果您无法识别自上次数据加载以来遗留数据库中生成的新记录，这可能不是那么简单。

然后，您可以在 Oracle 实例中进行连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T15:18:54.610

如果您询问供应商，最好的做法可能是购买另一种产品。

在 IBM 方面，有[IBM Federation Server](http://www-01.ibm.com/software/data/infosphere/federation-server/)，它可以“将来自不同来源（如 DB2、Oracle 和 SQL Server）的数据组合到一个虚拟视图中”。我想甲骨文也有一个，但我对他们的产品不太熟悉。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-29T03:19:00.323

*   用于 DRDA 的 Oracle 透明网关[http://www.oracle.com/technetwork/database/gateways/index.html](http://www.oracle.com/technetwork/database/gateways/index.html)
*   IBM Infosphere Federation Server
    [http://www-03.ibm.com/software/products/en/ibminfofedeserv/](http://www-03.ibm.com/software/products/en/ibminfofedeserv/)

请注意，如果您拥有 DB2 Advanced Enterprise Server Edition (AESE)，则包括 Infosphere Federation Server。

这两种产品都允许您使用发送到一个数据库的单个连接查询，该数据库从两个数据库返回数据。Oracle 产品非常棒，因为它允许 Oracle 将 DB2 数据库视为另一个 Oracle DB，并允许 DB2 将 Oracle 数据库视为另一个 DB2 数据库。（感谢 IBM 发布了 DB2 使用的 DRDA 协议的客户端和服务器端的规范。可惜没有其他供应商愿意这样做，尽管他们可以毫无问题地利用 IBM 这样做的事实。）

这两种产品都不是我所说的便宜。为了便宜，您可以利用 Oracle Database Gateway for ODBC
[http://docs.oracle.com/cd/E16655_01/gateways.121/e17936/toc.htm](http://docs.oracle.com/cd/E16655_01/gateways.121/e17936/toc.htm)

# c# - 使用 .net 2.0 播放 Winforms 视频有哪些选择

> ID：713977
> 
> 赞同：0
> 
> 时间：2009-04-03T13:46:47.623
> 
> 标签：c#

在我的 .net c# windows 应用程序中，我有哪些视频播放选项。

目前我正在使用“Microsoft.DirectX.AudioVideoPlayback”，但如果我没记错的话，这是在计算机上加载 DirectX 的先决条件。还有其他选择吗？

更新：

我正在使用 winforms .net 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-03T13:50:40.937

不确定您使用的是哪种显示技术（WPF 或 WinForms），但请查看 WPF MediaElement。它为您抽象了所有内容，并且播放得非常好。

如果您使用的是 WinForms，您仍然可以将 WPF MediaElement 嵌入到 WinForms 中，前提是它对您有意义。

# c# - 如何在 C# 中获取文件中的行数？

> ID：713986
> 
> 赞同：7
> 
> 时间：2009-04-03T13:48:06.233
> 
> 标签：c#, file-io

我需要初始化二维数组，第一列是文件中的每一行。如何获取文件中的行数？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-03T13:53:08.233

你可以这样做：

```
System.IO.File.ReadAllLines("path").Length 
```

# 编辑

正如 Joe 所指出的，我省略了所有标准错误处理，也没有说明您将使用同一个数组来处理其余代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-03T13:51:34.850

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa287535(VS.71).aspx)：

```
int counter = 0;
string line;

// Read the file and display it line by line.
System.IO.StreamReader file = 
   new System.IO.StreamReader("c:\\test.txt");
while((line = file.ReadLine()) != null)
{
   Console.WriteLine (line);
   counter++;
}

file.Close(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-03T13:51:03.370

您必须打开每行中读取的文件才能获得计数：

```
var lines = File.ReadAllLines(filename);
var count = lines.Length; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-03T13:54:45.343

```
int counter = 0;
string line;

System.IO.StreamReader file = new System.IO.StreamReader("c:\\t1.txt");
while((line = file.ReadLine()) != null)
{
    counter++;
}
file.Close(); 
```

计数器会给你行数。您也可以使用循环将行插入数组。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-03T13:53:39.260

对于较大的文件，可能有一种更有效的方法，但您可以从以下内容开始：

```
int l_rowCount = 0;
string l_path = @"C:\Path\To\Your\File.txt";
using (StreamReader l_Sr = new StreamReader(l_path)) 
{
    while (l_Sr.ReadLine())
        l_rowCount++;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-03T13:54:08.853

实际打开文件，将行读入列表，然后创建二维数组可能对您更有用。

```
List<string> lines = new List<string>()

using(System.IO.StreamReader file = new System.IO.StreamReader(fileName))
{
    while(!file.EndOfStream) lines.Add(file.ReadLine());
} 
```

然后，您可以使用您的`lines`列表来创建您的阵列。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-03T15:31:04.957

你能用一些更奇特的东西吗，比如 linq 语句

从文本文件中计数 *

类似的东西？

# java - SWT 语法高亮小部件

> ID：713996
> 
> 赞同：8
> 
> 时间：2009-04-03T13:51:49.500
> 
> 标签：java, swt

有人知道 SWT 小部件可以成为支持语法高亮的文本编辑器吗？我知道 StyledText 小部件，但我希望有人已经编写了一些库，因此可以指定应该突出显示的关键字。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-03T14:15:47.413

事实上，语法高亮的一般原则[是使用**StyledText** Widget](http://www.eclipse.org/articles/StyledText%201/article1.html)。 ![StyledText 小部件](https://i.stack.imgur.com/XlHR9.png)

JavaSourcecodeViewer[**是**](http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/JavaSourcecodeViewer.htm)一个更高级的示例。 ![替代文字](https://i.stack.imgur.com/SpUhQ.png)

JavaViewer**[更加](http://www.eclipse.org/swt/examples.php)**详细（[源代码](http://dev.eclipse.org/viewsvn/index.cgi/org.eclipse.swt.examples/src/org/eclipse/swt/examples/javaviewer/JavaViewer.java?view=co)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T14:02:06.153

我会研究 Eclipse 在他们的代码编辑器中使用的内容。因为如果任何 SWT 应用程序使用语法高亮，它的 Eclipse。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-12T11:08:47.200

也许您正在寻找的是[Eclipse Colorer 插件](http://colorer.sourceforge.net/eclipsecolorer/index.html)。

我不知道着色器是否以及如何用作 SWT 小部件。*************