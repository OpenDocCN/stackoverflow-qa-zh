# StackOverflow 问答 000480000-000480999

# eclipse - Netbeans 6.5 差异工具

> ID：480003
> 
> 赞同：4
> 
> 时间：2009-01-26T14:46:59.253
> 
> 标签：eclipse, netbeans, diff, netbeans6.5

我对 Netbeans 6.5 diff 工具感到非常高兴，我不得不问一些关于它的问题：

*   它的名字是什么？
*   日食有等价物吗？
*   有没有独立版本（没有netbeans）？

非常感谢你！！

瓦莱里奥

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T15:54:25.560

[这是有关Netbeans 差异工具](http://diff.netbeans.org/)的一些信息。它是 Netbeans 版本控制支持模块的一部分。这是指向其版本控制模块的 Netbeans 源代码 的[链接。](http://www.netbeans.org/source/browse/versioncontrol/#dirlist)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T21:05:34.037

TortoiseSVN ( [http://tortoisesvn.tigris.org](http://tortoisesvn.tigris.org) ) 包括一个非常好的可视化差异/合并工具 (TortoiseMerge)。作为奖励，您可以使用 TortoiseIDiff 区分图像，例如应用程序 UI。TortoiseSVN 将 Subversion 与（Windows）桌面集成。

# .net - GetCustomAttributes() 是否保留 .NET 中的属性顺序？

> ID：480007
> 
> 赞同：16
> 
> 时间：2009-01-26T14:47:53.293
> 
> 标签：.net, reflection, attributes, enumeration

标题基本概括了所有内容。当我通过我的类进行一些反思时，MemberInfo.GetCustomAttributes() 方法是否会保留成员的属性顺序？官方文档并没有以任何方式说明任何事情。

* * *

如果你想知道我为什么需要这个，这里是完整的解释。现在提出的问题很长而且不需要，但也许有人可以为更大的问题想出一个替代解决方案，它不涉及依赖属性枚举顺序。

我正在尝试为（ASP.NET）应用程序创建一个灵活的框架，该应用程序预计具有相当长的生命周期。在整个过程中，它将获得许多必须从菜单中访问的表格。为了让开发人员的生活更轻松，我制作了一个`MenuItemAttribute`您可以将其应用于表单的类。此属性在其构造函数中具有无限数量的字符串参数，允许开发人员指定表单在菜单中的确切位置。一个典型的使用示例是这样的`[MenuItem("Company", "Clients", "Orders")]`这将意味着菜单应该有一个项目“公司”，在该项目下将有一个项目“客户”，在该项目下将有一个项目“订单” - 然后将打开表单。如果需要，单个表单可以具有多个这些属性 - 然后可以从菜单中的多个位置访问它。

显然，整个菜单是在运行时通过枚举我的程序集中的所有类并搜索该属性来构建的。但是最近我收到了一个请求，即菜单项应该以预定义的方式进行排序。具有相关功能的表单应在菜单中彼此相邻。请注意，这不是按字母排序，而是开发人员指定的预定义顺序。

这就带来了问题——如何在这些属性中指定顺序？由于`MenuItemAttribute`描述了整个层次结构，因此订单规范还应包括整个（或至少一部分）层次结构的订单号。仅针对较低层次结构的订单号是不够的。

我可以制作另一个属性 - `MenuItemOrderHintAttribute`，但是当有多个属性时，这会带来问题`MenuItemAttribute`。因此，原来的问题。

我还可以将 扩展`MenuItemAttribute`为采用两个数组或一对数组，但这会使语法复杂化很多。最后一个想法是我可以使字符串具有特殊格式，但恕我直言，那将是相当混乱的。

* * *

好的，我有另一个想法。让我们使用 Jon Skeet 建议的顺序。这将允许指定层次结构的最后一级的顺序，而不是更高的。但我可以修改该属性，使其不仅适用于类，还适用于程序集本身。在这种情况下，菜单项将没有关联的表单。在装配级别，这些属性可用于指定层次结构更高级别之间的排序。

这是集中式和分散式菜单系统之间的权衡。任何想法为什么这是一个坏主意？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-26T15:08:42.393

文件中元素的词法顺序**绝对**不能保证在生成的 CIL 程序集中以任何方式保持不变，也不能在反射返回的结果中得到尊重。在同一个应用程序域内的重复调用中，甚至不能保证这种排序是相同的！

请注意，MS 过去在反射的其他部分中破坏了这种顺序（注意到他们这样做实际上给他们的一些代码造成了一些问题），因此即使它目前恰好工作，也没有什么能阻止这种破坏将来或在不同的平台上。

考虑更改您的属性模型以允许直接表达语义信息，而不是依赖于排序。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-26T14:56:49.297

我会在 MenuItemAttribute 构造函数中添加一个额外的（可选）值，即“订单”或“优先级”：

```
[MenuItem(0, "Company", "Clients", "Orders")]
[MenuItem(1, "Foo", "Bar", "Baz")] 
```

我并不是说它会很漂亮，但它可以有效地让您指定排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T14:50:31.633

不幸的是，不，您不能保证订单与您指定的订单相同。

### 编辑：一种解决方法

免责声明：如果我误解了您的最终问题，我提前道歉。

听起来好像您需要能够将`n`多个字符串传递给`MenuItemAttribute`并`MenuItemAttribute`保持开发人员在属性构造函数中输入的这些字符串的顺序。

这是一个可能的解决方案：

使用`MenuItemAttribute`a[`LinkedList<String>`](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)来保持其状态。然后你可以在你的构造函数中迭代`params String[]`并将它们添加到`LinkedList<String>`将保持顺序的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T15:19:56.177

在我看来，您的问题实际上源于表单指定它们出现在菜单中的位置这一事实，这意味着您正在尝试通过组合程序集中的所有表单来构建菜单。如果您将菜单的结构与任何表单分开指定，并从与菜单项对应的类上定义的各种属性/属性解析表单，则可能会更容易。

例如

```
public class MenuItem
{
    string Text { get; }
    Type FormType { get; }
    ICollection<MenuItem> SubItems { get; }
} 
```

然后选择菜单项时，以某种方式解析表单并显示它。这种方法的缺点是任何新表单都需要更改指定菜单结构的代码以及表单本身，但这将是非常小的......

# moss - Sharepoint Designer 未打开 HTML 文件

> ID：480014
> 
> 赞同：1
> 
> 时间：2009-01-26T14:48:52.277
> 
> 标签：moss, sharepoint-designer

我有一个 FBA 网站，然后我对其进行了扩展（以使用 Windows 身份验证），以便能够使用 Sharepoint Designer 访问它。这是MOSS 2007 BTW。

当我用设计器打开扩展站点时，它显示了 MOSS 网站层次结构，但双击 aspx 或 .master 文件它什么也不做。

我可以在记事本中打开它……但不能在 Sharepoint Designer 中打开。

关于这个网站/设计师可能有什么问题的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T15:23:08.290

这是 SharePoint Designer 的试用版吗？[碰巧的是，试用版可能无法按照此处](http://us1.trymicrosoftoffice.com/licensing.aspx?culture=en-US)的说明为您打开页面。

否则，右键单击您要打开的页面并相应地查看/选择您的选项。

# c# - WCF 服务限制

> ID：480020
> 
> 赞同：17
> 
> 时间：2009-01-26T14:51:09.417
> 
> 标签：c#, .net, wcf, soa, throttling

假设我正在处理涉及发送大量数据的服务。

如果我用 WCF 实现这个，WCF 会根据每个请求需要多少内存来限制服务吗？或者每次我收到大量服务命中时，我是否会持续出现内存不足异常？

我很好奇在 WCF 之外处理这个问题，我对服务开发还是有点陌生​​......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-26T16:01:23.393

虽然像 Andrew Hare 所建议的那样使用绑定属性和 readerQuotas 将允许对于大多数实际用途基本上无限大小，请记住，如果您接受长时间运行的命令，您将遇到其他问题，例如超时，无论该服务如何构造（使用或不使用 WCF）。

无论您的消息大小如何，都需要限制 WCF 服务以提高性能，以免它被淹没。如果您在 IIS 或 WAS 中托管它，您将拥有这些托管环境的附加内置功能，这将使您的服务更加“高度可用”。但是，您仍然需要注意并发问题。以下 WCF 配置提供了设置一些限制值的示例。

```
 <system.serviceModel>

    ...

     <behaviors>
       <serviceBehaviors>
         <behavior name="GenericServiceBehavior">
           <serviceTimeouts transactionTimeout="00:09:10"/>
           <serviceThrottling
             maxConcurrentCalls="20"
             maxConcurrentSessions="20"
             maxConcurrentInstances="20"
           />
         </behavior>
       </serviceBehaviors>
     </behaviors>
   </system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T15:36:27.267

WCF 确实有一个默认的有效负载大小限制，它将拒绝超过一定字节数的消息。这当然可以在配置文件的绑定部分进行配置。这是一个粗略的示例，[`basicHttpBinding`](http://msdn.microsoft.com/en-us/library/ms731361.aspx)向您展示了许多可用的属性：

```
<bindings>
    <basicHttpBinding>
        <binding name="testBinding" maxReceivedMessageSize="2147483647">
            <readerQuotas
              maxDepth="2147483647"
              maxStringContentLength="2147483647"
              maxArrayLength="2147483647"
              maxBytesPerRead="2147483647"
              maxNameTableCharCount="2147483647" />
        </binding>
    </basicHttpBinding> 
```

这个想法是您可以创建许多不同的绑定，您可以将它们用于不同的场景。这很好，因为您可以微调服务的使用方式，并且只增加需要它们的端点的消息大小限制。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T16:46:10.060

如果您使用的是 NetTCPBinding 或 NetNamedPipeBinding，您可以使用 MaxConnections 属性：

```
<bindings>
  <netTcpBinding>
    <binding name="myTCPBinding" maxConnections="15"/>
  </netTcpBinding>
</bindings> 
```

# mysql - 用户变量 - 战斗语法

> ID：480030
> 
> 赞同：1
> 
> 时间：2009-01-26T14:53:34.967
> 
> 标签：mysql, syntax

任何人都可以直接设置我的 MySQL 语法吗？我正在尝试将一个名为“seconds”的用户变量设置为等于下面显示的查询的输出（它确实可以自己工作），但我不断收到“您的 SQL 语法有错误”错误。

```
SET @seconds=AVG(t2.epoch-t1.epoch)
             FROM tmp_4045_metrics AS t1, tmp_4045_metrics AS t2
             WHERE t1.seq+1 = t2.seq 
```

我已经尝试过 SELECT AVG....、(SELECT AVG...) 和许多其他方法，但总是出现相同的错误警告，即我的语法不正确，而且从来没有任何线索指出它不正确的地方。

谁能指出我正确的方向？

谢谢，丰富

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T15:00:12.817

如果我没记错（并且它在工作中的 MS SQL Server 上工作），应该这样做：

```
Select @seconds=AVG(t2.epoch-t1.epoch)
             FROM tmp_4045_metrics AS t1, tmp_4045_metrics AS t2
             WHERE t1.seq+1 = t2.seq 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T19:52:19.603

现在 SELECT @seconds=... 可以正常工作 - 破解 :) 并且 SELECT @seconds 返回，但它是空的。

我已经三次检查了语句返回的值（准确地说是 300 秒）。回到绘图板

不过谢谢你的建议，比我自己做的要好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-17T19:24:49.527

在 SELECT 语句中，使用 := 赋值运算符（而不是 = 运算符）：

```
SELECT @seconds := AVG(t2.epoch-t1.epoch)
    FROM tmp_4045_metrics AS t1, tmp_4045_metrics AS t2
    WHERE t1.seq+1 = t2.seq 
```

# c# - 检查两个列表 是相同的数字

> ID：480033
> 
> 赞同：22
> 
> 时间：2009-01-26T14:55:02.670
> 
> 标签：c#, .net, generics, list

我有两个列表，我想检查相应的数字。

例如

```
List<int> a = new List<int>(){1, 2, 3, 4, 5};
List<int> b = new List<int>() {0, 4, 8, 12}; 
```

应该给出结果 4\. 有没有一种简单的方法可以做到这一点而无需过多地循环列表？

我正在为我需要这个的项目使用 3.0，所以没有 Linq。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-26T14:59:11.867

您可以使用 .net 3.5 .Intersect() 扩展方法：-

```
List<int> a = new List<int>() { 1, 2, 3, 4, 5 };
List<int> b = new List<int>() { 0, 4, 8, 12 };

List<int> common = a.Intersect(b).ToList(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-26T15:08:44.203

Jeff Richter 出色的 PowerCollections 设置了交叉点。一直工作到 .NET 2.0。

[http://www.codeplex.com/PowerCollections](http://www.codeplex.com/PowerCollections)

```
 Set<int> set1 = new Set<int>(new[]{1,2,3,4,5});
    Set<int> set2 = new Set<int>(new[]{0,4,8,12});
    Set<int> set3 = set1.Intersection(set2); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-26T15:11:16.007

您可以像 LINQ 那样有效地做到这一点 - 使用一组。现在在 3.5 之前我们还没有合适的集合类型，所以你需要使用 a`Dictionary<int,int>`或类似的东西：

*   创建一个并使用元素作为条目的键和值`Dictionary<int, int>`从列表中填充它。`a`（条目中的值根本不重要。）
*   为交叉点创建一个新列表（或将其写为迭代器块，无论如何）。
*   遍历列表 b，并使用 dictionary.ContainsKey 检查：如果是，则向列表中添加一个条目或生成它。

那应该是 O(N+M) （即在两个列表大小中都是线性的）

请注意，如果列表 b 包含重复项，这将为您提供重复的条目。如果您想避免这种情况，您可以在第一次在 list 中看到字典条目时更改它的值`b`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T14:56:34.523

您可以对第二个列表进行排序并遍历第一个列表，并为每个值对第二个列表进行二进制搜索。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-26T15:03:04.213

如果两个列表都已排序，您可以在 O(n) 时间内轻松完成此操作，方法是从合并排序中进行修改合并，只需“删除”（步进计数器过去）两个前导数字中的较低者，如果它们曾经相等，将该数字保存到结果列表中并“删除”它们。它需要少于 n(1) + n(2) 步。这当然是假设它们已排序。但是整数数组的排序并不完全昂贵 O(n log(n))... 我认为。如果您愿意，我可以将一些代码放在一起如何做到这一点，但这个想法非常简单。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-26T15:15:57.510

在评论问题作者说会有

> 第一个列表中最多 15 个，第二个列表中最多 20 个

在这种情况下，我不会为优化而烦恼并使用 List.Contains。

对于较大的列表，可以使用散列来利用 O(1) 查找，这会导致 O(N+M) 算法，正如 Jon 指出的那样。

哈希需要额外的空间。为了减少内存使用，我们应该散列最短列表。

```
List<int> a = new List<int>() { 1, 2, 3, 4, 5 };
List<int> b = new List<int>() { 0, 4, 8, 12 };
List<int> shortestList;
List<int> longestList;
if (a.Count > b.Count)
{
    shortestList = b;
    longestList = a;
}
else
{
    shortestList = a;
    longestList = b;                
}

Dictionary<int, bool> dict = new Dictionary<int, bool>();
shortestList.ForEach(x => dict.Add(x, true));

foreach (int i in longestList)
{
    if (dict.ContainsKey(i))
    {
        Console.WriteLine(i);
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-26T15:38:25.047

在 3.0 上测试

```
 List<int> a = new List<int>() { 1, 2, 3, 4, 5, 12, 13 };
    List<int> b = new List<int>() { 0, 4, 8, 12 };
    List<int> intersection = new List<int>();
    Dictionary<int, int> dictionary = new Dictionary<int, int>();
    a.ForEach(x => { if(!dictionary.ContainsKey(x))dictionary.Add(x, 0); });
    b.ForEach(x => { if(dictionary.ContainsKey(x)) dictionary[x]++; });
    foreach(var item in dictionary)
    {
        if(item.Value > 0)
            intersection.Add(item.Key);
    } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-26T14:59:45.093

var c = a.Intersect(b);

这仅适用于 3.5 看到您的要求我的要求。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-26T15:06:27.873

如果您要从头开始实施，ocdecio 推荐的方法是一个很好的方法。看看与我们看到的 nieve 方法相比的时间复杂度：

排序/二分查找方法：T ~= O(n log n) + O(n) * O(log n) ~= O(n log n)

遍历两个列表（nieve 方法）： T ~= O(n) * O(n) ~= O(n ^ 2)

可能有更快的方法，但我不知道。希望这应该证明选择他的方法是合理的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-26T15:15:29.057

这是一种删除重复字符串的方法。将其更改为适应 int ，它将正常工作。

```
public List<string> removeDuplicates(List<string> inputList)
    {
        Dictionary<string, int> uniqueStore = new Dictionary<string, int>();
        List<string> finalList = new List<string>();

        foreach (string currValue in inputList)
        {
            if (!uniqueStore.ContainsKey(currValue))
            {
                uniqueStore.Add(currValue, 0);
                finalList.Add(currValue);
            }
        }
        return finalList;

    } 
```

更新：抱歉，我实际上是在合并列表，然后删除重复项。我将组合列表传递给此方法。不完全是您正在寻找的东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-26T15:24:59.147

*（上一个答案 - 将 IndexOf 更改为包含，因为 IndexOf 首先转换为数组）*

看到它是两个小列表，下面的代码应该没问题。不确定是否有一个像 Java 那样具有交集方法的库（尽管 List 不是一个集合，所以它不起作用），我知道有人指出 PowerCollection 库有一个。

```
List<int> a = new List<int>() {1, 2, 3, 4, 5};
List<int> b = new List<int>() {0, 4, 8, 12};

List<int> result = new List<int>();
for (int i=0;i < a.Count;i++)
{
    if (b.Contains(a[i]))
        result.Add(a[i]);
}

foreach (int i in result)
    Console.WriteLine(i); 
```

**更新 2：** HashSet 是一个愚蠢的答案，因为它是 3.5 而不是 3.0

**更新**： HashSet 似乎是显而易见的答案：

```
// Method 2 - HashSet from System.Core
HashSet<int> aSet = new HashSet<int>(a);
HashSet<int> bSet = new HashSet<int>(b);
aSet.IntersectWith(bSet);
foreach (int i in aSet)
    Console.WriteLine(i); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-26T16:05:27.927

哇。迄今为止的答案看起来非常复杂。为什么不直接使用：

 `````
List<int> a = new List<int>() { 1, 2, 3, 4, 5, 12, 13 };
List<int> b = new List<int>() { 0, 4, 8, 12 };

...

public List<int> Dups(List<int> a, List<int> b)
{
    List<int> ret = new List<int>();

    foreach (int x in b)
    { 
        if (a.Contains(x))
        {
           ret.add(x);
        }
    }

    return ret;
} 
````  `这对我来说似乎更直接......除非我错过了部分问题。这是完全可能的。

# flash - 在删除之前卸载 MovieClip？

> ID：480034
> 
> 赞同：0
> 
> 时间：2009-01-26T14:55:09.457
> 
> 标签：flash, garbage-collection, actionscript-2, movieclip

**在离开舞台之前**`Unload`将MovieClip更好地处理，以便从 RAM 中清除其内容，从而更好地释放 RAM？ **`Removing`**

 **Adobe Flash AS2 文档：

*   **`removeMovieClip()`**- 删除影片剪辑实例。
*   **`unloadMovie()`**- 删除影片剪辑实例的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T09:21:54.703

尽管我很讨厌这样说。removeMovieClip 不会删除影片剪辑的所有痕迹。例如：如果使用 setInterval ，即使在卸载或删除影片剪辑后它也会触发一个事件（因为我不得不找出困难的方法）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T23:09:26.703

不，根据[Live Docs：](http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/common/html/wwhelp.htm?context=Flash_MX_2004&file=00001563.html)

> `unloadMovieClip`删除影片剪辑实例的内容。**实例属性和剪辑处理程序保留。**
> 
> 要**删除实例，包括其属性和剪辑处理程序**，请使用`MovieClip.removeMovieClip().`

这意味着将删除一个实例`removeMovieClip()`的所有痕迹，而只会删除它的内容。这也意味着没有必要在调用之前调用。`MovieClip``unloadMovieClip()``unloadMovie()``removeMovieClip()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T22:41:12.323

removeMovieClip 执行显式 unloadMovieClip（如有必要）。但是，卸载剪辑不会删除该实例。

# c# - 没有 asp.net 的 SQL Server 2005 依赖项缓存

> ID：480041
> 
> 赞同：1
> 
> 时间：2009-01-26T14:57:20.200
> 
> 标签：c#, sql-server-2005

有谁知道关于在*没有*asp.net 的情况下使用 SQL Server 2005 依赖项缓存的良好在线资源（它实际上是一个控制台应用程序）。使用 c# 2.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T16:32:26.763

基本系统中没有任何东西可以像 ASP.NET 那样即插即用。但是，企业库具有适用于任何类型应用程序的缓存应用程序块：http: [//msdn.microsoft.com/en-us/library/dd203226.aspx](http://msdn.microsoft.com/en-us/library/dd203226.aspx)

# asp.net - RegisterClientScriptBlock 没有表单标签

> ID：480042
> 
> 赞同：4
> 
> 时间：2009-01-26T14:57:23.850
> 
> 标签：asp.net, javascript, registerclientscriptblock

在试图理解为什么客户端代码没有呈现在页面中（由用户控件注入）后，我找到了这个[链接](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=105002)，事实证明你必须有一个表单标签才能工作（[Page.RegisterClientScriptBlock](http://msdn.microsoft.com/en-us/library/system.web.ui.page.registerclientscriptblock.aspx)确实声明了这一点，但我的[ClientScriptManager.RegisterClientScriptBlock](http://msdn.microsoft.com/en-us/library/bahh2fef(VS.80).aspx) use 对此没有任何说明）。
我正在使用 Visual Studio 2005。
有谁知道这是否已解决？

**编辑**：
为了澄清，我希望我的控件将 javascript 代码添加到页面的 head 部分，而不必使用

```
<form runat="server" 
```

我尝试使用以下方法添加它：

```
HtmlGenericControl x = new HtmlGenericControl("script");
x.InnerText = "alert('123');";
Page.Header.Controls.Add(x); 
```

但这对我不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T15:08:50.723

据我所知，这个功能在当前版本中是一样的，不过你可以很简单地测试它。

**更新**

根据评论中的讨论，我能想到的唯一“解决方法”是让您自己手动将脚本插入页面的“head”部分，在 Head 元素上使用 runat="server" 声明.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T15:46:25.250

Got it!
My mistake was not doing it in the **OnPreRender** method (I used the **Render** method).

Now all that is needed is - like Mitchel Sellers wrote, set the header to runat server and than add to it's controls:

```
 HtmlGenericControl x = new HtmlGenericControl("script");
 x.InnerText = GetScriptSection();
 Page.Header.Controls.Add(x); 
```

Thanks for pointing me to the right direction!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T15:25:50.283

registerclientscriptblock 的 MSDN 页面在[这里](http://msdn.microsoft.com/en-us/library/system.web.ui.page.registerclientscriptblock(VS.71).aspx)说：

> 客户端脚本在 Page 对象的 <form runat= server> 元素的开始标记之后发出。脚本块在定义呈现输出的对象时发出，因此您必须包含 <script> 元素的两个标记。

如果您不想包含表单，那么您基本上需要构建自己的实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T18:12:06.340

Minor clarification for anyone seeing this:

The form tag must have the runat="server" attribute set, e.g.

`<form id="theform" runat="server">`

Just placing a regular HTML form tag in the page will not help.

# css - 找出网页上元素的颜色和其他样式属性的简单方法

> ID：480046
> 
> 赞同：1
> 
> 时间：2009-01-26T14:58:28.153
> 
> 标签：css

您是否知道任何可以让我轻松确定网页上元素的样式属性的工具（最好是免费的）或浏览器插件。

例如，它可以是一个工具，可以从与页面关联的 css 文件中导入所有样式信息，并将其呈现为内联样式。

最终，某种浏览器插件可以让我选择一个元素，然后显示样式信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T15:07:57.387

Safari 和 Chrome 有一个内置的 Web Inspector，右键单击并选择 Inspect Element。Firefox 有 Firebug 插件。IE 有 IE 开发工具栏。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T15:05:07.110

[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)会做到这一点，至少在 Firefox 中是这样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T15:05:58.950

您最好的选择是 FireFix 的“Web Developer Toolbar”扩展。使用此扩展，您可以启用“显示 CSS 信息”，单击一个元素会打开一个包含所有适用 CSS 样式的窗口。

您还可以查看所有 CSS 并用它做许多其他非常有用的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T15:07:21.863

检查Nikhil Kothari 为 IE 编写的[Web 开发助手](http://projects.nikhilk.net/WebDevHelper)

和Firefox 中的[Firebug](http://getfirebug.com/)

希望这有帮助

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T12:24:01.743

如果它只是您在 Firefox 中所追求的颜色，您可以使用[ColorZilla](http://www.colorzilla.com/firefox/)，它可以让您从视口中滴出任何颜色（包括铬！）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T15:24:33.857

用于 web 开发（整体图形）插件[WebDeveloper](https://addons.mozilla.org/it/firefox/addon/60) for firefox。轻巧而强大

# download - 从远程服务器下载文件

> ID：480048
> 
> 赞同：1
> 
> 时间：2009-01-26T14:58:57.247
> 
> 标签：download, text-files

我正在使用 C# 和控制台应用程序，并且正在使用此脚本从远程服务器下载文件。我想补充几点。首先，当它写入文件时，它不考虑换行符。这似乎运行了一定数量的字节，然后进入换行符。我希望它保持与它正在读取的文件相同的格式。其次，我需要在服务器上下载多个 .jpg 文件。如何使用此脚本下载多个 .jpg 文件

```
public static int DownLoadFiles(String remoteUrl, String localFile)
    {
        int bytesProcessed = 0;

        // Assign values to these objects here so that they can
        // be referenced in the finally block
        StreamReader remoteStream = null;
        StreamWriter localStream = null;
        WebResponse response = null;

        // Use a try/catch/finally block as both the WebRequest and Stream
        // classes throw exceptions upon error
        try
        {
            // Create a request for the specified remote file name
            WebRequest request = WebRequest.Create(remoteUrl);
            request.PreAuthenticate = true;
            NetworkCredential credentials = new NetworkCredential("id", "pass");
            request.Credentials = credentials;

            if (request != null)
            {
                // Send the request to the server and retrieve the
                // WebResponse object
                response = request.GetResponse();
                if (response != null)
                {
                    // Once the WebResponse object has been retrieved,
                    // get the stream object associated with the response's data
                    remoteStream = new StreamReader(response.GetResponseStream());

                    // Create the local file
                    localStream = new StreamWriter(File.Create(localFile));

                    // Allocate a 1k buffer
                    char[] buffer = new char[1024];
                    int bytesRead;

                    // Simple do/while loop to read from stream until
                    // no bytes are returned
                    do
                    {
                        // Read data (up to 1k) from the stream
                        bytesRead = remoteStream.Read(buffer, 0, buffer.Length);

                        // Write the data to the local file
                        localStream.WriteLine(buffer, 0, bytesRead);

                        // Increment total bytes processed
                        bytesProcessed += bytesRead;
                    } while (bytesRead > 0);
                }
            }
        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
        }
        finally
        {
            // Close the response and streams objects here
            // to make sure they're closed even if an exception
            // is thrown at some point
            if (response != null) response.Close();
            if (remoteStream != null) remoteStream.Close();
            if (localStream != null) localStream.Close();
        }

        // Return total bytes processed to caller.
        return bytesProcessed; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T15:03:56.833

你为什么不使用`WebClient.DownloadData`或`WebClient.DownloadFile`代替？

```
WebClient client = new WebClient();
client.Credentials = new NetworkCredentials("id", "pass");
client.DownloadFile(remoteUrl, localFile); 
```

顺便说一句，将流复制到另一个的正确方法不是您所做的。您根本不应该阅读`char[]`，因为您在下载二进制文件时可能会遇到编码和行尾问题。`WriteLine`方法调用也有问题。将流的内容复制到另一个的正确方法是：

```
void CopyStream(Stream destination, Stream source) {
   int count;
   byte[] buffer = new byte[BUFFER_SIZE];
   while( (count = source.Read(buffer, 0, buffer.Length)) > 0)
       destination.Write(buffer, 0, count);
} 
```

这个`WebClient`类更容易使用，我建议改用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T15:02:32.217

结果文件中出现虚假换行符的原因是 StreamWriter.WriteLine() 将它们放在那里。尝试使用 StreamWriter.Write() 代替。

关于下载多个文件，你不能只运行几次函数，将你需要的不同文件的 URL 传递给它吗？

# mysql - mysql中的嵌套插入用于标记

> ID：480065
> 
> 赞同：3
> 
> 时间：2009-01-26T15:04:48.703
> 
> 标签：mysql, tags, tagging

我想用一条 sql 语句将标签添加到博客文章中。

假设我的表格如下所示：

```
tags
+-------+-----------+
| tagid | tag       |
+-------+-----------+
|     1 | news      | 
|     2 | top-story | 
+-------+-----------+

tag2post
+----+--------+-------+
| id | postid | tagid |     
+----+--------+-------+
|  0 |    322 |     1 |
+----+--------+-------+ 
```

我想解决的问题是**插入一个新标签**，**检索它的 id**，然后在单个 sql 语句中将**这个新 id 插入到关系表中。**

```
INSERT INTO tag2post (postid, tagid)
VALUES
(
    332, # the post
    IF (
        (SELECT tagid FROM tags WHERE tag = 'new_tag'),
        (SELECT tagid FROM tags WHERE tag = 'new_tag'),
         # here is where i'd like to insert 
         # the new_tag and return it's id
        'i am lost here'
    )
) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-26T15:06:52.613

您不能将其作为单个插入来执行，因为插入是原子的——也就是说，在语句完成之前不会确定 ID。

将这两个语句包装在一个事务中，您将获得您的 ID 和原子性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T15:13:41.883

不要使用自动增量 ID 列，而是使用 GUID 列。然后，您可以在运行语句之前生成 GUID 并立即执行所有操作。

甚至[Jeff Atwood 也喜欢这种方法](https://blog.codinghorror.com/primary-keys-ids-versus-guids/)，而且您不会因为使用 32 字符字符串而不是整数而显着降低速度。

此外，为了防止标签重复，您应该使用标签名称的 MD5 和作为标签 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-22T19:57:06.393

我认为你必须打破它。一种方法是将`UNIQUE`约束添加到`tag`并按如下方式进行：

```
INSERT IGNORE INTO tags (tag) VALUE ('new_tag') 
```

接着

```
INSERT INTO tag2post (postid, tagid)
VALUES
(
    332, # the post
    (SELECT tagid FROM tags WHERE tag = 'new_tag')
) 
```

`INSERT IGNORE`但是，可能无法很好地扩展。因此，另一种方法是`SELECT`，如果 id 不存在，那么如果另一个线程/进程/服务修改了您和现在`INSERT`之间的表，请务必在此处捕获异常。`SELECT`在`INSERT`你做`LAST_INSERT_ID()`和 int 他抓住你重复最初的`SELECT`..

不太好，但如果并发是一个要求，你需要这样做。事务不会缓解这个问题，如果你对 没有`UNIQUE`约束`tag`，你最终可能会得到重复`INSERT`的 s。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T15:13:29.730

您可以尝试这样做，如果无法选择它，则有效地进行插入，然后从插入的行中检索 LAST_INSERT_ID() ，但我严重怀疑它是否会起作用。

```
INSERT INTO tag2post (postid, tagid)
VALUES
(
    332, # the post
    IF (
        (SELECT tagid FROM tags WHERE tag = 'new_tag'),
        (SELECT tagid FROM tags WHERE tag = 'new_tag'),
        IF (
            (INSERT INTO tags (tag) VALUES ('new_tag')),
            LAST_INSERT_ID(),
            LAST_INSERT_ID()
        )
    )
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T15:14:05.643

如果您使用非自动增量字段并进行自己的增量计算，您可以在插入字段之前确定 id 是什么，并手动指定新的 id。

然后，您可以使用这些由 ;s 分隔的 id 为每个 tag2post 条目构建一个语句字符串，然后您可以将其发送到 msyql 执行。

# lisp - 什么是 Lisp 图像？

> ID：480083
> 
> 赞同：27
> 
> 时间：2009-01-26T15:09:23.653
> 
> 标签：lisp, common-lisp

本质上，我想知道 Lisp 图像是什么？它是包含 Lisp 解释器和一个或多个程序的内存片还是什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-25T12:25:32.017

**Lisp 图像作为转储内存**

图像通常是一个文件。它是 Lisp 系统内存的转储。它包含 Lisp 系统的所有函数（通常编译为机器码）、变量值、符号等。它是一个正在运行的 Lisp 的快照。

要创建图像，需要启动 Lisp，使用一段时间，然后转储图像（执行此操作的函数名称取决于实现）。

**使用 Lisp 图像**

下次重新启动 Lisp 时，可以使用转储的图像并大致恢复到之前的状态。转储图像时，还可以告诉 Lisp 在转储图像启动时应该做什么。这样就可以重新连接到服务器，再次打开文件等。

要启动这样一个 Lisp 系统，需要一个内核和一个映像。有时 Lisp 可以将两者放在一个文件中，这样一个可执行文件既包含内核（具有一些运行时功能）又包含图像数据。

在 Lisp 机器（运行 Lisp 操作系统的计算机）上，一种引导加载程序（FEP，前端处理器）可以将映像（称为“世界”）加载到内存中，然后启动该映像。在这种情况下，没有内核，计算机上运行的只是这个 Lisp 映像，它包含所有功能（解释器、编译器、内存管理、GC、网络堆栈、驱动程序......）。基本上它是单个文件中的操作系统。

一些 Lisp 系统会在转储图像之前优化内存。他们可能会进行垃圾收集，对内存中的对象进行排序等。

**为什么要使用图像？**

为什么要使用图像？它节省了加载内容的时间，并且可以为用户提供带有应用程序代码和数据的预配置 Lisp 系统。使用保存的图像启动 Common Lisp 实现通常很快 - 在当前计算机上只需几毫秒。

由于 Lisp 映像可能包含很多功能（编译器，甚至是开发环境，大量调试信息，...），它的大小通常为几兆字节。

在 Lisp 中使用图像与 Smalltalk 系统所做的非常相似。例如，Squeak 还使用 Smalltalk 代码和数据的映像以及运行时可执行文件。有一个实际的区别：大多数当前的 Lisp 系统使用编译的机器代码。因此，映像不能在不同的处理器架构（x86、x86-64、SPARC、POWER、ARM 等）甚至操作系统之间移植。

**历史**

这种 Lisp 图像已经使用了很长时间。例如`SYSOUT`，1967 年 BBN Lisp 中的函数创建了这样的图像。`SYSIN`会在开始时读取这样的图像。

**图像保存功能示例**

示例见 LispWorks 的save [-](http://www.lispworks.com/) [image](http://www.lispworks.com/documentation/lw51/LWRM/html/lwref-240.htm#marker-1041670)函数或阅读[SBCL](http://www.sbcl.org)手册[保存核心图像](http://www.sbcl.org/manual/#Saving-a-Core-Image)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-26T15:21:54.940

几种语言实现使用“图像”来存储当前上下文中的“所有内容”。这个图像可能有几个编译的抽象层（即一个中间解析级别、一个中间字节码、本机操作码）。加载此图像将比编译所有源文件快得多。在程序级别上，它非常类似于休眠功能。

例如，如果您的lisp 实现使用图像，那么首先您（或编译器供应商将）引导图像并保存它。

然后你有两个选择：（1）每次调用 lisp 时加载你的 lisp 文件，或者（2）加载你所有的 lisp，保存图像，然后使用这个图像

希望有帮助

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-27T11:56:57.053

通常，它是 lisp 进程的存储部分（即所有“lisp”函数和数据），但不是底层 lisp 二进制文件的任何部分。从好的方面来说，这提供了快速启动，因为（基本上）在加载图像时不需要进行簿记，一切都在那里。另一方面，这意味着任何打开的文件、套接字和你所拥有的东西都丢失了，因此将图像保存为某种检查点需要一些实现才能使其工作。

# algorithm - 我应该对算法使用递归还是记忆？

> ID：480093
> 
> 赞同：12
> 
> 时间：2009-01-26T15:11:28.533
> 
> 标签：algorithm, recursion, memoization

如果我可以选择使用递归或记忆来解决我应该使用的问题？换句话说，如果它们都是可行的解决方案，因为它们提供了正确的输出并且可以在我正在使用的代码中合理地表达，那么我什么时候会使用一个而不是另一个呢？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-26T15:17:03.000

它们不是相互排斥的。你可以同时使用它们。

就个人而言，我会先构建基本递归函数，然后添加记忆，作为优化步骤。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-26T15:30:28.277

使用的经验法则是基于子问题的**重叠量。**如果您正在计算斐波那契数（经典递归示例），那么如果您使用递归，则会进行很多不必要的重新计算。

比如计算F(4)，我需要知道F(3)和F(2)，所以我通过计算F(2)和F(1)来计算F(3)，以此类推。如果我使用递归，我只需计算 F(2) 和大多数其他 F(n) 两次。如果我使用 memoization，我可以查找值。

如果您正在执行二进制搜索，则子问题之间没有重叠，因此递归是可以的。在每一步将输入数组分成两半会产生两个唯一的数组，它们代表两个没有重叠的子问题。在这种情况下，记忆不会有好处。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-26T15:14:14.393

递归具有与创建堆栈帧相关的性能损失，memoization 的损失是结果的缓存，如果性能是一个问题，唯一确定的方法是在您的应用程序中进行测试。

在我个人看来，我会首先使用最容易使用和理解的方法，我认为这是递归。直到你证明需要记忆。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-27T22:53:12.500

记忆化只是一种缓存方法，恰好经常用于优化递归。它不能代替递归。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-26T15:14:42.007

不确定我可以在不知道问题的情况下说。通常你会想要使用*递归*的记忆。尽管如此，如果您实际上可以将它用作替代解决方案，那么记忆化可能比递归快得多。它们都有性能问题，但随着问题的性质/输入的大小而有所不同。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-26T15:15:21.850

我选择 memoization 是因为它通常可以访问比堆栈内存更多的堆内存。

也就是说，如果您的算法在大量数据上运行，那么在大多数语言中，在您用完堆保存数据的空间之前，您将用完递归的堆栈空间。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-09T23:57:33.830

我相信您可能会将[记忆](http://en.wikipedia.org/wiki/Memoization)化（正如其他人所指出的那样，递归算法的优化策略）与[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)（*模拟*递归解决方案但实际上不使用递归）混淆。如果这是您的问题，我会说这取决于您的优先级：高运行时效率（动态编程）或高可读性（记忆，因为问题的递归解决方案仍然存在于代码中）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-26T15:16:44.560

这取决于你要做什么。动态编程（记忆）几乎总是更快。通常很多。（即三次方到平方，或指数到多边形），但根据我的经验，递归更容易阅读和调试。

话又说回来，很多人像瘟疫一样避免递归，所以他们觉得它不容易阅读......

另外，（第三手？）我发现在提出递归解决方案之后最容易找到动态解决方案，所以我最终都做了。但如果您已经拥有这两种解决方案，Dynamic 可能是您最好的选择。

我不确定我是否有帮助，但你去吧。与算法选择的许多事情一样，YMMV。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-26T15:19:32.917

如果你的问题是递归问题，除了递归你还有什么选择？

您可以使用记忆以短路的方式编写递归函数，以获得第二次调用的最大速度。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-13T16:17:47.560

我不同意 Tomalak 的断言，即对于递归问题，你别无选择，只能递归？

最好的例子就是上面提到的斐波那契数列。在我的计算机上，F(45) 的递归版本（F 表示斐波那契）需要 15 秒来进行 2269806339 次加法，迭代版本需要 43 次加法并在几微秒内执行。

另一个著名的例子是河内塔。在您上完该主题的课程之后，似乎递归是解决该问题的唯一方法。但即使在这里也有一个迭代解决方案，尽管它不像递归解决方案那么明显。即便如此，迭代速度更快，主要是因为不需要昂贵的堆栈操作。

如果您对塔的非递归版本感兴趣，这里是 Delphi 源代码：

```
procedure TForm1.TowersOfHanoi(Ndisks: Word);
var
  I: LongWord;
begin
  for I := 1 to (1 shl Ndisks) do
    Memo1.Lines.Add(Format('%4d: move from pole %d to pole %d',
      [I, (I and (I - 1)) mod 3, (I or (I - 1) + 1) mod 3]));
  Memo1.Lines.Add('done')
end; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-26T15:20:46.720

如果可以使用尾递归技术解决问题，则递归不需要使用大量堆栈空间。如前所述，取决于问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-26T15:50:25.413

在通常情况下，您面临两个有助于您做出决定的标准：

*   运行
*   可读性

递归代码通常速度较慢，但​​可读性更高（并非总是如此，但最常见的是。正如所说，如果您的语言支持尾递归，它会有所帮助 - 如果不支持，那么您无能为力）。

递归问题的迭代版本通常在运行时更快，但代码很难理解，因此很脆弱。

如果两个版本具有相同的运行时间和相同的可读性，则没有理由选择其中一个。在这种情况下，您必须检查其他事项：此代码会更改吗？怎么保养？您对递归算法感到满意还是它们让您做噩梦？

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-09T20:19:42.967

```
var memoizer = function (fund, memo) {
    var shell = function (arg) {
        if (typeof memo[arg] !== 'number') {
            memo[arg] = fund(shell, arg);
        }
        return memo[arg];
    };
    return shell;
};

var fibonacci = memoizer(function (recur, n) { return recur(n - 1) + recur(n - 2); }, [0, 1]); 
```

两者都用！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-02-20T01:02:19.223

将两者结合起来。通过使用记忆优化您的递归解决方案。这就是记忆的意义所在。用于使用内存空间来加速递归。

# c# - 绑定到 XmlDataProvider 时，如何在 WPF DataGrid 中创建新行？

> ID：480098
> 
> 赞同：13
> 
> 时间：2009-01-26T15:13:31.027
> 
> 标签：c#, wpf, wpftoolkit, xmldataprovider

我有一个 XmlDataProvider 绑定到 WPF DataGrid 控件的项目。我在 DataGrid 上设置了如下绑定：

```
<dg:DataGrid ItemsSource="{Binding Source={StaticResource XmlData}, XPath=Root/People/Person}"
             AutoGenerateColumns="False">
    <dg:DataGrid.Columns>
        <dg:DataGridTextColumn Header="ID" Binding="{Binding XPath=ID}"/>
        <dg:DataGridTextColumn Header="Name" Binding="{Binding XPath=Name}"/>
    </dg:DataGrid.Columns>
</dg:DataGrid> 
```

用户可以毫无问题地使用 DataGrid 编辑条目。我无法完成的是允许用户使用 DataGrid 添加一个新行（即一个新人）。我怎么能允许这个？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-07-05T00:37:05.193

确保您设置：`CanUserAddRows="True"`并且绑定类的默认构造函数可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-06T16:32:56.303

若要将行添加到绑定到 XmlDataSource 的 WPF DataGrid，您需要直接修改支持数据存储。您可以使用 DataGrid 从用户那里收集新的行信息，然后在**RowEditEnding**事件中，您可以将行的信息添加到您的后备存储中，并防止 DataGrid 实际尝试使用其内部逻辑提交编辑。由于 DataGrid 绑定到 XmlDataSource，它将显示您对后备存储所做的更改。

这是一般的想法：

```
private void MyDataGrid_RowEditEnding(object sender, DataGridRowEditEndingEventArgs e)
{
  if (e.EditAction == DataGridEditAction.Cancel)
  {
    e.Cancel = false;
    return;
  }

  if (e.EditAction == DataGridEditAction.Commit)
  {
    DataGridRow dgr = e.Row;
    XmlElement xe = myXmlDataProvider.Document.CreateElement("NewRowElement");
    foreach(DataGridCell cell in dgr.Cells)
    {
      xe.SetAttribute(cell.Name, cell.Value);
    }
    dataProvider.Document.DocumentElement.AppendChild(xe);
    e.Cancel = true;
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-25T16:32:15.713

是用户无法添加行的问题，还是当用户添加行时，它没有保存到支持的 XML 存储中？我可以轻松地将带有 CanUserAddRows="True" 的数据网格添加到 WPF 应用程序，将网格绑定到内存列表，然后让用户添加反映在该内存列表中的行。这让我觉得你的问题是保存到后备商店。

当我绑定到文件系统上的 XML 时，我无法再将记录添加到数据网格中。我认为您将需要一个较小的解决方法，因为您将文件读入内存中的集合，绑定到该集合，然后在用户添加行时相应地更新文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-31T22:57:17.463

您是否尝试过在 DataGrid 上设置 CanUserAddRows="True"？

# .net - .net 中 Java 的“LookingAt()”的等价物？

> ID：480099
> 
> 赞同：3
> 
> 时间：2009-01-26T15:13:38.810
> 
> 标签：.net, regex

Java 有一个名为“LookingAt()”的正则表达式函数，它允许对模式进行部分匹配，我的问题是：

.net 是否有“LookingAt()”的等价物？

我可能会也可能不会将它用于 KeyPress 验证，但我只是想知道以供将来参考。

提前致谢

乔恩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T04:58:51.017

我认为这不是`lookingAt()`您尝试做的正确模型。它所做的只是将匹配锚定到输入的开头，就好像您在`^`正则表达式的开头使用了开始锚并调用`find()`了 ，这在.NET 中模拟起来很简单。

我认为您要做的是防止用户输入无效数据。例如，如果文本字段需要带两位小数的十进制数，则您的验证正则表达式可能是`\d+\.\d\d`. 如果用户从输入数字开始，则正则表达式不匹配，但数字*可能*是有效条目的一部分，因此您让他们继续输入。但是，如果用户键入“z”，您会阻止它，因为它不可能成为有效条目的一部分。

换句话说，你不想知道正则表达式是否匹配字符串的一部分，你想知道字符串是否匹配正则表达式的一部分。在 Java 中有一种方法可以做到这一点，使用该`hitEnd()`方法，但我认为 .NET 没有与之等效的方法。事实上，我不知道有任何其他正则表达式。

但在我看来，无论如何阻止用户的按键都是相当粗鲁的。我更愿意通过其他方式让他们知道他们的输入无效。例如，您可以将文本字段的内容显示为红色，或者禁用他们用来提交条目的按钮（或两者都禁用）。每次文本字段发生变化时，您都会根据（完整）正则表达式检查内容并相应地更新字段和/或按钮的状态。

这是演示`hitEnd()`：

```
import java.util.regex.*;

public class Test
{
  public static void main(String[] args) throws Exception
  {
    Pattern p = Pattern.compile("\\d+\\.\\d\\d");
    Matcher m = p.matcher("");
    String[] tests = { "5.99", "5", "@" };
    for (String s : tests)
    {
      if (m.reset(s).matches())
      {
        System.out.println("full match");
      }
      else if (m.hitEnd())
      {
        System.out.println("partial match");
      }
      else 
      {
        System.out.println("no match");
      }
    }
  }
} 
```

第一个字符串得到“完全匹配”，第二个得到“部分匹配”，第三个得到“不匹配”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T15:18:34.400

这可能与您的情况无关，但通常这不是一个好主意，因为某些语言通常需要组合键来输入字符：“â”通常通过键 ^ 和 a 键入。如果您只想允许字母数字键并希望包含 â，则如果您不允许 ^，您可能会阻止它们输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T16:28:09.207

这是我用来使用正则表达式检查电子邮件地址的一些代码。我不确定这是否是您要找的东西？

```
Regex emailregex = new Regex("(?<user>[^@]+)@(?<host>.+)");
        string s = "email@address.com";

        Match m = emailregex.Match(s);

        if (m.Success)
        {

        do something here

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T15:38:53.423

您可以使用 javascript 禁用密钥。您只需找到要禁用的键的 keyCode 即可禁用键盘上的 return 或 enter 键。

//该函数禁用回车键，使用户无法输入一堆空格。函数 kH(e) { var pK = e ? e.which : window.event.keyCode; 返回 pK != 13; } document.onkeypress = kH; if (document.layers) document.captureEvents(Event.KEYPRESS);

这是一个列出所有键盘键码的页面。13 用于输入键，因此在此功能中，我允许所有键 != 到 13

[http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001686.html](http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001686.html)

# vb.net - 如何以编程方式确定 VB 应用程序日志的位置？

> ID：480108
> 
> 赞同：2
> 
> 时间：2009-01-26T15:15:00.337
> 
> 标签：vb.net, logging

我正在改造旧的 vb.net 应用程序，使其符合 Vista 中的 LUA 原则。到目前为止，该应用程序使用了各种日志记录机制，但核心机制涉及将日志写入 c:\temp\（如果文件夹存在）。我想用更标准的日志记录机制替换当前的日志记录。

这是 VB，我决定尝试`My.Application.Log`与 app.config 一起使用，并且尽可能地工作（尽管我没想到它会转储到漫游配置文件）。不幸的是，用户习惯于使用日志中的信息进行故障排除，以及在提交错误时发送日志，并且移动此日志可以很好地隐藏它。

我的想法是通过在应用程序的 UI 中添加指向它的链接，或者至少添加到包含它的文件夹，使日志更易于访问。但是，我不知道如何确定该链接将指向何处。

编辑（添加信息）：

我的配置文件或多或少是内置默认值：

```
<system.diagnostics>
    <sources>
        <source name="Error Log" switchName="DefaultSwitch">
            <listeners>
                <add name="FileLog"/>
            </listeners>
        </source>
    </sources>
    <switches>
        <add name="DefaultSwitch" value="Information" />
    </switches>
    <sharedListeners>
        <add name="FileLog"
             type="Microsoft.VisualBasic.Logging.FileLogTraceListener, Microsoft.VisualBasic, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL"
             initializeData="FileLogWriter"/>
    </sharedListeners>
</system.diagnostics> 
```

我想在配置文件中的 FileLogTraceListener 上设置一些属性。MaxSize，例如（有一个先前的最大尺寸行为）。不过，我没有看到任何说明这一点的文档。[（ FileLogTraceListener 页面](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.logging.filelogtracelistener(VS.80).aspx)底部有一些社区内容表明我应该能够，所以我会检查一下。不过，如果我找到一些官方记录的支持，我会更舒服。）

如果我这样做，我应该能够遍历跟踪侦听器集合`My.Application.Log`并链接到第一个 FileLogTraceListener 的 FullLogFileName。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T15:36:13.727

解决方案是使用[`Microsoft.VisualBasic.Logging.FileLogTraceListener`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.logging.filelogtracelistener(VS.80).aspx). 此跟踪侦听器支持通过其属性检索完整日志路径[`FullLogFileName`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.logging.filelogtracelistener.fulllogfilename(VS.80).aspx)以及通过该属性自定义位置[`Location`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.logging.filelogtracelistener.location(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T15:37:19.823

我相信这是可配置的。它可以在 machine.config 文件中配置，或者您可以在您的应用程序配置文件中覆盖它 - 您将希望这样做，以便您可以控制它并创建指向它的链接。

您将需要`FileLogTraceListener`在 app.config 中添加一个。

它进入该`system.diagnostics\sharedListeners`部分。您可以在`initializeData`属性中指定文件名。

来自 MSDN 的更多文档：

*   [在 Visual Basic 中使用应用程序日志](http://msdn.microsoft.com/en-us/library/3tbf1bh0(VS.80).aspx)
*   [演练：确定 My.Application.Log 写入信息的位置](http://msdn.microsoft.com/en-us/library/7fx0fexe(VS.80).aspx)
*   [演练：更改 My.Application.Log 写入信息的位置](http://msdn.microsoft.com/en-us/library/5cz98azz(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T15:16:24.560

一种可能性可能是`My.Application.Log`完全跳过并直接进入`System.Diagnostics.TraceListener`s。我可以这样选择我自己的日志文件夹，我肯定会知道它的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T15:47:32.470

我喜欢使用内置的 Trace 对象进行日志记录。此外，如果您需要保留使用临时文件的旧行为，请查看`System.IO.Path.GetTempFileName()`.

# ruby - 如何找到我的 Ruby 应用程序中的性能瓶颈？

> ID：480109
> 
> 赞同：5
> 
> 时间：2009-01-26T15:15:11.210
> 
> 标签：ruby, performance, profiling

我编写了一个 Ruby 应用程序，它从不同格式的 html、xml 和 csv 文件中解析大量数据。如何找出代码的哪些区域花费的时间最长？

有没有关于如何提高 Ruby 应用程序性能的好资源？或者您是否有始终遵循的性能编码标准？

例如，您是否总是将您的字符串与

```
output = String.new
output << part_one
output << part_two
output << '\n' 
```

或者你会用

```
output = "#{part_one}#{part_two}\n" 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-26T15:32:12.173

好吧，有一些众所周知的做法，例如字符串连接比“#{value}”慢得多，但是为了找出脚本在哪里消耗了大部分时间或超过了所需时间，您需要进行分析。有一种名为 ruby​​-prof 的红宝石宝石。分析器甚至可以让您注意到那些可能很少发生的性能问题。我一直在使用它，发现它很有帮助。[以下是直接来自其官方网站](http://ruby-prof.rubyforge.org/)的一些信息

> ruby-prof 是一个快速的 Ruby 代码分析器。其特点包括：
> 
> **速度**——它是一个 C 扩展，因此比标准的 Ruby 分析器快很多倍。
> 
> **模式**- Ruby prof 可以测量许多不同的参数，包括调用时间、内存使用和对象分配。
> 
> **报告**- 可以生成文本和交叉引用的 html 报告
> 
> **Flat Profiles** - 类似于标准 Ruby 分析器生成的报告
> 
> **图形配置文件**- 类似于 GProf，它们显示方法运行多长时间、哪些方法调用它以及它调用哪些方法。
> 
> **调用树配置文件**- 以适合 KCacheGrind 分析工具的调用树格式输出结果。
> 
> **线程**- 支持同时分析多个线程
> 
> **递归调用**- 支持分析递归方法调用

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T15:20:14.087

字符串连接的答案在这里：[https ://web.archive.org/web/20090122123342/http://blog.cbciweb.com/2008/06/10/ruby-performance-use-double-quotes-vs -单引号](https://web.archive.org/web/20090122123342/http://blog.cbciweb.com/2008/06/10/ruby-performance-use-double-quotes-vs-single-quotes)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T15:37:21.430

[您可以使用标准Benchmark 模块](http://www.ruby-doc.org/stdlib/libdoc/benchmark/rdoc/classes/Benchmark.html)测试各个代码部分的性能。

您还可以在 Ruby 的不同实现（例如 1.9，Rubinius）上测试您的代码，看看这是否加快了速度。

当然，如果您的问题本质上是算法问题，那么担心字符串连接速度之类的问题就没有太多意义了......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-27T14:37:28.460

除了上面写的内容，我还建议观看[Scaling Ruby](http://envycasts.com/products/scaling-ruby)截屏视频。它有一些关于如何编写更快的 Ruby 代码的有趣提示和技巧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T15:50:56.927

还有一组用于 Ruby 的 dTrace 工具，您可以在 dTraceToolkit 中使用

# c# - 中继器控件 - 如何每 x 行添加到项目模板？

> ID：480118
> 
> 赞同：0
> 
> 时间：2009-01-26T15:17:07.197
> 
> 标签：c#, user-controls

我有一个输出一些 HTML 的中继器控件。我想要一个输出 4 列然后开始新行的表（每列将是数据集中的下一项）。

我可以使用内联语句来做到这一点：

```
<%  if ((i + 1) % 4 == 0 && i > 0)
                { //5 items per row%>
            </tr>
            <% } %> 
```

但我似乎无法在中继器控件中初始化 i 。有任何想法吗？

我正在使用转发器控件，因为我已经实现了分页，因为由于我显示内容的方式，gridview 不合适。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T15:23:28.197

根据您正在查看的确切内容，您可以使用存在的计数器并在每个循环上更新它，处理转发器控件的“ItemDataBound”事件。但是，确定“最后一个”条目会有点困难，但可能。

但是，我认为更适合您的选择是使用 DataList 而不是中继器，因为数据列表可以自动呈现 4 列，并且它将为您处理所有 HTML 呈现。

# apache - Apache 正在侦听不同的端口，但我如何得到它，这样我就不必输入端口号了？

> ID：480140
> 
> 赞同：1
> 
> 时间：2009-01-26T15:23:53.593
> 
> 标签：apache, port-number

我在我的 localhost 机器上并行运行 IIS 和 Apache HTTP Server，而 Apache 正在侦听不同的端口（端口 81）。IIS 正在侦听端口 80。但是，如果我输入该端口号，我只能访问我的 Apache 虚拟域。例如：

[http://virtual.myvirtualdomain.com:81](http://virtual.myvirtualdomain.com:81) [http://virtual.myvirtualdomain2.com:81](http://virtual.myvirtualdomain2.com:81)

我怎样才能让 Apache 自动知道它是端口 81，并且不强迫我输入端口号？

**编辑：**

答案似乎是我需要将 IIS 重定向到 Apache。谁能提供有关如何使用 IIS 5.1 完成的说明？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T15:26:11.360

这不是告诉 Apache 的问题，而是浏览器知道要连接什么的问题。您要么必须将 IIS 重定向到 Apache，要么放弃。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T15:26:16.820

您必须输入端口号，以便您的**客户端**知道连接到哪里。这与服务器无关。

在 Unix 系统上，您可以修改您`/etc/services`的列表 81 作为 http 的端口。但这将有效地禁用对位于端口 80 上的所有网站的访问。

或者，您可以在端口 80 上配置 IIS，以在本地代理 apache 上站点的请求。然后所有客户端都会向 IIS 请求一个页面，该页面将与端口 81 建立本地连接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T15:53:02.990

我做了更多研究，结果发现您不能将 IIS 5.1 重定向到 Apache，因为这需要多个网站（设置为重定向到端口 81 上 Apache 上的虚拟主机）。这是因为 Windows XP Pro 上的 IIS 5.1 不能处理多个网站（同时运行而无需脚本破解）。那好吧。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T16:10:41.800

你换一下怎么样？让 Apache 在端口 80 上侦听，IIS 在端口 81 上侦听您需要的任何内容并让 Apache 重定向？Apache 不应该被限制在与 IIS 5.1 相同的每台机器上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T15:26:23.760

你不能。81 告诉您的浏览器在哪里寻找 Apache。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T15:26:53.150

你不能。

指定端口是您的 Web*客户端*的工作，在您指定该端口之前，它甚至不会到达 Apache。

您可能会做的是让 IIS 也侦听相同的 HTTP/1.1 虚拟主机，然后安排它发出`302 Moved`重定向以将您的浏览器发送到正确的端口号。

或者，在您的计算机上运行第二个 IP 地址，并将 IIS 绑定到原始 IP 地址，将 Apache 绑定到第二个。这样，您根本不需要使用不同的端口。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-26T15:27:15.477

没有办法完全按照你的要求去做。唯一的方法是配置 IIS——对于由 IIS 提供服务的虚拟域——在端口 81 上转发到 Apache。使用这种配置，客户端不会知道他们的请求在去往的途中通过 IIS阿帕奇。效率低一点，但它可以解决您的需求。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-26T17:18:36.890

输入 url 时，浏览器必须使用某个端口连接到站点。80 是服务器检查的默认端口。如果您需要通过浏览器连接到任何其他端口，则需要在 url 中包含端口号。强迫您输入 81 的不是 apache，而是您的浏览器，因为当未指定端口号时，它被设置为使用 80 作为端口。

如果您将 apache 的端口更改为 80 并将 IIS 端口更改为 81，那么您可以在没有端口号的情况下连接到 apache，但在使用 IIS 网络服务器时您需要使用端口号。

不确定使用 apache 重定向到 IIS 背后的其他想法是什么。在我看来，如果您在 apache 的 httpd.conf 中为 IIS 目录创建一个条目，那么您将使用 apache 连接到该目录，而不是 IIS。您可以设置一个域并让它通过端口 81 连接到 apache。这是隐藏端口号的一种方法（可能不是真的。我从未在 80 以外的端口上尝试过 apache）。

# css - 寻找完善的 XHTML/CSS/JSP2 规范/最佳实践的参考

> ID：480142
> 
> 赞同：2
> 
> 时间：2009-01-26T15:24:51.720
> 
> 标签：css, jsp, xhtml

我的任务是为 XHTML 和 CSS 编写规范/最佳实践。

有人会有一些好的参考吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T09:30:09.220

*   [这是编写合理的 XHTML 代码的一个很好的介绍。](http://www.graphicrating.com/2008/11/29/xhtml-best-practices/)
*   这是关于标签最佳实践的[另一个问题。](https://stackoverflow.com/questions/275631/html-head-best-practices)`<head>`
*   阅读 XHTML[规范](http://www.w3.org/TR/xhtml1/)是获得大量最佳实践的好方法。
*   国际化和语言编码也是最佳实践，请参见[此处](http://www.w3.org/TR/i18n-html-tech-lang/)。

正如您的问题所暗示的那样 - 没有一个地方可以找到固定的最佳实践，而是网络上的许多地方可以为您提供一些智慧的宝石。此外，没有什么比真正的体验和查看其他人的代码更好的了。我从查看许多免费/开源 XHTML 模板中学到了很多东西——比如[这些](http://www.oswd.org/).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T17:55:19.047

不管用于生成 XHTML 和 CSS 的技术如何，我都推荐这些 XHTML/CSS 资源......

*   [一个列表分开](http://alistapart.com)
*   [站点点 CSS](http://reference.sitepoint.com/css)
*   [Opera 开发者文章](http://dev.opera.com/articles/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-01T17:20:04.130

看看[创建性感的样式表](http://thinkvitamin.com/features/design/creating-sexy-stylesheets)、[xhtml.com](http://xhtml.com/en/xhtml/reference/)和[W3 Schools](http://w3schools.com)。

# .net - 在 Linq to SQL 查询中设置非列属性值

> ID：480152
> 
> 赞同：0
> 
> 时间：2009-01-26T15:26:29.643
> 
> 标签：.net, linq-to-sql

有没有办法在查询中设置不是由 Linq to SQL 设计器生成的属性（不是数据库中的列）？

例如有没有像 SomeMethod() 这样的方法：

```
IQuaryable<T> query = (from t in context.MyTable
                      where {some conditions}
                      select t).SomeMethod("MyPropertyName", value); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-02T02:29:10.637

就像是

```
var query = (from t in context.MyTable
                  where {some conditions}
                  select new {t, MyPropertyName = value }); 
```

我不确定这是否是您要问的。

# java - 如何修改 HttpUrlConnection 的标头

> ID：480153
> 
> 赞同：26
> 
> 时间：2009-01-26T15:26:52.310
> 
> 标签：java, http, http-headers, httpurlconnection

我试图稍微改进 Java Html 文档，但我遇到了`HttpUrlConntion`. 一件事是，如果用户代理是 Java VM，某些服务器会阻止请求。另一个问题是`HttpUrlConnection`没有设置`Referrer`or`Location`头字段。由于几个站点使用这些字段来验证内容是从他们自己的站点访问的，因此我也被阻止在这里。据我所知，唯一的解决方案是替换 HTTP 协议的 URL 处理程序。或者有什么办法可以修改默认的 HTTP Handler？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-26T15:39:07.010

用. `URL`_ `URL.openConnection`可选择转换为`HttpURLConnection`. 呼叫`URLConnection.setRequestProperty`/ `addRequestProperty`。

默认的 User-Agent 标头值是从`"http.agent"`系统属性中设置的。PlugIn 和 WebStart 允许您设置此属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T16:31:36.390

如果您使用[Apache HttpClient](http://hc.apache.org/httpclient-3.x/)来管理您的编程 HTTP 连接，您将获得一个非常有用的 API，它可以创建连接（以及可选的失败时自动重新连接）、设置标题、帖子与获取、检索返回内容的便捷方法等等.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-10T05:01:10.207

我解决了我的问题。我们可以将标头发送到 application/json 并将正文作为 json 对象传递。这简单地解决了问题。

# .net - 如何判断拖放是否已在 Winforms 中结束？

> ID：480156
> 
> 赞同：10
> 
> 时间：2009-01-26T15:27:36.147
> 
> 标签：.net, winforms

我怎么知道拖放已经结束了 WinForms .net。当拖放正在进行时，我需要阻止我的表单的一部分刷新它的数据视图。

我尝试过使用标志，但我似乎没有捕获所有我需要的事件，以使标志与拖放的进度保持同步。具体来说，我无法判断拖放操作何时结束而没有完成拖放，即当用户将项目放置在允许 drop = false 的控件上时，或者当用户按下 ESC 键时。

我看过这个问题：-

[检查是否正在进行拖放](https://stackoverflow.com/questions/373873/check-if-a-dragdrop-is-in-progress)

但这并不能令人满意地解决我的问题（如果有人给我这个问题的答案，我会用我已经拥有的答案来回答那个问题）。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-26T19:21:24.393

我没有接受者，最终想通了。

答案是监视 QueryContinueDrag 事件。此事件在拖放操作期间不断触发。QueryContinueDragEventArgs 包含枚举类型 DragAction 的 Action 属性，该属性可以是 DragAction.Cancel、DragAction.Drop 或 DragAction.Continue。它是一个读/写属性，以允许您更改标准行为（我们不需要这个）。

此示例代码假定 DragDropInProgress 标志在拖放开始时设置，并在拖放成功完成时重置。它捕捉到 DragDrop 结束，因为用户在没有经过拖放目标（拖放目标是 MyControl1 和 MyControl2）的情况下松开鼠标或取消了拖放。如果您不关心 DragDropInProgressFlag 是否在 DragDrop 事件触发之前被重置，您可以省去命中测试而只需重置标志。

```
Private Sub MyControl_QueryContinueDrag(ByVal sender As Object, ByVal e As System.Windows.Forms.QueryContinueDragEventArgs) Handles MyControl.QueryContinueDrag

    Dim MousePointerLocation As Point = MousePosition

    If e.Action = DragAction.Cancel Then '' User pressed the Escape button
        DragDropInProgressFlag = False
    End If

    If e.Action = DragAction.Drop Then
        If Not HitTest(new {MyControl1, MyControl2}, MousePointerLocation) Then
            DragDropInProgressFlag = False
        End If
    End If

End Sub

Private Function HitTest(ByVal ctls() As Control, ByVal p As Point) As Boolean

    HitTest = False

    For Each ctl In ctls
        Dim ClientPoint As Point = ctl.PointToClient(p)
        HitTest = HitTest Or (ClientPoint.X >= 0 AndAlso ClientPoint.Y >= 0 AndAlso ClientPoint.X <= ctl.Width AndAlso ClientPoint.Y <= ctl.Height)
        If HitTest Then Exit For
    Next

End Function 
```

在此示例中，HitTest 是一个 rountine，它采用鼠标位置（屏幕坐标）和控件数组，如果鼠标位置在任何控件矩形中，则通过传递 True 的数组进行筛选。

# database - 用于删除的 Sybase 游标

> ID：480158
> 
> 赞同：1
> 
> 时间：2009-01-26T15:27:45.520
> 
> 标签：database, sybase

在sybase中，使用游标可以删除当前引用的行吗？如果是这样，光标最终会引用什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T15:36:16.533

来自 manuals.sybase.com -[使用游标更新和删除行](http://preview.tinyurl.com/c83mya)：

使用 delete 语句的 where current of 子句，可以删除当前光标位置的行。当您从游标的结果集中删除一行时，该行将从基础数据库表中删除。使用光标一次只能删除一行。

从游标中删除一行后， Adaptive Server 将游标定位在游标结果集中已删除行之后的行之前。您仍然必须使用 fetch 来访问下一行。如果删除的行是游标结果集中的最后一行，则 Adaptive Server 将游标定位在结果集的最后一行之后。

# asp.net - ASP.NET - 在另一台机器上运行 bat 脚本

> ID：480160
> 
> 赞同：1
> 
> 时间：2009-01-26T15:28:45.190
> 
> 标签：asp.net, scripting, batch-file

我想从我的 asp.net 应用程序在域中的一台机器上运行一个 bat 脚本。带有批处理脚本的机器是临时存储机器，脚本将它与永久存储机器同步。那么，这样做的最佳方法是什么？

我尝试的是使用[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)在远程机器上运行脚本。我创建了一个进行 PsExec 调用的进程，它实际上做得很好。但是，由于 ASP.NET 工作线程在具有受限权限的 ASP.NET 帐户下运行，我必须在 PsExec 调用中对我的域用户凭据进行硬编码，这是我不喜欢做的事情。

有没有办法克服这个问题，或者我可以尝试其他一些方法？

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T15:41:27.257

您可以使用 Web.config 中的 <identity impersonate="true" /> 设置来让应用程序在 IUSR 下运行，或者您可以将身份标签上的用户名/密码设置为您想要使用的帐户运行 BAT 文件。

我之前在以下位置找到了有关 Impersonate 的一些详细信息：[http ://www.aspdev.org/articles/web.config/](http://www.aspdev.org/articles/web.config/)

但我相信快速的网络搜索会找到更多关于 Impersonate 的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T11:46:04.990

The answer above doesn't work. New processes will be spawned by default under the ASP.NET account.

see [http://support.microsoft.com/kb/889251](http://support.microsoft.com/kb/889251).

"To spawn a process that runs under the context of the impersonated user, you cannot use the System.Diagnostics.Process.Start method. This is because in ASP.NET, impersonation is performed at the thread level and not at the process level. Therefore, any process that you spawn from ASP.NET will run under the context of the ASP.NET worker process and not under the impersonated context."

# c# - TDD：存根、模拟或以上都不是

> ID：480162
> 
> 赞同：4
> 
> 时间：2009-01-26T15:29:02.820
> 
> 标签：c#, tdd, mocking, stub

我正在尝试通过将 TDD 应用于我的一个简单项目来学习它。一些细节（和更早的问题）在这里：

[TDD：帮助编写可测试类](https://stackoverflow.com/questions/473679/tdd-help-with-writing-testable-class)

具体是我有一个 PurchaseOrderCollection 类，它有一个私有的 PurchaseOrders 列表（在构造函数中传递），并且 PurchaseOrders 有一个布尔属性 IsValid。PurchaseOrderCollection 有一个属性 HasErrors，如果列表中的任何 PurchaseOrders 的 IsValid 为 false，则该属性返回 true。这是我要测试的逻辑。

```
[TestMethod]
public void Purchase_Order_Collection_Has_Errors_Is_True_If_Any_Purchase_Order_Has_Is_Valid_False()
{
    List<PurchaseOrder> orders = new List<PurchaseOrder>();

    orders.Add(new PurchaseOrder(--some values to generate IsValid false--));
    orders.Add(new PurchaseOrder(--some values to generate IsValid true--));

    PurchaseOrderCollection collection = new PurchaseOrderCollection(orders);

    Assert.IsTrue(collection.HasErrors);
} 
```

这与我之前的问题类似，因为该测试过于耦合，因为我必须知道使 PurchaseOrder IsValid 为假或真以通过测试的逻辑，而实际上该测试不应该关心。问题是不同的（imo），因为类本身不是问题。

本质上，我希望能够声明一个 IsValid 为 false 或 true 的 PurchaseOrder，而不需要更多地了解 PurchaseOrder 是什么。

根据我有限的 TDD 知识，这是您使用 Stubs 或 Mocks 的目的。我的主要问题，这是正确的吗？或者我应该为此使用不同的方法吗？还是我完全有缺陷，只是在写这个测试并认为它是错误的？

我最初的想法是只使用某种模拟框架并创建一个始终返回 true 或 false 的 PurchaseOrder。从我读过的内容来看，我需要声明 IsValid 虚拟。所以我的第二个想法是更改它以添加 IPurchaseOrder 作为 PurchaseOrder 的接口，并创建一个始终返回 false 或 true 的假 PurchaseOrder。这两个都是有效的想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T15:50:53.743

无论是创建存根还是模拟，您都走在了正确的轨道上。我更喜欢使用 Mocking 框架。

使用模拟框架的工作方式是您希望模拟您的 PurchaseOrder 类，从而抽象出它的实现。然后设置调用 IsValid 的期望，并在调用时返回此值。

[使用Moq](http://code.google.com/p/moq/)的示例，如果您使用的是 C# 3.0 和 .NET Framework 3.5：

```
[TestMethod]
public void Purchase_Order_Collection_Has_Errors_Is_True_If_Any_Purchase_Order_Has_Is_Valid_False()
{    
    var mockFirstPurchaseOrder = new Mock<IPurchaseOrder>();
    var mockSecondPurchaseOrder = new Mock<IPurchaseOrder>();

    mockFirstPurchaseOrder.Expect(p => p.IsValid).Returns(false).AtMostOnce();
    mockSecondPurchaseOrder.Expect(p => p.IsValid).Returns(true).AtMostOnce();

    List<IPurchaseOrder> purchaseOrders = new List<IPurchaseOrder>();
    purchaseOrders.Add(mockFirstPurchaseOrder.Object);
    purchaseOrders.Add(mockSecondPurchaseOrder.Object);

    PurchaseOrderCollection collection = new PurchaseOrderCollection(orders);

    Assert.IsTrue(collection.HasErrors);
} 
```

编辑：
这里我使用了一个接口来创建 PurchaseOrder 的模拟，但你也没有。您可以将 IsValid 标记为虚拟并模拟 PurchaseOrder 类。我的经验法则是什么时候先使用虚拟。只是为了创建一个接口，这样我就可以在没有任何架构原因的情况下模拟一个对象，这对我来说是一种代码味道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T15:49:21.843

> ...这个测试太耦合了，我必须知道什么使 PurchaseOrder IsValid 为假或真才能通过测试的逻辑，而实际上这个测试不应该关心...

我实际上反对相反 - 让您的测试知道有效性在采购订单中被建模为布尔值意味着您的测试对 PurchaseOrder 的实现了解太多（假设它实际上是对 PurchaseOrderCollection 的测试）。我对使用现实世界的知识（即有效或无效的实际值）来创建适当的测试对象没有问题。最终，这就是您要测试的内容（如果我给我的收藏提供了一个价值荒谬的采购订单，它会正确地告诉我有错误吗）。

一般来说，我尽量避免为诸如 PurchaseOrder 之类的“实体”对象编写接口，除非除了测试之外还有其他理由这样做（例如，生产中有多种 PurchaseOrders，而接口是建模的最佳方式） ）。

当测试表明您的生产代码可以设计得更好时，这很棒。但是，*仅仅*为了使测试成为可能而更改您的生产代码并不是那么好。

好像我写的不够多，这里有另一个建议——这就是我在现实生活中实际解决这个问题的方式。

创建一个具有接口的 PurchaseOrderValidityChecker。在设置 isValid 布尔值时使用它。现在创建有效性检查器的测试版本，让您指定要给出的答案。（请注意，此解决方案可能还需要 PurchaseOrderFactory 或用于创建 PurchaseOrders 的等效项，以便在创建每个采购订单时都可以引用 PurchaseOrderValidityChecker。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T16:37:19.547

我最近问了一个关于测试的[类似问题。](https://stackoverflow.com/questions/476540/how-to-properly-mock-and-unit-test)不要忘记这一点：做你需要做的最简单的事情，然后在必要时重构。我个人尽量把大局放在心上，但我也抵制过度设计我的解决方案的冲动。您可以在测试类中添加两个 PurchaseOrder 字段，其中一个有效，一个无效。使用这些字段将您的 PurchaseOrderCollection 置于您想要测试的状态。您最终需要学习如何模拟，但在这种情况下，您不需要大锤，因为普通锤子可以解决问题。通过使用模拟 PurchaseOrder 而不是处于所需状态的具体 PurchaseOrder 不会获得任何价值。

最重要的是，您可以从测试 PurchaseOrderCollection 的行为中获得更多收益，而不仅仅是测试 PurchaseOrderCollection 的状态。在您的测试验证可以将 PurchaseOrderCollection 置于其不同状态之后，更重要的测试是行为测试。通过您认为合适的任何方式（模拟或更新所需状态的具体类）将您的采购订单集合置于有效和无效状态，并测试 PurchaseOrderCollection 的每个状态的逻辑是否正确执行，而不仅仅是 PurchaseOrderCollection只是处于有效/无效状态。

PurchaseOrderCollection 将始终依赖于另一个类，因为它是一个专门的集合。知道 IPurchaseOrder 具有 IsValid 属性与知道具体的 PurchaseOrder 具有 IsValid 属性没有任何不同。我会坚持使用最简单的方法，例如具体的 PurchaseOrder，除非您有充分的理由相信您的系统中会有多种类型的 PurchaseOrder。那时，PurchaseOrder 接口会更有意义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T17:11:54.297

我可能在这里遗漏了一些上下文，但在我看来，您*必须*以示例的方式“耦合”您的测试，否则*您并没有真正测试任何东西*（除了 IsValid 属性，这是微不足道的）。

模拟采购订单一无所获——你测试的是模拟，而不是真正的类

使用存根 - 同样的事情

使用 TDD 时可以进行白盒测试（如果不是强制性的）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-06T20:01:20.013

首先，请记住您正在测试集合，而不是`PurchaseOrder`，所以这就是您的努力所在。这取决于复杂`PurchaseOrder`程度。如果它是一个具有明显行为的简单实体，那么创建实例可能是有意义的。如果它更复杂，那么按照您的描述提取接口是有意义的。

提出的下一个问题是该界面中的内容。集合中的对象需要执行什么角色？也许您只需要知道它们是否有效，在这种情况下您可以提取`IValidatable`并缩小代码中的依赖关系。我不知道在这种情况下什么是真的，但我经常发现我可以使用接口将我推到更专注的代码上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T15:36:27.377

我不是单元测试方面的专家，但这是我过去所做的。如果您有一个可以有效/无效的 PurchaseOder 类，那么我相信您也有针对这些的单元测试，以查看它们是否确实有效。为什么不调用这些方法来生成有效和无效的 PurchaseOrder 对象，然后将其添加到您的集合中？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T16:29:02.120

> 这两个都是有效的想法吗？

是的。

您还可以创建一个可以返回有效和无效 PurchaseOrders 的 Object Mother。

# javascript - 在 PDF 中使用 Javascript 列出 XFA 对象的属性

> ID：480167
> 
> 赞同：4
> 
> 时间：2009-01-26T15:30:54.127
> 
> 标签：javascript, pdf, livecycle-designer, xfa

我正在尝试创建一个包含多个文本字段的 PDF 文档，这些文本字段的高度可以增长到某个最大值。由于项目的限制，我使用的是 Adob​​e Designer 7，它很高兴地允许使用 Javascript。但是，XFA 中的对象与 HTML DOM 或更早的 PDF DOM 略有不同。

因此，我确定我的字段 TextField1 具有某些属性，例如控制高度的“h”。

下面的代码只列出了 TextField1 上的方法，而不是属性：

```
----- form1.Page1.TextField1::exit - (JavaScript, client) -----

for(var i in xfa.form.form1.Page1.TextField1) {
    try {
        console.println(i);
    } catch(e) {}
} 
```

这是为什么？（而且，我该如何修复它以便它*列出*属性？）

与上面的代码非常相似的东西正在工作，但是由于疏忽和非常短的撤消堆栈，我丢失了片段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-06T17:25:00.817

对于如何枚举属性的问题，我没有答案，但您会在此处找到受支持属性的完整列表：

[http://wwwimages.adobe.com/content/dam/Adobe/en/devnet/livecycle/pdfs/Adobe_XML_Form_Object_Model_Reference.pdf](http://wwwimages.adobe.com/content/dam/Adobe/en/devnet/livecycle/pdfs/Adobe_XML_Form_Object_Model_Reference.pdf)

# objective-c - 使用 iPhone SDK 管理可能庞大的照片库的最佳方法

> ID：480177
> 
> 赞同：0
> 
> 时间：2009-01-26T15:34:41.577
> 
> 标签：objective-c, iphone, database-design

我正在开发一个带有产品列表的应用程序。我想让用户为每个产品提供 1 张图片。

现在，问题是下一步该做什么。我认为最好的方法是当用户连接到他们的计算机和 iTunes 时，照片会同步，并从应用程序访问它们（例如：`/photos/catalog/ref1.jpg`.

另一种选择是将它们放在我的 sqlite 数据库中，但我担心它会变得更大。我有数据+图片，数据变化很大但图片很少修改（如果很多，我希望用户每次拍摄2-3张新图片）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T20:13:02.183

我只会使用设备上可用的网络连接，而不用通过 iTunes 进行同步。

当您下载图像时，将它们写入应用程序的 Documents 文件夹，然后从那里加载它们。网络使用与磁盘空间将受到关注。请记住，某些运营商网络对于数据传输来说可能非常昂贵。

如果图像以系统格式命名，那么您可以通过将图像标识符与您的数据进行比较来维护它们，删除旧的或不相关的。

计算一下您认为所有图像的本地副本需要多少磁盘空间。

# python - Python - 所有内置装饰器是什么？

> ID：480178
> 
> 赞同：75
> 
> 时间：2009-01-26T15:34:47.737
> 
> 标签：python, decorator

我知道`@staticmethod`、`@classmethod`和`@property`，但仅通过分散的文档知道。Python 中内置的所有函数装饰器是什么？是在文档中吗？是否在某处维护了最新列表？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-26T15:55:53.937

我不这么认为。装饰器与普通函数没有区别，你只是用一种更花哨的方式来称呼它们。

为了找到所有这些，请尝试搜索[内置函数](http://docs.python.org/library/functions.html)列表，因为正如您在[Python 词汇表](http://docs.python.org/3.0/glossary.html)中看到的，装饰器语法只是一种语法糖，因为以下两个定义创建了相等的函数（从词汇表中复制了这个示例）：

```
def f(...):
    ...
f = staticmethod(f)

@staticmethod
def f(...): 
```

因此，任何返回另一个函数的内置函数都可以用作装饰器。问题是——这样使用它有意义吗？:-)

[functools](http://docs.python.org/library/functools.html)模块包含一些可用作装饰器的函数，但它们不是您要求的内置函数。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-26T16:15:47.843

它们不是内置的，但是[这个](http://wiki.python.org/moin/PythonDecoratorLibrary)示例装饰器库非常好。

正如 Abgan[所说](https://stackoverflow.com/questions/480178/python-is-there-a-list-of-decorators-somewhere#480266)，内置函数列表可能是最好的查看位置。虽然，由于装饰器也可以实现为类，但不能保证它是全面的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T02:57:04.973

装饰器甚至不需要返回一个函数。我以前用过`@atexit.register`。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-01-27T01:20:50.533

没有所有装饰器的列表这样的东西。没有所有功能的列表。没有所有类的列表。

装饰器是一种方便的工具，用于定义跨函数、方法或类的公共方面。有内置的装饰器。此外，还有许多很酷且无用的装饰器。同样，有许多很酷且无用的类。

# asp.net - asp.NET：如何访问中继器生成的元素？

> ID：480195
> 
> 赞同：0
> 
> 时间：2009-01-26T15:37:11.993
> 
> 标签：asp.net, repeater

我有一个中继器而不是创建一个表：

```
<itemtemplate>
   <tr id="theTableRow" runat="server">
      <td>
         <asp:LinkButton runat="server"
            OnClientClick="todo"
            Text="Do Something" />
      </td>
   </tr>
</itemtemplate> 
```

**注：**行`OnClientClick="todo"`。

在最终呈现的代码中，我希望*待办事项*包含对 javascript 函数的调用，传递：

*   生成的表格行的 ID，以及
*   当前绑定对象的属性的 Eval

现在对于一些*伪代码*：

**伪代码1：**

OnClientClick="DoSomething(theTableRow, CromulentGuid); return false;"

**伪代码 2**

OnClientClick="javascript:DoSomething(theTableRow, CromulentGuid); return false;"

**伪代码 3**

OnClientClick="javascript:DoSomething(theTableRow, <%# Eval("CromulentGuid") %>); return false;"

**伪代码 4**

OnClientClick="javascript:DoSomething(<%= theTableRow %>, <%# Eval("CromulentGuid") %>); return false;"

**伪代码 5**

OnClientClick='javascript:DoSomething(<%= Eval(theTableRow) %>, <%# Eval("CromulentGuid") %>); 返回错误；'

无论使用什么 ASP.NET 代码，我都希望呈现的 HTML 是：

```
<tr id="ctl00__itemRepeater_ctl01_theTableRow">
   <td>
      <a 
            onclick="DoSomething('ctl00__itemRepeater_ctl01_theTableRow', '19a149db-5675-4eee-835d-3d78372ca6f9'); return false;"
            href="javascript:__doPostBack('ctl00$itemRepeater$ctl01$ctl04','')">
         Do Something
      </a>
   </td>
</tr> 
```

我也可以：

```
<tr id="ctl00__itemRepeater_ctl01_theTableRow">
   <td>
      <a 
            onclick='DoSomething(&quot;ctl00__itemRepeater_ctl01_theTableRow&quot;, &quot;19a149db-5675-4eee-835d-3d78372ca6f9&quot;); return false;'
            href="javascript:__doPostBack('ctl00$itemRepeater$ctl01$ctl04','')">
         Do Something
      </a>
   </td>
</tr> 
```

**注意：**我可以接受第二种形式，因为我知道它在功能上是相同的，并且 ASP.NET 代码无法生成前者，即使后者可读性较差。

* * *

相关问题：

[ASP.NET：如何从 javascript 访问转发器生成的元素？](https://stackoverflow.com/questions/474584/asp-net-how-to-access-repeater-generated-elements-from-javascript)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T21:06:33.277

更好的解决方案是[将表示逻辑放在业务层](https://stackoverflow.com/questions/481142/asp-net-how-to-pass-multiple-parameters-to-eval#481325)：

**介绍：**

```
<asp:LinkButton runat="server"
     OnClientClick="<%# GetItemClientClick((MySomething)Container.DataItem) %>"
     Text="Do stuff" /> 
```

**商业逻辑**

```
protected string GetItemClientClick(MySomething item)
{
   ...   
   String szOnClientClick = 
      "return DeleteItem(this, "+
          Toolkit.QuotedStr(item.NodeGUID.ToString()) + ", "+
          Toolkit.QuotedStr(GetItemText(item))+");";

   return szOnClientClick;
} 
```

干净多了。更具可读性。更易于维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T15:54:54.280

您可以使用该`OnItemDataBound`事件来更改代码中的每个元素。由于您特别关注 HTML，我可能还建议使用混合控件而不是 asp 控件。例如：

```
<itemtemplate>
   <tr id="theTableRow" runat="server">
      <td>
         <a runat="server"
            onclick="todo(this.parent.parent, '<%# Eval("Property") %>');return false;" >
            Do Something
         </a>
      </td>
   </tr>
</itemtemplate> 
```

这可能不是 100% 完美，因为我只是直接在回复窗口中输入了它，而且我总是在第一次尝试时搞砸了 Eval() 语法，但它应该会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T15:56:39.723

为什么不把JS放在表格行上呢？

```
<tr onClick="DoSomething(this, '<%# Eval("GUIDColumn") %>')"; ><td>
<%# Eval("ColumnText") %>
</td></tr> 
```

这使您可以参考表格行以及您需要的数据。它确实破坏了下级支持，因此 IE6 下的浏览器不会像预期的那样真正工作，但这对于这些天的课程来说几乎是一样的。

另外两种可能性是利用 Datagrid/Gridview 对象和 OnItemDatabound 方面，或者利用 ASP.NET TABLE 控件在代码中构建表，并手动迭代您的数据源。

# web-services - 从 .net 3.5 应用程序调用 WSE 服务

> ID：480200
> 
> 赞同：0
> 
> 时间：2009-01-26T15:38:05.703
> 
> 标签：web-services, wse

我正在尝试从 .net 3.5 应用程序调用 .asmx (WSE) Web 服务。

这可能正确吗？似乎当我添加 Web 引用时，API 与我在 .net 2.0 应用程序中添加引用时完全不同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T15:41:21.657

您可以使用显示的对话框（添加服务引用）中的添加 Web 引用按钮来添加 3.0 之前的样式引用。

默认情况下，当你添加服务引用时，VS 会生成一个使用 WCF 的类。这不是问题，但您可能更愿意坚持旧样式。

顺便说一句，WCF 是 .NET 3.0 及以后的更灵活和统一的通信方法。你应该考虑一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-01T02:44:45.193

如果过时的 WSE 服务使用任何 WS-* 协议，那么您将无法通过使用 Web 引用来调用 is。Visual Studio 2008 或更高版本不支持 WSE。

您可以使用“添加服务引用”使其工作，这将创建一个 WCF 客户端。由于 WSE 实现了某些协议的早期版本，您可能仍然会遇到问题。

# c++ - 当我需要专门化我在模板类中声明的类型名时，我必须使用哪些参数？

> ID：480211
> 
> 赞同：0
> 
> 时间：2009-01-26T15:42:08.957
> 
> 标签：c++, templates

我有一个线程安全向量的模板类：

```
template <class T>
class SharedVector {
    std::vector<T> vect;
    CRITICAL_SECTION cs;
    SharedVector(const SharedVector<T>& rhs) {}
public:
    typedef typename std::vector<T>::size_type SizeType;
    SharedVector();
    void PushBack(const T& value);
    void PopBack();
    SizeType size();
    const T& operator[](int index);
    void erase(int index);
    void Lock(); 
    void Unlock(); 
    virtual ~SharedVector();
}; 
```

然后我想在 TCP 服务器的客户端管理器中使用它，将客户端管理器的一些职责委托给这个向量：

```
class TCPClientManager {
    TCPClientManager(const TCPClientManager&) {}
    TCPClientManager& operator=(const TCPClientManager&) {}
    SharedVector<Connection*> connections;
public:
    TCPClientManager();
    SharedVector<>::SizeType size(); //here is the problem
    void addConnection(const Client&); 
    void breakConnection(int); 
    void deleteConnection(int); 
    void Lock();
    void Unlock();
    ~TCPClientManager();
};

typename SharedVector<>::SizeType TCPClientManager::size() {
    return connections.size();
} 
```

我需要声明检索值的类型。编译器说模板的参数太少。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T15:47:33.920

您必须为 SharedVector 模板提供类型参数：

```
SharedVector<Connection*>::SizeType size(); 
....
SharedVector<Connection*>::SizeType TCPClientManager::size() {
    return connections.size();
} 
```

因为该`Connection*`类型不是 TCPClientManager 中的模板参数，而是显式选择的类型，所以不需要放在`typename`前面`SharedVector<Connection*>::SizeType`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T15:18:34.213

（除了litb，真的）

你应该 typedef 你的容器；即`typedef SharedVector<Connection*> ConnectionPool;`。这将允许您编写`ConnectionPool::size_type`.

注意： container::size() 应该返回 a `container::size_type`，而不是`container::SizeType`。这使得容器与 STL 兼容。出于同样的原因，迭代器类应该是`container::iterator`，添加元素是由`container::push_back(container::value_type const&)`等完成的。

# python - 如何在保留顺序的同时从列表中删除重复项？

> ID：480214
> 
> 赞同：906
> 
> 时间：2009-01-26T15:43:58.483
> 
> 标签：python, list, duplicates, unique

是否有一个内置程序可以从 Python 中的列表中删除重复项，同时保留顺序？我知道我可以使用集合来删除重复项，但这会破坏原始顺序。我也知道我可以像这样滚动自己：

```
def uniq(input):
  output = []
  for x in input:
    if x not in output:
      output.append(x)
  return output 
```

（感谢[unwind](https://stackoverflow.com/users/28169/unwind)提供的[代码示例](https://stackoverflow.com/questions/479897/how-do-you-remove-duplicates-from-a-list-in-python#479921)。）

但如果可能的话，我想利用一个内置的或更 Pythonic 的习语。

相关问题：[在 Python 中，从列表中删除重复项以使所有元素都是唯一的*同时保持顺序*的最快算法是什么？](https://stackoverflow.com/questions/89178/in-python-what-is-the-fastest-algorithm-for-removing-duplicates-from-a-list-so-t)

* * *

## 回答 #1

> 赞同：855
> 
> 时间：2009-01-26T15:47:01.490

在这里你有一些选择：[http ://www.peterbe.com/plog/uniqifiers-benchmark](http://www.peterbe.com/plog/uniqifiers-benchmark)

最快的一个：

```
def f7(seq):
    seen = set()
    seen_add = seen.add
    return [x for x in seq if not (x in seen or seen_add(x))] 
```

为什么分配`seen.add`给`seen_add`而不是仅仅调用`seen.add`？Python 是一种动态语言，解析`seen.add`每次迭代比解析局部变量的成本更高。`seen.add`可能在迭代之间发生了变化，并且运行时还不够聪明，无法排除这种情况。为了安全起见，它必须每次都检查对象。

如果您计划在同一个数据集上大量使用此函数，那么使用有序集可能会更好：http: [//code.activestate.com/recipes/528878/](http://code.activestate.com/recipes/528878/)

*O* (1) 每个操作的插入、删除和成员检查。

（补充一点：`seen.add()`总是返回`None`，所以*`or`*上面的内容只是作为尝试更新集合的一种方式，而不是作为逻辑测试的一个组成部分。）

* * *

## 回答 #2

> 赞同：525
> 
> 时间：2013-06-10T02:47:13.257

最佳解决方案因 Python 版本和环境限制而异：

#### Python 3.7+（以及大多数支持 3.6 的解释器，作为实现细节）：

在 PyPy 2.5.0 中首次引入，并在 CPython 3.6 中作为实现细节采用，在 Python 3.7 中成为语言保证之前，plain`dict`是插入顺序的，甚至比 (也是 CPython 3.5 实现的 C) 更有效`collections.OrderedDict`。因此，到目前为止，最快的解决方案也是最简单的：

```
>>> items = [1, 2, 0, 1, 3, 2]
>>> list(dict.fromkeys(items))  # Or [*dict.fromkeys(items)] if you prefer
[1, 2, 0, 3] 
```

像`list(set(items))`这样将所有工作推到 C 层（在 CPython 上），但由于`dict`s 是插入排序的，`dict.fromkeys`因此不会丢失排序。它比`list(set(items))`（通常需要 50-100% 的时间）慢，但比任何其他保留顺序的解决方案*要*快得多（大约需要[在 listcomp](https://stackoverflow.com/a/480227/364696)[中使用 s 的黑客`set`](https://stackoverflow.com/a/480227/364696)时间的一半）。

**重要提示**：（见下文）的`unique_everseen`解决方案`more_itertools`在惰性和支持不可散列的输入项方面具有一些独特的优势；如果您需要这些功能，这是*唯一*可行的解​​决方案。

#### Python 3.5（以及所有旧版本，如果性能*不重要*）

正如 Raymond[指出的那样](https://stackoverflow.com/a/39835527/336527)，在用 C 实现的 CPython 3.5 中`OrderedDict`，丑陋的列表理解黑客比`OrderedDict.fromkeys`（除非您实际上需要最后的列表 - 即便如此，只有当输入非常短时）。因此，在性能和可读性方面，CPython 3.5 的最佳解决方案`OrderedDict`相当于 3.6+ 使用 plain `dict`：

```
>>> from collections import OrderedDict
>>> items = [1, 2, 0, 1, 3, 2]
>>> list(OrderedDict.fromkeys(items))
[1, 2, 0, 3] 
```

在 CPython 3.4 及更早版本上，这将比其他一些解决方案慢，因此如果分析表明您需要更好的解决方案，请继续阅读。

#### Python 3.4 及更早版本，如果性能至关重要且第三方模块可接受

正如[@abarnert 所](https://stackoverflow.com/a/19279812/1219006)指出的，[`more_itertools`](https://pythonhosted.org/more-itertools/api.html)库 ( `pip install more_itertools`) 包含一个[`unique_everseen`](https://pythonhosted.org/more-itertools/api.html#more_itertools.unique_everseen)用于解决此问题的函数，而列表解析中没有任何**不可读**的( `not seen.add`)**突变**。这也是最快的解决方案：

```
>>> from more_itertools import unique_everseen
>>> items = [1, 2, 0, 1, 3, 2]
>>> list(unique_everseen(items))
[1, 2, 0, 3] 
```

只需一个简单的库导入，无需任何技巧。

该模块正在调整 itertools 配方[`unique_everseen`](https://docs.python.org/3/library/itertools.html#itertools-recipes)，如下所示：

```
def unique_everseen(iterable, key=None):
    "List unique elements, preserving order. Remember all elements ever seen."
    # unique_everseen('AAAABBBCCDAABBB') --> A B C D
    # unique_everseen('ABBCcAD', str.lower) --> A B C D
    seen = set()
    seen_add = seen.add
    if key is None:
        for element in filterfalse(seen.__contains__, iterable):
            seen_add(element)
            yield element
    else:
        for element in iterable:
            k = key(element)
            if k not in seen:
                seen_add(k)
                yield element 
```

但与`itertools`配方不同的是，它支持不可散列的项目（以性能为代价；如果其中的所有元素`iterable`都是不可散列的，则算法变为`O(n²)`，而`O(n)`如果它们都是可散列的）。

**重要说明**：与这里的所有其他解决方案不同，`unique_everseen`可以懒惰地使用；峰值内存使用量将是相同的（最终，底层`set`增长到相同的大小），但如果您不确定`list`结果，您只需对其进行迭代，您将能够处理发现的独特项目，而不是等到整个输入都被删除后才处理第一个唯一项目。

#### Python 3.4 及更早版本，如果性能至关重要*且*第三方模块不可用

你有两个选择：

1.  [将`unique_everseen`配方](https://docs.python.org/3/library/itertools.html#itertools-recipes)复制并粘贴到您的代码中，并按照`more_itertools`上面的示例使用它

2.  使用丑陋的 hack 允许单个 listcomp 检查和更新 a`set`以跟踪所看到的内容：

    ```
    seen = set()
    [x for x in seq if x not in seen and not seen.add(x)] 
    ```

    以依赖**丑陋的黑客**为代价：

    ```
     not seen.add(x) 
    ```

    这依赖于这样一个事实，`set.add`即始终返回的就地方法，`None`因此`not None`计算结果为`True`.

请注意，上述*所有*解决方案都是`O(n)`（除了调用`unique_everseen`不可散列项的可迭代项，即`O(n²)`，而其他解决方案会立即失败 a `TypeError`），因此当它们不是最热门的代码路径时，所有解决方案都具有足够的性能。使用哪一个取决于您可以依赖的语言规范/解释器/第三方模块的版本，性能是否至关重要（不要假设它是关键；通常不是），最重要的是可读性（因为如果维护此代码的人后来陷入了杀气，那么您聪明的微优化可能不值得）。

* * *

## 回答 #3

> 赞同：149
> 
> 时间：2016-10-03T15:47:33.197

**在 CPython 3.6+ （以及从****Python 3.7+**开始的所有其他 Python 实现）中，字典[是有序](https://docs.python.org/3/whatsnew/3.7.html#summary-release-highlights)的，因此从可迭代对象中删除重复项同时保持其原始顺序的方法是：

```
>>> list(dict.fromkeys('abracadabra'))
['a', 'b', 'r', 'c', 'd'] 
```

**在 Python 3.5**及更低版本（包括**Python 2.7**）中，使用[`OrderedDict`](https://docs.python.org/3/library/collections.html#collections.OrderedDict). 我的时间安排表明，这现在是 Python 3.5 各种方法中最快和最短的方法（当它获得 C 实现时；在 3.5 之前，它仍然是最清晰的解决方案，尽管不是最快的）。

```
>>> from collections import OrderedDict
>>> list(OrderedDict.fromkeys('abracadabra'))
['a', 'b', 'r', 'c', 'd'] 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2017-08-18T00:35:08.727

不要踢死马（这个问题很老，已经有很多好的答案），但这里有一个使用 pandas 的解决方案，它在许多情况下都非常快，而且使用起来非常简单。

```
import pandas as pd

my_list = [0, 1, 2, 3, 4, 1, 2, 3, 5]

>>> pd.Series(my_list).drop_duplicates().tolist()
# Output:
# [0, 1, 2, 3, 4, 5] 
```

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2018-03-02T08:23:53.633

在**Python 3.7**及更高版本中，字典[保证](https://mail.python.org/pipermail/python-dev/2017-December/151283.html)记住它们的键插入顺序。[这个](https://stackoverflow.com/questions/39980323/are-dictionaries-ordered-in-python-3-6)问题的答案总结了当前的事态。

因此，该`OrderedDict`解决方案变得过时了，并且没有任何导入语句，我们可以简单地发出：

```
>>> lst = [1, 2, 1, 3, 3, 2, 4]
>>> list(dict.fromkeys(lst))
[1, 2, 3, 4] 
```

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2013-04-13T17:32:19.133

```
sequence = ['1', '2', '3', '3', '6', '4', '5', '6']
unique = []
[unique.append(item) for item in sequence if item not in unique] 
```

独一无二 →`['1', '2', '3', '6', '4', '5']`

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2009-01-26T15:47:14.217

```
from itertools import groupby
[ key for key,_ in groupby(sortedList)] 
```

列表甚至不必*排序*，充分条件是相等的值被组合在一起。

**编辑：我假设“保留顺序”意味着列表实际上是有序的。如果不是这种情况，那么 MizardX 的解决方案就是正确的。**

社区编辑：然而，这是“将重复的连续元素压缩为单个元素”的最优雅的方式。

* * *

## 回答 #8

> 赞同：26
> 
> 时间：2013-05-27T21:37:23.970

我想如果你想维持秩序，

## 你可以试试这个：

```
list1 = ['b','c','d','b','c','a','a']    
list2 = list(set(list1))    
list2.sort(key=list1.index)    
print list2 
```

## 或者同样你可以这样做：

```
list1 = ['b','c','d','b','c','a','a']  
list2 = sorted(set(list1),key=list1.index)  
print list2 
```

## 你也可以这样做：

```
list1 = ['b','c','d','b','c','a','a']    
list2 = []    
for i in list1:    
    if not i in list2:  
        list2.append(i)`    
print list2 
```

## 也可以这样写：

```
list1 = ['b','c','d','b','c','a','a']    
list2 = []    
[list2.append(i) for i in list1 if not i in list2]    
print list2 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2017-01-10T19:55:48.137

只是为了从外部模块添加另一个（非常高效的）实现这种功能¹ : [`iteration_utilities.unique_everseen`](https://iteration-utilities.readthedocs.io/en/latest/generated/unique_everseen.html):

```
>>> from iteration_utilities import unique_everseen
>>> lst = [1,1,1,2,3,2,2,2,1,3,4]

>>> list(unique_everseen(lst))
[1, 2, 3, 4] 
```

# 计时

我做了一些计时（Python 3.6），这些表明它比我测试的所有其他替代方案更快，`OrderedDict.fromkeys`包括`f7`和`more_itertools.unique_everseen`：

```
%matplotlib notebook

from iteration_utilities import unique_everseen
from collections import OrderedDict
from more_itertools import unique_everseen as mi_unique_everseen

def f7(seq):
    seen = set()
    seen_add = seen.add
    return [x for x in seq if not (x in seen or seen_add(x))]

def iteration_utilities_unique_everseen(seq):
    return list(unique_everseen(seq))

def more_itertools_unique_everseen(seq):
    return list(mi_unique_everseen(seq))

def odict(seq):
    return list(OrderedDict.fromkeys(seq))

from simple_benchmark import benchmark

b = benchmark([f7, iteration_utilities_unique_everseen, more_itertools_unique_everseen, odict],
              {2**i: list(range(2**i)) for i in range(1, 20)},
              'list size (no duplicates)')
b.plot() 
```

[![在此处输入图像描述](https://i.stack.imgur.com/XLrov.png)](https://i.stack.imgur.com/XLrov.png)

并且只是为了确保我还进行了更多重复的测试，以检查它是否有所作为：

```
import random

b = benchmark([f7, iteration_utilities_unique_everseen, more_itertools_unique_everseen, odict],
              {2**i: [random.randint(0, 2**(i-1)) for _ in range(2**i)] for i in range(1, 20)},
              'list size (lots of duplicates)')
b.plot() 
```

[![在此处输入图像描述](https://i.stack.imgur.com/YCx2c.png)](https://i.stack.imgur.com/YCx2c.png)

一个只包含一个值：

```
b = benchmark([f7, iteration_utilities_unique_everseen, more_itertools_unique_everseen, odict],
              {2**i: [1]*(2**i) for i in range(1, 20)},
              'list size (only duplicates)')
b.plot() 
```

[![在此处输入图像描述](https://i.stack.imgur.com/SPCcT.png)](https://i.stack.imgur.com/SPCcT.png)

在所有这些情况下，该`iteration_utilities.unique_everseen`功能是最快的（在我的计算机上）。

* * *

此`iteration_utilities.unique_everseen`函数还可以处理输入中不可散列的值（但是，当值是可散列时，具有`O(n*n)`性能而不是性能）。`O(n)`

```
>>> lst = [{1}, {1}, {2}, {1}, {3}]

>>> list(unique_everseen(lst))
[{1}, {2}, {3}] 
```

* * *

¹免责声明：我是该软件包的作者。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2013-10-09T18:27:09.767

对于另一个非常古老的问题的另一个很晚的答案：

[`itertools`食谱](http://docs.python.org/3/library/itertools.html#itertools-recipes)有一个功能可以做到这一点，使用set`seen`技术，但是：

*   处理标准`key`函数。
*   不使用不合时宜的技巧。
*   通过预绑定`seen.add`而不是查找 N 次来优化循环。（`f7`也这样做，但有些版本没有。）
*   使用 优化循环`ifilterfalse`，因此您只需遍历 Python 中的唯一元素，而不是所有元素。（当然，你仍然在里面遍历所有这些`ifilterfalse`，但那是在 C 中，而且要快得多。）

它实际上比 快`f7`吗？这取决于您的数据，因此您必须对其进行测试并查看。如果你最后想要一个列表，请`f7`使用 listcomp，这里没有办法做到这一点。（您可以直接`append`而不是`yield`ing，或者您可以将生成器输入到`list`函数中，但是两者都不能像 listcomp 中的 LIST_APPEND 一样快。）无论如何，通常挤出几微秒不会像重要的是拥有一个易于理解、可重用、已经编写好的函数，当你想要装饰时不需要 DSU。

与所有食谱一样，它也可以在[`more-iterools`](https://pypi.python.org/pypi/more-itertools).

如果您只想要 no- `key`case，您可以将其简化为：

```
def unique(iterable):
    seen = set()
    seen_add = seen.add
    for element in itertools.ifilterfalse(seen.__contains__, iterable):
        seen_add(element)
        yield element 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2011-08-21T20:04:12.327

对于基于 MizardX 的无哈希类型（例如列表列表）：

```
def f7_noHash(seq)
    seen = set()
    return [ x for x in seq if str( x ) not in seen and not seen.add( str( x ) )] 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-04-27T14:47:21.623

减少变体速度快 5 倍，但更复杂

```
>>> l = [5, 6, 6, 1, 1, 2, 2, 3, 4]
>>> reduce(lambda r, v: v in r[1] and r or (r[0].append(v) or r[1].add(v)) or r, l, ([], set()))[0]
[5, 6, 1, 2, 3, 4] 
```

解释：

```
default = (list(), set())
# use list to keep order
# use set to make lookup faster

def reducer(result, item):
    if item not in result[1]:
        result[0].append(item)
        result[1].add(item)
    return result

>>> reduce(reducer, l, default)[0]
[5, 6, 1, 2, 3, 4] 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2020-04-04T06:03:27.893

这是一个简单的方法：

```
list1 = ["hello", " ", "w", "o", "r", "l", "d"]
sorted(set(list1 ), key=list1.index) 
```

这给出了输出：

```
["hello", " ", "w", "o", "r", "l", "d"] 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-05-26T09:30:14.913

熊猫用户应该检查一下[`pandas.unique`](https://pandas.pydata.org/docs/reference/api/pandas.unique.html)。

```
>>> import pandas as pd
>>> lst = [1, 2, 1, 3, 3, 2, 4]
>>> pd.unique(lst)
array([1, 2, 3, 4]) 
```

该函数返回一个 NumPy 数组。如果需要，您可以使用该[`tolist`](https://numpy.org/doc/1.18/reference/generated/numpy.ndarray.tolist.html)方法将其转换为列表。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2012-11-07T03:21:34.133

您可以引用一个列表推导，因为它是由符号“_[1]”构建的。
例如，以下函数通过引用其列表推导来唯一化一个元素列表而不改变它们的顺序。

```
def unique(my_list): 
    return [x for x in my_list if x not in locals()['_[1]']] 
```

演示：

```
l1 = [1, 2, 3, 4, 1, 2, 3, 4, 5]
l2 = [x for x in l1 if x not in locals()['_[1]']]
print l2 
```

输出：

```
[1, 2, 3, 4, 5] 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-09-10T21:40:58.710

借用在定义 Haskell 的`nub`列表函数时使用的递归思想，这将是一种递归方法：

```
def unique(lst):
    return [] if lst==[] else [lst[0]] + unique(filter(lambda x: x!= lst[0], lst[1:])) 
```

例如：

```
In [118]: unique([1,5,1,1,4,3,4])
Out[118]: [1, 5, 4, 3] 
```

我尝试使用它来增加数据大小并看到亚线性时间复杂度（不是确定的，但建议这对于正常数据应该没问题）。

```
In [122]: %timeit unique(np.random.randint(5, size=(1)))
10000 loops, best of 3: 25.3 us per loop

In [123]: %timeit unique(np.random.randint(5, size=(10)))
10000 loops, best of 3: 42.9 us per loop

In [124]: %timeit unique(np.random.randint(5, size=(100)))
10000 loops, best of 3: 132 us per loop

In [125]: %timeit unique(np.random.randint(5, size=(1000)))
1000 loops, best of 3: 1.05 ms per loop

In [126]: %timeit unique(np.random.randint(5, size=(10000)))
100 loops, best of 3: 11 ms per loop 
```

我还认为有趣的是，这可以很容易地通过其他操作推广到唯一性。像这样：

```
import operator
def unique(lst, cmp_op=operator.ne):
    return [] if lst==[] else [lst[0]] + unique(filter(lambda x: cmp_op(x, lst[0]), lst[1:]), cmp_op) 
```

例如，您可以传入一个函数，该函数使用舍入到相同整数的概念，就好像它是“相等”一样，以实现唯一性目的，如下所示：

```
def test_round(x,y):
    return round(x) != round(y) 
```

那么 unique(some_list, test_round) 将提供列表的唯一元素，其中唯一性不再意味着传统的相等性（这是通过使用任何类型的基于集合或基于字典键的方法来解决这个问题）而是意味着采取对于元素可能舍入到的每个可能的整数 K，仅舍入到 K 的第一个元素，例如：

```
In [6]: unique([1.2, 5, 1.9, 1.1, 4.2, 3, 4.8], test_round)
Out[6]: [1.2, 5, 1.9, 4.2, 3] 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2021-07-08T20:31:29.300

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2011-08-05T17:06:25.247

如果您需要一个班轮，那么这可能会有所帮助：

```
reduce(lambda x, y: x + y if y[0] not in x else x, map(lambda x: [x],lst)) 
```

...应该可以，但如果我错了，请纠正我

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-10-09T14:16:00.440

MizardX 的答案提供了多种方法的良好集合。

这是我在大声思考时想到的：

```
mylist = [x for i,x in enumerate(mylist) if x not in mylist[i+1:]] 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-10-02T11:23:31.650

`_sorted_`使用`numpy`数组的相对有效的方法：

```
b = np.array([1,3,3, 8, 12, 12,12])    
numpy.hstack([b[0], [x[0] for x in zip(b[1:], b[:-1]) if x[0]!=x[1]]]) 
```

输出：

```
array([ 1,  3,  8, 12]) 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2014-04-25T01:28:31.997

你可以做一种丑陋的列表理解黑客。

```
[l[i] for i in range(len(l)) if l.index(l[i]) == i] 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2014-11-07T05:02:54.830

```
l = [1,2,2,3,3,...]
n = []
n.extend(ele for ele in l if ele not in set(n)) 
```

使用 O(1) 查找集合来确定是否在新列表中包含元素的生成器表达式。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2015-05-16T23:05:08.917

一个简单的递归解决方案：

```
def uniquefy_list(a):
    return uniquefy_list(a[1:]) if a[0] in a[1:] else [a[0]]+uniquefy_list(a[1:]) if len(a)>1 else [a[0]] 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2019-05-28T09:32:13.773

消除序列中的重复值，但保留剩余项目的顺序。使用通用生成器功能。

```
# for hashable sequence
def remove_duplicates(items):
    seen = set()
    for item in items:
        if item not in seen:
            yield item
            seen.add(item)

a = [1, 5, 2, 1, 9, 1, 5, 10]
list(remove_duplicates(a))
# [1, 5, 2, 9, 10]

# for unhashable sequence
def remove_duplicates(items, key=None):
    seen = set()
    for item in items:
        val = item if key is None else key(item)
        if val not in seen:
            yield item
            seen.add(val)

a = [ {'x': 1, 'y': 2}, {'x': 1, 'y': 3}, {'x': 1, 'y': 2}, {'x': 2, 'y': 4}]
list(remove_duplicates(a, key=lambda d: (d['x'],d['y'])))
# [{'x': 1, 'y': 2}, {'x': 1, 'y': 3}, {'x': 2, 'y': 4}] 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-05-31T16:06:04.627

一个班轮列表理解：

```
values_non_duplicated = [value for index, value in enumerate(values) if value not in values[ : index]] 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2020-08-23T00:55:38.060

```
x = [1, 2, 1, 3, 1, 4]

# brute force method
arr = []
for i in x:
  if not i in arr:
    arr.insert(x[i],i)

# recursive method
tmp = []
def remove_duplicates(j=0):
    if j < len(x):
      if not x[j] in tmp:
        tmp.append(x[j])
      i = j+1  
      remove_duplicates(i)

remove_duplicates() 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2015-07-18T00:10:51.743

如果您经常使用[`pandas`](http://pandas.pydata.org/)，并且美观优于性能，请考虑内置函数`pandas.Series.drop_duplicates`：

```
 import pandas as pd
    import numpy as np

    uniquifier = lambda alist: pd.Series(alist).drop_duplicates().tolist()

    # from the chosen answer 
    def f7(seq):
        seen = set()
        seen_add = seen.add
        return [ x for x in seq if not (x in seen or seen_add(x))]

    alist = np.random.randint(low=0, high=1000, size=10000).tolist()

    print uniquifier(alist) == f7(alist)  # True 
```

定时：

```
 In [104]: %timeit f7(alist)
    1000 loops, best of 3: 1.3 ms per loop
    In [110]: %timeit uniquifier(alist)
    100 loops, best of 3: 4.39 ms per loop 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2016-01-12T17:16:19.647

这将保持秩序并在 O(n) 时间内运行。基本上这个想法是在找到重复的地方创建一个洞并将其沉入底部。使用读写指针。每当找到重复项时，只有读取指针前进，而写入指针停留在重复项上以覆盖它。

```
def deduplicate(l):
    count = {}
    (read,write) = (0,0)
    while read < len(l):
        if l[read] in count:
            read += 1
            continue
        count[l[read]] = True
        l[write] = l[read]
        read += 1
        write += 1
    return l[0:write] 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2016-01-27T13:08:08.430

不使用导入模块或集合的解决方案：

```
text = "ask not what your country can do for you ask what you can do for your country"
sentence = text.split(" ")
noduplicates = [(sentence[i]) for i in range (0,len(sentence)) if sentence[i] not in sentence[:i]]
print(noduplicates) 
```

给出输出：

```
['ask', 'not', 'what', 'your', 'country', 'can', 'do', 'for', 'you'] 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-11-04T17:30:53.103

### 就地方法

这种方法是二次的，因为我们对列表中的每个元素都进行了线性查找（为此，我们必须加上重新排列列表的成本，因为`del`s）。

也就是说，如果我们从列表的末尾开始向原点前进，删除其左侧子列表中存在的每个术语，则可以就地操作

代码中的这个想法很简单

```
for i in range(len(l)-1,0,-1): 
    if l[i] in l[:i]: del l[i] 
```

* * *

*一个简单的实现测试*

```
In [91]: from random import randint, seed                                                                                            
In [92]: seed('20080808') ; l = [randint(1,6) for _ in range(12)] # Beijing Olympics                                                                 
In [93]: for i in range(len(l)-1,0,-1): 
    ...:     print(l) 
    ...:     print(i, l[i], l[:i], end='') 
    ...:     if l[i] in l[:i]: 
    ...:          print( ': remove', l[i]) 
    ...:          del l[i] 
    ...:     else: 
    ...:          print() 
    ...: print(l)
[6, 5, 1, 4, 6, 1, 6, 2, 2, 4, 5, 2]
11 2 [6, 5, 1, 4, 6, 1, 6, 2, 2, 4, 5]: remove 2
[6, 5, 1, 4, 6, 1, 6, 2, 2, 4, 5]
10 5 [6, 5, 1, 4, 6, 1, 6, 2, 2, 4]: remove 5
[6, 5, 1, 4, 6, 1, 6, 2, 2, 4]
9 4 [6, 5, 1, 4, 6, 1, 6, 2, 2]: remove 4
[6, 5, 1, 4, 6, 1, 6, 2, 2]
8 2 [6, 5, 1, 4, 6, 1, 6, 2]: remove 2
[6, 5, 1, 4, 6, 1, 6, 2]
7 2 [6, 5, 1, 4, 6, 1, 6]
[6, 5, 1, 4, 6, 1, 6, 2]
6 6 [6, 5, 1, 4, 6, 1]: remove 6
[6, 5, 1, 4, 6, 1, 2]
5 1 [6, 5, 1, 4, 6]: remove 1
[6, 5, 1, 4, 6, 2]
4 6 [6, 5, 1, 4]: remove 6
[6, 5, 1, 4, 2]
3 4 [6, 5, 1]
[6, 5, 1, 4, 2]
2 1 [6, 5]
[6, 5, 1, 4, 2]
1 5 [6]
[6, 5, 1, 4, 2]

In [94]: 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-06-27T14:01:30.720

zmk 的方法使用非常快的列表理解，但自然保持顺序。为了应用于区分大小写的字符串，它可以很容易地修改。这也保留了原始案例。

```
def DelDupes(aseq) :
    seen = set()
    return [x for x in aseq if (x.lower() not in seen) and (not seen.add(x.lower()))] 
```

密切相关的功能是：

```
def HasDupes(aseq) :
    s = set()
    return any(((x.lower() in s) or s.add(x.lower())) for x in aseq)

def GetDupes(aseq) :
    s = set()
    return set(x for x in aseq if ((x.lower() in s) or s.add(x.lower()))) 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2020-07-18T02:05:59.210

感谢@wjandrea 的 dict.fromdict 方法理念：

```
def solve(arr): 
    return list(dict.fromkeys(arr[::-1]))[::-1] 
```

这将反转输入和输出以正确迭代

* * *

## 回答 #33

> 赞同：-2
> 
> 时间：2020-11-24T16:14:47.850

```
 def remove_duplicates_thenSort():
         t = ['b', 'c', 'd','d','a','c','c']
         t2 = []
         for i,k in enumerate(t):
              index = t.index(k)
              if i == index:
                 t2.append(t[i])
         return sorted(t2)
      print(remove_duplicates_thenSort()) 
```

# javascript - 在 HTML 中使用 CODE 标签，如何让它显示代码？

> ID：480219
> 
> 赞同：2
> 
> 时间：2009-01-26T15:45:26.920
> 
> 标签：javascript, html

快速提问，如果我想在基本 HTML 上记录一些代码并将其放在 CODE 标记中，当页面呈现以正确显示时，如何快速转换这些标记之间的代码？我知道我可以编写一个javascript查找和替换并一遍又一遍地搜索字符串，直到它完成替换所有字符，但是有更好的方法吗？

或者，如果我需要使用 javascript，是否有 jQuery 方法可以做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T16:15:06.737

我认为`<code>`标签更多地用于显示某种字体，而不是布局。`<code>`似乎只使用等宽字体。

您可能正在寻找`<pre>`标签（用于预格式化）。这将保留换行符和空格。

除非您尝试显示的代码是 HTML 代码本身，否则我认为您必须提前将所有`<`' 更改为`&lt;`'

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T17:20:22.643

听起来您可能正在寻找语法突出显示。看看[google的syntax highlihter](http://code.google.com/p/syntaxhighlighter/)

# xml - 验证 XML 文件

> ID：480224
> 
> 赞同：1
> 
> 时间：2009-01-26T15:46:29.867
> 
> 标签：xml, authentication

我的情况是，我的应用程序必须读取另一个应用程序将放置到文件系统上特定位置（在多个平台上）的 XML 文件。我控制这个文件的内容。另一个应用程序只是提供传输。

我想确保该文件没有在传输过程中被修改或以任何方式伪造。目前，我们只是将文档字符串的加盐散列写入 XML 文档本身之前的文件开头。当我们解析文档时，我们只需要去掉散列，将其与文档其余部分的散列进行比较，然后将其发送给解析器。

有没有人想分享这种场景的经验？我错过了任何缺陷或更简单的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T15:55:47.603

签署xml文档有一个标准：http: [//www.w3.org/TR/xmldsig-core/](http://www.w3.org/TR/xmldsig-core/)

如果您不想自己实现所有内容，我建议您使用[XML 安全库](http://www.aleksey.com/xmlsec/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T15:48:54.807

我们对整个 xml 文件进行加密并对其进行解密以供使用。这样我们就可以确定它是否已被修改；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T15:48:56.243

您将能够做的最安全的事情是加密两个应用程序之间的网络流量。您绝对可以对文件进行哈希处理，但是像[MD5 哈希](http://en.wikipedia.org/wiki/MD5)这样的东西应该可以解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T15:49:34.243

您应该通过使用非对称加密算法加密加盐哈希来签署消息，并将其与文档一起发送。仅使用散列并不能强制执行安全性，因为某些入侵者可能会生成具有相同散列的不同消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T15:50:22.293

根据这些文档的重要性，散列可能就足够了。但是，如果您在两端都有 PGP 支持，则更安全的机制是使用非对称的东西，例如 PGP 签名。

# c++ - 是否有任何用于编译语言（如 C++）的 Web 框架？

> ID：480233
> 
> 赞同：17
> 
> 时间：2009-01-26T15:47:52.047
> 
> 标签：c++, frameworks, embedded

在我们的嵌入式设备上，我们目前使用 PHP 作为其 Web 界面，不幸的是它很慢。我们一直在尝试使用 Python，但它似乎（至少在无 FPU 的 ARM 架构上）和 PHP 一样慢。

因此，我们正在考虑用 C++ 等编译语言实现 Web 界面，但到目前为止，我们发现的唯一东西是[Wt](http://www.webtoolkit.eu/wt)，它看起来更像桌面而不是 Web 框架，而且它的文档对于初学者来说相当复杂。

所以我的问题是：你知道有什么好的 C/C++ 网络框架吗？让我完全高兴的是像 C++ Django 这样的东西，但我怀疑这样的东西是否存在 :-)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-26T16:06:49.217

您的网站在 PHP 中运行缓慢的原因是什么？您是否分析了代码以找出瓶颈？用另一种语言替换整个代码库可能对于这项工作来说太大了。

也许如果某些部分是计算密集型的，那么也许您可以在 C++ 中实现一个 PHP 模块来完成这项工作。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-26T16:46:50.540

你可以看看[CppCMS](http://art-blog.no-ip.info/wikipp/en/page/main)。我不知道它有多成熟或有多好，但它听起来像你正在寻找的东西。

另一种选择是用 Python/PHP 编写主要应用程序，然后用 C 重写关键部分，这对我来说似乎更理智。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-26T22:12:59.760

如果我是你，我会试一试[Wt 。](http://www.webtoolkit.eu/)我认为您不会找到另一种像 Wt 那样完整且易于使用且性能相似的解决方案。邮件列表处于活动状态，并且定期发布在嵌入式设备上使用它的人的帖子。该项目的 Wiki（[此处](http://www.webtoolkit.eu/wt/wiki/index.php/Wt_embedded)）提到了 ARM 上的嵌入式部署和性能的一些数字。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-27T21:40:14.457

我刚刚看到这个链接是[CppCMS](http://art-blog.no-ip.info/wikipp/en/page/main)的引用者。关于它的几个问题/答案。

Q. 成熟度如何？
A. 有一个 100% 基于它的 Wiki。开发者博客也在 CppCMS 上运行。所以你可以看到它非常有效。好。至少对于作者来说。
问：“像 C++ Django 这样让我非常高兴的东西” 答
：实际上是“C++ Django”。许多想法直接取自 Django，例如表单、模板继承等等。所以你可能会有宾至如归的感觉
Q. Nanogear
A. 我看过它......它有很多计划，但代码不多。
问：有多少项目使用它。
答：不多。这是一个相当新的项目。
问：我是谁？
A. 老实说，我是 CppCMS 的开发者。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-26T16:07:40.743

你真的需要一个 Web 框架还是只需要一个 html 模板库？
有关模板选项，请参见此处： [C++ HTML 模板框架、模板化库、HTML 生成器库](https://stackoverflow.com/questions/355650/c-html-template-framework-templatizing-library-html-generator-library)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-26T21:24:30.293

这里要看的一件事是将 C++ 用于某种 Web 服务，而不是实际的 Web 应用程序开发环境。在我当前的一个项目中，我们生成 JSON（并解析请求）然后让客户端（Web 浏览器）处理其余的。您在客户端机器上拥有大量可用的计算能力，混合一些 javascripty 魔法和繁荣，现在您的嵌入式设备可以回到它应该做的事情。我个人有点喜欢 Wt，如果你想用 C++ 开发整个“网络应用程序”，我认为这是你最好的选择。

至于如何让您的 C++ 代码开始提供 Web 服务的具体细节，您可以使用令人惊叹的 boost.asio 库（他们有一个 http 服务器示例）和 json_spirit（我认为它在 codeproject 上）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-26T16:11:31.347

纳米齿轮怎么[样](http://projects.binaryhelix.net/projects/show/nanogear)。我没用过，不知道合不合适。这是来自网站的报价。

> C++ 是一种伟大的通用编程语言，但在这些年里，还没有开发出现代、易于使用且功能强大的 C++ Web 框架。我们试图用 Nanogear 填补空白。受 Zend Framework 和 Rails 的启发，我们希望轻松地将 C++ 引入 Web。

这是旧 googlecode 网站的链接[Google Code Nanogear](http://code.google.com/p/nanogear/) 看起来那里有更多信息。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-26T15:59:49.917

试试[Lua](http://www.lua.org)。[LuaForge](http://www.LuaForge.net)上的某处有 Xavante 嵌入式 Web 服务器。

它非常快、非常小并且非常可扩展——就像 lua 一样。

您可以在脚本更适合的地方使用 Lua，并在需要更快速度和与现有本机代码连接的地方使用 C++ 函数。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-26T16:29:20.920

既然没人说，那我就说吧。试试 Java。Java 是一种具有良好 Web 框架的编译语言。它也非常可扩展。我参与的每一个合作都使用 java 作为其主要的 web 技术，这主要是由于这种可伸缩性因素。不确定它是否适用于您的架构，但它回答了这个问题：

**是否有任何用于编译语言（如**C++ ）的 Web 框架？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-14T23:01:54.350

你可以试试[CppCMS](http://cppcms.sourceforge.net/)的[嵌入式版本](http://art-blog.no-ip.info/cppcms/blog/post/40)。

这是一个相当新的实验性开发，但它看起来比 Wt 更合适，因为它是面向 Web 的（更接近 Django）而不是 GUI。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-08-03T09:00:21.133

查看**ffead** c++ 应用程序框架 ( [http://code.google.com/p/ffead-cpp/](http://code.google.com/p/ffead-cpp/) )，它是根据 Spring for JAVA 开发的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-02-25T18:41:03.967

你可以看看[Tntnet](http://www.tntnet.org/)。它使用自己的模板语言，看起来有点像 PHP，只是有更多的附加标签。

# c++ - 函数引用

> ID：480248
> 
> 赞同：54
> 
> 时间：2009-01-26T15:51:00.387
> 
> 标签：c++

所以我只是在使用函数指针，我记得你可以这样做：

```
void Foo()
{
}

int main()
{
    void(& func)() = Foo;

    func(); //::Foo();
} 
```

明显的优势是引用引用了有效的对象（除非它们被滥用），或者在这种情况下是函数。

明显的缺点是您不能存储引用数组并且不能将它们用于成员函数指针（至少据我所知）。

**我的问题：**是否有人使用它们（即**函数引用**，*而不是*函数指针），如果是，在什么情况下你发现它们有用/有用？

我唯一能看到它们立即有用的地方是在使用条件编译时绑定对某个函数的引用。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-26T15:54:03.457

我以前使用它们通过将它们传递给构造函数以类似于策略模式的方式向类添加自定义

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-26T16:20:21.467

我认为您的示例用法非常好。因为如果您使用普通函数指针，然后应用地址运算符，您将获得函数指针的地址。使用对函数的引用将完成预期的事情，因为它返回指向函数本身的指针。

我也想不出很多例子。正如您所指出的，保留函数引用会产生一些丑陋的后果。另一个可能不需要的后果是，如果保留为类成员，如果您不编写自己的 operator= 并避免尝试重新分配函数引用，那么您的对象将是不可分配的。

我认为函数引用的大多数用法都是隐式的，就像数组引用的大多数用法一样——尽管更重要的是，当您通过引用接受参数时：

```
template<typename T>
void do_something(T const& t) { ... } 
```

虽然通过引用接受数组具有不丢失其大小信息的优点，但通过引用显式接受函数似乎没有优势（至少据我所知）。我认为函数引用的存在很大程度上是通过将引用作为某个对象或函数的*别名*的理想主义观点来证明的，以及它允许​​将函数传递给通过引用接受其参数的此类模板这一事实。

如果我不需要它们，我可能会避免使用它们。常量函数指针还提供不可重新分配的可调用对象，并且可能会在其他可能不太熟悉这种语言领域的程序员阅读您的代码时避免混淆。值得注意的是，Vandervoorde 和 Josuttis 还建议避免使用它们以减少混淆（在他们的书 C++ Templates - The Complete Guide 中）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-02-16T00:26:35.607

与函数指针不同，函数引用使从无效源创建它们变得更加困难。如果您正在围绕 C 库制作包装器，这很有用 - 如果库要求传递的指针不能为 NULL，则 C++ 代码可以通过引用获取回调函数并将指针传递给 C 库。

这也是给函数取别名的一种便捷方式，尤其是在 C++11 中使用新的 auto 关键字：

```
#include <iostream>
#include <typeinfo>

void f(int i, char c)
{
    std::cout << i << ' ' << c << std::endl;
}

int main()
{
    std::cout << typeid(f).name() << std::endl; //FvicE
    f(0, '1');

    void (*pf)(int, char) (&f); //ugly
    std::cout << typeid(pf).name() << std::endl; //PFvicE
    (*pf)(2, '3');
    pf(4, '5'); //works, but I don't recommend it

    void (&rf)(int, char) (f); //still ugly
    std::cout << typeid(rf).name() << std::endl; //FvicE
    rf(6, '7');

    auto &af (f); //pretty, but only works in C++11
    std::cout << typeid(af).name() << std::endl; //FvicE, same as above
    af(8, '9');
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-01T15:47:40.863

除了用作策略（正如 Robert Gould 所指出的），我经常在（模板）元编程的入口点使用它们。模板参数可以轻松获取函数引用；从这一点开始，它可以通过几层（元编程）模板。当然，这也适用于函数指针，但引用是*别名*，因此*可以更清楚地传达意图。*

举个例子：在为应用程序编写通用命令调度系统时，需要将许多不同的操作声明为命令。我们可以使用一个简单的“构建器函数”作为客户端代码的前端。在幕后，此构建器函数将实际函数签名作为模板参数，派生（通过模板元编程）实际参数和返回类型值，并可能选择合适的特化来存储“备忘录”和“撤消函子”。这些仿函数可以在内部存储为函数指针，或者使用 boost 或 tr1 或 C++11 函数对象。这样，就可以构建一个类型安全的命令调用和“撤消”系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T16:35:43.433

我在插件系统中使用过它们，插件 DLL 可以在运行时加载/卸载。我会在每个 DLL 中查找已知符号并将它们转换为函数指针。

# apache-flex - 在 Flex 折线图中显示数据点

> ID：480251
> 
> 赞同：1
> 
> 时间：2009-01-26T15:51:41.433
> 
> 标签：apache-flex, actionscript-3

我有一个弹性折线图。有没有一种方法可以更改每个点的渲染并始终显示它们，而不是必须将鼠标悬停在线条的某些部分上才能查看数据点的默认行为？（几乎就像一个连接点类型的视图）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-16T15:04:30.303

尝试这个

```
<mx:LineChart>
    <mx:series>
        <mx:LineSeries dataProvider="{arr1}">
            <mx:itemRenderer>
                <mx:Component>
                    <mx:CrossItemRenderer/>
                </mx:Component>
            </mx:itemRenderer>
        </mx:LineSeries>
    </mx:series>
</mx:LineChart> 
```

您可以使用*DiamondItemRenderer*或任何其他更改*CrossItemRenderer* 例如，请查看本页底部：[使用带有图表控件的笔划](http://livedocs.adobe.com/flex/3/html/charts_formatting_06.html)

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T16:22:59.077

您需要将 LineChart 的“showAllDataTips”属性设置为 true，例如

```
 <mx:LineChart id="linechart" height="100%" width="45%"
        paddingLeft="5" paddingRight="5" 
        showDataTips="true" dataProvider="{expensesAC}"
        showAllDataTips="true"> 
```

这将显示该图表的所有数据提示

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-23T18:40:23.413

我正在使用 ActionScript 构建线条系列，并在 MXML 中使用 line mx:lineStroke 来更改线条的颜色。问题是我与这条线一起使用的 CircleItemRenderer 不采用线的颜色，而是采用一些默认颜色。有没有一种方法可以将蓝色线条的橙色三角形更改为蓝色三角形，从而与线条颜色保持一致。

* * *

**解决方案**：---

```
<mx:SolidColor id="fillColor" color="0xbbbbbb" alpha="1"/>
<mx:Stroke id="lineStroke" color="0xbbbbbb" weight="2" alpha="1"/>

<mx:series>
  <mx:LineSeries yField="yvalue" xField="xvalue"
                 form="curve" 
                 itemRenderer="mx.charts.renderers.CircleItemRenderer"
                 fill="{fillColor}" 
                 lineStroke="{lineStroke}" stroke="{null}" />
</mx:series> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-16T21:40:46.077

正如在回答[关于同一主题的另一个问题时](https://stackoverflow.com/questions/512432/show-data-points-on-a-flex-mxlineseries/515866#515866)发布的那样......

如果您正在使用`<mx:LineSeries>`，则设置以下属性：

```
itemRenderer="mx.charts.renderers.CircleItemRenderer" 
```

在 ActionScript 中构造 LineSeries 时，请在添加到系列数组之前在 LineSeries 对象上设置 itemRenderer 样式：

```
lineSeries.setStyle("itemRenderer", new ClassFactory(mx.charts.renderers.CircleItemRenderer)); 
```

别忘了...

```
import mx.charts.renderers.*; 
```

您也不必坚持使用圆形项目渲染器，您可以使用渲染器包中的任何项目渲染器。

# installation - 如何在 WiX 中创建条件属性？（几乎像一个如果-那么）

> ID：480258
> 
> 赞同：4
> 
> 时间：2009-01-26T15:54:45.920
> 
> 标签：installation, wix

我有一个安装一些 EXE 文件的 WiX 项目。一个是“主要”可执行文件，其他是帮助诊断问题的支持程序。

主可执行文件是可选的，支持程序将自行运行。通常，最终用户会安装第三方程序而不是我的主要可执行文件。

在 WiX 安装程序结束时，我想要一个“启动程序”复选框，它会在安装程序关闭后立即运行该程序。

我可以根据 INSTALLLEVEL 属性隐藏复选框，但这只会根据用户选择“典型”还是“完整”安装而改变。我想根据是否安装了主要的可执行功能来隐藏它。

像这样的东西是理想的：

```
<Feature Id='MainProgram' Title='MainExe'
         Description='This application stores and displays information from our hardware.'
         ConfigurableDirectory='INSTALLDIR' Level='4'
         AllowAdvertise='no'>
    <ComponentRef Id='MainExecutable' />
    <ComponentRef Id='SQLLibrary' />
    <ComponentRef Id='ProgramIcon' />
    <ComponentRef Id='RemovePluginsFolder'/>
    <Property Id='ShowFinalCheckbox'>1</Property> #<--This won't work, but I'd like it to.
</Feature> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-26T16:48:41.130

SetProperty 元素可用于在操作之前或之后更改属性的值。要根据可执行文件的安装状态设置值，我将使用[MSI SDK 中条件语句语法中](http://msdn.microsoft.com/en-us/library/aa368012.aspx)记录的组件状态组合。您将不得不使用这个示例，但我认为这会让您接近。

```
<SetProperty Id="ShowFinalCheckBox" Value="1" After="CostFinalize">?MainExecutableComponent&gt;2 OR $MainExecutableComponent&gt;2</SetProperty> 
```

上面的 MSI SDK 链接中解释了其中的所有魔力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T18:06:49.147

对于 WiX 2，您可以使用 &Feature 来确定是否安装了该功能：

```
<Dialog Id="ExitDlg" Width="370" Height="270" Title="[ProductName] [Setup]" NoMinimize="yes">
    <Control Id="Finish" Type="PushButton" X="236" Y="243" Width="56" Height="17"
             Default="yes" Cancel="yes" Text="Finish">
      <Publish Event="EndDialog" Value="Return">1</Publish>
      <Publish Event="DoAction" Value="LaunchFile">(NOT Installed) AND (LAUNCHPRODUCT = 1) AND (&amp;MainExecutable = 3)</Publish>
    </Control>
    <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Disabled="yes" Text="Cancel" />
    <Control Id="Bitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="234" TabSkip="no" Text="[DialogBitmap]" />
    <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Disabled="yes" Text="Back" />
    <Control Id="Description" Type="Text" X="135" Y="70" Width="220" Height="20" Transparent="yes" NoPrefix="yes">
      <Text>Click the Finish button to exit the Wizard.</Text>
    </Control>
    <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
    <Control Id="Title" Type="Text" X="135" Y="20" Width="220" Height="60" Transparent="yes" NoPrefix="yes">
      <Text>{\VerdanaBold13}Completing the [ProductName] Wizard</Text>
    </Control>
    <Control Id="Launch" Type="CheckBox" X="135" Y="120" Width="150" Height="17"
             Property="LAUNCHPRODUCT" CheckBoxValue="1">
      <Text>Launch [ProductName]</Text>
      <Condition Action="hide">
        NOT (&amp;MainProgramFeature = 3)
      </Condition>
    </Control>
  </Dialog> 
```

这样，您可以隐藏对话框并使用相同的条件不启动程序（无论复选框的初始状态如何）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T11:27:55.020

它已在手册*[How To: Run the Installed Application After Setup](http://wix.sourceforge.net/manual-wix3/run_program_after_install.htm)*中有详细记录。

# flash - “_”前缀是为电影剪辑名称保留的吗？

> ID：480260
> 
> 赞同：0
> 
> 时间：2009-01-26T15:54:56.450
> 
> 标签：flash, naming-conventions, actionscript-2, movieclip

是否可以为您自己的影片剪辑名称使用**“_”下划线前缀****？**(AS2)

即你能命名一个创建/附加的电影剪辑“_feature”或“_bug”吗？

**通常这是为内部属性**保留的，例如`_x`or `_visible`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-28T06:21:13.300

“_”前缀没有技术意义——您可以使用您自己的名称来表示电影剪辑、文本字段或您喜欢的任何其他变量或方法。

作为惯例，“内置”属性（如`_x`、`_visible`等）的名称通常以下划线开头，但他们在 v6 或 v7 前后停止了这种做法，因此许多后来的属性（`filters`例如`transform`）不要使用它。此外，他们已经使用（并且我相信在 AS3 中仍然使用）多个下划线来表示他们不希望人们绊倒的内部名称（例如`__proto__`）。

过去也有一个相当广泛的约定，用于预先设置`$`为私有的属性或方法，因为将它们声明为私有没有任何效果。您在组件中经常看到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T16:08:27.450

是的，这很好。不太确定你应该这样做，但如果你有一个案例，它不会出错。我倾向于保留 _ 为类的私有成员添加前缀。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T16:31:11.493

是的，可以使用像**_myclip**这样的 MovieClip 名称，您也可以静态**`this._myclip`**或动态地引用它。**`this["_"+"myclip"]`**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-02T11:00:36.433

这很好，但正确的 as3 做法是*仅将“”用于内部、私有/受保护的变量，然后编写不带“* ”的 getter 和 setter。

例如：

```
private var _word:String = "something"

public function get word():String {
     return _word
}

public function set word(a_word:String):void {
     _word = a_word
} 
```

有点冗长，但它提供了一个不错的 API。

# java - Java Swing：JComboBox 项目上的鼠标悬停文本？

> ID：480261
> 
> 赞同：20
> 
> 时间：2009-01-26T15:55:09.507
> 
> 标签：java, swing

在 Swing 中，有没有办法为 JComboBox 中的每个项目定义鼠标悬停文本（或工具提示文本）？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2010-12-18T21:17:24.307

有比`ToolTipComboBox`已经给出的答案更好的方法来做到这一点。

首先，进行自定义`ListCellRenderer`：

```
package com.example;

import javax.swing.*;
import java.awt.*;
import java.util.List;

public class ComboboxToolTipRenderer extends DefaultListCellRenderer {
    List<String> tooltips;

    @Override
    public Component getListCellRendererComponent(JList list, Object value,
                        int index, boolean isSelected, boolean cellHasFocus) {

        JComponent comp = (JComponent) super.getListCellRendererComponent(list,
                value, index, isSelected, cellHasFocus);

        if (-1 < index && null != value && null != tooltips) {
            list.setToolTipText(tooltips.get(index));
        }
        return comp;
    }

    public void setTooltips(List<String> tooltips) {
        this.tooltips = tooltips;
    }
} 
```

然后像这样使用它：

```
JComboBox comboBox = new JComboBox();
ComboboxToolTipRenderer renderer = new ComboboxToolTipRenderer();
comboBox.setRenderer(renderer);
...
//make a loop as needed
comboBox.addItem(itemString);
tooltips.add(tooltipString);
...
renderer.setTooltips(tooltips); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-09-14T22:31:19.733

我喜欢 MountainX 解决方案的简单性，但不喜欢缺乏封装。另一种解决方案具有更多的移动部件，但它们非常简单且可重复使用。

一个接口：

```
public interface ToolTipProvider {
    public String getToolTip();
} 
```

一个包装类：

```
public class ToolTipWrapper implements ToolTipProvider {
    final Object value;
    final String toolTip;

    public ToolTipWrapper(Object value, String toolTip) {
        this.value = value;
        this.toolTip = toolTip;
    }

    @Override
    public String getToolTip() {
        return toolTip; 
    }

    @Override
    public String toString() {
        return value.toString();
    }

} 
```

以及 MountainX 渲染器的变体：

```
public class ToolTipRenderer extends DefaultListCellRenderer {

    @Override
    public Component getListCellRendererComponent(JList list, Object value,
            int index, boolean isSelected, boolean cellHasFocus) {
         JComponent component = (JComponent) super.getListCellRendererComponent(list, value, index, isSelected,
                cellHasFocus);
         String tip = null;
         if (value instanceof ToolTipProvider) {
             ToolTipProvider ttp = (ToolTipProvider) value;
             tip = ttp.getToolTip();
         }
         list.setToolTipText(tip);
         return component;
    }
} 
```

现在添加：

```
combobox.addItem(new ToolTipWrapper(itemString,tooltipString) ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T16:08:03.117

[这是来自在线示例](http://www.java2s.com/Code/Java/Swing-Components/ToolTipComboBoxExample.htm)的一些固定代码：

```
import java.awt.Component;
import java.awt.FlowLayout;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.UIManager;
import javax.swing.plaf.basic.BasicComboBoxRenderer;

/**
 * @version 1.0 06/05/99
 */
public class ToolTipComboBox extends JFrame {

  /**
     * 
     */
    private static final long serialVersionUID = 2939624252688908292L;

String[] items = { "jw", "ja", "la" };

  String[] tooltips = { "Javanese ", "Japanese ", "Latin " };

  public ToolTipComboBox() {
    super("ToolTip ComboBox Example");

    JComboBox combo = new JComboBox(items);
    combo.setRenderer(new MyComboBoxRenderer());

    getContentPane().setLayout(new FlowLayout());
    getContentPane().add(combo);
  }

  class MyComboBoxRenderer extends BasicComboBoxRenderer {
    /**
     * 
     */
    private static final long serialVersionUID = 2746090194775905713L;

    @Override
    public Component getListCellRendererComponent(JList list, Object value,
        int index, boolean isSelected, boolean cellHasFocus) {
      if (isSelected) {
        setBackground(list.getSelectionBackground());
        setForeground(list.getSelectionForeground());
        if (-1 < index) {
          list.setToolTipText(tooltips[index]);
        }
      } else {
        setBackground(list.getBackground());
        setForeground(list.getForeground());
      }
      setFont(list.getFont());
      setText((value == null) ? "" : value.toString());
      return this;
    }
  }

  public static void main(String args[]) {
    try {
        UIManager.setLookAndFeel("com.sun.java.swing.plaf.windows.WindowsLookAndFeel");
    } catch (Exception evt) {}

    ToolTipComboBox frame = new ToolTipComboBox();
    frame.addWindowListener(new WindowAdapter() {
      @Override
    public void windowClosing(WindowEvent e) {
        System.exit(0);
      }
    });
    frame.setSize(200, 140);
    frame.setVisible(true);
  }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T16:16:29.947

如果您的组合框不可编辑，请使用[`setRenderer(ListCellRenderer)`](http://java.sun.com/javase/6/docs/api/javax/swing/JComboBox.html#setRenderer(javax.swing.ListCellRenderer)). 如果它是可编辑的，请使用[`setEditor(ComboBoxEditor)`](http://java.sun.com/javase/6/docs/api/javax/swing/JComboBox.html#setEditor(javax.swing.ComboBoxEditor))，因为：

> 如果 JComboBox 不可编辑，则使用渲染器。如果它是可编辑的，则编辑器用于渲染和编辑所选项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T16:02:34.170

我从来没有尝试过，但你应该能够定义一个 ListCellRenderer，并让它返回一个 JLabel 或任何带有工具提示的东西。

# .net - 使用 .net Winform Designer 时如何处理 UserControls 构造函数中的异常？

> ID：480262
> 
> 赞同：3
> 
> 时间：2009-01-26T15:55:24.530
> 
> 标签：.net, visual-studio, winforms, windows-forms-designer

在 WinForm 设计器中加载 UserControl 时，VisualStudio 执行控件的 InitializeComponent() 方法，但不执行其构造函数。这真的很重要，因为在构造函数中有一些不能在设计时运行的代码是很常见的。

不幸的是，当您将 UserControl 添加到另一个控件时，VisualStudio 会运行​​父控件的 InitializeComponent() 方法，该方法调用子控件的构造函数，如果您在这些构造函数中遇到异常，那么您就会陷入困境。

你如何处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T16:15:21.383

仅将运行时部分包装为：

```
If Not me.DesignMode Then
  'Runtime only here
End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-30T13:23:30.240

我[在 CodeProject](http://www.codeproject.com/Tips/59203/Prevent-code-executing-at-Design-Time-in-Visual-St)中找到了一个适合我的解决方案：

```
if (System.ComponentModel.LicenseManager.UsageMode != 
    System.ComponentModel.LicenseUsageMode.Designtime)
{
    // Runtime only here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T16:04:39.580

我正在使用的解决方法是将我的运行时初始化代码放在 InitializeRuntime() 方法中，我从顶层构造函数递归调用该方法。这解决了问题，但我始终必须记住为我添加的每个 UserControl 添加对 InitializeRuntime() 的调用，而不是使用设计器拖放组件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T16:15:57.357

为什么不在这种情况下使用 OnLoadEvent 呢？

# c# - 字符串语法问题

> ID：480263
> 
> 赞同：1
> 
> 时间：2009-01-26T15:55:28.197
> 
> 标签：c#, string

我想要实现的是合并三个字符串。两个作为字符串提供；名字和姓氏，而第三个是简单的逗号/空格分隔符。给定以下代码行：

```
//Working code
var sep = ", ";
var fullName = myNewBO[0].LastName + sep + myNewBO[0].FirstName;

//Erronous code
var fullName = myNewBO[0].LastName + ", " + myNewBO[0].FirstName; 
```

字符串返回到 DataGridView 中的单元格。虽然第一位代码按预期执行，但后者没有。字符串未按预期显示在单元格中。有人能告诉我为什么后者不起作用吗？另外，如果您对问题有更好的解决方案，请提供一个。

编辑：**解决。**正如所怀疑的那样，并通过几个答案指出问题出在我的代码中的其他地方，而这两种替代方案的作用完全相同。感谢您的语法建议:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-26T15:59:58.840

我更喜欢使用`string.Format("{0}, {1}",myNewBO[0].LastName,myNewBO[0].FirstName)`

现在，如果您希望它是“First Last”，您可以抽象出格式字符串，例如您可以使用不同的格式字符串。

# 编辑

为了回应您的实际错误，我喜欢这里的其他人没有看到您应该工作的代码行有什么问题，所以问题变成：“您如何将此值绑定到网格？”

您是在 Eval() 中执行此操作还是在后面的代码等中执行此操作......

一个建议是添加一个 ToString(string) 方法，该方法采用格式字符串，然后您可以绑定到该方法的评估。如果您的业务需求发生变化，您只需更改格式字符串。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T15:58:58.720

```
string.Join(sep, new string[] {myNewBO[0].LastName, myNewBO[0].FirstName}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T16:06:11.480

你的两个电话真的没有区别，我看不到错误。你得到什么例外。Joel Coehoorn 关于 String.Join 的回答非常适合您的需要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T16:08:37.623

我怀疑您的代码中发生了其他事情，并且您弄错了错误发生的位置。我一生都无法理解为什么这两个人的行为会完全不同。我建议您在分配两种情况后记录值 - 我相信您会发现它们是相同的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T16:24:02.460

它抛出什么错误？这可以告诉你很多关于它为什么会崩溃的信息。

你的电话在我看来都是有效的。我建议您确保 LastName 和 FirstName 是字符串而不是 null。可以肯定的是，我想您可以附加`.ToString()`到名字和姓氏的末尾。

# c# - 在 Mono 中许可您的代码

> ID：480264
> 
> 赞同：1
> 
> 时间：2009-01-26T15:55:47.150
> 
> 标签：c#, licensing, mono

我正在使用 Visual Studio 中的一些代码。我~~的~~合作伙伴开发人员建议该代码也可以在 Mono 下工作。我对他已经在 Mono 中完成的工作印象深刻，但我对 Mono 很陌生，所以我不知道它可以/不能做什么。

我已经使用 .NET LicenseManager 对象在 C# 中编写了一个类。它写入 Windows 注册表，所以我知道我必须修改它，以便它使用一些编译器标志，如`#if Win32`or `#if MONO`。

我的问题有两个：
1) Mono 是否实现了相同的 LicenseManager 类结构？
2) 如果是这样，你们如何在 Linux 中使用 LicenseManager 锁定代码？（即写入文件，使用硬件加密狗，与硬件串行比较等？？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T16:19:27.180

[http://www.mono-project.com/MoMA](http://www.mono-project.com/MoMA)会显示不支持的区域

[在我写这篇文章时，mono 实现](http://anonsvn.mono-project.com/viewvc/trunk/mcs/class/System/System.ComponentModel/LicenseManager.cs?revision=70035&view=markup)的当前状态表明它不仅仅是“TODO”状态，但你必须为你的场景试一试。

# c# - 为什么事件处理程序方法会随机停止工作？

> ID：480274
> 
> 赞同：0
> 
> 时间：2009-01-26T15:58:17.940
> 
> 标签：c#, asp.net, event-handling, viewstate

为什么事件处理程序会在一天工作，然后在没有*任何*代码更改的情况下在第二天停止工作？

我已经多次遇到这个问题，但总是不得不玩弄，不知何故，事件处理程序又神奇地工作了。以下是今天再次发生在我身上的示例。您知道解决此类问题的快速方法吗？

```
<asp:LinkButton ID="LinkButton1" runat="server" OnClick="LinkButton1_Click">
    Link
</asp:LinkButton> 
```

我在这个方法上设置了一个断点，它永远不会被命中。

```
protected void LinkButton1_Click(object sender, EventArgs e)
{
    // snip
} 
```

我试过清理解决方案，重建所有等等。这里有什么见解吗？

编辑：

是的，AutoEventWireup 设置为 true。没有进行其他系统/开发环境更改。我正在使用.NET 3.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T16:01:38.260

我知道您说没有更改任何代码，但您应该检查以确保在此页面上`AutoEventWireup`设置为。`true`还要检查 web.config 以确保此属性不适`false`用于整个应用程序。

编辑：

你能做的最好的事情就是不要依赖`AutoEventWireup`你在这里。你真的应该在你`OnInit`的页面覆盖中添加一个显式的事件连接，因为这样更清晰可以提供更好的性能。我不确定您为什么会看到您所看到的错误，但我几乎可以保证，如果您执行以下操作，它们会消失：

```
protected override void OnInit(EventArgs e)
{
    this.LinkButton1.Click += new EventHandler(this.LinkButton1_Click);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T16:06:48.623

如果这是一个 .NET 1.1 应用程序，请检查 OnInit 方法中的事件处理程序是否存在。有一个 VS.2003 错误，有时会删除事件。如果它是 2.0 应用程序，我已经看到设计人员抱怨的自定义控件问题会干扰 pagename.aspx.designer.cs（或 .vb）中的事件生成。检查您的错误列表并查找“生成设计器文件失败”的任何警告。这也适用于 .NET 3.5。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T16:01:43.190

您的`aspnet_client`文件夹是否与服务器上安装的 .NET 框架版本匹配？如果您使用 2.0 之前的 .NET 框架，`aspnet_client`则已知框架和脚本之间的此版本不匹配会导致问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T19:44:57.653

秦然说的没错……居然有什么变了！大哇那里...

TFS 签入警报最终出现在我的垃圾邮件文件夹中，愚蠢的我没有对文件的历史进行比较。同事在代码隐藏中将 EnableViewState 设置为 false。

作为旁注：他这样做是因为它将响应大小降低到启用视图状态时的 10%。我最终通过使用查询字符串变量代替事件处理解决了同样的问题。

但是，感谢所有的想法。还好我没有在这件事上浪费太多时间。

# c# - IOC 容器的最佳实践

> ID：480286
> 
> 赞同：26
> 
> 时间：2009-01-26T16:02:33.203
> 
> 标签：c#, inversion-of-control, unity-container

我正在使用 Unity IOC 容器，我只是想知道访问多个类的容器的最佳方式是什么。

每个类都应该有一个 IUnityContainer 成员，然后通过构造函数传入容器吗？是否应该有一个带有 IOC 容器的单例类？

asp.net开发怎么样？

有人可以指导我正确的方向吗？谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-10-08T11:55:59.130

恕我直言，不建议将整个容器注入一个类或拥有一个应用程序范围的静态 IoC 服务定位器。

您希望能够从一个类的构造函数（我们称之为 Foo）中看到它使用什么样的服务/对象来完成工作。这提高了清晰度、可测试性和可调试性。

假设 Foo 只需要电子邮件服务，但我传入整个容器以及电子邮件服务从容器中解析的代码中的某处。在这种情况下，将很难遵循。相反，最好直接注入电子邮件服务以更清楚地说明 Foo 的依赖关系。

如果 Foo 需要创建电子邮件服务的多个实例，最好创建和注入一个 EmailServiceFactory（通过 IoC 容器），它将即时创建所需的实例。

在后一种情况下，Foo 的依赖关系仍然尽可能具体地表示 - 只有那些 EmailServiceFactory 可以创建的依赖关系。如果我注入了整个容器，就不清楚它提供的服务是 Foo 的确切依赖项。

现在，如果我以后想要提供电子邮件服务的不同实例，我将在 EmailServiceFactory 中将其换掉。如果它创建的所有服务都需要交换（例如在测试期间），我也可以交换整个工厂。

因此，以创建一个额外的类（工厂）为代价，我得到了更清晰的代码，并且不必担心使用全局静态时可能出现的奇怪错误。此外，在为测试提供模拟时，我确切地知道它需要什么模拟，并且不必模拟整个容器的类型。

这种方法还有一个优点，即现在，当一个模块被初始化时（仅适用于 Prism / Modularity），它不必注册它提供给 IoC 容器的所有对象类型。相反，它可以只注册它的 ServiceFactory，然后提供这些对象。

需要明确的是，模块的初始化类（实现 IModule）仍应在其构造函数中接收应用程序范围的 IoC 容器，以提供其他模块使用的服务，但容器不应侵入模块的类。

最后，我们这里有另一个很好的例子，说明额外的间接层如何解决问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-09-01T22:02:10.543

将 IOC 容器放在进程的最高级别/入口点，并使用它在其下的所有内容中注入依赖项。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-26T16:25:37.573

您可以注册容器本身并像其他所有依赖属性一样将其注入，如下所示：

```
IUnityContainer container = new UnityContainer();
container.RegisterInstance<IUnityContainer>(container); 
```

需要访问它的类将具有以下属性：

```
private IUnityContainer unityContainer;
[Dependency]
public IUnityContainer UnityContainer
{
    get { return unityContainer; }
    set { unityContainer = value; }
} 
```

因此，每当解析/构建此类的实例时，都会注入容器。

这更灵活，因为它适用于同一应用程序中的多个容器，而单例模式则无法做到这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T17:19:25.997

如果您的所有对象都需要对容器的引用，那么您应该考虑重新编写代码。虽然仍然比在任何地方调用 new 更可取，但它仍然分散了在整个代码中构建对象图的责任。有了这种用法，我觉得它更像是 ServiceLocator 而不是 IoC 容器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T16:13:45.757

另一种选择是使用[CommonServiceLocator](http://commonservicelocator.codeplex.com/)，尽管它可能是无意义的间接，但您可以将`ServiceLocator.Current`用作所有类都知道的实例

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T16:10:09.207

我在我的博客上有一篇关于这个主题的帖子，我正在使用类似 t3mujin 答案的东西。随意使用它（不要担心它与共享点相关......没关系）：

[http://johanleino.spaces.live.com/blog/cns!6BE273C70C45B5D1!213.entry](http://johanleino.spaces.live.com/blog/cns!6BE273C70C45B5D1!213.entry)

# ruby-on-rails - How to include a css or javascript in an erb that is outside the layout?

> ID：480288
> 
> 赞同：26
> 
> 时间：2009-01-26T16:02:48.210
> 
> 标签：ruby-on-rails, view, erb

Sorry for the slightly noobish question, as I am writing my first rails app.

I get the idea of the layout view, but if you are using them, is there any way to include a view specific js or css file? For example, I have `layouts/products.html.erb`, and for `products/edit.html.erb` I want `products_edit.css`, but I don't want that css for all product views, what is the best practice to accomplish that?

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-26T16:32:03.877

If you have a generic edit.css file, I would suggest an if in your layout

```
<%= stylesheet_link_tag 'edit' if params[:action] == 'edit' %> 
```

Otherwise you can use [`content_for`](https://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-content_for) with a `yield` to add additional tags into the head.

`layout.html.erb`

```
<head>
  ...
  <%= yield(:header) if @content_for_header %>
</head> 
```

`products/edit.html.erb`

```
<% content_for :header do -%>
  <%= stylesheet_link_tag 'edit_product' %>
<% end -%> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-26T16:32:27.933

You can add a stylesheet tag inside the head tag of the layout by doing something like this:

layouts/products.html.erb:

```
    <head>
        ...
        <%= yield :css %>
        ...
    </head>

```

products/edit.html.erb

```
<% content_for :css do
    stylesheet_link_tag 'products_edit'
end %>

```

* * *

## 回答 #3

> 赞同：-7
> 
> 时间：2009-01-26T16:26:58.757

You can't if your `</head>` tag is in your layout.

You may want a different layout for that controller action. Like this on the render:

```
 render :action => "index", :layout => "some_other_layout 
```

Also you can set a different default layout for a whole controller with this line in the controller class:

```
layout "some_other_layout" 
```

Check the API docs, there's some complex things you can do with conditionals on that layout method.

# msmq - MessageReadPropertyFilter 在使用 MSMQ 时被重置

> ID：480294
> 
> 赞同：6
> 
> 时间：2009-01-26T16:04:44.993
> 
> 标签：msmq

奇怪的一个。我们有一个多线程应用程序，它从 MSMQ 队列中提取消息，然后根据消息执行操作。所有这些都是使用 DTC 完成的。

有时，由于某种我无法描述的原因，我们在将消息从队列中拉出时会出现消息读取错误。

应用程序中使用的代码：

```
Message[] allMessagesOnQueue = this.messageQueue.GetAllMessages();

foreach (Message currentMessage in allMessagesOnQueue)
{
    if ((currentMessage.Body is IAMessageIDealWith))
    {
                // do something;    
    }
} 
```

访问 currentMessage.Body 时，有时会引发异常：

System.InvalidOperationException：接收消息时未检索到属性正文。确保 PropertyFilter 设置正确。

现在 - 这只在某些时候发生 - 看起来好像队列上的 MessageReadPropertyFilter 的 Body 属性设置为 false。

至于它是怎么变成这样的，有点神秘。Body 属性是默认值之一，我们绝对不会将其显式设置为 false。

有没有其他人看到过这种行为或者知道为什么这个值被设置为假？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-10-19T15:45:37.320

如前所述，您可以在对象上显式设置布尔值，该对象可通过属性`System.Messaging.MessagePropertyFilter`在对象上访问。`messageQueue``MessageReadPropertyFilter`

如果您希望在收到或达到峰值时从消息中提取所有数据，请使用：

```
this.messageQueue.MessageReadPropertyFilter.SetAll(); // add this line
Message[] allMessagesOnQueue = this.messageQueue.GetAllMessages();
// ... 
```

这可能会影响读取许多消息的性能，因此如果您只需要一些附加属性，请`MessagePropertyFilter`使用自定义标志创建一个新属性：

```
// Specify to retrieve selected properties.
MessagePropertyFilter filter= new MessagePropertyFilter();
filter.ClearAll();
filter.Body = true;
filter.Priority = true;
this.messageQueue.MessageReadPropertyFilter = filter;
Message[] allMessagesOnQueue = this.messageQueue.GetAllMessages();
// ... 
```

您还可以使用以下方法将其设置回默认值：

```
this.messageQueue.MessageReadPropertyFilter.SetDefaults(); 
```

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/system.messaging.messagequeue.messagereadpropertyfilter.aspx](http://msdn.microsoft.com/en-us/library/system.messaging.messagequeue.messagereadpropertyfilter.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T14:35:52.267

我也看到了它，并尝试使用我正在访问的属性来初始化它，而不是在其他任何地方设置它们。我会定期收到与您相同的错误，我的应用程序也是多线程的，我最终做的是捕获该错误并在收到错误时重新连接到 MSMQ。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-20T03:47:16.173

> 有时，由于某种我无法描述的原因，我们在将消息从队列中拉出时会出现消息读取错误。

**您是否在多个线程**中使用**同一个`MessageQueue`**实例而没有锁定？在这种情况下，你会遇到虚假的变化`MessageReadPropertyFilter`——至少我在尝试时遇到过。

为什么？[因为](http://msdn.microsoft.com/en-us/library/System.Messaging.MessageQueue.aspx#threadSafetyToggle)

> 只有 GetAllMessages 方法是线程安全的。

你能做什么？任何一个

*   围绕对您的 messageQueue 的所有访问包裹一个锁 (_messageQueue) 或
*   创建多个`MessageQueue`实例，每个线程一个

# mysql - 标记博客文章时我真的应该使用关系表吗？

> ID：480300
> 
> 赞同：1
> 
> 时间：2009-01-26T16:05:52.213
> 
> 标签：mysql, database, tags, tagging, denormalization

在试图弄清楚如何在[此处](https://stackoverflow.com/questions/480065/nested-insert-in-mysql-for-tagging)使用单个 sql 语句标记博客文章时，我想到了以下想法：使用按 id 引用标签的关系表 tag2post 如下所示：

```
tags
+-------+-----------+
| tagid | tag       |
+-------+-----------+
|     1 | news      | 
|     2 | top-story | 
+-------+-----------+

tag2post
+----+--------+-------+
| id | postid | tagid |     
+----+--------+-------+
|  0 |    322 |     1 |
+----+--------+-------+ 
```

**为什么**不只使用以下模型，您可以在其中**索引标签本身**，如下所示？认为标签永远不会重命名，而是添加和删除，这可能是有道理的，对吧？你怎么看？

```
tag2post
+----+--------+-------+
| id | postid | tag   |     
+----+--------+-------+
|  1 |    322 | sun   |
+----+--------+-------+
|  2 |    322 | moon  |
+----+--------+-------+
|  3 |   4443 | sun   |
+----+--------+-------+
|  4 |   2567 | love  |
+----+--------+-------+ 
```

PS：我保留一个**id**，我是为了轻松显示添加的最后*n 个*标签...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T16:14:52.570

它可以工作，但没有标准化，因为标签中有冗余。您也无法使用“相同”标签来标记帖子以外的内容。对于小N，优化无关紧要，所以如果你用它运行我没有问题。

实际上，您的索引会更大（假设您要在标签上进行索引以进行搜索，您现在正在索引重复项和索引字符串）。在规范化版本中，tags 表上的索引会更小，不会有重复，tagid 上的 tag2post 表上的索引会更小。此外，固定大小的 int 列对于索引非常有效，您还可以根据您的集群选择避免一些碎片。

我知道您说不重命名，但总的来说，在这两种情况下，您可能仍然需要考虑重命名（甚至删除）标签的语义 - 是否需要更改所有条目，或者标签以某种方式分裂。因为这是最坏情况下事务中的批处理操作（所有 tag2post 都必须重命名），所以从设计的角度来看，我并没有真正将其归类为重要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T16:06:16.160

这对我来说听起来不错，当你有不同的东西时，使用 ID 来引用你委托给另一个表的东西是有意义的，比如用户名或其他什么，因为你不想在数据库的每个地方都更改它的名称当他改变它时。但是在这种情况下，标签名称本身不会改变，所以我看到的唯一潜在缺点是文本索引可能比数字索引搜索要慢一些。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T16:33:32.767

与包含 ID 的关系表相比，您的提议的真正优势在哪里？

从技术上讲，它们解决了同样的问题，但是您提出的解决方案以一种冗余的、非规范化的方式来解决，这似乎只是满足了能够直接从关系表中读取数据的本能冲动。

数据库服务器非常擅长连接表，如果连接是在一个带有索引的 INT 字段上，则更是如此。当您将另一个表（如：）加入查询时，我认为您不会面临毁灭性的性能问题`INT id, VARCHAR(50) TagName`。

但是您失去了轻松重命名标签的能力（即使您不打算这样做），并且您不必要地用冗余数据膨胀您的关系表。随着时间的推移，这可能会比标准化解决方案花费更多的性能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T16:46:56.873

根据您的应用程序，反规范化方法可能很好。由于搜索大量 VARCHAR 数据，您可能会发现它会导致性能下降。

在搜索标记为“sun*”（例如 sun、sunny、sunrise）的事物时，您不需要加入。但是，您需要对更大的 VARCHAR 数据集进行类似比较。正确的索引可能会缓解这个问题，但只有测试才能告诉您哪种方法对您的数据集更快。

您还可以选择添加预连接规范化表的 VIEW。这为您提供了更简单的查询，同时仍然允许您拥有高度规范化的数据。

我的建议是使用规范化结构（并添加非规范化视图以方便使用），直到遇到非规范化数据模式修复的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T16:16:56.763

我也在考虑这个。想要数据库中的标签列表，只需从 tag2post 中选择不同的标签。有人告诉我，由于我想针对 select 语句进行优化，所以最好使用整数键，因为它比使用字符串快得多。

# sql-server - 如何在 SQL Server 中增加（或保留）IDENTITY 值而不插入表中

> ID：480309
> 
> 赞同：6
> 
> 时间：2009-01-26T16:08:00.680
> 
> 标签：sql-server, foreign-keys, identity

有没有办法保留或跳过或增加标识列的值？

我有两个表以一对一的关系连接。第一个有 IDENTITY PK 列，第二个是 int PK（不是 IDENTITY）。我曾经先插入，获取 ID，然后再插入。它工作正常。

现在我需要在第二个表中插入值而不插入第一个表中。

现在，如何增加 IDENTITY 种子，所以我可以将它插入到第二个表中，但在第一个表的 ID 中留下“洞”？

**编辑：更多信息**

这有效：

```
-- I need new seed number, but not table row 
-- so i will insert foo row, get id, and delete it
INSERT INTO TABLE1 (SomeRequiredField) VALUES ('foo'); 
SET @NewID = SCOPE_IDENTITY(); 
DELETE FROM TABLE1 WHERE ID=@NewID;

-- Then I can insert in TABLE2  
INSERT INTO (ID, Field, Field) VALUES (@NewID, 'Value', 'Value'); 
```

再一次 - 这有效。

问题是我可以在不插入表格的情况下获得 ID 吗？

DBCC 需要所有者权利；是否有一个干净的用户可调用 SQL 来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T16:16:25.080

这种情况会使你的整体数据结构非常难以理解。如果值之间没有关系，则打破关系。

有一些方法可以解决这个问题来做你正在寻找的事情，但通常它是在分布式环境中，而不是因为似乎是数据模型更改而没有完成。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T16:14:44.880

然后它不再是一对一的关系。

只需打破 PK 约束。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T16:14:08.330

使用[`DBCC CHECKIDENT`](http://technet.microsoft.com/en-us/library/ms176057.aspx)声明。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T16:24:38.277

SQL Server 联机丛书中的[这篇文章讨论了使用 DBCC CHECKIDENT 方法来更新表的标识种子。](http://msdn.microsoft.com/en-us/library/aa258817(SQL.80).aspx)

从那篇文章：

此示例将作业表中的当前标识值强制为 30。

```
USE pubs
GO
DBCC CHECKIDENT (jobs, RESEED, 30)
GO 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T17:41:17.700

`OUTPUT INTO`如果您使用的是 SQL Server 2005 或更高版本，我会研究该功能。这将允许您插入主表，并采用当时分配的 ID 在辅助表中创建行。

我假设强制执行了外键约束 - 因为这是您首先需要执行此操作的唯一原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T18:14:44.483

你打算以后如何匹配它们？如果第一个表中没有记录，我不会将记录放入第二个表中，这就是为什么它设置在外键关系中 - 以进行那种操作。只是为什么你不想在第一个表中插入记录呢？如果我们更多地了解应用程序的类型以及为什么需要这样做，我们或许能够指导您找到解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T18:58:15.190

这可能会有所帮助

SET IDENTITY_INSERT [数据库名称。[模式名称]。] 表 { 上 | 离开 }

[http://msdn.microsoft.com/en-us/library/aa259221(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa259221(SQL.80).aspx)

它允许将显式值插入到表的标识列中。

# wysiwyg - 我应该为我的 WebApp 中的注释使用哪种标记？

> ID：480311
> 
> 赞同：1
> 
> 时间：2009-01-26T16:08:12.490
> 
> 标签：wysiwyg, markup

我正在构建一个 web 应用程序，它将在所有地方都有注释字段，但我不知道我应该使用什么样的标记。

这些是我的要求

*   用户必须能够更改文本样式（粗体、斜体、下划线）
*   用户必须能够创建项目符号列表
*   用户必须能够创建编号列表
*   用户必须能够更改字体大小或使用预定义的标题
*   用户必须能够添加链接
*   用户必须有一个所见即所得 - 隐藏实际标记的编辑器

最后一个是最重要的要求，我的目标用户即使在使用单词时也会遇到困难，因此不能在 stackoverflow 上使用像这里这样的标记样式输入。

那么你知道什么样的标记适合 ans 有一些花哨的所见即所得 - 编辑器？如果您认为我错过了一个重要要求，请随时提出建议。

蒂亚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T16:12:07.867

您需要查看[tinyMCE](http://tinymce.moxiecode.com/)。

这是我找到的最好的基于 javascript 的 WYSIWYG 编辑器。

# algorithm - 如何按邻近度对集合中的对象进行分组？

> ID：480316
> 
> 赞同：7
> 
> 时间：2009-01-26T16:10:24.203
> 
> 标签：algorithm, cluster-analysis, machine-learning

我有一个包含数千个地址的集合。如果我可以得到每个地址的经度和纬度，我如何按接近度将集合分成组？

此外，我可能想根据不同的规则重试“集群”：

*   N组
*   每组 M 个地址
*   组中任何地址之间的最大距离

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-26T16:27:07.523

您可以尝试[k-means 聚类](http://en.wikipedia.org/wiki/K-means_algorithm)算法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T16:28:11.703

你想要矢量量化：

[http://en.wikipedia.org/wiki/Vector_quantization](http://en.wikipedia.org/wiki/Vector_quantization)

“*它的工作原理是将一大组点（向量）分成最接近它们的点数大致相同的组。每个组都由其质心点表示，如 k-means 和其他一些聚类算法。* “

这里的向量是每个地址的地理坐标，您可以根据您的约束（接近度、组大小、组数......）为您的算法提供其他参数。

您可以从 k-means 开始，但根据我的经验，基于 Voronoi 的算法更灵活。[这里](http://www.mqasem.net/vectorquantization/vq.html)有一个很好的介绍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T18:14:03.283

这在一定程度上取决于您要集群的数据规模。蛮力方法是将所有点组合之间的距离计算成一个距离数组。结果数组为 N^2，由于 A 到 B 的距离与 B 到 A 的距离相同，因此您只需要其中一半，因此结果集为 N^2/2。

对于相对接近的 lat lon 坐标，您有时可以使用 lat long 作为 x,y 网格并计算笛卡尔距离。由于现实世界不是平坦的，笛卡尔距离会有误差。如果您的地址位于全国各地，则应使用更精确的计算方法，请参阅[Mathforum.com 的此链接](http://www.mathforum.com/library/drmath/view/51711.html)。

如果您没有处理整个距离矩阵的规模，则需要进行一些算法编程以提高效率。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T16:14:02.697

“N 个组”和“每组 M 个地址”约束是互斥的。一个暗示另一个。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T17:03:02.410

1.  建立所有地址之间的距离矩阵。
2.  从一个随机地址开始，按到该地址的距离升序对矩阵进行排序
3.  随着您的进行，从矩阵中删除地址，将最接近起始地址的地址放入一个新组中，直到达到您的标准（组大小或最大距离）。
4.  一旦一个组已满，选择另一个随机地址并按到该地址的距离使用矩阵
5.  像这样继续，直到所有地址都从矩阵中取出。

如果地址分布均匀，每个组将在起始地址周围形成一种圆形。当起始地址靠近现有组时，问题就出现了。发生这种情况时，如果您的停止标准仅是组大小，新组将环绕旧组，甚至可以完全环绕它。如果您使用最大距离约束，那么这不会发生（假设没有其他约束）。

我真的不知道这是否是一个好方法，但这是我会尝试的。我确信需要进行大量优化。特别是对于边缘的地址。

# c# - c#流接收到所有数据？

> ID：480319
> 
> 赞同：11
> 
> 时间：2009-01-26T16:10:57.570
> 
> 标签：c#, sockets, serialization

我正在使用 C#.Net 和 System.Net.Sockets 命名空间中的 Socket 类。我正在使用异步接收方法。我知道使用 Web 服务之类的东西可以更轻松地做到这一点；这个问题是出于我的好奇而不是实际需要。

我的问题是：假设客户端正在发送一些未知长度的二进制序列化对象。在我的带有套接字的服务器上，我如何知道整个对象已被接收并准备好进行反序列化？我考虑过在对象前面加上对象的字节长度，但这在.Net 世界中似乎是不必要的。如果对象大于缓冲区会发生什么？我怎么知道，'嘿，因为对象太大而必须调整缓冲区的大小'？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-26T16:21:15.180

您*要么*需要协议是自终止的（就像 XML 一样，有效地 - 当它关闭根元素时您知道何时完成接收 XML 文档）*或者*您需要为数据添加长度前缀，*或者*您需要另一个end 完成后关闭流。

在自终止协议的情况下，您需要有足够的钩子，以便读取代码可以知道它何时完成。使用二进制序列化，您可能没有足够的钩子。长度前缀是迄今为止最简单的解决方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T16:18:08.913

如果使用纯套接字，则需要知道长度。否则，缓冲区的大小无关紧要，因为即使您有整个数据大小的缓冲区，它仍然可能不会全部读入其中-检查 Stream.Read 方法，它返回实际读取的字节数，所以你需要循环直到收到所有数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T16:19:41.797

是的，在你接收完所有字节之前你不会反序列化。

# c# - 如何将 LOGFONT.lfHeight 转换为像素？

> ID：480320
> 
> 赞同：2
> 
> 时间：2009-01-26T16:11:14.327
> 
> 标签：c#

我的`LOGFONT.lfHeight`值为-11。但是，我知道字体大小实际上是 8，所以我需要将此数字转换为不同的测量单位吗？我在 MSDN 文档中找到了这个公式：

```
int height = abs((pixels * DOTSY) / 72); 
```

这需要像素并将其变为`LOGFONT`可以使用的高度值。如果我以另一种方式工作：

```
int pixels = abs((height / DOTSY) * 72); 
```

这给了我一个 8.24 的值。我是否正确假设这是将字体高度转换为可用值所需要做的一切？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T16:20:57.457

是的。DOTSY 将为 96，这是 Windows 中 DPI 中的默认监视器分辨率。您需要确保该值对于您正在写入的设备是正确的 - 打印机通常具有更高的分辨率，并且可以更改显示器分辨率。lfHeight 为负表示字体映射器应该使用字符高度而不是单元格高度来匹配，所以这里只有绝对值很重要。

# java - JPA：带有 BLOB 列的“SELECT DISTINCT”

> ID：480324
> 
> 赞同：3
> 
> 时间：2009-01-26T16:13:08.283
> 
> 标签：java, jpa, jql

我正在尝试运行此 JPQL 查询：

```
SELECT DISTINCT i FROM Table i JOIN i.other o 
```

立即失败：

> “内部异常：java.sql.SQLException：'BLOB' 类型的列不能用于 CREATE INDEX、ORDER BY、GROUP BY、UNION、INTERSECT、EXCEPT 或 DISTINCT 语句，因为该类型不支持比较。”

这个错误对我来说很有意义，但我该如何解决呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T16:16:59.510

您可以将 blob 对象的哈希或校验和存储在另一列中，并在其上使用您的 distinct 运算符。

例子：

```
SELECT i from Table  WHERE id IN (
  SELECT id FROM (
    SELECT MIN(id) AS id, hash_of_i FROM Table GROUP BY hash_of_i
                 ) t
                                ) 
```

我相信您可以更优雅地编写此 SQL，但它会给您一个想法。

编辑 - 刚刚意识到使用它可以完全省去 Distinct 运算符（它在功能上等同于删除它）。

编辑 2 - 我不确定我的第一个版本是否有效，所以重写了它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T17:10:01.803

HermanD 的一些灵感让我想到了这个可行的解决方案：

```
SELECT i FROM Table i WHERE EXISTS (
    SELECT e FROM Table e JOIN e.other o WHERE e.id=i.id
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T16:18:14.920

BLOB 类型的列中的值只是指向实际数据存储的指针。为了应用这些运算符中的任何一个，您需要从 BLOB 加载数据并实现您自己的逻辑，因为数据可以表示任何东西（图像、文本......）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-14T17:43:59.030

在您的查询中使用 setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY) 而不是 distinct。

# javascript - 如何使根目录页面中存在的图标图像也出现在另一个目录中？

> ID：480335
> 
> 赞同：1
> 
> 时间：2009-01-26T16:15:39.387
> 
> 标签：javascript, html, mouseover

在他们的程序员去世后，我继承了一位客户。他们有 4 个商业网站运行我认为是我在 Google 上找到的 Adob​​e Go Live 代码。

只要所有 .asp 脚本和图像目录都在 Web 的根目录之外，它就可以完美地工作。我需要将“商店”脚本移动到“商店”子目录下。当我运行根目录中的默认页面时，按钮会出现，其中包含图标。当我单击 asp 位于“商店”目录下的页面的其中一个按钮时，这些按钮中都没有图像了。我对Javascript一无所知。我敢肯定，对于知道它的人来说，这是一个快速的愚蠢修复。任何帮助，将不胜感激。

附加信息：我已将错误缩小到需要更改图像所在目录的路径。如果我将图像目录复制到每个子目录下，它就可以正常工作。我真的不希望系统上的每张图片都有 4 个副本。

在此先感谢，这是部分示例源代码

```
<HEAD>
<script src="js_files/primary.js"></script>
<csactiondict>
<script><!--
CSInit[CSInit.length] = new Array    (CSILoad,/*CMP*/'button',/*URL*/'buttons/hp2.gif',/*URL*/'buttons/hp2.gif',/*URL*/'','Home     Page');
CSInit[CSInit.length] = new Array    (CSILoad,/*CMP*/'button2',/*URL*/'buttons/mv1.gif',/*URL*/'buttons/mv2.gif',/*URL*/'','But    ton2Text');
CSInit[CSInit.length] = new Array    (CSILoad,/*CMP*/'button3',/*URL*/'buttons/sev1.gif',/*URL*/'buttons/sev2.gif',/*URL*/'','B    uttons3sText');
// --></script>
</csactiondict>
</HEAD>

<BODY>

<csobj w="96" h="18" t="Button" st="Home Page" ht="buttons/hp2.gif">
<a href="#" onmouseover="return CSIShow(/*CMP*/'button',1)" onmouseout="return CSIShow    (/*CMP*/'button',0)" onclick="return CSButtonReturn()"><img     src="buttons/hp2.gif" width="96" height="18" name="button" border="0" alt="Home Page"></a>
</csobj>
<br>
<img height="2" width="108" src="images/spacer.gif" border="0" alt="Spacer">
<br>

<csobj w="96" h="18" t="Button" st="Button1Text" ht="buttons/hmc2.gif"><a     href="Link1.asp" onmouseover="return CSIShow(/*CMP*/'button35',1)" onmouseout="return     CSIShow(/*CMP*/'button35',0)" onclick="return CSButtonReturn()">
<img src="buttons/hmc1.gif" width="96" height="18" name="button3" border="0"     alt="Button3AltText"></a>
</csobj>
<br>

<img height="8" width="108" src="images/spacer.gif" border="0" alt="Spacer">
<br>
<csobj w="96" h="18" t="Button" st="Link2Text" ht="buttons/mv2.gif"><a     href="Link2.asp" onmouseover="return CSIShow(/*CMP*/'button2',1)" onmouseout="return     CSIShow(/*CMP*/'button2',0)" onclick="return CSButtonReturn()"><img src="buttons/mv1.gif"     width="96" height="18" name="button2" border="0" alt="Button2Text"></a></csobj>
</BODY> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T20:59:14.923

如果您将所有引用替换为`buttons/`（`/buttons/`在前面添加一个斜杠）它应该适用于子目录中的页面。

所以

```
CSInit[CSInit.length] = new Array    (CSILoad,/*CMP*/'button',/*URL*/'buttons/hp2.gif',/*URL*/'buttons/hp2.gif',/*URL*/'','Home     Page'); 
```

会成为

```
CSInit[CSInit.length] = new Array    (CSILoad,/*CMP*/'button',/*URL*/'/buttons/hp2.gif',/*URL*/'/buttons/hp2.gif',/*URL*/'','Home     Page'); 
```

和

```
<img src="buttons/hmc1.gif" width="96" height="18" name="button3" border="0"     alt="Button3AltText"></a> 
```

会成为

```
<img src="/buttons/hmc1.gif" width="96" height="18" name="button3" border="0"     alt="Button3AltText"></a> 
```

等等。您只需要一个`buttons`位于主机根目录的目录。

您的编辑器应该有办法“全部替换”以减少应用这些更改的痛苦。

# algorithm - 什么是好的加权函数？

> ID：480354
> 
> 赞同：1
> 
> 时间：2009-01-26T16:20:12.933
> 
> 标签：algorithm, function, graph-theory

我正在尝试在无向、循环、加权图上执行一些计算，并且我正在寻找一个好的函数来计算聚合权重。

每条边都有一个在 [1,∞) 范围内的距离值。该算法应该更加重视较低的距离（它应该是单调递减的），并且应该为距离 ∞ 分配值 0。

我的第一直觉是简单的 1/d，它同时满足了这两个要求。（嗯，从技术上讲，1/∞ 是未定义的，但程序员往往比数学家更容易让它滑动。） 1/d 的问题是该函数更关心 1/1 和 1/2 之间的差异比 1/34 和 1/35 之间的差异。我想更清楚一点。我可以使用 √(1/d) 或 ∛(1/d) 甚至 ∜(1/d)，但我觉得我错过了一大堆可能性。有什么建议么？

（我想到了 ln(1/d)，但随着 d 变为 ∞，它变为 -∞，我想不出将其推至 0 的好方法。）

*后来*：

我忘记了一个要求：w(1) 必须为 1。（这不会使现有答案无效；乘法常数很好。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T16:23:22.087

也许：

```
exp(-d) 
```

编辑：类似于

```
exp(k(1-d)), k real 
```

将满足您的额外要求（我相信您知道，但是嘿）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T16:25:00.600

1/ln (d + k) 怎么样？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T06:49:33.507

上面的一些答案是高斯分布的版本，我同意这是一个不错的选择。在自然界中经常可以找到高斯或正态分布。它是一个阶数无穷大的 B-Spline 基函数。

将其用作混合函数的一个缺点是它的无限支持比有限混合函数需要更多的计算。混合物是产品系列的总和。实际上，当下一项小于容差时，求和可能会停止。

如果可能的话，形成一个静态表来保存离散的高斯函数值，因为计算这些值的计算成本很高。如果需要，插入表值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T16:58:48.287

这个怎么样？

> ***w*** ( *d* ) = (1 + *k* )/( *d* + *k* ) 对于一些大的*k*

*d* = 2 + *k*将是***w*** ( *d* ) = 1/2的地方

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-13T21:22:29.747

看来您实际上是在寻找线性减少，类似于无穷大-d。显然这个解决方案是垃圾，但由于您可能没有使用任意精度的数据类型来表示距离，您可以使用 yourDatatype.MaxValue - d 来为此获得线性递减函数。

实际上，您可能会考虑使用 (yourDatatype.MaxValue - d) + 1 您正在使用双打，因为如果您的距离为“无穷大”，您可以将权重分配为 0（因为双打实际上有一个值。）

当然，您仍然需要考虑诸如 w(d) = double.infinity 或 w(d) = integer.MaxValue 之类的实现细节，但如果您知道您正在使用的实际数据类型，这些应该很容易发现；)

# vb.net - 在 vb.net 中以不同用户身份运行新进程

> ID：480358
> 
> 赞同：7
> 
> 时间：2009-01-26T16:21:15.477
> 
> 标签：vb.net, impersonation, runas, security-context, startprocessinfo

我目前正在使用本土方法在 Vista 中以不同用户的身份运行进程，我无法摆脱这种感觉，那就是它是 hack-ish 并且不太理想（除了它会破坏 UAC，让我的带有安全异常的应用程序，并迫使我完全禁用 UAC）。我的流程由两个项目（所以两个 EXE 文件）组成——一个“接口”和一个“启动存根”——这是流程：

1.  用户有一个启动“Interface.exe notepad.exe”的快捷方式
2.  Interface.exe 有一个表单，询问他们想要使用的凭据
3.  Interace.exe 使用 ProcessStartInfo 作为新用户创建 LaunchStub.exe (LS) 的实例
4.  LS 使用 ProcessStartInfo（ShellExecute 设置为 true）来启动请求的文件，并且由于它已经作为请求的用户运行，因此新进程也是如此。

我有一个两步过程的原因是我希望用户能够右键单击操作系统对（.EXE、.SQL、.MSC 等）具有默认操作的任何文件并启动它，并且仅 ProcessStartInfo支持启用“UseShellExecute”，但该开关阻止我使用新凭据，所以我一次只能做一个。

这会导致一些问题 - 首先，用户必须已经存在于计算机上，这意味着他们之前必须在本地登录。如果该用户没有本地配置文件，则有时会启动所请求的应用程序，但我会收到注册表和配置文件异常，因为该应用程序希望存在尚不存在的事物（例如注册表中的 HKCU 配置单元，而用户不存在）因为他们从未登录过）。

我知道我应该能够将我的应用程序的权限“提升”给他们请求的用户，启动我的新进程，然后撤消提升，但我无法找到一个好的代码示例，并且我不确定它是否允许以完全不同的用户身份运行。这一切有意义吗？我只是不禁觉得有更好的方法来做到这一点。

* * *

**更新：**我刚刚尝试[了一些我在网上找到的模拟代码](http://weblogs.asp.net/ralfw/archive/2003/11/24/39479.aspx)，但无济于事。当与 ProcessStartInfo 结合使用时，它似乎仍然使用我当前的登录名来启动进程，而不是我提供的登录名，即使我已经使用提供的凭据激活了模拟。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T18:02:54.397

您可能必须使用 Win32 API 创建自己的“shell”函数。

使用 CreateProcessWithLogonW API，您可以在不同的凭据下创建新进程，并可选择加载用户配置文件信息。

在下面的代码片段中，如果您替换

*   用户名 - 使用您的用户名
*   域 - 使用您的域或“vbNullString”
*   密码 - 使用您的密码
*   参数 4 - 将 0 替换为 'LOGON WITH PROFILE' 以加载指定的用户配置文件。

有关详细信息，请参阅[CreateProcessWithLogonW API](http://msdn.microsoft.com/en-us/library/ms682431(VS.85).aspx)的文档。走这条路，您可以完全控制并完全负责启动应用程序。

同样，这只是一个示例，您可能需要稍微玩一下才能让它做您想做的事情。

```
 Imports System.Runtime.InteropServices

Public Module modShell

    <StructLayout(LayoutKind.Sequential)> _
    Public Structure STARTUPINFO
        Public cb As Integer
        Public lpReserved As String
        Public lpDesktop As String
        Public lpTitle As String
        Public dwX As Integer
        Public dwY As Integer
        Public dwXSize As Integer
        Public dwYSize As Integer
        Public dwXCountChars As Integer
        Public dwYCountChars As Integer
        Public dwFillAttribute As Integer
        Public dwFlags As Integer
        Public wShowWindow As Short
        Public cbReserved2 As Short
        Public lpReserved2 As Integer
        Public hStdInput As Integer
        Public hStdOutput As Integer
        Public hStdError As Integer
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
    Public Structure PROCESS_INFORMATION
        Public hProcess As IntPtr
        Public hThread As IntPtr
        Public dwProcessId As Integer
        Public dwThreadId As Integer
    End Structure

    Public Declare Unicode Function CreateProcessWithLogonW Lib "Advapi32" (ByVal lpUsername As String, ByVal lpDomain As String, ByVal lpPassword As String, ByVal dwLogonFlags As Int32, ByVal lpApplicationName As String, ByVal lpCommandLine As String, ByVal dwCreationFlags As Int32, ByVal lpEnvironment As IntPtr, ByVal lpCurrentDirectory As String, ByRef si As STARTUPINFO, ByRef pi As PROCESS_INFORMATION) As Integer
    Public Declare Function CloseHandle Lib "kernel32" (ByVal hObject As IntPtr) As Integer

    Public Const LOGON_WITH_PROFILE As Int32 = &H1

    Public Const NORMAL_PRIORITY_CLASS As Int32 = &H20&

    Public Const STARTF_USESHOWWINDOW As Int32 = &H1
    Public Const SW_HIDE As Int16 = 0
    Public Const SW_SHOW As Int16 = 5

    Public Function Shell(ByVal strCmdLine As String, ByVal strCurrentDirectory As String) As Boolean

        Dim pi As PROCESS_INFORMATION
        Dim si As New STARTUPINFO

        si.cb = Marshal.SizeOf(si)
        si.dwFlags = STARTF_USESHOWWINDOW
        si.wShowWindow = SW_SHOW

        Dim result As Integer = CreateProcessWithLogonW("username", "domain", "password", 0, vbNullString, strCmdLine, NORMAL_PRIORITY_CLASS, IntPtr.Zero, strCurrentDirectory, si, pi)

        If result <> 0 Then
            Call CloseHandle(pi.hThread)
            Call CloseHandle(pi.hProcess)
        Else
            Return False
        End If

        Return True

    End Function

End Module 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T18:01:57.520

您可以尝试从您的应用程序运行 runas。[这里](http://social.technet.microsoft.com/Forums/en-US/itprovistasecurity/thread/621df60a-43a8-4d9a-a20a-dc07a111b97d/)有一些示例和选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T12:41:28.643

试试这个模块：

```
Module Impersonation

#Region "API Structures"
    <StructLayout(LayoutKind.Sequential)> _
      Public Structure PROCESS_INFORMATION
        Dim hProcess As System.IntPtr
        Dim hThread As System.IntPtr
        Dim dwProcessId As Integer
        Dim dwThreadId As Integer
    End Structure

    <StructLayout(LayoutKind.Sequential)> _
     Public Structure STARTUPINFO
        Dim cb As Integer
        Dim lpReserved As System.IntPtr
        Dim lpDesktop As System.IntPtr
        Dim lpTitle As System.IntPtr
        Dim dwX As Integer
        Dim dwY As Integer
        Dim dwXSize As Integer
        Dim dwYSize As Integer
        Dim dwXCountChars As Integer
        Dim dwYCountChars As Integer
        Dim dwFillAttribute As Integer
        Dim dwFlags As Integer
        Dim wShowWindow As Short
        Dim cbReserved2 As Short
        Dim lpReserved2 As System.IntPtr
        Dim hStdInput As System.IntPtr
        Dim hStdOutput As System.IntPtr
        Dim hStdError As System.IntPtr
    End Structure
#End Region

#Region "API Constants"
    Private Const LOGON_NETCREDENTIALS_ONLY As Integer = &H2
    Private Const NORMAL_PRIORITY_CLASS As Integer = &H20
    Private Const CREATE_DEFAULT_ERROR_MODE As Integer = &H4000000
    Private Const CREATE_NEW_CONSOLE As Integer = &H10
    Private Const CREATE_NEW_PROCESS_GROUP As Integer = &H200
    Private Const LOGON_WITH_PROFILE As Integer = &H1
#End Region

#Region "API Functions"
    Private Declare Unicode Function CreateProcessWithLogon Lib "Advapi32" Alias "CreateProcessWithLogonW" _
        (ByVal lpUsername As String, _
         ByVal lpDomain As String, _
         ByVal lpPassword As String, _
         ByVal dwLogonFlags As Integer, _
         ByVal lpApplicationName As String, _
         ByVal lpCommandLine As String, _
         ByVal dwCreationFlags As Integer, _
         ByVal lpEnvironment As System.IntPtr, _
         ByVal lpCurrentDirectory As System.IntPtr, _
         ByRef lpStartupInfo As STARTUPINFO, _
         ByRef lpProcessInfo As PROCESS_INFORMATION) As Integer

    Private Declare Function CloseHandle Lib "kernel32" (ByVal hObject As System.IntPtr) As Integer

#End Region

    Public Sub RunProgram(ByVal UserName As String, ByVal Password As String, ByVal Domain As String, ByVal Application As String, ByVal CommandLine As String)

        Dim siStartup As STARTUPINFO
        Dim piProcess As PROCESS_INFORMATION
        Dim intReturn As Integer

        If CommandLine Is Nothing OrElse CommandLine = "" Then CommandLine = String.Empty

        siStartup.cb = Marshal.SizeOf(siStartup)
        siStartup.dwFlags = 0

        intReturn = CreateProcessWithLogon(UserName, Domain, Password, LOGON_WITH_PROFILE, Application, CommandLine, _
        NORMAL_PRIORITY_CLASS Or CREATE_DEFAULT_ERROR_MODE Or CREATE_NEW_CONSOLE Or CREATE_NEW_PROCESS_GROUP, _
        IntPtr.Zero, IntPtr.Zero, siStartup, piProcess)

        If intReturn = 0 Then
            Throw New System.ComponentModel.Win32Exception(Marshal.GetLastWin32Error())
        End If

        CloseHandle(piProcess.hProcess)
        CloseHandle(piProcess.hThread)

    End Sub

End Module 
```

使用 Runprogram() 以 user/pw y 之类的方式启动您的程序。程序仅表示.exe，参数写入“命令​​行”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-24T15:23:00.317

如果要使用与当前运行进程不同的凭据启动应用程序，可以使用 .Net **Process**类。

```
this.Process = new Process();

this.Process.StartInfo.Arguments = "Arguments";
this.Process.StartInfo.FileName = "C:\your.exe";
this.Process.StartInfo.UserName = "UserName";
string password = "some password";

this.Process.StartInfo.Password.Clear();
foreach (char c in password)
{
    this.Process.StartInfo.Password.AppendChar(c);
}

//allow the process to raise events
this.Process.EnableRaisingEvents = true;
this.Process.StartInfo.ErrorDialog = false;
//Method for handling the exit event
this.Process.Exited += new EventHandler(ApplicationProcess_Exited);

//Set the application directory as the current working directory
Environment.CurrentDirectory = System.IO.Directory.GetParent("C:\").ToString();

if (this.Process.Start())
{
    // Do something on start
} 
```

# javascript - 在 Internet Explorer 中使用精灵按钮和 selection.createRange() 时获取选定文本时出现问题

> ID：480360
> 
> 赞同：3
> 
> 时间：2009-01-26T16:21:41.950
> 
> 标签：javascript, internet-explorer

我正在努力在 Stackoverflow 心爱的 WMD 降价编辑器中实现精灵按钮，我遇到了一个奇怪的错误。在所有版本的 IE 上，单击按钮时所选文本会丢失，因此，例如，突出显示文本块并单击代码按钮就像您将光标放在选择的末尾并单击按钮一样。

例如强调这一点：

```
This
Is
Code 
```

并单击代码按钮为您提供：

```
This
Is
Code`enter code here` 
```

真正奇怪的是，我把原来的非精灵按钮栏留在里面*，而且效果很好。* 事实上，**所有**按钮和键盘快捷键代码都使用相同的`doClick(button)`功能！

*   旧式非精灵按钮：OK
*   键盘快捷键：好的
*   非 IE 浏览器中的 Sprited 按钮：OK
*   IE 中的精灵按钮：**WTF**

我已将问题隔离为**仅**在单击 sprited 按钮时才`selection.createRange()`发现任何内容的调用。我已经尝试过使用 focus()ing 并确保尽可能少地在但没有快乐之前发生。键盘快捷键似乎有效，因为输入文本区域中的焦点永远不会丢失。谁能想到一个 hack 可以让我以某种方式在 IE 中收集选定的文本？**`doClick()`**

 **onclick 处理程序如下所示：

```
button.onmouseout = function(){
  this.style.backgroundPosition = this.XShift + " " + normalYShift;
};

button.onclick = function() {
  if (this.onmouseout) {
    this.onmouseout();
  }
  doClick(this);
} 
```

我已经尝试将`onmouseout`呼叫移到`doClick`导致注意力不集中的情况之后，但这不是问题。

编辑：

唯一似乎不同的是，在原始按钮代码中，您单击的是图像。在精灵代码中，您正在单击`<li>`带有背景图像集的列表项。也许它试图在我的列表项中选择不存在的文本？

/编辑

实际代码位于分支中[git](http://github.com/derobins/wmd/tree/master)上的我的 wmd 存储库中`button-cleanup`。

如果您恢复到 0d6d1b32bb42a6bd1d4ac4e409a19fdfe8f1ffcc 提交，您可以看到两个按钮栏。顶部是精灵并表现出奇怪的行为。底部包含原始按钮栏的残留物，并且工作正常。可疑代码在对象的`setInputAreaSelectionStartEnd()`函数中`TextareaState`。

我要提到的最后一件事是，目前，我正在尝试将控件保留在纯 Javascript 中，因此如果可能的话，我想避免使用 jQuery 之类的外部库来解决这个问题。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T18:07:59.440

我知道我自己的问题的答案是什么。

精灵按钮是使用 HTML 列表和 CSS 实现的，其中所有列表项都有背景图像。背景图像使用 CSS 移动以显示不同的按钮和状态（如鼠标悬停高亮显示）。标准的 CSS 按钮精灵的东西。

这在 IE 中运行良好，但有一个例外：当您单击背景图像“按钮”时，IE 会尝试选择空列表文本。输入文本区域中的选择消失，当前选择（将由 document.selection.createRange() 返回）移动到列表项中的空文本。

解决这个问题很简单——我创建了一个变量来缓存选择和一个标志。在 IE 中，我缓存选择并在 mousedown 事件处理程序中设置标志。在文本处理中，我检查标志的存在——如果它设置了，我使用缓存的范围而不是查询 document.selection.createRange()。

以下是一些代码片段：

```
wmd.ieCachedRange = null;
wmd.ieRetardedClick = false;

if(global.isIE) {
  button.onmousedown =  function() { 
    wmd.ieRetardedClick = true;
    wmd.ieCachedRange = document.selection.createRange(); 
  };
}

var range;
if(wmd.ieRetardedClick && wmd.ieCachedRange) {
  range = wmd.ieCachedRange;
  wmd.ieRetardedClick = false;
}
else {
  range = doc.selection.createRange();
} 
```

该解决方案只有几行代码，并且避免了 DOM 的混乱和潜在的布局引擎问题。

谢谢你的帮助，克里斯托夫。我在思考和搜索您的答案时想出了答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T16:47:14.767

`blur()`在 IE 可以选择页面上的任何其他内容之前，您必须点击一个按钮。

您能否提供一个重现该错误的最小示例（仅包含相关代码）？

# business-rules - 你真的认为钱不应该成为创业的动力吗？

> ID：480361
> 
> 赞同：4
> 
> 时间：2009-01-26T16:21:46.783
> 
> 标签：business-rules

一直以来，我都听过很多创业者的座右铭：做自己热爱的事，不为钱做事！

我同意将金钱作为一种交换手段，但我认为这是一个重要因素。

您有什么建议/想法，IT 企业家：专注于市场/金钱还是您对什么充满热情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-26T16:34:48.617

一般来说，初创公司会占用你所有的清醒时间，压力很大，需要相当高质量和创造性的工作，而且没有保证回报。对于这样的事情，大多数人需要他们能获得的所有动力，大量的钱（不保证）是不够的。如果你对你正在做的事情没有热情，你很可能会失败，而且几乎肯定会很痛苦。

话虽这么说，如果你所热爱的东西不是人们愿意为之付出的，那就把它当作一种爱好吧。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T16:26:14.827

不要为了钱做不想做的事**。**如果这是你想做的事，就拿钱。

如果涉及非常大的钱袋，最好在侧面印上一个大的美元符号，这会凌驾于其他一切之上。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T16:27:46.710

当它实际上是一个灰色问题时，您将其视为一个黑白问题。我认为，对于一家企业来说，你应该做一些你热爱的事情，但也要对盈利有合理的期望。

金钱不是主要目标，但有必要保持您的选择可用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T16:34:26.183

总有一个快乐的媒介。我认为做你热爱的事情很重要......但仍然能够把食物放在桌子上。如果您的热情意味着生活在捕鼠器中并让您的孩子挨饿，那么您可能已经接受了它并找到了您不那么热情的东西。或者，也许白天做你热爱的事情，但晚上送披萨来弥补。但是，我认为，如果做你喜欢的事情意味着买一辆打浆机的汽车并进行住宿而不是去有游泳酒吧的地方，那就没问题了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-26T16:51:32.077

每个人都有自己的盈亏平衡点。让我们面对现实吧，如果有人出价 10 亿美元让你做一些卑鄙的事情，你很可能会去做。

所以，归根结底，一切都取决于*你*的价值。

说到我：

我个人认为金钱很重要，它提供安全感和心灵感。如果我确信我的工作是安全的，我也发现晚上很难睡个好觉。这就是说，如果我讨厌我正在做的事情，我就无法让自己早上起床。您也不必在余生中做某事。它推动你朝着更大的目标前进，在一年或两年内从事一份不太理想的工作可能是达到目的的一种手段。

所以，说“不要为了钱做任何事”有点短视。在我看来，太谦虚了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T16:26:08.587

找到两者碰撞的那个点……金钱和你的技术热情……但不要忘记管理这一切是在这两个领域之外。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T16:27:17.820

除非你有很多国会大厦来支持你的想法，否则我认为金钱必须更多地成为动力。但是你需要在货币和市场之间找到一个很好的组合。你可以想出这个好主意，但市场不会支持它，或者想出一个蓬勃发展的市场，但没有为市场打造的好主意。在我构建的任何应用程序中，我都会查看实用程序/网站等的受众，看看是否已经有一个实用程序在做类似的事情，我看看它的工作情况、销售情况等，这通常会告诉我市场是否已经饱和使用工具，或者我的想法是否也可以出售。不要只做你对你的热情需要一个好的组合。在创建可靠的应用程序以赚钱时，您始终可以将充满激情的想法作为副业。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-26T16:27:46.913

在 .com 泡沫期间，很多人在没有可行的盈利模式的情况下追随他们的激情。结果，互联网上充斥着筹集了两千万美元的网站，建立了一些很酷的东西，然后由于缺乏收入而消失了。

如果人们把钱投入到一项新的业务中，那么总是要把钱拿出来。如果你不赚钱，他们最终会停止资助你的爱好。

# .net - 字符串变量和字符列的长度

> ID：480363
> 
> 赞同：1
> 
> 时间：2009-01-26T16:22:20.387
> 
> 标签：.net, string

我倾向于使字符串的长度成为 2 的幂（16、32、64）。对字符串类型的对象（例如字符串变量、字符串集合或字符串类型数据库中的列）执行此操作是否有任何优化好处？这是在 .net/sql 服务器环境中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T16:33:08.040

由于 .NET 字符串不是以空值结尾的，因此您必须非常聪明才能实际使用每个字符串中的完美字符数。

```
String message = "hello world!!!!!"; // Exactly 16 chars 
```

此外，字符串大小的二次方仅在您的实现使用“malloc”执行内存分配时才重要。这是一种内存分配策略，它说“我的各个内存块将更适合堆，如果它们都具有二次幂大小，则浪费的空间更少”。

但是 .NET 不使用 malloc 来分配内存。相反，所有堆内存都是通过递增堆指针来分配的。稍后 GC 释放内存时，会进行 heap compaction，这样所有新的内存都来自最后，永远不需要在碎片堆中找到一小块内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T16:34:23.093

对于数据库中的列：注意 SQL 的 8kb 数据页。行越小，每个数据页上可以容纳的行就越多。每个数据页中可以容纳的行越多，读取这些行的速度就越快（更少的页面意味着更少的 IO）。这适用于表和索引。

[以下是来自Wikipedia](http://en.wikipedia.org/wiki/Microsoft_SQL_Server#Data_storage)的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T16:25:54.437

不。你会用你不使用的字符串块做什么，因为它只是填充。与尝试对齐字符串所可能节省的任何成本相比，这种浪费的成本将是巨大的。它非常怀疑这样的长度是否有任何好处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T16:35:40.297

C#/.Net 中的字符串是不可变的，因此在构造字符串时没有必要（或任何方式）预先分配空间来容纳更多字符。如果你追加到一个字符串，你会得到一个新的字符串，它会创建新的空间来保存整个新字符串并且不会重新分配。就 SQL 列而言，如果您事先知道字符串的确切长度 (char(N)) 或使用不同的字符数据 (varchar(N))，则应将它们设为字符串的确切长度，并将 N 选为合适的最大值。我认为将这些保持为 2 的幂没有任何意义——当您创建 varchar 列时，SSMS 默认为 50，因此显然 Microsoft 也没有。

预分配可能会产生影响的一个地方是 StringBuilder 之类的东西或预分配集合的大小。同样，它的大小应该以不必调整大小为目标，但如果已知，则接近其实际使用情况。如果不知道，则要么跳过初始尺寸，要么使其足够大以容纳大多数情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T16:27:16.073

这是一个优化可能没有那么有益的领域。我会根据需要定义长度，然后在需要时返回并优化长度。我认为您会发现对字符串长度的默认处理就足够了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T16:30:24.083

不会。二次幂大小优化来自数据库时代的曙光，与数据在磁盘和内存中的对齐方式有关。今天，这是一种没有优势的退化行为。

# asp.net - 网站中已存在 Visual Studio 2008 发布失败文件

> ID：480365
> 
> 赞同：1
> 
> 时间：2009-01-26T16:22:56.597
> 
> 标签：asp.net, visual-studio-2008, publish

我在 Visual Studio 2008 中有一个 Web 应用程序项目。（你说你很幸运？哈哈..）

它是从新创建的，它不是迁移的项目。

这是一个基于文件的 Web 应用程序项目，因此不涉及 IIS 和 FPSE 等等。

我从发布对话框中选择了“发布前删除所有现有文件”选项。

状态栏中的结果是“发布失败”。在输出窗口中，它抱怨无法将两个图像和一个用户控件 (.ascx) 文件添加到发布目录，因为它们已经存在于那里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T16:25:33.173

进一步调查显示项目文件中有重复的包含元素。（用记事本++编辑）删除重复项后，它工作正常。

道德：

当合并项目文件时使用 SVN 作为源代码控制（或类似的）时，编辑这些冲突时要小心！

# wpf - 创建没有虚线样式的 WPF 进度条的最简单方法是什么？

> ID：480371
> 
> 赞同：2
> 
> 时间：2009-01-26T16:24:15.923
> 
> 标签：wpf, wpf-controls

我正在寻找一个不使用 WPF 默认样式的进度条，它使用虚线显示。我想要的只是一个简单的“流畅风格”的进度条。换句话说，我不想让进度条虚线。我希望它使用纯色条。

最简单的方法是什么？

我认为这将是默认 API 的一部分，但到目前为止我还没有成功使用它。除其他外，我尝试设置前景画笔，它只给我颜色，而不是绘制条的样式。有没有办法做到这一点，不涉及我覆盖默认模板（我想是最直接的解决方案）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-27T12:14:35.490

作为框架一部分的 XAML 文件中每个操作系统的默认样式。您可以使用下面的代码强制它在整个应用程序中使用 vista 样式，即使在 XP 上也是如此：

```
<Window.Resources>  

    <ResourceDictionary Source="/PresentationFramework.Aero, Version=3.0.0.0, Culture=neutral, 
    PublicKeyToken=31bf3856ad364e35, ProcessorArchitecture=MSIL;component/themes/aero.normalcolor.xaml" />

</Window.Resources> 
```

然而，这将改变按钮和所有其他 UI 元素的默认外观。

这是基于[此处的代码](http://arbel.net/blog/archive/2006/11/03/Forcing-WPF-to-use-a-specific-Windows-theme.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-13T13:59:45.920

我能找到的最简单的方法是简单地借用和修改我想要的进度条类型的主题/样式。这与 John 的建议非常相似，但在我的情况下，我只是为进度条控件执行样式，而不是整个界面。[CodePlex WPF 主题](http://www.codeplex.com/wpfthemes)项目是这类事情的绝佳资源。

# api - J2ME API 很难找到

> ID：480378
> 
> 赞同：1
> 
> 时间：2009-01-26T16:25:51.677
> 
> 标签：api, file, java-me

J2ME 的 API 在哪里？为什么找到 J2ME 的 API 比找到 J2SE 的 API 更难？键入 String 和 Java 1.6 将立即显示 J2SE 6 的 String Javadoc，但对 J2ME 执行类似操作将显示特定电话制造商的 Javadoc。

我特别在寻找 javax.microedition.io.file.FileConnection，但我无法在 SUN Java 的[网站](http://java.sun.com/javame/reference/apis.jsp)上找到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T16:42:59.690

一些 J2ME javadocs' 可以在[gotapi](http://www.gotapi.com)找到，您可以随时在[java 社区进程](http://jcp.org/en/jsr/overview)站点下载 jsr 文档。

我发现的另一个资源是[mobilezoo 上的 j2me 页面](http://mobilezoo.biz/j2me.php)（即您正在寻找的 api，[jsr 75](http://mobilezoo.biz/jsr/75/fileconnection/index.html)）。

我认为 Sun 没有保留这些 javadocs，因为它们超出了他们的控制范围。但是确定 jcp 人员应该维护规范的可浏览版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T16:44:11.577

这可能是因为该类位于“可选”包中。

[您可以从http://www.jcp.org/en/jsr/detail?id=75](http://www.jcp.org/en/jsr/detail?id=75)下载规范和 javadoc

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T16:55:07.933

可以在[此处](http://java.sun.com/javame/reference/apis.jsp)找到官方 Java ME API 文档。

# .net - Regex 的默认初始化选项是什么？

> ID：480389
> 
> 赞同：3
> 
> 时间：2009-01-26T16:27:31.843
> 
> 标签：.net, regex, constructor

.Net C# 提供了两个（以及四个）构造函数：

```
Regex(String) 
Regex(String,RegexOptions) 
```

第一个构造一个带有默认选项的正则表达式，而第二个给你更多的控制。使用 Reflector 在引擎盖下的峰值显示第一个构造函数调用第二个构造函数，并使用 RegexOptions.None 作为第二个参数。MSDN 文档没有透露更多信息。

使用第一个构造函数时真正的默认选项是什么？编译了吗？是否区分大小写等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T16:31:09.747

它相当于使用 RegexOptions.None - 它没有编译，它区分大小写等。（基本上看 RegexOptions，它与选择它们相反：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T07:04:53.747

有关更多信息，请查看此处：http: [//msdn.microsoft.com/en-us/library/yd1hzczs.aspx#Default](http://msdn.microsoft.com/en-us/library/yd1hzczs.aspx#Default)

# javascript - ScriptResource.axd 的视图状态无效？

> ID：480392
> 
> 赞同：11
> 
> 时间：2009-01-26T16:27:49.970
> 
> 标签：javascript, resources, viewstate

脚本资源和 Web 资源文件在我的应用程序中产生间歇性错误。我一直试图追查问题的原因，但无济于事。我注意到传递的“d”参数有些损坏，我一生都无法弄清楚导致该参数损坏的原因。我注意到我的应用程序中的 JavaScript 代码与为“d”参数生成的散列码交织在一起。

```
2009 年 1 月 26 日星期一凌晨 2:20 产生异常
页面位置：/ScriptResource.axd?d=y9_dUwBeGqLlRpT5Dml1zhoQvfa7NKdj69EYuV771kzSsa5KOOXBfJZjk%20%20%20%20%20%20%20%20%20%20%20%20if%20(cat_gallery%20!=
请求的网址：http://garmn.factoryoutletstore.com/ScriptResource.axd?d=y9_dUwBeGqLlRpT5Dml1zhoQvfa7NKdj69EYuV771kzSsa5KOOXBfJZjk if (cat_gallery !=
消息：调用的目标已引发异常。
来源：mscorlib
方法：System.Object _InvokeMethodFast(System.Object, System.Object[], System.SignatureStruct ByRef, System.Reflection.MethodAttributes, System.RuntimeTypeHandle)
堆栈跟踪：在 System.RuntimeMethodHandle._InvokeMethodFast(Object target, Object[] arguments, SignatureStruct& sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner) 在 System.RuntimeMethodHandle.InvokeMethodFast(Object target, Object[] arguments, Signature sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner ) 在 System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfoculture, Boolean skipVisibilityChecks) 在 System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[ ] 参数，CultureInfo 文化）在 System.Reflection.MethodBase.Invoke(Object obj, Object[] 参数）在 System.Web.Handlers.ScriptResourceHandler.DecryptString(String s) 在 System.Web.Handlers.ScriptResourceHandler。在 System.Web.Handlers.ScriptResourceHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext context) 在 System.Web.Handlers.ScriptResourceHandler.ProcessRequest(HttpContext context) 在 System.Web.HttpApplication.CallHandlerExecutionStep.System 的 DecryptParameter(NameValueCollection queryString)。 Web.HttpApplication.IExecutionStep.Execute() 在 System.Web.HttpApplication.ExecuteStep（IExecutionStep 步骤，布尔值&完成同步）同步完成）同步完成）
内部异常：System.Web.HttpException：无效的视图状态。在 System.Web.UI.Page.DecryptStringWithIV(String s, IVType ivType) 在 System.Web.UI.Page.DecryptString(String s)
用户IP：74.34.62.187

BaseMessage ：2009 年 1 月 26 日星期一凌晨 2:20 产生异常
页面位置：/ScriptResource.axd?d=y9_dUwBeGqLlRpT5Dml1zhoQvfa7NKdj69EYuV771kzSsa5KOOXBfJZjk%20%20%20%20%20%20%20%20%20%20%20%20if%20(cat_gallery%20!=
请求的网址：http://garmn.factoryoutletstore.com/ScriptResource.axd?d=y9_dUwBeGqLlRpT5Dml1zhoQvfa7NKdj69EYuV771kzSsa5KOOXBfJZjk if (cat_gallery !=
消息：无效的视图状态。
来源：System.Web
方法：System.String DecryptStringWithIV(System.String, System.Web.Configuration.IVType)
堆栈跟踪：在 System.Web.UI.Page.DecryptString(String s) 的 System.Web.UI.Page.DecryptStringWithIV(String s, IVType ivType)
用户IP：74.34.62.187
用户代理：Mozilla/4.0（兼容；MSIE 8.0；Windows NT 6.0；Trident/4.0；SLCC1；.NET CLR 2.0.50727；.NET CLR 3.0.04506；.NET CLR 1.1.4322；Zune 3.0）

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T15:44:16.320

我一直在分析我收集的数据，并得出了一些结论。我注意到我遇到的大部分错误来自运行 IE 8 或 Firefox 3 的 Windows Vista 计算机。其中也有少数情况是 Vista 和 IE 7。这可以解释为什么错误现在只是随着越来越多的人使用新的操作系统，这成为一个问题。

Mozilla/4.0（兼容；MSIE 8.0；Windows NT 5.1；Trident/4.0；FunWebProducts；.NET CLR 1.1.4322；.NET CLR 2.0.50727） Mozilla/4.0（兼容；MSIE 8.0；Windows NT 5.1；Trident/4.0； GoogleT5；MSN 优化；CA；MSN 优化；CA) Mozilla/4.0（兼容；MSIE 8.0；Windows NT 6.0；WOW64；Trident/4.0；GTB5；SLCC1；.NET CLR 2.0.50727；.NET CLR 3.0.04506；媒体中心PC 5.0)

但无论如何，我想得出的结论是，基于这些信息，我开始研究浏览器如何处理 java 脚本，如果有任何新的东西可能导致这个问题，那就是我发现了一些有趣的东西w3School 网站上有一篇关于 html 与 xhtml 区别的文章。

HTML 和 XHTML 之间的差异 HTML 4 和 XHTML 处理脚本中的内容不同：

在 HTML 4 中，内容类型被声明为 CDATA，这意味着不会解析实体。在 XHTML 中，内容类型被声明为 (#PCDATA)，这意味着将解析实体。这意味着在 XHTML 中，所有的特殊字符都应该被编码，或者所有的内容都应该包含在一个 CDATA 部分中。

要确保脚本在 XHTML 文档中正确解析，请使用以下语法：

因此，我立即查看了我的代码，发现我的某些页面上缺少 DOCTYPE 指令，这些指令与导致问题的相同。我还注意到，在我使用 .NET 注册客户端脚本例程输出 JavaScript 的地方，它会使用 CDATA 属性包装脚本标签的内部内容，而在页面上写入常规 JavaScript 的地方没有使用 CDATA。例如

函数 RunMe() { }

我不是浏览器如何呈现或解析 html 返回的专家，但我坚信这与上述情况有关，因为脚本资源请求中的 Url 参数在崩溃时总是包含位于其下方的脚本标记之间的代码. 有时甚至可以在那里找到 html 样式表代码。例如

[http://braun.factoryoutletstore.com/ScriptResource.axd?d=70kBR-jPBTx9R89FxObjhipHPS9CMlta5W6ZZiqkaa5zNOXUU4DtsY8V_8function](http://braun.factoryoutletstore.com/ScriptResource.axd?d=70kBR-jPBTx9R89FxObjhipHPS9CMlta5W6ZZiqkaa5zNOXUU4DtsY8V_8function) runSearchForField(eventObj, id){ if ((eventObj.which == 13) || (eventObj.keyCode == 13)) { var cat_gallery = getParam('画廊'); var cat = getParam('cat') var searchTerm = escape(document.getElementById(id).value); // 必须使用 escape() 函数对搜索词进行 urlencode 以避免出现 '&' 和 '=' 符号的问题 var url; 如果（猫_

[http://braun.factoryoutletstore.com/ScriptResource.axd?d=9vS7Hk65j_0hD8to_aPDj](http://braun.factoryoutletstore.com/ScriptResource.axd?d=9vS7Hk65j_0hD8to_aPDj)

现在我在想的是，由于没有在页面中指定任何 DOCTYPE，浏览器可能会尝试根据其接收到的数据进行推断，然后它最终会搞砸，因为有时有 CDATA，有时没有 CDATA出现在页面中。我真的不知道这是否是一个可靠的假设原因，因为他们说假设是危险的。如果有人可以对我的理论有所了解，并让我知道浏览器解析 xhtml 的方式是否与旧版本不同，或者即使它们有任何类似的情况。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-23T16:04:59.253

我们也遇到过同样的情况，这似乎与 IE8 渲染引擎中的错误有关。

看看以下资源：http: [//blogs.msdn.com/ieinternals/archive/2009/07/27/Bugs-in-the-IE8-Lookahead-Downloader.aspx](http://blogs.msdn.com/ieinternals/archive/2009/07/27/Bugs-in-the-IE8-Lookahead-Downloader.aspx) [http://connect.microsoft.com /IE/feedback/ViewFeedback.aspx?FeedbackID=467062](http://connect.microsoft.com/IE/feedback/ViewFeedback.aspx?FeedbackID=467062)

基本上，页面上有一些标签会导致“解析器重新启动”，这会导致页面中的 4K HTML 被忽略。这意味着浏览器将 HTML 放在页面后面 4096 个字节出现的 ScriptResource.axd 上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T16:51:09.347

好的，欢迎来到 MS ajax 的生活地狱。

这一点很有趣

> 请求的网址： [http](http://garmn.factoryoutletstore.com/ScriptResource.axd?d=y9_dUwBeGqLlRpT5Dml1zhoQvfa7NKdj69EYuV771kzSsa5KOOXBfJZjk) ://garmn.factoryoutletstore.com/ScriptResource.axd?d=y9_dUwBeGqLlRpT5Dml1zhoQvfa7NKdj69EYuV771kzSsa5KOOXBfJZjk if (cat_gallery != Message: Invalid viewstate

“if (cat_gallery !=" 看起来有点不合适。我会查看 if 周围的 javascript ，看看是否有任何看起来可疑的东西

假设您正在使用更新面板，关于无效视图状态的那一点让我认为视图状态在部分请求之间变得无聊。我的猜测（不是基于事实，更多的是经验和痛苦）是它是两件事之一；要么您有多个面板并且状态不正常（面板 1 更新状态，面板 2 立即触发并且不接受更改），或者它与页面生命周期相关（我已经看到多个数据绑定导致部分页面中的无效视图状态回传）

我会说第一件事是尝试重现错误。转到它发生的页面，并尝试您能想到的每种行为组合。一旦你有一个可重现的错误，附加一个调试器并在所有地方设置断点，然后只需单步执行页面生命周期，看看是否有任何代码路径在你没有预料到的方向上徘徊。

无论哪种方式，MS AJAX 都是非常黑箱的，因此调试它周围的问题可能非常困难（我花了大约 20 个小时做我上周刚刚向您推荐的事情）祝您好运，并真的希望这对您有所帮助走上正确的道路。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T19:30:48.667

如果您将站点托管在负载平衡集群或网络场中，则往往会发生这些错误。如果您在该环境中部署应用程序，则必须确保每个服务器上的配置文件共享相同的validationKey 和decryptionKey 值，它们分别用于散列和解密。这是必需的，因为您无法保证哪个服务器将处理连续的请求。

使用手动生成的键值，设置应类似于以下示例。请确保元素位于 web.config 文件中的部分下方。

```
<machineKey validationKey="0BE61B38B9836B541C45728ADB9D93A6FD819169DBB6AD20078A70F474650CC0295C69131E083A6B3762C457BBAF3E66E18F294FDA434B9DD6758631A90A2E20" decryptionKey="B80CC12266B36CCF35EF0708DB5854EDA3BBEBA1A7C89A4E" validation="SHA1"/> 
```

这是一个漂亮的小密钥生成器，您可以使用它来生成密钥值 - [http://www.eggheadcafe.com/articles/GenerateMachineKey/GenerateMachineKey.aspx](http://www.eggheadcafe.com/articles/GenerateMachineKey/GenerateMachineKey.aspx)

所以你可能已经猜到了，ScriptResource.axd 中的 d 参数实际上是解密密钥，当该密钥与之前的请求不匹配时，.NET 框架会抛出一个无效的视图状态错误。

希望有帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-04T14:01:14.913

我认为这些错误在不同的浏览器上发生的原因不同，这就是很难追踪的原因。

**IE8 错误**

微软曾表示 IE8 中的错误会（在某些情况下）向服务器生成虚假请求，这些请求不会影响用户，但会导致在服务器端记录错误。

请在此处查看此讨论：[Bug IE8 – 4K dropped - "Invalid viewstate" when loading ScriptResource.axd](https://connect.microsoft.com/IE/feedback/ViewFeedback.aspx?FeedbackID=467062)

...特别是 EricLaw-MSFT 的更新，他说：

> 值得一提的是，任何在 IE6/IE7 或 Firefox 中遇到问题的人都会遇到与下面描述的 IE8 问题无关的不同问题。

另请参阅[IE8 的 Lookahead Downloader 中的错误](http://blogs.msdn.com/ieinternals/archive/2009/07/27/Bugs-in-the-IE8-Lookahead-Downloader.aspx)

他们说更改您设置 Content-Type 的方式将有助于解决一些错误，尽管不是全部 - 他们说这是由他们仍在研究的各种模糊环境引起的。

**更新：**截至 2010 年 4 月 1 日，这些 IE8 错误已通过 IE8 累积更新 (KB980182) 得到修复。
这篇文章：[IE8 Lookahead Downloader Fixed](http://blogs.msdn.com/ieinternals/archive/2010/04/01/IE8-Lookahead-Downloader-Fixed.aspx)提供了有关错误和其他可能的解决方法的更多详细信息，而不是等待世界上的每个人下载修复程序。

**其它浏览器**

还没弄明白，但其他浏览器也会产生这些错误，大概是出于不同的原因。

**网络农场**

此问题不仅限于在网络场上运行的站点，但如果您正在运行一个场，请查看[jesal 的这个答案，](https://stackoverflow.com/questions/480392/srcriptresource-axd/481026#481026)这可能会有所帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T18:57:38.547

嘿马特非常感谢你的帮助。好的，这就是我在分析中注意到的，这个请求似乎总是与相同的 JavaScript 代码交织在一起，我在错误日志中包含了一行，显示了导致问题的请求的 Url。

```
/ScriptResource.axd?d=70kBR-jPBTx9R89FxObjhipHPS9CMlta5StoreUrl'%20is%20already%20set.%20*/function%20runSearchForField(eventObj,%20id){%20%20%20%20if%20((eventObj.which%20= =%2013)%20||%20(eventObj.keyCode%20==%2013))%20%20%20%20%20{%20%20%20%20%20%20%20%20var% 20cat_gallery%20=%20%20getParam('gallery');%20%20%20%20%20%20%20%20var%20cat%20=%20getParam('cat')%20%20%20%20 %20%20%20%20var%20searchTerm%20=%20escape(document.getElementById(id).value);%20//%20must%20use%20escape()%20function%20to%20urlencode%20search%20term%20to %20avoid%20issues%20with%20'&'%20and%20'='%20symbols%20%20%20%20%20%20%20%20var%20url;%20%20%20%20%20% 20%20%20%20%20%20%20if%20(cat_gallery%20!=
```

如您所见，“d”参数已损坏。这里发生的是 System.Web.UI.Page.DecryptString 在尝试解密此字符串时将引发 Invalid view state 错误。我想知道的是这个字符串怎么会变得如此损坏。我看了一下 JavaScript，对我来说一切都很好，唯一奇怪的是代码中有一些注释是用 /* 注释的，表示该行只是注释。我没有使用嵌套面板，但我确实在页面上有一个更新面板。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T02:49:21.480

这可能是一个愚蠢的答案，但是您检查过会话状态管理器吗？默认值为 IN PROC，它不适用于网络场，您需要使用 SQL 或其他一些状态管理器。

# gwt - gwt 是慢还是正常？

> ID：480395
> 
> 赞同：0
> 
> 时间：2009-01-26T16:28:50.437
> 
> 标签：gwt, gwt-ext

我想问一下gwt-ext应用程序的速度有没有人尝试过gwt-ext应用程序并且知道它是慢还是正常？

我可以使用 gwt-ext 处理图像，例如我想让图像变成黑白的吗？

谢谢你

赛布纳吉姆

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-02T06:14:09.030

编译后的应用程序本身运行速度并不慢，但 GWT 编译器比接受脑叶切除术的冷冻蜗牛慢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T14:01:33.020

首先，重要的是要记住一些区别。

GWT-Ext 不能代表 GWT 的技术，因为它只是一个传统 JavaScript 库的包装器（类似于 YUI，它是它的分支）。

GXT 是同一家公司尝试按照预期方式使用 GWT 复制 GWT-Ext；不是包装手工编码的 JavaScript，而是让 GWT 完成大部分工作。不幸的是，恕我直言，他们吮吸它并产生了大量垃圾。它非常笨重和缓慢。

没有理由普通的 GWT 应用程序不能像 GWT-Ext 一样快或更快。我将省略许可讨论，因为它与问题无关，但这是另一回事。

至于您关于图像处理的附加问题......如果可能的话，我认为您可以做到这一点的唯一方法是使用 Canvas 元素。GWT 有一个即将推出的小部件库（“孵化器”），它有一个可用的 Canvas 小部件。

[GWT 画布演示](http://collectionofdemos.appspot.com/demo/com.google.gwt.demos.gwtcanvas.GWTCanvasDemo/GWTCanvasDemo.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T13:22:12.960

我正在为我的应用程序使用 GWT-ext，并在其浏览器中的慢速计算机上对其进行了测试。它真的很快，动画非常流畅。纯 Java 替代 GXT 对我来说并没有运行得那么快，尽管我宁愿使用这个，因为它有更好的支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-16T14:00:07.753

实际上 GWT App 的开发者控制台看起来要慢得多。但是一旦应用程序在主服务器中编译和部署，应用程序就会变得更加活跃并且响应速度非常快。所以只有在部署后才决定应用程序的速度。只需通过部署在 jboss/apache 服务器中检查它的速度并检查它。如果您需要提高应用程序的速度，请使用代码优化技术，这将更有利于增加响应时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-18T12:57:00.900

GWT-Ext 比纯 GWT 应用程序慢得多。特别是在表单渲染中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-26T04:38:20.407

1.  以我的经验，不是很复杂的应用程序运行得足够快。
2.  我注意到的一件事是，如果您在 Panels inside Panels 中使用 Panels .... 加载需要很长时间。也许你应该将你的 Ext web 应用程序分成几个 html 页面，并在每个页面中包含一些 Ext GWT。
3.  您应该考虑的其他事情不仅仅是构建 GWT 网页。我喜欢只在需要时使用它

# algorithm - 减少排列

> ID：480397
> 
> 赞同：1
> 
> 时间：2009-01-26T16:29:04.680
> 
> 标签：algorithm, functional-programming, permutation, combinatorics

我需要一种算法，可以将排列中的运行映射到单个数字，但也可以减少后续数字。

因此，运行是排列中有序且有序的一组连续数字。在列表中，1;2;3;5;6;4 有两个运行，1;2;3 和 5;6。我想用一个数字替换这些，最少，所以如果在删除运行后，我们有 4 个元素的排列，排列使用数字 1 ... 4。在上面，我们必须减少两次运行. 第一次运行将是 1，4 转换为 2，[5;6] 转换为 3，以保持第二个标准。如果我对减少的排列进行排序，然后从映射中扩展内部元素，并对原始排列进行排序，我将得到相同的结果。结果的排列不应该有任何运行。

例如（我已经突出显示了运行）：

```
(1;2;3;4;5;6) => 1 //Mappings: 1->1;2;3;4;5;6
(2;3;4);1;(5;6) => 2 1 3 // Mappings: 2->2;3;4, and 3->5;6
(3;4);(1;2);(5;6) => 2 1 3 // Mappings: 2->3;4, and 1->1;2 and 3->5;6 
```

现在，我正在传递列表并制作列表列表，对运行进行分组。实际上，第二部分是制作干净解决方案的困难部分。我想到了天真的方法，很好奇是否有人有一些聪明的技巧可以做得比我的更好，我就像 O(2n + n log n)，

*   用运行的头元素替换运行并将该数据插入哈希表（用于可恢复性）
*   排序以使用其排序索引创建缺失数字的映射。[1;6;5;4] 将输出 [(1,1);(4,2);(5,3);(6,4)]
*   将步骤 1 中的列表替换为步骤 2 中创建的地图并更新哈希表以进行翻译。

再次运行一个例子：

```
步骤 1：用运行的头元素替换运行并将数据插入哈希表  
    [1;3;4;2;5;6;] -> [1;3;2;5]  
第 2 步：排序数组以创建地图  
    [1235]，所以我们知道，在前面的数组中，1 映射到 1、2 到 2、3 到 3、4 到 5。  
第 3 步：从第 1 步开始对数组进行上述翻译。
    [1;3;2;4]

```

如果我对这个排列进行排序并重构：[1;2;3;4], 3->3;4 和 4->5;6 我得到 1;2;3;4;5;6。也排序了。

我正在使用列表，因此首选功能方法。无需代码。当然，欢迎所有想法。

*编辑：*

> 默维尔登：
> 
> > 我不清楚映射的精确条件是什么。为什么不允许只为具有 N 次运行的排列生成排列 [1,2,...,N]？您似乎更喜欢将运行映射到该运行的数字，但是（因为这并不总是可能的）您似乎允许一些自由。–

我不喜欢将一个运行映射到该运行中的一个数字（见上图！），但我需要保留一个*ordering*。排列 [1;2;3...N]*是*一次运行，因此可以进一步减少。这就是它无效的原因。该顺序将在另一个算法的进一步操作中很重要，但可以在最后扩展各个元素以挽救原始排列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T23:17:45.383

符号：

*   从 1 开始计数
*   `l.i``i`是列表的元素`l`
*   `l+m`是列表的串联`l`和`m`
*   一个运行是一个最大的子列表，它是`[n,n+1,n+2,...,m]`一些`n`和`m`与`n <= m`

所以我们得到`p`了列表的排列`[1,2,...,N]`。我们分成这样的`p`运行。然后我们正在寻找这样的排列。`r_1,r_2,...,r_M``p = r_1+r_2+...+r_M``q``[1,2,...,M]``r_(q.1)+r_(q.2)+...+r_(q.M) = [1,2,...,N]`

例如，如果，`p = [1,3,4,2,5,6]`我们有`N=6`、`M=4`、`r_1 = [1]`、`r_2 = [3,4]`和。在这种情况下，我们需要as 。`r_3 = [2]``r_4 = [5,6]``q``[1,3,2,4]``r_1+r_3+r_2+r_4 = [1]+[2]+[3,4]+[5,6] = [1,2,3,4,5,6]`

请注意，`q`每个定义不能包含长度大于 1 的游程；如果是这样，那么有一个`i < M`with`q.i + 1 = q.(i+1)`和一个 的子列表`r_(q.i)+r_(q.(i+1)) = r_(q.i)+r_(q.i + 1)`，`[1,2,...,N]`但`r_(q.i)+r_(q.i + 1)`也是一个`p`与 that 相矛盾的子列表，`r_(q.i)`并且`r_(q.i + 1)`是运行。

现在，为了找到`q`给定的 a ，我们假设具有插入和查找数字`p`的映射数据结构以及带有追加和前向遍历的列表的可用性。然后我们执行以下操作。`O(1)``O(1)`

*   首先我们构造列表`runheads = [r_1.1,r_2.1,...,r_M.1]`。`p`这可以通过在保持当前运行的同时进行遍历来轻松完成。在这一步中，我们还记得最后遇到的最大数，并以 的元素作为键`N`构建映射。这一步很清楚。请注意，它的值是什么无关紧要，因此我们可以将 run用作 key 的值。`heads``runheads``O(n)``heads``r_i``r_i.1`

*   接下来我们迭代从`1`到（包括）`N`维护一个`k`具有初始值的值`1`。对于每个值`i`，我们检查是否`i`在`heads`. 如果是这种情况，我们添加`i -> k`到映射`f`并增加`k`。这一步也很清楚`O(n)`。为了能够从`q`to返回，`p`我们还可以存储一个额外的映射`rev`，`k -> i`甚至`k -> runheads(i)`不需要额外的 big-O 成本。

*   最后，我们将映射应用于to get`f`的元素。再次。`runheads``q``O(n)`

为了举例说明，我们来看一个例子`p = [1,3,4,2,5,6]`。

*   第一步，我们`runheads = [1,3,2,5]`得到`N=6`和`heads = { 1 -> [1], 3 -> [3,4], 2 -> [2], 5 -> [5,6] }`。

*   对于第二个步骤，我们必须为四种情况做一些事情：`1`、`2`和。对于这些情况，我们的值分别是、和。这意味着将是。（并且会是or ，具体取决于您选择存储的内容。）`3``5``k``1``2``3``4``f``{ 1 -> 1, 2 -> 2, 3 -> 3, 5 -> 4 }``rev``{ 1 -> 1, 2 -> 2, 3 -> 3, 4 -> 5 }``{ 1 -> [1], 2 -> [2], 3 -> [3,4], 4 -> [5,6] }`

*   为了得到`q`，我们计算`map(f,runheads)`哪个是`[f(1),f(3),f(2),f(5)]`或，等价地，`[1,3,2,4]`。

所以，如果我没有犯错，并且数据结构满足上述要求，那么这个解决方案应该是`O(n)`. `O(n*log(n))`请注意，在实践中，使用您自己的 ( ) 解决方案实际上可能更有用。如果你有一个大`p`但只有几次运行，排序`runheads`和使用它来构建映射可能会更有效。我确实认为这`p`必须是相当大的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T18:45:07.993

**为澄清而编辑**

第 1 步：运行算法，但不是只生成一个哈希表，而是生成一个哈希表 (D1)，该哈希表 (D1) 由它映射到的集合的头部索引（例如，对于 [3,4]，它将是 3）和一个列表(L1) 与集合本身

[3;4;6;8;1;2]：

```
 D1              L1

3 -> [3,4]     1 -> [3,4]

6 -> [6]       2 -> [6]

8 -> [8]       3 -> [8]

1 -> [1,2]     4 -> [1,2] 
```

第 2 步：我看一下我们现在拥有的集合，您会看到，对于给定的集合，我们有找到它的索引（在 L1 中）和 Head 值。正确的地图值将是它们之间尚未采用的最小整数。例如，对于 [3,4]，我们将拥有该值必须介于 1 和 3 之间，并且由于已经采用 1，因此相应的值为 2。考虑到，由于 D1 由 Head 索引值，如果存在相应的集合，则始终采用较低的值。在这个例子中，[1,2] 被映射到 1，所以这个键已经被“占用”了。所以，在伪代码中：

```
for (int Current = 1; Current  < L1.Length; Current++)
{
  GetHead(L1[Current]);
  Index = Current;
  While Head > Index
  {
    if D1.Empty(Index)
    {
      D1.Add(Index,D2[Current])
      D1.DeleteIfNotEmpty(Head);
    }
    else
      Index++;
  }
} 
```

例如

*   我们取 L1 中的第一个值 -> [3,4]...
*   得到头部 = 3
*   从 1 开始，我们查找已被占用的 D1[1]，因此我们递增到 2。
*   我们寻找为空的 D1[2]，因此我们分配 D1[2] = [3,4] 并删除 D[3]

这不提供 O(n) 但类似于 O(n+log(n)) （第一步为 n，第二步为 log(n)）

对于上面的示例，您可以：

```
1 -> [1,2]
2 -> [3,4]
3 -> [6]
4 -> [8] 
```

现在，如果你有 [3;4;8;6;1;2]，那将导致

```
1 -> [1,2]
2 -> [3,4]
3 -> [8]
4 -> [6] 
```

因为它在原始数组中使用绝对排序，所以我不知道这是否可以，或者您希望 6 位于索引 3 中，而 8 位于索引 4 中，在这种情况下，您可能必须预先订购 L1基于头部，这将使您的复杂性增加 Log(n)

如果您必须预订，您将拥有 0(n+log^2(n)) ，这还不错（假设 QuickSort 有 O(Log n) 排序 L1 将是 O(log(log n))

# c# - 将列表（对象）转换为列表（字符串）

> ID：480399
> 
> 赞同：83
> 
> 时间：2009-01-26T16:29:19.093
> 
> 标签：c#, vb.net, generics

有没有办法在 c# 或 vb.net 中将 a 转换`List(of Object)`为 a`List(of String)`而无需遍历所有项目？（幕后迭代很好——我只想要简洁的代码）

**更新：** 最好的方法可能只是做一个新的选择

```
myList.Select(function(i) i.ToString()).ToList(); 
```

或者

```
myList.Select(i => i.ToString()).ToList(); 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-01-26T16:31:42.023

如果不迭代构建一个新列表是不可能的。您可以将列表包装在实现 IList 的容器中。

您可以使用 LINQ`IEnumerable<string>`从对象列表中获取惰性求值版本，如下所示：

```
var stringList = myList.OfType<string>(); 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2012-11-14T19:00:32.403

这适用于所有类型。

```
List<object> objects = new List<object>();
List<string> strings = objects.Select(s => (string)s).ToList(); 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-01-26T16:33:14.407

如果您想更好地控制转换的发生方式，可以使用 ConvertAll：

```
var stringList = myList.ConvertAll(obj => obj.SomeToStringMethod()); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-26T16:35:47.817

你的意思是这样的？

```
List<object> objects = new List<object>();
var strings = (from o in objects
              select o.ToString()).ToList(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-26T16:32:29.400

否 - 如果您想转换列表的*所有*元素，您必须以一种或另一种方式触摸该列表的*所有*元素。

您可以以不同的方式指定/编写迭代（foreach()......，或 .ConvertAll() 或其他方式），但最终，一种或另一种方式，一些代码将遍历每一个元素并转换它。

马克

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-01-03T04:35:25.257

```
List<string> myList Str = myList.Select(x=>x.Value).OfType<string>().ToList(); 
```

使用“选择”选择特定列

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-26T16:45:34.100

您可以在构建 List(of object) 时进行字符串转换吗？这将是在创建 List(of object) 之后避免枚举整个列表的唯一方法。

# algorithm - 通过位旋转查找循环调度中的下一个

> ID：480405
> 
> 赞同：9
> 
> 时间：2009-01-26T16:31:25.783
> 
> 标签：algorithm, bit-manipulation, verilog, vhdl

考虑以下问题。您有一个位串，它表示单热编码中的当前计划从站。例如，“00000100”（最左边的位为#7，最右边的位为#0）表示从#2 被调度。

现在，我想在循环调度方案中选择下一个调度的从站，但要有所改变。我有一个“请求掩码”，它说明了哪些奴隶实际上想要被安排。下一个奴隶只会从那些想要的人中挑选出来。

一些示例（假设循环调度是通过向左旋转完成的）。示例 1：

*   当前：“00000100”
*   掩码：“01100000”
*   下一个时间表：“00100000” - 在正常循环中，#3 和 #4 应该在 #2 之后，但他们没有请求，所以选择 #5。

示例 2：

*   当前：“01000000”
*   掩码：“00001010”
*   下一个：“00000010” - 因为调度是通过向左循环完成的，并且 #1 是该顺序中的第一个请求从站。

* * *

现在，我知道，这可以很容易地在一个循环中编码。但我实际上想通过一个不循环的操作来得到我的结果。动机：我想在 VHDL/Verilog 中的硬件（在 FPGA 中）实现这一点。

一个额外的好处是组成一个对任意数量的奴隶 N 通用的算法。

顺便说一句，这不是一个家庭作业问题。每当想要以某种方式调度从属设备时，这是一个重要的问题，并根据从属设备的请求来调节调度。我目前的解决方案有点“沉重”，我想知道我是否遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T17:11:07.793

循环不一定是坏的。

我会简单地做

```
current[i] = current[i-1] & mask[i] |                         // normal shift logic
                mask[i] & current[i-2] & !mask[i-1] |         // here build logic 
                ...                                          // expression for 
                                                             // remaining 
```

然后将其放入生成循环中（即，它将展开为硬件），这将为表达式生成并行硬件。

这里提到的其他解决方案使用多个“-”。我只能劝阻他们，因为这会给你带来非常昂贵的手术。特别是。在一个热点中，您可以轻松获得超过 32 位，这在硬件中不容易实现，因为借用必须通过所有位（某些 fpgas 上的死去进位逻辑使其对于少量位来说是可接近的）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-29T19:08:27.130

我在 Altera 高级综合食谱中找到了以下用于实现任务的 Verilog 代码。

```
// 'base' is a one hot signal indicating the first request
// that should be considered for a grant.  Followed by higher
// indexed requests, then wrapping around.
//

module arbiter (
    req, grant, base
);

parameter WIDTH = 16;

input [WIDTH-1:0] req;
output [WIDTH-1:0] grant;
input [WIDTH-1:0] base;

wire [2*WIDTH-1:0] double_req = {req,req};
wire [2*WIDTH-1:0] double_grant = double_req & ~(double_req-base);
assign grant = double_grant[WIDTH-1:0] | double_grant[2*WIDTH-1:WIDTH];

endmodule 
```

它使用减法（虽然只有一次），所以从概念上讲它与 Doug 的解决方案非常相似。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-28T04:26:54.043

以下解决方案适用于任意数量的从机 (K)，并且在您的 FPGA 中为 O(n)。对于该字段中的每个位，您将需要三个逻辑门和两个反相器。我用一个基本的逻辑模拟器测试了这个概念，它可以工作。

*电流*和*掩码*之间的逻辑门链本质上创建了一个优先系统，该系统有利于链中“较低”的位。该链在末端是循环的，但*当前*位用于断开该链。

为了可视化操作，假设在*当前*字段中设置了第*3*位，并在图中向下跟随信号。第*3*位的逻辑 1 在第一个与门的输入处放置一个逻辑零，这保证了与门的输出也将为零（这是或门链中断的地方）。第一个与门输出处的零在第二个与门的输入处放置一个。这使得*next的**第 2*位直接依赖于*mask的**第 2*位。

 ***现在，OR 门链开始发挥作用。

如果设置了*掩码的第**2*位，则直接位于其左侧的 OR 门的逻辑输出也将为 1，这将在*电流的第**2*位下方的 AND 门的输入处放置逻辑 1 （将为零，因为一次只能设置一位*电流*）。顶部与门输出的逻辑 1 将逻辑零置于底部与门的输入端，因此将*next的第**1*位设置为零。

 ***如果未设置*掩码的**第 2*位，则或门的两个输入都为零，因此*电流第**2*位下方的与门的输出将为零，在底部与门的输入端放置一个 1，因此使*next的第**1*位依赖于mask 的*第**1*位。

 ***这个逻辑遵循“向上”位的或门链，从左侧循环到右侧，确保下一个中只有一位*可以*设置为一位。由于该位被设置，循环一旦返回到*current的**第 3*位，就会停止。这可以防止电路停留在永久循环中。

 *我没有使用 Verilog 或 VHDL 的经验，所以我将把实际代码留给你[和 stackoverflow 的其余部分](https://stackoverflow.com/questions/486471/how-would-you-implement-this-digital-logic-in-verilog-or-vhdl)。

[替代文字 http://img145.imageshack.us/img145/5125/bitshifterlogicdiagramkn7.jpg](http://img145.imageshack.us/img145/5125/bitshifterlogicdiagramkn7.jpg)

**笔记：**

1.  这个解决方案只是部分的。它仍然需要某种锁存机制来保存位字段。
2.  请记住，随着位数的增加，栅极电压稳定所需的时间也会增加。
3.  必须有一些逻辑来处理*当前*字段等于零的情况。请参阅[此 stackoverflow 问题](https://stackoverflow.com/questions/486473/how-would-you-handle-a-special-case-in-this-digital-logic-system)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T16:48:02.007

假设二进制补码表示，在 C 中调用你的两个单词`mask`and `current`：

```
mask_lo = (current << 1) - 1; // the bits to the right and including current
mask_hi = ~mask_lo;           // the bits to the left of current
                              // the left bits, otherwise right:
next = (mask & mask_hi) ? (mask & mask_hi) : (mask & mask_lo);
return (next & -next);        // the least significant bit set 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-26T16:57:51.253

减法 1 是这里的基本思想。它用于通过位级联借用以查找下一个任务。

```
bits_before_current = ~(current-1) & ~current
bits_after_current = current-1
todo = (mask & bits_before_current) 
if todo==0: todo = (mask & bits_after_current) // second part is if we have to wrap around
next = last_bit_of_todo = todo & -todo 
```

这将在内部使用一个循环......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-26T16:59:01.203

有趣的问题！我不禁想知道您是否不能简化调度程序操作，所以这种操作是必要的。

鉴于您了解 VHDL，我不会详细介绍，但我的建议如下：

使用 3 位编码器将当前计划的任务变成一个数字：

01000000 --> 6

然后使用桶形移位器将遮罩旋转该数字 + 1（以跳过当前任务）：

00001010 --> 00010100

然后使用优先级编码器找到第一个可用的“下一个”任务：

00010100 --> 00000100 --> 2

然后通过加法反转桶形移位：

(2+7) % 8 = 1

重新编码时将给出下一个计划任务：

00000010

应该非常快速和直接，尽管桶式移位器在房地产方面“昂贵”，但我目前看不到一个简单的方法来解决这个问题。

编辑：Doug 的解决方案要优雅得多……

-亚当

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-28T21:39:58.107

这应该做你想要的：

```
number_of_tasks= <number of tasks, in the example this is 8>
next_mask= current | (current - 1);
next_barrel= next | (next << number_of_tasks);
next_barrel&= ~number_of_tasks;
next_barrel&= -next_barrel;
next_barrel|= next_barrel >> number_of_tasks;
next_task_mask= next_barrel & -next_barrel; 
```

基本上，复制下一个任务掩码的位，屏蔽掉我们不想考虑的位，找到最低设置位，将高位折回，然后取最低位设置。这在恒定时间内运行。

编辑：更新以考虑当前 == 00010000 和 next_mask == 00111000

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-09-27T18:42:47.740

未经测试，但在我的脑海中，如果这没有产生合理的综合，我会感到惊讶......与典型的比特旋转黑客相比，它具有相对可读的优势（无论如何对我来说）。

```
for i in current'range loop
  current := rotate_left(current, 1);
  if or_reduce(mask and current) = '1' then
     current:= mask and current;
  end if;
end loop; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-24T00:49:56.070

完整的参数化仲裁器实现，可配置为循环或优先级仲裁：

[https://github.com/alexforencich/verilog-axis/blob/master/rtl/arbiter.v](https://github.com/alexforencich/verilog-axis/blob/master/rtl/arbiter.v)

该设计使用一对优先级编码器来选择序列中的下一个输出。使用的优先级编码器被有效地实现为树。

# sql - 如何用面向对象的 Perl 组装 SQL？

> ID：480424
> 
> 赞同：9
> 
> 时间：2009-01-26T16:35:50.673
> 
> 标签：sql, perl, oop

我目前负责一个似乎与数据库非常亲密的过程。我的程序/脚本/框架的目标是使不同的数据源保持一致。使用一种依赖注入的形式，我的流程在非常高的级别上运行良好。每个数据源类型的实现对正在发生的事情的最高级别业务抽象是隐藏的。伟大的。我的问题是两个。

1) 我有一段很长的段落（困扰我的是长度），它在 Perl 空间中组装了一条 SQL 语句，说明如何将这些不同的数据源转换为一种同质的最终格式。所以 SQL 字符串总是取决于我正在使用的数据类型。WHERE 子句依赖，FROM 子句依赖，INSERT 子句依赖，一切都依赖。让我感到困惑的是高度依赖。如何以面向对象的方式对该过程进行建模？MagicObject->buildSQL？这基本上就是我现在所拥有的，但感觉代码的所有部分都知道太多，因此它很长。

2）如果我有一个函数可以做某事（构建 SQL？），我是否将整个业务对象传入，然后在最后一分钟将它们字符串化？还是我提前对它们进行字符串化，只让我的函数处理它需要的东西，而不是渲染对象本身？

**编辑**：虽然我不怀疑 ORM 的重要性，但我不相信我们还处于 ORM 领域。想象一下，美国、国家和虚构联盟的棒球数据都以完全不同的格式存储，并具有不同程度的标准化。我的流程的工作是读取这些数据源并将它们放入一个统一的规范化池中。我觉得作用于这些对象的 ORM 空间发生在我的过程之后。如果你愿意的话，我是一名数据管理员。由于缺乏我创建的统一池，因此基本上没有业务对象需要处理。

**编辑^2**：引起我注意的是，也许我没有足够详细地描述问题空间。这是一个例子。

想象一下，您必须建立一个包含美国所有犯罪分子的主数据库。贵公司的服务正在销售一种产品，该产品位于顶部并以干净、统一的格式提供对这些数据的访问。

这些数据由 50 个州公开提供，但格式截然不同。有些是一个数据文件，未标准化。其他是 CSV 格式的规范化表格。有些是 Excel 文档。有些是 TSV。甚至提供了一些在没有人工干预的情况下不完整的记录（其他手动创建的数据源）。

我的项目的目的是为 50 个州中的每一个州创建一个“驱动程序”，并确保该过程的最终产品是一个完美的关系模型中的犯罪主数据库。一切都正确键入，模式完美，等等。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-26T18:10:59.310

你想看看**[Fey](http://p3rl.org/Fey::SQL)**。几个月前我开始在工作中使用它，虽然由于年龄小，实施仍然有困难，但它背后的想法是可靠的。F.ex.，从手册中轻松修改查询：

```
my $user = $schema->table( 'user' );
my $q = Fey::SQL
    ->new_select
    ->select( $user->columns( 'user_id', 'username' ) )
    ->from( $user ); 
```

现在你可以写一个这样的函数：

```
sub restrict_with_group {
    my ( $q, $table, @group_id ) = @_;
    my $group = $schema->table( 'group' )->alias;
    $q
        ->from( $table, $group )
        ->where( $group->column( 'group_id' ), 'IN', @group_id );
} 
```

这将添加一个内部连接 ​​from `user`to`group`以及一个`WHERE`条件。瞧，您可以在主程序中编写以下内容：

```
restrict_with_group( $q, $user, qw( 1 2 3 ) ); 
```

**但是这个`restrict_with_group`函数适用于*任何*对表有外键的`group`查询！**要使用它，您需要传递要限制的查询和要对其应用限制的表，以及要限制它的组 ID。

最后你说，你会得到一个 SQL 字符串，代表你在对象`$q->sql( $dbh )`中建立的查询。`$q`

因此，基本上 Fey 为您提供了原生 SQL 所缺少的抽象功能。您可以从查询中提取可重用方面并将它们打包为单独的函数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-26T17:12:57.103

请不要编写自己的 ORM。使用类似[DBIx::Class](http://search.cpan.org/perldoc?DBIx::Class)的东西。

您提到的所有这些问题都已解决，并且在数千个其他应用程序中测试了该实现。坚持编写您的应用程序，而不是重新实现库。你可能实际上并没有在你的应用程序中*使用*DBIC，但你应该看看它的实现方法；尤其是它如何增量构建 ResultSets（不是结果集，而是延迟查询）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-26T17:59:40.347

如果您*不*想要 ORM，但想在不直接进行字符串操作/连接的情况下从位组装 SQL，请查看[Fey](http://search.cpan.org/dist/Fey)，它可能会满足您的需求。

更新：亚里士多德 Pagaltzis 的答案要好得多。他实际上给出了 Fey 的样子以及它如何提供帮助的例子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T17:54:42.353

从纯粹的编码角度来看 - 你手上有一段长而复杂的代码。你不喜欢它。为什么？我只能假设那里有一些代码重复。否则，有什么不喜欢的？所以，重构它以消除重复......我知道这听起来很陈词滥调，但由于您不发布代码，因此很难更具体。可能有一个对象具有 from、where 和 insert 子句的方法，这样 SQL 的基础结构就不会重复？我只是不知道该怎么做，但消除重复是关键。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T23:43:39.653

除非我有误解，否则这似乎是一个 ETL（提取/转换/加载）应用程序，还没有想出将三个阶段分开。

如果输出模型只是一个或两个表，那么您可能也可以使用 SQL。否则，特别是如果您要插入的表之间存在关系，一个体面的 ORM 应该可以简化事情。

采用 50 状态的想法，您无法真正摆脱 50 个“提取”进程，希望有一个共享例程库。我会一次解决一个输入源的问题，在添加新输入源时进行重构，但要小心封装可变部分，以便我确切知道当供应商更改其格式时需要在哪里进行更改。

“转换”部分不应该太繁重：只需将你得到的东西准备好输出即可。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T17:12:10.007

我认为您正在描述动态 SQL - 在运行时以编程方式构建请求。这是对象关系映射器（例如 LINQ to SQL 和 LLBLGenPro）的一个常见特性，仅举几例。建造一个绝非易事。

通常，ORM 对象化 SQL 语言。您编写了一种“SQL 文档对象模型 (DOM)”，它允许您通过将 SQL 查询（例如）表示为“请求”对象来以编程方式构建 SQL 查询。然后在 Request 对象上设置属性，例如 Column 集合、Table 集合和 Join 集合（这些只是一种方法的示例。）结果将是一个 SQL 请求字符串，作为 Request 对象的属性公开。

您还必须使 Request 对象能够读取数据源的架构定义。您提到您的 WHERE 子句是类型相关的。因此，您的 SQL 汇编器必须能够读取模式并适当地构建子句。

对于您的情况，这可能是矫枉过正。我认为基本问题是，您是否绝对需要动态 SQL 查询，或者是否有更简单的选项可以满足您的要求？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-29T18:34:28.257

在我看来，您可能需要查看您为解决此问题而采取的方法。您当前有多个数据源，您需要将其视为单个数据源。那么为什么要将它们作为单独的数据源呢？

根据数据更新的频率（或查看性能、访问频率），您可以将数据组合到临时数据源（如 SQLite）中。如果您来自每个州的数据都有一个转换器，可以将其从格式 A 转换为 SQLite 表中的常用格式，那么您可以使用您选择的方法来访问它。

此方法还具有灵活性，因为您的数据访问需求可能会发生变化。例如，如果您被问到“每个州有多少金发碧眼的司机有超速罚单？”这个问题。SQLite 数据库可以使用单个命令完成此操作，而其他解决方案可能需要返回一组数据，然后需要对这些数据进行解析、分组和设置以供输出。

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2009-01-26T18:14:15.293

如果你不想处理 ORM，我经常有这样的代码：

```
my (@columns,@tables,@wheres,@order_bys,@values);

... # Add value to those variables as needed, using push.
... # use ? for variables to be quoted

# Build SQL statement
my $sql = "select ".join(",",@columns).
    " from ".join(",",@tables).
    " where ".join(" and ",@wheres).
    " order by ".join(",",@order_bys);

my $sth = $dbh->prepare($sql);
$sth->execute(@values); 
```

简单，不需要ORM，非常可定制。另外，对于我要处理的数据量，我总是觉得 ORM 过于繁重，但这是另一个主题。

# c# - ASP.Net 验证文化名称

> ID：480425
> 
> 赞同：6
> 
> 时间：2009-01-26T16:36:02.153
> 
> 标签：c#, .net, asp.net, culture

我们有一个使用 asp.net 2.0 文化的多语言网站。当前文化是通过重写为查询字符串的 url 设置的。（~/es/blah.aspx 是 ~/blah.aspx 的西班牙语版本 - 重写为 ~/blah.aspx?lang=es）

测试文化的代码如下：

```
 System.Globalization.CultureInfo ci;
    try
    {
        ci = new System.Globalization.CultureInfo(Request.QueryString["lang"] ?? string.Empty);
    }
    catch
    {
        ci = new System.Globalization.CultureInfo(string.Empty);
    } 
```

如果没有设置文化，则默认为英语，127。当有文化时，该页面上的所有链接都会在前面加上正确的文化名称。

不知何故，蜘蛛以 ~/www.test.com/blah.aspx 的形式获取了一些链接，并以 www.test.com 的文化冲击我们的网站，并淹没了我们的错误日志记录。

除了捕获异常之外，还有什么方法可以测试文化名称是否有效？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-11T17:42:47.910

我想我可以快速测量一下，所以我开发了一个快速的控制台应用程序。

它基本上使用所有 3 种方法（构造函数、LINQ 和 foreach）在循环中从字符串中获取 CultureInfo 10000 次。为简洁起见，我删除了秒表和控制台输出。

```
string culture = "en-GB";
CultureInfo[] cultures = CultureInfo.GetCultures(CultureTypes.SpecificCultures);
for (int i = 0; i < 10000; i++)
{
    try
    {
        CultureInfo c = new CultureInfo(culture);
    }
    catch
    {
    }
}
for (int i = 0; i < 10000; i++)
{
    CultureInfo c = cultures.FirstOrDefault((x) => x.Name == culture);
}
for (int i = 0; i < 10000; i++)
{
    foreach (CultureInfo c in cultures)
    {
        if (c.Name == culture)
            break;
    }
} 
```

结果如下...

```
Try Catch: 00:00:00.0023860
LINQ: 00:00:00.0542459
ForEach: 00:00:00.0238937 
```

如果删除文化变量并在每次迭代中调用它，则 LINQ 和 ForEach 循环大约需要 2.5 秒。

因此，如果您希望获得大量有效输入并且只获得奇数无效输入，则使用构造函数是有利的。但是，如果您更改值，如果输入从`en-GB`到 ，`TEST`那么事情会发生巨大变化。

```
Invalid Culture Try Catch: 00:00:39.7163513
Invalid Culture LINQ: 00:00:00.0791752
Invalid Culture ForEach: 00:00:00.0291480 
```

显然我的测试应用程序不是真实世界的场景，但是由于 OP 说这是基于每个请求调用的，我可以想象在大型 Web 应用程序中，这段代码可能会被调用很多次。它可能是一个拒绝或服务向量，通过向 Web 服务器发送垃圾邮件，这些请求都具有无效的文化参数，从而占用了所有 CPU。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-26T19:21:46.687

您不必*使用*LINQ：

```
private static bool IsValidCultureName(string cultureName)
{
    CultureInfo[] cultures =
        CultureInfo.GetCultures(CultureTypes.SpecificCultures);
    foreach (CultureInfo culture in cultures)
    {
        if (culture.Name == cultureName)
            return true;
    }

    return false;
} 
```

这可能非常昂贵，但可能仍然比处理非常昂贵的异常便宜——不过，在相信我的话之前先衡量一下差异。

我认为定义的文化列表不会在 .NET 版本之间发生变化，因此您可能应该在启动时获取该列表并将其缓存在某处。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-10-07T18:37:31.267

与已经说明的答案几乎相同，只是使用更紧凑的 linq 表达式：

```
private static bool IsValidCultureInfoName(string name)
{
    return 
        CultureInfo
        .GetCultures(CultureTypes.SpecificCultures)
        .Any(c => c.Name == name);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T16:40:46.543

[该站点](http://stribny.name/netbits/validating-culture-name-using-linq)有一个使用 LINQ 的示例：

```
CultureInfo[] cultures = System.Globalization.CultureInfo.GetCultures
                         (CultureTypes.SpecificCultures);

var selectCulture = from p in cultures
                    where p.Name == value
                    select p;

if (selectCulture.Count() == 1)
{
    // your culture is good
} 
```

不过好像有点重。我可能会坚持你所拥有的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-05T21:35:57.927

这是我最终为我的动作过滤器所做的。我们只检查语言，而不是语言环境。

```
public class HttpInternationalizationAttribute : ActionFilterAttribute
{
    private static readonly HashSet<string> Langs = new HashSet<string>(CultureInfo.GetCultures(CultureTypes.NeutralCultures)
                                                                           .Select(x => x.TwoLetterISOLanguageName.ToUpper()));

    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        var language = (string)actionContext.ControllerContext.RouteData.Values["language"];

        if (!string.IsNullOrEmpty(language) && Langs.Contains(language.ToUpper()))
        {
            Thread.CurrentThread.CurrentCulture = CultureInfo.GetCultureInfo(language);
            Thread.CurrentThread.CurrentUICulture = CultureInfo.GetCultureInfo(language);
        }
    }
} 
```

使用哈希集，这将在 O(1) 中运行。

干杯！

# postgresql - 在 postgres 中插入期间触发更新列

> ID：480426
> 
> 赞同：0
> 
> 时间：2009-01-26T16:36:23.980
> 
> 标签：postgresql, triggers

我有两个表（在 postgres 中） - 广告和日志。每次插入日志表后，根据操作，它应该增加 ads 表中列的计数。

我试图编写触发器将调用的函数，但是在尝试创建函数时会引发错误。我是 postgresql 触发器和函数的新手，所以有人可以指出这有什么问题。

```
create function update_ad_count (action character(4), ad_id INT) returns void 
as $$case when action='VIEW' then
(UPDATE ads SET views = (SELECT views+1 FROM ads WHERE id=ad_id), updated = now() WHERE id=ad_id;)
end;$$
language sql 
```

我得到的错误是

```
ERROR:  syntax error at or near "case"
LINE 2: as $$case when action=\'VIEW\' then
             ^ 
```

**更新：** @Tomalak：感谢功能和更新更新语句（无法抗拒双关语）。

经过大量谷歌搜索后，我了解到该函数不应该有任何参数并使用 NEW.col_name 并且应该返回一个 TRIGGER。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T16:49:50.097

首先，您的 UPDATE 调用应该是：

```
UPDATE ads SET views = views + 1, updated = NOW() WHERE id = ad_id; 
```

根据[文档](http://www.postgresql.org/docs/8.1/static/sql-createfunction.html)，应该这样做：

```
CREATE FUNCTION update_ad_count (action CHARACTER(4), ad_id INT) 
RETURNS VOID
AS $$ 
BEGIN
  IF action = 'VIEW' THEN
    UPDATE ads SET views = views + 1, updated = NOW() WHERE id = ad_id;
  END IF;
END;
$$ LANGUAGE plpgsql; 
```

CASE 不是流控制语句，它不能像 IF 语句那样使用。它是一个产生价值的语句（一个表达式）并且必须按原样使用，例如，您必须从中选择/更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T16:41:22.237

我对postgresql不是很熟悉，但根据我所知道的......不应该是“$$ case”而不是“$$case”吗？

# c# - 从一个正在运行的控制台应用程序向另一个应用程序发送消息

> ID：480430
> 
> 赞同：8
> 
> 时间：2009-01-26T16:39:16.250
> 
> 标签：c#, .net, ipc

我有一个控制台应用程序正在与 ftp 服务器进行长时间的同步。
另一个控制台应用程序准备一个本地文件系统，其中包含一些需要的更新文件。
然后第二个将等待第一个完成，然后交换最终目录名称，使其在网络上可见。

我搜索了使同步应用程序与第二个应用程序通信它已完成工作的最佳方法。看起来[为 IPC 使用数据复制](http://msdn.microsoft.com/en-us/library/aa365574(VS.85).aspx#base.using_data_copy_for_ipc)是最适合此问题的解决方案。

问题有两个：

*   我对吗？有没有更直接的方法来获得相同的结果？
*   是否有托管（.net）方式来做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-26T17:54:13.167

如果您只需要通知一个应用程序另一个已完成其任务，那么最简单的方法是使用命名的 EventWaitHandle。该对象是在其未发出信号的状态下创建的。第一个应用程序在句柄上等待，第二个应用程序在完成工作时向句柄发出信号。例如：

```
// First application
EventWaitHandle waitForSignal = new EventWaitHandle(false, EventResetMode.ManualReset, "MyWaitHandle");

// Here, the first application does whatever initialization it can.
// Then it waits for the handle to be signaled:
// The program will block until somebody signals the handle.
waitForSignal.WaitOne(); 
```

这设置了第一个等待同步的程序。第二个应用同样简单：

```
// Second app
EventWaitHandle doneWithInit = new EventWaitHandle(false, EventResetMode.ManualReset, "MyWaitHandle");

// Here, the second application initializes what it needs to.
// When it's done, it signals the wait handle:
doneWithInit.Set(); 
```

当第二个应用程序调用 Set 时，它会发出事件信号，第一个应用程序将继续。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T16:44:59.250

IPC 的其他流行选项包括：

*   命名管道
*   远程处理 (.NET)
*   WCF

如果您只需要同步，您可以考虑使用`Semaphore`、 或`Mutex`对象。.NET的命名空间中存在一些类，`System.Threading`如果您创建它们的命名版本，那么它们将应用于整个机器。

# xml - 如何使用 Groovy 的 XmlSlurper 检查元素是否存在？

> ID：480431
> 
> 赞同：33
> 
> 时间：2009-01-26T16:39:38.997
> 
> 标签：xml, groovy, xmlslurper

我正在尝试使用 Groovy 的 XmlSlurper 确定 XML 元素是否存在。有没有办法做到这一点？例如：

```
<foo>
  <bar/>
</foo> 
```

如何检查 bar 元素是否存在？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-27T03:40:15.137

API 有点古怪，但我认为有几个更好的方法来寻找孩子。当您要求“xml.bar”（存在）或“xml.quux”时，您得到的是一个[groovy.util.slurpersupport.NodeChildren](http://groovy.codehaus.org/gapi/groovy/util/slurpersupport/NodeChildren.html)对象。基本上是满足您要求的标准的节点集合。

查看特定节点是否存在的一种方法是检查 NodeChildren 的大小是预期大小：

```
def text = "<foo><bar/></foo>"
def xml = new XmlSlurper().parseText(text)
assert 1 == xml.bar.size()
assert 0 == xml.quux.size() 
```

另一种方法是使用 find 方法并查看返回的节点的名称（不幸的是总是返回一些东西），是否是您所期望的：

```
def text = "<foo><bar/></foo>"
def xml = new XmlSlurper().parseText(text)
assert ("bar" == xml.children().find( {it.name() == "bar"})?.name())
assert ("quux" != xml.children().find( {it.name() == "quux"})?.name()) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-26T16:53:59.137

GPathResult 上的 isEmpty 方法有效。

```
def text = "<foo><bar/></foo>"
def xml = new XmlSlurper().parseText(text)
assert false == xml.bar.isEmpty() 
```

这让我很困扰，因为 bar 元素**是**空的——它没有主体。但我想 GPathResult 不是空的，所以也许这是有道理的。

# java - 使用 Runtime.exec 从 Java 应用程序启动 JVM 进程？

> ID：480433
> 
> 赞同：19
> 
> 时间：2009-01-26T16:40:39.507
> 
> 标签：java, process, launch

我希望能够从现有的 java 应用程序启动 Java 服务器进程并监视 stdoutput 和 stderror 并将该输出重定向到文件。是使用“Runtime.exec”并将应用程序视为任何其他操作系统进程的最佳方法，还是有更适合新 JVM 的东西。

这是在 Java 1.5 上

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-26T16:48:14.343

而不是`Runtime`，您可能应该使用[`ProcessBuilder`](http://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.html)，尽管我不知道在您的情况下是否更合适（特别是运行 Java 进程）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-06T19:12:48.350

我知道我在这个线程中迟到了，但如果有人需要它，根据我的经验，使用 ANT 启动 Java 应用程序更容易。这具有独立于平台的好处。这是一个执行此操作的示例类：

```
package com.trilliantnetworks.scheduler.quartz.test;

import java.io.File;
import java.io.PrintStream;
import org.apache.tools.ant.BuildException;
import org.apache.tools.ant.DefaultLogger;
import org.apache.tools.ant.DemuxOutputStream;
import org.apache.tools.ant.Project;
import org.apache.tools.ant.taskdefs.Echo;
import org.apache.tools.ant.taskdefs.Java;
import org.apache.tools.ant.types.Path;

public class MyLaunchTest {

public static void main(String[] args) {

    Project project = new Project();
    project.setBaseDir(new File(System.getProperty("user.dir")));
    project.init();
    DefaultLogger logger = new DefaultLogger();
    project.addBuildListener(logger);
    logger.setOutputPrintStream(System.out);
    logger.setErrorPrintStream(System.err);
    logger.setMessageOutputLevel(Project.MSG_INFO);
    System.setOut(new PrintStream(new DemuxOutputStream(project, false)));
    System.setErr(new PrintStream(new DemuxOutputStream(project, true)));
    project.fireBuildStarted();

    System.out.println("running");
    Throwable caught = null;
    try {
        Echo echo = new Echo();
        echo.setTaskName("Echo");
        echo.setProject(project);
        echo.init();
        echo.setMessage("Launching Some Class");
        echo.execute();

        Java javaTask = new Java();
        javaTask.setTaskName("runjava");
        javaTask.setProject(project);
        javaTask.setFork(true);
        javaTask.setFailonerror(true);
        javaTask.setClassname(MyClassToLaunch.class.getName());
        Path path = new Path(project, new File(System.getProperty("user.dir") + "/classes").getAbsolutePath());
        javaTask.setClasspath(path);
        javaTask.init();
        int ret = javaTask.executeJava();
        System.out.println("java task return code: " + ret);

    } catch (BuildException e) {
        caught = e;
    }
    project.log("finished");
    project.fireBuildFinished(caught);
}
} 
```

# java - 新的 WAS-CE 安装只提供“HTTP 400 'bad request'”？

> ID：480437
> 
> 赞同：0
> 
> 时间：2009-01-26T16:42:24.980
> 
> 标签：java, ubuntu, websphere-ce

我提前为我所期待的事情道歉，这是一个可怕的菜鸟问题。

我决定尝试使用 IBM 的 WAS-CE 平台用 Java 开发 Web 应用程序。我以前从未使用过这个平台，也没有使用过任何其他运行 Java Web 应用程序的平台（我的所有 Web 项目都使用 php）。

现在，我下载了社区版的 WAS，并将其安装在我的笔记本电脑上（Ubuntu 8.10、64 位、java-6-sun-1.6.0.10）。它就像一个魅力。我继续在我的开发服务器（Ubuntu 8.10、32bit、java-6-sun-1.6.0.07）上安装 WAS-CE，看起来还不错。

但是，当我连接到服务器时（并且它确实绑定到我期望的所有端口），当 firefox 请求一个页面（没有尝试过其他浏览器）时，服务器返回一个 HTTP 400 - “错误请求”。如果手动连接到服务器并给它一个纯“GET /\n\n”，它只会关闭连接，而在我的笔记本电脑上这样做可以正常工作。

我能发现这两种安装之间的唯一区别是较旧的 Java 版本（1.6.0.07 是 ubuntu 存储库中的当前版本）和 32 位处理器。那些 Java 版本之间是否存在如此巨大的差异，以至于 WebSphere 实际上会失败？

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-02T16:33:51.010

这是 WAS CE 设置故障排除文档的链接。 [http://publib.boulder.ibm.com/wasce/V2.1.0/en/setup-troubleshooting.html](http://publib.boulder.ibm.com/wasce/V2.1.0/en/setup-troubleshooting.html)

我不确定这是否有帮助，但您也可以尝试使用 IBM JDK 而不是 Sun。 [http://publib.boulder.ibm.com/wasce/V2.1.0/en/installing-an-application-server.html](http://publib.boulder.ibm.com/wasce/V2.1.0/en/installing-an-application-server.html)

# html - 从 html 共享 Outlook 日历

> ID：480438
> 
> 赞同：2
> 
> 时间：2009-01-26T16:42:45.807
> 
> 标签：html, outlook, calendar, share

是否可以从网页链接到某人的 Outlook 日历（假设您有权限通过 Outlook 本身查看它）？

我在一个 Intranet 站点上工作，并想提供一个指向某人日历的链接，类似于：

```
    展望：\\公共文件夹\所有公共文件夹\共享日历

```

但是，这不是我想分享的公共日历，而是一个人的个人日历。目前，我可以转到 Outlook 中的日历选项卡，单击“打开共享日历...”并打开此人的日历。但是如何创建指向它的链接，以便其他人可以直接从 Intranet 站点打开它。

当我将日历拖放到电子邮件消息或 word 中时，我得到如下内容：outlook:\00000000887D87050344B04AA77DC6DC84B49A4C0100CB432CC39A577C4CBB19ECFA。

此链接在电子邮件中有效，但不适用于 word 或 html。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T20:24:12.997

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T23:46:43.520

如果你有交换作为你的后端，你可以像我一样做。在服务器上，我调用了 Exchange Web 服务来获取用户日历。然后我显示了即将到来的约会。当用户单击约会时，它会启动您提到的链接。我不确定这是否正是您想要的，所以请澄清是否不是。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-26T17:58:38.120

[在线文档](http://office.microsoft.com/en-us/outlook/HA101743551033.aspx?pid=CH102499821033)有帮助吗？

# .net - 在 F# 中，我可以有一个在一个线程上调用但在另一个线程上返回的函数吗？

> ID：480439
> 
> 赞同：0
> 
> 时间：2009-01-26T16:42:46.743
> 
> 标签：.net, multithreading, f#

我真的希望能够让一个函数将一些责任传递给另一个对象，然后在另一个线程上返回。我知道这意味着调用者不会知道它已经切换了线程，但我真的很想知道是否有任何方法可以让函数在与调用它不同的线程上返回。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T17:28:29.163

您似乎对线程的工作方式有一些误解。您不能在一个线程中输入一个函数并在另一个线程中退出它（线程具有单独的堆栈，堆栈维护您所在的功能）。您可以做的是使用异步 api，它调用一个立即返回并允许稍后检索结果的函数。

选项包括：

返回一些值，该值将允许查询异步操作的状态（“你完成了吗”）并允许在指示完成后检索结果（“给出结果”）这些通常允许在多个线程上使用。

为原始函数提供一个函数，该函数将在结果完成后调用（通常发生此回调的线程定义不明确，因为它可能来自某个线程池。

异步 api 通常很复杂。

通常需要一个函数调用来*同步*调用不同线程上的某个其他函数。常见的例子是将一些调用偷运到事件循环调度线程（在 Windows 中通过 Invoke() 方法）。

系统可能会提供与 fork() 等效的线程，其中克隆整个线程（包括到目前为止的堆栈），然后两个线程都从函数返回。这种行为可能非常容易出现错误。

[延续](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!256.entry)可能会提供一种可控的方式来完成您想要实现的目标，但它们非常复杂，并且可能会损害您想要实现的目标的可读性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T18:16:23.747

异步工作流给人一种这样的错觉，例如

```
async {
    printfn "on thread 1..."
    let! r = stream.ReadAsync()
    printfn "on thread 2 now..."
    ...
} 
```

但让代码易于阅读、编写和推理只是一种幻想；在引擎盖下，它使用 BeginRead/EndRead/callbacks/etc 执行所有正常的异步操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T17:32:16.113

使用 .NET 异步委托，您可以将对象传递给在单独线程上执行的函数，并让它在完成时执行回调函数。该回调函数将在与主线程不同的线程上调用。

如果您熟悉 C# 或 Visual Basic，则可以找到很多关于在 .NET 中使用异步委托的信息。我还没有看到 F# 中对异步委托的良好处理。

# c# - 什么是 - 单次和多次调度（与 .NET 相关）？

> ID：480443
> 
> 赞同：7
> 
> 时间：2009-01-26T16:43:31.420
> 
> 标签：c#, multiple-dispatch, single-dispatch

是否与重载相同，如果不是，请您提供每个 C# 中的示例

我已经阅读了对 SO 中提出的类似问题的回复......我不明白发布给它的回复。

类似的问题[在这里问](https://stackoverflow.com/questions/479923/is-c-a-single-dispatch-or-multiple-dispatch-language)

编辑：在 C# 4.0 中使用新的“动态”关键字......这会使语言“多调度”启用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T17:09:26.970

多重分派是重载的一种“形式”......

例如，C# 是单分派，因为 if 仅根据一个参数“this”指针来计算调用什么方法。当你有这样的事情：

```
Base base= new Derived();
base.DoSomething(); 
```

即使您通过基指针调用该方法 Derived.DoSomething 也会被调用。现在，如果我们有以下内容：

```
class Derived : Base
{
  public override void Process(Stream stream);
  public override void Process(FileStream stream);
  public override void Process(MemoryStream stream);
} 
```

我们这样做：

```
Stream stream= new MemoryStream(...);
Base b= new Derived();
b.Process(stream); 
```

然后我们将调用**Process(Stream)**方法，`Derived`因为 C# 对对象指针 (b) 进行了一次分派，然后使用编译时间信息来决定调用哪个方法。即使**流**是 MemoryStream，单个调度系统也会忽略这一点。

在多调度系统中，将查看对象指针（如在 C# 中）并检查参数的运行时类型。在上面的例子中，因为**流**实际上是一个 MemoryStream 系统会调用**Process(MemoryStream)**方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T17:03:03.380

C# 使用单一调度，其中包括重载方法。当你有代码

```
stringBuilder.Append(parameter); 
```

调度程序查看在 stringBuilder 的类上定义的所有方法，并找到正确的方法。

对于多分派示例，让我们看一下 Prolog（这是我能想到的第一个）。您可以在 prolog 中定义一个函数，如下所示：

```
func(Arg1, Arg2) :- ....body.... 
```

这不是在任何类中定义的，而是在全局范围内定义的。然后，你可以调用`func(Arg1, Arg2)`任意两个参数，这个函数就会被调用。如果你想要重载之类的东西，你必须验证函数内部的参数类型，并多次定义它：

```
func(Arg1, Arg2) :- is_number(Arg1), is_string(Arg2), ....body....
func(Arg1, Arg2) :- is_string(Arg1), is_list(Arg2), ....body....
func(Arg1, Arg2) :- is_number(Arg1), is_list(Arg2), ....body.... 
```

然后，您将发送的任何两种参数类型都将被检查 - 即多分派部分。

简而言之，单次调度只查看在第一个参数上定义的方法（在我们的第一个示例中，stringBuilder），然后解析正确的重载以使用其他参数调用。多重分派具有在全局范围内定义的方法/函数，并在重载决议期间将所有参数视为相同。

我希望我说清楚了，这是一个相当困难的话题。

* * *

~~更新：我忘了提，多分派发生在运行时，而单分派发生在编译时。~~
更新#2：显然，这不是真的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T16:57:01.737

多分派与方法重载有关，但并不相同。前者是动态运行时决策，后者是静态编译时决策。隐含了灵活性的好处，但因此多分派的性能成本。

AFAIK 一种语言可以支持任何一种，但不能同时支持两者，尽管两者都可以模拟（可以与访问者一起模拟多调度）。C# 在编译时确定数据类型，因此不是多调度语言，因此不可能有示例。

*（警告：我不是 100% 的）*

* * *

附录：实际上 wikipedia 有[一篇](http://en.wikipedia.org/wiki/Multiple_dispatch)关于这方面的文章，看起来非常详尽，哦，还有一个有用的 LISP 示例

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T16:55:47.713

单/多分派是一种运行时重载。单一调度通常被称为虚函数。调用虚函数时调用的确切函数取决于对象的运行时类型。双分派是同样的事情，扩展为使用两个对象——通常是`this`参数和第二个参数。您可以使用 Vistor 模式轻松实现这一点。多重分派进一步将此概念扩展到更多参数，但在 C# 等语言中实现起来要困难得多（并不是说它不能完成，只是很难）。一些语言开箱即用地实现了这种能力。

例如，在 .NET 中，ToString() 函数是单个调度的示例

```
// Single dispatch
Object o = GetSomeObject(); // Return SomeType casted to Object.
o.ToString(); // Call SomeType::ToString instead of just Object::ToString

// Double dispatch (this version won't work in C#)
Shape s1 = GetSquare();
Shape s2 = GetCircle();
s1.Intersects(s2); // If C# supported double dispatch, this would call Square::Intersects(Circle) not Square::Intersects(Shape) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T17:04:45.717

在 OO 语言中，文本：

```
SomeType b;
a = b.Foo(c, d) 
```

表示对象 b 正在传递一个带有参数 c 和 d 的消息 Foo。单一分派意味着该系统只有一个方面负责在运行时确定（可能有很多）方法 Foo 将实际被调用。

java、c# 和大多数其他 OO 语言使用的模型是，只有运行时类型的“b”才能“决定”实际的方法调用是什么。因此，如果您有 SomeType 的两个实现，它们都提供了不同的 Foo 实现，那么使用哪个类型的决定完全取决于此时恰好是哪种类型。如果 Foo 有多个*重载*，那么关于使用哪个重载的决定是编译时决定，仅基于编译时知道 b、c 和 d 的类型。

这就是单调度，单点选择是与 b 关联的类型系统。

Multiple Dispatch 将在运行时允许 b、c 和 d 的运行时类型决定调用哪个方法（这样的决定不可避免地会更复杂）。

在一个更加动态的系统中，定义明确的类型的概念更加流畅（比如一个基于原型的系统，而不是你从 c++/java/C# 知道的继承模型），那么关于调用什么方法的决定将完全由到实际情况 b、c 和 d。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T17:08:10.827

```
#include <iostream>

class Pet {
};

class Cat: public Pet {
};

class Dog: public Pet {
};

class Human {
};

class Man : public Human {
        public:
                void Kick(Cat& victim);
                void Kick(Dog& victim);
};

class Woman : public Human {
        public:
                void Kick(Cat& victim);
                void Kick(Dog& victim);
};

void Man::Kick(Cat& victim) {
        std::cout << "Meow!!!" << std::endl;
}

void Woman::Kick(Cat& victim) {
        std::cout << "I won't kick a cat" << std::endl;
}

void Man::Kick(Dog& victim) {
        std::cout << "I won't kick a dog" << std::endl;
}

void Woman::Kick(Dog& victim) {
        std::cout << "Woof!!!" << std::endl;
}

int main(int argc, char** argv) {
        Man kicker;
        Dog victim;
        Pet zoo[] = { victim };
        kicker.Kick(victim);
//      kicker.Kick(zoo[0]);   // No multimethods
        return 0;
} 
```

至于现在，C++ 无法在运行时确定 a`Pet`实际上是 a`Cat`还是 a `Dog`。

如果在运行时有某种方法可以做到这一点（这样上面的代码将在未注释注释行的情况下编译），C++ 将被称为支持多调度或多方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-17T16:19:54.080

在 c# 4.0 中，使用新的动态关键字启用了多方法：

使用系统；命名空间示例 { 类 Wheel { public void RepairWell() { } }

```
class Chassis
{
    public void RepairChassis() { }
}

class Engine
{
    public void RepairEngine() { }
}

class CarWorkshop
{
    public string Repair(Wheel value)
    {
        value.RepairWhell();
        return "wheel repaired";
    }
    public string Repair(Chassis value)
    {
        value.RepairChassis();
        return "chassis repaired";
    }
    public string Repair(Engine value)
    {
        value.RepairEngine();
        return "engine repaired";
    }
}

class Program
{
    static void Main(string[] args)
    {
        dynamic carWorkshop = new CarWorkshop();

        var whell = new Wheel();
        var chassis = new Chassis();
        var engine = new Engine();

        Console.WriteLine(carWorkshop.Repair(whell));
        Console.WriteLine(carWorkshop.Repair(chassis));
        Console.WriteLine(carWorkshop.Repair(engine));
        Console.ReadLine();
    }
} 
```

}

在c#中动态引入多方法，一个非常强大的范例。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-17T19:31:28.577

对不起，我之前给出的例子是错误的。那不是正确的版本：

```
class Wheel
{
    public void RepairWhell() { }
}

class Chassis
{
    public void RepairChassis() { }
}

class Engine
{
    public void RepairEngine() { }
}

class CarWorkshop
{
    public string Repair(Wheel value)
    {
        value.RepairWhell();
        return "wheel repaired";
    }
    public string Repair(Chassis value)
    {
        value.RepairChassis();
        return "chassis repaired";
    }
    public string Repair(Engine value)
    {
        value.RepairEngine();
        return "engine repaired";
    }
}

class Program
{
    static void Main(string[] args)
    {
        var carWorkshop = new CarWorkshop();

        dynamic whell = new Wheel();
        dynamic chassis = new Chassis();
        dynamic engine = new Engine();

        Console.WriteLine(carWorkshop.Repair(whell));
        Console.WriteLine(carWorkshop.Repair(chassis));
        Console.WriteLine(carWorkshop.Repair(engine));
        Console.ReadLine();
    }
} 
```

所以答案是肯定的。C# 提供多分派。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-01-26T22:31:39.633

您可以使用 dynamic 关键字在 C# 中实现多分派。

```
interface IA { }
interface IB { }
class CA1 : IA {}
class CA2 : IA {}
class CA11 : CA1 {}
class CB1 : IB {}
class CB2 : IB {}

class MD
{
    public enum X { X } ;
    public static void Foo(IA a, IB b, X dispatch = X.X) { Foo((dynamic)a, (dynamic)b); }
    static void Foo(IA a, IB b) { Console.WriteLine("IA IB"); }
    static void Foo(CA1 a, CB1 b) { Console.WriteLine("CA1 CB1"); }
    static void Foo(CA2 a, CB1 b) { Console.WriteLine("CA2 CB1"); }
    static void Foo(CA1 a, CB2 b) { Console.WriteLine("CA1 CB2"); }
    static void Foo(CA2 a, CB2 b) { Console.WriteLine("CA2 CB2"); }
    static void Foo(CA11 a, CB2 b) { Console.WriteLine("CA11 CB2"); }
}
class Program
{
    static void Main(string[] args)
    {
        var a1 = new CA1();
        var a11 = new CA11();
        var a2 = new CA2();
        var b1 = new CB1();
        var b2 = new CB2();
        MD.Foo(a1, b1);
        MD.Foo(a2, b1);
        MD.Foo(a1, b2);
        MD.Foo(a2, b2);
        MD.Foo(a11, b1);
        MD.Foo(a11, b2);
    }
} 
```

Foo((dynamic)a,(dynamic)b)) 的解析是在运行时完成的，并根据 'a' 和 'b' 的具体类型选择重载的 Foo 方法之一。

# .net - WSE 服务的 IPasswordProvider 在哪里？

> ID：480445
> 
> 赞同：-1
> 
> 时间：2009-01-26T16:43:56.583
> 
> 标签：.net, web-services, wse

我在 WSE 项目中找不到 IPasswordProvider 接口。

我想创建一个自定义密码提供程序，所以我必须实现这个接口。

它在哪个命名空间中？

在 VS.NET 中，我在任何地方都找不到 Microsoft.Web.Services.Security？

**更新** 我找到了 Microsoft.Web.Services3，是 .net 3.5 还是在 .net 2.0 中仍然有效？

但是我在Services3中找不到接口？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T17:32:28.890

我假设您使用的是 WSE 版本 2 或更高版本。IPasswordProvider 接口从版本 2 开始已过时。请参阅此处了解更多信息：

[http://msdn.microsoft.com/en-us/library/ms827740.aspx](http://msdn.microsoft.com/en-us/library/ms827740.aspx)

# java - 捕获多个异常并重新抛出一般异常

> ID：480454
> 
> 赞同：6
> 
> 时间：2009-01-26T16:46:01.120
> 
> 标签：java, exception

我正在使用反射将一些数据添加到第三方库中的类内的私有变量中。一路上大约有四种不同的异常可以被抛出；所有这些都与反射有关，并且所有这些都不太可能发生。我正在硬编码所涉及的类和变量的名称。我不太可能收到任何未找到类或未找到字段的错误，除非图书馆有一天升级并发生了重大变化。

我宁愿不声明所有这四个异常让我的调用者处理。他很可能再也见不到他们了。我想捕获所有这些并抛出另一个异常，说“发生了 Java 反射错误；很可能该库已升级并以与此方法不兼容的方式进行了更改。” 我是否可以抛出一个标准的 Java 异常来指示一般反射错误？我应该定义我自己的吗？或者最好只是声明这个方法可以抛出所有可能的反射异常？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T16:50:11.143

我通常会问自己这些问题：

*   调用此方法的人能否以不同方式处理这些不同的异常类型？
*   ...或者他们会一视同仁吗？
*   调用者/用户甚至可以从这个错误中恢复吗？

如果调用代码可能将所有这四个异常都视为相同（作为不可恢复的错误），那么捕获它们中的每一个并重新抛出更一般的（单个）异常是绝对有意义的。如果这样做，请确保将生成的异常附加为内部异常，以帮助在另一端进行任何调试或故障排除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T16:52:46.300

关于已检查和未检查的异常存在一些争议。就我个人而言，我认为检查异常是 Java 中最糟糕的想法——但这只是一种观点（但我并不孤单这样认为）

无论如何，我认为重要的是将它们更改为单个未经检查的异常。我经常使用 IllegalStateException 或 IllegalParameterException 之类的单个异常——带有明文描述，这两个异常涵盖了 90% 的方法可能出错的废话。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T17:21:08.380

首先，不要使用反射，除非你真的，真的必须这样做，因为它是邪恶的。假设您必须：

当您对所有名称进行硬编码时，它只会留下`Method.invoke`,`Constructor.newInstance`和`Field.get/set`. 我建议只重新抛出您可以处理的已检查异常`Error`。它们不应该发生，如果你想处理它，我建议在类初始化时进行检查。`InvocationTargetException`当然，应该以适当的方式解包和处理（抛出`Error`方法/构造函数未声明的已包装检查异常）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T22:01:02.950

如果您从不期望它们发生，您可以将所有异常转换为 AssertionError。如果要处理特定异常，可以解开 InvocationTargetException。如果你想抛出由方法而不是 InvocationTargetException 抛出的实际异常，你可以使用这个技巧，但它可能比有用更令人困惑

```
} catch (InvocationTargetException e) {
    // Throw any exception in the current thread (even if it is a checked exception)
    Thread.currentThread().stop(e.getCause());
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-16T01:58:01.530

让那些 Exception 类从 GeneralException 扩展并捕获那个 GeneralException 怎么样？

我现在就试试这个！:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T16:53:53.553

我认为在这种情况下声明异常没有意义。所以我会从反射中捕获异常，可能会记录堆栈跟踪，并抛出一些 RuntimeException，它的优点是不需要声明。如果您很懒惰，您可以只使用带有合适消息的 RuntimeException。

# opengl - 如何使用 GPU 高效地渲染和处理视频流？

> ID：480460
> 
> 赞同：3
> 
> 时间：2009-01-26T16:47:16.640
> 
> 标签：opengl, gpu, shader

我计划开发一个使用 C++、Qt 和 OpenGL 进行实时视频操作的工具。视频叠加不是一个选项，因为着色器应该用于帧处理。目前我想象以下步骤顺序：

1.  解码视频 (CPU)
2.  预处理它（可选，CPU）
3.  将其传输到视频内存（使用 DMA 的 GPU）
4.  使用顶点和片段着色器 (GPU) 进一步处理它
5.  渲染它（GPU）

我正在寻找一些一般性建议来解释可以在这里使用哪些扩展或技术。是否有充分的理由使用 Direct3D？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T17:13:25.590

如果你是 linux，NVIDIA 最近的 180.xx 系列驱动程序通过 VDPAU api（视频解码和演示）增加了对视频解码的支持。mplayer、vlc、ffmpeg、mythtv等很多大项目都集成了这个api。我不知道所有细节，但它们为许多编解码器提供了 api，包括常见的子操作和比特流操作。

在直接使用 CUDA 之前我会先看看这里（我假设 VDPAU 可能会使用它）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T07:26:16.867

首先，在 PC 上没有明确的方式来使用 DMA。驱动程序*可能会*使用它，或者可能会使用其他东西。

无论如何，第 3 步将是“更改显卡上的纹理数据”。在 OpenGL 中，它是 PBO（像素缓冲区对象）扩展或旧的 glTexSubImage* 函数。在D3D9 中，它是纹理上的LockRect 或其他方式（例如，划痕纹理上的LockRect，然后blit 成GPU 纹理）。其中任何一个都可能使用 DMA，但您不能确定。

然后数据在纹理中。您可以使用一些着色器将其渲染到屏幕上（例如进行 YCbCr 转换），或者渲染到其他纹理中以进行更复杂的处理效果（例如模糊/发光/...）。

从某种意义上说，使用 Direct3D 更容易，因为有明确定义的“浪费方式”来做事。在 OpenGL 中，有很多选项可以做任何事情，你必须以某种方式找出哪些是快速的（有时不同平台或硬件上的快速路径不同）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T07:22:07.887

要将帧数据从 cpu 传输到 gpu，您可能需要查看[PBO](http://www.opengl.org/registry/specs/ARB/pixel_buffer_object.txt) s。也检查[一下](http://developer.nvidia.com/object/fast_texture_transfers.html)。

此外，如果您仍然使用着色器，您可以通过在片段着色器（YCbCr 到 RGB）中进行色彩空间转换来减轻 CPU 负担。

“进一步处理”和“渲染”步骤通常几乎是同一件事，在着色器中做一些很酷的事情并将其混合到帧缓冲区中。如果你想混合和匹配视频和不同的效果，[FBO](http://www.opengl.org/registry/specs/ARB/framebuffer_object.txt)也很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T17:13:25.573

作为替代方案，您可以查看一些用于执行通用 GPU 编程 (GPGPU) 的不同语言，例如 NVIDIA 的 CUDA 或 ATI 的 Stream SDK。不过，根据您的选择，您可以将自己限制在一个品牌的 GPU 上。使用这些语言的原因是在更接近普通高级编程的抽象级别上工作，而不是使用着色器。

我对你想做的事情没有经验，所以我不能说着色器是否真的更适合这项工作，但你可以考虑看看。不得不说，算法设计与普通代码还是有些不同的，需要一些努力才能掌握它（我只使用过 CUDA，但它们似乎都使用了类似的抽象）。

我想如果你在着色器工作方面有相当多的经验，那么学习一个新平台可能不值得你费心费力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-02T02:06:44.850

以下步骤应该做到这一点：

1.  将视频解码为 YUV

    这通常是解码器库所做的。

2.  作为纹理加载到 OpenGL

3.  将 YUV 转换为 RGB

    由于您不想使用叠加层，因此您必须手动转换。[这](http://www.fourcc.org/source/YUV420P-OpenGL-GLSLang.c)是一个使用着色器的示例。

4.  将转换后的纹理放在四边形上并渲染到屏幕上

# .net - 架构/维护/部署大型应用程序

> ID：480467
> 
> 赞同：2
> 
> 时间：2009-01-26T16:48:47.730
> 
> 标签：.net, architecture, project-management, deploying

在工作中，我们有一个非常大的应用程序，其中包含多个子应用程序。（500 + dll）

作为开发人员，使用所有这些 dll 和依赖项非常令人沮丧。您创建一个新项目并添加 5 个以上的 dll 以使系统的核心部分正常工作（日志记录、审计、安全、消息传递等）。我们添加的每个新子应用程序，我们都会创建一个 Web 项目、一个业务层、一个数据层以及在这 3 个项目之间共享对象所需的任何其他项目，因此我们的列表不断扩大。

我的问题是管理此问题的最佳方法是什么？我似乎想不出什么是最好的……模块化方法似乎有利于可重用性和热补丁项目，而无需为一个应用程序关闭系统。但是管理 500 个 dll 的头痛是一场噩梦。

每个子系统真的需要 3-4 个项目，并参考其他 5 个核心部分吗？

管理大型项目的其他方法是什么？牢记管理/开发和部署？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T17:16:25.287

我在所有类型的项目（目前我从事 250 多个 dll 项目）的命名准则方面都有很好的经验。如果您（或其他任何人）选择了良好的命名约定，您首先会看到“它”是什么，并且您知道您需要如何命名。

不要担心项目中的引用计数。如果您每次都对添加 X 引用感到沮丧，您可以创建一个宏来代替您执行此操作。或者您可以根据您的特殊要求创建模板 VS 解决方案/项目/项目（文件）。

大型项目很大，所以如果您必须使用大量的 dll、类等，这并不奇怪......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-26T17:17:39.387

这是一场持续的战斗。我们的系统有大约 100 个不同的项目：主要是 C#，还有一些 C++ 项目用于低级的东西。如果我们添加一个新的 C# 项目，我们必须添加对六个其他项目的引用，以获取基本功能。

在您的示例中，您说为每个子应用程序创建三个或更多项目（Web 项目、业务层、数据层等）。虽然我们创建了这些层，但我们尽可能将它们保留在同一个项目中，特别是避免添加不必要的项目。我们不会将子应用程序分解为不同的项目，除非它要分布在多个进程中，或者如果我们知道整个系统的其他部分需要与该子系统进行通信。

很可能每个子系统确实需要引用核心部分。它是否需要 3-4 个项目取决于您如何构建它。我们发现，将新项目的创建限制在与其他项目通信或由多个子系统使用的部分已大大减少了我们必须应对的项目数量。

# java - 为 JAR 本身中的类指定类路径

> ID：480474
> 
> 赞同：4
> 
> 时间：2009-01-26T16:50:45.073
> 
> 标签：java, jar, classpath

如果我有一个类 org.foobar.MyClass 并且想把它放在一个 JAR 文件中，我是否必须把它放在 JAR 的 /org/foobar/ 目录中，或者我可以把它放在 /bin/org/foobar/ 和以某种方式将 /bin/ 指定为 JAR 本身内的类路径？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T17:55:55.707

您可以在清单中包含 Class-Path 属性，列出您的应用所依赖的 jar 文件。路径将被视为相对于可执行 JAR 的位置。

例如，如果您的 app.jar 在 MANIFEST.MF 中包含此内容：

类路径：lib1.jar,lib/lib2.jar

然后 JVM 将期望在与 app.jar 相同的目录中找到 lib1.jar 以及包含 lib2.jar 的名为 lib 的子目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T17:44:44.997

每个人都这样做的通常方法——到目前为止，我从未见过 JAR 做不同的事情——是将类 org.foobar.MyClass 放在 JAR 的 /org/foobar/ 目录下的 JAR 文件中。我无法想象做一些不同的事情的充分理由，因为它会阻碍任何不做不寻常事情的人正常使用这个 JAR。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T16:57:11.800

我相信您可以通过使用 MANIFEST 文件来完成此操作。如果我没记错的话，您可以指定 jar 中特定文件的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T17:24:57.720

jar 文件中的名称必须与类名匹配。当然，除非您编写自定义类加载器来做奇怪的事情。

您可以使用 jar URL 在 jar 文件中指定“目录”。但是，我认为无法`URLClassLoader`正确处理此问题（未尝试过）。

作为标准存在的一个特性是通过在清单中指定它们来将其他 jar 文件添加到类路径中。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-26T16:58:38.800

你为什么要做后者？根据包名将它放在正确的目录中会更容易，这样可以避免编辑 MANIFEST 文件或进行任何其他类型的特殊设置。

# c++ - Linux/c++ 日志轮换方案

> ID：480482
> 
> 赞同：4
> 
> 时间：2009-01-26T16:52:16.117
> 
> 标签：c++, linux, logging, rotation

我有一个记录器系统，它基本上是以线程安全的方式将我的数据写入 std::clog 的一种奇特方式。

我也重定向`std::clog`到这样的文件：

```
int main() {
    std::ofstream logfile(config::logname, std::ios::app);
    std::streambuf *const old_buffer = std::clog.rdbuf(logfile.rdbuf());

    // .. the guts of the application

    std::clog.rdbuf(old_buffer);
} 
```

这很好用......但是，我的应用程序也会产生大量日志。我想知道什么是正确轮换我的日志文件的好方法。有没有一种安全的方法可以通过 cron 任务切换文件？我猜没有。

我唯一能想到的肯定会起作用的是，如果我让应用程序本身打开一个新文件，并在持有日志互斥锁的同时将 clog 的 rdbuf 重定向到该文件。但这感觉像是一个便宜的解决方案，我需要检查一下是否是时候经常轮换日志以使其有效。必须有更好的方法。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-26T16:56:25.483

您可以使用在 /etc/logrotate.conf 和/或 /etc/logrotate.d/ 中配置的内置日志轮换方法 - 通常让 logrotate 向您的应用发送 SIGUSR1 作为关闭和重新打开所有应用的信号日志文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-26T16:59:26.833

或者只是使用 syslog 而不是您的自定义日志记录方案，并且无论如何日志都会被 logrotate 轮换。-- 取决于它的配置方式，但在大多数桌面/服务器系统上，它已经设置为轮换它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T18:03:58.997

您可以使用类似于以下内容的内容，并以任何方式（logrotate、cron 脚本等）将日志文件移走（提供 Cish 示例，应该很容易转换）

```
#include <sys/types.h>
#include <sys/stat.h>
#include <unistd.h>

void logworker()
{
    ino_t inode = 0;
    FILE *logfile;

    logfile = fopen(logfilename, "a+");
    while(running)
    {
        struct stat mystat;

        if (stat(logfilename, &mystat)!=0 || mystat.st_ino != inode)
        {
            logfile = freopen(logfilename, "a+", logfile);
            inode = mystat.st_ino;
        }

        while (stuff_in_buffer)
        {
            fwrite(); /* etc */
        }
        fflush(logfile);

        /* sleep until something interesting happens */
    }
} 
```

移动后写入文件是安全的，因此无需额外小心

# ruby-on-rails - 在 Rails 中访问关联

> ID：480495
> 
> 赞同：5
> 
> 时间：2009-01-26T16:55:40.727
> 
> 标签：ruby-on-rails, activerecord, associations

有没有一种方法可以获取特定模型在 Rails 中所属的模型列表？

例如：

```
class Project < ActiveRecord::Base
  has_one :status
  ...
end

class Task < ActiveRecord::Base
  has_one :status
  ...
end

class Status < ActiveRecord::Base
  belongs_to :project
  belongs_to :task

  # this is where I want to be able to pass in an array of the associations' class
  # names (to be used for checking input) rather than having to do w%{ project task } 
  # which leaves it open to failure if I add new associations in future
  validates_inclusion_of :status_of, :in => ?
  ...
end 
```

希望这有某种意义！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T19:20:25.893

这将为您提供描述给定模型上的关联和其他事物的对象散列`Model.reflections`。您希望哈希中的所有值都是`Reflection::AssociationReflection`类。此代码应该为您提供所需的数组：

```
association_names = []
Model.reflections.each { |key, value| association_names << key if value.instance_of?(ActiveRecord::Reflection::AssociationReflection) } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T17:27:09.603

您可以使用一个数组来定义关联并在验证中使用，例如：

```
BELONGS_TO_LIST = w%{ project task }
BELONGS_TO_LIST.each {|b| belongs_to b}
validates_inclusion_of :status_of, :in => BELONGS_TO_LIST 
```

# javascript - ASP.NET：asp:LinkBut ton 禁用了 Javascript？

> ID：480498
> 
> 赞同：7
> 
> 时间：2009-01-26T16:56:04.797
> 
> 标签：javascript, asp.net, linkbutton

我想使用`asp:LinkButton`, 因为它看起来像一个链接，但也有服务器端 Click 处理程序。

但是网络服务器似乎无法检测到客户端是否禁用了 javascript，并且没有呈现为仍然有效的机制。

是否可以有一个看起来像链接但有服务器端 OnClick 事件处理程序的链接？

* * *

## 回答

答案是否定的，但以下是一些解决方法的想法。接受了非零赞成票。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T16:59:55.757

您可以使用 CSS 将按钮设置为看起来像链接的样式，但这将非常依赖于浏览器，具体取决于 CSS 实现。

* * *

**编辑：**我觉得有必要完成我的答案，因为它已被接受。

渲染到 HTML 链接，`asp:LinkButton`因此不能**发布**到网页；但只能发出**获取**请求。要解决此问题，请使用 JavaScript 来处理帖子。但是，如果禁用 Javascript，这是不可能的。

`asp:Button`并且`asp:ImageButton`是不同的。他们通过使用真正的 HTML 表单元素发布到网页（或根据表单属性获取）来提交 HTML 表单。所以这些将在没有 JS 干预的情况下工作。

一些浏览器将允许 CSS 样式设置按钮的样式，使其看起来像一个链接，因此这可以用来解决这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T17:07:13.637

只是一个想法：

渲染输入按钮并使用 javascript 将其更改为链接。该按钮适用于非启用 javascript 的浏览器，并成为那些拥有 javascript 的人的链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T17:12:32.330

在 ASP.Net 中使用类似的东西，我通常会渲染控件以及隐藏在 JavaScript 中的“可访问控件”。因此，在这种情况下，它将呈现一个 LinkBut​​ton（默认情况下通过样式隐藏）和一个普通按钮，其中注册了一些 javascript 来隐藏 Button 并显示 LinkBut​​ton。

对于 ASP.Net 控件来说，这是一个非常常见的解决方法，如果没有 javascript，或者当您需要没有 Javascript 的“自动回发”时，它就不能很好地发挥作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T17:11:01.927

没有看起来像链接的 INPUT 类型。如果您想使用链接在网页上执行 INPUT 类型的活动，它必须导航到您所在的同一页面。

您可以通过链接传递查询字符串变量，并对其进行响应。它不会完全像回发一样，而是只会导航到您所在的同一页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-09T11:05:37.660

只是为了记录，你所要求的是可能的。

您必须像这样配置控件：

```
<asp:LinkButton ID="lbtnRequestReview" Text="[ Request Plan Review ]" OnCommand="lbtnRequestReview_Command" CommandName="cmd" CommandArgument="0" CausesValidation="false" runat="server"/> 
```

并将其放在代码隐藏中：

```
protected void lbtnRequestReview_Command(Object sender, CommandEventArgs e)
        {
           //...
        } 
```

[您可以在此处](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.commandname.aspx)找到更详细的信息。

# .net - 在 WCF 服务中访问 App_Data

> ID：480504
> 
> 赞同：15
> 
> 时间：2009-01-26T16:57:41.503
> 
> 标签：.net, wcf

如何访问 WCF 服务中的 App_Data 文件夹？

我放置了一个 xslt 文件，但找不到路径。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-26T17:08:26.677

您需要使用 HostingEnvironment.ApplicationPhysicalPath：

```
string myXsltFilename = Path.Combine(HostingEnvironment.ApplicationPhysicalPath, "App_Data", "my.xslt"); 
```

# c# - C# 是 C 的超集吗？

> ID：480510
> 
> 赞同：13
> 
> 时间：2009-01-26T16:59:24.103
> 
> 标签：c#, c, programming-languages

无论如何，C# 是否是 C 的超集，例如 Objective-C 或 C++？有没有办法通过构造这样的编译器标志在线编译 C？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-01-26T17:01:15.677

一句话，不。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-26T17:01:21.620

没有任何有意义的方式。它受到 C（以及其他）的启发，但它们是完全不同的语言。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-26T17:02:34.427

*就语法*而言， C# 来自“c-like”家族，但就架构而言，它感觉更像 Java（没有指针 [OK，如下所述，您可以使用它们，但大多数人不知道或关心]，数组被绑定检查，垃圾收集内存等）。

您可以在 C++ 中获得大部分内容，但不能在核心中获得。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-26T17:05:21.377

让我们这样说：

> `C`和`C#`相似`rm -rf . /`和`# rm -rf . /`相似

简而言之，没有 C 不是 C# 的子集。许多基于 C 的控制结构的外观。例如，for 循环、开关、while 等。同时，C# 禁止潜在危险的构造，例如在忘记中断时从 switch 中的 case 掉下来；或者将整数作为 if 条件放置在需要布尔值的地方。上面的引用意味着 C# 和 C 看起来非常相似，但转化为截然不同的结果。C 不会阻止您从分区中删除所有内容，而 C# 将保护您避免错误地执行此操作，形象地说。

在另一个层面上，C 允许您将指针类型强制转换为整数，将它们推送，强制转换，然后访问存储在该指针中的内存位置。C 不会保护您访问不是由您分配的内存。你会崩溃 - 充其量。C# - 另一方面 - 当您执行诸如通过空引用访问对象之类的事情时，会有异常通知您。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-26T17:12:17.120

C++ 也不是 C 的真正超集（参见[链接文本](http://public.research.att.com/~bs/bs_faq.html#C-is-subset)）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-26T17:07:57.160

C# 和 C 并不真正相关（除了相似的语法）。当程序启动时，C# 会从 IL 中转换为机器代码。C# 没有指针，该堆栈上的值类型除外。C# 是完全类型安全的，而 C 不是。C 需要显式内存管理，而 C# 是垃圾收集。差异的清单还在继续……

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-26T17:12:31.987

C# 与 C 非常不同（C++ 与 C 也非常不同）。这不是因为最终没有太大不同的语义，而是因为 C# 背后的概念和思想。

当您使用 C# 编程时，您必须以*不同于使用 C 的方式进行思考*：这是主要的区别。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-12T22:36:40.320

C 是必须的。C# 是面向对象的。

# c++ - 阻止通过 ifstream 对象从 FIFO 读取

> ID：480525
> 
> 赞同：4
> 
> 时间：2009-01-26T17:05:55.540
> 
> 标签：c++, file-io, filestream, fifo

我打开一个 FIFO 文件为`ifstream`. 一旦创建了对象，线程就会被阻塞，直到我向 FIFO 发送一些东西（这对我来说没问题）。然后我打电话`getline()`从流中获取数据。

如何再次读取阻塞线程，直到更多数据写入 FIFO 文件？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T15:52:10.587

我尚未测试此代码，但我想知道当您读取所有可用数据时，FIFO 是否只是设置 EOF 位。在这种情况下，您可以这样做：

```
std::ifstream fifo;
std::string   line;
bool          done = false;

/* code to open your FIFO */

while (!done)
{
    while (std::getline(fifo, line))
    {
        /* do stuff with line */
    }
    if (fifo.eof())
    {
        fifo.clear();  // Clear the EOF bit to enable further reading
    }
    else
    {
        done = true;
    }
} 
```

如果您读取 FIFO 的末尾，请复位并等待更多数据。如果发生错误，您就完成了。我从[这个网站](http://www.usenet-forums.com/linux-general/89222-named-pipes-c.html)得到了这个想法。您可能还必须在执行重置的同一块中关闭并重新打开 FIFO。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T17:52:54.433

提供的`getline`函数`<string>`返回对流对象的引用。您可以测试此对象的“优点”以查看它是否仍处于打开状态或是否发生错误：

```
std::ifstream fifo;
std::string   line;

/* code to open your FIFO */

while (std::getline(fifo, line))
{
    /* do stuff with line */
} 
```

当 FIFO 关闭时，while 测试将返回 false 以退出循环。每次循环迭代都会有效地读取阻塞线程，直到准备好更多数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T08:59:16.240

我使用流如下：

```
ifstream _FifoInStream(_FifoInFileName.c_str(), ifstream::in);

string CmdLine;

while (std::getline(_FifoInStream, CmdLine)) {
    cout << CmdLine << endl;
} 
```

仅当我初始化 _FifoInStream 变量即打开流时，我才被阻止。在我将数据发送到 FIFO 之后，我会通过 while 块。我需要的是每次被阻止读取时都无限期地从 FIFO 中读取。

# silverlight - ContentPresenter 丢失 DataContext

> ID：480527
> 
> 赞同：2
> 
> 时间：2009-01-26T17:07:06.820
> 
> 标签：silverlight, silverlight-2.0

我想创建一个“FlipPanel”，它提供同一对象的两个不同视图。这是我正在采取的方法。

这是主页，它由一个 ItemsControl 组成，它的 ItemTemplate 是一个 FlipPanel。FlipPanel 公开了两个属性，它们定义了用于 Front 和 Back 的 DataTemplate。

```
<UserControl.Resources>

    <ControlTemplate x:Key="MyFlipTemplate">
        <StackPanel>
            <Button Content="Flip" x:Name="PART_FlipButton"/>
            <ContentPresenter Content="{TemplateBinding Content}" x:Name="PART_FlipContent"/>
        </StackPanel>
    </ControlTemplate>

    <DataTemplate x:Key="Front">
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="Front"/>
            <TextBlock Text="{Binding Name}"/>
        </StackPanel>
    </DataTemplate>

    <DataTemplate x:Key="Back">
        <StackPanel>
            <TextBlock Text="Back"/>
            <TextBlock Text="{Binding Description}"/>
        </StackPanel>
    </DataTemplate>
</UserControl.Resources>

<StackPanel>
    <ItemsControl x:Name="_items">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel></StackPanel>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <SLTest:FlipPanel Template="{StaticResource MyFlipTemplate}" FrontDataTemplate="{StaticResource Front}" BackDataTemplate="{StaticResource Back}" Side="Front"/>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</StackPanel> 
```

主页的后面的代码非常简单，因为它只是将 ItemsControl 的 DataContext 设置为测试数据列表。

```
使用 System.Collections.Generic；
使用 System.Windows.Controls；

命名空间 SLTest
{
    公共部分类 NewPage : UserControl
    {
        公共新页面（）
        {
            初始化组件（）；

            _items.ItemsSource = 物品；
        }

        公共 IList 项
        {
            得到
            {
                返回新列表
                           {
                               新的NewClass {名称=“名称1”，描述=“描述1”}，
                               新的NewClass {名称=“名称2”，描述=“描述2”}，
                               新的NewClass {名称=“名称3”，描述=“描述3”}，
                               新的NewClass {名称=“名称4”，描述=“描述4”}
                           };
            }
        }
    }

    公共类 NewClass
    {
        公共字符串名称；
        公共字符串描述；
    }
}

```

FlipPanel 代码也相对简单，因为它尝试根据 Side DependencyProperty 更改 DataTemplate。问题似乎是 ContentPresenter 的 DataContext 在某些时候丢失了。在代码中，我有两条注释指示 ContentPresenter 的 DataContext 的有效性。

```
使用系统；
使用 System.Windows；
使用 System.Windows.Controls；

命名空间 SLTest
{
    [模板部分（名称 = FlipPanel.ButtonPart，类型 = typeof（按钮））]
    [模板部分（名称= FlipPanel.ContentPart，类型= typeof（ContentPresenter））]
    公共部分类 FlipPanel：ContentControl
    {
        私有常量字符串 ButtonPart = "PART_FlipButton";
        私有常量字符串 ContentPart = "PART_FlipContent";

        公共枚举 FlipSide
        {
            正面，
            后退
        }

        私人翻转 _flipSide;

        公共静态只读 DependencyProperty SideProperty = DependencyProperty.RegisterAttached("FlipSide", typeof(FlipSide), typeof(FlipPanel), new PropertyMetadata(FlipSide.Front, FlipSidePropertyChanged));
        public static readonly DependencyProperty FrontDataTemplateProperty = DependencyProperty.Register("FrontDataTemplate", typeof (DataTemplate), typeof (FlipPanel), null);
        公共静态只读 DependencyProperty BackDataTemplateProperty = DependencyProperty.Register("BackDataTemplate", typeof(DataTemplate), typeof(FlipPanel), null);

        私人按钮_flipButton；
        私有 ContentPresenter _content；

        公共翻转面板（）
        {
            初始化组件（）；
        }

        公共数据模板 FrontDataTemplate
        {
            得到
            {
                返回 (DataTemplate) GetValue(FrontDataTemplateProperty);
            }
            放
            {
                SetValue(FrontDataTemplateProperty, 值);
            }
        }

        公共数据模板 BackDataTemplate
        {
            得到
            {
                返回 (DataTemplate)GetValue(BackDataTemplateProperty);
            }
            放
            {
                SetValue(BackDataTemplateProperty, value);
            }
        }

        私有静态无效 FlipSidePropertyChanged（DependencyObject d，DependencyPropertyChangedEventArgs e）
        {
            var flipSide = (FlipSide)e.NewValue;
            var 翻转面板 = d 作为翻转面板；

            flipPanel._content.ContentTemplate = flipSide == FlipSide.Front ？flipPanel.FrontDataTemplate : FlipPanel.BackDataTemplate;
        }

        公共覆盖无效 OnApplyTemplate()
        {
            _flipButton = GetTemplateChild(ButtonPart) 作为按钮；
            _flipButton.Click += OnFlipClicked;

            _content = GetTemplateChild(ContentPart) 作为 ContentPresenter；

            // _content.DataContext 在这里有效...

            _content.ContentTemplate = Side == FlipSide.Front ？前数据模板：后数据模板；

            base.OnApplyTemplate();
        }

        私人无效 OnFlipClicked（对象发送者，RoutedEventArgs e）
        {
            // _content.DataContext 现在为 NULL！！！！

            边 =（边 == FlipSide.Front）？FlipSide.Back : FlipSide.Front;
        }

        公共 FlipSide 侧
        {
            得到
            {
                返回（FlipSide）GetValue（SideProperty）；
            }
            放
            {
                SetValue(SideProperty, 值);
            }
        }
    }
}

```

有任何想法吗？

我不确定这是否是解决我的要求的正确方法，如果有更好的方法，我会欢迎任何进一步的建议。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-09T20:10:21.463

克里斯，

我不知道你是否还在寻找一种方法来做到这一点。我知道有很多类似问题的指南，但不完全是您正在寻找的。根据我对您想要什么的理解，您需要一个具有两个面（实际上是 x 个面）的控件，用户可以在其中按下按钮并导致面板“翻转”并显示不同的数据。但是，您希望此数据显示为足够通用，以便此翻转面板可以在其他位置使用，只需不同的实现而不是完全不同的代码。我是否正确理解您的需求？如果没有，请澄清我误入歧途的地方，我可能会为你得到更好的答案。话虽如此，这就是我所做的（谷歌代码演示项目在底部）：

1.  我创建了一个包含我的 FlipPanel 的控件库（因为这就是我做事的方式；这样我就可以在以后的其他项目中使用这些控件。）
2.  我对控件库中的控件进行了样式设置，以包含您在场景中需要的上述属性。
3.  我创建了一个 Silverlight 2.0 应用程序来创建控件的一个实例。
4.  我创建了一个用于绑定的基本对象，它具有一些属性，以便我可以展示控件的潜力。

下面是在 Silverlight 2.0 页面中使用的可能定义：

```
 <Grid x:Name="LayoutRoot" Background="White">
  <controls:FlipPanel x:Name="TestingFlipPanel" Side="Front" >
   <controls:FlipPanel.BackDataTemplate>
    <DataTemplate>
     <StackPanel Orientation="Horizontal">
      <TextBlock Text="Back: "/>
      <TextBlock Text="{Binding BackText}" />
     </StackPanel>
    </DataTemplate>
   </controls:FlipPanel.BackDataTemplate>
   <controls:FlipPanel.FrontDataTemplate>
    <DataTemplate>
     <StackPanel Orientation="Horizontal">
      <TextBlock Text="Front: "/>
      <TextBlock Text="{Binding FrontText}" />
     </StackPanel>
    </DataTemplate>
   </controls:FlipPanel.FrontDataTemplate>
  </controls:FlipPanel>
    </Grid> 
```

另一种方法是在用户控件（页面级别，甚至应用级别）中定义数据模板，如下所示：

这样您就可以了解我的绑定对象在这里的定义（是的，它是 VB ......对不起！）：

```
Public Class BindingObject
 Private _FrontText As String
 Private _BackText As String

 Public Sub New(ByVal frontText As String, ByVal backText As String)
  MyBase.New()
  _FrontText = frontText
  _BackText = backText
 End Sub

 Public Property FrontText() As String
  Get
   Return _FrontText
  End Get
  Set(ByVal value As String)
   _FrontText = value
  End Set
 End Property
 Public Property BackText() As String
  Get
   Return _BackText
  End Get
  Set(ByVal value As String)
   _BackText = value
  End Set
 End Property

End Class 
```

在我后面的代码中，这是我的页面的定义和翻转面板的数据上下文设置：

```
Partial Public Class Page
 Inherits UserControl
 Dim _BindingObject As New BindingObject("This is the front", "This is the back")
 Public Sub New()
  InitializeComponent()
 End Sub

 Private Sub Page_Loaded(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) Handles Me.Loaded
  TestingFlipPanel.DataContext = _BindingObject
 End Sub
End Class 
```

因此，所有这些都摆在您面前，我们希望控件将显示一个按钮（以控件样式）和一个文本块（实际上是两个），上面写着“前面：这是前面”，并且当按钮是按下它被“翻转”以显示“Back：This is the back”。

说了这么多，这里是我用于控件的样式：

```
 <Style TargetType="controls:FlipPanel">
  <Setter Property="Template">
   <Setter.Value>
    <ControlTemplate TargetType="controls:FlipPanel">
     <Grid x:Name="LayoutRoot">
      <Grid>
       <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
       </Grid.RowDefinitions>
       <Button x:Name="FlipButton" Content="Flip" Grid.Row="0" />
       <ContentPresenter Grid.Row="1" x:Name="FrontContentPresenter" Content="{TemplateBinding DataContext}" ContentTemplate="{TemplateBinding FrontDataTemplate}" />
       <ContentPresenter Grid.Row="1" x:Name="BackContentPresenter"  Content="{TemplateBinding DataContext}" ContentTemplate="{TemplateBinding BackDataTemplate}" />
      </Grid>

     </Grid>
    </ControlTemplate>
   </Setter.Value>
  </Setter>
 </Style> 
```

最后，控件的定义（注意 - 它很长）：

```
<TemplatePart(Name:=FlipPanel.LayoutRoot_ElementName, Type:=GetType(FrameworkElement))> _
<TemplatePart(Name:=FlipPanel.FrontContentPresenter_ElementName, Type:=GetType(FrameworkElement))> _
<TemplatePart(Name:=FlipPanel.BackContentPresenter_ElementName, Type:=GetType(FrameworkElement))> _
<TemplatePart(Name:=FlipPanel.FlipButton_ElementName, Type:=GetType(FrameworkElement))> _
Public Class FlipPanel
 Inherits Control

 Public Const LayoutRoot_ElementName As String = "LayoutRoot"
 Public Const FlipButton_ElementName As String = "FlipButton"
 Public Const FrontContentPresenter_ElementName As String = "FrontContentPresenter"
 Public Const BackContentPresenter_ElementName As String = "BackContentPresenter"

 Public Enum Sides
  Front
  Back
 End Enum

 Private _LayoutRoot As FrameworkElement = Nothing
 Private _FlipButton As FrameworkElement = Nothing
 Private _FrontContentPresenter As FrameworkElement = Nothing
 Private _BackContentPresenter As FrameworkElement = Nothing

 Private _ControlUpdating As Boolean = False

 Public Sub New()
  MyBase.New()
  MyBase.DefaultStyleKey = GetType(FlipPanel)
 End Sub

 Public Overrides Sub OnApplyTemplate()
  MyBase.OnApplyTemplate()
  UpdateControl()
 End Sub

 Private Sub UpdateControl()
  If _ControlUpdating Then Exit Sub
  _ControlUpdating = True

  If _LayoutRoot Is Nothing Then _LayoutRoot = TryCast(GetTemplateChild(LayoutRoot_ElementName), FrameworkElement)
  If _LayoutRoot IsNot Nothing Then
   Dim element As Grid = TryCast(_LayoutRoot, Grid)
   If element IsNot Nothing Then
    ' Update LayoutGrid here.  
   End If
  End If
  If _FlipButton Is Nothing Then _FlipButton = TryCast(GetTemplateChild(FlipButton_ElementName), FrameworkElement)
  If _FlipButton IsNot Nothing Then
   Dim element As Button = TryCast(_FlipButton, Button)
   If element IsNot Nothing Then
    ' Update Button
    RemoveHandler element.Click, AddressOf _FlipButton_Click
    AddHandler element.Click, AddressOf _FlipButton_Click
   End If
  End If
  If _FrontContentPresenter Is Nothing Then _FrontContentPresenter = TryCast(GetTemplateChild(FrontContentPresenter_ElementName), FrameworkElement)
  If _FrontContentPresenter IsNot Nothing Then
   Dim element As ContentPresenter = TryCast(_FrontContentPresenter, ContentPresenter)
   If element IsNot Nothing Then
    ' Update FrontContentPresenter here.
    If Side = Sides.Front Then
     element.Visibility = Windows.Visibility.Visible
    Else
     element.Visibility = Windows.Visibility.Collapsed
    End If
   End If
  End If
  If _BackContentPresenter Is Nothing Then _BackContentPresenter = TryCast(GetTemplateChild(BackContentPresenter_ElementName), FrameworkElement)
  If _BackContentPresenter IsNot Nothing Then
   Dim element As ContentPresenter = TryCast(_BackContentPresenter, ContentPresenter)
   If element IsNot Nothing Then
    ' Update BackContentPresenter here.  
    If Side = Sides.Front Then
     element.Visibility = Windows.Visibility.Collapsed
    Else
     element.Visibility = Windows.Visibility.Visible
    End If
   End If
  End If

  _ControlUpdating = False
 End Sub

 Private Sub _FlipButton_Click(ByVal sender As Object, ByVal e As RoutedEventArgs)
  Select Case Side
   Case Sides.Front
    Side = Sides.Back
   Case Sides.Back
    Side = Sides.Front
   Case Else
    Throw New ArgumentOutOfRangeException("Side")
  End Select
  UpdateControl()
 End Sub

 Private Sub FlipPanel_LayoutUpdated(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.LayoutUpdated
  UpdateControl()
 End Sub

#Region " FrontDataTemplateProperty Dependency Property "

#Region " FrontDataTemplate Property "

 Public Property FrontDataTemplate() As DataTemplate
  Get
   Return DirectCast(GetValue(FrontDataTemplateProperty), DataTemplate)
  End Get
  Set(ByVal value As DataTemplate)
   SetValue(FrontDataTemplateProperty, value)
  End Set
 End Property

#End Region

#Region " FrontDataTemplate Dependency Property "

 Public Shared ReadOnly FrontDataTemplateProperty As DependencyProperty = DependencyProperty.Register("FrontDataTemplate", GetType(DataTemplate), GetType(FlipPanel), New PropertyMetadata(Nothing, AddressOf OnFrontDataTemplatePropertyChanged))

#End Region

#Region " FrontDataTemplate Property Changed CallBack "

 Private Shared Sub OnFrontDataTemplatePropertyChanged(ByVal d As DependencyObject, ByVal e As DependencyPropertyChangedEventArgs)
  If e.OldValue Is Nothing AndAlso e.NewValue Is Nothing Then Exit Sub
  If e.OldValue IsNot Nothing AndAlso e.OldValue.Equals(e.NewValue) Then Exit Sub

  Dim source As FlipPanel = TryCast(d, FlipPanel)
  If source Is Nothing Then Throw New ArgumentException("source is not an instance of FlipPanel!")

  ' Provide any other validation here.

  ' Apply any other changes here.

 End Sub

#End Region

#End Region

#Region " BackDataTemplateProperty Dependency Property "

#Region " BackDataTemplate Property "

 Public Property BackDataTemplate() As DataTemplate
  Get
   Return DirectCast(GetValue(BackDataTemplateProperty), DataTemplate)
  End Get
  Set(ByVal value As DataTemplate)
   SetValue(BackDataTemplateProperty, value)
  End Set
 End Property

#End Region

#Region " BackDataTemplate Dependency Property "

 Public Shared ReadOnly BackDataTemplateProperty As DependencyProperty = DependencyProperty.Register("BackDataTemplate", GetType(DataTemplate), GetType(FlipPanel), New PropertyMetadata(Nothing, AddressOf OnBackDataTemplatePropertyChanged))

#End Region

#Region " BackDataTemplate Property Changed CallBack "

 Private Shared Sub OnBackDataTemplatePropertyChanged(ByVal d As DependencyObject, ByVal e As DependencyPropertyChangedEventArgs)
  If e.OldValue Is Nothing AndAlso e.NewValue Is Nothing Then Exit Sub
  If e.OldValue IsNot Nothing AndAlso e.OldValue.Equals(e.NewValue) Then Exit Sub

  Dim source As FlipPanel = TryCast(d, FlipPanel)
  If source Is Nothing Then Throw New ArgumentException("source is not an instance of FlipPanel!")

  ' Provide any other validation here.

  ' Apply any other changes here.

 End Sub

#End Region

#End Region

#Region " SideProperty Dependency Property "

#Region " Side Property "

 Public Property Side() As Sides
  Get
   Return DirectCast(GetValue(SideProperty), Sides)
  End Get
  Set(ByVal value As Sides)
   SetValue(SideProperty, value)
  End Set
 End Property

#End Region

#Region " Side Dependency Property "

 Public Shared ReadOnly SideProperty As DependencyProperty = DependencyProperty.Register("Side", GetType(Sides), GetType(FlipPanel), New PropertyMetadata(Sides.Front, AddressOf OnSidePropertyChanged))

#End Region

#Region " Side Property Changed CallBack "

 Private Shared Sub OnSidePropertyChanged(ByVal d As DependencyObject, ByVal e As DependencyPropertyChangedEventArgs)
  If e.OldValue Is Nothing AndAlso e.NewValue Is Nothing Then Exit Sub
  If e.OldValue IsNot Nothing AndAlso e.OldValue.Equals(e.NewValue) Then Exit Sub

  Dim source As FlipPanel = TryCast(d, FlipPanel)
  If source Is Nothing Then Throw New ArgumentException("source is not an instance of FlipPanel!")

  ' Provide any other validation here.

  ' Apply any other changes here.

 End Sub

#End Region

#End Region

End Class 
```

* * *

现在，您一直在等待什么，**代码！**

## 享受！

[谷歌代码 - http://code.google.com/p/stackoverflow-answers-by-scott/](http://code.google.com/p/stackoverflow-answers-by-scott/)

[Google 代码 - 源代码 (Zip)](http://stackoverflow-answers-by-scott.googlecode.com/files/480527.zip)

## 谢谢！

# vbscript - vbscript : 意外的标识符

> ID：480533
> 
> 赞同：0
> 
> 时间：2009-01-26T17:08:12.230
> 
> 标签：vbscript

在我的代码中，我收到以下错误消息

> c:\dpdata_copy2.vbs(114,13) Microsoft VBScript 编译错误：预期标识符

第 114 行指向一个空行，所以我假设它在以下行抛出错误：

```
Lastprop = f.DateLastModified 
```

在代码中

```
strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")

strFolderName = "D:\1\production\Openjobs"

Set colSubfolders = objWMIService.ExecQuery _
    ("Associators of {Win32_Directory.Name='" & strFolderName & "'} " _
        & "Where AssocClass = Win32_Subdirectory " _
            & "ResultRole = PartComponent")

    'variables for getting last accessed property
    Dim fs, f 
    Set fs = CreateObject("Scripting.FileSystemObject") 

For Each objFolder in colSubfolders

    'get last modified date 
    Set f = fs.GetFolder(objFolder.Name) 
    Lastprop = f.DateLastModified
    'MsgBox(Lastprop)

            if ( DateDiff("m", f.DateLastModified, Now()) > 4) then 
                diffindates =  DateDiff("m", f.DateLastModified, Now())
                Set objShell = CreateObject("Shell.Application")
                Set objCopyFolder = objShell.NameSpace(ParentFolder) 

                OutputToLog("rem " & f.DateLastModified & ":" & objFolder.Name )

                outputtolog("move /Y """ & objFolder.Name & """ "  & ParentFolder)

                wscript.echo(diffindates & ":" & objFolder.Name & vbCr) 

            end if 

Next 
```

有任何想法吗？还是我应该发布整个脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-26T17:13:29.317

您是否使用 Windows 脚本主机运行它？如果是这样，请将 //D 作为参数添加到 CSCRIPT 或 WSCRIPT 以激活调试模式，让您在 Visual Studio 或您已安装的任何 Windows 脚本调试器中查看堆栈并查看所有变量等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T17:21:05.107

这段代码对我有用：

```
strFolderName = "C:\Temp"
strComputer = "MyComputerName"

set fs = CreateObject("Scripting.FileSystemObject")

set objWMIService = GetObject("winmgmts:" _ 
    & "{impersonationLevel=impersonate}!\\" _ 
    & strComputer & "\root\cimv2") 

set colsubfolders = objWMIService.ExecQuery ("Associators of " _  
    & "{Win32_Directory.Name='" & strFolderName & "'} " _
    & "Where AssocClass = Win32_Subdirectory " _ 
    & "ResultRole = PartComponent")

For each objFolder in colsubfolders
    Set f = fs.GetFolder(objFolder.Name) 
    Lastprop = f.DateLastModified
    wscript.echo Lastprop
Next 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-26T18:10:24.413

删除线

```
 Set f = fs.GetFolder(objFolder.Name) 
```

并且在 for 循环中使用 f 的任何地方都将其替换为 objFolder

# sql-server - Reporting Services - 将 2008 报告格式转换为 2005 格式

> ID：480537
> 
> 赞同：3
> 
> 时间：2009-01-26T17:10:16.330
> 
> 标签：sql-server, reporting-services

有什么方法可以将 2008 报告格式转换回 2005 格式？我认为我没有收到有关升级报告的提示，现在我认为它们采用了新格式。有什么方法可以保存我的更改并返回一个版本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T05:32:17.547

没有办法从 2005 年到 2000 年。我认为这仍然是正确的。

[http://msdn.microsoft.com/en-us/library/ms143747.aspx](http://msdn.microsoft.com/en-us/library/ms143747.aspx) 希望您按照那里的指示备份了报表服务器数据库。将其还原到测试环境，您就可以恢复您的报告。

顺便说一句，我会向任何使用报告服务的人推荐 RSScripter。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-23T20:30:44.317

有一种方法可以通过手动编辑 XML 从 2008 年回到 2005 年。虽然这不是最简单的事情，但使用 RegEx 将旧 xml 与新 xml 进行模式匹配的简单程序可以在大约一个小时内编写完成。

另一种选择是在 2005 年重新创建报告，从当前的 rdl 文件中获取查询。

# c# - 在 app.config 中使用 XML 包含或配置引用来包含其他配置文件的设置

> ID：480538
> 
> 赞同：41
> 
> 时间：2009-01-26T17:10:24.643
> 
> 标签：c#, .net, configuration, app-config

我有标准的日志记录、NHibernate 等配置块，`app.config`我想将它们提取到一个通用 XML 文件中，该文件可以作为我所有应用程序`app.config`文件的引用包含在内。

这可能吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-01-26T18:03:58.903

是的，您可以使用`configSource`配置块的属性。所有配置块都有这个属性——尽管它没有被记录。

看[这篇文章](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration.aspx)，一直在底部，附录B。我也粘贴了下面的相关部分：

> **附录 B：包括外部配置文件**
> 
> 尽管 .NET 2.0 的配置功能有很多优点，但也有一个缺点。在跨多个环境处理单个项目时，管理配置可能成为一场噩梦。在我目前的工作中，为多个环境（即开发、测试、登台和生产）管理配置文件的多个版本的过程涉及`.config`在将更改部署到一个或另一个环境时手动比较文件，并使用手动合并过程。我花了几个月的时间试图找到一种更好的方法，最终找到了。输入一个如此受人喜爱的“无证”——或者在这种情况下，只是没有记录的——微软如此著名的功能之一：`configSource`. 我是在使用 Reflector 这个很棒的小工具挖掘 .NET 2.0 配置源代码时才发现这个小宝石的。
> 
> 每个配置节在被 .NET 配置类解析和加载时，都会被分配一个`SectionInformation`对象。该`SectionInformation`对象包含有关配置节的元信息，并允许对在子配置文件 (ASP.NET) 中定义时节如何相互覆盖进行一些管理。现在，我们将忽略 SectionInformation 提供的大部分内容，保存`ConfigSource`属性。`configSource`通过向any 的根元素添加一个属性`ConfigurationSection`，您可以指定一个备用的外部源，从中加载配置设置。
> 
> ```
> <!-- SomeProgram.exe.config -->
> <configuration>
>   <connectionStrings configSource="externalConfig/connectionStrings.config"/>
> </configuration>
> 
> <!-- externalConfig/connectionStrings.config -->
> <connectionStrings>
>   <add name="conn" connectionString="blahblah" />
> </connectionStrings> 
> ```
> 
> 在上面的配置文件中，该`<connectionStrings>`部分来自一个名为`externalConfig/connectionStrings.config`. 应用程序的所有连接字符串都将从指定文件加载。既然连接字符串是从外部资源加载的，那么`connectionStrings.config`在每个环境中的相同相对位置创建一个文件是一件相对简单的事情。因此，`externalConfig/`部分`connectionStrings.config`小路。这里的美妙之处在于我们可以为每个环境正确定义连接字符串一次。我们不必担心在配置文件合并不正确或根本没有合并的部署期间意外覆盖这些设置。在将应用程序中的更改部署到生产环境时，这可能是一个巨大的福音，在生产环境中存在正确的数据库连接字符串至关重要。使用该`configSource`属性的缺点是它需要将所有配置设置放在外部文件中。没有继承或覆盖是可能的，这在某些情况下使它无用。与该属性一起使用的所有外部配置文件`configSource`也必须位于主目录的相对子路径中`.config`文件。我相信这是关于将文件存储在 Web 环境中的相对父路径中的安全问题。
> 
> 还有一点需要注意的是，该`<appSettings>`部分有一个更好的替代使用`configSource`，称为文件。如果您在节中使用文件属性而不是 configSource，则`<appSettings>`可以在根`.config`文件和引用文件中定义设置。根`.config`文件中的设置也可以在引用文件中被覆盖，只需添加具有相同键的内容即可。遗憾的是，文件属性仅在该`<appSettings>`部分中可用，并未内置到配置框架中。可以在您自己的配置部分中实现类似的属性。这将在未来的高级配置主题中讨论，在几个先决条件部分之后;）。

# c# - 交叉引用多个对象

> ID：480539
> 
> 赞同：0
> 
> 时间：2009-01-26T17:10:29.183
> 
> 标签：c#, .net-2.0

好的，所以我很难想出一个“好”的方法来执行以下操作：

将 4 个对象分组，这样如果我对象 AI 可以轻松且无需通过对象 B 和 C 来确定对象 D 是否与对象 A 相关。以及任何其他引用组合。

我目前正在使用 SortedLists 将 A 链接到 B，将 B 链接到 C，将 C 链接到 D，并且在交叉引用它们方面做得非常草率。这行得通，但它真的，真的很丑。我不喜欢丑陋的代码，除非没有其他办法。

我正在考虑使用一个类来存储对象。但是引用它们的最佳方式是什么？

提前致谢

* * *

更多信息：

对象是窗体上的控件。这 4 个不同的控件都相互关联，因为它们对应于用于配置的相同设置。表单上有多个设置需要修改，每个设置都使用 4 个控件。

我需要一种方法来轻松引用它们，而不必调用 Setting4ControlB.Checked 或 Setting2ControlD.text，因此链接列表。我为某些控件使用通用事件以重用代码，它们都做同样的事情，除了它们引用不同的对象。

丑陋的部分首先是设置链接，其次是从 A 到 D 或 C 到 A 的引用，等等。我希望能够做这样的事情：

GetSettingControls(ReferenceControl).ControlA.Checked

ReferenceControl 将是事件的发送者，ControlA 是与 ReferenceControl 相关的控件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T17:36:46.510

首先，如果你有一个像 A->B->C->D 这样的关系，那么查看 A 是否与 D 相关的唯一方法就是从 A 一直走到 D。你仍然可以应用一些技巧

这将涉及手动跟踪程序中存在的每个间接引用，也就是说，您将负责动态添加 A->D 引用，这可能对某些逻辑有用，例如能够“携带”游戏中的对象。

您需要使用弱引用字典，这样您就不会通过引用使对象保持活动状态......

```
public class MyObject
{
  public List<WeakReference> References = new List<WeakReference>();

  // My Class Properties and Methods
}

MyObject obj = new MyObject();
obj.refence.Add(new WeakReference(gun)); 
```

这样，如果从对象池中清除了枪（例如您的 Level.Objects 集合中的 userObjects 集合），弱引用将变得无效。

您可以通过执行检查对象

```
foreach ref in obj.references
  if (ref.IsAlive)
    object tool = ref.Target; 
```

这只是一个例子，你知道，实现好的访问器、属性等等......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T17:19:15.857

您可以使用通用 Dictionary 类来指定对象之间的键/值对。

这将允许您基于另一个对象查找一个对象。

```
System.Collections.Generic.Dictionary<object, object> myDictionary = new Dictionary<object, object>();
myDictionary.Add(objectA, objectD);
myDictionary.Add(objectD, objectA); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T17:21:32.063

我认为*不*通过对象 B 和 C 不是一个好主意。您的对象应该只知道它是直接连接，然后从那里，您可以处理基于整个对象图的关系。

您应该能够轻松找到基本图形处理的算法。

我不明白你为什么要使用 SortedList。连接是否存储在对象的外部？

无论如何，您应该能够通过存储一个包含从一个对象到另一个对象的直接连接的 IEnumerabe（数组或其他）轻松地做到这一点。您只需要递归处理（您不必以这种方式逐字地实现它，但在精神上，这就是您将要做的）对象，直到您找到从一个到另一个的路径。你只需要存储你已经采取的路径，这样你就不会发现自己在处理循环引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T17:35:44.793

根据您尝试表示的关系类型，可能会有非常好的实现/算法。例如，如果关系确定等效类，您可以使用[联合查找算法](http://research.cs.vt.edu/algoviz/UF/)之类的方法来确定两个元素是否属于同一类。

# css - CSS继承

> ID：480540
> 
> 赞同：0
> 
> 时间：2009-01-26T17:10:42.100
> 
> 标签：css, inheritance, twitter

我刚刚将 Twitter 脚本添加到我的网站，尽管不熟练地咨询了 firebug，但我无法确定如何更改 css 以使提要与我页面上的其他文本看起来一致。

有问题的页面是 [http://willworth.co.uk/latest.htm](http://willworth.co.uk/latest.htm)

任何帮助将不胜感激

先感谢您。

随着我的进步，我将尽我所能帮助社区

将要

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T17:16:20.950

您`<p>`仅将字体样式等应用于标签。

你的 twitter`<div>`内容不包含 no `<p>`，并且不来自 a `<p>`。

您需要更改标记以使用段落标签换行，或更改 CSS 以将字体样式应用于`<div>`或更有可能`<body>`

编辑：嘿，乔纳森实际上查看了源代码:) 这没有出现在萤火虫中的原因（对我来说也是如此！）是因为它没有像乔纳森指出的那样解析。FB 只报告页面存在的状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T17:17:53.787

您的字体大小为 1.3em，并且将 Verdana 字体系列应用于您的 P 标签，您需要对 twitter div 应用相同的格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T17:12:51.737

您在第 154 行的 stylesheets.css 中有以下规则：

```
#twitter_div {
        font: 1/1.5 Verdana, sans-serif;
        margin-bottom: 1.5em;
        font: 100%
        }n-bottom: 1.5em;
        }

#twitter_update_list {
        font: 1/1.5 Verdana, sans-serif;
        font: 100%
        margin-bottom: 1.5em;
        }n-bottom: 1.5em;
        } 
```

你有一个额外的 } 你应该有一个 ;

# algorithm - 过滤/归一化不良信号的算法

> ID：480543
> 
> 赞同：6
> 
> 时间：2009-01-26T17:11:15.453
> 
> 标签：algorithm, filter, normalization, signal-processing

使用 GPS 开发跟踪应用程序。一切都很好，但有时由于封闭区域或恶劣天气，我得到的分数不准确。当您绘制它们时，它看起来不正确，有很多跳跃/跳跃。

我应该运行什么算法来过滤掉不良信号 对我来说这看起来像是一个模糊算法的应用，但你怎么看？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-26T17:21:01.767

有几个选项：

1.  剔除异常值
2.  筛选
3.  使用更好的 GPS
4.  使用外部数据源（捕捉到道路）
5.  以上结合

我喜欢使用滤波器——卡尔曼滤波器是典型的（通常也是最好的）解决方案——它使用的预测平均量比廉价的 IIR（无限脉冲响应）滤波器更好：

FilteredValue = FilteredValue * 0.75 + NewValue * 0.25

您可以获得每秒 4-5 次修复的 GPS 模块，这将允许您使用上述“廉价”过滤器并具有合理的响应时间。

您还可以简单地获得更好的 GPS（SiRF III 或更好的），它没有那么嘈杂并且具有更好的室内接收（如果可能）。

消费类 GPS 装置尽可能“与道路同步”，因此消费者不会看到道路外的错误，以及其他一些技术。

Kalman 并不容易实现，但如果没有外部数据集或传感器（例如道路速度），它是最佳选择。查看[http://www.google.com/search?q=open%20source%20kalman%20filter](http://www.google.com/search?q=open%20source%20kalman%20filter)获取代码和教程。

-亚当

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T18:06:00.257

回复：在存在“流行”噪声的情况下进行过滤-

我发现的最简单的方法之一是：

```
delta = newValue - filteredValue;
delta = delta > LARGEST_SANE_DELTA ? LARGEST_SANE_DELTA
     : (delta < -LARGEST_SANE_DELTA ? -LARGEST_SANE_DELTA : delta);
filteredValue += alpha*delta; 
```

其中 alpha = 1/tau 和 tau 是相关低通滤波器的时间常数，以上述代码迭代之间时间的倍数表示。该值`LARGEST_SANE_DELTA`表示可能的较大变化，`newValue`并限制输入中的过大变化。也许有更好的方法来拒绝这种类型的噪音，但它们更复杂，我提到的那个很简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T17:15:50.450

使用[卡尔曼滤波器](http://en.wikipedia.org/wiki/Kalman_filter)。

# c# - Silverlight WrapPanel 儿童

> ID：480552
> 
> 赞同：0
> 
> 时间：2009-01-26T17:12:47.493
> 
> 标签：c#, silverlight, json, wrappanel

在 silverlight 中将子项添加到 WrapPanel 的最佳方法是什么？我正在使用 C#，并且正在读取包含带有缩略图和相关信息的图像的 JSON 对象。

最终目标是有一个缩略图网格（13 个拇指水平跨越 950 像素，垂直 6 个拇指）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T02:54:41.797

When you're faced with adding items in code, generally there's a better way.

How about making a ListBox and setting its ItemsSource to your list (or binding it to the DataContext). Make a DataTemplate to display your thumbnail + info and then (this is the important part) make a ItemsPanelTemplate using a WrapPanel.

```
<Grid x:Name="ImageThumbnails">
    <ListBox 
        ItemsSource="{Binding}" 
        Width="950"
        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
        >
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Orientation="Vertical">
                    <Image Source="{Binding Thumbnail}" Width="80" Height="60"/>
                    <TextBlock Text="{Binding ImageName}"/>
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>
        <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <WrapPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
     </ListBox>
</Grid> 
```

Then in your code, once you've got your data from your JSON call:

```
this.ImageThumbnails.DataContext = thumbnailListFromJSON; 
```

Now if your list is an ObservableCollection, then any changes to the list will be automatically reflected in your UI.

(The above code should be treated as pseudo-code - obviously you're going to have to change it to reflect your data structure)

Edit: added ScrollViewer.HorizontalScrollBarVisibility="Disabled" to ListBox. This is important because it stops the scrollviewer expanding infinitely in the horizontal direction. Without this WrapPanel becomes a 1-row listbox.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T18:08:06.477

WrapPanel 是从 Panel 派生的，因此您可以只使用 Children.Add(control)。WrapPanel 将负责所有布局，这是它的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T02:42:15.010

UniformGrid 非常适合这种情况。不幸的是，它不是 Silverlight 框架的一部分。然而，有一些可用的 WPF 版本的端口。

[http://www.jeff.wilcox.name/2009/01/uniform-grid/](http://www.jeff.wilcox.name/2009/01/uniform-grid/)

# c - 修改 C 字符串常量？

> ID：480555
> 
> 赞同：12
> 
> 时间：2009-01-26T17:13:00.957
> 
> 标签：c, string, pointers

> **可能重复：**
> [为什么在写入字符串时会出现分段错误？](https://stackoverflow.com/questions/164194/why-do-i-get-a-segmentation-fault-when-writing-to-a-string)

我想编写一个函数来反转传递给它的给定字符串。但是我不能。如果我为`doReverse`函数（见下面的代码）提供一个字符数组，我的代码运行良好。

我不知道为什么这不起作用。我可以访问`str[0]`in `doReverse`，但无法使用 char 指针更改数组的任何值。有任何想法吗？

```
void doReverse(char *str) {
    str[0] = 'b';
}

void main(void) {
    char *str = "abc";
    doReverse(str);
    puts(str);
} 
```

### 更新：

我知道如何通过将字符数组传递给它来编写反向函数：

```
void reverse1(char p[]) {
    int i, temp, y;

    for (i = 0, y = strlen(p); i < y; ++i, --y) {
        temp = p[y-1];
        p[y-1] = p[i];
        p[i] = temp;
    }
} 
```

但是，我想编写另一个将 char 指针作为参数的版本。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-26T17:57:03.393

由于您正在为考试而学习，因此我将充实我的评论以解释实际发生的情况：

```
char *str = "abc"; 
```

`str`是存储在堆栈上的指针。它被初始化为指向文字 string `"abc"`。该文字字符串将存储在已编译的可执行文件的数据部分中，并在加载程序时加载到内存中。那段内存是只读的，因此当您尝试修改 str 指向的数据时，您会遇到访问冲突。

```
char* str = malloc(sizeof(char) * 4);
strcpy(str, "abc"); 
```

这里，str 是与第一个示例相同的堆栈指针。这一次，它被初始化为指向堆上可以读写的 4 个字符的内存块。起初，该内存块未初始化，可以包含任何内容。strcpy 读取存储“abc”的只读内存块，并将其复制到 str 指向的读写内存块中。请注意，设置`str[3] = '\0'`是多余的，因为 strcpy 已经这样做了。

顺便说一句，如果您在 Visual Studio 中工作，请改用 strcpy_s 以确保在复制的字符串比您预期的长时不会覆盖缓冲区。

```
char str[] = "abc"; 
```

现在这`str`是一个分配在堆栈上的数组。编译器将调整它的大小，使其完全适合用于初始化它的字符串文字（包括 NULL 终止符）。堆栈内存是可读写的，因此您可以根据需要修改数组中的值。

```
char str[4] = "abc"; 
```

这实际上与以前的版本相同，只是您告诉编译器您比它更清楚数组应该多长。如果您更改字符串而不是数组大小，您可能会遇到麻烦。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-26T17:53:06.740

最简单的解决方案是将声明更改`str`为

```
char str[] = "abc"; 
```

这会`str`生成一个初始化为字符串“abc”的 char 数组。目前，您已将`str`指针作为指向字符的指针初始化为指向由字符串文字描述的字符串。有一个关键区别：字符串文字是只读的，以便编译器在存储位置方面具有最大的灵活性；修改它们是UB。但是 char 数组是可变的，因此可以修改它们。

PS。`main()`返回一个`int`.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-27T00:20:25.507

大爷，大爷。对于所有建议实际执行交换的方法的人，请仔细阅读问题；没有什么比不得不重申一个已经完美表达的问题更糟糕的了。不管用于实现交换的方法是什么（temp-swap、xor3-swap 等），这个人似乎对函数的基本和相当基本的内在函数非常熟悉。

然而，正如已经解释过的，编译器/链接器通常将所有字符串文字放在目标可执行文件的“常量数据段”中，随后在适当的“加载/执行”调用期间与不可写的 MMU 描述符相关联。随后通过此描述符发出的所有 CPU 写入周期都会自动被 MMU 的异常机制捕获，从而导致强制性的“段错误”或特定于平台的等效项。当然，不言而喻，旧的非 MMU 平台不会表现出这样的行为。

尽管这有效地获得了对源语言的“常量/文字”习语的运行时支持，但几个平台历来促进了显式的编译时段覆盖。然而，这种支持水平已经慢慢减少，取而代之的是更严格/健壮的抽象层，从而使许多明显且通常有用的优化变得站不住脚。随着时间和人员流失在过于急切的“微软”一代之前产生了逐渐老化的“MC/ASM”理念，程序员不再被认为有足够的知识或责任来做出这种决定。代替我作为项目负责人目睹的许多人为的，更不用说创造性的实施，这绝不是一件坏事。

尽管这篇文章正在迅速演变成一个偏离主题的违规行为，但我觉得从自上而下的相关问题源源不断地涌现出来，这些问题正逐渐在我们的行业中流行起来。作为一个初出茅庐的 C 程序员——一种最初设计用于补充低级开发的语言——我的建议是采用自下而上的方法，并通过一些课外汇编语言开发来增加你的学习。由于算法实现很可能构成您作为应用工程师的主要关注点，因此重要的是要记住，当代 CPU 设计在过去 30 年中经历了同质发展。今天的超快英特尔 CPU 只不过是我在地球还年轻时编程的 4/8 位双极处理器的超标量 CMOS 改进。

与流行的看法相反，汇编语言编程相对容易学习，并且在尝试协调高级构造与有问题或深奥的行为时绝对必不可少。一旦你考虑到无休止的实验、调试、网络搜索和论坛垃圾邮件，毫无疑问，自下而上的方法肯定是阻力最小的路径。

祝你学业顺利。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-26T17:24:52.820

*因为这是家庭作业，所以我会提供建议，但不会发布完整的解决方案。*

我猜你在 str[0] = 'b' 上遇到了访问冲突？这是因为“abc”是一个字符串文字。

在调用 reverse 之前复制 str 指向的字符串，或者获取 reverse 以分配缓冲区并将反转的字符串放入其中。

请记住，您必须取消分配您分配的所有内存。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T17:25:22.820

据我所知，常量字符串被实现为常量字符数组（或者，在 C 术语中，`const char [length]`）。因此，您不能修改其字符。

尝试动态分配字符串。

```
char* str = (char*)malloc(sizeof(char) * 4);
strcpy(str, "abc");
str[3] = '\0'; 
```

当然，不要忘记在程序结束时释放内存。

* * *

编辑：我不会发布任何与反转字符串相关的内容，因为那是你的工作。

# c - 简单浮点运算的奇怪结果 - 糟糕的 FPU 内部状态？

> ID：480562
> 
> 赞同：4
> 
> 时间：2009-01-26T17:14:19.987
> 
> 标签：c, debugging, floating-point, compiler-flags, fpu

我有一个软件项目，有时我会从小的、简单的浮点运算中得到奇怪的结果。我假设我错过了一些东西，并且想要一些关于如何调试以下问题的提示：

（使用的编译器是 MS VC 6.0，即 Microsoft C 编译器的 12 版）

第一个异常：

```
extern double Time, TimeStamp, TimeStep;  // History terms, updated elsewhere
void timer_evaluation_function( ) {
    if ( ( Time - TimeStamp ) >= TimeStep ) {  
        TimeStamp += TimeStep;  
        timer_controlled_code( );  
    }
{....} 
```

由于某种原因，计时器评估失败并且计时代码从未执行。在调试器中，可以看到触发条件实际上是正确的，但 FPU 拒绝找到肯定的结果。以下代码段没有问题，尽管它执行相同的操作。通过插入可能允许失败的虚假评估来回避这个问题。

我猜 FPU 状态在某种程度上被早期执行的操作所污染，并且有一些编译器标志会有所帮助？

第二个异常：

```
double K, Kp = 1.0, Ti = 0.02;
void timed_code( ){
    K = ( Kp * ( float ) 2000 ) / ( ( float ) 2000 - 2.0F * Ti * 1e6 )
{....} 
```

结果是#IND，即使调试器将等式计算为大约 0.05。当使用 fld 指令将 2.0F 值加载到 FPU 时，#IND 值出现在 FPU 堆栈中。上一条指令使用 fild 指令将整数值 2000 作为双浮点数加载。一旦 FPU 堆栈包含 #IND 值，所有内容都将丢失，但调试器再次评估公式没有问题。稍后，这些操作会返回预期的结果。

此外，FPU 问题再次发生在函数调用之后。我应该在每个新函数之后插入清除 FPU 状态的浮点操作吗？是否存在可能以某种方式影响 FPU 的编译器标志？

在这一点上，我很感激所有的提示和技巧。

编辑：我设法通过在顶部函数中首先调用汇编函数 EMMS 来避免这个问题。这样，FPU 就可以清除在调用我的代码的环境中创建或未创建的任何 MMX 相关垃圾。FPU 的状态似乎不是理所当然的。

//坦率

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T17:35:47.277

不知道问题可能是什么，但在 x86 上，FINIT 指令清除了 FPU。要测试您的理论，您可以将其插入代码中的某处：

```
__asm {
    finit
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T22:21:29.710

这并不是您问题的真正答案，但您可能想查看 Raymond Chen 关于奇怪 FPU 行为的两篇文章。阅读您的问题并重新阅读文章后，我没有立即看到链接 - 但如果您粘贴的代码不完整，或者文章让您了解导致问题的一些周围行为.. . 特别是，如果您在附近的任何地方加载 DLL。

[未初始化的浮点变量可能是致命的](http://blogs.msdn.com/oldnewthing/archive/2008/07/02/8679191.aspx)

[当我禁用无效浮点操作数异常时，它是如何引发的？](http://blogs.msdn.com/oldnewthing/archive/2008/07/03/8682463.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T00:36:36.707

如果您在支持 MMX 的系统上使用 Windows QueryPerformanceCounter 和 QueryPerformanceFrequency 函数，请尝试在查询频率/计数器之后和计算之前插入 femms 指令。

```
__asm femms 
```

在他们使用 MMX 进行 64 位计算并且不清除浮点标志/状态之前，我遇到了这些函数的问题。

如果浮点运算之间存在任何 64 位运算，也可能发生这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T17:31:38.890

虽然我没有为您提供确切的解决方案，但我建议您先阅读[这篇](http://msdn.microsoft.com/en-us/library/aa289157.aspx)描述可以使用的不同优化的文章。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T18:17:59.297

回复：时间戳——

您从什么获得时间戳的来源？听起来有些可疑。尝试将它们记录到文件中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-27T00:02:31.440

如果错误值由应该加载 2.0 的 fld 加载，我会检查加载该值的内存 - 这可能只是编译器/链接器问题。

# java - 对象中正在运行的线程是否会阻止它在 java 中被垃圾收集？

> ID：480566
> 
> 赞同：10
> 
> 时间：2009-01-26T17:15:50.560
> 
> 标签：java, concurrency, garbage-collection

给定代码：

```
 new Thread(new BackgroundWorker()).start(); 
```

直觉上，在线程退出之前，BackgroundWorker 实例应该不受 GC 影响，但情况是这样吗？为什么？

**编辑：**

所有这些热量基本上是由我在同一篇文章中至少提出两个不同的问题产生的。标题中的问题有一个答案，代码示例会导致不同的方向——根据内联，有两种可能的结果。

发布的答案非常好。我将授予 Software Monkey 绿色复选框。请注意，Darron 的回答同样有效，但 Software Monkey 解释了*我*遇到的问题；这是对我有用的答案。

感谢大家让这成为一次难忘的事情；）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-26T17:27:14.033

是的，因为 GC 只能收集任何线程都无法访问的对象，并且 Thread 必须持有对其可运行的引用（否则将无法调用它）。因此，很明显，您的 Runnable 对象在您的线程运行时是可访问的。

*无论执行*所需的语义如何，您的对象都不会被 GC，直到该新线程或任何其他线程不再可以访问它；这将至少足够长以调用您的 Runnable 的 run()，并且如果该线程能够到达 Runnable 实例，则在该线程的整个生命周期内，因此您的构造被 JVM 规范保证是安全的。

* * *

编辑：因为达伦把这个打死了，有些人似乎对他的论点深信不疑，我将根据他的解释来扩展我的解释。

> 暂时假设除了 Thread 本身之外的任何人调用 Thread.run() 是不合法的，
> 
> 在这种情况下，Thread.run() 的默认实现看起来像这样是合法的：

```
void run() {
    Runnable tmp = this.myRunnable;  // Assume JIT make this a register variable.
    this.myRunnable = null;          // Release for GC.
    if(tmp != null) {
        tmp.run();         // If the code inside tmp.run() overwrites the register, GC can occur.
        }
    } 
```

我认为在这种情况下 tmp 仍然是对在 Thread.run() 中执行的线程可访问的可运行对象的引用，因此不符合 GC 条件。

如果（出于某种莫名其妙的原因）代码看起来像：

```
void run() {
    Runnable tmp = this.myRunnable;  // Assume JIT make this a register variable.
    this.myRunnable = null;          // Release for GC.
    if(tmp != null) {
        tmp.run();         // If the code inside tmp.run() overwrites the register, GC can occur.
        System.out.println("Executed runnable: "+tmp.hashCode());
        }
    } 
```

显然，在 tmp.run() 执行时，tmp 引用的实例不能被 GC'd。

**我认为 Darron 错误地认为*可达*性仅意味着可以通过追逐以所有 Thread 实例作为根的实例引用来找到的引用，而不是被定义为任何执行线程都可以看到的引用。要么，要么我错误地相信相反的观点。**

此外，Darron 可以假设 JIT 编译器进行了他喜欢的任何更改 - 不允许编译器***更改***执行代码的引用语义。如果我编写的代码具有可访问的引用，则编译器无法优化该引用并导致在该引用在范围内时收集我的对象。

我不知道如何实际找到可达对象的细节；我只是在推断我认为必须坚持的逻辑。如果我的推理不正确，那么在方法中实例化并仅分配给该方法中的局部变量的任何对象都将立即符合 GC 条件——显然这不是，也不可能是这样。

此外，整个辩论是没有实际意义的。如果唯一可达的引用在 Thread.run() 方法中，因为 runnable 的 run 没有引用它的实例并且不存在对实例的其他引用，包括传递给 run() 方法的隐式*this*（在字节码中，不是作为声明的参数），那么*是否收集对象实例并不重要 - 根据定义，这样做不会造成任何伤害，因为如果隐式*this*已被优化掉，*则不需要执行代码。既然如此，即使 Darron 是正确的，最终的实际结果是 OP 假设的构造是完全安全的。无论哪种方式。没关系。让我再重复一遍，为了清楚起见——*归根结底分析无所谓*。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T17:21:47.087

是的，它是安全的。原因并不像您想象的那么明显。

仅仅因为 BackgroundWorker 中的代码正在运行并不能使其安全——有问题的代码实际上可能不会引用当前实例的任何成员，从而允许“this”被优化掉。

但是，如果您仔细阅读 java.lang.Thread 类的 run() 方法的规范，您会发现 Thread 对象必须保留对 Runnable 的引用才能履行其契约。

编辑：因为我在这个答案上多次被否决，所以我将扩展我的解释。

暂时假设除了 Thread 本身之外的任何人调用 Thread.run() 是不合法的，

在这种情况下，Thread.run() 的默认实现看起来像这样是合法的：

```
void run() {
    Runnable tmp = this.myRunnable;  // Assume JIT make this a register variable.
    this.myRunnable = null;          // Release for GC.
    if (tmp != null)
        tmp.run();         // If the code inside tmp.run() overwrites the register, GC can occur.
} 
```

我一直在说的是，**JLS 中的任何内容都不会**因为线程正在执行实例方法而阻止对象被垃圾收集。这是使最终确定如此困难的部分原因。

对于比我更了解它的人提供的令人难以忍受的细节，请参阅并发兴趣列表中的这个讨论[线程](http://cs.oswego.edu/pipermail/concurrency-interest/2009-January/005747.html)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-26T17:43:19.287

**这是安全的。** JVM 持有对每个线程的引用。Thread 持有传递给其构造函数的 Runnable 实例。所以 Runnable 是强可达的，并且不会在 Thread 的生命周期内被收集。

[由于Thread.run()](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#run())的 javadoc，我们知道 Thread 持有对可运行对象的引用：

> 如果该线程是使用单独的 Runnable 运行对象构造的，则调用该 Runnable 对象的 run 方法；否则，此方法不执行任何操作并返回。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T17:20:44.513

是的，因为它`Thread`保留了对`Runnable`内部的引用（毕竟它[必须知道要运行什么）。](http://java.sun.com/javase/6/docs/api/java/lang/Thread.html#run())

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T17:23:54.693

我敢打赌，JVM 包含对每个处于活动状态或可以在其根集中调度的线程对象的引用，但我没有确认这一点的规范。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T17:31:08.110

不，我认为这不安全。

在实践中，你几乎肯定会侥幸逃脱。然而，Java 内存模型令人惊讶。事实上，仅在上周 JMM 邮件列表上才讨论了添加一种“保持对象存活”的方法的计划。目前，终结器可以在没有从成员方法的执行中发生之前的关系的情况下运行。目前，从技术上讲，您需要通过在所有地方进行同步或在每个方法的末尾写入一些 volatile 并在 finaliser 中读取该 volatile 来引入发生之前的现实。

正如 Darron 指出的那样，如果你可以获取`Thread`对象（`Thread.enumerate`例如通过），那么你可以调用`run`它，它调用`Runnable`'s `run`。但是，我仍然认为那里没有*发生之前*。

我的建议：不要试图太“聪明”。

# css - 换行时在 DIV 中缩进文本的最佳方法是什么？

> ID：480567
> 
> 赞同：36
> 
> 时间：2009-01-26T17:16:02.557
> 
> 标签：css, html, word-wrap

所以我有一个包含一些动态文本的 DIV。假设我知道文本和字体大小，但我不知道 DIV 的大小。我希望 DIV 中的文本显示足够智能，以便在文本换行时显示缩进。

假设我的原文看起来像这样：

```
Lorem ipsum dolor sit amet，
结构性脂肪
精英，sed 做 eiusmod
临时事件

```

相反，我希望它看起来像这样：

```
Lorem ipsum dolor sit amet，
   结构性脂肪
   精英，sed 做 eiusmod
   临时事件

```

如果我不知道 DIV 先验的大小，最好的方法是什么？如果我知道尺寸，最好的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-26T17:23:25.303

如果我明白你的要求，这对我有用：

```
div {
    padding-left: 2em;
    text-indent: -2em;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-26T17:27:15.967

不确定跨浏览器支持，但您可以使用[第一行伪元素](http://www.w3schools.com/Css/pr_pseudo_first-line.asp)：

```
p {padding:10px;}
p:first-line {padding-left:0px;}

<p>Hello World, I'm Jonathan Sampson</p> 
```

将显示为

Hello World 我是
    乔纳森·
    桑普森

除此之外，您可以给元素左填充，然后是负文本缩进。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-26T17:28:46.370

W3C 说你只需要使用 text-indent 属性。

[资源](http://www.w3.org/TR/css3-text/#text-indent)

```
.indentedtext
{
    text-align:start;
    text-indent:5em;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T17:27:07.323

这对于可变和固定大小的 DIV 应该同样适用。

```
<div style="width: 150px; text-indent: -2em; padding-left: 2em;">
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor
    incididunt.
</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-29T11:15:50.387

使用 CSS`text-indent`属性：

```
.box {
  border: 1px solid #ddd;
  background: #fff;
  max-width: 300px;
  padding: 15px 15px 15px 45px;
}  

.box p {
  font-family: Arial, sans-serif;
  line-height: 1.5;
  margin: 0;
  text-align: justify;
  font-size: 12px;
  text-indent: -30px;
} 
```

```
<div class="box">
  <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Illo repellendus natus minima ex possimus? Pariatur odit distinctio, similique, adipisci nesciunt molestias iusto ipsa repellendus recusandae unde, enim veniam voluptatem expedita.</p>
</div>
```

# websphere - Websphere 6.1 出现奇怪的 404/j_security_check 错误

> ID：480573
> 
> 赞同：2
> 
> 时间：2009-01-26T17:17:25.910
> 
> 标签：websphere, rad, j-security-check

我有一个 websphere 6.1 配置并且应用程序正在运行，但是一些请求转到 j_security_check 但最后一个请求（有与 J_security_check 关联的过滤器）会生成 404 错误。

例如：

(1) 用户发帖到： [http://localhost:9081/Page/j_security_check](http://localhost:9081/Page/j_security_check) 它适用于Filter1，但后来对Filter2 的请求得到404 错误。

(1a) 注意，以下过滤器与 j_security_check 相关联：

```
<filter-mapping>
        <filter-name>Filter1</filter-name>
        <url-pattern>/j_security_check</url-pattern>
    </filter-mapping>
    <filter-mapping>
        <filter-name>Filter2</filter-name>
        <url-pattern>/j_security_check</url-pattern>
    </filter-mapping> 
```

(2)代码到达过滤器代码：

链.doFilter(req, res);

WASReqURL 具有以下 cookie 值，这是 j_security_check 需要的： [http://localhost:9081/Test/test.html](http://localhost:9081/Test/test.html)

理想情况下，客户端应该以“ [http://localhost:9081/Test/test.html](http://localhost:9081/Test/test.html) ”结束

但是，我在随后对 j_security_check 的请求中收到 404 错误： [http://localhost:9081/Page/j_security_check](http://localhost:9081/Page/j_security_check)

此外，这里是 web.xml 文件中的相关片段。

```
<login-config>
    <auth-method>FORM</auth-method>
    <form-login-config>
        <form-login-page>/Go</form-login-page>
        <form-error-page>/Go</form-error-page>
    </form-login-config>
</login-config> 
```

* * *

问题是，从 websphere 的角度来看，是什么控制了“J_security_check”。

详细信息：RAD7 Websphere Server 6.1，本地盒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T11:45:51.657

这是 WebSphere 6.1 和 Spring Security 的一个众所周知的问题。

您需要使用管理控制台将此变量添加到服务器属性：

```
 com.ibm.ws.webcontainer.invokefilterscompatibility = true 
```

我还记得您需要为 websphere 安装一些补丁，具体取决于确切的版本。

只需在互联网上查看我提到的变量，您就会找到解决方案......

希望能帮助到你 ...

米格尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-18T22:08:33.697

转到*应用程序服务器 > server1 > Web 容器 > 自定义属性*并确保`com.ibm.ws.webcontainer.invokefilterscompatibility`变量设置为 true。此变量用作`j_security_check`应用程序的开关。

# java - scala -> 在同一个程序中使用 .net (linq) 和 java 代码库？

> ID：480582
> 
> 赞同：1
> 
> 时间：2009-01-26T17:19:40.647
> 
> 标签：java, .net, linq, scala

这里的新手...我可以编写一个程序，在同一个 scala 程序中包含 .NET LINQ 和各种 Java 框架吗？或者当我编译时，当时决定是 .NET 还是 Java 中的一个或另一个

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T17:36:56.727

当你编译 scala 时，你可以给它 -target:msil 或 -target:jvm-XX （默认是 java）。这意味着您可以尝试使某些东西可以交叉编译（这将适用于两个目标，但必须为每个目标单独编译）。

尝试使用跨越边界的函数同时托管两个框架虽然在**技术上**是可行的，但非常困难，并且需要编译器和运行时级别的全面支持。

由于 scala 在一个或另一个运行时上运行，因此这极不可能运行良好，或者任何有能力实现它的人都会打扰。此外，各种 .Net 类型在 jvm 中没有类似物，反之亦然。

在这样的系统中正确有效地维护跨两个运行时的 GC 根将是一个抽象的博士论文的主题，更不用说实现它了。

# jquery - JQuery超时不执行

> ID：480589
> 
> 赞同：-1
> 
> 时间：2009-01-26T17:21:15.697
> 
> 标签：jquery, iis-6, timeout

我有一个带有 JQuery 的 js 客户端，这个 js 调用一个页面（GET HTTP）并设置超时。超时的目的是：“如果服务器没有响应就做点什么”。如果我使用 Apache Web 服务器来管理页面，则会执行超时。如果我使用 IIS 6.0，超时将被“跳过”并且页面尝试（无论如何）服务器响应。这是脚本：

//客户端

```
$.ajax({
    type: "GET",
    url: "some.php",
    data: "name=John&location=Boston",
    timeout: 5000
    success: function(msg){
        alert( "Data Saved: " + msg );
    },
    error: function(request, errorType, errorThrown){
        alert("opppsssss .... ");
    }
}); 
```

我想那是一个 IIS.. 对吗？或者我在 JQuery 代码中犯了一个错误？

最好的问候

多梅尼科

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T17:55:01.450

正如 Paolo 在评论中提到的，您在超时声明后缺少逗号。我最近遇到了这样一种情况，在这样的对象声明中缺少逗号会导致 IE 阻塞脚本并且无法正确运行它（而 firefox 运行它没有问题）。

这不能解释为什么不同的服务器会导致不同的行为，但可能值得首先修复并重新测试，因为行为可能会改变并且可能更容易调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-27T08:42:36.447

感谢您的回复，我完成了问题:)

服务器代码是：

//后端一些.php

< ?

//模拟长任务

睡眠（10）；//睡眠10秒

//发送响应

echo "一些测试数据";

? >

抱歉，逗号错误是我的剪切和粘贴错误..

问题是当超时结束时，不会出现错误对话框，因为来自服务器的连接没有被超时中断，因此服务器（缓慢）响应。

你知道因为服务器连接没有中断吗？

# iphone - 编写可重用接口对象的正确技术？

> ID：480604
> 
> 赞同：3
> 
> 时间：2009-01-26T17:25:54.597
> 
> 标签：iphone, objective-c, oop, widget

我正在寻找编写自己的界面对象的正确方法。

说，我想要一个可以双击的图像。

```
@interface DoubleTapButtonView : UIView {
    UILabel *text;
    UIImage *button;
    UIImage *button_selected;
    BOOL selected;
}
// detect tapCount == 2
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event; 
```

这工作正常 - 按钮接收事件并可以检测到双击。

我的问题是如何干净地处理动作。我尝试过的两种方法是添加对父对象和委托的引用。

传递对父对象的引用非常简单......

```
@interface DoubleTapButtonView : UIView {
    UILabel *text;
    UIImage *button;
    UIImage *button_selected;
    BOOL selected;
    MainViewController *parentView; // added
}

@property (nonatomic,retain) MainViewController *parentView; // added

// parentView would be assigned during init...
- (id)initWithFrame:(CGRect)frame 
     ViewController:(MainViewController *)aController;

- (id)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event; 
```

但是，这会阻止我的 DoubleTapButtonView 类被轻松添加到其他视图和视图控制器。

委托为代码添加了一些额外的抽象，但它允许我在任何适合委托接口的类中使用 DoubleTapButtonView。

```
@interface DoubleTapButtonView : UIView {
    UILabel *text;
    UIImage *button;
    UIImage *button_selected;
    BOOL selected;
  id <DoubleTapViewDelegate> delegate;
}

@property (nonatomic,assign) id <DoubleTapViewDelegate> delegate;

@protocol DoubleTapViewDelegate <NSObject>

@required
- (void)doubleTapReceived:(DoubleTapView *)target; 
```

这似乎是设计对象的正确方法。该按钮只知道它是否被双击，然后告诉代表谁决定如何处理这些信息。

我想知道是否有其他方法可以考虑这个问题？我注意到 UIButton 使用 UIController 和 addTarget: 来管理发送事件。在编写我自己的界面对象时是否希望利用这个系统？

更新：另一种技术是使用 NSNotificationCenter 为各种事件创建观察者，然后在按钮中创建事件。

```
// listen for the event in the parent object (viewController, etc)
[[NSNotificationCenter defaultCenter] 
  addObserver:self selector:@selector(DoubleTapped:) 
  name:@"DoubleTapNotification" object:nil];

// in DoubleTapButton, fire off a notification...
[[NSNotificationCenter defaultCenter] 
  postNotificationName:@"DoubleTapNotification" object:self]; 
```

这种方法有什么缺点？更少的编译时检查，以及在对象结构之外飞来飞去的事件的潜在意大利面条代码？（如果两个开发人员使用相同的事件名称，甚至命名空间冲突？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T18:29:51.877

代表绝对是去这里的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T18:34:46.063

或子类化`UIControl`并使用`-sendActionsForControlEvents:`. 这样做的主要优点是针对特定操作的多个目标……在这种情况下，当然，你只有双击，但我认为这是总体上最好的方法。

# c# - Visual Studio 2005 清洁解决方案

> ID：480608
> 
> 赞同：4
> 
> 时间：2009-01-26T17:27:06.887
> 
> 标签：c#, visual-studio, visual-studio-2005

如果我有 10 个项目的解决方案。当我单击“清理解决方案”时，是否只清理了主启动项目解决方案中的 bin/debug 或每个项目目录中的 bin/debug？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-26T17:30:28.520

它为当前选择的配置（例如调试、发布等）清理解决方案中包含的每个项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T17:32:55.907

要添加其他答案，如果您想要右键单击应用程序，可以在[此处](http://www.codinghorror.com/blog/archives/000368.html)找到 clean source plus 的源代码。

*这个应用程序做一件事。它向文件夹添加了一个资源管理器 shell 菜单，选择该菜单后将递归删除 bin、obj 和 setup 文件夹的内容。如果您有一个想要与某人共享的 .NET 项目，这有助于在将其压缩并发送之前从文件夹中删除不必要的内容。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T18:10:46.597

它不会清除所有内容，而是清除所有配置为在您的解决方案属性中构建的项目。即，如果您有包含项目 A 和 B 的解决方案，并且在某个时刻您检查了项目 B 的“解决方案属性中的构建”，“配置属性”部分，那么下次您制作干净的项目 B 时将不会被清理。

# shared-libraries - 使用 dlopen 加载库时收到“未定义符号”错误

> ID：480617
> 
> 赞同：23
> 
> 时间：2009-01-26T17:29:22.890
> 
> 标签：shared-libraries, dlopen

我正在编写一些使用动态共享库作为插件的代码。

我用于构建共享库的命令行如下所示：

```
cc -shared -fPIC -o module.so -g -Wall module.c 
```

在模块中，我可以调用在主可执行文件中加载的任何其他共享库中的函数。

但是我无法访问（导出）可执行文件本身的函数（我收到`undefined symbol`错误）。

我的电话`dlopen`看起来像这样：

```
void *handle = dlopen(plugin, RTLD_NOW); 
```

谁能告诉我的模块如何回调我的可执行文件，而不必将所有可执行文件的实用程序功能放入另一个共享库中？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-27T07:31:38.367

正确的解决方案是添加`-rdynamic`到主可执行文件的链接命令。这将添加适当的选项`ld`（使用 时`GNU ld`，恰好是`--export-dynamic`）。

直接添加`--export-dynamic`在技术上是不正确的：它是一个链接器选项，因此应该添加为`-Wl,--export-dynamic`, 或`-Wl,-E`. 这也比`-rdynamic`（其他链接器具有等效项，但选项本身不同）更不便携。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-26T17:40:38.717

我自己找到了答案。

我必须将`--export-dynamic`标志添加到主可执行文件的链接选项中。

> 创建动态链接的可执行文件时，将所有符号添加到动态符号表中。动态符号表是在运行时从动态对象可见的符号集。
> 
> 如果您不使用此选项，动态符号表通常将仅包含链接中提到的某个动态对象引用的那些符号。
> 
> 如果您使用“dlopen”加载需要引用程序定义的符号的动态对象，而不是其他一些动态对象，那么您可能需要在链接程序本身时使用此选项。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-30T18:47:34.363

当我遇到同样的问题时，我只是使用了以下解决方案。在加载任何插件之前，只需加载程序本身，将其符号带到动态表中：

```
dlopen(NULL,RTLD_NOW|RTLD_GLOBAL); 
```

我认为解决方案更好。原因是，如果你也解决了同样的问题

a）您的程序（或第三方模块）与共享库链接（不在运行时），这些符号需要在动态表中；

b) 不能使用 -rdynamic 标志重新编译该模块。

# c# - 为什么 FTPWebRequest 或 WebRequest 通常不接受 /../ 路径？

> ID：480619
> 
> 赞同：3
> 
> 时间：2009-01-26T17:30:09.800
> 
> 标签：c#, ftpwebrequest

我正在尝试从 ftp Web 服务器自动执行一些上传/下载任务。当我通过客户端甚至通过 Firefox 连接到服务器时，为了访问我的目录，我必须指定如下路径：

```
ftp://ftpserver.com/../AB00000/incoming/files 
```

如果我尝试访问这个：

```
ftp://ftpserver.com/AB00000/incoming/files 
```

服务器抛出目录不存在的错误。所以，问题：

我正在尝试使用第一个 ftp 地址创建一个 FTPWebRequest，但它总是解析出“/../”部分，然后我的服务器说该路径不存在。

我试过这些：

```
 Uri target = new Uri("ftp://ftpserver.com/../AB00000/incoming/files");
FtpWebRequest request = (FtpWebRequest)WebReqeuest.Create(target); 
```

和

```
string target = "ftp://ftpserver.com/../AB00000/incoming/files";
FtpWebRequest request = (FtpWebRequest)WebRequest.Create(target); 
```

在第一个位中，当 Uri 对象被实例化时，路径已经不正确，在第二个位中，它在 WebRequest.Create 方法之后。有什么想法吗？

编辑：

此外，自从我发布此内容后，我尝试使用无解析选项创建 URI。我也尝试过这样的事情：

```
string ftpserver = "ftp://ftpserver.com/../";
string path = "12345/01/01/file.toupload";

Uri = new Uri(ftpserver, path, true); 
```

它总是解析出根部分（“/../”）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-06T16:40:58.870

尝试转义 .. 用类似的东西：

```
Uri target = new Uri("ftp://ftpserver.com/%2E%2E/AB00000/incoming/files"); 
```

根据我在这个[讨论中找到的这个](http://social.msdn.microsoft.com/Forums/en-US/netfxnetcom/thread/76d3a3a2-48b6-4753-988e-dfd845f582e9/)[博客](http://blogs.msdn.com/mariya/default.aspx)，这是有效的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-06T16:43:32.313

不太确定，但这可能是出于安全原因，因为允许“/../” URI 可能会让人们在任何服务器的文件系统上自由导航。

此外，官方[URI RFC](http://www.ietf.org/rfc/rfc2396.txt)指出，在解析 URI 时，执行的步骤之一实际上是删除“/../”段，因此这在 C# 库中不是问题，而是常规的 URI 行为。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-26T18:02:51.697

您是否尝试过像这样使用 @ 符号？

```
Uri target = new Uri(@"ftp://ftpserver.com/../AB00000/incoming/files");
FtpWebRequest request = (FtpWebRequest)WebReqeuest.Create(target); 
```

# c# - Asp.Net Global.asax 访问当前请求的 Page 对象

> ID：480623
> 
> 赞同：6
> 
> 时间：2009-01-26T17:30:33.887
> 
> 标签：c#, asp.net, global-asax

有什么方法可以从 global.asax Application_EndRequest 函数中访问页面对象吗？

我试图在请求的末尾设置标签的文本，但事实证明访问页面比我想象的要困难。

这是我目前无法使用的：

```
protected void Application_BeginRequest(Object sender, EventArgs e)

    {

        Context.Items.Add("Request_Start_Time", DateTime.Now);

    }

    protected void Application_EndRequest(Object sender, EventArgs e)
    {

        TimeSpan tsDuration = DateTime.Now.Subtract((DateTime)Context.Items["Request_Start_Time"]);

        System.Web.UI.Page page = System.Web.HttpContext.Current.Handler as System.Web.UI.Page;
        if (page != null)
        {
            Label label = page.FindControl("lblProcessingTime") as Label;
            if (label != null)
            {
                label.Text = String.Format("Request Processing Time: {0}", tsDuration.ToString());
            }
        }
    } 
```

page 在这里始终为空。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T17:32:55.393

最好只创建一个 BasePage 类，您的所有页面都应从该类继承。然后你可以把代码放在页面的 Unload 事件中，就没有问题了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T18:22:16.060

您不能在 Application_Start 和 Application_End 中执行此操作。

来自 MSDN：

Application_Start 和 Application_End 方法是不代表 HttpApplication 事件的特殊方法。ASP.NET 在应用程序域的生命周期内调用它们一次，而不是为每个 HttpApplication 实例调用一次。

[http://msdn.microsoft.com/en-us/library/ms178473.aspx](http://msdn.microsoft.com/en-us/library/ms178473.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T18:37:54.810

在请求生命周期的这个阶段，页面已经呈现并且页面对象不再可用。您将需要使用较早的事件。

也就是说，我不会推荐这种方法，因为它存在许多问题：

您正在使用 FindControl。如果控件的名称发生更改，此代码将中断。

此代码将针对任何请求运行，而不仅仅是页面，而不仅仅是您需要运行它的特定页面。

此代码应位于母版页或页面基类中，您可以在其中以类型安全的方式访问标签。

# c# - 为什么没有人接受 C# 中的公共字段？

> ID：480627
> 
> 赞同：30
> 
> 时间：2009-01-26T17:31:46.333
> 
> 标签：c#, properties, field, public

似乎每个 C# 静态分析器在看到公共字段时都想抱怨。但为什么？当然，在某些情况下，公共（或内部）*字段*`get_`就足够了，并且拥有带有其和`set_`方法的属性没有意义吗？如果我确定我不会重新定义字段或添加字段怎么办（副作用很糟糕，对吗？） - 一个简单的字段不应该足够吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-01-26T17:33:41.850

因为它破坏了封装——这就是大多数人大量使用访问器的原因。但是，如果您认为它是您任务的正确解决方案，请忽略它（意味着严格的封装投诉）并为您的项目做正确的事情。不要让 OO 纳粹告诉你否则。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-26T17:35:14.000

这真的是为了让你的代码面向未来。当你说（强调我的）：

> **如果我确定**我不会重新定义字段或添加字段怎么办（副作用很糟糕，对吗？） - 一个简单的字段不应该足够吗？

这是一个绝对的陈述，正如我们所知（以及大多数静态分析器），生活中只有两个绝对。

它只是想保护你免受伤害。如果这是一个问题，您应该能够告诉分析器忽略它（通过依赖于您正在使用的分析工具的属性）。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-01-26T17:45:30.453

鉴于当前 C# 3.0 允许自动属性，其语法如下：

```
public int Property {get; set;} 
```

在公共字段上使用属性所需的额外工作几乎为零。问题是你永远不能完全确定一个字段不会被不同地使用，或者访问器永远不会改变，并且考虑到工作中的权衡，没有理由不实现一个属性。

无论如何，分析器抱怨的事情在很大一部分（在这种情况下，如 99.99% 的情况下）是糟糕的编程实践......但无论如何它只是在抱怨。字段可以公开，并且在某些极端情况下直接使用它是合理的。与以往一样，**使用您的常识**......但请记住最佳编程实践的基本规则......**是否真的有很好的理由来打破约定？**如果有然后继续，如果没有，或者如果答案是“它涉及更多工作”，那么坚持练习......

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-26T17:35:19.977

因为稍后更改公共字段以具有 get/set 访问器会破坏代码。有关更多信息，请参阅[此答案](https://stackoverflow.com/questions/340528/c-automatic-properties-why-do-i-have-to-write-get-set#340682)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-26T17:35:34.873

通常，将字段隐藏在属性后面是个好主意，即使您“确定”不会重新定义字段。很多时候，你今天“确定”的事情明天就会改变。而且，让一个属性引用一个字段只是有点麻烦。

也就是说，静态分析器不能替代思想。如果您对自己的设计感到满意并且您判断分析器是错误的，那么在这种情况下忽略或（如果可能）抑制该警告。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T17:36:14.280

我认为关键在于，通常您不确定您以后不会重新定义该字段或添加该字段。封装和隐藏数据的全部意义在于您可以自由地做这些事情，而无需更改公共接口并随后破坏依赖类。如果您的属性访问器只是简单的 get/sets，那么无论如何它们都会被编译成这样，所以没有性能问题 - 鉴于此，您的问题应该是是否有充分的理由不使用它们？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-26T17:50:01.490

另一个带来好处的属性是在进行反射时。当您反思您的课程时，您可以一次获得所有属性，而不必获取属性和字段。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-26T17:51:31.627

And let's not forget that accessors give you flexibility when working with multiple threads.

# java - 为什么 java.lang.Number 不实现 Comparable？

> ID：480632
> 
> 赞同：149
> 
> 时间：2009-01-26T17:32:52.977
> 
> 标签：java, sorting, comparable

有谁知道为什么 `java.lang.Number`不实施`Comparable`？这意味着您不能对`Number`s 进行排序，`Collections.sort`这在我看来有点奇怪。

**发布讨论更新：**

感谢所有有用的回复。我最终[对这个主题做了更多的研究](http://radioeiffel.blogspot.com/2009/02/what-java-can-sort-numbers.html)。

为什么 java.lang.Number 不实现 Comparable 的最简单解释源于可变性问题。

稍微回顾一下，是, , , , , , , , and`java.lang.Number`的抽象超类型。在那个列表上，并且不执行.`AtomicInteger``AtomicLong``BigDecimal``BigInteger``Byte``Double``Float``Integer``Long``Short``AtomicInteger``AtomicLong``Comparable`

挖掘了一下，我发现`Comparable`在可变类型上实现并不是一个好习惯，因为在比较期间或之后对象可能会发生变化，从而使比较结果变得无用。`AtomicLong`和都是`AtomicInteger`可变的。API 设计者有先见之明没有`Number`实现`Comparable`，因为它会限制未来子类型的实现。确实，`AtomicLong`并且在最初实现`AtomicInteger`之后很久就被添加到 Java 1.5中。`java.lang.Number`

除了可变性之外，这里可能还有其他考虑因素。一个`compareTo`实现`Number`必须将所有数值提升为，`BigDecimal`因为它能够容纳所有`Number`子类型。这种提升在数学和性能方面的含义对我来说有点不清楚，但我的直觉发现这个解决方案很笨拙。

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-01-26T21:20:59.177

值得一提的是以下表达式：

```
new Long(10).equals(new Integer(10)) 
```

总是`false`，这往往会在某个时候或另一个时候绊倒每个人。因此，您不仅不能比较任意`Number`的 s，而且您甚至无法确定它们是否相等。

此外，对于真正的原始类型 ( `float`, `double`)，确定两个值是否相等是很棘手的，并且必须在可接受的误差范围内完成。尝试如下代码：

```
double d1 = 1.0d;
double d2 = 0.0d;
for (int i=0; i<10; i++) {
  d2 += 0.1d;
}
System.out.println(d2 - d1); 
```

你会留下一些小的差异。

所以回到制作的问题`Number` `Comparable`。你将如何实施它？使用类似的东西`doubleValue()`不会可靠地做到这一点。请记住，`Number`子类型是：

*   `Byte`;
*   `Short`;
*   `Integer`;
*   `Long`;
*   `AtomicInteger`;
*   `AtomicLong`;
*   `Float`;
*   `Double`;
*   `BigInteger`; 和
*   `BigDecimal`.

您能否编写一个`compareTo()`不会演变为一系列 if instanceof 语句的可靠方法？ `Number`实例只有六个可用的方法：

*   `byteValue()`;
*   `shortValue()`;
*   `intValue()`;
*   `longValue()`;
*   `floatValue()`; 和
*   `doubleValue()`.

所以我猜 Sun 做出了（合理的）决定，`Number`只`Comparable`针对他们自己的实例。

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-01-26T17:40:37.657

有关答案，请参阅 Java bugparade[错误 4414323](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4414323)。您还可以从[comp.lang.java.programmer找到讨论](http://coding.derkeiler.com/Archive/Java/comp.lang.java.programmer/2007-07/msg02451.html)

引用 Sun 对 2001 年错误报告的回应：

> 所有的“数字”都没有可比性；可比较假设数字的总排序是可能的。浮点数甚至都不是这样。NaN（不是数字）既不小于、大于也不等于任何浮点值，甚至它本身。{Float, Double}.compare 施加与浮点“<”和“=”运算符的顺序不同的总顺序。此外，按照目前的实现，Number 的子类只能与同一类的其他实例进行比较。还有其他情况，例如复数，不存在标准的总排序，尽管可以定义一个。简而言之，Number 的子类是否具有可比性应该留给该子类来决定。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-26T17:39:25.693

为了实现数字上的可比性，您必须为每个子类对编写代码。相反，只允许子类实现可比较更容易。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-18T12:36:38.917

为了尝试解决原始问题（对数字列表进行排序），一个选项是声明一个泛型类型的列表扩展 Number 并实现 Comparable。

就像是：

```
<N extends Number & Comparable<N>> void processNumbers(List<N> numbers) {
    System.out.println("Unsorted: " + numbers);
    Collections.sort(numbers);
    System.out.println("  Sorted: " + numbers);
    // ...
}

void processIntegers() {
    processNumbers(Arrays.asList(7, 2, 5));
}

void processDoubles() {
    processNumbers(Arrays.asList(7.1, 2.4, 5.2));
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-26T17:38:05.023

很可能是因为比较数字会相当低效 - 每个数字可以适合允许这种比较的唯一表示是 BigDecimal。

相反，Number 的非原子子类实现了 Comparable 本身。

原子的是可变的，所以不能实现原子比较。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-04-13T12:14:14.943

您可以使用[Transmorph](http://transmorph.sourceforge.net)使用其 NumberComparator 类来比较数字。

```
NumberComparator numberComparator = new NumberComparator();
assertTrue(numberComparator.compare(12, 24) < 0);
assertTrue(numberComparator.compare((byte) 12, (long) 24) < 0);
assertTrue(numberComparator.compare((byte) 12, 24.0) < 0);
assertTrue(numberComparator.compare(25.0, 24.0) > 0);
assertTrue(numberComparator.compare((double) 25.0, (float) 24.0) > 0);
assertTrue(numberComparator.compare(new BigDecimal(25.0), (float) 24.0) > 0); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-27T12:37:13.087

编写自己的比较器

```
import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.concurrent.atomic.AtomicLong;

public class NumberComparator implements Comparator {
    @SuppressWarnings("unchecked")
    @Override
    public int compare(Number number1, Number number2) {
 if (((Object) number2).getClass().equals(((Object) number1).getClass())) {
     // both numbers are instances of the same type!
     if (number1 instanceof Comparable) {
  // and they implement the Comparable interface
  return ((Comparable) number1).compareTo(number2);
     }
 }
 // for all different Number types, let's check there double values
 if (number1.doubleValue() < number2.doubleValue())
     return -1;
 if (number1.doubleValue() > number2.doubleValue())
     return 1;
 return 0;
    }

    /**
     * DEMO: How to compare apples and oranges.
     */
    public static void main(String[] args) {
 ArrayList listToSort = new ArrayList();
 listToSort.add(new Long(10));
 listToSort.add(new Integer(1));
 listToSort.add(new Short((short) 14));
 listToSort.add(new Byte((byte) 10));
 listToSort.add(new Long(9));
 listToSort.add(new AtomicLong(2));
 listToSort.add(new Double(9.5));
 listToSort.add(new Double(9.0));
 listToSort.add(new Double(8.5));
 listToSort.add(new AtomicInteger(2));
 listToSort.add(new Long(11));
 listToSort.add(new Float(9));
 listToSort.add(new BigDecimal(3));
 listToSort.add(new BigInteger("12"));
 listToSort.add(new Long(8));
 System.out.println("unsorted: " + listToSort);
 Collections.sort(listToSort, new NumberComparator());
 System.out.println("sorted:   " + listToSort);
 System.out.print("Classes:  ");
 for (Number number : listToSort) {
     System.out.print(number.getClass().getSimpleName() + ", ");
 }
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-26T22:04:22.070

不同类型的数字没有标准比较。但是，您可以编写自己的 Comparator 并使用它来创建 TreeMap<Number, Object>, TreeSet<Number> 或 Collections.sort(List<Number>, Comparator) 或 Arrays.sort(Number[], Comparator);

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-12-08T16:07:09.440

为什么这是个坏主意？：

```
abstract class ImmutableNumber extends Number implements Comparable {
    // do NOT implement compareTo method; allowed because class is abstract
}
class Integer extends ImmutableNumber {
    // implement compareTo here
}
class Long extends ImmutableNumber {
    // implement compareTo here
} 
```

另一种选择可能是声明类 Number 实现 Comparable，省略 compareTo 实现，并在 Integer 等某些类中实现它，而在 AtomicInteger 等其他类中抛出 UnsupportedException。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-26T17:38:45.350

我的猜测是，通过不实现 Comparable，它为实现或不实现它的类提供了更大的灵活性。所有常见的数字（Integer、Long、Double 等）都实现了 Comparable。只要元素本身实现 Comparable，您仍然可以调用 Collections.sort。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-26T17:40:16.113

查看类层次结构。Long、Integer 等包装类实现了 Comparable，即 Integer 与整数可比较，long 与 long 可比较，但不能混合使用。至少对于这种泛型范式。我想这回答了你的问题'为什么'。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-26T18:50:33.427

`byte`（原始）是一个`int`（原始）。基元一次只有一个值。
语言设计规则允许这样做。

```
int i = 255

// down cast primitive
(byte) i == -1 
```

A`Byte`不是`Integer`. `Byte`是一个`Number`，一个`Integer`是一个`Number`。`Number`对象可以同时具有多个值。

```
Integer iObject = new Integer(255);
System.out.println(iObject.intValue());   // 255
System.out.println(iObject.byteValue());  // -1 
```

如果 a`Byte`是 an`Integer`并且 an`Integer`是 a `Number`，您将在`compareTo(Number number1, Number number2)`方法中使用哪个值？

# algorithm - 对部分有序列表进行排序的最佳方法是什么？

> ID：480640
> 
> 赞同：7
> 
> 时间：2009-01-26T17:35:38.617
> 
> 标签：algorithm, language-agnostic, sorting, topological-sort, partial-ordering

可能最好用一个小例子来说明。
鉴于关系

```
A < B < C
A < P < Q 
```

正确的输出将是

```
ABCPQ or APQBC or APBCQ ... etc. 
```

换句话说，任何给定关系成立的排序都是有效的。

我对最容易实现的解决方案最感兴趣，但速度和时间上最好的 O(n) 也很有趣。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-26T18:32:16.257

这称为[拓扑排序](http://en.wikipedia.org/wiki/Topological_sorting)。

标准算法是输出一个最小元素，然后将其删除并重复直到完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T18:02:56.877

做几种。先按照第一个规则排序，然后按照第二个规则排序，以此类推。应该有效，除非您的规则包含矛盾。确实很容易实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T18:55:46.380

您可以使用手头的序列在 C++ 中重复调用 make_heap、pop_heap。

# windows - Windows 2003 上的通配符子域设置

> ID：480641
> 
> 赞同：2
> 
> 时间：2009-01-26T17:35:39.880
> 
> 标签：windows, wildcard, subdomain

我正在尝试为依赖通配符子域的 Web 应用程序设置内部登台服务器。

对于如何使用 Windows Server 2003 DNS 设置通配符子域，我将不胜感激。（我好像不能`*.domain.tld. IN A 1.2.3.4`直接输入“”）

谢谢。

更多信息：

我有一个区域`MY.LAN`，在该区域下我有一个服务器（A 记录）`staging01`。我想为 staging01 设置通配符子域

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T17:40:06.627

我刚刚检查过，您肯定可以将通配符条目直接输入到服务器 2003 DNS 中。只需进入右侧区域的新A记录，在名称框中输入*，然后输入IP，就可以了。

# cocoa - OpenStep 作为开发环境的更新程度如何？

> ID：480645
> 
> 赞同：6
> 
> 时间：2009-01-26T17:36:19.787
> 
> 标签：cocoa, qt, mfc, gtk, openstep

很久以前，Game Developer 杂志发表了一篇关于 ID Software 和他们的 DOOM 游戏的文章。在文章 ID 中指出，他们使用 NeXT Step 机器进行开发，并使用 GNU GCC 交叉编译器。报价：

> *通过在 NeXTStep 上使用 ANSI C 编写，Id Software 能够在真正的程序员环境中进行开发和测试。然后，使用网络，开发人员能够将代码发送到运行 DOS 的测试 PC 并重新编译他们正在处理的内容，以便在其自然环境中运行游戏。*

NextStep 演变成 Cocoa，其他 OS 也随着其他 UI 框架、GTK、Qt、MFC 等一起成长……

说要获得“真正的开发环境”，OpenStep 项目是否已经发展到可以与 Cocoa/MFC/GTK/Qt 竞争的方式？

仅从项目截图来看，框架似乎及时停止了，小部件不如我所说的其他框架的好，但丑不是软件开发的衡量标准，支持、成熟度和完整性如何OpenStep 小部件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-27T08:09:55.933

Cocoa**是**OpenStep。是直系后代。OpenStep 变成了 Yellow Box 变成了 Cocoa。

通过询问“OpenStep 项目是否已经发展”，听起来您是在询问**GNUstep**，而不是 OpenStep。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T17:46:07.630

您可能会对[这个播客感兴趣。](http://twit.tv/floss44)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T18:47:28.723

“真正的开发环境”在当时意味着“比 DOS 更好的东西”。NextStep 和 OpenStep 领先于他们的时代，但从那时起已经过去了很多时间。

Mac OS X 上的 Cocoa 是一个不错的开发环境，但它并不明显优于其他当前流行的开发环境。（它比 MFC 或 VB6 更好，但 Java 和 .NET 开发人员不会为之惊叹。）

# windows - Django Apache/mod_python Admin CSS 没有出现在管理表中

> ID：480665
> 
> 赞同：16
> 
> 时间：2009-01-26T17:42:29.557
> 
> 标签：windows, django, apache, admin, mod-python

我有 Windows XP/Django/apache/mod_python 在本地主机上工作。除了管理 CSS 不呈现之外，所有部分都在工作。管理员工作，但没有 html 格式。我在以下方面做了补充：

```
settings.py

  INSTALLED_APPS
  'django.contrib.admin',

urls.py

  from django.contrib import admin
  admin.autodiscover()
  (r'^admin/(.*)', admin.site.root),

conf/http.conf

  <Location "/"> 
    SetHandler python-program
    PythonPath "['C:/django'] + sys.path"
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE mysite.settings
    PythonDebug On
  </Location>

  <Location "/cpssite/"> 
    SetHandler python-program
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE myapplication.settings
    PythonInterpreter /myapplication
    PythonDebug On
  </Location> 
```

我难住了。我应该在某处添加更多代码吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-26T17:47:28.767

您的 ADMIN_MEDIA_PREFIX 是否存在？它与 MEDIA_URL 不同吗？你是否包括了尾随斜杠？Apache 是否被处理以正确提供管理媒体？

默认 Django 配置的管理媒体位于 {Django install dir}/contrib/admin/media。ADMIN_MEDIA_PREFIX 默认为 /media/。所以你需要在你的 Apache 配置中添加这样的东西：

```
Alias /media/ /path/to/django/contrib/admin/media/ 
```

这将告诉 Apache 对 mysite.com/media/css/whatever.css 的请求意味着提供 /path/to/django/contrib/admin/media/css/whatever.css，这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-06T12:03:07.027

我曾经遇到过同样的问题，http.conf 中的以下条目对我来说效果很好：

```
<Directory "Path-to-python/Lib/site-packages/django/contrib/admin/media/"> 
    AllowOverride None 
    Options None 
    Order allow,deny 
    Allow from all 
</Directory> 

Alias /media/ "Path-to-Python/Lib/site-packages/django/contrib/admin/media/"

<Location "/mysite/">
    SetHandler python-program
    PythonHandler django.core.handlers.modpython
    SetEnv DJANGO_SETTINGS_MODULE mysite.settings
    PythonOption django.root /mysite
    PythonInterpreter mysite
    PythonDebug On
    PythonPath "['C:/Python/Django/apps'] + sys.path"
</Location> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T06:05:28.970

这是我的 django 特定的 apache 配置。请注意，django 处理站点（位置 /）的每个传入 url，除了媒体，它被禁用，并且数据从 django 的媒体目录提供。

```
<Location "/">
  SetHandler python-program
  PythonHandler django.core.handlers.modpython
  SetEnv DJANGO_SETTINGS_MODULE mysite.settings
  #PythonOption django.root /
  PythonDebug On
  PythonPath "['e:/dj'] + sys.path"
</Location>

Alias /media  e:/dj/django-trunk/django/contrib/admin/media/
<Location "/media">
  SetHandler None
</Location> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-23T16:18:25.453

如果您不想让管理媒体使用 /media 目录，您可以指定 ADMIN_MEDIA_PREFIX = 'admin_media'，然后从您的网络服务器创建一个链接/别名，它将对 /admin_media/ 的调用重定向到 /usr/share/pyshared/ django/contrib/admin/media（取决于您的操作系统）为您的生产服务器...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-18T12:08:21.027

由于问题来自很久以前，这可能不是一个相关的答案，但我将这些信息用于帮助像我一样碰巧在这里绊倒的任何人。从 1.4 版开始，不推荐使用 ADMIN_MEDIA_PREFIX 设置。此处描述了提供版本 >= 1.4 的静态和媒体文件的方式

[https://docs.djangoproject.com/en/dev/releases/1.4/#django-contrib-admin](https://docs.djangoproject.com/en/dev/releases/1.4/#django-contrib-admin)

[https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/#serving-files](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/#serving-files)

[https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/#serving-the-admin-files](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/modwsgi/#serving-the-admin-files)

基本上它可以通过 4 个步骤进行设置 -

1.  将 STATIC_ROOT 设置为指向将为您站点的所有静态文件提供服务的目录
2.  设置应为其提供静态内容的 STATIC_URL
3.  运行 manage.py collectstatic
4.  配置您的网络服务器以服务来自 STATIC_ROOT 的 STATIC_URL 请求

媒体文件也一样

# database - 如何在 Quest Toad“浏览数据库对象”视图中将字段设置为空？

> ID：480670
> 
> 赞同：3
> 
> 时间：2009-01-26T17:43:53.593
> 
> 标签：database, toad

简单的问题，如果有一个解决方案，我会喜欢！我认为必须有一些键盘快捷键可以插入空值，但谷歌没有帮助。

提前致谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-29T13:41:17.787

我听从了布伦特的建议，得到了我的答案：`ctrl`+ `del`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-27T12:16:36.780

如果您在 Toad 的邮件列表上发布此内容，您将收到开发人员本人（或其他高级用户）的回复：

[http://www.toadsoft.com/maillist.htm](http://www.toadsoft.com/maillist.htm)

确保将其发布在您正在使用的产品的邮件列表中（Toad for Oracle、Toad for SQL Server、Toad for MySQL 等）

# javascript - 有没有在javascript中进行颜色循环的好方法？

> ID：480671
> 
> 赞同：4
> 
> 时间：2009-01-26T17:44:29.253
> 
> 标签：javascript, animation, colors

这就是我想做的事情：我在 HTML 页面中有一行文本。我想让那段文本以给定的颜色开始，循环通过光谱，等待一两秒钟，然后重复。

如果可能的话，我想在 javascript 中执行此操作（像 flash 之类的东西并不是完全不可能的，但会是这个项目的一些主要范围蔓延。）

我知道足够多的 JS 知道这是可能的，但仅此而已。谁能指出我正确的方向？

是的，这是一个真正的客户请求。我很高兴他们也没有要求闪烁标签。;)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T17:53:34.603

如果您想在光谱中循环，使用 HSB 颜色模型是您的最佳选择。

相关问题：

*   [颜色缩放功能](https://stackoverflow.com/questions/168838/color-scaling-function)
*   [为功率计生成红色和绿色之间的颜色？](https://stackoverflow.com/questions/340209/generate-color-for-a-power-meter-red-to-green)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T17:47:04.273

我会查看网络上的一些“褪色”javascript 示例，并修改它们以使用正确的颜色循环。这是来自网络的一个[示例](http://www.leigeber.com/2008/05/javascript-color-fading-script/)，您可能可以对其进行修改以不断循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T18:48:27.957

在浏览了一些“褪色”示例之后，我们最终使用了 jQuery 的 .animate() 函数和[这个颜色动画插件](http://plugins.jquery.com/project/color)。效果惊人。

# profiling - 是否有用于 Windows 脚本主机代码的 Profiler？

> ID：480674
> 
> 赞同：6
> 
> 时间：2009-01-26T17:45:11.127
> 
> 标签：profiling, wsh, windows-scripting

是否有任何分析器可以分析在 WSH（VBScript、JavaScript、WSF）下运行的代码？除了使用跟踪语句进行手动检测之外，还有什么好方法可以分析在 WSH 下运行的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T15:17:49.223

[AQTime](http://www.automatedqa.com/products/aqtime/script-profiling/)可以做到这一点。他们有免费试用版。

> 您可以使用 AQtime 分析由 Microsoft 脚本引擎执行的脚本。该引擎支持 VBScript 和 JScript 语言，并被 Internet Explorer、Windows Script Host 或 TestComplete 等应用程序使用。因此，您可以使用 AQtime 来分析在这些应用程序中执行的 VBScript 和 JScript 例程。例如，您可以分析驻留在网页上的脚本，也可以分析您的 TestComplete 项目的脚本。

# asp.net-mvc - 在没有管理员权限的情况下安装 ASP.Net MVC？

> ID：480677
> 
> 赞同：2
> 
> 时间：2009-01-26T17:46:25.070
> 
> 标签：asp.net-mvc, installation

不幸的是，我公司的 IT 政策不允许我对自己的机器拥有管理员权限。但是，我想开始工作 ASP.Net MVC；但安装程序不会安装没有管理员权限的框架。反正我可以手动安装MVC吗？就像在某处复制相关的 DLL 等。非常感谢任何建设性的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T18:09:22.013

您可以自己下载和编译 ASP.NET MVC - 或者将其作为引用项目包含在内，或者只是获取生成的二进制文件并将它们像任何其他 DLL 一样添加到您的项目中。

[在此页面](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18764)上查找指向 MVCBetaSource.zip 的链接- 这是使用 Visual Studio 进行的非常简单的构建，并且（如果我没记错的话）包括一些不属于的二进制文件（System.Web.Abstractions 和 System.Web.Routing） MVC 源本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T17:50:24.610

在预览版 3 或 4 中，ASP.Net MVC 变成了 binnable。我在我的解决方案中所做的是在解决方案的根目录中有一个“二进制引用”文件夹，并在每个需要它们的项目中引用这些本地文件。你应该复制：

1.  System.Web.Abstractions.dll
2.  System.Web.Mvc.dll
3.  System.Web.Routing.dll

完成后，参考这些程序集，事情应该可以正常工作。您面临的最大障碍是从 MSI 中提取它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T20:08:09.747

MVC 是 bin 可部署的，所以如果 .Net 3.5 与 SP1 一起安装，你应该很好。只需确保将 mvc dll 放入您的 bin 文件夹并进行部署即可。棘手的部分是 IIS6 中的通配符，IIS7 会自动执行此操作，但对于 6，您需要制定规则，祝您好运。

# c# - C#中构造函数的具体形式

> ID：480679
> 
> 赞同：4
> 
> 时间：2009-01-26T17:46:59.750
> 
> 标签：c#, visual-studio, constructor

我正在学习信息通信技术。我的一门课程是 C#，另一门是物理。我们的物理老师使用 Visual Studio 为一些动作制作动画，给了我们一些他用来做的代码。他告诉我们查一下。这是我不认识的东西：

```
public static Vector operator + (Vector v1, Vector v2)
{
    return new Vector(v1.X + v2.X, v1.Y + v2.Y, v1.Z + v2.Z);
} 
```

那应该是一个构造函数，但我以前从未见过这样的东西。我不知道它叫什么，所以我不知道用谷歌搜索什么。

有人可以启发我吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-26T17:49:44.533

这就是所谓的“运算符重载”。它不是构造函数，而是返回一个新的 Vector。

请参阅： [运算符重载](http://msdn.microsoft.com/en-us/library/aa288467(VS.71).aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T17:50:57.027

它不是构造函数。它是“+”运算符的运算符方法。它定义了当您执行以下操作时会发生什么：-

```
var Vector v1 = new Vector(1,2,3);
var Vector v2 = new Vector(1,2,3);
var Vector v3 = v1 + v2; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T17:49:43.940

他正在重载 Vector 类的“+”运算符。有关该主题的更多信息，请参见[此处](http://www.csharphelp.com/archives/archive135.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T17:49:49.837

这会重载 Vector 类的“+”运算符，因此无论何时执行“v1 + v2”，代码都会被执行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-26T17:50:20.240

这不是构造函数，而是 + 的运算符重载 这是您如何重载以下行为的方式：

```
Vector a = new Vector();
Vector b = new Vector();
Vector c = a + b; 
```

更多信息见[MSDN 文章](http://msdn.microsoft.com/en-us/library/aa288467(VS.71).aspx)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T17:52:06.057

线路：

公共静态向量运算符 + (Vector v1, Vector v2)

...不是构造函数。它只是为父类重载了 + (Plus) 运算符。我假设父类是一个细化的向量类？

该行：

返回新向量（v1.X + v2.X，v1.Y + v2.Y，v1.Z + v2.Z）；

...正在使用 Vector 类的构造函数来传递三个参数（X、Y 和 Z 看起来像）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T18:40:00.377

它是重载的 + 运算符。所有 OOP 语言（可能除了 Java，需要检查参考）都允许运算符重载。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-24T16:33:25.430

他确实重载了 + 运算符。

这是什么意思？很简单：

如果你有这个：

```
int i = 10;
int j = 20;
int x = i + j; 
```

在此示例中，x 将为 30，因为 C# 知道我们是否使用整数并使用 + 来获取总和。

但现在你正在使用向量。一个 3 维向量有 3 个值：X、Y 和 Z。如果你想要 2 个向量的总和，你是如何工作的？会不会像

```
v1.X + v2.Y and v1.Y + v2.Z and v1.Z + v2.X 
```

或者 C# 应该这样做：

```
v1.X + v1.Y and v1.Z + v2.X and v2.Y + v2.Z 
```

通过运算符重载，您可以定义在使用向量时应该如何实现 + 运算符。在我们的例子中是：

```
v1.X + v2.X and v1.Y + v2.Y and v1.Z + v2.Z 
```

没那么难；）

# asp.net - 当表单身份验证的用户未通过身份验证时要捕获的事件

> ID：480681
> 
> 赞同：3
> 
> 时间：2009-01-26T17:47:09.780
> 
> 标签：asp.net, forms-authentication

我基本上是在寻找与 FormsAuthentication_OnAuthenticate 相反的事件。当用户注销时，我想从数据库中删除一些值。我尝试将其放入 Session_End 事件中，但似乎在执行时用户已经离开了。

更新：如果我无法确定特定用户何时被取消身份验证（即，由于会话超时），那么有没有办法获取所有当前经过身份验证的用户的列表？如果可以，那么在 Session_End 中，我可以从数据库中删除与当前经过身份验证的用户无关的记录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T20:55:24.017

Session_End 不保证触发 - 例如，如果您不使用 InProc 会话，那么它根本不会触发。如果您的应用程序再次回收或死亡，它不会触发。

最好的办法是将此代码放在可以从许多地方调用的共享方法中：

1.  在您的[LoginStatus](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginstatus.aspx)控件中，您可以设置[LoggingOut](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginstatus.loggingout.aspx)事件 - 在那里调用您的方法来处理明智地注销的人。
2.  如果您在 Session_End 事件中使用 InProc 会话，但请确保检查它们是否已经注销（如您所见）。
3.  如果您不使用 InProc 会话，则需要更多创意。也许看看有一个不时触发的事件（可能在 Session_Start 上无论如何都会触发），该事件会通过并清除那些上次活动时间早于会话超时的用户（如 Greg 所述）。

不幸的是，[Membership 类](http://msdn.microsoft.com/en-us/library/system.web.security.membership_members.aspx)为您提供了一些有用的细节，但不是全部：

```
GetNumberOfUsersOnline 
```

这将“获取当前访问应用程序的用户数”。- 很棒，但唯一能吸引用户的方法：

```
GetAllUsers      // Gets all the users from the storage provider (can be paged)
FindUsersByName
FindUsersByEmail 
```

遗憾的是，这些都没有根据计数只返回“活跃用户”的属性。

查看 MembershipUser 的成员，没有“IsOnline”属性 - 只有 LastLogonDate 和 LastActivtyDate - 由于网络的断开连接性质，这可能与您将获得的一样好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T17:49:46.937

我想你让他们通过点击按钮或链接或类似的东西注销。为什么不把代码放在同一个事件/块中。在您放置 FormsAuthentication.SignOut() 调用的位置附近。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T18:11:52.927

Global.asax 中有一个 Session_End 处理程序，您可以在其中放置您想要在会话到期时执行的内容。

我不确定这是你想要的。会话和身份验证是两个不同的东西。如果您的身份验证技术正在向用户（在 cookie 中）提供 FormsAuthenticationTicket 并且该票证具有到期时间，那么身份验证的到期时间是通过该票证控制的。它不会在服务器上主动管理。提供用户发出票证的每个请求，然后服务器确定用户是否仍然通过身份验证。

底线是，您可以检测用户的会话何时到期，但您可能无法确定他们的身份验证何时到期，除非两个到期值相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T18:37:02.393

如果您使用 SQL 提供程序，aspnet_Users 表有一个“LastActivityDate”列。如果将其与表单身份验证的超时值进行比较，您可能会得出一个绝对未登录的用户列表。如果他们使用“注销”链接手动注销，您的计数会很低。

# java - 什么是最好的开源 Java 贝叶斯垃圾邮件过滤器库？

> ID：480683
> 
> 赞同：17
> 
> 时间：2009-01-26T17:47:41.230
> 
> 标签：java, machine-learning, spam-prevention, classification, bayesian

在 Stackoverflow 的其他答案中，有人建议 Weka 很好，但还有其他答案（[Classifier4j](http://classifier4j.sourceforge.net/)、[jBNC](http://jbnc.sourceforge.net/)、[Naiban](http://www.tempeststrings.com/naiban/)）。

有人对这些有实际经验吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T08:50:50.563

Weka 很棒，但[Classifier4J](http://classifier4j.sourceforge.net/)可能更接近你想要的，因为它更针对文本识别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-27T09:08:13.087

您还可以查看仍然非常新的[Apache Mahout](http://cwiki.apache.org/MAHOUT/index.html#index-Classification)项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T06:32:02.503

另一个新库是[ci-bayes](https://ci-bayes.dev.java.net/)，很好用而且非常简单。

免责声明：我已向该项目提交了补丁，目前是提交者

# latex - 有没有办法防止 LaTeX 将长脚注拆分到多个列/页？

> ID：480685
> 
> 赞同：30
> 
> 时间：2009-01-26T17:48:11.603
> 
> 标签：latex, footnotes

我正在使用 LaTeX，在某些情况下有多行脚注。

当我使用两列格式时，尤其是当列中对脚注的引用较低时，LaTeX 通常会将脚注分成两半：它从原始列开始，然后在另一列下继续（有时在另一页中） ，这很让人分心。

有没有办法强制 LaTeX 从不拆分脚注并为它们分配足够的空间？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-01-26T18:30:51.953

用于`\interfootnotelinepenalty=10000`完全禁止这一点。但是要为其他布局工件做好准备......将惩罚设置为低于 10000 将使 TeX 在决定何时副作用太严重而无法承受时给予一定的灵活性。

有关详细讨论，请参阅 TeX 常见问题解答项目[为什么 LaTeX 将脚注跨页拆分？](https://texfaq.org/FAQ-splitfoot)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T17:55:07.080

我发现最好从您尝试发布的地方获取样式表，并使用它们的格式（我假设您正在尝试在某处发布，如果您使用的是双列格式） . 然后，编辑可以处理古怪的脚注。如果是为了论文，我不知道你的委员会，但我的告诉我，一个单栏，双倍行距是要走的路，这应该首先避免你的问题。

# web-services - 未找到数据时，Web 服务是否应该返回异常或空结果？

> ID：480686
> 
> 赞同：2
> 
> 时间：2009-01-26T17:48:27.937
> 
> 标签：web-services

未找到数据时，Web 服务是否应该返回异常或空结果？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T17:50:22.987

如果没有数据是正常且可接受的结果（通常情况下），它应该返回一个空结果集。如果发生错误/异常，您应该只返回异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T18:06:28.697

常规 .net 异常是一个特定于平台的构造，不应在 Web 服务之外返回，因为调用该服务的客户端可能不会实现这样的事情，而是在异常情况下使用 SoapException

调用 Web 服务的客户端可以从中恢复空结果集吗？如果是这样，我不会返回 SoapException。如果它非常特殊以至于需要特殊的处理逻辑，那么一定要使用 SoapException。

有资源可能会帮助你

*   [http://msdn.microsoft.com/en-us/library/ds492xtk(VS.71).aspx](http://msdn.microsoft.com/en-us/library/ds492xtk(VS.71).aspx)
*   [http://www.developer.com/net/csharp/article.php/10918_3088231_1](http://www.developer.com/net/csharp/article.php/10918_3088231_1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T17:51:03.453

描述问题的错误消息怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T17:58:38.523

这完全取决于问题的领域。如果永远不会有时间找不到结果，那就是错误。如果没有结果是可接受的条件，那么空结果集就可以了。这仅取决于具体问题。作为使用网络服务的人，这是我所期望的。错误就是问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T20:50:38.753

谢谢大家的回复。您的回答都是常识，并且在我的想法中。但是，我们的应用程序架构师有其他想法。现在，返回的异常将从 sql 异常更改为信息量更大的异常。我们已经同意，只有在关系表中不存在参数时才可以接受空结果，但如果值根本不在值表中，则会导致异常。

感谢大家成为今天的主题专家！

# c# - 如何查找本机 DLL 文件是编译为 x64 还是 x86？

> ID：480696
> 
> 赞同：142
> 
> 时间：2009-01-26T17:50:30.710
> 
> 标签：c#, .net, winapi, 64-bit, x86-64

我想确定本机程序集是从托管代码应用程序 ( [C#](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29) ) 编译为 x64 还是 x86。

我认为它必须在 PE 标头中的某个位置，因为 OS 加载程序需要知道此信息，但我找不到它。当然，我更喜欢在托管代码中执行此操作，但如果有必要，我可以使用本机 C++。

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2010-10-10T09:26:20.863

您也可以使用[DUMPBIN](http://msdn.microsoft.com/en-us/library/c1h23y6c%28v=vs.71%29.aspx)。使用`/headers`or`/all`标志及其列出的第一个文件头。

```
dumpbin /headers cv210.dll 
```

### 64 位

```
Microsoft (R) COFF/PE Dumper Version 10.00.30319.01
Copyright (C) Microsoft Corporation.  All rights reserved.

Dump of file cv210.dll

PE signature found

File Type: DLL

FILE HEADER VALUES
            8664 machine (x64)
               6 number of sections
        4BBAB813 time date stamp Tue Apr 06 12:26:59 2010
               0 file pointer to symbol table
               0 number of symbols
              F0 size of optional header
            2022 characteristics
                   Executable
                   Application can handle large (>2GB) addresses
                   DLL 
```

### 32 位

```
Microsoft (R) COFF/PE Dumper Version 10.00.30319.01
Copyright (C) Microsoft Corporation.  All rights reserved.

Dump of file acrdlg.dll

PE signature found

File Type: DLL

FILE HEADER VALUES
             14C machine (x86)
               5 number of sections
        467AFDD2 time date stamp Fri Jun 22 06:38:10 2007
               0 file pointer to symbol table
               0 number of symbols
              E0 size of optional header
            2306 characteristics
                   Executable
                   Line numbers stripped
                   32 bit word machine
                   Debug information stripped
                   DLL 
```

'find' 可以让生活稍微轻松一些：

```
dumpbin /headers cv210.dll |find "machine"
        8664 machine (x64) 
```

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2010-03-10T15:51:25.563

[使用CorFlags](http://msdn.microsoft.com/en-us/library/ms164699%28VS.80%29.aspx)有一种简单的方法可以做到这一点。打开 Visual Studio 命令提示符并键入“corflags [您的程序集]”。你会得到这样的东西：

> c:\Program Files (x86)\Microsoft Visual Studio 9.0\VC>corflags "C:\Windows\Microsoft.NET\Framework\v2.0.50727\System.Data.dll"
> 
> Microsoft (R) .NET Framework CorFlags 转换工具。版本 3.5.21022.8 版权所有 (c) Microsoft Corporation。版权所有。
> 
> 版本：v2.0.50727 CLR 标头：2.5 PE：PE32 CorFlags：24 ILONLY：0 32BIT：0 签名：1

您正在专门研究 PE 和 32BIT。

*   *任何 CPU*：

    PE：PE32
    32BIT：0

*   *x86*：

    PE：PE32
    32BIT：1

*   x64:

    PE：PE32+
    32BIT：0

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2016-12-29T16:03:05.840

这个[技巧](https://superuser.com/questions/358434/how-to-check-if-a-binary-is-32-or-64-bit-on-windows)有效，只需要记事本。

使用文本编辑器（如记事本）打开 dll 文件并找到第一次出现的字符串`PE`. 以下字符定义 dll 是 32 位还是 64 位。

## 32 位：

```
PE  L 
```

## 64 位：

```
PE  d† 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2012-03-20T08:33:14.017

`Magic`字段（尽管 Windows 可执行映像（DLL/EXE 文件）中的`IMAGE_OPTIONAL_HEADER`标头没有任何可选内容）将告诉您 PE 的体系结构。

这是从文件中获取架构的示例。

```
public static ushort GetImageArchitecture(string filepath) {
    using (var stream = new System.IO.FileStream(filepath, System.IO.FileMode.Open, System.IO.FileAccess.Read))
    using (var reader = new System.IO.BinaryReader(stream)) {
        //check the MZ signature to ensure it's a valid Portable Executable image
        if (reader.ReadUInt16() != 23117) 
            throw new BadImageFormatException("Not a valid Portable Executable image", filepath);

        // seek to, and read, e_lfanew then advance the stream to there (start of NT header)
        stream.Seek(0x3A, System.IO.SeekOrigin.Current); 
        stream.Seek(reader.ReadUInt32(), System.IO.SeekOrigin.Begin);

        // Ensure the NT header is valid by checking the "PE\0\0" signature
        if (reader.ReadUInt32() != 17744)
            throw new BadImageFormatException("Not a valid Portable Executable image", filepath);

        // seek past the file header, then read the magic number from the optional header
        stream.Seek(20, System.IO.SeekOrigin.Current); 
        return reader.ReadUInt16();
    }
} 
```

目前仅有的两个架构常量是：

```
0x10b - PE32
0x20b - PE32+ 
```

干杯

**更新** 自从我发布这个答案已经有一段时间了，但我仍然看到它不时地得到一些支持，所以我认为它值得更新。我写了一种方法来获取`Portable Executable`图像的体系结构，它还检查它是否被编译为`AnyCPU`. 不幸的是，答案在 C++ 中，但如果您有几分钟的时间在`WinNT.h`. 如果人们有兴趣，我会用 C# 编写一个端口，但除非人们真的想要它，否则我不会花太多时间来强调它。

```
#include <Windows.h>

#define MKPTR(p1,p2) ((DWORD_PTR)(p1) + (DWORD_PTR)(p2))

typedef enum _pe_architecture {
    PE_ARCHITECTURE_UNKNOWN = 0x0000,
    PE_ARCHITECTURE_ANYCPU  = 0x0001,
    PE_ARCHITECTURE_X86     = 0x010B,
    PE_ARCHITECTURE_x64     = 0x020B
} PE_ARCHITECTURE;

LPVOID GetOffsetFromRva(IMAGE_DOS_HEADER *pDos, IMAGE_NT_HEADERS *pNt, DWORD rva) {
    IMAGE_SECTION_HEADER *pSecHd = IMAGE_FIRST_SECTION(pNt);
    for(unsigned long i = 0; i < pNt->FileHeader.NumberOfSections; ++i, ++pSecHd) {
        // Lookup which section contains this RVA so we can translate the VA to a file offset
        if (rva >= pSecHd->VirtualAddress && rva < (pSecHd->VirtualAddress + pSecHd->Misc.VirtualSize)) {
            DWORD delta = pSecHd->VirtualAddress - pSecHd->PointerToRawData;
            return (LPVOID)MKPTR(pDos, rva - delta);
        }
    }
    return NULL;
}

PE_ARCHITECTURE GetImageArchitecture(void *pImageBase) {
    // Parse and validate the DOS header
    IMAGE_DOS_HEADER *pDosHd = (IMAGE_DOS_HEADER*)pImageBase;
    if (IsBadReadPtr(pDosHd, sizeof(pDosHd->e_magic)) || pDosHd->e_magic != IMAGE_DOS_SIGNATURE)
        return PE_ARCHITECTURE_UNKNOWN;

    // Parse and validate the NT header
    IMAGE_NT_HEADERS *pNtHd = (IMAGE_NT_HEADERS*)MKPTR(pDosHd, pDosHd->e_lfanew);
    if (IsBadReadPtr(pNtHd, sizeof(pNtHd->Signature)) || pNtHd->Signature != IMAGE_NT_SIGNATURE)
        return PE_ARCHITECTURE_UNKNOWN;

    // First, naive, check based on the 'Magic' number in the Optional Header.
    PE_ARCHITECTURE architecture = (PE_ARCHITECTURE)pNtHd->OptionalHeader.Magic;

    // If the architecture is x86, there is still a possibility that the image is 'AnyCPU'
    if (architecture == PE_ARCHITECTURE_X86) {
        IMAGE_DATA_DIRECTORY comDirectory = pNtHd->OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR];
        if (comDirectory.Size) {
            IMAGE_COR20_HEADER *pClrHd = (IMAGE_COR20_HEADER*)GetOffsetFromRva(pDosHd, pNtHd, comDirectory.VirtualAddress);
            // Check to see if the CLR header contains the 32BITONLY flag, if not then the image is actually AnyCpu
            if ((pClrHd->Flags & COMIMAGE_FLAGS_32BITREQUIRED) == 0)
                architecture = PE_ARCHITECTURE_ANYCPU;
        }
    }

    return architecture;
} 
```

该函数接受一个指向内存中 PE 映像的指针（因此您可以选择如何获取它们的毒药；内存映射或将整个内容读入内存......无论如何）。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-01-26T18:15:35.307

对于非托管 DLL 文件，您需要先检查它是否是 16 位 DLL 文件（希望不是）。然后检查`IMAGE\_FILE_HEADER.Machine`字段。

[其他人](http://www.tech-archive.net/Archive/Development/microsoft.public.win32.programmer.tools/2006-12/msg00011.html)已经花时间解决了这个问题，所以我在这里重复一下：

> 要区分 32 位和 64 位 PE 文件，您应该检查 IMAGE_FILE_HEADER.Machine 字段。根据下面的 Microsoft PE 和 COFF 规范，我列出了该字段的所有可能值：http: [//download.microsoft.com/download/9/c/5/9c5b2167-8017-4bae-9fde-d599bac8184a/ pecoff_v8.doc](http://download.microsoft.com/download/9/c/5/9c5b2167-8017-4bae-9fde-d599bac8184a/pecoff_v8.doc)
> 
> IMAGE_FILE_MACHINE_UNKNOWN 0x0 该字段的内容假定适用于任何机器类型
> 
> IMAGE_FILE_MACHINE_AM33 0x1d3 松下 AM33
> 
> IMAGE_FILE_MACHINE_AMD64 0x8664 x64
> 
> IMAGE_FILE_MACHINE_ARM 0x1c0 ARM 小端
> 
> IMAGE_FILE_MACHINE_EBC 0xebc EFI 字节码
> 
> IMAGE_FILE_MACHINE_I386 0x14c Intel 386 或更高版本的处理器和兼容的处理器
> 
> IMAGE_FILE_MACHINE_IA64 0x200 Intel Itanium 处理器系列
> 
> IMAGE_FILE_MACHINE_M32R 0x9041 三菱 M32R 小端
> 
> IMAGE_FILE_MACHINE_MIPS16 0x266 MIPS16
> 
> IMAGE_FILE_MACHINE_MIPSFPU 0x366 MIPS 与 FPU
> 
> IMAGE_FILE_MACHINE_MIPSFPU16 0x466 MIPS16 with FPU
> 
> IMAGE_FILE_MACHINE_POWERPC 0x1f0 电源 PC 小端
> 
> IMAGE_FILE_MACHINE_POWERPCFP 0x1f1 支持浮点的Power PC
> 
> IMAGE_FILE_MACHINE_R4000 0x166 MIPS 小端
> 
> IMAGE_FILE_MACHINE_SH3 0x1a2 日立 SH3
> 
> IMAGE_FILE_MACHINE_SH3DSP 0x1a3 日立 SH3 DSP
> 
> IMAGE_FILE_MACHINE_SH4 0x1a6 日立 SH4
> 
> IMAGE_FILE_MACHINE_SH5 0x1a8 日立 SH5
> 
> IMAGE_FILE_MACHINE_THUMB 0x1c2 拇指
> 
> IMAGE_FILE_MACHINE_WCEMIPSV2 0x169 MIPS little-endian WCE v2
> 
> 是的，您可以检查 IMAGE_FILE_MACHINE_AMD64|IMAGE_FILE_MACHINE_IA64 为 64 位和 IMAGE_FILE_MACHINE_I386 为 32 位。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-16T16:52:57.827

您可以在此处找到解决方案的C #[示例实现](https://stackoverflow.com/questions/1001404/check-if-unmanaged-dll-is-32-bit-or-64-bit/1002672#1002672)`IMAGE_FILE_HEADER`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-26T18:00:34.107

64 位二进制文​​件以 PE32+ 格式存储。尝试阅读[http://www.masm32.com/board/index.php?action=dlattach;topic=6687.0;id=3486](http://www.masm32.com/board/index.php?action=dlattach;topic=6687.0;id=3486)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-08-05T09:48:17.967

使用十六进制编辑器打开 dll，例如[HxD](http://mh-nexus.de/en/hxd/)

如果第 9 行有“dt”，则为 64 位。

如果有“L”。第 9 行是 32 位。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-11-22T10:52:19.143

我在 powershell 脚本的第一个答案中重写了[c++ 解决方案。](https://stackoverflow.com/a/9783522/2531187)脚本可以确定这种类型的 .exe 和 .dll 文件：

```
#Description       C# compiler switch             PE type       machine corflags
#MSIL              /platform:anycpu (default)     PE32  x86     ILONLY
#MSIL 32 bit pref  /platform:anycpu32bitpreferred PE32  x86     ILONLY | 32BITREQUIRED | 32BITPREFERRED
#x86 managed       /platform:x86                  PE32  x86     ILONLY | 32BITREQUIRED
#x86 mixed         n/a                            PE32  x86     32BITREQUIRED
#x64 managed       /platform:x64                  PE32+ x64     ILONLY
#x64 mixed         n/a                            PE32+ x64  
#ARM managed       /platform:arm                  PE32  ARM     ILONLY
#ARM mixed         n/a                            PE32  ARM 
```

此解决方案比 corflags.exe 和通过 C# 中的 Assembly.Load 加载程序集具有一些优势 - 您永远不会收到 BadImageFormatException 或有关无效标头的消息。

```
function GetActualAddressFromRVA($st, $sec, $numOfSec, $dwRVA)
{
    [System.UInt32] $dwRet = 0;
    for($j = 0; $j -lt $numOfSec; $j++)   
    {   
        $nextSectionOffset = $sec + 40*$j;
        $VirtualSizeOffset = 8;
        $VirtualAddressOffset = 12;
        $SizeOfRawDataOffset = 16;
        $PointerToRawDataOffset = 20;

    $Null = @(
        $curr_offset = $st.BaseStream.Seek($nextSectionOffset + $VirtualSizeOffset, [System.IO.SeekOrigin]::Begin);        
        [System.UInt32] $VirtualSize = $b.ReadUInt32();
        [System.UInt32] $VirtualAddress = $b.ReadUInt32();
        [System.UInt32] $SizeOfRawData = $b.ReadUInt32();
        [System.UInt32] $PointerToRawData = $b.ReadUInt32();        

        if ($dwRVA -ge $VirtualAddress -and $dwRVA -lt ($VirtualAddress + $VirtualSize)) {
            $delta = $VirtualAddress - $PointerToRawData;
            $dwRet = $dwRVA - $delta;
            return $dwRet;
        }
        );
    }
    return $dwRet;
}

function Get-Bitness2([System.String]$path, $showLog = $false)
{
    $Obj = @{};
    $Obj.Result = '';
    $Obj.Error = $false;

    $Obj.Log = @(Split-Path -Path $path -Leaf -Resolve);

    $b = new-object System.IO.BinaryReader([System.IO.File]::Open($path,[System.IO.FileMode]::Open,[System.IO.FileAccess]::Read, [System.IO.FileShare]::Read));
    $curr_offset = $b.BaseStream.Seek(0x3c, [System.IO.SeekOrigin]::Begin)
    [System.Int32] $peOffset = $b.ReadInt32();
    $Obj.Log += 'peOffset ' + "{0:X0}" -f $peOffset;

    $curr_offset = $b.BaseStream.Seek($peOffset, [System.IO.SeekOrigin]::Begin);
    [System.UInt32] $peHead = $b.ReadUInt32();

    if ($peHead -ne 0x00004550) {
        $Obj.Error = $true;
        $Obj.Result = 'Bad Image Format';
        $Obj.Log += 'cannot determine file type (not x64/x86/ARM) - exit with error';
    };

    if ($Obj.Error)
    {
        $b.Close();
        Write-Host ($Obj.Log | Format-List | Out-String);
        return $false;
    };

    [System.UInt16] $machineType = $b.ReadUInt16();
    $Obj.Log += 'machineType ' + "{0:X0}" -f $machineType;

    [System.UInt16] $numOfSections = $b.ReadUInt16();
    $Obj.Log += 'numOfSections ' + "{0:X0}" -f $numOfSections;
    if (($machineType -eq 0x8664) -or ($machineType -eq 0x200)) { $Obj.Log += 'machineType: x64'; }
    elseif ($machineType -eq 0x14c)                             { $Obj.Log += 'machineType: x86'; }
    elseif ($machineType -eq 0x1c0)                             { $Obj.Log += 'machineType: ARM'; }
    else{
        $Obj.Error = $true;
        $Obj.Log += 'cannot determine file type (not x64/x86/ARM) - exit with error';
    };

    if ($Obj.Error) {
        $b.Close();
        Write-Output ($Obj.Log | Format-List | Out-String);
        return $false;
    };

    $curr_offset = $b.BaseStream.Seek($peOffset+20, [System.IO.SeekOrigin]::Begin);
    [System.UInt16] $sizeOfPeHeader = $b.ReadUInt16();

    $coffOffset = $peOffset + 24;#PE header size is 24 bytes
    $Obj.Log += 'coffOffset ' + "{0:X0}" -f $coffOffset;

    $curr_offset = $b.BaseStream.Seek($coffOffset, [System.IO.SeekOrigin]::Begin);#+24 byte magic number
    [System.UInt16] $pe32 = $b.ReadUInt16();         
    $clr20headerOffset = 0;
    $flag32bit = $false;
    $Obj.Log += 'pe32 magic number: ' + "{0:X0}" -f $pe32;
    $Obj.Log += 'size of optional header ' + ("{0:D0}" -f $sizeOfPeHeader) + " bytes";

    #COMIMAGE_FLAGS_ILONLY               =0x00000001,
    #COMIMAGE_FLAGS_32BITREQUIRED        =0x00000002,
    #COMIMAGE_FLAGS_IL_LIBRARY           =0x00000004,
    #COMIMAGE_FLAGS_STRONGNAMESIGNED     =0x00000008,
    #COMIMAGE_FLAGS_NATIVE_ENTRYPOINT    =0x00000010,
    #COMIMAGE_FLAGS_TRACKDEBUGDATA       =0x00010000,
    #COMIMAGE_FLAGS_32BITPREFERRED       =0x00020000,

    $COMIMAGE_FLAGS_ILONLY        = 0x00000001;
    $COMIMAGE_FLAGS_32BITREQUIRED = 0x00000002;
    $COMIMAGE_FLAGS_32BITPREFERRED = 0x00020000;

    $offset = 96;
    if ($pe32 -eq 0x20b) {
        $offset = 112;#size of COFF header is bigger for pe32+
    }     

    $clr20dirHeaderOffset = $coffOffset + $offset + 14*8;#clr directory header offset + start of section number 15 (each section is 8 byte long);
    $Obj.Log += 'clr20dirHeaderOffset ' + "{0:X0}" -f $clr20dirHeaderOffset;
    $curr_offset = $b.BaseStream.Seek($clr20dirHeaderOffset, [System.IO.SeekOrigin]::Begin);
    [System.UInt32] $clr20VirtualAddress = $b.ReadUInt32();
    [System.UInt32] $clr20Size = $b.ReadUInt32();
    $Obj.Log += 'clr20VirtualAddress ' + "{0:X0}" -f $clr20VirtualAddress;
    $Obj.Log += 'clr20SectionSize ' + ("{0:D0}" -f $clr20Size) + " bytes";

    if ($clr20Size -eq 0) {
        if ($machineType -eq 0x1c0) { $Obj.Result = 'ARM native'; }
        elseif ($pe32 -eq 0x10b)    { $Obj.Result = '32-bit native'; }
        elseif($pe32 -eq 0x20b)     { $Obj.Result = '64-bit native'; }

       $b.Close();   
       if ($Obj.Result -eq '') { 
            $Obj.Error = $true;
            $Obj.Log += 'Unknown type of file';
       }
       else { 
            if ($showLog) { Write-Output ($Obj.Log | Format-List | Out-String); };
            return $Obj.Result;
       }
    };

    if ($Obj.Error) {
        $b.Close();
        Write-Host ($Obj.Log | Format-List | Out-String);
        return $false;
    };

    [System.UInt32]$sectionsOffset = $coffOffset + $sizeOfPeHeader;
    $Obj.Log += 'sectionsOffset ' + "{0:X0}" -f $sectionsOffset;
    $realOffset = GetActualAddressFromRVA $b $sectionsOffset $numOfSections $clr20VirtualAddress;
    $Obj.Log += 'real IMAGE_COR20_HEADER offset ' + "{0:X0}" -f $realOffset;
    if ($realOffset -eq 0) {
        $Obj.Error = $true;
        $Obj.Log += 'cannot find COR20 header - exit with error';
        $b.Close();
        return $false;
    };

    if ($Obj.Error) {
        $b.Close();
        Write-Host ($Obj.Log | Format-List | Out-String);
        return $false;
    };

    $curr_offset = $b.BaseStream.Seek($realOffset + 4, [System.IO.SeekOrigin]::Begin);
    [System.UInt16] $majorVer = $b.ReadUInt16();
    [System.UInt16] $minorVer = $b.ReadUInt16();
    $Obj.Log += 'IMAGE_COR20_HEADER version ' + ("{0:D0}" -f $majorVer) + "." + ("{0:D0}" -f $minorVer);

    $flagsOffset = 16;#+16 bytes - flags field
    $curr_offset = $b.BaseStream.Seek($realOffset + $flagsOffset, [System.IO.SeekOrigin]::Begin);
    [System.UInt32] $flag32bit = $b.ReadUInt32();
    $Obj.Log += 'CorFlags: ' + ("{0:X0}" -f $flag32bit);

#Description       C# compiler switch             PE type       machine corflags
#MSIL              /platform:anycpu (default)     PE32  x86     ILONLY
#MSIL 32 bit pref  /platform:anycpu32bitpreferred PE32  x86     ILONLY | 32BITREQUIRED | 32BITPREFERRED
#x86 managed       /platform:x86                  PE32  x86     ILONLY | 32BITREQUIRED
#x86 mixed         n/a                            PE32  x86     32BITREQUIRED
#x64 managed       /platform:x64                  PE32+ x64     ILONLY
#x64 mixed         n/a                            PE32+ x64  
#ARM managed       /platform:arm                  PE32  ARM     ILONLY
#ARM mixed         n/a                            PE32  ARM  

    $isILOnly = ($flag32bit -band $COMIMAGE_FLAGS_ILONLY) -eq $COMIMAGE_FLAGS_ILONLY;
    $Obj.Log += 'ILONLY: ' + $isILOnly;
    if ($machineType -eq 0x1c0) {#if ARM
        if ($isILOnly) { $Obj.Result = 'ARM managed'; } 
                  else { $Obj.Result = 'ARM mixed'; }
    }
    elseif ($pe32 -eq 0x10b) {#pe32
        $is32bitRequired = ($flag32bit -band $COMIMAGE_FLAGS_32BITREQUIRED) -eq $COMIMAGE_FLAGS_32BITREQUIRED;
        $is32bitPreffered = ($flag32bit -band $COMIMAGE_FLAGS_32BITPREFERRED) -eq $COMIMAGE_FLAGS_32BITPREFERRED;
        $Obj.Log += '32BIT: ' + $is32bitRequired;    
        $Obj.Log += '32BIT PREFFERED: ' + $is32bitPreffered 
        if     ($is32bitRequired  -and $isILOnly  -and $is32bitPreffered) { $Obj.Result = 'AnyCpu 32bit-preffered'; }
        elseif ($is32bitRequired  -and $isILOnly  -and !$is32bitPreffered){ $Obj.Result = 'x86 managed'; }
        elseif (!$is32bitRequired -and !$isILOnly -and $is32bitPreffered) { $Obj.Result = 'x86 mixed'; }
        elseif ($isILOnly)                                                { $Obj.Result = 'AnyCpu'; }
   }
   elseif ($pe32 -eq 0x20b) {#pe32+
        if ($isILOnly) { $Obj.Result = 'x64 managed'; } 
                  else { $Obj.Result = 'x64 mixed'; }
   }

   $b.Close();   
   if ($showLog) { Write-Host ($Obj.Log | Format-List | Out-String); }
   if ($Obj.Result -eq ''){ return 'Unknown type of file';};
   $flags = '';
   if ($isILOnly) {$flags += 'ILONLY';}
   if ($is32bitRequired) {
        if ($flags -ne '') {$flags += ' | ';}
        $flags += '32BITREQUIRED';
   }
   if ($is32bitPreffered) {
        if ($flags -ne '') {$flags += ' | ';}
        $flags += '32BITPREFERRED';
   }
   if ($flags -ne '') {$flags = ' (' + $flags +')';}
   return $Obj.Result + $flags;
} 
```

用法示例：

```
#$filePath = "C:\Windows\SysWOW64\regedit.exe";#32 bit native on 64bit windows
$filePath = "C:\Windows\regedit.exe";#64 bit native on 64bit windows | should be 32 bit native on 32bit windows

Get-Bitness2 $filePath $true; 
```

如果您不需要查看详细信息，可以省略第二个参数

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-12-05T08:21:24.557

此处描述了一种快速且可能很脏的方法：[https](https://superuser.com/a/889267) ://superuser.com/a/889267 。您在编辑器中打开 DLL 并检查“PE”序列之后的第一个字符。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-04-16T08:16:32.360

由于第三方工具总是安装在`%Program files (x86)%`（即使是 x64 安装！）并且需要适当的 x32|x64 fortran 运行时才能正确运行，所以我将[c++](https://stackoverflow.com/a/9783522/684399)和[powershell](https://stackoverflow.com/a/40739935/684399)`%path%`解决方案收集到 matlab 中以返回：

*   **种类**：`Executable|Library|Other`
*   **代码类型**：`Native|Mixed|Managed`
*   **平台**：`x32|x64|AnyCpu|x32Preferred|Other`

一旦在内存中有原始的 PE 结构，它应该很容易适应其他语言。

```
function [simplifiedInfo] = GetPortableExecutableSimplifiedInfo(filename)
%[
    % Checking arguments
    if (nargin <1), error('MATLAB:minrhs', 'Not enough input argments.'); end

    % Initializing simplified info    
    simplifiedInfo.Kind = 'Other';
    simplifiedInfo.CodeType = 'Other';
    simplifiedInfo.Platform = 'Other';

    % Obtaining raw info
    [rawInfo, PEConstants] = GetPortableExecutableRawInfo(filename);

    % Determining 'Kind' of PE
    if (isfield(rawInfo, 'PEOptionalHeader') && (rawInfo.COFFHeader.Characteristics.IMAGE_FILE_EXECUTABLE_IMAGE))
        if (rawInfo.COFFHeader.Characteristics.IMAGE_FILE_DLL)
            simplifiedInfo.Kind = 'Library';
        else
            simplifiedInfo.Kind = 'Executable';
        end
    else
        % No optional header or no IMAGE_FILE_EXECUTABLE_IMAGE flag ... 
        % Maybe just .obj or other thing
        simplifiedInfo.Kind = 'Other';
    end

    % Determining 'CodeType'
    % NB: 'COR20Header' is present for MSIL code, but not for native code
    if (isfield(rawInfo, 'COR20Header'))
        if (rawInfo.COR20Header.Flags.COMIMAGE_FLAGS_ILONLY)
            simplifiedInfo.CodeType = 'Managed';
        else
            simplifiedInfo.CodeType = 'Mixed';
        end
    else
        simplifiedInfo.CodeType = 'Native';
    end

    % Determining platform
    if (rawInfo.COFFHeader.Machine == PEConstants.IMAGE_FILE_MACHINE_AMD64)
        simplifiedInfo.Platform = 'x64';
    elseif (rawInfo.COFFHeader.Machine == PEConstants.IMAGE_FILE_MACHINE_I386)
        if (isfield(rawInfo, 'COR20Header'))
            % PE contains MSIL code, need more checks
            if (rawInfo.COR20Header.Flags.COMIMAGE_FLAGS_32BITREQUIRED)
                if (rawInfo.COR20Header.Flags.COMIMAGE_FLAGS_32BITPREFERRED)
                    simplifiedInfo.Platform = 'x32Preferred';
                else
                    simplifiedInfo.Platform = 'x32';
                end
            else
                simplifiedInfo.Platform = 'AnyCpu';
            end
        else
            % This is native code so ...
            simplifiedInfo.Platform = 'x32';
        end
    else
        % ARM, ...
        simplifiedInfo.Platform = 'Other';
    end
%]
end 
```

内部函数的源代码`GetPortableExecutableRawInfo`可以在[这里](https://gist.github.com/CitizenInsane/079849d25d982239ba13dbbdeec8ce93)获得。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-26T17:59:10.067

显然，您可以在可移植可执行文件的标头中找到它。corflags.exe 实用程序能够显示它是否针对 x64。希望这可以帮助您找到有关它的更多信息。

# date - 如何处理不同时区的日期和时间？

> ID：480713
> 
> 赞同：8
> 
> 时间：2009-01-26T17:55:11.340
> 
> 标签：date, localization, time, internationalization

我正在开发一个作为简单项目管理软件的国际软件，但我遇到了一个问题。这个问题与日期/小时和时区有关。
当消息从一个时区发送到另一个时区时，我可以将 UTC (GMT) 时间存储在我的数据库中，然后根据用户的时区以不同方式显示。但是当我只使用日期时，这是无法做到的。
如果我说任务是在 3 月 21 日到期。我应该考虑这个日期在其他一些国家可能是 20 或 22 吗？你对这个问题有什么建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-26T18:13:31.847

假设纽约的用户将项目的截止日期设置为“1 月 26 日星期一的任何时间”。这意味着“从 1 月 26 日星期一 0600 到 1 月 27 日星期二 0600 的任何时间”在布鲁塞尔和“从 2000 年 1 月 25 日星期日到 2000 年 1 月 26 日星期一的任何时间”在洛杉矶

因此，在 26 日星期一 2100 完成任务在布鲁塞尔和纽约都很好，但在洛杉矶为时已晚

一种可能的解决方法是永远不要只使用日期。如果未指定时间，请将其设置为用户时区中指定日期的 0000 小时或 2400 小时。

用户可能不得不处理奇怪的截止日期/时间，但作为曾经在国际上工作的人来说，这有点与领土有关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T17:57:01.100

如果不存储确切的时间，您将无法实现您想要做的事情。你根本没有足够的信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T17:58:25.950

当您没有时间时，假设该时间是应用程序主要语言环境中业务的结束时间，然后像其他任何时间一样转换该时间。另一种方法是假设当地时间工作日结束并将其调整为 UTC。使用该应用程序的每个人都需要了解您在未指定时间时所做的任何默认时间假设。在大型企业中，与总部协调可能是最好的，而在本地环境同样重要的高度分散的环境中，与本地时间协调可能是最好的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T04:12:56.780

如果您不存储分钟和秒，则必须假设输入的日期是所需的日期，而不是对 GMT 进行任何调整。只需将其按原样放入数据库即可。无论您身在何处，西海岸的人们都必须假设到期日是相同的。如果要调整时区，则必须收集更多信息，例如小时、分钟和秒。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T18:01:19.003

最简单的解决方案就是为每个人显示相同的日期。然后，最后期限实际上将是最新时区的午夜。

否则，决定截止日期的默认时间应该在创建任务的时区中，例如 3 月 21 日 17:00 EST 或 3 月 22 日 00:00 EST 并在本地时区显示。然后，时区差异将相应地将其推到前一天或第二天以供查看者使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T19:22:05.157

SQL 2008 允许使用没有任何时间值与之关联的 Date 数据类型。这允许有人说我需要在这个日期之前完成，但我不在乎它是否是 +/- 几个小时。如果选择的日期是 2009 年 1 月 1 日，但它发生在 2009 年 1 月 2 日凌晨 2 点，他们可能不在乎。

当用户需要在特定日期和时间完成某些事情时，例如 2009 年 1 月 1 日营业结束，那么您需要将其作为 UTC 存储在 DateTime 中并将其转换为本地时间客户端。

这将大大减少指示何时完成的复杂性，它将在特定日期附近或特定时间完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T18:14:26.650

如果您有一个数据库实例，我会将所有日期存储在您的数据库服务器的日期时间时间戳中。如果您要为行添加时间戳，请考虑 T-SQL 中的 GetDate() 或作为时间戳日期列的默认值。然后，您始终拥有唯一的参考点。考虑那里的UTC格式。

然后，所有访问日期的客户端都会自行转换为“本地时间”，这可以通过以下内容来解释：用户偏好、客户端计算机上的日期时间戳等。

在不了解更多信息的情况下，很难准确地说出分辨率是什么。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T04:24:10.300

您的解决方案取决于您的应用和要求。

我首先将 UTC + 偏移量存储在您的数据结构中，因此很容易显示任何时区。

如果一项任务或会议最有可能在 3 月 21 日下午 12 点在伦敦到期，那么它将在 3 月 21 日的 2130 点在阿德莱德 (+0930) 发生，但这是一项申请要求，而不是任何险恶的时区相关标准。

如果您想要最大的灵活性，请添加一个标志，该标志可以在每个时区同时或同时到期，无论您身在何处（交错）并相应地显示事件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-30T04:49:35.847

您可能希望将日期存储在可识别时区的 from 中。这将帮助您进行计算。例如，SQL Server 2008 支持[datetimeoffset 正是这样做](http://msdn.microsoft.com/en-us/library/system.datetimeoffset.aspx)的。或者，如果您在使用 SQL 2005 时付出了一些努力，您可以编写自己的 SQL CLR 数据类型来支持这一点。

# regex - 如何正确匹配正则表达式？

> ID：480717
> 
> 赞同：8
> 
> 时间：2009-01-26T17:56:27.453
> 
> 标签：regex, sed, pattern-matching

我有一个`ldapsearch`如下输出的对象列表：

```
dn: cn=HPOTTER,ou=STUDENTS,ou=HOGWARTS,o=SCHOOL
dn: cn=HGRANGER,ou=STUDENTS,ou=HOGWARTS,o=SCHOOL
dn: cn=RWEASLEY,ou=STUDENTS,ou=HOGWARTS,o=SCHOOL
dn: cn=DMALFOY,ou=STUDENTS,ou=HOGWARTS,o=SCHOOL
dn: cn=SSNAPE,ou=FACULTY,ou=HOGWARTS,o=SCHOOL
dn: cn=ADUMBLED,ou=FACULTY,ou=HOGWARTS,o=SCHOOL 
```

* * *

到目前为止，我有以下正则表达式：

```
/\bcn=\w*,/g 
```

它返回如下结果：

```
cn=HPOTTER,
cn=HGRANGER,
cn=RWEASLEY,
cn=DMALFOY,
cn=SSNAPE,
cn=ADUMBLED, 
```

* * *

我需要一个返回如下结果的正则表达式：

```
HPOTTER
HGRANGER
RWEASLEY
DMALFOY
SSNAPE
ADUMBLED 
```

我需要在我的正则表达式中更改什么以便模式（`cn=`和逗号）不包含在结果中？

**编辑：**我将用于进行`sed`模式匹配，并将输出通过管道传输到其他命令行实用程序。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-26T18:00:23.200

您将必须执行分组。这是通过将正则表达式修改为：

```
/\bcn=\(\w*\),/g 
```

然后，这会将您的结果填充到分组变量中。根据您的语言，如何提取此值会有所不同。（对于您使用*sed*的变量将是 \1）

请注意，大多数正则表达式风格您不必转义括号 ()，但由于您使用的是*sed*，因此您需要如上所示。

对于正则表达式的优秀资源，我建议：[掌握正则表达式](http://oreilly.com/catalog/9781565922570/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T18:41:13.320

好的，您提出更具体问题的地方已被关闭为“完全重复”，所以我将我的答案从那里复制到这里：

如果你想使用 sed，你可以使用类似下面的东西：

`sed -e 's/dn: cn=\([^,]*\),.*$/\1/'`

您必须使用`[^,]*`，因为在 sed 中，`.*`它是“贪婪的”，这意味着它会在查看任何后续字符之前匹配所有可能的内容。这意味着如果您`\(.*\),`在模式中使用它，它将匹配最后一个逗号，而不是第一个逗号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T18:00:23.233

查看[Expresso](http://www.ultrapico.com/Expresso.htm)我过去曾使用它来构建我的 RegEx。帮助学习也不错。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T18:01:10.343

假设您的引擎支持它，快速而肮脏的方法是使用子匹配：

```
/\bcn=(\w*),/g 
```

然后你会想要得到第一个子匹配。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-26T18:01:40.563

在不知道您使用的是什么语言的情况下，我们无法确定，但在大多数正则表达式解析器中，如果您使用括号，例如

/\bcn=(\w*),/g

那么您将能够获得与您正在搜索的内容完全相同的第一个匹配模式（通常为 \1）。更具体地说，我们需要知道您使用的是什么语言。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-26T18:52:07.433

如果您的正则表达式支持 Lookaheads 和 Lookbehinds 那么您可以使用

```
/(?<=\bcn=)\w*(?=,)/g 
```

那将匹配

```
HPOTTER
HGRANGER
RWEASLEY
DMALFOY
SSNAPE
ADUMBLED 
```

但不是`cn=`两边`,`的。逗号`cn=`仍然必须在匹配中出现，只是不包含在结果中。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-26T17:59:47.523

听起来更像是一个简单的解析问题，而不是正则表达式。ANTLR 语法会很快解决这个问题。

# html - 如何设置宽度以在视觉上截断其显示的内容？

> ID：480722
> 
> 赞同：21
> 
> 时间：2009-01-26T17:58:14.437
> 
> 标签：html, css, html-table, column-width, column-sizing

我正在尝试设置表格的列宽，它可以正常工作，直到它达到子元素在视觉上被截断的程度......然后它的大小不会再小了。（“视觉上被截断”——不合适的东西似乎隐藏在下一列后面）

这是一些示例代码来演示我的问题：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<script language="javascript" type="text/javascript">
    var intervalID = null;

    function btn_onClick()
    {
        // keep it simple, only click once
        var btn = document.getElementById("btn");
        btn.disabled = true;     
        // start shrinking
        intervalID = window.setInterval( "shrinkLeftCell();", 100);
    }

    function shrinkLeftCell()
    {
        // get elements
        var td1 = document.getElementById("td1");
        var td2 = document.getElementById("td2");

        // initialize for first pass
        if( "undefined" == typeof( td1.originalWidth))
        {
            td1.originalWidth = td1.offsetWidth;
            td1.currentShrinkCount = td1.offsetWidth;
        }

        // shrink and set width size
        td1.currentShrinkCount--;
        td1.width = td1.currentShrinkCount;  // does nothing if truncating!

        // set reporting values in right cell
        td2.innerHTML = "Desired Width : [" 
                    + td1.currentShrinkCount 
                    + "], Actual : [" 
                    + td1.offsetWidth + "]";

        // Stop shrinking
        if( 1 >= td1.currentShrinkCount)
            window.clearInterval(intervalID);
    }
</script>
</head>
<body>
    <table width="100%" border="1">
        <tr>
            <td id="td1">
                Extra_long_filler_text
            </td>
            <td id="td2">
                Desired Width : [----], Actual : [----]
            </td>
        </tr>
    </table>

    <button id="btn" onclick="btn_onClick();">Start</button>
</body>
</html> 
```

我尝试以不同的方式设置宽度，包括

```
td1.offsetWidth = td1.currentShrinkCount; 
```

和

```
td1.width = td1.currentShrinkCount + "px"; 
```

和

```
td1.style.width = td1.currentShrinkCount + "px"; 
```

和

```
td1.style.posWidth = td1.currentShrinkCount; 
```

和

```
td1.scrollWidth = td1.currentShrinkCount; 
```

和

```
td1.style.overflow = "hidden";
td1.width = td1.currentShrinkCount; 
```

和

```
td1.style.overflow = "scroll";
td1.width = td1.currentShrinkCount; 
```

和

```
td1.style.overflow = "auto";
td1.width = td1.currentShrinkCount; 
```

我意识到，我可能会使用 DIV，但我不想这样做，因为表是从绑定控件生成的，而且我真的不想重写 asp.net 控件。

话虽如此，我认为作为最后的努力，我至少可以用 DIV 包装每个 'td1' 的内容，溢出会处理好事情，但甚至替换

```
<td id="td1">
    Extra_long_filler_text
</td> 
```

和

```
<td id="td1" style="overflow:hidden;">
    <div style="margin=0;padding:0;overflow:hidden;">
        Extra_long_filler_text
    </div>
</td> 
```

没用。

**有人知道我如何设置宽度以在视觉上截断其内容吗？**

顺便说一句-我的目标浏览器是 IE7。其他浏览器现在并不重要，因为这是一个内部应用程序。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-26T18:50:06.843

我只是尝试添加`table-layout: fixed;`它`<table>`，它在 IE7 上对我有用。

> 在固定的表格布局中，水平布局只取决于表格的宽度，列的宽度，而不是单元格的内容

查看[文档](http://www.w3.org/TR/CSS2/tables.html#width-layout)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T18:14:54.030

### CSS 解决方案

“截断”可能不是您要查找的词。您可能只想隐藏溢出的字符。如果是这种情况，请查看 css 属性“溢出”，它将隐藏任何超出其容器声明限制的内容。

```
td div.masker {
  height:25px;
  width:100px;
  overflow:hidden;
}

<td>
  <div class="masker">
    This is a string of sample text that
    should be hidden when it reaches out of the bounds of the parent controller.
  </div>
</td> 
```

### Javascript 解决方案

如果您确实想要截断容器内的文本，则必须从右侧删除一个字符，测试父级的宽度，然后继续删除字符并测试父级宽度，直到父级宽度与声明的宽度匹配。

```
while (parent.width > desiredWidth) {
  remove one char from right-side of child-text
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T18:11:01.883

```
<td id="td1" style="overflow-x:hidden;"> 
```

应该

```
<td id="td1" style="overflow:hidden;"> 
```

overflow-x 是 Microsoft CSS 属性，现在是 CSS3 的一部分。我会坚持使用旧的溢出属性。

编辑：

正如 Paolo 提到的，您还需要添加 table-layout:fixed; 并指定表格的宽度。下面是一个完整的例子。

```
<html>
<head>
<style>
    table
    {

        table-layout:fixed;
        width:100px;
        }
td
{
    overflow:hidden;
    width:50px;
    border-bottom: solid thin;
    border-top:solid thin;
    border-right:solid thin;
    border-left:solid thin;

}
</style>
</head>
<body>
<table>
<tr><td>Some_long_content</td><td>Short</td></tr>
</table>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T18:17:32.247

据我所知，表格单元格总是会拉伸以适应其内容。

您是否考虑过使用 Javascript 动态截断内容超过一定数量的表格单元格中的数据？或者，您可以更轻松地在服务器端执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T18:31:42.903

您可以使用 jQuery 或纯 javascript 来用 div 标签包围您的单元格的内容，并设置一个固定的宽度和溢出：隐藏在这些标签上。不漂亮，但它会工作。

预计到达时间：

```
<td><div style="width:30px;overflow:hidden">Text goes here</div></td> 
```

由于 DIV 是边界元素，因此应该设置宽度。

# sql-server - 自动打印 SSRS 报告？

> ID：480723
> 
> 赞同：8
> 
> 时间：2009-01-26T17:58:19.163
> 
> 标签：sql-server, reporting-services

有没有办法自动打印 SQL Server Reporting Services (2005) 报告？

编辑：

我们需要以编程方式在网络打印机上打印 SSRS 报告。具体来说，我们想从存储过程中触发它。我们目前正在使用likeabanshee的方法，它正在工作。但是，我们想要更易于管理的东西，而不依赖于 Adob​​e Acrobat 和 xp_cmdshell。我们正在研究[Paul](http://blogs.msdn.com/bryanke/articles/71491.aspx) G.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T11:32:31.860

您应该能够使用内置 Web 服务以编程方式呈现报告。SSRS 2000 的一些示例代码在[这里](http://blogs.msdn.com/bryanke/articles/71491.aspx)，但我认为它应该非常接近您在 2005 年所需的代码：

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T18:26:54.380

如果您使用 Microsoft 商业智能编辑器创建您的 SSRS，您可以编写代码来触发打印作业。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-07T15:25:55.463

这个问题是同事帮我发的。我的评论和决议如下：

背景：我基本上想通过他们的 UNC 向我们公司的联网打印机发送 SSRS 报告。我有一个从 SQL Server 运行的实时质量监控应用程序（用于工业制造设施）。当检测到严重缺陷时，我想向 QA 打印机发送报告，让他们分析缺陷。它还补充了我们的寻呼机/电子邮件警报系统，以在问题发生时阻止它们。

解决方法：我写了一个SQL存储过程来监控质量故障。当检测到它们时，存储过程使用 xp_cmdshell 调用 .Net 控制台应用程序，传递产品 ID、UNC 路径、报告名称、Adobe Reader 文件路径（在 SQL Server 上）和一些其他参数。请注意，控制台应用程序与 SQL Server 位于同一台服务器上。控制台应用程序接受参数并将它们以 PDF 的输出格式传递给 SSRS。PDF 在本地创建和保存，然后控制台应用程序使用 Adob​​e Reader 的隐藏运行模式 (/t) 运行命令行。文件路径和 UNC 路径作为参数传递，瞧——自动打印 SSRS 文件。一个可选参数告诉控制台应用程序是否删除本地保存的 PDF。

# sql - 如何获取与另一列中的项目匹配的一列中的项目计数？

> ID：480730
> 
> 赞同：3
> 
> 时间：2009-01-26T17:59:58.740
> 
> 标签：sql, sql-server, tsql

假设我有两个数据表和一个链接表：

```
AB A_B_链接          
----- ----- -----
ID ID A_ID
名称 名称 B_ID

```

2个问题：

1.  我想编写一个查询，以便我拥有 A 的所有列并计算有多少 B 链接到 A，最好的方法是什么？

2.  有没有办法让查询返回包含 A 中所有列的行和包含B 中*所有*链接名称的列（可能由某些分隔符分隔？）

请注意，**查询必须从 A 返回不同的行**，因此简单的左外连接在这里不起作用……我猜我需要嵌套的 select 语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T18:01:49.343

对于 #1

```
SELECT A.*, 
(SELECT COUNT(*) FROM A_B_Link WHERE A_B_Link.A_ID = AOuter.A_ID)
FROM A as AOuter 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T18:21:03.160

对于你的第一个问题：

```
SELECT A.ID, A.Name, COUNT(ab.B_ID) AS bcount
FROM A LEFT JOIN A_B_Link ab ON (ab.A_ID = A.ID)
GROUP BY A.ID, A.Name; 
```

这将 A 的每行输出一行，其中包含匹配 B 的计数。注意，必须在 GROUP BY 语句中列出 A 的所有列；这里没有办法使用通配符。

另一种解决方案是使用相关子查询，如@Ray Booysen 所示：

```
SELECT A.*, 
  (SELECT COUNT(*) FROM A_B_Link 
   WHERE A_B_Link.A_ID = A.A_ID) AS bcount
FROM A; 
```

这可行，但相关子查询对性能不是很好。

对于第二个问题，您需要类似 MySQL 的`GROUP_CONCAT()`聚合函数。`B.Name`在 MySQL 中，您可以像这样获得 A 的每行的逗号分隔列表：

```
SELECT A.*, GROUP_CONCAT(B.Name) AS bname_list
FROM A 
  LEFT OUTER JOIN A_B_Link ab ON (A.ID = ab.A_ID)
  LEFT OUTER JOIN B ON (ab.B_ID = B.ID)
GROUP BY A.ID; 
```

Microsoft SQL Server 中没有简单的等价物。在这里查看关于 SO 的另一个问题：“[在 MS SQL Server 2005 中模拟 group_concat MySQL 函数？](https://stackoverflow.com/questions/451415/simulating-groupconcat-mysql-function-in-ms-sql-server-2005) ”

或者谷歌搜索' [microsoft SQL server "group_concat"](http://www.google.com/search?q=microsoft+sql+server+%22group_concat%22) ' 以获得各种其他解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T18:08:37.350

```
SELECT A.*, COUNT(B_ID)
FROM A
LEFT JOIN A_B_Link ab ON ab.A_ID=A.ID 
```

# facebook - 删除应用时未调用 Facebook Post-Remove URL

> ID：480734
> 
> 赞同：0
> 
> 时间：2009-01-26T18:00:43.950
> 
> 标签：facebook

我正在测试删除我的 Facebook 应用程序时应该通过 POST ping[的删除后 URL](http://wiki.developers.facebook.com/index.php/Post-Remove_URL "删除后 URL 文档")调用，但它似乎没有被调用。

监控 firebug 中的网络流量并查看删除应用程序时发出的 POST，POST 不会直接调用我在应用程序设置中指定的 Post-Remove URL，也不会传递我根据文档预期的 POST 变量。

我在指定的“删除页面调用”的 URL 处设置了一个简单的输出，我希望将其视为响应，但没有。

最后，调用的 URL 应该删除没有被删除的数据库项目。

我没有任何证据表明我的删除后 URL 被调用了。似乎[我不是唯一一个遇到这个问题的人，](http://forum.developers.facebook.com/viewtopic.php?id=27177 "Facebook 论坛上的主题")但没有提供太多的见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T19:58:44.273

[人们在 Facebook Devleoper 论坛上发布的答案](http://forum.developers.facebook.com/viewtopic.php?pid=122274#p122274 "在 Facebook 开发者论坛上回答")

# javascript - 获得焦点时选择文本框的所有内容（Vanilla JS 或 jQuery）

> ID：480735
> 
> 赞同：331
> 
> 时间：2009-01-26T18:01:08.597
> 
> 标签：javascript, jquery, user-interface

当文本框获得焦点时，将选择文本框的所有内容的 Vanilla JS 或 jQuery 解决方案是什么？

* * *

## 回答 #1

> 赞同：386
> 
> 时间：2009-01-26T18:06:06.123

```
$(document).ready(function() {
    $("input:text").focus(function() { $(this).select(); } );
}); 
```

* * *

## 回答 #2

> 赞同：253
> 
> 时间：2009-01-26T18:06:17.090

```
<input type="text" onfocus="this.select();" onmouseup="return false;" value="test" />
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-04-08T15:37:50.530

```
$(document).ready(function() {
  $("input[type=text]").focus().select();
}); 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2012-08-25T19:09:43.667

```
$(document).ready(function() {
    $("input:text")
        .focus(function () { $(this).select(); } )
        .mouseup(function (e) {e.preventDefault(); });
}); 
```

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2013-02-22T09:49:15.537

jQuery 不是在某些情况下更易于使用的 JavaScript。

看这个例子：

```
<textarea rows="10" cols="50" onclick="this.focus();this.select()">Text is here</textarea> 
```

来源：[CSS 技巧](http://css-tricks.com/snippets/javascript/auto-select-textarea-text/)，[MDN](https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/select)

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2013-02-06T14:24:41.163

这不仅仅是 Chrome/Safari 的问题，我在 Firefox 18.0.1 上也遇到了非常相似的行为。有趣的是，这不会发生在 MSIE 上！这里的问题是第一个**mouseup**事件强制取消选择输入内容，所以忽略第一次出现。

```
$(':text').focus(function(){
    $(this).one('mouseup', function(event){
        event.preventDefault();
    }).select();
}); 
```

timeOut 方法会导致一种奇怪的行为，并且阻止每个 mouseup 事件，您无法删除再次单击输入元素的选择。

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2016-12-02T15:23:26.527

**HTML：**

```
var textFiled = document.getElementById("text-filed");
textFiled.addEventListener("focus", function() { this.select(); });
```

```
Enter Your Text : <input type="text" id="text-filed" value="test with filed text">
```

**使用 jQuery ：**

```
$("#text-filed").focus(function() { $(this).select(); } ); 
```

**使用反应 JS：**

在相应的组件中 -

```
<input
  type="text"
  value="test"
  onFocus={e => e.target.select()}
/> 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2013-01-29T00:09:30.590

我的解决方案是使用超时。似乎工作正常

```
$('input[type=text]').focus(function() {
    var _this = this;
    setTimeout(function() {
        _this.select();
    }, 10);
}); 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-03-13T09:07:09.640

这也适用于 iOS：

```
<input type="text" onclick="this.focus(); this.setSelectionRange(0, 9999);" /> 
```

[https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/select](https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/select)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-02-11T10:39:52.140

我知道内联代码风格不好，但我不想把它放到 .js 文件中。无需 jQuery 即可工作！

```
<input type="text" value="blah blah" onfocus="this.select(); this.selAll=1;" onmouseup="if(this.selAll==0) return true; this.selAll=0; return false;"></input> 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-12-20T17:37:53.267

这里的答案在一定程度上帮助了我，但是在单击 Chrome 中的向上/向下按钮时，我在 HTML5 数字输入字段上遇到了问题。

如果您单击其中一个按钮，并将鼠标悬停在该按钮上，则数字将不断变化，就像您按住鼠标按钮一样，因为 mouseup 被扔掉了。

我通过在触发后立即删除 mouseup 处理程序来解决此问题，如下所示：

```
 $("input:number").focus(function () {
        var $elem = $(this);
        $elem.select().mouseup(function (e) {
            e.preventDefault();
            $elem.unbind(e.type);
        });
    }); 
```

希望这对未来的人们有所帮助......

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-02-06T06:34:14.010

这将工作，试试这个 -

```
<input id="textField1" onfocus="this.select()" onmouseup="return false" /> 
```

在 Safari/IE 9 和 Chrome 中工作，但我没有机会在 Firefox 中进行测试。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2015-10-03T15:24:09.983

像@Travis 和@Mari 一样，我想在用户点击时自动选择，这意味着阻止`mouseup`事件的默认行为，但不阻止用户点击。我想出的解决方案适用于 IE11、Chrome 45、Opera 32 和 Firefox 29（这些是我目前安装的浏览器），它基于鼠标点击所涉及的事件序列。

当您单击没有焦点的文本输入时，您会收到以下事件（以及其他事件）：

*   `mousedown`: 响应您的点击。`focus`如有必要，默认处理会引发并设置选择开始。
*   `focus`: 作为默认处理的一部分`mousedown`。
*   `mouseup`：点击完成，其默认处理将设置选择结束。

当您单击已具有焦点的文本输入时，将`focus`跳过该事件。正如@Travis 和@Mari 都敏锐地注意到的那样，只有在事件发生`mouseup`时才需要阻止默认处理。`focus`然而，由于没有“`focus`没有发生”事件，我们需要推断这一点，我们可以在`mousedown`处理程序中进行。

@Mari 的解决方案要求导入 jQuery，这是我想避免的。@Travis 的解决方案通过检查`document.activeElement`. 我不知道为什么他的解决方案不能跨浏览器工作，但是还有另一种方法可以跟踪文本输入是否具有焦点：只需跟随它的`focus`和`blur`事件。

这是对我有用的代码：

```
 var blockMouseUp = false;
    var customerInputFocused = false;

    txtCustomer.onfocus =
      function ()
      {
        try
        {
          txtCustomer.selectionStart = 0;
          txtCustomer.selectionEnd = txtCustomer.value.length;
        }
        catch (error)
        {
          txtCustomer.select();
        }

        customerInputFocused = true;
      };

    txtCustomer.onblur =
      function ()
      {
        customerInputFocused = false;
      };

    txtCustomer.onmousedown =
      function ()
      {
        blockMouseUp = !customerInputFocused;
      };

    txtCustomer.onmouseup =
      function ()
      {
        if (blockMouseUp)
          return false;
      }; 
```

我希望这对某人有帮助。:-)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-03-11T13:20:48.270

我知道这里已经有很多答案了——但到目前为止还没有这个答案；也适用于 ajax 生成的内容的解决方案：

```
$(function (){
    $(document).on("focus", "input:text", function() { 
        $(this).select(); 
    });
}); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-08-21T15:29:22.123

通过合并一些函数调用，我能够稍微改进 Zach 的答案。该答案的问题在于它完全禁用了 onMouseUp，从而阻止您在获得焦点后在文本框中单击。

这是我的代码：

```
<input type="text" onfocus="this.select()" onMouseUp="javascript:TextBoxMouseUp();" onMouseDown="javascript:TextBoxMouseDown();" />

<script type="text/javascript">
    var doMouseUp = true;
    function TextBoxMouseDown() {
        doMouseUp = this == document.activeElement;
        return doMouseUp;
    }
    function TextBoxMouseUp() {
        if (doMouseUp)
        { return true; }
        else {
            doMouseUp = true;
            return false;
        }
    }
</script> 
```

这比扎克的回答略有改进。它在 IE 中完美运行，在 Chrome 中根本不起作用，并且在 FireFox 中交替成功（实际上每隔一次）。如果有人知道如何让它在 FF 或 Chrome 中可靠地工作，请分享。

无论如何，我想我会分享我能做的让这变得更好一点。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-12-16T06:42:50.533

> *当文本框获得**焦点时，将****选择**文本框的所有内容的JavaScript 或 jQuery 解决方案是什么？*

 **您只需要添加以下属性：

```
onfocus="this.select()" 
```

例如：

```
<input type="text" value="sometext" onfocus="this.select()"> 
```

*（老实说，我不知道你为什么需要其他东西。）*

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-01-18T10:51:53.903

```
onclick="this.focus();this.select()" 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-08-03T16:00:34.493

这对我有用（发布，因为它不在答案中，而是在评论中）

```
 $("#textBox").focus().select(); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-06-19T23:51:56.620

```
$('input').focus(function () {
    var self = $(this);
    setTimeout(function () {
        self.select();
    }, 1);        
}); 
```

编辑：根据@DavidG的要求，我无法提供详细信息，因为我不确定为什么会这样，但我相信它与焦点事件向上或向下传播或它所做的任何事情以及输入元素获取通知有关它得到了关注。设置超时让元素有时间意识到它已经这样做了。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-03-12T05:35:50.123

如果您将事件链接在一起，我相信它消除了使用`.one`本线程其他地方建议的需要。

例子：

```
$('input.your_element').focus( function () {
    $(this).select().mouseup( function (e) {
        e.preventDefault();
    });
}); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-08-24T20:13:14.917

注意：如果您在 ASP.NET 中编程，您可以使用 C# 中的 ScriptManager.RegisterStartupScript 运行脚本：

```
ScriptManager.RegisterStartupScript(txtField, txtField.GetType(), txtField.AccessKey, "$('#MainContent_txtField').focus(function() { $(this).select(); });", true ); 
```

或者只需在其他答案中建议的 HTML 页面中键入脚本。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-04-30T18:07:05.453

我在某个地方播种了这个，效果很好！

```
 $('input').on('focus', function (e) {
                $(this)
                $(element).one('mouseup', function () {
                        $(this).select();
                        return false;
                    })                        .select();
            }); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-06-20T15:27:58.307

我参加聚会有点晚了，但这在 IE11、Chrome、Firefox 中完美运行，不会弄乱 mouseup（也没有 JQuery）。

```
inputElement.addEventListener("focus", function (e) {
    var target = e.currentTarget;
    if (target) {
        target.select();
        target.addEventListener("mouseup", function _tempoMouseUp(event) {
            event.preventDefault();
            target.removeEventListener("mouseup", _tempoMouseUp);
        });
    }
}); 
```

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2015-04-07T12:08:24.723

接下来是我的解决方案：

```
var mouseUp;
$(document).ready(function() {
    $(inputSelector).focus(function() {
        this.select();
    }) 
    .mousedown(function () {
        if ($(this).is(":focus")) {
          mouseUp = true;
        }
        else {
          mouseUp = false;
        }
     })
     .mouseup(function () {
        return mouseUp;
     });
}); 
```

所以mouseup通常会起作用，但不会在通过输入获得焦点后取消选择

# sql - 在 SQL 中选择包含所有子项的父记录

> ID：480742
> 
> 赞同：8
> 
> 时间：2009-01-26T18:02:36.847
> 
> 标签：sql, sql-server, sql-server-2005, tsql

假设我有两个表，“父”和“子”。Parent-to-Child 是一种多对多关系，通过标准的交叉引用表实现。

我想使用 SQL 查找给定子集的所有成员引用的所有父记录（特别是 MS SQL Server 的 T-SQL；2005 语法是可以接受的）。

例如，假设我有：

*   项目清单
*   父母爱丽丝
*   鲍勃家长
*   孩子查理提到爱丽丝，鲍勃
*   孩子大卫引用爱丽丝
*   儿童夏娃引用鲍勃

我的目标是：

*   如果我有孩子 Charlie，我希望结果集包括 Alice 和 Bob
*   如果我有孩子 Charlie 和 David，我希望结果集包括 Alice 而**不是**Bob。
*   如果我有孩子 Charlie、David 和 Eve，我希望结果集不包括任何人。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-26T18:11:53.707

依靠数字技巧（其中父子链接的数量 = 子节点的数量，该父节点链接到所有子节点）：

```
SELECT Parent.ParentID, COUNT(*)
FROM Parent
INNER JOIN ChildParent
    ON ChildParent.ParentID = Parent.ParentID
INNER JOIN Child
    ON ChildParent.ChildID = Child.ChildID
WHERE <ChildFilterCriteria>
GROUP BY Parent.ParentID
HAVING COUNT(*) = (
    SELECT COUNT(Child.ChildID)
    FROM Child WHERE <ChildFilterCriteria>
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T18:15:23.263

这是一个答案。

[SQL 查询：在多行上模拟“与”而不是子查询](https://stackoverflow.com/questions/163887/sql-query-simulating-an-and-over-several-rows-instead-of-sub-querying#163907)

这是该问题的具体应用。

```
SELECT * FROM Parents
WHERE ParentId in
(
  SELECT ParentId FROM ChildParent
  WHERE ChildId in
  (
    SELECT ChildId FROM Child
    WHERE ChildName in ('Charlie', 'David')
  )
  GROUP BY ParentId
  HAVING COUNT(*) = 2
) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T18:53:40.957

（我猜你说“儿童夏娃引用夏娃”的意思是“儿童夏娃引用鲍勃”，对吧？）

我想我明白了......看起来很丑......秘密是双重否定......也就是说，每个人都认为它是真的，与没有任何人是假的......（好吧，我的英语有问题，但我想你明白我的意思）

```
从父级选择 *

parent_id 名称
--------------------------------------- ------------ --------------------------------------
1 爱丽丝
2鲍勃

从孩子中选择 *

child_id 名称
--------------------------------------- ------------ --------------------------------------
1个查理
2大卫
3 前夜

从 parent_child 中选择 *

parent_id child_id
--------------------------------------- ------------ ----------------------------
1 1
2 1
1 2
2 3

从父 p 中选择 *
哪里不存在（
    从孩子 c 中选择 *
    在哪里
        c.child_id in ( 1, 2, 3 ) 和
        不存在（
            select * from parent_child pc where
                pc.child_id = c.child_id 和
                pc.parent_id = p.parent_id
        )
)

--当子列表 = ( 1 )
parent_id 名称
--------------------------------------- ------------ --------------------------------------
1 爱丽丝
2鲍勃

--当子列表 = ( 1, 2 )
parent_id 名称
--------------------------------------- ------------ --------------------------------------
1 爱丽丝

--当子列表 = ( 1, 2, 3 )
parent_id 名称
--------------------------------------- ------------ --------------------------------------

```

嗯，希望对你有帮助...

# wpf - INotifyPropertyChanged 问题

> ID：480743
> 
> 赞同：7
> 
> 时间：2009-01-26T18:02:43.227
> 
> 标签：wpf, data-binding, inotifypropertychanged

首先，我想说下面的示例过于简单化。假设您已绑定 WPF 控件。

```
<Window Title="Window1" Height="300" Width="300">
<Grid>
    <StackPanel>
        <TextBox Text="{Binding Name}" Margin="10"/>
        <Button HorizontalAlignment="Center" 
        Content="Click Me" Margin="5" 
        Padding="2" Click="OnButtonClick" />
    </StackPanel>
</Grid>
</Window> 
```

Window 绑定到 Person 类，该类实现`INotifyPropertyChanged`并在表单中具有 Name setter

```
 public string Name 
    {
        get { return _name; }
        set 
        {
            _name = "Some Name";
            OnPropertyChanged("Name");
        }
    } 
```

即，每当用户尝试从 UI 更改它时，_name 都会被分配“某个名称”。但是这个示例不起作用。我将 TextBox 中的名称更改为某个值，按选项卡强制焦点移动到 Button，尽管触发了 PropertyChanged 事件，但 TextBox 中的值保持不变。

你能解释一下为什么会这样吗？据我了解`PropertyChanged`，事件会强制 UI 从属性中重新读取值并显示它们，但在我的示例中，数据绑定文本框中的值未更新。

* * *

再次。我知道这是该属性的不良实现，但我想重复一遍，这是过于简单化了。这只是一个样本。但无论如何，PropertyChanged 表示属性已更改并且应该更新但它没有。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-26T19:40:23.030

TextBox 忽略 PropertyChanged 事件，因为它是事件的发起者。

一些澄清：

TextBox（或文本框上的绑定）知道它是发起者，因为它在同一个调用中接收到 PropertyChanged 事件。通过执行异步调用，文本框（或绑定）无法知道它是发起者，因此它将处理事件，就好像其他人更新了它一样

如果您将第二个文本框添加到您的 UI，您会看到第二个文本框在您编辑第一个文本框时确实发生了变化，反之亦然。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-10-29T09:39:16.610

*当绑定的UpdateSourceTrigger*为*PropertyChanged*时，Heinzi 建议的虚拟转换器解决方法（[在此处](http://www.lhotka.net/weblog/DataBindingIssueInWPFWithSolution.aspx)描述）不起作用。但是，如果这是我们需要的呢？

 **似乎使绑定异步可以解决问题，例如：

```
SelectedIndex="{Binding SelectedIndex, IsAsync=True}" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-01T14:03:15.363

正如 Bubblewrap 已经指出的那样，这是设计使然——文本框假定如果将绑定属性设置为某个值，则设置器不会更改该值。[根据微软](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/6f78d75f-9769-4ff9-a76f-c2af0040d9b0)的说法，他们不会改变这种行为，因为这会破坏现有的代码。

如果您*想*更改该值（是的，这样做有充分的理由），您必须使用一种解决方法，例如，通过添加一个虚拟转换器。有[一篇博](http://www.lhotka.net/weblog/DataBindingIssueInWPFWithSolution.aspx)文（不是我写的）详细描述了这种技术。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T18:09:18.860

原因是您在 setter 中硬编码了“Some Name”。当您更改 textBox 值时，实际上调用了 setter 并再次将“Some Name”设置为 propertyValue，因此它似乎没有在 UI 中更改。Put`_name = value`一切都会如你所愿，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T18:09:41.823

如果我没记错的话，TextBox 上 Text 属性的默认绑定行为是 TwoWay，所以这应该可以工作。您可以像这样在 XAML 中强制它为 TwoWay：

```
<Window Title="Window1" Height="300" Width="300">
  <Grid>
    <StackPanel>
        <TextBox Text="{Binding Name, Mode=TwoWay}" Margin="10"/>
        <Button HorizontalAlignment="Center" 
        Content="Click Me" Margin="5" 
        Padding="2" Click="OnButtonClick" />
    </StackPanel>
  </Grid>
</Window> 
```

请注意`Mode=TwoWay`Binding 声明中的 。

如果这不起作用，那么我怀疑在触发事件或分配属性的代码中引发了异常，您应该寻找它。

* * *

您似乎有可能正在调用以更改不是 UI 线程的线程上的值。如果是这种情况，那么您要么必须编组调用以在 UI 线程上触发属性更改事件，要么对 UI 线程上的值进行更改。

当对象绑定到 UI 元素时，必须在 UI 线程上对可能影响 UI 的对象进行更改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T18:14:27.633

```
public string MyField  
{  
    get { return _myField; }  
    set {   
        if (_myField == value)  
            return;  

        _myField = value;   

        OnPropertyChanged("MyField");  
    }  
} 
```

这是该属性的正确实现。

更改属性时，请确保对象的完全相同的实例绑定到控件。否则，将通知更改，但控件永远不会得到它，因为控件未正确绑定。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T18:15:20.800

替换表单中的设置器

```
 set 
        {
            _name = "Some Name";
            Dispatcher.CurrentDispatcher.BeginInvoke(DispatcherPriority.DataBind, 
                (SendOrPostCallback)delegate { OnPropertyChanged("Name"); },
                null);
        } 
```

解决了这个问题，但它仍然是开放的。为什么我应该进行异步调用而不是同步发出我的属性已更改的信号。

# visual-studio - 帮助一步构建所有项目 + 安装程序 (.NET + WiX)

> ID：480748
> 
> 赞同：3
> 
> 时间：2009-01-26T18:03:26.020
> 
> 标签：visual-studio, msbuild, build-process, wix

我在安装程序上有预构建事件，以使用适当的配置等重建项目。

如果我在 Visual Studio 中的 WiX (3.0) 项目上右键单击构建/重建，则一切正常，但如果我尝试在 wixproj 文件上运行 MSBuild，预构建事件将引发错误。

我可以改为在 wixproj 上调用 Candle 和 Light，但它不会运行预构建事件。

预构建事件依赖于 VS 提供的宏，除了创建另一个项目之外，我不知道如何解决这个问题，基本上只是使用项目的预构建事件，这只是尖叫 hack。

另一个问题是我需要从命令行向 WiX 输入一个自我更新的版本号。

我打算只使用一个 csproj 来处理版本号并更新它，然后只使用 MSBuild 和 Candle 和 Light，但问题是我不知道如何从硬编码以外的代码访问解决方案目录它在

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T04:47:27.433

我们发现在使用自动构建器（在我们的例子中[为 VisualBuild](http://www.kinook.com/visualbuildpro)）构建项目之前，使用实用程序编辑项目本身并转储所有预构建和构建后事件是最简单的。

这给我们留下了一个漂亮而多汁的构建过程，它不依赖于 IDE 中的任何讨厌的 hack，并且让我们可以完全控制源代码的来源和构建组件的去向。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-09T11:07:59.763

我正在使用一种对我来说效果很好的不同方式，[我在此处进行了描述](https://stackoverflow.com/a/14792225/6884)。

*   [我在批处理文件中](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/wix/version_number.bat)维护版本号，它只是将其写入环境变量
*   [我通过运行一个批处理文件](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/build.bat)来创建我的发布版本，该批处理文件首先调用“版本号”批处理文件*（所以我在一个名为的环境变量中有版本号`%VersionNumber%`）*，然后执行一个[MSBuild 项目文件](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/build.proj)
*   MSBuild 项目文件构建解决方案，我通过从环境变量中读取它来获取[文件中 .exe](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/src/BitbucketBackup/BitbucketBackup.csproj#L148)[的`.csproj`](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/src/BitbucketBackup/BitbucketBackup.csproj#L148)版本号（如果它存在）（然后我使用[MSBuild 社区任务](https://nuget.org/packages/MSBuildTasks)`AssemblyInfo`在 pre中创建具有版本号的文件构建事件）
    *这意味着从 Visual Studio 构建时 .exe 的版本为 0.0，但我很好，因为我从批处理文件创建了所有版本。*
*   *要使用*WiX 设置创建发布版本，我执行[另一个批处理文件](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/build-setup.bat)，它只调用上面提到的“构建”批处理文件，然后调用 WiX 实用程序`candle`并`light`构建实际设置。
*   `candle`使用[此`.wxs`文件](https://github.com/christianspecht/bitbucket-backup/blob/8f5d8de0d145c075b03495f5b76f04118e870cf7/wix/bitbucket-backup.wxs)创建设置，我再次从环境变量中获取版本号：`$(env.VersionNumber)`
*   由创建的最终`.msi`文件`light`在其文件名中包含版本号，因为我将文件名*（包括带有版本号的环境变量）*作为参数传递：`-out release\msi\bitbucket-backup-%VersionNumber%.msi`

一开始我花了一段时间才弄清楚这一切，但现在我以类似的方式发布了我所有的项目。

# .net - CLR 和 CLI - 有什么区别？

> ID：480752
> 
> 赞同：54
> 
> 时间：2009-01-26T18:04:40.587
> 
> 标签：.net, clr, command-line-interface

我想知道 CLR 和 CLI 之间到底有什么区别？从我目前所读的任何内容来看，这似乎表明 CLI 是 CLR 的一个子集。但是 CLR 中的所有内容都不是强制性的吗？在 CLR 中创建 CLI 时可能会遗漏什么？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-01-26T18:06:08.370

[CLR](http://en.wikipedia.org/wiki/Common_Language_Runtime)是 Microsoft 对[CLI 标准](http://www.ecma-international.org/publications/standards/Ecma-335.htm)的实现。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2012-06-24T14:54:12.593

CLR 是安全托管/运行 .NET 应用程序的执行环境。

您可以将其视为 .NET 的私有操作系统，它在 .NET 应用程序启动之前启动和加载。

CLR 负责处理任何 .NET 应用程序的某些基本要求，否则这些应用程序需要编写大量经过深思熟虑的代码才能实现；要求本质上是整体的，对于任何类型的应用程序以良好、高效和安全的方式运行都是必不可少的[例如，处理内存分配并在不需要时释放它，避免悬空指针，避免类型转换错误等]

另一方面，CLI 是一个规范/指南集，它解释了如何实现应用程序执行环境以及生成的应用程序代码的性质，允许在不同的计算机平台上使用多种高级语言，而无需针对特定架构进行重写。

CLI 由 Microsoft 开发并由 ISO 和 ECMA 标准化。

CLR 是 CLI 的 VES [虚拟执行系统] 部分的实际实现，是 MS.NET 平台的核心组件之一

用外行的话来说，CLI 是菜谱，而 CLR 是美食 :-)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-03-27T03:36:43.867

CLR（公共语言运行时）是微软对 VES（虚拟执行系统）的实现。VES 连同 CTS（通用类型系统）、CLS（通用语言规范）和元数据规范都是 CLI（通用语言基础设施）规范的一部分。

VES 是一种标准化的虚拟机规范，必须实施它才能加载和执行 CIL（通用中间语言）模块（dll 和 exe）。VES 实现还提供运行时服务，例如垃圾收集和安全性。

[ECMA C# 和通用语言基础设施标准](https://www.visualstudio.com/license-terms/ecma-c-common-language-infrastructure-standards/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-02T09:17:25.003

CLR 是运行各种 .net 应用程序的 .net 执行环境。例如，当您使用 C# 或 dot NET 堆栈中的其他语言编写代码时，编译器会编译并将其转换为托管模块。托管模块是 IL（中间语言）和元数据。最重要的是，要记住的重要一点是，无论何时编译源代码，编译器都会将其转换为托管模块。需要澄清的是，这不是您的处理器将执行的机器代码。事实上，IL 是一种接近汇编语言的中间语言。同样，它也以面向对象的机器语言而闻名。

查看这篇文章以获得更详细的解释：

[http://alevryustemov.com/programming/common-language-runtime/](http://alevryustemov.com/programming/common-language-runtime/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-01-27T01:12:22.730

公共语言运行时 (CLR) 是一种编程，它管理以多种受支持语言中的任何一种编写的程序的执行，允许它们共享以任何语言编写的通用面向对象类。它是 Microsoft .NET Framework 的一部分。CLR 在某种程度上类似于 Sun Microsystems 提供的用于运行从 Java 语言编译的程序的 Java 虚拟机。Microsoft 将其 CLR 称为“托管执行环境”。为 CLR 编译的程序不需要特定于语言的执行环境，并且可以轻松移动到任何装有 Windows 2000 或 Windows XP 的系统上并在其上运行。

尽管

公共语言基础结构是微软开发的一个标准，它允许在不同的计算机平台上使用多种不同的高级语言，而无需为任何特定的架构重写代码。简而言之，公共语言基础设施 (CLI) 使以任何常用编程语言编写的应用程序能够在使用通用运行时程序而不是特定于每种语言的任何操作系统上运行。.NET Framework、.NET Core 和 Mono 是 CLI 的一些实现。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-04-06T01:22:04.967

正如所回答的，CLR 是微软的实现。该组件本身在 Visual Studio 安装程序中称为 C++/CLI，但一旦安装，它就会显示为 CLR。

您可以添加删除程序 >> Visual Studio 2009，修改安装并添加或删除 C++/CLI。它的列表如下面的屏幕截图所示，但再次安装后，项目类型在 Visual Studio 中称为 CLR。

[![在此处输入图像描述](https://i.stack.imgur.com/VNrGo.png)](https://i.stack.imgur.com/VNrGo.png)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-06-17T04:56:32.690

CLR 是 CLI、CTS、CLS 集成工作的完整环境，它还包括垃圾收集、内存管理、安全性、本机代码的中间语言...... **CLI**是可执行代码格式的规范，以及运行时环境可以执行该代码。

# c# - ASP.NET 线程 - 双重检查锁定

> ID：480757
> 
> 赞同：2
> 
> 时间：2009-01-26T18:06:20.397
> 
> 标签：c#, asp.net, multithreading

我在 HttpApplicationState 对象上有一个扩展方法，用于将我的 IoC 容器从应用程序中取出。如果容器不存在，同样的代码也会创建容器。

我有两个问题：

1.  我的代码实际上是线程安全的吗？
2.  这是否被认为是处理应用程序状态的最佳实践

代码如下：

```
private const string GlobalContainerKey = "UnityContainerKey";

public static IUnityContainer GetContainer(this HttpApplicationState application)
{
    var container = application[GlobalContainerKey] as IUnityContainer;

    if (container == null)
    {
        try
        {
            application.Lock();
            container = application[GlobalContainerKey] as IUnityContainer;

            if (container == null)
            {
                container = new UnityContainer();
                application[GlobalContainerKey] = container;
            }
        }
        finally
        {
            application.UnLock();
        }
    }

    return container;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T18:15:57.583

你需要把

```
var container = application[GlobalContainerKey] as IUnityContainer; 
```

在锁中也是如此，否则许多线程可能会依次创建一个新容器。

```
private const string GlobalContainerKey = "UnityContainerKey";
private const object lockObject = new object();

public static IUnityContainer GetContainer(this HttpApplicationState application)
{
    var IUnityContainer container = null;

    lock (lockObject)
    {
        container = application[GlobalContainerKey] as IUnityContainer;
        if (container == null)
        {
            container = new UnityContainer();
            application[GlobalContainerKey] = container;
        }
    }

    return container;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T18:14:58.897

从技术上讲，鉴于 EMCA 规范，这将不起作用。Jon Skeet 在他的 C# FAQ 中谈到了这一点：

[http://www.yoda.arachsys.com/csharp/singleton.html](http://www.yoda.arachsys.com/csharp/singleton.html)

具体见“第三版”部分

我会进一步阅读并使用他关于如何实现单例的建议来了解如何实现您正在尝试做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T18:15:34.107

为什么你第一次检查“container == null”？我认为您应该先锁定，然后检查容器是否为空。在第一个 if 和其他线程中的 return 之间可能会发生各种狡猾的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T20:35:41.733

在 .NET Framework 的代码中使用了带锁的双重检查，用于单例（例如，参见 System.Web.Profile.ProfileManager）。

所以我认为你的实现是好的。

# c# - 您是否会在 VB 中进行开发，然后将代码转换为 C#，以便让您的整个团队使用一种语言？

> ID：480761
> 
> 赞同：2
> 
> 时间：2009-01-26T18:07:23.343
> 
> 标签：c#, vb.net, preferences

我没有考虑这一点——我对 C# 和 VB 很满意，但两者都不是专家。但是，由于我们正在将 C# 作为标准，因此我团队中的一些人表示打算这样做。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-26T18:11:40.917

地狱没有。纯粹是浪费时间。

仅当语言启用了其他语言中不可用的功能时，我才会使用 VB over C#（或 C# over VB）。

例如，在 VB 中对 COM 互操作对象进行后期绑定调用比在 C# 中要容易得多（尽管这在 C# 4.0 中会有所改变）。

话虽如此，我会坚持使用您的团队使用的语言，或者您喜欢的语言（如果可以的话）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T18:12:55.033

听起来像是灾难的秘诀，或者至少是无数个没有实际收获的 WTF 时刻。

无论语言如何，.net 程序集都是兼容的（无论如何最后都是​​ IL），因此没有任何好处。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-26T18:09:03.840

我会在 C# 中感到舒服，这不应该花太长时间。用VB编写然后转换只是浪费时间IMO。

此外，如果他们不熟悉该语言，需要阅读一些 C# 代码时会发生什么？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-26T18:10:48.797

我不会这样做。我会开始使用 C#。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-26T18:11:45.317

从*程序员的意图*到任何一种语言的源代码都比从一种语言到另一种语言更容易。

您应该使用您打算使用的语言。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-26T18:31:51.390

还有其他未提及的注意事项。值得注意的是，如果您使用自动化软件将 VB 代码转换为 C#，您可以指望存在大量转换问题。不要让任何人引诱您对转换所需的工作量产生错误的信心：VB.NET 和 C# 之间的距离比您想象的要大。从一种语言转换到另一种语言会给您的日程安排带来大量工作，并且可能会以意想不到的方式重写您的部分代码。

从做过的人那里拿走。

如果您没有真正令人信服的理由将现有代码移植到 C#，那么将其保留在该语言中并简单地用 C# 编写更新的代码可能更具成本效益。此外，如果您的开发人员对新语言的更改并不完全满意，您可能不得不处理他们中的一些人可能会感到的不适。不管我们同意与否，有些员工可能对此感觉非常强烈以至于他们会离开，当你不得不更换他们时，这将产生巨大的成本。

只是我的两分钱。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-26T18:12:56.670

我会反对这种做法。

如果打算将 C# 作为标准，为什么还要等待开始使用它？我还发现很难想象转换永远不会发生。当谈到关键时间并且在转换和添加/修复功能之间进行选择时，转换可能是第一个去的。

在它的脉络中，这是一个人的问题。为什么首先要迁移到 C#？你确定每个人都同意这是标准吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-26T18:28:34.643

作为 VB 的**忠实粉丝**，我会说这本质上是一个非常糟糕的主意。如果正在使用 C#，请用 C# 编写。

实际上，.NET 可以很容易地在一个项目中混合多种语言，只要它被分成多个程序集。先验没有任何东西反对这种做法。但是，一旦将*一种*语言作为项目中的标准建立，所有开发人员都应该坚持下去。

转换*是*浪费时间和金钱，因为不存在自动、无错误的转换工具（我知道），所以它总是涉及一些手动后处理。这不应该是可以接受的。此外，在您了解 VB 的情况下学习 C# 非常简单，不应造成抵消转换代码成本的障碍。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-26T18:11:59.823

我不会推荐它。恕我直言，这只会使工作加倍。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-26T18:28:16.780

如果您需要两个不同的应用程序相互通信，我建议使用 Web 服务或某种开放格式 (XML) 来传输数据。这样您就可以同时保留 VB 和 C# 应用程序。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-26T18:35:55.547

我更喜欢 C#，但如果大多数开发人员都是 VB.NET 人员，你为什么要转向 C#？这将是一条学习曲线，不会提高生产力。此外，我假设大多数是 VB.NET 人员，如果做得不好，那么您将面临一场巨大的公关噩梦。

我们采用的方法是 VB.NET 人员在 VB.NET 中开发，C# 人员在 C# 中开发，我们很幸运拥有定义良好的模块，这些模块可以在 IL 级别进行交互而不会出现任何问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-26T19:19:01.763

不，不！拒绝吧。

我的老板曾经建议过，因为许多工程师（注意..结构工程师，而不是程序员）都知道 VB6 并且对 VB 很熟悉，但他想使用 C# 作为标准。

我立刻想给他装上一些东西，让他有点理智，但我克制住了自己，平静地和他讨论了选择。我终于能够说服他——虽然 .NET 是 .NET——带有 VB6 片段的 VB.NET 与 C#.NET 是不一样的，用户肯定会为了“易于编码”而挤进去。

有足够的差异——至少对我们来说——C# 的学习曲线值得花时间，而不是从一种 .NET 语言转换为另一种语言的编码曲线。

# eclipse - 限制插件之间贡献的扩展点数据

> ID：480763
> 
> 赞同：1
> 
> 时间：2009-01-26T18:07:50.860
> 
> 标签：eclipse, eclipse-plugin, osgi, eclipse-3.4

我正在构建 2 个 eclipse 插件；让我们称它们为插件 A 和插件 B ......

插件 A 需要许可证才能运行，插件 B 对全世界免费。我在插件 B 中创建了一个扩展点，插件 A 贡献（并且在某些情况下覆盖）数据。如果插件 A 未获得许可（无需检查插件是否可以启动），我想找到一种方法来忽略插件 B 中的数据。

eclipse中是否有这样的机制可以让我完成这样的壮举？我目前的解决方法是检查插件是否已启动（通过捆绑包）以及是否未尝试启动它。`start()`如果插件 A 未经许可，我会在方法中抛出异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-07T12:35:51.940

如果没有获得许可，A 是否不应该检查其许可证本身并且不覆盖/不提供任何数据（或通过提供相同的数据来覆盖）？当本质上 B 不关心时（因为它是免费的），为什么要把许可证检查的负担放在 B 身上。

如果找不到许可证，我会选择 A 以受限模式启动。您可能还 - 正如 jamesh 建议的那样 - 想要让用户有机会提供许可证，例如，使用额外的 A-UI 插件通知用户缺少许可证并提供许可证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T17:38:06.257

**要求**

因此，您正在编写两个插件。

插件 B 有一个扩展点。如果用户拥有插件 A 的捆绑包和许可证，那么插件 A 应该为插件 B 中的 EP 贡献扩展。

**方法**

OSGi 的安全模型主要建立在默认的 Java Permissions 和 SecurityManager 之上。[Apache Felix](http://felix.apache.org/site/presentations.data/Building%20Secure%20OSGi%20Applications.pdf)在此演示文稿中进行了讨论。我希望有可能围绕这个建立一个许可计划。

您的解决方法听起来像是可行的，但是，有几个问题：

*   停止启动捆绑包可能会阻止注册任何服务，但它会影响扩展注册表的更改吗？即那些使用plugin.xml 注册的扩展。我猜 DS 服务应该没问题，但我必须尝试一下。
*   停止捆绑可能还不够——以后可以重新开始吗？我可能希望它卸载。
*   未经许可的捆绑包是告诉用户有关许可的机会。那么，您如何告诉用户该捆绑包未获得许可，并且无法使用，顺便说一句，这就是您许可它的方式。

到目前为止，您还没有谈到如何实施许可证。我猜你会选择 LicenseService，甚至可能是单例。

请报告您的发现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-29T08:34:37.537

我能想到的一种可能的解决方案是，您将插件 A 中的类贡献给插件 B。然后，当插件 B 读取贡献项时，它可以尝试创建此类的实例。

如果没有许可，插件 A 中的类可以在构造函数中抛出一些异常。这将告诉插件 B 来自插件 A 的信息可以忽略。

插件 B 中的可能实现如下所示：

```
 IExtensionPoint extensionPoint = registry.getExtensionPoint("mypoint");
    IConfigurationElement[] elements = extensionPoint.getConfigurationElements();
    for (int i = 0; i < elements.length; i++) {
      try {
        (License)elements[i].createExecutableExtension("class");
        // ..... Read any other items you need....
      }
      catch(LicenceException e){
        // Plugin is invalid, do not use
      }
    } 
```

# linux - 加载共享库时的 Linux 错误：无法打开共享对象文件：没有这样的文件或目录

> ID：480764
> 
> 赞同：452
> 
> 时间：2009-01-26T18:07:57.193
> 
> 标签：linux, shared-libraries, file-not-found, xenomai

程序是 Xenomai 测试套件的一部分，从 Linux PC 交叉编译到 Linux+Xenomai ARM 工具链。

```
# echo $LD_LIBRARY_PATH                                                                                                                                          
/lib                                                                                                                                                             
# ls /lib                                                                                                                                                        
ld-2.3.3.so         libdl-2.3.3.so      libpthread-0.10.so                                                                                                       
ld-linux.so.2       libdl.so.2          libpthread.so.0                                                                                                          
libc-2.3.3.so       libgcc_s.so         libpthread_rt.so                                                                                                         
libc.so.6           libgcc_s.so.1       libstdc++.so.6                                                                                                           
libcrypt-2.3.3.so   libm-2.3.3.so       libstdc++.so.6.0.9                                                                                                       
libcrypt.so.1       libm.so.6                                                                                                                                    
# ./clocktest                                                                                                                                                    
./clocktest: error while loading shared libraries: libpthread_rt.so.1: cannot open shared object file: No such file or directory 
```

**编辑：**好的，我没有注意到末尾的 .1 是文件名的一部分。这到底是什么意思？

* * *

## 回答 #1

> 赞同：440
> 
> 时间：2014-01-16T22:07:14.560

您的库是一个动态库。您需要告诉操作系统它可以在运行时找到它的位置。

为此，我们需要执行以下简单步骤：

1.  如果您不知道，请查找图书馆的放置位置。

```
sudo find / -name the_name_of_the_file.so 
```

2.  检查动态库路径环境变量是否存在( `LD_LIBRARY_PATH`)

```
$ echo $LD_LIBRARY_PATH 
```

        如果没有要显示的内容，请添加默认路径值（如果您愿意，也可以不添加）

```
$ LD_LIBRARY_PATH=/usr/local/lib 
```

3.  我们添加所需的路径，将其导出并尝试应用程序。

请注意，路径应该是它所在的目录`path.so.something`。所以如果`path.so.something`在`/my_library/path.so.something`里面应该是：

```
$ LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/my_library/
$ export LD_LIBRARY_PATH
$ ./my_app 
```

[参考来源](https://www.gnu.org/software/gsl/doc/html/usage.html#shared-libraries)

* * *

## 回答 #2

> 赞同：207
> 
> 时间：2015-02-11T17:11:07.427

以下是您可以尝试的一些解决方案：

## 配置文件

正如 AbiusX 指出的那样：如果您刚刚安装了该库，您可能只需要运行[ldconfig](http://linux.die.net/man/8/ldconfig)。

```
sudo ldconfig 
```

> ldconfig 创建必要的链接并缓存到在命令行指定的目录、文件 /etc/ld.so.conf 和受信任的目录（/lib 和 /usr/lib）中找到的最新共享库。

通常，您的包管理器会在您安装新库时处理此问题，但并非总是如此，即使这不是您的问题，运行 ldconfig 也不会受到伤害。

## 开发包或错误版本

如果这不起作用，我还会查看[Paul 的建议](https://stackoverflow.com/a/480786/22781)并寻找库的“-dev”版本。许多库分为开发包和非开发包。您可以使用此命令来查找它：

```
apt-cache search <libraryname> 
```

如果您只是安装了错误版本的库，这也会有所帮助。一些库同时发布在不同的版本中，例如 Python。

## 图书馆位置

如果您确定安装了正确的软件包，但 ldconfig 没有找到它，那么它可能只是在一个非标准目录中。默认情况下，ldconfig 在`/lib`、`/usr/lib`和 中列出的目录中查找`/etc/ld.so.conf`和`$LD_LIBRARY_PATH`。如果您的库在其他地方，您可以在自己的行中添加目录`/etc/ld.so.conf`，将库的路径附加到`$LD_LIBRARY_PATH`，或将库移动到`/usr/lib`. 然后运行`ldconfig`。

要找出图书馆在哪里，试试这个：

```
sudo find / -iname *libraryname*.so* 
```

（替换`libraryname`为您的图书馆名称）

如果你走这`$LD_LIBRARY_PATH`条路，你会想把它放到你的`~/.bashrc`文件中，这样每次登录时它都会运行：

```
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/path/to/library 
```

* * *

## 回答 #3

> 赞同：148
> 
> 时间：2009-01-26T18:11:59.323

**更新**
虽然我在下面写的内容作为关于共享库的一般答案是正确的，但我认为这类消息的最常见原因是因为您安装了一个包，但没有安装该`-dev`包的版本。

* * *

好吧，这不是在说谎 -`libpthread_rt.so.1`该列表中没有。您可能需要重新配置和重新构建它，以便它依赖于您拥有的库，或者安装任何提供`libpthread_rt.so.1`.

一般来说，.so后面的数字是版本号，你会经常发现它们是相互的符号链接，所以如果你有libfoo.so的1.1版本，你就会有一个真实的文件libfoo.so.1.0，并且符号链接 foo.so 和 foo.so.1 指向 libfoo.so.1.0。如果您安装 1.1 版本而不删除另一个版本，您将拥有一个 libfoo.so.1.1，并且 libfoo.so.1 和 libfoo.so 现在将指向新版本，但任何需要该确切版本的代码都可以使用 libfoo.so.1.0 文件。仅依赖于版本 1 API，但不关心它是 1.0 还是 1.1 的代码将指定 libfoo.so.1。正如[orip](https://stackoverflow.com/users/37020/orip)在评论中指出的那样，这[在这里](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)得到了很好的解释。

在您的情况下，您*可能*会摆脱符号链接`libpthread_rt.so.1`到`libpthread_rt.so`. 但是，不能保证它不会破坏您的密码并吃掉您的电视晚餐。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2016-03-23T16:29:42.610

您需要确保在编译 .c 文件时在链接期间指定库路径：

```
gcc -I/usr/local/include xxx.c -o xxx -L/usr/local/lib -Wl,-R/usr/local/lib 
```

该`-Wl,-R`部分告诉生成的二进制文件也在`/usr/local/lib`运行时查找库，然后再尝试使用`/usr/lib/`.

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2014-07-07T13:21:29.387

尝试将`LD_LIBRARY_PATH`指示搜索路径的 添加到您的`~/.bashrc`文件中

```
LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/path_to_your_library 
```

有用！

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-01-27T06:01:39.610

linux.org[参考页面](https://www.linux.org/threads/linux-reference-page.8216/)解释了机制，但没有解释其背后的任何动机:-(

为此，请参阅[Sun Linker and Libraries Guide](http://download.oracle.com/docs/cd/E19253-01/817-1984/)

此外，请注意“外部版本控制”在 Linux 上已基本过时，因为符号版本控制（GNU 扩展）允许您在单个库中存在同一函数的多个不兼容版本。这个扩展允许 glibc 拥有相同的外部版本：`libc.so.6`过去 10 年。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-06-21T17:36:15.340

```
cd /home/<user_name>/
sudo vi .bash_profile 
```

在末尾添加这些行

```
LD_LIBRARY_PATH=/usr/local/lib:<any other paths you want>
export LD_LIBRARY_PATH 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2018-01-03T07:44:30.790

我遇到了类似的错误，但在 ~/.bashrc 中给出 LD_LIBRARY_PATH 并没有解决。解决我的问题的是添加 .conf 文件并加载它。转到终端并在 su 中。

```
gedit /etc/ld.so.conf.d/myapp.conf 
```

在此文件中添加您的库路径并保存。（例如：/usr/local/lib）。您必须运行以下命令来激活路径：

```
ldconfig 
```

验证您的新库路径：

```
ldconfig -v | less 
```

如果这显示了您的库文件，那么您就可以开始了。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-09-15T23:58:54.870

另一种可能的解决方案取决于您的情况。

如果您知道 libpthread_rt.so.1 与 libpthread_rt.so 相同，则可以通过以下方式创建符号链接：

```
ln -s /lib/libpthread_rt.so /lib/libpthread_rt.so.1 
```

然后`ls -l /lib`现在应该显示符号链接及其指向的内容。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-10-31T16:01:12.457

在 Linux x86 上使用 Eclipse CDT 运行我的应用程序时出现此错误。
要解决这个问题：

1.  在 Eclipse 中：

    > 运行方式 -> 运行配置 -> 环境

2.  设置路径

    ```
    LD_LIBRARY_PATH=/my_lib_directory_path 
    ```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-11-25T20:46:58.477

跑步：

```
sudo ldconfig 
```

足以解决我的问题。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-01-07T14:34:16.677

尝试安装*lib32z1*：

`sudo apt-get install lib32z1`

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-03-16T13:56:39.940

我所要做的就是运行：

```
sudo apt-get install libfontconfig1 
```

我在位于的文件夹中`/usr/lib/x86_64-linux-gnu`，它运行良好。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-02-27T12:33:35.910

如果您在 Microsoft Windows 上运行应用程序，则`.dll`需要在`PATH`环境变量中定义动态库 ( ) 的路径。

如果您在 UNIX 上运行应用程序，则`.so`需要在`LD_LIBRARY_PATH`环境变量中定义动态库 ( ) 的路径。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-06-21T15:51:01.430

想要添加，如果您的库位于非标准路径中，请在路径后运行`ldconfig`。

例如我必须运行：

```
sudo ldconfig /opt/intel/oneapi/mkl/2021.2.0/lib/intel64 
```

使 R 针对英特尔 MKL 进行编译

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-11-04T05:34:39.143

由于系统无法引用提到的库文件，因此发生错误。采取以下步骤：

1.  运行`locate libpthread_rt.so.1`将列出具有该名称的所有文件的路径。假设路径是`/home/user/loc`。
2.  复制路径并运行`cd home/USERNAME`。将 USERNAME 替换为要运行文件的当前活动用户的名称。
3.  运行`vi .bash_profile`并在`LD_LIBRARY_PATH`参数末尾，就在 之前`.`，添加行`/lib://home/usr/loc:.`. 保存文件。
4.  关闭终端并重新启动应用程序。它应该运行。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-06-19T17:47:49.540

我收到了这个错误，我认为这与你的原因相同

> 加载共享库时出错：libnw.so：无法打开共享对象文件：没有这样的文件或目录

试试这个。修复文件的权限：

```
cd /opt/Popcorn (or wherever it is) 
chmod -R 555 * (755 if not ok) 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-06-02T17:06:48.873

我使用 Ubuntu 18.04

安装相应的`-dev`软件包对我有用，

```
sudo apt install libgconf2-dev 
```

在安装上述软件包之前，我收到以下错误：

```
turtl: error while loading shared libraries: libgconf-2.so.4: cannot open shared object file: No such file or directory 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-04-07T09:36:02.713

我收到了这个错误，我认为这与你的原因相同

```
error while loading shared libraries: libnw.so: cannot open shared object 
file: No such file or directory 
```

试试这个。**修复**文件的权限：

```
sudo su
cd /opt/Popcorn (or wherever it is) 
chmod -R 555 * (755 if not ok) 
chown -R root:root * 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-07-10T00:55:51.913

可以在 [此处](https://bugzilla.redhat.com/show_bug.cgi?id=1456202)找到类似的问题。我已经尝试过上述解决方案，它确实有效。

前面问题中的解决方案可能有效。但以下是修复它的简单方法。它通过`libwbclient` 在 fedora 中重新安装软件包来工作：

```
dnf reinstall libwbclient 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2022-01-30T15:21:38.183

您可以在此处阅读有关库的信息： [https ://domiyanyue.medium.com/c-development-tutorial-4-static-and-dynamic-libraries-7b537656163e](https://domiyanyue.medium.com/c-development-tutorial-4-static-and-dynamic-libraries-7b537656163e)

# f# - F# 匹配两个值

> ID：480769
> 
> 赞同：4
> 
> 时间：2009-01-26T18:08:41.157
> 
> 标签：f#, pattern-matching

我对 F# 很陌生，我想用 (match ... with ...) 语法比较两个值

当我尝试像这样比较两个值时会出现问题：

```
let value1 = 19
let isValue1 y =
    match y with
    | value1 -> y + 1
    | _ -> y 
```

我收到一条警告，永远无法到达代码的“| _ -> y”部分。为什么是这样？

我知道我可以执行以下操作以使该功能按我想要的方式工作：

```
let value1 = 19
let isValue1 y =
    match y with
    | _ when y = value1 -> true
    | _ -> false 
```

这也有效

```
let value1 = 19
let isValue1 y =
    match y with
    | 19 -> true
    | _ -> false 
```

我只是好奇为什么我不能这样做，以及 match 是如何工作的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-26T18:15:16.383

match 语句中的 value1 被定义为一个新变量，其值设置为 y（作为匹配项）。上面定义的 value1 将被忽略，就像您在 C# 函数中声明一个与类变量同名的局部变量一样。出于这个原因，第一个匹配条件将匹配*所有内容*，而不仅仅是先前定义的 value1 值，因此会出现错误。希望澄清问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-26T18:25:17.457

模式匹配既是一种控制结构（接下来执行什么代码），又是一种绑定结构（如“let”，将名称绑定到值）。所以当你这样做时

```
match expr with
| name -> ... 
```

模式（“名称”）始终匹配，并且标识符“名称”只是绑定到表达式的值。这就是为什么模式匹配主要用于区分联合（案例类型），您可以根据结构进行匹配。例如

```
match someOption with
| Some(x) -> ... // binds x
| None -> ...

match someList with
| h :: t -> ... // binds h and t to head/tail
| [] -> ... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-01T20:48:19.030

您可以将输入与`[<Literal>]`属性标记的文字/标识符匹配，而无需绑定它。

例如：

```
#light
[<Literal>]
let E  = 2.718281828459

let isE x =
    match x with
    | E -> true
    | _ -> false

print_any (isE 3.2)
print_any (isE E) 
```

根据[克里斯史密斯的说法](http://blogs.msdn.com/chrsmith/archive/2008/10/03/f-zen-the-literal-attribute.aspx)

# algorithm - 以编程方式获得代码的 Big-O 效率

> ID：480775
> 
> 赞同：39
> 
> 时间：2009-01-26T18:09:55.367
> 
> 标签：algorithm, complexity-theory

我想知道是否有任何自动方法来确定（至少粗略地）给定函数的 Big-O 时间复杂度？

如果我绘制一个 O(n) 函数与一个 O(n lg n) 函数，我想我将能够直观地确定哪个是哪个；我认为必须有一些启发式解决方案可以自动完成。

有任何想法吗？

**编辑：**我很高兴找到一个半自动化的解决方案，只是想知道是否有某种方法可以避免进行完全手动分析。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-26T18:15:29.053

听起来您要求的是停机问题的扩展。我不相信这样的事情是可能的，即使在理论上也是如此。

只需回答“这行代码会运行吗？”这个问题。在一般情况下，即使不是不可能，也将非常困难。

编辑添加：虽然一般情况是棘手的，见这里部分解决方案：[http ://research.microsoft.com/apps/pubs/default.aspx?id=104919](http://research.microsoft.com/apps/pubs/default.aspx?id=104919)

此外，有些人说手动分析是唯一的选择，但我不认为这真的是正确的看待它的方式。即使将人添加到系统/机器中，一个棘手的问题仍然是棘手的。经过进一步思考，我认为 99% 的解决方案可能是可行的，甚至可能与人类一样好或更好。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-01-26T18:15:02.843

您可以在各种大小的数据集上运行该算法，然后您可以使用曲线拟合来得出一个近似值。（在大多数情况下，仅查看您创建的曲线可能就足够了，但任何统计包都有曲线拟合）。

请注意，一些算法在小数据集上表现出一种形状，但在大数据集上表现出另一种形状......而且大的定义仍然有点模糊。这意味着具有良好性能曲线的算法可能具有如此多的现实世界开销，以至于（对于小型数据集）它的效果不如理论上更好的算法。

至于*代码检查*技术，不存在。但是检测您的代码以各种长度运行并输出一个简单的文件（RunSize RunLength 就足够了）应该很容易。生成正确的测试数据可能会更复杂（某些算法对部分排序的数据效果更好/更差，因此您可能希望生成*代表您的正常用例的*数据）。

由于“什么是大”的定义存在问题以及性能取决于数据这一事实，我发现静态分析通常具有误导性。在优化性能并在两种算法之间进行选择时，现实世界中的“橡胶上路”测试是我唯一信任的最终仲裁者。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-26T18:56:17.050

一个简短的回答是**这是不可能的，因为常量很重要**。

例如，我可能会编写一个在`O((n^3/k) + n^2)`. 这简化为 O(n^3) 因为随着 n 接近无穷大，该项`n^3`将支配函数，而与常数无关`k`。

但是，如果`k`在上面的示例函数中非常大，则该函数将几乎完全运行，`n^2`直到某个交叉点，在该交叉点，该`n^3`术语将开始占主导地位。因为任何分析工具都不知道该常数`k`，所以不可能知道用于测试目标函数的数据集有多大。如果`k`可以任意大，则无法制作测试数据来确定大哦运行时间。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-01-26T20:59:33.870

我很惊讶看到有如此多的尝试声称可以通过秒表“测量”复杂性。有几个人给出了正确的答案，但我认为仍有空间将要点带回家。

1.  算法复杂性不是“编程”问题；这是一个“计算机科学”问题。回答这个问题需要从数学家的角度分析代码，因此计算 Big-O 复杂度实际上是一种数学证明形式。它需要对基本的计算机操作、代数、微积分（极限）和逻辑有非常深刻的理解。没有多少“测试”可以替代该过程。

2.  停止问题适用，因此算法的复杂性基本上无法由机器确定。

3.  [自动化工具的限制适用](http://c2.com/cgi/wiki?ProgrammingIsInTheMind)，因此可以编写一个程序来提供帮助，但它只能提供与计算器帮助完成物理作业一样多的帮助，或者与重构浏览器帮助重组一个代码库。

4.  对于认真考虑编写此类工具的任何人，我建议进行以下练习。选择一个相当简单的算法，比如你最喜欢的排序，作为你的主题算法。获取可靠的参考资料（书籍、基于网络的教程），引导您完成计算算法复杂度并最终计算“Big-O”的过程。在您使用主题算法完成整个过程时记录您的步骤和结果。执行这些步骤并记录您在几种情况下的进度，例如最佳情况、最坏情况和平均情况。完成后，查看您的文档并问自己编写程序（工具）为您完成它需要什么。可以做到吗？实际上有多少是自动化的，还有多少是手动的？

最良好的祝愿。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-26T18:43:01.447

我很好奇为什么你希望能够做到这一点。根据我的经验，当有人说：“我想确定这个算法的运行时复杂性”时，他们并没有问他们认为他们在问什么。您最有可能问的是这种算法对可能数据的实际性能是什么。计算函数的 Big-O 具有合理的实用性，但是在实际使用中，有很多方面可以改变算法的“实际运行时性能”，没有什么比仪器和测试更好的了。

例如，以下算法具有完全相同的 Big-O（古怪的伪代码）：

示例一：

```
huge_two_dimensional_array foo
for i = 0, i < foo[i].length, i++
  for j = 0; j < foo[j].length, j++
    do_something_with foo[i][j] 
```

示例 b：

```
huge_two_dimensional_array foo
for j = 0, j < foo[j].length, j++
  for i = 0; i < foo[i].length, i++
    do_something_with foo[i][j] 
```

同样，完全相同的 big-O... 但其中一个使用行序数，其中一个使用列序数。事实证明，由于引用的局部性和缓存一致性，您可能有两个*完全*不同的实际运行时，尤其是取决于数组 foo 的实际大小。如果它是具有内置并发性的软件的一部分，这甚至还没有开始触及算法行为的实际性能特征。

不要成为一个消极的人，但大O是一个范围狭窄的工具。如果您深入了解算法分析，或者如果您试图*证明*某个算法的某些内容，那么它非常有用，但是如果您正在做商业软件开发，那么证明就在布丁中，并且您将想要获得实际的性能数据做出明智的决定。

干杯!

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-26T18:14:26.370

这可能适用于简单的算法，但是 O(n^2 lg n) 或 O(n lg^2 n) 呢？

你很容易在视觉上被愚弄。

如果它是一个非常糟糕的算法，也许它甚至在 n=10 时也不会返回。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-26T18:45:12.860

很多人评论说，这在理论上是一个天生无法解决的问题。很公平，但除此之外，即使解决最微不足道的情况似乎也非常困难。

假设您有一个具有一组嵌套循环的程序，每个循环都基于数组中的项目数。O(n^2)。但是，如果内部循环只在一组非常特定的情况下运行呢？比如说，平均而言，它在 aprox log(n) 案例中运行。突然间，我们“显然”的 O(n^2) 算法实际上是 O(n log n)。编写一个可以确定内部循环是否会运行以及运行频率的程序可能比原始问题更困难。

记住 O(N) 不是上帝；高常数可以而且将会改变竞争环境。快速排序算法当然是 O(n log n)，但是当递归变得足够小时，比如减少到 20 项左右，快速排序的许多实现会将策略更改为单独的算法，因为执行不同类型的排序实际上更快，比如说插入排序的 O(N) 更差，但常数要小得多。

因此，了解您的数据，进行有根据的猜测并进行测试。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-15T21:09:40.583

证明这是不可判定的：

假设我们有一些算法 HALTS_IN_FN(Program, function) 确定程序是否在 O(f(n)) 中停止对于所有 n，对于某个函数 f。

令 P 为以下程序：

```
if(HALTS_IN_FN(P,f(n)))
{
    while(1);
}
halt; 
```

由于函数和程序是固定的，因此该输入上的 HALTS_IN_FN 是恒定时间。如果 HALTS_IN_FN 返回 true，程序将永远运行，当然对于任何 f(n) 都不会在 O(f(n)) 中停止。如果 HALTS_IN_FN 返回 false，程序会在 O(1) 时间内停止。

因此，我们有一个悖论，一个矛盾，所以程序是不可判定的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-26T18:19:20.447

运行此类基准测试时还必须小心。一些算法将具有严重依赖于输入类型的行为。

以快速排序为例。这是最坏情况的 O(n²)，但通常是 O(nlogn)。对于相同大小的两个输入。

旅行推销员是（我认为，不确定）O（n²）（*编辑：蛮力算法的正确值为0（n！）*），但大多数算法更快地获得相当好的近似解。

这意味着基准测试结构在大多数情况下必须在特定的基础上进行调整。想象一下为上面提到的两个例子写一些通用的东西。这将非常复杂，可能无法使用，并且可能会给出不正确的结果。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-26T18:21:06.280

我认为自动执行此操作几乎是不可能的。请记住，O(g(n)) 是最坏情况的上限，许多函数的性能优于许多数据集。您必须找到每个数据集的最坏情况数据集才能进行比较。对于许多算法来说，这本身就是一项艰巨的任务。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-26T18:33:47.033

Jeffrey L Whitledge 是正确的。停止问题的简单简化证明这是不可判定的......

另外，如果我可以编写这个程序，我会用它来解决 P 与 NP，并有 100 万美元...... B-)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-08-04T19:06:50.137

我正在使用一个`big_O`库（[此处链接](https://github.com/pberkes/big_O)），该库适合自变量的执行时间变化`n`来推断增长类的顺序`O()`。

该软件包通过针对每个类别增长行为测量收集数据的残差来自动建议最佳拟合类别。

检查[此答案](https://stackoverflow.com/a/51681618/7055815)中的代码。

输出示例，

```
Measuring .columns[::-1] complexity against rapid increase in # rows
--------------------------------------------------------------------------------
Big O() fits: Cubic: time = -0.017 + 0.00067*n^3
--------------------------------------------------------------------------------
Constant: time = 0.032                                        (res: 0.021)
Linear: time = -0.051 + 0.024*n                               (res: 0.011)
Quadratic: time = -0.026 + 0.0038*n^2                         (res: 0.0077)
Cubic: time = -0.017 + 0.00067*n^3                            (res: 0.0052)
Polynomial: time = -6.3 * x^1.5                               (res: 6)
Logarithmic: time = -0.026 + 0.053*log(n)                     (res: 0.015)
Linearithmic: time = -0.024 + 0.012*n*log(n)                  (res: 0.0094)
Exponential: time = -7 * 0.66^n                               (res: 3.6)
-------------------------------------------------------------------------------- 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-26T18:14:56.400

我想这是不可能以全自动方式实现的，因为输入的类型和结构在函数之间有很大差异。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-26T18:22:12.360

好吧，既然你无法证明一个函数是否会停止，我认为你的要求有点高。

否则@Godeke 有它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-29T10:39:59.127

我不知道你这样做的目的是什么，但我们在我教的一门课程中遇到了类似的问题。学生们被要求实现一些在一定复杂性下工作的东西。

为了不手动查看他们的解决方案并阅读他们的代码，我们使用了@Godeke 建议的方法。目标是找到使用链表而不是平衡搜索树的学生，或者实现冒泡排序而不是堆排序的学生（即，在所需复杂度下无法工作的实现——但没有实际阅读他们的代码）。

令人惊讶的是，结果并没有发现作弊的学生。这可能是因为我们的学生很诚实并且想要学习（或者只是知道我们会检查这个;-)）。如果输入很小，或者输入本身是有序的，则可能会错过作弊学生。没有作弊但具有较大常数值的学生也可能出错。

但尽管可能存在错误，但还是值得的，因为它节省了大量的检查时间。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-12-08T23:56:56.213

正如其他人所说，这在理论上是不可能的。但在实践中，只要您不介意有时会出错，您*就可以对函数是 O(* *n* ) 还是 O( *n* ^2)做出有根据的猜测。

第一次算法，在各种*n*的输入上运行它。[在对数图](http://en.wikipedia.org/wiki/Log-log_graph)上绘制点。通过这些点绘制最佳拟合线。如果这条线很好地拟合了所有点，那么数据表明该算法是 O( *n* ^ *k* )，其中*k*是线的斜率。

我不是统计学家。你应该对这一切持保留态度。但我实际上是在性能回归的自动化测试的背景下做到这一点的。[这里的补丁](https://bugzilla.mozilla.org/show_bug.cgi?id=433909)包含一些 JS 代码。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2009-01-26T18:25:33.477

如果你有很多同质的计算资源，我会根据几个样本对它们进行计时并进行线性回归，然后简单地取最高项。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2009-01-26T18:54:30.657

很容易得到指示（例如“函数是线性的吗？次线性的？多项式？指数的”）

很难找到确切的复杂性。

例如，这是一个 Python 解决方案：您提供函数，以及为其创建大小为 N 的参数的函数。您将返回一个 (n,time) 值列表以进行绘图或执行[回归分析](http://en.wikipedia.org/wiki/Regression_analysis)。它为速度计时一次，为了得到一个非常好的指示，它必须多次计时以最大限度地减少环境因素的干扰（例如使用[timeit](http://docs.python.org/library/timeit.html)模块）。

```
import time
def measure_run_time(func, args):
  start = time.time()
  func(*args)
  return time.time() - start

def plot_times(func, generate_args, plot_sequence):
  return [
    (n, measure_run_time(func, generate_args(n+1)))
    for n in plot_sequence
  ] 
```

并用它来计时冒泡排序：

```
def bubble_sort(l):
  for i in xrange(len(l)-1):
    for j in xrange(len(l)-1-i):
      if l[i+1] < l[i]:
        l[i],l[i+1] = l[i+1],l[i]

import random
def gen_args_for_sort(list_length):
  result = range(list_length) # list of 0..N-1
  random.shuffle(result) # randomize order
  # should return a tuple of arguments
  return (result,)

# timing for N = 1000, 2000, ..., 5000
times = plot_times(bubble_sort, gen_args_for_sort, xrange(1000,6000,1000))

import pprint
pprint.pprint(times) 
```

这打印在我的机器上：

```
[(1000, 0.078000068664550781),
 (2000, 0.34400010108947754),
 (3000, 0.7649998664855957),
 (4000, 1.3440001010894775),
 (5000, 2.1410000324249268)] 
```

# asp.net - 将文件输入类型发布到表单

> ID：480809
> 
> 赞同：0
> 
> 时间：2009-01-26T18:15:34.527
> 
> 标签：asp.net, html, request

首先我必须说我的问题发生在我试图发布到另一个表单时。

我在一个表单中有 3 个控件： 1\. 名为“text1”的文本输入。2.文件输入名为“file1”。3\. 提交输入。

表单本身有一个发布到另一个页面的方法。在发布页面的页面加载中，我使用的是 Request["text1"]，它给了我“text1”的文本。当我是 Request["file1"] 我什么也没得到。

帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-26T18:17:09.423

您需要*enctype="multipart/form-data"*在您的打开表单标签中。

```
<form method="post" action="somepage.php" enctype="multipart/form-data">
...
</form> 
```

如果这没有帮助，[4GuysFromRolla](http://www.4guysfromrolla.com)有一篇关于这个主题的文章：

### [在 ASP.NET 中上传](http://www.4guysfromrolla.com/webtech/091201-1.shtml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T18:35:29.417

Request["file1"] 不是一个字符串，它是一个文件，所以你不能这样偷看它。它的处理方式取决于您使用的服务器大小的平台。

# search - “查找”和“搜索”之间的语义区别？

> ID：480811
> 
> 赞同：33
> 
> 时间：2009-01-26T18:15:39.003
> 
> 标签：search, find, naming, semantics

在构建应用程序时，“查找”与“搜索”的概念之间是否有任何有意义的区别？你认为它们或多或少是同义词吗？

我问的是应用程序 UI 的标签以及 API 设计。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-01-26T18:18:09.030

寻找是寻找的完成。

如果您可能无法成功找到某些内容，请调用该功能“搜索”。例如，编辑器中的文本搜索可能会由于没有匹配而失败 - 然后称其为“查找”将是在撒谎。

另一方面：在一个已建立的求职网站中，您可以说“找一份 PHP 工作”，因为您知道（几乎）任何您的用户想要的东西，都会有报价。这也使它听起来自信、积极和充满活力。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-26T19:02:31.203

根据[Steve Krug](http://www.sensible.com/index.html)在[Don't Make Me Think](http://sensible.com/dmmt.html)中的说法，在谈论面向公众的网站的可用性时，使用 Search 一词**表示**搜索框，仅此而已。（他明确禁止“查找”、“快速查找”、“快速搜索”和所有变体。）

基本原理是“搜索”是最常被理解的术语，所以这是人们在不思考时会寻找的内容，并且您不希望您的用户必须（根本）思考。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-01-26T18:38:19.177

我会说“查找”专注于获得一个单一的精确匹配。如上例所示，您“找到”了完美的 PHP 工作。

OTOH，您“搜索”符合您条件的工作。搜索是您想要浏览多个结果时所做的事情。“搜索”返回结果页面。“找到”更接近于“我感觉很幸运”。

当然，这些术语有时可以互换使用。但是，我认为这就是差异的本质。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-26T18:32:21.747

在许多应用程序中，find 的意思是“在当前页面/屏幕上查找”，而 search 的意思是“搜索整个数据库/Internet”。Web 浏览器、在线帮助和其他应用程序似乎做出了这种区分。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-26T23:50:22.667

在*大多数*应用程序中...

**查找** *通常*是指在手头的文档中定位文本并跳转到下一个匹配项。

**搜索** *通常*是指定位多个文档（或其他对象）并返回一个列表。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-26T18:55:18.817

我在 Acrobat 1.0 中编写了内置的 Find 命令，并为 Acrobat 2.0 和 3.0 开发了全文搜索引擎。当时处理大量文本的大多数软件都可以找到与单个单词或短语完全匹配的方法，并将其称为 Find/Find Next。这就是我们在 Acrobat 1.0 中所称的。我们从一开始就知道这不足以处理整个文档存储库，因此我们需要一种方法来扫描整个集合。我们不能使用 Find，因为它已经在 UI 中并且已经建立了行为，所以我们选择了 Search。该决定仅基于传达动作的相对较小的一组常用词。

更难的是为它设计一个合理的图标。我们最初的想法是使用类似于旧黄页标志的东西：

[![替代文字](https://i.stack.imgur.com/k7KCX.gif)](https://i.stack.imgur.com/k7KCX.gif)
[（来源：[yellowpagecity.com](http://www.yellowpagecity.com/images/ypc-icon.gif)）]

但律师将其击落 - 它太近了。我们不能使用放大镜，因为我们有与之相关的缩放功能。我们带着双筒望远镜去了。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-26T18:18:26.877

我不认为有任何区别。

但话又说回来，我是葡萄牙人。:P

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-06-26T14:21:18.027

**查找**= 发现确切示例：我们在电子邮件中写下“请查找附件”。我们不写“请搜索附件”。

**搜索**= 发现完全匹配 + 相关匹配示例：Google 搜索

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-26T18:21:07.013

“*寻找*，你就会*找到*”

“*搜索*，你会*发现*”

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-12-19T06:19:26.033

（令人惊讶的是）没有人提到的一个角度是，在英语中，当您说您搜索*某物*时，某物是您在*内部*搜索的东西，而不是您试图找到的东西。因此，除非您添加“for”一词（例如，搜索*某物*），否则这两个词是根本不同的。

举个例子就很明显了：

1.  找到房间。
2.  搜索房间。

两个截然不同的任务！第一个定义您的搜索对象。第二个定义您的搜索范围。

在谈论 UI 时，这并非完全无关紧要。如果您的应用具有搜索功能，用户可以指定搜索的来源和对象，您可以选择以这种方式使用这些词。例如：

1.  搜索：当前文档
2.  发现：“积极向上”

是的，正如其他一些人指出的那样，“查找”一词确实意味着成功的搜索，但是当不能保证成功时，我们不要开始称应用程序设计师为骗子使用它。它已成为在文档中搜索特定字符串的非常标准的术语。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-26T18:19:00.120

我认为搜索更通用，更适合文本搜索。查找听起来更像是“查找特定记录或一组记录”

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-26T18:19:52.537

搜索后你发现了一些东西。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-03-11T14:38:04.643

**在 stackoverflow 上搜索您可能会****找到**的答案。

对我来说 Find 是一个 Search 的**成功**，也就是说 Find 是识别**已知**存在的东西的位置。

*当您无法控制用户正在查找*的内容时，应始终使用搜索。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-01-14T03:45:25.973

查找有关特定内容的讨论。
搜索不谈论特定的。

```
Did you find the picture I requested yet?
No? Please search on internet. I need to present it in an hour. 
```

下面还有一个

```
Please find the attachment in this email.
  (or)
You'll find the attachment below.
  (or)
Please find attached. 
```

在这里，我们使用 find 是因为它是附加到电子邮件的特定文档。
我们在这里不使用搜索，因为在更大的域中没有什么可搜索的。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2016-01-14T19:40:52.377

**搜索**是许多用户访问 Web 的主要界面。**搜索**应该是全局的（不限于子站点）并且可以在每个页面上使用；布尔值应该令人生畏，因为用户通常会错误地使用它们

**阅读：** [https ://www.nngroup.com/articles/search-and-you-may-find/](https://www.nngroup.com/articles/search-and-you-may-find/)

# mysql - 在 Rails 环境中打开一个单独的 MySQL 连接是不是一个坏主意？

> ID：480825
> 
> 赞同：2
> 
> 时间：2009-01-26T18:19:10.823
> 
> 标签：mysql, ruby-on-rails, stored-procedures

我处于需要从 Rails 调用存储过程的情况。我可以做到，但它要么破坏 MySQL 连接，要么是[一个伪黑客，需要对存储的 procs 进行奇怪的更改](https://stackoverflow.com/questions/471517/is-it-possible-to-call-a-mysql-stored-procedure-from-ruby)。加上伪黑客不能返回大量数据。

现在我的解决方案是直接使用`system()`和调用`mysql`命令行。我认为一个不那么悲伤的解决方案是独立于 Active Record 的连接打开我自己的 MySQL 连接。

我不知道为什么这会很糟糕。但我也不太了解 MySQL 的内部结构，无法知道它是 100% 安全的。

它将巧妙地解决我的问题，因为需要调用存储过程的控制器操作将打开一个新的数据库连接，进行调用并关闭它。我可能会牺牲一些性能，但如果它有效，那就足够了。它还解决了同一进程中的多个用户（我们目前使用 mongrel）在边缘轨道中的问题，现在它最终是线程安全的，因为 hack 需要两个 sql 查询，我认为我不能保证我正在使用通过 Active Record 建立相同的数据库连接。

那么，这是一个坏主意和/或危险吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T19:23:27.213

Ruby on Rails 通常避开存储过程，或在数据库中实现任何其他业务逻辑。有人可能会说您一开始就没有遵循“Rails 方式”来调用存储过程。

但是，如果您必须调用存储过程，IMO 从 Ruby 打开第二个连接肯定比使用`system()`. 后一种方法无论如何都会打开到 MySQL 的第二个连接，而且它会产生分叉一个进程来运行 mysql 客户端的开销。

您应该查看Maik Schmidt 的“[使用 Ruby 和 Rails 的企业食谱”。](http://pragprog.com/titles/msenr/enterprise-recipes-with-ruby-and-rails)它有一章关于从 Rails 调用存储过程。

MySQL 可以为每个请求处理多个连接，尽管它会增加数据库服务器的负载。您应该以“懒惰”的方式打开第二个连接，只有当您确定在给定请求上需要它时。

无论如何，如果性能在这个应用程序中很重要，那么您就不会使用 Rails！>:-)

（开玩笑！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T19:31:02.723

考虑到 RoR 与它自己对 dbms 使用的看法是多么紧密地交织在一起，您可能**应该**为它不为您管理的任何交互打开到数据库的第二个连接，如果没有别的，仅用于 SoC 目的。从您的描述中听起来这也是最简单的方法，这通常是一个强烈的积极信号。

来自其他语言（尤其是 PHP）的应用程序会定期打开多个连接（这并不理想，但至少它表明 mysql 不会反对。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T17:59:53.643

从那以后，我们尝试了来自 github 的最新 mysql gem，即使这样也不能解决问题。

我们已经修补了 Rails 中的 mysql 适配器，并且确实有效。它所做的只是确保 MySQL 连接在继续之前没有更多结果。

I'm not accepting this answer, yet, because I don't feel 100% that the fix is a good one. We haven't done quite enough testing. But I wanted to put it out there for anyone else looking at this question.

# database - 我可以编写一个从多个表中删除的过程吗？

> ID：480827
> 
> 赞同：1
> 
> 时间：2009-01-26T18:19:27.063
> 
> 标签：database, stored-procedures

我找到的所有程序帮助仅用于特定目的。

我可以写一个表来截断几个表吗？

类似于（但这不起作用）

```
CREATE PROCEDURE clearall()
  BEGIN
    truncate tallgrrl.auth;
    truncate tallgrrl.factory;
    truncate tallgrrl.farm;
    truncate tallgrrl.player;
    truncate tallgrrl.timer;
  END; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-26T18:20:06.517

绝对地。存储过程的目的之一是封装逻辑/多个操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-26T18:23:26.447

如果您与该表有关系，则截断可能不起作用，在这种情况下您需要

使用删除

删除关系截断表并重新创建关系

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T18:21:53.733

我不知道为什么你的 TRUNCATE 不起作用。我已经存储了 TRUNCATE 表的过程。您使用的是什么数据库平台？

您的 TRUNCATE 是否在 SP 之外工作？正如 SQLMenace 所提到的，您不能在具有 FK 依赖项的表上使用 TRUNCATE。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T18:57:03.150

尝试切换到“从 [table name] 中删除”，因为由于权限问题，截断可能无法正常工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T23:44:09.013

您可能需要更改截断的顺序，以便在引用它们的数据之前不会截断外键。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T19:22:20.773

你应该能够。也许您以错误的顺序进行截断（并且违反了完整性约束。例如，您不能删除父级，直到没有子级挂在它上面。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T18:51:33.130

你得到什么错误？

除了前面提到的 FK 潜在问题外，根据执行 proc 的用户的权限，您可能没有截断权限。

# .net - WCF 流合同

> ID：480847
> 
> 赞同：1
> 
> 时间：2009-01-26T18:25:12.823
> 
> 标签：.net, asp.net, wcf, streaming

我正在尝试使用 basicHttpBinding 设置流式 WCF 服务。该服务托管在 IIS7 进程中。

合约包含一个简单的 Stream GetStream() 操作。

当我使用服务参考连接一个简单的客户端时，我从服务器得到以下结果。

内容类型多部分/相关；type="application/xop+xml";start=" [http://tempuri.org/0](http://tempuri.org/0) ";boundary="uuid:9520d099-4241-43f3-824d-5a3d197f62ed+i​​d=1";start-info="text /xml" 不受服务[http://localhost:6000/StreamingTest.svc](http://localhost:6000/StreamingTest.svc)的支持。客户端和服务绑定可能不匹配。

这是客户端上的绑定配置。名为“streaming_IStreamingTestService”的绑定部分是服务器上的精确副本。Ctrl+X。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="streaming_IStreamingTestService" closeTimeout="00:01:00"
                    openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                    allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                    maxBufferSize="655360" maxBufferPoolSize="655360" maxReceivedMessageSize="655360"
                    messageEncoding="Mtom" transferMode="Streamed" useDefaultWebProxy="true">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                    <security mode="None">
                        <transport clientCredentialType="None" proxyCredentialType="None"
                            realm="" />
                        <message clientCredentialType="UserName" algorithmSuite="Default" />
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://localhost:8000/StreamingTest.svc"
                binding="basicHttpBinding" bindingConfiguration="streaming_IStreamingTestService"
                contract="Services.StreamingTest.IStreamingTestService" name="streaming_IStreamingTestService" />
        </client>
    </system.serviceModel>
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-03T22:14:56.680

相关的错误部分是“客户端和服务绑定可能不匹配”。

由于您在服务器上使用传输模式“Streamed”，而“Buffered”是默认值，这可能是不匹配的。

# c++ - Windows 代码页与标准 C/C++ 文件名的交互？

> ID：480849
> 
> 赞同：6
> 
> 时间：2009-01-26T18:25:31.653
> 
> 标签：c++, c, character-encoding, filenames

一位客户抱怨我们的代码用于编写文件名中包含日文字符的文件，但不再适用于所有情况。我们一直只是使用良好的旧 char * 字符串来表示文件名，所以它曾经工作过让我有点震惊，而且我们没有做任何我知道应该让它停止工作的事情。我让他们向我发送了一个从我们的软件导出的带有嵌入文件名的文件，看起来这些字符串使用十六进制字符 82 和 83 作为双字节序列的第一个字符来表示日文字符。在网上闲逛让我相信这可能是 SHIFT_JIS 和/或 Windows 代码页 932。

在我看来，以前发生的事情是 fopen 和 ofstream::open 使用此代码页接受的文件名；现在只有 fopen 可以。我已经检查了 Visual Studio fopen 文档，但我没有看到任何提示可以将可接受的字符串传递给 fopen。

在短期内，我希望有人能为我阐明特定的 Windows fopen 与 ofstream::open 问题。从长远来看，我真的很想知道在 C++、Windows、Linux 和 OS X 上打开 Unicode（和其他？）文件名的公认方式。

编辑添加：我相信工作的打开是在“C”语言环境中完成的，而那些不工作的打开是在客户的默认语言环境中完成的。但是，这种情况已经存在多年了，旧版本的程序今天仍然可以在他们的系统上运行，所以这似乎无法解释我们所看到的问题。

更新：我向客户发送了一个小型测试程序。它已经验证 fopen 可以与 SHIFT_JIS 文件名一起正常工作，而 std::ofstream 不能。这是在 Visual Studio 2005 中，无论我使用的是默认语言环境还是“C”语言环境，都会发生这种情况。

如果有人对这种行为有解释（以及为什么它神秘地改变了——也许是 VS2005 的服务包？），我仍然很感兴趣，并希望将一个全面的“最佳实践”放在一起处理可移植 C++ 代码中的 Unicode 文件名。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T09:36:34.087

fopen 或 ofstream::open 之类的函数将文件名作为 char *，但这被解释为在系统代码页中。

这意味着它可以是表示为 Shift-JIS (cp932) 的日文字符，也可以是简体中文 (Big 5/cp936)、韩文、阿拉伯文、俄文，你可以命名它（只要它与 OS 系统代码页匹配）。

这也意味着它只能在日文系统上使用日文文件名。更改系统代码页和应用程序“停止工作”我怀疑这就是这里发生的事情（自 Win 2000 以来，Windows 在这方面没有大的变化）。

这是您更改系统代码页的方式：http: [//www.mihai-nita.net/article.php?artID=20050611a](http://www.mihai-nita.net/article.php?artID=20050611a)

从长远来看，您可能会考虑迁移到 Unicode（并使用 _wfopen、wofstream）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T08:42:56.983

我不知道使用默认系统库使用 unicode 文件的任何可移植方式。但是有一些框架提供了可移植的功能，例如：

*   对于 C：[glib](http://library.gnome.org/devel/glib/2.18/glib-File-Utilities.html)使用 UTF-8 格式的文件名；
*   对于 C++：[glibmm](http://www.gtkmm.org/docs/glibmm-2.4/docs/reference/html/classGio_1_1File.html)也使用 UTF-8 格式的文件名，需要 glib；
*   对于 C++：[boost](http://www.boost.org/doc/libs/1_37_0/libs/filesystem/doc/i18n.html)可以使用 wstring 作为文件名。

我很确定 .NET/mono 框架也确实包含可移植文件系统功能，但我不知道它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-09T19:41:52.107

有人还在看这个吗？我刚刚研究了这个问题，但在任何地方都没有找到答案，所以我可以在这里尝试解释我的发现。

在 VS2005 中，fstream 文件名处理是一个奇怪的人：它不使用系统默认编码，您可以使用 GetACP 获得并在控制面板/区域和语言/管理中设置。但总是 CP 1252——我相信。

这可能会造成很大的混乱，微软已经在以后的 VS 版本中删除了这个怪癖。

VS2005 的所有解决方法都有其缺点：

1.  转换您的代码以在任何地方使用 Unicode

2.  永远不要使用窄字符文件名打开 fstream，始终使用系统默认编码将它们转换为 Unicode，使用宽字符文件名 open/ctor

3.  使用 GetACP() 检索代码页，然后执行

匹配的setlocale：

```
setlocale (LC_ALL, ("." + lexical_cast<string> (GetACP())).c_str()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T10:30:16.747

Mac OS X 使用 Unicode 作为其本机字符编码。基本的字符串对象是 CFString 和 NSString。它们将字符数组存储为 Unicode。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T18:41:53.600

我几乎可以肯定，在 Linux 上，文件名字符串是一个 UTF-8 字符串（例如，在 EXT3 文件系统上，唯一不允许的字符是斜杠和 NULL），存储在普通的`char *`. 手册页似乎没有提到字符编码，这让我相信它是 UTF-8 的系统标准。OS X 可能使用相同的，因为它来自相似的根源，但我对此不太确定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T19:37:52.740

您可能必须将线程语言环境设置为系统默认语言环境。请参阅此处了解问题的可能原因： [http ://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=100887](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=100887)

# python - 在 Mac OS X 中获取当前活动窗口/文档的标题

> ID：480866
> 
> 赞同：21
> 
> 时间：2009-01-26T18:32:52.887
> 
> 标签：python, objective-c, macos

参考之前提出的[问题](https://stackoverflow.com/questions/373020/finding-the-current-active-window-in-mac-os-x-using-python "问题")，我想知道如何获取当前活动文档的标题。

我尝试了上述问题的答案中提到的脚本。这有效，但只给了我应用程序的名称。例如，我正在写这个问题：当我启动脚本时，它给了我应用程序的名称，即“Firefox”。这很整洁，但并没有真正的帮助。我宁愿捕获我当前活动文档的标题。看图片。

[火狐标题 http://img.skitch.com/20090126-nq2egknhjr928d1s74i9xixckf.jpg](http://img.skitch.com/20090126-nq2egknhjr928d1s74i9xixckf.jpg)

我使用的是 Leopard，所以不需要向后兼容。此外，我正在使用 Python 的 Appkit 来访问 NSWorkspace 类，但如果你告诉我 Objective-C 代码，我可以找出 Python 的翻译。

* * *

好的，我有一个不太令人满意的解决方案，这就是为什么我不标记 Koen Bok 的答案。至少现在还没有。

```
tell application "System Events"
set frontApp to name of first application process whose frontmost is true
end tell
tell application frontApp
if the (count of windows) is not 0 then
    set window_name to name of front window
end if
end tell 
```

另存为脚本并在 shell 中使用 osascript 调用它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-26T19:38:41.567

据我所知，您最好的选择是包装 AppleScript。但是 AppleScript 对我来说很神奇，所以我把它留给提问者做练习 :-)

这可能会有所帮助：[调整最前面两个窗口以填满屏幕的脚本 - Mac OS X 提示](http://hints.macworld.com/article.php?story=20060105082728937)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-04T01:20:22.880

在 Objective-C 中，使用一点 Cocoa 和主要是[Carbon Accessibility API](https://developer.apple.com/library/mac/documentation/Accessibility/Reference/AccessibilityCarbonRef/Reference/reference.html)的简短回答是：

```
// Get the process ID of the frontmost application.
NSRunningApplication* app = [[NSWorkspace sharedWorkspace]
                              frontmostApplication];
pid_t pid = [app processIdentifier];

// See if we have accessibility permissions, and if not, prompt the user to
// visit System Preferences.
NSDictionary *options = @{(id)kAXTrustedCheckOptionPrompt: @YES};
Boolean appHasPermission = AXIsProcessTrustedWithOptions(
                             (__bridge CFDictionaryRef)options);
if (!appHasPermission) {
   return; // we don't have accessibility permissions

// Get the accessibility element corresponding to the frontmost application.
AXUIElementRef appElem = AXUIElementCreateApplication(pid);
if (!appElem) {
  return;
}

// Get the accessibility element corresponding to the frontmost window
// of the frontmost application.
AXUIElementRef window = NULL;
if (AXUIElementCopyAttributeValue(appElem, 
      kAXFocusedWindowAttribute, (CFTypeRef*)&window) != kAXErrorSuccess) {
  CFRelease(appElem);
  return;
}

// Finally, get the title of the frontmost window.
CFStringRef title = NULL;
AXError result = AXUIElementCopyAttributeValue(window, kAXTitleAttribute,
                   (CFTypeRef*)&title);

// At this point, we don't need window and appElem anymore.
CFRelease(window);
CFRelease(appElem);

if (result != kAXErrorSuccess) {
  // Failed to get the window title.
  return;
}

// Success! Now, do something with the title, e.g. copy it somewhere.

// Once we're done with the title, release it.
CFRelease(title); 
```

或者，使用 CGWindow API 可能更简单，正如[StackOverflow answer](https://stackoverflow.com/a/3042284/308464)中提到的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-20T07:32:14.853

> 参考[https://stackoverflow.com/a/23451568/11185460](https://stackoverflow.com/a/23451568/11185460)

```
package main

/*
#cgo CFLAGS: -x objective-c
#cgo LDFLAGS: -framework Cocoa
#import <Cocoa/Cocoa.h>

int
GetFrontMostAppPid(void){
    NSRunningApplication* app = [[NSWorkspace sharedWorkspace]
                                  frontmostApplication];
    pid_t pid = [app processIdentifier];
    return pid;
}

CFStringRef
GetAppTitle(pid_t pid) {
    CFStringRef title = NULL;
    // Get the process ID of the frontmost application.
    //  NSRunningApplication* app = [[NSWorkspace sharedWorkspace]
    //                                frontmostApplication];
    //  pid_t pid = [app processIdentifier];

    // See if we have accessibility permissions, and if not, prompt the user to
    // visit System Preferences.
    NSDictionary *options = @{(id)kAXTrustedCheckOptionPrompt: @YES};
    Boolean appHasPermission = AXIsProcessTrustedWithOptions(
                                 (__bridge CFDictionaryRef)options);
    if (!appHasPermission) {
       return title; // we don't have accessibility permissions
    }
    // Get the accessibility element corresponding to the frontmost application.
    AXUIElementRef appElem = AXUIElementCreateApplication(pid);
    if (!appElem) {
      return title;
    }

    // Get the accessibility element corresponding to the frontmost window
    // of the frontmost application.
    AXUIElementRef window = NULL;
    if (AXUIElementCopyAttributeValue(appElem,
          kAXFocusedWindowAttribute, (CFTypeRef*)&window) != kAXErrorSuccess) {
      CFRelease(appElem);
      return title;
    }

    // Finally, get the title of the frontmost window.
    AXError result = AXUIElementCopyAttributeValue(window, kAXTitleAttribute,
                       (CFTypeRef*)&title);

    // At this point, we don't need window and appElem anymore.
    CFRelease(window);
    CFRelease(appElem);

    if (result != kAXErrorSuccess) {
      // Failed to get the window title.
      return title;
    }

    // Success! Now, do something with the title, e.g. copy it somewhere.

    // Once we're done with the title, release it.
    CFRelease(title);

    return title;
}
static inline CFIndex cfstring_utf8_length(CFStringRef str, CFIndex *need) {
  CFIndex n, usedBufLen;
  CFRange rng = CFRangeMake(0, CFStringGetLength(str));
  return CFStringGetBytes(str, rng, kCFStringEncodingUTF8, 0, 0, NULL, 0, need);
}
*/
import "C"
import (
    "github.com/shirou/gopsutil/v3/process"
    "reflect"
    "unsafe"
)

//import "github.com/shirou/gopsutil/v3/process"
func cfstringGo(cfs C.CFStringRef) string {
    var usedBufLen C.CFIndex
    n := C.cfstring_utf8_length(cfs, &usedBufLen)
    if n <= 0 {
        return ""
    }
    rng := C.CFRange{location: C.CFIndex(0), length: n}
    buf := make([]byte, int(usedBufLen))

    bufp := unsafe.Pointer(&buf[0])
    C.CFStringGetBytes(cfs, rng, C.kCFStringEncodingUTF8, 0, 0, (*C.UInt8)(bufp), C.CFIndex(len(buf)), &usedBufLen)

    sh := &reflect.StringHeader{
        Data: uintptr(bufp),
        Len:  int(usedBufLen),
    }
    return *(*string)(unsafe.Pointer(sh))
}

func main() {
    pid := C.GetFrontMostAppPid()

    ps, _ := process.NewProcess(int32(pid))
    title_ref := C.CFStringRef(C.GetAppTitle(pid))

    println(pid) // pid
    println(ps.Name()) // process name
    println(cfstringGo(title_ref)) // active window title
} 
```

* * *

然后我发现这个属性在被调用后不会改变。[这样](https://stackoverflow.com/questions/33393216/objective-c-refreshing-frontmostapplication)，只有在我们实现之后，`NSWorkspaceDidActivateApplicationNotification`我们才能监控活动窗口的变化。但是我没有找到任何可以`NSWorkspaceDidActivateApplicationNotification`在 golang 中实现的解决方案。

一种解决方法是编译一个 go 程序并由另一个 go 程序调用它。[然后我在这里](https://gist.github.com/sailist/02c2b1fa323dd406107b944f24c2062d#file-main-m)尝试完整的 Objective-C 代码

# c# - 实体框架：设置外键属性

> ID：480872
> 
> 赞同：16
> 
> 时间：2009-01-26T18:34:52.210
> 
> 标签：c#, ado.net-entity-data-model

我们有一个大致如下所示的表：

```
CREATE TABLE Lockers 
{
  UserID int NOT NULL PRIMARY KEY (foreign key),
  LockerStyleID int (foreign key),
  NameplateID int (foreign key)
} 
```

所有的键都与其他表相关，但由于应用程序的分布方式，我们更容易将 ID 作为参数传递。所以我们想这样做：

```
Locker l = new Locker { 
  UserID = userID, 
  LockerStyleID = lockerStyleID, 
  NameplateID = nameplateID 
};
entities.AddLocker(l); 
```

我们可以在 LINQ-to-SQL 中做到这一点，但不是 EF？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-24T11:59:27.837

这个缺失的功能似乎惹恼了很多人。

*   好消息：MS 将解决 .NET 4.0 的问题。
*   坏消息：现在，或者如果你被困在 3.5 上，你必须做一些工作，但这是可能的。

你必须这样做：

```
Locker locker = new Locker();
locker.UserReference.EntityKey = new System.Data.EntityKey("entities.User", "ID", userID);
locker.LockerStyleReference.EntityKey = new EntityKey("entities.LockerStyle", "ID", lockerStyleID);
locker.NameplateReference.EntityKey = new EntityKey("entities.Nameplate", "ID", nameplateID);
entities.AddLocker(locker);
entities.SaveChanges(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-14T19:07:01.193

为了让事情变得简单，我一直在做的是自己在部分类中添加外键属性：

```
public int UserID
{
   get
   {
      if (this.User != null)
         return this.User.UserID;
   }
   set 
   {
      this.UserReference.EntityKey = new System.Data.EntityKey("entities.User", "ID", value);
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T18:43:58.557

您可以创建一个基于这些 ID 构造实体的扩展方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-18T10:36:37.357

使用 EntityKey 可以解决您的问题；）

阿尔克。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-20T14:01:56.137

如果您不介意“污染”您的数据库架构，另一种方法是添加一个计算列，例如，如果您有一个外键字段 FK_Customer，您可以定义一个新的计算列 FK_Customer_Computed，它具有表达式 FK_Customer。当您生成\更新您的 edmx 模型时，该字段将显示为一个常规字段，然后您可以从您的实体对象中引用该字段。

或者等待 EF4 :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-20T10:14:56.880

继 Dylan 的回答之后，Alex James 写了一篇关于此的博客，详细解释了这个问题以及如何进行部分类 + 属性的解决方案。

[伪造外键 - EF3.5](http://blogs.msdn.com/b/alexj/archive/2009/03/25/tip-7-faking-foreign-key-properties-in-net-3-5-sp1.aspx)

# .net - 官方 LINQ 扩展方法

> ID：480882
> 
> 赞同：7
> 
> 时间：2009-01-26T18:40:07.083
> 
> 标签：.net, linq, extension-methods

.NET 3.5 将大量扩展方法添加到代码的核心库中。我注意到在 MSDN 中，IEnumerable<> 等有一个关于已添加的扩展方法的部分。

是否有所有已添加以供参考的扩展方法的列表？

**编辑** 感谢您的回答，但我正在寻找一个完整的列表，而不仅仅是每个独立类型的 MSDN 文章的链接，我正在寻找一个完整的列表。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-26T18:50:55.673

Linq 的许多扩展方法都可以在[这里](http://msdn.microsoft.com/en-us/library/system.linq.enumerable_methods(v=vs.110).aspx)找到。我认为 .net 3.5 没有**所有**扩展方法的完整列表

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-06T18:45:38.573

[这](http://www.dotnetperls.com/linq "这里")是一个包含描述和示例的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-26T18:47:07.787

MSDN 文档已更新，它有图标来指示什么是扩展方法，什么不是。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T18:53:56.230

[您可以使用 .NET Reflector 和CodeSearch](http://www.codeplex.com/reflectoraddins/Wiki/View.aspx?title=CodeSearch)插件自行搜索它们 。

# upload - AjaxUploader.dll 与匿名身份验证一起使用，集成 Windows 失败

> ID：480889
> 
> 赞同：0
> 
> 时间：2009-01-26T18:44:48.743
> 
> 标签：upload, file-upload, anonymous, ajax.net

为不熟悉 Ajax 上传工具的客户端管理 IIS6 主机，从此处获得： http: [//ajaxuploader.com/](http://ajaxuploader.com/) [http://cutesoft.net](http://cutesoft.net)

启用集成 Windows 身份验证后，单个文件上传工作正常，多文件上传尝试似乎没有进行（但没有记录任何错误，我还没有发现......？）。将身份验证修改为匿名允许多文件上传正常工作。

以上传到 SQL Server 数据库为目标的文件。为下面的行粘贴代码行。

Default.aspx.cs 包含：

```
 using System;
    using System.Collections.Generic;
    using System.Web;
    using System.Web.UI;
    using System.Web.UI.WebControls;

    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
          ltOutput.Text = "";
        }

        protected void FileUploaded(object sender, UploaderEventArgs e)
        {
          ltOutput.Text += "File upload complete: <a href=\"download" 
          + .aspx?guid=" + e.FileGuid.ToString() + "\">" + e.FileName 
          + "</a>, File Size: " + e.FileSize + ", FileGUID: " 
          + e.FileGuid.ToString() + "</a><br/>";        
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-19T13:24:39.113

我敢打赌，这是因为他们使用 Flash 组件进行多文件上传。单次上传使用浏览器会话，因此它保持身份验证，但多次上传使用 Flash 连接到不同会话中的服务器，因此存在身份验证问题。Flash 不能正确处理 Windows 身份验证。

你有几个选择，但都不好玩：

*   使您的文件上传处理程序匿名或使用表单身份验证可用
*   仅使用单个文件上传

# java - 有没有办法告诉 Eclipse 在构建之前“全部保存”？

> ID：480891
> 
> 赞同：22
> 
> 时间：2009-01-26T18:45:12.610
> 
> 标签：java, eclipse, config

有谁知道是否有办法让 Eclipse 在构建 Java 代码之前执行“全部保存”？（我不使用“自动构建”选项，我说的是当您使用“Ctrl+B”进行构建时）

我已经挖掘了偏好，似乎找不到任何东西，所以我想我会检查 Stack Overflow 的蜂巢思维以防万一。

我正在使用 Ganymede，V3.4.1，内部版本号：M20080911-1700，如果相关的话。

在此先感谢，戴夫·麦基

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-26T19:03:13.357

在首选项 General->Workspace 下，有一个“在构建前自动保存”选项。

# java - 仅给定类名作为该类型的字符串时转换为未知类型

> ID：480894
> 
> 赞同：8
> 
> 时间：2009-01-26T18:46:04.077
> 
> 标签：java, class, casting

我目前拥有一个对象列表（使用 Java 1.3），假设我想将从 list.get(i) 返回的对象之一转换为我只知道类名称为字符串的类型。本质上，我如何 Object o = (classname)list.get(i); 其中 className 是 className 的 String 变量。

我以为我可以使用 (Class.forName(className))list.get(i)，但我收到一个语法错误，声称我忘记了分号。

不幸的是，由于我使用的是 Java 1.3，因此我无法访问 Class.cast(Object) 方法。

在 Java 1.3 中转换为另一种类型时使用的类的名称是什么？是否有一些方法可以使用类名的 String 参数为我提供所需的正确类型？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-26T18:53:00.880

当您所做的只是将结果分配给对象时，铸造的意义何在？如果它没有实现接口/扩展或者是类或者如果它实现了什么也不做，那么您将实现的只是一个异常。

为此简单：

```
 public static boolean IsInstance(object x, String className)
  {
     Class cls = Class.forName(className);
     return cls.isInstance(x);
  } 
```

就足够了（而且更干净）

如果您要使用反射来获取类的字段/方法，那很好

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T18:48:54.740

不，你不能在大多数语言中做到这一点。

原因是必须在编译时知道要转换的类型，而不是在运行时（这就是你想要做的）。

如果您考虑一下，这是有道理的，因为鉴于变量可以是任何类型名称，您应该如何访问各种成员？你不能，除非它们是在所有实例都实现的基本类型/接口中定义的，在这种情况下你应该使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T20:02:23.517

需要这种情况的一种情况是在使用遗留系统强制类型安全时。例如，假设您有一个像 Hibernate 这样的持久性系统，它提供`List`来自“finder”方法的原始结果。将此 raw`List`转换为参数化类型将导致未经检查的警告，并且如果 List 包含错误类型的对象，则 a`ClassCastException`可以在一些远相关的代码中在未指定的时间引发。最好使用 OP 建议的机制预先验证列表的内容。

这是 Java 1.3 版本（没有泛型）：

```
private static void checkType(Collection objs, String className) 
  throws ClassNotFoundException
{
  Class clz = Class.forName(className);
  Iterator i = objs.iterator();
  while (i.hasNext()) {
    Object obj = i.next();
    if (!clz.isInstance(obj)) {
      throw new ClassCastException();
    }
  }
} 
```

在 Java 5 及更高版本中，使用泛型，您可以使用该`Class.cast()`方法执行类似的操作来验证集合的内容，从而证明使用 SuppressWarnings 注释的合理性。在我们的审查过程中，在没有一些“证据”证明它是安全的情况下抑制警告被作为错误提交。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T18:51:41.960

我假设您真的想编写以下内容，而不是`Object`在左侧使用。否则，它实际上只是检查列表中的对象是否属于正确的类型。

```
ClassName o = (classname)list.get(i); 
```

好吧，Java 是静态类型的。你不可能给它一个字符串，它给你相应的静态类型，这样你就可以不用强制转换。即使使用泛型 and `Class<T>.cast`，转换目标类型也不是由字符串给出，而是由泛型 type-argument 给出`T`，这在编译时是已知的。您必须手动转换为正确的类型，或继续使用最常见的类型（在您的情况下可能是 Object）。

如果你这样做`Class.forName(className)`，它会给你一个类型的对象，`Class`其中包含有关运行时类型的信息，以便它允许你做

```
Class.forName("my.stuff.MyClass").newInstance() 
```

但是演员想要一个类型——而不是某种类型的对象。这就是编译器告诉您该代码有问题的原因。

那返回的引用的静态类型是`Object`. 这很重要：被引用对象的动态类型，以及指向该对象的引用的静态类型。对象的动态类型是可以由字符串“控制”的（通过使用`Class.forName`），但引用的静态类型在编译时必须处理，即（仅举个例子）用于选择相互重载的函数，不能由字符串确定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T19:06:43.677

这个问题已经[回答](https://stackoverflow.com/questions/480894/casting-to-unknown-type-when-only-given-class-name-as-a-string-of-that-type#480901)了，但我想补充一点，你应该有一个 List 来保存几种不同类型的对象（在这种情况下是*任何*对象）似乎有点可疑，但你显然想对它们调用特定于每种不同类型的操作...

这个系列的意义何在？难道你保留的实例没有*任何*共同点——你可以将它们转换成任何共同的超类型吗？

# java - 重置身份验证器凭据

> ID：480895
> 
> 赞同：8
> 
> 时间：2009-01-26T18:46:33.200
> 
> 标签：java

我们在实用程序类中有一个静态方法，它将从 URL 下载文件。已设置身份验证器，因此如果需要用户名和密码，则可以检索凭据。问题在于，只要凭据有效，第一个成功连接的凭据就会用于每个连接之后。这是一个问题，因为我们的代码是多用户的，并且由于没有为每个连接检查凭据，因此没有正确凭据的用户可能会下载文件。

这是我们正在使用的代码

```
private static URLAuthenticator auth;

public static File download(String url, String username, String password, File newFile)
{
    auth.set(username, password);
    Authenticator.setDefault(auth);
    URL fURL = new URL(url);
    OutputStream out = new BufferedOutputStream(new FileOutputStream(newFile));
    URLConnection conn = fURL.openConnection();
    InputStream in = conn.getInputStream();

    try
    {
        copyStream(in, out);
    }
    finally
    {
        if (in != null)
            in.close();
        if (out != null)
            out.close();
    }

    return newFile;
}

public class URLAuthenticator extends Authenticator
{
    private String username;
    private String password;

    public URLAuthenticator(String username, String password)
    {
         set(username, password);
    }

    public void set(String username, String password)
    {
        this.username = username;
        this.password = password;
    }

    protected PasswordAuthentication getPasswordAuthentication()
    {
        log.debug("Retrieving credentials '" + username + "', '" + password + "'.");
        return new PasswordAuthentication(username, password.toCharArray());
    }
} 
```

我只看到一次来自 getPasswordAuthentication 的日志语句，这是第一次下载文件。在第一次成功尝试之后，即使凭据已被重置，也不会再次调用 getPasswordAuthentication。结果是第一次连接成功后，可以输入无效的凭据，仍然可以成功连接。这可能是下载方法是静态的并且在静态类中的结果吗？

**编辑** 我忘了提到这是在tomcat下运行的JSF webapp中-也许其中一项技术正在某处设置一些默认凭据？

我已将 URLAuthenticator 拉到它自己的类中，并使其尽可能非静态，但问题仍然存在。我已经读过，如果使用 Authenticator.setDefault(null) 将默认身份验证器设置为 null，那么在 Windows 上将使用 NTLM 身份验证。这不应该是这里的问题，因为我每次都在设置 Authenticator，但我想我会把它扔在那里。NTLM 身份验证肯定会被使用，因为如果服务器以有权访问下载文件的用户身份运行，则甚至不需要凭据，文件只是下载。所以很明显，有些东西是在调用身份验证器之前获取我的凭据并传递它们。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-28T15:12:57.437

我至少想通了一些事情。看来这种行为是一个[错误](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6626700)。一种解决方法是使用 Sun 特定的类来显式重置缓存，如下所示：

```
import sun.net.www.protocol.http.AuthCacheValue;
import sun.net.www.protocol.http.AuthCacheImpl;
....
AuthCacheValue.setAuthCache(new AuthCacheImpl());
Authenticator.setDefault(new URLAuthenticator(username, password)); 
```

我正在重置问题中描述的下载功能顶部的 AuthCache。在编译期间，您会收到有关使用这些类的警告。这并不能完全解决问题：如果 NTLM 身份验证有效，身份验证器仍然不会被调用，但只要服务器在没有请求文件权限的用户下运行，这应该清除缓存出去。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-09T14:15:34.980

面对同样的问题，这些答案都不适合我。我花了一些时间查看 java 运行时源代码来解决这个问题。Sun.net.www.protocol.http.ntlm.NTLMAuthentication 尝试使用透明身份验证，基本上是使用当前用户凭据登录远程服务器。在我的服务器到服务器场景（Java EE 服务器到 Sharepoint）中，这是不可接受的。为了禁用透明身份验证，我们需要让身份验证提供者知道连接不受信任，并且需要在每次调用时进行身份验证：

```
static {
    NTLMAuthenticationCallback.setNTLMAuthenticationCallback(new NTLMAuthenticationCallback()
    {
        @Override
        public boolean isTrustedSite(URL url)
        {
            return false;
        }
    });
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-26T19:00:17.107

看起来在您的 finally 块中您需要调用

```
Authenticator.setDefault(null); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-18T19:15:50.333

这是工作（即，为每个请求调用 getPasswordAuthentication() ）代码。您将看到可以忽略的编译警告。

```
static class MyCache implements sun.net.www.protocol.http.AuthCache{
     public void put(String pkey, sun.net.www.protocol.http.AuthCacheValue value){

     }
     public sun.net.www.protocol.http.AuthCacheValue get(String pkey, String skey){
         return null;
     }
     public void remove(String pkey, sun.net.www.protocol.http.AuthCacheValue entry){

     }
}
static{
    sun.net.www.protocol.http.AuthCacheValue.setAuthCache(new MyCache());

} 
```

# sql-server - 如何管理 SQL Server 日志大小

> ID：480897
> 
> 赞同：17
> 
> 时间：2009-01-26T18:47:01.720
> 
> 标签：sql-server, transaction-log

我正在尝试管理 SQL Server 2008 日志文件的大小。我有一个每天加载一次的报告数据库。简单恢复模式是最合适的，因为除了早上的负载之外没有任何事务，我可以重新创建这些记录。我的目标是使事务日志具有固定大小，足够大以至于在加载期间不必分配新空间。

我的问题是日志不断增长。我知道日志应该被标记为重复使用，但为什么日志一直在增长？log_reuse_wait_desc 显示“无”。

我可以将日志文件缩小到 1 MB，所以我知道其中没有事务。我可以设置一个工作来执行此操作，但我更愿意将日志保留为 500MB，这足以处理日常负载。如果我这样做，日志会增长。

如何使日志保持一致的大小？

请注意：缩小日志文件并不能解决此问题。我知道该怎么做。我正在尝试找到一种方法来重新使用事务日志中的空间。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-26T19:29:41.523

日志文件用于事务目的，即使数据库处于简单恢复模式。如果 LOG 大小确实增长到超过 500 MB，那么有人正在运行需要该空间的查询或存储过程。

例如，您可能正在针对您的报告表创建索引。这将在事务中完成，以便在发生错误时可以回滚更改。但是，一旦完成，将释放已用空间以供其他事务使用。

因此，如果日志大小从 1MB 开始并增加到 700MB，那么正在执行需要该空间的操作。如果将大小锁定为 500MB，最终会收到“日志文件空间不足”错误。

但是如果你真的想将它修复为 500MB，你可以执行以下操作：（我使用的是 SQL Server 2005）

1.  启动 Microsoft SQL Server Management Studio
2.  找到您的数据库并右键单击它。选择属性。
3.  单击文件部分
4.  找到 LOG FILE 行。
5.  将初始大小更改为：500
6.  找到 Autogrowth 部分并单击椭圆 (...)
7.  取消选中“启用自动增长”。单击确定。
8.  单击“确定”进行更改。

注意：您还可以在“自动增长部分”中设置最大日志文件大小。

或者，您可以使用以下脚本进行更改。将 DATABASENAME 替换为适当的值。如果需要，还可以更改日志文件名。

```
USE [master]
GO
ALTER DATABASE [DatabaseName] MODIFY FILE ( NAME = N'DATABASENAME_Log', SIZE = 512000KB , FILEGROWTH = 0)
GO 
```

* * *

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T18:53:22.703

创建一个备份数据库并缩小日志的维护作业

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T19:17:34.560

DBCC Shrinkfile 命令允许您指定目标大小：

```
DBCC SHRINKFILE (DataFile1, 7) 
```

将文件 DataFile1 缩小到 7MB

文档位于：[MSDN](http://msdn.microsoft.com/en-us/library/aa258824(SQL.80).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T19:13:07.000

在我的脑海中，您可以使用 DBCC SHRINKFILE 来执行此操作。

# puzzle - 扩展父子关系

> ID：480902
> 
> 赞同：0
> 
> 时间：2009-01-26T18:49:35.253
> 
> 标签：puzzle

鉴于下面给出的单表设计，如何最好地查询以下内容

*   给定一个民间 id 的大家庭成员的集合
*   给定两个民间 id 的一组共同祖先
*   给定民间 id 的后代集

***奖金**1st cousins，两次删除给一个民间 id

餐桌民俗

```
FolkID (PK)
MotherID (FK to folkid)
FatherID (FK to folkid)
Name
Gender 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T22:06:29.460

有人必须建立一个家谱应用程序？前段时间我做了类似的事情，使用 XML 和 XPath：

```
<Persons>
     <Person ID="1" Name="Minu eesnimi" Surname="Minu perekonnanimi" Picture="0" Sex="M">
          <Event Name="Birth" Prefix="" Location="Tallinn" Date="14.01.1963"><![CDATA["Ilusal jaanuarihommikul"]]>
          </Event>
          <Event Name="Death" Prefix="" Location="" Date=""/>
          <Father ID="2" Type="P&#228;ris"/>
          <Mother ID="3" Type="P&#228;ris"/>
          <Spouse ID="4"/>
        </Person>
... 
```

String XPath="child::*/child::Person[child::Father[@ID=\""+String(ID) +"\"] 和 child::Mother[@ID=\""+String(配偶)+"\"]]"; 等等

# asp.net - asp.net：部分类和继承

> ID：480915
> 
> 赞同：14
> 
> 时间：2009-01-26T18:53:06.637
> 
> 标签：asp.net, vb.net, inheritance

我有一个分为两个文件的类。其中一个是生成的，另一个包含非生成的东西。

我希望我的类继承自基类。我需要让两个文件都继承吗？或者如果有部分类，该类是否会从基类继承

在生成的 foo.vb 中：

> `Partial Public Class Foo Inherits BaseClass`

在手动创建的 foo.vb 中：

> `Partial Public Class Foo`

这似乎无关紧要（无论如何，根据我在 Reflector 中看到的）。

谁能解释这是如何工作的？编译器是否只是将两者结合起来？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-26T18:56:52.043

两者中只有一个需要继承。

部分类只是编译器技巧。在编译之前，您的两个文件会重新缝合在一起。这意味着只能指定一个基类，就像在普通类中一样。

你可以有这个：

```
partial class one : base {}
partial class one {} 
```

还有这个：

```
partial class one : base {}
partial class one : base {} 
```

但不是这个

```
partial class one : fu {}
partial class two : bar {} 
```

因为最后一个组合成：

```
class one : fu, bar {} 
```

这是非法的。但是，您可以混合和匹配接口，就像在普通类上一样。

# c - C#define 宏

> ID：480939
> 
> 赞同：3
> 
> 时间：2009-01-26T19:02:07.537
> 
> 标签：c, c-preprocessor, operator-precedence

这就是我所拥有的，我想知道它是如何工作的以及它实际上做了什么。

```
#define NUM 5
#define FTIMES(x)(x*5)

int main(void) {
    int j = 1;
    printf("%d %d\n", FTIMES(j+5), FTIMES((j+5)));
} 
```

它产生两个整数：26 和 30。

它是如何做到的？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-26T19:05:09.933

发生这种情况的原因是因为您的宏将打印扩展到：

```
printf("%d %d\n", j+5*5, (j+5)*5); 
```

意义：

```
1+5*5 and (1+5)*5 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-26T19:08:35.700

由于尚未提及，因此解决此问题的方法是执行以下操作：

```
#define FTIMES(x) ((x)*5) 
```

宏展开中的括号`x`可防止运算符关联性问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T19:07:18.760

# 定义只是一个字符串替换。

之后您的问题的答案是操作顺序：

FTIMES(j+5) = 1+5*5 = 26

FTIMES((j+5)) = (1+5)*5 = 30

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T19:06:51.600

编译器预处理只是简单地替换它看到的 FTIMES，然后编译代码。所以实际上，编译器看到的代码是这样的：

```
#define NUM 5
#define FTIMES(x)(x*5)

int main(void)
{

    int j = 1;

    printf("%d %d\n", j+5*5,(j+5)*5);
} 
```

然后，考虑到运营商的偏好，您可以看到为什么会得到 26 和 30。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T19:09:42.810

如果你想修复它：

```
#define FTIMES(x) ((x) * 5) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T19:06:25.207

预处理器用 5 替换代码中的所有 NUM 次，用 x * 5 替换所有 FTIMES(x)。然后编译器编译代码。

它只是文本替换。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T19:06:46.500

操作顺序。

FTIMES(j+5) 其中 j=1 计算结果为：

1+5*5

这是：

25+1

=26

通过制作 FTIMES((j+5)) 您已将其更改为：

(1+5)*5

6*5

30

# vbscript - VBScript：检查脚本为什么停止的方法？

> ID：480942
> 
> 赞同：0
> 
> 时间：2009-01-26T19:02:31.907
> 
> 标签：vbscript

我有这个运行的[VBScript](http://en.wikipedia.org/wiki/VBScript)，但是，当它正在处理时，它会随机停止并要求用户按空格键以显示其正在进行的其余输出。

我如何弄清楚为什么会这样？

这是脚本的副本：

```
'On Error Resume Next

Dim arrFolders()
intSize = 0

Function StampNow()
Dim Hr, Mn, Yr, Mon, Dy, Date1
Date1=Now()

Hr=DatePart("h",Date1)
Mn=DatePart("n",Date1)
Yr = DatePart("yyyy",Date1)
Mon = DatePart("m",Date1)
Dy = DatePart("d",Date1)

StampNow = Yr & "-" & Mon & "-" & Dy
end function

'Output log info.
Function OutputToLog (strToAdd)
    Dim strDirectory,strFile,strText, objFile,objFolder,objTextFile,objFSO
    strDirectory = "c:\log"
    strFile = "\dpadmin_copy2run-"& StampNow &  ".bat"
    'strText = "dpadmin_copy2"
    strText = strToAdd

    ' Create the File System Object.
    Set objFSO = CreateObject("Scripting.FileSystemObject")

    ' Check that the strDirectory folder exists.
    If objFSO.FolderExists(strDirectory) Then
       Set objFolder = objFSO.GetFolder(strDirectory)
    Else
       Set objFolder = objFSO.CreateFolder(strDirectory)
       'WScript.Echo "Just created " & strDirectory
    End If

    If objFSO.FileExists(strDirectory & strFile) Then
       Set objFolder = objFSO.GetFolder(strDirectory)
    Else
       Set objFile = objFSO.CreateTextFile(strDirectory & strFile)
       'Wscript.Echo "Just created " & strDirectory & strFile
    End If

    set objFile = nothing
    set objFolder = nothing
    ' OpenTextFile Method needs a Const value
    ' ForAppending = 8 ForReading = 1, ForWriting = 2
    Const ForAppending = 8

    Set objTextFile = objFSO.OpenTextFile _
    (strDirectory & strFile, ForAppending, True)

    ' Writes strText every time you run this VBScript.
    objTextFile.WriteLine(strText)
    objTextFile.Close
End Function

strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")

strFolderName = "D:\1\production\Openjobs"

Set colSubfolders = objWMIService.ExecQuery _
    ("Associators of {Win32_Directory.Name='" & strFolderName & "'} " _
        & "Where AssocClass = Win32_Subdirectory " _
            & "ResultRole = PartComponent")

    dim diffindates

    'Init vars for regex.
    Dim retVal, retVal2
    Dim Lastprop
    Dim objRegExpr 'regex variable
    Set objRegExpr = New regexp
    Set objRegExprX31 = New regexp
    objRegExpr.Pattern = "[0-9][0-9][0-9][0-9][0-9][0-9][A-Z][A-Z][A-Z]"
    objRegExprX31.Pattern = "[0-9][0-9][0-9][0-9][0-9][0-9]X31"
    objRegExpr.Global = True
    objRegExprX31.Global = True
    objRegExpr.IgnoreCase = True
    objRegExprX31.IgnoreCase = True

    'Variables for getting last accessed property.
    Dim fs, f
    Set fs = CreateObject("Scripting.FileSystemObject")

    'Current time vars.
    Dim currenttime
    currenttime = Now()

    ParentFolder = "D:\1\Production\Openjobs\ClosedJobs"

For Each objFolder in colSubfolders
    intSize = intSize + 1

    retVal = objRegExpr.Test(objFolder.Name)
    retVal2 = objRegExprX31.Test(objFolder.Name)
    if (retVal OR retVal2 ) then
        'set filename to array
            strFolderName = objFolder.Name

        'Get last modified date.
        Set f = fs.GetFolder(objFolder.Name)
        Lastprop = f.DateLastModified
        'MsgBox(Lastprop)

        if ( DateDiff("m", f.DateLastModified, Now()) > 4) then
            diffindates =  DateDiff("m", f.DateLastModified, Now())
            Set objShell = CreateObject("Shell.Application")
            Set objCopyFolder = objShell.NameSpace(ParentFolder)

            OutputToLog("rem " & f.DateLastModified & ":" & objFolder.Name )

            outputtolog("move /Y """ & objFolder.Name & """ "  & ParentFolder)

            wscript.echo(diffindates & ":" & objFolder.Name & vbCr)
        end if
    end if
Next 
```

**更新**

它停在以下行：

```
Set objTextFile = objFSO.OpenTextFile _
(strDirectory & strFile, ForAppending, True) 
```

出现错误 Microsoft VBScript 运行时错误：权限被拒绝

我对此有点困惑。日志文件只有 356kb

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T23:23:29.913

我能够多次运行您的脚本而无需暂停输入。使用标志运行脚本以`//X`在调试器中启动它：

```
>cscript //nologo //X dpadmin_copy2.vbs" 
```

然后，您应该能够单步执行代码。

您还可以开始在 `wscript.echo`任何地方添加跟踪语句，看看是否可以缩小它正在等待的范围。

过去让我感动的一件事；如果您的命令控制台处于快速编辑模式，并且您不小心单击了控制台窗口中的任意位置，控制台将在等待您按下某个键时挂起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T19:06:44.080

第一步是删除所有全局 On Error Resume Next 语句。如果我们能看到脚本，就会有更好的反馈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-13T06:23:38.783

当文本文件已经有来自其他进程的打开句柄或者因为您之前在代码中打开了一个尚未关闭的句柄时，您通常会在尝试写入文本文件时收到 Permission denied。我没有尝试过，但我不知道为什么这不起作用，您可以查看使用Sysinternals (Microsoft) 的[Handle](http://technet.microsoft.com/en-us/sysinternals/bb896655.aspx)来告诉您哪个进程具有该文件的打开句柄。请参阅此处以获取有关如何使用 Handle 的进一步参考：[http ://www.orcsweb.com/blog/post/Closing-open-file-handles.aspx](http://www.orcsweb.com/blog/post/Closing-open-file-handles.aspx) 您还可以编写一个循环运行的第二个脚本来监视主脚本。第二个脚本可以通过执行 WMI 进程查询来验证第一个脚本，该查询仅返回与定义的命令行匹配的进程。然后第二个脚本可以重新启动它停止的主程序，提醒您，记录文件，启动句柄搜索等。

# asp.net - asp.net: __doPostBack not rendered sometimes

> ID：480946
> 
> 赞同：3
> 
> 时间：2009-01-26T19:04:12.213
> 
> 标签：asp.net, webforms

We got strange error last days. ___doPostBack is undefined.

We are building quite advanced website, but not using postbacks much. One of place where postback used is ASP.NET Login Status control.

It is probabalystic, sometimes it is rendered, sometimes - not. For IE, Chrome it works mostly fine, but from FireFox it is quite high chance not to have doPostBack in page source.

Any ideas?

PS: In addition, error happens only on live environment, which uses Windows 2003 & IIS 5.0, dotnet framework is 3.5

Can it be because I am using OutputCache on page level?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-17T20:38:42.940

Just happened to us: When googlebot or any other bot hits your page before a regular user, the page is cached without any postback options.

We did a simple hack, using different a outputcacheprofile if the request.browser.javascript is false (asp.net sends different versions of the page to those browsers/crawlers/bots)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-10-22T12:53:53.033

I had the same problem, but I realized that ASP.NET does not render __doPostback when server controls don't need it.

When I put a gridview or linkbutton that need __doPostback, ASP.NET rendered it.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T19:17:09.630

Yes it might be about the output cache, comment it out and try again please

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-26T20:28:05.633

Usually this happens when you have malformed javascript somewhere on the page (usually, before the __dopostback function).

Have you viewed the page source and looked to see if the __dopostback function is actually rendered in the page, regardless of whether you're getting the error or not?

# c# - 如何在 C# 中计算“五的中位数”？

> ID：480960
> 
> 赞同：31
> 
> 时间：2009-01-26T19:07:37.760
> 
> 标签：c#, algorithm, readability, median

5 的中位数有时用作算法设计中的练习，并且已知**仅使用 6 次比较**即可计算。

在 C#中实现这种**“使用 6 次比较的 5 的中位数”的最佳方法是什么？**我所有的尝试似乎都导致了笨拙的代码:(我需要漂亮且可读的代码，同时仍然只使用 6 次比较。

```
public double medianOfFive(double a, double b, double c, double d, double e){
    //
    // return median
    //
    return c;
} 
```

**注意：**我想我也应该在这里提供“算法”：

我发现自己无法像*Azereal*在他的论坛帖子中那样清楚地解释算法。所以我会在这里参考他的帖子。来自[http://www.ocf.berkeley.edu/~wwu/cgi-bin/yabb/YaBB.cgi?board=riddles_cs;action=display;num=1061827085](http://www.ocf.berkeley.edu/~wwu/cgi-bin/yabb/YaBB.cgi?board=riddles_cs;action=display;num=1061827085)

> 好吧，我在我的一项作业中遇到了这个问题，我向这个论坛寻求帮助，但这里没有任何帮助。我最终发现了如何做到这一点。
> 
> 1.  使用前 4 个元素开始合并排序，并对每一对进行排序（2 次比较）
>     
>     
> 2.  比较每对中较低的两个并从可能性中消除最低的一个（3 次比较）
>     
>     
> 3.  将留出的第 5 个数字与没有配对的数字相加并比较两者（4 次比较）
>     
>     
> 4.  比较两个新对中最低的两个并消除较低的一对（5 次比较）
>     
>     
> 5.  比较一个本身和最后一对中的较低者，较低的数字是中位数
>     
>     
>     
>     可能的中位数在 parentesis 内
>     
>     
> 
> (54321)
> 
> 5:4 3:2 2 次比较
> 
> (4<5 2<3 1)
> 
> 4:2 3 次比较
> 
> 2(4<5 3 1)
> 
> 1:3 4 次比较
> 
> 2(4<5 1<3)
> 
> 4:1 5 次比较
> 
> 1,2(4<5 3)
> 
> 4:3 6 次比较
> 
> 1,2(3)4,5
> 
> 三是中位数

这是我编写的 C++ 代码，用于找到 5 的中位数。不要介意它的尴尬：

```
double StageGenerator::MedianOfFive(double n1, double n2, double n3, double n4, double n5){
    double *a = &n1, *b = &n2, *c = &n3, *d = &n4, *e = &n5;
    double *tmp;

    // makes a < b and b < d
    if(*b < *a){
        tmp = a; a = b; b = tmp;
    }

    if(*d < *c){
        tmp = c; c = d; d = tmp;
    }

    // eleminate the lowest
    if(*c < *a){
        tmp = b; b = d; d = tmp; 
        c = a;
    }

    // gets e in
    a = e;

    // makes a < b and b < d
    if(*b < *a){
        tmp = a; a = b; b = tmp;
    }

    // eliminate another lowest
    // remaing: a,b,d
    if(*a < *c){
        tmp = b; b = d; d = tmp; 
        a = c;
    }

    if(*d < *a)
        return *d;
    else
        return *a;

} 
```

它应该更紧凑，不是吗？

* * *

正如@pablito 在他的回答中指出的那样，内置`List.Sort()`无法满足此要求，因为它最多使用 13 次比较：]

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2010-01-22T12:00:32.230

我发现这篇文章很有趣，作为一个练习，我创建了这个，它只做 6 次比较，没有别的：

```
static double MedianOfFive(double a, double b, double c, double d, double e)
{
    return b < a ? d < c ? b < d ? a < e ? a < d ? e < d ? e : d
                                                 : c < a ? c : a
                                         : e < d ? a < d ? a : d
                                                 : c < e ? c : e
                                 : c < e ? b < c ? a < c ? a : c
                                                 : e < b ? e : b
                                         : b < e ? a < e ? a : e
                                                 : c < b ? c : b
                         : b < c ? a < e ? a < c ? e < c ? e : c
                                                 : d < a ? d : a
                                         : e < c ? a < c ? a : c
                                                 : d < e ? d : e
                                 : d < e ? b < d ? a < d ? a : d
                                                 : e < b ? e : b
                                         : b < e ? a < e ? a : e
                                                 : d < b ? d : b
                 : d < c ? a < d ? b < e ? b < d ? e < d ? e : d
                                                 : c < b ? c : b
                                         : e < d ? b < d ? b : d
                                                 : c < e ? c : e
                                 : c < e ? a < c ? b < c ? b : c
                                                 : e < a ? e : a
                                         : a < e ? b < e ? b : e
                                                 : c < a ? c : a
                         : a < c ? b < e ? b < c ? e < c ? e : c
                                                 : d < b ? d : b
                                         : e < c ? b < c ? b : c
                                                 : d < e ? d : e
                                 : d < e ? a < d ? b < d ? b : d
                                                 : e < a ? e : a
                                         : a < e ? b < e ? b : e
                                                 : d < a ? d : a;
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-26T21:03:52.567

这基本上只是从您的 C++ 示例中排除了交换和排序代码：

```
private static void Swap(ref double a, ref double b) {
    double t = a;
    a = b;
    b = t;
}

private static void Sort(ref double a, ref double b) {
    if (a > b) {
        double t = a;
        a = b;
        b = t;
    }
}

private static double MedianOfFive(double a, double b, double c, double d, double e){
    // makes a < b and c < d
    Sort(ref a, ref b);
    Sort(ref c, ref d);

    // eleminate the lowest
    if (c < a) {
        Swap(ref b, ref d);
        c = a;
    }

    // gets e in
    a = e;

    // makes a < b
    Sort(ref a, ref b);

    // eliminate another lowest
    // remaing: a,b,d
    if (a < c) {
        Swap(ref b, ref d);
        a = c;
    }

    return Math.Min(d, a);
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-08-08T15:04:01.393

谢谢。我知道您的帖子已经很老了，但这对我的问题很有用。

我需要一种方法来计算 5 个 SSE/AVX 寄存器的中位数（一次 4 个浮点数/8 个浮点数，或者一次 2 个双精度数/4 个双精度数）：

*   没有任何条件跳转

*   仅使用最小/最大指令

如果最小/最大函数是为带有条件跳转的标量寄存器编程的，那么我的代码在比较方面并不是最优的。但是如果 min/max 函数是用相应的 CPU 指令编码的，我的代码是非常有效的，因为 CPU 在执行时没有条件跳转。

```
 template<class V> 
    inline V median(const V &a, const V &b, const V &c)
    {
      return max(min(a,b),min(c,max(a,b))); 
    } 

    template<class V> 
    inline V median(const V &a, const V &b, const V &c, const V &d, const V &e)
    {
      V f=max(min(a,b),min(c,d)); // discards lowest from first 4
      V g=min(max(a,b),max(c,d)); // discards biggest from first 4
      return median(e,f,g);
    } 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-26T19:31:18.400

这里有一个有趣的线程：

[http://www.ocf.berkeley.edu/~wwu/cgi-bin/yabb/YaBB.cgi?board=riddles_cs;action=display;num=1061827085](http://www.ocf.berkeley.edu/%7Ewwu/cgi-bin/yabb/YaBB.cgi?board=riddles_cs;action=display;num=1061827085)

从线程引用：

> 1.  将数字放入数组中。
>     
>     
> 2.  使用三个比较并随机排列数字，使 a[1] < a[2]、a[4] < a[5] 和 a[1] < a[4]。
>     
>     
> 3.  如果 a[3] > a[2]，则问题相当简单。如果 a[2] < a[4]，则中值是 a[3] 和 a[4] 中较小的一个。如果不是，则中值是 a[2] 和 a[5] 中的较小者。
>     
>     
> 4.  所以 a[3] < a[2]。如果 a[3] > a[4]，则解是 a[3] 和 a[5] 中较小的一个。否则，解为 a[2] 和 a[4] 中较小的一个。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-26T21:20:00.833

这非常难看，可以使用一些重构，但它明确地遍历所有比较和交换，因此您可以看到发生了什么。

```
public double medianOfFive(double a, double b, double c, double d, double e){
    double median;
    // sort a and b
    if(a > b) // comparison # 1
    {
        double temp = a;
        a = b;
        b = temp;
    }

    // sort c and d
    if(c > d)  // comparison # 2
    {
        double temp = c;
        c = d;
        d = temp;
    }

    // replace the lower of a and c with e
    // because the lowest of the first four cannot be the median
    if(a < c) // comparison # 3
    {
        a = e;
        // re-sort a and b
        if(a > b) // comparison # 4
        {
            double temp = a;
            a = b;
            b = temp;
        }
    }
    else
    {
        c = e;
        // re-sort c and d
        if(c > d)  // comparison # 4
        {
            double temp = c;
            c = d;
            d = temp;
        }
    }

    // eliminate a or c, because the lowest
    // of the remaining four can't be the median either
    if(a < c) // comparison #5
    {
         if(b < c) // comparison #6
         {
              median = c;
         }
         else
         {
              median = b;
         }
    }
    else
    {
         if(d < a) // comparison #6
         {
              median = a;
         }
         else
         {
              median = d;
         }
    }
    return median;
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-26T20:13:39.220

只是为了检查有多少比较：

```
 class MyComparable : IComparable
{

    public static int NumberOfComparisons = 0;

    public int NumPart { get; set; }

    #region IComparable Members

    public int CompareTo(object obj)
    {
        NumberOfComparisons++; //I know, not thread safe but just for the sample
        MyComparable mc = obj as MyComparable;
        if (mc == null)
            return -1;
        else
            return NumPart.CompareTo(mc.NumPart);
    }

    #endregion
}

class Program
{
    static void Main(string[] args)
    {
        List<MyComparable> list = new List<MyComparable>();
        list.Add(new MyComparable() { NumPart = 5 });
        list.Add(new MyComparable() { NumPart = 4 });
        list.Add(new MyComparable() { NumPart = 3 });
        list.Add(new MyComparable() { NumPart = 2 });
        list.Add(new MyComparable() { NumPart = 1 });
        list.Sort();

        Console.WriteLine(MyComparable.NumberOfComparisons);
    }
} 
```

结果是 13。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-18T12:53:49.477

[为了完整起见，这个问题是排序网络](http://en.wikipedia.org/wiki/Sorting_network)的一个具体案例，[Knuth（*计算机编程艺术*，第 3 卷）](https://rads.stackoverflow.com/amzn/click/com/0201896850)对此进行了非常详细的介绍。[KE Batcher](http://www.cs.kent.edu/~batcher/sort.ps)关于这个主题的经典论文很简短，值得一读。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-26T20:24:37.200

这应该这样做

```
private Double medianofFive(double[] input)
{
    Double temp;
if (input[0] > input[1])//#1 - sort First and Second
{
    temp = input[0];
    input[0] = input[1];
    input[1] = temp;
}
if (input[2] > input[3])//#2 sort Third and Fourth
{
    temp = input[2];
    input[2] = input[3];
    input[3] = temp;
}

// replace the smaller of first and third with 5th, then sort
int smallerIndex = input[0] < input[2] ? 0 : 2;//#3
input[smallerIndex] = input[4];

//sort the new pair
if(input[smallerIndex]>input[smallerIndex+1])//#4
{
    temp = input[smallerIndex];
    input[smallerIndex] = input[smallerIndex+1];
    input[smallerIndex+1] = temp;
}

//compare the two smaller numbers
// then compare the smaller of the two's partner with larger of the two
// the smaller of THOSE two is the median
if (input[2] > input[0])
//#5
{
    temp = input[2] > input[1] ? input[1] : input[2];//#6
}
else
{
    temp = input[0] > input[3] ? input[3] : input[0];//#6
}
    return temp;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-05-09T18:00:41.557

这是其他答案的一些变体，与 6 次比较相比，它平均提高了 3.33% 到 66.67%，并且将 5 个元素围绕其中位数完全划分为奖励，无需额外费用。

通过使用 3 的中值和快速选择，使用 3 的中值从 5 个样本中的 3 个样本中选择枢轴，可以在平均 5.8 次比较（所有排列的平均值）中找到 5 个不同元素的中值元素。Median-of-3 对这三个元素进行分区，在对其余 2 个元素进行分区时，无需将其与枢轴进行重新比较。到目前为止，这是围绕三个中间元素之一划分 5 个元素的 4-5 次比较（3 的中位数不能是 5 的最小值或最大值）。最多需要 3 次比较才能将 5 个元素围绕它们的中位数进行划分（严格来说，这比仅仅找到中位数需要更多的工作），总共进行 4 到 7 次比较，（如前所述）平均为 5 次。5 个不同元素的所有可能排列中的 8 个（如果元素不不同，则比较较少）。请注意，这与通常的 always-6-comparisons 解决方案不同，因为少数不同输入的情况可能需要多达 7 次比较，但另一方面，不同输入的大多数排列需要不超过 6 次，并且通常更少; 此外，为非不同输入保存比较是相当容易的（如果所有输入都相等，则只需要 2 次比较；使用通常的 6 比较方法在输入不不同时保存比较的代码变得相当复杂（尝试一下！），没有它，即使所有输入都相等，它仍然需要进行 6 次比较）。因为少数不同输入的情况可能需要多达 7 次比较，但另一方面，大多数不同输入的排列需要不超过 6 次，而且通常更少；此外，为非不同输入保存比较是相当容易的（如果所有输入都相等，则只需要 2 次比较；使用通常的 6 比较方法在输入不不同时保存比较的代码变得相当复杂（尝试一下！），没有它，即使所有输入都相等，它仍然需要进行 6 次比较）。因为少数不同输入的情况可能需要多达 7 次比较，但另一方面，大多数不同输入的排列需要不超过 6 次，而且通常更少；此外，为非不同输入保存比较是相当容易的（如果所有输入都相等，则只需要 2 次比较；使用通常的 6 比较方法在输入不不同时保存比较的代码变得相当复杂（尝试一下！），没有它，即使所有输入都相等，它仍然需要进行 6 次比较）。

可以通过这种方式找到除中位数以外的订单统计信息：平均而言，可以找到第二个最小或第二个最大的数据（5.81666...比较），当然也可以通过 4 个比较找到最小值或最大值。

基于此，根据要求，这里有一个注释很重的函数，它使用可变参数比较函数返回指向 5 个元素的中位数的指针。它是用 C 语言编写的，但它应该在 quadrathorpe-y 异常或 sea ploose ploose 中同样有效。请注意，这仅返回指向中值元素的指针；它不会对元素进行分区（实际上它不会移动任何元素）。

```
/* a virtual swap, preserving both pointers for later use */
#define VSWAP(ma,mb,mt) mt=ma,ma=mb,mb=mt
/* a virtual swap only preserving the first pointer */
#define VSWAP2(ma,mb,munused) ma=mb
/* virtual rotation to the left; reverse the first 3 args for right rotation */
#define ROTATE(ma,mb,mc,mt) (mt)=(ma),(ma)=(mb),(mb)=(mc),(mc)=(mt)

/* median of 5 elements, no data movement, minimum (average 5.8) comparisons */
/* This implementation minimizes the number of comparisons made (min. 2) when
   elements compare equal.
*/
/* As no elements are moved, the elements are of course not partitioned around
   the element pointed to by the returned pointer (this differs from selection
   of the median via quickselect).
*/
/* Results are biased toward the middle: pc, then pb or pd, last pa or pe. */
/* The implementation is based on a simulation of quickselect using partition3
   to select a pivot from the middle three elements, with partitioning by
   skipping over the 3 partitioned elements.  For distinct inputs, it uses on
   average 5.8 comparisons (averaged over all permutations of 5 distinct
   elements); fewer for inputs with equal elements.  That's an improvement of
   about 3% over the usual 6-comparison implementation of median-of-5.
*/
void *fmed5(void *pa, void *pb, void *pc, void *pd, void *pe,
    int(*compar)(const void *,const void *))
{
    void *t;
    int c, d;
    /* First compare the 3 middle elements to determine their relative
       ordering; pb will point to the minimum, pc to the median, and pd to
       the maximum of the three.
    */
    /* Ternary median-of-3, biased toward middle element if possible, else
       first element.  Average 8/3 comparisons for 3 elements (distinct values)
       = 0.889 comparisons/element
    */
    c=compar(pb,pc); /* 1 */
    if (0<c) { /* *pb,*pc out-of-order: *pb>*pc */
        /* Before doing anything about pb,pc, compare *pc,*pd. */
        d=compar(pc,pd); /* 2a */
        if (0>d) { /* *pc<*pd: strictly in order */
            /* But *pb might be either larger than or smaller than (or equal
               to) *pd, so they may (i.e. unless it's known from the earlier
               comparison of original *pc and *pd that *pb is larger than
               both) have to be compared,  Possibilities:
               *pc<*pb<=*pd (virtual swap of pb,pc corrects relationship)
               *pc<*pd<*pb (virtual rotation to the left corrects it)
            */
            c=compar(pb,pd); /* 3a (if needed) */
            if (0<c) { /* *pc < *pd < *pb */
                ROTATE(pb,pc,pd,t);
            } else { /* *pc < *pb <= *pd */
                VSWAP(pb,pc,t);
            }
        } else { /* *pd==*pc<*pb or reversed ordering: *pd<*pc<*pb */
            VSWAP(pb,pd,t); /* one (virtual) swap takes care of it */
        } /* *pc:*pd comparisons results if-else */
        /* Note that if pc,pd compare equal, pc remains as the chosen
           median (biased toward the middle element).
        */
    } else if (0==c) { /* *pb,*pc compare equal */
        /* Either pb or pc can be taken as the median; bias here is towards
           pc, which is already in the middle position. But pd might be
           the minimum of the three or the maximum (or it may also be equal
           to both pb and pc).
        */
        d=compar(pb,pd); /* 2b */
        if (0<d) { /* pb,pd are out-of-order */
            VSWAP(pb,pd,t);
        }
    } else { /* *pb,*pc in strict order: *pb < *pc; how about *pc,*pd? */
        d=compar(pc,pd); /* 2c */
        if (0<d) { /* *pc,*pd are strictly out-of-order: *pd < *pc */
            /* But *pb might be either larger than or smaller than (or equal
               to) *pd, so they may (i.e. unless it's known from the earlier
               comparison of original *pc and *pd that *pb is larger than
               both) have to be compared,  Possibilities:
               *pb<=*pd<*pc (virtual swap of pc,pd corrects relationship)
               *pd<*pb<*pc (virtual rotation to the right corrects it)
            */
            c=compar(pb,pd); /* 3b (if needed) */
            if (0<c) { /* *pd < *pb < *pc */
                ROTATE(pd,pc,pb,t);
            } else { /* *pc < *pb <= *pd */
                VSWAP(pc,pd,t);
            }
        } /* *pc:*pd comparisons results if-else */
        /* Note that if pc,pd compare equal, pc remains as the chosen
           median (biased toward the middle element).
        */
    } /* *pb:*pc comparisons results if-else chain */
    /* Now pb points to the minimum of pb,pc,pd; pc to the median, and pd
       to the maximum.
    */
    /* Special case: if all three middle elements compare equal (0==c==d),
       any one can be returned as the median of 5, as it's impossible for
       either of the other two elements to be the median (unless of course
       one or both of them also compares equal to pb,pc,pd, in which case
       returning any of pb,pc,pd is still correct).  Nothing more needs to
       be done in that case.
    */
    if ((0!=c)||(0!=d)) { /* Not all three of pb,pc,pd compare equal */
        int e;
        /* Compare pa and pe to pc. */
        e=compar(pa,pc); /* 3c or 4a (iff needed) */
        /* If three (or more) of the four elements so far compared are
           equal, any of those equal-comparing elements can be chhosen as
           the median of 5\.  If all five elements were arranged in order,
           one of the three equal-comparing elements would necessarily be
           in the middle (at most both of the remaining elements might be
           either larger or smaller than the equal elements).  So if pa
           compares equal to pc and pc also compared equal to pb or to pd,
           nothing more need be done; pc can be considered as the median of
           five.
        */
        if ((0!=e)||(0!=c)||(0!=d)) { /* no three elements compare equal */
            int f;
            f=compar(pe,pc); /* 4b or 5a (iff needed) */
            /* Check again for three equal comparisons to avoid doing any
               unnecessary additional work.
            */
            if (
                (0!=f) /* also not equal; still not three */
              ||
                ( /* 0==f && */
                 ((0!=c)&&(0!=d)) /* at most e and f; not three */
               ||
                 ((0!=c)&&(0!=e)) /* at most d and f; not three */
               ||
                 ((0!=d)&&(0!=e)) /* at most c and f; not three */
                )
            ) {
                /* Possibilites are that:
                     one of *pa,*pe is less than (or equal to) *pc and one
                       is greater than (or equal to) *pc; *pc is the median
                       of five.
                     *pa and *pe are both less than *pc; the median of five
                       is then the maximum of *pa,*pb,*pe (*pc and *pd are
                       at least as large as those three).  The ordering of
                       those 3 elements has not been established, and it
                       will take two additional comparisons to do so.
                     *pa and *pe are both greater than *pc; the median of
                       five is the minimum of *pa,*pd,*pe (neither *pb nor
                       *pc can be larger than any of those three).
                */
                if ((0<e)&&(0<f)) { /* *pa,*pe both > *pc; median of five is
                                       the minimum of *pa,*pe,*pd
                                    */
                    /* Bias towards *pd (originally closest of these three
                       to the middle.  Neither *pa nor *pe has yet been
                       compared to *pd.
                    */
                    e=compar(pa,pe); /* 5b or 6a (iff needed) */
                    if (0<e) { /* *pe is smaller */
                        f=compar(pd,pe); /* 6b or 7a (iff needed) */
                        if (0<f) { /* *pe is smaller */
                            VSWAP2(pc,pe,t);
                        } else { /* *pd is smaller or *pd==*pe */
                            VSWAP2(pc,pd,t);
                        }
                    } else { /* *pa==*pe or *pa is smaller */
                        f=compar(pd,pa); /* 6c or 7b (iff needed) */
                        if (0<f) { /* *pa is smaller */
                            VSWAP2(pc,pa,t);
                        } else { /* *pd is smaller or *pd==*pa */
                            VSWAP2(pc,pd,t);
                        }
                    }
                } else if ((0>e)&&(0>f)) { /* *pa,*pe both < *pc; median of
                                       five is the maximum of *pa,*pb,*pe
                                    */
                    /* Bias towards *pb (originally closest of these three
                       to the middle.  Neither *pa nor *pe has yet been
                       compared to *pb.
                    */
                    e=compar(pa,pe); /* 5c or 6d (iff needed) */
                    if (0<e) { /* *pa is larger */
                        f=compar(pa,pb); /* 6e or 7c (iff needed) */
                        if (0<f) { /* *pa is larger */
                            VSWAP2(pc,pa,t);
                        } else { /* *pb is larger or *pa==*pb */
                            VSWAP2(pc,pb,t);
                        }
                    } else { /* *pe is larger or *pa==*pe */
                        f=compar(pe,pb); /* 6f or 7d (iff needed) */
                        if (0<f) { /* *pe is larger */
                            VSWAP2(pc,pe,t);
                        } else { /* *pb is larger or *pe==*pb */
                            VSWAP2(pc,pb,t);
                        }
                    } /* *pa:*pe results if-else */
                } /* median of five: minimum or maximum of three if-else */
            } /* not three equal elements among five */
        } /* not three equal elements among four */
    } /* not three equal elements among three */
    return pc;
} 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2009-01-27T09:15:59.640

有趣的是 MSDN 示例中有多少比较...

```
public static double Median(this IEnumerable<double> source) {
        if (source.Count() == 0)  throw new InvalidOperationException("Cannot compute median for an empty set.");

        var sortedList = from number in source
                         orderby number
                         select number;

        int itemIndex = (int)sortedList.Count() / 2;

        if (sortedList.Count() % 2 == 0) {
            // Even number of items.
            return (sortedList.ElementAt(itemIndex) + sortedList.ElementAt(itemIndex - 1)) / 2; } else {
            // Odd number of items.
            return sortedList.ElementAt(itemIndex); }
    } 
```

# php - Eclipse PDT 可以在需要的地方自动将 PHPDoc 块添加到代码中吗？

> ID：480963
> 
> 赞同：8
> 
> 时间：2009-01-26T19:08:40.973
> 
> 标签：php, eclipse, eclipse-plugin, eclipse-pdt

我知道 Eclipse 的大多数 Java 开发工具都有一个快捷脚本，用于为所需元素（包括页面级）添加 JavaDoc 块。

此外，我知道 PDT 将允许您通过 Source 菜单为许多事情“生成元素注释”。

是否有一个 Eclipse 插件（或者它可能在 PDT 中存在标准，我刚刚错过了它）允许您为给定文件中的所有/部分支持的元素添加 PHPDoc 块？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-08-20T09:25:34.493

将文本光标放在函数、类或其他任何内容的正上方，输入 /** 并按 Enter，您将编写 PHPDoc 的开头。例如。

```
/**
 * 
 * Enter description here ...
 * @param unknown_type $book
 * @param unknown_type $product
 */ 
```

然后，您可以`@`在注释中写入，并使用`@`后跟`ctrl`+`space`来获取 PHPDoc 标记的自动完成提示。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-26T19:37:49.680

在 PDT 1.3 中：

窗口 > 首选项 > PHP > 编辑器 > 键入 > 自动关闭 > Phpdoc 和注释区域（检查） > 添加 Phpdoc 标记（检查）

此外，修改您的模板以包含更多 Phpdoc：Preferences > PHP > Templates

# ruby-on-rails - RoR 服务器构建和 Capistrano 支持

> ID：480965
> 
> 赞同：0
> 
> 时间：2009-01-26T19:09:17.087
> 
> 标签：ruby-on-rails, deployment, capistrano, server-configuration

我一直在使用 Ruby on Rails 创建一个网站，并将通过朋友托管它。他有空间和能力来托管服务器，我有一个系统致力于成为一个专用服务器。这是我在 Rails 网站上的第一次尝试，以及与朋友的自托管。

今天和明天我将使用以下软件配置格式化和准备服务器：

*   阿帕奇2
*   Phusion 乘客（又名 mod_rails）
*   Ruby 企业版
*   MySQL 5

我确实有很多问题，对于它们的复杂性，我深表歉意。我还没有找到这个配置的指南，而且作为 Rails 的新手，我还没有经验来解决这个问题。

### 对于此配置，最推荐使用哪种 Linux 版本？

我一直计划在 CentOS 上部署。需要注意的是，我从早期就一直是 Windows 用户，并且只使用 Linux 作为虚拟主机，并且*很少*使用开发命令（例如 CVS）。因此我对 Linux 的了解比较少，经验也比较少。如果我遇到任何部署障碍、由于 Linux 发行版而导致的技术问题，或者任何类似的问题……我完全被晾干了。

这包括从源代码构建任何东西。

### 如何在我的服务器上设置 Capistrano 以进行远程部署？

我知道这是矛盾的（Capistrano 是客户端，而不是服务器端），但我不知道它在服务器上需要什么。需要FTP吗？SFTP？SSL？SSH？什么？

我应该在我的服务器上配置什么，以及如何配置它，以使 Capistrano 能够顺利运行？

另外，我如何向 Capistrano 介绍我的 SCM 位于 localhost 并且由 Mercurial 提供的事实？（我使用了 TortoiseMg。）我可以转换为 SVN，并可能在服务器上建立一个存储库，但我不完全确定如何做到这一点。

### 从 localhost 开发部署到在完全不同的操作系统上部署时，您要注意的最大障碍是什么？

### 各种各样的

*那为什么不部署到Windows呢？* 因为我在买单，我不想再买一份 XP 或者可能是 2000；我拒绝使用 Vista。此外，对于服务器环境，Linux 比 Windows 安全得多。

*为什么不阅读现有的指南？* 我是; 这是我第一个使用 Ruby on Rails 的站点，我的预算现在不到两位数，我正在尝试通过进行服务器配置和远程部署（用于站点的进一步开发）来扩展我的视野我。过去，我的 PHP 网站依赖于主机，但它们的配置更加同质化。Ruby 服务器很昂贵，对我来说太贵了，而且了解它的配置不会有什么坏处。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-26T19:26:25.197

我发现在 Slicehost.com（一家 VPS 托管公司）上发布的文章很有帮助。

完整的文章列表位于：[http](http://articles.slicehost.com/sitemap) ://articles.slicehost.com/sitemap 。您会在那里找到许多与 Ruby on Rails 应用程序的生产部署相关的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T19:39:10.037

**对于此配置，最推荐使用哪种 Linux 版本？**

任何发行版都可以正常运行，只要它们可以运行 Apache2（几乎是所有发行版）并且您可以安装Passenger（以及 ruby​​ 和 rails）。我个人使用 CentOS，发现它的包管理器非常容易使用（[yum](http://yum.baseurl.org/)）。

```
yum install -y httpd ruby
gem install rails passenger 
```

然后你所要做的就是`/etc/httpd/conf/httpd.conf`添加Passenger（在Passenger的安装文件之后`passenger-install-apache2-module`）并将它指向你的部署文件夹`.../app_name/current/public`。

由于您使用的是Passenger，因此您应该覆盖重新启动任务来为它工作。

`config/deploy.rb`

```
namespace :deploy do
  desc "Restart Application"
  task :restart, :roles => :app do
    run "touch #{current_path}/tmp/restart.txt"
  end
end 
```

**如何在我的服务器上设置 Capistrano 以进行远程部署？**

所有 Capistrano 需要的是具有足够权限的 SSH 访问来部署、迁移、重新启动应用服务器等。只需按照[Capistrano 网站上的](http://www.capify.org/)[入门指南](http://www.capify.org/getting-started)进行操作，您将立即启动并运行。

Capistrano 需要访问您的 SCM，您需要允许它连接到您的机器。Capistrano 所做的只是将您的代码签出到发布文件夹中，然后将符号链接从旧版本中移出并重新启动您的应用服务器。

**从 localhost 开发部署到在完全不同的操作系统上部署时，您要注意的最大障碍是什么？**

最大的障碍是迁移、测试、测试、测试和更多测试。应用程序中的错误很容易修复和重新部署，但迁移中的错误可能最终导致数据丢失的巨大痛苦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-24T02:16:58.070

我推荐使用 Ubuntu server 和[deprec](http://deprec.failmode.org/)，因为它提供了大量的系统管理员配方，让事情变得更容易。

# jquery - 可以并排安装 Visual Studio 2008 Pro 和 Team System 吗？

> ID：480971
> 
> 赞同：0
> 
> 时间：2009-01-26T19:11:43.773
> 
> 标签：jquery, ajax, visual-studio-2008

我有几个问题要问你..

我可以在同一台机器上安装visual studio 2008 Professional 和Team System 吗？

原因是因为已经安装了 Team System，当我使用 ajax 和 jquery 时收到一个错误：

```
Error   1   Error updating JScript IntelliSense: Client-side script IntelliSense information was not generated due to an error in an external script reference. Y:\TestTemp\WebSite1\Default.aspx   1   1   Y:\TestTemp\WebSite1\ 
```

所以我想也许我的安装已损坏？我尝试在同一台机器上安装 web express 版本，并且在 ajax 上也能正常工作。你知道我是否可以在同一台机器上安装专业版吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T03:18:15.430

I would try to fix the JavaScript Intellisense. (If you have team system, I would try to use it). The [Visual Web Developer Team blog](http://blogs.msdn.com/webdevtools/archive/2007/07/30/workaround-for-beta-2-javascript-intellisense-and-colorization-issue.aspx) has a fix for one (registry) problem that could cause this behavior.

Have you tried to repair the install?

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-07-19T20:13:13.280

在回答您的问题时，不，您不能并排安装两个版本。

# c# - 检查课程的最佳方法

> ID：480973
> 
> 赞同：0
> 
> 时间：2009-01-26T19:12:00.437
> 
> 标签：c#

我有一个方法，它接受一个接口对象的参数

像这样

```
private void SomeMethod(InterfaceA IUA) 
```

在方法里面我有这样的声明

```
ClassD someVar = (ClassD)(((ClassC)((ClassB)IUA)).D); 
```

一切都很好，花花公子。然而，在某些情况下，对象 IUA 可能是 ClassZ 而不是 ClassB 的实例。所以在那种情况下，上面的行会出错。在做上述陈述之前，有没有办法找出对象真正属于哪个类？如果我事先知道，那么我可以有一个 If 语句并执行以下操作

```
ClassZ someVar = (ClassD)(((ClassC)((ClassZ)IUA)).Z); 
```

我来自java背景......在java中我知道我们有getClass（）......在.net中什么是等价的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-26T19:17:18.240

你*真的*不应该在没有充分理由的情况下编写这样的代码。

也就是说：你可以使用`is`

```
if (a is ClassB)
{
    ClassB b = (ClassB)a;
}
else if (a is ClassZ)
{
    ClassZ z = (ClassZ)a;
} 
```

...或`as`：

```
ClassB b = a as ClassB;
if (b != null)
{
    // ...
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-26T19:18:03.293

好吧，对于初学者来说，你不应该真的从接口向下转换到一个类，除非你有一个**非常**好的理由这样做。如果您需要 ClassD 功能，那么您的方法应该接收 ClassD，而不是 InterfaceA。

让我感到困惑的另一件事是多次向下转换。我同时使用 Java 和 C#，而且我从未见过需要进行这样的多重转换。

最后，您可以使用运算符“is”来确定某个类型是继承自某个类还是实现了某个接口，如

```
if (IUA is ClassD)
{
    // do something
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T19:18:10.937

你可以做

```
if (someVar is ClassZ) 
```

如果 someVar 是 ClassZ，则返回 TRUE，

或者

```
someVar.GetType () 
```

获得实际课程

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T19:18:19.767

怎么样

```
if(IUA is ClassB)
  someVar = (IUA as ClassB).B;
elseif (IUA is ClassZ)
  someVar = (IUA as ClassZ).Z; 
```

这应该可以工作，尽管你会被强制责骂这是一个相当糟糕的架构。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-26T19:25:12.890

如果您只是要丢弃它，那么传递接口有什么意义？您可能需要重新评估设计，因为这样的代码违背了多态性的目的。此外，您不应**使用**'is' 来测试类型。因为无论如何你都要转换对象，所以你应该使用'as'并测试null。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T19:28:44.927

好的，这里有几个不同的选项：

*   Java 的等价物`getClass()`是`GetType()`; 您可以使用它`typeof(...)`来检索您在编译时知道的类型的 Type 对象。除非您对完全相等感兴趣，否则这不是测试事物的最佳方式。

*   Java`instanceof`运算符的等价物是`is`C# 中的运算符：

    ```
    if (x is SomeType) ... 
    ```

    这也可以与装箱值一起使用以检查值类型：

    ```
    if (x is int) ... 
    ```

*   相关运算符是`as`运算符，它不返回真假，而是指定类型的引用。该类型必须是可空类型（引用或可空值类型），结果是原始值，但如果该值是适当类型的引用，则作为目标类型强类型化，`null`否则。例如：

    ```
    object x = "hello";

    string y = x as string; // y = "hello" now
    Stream z = x as Stream; // z = null now 
    ```

    如果要检查引用是否属于特定类型，然后将其*用作*该类型的引用，常见的模式是：

    ```
    object x = GetObjectFromSomewhere();
    string y = x as string;
    if (y != null)
    {
        Console.WriteLine(y.Length); // Whatever
    } 
    ```

    这比 Java 中所需的效率更高：

    ```
    object x = GetObjectFromSomewhere();
    if (x is string)
    {
        string y = (string) x;
        Console.WriteLine(y.Length); // Whatever
    } 
    ```

*   如果引用类型错误是一个错误，只需强制转换——这样如果你有一个错误，你就会抛出一个异常，这几乎可以肯定是当时最好的行动方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T21:11:08.353

You should use method overloading, this is how it should look:

```
private void SomeMethod(ClassB obj) {
  DoMoreStuff(obj.B);
}
private void SomeMethod(ClassZ obj) {
  DoMoreStuff(obj.Z);
}
private void  DoMoreStuff(int val) {
 // ..
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-26T19:13:56.937

我认为没有必要将 IUA 转换为 ClassB。据我所知，您没有使用任何 ClassB 方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-26T19:19:27.020

你可以做类似的事情

```
If (IUA is ClassB)
    //I am class b 
```

但是，鉴于您的方法采用接口，如果您希望回到实际的具体类型，我会质疑您的设计。您是否可以重构以创建可用于执行该方法的操作的接口方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-26T19:19:58.563

来自 MSDN：

```
 public static void Test (object o) 
   {
      Class1 a;
      Class2 b;

      if (o is Class1) 
      {
         Console.WriteLine ("o is Class1");
         a = (Class1)o;
         // do something with a
      }

      else if (o is Class2) 
      {
         Console.WriteLine ("o is Class2");
         b = (Class2)o;
         // do something with b
      }

      else 
      {
         Console.WriteLine ("o is neither Class1 nor Class2.");
      }
   } 
```

# java - selectOneRadio 在单击后立即执行操作

> ID：480975
> 
> 赞同：2
> 
> 时间：2009-01-26T19:12:40.480
> 
> 标签：java, jsf, seam

这对专业人士来说应该很容易：

我正在使用 JSF/Facelets/Seam 并尝试显示单选按钮。然后，在用户单击其中一个按钮后，应保存该值并且用户立即重定向到另一个页面（即无需单击提交按钮）。

单选按钮有效，但转发无效。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-27T07:25:33.153

您确实可以使用 Richfaces 添加[a4j:support 组件](http://livedemo.exadel.com/richfaces-demo/richfaces/support.jsf)：

```
<h:selectOneRadio value="#{myBean.myValue}" ...>
    ...
    <a4j:support event="onclick" action="#{myBean.doSomething}"/>
</h:selectOneRadio> 
```

在您的 Java 代码中：

```
public String doSomething() {
    // Your code goes here...
    ...
    // Now, we move to the new page.
    return "some-outcome";
} 
```

但是，如果您不能（或不想）添加新库，则可以通过旧方式执行此操作：

```
<h:selectOneRadio value="#{myBean.myValue}" ... onclick="this.form.submit();" valueChangeListener="#{myBean.doSomething}">
    ...
</h:selectOneRadio> 
```

当检测到 onclick Javascript 事件时，此代码将提交包含单选按钮的表单。在服务器端，将执行操作 doSomething。在此方法中，您可以制定要执行的导航规则：

```
public void doSomething(ValueChangeEvent evt) {
    // Your code goes here...
    ...
    // Now, we move to another page...
    FacesContext context = FacesContext.getCurrentInstance();
    NavigationHandler navigation = context.getApplication().getNavigationHandler();
    navigation.handleNavigation(context, "", "some-outcome");
} 
```

其中 some-outcome 是在 faces-config.xml 中的导航规则中定义的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T15:15:49.437

使用 JSF 2.0，您可以执行以下操作

```
<h:selectOneRadio ...
...
    <f:ajax event="change" render="@form" />
</h:selectOneRadio> 
```

# javascript - jQuery 屏蔽输入插件。当文本框获得焦点时选择所有内容

> ID：480979
> 
> 赞同：10
> 
> 时间：2009-01-26T19:14:53.113
> 
> 标签：javascript, jquery, jquery-plugins

这是此问题的后续问题：

[获得焦点时选择文本框的所有内容（Javascript 或 jQuery）](https://stackoverflow.com/questions/480735/select-all-contents-of-textbox-when-it-receives-focus-javascript-or-jquery)

基本上我将文本框与[jQuery 屏蔽输入插件](http://plugins.jquery.com/maskedinput/)结合使用（编辑：链接可能不再指向相关版本）

当被屏蔽的输入文本框收到焦点时，我想选择该文本框的所有内容，但似乎将此插件绑定到文本框会阻止这种情况。我只是想知道是否有办法解决这个问题。

下面是一个演示该问题的示例 .html 页面：

```
<html>
<head>
    <title></title>
</head>
<body>
    <input id="masktest" type="text" value="01/01/2009" />
    <br />
    <input id="focustest" type="text" value="on focus will select all contents..." />

    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script type="text/javascript" src="http://jquery-joshbush.googlecode.com/files/jquery.maskedinput-1.2.1.pack.js"></script>
    <script type="text/javascript">
        $(function() {
            $("#masktest").mask("99/99/9999");

            // Contents of textboxes will be selected when receiving focus.
            $("input[type=text]")
                .focus(function() {
                    $(this).select();
                });
        });
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-11T17:47:15.167

我是jQuery的[Masked Input Plugin的作者。](http://digitalbush.com/projects/masked-input-plugin/)我决定这应该是已完成掩码的默认行为，并将其放入最新版本。您可以在[此处阅读详细信息](http://digitalbush.com/2009/03/10/masked-input-plugin-122/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-26T19:53:23.270

嘿乔恩，不太确定这个性能，但这应该工作：

```
 $(function() {

        // Contents of textboxes will be selected when receiving focus.
        $("input[type=text]")
            .focus(function() {
                var mask = "99/99/9999";
                $(this).unmask(mask).select().mask(mask);
            });
    }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-26T20:53:22.040

它在FF3中为我工作。

```
$("input[type=text]").focus(function(e) {
  var that = this;
  setTimeout(function(){$(that).select();},10);
  return false;
}); 
```

setTimeout 将“排队”执行 select()，我想知道： - 好的掩码函数完成你的工作然后我将选择内容。那就是队列有用的地方。

只是一个想法。我希望它能按预期工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-01T17:58:25.713

> 问题

焦点时默认值正在删除

> 解决：在 mask.js 文件中添加了少量补丁代码 (jquery.maskedinput-1.2.2.min.js)

```
(function(a){var c=(a.browser.msie?"paste":"input")+".mask";var b=(window.orientation!=undefined);a.mask={definitions:{"9":"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"}};a.fn.extend({caret:function(e,f){if(this.length==0){return}if(typeof e=="number"){f=(typeof f=="number")?f:e;return this.each(function(){if(this.setSelectionRange){this.focus();this.setSelectionRange(e,f)}else{if(this.createTextRange){var g=this.createTextRange();g.collapse(true);g.moveEnd("character",f);g.moveStart("character",e);g.select()}}})}else{if(this[0].setSelectionRange){e=this[0].selectionStart;f=this[0].selectionEnd}else{if(document.selection&&document.selection.createRange){var d=document.selection.createRange();e=0-d.duplicate().moveStart("character",-100000);f=e+d.text.length}}return{begin:e,end:f}}},unmask:function(){return this.trigger("unmask")},mask:function(j,d){if(!j&&this.length>0){var f=a(this[0]);var g=f.data("tests");return a.map(f.data("buffer"),function(l,m){return g[m]?l:null}).join("")}d=a.extend({placeholder:"_",completed:null},d);var k=a.mask.definitions;var g=[];var e=j.length;var i=null;var h=j.length;a.each(j.split(""),function(m,l){if(l=="?"){h--;e=m}else{if(k[l]){g.push(new RegExp(k[l]));if(i==null){i=g.length-1}}else{g.push(null)}}});return this.each(function(){var ORJ=$(this).val();var r=a(this);var m=a.map(j.split(""),function(x,y){if(x!="?"){return k[x]?d.placeholder:x}});var n=false;var q=r.val();r.data("buffer",m).data("tests",g);function v(x){while(++x<=h&&!g[x]){}return x}function t(x){while(!g[x]&&--x>=0){}for(var y=x;y<h;y++){if(g[y]){m[y]=d.placeholder;var z=v(y);if(z<h&&g[y].test(m[z])){m[y]=m[z]}else{break}}}s();r.caret(Math.max(i,x))}function u(y){for(var A=y,z=d.placeholder;A<h;A++){if(g[A]){var B=v(A);var x=m[A];m[A]=z;if(B<h&&g[B].test(x)){z=x}else{break}}}}function l(y){var x=a(this).caret();var z=y.keyCode;n=(z<16||(z>16&&z<32)||(z>32&&z<41));if((x.begin-x.end)!=0&&(!n||z==8||z==46)){w(x.begin,x.end)}if(z==8||z==46||(b&&z==127)){t(x.begin+(z==46?0:-1));return false}else{if(z==27){r.val(q);r.caret(0,p());return false}}}function o(B){if(n){n=false;return(B.keyCode==8)?false:null}B=B||window.event;var C=B.charCode||B.keyCode||B.which;var z=a(this).caret();if(B.ctrlKey||B.altKey||B.metaKey){return true}else{if((C>=32&&C<=125)||C>186){var x=v(z.begin-1);if(x<h){var A=String.fromCharCode(C);if(g[x].test(A)){u(x);m[x]=A;s();var y=v(x);a(this).caret(y);if(d.completed&&y==h){d.completed.call(r)}}}}}return false}function w(x,y){for(var z=x;z<y&&z<h;z++){if(g[z]){m[z]=d.placeholder}}}function s(){return r.val(m.join("")).val()}function p(y){var z=r.val();var C=-1;for(var B=0,x=0;B<h;B++){if(g[B]){m[B]=d.placeholder;while(x++<z.length){var A=z.charAt(x-1);if(g[B].test(A)){m[B]=A;C=B;break}}if(x>z.length){break}}else{if(m[B]==z[x]&&B!=e){x++;C=B}}}if(!y&&C+1<e){r.val(ORJ);w(ORJ.length,h)}else{if(y||C+1>=e){s();if(!y){r.val(r.val().substring(0,C+1))}}}return(e?B:i)}if(!r.attr("readonly")){r.one("unmask",function(){r.unbind(".mask").removeData("buffer").removeData("tests")}).bind("focus.mask",function(){q=r.val();var x=p();s();setTimeout(function(){if(x==j.length){r.caret(0,x)}else{r.caret(x)}},0)}).bind("blur.mask",function(){p();if(r.val()!=q){r.change()}}).bind("keydown.mask",l).bind("keypress.mask",o).bind(c,function(){setTimeout(function(){r.caret(p(true))},0)})}p()})}})})(jQuery); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-08T11:52:57.810

如果您的“完成”功能不起作用，请尝试替换此行：

`if (settings.completed && next == len)`

（这是非压缩插件的第 169 行）：

`if (settings.completed && eval(+next - 1) == len)`

在将这个插件与 firebug 一起使用时，我注意到，当输入掩码的最后一个字符时，“下一个”变量会跳过一个符号。这种方式应该有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-29T15:45:50.570

我找到了比超时更好的解决方案。

您可以查看 jquery.maskedinput.js:293 有一个输入焦点功能，它仅在没有“只读”属性的输入上触发，因此：

`$("input[type=text]").attr("readonly", true).select().removeAttr("readonly");`

……就这样。奇迹般有效 ;）

# php - PHP中的SQL Server存储过程输出参数

> ID：480991
> 
> 赞同：6
> 
> 时间：2009-01-26T19:19:40.513
> 
> 标签：php, sql-server, stored-procedures

我需要帮助在 PHP 中从 SQL Server 运行存储过程。PHP 在 Unix/Linux 服务器上运行。我们无法让 OUTPUT 变量在 PHP 中返回。以下是PHP代码：

```
$conn = mssql_connect('server', 'user', 'pass');
    mssql_select_db('db', $conn);

    $procedure = mssql_init('usp_StoredProc', $conn);

    $tmpVar1 = 'value';
    $tmpVar2 = 'value2';

    $outVar1 = '';
    $outVar2 = '';

    mssql_bind($procedure, "@var1", $tmpVar1, SQLVARCHAR, false, false);
    mssql_bind($procedure, "@var2", $tmpVar2, SQLVARCHAR, false, false);

    mssql_bind($procedure, "@outVar1", $outVar1, SQLVARCHAR, true);
    mssql_bind($procedure, "@outVar2", $outVar2, SQLVARCHAR, true);

    mssql_execute($procedure,$conn);

    print($outVar1);
    print($outVar2); 
```

存储过程如下所示：

```
 SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER proc [dbo].[usp_StoredProc]
(
    @var1 as varchar(36), 
    @var2 as varchar(10), 
    @outVar1 varchar(36) OUTPUT, 
    @outVar2 varchar(36) OUTPUT 
)
as
  select distinct 
    @outVar1 = row1, 
    @outVar2 = row2
  from table1
  where column1 = @var1
    and column2 = @var2 
```

谁能告诉我为什么 $outVar1 和 $outVar2 没有被填充？非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T20:19:04.823

根据[this page on PHP bugs](http://bugs.php.net/bug.php?id=21089)，您必须（强调我的）：

> 调用`mssql_next_result()`SP 返回的每个结果集。这样您就可以处理多个结果。
> 
> **当`mssql_next_result()`返回 false 时，您将可以访问输出参数和返回值。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-14T15:44:01.810

execute 的第二个参数必须是 true，而不是 conn。这应该有效：

```
$conn = mssql_connect('server', 'user', 'pass');
mssql_select_db('db', $conn);

$procedure = mssql_init('usp_StoredProc', $conn);

$tmpVar1 = 'value';
$tmpVar2 = 'value2';

$outVar1 = '';
$outVar2 = '';

mssql_bind($procedure, "@var1", $tmpVar1, SQLVARCHAR, false, false);
mssql_bind($procedure, "@var2", $tmpVar2, SQLVARCHAR, false, false);

mssql_bind($procedure, "@outVar1", $outVar1, SQLVARCHAR, true);
mssql_bind($procedure, "@outVar2", $outVar2, SQLVARCHAR, true);

mssql_execute($procedure,true);

print($outVar1);
print($outVar2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-26T19:47:26.543

尝试指定输出字段的特定长度

```
mssql_bind($procedure, "@outVar1", &$outVar1, SQLVARCHAR, true, false, 36);
mssql_bind($procedure, "@outVar2", &$outVar2, SQLVARCHAR, true, false, 36); 
```

看看这是否有所作为。

还要注意通过引用传递输出变量的显式 & ，尽管我不知道它是否仍然需要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-19T13:44:11.603

我有同样的问题。

假设您正在使用 FreeTDS 驱动程序与 SQL Server 通信，那么驱动程序的工作方式存在一个已知问题。它在常见问题解答中突出显示

**[http://www.freetds.org/faq.html#ms.output.parameters](http://www.freetds.org/faq.html#ms.output.parameters)**

常见问题解答中建议的 API 文档在这里，但我找不到使用 PHP 访问它的方法：

[http://www.freetds.org/reference/a00276.html](http://www.freetds.org/reference/a00276.html)

我仍然无法将其连接起来，并且我将要一起放弃输出参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T19:27:33.353

我怀疑这会导致您的问题，但是您为什么要使用`DISTINCT`？

这只是一个代码问题 - 任何时候你看到它，这意味着有可能返回正在使用 DISTINCT “处理”的重复项，并且可能需要查看为什么会返回重复项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-26T19:49:54.790

不确定您正在运行哪个版本的 PHP，但我认为在一些较旧的版本中，您需要通过引用传递变量以使值再次出现：

因此，在调用函数时，您需要将 & 字符放在变量之前：

```
mssql_bind($procedure, "@outVar1", &$outVar1, SQLVARCHAR, true);
mssql_bind($procedure, "@outVar2", &$outVar2, SQLVARCHAR, true); 
```

同样根据[此链接](http://php.filearena.net/manual/en/function.mssql-bind.php)，某些版本的输出参数存在问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-26T20:30:32.307

嗯。几点评论

1) "mssql_execute($procedure,$conn);" 错误在于第二个参数不是连接。

2）如果你得到“存储过程执行失败”，那么我必须在 freetds.conf 中创建一个数据库主机并引用它。

那时，我没有得到错误，但我也没有得到输出参数。这是 RHEL5 上的 PHP 5.1。

如果我启用 freeTDS 日志记录，我会在返回数据包中看到数据。在这一点上，我也不知道为什么它也不起作用（除了 SQL 服务器对 PHP 的支持有点欠缺！）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-07-26T19:39:41.433

我已经通过 Adodb 库以非常简单的方式完成了这项工作......

$addProduct = $obj->ExecuteQuery("Begin;DECLARE @ProductCode as varchar (100) ;EXEC CREATEPRODUCT'$pname', '$price', @ProductCode OUTPUT, '$merchantId';select @ProductCode;End;") ;

$productCode = $addProduct[0][0];

有关更多说明，您可以访问此站点.. [http://developer99.blogspot.com/2011/07/calling-ms-sql-sp-from-php.html](http://developer99.blogspot.com/2011/07/calling-ms-sql-sp-from-php.html)*******************``