# StackOverflow 问答 11563000-11563999

# html - 用较短的元素名称代替跨度？

> ID：11563000
> 
> 赞同：0
> 
> 时间：2012-07-19T14:27:34.860
> 
> 标签：html

想知道我是否可以替换不同的 html 元素标签名称并获得原始行为？

例如，我可以将`<span/>`元素表示为`<s/>`并获得相同的行为和可供性`<span/>`吗？我在想象某种 xslt-esque javascript 映射。甚至不确定这是一个好主意。我愿意被告知这是一个坏主意。

为什么？我有一大堆跨度标签，想减小我的页面大小。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:29:39.283

It is a bad idea. Stick to HTML.

> I have a big bucket of span tags and would like to reduce my page sizes.

Use HTTP compression. Repeated chunks of content (such as `<span` and `</span>`) compress very well.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:34:53.503

如果您希望减小页面大小，我不会考虑这种技术（如果可能的话），而是会格式化源代码以删除所有不必要的字符（额外的空格会添加要加载的数据并增加文档大小）。另外，请确保您的 css 是尽可能精简的，例如..

如果您有许多必须具有唯一 ID 的重复类，而不是：

```
 uniqueclass1{
 width:100px;
 height:100px;
 background:#999;
 }

 uniqueclass2{
 width:100px;
 height:100px;
 background:#999;
 } 
```

您可以将其减少为：

```
 uniqueclass1,
 uniqueclass2{
 width:100px;
 height:100px;
 background:#999;
 } 
```

这将有助于减小尺寸。

# jsf-2 - JSF 数据表中的 MouseOver

> ID：11563004
> 
> 赞同：0
> 
> 时间：2012-07-19T14:27:42.073
> 
> 标签：jsf-2, primefaces

我需要一些关于在 JSF 中为数据表列包含鼠标悬停事件的帮助。您能否让我知道如何在鼠标悬停在 jsf 列上包含弹出列表。下面是与我的 JSF 专栏对应的代码。

```
<p:column style="text-align: left;"  styleClass="foo" rendered="#{demandBean.screeRenderVo.adjustedRenderer}"  >
<f:facet name="header">
<h:outputText id="AdjustedID"  value="#{demandBean.dmdScreenLabelVO.adjustedValue}"/>
</f:facet>
<h:inputText id="AdjustedValueID" value="#{car.adjustedValue}" style="height: 20px;width:    50px;"></h:inputText>
</p:column> 
```

不确定如何为上列添加 mouserover 事件。请协助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:20:45.907

你可以这样做：

```
<script>
jQuery(document).ready(function(){
    jQuery('td').mouseover(function(){
        var th = jQuery(this).closest('table').find('th').eq( this.cellIndex );
        if (th.attr('id') == "datatable:column3"){
            dlg1.show();
        }
        else{
            dlg1.hide();
        }
    });

});

</script>
<h:form prependId="false">
    <p:dataTable id="datatable" var="car" value="#{tableBean.carsSmall}">
        <p:column id="column3" style="text-align: left;"  styleClass="foo" rendered="#{demandBean.screeRenderVo.adjustedRenderer}"  >
           <f:facet name="header">
              <h:outputText id="AdjustedID"  value="#{demandBean.dmdScreenLabelVO.adjustedValue}"/>
            </f:facet>
              <h:inputText id="AdjustedValueID" value="#{car.adjustedValue}" style="height: 20px;width:    50px;"></h:inputText>
        </p:column>
    </p:dataTable>
    <p:dialog id="basicDialog" header="Basic Dialog" widgetVar="dlg1">
    <h:outputText value="Resistance to PrimeFaces is futile!" />
    </p:dialog>
</h:form> 
```

# parameters - Microsoft Visual Studio 2012 RC C++ IntelliSense 错误

> ID：11563005
> 
> 赞同：0
> 
> 时间：2012-07-19T14:27:43.807
> 
> 标签：parameters, arguments, intellisense, visual-studio-2012, incompatibletypeerror

我是 C++ 新手（我来自 PHP），在我最初的几个项目中，我遇到了一些来自 IntelliSense 的错误。调试窗口说的是：

> IntelliSense：“const char *”类型的参数与“LPCWSTR”类型的参数不兼容 c:\C++\RenderEngine\RenderEngine\engine.c

当我运行那个简单的代码时，甚至会出现这个错误：

```
#include <Windows.h>

int WINAPI WinMain(HINSTANCE hInst, HINSTANCE hPrev, LPSTR lpCmd, int nShow)
{
    MessageBox(NULL, "Hello, world!", "Simple pop-up", MB_OK);
    return 0;
} 
```

但是，如果我在引号（ L"Hello, world!" ）前加上“L”，错误就会消失。是否有可能以任何不同的方式摆脱它？（我正在关注的教程没有前面的 L，所以这对我来说很困惑......）我一直在寻找互联网，但我没有发现任何有用的东西......对不起，如果有这样的问题已经回答了，只是我没看到...

此致，阿明·马科维克。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T09:14:57.523

设法通过转到：“项目->（项目名称）属性->配置属性->常规->字符集”并将其设置为多字节字符集来解决它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T17:54:12.150

该错误是因为您在需要宽字符字符串的地方使用 8 位字符字符串。引号中的字符串常量是 ASCII（8 位）字符串，将 L 放在它前面，例如 L"A string constant" 表示它是 wchar_t 字符串。

像你一样解决它，通过将环境属性设置为始终使用 wchar_t 字符串是解决它的一种方法，但如果你这样做，它不会在其他任何地方编译。通常最好以可移植的方式进行操作，只需通过以 L 开头的字符串文字来使用 wchar_t 字符串。

# ios - iOS GL ES 2 应用程序在设备上崩溃，但在模拟器上没有

> ID：11563008
> 
> 赞同：1
> 
> 时间：2012-07-19T14:27:53.677
> 
> 标签：ios, opengl-es-2.0

我有一个具有多个渲染目标/帧缓冲区的应用程序，并且在一次调用 glDrawElements 时它在设备（iPad iOS 5.0）上崩溃，但在模拟器中却没有。这是一个着色器密集型应用程序，具有十几个不同的着色器和数千个顶点缓冲区。

进一步调试这件事让我相信崩溃是由于特定的着色器而发生的，但着色器是有效的，正在写入的帧缓冲区对象也是如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T12:09:00.000

好的，经过大量的调试时间后，我发现我的景深着色器导致了崩溃，尤其是这个函数：

```
float GetNearFalloff( float Depth, float MinDist, float MaxDist)
{
    float Range = MaxDist - MinDist;
    if (Depth < MinDist)
        return 1.0;
    /*else*/if (Depth > MaxDist)
        return 0.0;

    float Blur = 1.0 - ( (Depth - MinDist) / Range );
    return Blur;
} 
```

基本上其他评论导致我的崩溃。删除它使一切正常。我实际上把它放回去了（我在想它可能是别的东西），只是看到在几次着色器重新编译后，同样的崩溃出现了同样的修复，删除了*else*。

# gwt - 使 GWT 2.5 编译器使用闭包编译器

> ID：11563012
> 
> 赞同：1
> 
> 时间：2012-07-19T14:28:10.600
> 
> 标签：gwt, google-closure-compiler

GWT 2.5的[发行说明](https://developers.google.com/web-toolkit/doc/latest/ReleaseNotes)说 GWT 编译器可以选择使用 Closure 编译器来提供额外的 JavaScript 优化，有人知道如何打开这个优化吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T14:39:27.320

编译选项是`-XenableClosureCompiler`. 但我不确定它是否已经适用于 2.5RC1。

# php - PHP Framework or No Framework for Matrimony like Website. Which one to Choose, if I use one?

> ID：11563013
> 
> 赞同：-4
> 
> 时间：2012-07-19T14:28:12.650
> 
> 标签：php, frameworks

I read many times that Framework is not good for product development. Should I use one or it is just good for developing a software and shipping to client?

I read that YII is a fast framework, faster than other. Will it be good for me?

Please suggest with keeping in mind that I am looking for High traffic and high volume DB Website. Because I will only develop this as a pet project so it will also go several round of redesign to make it better.

I read at many places including stackoverflow that Framework is good in discussing things and it is easier for others to understand code. This advantage is not here as I will only develop this code.

I do not plan to market it as product but will use this myself in business if everything goes well.

Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:34:05.033

框架有助于敏捷开发，尤其是当您的目标只是尽快生产出产品上市和测试时。通常带有 MVC（尽管有时不完美）模式设置，您可以轻松地将代码集成到您的网站而无需重新组织。

我建议研究以下任一框架来开始：

**symfony**：[http ://www.symfony-project.org/](http://www.symfony-project.org/)

**Yii** : [http://www.yiiframework.com/](http://www.yiiframework.com/)

**CakePHP**：[http ://cakephp.org/](http://cakephp.org/)

**[代码点火器： http](http://codeigniter.com/) : **//codeigniter.com/****

 **享受和好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:36:00.543

取决于你想做什么。就我个人而言，我不喜欢使用框架，因为我喜欢知道每个人喜欢做什么，并且我可以修改它。使用框架，你通常会得到一个功能齐全的组件，而你并不关心里面发生了什么——你只关心它是否工作。

所以这里是选择：

1.  如果您时间紧迫，并且希望快速完成项目。使用框架。
2.  如果您要长时间处理源代码，并且您将需要一些独特而卓越的功能。如果您是偏执狂并且不想相信其他人编写的代码的安全性。自己写。

或者。如果整个项目以计件方式为您支付报酬 - 使用框架。如果您按小时计酬，请自己写：）**

# c# - Javascript后退按钮行为

> ID：11563014
> 
> 赞同：1
> 
> 时间：2012-07-19T14:28:17.657
> 
> 标签：c#, javascript, jquery, asp.net, html

我有一个正在构建的站点，其中一个页面包含多个选项卡窗格。每当用户单击其中一个选项卡窗格时，它都会更新浏览器的历史记录，从而以不希望的方式影响浏览器的后退按钮功能。我在这个网站上搜索过，但我发现的所有内容都是人们希望浏览器将用户带回上一个选项卡，这不是我想要的。如果有意义的话，我希望浏览器将用户带回上一页，而不是同一页面上的上一个选项卡。

我认为应该有一个简单的方法来做到这一点，但我就是找不到。似乎我有点孤单。

该网站是用 aspx 和 visual studios mvc 框架构建的。

这是一个小代码示例。

```
<ul class="nav nav-tabs">
     <li class="active"><a href="#tab1">Tab1</a></li>
     <li><a href="#tab2">Tab2</a></li>
     <li><a href="#tab3">Tab3</a></li>
</ul>
<div class="tab-content">
     <div class="tab-pane active" id="tab1">
     </div>
     <div class="tab-pane" id="tab2">
     </div>
     <div class="tab-pane" id="tab3">
     </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:42:16.730

这是一个已知问题

您将需要使用 javsacript 方法 `window.location.replace(url);`

使用 window.location.replace() 当前页面不会被保存在会话历史中

# ios - iOS 上的按钮未在 touchUpInside 上发送事件

> ID：11563017
> 
> 赞同：3
> 
> 时间：2012-07-19T14:28:26.973
> 
> 标签：ios, uibutton, touch, xib

我从我的自定义视图中创建了一个 .xib 文件。我为该视图创建了 .h/.m 文件。我 ctrl 从按钮拖动到头文件以创建 IBAction 并将值设置为 touchUpInside。这是正在发生的事情：

[http://screencast.com/t/R1WTpK7xp](http://screencast.com/t/R1WTpK7xp)

怎么回事？

当 up 在按钮之外时触发事件？

编辑：

这是屏幕截图：

![在此处输入图像描述](../Images/66c8d7cf194e58b5fe6719f42eb51039.png)

反对票是怎么回事？我看不出这有什么意义。

*查看.h*

```
#import <UIKit/UIKit.h>
#import "DrawingViewDelegate.h"

@interface DrawingBottomToolbarView : UIView

@property (weak) id <DrawingViewDelegate> delegate;

- (IBAction)lineSegmentButtonPush:(id)sender;

@end 
```

*查看.m*

```
#import "DrawingBottomToolbarView.h"

@implementation DrawingBottomToolbarView

@synthesize delegate;

- (id)initWithFrame:(CGRect)frame
{
    NSLog(@"frame");
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        [self addSubview:[[[NSBundle mainBundle] loadNibNamed:@"DrawingBottomToolbarView" owner:self options:nil] objectAtIndex:0]];
        //[[[NSBundle mainBundle] loadNibNamed:@"DrawingBottomToolbarView" owner:self options:nil] objectAtIndex:0];
        //[self addSubview:self.];
    }

    return self;
}

//-(id)initWithCoder:(NSCoder *)aDecoder{
//    
//    NSLog(@"coder");
//    if ((self = [super initWithCoder:aDecoder])){
//        [self addSubview:[[[NSBundle mainBundle] loadNibNamed:@"DrawingBottomToolbarView" owner:self options:nil] objectAtIndex:0]];
//    }
//    return self;
//}

- (IBAction)lineSegmentButtonPush:(id)sender 
{

     NSLog(@"line push");
}

@end 
```

我不明白问题出在哪里。

**编辑2：**

我尝试将按钮设置为插座并在代码中添加目标/动作，同样的事情发生了：

*。H*

```
@property (weak, nonatomic) IBOutlet UIButton *lineSegmentButton; 
```

*.m*

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        [self addSubview:[[[NSBundle mainBundle] loadNibNamed:@"DrawingBottomToolbarView" owner:self options:nil] objectAtIndex:0]];
        self.currentSelectedPathSegment = NoneSegment;

        [self.lineSegmentButton addTarget:self action:@selector(lineSegmentButtonPush:) forControlEvents:UIControlEventTouchUpInside];

    }

    return self;
} 
```

**编辑 3：**这是我添加两个视图的地方。绘图视图是在代码中创建的，底部工具栏是从 .xib 文件创建的。

kBottomToolbarHeight 是常数，其值与 .xib 文件中定义的高度相同。

```
- (void)viewWillAppear:(BOOL)animated
{
    [self.view addSubview:self.drawingView];
    [self.view addSubview:self.bottomToolbar];

    CGRect selfRect = self.view.bounds;
    CGRect drawingViewRect = selfRect;
    CGRect bottomToobarRect = selfRect;

    drawingViewRect.size.height = selfRect.size.height - kBottomToolbarHeight;
    bottomToobarRect.size.height = kBottomToolbarHeight;
    bottomToobarRect.origin.y = drawingViewRect.size.height;

    self.drawingView.frame = drawingViewRect;    
    self.bottomToolbar.frame = bottomToobarRect;    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T14:29:08.793

您在截屏视频中提到和显示的行为与我在视图层次结构中的某个位置有一个带有`UITapGestureRecognizer`.

我不确定是否将您的问题标记为可能与[帮助我解决问题](https://stackoverflow.com/questions/3904912/uibutton-event-touch-up-inside-not-working-touch-down-works-fine)的问题重复。

作为参考，这在 iOS 6.0 中不是问题，只是在早期版本中。

# c++ - libgomp 丢失：在主目录中安装 c++ 编译器？

> ID：11563019
> 
> 赞同：0
> 
> 时间：2012-07-19T14:28:28.847
> 
> 标签：c++, compiler-construction, compiler-errors, openmp, opensuse

我正在使用一台机器

```
Linux version 2.6.16.46-0.12-smp (geeko@buildhost) (gcc version 4.1.2 20070115 (prerelease) (SUSE Linux)) #1 SMP Thu May 17 14:00:09 UTC 2007 
```

而且我没有root权限。我试图编译一个需要 OpenMP 的自写程序。但是 limgomp 没有安装，因此编译失败。

有没有办法安装我的程序，例如通过在我的主目录中使用更新的编译器或其他方式？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:35:53.513

您应该能够自己编译依赖项并将库放在您的主文件夹中的某个位置，然后将它们的位置添加到您的 PATH 变量中。

如果您在大学计算机系统上执行此操作，您可能会考虑向友好的本地网络管理员发送电子邮件并要求他为您安装它们，我不得不在 RIT 做同样的事情让他们安装 openssl 开发图书馆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:42:38.230

如果你有一个编译器并且在可写目录中有足够的空间，当然，你可以获取丢失包的源代码并在那里编译它们。

从源代码安装程序通常包括三个步骤：配置、构建/编译和安装（复制到目标位置）。阅读 README 以了解您必须更改配置的内容，然后通常只需运行`make`并安装到您的主目录或完全跳过安装步骤。

将生成的可执行文件的路径添加到您的 PATH 中，您应该能够运行新编译的程序。

预计会花费几个小时（或几天）来阅读文档并等待编译完成（取决于您需要编译多少）。或者，也许，寻找另一种方法来完成工作。

# error-handling - 如何关闭隐藏的 InDesign 文档？

> ID：11563021
> 
> 赞同：3
> 
> 时间：2012-07-19T14:28:34.850
> 
> 标签：error-handling, adobe-indesign, extendscript

在编写 InDesign 脚本时，我有很多实例创建了一个隐藏的新文档，直到我执行所有操作，然后我使用 myDocument.windows.add(); 让它显示出来。但是，我也有很多在最后一步之前遇到错误的情况，因此文档没有实现。我能够让它们关闭的唯一方法是完全关闭 InDesign。虽然这可行，但我认为必须有更好的方法。

有没有办法在 IDE 中或通过脚本来查看打开和/或关闭所有隐藏进程的内容？

干杯，布伦丹

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T14:49:42.503

当然 ！

app.documents.everyItem().close(SaveOptions.NO); //将关闭任何可见或不可见的文档而不保存它们）。

如果您想使用不可见的文档，最好使用 try catch 语句。因此，如果出现错误，您可以丢弃它们。

```
function dealWithInvisibleDocs()
{
    var doc;

    try
    {
        doc = app.documents.add();
        throw new Error ( "Booom" );
    }
    catch(e)
    {
        alert(e);
        if ( doc.isValid )
        {
           doc.close ( SaveOptions.NO );
        }
    }
}
dealWithInvisibleDocs(); 
```

洛伊克

# html - xml cdata not allowing html

> ID：11563028
> 
> 赞同：0
> 
> 时间：2012-07-19T14:29:00.743
> 
> 标签：html, xml, cdata

So from what I understand of the CDATA tags on an XML document, it's meant to allow HTML tags inside it to function as they normally would. I am working with a website template here that uses XML files, and while editing one of the documents to add a href or image to it, I rather get a string. Here's the code, if you can help me that would be greatly appreciated.

I have tried modifying the code to use the < / > that it seems to want to suggest in the output text, but that doesn't help either. If anybody can explain or link me to relevant information, or both, it would be amazing =)

```
 <?xml version="1.0"?>
    <xmldata section="Address">
<content>
<image src="resources/images/streetmap1.png" />

<bodytext><![CDATA[Shop 6, 106 Foster Street
     Dandenong, 3175

     Street Map:
     <image src="resources/images/streetmap1.png" />

]]></bodytext>
</content>  
    </xmldata> 
```

EDIT - Supplying accompanying .js file.

[http://pastebin.com/Td2EYiKH](http://pastebin.com/Td2EYiKH)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:39:50.137

> 因此，根据我对 XML 文档上的 CDATA 标记的理解，它意味着允许其中的 HTML 标记正常运行。

不，这样可以将 XML 中具有特殊含义的字符（例如`<`）*作为数据*包含在不转义的情况下。

> 这是代码

您需要查看将 XML 数据转换为 HTML 内容的代码。你还没有和我们分享。

> `<image src="resources/images/streetmap1.png" />`

HTML 元素`img`不是`image`，它应该有一个`alt`属性。

# svn - Moving SVN repositories data with history as subfolders into another repository

> ID：11563031
> 
> 赞同：9
> 
> 时间：2012-07-19T14:29:04.690
> 
> 标签：svn, version-control, repository, svndump

I have some repositories, and I need to transform the content of each one in subfolders of another repository *preserving their history log*... How can I do that?

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-22T07:54:27.670

有两种方法可以完成任务。根据 Subversion 服务器分布和任务复杂性，您可能会发现其中一个比另一个更容易或更方便。

## `svndumpfilter`使用工具过滤存储库历史记录

该解决方案非常棘手，因为 Subversion 存储库历史过滤基于您指定的路径工作，以在 repo 转储输出中包含或排除。简而言之，您应该执行以下操作：

1.  转储您当前的存储库`svnadmin dump`，
2.  过滤掉转储中只需要的存储库路径`svndumpfilter`，
3.  使用 .将过滤后的转储加载到另一个存储库`svnadmin load`。

您还可以使用[`svnrdump`](http://www.visualsvn.com/support/svnbook/ref/svndumpfilter/)工具（存在于 SVN 1.7 及更高版本中）远程执行转储和加载过程。见[`svnrdump dump`](http://www.visualsvn.com/support/svnbook/ref/svnrdump/c/dump/)和[`svnrdump load`](http://www.visualsvn.com/support/svnbook/ref/svnrdump/c/load/)。

我强烈建议您阅读 SVNBook 中与该过程相关的以下文章：

1.  [过滤存储库历史](http://www.visualsvn.com/support/svnbook/reposadmin/maint/#svn.reposadmin.maint.filtering)
2.  [`svnadmin dump`](http://www.visualsvn.com/support/svnbook/ref/svnadmin/c/dump/)
3.  [`svnadmin load`](http://www.visualsvn.com/support/svnbook/ref/svnadmin/c/load/)
4.  [`svnrdump dump`](http://www.visualsvn.com/support/svnbook/ref/svnrdump/c/dump/)
5.  [`svnrdump load`](http://www.visualsvn.com/support/svnbook/ref/svnrdump/c/load/)
6.  [`svndumpfilter`](http://www.visualsvn.com/support/svnbook/ref/svndumpfilter/)

假设您在此存储库中有存储库*C:\Repositories\REPO*和文件夹*/trunk/abc*。请参阅将文件夹*/trunk/abc*移动到另一个存储库*C:\Repositories\REPO2的示例步骤*的示例步骤。

1.  确保影响*/trunk/abc*路径及其后代的所有提交不会影响任何其他路径。例如，没有提交同时将文件添加到*/trunk/abc*和*/another_folder*或将文件从*/another_folder*复制到*/trunk/abc*等。

2.  创建 REPO 存储库的转储：

    `svnadmin dump C:\Repositories\REPO > REPO.dump`

3.  从 REPO.dump 文件中过滤掉不必要的路径：

    `svndumpfilter include /trunk/ABC < REPO.dump > filtered.dump`

4.  在目录中创建空的*/loaded*文件夹*C:\Repositories\REPO2*文件夹。

5.  将转储加载到该文件夹​​：

    `svnadmin load --parent-dir /loaded C:\Repositories\REPO2 < filtered.dump`

*而已！*

## 存储库复制与`svnsync`使用工具

该解决方案也很棘手，但复杂的存储库过滤可能比上述方法更方便。

该方法是在配置[基于路径的授权规则后](http://svnbook.red-bean.com/en/1.7/svn.serverconfig.pathbasedauthz.html)[复制存储库，`svnsync`](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.replication)这些授权规则拒绝对需要从存储库历史记录中过滤掉的任何路径进行读取访问。

**与, 不同`svndumpfilter`，`svnsync`将自动将具有不可读源路径的复制操作转换为正常添加，如果需要过滤涉及复制操作的历史记录，这很有用。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T02:05:30.590

在阅读了您的问题后，我决定为您创建一个可以解决此问题的实用程序。该实用程序基于[SVNKit](http://svnkit.com)库，位于 [https://sourceforge.net/projects/svnkitfilter](https://sourceforge.net/projects/svnkitfilter)

赶紧跑

```
$ svnadmin create svn.repo
$ svnkitfilter SRC_URL_1 file:///path/to/svn.svn --prefix prefix/for/repository1
$ svnkitfilter SRC_URL_2 file:///path/to/svn.svn --prefix prefix/for/repository2
...
$ svnkitfilter SRC_URL_N file:///path/to/svn.svn --prefix prefix/for/repositoryN 
```

# sql - Need to make some values negative in sum computation

> ID：11563037
> 
> 赞同：0
> 
> 时间：2012-07-19T14:29:19.220
> 
> 标签：sql, sql-server, sql-server-2008

I have the following table that has a list of transactions

```
ID  FromID   ToId      AMOUNT
1   1        2         10
2   1        3         10
4   1        4         10
5   3        2         3
6   4        2         2
7   4        2         1
8   2        4         2 
```

I'd like to know the best/most effecient way to get a users balance. The balance would be the sum of the amount the user has been given (where ID is ToId) minus the sum of the amount the user has given out (where ID is FromId)

Any ideas?

Thanks in advance.

James

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T14:35:15.880

用一个简单的总和

```
select SUM(Amount) from
(
select Amount from #t where ToID=@user
union all
select -Amount from #t where FromID=@user
) v 
```

（您可以在一行中完成...

```
select sum(case @user when ToID then Amount else -Amount end) 
from #t where @user in (ToID, FromID) 
```

但我认为工会会更有效率）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:36:24.197

“最佳”方式是主观的。最有效的方法可能是在您的用户表中添加一个余额字段，然后在您有该用户的交易时适当地更新它。

[编辑]澄清：

在插入事务行的代码中，在事务内添加更新查询：

```
BEGIN TRANSACTION;
INSERT INTO transactions VALUES (...);
UPDATE users SET balance = balance + <whatever the change is>;
COMMIT TRANSACTION; 
```

然后你的余额检查就变成了：

```
SELECT balance FROM users WHERE id = '...'; 
```

它是索引的，速度极快，并且只需要考虑一行。如果您依赖事务表的主动求和，那么您的余额检查查询将随着您添加事务而变慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T14:36:17.867

将两组金额相加（SUM 给用户的所有金额以及 SUM 所有给出的金额）- 将两者相减（如果使用 SQL Server，您可以使用 (-) SUBTRACT）

# jquery - 嵌套的“{{for}}”问题？[js渲染]

> ID：11563042
> 
> 赞同：0
> 
> 时间：2012-07-19T14:29:41.340
> 
> 标签：jquery, templates, jsrender

我正在尝试将模板与 jsRender 而不是我自己的版本放在一起，但是，我不断收到以下信息：“未捕获的 JsRender 错误：语法错误不匹配或缺少标签：模板中的“{{/for}}”： " 后面跟着我的整个模板。

这是我的代码的截断版本，关于发生了什么的任何想法？还是只是嵌套的 for 循环？

```
<div class="page" id="{{:info.id+info.name}}">
    {{for sources}}
    <header class="feed-title">
        <div class="feed-title-content">
            <span class="feed-title-text">{{:title}}</span>
        </div>
    </header>
    <section class="row">
        <div class="scroll-left"></div>
        <div class="row-scroll">
            {{for articles}}

                          // An if, else and some standard content insertion stuff is/was here

            {{/for}}
        </div>
        <div class="scroll-right"></div>
    </section>
    {{/for}}
</div> 
```

显示我的数组结构的 chrome 开发工具的屏幕截图：

展开视图的屏幕截图 1：

![展开视图的屏幕截图 1](../Images/f5f840a56dd1d23f4e365d760af42ab3.png)

并崩溃：

![并且崩溃了](../Images/987cc81b27175a4233a3447664660ef7.png)

关于发生了什么的任何想法？

**编辑**：忘了提，我正在使用 John Papa 的[代码从外部文件加载它](http://msdn.microsoft.com/en-us/magazine/hh975379.aspx "代码")

**编辑**：演示和代码：

我的阵列的 Chrome 开发工具输出：

```
Object
    info: Object
    sources: Array[1]
        0: Object
            articles: Array[7]
                0: Object
                1: Object
                2: Object
                3: Object
                4: Object
                5: Object
                6: Object
            link: "http://lifehacker.com"
            title: "Lifehacker" 
```

演示：http: [//jsfiddle.net/SO_AMK/3J7AE/](http://jsfiddle.net/SO_AMK/3J7AE/)

和一个工作嵌套数组：

```
Object
    foo: "names"
    testData: Array[2]
        0: Object
            markup: "<span style='background: yellow'>John</span>"
            name: "John"
            secondary: Array[1]
                0: Object
                1: Object 
```

演示：http: [//jsfiddle.net/SO_AMK/Vf8Bq/](http://jsfiddle.net/SO_AMK/Vf8Bq/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:44:32.283

你是对的，问题似乎出在你的 JavaScript 对象上。我认为要循环的属性需要是数组而不是对象。[您的模板适用](http://jsfiddle.net/6wcX8/1/)于您在评论中提供的 jsfiddle 示例中的 testdata。

如果不是这样：您可以添加对象的 JSON 序列化吗？您的模板似乎工作：http: [//jsfiddle.net/6wcX8/1/](http://jsfiddle.net/6wcX8/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T01:56:09.357

查看 jsfiddles，问题是上面代码中未实际显示的部分中的标签使用 {{if}} 和 {{else}} 没有使用正确的语法：

他们用：

```
{{for articles}}
    {{if img === false }}
        ...
    {{/if}}
    {{else}}
        ...
    {{/else}}
{{/for}} 
```

代替

```
{{for articles}}
    {{if img === false }}
        ...
    {{else}}
         ...
    {{/if}}
{{/for}} 
```

请参阅[{{if}} 和 {{each}} 标签的演示示例](http://borismoore.github.com/jsrender/demos/step-by-step/04_if-else-tag.html)。

# xmpp - Multiple XMPP BOSH Connections Interfering in Internet Explorer - UPDATE: Seen In Other Browsers

> ID：11563043
> 
> 赞同：2
> 
> 时间：2012-07-19T14:29:41.590
> 
> 标签：xmpp, delay, strophe, two-connection-limit

***Introduction***

I am working on an MVC web app that is using XMPP for two purposes: 1) Communicating real time data from the server to the client - XMPPMessaging 2) User group chat - XMPPChat

I am using Strophe.js on the client side and MatriX C# library on the server side. XMPPChat is being set up by prebinding on the server side and passing the connection info to the client, which attaches with strophe. XMPPMessaging is not prebinding, just logging in on the client side. Every window that the user opens connects a new XMPPMessaging instance to receive data from the server. Only the chat windows connect XMPPChat and XMPPMessaging. Also, both are connecting to the Punjab connection manager over BOSH, which is forwarding the messages to an Openfire server.

***Issue***

Currently, I have an issue that only manifests itself in Internet Explorer (I am testing with IE8 and IE9 and both exibit this issue). When I have XMPPMessaging and XMPPChat connected, chat messages are being sent after a very large delay (10 sec - 2 minutes). I've seen this cause disconnection issues for XMPPChat as well. The receive functionality works great; if any other browser posts to the chatroom, IE get's it immediately just like everyone else. When XMPPMessaging is turned off, the chat send runs great with no delays or disconnections. I've stepped through the code with breakpoints and the send functionality is firing immediately. I've also observed the Punjab logs, and it appears that Punjab isn't getting the message till after the delay and is passing them along fine (also evidenced by the other browsers working fine).

I'm mostly wondering if anyone else has seen issues like this one with concurrent BOSH connections in IE comehow interfering.

***Update***

The chat feature in IE started working today completely inexplicably; I haven't changed the code or any configuration of it at all. I double checked that the messaging connection and chat connection were both running, and they both were connected. In attempts to diagnose the fix, I restarted Apache and the bug came back, again only in IE we saw the chat slow down significantly and randomly disconnect.

***Update 2 - SEEN IN OTHER BROWSERS***

Today I was able to recreate the issue in other browsers (Chrome, Firefox) by opening multiple chat instances in other tabs. So it seems that IE only suffered worse from the issue - only needing one tab open. This is pointing me towards a browser concurrent connection limit issue, but that doesn't make sense to be either considering that I shouldn't be anywhere near the limit with 2 connections.

***Update 3 - CAUSE DETERMINED IN OTHER BROWSERS***

I performed a test in Firefox to confirm my suspicions that we are dealing with a concurrent connection issue. I opened one chat tab and the messages posted instantaneously. I opened a second one and, as expected, they delayed. I then opened **about:config** and changed *network.http.max-persistent-connections-per-server* from 6 to 7\. After doing this I repeated the test. I was able to post messages instantaneously in *both* the first and second chat tabs, but when I opened a third they all began experiencing the delay. I'm going to try and test in IE to see if this is the same problem by modifying the FEATURE_MAXCONNECTIONSPERSERVER registry settings and seeing if the problem goes away.

***Update 4 - IE ISSUE STILL NOT RESOLVED***

I performed the same test in IE, changing the registry as shown here, adding iexplorer.exe DWORD settings to the FEATURE_MAXCONNECTIONSPERSERVER and FEATURE_MAXCONNECTIONSPER1_0SERVER registries set to 0xA, but no changes in behavior are apparent. I tried the same thing with the x64 settings (under Wow6432Node) and still observed no changes. I also tried changing the original explorer.exe values from 2 or 4 to 8, but still saw no changes in behavior, all after restarting the computer after each change.

***Code***

For reference, here is some of my XMPP chat code which may or may not be relevant:

```
XMPPAttach: function (jid, sid, rid) {
        connection = new Strophe.Connection(BOSH_SERVICE);

        connection.rawInput = function (data) {
            log('RECV: ' + data);
        };
        connection.rawOutput = function (data) {
            log('SENT: ' + data);
        };

        MY_JID = jid;
        connection.addHandler(notifyUser, null, 'message', 'chat', null, null);
        connection.addHandler(groupChat, null, 'message', 'groupchat', null, null);
        connection.addHandler(presenceInfo, null, 'presence', null, null, null);
        connection.ping.addPingHandler(pingHandler);
        connection.attach(jid, sid, rid, onConnect, 300);
    }

function onConnect(status) {
    switch (status) {
        case Strophe.Status.CONNECTED:
            log('CONNECTED');
            break;
        case Strophe.Status.ERROR:
            log('ERROR');
            break;
        case Strophe.Status.CONNFAIL:
            log('CONNFAIL');
            break;
        case Strophe.Status.AUTHENTICATING:
            log('AUTHENTICATING');
            break;
        case Strophe.Status.AUTHFAIL:
            log('AUTHFAIL');
            break;
        case Strophe.Status.CONNECTING:
            log('CONNECTING');
            break;
        case Strophe.Status.DISCONNECTED:
            log('DISCONNECTED');
            break;
        case Strophe.Status.DISCONNECTING:
            log('DISCONNECTING');
            break;
        case Strophe.Status.ATTACHED:
            log('ATTACHED');
            break;
        default:
            log('UKNOWN STATUS CODE');
            break;
    }

    if ((status == Strophe.Status.CONNECTED || status == Strophe.Status.ATTACHED) && !presenceSent) {
        connection.send($pres().tree());
        presenceSent = true;
        userLogin();
    }
    else if (status == Strophe.Status.CONNECTING || status == Strophe.Status.AUTHENTICATING) {
        // do nothing
    }
    else if (status == Strophe.Status.AUTHFAIL) {
        userInvalidLogin();
    }
    else {
        userLoginFailed();
    }
}

EnterChatRoom: function (room, nick) {
        ROOM_JID = room;
        MY_NICK = nick;
        var chatJID = room.concat('/', nick);
        var pres = $pres({ to: chatJID }).c('x', { xmlns: 'http://jabber.org/protocol/muc' });
        connection.send(pres);
    }

SendToRoom: function (text) {
        var send = $msg({ to: ROOM_JID, type: 'groupchat' }).c('body', {}, text);
        connection.send(send.tree());
    }, 
```

And here is some of my XMPP messaging code:

```
function initializeXMPP() {
        connection = new Strophe.Connection(BOSH_SERVICE);
        intentionalDisconnect = false;

        connection.rawInput = function (data) {
                log('RECV: ' + data);
        };
        connection.rawOutput = function (data) {
                log('SENT: ' + data);
        };

        connection.addHandler(onMessage, null, 'message', null, null, null);
        connection.ping.addPingHandler(pingHandler);
        connection.connect(messageCatcher.serverSettings.clientUser + '@' +     messageCatcher.serverSettings.xmppDomain,
                   messageCatcher.serverSettings.clientUserPassword,
                   onConnect, 300, undefined, messageCatcher.serverSettings.route);

        log('Strophe is connected.');
    }

function onConnect(status) {
    switch (status) {
        case Strophe.Status.ERROR:              // 0
            log('ERROR');
            StandardErrorHandler({ "Message": "XMPP Connection Error", "Status": "ERROR" });
            break;
        case Strophe.Status.CONNECTING:         // 1
            log('CONNECTING');
            break;
        case Strophe.Status.CONNFAIL:           // 2
            log('CONNFAIL');
            StandardErrorHandler({ "Message": "XMPP Connection Error", "Status": "CONNFAIL" });
            break;
        case Strophe.Status.AUTHENTICATING:     // 3
            log('AUTHENTICATING');
            break;
        case Strophe.Status.AUTHFAIL:           // 4
            log('AUTHFAIL');
            StandardErrorHandler("XMPP AUTHFAIL");
            break;
        case Strophe.Status.CONNECTED:          // 5
            log('CONNECTED');
            callHandlers(connectHandlers);
            break;
        case Strophe.Status.DISCONNECTED:       // 6
            log('DISCONNECTED');
            onDisconnect();
            break;
        case Strophe.Status.DISCONNECTING:      // 7
            log('DISCONNECTING');
            break;
        case Strophe.Status.ATTACHED:           // 8
            log('ATTACHED');
            break;
        default:
            log('UKNOWN STATUS CODE');
            break;
    }

    if (status == Strophe.Status.CONNECTED && !presenceSent) {
        var pres = $pres({
            //type: 'available'

        });
        connection.send(pres);
        presenceSent = true;

        log("PRESENCE SENT - SID: " + connection.sid);
    }
} 
```

# asp.net - Listing orders and passing ISO 8601 date to Amazon MWS

> ID：11563047
> 
> 赞同：0
> 
> 时间：2012-07-19T14:29:51.040
> 
> 标签：asp.net, amazon-mws

What would be the best way to retrieve orders from Amazon MWS?

My current code is as follows...

```
MarketplaceWebServiceOrdersConfig config = new MarketplaceWebServiceOrdersConfig();
config.ServiceURL = productsURL;

MarketplaceWebServiceOrders.MarketplaceWebServiceOrdersClient service = new MarketplaceWebServiceOrdersClient(appname, version, accesskeyID, secretkey, config);             

ListOrdersRequest request = new ListOrdersRequest();
request.MarketplaceId = new MarketplaceIdList();
request.MarketplaceId.Id = new List<string>(new string[] { marketids[0] });
request.SellerId = merchantID;
request.OrderStatus = new OrderStatusList() { Status = new List<OrderStatusEnum>() { OrderStatusEnum.Unshipped, OrderStatusEnum.PartiallyShipped } };
request.CreatedAfter = Convert.ToDateTime(dc.Settings.SingleOrDefault().lastOrdersRetrieved);

ListOrdersResponse response = service.ListOrders(request); 
```

I am having issues passing the ISO Date across, also if you see any other issues with the code please feel free to let me know.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:33:42.697

如果您在提出请求的那一秒后寻找创建的东西，它根本找不到任何东西，因为在亚马逊上，您最多只能获取最后 2 分钟的订单数据。

我在尝试从现在设置时间时遇到问题 - 5 分钟。在与亚马逊支持人员交谈后，他们提供了以下信息：“

> 在 Orders API 中，如果您不指定结束时间（CreatedBefore 或 LastUpdatedBefore），它将假定现在（实际上，现在减去 2 分钟）。在它的回应中，它会准确地告诉你它用什么时间作为截止时间。”

在您的情况下，您将希望删除`CreatedAfter`请求并让亚马逊为您选择。

如果您正在寻找 created after，您可以获取 Amazon 给出的响应时间并将其传递给您的 created after 参数。

我现在列出订单的方法如下，请注意，这只会列出要控制台的订单，但返回的数据都是一样的：

```
public List<string> ListOrders(MarketplaceWebServiceOrders.MarketplaceWebServiceOrders    service, string merchantId, List<OrderStatusEnum> orderStatus)
    {
        List<string> salesOrderIds = new List<string>();

        ListOrdersRequest listOrdersRequest = new ListOrdersRequest();

        DateTime createdAfter = DateTime.Now.Add(new TimeSpan(-1, 0, 0));
        DateTime createdbefore = DateTime.Now.Add(new TimeSpan(0, -15, 0));

        listOrdersRequest.CreatedAfter = createdAfter;
        listOrdersRequest.CreatedBefore = createdbefore;
        listOrdersRequest.SellerId = merchantId;
        listOrdersRequest.OrderStatus = new OrderStatusList();

        foreach (OrderStatusEnum status in orderStatus)
        {
            listOrdersRequest.OrderStatus.Status.Add(status);
        }

        listOrdersRequest.FulfillmentChannel = new FulfillmentChannelList();
        listOrdersRequest.FulfillmentChannel.Channel = new List<FulfillmentChannelEnum>();
        listOrdersRequest.FulfillmentChannel.Channel.Add(FulfillmentChannelEnum.MFN);

        listOrdersRequest.MarketplaceId = new MarketplaceIdList();
        listOrdersRequest.MarketplaceId.Id = new List<string>();
        listOrdersRequest.MarketplaceId.Id.Add("yourID");

        ListOrdersResponse listOrdersResponse = service.ListOrders(listOrdersRequest);

        int i = 0;

        foreach (Order order in listOrdersResponse.ListOrdersResult.Orders.Order)
        {
            i++;
            Console.WriteLine("Amazon Order ID:             \t" + order.AmazonOrderId);
            Console.WriteLine("Buyer Name:                  \t" + order.BuyerName);
            Console.WriteLine("Buyer Email:                 \t" + order.BuyerEmail);
            Console.WriteLine("Fulfillment Channel:         \t" + order.FulfillmentChannel);
            Console.WriteLine("Order Status:                \t" + order.OrderStatus);
            Console.WriteLine("Order Total:                 \t" + order.OrderTotal);
            Console.WriteLine("Number of Items Shipped:     \t" + order.NumberOfItemsShipped);
            Console.WriteLine("Number of Items Unshipped:   \t" + order.NumberOfItemsUnshipped);
            Console.WriteLine("Purchase Date:               \t" + order.PurchaseDate);
            Console.WriteLine("===========================================================");

            salesOrderIds.Add(order.AmazonOrderId);

        }

        Console.WriteLine("We returned a total of {0} records. ", i);
        return salesOrderIds;
    } 
```

# iphone - 如何从 iphone 的后台进程重新加载 UIViewcontroller？

> ID：11563052
> 
> 赞同：0
> 
> 时间：2012-07-19T14:30:05.393
> 
> 标签：iphone, ios, uiviewcontroller, reload

目前我正在使用简单的 iphone 应用程序，获取当前设备区域以显示在文本字段中，当我更改区域应用程序运行时间时，按主页按钮应用程序进入后台进程，然后我选择任何区域，再次从后台打开应用程序该区域无法在该文本字段中更改，但导航另一个屏幕然后进入上一个屏幕区域已更改，但我不想导航到任何其他屏幕，区域自动更改，所以如何重新加载`UIViewController`，请任何人帮助我。

提前致谢

```
-(void)viewDidLoad
{

NSDecimalNumber *amountt = [NSDecimalNumber decimalNumberWithString:@"10.00"];
    NSNumberFormatter *currencyFormatt = [[NSNumberFormatter alloc] init];
    NSLocale *locale = [NSLocale currentLocale];
    [currencyFormatt setNumberStyle:NSNumberFormatterCurrencyStyle];
    [currencyFormatt setLocale:locale];

    NSString *symboll = [NSString stringWithFormat:@"%@",[currencyFormatt stringFromNumber:amountt]];
    NSString *getsymbol = [symboll stringByReplacingOccurrencesOfString:@"10.00" withString:@""];
    NSString *Getdollarsymbol = [getsymbol stringByReplacingOccurrencesOfString:@"10,00" withString:@""];
    NSLog(@"Getdollarsymbol:%@",Getdollarsymbol);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:35:32.237

您需要查看您的应用程序委托。你可以调用你的 UIViewController 从那里更新自己。

```
- (void)applicationDidBecomeActive:(UIApplication *)application 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:37:41.910

您可能还想收听关于

```
UIApplicationDidBecomeActiveNotification 
```

通过 NSNotificationCenter，如果您的应用再次激活，将触发此通知。

# spring - 在不使用 JPA 的情况下使用 Spring Roo 处理 MVC 和 Vaadin

> ID：11563058
> 
> 赞同：0
> 
> 时间：2012-07-19T14:30:29.483
> 
> 标签：spring, spring-mvc, spring-roo

我正在为我们正在启动的一个新项目评估 spring roo。我似乎遇到的问题是我没有为数据库使用 Hibernate 或任何其他 ORM 包。我们正在使用 Mybatis。这意味着我们不希望在我们的项目中安装 JPA。

每次我输入提示时，roo 都会告诉我必须安装 JPA（不想这样做，因为 Mybatis 不使用 JPA）。但真正影响我的是当我做这样的事情时

```
web mvc scaffold --class ~.web.controller.FirstController 
```

它返回这个

```
Command 'web mvc scaffold --class ~.web.controller.FirstController' was found but is not currently available (type 'help' then ENTER to learn about this command) 
```

这是否意味着 roo 不会在没有 JPA 的情况下允许这些其他功能？有没有办法让 roo 在不安装 JPA 的情况下使用这些功能？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T10:32:13.460

您将需要 JPA 才能使用 spring roo。但是，您可以稍后将其取出。您可以创建让它为您创建存储库类。然后，您可以通过添加 mybatis 注释轻松地将这些转换为 mybatis 样式。

# javascript - 使用 Javascript 将变量写入第二个 HTML 文件

> ID：11563059
> 
> 赞同：1
> 
> 时间：2012-07-19T14:30:30.280
> 
> 标签：javascript, html, hyperlink

我有 2 个 HTML 文件和 1 个 javascript 文件，index.html、results.html 和 file.js

在 index.html 中，我检索用于在 javascript 文件中进行一些计算的用户输入。按下按钮时开始计算。现在我想显示从 index.html 检索到的数据以显示在 results.html 上，因此当按下按钮时，它应该运行该函数并转到另一个页面。

计算结果并在 1 页上显示结果一切正常，但我不知道如何在 results.html 上显示结果。

这是一段代码的样子：

```
function berekenKoolBehoefte(){
    koolBehoefte = (energieBehoefte - (eiwitBehoefte * 4) - vetBehoefte) / 4;
    toonKool();
}

function toonKool(){
    var uitkomstKool = document.getElementById("uitkomstKool");
    uitkomstKool.innerHTML = (koolBehoefte * 4).toFixed(1) + " kcal" + " " +     koolBehoefte.toFixed(1) + " gram"
}
bereken.addEventListener('click', berekenKoolBehoefte, false); 
```

这显示在 1 页上，知道函数 toonKool() 应该显示在 results.html 中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:33:50.833

在这种情况下，最好的选择是使用：

*   服务器端存储值并从那里获取结果
*   cookies - 如果是小数据，只需将其放入 cookie 中。有关如何使用纯 javascript 的 cookie 的更多信息，请查看[此处](http://www.w3schools.com/js/js_cookies.asp)
*   将您的结果附加到 url，然后用 JS 解析它们。[你可以在这里](https://stackoverflow.com/questions/4140324/parse-url-with-javascript)看到它是如何完成的
*   iFrame - 您可以将结果附加到 iframe 中并访问数据。这个方法很好，但就我的口味来说——太糟糕了

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:43:14.030

我认为你最好：

1）在按钮周围的页面上创建表单。

2）在表单提交时进行计算并将结果放入表单中的隐藏字段（或将所有字段发布到服务器端）。然后，您要传递的所有参数都可以在第二页的服务器上访问。

3) 使用之前的 GET 或 POST 参数显示第二页。

Cookie 是您可能忘记清除的东西，而且管理起来要困难得多。

iframe 中的计算比使用 ajax 差得多。您可以使用 ajax 部分加载第二页，然后所有 javascript 变量都将保留。

# html - 自动更新年龄

> ID：11563060
> 
> 赞同：-6
> 
> 时间：2012-07-19T14:30:32.490
> 
> 标签：html

我有一个关于部分的网站。有一些关于我的文字，包括我现在的年龄。像我一样懒惰，我不想在每个生日之后改变那个日期。

是否有一个简单的脚本可以根据我的生日显示我的年龄？我在网上没有找到类似的东西。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:35:21.923

你可以用javascript来做。这应该足以让你开始..

```
// The date you were born
var birthDate = new Date(1990, 6, 19, 0, 0, 0, 0);

// The current date
var currentDate = new Date();

// The age in years
var age = currentDate.getFullYear() - birthDate.getFullYear();

// Compare the months
var month = currentDate.getMonth() - birthDate.getMonth();

// Compare the days
var day = currentDate.getDate() - birthDate.getDate();

// If the date has already happened this year
if ( month < 0 || month == 0 && day < 0 )
{
    age--;
}

alert( age ); 
```

# windows - Windows 8 包裹面板

> ID：11563062
> 
> 赞同：9
> 
> 时间：2012-07-19T14:30:39.183
> 
> 标签：windows, windows-8, microsoft-metro, winrt-xaml

我遇到了自动将 StackPanel 分解到下一行的问题。这是示例代码：

```
<StackPanel Orientation="Horizontal" Width="180">
   <TextBlock.../>
   <TextBlock.../>
   <TextBlock.../>
   <Image.../>
    ...
</StackPanel> 
```

现在我想实现这样的目标：当 StackPanel 中的另一个元素没有足够的空间时，它应该放在新行中。我怎样才能做到这一点（没有必要使用stackpanel）？

PS：我的目标是将文本和图像放在一行中（当没有足够的空间容纳另一个元素时，它当然会中断）。也许您可以提供比使用文本块和图像更好的解决方案？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-19T16:31:03.773

试试 WrapGrid，它应该做你想做的事：http: [//msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.wrapgrid.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.wrapgrid.aspx)

唯一的问题（这不是一件坏事）是 WrapGrid 只能在 ItemsControl 中显示项目，因此请以这种方式使用它（将 ListView 更改为任何 ItemsControl）：

```
<ListView.ItemsPanel>
    <ItemsPanelTemplate>
        <WrapGrid Orientation="Horizontal" />
    </ItemsPanelTemplate>
</ListView.ItemsPanel> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:47:45.423

使用 VariabeSizedWrapGrid 而不是 StackPanel，请参阅[http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.variablesizedwrapgrid.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.variablesizedwrapgrid.aspx)

对于多个 TextBlock，请考虑使用具有多个 Run 的单个 textBlock。您的图像当然不能包含在运行中，但是一个带有两个运行的 TextBlock 比两个连续的 TextBlock 更好。

更新：这实际上可能根本无法帮助您获得所需的布局。您可能需要查看 RichTextBlock 控件，请参阅[http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.richtextblock.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.richtextblock.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T19:09:54.603

开箱即用，没有可用于 WinRT 的 WrapPanel。至少现在不是……但是与此同时，有一种解决方法……我已经对其进行了测试并且可以正常工作。

您可以在以下链接中查看以下链接。

[http://www.codeproject.com/Articles/24141/WrapPanel-for-Silverlight-2-0](http://www.codeproject.com/Articles/24141/WrapPanel-for-Silverlight-2-0)

由于 WrapPanel 继承自 Panel 类，因此您可以创建 WrapPanel 或简单地使用上述 SLV 2 应用程序中的 WrapPanel.cs 代码。

然后简单地包含类似的代码

xmlns:wrapPanel="使用:yourWinRTApp"
....

<wrapPanel:WrapPanel Orientation="Horizo​​ntal" Width="400" >
....
</wrapPanel:WrapPanel>

它应该可以解决问题...

资料取自：

[http://www.michielpost.nl/PostDetail_75.aspx](http://www.michielpost.nl/PostDetail_75.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T14:34:02.097

您可能会使用 GridView，它具有与 WrapPanel 类似的布局行为。

# asp.net - 在与 ASP.Net 应用程序相同的端口上启动 .Net Web 服务

> ID：11563064
> 
> 赞同：7
> 
> 时间：2012-07-19T14:30:53.083
> 
> 标签：asp.net, visual-studio-2010, web-services, rest, cassini

我们有一个包含 2 个项目的简单 Visual Studio 解决方案：

*   A.) 简单的 ASP.Net 网站
*   B.) 托管在另一个 ASP.Net 应用程序中的 RESTful Web 服务

我们想简单地以调试模式 (F5) 启动项目，并让 A 通过 Ajax 使用来自 B 的数据。我们不可能在所有开发机器上配置 IIS（因为其中一些在客户端）。问题可能是 JavaScript 需要与它发布到的 URL 位于同一个域中。

有什么方法可以使用 Visual Studio 2010 Development Server 在同一端口上以调试模式同时启动两个应用程序？

如果这是不可能的，你可以推荐的下一个最好的事情是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:02:55.887

我们通过在开发工作站上安装 IIS 解决了这个问题。在每个 Visual Studio 项目中，在 Web 属性页上，选择使用本地 IIS Web 服务器。不要选中使用 IIS Express。项目 URL 将设置为 http:localhost/<projectname>（注意：在同一个域中）。系统将提示您为每个目录创建一个虚拟目录。每个都将分配给默认的 IIS 应用程序池。打开 Internet 信息服务 (IIS) 管理器。单击左侧窗格中的应用程序池。在右侧窗格中添加另一个集成应用程序池。对于其中一个应用程序，打开高级设置... 在属性视图中，选择您刚刚创建的应用程序池作为应用程序池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:07:36.563

Yo 将无法在 Cassini 实例的同一端口上托管不同的应用程序，有些工具可能有用，但我会让 Cassini 将它们托管在不同的端口上，这是它的常规行为。

选项是（未测试）：

[UltiDev](http://ultidev.com/products/UWS-Cassini-Pro/)

[卡西尼扩展](http://www.systemex.net/CassiniEx/)

顺便说一句，不确定您是否知道这一点，但是要启动两个项目，请转到**Set startup projects ，****解决方案**上下文菜单上有一个选项。

# java - 使用反射（或类似的东西）来做泛型类型的运行时确定？

> ID：11563066
> 
> 赞同：0
> 
> 时间：2012-07-19T14:31:09.027
> 
> 标签：java, generics, reflection

> **可能重复：**
> [在java中使用反射](https://stackoverflow.com/questions/1901164/get-type-of-a-generic-parameter-in-java-with-reflection)
> [获取泛型参数的类型在运行时获取类的泛型类型](https://stackoverflow.com/questions/3403909/get-generic-type-of-class-at-runtime)

假设我有这样的课程：

```
public class Foo<T, M> {
  Pair<T, M> bar;
} 
```

有没有办法在运行时确定“T”和“M”是什么？例如

```
Foo<String, Integer> foo1 = new Foo<String, Integer>();
Foo<Integer, Boolean> foo2 = new Foo<Integer, Boolean>();
// what happens next? 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T14:32:36.110

不，没有。这几乎就是类型擦除的定义。

也就是说，有一些时髦的解决方法。您可以显式查找该对的组件，并询问它们的类型。您可以对匿名内部类使用很酷的技巧，例如 Guava[`TypeToken`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/reflect/TypeToken.html)使用的——你不能`new Foo<String, Integer>()`在运行时确定类型，但你*可以*在运行时确定类型`new Foo<String, Integer>() {}`——注意匿名内部类，它*确实*保留了泛型参数为其超类指定，即`Foo`. （披露：我为 Guava 做出了贡献。）

通常，最好的解决方案是首先避免需要这些信息。没有关于如何做到这一点的通用食谱，但通常是可能的。

综上所述，解决此需求的唯一通用解决方案是`Class`显式传递元数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:33:56.937

运行时通用信息将被删除。一旦你的类编译，所有的泛型类型信息将被[删除](http://docs.oracle.com/javase/tutorial/java/generics/erasure.html)和替换：

> 泛型类型中的所有类型参数及其边界或 Object（如果类型参数是无界的）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T14:45:33.673

实际上，`java.lang.reflect.Field`保留了通用信息；因此，通过反射，您可以获得通用信息，但仅限于类/实例变量（不是方法返回类型，也不是局部变量）。

因此，在您的情况下，如果 foo1 和 foo2 是某个类中的实例变量：

```
class FooTest {
    Foo<String, Boolean> foo1;
} 
```

然后`FooTest.class.getDeclaredField("foo1").getGenericType()`将返回一个`ParameterizedType`实例，您可以在其中检查`getActualTypeArguments()`.

# jenkins - 声纳显示 0% Emma 覆盖率报告

> ID：11563069
> 
> 赞同：0
> 
> 时间：2012-07-19T14:31:19.003
> 
> 标签：jenkins, sonarqube, emma

我同意很多人多次提出这个问题，并且已经提供了许多解决方案。然而，在参考了无数链接之后，无法在 Sonar 中显示 Emma 报告让我发疯了。下面是对我正在尝试做的事情的描述。

我的 java 项目是一个多模块 maven 项目。我们使用 EMMA 作为代码覆盖工具，使用 Jenkins 构建项目，Sonar 分析代码并使用 Jenkins 声纳插件为我们的构建作业配置 Sonar。到目前为止，这个故事很棒。当我尝试在声纳分析期间重用 Emma 生成的报告时，问题就出现了。在构建过程中，Sonar 分析日志中没有明显的错误，但是，在 Sonar 项目仪表板中，覆盖率报告为 0%。以下是我在 Jenkins 构建作业的声纳配置部分提供的配置数据。

```
-Dsonar.core.codeCoveragePlugin=emma
-Dsonar.emma.reportPath=/target
-Dsonar.dynamicAnalysis=reuseReports
-Dsonar.surefire.reportsPath=/target/surefire-reports 
```

声纳版本：3.0

艾玛插件版本：

```
emma-maven-plugin : 1.0-alpha-2 
Sonar Emma Plugin :1.0.1 
emma : 2.0.5312 
```

Maven 构建在各个模块的目标文件夹中生成 coverage.em 文件。不生成coverage.ec 文件。声纳必须同时拥有coverage.ec 和coverage.em 文件吗？

在项目构建目录/emma文件夹下生成coverage.es,html,txt,xml文件

模块的声纳分析日志如下所示。

```
[INFO] [15:06:02.829] Sensor org.sonar.plugins.emma.EmmaSensor@bfc33...
[WARN] [15:06:02.844] Resource will be ignored in next Sonar versions, index is locked: com.mycompany.mypackage.tests.util.Activator
[INFO] [15:06:02.876] Sensor org.sonar.plugins.emma.EmmaSensor@bfc33 done: 47 ms 
```

上面的日志让我觉得 Sonar 确实在使用生成的 Emma 报告做一些事情，但没有在 Sonar 项目仪表板上显示任何内容。

请让我知道我可能在哪里出错或需要做哪些额外的事情才能使其正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:22:16.767

我认为这个线程可能对我有用。[http://sonar.15.n6.nabble.com/Receiving-quot-index-is-locked-quot-warning-when-Emma-sensor-runs-td4676490.html](http://sonar.15.n6.nabble.com/Receiving-quot-index-is-locked-quot-warning-when-Emma-sensor-runs-td4676490.html) 它描述了同样的问题并为您提供了一些解决方法

# javascript - dojo.byId("something").value 在 IE 兼容视图上获取脚本错误

> ID：11563071
> 
> 赞同：0
> 
> 时间：2012-07-19T14:31:29.573
> 
> 标签：javascript, spring, internet-explorer, dojo

相同的代码适用于 FF 和 chrome，但 IE 是唯一的

代码行在这里：

```
dojo.byId("form_assigned_orders").value = orderIds; 
```

很简单，只需将数组值传递给组件。但是当我单击表单的保存按钮时，出现此错误：

```
Message: Unable to set value of the property 'value': object is null or undefined 
```

有人有想法吗？提前致谢。

# vba - VBA Excel PageSetup 标题未打印

> ID：11563077
> 
> 赞同：2
> 
> 时间：2012-07-19T14:32:01.777
> 
> 标签：vba, excel

我有一些代码可以在 Workbook_BeforePrint 方法中更新 Excel 页面标题：

```
Private Sub Workbook_BeforePrint(Cancel As Boolean)
    Dim ws As Worksheet
    Set ws = Worksheets("Sheet1")
    ws.PageSetup.LeftHeader = ws.Range("A1").Value
End Sub

Public Sub PrintSheet()
    Worksheets("Sheet1").PrintOut
End Sub 
```

当我在不先进入打印预览的情况下打印时，标题不会更新。

当我首先去打印预览时，添加了标题。

我如何确保在打印时正确更新页眉并先进行打印预览？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:00:52.303

它对我来说按预期工作。

确保 Worksheets("Sheet1").Range("A1") 实际上有一些东西。还要检查工作表名称以确保它是正确的。工作表具有可通过 UI 更改的 Name 属性和可通过代码或“属性”对话框更改的 CodeName 属性。仔细检查你没有混淆他们。您的代码 Worksheets("Sheet1") 使用 Name 属性（选项卡名称）。

此外，请确保您没有在某些调用过程中禁用事件。您可以在 PrintSheet 中添加一条语句，例如

```
Debug.Print Application.EnableEvents 
```

以确保堆栈中的某些内容不会禁用事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-20T22:22:06.040

对标题进行更改后，尝试添加行“Application.PrintCommunication = True”

# php - {plain} 数据库中的密码和登录错误

> ID：11563078
> 
> 赞同：0
> 
> 时间：2012-07-19T14:32:13.510
> 
> 标签：php, mysql, innodb, login-script

我正在编写登录面板以访问管理面板。数据（用户名和密码）存储在 MySQL 数据库（类型：InnoDB）中。在表格中查看密码以纯格式存储，并且在字段密码中我有：{plain}password。

改编我已经拥有的代码，我遇到了一些问题，因为那个 {plain} 事情让我有点困惑。

我的旧代码是：

```
// Construct SQL statement for query & execute 
$sql = "SELECT * FROM table WHERE user = '" . $username . "' AND password = '" . md5($password) . "'"; 
$result = $mysqli->query($sql) or die(mysql_error()); 
```

因此，如果我将数据库字段中的“{plain}password”替换为 MD5 密码，则代码效果很好，但如果我将代码修改为以下代码：

```
// Construct SQL statement for query & execute 
$sql = "SELECT * FROM table WHERE user = '" . $username . "' AND password = '" . $password . "'"; 
$result = $mysqli->query($sql) or die(mysql_error()); 
```

我无法登录，因为密码错误！

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:35:51.360

我不确定是什么`{plain}`意思，我猜它表明密码是纯文本的——而且这个字符串实际上是存在的。因此，您的第二个 SQL 应该包括它：

```
$sql = "SELECT * FROM table WHERE user = '" . mysql_real_escape_string($username) . "' AND password = '{plain}" . mysql_real_escape_string($password) . "'"; 
```

请注意，我并不是在开始讨论以纯文本形式存储管理员密码，而是纯粹回答技术问题。但是我**必须**说存储纯文本密码是一个非常糟糕的主意。

另请注意，我添加`mysql_real_escape_string`以清理您的输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:36:44.200

如果真实密码前有前缀“{plain}”，则必须调整查询以包含该前缀。

```
$sql = "SELECT * FROM table WHERE user = '" . $username . "' AND password = '{plain}" . $password . "'"; 
$result = $mysqli->query($sql) or die($mysqli->error()); 
```

另请注意，您应该更改命令以使用`mysql_error()`函数（所以使用）。`die()``mysqli``$mysqli->error`

PS：你应该看看现在如何存储密码。以纯文本形式存储它们无论如何都不安全。

**编辑**

在这里也提到了@BrianRasmussen 的评论：在查询中直接使用（使用字符串 concat）之前，请确保`$username`并已经过清理！`$password`否则，您的代码对各种 SQL 注入开放。

# javascript - 单击时取消选择单选按钮

> ID：11563080
> 
> 赞同：2
> 
> 时间：2012-07-19T14:32:21.103
> 
> 标签：javascript, jquery, html, radio-button

我正在尝试通过单击 jquery 来取消选择单选按钮。

**通缉行为：**

1.  **如果已选中单击的单选按钮，请取消选中**
2.  **如果未选中单击的单选按钮，请检查**

这是我的小提琴：http: [//jsfiddle.net/2te28/15/](http://jsfiddle.net/2te28/15/)

和我的代码：

```
$('.table').on('click mousedown', '.radio', function() {
    if($(this).attr('id') == $(this).parents('tr').find('.radio:checked').attr('id'))
        $(this).removeAttr('checked');
}); 
```

我的问题是它总是取消选中我点击的任何内容。
**编辑：更正了 id 转录错误**
**EDIT2：不能同时选择两个单选按钮！**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T15:03:19.700

更改您的 HTML。你已经改变了`id`，但你也必须改变 then `name`。

```
$('.table').on('click', '.radio', function() {
  if (this.getAttribute('checked')) { // check the presence of checked attr
    $(this).removeAttr('checked'); // if present remove that
  } else {
    $(this).attr('checked', true); // if not then make checked
  }
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<table class="table">
  <tr>
    <td>
      <input type="radio" id="radio1" name="1" checked="checked" class="radio" />
      <input type="radio" id="radio2" name="2" checked="checked" class="radio" />
    </td>
  </tr>
</table>
```

**[演示](http://jsfiddle.net/2te28/64/)**

### 根据评论

```
$('.table').on('click', '.radio', function() {
  if (this.getAttribute('checked')) {
    $(this).removeAttr('checked');
    $(this).siblings('.radio').attr('checked', false);
  } else {
    $(this).attr('checked', true);
    $(this).siblings('.radio').removeAttr('checked');
  }
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<table class="table">
  <tr>
    <td>
      <input type="radio" id="radio1" name="1" checked="checked" class="radio" />
      <input type="radio" id="radio2" name="2" checked="checked" class="radio" />
    </td>
  </tr>
</table>
```

**[演示](http://jsfiddle.net/2te28/67/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:47:46.730

检查这个演示：http: [//jsfiddle.net/535dR/1/](http://jsfiddle.net/535dR/1/)

**代码：**

```
$('.table input[type="radio"]').on('mouseup', function() {
    var radio = $(this);
    if(radio.prop('nc') == 0) {
        setTimeout(function() {
            // *to work: this needs to run only after the event completes*
            if(radio.is(':checked')) radio.removeAttr('checked');
            radio.prop('nc', 1);
        }, 10); 
    }
    else radio.prop('nc', 0);
}); 
```

**更新演示：http:** [//jsfiddle.net/535dR/3/](http://jsfiddle.net/535dR/3/)

评论中提到的两点都解决了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:01:07.270

这是一个简单的工作 JSFiddle：http: [//jsfiddle.net/2te28/61/](http://jsfiddle.net/2te28/61/)

代表单选按钮的 html 标记的`<id>`and必须是唯一的，因此更改为：`<name>`

```
<input type="radio" id="radio1" name="1"  class="radio"/>
<input type="radio" id="radio2" name="2"  class="radio"/> 
```

然后，您可以添加一些简单的 JQuery 代码：

```
var radioChecked = $('.table .radio').is(':checked');

$('.table .radio').click(function() {
    radioChecked = !radioChecked;
    $(this).attr('checked', radioChecked);
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T07:58:19.173

```
<input type="radio" id="radio1" name="1"  class="radio"/>
<input type="radio" id="radio2" name="2"  class="radio"/> 
```

那么你只需要添加

```
$('.radio').click(function(){

value = $(this).val();

if(val == 1){

$('#radio1').removeAttr('checked');

}

else{

$('#radio2').removeAttr('checked');

}

}); 
```

这对我有用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-11T14:08:34.210

我所做的非常简单。

我一`RadioButton.style.textDecoration = "none"`开始就定了。`RadioButton`这对元素没有任何影响，但设置仍然存在。

然后，在`OnClick`活动中，我检查`textDecoration`. 如果是`"none"`我设置`RadioButton.checked = true`和`textDecoration = "underline"`

如果是`"underline"`我设置`RadioButton.checked = false`和`textDecoration = "none"`

# asp.net-mvc-3 - 如何将表单发布到外部站点以显示在 iframe 中

> ID：11563081
> 
> 赞同：0
> 
> 时间：2012-07-19T14:32:20.727
> 
> 标签：asp.net-mvc-3, model-view-controller

我正在使用 MVC 和 C#，我需要将表单发布到外部**支付**网站。但我希望结果页面出现在我的视图中的 iframe 中。

```
<form id='myform' action="https://externalsite.somewhere" method="post" target="myframe">
   @Html.HiddenFor(model => model.SomeData)
   @Html.HiddenFor(model => model.MoreData)        
   <input type="submit" value="do it"/>
</form>
<iframe id="myframe" width="600px" height="600px"></iframe> 
```

我可能会以错误的方式解决这个问题，我以前从未这样做过，所以如果您对此有任何建议或建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:39:09.070

只需`<iframe>`在视图内部创建并让`src`此 iframe 指向一个控制器操作，该操作将为包含此表单的视图提供服务。当用户提交表单时，他会被重定向到 iframe 内的支付网站。

# php - 当我通过 jQuery .load() 加载 tinyMCE 时浏览器冻结

> ID：11563082
> 
> 赞同：5
> 
> 时间：2012-07-19T14:32:24.733
> 
> 标签：php, jquery, tinymce

我遇到了一个问题，挣扎了几个小时。我正在使用 jQuery 加载来加载一个包含 tinyMCE 及其脚本（wordpress）的 php 页面

```
 $('.quickedit_form_' + parentID).load('<?php bloginfo('template_directory'); ?>/ajax/quickedit.php?id=' + parent.attr('id').replace('post-', ''), function(){
        tinyMCE.init({ 
            skin: 'wp_theme'
        });
        $.scrollTo(parent, 800, {offset: {left: 0, top: -61}});
    }); 
```

还有我的 php 页面（quickedit.php）

```
<?php

// include WordPress
require('../../../../wp-blog-header.php');

// get post
global $current_user;
$id = $_GET['id'];
$post = get_post($id);
if ($current_user->ID != $post->post_author) {
    wp_die(__('Unauthorized access.','sofa'));
}

?>

<h1 class="quickedit_h"><?php printf(__('Editing Post #%s','sofa'), $post->ID); ?></h1>

<label for="edit_title_<?php echo $id; ?>" class="quickedit_label"><?php _e('Title:','sofa'); ?></label>
<input type="text" name="edit_title_<?php echo $id; ?>" id="edit_title_<?php echo $id; ?>" value="<?php echo $post->post_title; ?>" class="quickedit_field" />

<label for="edit_type_<?php echo $id; ?>" class="quickedit_label"><?php _e('Post Type:','sofa'); ?></label>
<select name="edit_type_<?php echo $id; ?>" id="edit_type_<?php echo $id; ?>" class="quickedit_select">
    <option value="text"<?php selected("text", sofa_post_type()); ?>><?php _e('Blog','sofa'); ?></option>
    <option value="image"<?php selected("image", sofa_post_type()); ?>><?php _e('Image','sofa'); ?></option>
    <option value="video"<?php selected("video", sofa_post_type()); ?>><?php _e('Video','sofa'); ?></option>
</select>

<div class="quickedit_save"><input type="button" value="<?php _e('Save','sofa'); ?>" class="button-secondary" /></div>

<?php
wp_editor( $post->post_content, 'edit_content_'.$id, $settings =  array(
    'wpautop' => true,
    'media_buttons' => true,
    'textarea_name' => 'edit_content_'.$id,
    'textarea_rows' => 10,
    'tabindex' => '',
    'editor_css' => '',
    'editor_class' => 'edit_content',
    'teeny' => false,
    'dfw' => false,
    'tinymce' => true,
    'quicktags' => true
));
?>

<div class="quickedit_save"><input type="button" value="<?php _e('Save','sofa'); ?>" class="button-secondary" /></div>

<?php wp_footer(); ?> 
```

当我直接在浏览器中访问 quickload.php 时，一切都加载顺利，没有延迟或任何东西。但是当我通过 jQuery .load() 访问它时，tinymce 和按钮需要大约 15 秒才能加载，在 Firefox 和 chrome 中都尝试过冻结浏览器（用户无法与任何东西交互）。

任何人都可以向我建议为什么会发生这种情况，已经尝试了几个小时.. :(

**注意：当我直接访问 quickedit.php 时，tinymce 加载得很好而且很快。从 jquery .load 函数调用它时会发生崩溃/冻结。**

我需要任何可能导致此问题的指示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:27:32.483

我会尝试使用 jQuery 的低级 ajax 接口：jQuery.ajax

```
jQuery(function($) {
  var ajax_url = '<?php bloginfo('template_directory'); ?>/ajax/quickedit.php?id=' + parent.attr('id').replace('post-', ''); //Included for readability
  //Check if the elem is in the DOM, if so, load it via AJAX
  if ($('.quickedit_form_' + parentID).length >0) {
    $.ajax({ 
       url: ajax_url
       complete: function  () {
          tinyMCE.init({ 
          skin: 'wp_theme'
          });
         $.scrollTo(parent, 800, {offset: {left: 0, top: -61}});
       }
    });
  }
}); 
```

您可能遇到错误的原因是 jQuery.load 的多参数性质（加上我认为它已被弃用......？）可能导致同步（阻塞）请求。

# charts - JFreeChart：如何在 y 轴上显示小时格式

> ID：11563087
> 
> 赞同：4
> 
> 时间：2012-07-19T14:32:44.127
> 
> 标签：charts, jfreechart

我找不到如何修改 y 轴的标签。现在我将 TimeSeries 与 MINUTE 类一起使用，然后将 TimeSeries 插入数据集中。它看起来像这样：

```
 final TimeSeries s1 = new TimeSeries("Importation Time", Minute.class);
   s1.add(new Minute(dateFinal),concateHourAndMinuteToGetASingleValue);
   dataset.addSeries(s1); 
```

我想做的是修改显示标签，并放置一个字符串（例如 05h20）而不是 Double 值。

任何帮助将非常感激 ：）

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:05:38.983

您将需要`FormatOverride`在`axis`.

这是 a`NumberAxis`和 a的示例`DateAxis`

```
XYPlot plot = (XYPlot) chart.getPlot();

NumberAxis rangeAxis = (NumberAxis) plot.getRangeAxis();
rangeAxis.setNumberFormatOverride( new NumberFormat(){

    @Override
    public StringBuffer format(double number, StringBuffer toAppendTo, FieldPosition pos) {
        return new StringBuffer(String.format("%f", number));
    }

    @Override
    public StringBuffer format(long number, StringBuffer toAppendTo, FieldPosition pos) {
        return new StringBuffer(String.format("%f", number));
    }

    @Override
    public Number parse(String source, ParsePosition parsePosition) {
        return null;
    }

} );
DateAxis domainAaxis = (DateAxis) plot.getDomainAxis();
domainAaxis.setDateFormatOverride(new SimpleDateFormat("MMM-yyyy")); 
```

# jquery - 在 jQuery mobile 中按下按钮时传递数据

> ID：11563092
> 
> 赞同：0
> 
> 时间：2012-07-19T14:33:02.380
> 
> 标签：jquery, jquery-mobile

我正在尝试在两页之间传递数据。

这是我到目前为止所拥有的：http: [//jsfiddle.net/8JXTT/49/](http://jsfiddle.net/8JXTT/49/)

所以我在第二页上设置一个属性： $("#secondpage").attr("val", "test value");

为了访问这个属性，我使用： var val1= $(this).attr('val');

但是对于每个“链接按钮”，值应该是不同的。

在这个小提琴中，当我应该在按钮上设置属性时，我在页面本身上设置属性？

如何修改代码以传递与每个按钮关联的唯一值，以便在按下按钮时可以在后续页面上访问该值。

小提琴代码：

**HTML**

```
<div data-role="page" id="firstpage">
    <div data-role="header">
         <h1>First Page</h1>
    </div>
    <div data-role="content" id="links"></div>
    <div data-role="footer">
         <h4>Page Footer</h4>
    </div>
</div>
<div data-role="page" id="secondpage">
    <div data-role="header"> <a href='#' class='ui-btn-left' data-icon='arrow-l' onclick="history.back(); return false">Back</a>
        <h1>Bar</h1>
    </div>
    <div id="pagecontent" data-role="content"></div>
    <div data-role="footer">
         <h4>Page Footer</h4>
    </div>
</div> 
```

**JS**

```
$(document).ready(function () {

    for (var i = 0; i < 4; i++) {

        var button = '<a data-role="button" href="#secondpage" data-theme="c" class="ui-btn ui-btn-corner-all ui-shadow ui-btn-up-c"><span class="ui-btn-inner ui-btn-corner-all"><span class="ui-btn-text">Link Button</span></span></a>';

        $('#links').append(button);

        $("#secondpage").attr("val", "test value");
    }

    $('#secondpage').live('pageshow', function () {
        var val1 = $(this).attr('val');
        $("#pagecontent").html(val1);
        console.log('val is ' + val1);
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:06:05.317

我发现您的代码存在几个问题：

1.  您在`val`创建按钮时直接设置值，而不是让按钮在单击后设置值。
2.  您应该使用`$.data`来设置数据
3.  棘手的问题是，当您为按钮创建 onclick 处理程序时，您可能会无意中创建一个“闭包”，这意味着所有单击处理程序将使用相同的值（最后一个值集）`i`。

要解决此问题，您需要 1\. 将单击事件绑定到将设置页面数据的新按钮 2\. 创建一个方法来创建一个超出循环范围的按钮，并从循环中调用它

看看更改后的代码，它应该可以工作 [http://jsfiddle.net/azZVk/12/](http://jsfiddle.net/azZVk/12/) 另外，了解一些关于闭包的知识会对您有所帮助。看看这个问题，例如： [JavaScript 闭包内循环 - 简单实用的例子](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)

# python - PIL im.putdata(seq, scale, offset) 距离偏移失败还是我弄错了？

> ID：11563100
> 
> 赞同：0
> 
> 时间：2012-07-19T14:33:27.353
> 
> 标签：python, python-imaging-library, offset

从 PIL，我尝试使用 putdata(seq, offset=distance) on 和 image im。然而，结果并不是像往常一样理解偏移的距离，偏移也出现在 ImageChops.offset() 和 Image.offset() 中。它最终导致了颜色的偏移。

例如，原始图像 im 带有数据 p：

```
p = list(im.getdata())
p[:100]
[0, 0, 0, 0, 0,......]    #make the entries 0 for easy viewing 
```

我最初的目的是将 im 偏移 9 个像素。然而，

```
im.putdata(p, offset=9)
newp=list(im.getdata())
newp[:100]
[9, 9, 9, 9, 9,......]    #result is 9 units "offset" in colour!! 
```

它导致我的图像颜色偏移了 9 个单位！！putdata() 方法真的只偏移颜色还是我做错了什么？PIL 官方文档没有指定偏移量是距离（我想是）还是颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:41:40.113

从[PIL 文档](http://www.pythonware.com/library/pil/handbook/image.htm)中：

```
pixel = value * scale + offset 
```

再清楚不过了，像素值本身是偏移的，而不是它们的位置。

也许你可以为你制造`paste`或`offset`工作。

# ruby-on-rails - Rails 3.2 事件记录

> ID：11563101
> 
> 赞同：1
> 
> 时间：2012-07-19T14:33:36.810
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, data-modeling, event-log

我有一个带有管理界面的 Rails 应用程序，允许用户对某些模型进行 CRUD 操作。客户想要一种方法来记录用户对每个模型做了什么。例如，用户删除客户等。他想跟踪谁删除/更新/创建了该客户。我正在考虑处理这个问题的最佳方法。我也很好奇那里是否有一颗已经这样做的宝石。

这是我的想法。

1.  我可以在每个模型中有一个 created_by 和 updated_by 字段。问题是跟踪deleted_by。一种方法是将客户标记为非活动状态，而不是删除实际记录。看起来很麻烦，而且我要跟踪的每个模型都会有很多重复。
2.  我可以创建一个 event_history 模型来跟踪以下字段（下面的类图）。model_record_data 字段可以存储为数组或对象吗？您可以将对象作为文本存储在 mysql 字段中吗？对我来说，这种方法的好处是我可以调用这个模型并存储我将来创建的任何模型的动作。此外，如果有人犯了错误，我可以将记录恢复到以前的状态。

    ```
    event_history ->
      model_name
      model_record_data
      action             #create/update/delete etc
      action_date        #datetime
      user_id 
    ```

我将不胜感激对此的一些反馈，我们将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:40:36.867

看看这个宝石 ( `audited`)。我相信它会做所要求的。

[https://github.com/collectiveidea/audited](https://github.com/collectiveidea/audited)

# html - Knockout Set 元素的名称

> ID：11563102
> 
> 赞同：0
> 
> 时间：2012-07-19T14:33:37.950
> 
> 标签：html, knockout.js

我怎样才能让下面的输入字段呈现如下

```
<input name= "NIALL" type="text" /> 
```

使用下面的淘汰模型和 html。请注意，我想根据淘汰模型创建元素的名称。这是我尝试过的，但它不起作用。

**HTML**

```
 <input type="text" data-bind="value: stringValue,attr: { 'name': ElementName}" /> 
```

**//淘汰模型**

```
function MyViewModel() {

  var self = this;
  self.stringValue = "sss";
  self.ElementName = "NIALL";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:58:23.157

代码很好，如果您点击开发工具工具栏上的刷新，它将在 IE 的开发工具中工作。或者在 IE 中使用 firebuglite 的小书签查看它。

# encryption - 使用 ruby 和 openssl 加密和解密示例

> ID：11563105
> 
> 赞同：0
> 
> 时间：2012-07-19T14:33:45.530
> 
> 标签：encryption, openssl, aes, stdout

我正在尝试做一个示例应用程序，用于测试目的与其他人开发，并希望将加密字符串打印到屏幕上，并将其放回解密机制......我似乎不是找到这样做的方法...我已经尝试过 base64 并解压缩，感觉就是这样，但没有到达那里。

```
require 'openssl'
require 'base64'

def ask(prompt)
    loop do
        print prompt, ' '
        $stdout.flush
        s = gets
        return s.chomp
    end    
end

def aes(m,k,t)
(aes = OpenSSL::Cipher::Cipher.new('aes-256-cbc').send(m)).key = Digest::SHA256.digest(k)
aes.update(t) << aes.final
end

def encrypt(key, text)
aes(:encrypt, key, text)
end

def decrypt(key, text)
aes(:decrypt, key, text)
end

def my_decrypt
 @crypted = ask("Crypted data: ") 
 decrypted = decrypt("12345678911131511192123252729412",@crypted) 
 print decrypted
end

def my_encrypt
 @decrypted = ask("Data to encrypt: ") 
 crypted = encrypt("12345678911131511192123252729412",@decrypted) 
 print crypted
end

option=ask("Option 1 - Encrypt, 2 decrypt")
case option
    when "1" then my_encrypt
    when "2" then my_decrypt
    else print "Option not valid"
end 
```

有人来救援吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T17:53:38.497

经过一番斗争，我终于明白了......我只需要将二进制转换为十六进制，然后再转换回二进制......

两个注意事项：要将二进制转换为十六进制，您可以使用[String.unpack](http://ruby-doc.org/core-1.9.3/String.html#method-i-unpack)，它将返回一个数组。要将十六进制转换为二进制，首先需要将其构建为数组 ["anystringhere"] ，然后使用[Array.pack将其打包回二进制](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-pack)

这是结果代码

```
require 'openssl'
require 'base64'

def ask(prompt)
  loop do
    print prompt, ' '
    $stdout.flush
    s = gets
    return s.chomp
  end
end

def aes(m,k,t)
  (aes = OpenSSL::Cipher::Cipher.new('aes-256-cbc').send(m)).key = Digest::SHA256.digest(k)
  aes.update(t) << aes.final
end

def encrypt(key, text)
  aes(:encrypt, key, text)
end

def decrypt(key, text)
  aes(:decrypt, key, text)
end

def my_decrypt
  @crypted = ask("Crypted data: ")
  decrypted = decrypt("12345678911131517192123252729313",[@crypted].pack('H*'))
  print decrypted
end

def my_encrypt
  @decrypted = ask("Data to encrypt: ")
  crypted = encrypt("12345678911131517192123252729313",@decrypted)
  print u=crypted.unpack('H*')
end

option=ask("Option 1 - Encrypt, 2 decrypt")
case option
when "1" then my_encrypt
when "2" then my_decrypt
else print "Option not valid"
end 
```

# php - PHP文件上传目录

> ID：11563109
> 
> 赞同：1
> 
> 时间：2012-07-19T14:33:50.710
> 
> 标签：php, file

我正在处理文件上传脚本。我知道脚本的每个部分都是有效的，除了我要指定的路径。

我不确定路径应该相对于什么。它是否需要相对于 PHP 存储文件的临时文件夹，或者相对于我的脚本运行的位置？

另外，我不确定我需要多具体。我试图上传文件的目录是：`www/mm/uploads`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T14:34:58.013

它与脚本运行的位置相对。

# jquery - 无法理解为什么wire.js 无法创建对象

> ID：11563112
> 
> 赞同：1
> 
> 时间：2012-07-19T14:34:00.087
> 
> 标签：jquery, requirejs, js-amd, wirejs

这是我的网站的设置：

**索引.html**

```
<!DOCTYPE html>
<html>
    <head>
        <script>
            var require = {
                paths : {
                    jQuery : "jquery-1.7.2.min"
                },
                baseUrl: "/scripts"
            };
        </script>
        <title>Javascript RequireJS Example</title>
    </head>
    <body>
        <div id="test"></div>
        <script src="scripts/require.js" type="text/javascript" data-main="main.js"></script>
    </body>
</html> 
```

**hello-wired-spec.js**

```
define({
    message: "I haz been wired",
    node : "#test",

    helloWired: {
        create: {
            module: 'hello-wired'
        },
        ready: {
            sayHello: [{ $ref : 'node' }, { $ref : "message" }]
        }
    },

    plugins: [
        { module: 'debug', trace: true }
    ]
}); 
```

**你好-wired.js**

```
define(["jQuery"], function() {
    function HelloWired() {}

    HelloWired.prototype = {
        sayHello: function(node, message) {
            $(node).html("Hello! " + message);
        }
    };

    return HelloWired;
}); 
```

**main.js**

```
require(["wire!hello-wired-spec", "jQuery"], function (spec) {
    console.log(spec);
}); 
```

所以我正在使用`Require.js`并`wire.js`编写一个简单的 IoC 原型网站。我的问题是，当我加载 index.html 页面时，我在浏览器的控制台中看到以下内容：

```
DEBUG (total: 1ms, context: 0ms / 0ms): Context init
---------------------------------------------------

WIRING: No progress in 5000ms, status:
     checkPaths()

logger.error(tag + ': No progress in ' + timeout + 'ms, status:');

---------------------------------------------------

Components that DID NOT finish wiring

plugins[]: created
   Object { module= "debug" , trace= true , id= "plugins[]" }

helloWired: created
   Object { create={...}, ready={...}, id="helloWired"}
--------------------------------------------------- 
```

所以看起来我错过了一些东西，但我不知道在这里做什么。有人可以帮忙吗？

编辑这是`Scripts`我网站中的文件夹：

![我网站中的脚本文件夹](../Images/4007f8f9c39a49bfde8a17ed4155b0b3.png)

编辑好的我稍微改变了项目结构和HTML页面：

```
<!DOCTYPE html>
<html>
    <head>
        <script>
            var require = {
                paths : {
                    jquery : "jquery-1.7.2.min",
                    wire : "wire/wire"
                },
                baseUrl: "/scripts",
                packages: [
                    { name: 'wire', location: 'wire', main: 'wire' },
                    { name: 'when', location: 'when', main: 'when' },
                    { name: 'aop', location: 'aop', main: 'aop' }
                ]
            };
        </script>
        <title>Javascript RequireJS Example</title>
    </head>
    <body>
        <div id="test"></div>
        <script src="scripts/require.js" type="text/javascript" data-main="main.js"></script>
    </body>
</html> 
```

![在此处输入图像描述](../Images/fb65155549bc959aa1c0a18ca2456592.png)

现在我之前没有得到任何 404，但我也没有“包”配置部分。在更改 HTML 后，我确实得到了一些 404，但我已经通过将`/js`文件放置在预期的位置来修复这些问题。毕竟这一切，我仍然得到同样的错误：

![在此处输入图像描述](../Images/1b4a2d725b6ad47179e614cca031c028.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:09:51.517

问题是 jQuery 的大小写。当使用定义了自己名称的模块（例如 jQuery）时，您必须在路径配置和其他地方使用完全相同的名称。jQuery 将自己命名为“jquery”，而不是“jQuery”。

在代码中的任何地方将“jQuery”更改为“jquery”。

另外，布赖恩说的是真的。您应该像这样在模块中使用本地 jquery 实例：

```
define(["jquery"], function ($) { /* use $ here */ }); 
```

这减少了您对全局变量的依赖，还允许您同时使用多个版本的 jquery。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:34:47.620

乍一看，这可能是 AMD 加载程序配置问题。我通常会尝试将每个库的 cujojs 片段（wire、when 等）保存在自己的文件夹中，例如，将 wire 保存在 wire/ 目录中。然后，我为每个设置 AMD 软件包配置。 [有关如何执行此操作的示例，请参见此处](https://github.com/briancavalier/hello-wire.js/blob/master/index.html)- 看起来您的某些代码基于我的[hello-wire.js 示例](https://github.com/briancavalier/hello-wire.js)，因此您可以尝试在那里模拟包配置并为您的目录布局调整它。

您可以检查的一件事是 Firebug 或 WebKit 中的网络面板，以查看文件是否正在加载，或者是否有 404。

可能不相关，只是一个建议：看起来您将 jQuery 用作全局而不是严格地用作 AMD 模块——例如，它列在您的 AMD dep 列表中，但不是您的 AMD 工厂函数的参数。最初可能没问题，但您可能想在某个时候走完整的 AMD 路线。

# jquery - 使网页上的 JSON 数据保持最新的最佳做法是什么？

> ID：11563116
> 
> 赞同：0
> 
> 时间：2012-07-19T14:34:13.183
> 
> 标签：jquery, ajax, asp.net-mvc, json

我正在开发一个处理来自 SQL 服务器的数据的 Intranet 应用程序。该应用程序必须支持多个用户使用相同的数据源/相同的表。该应用程序使用一个[jQuery 数据表库，该库](http://datatables.net/)由 Ajax 调用提供给我的 MVC 控制器中的 JSON 结果操作，以及在表中呈现的一些 Ajax 链接，允许以模式弹出窗口的形式进行 CRUD 操作。当弹出窗口提交 CRUD 操作时，它会关闭并在数据表上调用刷新。

一切都很好，但是，如果另一个用户（或另一个浏览器/选项卡）更改了数据而没有刷新表，我希望该数据表能够更新。

一种方法是每 X 毫秒从服务器轮询一次 Hash 并在哈希更改时更新，但我不太喜欢这个选项，因为我觉得它可能很快就会因为要管理的表数量而失控。

我想知道你们对轮询方法的看法，以及由于 X 原因，您是否有一种更流畅、更清洁或只是更好的做法的替代方法。

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T14:37:14.000

> 我想知道你们对轮询方法的看法，以及由于 X 原因，您是否有一种更流畅、更清洁或只是更好的做法的替代方法。

轮询的替代方法是推送，它的效率要高得多。结帐[`SignalR`](https://github.com/SignalR/SignalR/)。这是一篇[介绍性的博客文章](http://www.hanselman.com/blog/AsynchronousScalableWebApplicationsWithRealtimePersistentLongrunningConnectionsWithSignalR.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:46:57.500

您是否考虑过使用[http://socket.io/](http://socket.io/)创建 websocket？

这将允许服务器在您的表更新时将数据推送到相关客户端，并且还允许用户将他们的更改推送到您的服务器而无需刷新（就像 ajax 一样）。

Socket.io 也有一个很好的回退机制，所以它在所有主流浏览器上都支持（是的，甚至是 IE6）。[http://socket.io/#browser-support](http://socket.io/#browser-support)

# php - 如何将数组或对象数组转换为关联数组？

> ID：11563119
> 
> 赞同：18
> 
> 时间：2012-07-19T14:34:21.913
> 
> 标签：php, array-map

我习惯于 perl 的 map() 函数，其中回调可以同时分配键和值，从而创建一个关联数组，其中输入是一个平面数组。我知道[`array_fill_keys()`](http://www.php.net/manual/en/function.array-fill-keys.php)如果您想要做的只是创建一个字典样式的散列，那么哪个会很有用，但是如果您不一定希望所有值都相同怎么办？显然所有事情都可以用 foreach 迭代来完成，但是还有哪些其他（可能更优雅）的方法呢？

**编辑**：添加一个示例来阐明转换。请不要挂断转换，问题是关于将平面列表转换为哈希，我们不能假设所有值都相同。

```
$original_array: ('a', 'b', 'c', 'd')
$new_hash: ('a'=>'yes', 'b'=>'no', 'c'=>'yes', 'd'=>'no')

*note: the values in this example are arbitrary, governed by some business logic that is not really relevant to this question. For example, perhaps it's based on the even-oddness of the ordinal value of the key 
```

**实际示例** 因此，使用此处提供的答案，您可以通过 $_POST 解析以获取仅与给定条件匹配的输入字段的列表。这可能很有用，例如，如果您的表单中有很多输入字段，但必须一起处理其中的某一组。

在这种情况下，我有许多表示到数据库的映射的输入字段。每个输入字段如下所示： `<input name="field-user_email" value="2" />`其中每个此类字段都以“field-”为前缀。

我们要做的是，首先，只获取那些实际上以“field-”开头的输入字段的列表，然后我们要创建一个名为的关联数组`$mapped_fields`，其中提取的字段名称作为键和实际输入字段的值作为价值。

```
$mapped_fields = array_reduce( preg_grep( '/field-.+/', array_keys( $_POST ) ), function( $hash, $field ){ $hash[substr( $field, 6 )] = $_POST[$field]; return $hash; } ); 
```

哪个输出：

```
Array ( [date_of_birth] => 1 [user_email] => 2 [last_name] => 3 [first_name] => 4 [current_position] => 6 ) 
```

（所以，为了阻止反对者，让我同意这一点紧凑的代码的可读性可能比一个简单的循环遍历 $_POST 并检查它是否有前缀，如果所以，将它和它的值弹出到一个数组中）

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-11-19T20:53:51.547

几天前我遇到了完全相同的问题。使用 是不可能的`array_map`，但[`array_reduce`](http://php.net/manual/en/function.array-reduce.php)可以解决问题。

```
$arr = array('a','b','c','d');
$assoc_arr = array_reduce($arr, function ($result, $item) {
    $result[$item] = (($item == 'a') || ($item == 'c')) ? 'yes' : 'no';
    return $result;
}, array());
var_dump($assoc_arr); 
```

结果：

`array(4) { ["a"]=> string(3) "yes" ["b"]=> string(2) "no" ["c"]=> string(3) "yes" ["d"]=> string(2) "no" }`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T21:29:22.593

这是对我在接受方法中的评论的澄清。希望更容易阅读。这是来自 WordPress 类，因此 $wpdb 引用来写入数据：

```
class SLPlus_Locations {
    private $dbFields = array('name','address','city');

    public function MakePersistent() {
        global $wpdb;
        $dataArray = array_reduce($this->dbFields,array($this,'mapPropertyToField'));
        $wpdb->insert('wp_store_locator',$dataArray);
    }

    private function mapPropertyToField($result,$property) {
        $result[$property] = $this->$property;
        return $result;
    }
} 
```

显然，完整的解决方案还有更多内容，但存在与 array_reduce() 相关的部分。比 foreach 或通过 array_map() 加上自定义插入语句强制问题更容易阅读和更优雅。

好的！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T18:09:15.553

据我所知，在一个表达式中是完全不可能的，所以你不妨使用一个`foreach`循环，à la

```
$new_hash = array();

foreach($original_array as $item) {
    $new_hash[$item] = 'something';
} 
```

如果您在一个表达式中需要它，请继续创建一个函数：

```
function array_map_keys($callback, $array) {
    $result = array();

    foreach($array as $item) {
        $r = $callback($item);

        $result[$r[0]] = $r[1];
    }

    return $result;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-24T12:52:28.330

算子的好用例`yield`！

```
$arr = array('a','b','c','d');

$fct = function(array $items) {
            foreach($items as $letter)
            {
                yield sprintf("key-%s",
                    $letter
                ) => "yes";
            }
        };

$newArr = iterator_to_array($fct($arr)); 
```

这使：

```
array(4) {
  'key-a' =>
  string(3) "yes"
  'key-b' =>
  string(3) "yes"
  'key-c' =>
  string(3) "yes"
  'key-d' =>
  string(3) "yes"
} 
```

# git - 项目的基本 git/github 工作流程，我将在开始时单独工作

> ID：11563124
> 
> 赞同：1
> 
> 时间：2012-07-19T14:34:36.140
> 
> 标签：git, github, workflow

我以前从未使用过版本控制系统。我打算将 git 和 github 用于我将从事的新项目。我已经阅读了 Pluralsight 上的 git 教程。我了解系统的工作原理，但由于我是新手，我觉得它有点混乱，并想验证我是否理解正确。

我想将 git 用于我将从事的新项目。最初，我将独自从事该项目。我想这将是我的工作流程。

1.  创建一个新的本地仓库（git init）
2.  添加远程仓库（git remote add [https://github.com/myuserid/projectname.git](https://github.com/myuserid/projectname.git)）
3.  在本地机器上编写/编辑代码
4.  提交在步骤 3 中所做的更改
5.  推送提交到远程仓库（git push）
6.  返回第 3 步，除非您已达到要发布版本的阶段
7.  添加版本标签（git tag -a v1.0）
8.  将标签推送到远程（git push --tags）
9.  转到第 3 步

这个对吗？

编辑：我的一位朋友建议我永远不要在本地仓库上提交对 master 的更改。我应该始终创建一个分支，对其进行更改和提交，当我满意时，将它们拉入本地 master。然后将它们推送到 github 上。你会怎么推荐这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:20:02.613

如果远程仓库已经存在于[https://github.com/myuserid/projectname.git](https://github.com/myuserid/projectname.git)，你最好使用`git clone`而不是`git init`.

如果你使用`git clone`,

*   不需要初始化 repo。它使用远程仓库的副本初始化仓库。
*   不需要添加遥控器。默认情况下，它会创建一个名为`origin`.
*   它从远程仓库获取所有分支，并为本地仓库中的每个远程分支创建一个远程跟踪分支。这很重要，否则`git pull`不能`git push`正常工作。

所以，我会推荐这个工作流程：

1.  克隆一个远程仓库（`git clone https://github.com/myuserid/projectname.git`），
2.  在本地机器上编写/编辑代码。
3.  提交在第 3 步（`git add`和`git commit`）中所做的更改。
4.  推送提交到远程仓库 ( `git push`)
5.  返回第 3 步，除非您已达到要发布版本的阶段。
6.  添加版本标签 ( `git tag -a v1.0`)
7.  将标签推送到远程 ( `git push --tags`)
8.  转到第 3 步

# javascript - SlickGrid 从日期错误动态构建列

> ID：11563126
> 
> 赞同：0
> 
> 时间：2012-07-19T14:34:45.833
> 
> 标签：javascript, asp.net-mvc-3, datepicker, slickgrid

我正在尝试从数据选择器中获取开始日期和结束日期，然后使用开始日期和结束日期创建列日期列表，当我硬编码其中的日期时工作正常，但是当我尝试从他们都返回null的日期选择器，这是一些代码（我也在使用MVC3和Razor，但我认为这是我做错的JS事情。）。

```
using (Html.BeginForm("Index", "Home", FormMethod.Post))
{

<p>
    Start Date:
    <input id='datepicker' name='datepicker' style="width: 85px">
    End Date:
    <input id='datepickerend' name='datepickerend' style="width: 85px">
    @Html.ListBox("teamID", (SelectList)ViewBag.Teams, "--Select a Team--")
    @Html.DropDownList("dealID", (SelectList)ViewBag.Deals, "--Select a Deal--")
    <input type="submit" value="Filter" id="btnFilter" />
</p>}

<script type="text/javascript">

function FormatUkDate(dateStr) {
    dateStr = dateStr.split("/");
    return new Date(dateStr[2], dateStr[1] - 1, dateStr[0]);
}
</script>
<script type="text/javascript">
Date.prototype.addDays = function (days) {
    var dat = new Date(this.valueOf())
    dat.setDate(dat.getDate() + days);
    return dat;
}

function getDates() {
    //        var StartDate = new Date(FormatUkDate($('#datepicker').value));
    //        var EndDate = new Date(FormatUkDate($('#datepickerend').value));
    var StartDate = $('#datepicker').val();
    var EndDate = $('#datepickerend').val();

    var dateArray = new Array();
    while (StartDate <= EndDate) {
        dateArray.push(StartDate)
        StartDate = StartDate.addDays(1);
    }
    return dateArray;
}

</script>

<script>
var daterange = getDates();
var grid;
var colsArray = new Array();
var columns = [
 {
     id: "Name", name: "Name", field: "Name"
 }
  ];
for (i = 0; i < daterange.length; i++) {
    var a = daterange[i].toString()
    a = a.substring(0, 10);
    columns.push({ id: a.valueOf(), name: a.valueOf(), field: a.valueOf() });
}
var options = {
    enableCellNavigation: true,
    enableColumnReorder: true
};

$(function () {
    var myData = [];

    $.getJSON('/Home/getm', function (data) {
        myData = data;
        grid = new Slick.Grid("#myGrid", myData, columns, options);
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T11:13:52.777

通过将按钮更改为使用 slickme 构建网格，更重要的是调用一些 Ajax 来解决问题，这些 Ajax 可以很好地传递日期选择器值。

# c++ - 从实例化为静态本地崩溃的类的构造函数调用 QPluginLoader::staticInstances

> ID：11563135
> 
> 赞同：0
> 
> 时间：2012-07-19T14:35:04.930
> 
> 标签：c++, qt

我有一个单例类，用于加载实例化为静态本地的 Qt 插件：

```
LibraryManager* LibraryManager::instance()
{
    static LibraryManager manager;
    return &manager;
} 
```

`QPluginLoader::staticInstances()`每当在 LibraryManager 的构造函数中被命中时，我都会在控制台中收到“__cxa_guard_acquire()：函数局部静态变量的初始化程序，称为封闭函数” 。这到底是什么意思，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:25:55.087

根据[此来源](http://www.opensource.apple.com/source/libcppabi/libcppabi-14/src/cxa_guard.cxx)，您以某种方式设法递归回同一线程中的同一本地函数。您的库管理器本身不是一个插件吗？:)

我不知道这意味着什么，但我的直觉是一个老派单身人士可以解决它。那就是将一个指向实例的指针作为类成员初始化为 null 并在 instance() 调用中进行延迟检查。我知道它需要实现一个静态释放方法并找到一个合适的位置来调用它。但它会绕过本地功能，这是您的错误消息所抱怨的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:50:24.363

这只是一个大脑错误。

我的插件类继承自库客户端实际使用的类（它调用管理器，实例化插件，其构造函数调用管理器......你可以看到它导致的位置），当它应该继承自一个只调用的不同类时成员函数（而不是其构造函数）的管理器。

tl;博士我输入了错误的类名，但我认为我没有这样做，所以我将那部分代码视为可能包含问题。

# javascript - AJAX 成功返回旧结果

> ID：11563136
> 
> 赞同：1
> 
> 时间：2012-07-19T14:35:08.713
> 
> 标签：javascript, jquery, ajax

我正在使用 AJAX 将序列化数据发送到 items.php 文件，我正在使用 FireBug 检查结果，AJAX 发送这样的数据，`category=2`我的 items.php 文件是：

```
<?php
require_once('db.php');
if (isset ($_POST['category'])) {
$kat = mysql_real_escape_string($_POST['category']);
if ($kat == 0){
 $kat = '';
}elseif ($kat == 1){
 $kat = 'ORDER BY date DESC';
}elseif ($kat == 2) {
    $kat = 'ORDER BY price DESC';
}elseif ($kat == 3) {
    $kat = 'ORDER BY price';
}
}else{ $kat = '';}
        $query = "SELECT * FROM prekes ".$kat."";
        mysql_query("SET NAMES 'UTF8'");
        $q = mysql_query($query) or die(mysql_error());
        $i = 0;
        while($f = mysql_fetch_array($q)){

        echo '<div kaina="'.$f['kaina'].'" class="prekes"><img src="prekes/'.$f['foto'].'">'.$f['pavadinimas'].'<br /><strong>'.$f['kaina'].'Lt </strong></div>';
        }
        ?> 
```

这是我的 AJAX 成功函数：

```
 $.ajax({
        type: 'POST',
        url: 'items.php',
        data: cleaned,
        success: function () {          
                              $('#items').fadeOut("fast").load("items.php?ts="+ $.now()).fadeIn("fast");
    }
   }); 
```

成功后 Div 刷新，但我变老了，无序的结果。为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T14:38:47.107

由于`load`方法在内部使用 jQuery`get`方法，我猜你正在获取**缓存**数据。确保发送一个唯一键作为查询字符串的一部分，它将为您提供新的内容 /result /uncached 数据。您可以使用该`Date`对象来创建一个新的唯一字符串；

```
$('#items').fadeOut("fast").load("items.php?ts="+new Date().getTime()) 
```

**编辑：** jQuery 有一个小方法 [`$.now()`](http://api.jquery.com/jQuery.now/)，可以为您提供唯一的时间戳。您可以使用它而不是编写 Date().getTime() 方法。

```
$('#items').fadeOut("fast").load("items.php?ts="+ $.now()) 
```

> $.now() 方法是表达式 (new Date).getTime() 返回的数字的简写。

感谢[凯文](https://stackoverflow.com/users/400654/kevin-b)指出。:)

**编辑2**：看到代码后

**1）**您没有传递`category`用于返回有序列表的查询字符串值。您应该像这样传递

```
$('#items').fadeOut("fast").load("items.php?category=2&ts="+ $.now()) 
```

**2）** `load`方法是一个`GET`请求。在您的 PHP 代码（items.php）中，您正在使用 $_POST（正确吗？不应该是[$_GET](http://php.net/manual/en/reserved.variables.get.php)？

所以改变

```
$kat = mysql_real_escape_string($_POST['category']); 
```

至

```
$kat = mysql_real_escape_string($_GET['category']); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T14:48:52.627

为了防止任何 ajax 调用被缓存，我通常有一个全局函数设置。

（这是功能独立的，即 post/get/etc）

```
 $.ajaxSetup({
         cache: false
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T14:38:40.120

问题在于`.load('items.php')`它使用 GET 请求，并且根据设计 GET 请求被缓存在浏览器中，因此它不必继续查找内容。在服务器上设置正确的标题，这样页面就不会被缓存。

```
<?php
  header("Cache-Control: no-cache, must-revalidate"); 
  header("Pragma: no-cache");
  header("Expires: Sat, 26 Jul 1997 00:00:00 GMT"); 
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-03T13:55:54.360

添加标头无缓存

标头：{“缓存控制”：“无缓存”}

# tcl - 在 Tcl 脚本中调用的 sed 命令中使用变量

> ID：11563137
> 
> 赞同：0
> 
> 时间：2012-07-19T14:35:12.730
> 
> 标签：tcl

我想在 tcl 脚本中使用以下命令：

```
sed -n '452,$ { /wire/ {p;q} }' /tmp/foo 
```

为此，我已将此命令更改如下：

```
set MIDLINE2 [ exec sed -n {1134,$ {/wire/{=;q}}} foo.txt ] 
```

它给了我正确的答案，但是在 1134 处，我想使用值为 1134 的变量 $MIDLINE。我该怎么做？请提出一些方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T14:41:32.657

这是一个简单的引用问题。您正在使用抑制变量替换的花括号。由于您想要变量替换，因此您需要使用其他东西。

```
set MIDLINE2 [ exec sed -n "$MIDLINE,\$ {/wire/{=;q}}" foo.txt ] 
```

请注意，您必须在文字前面加上一个反斜杠`$`，否则 Tcl 也会尝试替换它。

# java - Jenkins 执行失败：java.io.IOException ant build

> ID：11563141
> 
> 赞同：3
> 
> 时间：2012-07-19T14:35:17.523
> 
> 标签：java, android, ant, hudson, jenkins

我已经在 debianserver 上设置了 Jenkins，我正在尝试创建第一个 android 版本，但无法调用 ant

在詹金斯配置中，我有：

```
 Name: Java6
    JAVA_HOME/usr/lib/jvm/java-6-sun
    Name: AntHome
    ANT_HOME/usr/share/ant 
```

在作业配置上：

```
 git  > repo
    Build step-
    Ant invoke
    Ant Version: AntHome
    Targets: -d
    build file: folder/folder/build.xml 
```

当我建立工作时，它给了我这个错误

```
[folder] $ /usr/share/ant/bin/ant -file build.xml -d
/var/lib/jenkins/workspace/Project/folder/folder/build.xml:47: Execute failed: \
    java.io.IOException: Cannot run program \
    "/home/dims/android-sdk-linux_x86-1.0_r2/tools/aapt": \
    java.io.IOException: error=2, No such file or directory 
```

我在命令行上得到相同的结果

```
jenkins@host:~/workspace/Project/folder/folder$/usr/share/ant/bin/ant -d
/var/lib/jenkins/workspace/Project/folder/folder/build.xml:47: Execute failed: \
    java.io.IOException: Cannot run program \
    "/home/dims/android-sdk-linux_x86-1.0_r2/tools/aapt": \
     java.io.IOException: error=2, No such file or directory 
```

这个特定项目正在发生这种情况，因为我创建了其他项目并且 ant -d 有效：例如

```
 jenkins@host:~$ android create project -n template -t android-10 -p Project -k some.pkg -a Some
    Created project directory: Project
    Created directory /var/lib/jenkins/Project/src/some/pkg
    Added file Project/src/some/pkg/Some.java
    Created directory /var/lib/jenkins/Project/res
    Created directory /var/lib/jenkins/Project/bin
    Created directory /var/lib/jenkins/Project/libs
    Created directory /var/lib/jenkins/Project/res/values
    Added file Project/res/values/strings.xml
    Created directory /var/lib/jenkins/Project/res/layout
    Added file Project/res/layout/main.xml
    Added file Project/AndroidManifest.xml
    Added file Project/build.xml
    Added file Project/proguard-project.txt
    jenkins@host:~$ cd Project/
    jenkins@host:~/Project$ ant -d
    Apache Ant version 1.8.0 compiled on M
    ....
     [echo]               unless 'nodeps' is used as well.

    BUILD SUCCESSFUL
    Total time: 0 seconds 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T19:54:52.800

当您尝试在缺少一些必需的 32 位库（例如默认的 Ubuntu > 9）的 64 位系统上运行 aapt（或需要它的项目）时，会发生此特殊错误。解决方案是安装 ia32-libs 包和

```
$ sudo apt-get install ia32-libs 
```

假设您不想安装近 300 个软件包，请运行以下命令：

```
$ sudo apt-get install libstdc++6:i386 libgcc1:i386 zlib1g:i386 libncurses5:i386 --no-install-recommends 
```

# jquery - 在 Zurb Joyride 插件中嵌入 YouTube 视频

> ID：11563142
> 
> 赞同：0
> 
> 时间：2012-07-19T14:35:17.793
> 
> 标签：jquery, youtube

我正在使用[Zurb Joyride 插件](http://www.zurb.com/playground/jquery-joyride-feature-tour-plugin)进行网站导览，并尝试在导览步骤中嵌入 YouTube 视频。

嵌入视频不是问题，但是当点击“下一步”按钮时，我试图让 YouTube 视频暂停。否则，即使用户继续下一步，它也会在后台继续播放。

Joyride 插件确实有一个回调方法可以进行下一步，但我无法弄清楚当用户单击“下一步”时如何让 YouTube 视频暂停

任何帮助将非常感激！谢谢！

（这是一个损坏的例子......巡回演出有效，但不确定如何将视频放入其中并在点击“下一步”时暂停：http: [//adamrotman.com/demos/test/demo/testing.html](http://adamrotman.com/demos/test/demo/testing.html) )

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T10:25:35.123

Joyride 提供`postStepCallback`在每一步之后执行的回调。您可以尝试使用它来制作 Pase Youtube 视频。

# php - mySQL 查询语法错误？

> ID：11563144
> 
> 赞同：0
> 
> 时间：2012-07-19T14:35:20.727
> 
> 标签：php, mysql

我的 wordpress 网站上有联系表格，由 ajax 提供，并发送到我的邮箱。我还想将结果保存在数据库中，所以我编写了这个查询，但它给了我和语法错误，但我在这段代码中找不到任何错误：

```
<?php 
$con = mysql_connect("localhost","username","password");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("u31272B3", $con);

$sql="INSERT INTO wp_contactform (Nimi, Puhelin, E-mail, Viesti, IP, Day)
VALUES
('$_POST[Nimi]','$_POST[Puhelin]','$_POST[Sposti]','$_POST[Tiedot]','$_POST[Gotcha]','$_POST[Day]')";

if (!mysql_query($sql,$con))
  {
  die('Error: ' . mysql_error());
  }
echo "1 record added";

mysql_close($con);

?> 
```

发送它的 jquery 脚本有效，并且发送了邮件，但这并没有保存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:39:36.857

用反引号 (`) 引用列名 E-mail。MySQL 目前将其解释为两部分。

另请注意，（根据我的评论）您的代码很容易受到[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)攻击。使用正确参数化的 SQL 查询要好得多。

* * *

SQL注入示例：

```
"INSERT INTO table (field) VALUE ('$_POST[var]')" 
```

如果您发布该值`"'; DROP TABLE table; --"`，那么您有一个有效的 SQL 字符串，该字符串插入一个空字符串，然后尝试删除该表。替换你想要的任何有害的陈述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:45:24.907

你也应该使用 mysql_real_escape_string() 或准备好的语句。如果您的查询数据有任何特殊字符，它可能会破坏您的查询，它也可以帮助您进行 sql 注入。

[http://php.net/mysql_real_escape_string](http://php.net/mysql_real_escape_string) http://php.net/pdo

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T14:43:57.117

您的 SQL 请求应编写如下：

```
$sql = "INSERT INTO wp_contactform (`Nimi`, `Puhelin`, `E-mail`, `Viesti`, `IP`, `Day`)
        VALUES
        ('$_POST[Nimi]','$_POST[Puhelin]','$_POST[Sposti]','$_POST[Tiedot]','$_POST[Gotcha]','$_POST[Day]')" 
```

使用非字母数字字符的 SQL 字段必须使用反引号 ( ```)进行转义

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T14:47:40.427

这应该工作

```
<?php
$con = mysql_connect("localhost", "username", "password");
if(!$con){
    die('Could not connect: '.mysql_error());
}

mysql_select_db("u31272B3", $con);

$sql = "INSERT INTO wp_contactform (`Nimi`, `Puhelin`, `E-mail`, `Viesti`, `IP`, `Day`)
VALUES
('".mysql_real_escape_string($_POST['Nimi'])."','".
   mysql_real_escape_string($_POST['Puhelin'])."','".
   mysql_real_escape_string($_POST['Sposti'])."','".
   mysql_real_escape_string($_POST['Tiedot'])."','".
   mysql_real_escape_string($_POST['Gotcha'])."','".
   mysql_real_escape_string($_POST['Day'])."')";

if(!mysql_query($sql, $con)){
    die('Error: '.mysql_error());
}
echo "1 record added";

mysql_close($con); 
```

# python - map(sum,zip(*list)) 是求和任意长度列表列的最快方法吗？

> ID：11563146
> 
> 赞同：2
> 
> 时间：2012-07-19T14:35:23.733
> 
> 标签：python, performance, list, optimization

我想知道是否有人可以建议一种比 map(sum, zip(*list)) 更快的汇总列表的方法。

例子：

```
import timeit

print timeit.Timer('''
[ (a[x]+b[x]+c[x]) for x in xrange(len(a)) ]
''', '''
a = range(200)
b = range(199,-1,-1)
c = range(1,201)
''').timeit(number = 1000)

print timeit.Timer('''
map(sum,zip(*d))
''', '''
a = range(200)
b = range(199,-1,-1)
c = range(1,201)
d = [a,b,c]''').timeit(number = 1000)

print timeit.Timer('''
[sum(x) for x in zip(*d)]
''', '''
a = range(200)
b = range(199,-1,-1)
c = range(1,201)
d = [a,b,c]''').timeit(number = 1000) 
```

结果：

```
0.0317891459248 #list comprehension
0.0406545608382 #sum with zip
0.0532605665307 #map sum with zip 
```

**注意：我知道我在吹毛求疵，但我只是好奇是否有人有更好的建议。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T14:43:35.780

这个怎么样？

```
print timeit.Timer('''
d.sum(axis=0)
''', '''
import numpy as np
a = range(200)
b = range(199,-1,-1)
c = range(1,201)
d = np.array([a,b,c])''').timeit(number = 1000) 
```

当然，这假设您的列表包含某种数字类型......

# r - R中的替换函数是什么？

> ID：11563154
> 
> 赞同：51
> 
> 时间：2012-07-19T14:35:39.293
> 
> 标签：r

我搜索了参考以了解 R 中的替换函数，但我还没有找到任何内容。我试图理解 R 中替换函数的概念。我有下面的代码，但我不明白：

```
"cutoff<-" <- function(x, value){
 x[x > value] <- Inf
 x
 } 
```

然后我们调用 cutoff ：

```
 cutoff(x) <- 65 
```

谁能解释一下R中的替换函数是什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-07-19T14:46:11.650

你打电话时

```
cutoff(x) <- 65 
```

你实际上是在打电话

```
x <- "cutoff<-"(x = x, value = 65) 
```

必须引用函数的名称，因为它是语法上有效但非标准的名称，`<-`如果未引用，解析器将解释为运算符而不是函数名称的一部分。

`"cutoff<-"()`就像任何其他功能一样（尽管名称很奇怪）；它基于`value`（在这种情况下，它将任何值设置为大于`x`（无限））对其输入参数进行更改。`65``Inf`

当你像这样调用函数时，魔法真的完成了

```
cutoff(x) <- 65 
```

因为 R 正在解析它并提取各种位以进行如上所示的真正调用。

更一般地说，我们有

```
FUN(obj) <- value 
```

R 找到函数并通过传递和来`"FUN<-"()`设置调用，*并*安排将结果分配回，因此它调用：`obj``value``"FUN<-"()` *`"FUN<-"()``obj`*

 *```
obj <- "FUN<-"(obj, value) 
```

此信息的有用参考是[R 语言定义第 3.4.4 节：子集分配](http://cran.r-project.org/doc/manuals/R-lang.html#Subset-assignment)；讨论有点倾斜，但似乎是最官方的参考资料（在 R FAQ（R 和 S-PLUS 之间的差异）和 R 语言参考资料（各种技术问题）中提到了替换函数，但我没有在官方文档中找到任何进一步的讨论）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-19T16:54:13.700

Gavin 对替换函数的解释进行了很好的讨论。我想提供一个参考，因为您也要求提供：[*R Language Definition* Section 3.4.4: Subset assignment](http://cran.r-project.org/doc/manuals/R-lang.html#Subset-assignment)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-11-06T16:07:16.700

作为已接受答案的补充，我想指出，替换函数也可以为非标准函数定义，即运算符（请参阅 参考资料`?Syntax`）和控制流构造。（见`?Control`）。

还要注意，为替换函数设计一个通用的和相关的方法是完全可以接受的。

# 运营商

定义新类时，通常会为 和 定义 S3 方法，`$<-`一些示例是、或。`[[<-``[<-``data.table:::`$<-.data.table```data.table:::`[<-.data.table```tibble:::`$.tbl_df``

但是对于任何其他运算符，我们可以编写一个替换函数，一些示例：

```
`!<-` <- function(x, value) !value
x <- NULL # x needs to exist before replacement functions are used!
!x <- TRUE
x
#> [1] FALSE

`==<-` <- function(e1, e2, value) replace(e1, e1 == e2, value)
x <- 1:3
x == 2 <- 200
x
#> [1]   1 200   3

`(<-` <- function(x, value) sapply(x, value, USE.NAMES = FALSE)
x <- c("foo", "bar")
(x) <- toupper
x 
#> [1] "FOO" "BAR"

`%chrtr%<-` <- function(e1, e2, value) {
  chartr(e2, value, e1)
}

x <- "woot"
x %chrtr% "o" <- "a"
x
#> [1] "waat" 
```

我们甚至可以定义`<-<-`，但是如果我们调用解析器会阻止它的使用`x <- y <- z`，所以我们需要使用从左到右的赋值符号

```
`<-<-` <- function(e1, e2, value){
  paste(e2, e1, value)
}
x <- "b"
"a" -> x <- "c"
x
#> [1] "a b c" 
```

有趣的事实，`<<-`可以有双重作用

```
x <- 1:3
x < 2 <- NA # this fails but `<<-` was called!
#> Error in x < 2 <- NA: incorrect number of arguments to "<<-"

# ok let's define it then!
`<<-` <- function(x, y, value){
  if (missing(value)) {
    eval.parent(substitute(.Primitive("<<-")(x, y)))
  } else {
    replace(x, x < y, value)
  }
}
x < 2 <- NA
x
#> [1] NA  2  3
x <<- "still works"
x
#> [1] "still works" 
```

# 控制流结构

这些在实践中很少遇到（事实上，我负责我所知道的唯一实际用途，在定义`for<-`我的包[*pbfor 时*](https://github.com/moodymudskipper/pbfor/blob/master/README.md)），但是 R 足够灵活，或者足够疯狂，可以让我们定义它们。但是要实际使用它们，由于解析控制流构造的方式，我们需要使用从左到右的赋值`->`。

```
`repeat<-` <- function(x, value) replicate(value, x)
x <- "foo"
3 -> repeat x
x
#> [1] "foo" "foo" "foo" 
```

# `function<-`

`function<-`原则上可以定义，但据我所知，我们无能为力。

```
`function<-` <- function(x,value){NULL}

3 -> function(arg) {}
#> Error in function(arg) {: target of assignment expands to non-language object 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-07T19:45:41.607

请记住，在 R 中，所有操作都是函数调用（因此也是赋值操作），并且存在的所有内容都是对象。替换函数的行为就好像它们在适当的位置修改了它们的参数，例如

```
colnames(d) <- c("Input", "Output") 
```

`<-`它们的名称末尾有标识符，并返回参数对象（非原始替换函数）或相同对象（原始替换函数）的修改副本

在 R 提示符下，以下内容将不起作用：

```
> `second` <- function(x, value) {
+   x[2] <- value
+   x
+ }
> x <- 1:10
> x
 [1]  1  2  3  4  5  6  7  8  9 10
> second(x) <- 9
Error in second(x) <- 9: couldn't find function "second<-" 
```

如您所见，R 不是在搜索环境，`second`而是在搜索`second<-`. 所以让我们做同样的事情，但使用这样的函数标识符：

```
> `second<-` <- function(x, value) {
+   x[2] <- value
+   x
+ } 
```

现在，向量第二个位置的赋值起作用了：

```
> second(x) <- 9
> x
 [1]  1  9  3  4  5  6  7  8  9 10 
```

我还编写了一个简单的脚本来列出 R 基础包中的所有替换函数，在[这里找到它](http://qmviews.blogspot.ch/2016/05/r-replacement-functions.html)。*

# javascript - 暂停 js 脚本直到事件发生

> ID：11563160
> 
> 赞同：0
> 
> 时间：2012-07-19T14:35:55.950
> 
> 标签：javascript, dom-events

有什么方法可以暂停 js 脚本，直到发生诸如鼠标单击按钮之类的事件？我的意思是脚本应该在事件发生时暂停执行并再次恢复。我是 Javascript 的新手，即使在网上彻底搜索后也找不到解决方案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:40:56.007

JS 是单线程的，多线程只能由我们 Web Workers 完成。我所知道的。

但是，如果您只有一个要挂起的小脚本，您可以有一个全局变量/标志，并且只需在您的脚本中（我以某种方式相信它是一个循环或事件驱动的函数）检查该标志。在这种情况下：

```
var flag = false;

...
if (flag) {
   do your code
} else {
   do nothing or return if in function
} 
```

一旦你想继续，只需设置`flag = true;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:37:45.423

JavaScript 是单线程的，在事件发生时没有抢占。这是不可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-16T00:28:21.190

如果您要暂停的是一个本来会继续循环的函数，那么我想出了一个很好的解决方案： [https ://stackoverflow.com/a/47841425/2884291](https://stackoverflow.com/a/47841425/2884291)

# sharepoint-2010 - SharePoint 母版页中的 __expr-val-dir html 标记属性有什么用？

> ID：11563163
> 
> 赞同：3
> 
> 时间：2012-07-19T14:36:08.777
> 
> 标签：sharepoint-2010, xhtml

这个不合规的、神秘的属性似乎只是 dir 属性的副本，但我找不到对它的任何引用或在任何地方使用它的示例。任何人都可以阐明它的来源和/或它是否有任何用途（除了帮助 SharePoint 成为更多非标准基础）？

# ruby-on-rails - test_should_destroy_product(ProductsControllerTest) 问题

> ID：11563165
> 
> 赞同：0
> 
> 时间：2012-07-19T14:36:10.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3, testing

我有以下内容：

```
def destroy
    @product = Product.find(params[:id])
    @product.destroy

    respond_to do |format|
      format.html { redirect_to products_url }
      format.json { head :no_content }
    end
  end 
```

和我的测试：

```
test "should destroy product" do
    assert_difference('Product.count', -1) do
      delete :destroy, :id => @product
    end

    assert_redirected_to products_path
  end 
```

我得到：

```
# Running tests:

...............F......

Finished tests in 0.628844s, 34.9848 tests/s, 55.6577 assertions/s.

  1) Failure:
test_should_destroy_product(ProductsControllerTest) [/Users/noahc/Dropbox/Projects/depot/test/functional/products_controller_test.rb:51]:
"Product.count" didn't change by -1.
<2> expected but was
<3>.

22 tests, 35 assertions, 1 failures, 0 errors, 0 skips
Errors running test:functionals! #<RuntimeError: Command failed with status (1): [/usr/local/bin/ruby -I"lib:test" -I"/usr/l...]> 
```

任何想法为什么这会失败？

**更新**

如果我注释掉：

`before_destroy :ensure_not_referenced_by_any_line_item`

```
#ensure that there are no line items referencing this product
    def ensure_not_referenced_by_any_line_item
      if line_items.any?
        return true
      else errors.add(:base, 'Line Items present')
        return false
      end
    end 
```

测试通过。但是，@product 没有订单项。它只是一个固定装置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:16:29.990

我认为您需要添加[`to_param`](http://apidock.com/rails/ActiveRecord/Base/to_param)：`@product`

```
test "should destroy product" do
assert_difference('Product.count', -1) do
  delete :destroy, :id => @product.to_param
end

assert_redirected_to products_path
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T07:25:54.680

我会考虑这一点，因为您可能不想评论防止产品在某人的订单历史记录中被删除的回调（对于未来的购买或当前购买，我将实施一个活动/非活动状态列，该列将被评估在最终结账之前；仍然允许查看产品，但阻止结账，例如在产品缺货的情况下）。这些测试将 product.rb 中的 before_destroy 考虑在内。在这里，我正在即时模拟如果从未购买过产品会是什么样子。或者，您可以尝试更新您的灯具。

```
test "product has line items" do
  assert_not_equal 0, @product.line_items.count
end

test "product has no line items" do
  @product.line_items.each do |item|
    item.destroy
  end

  assert_equal 0, @product.line_items.count
end

test "should destroy product" do
    assert_difference('Product.count', -1) do

    # "simulate" a product that has never been added to cart
    # alternatively you could update your fixtures to do this

    @product.line_items.each do |item|
      item.destroy
    end

    delete :destroy, id: @product
  end

  assert_redirected_to products_path
end 
```

最后，请务必更新您的控制器和视图以添加此 Flash 通知，以便您查看发生了什么：

```
# DELETE /products/1
# DELETE /products/1.json
def destroy
  @product = Product.find(params[:id])
  if @product.destroy
    flash[:notice] = "#{@product.title} successfully deleted"
  else
    flash[:notice] = "It appears there are other carts that currently have #{@product.title} so we won't delete it at this time"
  end

  respond_to do |format|
    format.html { redirect_to products_url }
    format.json { head :no_content }
  end
end 
```

在您对 Destroy 链接所在的产品的视图中，如果您决定使用此链接，请确保将通知打印在顶部：

```
<p id="notice"><%= notice %></p> 
```

# xml - 使用 XForms 提交加载部分完成的表单

> ID：11563167
> 
> 赞同：1
> 
> 时间：2012-07-19T14:36:14.487
> 
> 标签：xml, xforms, exist-db, xsltforms

我正在创建一个小型 XForms 应用程序来帮助一些合作者创建复杂的元数据记录（TEI 标头）。我假设用户可能需要不止一个会话来完全填写项目请求的所有元数据。因此，我希望能够将表单数据保存到以项目特定标识符命名的文件中，然后允许返回用户从部分完成的表单列表中进行选择，将数据加载回编辑器并继续工作。不幸的是，我无法让加载功能按预期工作——也就是说，在我从列表中选择文件名后，我无法将保存的表单中的数据加载回编辑器。

以下是我模型中的实例：

```
<xf:instance id="itemMD" xmlns="http://www.tei-c.org/ns/1.0"
src="http://localhost:8080/exist/rest/db/home/sga/model.sga.metadata.xml"></xf:instance>

<xf:instance id="control-codes" xmlns="">
    <data>
        <boolean1>false</boolean1>
        <output-filename>temp</output-filename>
        <input-filename></input-filename>
    </data>
</xf:instance>

<xf:instance id="file-utils" xmlns="http://exist.sourceforge.net/NS/exist" src="http://localhost:8080/exist/rest/db/home/sga/posted_data/"></xf:instance> 
```

以下是提交元素：

```
<xf:submission id="save" method="put"
replace="none">
<xf:resource value="concat('http://localhost:8080/exist/webdav/db/home/sga/posted_data/', instance('control-codes')/output-filename)"></xf:resource>
</xf:submission>

<xf:submission id="load" method="get" replace="instance" instance="itemMD">
<xf:resource value="concat('http://localhost:8080/exist/webdav/db/home/sga/posted_data/', instance('control-codes')/input-filename)">
</xf:resource>
<xf:message ev:event="xforms-submit-error">Cannot load!</xf:message>
</xf:submission> 
```

以下是文档正文中的相关小部件：

```
<div id="loader" class="span4 offset8">
<xf:select1 id="load-from-file" ref="instance('control-codes')/input-filename">
<xf:label>Choose file: </xf:label>
<xf:itemset nodeset="instance('file-utils')//exist:resource">
<xf:label ref="@name"></xf:label>
<xf:value ref="@name"></xf:value>
</xf:itemset>
</xf:select1>
<xf:submit submission="load">
<xf:label>Load</xf:label>
</xf:submit>
</div> 
```

这是我第一次使用 XForms 进行认真的工作，所以也许这里有一些我应该能够修复的明显问题，但我很难过。（我也想知道我是否在这里传递了一个我应该传递 URI 的字符串？）。我正在使用 eXistDB 附带的 XSLTForms 处理器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:40:41.523

当然，网络分析器是浏览器调试器中用于检查 XSLTForms 生成的 HTTP 请求是否正常的最佳工具。

例如，您熟悉 Firebug 吗？

以下测试用例对我有用：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xf="http://www.w3.org/2002/xforms" xmlns:ev="http://www.w3.org/2001/xml-events">
 <head>
   <title>Save-Load</title>
   <xf:model>
           <xf:instance id="itemMD">
                <data xmlns=""/>
            </xf:instance>
            <xf:instance id="control-codes" xmlns="">
                <data>
                    <boolean1>false</boolean1>
                    <output-filename>temp.xml</output-filename>
                    <input-filename>temp.xml</input-filename>
                </data>
            </xf:instance>
            <xf:submission id="save" method="put" replace="none">
                <xf:resource value="concat('http://localhost/direct/', instance('control-codes')/output-filename)"/>
            </xf:submission>
            <xf:submission id="load" method="get" replace="instance" instance="itemMD">
                <xf:resource value="concat('http://localhost/direct/', instance('control-codes')/input-filename)"/>
                <xf:message ev:event="xforms-submit-error">Cannot load!</xf:message>
            </xf:submission>
        </xf:model>
 </head>
 <body>
    <xf:input ref=".">
        <xf:label>Data: </xf:label>
    </xf:input>
    <br/>
    <xf:input ref="instance('control-codes')/output-filename">
        <xf:label>Output File: </xf:label>
    </xf:input>
    <xf:submit submission="save">
        <xf:label>Save</xf:label>
    </xf:submit>
    <br/>
    <xf:input ref="instance('control-codes')/input-filename">
        <xf:label>Input File: </xf:label>
    </xf:input>
    <xf:submit submission="load">
        <xf:label>Load</xf:label>
    </xf:submit>
   <br/>
 </body>
</html> 
```

感谢您的反馈！

-阿兰

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T02:33:43.767

我没有看到任何明显的错误，但是（如果您仍在为此作斗争）这里有一些事情要做：

将类似的内容添加到您的文档中，靠近`Choose file:`控件。（为了易读性，我在这里打断了线条；您可能需要撤消它。）

```
 <div>Debugging:
    <xf:output value = 
       "concat('http://localhost:8080',
               '/exist/webdav/db/home',
               '/sga/posted_data/',
               instance('control-codes')/input-filename
               )">
      <xf:label>URI for document request: </xf:label>
    </xf:output>
  </div> 
```

这应该显示您的`load`提交正在获取的 URI。

然后手动取消引用该 URI 以查看是否可以。（如果你不能，你已经找到了问题。）

如果取消引用 URI 是手动工作但不是自动工作，请尝试对 URI 进行硬编码（暂时），这样无论用户选择什么文件，提供的文件都是您硬编码的文件。即用文字单引号字符串替换属性中 的`concat()`表达式：如果失败，请检查服务器日志以查看 HTTP请求使用的 URI。（有时当我粗心时，我忽略了我的提交会将默认实例的内容作为查询参数提交，除非我采取措施说不这样做；然后我必须再次查找它们并修复问题。）`xf:resource/@value``value="'http://localhost...'"``GET`

# php - 具有多种服务类型的 Fedex PHP soap api？

> ID：11563168
> 
> 赞同：5
> 
> 时间：2012-07-19T14:36:14.690
> 
> 标签：php, soap, opencart, fedex

我正在使用fedex soap api 来检索运费，但在ServiceType 中我只能发送一种类型，即PRIORITY_OVERNIGHT，我如何在一个请求中发送多个服务，如GROUND_HOME_DELIVERY、INTERNATIONAL_ECONOMY、PRIORITY_OVERNIGHT、STANDARD_OVERNIGHT？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-04T03:08:41.510

您可以在请求中省略`$request['RequestedShipment']['ServiceType']`，FedEx 将返回所有可用的运输方式。然后，您需要遍历`$response->RateReplyDetails`数组以提取每种运输方式。

请记住，包裹类型 ie`$request['RequestedShipment']['PackagingType']`将限制退回的运输方式。该值`YOUR_PACKAGING`应返回所有方法，而其他方法（例如`FEDEX_BOX`仅返回隔夜和 2 天选项）（至少对我而言）。但是，这有时也会影响价格。

# php - base64_decode 省略一个字节

> ID：11563173
> 
> 赞同：1
> 
> 时间：2012-07-19T14:36:23.733
> 
> 标签：php, base64, byte

我`base64_decode`在这个字符串上使用 PHP：

```
Dg+to8RaC3VzAGRThP7iiXe0f5bgp7xmcQoqaAJxggs= 
```

它应该返回 32 个字节的数据。但不知何故，我最终得到了一个只有 31 个字节长的字符串。

这就是我正在做的事情：

```
$data = base64_decode($data);
if($data == FALSE)
{
    die("decode faild");
} 
```

问题是解码实际上会起作用。但它只返回 31 个字节。当我这样做时：`$len = strlen($data);` then`$len`将包含 31 个字符而不是 32 个字符。

使用以下字符串（奇怪）：

```
az8XFgxw/ODAr3EDElvgab/axINKVMDCrw5u51gn6bo= 
```

我已经在解码`urlencode`之后`base64`和`urldecode`之前尝试过，但结果完全相同（它有效但省略了一个字节）

**我错过了什么？**

* * *

**编辑：**我打印出所有字节。它真的省略了最后一个字节！`0x0B`（最后一个字节）丢失但其他字节在那里。

**编辑 2：**附加测试产生： 1\. 当我将 base64 字符串直接嵌入到 PHP 文件中时，它总是有效的。2.当我`base64`从变量中获取字符串时，`$_GET`它有时不起作用。

坏`$_GET`了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T14:49:40.250

这是`+`我的朋友，它被解释为`（空间）。因此，要么`url_encode()`在将数据附加到 URL 之前，然后`url_decode()`在脚本中，要么简单地将空格替换为`+`.`

 ````
$data = base64_decode(str_replace(' ', '+', $data)); 
````

# php - 数据库映射到对象

> ID：11563178
> 
> 赞同：0
> 
> 时间：2012-07-19T14:36:32.727
> 
> 标签：php, mysql, mapping

```
SELECT 
*
FROM tableA
INNER JOIN tableB
ON tableA.id=tableB.tableAref 
```

如何获取它的结果集，以便它可以将tableA和tableB字段识别为php中的不同对象。我也可以将结果映射到 php 对象中。是否可以在连接查询中映射对象？我知道 PDO 可以将结果作为对象获取，但它不会映射基础连接表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:40:29.557

有可能，我建议您使用像 PHP.ActiveRecord 这样的 ORM

[http://www.phpactiverecord.org/](http://www.phpactiverecord.org/)

它从您的数据库、关联和其他公共任务（基于 ActiveRecord 模式）生成对象。

[http://en.wikipedia.org/wiki/Active_record_pattern](http://en.wikipedia.org/wiki/Active_record_pattern)

# actionscript-3 - 尚未在舞台上的对象的 HitTest

> ID：11563179
> 
> 赞同：0
> 
> 时间：2012-07-19T14:36:43.220
> 
> 标签：actionscript-3, flash, collision-detection, hittest, stage

我需要在舞台上添加一个 MovieClip，其限制是它只能添加到舞台上的空白区域。舞台本身要么包含复杂的形状，要么可由用户操作，即他可以拖动/移动对象来改变空白区域。hitTest 和 hitTestObject 方法需要舞台上已有的 DisplayObject。正确的方法是什么 - 我能想象的唯一解决方案是将我的对象添加到舞台上，然后反复进行命中测试？

[想象一下，就像在视频游戏中添加精灵一样——它们必须在空白区域生成；如果它们从彼此的内部弹出，那么看起来会很奇怪。]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:33:12.177

好吧，当你创建一个新类时，只需用一个变量将其关闭并将可见性设置为 false，然后循环直到没有 hitTest。

一个愚蠢的例子：

```
public class someClass extends Sprite
{
    private var objectsOnStage:Array;
    public function someClass(objectsArray:Array) {
        objectsOnStage = objectsArray;
        visible = false;
        addEventListener(Event.ADDED_TO_STAGE, init);
    }
    private function init(e:Event){
        removeEventListener(Event.ADDED_TO_STAGE, init);
        addEventListener(Event.ENTER_FRAME, SEARCH);
    }
    private function SEARCH(e:Event) {
        var doesHit:Boolean = false;
        x = Math.round(Math.random() * (550 - 0)) + 0;
        y = Math.round(Math.random() * (400 - 0)) + 0;
        for (var i:int = 0; i < objectsOnStage; i++) {
            if (doesHit) break;
            if (this.hitTestObject(objectsOnStage[i])) {
                doesHit = true;
            }
        }
        if (doesHit) return;
        placedInit();
    }
    private function placedInit() {
        visible = true;
        removeEventListener(Event.ENTER_FRAME, SEARCH);
        //now init the stuff you want.
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-27T02:08:25.383

我知道这篇文章已经很老了，但万一它对任何人有帮助——

如果您需要对不在舞台上的影片剪辑进行命中测试。一种解决方法是先将其光栅化为位图。

```
var bitmapData:BitmapData = new BitmapData(mc.width, mc.height, true, 0x0000000);
bitmapData.draw(mc);

if (bitmapData.getPixel32(x, y) > 0) {
  // Hit true.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-22T06:47:15.213

您只需检查两个剪辑的边界框是否重叠。像这样：

```
import flash.geom.Rectangle;
import flash.display.MovieClip;

// create simple movie clips that has a rectangle shape inside
var sym1 : MovieClip = new Sym1();
var sym2 : MovieClip = new Sym2();

// get a rectanle of both clipt
var boundingBox1 : Rectangle = sym1.getBounds(this);
var boundingBox2 : Rectangle = sym2.getBounds(this);

// check if bounding boxes of both movie clips overlaps
// so it works like hitTestObject() method
trace( boundingBox1.intersects( boundingBox2) ) 
```

# ios - 查找从相机拍摄的图像的照度值

> ID：11563182
> 
> 赞同：3
> 
> 时间：2012-07-19T14:36:49.333
> 
> 标签：ios, objective-c, image-processing, camera, rgb

我有一个应用程序应该计算给定照片的照度。

我的问题是：`i can't find a way to calculate this illuminance index (in lux)`

我可以得到`luminosity`这个代码：

```
UIImage* image = [UIImage imageNamed:@"image.png"];
unsigned char* pixels = [image rgbaPixels];
double totalLuminance = 0.0;
for(int p=0;p<image.size.width*image.size.height*4;p+=4) {
  totalLuminance += pixels[p]*0.299 + pixels[p+1]*0.587 + pixels[p+2]*0.114;
}
totalLuminance /= (image.size.width*image.size.height);
totalLuminance /= 255.0;
NSLog(@"Image.png = %f",totalLuminance); 
```

[来源](http://b2cloud.com.au/tutorial/obtaining-luminosity-from-an-ios-camera)

但结果介于两者之间`0 and 1`，我想我不能用它来`illuminance`计算`lux`

寻找堆栈溢出的答案我找到了这个答案[https://stackoverflow.com/a/2720635/839049](https://stackoverflow.com/a/2720635/839049)女巫给了我一个方向，但我不知道如何继续，因为我不知道如何处理曝光.

> ..您可以忽略像素数据，将曝光信息用作测光表。...

如何？有谁知道我该怎么做？或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:02:21.023

如果您从 Exif 数据中知道曝光值，那么总场景照度可以计算为

```
pow(2, Exposure)*(0.3 * Calibration); 
```

不幸的是，校准取决于您正在成像的场景的物理特征。如果您有很多深色、低反射率的物体，则必须将常数设置得更高。

通常，曝光计算得出的结果是，您从公式中获得的平均照度，即所有 Y 值的总和除以像素数，约为 0.5（但这取决于相机的“大脑”：一些相机将“区域”中的场景并对每个区域应用不同的权重，例如，即使这意味着使边缘变暗，他们也会尝试在中心区域获得 0.5；最新的相机集成了对比度值，以便从他们推断的内容中捕捉到最多的细节成为“感兴趣的区域”）。

这意味着您的图像将始终“缩放”，除非您以某种方式指示相机以固定速度拍照并停止设置，而不以任何方式进行补偿。如果这样做，您将能够使用平均像素亮度来确定总表观照度。

但是，您将始终必须使用已知仪表校准您的结果。

# jquery - 选择全选 div 周围的复选框

> ID：11563184
> 
> 赞同：0
> 
> 时间：2012-07-19T14:36:56.857
> 
> 标签：jquery, html, checkbox

当用户单击全选按钮（也在同一个 div 中）时，我试图检查位于 div 中的所有复选框。我想使用 jQuery 来实现这一点。我的 HTML 代码如下所示：

```
 <div>
     <input type='checkbox' name='select_all' />
     <input type='checkbox' name='check1' />    
     <input type='checkbox' name='check2' />   
     <input type='checkbox' name='check3' />   
 </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:41:03.703

[这是](http://jsfiddle.net/y7RsB/)一个活生生的例子

```
<div>
  <input type='checkbox' name='select_all' />
  <input type='checkbox' name='check1' />    
  <input type='checkbox' name='check2' />   
  <input type='checkbox' name='check3' />   
</div>  ​

$(document).on('change', '[name="select_all"]', function(){
      var $this = $(this); 
      var div = $this.parent();
      var ischecked = $this.prop('checked');
      div.find(':checkbox').not($this).prop('checked', ischecked);

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:54:56.273

虽然其他回答都是正确的，但我想补充一点：如果 HTML 页面中有其他复选框，通过仅按类型（复选框）选择复选框，您可能会选中与您想要的复选框无关的其他复选框。

最少添加的代码，不应该影响您的其他代码部分是为复选框分配一个特定的类。例如，如果您的复选框代表爱好，则将它们添加到 hobby_checkbox 类：

```
 <div>
     <input type='checkbox' name='select_all' /> Select all hobbies
     <br>
     <input type='checkbox' class='hobby_checkbox' name='check1' /> Ski   
     <br>
     <input type='checkbox' class='hobby_checkbox' name='check2' /> Travel
     <br>
     <input type='checkbox' class='hobby_checkbox' name='check3' /> PC Games
     <br>
     <br>
     <input type='checkbox' class='other_checkbox' name='other_check' /> Subscribe
 </div> 
```

然后，当您想要选择您想要检查的复选框时，您只选择属于您想要的类的那些：

```
$(document).on('change', '[name="select_all"]', function(){
      var $this = $(this);
      var div = $this.parent();
      var ischecked = $this.prop('checked');
      div.find(':checkbox.hobby_checkbox').prop('checked', ischecked);

}); 
```

这避免了检查不相关的订阅复选框。

[您可以在这里](http://jsfiddle.net/8kvdM/2/)看到它的实际效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T14:43:00.253

```
$('input[name=select_all]').click(function(){
  $('input[type=checkbox]').attr('checked',true);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T14:51:00.780

除了上一个答案：

```
$('input[name=select_all]').on('click', function(){

    if($(this).prop('checked')) {
         $('input[type=checkbox]').attr('checked', true);
    }else{
         $('input[type=checkbox]').attr('checked', false);
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T15:05:00.040

您也可以执行类似的操作来选择一个 div 内的复选框而不是所有复选框：如果选中全选，它将选中所有复选框，如果取消选中全选，它将取消选中所有选择框。

[http://jsfiddle.net/y7RsB/](http://jsfiddle.net/y7RsB/)

```
$("input[name=select_all]").click(function(){
    $(this).parent().find('input:checkbox').prop('checked',$(this).prop("checked") ? true : false);
});​ 
```

# php - 获取最接近数组中其他浮点数的浮点数

> ID：11563187
> 
> 赞同：0
> 
> 时间：2012-07-19T14:37:00.917
> 
> 标签：php, mysql, floating-point

> **可能重复：**
> [MYSQL PHP - get float LIKE $float](https://stackoverflow.com/questions/11562165/mysql-php-get-float-like-float)

我有来自数据库的浮点数。这是我的代码：

```
$float = $_GET['float'];
$requst = mysql_query("SELECT * FROM floats WHERE float LIKE'$float.%%%%%%%' AND float2 LIKE'$float2.%%%%%%%'");
while ($r = mysql_fetch_array($requst)) {

    $array[] = $r['float'];

} 
```

代码从用户名中获取浮点数`$float`并从数据库中的表中浮点数并将其添加到数组中。

我怎么知道数组中的浮点数接近`$float`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:44:26.743

```
// Lets cast provided float to float type to prevent sql injections
$float = (float) $_GET['float'];
$requst = mysql_query("SELECT * FROM floats WHERE float LIKE'$float.%%%%%%%' AND float2 LIKE'$float2.%%%%%%%'");
$array = array();
while ($r = mysql_fetch_array($requst)) {
    // Lets store an array of differences between the provided float
    // and db floats, indexed by db float value
    $array[$r['float']] = abs($r['float'] - $float);
}
// Now lets sort the array by values(differences)
// keeping the keys intact
asort($array);
// The first key of the resulting array is the closest float to the provided float
$closest = array_pop(array_keys($array)); 
```

# android - 有什么方法可以检查设备是否支持手写笔输入？

> ID：11563191
> 
> 赞同：1
> 
> 时间：2012-07-19T14:37:19.113
> 
> 标签：android, types, screen

我只想在设备支持手写笔输入时才显示菜单项。

不幸的是，我没有发现任何检查设备或显示器是否支持手写笔/Spen 进行输入。

编辑：使用 event.getToolType() 触发 MotionEvent 后，我​​可以区分 Stylus 和 Finger。如果工具类型是 TOOL_TYPE_STYLUS，我可以确定它支持手写笔。如果不是，我可以猜测是否有压力 > 0（与[如何检测 Android 设备中的屏幕是电容性还是电阻性有关？](https://stackoverflow.com/q/4294754/1538176)）

但我想在我的活动的 onCreate 方法中知道它。

以下不知何故不受支持，对我不起作用。

```
Configuration config = getResources().getConfiguration();
if (config.touchscreen == Configuration.TOUCHSCREEN_STYLUS)
    Toast.makeText(this, "TOUCHSCREEN_STYLUS", Toast.LENGTH_SHORT).show(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-04-08T00:41:24.733

您可以通过 InputManager 非常可靠地检测 S-Pen 和其他手写笔：

```
 boolean sPen = false;
    if(Build.VERSION.SDK_INT > 15) {
        InputManager inptmgr = (InputManager)getSystemService(INPUT_SERVICE);
        int[] inputs = inptmgr.getInputDeviceIds();
        for(int i = 0;i<inputs.length;i++) {
            if(inptmgr.getInputDevice(inputs[i]).getName().toLowerCase().contains("pen")) sPen = true;
        }
    } 
```

通常设备会使用其中包含的适当名称进行注册，例如“蓝牙鼠标”、“罗技 USB 键盘”或“E_Pen”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T17:27:25.600

在这里（来自 Android 文档）- 似乎只在 4.0 及更高版本中受支持。 [http://developer.android.com/about/versions/android-4.0.html](http://developer.android.com/about/versions/android-4.0.html)

> Android 现在提供 API，用于接收来自手写笔输入设备的输入，例如数字化平板外围设备或支持手写笔的触摸屏。
> 
> 触控笔输入的操作方式与触摸或鼠标输入类似。当触控笔与数字化仪接触时，应用程序会接收触摸事件，就像使用手指触摸显示器时一样。当触控笔悬停在数字化仪上方时，应用程序会收到悬停事件，就像在未按下任何按钮时鼠标指针在显示屏上移动时一样。
> 
> *您的应用程序可以通过使用getToolType()*查询与 MotionEvent 中的每个指针关联的“工具类型”来区分手指、鼠标、触控笔和橡皮擦输入。当前定义的工具类型是：**TOOL_TYPE_UNKNOWN**、**TOOL_TYPE_FINGER**、**TOOL_TYPE_MOUSE**、 **TOOL_TYPE_STYLUS**和**TOOL_TYPE_ERASER**。通过查询工具类型，您的应用程序可以选择以不同于手指或鼠标输入的方式处理触控笔输入。
> 
> *您的应用程序还可以通过使用getButtonState()*查询 MotionEvent 的“按钮状态”来查询按下了哪些鼠标或触控笔按钮 。当前定义的按钮状态为： **BUTTON_PRIMARY**、**BUTTON_SECONDARY**、**BUTTON_TERTIARY**、**BUTTON_BACK**和 **BUTTON_FORWARD**。 为方便起见，后面和前进鼠标按钮会自动映射到**KEYCODE_BACK**和**KEYCODE_FORWARD**键。您的应用程序可以处理这些键以支持基于鼠标按钮的后退和前进导航。
> 
> 除了精确测量触点的位置和压力​​外，一些手写笔输入设备还报告手写笔尖端和数字化仪之间的距离、手写笔倾斜角度和手写笔方向角。您的应用程序可以使用带有轴代码**AXIS_DISTANCE**、**AXIS_TILT**和 **AXIS_ORIENTATION的***getAxisValue()*查询此信息。

 ******* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-30T20:47:23.810

@Aaron Gillion 的答案看起来是可行的，但是将函数检测信任到名称看起来不是 100% 可靠的。

我检查了标准的 Android[`InputDevice`](https://developer.android.com/reference/android/view/InputDevice)并发现了一些有趣的功能[`supportsSource`](https://developer.android.com/reference/android/view/InputDevice#supportsSource(int))，如果设备支持例如[`SOURCE_STYLUS`](https://developer.android.com/reference/android/view/InputDevice#SOURCE_STYLUS). 这里有一个例子：

```
if (Build.VERSION_CODES.JELLY_BEAN <= Build.VERSION.SDK_INT) {
    InputManager im = (InputManager) context.getSystemService(INPUT_SERVICE);
    for (int id : im.getInputDeviceIds()) {
        InputDevice inputDevice = im.getInputDevice(id);
        if (
                inputDevice.supportsSource(InputDevice.SOURCE_STYLUS) ||
                inputDevice.supportsSource(InputDevice.SOURCE_BLUETOOTH_STYLUS)
        )
            return true;
    }
}
return false; 
```

如果你追求更低的 SDK，你可以内联`supportsSource`函数，这非常简单：

```
public boolean supportsSource(int source) {
    return (mSources & source) == source;
} 
```

和常数：

```
added in 23 - SOURCE_BLUETOOTH_STYLUS = 0x00008000 | SOURCE_STYLUS
added in 14 - SOURCE_STYLUS = 0x00004000 | SOURCE_CLASS_POINTER
added in  9 - SOURCE_CLASS_POINTER = 0x00000002 from 9 
```

我已经在几个设备上测试了代码，它正确地检测到了手写笔。如果您能分享在非三星设备上检测手写笔的结果，我将不胜感激。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T17:23:21.457

我认为没有任何东西可以检测手写笔输入。我假设如果设备具有触摸功能，它也可以响应手写笔。据我所知，Android 并不专门支持手写笔输入。******

# java - GChart 文本颜色和轴标签

> ID：11563192
> 
> 赞同：0
> 
> 时间：2012-07-19T14:37:33.397
> 
> 标签：java, gwt

我在我的网络应用程序中使用 GChart，但找不到任何关于在 X 和 Y 轴上更改文本颜色的信息。我的图表显示在 StackPanel 内的 Horizo​​ntalPanel 中。这是我的 GChart 代码，而不是它的显示位置：

```
public class ChartTuple extends GChart {
public ChartTuple() {
    super();
    setChartTitle("<b></b>");
    setChartSize(400,300);
    addCurve();
    for (double i = 01.24; i < 14; i++) {
        System.out.println("Adding curve PT");
        getCurve().addPoint(i, i);
    }

    getCurve().getSymbol().setSymbolType(SymbolType.VBAR_SOUTH);
    getCurve().getSymbol().setBackgroundColor("red");
    getCurve().getSymbol().setBorderColor("gray");
    getCurve().getSymbol().setModelWidth(0.5);
    getXAxis().setAxisLabel(
            "<b>Latency Distribution (% objects, time in mm:ss)</b>");
    getXAxis().setHasGridlines(false);
    getYAxis().setAxisLabel("");
    getYAxis().setHasGridlines(true);
    addStyleName("chart-text");
    System.out.println(getCurve());
    System.out.println(this.toString());
    setVisible(true);
} } 
```

非常感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T16:07:27.093

以下代码是如何更改 XY 轴标签的颜色。

```
getXAxis().setTickLabelFontColor("white");
    getYAxis().setTickLabelFontColor("white"); 
```

# css - 针对一个 CSS id 的类

> ID：11563193
> 
> 赞同：0
> 
> 时间：2012-07-19T14:37:37.723
> 
> 标签：css, wordpress

我试图在以下代码中定位类 .page-has-children ：

```
<div id="dc_jqverticalmegamenu_widget-2" class="widget sidebarwidget ">
  <div class="dcjq-vertical-mega-menu" id="dc_jqverticalmegamenu_widget-2-item">
    <ul id="menu-media-intellectual-property" class="menu">
      <li id="menu-item-2674" class="page-has-children menu-item menu-item-type-post_type menu-item-object-page menu-item-2674">
        <a href="http://saracens.staging.wpengine.com/commercial-clients/commercial-litigation/media-and-intellectual-property">Media and Intellectual Property</a>
          <ul class="sub-menu">
            <li id="menu-item-2672" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2672">
              <a href="http://saracens.staging.wpengine.com/commercial-clients/commercial-litigation/media-and-intellectual-property/it-and-software-disputes">IT and Software Disputes</a>
            </li>
            <li id="menu-item-2673" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2673">
              <a href="http://saracens.staging.wpengine.com/private-clients/civil-litigation/media-and-intellectual-property/trademarks-and-patents">Trademarks and Patents</a>
            </li>
          </ul>
        </li>
      </ul>     
    </div>
  </div>
</div> 
```

我尝试了多种变体，但我很确定这个应该可以工作：

```
#dc_jqverticalmegamenu_widget-%ID%-item li.page-has-children  {} 
```

我也试过

```
div.dcjq-vertical-mega-menu li.page-has-children {
  background: url(images/arrow-right.gif) no-repeat -3px 0px;
  padding: 0 0 0 15px;
  cursor: pointer;
} 
```

我还尝试了此论坛帖子中的建议：http: [//css-tricks.com/forums/discussion/10960/target-a-class-inside-id/p1](http://css-tricks.com/forums/discussion/10960/target-a-class-inside-id/p1)

他们都不允许我看到有孩子的菜单项上的箭头。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:45:07.607

你有没有尝试过：

```
#dc_jqverticalmegamenu_widget-2 #dc_jqverticalmegamenu_widget-2-item #menu-media-intellectual-property .page-has-children {

} 
```

# sql - 使用具有相同名称 SQL Server 的临时表时出错

> ID：11563195
> 
> 赞同：1
> 
> 时间：2012-07-19T14:37:37.733
> 
> 标签：sql, temp-tables

这是我的场景。（以下是将@date 作为输入参数的存储过程）

```
DECLARE @date DATE

If object_id('tempdb..#TempList') is not null drop table #TempList
go

Create table #TempList (MILL_NO VARCHAR(7), SHIP_DATE DATE, BL_STATUS NCHAR(1), 
FOOTAGE DECIMAL(12,4))

If @date IS NULL

Insert into #TempList
Select mill_no, null, bl_status,footage from fn_A(0,0)

Select * from #TempList

If object_id('tempdb..#TempList') is not null drop table #TempList
go

Create Table #TempList (MILL_NO VARCHAR(7), SHIP_DATE DATE, BL_STATUS NCHAR(1),
FOOTAGE DECIMAL(12,4))

If @date IS NOT NULL

Insert into #TempList
Select * from fn_B(0,'06/06/2006')

Select * from #TempList 
```

我从其中一篇文章中发现，除非包含 GO，否则我不能使用具有相同名称的临时表。但是，包括 GO 并没有采用我尝试传递的参数。

是否有替代方法来消除此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:43:34.180

根据提供的过程，您可以`TRUNCATE TABLE`改用。

如果您想要做的只是快速删除记录，我看不到删除和重新创建表的意义。

**编辑**

您不会删除并重新创建具有相同名称的表；而不是这段代码：

```
If object_id('tempdb..#TempList') is not null drop table #TempList go  
Create Table #TempList (
    MILL_NO VARCHAR(7), 
    SHIP_DATE DATE, 
    BL_STATUS NCHAR(1), 
    FOOTAGE DECIMAL(12,4)
) 
```

只需这样做：

```
TRUNCATE TABLE #TempList 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:49:26.323

`if object_id('tempdb..#TempList')` 始终为 NULL，因为`#TempList`它不是在您执行时在 tempdb 的 sysobjects 表上创建的名称`create table #TempList`

**编辑**
这个怎么办：

```
CREATE PROC PIRULO(@date as DATE) as

Create table #TempList (MILL_NO VARCHAR(7), SHIP_DATE DATE, BL_STATUS NCHAR(1), FOOTAGE DECIMAL(12,4))
IF @date IS NULL
    Insert into #TempList
    Select mill_no, null, bl_status,footage from fn_A(0,0)
ELSE
    Insert into #TempList
    Select * from fn_B(0,'2006/06/06')    -- also I changed date order.

Select * from #TempList 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T12:55:28.557

这些天我一直在努力在满足给定条件时将值插入到同一个临时表中。

鉴于我正在将 FoxPro（已声明游标）迁移到 SQL Server 的项目中，这个小逻辑需要在多个存储过程中实现。

最后，我从中学到的是 - 在尝试任何不同的东西之前先思考一下（对我的数据库迁移初学者的建议）。

```
DECLARE @date DATE

SET @date = '06/06/2006'    --@date = null

If object_id('tempdb..#TempList') is not null drop table #TempList

Create table #TempList (MILL_NO VARCHAR(7), SHIP_DATE DATE, BL_STATUS NCHAR(1), 
FOOTAGE DECIMAL(12,4))

If @date = null

-- Here I am inserting null in place of Ship_Date because fn_A returns only 3 columns in my case
Insert into #TempList
Select mill_no, null, bl_status,footage from fn_A(0,0)

--Select * from #TempList

else

Insert into #TempList
Select * from fn_B(0,@date)

Select * from #TempList 
```

感谢大家提供您的意见。希望这可以帮助某人。

# buddypress - BuddyPress：自定义个人资料日期字段未在循环中显示

> ID：11563198
> 
> 赞同：1
> 
> 时间：2012-07-19T14:37:45.847
> 
> 标签：buddypress

我正在一个 buddypress 网站上工作，在该网站上，会员可以发布出现在会员目录中的广告，前提是他们还为其设置了到期日期。这两个字段都只是扩展配置文件字段；广告是一个文本区域，到期日期当然是一个日期选择器。

在我的主题中，在 members-loop.php 循环中，我有以下代码：

```
// This one works
<?php $ad = bp_get_member_profile_data('field=Member Directory Ad'); ?>
// This one doesn't
<?php $ad_expiry = bp_get_member_profile_data('field=Member Directory Ad Expiration'); ?> 
```

没有其他特殊代码可以实现这一点。我看不出为什么 $ad_expiry 对于肯定设置了它的成员是空白的，尤其是当 $ad 具有正确的值时。

深入研究 buddypress 代码，bp_get_member_profile_data() 没有返回我的扩展配置文件日期框数据。在 xprofile_format_profile_field() 内部，值被 bp_format_time() “格式化”，输出为空。所以我猜这是一个buddypress错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:43:22.893

至少我已经发现了这个错误。BuddyPress 将日期框的输出存储为类似“2012-07-19 00:00:00”的字符串。bp_get_member_profile_data() 从数据库中检索该值，然后将其传递给 xprofile_format_profile_field()，xprofile_format_profile_field() 将其传递给 bp_format_time()，后者返回 false，因为该值未通过 is_numeric() 检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-21T20:12:43.763

试试这个解决方法 -

```
 //you need to specify the $user_id
$ad_expiry = xprofile_get_field_data('Member Directory Ad Expiration', $user_id );  
  // reformat, if you like
$ad_expiry  = strtotime($ad_expiry);
echo date('m/d/Y', $ad_expiry); 
```

.

并感谢有关 trac 的错误报告。

# android - 使用 pageViewer 的 Darggable 网格视图

> ID：11563201
> 
> 赞同：0
> 
> 时间：2012-07-19T14:37:47.273
> 
> 标签：android, android-emulator, android-widget, android-ndk

我已经开发了 Darggable 网格视图，在这个网格视图中我已经实现了 Darg 和 Drop 功能它工作正常。但是根据我的要求，我需要将此代码集成到

ViewPager.BUt 我无法将图标从一个视图拖到另一个视图。我只能将图标拖到一个视图。如果有人知道，请您解决这个问题。

我已经使用这篇文章实现了 darg&drop 功能：https://github.com/thquinn/DraggableGridView

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T05:28:26.283

DraggableGridView 仅支持在一个实例内重新排列。您需要实现自定义事件以提供有关当前所选视图的活动信息。您还有另一个问题：默认情况下，视图不会在其父 ViewGroup 之外绘制。您可能想尝试 Android 的拖放框架来开发您自己的自定义行为。

[http://developer.android.com/guide/topics/ui/drag-drop.html](http://developer.android.com/guide/topics/ui/drag-drop.html)

# ruby - Rails，具有自定义模型属性的 has_attached_file 路径

> ID：11563207
> 
> 赞同：1
> 
> 时间：2012-07-19T14:38:08.663
> 
> 标签：ruby, paperclip

我想用一些模型的属性自定义 has_attached_file 路径。

这是带有附件的模型：

```
class Picture < ActiveRecord::Base

  belongs_to :with_content, :polymorphic => true

  has_attached_file :picture, {
    :styles => { :mobile => ["320x200#", :png], :original => ["1280x1024>", :jpg] },
    :path => ":rails_root/public/:class/:with_content_type/:style_:basename.:extension"
  }
} 
```

请注意，我正在尝试使用多态属性“with_content_type”。但它不起作用。

* * *

我找到了解决方案。很简单。在 has_attached_file 之后添加这个简单的代码：

```
 Paperclip.interpolates :with_content_type do |attachment, style|
    "#{attachment.instance.with_content_type}"
  end 
```

# boost - CUDA主机代码的互斥锁？boost::mutex 由于使用 nvcc 重新定义了 BOOST_COMPILER 没有解决方案

> ID：11563209
> 
> 赞同：0
> 
> 时间：2012-07-19T14:38:26.790
> 
> 标签：boost, cuda, mutex

有人看到在 CUDA 主机代码中同步操作的可能性吗？对于 CUDA 主机代码，我指的是包含在您的 .cu 文件中并由 nvcc 预处理然后传递给 Windows 上的 cl.exe 的主机代码。

由于 nvcc 不可避免地对主机代码进行了预处理，我无法使用我的首选实现 boost::mutex: 如果我包含 boost 内容，我会收到 BOOST_COMPILER makro 重新定义的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:18:20.743

只需将您的 CUDA C 代码与其他代码分开即可。让 .cu 文件包含您的内核、设备函数、内核调用等。为内核调用制作标头并在您的 cpp 文件中使用这些标头。这也有助于减少编译时间，因为编译 .cu 文件很慢。

# html - Grails g：渲染模板（或渲染div）onClick事件

> ID：11563212
> 
> 赞同：0
> 
> 时间：2012-07-19T14:38:36.557
> 
> 标签：html, list, templates, grails, render

我正在创建一个带有可展开/可折叠列表项的分层列表。当用户单击列表项以展开它时，会弹出一个包含一些信息的表格。现在，grails 正在加载页面时呈现所有表。但是，我只希望在单击列表项时加载表格。我正在使用部分模板来容纳表格 html 并使用

```
<g:render> 
```

渲染它们。有没有办法转换我要发布的代码，以便带有 class="list" 的 div 仅在点击时加载？如果没有，有没有办法只在点击时调用 g:render 标签？

```
<g:each in="${group2List}" var="item">
            <li class="liClosed"><b>
                    ${item}
            </b> <%= Application.findAllWhere((group2): item, (group1): group).size() %>
                <ul>
                    <div class="list">
                        <table id="portfolio">
                            <g:render template="tableHeader" />
                            <g:render template="applicationRow"
                                collection="${Application.findAllWhere((group2): item, (group1): group)}"
                                var="applicationInstance" />
                        </table>
                    </div>
                </ul></li>
            <br />
</g:each> 
```

那么，有没有办法为 li 添加一个 onClick 事件，仅在单击时呈现该 div class="list" ？或者一种在将这些 g:renders 保留在 ul 中的同时调用这些 g:renders onClick 的方法。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:16:17.803

就像上面评论的@sudhir 一样，您不能将服务器端内容加载到客户端内容中。一旦页面加载，grails 标签就会被渲染。但是您可以使用 ajax 将数据加载到服务器中，并使用其中的新数据呈现部分模板。这正是你所需要的。您可以查看可能适合您需求的[此链接。](http://www.craigburke.com/blog/2011/01/01/grails-ajax-list-with-paging-and-sorting/)

# django - 使用 django 评论获取 django 中评论最多的帖子

> ID：11563215
> 
> 赞同：2
> 
> 时间：2012-07-19T14:38:42.690
> 
> 标签：django, comments

我试图在我的 django 应用程序中获得评论最多的十个帖子，但我无法做到，因为我想不出一个正确的方法。

我目前正在使用 django 评论框架，并且我已经看到了使用[aggregate 或 annotate](https://docs.djangoproject.com/en/dev/topics/db/aggregation/#cheat-sheet)执行此操作的可能性，但我可以弄清楚如何。

事情是：

*   获取所有帖子
*   计算每个帖子的评论数（我有一个 comment_count 方法）
*   将评论从评论最多的帖子排序到更少
*   获取前 10 个（例如）

有没有“简单”或“pythonic”的方式来做到这一点？我有点迷茫，因为评论框架只能通过模板标签访问，而不是直接从代码中访问（除非你想修改它）

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:55:48.487

没错，您需要使用注释和聚合功能。您需要做的是分组并计算`object_pk`模型的数量`Comment`：

```
from django.contrib.comments.models import Comment
from django.db.models import Count

o_list = Comment.objects.values('object_pk').annotate(ocount=Count('object_pk')) 
```

这会将类似以下的内容分配给`o_list`：

```
[{'object_pk': '123', 'ocount': 56},
 {'object_pk': '321', 'ocount': 47},
 ...etc...] 
```

然后，您可以对列表进行排序并切出前 10 个：

```
top_ten_objects = sorted(o_list, key=lambda k: k['ocount'])[:10] 
```

然后，您可以使用其中的值`object_pk`来检索附有评论的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T14:56:17.893

Annotate 将成为首选方式，部分原因是它会减少数据库查询，而且它基本上是单行的。虽然您的理论循环会起作用，但我敢打赌，您的 comment_count 方法依赖于查询给定帖子的评论，这将是您循环过分的每个帖子的 1 个查询！

```
posts_by_score = Comment.objects.filter(is_public=True).values('object_pk').annotate(
    score=Count('id')).order_by('-score')
post_ids = [int(obj['object_pk']) for obj in posts_by_score]
top_posts = Post.objects.in_bulk(post_ids) 
```

此代码无耻改编自[Django-Blog-Zinnia](https://github.com/Fantomas42/django-blog-zinnia/blob/master/zinnia/templatetags/zinnia_tags.py#L87)（无从属关系）

# c# - 部分迁移到 .NET 4 - 找不到程序集

> ID：11563216
> 
> 赞同：3
> 
> 时间：2012-07-19T14:38:44.203
> 
> 标签：c#, .net, .net-4.0, .net-2.0

我有一个 C# 应用程序，由一个引用许多 dll 的单个 exe 组成，所有这些都是用 .NET 2 构建的。我想集成一个用 .NET 4 构建的 dll，所以要做到这一点，我首先需要在 .NET 4 中重建 exe 和确保一切都像以前一样工作。

所以我只用 .NET 4（完整配置文件）重建了 exe，用它替换了旧的 exe，然后重新启动了应用程序。我收到以下错误：

`"Failure loading the types from the assembly 'blorg.dll'"`（其中 'blorg' 是程序集真实名称的网络安全别名，它是 exe 引用的旧 .NET 2 程序集之一。）

内部异常是：

```
"Could not load file or assembly file 'file:///C:\\(...)blorg or one of its depedencies. The system cannot find the file specified.":"file:///C:\\(...)blorg" 
```

FusionLog 说：

```
=== Pre-bind state information ===
LOG: User = NT AUTHORITY/SYSTEM
LOG: Where-ref bind. Location= C:\(...)\blorg
LOG: Appbase = file:///C:/(...)/
LOG: Initial PrivatePath = NULL
Calling assembly : (Unknown).
===
LOG: This bind starts in LoadFrom load context.
WRN: Native image will not be probed in LoadFrom context. Native image will only be probed in default load context, like with Assembly.Load().
LOG: Using application configuration file: C:\(...)\blorg.exe.config
LOG: Using host configuration file:
LOG: Using machine configuration file from C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\config\machine.config.
LOG: Attempting download of new URL file:///C:/(...)/blorg 
```

有问题的 dll 就在与 exe 相同的文件夹中。当我在 VS2005 中为 .NET 2 构建 exe 时，整个事情运行良好。唯一发生的变化是我打开将可执行文件的解决方案（可执行文件有自己的解决方案）转换为 VS2010，将目标更改为 .NET 4 ，重建它并将其复制粘贴到文件夹中。哦，它正在调试中，而其余的都在发布中。我在网上搜索了一段时间，但没有找到任何可以帮助我诊断问题的东西。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:38:24.643

事实证明，其中一些程序集或它们的依赖项是混合模式 .NET 2.0，因此修复是进入 app.config 并将属性“useLegacyV2RuntimeActivationPolicy”添加到启动元素：

```
<startup useLegacyV2RuntimeActivationPolicy="true">
  <supportedRuntime version="4.0" sku=".NETFramework,Version=v4.0" />
</startup> 
```

# ruby-on-rails - Rails 中的邻近搜索

> ID：11563218
> 
> 赞同：1
> 
> 时间：2012-07-19T14:38:47.037
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, geocoding, proximity

Rails 有哪些邻近搜索选项？（也许各有优缺点？）

*   邮政编码数据库是要走的路吗？
*   或将地理编码与geocoder之类的gem一起使用？
*   是否有任何最佳实践或需要注意的问题？

（使用示例，一个黄页类型的应用程序，企业可以在其中列出，用户可以输入他们的邮政编码并找到离他们很近或在指定英里半径内的企业。）

**更新：**该应用程序与上面的示例应用程序非常相似 - 企业可以在应用程序中列出一个必不可少的目录（每种类型的企业都有类别），用户可以转到一个类别并按距离对结果进行排序（输入他们的邮政编码后 - 因此最接近他们的企业会首先显示）。不会按名称或其他标准进行搜索 - 只需转到“Boxer Dog Breeders”页面并按距离排序即可。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T14:57:37.537

那么答案取决于你想做什么。如果您想要简单的邻近搜索（在半径范围内），那么[Geocoder](https://github.com/alexreisner/geocoder) gem 就更好了！现在，如果您想要更高级的搜索功能（多边形、多多边形搜索等），我建议您使用[PostrgeSQL](http://www.postgresql.org/)数据库和出色的[PostGIS](http://postgis.refractions.net/)扩展。要与 Rails 一起使用，您绝对应该查看[ActiveRecord 的 PostGIS 适配器，](https://github.com/dazuma/activerecord-postgis-adapter)它来自一个非常好的 gem 的作者，称为[RGeo](https://github.com/dazuma/rgeo)，它使用超快库[GEOS](http://trac.osgeo.org/geos)和[Proj](http://trac.osgeo.org/proj)进行地理空间计算。

否则，如果您发现需要具有 GIS 功能的专用搜索服务器，那么您绝对应该使用[ElasticSearch](http://www.elasticsearch.org/)，而 Ruby 有一个很棒的 gem 可以帮助您使用名为[Tire](https://github.com/karmi/tire/)的 ES 。

希望我有所帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:56:29.893

如果您计划添加额外的搜索条件（例如公司名称、类别）或复杂的排序并且您的数据库将增长超过 10000，我建议您使用外部搜索服务器。例如[sphinx search](http://sphinxsearch.com/) + [thinking sphinx](http://freelancing-god.github.com/ts/en/)。

这是地理搜索的示例：http: [//freelancing-god.github.com/ts/en/geosearching.html](http://freelancing-god.github.com/ts/en/geosearching.html)

RoR 模型解决方案（如[Geocoder](https://github.com/alexreisner/geocoder)）对于[全文搜索](http://en.wikipedia.org/wiki/Full_text_search)不是很有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T14:46:02.753

我自己没有地理编码经验，但 Alex Reisner 的[Geocoder](http://github.com/alexreisner/geocoder) gem 看起来是最好的选择，一英里。

> Geocoder 是一个完整的 Ruby 地理编码解决方案。借助 Rails，它添加​​了地理编码（按街道或 IP 地址）、反向地理编码（根据给定坐标查找街道地址）和距离查询。就像在对象上调用地理编码一样简单，然后使用 Venue.near("Billings, MT") 之类的范围。

查看[自述](https://github.com/alexreisner/geocoder/blob/master/README.rdoc)文件以获取有关如何使用它的完整示例。

# c - 为什么下面程序的输入是这样描述的：Pointers, extern values

> ID：11563219
> 
> 赞同：1
> 
> 时间：2012-07-19T14:39:07.760
> 
> 标签：c, pointers, extern

```
int x=0;
int*a=&x;

void foo(int * a) {
    static x=0;
    x++;
    printf("x's value %d ", x);
    *a+=x;
    a=&x;
    *a=x+10;
}

int main(void) {
    foo(a);
    printf("a's value %d\n ", *a);
    foo(a);
    printf("a's value %d ", *a);

    return 1;

} 
```

我正在尝试分析上述内容。foo 的第一次迭代，当函数到达 时`a=&x`，函数停止后的 a 会受到所发生的事情的影响，因为在函数结束时指针会回到他指向的原始值，现在 1\. 静态 x现在也是 1。第二次迭代：x 是如何得到值 12 的？！静态`x`变成了 2，所以我期望 3 是 a 的值。

输出是：

```
 x's value 1 a's value 1
 x's value 12 a's value 13 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:43:57.943

```
a=&x;
*a=x+10; 
```

上面的代码给 加了 10 `x`，因为你设置`a`为指向 的指针`x`，然后将指向的值设置`a`为`x+10`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T14:44:22.963

该行指向静态函数局部变量（因为`a=&x`它是范围内的最内层）。因此，在下一行中，等价于, 并且在我们退出函数时为 11。在下一次调用中，我们增加1，它变为 12。`a``x``*a=x+10``x=x+10``x``x`

# javascript - 与 C++ 相比，Javascript 中的按位异或

> ID：11563224
> 
> 赞同：2
> 
> 时间：2012-07-19T14:39:10.750
> 
> 标签：javascript, c++, bit-manipulation, bitwise-xor

我正在将一个简单的 C++ 函数移植到 Javascript，但似乎我在 Javascript 处理位运算符的方式上遇到了问题。

**在 C++ 中：**

```
AnsiString MyClass::Obfuscate(AnsiString source)
{
    int sourcelength=source.Length();
    for(int i=1;i<=sourcelength;i++)
    {
        source[i] = source[i] ^ 0xFFF;
    }
    return source;
} 
```

Obfuscate("test") 产生临时整数值

```
-117, -102, -116, -117 
```

混淆（“测试”）产生字符串值

```
‹šŒ‹ 
```

**在 Javascript 中：**

```
function obfuscate(str) 
{
    var obfuscated= "";
    for (i=0; i<str.length;i++) {

        var a = str.charCodeAt(i);                 
        var b = a ^ 0xFFF;
        obfuscated= obfuscated+String.fromCharCode(b);
    }
    return obfuscated;
} 
```

obfuscate("test") 产生临时整数值

```
3979 , 3994 , 3980 , 3979 
```

obfuscate("test") 产生字符串值

```
ྋྚྌྋ 
```

现在，我意识到有很多线程指出 Javascript 将所有数字视为浮点数，并且按位运算涉及临时转换为 32 位 int。

这真的不是问题，除了我在 Javascript 中混淆并在 C++ 中反转，并且不同的结果并不真正匹配。

如何将 Javascript 结果转换为 C++ 结果？有一些简单的班次吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T14:57:16.197

[工作演示](http://jsfiddle.net/5HSQ3/)

从 xoring `116`with`0xFFF`给出 -117 的结果来看，我们必须在 javascript 中模拟 2 的补码 8 位整数：

```
function obfuscate(str) 
{
    var bytes = [];
    for (var i=0; i<str.length;i++) {
        bytes.push( ( ( ( str.charCodeAt(i) ^ 0xFFF ) & 0xFF ) ^ 0x80 ) -0x80 );
    }
    return bytes;
} 
```

好的，这些字节在 windows cp 1252 中解释，如果它们是负数，可能只是从 256 中减去。

```
var ascii = [
    0x0000,0x0001,0x0002,0x0003,0x0004,0x0005,0x0006,0x0007,0x0008,0x0009,0x000A,0x000B,0x000C,0x000D,0x000E,0x000F
    ,0x0010,0x0011,0x0012,0x0013,0x0014,0x0015,0x0016,0x0017,0x0018,0x0019,0x001A,0x001B,0x001C,0x001D,0x001E,0x001F
    ,0x0020,0x0021,0x0022,0x0023,0x0024,0x0025,0x0026,0x0027,0x0028,0x0029,0x002A,0x002B,0x002C,0x002D,0x002E,0x002F
    ,0x0030,0x0031,0x0032,0x0033,0x0034,0x0035,0x0036,0x0037,0x0038,0x0039,0x003A,0x003B,0x003C,0x003D,0x003E,0x003F
    ,0x0040,0x0041,0x0042,0x0043,0x0044,0x0045,0x0046,0x0047,0x0048,0x0049,0x004A,0x004B,0x004C,0x004D,0x004E,0x004F
    ,0x0050,0x0051,0x0052,0x0053,0x0054,0x0055,0x0056,0x0057,0x0058,0x0059,0x005A,0x005B,0x005C,0x005D,0x005E,0x005F
    ,0x0060,0x0061,0x0062,0x0063,0x0064,0x0065,0x0066,0x0067,0x0068,0x0069,0x006A,0x006B,0x006C,0x006D,0x006E,0x006F
    ,0x0070,0x0071,0x0072,0x0073,0x0074,0x0075,0x0076,0x0077,0x0078,0x0079,0x007A,0x007B,0x007C,0x007D,0x007E,0x007F
];

var cp1252 = ascii.concat([
    0x20AC,0xFFFD,0x201A,0x0192,0x201E,0x2026,0x2020,0x2021,0x02C6,0x2030,0x0160,0x2039,0x0152,0xFFFD,0x017D,0xFFFD
    ,0xFFFD,0x2018,0x2019,0x201C,0x201D,0x2022,0x2013,0x2014,0x02DC,0x2122,0x0161,0x203A,0x0153,0xFFFD,0x017E,0x0178
    ,0x00A0,0x00A1,0x00A2,0x00A3,0x00A4,0x00A5,0x00A6,0x00A7,0x00A8,0x00A9,0x00AA,0x00AB,0x00AC,0x00AD,0x00AE,0x00AF
    ,0x00B0,0x00B1,0x00B2,0x00B3,0x00B4,0x00B5,0x00B6,0x00B7,0x00B8,0x00B9,0x00BA,0x00BB,0x00BC,0x00BD,0x00BE,0x00BF
    ,0x00C0,0x00C1,0x00C2,0x00C3,0x00C4,0x00C5,0x00C6,0x00C7,0x00C8,0x00C9,0x00CA,0x00CB,0x00CC,0x00CD,0x00CE,0x00CF
    ,0x00D0,0x00D1,0x00D2,0x00D3,0x00D4,0x00D5,0x00D6,0x00D7,0x00D8,0x00D9,0x00DA,0x00DB,0x00DC,0x00DD,0x00DE,0x00DF
    ,0x00E0,0x00E1,0x00E2,0x00E3,0x00E4,0x00E5,0x00E6,0x00E7,0x00E8,0x00E9,0x00EA,0x00EB,0x00EC,0x00ED,0x00EE,0x00EF
    ,0x00F0,0x00F1,0x00F2,0x00F3,0x00F4,0x00F5,0x00F6,0x00F7,0x00F8,0x00F9,0x00FA,0x00FB,0x00FC,0x00FD,0x00FE,0x00FF
]);

function toStringCp1252(bytes){
    var byte, codePoint, codePoints = [];
    for( var i = 0; i < bytes.length; ++i ) {
        byte = bytes[i];
        if( byte < 0 ) {
            byte = 256 + byte;
        }
        codePoint = cp1252[byte];
        codePoints.push( codePoint );

    }

    return String.fromCharCode.apply( String, codePoints );
} 
```

结果

```
toStringCp1252(obfuscate("test"))
//"‹šŒ‹" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:49:13.380

我假设这`AnsiString`是某种形式的 s 数组`char`。这就是问题所在。在[c](/questions/tagged/c "显示标记为“c”的问题")中，`char`通常只能保存 8 位。因此，当您与 进行异或`0xfff`并将结果存储在 a`char`中时，它与与 进行异或相同`0xff`。

这不是[javascript](/questions/tagged/javascript "显示标记为“javascript”的问题")的情况。JavaScript 使用 Unicode。这可以通过查看整数值来证明：

`-117 == 0x8b`和`3979 == 0xf8b`

我会推荐 XORing with`0xff`因为这在两种语言中都适用。或者您可以将您的[c++](/questions/tagged/c%2b%2b "显示标记为“c++”的问题")代码切换为使用 Unicode。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T14:50:31.973

我猜它`AnsiString`包含 8 位字符（因为 ANSI 字符集是 8 位）。当您将 XOR 的结果分配回字符串时，它会被截断为 8 位，因此结果值在 [-128...127] 范围内。

（在某些平台上，它可能是 [0..255]，而在其他平台上，范围可能更宽，因为没有指定是`char`有符号还是无符号，或者它是 8 位还是更大）。

Javascript 字符串包含 unicode 字符，可以容纳更广泛的值，结果不会被截断为 8 位。XOR 的结果将具有至少 12 位的范围，[0...4095]，因此您在那里看到的数字很大。

假设原始字符串仅包含 8 位字符，那么将操作更改为`a ^ 0xff`应该在两种语言中给出相同的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T14:52:23.047

我根本不知道`AnsiString`，但我猜这与字符的宽度有关。具体来说，我怀疑它们的宽度小于 32 位，当然在按位运算中，您所操作的宽度很重要，尤其是在处理 2 的补码时。

在 JavaScript 中，您的`"t"`in`"test"`是字符代码 116，即 b000000000000000000000000001110100。0xFFF (4095) 是 b00000000000000000000111111111111，你得到的结果 (3979) 是 b00000000000000000000111110001011。我们可以很容易地看到您得到了 XOR 的正确结果：

```
116 = 00000000000000000000000001110100
4095 = 00000000000000000000111111111111
3979 = 00000000000000000000111110001011
```

所以我认为你的 C++ 代码中出现了一些截断或类似情况，尤其是因为 -117 是 b10001011 在八位 2 的补码中......这正是我们在上面看到的 3979 的最后八位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T14:49:02.173

首先，将您的转换`AnsiString`为`wchar_t*`. 只有这样才能混淆其各个字符：

```
AnsiString MyClass::Obfuscate(AnsiString source)
{
   /// allocate string
   int num_wchars = source.WideCharBufSize();
   wchar_t* UnicodeString = new wchar_t[num_wchars];
   source.WideChar(UnicodeString, source.WideCharBufSize());

   /// obfuscate individual characters
   int sourcelength=source.Length();
   for(int i = 0 ; i < num_wchars ; i++)
   {
       UnicodeString[i] = UnicodeString[i] ^ 0xFFF;
   }

   /// create obfuscated AnsiString
   AnsiString result = AnsiString(UnicodeString);

   /// delete tmp string
   delete [] UnicodeString;

   return result;
} 
```

抱歉，我不是 C++ Builder 方面的专家，但我的观点很简单：在 JavaScript 中你有 WCS2 符号（或 UTF-16），所以你必须先转换`AnsiString`为宽字符。

尝试使用`WideString`而不是`AnsiString`

# c# - 在 c# 列表对象分配问题中按值内存分配分配自定义列表

> ID：11563225
> 
> 赞同：-1
> 
> 时间：2012-07-19T14:39:15.847
> 
> 标签：c#, list, linq, object

```
objTempList = objParentList;
foreach (var item in objTempList)
{
    objChildList = objList.AsQueryable()
                          .Where(x => x._parentId == item.filedbid)
                          .ToList<FileObjectView>();
    if (objChildList != null)
    {
        foreach (var child in objChildList)
        {
            objParentList.Add(child);
        }
    }
} 
```

以上是我的代码，问题是分配`objTempList = objParentList`

`objParentList`有 10 行`objTempList` 现在在下一步中分配给我，当我正在做并在 其自动反映在列表`foreach`中添加更多行时，我的循环正在给出错误消息。`objParentList``objTempList`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:05:42.023

如果您想分配 to 的内容而`objParentList`不会在您的 foreach 循环内`objTempList`不经意地修改`objTempList`，那么您需要创建一个 的新实例`objParentList`并将其分配给`objTempList`.

这样，将列表项添加到循环内的父列表不会引发异常，因为您将原始副本分配给`objTempList`而不是引用。例如：

```
objTempList = new List<T>(objParentList); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-19T14:41:04.620

您应该分开列表实例以避免此错误

```
objTempList = objParentList.ToList();
foreach (var item in objTempList) 
{ 
   objChildList = objList.AsQueryable().Where(x => x._parentId == item.filedbid).ToList(); 
   foreach (var child in objChildList)
      objParentList.Add(child);       
} 
```

# ios - 如何在 iOS 中使用 ECC

> ID：11563229
> 
> 赞同：11
> 
> 时间：2012-07-19T14:39:37.480
> 
> 标签：ios, elliptic-curve

有没有在 iOS 中使用 ECC 的示例？

我注意到 Apple Developer Documents 中的 kSecAttrKeyTypeEC ，但我不能将它用于通用密钥对。

下面的代码是从示例 CryptoExercise 修改的

```
// Container dictionaries.
NSMutableDictionary * privateKeyAttr = [[NSMutableDictionary alloc] init];
NSMutableDictionary * publicKeyAttr = [[NSMutableDictionary alloc] init];
NSMutableDictionary * keyPairAttr = [[NSMutableDictionary alloc] init];

// Set top level dictionary for the keypair.
[keyPairAttr setObject:(id)kSecAttrKeyTypeEC forKey:(id)kSecAttrKeyType];
[keyPairAttr setObject:[NSNumber numberWithUnsignedInteger:keySize] forKey:(id)kSecAttrKeySizeInBits];

// Set the private key dictionary.
[privateKeyAttr setObject:[NSNumber numberWithBool:YES] forKey:(id)kSecAttrIsPermanent];
[privateKeyAttr setObject:privateTag forKey:(id)kSecAttrApplicationTag];
// See SecKey.h to set other flag values.

// Set the public key dictionary.
[publicKeyAttr setObject:[NSNumber numberWithBool:YES] forKey:(id)kSecAttrIsPermanent];
[publicKeyAttr setObject:publicTag forKey:(id)kSecAttrApplicationTag];
// See SecKey.h to set other flag values.

// Set attributes to top level dictionary.
[keyPairAttr setObject:privateKeyAttr forKey:(id)kSecPrivateKeyAttrs];
[keyPairAttr setObject:publicKeyAttr forKey:(id)kSecPublicKeyAttrs];

// SecKeyGeneratePair returns the SecKeyRefs just for educational purposes.
sanityCheck = SecKeyGeneratePair((CFDictionaryRef)keyPairAttr, &publicKeyRef, &privateKeyRef);
LOGGING_FACILITY( sanityCheck == noErr && publicKeyRef != NULL && privateKeyRef != NULL, @"Something really bad went wrong with generating the key pair." ); 
```

sanityCheck 总是返回 -50，这意味着 'errSecParam'。

我真的不知道如何使用它，感谢您阅读本文。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-08T13:53:17.190

```
NSDictionary *parameters = @{
                             (__bridge id)kSecAttrKeyType: (__bridge id)kSecAttrKeyTypeEC,
                             (__bridge id)kSecAttrKeySizeInBits: @256,
                             (__bridge id)kSecPrivateKeyAttrs: @{
                                     (__bridge id)kSecAttrIsPermanent: @YES,
                                     (__bridge id)kSecAttrApplicationTag: [@"my.key.tag" dataUsingEncoding:NSUTF8StringEncoding],
                                     },
                             (__bridge id)kSecPublicKeyAttrs: @{
                                     (__bridge id)kSecAttrIsPermanent: @YES,
                                     (__bridge id)kSecAttrApplicationTag: [@"my.key.pubtag" dataUsingEncoding:NSUTF8StringEncoding],
                                     }
                             };

SecKeyRef publicKey, privateKey;
OSStatus status = SecKeyGeneratePair((__bridge CFDictionaryRef)parameters, &publicKey, &privateKey); 
```

这有效，请仔细检查您的密钥大小参数。

请注意，目前 EC 密钥只能用于签名/验证数据。加密/解密返回`errSecUnimplemented = -4.`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-10T06:58:25.987

CryptoKit 现在在 iOS13+ 中支持 Ed25519

[https://developer.apple.com/documentation/cryptokit/curve25519/signing](https://developer.apple.com/documentation/cryptokit/curve25519/signing)

# php - 自定义分页 - 箭头不起作用

> ID：11563230
> 
> 赞同：0
> 
> 时间：2012-07-19T14:39:38.323
> 
> 标签：php, wordpress, pagination

我有一个奇怪的问题，即为下一页和上一页生成的箭头不起作用。我似乎无法修复它。html 似乎很好，数字工作，但是当点击什么都没有发生：http: [//sketchbookmagazine.com/category/fashion/](http://sketchbookmagazine.com/category/fashion/)

分页代码：

```
function pagination($prev = '«', $next = '»') {
    global $wp_query, $wp_rewrite;
    $wp_query->query_vars['paged'] > 1 ? $current = $wp_query->query_vars['paged'] : $current = 1;
    $pagination = array(
        'base' => @add_query_arg('paged','%#%'),
        'format' => '',
        'total' => $wp_query->max_num_pages,
        'current' => $current,
        'prev_text' => __($prev),
        'next_text' => __($next),
        'type' => 'plain'
);
    if( $wp_rewrite->using_permalinks() )
        $pagination['base'] = user_trailingslashit( trailingslashit( remove_query_arg( 's', get_pagenum_link( 1 ) ) ) . 'page/%#%/', 'paged' );

    if( !empty($wp_query->query_vars['s']) )
        $pagination['add_args'] = array( 's' => get_query_var( 's' ) );

    echo paginate_links( $pagination );
}; 
```

html:

```
<div class="pagination"><?php pagination('«','»'); ?></div> 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:56:54.043

我从未见过这种构造：

```
$wp_query->query_vars['paged'] > 1 ? $current = $wp_query->query_vars['paged'] : $current = 1; 
```

尝试将其更改为：

```
$current = $wp_query->query_vars['paged'] > 1 ? $wp_query->query_vars['paged'] : 1; 
```

# spotify - libspotify API：跟踪索引

> ID：11563235
> 
> 赞同：0
> 
> 时间：2012-07-19T14:39:48.007
> 
> 标签：spotify

有什么方法可以获取专辑中的曲目索引吗？或者给定一个曲目 URI，是否可以在不遍历整个专辑的情况下知道它在专辑中的索引或偏移量（假设曲目属于专辑）？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T12:58:44.153

是的，他指的是 sp_track_index，只能通过专辑浏览访问。

[在此处查看 sp_track_index 的 libspotify 文档](https://developer.spotify.com/technologies/libspotify/docs/12.1.45/group__track.html#ga25c1df9d32fd58f243397740b29c3f61)

您需要做的是以下方面的事情：

1.  为您拥有的 sp_track 专辑调用 sp_albumbrowse_create
2.  等待创建/加载时触发的回调
3.  从该轨道获取 sp_track_index。最好将特定轨道放在用户数据中以传递给回调以用于比较。

注意：在浏览之外获取 sp_track_index 将始终返回 0。

[请参阅此处的浏览示例](https://developer.spotify.com/technologies/libspotify/docs/12.1.45/browse_8c-example.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T14:26:07.677

您必须对目标专辑进行专辑浏览。完成后，您可以获得曲目的索引。

# javascript - jquery.rotate 错误

> ID：11563238
> 
> 赞同：2
> 
> 时间：2012-07-19T14:39:53.813
> 
> 标签：javascript, jquery, jquery-plugins

我有一张图像，我试图将其旋转 30 度并在页面上水平移动。但是，我认为我没有正确处理 jquery，因为我在 Firefox Web 控制台中遇到了几个错误。以下是错误：

```
[10:30:27.260] ReferenceError: jQuery is not defined @ file:///home/ladmin/Desktop/javascriptAnimations/jquery.rotate.1-1.js:1
[10:30:27.274] The character encoding of the HTML document was not declared. The document will render with garbled text in some browser configurations if the document contains characters from outside the US-ASCII range. The character encoding of the page must to be declared in the document or in the transfer protocol. @ file:///home/ladmin/Desktop/javascriptAnimations/si110cockroach.html
[10:31:03.416] ReferenceError: $ is not defined @ file:///home/ladmin/Desktop/javascriptAnimations/si110cockroach.html:12 
```

我在顶部包含了带有 jquery 源的脚本标签，如下所示：

```
<script language="javascript" type="text/javascript" src="jquery.rotate.1-1.js"></script> 
```

这是我调用 jquery 的代码：

```
function moveLeft(object,x,y){
        $(object).rotateRight(30);
        object.style.right = x + "px";
        object.style.top   = y + "px";

        if (x < 0 || x > 1500 || y < 0 || y > 1500)
        {
            object.style.visibility="hidden";
        }
        else
        {               
            var t = setTimeout(function() { moveLeft(object,x+3,y+0); }, 5);
        }
    } 
```

我没有正确包含源文件还是我没有调用 jquery 对？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T14:41:57.287

您必须在脚本之前包含[jquery.min.js](http://code.jquery.com/jquery.min.js)`jquery.rotate.1-1.js`：

```
<script language="javascript" type="text/javascript" src="jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="jquery.rotate.1-1.js"></script> 
```

# telerik - Telerik RadGrid GridTemplateColumns 以编程方式

> ID：11563247
> 
> 赞同：1
> 
> 时间：2012-07-19T14:40:39.360
> 
> 标签：telerik, radgrid

我需要制作多个带有可编辑列的 RadGrid。我了解如何制作绑定列和制作模板列，但我不知道如何将文本框和下拉列表放置在这些模板列中。

```
string templateColumnName = "ContactName";
GridTemplateColumn templateColumn = new GridTemplateColumn();
templateColumn.ItemTemplate = new MyTemplate(templateColumnName);
templateColumn.HeaderText = templateColumnName; 
```

之后我该怎么办。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T14:50:38.917

您应该在容器中实例化所需的 web 控件。这发生在 InstantiateIn 方法中。我建议您检查此链接： [Programmatic creation](http://www.telerik.com/help/aspnet-ajax/grid-programmatic-creation.html#Section4)

如果您需要更多信息，还可以查看以下信息：以 [编程方式创建 Web 服务器控件模板](http://msdn.microsoft.com/en-us/library/aa289501.aspx)

如果您对此有任何具体问题，请告诉我们。

# css - 让浮动“向上浮动”以填充空间

> ID：11563249
> 
> 赞同：2
> 
> 时间：2012-07-19T14:40:41.223
> 
> 标签：css, css-float

下面屏幕截图中的每个框都使用“float:left”设置样式。

我怎样才能让它们浮动到第一个有空间的“列”？（例如，在下面的示例中，将 Music Nation 框移动到红色箭头所示的位置）

![在此处输入图像描述](../Images/8fe3b80e3356f1e69d4e1b50c17ea211.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:55:47.013

您可以将列放在右侧，样式为`float:right`. 这应该可以解决问题，但我真的不知道是否有最佳实践。

您也可以在盒子上放一个负边距顶部以将其拉起，但在我看来，这是一种不好的做法。你应该试试我说的第一个。

**编辑**：我认为这对你来说会很有趣：http: [//masonry.desandro.com/](http://masonry.desandro.com/)

# string - Solr - 在字符串中搜索单词

> ID：11563251
> 
> 赞同：0
> 
> 时间：2012-07-19T14:40:43.263
> 
> 标签：string, text, solr

我有一个包含很多单词的字段，例如：

“你好，我的名字是 Nicole，我正在与 Solr 合作”

如果我搜索这个词，我需要 Solr 返回这个文档（请注意，词序与索引文本中的不同）：

“我的名字与”

我正在使用这个配置

```
<fieldType name="propertiesField" class="solr.TextField">
    <analyzer type="index">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory" />
    </analyzer>
    <analyzer type="query">
        <tokenizer class="solr.PatternTokenizerFactory" pattern="-" />
        <filter class="solr.LowerCaseFilterFactory" />
    </analyzer>
</fieldType> 
```

这个查询：

select/?q=properties_all:am-name-with&version=2.2&start=0&rows=10&indent=on

当我使用分析器对其进行分析时，这些单词会突出显示，但在我进行搜索时未找到任何文档。

谢谢你的帮助！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:11:51.837

如果没有充分的理由使用不同的索引和查询时间分析器，请不要。

我会 fieldType 喜欢：

```
<fieldType name="propertiesField" class="solr.TextField">
    <analyzer>
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory" />
    </analyzer>
</fieldType> 
```

另外将默认运算符设置为 AND（模式文件）

```
<solrQueryParser defaultOperator="AND"/> 
```

然后查询 Solr：

```
select/?q=properties_all:(am name with)&version=2.2&start=0&rows=10&indent=on 
```

# android - 如何在电子邮件正文中发送图像文件

> ID：11563253
> 
> 赞同：0
> 
> 时间：2012-07-19T14:40:48.913
> 
> 标签：android, image, android-intent

我知道这个问题已经在堆栈溢出中提出，我环顾四周但没有得到任何线索。实际上，我已经编写了将图像文件作为邮件附件发送的代码，并且工作正常。我用于将图像文件作为附件发送的代码如下所示。谁能告诉我在邮件正文中发送图像文件需要做哪些更改？任何线索都会有所帮助。

**将图像作为附件发送的代码**

```
Uri imageUri = Uri.parse("content://" + CachedFileProvider.AUTHORITY + "/" + fileNameArray.get(position));

Intent intent = new Intent(android.content.Intent.ACTION_SEND);
intent.setType("image/png");
intent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);

intent.putExtra(Intent.EXTRA_STREAM, imageUri);
startActivity(Intent.createChooser(i, "Send email")); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:45:48.103

只能在设备上工作，而不是在 android 模拟器..

[http://blogingtutorials.blogspot.com/2010/12/send-email-with-attached-file-in.html](http://blogingtutorials.blogspot.com/2010/12/send-email-with-attached-file-in.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:57:11.630

尝试使用以下意图：

```
Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND); 
emailIntent.setType("image/jpeg");
emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[] 
{"me@gmail.com"}); 
emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, 
"Test Subject"); 
emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, 
"go on read the emails"); 
Log.v(getClass().getSimpleName(), "sPhotoUri=" + Uri.parse("file:/"+ sPhotoFileName));
emailIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://"+ sPhotoFileName));
startActivity(Intent.createChooser(emailIntent, "Send mail...")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-02T09:29:36.620

[如何在电子邮件正文中添加图像您](https://stackoverflow.com/questions/5244472/how-to-add-an-image-in-email-body)是否已经解决了这个问题......在这个问题中明确写到这是不可能的

# sql-server - 不在 SQL Server 2008 R2 Express 中存储小数点

> ID：11563254
> 
> 赞同：1
> 
> 时间：2012-07-19T14:40:53.407
> 
> 标签：sql-server, localization, windows-server-2008, sqldatatypes

我在英国。我在德国有一台 Windows 2008 服务器，上面安装了 SQL Server 2008 R2 Express。Windows 的区域设置设置为英国。SQL Server 语言设置为英语。当我跑

```
sp_helplanguage @@LANGUAGE 
```

它表明它设置为

```
us_english 
```

我在数据库中有许多表，其中包含浮点数据类型。当我使用 SSMS 更改浮点值之一时，如果我输入

```
1234.1234 
```

首先它显示为

```
1234,1234 
```

然后当我单击该行以保存它时，它显示为

```
12341234 
```

ASP.NET 应用程序通过存储过程提供数据并放入双精度（VB.NET）中，它执行

```
String.Format("{0:#0.0000}", dMyDouble) 
```

这呈现为

```
12341234,0000 
```

不用说，在我的本地服务器（全部基于英国）上，所有数据库输入的数字都会按我的预期显示（1234.1234），.NET 会按我的预期格式化它们（1234.1234）。我知道我的欧洲朋友在英国使用与我们不同的符号，但我需要输出英国格式 - 更重要的是数据库中的浮点数！

我想.NET 格式不正确的事实纯粹与数字没有存储准确性的事实有关。

我还通过使用小数列 (18, 4) 进行了一些操作，得到了类似的结果。当我使用点 (.) 键入 1234.1234 时，它会替换为逗号 (,)。保存该行时，它另存为

```
12341234.0000 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:46:54.597

您必须将会话中的[LANGUAGE](http://msdn.microsoft.com/en-us/library/ms174398.aspx)设置为所需的设置。

但是，尽管您没有显示任何 C# 代码，但您看到格式问题的事实意味着您将值作为SQL 命令中的*文本传递。*你应该`@variables`改用。这将具有避免 SQL 注入问题的附带好处。

# crystal-reports - 是否可以确定 Crystal Reports 中的当前渲染位置？

> ID：11563267
> 
> 赞同：-1
> 
> 时间：2012-07-19T14:41:30.113
> 
> 标签：crystal-reports

我想根据当前页面上剩余的空间创建一个有条件的 keeptogether 属性，是否可以从公式字段中获取此值？

我的目标是在不浪费太多空间的情况下提供视觉清晰的报告，我已经阅读了一种方法，您可以使用行号计数器跟踪您的位置。不幸的是，我不能使用这种方法，因为我的线条高度变化很大，因为注释字段包含 0 到 25 行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T14:59:43.430

这听起来像是一个荒谬而乏味的建议，但这是我知道的唯一方法。您将需要使用您听说过的行数计算过程（基本上，保持已打印的行数的总和）：通过获取 Notes 字符串的长度来计算 Notes 需要的行数并除以预先确定的计数，您需要直观地完成一行中有多少个字符，并使结果成为整个公式中行的行数。它不会完全正确，因为没有办法让它完全正确，但它会很接近。这有意义吗，还是您需要我详细说明如何执行此操作？

# c++ - 什么更快：比较然后改变，还是立即改变？

> ID：11563268
> 
> 赞同：2
> 
> 时间：2012-07-19T14:41:31.940
> 
> 标签：c++, c

让我做非常快的循环，我必须确保在每个循环结束时变量`a`是`SOMEVALUE`. 什么会更快？

`if (a != SOMEVALUE) a = SOMEVALUE;`

或立即做

`a = SOMEVALUE;`

它是浮点/整数/布尔/语言特定的吗？

更新：`a`是原始类型，而不是类。TRUE 比较的可能性是 50%。我知道算法是使循环快速的原因，所以我的问题也是关于编码风格的。

Update2：感谢大家的快速回答！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:46:33.313

在几乎所有情况下，仅设置值会更快。

当您必须处理与其他 cpu 共享缓存行时，或者如果“a”位于某种特殊类型的内存中时，它可能不会更快，但可以肯定的是，分支预测错误可能是比缓存共享更常见的问题。

此外 - 更小的代码更好，不仅用于缓存，还用于使代码易于理解。

如果有疑问 - 配置文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T14:49:06.183

一般的答案是描述这类问题。但是，在这种情况下，可以进行简单的分析：

每个测试都是一个分支。每个分支都会导致轻微的性能损失。但是，我们有[分支预测](https://stackoverflow.com/a/11227902/371834)，并且这种惩罚会在一定程度上按时间摊销，具体取决于您的循环有多少次迭代以及预测正确的次数。

转换为您的情况，如果您在循环期间有很多更改，`a`那么使用的代码很可能`if`会在性能上更差。另一方面，如果值很少更新，则两种情况之间的差异将无限小。

不过，立即更改更好，应该使用，只要您不关心以前的值，如您的片段所示。

立即更改的其他原因：它会导致更小的代码，从而更好的缓存局部性，从而更好的代码性能。这是一种非常罕见的情况，更新`a`会使缓存行无效并导致性能下降。不过，如果我没记错的话，这只会在多处理器情况下对你造成影响，而且很少见。

请记住，在某些情况下，两者并不相似。比较`NaN`s 是未定义的行为。

此外，此注释仅处理 C 的情况。在 C++ 中，您可以拥有赋值运算符/复制构造函数比测试相等性花费更长的类。在这种情况下，您可能需要先进行测试。

考虑到您的更新，只要您确定不处理未定义的行为（浮点数），最好简单地使用赋值。编码风格也更好，更容易阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T14:44:28.587

你应该分析它。

我的猜测是差别不大，具体取决于测试为真的频率（这是由于分支预测）。

当然，只是设置它具有最小的绝对代码大小，这可以释放指令缓存以获得更有趣的代码。

但是，你应该再次分析它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T14:46:26.607

我会感到惊讶的是答案不是`a = somevalue`，但这个问题没有通用的答案。首先，它取决于复制速度与相等比较的速度。如果相等比较非常快，那么您的第一个选择可能会更好。其次，一如既往，它取决于您的编译器/平台。回答此类问题的唯一方法是尝试两种方法并为它们计时。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-19T14:51:22.457

**分析代码。相应地改变。**

对于基本类型，无分支选项应该更快。例如，MSVS 不会优化分支。

话虽如此，这里有一个比较版本更快的例子：

```
struct X
{
    bool comparisonDone;
    X() : comparisonDone(false) {}
    bool operator != (const X& other) { comparisonDone = true; return true; }
    X& operator = (const X& other)
    {
       if ( !comparisonDone )
       {
           for ( int i = 0 ; i < 1000000 ; i++ )
               cout << i;
       }
       return *this;
    }
}

int main()
{
    X a;
    X SOMEVALUE;
    if (a != SOMEVALUE) a = SOMEVALUE;
    a = SOMEVALUE;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-19T14:50:13.003

当您要求 C++ 程序时，我假设您正在将代码编译为本机机器指令。

在任何情况下，直接分配值而不进行任何比较应该会快得多。为了比较这些值，值 a 和 SOMEVALUE 都应该传送到寄存器，并且必须执行一条机器指令 cmp()。

但是在后一种直接分配的情况下，您只需将一个值从一个内存位置移动到另一个内存位置。

只有当内存写入比内存读取成本高得多时，分配才能变慢。我不认为会发生这种情况。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-07-19T14:43:36.140

~~立即更改通常更快，因为它不涉及代码中的分支。~~

正如下面评论和其他人回答的那样，它确实取决于许多变量，但恕我直言，真正的问题是：你关心以前的值是多少？如果你是，你应该检查，否则，你不应该。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-19T14:47:33.220

正如其他人所说，分析它将是最简单的判断方法，因为它在很大程度上取决于您向它提供的输入类型。但是，如果您考虑这两种算法的计算复杂性，您投入的输入越多，它们之间可能存在的差异就越小。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-07-19T14:53:46.010

这`if`实际上可以被一些编译器“优化掉”，基本上把它`if`变成代码噪音（对于正在阅读它的程序员来说）。

当我使用 GCC for x86 编译以下函数时（使用`-O1`，这是一个非常合理的优化级别）：

```
int foo (int a)
{
  int b;

  if (b != a)
    b = a;

  b += 5;

  return b;
} 
```

GCC 只是**“优化”`if` *和*赋值 away**，并简单地使用参数来做加法：

```
foo:
        pushl   %ebp
        movl    %esp, %ebp
        movl    8(%ebp), %eax
        popl    %ebp
        addl    $5, %eax
        ret
        .ident  "GCC: (GNU) 4.4.3" 
```

有或没有`if`生成完全相同的代码。

# c# - 无法理解如何使用 DevExpress 选项卡控件

> ID：11563270
> 
> 赞同：1
> 
> 时间：2012-07-19T14:41:32.863
> 
> 标签：c#, asp.net, devexpress

我不知道如何使用 DevExpress 选项卡控件。我拖动控件并添加了三个选项卡，当我尝试将内容放在适当的标签内时，它说`DevExpress.Web.ASPxTabControl.Tab`没有名为的公共属性`div`。

这是代码：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="AddNews.aspx.cs" Inherits="MarketingAdmin.EditNews" %>

<%@ Register Assembly="DevExpress.Web.v12.1, Version=12.1.4.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a"
    Namespace="DevExpress.Web.ASPxTabControl" TagPrefix="dx" %>

<%@ Register Assembly="DevExpress.Web.ASPxEditors.v12.1, Version=12.1.4.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a"
    Namespace="DevExpress.Web.ASPxEditors" TagPrefix="dx" %>

<%@ Register Assembly="DevExpress.Web.ASPxHtmlEditor.v12.1, Version=12.1.4.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a"
    Namespace="DevExpress.Web.ASPxHtmlEditor" TagPrefix="dx" %>
<%@ Register assembly="DevExpress.Web.ASPxSpellChecker.v12.1, Version=12.1.4.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a" namespace="DevExpress.Web.ASPxSpellChecker" tagprefix="dx" %>
<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
       <dx:ASPxTabControl ID="ASPxTabControl1" runat="server" ActiveTabIndex="0" 
        EnableTheming="True" Theme="Glass">
        <Tabs>
            <dx:Tab Text="Казахский" >
                <div style="font-family=Times New Roman; font-size:medium ">Категория 
        <asp:DropDownList ID="CategoryDropDownList" runat="server" 
            DataSourceID="SqlDataSource1" DataTextField="Name" DataValueField="id" ></asp:DropDownList> 
        <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
            ConnectionString="<%$ ConnectionStrings:MarketingConnectionString %>" 
            SelectCommand="SELECT [Name], [id] FROM [NewsCategory]"></asp:SqlDataSource>
    </div>
    <div style="font-family=Times New Roman; font-size:medium "> Заголовок 
        <asp:TextBox ID="TitleTextBox" runat="server" Width="610px"></asp:TextBox></div>

<dx:ASPxHtmlEditor ID="ASPxHtmlEditor1" runat="server">
</dx:ASPxHtmlEditor>            
            </dx:Tab>
            <dx:Tab Text="Русский">
            content 2
            </dx:Tab>
            <dx:Tab Text="Английский">
            content 3
            </dx:Tab>
        </Tabs>
    </dx:ASPxTabControl>

    <asp:Button ID="SaveButton" runat="server" Text="Сохранить" 
        onclick="SaveButton_Click" />
</asp:Content> 
```

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:32:40.047

根据您的要求，我相信您需要使用[ASPxPageControl](http://demos.devexpress.com/ASPxperienceDemos/TabControl/Features.aspx)。ASPxTabControl 仅用于创建一个标签条，其下方没有实际的“标签”。它最适合用于站点导航。

# jquery - 无限滚动和加载 div

> ID：11563274
> 
> 赞同：1
> 
> 时间：2012-07-19T14:41:52.123
> 
> 标签：jquery, infinite-scroll

我用这个插件

```
http://www.infinite-scroll.com/
```

我需要在我的加载按钮上放置一个加载 div。

```
http://www.infinite-scroll.com/trigger.html
```

我在插件的网站上没有找到任何文档如何做到这一点。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:15:55.120

这是解决方案：

```
$container.infinitescroll({
                navSelector: '#nav-pagination-load-more',
                nextSelector: '#nav-pagination-load-more .next',
                itemSelector: '.hentry',
                加载：{
                    选择器：'#load-more',
                    finishedMsg: '没有更多的帖子要加载。',
                    img: 'http://cdn.moozpaper.com/lucidpress/wp-content/themes/lucidpress/images/loading_small.gif',
                    消息文本：''
                }
            },

```

# php - MYSQL 制定搜索查询

> ID：11563275
> 
> 赞同：2
> 
> 时间：2012-07-19T14:41:53.037
> 
> 标签：php, mysql

我在为我用 php.ini 编写的搜索制定查询时遇到了一些困难（大概是语法）。

到目前为止，我有这个：

`$query = ("SELECT * FROM $table WHERE $field LIKE "$trimmed);`

修剪定义为 `$trimmed = trim($var);`

我想要完成的是，使用该查询在我的 mysql 数据库中搜索某一行。我已经确认它确实连接到数据库并且它确实从表中获取数据。我是 99% 的 php 和 mysql 新手，我刚刚开始研究这个。任何帮助将不胜感激。

编辑：哦，我在这里使用查询： `$result = mysql_query($query);`我确定问题不在这里，但在 $query

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:48:32.413

改变

```
$query = ("SELECT * FROM $table WHERE $field LIKE "$trimmed); 
```

到

```
$query = "SELECT * FROM $table WHERE $field LIKE '$trimmed'"; 
```

在输入中转义任何特殊字符（例如反斜杠）总是一个好主意。使用 mysql，您可以使用`mysql_escape_string`：

```
$trimmed = mysql_escape_string($trimmed);
$query = "SELECT * FROM $table WHERE $field LIKE '$trimmed'"; 
```

等效命令存在于 mysqli、PDO 和所有 PHP 框架中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:45:59.803

[查看 PHP 手册](http://php.net/manual/en/book.mysql.php)，例如：

```
$query= mysql_query("SELECT data FROM mydb;");
$myarray= array();
while ($row= mysql_fetch_array($query)) {
    $myarray[] = $row['data'];
} 
```

**编辑**

这是你的代码？如果是这样，你有一个语法错误：

```
$query = ("SELECT * FROM $table WHERE $field LIKE "$trimmed); 
```

应该：

```
$query = ("SELECT * FROM $table WHERE $field LIKE '$trimmed'"); 
```

# php - PHP远程调试：XDebug无法连接JetBrains php Storm客户端

> ID：11563280
> 
> 赞同：19
> 
> 时间：2012-07-19T14:42:04.043
> 
> 标签：php, apache2, xdebug, remote-debugging, phpstorm

我想让远程调试与以下软件配置一起工作：

Win 7 Pro 64 位 WAMP 服务器 2.2 (32 位) 包括。Apache 2.2.22、PHP 5.4.3、XDebug php_xdebug-2.2.1-5.4-vc9.dll JetBrains PHPStorm 4.0.3

1.) WAMP 已启动并运行，我的站点可以在 localhost/fox/ 下找到

2.) PHP Storm 有一个项目，其中我的源文件和 apache 别名 localhost/fox 之间存在映射

2.) 我安装了 php 扩展 XDebug 并将以下行添加到我的 php.ini

```
[xdebug]
zend_extension="c:/wamp/bin/php/php5.4.3/zend_ext/php_xdebug-2.2.1-5.4-vc9.dll"
xdebug.remote_enable=On
xdebug.remote_host="localhost"
xdebug.remote_port=9000
xdebug.remote_connect_back=On
xdebug.remote_autostart=On
xdebug.profiler_enable=On
xdebug.profiler_enable_trigger=off
xdebug.profiler_output_name=cachegrind.out.%t.%p
xdebug.profiler_output_dir="c:/wamp/tmp"
xdebug.remote_log="C:/wamp/tmp/xdebug.log"
xdebug.remote_cookie_expire_time=6000 
```

这应该配置远程调试 XDebug 和回调地址。

我已经在这里检查了我的安装：xdebug.org/wizard.php

3.）我配置了phpstorm，首先我添加了本地服务器

然后在这里检查我的设置

[http://www.bilder-hochladen.net/files/jrn0-2-c81e-jpg-nb.html](http://www.bilder-hochladen.net/files/jrn0-2-c81e-jpg-nb.html)

（我也尝试将 127.0.0.1/fox 作为服务器地址，并改为使用 localhost）

继承我的调试设置： http: [//www.bilder-hochladen.net/files/jrn0-1-c4ca-jpg.html](http://www.bilder-hochladen.net/files/jrn0-1-c4ca-jpg.html)

现在我重新启动我的apache，我进入phpstorm，设置一个断点（它是红色的），点击函数

```
Run  -> Start listen to PHP Debug Connections 
```

电话听筒变绿了，这究竟意味着什么，但这对我来说是一个积极的信号。

当我现在在本地网络服务器上运行我的 php 脚本时，绝对没有任何反应，程序在断点上运行并且不会停止。

在 Xdebuggers 日志 (C:/wamp/tmp/xdebug.log) 中，我发现大量这些消息，如下所示：

```
 I: Checking remote connect back address.
 I: Remote address found, connecting to ::1:9000.
 E: Could not connect to client. :-(
 Log closed at 2012-07-19 14:21:08 
```

我在互联网的某个地方找到了提示，Windows 防火墙可能会阻止通信，所以我将其完全关闭，但这并没有帮助。

我还尝试通过 telnet 连接到 localhost:9000，我得到了 phpstorm 的响应。

有没有人知道在哪里搜索错误或者我可以尝试让这些东西正常工作？

非常感谢您提前提供的帮助，迈克尔

ps 抱歉，我不能发布超过两个链接，因为我是新来的，因此没有指向 xdebug 向导的超链接。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-12-04T02:22:43.567

也许有点晚了，但是...

在这里，您的设置有矛盾：

```
xdebug.remote_host="localhost"
xdebug.remote_connect_back=On 
```

这两个设置重叠。你的情况是什么？

a)**您希望仅从一个来源调试您的应用程序**（例如，您正在从 开发和部署到`localhost`）。

然后你就差不多完成了：你已经定义了远程主机是`localhost`. 注释掉该`remote_connect_back`行（带`;`）

b)**您希望接受多个开发源**（例如，在同一网络中调试应用程序的多台机器）。

然后该`remote_host`行被覆盖，因此您可以删除或评论它。

这实际上是您当前正在运行的配置。那么，它有什么问题呢？检查它运行这个脚本：

```
<?
echo $_SERVER['REMOTE_ADDR']; 
```

输出将是`::1`. 那么，向您的 Apache 服务器发出请求的主机是`localhost`. 而 Apache 正在将该名称解析为 IPv6 地址`::1`，这最终并没有错。但是 Xdebug 无法连接到 IPv6 地址。看：

```
I: Remote address found, connecting to ::1:9000.
E: Could not connect to client. :-( 
```

因此，我们的目标是让 Apache`localhost` *更好*地解析为 IPv4 地址（在操作系统级别或 Apache 级别不禁用对 IPv6 的任何支持）。这可以通过在您的`hosts`文件中添加下一行来实现：

```
127.0.0.1 localhost 
```

这个简单的技巧可以解决问题！现在`localhost`总是最好将其解析为 IPv4 地址，同时`::1`仍然可以完全理解。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-25T18:39:26.790

您可以尝试禁用 IPV6 [http://support.microsoft.com/kb/929852](http://support.microsoft.com/kb/929852)，我认为这是问题所在，当您尝试连接时。

> 找到远程地址，连接到 ::1:9000。

系统正在尝试与 IPV6 连接，我认为 XDebug 仅对 IPV4 启用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T15:10:56.273

您的代码中的断点到底在哪里？我知道 XDebug 可能很有趣。

对于 PHP 5.4，您的 Xdebug 设置应该是

```
[XDebug]
zend_extension="<path to php_xdebug.dll>"
xdebug.remote_enable=1
xdebug.remote_port="<the port for XDebug to listen to>" (the default port is 9000)
xdebug.profiler_enable=1
xdebug.profiler_output_dir="<AMP home\tmp>" 
```

[http://www.jetbrains.com/phpstorm/webhelp/configuring-xdebug.html](http://www.jetbrains.com/phpstorm/webhelp/configuring-xdebug.html)

# email - 为什么在电子邮件中写“at”和“dot”而不是“@”和“.”？

> ID：11563283
> 
> 赞同：59
> 
> 时间：2012-07-19T14:42:24.933
> 
> 标签：email, webpage

我在他们的电子邮件中看到**了一些**人们不使用的网站`@`。`.`例如，他们把`name_at_webpage_dot_com`而不是`name@webpage.com`.

我在这里问这个问题是因为我倾向于认为它与网页设计有关。它可能只是一种样式，与 html 无关。我完全不知道这一点。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-07-19T14:46:05.533

通常，人们这样做是为了避免他们的电子邮件地址被搜索与电子邮件地址格式匹配的正则表达式的垃圾邮件机器人发现。通过使用 _AT_ 和 _DOT_，垃圾邮件机器人正在寻找的符号将不会显示在页面上，因此您的电子邮件地址将不会被找到。

如果您想避免收件箱中充满垃圾邮件，这通常是一种很好的做法。然后您在公共页面上提供您的电子邮件地址。但是，您可以通过不在公共论坛上发布您的电子邮件地址来完全避免这个问题。如果你想把它给别人，可以通过私信或电子邮件或其他方式发送。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-19T14:44:11.783

这是为了混淆 Mail-harvesters 中的 Mailadresses。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-07-19T14:56:52.703

这是针对自动垃圾邮件机器人的众多反收割技术之一。这个被大量使用，所以有很多垃圾邮件程序使用它，它不能 100% 工作。您可以在这篇精彩的文章中看到各种反收割技术的一些统计数据和比较

[https://web.archive.org/web/20180811103545/http://techblog.tilllate.com/2008/07/20/ten-methods-to-obfuscate-e-mail-addresses-compared/](https://web.archive.org/web/20180811103545/http://techblog.tilllate.com/2008/07/20/ten-methods-to-obfuscate-e-mail-addresses-compared/)

我个人更喜欢结合 javascript 的 css display:none 技术。请参阅示例：

```
<a href="mailto:myemail@ignoreme-example.com">myemail@<span style="display:none;">ignoreme-</span>example.com 
```

并使用 javascript 将其从 href 元素中删除。这样，它适用于启用了 javascript 的用户，并且禁用了 javascript 的用户至少可以正确看到地址，但是当然，单击无法正常工作。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-07-19T14:44:35.717

它是一种简单的垃圾邮件防护形式，可防止自动垃圾邮件程序通过匹配这些特定字符来查找电子邮件地址。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-07-19T14:49:25.420

人们通常在可公开访问的网站上写他们的电子邮件地址，希望垃圾邮件发送者运行的网络蜘蛛不会将其检测为电子邮件地址，因此不会向他们发送垃圾邮件。

然而，任何半途而废的网络蜘蛛都应该能够将“web dot com 上的示例”解码为电子邮件地址，因此这大多是徒劳的，如果担心垃圾邮件，最好不要发布您的电子邮件。

# php - 将变量添加到函数中

> ID：11563286
> 
> 赞同：-1
> 
> 时间：2012-07-19T14:42:40.550
> 
> 标签：php, html, sql

您好，我有一个 granit php 函数，但想将我自己的文本打印到其中，该文本存储在一个变量中。

这是我输入变量之前代码的样子：

```
 gradient('FF0000', '0000FF', 'my test goes here'); 
```

哪个工作正常，但现在我想将变量放在文本所在的位置

```
 gradient('FF0000', '0000FF', '".$profile."'); 
```

这只是将 $profile 回显到页面上。我可以回显 $profile 并且它工作正常，但我想向它添加 granit 函数。

我究竟做错了什么 ？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:44:08.943

简单地：

```
gradient('FF0000', '0000FF', $profile); 
```

或者：

```
$color1 = 'FF0000';
$color2 = '0000FF';
$profile = 'my test goes here';

gradient($colour1, $colour2, $profile); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:46:07.180

```
$profile = 'my test goes here';
gradient('FF0000', '0000FF', $profile); 
```

将工作。

# grails - 如何知道用户是否登录（在 GSP 中）

> ID：11563287
> 
> 赞同：5
> 
> 时间：2012-07-19T14:42:42.453
> 
> 标签：grails, spring-security, gsp

我有`index.gsp`一个页面。在该页面中，有一个注册按钮和一个登录按钮。登录后，如果登录正常，该应用程序会再次将您带到`index.gsp`. 我需要这样，如果用户登录，这些按钮就会消失，而是说“你好，[用户名]”。我已经尝试过使用此代码，但它不起作用（它从未登录过）：

在控制器中：

```
def dologin(){

    def user=Usuario.findByUsernameAndPassword(params.username,springSecurityService.encodePassword(params.password) )

    if(user){
        redirect (controller:'usuario', action:'index')
    }else{

        flash.message=message(code:'default.user.not.found', args:[message(code: 'params.username', default:'Usuario'), params.id])
    def userlogged = springSecurityService.getCurrentUser()
                render view: 'index', model: [user: user]
}

} 
```

在 index.gsp 中（不完整，只有重要的部分）：

```
<sec:ifNotLoggedIn>

<div id="buttons">
    <div id="login"><a href="loginurl">Login</a>
    </div>
    <div id="register"><a href="registerurl">Registrarse</a>
    </div>
</div>
</sec:ifNotLoggedIn>
<sec:ifLoggedIn>

<div id="greet">Hello!</div> 

</sec:ifLoggedIn> 
```

任何帮助，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T15:23:21.057

看起来您是在进行自己的身份验证，而不是通过 spring 安全身份验证过程。该`<sec:ifLoggedIn>`标签依赖于处理身份验证的弹簧安全性。

在 Spring Security 应用程序中处理这种情况的常用方法是将登录请求发布到`/j_spring_security_check`，在幕后，由[UsernamePasswordAuthenticationFilter](http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/web/authentication/UsernamePasswordAuthenticationFilter.html)过滤。

Grails 和 spring 安全插件通过提供一个`LoginController`和`auth.gsp`你可以用作起点的方式使这变得相对轻松。运行`s2-quickstart`脚本（它还创建用户和角色域对象），或者只是从`spring-security-core`模板目录中复制它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-18T06:13:08.507

我简单地试了一下

```
<sec:ifNotLoggedIn> // DO SOMTHING</sec:ifNotLoggedIn>
<sec:ifLoggedIn> // DO SOMTHING</sec:ifNotLoggedIn> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T07:58:57.467

终于干脆做到了

```
<g:if test="${session.user==null}">
<!-- Display buttons-->
</g:if>
<g:if test=${session.user!=null">
    <div id="greet"> Hello, ${session.user.username}!</div>
</g:if> 
```

更容易，我想。但是，谢谢你的回答，ataylor。

# ruby-on-rails - 即时通讯实现？

> ID：11563291
> 
> 赞同：2
> 
> 时间：2012-07-19T14:43:00.250
> 
> 标签：ruby-on-rails, web, instant-messaging

我想使用 Ruby on Rails 构建一个即时消息传递应用程序，但我对实现感到困惑。

IM 应用程序（如 Facebook 上的应用程序）通常是如何实现的？我认为我们可以使用推送服务器（服务器推送到客户端）或轮询（客户端询问服务器），但还有其他方法吗？这两种方法的相应优势是什么？哪一个通常更高效且要求更低？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-03-15T06:32:15.777

1.  轮询：在轮询的情况下，浏览器会定期向服务器发出请求以检查更新。它会增加你的服务器负载。

2.  服务器发送事件：[服务器发送事件](http://www.html5rocks.com/en/tutorials/eventsource/basics/)。服务器发送的事件从一开始就被设计为高效。使用 SSE 进行通信时，服务器可以随时将数据推送到您的应用程序，而无需发出初始请求。

3.  WebSockets：另一方面，WebSockets 需要全双工连接和新的 Web Socket 服务器来处理协议。

对于 IM 最适合的是 websocket，因为使用 websocket 您可以进行双向通信。

使用 websocket 的 IM 的一个类似示例是[Applozic](https://github.com/AppLozic/Applozic-Web-Plugin)聊天 SDK。它使用网络套接字进行实时消息传递。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:24:31.840

我不知道 Facebook 是如何实现他们的 IM 服务的，但大多数基于 Web 的 IM 客户端要么使用推送服务器，要么使用 Jabber 客户端。如果您希望用户能够通过他们自己的 IM 客户端（而不仅仅是通过 Web 前端）与服务进行通信，那么 Jabber 是很好的选择；如果您正在对服务器端收到的消息做一些有趣的事情，那么 push 很好。如今，轮询在任何地方都没有广泛使用。它需要与服务器推送相同的 JavaScript 支持，但对您的服务器来说资源密集度更高。

对于 push 入门，我建议您研究[Faye](http://faye.jcoglan.com/)或[Juggernaut](https://github.com/maccman/juggernaut/)。

如果您对 Jabber 选项感兴趣，请查看[JavaScript Jabber 客户端库](https://github.com/sstrigler/JSJaC/)。

# python - 逐帧可视化 3D-numpy-array

> ID：11563295
> 
> 赞同：7
> 
> 时间：2012-07-19T14:43:04.497
> 
> 标签：python, numpy, matplotlib, data-visualization

```
# -*- coding: utf-8 -*-
"""
slider 3D numpy array

"""

import numpy
import pylab
from matplotlib.widgets import Slider

data = numpy.random.rand(100,256,256) #3d-array with 100 frames 256x256

ax = pylab.subplot(111)
pylab.subplots_adjust(left=0.25, bottom=0.25)

frame = 0
l = pylab.imshow(data[frame,:,:]) #shows 256x256 image, i.e. 0th frame

axcolor = 'lightgoldenrodyellow'
axframe = pylab.axes([0.25, 0.1, 0.65, 0.03], axisbg=axcolor)
sframe = Slider(axframe, 'Frame', 0, 100, valinit=0)

def update(val):
    frame = numpy.around(sframe.val)
    pylab.subplot(111)
    pylab.subplots_adjust(left=0.25, bottom=0.25)
    pylab.imshow(data[frame,:,:])

sframe.on_changed(update)

pylab.show() 
```

我有一个 3D-numpy-array，它实际上包含大小为 256x256 的图像。现在我想用一个滑块一个接一个地显示这些帧。它似乎真的很慢。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T14:48:59.007

尝试将更新函数重写为

```
def update(val):
    frame = numpy.around(sframe.val)
    l.set_data(data[frame,:,:]) 
```

这样您就不需要每次更新都重新创建所有 matplotlib 对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-31T12:14:27.577

似乎您需要将帧号转换为 int

```
def update(val):
    frame = numpy.around(sframe.val)
    l.set_data(data[int(frame),:,:]) 
```

否则会抛出错误：

```
l.set_data(data[frame,:,:])
IndexError: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices 
```

# javafx-2 - 如何在运行时使用 Button Click 更改子 fxml gui 部件

> ID：11563298
> 
> 赞同：20
> 
> 时间：2012-07-19T14:43:10.207
> 
> 标签：javafx-2, fxml

我正在尝试为大型复杂 gui 构建骨架，因此想法是在 javafx 2.1 中使用类似 mvc 的样式制作所有内容，因此每个组件都有一个 fxml 文件，如果需要，还有 css、控制器和模型。我试图弄清楚如何更改子场景（运行时的子 fxml）。有人知道怎么做吗？我有点坚持这一点。可能是蜜蜂添加MainViewController？场景：用户点击任务栏中的按钮，包含的 content1.fxml 将被替换为 content2.fxml

这里是基本代码

**主应用程序.java**

```
Loads the MainView.fxml 
```

**主视图.fxml**

```
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

 <BorderPane xmlns:fx="http://javafx.com/fxml">
<center>
    <fx:include source="Content1.fxml"/>
</center>

<bottom>
    <fx:include source="TaskBar.fxml"/>
</bottom>

</BorderPane> 
```

**内容1.fxml**

```
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<StackPane xmlns:fx="http://javafx.com/fxml" fx:id="content1">
    <Label text="Hallo Java FX 2.1.1 Content1.fxml"/>
</StackPane> 
```

**内容2.fxml**

```
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<StackPane xmlns:fx="http://javafx.com/fxml" fx:id="content2">
    <Label text="Hallo Java FX 2.1.1 Content2.fxml"/>
</StackPane> 
```

**任务栏.fxml**

```
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<HBox xmlns:fx="http://javafx.com/fxml" spacing="10" alignment="center" 
     fx:id="taskBar" fx:controller="TaskBarController">
    <children>
        <Button fx:id="taskBarButton1" onAction="#handleTaskBarButton1Action"/>     
        <Button fx:id="taskBarButton2" onAction="#handleTaskBarButton2Action"/> 
    </children>
</HBox> 
```

**任务栏控制器.java**

```
import java.net.URL;
import java.util.ResourceBundle;

import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.fxml.Initializable;
import javafx.scene.control.Button;

public class TaskBarController implements Initializable {

// Binding with the FXML
@FXML
private Button taskBarButton1;

@FXML
private Button taskBarButton2;

@FXML
private void handleTaskBarButton1Action(ActionEvent event) {
    System.out.println("click! taskBarButton1");
}

@FXML
private void handleTaskBarButton2Action(ActionEvent event) {
    System.out.println("click! taskBarButton2");
}

@Override
public void initialize(URL location, ResourceBundle resources) {
    // TODO Auto-generated method stub

}

} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-19T16:53:29.403

不要只包含 fxml，为此创建一个业务逻辑层：

```
<BorderPane xmlns:fx="http://javafx.com/fxml">
<center>
    <Pane fx:id="content"/>
</center> 
```

并在按钮单击处理程序中更新它：

```
@FXML
private void handleTaskBarButton2Action(ActionEvent event) {
   System.out.println("click! taskBarButton2");
   content.getChildren().clear();
   content.getChildren().add(FXMLLoader.load(getClass().getResource("Content2.fxml"));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-22T18:07:22.323

它可以工作，谢谢帮助，但我被迫删除 TaskBar.fxml 和 TaskBarController.java ，编写了一个带有 @FXML 句柄的 MainViewController 和带有 fx:id="content" 的按钮和窗格的 @FXML ，然后把我的MainView.fxml 中的海关按钮

```
@FXML
private void handleTaskBarButton2Action(ActionEvent event) throws IOException {
    System.out.println("click! taskBarButton2");
    content.getChildren().clear();
    content.getChildren().add((Node) FXMLLoader.load(getClass().getResource("Content2.fxml")));
} 
```

# cuda - 推力与 CUDPP

> ID：11563301
> 
> 赞同：5
> 
> 时间：2012-07-19T14:43:21.080
> 
> 标签：cuda, thrust, cudpp

为了在带有 CUDA 的 GPU 上使用数据并行算法，有两个标准库，CUDPP 和 Thrust，它们实现了排序、归约、前缀和等。

那么库之间在性能和功能方面的主要区别是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T08:02:52.070

大约一年前，我使用过排序和前缀总和（使用 CUDA 4.1，但我不记得 Thrust 和 CUDPP 的版本），我体验到 CUDPP 快一点但 Thrust 更易于使用（使用 float -array 大约有 20M 个条目）。

至于功能，据我所知，您还可以将 Thrust 与主机内存一起使用，不仅与设备内存一起使用（与 CUDPP 相反），但这可能已经过时了。

# python - 子进程无法从其他进程获取标准输入

> ID：11563303
> 
> 赞同：1
> 
> 时间：2012-07-19T14:43:21.200
> 
> 标签：python, multiprocessing, subprocess

我`subprocess`在两个进程之间使用交换数据

我编辑一个`repeat.py`文件：

此文件是来自[http://www.doughellmann.com/PyMOTW/subprocess/的示例](http://www.doughellmann.com/PyMOTW/subprocess/)

```
import sys

sys.stderr.write('repeater.py: starting\n')
sys.stderr.flush()

while True:
    next_line = sys.stdin.readline()
    if not next_line:
        break
    sys.stdout.write(next_line)
    sys.stdout.flush()

sys.stderr.write('repeater.py: exiting\n')
sys.stderr.flush() 
```

并在其中运行此文件`ipython`

```
In [1]: import subprocess

In [2]:      f=subprocess.Popen(['python','~/repeat.py'],shell=True,stdin=subprocess.PIPE,stdout=subprocess.PIPE)

In [3]: f.stdin.write('teststs\n')

In [4]: f.communicate()
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
NameError: name 'teststs' is not defined
Out[4]: ('', None) 
```

为什么`teststs`没有定义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:54:03.057

您似乎正在启动交互式 Python 会话，而不是运行`repeat.py`. 尝试删除`shell=True`，它与参数列表一起没有意义。（`shell=True`顺便说一句，使用几乎总是一个坏主意。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-08-25T12:17:21.097

这适用于前 5 次按键的一些奇怪行为。我不知道为什么。之后，如果工作正常，并且当按下 UP 时我们可以访问之前的命令`ls -l`，`cd`似乎命令行具有完整的功能。

```
#!/bin/python3

import subprocess
import sys

proc = subprocess.Popen(['bash'])
while True:
    buff = sys.stdin.readline()
    stdoutdata, stderrdata = proc.communicate(buff)
    if( stdoutdata ):
        print( stdoutdata )
    else:
        print('n')
        break 
```

[这](https://stackoverflow.com/questions/39140632/transparent-interaction-with-console-sh-bash-cmd-powershell)是我的类似问题。

# objective-c - iphon4 的 cocos2d 中的 Touch Move Method 问题

> ID：11563304
> 
> 赞同：0
> 
> 时间：2012-07-19T14:43:24.860
> 
> 标签：objective-c, ios5, cocos2d-iphone

我正在开发一款通用益智游戏，其中我为 iphone4 和 iphone3 使用了单独的图像，iphone4 图像的大小是 iphone3 图像的两倍。我的问题是 iphone4，iphone4 图像的触摸区域是双倍尺寸，假设我的 iphone4 图像尺寸是 20*40，iphone3 是 10*20，问题是 iphone4 图像的触摸区域是 40*80 i不知道它是如何发生的，我在我的代码中解决了这个问题，但我没有得到这个问题的任何解决方案，在 iphone3 中触摸工作正常，在精灵矩形中使用。

你能帮我解决这个问题还是告诉我我忘记为iphone4触摸编码什么，以便它在精灵（图像）矩形中触摸

预先感谢。这是我的代码：

```
 `-(void)ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
     {

    UITouch *touch = [touches anyObject];
    touchLocation = [touch locationInView: [touch view]];
   touchLocation = [[CCDirector sharedDirector] convertToGL:touchLocation];
    touchLocation = [self convertTouchToNodeSpace:touch];
    NSLog(@"touch location x = %f , y =%f",touchLocation.x,touchLocation.y);
   CCSprite * sp= [CCSprite spriteWithFile:@"1.png"];
   sp.position = ccp(touchLocation.x ,touchLocation.y);
   // [self addChild:sp z:100];
   CGRect myrec = [invisible[0] boundingBox];
   if (CGRectContainsPoint(myrec, touchLocation) ) {
    NSLog(@"oneeeeeeee");

   }

   [self selectSpriteForTouch:touchLocation];      
   // return TRUE; 

   }

   - (void)panForTranslation:(CGPoint)translation {    
    if (selSprite) {

    CGPoint newPos = ccpAdd(selSprite.position, translation);
    selSprite.position = newPos;

  } 

     }

  - (void)ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {   
    UITouch *touch = [touches anyObject];
    Location = [touch locationInView: [touch view]];
    Location = [[CCDirector sharedDirector] convertToGL:Location];
    Location = [self convertTouchToNodeSpace:touch];
    NSLog(@"touch moved location x = %f , y =%f",Location.x,Location.y);

  //touchLocation = [self convertTouchToNodeSpace:touch];

   CGPoint oldTouchLocation = [touch previousLocationInView:touch.view];
    oldTouchLocation = [[CCDirector sharedDirector] convertToGL:oldTouchLocation];
    oldTouchLocation = [self convertToNodeSpace:oldTouchLocation];
    CGPoint translation = ccpSub(Location, oldTouchLocation); 

   if (CGRectContainsPoint(selspriterect,Location)) 

   {
    [self panForTranslation:translation];
    }

   if ([[UIScreen mainScreen] respondsToSelector:@selector(scale)]) 
 {
    NSLog(@"respond to selector");

    CGFloat scale = [[UIScreen mainScreen] scale];

    if (scale > 1.0) 
    {
        NSLog(@"iphone 4s");
        CGPoint mypoint = CGPointMake(80, 357);
        CGPoint mypoint1 = CGPointMake(237, 360);
        CGPoint mypoint2 = CGPointMake(79, 255);
        CGPoint mypoint3 = CGPointMake(237, 247);
        CGPoint mypoint4 = CGPointMake(78, 153);
        CGPoint mypoint5 = CGPointMake(239, 140);

        CCSprite *disablesprite=nil;
        switch (selSprite.tag) {
            case 0:
                if (CGRectContainsPoint( [dest[0] boundingBox] , mypoint ) ) {
                    NSLog(@"oneeeeee collided");
                    dest[0].position =  ccp(192,380);
                    // selSprite = disablesprite;
                }
                break;
            case 1:
                if (CGRectContainsPoint( [dest[1] boundingBox] , mypoint1 ) ) {
                    NSLog(@"two collided");
                    dest[1].position =  ccp(258,379);

                }
                break;
            case 2:
                if (CGRectContainsPoint( [dest[2] boundingBox] , mypoint2 ) ) {
                    NSLog(@"three collided");
                    dest[2].position =  ccp(173,281);
                }
                break;
            case 3:
                if (CGRectContainsPoint( [dest[3] boundingBox] , mypoint3 ) ) {
                    NSLog(@"four collided");
                    dest[3].position = ccp(258,281);

                }
                break;
            case 4:
                if (CGRectContainsPoint( [dest[4] boundingBox] , mypoint4 ) ) {
                    NSLog(@"five collided");
                    dest[4].position =   ccp(166,181);
                }
                break;
            case 5:
                if (CGRectContainsPoint( [dest[5] boundingBox] , mypoint5 ) ) {
                    NSLog(@"six collided");
                    dest[5].position =  ccp(258,176);

                }
                break;
            default:
                break;
        }

    }
    else {

   CGPoint mypoint = CGPointMake(106, 329);
   CGPoint mypoint1 = CGPointMake(208, 329);
   CGPoint mypoint2 = CGPointMake(97, 220);
   CGPoint mypoint3 = CGPointMake(217, 220);
   CGPoint mypoint4 = CGPointMake(92, 124);
   CGPoint mypoint5 = CGPointMake(212, 124);

  CCSprite *disablesprite=nil;
  switch (selSprite.tag) {
    case 0:
        if (CGRectContainsPoint( [dest[0] boundingBox] , mypoint ) ) {
            NSLog(@"oneeeeee collided");
            dest[0].position =  ccp(125,320);
            // selSprite = disablesprite;
        }
        break;
    case 1:
        if (CGRectContainsPoint( [dest[1] boundingBox] , mypoint1 ) ) {
            NSLog(@"two collided");
            dest[1].position =  ccp(200,312);

        }
        break;
    case 2:
        if (CGRectContainsPoint( [dest[2] boundingBox] , mypoint2 ) ) {
            NSLog(@"three collided");
            dest[2].position =  ccp(117,209);
        }
        break;
    case 3:
        if (CGRectContainsPoint( [dest[3] boundingBox] , mypoint3 ) ) {
            NSLog(@"four collided");
            dest[3].position =  ccp(200,208);

        }
        break;
    case 4:
        if (CGRectContainsPoint( [dest[4] boundingBox] , mypoint4 ) ) {
            NSLog(@"five collided");
            dest[4].position =  ccp(113,127);
        }
        break;
    case 5:
        if (CGRectContainsPoint( [dest[5] boundingBox] , mypoint5 ) ) {
            NSLog(@"six collided");
            dest[5].position =  ccp(207,126);

        }
        break;
    default:
        break;
  }
    }
  }

  }   
  -(void)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{
  CGPoint mypoint = CGPointMake(106, 329);
  CGPoint mypoint1 = CGPointMake(208, 329);
  CGPoint mypoint2 = CGPointMake(97, 220);
  CGPoint mypoint3 = CGPointMake(217, 220);
  CGPoint mypoint4 = CGPointMake(92, 124);
  CGPoint mypoint5 = CGPointMake(212, 124);
  switch (selSprite.tag) {
    case 0:
        if (CGRectContainsPoint( [dest[0] boundingBox] , mypoint ) ) {
            NSLog(@"oneeeeee collided");
            if (corsprite == TRUE) {
                correctplace++;
                corsprite = FALSE;
            }
        }else {
            selSprite.position = ccp(110,50);
        }
        break;
    case 1:
        if (CGRectContainsPoint( [dest[1] boundingBox] , mypoint1 ) ) {
            NSLog(@"two collided");
            if (corsprite2 == TRUE) {
                correctplace++;
                corsprite2 = FALSE;
            }
        }else {
            selSprite.position = ccp(110, 65);
        }
        break;
    case 2:
        if (CGRectContainsPoint( [dest[2] boundingBox] , mypoint2 ) ) {
            NSLog(@"three collided");
            if (corsprite3 == TRUE) {
                correctplace++;
                corsprite3 = FALSE;
            }
        }else {
            selSprite.position =ccp(130, 10);
        }
        break;
    case 3:
        if (CGRectContainsPoint( [dest[3] boundingBox] , mypoint3 ) ) {
            NSLog(@"four collided");
            if (corsprite4 == TRUE) {
                correctplace++;
                corsprite4 = FALSE;
            }
        }else {
            selSprite.position = ccp(215, 10);
        }
        break;
    case 4:
        if (CGRectContainsPoint( [dest[4] boundingBox] , mypoint4 ) ) {
            NSLog(@"five collided");
            if (corsprite5 == TRUE) {
                correctplace++;
                corsprite5 = FALSE;
            }
        }else {
            selSprite.position = ccp(220,70);
        }
        break;
    case 5:
        if (CGRectContainsPoint( [dest[5] boundingBox] , mypoint5 ) ) {
            NSLog(@"six collided");
            if (corsprite6 == TRUE) {
                correctplace++;
                corsprite6 = FALSE;
            }           
        }else {
            selSprite.position = ccp(220,70);
        }
        break;
    default:
        break;
  } 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:51:27.043

在您的应用委托中执行此操作

```
[director enableRetinaDisplay:YES]; 
```

并确保您的图像符合惯例。
例如对于 iPhone3 假设你有图像，`image.png`
那么你的视网膜图像必须是`image-hd.png`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T02:06:14.793

好吧，一切都应该是重点，例如，我认为您不需要围绕 UIScreen 缩放属性的逻辑，并且您的 scale=1 逻辑应该在视网膜和非视网膜显示器上相同地工作。

快速尝试：将 scale > 1.0 更改为 scale > 3.0 （if 应该始终分支到 else 部分，您在 iPhone 3 上声明“有效”），只是为了看看这是否正确。如果是，请完全删除围绕比例的逻辑并进行清理:) ...在我的代码中，我没有一个合法的案例来确定比例是 1.0 还是其他。

# c# - 为什么不能禁用 datetime 所需的属性 MVC 模型？

> ID：11563305
> 
> 赞同：0
> 
> 时间：2012-07-19T14:43:25.293
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, data-annotations

一切都很好这个模型：

```
[Range(1, 24, ErrorMessage = "Invalid Hour")]
public int? val1{ get; set; } 
```

另一方面; 这将返回无效错误。如果我不在 EndDateTime 中写入任何值：

```
public DateTime? EndDateTime { get; set; } 
```

控制器：

```
if (!ModelState.IsValid)
    return View(myinstance); 
```

返回无效的结束日期时间但我给出了可为空的值属性。我在 enddatetime 上给出了空值，但返回给我无效的 enddatetime 错误。如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:52:37.980

数据库是否接受空值并不重要。如果值未通过验证，则 ModelState 将不会返回有效。添加将通过验证的默认值。

# java - 我可以在 Java 中更改 jpg 图像的分辨率吗？

> ID：11563307
> 
> 赞同：5
> 
> 时间：2012-07-19T14:43:27.477
> 
> 标签：java, jpeg, image-resizing

我在面板中显示了一些 .jpg。不幸的是，它们都是大约 1500x1125 像素，这对于我想要的东西来说太大了。是否有编程方式来更改这些 .jpg 的分辨率？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:00:15.990

`Graphics2D`您可以使用方法（从）缩放图像`java.awt`。[mkyong.com 上](http://www.mkyong.com/java/how-to-resize-an-image-in-java/)的本教程对其进行了深入解释。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T14:49:51.180

将其加载为 ImageIcon 就可以了：

```
import java.awt.Graphics2D;
import java.awt.image.BufferedImage;
import javax.swing.ImageIcon;

public static ImageIcon resizeImageIcon( ImageIcon imageIcon , Integer width , Integer height )
{
    BufferedImage bufferedImage = new BufferedImage( width , height , BufferedImage.TRANSLUCENT );

    Graphics2D graphics2D = bufferedImage.createGraphics();
    graphics2D.drawImage( imageIcon.getImage() , 0 , 0 , width , height , null );
    graphics2D.dispose();

    return new ImageIcon( bufferedImage , imageIcon.getDescription() );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T14:50:02.973

你可以试试：

```
private BufferedImage getScaledImage(Image srcImg, int w, int h) {
    BufferedImage resizedImg = new BufferedImage(w, h, Transparency.TRANSLUCENT);
    Graphics2D g2 = resizedImg.createGraphics();
    g2.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
    g2.drawImage(srcImg, 0, 0, w, h, null);
    g2.dispose();
    return resizedImg;
} 
```

# rest - 每个 API 调用检索的最大网络更新数

> ID：11563313
> 
> 赞同：1
> 
> 时间：2012-07-19T14:43:57.243
> 
> 标签：rest, linkedin

对使用网络更新 API 的一次调用检索的条目数量是否有任何限制？我发现这个论坛评论“每个用户的限制是每次通话，所以 300 个请求，无论他们有多少更新。” 在线程上

[http://developer.linkedin.com/forum/increase-search-api-throttle-limit](http://developer.linkedin.com/forum/increase-search-api-throttle-limit)

我想确认确实没有限制。我在一个电话中收到了多达 106 个条目。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:44:27.903

从[网络更新 API](https://developer.linkedin.com/documents/get-network-updates-and-statistics-api)返回的最大更新数似乎是 250。执行以下查询作为示例：

[http://api.linkedin.com/v1/people/~/network/updates?count=500](http://api.linkedin.com/v1/people/~/network/updates?count=500)

即使我尝试将`start`参数指定为 250，我也无法从 API 获取下一个 250 更新：

[http://api.linkedin.com/v1/people/~/network/updates?count=250&start=250](http://api.linkedin.com/v1/people/~/network/updates?count=250&start=250)

因此，看起来 250 是最大值，无法翻页。

更新：

已验证 250 是返回的最大数量，无论是在单个调用中还是通过分页参数。看起来文档已更新以反映这一点。

# javascript - JavaScript，如何将变量解析为命令？

> ID：11563317
> 
> 赞同：0
> 
> 时间：2012-07-19T14:44:06.597
> 
> 标签：javascript, parsing, variables, command

我想要做的是在`for()`. 现在它看起来像这样，但据我所知，你不能从这样的变量运行命令，我不能运行， (eg) `cab_type_value = "whatever"`。我也不能跑`road_load_enabled`；它只是行不通。有谁可以做到这一点？如何解析我的`J`var `document.MyForm.InputName.disabled`？

```
for( var j=1; j<=14; j++ ) {
    var cab_type_value = "document.exe_mode_form.cab_type" + j + ".value";
    var cab_type_checked = "document.exe_mode_form.cab_type" + j + ".checked == 1";

    for( var i=1; i<=document.exe_mode_form.road_load_number.value; i++ ) {
        var road_load_value = "document.exe_mode_form.load" + i + ".value";
        var road_load_enabled = "document.exe_mode_form.load" + i + ".disabled = false";
        var road_load_disabled = "document.exe_mode_form.load" + i + ".disabled = true";
        var rld_db = "document.exe_mode_form.a" + i + "_a1.value";

        if ( cab_type_checked ) {
            if ( test == 1 ) {
                if(road_load_disabled) {
                    alert("road_load_disabled");
                    road_load_enabled;
                }
                test = 2;
            }

            if(cab_type_value == rld_db) {
                if(olof == 1) {
                    alert("cab_type_value  == rld_db");
                    olof = 2;
                }

                road_load_enabled;
            }
        }
    }
} 
```

此外，这部分不起作用：

```
if(cab_type_value == rld_db) {
    if(olof == 1){
        alert("cab_type_value  == rld_db");
        olof = 2;
    }

    road_load_enabled;
} 
```

我已经检查过，与 .`cab_type_value`具有相同的值`rld_db`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:00:34.600

尝试更改这些行：

```
var cab_type_value = "document.exe_mode_form.cab_type" + j + ".value"; 
```

至：

```
var cab_type_value = document.exe_mode_form['cab_type' + j].value; 
```

同样的逻辑也适用于函数调用：

```
someVariable = 'alert';
window[someVariable]('Foo!');//alerts foo 
```

如果你的函数没有在全局范围内声明，你可以`window`用任何命名空间对象替换：`foobarObject.orEven.nestedOnes[someVariable]();`
最后，因为我个人讨厌这个`window`关键字（它是一个循环引用），你可以简单地选择`this['alert']('foo');`在常规函数调用或全局中使用范围。`this`指向其调用的上下文，在这些情况下是全局对象

# git - git rebase 基础知识

> ID：11563319
> 
> 赞同：75
> 
> 时间：2012-07-19T14:44:09.173
> 
> 标签：git, git-rebase

我`git rebase`最近开始使用，并不能 100% 确定我做得对。为了这个问题，在 origin 有两个分支，`master`和`next`，从 分支出来`master`。

自两者之间上次同步以来，`master`有 2 次提交和`next`6 次：

```
$ git log --oneline origin/next..origin/master
59b5552 master commit #2
485a811 master commit #1

$ git log --oneline origin/master..origin/next
4ebf401 next commit #6
e9b6586 next commit #5
197ada0 next commit #4
4a2c3c6 next commit #3
040a055 next commit #2
84537bf next commit #1 
```

当我结帐`next`并执行`git rebase -i origin/master`时，我得到以下信息：

```
$ git status
# On branch next
# Your branch and 'origin/next' have diverged,
# and have 8 and 6 different commits each, respectively. 
```

最后在完成之后`git pull --rebase`，来自的两个提交`master`在`next`：

```
$ git log --oneline origin/next..next 
8741d09 master commit #2
485a811 master commit #1 
```

问题：

1.  这是正确的方法吗？
2.  为什么在运行之前会有`8 and 6`不同的提交`pull --rebase`？
3.  是否可以简化流程？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-07-19T17:48:47.137

让我们从头开始。这是您原始状态的图表：

```
ABC（主，原点/主）
 \
  DEFGHI（下一个，原点/下一个）

```

当您签出`next`并重新设置为基础时，它`next`在`origin/master`两个已经打开的提交之后创建了 6 个新提交`origin/master`。这些新提交将“主提交 #2”（`C`在我的图表中）作为它们的祖先，而不是它们的原始祖先在哪里`origin/master`和`origin/next`分歧（`A`在我的图表中），因此它们的哈希值会有所不同。我相信这就是为什么你会看到它`next`有 8 个不同的提交 from `origin/next`： 2 from`origin/master`和 6 个“rehashed”提交 on `origin/next`。

之后`git checkout next ; git rebase -i origin/master`，你应该有这个：

```
ABC（主，原点/主）
 \ \
  \D'-E'-F'-G'-H'-I'（下）
   \
    DEFGHI（原点/下一个）

```

您可以看到`next`确实有 8 个未提交的提交`origin/next`，并且`origin/next`确实有 6 个未提交的提交`next`。当然，这只是根据提交的 SHA-1 哈希值。如果您，实际内容应该非常匹配`git diff origin/next next`——差异应该只显示来自`B`和的更改`C`（如图所示）。

当您`git pull --rebase`仍在 on时执行此操作时`next`，它会从源（远程`origin/next`）获取更改并将当前分支（`next`）重新定位到该远程。这会导致在新分支之后出现`next`但*不在*其中的更改。它应该如下所示：`origin/next``origin/next``next`

```
ABC（主，原点/主）
 \
  DEFGHI（原点/下一个）
             \
              B'-C'（下一个）

```

如果这是您希望历史图表的样子，那么您就成功了。

但是，我怀疑您真的希望事情看起来像中间图，特别是如果`next`您正在处理项目的下一部分并且`master`用于稳定代码和小错误修复的功能分支。如果是这样，那么您应该这样做`git push`而不是`git pull --rebase`让遥控器反映您的历史版本，而不是相反。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-26T10:37:57.600

从使用 master 重新定位分支的非常简单的步骤开始；姓名;

```
git-rebase 
```

概要;

```
git rebase [-i | --interactive] [options] [--exec <cmd>] [--onto <newbase>]
        [<upstream>] [<branch>]
git rebase [-i | --interactive] [options] [--exec <cmd>] [--onto <newbase>]
        --root [<branch>]
git rebase --continue | --skip | --abort | --edit-todo 
```

描述; 假设存在以下历史并且当前分支是“sample”：

```
 A---B---C sample
         /
    D---E---F---G master 
```

从这一点来看，以下任一命令的结果：

```
git rebase master
git rebase master sample 
```

将会：

```
A'--B'--C' sample
                 /
    D---E---F---G master 
```

**注意**`git checkout sample`：后一种形式只是 . 的简写形式`git rebase master`。当 rebase 退出时，sample 将保留已签出的分支。

如果上游分支已经包含您所做的更改（例如，因为您邮寄了一个应用于上游的补丁），那么该提交将被跳过。例如，在以下历史记录上运行“git rebase master”（其中 A 和 A 引入了相同的更改集，但具有不同的提交者信息）：

```
A---B---C sample
         /
    D---E---A'---F master 
```

将导致：

```
 B'---C' sample
              /
D---E---A'---F master 
```

所有这些都是对变基过程的图解理解。一旦解决了键入后发现的冲突，请`git rebase master` 解决冲突并键入`git add -u`以将更改的代码添加到存储库。之后执行命令`git rebase --continue`并继续解决冲突并重复命令；

```
git add -u 
```

和

```
git rebase --continue 
```

直到没有发现冲突。最后的命令将是，

```
git push --force origin sample(your branch name) 
```

# c# - 收藏已修改；枚举操作可能无法执行

> ID：11563330
> 
> 赞同：1
> 
> 时间：2012-07-19T14:44:38.687
> 
> 标签：c#, wpf, tabcontrol, tabitem

我的 TabControl 中有多个 TabItem；tabItem1, tabItem2, tabItem3...这些是

CloseableTabItem。

如果我在 tabItem1 中添加一个节点并按下按钮为该节点创建一个 subGraph 模型，则

相同的节点应该出现在 tabItem2 中并带有一个按钮；以便

tabItem2-Header = nodeName 和 nodeName = tabItem1-Header。

如果我从 tabitem2 中的节点按下按钮，tabitem1 应该被聚焦。如果我关闭

tabItem1 并按下相同的按钮 tabItem1 应该再次加载（这发生在

SubGraphButton_Click)。

你看到这段代码有问题吗？

```
 private void ChildNode_Click(object sender, RoutedEventArgs args)
  {
        System.Windows.Controls.Button button = (System.Windows.Controls.Button)sender;
        Node node = Part.FindAncestor<Node>(button);
        MyNodeData nodeData = node.Data as MyNodeData;
        foreach (TabItem item in tabControl.Items)
        {
            if (nodeData.Text == item.Header.ToString())
            {
                item.Focus();
            }
            else if (nodeData.Text != item.Header.ToString())
            {
                SubGraphButton_Click(sender, args);
            }
        }
 }
 private void SubGraphButton_Click(object sender, RoutedEventArgs args)
 {
        string activeDirectory = @"X:\SubGraph\";
        string[] files = Directory.GetFiles(activeDirectory);
        foreach (string fileName in files)
        {
            FileStream file = new FileStream(fileName, FileMode.Open, FileAccess.Read, FileShare.Read);
            System.Windows.Controls.Button button = (System.Windows.Controls.Button)sender;
            Node node = Part.FindAncestor<Node>(button);
            MyNodeData nodeData = node.Data as MyNodeData;
            if (node != null)
            {
                if (nodeData.Text + ".epk" == fileName.Substring(12, fileName.Length - 12) && !tabControl.Items.Contains(tabItem1))
                {
                    tabControl.Items.Add(tabItem1);
                    tabItem1.Focus();
                    var model = new MyGraphLinksModel();
                    model.Modifiable = true;
                    model.HasUndoManager = true;
                    activateDiagram(myDiagram1);
                    activeDiagram.Model = model;
                    model.Name = fileName.Substring(12, fileName.Length - 12);
                    model.Name = model.Name.Substring(0, model.Name.Length - 4);
                    tabItem1.Header = model.Name;
                    activeDiagram.PartManager.UpdatesRouteDataPoints = false;
                    StreamReader reader = new StreamReader(file);
                    string contents = reader.ReadToEnd();
                    XElement root = XElement.Parse(contents);
                    activeDiagram.LayoutCompleted += LoadLinkRoutes;
                    model.Load<MyNodeData, MyLinkData>(root, "MyNodeData",   "MyLinkData");
                }
           }
  } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T14:49:01.233

当您在修改集合的过程中修改集合时，很可能会导致错误。错误的类型及其可能性往往会根据底层集合的实际情况而有所不同。在迭代时修改 a`List`很可能会给你一个错误（或者如果你修改它很多）和可能超出范围的错误。修改 a`LinkedList`可能会导致空指针异常、无限循环、访问不存在的项目等，但可能性要小得多。

因为在一般情况下，出现问题的可能性相当高，这些问题的影响也相当高，并且很难诊断实际出了什么问题（以及在哪里）C# 选择在尝试迭代时抛出异常在迭代期间修改的集合。这样你就不会遇到奇怪的、意想不到的问题，这些问题要等到更远的地方才会出现，然后再出现根本原因。

有几种不同的策略可用于避免此问题：

1.  迭代与您真正想要修改的集合不同的集合。在某些情况下，这可以简单地通过`ToList`在序列上添加调用来完成，以便将其移动到新集合中；这样做时，被迭代的集合与被修改的集合是分开的，因此没有错误。

2.  您可以避免修改`foreach`循环内的实际集合。这方面的常见示例是创建一个`List`或其他“要进行的更改”集合，无论它是`itemsToAdd`等`itemsToRemove`。然后您可以在循环之后为所有这些项目添加/删除/任何内容。（如果您只修改集合大小的一小部分，这很有效。）

3.  某些类型的集合可以在不实际使用传统迭代器（即`foreach`循环）的情况下“迭代”。例如，您可以`List`使用常规`for`循环来迭代 a，并在添加或删除项目时简单地修改（递增/递减）循环变量。如果做得正确，这往往是一个有效的选择，但很容易犯错误和出错，所以虽然其他选项（略微）效率较低，但它们对于非性能密集型代码来说是非常好的选择，因为他们的简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T14:48:18.113

你不能修改你正在迭代的集合。

您可以用简单的“for”循环替换“foreach”循环，但请注意在从集合中添加/删除项目时正在运行的索引。

像这样：

```
 for (int i = 0; i < tabControl.Items.Count; i++)
        {
            TabItem item = tabControl.Items[i];
            ... // your logic here
        } 
```

另一个可能方便的选项是将项目添加到选项卡控件中，而不是将项目添加到选项卡控件中。项目集合将其作为返回值，将它们保存在列表中，在完成所有项目的迭代后，插入所有选项卡创建到 items 集合中，因此您在运行集合时不会修改集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T14:48:09.107

`tabControl.Items`在枚举集合（在循环中进行）时，不允许修改集合（在这种情况下），`foreach`因为它会使枚举器无效。

导致错误的特定代码行可能是

```
// In SubGraphButton_Click
// This line of code is called inside an enumeration of tabControl.Items
// This is not permitted!
tabControl.Items.Add(tabItem1); 
```

从概念上讲，您的代码如下所示：

```
private void ChildNode_Click(object sender, RoutedEventArgs args)
{
    System.Windows.Controls.Button button = (System.Windows.Controls.Button)sender;
    Node node = Part.FindAncestor<Node>(button);
    MyNodeData nodeData = node.Data as MyNodeData;
    foreach (TabItem item in tabControl.Items)
    {
        if (nodeData.Text == item.Header.ToString())
        {
            item.Focus();
        }
        else if (nodeData.Text != item.Header.ToString())
        {
            // This line will throw an exception 
            DoSomethingThatModifiesTabControlItemsCollection()
        }
    }
 } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T14:48:26.213

在 foreach 循环中，您调用 SubGraphButton_Click 依次添加一个新节点`tabControl.Items.Add(tabItem1);` 这是不允许的。您可以改用 for 循环。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-19T14:52:07.740

是的，这条线

```
tabControl.Items.Add(tabItem1); 
```

更改您在 NodeClick 中枚举的集合，这
在枚举世界中是不可以的

尝试使用标准 for 循环，但顺序相反......

```
 for( int x = tabControl.Items.Count - 1; x>= 0; x--)
    {  
        TabItem item = tabControl.Items[x];
        if (nodeData.Text == item.Header.ToString())  
        {  
            item.Focus();  
        }  
        else if (nodeData.Text != item.Header.ToString())  
        {  
            SubGraphButton_Click(sender, args);  
        }  
    } 
```

以相反的顺序循环避免检查在 SubGraphButton 中添加的新项目。
我不知道这是否是预期的效果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-19T14:49:01.173

当您对 tabControl 中的 TabItems 进行 ForEach 时，您无法在 ForEach 内执行任何会导致 tabControl 的项目集合更改的任何操作。

这是框架的限制。这是因为您当前正在迭代 TabItems。

所以在您的**ChildNode_Click**函数内部，

在你的 ForEach 内部

```
foreach (TabItem item in tabControl.Items) 
```

你打电话给

```
SubGraphButton_Click(sender, args); 
```

在该函数内部，您调用

```
tabControl.Items.Add(tabItem1); 
```

您不能在 ForEach 中操作 Items 集合。

# ios - UIScrollView 不向下滚动

> ID：11563331
> 
> 赞同：1
> 
> 时间：2012-07-19T14:44:42.017
> 
> 标签：ios, uiscrollview, scroll

我遇到了一个奇怪的问题，`scrollview`不向下滚动，只能向上滚动。我`scrollview`的应用中有，请看我的编码

```
.....

self.scrollView = [[UIScrollView alloc] initWithFrame: CGRectMake(0, 0, 320,427)];

[self.view addSubViews: self.scrollView];

UIView *blueView = [[UIView alloc] initWithFrame: CGRectMake(0, 47, 320, 320)];

blueView.backgroundColor = [UIColor blueColor];

[self.scrollView addSubViews: blueView];

self.scrollView.contentSize = CGSize(320, 640);

.... 
```

我的问题是无论我改变什么值`contentSize`，我`ScrollView`只向上滚动，而不是向下滚动。我希望用户可以`blueView`从原始位置移动到 iPhone 屏幕的顶部或底部。

你有这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:32:05.213

## 问题

看起来您的问题在于您如何`blueView`在`scrollView`. 您正在将框架设置`blueView`为`CGRect` `(0, 47, 320, 320)`. 当你像这样设置框架时，你隐含的一件事是：

> 的上边缘比 的上边缘`blueView`低 47 点`scrollView`。

这是一个完全有效的说法，但这就是导致您描述的问题的原因。 `scrollView`不会向下滚动，因为它被设计为在默认情况下以 rect`(0, 0, 320, 480)`的形式开始。该`contentSize`属性仅指示 中内容的大小`UIScrollView`，而不是其位置。当你设置它时，你基本上是在告诉`scrollView`：

> 从您的内容来源开始，内容为 320 点宽和 640 点高。

因此，`scrollView`不会向上滚动，因为据它所知，坐标上方没有内容`(0, 0)`。

* * *

## 解决方案

您需要采取三个步骤来获得所需的功能。

 ****1.  将 设置为`contentSize`足够大以允许`blueView`一直向上和向下滚动。
2.  放在`blueView`的垂直中心`scrollView`。
3.  滚动`scrollView`，使其最初以 为中心`blueView`。**  ***   将 设置为`contentSize`足够大以允许`blueView`一直向上和向下滚动。

我们要计算`contentSize`属性的正确值。它的类型是`CGSize`，所以我们需要两部分：`width`和`height`。 `width`很简单——因为您似乎不想水平滚动，只需将其设置为屏幕的宽度，`320`. 身高有点棘手。如果您只想`blueView`在*向上*或向下滚动时触摸屏幕的顶部和底部，则需要进行一些数学运算。正确的总高度将是屏幕高度的两倍，减去`blueView`. 所以：

```
scrollView.contentSize = CGSizeMake(320, 480 * 2.0 - blueView.frame.size.height); 
```

*   放在`blueView`的垂直中心`scrollView`。

这很容易; 只需设置`center`blueView 的属性：

```
blueView.center = CGPointMake(160, scrollView.contentSize.height / 2.0); 
```

*   滚动`scrollView`，使其最初以 为中心`blueView`。

如果您查看[Apple UIScrollView 文档](http://developer.apple.com/library/ios/documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/doc/uid/TP40006922-CH3-SW26 "UIScrollView")，您会看到一个实例方法`- (void)scrollRectToVisible:(CGRect)rect animated:(BOOL)animated`。这正是您需要以`scrollView`编程方式滚动的内容。你想要的矩形是以`blueView`iPhone 屏幕大小为中心的矩形。所以：

```
CGRect targetRect = CGRectMake(0, scrollView.contentSize.height / 2.0 - 240,
                               320, 480);
[scrollView scrollRectToVisible:targetRect animated:NO]; 
```

确保您在 中进行此滚动操作`viewWillAppear`，以便在用户看到视图时立即准备好。

应该是这样的。如果您有任何问题，请告诉我！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:06:24.787

scrollView 的内容大小应该是它所持有的视图的大小。代码应该是这样的，试试这样的。

```
self.scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(X, Y, W, H1)];
UIView * blueView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, W, H2)];
self.scrollView .contentSize = blueView.frame.size;
[self.scrollView addSubview:blueView];
[self.view addSubView: self.scrollView]; 
```

感谢莱利。这里，H1 是 UIScrollVIew 的高度，H2 是 blueView 的高度，并且 (H1 < H2)。****

# asp.net - 基于 Session 测试使用不同数据库的类库

> ID：11563332
> 
> 赞同：0
> 
> 时间：2012-07-19T14:44:42.890
> 
> 标签：asp.net, entity-framework, unit-testing, httpcontext

我有一个 ASP.NET 网站项目，直到最近在 App_Code 文件夹中都有所有代码。它使用实体框架 4 作为 ORM。应用程序分为三个“部分”（假设每个客户一个）。每个部分都有自己的数据库（但模式相同）。这是由于性能原因，每个数据库都超过 10GB，有数百万行。

每次`context`创建对象时，都会调用保存部分 ID 的会话变量，并为此上下文选择专有连接字符串。

它看起来像这样（以下是静态`Connection`类的成员）：

```
public static MyEntities GetEntityContext()
{
    if (HttpContext.Current.Session["section"] == null)
    {
        HttpContext.Current.Response.Redirect("~/Login.aspx");
    }
    var context = new MyEntities(GetEntityConnectionStringForSection((int)HttpContext.Current.Session["section"]);
    return context;
}

private static string GetEntityConnectionStringForSection(int section)
{
    switch (section)
    {
        case 1: return ConfigurationManager.ConnectionStrings["entity_1"].ConnectionString;
        case 2: return ConfigurationManager.ConnectionStrings["entity_2"].ConnectionString;
        case 3: return ConfigurationManager.ConnectionStrings["entity_3"].ConnectionString;
        default: return ConfigurationManager.ConnectionStrings["entity_1"].ConnectionString;
    }
} 
```

它工作得非常好，并且还可以处理每次执行任何数据访问时会话超时的情况。

最近，由于我需要在两个网站之间共享 DB 类，我将所有 DB 类移动到单独的类库和引用`System.Web`库中，我知道这是不好的做法，但它正在工作。

现在下一步是包含单元和模块测试，因为我读到`HttpContext`在库中使用这些测试非常困难或不可能，所以我想摆脱`System.Web`引用。这种情况的最佳做法是什么？

我想我不能只是传递`HttpContext`给它，`GetEntityContext()`因为它也是从我的实体类中调用的。尽管这可能可以重构。所以也许这就是我应该去的地方？

我还想知道是否有可能以某种方式将当前部分 ID 传递给整个库？它不能只是静态属性，因为据我了解，它对于所有使用该应用程序的用户来说都是常见的。这应该是用户特定的。

重新假设目标是使自动化测试成为可能，而不会丢失透明的连接字符串选择和会话超时处理。

如果我在这个阶段做错了什么，也请告诉我。我可以在明天早上（世界标准时间上午 8 点）再次查看这个问题，所以在此之前请不要因为我的沉默而气馁。

编辑：

`Connection`库中类的使用示例：

```
public partial class Store
{
    public static List<Store> GetSpecialStores()
    {
        using (var context = Connection.GetEntityContext())
        {
          return context.Stores.Where(qq => qq.Type > 0).OrderBy(qq => qq.Code).ToList();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:59:41.960

`IContextProvider`您可以在库中声明接口并使用它来检索上下文。就像是：

```
public interface IContextProvider
{
   MyEntities GetEntityContext();
} 
```

这将使您的库可测试。在您的 Web 项目中，您可以将`IContextProvider`实现注入到您的库中。

```
public class WebContextProvider : IContextProvider
{
    public MyEntities GetEntityContext()
    {
        if (HttpContext.Current.Session["section"] == null)        
            HttpContext.Current.Response.Redirect("~/Login.aspx");

        int sectionId = (int)HttpContext.Current.Session["section"];
        string connectionString = GetEntityConnectionStringForSection(sectionId);
        var context = new MyEntities(connectionString);
        return context;
    }

   private static string GetEntityConnectionStringForSection(int section)
   {
       switch (section)
       {
          case 1: return ConfigurationManager.ConnectionStrings["entity_1"].ConnectionString;
          case 2: return ConfigurationManager.ConnectionStrings["entity_2"].ConnectionString;
          case 3: return ConfigurationManager.ConnectionStrings["entity_3"].ConnectionString;
          default: return ConfigurationManager.ConnectionStrings["entity_1"].ConnectionString;
       }
   }
} 
```

将此接口注入到存储库或其他数据访问类。

```
public partial class Store
{
    private IContextProvider contextProvider;

    public Store(IContextProvider contextProvider)
    {
        this.contextProvider = contextProvider;
    }

    public List<Store> GetSpecialStores()
    {
        using (var context = contextProvider.GetEntityContext())
        {
          return context.Stores.Where(qq => qq.Type > 0).OrderBy(qq => qq.Code).ToList();
        }
    }
} 
```

# c++ - 如何用opencv检测模糊圆的中心

> ID：11563336
> 
> 赞同：5
> 
> 时间：2012-07-19T14:44:56.950
> 
> 标签：c++, image-processing, opencv

我有以下图像：

![在此处输入图像描述](../Images/1e28da44b0f274f3e28d3c7a65cefc40.png)

图片上有曲线。我想找到包含曲线的圆心。

我尝试了opencv和霍夫圆变换，但没有结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T16:04:01.600

这是我首先要尝试的：

请注意，如果您从圆的真实中心绘制光线，则沿它们的图像强度的局部最大值出现在与光线方向无关的间隔处。这些间隔是连续圆的半径长度之间的差异。

因此，固定一个数字或射线方向，例如在 [0, pi] 中等距分布的 16 个，并定义一个成本函数，该成本函数参数化在中心的 (xc, yc) 坐标和圆的 ri 半径上，成本等于，例如，不同半径之间沿半径的最大值位置的方差。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:59:43.053

自然的候选人是`cvHoughCircles`。每条曲线的每个部分都为`X/Y/R`标识中心点的三元组添加“投票”。现在，您只有部分圈子，因此投票数量有限，准确性降低，但您可能怀疑太多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:23:30.430

*   阈值图像
*   侵蚀它直到几乎没有噪音（小斑点）
*   扩张回来
*   找到大斑点。如果仍有一些小斑点，请选择最大区域。
*   使用 cv::moments 找到它的质心

# xml - 如何在 XML 属性值中设置属性

> ID：11563345
> 
> 赞同：-1
> 
> 时间：2012-07-19T14:45:24.470
> 
> 标签：xml, izpack

下面的问题是针对 izpack 包的。这发生在我尝试使用 maven izpack 插件时。

我有一个 XML 元素

```
<file src="../${project.name}-${project.name}.zip" targetdir="$INSTALL_PATH/"
    unpack="true" /> 
```

属性的值设置为 ../${project.name}-${project.name}.zip，但我如何实际设置属性的属性值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T14:18:00.537

问题已解决。问题是我使用的是 maven izpack 插件的 5.0.10beta 版本，它在解析 xml 文件中的 maven 属性时遇到了问题。只需转到 5.0.11beta-SNAPSHOT 即可解决。

# git - 哪个提交哈希使用 git-revert 撤消推送的合并？

> ID：11563346
> 
> 赞同：8
> 
> 时间：2012-07-19T14:45:25.983
> 
> 标签：git, undo, git-merge, git-log, git-revert

我将 beta 分支合并到 master 分支。我推到原点。我现在希望 master 在本地和远程都像合并之前一样。

[撤消已推送的合并的](https://stackoverflow.com/a/6217372/290085)一个很好的答案是建议

```
git revert -m 1 commit_hash 
```

如果这确实是要走的路，我该如何确定*commit_hash*？我没有成功尝试由[merge-base](http://www.kernel.org/pub/software/scm/git/docs/git-merge-base.html)返回的哈希：

```
$ git merge-base --all master beta
1f4b949b7ef97abf913ae672e3acd0907abfac1b
$ git revert -m 1 1f4b949b7ef97abf913ae672e3acd0907abfac1b
error: Mainline was specified but commit 1f4b949b7ef97abf913ae672e3acd0907abfac1b is not a merge.
fatal: revert failed 
```

我已经检查了分支的 git-log 和 gitk 演绎版，但它们很长，而且我对自己的解释不确定，觉得我应该在弄得更大的混乱之前寻求帮助。Beta 源自 v2，v2 源自 master。在此过程中，随着我使新分支与 master 保持同步，从 master 到 v2 和 beta 进行了一些合并。从 beta 到 master 方向的合并是一个我希望纠正的错误。

一旦我确定了合并点，如果我发现合并后在 master 上所做的任何提交确实应该在 beta 分支上，那么将它们移过来的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:59:16.283

您需要找到合并的提交，`git merge-base`告诉您可以在哪里进行合并的提交。它基本上是这两个分支中存在的最后一次提交。合并提交仅存在于您的主分支中，除非您在合并后创建了一个新分支，但这与此处无关。:)

要查找合并提交，请尝试： `git log master ^beta --ancestry-path --merges`

所需的提交是最后一次提交。

但请阅读 Linus 的文章：http: [//www.kernel.org/pub/software/scm/git/docs/howto/revert-a-faulty-merge.txt](http://www.kernel.org/pub/software/scm/git/docs/howto/revert-a-faulty-merge.txt)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T17:50:18.560

还请查看[http://sethrobertson.github.com/GitFixUm/](http://sethrobertson.github.com/GitFixUm/)，它可以引导您解决几乎所有 git 问题，包括推送合并。然而......推送合并没有简单的解决方案。

# django - django国家下拉菜单默认

> ID：11563354
> 
> 赞同：1
> 
> 时间：2012-07-19T14:46:05.043
> 
> 标签：django, django-forms

我正在使用 Django ModelForms。我有一个下拉选择器，允许用户选择国家。国家是预订模型的一部分，使用 django_countries 定义。例如，

在模型.py

```
from django_countries import CountryField

class Booking(models.Model)
    name = models.charField(max_length=100)
    country = CountryField() 
```

在views.py 中，我希望能够在下拉菜单中设置默认选定项，例如“英国”。我知道如何使用文本字段执行此操作，但是无法使其与 CountryField() 一起使用。例如，

```
booking = BookingForm(initial={'name': 'mr majeika'}) //works
booking = BookingForm(initial={'country': 'United Kingdom'}) //does not work 
```

我希望那里有人可以指出我正确的方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:57:02.060

根据这里：

[http://pypi.python.org/pypi/django-countries/1.0.1](http://pypi.python.org/pypi/django-countries/1.0.1)

“CountryField 基于 Django 的 CharField，提供与官方 ISO 3166-1 国家列表相对应的选项（**默认 max_length 为 2**）”

CountryField 的完整列表在这里：

[http://djangosnippets.org/snippets/1476/](http://djangosnippets.org/snippets/1476/)

你可以试试这个，看看它是否有效？

```
booking = BookingForm(initial={'country': 'GB'}) 
```

# c# - 从 Java 服务器到 C# 客户端的 JSON-RPC 连接

> ID：11563360
> 
> 赞同：2
> 
> 时间：2012-07-19T14:46:17.853
> 
> 标签：c#, java, .net, json-rpc

我在 GAE (Java) 宽度 libjsonrpc 和客户端 (C#) 宽度 lib jayrock 上有 JSON-RPC 服务器。当我调用服务器时，我有这个 JSONExeption：

服务器正在我的站点上运行

```
[WARN] A JSONObject text must begin with '{' at 1 [character 2 line 1]
   org.json.JSONException: A JSONObject text must begin with '{' at 1 [character 2 line 1]
    at org.json.JSONTokener.syntaxError(JSONTokener.java:432)
    at org.json.JSONObject.<init>(JSONObject.java:184)
    at org.json.JSONObject.<init>(JSONObject.java:310)
    at lib.jsonrpc.BasicRPCService.parseJSON(BasicRPCService.java:295)
    at lib.jsonrpc.BasicRPCService.dispatch(BasicRPCService.java:137)
    at ecosoft.jsonrpc.RPCServlet.doPost(RPCServlet.java:69)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at     org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:58)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:122)
at    org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
     at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
     at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
     at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
     at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
     at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.apphosting.utils.jetty.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:70)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:351)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

我的错误在哪里？

这是我的 src（客户端）：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using Jayrock.JsonRpc;
using System.Collections;
using Jayrock.Json;
using System.Net;

namespace WindowsFormsApplication1
{
public partial class Form1 : Form
{

    public Form1()
    {
        InitializeComponent();

    }

    private void button1_Click(object sender, EventArgs e)
    {
        JsonRpcClient1 client = new JsonRpcClient1();

        client.RequestEncoding = Encoding.UTF8;

        client.Url = "http://localhost:8888/jsonrpc";
        MessageBox.Show(client.Invoke("test").ToString());

    }
}
class JsonRpcClient1 : Jayrock.JsonRpc.JsonRpcClient
{
    protected override WebRequest GetWebRequest(Uri uri)
    {
        var request = (HttpWebRequest)base.GetWebRequest(uri);
        request.ServicePoint.Expect100Continue = false;
        request.ContentType = "text/json";
        return request;
    }
} 
```

}

服务器端：

```
public class CalcService extends BasicRPCService {

public PGPPdata calc() {
    PGPPdata data = new PGPPdata();
    data.setD1(2.0d);
    data.setD2(3.0d);
    data.setD(2.0d + 3.0d);
    return data;
}
public String test() {
    return "Ok";
}

} 
```

# parent - 窗口父级的含义

> ID：11563361
> 
> 赞同：0
> 
> 时间：2012-07-19T14:46:19.840
> 
> 标签：parent

在第 12 标准中。计算机教科书，gseb（第28页）提到“如果当前窗口没有父级，则将其视为target =“self”。窗口的父级是什么意思？我尝试在Google上搜索但没有得到满意的结果。我想这个问题的答案不仅对我有帮助，对很多在std. 12 gseb学习的学生都有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:49:34.483

*窗口的父级*是什么意思`window.parent`。所以文本说如果`window`没有封装在一组帧中，则`window.parent`严格等于`window`。

# php - 验证 CMS 页面

> ID：11563362
> 
> 赞同：1
> 
> 时间：2012-07-19T14:46:19.650
> 
> 标签：php, html, validation, dom, xhtml

我正在强制 CMS (Concrete5) 页面解析 xml：

```
<? header('Content-Type: application/xhtml+xml'); ?> 
```

解析器正在逐步引导我解决错误...

在尝试找到更好的方法时，我阅读了有关 php tidy 和 DOM 的信息。我似乎无法让任何一个加载 CMS 输出；相反，似乎我只是在获取顶级文件。

1.  这是输出缓冲发挥作用的地方吗？
2.  我读过一些抱怨（html5）验证器准确性的地方。如果您认为您的代码接近 xhtml 兼容，那么与使用这些工具之一相比，花在浏览浏览器错误上的努力是否更好？

    谢谢。

环境：使用 concret5 CMS 在 Ubuntu Linux、Apache2、php、mysql 上设置本地主机。

# range - Go：范围仅从通道接收奇数个值

> ID：11563363
> 
> 赞同：3
> 
> 时间：2012-07-19T14:46:20.740
> 
> 标签：range, go, channel, goroutine

我在[http://tour.golang.org/的沙箱中运行此代码](http://tour.golang.org/)

我认为一旦我启动了覆盖通道的 goroutine，我将发送的所有值都会被打印出来。

```
package main

import "fmt"

func main() {
    c := make(chan int)

    go (func(c chan int){
        for v := range c {
            fmt.Println(v)
        }
    })(c)

    c <- 1
    c <- 2
    c <- 3
    c <- 4   
//  c <- 5  // uncomment to send more values
//  c <- 6
    close(c)
} 
```

但是如果我发送奇数个值（比如 1、2 和 3），所有值都会被打印出来。

如果我发送偶数个值（例如 1、2、3 和 4），则不会打印最后一个值。

似乎频道创建行：

```
 c := make(chan int) 
```

当我添加不同大小的缓冲区时更改范围表达式的行为：

（我发送 4 个值）

```
 c := make(chan int)     // prints 1,2,3
    c := make(chan int, 1)  // same behavior, prints 1,2,3
    c := make(chan int, 2)  // prints 1,2
    c := make(chan int, 3)  // prints 1,2,3
    c := make(chan int, 4)  // [no output]
    c := make(chan int, 5)  // [no output]
    c := make(chan int, 20) // [no output] 
```

为什么我发送偶数时没有收到最后一个值？

* * *

更多内容：

我也离线测试了这个，在 64 位 Linux 下编译。

我稍微改变了程序：

```
package main

import (
    "fmt"
)

func main() {
    c := make(chan int)
    cc := make(chan int)

    p := func (c chan int){
      for v := range c {
        fmt.Println(v)
      }
    }

    go p(c)
    go p(cc)

    c <- 1
    c <- 2
    c <- 3
    c <- 4
//  c <- 5
//  c <- 6
    cc <- 1000
//  cc <- 2000
    close(c)
    close(cc)
} 
```

如果我取消该行`cc <- 2000`，那么所有内容都会被打印出来。但如果我把它注释掉，我只会得到 1、2 和 3。

好像是时间问题。我认为该行`cc <- 1000`会阻塞主要功能，直到所有通道都被读取。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T22:33:54.523

[根据内存模型](http://golang.org/ref/mem)，您认为关闭更像是发送而不是发送：

> 通道的关闭发生在接收返回零值之前，因为通道已关闭。

因此，您可以保证这些关闭语句将在其相应的循环终止之前完成。由于您还知道关闭语句必须在这些通道上的最后一次发送之后发生（因为它们在同一个 go-routine 中），您知道除了最后发送的值之外的所有值都将保证打印。我认为您所期望的是关闭更像是发送，因此循环被迫打印其最后一个值。例如，如果您将关闭语句替换为 -1 的发送，这将保证所有值（可能除了 -1 之外）都将被打印。不能保证是否打印 -1。

显然这是对某些事情的简化，但我认为编写示例的“正确”方法是使用sync.WaitGroup。它非常简单，非常适合启动几个 go-routines 并等待它们全部完成。这是您重新编写的代码以使用 WaitGroup：

```
package main

import (
  "fmt"
  "sync"
)

func main() {
  c := make(chan int)
  cc := make(chan int)

  var wg sync.WaitGroup

  p := func(c chan int) {
    for v := range c {
      fmt.Println(v)
    }
    wg.Done()
  }

  wg.Add(2)
  go p(c)
  go p(cc)

  c <- 1
  c <- 2
  c <- 3
  c <- 4
  cc <- 1000
  cc <- 2000
  close(c)
  close(cc)
  wg.Wait()
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T14:48:52.020

写到最后一行，我想我意识到了问题所在。

当 main 结束时，所有其他 goroutine 都结束。

`for`goroutine 内部的循环不是原子的。该行`cc <- 1000`确实阻塞了 main，但它`range`本身将其解锁，并且 main 死了（并且也杀死了 goroutine）不允许`fmt.Println`执行。

# android - 你如何简单地设计这个布局？

> ID：11563370
> 
> 赞同：1
> 
> 时间：2012-07-19T14:46:47.103
> 
> 标签：android, android-layout, layout

我需要与 IOS 开发人员合作。他不知道 Android 在布局系统中是如何工作的。他设计了一个非常动态的 UI。请看我的链接。

[链接：] [http://dl.dropbox.com/u/78582670/layoutdesign.png](http://dl.dropbox.com/u/78582670/layoutdesign.png)

备注：橙色矩形表示图像按钮。

在此布局中，存在两个主要视图。对于视图 1，它是一个列表视图。单击一个项目时，视图 2 将动画化。视图 2 从右向左移动。此外，它稍微覆盖了 View 1。翻译完成后，橙色 Rect 也会动画。它们从底部移动到相对位置。

我跟他们说话。如果我做那个设计，布局就不能重复使用。其次，我不想为播放动画和 UI 设计硬编码。

他们认为一切皆有可能，而且很容易做到 = =|||。

如果你是我，你会怎么设计？

这是我的解决方案，但视图 2 无法覆盖视图 1。

```
public class EducationSystemActivity extends Activity 
{
ImageButton mButton1 = null;
ImageButton mButton2 = null;
ImageButton mButton3 = null;
ImageButton mButton4 = null;
ImageButton mButton5 = null;

OnClickListener mImageButtonClickListner = new OnClickListener()
{
    @Override
    public void onClick(View v) 
    {
        switch(v.getId()){
            case R.id.imageButton1:{
                Fragment fragment = new TestFragment2();
                FragmentTransaction ft = getFragmentManager().beginTransaction();
                ft.setCustomAnimations(R.animator.fragment_slide_left_enter,
                        R.animator.fragment_slide_left_exit,
                        R.animator.fragment_slide_right_enter,
                        R.animator.fragment_slide_right_exit);
                ft.replace(R.id.fragment_content, fragment);
                ft.addToBackStack(null);
                ft.commit();
                Toast.makeText(EducationSystemActivity.this, "Button1", Toast.LENGTH_SHORT).show();
                break;
            }
            case R.id.imageButton2:{
                Toast.makeText(EducationSystemActivity.this, "Button2", Toast.LENGTH_SHORT).show();
                break;
            }
            case R.id.imageButton3:{
                Toast.makeText(EducationSystemActivity.this, "Button3", Toast.LENGTH_SHORT).show();
                break;
            }
            case R.id.imageButton4:{
                Toast.makeText(EducationSystemActivity.this, "Button4", Toast.LENGTH_SHORT).show();
                break;
            }
            case R.id.imageButton5:{
                Toast.makeText(EducationSystemActivity.this, "Button5", Toast.LENGTH_SHORT).show();
                break;
            }
        }
    }
};

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.menu);

    mButton1 = (ImageButton) findViewById(R.id.imageButton1);
    mButton2 = (ImageButton) findViewById(R.id.imageButton2);
    mButton3 = (ImageButton) findViewById(R.id.imageButton3);
    mButton4 = (ImageButton) findViewById(R.id.imageButton4);
    mButton5 = (ImageButton) findViewById(R.id.imageButton5);

    mButton1.setOnClickListener(mImageButtonClickListner);
    mButton2.setOnClickListener(mImageButtonClickListner);
    mButton3.setOnClickListener(mImageButtonClickListner);
    mButton4.setOnClickListener(mImageButtonClickListner);
    mButton5.setOnClickListener(mImageButtonClickListner);

    FragmentTransaction ft = getFragmentManager().beginTransaction();
    ft.replace(R.id.fragment_content, new TestFragment1());
    ft.commit();

}

} 
```

测试片段2：

```
public class TestFragment2 extends Fragment
{
LayoutInflater mInflater = null;

@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    mInflater = (LayoutInflater) getActivity().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    Log.d("TestFragment1", "onCreateView");
    return inflater.inflate(R.layout.test_fragment2, container, false);
}

@Override
public Animator onCreateAnimator(int transit, boolean enter, int nextAnim) {
    Log.d("TestFragment2", "onCreateAnimator transit:" + transit + " enter:" + enter + " nextAnim:" + nextAnim);
    Animator set = null;
    if(enter){
        set = AnimatorInflater.loadAnimator(this.getActivity(), R.animator.fragment_slide_left_enter);
        set.addListener(new AnimatorListener()
        {

            @Override
            public void onAnimationCancel(Animator animation) 
            {

            }

            @Override
            public void onAnimationEnd(Animator animation) 
            {
                Log.d("TestFragment2", "onAnimationEnd()");
                addAnimationSubMenu();
            }

            @Override
            public void onAnimationRepeat(Animator animation) 
            {

            }

            @Override
            public void onAnimationStart(Animator animation) 
            {
                Log.d("TestFragment2", "onAnimationStart()");
            }

        });
    }
    else{
        set = AnimatorInflater.loadAnimator(this.getActivity(), R.animator.fragment_slide_left_exit);
    }
    return set; 
}

private void addAnimationSubMenu()
{
    ViewGroup submenu_frame = (ViewGroup) getActivity().findViewById(R.id.submenu_frame);
    mInflater.inflate(R.layout.fragment1_submenu, submenu_frame, true);
    View submenu_layout = getActivity().findViewById(R.id.submenu_layout);
    Animation anim = AnimationUtils.loadAnimation(this.getActivity(), R.anim.slide_bottom_to_top);
    submenu_layout.startAnimation(anim);
}
} 
```

测试片段2.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#FFFEFE00"
android:padding="0dp"
android:layout_margin="0dp"
android:orientation="horizontal" >

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_weight="0.5"
    android:text="@string/test2" />

<FrameLayout
    android:id="@+id/submenu_frame"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:background="@drawable/menu_drawable">
</FrameLayout>

</LinearLayout> 
```

片段子菜单1.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/submenu_layout"
android:layout_width="wrap_content"
android:layout_height="match_parent"
android:orientation="vertical" >

<ImageButton
    android:id="@+id/imageButton1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:contentDescription="@string/menu_item1"
    android:src="@drawable/speech_bubble2x" />

<ImageButton
    android:id="@+id/imageButton2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:contentDescription="@string/menu_item2"
    android:src="@drawable/newspaper2x" />

<ImageButton
    android:id="@+id/imageButton3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:contentDescription="@string/menu_item3"
    android:src="@drawable/trolley2x" />

<ImageButton
    android:id="@+id/imageButton4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:contentDescription="@string/menu_item4"
    android:src="@drawable/refresh2x" />

<ImageButton
    android:id="@+id/imageButton5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:contentDescription="@string/menu_item5"
    android:src="@drawable/house2x" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T05:36:42.987

这可能你必须使用片段使用[http://actionbarsherlock.com/](http://actionbarsherlock.com/) 这个库将帮助你获得你的要求和[http://xrigau.wordpress.com/2012/03/15/using-an-actionbar-in -your-application-with-actionbarsherlock/](http://xrigau.wordpress.com/2012/03/15/using-an-actionbar-in-your-application-with-actionbarsherlock/)本教程将帮助您实现该库。

# python - 如何制作列表对象？实例没有属性“__getitem__”

> ID：11563371
> 
> 赞同：4
> 
> 时间：2012-07-19T14:46:51.830
> 
> 标签：python, list, object, magic-methods

我是 Python 和一般 OOP 的新手。我有一个错误`"...instance has no attribute '__getitem__'"`，我知道我创建的对象不是列表。我怎样才能成为一个列表对象。这是类文件：

```
#!/usr/bin/python -tt

import math, sys, matrix, os

class Point:
    'Class for points'
    pointCount = 0

    def __init__(self, x, y, z):
        'initialise the Point from three coordinates'
        self.x = x
        self.y = y
        self.z = z
        Point.pointCount += 1

    def __str__(self):
        'print the Point'
        return 'Point (%f, %f, %f)' %(self.x, self.y, self.z)

    def copyPoint(self, distance):
        'create another Point at distance from the self Point'
        return Point(self.x + distance[0], self.y + distance[1], self.z + distance[2])

    def __del__(self):
        'delete the Point'
        Point.pointCount -= 1
        #print Point.pointCount
        return '%s deleted' %self 
```

我需要将它作为一个在（x，y，z）内部具有三个坐标的点，并且这些坐标必须是“可调用的”，就像在带有 [] 的列表实例中一样。

我读过类似的主题，但不太了解。请用简单的语言和例子来描述它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T14:49:55.810

写一个`__getitem__`方法：

```
def __getitem__(self, item):
    return (self.x, self.y, self.z)[item] 
```

这构造了`tuple`x、y 和 z 的 a，并使用 Python 自己的索引工具来访问它。

或者，您可以将自己的内部存储切换为元组，并为 x、y 和 z 创建属性：

```
def __init__(self, x, y, z):
    self.coords = (x, y, z)

@property
def x(self):  # sim. for y, z
    return self.coords[0]

def __getitem__(self, item):
    return self.coords[item] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:17:15.433

我建议您考虑使用[collections.namedtuple](http://docs.python.org/library/collections.html?highlight=namedtuple#collections.namedtuple)工厂函数创建您的 Point 类，这将使其成为内置类的子`tuple`类。这将为您节省一些样板工作。`namedtuple`类具有可以按名称访问的属性，例如`p.x`和索引，例如`p[0]`.

它们也像`tuple`s 一样非常节省内存，如果您要拥有很多类实例，这可能很重要。

您可以通过子类化来进一步专门化返回的内容，或者使用该`verbose`选项来捕获源代码并根据需要进行修改。

上面链接的文档中有一个示例显示它用于创建 2D`Point`类，这似乎对您的特定用例非常有帮助。

这是一个示例，展示了如何通过子类化定义自定义 3D Point 类：

```
from collections import namedtuple

class Point(namedtuple('Point', 'x y z')):
    __slots__ = ()  # prevent creation of instance dictionaries to save memory
    point_count = 0  # instance counter

    def __init__(self, *args):
        super(Point, self).__init__(*args)
        Point.point_count += 1

    def distance(self, other):
        return sum((self[i]-other[i])**2 for i in xrange(len(self))) ** 0.5

    def copy_point(self, distance):
        'create another Point at distance from the self Point'
        return Point(*[dimension+distance for dimension in self])

p1 = Point(0, 0, 0)
print 'p1:', p1
p2 = p1.copy_point(20)
print 'p2: Point(%s)' % ', '.join(str(p2[i]) for i in xrange(len(p2)))
print 'distance p1 <-> p2: %.3f' % p1.distance(p2) 
```

输出：

```
p1: Point(x=1, y=2, z=3)
p2: Point(21, 22, 23)
distance p1 <-> p2: 34.641 
```

请注意，通过使用`namedtuple`您不必`__getitem__()`自己实现，也不必编写`__str__()`方法。需要an 的唯一原因`__init__()`是需要增加已添加的类实例计数器——这是`namedtuple`默认情况下没有或没有的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:14:56.807

是的，您需要定义`__getitem__`，但我可能会按如下方式设计类，它允许属性和索引访问坐标。

```
from collections import namedtuple

class Point(object):
    def __init__(self, x, y, z):
        self._coords = namedtuple('Coords', 'x y z')._make( (x, y, z) )

    @property
    def coords(self):
        return self._coords

    def __getitem__(self, item):
        return self.coords[item]

    def copy_point(self, distance):
        return Point(*(el + distance for el in self.coords))

    def __repr__(self):
        return 'Point: {}'.format(self.coords)

p = Point(1, 2, 3)
p.copy_point(20), p.coords[0], p.coords.x
# (Point: Coords(x=21, y=22, z=23), 1, 1) 
```

# c++ - 如何使用游戏的基指针在 C++ 中编辑值？

> ID：11563373
> 
> 赞同：3
> 
> 时间：2012-07-19T14:46:54.440
> 
> 标签：c++, memory, process, memory-address

好的，我已经学习了一些关于如何使用作弊引擎（马力、力量、经验、金币等）找到游戏价值的基本/静态指针的教程。为了测试这一点，我在 Microsoft 的 Spider Solitaire 上进行了尝试，它奏效了。我得到了移动数量的基本指针（“zetten”，你将在我的荷兰版蜘蛛纸牌中看到），并让它引用另一个引用实际值的指针（假设它是这样被调用的）。![蜘蛛纸牌](../Images/77cd7d90e05079ad9767a50779feb426.png)

这基本上就是它的样子。所以现在我得到了基指针，它是 SpiderSolitaire.exe+B5F78，它使用 2 个偏移量来获取值的实际地址。这是我用来在 C++ 中编辑内存值的代码：

```
#include "stdafx.h"
#include <iostream>
#include <Windows.h>
#include <strsafe.h>

using namespace std;
int _tmain(int argc, _TCHAR* argv[])
{

    long address = 0x??????;
    int newvalue = 200000; 
    DWORD newvaluesize = sizeof(newvalue);

    HWND hWnd = FindWindow(0, L"Spider Solitaire");
    HANDLE pHandle; 
    DWORD pid; 

    if(hWnd != 0) { 
        cout << "Found windowx.\n"; 
        GetWindowThreadProcessId(hWnd, &pid);
        pHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid); 
    } 
    else {
        cout << "Can't find window\n";
    } 
    if(pHandle !=0) { 
        WriteProcessMemory(pHandle, (LPVOID)address, &newvalue, newvaluesize, 0);   
        cout << "Written to memory successfully\n";
        getchar();
    } 
    else { 
        cout << "Couldn't get handle.\n";
        getchar();
    } 
    CloseHandle(pHandle);
    return 0;
} 
```

所以我有我需要的所有信息，除了我不知道如何在 C++ 程序中实现基指针和偏移量等。我尝试使用

```
long address = SpiderSolitaire.exe+B5F78+e8+10 
```

但这不起作用（SpiderSoliteire.exe 无论如何都是一个字符串，所以我没想到它会起作用）。我尝试在互联网上搜索教程或其他内容，但这些仅显示如何直接更改 1 个内存地址中的值，而不是如何通过 2 个指针引用它来更改值。我该怎么做呢？如何在我的 C++ 程序中实现这个基指针和 2 个偏移量，以便我可以编辑内存值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:49:28.573

我尝试了同样的事情，他们说我需要为此编写自己的操作系统。有人说我需要在 ring-0 区域。我说你可以使用 asm（汇编程序）

```
 mov [address],register 
```

命令

Gcc, VC++ 10 , Digital Mars 里面有一些 asm{} 块定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:03:35.207

您必须弄清楚进程的加载位置，这可能会有所不同。有关详细信息，请参阅[这个较早的问题](https://stackoverflow.com/questions/6530565/getting-another-process-command-line-in-windows)。它做的比你需要的多；你只需要基地址部分。

# networking - 如何为语义 Web 服务数据集创建图形

> ID：11563375
> 
> 赞同：0
> 
> 时间：2012-07-19T14:46:55.810
> 
> 标签：networking, semantics, diagram, semantic-web, similarity

我有一个语义 Web 服务的数据集，我想用这个数据集创建一个图表。

我发现了一些示例图结果，例如：

![示例图](../Images/08a717d8cdfeb026dc6d34eed2762fdc.png)

你知道是什么程序做的吗？或者您对使用我的数据集创建类似内容的程序有什么建议吗？

我的数据集示例：

*   C0 : C1
*   C2 : C1
*   C3 : C0
*   …</li>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:49:15.560

[Protégé](http://protege.stanford.edu/)为此类图表提供了一个不错的可视化编辑器。它看起来不同，但您可以使用它来创建类似的东西。也可以轻松导出 JPG 和 PNG。

至于你问题中的图表。它看起来类似于我在项目官方网站上看到的一些[NavigOWL](http://klatif.seecs.nust.edu.pk/navigowl/index.html)输出（顺便说一句，NavigOWL 作为 Protégé 插件提供）：

![在此处输入图像描述](../Images/8c14cac24685cb4cbf9eaee2d4a7356e.png)

**[您可以在此处](http://klatif.seecs.nust.edu.pk/navigowl/gallery.html)找到它（以及更多示例）**

# javascript - JavaScript 定时器暂停

> ID：11563382
> 
> 赞同：2
> 
> 时间：2012-07-19T14:47:33.787
> 
> 标签：javascript, timer

代码如下。您将如何设置一个按钮来暂停计时器并在按下恢复时恢复？下面的 // 标记是我放置暂停和恢复标签的位置。感谢您的所有帮助！

```
<head>
<script type="text/javascript">

var d1 = new Date();
d1.setHours(1,0,0);

function f(){
var h= d1.getHours();
var m= d1.getMinutes();
var s=d1.getSeconds();
m= (m<10)?"0"+m: m;
s= (s<10)? "0"+s : s;

var el= document.getElementById("inputid");
el.value= h+":"+m+":"+s;
d1.setSeconds(d1.getSeconds()-1);
if( h==0 && m==0 && s==0 ) clearTimeout(t)
var t= setTimeout("f()",1000);
}

</script>
</head>
<body>
<form><input type="text" id="inputid"></form>
<script type="text/javascript">f()</script>

//pause and resume buttons would go here.
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:50:58.003

另一种方法是：按下按钮时，设置一个变量，如`paused`. 在您的`f`函数中，如果 paused 为真，则立即返回。

```
setInterval(function(){
  if (paused) return;
  // update the dom
}, 1000); 
```

输入

```
<input type="button" value="Pause" onClick="window.paused=true" /> 
```

[这是一个基本的小提琴](http://jsfiddle.net/fW5CD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:50:11.377

`clearTimeout()`您可以通过将 return from `setTimeout`or传递给它来停止超时，在您的情况下`t`.

现场示例：http: [//jsfiddle.net/tJWmH/](http://jsfiddle.net/tJWmH/)

另一个指针：不要将字符串传递给`setTimeout`，而是传递函数引用，因此：

```
var t = setTimeout(f,1000) 
```

代替

```
var t = setTimeout("f()",1000); 
```

如果您想知道为什么，请搜索[“eval is evil”。](https://www.google.com/search?q=eval+is+evil)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T14:58:32.640

这不是我的代码。我找到了它并在我的项目中使用。这是原始帖子：[https ://stackoverflow.com/a/3969760/1250044](https://stackoverflow.com/a/3969760/1250044)

```
Timer = function(callback, delay) {
  var timerId, start, remaining = delay;

  this.pause = function() {
    window.clearTimeout(timerId);
    remaining -= new Date() - start;
  };

  this.resume = function() {
    start = new Date();
    timerId = window.setTimeout(callback, remaining);
  };

  this.resume();
}; 
```

采用：

```
var t = new Timer(function(){
 /* ... */
}, 500);

t.pause();
t.resume(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:04:37.983

试试这个：

```
var d1 = new Date();
d1.setHours(1,0,0);
var t;

function f() {
    var h= d1.getHours();
    var m= d1.getMinutes();
    var s=d1.getSeconds();
    m= (m < 10) ? ('0'+m) : m;
    s= (s < 10) ? ('0'+s) : s;

    var el= document.getElementById("inputid");
    el.value = h+":"+m+":"+s;

    if( h==0 && m==0 && s==0 ) {
        clearTimeout(t)
        return;   
    }
    d1.setSeconds(d1.getSeconds()-1);

    t= setTimeout(f,1000);

}

function pause() {
    clearTimeout(t);
}
function resume() {
    t= setTimeout(f,1000);
}
resume(); 
```

你只需调用 pause() 来暂停它，然后调用 resume() 来恢复它。就是这样！请注意，我调用 resume() 一次，只是为了启动计数器。

编辑：您必须在递减之前检查它是否达到零，然后返回，以便按下恢复不会继续工作。

# node.js - Nodejs - 如何维护全局数据结构

> ID：11563386
> 
> 赞同：2
> 
> 时间：2012-07-19T14:47:50.427
> 
> 标签：node.js

所以我在 node.js 中有一个后端实现，它主要包含一个全局 JSON 对象数组。JSON 对象由用户请求 (POSTS) 填充。所以全局数组的大小随着用户数量的增加成比例增加。数组中的 JSON 对象不相同。这是一个非常糟糕的架构。但我只是按照我所知道的去做，并决定即时学习。

我在具有 6GB RAM 的 AWS 微型实例上运行它。

如何在这个全局数组爆炸之前清除它？

我想到的选项：

1.  定期将全局数组写入文件并清除。这里的缺点是，如果在事务中间有任何客户端，则该事务状态将丢失。
2.  每天重启服务器，到时候把全局数组写入文件。缺点同上。
3.  遵循 1 或 2，对于每个传入请求 - 如果全局数组为空，则在文件中查找相应的 JSON 对象。这看起来绝对荒谬和愚蠢。

不知何故，我想不出任何其他解决方案，而不必完全重写 nodejs 应用程序。你们能想到任何..吗？将非常感谢有关此的任何讨论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:34:00.710

我看到您正在使用内存作为存储。如果是这种情况并且您的代码是同步的（您似乎没有使用数据库，所以它可能），那么实际上解决方案**1.**是正确的。这是因为 JavaScript 是单线程的，这意味着当一个代码运行时，另一个代码无法运行。JavaScript 中没有并发。这只是一种错觉，因为 Node.js 太快了。

因此，在事务结束之前，您的清洁代码不会触发。这当然是假设您的代码是同步的（并且据我所知可能是同步的）。

但是仍然有大约 150 个理由不这样做。最重要的是，您正在重新发明轮子！让数据库为您完成繁重的工作。使用适当的数据库将为您节省未来的所有麻烦。有很多可能性：MySQL、PostgreSQL、MongoDB（我最喜欢的）、CouchDB 等等。在这一点上，哪一个都不重要。随便挑一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:22:12.913

我建议您开始将 JSON 保存到非关系数据库中，例如[http://www.couchbase.com/](http://www.couchbase.com/ "沙发底座")。

即使在集群中，Couchbase 也非常容易设置和使用。它使用简单的键值设计，因此保存数据非常简单：

```
couchbaseClient.set("someKey", "yourJSON") 
```

然后检索您的数据：

```
data = couchbaseClient.set("someKey") 
```

该系统也非常快，并且被 OMGPOP 用于 Draw Something。[http://blog.couchbase.com/preparing-massive-growth-revisited](http://blog.couchbase.com/preparing-massive-growth-revisited)

# asp.net-mvc-3 - ASP.net MVC3 和 Spring.net

> ID：11563387
> 
> 赞同：0
> 
> 时间：2012-07-19T14:47:50.847
> 
> 标签：asp.net-mvc-3, spring, spring.net

ASP.net MVC3 和 Spring.Net 之间的实际区别是什么。您建议将什么用于新应用程序。Spring.net 是否得到积极开发和支持？

两者是否相互兼容并可以一起使用？

任何想法将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:55:10.507

Spring.NET 是 .NET 的依赖注入框架。

ASP.NET 是一个使用 MVC 模式在 ASP.NET 之上开发 Web 应用程序的框架。

所以这就像问`What is practical difference between an apple and an orange`。

# forms - 构建 Zend 表单以编辑自定义 Zend Config ini 文件

> ID：11563388
> 
> 赞同：0
> 
> 时间：2012-07-19T14:47:53.257
> 
> 标签：forms, zend-framework, frameworks

我正在尝试制作一个能够编辑带有一些自定义设置的自定义 config.ini 文件的表单，我正在尝试动态执行此操作，因此如果我在配置文件中添加另一行，它会显示在编辑表单上，或者更准确地说，我将把它与类似系统的扩展一起使用，其中新的扩展可以在这个 config.ini 文件中添加行。但是，我很难使用字段名称，所以对于这样的 en config 文件：

```
[production]

db.adapter = "pdo_mysql"
db.params.host = "localhost"
db.params.username = "user"
db.params.password = "123456"
db.params.dbname = "zend" 
```

我需要为每个参数设置相应的字段，如下所示：

```
<input type="text" name="db[adapter]"/>
<input type="text" name="db[params][host]"/>
<input type="text" name="db[params][username]"/>
<input type="text" name="db[params][password]"/>
<input type="text" name="db[params][dbname]"/> 
```

那么自动构建此表单的最简单方法是什么？

我创建了一个自定义 Zend_Form，在这个表单中，使用 Zend_Config 获取配置文件，并通过设置循环为每个参数创建一个文本字段，但我喜欢名称遵循与 ini 文件相同的模式，比如在上面的例子中，但我能得到的只是：

```
<input type="text" name="params[host]"/>
<input type="text" name="params[username]"/>
<input type="text" name="params[password]"/>
<input type="text" name="params[dbname]"/> 
```

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:26:06.073

我不使用 Zend_form，所以我不是回答的合适人选，但由于我做了类似的事情，我可以从我的应用程序内部更改配置，所以无论如何我都会试一试。我个人会在 view-helper 中执行此操作并直接生成 html-form 而不使用 Zend_form，但如果您想使用 Zend_form，Zend_sub_form 似乎是要走的路。我知道下面的代码并不完全正确，它至少应该引导你一点。

```
/**
* The action
*/

public function configAction(){
    //get the zend config from file or from registry and cast it as an array
    $config = Zend_Registry::get('config');
    $config = $config->toArray

    //create the form and a new subform for each part of the config array
    $form = new Zend_Form();
    foreach ($config as $key=>value){
        $form = self::generateSubForm($key, $value, $form);
    }

    $this->view->form = $form;
}

/**
* Generates all subforms
*/
private function generateSubForm($key, $value, $form){
    //generate a subform for this key if needed
    if(!is_object($form->getSubForm($key)){
        $$key = new Zend_Form_SubForm();
        $form->addSubForm($$key, $key);
    } else {
        $$key = $form->getSubForm($key);
    }
    //if the value is an array, we must go deeper
    //Else we create a textelement and go on the next one
    if(is_array($value){
        $form = self::generateSubForm($key, $value, $form->getSubForm($key));
    } else{
        $form->getSubForm($key)->addElement('text', 'value');
        $form->getSubForm($key)->$key->setValue($value);
    }

    return $form;
} 
```

这应该生成一个看起来像这样的表单

```
<input type="text" name="phpSettings[date][timezone][value]" value="Europe/Stockholm">
<input type="text" name="phpSettings[display_startup_errors][value]" value="0">
<input type="text" name="phpSettings[display_errors][value]" value="0"> 
```

从一个看起来像这样的配置

> phpSettings.date.timezone = "欧洲/斯德哥尔摩"
> 
> phpSettings.display_startup_errors = 0
> 
> phpSettings.display_errors = 0

# c# - 自定义绑定：提供的 URI 方案“https”无效；预期的“http”。参数名称：via

> ID：11563389
> 
> 赞同：2
> 
> 时间：2012-07-19T14:47:56.667
> 
> 标签：c#, wcf, https, basichttpbinding

我已经查看了stackoverflow和互联网，仍然找不到解决方案我已经设置了一个带有“https”端点的自定义basichttpbinding。当我调用该方法时，它一直返回异常：

提供的 URI 方案“https”无效；预期的“http”。参数名称：via

```
var endPoint = new EndpointAddress("https://xxxxx/v2_soap/index/");

var binding = new BasicHttpBinding
{
    Name = "HandlerBinding",
        CloseTimeout = TimeSpan.FromMinutes(1.0),
        HostNameComparisonMode = HostNameComparisonMode.StrongWildcard,
        MessageEncoding = WSMessageEncoding.Text,
        MaxReceivedMessageSize = 65536000,
        MaxBufferPoolSize = 65536000,
        UseDefaultWebProxy = true,
        AllowCookies = false,
        BypassProxyOnLocal = false,
        Security =
    {
        Mode =BasicHttpSecurityMode.Transport,
        Transport =
        {
            ClientCredentialType = HttpClientCredentialType.None,
            ProxyCredentialType = HttpProxyCredentialType.None
        },
        Message =
            {
                ClientCredentialType = BasicHttpMessageCredentialType.UserName
            }
    } 
}; 
```

以上设置与VS添加服务引用时生成的app.config完全相同：

```
 <system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="HandlerBinding" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="Transport">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <client>
      <endpoint address="https://xxxxx/v2_soap/index/?SID=qttkobaa5jrmaj22il8mn9n342"
        binding="basicHttpBinding" bindingConfiguration="HandlerBinding"
        contract="HandlerPortType"
        name="HandlerPort" />
    </client>
  </system.serviceModel> 
```

我什至尝试从 basichttpbinding 更改为 WSHttpBinding，但仍然没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:51:53.190

CodeProject 上有一篇很好的文章：[SSL for self hosting WCF service](http://www.codeproject.com/Articles/24027/SSL-with-Self-hosted-WCF-Service)

# hadoop - HBase + HDFS - 缺少 hdfs 块

> ID：11563391
> 
> 赞同：0
> 
> 时间：2012-07-19T14:47:59.487
> 
> 标签：hadoop, hbase

在从我们的 hbase 集群中删除几个节点时，我们过早地退出了 hadoop 安全模式（在退役完成之前）。当我们运行 hdfs`fsck`时，我们意识到有一些缺失的块。我们立即将删除的节点重新添加到集群中。`fsck`仍然报告一些块丢失。

同时，HBase 无法从区域中找到这些缺失的块。解决问题的最佳方法是什么？我们知道 HBase 无法找到的 HDFS 文件的位置。

*更新：*

更正 - 名称节点只有关于丢失块的元数据。缺少实际的块。我们现在如何修复 HBase 以从区域服务器中删除这些数据块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T11:02:37.747

我们通过迁移到最新版本的 HBase (0.94.1RC) 解决了这些问题。这个版本附带了更好的修复工具 ( `hbck`)。使用它，我们能够修复`.META.`和修复 HDFS 漏洞。

# sql-server - SQL Server 计划重置

> ID：11563392
> 
> 赞同：2
> 
> 时间：2012-07-19T14:48:04.280
> 
> 标签：sql-server

我们最近遇到了一个问题，服务器上的日期提前了几个月而没有被注意到。我们运行了许多预定的作业，现在它们要等到 11 月才能再次运行。

我一生都无法在 SQL Server 中找到任何地方来更改下一个计划运行时间。

任何人都有任何想法，或者我是否必须从头开始重新创建每个时间表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:12:15.140

您可以通过编辑每个作业的开始日期来解决此问题。（打开你的工作 -> 时间表 -> 编辑时间表 -> 持续时间 -> 开始日期）

尽管您可以查看表格`msdb..sysjobschedules`以检查所有时间表，但它包含列`next_run_date`和`next_run_time`您的工作。

# facebook - 如何永久删除我的 Facebook 应用程序

> ID：11563395
> 
> 赞同：0
> 
> 时间：2012-07-19T14:48:08.997
> 
> 标签：facebook, search

我创建了一个我不想再使用的 Facebook 应用程序。一个多星期前，我从我的开发者帐户和相关的 Facebook 页面中删除了它，但它仍然出现在 Facebook 搜索引擎中。

我知道已经发布了类似的问题，但我无法再访问此应用程序的管理员，这意味着我无法更改该应用程序的用户可访问性。

我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:15:02.853

听起来像是 Facebook 的错误。您可能想在[此处](https://developers.facebook.com/bugs/)发布错误报告。下次可能有帮助的解决方案：打开沙盒模式，然后删除应用程序。

# php - PoEdit 和 PHP 注释

> ID：11563403
> 
> 赞同：6
> 
> 时间：2012-07-19T14:48:23.407
> 
> 标签：php, annotations, gettext, poedit

我正在寻找一种让 PoEdit 理解 PHP 注释的方法。这是我希望 PoEdit 拾取并放入目录的代码示例：

```
class MyController extends Controller {

    /**
     * @Title "Home"
     */
    public function index() {
        ...
    }

} 
```

有趣的部分是`@Title`注释。它在前端控制器中访问并分配给主视图，有效地在`<title>...</title>`标签内结束。

现在我需要翻译该字符串，但 PoEdit 似乎只能理解`_()`表达式，并且添加`@Title`到关键字不起作用。这可能是因为 PHP 中的注释位于注释块中。

有什么方法可以强制 PoEdit 理解注释吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T06:59:09.173

简短的回答，你不能。

POEdit 使用[xgettext](http://www.gnu.org/savannah-checkouts/gnu/gettext/manual/html_node/xgettext-Invocation.html)扫描您的文件，因此使用特定语法，忽略注释行。

例如，如果您的关键字是`_`以下示例，则将被解析为：

`_('test');`-> 字符串“测试”

`_("test");`-> 字符串“测试”

`_('test'`-> 字符串“测试”

`_ 'test`-> 没有抓到

`_('test`-> 没有抓到

`_(test)`-> 没有抓到

`_($test)`-> 没有抓到

`//_('test');` -> 没有抓到

`/*_('test');*/`-> 没有抓到

您可以`xgettext`使用其他参数执行，但我不确定您是否能够实现目标。

* * *

一个简单的解决方法（不是标准的 ofc）是添加其他关键字 like`placeholder`并制作一个 php 函数

```
function placeholder($string){} 
```

并使用它，以便 POEdit 可以解析它

```
class MyController extends Controller {

    /**
     * @Title "Home"
     */
    public function index() {
      placeholder('Home');  
      ...
    }

} 
```

在您的前端解析器中，只需使用简单的`_($value)`，您将翻译您的标题。

不知道您的代码如何，但会假设它与此类似。

假设 $tag = 'title' 和 $value = 'Home'

```
echo '<'.$tag.'>'._($value).'</'.$tag.'>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T18:00:21.630

如果您真的想这样做，那么您可以将所需的字符串从 php 文件中提取到外部文件中，同时将注释部分替换为 _(string); 对于每场比赛并在该文件上运行 Poedit。

您可以将其与`.*\*\s\@(\w+)\s\"(\w+)\".*`-`$1`在匹配中匹配将是注释（标题），`$2`将是值：（主页）

# javascript - 使用 Javascript 将非标准属性添加到选择标记

> ID：11563407
> 
> 赞同：0
> 
> 时间：2012-07-19T14:48:33.800
> 
> 标签：javascript

我想通过 JavaScript 创建一个选择元素，我想为其设置一个名为`data-placeholder`.

我们如何在浏览器不抱怨的情况下使用 JavaScript 分配非标准属性：

```
Uncaught referenceError: Invalid left-hand side in assignment 
```

导致错误的代码：

```
select1.data-placeholder="Choose ..."; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:57:17.933

因为它说的是javascript而不是jquery...

```
yourElement.setAttribute('data-placeholder','value'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:00:35.490

这是一个非常简单的非jQuery方法来实现这一点；

```
var el = document.createElement('select');
el.setAttribute('data-placeholder', 'placeholder value');
document.body.appendChild(el);​ 
```

我创建了一个非常简单的[JSFiddle](http://jsfiddle.net/jasonmerino/yN833/1/)来演示它。

希望有帮助！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-19T14:51:15.733

JQuery 使这很容易：

```
$("<select></select>").attr("data-placeholder", "value").appendTo($element); 
```

# oracle - 类似的查询有不同的执行时间

> ID：11563408
> 
> 赞同：1
> 
> 时间：2012-07-19T14:48:35.590
> 
> 标签：oracle

我有以下查询：

```
SELECT nvl(sum(adjust1),0)
FROM (
  SELECT
    ManyOperationsOnFieldX adjust1,
    a, b, c, d, e
  FROM (
    SELECT
      a, b, c, d, e,
      SubStr(balance, INSTR(balance, '[&&2~', 1, 1)) X
    FROM
      table
    WHERE
      a >= To_Date('&&1','YYYYMMDD')
      AND a < To_Date('&&1','YYYYMMDD')+1
  )
)
WHERE
  b LIKE ...
  AND e IS NULL
  AND adjust1>0
  AND (b NOT IN ('...','...','...'))
  OR  (b = '... AND c <> NULL) 
```

我试图将其更改为：

```
SELECT nvl(sum(adjust1),0)
FROM (
  SELECT
    ManyOperationsOnFieldX adjust1
  FROM (
    SELECT
      SubStr(balance, INSTR(balance, '[&&2~', 1, 1)) X
    FROM
      table
    WHERE
      a >= To_Date('&&1','YYYYMMDD')
      AND a < To_Date('&&1','YYYYMMDD')+1
      AND b LIKE '..'
      AND e IS NULL
      AND (b NOT IN ('..','..','..'))
      OR  (b='..' AND c <> NULL)
  )
)
WHERE
  adjust1>0 
```

我的意图是在最里面的查询中进行所有过滤，只给外部查询字段 X ，这是我必须经常操作的字段。但是，第一个（原始）查询需要几秒钟才能执行，而第二个查询甚至不会完成。我等了将近 20 分钟，仍然没有得到答案。

发生这种情况的明显原因是我可能忽略的吗？

这些是他们每个人的计划：

```
SELECT STATEMENT optimizer=all_rows (cost = 973 Card = 1 bytes = 288)
  SORT (aggregate)
    PARTITION RANGE (single) (cost=973 Card = 3 bytes = 864)
      TABLE ACCESS (full) OF "table" #3 TABLE Optimizer = analyzed(cost=973 Card = 3 bytes=564)

SELECT STATEMENT optimizer=all_rows (cost = 750.354 Card = 1 bytes = 288)
  SORT (aggregate)
    PARTITION RANGE (ALL) (cost=759.354 Cart = 64.339 bytes = 18.529.632)
      TABLE ACCESS (full) OF "table" #3 TABLE Optimizer = analyzed(cost=750.354 Card = 64.339 bytes=18.529.632) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:12:11.073

您的两个查询不相同。

[逻辑运算符`AND``OR`](http://docs.oracle.com/cd/E11882_01/server.112/e26088/conditions001.htm#i1034834)在[运算符之前进行评估](http://docs.oracle.com/cd/E11882_01/server.112/e26088/conditions001.htm#i1034834)：

```
SQL> WITH data AS
  2          (SELECT rownum id
  3             FROM dual
  4           CONNECT BY level <= 10)
  5  SELECT *
  6    FROM data
  7   WHERE id = 2
  8     AND id = 3
  9      OR  id = 5;

        ID
----------
         5 
```

所以你的第一个查询意味着：`SUM`当数据是这种方式时，给我这个分区的大数据。

你的第二个查询的意思是：给我大`SUM`的（当数据是这种方式时这个分区）或（当数据是这种方式时[没有分区消除因此大全扫描]）

`AND`混合逻辑运算符和时要小心`OR`。我的建议是使用括号以避免任何混淆。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:11:10.013

这完全取决于您的手术室……试试这个：

```
SELECT nvl(sum(adjust1),0)
FROM (
  SELECT
    ManyOperationsOnFieldX adjust1
  FROM (
    SELECT
      SubStr(balance, INSTR(balance, '[&&2~', 1, 1)) X
    FROM
      table
    WHERE
      a >= To_Date('&&1','YYYYMMDD')
      AND a < To_Date('&&1','YYYYMMDD')+1
      AND (
          b LIKE '..'
          AND e IS NULL
          AND (b NOT IN ('..','..','..'))
          OR  (b='..' AND c <> NULL)
      )
  )
)
WHERE
  adjust1>0 
```

因为您将 OR 与其他没有括号的 AND 语句内联，所以第二个版本不会将检查的数据限制为仅落在日期过滤器中的行。有关详细信息，请参阅[条件优先级的文档](http://docs.oracle.com/cd/B28359_01/server.111/b28286/conditions001.htm#i1034834)

# database - 在 solaris 上启动 postgres 时出现致命错误

> ID：11563409
> 
> 赞同：0
> 
> 时间：2012-07-19T14:48:41.707
> 
> 标签：database, postgresql

我正在尝试在我的主目录中的 sun solaris sparc 实例上安装 postgres。

一切都很好，除了当我尝试启动 postgres 服务器时，我收到以下错误

```
FATAL:  "/home/reic/var/lib/pgsql/data" is not a valid data directory
DETAIL:  File "/home/reic/var/lib/pgsql/data/PG_VERSION" is missing. 
```

我使用该命令`pg_ctl -l logfile start`启动服务器。

我已按照在 sun solaris 上安装的所有必要步骤进行操作。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T11:06:19.920

解决方案：

所有必要的文件都在`PGDATA`目录中，我以尝试启动服务器的同一用户身份运行它。问题在于将环境变量放置在`.bashrc`而不是`.bash_profile`文件中。显然，当 env 变量放入时，定制不会传播到子 shell `.bashrc`。

我没有意识到这一点很糟糕！谢谢你们....

# asp.net-mvc - IE 的 MVC 4 应用程序/jQuery Ajax POST 问题

> ID：11563410
> 
> 赞同：1
> 
> 时间：2012-07-19T14:48:41.757
> 
> 标签：asp.net-mvc, jquery

我有一个 ASP.NET MVC 4 应用程序。此应用程序将通过 iFrame 嵌入到另一个站点（不同域）。

该应用程序的一部分具有获取基于州的城市列表的功能。我正在使用 jQuery Ajax 来执行此操作。除 IE 外，所有浏览器都可以正常工作。

根据我的谷歌搜索，我了解到我需要为 IE 使用 XDomainRequest。所以这里是代码：

```
/* For dynamically getting list of cities by state */
        $("#state").change(function() {
            $(".city").empty();
            if ($(this).val() != "") {
                if ($.browser.msie && window.XDomainRequest) {
                    var data = "state=" + $(this).val();
                    var xdr = new window.XDomainRequest();
                    xdr.open("POST", "/Search/GetCities");
                    xdr.send(data);
                    xdr.onload = function() {
                        var json = $.parseJSON(xdr.responseText);
                        if (json == null || typeof(json) == 'undefined') {
                            json = $.parseJSON(data.firstChild.textContent);
                        }
                        processData(json);
                    };
                    xdr.send();
                } else {

                    $.ajax({
                        type: "POST",
                        url: "/Search/GetCities",
                        data: {
                            state: $(this).val()
                        },
                        dataType: "json",
                        success: function(data) {
                            if (data == '') {
                                $("#state").change();
                            } else {
                                $(".city").css("display", "none");
                                var items = "<option value=\"\" selected>Please Select</option>";
                                $.each(data, function(i, item) {
                                    items += "<option value='" + item.Value + "'>" + item.Text + "</option>";
                                });
                                $(".city").append(items);
                                $(".city").css("display", "");
                                $(".city").attr('disabled', false);
                            }
                        }
                    });
                }
            }
        });
        /* End dynamically getting list of cities by state */ 
```

这是踢球者。对于 FF、Chrome 和 Safari，身份验证 cookie 会在 Ajax 调用中传递，但不会在 IE 中传递，因此 IE 认为我不是身份验证用户，因此它会使用登录 URL 进行响应。

在 IE 上进行这项工作我缺少什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:27:16.633

我冒昧地说您的问题与您在帖子中使用的 jquery 无关，而是与 IE 的跨域 cookie 有关。

尝试添加 P3P 标头。可以在此处找到有关该主题的良好 SO 线程：

[Cookie 被阻止/未保存在 Internet Explorer 的 IFRAME 中](https://stackoverflow.com/questions/389456/cookie-blocked-not-saved-in-iframe-in-internet-explorer)

# spring - 如何在开发过程中禁用 CAS？

> ID：11563413
> 
> 赞同：5
> 
> 时间：2012-07-19T14:48:54.967
> 
> 标签：spring, spring-security, cas

我们使用 Spring Security 集成了 CAS。是否可以在开发过程中禁用 CAS 或任何替代方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T16:38:39.460

我不确定您所说的“禁用 CAS”是什么意思。在我们的开发环境中，我们使用基本身份验证而不是 CAS 身份验证。这很容易通过在我们的配置中包含两个过滤器和一个从基本身份验证入口点切换到 CAS 入口点的属性来完成。最好的问候，杰罗姆

# c++ - c++ 分布式计算一个可执行程序

> ID：11563423
> 
> 赞同：0
> 
> 时间：2012-07-19T14:49:14.373
> 
> 标签：c++, parallel-processing, cluster-computing, distributed-computing

我想知道是否可以在不添加源代码的情况下运行可执行程序，例如在多台计算机上运行任何游戏。当我在 c# 中编程时，我注意到一个 process 方法，它可以让你调用或关闭任何应用程序或进程，我想知道是否有类似 c++ 的东西可以让我将任何可执行文件或游戏的进程转移到其他计算机或服务器最大限度地减少我的计算机的处理器消耗。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:10:20.730

一切皆有可能，但这需要大量的工作，并且几乎肯定会使您的程序变得非常缓慢（我在这里谈论的是数百万或数十亿的因素）。本质上，您需要确保程序中使用的每一层都允许这样做。因此，您必须重写操作系统才能做到这一点，而且还必须重写它使用的许多库。

为什么？假设您想将实际线程分布在不同的机器上。如果它是实际过程会*稍微*容易一些，但我会惊讶于许多应用程序都是这样工作的。

首先，您需要同步内存，更具体地说是所有非线程本地存储，这通常意味着“所有内存”，因为并非所有语言都有线程感知内存模型。当然，这可以进行优化，例如缓冲所有内容，直到您遇到“原子”读取或写入，如果您的系统当然有这样的概念。现在你能想象当一个线程必须被锁定/解锁或一个原子变量必须被读取/写入时，每个线程都会阻塞几秒钟以进行同步吗？

接下来是与管理设备相关的问题。假设您需要一个网络连接：哪个设备将启动它，如何选择 ip，...？要无缝解决这个问题，您可能需要一个在所有平台之间共享的虚拟设备。这必须发生在网络设备、文件系统、打印机、监视器……。正如您提到的游戏：这也应该发生在 GPU 上，想象一下这将如何影响仅从 GPU 发送数据或向 GPU 发送数据的性能（提示：即使 16xpci-e 通常已经是瓶颈）。

总之：这是不可行的，如果你想要一个集群应用程序，你必须从头开始将它构建到应用程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:24:29.413

当前的研究状态是研究在单个计算机上跨多个 CPU 内核分配进程工作的实用方法。在这种情况下，这些处理器仍然共享 RAM。这是必不可少的：RAM 延迟以纳秒为单位。

在分布式计算中，远程内存访问可能需要数十甚至数百微秒。分布式算法明确地考虑到了这一点。再多的魔法也无法让它消失：光本身很慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T09:12:02.750

AT&T 贝尔实验室的[Plan 9 操作系统](http://plan9.bell-labs.com/plan9/)以最无缝和透明的方式支持分布式计算。计划 9 旨在将 Unix 将工作分解为互操作小任务的想法，由高度专业化的实用程序执行，“一切都是文件”以及客户端/服务器模型，达到一个全新的水平。它有一个 CPU 服务器的想法，它为功能较弱的网络客户端执行计算。不幸的是，这个想法过于雄心勃勃，远远超出了它的时代，Plan 9 在很大程度上仍然是一个研究项目。不过，它仍在作为开源软件开发。

MOSIX 是另一个分布式操作系统项目，它在多台机器上提供单个进程空间并支持透明的进程迁移。它允许进程在不更改其源代码的情况下变得可迁移，因为所有上下文保存和恢复都是由操作系统内核完成的。MOSIX 模型有多种实现 - MOSIX2、openMosix（自 2008 年起停止使用）和 LinuxPMI（openMosix 项目的延续）。

ScaleMP 是另一种商业单系统映像 (SSI) 实现，主要针对数据处理和高性能计算。它不仅提供集群节点之间的透明迁移，还提供模拟共享内存（称为分布式共享内存）。基本上，它将通过非常快速的网络连接的一堆计算机转换为具有许多 CPU 和大量内存的单个大型 NUMA 机器。

这些都不允许您在 PC 上启动游戏并将其透明地迁移并在网络上的某个位置执行。此外，大多数游戏都是 GPU 密集型的，而不是 CPU 密集型的——大多数游戏甚至还没有利用多核 CPU 的全部计算能力。我们这里有一个 ScaleMP 集群，但它不能很好地运行 Quake...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:20:19.617

我相信你能做的最接近的事情是[MapReduce](http://www.craighenderson.co.uk/mapreduce/)：它是一个范式，希望很快成为官方 boost 库的一部分。但是，我认为您不会希望将其应用于像游戏这样的实时应用程序。

相关问题可能会提供更多答案：[https ://stackoverflow.com/questions/2168558/is-there-anything-like-hadoop-in-c](https://stackoverflow.com/questions/2168558/is-there-anything-like-hadoop-in-c)

但正如 KillianDS 指出的那样，没有[自动](http://en.wiktionary.org/wiki/automagical)的方法可以做到这一点，似乎也没有可行的方法来做到这一点。那么，您要解决的确切问题是什么？

# android - Android：将图片和文字发布到 Instagram

> ID：11563426
> 
> 赞同：4
> 
> 时间：2012-07-19T14:49:18.340
> 
> 标签：android, photo, instagram

我如何将图像和文本发布到 Instagram？如果我必须打开 instagram 应用程序，或者如果我通过 api 或其他方式打开，没问题。问题是我找不到方法：他们只有 iphone 挂钩，而且 api 是不可理解的。有人这样做过，或者知道吗？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-09-10T08:48:54.693

试试这个它对我有用。我将使用它来分享我的产品详细信息。我将从服务器获取产品的详细信息，如名称、图像、描述并显示在应用程序中，然后分享到 instagram。

从服务器获取图片 url。

```
URL url = ConvertToUrl(imgURL);
    Bitmap imagebitmap = null;
    try {
        imagebitmap = BitmapFactory.decodeStream(url.openConnection()
                .getInputStream());
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

在 Instagram 上发布图片和文字。

```
// post on instagram
            Intent shareIntent = new Intent(
                    android.content.Intent.ACTION_SEND);
            shareIntent.setType("image/*");
            shareIntent.putExtra(Intent.EXTRA_STREAM,
                    getImageUri(HomeActivity.this, result));
            shareIntent.putExtra(Intent.EXTRA_SUBJECT, sharename);
            shareIntent.putExtra(
                    Intent.EXTRA_TEXT,
                    "Check this out, what do you think?"
                            + System.getProperty("line.separator")
                            + sharedescription);
            shareIntent.setPackage("com.instagram.android");
            startActivity(shareIntent); 
```

将 Uri 字符串转换为 URL

```
 private URL ConvertToUrl(String urlStr) {
    try {
        URL url = new URL(urlStr);
        URI uri = new URI(url.getProtocol(), url.getUserInfo(),
                url.getHost(), url.getPort(), url.getPath(),
                url.getQuery(), url.getRef());
        url = uri.toURL();
        return url;
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
} 
```

将位图转换为 Uri

```
public Uri getImageUri(Context inContext, Bitmap inImage) {
ByteArrayOutputStream bytes = new ByteArrayOutputStream();
inImage.compress(Bitmap.CompressFormat.JPEG, 100, bytes);
String path = MediaStore.Images.Media.insertImage(
        inContext.getContentResolver(), inImage, "Title", null);
return Uri.parse(path);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T16:43:07.867

我怀疑[Instagram 开发人员](https://groups.google.com/d/msg/instagram-api-developers/7XUKm9HSAdg/E21qpajAzCQJ)是否会发布类似 iPhone 的 Android 钩子，因为 Intents 已经用于此目的。

如果您想从您的应用程序共享图像，请使用如下意图：

```
Intent i = new Intent(Intent.ACTION_SEND);
i.setType("image/jpeg");
i.putExtra(Intent.EXTRA_STREAM, Uri.parse("file:///sdcard/Path/To/Image.jpg"));
startActivity(Intent.createChooser(i, "Share Image")); 
```

请注意，这将显示一个对话框，允许用户选择要启动的照片共享应用程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-18T03:43:26.297

这对我有用....但它假定 com.instagram.android 的包名称，我想它可能会更改，恕不另行通知。

```
private void shareToInstagram(Uri imageUri){
    Intent i = new Intent(Intent.ACTION_SEND);
    i.setType("image/*");
    i.putExtra(Intent.EXTRA_STREAM, imageUri);
    i.setPackage("com.instagram.android");
    activity.startActivity(i);
} 
```

您可以随时检查是否使用 getPackageManager() 安装了 com.instagram.android 包......如果没有，则不要在意图中设置包名称，让应用程序选择器帮助用户选择应用程序与共享图像。

# android - ADK 1.0 设备无法与 Jelly Bean 一起使用，为什么？

> ID：11563427
> 
> 赞同：5
> 
> 时间：2012-07-19T14:49:21.320
> 
> 标签：android, arduino, android-4.0-ice-cream-sandwich, adk, android-4.2-jelly-bean

刚刚将久经考验的真正 ADK 配件连接到 Nexus 7 和 Galaxy Nexus - 并且无法连接并显示“无法读取设备协议版本”消息。以为板子死了，用 ICS 连接到 Nexus S - 工作得很好。在 Jelly Bean 升级之前也在 Galaxy Nexus 上工作过，因此可以排除硬件故障。

我一直在密切关注 ADK 公告，但不记得阅读或听说过有关此特定更改的任何内容，也不记得支持 ADK 2.0 的 Android 设备的向后兼容性。

[附件开发工具包 2011](http://developer.android.com/tools/adk/adk.html)指南说“Android 2.3.4（API 级别 10）及更高版本支持协议版本 1。Android 4.1（API 级别 16）及更高版本支持协议版本 2”，它没有说版本 1 4.1不支持，*如果*发现现有的硬件会被这样抛弃，那将是非常奇怪的。

我在这里想念什么？这是错误还是功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T23:41:58.157

去年发布的旧 ADK1 库无法识别 JellyBean 设备（Android 4.1 及更高版本）使用的新 AOA v2 协议。这已在更新的 ADK1 库版本中得到修复。

去获取新的 ADK1 库：

*   [http://developer.android.com/tools/adk/adk.html](http://developer.android.com/tools/adk/adk.html)（在 zip 下载中查找“release_20120606”或更高版本）

更新您的 ADK 库并上传您的 ADK1 草图。请注意，新库已更新为与 Arduino 1.0 及更高版本一起使用，因此您可能还必须更新您的 Arduino IDE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T00:12:31.583

在回复@Chris Stratton 时，问题是原始库的编写并未考虑到未来的兼容性。

原始库假设（通过`protocol == 1`签入`switchDevice()`）未来的协议版本将不会向后兼容。从 20120606 库版本（通过修订`protocol >= 1`签入的暗示`switchDevice()`）看来，现在的意图是未来的库版本有望向后兼容。

不幸的是，这意味着使用库的原始版本编译的现有固件与 Jelly Bean 设备不兼容。固件需要使用新的库版本重新编译并重新上传到附件。

另请注意，当我写这篇文章时，文档中有一个错误，其中侧栏中的“ADK 包”链接链接到较旧的库版本，而不是正文中链接的较新版本。（我为此添加了一个错误：[https](https://code.google.com/p/android/issues/detail?id=35463) ://code.google.com/p/android/issues/detail?id=35463 ）

附加信息：

*   请注意`http://developer.android.com/tools/adk/aoa2.html#detecting`：“该协议的 2.0 版本向上兼容，因此为原始附件协议设计的附件仍然适用于较新的 Android 设备。” 但这忽略了原始库的问题。

*   另请注意，`http://developer.android.com/tools/adk/adk.html#start-adk` *和* `http://developer.android.com/tools/adk/aoa2.html#detecting`中的代码都使用了`protocol >= 1`咒语。（我无法验证这一点，但鉴于原始库未使用此版本的检查，我认为 ADK2011 文档已更新为使用新检查。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-04T22:42:36.517

我已经设法用我的 Jelly Beans 设备运行旧的 ADK。以下是详细信息：

*   在 Mac OS 上运行 Mountain Lion
*   使用 Arduino Mega ADK
*   带有 4.1.1 的三星 Galaxy S3

脚步：

1.  下载 darduino-1.0.1-macosx
2.  清空 Documents/Arduino 文件夹
3.  在其中创建一个文件夹库
4.  从 labs.arduino.cc/uploads/ADK/GettingStarted/ArduinoADK-beta-001.zip 下载 USB 兼容性文件。
5.  解压后将 ArduinoADK-beta-001/libraries/UsbHost 文件夹复制到上述库文件夹中。
6.  获取 AndroidAccessory 文件夹并将其复制到库中。Soory，我记得我从哪里得到的。有必要这样代码才能编译，因为知道附件是什么。此文件夹特别包含 AndroidAccessory.cpp 和 AndroidAccessory.h
7.  启动 Ardoinu，例如将代码上传到您的开发板（请在包含和定义之前插入 #，代码格式不显示）：

    包括<Max3421e.h> 包括<Usb.h> 包括<AndroidAccessory.h> 定义ARRAY_SIZE 12；

    AndroidAccessory acc("Manufacturer", "Model", "Description", "Version", "URI", "Serial");

    char hello[12] = {'h', 'e', 'l', 'l', 'o', '', 'w', 'o', 'r', 'l', 'd'} ;

    无效设置（） { Serial.begin（115200）；// acc.powerOn(); acc.begin(); }

    无效循环（）{

    if (acc.isConnected()) { for (int i=0; i < 12; i++) { Serial.print(hello[i]); 延迟（250）；}

    序列号.println(); 延迟（250）；} }

    1.  通过 USB 连接 S3 时，您应该在串行监视器中看到输出。

最好的问候 FL

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-02T17:34:55.420

只需将固件从 (protocol==1) check 更改为 (protocol>=1) 对我有用（至少对于枚举 - 发送和接收仍然需要测试）。我的硬件是 LPC1768 mbed。（[http://mbed.org/cookbook/mbed-with-Android-ADK](http://mbed.org/cookbook/mbed-with-Android-ADK)）

# python - df.set_index() 中的浮点与整数行为

> ID：11563435
> 
> 赞同：0
> 
> 时间：2012-07-19T14:49:41.143
> 
> 标签：python, pandas

在最新的 pandas 版本（0.8）中，set_index 是否发生了巨大变化？我无法让它按预期工作：

我最初的尝试试图在“id”上设置索引

```
ipdb> merged2['id']
16    130809
25    130687
32    130686
9      41736
22    131913
7     130691
33    129993
13    130680
28    134295
29    130708

ipdb> merged2.set_index('id') 
```

> ```
> *** KeyError: 0 
> ```

```
ipdb> [type(i) for i in merged2['id']]
[<type 'numpy.float64'>, <type 'numpy.float64'>, <type 'numpy.float64'>, <type 'numpy.float64'>, <type 'numpy.float64'>, <type 'numpy.float64'>, <type 'numpy.float64'>, <type 'numpy.float64'>, <type 'numpy.float64'>, <type 'numpy.float64'>] 
```

当前索引是 int：

```
ipdb> merged2.index
Int64Index([16, 25, 32,  9, 22,  7, 33, 13, 28, 29])

ipdb> [type(i) for i in merged2.index]
[<type 'numpy.int64'>, <type 'numpy.int64'>, <type 'numpy.int64'>, <type 'numpy.int64'>, <type 'numpy.int64'>, <type 'numpy.int64'>, <type 'numpy.int64'>, <type 'numpy.int64'>, <type 'numpy.int64'>, <type 'numpy.int64'>] 
```

一种解决方法尝试构建一个新索引：

```
ndx=range(len(merged2))
[type(i) for i in ndx]
[<type 'int'>, <type 'int'>, <type 'int'>, <type 'int'>, <type 'int'>, <type 'int'>, <type 'int'>, <type 'int'>, <type 'int'>, <type 'int'>]

ipdb> merged2.set_index(ndx) 
```

> ```
> *** KeyError: 'no item named 0' 
> ```

最后，将我的索引映射为 int 工作：

```
merged2['id']=map(lambda x: int(x), merged2['id']
merged2.set_index('id') 
```

关于我做错了什么的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:32:03.447

它似乎在 0.8.1dev 上对我有用。您可以发布堆栈跟踪和/或 merge2 的样子吗？另外你确定你使用的是熊猫 0.8 吗？

```
In [50]: import pandas as pd

In [51]: idx = pd.Index([16, 25, 32, 9, 22, 7, 33, 13, 28, 29])

In [52]: idx
Out[52]: Int64Index([16, 25, 32,  9, 22,  7, 33, 13, 28, 29])

In [53]: df = DataFrame(np.random.randn(len(idx), 3), idx, ['id', 1, 2])

In [54]: df
Out[54]: 
          id         1         2
16  0.351188  2.082303 -0.143037
25  0.633243 -1.731306  0.749934
32 -0.337893 -0.264249 -0.549856
9  -0.728056  0.786955  1.103877
22  1.131559 -0.255439 -0.397913
7  -1.384519  0.397626 -0.421481
33  1.356455  2.863659 -2.060498
13 -0.355786 -0.051383 -0.609486
28 -0.056607  0.767800  1.433946
29 -0.288202 -0.437992  0.843746

In [55]: df.set_index('id')
Out[55]: 
                  1         2
id                           
 0.351188  2.082303 -0.143037
 0.633243 -1.731306  0.749934
-0.337893 -0.264249 -0.549856
-0.728056  0.786955  1.103877
 1.131559 -0.255439 -0.397913
-1.384519  0.397626 -0.421481
 1.356455  2.863659 -2.060498
-0.355786 -0.051383 -0.609486
-0.056607  0.767800  1.433946
-0.288202 -0.437992  0.843746

In [56]: pd.__version__
Out[56]: '0.8.1.dev-e2633d4' 
```

# jquery - Django：如何通过 jquery 创建多个控件？

> ID：11563440
> 
> 赞同：0
> 
> 时间：2012-07-19T14:49:46.943
> 
> 标签：jquery, django

我设法编写了一个 jquery 来执行以下操作：

*   在多选中选择新项目后，jquery 将加载具有特定 url 的 div 项目并检索输入小部件以将其放置在那里。

首先将 onChange 事件附加到选择小部件：

```
$(document).ready(function () {
  $("#id_deals").change(deal_edit_func);
}); 
```

现在将选定的值发送到 url

```
function deal_edit_func(e) {
  var item = $('#deal_status')
  var selected = $(e.target).val();
  item.load(
    "/deal_status/" + selected,
    null
  );
  return false;
} 
```

视图内：

```
def _deal_status_view(request, deal_id):
    ids = deal_id.split(',')
    deal_status = DealStatus.objects.all()
    variables = RequestContext(request, {'deal_statuses': deal_status, 'ids': ids})
    return render_to_response('_deal_status.html', variables) 
```

**_deal_status.html：**

```
<input type="text" value="{{deal_status}}" name="deal_status"> 
```

只要只选择了一项，就会返回一个输入并将其加载到 div 标签中。这很好用。

现在我需要将此解决方案扩展为，只要选择了多个项目，就会返回多个输入，而不是像上面那样只返回一个。但这就是我卡住的地方。我到底要如何做到这一点？html 将始终是固定的...

任何帮助，将不胜感激，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:58:40.380

您可以将您的响应[序列化为其他格式（例如 xml、json），这些格式可以很容易地被 jquery 或 javascript 解析。](https://docs.djangoproject.com/en/dev/topics/serialization/)因此，您的视图将返回多个序列化对象，然后您的 javascript 将处理返回的对象。

# css - 画布本身被拖动后，画布上的元素会跳转

> ID：11563444
> 
> 赞同：1
> 
> 时间：2012-07-19T14:49:54.950
> 
> 标签：css, debugging, html5-canvas, drag, css-transforms

如前所述，画布上的元素在画布本身被拖动后会跳转。我正在使用 -webkit-transform: translate(x,y) 来拖动画布。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-06T03:15:16.870

在 CSS 中查找导致重排的更改：

*   可见性：隐藏/可见
*   显示：无
*   ：徘徊

和 JavaScript：

*   offsetWidth 或 offsetHeight
*   滚动事件

> 关于 CSS3 选择器的可悲事实是，如果您关心页面性能，则根本不应该使用它们。用类和 id 装饰您的标记并仅在这些上进行匹配，同时避免使用兄弟、后代和子选择器，实际上会使页面在所有浏览器中的性能显着提高。使用父选择器，很容易意外地导致文档范围内的 grovel。人们可以并且将会滥用这个选择器。支持它就是给人们很多绳子来吊死自己。
> 
> 完整的配置文件适用于对性能不是非常敏感的上下文。例如，选择器 API 规范 [SELECTORS-API] 的实现应该使用“完整”配置文件。它包括本文档中定义的所有选择器。
> 
> 符合选择器级别 4 的 CSS 实现必须使用“快速”配置文件进行 CSS 选择。
> 
> 快速配置文件适用于任何上下文，包括动态浏览器 CSS 选择器匹配。它包括本文档中定义的每个选择器，除了：
> 
> :matches()、:not()、:nth-match() 和 :nth-last-match() 中的组合子。
> 
> 参考组合器
> 
> 主题指标
> 
> 特别是，在浏览器正在查看它正在考虑的大多数选择器与所讨论的元素不匹配的情况下。所以问题变成了决定选择器不能尽可能快地匹配的问题。如果在匹配的情况下需要做一些额外的工作，您仍然会赢，因为您在不匹配的情况下节省了所有工作。

使用浏览器特定的选择器来定位文档本身：

```
@-moz-document url-prefix() 
  {  
  @media all
    {
    .foo { color: red } /* Firefox */
    }
  }

*::-ms-backdrop, .foo { color: red } /* IE11 */

*:-webkit-any-link, .foo { color: red } /* Webkit */ 
```

如果要根据上下文引用子元素，请使用 HTML5 和 CSS3 命名空间的 XML 序列化：

```
@namespace m "http://www.w3.org/1998/Math/MathML/";

m|math { border: 1px solid blue; } 
```

如果要基于父伪类显示子元素，可以定义子元素的默认状态，然后为父元素的每次状态变化重新定义：

```
li:hover > a * { display: none; }

li:hover > a:hover * { display: block; } 
```

**参考**

*   [XHTML5 + CSS 命名空间](http://matt.garrish.ca/2013/02/xhtml5css-namespaces/)

*   [CSS 选择器：你应该优化它们以更好地执行吗？](http://www.vanseodesign.com/css/css-selector-performance/)

*   [CSS 选择器的性能影响](http://www.stevesouders.com/blog/2009/03/10/performance-impact-of-css-selectors/)

*   [为什么浏览器从右到左匹配 CSS 选择器？](https://stackoverflow.com/questions/5797014/1113227#5813672)

*   [建议的 CSS 扩展列表](http://www.w3.org/TR/NOTE-CSS-potential)

*   [强制元素自行清除其子项](http://css-tricks.com/snippets/css/clear-fix/)

*   [IE8“悬停”错误：有史以来最棒的 IE 错误？](http://fairwaytech.com/2012/02/the-ie8-hover-bug-the-most-awesome-ie-bug-ever/)

*   [MDN：@文档](https://developer.mozilla.org/en-US/docs/Web/CSS/@document)

*   [CSS 选择器级别 4 的问题](https://wiki.csswg.org/spec/selectors)

*   [重排和重绘：CSS 性能让你的 JavaScript 变慢](http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/)

*   [浏览器如何工作](http://www.html5rocks.com/en/tutorials/internals/howbrowserswork/)

# visual-studio-2010 - 使用 TFS 2010 构建 WCF 项目的问题

> ID：11563447
> 
> 赞同：0
> 
> 时间：2012-07-19T14:49:58.273
> 
> 标签：visual-studio-2010, wcf, tfs, msbuild

我有一个 WCF 项目，其中包含一个 .svc 文件和一些 .config 文件。我正在尝试在 TFS 2010 中创建一个构建定义，它将这些文件复制到另一台机器上的 IIS 文件夹中。

我使用构建 XAML 模板中的 CopyDirectory 任务对其他 MVC 项目进行了类似的操作。在这些文件中，我从 _PublishedWebsites 文件夹复制到 IIS 文件夹。但是，对于 WCF 项目，没有 _PublishedWebsites 文件夹。

因此，我尝试更新 WCF 项目的 MSBuild 脚本以创建 _PublishedWebsites 文件夹并将文件复制到其中。这在我在 Visual Studio 2010 中本地构建时有效。但是当它在 TFS 构建服务器上运行时，它并不完全有效。

我看到的是在“C:\Builds\1\PROJECT\PROJECT (Continuous Build)\Sources\PROJECT\bin\_PublishedWebsites”中，我可以看到所有文件。

我猜这个“1文件夹”是一个用于构建的临时文件夹......？我不确定它是用来做什么的。但是当我查看构建的实际放置位置时，在“C:\Builds\PROJECT (Continuous Build)\PROJECT_BUILDNUMBER\”中，除了日志文件，我什么也看不到。“1 文件夹”中的所有文件都不存在。

请注意，同样的解决方案也有一个 WiX 项目来创建部署包。这似乎构建得很好，并且毫无问题地显示在放置位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T12:13:59.130

`"1 folder" is a temporary folder used for building`
是的。“1”是构建机器上构建代理（实际执行构建活动的服务）的数量。

`But when I look at the actual drop location for the build, in "C:\Builds\PROJECT (Continuous Build)\PROJECT_BUILDNUMBER\", I see nothing except log files.`
- 通常“复制文件到放置位置”标志负责。

# jquery - 交叉触发jquery代码

> ID：11563449
> 
> 赞同：1
> 
> 时间：2012-07-19T14:50:03.963
> 
> 标签：jquery, html, css

我需要有一个可缩放的图像，`<div>`此时我有一个以可缩放为中心的图像，我有一个`<div>`用作包装器，`<div>`它是可缩放的并保存图像。我有一些 jquery 代码可以计算 . 的宽度`<body>`并获取`<div>/<img />`. 网站内容为745px；所以窗口的其余部分将留给 div 和图像。这就是我现在所拥有的：

```
<div class="ad_banner_holder" id="ad_banner_holder" style="width: 100%;">
    <div class="ad_banner" id="ad_banner" style="background: white; text-align: center; position: absolute;">
        <a href="http://www.finconsult.ro/" target="_blank"><img id="the_ad" style="position: fixed; max-width: 800px; margin-top: 82px;" src="http://ww1.particularul.ro/images/ads/3rdtry2.jpg" /></a>
    </div>
</div>

<script type="text/javascript">
    $(window).load(function () {
        var adwidth = $("body").width();
        adwidth = adwidth - 760;
        $("#the_ad").css("width", adwidth);
        $("#ad_banner").css("width", adwidth);
    });
    $(window).resize(function () {
        var adwidth = $("body").width();
        adwidth = adwidth - 760;
        $("#ad_banner").css("width", adwidth);

    });
    $(window).resize(function () {
        var adwidth = $("#ad_banner").width();
        $("#the_ad").css("width", adwidth);

    });
</script> 
```

问题是当浏览器调整大小时脚本可以完美运行。当您刷新页面时，浏览器将图像居中，然后将其从右边的点调整大小（远离中心点）；我不明白为什么相同的代码不适用于不同的触发器。

此外，我尝试将图像调整大小的触发器更改为`.hover()`并且它的作用相同：居中的图像的宽度发生了变化并远离中心移动。

任何帮助/解释将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:23:30.363

你不仅有两个调整大小的功能，而且你应该只使用标准的 jquery 来检测页面何时加载。

```
$(function() {
    var adwidth = $("body").width();
    adwidth = adwidth - 760;
    $("#the_ad").css("width", adwidth);
    $("#ad_banner").css("width", adwidth);

    //combine the two resize handlers

    $(window).resize(function() {
        var adwidth = $("body").width();
        adwidth = adwidth - 760;
        $("#ad_banner").css("width", adwidth);

    });
    $(window).resize(function() {
        var adwidth = $("#ad_banner").width();
        $("#the_ad").css("width", adwidth);

    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:33:23.200

你可以结合一切：

```
<script type="text/javascript">
    $(document).ready(function(){
        var adwidth; // can be used in this scope

        // your resize function is factorized
        function resizeAd(){ 
            adwidth = $("body").width() - 760;
            $("#the_ad").css("width", adwidth);
            $("#ad_banner").css("width", adwidth);
        }

        // launched at DOM ready and on window's resize event
        resizeAd();
        $(window).on('resize', function(){
            resizeAd();
        });
</script> 
```

# sql-server - Service Broker -- 如何从 XML 消息中提取行？

> ID：11563452
> 
> 赞同：2
> 
> 时间：2012-07-19T14:50:13.390
> 
> 标签：sql-server, service-broker

假设我有以下情况（用于演示）。简单表内容被转换为 XML 值，并通过 Service Broker 发送到另一个 SQL 服务器，其中的结果`SELECT`将以非 XML 形式存储（即通常的简单数据库表）。咱们试试吧：

```
CREATE TABLE tab (a int, b int, c int);
GO

INSERT INTO tab (a, b, c) VALUES (1, 11, 111);
INSERT INTO tab (a, b, c) VALUES (2, 22, 222);
INSERT INTO tab (a, b, c) VALUES (3, 33, 333);
INSERT INTO tab (a, b, c) VALUES (4, 44, 444);
GO

SELECT * FROM tab FOR XML RAW, TYPE;
GO 
```

将值捕获到消息时，它看起来像：

```
<row a="1" b="11" c="111" />
<row a="2" b="22" c="222" />
<row a="3" b="33" c="333" />
<row a="4" b="44" c="444" /> 
```

即单个多行字符串。比如说，我在目标机器上创建了完全相同的表结构：

```
CREATE TABLE tab_destination (a int, b int, c int); 
```

从 中提取行的最佳方法是什么`@msg`，以及如何将它们放入目标表？

谢谢，彼得

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:00:41.793

```
CREATE TABLE tab (a int, b int, c int); 
GO 

INSERT INTO tab (a, b, c) VALUES (1, 11, 111); 
INSERT INTO tab (a, b, c) VALUES (2, 22, 222); 
INSERT INTO tab (a, b, c) VALUES (3, 33, 333); 
INSERT INTO tab (a, b, c) VALUES (4, 44, 444); 
GO 

CREATE TABLE tab_destination (a int, b int, c int); 
go

declare @x xml = (SELECT * FROM tab FOR XML RAW, TYPE); 

insert into tab_destination (a, b, c)
select 
    x.value('@a', 'int'),
    x.value('@c', 'int'),
    x.value('@b', 'int')
    from @x.nodes('//row') t(x);
GO 

select * from tab_destination;
go 
```

是时候阅读[xml 数据类型方法了](http://msdn.microsoft.com/en-us/library/ms190798)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:12:46.930

和其他选项（虽然我更喜欢 Remus Rusanu 的例子。如果很多列和表结构是相同的，这有助于变得懒惰）：

```
declare @x xml = (SELECT * FROM tab FOR XML RAW, root('tab'), TYPE); 

Declare @docHandle int  
EXEC sp_xml_preparedocument @docHandle OUTPUT, @x

Select *
FROM OPENXML(@docHandle, 'tab//', 1) 
With dbo.Tab

EXEC sp_xml_removedocument @docHandle 
```

# android - 如何检查 Android 设备是否运行 Intel 处理器？

> ID：11563454
> 
> 赞同：4
> 
> 时间：2012-07-19T14:50:24.953
> 
> 标签：android

Android SDK 中是否有任何代码可以让我检查设备是否在英特尔处理器上运行？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:55:48.817

我认为您应该使用`Build.CPU_ABI`并`Build.CPU_ABI2`以某种方式检测正在运行的处理器。只需看看[`Build`](http://developer.android.com/reference/android/os/Build.html)给出的类：

> 从系统属性中提取的有关当前构建的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T14:56:01.817

据我所知，您真正需要了解处理器的 ISA 的唯一时间是您需要运行本机代码时。因此，一种方法是简单地在您的本机库中添加一个方法，该方法为不同的 ISA（MIPS、ARM、x86）返回不同的值。您只需要一个 JNI 调用即可获得您想要的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:05:16.110

我个人将其用作 hack，但也许您会发现它很有用。思路是用cat解析/proc/cpuinfo，并在上面查找GenuineIntel。我在一个应用程序上使用它。

正如我所说，这似乎是一个 hack，也许一个更有经验的 Android 开发人员可以提出更好的解决方案。

```
private boolean isAnIntel() {
   String[] args = {"/system/bin/cat", "/proc/cpuinfo"};
   cmd = new ProcessBuilder(args);

   Process process = cmd.start();
   InputStream in = process.getInputStream();
   byte[] re = new byte[1024];
   while(in.read(re) != -1){
    result = result + new String(re);
   }
   in.close();
   return result.indexOf("GenuineIntel") > 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T14:59:05.697

不要忘记 android 是 LINUX 所有 CPU 信息都在文件“/proc/cpuinfo”上 如果处理器是 intel，那么该文件中 vendor_id 的值将是 GenuineIntel。(vendor_id : GenuineIntel)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-25T04:30:49.820

在英特尔博客上有文章[https://software.intel.com/en-us/blogs/2014/12/16/how-to-identify-the-image-is-32-bit-or-64-bit-](https://software.intel.com/en-us/blogs/2014/12/16/how-to-identify-the-image-is-32-bit-or-64-bit-user-space)他们建议使用自 Android 5.0 以来更改 API的`ro.product.cpu.abi`属性或再次使用[的用户空间](https://software.intel.com/en-us/blogs/2014/12/16/how-to-identify-the-image-is-32-bit-or-64-bit-user-space)`Build`

```
CPU_ABI
CPU_ABI2
SUPPORTED_32_BIT_ABIS
SUPPORTED_64_BIT_ABIS
SUPPORTED_ABIS 
```

# python - Runit 和 ClouldStack python API - TypeError：+ 不支持的操作数类型：'NoneType' 和 'str'

> ID：11563456
> 
> 赞同：0
> 
> 时间：2012-07-19T14:50:28.840
> 
> 标签：python, daemon

我正在使用 python ClouldStack API 连接到我的云提供商。

```
 cloudstack = CloudStack.Client() 
```

在 $HOME 我必须使用我的 api 凭据创建以下文件，例如

```
/root/.cloudstack 
```

如果我从命令行从根目录运行 python 脚本..它可以工作。但是，当使用 runit 运行脚本时，出现以下错误。

```
Traceback (most recent call last):
  File "/home/ubuntu/workspace/rtbopsConfig/rtb_remote_services/remote_chef_dp_redis_monitor.py", line 27, in <module>
    import chefUtilities as chefu
  File "/home/ubuntu/workspace/rtbopsConfig/classes/chefUtilities.py", line 29, in <module>
    import dpClouldStack as dpu
  File "/home/ubuntu/workspace/rtbopsConfig/classes/dpClouldStack.py", line 1, in <module>
    import CloudStack
  File "/usr/local/lib/python2.7/dist-packages/CloudStack-0.1-py2.7.egg/CloudStack/__init__.py", line 1, in <module>
    from Client import Client
  File "/usr/local/lib/python2.7/dist-packages/CloudStack-0.1-py2.7.egg/CloudStack/Client.py", line 1, in <module>
    from BaseClient import BaseClient
  File "/usr/local/lib/python2.7/dist-packages/CloudStack-0.1-py2.7.egg/CloudStack/BaseClient.py", line 12, in <module>
    config_file = env + '/.cloudstack'
TypeError: unsupported operand type(s) for +: 'NoneType' and 'str' 
```

这是我的 runit 运行文件的样子。

```
#!/bin/sh
exec 2>&1
exec /usr/bin/python /home/ubuntu/workspace/test.py >> /tmp/remote_chef_elb_monitor.out 2>&1 
```

那么... runit 在 root 下运行吗？如果是这样，它不会文件/root/.cloudstack 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:00:58.980

**由于您没有显示代码，**因此我只能提供帮助，因为我可以告诉您的`env`变量是`None`. 要么你从一个在所有情况下都不能正确返回它的函数中得到它，要么是出现了其他问题。

# html - 如何防止 HTML 元素上的这些“选定”工件？

> ID：11563458
> 
> 赞同：1
> 
> 时间：2012-07-19T14:50:35.217
> 
> 标签：html, css

有时点击并不完美，鼠标可能会轻微移动，按钮/元素最终会在它们周围出现一些“选定”的工件，如下所示：

![在此处输入图像描述](../Images/14146caeb7409f4313bc2f714e098ae3.png)

当然点击某处可以摆脱它，但它有点烦人并且看起来很糟糕。有什么办法可以禁用它，使应用程序看起来更可靠？

HTML/CSS：

```
<td id="controls">
      <span id="ccw" class="menuitem"></span>
      <span id="cw" class="menuitem"></span>
      <span id="zin" class="menuitem"></span>
      <span id="zout" class="menuitem"></span>
</td>

#cw{
   background-image:url('icons/rotatecw.png');
}

#ccw{
   background-image:url('icons/rotateccw.png');
}

#zin{
   background-image:url('icons/zoom_in.png');
   margin-top: 2px;
}

#zout{
   background-image:url('icons/zoom_out.png');
   margin-top: 2px;
}

.menuitem{
   background-repeat:no-repeat;
   width: 32px;
   height: 16px;
   display: inline-block;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:57:05.807

在许多浏览器中（除了 IE10 之前的 Opera 和 IE），您可以使用`user-select`它的各种浏览器前缀。有关详细信息，请参阅[MDN 文档](https://developer.mozilla.org/en/CSS/-moz-user-select)。

```
.controls {
    -moz-user-select: none;  
    -webkit-user-select: none;  
    -ms-user-select: none;  
    user-select: none;
} 
```

# javascript - 钛布局

> ID：11563459
> 
> 赞同：1
> 
> 时间：2012-07-19T14:50:41.287
> 
> 标签：javascript, iphone, titanium, titanium-mobile

在钛移动应用程序中，我有一个滚动视图，其中包含 25% 的屏幕宽度的对象，试图创建这些对象的“表”，有 4 列，但有很多行。有没有办法让父 scrollView 以这种方式布置这些？我在滚动视图上尝试了垂直和水平布局，但都没有给出所需的布局。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T18:17:00.343

据我了解，您正在寻找的是一次滚动 4 个表格视图/滚动视图。这个模块应该可以帮助你：[https ://github.com/appcelerator/titanium_modules/tree/master/tandemscroll/mobile/ios](https://github.com/appcelerator/titanium_modules/tree/master/tandemscroll/mobile/ios)

查看如何使用 Titanium 模块的示例代码：[https ://github.com/appcelerator/titanium_modules/blob/master/tandemscroll/mobile/ios/example/app.js](https://github.com/appcelerator/titanium_modules/blob/master/tandemscroll/mobile/ios/example/app.js)

我不知道这是否适用于表格视图，但您可以使用滚动视图并模仿表格视图的行为并构建您的自定义函数来伪造行。但是你可以尝试一下，看看什么最适合你。

Tandemscroll 是一个允许您锁定多个滚动视图的滚动的模块，这应该非常适合您的情况。

# ios - 除非重新打开应用程序，否则不会显示 UIAlertView 键盘

> ID：11563461
> 
> 赞同：0
> 
> 时间：2012-07-19T14:50:45.513
> 
> 标签：ios, ios5, uialertview

当用户打开我的应用程序时，我想检查存储在默认值中的值，如果不存在，则提示用户输入一个值。该值的存储/读取似乎正在工作。

```
-(void) viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    NSLog(@"Checking if there is an email address set");
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSString * emailAddress = [defaults objectForKey:@"emailAddress"];
    if (IsEmpty(emailAddress))
    {
        NSLog(@"email address is blank, prompting user to enter one..");
        self.emailPromptAlert = [[UIAlertView alloc] initWithTitle:@"Alert"
                                                          message:@"Enter Email address:" 
                                                         delegate:self 
                                                cancelButtonTitle:@"Cancel" 
                                                otherButtonTitles:@"OK", nil];
        [self.emailPromptAlert setAlertViewStyle:UIAlertViewStylePlainTextInput];
        [self.emailPromptAlert setTag:1];
        [self.emailPromptAlert show];
    }
} 
```

我遇到的问题是，当我对我的应用程序进行全新安装并首次加载时，警报按预期显示，但没有显示键盘，因此用户实际上无法输入任何内容。

单击主页按钮，然后再次将应用程序带回前台，屏幕上显示相同的警报，但这次实际显示的是键盘。

我该怎么做才能确保第一次显示键盘？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:17:04.997

这是一个奇怪的行为，你为什么不尝试在下一个运行循环中显示警报

```
[self.emailPromptAlert performSelector:@selector(show) withObject:nil afterDelay:0]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-12T23:52:32.153

我有同样的问题。就我而言，在我显示警报时键盘已经可见。我通过在显示警报之前关闭键盘来解决它：

```
[myTextField resignFirstResponder];
[myAlert show]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:06:46.627

我不完全确定，但也许这可以工作？

```
self.emailPromptAlert = [[UIAlertView alloc] initWithTitle:@"Alert"
                                                      message:@"Enter Email address:" 
                                                     delegate:self 
                                            cancelButtonTitle:@"Cancel" 
                                            otherButtonTitles:@"OK", nil];
[self.emailPromptAlert setAlertViewStyle:UIAlertViewStylePlainTextInput];
[self.emailPromptAlert setTag:1];

[self.emailPromptAlert show];

//try this?
UITextField *textField = [self.emailPromptAlert textFieldAtIndex:0];
[textField becomeFirstResponder]; 
```

这并没有真正解决为什么它没有首先显示的问题的根源，但它可能是一个解决方案。

# app-engine-ndb - 直系父母的祖先查询

> ID：11563465
> 
> 赞同：0
> 
> 时间：2012-07-19T14:50:58.087
> 
> 标签：app-engine-ndb

我正在尝试使用 App Engine NDB 对递归结构进行建模：

```
class Root(ndb.Model):
    pass

class Node(ndb.Model):
    #Node can have either a Root, or another Node as parent
    pass

root_key = Key(Root, 1)
node_a = Key(Root, 1, Node, 2)
node_b = Key(Root, 1, Node, 3)
node_a_a = Key(Root, 1, Node, 2, Node, 4) 
```

从这里，我想查询 Root 实体的直系子实体。我能做的是查询根的*所有*后代：

```
Node.query(ancestor=root_key) # returns node_a, node_b, and node_a_a 
```

我想做的是：

```
Node.query(parent=root_key) # returns node_a, node_b 
```

但似乎ndb api不支持通过（立即）父键进行查询。希望我错了。期待阐明。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T20:36:08.047

这不是 NDB 限制——App Engine 数据存储区无法做到这一点。但是，您可以通过将父项的键（或其他一些唯一 ID）作为属性来轻松模拟此行为。

# spring - 集群中的弹簧集成+ cron +石英？

> ID：11563469
> 
> 赞同：8
> 
> 时间：2012-07-19T14:51:13.390
> 
> 标签：spring, triggers, quartz-scheduler, spring-integration

我有一个由 cron 表达式触发的 spring 集成流程，如下所示：

```
<int-ftp:inbound-channel-adapter id="my-input-endpoint" ...>
    <int:poller trigger="my-trigger"/>
</int-ftp:inbound-channel-adapter>

<bean id="my-trigger"
   class="org.springframework.scheduling.support.CronTrigger">
  <constructor-arg value="0 * * * * *" />
</bean> 
```

它工作正常。但是现在我必须扩展实现以使其集群就绪（在同一时间点仅在一个集群节点上执行作业）。

我的愿望是在集群模式下使用 Quartz 框架（将作业状态保存在数据库中）来触发这个集成流程。Quartz 提供了一个开箱即用的漂亮解决方案。唯一的问题是如何将 Quartz 与现有的 inbout-channer-adaptor 集成？“poller”的“trigger”属性只接受 org.springframework.scheduling.Trigger 的子类。我找不到“轮询触发器”和 Quartz 框架之间的任何桥梁。

提前谢谢了！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T15:49:01.693

这是一种方法...

将入站适配器上的自动启动属性设置为 false。

创建一个只触发一次的自定义触发器，立即...

```
public static class FireOnceTrigger implements Trigger {

    boolean done;

    public Date nextExecutionTime(TriggerContext triggerContext) {
        if (done) {
            return null;
        }
        done = true;
        return new Date();
    }

    public void reset() {
        done = false;
    }
} 
```

在您的石英作业中，获取对触发器和`SourcePollingChannelAdapter`.

当石英触发器触发时，进行石英工作

1.  适配器.stop()
2.  触发器.reset()
3.  适配器.start()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T13:23:33.157

加里的解决方案有效。这是我的春天背景：

```
<int-ftp:inbound-channel-adapter id="my-endpoint"
        auto-startup="false">
    <int:poller trigger="my-endpoint-trigger"/>
</int-ftp:inbound-channel-adapter>

<bean id="my-endpoint-trigger" class="com.my.FireOnceTrigger"/>

<bean id="scheduler" class="org.springframework.scheduling.quartz.SchedulerFactoryBean">

    <property name="triggers">
        <list>
            <ref bean="my-job-trigger" />
        </list>
    </property>

    <property name="schedulerContextAsMap">
        <map>
            <entry key="inputEndpoint"><ref bean="my-input-endpoint" /></entry>
            <entry key="inputEndpointTrigger"><ref bean="my-endpoint-trigger" /></entry>
        </map>
    </property>
</bean>

<bean id="my-job-trigger" class="org.springframework.scheduling.quartz.CronTriggerBean">
    <property name="cronExpression" value="0 * * * * ?" />
    <property name="jobDetail" ref="my-job" />
</bean>

<bean name="my-job" class="org.springframework.scheduling.quartz.JobDetailBean">
    <property name="jobClass" value="com.my.MyActivatorJob " />
</bean> 
```

和 MyActivatorJob 类：

```
public class MyActivatorJob extends QuartzJobBean implements {

private AbstractEndpoint inputEndpoint;

private FireOnceTrigger inputEndpointTrigger;

public void setInputEndpoint(final AbstractEndpoint pInputEndpoint) {
    this.inputEndpoint = pInputEndpoint;
}

public void setInputEndpointTrigger(final FireOnceTrigger pInputEndpointTrigger) {
    this.inputEndpointTrigger = pInputEndpointTrigger;
}

@Override
protected void executeInternal(final JobExecutionContext pParamJobExecutionContext)
throws JobExecutionException {

    inputEndpoint.stop();
    inputEndpointTrigger.reset();
    inputEndpoint.start();
} 
```

}

作为下一步，必须重构这个 spring 上下文，以使用更灵活的东西替换 schedulerContextAsMap 的使用，并能够定义更多激活和停用许多不同端点的作业。

到目前为止感谢加里！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T14:59:27.617

尝试按照您的建议集成石英和弹簧，但面临另外两个问题：

1.) 使用 Quartz 2.x 和 Spring 3.x 时出现 IncompatibleClassChangeError 异常。这是一个已知问题，但我没有找到任何解决方案。

2.) 将其他 spring bean 注入到 Quarz 作业实例中。我找到了一些解决方案，但没有一个适合我。我已经尝试过使用

```
<bean id="scheduler" class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="jobFactory">
        <bean class="org.springframework.scheduling.quartz.SpringBeanJobFactory" />
    </property>

    <property name="triggers">
        ...
    </property>

    <property name="schedulerContextAsMap">
        <map>
            <entry key="inputEndpoint" value-ref="my-endpoint" />
        </map>
    </property>
</bean> 
```

将其他 bean 注入到作业中，但是在将此属性添加到 SchedulerFactoryBean 之后，作业没有被执行（而且我没有看到任何异常）。删除属性“schedulerContextAsMap”会使作业再次运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-16T06:59:42.970

我还没有尝试过，但看到 Quartz 2 和 Spring 的兼容性问题似乎已经在 Spring 3.1.1 中得到修复。见[https://jira.springsource.org/browse/SPR-8889](https://jira.springsource.org/browse/SPR-8889)

# android - 获取通知字段

> ID：11563470
> 
> 赞同：0
> 
> 时间：2012-07-19T14:51:15.047
> 
> 标签：android, android-notifications

我正在制作一个包含通知的可访问性服务，我想知道是否可以获得图标位图和通知的“详细信息”，我知道tickertext 可以提供“通知的标题”，但我想访问显示“详细信息文本”的行以前是通知内容视图字段的“getText”方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T06:39:32.833

可以获得更多细节，甚至重建`Notification`对象。我没有对此进行测试，但它应该可以正常工作。

```
@Override
public void onAccessibilityEvent(AccessibilityEvent event) {
...
    if (event.getEventType() == AccessibilityEvent.TYPE_NOTIFICATION_STATE_CHANGED) {
        Parcelable parcelable = event.getParcelableData();
        if (parcelable instanceof Notification) {
            // Resource id within the package context of the notifying app.
            int icon = ((Notification) parcelable).icon;
            Resources res = getPackageManager().getResourcesForApplication(event.getPackageName());
            Drawable image = res.getDrawable(icon);
        }
    }
} 
```

# user-interface - 添加/删除 vtkActor 或调整它们的可见性会更好吗？

> ID：11563472
> 
> 赞同：5
> 
> 时间：2012-07-19T14:51:19.270
> 
> 标签：user-interface, vtk

我正在编写一个 GUI 来显示一个`vtkUnstructuredGrid`包含多个标量和向量的图形。目的是让用户决定他/她是否想要显示颜色图、字形矢量场或仅显示网格本身。

这基本上给了我四个演员：一个用于地图，一个用于字形，一个用于网格，最后一个用于颜色条。根据用户的选择，我需要单独显示网格，或者地图和颜色条，或者字形和颜色条。我可以独立地准备每个参与者并将它们存储为我的 GUI 的属性以供以后访问。

我想知道什么是只呈现用户想要的最有效的方法：

*   根据用例（使用 a `.SetVisibility(True/False)`）切换每个参与者的可见性，或

*   在`vtkRenderer`.

任何见解将不胜感激。

- - 编辑 - -

一个推论是：当`vtkRenderer`渲染演员时，它会跳过不可见的演员还是渲染它们，然后隐藏它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T20:48:33.777

您是否注意到性能差异或其他什么？我会说这两种技术在运行时应该做完全相同的事情。

# java - EclipseLink 的 NamedQuery 中的 SUM 函数

> ID：11563473
> 
> 赞同：3
> 
> 时间：2012-07-19T14:51:21.723
> 
> 标签：java, jpa, eclipselink, jpql

我正在使用以下 NamedQuery 但出现错误

```
@NamedQueries({
    @NamedQuery(name="getAvailableAmount", query="SELECT sum(tup.tran_amount) FROM TopUpResponse tup"),
    @NamedQuery(name="getUpFrontDiscount", query="SELECT (sum( abs( tup.tran_amount) )*.04) FROM TopUpResponse tup WHERE tup.service='BILLPAYMENT'")
}) 
```

内部异常：FailedPredicateException(arithmeticPrimary,{ aggregatesAllowed() }?)

我尝试了以下格式但仍然出现错误

```
SELECT FUNC('ABS',tup.tran_amount) FROM TopUpResponse tup 
```

异常描述：语法错误解析查询 [getAvailableAmount: SELECT FUNC('ABS',tup.tran_amount) FROM TopUpResponse tup]，第 1 行，第 11 列：[(] 处的语法错误。内部异常：MismatchedTokenException(81!=32)

问候， 伊姆兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:25:56.420

这似乎是旧版本 EclipseLink 中的错误。我在 EclipseLink 2.0.0 中尝试了相同的查询。第二个命名查询和使用 FUNC 的查询完全按照您描述的方式失败，第一个命名查询工作。

在 EclipseLink 2.3.2 中，所有三个查询都按预期工作。因此，这些版本之间的某个问题得到了修复。我不知道在哪个版本中引入了确切的修复。

您唯一能做的就是更新到较新版本的 EclipseLink。

# android - 我在 Android 上没有收到电子邮件联系人

> ID：11563477
> 
> 赞同：0
> 
> 时间：2012-07-19T14:51:41.233
> 
> 标签：android, cursor, android-contacts, contactscontract

大家好。我需要通过联系人 ID 获取我在 android 中的电子邮件联系人。但它返回一个*空*值。不要返回任何东西，我不知道我在哪里失败了。

```
 public Cursor cursorEmailByContactId(long contactId) {

    Uri uri = ContactsContract.CommonDataKinds.Email.CONTENT_URI;

    String[] projection = new String[] { 
            ContactsContract.CommonDataKinds.Email.DATA,
            ContactsContract.CommonDataKinds.Email.TYPE,
            ContactsContract.CommonDataKinds.Email.LABEL,
            };

    String where = ContactsContract.CommonDataKinds.Email.CONTACT_ID
            + " = ? ";

    String[] whereParams = new String[] { String.valueOf(contactId) };

    String order = ContactsContract.CommonDataKinds.Email.IS_PRIMARY
            + " DESC, " + ContactsContract.CommonDataKinds.Email.DATA
            + " COLLATE LOCALIZED ASC";

    return ctx.getContentResolver().query(uri, projection, where,
            whereParams, order);

}
 Cursor cursorEmail = null;
 cursorEmail = sds.cursorEmailByContactId(idContacto);
 correioElectr = (EditText)findViewById(R.id.sfe_etEmail);
 try{
      if(cursorEmail.moveToFirst())
    do{
           sEmail = cursorEmail.getString(cursorEmail.getColumnIndex(ContactsContract.CommonDataKinds.Email.DATA));
   }while(cursorEmail.moveToNext());
 }finally{
if(cursorEmail != null && !cursorEmail.isClosed())
    cursorEmail.close();
 }  

 correioElectr.setText(sEmail); 
```

而且我在 correioElectr editText 中什么也没有。有人可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:59:01.543

像这样尝试 XMPP

[https://stackoverflow.com/questions/9885154/how-to-get-images-from-xmpp-in-android-application/10272947#10272947](https://stackoverflow.com/questions/9885154/how-to-get-images-from-xmpp-in-android-application/10272947#10272947)

# javascript - 在轨道上打印东西（字面意思是打印机）

> ID：11563480
> 
> 赞同：14
> 
> 时间：2012-07-19T14:51:50.380
> 
> 标签：javascript, html, ruby-on-rails, ruby-on-rails-3

我想知道 Rails 中是否有任何库或 gem 可用于打印网页的内容，就像通过打印机打印到纸上一样。我还想知道是否有任何方法可以指定只打印页面的特定部分（例如 div 或其他内容）？任何指针、建议或教程链接将不胜感激！

**编辑**

所以我尝试创建一个样式表，它将创建一个打印友好的视图，我们称之为“print.css”：

```
div.transpose-keys, div#editSong, div#navigation, div#debug{
    display: none;
} 
```

而且我想知道是否有任何方法可以仅在我的应用程序触发打印操作时应用它？因此，当单击以下链接时，应用程序会在打印之前应用上面的 css？这是我嵌入的 ruby​​ html 中的链接：

```
<%= link_to "PRINT", '#', onclick: "printpage()" %> 
```

最后我的javascript调用打印函数：

```
function printpage()
  {
  window.print()
  } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T15:40:30.817

如果你添加你的 print.css 如下

```
<link rel="stylesheet" type="text/css" media="print" href="print.css"> 
```

并使用浏览器打印对话框，它应该根据 print.css 中的样式自动格式化页面

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T15:41:08.760

我通过使用这个简单的解决方案解决了我的问题：

**打印.css**：

```
@media print {
  div.info, div#editStuff, div#navigation, div#debug {
    display: none;
  }
} 
```

@media 标签确保这些*不会*显示在印刷版本中

**应用程序.js**：

```
function printpage()
{
   window.print()
} 
```

**显示.html.erb**：

```
<%= link_to "PRINT", '#', onclick: "printpage()" %> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-02T14:00:19.223

```
<script type="text/javascript">     
        function PrintDiv() {    
           var divToPrint = document.getElementById('divToPrint');
           var popupWin = window.open('', '_blank', 'width=300,height=300');
           popupWin.document.open();
           popupWin.document.write('<html><body onload="window.print()">' + divToPrint.innerHTML + '</html>');
            popupWin.document.close();
                }
     </script> 
```

```
<%= image_tag("print.jpg", :width=>50, :height=>30, :onclick=>"PrintDiv();", :class=>'btn') %> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-19T15:04:04.430

我相信通常这样做的方式是打开一个“打印机友好”窗口，上面只有所需的信息，然后用户从那里通过他们的网络浏览器进行打印。您可以通过在该窗口中添加一些 javascript 使其更加用户友好：

```
window.print(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-19T15:27:20.970

我使用 wkhtmltopdf，[http://code.google.com/p/wkhtmltopdf/](http://code.google.com/p/wkhtmltopdf/)和 PDFKit，[http:](http://railscasts.com/episodes/220-pdfkit) //railscasts.com/episodes/220-pdfkit 。

RailsCast 将有一个完整的示例，而 wkhtmltopdf 是一个抓取和输出 PDF 文档的机架实用程序。

# sass - SASS：使用速记语法时出现语法错误

> ID：11563483
> 
> 赞同：0
> 
> 时间：2012-07-19T14:52:08.620
> 
> 标签：sass

我的 scss 文件是这样的：

```
@import "compass/typography/lists/bullets";
.view-content ul
  +no-bullets 
```

这给了我页面上的错误：

> 语法错误：“+no-bullets”后的 CSS 无效：预期为“{”，为“”

但是，当规则如下所示时：

```
.view-content ul {
  @include no-bullets;
} 
```

然后就没事了，子弹不见了。

但我喜欢速记符号，如何启用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:07:14.937

你是对的，我找到[了相关文档](http://sass-lang.com/docs/yardoc/file.INDENTED_SYNTAX.html)。

我尝试[了以下方法](https://gist.github.com/3146005)，它可以工作。

`;`然后，我尝试了你的，直到我删除了`import`指令的尾随，它才起作用。

```
@import "compass/typography/lists/bullets"

.view-content ul
  +no-bullets 
```

以下适用于 Compass 0.12.2。尝试删除指令的尾随`;`。`import`

# php - PHP ReadFile 在 readfile 中插入代码

> ID：11563484
> 
> 赞同：0
> 
> 时间：2012-07-19T14:52:08.930
> 
> 标签：php, file-io, insert

我有一个 php readfile 脚本，如下所示：

```
<?php
$contentFile = "http://google.com";
readfile( $contentFile );
?>` 
```

我想在 readfile 的输出中的特定行中插入代码。

例子：

```
<html>
{top_code}
{Code i want to insert here}
{bottom-code}
    </html> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T14:54:47.587

你不能。`readfile()`将您正在读取的任何内容流式传输到用户的浏览器。您可以改用输出缓冲机制来捕获该数据，但是您也可以[`file_get_contents()`](http://php.net/file_get_contents)改用它并为自己节省几行额外的代码。

file_get_contents 将请求的文件/url 作为字符串返回。然后，您使用标准[字符串](http://php.net/substr_replace)或[DOM](http://php.net/dom)操作来操作该“页面”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T00:07:55.747

我发现这是解决使用 PHP 而不使用 MYSQL 的 RSS 提要问题的解决方案，感谢[http://bavotasan.com/2010/display-rss-feed-with-php/](http://bavotasan.com/2010/display-rss-feed-with-php/)

```
$rss = new DOMDocument();
$rss->load('http://wordpress.org/news/feed/');
$feed = array();
foreach ($rss->getElementsByTagName('item') as $node) {
$item = array (
'title' => $node->getElementsByTagName('title')->item(0)->nodeValue,
'desc' => $node->getElementsByTagName('description')->item(0)->nodeValue,
'link' => $node->getElementsByTagName('link')->item(0)->nodeValue,
'date' => $node->getElementsByTagName('pubDate')->item(0)->nodeValue,
);
array_push($feed, $item);
}
$limit = 5;
for($x=0;$x<$limit;$x++) {
$title = str_replace(' & ', ' &amp; ', $feed[$x]['title']);
$link = $feed[$x]['link'];
$description = $feed[$x]['desc'];
$date = date('l F d, Y', strtotime($feed[$x]['date']));
echo '<p><strong><a href="'.$link.'" title="'.$title.'">'.$title.'</a></strong><br />';
echo '<small><em>Posted on '.$date.'</em></small></p>';
echo '<p>'.$description.'</p>';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:03:51.323

这可以完成工作

```
$contentFile = "http://google.com";
    $html = file_get_contents($contentFile);
    $html = explode("\n",$html);
    $line = $line_number - 1;
    array_splice($html, $line, 0,"Burim Shala");    
    $html = implode("\n",$html); 
```

# c# - 从链接下载文件

> ID：11563486
> 
> 赞同：5
> 
> 时间：2012-07-19T14:52:14.733
> 
> 标签：c#, asp.net, download

我有一个使用 C# 的网页，我希望用户能够单击链接（或链接按钮或按钮，我不挑剔）并出现“另存为”对话框窗口，以便他们可以下载文件。该文件本身位于另一台服务器上，因此我必须使用绝对路径（i:\division\department\publicfiles\filename.pot）。有谁知道这是怎么做到的吗？

我在这里查找了问题，有人建议使用 webClient.DownloadFile。除非我不能使用它，因为它要求您已经知道用户希望将文件下载到他们计算机上的哪个位置。基本上我正在寻找的是当您右键单击链接并选择“另存为”时会发生什么，但是当您左键单击链接时会完成。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:00:03.823

“文件本身位于另一台服务器上”对我来说听起来好像它可能没有发布到网络上，因此没有 URL。因此，在这种情况下，简单的锚标记将不起作用。我想你正在寻找[`Response.TransmitFile()`](http://msdn.microsoft.com/en-us/library/12s31dhy%28vs.80%29.aspx).

当他们单击链接时，您需要发送文件并明确设置内容类型和内容处置标头。将 content-disposition 标头设置为`attachment`将弹出另存为对话框。喜欢（未经测试）：

```
Response.ContentType = "application/x-pot";    
Response.AppendHeader("Content-Disposition","attachment; filename=filename.pot");    
Response.TransmitFile(@"i:\division\department\publicfiles\filename.pot");    
Response.End(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T14:56:31.250

你可以这样做，

```
<a href="http://www.yoursite.com/folders/yourfile.pdf"  target="_blank" > click to download file </a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-20T08:21:58.800

使用 HTML5，您可以只使用`download`锚标记中的新属性。

代码看起来像

```
<a download href="path/to/the/download/file"> Clicking on this link will force download the file</a> 
```

它适用于 Firefox 和 chrome 最新版本。我应该提到我没有在 IE 中检查它吗？:P

# gwt - GWT：堆栈面板内的树小部件在单击时会向上移动整个应用程序

> ID：11563488
> 
> 赞同：0
> 
> 时间：2012-07-19T14:52:35.433
> 
> 标签：gwt, tree, stackpanel

我有一个树小部件定义如下：

```
 Tree tree = new Tree();
        TreeItem root = new TreeItem("asdf");
    root.setSelected(true);
    root.addItem(new TreeItem("blah"));
    root.addItem(new TreeItem("blue"));
    root.addItem(new TreeItem("blahblah"));
    root.addItem(new TreeItem("dada")); 
```

然后我使用 .add() 将树添加到我的堆栈面板。

当我单击树面板中的任何节点时..整个应用程序将向上移动到窗口的顶部，所选节点位于最顶部。我没有附加任何点击处理程序。我怎样才能停止这个动作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T08:52:56.330

这`addDomHandler()`是`Widget`课堂的一部分。

`TreeItem`不**扩展**类`Widget`。

在扩展cals的`Tree`类本身上尝试建议的解决方法`Widget`

# html-agility-pack - 无法使用 Html-Agility-Pack 设置 InnerText

> ID：11563491
> 
> 赞同：3
> 
> 时间：2012-07-19T14:52:38.383
> 
> 标签：html-agility-pack

给定一个 HTML 文档，我想识别文档中的所有数字并在数字周围添加自定义标签。现在，我使用以下内容：

```
HtmlNodeCollection bodyNode = htmlDoc.DocumentNode.SelectNodes("//body");
MatchCollection numbersColl = Regex.Matches(htmlNode.InnerText, <some regex>); 
```

一旦我得到 numbersColl，我就可以遍历每个 Match 并获取索引。但是，我无法更改 InnerText，因为它是只读的。我需要的是，如果 match.Value = 100 和 match.Index=25，我想将 25 替换为 `<span isIdentified='true'> 25 </span>`

对此的任何帮助将不胜感激。目前，由于我无法修改内部文本，我必须修改 InnerHtml 但某些元素的 innerHtml 中可能有 25 个。那不应该被触及。但是我如何识别数字是否在 html 标签内，即 <table border='1' > 在标签中有 1。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-31T08:59:56.813

**这是我为解决Text节点的***InnerText*属性的只读属性限制所做的工作，只需选择 Text 节点的**Parent**节点，并注意父节点的子节点集合中 Text 节点的索引。然后只做一个.****`ReplaceChild(...)`****

 ****```
 private void WriteText(HtmlNode node, string text)
        {
            if (node.ChildNodes.Count > 0)
            {
                node.ReplaceChild(htmlDocument.CreateTextNode(text), node.ChildNodes.First());
            }
            else
            {
                node.AppendChild(htmlDocument.CreateTextNode(text));
            }
        } 
```

在您的情况下，我相信您需要创建一个新的 Element 节点，将文本包装到 HtmlElement 中，然后将其用作 Text 节点的替换。

或者甚至更好，看看你是否可以做类似这里发布的答案： [Replaceing a HTML div InnerText tag using HTML Agility Pack](https://stackoverflow.com/questions/9093792/replacing-a-html-div-innertext-tag-using-html-agility-pack?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-23T16:23:46.253

在这种情况下，创建一个 textnode 并不是它应该做的：

```
myParentNode.AppendChild(D.CreateTextNode("<script>alert('a');</script>"));
Console.Write(myParentNode.InnerHtml); 
```

结果应该类似于 <script....

但即使我将它添加为“TEXT”而不是 html，它也是一个工作脚本任务。这对我来说是一个安全问题，因为文本将是来自匿名用户的输入。****

# css - 带有详细文档的 CSS 框架

> ID：11563494
> 
> 赞同：0
> 
> 时间：2012-07-19T14:52:47.667
> 
> 标签：css, css-frameworks

我昨天开始使用 Zurb 的 Foundation 3，但他们随框架提供的文档并没有那么详细。是否有任何其他带有详细文档或书籍的 CSS 框架？链接或详细教程会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T14:58:41.703

Twitter 引导框架有很好的文档记录，背后有一个很好的社区：http: [//twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

# c# - 将数据添加到数据库时出现问题（添加了更多数据/参数）

> ID：11563497
> 
> 赞同：0
> 
> 时间：2012-07-19T14:52:59.177
> 
> 标签：c#, database

我有一个数据库，我将一些数据插入其中。我遇到的问题是它会添加更多的数据。

当 logfordb.pos 增加时，它将再次添加所有 prevoius 数据，下一次它将添加更多。

这是代码......减少了一些连接字符串和参数。

```
 public void WriteToDatabase(DatabaseLog logfordb)
    {
        conn.Open();

        var cmd = new SqlCommand();
        cmd.CommandText = "Insert INTO [X] (Y, Z, C " + "Values (@val1, @val2, @val3";

        for (int index = 0; index < logfordb.ListofDB[logfordb.pos].X.Count; index++)
        {
            cmd.Connection = conn;
            cmd.Parameters.Clear();
            if (logfordb.ListofDB[logfordb.pos].X[index].Details != null)
            {
                cmd.Parameters.AddWithValue("@val1", logfordb.ListofDB[logfordb.pos].X[index].Details.Age);
                cmd.Parameters.AddWithValue("@val2", logfordb.ListofDB[logfordb.pos].X[index].Details.Name);
                cmd.Parameters.AddWithValue("@val3", logfordb.ListofDB[logfordb.pos].X[index].Details.Etc);
                cmd.ExecuteNonQuery();
            }
        }
        conn.Close();

        logfordb.pos += 1;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:28:09.003

似乎您想更改 logfordb.pos 的值我想您想通过 ref 传递 logfordb。我怀疑这个值没有改变，第二次调用这个函数时，你最终会再次添加相同的数据，因为这个范围之外的值并没有被改变，只是函数看到的本地副本（然后存在破坏引用变化）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:34:46.697

每次调用时，您的代码都会遍历整个 logfordb。

你有三个选择：

1.  在此方法结束时，完全清除 logfordb。（可能是最有意义的）
2.  添加起始位置参数，让调用代码决定开始将logfordb记录推入数据库的位置。
3.  为 logfordb 中的每条记录添加一个“已存储”属性，以便您可以在存储该单独记录时设置它，而不是再次推送该记录。

其中，选项 1 可能是您最安全的选择。

# html - CSS 文件拒绝链接到 HTML 文件

> ID：11563501
> 
> 赞同：3
> 
> 时间：2012-07-19T14:53:06.027
> 
> 标签：html, css

我对网页设计领域还很陌生，但是，我遇到了一个让我很困惑的问题。我的 CSS 文件不会与我的 HTML 文件链接。我已经检查了一切（我认为）。文件路径相同，我用正确的语法链接了文件，但它仍然无法正常工作。我附上了一些照片，以帮助你们更好地了解我的问题。如果您需要更多信息，我很乐意提供。

第一张图片是我保存文件的文件夹。第二张是我用来链接 HTML 和 CSS 的语法。第三个和第四个文件是我的编辑器的截图，文件路径在上面。（是的，我知道 CSS 文件是空的。但由于它不能正常工作，我暂时将其留空）

![这是我保存文件的地方。](../Images/885e5559f8e00cadd4414c4fb3e4665e.png)

![这是我用来链接文件的语法。](../Images/873751bc62a71fb19251aa4f8d8bf09c.png)

![我的 HTML 上的文件路径。](../Images/a3d15b5e4d637e5188920fde1aff8ed6.png)

![我的 CSS 上的文件路径。](../Images/3d7cc72cd470e9a557b830690dde87d8.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T14:56:30.847

如果 CSS 为空，你怎么知道它不起作用？

键入`body { background-color: #f0f; }`以测试它是否正常工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:49:25.250

有时您需要强制浏览器使用最新的样式表。您可以通过在链接中添加查询字符串来实现此目的。

像这样：

```
<link rel="stylesheet" href="Joe.css?v=1.1" "type="text/css"/> 
```

如您所见，我在“Joe.css”之后添加了**?v=1.1**

然后，每次您对 CSS 文件进行一些更改时，只需更改版本号即可。所以在这种情况下，当您更新 CSS 文件时，您可以将数字更改为 ?v=1.2 等等。通过这样做，您将强制浏览器使用最新的 css。

但请注意，您应该只将其添加到链接而不是实际文件名 Joe.css - 保持不变。

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:07:03.547

你应该调试你的代码。

首先，将您的`<link>`标签替换为以下内容，看看它是否有效：

```
<style type="text/css">
    body { background-color: #000; }
</style> 
```

如果您的背景颜色变为黑色 - 这是一个好兆头。如果不是，则说明您的脚本或浏览器有问题。

* * *

接下来，将上面的代码替换为以下内容：

```
<link href="style.css" rel="stylesheet" type="text/css" media="all" /> 
```

`style.css` **在与 HTML 脚本相同的目录中**创建文件，并将以下代码放入其中：

```
body { background-color: #000; } 
```

如果这不起作用，则说明您的脚本或浏览器有问题。

* * *

顺便说一句，尝试清除您的浏览器缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:00:56.250

使用 Web 浏览器中的调试工具（例如 firefox 中的 Firebug 或 IE 中的 F12 开发人员工具）来查看您的网页正在加载哪些 CSS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T15:03:20.960

尝试使用语法：`body { background-image: url("Joe-Image/Joe-logo.png");}`你确定你在你的 html 文件中添加了 CSS 吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-19T15:23:28.097

试试这个：

```
<link href="./joe.css" rel="stylesheet" type="text/css" media="all" /> 
```

我插入了相对路径。你也可以试试这个：

```
<link href="./Joe.css" rel="stylesheet" type="text/css" media="all" /> 
```

带大写 j。也许您的网络服务器区分大小写？

# c++ - 英特尔 TBB 在并行线程中运行函数？

> ID：11563502
> 
> 赞同：2
> 
> 时间：2012-07-19T14:53:25.247
> 
> 标签：c++, multithreading, opencv, tbb

基本上我正在开发一个opencv应用程序。**我** 已经`with_tbb`在`cmake`.

我想使用 intel tbb 运行一个并行线程，该线程每隔一段时间会更新一些全局变量。就像是：

```
vector<int> mySharedVar;

void secondaryThreadFunction() {
 while(true) {
   Do some operations
   And update mySharedVar if necessarily  

   usleep(1000);
 }
}

int main() {
   run in parallel secondaryThreadFunction;

   in the master Thread keep doing something based on mySharedVar

   while(true) {
    do something;
   }
} 
```

如何`secondaryThreadFunction()`在另一个线程上运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:00:40.173

英特尔 TBB 并非旨在用于此类目的。引用[教程](http://threadingbuildingblocks.org/uploads/81/91/Latest%20Open%20Source%20Documentation/Tutorial.pdf)：

> 英特尔® 线程构建模块以线程为目标，以提高性能。大多数通用线程包支持许多不同类型的线程，例如图形用户界面中的异步事件线程。因此，通用包往往是提供基础的低级工具，而不是解决方案。相反，英特尔® 线程构建模块专注于并行化计算密集型工作的特定目标，提供更高级别、更简单的解决方案。

`boost::thread`您可以使用C++11 线程功能轻松实现您想做的事情：

```
 // using async
   auto fut = std::async(std::launch::async, secondaryThreadFunction);
   // using threads (for boost, just replace std with boost)
   std::thread async_thread(secondaryThreadFunction);

   in the master Thread keep doing something based on mySharedVar

   while(true) {
    do something;
   }

   // in case of using threads
   async_thread.join(); 
```

请记住同步对任何共享变量的访问。

# java - 根据其双键按比例选择值

> ID：11563507
> 
> 赞同：0
> 
> 时间：2012-07-19T14:53:48.710
> 
> 标签：java, types, random-access

我有一个值列表，用 0 到 1 之间的双精度键表示我认为某事物对我有用的可能性。例如，要获得问题的答案：

```
0.5   call your mom
0.25  go to the library
0.6   StackOverflow
0.9   just Google it 
```

因此，我们认为谷歌搜索它的帮助可能是询问你妈妈的（大约）两倍。当我试图找出下一步要做的事情时，我希望“只是谷歌它”的返回频率大约是“打电话给你妈妈”的两倍。

我一直在寻找解决方案，但收效甚微。我发现的大多数东西都依赖于整数键（例如[如何根据 Map 中的整数值相对于 O(n) 时间内的其他值随机选择一个键？](https://stackoverflow.com/questions/5212089/how-to-randomly-select-a-key-based-on-its-integer-value-in-a-map-with-respect-to)），我没有有并且我不能轻易生成。

我觉得应该有一些 Java 数据类型可以为我做到这一点。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:07:18.653

你可以想到一个基于java接口NavigableMap的解决方案，如果你使用TreeMap实现你总是会得到O(logn)的复杂度。

您可以使用以下方法之一：

*   较低的入口
*   天花板入口
*   楼层入口
*   更高的条目

现在您只需要以正确的概率提取随机数。为此，我会参考这篇文章：

[如何从指定的离散分布生成随机数？](https://stackoverflow.com/questions/4207238/how-to-generate-a-random-number-from-specified-discrete-distribution)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:11:27.610

如果我理解正确，您正在寻找的是加权随机数。
您应该将所有权重相加，并可能将其标准化为整数值，这样您就可以按照评论的建议使用 rand.nextInt 。
例如，可以通过乘以 100 来进行归一化，因此您的归一化权重现在为：
50、25、60、90 - 总和为 225。
您应该定义范围：
0 - 49 用于“打电话给你妈妈”
50 - 74 -用于“去图书馆”

现在您需要执行 this.rand.nextInt(sum) - 并获取一个值，
该值应映射到定义的范围之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:15:19.273

如果您跟踪概率的总值是多少，您可以执行以下操作：

```
double interval = 100;
double counter = 0;
double totalProbabilities = 2.25;
int randInt = new Random().nextInt((int)interval);
for (Element e: list) {
  counter += (interval * e.probability() / totalProbabilities);
  if (randInt < counter) {
    return e.activity();
  }
} 
```

# xpages - XPages Mobile Controls - sessionScope 变量丢失

> ID：11563516
> 
> 赞同：0
> 
> 时间：2012-07-19T14:54:20.643
> 
> 标签：xpages, xpages-extlib

我正在使用 XPages 扩展库中的移动控件为 iPhone 构建一个移动应用程序。

第一页显示类别列表（可能是用户名列表）。When a category is selected the second page is displayed listing all documents belonging to the selected user.

打开第二个页面的 URL 包含一个带有用户名的参数。第二页有一个页面标题控件，在“标签”属性上我添加了以下代码：-

```
if (param.get("User") != null) {
    sessionScope.put("UserName", param.get("User"));
}
return sessionScope.UserName; 
```

我这样做是为了让我可以访问后续页面上的用户名，例如，当用户从第二页的列表中打开文档时，会显示第三页。

当我在 Chrome 中测试它时，一切都很好。当我在 Safari 中进行测试时，我可以看到在打开第二页时设置了 sessionScope 变量。但是，当我选择一个文档并打开第三页时， sessionScope 变量正在消失。我看不到任何可以解释这一点的代码，并且在 Chrome 中测试时，第 3 页上的 sessionScope 变量仍然存在。不出所料，我在 iPhone 上测试时遇到了同样的问题。

这给我带来的问题是，当从文档 (p.3) 导航回所选用户的文档列表 (p.2) 时，我不知道最初选择了哪个用户。

有人以前见过这个或对可能发生的事情有任何解释吗？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T11:24:06.033

您可能希望避免使用参数方法，除非您首先对输入进行清理，因此不要将 URL 直接写入范围 - 甚至更容易 - 将第一个字段与类别绑定到 sessionScope。您是否尝试修改代码以使用不同的变量名？

# php - SQL：将两个选择合并到一个查询中

> ID：11563524
> 
> 赞同：1
> 
> 时间：2012-07-19T14:54:55.030
> 
> 标签：php, sql, join, merge, union

我想合并两个选择以进行一个查询以在 PHP 中使用。每个用户报时间，这个时间要么是正常时间（加班=0），要么是加班（加班=1）。

```
SELECT username, 
       userlastname,
       SUM(time0 + time1 + time2 + time3 + time4 + time5 + time6),
       userid,
       overtime 
FROM users, time 
WHERE timeyear = $y
      AND timeproid = $proid 
      AND userid = timeuserid
      AND timeweek = $week 
GROUP BY userlastname, username, userid, overtime 
```

我显示了一个表格，每个用户有两行，一列用于加班时间，另一行用于正常时间。我之所以选择加班，是因为如果加班 = 0 将加班时间显示为 0 否则将加班时间显示为 SUM(time0 + time1 + time2 + time3 + time4 + time5 + time6)

有什么办法可以将两者合并吗？试试这个[链接](http://s7.postimage.org/sljxioqfv/Screen_Shot_2012_07_19_at_16_27_52.png)：它现在的样子。我希望将 6 和 5.5 组合成 11.5，并将 5.5（加班）保留为 5.5

[看到这个](http://s7.postimage.org/sljxioqfv/Screen_Shot_2012_07_19_at_16_27_52.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:25:51.390

你可以这样做：

```
SELECT username,
       userlastname,
       SUM(CASE WHEN overtime = 0 THEN
              time0 + time1 + time2 + time3 + time4 + time5 + time6
           ELSE 0 END) AS normaltime,
       userid,
       SUM(overtime) AS overtime
FROM users, time 
WHERE timeyear = $y
  AND timeproid = $proid 
  AND userid = timeuserid
  AND timeweek = $week 
GROUP BY userlastname, username, userid; 
```

这应该给你加班时间的总和，以及其他时间的总和作为“正常时间”。如果我理解正确，您将加班时间记录在加班一栏中，而在其他地方记录不加班时间。

相反，如果您使用超时作为“标志”，表示“time0 现在超时”，那么您需要这样编写：

```
SELECT username,
       userlastname,
       SUM(CASE WHEN overtime = 0 THEN
              time0 + time1 + time2 + time3 + time4 + time5 + time6
           ELSE 0 END) AS normaltime,
       userid,
       SUM(CASE WHEN overtime != 0 THEN
              time0 + time1 + time2 + time3 + time4 + time5 + time6
           ELSE 0 END) AS overtime,
FROM users, time 
WHERE timeyear = $y
  AND timeproid = $proid 
  AND userid = timeuserid
  AND timeweek = $week 
GROUP BY userlastname, username, userid; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:58:12.587

您可以使用 CASE WHEN/THEN END 语法在查询中执行条件语句。

```
SELECT u.username, u.userlastname, CASE WHEN t.overtime = 1 THEN SUM(t.time0 + t.time1 + t.time2 + t.time3 + t.time4 + t.time5 + t.time6) ELSE 0 END as overtime, u.userid
FROM users u 
LEFT JOIN time t ON(u.userid=t.timeuserid)
WHERE t.timeyear = $y AND t.timeproid = $proid AND t.timeweek = $week 
GROUP BY u.userlastname, u.username, u.userid, t.overtime 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:35:23.573

否则工会是否满足您的需求（当然不是以性能为导向的最佳答案）？

```
SELECT username, 
       userlastname,
       SUM(time0 + time1 + time2 + time3 + time4 + time5 + time6) as overtime,
       userid,
       overtime 
FROM users, time 
WHERE timeyear = $y
      AND timeproid = $proid 
      AND userid = timeuserid
      AND timeweek = $week 
      AND overtime=1
GROUP BY userlastname, username, userid
union
SELECT username, 
       userlastname,
       0 as overtime,
       userid,
       overtime 
FROM users, time 
WHERE timeyear = $y
      AND timeproid = $proid 
      AND userid = timeuserid
      AND timeweek = $week
      AND overtime=0 
GROUP BY userlastname, username, userid 
```

# actionscript-3 - AS3 在文本字段中设置光标

> ID：11563526
> 
> 赞同：0
> 
> 时间：2012-07-19T14:54:57.743
> 
> 标签：actionscript-3, focus

我希望每当 Fla 运行时，焦点都将放在一个名为“inputField”的输入文本上。问题是，这不起作用：

```
stage.focus = vcam.inputField; 
```

这不起作用，是的，您可以键入 A - Z 和 0 - 9，但例如 Backspace 在该字段中不起作用，您必须先单击它。

另外，我有一个单独的函数来处理箭头键和 ENTER 键，因此 inputField 可能不会使用它们。

我知道他们唯一的方法是为每个按键制作这样的功能：

```
function inputHandle(event:KeyboardEvent):void
{

 if (event.keyCode == Keyboard./*keycode here*/)
  {
    vcam.inputField.text += "/*letter, number, or space*/";
  }

 if (event.keyCode == Keyboard./*another keycode here*/)
  {
    vcam.inputField.text += "/* anotherletter, number, or space*/";
  }

 /*And so on with every key*/
} 
```

但这似乎有点愚蠢，他们一定是一种更快的方法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:11:00.137

你能提供更多关于你的案子的细节吗？

因为这对我来说很好：

```
package {

    import flash.display.MovieClip;
    import flash.display.Sprite;
    import flash.events.MouseEvent;
    import flash.text.TextField;
    import flash.text.TextFieldType;

    public class asExample extends Sprite {

        public var inputTextField : TextField;

        public var focusButton : MovieClip;

        public function asExample() {
            inputTextField = new TextField();
            inputTextField.width = 300;
            inputTextField.height = 50;
            inputTextField.multiline = true;
            inputTextField.border = true;
            inputTextField.type = TextFieldType.INPUT;
            addChild(inputTextField);

            focusButton = new MovieClip();
            focusButton.x = inputTextField.x;
            focusButton.y = 60;
            focusButton.graphics.beginFill(0xFF0000);
            focusButton.graphics.drawRect(0, 0, 50, 50);
            focusButton.graphics.endFill();
            focusButton.addEventListener(MouseEvent.CLICK, onFocusButtonClick);
            addChild(focusButton);
        }

        private function onFocusButtonClick(event : MouseEvent) : void {
            stage.focus = inputTextField;
            inputTextField.setSelection(0, 0);
        }
    }
} 
```

# excel - 将 Excel HTML 转换为更简洁的 HTML

> ID：11563529
> 
> 赞同：3
> 
> 时间：2012-07-19T14:54:59.440
> 
> 标签：excel, html-table, excel-2003

有没有一种简单的方法可以将 Excel 2003 的“保存到 HTML”选项的输出转换为更“友好”的内容？我有一个大约 20 列和 50 行的 Excel 文档。

在整个保存的 HTML 文件中，我有过时的 HTML（例如：）`<table x:str border=0 cellpadding=0 cellspacing=0 width=1366 style='border-collapse: collapse;table-layout:fixed;width:1025pt'>`、线条样式和到处都是空单元格。

我想要一些不那么“table-y”的东西。有没有办法强制 Excel 2003 使用更多的 CSS 和更少的表格来保存它，或者有一种方法`div`比手动浏览 HTML 文件更容易将表格转换为 s？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-10T04:48:14.957

如果还有兴趣，Tidy 应该会整齐地完成手头的任务！

它似乎有点没有支持，所以希望找到一些麻烦，使其对您的需求有用。

无论如何，对于 POC，您可以依赖[http://infohound.net/tidy/](http://infohound.net/tidy/)上的在线版本。

只需检查“清洁”选项，让所有内容保持原样，即可获得接近您预期的结果。

问候和祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:26:58.830

如果你有 Dreamweaver，你可以使用它的标记清理工具……我相信它是为这类事情设计的。

在 Dreamweaver 中创建一个新的 HTML 文档，复制并粘贴您的代码，然后使用清理工具。

这是我找到的一个指南，但如果没有帮助，您可能会找到更好的指南：

[http://www.articleonlinedirectory.com/656381/cleaning-up-unwanted-formatting-dreamweaver.html](http://www.articleonlinedirectory.com/656381/cleaning-up-unwanted-formatting-dreamweaver.html)

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-24T15:42:35.487

在浏览器中打开 html 文件并在控制台中运行一些代码是一种方法，一个粗略的例子：

```
var whiteList = ["rowspan", "colspan"];

[...document.querySelectorAll("table")].forEach(table => {
  rmAttr(table);
  [...table.querySelectorAll("tr")].forEach(tr => {
    rmAttr(tr);
    [...tr.querySelectorAll("td")].forEach(td => {
      rmAttr(td);
    });
  });
  console.log(table.outerHTML);
});

function rmAttr(dom) {
  [...dom.attributes].forEach(attr => {
    if (!~whiteList.indexOf(attr.name)) {
      dom.removeAttribute(attr.name);
    }
  });
} 
```

# javascript - 扰流板显示代码

> ID：11563533
> 
> 赞同：0
> 
> 时间：2012-07-19T14:55:10.817
> 
> 标签：javascript

我对本页中的剧透有疑问：

[http://jdownloader.org/download/index](http://jdownloader.org/download/index)

当我点击**Windows**时，它会*出现*一个表格，但是当我点击**Linux**时，Windows 的内容就会*消失*。我想创建一个这样的扰流板，但是当我按下另一个扰流板时，一个扰流板的内容*不会消失。*

我到底应该在这段代码（html源代码）中改变什么？

```
<div class="dokuwiki">
        <div class="right_page">
<div class="entry-content">
<script type="text/javascript" src="./JDownloader.org - Official Homepage_files/jquery.js"></script>
 <script type="text/javascript">                                         
 $(document).ready(function(){
 $(".nonjs").removeAttr( "href"); //href is needed for users without JS
 $('.OS').click(function(){
 if($(this).find(".details").is(":visible"))
 {
   $(this).find(".details").not(":hidden").hide("slow");
   return true;
 }
 else
 {
   $(".OS").not(this).each(function(i) {
     $(this).find(".details").hide("slow");
   });
   $(this).find(".details").show("slow");
   return false;
 }
 });
 });
 </script>     
 <style type="text/css">
 <!--
.details {
display: none;
clear: both;
padding: 2px;
}
.nonjs{
    cursor:pointer;
}
img {
border: 0px;
}
-->
</style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T14:57:37.953

```
$(".OS").not(this).each(function(i) {
    $(this).find(".details").hide("slow");
}); 
```

该部分找到所有不是当前（单击）的部分并隐藏它们。

# c# - 如何从 C# 捕获 PowerShell 函数调用

> ID：11563535
> 
> 赞同：0
> 
> 时间：2012-07-19T14:55:12.500
> 
> 标签：c#, .net, function, powershell, overriding

我需要从创建的 powershell 主机捕获 PowerShell 函数调用并覆盖它。怎么可能？

```
InitialSessionState iss = InitialSessionState.CreateDefault();
iss.LanguageMode = PSLanguageMode.FullLanguage;
iss.ImportPSModule(new string[] { "TestModule.psm1" });
Runspace rs = RunspaceFactory.CreateRunspace(iss);
rs.Open();
Pipeline pl = rs.CreatePipeline();
pl.Commands.AddScript("TestFunction testParam");
var res = pl.Invoke();
rs.Close(); 
```

我的任务是动态覆盖TestFunction，女巫位于TestModule，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:53:25.863

您可以定义一个名为“TestFunction”的 cmdlet（在您的 c# 代码中）并将其添加到运行空间配置中，如下所示：

```
 rs.RunspaceConfiguration.Cmdlets.Append(New CmdletConfigurationEntry("testfunction", GetType(TestFuncitonCmdlet), Nothing)) 
```

# powershell - PowerShell - 处理多个 word 文档 (office 2010)

> ID：11563536
> 
> 赞同：3
> 
> 时间：2012-07-19T14:55:14.040
> 
> 标签：powershell, powershell-2.0, word-2010

我正在尝试编写一个 PowerShell 脚本来对多个 Word 文档执行步骤。我的机器上安装了 Word 2010，但似乎无法获取打开文档的脚本。这是脚本

```
 $path = "C:\MyPath" 
    Add-Type -AssemblyName Microsoft.Office.Interop.Word  
    $wordFiles = Get-ChildItem -Path $path -include *.doc, *.docx -recurse 
    $objWord = New-Object -ComObject "word.application"
    $objWord.visible = $false 
    foreach($wd in $wordFiles) 
    { 
    $doc = $objWord.documents.open($wd.fullname) 
    #InsertProcessingFunctionsHere 
    $doc.Save() 
    $objWord.Documents.Close() 
    } 
    $objWord.Quit() 
```

我尝试运行它，我从 PowerShell 得到的错误是：

```
 Exception calling "Open" with "1" argument(s): "Command failed"
    At C:\Scripts\Process-WordDocs.ps1:10 char:31
    + $doc = $objWord.documents.open <<<< ($wd.fullname)
        + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
        + FullyQualifiedErrorId : ComMethodTargetInvocation

    You cannot call a method on a null-valued expression.
    At C:\Scripts\Process-WordDocs.ps1:13 char:10
    + $doc.Save <<<< ()
        + CategoryInfo          : InvalidOperation: (Save:String) [], RuntimeException
        + FullyQualifiedErrorId : InvokeMethodOnNull

    Exception calling "Close" with "0" argument(s): "This method or property is not available because a document window is not active."
    At C:\Scripts\Process-WordDocs.ps1:14 char:25
    + $objWord.Documents.Close <<<< ()
        + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
        + FullyQualifiedErrorId : ComMethodTargetInvocation 
```

MSDN 声明documents.open 只需要1 个参数，其余的都是可选的。但是，我在网上看到的一个 C# 示例显示将“ReadOnly: False”参数传递给documents.open。单步执行 ISE 调试器中的脚本，我可以看到 $wd.fullname 在那里并指向一个有效文件，所以我完全不清楚它为什么没有打开。起初，我认为这是因为我使用的是 64 位版本的操作系统（32 位版本的 Office），但尝试从 32 位 PowerShell 会话中执行脚本会导致相同的错误。任何人都知道为什么会发生这种情况，以及我该如何解决？我希望所有处理都对用户不可见。任何帮助将*不胜*感激。提前感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-02T22:10:26.280

我认为您想使用`$doc.close()`而不是 关闭文档`$objWord.Documents.Close()`

# xamarin.ios - 为什么我的 Monotouch App 在 iOS 6 上崩溃？

> ID：11563543
> 
> 赞同：1
> 
> 时间：2012-07-19T14:55:45.250
> 
> 标签：xamarin.ios, ios6

我需要确保我们的 iPhone 应用程序（使用 Monotouch 实现）从 iOS 6 向公众发布的第一天起仍然可以正常工作。

我已经安装了 XCode 4.5 和 iOS 6 Beta 3 并将 Monotouch 升级到最新版本。然后我在 iOS 6 模拟器中运行我的应用程序，应用程序立即崩溃并显示以下错误消息：

由于没有系统事件服务器而终止。（如果您想在没有 SpringBoard 的情况下运行，请运行 EventPump 或传递参数“-RegisterForSystemEvents”。

我试过用谷歌搜索类似的问题，但找不到任何东西。如何让我的应用程序在 iOS 6 上运行？

谢谢，

阿德里安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:08:40.620

iOS 6 和 Xcode 4.5 的详细信息在保密协议下，不会公开讨论。请联系 support@xamarin.com 或在[http://bugzilla.xamarin.com上填写](http://bugzilla.xamarin.com)**私人**错误报告

# database - 保存在数据库中的图像无法更新

> ID：11563547
> 
> 赞同：0
> 
> 时间：2012-07-19T14:55:49.927
> 
> 标签：database, asp.net-mvc-3, image, linq

两天来，我一直在谷歌上寻找解决问题的方法，但没有任何运气。MVC3 .NET 中的任何明星都可以提供帮助吗？

我正在尝试构建一个 .NET MVC3 应用程序来更新保存在数据库中的图像。

下面是动作方法

```
[HttpPost]
    public ActionResult Edit(myImage img, HttpPostedFileBase imageFile)
    {
        //var img = (from imga in db.myImages
        //              where imga.imageID == id
        //            select imga).First();
        if (ModelState.IsValid)
        {
            if (img != null)
            {
                img.imageType = imageFile.ContentType;
                img.Data  = new byte[imageFile.ContentLength];
                imageFile.InputStream.Read(img.Data, 0, imageFile.ContentLength);
            }
            // save the product
            UpdateModel(img);
            db.SubmitChanges();
            return RedirectToAction("Index");
        }
        else
        {
            // there is something wrong with the data values
            return View(img);
        }
    } 
```

这是视图

```
@model JackLing.Models.myImage

   @{
       ViewBag.Title = "Edit";
       Layout = "~/Views/Shared/_Layout.cshtml";
   }

   <h2>Edit</h2>

   <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
   <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

   @using (Html.BeginForm("Edit", "Image",FormMethod.Post, new { enctype = "multipart/form-data" })){
       @Html.ValidationSummary(true)
       <fieldset>
           <legend>myImage</legend>
           @Html.EditorForModel();

           <div class="editor-label">Image</div>
           <div class="editor-field">
           @if (Model.Data != null)
           {
            <img src="@Url.Action("show", new { id = Model.imageID })" height="150" width="150" />
           }
           else { 
           @:None
           }
           </div>

           <p>
              <span>Choose a new file</span> <input type="file" name="imgFile"/>
           </p>

           <p>
               <input type="submit" value="Save" />
           </p>

       </fieldset>
   }

   <div>
       @Html.ActionLink("Back to List", "Index")
   </div> 
```

当我运行应用程序时，它会抛出一个错误，提示“对象引用未设置为对象的实例”。

任何有关如何解决问题的建议都将得到重视！顺便说一句，create 和 details 方法都在工作。我认为它与数据绑定有关，但我不确定......我不知道如何解决它。

* * *

最后根据 Eulerfx 的建议解决了这个问题，这里是工作操作。

```
[HttpPost]
        public ActionResult Edit(myImage img, HttpPostedFileBase imageFile)
        {
            myImage imgToSave = (from imga in db.myImages
                          where imga.imageID == img.imageID
                         select imga).First();

            if (ModelState.IsValid)
            {
                if (img != null)
                {
                    imgToSave.imageType = imageFile.ContentType;
                    var binaryReader = new BinaryReader(imageFile.InputStream);
                    imgToSave.Data = binaryReader.ReadBytes(imageFile.ContentLength);
                    binaryReader.Close();
                }

                TryUpdateModel(imgToSave);

                db.SubmitChanges();

                return RedirectToAction("Index");
            }
            else
            {
                // there is something wrong with the data values
                return View(img);
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T00:39:55.750

问题可能是HTML中文件输入字段的名称是imgeFile，而MVC中文件参数的名称是imageFile。确保输入字段名称和操作方法参数名称匹配。

# css - 如何使用 CSS 在其对角轴上旋转方形元素？

> ID：11563549
> 
> 赞同：2
> 
> 时间：2012-07-19T14:55:57.553
> 
> 标签：css

给定一个正方形，我如何旋转它，例如元素翻转，其对角线是旋转的原点？我设法使用以下方法翻转它：

```
-webkit-transform: rotateX(90deg) rotateZ(90deg) rotateY(-90deg); 
```

[你可以在这里](http://jsfiddle.net/ewGWj/1/)看到一个例子

但这不会在对角轴上旋转。我怎样才能做到这一点？基本上我想要实现的是，当元素旋转时，它的右上角和左下角不会不合适。感谢并为我糟糕的英语/解释感到抱歉：S！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-17T19:19:50.820

看来我参加聚会有点晚了，但是

```
-webkit-transform: rotate3d(-2,1, 0,-180deg); 
```

可能会给你你正在寻找的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:09:32.940

正如您在[这个 jsfiddle](http://jsfiddle.net/YadZe/3/)中看到的那样，[矩阵变换](https://developer.mozilla.org/en/CSS/transform#matrix)和[缩放](https://developer.mozilla.org/en/CSS/transform#scale)的组合起作用。[使用背景图像](http://jsfiddle.net/YadZe/4/)效果会更加明显。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:09:13.750

如果我正确理解您的问题，您只需要添加以下内容：

```
-webkit-transform-origin: left bottom 
```

如果不是这样，请在此处查看有关如何更改旋转原点的信息：[https ://developer.mozilla.org/en/CSS/transform-origin](https://developer.mozilla.org/en/CSS/transform-origin)

# c++ - 使用 stringstream 将 pid_t 转换为 const char*

> ID：11563552
> 
> 赞同：2
> 
> 时间：2012-07-19T14:56:07.323
> 
> 标签：c++, string, pid, stringstream

我想将进程 pid 转换为 const char* 但下面不起作用：

```
 std::ostringstream str_pid;
        str_pid << getpid();
        const char * cstr_pid = str_pid.str().c_str(); 
```

它大部分时间都有效，但有时它会产生错误的结果。显然我做错了什么。任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T14:57:48.120

`cstr_pid``std::string`将是一个悬空指针，因为`str_pid.str()`在分配`cstr_pid`. 创建`str_pid.str()`返回值的副本：

```
const std::string my_pid(str_pid.str()); 
```

然后在需要`my_pid.c_str()`时`const char*`使用。

# windows-runtime - Windows 应用商店应用启动

> ID：11563553
> 
> 赞同：0
> 
> 时间：2012-07-19T14:56:08.027
> 
> 标签：windows-runtime, windows-store-apps, launching

我在启动 Windows 应用商店应用时遇到问题。当我使用“关闭应用程序手势”（从上到下滑动应用程序）然后非常快速地再次启动应用程序时，有时会出现一个空白黑屏，当我单击它时，会出现开始菜单，并出现“ MoAppHang”事件被记录。

我的 App_Launched 事件代码在这里：

```
 protected override async void OnLaunched(LaunchActivatedEventArgs args)
    {
        if (args.PreviousExecutionState == ApplicationExecutionState.Terminated )
        {
            // Restore the saved session state only when appropriate
            await SuspensionManager.RestoreAsync();                
        }

        // Do not repeat app initialization when already running, just ensure that
        // the window is active
        if (args.PreviousExecutionState == ApplicationExecutionState.Running)
        {
            if (!string.IsNullOrEmpty(args.Arguments))
            {
                Frame f = Window.Current.Content as Frame;
                if (f != null)
                {
                    UseSecondaryTileNavigation(f, args.Arguments);
                }
            }
            Window.Current.Activate();
            return;
        }

        Frame rootFrame;
        if (Window.Current.Content == null)
        {

            // Create a Frame to act as the navigation context and associate it with
            // a SuspensionManager key
            rootFrame = new Frame();
            SuspensionManager.RegisterFrame(rootFrame, "AppFrame");
        }
        else
        {
            rootFrame = (Frame)Window.Current.Content;
        }

        if (!await DatabaseHelper.ExistsDatabase())
        {
            await DatabaseHelper.CreateDatabase();
        }

        if (rootFrame.Content == null)
        {
            // When the navigation stack isn't restored navigate to the first page,
            // configuring the new page by passing required information as a navigation
            // parameter
            if (!rootFrame.Navigate(typeof(ItemsPage), "AllGroups"))
            {
                throw new Exception("Failed to create initial page");
            }
        }

        if (!string.IsNullOrEmpty(args.Arguments))
        {
            UseSecondaryTileNavigation(rootFrame, args.Arguments);
        }

        // Place the frame in the current Window and ensure that it is active
        if (Window.Current.Content == null)
        {
            Window.Current.Content = rootFrame;
        }
        Window.Current.Activate(); 
```

UseSecondaryTileNavigation 在用户使用辅助磁贴打开应用程序时执行导航（它基本上使用 Frame 参数并使用 Frame.Navigate 将其导航到正确的位置）。

我哪里错了？

谢谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T00:05:01.547

看起来您可能会在启动处理程序中做一些耗时的工作。我提出的第一个建议是使用自定义闪屏技术。也就是说，在您的`OnLaunched`处理程序中尝试设置`Window.Current.Content`并激活窗口并尽快退出该方法。您可以设置`Window.Current.Content`为仅显示加载进度条的页面 - 并在其中处理您的实际加载逻辑。

接下来要看的 - 当您的应用程序仍在挂起时启动时会发生什么？（您有暂停处理程序吗？）您的应用程序可以在之前的暂停/关闭完成之前（重新）启动时处理这种情况吗？

我注意到在应用程序完全关闭之前通常似乎需要几秒钟（即使您使用向下拖动手势关闭它）。

# javascript - 以跨浏览器方式使用 Javascript 的 DOMParser 时如何检测 XML 解析错误？

> ID：11563554
> 
> 赞同：30
> 
> 时间：2012-07-19T14:56:07.350
> 
> 标签：javascript, xml

似乎所有主流浏览器都实现了 DOMParser API，以便可以将 XML 解析为 DOM，然后使用 XPath、getElementsByTagName 等进行查询......

但是，检测解析错误似乎更棘手。 `DOMParser.prototype.parseFromString`总是返回一个有效的 DOM。发生解析错误时，返回的 DOM 包含一个`<parsererror>`元素，但在各个主流浏览器中略有不同。

**示例 JavaScript：**

```
xmlText = '<root xmlns="http://default" xmlns:other="http://other"><child><otherr:grandchild/></child></root>';
parser = new DOMParser();
dom = parser.parseFromString(xmlText, 'application/xml');
console.log((new XMLSerializer()).serializeToString(dom)); 
```

**Opera 的结果：**

DOM 的根是一个`<parsererror>`元素。

```
<?xml version="1.0"?><parsererror xmlns="http://www.mozilla.org/newlayout/xml/parsererror.xml">Error<sourcetext>Unknown source</sourcetext></parsererror> 
```

**结果在 Firefox 中：**

DOM 的根是一个`<parsererror>`元素。

```
<?xml-stylesheet href="chrome://global/locale/intl.css" type="text/css"?>
<parsererror xmlns="http://www.mozilla.org/newlayout/xml/parsererror.xml">XML Parsing Error: prefix not bound to a namespace
Location: http://fiddle.jshell.net/_display/
Line Number 1, Column 64:<sourcetext>&lt;root xmlns="http://default" xmlns:other="http://other"&gt;&lt;child&gt;&lt;otherr:grandchild/&gt;&lt;/child&gt;&lt;/root&gt;
---------------------------------------------------------------^</sourcetext></parsererror> 
```

**Safari 中的结果：**

该`<root>`元素解析正确，但包含嵌套在与 Opera 和 Firefox元素`<parsererror>`不同的命名空间中。`<parsererror>`

```
<root xmlns="http://default" xmlns:other="http://other"><parsererror xmlns="http://www.w3.org/1999/xhtml" style="display: block; white-space: pre; border: 2px solid #c77; padding: 0 1em 0 1em; margin: 1em; background-color: #fdd; color: black"><h3>This page contains the following errors:</h3><div style="font-family:monospace;font-size:12px">error on line 1 at column 50: Namespace prefix otherr on grandchild is not defined
</div><h3>Below is a rendering of the page up to the first error.</h3></parsererror><child><otherr:grandchild/></child></root> 
```

* * *

我是否缺少一种简单的跨浏览器检测 XML 文档中是否发生解析错误的方法？`<parsererror>`或者我必须为不同浏览器可能生成的每个可能元素查询 DOM ？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-24T02:19:13.597

这是我想出的最好的解决方案。

我尝试解析一个故意无效的 XML 字符串并观察结果`<parsererror>`元素的命名空间。然后，在解析实际 XML 时，我可以`getElementsByTagNameNS`用来检测相同类型的`<parsererror>`元素并抛出 Javascript `Error`。

```
// My function that parses a string into an XML DOM, throwing an Error if XML parsing fails
function parseXml(xmlString) {
    var parser = new DOMParser();
    // attempt to parse the passed-in xml
    var dom = parser.parseFromString(xmlString, 'application/xml');
    if(isParseError(dom)) {
        throw new Error('Error parsing XML');
    }
    return dom;
}

function isParseError(parsedDocument) {
    // parser and parsererrorNS could be cached on startup for efficiency
    var parser = new DOMParser(),
        errorneousParse = parser.parseFromString('<', 'application/xml'),
        parsererrorNS = errorneousParse.getElementsByTagName("parsererror")[0].namespaceURI;

    if (parsererrorNS === 'http://www.w3.org/1999/xhtml') {
        // In PhantomJS the parseerror element doesn't seem to have a special namespace, so we are just guessing here :(
        return parsedDocument.getElementsByTagName("parsererror").length > 0;
    }

    return parsedDocument.getElementsByTagNameNS(parsererrorNS, 'parsererror').length > 0;
}; 
```

请注意，此解决方案不包括 Internet Explorer 所需的特殊情况。但是，在 IE 中事情要简单得多。XML 使用一种`loadXML`方法解析，如果解析成功或失败，则分别返回 true 或 false。有关示例，请参见[http://www.w3schools.com/xml/xml_parser.asp 。](http://www.w3schools.com/xml/xml_parser.asp)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-11-29T22:34:12.873

当我第一次来到这里时，我赞​​成原始答案（通过**cspotcode**），但是，它在 Firefox 中不起作用。由于生成的文档的结构，生成的命名空间始终为“null”。我做了一些研究（在[这里](https://gist.github.com/Rast1234/7712555)查看代码）。这个想法是不使用

```
invalidXml.childNodes[0].namespaceURI 
```

但

```
invalidXml.getElementsByTagName("parsererror")[0].namespaceURI 
```

然后按照原始答案按名称空间选择“parsererror”元素。但是，如果您有一个有效的 XML 文档，其`<parsererror>`标签与浏览器使用的名称空间相同，那么您最终会收到误报。因此，这里有一个启发式方法来检查您的 XML 是否成功解析：

```
function tryParseXML(xmlString) {
    var parser = new DOMParser();
    var parsererrorNS = parser.parseFromString('INVALID', 'application/xml').getElementsByTagName("parsererror")[0].namespaceURI;
    var dom = parser.parseFromString(xmlString, 'application/xml');
    if(dom.getElementsByTagNameNS(parsererrorNS, 'parsererror').length > 0) {
        throw new Error('Error parsing XML');
    }
    return dom;
} 
```

*为什么不在 DOMParser 中实现异常？*

在当前上下文中值得一提的有趣事情：如果您尝试使用 获取 XML 文件`XMLHttpRequest`，解析的 DOM 将存储在`responseXML`属性中，或者`null`，如果 XML 文件内容无效。不是一个例外，不是`parsererror`或另一个特定的指标。只是空。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2022-01-23T17:06:48.077

回到 2022 年的这个问题，该方法的[文档](https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString)`DOMParser.parseFromString()`提供了一个更简单的解决方案：

```
const parser = new DOMParser();

const xmlString = "<warning>Beware of the missing closing tag";
const doc = parser.parseFromString(xmlString, "application/xml");
const errorNode = doc.querySelector('parsererror');
if (errorNode) {
  // parsing failed
} else {
  // parsing succeeded
} 
```

虽然接受的答案对我有用，但使用该`Document.querySelector()`方法确实要简单得多，因为您不必确定元素`namespaceURI`的。`parsererror`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-19T04:17:27.893

在当前浏览器中，当给定格式错误的 XML 时，DOMParser 似乎有两种可能的行为：

1.  完全丢弃生成的文档 - 返回`<parsererror>`包含错误详细信息的文档。Firefox 和 Edge 似乎总是采用这种方法；*Chrome 系列的浏览器在大多数*情况下都会这样做。

2.  返回结果文档，其中插入了一个额外的`<parsererror>`作为根元素的第一个子元素。Chrome 的解析器会在尽管在源 XML 中发现错误但仍能够生成根元素的情况下执行此操作。插入的`<parsererror>`可能有也可能没有命名空间。文档的其余部分似乎完好无损，包括注释等。请参阅[xml_errors.cc](https://cs.chromium.org/chromium/src/third_party/blink/renderer/core/xml/parser/xml_errors.cc) — 搜索`XMLErrors::InsertErrorMessageBlock`.

对于（1），检测错误的方法是在源字符串中添加一个节点，对其进行解析，检查该节点是否存在于结果文档中，然后将其删除。据我所知，在不影响结果的情况下实现此目的的唯一方法是将处理指令或注释附加到源代码的末尾。

例子：

```
let key = `a`+Math.random().toString(32);

let doc = (new DOMParser).parseFromString(src+`<?${key}?>`, `application/xml`);

let lastNode = doc.lastChild;
if (!(lastNode instanceof ProcessingInstruction)
    || lastNode.target !== key
    || lastNode.data !== ``)
{
    /* the XML was malformed */
} else {
    /* the XML was well-formed */
    doc.removeChild(lastNode);
} 
```

如果发生情况（2），上述技术将无法检测到错误，因此需要另一个步骤。

`<parsererror>`即使在源代码的不同位置发现多个错误，我们也可以利用仅插入一个这一事实。通过再次解析源字符串，此时附加语法错误，我们可以确保触发 (2) 行为，然后检查`<parsererror>`元素的数量是否发生了变化——如果没有，第一个`parseFromString`结果已经包含一个 true `<parsererror>`。

例子：

```
let errCount = doc.documentElement.getElementsByTagName(`parsererror`).length;
if (errCount !== 0) {
    let doc2 = parser.parseFromString(src+`<?`, `application/xml`);
    if (doc2.documentElement.getElementsByTagName(`parsererror`).length === errCount) {
        /* the XML was malformed */
    }
} 
```

* * *

我整理了一个测试页面来验证这种方法：[https](https://github.com/Cauterite/domparser-tests) ://github.com/Cauterite/domparser-tests 。

它针对整个[XML W3C 一致性测试套件](https://www.w3.org/XML/Test/xmlconf-20080827.html)进行测试，加上一些额外的样本，以确保它可以区分包含`<parsererror>`元素的文档和 DOMParser 发出的实际错误。只有少数测试用例被排除在外，因为它们包含无效的 unicode 序列。

需要明确的是，它只是测试结果是否与给`XMLHttpRequest.responseXML`定文档的结果相同。

您可以在[https://cauterite.github.io/domparser-tests/index.html](https://cauterite.github.io/domparser-tests/index.html)自己运行测试，但请注意它使用 ECMAScript 2018。

在撰写本文时，所有测试都通过了最新版本的 Firefox、Chrome、Safari 和 Android 上的 Firefox。基于 Edge 和 Presto 的 Opera 应该可以通过，因为它们的 DOMParsers 的行为看起来像 Firefox，而当前的 Opera 应该可以通过，因为它是 Chromium 的一个分支。

* * *

如果您能找到任何反例或可能的改进，请告诉我。

对于懒惰的人，这是完整的功能：

```
const tryParseXml = function(src) {
    /* returns an XMLDocument, or null if `src` is malformed */

    let key = `a`+Math.random().toString(32);

    let parser = new DOMParser;

    let doc = null;
    try {
        doc = parser.parseFromString(
            src+`<?${key}?>`, `application/xml`);
    } catch (_) {}

    if (!(doc instanceof XMLDocument)) {
        return null;
    }

    let lastNode = doc.lastChild;
    if (!(lastNode instanceof ProcessingInstruction)
        || lastNode.target !== key
        || lastNode.data !== ``)
    {
        return null;
    }

    doc.removeChild(lastNode);

    let errElemCount =
        doc.documentElement.getElementsByTagName(`parsererror`).length;
    if (errElemCount !== 0) {
        let errDoc = null;
        try {
            errDoc = parser.parseFromString(
                src+`<?`, `application/xml`);
        } catch (_) {}

        if (!(errDoc instanceof XMLDocument)
            || errDoc.documentElement.getElementsByTagName(`parsererror`).length
                === errElemCount)
        {
            return null;
        }
    }

    return doc;
} 
```

# java - Java Swing 的错误消息

> ID：11563555
> 
> 赞同：4
> 
> 时间：2012-07-19T14:56:14.433
> 
> 标签：java, swing, netbeans

我有一个关于使用 Java Swing 处理错误条件的查询。

我正在使用 Netbeans 开发一个简单的 Java Swing 应用程序。它是加载到一个文本文件中，然后根据在文本文件中找到的数字运行计算。主要的 Swing 类包含 JFrame 和 JPanel。

我将文件加载代码作为单独的类文件。它将读取的行数和一个数字列表返回给主 Swing 应用程序。

我意识到如果文件读取失败（即 try -> catch (Exception ex)），整个应用程序将崩溃。处理上述情况导致的错误的最佳方法是什么？也就是说文件加载代码崩溃了，我不希望整个程序崩溃。我希望程序说文件已损坏并等待用户加载新文件。

有什么想法吗？

养乐多

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T14:59:52.077

当你捕捉到异常时，运行：

```
JOptionPane.showMessageDialog("File is corrupted. Please select a new file."); 
```

然后再次显示文件对话框。

最好将其作为一个循环来执行，该循环在文件无效时继续。如果存在损坏，则不要抛出异常，而是设置一个布尔标志并在设置标志时循环。这样，当找到一个好的文件时，while 循环将终止。

例子：

```
public static void main(String[] args){
    boolean goodFile = false;

    while (!goodFile){
        JFileChooser chooser = new JFileChooser();
        chooser.showOpenDialog();

        goodFile = processFile(chooser.getSelectedFile());
    }
}

private boolean processFile(File file){
    //do you stuff with the file

    //return true if the processing works properly, and false otherwise    
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:11:35.000

是的，问题在于您的 IO 读取概念，while 循环正在读取到文件末尾等等.. 以防止您可以使用缓冲读取器并使用此代码

```
String line = null
while((line = reader.readLine())!= null) {
// do stuf
} 
```

如果您在处理读取行时遇到此问题，您只需要通过扩展 Exception 类来创建自己的异常类，并在将消息设置为自定义异常类后在 catch 块中抛出该异常，您可以在中设置该消息至

```
 JOptionPane.showMessageDialog(null,"message here"); //showMessageDialog is a static method 
```

好的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T14:59:56.260

您只需捕获异常并将条件放入 catch 块中。如果该文件包含您的应用程序打算处理的其他内容，那么您可以调用您的方法，该方法将重新处理另一个文件。

新文件操作的新进程的主要处理将从您的 catch 块开始。因此，通过这种方式，您使用 java 抛出的异常以全新的方式重新启动您的应用程序，而不是从零级重新启动您的应用程序。

# ffmpeg - 在 macos 上编译 opencv 错误 - libavformat 中的错误

> ID：11563564
> 
> 赞同：3
> 
> 时间：2012-07-19T14:56:47.210
> 
> 标签：ffmpeg, opencsv

我已经尝试在两个 Mac 中编译 OpenCSV，但我都有错误。错误如下：

```
Building CXX object modules/highgui/CMakeFiles/opencv_highgui.dir/src/cap_ffmpeg.cpp.o
use of undeclared identifier 'avformat_find_stream_info'; 
did you mean 'av_find_stream_info'?
/usr/local/include/libavformat/avformat.h:1168:5: note: 'av_find_stream_info' declared here int av_find_stream_info(AVFormatContext *ic); 
```

/usr/local/include 中的 libavformat 与 ffmpeg 一起安装。ffmpeg 是 0.8.5 版本

有人有同样的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T19:11:52.640

我基本上编辑了 modules/highgui/src/cap_ffmpeg_impl.hpp 中的代码

```
#if LIBAVFORMAT_BUILD >= CALC_FFMPEG_VERSION(53, 3, 0)
    avformat_find_stream_info(ic, NULL);
#else
    av_find_stream_info(ic);
#endif 
```

至

```
#if LIBAVFORMAT_BUILD >= CALC_FFMPEG_VERSION(53, 3, 0)
    av_find_stream_info(ic);
    //avformat_find_stream_info(ic, NULL);
#else
    av_find_stream_info(ic);
#endif 
```

这解决了它。到目前为止没有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-16T22:25:13.707

您可以通过在命令中添加以下参数来禁用 ffmpeg `cmake`（例如参见[本手册](http://www.pyimagesearch.com/2015/06/15/install-opencv-3-0-and-python-2-7-on-osx/)）：

```
-DWITH_FFMPEG=OFF 
```

假设您在构建中实际上不需要 ffmpeg，这将消除错误。

# sql - 查询以获取每个组的前 2 名

> ID：11563574
> 
> 赞同：2
> 
> 时间：2012-07-19T14:57:07.833
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有这个 sql 代码：

```
SELECT   NoteOID = HCN.ObjectID,
         PatientOID = HCN.PatientID,
         PatientVisitOID = 0,
         CollectedDT = HCN.CollectedDT
FROM     HClinicalNote HCN WITH(NOLOCK)
where    HCN.enddt is NULL
         and HCN.visitid in (select distinct visitOID from @tblCensus)
order by HCN.PatientID,HCN.CollectedDT desc 
```

给出这些结果：

```
 NoteOID    PatientOID     CollectedDT
 181382     890855         2011-09-14 21:31:00
 169115     890855         2011-09-12 18:38:00
 177466     890855         2011-09-09 19:49:00
 175150     890855         2011-09-07 19:34:00
 174057     890855         2011-09-06 19:25:00
 172429     890855         2011-09-04 09:00:00
 181387     13462666       2011-09-14 21:37:00
 182224     13462666       2011-09-14 13:24:00
 179269     13462666       2011-09-12 18:12:00 
```

我想从每组 PatientOID 中获得前 2 个 CollectedDT。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:04:06.967

如果您至少使用 SQL-Server 2005，则可以使用`CTE`with[`ROW_NUMBER`](http://msdn.microsoft.com/en-us/library/ms186734.aspx)函数：

```
WITH CTE AS(
   SELECT  NoteOID = HCN.ObjectID,
           PatientOID = HCN.PatientID,
           PatientVisitOID = 0,
           CollectedDT = HCN.CollectedDT,
           RN = ROW_NUMBER()OVER(PARTITION BY PatientOID ORDER BY CollectedDT ASC)
   FROM HClinicalNote HCN
   WHERE HCN.enddt is NULL
   AND HCN.visitid in (select distinct visitOID from @tblCensus)
)
SELECT * FROM CTE
WHERE RN <= 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T08:14:15.567

```
select T2.* from (SELECT  NoteOID = HCN.ObjectID, 
       PatientOID = HCN.PatientID,   
       PatientVisitOID = 0,   
       CollectedDT = HCN.CollectedDT,  
       RN = ROW_NUMBER()OVER(PARTITION BY PatientOID ORDER BY CollectedDT ASC)  
FROM HClinicalNote HCN   
WHERE HCN.enddt is NULL  
AND HCN.visitid in (select distinct visitOID from @tblCensus) ) as T2   
where T2.RN >=2 
```

# tsql - SQL Server CTE 以递归方式获取给定行的所有链接行

> ID：11563579
> 
> 赞同：1
> 
> 时间：2012-07-19T14:57:16.133
> 
> 标签：tsql, sql-server-2005

我有一张包含以下详细信息的表格：

```
-- SQL
CREATE TABLE [dbo].[LedgerTbl](
    [LedgerID] [int] NOT NULL,
    [Name] [varchar](50) NOT NULL,
    [ParentID] [int] NULL,
    [Cr Amt] [decimal](8, 2) NOT NULL,
    [Dr Amt] [decimal](8, 2) NOT NULL,
 CONSTRAINT [PK_LedgerTbl] PRIMARY KEY CLUSTERED 
(
    [LedgerID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
-- Data
INSERT [dbo].[LedgerTbl] ([LedgerID], [Name], [ParentID], [Cr Amt], [Dr Amt]) VALUES (17, N'L1 Ledger', 20, CAST(25252.00 AS Decimal(8, 2)), CAST(0.00 AS Decimal(8, 2)))
INSERT [dbo].[LedgerTbl] ([LedgerID], [Name], [ParentID], [Cr Amt], [Dr Amt]) VALUES (18, N'L2 Ledger', 20, CAST(9000.00 AS Decimal(8, 2)), CAST(0.00 AS Decimal(8, 2)))
INSERT [dbo].[LedgerTbl] ([LedgerID], [Name], [ParentID], [Cr Amt], [Dr Amt]) VALUES (20, N'Master Ledger', NULL, CAST(0.00 AS Decimal(8, 2)), CAST(6900.00 AS Decimal(8, 2)))
INSERT [dbo].[LedgerTbl] ([LedgerID], [Name], [ParentID], [Cr Amt], [Dr Amt]) VALUES (45, N'L1.1 Ledger', 17, CAST(361.00 AS Decimal(8, 2)), CAST(0.00 AS Decimal(8, 2)))
INSERT [dbo].[LedgerTbl] ([LedgerID], [Name], [ParentID], [Cr Amt], [Dr Amt]) VALUES (46, N'L1.1.1 Ledger', 45, CAST(6541.00 AS Decimal(8, 2)), CAST(0.00 AS Decimal(8, 2)))
INSERT [dbo].[LedgerTbl] ([LedgerID], [Name], [ParentID], [Cr Amt], [Dr Amt]) VALUES (47, N'L1.1.2 Ledger', 45, CAST(321.00 AS Decimal(8, 2)), CAST(0.00 AS Decimal(8, 2)))

GO
ALTER TABLE [dbo].[LedgerTbl]  WITH CHECK ADD  CONSTRAINT [FK_LedgerTbl_LedgerTbl] FOREIGN KEY([ParentID])
REFERENCES [dbo].[LedgerTbl] ([LedgerID])
GO
ALTER TABLE [dbo].[LedgerTbl] CHECK CONSTRAINT [FK_LedgerTbl_LedgerTbl]
GO 
```

样本数据如下：

```
LedgerID    Name            ParentID     Cr Amt     Dr Amt
20          Master Ledger   NULL           0.00    6900.00
17          L1 Ledger       20         25252.00       0.00
18          L2 Ledger       20          9000.00       0.00
45          L1.1 Ledger     17           361.00       0.00
46          L1.1.1 Ledger   45          6541.00       0.00
47          L1.1.2 Ledger   45           321.00       0.00 
```

在 LedgerID 20 的上表中，我需要所有链接的分类帐（在所有级别），这些分类帐直接或间接链接到此分类帐。在上表中，所有分类帐都直接链接到 20。
如果我查询分类帐 20 的余额，它应该显示如下（添加所有级别的所有链接分类帐的所有 Cr Amt 和 Dr Amount）：

```
Cr Bal        Dr Bal
41475.00    6900.00 
```

由于所有分类帐都直接或间接与 20 相关联，因此正在汇总所有 Cr Amt 和 Dr Amt。
添加所有链接/未链接 LedgerID 的 Cr Amt 和 Dr Amt 的总和后，结果应该是这样的：

```
LedgerID   Tot. Cr Amt  Tot Dr Amt
20         41475.00    6900.00
18          9000.00       0.00
17         32475.00       0.00
45          7223.00       0.00
46          6541.00       0.00
47           321.00       0.00 
```

请注意，账本 18 没有任何子账本，因此无需添加任何余额。

请帮助使用 CTE 或任何其他方法实现此目的。提前致谢。

这是我尝试过的：

```
;WITH RecursiveLedger(LedgerID, [Name],[Cr Amt], [Dr Amt], LevelNum, LevelIndex, ParentID)
AS (
       SELECT lg.LedgerID,
              lg.[Name],
              lg.[Cr Amt],
              lg.[Dr Amt],
              1 AS LevelNum,
              CAST(lg.LedgerID AS VARCHAR) AS LevelIndex,
              lg.ParentID 
       FROM   [LedgerTbl] lg
       WHERE  lg.ParentID IS NULL
       UNION ALL
       SELECT l.LedgerID,
              l.[Name],
              l.[Cr Amt],
              l.[Dr Amt],
              r.LevelNum + 1 AS LevelNum,
              CAST(r.LevelIndex + '.' + CAST(ROW_NUMBER() OVER(ORDER BY l.ParentID) AS VARCHAR) AS VARCHAR) AS LevelIndex,
              l.ParentID 
       FROM   [LedgerTbl] l,
              RecursiveLedger r
       WHERE  r.LedgerID = l.ParentID
   ) SELECT * FROM   RecursiveLedger 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:23:02.507

```
with anc as 
(
    select ledgerid, parentid
    from [LedgerTbl] where parentid is not null
    union all
    select c.ledgerid, isnull(anc.parentid, anc.parentid)
    from anc 
        inner join [LedgerTbl] c on anc.ledgerid = c.parentid
), anc2 as
(
    select * from anc
    union all
    select ledgerid, ledgerid
    from ledgertbl 
)
select  a.parentid,
        sum(l.[Cr Amt]), 
        sum(l.[dr Amt]) 
from anc2 a
    inner join ledgertbl l on a.ledgerid = l.ledgerid
group by a.parentid
order by a.parentid; 
```

# android - 对话框中的按钮顺序

> ID：11563583
> 
> 赞同：1
> 
> 时间：2012-07-19T14:57:21.363
> 
> 标签：android, android-layout, android-widget, android-alertdialog

我正在膨胀一个 AlertDialog 让用户发送评论。相当简单。但我收到了这个 Lint 警告：

> 布局对 API >= 14 使用了错误的按钮顺序：创建一个 layout-v14/chat_comment_dialog.xml 文件，顺序相反：取消按钮应该在左边（是“@string/send | Cancel”，应该是“Cancel | @字符串/发送“）

所以，是的，这就是解决方案，为 API >= 14 创建一个特定的布局并颠倒顺序。但是....真的吗？这真的是官方建议吗？在某些设备中设置一个订单，在其他设备中设置不同的订单？作为用户，我会感到非常困惑。我是否应该忽略这个 Lint 建议，或者以其他方式，为一组设备遵循这个新模式（我认为这很令人困惑）

无论如何，这是布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical"
    android:padding="8dp" >

    <EditText
        android:id="@+id/username"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:hint="@string/username"
        android:singleLine="true" />

    <EditText
        android:id="@+id/message"
        android:layout_width="match_parent"
        android:layout_height="180dp"
        android:gravity="top|left"
        android:hint="@string/review" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <Button
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:paddingRight="4dp"
            android:text="@string/send"
            android:textSize="18sp" />

        <Button
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:paddingLeft="4dp"
            android:text="@android:string/cancel"
            android:textSize="18sp" />
    </LinearLayout>

</LinearLayout> 
```

顺便说一句，我必须在 XML 中而不是在 AlertDialog.Builder 中膨胀按钮（也许这样按钮会自动排序），因为您设置为 Builder 的默认按钮的任何 onClickListener 都会关闭对话框，我必须避免这种行为才能自己控制对话框。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T16:47:49.397

如果您计划以 API 级别 >14 为目标，那么您**绝对**应该遵循设计规范。对对话框的布局进行了更改以提高可用性。

作为用户，您不会感到困惑，因为您只在单个 API 级别使用单个设备。令人困惑的**是**，当开发人员创建非标准 UI 时。不遵守标准会导致沮丧和困惑。例如，如果用户手机上的所有其他应用程序（API 级别 >14）创建具有正确按钮顺序的标准对话框，而您的应用程序的按钮顺序错误，则会导致用户点击取消而不是发送，反之亦然。当然，这会使用户感到困惑和烦恼。

检查设备上的 API 级别并提供适当的布局实际上并没有太多额外的工作。如果您的应用程序设计得很好，那么它只需要几行代码。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-31T00:49:28.833

关于您的最后一条评论，您仍然可以从代码中执行所有 AlertDialog 内容，并且能够控制诸如何时关闭对话框之类的事情，只需使用 a`View.onClickListener`而不是`DialogInterface.onClickListener`：

```
AlertDialog d = new AlertDialog.Builder(context)
        .setPositiveButton(R.string.button_text, null).show(); 
```

然后添加监听器：

```
d.getButton(AlertDialog.BUTTON_POSITIVE)
        .setOnClickListener(new View.onClickListener() {...}); 
```

添加备用侦听器可防止在按下按钮时自动关闭对话框。

# c# - nHibernate queryover 复杂查询

> ID：11563586
> 
> 赞同：0
> 
> 时间：2012-07-19T14:57:37.553
> 
> 标签：c#, nhibernate, queryover

我一直在为此奋斗一整天，似乎无法得到我想要的结果。我想在其标签集合中获取所有具有特定标签的节点。

我正在使用这个 QueryOver 命令，但我得到了所有可能的节点，即使它看起来对我来说应该只是一个。

```
 public IEnumerable<Node> GetAllWithTag(int tagId)
    {
        tags = new List<Tag>();
        Node node = null;
        Tag tagQ = null;

        var subQuery = QueryOver.Of<Tag>(() => tagQ)
            .Where(tag1 => tag1.Id == tagId).DetachedCriteria;

        subQuery = subQuery.SetProjection(Projections.Property("Id"));

        var nodes = _applicationUnitOfWork.GetSession().QueryOver<Node>(
            () => node).Where(Subqueries.Exists(subQuery)).List<Node>();

        return nodes;
    } 
```

我正在使用这个奇怪的设置，因为当我尝试在 node.Tags 上使用 Contains 时出现方法错误。所以我阅读了一下，似乎大多数人都采用了这样的解决方案。我只是不知道我在哪里做一些愚蠢的事情。非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:16:51.157

您是否尝试过使用[`JoinQueryOver`or`JoinAlias`](http://nhforge.org/doc/nh/en/index.html#queryqueryover-associations)？

像这样的东西：

```
public IEnumerable<Node> GetAllWithTag(int tagId)
{
    return _applicationUnitOfWork.GetSession().QueryOver<Node>()
        .JoinQueryOver<Tag>(n => n.Tags)
            .Where(t => t.Id == tagId)
            .List<Node>();
} 
```

# visual-studio-2010 - Visual Studio 2010 一直抱怨 Invalid XML 尽管没有（WP7）

> ID：11563588
> 
> 赞同：0
> 
> 时间：2012-07-19T14:57:38.993
> 
> 标签：visual-studio-2010, windows-phone-7, xaml

在创建 Windows Phone 7 应用程序时，我在 Visual Studio 2010 中遇到了一个奇怪的行为。一段时间后，VS 开始抱怨 Invalid XAML 虽然没有问题，并且应用程序编译并运行得很好。

它困扰着我，因为我不能使用可视化设计器说“在“DataTemplate”上引发了异常：无效的 XML”，并且代码中突出显示了一个 DataTemplate。数据模板总是好的，当复制粘贴到另一个项目时，VS 不会抱怨它。

我发现有问题的通常是带有自定义转换器的 DataTemplates 或使用 PhonePerformance 之类的类时。

有时错误是“由于文档错误引发的异常：无效的 XML”，并且 XAML 文件中甚至没有突出显示。

我尝试重新安装.NET。Visual Studio 等，并且问题发生在两台独立的机器上，所以我认为它不是特定于我的配置。它可能特定于我的代码。

有没有人经历过类似的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:02:22.990

使用 XAML 时，如果您引用需要评估但不能在设计时进行评估的库，则会出现此类错误。您可以关闭可视化编辑器并只在 XAML 中工作 - 这将停止错误（并节省您的时间）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:55:59.540

您重新安装了 .NET 和 VisualStudio ？？？您应该刚刚启动了第二个实例，在两个实例中都打开了解决方案，然后将调试器从一个实例附加到第二个实例，并打开了可视化编辑器。它会准确地告诉您代码中导致问题的原因。转换器中还有[DesignerProperties.IsInDesignMode](http://msdn.microsoft.com/en-us/library/system.componentmodel.designerproperties.isindesignmode(v=vs.95).aspx)。天哪。你浪费了这么多时间:(

至于设计时数据，这很棘手。要么您拥有不是的 DesignTimeDataWithDesignTimeCreatableTypes，要么*是无法*为您的真实类型创建代理的 DesignData（无论出于何种原因，[过去曾多次遇到此问题](https://stackoverflow.com/questions/2932039/object-does-not-match-target-type-in-designdata)）。

解决这个问题的唯一方法是从另一个实例中调试一个实例。它实际上并不难。我经常这样做（调试 WF4 ActivityDesigners）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T07:15:49.357

一位朋友找到了解决方案，您不会相信问题出在哪里。如果程序集名称中有空格，则会发生这种情况。我发现我在所有有问题的项目中的程序集名称中确实有一个空格，重命名了程序集并且设计器再次工作。

这里也提到了解决方案[http://forums.silverlight.net/t/115011.aspx/1](http://forums.silverlight.net/t/115011.aspx/1)

# xml - 在 XSLT 中选择并附加当前节点的文本值？

> ID：11563590
> 
> 赞同：2
> 
> 时间：2012-07-19T14:58:08.350
> 
> 标签：xml, xslt, xpath, xquery, xslt-2.0

> **可能重复：**
> [从 XML 节点 java 生成/获取 xpath](https://stackoverflow.com/questions/4746299/generate-get-xpath-from-xml-node-java)

这是我之前提出的问题的后续问题[，](https://stackoverflow.com/questions/11297807)（我决定作为一个单独的问题提出，因为之前的问题似乎变得太大了）。

我有以下 XSLT，它允许我将指定的 XML 字符串转换为一组 XPath 表达式：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="text()"/>

    <xsl:template match="*[not(*)]">
        <xsl:for-each select="ancestor-or-self::*">
            <xsl:value-of select="concat('/',local-name(),'[',count(preceding-sibling::*[local-name()=local-name(current())])+1,']')"/>
        </xsl:for-each>
        <xsl:text>&#xA;</xsl:text>
        <xsl:apply-templates select="node()"/>
    </xsl:template>

</xsl:stylesheet> 
```

例如，XML 字符串：

```
<ns1:create xmlns:ns1='http://predic8.com/wsdl/material/ArticleService/1/'>
    <article xmlns:ns1='http://predic8.com/material/1/'>
        <name />
        <description />
        <price xmlns:ns1='http://predic8.com/common/1/'>
            <amount />
            <currency xmlns:ns1='http://predic8.com/common/1/‘&gt;AUD</currency>
        </price>
        <id xmlns:ns1='http://predic8.com/material/1/‘&gt;1</id>
    </article>
    <article xmlns:ns1='http://predic8.com/material/2/'>
        <name xmlns:ns1='http://predic8.com/material/2/'>some name</name>
        <description xmlns:ns1='http://predic8.com/material/2/'>some description</description>
        <price xmlns:ns1='http://predic8.com/common/2/'>
            <amount xmlns:ns1='http://predic8.com/common/2/'>00.01</amount>
            <currency xmlns:ns1='http://predic8.com/common/2/'>USD</currency>
        </price>
        <id xmlns:ns1='http://predic8.com/material/2/'>2</id>
    </article>
</ns1:create> 
```

会变成：

```
/create[1]/article[1]/name[1]
/create[1]/article[1]/description[1]
/create[1]/article[1]/price[1]/amount[1]
/create[1]/article[1]/price[1]/currency[1] , AUD
/create[1]/article[1]/id[1] , 1
/create[1]/article[2]/name[1]
/create[1]/article[2]/description[1]
/create[1]/article[2]/price[1]/amount[1]
/create[1]/article[2]/price[1]/currency[1]
/create[1]/article[2]/id[1] 
```

**我的问题：** 如何修改 XSLT 以便我还可以*选择并附加当前节点的文本值*。还要注意，正如我在提供的示例 XML 文件中所说明的那样，某些节点可能不包含文本值等。

因此，对于上面的示例，我期望类似（例如逗号分隔的输出）：

```
/create[1]/article[1]/name[1] , 
/create[1]/article[1]/description[1] , 
/create[1]/article[1]/price[1]/amount[1] , 
/create[1]/article[1]/price[1]/currency[1] , 
/create[1]/article[1]/id[1] , 
/create[1]/article[2]/name[1] , some name
/create[1]/article[2]/description[1] , some description
/create[1]/article[2]/price[1]/amount[1] , 00.01
/create[1]/article[2]/price[1]/currency[1] , USD
/create[1]/article[2]/id[1] , 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:17:23.867

它应该像`select=./text()`在适当的节点上添加 a 一样简单，还是我错过了您的问题中的一些微妙之处？

```
<xsl:template match="*[not(*)]">
    <xsl:for-each select="ancestor-or-self::*">
        <xsl:value-of select="concat('/',local-name(),'[',count(preceding-sibling::*[local-name()=local-name(current())])+1,']')"/>
    </xsl:for-each>
    <xsl:text> , </xsl:text>
    <xsl:value-of select="./text()"/>
    <xsl:text>&#xA;</xsl:text>
    <xsl:apply-templates select="node()"/>
</xsl:template> 
```

输出：

```
/create[1]/article[1]/name[1] , 
/create[1]/article[1]/description[1] , 
/create[1]/article[1]/price[1]/amount[1] , 
/create[1]/article[1]/price[1]/currency[1] , AUD
/create[1]/article[1]/id[1] , 1
/create[1]/article[2]/name[1] , some name
/create[1]/article[2]/description[1] , some description
/create[1]/article[2]/price[1]/amount[1] , 00.01
/create[1]/article[2]/price[1]/currency[1] , USD
/create[1]/article[2]/id[1] , 2 
```

# javascript - 动态 html 图像和跨度上的 Jquery onmouseover() 函数

> ID：11563591
> 
> 赞同：1
> 
> 时间：2012-07-19T14:58:08.957
> 
> 标签：javascript, jquery, html

我的页面上有一些图像和一些跨度文本。每个图像都有他的文本，这些元素是用 javascript 动态添加的。

现在，我想在检测到图像上的鼠标悬停时显示正确的消息。

不容易解释，所以举个例子：

```
var len = article_affiliations.length;
for (var affiliation_id = 0; affiliation_id < len; affiliation_id++)
{
    $('#country_warning' + affiliation_id).mouseover(function () {
        document.getElementById('country_warning_message' + affiliation_id)
            .style.visibility = 'visible';
    }).mouseout(function () {
        document.getElementById('country_warning_message' + affiliation_id)
            .style.visibility = 'hidden';
    }); 
} 
```

问题是，当调用 onmouseover 函数时，affiliation_id 将具有最大值，并且消息将显示在最后一张图片附近，而不是点击的附近。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:02:36.270

闭包应该可以解决问题：

```
for(var affiliation_id=0; affiliation_id<article_affiliations.length; affiliation_id++) {
    (function(i){
         $('#country_warning'+i).mouseover(function() {
              $('#country_warning_message'+i).css('visibility','visible');
         }).mouseout(function(){
              $('#country_warning_message'+i).css('visibility','hidden');
         });
    })(affiliation_id);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:03:04.067

你需要将你的 for 循环绑定到一个闭包中才能工作。这样，所有的索引`#country_warning_i`都会受到影响。

```
$(function () {
    $.each(article_affiliations, function (i, v) {
        $('#country_warning' + i).mouseover(function (affiliation_id, affiliation_iddddd) {
            $('country_warning_message' + i).style.visibility = 'visible';
        }).mouseout(function (i, affiliation_iddddd) {
            $('country_warning_message' + i).style.visibility = 'hidden';
        });
    });
}); 
```

享受和好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:08:24.173

您不应该使用只会遍历所有元素的循环来执行此操作。做这样的事情的最好方法是使用'event.target'（内置jQuery）和'this'对象。

而是将鼠标悬停事件处理程序附加到您的 . 最好的情况是您的标记看起来像这样：

```
<div class="item">
 <img src="someimage.jpg" />
 <span>some text</span>
</div>
<div class="item">
 <img src="someimage.jpg" />
 <span>some text</span>
</div>
<div class="item">
 <img src="someimage.jpg" />
 <span>some text</span>
</div> 
```

这样你就可以使用类似于这个的脚本：

```
$('.item').on('mouseover', function() {
 $(this).find('span').show();
}); 
```

这将在您将鼠标悬停事件附加到的元素内搜索一个跨度（每个跨度）（对于这个前）。

另一种方法是像这样使用简单的 css：

```
span {
 visibility: hidden;
}
item:hover span {
 visibility: visible;
} 
```

这是一个非常简单的解决方案，效果很好，但不幸的是 IE6 不支持将鼠标悬停在不同于 .

# c# - 从枚举隐式转换为另一种类型 (CloudBlobContainer)

> ID：11563593
> 
> 赞同：0
> 
> 时间：2012-07-19T14:58:11.823
> 
> 标签：c#, enums, azure-storage, implicit-conversion

是否可以将枚举投射到另一个对象？

我列举了一个 blob 容器列表。我想将枚举类型隐式转换为命名的`CloudBlobContainer`

这是我尝试过的一个例子

```
public static class BlobContainerCasts
{
    public static implicit operator CloudBlobContainer(EnumTypes.BlobContainerNames BlobContainerName)
    {
        return CloudStorageAccount.DevelopmentStorageAccount.CreateCloudBlobClient().GetContainerReference(Enum.GetName(typeof(EnumTypes.BlobContainerNames), BlobContainerName));
    }
} 
```

不幸的是，它不会编译，因为它不遵守关于用户定义转换的规则（它必须转换为封闭类型或从封闭类型转换）

那么，有没有办法在不创建这样的方法的情况下做到这一点？

```
public CloudBlobContainer GetBlobContainer(EnumTypes.BlobContainerNames BlobContainerName)
{...} 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:41:00.873

您可以使用扩展方法：

```
public static CloudBlobContainerExtensions {
    public static CloudBlobContainer GetContainer(this EnumTypes.BlobContainerNames BlobContainerName)
    {
        return CloudStorageAccount.DevelopmentStorageAccount.CreateCloudBlobClient().GetContainerReference(Enum.GetName(typeof(EnumTypes.BlobContainerNames), BlobContainerName));
    }
}
//elsewhere
var myContainer = CloudBlobContainer.GetContainer(EnumTypes.BlobContainerNames.SomeName); 
```

旁注：您确定要显式引用 DevelopmentStorageAccount 而不是从设置中获取存储帐户吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T08:00:18.373

基于breischl answere，这是解决方案：

```
public static CloudBlobContainerExtensions {
    public static CloudBlobContainer GetContainer(this EnumTypes.BlobContainerNames BlobContainerName)
    {
        return CloudStorageAccount.DevelopmentStorageAccount.CreateCloudBlobClient().GetContainerReference(Enum.GetName(typeof(EnumTypes.BlobContainerNames), BlobContainerName));
    }
}

//elsewhere
var myContainer = EnumTypes.BlobContainerNames.somename.GetContainer(); 
```

# java - 为没有键的 Map 实现 entrySet

> ID：11563598
> 
> 赞同：1
> 
> 时间：2012-07-19T14:58:38.837
> 
> 标签：java, map

我写了一个`TrieMap<V> implements Map<String,V>`显然是从字符串键入的类。这工作正常。

我想用更通用的键来增强它`CharSequence`。我相信除了最后一个问题之外，我已经设法实现了转换，我无法创建 type 的对象`K`。

因此，签名现在必须变为`TrieMap<K extends CharSequence,V> implements Map<K,V>`。问题是，我相信您知道，a`TrieMap`实际上并不存储原始密钥。（事实上​​，这是它的主要价值之一，因此它通常比普通地图占用更少的空间。）

因此，为了实现`Set<Entry<K, V>> entrySet()`，我必须以某种方式制造类型的对象`K`。有什么方法可以实现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:04:36.770

我将定义以下接口：

```
public interface KeyBuilder<K extends CharSequence> {
    public K build(CharSequence value);
} 
```

并为`TrieMap`构造函数提供接口的实现。当你需要建立一个新的 K 实例时，你要求接口去做。

您可能会使用更适合您的数据结构的东西作为`build`方法的参数，CharSequence 只是一种可能性。如果你想做一些更复杂的事情，你可以像这样构造它：

```
public interface KeyFactory<K extends CharSequence> {
    public KeyBuilder<K> newBuilder();
}

public interface KeySequence<K extends CharSequence> {
    public KeySequence<K> append(char value);
    public K build();
} 
```

通过`String`实现：

```
public class StringKeyFactory<String> {
    public KeyBuilder<String> newBuilder() {
        return new KeyBuilder<String>() {
            private final StringBuilder s = new StringBuilder();
            public KeySequence<String> append(char value) {
                s.append(value);
                return this;
            }
            public String build() {
                return s.toString();
            }
        };
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:07:07.217

`Factory<K>`不，我不明白如果在构造函数中不使用 as 参数怎么可能。这`Factory<K>`将负责`K`根据您在`TrieMap`.

# c# - 如何使用 ObjectListView 或 TreeListView 显示树结构

> ID：11563600
> 
> 赞同：2
> 
> 时间：2012-07-19T14:58:41.630
> 
> 标签：c#, tree, objectlistview

我一直在研究 ObjectListView for .NET，并尝试自己弄乱它。

我来自将 VirtualTreeview 与 Delphi 一起使用，所以如果你能指出相似之处，那就太好了！

我尝试使用 TreeListView 和以下类创建多级树：

```
public class MyClass
{
    public string Name { get; set; }
    public List<MyClass> MyClasses { get; set; }
    public MyClass(string name)
    {
        Name = name;
        MyClasses = new List<MyClass>();
    }
} 
```

TreeListView 是一个设计时组件。我使用此代码创建虚拟数据并让 TreeListView 显示它。

```
var MyClasses = new List<MyClass>();
MyClasses.Add(new MyClass("Bob"));
MyClasses.Add(new MyClass("John"));
var myClass = new MyClass("Mike");
myClass.MyClasses.Add(new MyClass("Joe"));
MyClasses.Add(myClass);

treeListView1.SetObjects(MyClasses); 
```

我还有一列显示 Name 属性。

所有这些都有效，除了我没有看到 Mike 节点的子节点。我似乎无法弄清楚在这里做什么。我查看了文档，但找不到任何有用的东西。

此外，像这样的多级结构可以与 ObjectListView 的其他变体（例如 FastObjectListView）一起使用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-23T15:03:14.937

终于想通了！

显然，ObjectListView 套件的唯一变体可以通过设计用于树结构，是`TreeListView`！

这是我设法让我的 TreeListView 显示以下类的列表的方法：

```
public class MyClass
{
    public string Name { get; set; }
    public List<MyClass> MyClasses { get; set; }
    public MyClass(string name)
    {
        Name = name;
        MyClasses = new List<MyClass>();
    }
} 
```

在 Form 构造函数中，我们需要 2 个委托 - 一个用于告诉 OLV 对象有子对象，另一个用于将子对象列表传递给 OLV。

```
// model is the currently queried object, we return true or false according to the amount of children we have in our MyClasses List
treeListView1.CanExpandGetter = model => ((MyClass)model).
                                              MyClasses.Count > 0;
// We return the list of MyClasses that shall be considered Children.
treeListView1.ChildrenGetter = delegate(object model)
                                       {
                                           return ((MyClass) model).
                                                   MyClasses;
                                       };

// We also need to tell OLV what objects to display as root nodes
treeListView1.SetObjects(listOfObjects); 
```

我还发现每次向父对象添加子对象时都需要刷新父对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T02:55:01.927

我在这里找到了文档：http: [//objectlistview.sourceforge.net/html/cookbook.htm#recipeTreeListView](http://objectlistview.sourceforge.net/html/cookbook.htm#recipeTreeListView)加上使用 ObjectListView 附带的演示非常好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-22T09:57:42.213

For anyone else having this issue, please note that setting the delegates **MUST COME BEFORE** setting the roots. The delegates are used internally to rebuild the representation of the tree when the roots are set.

# php - mySQL/PHP：一行中的 SQL 语句、查询和结果分配？

> ID：11563601
> 
> 赞同：0
> 
> 时间：2012-07-19T14:58:43.357
> 
> 标签：php, mysql

`if (result > 0)`是否可以仅用一行（或更短）重写下面的代码，甚至可以使用语句？

```
// a simple query that ALWAYS gets ONE table row as result
$query  = $this->db->query("SELECT id FROM mytable WHERE this = that;");
$result = $query->fetch_object();
$id     = $result->id; 
```

我已经看到了很棒的、极其简化的结构，例如三元运算符（[这里](http://davidwalsh.name/php-shorthand-if-else-ternary-operators)和[这里](http://davidwalsh.name/javascript-shorthand-if-else-examples)-顺便说一下，看到更多简化行的评论）将 4-5 行合二为一，所以也许有一些像上面这样的单结果 SQL 查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:04:27.657

你可以缩短

```
$query  = $this->db->query("SELECT id FROM mytable WHERE this = that;");
$result = $query->fetch_object();
$id     = $result->id; 
```

到

```
$id = $this->db->query("SELECT id FROM mytable WHERE this = that")->fetch_object()->id; 
```

但是，如果任何函数返回意外响应，原始代码将发出错误。最好写：

```
$query  = $this->db->query("SELECT id FROM mytable WHERE this = that");
if (!$query) {
     error_log('query() failed');
     return false;
}
$result = $query->fetch_object();
if (!$result) {
     error_log('fetch_object() failed');
     return false;
}
$id     = $result->id; 
```

# jquery - 如何获取当前页面的ID

> ID：11563602
> 
> 赞同：0
> 
> 时间：2012-07-19T14:58:45.117
> 
> 标签：jquery, asp.net-mvc-3

如何获取页面的id。

如果你能帮忙。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:02:13.693

如果您一直期望它是 url 的最后一部分，那么您可以这样做：

```
var splits = window.location.pathname.split('/');
var id = -1;
if(splits.length > 0)
   id = splits[splits.length -1]; 
```

# mysql - Mysql SELECT查询和性能

> ID：11563603
> 
> 赞同：0
> 
> 时间：2012-07-19T14:58:48.173
> 
> 标签：mysql, django, performance, django-queryset, database-performance

`SELECT`我想知道在具有不太具体的 WHERE 子句`SELECT`的查询和具有更具体的子句的另一个查询之间是否有性能提升`WHERE`。

例如是查询：

```
SELECT * FROM table1 WHERE first_name='Georges'; 
```

比这个慢：

```
SELECT * FROM table1 WHERE first_name='Georges' AND nickname='Gigi'; 
```

换句话说，是否有时间因素与`WHERE`条款的准确性有关？

我不确定是否很容易理解，即使我的问题考虑到了数据库查询中涉及的所有组件（在我的例子中是 MYSQL）

我的问题与 Django 框架有关，因为我想缓存一个评估的查询集，并在下一个请求时，取回这个缓存评估的查询集，对其进行更多过滤，然后再次评估它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:06:49.827

是的，它可能会更慢。这一切都取决于您拥有的索引和数据分布。检查链接[了解查询执行计划](http://dev.mysql.com/doc/refman/5.5/en/execution-plan-information.html)

有关如何知道 MySQL 在执行查询时要做什么的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:00:52.680

对此没有硬性规定。

通过向子句添加更多条件可以提高或降低性能`WHERE`，因为它取决于以下因素：

*   索引
*   图式
*   数据量
*   数据基数
*   统计数据
*   查询引擎的智能

您需要使用您的数据集进行测试，并确定什么表现最好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:02:29.203

MySql 服务器必须比较您的子句中的所有列`WHERE`（如果全部加入`AND`）。

因此，如果您在列上没有任何索引，则`nickname`第二个查询会稍微慢一些。

在这里您可以阅读列索引的工作原理（与您的问题类似的示例）：[http ://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T15:03:09.547

我认为这个问题很难回答，涉及的方面太多（例如：索引）。我会说第一个查询比第一个查询**快**，但我不能肯定地说。

如果这对您很重要，为什么不运行模拟（例如：运行 1'000'000 个查询）并检查时间？

# forms - 预填充 Spring MVC 表单

> ID：11563609
> 
> 赞同：4
> 
> 时间：2012-07-19T14:59:02.060
> 
> 标签：forms, spring-mvc, session-variables

我正在寻找一种从会话范围 bean 中存储的值**预填充 Spring MVC 表单的方法。**（使用这个命名空间：[http](http://www.springframework.org/tags/form) ://www.springframework.org/tags/form ）。

例如，假设我向 uiModel 添加了**一个****queryInfo**对象。

 **如何显示来自**queryInfo**对象的**名称**实例变量？

 **```
<form:input path="queryInfo.name" /> 
```

这可能吗？如果有怎么办？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-20T03:26:52.417

在您的请求映射中，将 bean 添加到模型中：

```
model.addAttribute("queryInfo", queryInfo); 
```

然后在表单标签中使用modelAttribute将其绑定到表单：

```
<form:form id="some-form" modelAttribute="queryInfo">

... 
```

现在，当您执行此操作时，将显示名称（前提是您的对象中有一个适当命名的 getter）：

```
<form:input path="name" /> 
```

请记住 form:input 是 form:form 的子标签。它不适合单独使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-24T16:48:22.100

@skel625 的 form:input 解决方案是完美的，但在 form:select 的情况下，使用不同的选项如何设置属性？因为这种方式只适用于表单：输入

我的形式：选择是这样的：

```
<form:select path="dolorefastidio">
                        <option value="1"><spring:message code="questionnaire.compile.label.paindiscomfort.one"/></option>
                        <option value="2"><spring:message code="questionnaire.compile.label.paindiscomfort.two"/></option>
                        <option value="3"><spring:message code="questionnaire.compile.label.paindiscomfort.three"/></option>
                        <option value="4"><spring:message code="questionnaire.compile.label.paindiscomfort.four"/></option>
                        <option value="5"><spring:message code="questionnaire.compile.label.paindiscomfort.five"/></option>
                    </form:select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-21T22:05:07.153

> 解决方案放在一个值属性中，像这样的bean属性

考试报名表

```
 <div class="form-group has-success">
                        <label for="code" class="col-lg-3 control-label">Exam Code</label>
                        <div class="col-lg-9">
                            <form:input type="text" class="form-control" path="cod" placeholder="code" value="${editExam.cod}"/>                        
                            <form:errors path="cod" cssClass="error" />
                        </div>
                    </div>

                    <div class="form-group has-success">
                        <label for="name" class="col-lg-3 control-label">Exam Name</label>
                        <div class="col-lg-9">
                            <form:input type="text" class="form-control" path="name" placeholder="name" value="${editExam.name}"/>
                            <form:errors path="name" cssClass="error" />
                        </div>
                    </div>

                    <div class="form-group has-success">
                        <label for="teachNme" class="col-lg-3 control-label">Teacher Name</label>
                        <div class="col-lg-9">
                            <form:input type="text" class="form-control" path="teachName"
                                placeholder="Teacher Name" value="${exams.teachName}"  />
                            <form:errors path="teachName" cssClass="error" />
                        </div>
                    </div>

                    <div class="form-group has-success">
                        <label for="vote" class="col-lg-3 control-label">Final Grade</label>
                        <div class="col-lg-9">
                            <form:input type="text" class="form-control" path="vote"
                                placeholder="Vote" value="${exams.vote}"  />
                            <form:errors path="vote" cssClass="error" />
                        </div>
                    </div>

                    <div class="form-group has-success">
                        <label for="cfu" class="col-lg-3 control-label">Credits (CFU)</label>
                        <div class="col-lg-9">
                            <form:input type="text" class="form-control" path="cfu"
                                placeholder="Credits" value="${editExam.cfu}"  />
                            <form:errors path="cfu" cssClass="error" />
                        </div>
                    </div>
                    <input type="submit" value="Save"
                        class="btn btn-primary pull-right">
                </fieldset>
            </form:form> 
```****

# google-chrome - 页面滚动时 CSS3 动画打破固定定位

> ID：11563612
> 
> 赞同：7
> 
> 时间：2012-07-19T14:59:13.760
> 
> 标签：google-chrome, css, css-animations

我在试图弄清楚为什么 chrome 时遇到了麻烦（这使得固定标题完全消失，Firefox 将它保留在那里但让绝对定位的元素流过固定元素，我已经使用 opacity:.99 避免了这个问题，但我仍然让我心烦意乱，这如何解决它。

[http://www.rickpascua.cu.cc/newsite-snazzy/index.html](http://www.rickpascua.cu.cc/newsite-snazzy/index.html) <--- 问题页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T10:59:52.237

将以下 CSS 设置为消失元素

```
-webkit-transform: translate3d(0, 0, 0);
transform        : translate3d(0, 0, 0); 
```

该`transform`属性`translated3d`不存在。`translate3d`确实，并且应该使用同一页面上的动画元素解决固定定位问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-03T09:41:18.067

**编辑：用户@jacob 指出这是一种错误的方法，会对性能产生负面影响。任何强制硬件加速的属性都可以解决问题，但不要全局应用此规则，而是尝试将此规则应用于仅破坏的元素。**

在将 animate.css 与 zurb 的基础结合时遇到了类似的问题。

我根据 Ryan Wu 的回答提出的解决方案

```
* {
backface-visibility: hidden;
} 
```

它解决了我的问题（固定元素在动画过程中丢失填充/边框和其他讨厌的东西）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-20T10:53:58.617

我仍然不知道为什么 CSS 动画会破坏布局。在我的测试中，随着动画的运行，`overflow:hidden;z-index`在标题上会导致它失去固定的定位！不过，我确实有答案。

首先，删除

```
overflow:hidden;
visibility:visible;
z-index:99; 
```

来自固定位置的标题元素`<div id="header">`。

但是，删除了这 3 个属性后，它们`<div id="slide-contain"/>`仍然会重叠！这是因为隐式堆叠上下文分层，请参阅[CSS_absolute_and_fixed_positioning#The_third_dimension](http://www.w3.org/wiki/CSS_absolute_and_fixed_positioning#The_third_dimension.E2.80.94z-index)文章中的 7 层。

发生不需要的重叠是因为`position:relative`已在`<div id="slide-contain"/>`（它是 的后代`<div id="wrapper"/>`）上设置但该元素上**没有`z-index`**。我意识到添加了相对定位是因为您想在其中绝对定位一些子元素。

因此，该`<div id="slide-contain"/>`元素与页面上没有 z-index 的所有其他元素位于同一 Z 平面上，其中包括固定标题。根据链接的文章，这两个元素都处于*第 6 级 - 定位的后代，堆栈级别设置为 auto 或 (zero) ，并且堆叠默认为**元素在 DOM 上出现的顺序*，因此`<div id="slide-contain"/>`在 `.

因此`z-index:1`，标题上需要 a 始终将标题呈现在顶部。它只需要大于0，所以`z-index:99`改为`z-index:1`

另一种解决方案是在以下同级上提供**否定** `z-index`（和） 。`position:relative``<div id="wrapper"/>`

您可能认为在 上添加负数`z-index`就`<div id="slide-contain"/>`足够了，但它需要复制到元素祖先，否则`<div id="slide-contain"/>`将被推到其父元素后面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-29T21:53:44.780

我相信这个错误的发生是因为容器的动画被卸载到 GPU 上；但是，固定定位将后代从流中取出，因此它不会与容器一起卸载。然后错误地合成了固定位置元素。将任何硬件加速属性（例如`translate3d`）添加到固定位置的元素似乎可以“解决”问题（我相信因为它也会被卸载到 GPU，从而避免了合成过程中的问题）。

前任

```
<div class="container">
  <div class="fixed"></div>
</div> 
```

* * *

```
.container {
  animation-duration: 0.8s;
  animation-name: some-animation;
}

.fixed {
  /* transform: translateX(-200%); */
  transform: translate3d(-200%, 0, 0);
  position: fixed;
  top: 10rem;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T18:12:54.250

```
background: url(../assets/logo.png) center no-repeat,url(../assets/header2.jpg) bottom center;
height: 50px;
width: 100%;
border-bottom: 5px solid black;
position: fixed;
text-align: center;
z-index: 99; 
```

试试这个，它会起作用的。

但是您在使用浮动 div 的标题 div 中的内部 html 也存在问题，因此如果您想使用溢出：隐藏或自动，您还应该对它们使用 clear 类。

# javascript - 烧瓶形式和 javascript

> ID：11563613
> 
> 赞同：1
> 
> 时间：2012-07-19T14:59:27.097
> 
> 标签：javascript, python, html, get, flask

你好我有下面的html代码

```
<form>
<input type="text" id="filepathz" size="40" placeholder="Spot your project files">
<input type="button" id="spotButton" value="Spot">
</form> 
```

javascript代码

```
 window.onload = init;

  function init() {
          var button = document.getElementById("spotButton");
          button.onclick = handleButtonClick;
  }       

  function handleButtonClick(e) {
          var filepathz = document.getElementById("filepathz");

         var path = filepathz.value;

         if (path == "") {
                 alert("give a filepath");
         }else{
                 var url = "http://localhost:5000/tx/checkme/filepathz=" + path;
                 window.open (url,'_self',false);
         }       
 } 
```

和烧瓶上的python代码

```
def index():
        """Load start page where you select your project folder
        or load history projects from local db"""
        from txclib import get_version
        txc_version = get_version()
        prj = project.Project(path_to_tx)

        # Let's create a resource list from our config file
        res_list = []
        prev_proj = ''
        for idx, res in enumerate(prj.get_resource_list()):
                hostname = prj.get_resource_host(res)
        username, password = prj.getset_host_credentials(hostname)
        return render_template('init.html', txc_version=txc_version, username=username)

    @app.route('/tx/checkme/<filepathz>')
    def checkme(filepathz):
            filepathz = request.args.get('filepathz')
            return render_template('init.html', txc_version=filepathz) 
```

我在做什么错并且无法从表单（filepathz）中获取数据<---我没有得到

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:49:44.547

您没有正确传递变量。传递变量有两种方式：

1）通过get方法传递它：

```
http://localhost:5000/tx/checkme/?filepathz=" + path; (Note the '?') 
```

目前您正在尝试从 request.args 获取变量但没有在请求中传递它，这就是您没有得到的原因。

2）从带有flask的url结构的url中获取它：

在 JS 中执行此操作：`http://localhost:5000/tx/checkme/" + path`

在你看来：

```
@app.route('/tx/checkme/<filepathz>')
def checkme(filepathz):
      return render_template('init.html', txc_version=filepathz) # You can use this variable directly since you got it as a function arguement. 
```

# python - 在python中将拼写错误的单词与正确的单词匹配

> ID：11563615
> 
> 赞同：4
> 
> 时间：2012-07-19T14:59:39.913
> 
> 标签：python, regex

我正在构建一个接收传入短信的应用程序，然后根据关键字，它会查看该关键字是否与它正在运行的任何活动相关联。我现在这样做的方式是加载关键字列表和可能的拼写组合，然后当 SMS 进来时，我会查看所有关键字和组合以查看是否匹配。

不使用这种方法，而是通过实际查找可能与另一个单词匹配的单词，您将如何做到这一点。

假设正确的拼写是 HAMSTER，通常我会给出竞选替代品，如 HMSTER HIMSTER HAMSTAR HAMSTR HAMSTIR 等。

有这样做的聪明方法吗？

仓鼠

“hamstir”.compare_to（“仓鼠”）？匹配

编辑：

2个字怎么样？假设我们知道短信中有两个词需要匹配：

正确的第一个词=第一个词

正确的第二个单词 = AND SECOND WORD

SMS = 第一个字第二个

编辑：

理想情况下，人们应该短信逗号分隔的单词，这样我就会知道在哪里拆分并查找单词。

但是，如果他们不这样做，例如：

**唯一关键字** *第二参数*

我怎么知道单词在哪里分裂？第一个词可能是 3 个词长，第二个词可能是 3 个或 1 个或 2 个等。

在这些示例中，您将如何使用以下技术来找到这两个词？

你会看两次吗？每个需要的参数或关键字一个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T15:10:08.607

最简单的解决方案是使用[difflib](http://docs.python.org/library/difflib.html)包，它具有`get_close_matches`近似字符串匹配的功能：

```
import difflib
difflib.get_close_matches(word, possibilities) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T15:06:04.427

您正在寻找的是[Levenshtein Distance](http://en.wikipedia.org/wiki/Levenshtein_distance)。

假设您的广告系列列表不是太大，您可以计算输入词与每个广告系列之间的距离，然后选择最短的一个。要过滤掉完全错误的单词，您可能需要设置可接受的最小距离，如果最短距离仍然超出限制，则丢弃输入。

要计算两个单词之间的距离，您可以尝试以下模块之一：

*   [levenshtein.py](http://hetland.org/coding/python/levenshtein.py)
*   [蟒蛇-Levenshtein](http://pypi.python.org/pypi/python-Levenshtein/)。
*   [py-editdist](http://code.google.com/p/py-editdist/)

例如，使用`levenshtein.py`：

```
from levenshtein import levenshtein
campaigns = (
    "HAMSTER",
    "TWO WORDED",
    "FRIDAY",
)

def get_campaign(word):
  return min(campaigns, key=lambda x: levenshtein(word, x)) 
```

用法：

```
>>> get_campaign("HAMSTA")
'HAMSTER'
>>> get_campaign("HAM WORDED")
'TWO WORDED'
>>> get_campaign("FROODY")
'FRIDAY'
>>> get_campaign("FRIDAY")
'FRIDAY' 
```

请注意，这是一种非常简单的方法，即使输入完全不同，它也总会返回一些东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T15:06:10.713

我使用 levenshtein 距离来解决类似的问题，请参阅[http://en.wikipedia.org/wiki/Levenshtein_distance](http://en.wikipedia.org/wiki/Levenshtein_distance)

```
def distance(u1, u2):
    try:
        s1 = unicode(u1)    
        s2 = unicode(u2)
    except:
        s1 = u1
        s2 = u2        
    if len(s1) < len(s2):
        return distance(u2, u1)
    if not s1:
        return len(s2)

    previous_row = xrange(len(s2) + 1)
    for i, c1 in enumerate(s1):
        current_row = [i + 1]
        for j, c2 in enumerate(s2):
            insertions = previous_row[j + 1] + 1 # j+1 instead of j since previous_row and current_row are one character longer
            deletions = current_row[j] + 1       # than s2
            substitutions = previous_row[j] + (c1 != c2)
            current_row.append(min(insertions, deletions, substitutions))
        previous_row = current_row

    return previous_row[-1]

distance("hamstir", "hamster") < 3
True
distance("god", "hamster") < 3
False 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T15:09:22.037

在我看来，您正在尝试构建拼写检查器。您可以使用[最小编辑距离匹配](http://en.wikipedia.org/wiki/Edit_distance)。或者，看看[Peter Norvig 的 python 拼写检查器](http://norvig.com/spell-correct.html)

希望有帮助

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T13:32:01.650

您可以使用模糊匹配和带[`regex`库](http://pypi.python.org/pypi/regex)的命名列表，例如，从列表中查找最多有一个错误（插入、删除、替换）的任何短语：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import regex as re # pip install regex

words = ["first word", "second word", "third"]
sms = u"junk Furﬆ Word second Third"

for m in re.finditer(ur"(?fie)\L<words>{e<=1}", sms, words=words):
    print(m[0]) # the match
    print(m.span()) # return indexes where the match found in the sms
    # to find out which of the words matched:
    print(next(w for w in words
               if re.match(ur"(?fi)(?:%s){e<=1}" % re.escape(w), m[0]))) 
```

### 输出

```
Furﬆ Word
(5, 14)
first word
Third
(22, 27)
third 
```

或者您可以直接迭代单词：

```
for w in words:
    for m in re.finditer(ur"(?fie)(?:%s){e<=1}" % re.escape(w), sms):
        print(m[0])
        print(m.span())
        print(w) 
```

它产生与第一个示例相同的输出。

# shell - Sed/Awk 在文件中搜索和替换/插入文本

> ID：11563620
> 
> 赞同：3
> 
> 时间：2012-07-19T14:59:51.723
> 
> 标签：shell, sed, awk

我正在尝试在目录（Linux）中的所有源文件中更新或插入一些评论，例如版权标头。我的文件不一致，因此其中一些文件已经有标题，而其他文件则根本没有。我尝试`sed`查看前几行并替换。替换我的意思是将已经具有版权标题的文件更改为最新的文件。

```
sed -e '1,10 s/Copyright/*Copyright*/g' file 
```

但是，如果它没有找到模式，这将不会插入。我怎样才能做到这一点？

我在评论中提供的示例或我试图实际替换/插入的是多行典型版权标题，如下所示

```
/*
* Copyright 1234 XXXNAME, XYZPlace 
*  text text text text ...........
* blah blah blah */ 
```

它也可能包含一些特殊字符。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T15:53:13.377

如果我理解正确，您想要：

*   查找前 10 行中没有版权声明的文件，以及
*   为这些文件添加版权声明。

此外，您还希望：

*   在前 10 行中查找带有版权声明的文件，以及
*   将他们的通知更新为您的标准文本。

在我看来，这两个任务可以归结为一组：

*   删除前 10 行中的任何现有版权声明，然后
*   在文件中插入新的版权声明。

如果我们可以安全地假设您在问题的评论中输入的示例文本的缩短版本是有效的，并且应该插入例如每个文件的第 2 行，那么以下内容应该满足第一组要求，如果您正在使用 GNU sed：

```
find . -type f -not -exec grep -q Copyright {} \; -exec sed -i'' '2i/* Copyright */' {} \; 
```

如果您*没有*运行 GNU sed（即您使用的是 FreeBSD、OSX 或 Solaris 等），请告诉我们，因为 sed 脚本会有所不同。

**这是如何工作的**？

该`find`命令正在获取以下选项：

*   `-type f`告诉它只查看文件（而不是目录或设备）。
*   `-not`反转以下选项。
*   `-exec grep -q Copyright {} \;`将搜索限制为包含版权的任何内容（由 修改`-not`）
*   `-exec sed -i'' '2i/* Copyright */' {} \;`插入您的版权声明。

如果您希望您的版权声明包含将由 sed 脚本解释的特殊字符，此解决方案可能会遇到困难。但它回答了你的问题。:)

相反，如果我们想处理修改后的要求，即首先删除现有的版权声明，那么我们可以使用两个单行代码来完成：

首先，我们删除现有的版权声明。

```
find . -type f -exec sh -c 'head {} | grep -q Copyright' \; -exec sed -ne '10,$ta;/Copyright/d;:a;p' {} \; 
```

这可能有点多余，除非您想递归地遍历子目录，`find`默认情况下这样做。sed 脚本对前 10 行中没有版权信息的文件不执行任何操作，因此如果您的所有文件都在一个目录中，则以下内容也应该起作用：

```
for file in *;do sed -ne '10,$ta;/Copyright/d;:a;p' "$file"; done 
```

接下来，我们重新添加新的。

```
for file in *;do sed -i'' '2i/* Copyright */' "$file"; done 
```

或者，如果您想通过子目录递归地执行此操作：

```
find . -type f -exec sed -i'' '2i/* Copyright */' {} \; 
```

**最后更新**：

在这之后我不能再花更多时间在这上面了。

```
find . -type f \
  -exec sh -c 'head {} | grep -q Copyright' \; \
  -exec sed -ne '1h;1!H;${;g;s:/\*.*Copyright.*\*/:/* Copyright 1998-2012 */' {} \; 
```

**什么**？

第一个`-exec`在文件的前 10 行中搜索“版权”一词。就像我在上面发布的第一个示例一样。如果 grep 找到任何东西，则此条件返回 true。

第二个`-exec`是替换。它将整个文件读入 sed 的保持缓冲区。然后，当它到达文件末尾时，它 ( `g`) 考虑保持缓冲区，并且 ( `s`) 执行多行替换。

请注意，这很可能需要一些调整，如果您在文件的其他地方有注释，它可能根本不起作用。我不记得 GNU sed 是否支持非贪婪星。你可以自己研究一下。

这是我的测试：

```
$ printf 'one\n/* Copyright blah blah\n *\n */\ntwo\n' | sed -n '1h;1!H;${;g;s:/\*.*Copyright.*\*/:/* Copyright 1998-2012 */:g;p;}'
one
/* Copyright 1998-2012 */
two 
```

这*不会*维护您现有的版权信息，但至少它解决了多行问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:12:52.737

编辑：如果您的文件名带有空格，则以下命令将不起作用，请参阅第一条评论。

它肯定可以`sed`只做，但我想到的第一件事是对存在该行的文件进行替换，然后使用类似的东西将标题添加到其余文件中

```
for f in $(grep -lv 'Copyright' *); do sed -i '1i *Copyright*' $f; done 
```

这将适用于当前文件夹中的所有文件，如果需要递归，请使用该`-r`选项。`grep`

PS我建议删除`-i` `sed`测试选项并仅在您确定命令正常工作时添加它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:26:59.580

要在文件的第 1 行插入包含文本`copyright`的单行（仅当它不存在时），您可以执行以下操作：

```
sed '1{ /copyright/!i\
copyright
}' input-file 
```

要插入多行：

```
sed '1{ /copyright/!i\
copyright\
second line
}' input-file 
```

使用从文件中读取版权很诱人`r`，但我不知道如何在第 1 行之前而不是在第 1 行之后插入它。例如：

```
sed '1{ /copyright/! { x; r copyright-file
G}}' input-file 
```

似乎它应该可以解决问题，但是版权文件中的文本从第 2 行开始。

# couchdb - 在 reduce 中处理 map 的空结果

> ID：11563624
> 
> 赞同：1
> 
> 时间：2012-07-19T15:00:01.543
> 
> 标签：couchdb

在 couchDB 中，如果 map 结果为空，reduce 是否仍会被调用？如果是这样，键和值都是空的吗？

我的用例（希望有更好的方法来做到这一点）：

我向我的集群发送了一个查询，我需要项目列表和返回的项目数（地图似乎没有提供......它只给了我视图的总数，而不是过滤后的视图结果）。然后我调用 reduce 以在单独的查询中获取计数。

有时 ViewResult 是空的，这使得 reduce 返回 null。我可以寻找这个空值，但我怀疑这是 couchdb 世界中的正确方法。

编辑：原来我使用的 ORM 确实支持一种方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:33:33.090

没有行时不会调用 reduce 函数。

实现目标的最简单方法是只进行映射，然后在代码中检索从 CouchDB 返回的行数组的长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T18:36:42.577

在空地图上调用的 reduce 函数实际上是我几个月前帮助修复的一个错误。我相信它是在 1.2 中修补的。如果您准备使用 1.1，那么这个错误可能仍然存在并且可以使用。

# php - 未找到 PHP 错误类“SoapClient”

> ID：11563625
> 
> 赞同：3
> 
> 时间：2012-07-19T15:00:02.060
> 
> 标签：php, cs-cart

我试图在我们的服务器上安装 Wordpress 进行测试，但为了做到这一点，我必须将我们当前的 PHP 版本升级到 5.3。我升级了我们的 PHP，现在我发现我们的 Purolator 运输模块不再工作。根据我们的主机支持，“purolator.php”文件缺少新版本 PHP 所需的数据。不幸的是，我无法恢复我们的 PHP 版本并且我们的程序员不在了。

这是我从我们的网站托管支持团队获得的错误消息：

```
tail /var/www/vhosts/phantomcables.com/statistics/logs/error_log -f 
[Thu Jul 19 08:34:28 2012] [error] [client 70.51.168.201] PHP Fatal 
error:  Class 'SoapClient' not found in 
/var/www/vhosts/phantomcables.com/httpdocs/shippings/purolator.php on line 
49, referer: https://phantomcables.com/index.php?dispatch=checkout.cart 
```

这些是第 40 到 72 行：

```
function createPWSSOAPClient()
{
    /** Purpose : Creates a SOAP Client in Non-WSDL mode with the appropriate authentication and 
    *           header information
    **/
    //Set the parameters for the Non-WSDL mode SOAP communication with your Development/Production credentials
    //echo DIR_SHIPPING_FILES."estimatingservice.wsdl";

    $url = "https://webservices.purolator.com/PWS/V1/Estimating/EstimatingService.asmx";
    $client = new SoapClient( DIR_SHIPPING_FILES."estimatingservice.wsdl", 
                              array (
                                        'trace'         =>  true,
                                        'location'      =>  $url,
                                        'uri'           =>  "http://purolator.com/pws/datatypes/v1",
                                        'login'         =>  PRODUCTION_KEY,
                                        'password'      =>  PRODUCTION_PASS
                                    )
                            );

    //Define the SOAP Envelope Headers
    $headers[] = new SoapHeader ( 'http://purolator.com/pws/datatypes/v1', 'RequestContext', 
                                  array (
                                            'Version'           =>  '1.0',
                                            'Language'          =>  'en',
                                            'GroupID'           =>  'xxx',
                                            'RequestReference'  =>  'Rating Example'
                                       )
                                ); 
    //Apply the SOAP Header to your client                            
    $client->__setSoapHeaders($headers);

    return $client;
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:15:50.457

好像您没有在服务器上安装**php-soap**包。类型

```
phpinfo(); 
```

在您的代码中并检查“Soap Client”是否已“启用”。如果不是，我不知道你的发行版和包管理器，但这里是我使用的 Fedora 代码：

```
$ yum install php-soap 
```

我建议与你的程序员或你身边的系统管理员一起做，你永远不知道会发生什么。在任何安装之前备份也很有用！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:16:26.070

您将需要添加（或之前删除任何评论字符）

```
extension=soap.so 
```

到您的`php.ini`文件，然后重新启动 Web 服务器。

如果您在查找`php.ini`文件时遇到问题，请创建一个包含以下内容的页面：

```
<?php phpinfo(); 
```

并在浏览器中加载该文件。

在某些系统上，此设置可能实际上并不存在于`php.ini`. 例如，如果您使用 Zend Server，该设置将位于`/usr/local/zend/etc/conf.d/soap.ini`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T17:17:10.540

所以我们恢复到旧版本的 PHP，并重新启用 SOAP。显然这就是问题所在，不知道为什么这不适用于较新版本的 PHP。

再次感谢您的所有帮助。这是一个很棒的社区。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-24T08:56:43.110

It is already posted [here](https://stackoverflow.com/questions/11391442/fatal-error-class-soapclient-not-found)

Do the following:

```
Do the following:

Locate php.ini in your apache bin folder, I.e Apache/bin/php.ini
Remove the ; from the beginning of extension=php_soap.dll
Restart your Apache server
Look up your phpinfo(); again and check if you see a similar picture to the one above
If you do, problem solved!
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-05-19T14:06:32.693

启用 SOAP 扩展，在 composer.json 中要求它，如下所示：

```
{
  "require": {
    "ext-soap": "*"
  }
} 
```

# mongodb - 在 MongoDB 中写的“一劳永逸”到底是什么意思

> ID：11563627
> 
> 赞同：7
> 
> 时间：2012-07-19T15:00:03.670
> 
> 标签：mongodb

MongoDB 有一个写机制`fire and forget`。但这能保证我的写入最终会写入磁盘吗？所以如果我有这样的声明（在 pymongo 中）

```
collection.insert(doc)     #not passing safe=True 
```

我了解我在上述声明中的写入不会立即到达磁盘，但是否可以保证它会到达磁盘（可能是第二天或一周后）或者它会丢失并且永远不会回来。我的应用程序不希望写入同步完成，但他们希望写入即使在几个小时后也能发生。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T15:24:55.590

“一劳永逸”（又名 MongoDB 的默认写入）的含义是驱动程序*不会与服务器确认写入*。您的写入被放置在网络上，驱动程序确认它到达网络传输但过去没有执行其他检查。

只要服务器和网络正常，预计写入就会成功。但是，这也意味着您不会发现诸如违反唯一索引之类的问题。

写入最初发生在内存中，并且*至少*每 60 秒刷新一次到磁盘。如果你打开了日志，写入将在 100 毫秒内进入日志——这个日志可以在 mongod 重新启动时崩溃的情况下恢复。

如果要验证写入是否已写入 mongod 并成功应用于内存，则应设置 safe=True

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:07:28.993

AFAIK Fire and Forget 无法保证 - 如果您需要它们，请使用安全 [这就是它的用途！]

请参阅[MongoDB 的插入安全模式有多安全？](https://stackoverflow.com/questions/7027065/how-safe-is-mongodbs-safe-mode-on-inserts)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:09:25.420

它可能会丢失并且永远不会回来。这可能由于断电、硬件故障或其他环境问题而发生。如果文档违反了某些唯一索引，也会发生这种情况。

`safe=True`将确保插入时没有任何数据库引擎错误。这使得驱动程序在写入后立即发出`getLastError`命令，如果写入违反唯一索引或存在一些潜在的 Mongo 问题，它将返回错误。但是，如果您在内存写入和写入日志之间断电，这将无济于事。

您可以通过该选项传递[许多其他选项](http://www.mongodb.org/display/DOCS/getLastError+Command)，以确保写入要么进入日志（持久），要么在命令返回之前被复制。我们通常会告诉人们至少在他们关心的文章中使用日记选项。`getLastError``safe`

# python - 错误不会停止执行

> ID：11563629
> 
> 赞同：1
> 
> 时间：2012-07-19T15:00:10.187
> 
> 标签：python, pyglet

我正在使用 Python 和 Pyglet 进行编码，并且由于我刚刚启动脚本，它充满了错误，这是正常的。

不太正常的是，这些错误不会停止脚本的执行，即使它们是“基本 python”错误。这不是很麻烦，但有点麻烦，因为它让我看到了一些错误。

例如，我得到：

```
AttributeError: 'Win32EventLoop' object has no attribute '_next_idle_time' 
```

（顺便说一句，我不知道这个是什么意思。这不是我的主题，但我很乐意得到这个的答案）

或者 ：

```
IndexError: list index out of range 
```

（我解决了一个愚蠢的错误，但它应该停止脚本）。

我使用 Eclipse + pydev，以前从未体验过。它可能与 pyglet 相关，因为它发生在我的第一次 pyglet 尝试中（之前，我使用了 pygame）。

感谢您的回答，

弗雷德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:32:36.853

您的 GUI 应用程序可能在某种循环中运行。这个事件循环正在为你捕获异常并将它们打印出来。

我建议您编写代码的方式您可以对程序的小部分进行单元测试，例如框架之外的类或函数，然后将它们粘合在一起作为 GUI 应用程序。此工作流程将保证您不会仅仅因为盲目地将新代码投入或多或少的现有代码堆中而监督简单的错误；）

阅读有关[TDD](http://en.wikipedia.org/wiki/Test-driven_development)的信息；）

# html - html / css恢复列表中子项目的ul缩进（应该很容易）

> ID：11563632
> 
> 赞同：0
> 
> 时间：2012-07-19T15:00:14.037
> 
> 标签：html, css

长话短说，多年来，我一直在我的项目中使用一些 CSS 重置。

我试图制作一个常规的站点地图页面（你知道无序列表中的链接），当我这样做时（下面的代码）

```
<div id="smap">
    <ul>
                <li><a href="index.php">Home</a></li>
                <li><a href="about-us.php">About Us</a></li>
                <li>
                    <a href="products.php">Products</a>
                        <ul>
                            <li><a href="products.php">Cantaloupes</a></li>
                            <li><a href="products.php">Watermelons</a></li>
                            <li><a href="products.php">HoneyDews</a></li>
                        </ul>
                </li>
                <li><a href="sales-team.php">Sales Team</a></li>
                <li><a href="contact-us.php">Contact / Directions</a></li>
                <li><a href="growers.phpp">Growers</a></li>
                <li><a href="packers.php">Packers</a></li>
                <li><a href="shippers.php">Shippers</a></li>
                <li><a href="importers.php">Importers</a></li>
                <li><a href="distributors.php">Distributors</a></li>
            </ul>
</div> 
```

列表出来了，但产品子项没有缩进。在 CSS 重置中，执行此操作的行是

```
vertical-align: baseline; 
```

当我删除它时，虽然它恢复了我的站点地图列表上的缩进，但它弄乱了我整个站点的菜单。

我想专门针对该列表，选择列表父 div 这是“ `smap`”
我想知道的是，默认情况下，列表垂直对齐值是什么？

例如，如果我这样做

```
#smap ul, li {vertical-alignment: SOMETHING; } 
```

要缩进的列表的默认值是多少？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:04:58.527

如果您想在重置后恢复任何属性的默认值，那么您应该使用该值`initial`- 您可能想阅读[这篇文章](http://nimbupani.com/safe-css-defaults.html)以了解更多信息。

但是，`ul`缩进是由- 见[http://dabblet.com/gist/3144582](http://dabblet.com/gist/3144582)`padding-left`给出的。我认为不应该影响这一点。`ul`[`vertical-align`](https://developer.mozilla.org/en/CSS/vertical-align)

# mysql - MYSQL中的列计算比较

> ID：11563636
> 
> 赞同：0
> 
> 时间：2012-07-19T15:00:25.117
> 
> 标签：mysql, sql

我想提交一个查询，如果计算结果为 TRUE，则返回一个值，如果为 FALSE，则返回 FALSE。

```
SELECT 
IF(VALID,EMPLOYEE_NAME,"NULL") AS NAME,
IF(SALARY/DAYS > 1000, TRUE, FALSE) AS VALID; 
```

在查询结束之前，MYSQL 似乎不知道 VALID var。
所以我的问题是：
是否有任何可能的方法来评估该查询的**VALID ？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:02:26.610

不可以。不能在同一个查询中那样使用别名。

你必须重复自己。

```
SELECT 
IF(SALARY/DAYS > 1000,EMPLOYEE_NAME,"NULL") AS NAME,
IF(SALARY/DAYS > 1000, TRUE, FALSE) AS VALID; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:31:46.127

您也可以使用子查询来执行此操作：

```
SELECT IF(VALID,EMPLOYEE_NAME,"NULL") AS NAME, VALID
from (select t.*, IF(SALARY/DAYS > 1000, TRUE, FALSE) AS VALID
      from t
     ) t 
```

我不是复制逻辑的忠实粉丝。我更喜欢使用子查询来定义变量。这使得更改定义变得更加容易。一般来说，这不会影响性能，因为（大多数）sql 引擎足够聪明，可以通过一次读取数据来进行计算。

# javascript - 如何使用 JavaScript 获取文本输入字段的值？

> ID：11563638
> 
> 赞同：1092
> 
> 时间：2012-07-19T15:00:28.073
> 
> 标签：javascript, dom, html-input

我正在使用 JavaScript 进行搜索。我会使用表格，但它会弄乱我页面上的其他内容。我有这个输入文本字段：

```
<input name="searchTxt" type="text" maxlength="512" id="searchTxt" class="searchField"/> 
```

这是我的 JavaScript 代码：

```
<script type="text/javascript">
  function searchURL(){
    window.location = "http://www.myurl.com/search/" + (input text value);
  }
</script> 
```

如何将文本字段中的值转换为 JavaScript？

* * *

## 回答 #1

> 赞同：2115
> 
> 时间：2012-07-19T15:02:14.223

有多种方法可以直接获取输入文本框值（无需将输入元素包装在表单元素中）：

**方法一：**

> `document.getElementById('textbox_id').value`获取所需框的值
> 
> **例如，** `document.getElementById("searchTxt").value;`

> **注意：**方法 2,3,4 和 6 返回元素的集合，因此使用 [whole_number] 来获取所需的出现次数。对于第一个元素，使用 [0]，对于第二个元素，使用[1](http://www.quirksmode.org/dom/w3c_core.html)，依此类推...

**方法二：**

> 使用 `document.getElementsByClassName('class_name')[whole_number].value`返回 Live HTMLCollection
> 
> **例如，** `document.getElementsByClassName("searchField")[0].value;`如果这是您页面中的第一个文本框。

**方法三：**

> 使用`document.getElementsByTagName('tag_name')[whole_number].value`它还返回一个实时 HTMLCollection
> 
> **例如** `document.getElementsByTagName("input")[0].value;`，如果这是您页面中的第一个文本框。

**方法四：**

> `document.getElementsByName('name')[whole_number].value`它还 > 返回一个活动的 NodeList
> 
> **例如，** `document.getElementsByName("searchTxt")[0].value;`如果这是您页面中第一个名称为“searchtext”的文本框。

**方法五：**

> 使用强大`document.querySelector('selector').value`的 CSS 选择器来选择元素
> 
> **例如，** `document.querySelector('#searchTxt').value;`按 id
> `document.querySelector('.searchField').value;`选择，按类别
> `document.querySelector('input').value;`选择，按标签
> `document.querySelector('[name="searchTxt"]').value;`名称选择，按名称选择

**方法六：**

> `document.querySelectorAll('selector')[whole_number].value`它也使用 CSS 选择器来选择元素，但它会将具有该选择器的所有元素作为静态节点列表返回。
> 
> **例如，** `document.querySelectorAll('#searchTxt')[0].value;` 按 id
> `document.querySelectorAll('.searchField')[0].value;`选择，按类别
> `document.querySelectorAll('input')[0].value;` 选择，按标签
> `document.querySelectorAll('[name="searchTxt"]')[0].value;`名称选择，按名称选择

支持

```
Browser          Method1   Method2  Method3  Method4    Method5/6
IE6              Y(Buggy)   N        Y        Y(Buggy)   N
IE7              Y(Buggy)   N        Y        Y(Buggy)   N
IE8              Y          N        Y        Y(Buggy)   Y
IE9              Y          Y        Y        Y(Buggy)   Y
IE10             Y          Y        Y        Y          Y
FF3.0            Y          Y        Y        Y          N    IE=Internet Explorer
FF3.5/FF3.6      Y          Y        Y        Y          Y    FF=Mozilla Firefox
FF4b1            Y          Y        Y        Y          Y    GC=Google Chrome
GC4/GC5          Y          Y        Y        Y          Y    Y=YES,N=NO
Safari4/Safari5  Y          Y        Y        Y          Y
Opera10.10/
Opera10.53/      Y          Y        Y        Y(Buggy)   Y
Opera10.60
Opera 12         Y          Y        Y        Y          Y 
```

**有用的链接**

1.  [**要查看这些方法的支持以及所有错误，包括更多详细信息，请单击此处**](http://www.quirksmode.org/dom/w3c_core.html)
2.  [**静态集合和实时集合之间的区别单击此处**](http://www.nczonline.net/blog/2010/09/28/why-is-getelementsbytagname-faster-that-queryselectorall/)
3.  [**NodeList 和 HTMLCollection 的区别点击这里**](http://xahlee.info/js/js_array_vs_nodelist_vs_html_collection.html)

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2014-11-04T22:34:10.840

```
//creates a listener for when you press a key
window.onkeyup = keyup;

//creates a global Javascript variable
var inputTextValue;

function keyup(e) {
  //setting your input text to the global Javascript Variable for every key press
  inputTextValue = e.target.value;

  //listens for you to press the ENTER key, at which point your web address will change to the one you have input in the search box
  if (e.keyCode == 13) {
    window.location = "http://www.myurl.com/search/" + inputTextValue;
  }
} 
```

[在 codepen 中查看此功能。](http://codepen.io/maudulus/pen/yVEOJL)

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2015-06-04T07:12:10.207

我会创建一个变量来存储这样的输入：

```
var input = document.getElementById("input_id").value; 
```

然后我会使用该变量将输入值添加到字符串中。

`= "Your string" + input;`

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-06-01T22:17:59.440

您应该能够输入：

```
var input = document.getElementById("searchTxt");

function searchURL() {
     window.location = "http://www.myurl.com/search/" + input.value;
}
```

```
<input name="searchTxt" type="text" maxlength="512" id="searchTxt" class="searchField"/>
```

我确信有更好的方法可以做到这一点，但这个方法似乎适用于所有浏览器，并且它需要对 JavaScript 的最少了解来制作、改进和编辑。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2014-06-23T18:10:16.883

您也可以通过标签名称调用，如下所示：`form_name.input_name.value;` 因此，您将以特定形式获得确定输入的特定值。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-06-11T09:32:41.937

```
<input type="text" onkeyup="trackChange(this.value)" id="myInput">
<script>
function trackChange(value) {
    window.open("http://www.google.com/search?output=search&q=" + value)
}
</script> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-01-10T09:36:27.937

# 短的

您可以通过以下方式读取值`searchTxt.value`

```
function searchURL() {
   let txt = searchTxt.value;
   console.log(txt);
   // window.location = "http://www.myurl.com/search/" + txt; ...
}

document.querySelector('.search').addEventListener("click", ()=>searchURL());
```

```
<input name="searchTxt" type="text" maxlength="512" id="searchTxt" class="searchField"/>

<button class="search">Search</button>
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-04-26T10:47:29.327

在 Chrome 和 Firefox 中测试：

通过元素 id 获取值：

```
<input type="text" maxlength="512" id="searchTxt" class="searchField"/>
<input type="button" value="Get Value" onclick="alert(searchTxt.value)"> 
```

在表单元素中设置值：

```
<form name="calc" id="calculator">
  <input type="text" name="input">
  <input type="button" value="Set Value" onclick="calc.input.value='Set Value'">
</form> 
```

[https://jsfiddle.net/tuq79821/](https://jsfiddle.net/tuq79821/)

还可以查看 JavaScript 计算器实现：[http ://www.4stud.info/web-programming/samples/dhtml-calculator.html](http://www.4stud.info/web-programming/samples/dhtml-calculator.html)

来自@bugwheels94 的更新：使用此方法时请注意[此问题](https://stackoverflow.com/a/3434388/548473)。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-01-20T06:58:44.430

```
function handleValueChange() {
    var y = document.getElementById('textbox_id').value;
    var x = document.getElementById('result');
    x.innerHTML = y;
}

function changeTextarea() {
  var a = document.getElementById('text-area').value;
  var b = document.getElementById('text-area-result');
  b.innerHTML = a;
}
```

```
input {
  padding: 5px;
}

p {
  white-space: pre;
}
```

```
<input type="text" id="textbox_id" placeholder="Enter string here..." oninput="handleValueChange()">
<p id="result"></p>

<textarea name="" id="text-area" cols="20" rows="5" oninput="changeTextarea()"></textarea>
<p id="text-area-result"></p>
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-11-09T08:24:26.490

如果你`input`在一个`form`并且你想在提交后获得价值，你可以这样做

```
<form onsubmit="submitLoginForm(event)">
    <input type="text" name="name">
    <input type="password" name="password">
    <input type="submit" value="Login">
</form>

<script type="text/javascript">

    function submitLoginForm(event){
        event.preventDefault();

        console.log(event.target['name'].value);
        console.log(event.target['password'].value);
    }
</script> 
```

这种方式的好处：例如您的页面有**2 个** `form`用于输入`sender`和`receiver`信息。

**如果**您不使用`form`获取值，则
- 您可以为每个字段设置 2 个不同的`id`（或`tag`或...），例如and ，and ，... - 如果您为 2 个输入设置相同的值，则在（或.. .) 你需要记住 0 或 1 是或。后面如果在html中改变2的顺序，需要再次查看这段代码`name``sender-name``receiver-name``sender-address``receiver-address`
`getElementsByName``getElementsByTagName``sender``receiver``form`

**如果**你使用`form`, 那么你可以使用`name`, `address`, ...

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-12-11T05:12:52.167

当您有更多输入字段时，您可以使用 onkeyup。假设你有四个或输入 。那么`document.getElementById('something').value`很烦人。我们需要写 4 行来获取输入字段的值。

因此，您可以创建一个函数，在 keyup 或 keydown 事件上将值存储在对象中。

例子 ：

```
<div class="container">
    <div>
        <label for="">Name</label>
        <input type="text" name="fname" id="fname" onkeyup=handleInput(this)>
    </div>
    <div>
        <label for="">Age</label>
        <input type="number" name="age" id="age" onkeyup=handleInput(this)>
    </div>
    <div>
        <label for="">Email</label>
        <input type="text" name="email" id="email" onkeyup=handleInput(this)>
    </div>
    <div>
        <label for="">Mobile</label>
        <input type="number" name="mobile" id="number" onkeyup=handleInput(this)>
    </div>
    <div>
        <button onclick=submitData()>Submit</button>
    </div>
</div> 
```

javascript：

```
<script>
    const data={ };
    function handleInput(e){
        data[e.name] = e.value;
    }
    function submitData(){
        console.log(data.fname); //get first name from object
        console.log(data); //return object
    }
</script> 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-07-04T07:29:02.603

可以使用 form.elements 获取表单中的所有元素。如果一个元素有 id，它可以通过 .namedItem("id") 找到。例子：

```
var myForm = document.getElementById("form1");
var text = myForm.elements.namedItem("searchTxt").value;
var url = "http://www.myurl.com/search/" + text; 
```

资料来源：[w3schools](https://www.w3schools.com/jsref/coll_form_elements.asp "w3schools")

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-01-17T13:14:59.717

简单的js

```
function copytext(text) {
    var textField = document.createElement('textarea');
    textField.innerText = text;
    document.body.appendChild(textField);
    textField.select();
    document.execCommand('copy');
    textField.remove();
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-03-07T17:47:44.123

```
<input id="new" >
    <button  onselect="myFunction()">it</button>    
    <script>
        function myFunction() {
            document.getElementById("new").value = "a";    
        }
    </script> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-07-22T05:44:12.300

```
function searchURL() {
   window.location = 'http://www.myurl.com/search/' + searchTxt.value
} 
```

所以基本上`searchTxt.value`会返回输入字段的值`id='searchTxt'`。

# .net - 在 SDL Tridion 2011 SP1 中将 dll 文件添加到 GAC

> ID：11563641
> 
> 赞同：-3
> 
> 时间：2012-07-19T15:00:36.083
> 
> 标签：.net, tridion, tridion-2011

我创建了一个 .dll 项目，我想将它添加到 Tridion 服务器的全局程序集缓存中。

考虑我的 .dll 位于“C:\Documents and Settings\myfunction.dll”位置。

我有一些问题。

1.  我是否需要从服务器下载 gacutil.exe 或本地计算机中的 gacutil.exe 就足够了？

2.  如果我的本地计算机中存在足够多的 gacutil.exe，我是否需要更改任何配置文件？

3.  我需要在 gacutil.exe 中使用哪组命令？

4.  SDL Tridion Live 文档中是否有可用的文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:18:12.777

这不是一个真正的 Tridion 问题，而是一个 .NET 问题。

但是您确实需要在要安装 dll 的服务器上运行“gacutil.exe”。（在您的情况下是 Tridion Content Manager Server）确保您使用正确版本的 gacutil.exe。（32 位与 64 位）。通常您不必更改任何配置文件。但是 gacutil.exe 的配置文件可以在同一目录中找到，并命名为“gacutil.exe.config”

要在 GAC 中安装程序集，可以使用以下命令：`gacutil.exe /i MyNiceApplication.dll`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:08:46.893

将 DLL 放入 GAC 的最简单方法是将其复制或拖放到 C:\Windows\assembly 文件夹中。这是一个特殊的文件夹（实际上并不是一个真正的文件夹，而是一组文件夹，Windows 让您可以从这个简单的地方进行管理）。

您需要确保您的 DLL 已签名。要对 DLL 进行签名，请在 Visual Studio 中转到您的项目属性并修改那里的签名选项。这很简单。

# javascript - 将变量从服务器传回给ajax成功

> ID：11563646
> 
> 赞同：1
> 
> 时间：2012-07-19T15:00:47.630
> 
> 标签：javascript, jquery, ajax, fancybox

用户填写输入文本，按下按钮提交。数据发送到服务器进行存储并返回结果。显示结果的 Fancybox 窗口出现。我的问题是：如何在fancybox 中显示结果$res1？

```
$.ajax({
    type:"POST",
    url:"index/success",
    async:false,
    data:{ name:name, password:password},
    success:function ()
    {
        var html='$res1 from the server should be here instead of this string';//var html=$res1.
        $.fancybox(
            {
                content: html,//fancybox with content will be displayed on success resul of ajax
                padding:15,
            }
        );
    }
}); 
```

==========================

好的，仍然不起作用（在fancybox中返回整个页面+顶部的单词“hello”而不是消息“hello”）。以下是我对以下答案的更新，但无法正常工作：

**PHP：**

```
<?php
    $res1="hello";... // handle logic here
    echo $res1; // print $res1 value. I want to display "hello" in the fancybox.
?> 
```

**AJAX**

```
$.ajax({
    type: "POST",
    url: "index/success",
    async: false,
    data: {
        name: name,
        password: password
    },
    success: function (html) {
       $.fancybox(
       {
         content: html,//returns hello+page in the fancybox

          //if I use the string below instead of the upper one, the fancybox shows "The requested content cannot be loaded. Please try again later."
         // content: console.log(html) 

         padding:15,
    }
}); 
```

============= **新更新：** 已修复！！！问题是数据（上例中的“hello”）被发送到框架中的模板，并显示模板。这就是为什么。固定的。谢谢你。大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:05:47.877

```
$.ajax({
  type:"POST",
  url:"index/success",
  async:false,
  data:{ name:name, password:password},
  success:function(html){ // <------- you need an argument for this function
    // html will contain all data returned from your backend.
    console.log(html);
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:12:15.233

假设您使用的是 PHP：

**PHP**：

```
<?php
    ... // handle logic here
    echo $res1; // print $res1 value
?> 
```

**阿贾克斯**：

```
$.ajax({
    type: "POST",
    url: "index/success",
    async: false,
    data: {
        name: name,
        password: password
    },
    success: function (html) {
        // given that you print $res1 in the backend file,
        // html will contain $res1, so use var html to handle
        // your fancybox operation
        console.log(html);
    }
}); 
```

享受和好运！

# actionscript-3 - 在 flex 移动应用程序中重新排序列表行

> ID：11563649
> 
> 赞同：1
> 
> 时间：2012-07-19T15:00:54.690
> 
> 标签：actionscript-3, apache-flex, mobile, air, flex4.6

如何让用户在 flex 移动应用程序中重新排序列表的行？

你知道，你在原生 iOS 应用程序中看到了很多。通常你点击列表视图顶部的编辑按钮。然后，每一行都有一个拇指图标，可让您在列表中移动行。

这可能很明显，但我正在用 flex 编写我的第一个移动应用程序，似乎在任何地方都找不到示例。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:37:00.453

Spark List 控件支持拖放，除了使用列表本身进行拖放之外，您还可以在两个不同的列表控件之间进行拖放。要启用该功能，您可以将 dragEnabled、dragMoveEnabled、dropEnabled 属性设置为 true，更多详细信息可以在此[帮助文档](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7cfd.html)中找到。

要启用您所描述的功能，您可以在启用编辑模式时将这些拖放属性设置为 true。或者，您还可以显示拖动处理程序（作为装饰器）。

更新：对于移动应用程序，有一篇[关于](http://flexponential.com/2011/06/21/using-drag-and-drop-with-a-spark-list-in-a-mobile-flex-application/)如何解决拖放的移动限制的文章。

# django - Django - 如何在不允许用户输入的情况下为 ModelForm 设置默认 ForeignKey 值

> ID：11563662
> 
> 赞同：0
> 
> 时间：2012-07-19T15:01:49.953
> 
> 标签：django, foreign-keys, modelform

我用模型`Page`和`Mark`.

`Mark`还有一个`ModelForm`类`MarkForm`，我告诉过它要将它的所有属性显示为小部件，除了`ForeignKey`，它是`editable=False`. `Page`和`Mark`- one `Page`, many之间存在一对多的关系`Marks`。

但是，当我尝试提交`MarkForm`时，它会提示该`ForeignKey`字段不能为空 - 有没有办法自动告诉表单（在服务器端），这样就不会在 html 中输出表单（我不希望用户能够摆弄和添加`marks`到其他`Pages`）。

如果我遗漏了什么，请告诉我，也许我在模型或视图中做错了什么。这是一些代码：

```
class Mark(models.Model):
    page  = models.ForeignKey(Page, editable=False)
    x = models.IntegerField()
    y = models.IntegerField()
    width = models.IntegerField()
    height = models.IntegerField()
    body = models.CharField(max_length=200)

class MarkForm(forms.ModelForm):
    class Meta:
        model = Mark
        widgets = {
            'x': HiddenInput(),
            'y': HiddenInput(),
            'width': HiddenInput(),
            'height': HiddenInput(),
            'body': HiddenInput(),
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:10:30.583

要排除某个字段，您可以[在 ModelForm 的 Meta 类](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#using-a-subset-of-fields-on-the-form)中进行。

要预先设置字段值，您可以在视图中执行，例如：

```
if request.method == 'POST':
        form = MarkForm(request.POST)
        if form.is_valid():
            obj = form.save(commit=False)
            obj.page = myid
            obj.save() 
```

# android - 如何创建轮播？

> ID：11563664
> 
> 赞同：2
> 
> 时间：2012-07-19T15:01:58.120
> 
> 标签：android

我为此寻找答案，但找不到可以帮助我的示例。我正在寻找这种形式的旋转木马，可以用箭头手指滚动。

![在此处输入图像描述](../Images/4b8c0f11c540a6c1888cdeb3672ffd64.png)

谢谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:30:00.487

您可以使用此项目开始：

[http://code.google.com/p/android-coverflow/](http://code.google.com/p/android-coverflow/)

您可以调整显示事物的角度、不透明度等。

# sql - Sybase 中有类似 SET FOREIGN_KEY_CHECKS = 0 的东西吗？

> ID：11563665
> 
> 赞同：0
> 
> 时间：2012-07-19T15:02:11.577
> 
> 标签：sql, sybase

我有以下疑问`SET FOREIGN_KEY_CHECKS = 0`Sybase 中是否有类似的东西？

我想运行这个查询：

```
SET FOREIGN_KEY_CHECKS = 0
DELETE FROM table WHERE  fieldT = 201 AND fieldN = 3992;
SET FOREIGN_KEY_CHECKS = 1 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:06:16.697

你运气不好。没有这样的东西。但是即使您能够做到这一点，当您从引用的表中删除数据时，它也会抛出错误，因此将不允许创建 FK。最好的方法是。从引用表中删除，然后从引用表中删除。这不仅是最好的方法，而且对您的数据完整性非常重要，这一点非常重要。

# sql - PostgreSQL 循环在访问嵌套函数生成的结果表时出错

> ID：11563668
> 
> 赞同：0
> 
> 时间：2012-07-19T15:02:17.843
> 
> 标签：sql, postgresql, loops

`table_generated_by_my_other_function`我有以下情况，当从调用嵌套时循环的第一部分生成的表中检索数据时会生成 OID 错误`function my_other_function()`。如何解决这个问题？

该函数`function my_other_function()`生成一个表，其中只有一行数据，包含 7 列，那么这个结果可以存储或以其他方式返回吗？我是否因为没有提交而表不存在而收到错误？

`function my_other_function()`单独工作正常。

```
CREATE OR REPLACE FUNCTION my_function() RETURNS varchar AS  $$
    DECLARE 
        row_data RECORD;
        helper int;
    BEGIN 
        EXECUTE '
            DROP TABLE IF EXISTS my_table_loop_result;
        ';
        EXECUTE '
            CREATE TABLE my_table_loop_result (
                var1 varchar, var2 varchar, var3 varchar, var4 int, 
                var5 varchar, var6 varchar, var7 int)
        ';

        FOR row_data IN SELECT var_x1, var_x2 FROM my_table_too
        LOOP
                SELECT my_other_function(row_data.var_x1, row_data.var_x2) INTO helper; --Returns "1" if OK    

                INSERT INTO my_table_loop_result(var1,var2,var3,var4,var5,var6.var7)
                SELECT 
                    var1,var2,var3,var4,var5,var6,var7
                FROM table_generated_by_my_other_function --OID ERROR!
                WHERE var1 = row_data.var1;
        END LOOP;
    RETURN 1;
    END;
$$ LANGUAGE plpgsql; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:20:58.717

8.2 已经过时了——在这个版本中，你永远不应该删除临时表。

PlpgSQL 使用准备好的语句，其中包含引用相关表的执行计划。当您删除表时，保存的计划无效 - 因为参考已损坏。在这种情况下新版本发布计划 - 但在 8.2 中并非如此。所以 - 请先升级或检查您的表是否存在，如果存在则截断它而不是删除。当表不存在时，然后创建它。其他解决方案 - 仅使用动态 SQL。

一些评论：CREATE TABLE 或 DROP TABLE 不需要动态 SQL。

[http://archives.postgresql.org/pgsql-bugs/2002-07/msg00051.php](http://archives.postgresql.org/pgsql-bugs/2002-07/msg00051.php)

# javascript - Javascript 时间戳限制为最后 8 个字符

> ID：11563672
> 
> 赞同：2
> 
> 时间：2012-07-19T15:02:27.310
> 
> 标签：javascript

获取时间戳很简单：

```
new Date().getTime(); 
```

但我需要将时间戳限制为 8 个字符，并且这些字符需要是最后 8 个而不是前 8 个。

例如：

```
new Date().getTime(); // returns: 1234567891234 
```

我需要它返回：

```
67891234 
```

你能帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T15:07:48.280

```
new Date().getTime().toString().substr(-8); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:06:48.840

你可以试试这个：

```
var last8numbers = String(new Date().getTime()).substr(-8); 
```

来自[Mozilla 的`substr`文档](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/substr)：

> 如果 start 为负数，则 substr 将其用作字符串末尾的字符索引。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T15:12:27.633

只需使用`%`(modulus) 即可获得您想要的值。您根本不需要将值转换为字符串。

```
var x = new Date().getTime(); 
var y = x%100000000; 
```

此代码打印 1234567891234 和 67891234

```
var x = 1234567891234;
var y = x%100000000;
alert(x + " & " + y);​ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-19T15:05:53.893

鉴于：

```
var foo = 1234567891234;
foo.toString().substring(foo.length - 8, foo.length); // returns 67891234 
```

# linux - 如何将本地变量传递给远程 ssh 命令？

> ID：11563682
> 
> 赞同：1
> 
> 时间：2012-07-19T15:02:59.110
> 
> 标签：linux, bash

我需要在远程机器上执行多个命令，并使用 ssh 来执行此操作，

> ssh root@remote_server 'cd /root/dir; ./run.sh'

在脚本中，我想`$argument`在执行时传递一个局部变量`run.sh`，比如

> ssh root@remote_server 'cd /root/dir; ./run.sh $argument'

它不起作用，因为在单引号中 $argument 没有按预期方式解释。

编辑：我知道可以使用双引号，但是有任何副作用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-08-29T20:03:05.683

您可以在这里安全地使用双引号。

```
ssh root@remote_server "cd /root/dir; ./run.sh $argument" 
```

这将扩展 $argument 变量。没有其他东西会带来任何风险。

如果您确实需要扩展某些变量而不是其他变量，则可以使用反斜杠对其进行转义。

```
$ argument='-V'
$ echo "the variable \$argument is $argument" 
```

会显示

```
the variable $argument is -V 
```

您始终可以使用双引号进行测试，以发现任何可能让您措手不及的隐藏问题。您始终可以使用 echo 安全地进行测试。

此外，运行多个命令的另一种方法是将标准输入重定向到 ssh。这在脚本中特别有用，或者当您有超过 2 或 3 个命令时（尤其是任何控制语句或循环）

```
$ ssh user@remoteserver << EOF
> # commands go here
> pwd
> # as many as you want
> # finish with EOF
> EOF
output, if any, of commands will display
$ # returned to your current shell prompt 
```

如果您在命令行上执行此操作，您将获得一个标准输入提示来编写您的命令。在命令行上，在您使用 EOF 指示完成之前，甚至不会尝试 SSH 连接。因此，您不会看到结果，但您可以 Ctrl-C 退出并重新开始。无论是在命令行上还是在脚本中，您都可以使用 EOF 来包装命令序列。那时您将返回到您的正常外壳。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:09:08.257

您可以`xargs`在远程端运行：

```
$ echo "$argument" | ssh root@remote_server 'cd /root/dir; xargs -0 ./run.sh' 
```

这完全避免了任何引用问题——除非你的论点中有空字符，我想。

# java - JPA + Hibernate + EHCache，意外行为

> ID：11563685
> 
> 赞同：7
> 
> 时间：2012-07-19T15:03:14.210
> 
> 标签：java, hibernate, jakarta-ee, jpa, ehcache

我正在尝试将 EHCache 实现到我的工作原型中，其中我有一个*javax.persistence.Entity*代表我的数据库（MySQL，mysql-connector-java-5.1.20.jar）上的一个表，它作为 XML 提供给消费者。

我面临的问题是 Hibernate 似乎仍在从数据库中检索数据，**即使 EHCache 将查询结果存储在 memory 上**。

我正在使用[EHCache 监视器](http://ehcache.org/documentation/operations/monitor#api)查看内存中的项目数，并在缓存过期之前直接更改数据库上的数据以了解是否实际使用了缓存的数据。

我一直在寻找这个问题的复制但没有成功，所以也许我错过了一些东西（我刚刚进入 Java 世界）。

## 我的文件

**pom.xml**

```
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-validator</artifactId>
    <version>4.3.0.Final</version>
</dependency>
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-entitymanager</artifactId>
    <version>4.1.4.Final</version>
</dependency>
<dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-ehcache</artifactId>
    <version>4.1.4.Final</version>
</dependency>
<dependency>
    <groupId>net.sf.ehcache</groupId>
    <artifactId>ehcache-core</artifactId>
    <version>2.5.2</version>
</dependency>
<dependency>
    <groupId>org.terracotta</groupId>
    <artifactId>ehcache-probe</artifactId>
    <version>1.0.2</version>
</dependency> 
```

**实体类**

```
package myPrototype.entities

import javax.persistence.Cacheable;
import javax.persistence.Entity;
import javax.persistence.NamedQueries;
import javax.persistence.NamedQuery;
import javax.persistence.Table;
import javax.xml.bind.annotation.XmlRootElement;
import org.hibernate.annotations.Cache;
import org.hibernate.annotations.CacheConcurrencyStrategy;

@Entity @Cacheable
@Cache(usage=CacheConcurrencyStrategy.READ_ONLY)
@Table(name = "Cars")
@XmlRootElement
@NamedQueries({
    @NamedQuery(name = "Cars.findAll", query = "SELECT d FROM Cars d"),
    [...]
public class Cars implements Serializable {
    private static final long serialVersionUID = 1L;
    @Basic(optional = false)
        @NotNull
        @Column(name = "id")
    @ReferenceField
    private int id;
    [...] 
```

**ehcache.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<ehcache>
  <cache name="myPrototype.entities.Cars"
    maxElementsInMemory="500"
    eternal="false"
    overflowToDisk="false"
    timeToIdleSeconds="60"
    timeToLiveSeconds="120" />
</ehcache> 
```

**我尝试设置了永恒=“真”，但结果还是一样*

**持久性.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
  <persistence-unit name="MyPrototype" transaction-type="JTA">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>java:app/jdbc/mysqlserver/prototype</jta-data-source>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <shared-cache-mode>ENABLE_SELECTIVE</shared-cache-mode>
    <properties>
      <!-- property name="hibernate.cache.region.factory_class" value="org.hibernate.cache.ehcache.SingletonEhCacheRegionFactory"/ -->
      <property name="hibernate.cache.region.factory_class" value="org.hibernate.cache.ehcache.EhCacheRegionFactory" />
      <property name="hibernate.cache.use_second_level_cache" value="true"/>
      <property name="hibernate.cache.use_query_cache" value="true"/>
      <property name="hibernate.cache.region_prefix" value=""/>
    </properties>
  </persistence-unit>
</persistence> 
```

**我尝试在 SingletonEhCacheRegionFactory 和 EhCacheRegionFactory 之间切换*

**EJB**

```
import myPrototype.entities.Cars
import java.util.Date;
import java.util.List;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

@Stateless
public class CarsEJB {

    @PersistenceContext(unitName="MyPrototype")
    private EntityManager em;

    @Override
    public List<Cars> getCars() {
        return (List<Cars>)em.createNamedQuery("Cars.findAll").setMaxResults(200).getResultList();
    }

} 
```

**添加以阐明我如何运行查询*

就像我说的，我可以通过 EHCache 监视器看到内存中的项目计数，所以我注意到以下几点： - ehcache 配置是属性加载的元素正在过期 - 当查询运行时元素过期不会被重置，而它们仍然活着（它们在第一次查询后 N 秒过期）。

再次; 我是java的新手，所以假设我可能缺少基本概念。

谢谢阅读！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T16:44:34.997

Hibernate 永远不会对你的缓存执行查询。它可以做的是在数据库上执行一个查询，缓存结果，并在下次执行相同的查询时返回这些缓存的结果，使用相同的参数。但要做到这一点，每次执行的查询都必须是可缓存的。

使用 JPA API，这是使用查询提示、直接在命名查询定义上或每次创建查询时完成的：

```
@NamedQuery(name = "Cars.findAll", 
            query = "SELECT d FROM Cars d",
            hints = {@QueryHint(name = "org.hibernate.cacheable", value = "true")}) 
```

现在查询是可缓存的，Hibernate 将在第一次执行该查询时从数据库中加载汽车的 ID，然后从查询缓存中加载。然后相应的汽车本身将从实体缓存中加载。

# report - 仅针对唯一用户的帖子实施“报告此内容”

> ID：11563696
> 
> 赞同：1
> 
> 时间：2012-07-19T15:03:35.890
> 
> 标签：report, ip-address

我看过以下问题：[实现“报告此内容”并检测垃圾邮件发送者或机器人触发事件](https://stackoverflow.com/questions/2176795/implementing-report-this-content-and-detecting-spammer-or-robot-triggered-even)，但它并不能完全回答我需要了解的有关设置“报告此内容”功能的所有信息。

我的情况非常相似（用户无需登录即可报告内容），但我不确定我应该捕获用户的什么信息以确保他们不会多次报告单个帖子。

我认为最明显的应该是 IP 地址，但我听说当用户靠近时，移动用户有时会发现自己都共享一个 IP 地址。

这意味着我还需要其他东西。

上面的问题提到了用户代理，但多个 iPhone 用户可能共享同一个 IP 地址听起来并不牵强，所以即使有 IP 地址和用户代理，它仍然不是唯一的。

如果我记录了他们的 IP 地址和会话 ID 会怎样？

这是一个很好的折衷方案还是有人能提出更好的选择？

谢谢

# android - 标记android中的问题

> ID：11563698
> 
> 赞同：1
> 
> 时间：2012-07-19T15:03:48.487
> 
> 标签：android, flags

我试图让我的通知在用户按下“全部清除”时不取消到目前为止，我的意图是在除此之外的所有内容上正常工作：

```
 Intent intent = new Intent(getBaseContext(), MainActivity.class);
    intent.addFlags(Notification.FLAG_ONGOING_EVENT);
    intent.addFlags(Notification.FLAG_NO_CLEAR);
    PendingIntent contentIntent = PendingIntent.getActivity(
            getBaseContext(), 0, intent, 0); 
```

我现在的问题是：我的标志正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:45:07.703

是的，您的标志看起来非常正确，尽管我不知道您是否甚至需要`FLAG_NO_CLEAR`. 我目前有一个创建持续（不可取消）通知的应用程序 - 我只使用`FLAG_ONGOING_EVENT`它，它对我来说很好用。我几乎只是从教程中复制了它，然后添加了正在进行的事件标志。这是一些示例代码：

```
String text = "notification";
Notification notification = new Notification(R.drawable.icon, text,
        System.currentTimeMillis());

//launch the activity if the user selects this notification
PendingIntent contentIntent = PendingIntent.getActivity(this, 0,
        new Intent().setComponent(ComponentName.unflattenFromString("com.example/com.example.MyActivity")), 0);

// set the label and text...
notification.setLatestEventInfo(this, getText(R.string.notification_label),
               text, contentIntent);
notification.flags = Notification.FLAG_ONGOING_EVENT;

// Send the notification.
// We use a string id because it is a unique number.  We use it later to cancel.
NotificationManager mNM;
mNM.notify(R.string.notification_label, notification); 
```

# ios - ASIHttpRequest：有人可以看到正在发送的 URL 吗？

> ID：11563701
> 
> 赞同：1
> 
> 时间：2012-07-19T15:03:51.080
> 
> 标签：ios, sql-server, asihttprequest

**我正在使用 ASIHttpRequest 在我的IOS**游戏中将数据来回发送到服务器。

我想知道是否有人可以看到正在发送到服务器的 url，不知何故？...如果是这样的话，作弊是可能的。

提前致谢

请求如下所示：

```
NSURL *url = [NSURL URLWithString: @"http://xx.xxx.xx.x/development/"];

__block ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL: url]; 
__weak ASIHTTPRequest *request_b = request;

[request setDelegate: self]; 
[request setQueue: [[DatabaseHelper sharedInstance] networkQue]]; 
[request setShouldContinueWhenAppEntersBackground: NO]; 
[request addRequestHeader:@"Content-Type" value:@"text/html; charset=utf-8;"];
[request setDefaultResponseEncoding:NSUTF8StringEncoding]; 
[request setTimeOutSeconds: 20.0f]; 
[request setCachePolicy: ASIDoNotWriteToCacheCachePolicy | ASIDoNotReadFromCacheCachePolicy]; 

[request setPostValue:@"aSecretString" forKey:@"secret"]; 
[request setPostValue: @"updateUser" forKey:@"apiToRun"]; 
[request setPostValue: @"4" forKey:@"userId"]; 
```

网址：

```
http://xx.xxx.xx.x/development/secret=aSecretString&apiToRun=updateUser&userId=4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:30:20.100

使用 GET 请求，数据作为 URL 的一部分发送，并且很容易通过 HTTP 监控进行拦截。如果您使用 POST，此信息将在 URL 中不可见。

# java - 字符串在单元格中不完全可见

> ID：11563703
> 
> 赞同：0
> 
> 时间：2012-07-19T15:03:54.317
> 
> 标签：java, apache-poi

当我使用 setCellValue() 将字符串写入单元格，然后在 Excel 中打开创建的文件时，我只看到前三个字符。

双击单元格后，我看到了完整的字符串。

当我在单元格中写入数据时，我必须更改哪个设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:08:33.787

使用[`autoSizeColumn(int column)`](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFSheet.html#autoSizeColumn%28int%29)工作表右栏中的方法：相当于双击。

如果您希望所有列具有相同的宽度：

1.  自动调整您写入数据的所有列
2.  [使用getColumnWidth(int column)](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFSheet.html#getColumnWidth%28int%29)方法遍历每一列以获得最大宽度
3.  [使用setColumnWidth(int columnIndex, int width)](http://poi.apache.org/apidocs/org/apache/poi/hssf/usermodel/HSSFSheet.html#setColumnWidth%28int,%20int%29)方法将所有列调整为最大宽度

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:09:26.467

如果单元格的宽度不足以完全容纳新值，那么您可以使用：

```
sheet.autoSizeColumn(column); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T09:46:50.900

Problem solved. Problem was that the neighbouring cells had empty Stringvalues ( "" ) in them. Looping through these cells and setting the cell values to an null-String did the trick.

# javascript - 具有可观察数组的淘汰计算列不更新 UI

> ID：11563704
> 
> 赞同：0
> 
> 时间：2012-07-19T15:03:57.567
> 
> 标签：javascript, knockout.js, knockout-2.0

我正在使用以下淘汰 observableArray 和计算列代码，但是当我将值推送到可观察数组时，UI（用于数据绑定计算）没有更新。请参阅我的 jsFiddle 示例。

[http://jsfiddle.net/U9Sqb/2/](http://jsfiddle.net/U9Sqb/2/)

有没有更好的方法将值推送到 observableArray 并让它们通过计算更新 UI？提前致谢。

HTML：

```
<html>
    <head>
        <script src="http://cloud.github.com/downloads/SteveSanderson/knockout/knockout-2.1.0.js" ></script>
    </head>
    <body>
        <div data-bind="text: onString"></div>
        <div id="test"></div>
    </body>
</html> 
```

Java脚本：

```
function MyData() {
  var self = this;
  self.currentOnOf = ko.observable(1);
  self.available = ko.observableArray();
  self.onString = ko.computed(function () {
    return "On " + self.currentOnOf() + " of " + self.available ().length;}, self);
}

var data = new MyData();

$(document).ready(function () {
    ko.applyBindings(data);
    data.available().push(1);
    data.available().push(2);
    $("#test").html(data.available().length);
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:11:01.943

当您推送到 ko.observable 数组时，您需要直接推送到它：

```
data.available.push(1);
data.available.push(2); 
```

# jquery - 调用jquery colorbox时如何发布后页？

> ID：11563705
> 
> 赞同：0
> 
> 时间：2012-07-19T15:03:59.670
> 
> 标签：jquery, asp.net, jquery-plugins, postback, colorbox

我在我的一个应用程序中调用 jquery 颜色框。我可以打开它，但我希望我的页面先回发，同时打开颜色框。我试过下面的代码。

aspx：

```
<script type="text/javascript">
        function OpenColorBox() {
            $.colorbox({
                opacity: 0.1,
                width: '350px',
                height: '350px',
                iframe: true,
                href: '/MMP/MMPhome.aspx',
                onLoad: function () {

                    $('#cboxClose').remove();
                },
                onClosed: function () {

                }
            });
        }

    </script>

<asp:Button ID="Call" runat="server" Text="Save this Search Criteria" 
                    OnClientClick="OpenColorBox(); return false;" onclick="Call_Click" /> 
```

它正在打开弹出窗口，但我想先发回我的页面。如果有人知道怎么做，请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:37:29.353

如果您需要回发，那么打开您的 ColorBox，您可以执行以下操作：

澳交所：

```
<asp:Button ID="Call" runat="server" Text="Save this Search Criteria" 
                    onclick="Call_Click" /> 
```

代码隐藏：

```
private void Call_Click(object sender, EventArgs e)
{
   Page.ClientScript.RegisterClientStartupScript(this.GetType(), "OpenColorBoxAfterClick", "OpenColorBox();", true);
   //Handle the rest of your code
} 
```

如果您需要在打开 ColorBox 时进行回发，则需要使用 Ajax。包含按钮的 UpdatePanel 可以解决问题：

澳交所：

代码隐藏：

```
private void Call_Click(object sender, EventArgs e)
{
   //Handle click as normal
} 
```

如果您需要使用 UpdatePanel，但在 updatepanel 返回后仍然调用 javascript：

澳交所：

```
<asp:Button ID="Call" runat="server" Text="Save this Search Criteria" 
                    onclick="Call_Click" /> 
```

代码隐藏

```
private void Call_Click(object sender, EventArgs e)
{
   ScriptManager.RegisterStartupScript(this, this.GetType(), "OpenColorBoxAfterClick", "OpenColorBox();", true);
   //Handle click as normal
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-18T17:54:07.407

您无法调用按钮单击事件，因为 colorbox 呈现 div，该 div 在页面上的表单之外显示给用户。要解决这个问题，您必须对插件进行一些小改动。

在 colorbox 插件中查找 appendHTML() 函数并替换以下行：

```
if (!$box && document.body) 
```

和：

```
if (!$box && document.forms[0]) 
```

在方法的最后一行，替换：

```
$(document.body).append($overlay, $box.append($wrap, $loadingBay)); 
```

和

```
$(document.forms[0]).append($overlay, $box.append($wrap, $loadingBay)); 
```

这解决了问题，因为现在您将在表单标记内拥有呈现的 div 的颜色框！

# javascript - Mongoose.js：什么是 QueryStreams

> ID：11563708
> 
> 赞同：5
> 
> 时间：2012-07-19T15:04:07.283
> 
> 标签：javascript, node.js, mongoose

我查看了 mongoosejs odm 的文档，发现以下内容：http: [//mongoosejs.com/docs/querystream.html](http://mongoosejs.com/docs/querystream.html)

它们是用来做什么的？我能用它们做什么。

我不确定它们是用于流式传输文档还是用于动态更新查询...

问候

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T02:48:00.367

好吧，这都是关于 API 的。

`QueryStream`允许使用`ReadStream`'s API 所以为了欣赏`QueryStream`，你需要更多地了解`ReadStream`/ `WriteStream`。

有很多优点：

*   您可以处理大量数据，这些数据将作为“块”获得，因此内存一次包含一个项目（它可以是数据库文档、数据库行、文件中的单行等）
*   您可以暂停/恢复流
*   您可以非常轻松地通过管道读取->写入

这个想法是它为您提供了一个用于读写操作的**统一 API 。**

要回答您的问题“我能用它们做什么”：

无论有没有 node.js 的流 API，你都可以做任何事情，但当有某种标准时，它肯定会让它更清晰、更容易使用。

此外，node.js 的流是基于事件的（基于 EventEmitter），因此有助于解耦。

* * *

编辑：

那更多是关于流的方面。在 Mongoose 的例子中，一个单独的块包含一个文档。

为了阐明 API 的优势：

node.js`http.ServerResponse`是一个可写流，这意味着您应该能够`Mongoose`使用单行将 的结果集流式传输到浏览器：

```
// 'res' is the http response from your route's callback.
Posts.find().stream().pipe(res); 
```

`http.ServerResponse`关键是，如果您正在写入、 文件或其他任何内容，这并不重要。只要它实现了可写流，它就应该可以在没有更改的情况下工作。

* * *

希望我说得更清楚。

# .net - Excel 加载项：在保存之前捕获对 Excel 文件所做的更改

> ID：11563714
> 
> 赞同：1
> 
> 时间：2012-07-19T15:04:35.887
> 
> 标签：.net, vsto

我正在开发一个对 Application.WorkbookBeforeSave 事件执行一些操作的 Excel 加载项。当用户对文件进行更改并单击“保存”时，我想捕获新文件（带有更改）并将其上传到某处而不是将其保存在磁盘上。如果文件不是并且不会保存，我如何获取该文件的内容？我在 Excel.Workbook 对象或类似对象上找不到任何 Content 属性。

# curl - 直接从浏览器调用 url 时 curl www.google.com 的工作方式不同

> ID：11563717
> 
> 赞同：7
> 
> 时间：2012-07-19T15:04:37.577
> 
> 标签：curl

当我`curl www.google.com`在终端输入时，我得到以下回复。但是当我在浏览器（chrome）中输入类似的网址（[www.google.com ）时，我被重定向到](http://www.google.com)[www.google.co.in](http://www.google.co.in)

当我从浏览器调用相同的 URL 时，为什么我看不到下面的 HTML？

```
<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
<TITLE>302 Moved</TITLE></HEAD><BODY>
<H1>302 Moved</H1>
The document has moved
<A HREF="http://www.google.co.in/">here</A>.
</BODY></HTML> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-19T15:11:29.227

```
curl -L http://www.google.com 
```

将使 curl 跟随重定向，您将收到实际的搜索页面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T15:07:16.540

`.co.in`浏览器会自动遵循重定向，因此在加载页面版本之前，中间页面仅在极小的时间内可用。默认情况下，CURL**不**遵循重定向，因此您将获得该中间页面。

# c# - 使用 MVC 异步处理 RSS 提要

> ID：11563719
> 
> 赞同：1
> 
> 时间：2012-07-19T15:04:42.490
> 
> 标签：c#, asp.net-mvc-3, asynchronous, rss

在我正在进行的一个项目中，客户希望将 RSS 提要合并到他们的站点新闻项目中。

该站点已经有一个由从数据库中提取的 NewsItems 填充的新闻提要。

我的想法是定期（每 20 分钟左右）使用 rss 提要，但我不确定这会对在更新提要时尝试查看新闻页面的客户产生什么影响。

我的想法是使用 ThreadPool.QueueUserWorkItem 来使用提要，对其进行处理，并将新项目添加到数据库/lucene 索引/添加标签等，但我的异步编程经验几乎为零。

QueueUserWorkItem 会在不阻塞客户端线程的情况下生成一个新线程来完成工作吗？更新结束时会发生什么？

我正在考虑做这样的事情：

```
public class ExternalRSS
{
    private readonly SettingsDTO Settings;

    public ExternalRSS()
    {
        Settings = Application.FetchSettings();

        RunAsynchronously(ProcessFeed);
    }

    public static void RunAsynchronously(Action method)
    {
        ThreadPool.QueueUserWorkItem(i =>
        {
            try
            {
                method();
            }
            catch (ThreadAbortException ex) { /*log*/}
            catch (Exception ex){/*log*/}
        });
    } 

    private void ProcessFeed()
    {
        if(Settings != null)
        {
            using (var reader = XmlReader.Create(Settings.FacebookRssFeed))
            {
                var rssData = SyndicationFeed.Load(reader);

                //do processing etc
            }
        }
    }
} 
```

我是不是把问题复杂化了？

任何建议都会受到欢迎！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:07:45.840

恕我直言，这不是应该在 ASP.NET MVC 应用程序中完成的任务。我会使用一个单独的专用 Windows 服务，它会定期查询远程 RSS 提要并更新数据库。或者一个简单的控制台应用程序，使用 Windows 任务计划程序计划定期运行。重要的部分是写入数据库时​​：确保它是在 SQL 事务中执行的。这样，客户端 MVC 应用程序在读取数据时就不会看到损坏的数据。

我还建议您阅读[以下博客文章](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)，其中 Phil Haack 详细解释了为什么在 ASP.NET 应用程序中实现此类经常性后台任务是一个非常糟糕的主意。

# php - 将变量添加到具有颜色的函数中？

> ID：11563721
> 
> 赞同：-1
> 
> 时间：2012-07-19T15:04:54.720
> 
> 标签：php, html, sql

您好，我有一个 granit php 函数，但想将我自己的文本打印到其中，该文本存储在一个变量中，我自己的颜色也存储在一个变量中

这就是我输入变量时代码的样子

```
 gradient('FF0000', '0000FF', 'my test goes here'); 
```

哪个工作正常，但现在我想把变量

渐变（$颜色1，$颜色2，$profile）；

这是字母 w 的打印，即使我只是打印配置文件和其他 2 个变量都设置了......而且它们都不是 w

这是我得到的颜色...

```
 <?php 

    $sql1 = "SELECT * FROM profile_colurs WHERE username='{$profile}' ";
$result1 = mysql_query($sql1) or die(mysql_error());
$values1 = mysql_fetch_array($result1);

$co1= mysql_real_escape_string($values1['colour1']);
$colour1 = strip_tags($co1);
$co2= mysql_real_escape_string($values1['colour2']);
$colour2 = strip_tags($co2);
$co3= mysql_real_escape_string($values1['colour3']);
$colour3 = strip_tags($co3);

        include_once('functions/granit.php'); 

        gradient($colour1,$colour2,$profile); 

         ?> 
```

完美的所有可变打印，但我很快就把它放入函数中，我刚刚得到“w”我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:10:39.523

第一个建议，不要使用`MySQL_*`函数集。它已被弃用，不鼓励使用。

> 不鼓励使用此扩展程序。相反，应该使用 MySQLi 或 PDO_MySQL 扩展。另请参阅 MySQL：选择 API 指南和相关的常见问题解答以获取更多信息。此功能的替代方案包括：

其次，如果您只想要关联结果（意味着列名作为数组索引），请将您的更改`mysql_fetch_array`为`mysql_fetch_assoc`。

最后，执行`var_dump( get_defined_vars () );`并验证数据库中的数据是否符合您的预期。在您的代码片段中，在哪里`$profile`设置以及它的价值是什么？

# sublimetext - 在 Sublime Text 2 中，如何选择选定块的开头和结尾？

> ID：11563725
> 
> 赞同：3
> 
> 时间：2012-07-19T15:05:08.687
> 
> 标签：sublimetext, sublimetext2

Sublime Text的[旧文档](http://www.sublimetext.com/docs/selection)有这个诱人的注释：

> 给定一个选定的文本块，Ctrl+Shift+K 将把它分成两个选择，一个用于每一端。

那会很方便，但它在 Sublime Text 2 中不起作用，至少在我的 Mac 上不起作用。（相反，击键会删除当前行。）

我知道将任何 Sublime 命令映射到任何击键都很容易，但是尽管环顾四周，但我找不到用于将选定块拆分为开始和结束选择的命令。

那么，这个命令是什么？否则我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-03T17:28:51.663

虽然我认识到这个问题现在已经有一年多了，但我认为这是一个非常理想的功能。我还没有为此创建一个包，但我确实创建了一个插件来解决这个问题。在您的目录中创建一个 Python 文件（建议名称：selections.py）`Sublime Text 2/Packages/User`，并复制以下代码。

```
import sublime, sublime_plugin

def split_selection_to_begin_end(view):
    new_sel = []
    for s in view.sel():
        if not s.empty():
            new_sel.append(sublime.Region(s.a))
            new_sel.append(sublime.Region(s.b))
        else:
            new_sel.append(s)

    view.sel().clear()
    for s in new_sel:
        view.sel().add(s)

class SplitSelectionToBeginEndCommand(sublime_plugin.TextCommand):
    def run(self, edit):
        split_selection_to_begin_end(self.view) 
```

我决定为此设置按键，`Ctrl+Shift+;`因为它很方便并且没有映射到我安装的任何软件包中的任何内容。添加这个或类似于您的 User/Default (OS).sublime-keymap 文件的内容。

```
[
    { "keys": ["ctrl+shift+;"], "command": "split_selection_to_begin_end" }
] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:19:00.950

在 OS X 上使用**Ctrl+Shift+L**或**Command+Shift+L**，有关更多详细信息，请参阅 - [Multiple Selection with the Keyboard](http://www.sublimetext.com/docs/2/multiple_selection_with_the_keyboard.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:08:45.723

似乎这已在 ST2 中删除。看看这个要点以获得 ST2 的快捷方式列表：[Sublime Text 2 – Useful Shortcuts (Mac OS X)](https://gist.github.com/1207002)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T20:34:54.247

不知道快捷方式，但您可以在块的开头和结尾执行 CTRL+左键单击（鼠标）。

# ios - 保持网络活动指示器旋转

> ID：11563727
> 
> 赞同：2
> 
> 时间：2012-07-19T15:05:11.480
> 
> 标签：ios

我发现有时你可能会在你的 iPhone 应用程序中做一些需要用户等待它完成的事情。通常这是与网络相关的活动，但在其他情况下可能不是。就我而言，我正在解析来自网络连接的响应，并希望网络活动指示器即使已经下载了内容也能继续旋转。

以下是我正在做的事情：

applicationDelegate.m：

```
- (void)setNetworkActivityIndicatorVisible:(BOOL)setVisible
{
    static NSInteger NumberOfCallsToSetVisible = 0;
    if (setVisible) 
        NumberOfCallsToSetVisible++;
    else 
        NumberOfCallsToSetVisible--;

    // Display the indicator as long as our static counter is > 0.
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:(NumberOfCallsToSetVisible > 0)];
} 
```

其他视图.m：

```
dispatch_queue_t dataLoadingQueue = dispatch_queue_create("synchronise", NULL);
    dispatch_async(dataLoadingQueue,
                   ^{
                       [appDelegate setNetworkActivityIndicatorVisible:YES];
                       [[DataLoader instance]LoadDataForGrewal];
                       [[FieldConsultantViewModelManager instance] resetCache];  
                       [[DailyFieldConsultantViewModelManager instance] clearCache];
                       [appDelegate loadMainViews];
                       [[DataLoader instance]LoadDataForOtherEntities]; 
                       [appDelegate setNetworkActivityIndicatorVisible:NO];
                   });    
 dispatch_release(dataLoadingQueue); 
```

正如您在上面看到的，我试图在将数据更新到数据库时保留网络指示器，但它不起作用，有什么线索/建议吗？

谢谢 **编辑：**

```
dispatch_queue_t dataLoadingQueue = dispatch_queue_create("synchronise", NULL);
    dispatch_async(dataLoadingQueue,
                   ^{
                       dispatch_async(dispatch_get_main_queue(), ^{ [self setNetworkActivityIndicatorVisible:YES]; });
                       [[DataLoader instance]LoadDataForGrewal];
                       [[FieldConsultantViewModelManager instance] resetCache];  
                       [[DailyFieldConsultantViewModelManager instance] clearCache];
                       [appDelegate loadMainViews];
                       [[DataLoader instance]LoadDataForOtherEntities]; 
                       dispatch_async(dispatch_get_main_queue(), ^{ [self setNetworkActivityIndicatorVisible:NO]; });
                   });    
 dispatch_release(dataLoadingQueue); 
```

它不起作用我不知道为什么，因为我是 ios 的新手

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:09:54.797

尝试`setNetworkActivityIndicatorVisible:`在主队列上调度您的呼叫，因为 UIApplication 在 UIKit 中并且 UIKit 不是线程安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-08T16:05:15.420

对于任何寻求完整解决方案的人，这就是我使用的（在**Swift**中）。停止网络指示器时会延迟一小段时间。如果您有大量串行网络请求，这将防止指示灯闪烁。

```
private var networkActivityCount = 0

func updateNetworkActivityCount(increaseNumber increase:Bool)
{
    let appendingCount = increase ? 1 : -1
    networkActivityCount += appendingCount
    let delayInSeconds = increase ? 0.0 : 0.7
    perform({ () -> () in
        let application = UIApplication.sharedApplication()
        let shouldBeVisible = self.networkActivityCount > 0
        if application.networkActivityIndicatorVisible != shouldBeVisible {
            application.networkActivityIndicatorVisible = shouldBeVisible
        }
    }, afterDelay: delayInSeconds)
} 
```

其中`perform:afterDelay`定义为

```
public func perform(block: ()->(), afterDelay:Double) {
    let dispatchTime: dispatch_time_t = dispatch_time(DISPATCH_TIME_NOW, Int64(afterDelay * Double(NSEC_PER_SEC)))
    dispatch_after(dispatchTime, dispatch_get_main_queue(), {
         block()
    })
} 
```

只需`updateNetworkActivityCount(increaseNumber: true)`在您的请求之前调用，并`false`在您的请求回调中调用。IE：

```
updateNetworkActivityCount(increaseNumber: true)
let task = urlSession.dataTaskWithRequest(request) { data, response, error in
    self.updateNetworkActivityCount(increaseNumber: false)
    ... 
```

# c++ - 分析崩溃

> ID：11563728
> 
> 赞同：1
> 
> 时间：2012-07-19T15:05:14.403
> 
> 标签：c++, windows, debugging

我正在编写一个 C++ 软件图像处理工具。该工具工作正常，但突然停止，它从不发送任何异常或任何崩溃或任何东西都不会让我哪条线路或哪个区域发生崩溃。

在这种情况下，我如何确定错误代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:17:54.450

**你可以做几件事：**

首先，它听起来更像是一个无限循环、死锁，或者就像您正在使用所有系统资源，而且它只是在放慢速度并花费很长时间（可能是无限的）。如果是这种情况，您将不得不通过调试找到它。

* * *

**您可以尝试的事情 - 不一定按此顺序：**

1.  查找您正在使用的共享变量。您是否有可能与线程和互斥锁发生死锁？考虑一下并尝试解决它。

2.  检查未初始化的变量/指针的使用。有时（很少）当您调用未定义的行为时会出现非常奇怪的行为 - 我不是 Windows C++ 开发人员（我在 Linux 上工作），但这并不是我第一次看到因分段错误而导致的锁定。

3.  将错误输出 (std::cerr/stderror) 添加到您的处理逻辑中，这样您就可以看到它崩溃的程度。之后，设置一个条件以在该点附近捕获它，以便您可以在调试器中看到它发生并查看变量的状态以及可能出现的问题。

4.  做一个堆栈跟踪，这样你就可以看到最近命中了哪些调用。这至少会让你知道最后执行的函数链。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:08:23.130

您以前使用过堆栈跟踪吗？

查找有关如何使用它们的 MSDN 文档。根据您的应用程序，它们具有不同类型的堆栈跟踪。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:18:43.310

你可以

1.  使用调试器
2.  将日志记录代码添加到您的程序中
3.  从您的程序中删除部分代码，直到它开始工作

从第一个开始。

# c# - 将数据列添加到数据表

> ID：11563731
> 
> 赞同：7
> 
> 时间：2012-07-19T15:05:33.650
> 
> 标签：c#, datatable

我想将数据从 a 移动`dataColumn`到我的`dataTable`. 我不确定如何指定`Datatable`我要添加的列中的`datacolumn`.

```
 foreach (DataColumn col in dt.Columns)
        {
            dt1.Columns.Add(col);
        } 
```

我收到一个例外`Column 'X' already belongs to another DataTable.`

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-19T15:12:11.510

您需要复制属性`ColumnName`并创建新的`DataColumns`：

```
foreach (DataColumn col in dt.Columns)
{
    dt1.Columns.Add(col.ColumnName, col.DataType);
} 
```

`ArgumentException`当您添加一个`DataColumn`已经属于另一个 DataTable时，这是有原因的。允许这样做是非常危险的，因为 a`DataTable`持有对其列的[引用](http://msdn.microsoft.com/en-us/library/system.data.datatable.columns.aspx)，并且每列都持有对其 DataTable的[引用。](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.table.aspx)如果您将一列添加到另一个表中，您的代码迟早会崩溃。

如果您还想将 复制`DataRows`到新表中：

```
foreach (DataRow row in t1.Rows)
{
    var r = t2.Rows.Add();
    foreach (DataColumn col in t2.Columns)
    {
        r[col.ColumnName] = row[col.ColumnName];
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T15:44:32.390

您不能从另一个表添加 DataColumn，因为它已经与它的原始表关联，并且 DataColumn 通过引用传递给 Add 方法，因为它是一个对象。你必须复制它。这是您可以做到这一点的一种方法：

```
public static class DataColumnExtensions
{
    public static DataColumn CopyTo(this DataColumn column, DataTable table)
    {
        DataColumn newColumn = new DataColumn(column.ColumnName, column.DataType, column.Expression, column.ColumnMapping);
        newColumn.AllowDBNull = column.AllowDBNull;
        newColumn.AutoIncrement = column.AutoIncrement;
        newColumn.AutoIncrementSeed = column.AutoIncrementSeed;
        newColumn.AutoIncrementStep = column.AutoIncrementStep;
        newColumn.Caption = column.Caption;
        newColumn.DateTimeMode = column.DateTimeMode;
        newColumn.DefaultValue = column.DefaultValue;
        newColumn.MaxLength = column.MaxLength;
        newColumn.ReadOnly = column.ReadOnly;
        newColumn.Unique = column.Unique;

        table.Columns.Add(newColumn);

        return newColumn;
    }

    public static DataColumn CopyColumnTo(this DataTable sourceTable, string columnName, DataTable destinationTable)
    {
        if (sourceTable.Columns.Contains(columnName))
        {
            return sourceTable.Columns[columnName].CopyTo(destinationTable);
        }
        else
        {
            throw new ArgumentException("The specified column does not exist", "columnName");
        }
    }
}

public class MyClass
{
    public static void Main()
    {
        DataTable tableA = new DataTable("TableA");
        tableA.Columns.Add("Column1", typeof(int));
        tableA.Columns.Add("Column2", typeof(string));

        DataTable tableB = new DataTable("TableB");

        foreach (DataColumn column in tableA.Columns)
        {
            column.CopyTo(tableB);
        }
    }
} 
```

请注意，还有一种扩展方法可用于按名称复制各个列，即`tableA.CopyColumnTo("Column1", tableB);`.

然后，如果新表是原始表的精确副本，则可以像这样复制数据：

```
foreach (DataRow row in tableA.Rows)
{
    tableB.Rows.Add(row.ItemArray);
} 
```

或者以类似于蒂姆施梅尔特的答案中的第二段代码的方式，如果它不是一个精确的副本。但是，如果您没有将所有列复制到新表中，我建议您进行一些错误检查：

```
foreach (DataRow souceRow in sourceTable.Rows)
{
    DataRow destinationRow = destinationTable.Rows.Add();

    foreach (DataColumn destinationColumn in destinationTable.Columns)
    {
        string columnName = destinationColumn.ColumnName;

        if (sourceTable.Columns.Contains(columnName))
        {
            destinationRow[columnName] = sourceRow[columnName];
        }
    }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:12:01.940

这是正常行为，如果您将同一列添加到多个 DataTable ArgumentException 将被抛出。

请参阅此处的文档：http: [//msdn.microsoft.com/en-us/library/55b10992.aspx](http://msdn.microsoft.com/en-us/library/55b10992.aspx)

您可以创建一个与已添加到原始表中的列相同的新列，并将其添加到新表中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:20:03.497

表数据按行组织，然后按列组织。您不能（据我所知）一次添加一列数据。您需要将列*定义*添加到第二个表中，并单独将数据添加到其中。

由于您的原始代码循环遍历所有列，因此您最好使用复制原始数据表`DataTable.Copy()`并删除您*不*想要的内容。

# android - 在 sqlite 中更改列中的值

> ID：11563732
> 
> 赞同：14
> 
> 时间：2012-07-19T15:05:37.593
> 
> 标签：android, sqlite

我需要更新某个表的列中的值。我试过这个：

```
 public void updateOneColumn(String TABLE_NAME, String Column, String rowId, String ColumnName, String newValue){
                 String sql = "UPDATE "+TABLE_NAME +" SET " + ColumnName+ " = "+newValue+" WHERE "+Column+ " = "+rowId;
                 db.beginTransaction();
                 SQLiteStatement stmt = db.compileStatement(sql);
                 try{
                     stmt.execute();
                     db.setTransactionSuccessful();
                 }finally{
                     db.endTransaction();
                 }

        } 
```

我这样称呼这个方法：

```
 db.updateOneColumn("roadmap", "id_roadmap",id,"sys_roadmap_status_mobile_id", "1"); 
```

这意味着我想`1`在列`sys_roadmap_status_mobile_id`中设置值`id_roadmap = id.`

问题是什么都没有发生。我的错误在哪里？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-19T15:12:22.453

简单的解决方案：

```
String sql = "UPDATE "+TABLE_NAME +" SET " + ColumnName+ " = '"+newValue+"' WHERE "+Column+ " = "+rowId; 
```

更好的解决方案：

```
ContentValues cv = new ContentValues();
cv.put(ColumnName, newValue);
db.update(TABLE_NAME, cv, Column + "= ?", new String[] {rowId}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-07T06:21:57.813

以下解决方案适用于我更新单行值：

```
public long fileHasBeenDownloaded(String fileName) 
{
    SQLiteDatabase db = this.getWritableDatabase();

    long id = 0;

    try {
        ContentValues cv = new ContentValues();
        cv.put(IFD_ISDOWNLOADED, 1);

        // The columns for the WHERE clause
        String selection = (IFD_FILENAME + " = ?");

        // The values for the WHERE clause
        String[] selectionArgs = {String.valueOf(InhalerFileDownload.fileName)};

        id = db.update(TABLE_INHALER_FILE_DOWNLOAD, cv, selection, selectionArgs);
    } 
    catch (Exception e) {
        e.printStackTrace();
    }
    return id;
} 
```

# c# - Windows 8 桌面应用程序中的功能区菜单

> ID：11563733
> 
> 赞同：3
> 
> 时间：2012-07-19T15:05:38.327
> 
> 标签：c#, .net, wpf, windows, winforms

好的，所以在拥有 Windows 7 的大部分时间里，实现功能区菜单是一件很痛苦的事情。我确实希望在 Visual Studio Ultimate 2012 RC 中看到对它的全面支持。由于MS似乎非常想推动它。

* * *

如何使用 VS 2012 Ultimate RC 将功能区菜单（原始/默认/普通菜单 - 不是第三方菜单）添加到适用于 Windows 8 的 WinForms 或 WPF 桌面应用程序？

我从字面上搜索了每一个我能找到的看起来甚至远程相关的网站，但没有任何运气。

任何帮助都非常感谢

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:37:57.033

[此 msdn 链接将为您提供“入门”信息。](http://msdn.microsoft.com/en-us/library/ff799534.aspx)

在该页面上，下载功能区项目并将其添加到 VS。然后，您可以将其添加到您的项目中。它适用于 .NET 4.0 和 4.5，但不适用于 3.5 或更低版本。

# sql - 嵌套插入执行

> ID：11563734
> 
> 赞同：0
> 
> 时间：2012-07-19T15:05:38.497
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures, insert-into

> **可能重复：**
> [错误：“INSERT EXEC 语句不能嵌套。” 和“不能在 INSERT-EXEC 语句中使用 ROLLBACK 语句。” 如何解决这个问题？](https://stackoverflow.com/questions/3795263/errors-insert-exec-statement-cannot-be-nested-and-cannot-use-the-rollback-s)

我们在生产中有一个存储过程，它返回一个选择。此选择由 INSERT INTO 填充到临时表，调用存储过程。

所以现在我们现在需要生成另一个 sproc，它将使用 sproc_1 返回的数据。问题是新的 sproc 还包含一个临时表，该表是通过调用 sproc_1 填充的。

显然，我们得到了抱怨嵌套插入执行的 SQL 错误。

任何想法如何克服这个问题？我们花了一天时间研究这个问题，但没有找到可行的**解决**方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:39:23.953

我怀疑你能否实现嵌套插入执行参考：
[http](http://social.msdn.microsoft.com/forums/en-US/transactsql/thread/e66c9e71-4424-4cf3-920c-6725ffc40162/)
://social.msdn.microsoft.com/forums/en-US/transactsql/thread/e66c9e71-4424-4cf3-920c-6725ffc40162/ 但我想这可能帮你
[http://www.sqlservercentral.com/Forums/Topic13595-8-1.aspx#bm68301](http://www.sqlservercentral.com/Forums/Topic13595-8-1.aspx#bm68301)

# wordpress - CSS3 下拉导航

> ID：11563740
> 
> 赞同：1
> 
> 时间：2012-07-19T15:06:02.923
> 
> 标签：wordpress, css, navigation, wordpress-theming, drop-down-menu

更准确地说，我正在寻找一个纯 CSS3 下拉导航，它可以滑出（和滑入）UL 元素，就像 jQuery 通常可以工作一样。

我试过让它在不透明度和可见性下工作，但它似乎不能正常工作：要么它扭曲了，要么它没有滑出，或者当鼠标放在错误的位置时它滑出等等。

这是我目前的 CSS 类：

```
 #nav li ul {
    left:-20000px;
    position:absolute;
    z-index:1;
    top:42px;
    width:140px;
    opacity:0;
    -webkit-transition: opacity .25s ease .1s;
    -moz-transition: opacity .25s ease .1s;
    -o-transition: opacity .25s ease .1s;
    -ms-transition: opacity .25s ease .1s;
    transition: opacity .25s ease .1s;
}
#nav li ul:hover {
    opacity:1;
}
#nav li ul li {
    float:none;
    background-color:#fff;
    padding:9px 0 0 10px;

    height:0;
    overflow:hidden;
    -webkit-transition: height .25s ease .1s;
    -moz-transition: height .25s ease .1s;
    -o-transition: height .25s ease .1s;
    -ms-transition: height .25s ease .1s;
    transition: height .25s ease .1s;
}
#nav li ul li:hover {
    height:40px;
    overflow:visible;
}
#nav li ul li a {
    font-size:12px;
}

#nav li:hover ul {
    left:0;
} 
```

HTML 来自 Wordpress，因为这就是我创建主题的目的。这是代码片段，我无法发布更多内容，因为我在任何地方都看不到代码。我想这也必须由热衷于 Wordpress 的人来回答：

```
<div id="nav-wrapper">
<ul id="nav">
<?php wp_nav_menu( array( 'container' => false, 'theme_location' => 'primary-menu' ) ); ?>
</ul> 
```

似乎它可能是这样的，虽然我自己并不真正理解这一行：

```
<ul id=\"%1$s\" class=\"%2$s\">%3$s</ul> 
```

PS 很抱歉缺少有关 HTML 部分的详细信息，我正在尽我所能用我所拥有和能够找到的知识。

编辑#2：按照建议，复制打印出来的源。但是，没有“菜单项”或“子菜单”类”，我可以从之前提供的 CSS 类中进行外观更改（颜色、边框、大小等）。

```
 <ul id="nav">
<li id="menu-item-1565" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1565"><a href="http://localhost/" rel="nofollow" title="" target="_blank">Home</a>
<ul class="sub-menu">
<li id="menu-item-1456" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1456"><a href="http://localhost/category/news/games-news/">Games</a></li>
<li id="menu-item-2324" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2324"><a href="http://localhost/category/news/internet-news/">Internet</a></li>
<li id="menu-item-1876" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1876"><a href="http://localhost/category/news/hardware-news/">Hardware</a></li>
<li id="menu-item-1786" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1786"><a href="http://localhost/category/news/software-news/">Software</a></li>
</ul>
</li>
<li id="menu-item-1432" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1432"><a href="http://localhost/test1/">TEST #1</a></li>
<li id="menu-item-1653" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1653"><a href="http://localhost/test2/">TEST #2</a></li>
            </ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:27:10.117

试试这个 - [http://jsfiddle.net/2mCZM/](http://jsfiddle.net/2mCZM/)

**HTML**

```
<ul id="nav">
    <li><a href="#">Item 1</a>
        <ul class="sub1">
            <li><a href="#">Item 1.1</a></li>
        </ul>
    </li>
    <li><a href="#">Item 2</a>
        <ul class="sub2">
            <li><a href="#">Item 2.1</a></li>
            <li><a href="#">Item 2.2</a></li>
        </ul>
    </li>
    <li><a href="#">Item 3</a>
        <ul class="sub3">
            <li><a href="#">Item 3.1</a></li>
            <li><a href="#">Item 3.2</a></li>
            <li><a href="#">Item 3.3</a></li>
        </ul>
    </li>
</ul> 
```

**CSS**

```
#nav li {
    display: inline-block;
    width: 140px;
    background: beige;
    border-bottom: 1px solid orange;
    position: relative;
    height: 42px;
    line-height: 42px;
}

#nav li ul {
    position:absolute;
    left: 0;
    top:43px;
    width:140px;
    height: 0;
    overflow:hidden;

    -webkit-transition: height .25s linear;
       -moz-transition: height .25s linear;
         -o-transition: height .25s linear;
        -ms-transition: height .25s linear;
            transition: height .25s linear;
}

#nav li:hover ul.sub1 { height: 42px; }
#nav li:hover ul.sub2 { height: 84px; }
#nav li:hover ul.sub3 { height: 126px; } 
```

# jquery - 多选项选择器的 jquery 事件

> ID：11563743
> 
> 赞同：0
> 
> 时间：2012-07-19T15:06:04.877
> 
> 标签：jquery, ajax

![在此处输入图像描述](../Images/14061435fc985e6ce6bcbe96202c0b27.png)

当我单击箭头时，右名称将显示在右选择选项中

![在此处输入图像描述](../Images/128a15b1bfd84d44d4bc01ca283dbedd.png)

我想存储右侧的名称，因为我正在做 serlization，我使用了下面的代码

1.  现在我应该使用哪个事件来调用 ajax 是 onchange 是正确的？
2.  我正在选择选项

`var ser = $("#seo_keyword_select2_onchange").next().attr("select").serialize(); var rowArr=decodeURIComponent(ser);`

我的 html 是

```
<td id="seo_keyword_select2_onchange">
   <select name="seo_keyword_select2[]" id="seo_keyword_select2" multiple size="10"  class="multiple_select">
        <option value="0">Select 2</option>
    </select>
 </td> 
```

但它现在不工作如何得到这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:53:56.747

您可以只使用：

```
var ser = $('#seo_keyword_select2').serialize(); 
var rowArr = decodeURIComponent(ser); 
```

# eclipse - 用于 Eclipse 的 ANTLR 语法文件编辑器

> ID：11563748
> 
> 赞同：1
> 
> 时间：2012-07-19T15:06:27.700
> 
> 标签：eclipse, antlr3

最近，我尝试使用[http://antlreclipse.sourceforge.net/updates/](http://antlreclipse.sourceforge.net/updates/)上的 ANTLR Editor for Eclipse 编写 ANTLR 语法文件 (.g) 。

我发现这个编辑器只对突出语法有用（除非我总是手动编译）。

是否有任何基于 Eclipse 的 ANTLR 编辑器等效于 ANTLR Works 并与 ANTLR 3 兼容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:12:39.927

您可以尝试Antlr3 网站上也[推荐的](https://theantlrguy.atlassian.net/wiki/plugins/servlet/mobile?contentId=2687335#IntegrationwithDevelopmentEnvironments-Eclipse3.3+forAntlr3.x)[AntrDT 。](http://www.certiv.net/projects/antlrdt.html)对于 Antlr4 也有[antlr4ide](https://github.com/jknack/antlr4ide)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:34:54.837

我已经在 Eclipse 中使用 ANTLR 大约六周了。一旦你完成了这个过程，它就会很好地工作。您**绝对**不必手动编译，因此请在[此处检查您的 ANTLR IDE 配置](https://stackoverflow.com/questions/8343488/antlr-ide-in-eclipse-doesnt-work/10887515#10887515)。如果一切都好，那么看看[Eclipse 中的 ANTLR 测试/调试过程](https://stackoverflow.com/questions/10838068/testing-antlr-grammar/10886842#10886842)。希望这些帮助。

# python - 使用 Python 子进程在标准输出上捕获 C 程序的输出？期待吗？

> ID：11563752
> 
> 赞同：2
> 
> 时间：2012-07-19T15:06:42.443
> 
> 标签：python, subprocess

我想从我正在启动的 C 程序中捕获输出，如下所示：

```
p = subprocess.Popen(["make", "run_pci"],
                     stdout=subprocess.PIPE,
                     cwd="/home/ecorbett/hello_world_pthread")
for ln in p.stdout: 
```

唯一的问题是在 C 程序完成之前我没有得到输出，而实际上我需要在程序运行时逐行获取输出。为了使事情进一步复杂化，我必须解析每一行（我只需要行中的某些数据）。

例如，这里是一些示例输出：（我需要捕获“Thread on Tile #”）

```
blahblah blah Thread blahblah blah tile 1: On 
blahblah blah Thread blahblah blah tile 2: OFF 
blahblah blah Thread blahblah blah tile 3 : Disable 
```

我注意到我在下面链接的文章似乎有同样的问题。我试图弄清楚如何使其适应我的情况？

[从 ffmpeg 获取实时输出以在进度条中使用（PyQt4，stdout）](https://stackoverflow.com/questions/7632589/getting-realtime-output-from-ffmpeg-to-be-used-in-progress-bar-pyqt4-stdout)

Python新手，非常感谢示例代码！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:40:02.533

您需要使用的原因[`pexpect`](http://pypi.python.org/pypi/pexpect/)是，如果程序的 stdio 未连接到 tty，它将使用块缓冲。 `pexpect`使用伪 tty (pty)，因此 stdio 将使用行缓冲，您将能够在输出行时访问它们。

将您的代码更改为：

```
p = pexpect.spawn('make', ['run_pci'], cwd="/home/ecorbett/hello_world_pthread")
for ln in p:
    ... 
```

您可以使用`pexpect.spawn.expect`来获取您感兴趣的输出：

```
while p.expect('Thread on Tile (\d+):', pexpect.EOF) == 0:
    print("Tile {0}".format(int(p.group[1]))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:16:53.087

你不能像那样使用 p.stdout ；如果您要求“整个标准输出”，则仅在进程终止（或管道缓冲区填充，这可能需要很长时间）时才可用。

您需要逐行读取进程的标准输出。

```
while True:
    ln = p.stdout.readline()
    if '' == ln:
        break
    m = re.search("Thread (?P<id>\d+)", ln);
    if m:
        # use m.group() to extract information
        # e.g. m.group('id') will hold the 12345 from "Thread 12345" 
```

如果可以将 stdout 设置为行缓冲（通常尽可能完全缓冲），那也是最好的，但我认为这只能在被调用的程序中完成。

我们在这里要考虑两个缓冲区。一是C程序的输出缓冲区。这可能不存在（无缓冲输出）、行缓冲或完全缓冲（1K、4K 或 8K 是一些可能的大小）。

在程序中，调用了“printf()”。输出如下：

*   出，如果没有缓冲
*   进入缓冲区；然后如果行缓冲，则输出缓冲区中所有以换行符结尾的行；
*   进入缓冲区；然后输出前 4K，如果用 4K 缓冲区完全缓冲并且缓冲区比 4K 更满。

现在输出进入 Python 的管道。这又可以是完全缓冲的（stdout）或行缓冲的（readline）。所以输出是：

*   根据 python 程序的逻辑，如果管道中有一个完整的换行符终止行并且我们正在使用 readline
*   到缓冲区，如果管道中小于 4K 并且我们正在使用“for ln in stdout”。

在最后一种情况下，缓冲区将以 4K 块的形式进入 Python 逻辑。

现在让我们想象一个**行缓冲**的C 程序每秒向 Python 程序输出一行，长度为 1K 字符（如果 C 程序是完全缓冲的，那么可以做的事情并不多！）

在循环中读取标准输出，我们会看到（在 for 循环内）：

*   t = 0 ... 没有
*   t = 1 ... 没有（缓冲区已满 50%）
*   t = 2 ... 没有（缓冲区已满 75%）
*   t = 3 ... 四行输出
*   t = 4 ... 没有 ...

通读 readline 我们会得到：

*   t = 0 ... 一行
*   t = 1 ... 一行
*   t = 2 ... 一行
*   t = 3 ... 一行

**例子**

在这里，我运行“ping -c 3 -i 2 127.0.0.1”，以便以两秒的间隔将三个数据包发送到本地主机。一次 ping 运行大约需要六秒钟。我从 ping 读取输出，并打印时间戳。ping 的整个输出足够小，可以放入 Python 的全缓冲区。

```
#!/usr/bin/python

import subprocess
from time import gmtime, strftime

p = subprocess.Popen(["ping", "-c", "3", "-i", "2", "127.0.0.1"],
                 stdout=subprocess.PIPE)

for ln in p.stdout:
    print strftime("%H:%M:%S", gmtime()) + " received " + ln

# Now I start the same process again, reading the input the other way.

p = subprocess.Popen(["ping", "-c", "3", "-i", "2", "127.0.0.1"],
                 stdout=subprocess.PIPE)

while True:
    ln = p.stdout.readline()
    if '' == ln:
            break
    print strftime("%H:%M:%S", gmtime()) + " received " + ln 
```

正如预期的那样，我在 Linux 机器上收到的输出是：

```
(nothing for the first six seconds)
15:40:10 received PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
15:40:10 received 64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.037 ms
15:40:10 received 64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.034 ms
15:40:10 received 64 bytes from 127.0.0.1: icmp_seq=3 ttl=64 time=0.031 ms
15:40:10 received
15:40:10 received --- 127.0.0.1 ping statistics ---
15:40:10 received 3 packets transmitted, 3 received, 0% packet loss, time 3998ms
15:40:10 received rtt min/avg/max/mdev = 0.031/0.034/0.037/0.002 ms

15:40:10 received PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
15:40:10 received 64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.041 ms
15:40:12 received 64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.039 ms
15:40:14 received 64 bytes from 127.0.0.1: icmp_seq=3 ttl=64 time=0.035 ms
15:40:14 received
15:40:14 received --- 127.0.0.1 ping statistics ---
15:40:14 received 3 packets transmitted, 3 received, 0% packet loss, time 3999ms
15:40:14 received rtt min/avg/max/mdev = 0.035/0.038/0.041/0.005 ms 
```

# css - 外部div的CSS背景和边框

> ID：11563754
> 
> 赞同：1
> 
> 时间：2012-07-19T15:06:45.563
> 
> 标签：css, html, background, border

我有一个包含其他 div 的画廊 div（每个都有一个图像）。在外部 div 中，我设置了背景和边框，但没有任何反应......我知道问题是内部 div 只包含标签，没有别的。我如何在不设置固定宽度的情况下工作？*所有标签甚至之前都关闭了。我复制了部分代码，很抱歉造成误解！*有人说要设置溢出，它起作用了！谢谢！（帖子被删除了，没看到是谁！谢谢大家的回答！

```
<div class="gallerybox">
     <div class="img">
         <a href="#" onclick="OpenNewWindow('#', 550, 413); return true;"><img src="#" width="140" class="border1" alt="Click..."/></a>
     </div>
</div> 
```

和CSS。

```
.gallerybox {
    background:#CCC;
    border:#000;
    -moz-border-radius: 15px;
    border-radius: 15px;
} 
```

感谢：D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:12:00.713

背景工作正常。您的边框问题可以通过为其分配特定的宽度和样式来解决。

例如：

```
border: 1px solid #000; 
```

JS 小提琴：http: [//jsfiddle.net/mQQ2A/2/](http://jsfiddle.net/mQQ2A/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:14:48.727

嗨，您应该在仅指定它们的颜色时使用背景颜色和边框颜色属性。

```
.gallerybox {
    background-color:#CCC;
    border-color:#000;
    -moz-border-radius: 15px;
    border-radius: 15px;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:11:05.060

可能是您没有为边框设置任何内容，但它的颜色和半径：

```
border:#ccc; 
```

应该：

```
border:solid 1px #ccc; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:11:14.343

确保关闭`div.gallarybox`. 现在它是开放的。当我尝试并关闭它时，我发现它的功能与预期的一样。

[http://jsfiddle.net/6rGxw/](http://jsfiddle.net/6rGxw/)

# api - 使用 Play Framework 使用我自己的 REST api

> ID：11563757
> 
> 赞同：0
> 
> 时间：2012-07-19T15:06:49.480
> 
> 标签：api, rest, playframework, playframework-1.x

因此，我正在更新具有以下设置的 Play 1.2.x 应用程序

```
- controllers
    - api 
        - Documents // create, update, read, delete, list
        ... // more controllers
    - web
        - Documents // list, read, etc...
        .. // more controllers 
```

**api**包中的控制器将数据呈现为移动客户端（Android、iPhone）使用的**Json 。**

现在我想要一个使用 api 的简单的 html web 应用程序。那么如何从 web 包中的控制器中使用 API 呢？

我的目标是避免在 web 控制器逻辑中重写 api 控制器逻辑。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:46:43.567

在我看来，在控制器之间重用方法并不是最佳实践。共享行为应该在模型中编码，然后两个控制器可以使用相同的模型方法。

尽管如此，如果你想这样做，你可以在你的 apis 控制器的公共方法中提取共享行为，你可以注释为“@Util”，然后从你的 web 控制器调用这个方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T08:18:00.177

你的问题没有太多细节，所以我不知道它是否适用，但通常当我实现 REST API 时，我会让他们以不同的格式（JSON 和 HTML，如果你想要 JSONP 和 XML）提供答案。

主要思想是

1.  检查请求以了解所需的格式：使用[接受内容类型、url 扩展名，甚至是参数](https://stackoverflow.com/questions/381568/rest-content-type-should-it-be-based-on-extension-or-accept-header)（以及[更多关于它](http://blog.programmableweb.com/2011/11/18/rest-api-design-putting-the-type-in-content-type/)的信息）
2.  选择正确的模板（如果您已经正确构建了 Json 对象，则跳过模板）

在游戏中，第一部分有不同的方法，例如。通过您的路线：[在 Play 中请求 Content-Type！REST 网络服务框架](https://stackoverflow.com/questions/9675657/request-content-type-in-play-framework-for-rest-webservices)；[Play 文档](http://www.playframework.org/documentation/1.2/routes)中有一个关于此的特定页面。

但是这个答案中最重要的部分是第二点：您应该使用相同的控制器，并且 HTML 模板应该能够使用以 json 格式（或者更多）发送回的相同数据来呈现您的页面！

注意。如果您需要更多地定制一些东西，您可以访问`request`控制器中的对象，检查请求的格式是什么，并采取相应的行动以使用适当的模板返回适当的数据！

# iphone - 将证书移动到新计算机时出现问题

> ID：11563761
> 
> 赞同：0
> 
> 时间：2012-07-19T15:07:07.453
> 
> 标签：iphone, xcode, xcode4.3, code-signing, organizer

我正在移动计算机以开发新计算机，所以！我正在尝试使用旧的证书在新的应用程序中构建应用程序！

我从钥匙串中导出了所有文件，并在管理器上自动下载了文件（通过单击刷新按钮）。所以问题来了：我无法归档任何应用程序（1 个应用程序发布到商店的 2 个不同应用程序中）：

[Library Organizer](http://hpics.li/6075e1a) [Teams Organizer](http://hpics.li/01e72fa) [Teams Organizer](http://hpics.li/f943769) [XCODE](http://hpics.li/57b10e3) [错误屏幕中的代码登录](http://hpics.li/5d44b69)

我真的不明白我的错误！

我删除了新机器中的所有证书，在我制作这个视频后解释我是如何制作 . 上面有一个错误，但我不知道何时何地 : [VIDEO](http://www.youtube.com/watch?v=E18cxSOfWJ4&feature=youtu.be)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T11:47:25.237

我假设您的旧 Mac 是您创建 CSR 以及开发和分发证书的机器。

按照这个简单的步骤： -

1.  首先在旧mac中打开钥匙串并将私钥导出为p12
2.  然后在新的 mac 中使用这个 .p12 文件，只需双击它并输入你给的密码。
3.  登录到供应门户并选择证书在新 Mac 中下载 ios_developement.cer 和 ios_distribution.cer。如果这两个证书成功添加到新的 mac 钥匙串，则双击这两个证书，那么您可以使用与这些证书关联的所有配置文件（您可以在证书部分查看特定证书的相关配置文件列表。）
4.  从门户下载配置文件并双击将其添加到 xcode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T11:57:32.723

您所要做的就是进入 Organizer 而不是钥匙串。

选择左侧的开发者资料。在窗口底部单击导出：它将创建一个存档，其中包含您可以在另一个 xcode 座位上导入的所有内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:27:05.163

如果您没有保存您的私钥，您必须撤销您的证书并创建新的。否则：正如@Dhaval 所写：您必须将保存的密钥导出到您的钥匙串中，您的证书才会起作用。

# android - 如何重新安装 android 联系人应用程序以替换原始应用程序进行调试？

> ID：11563770
> 
> 赞同：1
> 
> 时间：2012-07-19T15:07:26.173
> 
> 标签：android, android-contacts

我修改了基于android 2.3的联系人应用程序代码，并编译为Contacts.apk，然后将其推送到system/app/，但联系人应用程序在Launcher中消失了，然后我重新安装它，我得到了INSTALL_FAILED_SHARED_USER_INCOMPATIBLE，如何调试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:12:48.803

Andoid 为您安装的软件包创建“共享用户”。有时这些共享用户的管理会变得混乱，你会得到：

```
INSTALL_FAILED_SHARED_USER_INCOMPATIBLE 
```

共享用户管理保存在`/data/system/packages.xml`：

怎么解决？您需要有根电话和 adb：

```
adb shell su -c "chmod 666 /data/system/packages.xml"

adb pull /data/system/packages.xml 
```

现在获取文件的备份副本，然后编辑文件并从文件中删除共享用户：

```
<shared-user name="com.your.target.app" userId="10000">
<sigs count="1">
<cert index="4" />
</sigs>
<perms>
<item name="android.permission.READ_PHONE_STATE" />
<item name="android.permission.DISABLE_KEYGUARD" />
<item name="android.permission.INTERNET" />
<item name="android.permission.WRITE_EXTERNAL_STORAGE" />
<item name="android.permission.ACCESS_FINE_LOCATION" />
<item name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<item name="android.permission.ACCESS_COARSE_LOCATION" />
<item name="android.permission.READ_CONTACTS" />
<item name="android.permission.WRITE_CONTACTS" />
<item name="android.permission.ACCESS_NETWORK_STATE" />
<item name="android.permission.WAKE_LOCK" />
<item name="android.permission.MODIFY_AUDIO_SETTINGS" />
</perms>
</shared-user> 
```

然后将修改后的文件复制回来：

```
adb push packages.xml /data/system/packages.xml

adb shell rm /data/dalvik-cache/*

adb shell su -c reboot 
```

**编辑**
另一件事是，如果它具有共享用户 ID，您需要使用与其他已安装应用程序相同的证书对 apk 进行签名。但通常不可能从手机制造商处获得该证书。

在这种情况下，您可以尝试打开清单文件并找到：

```
android:sharedUserId="some_string" 
```

并用不同的东西改变它。重建apk，清理packages.xml，重新启动并再次安装。

# listview - Windows Metro：如何在没有列表视图的情况下创建水平 div？

> ID：11563778
> 
> 赞同：0
> 
> 时间：2012-07-19T15:08:00.103
> 
> 标签：listview, layout, windows-8, microsoft-metro

我想创建一个基本的水平布局，包含一些图片、文本和链接。有些图片较大（100% 垂直），有些较小（50%），中间有一些文字。

我研究了 ListView，但它似乎不适合我想要的（没有巨大的复杂性），因为我所有的图片（itens）都有不同的布局，而且还有一些临时文本。

如果我可以使用 ListView 的布局而没有它的所有复杂性、数据源和其他东西，那就太好了。我没有实际数据，只有带有特定图像、文本和链接的水平布局。

谁能给我一个方向？我正在使用带有 Javascript + HTML 的 Metro。

在纯 HTML 中，我可能会使用固定宽度的 div，例如 4000 像素。

Metro 编程提出了许多新概念，而且文档还不是很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:47:51.660

如果您的项目大小相同（或者可以这样制作），您应该能够使用“flexbox”：http: [//msdn.microsoft.com/en-us/library/ie/hh673531 (v=vs .85).aspx](http://msdn.microsoft.com/en-us/library/ie/hh673531(v=vs.85).aspx)

我喜欢 flexbox。

# iphone - NSString 选择部分去一个字符串objective-c

> ID：11563779
> 
> 赞同：0
> 
> 时间：2012-07-19T15:08:05.730
> 
> 标签：iphone, objective-c

我的字符串有问题。字符串显示：`~00000000:termometr2: +26.9 st.C`我只想使用这部分：`+26.9 st.C`在我的 textfield.text 中。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:13:38.773

```
NSString *fullStr = @"00000000:termometr2: +26.9 st.C";
NSArray *parts = [fullStr componentsSeparatedByString:@" "];
textField.text =[NSString stringWithFormat:@"%@",[parts objectAtIndex:1]]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:14:58.750

它可能会帮助您：

```
NSArray *_array = [yourString componentsSeparatedByString:@":"];
[myTextField setText:[_array lastObject]]; // or any other component you want 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:12:53.453

只需这样做，使用方法**stringByReplacingOccurrencesOfString: withString:**：

```
NSString *originalString = @"~00000000:termometr2: +26.9 st.C";
NSString *filteredString = [originalString stringByReplacingOccurrencesOfString:@"~00000000:termometr2: " withString:@""]; 
```

# jquery-mobile - 使用 JQuery Mobile 在移动网站上投放 Exoclick 成人广告

> ID：11563783
> 
> 赞同：1
> 
> 时间：2012-07-19T15:08:26.313
> 
> 标签：jquery-mobile, ads

我在使用 Exoclick 成人广告在使用 JQuery UI 的移动网站上做广告时遇到问题。

我不知道我可以在这里透露多少，直到它太过“成人”，我不能再在这里发布了。

Exoclick 横幅显示，但只有一次！在站点内导航不会再次出现相同的广告（我们有两个广告，底部和顶部。每个站点每次遍历仅加载一次）。如果您使用浏览器的刷新功能（“F5”）刷新，它们将再次加载......但只有一次。

好的，Exoclick 给了我一个这样的片段：

```
<!-- BEGIN ExoClick.com Ad Code -->
<script type="text/javascript" src="http://syndication.exoclick.com/ads.php?type=300x50&login=<username>&cat=110&search=&ad_title_color=0000cc&bgcolor=FFFFFF&border=0&border_color=000000&font=&block_keywords=&ad_text_color=000000&ad_durl_color=008000&adult=0&sub=&text_only=0&show_thumb=&idzone=<zone id>&idsite=<site id>"></script>
<noscript>Your browser does not support JavaScript. Update it for a better user experience.</noscript>
<!-- END ExoClick.com Ad Code --></div> 
```

问题是，这在静态站点上非常有效，但由于 JQuery Mobile 使用 AJAX 获取所有内容的性质，脚本将多次加载到浏览器的执行上下文中（至少这是我认为会发生的事情！）和最后......甚至不再执行？

我已经想到的：

*   缓存 Exoclick 广告脚本的输出（JS 有类似“outputcache”的东西吗？）
*   停用 Ajax

我尝试停用 Ajax 请求，但由于某种原因，这没有做任何事情：

```
 <script>
    $(document).bind("mobileinit", function(){
        $.mobile.ajaxEnabled = false;
    });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T16:55:16.477

停用 Ajax 应该可以：

```
 $(document).bind("mobileinit", function () {

             $.mobile.addBackBtn = false;
             $.mobile.ajaxEnabled = false;
             $.mobile.ajaxLinksEnabled = false;

         }); 
```

另一方面，您可以在每次 ajax 成功时刷新/重新加载脚本

```
$('html').ajaxSuccess(function() {
  //reload your script using js, plenty of that on google
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T15:21:16.603

我做到了……@bobek 间接地把我带到了这个答案。

我所做的是首先创建一个包含广告的不可见 div。然后，在 pageinit 上，我窃取了 div 并将其从 DOM 中删除。div 现在将有一个由 Exoclick 制作的 iframe。

然后，在没有 exoclick 脚本的情况下，我将其插入到每个页面初始化事件的 dom 中......

为了防止脚本被插入回 dom，在服务器端我检查 X-REQUESTED-WITH 标头。如果是 XMLHttpRquest，我不发送广告。

这是它在代码中的样子：

网站上任何地方的临时广告展示位置：

```
<div id="ads">
    <div style="display: none" id="topad">
        <?php require("./_topbannerb.php"); ?>
    </div>
    <div style="display: none" id="bottomad">
        <?php require("./_bottombannerb.php"); ?>
    </div> 
</div> 
```

这两个 PHP 文件包含 exoclick 的标签。没有其他的。

head 标签中的脚本：

```
<script>
ads = "";
first = true;

$(document).bind('pageinit', function() {

if (first) {
    ads = $("#ads");
    ads.remove();
}

first = false;

$.each($(".adt"), function(i, v) {
    $(v).append($(ads).children("#topad").first().children("div").clone())
});

$.each($(".adb"), function(i, v) {
    $(v).append($(ads).children("#bottomad").first().children("div").clone())
    });
}); 
</script> 
```

然后，广告应该放在最后的位置：

```
<div class="adt"> </div> 
```

该脚本会自动插入到每个广告展示位置。这里我有两个不同的广告区域：顶部和底部。除了 exoclick 如何在后面处理它们之外，两者都没有区别。

# vector - 用 3 个给定的 3d 点计算角度

> ID：11563790
> 
> 赞同：1
> 
> 时间：2012-07-19T15:08:57.043
> 
> 标签：vector, xna, microsoft-metro, windows-runtime, kinect

我正在为 Metro 应用程序在 winrt 上进行 kinect 实验。我试图在肘部获得角度。

通常我会做以下事情

```
Vector3D handLeftVector = new Vector3D(HandLeftX, HandLeftY, HandLeftZ);
handLeftVector.Normalize();

Vector3D ElbowLeftEVector = new Vector3D(ElbowLeftX, ElbowLeftY, ElbowLeftZ);
ElbowLeftEVector.Normalize();

Vector3D ShoulderLeftVector = new Vector3D(ShoulderLeftX, ShoulderLeftY, ShoulderLeftZ);
ShoulderLeftVector.Normalize();

Vector3D leftElbowV1 = ShoulderLeftVector - ElbowLeftEVector;
Vector3D leftElbowV2 = handLeftVector - ElbowLeftEVector;
double leftElbowAngle = Vector3D.AngleBetween(leftElbowV1, leftElbowV2); 
```

但是 Vector3D 对象在 winrt 中不可用。

我决定复制 Vector3D 方法，如下所示。然而结果似乎并不像预期的那样。我在哪里犯错了吗？

```
double leftElbowV1X = ShoulderLeftX - ElbowLeftX;
double leftElbowV1Y = ShoulderLeftY - ElbowLeftY;
double leftElbowV1Z = ShoulderLeftZ - ElbowLeftZ;

double leftElbowV2X = handLeftX - ElbowLeftX;
double leftElbowV2Y = handLeftY - ElbowLeftY;
double leftElbowV2Z = handLeftZ - ElbowLeftZ;

double product = leftElbowV1X * leftElbowV2X + leftElbowV1Y * leftElbowV2Y + leftElbowV1Z * leftElbowV2Z;

double magnitudeA = Math.Sqrt(Math.Pow(leftElbowV1X, 2) + Math.Pow(leftElbowV1Y, 2) + Math.Pow(leftElbowV1Z, 2));
double magnitudeB = Math.Sqrt(Math.Pow(leftElbowV2X, 2) + Math.Pow(leftElbowV2Y, 2) + Math.Pow(leftElbowV2Z, 2));
magnitudeA = Math.Abs(magnitudeA);
magnitudeB = Math.Abs(magnitudeB);

double cosDelta = product / (magnitudeA * magnitudeB);
double angle = Math.Acos(cosDelta) *180.0 / Math.P; 
```

是否需要对其进行规范化？

我设法解决了它，但是我正在考虑是否有更有效的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T15:43:44.820

不确定这是否有帮助，但这是我使用的一些旧角度代码，以度数返回：

```
float AngleBetween(Vector3 from, Vector3 dest)  {
    float len = from.magnitude *  dest.magnitude;
    if(len < Mathf.Epsilon) len = Mathf.Epsilon;

    float f = Vector3.Dot(from,dest) / len;
    if(f>1.0f)f=1.0f;
    else if ( f < -1.0f) f = -1.0f;

    return Mathf.Acos(f) * 180.0f / (float)Math.PI;
} 
```

它显然使用了 API 特定的语法，但我认为方法很清楚。

# android - Android 应用内结算 RESTORE_TRANSACTION 使用情况

> ID：11563796
> 
> 赞同：0
> 
> 时间：2012-07-19T15:09:23.723
> 
> 标签：android, in-app-billing

有没有关于如何使用 RESTORE_TRANSACTIONS 请求来恢复应用内产品购买信息的示例？我想出了这段代码，但它总是返回 0，所以它无法识别是否购买了产品：一切都设置正确。

```
Bundle request = BillingHelper.makeRequestBundle("RESTORE_TRANSACTIONS");

request.putLong("NONCE", 32436756l);
try 
{
    Bundle response = BillingHelper.mService.sendBillingRequest(request);
    int response_code = response.getInt("RESPONSE_CODE", -1);
    if (response_code == 0)
    {
    // Product purchased
    }
} 
catch (RemoteException e) 
{
    e.printStackTrace();
} 
```

我在谷歌和文档中没有找到任何示例，所以任何指导都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T10:06:14.167

我使用了这种方法：

```
public static void restoreTransactionInformation(Long nonce) 
    {
        if (amIDead()) 
        {
            return;
        }
        Log.i(TAG, "confirmTransaction()");
        Bundle request = makeRequestBundle("RESTORE_TRANSACTIONS");
        // The REQUEST_NONCE key contains a cryptographically secure nonce (number used once) that you must generate
        request.putLong("NONCE", nonce);
        try 
        {
            Bundle response = mService.sendBillingRequest(request);

            //The REQUEST_ID key provides you with a unique request identifier for the request
            Long requestIndentifier     = (Long) response.get("REQUEST_ID");
            Log.i(TAG, "current request is:" + requestIndentifier);

            //The RESPONSE_CODE key provides you with the status of the request
            Integer responseCodeIndex   = (Integer) response.get("RESPONSE_CODE");
            C.ResponseCode responseCode = C.ResponseCode.valueOf(responseCodeIndex);
            Log.i(TAG, "RESTORE_TRANSACTIONS Sync Response code: "+responseCode.toString());
        } 
        catch (RemoteException e) 
        {
            Log.e(TAG, "Failed, internet error maybe", e);
            Log.e(TAG, "Billing supported: " + isBillingSupported());
        }
    } 
```

, 调用如下：

```
BillingHelper.restoreTransactionInformation(BillingSecurity.generateNonce()); 
```

# regex - 这个正则表达式是否非法“a（b |）c”？

> ID：11563803
> 
> 赞同：2
> 
> 时间：2012-07-19T15:09:50.240
> 
> 标签：regex

我写了一个可以像这样生成正则表达式的程序`a(b|)c`。其实，意思是`(abc)|(ac)`。但是`a(b|)c`对于任何正则表达式引擎来说都是可接受的正则表达式吗？或者有没有其他替代方法可以给出相同的语义含义？

进一步的问题：是否有任何工具可以将其转换为“正常”表示？例如转换`a(b|(c|))d`为`a(b|(c)?)d`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:12:17.947

这不是非法的，但这是一个非常奇怪的阵型。 `?`就目的而言，它更“惯用”（我的意思是，正则表达式的“演讲者”会更清楚，更容易理解）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:11:08.397

`ab?c`，或者`ab{0,1}c`会更有意义。一个`a`，后跟最多一个`b`，后跟一个`c`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T15:11:40.927

使用这个正则表达式`ab?c`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T15:12:29.413

是的，这是一个有效的正则表达式。Ruby 中的证明：

```
irb(main):003:0> "fooacbar".match( /a(b|)c/ )
#=> #<MatchData "ac" 1:"">
irb(main):004:0> "fooabcbar".match( /a(b|)c/ )
#=> #<MatchData "abc" 1:"b"> 
```

JavaScript 中的证明：

```
console.log( "fooabcbar".match(/a(b|)c/) )
//-> ["abc", "b"]

console.log( "fooacbar".match(/a(b|)c/) )
//-> ["ac", ""] 
```

然而，正如其他人所表明的那样，这样写更习惯：

```
/ab?c/     # If you have just one character optional
/a(foo)?c/ # If you have an arbitrary string optional 
```

另请注意，许多正则表达式引擎允许您指定括号是非捕获的（这可能会带来轻微的性能优势）：

```
/a(?:foo)?c/ # Optional arbitrary string that you don't need to save 
```

# css - 为网站迁移 Typekit 帐户 - 需要更改字体系列条目？

> ID：11563806
> 
> 赞同：0
> 
> 时间：2012-07-19T15:10:10.660
> 
> 标签：css, font-family, typekit

**我的问题：有没有办法可以配置我的 Typekit 帐户，以便字体名称与初始帐户匹配？**

**说明：**

我正在将站点从一个 typekit 帐户迁移到另一个。

我遇到的问题是第一个帐户的所有字体名称都以 -1 结尾，因此网站的 css 当前具有如下字体系列条目：

```
font-family: 'museo-sans-1';
font-family: 'superclarendon-1'; 
```

由于我没有这个 typekit 帐户（因此是切换的原因），我无法了解为什么字体名称是这样定义的。

在我的 typekit 帐户中，如果我想使用相同的字体，我需要将 font-family 条目更改为：

```
font-family: 'museo-sans';
font-family: 'superclarendon'; 
```

有谁知道它为什么会这样（-1）？

我尝试选中“包括特定于变体的字体系列名称”的框，但它似乎不起作用，因为字体名称都以 –LETTER 1 结尾（例如：museo-sans-n1）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:16:10.483

刚刚从 Typekit 的支持人员那里得到了答复。我认为在这里分享它会对互联网有所帮助（希望如此）！

这是我从他们那里收到的电子邮件的副本/粘贴：

> 以 -1/-2 结尾的字体系列名称是 Typekit 不再使用的旧约定。它仍然存在于当时创建的套件中，因为我们不想强迫用户编辑他们的 CSS。
> 
> 由于您创建了一个新工具包，您必须更新站点 CSS 以使用较新的字体系列名称，例如“museo-sans”。

# ios - 在 iOS 中，我们可以设置 UIButton 的字体和标题并获取它的宽度吗？

> ID：11563807
> 
> 赞同：1
> 
> 时间：2012-07-19T15:10:18.807
> 
> 标签：ios, uibutton

在 iOS 中，我们可以设置一个 UIButton 并获取它的宽度，还是必须设置它的宽度然后设置它的内容？

看来我们可以

```
[someString sizeWithFont:someFont].width 
```

获取宽度，然后将其设为按钮的宽度（通过设置其框架），然后设置该标题和字体。但是我们可以只设置按钮的字体和标题（并自动调整按钮大小），然后获取宽度吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T15:27:35.837

使用`sizeToFit`UIView 的方法（[http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW11](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW11)）

```
[button setTitle:@"Hello World" forState:UIControlStateNormal];
[button sizeToFit];
float width = button.frame.size.width; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-29T02:48:59.593

**sizeToFit**会起作用，但它并没有给你太大的灵活性，因为它把宽度和高度都包裹在文本周围。一个更好的方法是找出你可以用这个做的大小......

**（iOS 8 及以上）**

```
CGSize buttonSize = [button.titleLabel sizeWithAttributes:[NSDictionary dictionaryWithObjectsAndKeys:NSFontAttributeName ,[UIFont fontWithName:@"HelveticaNeue-Bold" size:9.0], nil]].width; 
```

**（iOS 7 及以下）**

```
CGSize buttonSize = [button.titleLabel sizeWithFont:[UIFont fontWithName:@"HelveticaNeue-Bold" size:9.0]].width; 
```

然后您可以通过使用**buttonSize调整框架来添加边距等**

```
[button setFrame:CGRectMake(0, 0, buttonSize.width + 20, buttonSize.height)]; 
```

# sql - 递归 SQL 语句 (Postgresql) - 简化版

> ID：11563809
> 
> 赞同：1
> 
> 时间：2012-07-19T15:10:30.137
> 
> 标签：sql, postgresql, common-table-expression, recursive-query

这是此处发布的更复杂问题的简化问题：

[递归 SQL 语句 (PostgreSQL 9.1.4)](https://stackoverflow.com/questions/11558328/recursive-sql-statement-postgresql-9-1-4)

**简化问题**

假设您将上三角矩阵存储在 3 列（RowIndex、ColumnIndex、MatrixValue）中：

```
 ColumnIndex       
    1   2   3   4   5
1   2   2   3   3   4
2   4   4   5   6   X
3   3   2   2   X   X
4   2   1   X   X   X
5   1   X   X   X   X 
```

X 值将使用以下算法计算：

```
M[i,j] = (M[i-1,j]+M[i,j-1])/2
(i= rows, j = columns, M=matrix)

Example:
M[3,4] = (M[2,4]+M[3,3])/2
M[3,5] = (m[2,5]+M[3,4])/2 
```

所需的全部结果是：

```
 ColumnIndex       
    1   2   3    4      5
1   2   2   3    3      4
2   4   4   5    6      5
3   3   2   2    4      4.5
4   2   1   1.5  2.75   3.625
5   1   1   1.25 2.00   2.8125 
```

样本数据：

```
create table matrix_data (
    RowIndex integer,
    ColumnIndex integer,
    MatrixValue numeric);

    insert into matrix_data values (1,1,2);
    insert into matrix_data values (1,2,2);
    insert into matrix_data values (1,3,3);
    insert into matrix_data values (1,4,3);
    insert into matrix_data values (1,5,4);
    insert into matrix_data values (2,1,4);
    insert into matrix_data values (2,2,4);
    insert into matrix_data values (2,3,5);
    insert into matrix_data values (2,4,6);
    insert into matrix_data values (3,1,3);
    insert into matrix_data values (3,2,2);
    insert into matrix_data values (3,3,2);
    insert into matrix_data values (4,1,2);
    insert into matrix_data values (4,2,1);
    insert into matrix_data values (5,1,1); 
```

这可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:27:43.570

测试设置：

```
CREATE TEMP TABLE matrix (
    rowindex integer,
    columnindex integer,
    matrixvalue numeric);

INSERT INTO matrix VALUES
 (1,1,2),(1,2,2),(1,3,3),(1,4,3),(1,5,4)
,(2,1,4),(2,2,4),(2,3,5),(2,4,6)
,(3,1,3),(3,2,2),(3,3,2)
,(4,1,2),(4,2,1)
,(5,1,1); 
```

在循环中运行插入`DO`：

```
DO $$
BEGIN

FOR i IN 2 .. 5 LOOP
   FOR j IN 7-i .. 5 LOOP
      INSERT INTO matrix
      VALUES (i,j, (
         SELECT sum(matrixvalue)/2
         FROM   matrix
         WHERE  (rowindex, columnindex) IN ((i-1, j),(i, j-1))
         ));
   END LOOP;
END LOOP;

END;
$$ 
```

查看结果：

```
SELECT * FROM matrix order BY 1,2; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:45:03.130

...这里出现了具有多个嵌入式 CTE (tm) 的递归 CTE：

```
DROP SCHEMA tmp CASCADE;
CREATE SCHEMA tmp ;
SET search_path=tmp;

CREATE TABLE matrix_data (
    yyy integer,
    xxx integer,
    val numeric);

    insert into matrix_data (yyy,xxx,val) values
      (1,1,2) , (1,2,2) , (1,3,3) , (1,4,3) , (1,5,4)
    , (2,1,4) , (2,2,4) , (2,3,5) , (2,4,6)
    , (3,1,3) , (3,2,2) , (3,3,2)
    , (4,1,2) , (4,2,1)
    , (5,1,1)
        ;

WITH RECURSIVE rr AS (
        WITH xx AS (
                SELECT MIN(xxx) AS x0
                , MAX(xxx) AS x1
                FROM matrix_data
                )
        , mimax AS (
                SELECT generate_series(xx.x0,xx.x1) AS xxx
                FROM xx
                )
        , yy AS (
                SELECT MIN(yyy) AS y0
                , MAX(yyy) AS y1
                FROM matrix_data
                )
        , mimay AS (
                SELECT generate_series(yy.y0,yy.y1) AS yyy
                FROM yy
                )
        , cart AS (
                SELECT * FROM mimax mm
                JOIN mimay my ON (1=1)
                )
        , empty AS (
                SELECT * FROM cart ca
                WHERE NOT EXISTS (
                        SELECT *
                        FROM matrix_data nx
                        WHERE nx.xxx = ca.xxx
                        AND nx.yyy = ca.yyy
                        )
                )
        , hot AS (
                SELECT * FROM empty emp
                WHERE EXISTS (
                        SELECT *
                        FROM matrix_data ex
                        WHERE ex.xxx = emp.xxx -1
                        AND ex.yyy = emp.yyy
                        )
                AND EXISTS (
                        SELECT *
                        FROM matrix_data ex
                        WHERE ex.xxx = emp.xxx
                        AND ex.yyy = emp.yyy -1
                        )
                    )
        -- UPDATE from here:
        SELECT h.xxx,h.yyy, md.val / 2 AS val
        FROM hot h
        JOIN matrix_data md ON
                (md.yyy = h.yyy AND md.xxx = h.xxx-1)
                OR (md.yyy = h.yyy-1 AND md.xxx = h.xxx)
        UNION ALL
        SELECT e.xxx,e.yyy, r.val / 2 AS val
        FROM empty e
        JOIN rr r ON ( e.xxx = r.xxx+1 AND e.yyy = r.yyy)
                OR ( e.xxx = r.xxx AND e.yyy = r.yyy+1 )
        )
INSERT INTO matrix_data(yyy,xxx,val)
SELECT DISTINCT yyy,xxx
        ,SUM(val)
FROM rr
GROUP BY yyy,xxx
        ;

SELECT * FROM matrix_data
        ; 
```

新结果：

```
NOTICE:  drop cascades to table tmp.matrix_data
DROP SCHEMA
CREATE SCHEMA
SET
CREATE TABLE
INSERT 0 15
INSERT 0 10
 yyy | xxx |          val           
-----+-----+------------------------
   1 |   1 |                      2
   1 |   2 |                      2
   1 |   3 |                      3
   1 |   4 |                      3
   1 |   5 |                      4
   2 |   1 |                      4
   2 |   2 |                      4
   2 |   3 |                      5
   2 |   4 |                      6
   3 |   1 |                      3
   3 |   2 |                      2
   3 |   3 |                      2
   4 |   1 |                      2
   4 |   2 |                      1
   5 |   1 |                      1
   2 |   5 |     5.0000000000000000
   5 |   5 | 2.81250000000000000000
   4 |   3 | 1.50000000000000000000
   3 |   5 | 4.50000000000000000000
   5 |   2 | 1.00000000000000000000
   3 |   4 | 4.00000000000000000000
   5 |   3 | 1.25000000000000000000
   4 |   5 | 3.62500000000000000000
   4 |   4 | 2.75000000000000000000
   5 |   4 | 2.00000000000000000000
(25 rows) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T18:43:37.590

这可以在单个 SQL 选择语句中完成，但这只是因为不需要递归。我将概述解决方案。如果你真的想要 SQL 代码，请告诉我。

首先，请注意，对总和有贡献的唯一项目是沿对角线。现在，如果我们遵循 (1, 5) 中值“4”的贡献，它对 (2,5) 的贡献为 4/2，对 (3,5) 的贡献为 4/4，对 (4,5) 的贡献为 4/8 ）。每次，贡献都会减半，因为 (a+b)/2 是 (a/2 + b/2)。

当我们扩展它时，我们开始看到类似于帕斯卡三角形的模式。事实上，对于下三角矩阵中的任何给定点（在您有值的位置下方），您都可以找到对值有贡献的对角线元素。向上延伸一条垂直线以击中对角线，并延长一条水平线以击中对角线。这些是对角线行的贡献者。

他们贡献了多少？好吧，为此我们可以使用帕斯卡三角形。对于我们有值的下面的第一个对角线，贡献是 (1,1)/2。对于第二条对角线，(1,2,1)/4。对于第三个， (1,3,3,1)/8 。. . 等等。

幸运的是，我们可以使用公式（组合数学中的“选择”函数）计算每个值的贡献。2的幂很简单。而且，确定给定单元格与对角线的距离并不难。

所有这些都可以组合成一个 Postgres SQL 语句。但是，@Erwin 的解决方案也有效。如果他的解决方案不能满足您的需求，我只想努力调试该语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T19:11:41.677

```
 while (select max(ColumnIndex+RowIndex) from matrix_data)<10
 begin
      insert matrix_data
      select c1.RowIndex, c1.ColumnIndex+1, (c1.MatrixValue+c2.MatrixValue)/2 
      from matrix_data c1
           inner join
           matrix_data c2 
           on c1.ColumnIndex+1=c2.ColumnIndex and c1.RowIndex-1 = c2.RowIndex   
      where c1.RowIndex+c1.ColumnIndex=(select max(RowIndex+ColumnIndex) from matrix_data) 
      and c1.ColumnIndex<5
 end 
```

# android - 三星 Galaxy Tab 7 英寸 - 布局问题

> ID：11563811
> 
> 赞同：2
> 
> 时间：2012-07-19T15:10:31.270
> 
> 标签：android, android-layout

我一直在 Galaxy Samsung Tab 7" GT-P3110 上布置一些 Android xml 屏幕，它的屏幕分辨率为 1024 x 600。它运行的是 Android 版本 4.0.3

然而，我的客户正在运行具有相同屏幕尺寸和分辨率的 Android 2.2 的 Galaxy Samsung Tab 7" SPH-P100。

当客户查看我创建的屏幕时，它们正在被截断宽度的方式。

两种设备似乎具有相同的尺寸和分辨率，我正在尝试找出为什么布局存在差异？

Galaxy 三星 Tab GT-P3110 [http://www.samsung.com/uk/consumer/mobile-devices/tablets/tablets/GT-P3110TSABTU-spec](http://www.samsung.com/uk/consumer/mobile-devices/tablets/tablets/GT-P3110TSABTU-spec)

Galaxy 三星 Tab SPH-P100 [http://www.samsung.com/us/mobile/galaxy-tab/SPH-P100ZKASPR](http://www.samsung.com/us/mobile/galaxy-tab/SPH-P100ZKASPR)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T15:59:37.467

我已经对此进行了一些研究...

在 SO 上，有一些评论，例如“设备制造商可以选择其设备的密度来实现所需的 UI——例如，三星 Tab 使用的密度比实际 DPI 大很多，从而导致整体更大的用户界面。” 从 [device-independent-pixels 的基础知识](https://stackoverflow.com/questions/4707320/basics-of-device-independent-pixels)出发，这在其他网站上有进一步的报道......

* * *

一位用户对此进行了更深入的研究 - 并发现最初的 Galaxy Tab 7 报告称 Galaxy Tab 不遵守开发者文档：

> 无论屏幕密度如何，160dp 始终为一英寸

而是将其显示报告为 hdpi 而不是 mdpi。谷歌博客上对此的解释是：

> 在这样的背景下，三星还有一个小惊喜：算一算，它的屏幕有 170 DPI，远不是 Android 设备中密度最高的。尽管如此，它仍将自己声明为“hdpi”（并且具有“大”屏幕尺寸）。原因很简单：这样看起来更好。

有关这方面的更多信息，请参阅：

*   [了解三星 Galaxy Tab 屏幕密度](https://stackoverflow.com/questions/7049659/understanding-samsung-galaxy-tab-screen-density)
*   和[http://realmike.org/blog/2010/12/21/multiple-screen-sizes-with-processing-for-android/](http://realmike.org/blog/2010/12/21/multiple-screen-sizes-with-processing-for-android/)
*   和[http://android-developers.blogspot.co.uk/2010/09/screen-geometry-fun.html](http://android-developers.blogspot.co.uk/2010/09/screen-geometry-fun.html)

* * *

考虑到这一点……唯一剩下的难题是 Galaxy Tab 2 中发生了什么……好吧，我的猜测是三星已决定在 ICS 中将 Galaxy Tab 2 改回来，以便它“正确”报告本身作为中等密度而不是高密度设备......

...这就是为什么您的 Galaxy Tab 2 显示的内容与您客户的 Galaxy Tab 1 如此不同的原因

# php - 如果对象是通过别名传递的，你什么时候会通过引用传递？

> ID：11563813
> 
> 赞同：5
> 
> 时间：2012-07-19T15:10:38.807
> 
> 标签：php

> **可能重复：**
> [在 PHP 中，有人可以解释克隆与指针引用吗？](https://stackoverflow.com/questions/3611986/in-php-can-someone-explain-cloning-vs-pointer-reference)

根据[http://php.net/manual/en/language.oop5.references.php](http://php.net/manual/en/language.oop5.references.php)

> 经常提到的 PHP 5 OOP 的关键点之一是“对象默认通过引用传递”。这并不完全正确。本节通过一些例子来纠正这种普遍的想法。
> 
> PHP 引用是一个别名，它允许两个不同的变量写入相同的值。从 PHP 5 开始，对象变量不再包含对象本身作为值。它只包含一个对象标识符，允许对象访问者找到实际对象。当一个对象通过参数发送、返回或分配给另一个变量时，不同的变量不是别名：它们持有标识符的副本，它指向同一个对象。

如果对象通过别名或处理程序传递，那么在什么情况下您实际上希望通过引用传递？

```
myFunc($obj); // Pass by alias/handler

myFunc(& $obj); // Pass by reference (when would you do this?)

myFunc(clone $obj); // Create a new object 
```

这些都有哪些不同的用例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:17:36.957

> 这些都有哪些不同的用例？

您已经命名了三个不同的用例：

1.  将对象作为参数传递
2.  传递别名作为参数
3.  将对象克隆作为参数传递

当你需要做特定的情况时，你自然会做这三件事。您通常只需要 1\. in 99.9%。当你需要时，你会做另外的 0.1%。

变量别名作为参数的示例用例（如评论中所要求的）作为一个小示例（[Demo](http://codepad.org/1Ww0N8iY)）：

```
class VarFreezer
{
    private $alias;
    private $value;
    public function __construct(&$object) {
        $this->alias = &$object;
        $this->value = $object;
    }
    public function restore()
    {
        $this->alias = $this->value;
    }
}

$var = new stdClass();
$var->value = 'I am an object now.';

$freezer = new VarFreezer($var);

$var = 'I am a string now.';

$freezer->restore();

var_dump($var); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:31:44.640

myfunc($obj) //传入标识符

当您的函数需要访问对象并以某种方式操作/读取它时。

myfunc(& $obj) //传入标识符的引用。

这里的关键是您传递对标识符的引用。这意味着如果外部变量 ($obj) 设置为 null，则内部对象也变为 null，因为您已从 $obj 中删除了标识符，因此对它的引用也已删除。与传入标识符时不同，因为您实际执行的操作是传入标识符的副本，因此如果 $obj 设置为 null 则函数内部的值仍将指向该对象。

例子：

```
var x = new Object();

var y = x //y and x both contain **different** identifiers to the same object in memory.

function a($_a){} // a function for examples

a($y) // passes in a copy of $y so $_a (inside the function) is a third identifier pointing to th in memory object

a(& $y) // now $_a contains the **same** identifier as $y so if either is emptied then the other is also emptied. 

a(clone $y) //creates a new object identical to the first and passes in an identifier of the new object. 
```

希望那足够清楚。

如果您希望能够从函数内部修改或删除标识符并使​​其影响外部标识符变量，同时能够返回独立计算的值，则可以通过引用传递标识符。例如，序列化一个对象，将其保存到文件中，返回文件字符串，但也清除标识符，以便可以从内存中清除对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T15:24:47.947

当您将对象提供给方法时，会传递对现有对象的引用，以便在调用范围内的变量和方法范围内的方法参数变量都引用同一个对象。

您可以显式地使用 & 来引用数组之类的基元，以便调用的方法可以更改原始数组的数据。正如您所提到的，对于对象，这是当今的默认设置。

克隆似乎很明显。

使用 &$obj 您可以创建 $obj 的别名，而不是对 $obj 所引用的对象的引用。引用php.net：

```
$c = new A;
$d = &$c;
$c->foo = 2;
$c = NULL;
echo $d->foo."\n"; // Notice:  Trying to get property of non-object... 
```

# javascript - PhoneGap/Cordova TabBar 插件和选中页面

> ID：11563815
> 
> 赞同：0
> 
> 时间：2012-07-19T15:10:41.893
> 
> 标签：javascript, cordova, uitabbar

我已经为类似 ios 的菜单安装了插件 TabBar，并且有将所选页面放在应用程序开头的方法。

```
plugins.tabBar.selectItem("home"); 
```

问题是当我更改选项卡时，它总是选择“主页”，所以我在 javascript 中非常初学者，我尝试使用这段代码来解决它：

```
if(document.location.href == "index.html"){
     plugins.tabBar.selectItem("home");} 
```

但它不起作用。

有人知道解决方案吗？谢谢人们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T07:43:55.793

我找到了这个，

```
/**
 * Function to detect currently selected tab bar item
 * @see createItem
 * @see showItems
 */
TabBar.prototype.getSelectedItem = function() {
return this.selectedItem;
}; 
```

# python - 如何在 gcc 搜索路径中包含文件？

> ID：11563816
> 
> 赞同：0
> 
> 时间：2012-07-19T15:10:45.250
> 
> 标签：python, ubuntu

我在 ubuntu 上安装 pylibrabbitmq。但`amqp.h`不在搜索路径中。它在

' `/tmp/src/rabbit/rabbitmq-c/librabbitmq`'。

如何将此位置添加到 gcc 搜索路径？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-19T16:12:38.167

跑

```
sudo gcc whatever.c -I/dir/* 
```

其中 ampq.h 应该在文件夹中 *

# java - 从 JTextField 中检索文本

> ID：11563822
> 
> 赞同：1
> 
> 时间：2012-07-19T15:11:02.680
> 
> 标签：java, swing

我的代码的概念是，它最初会从我的访问数据库表“try”的列“tname”中检索不同的名称。它将在组合框中添加这些项目。一旦我们在组合框中选择了一个项目，包含 tname 作为所选项目的行的数据就会被检索并显示在文本字段中。然后我将对文本字段内容进行一些更改。之后，如果我单击“保存”按钮，则必须使用文本字段中的新内容更新包含 tname 作为所选组合框项的行的所有数据。

一切都很好，除了最后一个。当我单击“保存”时，它只考虑前一个文本（当我们选择组合框时从数据库中检索到的文本）而不是对其所做的更改。请帮助我诊断问题。

提前致谢。

```
import java.awt.*;
import java.awt.event.*;
import java.util.*;
import javax.swing.*;
import javax.swing.table.*;
import java.util.Date;
import java.sql.*;
import java.text.*;

public class gut implements ActionListener
{
JComboBox ctn;
JTextField cm,exd,stk,cst,sup,snum,r;
String stn,scm,sexd,sst,scst,ssup,ssnum,sr,icm,iexd,istk,icst,isup,isnum,ir;
JLabel lt,lc,le,ls,lcs,lsp,lspn,lr;
JButton s;
JFrame gp=new JFrame();

public gut()
{
gp.setSize(500,500);
gp.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

gp.setLayout(null);

lt=new JLabel("Tablet Name",JLabel.RIGHT);
lc=new JLabel("Composition",JLabel.RIGHT);
le=new JLabel("Expiry Date (dd/mm/yyyy)",JLabel.RIGHT);
ls=new JLabel("Stock",JLabel.RIGHT);
lcs=new JLabel("Cost",JLabel.RIGHT);
lsp=new JLabel("Supplier",JLabel.RIGHT);
lspn=new JLabel("Supplier Number",JLabel.RIGHT);
lr=new JLabel("Rack",JLabel.RIGHT);

lt.setBounds(100,120,120,20);
lc.setBounds(100,140,120,20);
le.setBounds(60,160,160,20);
ls.setBounds(100,180,120,20);
lcs.setBounds(100,200,120,20);
lsp.setBounds(100,220,120,20);
lspn.setBounds(100,240,120,20);
lr.setBounds(100,260,120,20);

ctn=new JComboBox();
cm=new JTextField();
exd=new JTextField();
stk=new JTextField();
cst=new JTextField();
sup=new JTextField();
snum=new JTextField();
r=new JTextField();

ctn.setBounds(240,120,120,20);
cm.setBounds(240,140,120,20);
exd.setBounds(240,160,120,20);
stk.setBounds(240,180,120,20);
cst.setBounds(240,200,120,20);
sup.setBounds(240,220,120,20);
snum.setBounds(240,240,120,20);
r.setBounds(240,260,120,20);

try
{
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
Connection conn=DriverManager.getConnection("jdbc:odbc:vasantham","","");
Statement st=conn.createStatement();
ResultSet rs=st.executeQuery("select DISTINCT tname from try");

while(rs.next())
{
 ctn.addItem(rs.getString("tname"));
}

conn.close();
}
catch(Exception e)
{
}

gp.add(lt);gp.add(ctn);
gp.add(lc);gp.add(cm);
gp.add(le);gp.add(exd);
gp.add(ls);gp.add(stk);
gp.add(lcs);gp.add(cst);
gp.add(lsp);gp.add(sup);
gp.add(lspn);gp.add(snum);
gp.add(lr);gp.add(r);

ctn.addActionListener(this);
s=new JButton("Save");
s.setBounds(200,300,100,20);
gp.add(s);
s.addActionListener(this);

gp.setVisible(true);
}
public void actionPerformed(ActionEvent evt)
{
String act=evt.getActionCommand();

String scb=(String)ctn.getSelectedItem();
try
{
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
Connection conn=DriverManager.getConnection("jdbc:odbc:vasantham","","");
Statement st=conn.createStatement();
ResultSet rs=st.executeQuery("select * from try where tname='"+scb+"'");
SimpleDateFormat formatter=new SimpleDateFormat("dd/MM/yyyy");

while(rs.next())
{
icm=rs.getString("composition");
iexd=formatter.format(rs.getDate("exdate"));
istk=Integer.toString(rs.getInt("stock"));
icst=rs.getString("cost");
isup=rs.getString("sup");
isnum=rs.getString("supnum");
ir=rs.getString("rack");
}

cm.setText(icm);
exd.setText(iexd);
stk.setText(istk);
cst.setText(icst);
sup.setText(isup);
snum.setText(isnum);
r.setText(ir);

conn.close();
}
catch(Exception e)
{
System.out.println(e);
}

if(act.equals("Save"))
{
scm=cm.getText();
sexd=exd.getText();
sst=stk.getText();
scst=cst.getText();
ssup=sup.getText();
ssnum=snum.getText();
sr=r.getText();
System.out.println(scm+","+sexd+","+sst+","+scst+","+ssup+","+ssnum+","+sr);
try
{

Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
Connection conn=DriverManager.getConnection("jdbc:odbc:vasantham","","");
PreparedStatement ps=conn.prepareStatement("UPDATE try set composition=?,exdate=?,stock=?,cost=?,sup=?,supnum=?,rack=? where 

tname=?");

ps.setString(1,scm);
ps.setString(2,sexd);
ps.setString(3,sst);
ps.setString(4,scst);
ps.setString(5,ssup);
ps.setString(6,ssnum);
ps.setString(7,sr);
ps.setString(8,scb);

ps.executeUpdate();

JOptionPane.showMessageDialog(null,"Your entry has been stored successfully!!!");

}
catch(Exception e)
{
JOptionPane.showMessageDialog(null,"Error!Try again!");
System.out.println(e);

}
}
}
public static void main(String[] args)
{
new gut();
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:27:26.210

每次触发动作事件时，您都会从数据库中读取数据并将其写入文本字段。您可以更改该文本，它将正确显示在您的文本字段中。但是当您单击保存时，您的所有更改都会再次被数据库值覆盖。

因此，您必须将“从数据库读取”和“写入更改”功能分开。

编辑：哎呀，太慢了..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:26:27.437

您的 actionPerformed() 函数每次都从数据库中检索信息。如果您按下保存按钮，它将首先检索信息，然后如果操作命令为“保存”，则保存信息。这就是为什么您在按下 Save 按钮时总是从 getText() 获取当前数据库中的信息的原因。

当按下 Save 按钮时执行不同的函数/actionListener 或获取更新文本字段的部分代码。

尝试这样的事情：

```
JButton saveButton = new JButton( new AbstractAction("save") {
        @Override
        public void actionPerformed( ActionEvent e ) {
            // Save the info here or just call a function that will.
        }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:26:33.327

问题是，每次您点击“保存”按钮时，您都会再次从数据库中检索信息，因此，您会覆盖 TextFields，然后从 TexFields 内容中读取。尝试取出这部分：

```
 try {
            Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
            Connection conn = DriverManager.getConnection

            ("jdbc:odbc:vasantham", "", "");
            Statement st = conn.createStatement();
            ResultSet rs = st.executeQuery("select * from try where tname='"
                    + scb + "'");
            SimpleDateFormat formatter = new SimpleDateFormat("dd/MM/yyyy");

            while (rs.next()) {
                icm = rs.getString("composition");
                iexd = formatter.format(rs.getDate("exdate"));
                istk = Integer.toString(rs.getInt("stock"));
                icst = rs.getString("cost");
                isup = rs.getString("sup");
                isnum = rs.getString("supnum");
                ir = rs.getString("rack");
            }

            cm.setText(icm);
            exd.setText(iexd);
            stk.setText(istk);
            cst.setText(icst);
            sup.setText(isup);
            snum.setText(isnum);
            r.setText(ir);

            conn.close();
        } catch (Exception e) {
            System.out.println(e);
        } 
```

从执行的操作方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T20:00:04.313

除了其他人已经说过的内容之外，如果您真的想使用单个动作侦听器，您将需要确定实际发生的动作。

您可以检查 ActionEvent ( `evt.getSource()`) 的来源，或者更恰当地说，您可以使用动作侦听器为每个组件分配一个动作命令。

查看[JComboBox.setActionCommand(...)](http://docs.oracle.com/javase/6/docs/api/javax/swing/JComboBox.html#setActionCommand%28java.lang.String%29)和[JButton.setActionCommand(...)](http://docs.oracle.com/javase/6/docs/api/javax/swing/AbstractButton.html#setActionCommand%28java.lang.String%29)

之后，这是一个检查[ActionEvent.getActionCommand()](http://docs.oracle.com/javase/6/docs/api/java/awt/event/ActionEvent.html#getActionCommand%28%29)属性以确定要采取的正确操作的简单案例。

# vba - 在单独的工作簿中返回特定值的单元格位置

> ID：11563825
> 
> 赞同：2
> 
> 时间：2012-07-19T15:11:07.650
> 
> 标签：vba, excel

澄清。我有 1 个要在其中创建 VBA 的电子表格。宏运行时，我希望代码在单独的 WorkBook 工作表中找到特定值并返回该值在另一个 WorkBook 中的位置。

我最初的想法是使用 HLookUp，但是它只会返回值，而不是值的位置。我的下一个想法是使用 Find 功能，但我无法让它运行。我得到的错误是：运行时错误“438”：对象不支持此属性或方法

```
startValue = enrollBook.Sheets("Pop-FY").Range("D:Z"). _
Applications.WorksheetFunction. _
Find(What:=FYString, LookIn:=xlValues) 
```

登记簿是另一个工作簿。startValue 应该是在另一个电子表格中找到的值的位置

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:16:36.777

这是一种奇怪的调用函数和格式化的方式，我首先什至认为代码是无效的。

首先，您`Range.Find`对`Application.WorksheetFunction.Find`. 您需要`Range`一个，但正在呼叫另一个。
其次，错误是因为它是`Application`，不是`Applications`。
第三，你需要一个`Set`：

```
Set startValue = enrollBook.Sheets("Pop-FY").Range("D:Z").Find(What:=FYString, LookIn:=xlValues) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:20:50.877

你的意思是这样的？

```
Dim sTest           As String
Dim oRange          As Range

Set oRange = Worksheets(1).Range("A1:Z10000").Find("Test", lookat:=xlPart)
MsgBox oRange.Address 
```

我对此进行了测试，但是您需要更改参数。

# mysql - INT(1) 在 MySQL 中代表什么？

> ID：11563830
> 
> 赞同：16
> 
> 时间：2012-07-19T15:11:25.060
> 
> 标签：mysql

`INT(1)`- 我知道，1 不代表 1 位，它只代表客户端输出的显示格式。

但这意味着什么

我已经声明`YEAR`为`int(1)`，我仍然看到所有 4 个字节。请告诉我是什么`INT(1)`意思？

```
SELECT * FROM TEST_USERDB; 
```

```
+----+--------+------+
| ID | NAME   | YEAR |
+----+--------+------+
|  1 | abcccc | 2012 |
|  2 | stack  |   99 |
+----+--------+------+ 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-19T15:18:33.143

> An`unsigned int`的最大值为`4294967295`无论其 `INT(1)`or`int(10)`并且将使用 4 个字节的数据。
> 
> 那么，括号中的数字是什么意思呢？它几乎可以归结为显示，称为显示宽度。显示宽度是一个从 1 到 255 的数字。如果您希望所有整数值都“出现”，您可以设置显示宽度。如果您在行上启用 zerofill，则该字段将具有默认值 0 for`int(1)`和`0000000000`for `int(10)`。

[阅读更多](http://www.bajb.net/2008/10/mysql-int1-or-int10/)

# javascript - 客户端包括在本地机器上

> ID：11563833
> 
> 赞同：0
> 
> 时间：2012-07-19T15:11:32.197
> 
> 标签：javascript, html

我显然不能使用服务器端语言，这只是我桌面上的一个页面。

我尝试将 AJAX 与 jquery 一起使用，但收到以下错误消息

> 抱歉，出现错误：0 [异常...“访问受限 URI 被拒绝”代码：“1012”nsresult：“0x805303f4 (NS_ERROR_DOM_BAD_URI)”位置：“https://ajax.googleapis.com/ajax/libs/ jquery/1.7.2/jquery.min.js 行：4"]

它与浏览器不加载脚本有关，因为它是在本地托管的或其他东西。那么有什么方法可以在不安装 Web 服务器软件的情况下在本地机器上包含文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:18:17.567

这是一个[XSS](http://en.wikipedia.org/wiki/Cross-site_scripting)错误。您不能向第三方网站（不在您的域中的网址）发出 http 请求。您需要使用代理向页面发出请求（或让所有者允许您的站点发出 XSS 请求）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-13T16:54:00.017

我写的一个库的无耻插件解决了类似的问题。我们希望能够为后端实现拼接 HTML 文件，而不需要本地 HTTP 服务器实现服务器端包含的开销。该库适用于 HTTP 或本地文件系统。但是，正如存储库自述文件所述，您必须为`--allow-file-access-from-files`Chrome 运行时启用一个标志。其他浏览器开箱即用。

[https://github.com/LexmarkWeb/csi.js](https://github.com/LexmarkWeb/csi.js)

```
<div data-include="/path/to/include.html"></div> 
```

上面将获取的内容`/path/to/include.html`并`div`用它替换。

# objective-c - Cocoa中的WebView不呈现

> ID：11563838
> 
> 赞同：0
> 
> 时间：2012-07-19T15:11:38.373
> 
> 标签：objective-c, macos, cocoa

在我的窗口控制器中，我有这个：

```
- (void)windowDidLoad {
    [super windowDidLoad];
    NSLog(@"webView = %@", webView);
    [[webView mainFrame] loadRequest:
         [NSURLRequest requestWithURL:
             [NSURL URLWithString:@"http://www.apple.com/"]]];
} 
```

我的理解是应该让我窗口中的 webView 现在下载并呈现 Apple 的主页。但我在白色面板中看到的所有内容。我错过了什么？

（我检查过 webView 不为空；NSLog 显示类似“webView = <WebView: 0x10be7c3b0>”）

我也尝试了更现代的方法，但仍然没有成功：

```
[webView setMainFrameURL:@"http://www.apple.com/"]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T12:57:25.290

由于此项目是沙盒化的，因此在这种情况下，解决方案是将相关权利添加到项目中。

# iphone - 如何在使用 MPMoviePlayerController 时让视频播放器不自动播放

> ID：11563840
> 
> 赞同：1
> 
> 时间：2012-07-19T15:11:41.900
> 
> 标签：iphone, video, mpmovieplayercontroller, xcode4.3

我正在尝试将视频编码到我的 iPhone 应用程序中，下面的代码运行良好，但唯一的问题是，我宁愿视频不会在用户打开页面时自动开始播放。我希望他们能够按下播放按钮。下面的代码位于我的 viewcontroller.m 文件中。

```
(void)viewDidLoad
{
NSString *url = [[NSBundle mainBundle] pathForResource:@"77860_00_01_MM02_welcome" 
ofType:@"mov"];
player = [[MPMoviePlayerController alloc]
initWithContentURL:[NSURL fileURLWithPath:url]];
[[NSNotificationCenter defaultCenter]
 addObserver:self selector:@selector(movieFinishedCallback:) name:MPMoviePlayerPlaybackDidFinishNotification object:player];

player.view.frame = CGRectMake(10, 235, 150, 125);
[self.view addSubview:player.view];

[player play];
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}

- (void) movieFinishedCallback:(NSNotification*) aNotification {
MPMoviePlayerController *moviePlayer = [aNotification object];
[[NSNotificationCenter defaultCenter]
 removeObserver:self
 name:MPMoviePlayerPlaybackDidFinishNotification object:moviePlayer];
[moviePlayer.view removeFromSuperview];
[player play];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:49:50.740

没关系，我想通了。我刚刚`[player prepareToPlay]`在下面添加`player.shouldAutoplay = NO`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T11:47:53.903

不要把它放在你的 viewDidLoad 中。只需创建一个 IBAction 他们将其链接到您的触发按钮。

# node.js - Node.js 标准输出编码问题

> ID：11563842
> 
> 赞同：1
> 
> 时间：2012-07-19T15:11:53.487
> 
> 标签：node.js, encoding, yui, stdout

我制作了一个快速的 ajax 驱动页面，用于粘贴一些文本并运行 yuicompressor。`<`输出效果很好，但是，当我将标准输出发送回我的页面时，我遇到了数据在字符处截断的问题。例如，当我对此运行压缩器时：

```
function Enum(values){
    for( var i = 0; i < values.length; ++i ){
        this[values[i]] = i;
    }
    return this;
} 
```

我得到一个压缩版本，没问题。现在，当我像这样将其发送到我的页面时：

```
exec(command, function(err, stdout, stderr) {
    console.log(stdout);
    res.writeHead(200, {'content-type': 'text/plain'});
    //res.write(decodeURIComponent(escape(stdout)));
    //res.write(qs.escape(stdout));
    res.write(stdout);
    res.end('\n');    
}); 
```

这总是会导致发送的数据被切断，`<`结果是：

```
function Enum(a){for(var b=0;b 
```

显示`console.log(stdout)`完美，所以直到它被发送到客户端才被切断。

当我尝试编码时，我能够将整个输出到我的页面全部转义，但是在前端对其进行解码会导致同样的问题将其切断。

这是ajax调用：

```
if(ready) {
    $.ajax('/get' + args + '/', {
        type: 'GET',
        dataType: 'text',
        success: function(data) { $('pre').html(data) },
        error: function() { console.log('error retrieving data') }    
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:25:44.253

看起来你的困难在于你告诉 jQuery 使用一段 JavaScript 作为 HTML，并且它在第一个 HTML 元字符处“切断”，`<`. 标签的内容`pre`仍然是 HTML，只是空格的处理方式不同。打电话`$('pre').text(data)`，你应该没事。

# java - 番石榴缓存api中的RemovalListener回调是否确保没有人使用该对象

> ID：11563848
> 
> 赞同：6
> 
> 时间：2012-07-19T15:12:05.903
> 
> 标签：java, caching, guava

[我在wiki 页面](http://code.google.com/p/guava-libraries/wiki/CachesExplained)中阅读了有关缓存的代码示例/文档。我看到回调`RemovalListener`可用于拆除被驱逐的缓存对象等。我的问题是在调用提供的`RemovalListener`. 让我们考虑文档中的代码示例：

```
CacheLoader<Key, DatabaseConnection> loader = 
                                 new CacheLoader<Key, DatabaseConnection> () {
  public DatabaseConnection load(Key key) throws Exception {
    return openConnection(key);
  }
};
RemovalListener<Key, DatabaseConnection> removalListener =
                          new RemovalListener<Key, DatabaseConnection>() {
  public void onRemoval(RemovalNotification<Key, DatabaseConnection> removal) {
    DatabaseConnection conn = removal.getValue();
    conn.close(); // tear down properly
  }
};

return CacheBuilder.newBuilder()
  .expireAfterWrite(2, TimeUnit.MINUTES)
  .removalListener(removalListener)
  .build(loader); 
```

这里的缓存被配置为在创建后 2 分钟驱逐元素（我知道它可能不是精确的两分钟，因为驱逐将与用户读/写调用等一起被捎带。）但无论是什么时候，图书馆都会检查那里传递给的对象是否没有活动引用`RemovalListener`？因为我可能有另一个线程很早就从缓存中获取了对象，但可能仍在使用它。在那种情况下，我不能`close()`从 RemovalListener 调用它。

的文档`RemovalNotification`还说：***删除单个条目的通知。如果它们已经被垃圾回收，则键和/或值可能为空。*** 所以根据它`conn`可能是`null`在上面的例子中。在这种情况下，我们如何正确地拆除 conn 对象？在这种情况下，上面的代码示例也会抛出`NullPointerException`.

我试图解决的用例是：

1.  缓存元素需要在创建两分钟后过期。
2.  被驱逐的对象需要是`closed`，但只有在确保没有人使用它们之后。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T15:24:56.983

番石榴贡献者在这里。

> 我的问题是，在调用提供的 RemovalListener 之前，库是否确保该对象没有被任何其他线程使用。

不，这对番石榴来说是不可能的——而且无论如何都是个坏主意！如果缓存值为`Integer`s，那么因为`Integer.valueOf`重用`Integer`了小于 128 的整数的对象，所以您永远不会使值低于 128 的条目过期。那将是*bad*。

> RemovalNotification 的文档还说：删除单个条目的通知。如果它们已经被垃圾回收，则键和/或值可能为空。所以根据它 conn 在上面的例子中可能是空的。

需要明确的是，这只有在您使用`weakKeys`、`weakValues`或时才有可能`softValues`。（而且，正如您正确推断的那样，如果您需要对值进行一些拆解，则不能真正使用其中任何一个。）如果您只使用其他形式的到期，您将永远不会得到 null键或值。

一般来说，我认为基于 GC 的解决方案不会在这里工作。您*必须*对连接有一个强引用才能正确关闭它。（覆盖`finalize()`可能在这里起作用，但这通常是一件坏事。）

相反，我的方法是缓存对某种包装器的引用。就像是

```
 class ConnectionWrapper {
   private Connection connection;
   private int users = 0;
   private boolean expiredFromCache = false;
   public Connection acquire() { users++; return connection; }
   public void release() {
     users--;
     if (users == 0 && expiredFromCache) {
       // The cache expired this connection.
       // We're the only ones still holding on to it.
     }
   }
   synchronized void tearDown() {
     connection.tearDown();
     connection = null; // disable myself
   }

 } 
```

然后使用 a`Cache<Key, ConnectionWrapper>`和 a`RemovalListener`看起来像...

```
 new RemovalListener<Key, ConnectionWrapper>() {
   public void onRemoval(RemovalNotification<Key, ConnectionWrapper> notification) {
     ConnectionWrapper wrapper = notification.getValue();
     if (wrapper.users == 0) {
       // do the teardown ourselves; nobody's using it
       wrapper.tearDown();
     } else {
       // it's still in use; mark it as expired from the cache
       wrapper.expiredFromCache = true;
     }
  }
} 
```

`acquire()`...然后强制用户正确使用`release()`。

我认为真的没有比这种方法更好的方法了。检测到没有其他对连接的引用的唯一方法是使用 GC 和弱引用，但是如果没有对它的强引用，就不能拆除连接——这会破坏整个观点。您无法保证`RemovalListener`需要断开连接的是连接用户还是连接用户，因为如果用户花费超过两分钟的时间来完成它的操作怎么办？我认为这可能是唯一可行的方法了。

（警告：上面的代码假设一次只有一个线程在做事；它根本不同步，但希望如果你需要它，那么这足以让你了解它应该如何工作。）

# css - 将背景图像定位在 div 中以从某个点开始

> ID：11563849
> 
> 赞同：0
> 
> 时间：2012-07-19T15:12:08.857
> 
> 标签：css, background-image, background-position

我正在尝试将背景图像添加到将扩展页面高度的 div 中。我的问题是这个 div 的顶部是一个透明背景的徽标。我不希望 div 的背景图像出现在徽标图像下方。

有没有办法告诉背景图像直到某个像素点才开始出现？因此，如果徽标的高度为 200 像素，我是否可以让 bg 图像在 div 内向下 210 像素时才开始出现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:26:41.050

只需添加`top:210px`到该 div 的 css 即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:44:13.453

你可以使用`background-clip: content-box;`-[**演示**](http://dabblet.com/gist/3144906)

更好的是，您可以设置`background-clip: padding-box`和设置一个大的透明顶部边框而不是一个大的透明顶部填充，以确保它在 Opera 中也能正常工作 -[**演示**](http://dabblet.com/gist/3144965)。

# pdf - 从 C/C++ 中的 True 类型字体文件中以编程方式提取 Unicode 字符值

> ID：11563856
> 
> 赞同：1
> 
> 时间：2012-07-19T15:12:18.150
> 
> 标签：pdf, utf-8, truetype

我正在尝试从 PDF 中包含的嵌入式真字体文件中提取 UTF-8 字符值。有人知道这样做的方法吗？PDF 中的值可能类似于 '2%dd! w!|<~' 这将在由 TTF 中的相应字形表示的 PDF 中以“Hello World”结尾。我希望能够在这里提取 wchar 值。这可能吗？TTF 中是否存在每个字符的 UTF-8 值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T10:29:05.083

字形 ID 并不总是对应于 Unicode 字符值 - 特别是对于使用大量连字和变体字形形式的非拉丁脚本，其中字形和字符之间没有一对一的对应关系。

只有标记的 PDF 文件存储 Unicode 文本 - 否则您可能必须从字体中的字形名称重构字符。如果使用的字体具有根据 Adob​​e 的字形命名约定或[Adob​​e 字形列表规范](http://sourceforge.net/adobe/aglfn/wiki/AGL%20Specification/)命名的字形，则这是可能的- 但许多字体，包括标准 Windows 字体，不遵循此命名约定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T07:58:56.513

UTF-8 是一种编码，它允许对 UTF8 编码的流进行解码以显示一系列 unicode 字符点。在任何情况下，PDF 都不使用 UTF-8 进行编码。对于真类型文本，每个字形使用 8 位编码。

解码：

1.  从字体定义中读取差异数组和编码
2.  一次读取 8 位，并使用在步骤 1 中读取的编码和差异数组生成“AdobeGlyphId”。
3.  使用 adobe 字形 id 查找 unicode 值

这在 PDF 规范的第 9.10 节中有详细说明

# java - IntelliJ 插件 - 需要挂钩到现有操作

> ID：11563857
> 
> 赞同：4
> 
> 时间：2012-07-19T15:12:21.680
> 
> 标签：java, intellij-idea, intellij-plugin

我正在为 IntelliJ 编写一个插件，并且需要挂钩一些已经存在的现有操作，例如保存文件、编译代码或发生重构时。我无法在插件站点上找到有关现有操作的任何信息，只能找到新操作。

这些帖子是相似的： [在 IntelliJ IDEA 中保存操作 Intellij](https://stackoverflow.com/questions/3707316/save-actions-in-intellij-idea) [在文件保存时重新格式化](https://stackoverflow.com/questions/946993/intellij-reformat-on-file-save)

但由于它们不包括实际编写插件，我希望这样做可能有一些内部钩子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-22T12:36:33.207

这是如何通过自定义插件拦截“保存时”事件的代码[示例。](http://arhipov.blogspot.com/2011/04/code-snippet-intercepting-on-save.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T15:37:09.343

[您可以通过在FILE_DOCUMENT_SYNC](https://github.com/JetBrains/intellij-community/blob/master/platform/platform-api/src/com/intellij/openapi/fileEditor/FileDocumentManagerListener.java)主题中注册的[FileDocumentManagerListener](https://github.com/JetBrains/intellij-community/blob/master/platform/platform-api/src/com/intellij/AppTopics.java)连接到“刷新文件系统更改”处理。

[您可以在此处](http://confluence.jetbrains.com/display/IDEADEV/IntelliJ+IDEA+Messaging+infrastructure)获取有关 IJ 消息传递的更多信息。

# asp.net-mvc - 在 mvc3 asp.net 应用程序中对用户配置文件列表进行排序

> ID：11563862
> 
> 赞同：0
> 
> 时间：2012-07-19T15:12:30.990
> 
> 标签：asp.net-mvc, asp.net-mvc-3, sorting

我在对传递给视图的用户配置文件列表进行排序时遇到问题。我想显示某个角色的所有用户的列表，并且我想按 familyName 属性对它们进行排序。

我尝试使用 OrderBy 但它没有效果。

控制器中的代码

```
public ActionResult Index()
    {
        //get all patients
        var patients = Roles.GetUsersInRole("user").ToList();
        //set up list of patient profiles
        List<UserProfile> pprofiles = new List<UserProfile>();
        foreach (var i in patients) {
            pprofiles.Add(ZodiacPRO.Models.UserProfile.GetUserProfile(i));
        }
        pprofiles.OrderBy(x => x.familyName);   //<-this has no effect the list produced is
                                                // exactly the same it was without this line
        return View(pprofiles);
    } 
```

和视图

```
 <ul id= "patientList">

        @foreach (var m in Model)
            {
                <li>
                <ul class="patient">
                 <li class="ptitle">@m.title</li>
                 <li class="pname"> @Html.ActionLink(@m.givenName + " " + @m.familyName, "View", "Account", new { @username = @m.UserName.ToString() }, new { id = "try" })</li>
                 <li class="pprofile">@Ajax.ActionLink("Profile", "PatientSummary", new { @username = @m.UserName }, new AjaxOptions { UpdateTargetId = "pContent"},new{ @class = "profpic" })</li>
                </ul>
                </li>         
            }
    </ul> 
```

我需要在多个地方重复使用它，并且可能有大量用户，所以不以某种方式订购它们会很糟糕。我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:18:53.437

OrderBy 不修改`pprofiles`元素的顺序，而是返回一个新的集合，其中的元素是有序的。你可以试试这个：

```
pprofiles = pprofiles.OrderBy(x => x.familyName); 
```

或者你可以使用[List(T).Sort](http://msdn.microsoft.com/en-us/library/w56d4y5z.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:19:56.757

`pprofiles.OrderBy(x => x.familyName);`将返回一个`IEnumerable<T>`，而不是对调用它的数组进行排序。

您可以像这样更改代码：

```
public ActionResult Index()
{
    //get all patients
    var patients = Roles.GetUsersInRole("user").ToList();
    //set up list of patient profiles

    List<UserProfile> pprofiles = new List<UserProfile>();
    foreach (var i in patients) {
        pprofiles.Add(ZodiacPRO.Models.UserProfile.GetUserProfile(i));
    }       
    var ordered = pprofiles .OrderBy(x => x.familyName);   

    return View(ordered );
} 
```

或者以更 Linq 风格的方式：

```
var orderedPatients = Roles.GetUsersInRole("user")
                           .Select(u=>ZodiacPRO.Models.UserProfile.GetUserProfile(u))
                           .OrderBy(u=>u.FamilyName);

return View(orderedPatients); 
```

或者 ：

```
var orderedPatients = from u in Roles.GetUsersInRole("user")
                      let userProfile = ZodiacPRO.Models.UserProfile.GetUserProfile(u)
                      order by userProfile.FamilyName
                      select userProfile;
return View(orderedPatients); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:19:15.853

您需要将其分配回您的变量，`OrderBy`返回排序集合：

```
pprofiles = pprofiles.OrderBy(x => x.familyName); 
```

# printing - Logger 在 Plone 的 RestrictedPython 脚本中工作

> ID：11563865
> 
> 赞同：2
> 
> 时间：2012-07-19T15:12:48.490
> 
> 标签：printing, plone, zope

如何在 .cpy 文件（python）中打印？我正在使用 Zope/Plone，我刚刚开始使用 Python。我试过这个

```
import logging

logger = logging.getLogger()
logger.info("hello plone") 
```

但它不起作用。

谢谢您的回答

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:44:56.747

“它不起作用”非常含糊，但您的问题可能是违反了强加于 Python 的安全沙箱，这些脚本用于可通过网络进行编辑的脚本。“受限制的 Python” 将您的导入限制为已经过审计的模块，以确保它们没有令人讨厌的副作用——比如将噪音倾倒到日志中。有关受限 Python 的详细信息，请参阅[http://wiki.zope.org/zope2/PythonScripts](http://wiki.zope.org/zope2/PythonScripts)。

此类问题的一般解决方案是在 Python 包中的不受限制的 Python 中构建您的功能。Zope 命名实用程序是提供此类功能的常用机制，您可以通过遍历命名实用程序从受限 Python 访问实用程序的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T19:57:11.457

上面的答案意味着您不能在 RestrictedPython 脚本中导入任何模块，这些脚本是可通过网络编辑的 Plone 脚本。这些脚本具有最终用户权限，因此不允许它们运行任意 Python 代码。

[http://collective-docs.readthedocs.org/en/latest/security/sandboxing.html](http://collective-docs.readthedocs.org/en/latest/security/sandboxing.html)

您可以`context.plone_log("mystring")`在受限制的 python 脚本中使用样式日志记录来进行日志记录。

# sql - 在单个 SQL 查询中更新具有不同值的多行

> ID：11563869
> 
> 赞同：36
> 
> 时间：2012-07-19T15:12:58.683
> 
> 标签：sql, sqlite, rows

我有一个带有表`myTable`和列的 SQLite 数据库`id`, `posX`, `posY`. 行数不断变化（可能增加或减少）。如果我知道`id`每行的值和行数，我可以执行单个 SQL 查询来根据 id 更新具有不同值的所有`posX`和字段吗？`posY`

例如：

```
---------------------
myTable:

id   posX    posY

1      35     565
3      89     224
6      11     456
14     87     475
--------------------- 
```

SQL查询伪代码：

```
UPDATE myTable SET posX[id] = @arrayX[id], posY[id] = @arrayY[id] " 
```

`@arrayX`and`@arrayY`是存储`posX`and`posY`字段的新值的数组。

例如，如果`arrayX`并且`arrayY`包含以下值：

```
arrayX = { 20, 30, 40, 50 }
arrayY = { 100, 200, 300, 400 } 
```

...那么查询后的数据库应如下所示：

```
---------------------
myTable:

id   posX    posY

1      20     100
3      30     200
6      40     300
14     50     400
--------------------- 
```

这可能吗？我现在正在为每个查询更新一行，但随着行数的增加，它将需要数百个查询。顺便说一句，我正在 AIR 中完成所有这些工作。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-07-19T15:47:36.650

有几种方法可以有效地完成此*任务*。

首先 -
如果可能，您可以对临时表进行某种批量插入。这在一定程度上取决于您的 RDBMS/宿主语言，但在最坏的情况下，这可以通过简单的动态 SQL（使用`VALUES()`子句），然后使用标准的 update-from-another-table 来完成。大多数系统提供用于批量加载的实用程序，尽管

第二 -
这在某种程度上也依赖于 RDBMS，您可以构建动态更新语句。在这种情况下，`VALUES(...)`CTE 中的子句是动态创建的：

```
WITH Tmp(id, px, py) AS (VALUES(id1, newsPosX1, newPosY1), 
                               (id2, newsPosX2, newPosY2),
                               ......................... ,
                               (idN, newsPosXN, newPosYN))

UPDATE TableToUpdate SET posX = (SELECT px
                                 FROM Tmp
                                 WHERE TableToUpdate.id = Tmp.id),
                         posY = (SELECT py
                                 FROM Tmp
                                 WHERE TableToUpdate.id = Tmp.id)

WHERE id IN (SELECT id
             FROM Tmp) 
```

（根据文档，这*应该*是有效的 SQLite 语法，但我无法让它在小提琴中工作）

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-07-19T15:33:09.613

# 一种方式：SET x=CASE..END（任何 SQL）

是的，你可以这样做，但我怀疑它会提高性能，除非你的查询有很大的延迟。

如果查询是根据搜索值索引的（例如，如果`id`是主键），那么定位所需的元组非常非常快，并且在第一次查询之后，表将保存在内存中。

因此，在这种情况下，多个 UPDATE 并不是那么糟糕。

另一方面，如果条件需要全表扫描，更糟糕的是，表的内存影响很大，那么使用单个复杂查询会更好，即使评估 UPDATE 比简单 UPDATE 更昂贵（这得到内部优化）。

在后一种情况下，您可以这样做：

```
 UPDATE table SET posX=CASE
      WHEN id=id[1] THEN posX[1]
      WHEN id=id[2] THEN posX[2]
      ...
      ELSE posX END [, posY = CASE ... END]
 WHERE id IN (id[1], id[2], id[3]...); 
```

总成本或多或少由以下公式给出：NUM_QUERIES * (COST_QUERY_SETUP + COST_QUERY_PERFORMANCE)。这样，您可以减少 NUM_QUERIES（从 N 个单独的 id 到 1），但 COST_QUERY_PERFORMANCE 上升（在 MySQL 5.28 中约为 3 倍；尚未在 MySQL 8 中测试）。

否则，我会尝试对 id 进行索引，或者修改架构。

这是一个 PHP 示例，我想我们有一个条件已经需要全表扫描，我可以将其用作键：

```
// Multiple update rules 
$updates = [
   "fldA='01' AND fldB='X'" => [ 'fldC' => 12, 'fldD' => 15 ],
   "fldA='02' AND fldB='X'" => [ 'fldC' => 60, 'fldD' => 15 ],
   ...
]; 
```

右侧表达式中更新的字段可以是一个或多个，必须始终相同（在这种情况下始终为 fldC 和 fldD）。可以删除此限制，但需要修改算法。

然后我可以通过循环构建单个查询：

```
$where = [ ];
$set   = [ ];
foreach ($updates as $when => $then) {
    $where[] = "({$when})";
    foreach ($then as $fld => $value) {
       if (!array_key_exists($fld, $set)) {
           $set[$fld] = [ ];
       }
       $set[$fld][] = $value;
    }
}

$set1 = [ ];
foreach ($set as $fld => $values) {
    $set2 = "{$fld} = CASE";
    foreach ($values as $i => $value) {
        $set2 .= " WHEN {$where[$i]} THEN {$value}";
    }
    $set2 .= ' END';
    $set1[] = $set2;
}

// Single query
$sql  = 'UPDATE table SET '
      . implode(', ', $set1)
      . ' WHERE '
      . implode(' OR ', $where); 
```

# 另一种方式：ON DUPLICATE KEY UPDATE (MySQL)

在 MySQL 中，我认为您可以使用 multiple 更轻松地做到这一点`INSERT ON DUPLICATE KEY UPDATE`，**假设 id 是主键**，请记住不存在的条件（“id = 777”，没有 777）将被插入到表中，如果出现错误，可能会导致错误，例如，查询中未指定其他必需的列（声明为 NOT NULL）：

```
INSERT INTO tbl (id, posx, posy, bazinga)
     VALUES (id1, posY1, posY1, 'DELETE'),
     ...
ON DUPLICATE KEY SET posx=VALUES(posx), posy=VALUES(posy);

DELETE FROM tbl WHERE bazinga='DELETE'; 
```

上面的 'bazinga' 技巧允许删除任何可能因不存在 id 而被无意插入的行（但在其他情况下，您可能*希望*插入的行保留）。

例如，来自一组收集的传感器的定期更新，但某些传感器可能尚未传输：

```
INSERT INTO monitor (id, value)
VALUES (sensor1, value1), (sensor2, 'N/A'), ...
ON DUPLICATE KEY UPDATE value=VALUES(value), reading=NOW(); 
```

（这是一个人为的情况，可能更合理的是锁定表，将所有传感器更新为 N/A 和 NOW()，然后只插入我们拥有的那些值）。

# 第三种方式：CTE（PostgreSQL，不确定SQLite3）

这在概念上与 INSERT MySQL 技巧几乎相同。如所写，它适用于 PostgreSQL 9.6：

```
WITH updated(id, posX, posY) AS (VALUES
    (id1, posX1, posY1), 
    (id2, posX2, posY2),
    ...
)
UPDATE myTable
    SET 
    posX = updated.posY,
    posY = updated.posY
FROM updated
WHERE (myTable.id = updated.id); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-19T15:25:26.163

这样的事情可能对你有用：

```
"UPDATE myTable SET ... ;
 UPDATE myTable SET ... ;
 UPDATE myTable SET ... ;
 UPDATE myTable SET ... ;" 
```

如果任何 posX 或 posY 值相同，则可以将它们组合成一个查询

```
UPDATE myTable SET posX='39' WHERE id IN('2','3','40'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-12-16T22:47:19.717

我实际上无法让@Clockwork-Muse 工作。但我可以使这种变化起作用：

```
WITH Tmp AS (SELECT * FROM (VALUES (id1, newsPosX1, newPosY1), 
                                   (id2, newsPosX2, newPosY2),
                                   ......................... ,
                                   (idN, newsPosXN, newPosYN)) d(id, px, py))

UPDATE t

SET posX = (SELECT px FROM Tmp WHERE t.id = Tmp.id),
    posY = (SELECT py FROM Tmp WHERE t.id = Tmp.id)

FROM TableToUpdate t 
```

我希望这也适用于你！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-04T23:05:49.943

使用逗号“，”

```
eg: 
UPDATE my_table SET rowOneValue = rowOneValue + 1, rowTwoValue  = rowTwoValue + ( (rowTwoValue / (rowTwoValue) ) + ?) * (v + 1) WHERE value = ? 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-06T20:44:47.260

要为 column1 更新具有不同值的表，给定 column2 上的值，可以对 SQLite 执行以下操作：

```
"UPDATE table SET column1=CASE WHEN column2<>'something' THEN 'val1' ELSE 'val2' END" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-21T15:49:56.450

在最新版本的 SQLite（从 2018 年的 3.24.0 开始）中，您可以使用[UPSERT](https://sqlite.org/lang_upsert.html)子句。假设只有现有数据集被更新为具有唯一`id`列，您可以使用这种方法，这类似于@LSerni 的`ON DUPLICATE`建议：

```
INSERT INTO myTable (id, posX, posY) VALUES
  ( 1, 35, 565),
  ( 3, 89, 224),
  ( 6, 11, 456),
  (14, 87, 475)
ON CONFLICT (id) DO UPDATE SET
  posX = excluded.posX, posY = excluded.posY 
```

* * *

## 回答 #8

> 赞同：-13
> 
> 时间：2013-11-04T10:05:35.017

尝试使用“更新平板电脑集 (row='value' where id=0001'), (row='value2' where id=0002'), ...

# javascript - Chrome 无法识别 24:00:00 而 Firefox 识别

> ID：11563870
> 
> 赞同：4
> 
> 时间：2012-07-19T15:13:02.660
> 
> 标签：javascript, jquery, datetime

以下代码`NaN`在 Firefox 生成时在 Chrome 中输出输出`1247547600000`。

```
var str = "2009/07/13 24:00:00-0500";
document.write(Date.parse(str)); 
```

看到这个[**小提琴**](http://jsfiddle.net/DtvqJ/)。

如何解决这个问题？谢谢！

**编辑：**我从另一家公司得到数据。我无法更改它生成的数据。那么这里有什么建议呢？

生成的数据：

```
{"day":"2009-07-13", "work":["11:16:35-12:03:12", "12:32:48-13:26:28", "13:39:09-13:39:12", "13:41:03-13:41:05", "14:18:09-24:00:00"]},
{"day":"2009-07-14", "work":["00:00:00-07:22:25", "07:22:25-07:22:28", "10:10:04-10:10:31", "10:10:32-10:15:33", "10:18:07-10:21:19", "11:04:49-11:06:15", "11:12:50-11:19:05", "11:19:11-11:19:19", "11:45:50-11:51:42", "11:51:43-11:53:55", "14:03:13-14:13:04", "14:23:55-14:31:28", "14:31:28-14:38:00", "14:38:00-14:49:04", "16:34:56-16:44:33", "16:46:37-16:48:10", "16:48:11-24:00:00"]} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-29T16:59:22.093

刚遇到这个问题，研究了一下。

根据维基百科：（见[http://en.wikipedia.org/wiki/ISO_8601](http://en.wikipedia.org/wiki/ISO_8601)）

> 午夜是一个特例，可以称为“00:00”和“24:00”。符号“00:00”用于日历日的开始，使用频率更高。在一天结束时使用“24:00”。请注意，“2007-04-05T24:00”与“2007-04-06T00:00”是同一时刻（请参阅下面的组合日期和时间表示）。

所以看来 Chrome 是错误的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T15:27:41.437

您要求浏览器解析无效时间。24:00 无效。您可能是指第二天的 0:00。Chrome 拒绝它是正确的。Firefox 更宽容。

假设一天有 24 小时。如果第一个小时是 00，那么最后一个小时是 23。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:29:37.807

Chrome 是对的，24:00 不存在。一天在 23:59:59 结束，然后第二天从 00:00:00 开始。您的代码*不应生成带有 24:00:00*的日期，因为您无法保证浏览器如何解释它，或者即使它现在和将来都可以工作。

# perl - 为什么 Perl 看不到这个目录？

> ID：11563872
> 
> 赞同：1
> 
> 时间：2012-07-19T15:13:05.080
> 
> 标签：perl

我有这个目录结构：

```
$ ls -F
analyze/
data.pl
input.pl
logminer.txt
logSearch.pl
readFormat.pl
Version Notes.txt
datadump.pl
format/
logminer.pl
logs/
properties.txt
unzip.exe 
```

我跑：

```
perl -e 'if (!(-d analyze)){ print "poo\n"}' 
```

它打印出来`poo`。

这里缺少什么？我之前做过这样的测试，它会正确识别目录存在。为什么不是这个目录？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:14:43.013

```
perl -e 'if (!(-d "analyze")){ print "poo\n"}'
                  ^--     ^--- 
```

缺少引号？

编辑：更改为双引号 - 忘记这是用于命令行 perl

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:17:31.037

第一的，

```
-d analyze 
```

意思是“检查文件*句柄* `anaylyze`是否是目录句柄”。你要

```
-d 'analyze' 
```

现在，您说这样做仍然会遇到问题，因此请检查您遇到的错误。

```
my $rv = -d 'analyze';
die "stat: $!" if !defined($rv);
die "Not a dir" if !$rv; 
```

`-d`只是对 的一个薄包装`stat(2)`，所以不是*Perl* “看不见”，而是系统。

最常见的错误：

*   当前的工作目录不是你想象的那样。（许多人认为它始终是脚本所在的目录。）
*   文件名有尾随空格，尤其是换行符。（这里不太可能是这种情况。）

# asp.net-mvc-3 - 实体框架 POCO 关系

> ID：11563873
> 
> 赞同：1
> 
> 时间：2012-07-19T15:13:08.927
> 
> 标签：asp.net-mvc-3, entity-framework, ef-code-first, poco, code-first

我正在尝试实现实体框架的代码优先方法。我有四个实体`UserInfo`、`Client`和。我希望关系为：`Admin``Account`

*   每个`Client`都有一个`UserInfo`
*   每个`Admin`都有一个`UserInfo
*   每个`Account`都与一个 User( `UserInfo`)链接

假设这些东西我写了 POCO 模型。有了我想要的关系，它是否正确？我错过了什么吗？

```
public class UserInfo
    {
        public int UserInfoID { get; set; }
        public Name Name { get; set; }
        public Address Address { get; set; }
        public Contact Contact { get; set; }
    }

public class Admin
    {
        public int AdminID { get; set; }
        public int UserInfoID { get; set; }
        [ForeignKey("UserInfoID")]
        public virtual UserInfo UserInfo { get; set; }
    }

public class Client
    {
        public int ClientID { get; set; }
        public CompanyDetails CompanyDetails { get; set; }
        public int UserInfoID { get; set; }
        [ForeignKey("UserInfoID")]
        public virtual UserInfo UserInfo { get; set; }
    }

 public class Account
    {
        public int AccountID { get; set; }
        [Required, Column("Balance"), Display(Name = "Account Balance")]
        public double Balance { get; set; }
        public int UserInfoID { get; set; }
        [ForeignKey("UserInfoID")]
        public virtual UserInfo UserInfo { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T23:05:37.767

根据您的要求，您所拥有的似乎是正确的，但是在使用 Code First 配置您的实体时，我个人更喜欢实体框架模型构建器。

使用模型构建器意味着您的 POCO 实体上没有任何属性，这反过来意味着您不需要 EF 引用来使用实体。

在这里查看我的文章，了解有关如何使用模型构建器的更多信息：http: [//blog.staticvoid.co.nz/2012/07/entity-framework-navigation-property.html](http://blog.staticvoid.co.nz/2012/07/entity-framework-navigation-property.html)

# jquery - jQuery 移动特定列表

> ID：11563874
> 
> 赞同：0
> 
> 时间：2012-07-19T15:13:13.857
> 
> 标签：jquery, list, mobile, jquery-mobile

jQuery mobile 上是否有一个列表可以生成如下内容：

![在此处输入图像描述](../Images/3289765bcd57909d5e63597fa06cd3fc.png)

我搜索了一些网站，但没有找到任何相关的内容。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:23:49.620

面包屑在 jQuery Mobile 中找不到，但可以在 jQuery 插件中找到，例如：

[http://www.comparenetworks.com/developers/jqueryplugins/jbreadcrumb.html](http://www.comparenetworks.com/developers/jqueryplugins/jbreadcrumb.html) http://www.ajaxblender.com/script-sources/xbreadcrumbs/demo/index.html

# python - 使用 elementtree python 获取元素

> ID：11563881
> 
> 赞同：0
> 
> 时间：2012-07-19T15:13:44.890
> 
> 标签：python, xml, elementtree

我的 XML 看起来像：（对不起，如果有重复的问题，但我对 XML 不是很有经验，所以我对术语有点麻烦

```
<sometags>
    <Value>
        <Scalar unitGlobalDataRef="Unit_0" unit="None" xmlns="xxxxyyyy">20</Scalar> 
    </Value>
</sometags> 
```

使用此代码：

```
element = ET.parse(fileName)
root = element.getroot()
for subelement in root:
    if (subelement.tag == "{xxyy}Parameter"):
        for value in subelement:
            for subval in value:
                #Here is where it prints
                if (subval.tag == "{xxxxyyyy}Scalar"):
                    print subval.tag
                    print subval.text
                    print subval.tail
                    print subval.attrib 
```

印刷

```
{xxxxyyyy}Scalar
0

{'unitGlobalDataRef': 'Unit_0', 'unit': 'None'} 
```

如何从元素中获取值 20？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:31:07.010

subval.text 应该包含您正在寻找的信息。由于您得到的是 0，这意味着您的迭代可能是错误的，并且您得到的元素与您认为的不同。您的属性不匹配这一事实进一步强化了这一点。

# c# - 如何从 ThreadPool.QueueUserWorkItem 获取进度报告

> ID：11563882
> 
> 赞同：0
> 
> 时间：2012-07-19T15:13:58.660
> 
> 标签：c#, .net, threadpool

我有一个`List<MyClass>`有 N 个项目。我使用以下代码处理

```
foreach (var item in myList)
{
    ThreadPool.QueueUserWorkItem(DoWorkWithItem, item);
}

private void DoWorkWithItem(object threadContext)
{
   ///...
} 
```

但我需要报告处理了哪些项目，我可以在哪里得到一个事件或这个任务的东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:23:31.837

创建事件并在威胁迭代完成后调用它，如下所示：

```
public class ClassWithDelegate
{
    public delegate void ProgressReportEventHandler();
    public static ProgressReportEventHandler ProgressReport { get; set; };

    private void DoWorkWithItem(object threadContext)
    {
       // angry code

       if (ProgressReport != null)
          ProgressReport();
    }
}

public class Subscriber
{
    public Subscriber()
    {
         ClassWithDelegate.ProgressReport += ProgressReport;         
    }

    public void ProgressReport()
    {
        //todo
    }
} 
```

或使用`BackgroundWorker`，它有这个事件

# c++ - 跨平台调度地图

> ID：11563883
> 
> 赞同：1
> 
> 时间：2012-07-19T15:14:01.337
> 
> 标签：c++, visual-studio-2010, mfc

我在“.odl”文件中定义了一个新的“BSTR PreviewName”。相应的“.cpp”中的调度映射是：

```
 DISP_PROPERTY_EX(CDB,"PreviewName", GetPreviewName, SetPreviewName, VT_BSTR); 
```

对应的 GetPreviewName() 为：

```
 BSTR  CDB::GetPreviewName() 
    {
    return m_name;
    } 
```

对应的 SetPreviewName() 为：

```
 void CDB::SetPreviewName(BSTR newValue) 
    {
    refresh();
    } 
```

我正在尝试跨平台访问“PreviewName”的值。“PreviewName”永远不会设置为从 GetPreviewName() 返回的值。我是否缺少任何其他设置等来跨平台访问“PreviewName”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T10:56:20.060

Your setter doesn't appear to do anything with the new value.

```
void CDB::SetPreviewName(BSTR newValue) 
{
    m_name = newValue; //add this line?
    refresh();
} 
```

# java - IBM Websphere 7，支持 JAX-WS Service 2.2，这可能吗？

> ID：11563884
> 
> 赞同：1
> 
> 时间：2012-07-19T15:14:06.623
> 
> 标签：java, jakarta-ee, websphere, jax-ws

我有一个使用 JAX-WS 2.2 的 Java EE 应用程序，我必须将它部署在 WebSphere Application Server 7 上，但是这个版本的 WAS 似乎只支持 JAX-WS 2.1。

有什么方法可以在 WAS 7 上启用 JAX-WS 2.2？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T22:19:08.213

在 WAS 7 (7.0.0.7) 的修订包 7 中，添加了配置选项以禁用 IBM 提供的随产品一起提供的 JAX-WS 引擎，并配置第三方 JAX-WS 引擎。[您可以在PK93756](http://www-01.ibm.com/support/docview.wss?uid=swg1PK93756)中查看有关此修复的详细信息：在 WEBSPHERE 中启用第三方 JAX-WS WEB 服务引擎

因此，您应该能够配置您选择的 JAX-WS 2.2 实现。您可以找到有关如何配置服务器以禁用 IBM 提供的 JAX-WS 引擎的信息，然后在[DeveloperWorks](http://www.ibm.com/developerworks/websphere/library/techarticles/1001_thaker/1001_thaker.html)和 WAS 7 [Infocenter](http://pic.dhe.ibm.com/infocenter/wasinfo/fep/topic/com.ibm.websphere.nd.multiplatform.doc/info/ae/ae/twbs_thirdparty.html)中配置您自己的实现。

# backbone.js - 如何在视图中插入模型获取的结果

> ID：11563887
> 
> 赞同：0
> 
> 时间：2012-07-19T15:14:14.060
> 
> 标签：backbone.js

我有`fetch()`一个服务器模型，我想`fetch()`用视图渲染结果。

的结果`fetch()`是一个对象数组（`var risultati`），我想渲染它`var risultati`。我已经尝试过，但没有任何效果。

```
var AppRouter = Backbone.Router.extend({
    routes: {
        "": "list",
    },
    initialize: function () {},
    list: function () {
        var utente = new Person();
        var risultati;
        utente.fetch({
            success: function (data) {
                var ris = data.attributes;
                var risultati = ris.results;
                console.log(risultati); /* risultati contains array of object to render*/
            }
        });
        this.page = new UserListView({
            model: this.utente
        });
        $('body').append(this.page.$el);
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:42:49.280

您可能会遇到问题，因为您渲染视图的调用与您的调用是分开的`utente.fetch()`。

由于`.fetch()`是异步的，您的视图代码将在`.fetch()`完成之前执行。您应该将视图创建/渲染添加为成功函数的一部分，或者您应该绑定在模型更新时发生的更改事件以触发包含您的视图创建的新函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:45:25.373

你应该分离你的 MVC 逻辑......不要将对象（我认为是集合）附加到路由器路由处理程序。
假设您正在尝试呈现人员模型的集合，我建议您为人员使用模型和视图，并使用集合和视图来处理“对象数组”：

```
var Person = Backbone.Model.extend({
        initialize : function(){
            // initialize the view
            this.view = new PersonView({model : this}); 
        }
    }),
    PersonView = Backbonke.View.extend({
        render : function(){
            // render your person
        }
    }),
    UserList = Backbone.Collection.extend({
        model : Person,
        initialize : function(){
             this.view = new UserListView({
                  collection : this
             });
        },
        update : function(){
            var self = this;
            this.fetch({
                success: function (data) {
                    var ris = data.attributes;
                    var risultati = ris.results;
                    console.log(risultati); /* risultati contains array of object to render*/                self.view.render();
                 }
            });
        }
    }),
    UserListView = Backbone.View.extend({
        render : function(){
            this.collection.each(function(el,i){
                el.view.render();
            });
        }
    }); 
```

然后将其用作：

```
 var page = new UserList();
 var AppRouter = Backbone.Router.extend({
    routes: {
        "": "list",
    },
    initialize: function () {},
    list: function () {
        page.update();
    }
}); 
```

希望这可以帮助！

# ruby-on-rails - TinyTds::Error: 无法打开套接字

> ID：11563888
> 
> 赞同：2
> 
> 时间：2012-07-19T15:14:14.513
> 
> 标签：ruby-on-rails, sockets, sql-server-2000, tiny-tds

我已经研究了几个小时，但似乎找不到解决方案。

我有一个 Rails 2 应用程序，它使用 TinyTds gem ( tiny_tds ) 连接到我们公司本地托管的 SQL 2000 服务器。

在过去的 6 个月里，该应用程序几乎每天都连接到 SQL Server，没有任何问题。

突然，昨天尝试连接时，我开始收到错误消息：

```
TinyTds::Error: Unable to open socket
from /var/lib/gems/1.8/gems/tiny_tds-0.4.5/lib/tiny_tds/client.rb:60:in `connect'
from /var/lib/gems/1.8/gems/tiny_tds-0.4.5/lib/tiny_tds/client.rb:60:in `initialize' 
```

根据我的研究，我看到有人建议我使用 SO_REUSEADDR 来允许它连接并忽略超时或“使用”限制，例如： setsockopt(sock, SOL_SOCKET, SO_REUSEADDR) 但我不知道如何使用该命令在当前语境下。我尝试在服务器上的命令行中调用它，但它不起作用，但话又说回来，我不确定它做了什么，或者我什至可以从命令行调用它。

我试过调用 netstat -a 来显示当前的套接字，但我不确定如何处理这些信息。

我还看到 service restart
可以重新启动套接字，但我不确定要重新启动哪个套接字。

最后，在我的 freetds.conf 配置文件中，我有以下设置：

```
host = 192.168.0.220 
port = 1433
tds version = 8.0 
```

我不确定要走哪条路。我对 Rails 很满意，但这个套接字的东西超出了我目前的理解。这也是一个 Rails 2 应用程序（遗留），它是我们业务使用的一些核心流程的关键。由于 SQL 2000 服务器的 SQL 服务器适配器 gem 不能与 Rails 3 一起使用，我们无法升级到 Rails 3。

任何人都可以帮忙吗？

# python - Python - 非离散比较的切换替代方案

> ID：11563890
> 
> 赞同：2
> 
> 时间：2012-07-19T15:14:21.167
> 
> 标签：python, dictionary, switch-statement

也许以前有人问过这个问题，但我找不到。我正在尝试实现一些东西来确定给定值的范围。在这个例子中，x 可以是任何实数。

```
def f(x):
    if x < 0.1:
        do_something_1()
    elif 0.1 <= x < 1:
        do_something_2()
    elif 1 <= x < 10:
        do_something_3()
    elif x >= 10:
        do_something_4() 
```

...你明白了。

我已经看到很多用字典替换 Python 中的 switch 语句的例子，但我一直将字典理解为索引离散值。

我很难相信 if-elif-else 链是这种情况下的最佳解决方案。有谁知道更好的吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-19T15:18:01.830

改善这一点的一个简单方法是不重复下限。您的代码相当于

```
if x < 0.1:
    do_something_1()
elif x < 1:
    do_something_2()
elif x < 10:
    do_something_3()
else:
    do_something_4() 
```

如果确实有很多值，您可能想要`bisect`改为，但只有四个选项，上面的代码可能是最好的解决方案，至少在可读性和速度方面。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-19T15:16:40.320

使用[bisect](http://docs.python.org/release/2.5.2/lib/module-bisect.html)包查找值所在的索引，然后调用相应的函数。在您的示例中：

```
import bisect

def f(x):
    funcs = [do_something_1, do_something_2, do_something_3, do_something_4]
    funcs[bisect.bisect_left([.1, 1, 10], x)]() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T16:41:54.577

这是另一种方法，使用 dict 和 for 循环：

```
ranges_dict = {
    0.1: do_something1,
    1.0: do_something2,
    10.0: do_something3,
    }

for range_val, do_function in sorted(ranges_dict.items()):
    if x < range_val:
        do_function()
        break
else:
    do_something_else() 
```

# asp.net - MVC jQuery ajax 调用未在服务器上进行身份验证

> ID：11563891
> 
> 赞同：0
> 
> 时间：2012-07-19T15:14:26.040
> 
> 标签：asp.net, asp.net-mvc, jquery

一点背景：

我在 MVC3 中开发了一个 Web 应用程序，需要用户登录才能访问。

如果网页已经离开 5 分钟，一个计时器会触发，它会向服务器发出 jQuery ajax 调用，并返回一个包含登录用户电子邮件地址的部分视图和一个密码文本框，以便用户可以重新输入他们的详细信息，然后再继续使用该应用程序。

我使用表单身份验证，它存储在浏览器中的 cookie 设置为在浏览器会话关闭时过期（即它没有设置 Expires 属性）。

如果我将空闲计时器设置为 10 秒或 1 分钟，它工作正常。但是，如果我将其设置为 5 分钟，则在服务器上我看到以下内容：

> **HttpContext.Current.User.Identity.IsAuthenticated**的值为 false **HttpContext.Current.User.Identity.Name**的值为“空”

所以我无法获取当前登录的用户详细信息。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:25:06.017

我注意到在我的 web.config 中，在 Authentication 节点下，超时也设置为 5 分钟，这似乎影响了它。因此，为什么它对于低于 5 分钟的任何请求都能正常工作。我将其更改为 30 分钟，乍一看似乎可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:18:52.963

您可以尝试将用户的设置保留在 web.config 文件中，例如 isdebugmode、clientcode 并从那里获取。点网核弹也不是一个坏选择。

# android - 向现有表添加新字段

> ID：11563892
> 
> 赞同：1
> 
> 时间：2012-07-19T15:14:27.103
> 
> 标签：android, sqlite

我正在使用一个类来扩展 SQLiteOpenHelper，如下所示：

```
public class PocketSQLite extends SQLiteOpenHelper {
    public String TableNames[];
    public String FieldNames[][];
    public String FieldTypes[][];
    public static String NO_CREATE_TABLES = "no tables";
    private String message = "";

    public PocketSQLite(Context context, String name, CursorFactory factory, int version, String tableNames[], String fieldNames[][], String fieldTypes[][]) {
        super(context, name, factory, version);
        TableNames = tableNames;
        FieldNames = fieldNames;
        FieldTypes = fieldTypes;
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        if (TableNames == null) {
            message = NO_CREATE_TABLES;
            return;
        }

        for (int i = 0; i < TableNames.length; i++) {
            String sql = "CREATE TABLE " + TableNames[i] + "(";
            for (int j = 0; j < FieldNames[i].length; j++)
                sql += FieldNames[i][j] + " " + FieldTypes[i][j] + ",";
            sql = sql.substring(0, sql.length() - 1);
            sql += ")";
            db.execSQL(sql);
        }
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        for (int i = 0; i < TableNames[i].length(); i++) {
            String sql = "DROP TABLE IF EXISTS " + TableNames[i];
            db.execSQL(sql);
        }
        onCreate(db);
    }
} 
```

如您所见，构造函数将输入表的字段。如何更新 onUpgrade 函数以将新字段添加到现有表？

例如：

旧表（2 个字段）：“姓名”、“电话”

新表（3 个字段）：“姓名”、“电话”、“电子邮件”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:19:49.337

首先，当您进行此类结构更改时，您需要更改数据库版本。然后，在升级方法中，编写您的 sql 语句，这将修改您的表。

当你下次运行你的应用程序时，会调用 onUpgrade 方法，并执行你的 sql 语句，这将修改你的表。

[http://www.w3schools.com/sql/sql_alter.asp](http://www.w3schools.com/sql/sql_alter.asp)

您也可以删除该表，但正如您所说，您将丢失现有数据。

# facebook - Facebook 分享后喜欢不工作

> ID：11563894
> 
> 赞同：1
> 
> 时间：2012-07-19T15:14:33.360
> 
> 标签：facebook, facebook-like, google-plus, google-plus-one, facebook-likebox

编辑：+1 现在正在工作.. 只有 facebook 共享仍然被破坏

我在这个网站上添加了一些社交按钮 hgw-Hausnummern.de +1 按钮根本不起作用，Facebook 喜欢按钮只适用于简单的喜欢，但如果我想分享网站（在那个对话框中你点赞后查看）此分享未显示在我的时间线中。

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:26:15.107

我不确定你的 Facebook Like 按钮是怎么回事，但我确实看到你的 +1 按钮标记存在一个问题。

您当前的 +1 按钮标记如下所示：

```
<div class="g-plusone" data-size="small" data-annotation="none" data-href="www.hgw-hausnummern.de"></div> 
```

您必须使用完整的 URL 指定目标网站。尝试将您的代码更改为：

```
<div class="g-plusone" data-size="small" data-annotation="none" data-href="http://www.hgw-hausnummern.de"></div> 
```

# java - 插入行时的jpa应返回用于主键列的序列号

> ID：11563896
> 
> 赞同：1
> 
> 时间：2012-07-19T15:14:40.303
> 
> 标签：java, oracle, jpa

我知道在 sql(oracle) 中我们可以使用“reruning into”，但是在使用 em.create() 时是否可以使用 JPA 自动执行某些操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:17:36.707

试试 em.merge()，它会返回你刚刚持久化的附加实例。您可能需要 em.flush() 才能看到生成的主键。

# ruby-on-rails - 在 Ruby 中使用和编辑类变量？

> ID：11563906
> 
> 赞同：0
> 
> 时间：2012-07-19T15:15:16.500
> 
> 标签：ruby-on-rails, ruby, sqlite

所以我对这个问题做了几天的研究，普遍的共识是没有。所以我希望得到一个更具体的我的情况的答案......

我正在使用 Rails 将文件导入数据库。关于导入的一切都在工作，但我想给数据库本身一个属性，而不仅仅是每个条目。我正在创建文件的哈希，我认为将它分配给数据库（或类）是最简单的。

我创建了一个名为 Issue 的类（因此是一个“问题”数据库），每个条目都有几个属性。我想找到一种方法来添加一个类变量（至少，这是我认为最好的选择）到 Issue 以简单地存储哈希。我已经写了一个 rake 来导入文件，如果新文件与之前导入的文件不同（读取，如果哈希不同）。

```
desc "Parses a CSV file into the 'issues' database"
task :issues, [:file] => :environment do |t, args|
  md5 = Digest::MD5.hexdigest(args[:file])
  puts "1: Issue.md5 = #{Issue.md5}"

  if md5 != Issue.md5
    Issue.destroy_all()
    #import new csv file
    CSV.foreach(args[:file]) do |row|

      issue = {
        #various attributes to be columns...
        }
      Issue.create(issue)
   end #end foreach loop
  Issue.md5 = md5
  puts "2: Issue.md5 = #{Issue.md5}"
  end #end if statement
end #end task 
```

我的模型如下：

```
class Issue < ActiveRecord::Base

  attr_accessible :md5

  @@md5 = 5

  def self.md5
    @@md5
  end

  def self.md5=(newmd5)
    @@md5 = newmd5
  end

  attr_accessible #various database-entry attributes
end 
```

我尝试了各种不同的方法来编写我的模型，但这一切都归结为这一点。无论我在模型中设置@@md5，都会变成永久更改，几乎就像一个常数。如果我在此处更改此值并刷新我的数据库，则会立即记录更改。如果我进入 Rails 控制台并执行以下操作：

```
Issue.md5        # => 5
Issue.md5 = 123  # => 123
Issue.md5        # => 123 
```

但这种变化并没有承诺任何事情。一旦我退出控制台，事情就会再次回到“5”。这几乎就像我的班级需要一个 .save 方法。

此外，在 rake 文件中，您会看到我有两个打印语句，在解析之前和之后打印出 Issue.md5。第一个打印出“5”，第二个打印出新的正确哈希。所以 Ruby 认识到我正在更改这个变量，它从未保存在任何地方。

Ruby 1.9.3、Rails 3.2.6、SQLite3 3.6.20。

tl;博士我需要一种方法来创建一个类变量，并且能够访问它、修改它并重新存储它。

请问修复？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:32:04.620

这里有几个解决方案。本质上，您需要保留一个变量：Postgres 在数据库中提供了一个键/值存储，这将是最理想的，但您使用的是 SQLite，所以这不是您的选择。相反，您可能需要使用[redis](http://redis.io/)或[memcached](http://memcached.org/)将此信息持久保存到您的数据库中。

任何一个都允许您将值持久保存到无模式数据存储中，并在以后再次查询它们。Redis 的优点是可以保存到磁盘，所以如果服务器对你不满意，你可以在重新启动时再次获取 md5 的值。保存到 memcached 中的数据永远不会持久化，因此如果 memcached 实例消失，当它回来时 md5 将再次为 5。

[redis](https://github.com/redis/redis-rb)和[memcached](https://github.com/mperham/dalli/)在 Ruby 社区中都得到了很多支持。安装一个堆栈会使您的堆栈稍微复杂化，但我认为这是您可用的最佳解决方案。也就是说，如果您不能使用其中任何一个，您也可以将 md5 的值写入服务器上的临时文件并稍后再次访问它。那里的问题是该值不会在您的所有服务器进程之间共享。

# javascript - 谷歌图表根据屏幕大小改变大小

> ID：11563907
> 
> 赞同：3
> 
> 时间：2012-07-19T15:15:17.360
> 
> 标签：javascript, jquery, mobile, charts

我有一个问题，我正在开发一个网络应用程序，并且我有一些谷歌图表。我已经成功地使图表的大小根据屏幕大小而改变，尽管我想知道的是，在有人将手机或平板电脑从纵向切换到横向之后，是否有任何方法可以改变图表的大小。现在，一旦图表绘制出来，并且您切换手机方向，图表就会保持相同的大小，所以实际上它只会在您第一次看到图表时检测手机屏幕的大小。

这是一些代码（如果有人有更好的方法，请告诉我......）

```
function graph(depData, indepData, seriesTitle, title, xTitle,  yTitle, chartTitle, bg) {
    var rlen = 5;
    var graph_string = "http://chart.apis.google.com/chart?cht=lxy";
    graph_string += "&chd=t:";

    var biggest, biggest_indep, biggest_dep; 
    biggest_indep = indepData[0];

    var min_indep = 0;

    //BEGIN FIRST DATA SET
    graph_string += indepData[0];
    for (var i = 1; i < 100; i++) {
        graph_string += ",";
        graph_string += Math.round(indepData[i] * Math.pow(10, rlen)) / Math.pow(10, rlen);
        if (indepData[i] > biggest_indep) {
            biggest_indep = indepData[i];
        }
        if (indepData[i] < min_indep) {
            min_indep = indepData[i];   
        }
    }

    biggest_dep = depData[0];

    graph_string += "|";

    graph_string += Math.round(depData[0] * Math.pow(10, rlen)) / Math.pow(10, rlen);
    for (i = 1; i < 100; i++) {
        graph_string += ",";
        graph_string += Math.round(depData[i] * Math.pow(10, rlen)) / Math.pow(10, rlen);
        if (depData[i] > biggest_dep) {
            biggest_dep = depData[i];
        }
    } 
    //END FIRST DATA SET
    biggest = Math.max(biggest_dep, biggest_indep);
    var biggest_indep_dec = biggest_indep.toFixed(3); 
    var biggest_indep_dec_half = ((biggest_indep + min_indep) / 2).toFixed(3);
    var biggest_indep_dec_fourth = ((biggest_indep + min_indep) / 4).toFixed(3);
    var biggest_indep_dec_three_fourths = ((biggest_indep + min_indep) * 0.75).toFixed(3);

    min_indep = min_indep.toFixed(3);
    //min_indep = Math.min(min_indep, 0);  Shouldn't be necessary if min_indep initialized to 0

    var chart_size = Math.round(biggest_dep + 160);                         //increase range to compensate for title
    //alert(biggest + ", " + biggest_dep + ", " + biggest_indep);
    graph_string += "&chds=" + (min_indep) + "," + (biggest_indep_dec) + ",0," + (biggest_dep * 4 / 3).toFixed(3);      //specify range

    //change labels appropriately: if in terms of %Speed, want 25, 50, 75, 100
    if (xTitle === "%%20Speed") {
        min_indep = 0;
        biggest_indep_dec = 100;
        biggest_indep_dec_half = 50;
        biggest_indep_dec_fourth = 25;
        biggest_indep_dec_three_fourths = 75;
    }
    biggest_dep = Math.round(biggest_dep * 100);
    biggest_dep = Math.round(parseInt(biggest_dep, 10) / 5) * 5; //round to the nearest 5

    //only use linear stripes if bg is true:
    //  plan to use them on main page but not on summary page
    if (bg) {
        graph_string += "&chf=c,ls,90,BBBBBB,0.25,DDDDDD,0.25"; //linear stripes
    }
    graph_string += "&chco=0000FF";
                        //,0000FF";                 //line colors
    //graph_string += "&chdl=" + seriesTitle;
                        //|Second";                 //legend
    graph_string += ("&chtt=" + chartTitle);                //chart title (parameter)

        function adjustStyle(width) {
    width = parseInt(width);
    if (width < 240) {
        graph_string += "&chs=232x";
    } else if ((width >= 240) && (width < 250)) {
       graph_string += "&chs=232x";
    } else if ((width >= 250) && (width < 260)) {
       graph_string += "&chs=242x";   
    } else if ((width >= 260) && (width < 270)) {
       graph_string += "&chs=252x";
    } else if ((width >= 270) && (width < 280)) {
       graph_string += "&chs=262x";   
    } else if ((width >= 280) && (width < 290)) {
       graph_string += "&chs=272x";   
    } else if ((width >= 290) && (width < 300)) {
       graph_string += "&chs=282x";
    } else if ((width >= 300) && (width < 310)) {
       graph_string += "&chs=292x";
    } else if ((width >= 310) && (width < 320)) {
       graph_string += "&chs=302x";   
    } else if ((width >= 320) && (width < 330)) {
       graph_string += "&chs=312x";
    } else if ((width >= 330) && (width < 340)) {
       graph_string += "&chs=322x";   
    } else if ((width >= 340) && (width < 350)) {
       graph_string += "&chs=332x";   
    } else if ((width >= 350) && (width < 360)) {
       graph_string += "&chs=342x";
    } else if ((width >= 360) && (width < 370)) {
       graph_string += "&chs=352x";
    } else if ((width >= 370) && (width < 380)) {
       graph_string += "&chs=362x";   
    } else if ((width >= 380) && (width < 390)) {
       graph_string += "&chs=372x";
    } else if ((width >= 390) && (width < 400)) {
       graph_string += "&chs=382x";   
    } else if ((width >= 400) && (width < 410)) {
       graph_string += "&chs=392x";   
    } else if ((width >= 410) && (width < 420)) {
       graph_string += "&chs=402x";
    } else if ((width >= 420) && (width < 430)) {
       graph_string += "&chs=412x";
    } else if ((width >= 430) && (width < 440)) {
       graph_string += "&chs=422x";   
    } else if ((width >= 440) && (width < 450)) {
       graph_string += "&chs=432x";
    } else if ((width >= 450) && (width < 460)) {
       graph_string += "&chs=442x";   
    } else if ((width >= 460) && (width < 470)) {
       graph_string += "&chs=452x";   
    } else if ((width >= 470) && (width < 480)) {
       graph_string += "&chs=462x";
    } else if ((width >= 480) && (width < 490)) {
       graph_string += "&chs=472x";
    } else if ((width >= 490) && (width < 500)) {
       graph_string += "&chs=482x";   
    } else if ((width >= 500) && (width < 510)) {
       graph_string += "&chs=492x";
    } else if ((width >= 510) && (width < 520)) {
       graph_string += "&chs=502x";   
    } else if ((width >= 520) && (width < 530)) {
       graph_string += "&chs=512x";   
    } else if ((width >= 530) && (width < 540)) {
       graph_string += "&chs=522x";
    } else if ((width >= 540) && (width < 550)) {
       graph_string += "&chs=532x";
    } else if ((width >= 550) && (width < 560)) {
       graph_string += "&chs=542x";   
    } else if ((width >= 560) && (width < 570)) {
       graph_string += "&chs=552x";
    } else if ((width >= 570) && (width < 580)) {
       graph_string += "&chs=562x";   
    } else if ((width >= 580) && (width < 590)) {
       graph_string += "&chs=572x";   
    } else if ((width >= 590) && (width < 600)) {
       graph_string += "&chs=582x";
    } else if ((width >= 600) && (width < 610)) {
       graph_string += "&chs=592x";
    } else if ((width >= 610) && (width < 620)) {
       graph_string += "&chs=602x";   
    } else if ((width >= 620) && (width < 630)) {
       graph_string += "&chs=612x";
    } else if ((width >= 630) && (width < 640)) {
       graph_string += "&chs=622x";   
    } else if ((width >= 640) && (width < 650)) {
       graph_string += "&chs=632x";   
    } else if ((width >= 650) && (width < 660)) {
       graph_string += "&chs=642x";
    } else if ((width >= 660) && (width < 670)) {
       graph_string += "&chs=652x";
    } else if ((width >= 670) && (width < 680)) {
       graph_string += "&chs=662x";   
    } else if ((width >= 680) && (width < 690)) {
       graph_string += "&chs=672x";
    } else if ((width >= 690) && (width < 700)) {
       graph_string += "&chs=682x";   
    } else if ((width >= 700) && (width < 710)) {
       graph_string += "&chs=692x";   
    } else if ((width >= 710) && (width < 720)) {
       graph_string += "&chs=702x";       
    } else if ((width >= 720) && (width < 730)) {
       graph_string += "&chs=712x";
    } else if ((width >= 730) && (width < 740)) {
       graph_string += "&chs=722x";   
    } else if ((width >= 740) && (width < 750)) {
       graph_string += "&chs=732x";
    } else if ((width >= 750) && (width < 760)) {
       graph_string += "&chs=742x";   
    } else if ((width >= 760) && (width < 770)) {
       graph_string += "&chs=752x";   
    } else if ((width >= 770) && (width < 780)) {
       graph_string += "&chs=762x";
    } else if ((width >= 780) && (width < 790)) {
       graph_string += "&chs=772x";
    } else if ((width >= 790) && (width < 800)) {
       graph_string += "&chs=782x";   
    } else if ((width >= 800) && (width < 810)) {
       graph_string += "&chs=792x";
    } else if ((width >= 810) && (width < 820)) {
       graph_string += "&chs=802x";   
    } else if ((width >= 820) && (width < 830)) {
       graph_string += "&chs=812x";   
    } else if ((width >= 830) && (width < 840)) {
       graph_string += "&chs=822x";
    } else if ((width >= 840) && (width < 850)) {
       graph_string += "&chs=832x";
    } else if ((width >= 850) && (width < 860)) {
       graph_string += "&chs=842x";   
    } else if ((width >= 860) && (width < 870)) {
       graph_string += "&chs=852x";
    } else if ((width >= 870) && (width < 880)) {
       graph_string += "&chs=862x";   
    } else if ((width >= 880) && (width < 890)) {
       graph_string += "&chs=872x";   
    } else if ((width >= 890) && (width < 900)) {
       graph_string += "&chs=882x";
    } else if ((width >= 900) && (width < 910)) {
       graph_string += "&chs=892x";
    } else if ((width >= 910) && (width < 920)) {
       graph_string += "&chs=902x";   
    } else if ((width >= 920) && (width < 930)) {
       graph_string += "&chs=912x";
    } else if ((width >= 930) && (width < 940)) {
       graph_string += "&chs=922x";   
    } else if ((width >= 940) && (width < 950)) {
       graph_string += "&chs=932x";   
    } else if ((width >= 950) && (width < 960)) {
       graph_string += "&chs=942x";
    } else if ((width >= 960) && (width < 970)) {
       graph_string += "&chs=952x";
    } else if ((width >= 970) && (width < 980)) {
       graph_string += "&chs=962x";   
    } else if ((width >= 980) && (width < 990)) {
       graph_string += "&chs=972x";
    } else if ((width >= 990) && (width < 1000)) {
       graph_string += "&chs=982x";
    } else {
       graph_string += "&chs=982x"; 
    }
}

jQuery(function() {
    adjustStyle(jQuery(this).width());
    jQuery(window).resize(function() {
        adjustStyle(jQuery(this).width());
    });
});

    graph_string += chart_size;                             //y dimension: dynamic 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-26T03:46:44.187

我查看了@Antonio 的解决方案并想出了一个不同的解决方案。

我将 Antonio 的函数包含在 Google Chart 脚本中，并将 putQR 函数包裹在 Google Chart Options 和

```
var chart = new google.visualization.LineChart(document.getElementById('myweight'));
chart.draw(data, options); 
```

旁边...

```
$(document).ready(function () {
  putQR();
}); 
```

...我还添加了...

```
$(window).resize(function () {
  putQR();
}); 
```

...为了在用户调整浏览器大小时调整图表大小。

* * *

*我想这是您要求的实际功能，因为它会在浏览器宽度更改时调整图形的大小，即从普通手持电话切换到横向时必须是相同的东西。*

* * *

我还补充说，graphHeight 应该是 graphWidth 的 80%，并且不高于 800。

## 看看这里的代码...

[JSfiddle](http://jsfiddle.net/Pixic/BRyyr/)

...你可以在[Pixic.se上看到它](http://www.pixic.se/page_my_weight.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:13:16.270

一种解决方案可能是获取容器的度量值，然后创建具有您感兴趣的高度和宽度的图形。

```
<!DOCTYPE>
<html>
    <head>
        <title></title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function(){
                putQR();
            });
            function putQR(){
                var chartParent = $('#chartParent');
                var width = $(chartParent).width();
                var height = $(chartParent).height();
                var source = "https://chart.googleapis.com/chart?chs="+width+"x"+height+"&amp;cht=qr&amp;choe=UTF-8&amp;chl=http://www.kikiriki.org/copy/agtraWtpcmlraW9yZ3IRCxIJQ29weXBhc3RlGPOEDgw";
                $(chartParent).append('<img id="qr" src="'+source+'" alt="qr" />');
            }
        </script>
        <style>
            #chartParent{
                width: 500px;
                height: 500px;
            }
        </style>
    </head>
    <body>
        <div id="chartParent"></div>
    </body>
</html> 
```

# android - Android菜单按钮，刷新页面

> ID：11563910
> 
> 赞同：0
> 
> 时间：2012-07-19T15:15:32.033
> 
> 标签：android

我将添加什么代码，以便在按下菜单按钮刷新时它会刷新我的应用程序中的 webview。？

```
import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.webkit.WebView;

public class Main extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    WebView WV = (WebView) findViewById(R.id.webView1);
    WV.getSettings().setJavaScriptEnabled(true);
    WV.loadUrl("http://home.btconnect.com/MrJFisher/");

}

@Override
public boolean onCreateOptionsMenu (Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu, menu);
    return super.onCreateOptionsMenu(menu);
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    if(item.getItemId() == R.id.item1){
        WebView.reload();
    }
    return super.onOptionsItemSelected(item);
}
}; 
```

初学者。所以我道歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:17:47.210

**编辑**：

```
import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.webkit.WebView;

public class Main extends Activity {
    WebView mWebView;        

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mWebView = (WebView) findViewById(R.id.webView1);
        mWebView.getSettings().setJavaScriptEnabled(true);
        mWebView.loadUrl("http://home.btconnect.com/MrJFisher/");
    }

    @Override
    public boolean onCreateOptionsMenu (Menu menu) {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.menu, menu);
        return super.onCreateOptionsMenu(menu);
    }  

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        if(item.getItemId() == R.id.item1){
            mWebView.reload();
            return true;
        }
        return super.onOptionsItemSelected(item);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:18:40.107

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    if(item.getItemId()== R.id.item1){
        WV.reload(); 
        return true;
    }
    return super.onOptionsItemSelected(item);
} 
```

请参阅[WebView 文档](http://developer.android.com/reference/android/webkit/WebView.html)

# c++ - OpenCV C++ 列出目录中的文件？

> ID：11563911
> 
> 赞同：3
> 
> 时间：2012-07-19T15:15:41.673
> 
> 标签：c++, opencv

我正在使用 OpenCV 开发一个 C++ 项目。我正在考虑使用 Boost 库来做一个简单的 ls，但我想遵循 opencv 标准..

如何使用 opencv 进行跨平台列出文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:28:11.093

OpenCV 并不是为了解决这些问题而创建的——你必须使用另一个 API。看看[这个 stacloverflow 讨论](https://stackoverflow.com/questions/612097/how-can-i-get-a-list-of-files-in-a-directory-using-c-or-c)。它似乎是跨平台的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-26T09:27:35.553

有一个标题

opencv2\contrib\contrib.hpp

它包含一个名为 Directory 的类和一些像 GetListFiles 这样的函数，

GetListFolders 和 GetListFilesR。

你可以试试看，但在 Opencv3 中不可用。

# android - BluetoothServerSocket.accept() 不会在接受线程中返回，同时获取客户端套接字

> ID：11563913
> 
> 赞同：4
> 
> 时间：2012-07-19T15:15:53.493
> 
> 标签：android, bluetooth, serversocket

所以我有这个Android蓝牙项目，我遇到了一个非常烦人的问题；让我描述一下上下文：

将要连接的两部手机使用 android 开发者网站（[此处](http://developer.android.com/guide/topics/connectivity/bluetooth.html)）上的蓝牙文档中描述的确切方法获取它们的蓝牙套接字；因此，我使用以下线程进行连接：

```
private class AcceptThread extends Thread {
    private final BluetoothServerSocket mmServerSocket;

    public AcceptThread() {
        // Use a temporary object that is later assigned to mmServerSocket,
        // because mmServerSocket is final
        BluetoothServerSocket tmp = null;
        try {
            // MY_UUID is the app's UUID string, also used by the client code
            tmp = mBluetoothAdapter.listenUsingRfcommWithServiceRecord(NAME, MY_UUID);
        } catch (IOException e) { }
        mmServerSocket = tmp;
    }

    public void run() {
        BluetoothSocket socket = null;
        // Keep listening until exception occurs or a socket is returned
        while (true) {
            try {
                socket = mmServerSocket.accept();
            } catch (IOException e) {
                break;
            }
            // If a connection was accepted
            if (socket != null) {
                // Do work to manage the connection (in a separate thread)
                manageConnectedSocket(socket);
                try {
                    mmServerSocket.close();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                break;
            }
        }
    }

    /** Will cancel the listening socket, and cause the thread to finish */
    public void cancel() {
        try {
            mmServerSocket.close();
        } catch (IOException e) { }
    }
} 
```

那是接受线程，

```
private class ConnectThread extends Thread {
    private final BluetoothSocket mmSocket;
    private final BluetoothDevice mmDevice;

    public ConnectThread(BluetoothDevice device) {
        // Use a temporary object that is later assigned to mmSocket,
        // because mmSocket is final
        BluetoothSocket tmp = null;
        mmDevice = device;

        // Get a BluetoothSocket to connect with the given BluetoothDevice
        try {
            // MY_UUID is the app's UUID string, also used by the server code
            tmp = device.createRfcommSocketToServiceRecord(MY_UUID);
        } catch (IOException e) { }
        mmSocket = tmp;
    }

    public void run() {
        // Cancel discovery because it will slow down the connection
        mBluetoothAdapter.cancelDiscovery();

        try {
            // Connect the device through the socket. This will block
            // until it succeeds or throws an exception
            mmSocket.connect();
        } catch (IOException connectException) {
            // Unable to connect; close the socket and get out
            try {
                mmSocket.close();
            } catch (IOException closeException) { }
            return;
        }

        // Do work to manage the connection (in a separate thread)
        manageConnectedSocket(mmSocket);
    }

    /** Will cancel an in-progress connection, and close the socket */
    public void cancel() {
        try {
            mmSocket.close();
        } catch (IOException e) { }
    }
} 
```

那就是 ConnectThread；（你可能会注意到它们确实是从上面的链接复制的）；

问题是在尝试连接的时候，connectthread实际上返回了一个socket（调用managesocket()），但是接受线程却停留在socket = mmServerSocket.accept()，就好像什么都不会发生一样；但是AcceptThread中确实发生了一些事情，因为当我从另一台设备（具有ConnectThread的设备）启动连接时，正在更新接受设备的logcat；有时连接实际上是正确创建的，但只有在强制关闭、禁用->启用蓝牙等之后。

这是 logcat 中有趣的一行（我猜是由 .accept() 调用生成的）：

07-19 18:04:47.484: D/BLZ20_WRAPPER(3143): btlif_signal_event: ### 事件 BTLIF_BTS_RFC_CON_IND 不匹配 ###

那么可能是什么问题呢？

# servicestack - 在端口 80 SxS IIS 上运行自托管（Windows 服务）ServiceStack http 侦听器

> ID：11563914
> 
> 赞同：0
> 
> 时间：2012-07-19T15:15:53.030
> 
> 标签：servicestack

我们正在使用 ServiceStack 从 ASMX -> RESTful 重写我们的服务，因此短期内需要保持 IIS 和经典服务在端口 80 上运行。此外，我们的一些客户在下面托管多个 Web 应用程序（例如公司内部网） IIS 监听 80 端口。

我的应用程序需要分发给数百个客户，因此我想摆脱 IIS 依赖项，以便让我的更新部署更简单（如果可能的话）。我们也有很多客户在他们的路由器中为端口 80 设置了特殊的转发，因此在不同的端口上监听 SS 服务会导致很多部署痛苦——更不用说大多数防火墙对端口 80 流量更宽松。

我有两个可能的相关问题：
1\. 当我可以让 SS 在端口 80 上启动时，我会得到 " `handler not found`" 表示原本可以在另一个端口上工作的路由。
2.在调试（启动/调试/停止/重新启动）时，最终监听器注册似乎“粘住”，我最终得到：

```
System.Net.HttpListenerException (0x80004005): Failed to listen on prefix 'http://*:80/' because it conflicts with an existing registration on the machine.
   at System.Net.HttpListener.AddAllPrefixes()
   at System.Net.HttpListener.Start()
   at ServiceStack.WebHost.Endpoints.Support.HttpListenerBase.Start(String urlBase) in C:\src\ServiceStack\src\ServiceStack\WebHost.Endpoints\Support\HttpListenerBase.cs:line 122
   at FieldCommService.FieldCommService.ConfigureServices() in e:\Development\Source\Hg\fieldcomm\src\Services\FieldCommService\FieldCommService.cs:line 305
   at FieldCommService.FieldCommService.Startup() in e:\Development\Source\Hg\fieldcomm\src\Services\FieldCommService\FieldCommService.cs:line 84 
```

我不排除在 IIS 下托管服务作为解决方案，我只是不想承担/继续承担 IIS 带来的配置和部署痛苦。

我有两个问题：
1\. [使用 AppHostHttpListenerBase] 作为自托管服务收听 :80 是否可行？
2\. 在 AppHostHttpListenerBase 的智能感知中，注意到该类旨在允许侦听 IIS 旁边的端口 80，但需要“管理员用户权限”。这在作为服务运行的 Windows 下意味着什么？属于管理员组的身份？或者只是“本地系统”？

# java - 列表视图 - 在菜单选择时设置 View.GONE 不会立即隐藏

> ID：11563916
> 
> 赞同：0
> 
> 时间：2012-07-19T15:16:02.183
> 
> 标签：java, android, listview, visibility

**TLDR：**

我正在设置`myListView.setVisibility(View.GONE);`，但它直到稍后才消失......我是否需要以某种方式让它知道我已经改变了它的可见性？或者我是否还需要隐藏它的内部元素或其他东西？

**问题描述：**

我有一个普通的新闻应用程序。您会看到“主要”部分的文章列表，然后您可以单击选项以选择新部分。

当用户单击时，部分标题发生了变化，但列表中的文章将与“旧”内容一起坐在那里，直到加载新内容，然后它会闪烁到新内容。

这显然并不理想。我希望列表消失，显示加载动画，然后，在检索到新数据（从数据库或在线，然后是数据库）后，它会显示新内容。

我发现[这个 SO 问题](https://stackoverflow.com/questions/5442183/using-the-animated-circle-in-an-imageview-while-loading-stuff)似乎是我想要的，但是......

我在选择菜单后立即设置 GONE ，然后在导入文章并加载新文章后设置为 VISIBLE ......但在此期间它根本没有消失。我知道 GONE 代码有效，因为如果我删除我的 VISIBLE 代码，文章将永远不会重新出现。

我需要说“View.GONE”，然后告诉它更新它的可见性还是什么？

* * *

**我的代码（MainActivity）：**

```
public static void sectionSelected()
{

    String selectedText = sectionsSpinner.getSelectedItem().toString();
    String[] selectedSection = Section.stringToSection(selectedText);

    //check if it was already the current section
    if(!Section.isEqual(Section.currentSection, selectedText))
    {

        //hides list of articles
        articleEntryListView.setVisibility(View.GONE);

        //sets new currentSection
        Section.currentSection = selectedSection; // Section.stringToSection(sectionsSpinner.getSelectedItem().toString());

        //imports articles (if it's been more than an hour since last import)
        articlesDataSource.importArticles(Section.currentSection, true, false);

        //loads article from database to the list
        loadArticlesIntoList(Section.currentSection);
    }
}

public static void loadArticlesIntoList(String[] section)
{
    //clears the list
    //articleEntryAdapter.clear(); //don't think I need this now that I'm just going to hide it
    //articleEntryAdapter.notifyDataSetChanged();

    //POPULATES THE LIST OF ARTICLES, THROUGH THE ADAPTER
    for(final Article a1 : articlesDataSource.getArticles(section))
    {
        articleEntryAdapter.add(a1);
    }
    articleEntryAdapter.notifyDataSetChanged();

    //shows list of articles
    articleEntryListView.setVisibility(View.VISIBLE);
} 
```

**补充：**这是我的 importAricles() 代码：[http ://pastebin.com/8j6JZBej](http://pastebin.com/8j6JZBej)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:30:49.470

每当您更改视图的外观时，您都必须使视图无效，因此请`articleEntryListView.invalidate()`在设置可见性后调用 。

# vb.net - 具有相同字段先前值的 Vb.Net RDLC 总和字段

> ID：11563917
> 
> 赞同：1
> 
> 时间：2012-07-19T15:16:03.347
> 
> 标签：vb.net, rdlc, vb.net-2010

至此，我在 Visual Studio 2010 Vb.Net 上使用报表向导创建了一个报表。布局几乎是这样的：

```
 DEBIT               CREDIT               BALANCE (FYI, this is an Expression)
      -----------------------------------------------------------------
         DValue1              CValue1           DValue1-CValue1 
         DValue2              CValue2           DValue2-CValue2+DValue1-CValue1
         etc...
      -----------------------------------------------------------------
Total    DTotal               CTotal 
```

我设法创建了 DTotal 和 CTotal，当我想用​​表达式创建平衡时有问题。

我试过这个表达式，还是不行。 `=Sum(Fields!Debet.Value)-Sum(Fields!Credit.Value)+Previous(Fields!Debet)-Previous(Fields!Debet)`. 这个表达式返回一个错误，我不应该在另一个聚合中使用聚合。

请帮我解决一下这个。即使在 google 上也没有很多 rdlc 相关的教程。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:20:49.373

未经测试，但我相信您正在寻找[`RunningValue`功能](http://msdn.microsoft.com/en-us/library/ms251660%28v=vs.80%29.aspx)：

```
=RunningValue(Fields!Debet.Value,Sum,"MyGroupName") - RunningValue(Fields!Credit.Value,Sum,"MyGroupName") 
```

# java - 如何创建将保存静态哈希图的“单例”Bean

> ID：11563919
> 
> 赞同：0
> 
> 时间：2012-07-19T15:16:16.530
> 
> 标签：java, spring, concurrency, singleton, spring-3

我需要共享静态哈希映射，它将使用 Spring 3.1 在运行时初始化。

我需要创建一个真正的单例 bean（不一定是单例范围）来保存我所有的静态哈希图。

hashmap 也可以在运行时修改，并且它必须可用于我所有的 spring bean。

1.  只要应用程序正在运行，保存静态映射的 bean 就必须处于活动状态
2.  所有spring bean都需要访问bean。
3.  哈希图需要是并发的和线程安全的。hashmap 可能有 100 个条目，并且会以非常高的速率访问。

我怎么能做到这一点？提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:41:56.293

我同意@Kevin 的评论（`ConcurrentHashMap`豆类），但刚刚发现不错的 Spring 3.1 补充：[`ConcurrentMapCacheFactoryBean`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/cache/concurrent/ConcurrentMapCacheFactoryBean.html). 文档说：

> [FactoryBean](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/FactoryBean.html)用于在 Spring 容器中使用时轻松配置[ConcurrentMapCache 。](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/cache/concurrent/ConcurrentMapCache.html)

我还发现[了这篇博客文章](http://www.silviowangler.ch/2011/09/26/using-caches-in-grails-2-0/)，它建议使用带有`@Cacheable`注释的 bean：

```
<bean id="cacheManager"
        class="org.springframework.cache.support.SimpleCacheManager">
    <property name="caches">
        <set>
            <bean class="org.springframework.cache.concurrent.ConcurrentMapCacheFactoryBean"
                  p:name="default"/>
        </set>
    </property>
</bean> 
```

还没有尝试过，但似乎与 Spring 的东西很好地集成在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:33:06.247

我不是 100% 了解您的需求，但您可以通过第[3.5.5 节自定义范围](http://static.springsource.org/spring/docs/3.0.x/reference/beans.html)创建自己的范围，这将确保纯单例实例并可注入所有 bean。并且可能您可以通过使用适当的同步方法或映射来解决线程安全问题

# jquery - JqPlot 崩溃 jQuery 移动 JS

> ID：11563921
> 
> 赞同：0
> 
> 时间：2012-07-19T15:16:21.397
> 
> 标签：jquery, jquery-mobile, jqplot

我在 jquery 移动页面上运行 jqPlot 图。图表页面是主页的子站点。主页有几个指向其他子页面的链接。子页面下没有其他子页面。

当我从主页导航到图表页面时，它看起来很好。当我不使用返回按钮（jQuery Mobile 在标题中的一个，而不是浏览器导航）时，MainPage 再次显示。此时 jQuery mobile 似乎崩溃了，没有链接工作了。页面被冻结。

我稍后会发布一些代码。

也许以前有人遇到过同样的问题？有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T06:41:20.260

好的，我发现，这似乎是一个常见的问题。由于某些原因，jqPlot js 将使所有 ajax 请求崩溃。

[将Json数据加载到jqPlot](https://stackoverflow.com/questions/3535680/problem-with-json-and-jqplot?rq=1) 和 [jqplot与jquerymobile冲突](https://stackoverflow.com/questions/8397651/jqplot-conflict-with-jquerymobile?rq=1)

有一些解决方法，但实际上并没有完全解决。

# perl - 为什么我的 perl 代码导致我的字符串接收 ARRAY(0xc99b3c) 而不是字符串的内容？

> ID：11563923
> 
> 赞同：2
> 
> 时间：2012-07-19T15:16:24.477
> 
> 标签：perl, data-structures, reference

正如您从下面的 Perl 代码片段中看到的那样，我将`$document`字符串（包含来自文本文档的文本）放入一个`@document`数组中。`$document`然后在停止之前打印出来。然后我对`@document`数组进行词干处理，然后将词干结果放入我的`$stemmed_words_anon_array`字符串中，但我得到：`ARRAY(0xc99b3c)`这就像一个内存地址。

我究竟做错了什么？我的`results_stemmed.txt`也包含在`ARRAY(0xc99b3c)`里面。

```
# Put string of main document into an array
my @document = split(' ', $document);

# Print the $document string to check it before stemming it
print $document;

open (FILE_STEM, '>results_stemmed.txt');
use Lingua::Stem qw(stem);
my $stemmed_words_anon_array = stem(@document);
# $stemmed_words_anon_array is just receiving: ARRAY(0xcbacb) here
print FILE_STEM $stemmed_words_anon_array;
close(FILE_STEM);
print $stemmed_words_anon_array; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:20:54.193

这是一个参考。 `@$stemmed_words_anon_array`会给你阵列本身。有关如何在 Perl 中处理引用的更多信息，请参阅[`perldoc perlref`](http://perldoc.perl.org/perlref.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T10:12:50.937

Lingua::Stem 模块的文档有点不清楚。作为用户，您并不关心它是一个匿名数组。您关心它是对匿名数组的引用。

当然，您只能通过引用访问匿名数组，但有时人们并没有意识到这一点。

当我在我的培训课程中介绍参考资料时，我总是向人们展示一个人的样子。并告诉他们他们不需要知道这一点，但在某些时候，当他们打算打印引用的变量时，他们会意外地打印一个引用 - 所以能够识别它很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T18:05:02.727

您可以使用[File::Slurp::write_file](http://search.cpan.org/perldoc/File%3a%3aSlurp)快速写入以下内容的全部内容`@$stemmed_words_anon_array`：

```
use File::Slurp qw( write_file );
use Lingua::Stem qw( stem );

my $stemmed_words = stem(split ' ', $document);
write_file 'results_stemmed.txt', $stemmed_words;
print "@$stemmed_words\n"; 
```

# objective-c - 修改自定义 UISlider

> ID：11563930
> 
> 赞同：1
> 
> 时间：2012-07-19T15:16:42.480
> 
> 标签：objective-c, ios, xcode, cocoa-touch, uislider

所以我有一个使用以下代码制作的自定义 UISlider：

```
UIImage *minImage = [UIImage imageNamed:@"settings_slider_fill.png"];
UIImage *maxImage = [UIImage imageNamed:@"settings_slider_empty.png"];
UIImage *tumbImage= [UIImage imageNamed:@"settings_slider_handle.png"];
minImage=[minImage stretchableImageWithLeftCapWidth:10.0 topCapHeight:0.0];
maxImage=[maxImage stretchableImageWithLeftCapWidth:10.0 topCapHeight:0.0];

[thresholdSlider setMinimumTrackImage:minImage forState:UIControlStateNormal];

[thresholdSlider setMaximumTrackImage:maxImage forState:UIControlStateNormal];

[thresholdSlider setThumbImage:tumbImage forState:UIControlStateNormal]; 
```

然而，这给了我一个左端有一个丑陋的方形端的滑块。我有一张我想用于左帽的图像，但我不知道如何以编程方式将其设置为这样。

这是我要使用的左端盖图像： ![在此处输入图像描述](../Images/94310783e795f8035e928ec627fe62c7.png)

这是我正在使用的填充图像： ![在此处输入图像描述](../Images/08a757f951f9e3b5cb7b590f52eb9ddc.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:43:55.020

事实证明，我可以只使用端点并将其拉伸，而不是尝试分配一个专用的左帽。

# git - SSHing git@github.com 显示错误/旧 SSH 密钥

> ID：11563936
> 
> 赞同：5
> 
> 时间：2012-07-19T15:17:00.920
> 
> 标签：git, ssh, github, ssh-keys

k，所以我正在设置[Git](http://git-scm.com/ "Git主页")并按照[本教程](https://help.github.com/articles/generating-ssh-keys)设置 SSH 密钥。指纹是`16:27:...:a6:48`。我安装了[适用于 Windows 的 GitHub 客户端，](http://windows.github.com/)它设置了一个在文件夹中自动调用的新 SSH`github_rsa`密钥`%user%/.ssh/`。

我删除了“旧”SSH 密钥（不要问我为什么）并使用指纹设置了一个新密钥`a6:17:ed:4a:1d:9a:c7:63:6a:a1:38:8b:96:e3:91:bf`我只是删除了以前的`id_rsa`密钥和`known_hosts`文件然后用来`ssh-keygen`制作另一个 - 我没有弄乱 GitHub钥匙）。

现在，每当我尝试 ssh into`git@github`时，它都会说：

> 无法建立主机 'github.com (207.97.227.239)' 的身份验证 RSA 密钥指纹是 16:27:...:a6:48 确定要继续连接（是/否）？

这不是我想要的。它显示了我删除的旧 SSH 密钥（连同`known_hosts`）。我该怎么办？

**[编辑]：**我（错误地）假设终端输出的指纹与*我的*公共 RSA 密钥的指纹匹配。我仍然对 SSH 有疑问，但与此无关（问题已经被问过，请阅读：[Git push requires username and password](https://stackoverflow.com/questions/6565357/git-push-requires-username-and-password)）。我会删除这个问题，但它不允许我说“它有 1 个或多个答案。请标记它以引起版主注意。” _即使是我的。阅读更多：[https ://meta.stackexchange.com/questions/140646/what-should-i-do-if-i-realize-the-premise-of-a-question-was-faulty-but-i-已读/140676#140676](https://meta.stackexchange.com/questions/140646/what-should-i-do-if-i-realize-the-premise-of-a-question-was-faulty-but-i-alread/140676#140676)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-19T16:12:02.373

我认为你应该编辑你的`<USER>/.ssh/config`文件（或创建它）

```
Host github.com
User <USER>
IdentityFile ~/.ssh/github_rsa

Host *
User <USER>
IdentityFile ~/.ssh/id_rsa 
```

如果发生的事情就是你所说的，那就可以了。

但也许这不是问题，因为*第 5 步：测试*链接中的所有内容表明您可能会看到以下警告：

```
# The authenticity of host 'github.com (207.97.227.239)' can't be established.
# RSA key fingerprint is 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48.
# Are you sure you want to continue connecting (yes/no)? 
```

你不应该担心，这应该会发生。只需验证指纹与此处的指纹是否匹配，然后键入“是”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:20:57.607

由于您删除了 known_hosts 文件，ssh-agent 将给出以下警告：

> 无法建立主机 'github.com (207.97.227.239)' 的身份验证 RSA 密钥指纹是 16:27:...:a6:48 确定要继续连接（是/否）？

它第一次尝试连接到此主机以及您通过 SSH 连接到的任何其他主机时。对于您说“是”的每个新主机，主机的指纹都会添加到**known_hosts**文件中。

如果您每次都收到警告，那么您有一个更大的问题，即您的 known_hosts 文件没有被 ssh 写入或读回。您也可以在每次通过 SSH 连接到其他计算机时验证是否收到此警告消息。

[进一步阅读](http://amath.colorado.edu/computing/unix/sshknownhosts.html)

# javascript - 未捕获的类型错误：对象# 没有方法“RedrawWorkflow”

> ID：11563941
> 
> 赞同：0
> 
> 时间：2012-07-19T15:17:21.683
> 
> 标签：javascript

我有以下代码，它适用于 IE，但不适用于 Chrome：

```
<object id="WorkFlowGraph" name="WorkFlowGraph" width="800px" height="600px" classid="clsid:1E595677-765C-4B01-9B60-59AEE2BFAB2C" codebase="../../CAM/Scripts/WFDesigner3.ocx#Version=-1,-1,-1,-1"></object> 
```

然后在Javascript中：

```
document.WorkFlowGraph.NextStepID              = document.frmProcess.hidNextStepID.value;
document.WorkFlowGraph.ComponentsXML           = FixupString(document.frmProcess.hidComponentXML.value);
document.WorkFlowGraph.WorkflowXMLIn           = FixupString(document.frmProcess.hidWorkflowXML.value);
document.WorkFlowGraph.IsWorkflowAllowRevision = document.frmProcess.hidIsAllowRevision.value.toString() == 'true' ? true:false;
document.WorkFlowGraph.RedrawWorkflow(); 
```

我在 document.WorkFlowGraph.RedrawWorkflow() 上遇到错误；

它抛出这个错误：

**未捕获的类型错误：对象 # 没有方法“RedrawWorkflow”**

我已经搜索和搜索，无法弄清楚。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:08:03.793

显然这是一个活动的 x 控件...

Active X 是 IE 独有的功能。我为 Chrome 安装了 IE Tab 扩展程序，它现在提示运行。这解决了它。

# scala - 反射可以提取特征中使用的初始值吗？

> ID：11563954
> 
> 赞同：5
> 
> 时间：2012-07-19T15:18:04.563
> 
> 标签：scala, reflection, scala-2.10

我正在玩反思，以对一个特征进行深入分析。我想得到的一件事是设置为成员字段的初始值。例如，在特征中：

```
trait A {
  val x: Int = 3
  val y: String = "y"
} 
```

很高兴知道 3 和“y”。我在 API 中没有找到与此任务相关的任何内容，并且由于以下输出（由 scalac -Xprint 生成）：

```
abstract trait A extends Object {
  <accessor> def com$hablapps$A$_setter_$x_=(x$1: Int): Unit;
  <accessor> def com$hablapps$A$_setter_$y_=(x$1: String): Unit;
  <stable> <accessor> def x(): Int;
  <stable> <accessor> def y(): String
};
abstract trait A$class extends  {
  def /*A$class*/$init$($this: com.hablapps.A): Unit = {
    $this.com$hablapps$A$_setter_$x_=(3);
    $this.com$hablapps$A$_setter_$y_=("y");
    ()
  }
} 
```

恐怕很难访问它们，因为它们保存在 $init$ 方法的主体中。有没有（简单的）方法可以通过反射获得这些值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:10:23.800

您必须反汇编字节码：

```
trait A { val x: Int = 3 }

public abstract class A$class extends java.lang.Object{
public static void $init$(A);
  Code:
   0:    aload_0
   1:    iconst_3
   2:    invokeinterface #12,  2; //InterfaceMethod A.A$_setter_$x_$eq:(I)V
   7:    return 
```

请参见第 1 行——该值存在的唯一位置是 init 方法的字节码！

您无法以任何其他方式达到此目的，因为如果您有

```
trait A { val x: Int = 3 }
trait B extends A { override val x = 7 }
class C extends B {} 
```

你会发现，`C`extends`A$_setter_$x_$eq`根本没有做任何事情——使`A$class.$init$`调用成为无操作并使值无法检索。

证明：

```
public class C extends java.lang.Object implements B,scala.ScalaObject{
public void A$_setter_$x_$eq(int);
  Code:
   0:    return

public void B$_setter_$x_$eq(int);
  Code:
   0:    aload_0
   1:    iload_1
   2:    putfield #11; //Field x:I
   5:    return 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:01:39.440

我怀疑你能反省到这一点。这不是关于类型的信息，而是代码。如果您有该特征的树，则可以找到它，但是，否则，我对此表示怀疑。

但是，您可以使用类文件解析器来进一步调查。我假设这些将作为类的常量出现，可以读取。我不确定您是否可以将它们与变量相关联，但是...

我对类文件解析器不太熟悉，但我认为一个名为“asm”的工具可以做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T14:11:18.100

您可以使用 Java 的 Proxy 创建一个 trait 实例，该实例从对 trait 的 ...$ *setter* $... 方法的所有调用中收集值。这是一个骇人听闻的例子：

```
object Reflection {
  def traitInits(clazz : Class[_]) : Map[String, Object] = {
    var cl = clazz.getClassLoader
    if (cl == null) {
      cl = ClassLoader.getSystemClassLoader
    }

    var init : Option[java.lang.reflect.Method] = None
    try {
      for (m <- cl.loadClass(clazz.getName + "$class").getMethods if init.isEmpty)
        if (m.getName == "$init$")
          init = Some(m)
    } catch {
      case e : Exception =>
    }

    if (init.isEmpty) return Map()

    var encodedToDecodedSetterNameMap = Map[String, String]()

    for (m <- clazz.getDeclaredMethods()) {
      val setterPrefix = clazz.getName.replace('.', '$') + "$_setter_$"
      val encoded = m.getName
      if (encoded.startsWith(setterPrefix)) {
        val decoded = encoded.substring(setterPrefix.length, encoded.length - 4)
        encodedToDecodedSetterNameMap += (encoded -> decoded)
      }
    }

    var result = Map[String, Object]()

    import java.lang.reflect.InvocationHandler
    import java.lang.reflect.Proxy

    init.get.invoke(null, Proxy.newProxyInstance(cl, Array[Class[_]](clazz),
      new InvocationHandler {
        def invoke(proxy : Object,
                   method : java.lang.reflect.Method,
                   args : Array[Object]) = {
          encodedToDecodedSetterNameMap.get(method.getName) match {
            case Some(decodedName) => result += (decodedName -> args(0))
            case _                 =>
          }
          null
        }
      }))

    result
  }                                               //> traitInits: (clazz: Class[_])Map[String,Object]

  trait A {
    val x : Int = 3
    val y : String = "y"
  }

  traitInits(classOf[A])                          //> res0: Map[String,Object] = Map(x -> 3, y -> y)
} 
```

# php - 使用不同的名称服务器解析 PHP 中的主机名

> ID：11563956
> 
> 赞同：16
> 
> 时间：2012-07-19T15:18:08.223
> 
> 标签：php, dns, nslookup

如何使用 PHP 将主机名解析为 IP 地址，但使用不同的名称服务器（例如[OpenDNS](http://www.opendns.com/)或[Google Public DNS](https://developers.google.com/speed/public-dns/)）。

似乎无法使用`dns_get_record()`与`gethostbyname()`系统上当前设置的名称服务器不同的名称服务器（在 TCP/IP 设置中或在 中`/etc/resolv.conf`）。

我发现的唯一方法是使用 PEAR 类 Net/DNS，但它在 PHP 5.4 下给了我很多警告

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T18:52:10.270

```
<?
require_once 'Net/DNS2.php';

$resolver = new Net_DNS2_Resolver( array('nameservers' => array('208.67.222.123')) );

$resp = $resolver->query("hooktube.com.", 'A');

print_r($resp);

echo $resp->answer[0]->address; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-19T16:50:26.717

试试[net_dns2](http://pear.php.net/package/Net_DNS2/redirected)（它也在 PEAR 中）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-19T18:26:47.327

如果您被允许从您的脚本运行 shell 脚本，您可以使用系统的`nslookup`命令。

```
$host = 'stackoverflow.com';
$dns = '8.8.8.8';  // Google Public DNS

$ip = `nslookup $host $dns`; // the backticks execute the command in the shell

$ips = array();
if(preg_match_all('/Address: ((?:\d{1,3}\.){3}\d{1,3})/', $ip, $match) > 0){
    $ips = $match[1];
}

print_r($ips); 
```

注意：使用`escapeshellarg`if`$host`和`$dns`are 来自用户输入。

# android - Android AsyncTask ExceptionInIntilizationError

> ID：11563957
> 
> 赞同：0
> 
> 时间：2012-07-19T15:18:09.780
> 
> 标签：android, android-asynctask

我正在尝试创建一个基本的 AsyncTask 以从密钥库中获取证书。

出于某种原因，即使是最简单的 AsyncTask 也不适合我，我不断收到有关 ExceptionInIntilizationError 的错误。

这是我用来让基本异步任务工作的测试代码：

```
public class Authenticator extends Activity {

PrivateKey privateKey = null;
String SavedAlias = "";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    getCertificates("TEST");

    doSomething();

}

public void doSomething()
{
    new additionalStuff().execute();
}

public class AliasLoader extends AsyncTask<Void, Void, X509Certificate[]> 
{
    X509Certificate[] chain = null;

    @Override protected X509Certificate[] doInBackground(Void... params) {
        android.os.Debug.waitForDebugger();

        if(!SavedAlias.isEmpty())
        {
                try {
                    chain = KeyChain.getCertificateChain(getApplicationContext(),SavedAlias);
                } catch (Exception e) {
                    // TODO Auto-generated catch block
                }
        }
        else
        {
            this.cancel(true);
        }

        return chain;
    }
    @Override protected void onPostExecute(X509Certificate[] chain) 
    {
        try {
            privateKey = KeyChain.getPrivateKey(getApplicationContext(), SavedAlias);
        } catch (Exception e) {
            Toast.makeText(getApplicationContext(), e.getMessage(), Toast.LENGTH_LONG).show();
        }

        if (privateKey != null) {
            Signature signature = null;
            try {
                signature = Signature.getInstance("SHA1withRSA");
            } catch (NoSuchAlgorithmException e) {
                Toast.makeText(getApplicationContext(), e.getMessage(), Toast.LENGTH_LONG).show();
            }
            try {
                signature.initSign(privateKey);
            } catch (InvalidKeyException e) {
                Toast.makeText(getApplicationContext(), e.getMessage(), Toast.LENGTH_LONG).show();
            }
        }
    }
}

public void getCertificates(String Host)
{
    KeyChainAliasCallback callBack = new KeyChainAliasCallback() {

        @Override
        public void alias(String alias) {
            if (alias != null) 
            {
                saveAlias(alias);
                //doSomething();
            }
        }
    };

    KeyChain.choosePrivateKeyAlias(this, callBack,
    new String[] {"RSA", "DSA"}, // List of acceptable key types. null for any
    null,                        // issuer, null for any
    null,      // host name of server requesting the cert, null if unavailable
    443,                         // port of server requesting the cert, -1 if unavailable
    null);                       // alias to preselect, null if unavailable

}

public void saveAlias(String alias)
{
    SavedAlias = alias;
}

public class additionalStuff extends AsyncTask<String, String, Void>
{
    String test = "This is a Test!!!";

    @Override
    protected void onPreExecute() 
    {
    }
    @Override
    protected Void doInBackground(String... params) {
        return null;
    }

    @Override
    protected void onProgressUpdate(String... values) 
    {
            super.onProgressUpdate(values);
    }
    @Override
    protected void onPostExecute(Void unused) 
    {
        Log.d("DEEPAM", "THIS IS A TEST");
        return;
    }

}
} 
```

为什么会失败？=(

** 更新 ** 我进行了更改以在执行后添加 @Override 和参数 Void Void ，它仍然出现相同的 ExceptionInInitilizationError =(

**更新**

我猜我无法在 UI 中使用 Asynctask 创建一个新线程，这可能是它之前失败的原因，无论如何我可以在用户选择证书后调用 AsyncTask 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:27:04.637

为什么你的 onPostExecute 没有标签“@override”和任何参数？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T09:22:28.693

我发现了问题，whatappserv、Vladimir 和 n_benbourahla 提到的问题可能会在我最初的错误得到解决后成为问题。

基本上我忘了添加一些正在使用执行的代码。我在 KeyChain.choosePrivateKeyAlias 的回调中调用 doSomething.execute()。

它看起来像是把它放在外面并且 asynctask 工作正常。

我仍然有一个问题，我如何在 keychain.choosePrivateAlias 的回调中调用 asynctask，因为它必须只在执行后才运行。我将用我现在拥有的更新代码。

# php - 使用继承的变量生成 HTML - 一种更清洁的方法？

> ID：11563960
> 
> 赞同：1
> 
> 时间：2012-07-19T15:18:16.093
> 
> 标签：php

我的网站在页面顶部有导航，包含在我的所有页面中。看起来像：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>My Title</title>
</head>
<body>

<? 
 $selected = 'home';
 include('include/header.php'); 
?> 
```

该`header.php`文件基本上显示了每个页面上标准的顶部导航。上面是一个由`header.php`文件继承的变量，用于“告诉”用户所在的头文件，以便可以选择适当的导航选项卡。

我的`header.php`文件看起来像：

```
<div id="main_navigation">
      <ul id="nav">
        <li><a href="#">HOME</a></li>
        <li><a href="#">ABOUT US</a></li>
        <li><a href="#">PURCHASE</a></li>
        <li><a href="#">SOMETHING ELSE</a></li>
      </ul>
</div> 
```

我想要做的是将 HTML 添加到`<li>`标签中以显示一个 CSS 类，该类将突出显示导航选项卡。除了抛出这个丑陋的片段之外，还有没有更雄辩的方法来做到这一点：

```
<div id="main_navigation">
      <ul id="nav">
        <li <? if($selected == 'home'){ print "class = \"select"\"; ?> ><a href="#">HOME</a></li>
        <li <? if($selected == 'about'){ print "class = \"select"\"; ?> ><a href="#">ABOUT US</a></li>
        <li <? if($selected == 'purchase'){ print "class = \"select"\"; ?> ><a href="#">PURCHASE</a></li>
        <li <? if($selected == 'something'){ print "class = \"select"\"; ?> ><a href="#">SOMETHING ELSE</a></li>
      </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:29:00.747

这似乎相当标准，但您可以使用三元运算符更简洁地做到这一点：

```
<li class="<?php echo ($selected == 'home') ? 'select' : ''; ?>"> 
```

但我认为这主要是风格问题。更好的是在 html 之外处理这些位。然后将 4 个变量传递给 header.php，然后像这样编写列表：

```
<li class="<?php echo $home_class; ?>"> . . .
<li class="<?php echo $about_class; ?>"> . . . 
```

等等

通过这种方式，您可以将所有逻辑排除在 html 之外。在这种情况下，最大的收获可能是您可以将逻辑转换为如下所示的函数：

```
function get_menu_item_class($menu_item) {
  if (/* whatever logic to determine if it's selected based on passed parameter */) {
    return 'select';
  }

  return '';
} 
```

然后你可以很容易地填充变量：

```
$home_class = get_menu_item_class('home');
$about_class = get_menu_item_class('about'); 
```

等等

或者可能完全放弃变量，直接调用函数：

```
<li class="<?php echo get_menu_item_class('home'); ?>"> ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:23:38.753

使用循环和数组：

```
$nav = array( '#' => 'HOME');

echo '<ul id="nav">';
foreach( $nav as $href => $text) {
    $class = ($selected == 'home') ? ' class="select"' : '';
    echo '<li' . $class . '><a href="' . $href . '">' . $text . '</a></li>';
}
echo '</ul>'; 
```

如果所有的`href`值真的是`#`，那么你可以在数组的定义中省略它们：

```
$nav = array( 'HOME', 'ABOUT US'); 
```

然后，省略在循环中包含它：

```
 echo '<li' . $class . '><a href="#">' . $text . '</a></li>'; 
```

# c++ - 如何在 C++ 中快速将大缓冲区写入二进制文件？

> ID：11563963
> 
> 赞同：273
> 
> 时间：2012-07-19T15:18:23.343
> 
> 标签：c++, performance, optimization, file-io, io

我正在尝试将大量数据写入我的 SSD（固态驱动器）。大量我的意思是80GB。

我在网上浏览了解决方案，但我想出的最好的是：

```
#include <fstream>
const unsigned long long size = 64ULL*1024ULL*1024ULL;
unsigned long long a[size];
int main()
{
    std::fstream myfile;
    myfile = std::fstream("file.binary", std::ios::out | std::ios::binary);
    //Here would be some error handling
    for(int i = 0; i < 32; ++i){
        //Some calculations to fill a[]
        myfile.write((char*)&a,size*sizeof(unsigned long long));
    }
    myfile.close();
} 
```

该程序使用 Visual Studio 2010 和全面优化编译并在 Windows7 下运行，最大速度约为 20MB/s。真正困扰我的是，Windows 可以以 150MB/s 到 200MB/s 之间的速度将文件从另一个 SSD 复制到这个 SSD。所以至少快 7 倍。这就是为什么我认为我应该能够走得更快。

有什么想法可以加快写作速度吗？

* * *

## 回答 #1

> 赞同：269
> 
> 时间：2012-07-19T16:11:11.490

这完成了工作（在 2012 年）：

```
#include <stdio.h>
const unsigned long long size = 8ULL*1024ULL*1024ULL;
unsigned long long a[size];

int main()
{
    FILE* pFile;
    pFile = fopen("file.binary", "wb");
    for (unsigned long long j = 0; j < 1024; ++j){
        //Some calculations to fill a[]
        fwrite(a, 1, size*sizeof(unsigned long long), pFile);
    }
    fclose(pFile);
    return 0;
} 
```

我刚刚在 36 秒内计时了 8GB，大约是 220MB/s，我认为这可以最大限度地利用我的 SSD。另外值得注意的是，问题中的代码 100% 使用了一个核心，而此代码仅使用了 2-5%。

非常感谢大家。

**更新**：5年过去了，现在是2017年。编译器、硬件、库和我的要求都发生了变化。这就是为什么我对代码进行了一些更改并进行了一些新的测量。

先上代码：

```
#include <fstream>
#include <chrono>
#include <vector>
#include <cstdint>
#include <numeric>
#include <random>
#include <algorithm>
#include <iostream>
#include <cassert>

std::vector<uint64_t> GenerateData(std::size_t bytes)
{
    assert(bytes % sizeof(uint64_t) == 0);
    std::vector<uint64_t> data(bytes / sizeof(uint64_t));
    std::iota(data.begin(), data.end(), 0);
    std::shuffle(data.begin(), data.end(), std::mt19937{ std::random_device{}() });
    return data;
}

long long option_1(std::size_t bytes)
{
    std::vector<uint64_t> data = GenerateData(bytes);

    auto startTime = std::chrono::high_resolution_clock::now();
    auto myfile = std::fstream("file.binary", std::ios::out | std::ios::binary);
    myfile.write((char*)&data[0], bytes);
    myfile.close();
    auto endTime = std::chrono::high_resolution_clock::now();

    return std::chrono::duration_cast<std::chrono::milliseconds>(endTime - startTime).count();
}

long long option_2(std::size_t bytes)
{
    std::vector<uint64_t> data = GenerateData(bytes);

    auto startTime = std::chrono::high_resolution_clock::now();
    FILE* file = fopen("file.binary", "wb");
    fwrite(&data[0], 1, bytes, file);
    fclose(file);
    auto endTime = std::chrono::high_resolution_clock::now();

    return std::chrono::duration_cast<std::chrono::milliseconds>(endTime - startTime).count();
}

long long option_3(std::size_t bytes)
{
    std::vector<uint64_t> data = GenerateData(bytes);

    std::ios_base::sync_with_stdio(false);
    auto startTime = std::chrono::high_resolution_clock::now();
    auto myfile = std::fstream("file.binary", std::ios::out | std::ios::binary);
    myfile.write((char*)&data[0], bytes);
    myfile.close();
    auto endTime = std::chrono::high_resolution_clock::now();

    return std::chrono::duration_cast<std::chrono::milliseconds>(endTime - startTime).count();
}

int main()
{
    const std::size_t kB = 1024;
    const std::size_t MB = 1024 * kB;
    const std::size_t GB = 1024 * MB;

    for (std::size_t size = 1 * MB; size <= 4 * GB; size *= 2) std::cout << "option1, " << size / MB << "MB: " << option_1(size) << "ms" << std::endl;
    for (std::size_t size = 1 * MB; size <= 4 * GB; size *= 2) std::cout << "option2, " << size / MB << "MB: " << option_2(size) << "ms" << std::endl;
    for (std::size_t size = 1 * MB; size <= 4 * GB; size *= 2) std::cout << "option3, " << size / MB << "MB: " << option_3(size) << "ms" << std::endl;

    return 0;
} 
```

此代码使用 Visual Studio 2017 和 g++ 7.2.0（新要求）编译。我使用两种设置运行代码：

*   笔记本电脑、Core i7、SSD、Ubuntu 16.04、g++ 版本 7.2.0 与 -std=c++11 -march=native -O3
*   台式机、Core i7、SSD、Windows 10、Visual Studio 2017 版本 15.3.1 和 /Ox /Ob2 /Oi /Ot /GT /GL /Gy

它给出了以下测量值（在放弃 1MB 的值之后，因为它们是明显的异常值）： 选项 1 和选项 3 都最大限度地利用了我的 SSD。我没想到会出现这种情况，因为当时 option2 曾经是我旧机器上最快的代码。[![在此处输入图像描述](../Images/fb8d0e27857ddee32caf670d3f4b3a21.png)](https://i.stack.imgur.com/cOdNE.jpg) [![在此处输入图像描述](../Images/fff3f4352369f45977370f200fdc5b93.png)](https://i.stack.imgur.com/TJJSN.jpg)

**TL;DR**：我的测量结果表明使用`std::fstream`over `FILE`。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-07-19T15:53:28.073

按顺序尝试以下操作：

*   较小的缓冲区大小。一次写入约 2 MiB 可能是一个好的开始。在我的最后一台笔记本电脑上，~512 KiB 是最佳选择，但我还没有在我的 SSD 上进行测试。

    **注意：**我注意到非常大的缓冲区往往会**降低**性能。我注意到以前使用 16-MiB 缓冲区而不是 512-KiB 缓冲区会造成速度损失。

*   使用`_open`（或者`_topen`如果你想是 Windows 正确的）打开文件，然后使用`_write`. 这*可能会*避免大量缓冲，但不确定。

*   使用特定于 Windows 的函数，例如`CreateFile`和`WriteFile`。这将避免标准库中的任何缓冲。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-07-19T16:04:23.143

我认为 std::stream/FILE/device 之间没有区别。在缓冲和非缓冲之间。

另请注意：

*   SSD 驱动器在装满时“倾向于”减慢速度（较低的传输速率）。
*   随着 SSD 驱动器变老（由于非工作位），SSD 驱动器“趋于”变慢（较低的传输速率）。

我看到代码在 63 秒内运行。
因此传输速率为：**260M/s**（我的 SSD 看起来比你的稍快）。

```
64 * 1024 * 1024 * 8 /*sizeof(unsigned long long) */ * 32 /*Chunks*/

= 16G
= 16G/63 = 260M/s 
```

从 std::fstream 移至 FILE* 并没有增加。

```
#include <stdio.h>

using namespace std;

int main()
{

    FILE* stream = fopen("binary", "w");

    for(int loop=0;loop < 32;++loop)
    {
         fwrite(a, sizeof(unsigned long long), size, stream);
    }
    fclose(stream);

} 
```

因此，C++ 流的工作速度与底层库允许的一样快。

但我认为将操作系统与构建在操作系统之上的应用程序进行比较是不公平的。应用程序不能做任何假设（它不知道驱动器是 SSD），因此使用操作系统的文件机制进行传输。

而操作系统不需要做任何假设。它可以分辨出所涉及的驱动器的类型，并使用最佳技术来传输数据。在这种情况下，直接内存到内存传输。尝试编写一个程序，将 80G 从内存中的一个位置复制到另一个位置，看看它有多快。

### 编辑

我更改了我的代码以使用较低级别的调用：
即没有缓冲。

```
#include <fcntl.h>
#include <unistd.h>

const unsigned long long size = 64ULL*1024ULL*1024ULL;
unsigned long long a[size];
int main()
{
    int data = open("test", O_WRONLY | O_CREAT, 0777);
    for(int loop = 0; loop < 32; ++loop)
    {   
        write(data, a, size * sizeof(unsigned long long));
    }   
    close(data);
} 
```

这没有任何区别。

***注意***：我的驱动器是 SSD 驱动器，如果您有普通驱动器，您可能会看到上述两种技术之间的差异。但正如我预期的那样，非缓冲和缓冲（当写入大于缓冲区大小的大块时）没有区别。

### 编辑2：

您是否尝试过在 C++ 中复制文件的最快方法

```
int main()
{
    std::ifstream  input("input");
    std::ofstream  output("ouptut");

    output << input.rdbuf();
} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-08-28T00:56:25.310

最好的解决方案是使用双缓冲实现异步写入。

看时间线：

```
------------------------------------------------>
FF|WWWWWWWW|FF|WWWWWWWW|FF|WWWWWWWW|FF|WWWWWWWW| 
```

“F”代表缓冲区填充时间，“W”代表将缓冲区写入磁盘的时间。因此，在将缓冲区写入文件之间浪费时间的问题。但是，通过在单独的线程上实现写入，您可以立即开始填充下一个缓冲区，如下所示：

```
------------------------------------------------> (main thread, fills buffers)
FF|ff______|FF______|ff______|________|
------------------------------------------------> (writer thread)
  |WWWWWWWW|wwwwwwww|WWWWWWWW|wwwwwwww| 
```

F - 填充第一个缓冲区
f - 填充第二个缓冲区
W - 将第一个缓冲区写入文件
w - 将第二个缓冲区写入文件
_ - 等待操作完成

当填充缓冲区需要更复杂的计算（因此需要更多时间）时，这种带有缓冲区交换的方法非常有用。我总是实现一个隐藏异步写入的 CSequentialStreamWriter 类，因此对于最终用户，接口只有 Write 函数。

并且缓冲区大小必须是磁盘簇大小的倍数。否则，通过将单个缓冲区写入 2 个相邻的磁盘集群，最终会导致性能下降。

写入最后一个缓冲区。
当您最后一次调用 Write 函数时，您必须确保当前正在填充的缓冲区也应该写入磁盘。因此 CSequentialStreamWriter 应该有一个单独的方法，比如说 Finalize（最终缓冲区刷新），它应该将最后一部分数据写入磁盘。

错误处理。
虽然代码开始填充第二个缓冲区，并且第一个缓冲区被写入单独的线程，但由于某种原因写入失败，主线程应该知道该失败。

```
------------------------------------------------> (main thread, fills buffers)
FF|fX|
------------------------------------------------> (writer thread)
__|X| 
```

假设 CSequentialStreamWriter 的接口有 Write 函数返回 bool 或抛出异常，因此在单独的线程上出现错误，您必须记住该状态，因此下次在主线程上调用 Write 或 Finilize 时，该方法将返回False 或将抛出异常。即使您在失败后提前写入了一些数据，您在什么时候停止填充缓冲区也无关紧要 - 文件很可能已损坏且无用。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2012-07-19T21:35:11.867

我建议尝试[文件映射](http://msdn.microsoft.com/en-us/library/aa366556%28VS.85%29.aspx)。我`mmap`过去在 UNIX 环境中使用过，我对可以实现的高性能印象深刻

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-07-19T15:50:18.370

你可以`FILE*`改用，衡量你获得的表现吗？有几个选项是使用`fwrite/write`而不是`fstream`：

```
#include <stdio.h>

int main ()
{
  FILE * pFile;
  char buffer[] = { 'x' , 'y' , 'z' };
  pFile = fopen ( "myfile.bin" , "w+b" );
  fwrite (buffer , 1 , sizeof(buffer) , pFile );
  fclose (pFile);
  return 0;
} 
```

如果您决定使用`write`，请尝试类似的方法：

```
#include <unistd.h>
#include <fcntl.h>

int main(void)
{
    int filedesc = open("testfile.txt", O_WRONLY | O_APPEND);

    if (filedesc < 0) {
        return -1;
    }

    if (write(filedesc, "This will be output to testfile.txt\n", 36) != 36) {
        write(2, "There was an error writing to testfile.txt\n", 43);
        return -1;
    }

    return 0;
} 
```

我也建议你调查一下`memory map`。这可能是你的答案。曾经我不得不处理一个 20GB 的文件以将其存储在数据库中，并且该文件甚至无法打开。所以解决方案是利用记忆图。不过我是这样做的`Python`。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-08-23T09:43:08.677

`fstream`s 本身并不比 C 流慢，但它们使用*更多 CPU*（尤其是在未正确配置缓冲的情况下）。当 CPU 饱和时，它会限制 I/O 速率。

当未设置流缓冲区时，至少 MSVC 2015 实现*一次将 1 个字符*`streambuf::xsputn`复制到输出缓冲区（请参阅 参考资料）。所以**一定要设置一个流缓冲区 (>0)**。

使用以下代码，我可以获得 1500MB/s（我的 M.2 SSD 的全速）的写入速度`fstream`：

```
#include <iostream>
#include <fstream>
#include <chrono>
#include <memory>
#include <stdio.h>
#ifdef __linux__
#include <unistd.h>
#endif
using namespace std;
using namespace std::chrono;
const size_t sz = 512 * 1024 * 1024;
const int numiter = 20;
const size_t bufsize = 1024 * 1024;
int main(int argc, char**argv)
{
  unique_ptr<char[]> data(new char[sz]);
  unique_ptr<char[]> buf(new char[bufsize]);
  for (size_t p = 0; p < sz; p += 16) {
    memcpy(&data[p], "BINARY.DATA.....", 16);
  }
  unlink("file.binary");
  int64_t total = 0;
  if (argc < 2 || strcmp(argv[1], "fopen") != 0) {
    cout << "fstream mode\n";
    ofstream myfile("file.binary", ios::out | ios::binary);
    if (!myfile) {
      cerr << "open failed\n"; return 1;
    }
    myfile.rdbuf()->pubsetbuf(buf.get(), bufsize); // IMPORTANT
    for (int i = 0; i < numiter; ++i) {
      auto tm1 = high_resolution_clock::now();
      myfile.write(data.get(), sz);
      if (!myfile)
        cerr << "write failed\n";
      auto tm = (duration_cast<milliseconds>(high_resolution_clock::now() - tm1).count());
      cout << tm << " ms\n";
      total += tm;
    }
    myfile.close();
  }
  else {
    cout << "fopen mode\n";
    FILE* pFile = fopen("file.binary", "wb");
    if (!pFile) {
      cerr << "open failed\n"; return 1;
    }
    setvbuf(pFile, buf.get(), _IOFBF, bufsize); // NOT important
    auto tm1 = high_resolution_clock::now();
    for (int i = 0; i < numiter; ++i) {
      auto tm1 = high_resolution_clock::now();
      if (fwrite(data.get(), sz, 1, pFile) != 1)
        cerr << "write failed\n";
      auto tm = (duration_cast<milliseconds>(high_resolution_clock::now() - tm1).count());
      cout << tm << " ms\n";
      total += tm;
    }
    fclose(pFile);
    auto tm2 = high_resolution_clock::now();
  }
  cout << "Total: " << total << " ms, " << (sz*numiter * 1000 / (1024.0 * 1024 * total)) << " MB/s\n";
} 
```

我在其他平台（Ubuntu、FreeBSD）上尝试了这段代码，发现没有 I/O 速率差异，但*CPU 使用率*差异约为 8:1（`fstream`使用*了 8 倍的 CPU*）。所以可以想象，如果我有一个更快的磁盘，`fstream`写入速度会比`stdio`版本慢。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-07-19T15:25:44.697

尝试使用 open()/write()/close() API 调用并试验输出缓冲区大小。我的意思是不要一次传递整个“多多字节”缓冲区，而是进行几次写入（即，TotalNumBytes / OutBufferSize）。OutBufferSize 可以从 4096 字节到兆字节。

另一个尝试 - 使用 WinAPI OpenFile/CreateFile 并使用[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/windows/desktop/cc644950%28v=vs.85%29.aspx)关闭缓冲 (FILE_FLAG_NO_BUFFERING)。[这篇关于 WriteFile() 的 MSDN 文章](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365747%28v=vs.85%29.aspx)展示了如何获取驱动器的块大小以了解最佳缓冲区大小。

无论如何，std::ofstream 是一个包装器，可能会阻塞 I/O 操作。请记住，遍历整个 N 千兆字节数组也需要一些时间。当您写入一个小缓冲区时，它会进入缓存并且工作得更快。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-07-19T16:33:00.623

如果您在资源管理器中将某些内容从磁盘 A 复制到磁盘 B，Windows 会使用 DMA。这意味着对于大多数复制过程，CPU 基本上只会告诉磁盘控制器将数据放在哪里，从哪里获取数据，从而消除链中的整个步骤，以及根本没有针对移动大量数据进行优化的步骤数据-我的意思是硬件。

你所做的*事情*涉及到 CPU 很多。我想向您指出“填充 [] 的一些计算”部分。我认为这是必不可少的。您生成 a[]，然后从 a[] 复制到输出缓冲区（这就是 fstream::write 所做的），然后再次生成，等等。

该怎么办？多线程！（我希望你有一个多核处理器）

*   叉子。
*   使用一个线程生成一个[]数据
*   使用 other 将数据从 a[] 写入磁盘
*   您将需要两个数组 a1[] 和 a2[] 并在它们之间切换
*   您将需要在线程（信号量、消息队列等）之间进行某种同步
*   使用较低级别的无缓冲函数，例如Mehrdad 提到的[WriteFile函数](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365747%28v=vs.85%29.aspx)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-07-19T15:43:08.600

尝试使用内存映射文件。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-03-02T18:17:21.270

如果您想快速写入文件流，则可以使流读取缓冲区更大：

```
wfstream f;
const size_t nBufferSize = 16184;
wchar_t buffer[nBufferSize];
f.rdbuf()->pubsetbuf(buffer, nBufferSize); 
```

此外，当向文件写入大量数据时，有时在*逻辑上*扩展文件大小而不是物理上会更快，这是因为在逻辑上扩展文件时，文件系统不会在写入之前将新空间归零。在逻辑上扩展文件比您实际需要的更多以防止大量文件扩展也是明智的。在 Windows 上通过调用`SetFileValidData`或`xfsctl`在`XFS_IOC_RESVSP64`XFS 系统上支持逻辑文件扩展。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-07-25T07:19:52.420

*我在GNU/Linux*中的 gcc和win 7 和 win xp 中的*mingw*中编译我的程序并且运行良好

您可以使用我的程序并创建一个 80 GB 的文件，只需将第 33 行更改为

```
makeFile("Text.txt",1024,8192000); 
```

退出程序时文件将被销毁然后在运行时检查文件

拥有您想要的程序只需更改程序

第一个是 windows 程序，第二个是 GNU/Linux

[http://mustafajf.persiangig.com/Projects/File/WinFile.cpp](http://mustafajf.persiangig.com/Projects/File/WinFile.cpp)

[http://mustafajf.persiangig.com/Projects/File/File.cpp](http://mustafajf.persiangig.com/Projects/File/File.cpp)

# vb.net - 在 vb.net 中的特定索引处开始循环？

> ID：11563964
> 
> 赞同：7
> 
> 时间：2012-07-19T15:18:26.697
> 
> 标签：vb.net, foreach, indexing

在 vb 中使用 for each 循环时，有没有办法从零以外的索引开始？

尝试时收到错误“输入字符串格式不正确”：

`For Each segment As String in p`

`If not p(0) Then`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T15:20:21.177

您可以使用 LINQ 的[Enumerable.Skip 方法](http://msdn.microsoft.com/en-us/library/bb358985.aspx)在迭代之前减少您的列表：

```
For Each segment As String in p.Skip(1)
    ...
Next 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:22:45.107

`for each`我认为您误解了循环和循环之间的区别`for`。

`for each`将遍历数组中的每个元素 `for`将遍历数组的索引

```
for i = 0 to p.size //change 0 to the index you want to start
    p(i)
    ...
next 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:25:04.960

要获得比 Skip 方法更具体的方法，您可以编写一个 lambda，它只调用在某些条件下传递给它的函数。

lambda 会像 foreach 循环一样进行枚举，但也会调用作为参数传递给它的委托来检查条件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T15:26:38.103

假设`p`有索引器，如`Array`or`IList`

```
For i As Integer = 1 To p.Count - 1
    p(i)
Next 
```

这假设您使用的是标准`Option Base 0`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-19T15:21:49.180

这将跳过第一个元素，

```
for each segment as string in p.Skip(1)
. . . .
next 
```

如果你想跳过前 5 个元素`. . . in p.Skip(5)`

# java - NoClassDefFoundError 项目中的新依赖项

> ID：11563965
> 
> 赞同：2
> 
> 时间：2012-07-19T15:18:30.080
> 
> 标签：java, eclipse, maven-2, noclassdeffounderror, classnotfoundexception

我正在使用 Eclipse 中的一个项目，该项目有 2 个项目；一个产品和一个称为视图的插件。

我在视图的 pom.xml 文件中添加了 SVNKit v1.3.5 作为依赖项，如下所示：

```
<dependency>
    <groupId>org.tmatesoft.svnkit</groupId>
    <artifactId>svnkit</artifactId>
    <version>1.3.5</version>
    <scope>compile</scope>
</dependency> 
```

在视图插件上执行 Maven 2 Tools > Generate Eclipse Artifacts (from cache) 后，构建成功，因为它从 repo1.maven.org/maven2/...等下载了 SVNKit。

我继续并在视图插件上执行 Maven 2 Tools > Generate OSGi Bundle Manifest 和 Copy Resources，构建成功。

然后我在产品上运行 Maven 2 工具 > 生成和设置目标平台，并像往常一样为其他项目设置运行配置。

该产品设置为 Eclipse 应用程序，并验证插件没有错误。

我可以编写代码，它会检测类并且在编译时没有问题；问题是程序在运行时需要这些类。

我运行该产品，它运行良好，直到我进入需要来自 SVNKit 的任何类文件的 UI 弹出窗口。该窗口根本不弹出，控制台显示：

```
!ENTRY org.eclipse.ui 4 0 2012-07-19 10:07:10.242
!MESSAGE Unhandled event loop exception
!STACK 0
java.lang.NoClassDefFoundError: org/tmatesoft/svn/core/SVNException
...
Caused by: java.lang.ClassNotFoundException: org.tmatesoft.svn.core.SVNException 
```

我试过解决这个问题，但无论我尝试过什么“修复”，都会一遍又一遍地遇到同样的错误。类路径是正确的，因为它指向 m2 存储库，就像它指向其他依赖项一样：

```
<classpathentry kind="var" path="M2_REPO/org/tmatesoft/svnkit/svnkit/1.3.5/svnkit-1.3.5.jar" sourcepath="M2_REPO/org/tmatesoft/svnkit/svnkit/1.3.5/svnkit-1.3.5-sources.jar">
    <attributes>
        <attribute value="jar:file:/<details omitted>/.m2/repository/org/tmatesoft/svnkit/svnkit/1.3.5/svnkit-1.3.5-javadoc.jar!/" name="javadoc_location"/>
    </attributes>
</classpathentry>
<classpathentry kind="var" path="M2_REPO/org/tmatesoft/svnkit/trilead-ssh2/build213-svnkit-1.3-patch/trilead-ssh2-build213-svnkit-1.3-patch.jar"/>
<classpathentry kind="var" path="M2_REPO/org/tmatesoft/sqljet/sqljet/1.0.4/sqljet-1.0.4.jar" sourcepath="M2_REPO/org/tmatesoft/sqljet/sqljet/1.0.4/sqljet-1.0.4-sources.jar"/> 
```

任何建议，将不胜感激。提前致谢！

编辑：SVNKit v1.3.5 的清单文件与我引用的库中的其他文件相比非常短：

```
Manifest-Version: 1.0
Ant-Version: Apache Ant 1.7.0
Created-By: 1.5.0_15-b04 (Sun Microsystems Inc.) 
```

其他库有更多信息，例如导出包、包版本、包名称、导入包等……这可能是问题吗？如果是这样，我已经尝试用 Google 搜索 SVNKit 1.3.5 的清单包文件，但找不到任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:22:14.150

尝试将范围更改为`<scope>provided</scope>`而不是`compile`.

默认范围是*compile*，这意味着在运行时不存在依赖项。为此，您使用*提供*的范围。更多关于 Apache 的Maven 依赖项[简介的 Maven 依赖项](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html)中的范围。

希望这能解决您的问题。

# django - URL 命名在模板中不起作用

> ID：11563969
> 
> 赞同：0
> 
> 时间：2012-07-19T15:18:35.303
> 
> 标签：django, django-templates, django-urls

当我去 /blog/tag/1 查看第一个现有的标签项时，它呈现对 tag.html 的响应，我得到一个异常：“渲染时捕获 NoReverseMatch：Reverse for ''add-node'' with arguments '( )' 和关键字参数 '{}' 未找到。”

**我的URLs.py**中有这样的内容：

 **```
url(r'^blog/add_node/$', 'Alpha.Gamma.views.add_node', name='add-node'), 
```

**视图.py：**

```
def add_node(request):
    tag = Tag.objects.all()
    action = reverse("add-node-proc")
    title = "Submit Article"

    return render_to_response("blog/add_node.html", add_csrf(request, action=action, title=title, tags=tag, button="Submit Article")) 
```

**tag.html**的模板有：

```
<a id="new_node" class="buttont" href="{% url 'add-node' %}">Add new blog post</a>
<br />
<br /> 
```

我得到的错误：

渲染时 NoReverseMatch：未找到带有参数“()”和关键字参数“{}”的“添加节点”的反向。

它突出显示了我在上面为 tag.html 放置的行。

add_node.html 是一个简单的表单模板。我做错了什么，文档说我做的一切都是正确的。

如果我在模板上更改：“url 'add-node'”到“url Alpha.Gamma.views.add_node”，一切都会突然运行---为什么？？？我不明白这个 django url 调度程序。

是的，我已经多次重启了 apache。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:30:57.790

如果您使用的是 url 标签，请注意您不需要在 url 名称周围加上引号：

`{% url add-node %}`

不是

`{% url 'add-node' %}`**

# rally - 拉力赛定制看板

> ID：11563972
> 
> 赞同：1
> 
> 时间：2012-07-19T15:18:40.560
> 
> 标签：rally, kanban

我只想在看板类型板上显示当前迭代中的故事/缺陷，以帮助我们的流程。

所以我在 SO 上找到了这个例子，并添加了 QUERY 行来过滤掉我的迭代。但现在我希望这来自由拉力赛提供的迭代下拉框。

我将它添加到屏幕上，它显示正常，但我如何将它实际连接到我的查询？

```
 <!DOCTYPE html>
    <html>
    <head>
    <title>My Custom App</title>

    <!--Include SDK-->
    <script type="text/javascript" src="https://rally1.rallydev.com/apps/2.0p/sdk.js"></script>

    <!--App code-->
    <script type="text/javascript">

        Rally.onReady(function() {

            Ext.define('CustomApp', {
                extend: 'Rally.app.App',
                componentCls: 'app',
                mappedToField:"State",
                mappedFromField:"KanbanState",

                fieldNameMap:{
                   a:"New",
                   b:"New",
                   c:"Defined",
                   d:"In-Progress",
                   e:"In-Progress",
                   f:"Completed",
                   g:"Completed",
                   h:"Accepted"
                },

                launch: function() {
                     this.add({
                        xtype:'rallyiterationcombobox',
                        itemId: 'iterationComboBox',
                    });

                    this.add({
                        xtype:'rallycardboard',
                        types: ["Defect", "HierarchicalRequirement"],
                        query: 'Iteration.Name contains "UB Sprint 29"',
                        attribute: this.mappedFromField,
                        listeners:{
                            beforecarddroppedsave:function(cardboard, card) {
                                //map the new state from on this card to the new state
                                var newState = this.fieldNameMap[card.record.get(this.mappedFromField)];
                                card.record.set(this.mappedToField, newState);
                            },
                            scope:this
                        }
                    });
                }
            });

            Rally.launchApp('CustomApp', {
                name: 'My Custom App'
            });

        });

    </script>

    </head>
    <body class="myApp">
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:53:37.307

如果要按迭代过滤，则需要向[迭代组合框](https://test7cluster.rallydev.com/apps/2.0p3/doc/#!/api/Rally.ui.IterationComboBox-event-select)添加一个侦听器，并让它根据当前选定的迭代创建板。

```
<!DOCTYPE html> 
```

我的看板迭代

```
<!--Include SDK-->
<script type="text/javascript" src="https://rally1.rallydev.com/apps/2.0p2/sdk.js"></script>

<!--App code-->
<script type="text/javascript">

    Rally.onReady(function() {

        Ext.define('CustomApp', {
            extend: 'Rally.app.App',
            componentCls: 'app',
            mappedToField:"State",
            mappedFromField:"KanbanState",

            kanban:undefined,
            fieldNameMap:{
                a:"New",
                b:"New",
                c:"Defined",
                d:"In-Progress",
                e:"In-Progress",
                f:"Completed",
                g:"Completed",
                h:"Accepted"
            },

            launch: function() {
                this.add({
                    xtype:'rallyiterationcombobox',
                    itemId: 'iterationComboBox',
                    listeners: {
                        select: this.createKanban,
                        ready: this.createKanban,
                        scope: this
                    }
                });
            },
            createKanban:function(combo, records) {
                if (this.kanban) {
                    this.kanban.destroy();
                }
                var filters = [];
                if (records.length) {
                    filters.push({
                        property: 'Iteration',
                        value: records[0].get("_ref")
                    });
                }
                this.kanban = this.add({
                    xtype:'rallycardboard',
                    types: ["Defect", "HierarchicalRequirement"],
                    attribute: this.mappedFromField,
                    listeners:{
                        beforecarddroppedsave:function(cardboard, card) {
                            //map the new state from on this card to the new state
                            var newState = this.fieldNameMap[card.record.get(this.mappedFromField)];
                            card.record.set(this.mappedToField, newState);
                        },
                        scope:this
                    },
                    storeConfig:{
                        filters:filters
                    }
                });
            }
        });

        Rally.launchApp('CustomApp', {
            name: 'My Kanban by Iteration'
        });

    });

</script> 
```

# xaml - 在 xaml 中扩展自定义控件的样式

> ID：11563979
> 
> 赞同：1
> 
> 时间：2012-07-19T15:19:16.503
> 
> 标签：xaml, styles, basedon

我正在开发一个 WPF 应用程序，并创建了一个自定义控件，我们将其称为“CControl”。在我设计应用程序布局的 xaml 文档中。我使用以下方式导入样式：

```
xmlns:my="clr-namespace:My.Controls" 
```

并且能够很好地使用控件。问题是我想在 CControl 上扩展样式。在资源字典中，我可以设置：

```
 <Style TargetType="{x:Type my:CControl}">
            <Setter Property="Margin" Value="5 0 5 3" />
        </Style> 
```

这会将样式应用于控件，但不会导入 CControl 定义的样式，因此我使用：

```
 <Style TargetType="{x:Type my:CControl}" BasedOn="{StaticResource {x:Type my:CControl}}">
            <Setter Property="Margin" Value="5 0 5 3" />
        </Style> 
```

问题是当我的框架尝试加载 xaml 时，我得到以下异常：

```
System.Windows.Markup.XamlParseException occurred
  Message='Provide value on 'System.Windows.StaticResourceExtension' threw an exception.' Line number '18' and line position '54'.
Source=PresentationFramework
LineNumber=18
LinePosition=54
StackTrace:
   at System.Windows.Markup.XamlReader.RewrapException(Exception e, IXamlLineInfo lineInfo, Uri baseUri)
   at System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, IXamlObjectWriterFactory writerFactory, Boolean skipJournaledProperties, Object rootObject, XamlObjectWriterSettings settings, Uri baseUri)
   at System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, Boolean skipJournaledProperties, Uri baseUri)
   at System.Windows.Markup.XamlReader.Load(XamlReader xamlReader, ParserContext parserContext)
   at System.Windows.Markup.XamlReader.Load(XamlReader reader)
   at FATPOT.Whiteboard.Report.Show() in C:\...\Report.cs
InnerException: 
   Message=Cannot find resource named 'My.Controls.CControl'. Resource names are case sensitive.
   Source=PresentationFramework
   StackTrace:
        at System.Windows.StaticResourceExtension.ProvideValueInternal(IServiceProvider serviceProvider, Boolean allowDeferredReference)
        at System.Windows.StaticResourceExtension.ProvideValue(IServiceProvider serviceProvider)
        at MS.Internal.Xaml.Runtime.ClrObjectRuntime.CallProvideValue(MarkupExtension me, IServiceProvider serviceProvider)
   InnerException: 
```

我尝试了不同的使用 BasedOn 的方法，但没有得到任何工作。任何帮助都会非常有用。

谢谢

乔什

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T20:52:48.020

在尝试了一天来扩展自定义控件的样式之后，我终于能够让它工作了。您可以通过定义命名空间来使用控件，但如果要扩展控件的样式，则需要包含控件的 ResourceDictionary。我最终添加了：

```
 <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="pack://application:,,,/My.Project;component/Resources/CControl.xaml" />
        </ResourceDictionary.MergedDictionaries> 
```

到我的 WPF Applications Canvas / Xaml 中的 ResourceDictionary。

# php - 从网站获取内容并将内容放入磁盘驱动器

> ID：11563980
> 
> 赞同：0
> 
> 时间：2012-07-19T15:19:22.557
> 
> 标签：php

我试图从网站获取一个 exe 文件并将其放入磁盘驱动器这是我的代码

```
@file_put_contents("C:\program.exe" ,       @file_get_contents("http://localhost/program.exe")); 
```

请帮忙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:22:00.703

为什么不直接使用`copy()`？

```
copy("http://localhost/program.exe","C:/program.exe"); 
```

请注意，原因可能是未转义的反斜杠 - 我在这里使用了正斜杠，因为 Windows 会默默地转换它。

# asp.net-mvc - 为什么我的 IIS Express Web 应用程序项目在尝试加载时会在输出窗口中抛出错误？

> ID：11563981
> 
> 赞同：5
> 
> 时间：2012-07-19T15:19:24.890
> 
> 标签：asp.net-mvc, visual-studio, iis-express, web-application-project

已转换为 IIS Express 然后签入 Team Foundation Server 的 Web 应用程序项目在其他开发人员尝试加载它时出现错误。错误出现在 Visual Studio 输出窗口中，并且无法加载关联的 Web 应用程序项目。

这是输出窗口中的错误：

> Web 应用程序项目 XXXX 配置为使用 IIS。找不到 Web 服务器“http://XXXX”。

是什么导致了这个问题，我该如何解决？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T15:19:24.890

虽然我不确定转换为 IIS Express 的项目如何仅保存该设置的一部分的根本原因，但问题很可能是您的项目文件的`UseIISExpress`节点设置为 false。在文本编辑器（Visual Studio 或其他）中打开项目文件并将节点设置更改为 true：

```
<UseIISExpress>true</UseIISExpress> 
```

编辑并保存项目文件后，右键单击已卸载的项目并选择重新加载。

# ssas - 使用不同事实表、相同维度的观点

> ID：11563983
> 
> 赞同：0
> 
> 时间：2012-07-19T15:19:31.933
> 
> 标签：ssas, cube, bids, perspective

我的客户要求我为仅显示事实表子集的现有多维数据集创建不同的透视图。我不确定这是否可能。我希望我可以再次引入同一个事实表，对其进行过滤，并将其加入所有现有维度，但看起来我无法在“透视”选项卡中选择要使用的事实表。

有没有人有其他解决这个问题的方法？还是根本做不到？作为最后的手段，我将创建一个新的立方体，但这不是一个理想的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T19:29:10.320

我发现您需要使用过滤的事实表创建另一个度量组，以与原始透视相同的方式设置维度使用，然后从中创建一个新的透视，过滤掉原始度量组。

# tfs - TFS 2010 中缺少“需求”工作项类型

> ID：11563985
> 
> 赞同：2
> 
> 时间：2012-07-19T15:19:40.543
> 
> 标签：tfs, tfs-workitem

我无法添加“需求”类型的工作项。[我在此处](http://channel9.msdn.com/Blogs/VisualStudio/Requirements-Management-and-Traceability-with-Visual-Studio-Team-System-2010)的视频中关注此示例，发现我的工作项目列表与他们在视频中的不同。我想也许那个人已经创建了一些自定义工作项，所以我尝试查看[其他链接](http://blogs.microsoft.co.il/blogs/eranruso/archive/2009/12/30/tfs-2010-work-items-basic-user-guide-create-new-work-items.aspx)，发现“需求”类型的工作项在默认工作项类型中。

但是，在我的 TFS 安装中，我只看到这些：

![在此处输入图像描述](../Images/cf387da368f280aa23befac6da879da6.png)

如您所见，缺少“需求”类型。这是因为我在安装 TFS 或在 TFS 中创建项目时没有做对吗？我 TFS 中的所有项目目前都在使用 MS Agile 项目模板。它们都只有上述工作项类型。当我进一步查看视频时；用于输入工作项详细信息的所有表单看起来都与我在安装中的不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:48:09.800

需求工作项类型来自 CMMI 模板...由于您使用的是敏捷模板，因此它被称为“用户故事”。它们在您的项目中具有相同的作用。不同之处在于“用户故事”的字段较少且状态不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T06:30:55.603

正如 Ryan 所说，您正在使用敏捷模板，如果创建了新的团队项目，它就是默认模板。

您可以在选择团队项目模板的对话框中更改它，如下 [所示](http://www.google.de/imgres?q=new%20team%20project&um=1&hl=de&sa=N&biw=1349&bih=672&tbm=isch&tbnid=FFvS8oS89Mi33M%3a&imgrefurl=http://msdn.microsoft.com/en-us/library/bb187319%28v=vs.80%29.aspx&docid=7waOWh6JZfgbLM&imgurl=http://i.msdn.microsoft.com/dynimg/IC113530.gif&w=480&h=351&ei=6voIUPSmE6iu0QWa34G6Cg&zoom=1&iact=hc&vpx=837&vpy=10&dur=1186&hovh=192&hovw=263&tx=157&ty=86&sig=100629665554333613449&page=3&tbnh=144&tbnw=197&start=40&ndsp=22&ved=1t:429,r:8,s:40,i:227)

# dns - 如何通过在局域网（Intranet）的 URL 中输入一个简单的名称来使网站可访问

> ID：11563992
> 
> 赞同：0
> 
> 时间：2012-07-19T15:20:06.573
> 
> 标签：dns, webserver, system-administration, netbios

我见过某些 Web 应用程序，我们可以通过在 URL 字段中输入简单的名称（例如“帐户”）而不是输入完整的域名“www.xxx.yyy\accounts”来访问这些应用程序。

我有一个包含大约 150 台计算机的局域网和一个运行在 windows server 2008 R2 上的 Web 服务器，可以由外部访问并具有正确的域名。我想发布一些网络应用程序供局域网中的计算机使用。这不应该涉及任何互联网连接，用户必须能够通过在浏览器的 URL 字段中输入一个简单的名称来访问 Web 应用程序。我知道这是可能的，但我不知道如何阅读以及阅读什么。请给我一些信息。我必须建立 LLMNR，或者 NetBIOS，甚至通过流行的 DNS 配置来实现吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:28:11.450

如果您有一个 Windows 域，这应该可以正常工作（例如 http:// *computerName* /），但如果您不这样做，您可以在网络上建立一个 WINS 服务器 - 通常这将有助于客户端 PC 解析名称。否则，如果您的所有客户端 PC 都指向本地 DNS 服务器，您可以使用现有的 DNS。

# python - 你如何设置一个变量等于python中函数返回的值

> ID：11563999
> 
> 赞同：0
> 
> 时间：2012-07-19T15:20:50.140
> 
> 标签：python, sprite, pygame

我正在尝试设计一个系统，允许我在单击时将精灵移动到光标位置，类似于 RuneScape，玩家将移动到鼠标在屏幕上单击的位置。下面是我的代码：

```
 for event in pygame.event.get ():
    if event.type == QUIT:
        pygame.quit ()
        sys.exit (0)

    elif event.type == KEYDOWN:
        if event.key == K_UP:
            Shrin_y -= 5
        elif event.key == K_LEFT:
            Shrin_x -= 5
        elif event.key == K_RIGHT:  
            Shrin_x += 5 
        elif event.key == K_DOWN:   
            Shrin_y += 5 
    elif event.type == MOUSEBUTTONDOWN:
        (Shrin_x, Shrin_y) = pygame.mouse.get_pos
        print pygame.mouse.get_pos

Surface.blit (Shrin, (Shrin_x, Shrin_y))

pygame.display.update () 
```

注意：Shrin 只是精灵的名字；如果它让您满意，只需将代码中的所有 Shrin 实例替换为“sprite”即可。

那么如何存储返回的值`pygame.mouse.get_pos`in `(Shrin_x, Shrin_y)`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T15:30:41.107

```
(Shrin_x, Shrin_y) = pygame.mouse.get_pos 
```

这一行应该给你一个错误，因为它试图将一个值（一个函数或方法对象）解压缩为两个变量。你想要的是：

```
(Shrin_x, Shrin_y) = pygame.mouse.get_pos() 
```

不同之处在于，`()`是调用可调用对象的运算符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:31:16.990

你需要打电话[`pygame.mouse.get_pos`](http://www.pygame.org/docs/ref/mouse.html#pygame.mouse.get_pos)。您在代码中使用它的方式只是在查看方法。所以改变只改变一行：

```
(Shrin_x, Shrin_y) = pygame.mouse.get_pos() 
```